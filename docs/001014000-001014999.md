# StackOverflow 问答 1014000-1014999

# .net - DataContext 重用连接

> ID：1014001
> 
> 赞同：0
> 
> 时间：2009-06-18T17:19:34.370
> 
> 标签：.net, linq

这是一个简单的问题，如果您以前遇到过这种情况，您可能会发现：

想象一下，我有一个循环，在其中我创建了一个 DataContext 的实例，并对数据库执行了一些查询。

问题是...... DataContext 是仅第一次打开连接并重用它，还是在每个循环中打开/关闭与数据库的新连接？如果是后者，我可以以某种方式强制只使用一个连接吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T17:27:25.437

您是否在每次迭代时处理 DataContext（即，您是否使用“使用”语句创建数据上下文？）。如果是这样，那么您每次都将打开和关闭连接。否则，我猜这将取决于您的代码 - 如果您有一个私有变量在每个循环的范围内进出，那么效果相同。

为什么不能只在循环之外创建一个 DataContext 并使用它？这是存储库类的推荐做法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T17:28:54.717

怎么样：

```
 using(var dc=new FooDataContext())
 {
     for(var i=0;i<someVal;++i)
     {
         dc.SomeTable.Where.....
     }
 } 
```

# c# - 如何使用单个值填充/实例化 C# 数组？

> ID：1014005
> 
> 赞同：252
> 
> 时间：2009-06-18T17:20:56.520
> 
> 标签：c#, arrays, default-value

我知道 C# 中值类型的实例化数组会自动填充[该类型的默认值](http://msdn.microsoft.com/en-us/library/83fhsxwc(loband).aspx)（例如，布尔为 false，int 为 0，等等）。

有没有办法使用不是默认值的种子值自动填充数组？是在创建时还是之后的内置方法（如Java的[Arrays.fill()](https://docs.oracle.com/javase/8/docs/api/java/util/Arrays.html#fill-int:A-int-)）？假设我想要一个默认为 true 的布尔数组，而不是 false。有没有内置的方法可以做到这一点，或者你只需​​要使用 for 循环遍历数组？

```
 // Example pseudo-code:
 bool[] abValues = new[1000000];
 Array.Populate(abValues, true);

 // Currently how I'm handling this:
 bool[] abValues = new[1000000];
 for (int i = 0; i < 1000000; i++)
 {
     abValues[i] = true;
 } 
```

必须遍历数组并将每个值“重置”为 true 似乎效率低下。有没有办法解决？也许通过翻转所有值？

在输入这个问题并考虑之后，我猜测默认值只是 C# 如何在幕后处理这些对象的内存分配的结果，所以我想这可能是不可能的。但我还是想确定一下！

* * *

## 回答 #1

> 赞同：244
> 
> 时间：2009-06-18T17:26:07.763

```
Enumerable.Repeat(true, 1000000).ToArray(); 
```

* * *

## 回答 #2

> 赞同：165
> 
> 时间：2009-06-18T17:23:43.693

不知道框架方法，但您可以编写一个快速助手来为您完成。

```
public static void Populate<T>(this T[] arr, T value ) {
  for ( int i = 0; i < arr.Length;i++ ) {
    arr[i] = value;
  }
} 
```

* * *

## 回答 #3

> 赞同：87
> 
> 时间：2009-06-18T17:23:51.697

创建一个包含一千个`true`值的新数组：

```
var items = Enumerable.Repeat<bool>(true, 1000).ToArray();  // Or ToList(), etc. 
```

同样，您可以生成整数序列：

```
var items = Enumerable.Range(0, 1000).ToArray();  // 0..999 
```

* * *

## 回答 #4

> 赞同：43
> 
> 时间：2019-06-14T08:07:27.570

您可以[`Array.Fill`](https://docs.microsoft.com/en-us/dotnet/api/system.array.fill?view=netstandard-2.1)在 .NET Core 2.0+ 和 .NET Standard 2.1+ 中使用。

* * *

## 回答 #5

> 赞同：26
> 
> 时间：2009-06-18T17:39:23.593

对于大型数组或可变大小的数组，您可能应该使用：

```
Enumerable.Repeat(true, 1000000).ToArray(); 
```

对于小型数组，您可以使用 C# 3 中的集合初始化语法：

```
bool[] vals = new bool[]{ false, false, false, false, false, false, false }; 
```

集合初始化语法的好处是您不必在每个槽中使用相同的值，您可以使用表达式或函数来初始化槽。另外，我认为您可以避免将数组槽初始化为默认值的成本。因此，例如：

```
bool[] vals = new bool[]{ false, true, false, !(a ||b) && c, SomeBoolMethod() }; 
```

* * *

## 回答 #6

> 赞同：25
> 
> 时间：2010-06-24T07:58:15.467

如果您的数组太大，您应该使用 BitArray。它为每个 bool 使用 1 位而不是一个字节（如在 bool 数组中），您也可以使用位运算符将所有位设置为 true。或者只是初始化为true。如果你只需要做一次，它只会花费更多。

```
System.Collections.BitArray falses = new System.Collections.BitArray(100000, false);
System.Collections.BitArray trues = new System.Collections.BitArray(100000, true);

// Now both contain only true values.
falses.And(trues); 
```

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2009-06-18T17:29:16.370

不幸的是，我认为没有直接的方法，但是我认为您可以为数组类编写一个扩展方法来做到这一点

```
class Program
{
    static void Main(string[] args)
    {
        int[] arr = new int[1000];
        arr.Init(10);
        Array.ForEach(arr, Console.WriteLine);
    }
}

public static class ArrayExtensions
{
    public static void Init<T>(this T[] array, T defaultVaue)
    {
        if (array == null)
            return;
        for (int i = 0; i < array.Length; i++)
        {
            array[i] = defaultVaue;
        }
    }
} 
```

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2009-06-18T17:25:40.947

好吧，经过更多的谷歌搜索和阅读，我发现了这个：

```
bool[] bPrimes = new bool[1000000];
bPrimes = Array.ConvertAll<bool, bool>(bPrimes, b=> b=true); 
```

这肯定更接近我正在寻找的东西。但我不确定这是否比在 for 循环中遍历原始数组并仅更改值更好。事实上，经过快速测试，它看起来慢了大约 5 倍。所以这不是一个好的解决方案！

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2013-11-01T12:49:48.563

下面的代码结合了小副本的简单迭代和大副本的 Array.Copy

```
 public static void Populate<T>( T[] array, int startIndex, int count, T value ) {
        if ( array == null ) {
            throw new ArgumentNullException( "array" );
        }
        if ( (uint)startIndex >= array.Length ) {
            throw new ArgumentOutOfRangeException( "startIndex", "" );
        }
        if ( count < 0 || ( (uint)( startIndex + count ) > array.Length ) ) {
            throw new ArgumentOutOfRangeException( "count", "" );
        }
        const int Gap = 16;
        int i = startIndex;

        if ( count <= Gap * 2 ) {
            while ( count > 0 ) {
                array[ i ] = value;
                count--;
                i++;
            }
            return;
        }
        int aval = Gap;
        count -= Gap;

        do {
            array[ i ] = value;
            i++;
            --aval;
        } while ( aval > 0 );

        aval = Gap;
        while ( true ) {
            Array.Copy( array, startIndex, array, i, aval );
            i += aval;
            count -= aval;
            aval *= 2;
            if ( count <= aval ) {
                Array.Copy( array, startIndex, array, i, count );
                break;
            }
        }
    } 
```

使用 int[] 数组的不同数组长度的基准是：

```
 2 Iterate:     1981 Populate:     2845
         4 Iterate:     2678 Populate:     3915
         8 Iterate:     4026 Populate:     6592
        16 Iterate:     6825 Populate:    10269
        32 Iterate:    16766 Populate:    18786
        64 Iterate:    27120 Populate:    35187
       128 Iterate:    49769 Populate:    53133
       256 Iterate:   100099 Populate:    71709
       512 Iterate:   184722 Populate:   107933
      1024 Iterate:   363727 Populate:   126389
      2048 Iterate:   710963 Populate:   220152
      4096 Iterate:  1419732 Populate:   291860
      8192 Iterate:  2854372 Populate:   685834
     16384 Iterate:  5703108 Populate:  1444185
     32768 Iterate: 11396999 Populate:  3210109 
```

第一列是数组大小，然后是使用简单迭代（@JaredPared 实现）进行复制的时间。这种方法的时间是在那之后。这些是使用四个整数结构的数组的基准

```
 2 Iterate:     2473 Populate:     4589
         4 Iterate:     3966 Populate:     6081
         8 Iterate:     7326 Populate:     9050
        16 Iterate:    14606 Populate:    16114
        32 Iterate:    29170 Populate:    31473
        64 Iterate:    57117 Populate:    52079
       128 Iterate:   112927 Populate:    75503
       256 Iterate:   226767 Populate:   133276
       512 Iterate:   447424 Populate:   165912
      1024 Iterate:   890158 Populate:   367087
      2048 Iterate:  1786918 Populate:   492909
      4096 Iterate:  3570919 Populate:  1623861
      8192 Iterate:  7136554 Populate:  2857678
     16384 Iterate: 14258354 Populate:  6437759
     32768 Iterate: 28351852 Populate: 12843259 
```

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2010-06-24T08:44:50.700

并行实现怎么样

```
public static void InitializeArray<T>(T[] array, T value)
{
    var cores = Environment.ProcessorCount;

    ArraySegment<T>[] segments = new ArraySegment<T>[cores];

    var step = array.Length / cores;
    for (int i = 0; i < cores; i++)
    {
        segments[i] = new ArraySegment<T>(array, i * step, step);
    }
    var remaining = array.Length % cores;
    if (remaining != 0)
    {
        var lastIndex = segments.Length - 1;
        segments[lastIndex] = new ArraySegment<T>(array, lastIndex * step, array.Length - (lastIndex * step));
    }

    var initializers = new Task[cores];
    for (int i = 0; i < cores; i++)
    {
        var index = i;
        var t = new Task(() =>
        {
            var s = segments[index];
            for (int j = 0; j < s.Count; j++)
            {
                array[j + s.Offset] = value;
            }
        });
        initializers[i] = t;
        t.Start();
    }

    Task.WaitAll(initializers);
} 
```

仅初始化数组时，看不到此代码的功能，但我认为您绝对应该忘记“纯”。

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2012-02-06T14:43:47.507

或者......你可以简单地使用反转逻辑。让`false`意思`true`，反之亦然。

**代码示例**

```
// bool[] isVisible = Enumerable.Repeat(true, 1000000).ToArray();
bool[] isHidden = new bool[1000000]; // Crazy-fast initialization!

// if (isVisible.All(v => v))
if (isHidden.All(v => !v))
{
    // Do stuff!
} 
```

* * *

## 回答 #12

> 赞同：7
> 
> 时间：2019-07-25T04:25:26.057

这里提供的许多答案都归结为一个循环，该循环一次初始化数组一个元素，它没有利用设计用于一次操作一块内存的 CPU 指令。

.Net Standard 2.1（在撰写本文时为预览版）提供了[Array.Fill()](https://docs.microsoft.com/en-us/dotnet/api/system.array.fill?view=netstandard-2.1)，它有助于在运行时库中实现高性能（尽管到目前为止，.NET Core[似乎还没有](https://stackoverflow.com/questions/54096317/performance-difference-between-c-sharp-for-loop-and-array-fill)利用这种可能性） .

对于早期平台上的那些，当数组大小很大时，以下扩展方法比普通循环的性能要好很多。当我的在线代码挑战解决方案超出分配的时间预算约 20% 时，我创建了它。它减少了大约 70% 的运行时间。在这种情况下，数组填充是在另一个循环中执行的。BLOCK_SIZE 是由直觉而不是实验设置的。一些优化是可能的（例如，复制所有已设置为所需值的字节而不是固定大小的块）。

```
internal const int BLOCK_SIZE = 256;
public static void Fill<T>(this T[] array, T value)
{
    if (array.Length < 2 * BLOCK_SIZE)
    {
        for (int i = 0; i < array.Length; i++) array[i] = value;
    }
    else
    {
        int fullBlocks = array.Length / BLOCK_SIZE;
        // Initialize first block
        for (int j = 0; j < BLOCK_SIZE; j++) array[j] = value;
        // Copy successive full blocks
        for (int blk = 1; blk < fullBlocks; blk++)
        {
            Array.Copy(array, 0, array, blk * BLOCK_SIZE, BLOCK_SIZE);
        }

        for (int rem = fullBlocks * BLOCK_SIZE; rem < array.Length; rem++)
        {
            array[rem] = value;
        }
    }
} 
```

* * *

## 回答 #13

> 赞同：7
> 
> 时间：2019-12-16T08:48:32.123

如果你在 .NET Core，.NET Standard >= 2.1，或者依赖 System.Memory 包，你也可以使用这个`Span<T>.Fill()`方法：

```
var valueToFill = 165;
var data = new int[100];

data.AsSpan().Fill(valueToFill);

// print array content
for (int i = 0; i < data.Length; i++)
{
    Console.WriteLine(data[i]);
} 
```

[https://dotnetfiddle.net/UsJ9bu](https://dotnetfiddle.net/UsJ9bu)

* * *

## 回答 #14

> 赞同：6
> 
> 时间：2020-07-22T06:30:15.983

只是一个基准：

```
BenchmarkDotNet=v0.12.1, OS=Windows 10.0.18363.997 (1909/November2018Update/19H2)
Intel Core i7-6700HQ CPU 2.60GHz (Skylake), 1 CPU, 8 logical and 4 physical cores
.NET Core SDK=3.1.302
  [Host]        : .NET Core 3.1.6 (CoreCLR 4.700.20.26901, CoreFX 4.700.20.31603), X64 RyuJIT
  .NET Core 3.1 : .NET Core 3.1.6 (CoreCLR 4.700.20.26901, CoreFX 4.700.20.31603), X64 RyuJIT

Job=.NET Core 3.1  Runtime=.NET Core 3.1

|           Method |     Mean |     Error |    StdDev |
|----------------- |---------:|----------:|----------:|
| EnumerableRepeat | 2.311 us | 0.0228 us | 0.0213 us |
|  NewArrayForEach | 2.007 us | 0.0392 us | 0.0348 us |
|        ArrayFill | 2.426 us | 0.0103 us | 0.0092 us | 
```

```
 [SimpleJob(BenchmarkDotNet.Jobs.RuntimeMoniker.NetCoreApp31)]
    public class InitializeArrayBenchmark {
        const int ArrayLength = 1600;

        [Benchmark]
        public double[] EnumerableRepeat() {
            return Enumerable.Repeat(double.PositiveInfinity, ArrayLength).ToArray();
        }

        [Benchmark]
        public double[] NewArrayForEach() {
            var array = new double[ArrayLength];

            for (int i = 0; i < array.Length; i++) {
                array[i] = double.PositiveInfinity;
            }

            return array;
        }

        [Benchmark]
        public double[] ArrayFill() {
            var array = new double[ArrayLength];
            Array.Fill(array, double.PositiveInfinity);

            return array;
        }
    } 
```

* * *

## 回答 #15

> 赞同：5
> 
> 时间：2021-07-10T17:07:02.767

.NET Core 2.0 及更高版本支持`Array.Fill()`方法。

这是一个示例代码。

```
var arr = new int[10];
int defaultValue = 2;
Array.Fill(arr,defaultValue); 
```

它还具有用于填充索引范围的重载方法。更多细节可以在[这里](https://docs.microsoft.com/en-us/dotnet/api/system.array.fill?view=net-5.0)找到。

* * *

## 回答 #16

> 赞同：4
> 
> 时间：2009-06-18T17:34:01.387

这也有效......但可能是不必要的

```
 bool[] abValues = new bool[1000];
 abValues = abValues.Select( n => n = true ).ToArray<bool>(); 
```

* * *

## 回答 #17

> 赞同：4
> 
> 时间：2014-12-15T23:05:38.127

无法将数组中的所有元素设置为单个操作，除非该值是元素类型的默认值。

例如，如果它是一个整数数组，您可以通过一次操作将它们全部设置为零，如下所示： `Array.Clear(...)`

* * *

## 回答 #18

> 赞同：4
> 
> 时间：2019-12-28T14:31:21.960

这是微软放弃的我们框架用户的另一个版本。它的速度是[Panos Theof 的解决方案](https://stackoverflow.com/a/19727083/4156577)和[Eric J](https://stackoverflow.com/a/57194312/4156577)和[Petar Petrov 的并行](https://stackoverflow.com/a/3108386/4156577)[`Array.Clear`](https://docs.microsoft.com/en-us/dotnet/api/system.array.clear)解决方案的 4 倍和更快- 对于大型阵列来说，速度高达两倍。

首先，我想向您展示函数的祖先，因为这样更容易理解代码。在性能方面，这与 Panos Theof 的代码几乎相当，并且对于某些可能已经足够的事情：

```
public static void Fill<T> (T[] array, int count, T value, int threshold = 32)
{
    if (threshold <= 0)
        throw new ArgumentException("threshold");

    int current_size = 0, keep_looping_up_to = Math.Min(count, threshold);

    while (current_size < keep_looping_up_to)
        array[current_size++] = value;

    for (int at_least_half = (count + 1) >> 1; current_size < at_least_half; current_size <<= 1)
        Array.Copy(array, 0, array, current_size, current_size);

    Array.Copy(array, 0, array, current_size, count - current_size);
} 
```

如您所见，这是基于已初始化部分的重复加倍。这是简单而高效的，但它与现代内存架构相冲突。因此诞生了一个版本，它只使用加倍来创建一个缓存友好的种子块，然后在目标区域上迭代地爆破：

```
const int ARRAY_COPY_THRESHOLD = 32;  // 16 ... 64 work equally well for all tested constellations
const int L1_CACHE_SIZE = 1 << 15;

public static void Fill<T> (T[] array, int count, T value, int element_size)
{
    int current_size = 0, keep_looping_up_to = Math.Min(count, ARRAY_COPY_THRESHOLD);

    while (current_size < keep_looping_up_to)
        array[current_size++] = value;

    int block_size = L1_CACHE_SIZE / element_size / 2;
    int keep_doubling_up_to = Math.Min(block_size, count >> 1);

    for ( ; current_size < keep_doubling_up_to; current_size <<= 1)
        Array.Copy(array, 0, array, current_size, current_size);

    for (int enough = count - block_size; current_size < enough; current_size += block_size)
        Array.Copy(array, 0, array, current_size, block_size);

    Array.Copy(array, 0, array, current_size, count - current_size);
} 
```

注意：前面的代码需要`(count + 1) >> 1`作为加倍循环的限制，以确保最终的复制操作有足够的素材来覆盖剩下的所有内容。如果`count >> 1`改为使用奇数计数，则不会出现这种情况。对于当前版本，这无关紧要，因为线性复制循环会弥补任何不足。

数组单元的大小必须作为参数传递，因为 - 令人难以置信 - 不允许使用泛型，[`sizeof`](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/operators/sizeof)除非它们使用[`unmanaged`](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/proposals/csharp-7.3/blittable)将来可能会或可能不会变得可用的约束 ( )。错误的估计没什么大不了的，但如果值准确，性能最好，原因如下：

*   低估元素大小会导致块大小超过 L1 缓存的一半，因此增加了复制源数据被从 L1 逐出并不得不从较慢的缓存级别重新获取的可能性。

*   高估元素大小会导致 CPU 的 L1 缓存利用率不足，这意味着线性块复制循环的执行频率高于最佳利用率。因此，产生了比严格必要的更多的固定循环/调用开销。

`Array.Clear`这是我的代码和前面提到的其他三个解决方案的基准测试。时间用于填充`Int32[]`给定大小的整数数组 ( )。为了减少由缓存变幻莫测等引起的变化，每个测试都执行了两次，背靠背，并为第二次执行计时。

```
array size   Array.Clear      Eric J.   Panos Theof  Petar Petrov   Darth Gizka
-------------------------------------------------------------------------------
     1000:       0,7 µs        0,2 µs        0,2 µs        6,8 µs       0,2 µs 
    10000:       8,0 µs        1,4 µs        1,2 µs        7,8 µs       0,9 µs 
   100000:      72,4 µs       12,4 µs        8,2 µs       33,6 µs       7,5 µs 
  1000000:     652,9 µs      135,8 µs      101,6 µs      197,7 µs      71,6 µs 
 10000000:    7182,6 µs     4174,9 µs     5193,3 µs     3691,5 µs    1658,1 µs 
100000000:   67142,3 µs    44853,3 µs    51372,5 µs    35195,5 µs   16585,1 µs 
```

如果这段代码的性能不够，那么一个有前途的途径是并行化线性复制循环（所有线程使用相同的源块），或者我们的好老朋友 P/Invoke。

注意：块的清除和填充通常由运行时例程完成，这些运行时例程使用 MMX/SSE 指令和诸如此类的分支到高度专业化的代码，因此在任何体面的环境中，人们只需调用各自的道德等价物`std::memset`并确保专业性能水平。IOW，按照权利，库函数`Array.Clear`应该让我们所有的手卷版本都尘埃落定。事实恰恰相反，这表明事情真的很不正常。首先必须推出自己`Fill<>`的产品也是如此，因为它仍然只在核心和标准中，而不是在框架中。.NET 已经存在将近 20 年了，我们仍然需要左右 P/Invoke 来获取最基本的东西，或者推出我们自己的...

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2010-06-24T09:10:16.917

如果您打算只设置数组中的几个值，但想在大多数情况下获取（自定义）默认值，您可以尝试以下操作：

```
public class SparseArray<T>
{
    private Dictionary<int, T> values = new Dictionary<int, T>();

    private T defaultValue;

    public SparseArray(T defaultValue)
    {
        this.defaultValue = defaultValue;
    }

    public T this [int index]
    {
      set { values[index] = value; }
      get { return values.ContainsKey(index) ? values[index] ? defaultValue; }
    }
} 
```

您可能需要实现其他接口以使其有用，例如[数组](http://msdn.microsoft.com/en-us/library/czz5hkty.aspx)本身的接口。

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2015-03-26T19:54:34.287

我意识到我参加聚会迟到了，但这里有个主意。编写一个包装器，该包装器具有与包装值之间的转换运算符，以便它可以用作包装类型的替身。这实际上是受到@l33t 听起来很愚蠢的回答的启发。

首先（来自 C++）我意识到在 C# 中，构造数组元素时不会调用默认 ctor。相反——即使存在用户定义的默认构造函数！-- 所有数组元素都是零初始化的。这确实让我感到惊讶。

因此，仅提供具有所需值的默认 ctor 的包装类将适用于 C++ 中的数组，但不适用于 C#。一种解决方法是让包装器类型在转换时将 0 映射到所需的种子值。这样，出于所有实际目的，零初始化值似乎是用种子初始化的：

```
public struct MyBool
{
    private bool _invertedValue;

    public MyBool(bool b) 
    {   
        _invertedValue = !b;
    }

    public static implicit operator MyBool(bool b)
    {
        return new MyBool(b);
    }

    public static implicit operator bool(MyBool mb)
    {
        return !mb._invertedValue;
    }

}

static void Main(string[] args)
{
        MyBool mb = false; // should expose false.
        Console.Out.WriteLine("false init gives false: " 
                              + !mb);

        MyBool[] fakeBoolArray = new MyBool[100];

        Console.Out.WriteLine("Default array elems are true: " 
                              + fakeBoolArray.All(b => b) );

        fakeBoolArray[21] = false;
        Console.Out.WriteLine("Assigning false worked: " 
                              + !fakeBoolArray[21]);

        fakeBoolArray[21] = true;
        // Should define ToString() on a MyBool,
        // hence the !! to force bool
        Console.Out.WriteLine("Assigning true again worked: " 
                              + !!fakeBoolArray[21]);
} 
```

此模式适用于所有值类型。例如，如果需要使用 4 进行初始化等，可以将整数映射为 0 到 4 等。

我很想像在 C++ 中那样制作它的模板，提供种子值作为模板参数，但我知道这在 C# 中是不可能的。还是我错过了什么？（当然在 C++ 中映射是完全没有必要的，因为可以提供一个默认的 ctor 来调用数组元素。）

FWIW，这是一个 C++ 等价物：[https](https://ideone.com/wG8yEh) ://ideone.com/wG8yEh 。

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2016-05-26T23:25:19.253

如果您可以反转逻辑，则可以使用该`Array.Clear()`方法将布尔数组设置为 false。

```
 int upperLimit = 21;
        double optimizeMe = Math.Sqrt(upperLimit);

        bool[] seiveContainer = new bool[upperLimit];
        Array.Clear(seiveContainer, 0, upperLimit); 
```

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2020-09-07T06:54:06.360

我有点惊讶没有人制作非常简单但超快的 SIMD 版本：

```
 public static void PopulateSimd<T>(T[] array, T value) where T : struct
  {
     var vector = new Vector<T>(value);
     var i = 0;
     var s = Vector<T>.Count;
     var l = array.Length & ~(s-1);
     for (; i < l; i += s) vector.CopyTo(array, i);
     for (; i < array.Length; i++) array[i] = value;
  } 
```

基准：（数字是针对 Framework 4.8，但 Core3.1 在统计上是相同的）

```
| 方法 | N | 平均值 | 错误 | 标准差 | 比率 | 比率SD |
|----------- |-------- |---------------:|----------- ----:|--------------:|------:|--------:|
| 达斯吉兹卡 | 10 | 25.975 纳秒 | 1.2430 纳秒 | 0.1924 纳秒 | 1.00 | 0.00 |
| 西姆德 | 10 | 3.438 纳秒 | 0.4427 纳秒 | 0.0685 纳秒 | 0.13 | 0.00 |
| | | | | | | |
| 达斯吉兹卡 | 100 | 81.155 纳秒 | 3.8287 纳秒 | 0.2099 纳秒 | 1.00 | 0.00 |
| 西姆德 | 100 | 12.178 纳秒 | 0.4547 纳秒 | 0.0704 纳秒 | 0.15 | 0.00 |
| | | | | | | |
| 达斯吉兹卡 | 1000 | 201.138 纳秒 | 8.9769 纳秒 | 1.3892 纳秒 | 1.00 | 0.00 |
| 西姆德 | 1000 | 100.397 纳秒 | 4.0965 纳秒 | 0.6339 纳秒 | 0.50 | 0.00 |
| | | | | | | |
| 达斯吉兹卡 | 10000 | 1,292.660 纳秒 | 38.4965 纳秒 | 5.9574 纳秒 | 1.00 | 0.00 |
| 西姆德 | 10000 | 1,272.819 纳秒 | 68.5148 纳秒 | 10.6027 纳秒 | 0.98 | 0.01 |
| | | | | | | |
| 达斯吉兹卡 | 100000 | 16,156.106 纳秒 | 366.1133 纳秒 | 56.6564 纳秒 | 1.00 | 0.00 |
| 西姆德 | 100000 | 17,627.879 纳秒 | 1,589.7423 纳秒 | 246.0144 纳秒 | 1.09 | 0.02 |
| | | | | | | |
| 达斯吉兹卡 | 1000000 | 176,625.870 纳秒 | 32,235.9957 纳秒 | 1,766.9637 纳秒 | 1.00 | 0.00 |
| 西姆德 | 1000000 | 186,812.920 纳秒 | 18,069.1517 纳秒 | 2,796.2212 纳秒 | 1.07 | 0.01 |

```

可以看出，它在 <10000 个元素时要快得多，而在此之后只会稍微慢一些。

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2012-09-01T08:24:29.190

关于这个（重复？）问题还有更多答案：[C# 中的 memset 等价物是什么？](https://stackoverflow.com/questions/1897555/what-is-the-equivalent-of-memset-in-c)

有人对替代品进行了基准测试（他们包括一个不安全的版本，但他们没有尝试`memset`）：[http ://techmikael.blogspot.co.uk/2009/12/filling-array-with-default-value.html](http://techmikael.blogspot.co.uk/2009/12/filling-array-with-default-value.html)

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2016-07-27T12:21:54.837

这是另一种`System.Collections.BitArray`具有这种构造函数的方法。

```
bool[] result = new BitArray(1000000, true).Cast<bool>().ToArray(); 
```

或者

```
bool[] result = new bool[1000000];
new BitArray(1000000, true).CopyTo(result, 0); 
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2017-03-16T10:08:25.693

在创建数组的地方创建一个私有类，并为其设置一个 getter 和 setter。除非您需要数组中的每个位置都是唯一的，例如随机，否则使用 int? 作为一个数组，然后在获取位置是否相等时填充该位置并返回新的随机值。

```
IsVisibleHandler
{

  private bool[] b = new bool[10000];

  public bool GetIsVisible(int x)
  {
  return !b[x]
  }

  public void SetIsVisibleTrueAt(int x)
  {
  b[x] = false //!true
  }
} 
```

或使用

```
public void SetIsVisibleAt(int x, bool isTrue)
{
b[x] = !isTrue;
} 
```

作为二传手。

* * *

## 回答 #26

> 赞同：-2
> 
> 时间：2014-06-11T17:58:17.867

```
Boolean[] data = new Boolean[25];

new Action<Boolean[]>((p) => { BitArray seed = new BitArray(p.Length, true); seed.CopyTo(p, 0); }).Invoke(data); 
```

# regex - Reg Ex 匹配数字和逗号

> ID：1014006
> 
> 赞同：1
> 
> 时间：2009-06-18T17:21:53.960
> 
> 标签：regex, perl

我有一个 .csv 文件，我只对带有逗号分隔整数的行感兴趣：

```
23,2,4,56,78,9,4,6 
```

一行中逗号分隔值的数量应大于 5（或其他）。

我在 perl 中这样做。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-18T17:24:39.153

```
/^(\d+,){4,}\d+$/ 
```

匹配一组数字，后跟逗号。数字逗号对被视为一个组，它本身必须重复至少四次。然后匹配序列中不需要后跟逗号的最终数字。

如果您不需要捕获数字，请改用非捕获组（会稍微快一些）：

```
/^(?:\d+,){4,}\d+$/ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T17:28:15.357

```
/\d{1,3}(,\d{3}){0,4}/ 
```

这只会匹配格式正确的逗号分隔数字（例如 100,000,000）。在逗号分隔的文件中使用逗号分隔的数字仍然是一个糟糕的主意，但我离题了。该正则表达式在上下文中最不可能出现问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T17:28:04.530

不管怎样：

```
/^([0-9]\+,?)\+$/ 
```

**编辑**以更正评论中指出的错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-18T20:19:38.237

```
/\d+(?:,\d+)*/ 
```

或包括负数

```
/-?\d+(?:,-?\d+)*/ 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-18T20:24:38.490

您可能需要考虑使用 [0-9] 而不是 \d，因为 \d 可以匹配 Unicode 认为是数字但不是标准阿拉伯数字的事物。

# ironpython - Iron Python / Iron Ruby EXE

> ID：1014007
> 
> 赞同：7
> 
> 时间：2009-06-18T17:22:01.403
> 
> 标签：ironpython, ironruby

我一直梦想从脚本语言创建一个“真正的 exe”。随着基于 DLR 的 Python 和 Ruby 实现可用，这是否更接近现实？

我想创建一个“真正的应用程序”：

*   Windows 窗体应用程序
*   控制台应用程序
*   Windows 服务

并让分发单元是一个已编译的 exe。

这可能吗？还是 MS 刚刚创建了基于 .NET 的脚本文件解释器？

如果您这样做，您将如何构建您的应用程序/项目？您使用的是 C# 和 DLR 代码的混合体吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-18T18:51:33.693

IronPython 或 IronRuby 项目可以很好地编译为 dll 或可执行文件，并且在任何方面都是“真正的”可执行文件，但前提是运行它们的人必须安装相关的 .Net 框架和依赖项（依赖项可能存在于默认情况下相同的目录，但必须安装框架）。与 Visual Studio 的集成仍然不存在，但[IronPythonStudio](http://www.codeplex.com/IronPythonStudio)等项目使用免费的 VS Shell 效果很好。DLR 作为 VS 2010 中 c# dynamic 的依赖项的存在应该意味着与 Iron* 组的 VS 集成成为一个更容易的目标和更高的优先级。

结果绝不会被解释（CIL 在运行时或在需要时通过 ngen 被编译成机器代码）并且 DLR 的某些方面意味着某些操作以类似于后期绑定的方式延迟，但更强大和更重要的是使用一些复杂的缓存机制与幼稚的口译员相比，这可以相对较快。

许多传统解释的脚本语言正在创建自己的基于 VM 的编译策略或利用现有的编译策略（如 JVM、.Net CLR 或像[LLVM](http://llvm.org/)这样的开放策略），因为这会在许多常见情况下显着提高性能。

在 Iron* 语言的情况下，以 MS CLR 为基础的好处是，生成的可执行文件在最常见的操作系统系列的绝大多数安装中“正常工作”。与 Java 相比，在许多操作系统中，通过直接单击 / 或通过外壳程序“执行”，jar 文件无法“运行”。与此相反的是，与基于 JVM 或 LLVM 的解决方案相比，这降低了互操作性，其中平台支持更广泛，但不可避免地在操作系统集成方面更加多样化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T17:47:09.757

[您可以使用Py2Exe](http://www.py2exe.org/)从常规 python 创建 exe 。但是不应该有任何东西阻止您使用 Visual Studio 或[SharpDevelop使用 IronPython 创建 exe](http://www.icsharpcode.net/OpenSource/SD/)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2010-11-25T21:01:40.380

虽然与 Iron* 问题没有直接关系，但对于想要从 python 脚本中获取二进制文件的人来说可能很有趣：[pyinstaller](http://www.pyinstaller.org/)

适用于 Windows（32 位和 64 位）、Linux（32 位和 64 位）和 Mac OS X（仅限 32 位）

适用于从 1.5 到 2.7 的任何 Python 版本

# apache-flex - AS3：getTimer() 方法和 Timer 类的准确度如何？

> ID：1014009
> 
> 赞同：3
> 
> 时间：2009-06-18T17:22:43.790
> 
> 标签：apache-flex, flash, actionscript-3, actionscript

我正在制作游戏（shmup），我开始质疑 ActionScript 中计时器的准确性。当然，当您想要以几秒或分秒的数量级计时时，它们已经足够准确了，但是当您达到更精细的范围时，它的表现似乎很差。这使得像宇宙飞船每秒发射一百个激光这样的事情变得非常困难。

在下面的示例中，我测试了间隔多长时间（平均）在 1000 个计时器滴答之间，用于 30 毫秒。一次又一次，结果是~35-36ms。减少时间，我发现定时器延迟的最低值约为 16-17 毫秒。这给了我大约 60 的最大 fps，这在视觉上非常棒，但也意味着我每秒发射的激光数不可能超过 60 次 :-(。我在 100 和 1000 次循环中运行了几次这个测试，但是对于这两个30ms 测试和 1ms 测试结果没有改变。我最后打印到 textField 因为使用 trace() 并在调试模式下启动 swf 似乎会对测试产生负面影响。所以我想知道的是：

*   这个测试是对 Timer 类性能的一个不错的衡量，还是我的结果有问题？
*   这些结果在其他机器上会发生巨大变化吗？

我知道这取决于 getTimer() 方法的准确性，但我发现的关于该主题的讨论通常围绕 getTimer() 在较大间隔上的准确性。

```
包裹
{

    导入 flash.display.Sprite；
    导入 flash.events.TimerEvent；
    导入 flash.text.TextField；
    导入 flash.utils.getTimer；
    导入 flash.utils.Timer；
```

```
public class testTimerClass extends Sprite
{
    private var testTimer:Timer = new Timer(30, 1000);
    private var testTimes:Array = new Array();
    private var testSum:int = 0;
    private var testAvg:Number;
    private var lastTime:int;
    private var thisTime:int;

    public function testTimerClass()
    {
        testTimer.addEventListener(TimerEvent.TIMER, step);
        testTimer.addEventListener(TimerEvent.TIMER_COMPLETE, printResults);
        lastTime = getTimer();
        testTimer.start();
    }

    private function step(event:TimerEvent):void
    {
        thisTime = getTimer();
        testTimes.push(thisTime - lastTime);
        lastTime = thisTime;
    }

    private function printResults(event:TimerEvent):void
    {
        while (testTimes.length > 0)
        {
            testSum += testTimes.pop();
        }
        testAvg = testSum / Number(testTimer.repeatCount);              
        var txtTestResults:TextField = new TextField();
        txtTestResults.text = testAvg.toString();
        this.addChild(txtTestResults);  
    }       
} 
```

}

我想最好的方法是在同一帧中以不同的位置绘制多个激光，并避免使用多个 Timer 对象。

编辑：我使用 stage.frameRate 来更改渲染 frameRate 并在几个帧率上运行测试，但没有任何变化。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-19T03:39:12.700

Tinic Uro（Flash Player 工程师）前段时间就这个问题写了一篇[有趣的博客文章。](http://www.kaourantin.net/2006/05/frame-rates-in-flash-player.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T13:44:39.123

Intead of using the timer class at all, I would put my update code in and enterframe eventlistener.

Then use getTimer(), to find out how much time has passed since last update, and then a bit of bit of math to calculate movement, laser "spawning" etc. This way the game should perform the same no matter if you getting 60FPS or 10FPS.

This also prevents weird game behavior if the the FPS drop temporary, or if the game is running on a slow machine.

For the most part the math is pretty simple, and when it is not, you can usually "cut corners" and still get a result good enough for a game. For simple movement you can simply multiply movement offset with time since last update. For acceleration, you need a second degree equation, but could simplify be multiplying again.

**In response to jorelli comment below:**

The collision detection problem can be solved by better code, that does not just check the current state, but also what happened between the previous state and the current. I've never had problems with the keyboard. Maybe you should try this nifty little class: [http://www.bigroom.co.uk/blog/polling-the-keyboard-in-actionscript-3](http://www.bigroom.co.uk/blog/polling-the-keyboard-in-actionscript-3)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-03-16T08:01:36.673

BitmapData.scroll 和 BitmapData.copyPixels 是目前在 flash 中渲染的最快方式，尽管在少数系统上，使用带有 gpu 加速的影片剪辑稍微快一些。每个四边形在 OpenGL 中被渲染为单独的纹理，因此它不是您对普通 GPU 加速应用程序所期望的。我知道，因为我在我的游戏中分析了两种方式。您可以做的一件事来改善响应时间是从输入事件处理程序调用您的游戏更新。这样，即使您的游戏帧速率较低，您也能听到正确定时的声音，并且应用程序会感觉更灵敏。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-19T12:39:40.237

我刚刚尝试运行您的示例代码，除了作为框架脚本之外，完全按原样运行，并且我所在的位置 Timer 完全按照您的预期工作。使用 30 毫秒的计时器，平均值约为 33-34，使用 3 毫秒的计时器，平均值约为 3.4 或 3.5。使用 1 毫秒计时器，我在 1000 次试验中得到 1.4 到 1.6 之间。它在 Flash 和浏览器中以这种方式工作。

至于准确性，请参阅卢克的回答中蒂尼克的博客文章。但是对于频率的上限，如果您仅使用您发布的示例代码获得的事件间隔不超过 16 毫秒，那么这可能是奇怪的事情，或者这可能是您的浏览器提供 Flash 计时消息的速度的上限。如果您在实际游戏中获得这些结果，我认为您只是拥有阻止计时器事件的同步代码。

还有一件事-我知道这不是您所要求的，但是在 ENTER_FRAME 处理程序中处理您的游戏逻辑确实更明智。生成激光的代码是每 30 毫秒还是每 3 毫秒运行一次并不重要，屏幕每帧只重绘一次（除非你强迫它更频繁地更新，你可能不应该这样做）。因此，在屏幕刷新之间发生的任何事情都只是降低了整体帧速率的开销，因为只要稍微聪明一点，就应该可以实现与从更频繁执行的计时器中获得的完全相同的结果。例如，您可以每 30 毫秒生成 10 个激光，而不是每 3 毫秒生成一个激光，并沿着其飞行路径将每个激光移动一定距离，就好像它是在 3 或 6 或 9 毫秒之前创建的一样。

另一种在帧事件之外运行逻辑的自然方法是创建一个“理论上”每 T 毫秒运行一次的游戏循环。然后，在您的`ENTER_FRAME`处理程序中，只需迭代该循环 F/T 次，其中 F 是自上一帧事件以来经过的毫秒数。因此，如果您希望游戏理论上每 5 毫秒更新一次，并且您希望屏幕以 30FPS 更新，您只需以 30FPS 发布，并且在您的`ENTER_FRAME`处理程序中，您将连续调用主游戏循环 5-7 次，具体取决于自上一帧以来已经过了多长时间。在屏幕上，这将为您提供与使用 5 毫秒计时器事件相同的结果，并且将省去大部分开销。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-18T17:48:45.573

> 这给了我大约 60 的最大 fps，这在视觉上很棒，但也意味着我每秒发射的激光不可能超过 60 次 :-(

我会说你很幸运能够获得这种 FPS，并且你的大多数用户（假设你的观众是整个互联网）很可能不会达到那种帧速率。

我同意 Flash 播放器的能力可能不足以实现您想要实现的目标。

# sql-server-2005 - Reporting Services 2005 在虚拟机上的安排

> ID：1014011
> 
> 赞同：2
> 
> 时间：2009-06-18T17:22:59.623
> 
> 标签：sql-server-2005, virtualization, reportingservices-2005

我在确定如何最好地实施报告服务的不同部分时遇到了一些困难。

我们公司刚刚购买了一系列新的服务器和一个共享 SAN，以支持我们不断增长的基础架构。

我们的服务器正在运行 VMware，我们有几个虚拟机，每个虚拟机都有自己的任务在一组物理机之间进行负载平衡。我们目前有一个运行终端服务的应用程序服务器和一个运行 2005 的 SQL 框来保存我们的数据，以及其他几个用于与我们的数据库无关的其他目的的服务器。

我的问题是：在虚拟环境中理想的报告服务安装是什么？如果我们将所有东西都安装在当前的 SQL 机器上，或者将安装分割成多个虚拟机，我们仍将处理相同数量的资源。将配置分割成不同的机器有助于负载平衡，但分割也需要更多的许可证。

我目前的想法是将报表服务器数据库安装在当前拥有我们的 sql 数据库的同一个盒子上，并将报表服务器服务安装在另一个盒子上，以使 iis 远离我们的操作数据的 sql 盒子。

从一种配置迁移到另一种配置有多困难，或者一旦做出决定，我是否会将自己锁定在某件事上？

编辑：添加我的选项

我能想到的不同配置

A) 好处：最容易设置。缺点：横向扩展需要迁移后端

*   1\. SQL Data Box 保存我们的生产数据
*   2\. Reporting Services DB、Reporting Services Service 和 IIS

B) 好处：支持横向扩展而不迁移后端

*   1\. 保存生产数据的 SQL Data Box 和 Reporting Services DB
*   2\. Reporting Services 服务和 IIS

C) 好处：最适合跨硬件负载平衡虚拟机，支持横向扩展而不需要更改。缺点：许可证最昂贵

*   1\. SQL Data Box 保存我们的生产数据
*   2\. 报告服务数据库
*   3\. Reporting Services 服务和 IIS

D) 好处：许可证最便宜。缺点：很多

*   1\. 一个盒子里的一切

所以选项 A 或 B 是我的领先者，B 没有我能想到的缺点，但不确定什么样的负载报告服务对其数据库有显着影响，因为将查询生产数据框对于原始数据也是如此。选项 A 将允许我切出一个新的虚拟服务器并使用它，同时开发并保留我们生产箱中的所有内容，然后我们可以更改我们的数据源以指向生产箱并将其推出。

我仍然不确定最好的选择是什么，所以如果其他人有意见，他们会受到欢迎。

再次感谢，韦斯利

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-20T02:31:02.423

我从来没有做过，但是[这篇文章](http://technet.microsoft.com/en-us/library/ms143703(SQL.90).aspx)告诉你如何进行远程安装，这很常见。

[本文](http://technet.microsoft.com/en-us/library/ms156421(SQL.90).aspx)告诉您如何将数据库移动到另一台机器上。大概这将允许您在两种方法之间迁移。

就我个人而言，我会尝试选择您希望坚持使用的选项，因为根据我对微软的经验，安装说明比迁移说明更可靠。

# mysql - MySQL - Update view column every time the row is SELECTed

> ID：1014014
> 
> 赞同：2
> 
> 时间：2009-06-18T17:23:32.790
> 
> 标签：mysql, triggers

I have a table that has a "view_count" column.

I would like to increment said column every time I select the row (even with a generic SELECT, such as SELECT * FROM table WHERE 1.. This would increment by 1 the view_count of all rows).

Is there a way to do it automatically "server-side" (where mysql is the server and my application is the client), ie without an UPDATE every time?

EDIT: Since a couple of people asked me why I wanted to do this, and a few misunderstood my request, imagine that's a forum software, and the table is the thread table. Each thread has a view count, and you want to update it every time you display the thread in the main page (I know usually the threads' view count are only updated when you actually view it, but it's the best example i could come up with, my particular case is kinda long and complicated T_T)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-18T17:30:18.693

做不到。您基本上想要一个[触发器](http://dev.mysql.com/doc/refman/5.0/en/create-trigger.html)，`SELECT`并且触发器仅支持`INSERT`,`UPDATE`和`DELETE`. 您可以得到的最接近的方法是通过存储过程运行与表的所有交互，听起来您希望在所有条件下都强制执行此行为。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T17:34:23.693

为什么不像这样发出一条 SQL 语句：

```
UPDATE tableName SET viewCount = viewCount + 1; SELECT tableName.col1, tableName.col2; 
```

这甚至可以用任何语言轻松地动态创建。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T17:30:02.110

您可以在会话范围内执行此操作：

```
SET @view_count := 0;

SELECT  v.*,
        @view_count := @view_count + 1 AS view_count
FROM    view 
```

对于查看的每一行，您将获得一个递增值：

```
SELECT  q.*,
        @view_count := @view_count + 1 AS view_count
FROM    (
        SELECT  1 AS col
        UNION ALL
        SELECT  2 AS col
        ) q;

-- -- 
 1  1
 2  2

SELECT  q.*,
        @view_count := @view_count + 1 AS view_count
FROM    (
        SELECT  1 AS col
        UNION ALL
        SELECT  2 AS col
        ) q;

-- -- 
 1  3
 2  4 
```

但是，这只会计算您会话中的观看次数，而不是总观看次数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-18T17:30:34.903

我不相信有一种简单的方法可以在服务器端执行此操作。触发器仅在 UPDATE、INSERT 和 DELETE 上执行。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-18T17:40:30.660

存储过程，但它很痛苦。我会在其他地方实施安全性。

# class - Which is a Better class design: Page calls class and page calls BLL or Class calls BLL?

> ID：1014018
> 
> 赞同：3
> 
> 时间：2009-06-18T17:23:57.687
> 
> 标签：class

If I have an object, say, a user class, with say First & Last Name properties what is a better way to populate it:

1.  The PAGE instantiates the class and the PAGE calls the business layer to popualte the class. (In this case the class is essentially a container for data).

or

2.  The class itself not only has the properties, but it also has a method to call the business layer, populate itself and return itself populated to the page.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-18T17:26:13.317

I'd go for the former. I think it's cleaner, and that way your User class can stand on its own, even if the business layer changes.

Note, also, that the former would seem more conducive towards using a 3-tiered MVC architecture as well.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-18T17:31:34.387

这实际上取决于您将使用该类的目的。它是否只会成为您填充并用于显示的容器？您是否要修改该数据并使用它来更新您的数据库？

基本上，您正在查看的是 DAO/DTO 功能集。如果 #1 您正在谈论数据传输对象 (DTO)，它只是数据的容器。在案例 #2 中，您谈论的是数据访问对象 (DAO)，它是一个了解如何保存数据以及从何处获取数据的对象。

您缺少的是案例#3，它是一个了解与您的数据关联的业务逻辑的业务对象。即我的用户有什么权限，我的用户在公司内的职位是什么（假设是业务用户）。

不幸的是，没有一个正确的答案，这完全取决于您要构建的内容。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-18T17:26:54.970

I prefer the former. With the latter you end up forcing dependencies in the weirdest places.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-18T17:43:29.593

我建议阅读有关**工厂方法**和**抽象工厂**模式的信息，以便将类的创建委托给类或页面以外的其他东西。原因如下：

该页面专注于页面内容 - 它只关心包含名字和姓氏的内容，而不是类的类型。因此，它不应该创建类，只要求实现。该页面只关心一个接口，可能有 firstname 和 lastname 属性，可能还有 save() 方法。

如果该类知道业务层的细节，那么您就有了不需要的依赖项。要更改业务层，您必须更改类内部或更改页面以创建不同的类。如果您对许多类都这样做，那么更改业务层将需要对类和/或页面层进行许多更改。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-18T17:29:43.687

我将为所有实现 reloadData() 方法的业务对象提供一个抽象超类。可以和web环境分开测试，web环境不依赖数据层。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-18T17:29:56.837

我的看法是你必须分离关注点。当您的依赖项较少时，测试也容易得多。我会使用第一种方法。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-07-01T15:24:11.003

如果对象有一个调用 Business.Save() 方法的 .Save() 方法呢？

也许这混合得太多了。

# delphi - Vista: Can an EXE bypass user confirmation while invoking another EXE?

> ID：1014022
> 
> 赞同：2
> 
> 时间：2009-06-18T17:24:31.430
> 
> 标签：delphi, windows-vista, uac, createprocess

I have 2 applications written in Delphi. The first exe (with a user interface) calls another using ShellExecuteEx(), which runs as a background process.

When the first exe invokes the second, one of these two things happen:

1.  When I log in as an admin, a UAC dialog comes up with the Allow/Cancel prompts. Selecting Allow continues the execution.

2.  If I log in as non-admin, an admin credentials dialog box is displayed, and I need to enter the admin username/password to continue.

On both occasions, I want the second exe to run without any user intervention. How can I make it possible?

And yes, I tried applying the ElevateCreateProcess mitigation as suggested by SUA tool, but it doesn't seem to work - the behaviour is as before.

Thanks for your help.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T17:33:01.997

第一个 EXE 需要以提升的权限启动，才能在没有 UAC 提示的情况下调用第二个。或者...您可以为第二个 EXE 使用清单，告诉 Vista 它不是管理工具，并且仅以当前用户身份运行。

**另存为 Second.exe.manifest**

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<assembly xmlns="urn:schemas-microsoft-com:asm.v1" manifestVersion="1.0">
<!-- Vista UAC Support -->
<ms_asmv2:trustInfo xmlns:ms_asmv2="urn:schemas-microsoft-com:asm.v2">
  <ms_asmv2:security>
    <ms_asmv2:requestedPrivileges>
      <ms_asmv2:requestedExecutionLevel level="asInvoker" />
    </ms_asmv2:requestedPrivileges>
  </ms_asmv2:security>
</ms_asmv2:trustInfo>
</assembly> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T20:19:31.200

你的第二个文件的文件名是什么？

Vista 假定某些文件名需要管理员权限 - 尤其是名称为“setup”或“install”的文件。

另外：如果您想要的是能够以管理员权限运行程序而无需 Vista 抛出 UAC 提示，那么您就不走运了。如果可能的话，那将是对安全性的严重破坏。

您的第二个程序是否*需要*管理员权限？

当您尝试直接从 Explorer 执行第二个程序时会发生什么？UAC 提示？如果是这样，那么 Vista 正试图以管理员身份运行它，或者因为文件的文件名，或者因为清单（内部或外部）请求是。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T17:33:46.940

是的，您需要一个与此类似的应用程序清单

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?> 
```

```
 <assemblyIdentity version="1.0.0.0" processorArchitecture="X86" name="UacTest"   type="win32"/>   
       <trustInfo xmlns="urn:schemas-microsoft-com:asm.v3">   
       <security>  
          <requestedPrivileges>  
             <requestedExecutionLevel level="highestAvailable"/>    
          </requestedPrivileges>  
       </security>  
    </trustInfo>  
  </assembly> 
```

记下“requestedExecutionLevel”标签

# drupal - How to read the filter variable in a php code block in views 2?

> ID：1014023
> 
> 赞同：1
> 
> 时间：2009-06-18T17:24:38.997
> 
> 标签：drupal, drupal-views

I'm trying to create an img link manually with php in the header field of a view, in drupal 6\. I need to read the value of one of the filters, but can't find the right variable to read. I thought I could print_r($view->filters) but it didn't give me anything, and I eventually found out that isset($view) is false.

Am I looking the wrong way?

The context I'm writing in is the header field of the view, with php code as input format. Do I have to "enable" the $view variable for reading in this context somehow?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-11T09:45:56.267

好的，我找到了，这真的很容易：

```
$pa_view = views_get_current_view();
$pa_nr = $pa_view->display['default']->display_options['filters']['field_nummer_value']['value']['value']; 
```

# java - Google App Engine Java 上的 RESTful 应用程序？

> ID：1014034
> 
> 赞同：83
> 
> 时间：2009-06-18T17:26:51.677
> 
> 标签：java, google-app-engine, rest, jersey, restlet

我想在 Google App Engine 上创建一个 RESTful 应用程序。我想提供 XML 和 JSON 服务。我对 Restlet、Resteasy 和 Jersey 进行了简短的试验。除了 Restlet 中的一些简单示例之外，我在其中任何一个方面都没有取得太大的成功。

您能否分享您使用 Java 在 Google App Engine 上创建 Restful Web 应用程序的经验，或者提供有关 GAE 上上述工具包的任何见解？

谢谢！

编辑（2009-07-25）：

我决定暂时使用 Restlet。到目前为止，它似乎完美无缺。请发表您可能有的任何其他见解/意见。你遇到过什么问题？你在 GAE/J 上成功使用 Jersey/Restlet/Resteasy 了吗？如果是这样，我们想听听！

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-07-25T07:23:57.363

我很高兴地报告 Restlet M3 在 AppEngine 1.2.2 上运行良好。[我已按照http://restlet.com/technical-resources/restlet-framework/guide](http://restlet.com/technical-resources/restlet-framework/guide)找到的“第一步”和“第一个资源”教程进行操作。

所以，在我看来，Restlet 是您的 GAE/J Restful 应用程序的答案。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2011-01-27T06:18:25.597

我在 GAE 上使用泽西岛。以下是对设置它感兴趣的人的链接：（我使用的是 GAE SDK v1.4.0）：

[http://tugdualgrall.blogspot.com/2010/02/create-and-deploy-jax-rs-rest-service.html](http://tugdualgrall.blogspot.com/2010/02/create-and-deploy-jax-rs-rest-service.html)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-07-17T16:22:25.827

我也将开始探索这个，但还没有开始。我确实找到了这个框架，说它应该可以工作，但就像我说的还没有尝试过。

[http://wiki.restlet.org/docs_1.2/13-restlet/275-restlet/252-restlet.html](http://wiki.restlet.org/docs_1.2/13-restlet/275-restlet/252-restlet.html)

如果你让它工作，或者设法让上述建议之一工作，更新每个人，因为我相信对此有兴趣。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2010-01-19T08:58:10.843

我在 Google AppEngine 上将 Restlet 和 Guice 一起使用。恕我直言，它们非常适合。有关详细信息，请参阅我最近的博客文章：http: [//haraldpehl.blogspot.com/2009/11/google-appengine-restlet.html](http://haraldpehl.blogspot.com/2009/11/google-appengine-restlet.html)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-12-05T10:54:53.480

由于这些勇敢的旧解决方案被修补在一起，谷歌显然提供了一个 Eclipse 插件来创建一个启动项目，该项目生成一个 App Engine 应用程序、一个 Android APK 和一个 Web 应用程序，所有这些都通过一个由一组定义的接口相互通信带注释的对象声明。

我自己还没有尝试过，但在尝试上述早期消息中描述的任何更异构的示例之前，请先看看：

[https://developers.google.com/eclipse/docs/appengine_connected_android](https://developers.google.com/eclipse/docs/appengine_connected_android)

这个谷歌视频也很丰富：

[http://www.youtube.com/watch?v=NU_wNR_UUn4](http://www.youtube.com/watch?v=NU_wNR_UUn4)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-06-19T20:50:01.113

对于它的价值，关于如何使 Jersey 在 GAE 上工作的[Jersey 用户列表](https://jersey.dev.java.net/communicate/)已经进行了相当多的讨论。由于 GAE 限制（白名单中缺少类——希望随着时间的推移而解决），这项工作有点乏味，但显然可以工作。因此，虽然并非易事，但这可能是您最好的选择；尤其是 因为所有框架面临的许多问题都是相同的（由 GAE 强加）。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-03-30T01:33:48.897

好吧，我强烈建议你看看[play framework](http://www.playframework.org/)

看看主页上的视频

它有一个[gae模块](http://www.playframework.org/modules/gae)

以[siena](http://www.playframework.org/modules/siena)作为 orm 来处理 gae 数据存储

从到目前为止我见过的所有 java 框架中，我认为它的学习曲线更容易，

*   很棒的[文档](http://www.playframework.org/documentation/1.1.1/home)，

*   开发完整应用程序的[教程](http://www.playframework.org/documentation/1.1.1/home#guide)

*   非常活跃和乐于助人的社区，

*   像啤酒一样自由，也像演讲一样自由

*   由于它是开箱即用的无状态设计，因此具有高度可扩展性

*   [好好休息](http://www.playframework.org/documentation/1.1.1/routes#rest)

*   通过它的模块和插件方法高度可定制

此外，考虑到这是一门大学课程，破解代码真的很容易，我可以处理几张票和新功能，而无需任何 java 经验，只需几年用 php 开发 web 应用程序

其他福利

*   它非常容易上手，无需复杂的设置，只需下载并解压缩文件即可

*   出色的开发体验，只需修复代码并点击刷新，在开发模式下运行时即时播放自动编译更改

*   快速轻便

*   全栈，您不必集成繁琐的框架即可使其工作

*   出色的错误报告，不再有无尽的错误堆栈跟踪，只显示错误行

*   周围没有xml配置

*   通过 selenium 集成测试对 tdd 的大力支持

我认为作为学习工具的主要优点是可以窥视源代码而不会感到迷茫和社区支持...文档非常清晰，您只需查看源代码就可以学到很多东西代码...

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-05-24T21:18:15.287

我最近在 GitHub 上与[Jersey、Guice 和 AppEngine](https://github.com/icoloma/simpleds-kickstart)一起制作了一个项目模板。它是使用 SimpleDS 开发的，但可以对其进行修改以轻松使用 Objectify / JDO。该项目在[这里](http://simpleds-kickstart.appspot.com/)进行。

这应该是新项目的良好起点。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-08-14T17:06:21.960

这是一个非常非常好的教程 Restlet/Android/GAE/Objectify 带有一个简单应用程序的示例。抱歉，它是法语，但您可以直接复制/粘贴代码，或使用谷歌翻译。

我跟着它，并在 2 小时内让一个工作的 Android / GAE 服务器一起通信。这是启动或测试 Restlet 的良好基础。

[http://www.tutos-android.com/webservice-rest-android-appengine-restlet-objectify](http://www.tutos-android.com/webservice-rest-android-appengine-restlet-objectify)

祝你好运

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-06-18T19:13:11.567

无论是 Java 还是 .py，最麻烦的 2 个 GAE REST API 操作是图形以及如何取消显示私人信息。[我的小](http://feeds2.feedburner.com/gaerest)gae 休息提要分叉[了另一个](http://www.ohloh.net/p/gae-rest)项目。我确信 Java 会成功，因为 Java 需要并提供更多方式（优势）以及更长（更慢）的成功时间（劣势），而 python 项目打开的成功方式更少（劣势）和更少的开发时间（有利的快速发展）同样取得成功。

# security - Authentification and security model in client/server aplications

> ID：1014042
> 
> 赞同：0
> 
> 时间：2009-06-18T17:27:57.433
> 
> 标签：security, authentication, client-server, token

I'm developing custom client/server application that requires client to log in with their username and password. The user accounts are not related to Windows/AD accounts in any way. After login, client application will request other services from server system.

My question is what is the best way to implement this? What kind of architecture would fit best here? I guess some kind of ticket/token authentication system needs to be implemented???

Thanks

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T18:13:31.790

实际上，您可能希望实现一个在不同部分（登录服务器、客户端、应用服务器）之间传递“票证”的系统。此票证将包含基本信息，例如用户 ID（用户名、行 ID 等）。此票证将使用授权服务器共享的密钥进行加密，或者将使用服务器共享的密钥加盐的票证内容的哈希值进行标记。第一种方式使只有授权服务器可以创建和读取票证，第二种方式使授权服务器可以验证只有授权服务器可以创建票证，但允许任何人读取票证。所有应用服务器都会在继续执行任何应受保护的操作之前检查票证（通过尝试解密或验证哈希匹配）。如果这是一个网络应用程序，那么 cookie 是存储票证的好地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T18:02:16.550

除了客户端/服务器之外，您对您的架构没有说太多，所以我假设您正在使用某种形式的表单设计器，例如 VS 中的 Windows 表单。在这些情况下，我总是使用某种形式的数据库表身份验证，因为它很容易、易于设置并且相当安全。您甚至可以通过这种方式设置组和角色，而无需大惊小怪。

```
Table:  Users
Fields: UserID   PK
        Login    Text
        Password Text
        ...

Table:  Roles
Fields: RoleID   PK
        Role     Text
        ...

Table:  UserRoles
Fields: UserID    FK
        RoleID    FK 
```

# java - jboss problem with JMXConnectorServer

> ID：1014043
> 
> 赞同：0
> 
> 时间：2009-06-18T17:27:58.180
> 
> 标签：java, jboss

I just installed JBoss and tried to run it from Eclipse. When I first tried to run it I got an error stating that ports 8080 and 1098 are already being bound to something else. I changed those in the config files. Here is example of where I changes port 1098 to 10098

```
 <bean class="org.jboss.services.binding.ServiceBindingMetadata">
       <property name="serviceName">jboss:service=Naming</property>
       <property name="bindingName">RmiPort</property>
       <property name="port">10098</property>
       <property name="description">Socket Naming service uses to receive RMI requests from client proxies</property>
    </bean> 
```

After this the port errors went away but I'm getting the following error:

```
Error installing to Start: name=jboss.remoting:protocol=rmi,service=JMXConnectorServer state=Create mode=Manual requiredState=Installed
java.lang.IllegalStateException: BaseClassLoader@dc93be{vfsfile:/C:/jboss-5.1.0.GA/server/default/deploy/jmx-remoting.sar/} classLoader is not connected to a domain (probably undeployed?) for class javax.management.remote.rmi.RMIServerImpl_Stub
    at org.jboss.classloader.spi.base.BaseClassLoader.loadClassFromDomain(BaseClassLoader.java:793)
    at org.jboss.classloader.spi.base.BaseClassLoader.loadClass(BaseClassLoader.java:441)
........ 
```

Do you know what the problem could be or how to go about approaching it?

Thanks,

Tam

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T13:55:47.043

更改 JBoss 的端口不是一件容易的事，因为它会自言自语。如果您更改它侦听的端口，它将失去该通信。

首先，最好尝试关闭正在侦听这些端口的其他进程。它要么是其他 Web 服务器、应用程序服务器，要么有时是 Thunderbird 和 firefox 之类的东西会抢占这些端口。

如果这不是一个选项，那么最好将 jboss 绑定到它自己的 IP 地址，但这仅在 unix/linux 上实用。

因此，如果您真的想将 JBoss 转移到一组不同的端口，那么您可以[按照此处的说明进行操作](http://www.jboss.org/community/wiki/ConfiguringMultipleJBossInstancesOnOneMachine)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-06T17:12:01.737

查看您的进程 ps -f 并终止挂起的进程。这似乎解决了我的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-22T13:18:07.997

我将接受 Kumaria 的回答，因为我在我的一台 Jboss 服务器上也遇到了这个问题，并且在使用 linux 命令检查后，`ps -ef|grep java`我知道有多个实例在运行同一个应用程序，并且很少有依赖实例正在消耗这些应用程序。所以我只是杀死了所有这些多个实例和依赖项`kill -9 instanceNumber`并重新启动了主应用程序并且它工作了:)

# c++ - C++ - Why am i getting SIGTRAP during the execution?

> ID：1014045
> 
> 赞同：1
> 
> 时间：2009-06-18T17:28:14.157
> 
> 标签：c++, breakpoints

While running, my program often stops because of a SIGTRAP. I know, that a SIGTRAP is happening when the compiler finds a breakpoint in the program. But i don't have any breakpoint in my code. (To be sure about it, before the execution, i cleared all the breakpoints..).

I'm using Code::Blocks..

Thanks !

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T17:31:13.870

您是从调试器运行程序吗？

当您构建的二进制文件在源代码方面不是最新的时，这是可能的。

重建一切，然后再试一次。

它发生在我身上很多次。

# c# - Trying to create a SOAP packet that looks like this:

> ID：1014049
> 
> 赞同：0
> 
> 时间：2009-06-18T17:28:42.690
> 
> 标签：c#, soap

I am investigating an existing system that relies on SOAP messages to be passed between the various executables. I am trying to replace one of those applications with one of my own, and looking at the documentation, I am running into a difficulty.

I haven't worked with SOAP prior to this and am not sure what tools to use to accomplish this task, nor even what keywords I should be searching for. What I need to do is to be able to create a SOAP message that looks like this:

```
<SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/" xmlns:xsd="http://www.w3.org/1999/XMLSchema"
> <SOAP-ENV:Body xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/"> <GetSpecialList xmlns="SpecialManagerAPI"/> </SOAP-ENV:Body> </SOAP-ENV:Envelope> 
```

And, I need to send it via TCP to the local IP (127.0.0.1) port 1234 and get responses from it. How do I create above message and what is an easy way to send it?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T17:35:50.870

我强烈建议您花一些时间至少了解一点 Web 服务。在考虑创建和发送消息方面，您已经走错了路。

一个很好的资源是[Windows Communication Foundation 入门](http://msdn.microsoft.com/en-us/netframework/wcf-getting-started.aspx)。此外，请参阅网络广播[概述（第 100 级）](http://msevents.microsoft.com/CUI/WebCastEventDetails.aspx?culture=en-US&EventID=1032344313&CountryCode=US)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-12-19T15:19:00.603

您有三个基本选项：

1.  如果服务有 WSDL 或 DISCO 服务描述，您可以通过添加服务参考（VS 2008 和 VS 2005 以及某些 WCF 插件）或添加 Web 参考（VS 2005）连接到它。用于生成soap 客户端类的这些工具的命令行等价物分别是svcutil.exe 和wsdl.exe。
2.  您可以按照[C. Ross](https://stackoverflow.com/users/16487/c-ross)在他的[回答](https://stackoverflow.com/questions/1014049/trying-to-create-a-soap-packet-that-looks-like-this/1014111#1014111)中建议的方式进行操作，并使用自定义构建的字符串来使用[HttpRequestClass 。](http://msdn.microsoft.com/en-us/library/system.web.httprequest.aspx)
3.  您可以使用[XmlDocument](http://msdn.microsoft.com/en-us/library/system.xml.xmldocument.aspx)类来创建 xml 消息并使用 HttpRequest 类来发送它。我建议您制作一个模板 xml 文档并将其保存为可执行文件中的嵌入式资源。然后，您可以执行 xpath 查询来修改参数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T17:38:14.983

System.Web.HttpRequestClass 将是这样做的最简单的方法。您需要适当地设置标头（尤其是“SOAPAction”标头）。但是，我建议您不要这样做！找到服务的[wsdl](http://en.wikipedia.org/wiki/Web_Services_Description_Language)并使用它通过Visual Studio中的[AddWebReference或](http://msdn.microsoft.com/en-us/library/7h3ystb6.aspx)[Wsdl.exe](http://msdn.microsoft.com/en-us/library/7h3ystb6.aspx)构建您的类。这将为您（或多个）构建一个格式良好的课程！

# objective-c - Why don't I declare NSInteger with a *

> ID：1014053
> 
> 赞同：42
> 
> 时间：2009-06-18T17:29:21.957
> 
> 标签：objective-c, cocoa, pointers, integer, nsinteger

I'm trying my hand at the iPhone course from Stanford on iTunes U and I'm a bit confused about pointers. In the first assignment, I tried doing something like this

```
NSString *processName = [[NSProcessInfo processInfo] processName];
NSInteger *processID = [[NSProcessInfo processInfo] processIdentifier]; 
```

Which generated an error, after tinkeing around blindly, I discovered that it was the * in the NSInteger line that was causing the problem.

So I obviously don't understand what's happening. I'll explain how I think it works and perhaps someone would be kind enough to point out the flaw.

> Unlike in web development, I now need to worry about memory, well, more so than in web development. So when I create a variable, it gets allocated a bit of memory somewhere (RAM I assume). Instead of passing the variable around, I pass a pointer to that bit of memory around. And pointers are declared by prefixing the variable name with *.

Assuming I'm right, what puzzles me is why don't I need to do that for NSInteger?

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2009-06-18T17:32:46.007

`NSInteger`是原始类型，这意味着它**可以本地存储在堆栈**中。您不需要使用指针来访问它，但如果您愿意，您可以。该行：

```
NSInteger *processID = [[NSProcessInfo processInfo] processIdentifier]; 
```

返回一个实际变量，而不是它的地址。要解决此问题，您需要删除`*`：

```
NSInteger processID = [[NSProcessInfo processInfo] processIdentifier]; 
```

`NSInteger`如果你真的想要一个，你可以有一个指针：

```
NSInteger *pointerToProcessID = &processID; 
```

和号是运算符的地址。它将指针设置为`NSInteger`等于内存中变量的地址，而不是指向变量中的整数。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-06-18T17:32:18.130

您不`NSInteger`使用 a声明的原因`*`是因为它不是对象。NSInteger 只是一个`int`或一个`long`：

```
#if __LP64__
typedef long NSInteger;
#else
typedef int NSInteger;
endif 
```

如果在 32 位应用程序中使用，则为 32 位整数，如果在 64 位应用程序中构建，则为 64 位整数。

当然，您*可以*将 an`NSInteger`作为指针传递，但大多数函数只是将参数作为 an`NSInteger`而不是指向它的指针。

另一方面，对象只能作为指针传递给其他函数。这是因为对象具有为它们动态分配的内存，因此不能在堆栈上声明。由于 an `int`or`long`为它们分配了固定数量的内存，因此这不是问题。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-18T17:54:59.043

意思是“`*`指针”。object 变量持有一个指向对象的指针，所以它有一个`*`; NSInteger 变量包含一个 NSInteger，而不是指向 NSInteger 的指针，因此它没有`*`. 将`*`放在该变量上至少会给您一个警告，因为您将整数放入指针变量中。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-18T17:33:15.380

NSInteger 只是 AFAIK 的 int 的 typedef。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-05-01T15:35:45.503

使用指针

```
NSInteger integer1 = 1;
NSLog(@"1\. integer1:%ld &integer1:%p", integer1, &integer1);
//1\. integer1:1 &integer1:0x7ffee59e8a98

NSInteger *integer2 = &integer1;
NSLog(@"2\. integer2:%p &integer2:%p *integer2:%ld", integer2, &integer2, *integer2);
//2\. integer2:0x7ffee59e8a98 &integer2:0x7ffee59e8a90 *integer2:1

*integer2 = 2;
NSLog(@"3\. integer2:%p &integer2:%p *integer2:%ld \t integer1:%ld &integer1:%p", integer2, &integer2, *integer2, integer1, &integer1);
//3\. integer2:0x7ffee59e8a98 &integer2:0x7ffee59e8a90 *integer2:2    integer1:2 &integer1:0x7ffee59e8a98 
```

# wpf - WPF TreeView - 对已选择的项目强制 SelectedEvent

> ID：1014068
> 
> 赞同：2
> 
> 时间：2009-06-18T17:30:56.650
> 
> 标签：wpf, events, treeview, selecteditem

总结性问题：
在 WPF TreeView 中，如何强制在当前是选定项目的项目上选择事件？

详细信息：
我正在尝试通过使用 shift（用于范围）和控件（用于切换项目的选择）添加多选来向我的 WPF TreeView 添加功能。我已经实现了我自己的 SelectedItems 集合，因为 TreeView 只有一个选定的项目。我仍然使用 TreeView 的 SelectedItem 以便它不会破坏键盘功能，但是我会覆盖现有的 ItemContainerStyle 以便即使选择了一个项目，它也不会给出它被选中的外观。但是，我不需要这样做，我只需要突出显示所选树视图项目的文本块的背景，而不是项目的整个宽度，因此我自己处理前景和背景颜色的变化。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-01-11T03:00:02.580

实现 WPF 树视图会使用大量 XAML，因此此答案仅包含代码片段。

我的目标是单击左窗格中的选定树视图项目并刷新右窗格中的项目（如 Windows 资源管理器）。

为了使选择选定的树视图项起作用，我在我的 ViewModel 中的以下 XAML 示例中实现了两个事件：

*   OnItemSelected 使用事件 TreeViewItem.Selected
*   MouseLeftButtonUp 使用事件 TreeViewItem.MouseLeftButtonUp

当我的 MouseLeftButtonUp 事件触发时，我确保表明我使用以下方法处理了该事件：

*   args.Handled = true;

这是 XAML

```
<TreeView Name="MyTreeView" 
    ItemsSource="{Binding Collections}" 
    Margin="0"                           
    Grid.Row="0"
    TreeViewItem.Selected="OnItemSelected"
    TreeViewItem.Unselected="OnItemUnSelected">
    <TreeView.ItemContainerStyle>
        <Style TargetType="{x:Type TreeViewItem}">
            <EventSetter Event="TreeViewItem.MouseLeftButtonUp" Handler="MouseLeftButtonUp"/>
            <Setter Property="IsExpanded" Value="{Binding IsExpanded, Mode=TwoWay}" />
            <Setter Property="IsSelected" Value="{Binding IsSelected, Mode=TwoWay}" />
        </Style>
    </TreeView.ItemContainerStyle>

    <!-- other XAML removed for this answer-->

</TreeView> 
```

这是事件处理程序

```
private void OnItemSelected(object sender, RoutedEventArgs e)
{
     // do something...
}

// additional info: cannot detect mouse down events; preview mouse events also work
private void MouseLeftButtonUp(object sender, MouseButtonEventArgs args)
{
   TreeViewItem tvi = sender as TreeViewItem;
   if (tvi != null)
   {
      // process folder items
      MyViewModel fvm = tvi.Header as MyViewModel;
      if (fvm != null)
      {
         // only process selected treeview items
         if (fvm.IsSelected)
         {
            fvm.IsSelected = true;

            // prevent bubbling once we find the  selected tree view item
            args.Handled = true;
         }
      }
} 
```

# php - PHP：同一目录中的类文件无法识别？

> ID：1014076
> 
> 赞同：1
> 
> 时间：2009-06-18T17:32:29.097
> 
> 标签：php, class, oop

我在同一个目录中有两个 php 文件：

```
test.tattler.php
class.tattler_stats.php 
```

我的 test.tattler 应该创建我的 tattler_stats 的对象，但它给了我这个错误：

```
Fatal error: Class 'tattler_stats' not found in /.../test.tattler.php on line 4 
```

test.tattler 中的代码：

```
<?php

include 'class.tattler_stats.php';

$tattler_test = new tattler_stats( $_REQUEST );

?> 
```

tattler_stats 中的代码：

```
function __construct( $_REQUEST )
{
    $param = $_REQUEST['menu'];

    run();
}

function run()
{
    connect();
    showMenu( $parm ) ;
//rest of class... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T17:35:27.313

确保您实际上是在类文件中声明该类

```
class tattler_stats {
    // class code here
} 
```

如果您已经这样做了，请尝试更具体地指定路径：

```
include(dirname(__FILE__) . DIRECTORY_SEPARATOR . 'class.tattler_stats.php'); 
```

# drawing - 点有向图是否允许具有不同 rankdir 的子图？

> ID：1014092
> 
> 赞同：12
> 
> 时间：2009-06-18T17:34:36.707
> 
> 标签：drawing, dot, directed-graph

使用*点*有向图语言，是否可以创建具有不同 rankdir 的子图？

我尝试了以下方法，但没有成功。尽管子图中存在 rankdir="TB"，但这两个图都是从左到右的。

```
digraph g {
    rankdir="LR";
    LEFT->RIGHT;
    clusterrank="local";

    subgraph cluster1 { 
        rankdir="TB";    
        node[style=filled];         
        color=black;
        TOP->BOTTOM;                
    }   
} 
```

是否有其他语法可以在同一个图中获得上/下和左/右图，或者这不可能？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2010-03-01T12:52:15.887

似乎这是一个长期存在的功能要求：

*   [graphviz.org 上的存档错误](https://web.archive.org/web/20160426130528/http://www.graphviz.org/bugs/b1279.html)
*   [迁移到 Gitlab 的问题](https://gitlab.com/graphviz/graphviz/-/issues/887)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T17:44:25.427

子图有一个`clusterrank`属性，试试这个：

```
clusterrank=local; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-09-15T10:56:03.567

拼命想要相同的功能，我用谷歌搜索了一个“[技巧](https://mailman.research.att.com/pipermail/graphviz-interest/2006q1/003089.html)”：本质上，您添加不可见的边缘（如果需要，还可以添加节点）来降低排名。

# windows-mobile - 如何更换或自定义 Windows Mobile 的锁屏？

> ID：1014093
> 
> 赞同：1
> 
> 时间：2009-06-18T17:34:43.023
> 
> 标签：windows-mobile

如何替换或自定义标准 Windows Mobile 6.1 锁定屏幕以显示具有我的程序功能的窗口？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T02:36:47.740

如果您的意思是设备锁定屏幕，那么您需要创建一个[LASSD](http://msdn.microsoft.com/en-us/library/aa923670.aspx) [LAP dll](http://msdn.microsoft.com/en-us/library/aa923691.aspx)来替换内置的 LAP dll。

我强烈建议阅读并充分理解[LAP 实施问题](http://msdn.microsoft.com/en-us/library/aa923659.aspx)页面并查看 Windows Mobile 6.0 SDK 中的示例 LAP dll。

如果您希望在智能手机（非触摸屏设备）或某些运营商的某些触摸屏设备上工作，您将需要获得特权签名。如果您是一家公司，我建议您对其进行签名。

有一些关于[LAP dll](http://blogs.msdn.com/raffael/archive/2008/05/17/lap-plugin-hangs-the-device-at-startup.aspx)开发的博客文章可能对您有用（或没有用）。

我自己编写了一个 LAP dll，所以我知道所涉及的大部分问题（有很多）。

我遇到的一些问题：

1.  某些设备在启动过程的早期没有正确提供 SIP 或 T9 键盘支持，因此很难在某些设备上输入字符。
2.  一些触摸屏设备，在启动过程的早期，SIP 按钮不会显示（但仍然有效）。
3.  支持全设备加密并非易事。您必须支持正确地“登录”用户，而无需提供有关如何执行此操作的文档。
4.  在大多数设备上安装 LAP dll 会耗尽电池电量。我还没有深入了解这一点，但是安装任何 LAP dll（甚至是 Microsoft 示例）似乎会导致 LAP dll 在屏幕关闭时一直被轮询调用 VerifyUser，从而阻止设备进入挂起状态。这会很快耗尽电池电量。

# c# - 在 C# 中访问被覆盖的公共属性

> ID：1014094
> 
> 赞同：1
> 
> 时间：2009-06-18T17:34:49.637
> 
> 标签：c#, inheritance

这是场景：

```
class BaseClass
{
    public virtual string Prop {get; set;}
}

class ChildClass : BaseClass
{
    public override string Prop {get; set;}
}

//program
...
ChildClass instance = new ChildClass;
Console.WriteLine(instance.Prop); //accessing ChildClass.Prop
... 
```

问题是如何在 ChildClass 的实例中访问 BaseClass.Prop？铸造会成功吗？

```
Console.WriteLine((instance as BaseClass).Prop); //accessing BaseClass.Prop 
```

-EDIT- 很多人建议选角。在 C++ 中它不起作用，因为多态性仍然会确保调用子属性。C#中不就是这种情况吗？

在 C++ 中，您可以通过以下方式解决该问题：

```
instance.(BaseClass::get_Prop()) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-18T17:37:34.733

将 ChildClass 的实例转换为 BaseClass 的实例；即使用：

```
((BaseClass)childClassInstance).Prop 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-18T17:47:59.197

覆盖属性的语义不会让您访问被覆盖属性的基础。这是有道理的。使用 ChildClass 的类不应该关心该属性是否被覆盖。当该属性被另一个类使用时，由 ChildClass 返回适当的值。

通常，像这样的问题表明试图解决不同的问题。您面临哪些需要直接访问基本属性的问题？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-18T17:37:47.323

您没有收到该代码的编译器错误吗？

在任何情况下， ChildClass.Prop 都不会覆盖 BaseClass.Prop - 它会隐藏它。你真的应该把它声明为

```
 public new string Prop {get; set;} 
```

您可以通过 访问基类中的任何成员`base.Member`。在这种情况下，`base.Prop`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-18T17:38:00.943

```
Console.WriteLine(((BaseClass)instance).Prop); //BaseClass.Prop 
```

这是有效的，因为该属性没有被覆盖，它是隐藏的。如果您将“ `override`”关键字添加到派生类属性中，它将不再起作用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-18T17:38:21.753

```
BaseClass baseInstance = instance as BaseClass;
Console.WriteLine(baseInstance .Prop); //accessing BaseClass.Prop 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-18T17:38:59.803

您的 ChildClass 的 Prop 属性隐藏了 BaseClass 的 Prop 属性。这应该是编译器警告。

编辑：您必须决定您想要哪种行为，多态性或新属性声明，因为 c# 允许两者。

*   对多态行为使用虚拟/覆盖
*   将 new 用于“new-but-same-name”属性行为

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-18T17:40:59.020

将`new`关键字与 the 一起使用`conversion`，它应该可以工作

比如`public new string Prop { [...] }` 和`Console.WriteLine((instance as BaseClass).Prop);`

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2009-06-18T17:37:56.327

就像任何基础成员一样：base.Prop

# ruby-on-rails - Rails 路线问题

> ID：1014095
> 
> 赞同：0
> 
> 时间：2009-06-18T17:35:15.067
> 
> 标签：ruby-on-rails

Rails Routes 的规则是否从 Rails 1.2.3 更改为 Rails 2.2.3？我最近升级了一个应用程序，而不是重定向到正确的页面，它现在重定向到主页（或路由页面）。

我唯一能想到的是 Rails 2.2.3 中的路由规则发生了变化。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-18T18:07:14.513

[是的，您可以在此处](http://weblog.rubyonrails.org/2007/9/30/rails-2-0-0-preview-release)看到很多更改（查看 Action Pack 资源部分）*“这是 2.0 的大部分操作已经发生的地方*”。如果您使用的是旧的分号语法，那么这很可能是问题所在。您想发布您的路线配置并简要说明什么不起作用吗？

此外，为了诊断路由问题，我发现运行“rake routes”非常有用（尽管将终端窗口设置为宽）。

克里斯

# macos - 如何在 Mac 上卸载 NetBeans？

> ID：1014099
> 
> 赞同：3
> 
> 时间：2009-06-18T17:36:10.680
> 
> 标签：macos, netbeans, uninstallation

我目前在运行 leopard 的 mac 上安装了 NetBeans 6.5。我在 Google 上搜索了如何卸载它，NetBeans 网站说要右键单击它，选择“显示包内容”，卸载程序应该在那里，但它不是。

在这种情况下如何完全卸载 NetBeans？谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-12-10T15:49:07.627

请注意，NetBeans 在您的主目录中留下了一些隐藏的配置目录。您可能也想删除这些：

`.asadminpass`和`.asadmintruststore`- 包含 Glassfish（Java EE 应用程序服务器）内容的目录

`.netbeans`- `.netbeans-registration`NetBeans 配置目录

`.nbprofiler`- 来自 NetBeans 分析器的东西

在终端窗口中，您可以使用 列出所有文件和目录（包括隐藏的文件和目录）`ls -la`，并且可以使用例如删除它们`rm -rf .netbeans`（小心最后一个命令，它会删除内容，因此您无法将其取回）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-10-09T22:55:49.040

# 编制清单

这是您需要查找和删除文件和文件夹的角落和缝隙的列表。我从这个页面上列出的多个来源编译了这个列表。

我的清单在带有 NetBeans 8.0.2 的 Mountain Lion 10.8.5 中对我来说是正确的。当然，事情可能会在未来或过去发生变化。

对于 NetBeans 版本之间的某些升级，有些可能不是必需的。但是，如果您想要一个真正的*全新*安装，那就去吧。

您可以编写一个 shell 脚本来执行此删除操作。但我只是手工完成，因为这种春季大扫除并不经常发生。

我建议在升级 NetBeans 之前制作每个项目的备份副本。

## 主文件夹

一些隐藏的文件夹可能会直接出现在您的主文件夹中。as第`.`一个字母默认隐藏文件/文件夹。要在 Finder 中永久显示此类文件/文件夹，请阅读[this](https://apple.stackexchange.com/q/5870/17907)或[this](https://apple.stackexchange.com/q/78867/17907)。

*   ~/.netbeans-德比

在更高版本的 Mac OS X 中，该`Library`文件夹对您的主文件夹隐藏。也不显示在`Go`菜单上。要公开，**请在选择 时按住 Option 键`Go`**。出现一个`Library`菜单项，大约在菜单的中间。

*   ~/库/应用程序支持/NetBeans/
*   ~/库/缓存/NetBeans/7.4

## 根文件夹

*   /应用程序/NetBeans
*   /private/var/db/receipts/org.netbeans.*

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-18T17:46:54.423

[此页面](http://www.netbeans.org/community/releases/65/1/install.html#uninstallation)上的说明说，将 Netbeans 应用程序从 Applications 文件夹中拖到垃圾箱中就足够了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-18T23:50:13.273

巴里布朗的回答是正确的；我要补充一下 NetBeans 是如何处理这个问题的。如果您查看 NetBeans 安装目录，然后在 bin 下，您将看到一个名为“netbeans”的 shell 脚本，它在 NetBeans 启动时定位您的 JDK 安装。

Mac 有第三方“卸载程序”实用程序，但将应用程序从“应用程序”拖到垃圾箱通常是完成应用程序删除的方式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-04-05T16:26:38.903

[我认为您可以按照示例帖子](http://www.jroller.com/evans/entry/how_to_uninstall_netbeans_from)中的说明在 Ubuntu 上卸载它。我自己不是 Mac 用户，所以我可能错了，但如果家里有 Linux 用户，值得在这里发布。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-02-13T12:40:56.497

非常有帮助，但如果像我一样因为没有任何设置导入而陷入空白 7.1 项目，那可能是像我一样，您正在从 7.0rc1 或 7.0rc2 升级 mac osx。

要解决此问题或只是重新更新您的设置。打开 Telnet 会话。

`cd /Users/{user}/.`网豆ls

```
 I had this... 
     my-MBP:.netbeans {my}$ ls
     6.9    7.0rc2  7.1
     my-MBP:.netbeans {my}$ 
```

然后我删除了 duff 7.1 设置并手动移入了 7.0 设置

```
rm -R 7.1
cp -rf 7.0rc2 7.1 
```

下次打开 NetBeans 时，需要 2-10 分钟才能完全重新扫描和重新索引所有内容，但在此之后可以完美运行。

高温高压

西蒙。

# c# - c#中的软件事务

> ID：1014100
> 
> 赞同：1
> 
> 时间：2009-06-18T17:36:13.490
> 
> 标签：c#, transactions

我有一些 C# 代码需要像这样工作

```
D d = new D();
foreach(C item in list)
{
    c.value++;
    d.Add(c);   // c.value must be incremented at this point
}
if(!d.Process())
    foreach(C item in list)
        c.value--; 
```

它增加列表中每个项目的值，然后尝试对它们进行一些处理。如果处理失败，则需要中断突变或项目。

问题是：*有没有更好的方法来做到这一点？*我不喜欢这件事的事情是，我可以通过多种方式看到它出错。例如，如果几乎有任何东西抛出它就会不同步。

一个想法（这似乎比问题更糟）是：

```
D d = new D();
var done = new List<C>();
try
{
    foreach(C item in list)
    {
        c.value++;
        done.Add(c);
        d.Add(c);
    }
    if(d.Process()) done.Clear();
}
finaly
{
    foreach(C c in done)
        c.value--;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T17:43:05.147

在不了解您的应用程序的全部细节的情况下，我认为不可能为您提供具体的解决方案。基本上，没有一种方法可以在你需要这样的东西的情况下 100% 奏效。

但是，如果您控制了课程`D`并且知道`D.Process()`将失败的情况，您可能可以做两件事之一，这将使这在概念上更容易管理。

一种方法是`D`在调用`Process`方法之前测试 's 的状态，方法是实现类似`CanProcess`函数，当且仅当`Process`会返回 true 时，但不实际处理任何内容。

另一种方法是创建一个临时`D`对象，该对象实际上并不提交，而是`Process`在其内容上运行该方法。然后，如果`Process`成功，您调用某种`Promote`或`Commit`方法来完成更改。类似于如果您有一个`Dataset`对象，您可以创建它的克隆，在克隆中执行事务处理，然后当且仅当处理成功时将其合并回主数据集。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T17:41:03.200

这是内存密集型的，但您可以在递增之前制作列表的副本。如果该过程成功，您可以返回新列表。如果失败，则返回原始列表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T17:41:36.240

为什么不只在流程成功时才增加？

我认为更好的方法是让D中的process方法增加里面的c.value。

# c++ - 如何显式设置任务栏图标？

> ID：1014101
> 
> 赞同：5
> 
> 时间：2009-06-18T17:36:21.117
> 
> 标签：c++, winapi, taskbar

在 Visual Studio 中，我生成了一个普通的旧 Win32 应用程序并剥离了所有资源和生成的代码，因此我的应用程序包含以下内容：

```
#include "stdafx.h"
#include "IcoTest.h"

int APIENTRY _tWinMain(HINSTANCE hInstance,
                 HINSTANCE hPrevInstance,
                 LPTSTR    lpCmdLine,
                 int       nCmdShow)
{
    ::MessageBox( NULL, L"Testing", L"Test", MB_OK );
} 
```

当我运行应用程序时，我看到的是：

[![截屏](../Images/7ad8aaeccbd934082499e30c08c8704b.png)](https://i.stack.imgur.com/phmpN.png)

所以问题是我可以更改任务栏中的默认应用程序图标吗？如果是这样，需要添加什么代码来做到这一点？

编辑：

这就是我所做的，这种工作方式很有效，但并不理想。新图标显示正常，但 Vista 中的任务栏预览窗口不起作用，系统菜单也不起作用，所以我现在就先不管它。

```
HWND CreateDummyWindow(HINSTANCE hInstance, int iconId, LPCTSTR taskbarTitle)
{
WNDCLASSEX wcex;
wcex.cbSize = sizeof(WNDCLASSEX);
wcex.style          = CS_HREDRAW | CS_VREDRAW;
wcex.lpfnWndProc    = DefWindowProc;
wcex.cbClsExtra     = 0;
wcex.cbWndExtra     = 0;
wcex.hInstance      = hInstance;
wcex.hIcon          = LoadIcon(hInstance, MAKEINTRESOURCE(iconId));
wcex.hCursor        = LoadCursor(NULL, IDC_ARROW);
wcex.hbrBackground  = 0;
wcex.lpszMenuName   = 0;
wcex.lpszClassName  = taskbarTitle,
wcex.hIconSm        = LoadIcon(wcex.hInstance, MAKEINTRESOURCE(iconId));
ATOM atom = RegisterClassEx(&wcex);
HWND wnd = ::CreateWindow( 
    wcex.lpszClassName, taskbarTitle, WS_ICONIC | WS_DISABLED,
  -1000, -1000, 1, 1, NULL, NULL, hInstance, NULL);
return wnd;
}

int APIENTRY _tWinMain(HINSTANCE hInstance,
                 HINSTANCE hPrevInstance,
                 LPTSTR    lpCmdLine,
                 int       nCmdShow)
{
    HWND wnd = CreateDummyWindow(hInstance, IDI_ICON1, _T("Test") );
    ::MessageBox( wnd, _T("Testing"), _T("Test"), MB_OK );
    ::DestroyWindow( wnd );
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-18T17:38:51.800

任务栏上显示的图标取自窗口本身。如果唯一的窗口是标准的 Windows MessageBox，那么您将获得某种操作系统默认值。你必须创建自己的窗口并给它一个图标，然后 Windows 将使用它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-18T17:44:14.723

这看起来只是示例代码。如果实际代码是非控制台 Windows 应用程序，您可以这样做：

[通过调用SetIcon()](http://msdn.microsoft.com/en-us/library/9cb3b7b5(VS.80).aspx)为您的应用程序的主窗口提供一个任务栏图标。然后，当您调用 MessageBox() 时，将第一个参数设置为应用程序主窗口的 HWND。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-17T02:01:09.240

对于这种特殊情况（函数`MessageBox`中的一次调用`WinMain`），您可以挂钩消息框对话框的创建并在那里设置一个图标。像这样：

```
HHOOK g_hMsgBoxHook;
HINSTANCE g_hInstance;

LRESULT CALLBACK CallWndProc(int nCode, WPARAM wParam, LPARAM lParam)
{
    if(nCode == HC_ACTION)
    {
        CWPSTRUCT* pcwp = (CWPSTRUCT*)lParam;

        if(pcwp->message == WM_INITDIALOG)
        {
            HICON hIcon = NULL;
            HICON hIconBig = NULL;

            // Small icon.
            hIcon = (HICON)LoadImage(g_hInstance,
                           MAKEINTRESOURCE(IDI_MYICON),
                           IMAGE_ICON,
                           GetSystemMetrics(SM_CXSMICON),
                           GetSystemMetrics(SM_CYSMICON),
                           0);
            if(hIcon)
            {
                SendMessage(pcwp->hwnd, WM_SETICON,
                    ICON_SMALL, (LPARAM)hIcon);
            }

            // Big icon.
            hIconBig = (HICON)LoadImage(g_hInstance,
                           MAKEINTRESOURCE(IDI_MYICON),
                           IMAGE_ICON,
                           GetSystemMetrics(SM_CXICON),
                           GetSystemMetrics(SM_CXICON),
                           0);
            if(hIconBig)
            {
                SendMessage(pcwp->hwnd, WM_SETICON,
                    ICON_BIG, (LPARAM)hIconBig);
            }
        }
    }

    return CallNextHookEx(g_hMsgBoxHook, nCode, wParam, lParam); 
}

int CALLBACK wWinMain(
  HINSTANCE hInstance,
  HINSTANCE hPrevInstance,
  LPWSTR lpCmdLine,
  int nCmdShow
)
{
    g_hInstance = hInstance;
    g_hMsgBoxHook = SetWindowsHookEx(WH_CALLWNDPROC,
        CallWndProc, NULL, GetCurrentThreadId());

    MessageBoxW(NULL, L"Testing", L"Test", MB_OK);

    // ...

    UnhookWindowsHookEx(g_hMsgBoxHook);
} 
```

`IDI_MYICON`您的图标资源的 ID在哪里。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-18T17:52:32.870

```
WNDCLASSEX wndclass;

wndclass.cbSize        = sizeof(wndclass);
// ..
wndclass.hIconSm       = ExtractIconEx( ... );
RegisterClassEx(&wndclass);

HWDN wnd = CreateWindow(...) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-18T17:57:04.093

为什么不直接将图标资源添加到 EXE 中？我很确定 Windows 在回到“通用”图标之前会尝试这样做。

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2010-02-05T19:44:12.843

Create a form but never show it then assign it an icon and use that as the parent of your message box.

This hides the icon:

```
using (var f = new Form())
{
    MessageBox.Show(f,"my message");
} 
```

This will create an icon:

```
using (var f = new Form())
{
    f.Icon = Resources.IconUpload;
    f.Location=new Point(-1000,-1000);
    f.StartPosition = FormStartPosition.Manual;
    f.Show();
    MessageBox.Show(f,"my message");
} 
```

# dns - DNS 区域名称

> ID：1014108
> 
> 赞同：2
> 
> 时间：2009-06-18T17:37:56.310
> 
> 标签：dns

在 DNS 区域文件中，对于类型“A”，名称“*”和名称“@”有什么区别？

各自做什么？

```
* A myIp

@ A myIp 
```

另外，如果有人知道有关编辑和微调 DNS 区域文件的不错的教程，我将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-22T10:20:14.993

该`@`符号表示当前（完全限定的）区域名称，通常使用`$ORIGIN`.

该符号是通配符标签 - DNS 服务器将使用此处的数据`*`响应对*未知标签的查询*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T17:42:46.910

@ 符号表示域名之前没有任何内容，* 表示域名之前可以有任何内容。

参考：[http ://www.ipprimer.com/dns.cfm](http://www.ipprimer.com/dns.cfm)

# c - 在运行计算密集型任务时将数据保存到磁盘的有效方法

> ID：1014113
> 
> 赞同：5
> 
> 时间：2009-06-18T17:38:44.217
> 
> 标签：c, file-io, performance, parallel-processing, openmp

我正在开发一个非常占用 cpu 的科学软件（它的 proc 绑定），但它需要经常将数据写入磁盘（i/o 绑定）。

我正在为此（OpenMP）添加并行化，我想知道解决写入磁盘需求的最佳方法是什么。模拟没有理由在 HDD 上等待（这就是它现在正在做的事情）。

我正在为此寻找“最佳实践”，而速度是我最关心的（这些可能是非常长的模拟）。

谢谢~亚历克斯

第一个想法：

有一个单独的进程实际写入磁盘，因此模拟有两个进程：一个是 CPU 密集型（模拟），一个是 IO 密集型（写入文件）。这听起来很复杂。

可能是管道/缓冲区？我对这些有点陌生，所以也许这可能是一个可能的解决方案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-18T17:42:40.327

我想说最好的方法是产生一个不同的线程来保存数据，而不是一个全新的进程；使用新流程时，您会遇到必须跨流程边界传递要保存的数据的麻烦，这带来了一系列新的困难。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-18T17:57:35.887

想到的第一个解决方案几乎就是您所说的 - 在自己的进程中使用从 sim 到写入器的单向管道进行磁盘写入。作者确实尽可能快地写入（从管道中提取新数据）。这样做的问题是，如果 sim 比编写器领先太多，那么 sim 无论如何都会阻塞管道写入，并且它会在一次删除时绑定 I/O。

问题是，实际上你的模拟周期在它吐出结果之前是不完整的。

我想到的第二件事是使用非阻塞 I/O。每当 sim 需要写入时，它都应该通过非阻塞 I/O 来完成。在下一次需要写入时，它可以在开始新的 I/O 操作之前获取上一个 I/O 操作的结果（可能会导致一小段等待）。这使模拟尽可能与 I/O 并行运行，而不会让模拟远远领先于写入。

如果模拟处理周期不同（有时小于写入时间，有时更长），第一个解决方案会更好，因为平均而言，写入可能跟上 sim。

如果处理周期总是（或几乎总是）比写入时间短，那么你最好不要打扰管道而只使用非阻塞 I/O，因为如果你使用管道，它最终会填满无论如何，SIM卡都会挂断I/O。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-20T14:10:09.413

如果您在程序中实现 OpenMP，那么最好使用并行部分的**#pragma omp single**或**#pragma omp master**保存到文件。这些 pragma 只允许一个线程执行某事。因此，您的代码可能如下所示：

```
#pragma omp parallel
{
    // Calculating the first part
    Calculate();

    // Using barrier to wait all threads
    #pragma omp barrier

    #pragma omp master
    SaveFirstPartOfResults();

    // Calculate the second part
    Calculate2();

    #pragma omp barrier

    #pragma omp master
    SaveSecondPart();

    Calculate3();

    // ... and so on
} 
```

这里的线程组将进行计算，但只有单个线程会将结果保存到磁盘。

它看起来像软件管道。我建议您考虑英特尔线程构建模块库中的 tbb::pipeline 模式。我可以向您[推荐 http://cache-www.intel.com/cd/00/00/30/11/301132_301132.pdf#page=25](http://cache-www.intel.com/cd/00/00/30/11/301132_301132.pdf#page=25)上的软件管道教程。请阅读第 4.2 段。他们解决了这个问题：一个线程从驱动器读取，第二个线程处理读取的字符串，第三个线程保存到驱动器。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-18T17:56:53.313

由于您受 CPU 和 IO 限制：让我猜猜：还有大量可用内存，对吧？

如果是这样，您应该将必须写入内存中的磁盘的数据缓冲到一定程度。写入大量数据通常比写入小块数据要快得多。

对于写作本身：考虑使用内存映射 IO。自从我进行基准测试以来已经有一段时间了，但上次我这样做的速度明显更快。

您也可以随时交易 CPU 与 IO。我认为您目前正在将数据写入某种原始的未压缩数据，对吗？如果您使用简单的压缩方案来减少要写入的数据量，您可能会获得一些 IO 性能。ZLIB 库非常易于使用，并且在最低压缩级别上压缩得非常快。这取决于数据的性质，但如果其中有很多冗余，即使是非常粗略的压缩算法也可以消除 IO 绑定问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-18T17:49:12.750

一个线程连续执行计算密集型过程的一个步骤，然后将部分结果添加到部分结果队列中。另一个线程不断地从队列中删除部分结果并将它们写入磁盘。确保同步对队列的访问。队列是一种类似列表的数据结构，您可以在其中将项目添加到末尾并从前面删除项目。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-18T18:01:42.323

让你的应用程序有两个**线程**，一个用于 CPU，一个用于硬盘。

让 CPU 线程将完成的数据推送到一个队列中，然后硬盘线程在数据进入时从中提取。

这样，CPU 只是摆脱数据并让其他人处理它，而硬盘驱动器只是耐心地等待其队列中的任何数据。

在实现方面，您可以将队列作为共享内存类型的对象，但我认为管道正是您要寻找的。CPU 只是在需要时写入管道。在硬盘方面，您只需读取管道，只要您获得有效数据，就从那里继续。

# java - 树脂服务器错误

> ID：1014117
> 
> 赞同：1
> 
> 时间：2009-06-18T17:38:59.380
> 
> 标签：java, resin

嗨，我在 windows xp 中尝试访问[http://localhost:8080](http://localhost:8080)时收到此错误。我事先没有看到树脂有任何错误。还设置了 Windows 中的 JAVA_HOME。

500 小服务程序异常

Resin 无法加载 com.sun.tools.javac.Main。通常这意味着类路径中缺少 JDK tools.jar，可能是因为使用 JRE 而不是 JDK。您可以将 tools.jar 添加到类路径或将编译器更改为带有或 jikes 的外部编译器。

java.lang.ClassNotFoundException: com.sun.tools.javac.Main in NonScanDynamicClassLoader[JarLoader[[]]]

谢谢

聚丙烯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T17:32:49.590

Resin 无法加载 com.sun.tools.javac.Main。通常这意味着类路径中缺少 JDK tools.jar，可能是因为使用 JRE 而不是 JDK。您可以将 tools.jar 添加到类路径或将编译器更改为带有或 jikes 的外部编译器。

java.lang.ClassNotFoundException: com.sun.tools.javac.Main in NonScanDynamicClassLoader[JarLoader[[]]]

* * *

我遇到了同样的问题，但我最终通过以下步骤成功修复了它:::::

1- 在 conf/resin.conf 里面

2-您的系统路径应完全包含根据jdk目录的javac编译器路径。

3-运行 java -jar resin-3。*.* /lib/resin.jar 再次

4-http://localhost:8080/

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-06-18T15:45:39.453

我已将 tools.jar 复制到树脂的 lib 文件夹中，一切都已解决

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-12-16T13:11:26.417

Resin 可以配置为使用 JSP 的外部编译器，而不是使用 tools.jar 的内部编译器。调用外部编译器速度较慢，但​​在某些情况下可能更容易配置。

要更改此设置，您必须编辑`conf/resin.conf`以下设置并将其从 更改`internal`为`javac`。

```
<!--
   - You can change the compiler to "javac" or jikes.
   - The default is "internal" only because it's the most
   - likely to be available.
  -->
<javac compiler="javac" args=""/> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-18T17:46:36.203

> 通常这意味着类路径中缺少 JDK tools.jar，可能是因为使用 JRE 而不是 JDK。

好的，您`JAVA_HOME`指的是 JRE 还是 JDK？

# c# - 如何更改 Windows 用户的区域设置/日期格式？

> ID：1014120
> 
> 赞同：5
> 
> 时间：2009-06-18T17:39:35.963
> 
> 标签：c#, windows, datetime, registry, regional

我使用 VB6/COM+ 应用程序，它根据控制面板、区域设置中的短日期设置为运行它的用户输出日期/时间值。然后解析该输出的程序对其期望的日期格式具有可配置的设置，并显示在 UI 中。

例如，如果用户的区域设置设置为 mm/dd/yyyy，并且它输出 06/18/2009，则预期“18/06/2009”的应用程序将失败，并显示“字符串未被识别为有效的日期时间”。

由于我们通常将此应用程序作为服务帐户运行，我们没有以交互方式登录来创建配置文件，因此我们通常设置正确的日期格式，然后勾选“将所有设置应用于当前用户帐户和默认用户配置文件”选项。

我想制作我为这个混乱编写的 C# 配置实用程序，以便能够以编程方式为给定用户设置日期格式。

**编辑** 我只想更改代码，但目前没有能力这样做。

我也知道我问的是一件坏事。关于“它应该是用户的选择”——我**就是**那个用户，因为我为任务明确地创建了它；我只想通过脚本方法设置日期格式，而不必自己单击。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-06-18T18:03:13.337

微软特别不鼓励这样做。您可能想出的任何解决方案都将是一个肮脏的黑客，可能很快就会停止工作。

这样想：你是谁来决定这些设置？你不认为这是用户的决定吗？

回到主题：找到一种明确的格式供应用程序进行通信，例如`YYYYMMDD`. 然后，显示的应用程序可以简单地尊重实际的用户设置，因为它应该这样做。

但是，由于您无法更改它，只需戳入注册表：

当前用户：

```
HKEY_CURRENT_USER\Control Panel\International 
```

具体用户：

```
HKEY_USERS\(user SID)\Control Panel\International 
```

默认用户：

```
HKEY_USERS\.DEFAULT\Control Panel\International 
```

`sShortDate`可能是您要更改的值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-18T17:56:59.087

如果您要修改配置文件以满足您的需求，为什么不忽略配置文件设置并在您的应用程序中硬编码您想要的格式？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-12-13T18:50:15.767

代码：

```
Imports System.Threading
Thread.CurrentThread.CurrentCulture = New CultureInfo("en-US", False)
Microsoft.Win32.Registry.SetValue("HKEY_CURRENT_USER\Control Panel\International", "sShortDate", "M/d/yyyy") 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-04-17T21:47:00.350

虽然要谨慎地持续改变用户的文化（区域设置），但也有合法的用例。

在 Windows 8 和 Windows Server 2012 及更高版本上，Windows PowerShell 附带
[`Set-Culture`cmdlet](https://technet.microsoft.com/en-us/library/hh852137.aspx)`intl.cpl` ，它与通过控制面板 ( )选择不同区域的程序等效。

例如，`Set-Culture fr-CA`相当于`French (Canada)`为当前用户交互式地选择区域。

^(警告：（原文如此）等*混合*文化`en-DE`从 Windows PowerShell v5.1 开始似乎不起作用 - 请参阅我的[这个答案](https://stackoverflow.com/a/49866252/45375)。)

虽然它不会很快，但可以从 C# 调用 PowerShell 命令。

# c# - 仅当线程处于某个方法时才锁定多个方法

> ID：1014130
> 
> 赞同：2
> 
> 时间：2009-06-18T17:40:47.523
> 
> 标签：c#, .net, multithreading, locking

我有一个类（简化示例），例如：

```
public class SomeCollection : ICloneable
{
    public void Add(Item item) { /* ... */ }
    public void Remove(Item item) { /* ... */ }
    public Item Get(Key key) { /* ... */ }
    /*
    ...
    */
    public object Clone() { /* ... */ }
} 
```

我需要当一个线程进入 Clone() 时，没有其他线程可以进入 Add 或 Remove 但可以进入 Get。一开始我想到的是：

```
 public void Add(Item item) { lock(addLock) { /* ... */ } }
    public void Remove(Item item) { lock(removeLock) { /* ... */ } }

    public object Clone(Item item)
    { 
        lock(addLock)
        {
            lock(removeLock)
            {
                /* ... */
            }
        }
    } 
```

这可行（我认为）但有一些缺点：*我不希望两个线程进入 Add 以相互阻塞 - 我正在处理更深层次的代码 *我将不得不承受每次调用 Add 或 Remove 的锁定开销

然后我想到了这个

```
 private volatile bool cloning = false; // notice the volatile keyword

    public void Add(Item item)
    {
         int i = 0;
         while(cloning)
         { 
             if (i++ > 20)
                 throw new TimeoutException();
             Thread.Sleep(50); // waits 50 milliseconds
         }
         /* ... */
    } // and the same for Remove

    public object Clone()
    {
        cloning = true;
        try
        {
            /* do the cloning */
        } finally { cloning = false; }
    } 
```

但是这种方法：

*   比较复杂
*   克隆可以在线程尚未完成执行 Add 或 Remove 时进入
*   看起来不自然

我给[ReadWriterLockSlim](http://msdn.microsoft.com/en-us/library/system.threading.readerwriterlockslim.aspx)看了一眼，但似乎不适合我的场景。

我需要这个，因为 Clone 方法需要很长时间（可能需要一秒钟 - 集合是巨大的），并且此时的更改会炸毁枚举器（在 foreach 循环中使用）。是的，我必须使用 foreach，因为底层密钥集合除了 IEnumerable 之外不公开任何其他内容。

你推荐什么**？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T17:47:53.953

你能解释一下为什么 ReaderWriterLockSlim 不适合你的场景吗？

当然，您不会将它用于它的经典用途，但将 Clone 方法视为您的作者，将添加/删除方法视为您的读者，我认为它适合。

[编辑] 另一件事：如果您走这条路，请确保您记录了为什么要“向后”使用 ReaderWriterLockSlim，以便下一个阅读代码的人（或六个月后的您）了解发生了什么。

# sharepoint - 带有写回的查找列

> ID：1014133
> 
> 赞同：1
> 
> 时间：2009-06-18T17:41:08.880
> 
> 标签：sharepoint, moss, lookup

有没有人做过一个共享点查找列，允许填写客栈选择并写回它查找的列表？制作这样一个专栏需要什么？

如果有 3.rd 方解决方案，那将非常棒:)

干杯!

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-18T17:47:14.890

您需要创建一个自定义字段类型：

[http://msdn.microsoft.com/en-us/library/ms446361.aspx](http://msdn.microsoft.com/en-us/library/ms446361.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T10:45:00.267

在我从事的一个项目中，我们使用了一个 TagControl FieldType，带有一个输入字段和一个多选字段。用户可以输入新标签或选择现有标签。如果你有兴趣，我可以把代码发给你。

# .net - 你能创建你自己的默认 T 其中 T 是你自己的类吗

> ID：1014135
> 
> 赞同：2
> 
> 时间：2009-06-18T17:41:15.713
> 
> 标签：.net, default, keyword

可以说我有以下

```
public class A 
{
   private string _someField;
   public string SomeField { get { return _someField; } }
} 
```

出于某种原因，我正在检查这个类的默认值，我想为一个类设置默认值，就像 int 类型的默认值是 0，我希望在上面的类中，我的 Somefield 的默认值是“hello” ;

```
int i = default(int); // i is 0
A myClass = default(A);
string s = myClass.SomeField; // s is hello 
```

这更多只是为了我自己的理论满足，而不是实际应用。就是想。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-18T17:43:07.753

不。类（引用类型）的默认值是`null`并且不能重载。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-18T17:44:26.877

您无法更改 T 的 default(T) 值。对于引用类型，它始终为 null，而对于值类型，它始终为空值（即，对于结构，所有成员都是默认的未初始化值）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-18T17:49:12.640

没有办法重载 default(T)。

对我来说，听起来您确实在要求 .NET 中尚不存在的不可为空的引用类型。看看这里的实现： http: [//msmvps.com/blogs/jon_skeet/archive/2008/10/06/non-nullable-reference-types.aspx](http://msmvps.com/blogs/jon_skeet/archive/2008/10/06/non-nullable-reference-types.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-18T17:46:31.867

在类（引用类型）的情况下，默认关键字对类的成员没有任何作用，它只是将整个引用设置为 null

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-18T19:39:16.693

虽然 default() 将始终返回 null，但您可以使用 where 指定该类必须包含无参数构造函数，因此您可以对其调用 new。

```
void SomeMethod<T>(T something) where T : new()
    {
        T newObject = new T();
    } 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-06-18T17:43:29.483

这应该做的工作：

```
public class A 
{
   private string _someField = "hello";
   public string SomeField { get { return _someField; } }
} 
```

现在，当您创建该类的实例时， someField 的初始值将是 hello。

[编辑：这并不完全符合您的要求。就像其他人在评论中指出的那样， default(T) 其中 T 是一个类将始终导致 null 。

相反，您将正常创建类，而不是使用“默认”关键字。

```
A myClass = new A();
string defaultValue = myClass.SomeField // This will be set to "hello" by default. 
```

]

# search - 搜索引擎是否有任何构建块可以抓取其他网站？

> ID：1014138
> 
> 赞同：1
> 
> 时间：2009-06-18T17:42:22.230
> 
> 标签：search, search-engine, web-crawler

我想为一件特定的事情建立一个搜索服务。这些数据可以通过免费的分类服务和许多其他网站免费获得。

是否有任何构建块，例如我可以定制的开源爬虫 - 而不是从头开始构建，我可以使用？

关于构建这样的产品有什么建议吗？不仅仅是技术上的，还有我可能需要考虑的任何隐私/法律问题。

例如，如果我从很多地方得到它们，我是否需要在结果的来源处“给予信任”并放置原始链接？

编辑：顺便说一句，我在前端使用带有 JS 的 GWT，还没有决定后端的语言。PHP或Python。想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T18:32:34.397

您可以使用 python 中的几个块。

1.  beautifulsoup [ [http://www.crummy.com/software/BeautifulSoup/]](http://www.crummy.com/software/BeautifulSoup/])用于解析 HTML。它也可以处理糟糕的代码，而且它的 API 非常简单……对我来说比任何类似 DOM 的工具都要好。我的朋友用它成功地抓取了他的旧 phpbb 论坛。它有很好的文档。
2.  mechanize [ [http://wwwsearch.sourceforge.net/mechanize/]](http://wwwsearch.sourceforge.net/mechanize/])是一个模拟 web 浏览器的 http 客户端库。它处理cookies、填写表格等。也易于使用，但如果您了解 http 的工作原理，它会有所帮助。
3.  [http://dev.scrapy.org/](http://dev.scrapy.org/) - 这是一个相对较新的东西：一个基于扭曲的完整抓取框架。我玩的不多。

我使用前两个来满足我的需要；fe它需要20行代码来获得一个用于3阶段投票的自动测试工具，模拟等待用户输入数据等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T18:16:01.740

我用 Ruby 制作了一个屏幕刮板，花了大约五分钟。显然[这个家伙](http://www.igvita.com/2007/02/04/ruby-screen-scraper-in-60-seconds/)把它降到了60秒！我不确定 Ruby 是否与您所寻找的一样可扩展或快速，但我从未见过更快的方法来进行概念验证或原型。

秘密是一个名为“ [hpricot](http://wiki.github.com/why/hpricot) ”的库，正是为此目的而构建的。

我对 PHP 或 Python 或可用于这些开发系统/语言的内容一无所知。

祝你好运！

# regex - 辣椒+番茄+西瓜的正则表达式

> ID：1014139
> 
> 赞同：0
> 
> 时间：2009-06-18T17:42:38.360
> 
> 标签：regex

something+something+something ... +something 的正则表达式？

对不起，因为我的英语和大脑很棒 -> 键盘连接

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-18T17:44:21.883

```
([a-zA-Z]+(\+[a-zA-Z]+)*) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-18T17:44:20.183

如果“某事”始终是一个词并且需要至少两个条目

```
\w(\+\w)+ 
```

或任何重复序列

```
\w(\+\w)* 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-18T17:51:01.000

根据澄清问题的评论，这是一个更新的答案：

```
([a-z]+\+)*[a-z]+ 
```

或者

```
[a-z]+(\+[a-z]+)* 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-18T17:45:15.220

您只需要转义“+”和“。” 因为它们是保留的。

例如，在红宝石中：

```
/something\+something\+something \.\.\. \+something/ 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-18T17:46:40.587

如果这是您要的，您可以在正则表达式中`+`使用元字符转义。`\+`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-18T17:54:48.653

作为替代方案，字符串拆分方法会起作用吗？

```
"Or+Something+like+that".split('+') 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-18T17:59:59.487

```
/\w+(\s*\w+)*(\+\w+(\s*\w+)*)*/ 
```

如果需要，这也应该匹配多个单词的短语。它也匹配非字母字符，但如果您明确想要排除除字母之外的所有内容，则可以将 \w 替换为 [az]。如果您希望使用大写字母，请确保将正则表达式指定为不区分大小写。

编辑：下面的评论者注意到我在 \w 之后没有加号，所以它一次只匹配一个字符。\w+ 将匹配整个单词，中间有一个可选的空格，这是最初的意图。谢谢你的收获。

# c++ - 使用Delphi创建Win7跳转列表

> ID：1014145
> 
> 赞同：7
> 
> 时间：2009-06-18T17:43:24.617
> 
> 标签：c++, delphi, windows-7, code-conversion, jump-list

我正在尝试使用 Delphi 在 Windows 7 上为我的应用程序创建跳转列表。

我找到了这个 c++ 代码，但我不知道如何将它翻译成 Delphi，有什么帮助吗？

```
 void CreateJumpList()    
    {        
        ICustomDestinationList *pcdl;    
        HRESULT hr = CoCreateInstance    
                       (CLSID_DestinationList,     
                        NULL, CLSCTX_INPROC_SERVER,    
       IID_PPV_ARGS(&pcdl));          

         if (SUCCEEDED(hr))     
       {    
           hr = pcdl->SetAppID(c_szAppID);    
            if (SUCCEEDED(hr))    
            {    
                UINT uMaxSlots;    
                IObjectArray *poaRemoved;
                    hr = pcdl->BeginList    
                    (&uMaxSlots, IID_PPV_ARGS(&poaRemoved));    
                if (SUCCEEDED(hr))    
                {

                    hr = _AddCategoryToList(pcdl, poaRemoved);    
                    if (SUCCEEDED(hr))    
                    {    
                        pcdl->CommitList();    
                    }    
                    poaRemoved->Release();    
                }    
            }    
        }    
    }

// This is the helper function that actually 

//appends the items to a collection object HRESULT 

_AddCategoryToList(ICustomDestinationList *pcdl,    
                       IObjectArray *poaRemoved)    
{
    IObjectCollection *poc;    
    HRESULT hr = CoCreateInstance    
(CLSID_EnumerableObjectCollection,     
NULL,     
CLSCTX_INPROC_SERVER,     
IID_PPV_ARGS(&poc));    
    if (SUCCEEDED(hr))    
    {    
        for (UINT i = 0; i < ARRAYSIZE(c_rgpszFiles); i++)    
        {    
            IShellItem *psi;    
            if (SUCCEEDED(SHCreateItemInKnownFolder(    
FOLDERID_Documents,     
KF_FLAG_DEFAULT,     
c_rgpszFiles[i],     
IID_PPV_ARGS(&psi))))    
            {    
                if(!_IsItemInArray(psi, poaRemoved))    
                {    
                    poc->AddObject(psi);    
                }    
                psi->Release();
            }    
        }

        IObjectArray *poa;    
        hr = poc->QueryInterface(IID_PPV_ARGS(&poa));    
        if (SUCCEEDED(hr))    
        {    
            pcdl->AppendCategory(L"Custom category", poa);    
            poa->Release();    
        }    
        poc->Release();    
    }    
    return hr;    
} 
```

# c# - C# 集合初始化语法是否避免默认初始化开销

> ID：1014158
> 
> 赞同：7
> 
> 时间：2009-06-18T17:44:41.493
> 
> 标签：c#, optimization, compiler-construction, c#-3.0

当您使用新的 C# 集合初始化语法时：

```
string[] sarray = new[] { "A", "B", "C", "D" }; 
```

编译器是否避免将每个数组槽初始化为默认值，还是等效于：

```
string[] sarray = new string[4];  // all slots initialized to null
sarray[0] = "A";
sarray[1] = "B";
sarray[2] = "C";
sarray[3] = "D"; 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-18T17:49:28.630

编译器仍然使用`newarr`IL 指令，因此 CLR 仍然会初始化数组。

集合初始化*只是*编译器的魔法——CLR 对此一无所知，因此它仍会假定它必须进行健全性清除。

但是，这应该非常非常快 - 它只是擦除内存。我怀疑在许多情况下这是一个很大的开销。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-06-18T17:50:36.960

快速测试：

```
 string[] arr1 =
        {
            "A","B","C","D"
        };
        arr1.GetHashCode();

        string[] arr2 = new string[4];
        arr2[0] = "A";
        arr2[1] = "B";
        arr2[2] = "C";
        arr2[3] = "D";

        arr2.GetHashCode(); 
```

导致这个 IL（注意，它们都是相同的）

```
 IL_0002:  newarr     [mscorlib]System.String
  IL_0007:  stloc.2
  IL_0008:  ldloc.2
  IL_0009:  ldc.i4.0
  IL_000a:  ldstr      "A"
  IL_000f:  stelem.ref
  IL_0010:  ldloc.2
  IL_0011:  ldc.i4.1
  IL_0012:  ldstr      "B"
  IL_0017:  stelem.ref
  IL_0018:  ldloc.2
  IL_0019:  ldc.i4.2
  IL_001a:  ldstr      "C"
  IL_001f:  stelem.ref
  IL_0020:  ldloc.2
  IL_0021:  ldc.i4.3
  IL_0022:  ldstr      "D"
  IL_0027:  stelem.ref
  IL_0028:  ldloc.2
  IL_0029:  stloc.0
  IL_002a:  ldloc.0
  IL_002b:  callvirt   instance int32 [mscorlib]System.Object::GetHashCode()
  IL_0030:  pop
  IL_0031:  ldc.i4.4
  IL_0032:  newarr     [mscorlib]System.String
  IL_0037:  stloc.1
  IL_0038:  ldloc.1
  IL_0039:  ldc.i4.0
  IL_003a:  ldstr      "A"
  IL_003f:  stelem.ref
  IL_0040:  ldloc.1
  IL_0041:  ldc.i4.1
  IL_0042:  ldstr      "B"
  IL_0047:  stelem.ref
  IL_0048:  ldloc.1
  IL_0049:  ldc.i4.2
  IL_004a:  ldstr      "C"
  IL_004f:  stelem.ref
  IL_0050:  ldloc.1
  IL_0051:  ldc.i4.3
  IL_0052:  ldstr      "D"
  IL_0057:  stelem.ref
  IL_0058:  ldloc.1
  IL_0059:  callvirt   instance int32 [mscorlib]System.Object::GetHashCode() 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-18T17:55:37.013

我对使用您描述的语法实例化数组进行了简短测试，发现使用非默认值进行实例化比使用默认值进行实例化花费了大约 2.2 倍的时间。

当我使用默认值切换和实例化时，它需要大约相同的时间。

实际上，当我查看反编译时，似乎发生的是数组被初始化，然后填充了任何非默认值。

使用非默认值进行实例化：

```
 bool[] abPrimes = new[] { 
                true, true
            };
0000007e  mov         edx,2 
00000083  mov         ecx,79114A46h 
00000088  call        FD3006F0 
0000008d  mov         dword ptr [ebp-64h],eax 
00000090  mov         eax,dword ptr [ebp-64h] 
00000093  mov         dword ptr [ebp-54h],eax 
00000096  mov         eax,dword ptr [ebp-54h] 
00000099  cmp         dword ptr [eax+4],0 
0000009d  ja          000000A4 
0000009f  call        76A9A8DC 
000000a4  mov         byte ptr [eax+8],1 
000000a8  mov         eax,dword ptr [ebp-54h] 
000000ab  cmp         dword ptr [eax+4],1 
000000af  ja          000000B6 
000000b1  call        76A9A8DC 
000000b6  mov         byte ptr [eax+9],1 
000000ba  mov         eax,dword ptr [ebp-54h] 
000000bd  mov         dword ptr [ebp-40h],eax 
```

使用默认值进行实例化：

```
bool[] abPrimes2 = new[] { 
              false, false
            };
000000c0  mov         edx,2 
000000c5  mov         ecx,79114A46h 
000000ca  call        FD3006F0 
000000cf  mov         dword ptr [ebp-68h],eax 
000000d2  mov         eax,dword ptr [ebp-68h] 
000000d5  mov         dword ptr [ebp-54h],eax 
000000d8  mov         eax,dword ptr [ebp-54h] 
000000db  mov         dword ptr [ebp-5Ch],eax 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-15T16:53:08.853

至少在 IL 级别，无法避免将每个数组槽初始化为默认值。

字符串是一个类，而不是一个结构。

这意味着 A、B、C、D 和 sarray 可以存储在任何位置。A、B、C 和 D 可能从实习生池中获得，对对象的引用可能是动态的。

但我相信 JIT 可以足够聪明地减少一半的开销。

PS。过早的优化是万恶之源。

# java - UISpec4J：从组合框选择中返回触发器？

> ID：1014164
> 
> 赞同：0
> 
> 时间：2009-06-18T17:45:37.263
> 
> 标签：java, user-interface, testing, uispec4j

这个问题是针对[UISpec4J](http://www.uispec4j.org)测试框架的，用于测试 Java GUI...

我正在尝试测试从 ComboBox 中进行选择而导致的错误消息弹出窗口（模式），但我不确定如何从选择操作中返回 Trigger 对象。

这是一个片段：

```
WindowInterceptor
    .init(window.getComboBox("ComboBoxName").select("Choice that will cause error message"))    // Problem here
    .process(new WindowHandler() {
        public Trigger process(Window errorMessage) {
            // Do stuff...
        }
    })
    .run(); 
```

在该`.init()`行中，我应该返回一个 Trigger 对象（如`button.triggerClick()`），但我不知道如何从 ComboBox 选择中做到这一点。

有人可以告诉我如何从 ComboBox 选择中返回触发器吗？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-18T17:51:58.877

你不能做这样的事情：

```
 WindowInterceptor
    .init(new Trigger() {
        public void run() throws Exception {
            window.getComboBox("ComboBoxName").select("Choice that will cause erromessage");
        })
    .run(); 
```

它看起来很乱，但它是一个提取选项以使其阅读更好。请注意，这是未经测试的，这正是我所期望的。

# javascript - 这两种加载 javascript 文件的优缺点？

> ID：1014166
> 
> 赞同：2
> 
> 时间：2009-06-18T17:45:49.573
> 
> 标签：javascript, dom

A：

```
<script type="text/javascript" src="b1.js"></script>
<script type="text/javascript" src="b2.js"></script>
<script type="text/javascript" src="b3.js"></script>
<script type="text/javascript" src="b4.js"></script> 
```

B：将b1~b4中的所有东西放到另一个文件t.js中

```
<script type="text/javascript" src="t.js"></script> 
```

假设 b1~b4 每个都有 200 KB 的大小

那些 b?.js 文件已经被压缩了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T17:47:53.563

将它们连接起来，然后将它们放入压缩器（最好是 YUI 压缩器），然后确保在服务器上启用 gzipping。

我的经验是，它会导致文件大小减少 40% 到 50%。

更少的 HTTP 请求总是好的，如果它们都在一起，你会得到更好的 gzip 结果。从长远来看，它将带来更好的客户端性能。

此外，弄清楚为什么你的 JavaScript 这么大！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-18T18:15:40.820

检查多个 JS 文件请求与单个请求的费用的一个好方法是通过运行您的页面[http://tools.pingdom.com/fpt/?url=www.yourdomain.com/](http://tools.pingdom.com/fpt/?url=www.yourdomain.com/)两种方式。它向您显示连接时间以及响应和数据传输时间的成本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-18T17:48:00.677

HTTP 请求开销和连接。组合起来通常是值得的——我们在构建脚本中这样做，这样我们就可以单独开发它们。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-18T18:01:04.087

部署单独的 JavaScript 文件并让用户的浏览器将它们拼接在一起就像部署单独的目标文件并让用户的加载器将它们链接到可执行文件中。

如果用户的浏览器很可能已经缓存了一个但不是全部的 JavaScript 组件脚本，那么单独呈现它们是有意义的。如果您使用流行的由 Google 或 Yahoo 提供的 JavaScript 库组件，您的用户可能在访问其他站点时加载了这些组件，那么单独呈现这些组件将节省用户的时间和带宽。

如果脚本对您的网站都是唯一的，并且您将它们全部部署在多个页面上，那么最好将它们组合和缩小作为构建过程的一部分，就像桌面应用程序将对象和库文件组合为其构建过程的一部分一样。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-18T18:01:37.097

如果您使用的是 Java 平台，请尝试 JAWR ( [https://jawr.dev.java.net/](https://jawr.dev.java.net/) )。它以简单明了的方式解决了平凡的前端调整问题。

# c# - HDI：将文件从 SharePoint 列表复制到本地磁盘

> ID：1014167
> 
> 赞同：1
> 
> 时间：2009-06-18T17:45:53.113
> 
> 标签：c#, sharepoint

我有一个简单的托盘应用程序，用于按时间间隔将文件从一个位置复制到多个位置（日常工作）

System.IO.File.Copy 方法不会从 SharePoint 文件夹复制。有办法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T17:48:50.973

为此，您必须正确访问该文件夹并打开 Web 客户端。如果您的共享点农场是[http://mysp](http://mysp)并且您要访问的文档库位于 [http://mysp/sub/sub1/mydocs](http://mysp/sub/sub1/mydocs)那么您必须将文件的路径设置为 \\mysp\sub\sub1\我的文档。此外，必须打开 Web 客户端服务，以便您的操作系统可以通过 webdav 访问该文件夹。

# visual-studio-2008 - Visual Studio 中用于 mbunit 测试的单元测试摘要不正确

> ID：1014180
> 
> 赞同：1
> 
> 时间：2009-06-18T17:47:51.287
> 
> 标签：visual-studio-2008, mbunit

当我在 Visual Studio 测试运行程序（VS 2008）中运行我的 mbunit 测试时，我的测试通过了，但测试摘要不包括通过的测试。对于测试，我创建了一个带有单个测试的测试项目，这是我运行它时 VS 返回的测试摘要：

运行结果：0/1 测试通过，0 失败，1 跳过

但是测试在底部的测试结果窗口中显示为通过。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T06:56:45.763

[您可能应该在Gallio 问题跟踪工具](http://code.google.com/p/mb-unit/issues/list)中创建用户缺陷报告，或者直接向[开发组](http://groups.google.com/group/gallio-dev?hl=en)提问。

# c++ - 不使用跳转语句的结构化解决方案

> ID：1014196
> 
> 赞同：1
> 
> 时间：2009-06-18T17:50:05.883
> 
> 标签：c++

来自 Schaums C++ 文本

删除 goto- 说使用标志

代码段：

```
const int N2 = 5;
int i, j, k;

  for (i = 0; i < N2; i++)
  { for (j = 0; j < N2; j++)
    { for (k = 0; k < N2; k++)
       if (i + j + k > N2)
           goto esc;
       else
          cout <<  i + j + k << " ";
       cout << "* ";
    }
   esc: cout << "." << endl;
  } 
```

解决方案：

```
const int 5;
int i, j, k;
bool done = false;
  for (i = 0; i < N2; i++)
  { for (j = 0; j < N2 && !done; j++)
    { for (k = 0; k < N2 && !done; k++)
       if (i + j + k > N2)
           done true;
       else
          cout <<  i + j + k << " ";
       cout << "* ";
    }
   cout << "." << endl;
   done = false;
  } 
```

结构化解决方案的输出不会产生相同的结果......作为转到一个......我看不到问题

2.  另外，消除 goto 的另一种方法是什么？-我可以不使用标志而只是补充条件。

谢谢 ...

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-18T17:55:43.893

编写这种循环转义功能的一个好方法是返回。陈述。拿：

```
const int N2 = 5;

void inner_loop(const int i) {
   for (int j = 0; j < N2; ++j)
   {
      for (int k = 0; k < N2; ++k)
      {
        if (i + j + k > N2)
           return;

        cout <<  i + j + k << " ";
      }
      cout << "* ";
   }
}

for (int i = 0; i < N2; ++i)
{
  inner_loop(i);
  cout << "." << endl;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-18T17:51:55.803

```
const int 5;
int i, j, k;
bool done = false;
  for (i = 0; i < N2; i++)
  { for (j = 0; j < N2 && !done; j++)
    { for (k = 0; k < N2 && !done; k++)
       if (i + j + k > N2)
           done = true;
       else
          cout <<  i + j + k << " ";
       if (!done) // <-- Add this line
          cout << "* ";
    }
   cout << "." << endl;
   done = false;
  } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-18T19:17:27.957

首先，您的格式非常难以阅读。这很有帮助：

```
const int N2 = 5;
int i, j, k;

for (i = 0; i < N2; i++)
{ 
  for (j = 0; j < N2; j++)
  { 
    for (k = 0; k < N2; k++)
    {
      if (i + j + k > N2)
         goto esc;
     else
        cout <<  i + j + k << " ";
    }
    cout << "* ";
  }
 esc: cout << "." << endl;
} 
```

现在我不知道这个 Schaum 家伙是谁，但他错了。goto 是在这种情况下使用的完全合法的声明。不过，这是您永远需要一个的唯一原因。消除 goto 不会给您带来任何好处。现在你有一个额外的变量，每个循环都需要一个额外的分支和测试。

我建议你避免他在这个问题上的建议。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-18T17:55:23.660

您需要添加条件：

```
if (!done) cout << "* "; 
```

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2009-06-18T17:53:05.070

抛出异常。

# jquery - 使用 Google 托管 jQuery 的最佳方式，但退回到我在 Google 上的托管库失败

> ID：1014203
> 
> 赞同：1037
> 
> 时间：2009-06-18T17:51:33.107
> 
> 标签：jquery, cdn, google-ajax-libraries

什么是尝试[在 Google（或其他 Google 托管库）加载托管 jQuery](http://code.google.com/apis/ajaxlibs/)的好方法，但如果 Google 尝试失败则加载我的 jQuery 副本？

我并不是说谷歌是不稳定的。在某些情况下，谷歌副本被阻止（例如，显然在伊朗）。

我会设置一个计时器并检查 jQuery 对象吗？

两个副本都通过会有什么危险？

并不是真的在寻找“只使用谷歌”或“只使用你自己的”之类的答案。我理解这些论点。我也知道用户很可能缓存了 Google 版本。我正在考虑一般云的后备方案。

* * *

编辑：这部分添加...

由于 Google 建议使用 google.load 加载 ajax 库，并且在完成后执行回调，我想知道这是否是序列化此问题的关键。

我知道这听起来有点疯狂。我只是想弄清楚它是否可以以可靠的方式完成。

* * *

更新：jQuery 现在托管在 Microsoft 的 CDN 上。

[http://www.asp.net/ajax/cdn/](http://www.asp.net/ajax/cdn/)

* * *

## 回答 #1

> 赞同：820
> 
> 时间：2009-06-18T18:00:16.540

你可以像这样实现它：

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.2.6/jquery.min.js"></script>

<script>
       window.jQuery || document.write('<script src="/path/to/your/jquery"><\/script>');
</script> 
```

这应该在您的页面中`<head>`，并且任何 jQuery 就绪事件处理程序都应该在其中`<body>`以避免错误（尽管它不是万无一失的！）。

**不**使用 Google 托管的**jQuery**的另一个原因是，在某些国家/地区，Google 的域名被禁止。

* * *

## 回答 #2

> 赞同：337
> 
> 时间：2012-02-22T18:05:36.163

到目前为止，最简单和最干净的方法：

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="path/to/your/jquery"><\/script>')</script> 
```

* * *

## 回答 #3

> 赞同：76
> 
> 时间：2009-06-22T01:15:06.713

这似乎对我有用：

```
<html>
<head>
<script type="text/javascript" src="http://www.google.com/jsapi"></script>
<script type="text/javascript">
// has the google object loaded?
if (window.google && window.google.load) {
    google.load("jquery", "1.3.2");
} else {
    document.write('<script type="text/javascript" src="http://joecrawford.com/jquery-1.3.2.min.js"><\/script>');
}
window.onload = function() {
    $('#test').css({'border':'2px solid #f00'});
};
</script>
</head>
<body>
    <p id="test">hello jQuery</p>
</body>
</html> 
```

它的工作方式是使用`google`调用[http://www.google.com/jsapi](http://www.google.com/jsapi)加载到对象上的`window`对象。如果该对象不存在，我们假设对 Google 的访问失败。如果是这种情况，我们使用`document.write`. *（在这种情况下，我使用的是我自己的服务器，请使用您自己的服务器进行测试）。*

我还测试了是否存在`window.google.load`- 我还可以`typeof`检查事物是否是适当的对象或函数。但我认为这可以解决问题。

这只是加载逻辑，因为代码突出显示似乎失败了，因为我发布了我正在测试的整个 HTML 页面：

```
if (window.google && window.google.load) {
    google.load("jquery", "1.3.2");
} else {
    document.write('<script type="text/javascript" src="http://joecrawford.com/jquery-1.3.2.min.js"><\/script>');
} 
```

虽然我必须说，我不确定如果这对您的网站访问者来说是一个问题，那么您是否应该摆弄[Google AJAX Libraries API](https://developers.google.com/speed/libraries/)。

**有趣的事实**：*我最初尝试在各种版本中为此使用 try..catch 块，但找不到像这样干净的组合。我很想看看这个想法的其他实现，纯粹作为一个练习。*

* * *

## 回答 #4

> 赞同：31
> 
> 时间：2012-06-26T20:41:31.460

如果您的站点上嵌入了modernizr.js，您可以使用内置的yepnope.js 异步加载您的脚本——其中包括jQuery（带有回退）。

```
Modernizr.load([{
    load : '//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js'
},{
    test : window.jQuery,
    nope : 'path/to/local/jquery-1.7.2.min.js',
    both : ['myscript.js', 'another-script.js'],
    complete : function () {
        MyApp.init();
    }
}]); 
```

这会从 Google-cdn 加载 jQuery。然后检查 jQuery 是否加载成功。如果不是（“nope”），则加载本地版本。您的个人脚本也会被加载——“both”表示加载过程是独立于测试结果启动的。

当所有加载过程完成后，将执行一个函数，例如“MyApp.init”。

我个人更喜欢这种异步脚本加载方式。由于我在构建站点时依赖于modernizr 提供的功能测试，因此无论如何我都将它嵌入到站点中。所以实际上没有开销。

* * *

## 回答 #5

> 赞同：22
> 
> 时间：2009-06-26T17:02:10.780

这里有一些很棒的解决方案，但我想进一步了解本地文件。

在 Google 确实失败的情况下，它应该加载本地源，但服务器上的物理文件可能不一定是最佳选择。我提出这个是因为我目前正在实施相同的解决方案，只是我想退回到由数据源生成的本地文件。

我这样做的原因是，在跟踪我从 Google 加载的内容与本地服务器上的内容时，我想有一些想法。如果我想更改版本，我想让我的本地副本与我尝试从 Google 加载的内容保持同步。在一个有很多开发人员的环境中，我认为最好的方法是自动化这个过程，这样人们所要做的就是更改配置文件中的版本号。

这是我提出的理论上应该可行的解决方案：

*   在应用程序配置文件中，我将存储 3 件事：库的绝对 URL、JavaScript API 的 URL 和版本号
*   编写一个获取库本身文件内容的类（从应用配置获取 URL），将其存储在我的数据源中，并带有名称和版本号
*   编写一个处理程序，将我的本地文件从数据库中拉出并缓存文件，直到版本号更改。
*   如果它确实发生了变化（在我的应用程序配置中），我的类将根据版本号提取文件内容，将其作为新记录保存在我的数据源中，然后处理程序将启动并提供新版本。

理论上，如果我的代码编写正确，我需要做的就是更改我的应用程序配置中的版本号，然后中提琴！您有一个自动化的后备解决方案，您不必在服务器上维护物理文件。

大家怎么看？也许这是矫枉过正，但它可能是维护 AJAX 库的一种优雅方法。

橡子

* * *

## 回答 #6

> 赞同：20
> 
> 时间：2011-01-28T05:49:04.453

```
if (typeof jQuery == 'undefined') {
// or if ( ! window.jQuery)
// or if ( ! 'jQuery' in window)
// or if ( ! window.hasOwnProperty('jQuery'))    

  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src = '/libs/jquery.js';

  var scriptHook = document.getElementsByTagName('script')[0];
  scriptHook.parentNode.insertBefore(script, scriptHook);

} 
```

在您尝试从 CDN 包含 Google 的副本之后。

在 HTML5 中，您不需要设置`type`属性。

您还可以使用...

```
window.jQuery || document.write('<script src="/libs/jquery.js"><\/script>'); 
```

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2013-01-12T16:42:45.787

您可能希望使用本地文件作为最后的手段。

似乎截至目前 jQuery 自己的 CDN 不支持 https。如果是这样，那么您可能希望先从那里加载。

所以顺序如下：Google CDN => Microsoft CDN => 您的本地副本。

```
<!-- load jQuery from Google's CDN -->
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script> 
<!-- fallback to Microsoft's Ajax CDN -->
<script> window.jQuery || document.write('<script src="//ajax.aspnetcdn.com/ajax/jQuery/jquery-1.8.3.min.js">\x3C/script>')</script> 
<!-- fallback to local file -->
<script> window.jQuery || document.write('<script src="Assets/jquery-1.8.3.min.js">\x3C/script>')</script> 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2014-02-21T16:09:15.100

有条件地加载最新/旧 jQuery 版本和回退：

```
<!--[if lt IE 9]>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="/public/vendor/jquery-legacy/dist/jquery.min.js">\x3C/script>')</script>
<![endif]-->
<!--[if gte IE 9]><!-->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="/public/vendor/jquery/dist/jquery.min.js">\x3C/script>')</script>
<!--<![endif]--> 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2011-06-05T09:02:59.177

由于谷歌的禁止问题，我更喜欢使用微软的 cdn [http://www.asp.net/ajaxlibrary/cdn.ashx](http://www.asp.net/ajaxlibrary/cdn.ashx)

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2011-06-19T06:41:35.797

*   第 1 步：jQuery 是否加载失败？（检查`jQuery`变量）

[如何在 JavaScript 中检查未定义的变量](https://stackoverflow.com/questions/858181/how-to-check-a-not-defined-variable-in-javascript)

*   第 2 步：动态导入（备份）javascript 文件

[如何在另一个 JavaScript 文件中包含一个 JavaScript 文件？](https://stackoverflow.com/questions/950087/include-javascript-file-inside-javascript-file)

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2012-06-26T20:58:28.743

**更新：**
这个答案原来是错误的。真正的解释请看评论。

* * *

你们中的大多数问题都已得到解答，但至于最后一部分：

> 两个副本都通过会有什么危险？

真的没有。您会浪费带宽，下载第二个无用的副本可能会增加几毫秒的时间，但如果它们都通过，则不会造成实际伤害。当然，您应该使用上述技术避免这种情况。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2014-10-20T09:36:31.247

对于那些使用 ASP.NET MVC 5 的人，在您的 BundleConfig.cs 中添加此代码以启用 jquery 的 CDN：

```
bundles.UseCdn = true;
Bundle jqueryBundle = new ScriptBundle("~/bundles/jquery", "//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js").Include("~/Scripts/jquery-{version}.js");
jqueryBundle.CdnFallbackExpression = "window.jQuery";
bundles.Add(jqueryBundle); 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2011-02-26T14:19:21.473

```
if (typeof jQuery == 'undefined')) { ... 
```

或者

```
if(!window.jQuery){ 
```

如果没有加载 cdn 版本，将无法工作，因为浏览器将在此条件下运行，并且在此期间仍会下载需要 jQuery 的其余 javascripts 并返回错误。解决方案是通过该条件加载脚本。

```
 <script src="http://WRONGPATH.code.jquery.com/jquery-1.4.2.min.js" type="text/javascript"></script><!--  WRONGPATH for test-->
  <script type="text/javascript">
  function loadCDN_or_local(){
    if(!window.jQuery){//jQuery not loaded, take a local copy of jQuery and then my scripts
      var scripts=['local_copy_jquery.js','my_javascripts.js'];
      for(var i=0;i<scripts.length;i++){
      scri=document.getElementsByTagName('head')[0].appendChild(document.createElement('script'));
      scri.type='text/javascript';
      scri.src=scripts[i];
    }
  }
  else{// jQuery loaded can load my scripts
    var s=document.getElementsByTagName('head')[0].appendChild(document.createElement('script'));
    s.type='text/javascript';
    s.src='my_javascripts.js';
  }
  }
  window.onload=function(){loadCDN_or_local();};
  </script> 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2013-05-26T04:44:22.793

我认为应该将字符串中的最后一个 < 转义为 \x3C。当浏览器看到 时，它认为这是脚本块的结尾（因为 HTML 解析器不知道 JavaScript，它无法区分仅出现在字符串中的内容和实际上意味着结束脚本的内容元素）。因此，在 HTML 页面内的 JavaScript 中逐字出现（在最好的情况下）会导致错误，并且（在最坏的情况下）会成为一个巨大的安全漏洞。

```
<script src="https://ajax.aspnetcdn.com/ajax/jquery/jquery-2.0.0.min.js"></script>
<script>window.jQuery || document.write('<script src="js/jquery-2.0.0.min.js">\x3C/script>')</script> 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2014-03-20T20:45:45.243

我做了一个 Gist，如果它还没有加载，它应该动态加载 jQuery，如果源失败，它会继续回退（从许多答案拼接在一起）：[https ://gist.github.com/tigerhawkvok/9673154](https://gist.github.com/tigerhawkvok/9673154)

请注意，我计划更新要点，但不更新这个答案，因为它的价值！

```
/* See https://gist.github.com/tigerhawkvok/9673154 for the latest version */
function cascadeJQLoad(i) { // Use alternate CDNs where appropriate to load jQuery
    if (typeof(i) != "number") i = 0;
    // the actual paths to your jQuery CDNs
    var jq_paths = [
        "ajax.googleapis.com/ajax/libs/jquery/2.1.0/jquery.min.js",
        "ajax.aspnetcdn.com/ajax/jQuery/jquery-2.1.0.min.js"
    ];
    // Paths to your libraries that require jQuery
    var dependent_libraries = [
        "js/c.js"
    ];
    if (window.jQuery === undefined && i < jq_paths.length) {
        i++;
        loadJQ(jq_paths[i], i, dependent_libraries);
    }
    if (window.jQuery === undefined && i == jq_paths.length) {
        // jQuery failed to load
        // Insert your handler here
    }
}

/***
 * You shouldn't have to modify anything below here
 ***/

function loadJQ(jq_path, i, libs) { //load jQuery if it isn't already
    if (typeof(jq_path) == "undefined") return false;
    if (typeof(i) != "number") i = 1;
    var loadNextJQ = function() {
        var src = 'https:' == location.protocol ? 'https' : 'http';
        var script_url = src + '://' + jq_path;
        loadJS(script_url, function() {
            if (window.jQuery === undefined) cascadeJQLoad(i);
        });
    }
    window.onload = function() {
        if (window.jQuery === undefined) loadNextJQ();
        else {
            // Load libraries that rely on jQuery
            if (typeof(libs) == "object") {
                $.each(libs, function() {
                    loadJS(this.toString());
                });
            }
        }
    }
    if (i > 0) loadNextJQ();
}

function loadJS(src, callback) {
    var s = document.createElement('script');
    s.src = src;
    s.async = true;
    s.onreadystatechange = s.onload = function() {
        var state = s.readyState;
        try {
            if (!callback.done && (!state || /loaded|complete/.test(state))) {
                callback.done = true;
                callback();
            }
        } catch (e) {
            // do nothing, no callback function passed
        }
    };
    s.onerror = function() {
        try {
            if (!callback.done) {
                callback.done = true;
                callback();
            }
        } catch (e) {
            // do nothing, no callback function passed
        }
    }
    document.getElementsByTagName('head')[0].appendChild(s);
}

/*
 * The part that actually calls above
 */

if (window.readyState) { //older microsoft browsers
    window.onreadystatechange = function() {
        if (this.readyState == 'complete' || this.readyState == 'loaded') {
            cascadeJQLoad();
        }
    }
} else { //modern browsers
    cascadeJQLoad();
} 
```

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2016-01-24T11:54:58.247

**谷歌托管的 jQuery**

*   如果您关心较旧的浏览器，主要是 IE9 之前的 IE 版本，这是最广泛兼容的 jQuery 版本

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
```

*   如果你不关心oldIE，这个更小更快：

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
```

**备份/后备计划！**

*   无论哪种方式，您都应该使用回退到本地，以防 Google CDN 失败（不太可能）或在您的用户访问您的网站的位置（可能性稍大）被阻止，例如伊朗或有时是中国。

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script>if (!window.jQuery) { document.write('<script src="/path/to/your/jquery"><\/script>'); }
</script> 
```

**参考：** [http ://websitespeedoptimizations.com/ContentDeliveryNetworkPost.aspx](http://websitespeedoptimizations.com/ContentDeliveryNetworkPost.aspx)

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2019-06-22T05:10:40.033

几乎所有公共 CDN 都非常可靠。但是，如果您担心被阻止的 google 域，那么您可以简单地回退到替代[jQuery CDN](https://pagecdn.com/lib/jquery)。**但是，在这种情况下，您可能更愿意以相反的方式执行此操作，**并使用其他一些 CDN 作为您的首选选项并回退到 Google CDN 以避免失败的请求和等待时间：

```
<script src="https://pagecdn.io/lib/jquery/3.2.1/jquery.min.js"></script>
<script>
   window.jQuery || document.write('<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"><\/script>');
</script> 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2012-01-22T21:50:37.200

在 ASP.NET 中使用 Razor 语法，此代码提供回退支持并与虚拟根一起使用：

```
@{var jQueryPath = Url.Content("~/Scripts/jquery-1.7.1.min.js");}
<script type="text/javascript">
    if (typeof jQuery == 'undefined')
        document.write(unescape("%3Cscript src='@jQueryPath' type='text/javascript'%3E%3C/script%3E"));
</script> 
```

或制作一个助手（[助手概述](http://weblogs.asp.net/jgalloway/archive/2011/03/23/comparing-mvc-3-helpers-using-extension-methods-and-declarative-razor-helper.aspx)）：

```
@helper CdnScript(string script, string cdnPath, string test) {
    @Html.Raw("<script src=\"http://ajax.aspnetcdn.com/" + cdnPath + "/" + script + "\" type=\"text/javascript\"></script>" +
        "<script type=\"text/javascript\">" + test + " || document.write(unescape(\"%3Cscript src='" + Url.Content("~/Scripts/" + script) + "' type='text/javascript'%3E%3C/script%3E\"));</script>")
} 
```

并像这样使用它：

```
@CdnScript("jquery-1.7.1.min.js", "ajax/jQuery", "window.jQuery")
@CdnScript("jquery.validate.min.js", "ajax/jquery.validate/1.9", "jQuery.fn.validate") 
```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2015-01-07T08:44:04.313

尽管编写`document.write("<script></script>")`jQuery 退避似乎更容易，但 Chrome 在这种情况下会给出验证错误。所以我更喜欢打破“脚本”这个词。所以它变得像上面一样更安全。

```
<script src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.11.1.min.js"></script>
<script>if (typeof jQuery === "undefined") {
   window.jqFallback = true;
   document.write("<scr"+"ipt src='http://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.1/jquery.min.js'></scr"+"ipt>");
} </script> 
```

对于长期问题，最好记录 JQuery 回退。在上面的代码中，如果第一个 CDN 不可用，则从另一个 CDN 加载 JQuery。但是您可能想知道错误的 CDN 并将其永久删除。（这种情况是非常特殊的情况）另外最好记录回退问题。因此，您可以使用 AJAX 发送错误的案例。由于未定义 JQuery，因此您应该使用 vanilla javascript 进行 AJAX 请求。

```
<script type="text/javascript">
    if (typeof jQuery === 'undefined' || window.jqFallback == true) {
        // XMLHttpRequest for IE7+, Firefox, Chrome, Opera, Safari
        // ActiveXObject for IE6, IE5
        var xmlhttp = window.XMLHttpRequest ? new XMLHttpRequest() : new ActiveXObject("Microsoft.XMLHTTP");
        var url = window.jqFallback == true ? "/yourUrl/" : "/yourUrl2/";
        xmlhttp.open("POST", url, true);
        xmlhttp.send();
    }
</script> 
```

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2015-06-26T16:27:01.167

无法从您无法控制的外部数据存储中加载资源是很困难的。寻找丢失的函数作为一种避免超时的方法是完全错误的，如下所述： [http ://www.tech-101.com/support/topic/4499-issues-using-a-cdn/](http://www.tech-101.com/support/topic/4499-issues-using-a-cdn/)

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2015-10-07T11:28:33.107

另一个将**ajax.googleapis.com**替换为**cdnjs.cloudflare.com**的后备方案：

```
(function (doc, $)
{
    'use strict';

    if (typeof $ === 'undefined')
    {
        var script = doc.querySelector('script[src*="jquery.min.js"]'),
            src = script.src.replace('ajax.googleapis.com', 'cdnjs.cloudflare.com');

        script.parentNode.removeChild(script);
        doc.write('<script src="' + src + '"></script>');
    }
})(document, window.jQuery || window.Zepto); 
```

*   您可以通过在字符串中指定它来坚持使用 jQuery 版本
*   非常适合不适用于 HTML 剪辑的资产管理
*   在野外测试 - 非常适合来自中国的用户

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2018-11-07T23:20:59.740

您可以使用如下代码：

```
<script type="text/javascript" src="http://code.jquery.com/jquery-latest.min.js"></script>
<script>window.jQuery || document.write('<script type="text/javascript" src="./scripts/jquery.min.js">\x3C/script>')</script> 
```

但也有一些库可用于为脚本设置**几种**可能的回退并优化加载过程：

*   篮子.js
*   要求JS
*   是的

例子：

**篮子.js** 我认为目前最好的变种。将在 localStorage 中缓存您的脚本，这将加快下一次加载。最简单的调用：

```
basket.require({ url: '/path/to/jquery.js' }); 
```

这将返回一个承诺，您可以在错误时执行下一次调用，或在成功时加载依赖项：

```
basket
    .require({ url: '/path/to/jquery.js' })
    .then(function () {
        // Success
    }, function (error) {
        // There was an error fetching the script
        // Try to load jquery from the next cdn
    }); 
```

**要求JS**

```
requirejs.config({
    enforceDefine: true,
    paths: {
        jquery: [
            '//ajax.aspnetcdn.com/ajax/jquery/jquery-2.0.0.min',
            //If the CDN location fails, load from this location
            'js/jquery-2.0.0.min'
        ]
    }
});

//Later
require(['jquery'], function ($) {
}); 
```

**是的**

```
yepnope([{
  load: 'http://ajax.aspnetcdn.com/ajax/jquery/jquery-2.0.0.min.js',
  complete: function () {
    if (!window.jQuery) {
      yepnope('js/jquery-2.0.0.min.js');
    }
  }
}]); 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2021-11-26T14:15:06.020

您永远不需要使用个人副本。这是我完整的腰带和大括号脚本。

```
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8"/>
        <title>jQuery</title>
        <!-- EMBED JQUERY USING GOOGLE APIs -->
        <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

        <!-- IF THAT FAILS EMBED JQUERY USING CLOUDFLARE CDN -->
        <script type="text/javascript">
            window.jQuery || document.write('<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"><\/script>');
        </script>

        <!-- IF THAT FAILS ************* HOW??? *********** EMBED JQUERY FROM MICROSOFT -->
        <script type="text/javascript">
            window.jQuery || document.write('<script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.6.0.min.js"><\/script>');
        </script>

        <!-- IF THAT FAILS ************* WOW!!! *********** EMBED JQUERY FROM JQUERY.COM -->
        <script type="text/javascript">
            window.jQuery || document.write('<script src="https://code.jquery.com/jquery-3.6.0.min.js"><\/script>');
        </script>

        <!-- IF THAT FAILS ************* LET'S STOP!!! *********** EMBED JQUERY FROM PERSONAL COPY -->
        <script type="text/javascript">
            window.jQuery || document.write('<script src="jquery.min.js"><\/script>');
        </script>
    </head>
    <body>

    </body>
</html> 
```

# javascript - 如何让 WMD-Editor 将 Markdown 发布到服务器而不是 HTML？

> ID：1014205
> 
> 赞同：11
> 
> 时间：2009-06-18T17:51:40.313
> 
> 标签：javascript, markdown, wmd

似乎 WMD-Editor 将 HTML 发布到服务器而不是降价。我怎样才能让它发送降价？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-07-13T19:42:27.673

在 SO 版本的 master 分支中，有趣的行是第 2341 行：

`Attacklab.wmd_defaults = {version:1, output:"HTML", lineLength:40, delayLoad:false};`

将其更改为要求降价：

`Attacklab.wmd_defaults = {version:1, output:"markdown", lineLength:40, delayLoad:false};`

.. 而你会得到 Markdown。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-07-12T15:53:50.053

在[我的版本（mooWMD）](http://moowmd.awardspace.info/)中，您必须将第 1343 行的值从“html”更改为“markdown”。
我相信 SO 版本也是如此（查找“输出”配置值）。

# visual-studio-2008 - 复制到输出目录复制文件夹结构但只想复制文件

> ID：1014207
> 
> 赞同：87
> 
> 时间：2009-06-18T17:51:45.163
> 
> 标签：visual-studio-2008, msbuild

我有一个 VS2008 我想将某些文件从一个目录复制到我的`/bin/`文件夹中。我已将文件（位于 中`/common/browserhawk/`）设置为“复制到输出目录”。但是，它也会复制文件夹结构：文件被复制到`/bin/common/browserhawk/`

如何让这些文件复制到 just `/bin/`？我不想将这些存储在网站的根目录中以使它们正确复制。

相关问题：[Visual Studio 编译后将.dll 和.pdb 添加到项目中](https://stackoverflow.com/questions/1013419/visual-studio-adds-dll-and-pdb-to-project-after-compiling/1013561)

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2010-07-23T20:29:11.167

您可以添加构建后事件来复制文件。
转到项目属性，构建事件选项卡并将以下内容添加到构建后事件命令行：

```
copy "$(ProjectDir)\common\browserhawk\*.*" "$(TargetDir)" 
```

如果您的项目路径中有空格，请务必包含引号。

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2010-12-01T16:09:13.200

由于我无法评论以前的答案，因此我将解决方案放在这里：

添加到 @PaulAlexander 提供的内容，将以下内容添加到您的 .csproj/.vbproj 文件中：

```
<ItemGroup>
    <AvailableItemName Include="RootContent">
      <Visible>false</Visible>
    </AvailableItemName>  
</ItemGroup>
<Target Name="AfterBuild">
    <Copy
        DestinationFolder="$(OutputPath)"
        SourceFiles="@(RootContent)"
        SkipUnchangedFiles="true"
        />  
</Target> 
```

这允许您在“属性”窗口中选择“RootContent”作为构建操作，并且可以通过 GUI 访问所有内容。更完整的解释：“AvailableItemName”选项基本上创建了一个新的命名列表，您可以将项目中的项目分配到“属性”窗口的“构建操作”属性下。然后，您可以在您喜欢的任何目标中使用这个新创建的列表（例如，通过“@(RootContent)”）。

* * *

## 回答 #3

> 赞同：44
> 
> 时间：2014-02-03T18:18:54.450

如果您在文本编辑器中编辑 .csproj / .vbproj，您可以控制文件在输出目录中的位置，以及文件在输出目录中的名称。例如：

```
<None Include="content\someContent.txt">
  <Link>someContentInOutputDirectory.txt</Link>
  <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
</None> 
```

这会将文件`content\someContent.txt`放入`bin\someContentInOutputDirectory.txt`. 您也可以根据`bin`需要选择一个子目录；只需将其添加到 Link 元素。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2010-07-29T17:38:31.123

我相信 XCOPY 命令可以更好地处理目录和文件。所以，

```
 XCOPY "$(ProjectDir)common/browserhawk" "$(TargetDir)" /E /I /F /Y 
```

这允许在目标目录之外创建文件夹。

```
 XCOPY "$(ProjectDir)Templates" "$(TargetDir)" /E /I /F /Y 
```

项目文件夹/文件结构：

```
 A:\TEMP\CONSOLEAPPLICATION3\TEMPLATES
    ├───NewFolder1
    ├───NewFolder2
    │       TextFile1.txt
    │       TextFile2.txt
    └───NewFolder3
            TextFile1.txt
            TextFile2.txt
            TextFile3.txt 
```

变成：

```
 A:\TEMP\CONSOLEAPPLICATION3\BIN\DEBUG
    │   ConsoleApplication3.exe
    │   ConsoleApplication3.pdb
    │   ConsoleApplication3.vshost.exe
    │   ConsoleApplication3.vshost.exe.manifest
    ├───NewFolder1
    ├───NewFolder2
    │       TextFile1.txt
    │       TextFile2.txt
    │
    └───NewFolder3
            TextFile1.txt
            TextFile2.txt
            TextFile3.txt 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2009-06-18T18:27:48.413

将以下内容添加到您的 .csproj/.vbproj 文件中

```
<Target Name="AfterBuild">
    <Copy
        DestinationFolder="$(OutputPath)"
        SourceFiles="@(RootContent)"
        SkipUnchangedFiles="true"
        />  
</Target> 
```

然后将根文件夹中您想要的任何文件的构建操作更改为 RootContent。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2015-03-12T12:49:51.460

我在 VS2010、VS2015、VS2017 和 VS2019 中使用过这个。我更喜欢这个解决方案，因为：

1.  XML 可在任何项目中重用
2.  “RootContent”被选为 Visual Studio UI 中的构建操作，就像任何其他“内容”一样
3.  正如您所期望的那样，遵守“CopyToOutputDirectory”
4.  RootContent 被添加到项目的输出中：通过 Project-References 进行，遵守“清洁”等。
5.  RootContent 可以用通配符指定，保留递归文件夹结构：

> ```
> <RootContent Include="common\browserhawk\**">
>   <CopyToOutputDirectory>Always</CopyToOutputDirectory>
> </RootContent> 
> ```

**朝向项目文件的开头：**

```
 <ItemGroup>
    <AvailableItemName Include="RootContent">
      <!-- Add "RootContent" as a choice in the "Build Action" dropdown. -->
      <Visible>True</Visible>
    </AvailableItemName>
  </ItemGroup> 
```

[借用这个答案](https://stackoverflow.com/a/4326337/2025526)

**在 Microsoft .targets 导入之后：**

```
 <PropertyGroup>
    <AssignTargetPathsDependsOn>
      $(AssignTargetPathsDependsOn);
      IncludeRootContentAsContent;
    </AssignTargetPathsDependsOn>
  </PropertyGroup>
  <Target Name="IncludeRootContentAsContent">
    <CreateItem Include="@(RootContent)" AdditionalMetadata="TargetPath=%(RecursiveDir)%(Filename)%(Extension)">
      <Output ItemName="ContentWithTargetPath" TaskParameter="Include" />
    </CreateItem>
  </Target> 
```

[借用这个答案](https://stackoverflow.com/a/14523011/2025526)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-06-18T19:36:24.500

我最终在成功编译后向 nant 构建文件添加了一个步骤以进行复制

```
<target name="action.copy.browserhawk.config" depends="compile.source">
    <copy todir="${App.Web.dir}/bin/" includeemptydirs="false">
        <fileset basedir="${browserhawk.config.dir}">
            <include name="bhawk_bb.dat" />
            <include name="bhawk_sp.dat" />
            <include name="browserhawk.properties" />
            <include name="maindefs.bdd" />
            <include name="maindefs.bdf" />
            <include name="BH_PRO.lic" />
        </fileset>
    </copy>
    <echo message="COPY BROWSERHAWK CONFIG: SUCCESS   ${datetime::now()}" />
</target> 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-18T18:18:52.217

您可以构建一个批处理文件来复制文件并将其作为构建后事件执行。

# sharepoint - SharePoint/WSS：修改“创建者”字段？

> ID：1014215
> 
> 赞同：2
> 
> 时间：2009-06-18T17:53:03.710
> 
> 标签：sharepoint, permissions, wss

全部 -

我正在使用 WSS 3.0。目前，HR 会将员工的内部公司简历上传到我们网站上的文档库，但出于隐私原因，我们必须限制对该文档库的访问，这迫使用户每次想要更新简历时都必须通过 HR。

我的想法是创建一个启用附件的列表，允许用户仅查看/编辑他们自己的项目，然后授予 HR 管理所有条目的权限。这适用于 HR 需要创建初始列表项并附上简历的例外情况，这意味着列表项将“由 {hr} 创建”，并且附有简历的最终用户不可见/不可编辑。

关于我如何允许 HR 修改上传时的“创建者”字段以便最终用户可以看到并可以编辑他们的简历，或者以不同的方式进行此操作的任何想法？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-26T21:30:16.680

创建一个文档库来保存简历。然后赋予 HR 部门（SharePoint 用户组）对该库的“读/写所有”权限，赋予其他人读/写自己的“权限。根据外部创建一个名为“Resume”的 Content Type box 文档内容类型。然后在内容类型中添加一个包含简历涉及的员工（SPUser 字段）的字段（以及所需的任何其他字段，即姓名、地址等）。让 HR 在创建列表项时正确填写（填写必填字段）。

然后，编写一个绑定到您刚刚创建的内容类型的 itemeventreceiver 并覆盖 ItemUpdated 事件。

代码将类似于以下内容：

```
public override void ItemUpdated(SPItemEventProperties properties)
{
  SPSecurity.RunWithElevatedPrivileges(delegate
  {
    using (SPWeb web = properties.OpenWeb())
    {
       web.AllowUnsafeUpdates = true; 
       var item = web.Lists[properties.ListId].GetItemById(properties.ListItemId);
       if (item != null)
       {
         if (item.Fields.ContainsField("Employee"))
         {
           item["Author"] = item["Employee"]; 
           // Author is the internal name of the Created by field, 
           // always use Internal Names!
           DisableEventFiring();
           item.SystemUpdate();
           EnableEventFiring();
         }
       }
     }
   });
} 
```

您可以使用 FeatureReceiver 将 ItemEventReceiver 绑定到内容类型，如下所示：

```
SPContentType docCt = web.ContentTypes[new SPContentTypeId("CONTENTYPE ID GOES HERE")];
docCt.EventReceivers.Add(SPEventReceiverType.ItemUpdated, "ASSEMBLYNAME, Version=1.0.0.0, Culture=neutral, PublicKeyToken=TOKEN", "FULLY QUALIFIED CLASSNAME");
docCt.Update(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-18T17:57:53.843

为什么不直接使用文档库来保存简历？（而不是带有附件的列表。）您可以授予 HR 对其中所有文档的完全读/写权限，并且简历的所有者将仅对他们自己的简历有贡献权限。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-02-22T18:11:26.917

我找到了一种使用 SharePoint Designer 创建工作流来更改“创建者”字段的方法。

1.  在您的列表中创建一个具有易于识别的名称的虚拟字段，例如 XYZZY。使其成为“个人或组”字段。
2.  在 SharePoint Designer 中，为您的列表创建一个工作流。允许手动启动并在创建新项目时自动启动。
3.  操作 -> 在当前项目中设置字段 -> 将 XYZZY 设置为列表中包含要放入创建者的用户帐户的字段。
4.  点击完成
5.  现在，使用记事本打开您的工作流 .xoml 文件。将“XYZZY”替换为“作者”。保存 .xoml 文件。
6.  在 Designer 中打开工作流。单击完成，以便使用新代码重新处理。
7.  从列表中删除虚拟字段。
8.  对列表中的每个现有项目运行工作流。新项目将自动自我更正。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-18T19:12:20.650

使用自定义上传屏幕，您可以在上传之前更改当前用户的上下文。它需要使用类似于以下内容的方式查找用户令牌（这些是工作代码片段，其中删除了错误处理和其他内容）。请注意， EnsureUser 将要求当前用户基本上是管理员/所有者。

```
using (SPSite site = GetImpersonatedSite(runAsUser))
{
    using (SPWeb web = site.OpenWeb())
    {
        // Do stuff here
    }
}

private SPSite GetImpersonatedSite(string username)
{
    user = SPContext.Current.Web.EnsureUser(username);
    SPSite site = new SPSite(SPContext.Current.Web.Url, user.UserToken);
    return site;
} 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-06-18T19:36:36.217

我有类似的情况（迁移到共享点），我必须将管理员用户的文件添加到文档库，然后“更改”用户。我是这样做的，可能会对您有所帮助：

```
using (var root = site.RootWeb)
 {
   var users = root.SiteUsers;
   var user = users["domain\username"];
   file.Item[SPBuiltInFieldId.Created_x0020_By] = user.ID;
   file.Item[SPBuiltInFieldId.Modified_x0020_By] = user.ID;
   file.Item.UpdateOverwriteVersion(); 
```

# teamcity - 如何将 Teamcity 连接到现有的 SQLServer 2005 数据库

> ID：1014228
> 
> 赞同：1
> 
> 时间：2009-06-18T17:55:32.023
> 
> 标签：teamcity

我们有一台运行 teamcity 4.0.2 并使用 SqlServer 2005 作为数据存储的机器。机器崩溃了，但我们还有数据库。如何将新创建的 teamcity 实例连接到数据库？

我找到了有关将现有 teamcity 安装迁移到新数据库的信息。但这不是我想要的。

编辑：我认为数据库包含项目的配置。事实并非如此：它在 Teamcity 数据目录 (.BuildServer) 的文件夹配置中

我只需将该文件夹的内容复制到我的新安装中。我想我的问题是错误的。无论如何，我保持原样，因为可能还有其他人有相同的想法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-18T18:03:27.517

使用内部数据库启动 TeamCity，以便重新创建 TeamCity 配置目录（除非您已经备份了该目录）。

然后关闭 TeamCity 并将数据库驱动程序（最新版本为[jtds-1.2.2.jar](http://jtds.sourceforge.net/)）复制到`TeamCity\webapps\ROOT\WEB-INF\lib`并在以下位置创建 database.properties 文件`.BuildServer\config\database.properties`：

```
driverName=net.sourceforge.jtds.jdbc.Driver
connectionUrl=jdbc:jtds:sqlserver://192.168.1.99:1433/TeamCityDB
connectionProperties.user=teamcity_user
connectionProperties.password=teamcity_passwd 
maxConnections=50
poolPreparedStatements=true 
```

重新启动 TeamCity，您应该一切顺利。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-18T18:07:09.913

1.  下载[MSSQL 驱动程序](http://jtds.sourceforge.net/)并将其复制到 TeamCity 安装的 WEB-INF/lib 中（如果您正在运行 Windows，可能在程序文件下）。

2.  在你的 config 目录中创建一个名为 database.properties 的文件（在 Windows 下，它通常是 Documents and settings\user_who_ran_install.buildserver\config），并将以下几行放入其中：

    driverName=net.sourceforge.jtds.jdbc.Driver connectionUrl=jdbc:jtds:sqlserver://:1433/connectionProperties.user= connectionProperties.password=

    maxConnections=50 poolPreparedStatements=true

重新启动 TeamCity Web 服务器服务。它不会恢复或无法访问的可能性非零。按照[此处](http://www.jetbrains.net/confluence/display/TCD4/Setting+up+an+External+Database)的说明进行操作，您应该没问题。确保有可用的数据库备份，以防 TeamCity 出于某种原因决定重新安装所有数据对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T17:58:55.853

我不知道团队城市是如何运作的，所以我可能没有最好的答案。但是，您不能尝试备份数据库，重新安装团队城市，然后在团队城市创建的实例上恢复备份数据库吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-07-10T15:14:41.553

我在 TeamCity 9.1 和 SQL Server 2012 上遇到了类似的问题。我们的 TeamCity 没问题，但 db 无法访问。我们必须将数据库的备份副本恢复到另一台服务器，然后将 TeamCity 指向它。为了将 TeamCity 指向新服务器上的数据库，我们需要修改 C:\programData\JetBrains\TeamCity\config 中的 database.properties 文件。然后在构建机器上重新启动 TeamCity 服务。在那之后，TeamCity 能够上来就好了。

# wxpython - wxPython：如何让两个工具栏使用一个状态栏作为工具提示？

> ID：1014239
> 
> 赞同：2
> 
> 时间：2009-06-18T17:57:24.017
> 
> 标签：wxpython, wxwidgets

我有一个界面，它有两个工具栏，一个附加到框架上，一个嵌入到笔记本选项卡中。框架中的那个忠实地在状态栏中显示 longHelp 字符串，而笔记本选项卡中的那个则没有。我如何告诉笔记本选项卡上的那个在哪里显示它的帮助，还是我必须自己管理进入和离开绑定？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2017-07-18T13:09:55.660

虽然这篇文章相当老，但我自己也偶然发现了同样的问题。使用 wxPython Phoenix 4.0.0a4，我找到的解决方案是使用工具栏的 id 将函数绑定到 EVT_TOOL_ENTER 事件。

```
your_frame.Bind(wx.EVT_TOOL_ENTER, your_function, id=toolbar_id) 
```

然后在 your_function 中，您可以从工具栏中获取工具、工具中的帮助文本并将其写入状态栏。

```
def your_function(e):
    tool_id = e.GetSelection()
    if tool_id != -1:
        # if the mouse is over a toolbar item
        event_object = e.GetEventObject()
        tool = event_object.FindById(tool_id)  
        text = tool.GetLongHelp()
    else:
        # if the mouse is in the toolbar area, but not on an item
        text = some_default_text
    your_frame.GetStatusBar().SetStatusText(text) 
```

EVT_TOOL_ENTER 的简短描述可以在[wxPython 文档](https://wxpython.org/Phoenix/docs/html/wx.ToolBar.html#events-events-emitted-by-this-class)中找到。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-20T10:42:06.353

来自 wxPython 文档 """ longHelpString 当鼠标指针位于工具 """ 内时，此字符串显示在父框架的状态栏（如果有）中

所以笔记本中的工具栏没有任何状态栏来显示长帮助，所以我们应该通过 src 来调查它如何查询 abt 状态栏并为主机状态栏提供参考

否则我认为更好的方法是覆盖 wxToolBar::OnMouseEnter 并直接在状态栏上显示帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-25T01:32:48.270

您在 wxWidgets 中有：

```
void wxToolBarBase::OnMouseEnter(int id)
{
    ...
    wxFrame *frame = wxDynamicCast(GetParent(), wxFrame);
    if ( frame )
    {
        ...
        frame->DoGiveHelp(help, id != wxID_ANY);
    }
    ...
} 
```

在 C++ 程序中，您可以覆盖此函数（只需将 GetParent() 更改为 GetTopLevelParent() 即可）。如您所写，在 Python 中，您只能绑定进入/离开事件并从处理程序调用 DoGiveHelp()。

# vb.net - 有效的文件名检查。什么是最好的方法？

> ID：1014242
> 
> 赞同：12
> 
> 时间：2009-06-18T17:58:05.217
> 
> 标签：vb.net

请参阅提出问题的主题。

1) 我记得在 VB.NET 中看到一个非常酷的选项，使用 LINQ 来匹配使用“LIKE%”

2）我知道正则表达式会起作用，我怀疑这会产生最短的代码，并且对于这样一个简单的测试可能不会太难阅读。

这就是我所做的。警告：你会讨厌它。

```
Private Shared Function FileNameIsOk(ByVal fileName As String) As Boolean

    For Position As Integer = 0 To fileName.Length - 1

        Dim Character As String = fileName.Substring(Position, 1).ToUpper
        Dim AsciiCharacter As Integer = Asc(Character)

        Select Case True

            Case Character = "_" 'allow _
            Case Character = "." 'allow .
            Case AsciiCharacter >= Asc("A") And AsciiCharacter <= Asc("A") 'Allow alphas
            Case AsciiCharacter >= Asc("0") AndAlso AsciiCharacter <= Asc("9") 'allow digits

            Case Else 'otherwise, invalid character
                Return False

        End Select

    Next

    Return True

End Function 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-12-30T07:10:07.820

现在旧了，但我看到了这个，只需要添加一个新的答案。当前接受的和其他答案比需要的要复杂得多。事实上，它可以简化为一行：

```
Public Shared Function FilenameIsOK(ByVal fileName as String) as Boolean
    Return Not (Path.GetFileName(fileName).Intersect(Path.GetInvalidFileNameChars()).Any() OrElse Path.GetDirectoryName(fileName).Intersect(Path.GetInvalidPathChars()).Any()) 
End Function 
```

虽然我不建议这样写。稍微分解一下以提高可读性：

```
Public Shared Function FilenameIsOK(ByVal fileName as String) as Boolean
    Dim file As String = Path.GetFileName(fileName)
    Dim directory As String = Path.GetDirectoryName(fileName)

    Return Not (file.Intersect(Path.GetInvalidFileNameChars()).Any() _
                OrElse _ 
                directory.Intersect(Path.GetInvalidPathChars()).Any()) 
End Function 
```

这里还有一点，通常是处理文件系统问题的最佳方法是让文件系统告诉您：尝试打开或创建有问题的文件，并处理异常。这特别有效，*因为无论如何您都可能不得不这样做*。您在此处执行的任何其他验证都是重复的工作，您仍然必须将其放入异常处理程序中。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-06-18T18:20:23.730

[Path.GetInvalidFileNameChars](http://msdn.microsoft.com/en-us/library/system.io.path.getinvalidfilenamechars.aspx)和[Path.GetInvalidPathChars](http://msdn.microsoft.com/en-us/library/system.io.path.getinvalidpathchars.aspx)怎么样？

```
Public Shared Function FilenameIsOK(ByVal fileNameAndPath as String) as Boolean
    Dim fileName = Path.GetFileName(fileNameAndPath)
    Dim directory = Path.GetDirectoryName(fileNameAndPath)
    For each c in Path.GetInvalidFileNameChars()
        If fileName.Contains(c) Then
            Return False
        End If
    Next
    For each c in Path.GetInvalidPathChars()
        If directory.Contains(c) Then
            Return False
        End If
    Next
    Return True
End Function 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-18T18:14:45.783

它是一个正则表达式和 C#，但是：

```
using System;
using System.Text.RegularExpressions;

/// <summary>
/// Gets whether the specified path is a valid absolute file path.
/// </summary>
/// <param name="path">Any path. OK if null or empty.</param>
static public bool IsValidPath( string path )
{
    Regex r = new Regex( @"^(([a-zA-Z]\:)|(\\))(\\{1}|((\\{1})[^\\]([^/:*?<>""|]*))+)$" );
    return r.IsMatch( path );
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-11-22T05:15:40.087

我不能把这一个（以及两个）班轮归功于。我在谷歌搜索时找到了它 - 不记得我在哪里找到它。

```
 Dim newFileName As String = "*Not<A>Good:Name|For/\File?"
    newFileName = String.Join("-", fileName.Split(IO.Path.GetInvalidFileNameChars)) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-18T18:09:22.187

坦率地说，我只是使用 .NET 中内置的 FileInfo 对象，并检查异常是否无效。有关详细信息，请参阅[此](http://msdn.microsoft.com/en-us/library/system.io.fileinfo.fileinfo.aspx)参考。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-09-13T03:32:27.123

尽管这已经很老了，但它仍然有效，我最终在这里寻找如何检查文件名中是否存在无效字符的解决方案。我查看了接受的答案，发现了一些漏洞。

希望这些修改对其他人有用。

```
Public Function FilenameIsOK(ByVal fileNameAndPath As String) As Boolean
    Dim fileName As String = String.Empty
    Dim theDirectory As String = fileNameAndPath

    Dim p As Char = Path.DirectorySeparatorChar

    Dim splitPath() As String
    splitPath = fileNameAndPath.Split(p)
    If splitPath.Length > 1 Then
        fileName = splitPath(splitPath.Length - 1)
        theDirectory = String.Join(p, splitPath, 0, splitPath.Length - 1)
    End If

    For Each c As Char In Path.GetInvalidFileNameChars()
        If fileName.Contains(c) Then
            Return False
        End If
    Next

    For Each c As Char In Path.GetInvalidPathChars()
        If theDirectory.Contains(c) Then
            Return False
        End If
    Next
    Return True
End Function 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-02-23T17:00:11.323

试试这个

```
Public Function IsValidFileName(ByVal fn As String) As Boolean
    Try
        Dim fi As New IO.FileInfo(fn)
    Catch ex As Exception
        Return False
    End Try
    Return True
End Function 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-10-03T08:29:53.253

基于 Joel Coehoorns 编写良好的解决方案，我添加了一些额外的验证功能。

```
 ''' <summary>
    ''' Check if fileName is OK
    ''' </summary>
    ''' <param name="fileName">FileName</param>
    ''' <param name="allowPathDefinition">(optional) set true to allow path definitions. If set to false only filenames are allowed</param>
    ''' <param name="firstCharIndex">(optional) return the index of first invalid character</param>
    ''' <returns>true if filename is valid</returns>
    ''' <remarks>
    ''' based on Joel Coehoorn answer in 
    ''' http://stackoverflow.com/questions/1014242/valid-filename-check-what-is-the-best-way
    ''' </remarks>
    Public Shared Function FilenameIsOK(ByVal fileName As String, _
                                        Optional ByVal allowPathDefinition As Boolean = False, _
                                        Optional ByRef firstCharIndex As Integer = Nothing) As Boolean

        Dim file As String = String.Empty
        Dim directory As String = String.Empty

        If allowPathDefinition Then
            file = Path.GetFileName(fileName)
            directory = Path.GetDirectoryName(fileName)
        Else
            file = fileName
        End If

        If Not IsNothing(firstCharIndex) Then
            Dim f As IEnumerable(Of Char)
            f = file.Intersect(Path.GetInvalidFileNameChars())
            If f.Any Then
                firstCharIndex = Len(directory) + file.IndexOf(f.First)
                Return False
            End If

            f = directory.Intersect(Path.GetInvalidPathChars())
            If f.Any Then
                firstCharIndex = directory.IndexOf(f.First)
                Return False
            Else
                Return True
            End If
        Else
            Return Not (file.Intersect(Path.GetInvalidFileNameChars()).Any() _
                        OrElse _
                        directory.Intersect(Path.GetInvalidPathChars()).Any())
        End If

    End Function 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-12-30T06:58:49.630

行。好主意。但是，当您处理数千个文件时，手动迭代“无效”字符并不是最好的方法。

```
Public BadChars() As Char = IO.Path.GetInvalidFileNameChars

For m = 0 To thousands_of_files - 1
    '..
    if currFile.Name.ToCharArray.Intersect(BadChars).Count > 1 Then
         ' the Name is invalid - what u gonna do? =)
    end if
    '..
    '..
Next 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-01-13T13:49:47.317

试试这个

```
Function IsValidFileNameOrPath(ByVal name As String) As Boolean

    Dim i As Integer
    Dim dn, fn As String

    i = InStrRev(name, "\") : dn = Mid(name, 1, i) : fn = Mid(name, i + 1)
    MsgBox("directory = " & dn & " : file = " & fn)

    If name Is Nothing Or Trim(fn) = "" Then
        MsgBox("null filename" & fn)
        Return False
    Else
        For Each badchar As Char In Path.GetInvalidFileNameChars
            If InStr(fn, badchar) > 0 Then
                MsgBox("invalid filename" & fn)
                Return False
            End If
        Next
    End If

    If dn <> "" Then
        If InStr(dn, "\\") > 0 Then
            MsgBox("duplicate \ =  " & dn)
            Return False
        End If
        For Each badChar As Char In Path.GetInvalidPathChars
            If InStr(dn, badChar) > 0 Then
                MsgBox("invalid directory=  " & dn)
                Return False
            End If
        Next
        If Not System.IO.Directory.Exists(dn) Then
            Try
                Directory.CreateDirectory(dn)
                'Directory.Delete(dn)
            Catch
                MsgBox("invalid path =  " & dn)
                Return False
            End Try
        End If
    End If
    Return True
End Function 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-12-14T11:22:40.893

```
Public Function IsValidFileName(nFile As String) As Boolean
    Try
        Dim S As String = Path.GetFileName(nFile)
    Catch
        Return False
    End Try
    Return True
End Function 
```

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2021-05-06T13:10:32.267

这是一种简单的方法，即使在文件夹上也是如此：

```
 Try
        My.Computer.FileSystem.WriteAllText("aux", "Hello World!", False)
    Catch ex As Exception
        'do nothing or inform the user
    End Try 
```

# python - 在实践中可以使用“TreeDict”（或 Treemap）做什么？

> ID：1014247
> 
> 赞同：2
> 
> 时间：2009-06-18T17:59:25.447
> 
> 标签：python, collections, dictionary, treemap, uses

我正在用 Python 开发一个“TreeDict”类。这基本上是一个 dict，它允许您按排序顺序检索其键值对，就像 Java 中的 Treemap 集合类一样。

我已经根据关系数据库中唯一索引的使用方式实现了一些功能，例如，让您检索与一系列键对应的值的函数，按排序顺序大于、小于或等于特定值的键、字符串或按排序顺序具有特定前缀的元组等。

不幸的是，我想不出任何需要这样的课程的现实生活问题。我怀疑我们没有在 Python 中对 dicts 进行排序的原因是，在实践中，它们并不经常被要求值得，但我想被证明是错误的。

你能想到“TreeDict”的任何具体应用吗？这种数据结构能最好地解决任何现实生活中的问题吗？我只想确定这是否值得。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-19T00:38:22.863

我已经看到几个答案指向“按顺序排列”功能，这确实很重要，但没有一个突出另一个大功能，即“使用键 >= 这个查找第一个条目”。即使没有真正需要从那里“走”，这也有很多用途。

例如（这出现在最近的 SO 答案中），假设您想生成具有给定相对频率的伪随机值 - 即，给您一个 dict `d`：

```
{'wolf': 42, 'sheep': 15, 'dog': 23, 'goat': 15, 'cat': 5} 
```

并且需要一种方法来生成 'wolf' 的概率为 42 out of 100（因为 100 是给定的相对频率的总和），'sheep' 15 out of 100，等等；并且不同值的数量可能非常大，相对频率也是如此。

然后，将给定值（以任何顺序）存储为树形图中的值，对应的键是该点的“总累积频率”。IE：

```
def preprocess(d):
    tot = 0
    for v in d:
        tot += d[v]
        treemap.insert(key=tot, value=v)
    return tot, treemap 
```

现在，生成一个值可以非常快（`O(log(len(d)))`），如下所示：

```
def generate(tot, treemap, r=random):
    n = r.randrange(tot)
    return treemap.firstGTkey(n).value 
```

where`firstGTKey`是一个方法，它返回第一个条目（在这个假设的例子中，带有`.key`和属性），键 > 给定参数。`.value`例如，我已经将这种方法用于存储为 B 树的大文件（使用 eg`bsddb.bt_open`和`set_location`方法）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-18T18:08:03.890

保持元素排序的原因是为了更快地检索。假设我希望字典中的所有值都在排序范围内。使用 TreeDict 比使用常规哈希图要快得多。它基本上允许您按排序顺序保存字典中的所有内容。我知道在我目前正在使用的应用程序中使用这样的类来基本上查询数据结构。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-18T19:04:30.053

当您需要按键的顺序浏览字典时，它很有用；有时会出现。实际上，我发现它在某些编程竞赛中比其他任何东西（想想 ACM 等）都更为普遍。

TreeMap 最有用的功能是当您想快速找到最小或最大键时；使用排序字典，这通常是一个方法调用；并且在算法上可以在 O(log(n)) 时间内完成，而不是在集合未排序的情况下遍历每个键以寻找最小值/最大值。基本上，一个更友好的界面。

我遇到的最常见的情况之一是当对象由特定名称标识时，您想打印出根据名称排序的对象；说从目录名称到目录中文件数的映射。

我使用它的另一个地方是在一个 excel 电子表格包装器中。从行号到行对象的映射。这使您可以快速找到最后一行索引，而无需遍历每一行。

此外，当您可以轻松定义键上的比较关系时，它也很有用，但不一定是散列函数，如 HashMaps 所需要的。我能想到的最好（虽然很弱）的例子是不区分大小写的字符串键。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-18T18:06:45.560

我经常`Dict<DateTime, someClassOrValue>`在处理工业过程数据时使用——阀门打开/关闭、机械启动/停止等。

当我需要在相当长的时间内比较启动/停止或打开/关闭事件之间的时间间隔时，对键进行排序特别有用。

但是，由于我已经能够在 C# 中使用 linq，我发现使用 IEnumerables 并使用 IQueryable 扩展方法来获取我需要的信息通常更容易。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-18T18:31:13.570

几乎所有“GROUP BY”报告都需要排序字典。

```
summary = sortedDefaultDict()
for row in somePileOfData:
    summary[row.group_by] += row.balance
for k in sorted(summary.keys()):
    print k, summary[k] 
```

这在数据仓库应用程序中经常发生，很难表达这是多么重要。

如果`sorted`函数调用不起作用，从长远来看，它会节省大量时间。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-04-10T11:17:33.807

你看到了吗：[http](http://code.activestate.com/recipes/576998/) ://code.activestate.com/recipes/576998/ ？

作

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-18T18:08:11.533

它们可以使各种算法更容易实现。

# java - 如何使用 ICEFaces 导航并传递参数

> ID：1014248
> 
> 赞同：0
> 
> 时间：2009-06-18T17:59:50.080
> 
> 标签：java, jsf, icefaces

我正在使用 JSF/ICEFaces。我有一个包含许多行的表格，我有另一个显示图表的页面。我想在每一行都有一个图标来绘制该特定组合的图表。我知道通过返回字符串导航规则来使用 JSF 进行常规导航。但是，我不确定如何将参数从与该行对应的 bean 传递给绘制图表的 bean。你知道我可以解决这个问题吗？

谢谢，

谭

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-22T19:16:06.110

所以你有一个带有东西表的页面 A 和带有单个东西图表的页面 B。流程是：导航到页面 A -> 浏览表格 -> 单击页面 A 上的某些内容以查看图表 -> 导航到页面 B -> 阅读图表。

您可以在这里做几件不同的事情。我会推荐三个。

*一，*您可以使图表页面 RESTful 并传入您要绘制图表的内容的 ID。IE，您页面上的列将具有：

> `<ice:outputLink value="/chartPage?stuffID=#{iterator.stuffID}">Review Chart</ice:outputLink>`

然后在图表页面的支持 bean 中，您可以使用 JAX-RS 传入页面参数，也可以疏通请求对象，即：

> (`FacesContext.getCurrentInstance().getExternalContext().getRequestParameterMap().get("stuffID)`

您可以使用它来获取 StuffID 并构建图表。这实现了良好的关注点分离，让您的图表页面只做图表，而不必担心它将从哪些 bean 中获取图表。这是*我*个人会这样做的方式。

*第二，*您可以简单地使您的 bean 会话范围（或者，如果您使用 Seam 或类似的，会话范围），以便两个页面简单地共享一个 bean。这可能是最简单的，但您需要确保在不再需要 bean 时清理它，因此有点危险。

*第三，*您可以使用常规 HTTP 表单并 POST 到图表页面，使用与第一个相同类型的 RequestParameterMap 疏浚。这与第一个的工作方式相同，但并不像您想要执行此操作的任何地方都需要类似的表单那样干净，并且它不能是普通的超链接。

这三个将完成你所需要的，但我的建议还是第一。能够仅使用常规超链接链接到图表页面可能会非常方便。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-10T13:53:30.120

以及如何传递对象而不是字符串？

# sql - 帮助处理 SQL 中的相关查询

> ID：1014255
> 
> 赞同：1
> 
> 时间：2009-06-18T18:01:25.600
> 
> 标签：sql, subquery, sas, proc-sql

请帮忙！！我是 SQL 编程的新手，并且正在自学一切。我终于遇到了一个我似乎无法解决的问题。希望有人可以提供帮助。我有以下表格。我需要做的是在 FROISEDI 中使用 RECDATE 并计算 WEI4CPP 之前并包括该日期的所有不同日期（I4C7DZ）。我使用了下面的代码，它似乎可以工作，直到我有一条具有相同 CACLAIM 值的记录。我也有两条记录具有相同 CACLAIM 和 DOI 的实例，因此我的代码也不起作用。不知何故，我需要使用 FROISEDI 的 AGCLAIM，但我不知道如何将其拉入我的计数表。哦，我使用的是 SAS，所以它不完全是 SQL，但非常接近。谢谢你的帮助！

* * *

```
TABLE: FROISEDI
AGCLAIM    RECDATE   CACLAIM     DOI
09073589   1/29/09   09 41615    1/28/09  
09115390   3/01/09   00012HR09   2/23/09  
09234567   4/20/09   003140010   1/2/09  
09154826   5/01/09   003140010   4/28/09  

TABLE: WEI4CPP  
 I4C7DZ     I4X6TX      I4YWTX    I4YFTX  
1/28/09               1/28/09    09 41615  
1/29/09   09073589    1/28/09    09 41615  
1/30/09   09073589    1/28/09    09 41615  
2/24/09               2/23/09    00012HR09  
2/28/09               2/23/09    00012HR09    
3/01/09   09115390    2/23/09    00012HR09  
3/15/09   09115390    2/23/09    00012HR09  
1/15/09               1/02/09    003140010  
1/20/09               1/02/09    003140010  
2/08/09               1/02/09    003140010  
3/19/09               1/02/09    003140010  
4/20/09   09234567    1/02/09    003140010  
5/01/09   09154826    4/28/09    003140010  

TABLE I NEED TO PRODUCE: COUNTS  
AGCLAIM     CACLAIM   DOI      SUBMITS  
09073589    09 41615     1/28/09    2  
09115390    00012HR09    2/23/09    3  
09234567    003140010    1/02/09    5  
09154826    003140010    4/28/09    1 
```

* * *

我用过的代码：

```
PROC SQL;
CREATE TABLE COUNTS AS
SELECT I4YWTX AS DOI3,
I4YFTX AS CLMNUM2,
COUNT(DISTINCT I4C7DZ) AS SUBMITS
FROM WAREHOUS.WEI4CPP A
WHERE I4C7DZ<=(SELECT RECDATE
         FROM FROISEDI 
         WHERE FROISEDI.CACLAIM=A.I4YFTX
         AND FROISEDI.DOI=A.I4YWTX) 
GROUP BY WEI4CPP.I4YFTX, WEI4CPP.I4YWTX;
QUIT; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T19:27:02.693

没有测试它。尝试这个

```
SELECT 
    AGCLAIM, 
    CACLAIM,     
    DOI, T.cnt + 1 AS SUBMITS
FROM 
    FROISEDI 
    INNER JOIN 
    (
    SELECT 
        COUNT(*) cnt,
        I4YFTX ,
            I4YWTX     
    FROM 
        WEI4CPP   
    WHERE 
        ISNULL(I4X6TX,0) = 0 
    GROUP BY 
        I4YFTX, I4YWTX    
    ) T 
    ON FROISEDI.CACLAIM = T.I4YFTX 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-23T19:28:05.197

看起来 WEI4CPP.I4YFTX 是 FROIISEDI.CACLAIM 链接值，而 WEI4CPP.I4YWTX 是 FROIISEDI.DOI。就这么简单吗？

```
SELECT fr.AGCLAIM, fr.CACLAIM, fr.DOI, COUNT(we.I4C7DZ) as SUBMITS
FROM    FROISEDI fr
        INNER JOIN WEI4CPP we
            ON we.I4YFTX = fr.CACLAIM
            AND     we.I4YWTX = fr.DOI
            AND     ISNULL(we.I4X6TX, fr.AGCLAIM) = fr.AGCLAIM
WHERE   we.I4C7DZ <= fr.RECDATE
GROUP BY fr.AGCLAIM, fr.CACLAIM, fr.DOI 
```

请注意，如果行具有相同的 DOI 和 CACLAIM，但 WEI4CPP.I4X6TX 列为空，则会出现问题。在这种情况下，我不知道您关于解决它们属于哪个 AGCLAIM 的业务规则。如果它们已填写并且不匹配，我可以拒绝它们，但我需要某种与日期相关的信息或其他信息来匹配它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T13:01:00.850

我没有详细介绍您的逻辑，但请确保两个日期都存储为数值。我不止一次看到将日期存储为字符，因此 GT 和 LT 不会按照您的想法工作。

# c# - .NET 中 ArgumentException.Message 的本地化

> ID：1014257
> 
> 赞同：3
> 
> 时间：2009-06-18T18:01:38.643
> 
> 标签：c#, localization

在我的可本地化应用程序中，我抛出这样的 ArgumentException：

```
throw ArgumentException("LocalizedParamName", "LocalizedErrorMessage"); 
```

我像这样抓住它：

```
catch (Exception ex)
{
    Display(ex.Message);
} 
```

我收到的错误消息如下：

LocalizedErrorMessage 参数名称：LocalizedParamName

这里的问题是“参数名称：”，它是英文而不是我的应用程序的语言。我认为该字符串是 .NET 框架的语言。谁能证实这一点？

一种解决方法是这样做：

```
catch (ArgumentException ex)
{
    Display((ex as Exception).Message  + "\n" + "Translated(Parameter name:)"+ ex.ParamName);
}
catch (Exception ex)
{
    Display(ex.Message);
} 
```

还有其他更优雅的方式吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-18T18:24:47.433

您正在使用非空参数名称调用构造函数 ArgumentException(string message, string paramName)。

当你这样做时，你会得到你看到的结果，即你的消息后跟“参数名称：yourParamName”。

文本“参数名称：”来自 .NET Framework 资源：您没有获得本地化版本的原因可能是您没有在您的计算机上安装相关的 .NET Framework 语言包。[您可以在此处](http://www.microsoft.com/Downloads/details.aspx?familyid=39C8B63B-F64B-4B68-A774-B64ED0C32AE7&displaylang=en)下载语言包。

如果您为您正在使用的语言安装语言包，您将获得您期望的结果。

或者，您可以使用构造函数 ArgumentException(string message)，并构建您自己的消息，包括参数的名称。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-18T18:08:23.750

异常中的消息应该是给开发者的，而不是给最终用户的。您应该始终尝试以可以显示有意义的错误消息的方式捕获异常。（不，“程序遇到意外错误，现在将退出”没有意义。）您不应该向最终用户显示异常消息的原因是因为用户不关心开发人员通过了从函数`Foo()`到函数的错误参数`Bar()`，更不用说它是如何错误的了。但是当你开始修复这个错误时，你需要知道这一点。

所以，不要担心你的异常消息国际化，但要国际化你的消息给用户，告诉他们发生了什么，你正在做什么来修复它，希望他们将来如何避免这个问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-18T18:10:37.257

现在得到问题 - 尝试更改 CurrentCulture- [Thread.CurrentThread.CurrentCulture](http://msdn.microsoft.com/en-us/library/system.threading.thread.currentculture.aspx)。您将看到消息的适当部分已本地化 - 如果您想查看它是如何工作的，请在反射器中打开该类。

您可以[在此处阅读有关 CurrentCulture 的更多信息](http://en.csharp-online.net/Localization_Like_the_Pros%E2%80%94CurrentCulture_and_CurrentUICulture)。

# php - WordPress - 生成按标签和类别过滤的帖子列表

> ID：1014269
> 
> 赞同：7
> 
> 时间：2009-06-18T18:04:49.260
> 
> 标签：php, mysql, wordpress, tags

我正在尝试制作一个页面上有六个列表的 WordPress 网站，每个列表显示来自不同类别的帖子。简单的。

但是，如果用户选择一个标签，将他们带到该标签存档页面，我希望他们仍然看到六列表模板，但每个类别中的所有帖子也都被标签过滤。因此，帖子列表首先按标签过滤，然后按类别过滤。

据我所知，没有办法使用 query_posts 或任何东西来做到这一点，它需要更高级的数据库使用，但我不知道如何做到这一点！我认为这里有一个类似的问题，但是因为我对 PHP 知之甚少，也没有 MySQL，所以我无法理解答案！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-08-26T13:56:17.103

对了，我终于找到了一个相对简单的解决方案。

WordPress 中存在一个错误，阻止了对类别和标签的查询，因此`query_posts('cat=2&tag=bread');`无法正常工作，但解决此问题的方法很`query_posts('cat=2&tag=bread+tag=bread');`神奇。

在 tag.php 模板中，我希望它从该存档中获取标签，所以我必须这样做：

```
<?php query_posts('cat=12&tag='.$_GET['tag'].'+'.$_GET['tag']); ?> 
```

效果很好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T08:44:28.433

试试这个代码：

```
query_posts('tag=selected_tag');

while (have_posts()) : the_post();

    foreach((get_the_category()) as $category)
        { 

        if ($category->cat_name == 'selected_category')
            {
            // output any needed post info, for example:
            echo the_title();
            }

        }

endwhile; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T21:14:07.563

根据[Wordpress API](http://codex.wordpress.org/Template_Tags/query_posts#Tag_Parameters)，您可以通过调用中的标签进行过滤`query_posts`。

例子：

```
query_posts('tag=cooking');

query_posts('tag=bread,baking');

query_posts('tag=bread+baking+recipe'); 
```

# unicode - Twitter 文本压缩挑战

> ID：1014271
> 
> 赞同：7
> 
> 时间：2009-06-18T18:05:40.680
> 
> 标签：unicode, twitter, compression, code-golf

### 规则

1.  你的程序必须有两种模式：**编码**和**解码**。
2.  **编码**时：

    1.  你的程序必须输入一些人类可读的`Latin1`文本，大概是英语。
        *   忽略标点符号也没关系。
        *   您只需要担心实际的英语单词，而不是 L337。
        *   任何重音字母都可以转换为简单的 ASCII。
        *   您可以选择处理数字的方式。
        *   123
            *   一二三
            *   一百二十三
            *   123
            *   1 2 3
        *   一百二十三
            *   一二三
            *   一百二十三
            *   123
            *   1 2 3
    2.  您的程序必须输出一条可以表示为的消息

        *   范围内的 140 个代码点`U+0000`–<code>U+10FFFF

            排除非字符：

            *   `U+FFFE`
            *   `U+FFFF`
            *   `U+`*`n`*`FFFE`,其中–<code>10 十六进制`U+`*`n`*`FFFF`*`n`*`1`
            *   `U+FDD0`–<code>U+FDEF
            *   `U+D800`–<code>U+DFFF（代理代码点）。

    它可以以您选择的任何合理编码输出；[GNU`iconv`](http://www.gnu.org/software/libiconv/)支持的任何编码都将被认为是合理的，您的平台本机编码或语言环境编码可能是一个不错的选择。

3.  **解码**时：

    1.  您的程序应将**编码**模式的输出作为输入。
    2.  文本输出应该是输入文本的近似值。
        *   越接近原文越好。
        *   不需要任何标点符号。
    3.  输出文本应该是人类可读的，同样可能是英语。

        *   可以是 L337，也可以是大声笑。
    4.  除了上面指定的输出之外，解码过程可能无法访问编码过程的任何其他输出；也就是说，您不能将文本上传到某处并输出 URL 以供解码过程下载，或者任何类似的愚蠢行为。
4.  为了用户界面的一致性，您的程序必须表现如下：
    1.  您的程序必须是可以在具有适当解释器的平台上设置为可执行的脚本，或者是可以编译为可执行文件的程序。
    2.  您的程序必须将`encode`或`decode`设置模式作为其第一个参数。
    3.  您的程序必须至少以下列方式之一接受输入：
        *   从标准输入获取输入并在标准输出上产生输出。
            *   `my-program encode <input.txt >output.utf`
            *   `my-program decode <output.utf >output.txt`
        *   从第二个参数命名的文件中获取输入，并在第三个参数命名的文件中产生输出。
            *   `my-program encode input.txt output.utf`
            *   `my-program decode output.utf output.txt`
5.  对于您的解决方案，请发布：
    1.  您的完整代码和/或在其他地方托管的指向它的链接（如果它很长，或者需要很多文件来编译，或其他）。
    2.  如果代码不是很明显，或者代码很长并且人们会对摘要感兴趣，则说明它是如何工作的。
    3.  示例文本，包含原始文本、压缩后的文本和解码的文本。
    4.  如果您正在建立其他人的想法，请归因于他们。尝试对别人的想法进行提炼是可以的，但你**必须**归因于他们。

这些规则是[**Twitter 图像编码挑战**](https://stackoverflow.com/questions/891643/twitter-image-encoding-challenge)规则的变体。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-22T14:53:23.867

不确定我是否有时间/精力来跟进实际代码，但这是我的想法：

*   任何特定长度下的任意 LATIN 1 字符串都可以简单地编码（甚至不*压缩*），而不会丢失 140 个字符。天真的估计是 280 个字符，尽管由于竞赛规则中的代码点限制，它可能比这短一点。
*   稍长于上述长度的字符串（假设在 280 到 500 个字符之间）很可能使用标准压缩技术收缩成足够短的字符串以允许上述编码。

任何比这更长的时间，我们就会开始丢失文本中的信息。因此，执行以下步骤的最小数量，以将字符串减少到可以使用上述方法压缩/编码的长度。*此外，如果仅在子字符串*上执行这些替换会使它足够短（我可能会向后遍历字符串），请不要在*整个*字符串上执行这些替换。

 *1.  将 127 以上的所有 LATIN 1 字符（主要是重音字母和时髦符号）替换为在非重音字母字符中最接近的等价物，或者可能使用通用符号替换，如“#”
2.  用等效的小写形式替换所有大写字母
3.  用空格替换所有非字母数字（任何剩余的符号或标点符号）
4.  用 0 替换所有数字

好的，所以现在我们已经消除了尽可能多的多余字符。现在我们要做一些更显着的减少：

5.  将所有双字母（气球）替换为单个字母（巴隆）。看起来很奇怪，但仍然希望读者能够理解。
6.  用较短的等价物替换其他常见的字母组合（CK 与 K，WR 与 R 等）

好的，这就是我们所能做到的，让文本*可读*。除此之外，让我们看看我们是否可以想出一种方法，使文本*与*原始文本相似，即使它最终无法*辨认*（再次，从字符串末尾一次执行一个字符，并在它足够短）：

7.  将所有元音 (aeiouy) 替换为
8.  将所有“高”字母 (bdfhklt) 替换为 l
9.  将所有“短”字母 (cmnrsvwxz) 替换为 n
10.  将所有“悬挂”字母 (gjpq) 替换为 p

这应该给我们留下一个由 5 个可能值（a、l、n、p 和空格）组成的字符串，这应该允许我们编码相当长的字符串。

除此之外，我们只需要截断。

我能想到的唯一其他技术是对常用单词或字母组进行基于字典的编码。这可能会给我们一些正确句子的好处，但可能不会为任意字符串带来好处。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-25T16:51:32.017

这是我实际英语的变体。

每个代码点都有 1100000 种可能的状态。嗯，这是很大的空间。

因此，我们提取所有原始文本并从中获取 Wordnet 同义词集。数字被转换成英文名称（“四十二”）。1,1M 个状态将允许我们保存同义词集 ID（可以在 0 到 82114 之间）、同义词集内的位置（我想大约 10 个变体）和同义词集类型（这是四种之一 - 名词、动词、形容词、副词） . 我们甚至可能有足够的空间来存储单词的原始形式（如动词时态 id）。

解码器只是将同义词提供给 Wordnet 并检索相应的单词。

源文本：

```
A white dwarf is a small star composed mostly of electron-degenerate matter. Because a
white dwarf's mass is comparable to that of the Sun and its volume is comparable to that 
of the Earth, it is very dense. 
```

变成：

```
A white dwarf be small star composed mostly electron degenerate matter because white
dwarf mass be comparable sun IT volume be comparable earth IT be very dense 
```

（使用[在线 Wordnet](http://wordnetweb.princeton.edu/perl/webwn "在线Wordnet")测试）。此“代码”应占用 27 个代码点。当然，所有像“lol”和“L33T”这样的“胡言乱语”都将永远消失。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-22T17:06:45.700

# 这是一个简单的例子，它接受一个输入文件并删除任何非单词字符。

```
#! perl
use strict;
use warnings;
use 5.010;

use Getopt::Long;
use Pod::Usage;
use autodie;

my %opts = (
  infile  => '-',
  outfile => '-',
);
GetOptions (
  'encode|e'    => \$opts{encode},
  'decode|d'    => \$opts{decode},
  'infile|i=s'  => \$opts{infile},
  'outfile|o=s' => \$opts{outfile},
  'help|h'      => \&help,
  'man|m'       => \&man,
);

unless(
  # exactly one of these should be set
  $opts{encode} xor $opts{decode}
){
  help();
}

{
  my $infile;
  if( $opts{infile} ~~ ['-', '&0'] ){
    $infile = *STDIN{IO};
  }else{
    open $infile, '<', $opts{infile};
  }

  my $outfile;
  if( $opts{outfile} ~~ ['-', '&1'] ){
    $outfile = *STDOUT{IO};
  }elsif( $opts{outfile} ~~ '&2' ){
    $outfile = *STDERR{IO};
  }else{
    open $outfile, '>', $opts{outfile};
  }

  if( $opts{decode} ){
    while( my $line = <$infile> ){
      chomp $line;

      say {$outfile} $line;
    }
  }elsif( $opts{encode} ){
    while( my $line = <$infile> ){
      chomp $line;

      $line =~ s/[\W_]+/ /g;

      say {$outfile} $line;
    }
  }else{
    die 'How did I get here?';
  }
}

sub help{
  pod2usage();
}
sub man{
  pod2usage(1);
}
__END__

=head1 NAME

sample.pl - Using GetOpt::Long and Pod::Usage

=head1 SYNOPSIS

sample.pl [options] [file ...]

 Options:
   --help     -h      brief help message
   --man      -m      full documentation
   --encode   -e      encode text
   --decode   -d      decode text
   --infile   -i      input  filename
   --outfile  -o      output filename

=head1 OPTIONS

=over 8

=item B<--help>

Print a brief help message and exits.

=item B<--man>

Prints the manual page and exits.

=item B<--encode>

Removes any character other than /\w/.

=item B<--decode>

Just reads from one file, and writes to the other.

=item B<--infile>

Input filename. If this is '-' or '&0', then read from STDIN instead.
If you use '&0', you must pass it in with quotes.

=item B<--outfile>

Output filename. If this is '-' or '&1', then write to STDOUT instead.
If this is '&2', then write to STDERR instead.
If you use '&1' or '&2', you must pass it in with quotes.

=back

=head1 DESCRIPTION

B<This program> will read the given input file(s) and do something
useful with the contents thereof.

=cut 
```

```
echo 你好，这是一些文字 | perl 示例.pl -e
你好这是一些文字

```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-20T18:34:57.043

PAQ8O10T << FTW*

# c - 如何将 sqlite3_int64 转换为 long？

> ID：1014279
> 
> 赞同：1
> 
> 时间：2009-06-18T18:07:20.413
> 
> 标签：c, sqlite

我正在使用 C api 从 sqlite3 数据库中读取数据。sqlite3_column_int64 返回一个 sqlite3_int64 对象。如何将其转换为长？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-07T14:39:47.243

您应该使用 stdint.h 中定义的标准整数类型。然后您可以使用 int64_t 并知道在每个平台上它将是 64 位宽。

然后，您只需将 sqlite3_int64 转换为 int64_t 就可以了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T18:16:53.593

C 中的 long 通常是 32 位，而您正在查看来自 sqlite 的 64 位整数。只要你使用C语言，你就可以使用long long类型。

您可以参考以下内容：

[http://home.att.net/~jackklein/c/inttypes.html#long_long](http://home.att.net/~jackklein/c/inttypes.html#long_long)

我会尝试将 sqlite3_int64 取消引用为 long long int 并通过执行 sizeof(long long) 来查看它是否有效

编辑：我找到了 sqlite_int64 的 typedef，您也可以将其作为参考：

[http://www.sqlite.org/c3ref/int64.html](http://www.sqlite.org/c3ref/int64.html)

# regex - 正则表达式匹配 2 位数字，可选十进制，两位数字

> ID：1014284
> 
> 赞同：46
> 
> 时间：2009-06-18T18:08:18.337
> 
> 标签：regex

我已经花了半个小时试图得到这个，也许有人可以快速想出它。

我需要一个匹配一位或两位数字的正则表达式，后跟一个可选的小数点，然后是一位或两位数字。

例如，它应该完全匹配这些字符串：

> 3
> 33
> .3
> .33
> 33.3
> 33.33

并且不匹配小数点之前或之后超过 2 位的任何内容。

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2009-06-18T18:13:33.473

*编辑：更改以适应其他反馈。*

我理解你的意思是，如果没有小数点，那么就不应该再有两位数。所以应该是这样的：

```
\d{0,2}(\.\d{1,2})? 
```

在大多数实现中，这应该可以解决问题。如果没有，您可以使用：

```
[0-9]?[0-9]?(\.[0-9][0-9]?)? 
```

这应该适用于我见过的每一个实现。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-18T18:32:27.750

```
(?<![\d.])(\d{1,2}|\d{0,2}\.\d{1,2})?(?![\d.]) 
```

火柴：

*   你的例子
*   33.

不匹配：

*   333.33
*   33.333

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-06-18T18:23:10.400

为了以 Lee 的答案为基础，您需要锚定表达式以满足小数点前不超过 2 个数字的要求。

如果每个数字都是一个单独的字符串，您可以使用[字符串锚点](http://www.regular-expressions.info/anchors.html)：

```
^\d{0,2}(\.\d{1,2})?$ 
```

如果每个数字都在一个字符串中，您可以使用[单词 anchors](http://www.regular-expressions.info/wordboundaries.html)：

```
\b\d{0,2}(\.\d{1,2})?\b 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-06-18T18:10:17.740

您提到您希望正则表达式匹配每个字符串，但您之前提到小数点前有 1-2 位数字？

这将匹配 1-2 位数字，后跟一个可能的小数，然后是另一个 1-2 位数字，但在您的 .33 示例中失败

```
\d{1,2}\.?\d{1,2} 
```

这将匹配 0-2 位数字，后跟一个可能的十进制，然后是另一个 1-2 位数字，并匹配您的 .33 示例

```
\d{0,2}\.?\d{1,2} 
```

不确定您要寻找的是哪一个。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2019-06-25T18:06:34.617

您可以使用

让 regex = new RegExp( `^(?=[0-9.]{1,${maxlength}}$)[0-9]+(?:\.[0-9]{0,${decimal_number}})?$` );

您可以在其中决定最大长度以及要控制值的小数点

使用 ES6 字符串插值来包装变量 ${maxlength} 和 ${decimal_number}。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-18T19:44:29.697

```
^(\d{0,2}\\.)?\d{1,2}$ 
```

`\d{1,2}$`匹配后面没有任何内容的 1-2 位数字（`3`、`33`等），`(\d{0,2}\.)?`可选匹配长度为 0-2 位的数字后跟句点（`3.`、`44.`、`.`等）。把它们放在一起，你就得到了你的正则表达式。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-18T18:18:24.137

```
^\d{0,2}\.?\d{1,2}$ 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-18T19:52:48.727

以前的答案大多是正确的，但它也会匹配空字符串。以下将解决此问题。

```
^([0-9]?[0-9](\.[0-9][0-9]?)?)|([0-9]?[0-9]?(\.[0-9][0-9]?))$ 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-06-07T12:33:11.273

试试这个

```
\d{1,2}\.?(\.\d{1,2})? 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-11-06T05:52:33.973

以下是两位数和两位小数的非常好的正则表达式。

```
[RegularExpression(@"\d{0,2}(\.\d{1,2})?", ErrorMessage = "{0} must be a Decimal Number.")] 
```

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2020-04-18T01:55:26.717

更正的答案

```
\d{1,}(\.\d{1,2}) 
```

在[https://regexr.com/中测试](https://regexr.com/)

匹配有 2 位小数或只有 1 位小数的数字，或没有小数位的数字。

您可以通过更改数字 2 来更改所需的数字或小数

# java - 有没有办法让 PrintWriter 输出为 UNIX 格式？

> ID：1014287
> 
> 赞同：11
> 
> 时间：2009-06-18T18:08:29.723
> 
> 标签：java, unix

当然，在 Java 中。我正在编写一个程序并在 Windows 环境下运行它，但我需要以 Unix 格式完成输出（.csv）。有什么简单的解决办法吗？谢谢！

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-02-07T10:36:27.460

要编写带有 unix 行结尾的文件，请在派生自 PrintWriter 的类中覆盖 println，并将 print 与 \n 一起使用。

```
PrintWriter out = new PrintWriter("testFile") {
    @Override
    public void println() {
        write('\n');
    }
};
out.println("This file will always have unix line endings");
out.println(41);
out.close(); 
```

这避免了必须触及代码中任何现有的 println 调用。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-06-18T18:12:43.350

**注意：正如评论中所报告的，下面给出的方法在 JDK 9+ 中中断。使用 James H. 的回答中的方法。**

* * *

“Unix 格式”是指使用“\n”作为行终止符而不是“\r\n”吗？只需`line.separator`在创建 PrintWriter 之前设置系统属性。

就像一个演示：

```
import java.io.*;

public class Test
{
    public static void main(String[] args)
        throws Exception // Just for simplicity
    {
        System.setProperty("line.separator", "xxx");
        PrintWriter pw = new PrintWriter(System.out);
        pw.println("foo");
        pw.println("bar");
        pw.flush();
    }
} 
```

当然，这为整个 JVM 设置了它，这并不理想，但它可能恰好是您所需要的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-18T18:12:54.007

假设您提到的格式问题是 Windows 换行符是回车换行符（`"\r\n"`），而 Unix换行符只是换行符（ `"\n"`），确保文件使用 LF 而不是 CRLF 的最简单方法是避免使用，`println`而是使用`print("\n")`终止行。

所以而不是：

```
writer.println("foo,bar,88"); 
```

采用

```
writer.print("foo,bar,88\n"); 
```

您可以只搜索相关文件`println`以确保您全部捕获。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-05-04T08:19:17.290

我看到另外 2 个选项不会影响整个系统或导致并发问题，例如设置`lineSeparator`. 我还将声明一个表示行尾的枚举。

```
 enum LineEnding {
  UNIX("\n"), DOS("\r\n");

  private String lineSeparator;

  LineEnding(String lineSeparator) {
    this.lineSeparator = lineSeparator;
  }

  public String getLineSeparator() {
    return lineSeparator;
  }
} 
```

1.  **设置`lineSeperator`使用反射。**

    您应该创建一个使用反射封装访问的工厂，以向客户端隐藏 PrintWriter 内部。例如，客户端代码应如下所示：

    ```
    PrintWriterFactory.newPrintWriter(someWriter, LineEnding.UNIX); 
    ```

    虽然实现可能如下所示：

    ```
    public class PrintWriterFactory {

      private static final Field lineSeparatorField;

      static {
        try {
          lineSeparatorField = PrintWriter.class.getDeclaredField("lineSeparator");
          lineSeparatorField.setAccessible(true);
        } catch (NoSuchFieldException e) {
          throw new IllegalStateException("java.io.PrintWriter implementation changed. Unable to determine lineSeparator field.", e);
        }
      }

      public static PrintWriter newPrintWriter(Writer writer, LineEnding lineEnding) {
        PrintWriter printWriter = new PrintWriter(writer);

        try {
          lineSeparatorField.set(printWriter, lineEnding.getLineSeparator());
        } catch (IllegalAccessException e) {
          throw new IllegalStateException("Can't set line ending", e);
        }

        return printWriter;
      }
    } 
    ```

    PS：工厂不能是静态的。`PrintWriter`如果实现从一个 JDK 更改为另一个，您可以使用一个接口和多个实现，因此您必须使用另一种反射策略。

2.  **扩展 PrintWriter 并覆盖该 `println()`方法**

    ```
    public class LineEndingPrintWriter extends PrintWriter {

      protected boolean autoFlush = false;
      private LineEnding lineEnding;

      public LineEndingPrintWriter(Writer out, LineEnding lineEnding) {
        this(out, false, lineEnding);
      }

      public LineEndingPrintWriter(Writer out, boolean autoFlush, LineEnding lineEnding) {
        super(out, autoFlush);
        this.autoFlush = autoFlush;
        this.lineEnding = lineEnding;
      }

      public LineEndingPrintWriter(OutputStream out, LineEnding lineEnding) {
        this(out, false, lineEnding);
      }

      public LineEndingPrintWriter(OutputStream out, boolean autoFlush, LineEnding lineEnding) {
        super(out, autoFlush);
        this.autoFlush = autoFlush;
        this.lineEnding = lineEnding;
      }

      protected void ensureOpen() throws IOException {
        if (out == null)
          throw new IOException("Stream closed");
      }

      public void println() {
        // Method body taken from java.io.PrintWriter.println();
        try {
          synchronized (lock) {
            ensureOpen();

            out.write(lineEnding.getLineSeparator());

            if (autoFlush) {
              out.flush();
            }
          }
        } catch (InterruptedIOException e) {
          Thread.currentThread().interrupt();
        } catch (IOException e) {
          setError();
        }
      }
    } 
    ```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-10-13T12:57:36.537

偏执的程序员会在系统属性对象上进行同步，至少如果不同的 Printwriters 需要不同类型的行终止符。

```
public static PrintWriter createPrintWriter(OutputStreamWriter out, boolean autoflush){
    Properties props = System.getProperties();
    synchronized (props) {
        Object old = null;
        try {
        old = props.setProperty("line.separator", "\n");
        return  new PrintWriter(out, autoflush);
        } finally {
            if( old != null ) {
                props.put("line.separator", old);
            }
        }
    }
} 
```

# c# - 在 C# 中连接整数

> ID：1014292
> 
> 赞同：41
> 
> 时间：2009-06-18T18:11:11.107
> 
> 标签：c#

有没有一种*廉价*的方法可以在 csharp 中连接整数？

示例：1039 & 7056 = 10397056

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2009-06-18T18:13:53.957

如果您发现这种情况足够昂贵而引起任何担忧，我会印象深刻：

```
int a = 1039;
int b = 7056;

int newNumber = int.Parse(a.ToString() + b.ToString()) 
```

或者，如果您希望它更像“.NET-ish”：

```
int newNumber = Convert.ToInt32(string.Format("{0}{1}", a, b)); 
```

int.Parse*不是*一项昂贵的操作。花时间担心网络 I/O 和 O^N 正则表达式。

其他注意事项：实例化 StringBuilder 的开销意味着如果你只做一些连接是没有意义的。并且非常重要 - 如果您*打算*将其转回整数，请记住它限制为 ~2,000,000,000。连接数字很快就会变得非常大，并且可能远远超出 32 位 int 的容量。（当然签名）。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2014-11-10T21:43:16.257

我在聚会上有点晚了，但最近我不得不连接整数。使用 0 < a,b < 10^9 可以很快完成。

```
static ulong concat(uint a, uint b)
{
    if (b < 10U) return 10UL * a + b;
    if (b < 100U) return 100UL * a + b;
    if (b < 1000U) return 1000UL * a + b;
    if (b < 10000U) return 10000UL * a + b;
    if (b < 100000U) return 100000UL * a + b;
    if (b < 1000000U) return 1000000UL * a + b;
    if (b < 10000000U) return 10000000UL * a + b;
    if (b < 100000000U) return 100000000UL * a + b;
    return 1000000000UL * a + b;
} 
```

编辑：下面的版本可能很有趣（平台目标：x64）。

```
static ulong concat(ulong a, uint b)
{
    const uint c0 = 10, c1 = 100, c2 = 1000, c3 = 10000, c4 = 100000,
        c5 = 1000000, c6 = 10000000, c7 = 100000000, c8 = 1000000000;
    a *= b < c0 ? c0 : b < c1 ? c1 : b < c2 ? c2 : b < c3 ? c3 :
         b < c4 ? c4 : b < c5 ? c5 : b < c6 ? c6 : b < c7 ? c7 : c8;
    return a + b;
} 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-06-18T18:35:44.080

我不认为你能得到比这更简单的了：

```
static uint Concat (uint a, uint b)
{
  uint
    pow = 1;

  while (pow < b)
  {
    pow = ((pow << 2) + pow) << 1;
    a = ((a << 2) + a) << 1;
  }

  return a + b;
} 
```

它没有内存分配、字符串转换或乘法；或许：

```
static uint Concat (uint a, uint b)
{
  uint
    pow = 1;

  while (pow < b)
  {
    pow = ((pow << 2) + pow) << 1;
  }

  return a * pow + b;
} 
```

如果要连接两个二进制数：

```
static uint Concat (uint a, uint b)
{
  uint
    mask = uint.MaxValue;

  while ((mask & b) != 0)
  {
    mask <<= 1;
    a <<= 1;
  }

  return a | b;
} 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-06-18T18:14:36.423

1.  ```
    string ConcatInt(int x,int y){return String.Format("{0}{1}",x,y);} 
    ```

2.  ```
    int ConcatInt(int x,int y){
       return (x * Math.Pow(10, y.length)) + y;
    } 
    ```

编辑说明：修复了一些错误输入。还有更多类型问题。我只是给出答案的概要

第二种方法实际上应该是：

```
static int ConcatInt2(int x, int y) {
   return (int)(x * Math.Pow(10, y.ToString().Length)) + y;
} 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-06-18T18:18:37.740

便宜？字符串连接或格式化字符串可能会快得多。

否则，您可以执行以下操作：

```
Math.Pow(10,Math.Ceiling(Math.Log10(second)))*first+second 
```

提供第一个和第二个是整数。这是您不涉及转换为字符串并返回的唯一方法，**但我非常怀疑它会更快。**

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-06-18T18:19:43.747

如果你想将许多整数连接到一个字符串

```
StringBuilder sb = new StringBuilder(1039);
sb.Append(7056);
sb.Append(1234);
sb.Append(1235);
....
sb.Append(9999);
sb.ToString(); 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-06-18T18:16:41.427

如果我们想要整数结果，那么：

```
int result = int.Parse(input1.ToString() + input2.ToString()); 
```

对于字符串结果，请执行以下操作：

```
string result = input1.ToString() + input2.ToString(); 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-06-18T18:17:30.957

“数学”和“无字符串”方法如下：

```
 int a = 1039;
    int b = 7056;

    int bLen = (int)Math.Ceiling(Math.Log10(b));
    int ab = (a * ((int)Math.Pow(10, bLen))) + b; 
```

请注意，由于 Log10 调用，它可能仍然很慢。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-06-18T19:21:39.990

这个怎么样？

```
int c = b;
while(c > 0) {
   a *= 10;
   c /= 10;
}
a += b; 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-06-18T18:20:17.863

不是很便宜，但是：

```
string con = string.Format("{0}{1}",int1,int2); 
```

或者

```
string con = int1.ToString() + int2.ToString(); 
```

如果您在循环中使用它，我想我会使用选项 1，它在内部使用 StringBuilder。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-06-18T18:31:25.147

```
public int ConcatInts(int int1, int int2)
{
    return (int)(int1 * Math.Pow(10, int2.ToString().Length)) + int2;
} 
```

编辑：猜猜我不是第一个使用这个解决方案的人！

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-10-16T09:22:51.633

// 连接两个数字程序//

```
 Console.WriteLine("Enter a number for a");
        int a = int.Parse(Console.ReadLine());

        Console.WriteLine("Enter a number for b");
        int b = int.Parse(Console.ReadLine());

        int Concatenating = Convert.ToInt32(string.Format("{0}{1}", a, b));
        Console.WriteLine(Concatenating);
        Console.ReadKey(); 
```

# math - 投影 3D 网格的 2D 轮廓算法

> ID：1014293
> 
> 赞同：30
> 
> 时间：2009-06-18T18:11:37.910
> 
> 标签：math, 3d, geometry, projection

给定：一个由一组顶点和三角形定义的 3D 网格，这些点构成了网格。

问题：在任意平面上找到投影的任意旋转网格的 2d 轮廓。

投影很简单。挑战在于找到平面中投影三角形边缘的“外壳”。我需要一些有关研究此算法的输入/指针的帮助。为简单起见，我们可以假设 3D 边缘直接向下投影到 xy 平面上。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-18T23:27:17.780

*   从最右边的点开始（x坐标最大的点）
*   从此点获取所有边
*   沿着与正 x 轴角度最小的边，并将其添加到解决方案集中
*   从到达的点开始，跟随并将具有最小角度的边缘添加到您来自的边缘
*   重复直到到达原点

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-21T17:39:13.117

我只看到凸解决方案的答案，所以这是我的非凸解决方案。（意图是什么有点令人困惑。）

从二维三角形中取出所有边并将它们分组。如果两条边共享两个端点，则它们在同一个组中。所有只有一条边的组都是壳的一部分。

最后，您可以将壳边缘组合成一个环，方法是将它们连接在一起。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-04-20T05:13:46.363

补充一点：在投影中查找边缘的一种非常直观的方法是背面剔除！剔除和非剔除面之间的任何边缘都应该是轮廓。如果要隐藏内部边缘，只需使用 z 缓冲区。背面剔除只是投影后的顶点顺序，计算起来非常便宜。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-18T18:22:22.557

这个问题中提到的 alpha 形状技术处理一组顶点连接未知的通用点：

[是否有生成二维凹壳的有效算法？](https://stackoverflow.com/questions/83593/is-there-an-efficient-algorithm-to-generate-a-2d-concave-hull/83780#83780)

但是，由于您已经知道可以通过投影保留的“面部”信息，因此这可能不是最好的方法。

蛮力算法可能是可行的，尤其是在使用空间排序结构的情况下。例如对于每个方面：

1.  平面上的投影面
2.  检查投影面是否完全被现有几何体包围，如果是：完成（无需扩展投影轮廓）
3.  如果点落在现有几何形状之外，则进行三角形-三角形相交以确定哪些部分落在外面，构建任意 n 边形（可能是凹面）来填充缺失的空间，然后将 n 边形切成三角形

另一个想法，取决于您需要的保真度，只是从您的投影平面射出一束法线光线到您的原始几何体。创建一个 2d hit/miss 并使用它来确定您的范围。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-03-23T18:58:47.943

网格投影的 2D 轮廓是其边缘投影的子集。

使用这一观察，可以使用以下方法确定 2D 轮廓：

*   仅属于一个面的每条边的投影是 2D 轮廓的一部分，
*   对于其他边，确定其相邻面的法向量
*   计算这些法线与投影平面法线的点积
*   如果点积的所有符号都不相同，则该边缘的投影属于 2D 轮廓（这意味着，一个面指向投影平面而至少另一个面不指向投影平面，这将边缘标识为大纲）。

请注意，此方法将报告与投影平面正交的*所有*边缘，即使是从投影平面的角度看不到的边缘。例如，对于圆环，它会找到内部和外部轮廓，即使圆环以这样一种方式旋转，以至于从投影平面的角度看不到它的内部孔。要确定哪些边缘是可见的，您将需要某种可见性测试。如果预期用途是用于用户显示，则可以使用使用正交投影矩阵计算的深度缓冲区从投影平面的视点渲染几何图形，并进行一些 z 测试以确定哪些边缘从平面可见。如果您需要精度，则需要执行射线/三角形相交以确定可见性。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-04-17T11:09:05.007

1.  找到 x 为 min 的点
2.  找到该点的所有边
3.  从这一点开始，想象你有一根棍子（绿色），它顺时针滚动以找到它遇到的第一个边缘。让我们称之为边缘-A。 [边缘-A](https://i.stack.imgur.com/Hitik.png)
4.  寻找该边 A 中的交叉点。找到导致交叉点的边-B，我们称之为inter-A，这个inter-A是你的第二个轮廓点。 [边缘-B](https://i.stack.imgur.com/ttZTB.png)
5.  那么我们想一想，在edge-B的两点之间，谁是下一个轮廓点。链接inter-A和起点我们可以“滚动棒”找到下一个轮廓点。（候选点 1 是一个） [在此处输入图像描述](https://i.stack.imgur.com/PGOpV.png)
6.  重复上述步骤，直到找到集合中已经存在的点。

[查看为兔子寻找轮廓的演示](https://i.stack.imgur.com/rKwca.png) 这是上述算法的[实现。](https://github.com/Huangtingting93/Trace_outline)

# html - 使用大量 div 处理 HTML 的最佳工具？

> ID：1014294
> 
> 赞同：1
> 
> 时间：2009-06-18T18:12:03.133
> 
> 标签：html, ide

什么是最好的免费 IDE/编辑器，用于处理具有数千个 div 的 CSS 和 HTML，而且很难看出哪个 div 连接到什么？比如它是否可以突出显示相应的 div，或者在它们旁边显示一个 +/- 符号以展开/折叠它们？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-18T18:17:12.503

我喜欢在 firefox 中使用 firebug 来识别您所描述的问题。然后我可以清楚地看到浏览器正在渲染什么，并直接点击导致渲染的代码。必须具备（具有许多其他功能）。

不过，我同意@scunliffe 的观点：“成千上万的 div”让我害怕！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-18T18:30:27.473

Notepad++ 或 Eclipse 可以做你提到的突出显示/折叠。Firebug 可以以更具交互性的方式向您显示哪些是哪些。快速浏览 W3C 验证器将确保其中也没有任何不匹配的标签。伤不起。

总的来说，这只是一个“哎呀”的情况。如果您与造成混乱的人有任何联系，请鼓励他们尽快清理。它会让每个人都更快乐，他们的页面加载速度更快。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-18T18:15:25.220

vim 在突出显示 a 时使用 "%"`<div>`或进行`</div>`简单匹配。可能还有一个用于代码折叠的插件。它也很快，这对巨大的文本文件很有帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-18T18:19:58.737

只需像我们其他人一样下载 Dreamweaver CS4 的破解副本。

@Cameron - ctrl + Shift + f

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-18T18:38:43.620

NuSphere PhpEd 具有 HTML 代码折叠功能。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-18T18:44:21.630

[oXygen 的 xhtml 支持](http://www.oxygenxml.com/xhtml_editor.html)可以做这种事情。具体来说，它提供代码折叠并解析 xhtml 代码以提供高亮匹配 div 等功能。您还可以针对您的源运行临时 XPath 语句，作为更适合 XML 文档的正则表达式 grep 形式。我还发现他们的代码完成非常聪明。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-18T18:14:38.870

我建议使用带有 Aptana Studio 插件的 Eclipse IDE。对匹配的标签、标签洞察等进行很好的突出显示。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-18T18:23:11.773

许多免费的 IDE 都可以做到这一点。我知道[Komodo Edit](http://www.activestate.com/komodo_edit/)完全符合您开箱即用的描述。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-18T19:17:20.063

[除了折叠 div 之外，您还可以在http://www.w3.org/People/Raggett/tidy](http://www.w3.org/People/Raggett/tidy/)上找到一个美化工具，比如这个共享软件，名为“Tidy”的开源 C 程序，它位于古老的 W3C 中[/](http://www.w3.org/People/Raggett/tidy/)

# c# - 方法签名中的新关键字

> ID：1014295
> 
> 赞同：119
> 
> 时间：2009-06-18T18:12:05.693
> 
> 标签：c#, methods, keyword

在执行重构时，我最终创建了一个如下例所示的方法。为简单起见，已更改数据类型。

我以前有一个这样的赋值语句：

```
MyObject myVar = new MyObject(); 
```

它被偶然重构为：

```
private static new MyObject CreateSomething()
{
  return new MyObject{"Something New"};
} 
```

这是我的剪切/粘贴错误的结果，但`new`关键字 in`private static new`是有效的并且可以编译。

**问题**：`new`关键字在方法签名中表示什么？我认为这是 C# 3.0 中引入的东西？

这与 有何不同`override`？

* * *

## 回答 #1

> 赞同：105
> 
> 时间：2009-06-18T18:25:32.287

来自 MSDN 的新关键字参考：

[MSDN 参考](http://msdn.microsoft.com/en-us/library/435f1dw2.aspx)

这是我在网上从 Microsoft MVP 中找到的一个非常有意义的示例： [Link to Original](http://social.msdn.microsoft.com/forums/en-US/Vsexpressvcs/thread/65e02299-300f-4b74-8f0a-679f490605f5)

```
public class A
{
   public virtual void One();
   public void Two();
}

public class B : A
{
   public override void One();
   public new void Two();
}

B b = new B();
A a = b as A;

a.One(); // Calls implementation in B
a.Two(); // Calls implementation in A
b.One(); // Calls implementation in B
b.Two(); // Calls implementation in B 
```

覆盖只能在非常特殊的情况下使用。来自 MSDN：

> 您不能覆盖非虚拟或静态方法。被覆盖的基方法必须是虚拟的、抽象的或覆盖的。

所以需要'new'关键字来允许你'覆盖'非虚拟和静态方法。

* * *

## 回答 #2

> 赞同：62
> 
> 时间：2009-06-18T18:14:28.433

不，它实际上不是“新的”（请原谅双关语）。它基本上用于“隐藏”一种方法。IE：

```
public class Base
{
   public virtual void Method(){}
}

public class Derived : Base
{
   public new void Method(){}
} 
```

如果你这样做：

```
Base b = new Derived();
b.Method(); 
```

Base 中的方法将被调用，而不是派生中的方法。

更多信息：[http ://www.akadia.com/services/dotnet_polymorphism.html](http://www.akadia.com/services/dotnet_polymorphism.html)

**重新编辑：**在我给出的示例中，如果您要“覆盖”而不是使用“新”，那么当您调用 b.Method(); 由于多态性，将调用派生类的方法。

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2009-06-18T18:31:11.043

正如其他人解释的那样，它用于隐藏现有方法。它对于覆盖父类中非虚拟的方法很有用。

请记住，创建“新”成员不是多态的。如果将对象强制转换为基类型，它将不会使用派生类型的成员。

如果你有一个基类：

```
public class BaseClass
{
    public void DoSomething() { }
} 
```

然后是派生类：

```
public class DerivedType : BaseClass
{
    public new void DoSomething() {}

} 
```

如果您声明一种类型`DerivedType`然后对其进行强制转换，则该方法`DoSomething()`不是多态的，它将调用基类的方法，而不是派生的方法。

```
BaseClass t = new DerivedType();
t.DoSomething();// Calls the "DoSomething()" method of the base class. 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-06-18T18:15:13.847

从文档：

如果派生类中的方法以 new 关键字开头，则该方法被定义为独立于基类中的方法。

这在实践中意味着什么：

如果您从另一个类继承并且您有一个共享相同签名的方法，您可以将其定义为“新”，以便它独立于父类。这意味着如果您引用了“父”类，则将执行该实现，如果您引用了子类，则将执行该实现。

就我个人而言，我尽量避免使用“new”关键字，因为它通常意味着我的类层次结构错误，但有时它会很有用。一个地方是版本控制和向后兼容性。

[MSDN 中](http://msdn.microsoft.com/en-us/library/6fawty39%28VS.80%29.aspx)有很多关于此的信息。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2015-06-22T22:32:38.900

**长话短说——它不是必需的，它不会改变任何行为，而且它纯粹是为了可读性。**

这就是为什么在 VS 中你会看到一些波浪状的东西，但你的代码会编译并运行得非常好，并且符合预期。

人们不得不怀疑是否真的值得创建`new`关键字，而这意味着开发人员承认“是的，我知道我隐藏了一个基本方法，是的，我知道我没有做任何与`virtual`或`overriden`（多态性）相关的事情——我真的很想创建它自己的方法”。

这对我来说有点奇怪，但可能只是因为我来自背景，继承和`Java`之间存在根本区别：在中，方法默认是虚拟的，除非由. 在中，除非由 指定，否则默认情况下方法是最终的/具体的。`C#``Java``Java``final``C#``virtual`

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-06-18T18:16:15.763

这意味着该方法替换了基类继承的同名方法。在您的情况下，您可能在基类中没有该名称的方法，这意味着 new 关键字是完全多余的。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-18T18:15:21.350

来自[MSDN](http://msdn.microsoft.com/en-us/library/51y09td4%28VS.71%29.aspx)：

> 使用 new 修饰符显式隐藏从基类继承的成员。要隐藏继承的成员，请在派生类中使用相同的名称声明它，并使用 new 修饰符对其进行修改。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-05-31T18:01:41.620

小心这个陷阱。
您有一个在基类中实现的接口中定义的方法。然后创建一个隐藏接口方法的派生类，但不要明确声明派生类实现接口。如果您随后通过对接口的引用调用该方法，则将调用基类的方法。但是，如果您的派生类确实实现了该接口，那么无论使用哪种类型的引用都将调用其方法。

```
interface IMethodToHide
{
    string MethodToHide();
}

class BaseWithMethodToHide : IMethodToHide
{
    public string MethodToHide()
    {
        return "BaseWithMethodToHide";
    }
}

class DerivedNotImplementingInterface   : BaseWithMethodToHide
{
    new public string MethodToHide()
    {
        return "DerivedNotImplementingInterface";
    }
}

class DerivedImplementingInterface : BaseWithMethodToHide, IMethodToHide
{
    new public string MethodToHide()
    {
        return "DerivedImplementingInterface";
    }
}

class Program
{
    static void Main()
    {
        var oNoI = new DerivedNotImplementingInterface();
        IMethodToHide ioNoI = new DerivedNotImplementingInterface();

        Console.WriteLine("reference to the object type DerivedNotImplementingInterface calls the method in the class " 
            + oNoI.MethodToHide());
        // calls DerivedNotImplementingInterface.MethodToHide()
        Console.WriteLine("reference to a DerivedNotImplementingInterface object via the interfce IMethodToHide calls the method in the class " 
            + ioNoI.MethodToHide());
        // calls BaseWithMethodToHide.MethodToHide()
        Console.ReadLine();

        var oI = new DerivedImplementingInterface();
        IMethodToHide ioI = new DerivedImplementingInterface();

        Console.WriteLine("reference to the object type DerivedImplementingInterface calls the method in the class " 
            + oI.MethodToHide());
        // calls DerivedImplementingInterface.MethodToHide()
        Console.WriteLine("reference to a DerivedImplementingInterface object via the interfce IMethodToHide calls the method in the class " 
            + ioI.MethodToHide());
        // calls DerivedImplementingInterface.MethodToHide()
        Console.ReadLine();

    }
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-01-24T07:45:40.573

FWIW，我已经编写 C# 代码很长一段时间了，我需要`new`关键字的唯一情况是以下 OO 层次结构场景：

```
public abstract class Animal
{
    protected Animal(Animal mother, Animal father)
    {
        Mother = mother;
        Father = father;
    }

    public Animal Mother { get; }
    public Animal Father { get; }
}

public class Dog : Animal
{
    public Dog(Dog mother, Dog father)
        : base(mother, father)
    {
    }

    public new Dog Mother => (Dog)base.Mother;
    public new Dog Father => (Dog)base.Father;
} 
```

几点说明：

*   没有违反 OO 规则，基类仍然可以正常工作。
*   属性不是`virtual`故意标记的，它们不需要。
*   事实上，由于新的关键字，我们执行了更多的 OO 规则：狗*不能*有任何动物作为父亲/母亲。*一定*是条狗。
*   使用`new`关键字是因为我们不能仅通过更改其返回类型来“覆盖”属性（或方法）。`new`是拥有良好 OO 层次结构的唯一方法。

# javascript - 无法让 IIS 从指定目录提供 .js 文件

> ID：1014299
> 
> 赞同：0
> 
> 时间：2009-06-18T18:12:47.330
> 
> 标签：javascript, web-applications, mime-types, iis-5, directory-permissions

我在 Windows 2000 机器上运行 IIS 5。

我在网站的“脚本”目录中有一个应用程序设置，因为它运行一些已编译的 DLL。该应用程序设置为运行脚本和可执行文件。

出于某种原因，当我尝试访问该目录中的任何 .js 文件时，我得到“系统找不到指定的文件。”。我尝试将 .js 作为“文本/javascript”mime 类型添加到网站和目录中，但似乎没有帮助。

我还检查了 Web 服务器本身，并将 .js mime 类型设置为 application/octet-stream。我将其更改为 text/javascript，但它仍然无法正常工作。我是否需要重新启动 IIS 或应用程序池？还是我找错地方了。

我也尝试使用 text/text 和 text/html 但这没有帮助。

我能够访问该目录中的 .htm、.jpg 甚至 .asp 文件。

有任何想法吗？提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T18:29:50.047

网址扫描！！！！

我检查了 URLScan 的日志目录，它正在阻止基于 .js 扩展名的文件。我将它添加到 urlscan.ini，重新启动 IIS，瞧！有效！

更多信息：

目录： URLScan - C:\WINNT\System32\inetsrv\urlscan\ URLScan 日志 - C:\WINNT\System32\inetsrv\urlscan\logs\ URLScan INI 文件 - C:\WINNT\System32\inetsrv\urlscan\urlscan.ini

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T18:23:44.503

我会使用 FileMon 工具来查看 IIS 是否甚至试图访问 JS 文件。这可能是一个安全问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T18:26:17.057

IIS 帐户是否具有对该目录的读取权限？

.js 文件是否可以在服务器上的任何其他虚拟目录中工作？

# linux - Debian 软件包创建错误

> ID：1014301
> 
> 赞同：0
> 
> 时间：2009-06-18T18:13:18.750
> 
> 标签：linux, debian, packaging, dpkg

我正在尝试构建一个 Debian 软件包，但我遇到了这个奇怪的伪目录问题。我跑：

```
$ fakeroot debian/rules binary 
```

我之前已经构建了二进制文件，但是我的系统上肯定发生了一些变化。现在 dh_md5sums 出错并返回：

```
md5sum: include: Is a directory
dh_md5sums: command returned error code
make: *** [binary-arch] Error 1 
```

的确，`include`是一个目录。因此，我在 dh_md5sums 中添加了一些调试语句，以找出为什么`include`会被散列，尽管应该过滤掉目录的行。添加：

```
doit("ls", "-l", "$tmp"); 
```

表明，`include`当 dh_md5sums 运行时，它确实不是一个目录：

```
total 28
drwxr-xr-x 2 root root 4096 2009-06-18 13:36 bin
-rwxr-xr-x 3 root root 4096 2009-06-18 13:36 include
drwxr-xr-x 3 root root 4096 2009-06-18 13:36 var
# some directories removed for brevity's sake 
```

那么，我可以删除它吗？我补充说：

```
doit("rm", "$tmp/include"); 
```

并得到：

```
rm: cannot remove `debian/myproject/include': Is a directory 
```

也许它......变成了一个目录？我`ls -l`在下面添加了另一个`rm`并得到：

```
total 28
drwxr-xr-x 2 root root 4096 2009-06-18 13:36 bin
-rwxr-xr-x 3 root root 4096 2009-06-18 13:36 include
drwxr-xr-x 3 root root 4096 2009-06-18 13:36 var 
```

当脚本运行完毕后，我可以这样做：

```
$ ls -l
drwxr-xr-x 2 x x 4096 2009-06-18 13:48 bin
drwxr-xr-x 3 x x 4096 2009-06-18 13:48 include
drwxr-xr-x 3 x x 4096 2009-06-18 13:48 var 
```

...这很奇怪，因为它`include`变成了一个目录并且所有权发生了变化（`x`是我的用户名）。 `include`甚至包含它应该包含的所有头文件。

有谁知道发生了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T19:20:33.457

```
total 28
drwxr-xr-x 2 root root 4096 2009-06-18 13:36 bin
-rwxr-xr-x 3 root root 4096 2009-06-18 13:36 include
drwxr-xr-x 3 root root 4096 2009-06-18 13:36 var
# some directories removed for brevity's sake 
```

请注意，`include`它的链接计数为 3，表示它要么是具有 1 个子目录的目录，要么是具有 3 个硬链接的文件。前者似乎更有可能。

这似乎是与 fakeroot 的不良交互。我以前见过 fakeroot 有时会“忘记”权限的情况，因此请仔细检查何时`include`创建或修改它是否具有正确的类型（并且这些都没有最近的更改）。

# database - 二进制数据的十六进制编码的目的是什么？

> ID：1014308
> 
> 赞同：6
> 
> 时间：2009-06-18T18:14:19.293
> 
> 标签：database, language-agnostic, binary, hex, base64

我有点好奇为什么要在 base64 上使用十六进制编码。在我看来，base 64 更有效。特别是，为什么数据库似乎总是使用十六进制编码？这是一个历史问题，还是我错过了一些关于十六进制编码的东西？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-18T18:17:44.543

你必须是一个真正的极客才能阅读`BASE64`屏幕。

在`Oracle`中，当我跑步时`HEXTORAW`，我可以了解某个`RAW`领域中有什么，但我无法使用`BASE64`.

就像，当我看到很多`0x3F`'s 时，我知道编码有问题。

在内部，这些只是二进制字节，没有其他需要对它们进行编码，而是显示给屏幕另一侧的人。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-18T18:22:08.813

这是有效空间使用和可读性之间的良好折衷。位模式在十六进制中变得非常明显，而其他基础则不那么清楚。

哪个更容易阅读，0x8080 还是 32896？我会说十六进制值是。

它还具有每个十六进制数字等于一个半字节（因此每对等于一个字节）的良好属性。

在你的头脑中理解十六进制比基数 64 容易得多。

就数据库而言，请记住，数据的显示方式和存储方式之间存在差异。很可能只是将数据显示为十六进制。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-10-10T13:22:22.673

如果您想在 Windows 上将结果值用作文件名，则 Base64 不起作用，因为 base64 使用大写和小写字母。我敢肯定，由于类似的原因，它在其他时候不能使用。

同意关于可读性的其他答案 - 十六进制数字在 8 位字节上很好地对齐，而 base64“数字”没有，一个数字可以包含两个字节的一部分。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-11-23T02:22:31.667

对于字符串存储（使用“可能”的 XML 安全编码），您可以使用 ASCII 85 获得更高的效率，因为它是 5/4 膨胀而不是 base64 的 4/3。

但是比base64更难“阅读”。而且支持它的应用程序并不多，因此您必须编写自己的类/函数来进行编码和解码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-18T18:21:44.927

我想您的数据库确实将数据存储为二进制，但查询编辑器将使用十六进制编码显示它。这就是 SQL Server 查询分析器要做的事情。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-18T18:21:45.753

我想这只是个人喜好问题......到目前为止，Hex 比 Base32 或 Base64 更容易阅读

# objective-c - typedef 枚举类型作为 NSDictionary 的键？

> ID：1014314
> 
> 赞同：18
> 
> 时间：2009-06-18T18:14:38.323
> 
> 标签：objective-c

枚举不允许作为 NSMutableDictionary 的键吗？

当我尝试通过以下方式添加到字典时：

```
[self.allControllers setObject:aController forKey:myKeyType]; 
```

我得到错误：

> 错误：'setObject:forKey:' 的参数 2 的类型不兼容

通常，我使用 NSString 作为我的键名，它不需要强制转换为“id”，但为了使错误消失，我必须这样做。这里的强制转换是正确的行为还是将枚举作为键是一个坏主意？

我的枚举定义为：

```
typedef enum tagMyKeyType
{
  firstItemType = 1,
  secondItemType = 2
} MyKeyType; 
```

并且字典是这样定义和正确分配的：

```
NSMutableDictionary *allControllers;

allControllers = [[NSMutableDictionary alloc] init]; 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-06-18T18:48:18.193

不过，您可以将枚举存储在 NSNumber 中。（枚举不只是整数吗？）

```
[allControllers setObject:aController forKey:[NSNumber numberWithInt: firstItemType]]; 
```

在 Cocoa 中，经常使用 const NSStrings。在 .h 中，您将声明如下内容：

```
NSString * const kMyTagFirstItemType;
NSString * const kMyTagSecondtItemType; 
```

在 .m 文件中你会放

```
NSString * const kMyTagFirstItemType = @"kMyTagFirstItemType";
NSString * const kMyTagSecondtItemType = @"kMyTagSecondtItemType"; 
```

然后，您可以将其用作字典中的键。

```
[allControllers setObject:aController forKey:kMyTagFirstItemType]; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-05-29T06:39:16.613

这是一个老问题，但可以更新以使用更现代的语法。首先，从 iOS 6 开始，Apple 建议将枚举定义为：

```
typedef NS_ENUM(NSInteger, MyEnum) {
   MyEnumValue1 = -1, // default is 0
   MyEnumValue2,  // = 0 Because the last value is -1, this auto-increments to 0
   MyEnumValue3 // which means, this is 1
}; 
```

然后，由于我们在`NSInteger`内部将枚举表示为 s，我们可以将它们装箱到`NSNumber`s 中以存储为字典的键。

```
NSMutableDictionary *dictionary = [NSMutableDictionary dictionary];

// set the value
dictionary[@(MyEnumValue1)] = @"test";

// retrieve the value
NSString *value = dictionary[@(MyEnumValue1)]; 
```

**编辑：如何为此目的创建一个单例字典**

通过这种方法，您可以创建一个单例字典来帮助解决这个问题。在您拥有的任何文件的顶部，您可以使用：

```
static NSDictionary *enumTranslations; 
```

然后在您的`init`or中`viewDidLoad`（如果您在 UI 控制器中执行此操作），您可以执行以下操作：

```
static dispatch_once_t onceToken;
// this, in combination with the token above,
// will ensure that the block is only invoked once
dispatch_async(&onceToken, ^{
    enumTranslations = @{
        @(MyEnumValue1): @"test1",
        @(MyEnumValue2): @"test2"
        // and so on
    };
});

 // alternatively, you can do this as well
static dispatch_once_t onceToken;
// this, in combination with the token above,
// will ensure that the block is only invoked once
dispatch_async(&onceToken, ^{
    NSMutableDictionary *mutableDict = [NSMutableDictionary dictionary];
    mutableDict[@(MyEnumValue1)] = @"test1";
    mutableDict[@(MyEnumValue2)] = @"test2";
    // and so on

    enumTranslations = mutableDict;
}); 
```

如果您希望此字典在外部可见，请将静态声明移动到您的头 ( `.h`) 文件中。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-18T18:20:17.693

不，你不能。看方法签名：`id`指定一个对象。枚举类型是标量。您不能从一个转换到另一个并期望它正常工作。你必须使用一个对象。

# c# - C# 和 vs2008 中的线程调试

> ID：1014324
> 
> 赞同：5
> 
> 时间：2009-06-18T18:15:44.813
> 
> 标签：c#, visual-studio-2008, multithreading, debugging

我有一个非常严重的多线程调试问题。我在与串行设备交互时遇到了某种时间问题，我需要追踪它。我有三个线程：

1.  UI 更新的主线程。用户可以通过选择预设来更改设备的一个参数，也可以同时更改多个参数。
2.  查询以确保设备仍处于连接状态的状态检查线程。如果用户关闭设备或设备本身以有趣的方式进行交互，则需要在 UI 中反映状态变化。
3.  读取设备响应的串行端口的线程。

我的问题实际上与调试这种情况有关。似乎我在每个线程中的每一行都必须有一个断点才能进行调试；如果我中断一个线程，调试器将不会单步执行该线程。我知道其他线程将继续更新，但我正在执行的线程不应该在调试器中正常执行，即从一行转到下一行吗？然后，我可以使用“线程”选项卡在线程之间切换。

我提到我在 WPF 中，因为我不知道这是否会改变情况；也许是这样，也许不是。状态检查线程是 UI 控件的一部分，因为只需要在 UI 启动时检查状态。该控件位于与主应用程序不同的库中。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-18T18:22:45.410

当调试器在断点处停止时，默认情况下它将暂停所有其他线程。但是，当您单步执行或继续时，所有 3 个线程都会恢复。当您单步执行代码时，调试器基本上会在下一行设置一个临时断点并恢复所有线程。其他 2 个可能有机会在该虚拟断点被击中之前运行。

**您可以在调试时冻结其他线程**

当您处于断点处时，请选择**Debug | 窗户 | 线程**。选择您不感兴趣的线程并右键单击，选择**Freeze**。这将使您专注于您正在单步执行的一个线程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T18:53:17.357

如果您的代码以一种奇怪的方式单步执行，则有时可能是由一个简单的损坏的 pdb 文件引起的。对您的代码进行“全部重建”将从头开始重新生成它并解决任何此类故障。

要记住的另一件事是，在调试器中停止一个线程可能会导致您在发布版本中看不到的各种异常时间。例如：

*   当您在断点处停止时，串行端口将始终继续运行（在硬件/驱动程序级别） - 当您下次尝试单步执行代码时，它可能会突然收到大量数据。使用异步回调，这可能是“有趣的”。

*   停止一个线程会扰乱正常的时间片，因此线程间的同步可能会被搞砸。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T22:09:36.350

我和杰森在一起，踏步不再表明真相。

您最好使用一种方法来检测每一行代码，该方法还使用 Interlocked.Increment 递增计数器并将计数器添加到输出中（最好使用本地文件）。

需要计数器，因为实际事件的顺序并不总是与写入文件的顺序相同。在输出中命名线程或使用 ID 值。我使用 MS Excel 打开文件并根据线程为所有行着色，这样我可以非常清楚地看到交错操作。

我什至编写了一个包装器来锁定 {}，它会在每个锁打开/关闭时进行检测。

同步问题对于 t-shoot 来说是可怕的，所以我建议不要花费超过重构所需的费用。有时它表明您采用的方法不是最佳的。

请记住在必要时对 IO 使用 volatile。

# iphone - 如何在 iPhone 上播放音调

> ID：1014327
> 
> 赞同：1
> 
> 时间：2009-06-18T18:16:08.557
> 
> 标签：iphone, objective-c, audio

是否可以在 iPhone 上轻松播放一个音调或一系列音调（如莫尔斯电码、哔哔哔哔）？

是否有任何示例代码可以为我指明正确的方向？

（我记得在 Commodore 64 上大约有 4 行代码！）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-22T03:48:33.797

您可以使用：

```
#import <AudioToolbox/AudioToolbox.h>
AudioServicesPlayAlertSound(kSystemSoundID_Vibrate); 
```

我很确定做你想做的事就好了。确保首先链接到 AudioToolbox 框架！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-19T08:44:08.967

1.  想不同。使用音频文件。:) 有很多简单的方法来玩这些。

2.  查看 中的 AudioQueue 库`AudioToolbox.framework`。`AudioQueueNewOutput`可能是您正在寻找的东西，尽管我有一段时间没有使用这些了。您可以在回调中提供您的音频数据。

# .net - 尝试过滤从实体框架中的另一个继承的实体的属性时出错

> ID：1014332
> 
> 赞同：0
> 
> 时间：2009-06-18T18:16:45.013
> 
> 标签：.net, linq, entity-framework, inheritance, table-per-type

例如，当我让实体 B 从实体 A 继承使用 table-per-type 进行存储并尝试编写一个 Linq 查询来过滤 B 上的属性时

```
Function(b) b.name="Joe" 
```

我得到错误

> LINQ to Entities 不支持指定的类型成员“名称”。仅支持初始化程序、实体成员和实体导航属性。

过滤基表中存在的任何属性都可以正常工作。知道我做错了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T19:56:10.763

[在这里](http://blogs.msdn.com/bags/archive/2009/03/06/entity-framework-modeling-table-per-type-inheritance.aspx)找到了答案。我需要在 from 子句中将**.OfType(MySubClass)()**添加到我的实体以查看子类属性。

# windbg - 如何阻止 windbg 成为交互式调试器？

> ID：1014345
> 
> 赞同：14
> 
> 时间：2009-06-18T18:18:57.833
> 
> 标签：windbg

在 vista/win7 上撤消*windbg -I*的正确方法是什么？

是否像删除 HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\AeDebug 中的注册表项一样简单？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-06-18T18:37:00.300

您不需要删除整个注册表项。删除 Debugger 值就足够了。

当发生异常时，系统首先查看是否有注册的调试器。如果是这样，它只会启动指定的命令行。否则，它会调用 Windows 错误报告来收集故障转储。Windbg -I 所做的只是更改 AeDebug 键中注册的调试器值。

# python - 如何将元组和列表的嵌套元组转换为 Python 中的列表列表？

> ID：1014352
> 
> 赞同：2
> 
> 时间：2009-06-18T18:20:54.290
> 
> 标签：python, list, tuples

我有一个包含列表和更多元组的元组。我需要将其转换为具有相同结构的嵌套列表。例如，我想转换`(1,2,[3,(4,5)])`为 `[1,2,[3,[4,5]]]`.

我该怎么做（在 Python 中）？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-06-18T19:19:02.133

```
def listit(t):
    return list(map(listit, t)) if isinstance(t, (list, tuple)) else t 
```

我能想象的最短的解决方案。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-18T18:48:36.367

作为一个python新手，我会试试这个

```
def f(t):
    if type(t) == list or type(t) == tuple:
        return [f(i) for i in t]
    return t

t = (1,2,[3,(4,5)]) 
f(t)
>>> [1, 2, [3, [4, 5]]] 
```

或者，如果你喜欢一个衬垫：

```
def f(t):
    return [f(i) for i in t] if isinstance(t, (list, tuple)) else t 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-03-30T11:50:23.603

我们可以（ab）使用`json.loads`总是为 JSON 列表生成 Python 列表的事实，同时`json.dumps`将任何 Python 集合转换为 JSON 列表：

```
import json

def nested_list(nested_collection):
    return json.loads(json.dumps(nested_collection)) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-31T01:50:40.920

这是我想出的，但我更喜欢另一个。

```
def deep_list(x):
      """fully copies trees of tuples or lists to a tree of lists.
         deep_list( (1,2,(3,4)) ) returns [1,2,[3,4]]
         deep_list( (1,2,[3,(4,5)]) ) returns [1,2,[3,[4,5]]]"""
      if not ( type(x) == type( () ) or type(x) == type( [] ) ):
          return x
      return map(deep_list,x) 
```

我看到[aztek](https://stackoverflow.com/users/75280/aztek)的答案可以缩短为：

```
def deep_list(x):
     return map(deep_list, x) if isinstance(x, (list, tuple)) else x 
```

**更新**：但是现在我从[DasIch](https://stackoverflow.com/users/114920/dasich)的评论中看到，这在 Python 3.x 中不起作用，因为 map() 那里返回了一个生成器。

# .net - T4模板新手问题

> ID：1014354
> 
> 赞同：1
> 
> 时间：2009-06-18T18:21:37.393
> 
> 标签：.net, asp.net, visual-studio, t4

我正在构建一个产品，我需要一种在运行时生成代码的方法。目前，我使用 VB.Net（仅用于此目的，仅用于此目的）xml 文字（这就是它们的名称吗？），在运行时创建模板和创建代码。我的问题是，我可以在没有安装 VS 的情况下在共享主机的 Web 服务器上使用 T4 在运行时生成代码吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-07-12T01:21:35.557

我知道这个问题很老，但现在答案已经过时，所以我想我会插话。如果您使用的是 Visual Studio 2010 的新预处理模板，您现在可以执行此操作。不是在编译时使用 T4 生成代码，而是使用 T4 生成生成器类，并且该生成器类可以在运行时使用。这意味着 T4 可用于生成任何字符串输出，而不仅仅是您需要编译到项目中的内容 - 这使其成为 NVelocity 等工具的真正替代品。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T19:18:51.557

也许这个问题的答案会对你有所帮助。 [没有 Visual Studio 的 T4？](https://stackoverflow.com/questions/978281/t4-without-visual-studio)

但是，T4 是构建时（或设计时）工具，而不是运行时工具，因此它似乎不是您尝试做的最佳解决方案。

# java - 如何在 ejb 调用中获取调用 IP 地址？

> ID：1014358
> 
> 赞同：3
> 
> 时间：2009-06-18T18:21:53.943
> 
> 标签：java, ip-address, ejb

如果 java 客户端调用不同服务器上的远程 EJB，如何获取客户端 IP 地址？请注意，从服务器获取它很重要，因为客户端可能位于 NAT 防火墙后面，在这种情况下，我们需要公共 IP 地址。

注意：虽然它最好是一个通用的解决方案，但至少我可以使用一个从 JBoss 4.2.2 上的 EJB2 调用中检索 IP 地址的解决方案

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-26T19:54:07.950

[JBoss 社区 wiki 上的这篇文章](http://www.jboss.org/community/wiki/HowtogettheClientipaddressinanEJB3Interceptor)正好解决了您的问题。在 JBoss 5 之前，IP 地址显然必须从工作线程名称中解析出来。这似乎是在早期版本上执行此操作的唯一方法。这是执行此操作的代码片段（从上面的链接复制）：

```
private String getCurrentClientIpAddress() {
    String currentThreadName = Thread.currentThread().getName();
    System.out.println("Threadname: "+currentThreadName);
    int begin = currentThreadName.indexOf('[') +1;
    int end = currentThreadName.indexOf(']')-1;
    String remoteClient = currentThreadName.substring(begin, end);
    return remoteClient;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-26T11:03:05.067

您是否尝试过： java.rmi.server.RemoteServer.getClientHost() ？

[http://java.sun.com/j2se/1.5.0/docs/api/java/rmi/server/RemoteServer.html#getClientHost()](http://java.sun.com/j2se/1.5.0/docs/api/java/rmi/server/RemoteServer.html#getClientHost())

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-09T12:20:47.957

我相信当前工作线程的名称包含服务器的 IP 地址，但不包含客户端的 IP，因为线程是池化的，而不是为每个调用创建的。在 JBoss 4 中，可以使用以下解决方法来获取客户端的 IP 地址：

```
 try {
            //Reflection is used to avoid compile-time dependency on JBoss internal libraries
            Class clazz = Class.forName("org.jboss.web.tomcat.security.HttpServletRequestPolicyContextHandler");
            Field requestContextField = clazz.getDeclaredField("requestContext");
            requestContextField.setAccessible(true);
            ThreadLocal ctx = (ThreadLocal) requestContextField.get(null);
            ServletRequest req = ((ServletRequest) ctx.get());
            return req==null?null:req.getRemoteAddr();
        } catch (Exception e) {
            LOG.log(Level.WARNING, "Failed to determine client IP address",e);
        } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-29T16:54:55.373

感谢 MicSim，我了解到线程名称存储了 IP 地址。在 JBoss 4.2.2 中，EJB2 项的线程名称如下所示：

> http-127.0.0.1-8080-2

（我假设 http 是可选的，具体取决于实际使用的协议）。

然后可以使用正则表达式对其进行解析，如下所示：

```
 Pattern pattern = Pattern.compile("\\b(?:\\d{1,3}\\.){3}\\d{1,3}\\b");
    Matcher matcher = pattern.matcher(Thread.currentThread().getName());
    if (matcher.find()) {
        return matcher.group();
    }
    return ""; 
```

# asp.net - 有没有办法确定在 WebRequest 期间是否发生重定向？

> ID：1014368
> 
> 赞同：0
> 
> 时间：2009-06-18T18:23:26.627
> 
> 标签：asp.net, redirect, httpwebrequest

我正在使用 HttpWebRequest 来抓取 Wikipedia.org。很多时候，页面上的主题链接已经合并，因此它们会将您重定向到正确的页面。

例如

[http://en.wikipedia.org/wiki/Polish_prisoners_of_war_in_Soviet_Union_(after_1939)](http://en.wikipedia.org/wiki/Polish_prisoners_of_war_in_Soviet_Union_(after_1939))

将您重定向到正确的主题，即

[http://en.wikipedia.org/wiki/Polish_prisoners_of_war_in_the_Soviet_Union_(after_1939)](http://en.wikipedia.org/wiki/Polish_prisoners_of_war_in_the_Soviet_Union_(after_1939))

注意添加了“the”这个词。

此时我需要确定是否发生了重定向。谁能建议我如何做到这一点？

谢谢！

**更新**

我将下面的回复标记为已回答，因为从技术上讲，这就是您判断您是否已被重定向的方式。我遇到的问题是维基百科实际上并没有使用 http 响应代码 3xx进行*硬重定向。*他们正在做*软重定向*，在同一个 URL 下提供不同的内容。我将不得不找到另一个解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-18T18:27:19.490

HttpWebRequest 对象上有一个名为“ [AllowAutoRedirects ”的属性。](http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.allowautoredirect.aspx)如果你关闭它，你可以自己跟随重定向。

您也可以尝试检查 HttpWebResponse。[响应Uri](http://msdn.microsoft.com/en-us/library/system.net.httpwebresponse.responseuri.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T18:28:17.430

试试这个：

```
if(reponse.ResponseUri != request.RequestUri) {
    //You were redirected
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-03-21T15:48:31.110

使用[HttpWebRequest.Address](https://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.address.aspx)属性，该属性明确定义为“请求期间发生的任何重定向完成后的 URI”

请注意，应该使用它而不是类似的[HttpWebResponse.ResponseUri](https://msdn.microsoft.com/en-us/library/system.net.httpwebresponse.responseuri.aspx)，因为它的文档说：

> 需要访问最后重定向的 ResponseUri 的应用程序应该使用[HttpWebRequest..::..Address](https://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.address.aspx)属性而不是 ResponseUri，因为使用 ResponseUri 属性可能会打开安全漏洞。

# java - 是什么让框架成为“真正的”MVC 框架？

> ID：1014369
> 
> 赞同：20
> 
> 时间：2009-06-18T18:23:32.133
> 
> 标签：java, php, .net, model-view-controller, smalltalk

在阅读有关 MVC 框架的在线讨论时，我听到很多来自 Java/.NET 开发人员的评论指向 PHP 项目，如 Cake、Code Igniter 和 Symfony，“这些都是聪明的 hack，但不是真正的 MVC”。

那么，是什么让某个东西成为“真正的”MVC 框架？即 .NET 或 Java MVC 框架的示例与 Cake、Code Igniter、Symfony 等不同，这些不同的东西是什么？只是 PHP 缺乏需要引导程序的强制面向对象，还是其他原因？

我知道为什么 PHP 语言“很烂”，我对 MVC 实现和/或使用的差异更感兴趣。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-18T18:40:24.773

MVC 的想法是将应用程序架构解耦为三个独立的层，并允许这些层中的每一层使用不同的实现而不影响其他层。主要区别在于业务逻辑（模型）和表示（视图）。

许多 PHP 框架尝试使用 Ruby on Rails 的“自以为是的软件”理念，因此模型和视图的正确运行要求两者都符合特定的实现。也就是说，类必须以某种方式命名，项目中的文件必须根据某种目录结构组织，视图脚本中的符号必须遵循约定等。

这使得很难独立替换每一层的不同实现，这违背了 MVC 将层彼此分离的目标。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-14T15:22:10.820

这里有几个问题可以帮助您了解您的框架是否良好和真实。

## “我可以在没有框架的情况下为我的 MVC 类运行单元测试吗？”

即使您不编写单元测试，这也适用。

您应该能够独立于框架编写与 MVC 相关的代码。当您的应用程序从框架接收一些**输入**时，它应该是**具有已知接口的对象**，没有具体的类。

问题是，*真正的*MVC 框架对架构本身没有*（或非常有限）*影响。充其量，它只会为应用程序调用提供一种**清晰**而**简单**的方法来访问您的 MVC 三元组。*并且可能为您*提供便利......而不是限制和约束。

## “它会在魔法和仙尘上运行吗？”

您应该能够扩展框架提供的任何类。并且应该很容易理解您必须实现哪个功能。

如果*“事情刚刚发生”* ，这将变得非常困难。这通常指向框架代码中的全局状态。以静态方法或全局/静态变量的形式。

## “我的代码在什么时候启动？”

你能找到你的控制器在哪里以及如何被执行吗？通常不会那么容易。这个神秘的点通常在对象图中很深。有时甚至在扩展课程中。

这种情况使您很难更改执行控制器的环境。它还对控制器方法的外观施加了严格的规则。

这一切都回到了重点，真正的 MVC 框架应该**增强开发过程而不是限制**您的选择。

## “他/她应该能够做到这一点吗？”

身份验证和授权似乎是开发的一个独立方面，但实际上，在 MVC 的上下文中，它往往有点棘手。

许多框架都有一些身份验证/授权基础设施。这是一项重复性的任务，我们都把它做死了，因此 - 它是框架可以提供的功能的一个很好的候选者。

但关键在于：他们中的大多数人都试图将授权放在你的控制器中，而且他们对如何调整它非常挑剔。这是另一个限制。

归根结底就是这个。对于任何框架，都**不能仅仅为了添加登录**功能而重写每个控制器。即使您忽略了 OCP 的违规行为，这也会增加您意外忘记某些内容的风险。

..我的两分钱

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-19T13:56:53.950

Cake 和大多数“MVC”框架都可以称为“被动视图”MVC。这是一篇很棒的文章解释： http: [//www.martinfowler.com/eaaDev/PassiveScreen.html](http://www.martinfowler.com/eaaDev/PassiveScreen.html)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-18T18:28:26.947

您可能会发现[此](http://en.wikipedia.org/wiki/Model-view-controller)wiki 页面很有用。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-11-26T15:51:58.560

真正的 MVC 框架没有 M(odel) 层。CakePHP 和朋友们有一些聪明的类来访问数据库，他们称之为模型，将大部分数据处理留给控制器。

那是错的。模型应该做所有的数据处理（它*可以*使用帮助数据库类），控制器应该是用户/网页和模型之间的网关。大多数时候，模型是一个简单的 PHP 对象，不遵守任何规则，因此框架无法指定这些规则。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-02-19T19:26:00.540

顾名思义，框架旨在支持结构——在这种情况下是您的应用程序。您会看到的大多数框架的共同（和可悲）的事情是它们本身就变成了强加的结构，决定了它们自己分离业务逻辑、表示、路由/控制的方式。您会看到应用程序代码看起来需要整个团队来维护您一年前编写的内容。目标似乎是框架中功能的丰富性。不，这不对。这是关于让程序员自由决定应该分离应用程序的哪些组件以及应该分离的位置 - 只要任务可以分配给具有自己专业知识的个人工作组。

是否应该在模型、视图和控制之间进行分离——顺便说一下，它们必须在某个地方以某种方式相互通信——模糊或区别应该由解决方案架构师决定。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-18T22:14:01.953

有时人们需要退后一步，看看现实生活中的“框架”，数字世界正是从这个“框架”中得到这个词的。尽管无穷无尽的在线选项扭曲了这个词以适应个人议程并贬低其他系统，但这可能有助于解释它的含义。

框架应该在您工作的每个领域都为您提供帮助。

因此，如果您只有一个投资组合页面 - 那么您只需要一小部分工具。如果您启动下一个 Facebook，那么您的“框架”将大不相同。

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2009-06-18T18:24:30.383

JavaServer Faces 是一个非常好的 MVC 全栈框架。它具有良好的视图组件、带有托管 bean 的良好控制器，并且您可以为模型创建业务类。

# sharepoint - sharepoint - 创建一个新的 Web 应用程序

> ID：1014370
> 
> 赞同：1
> 
> 时间：2009-06-18T18:23:35.267
> 
> 标签：sharepoint, web-applications

我安装了共享点（wss 3.0）。我想创建一个新的 Web 应用程序，但我不想使用默认模板（团队网站、空白网站等），而是想使用自定义模板。基本上，我想复制我创建的网站（复制为网站模板）并在另一个 Web 应用程序中使用它。

我如何做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T18:27:34.670

在您要复制的站点上，转到“**站点操作**”并选择“**站点设置**”。从那里，您可以在“**外观”部分下选择“****将站点另存为模板**” 。

 **当您创建一个新站点时，模板框中应该有一个名为“**自定义**”的新选项卡 - 只需选择您的模板，然后就可以了！确保如果您在另一台服务器上进行部署，您还必须安装任何自定义 Web 部件（在创建站点之前）。这同样适用于自定义列表 - 可以从“列表设置”页面保存模板。

如果您要在完全不同的网站集中设置此站点，您只需将模板保存到本地系统，然后将它们上传到新网站集中的适当模板库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T00:29:03.693

此外，如果您想启动一个新的 Web 应用程序并使用您的自定义模板之一作为根模板，您可以将您的 STP 文件上传到全局模板库。

请参见[stsadm -o addtemplate](http://technet.microsoft.com/en-us/library/cc287945.aspx)命令**

# java - 如何让 OSX 上的 Eclipse 使用 Java 1.6？

> ID：1014376
> 
> 赞同：2
> 
> 时间：2009-06-18T18:25:10.210
> 
> 标签：java, eclipse, java-6

我刚刚在我的 OSX 上安装了 Java 1.6，一切都运行良好，除了 Eclipse 拒绝启动。它提出了一个巨大的提示，我无法从中复制/粘贴，但它清楚地表明它想要使用 Java 1.5 并且找不到它了。

我在它的配置文件中没有看到任何关于它应该寻找哪个版本的 Java 的信息。有没有人处理过这个？

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-18T18:33:47.013

*在 /Applications/Eclipse/Eclipse.app 上右键单击并选择“显示包内容”使用文本编辑器而不是*plist 编辑器打开 Contents/Info.plist

添加 `<string>-vm</string> <string>/System/Library/Frameworks/JavaVM.framework/Versions/1.5.0/Commands/java</string>`

到

```
<key>Eclipse</key>
        <array>
<!-- add it here -->
</array> 
```

保存并重新启动。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-18T18:44:38.603

除非我弄错了，Mac 上的 Java 1.6 虚拟机只有 64 位。要使用它，您需要 64 位版本的 Eclipse。mac 上唯一的 64 位 eclipse 端口是新的 cocoa 构建，在[这里](http://download.eclipse.org/eclipse/downloads/drops/I20090611-1540/index.php)找到它。

几周后，[Galileo 版本](http://www.eclipse.org/galileo/)将完成，您可以通过 Eclipse Classic -> Other Downloads 找到 64 位可可端口。

如果您想保留当前的 ​​eclipse 安装，您必须按照其他答案的建议进行操作并将它们更改为使用 1.5

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T18:29:00.050

您应该切换到以前的 Java 版本，在 Utilities、Java Preferences 下，并将 1.5 32 bit 作为首选。

错误的原因是捆绑的 SWT JINI 库似乎只为某些平台编译。

您可以随时检查控制台以获取特定的错误消息。

# xml - 创建递归 XSL:If 语句？

> ID：1014383
> 
> 赞同：2
> 
> 时间：2009-06-18T18:27:42.203
> 
> 标签：xml, xslt, recursion, symphony-cms

我正在尝试设置一个 XSL:IF 语句，该语句仅显示具有介于两个值之间的节点的条目。很简单，对吧？这只是一个 if 大于和 if 小于。问题是，我需要对最多 52 个节点进行测试，而不是针对一个节点进行测试。

假设我有一些如下所示的 XML：

```
<container>
    <entry>
        <item>1</item>
        <item>2</item>
        <item>3</item>
        <item>4</item>
        <item>5</item>
        <item>6</item>
        <item>7</item>
        <item>8</item>
        <item>9</item>
        <item>10</item>
    </entry>
</container> 
```

现在假设我的范围是 9-15。因为某些节点属于该范围，所以我想显示该条目。但是，如果给我一个 11-15 的范围，则没有一个节点适合，所以我不希望它显示。

问题是......我完全不知道你会怎么做。我知道您可以使用单个值，但我想不出一种简单的方法来测试每个节点。

顺便说一句，这一切都是在 Symphony CMS 的最新稳定版本中完成的。

[编辑] 前两个结果的问题是它们显示 ITEM 节点，我正在寻找的是仅返回具有至少一个匹配的 ITEM 节点的 ENTRY 节点。我不确定任何解决方案如何对此有所帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T18:31:05.677

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
    <xsl:template match="/">
        <xsl:copy-of select="container/entry/item[number(.) &gt;= 9 and number(.) &lt;= 15]"/>
    </xsl:template>
</xsl:stylesheet> 
```

XPath 语句 'container/entry/item' 引用所有匹配项。谓词 [number(.) >= 9 and number(.) <= 15] 减少了该列表。一些 XSLT 操作（例如，xsl:value-of）有一个隐含的过滤器，它只获取第一个值。在这些情况下，您可以使用 xsl:for-each：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
    <xsl:template match="/">
        <xsl:for-each select="container/entry/item[number(.) &gt;= 9 and number(.) &lt; 15]">
            <xsl:value-of select="."/>
        </xsl:for-each>
    </xsl:template>
</xsl:stylesheet> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-18T20:32:08.600

您可以使用`<entry>`匹配的嵌套谓词来完成此操作：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
    <xsl:template match="/">
        <xsl:for-each select="container/entry[item[number(.) &gt;= 9 and number(.) &lt;= 15]]">
            <!-- this will loop over <entry>s which contain <item>s within your range -->
        </xsl:for-each>
    </xsl:template>
</xsl:stylesheet> 
```

该表达式将读作“包含值在 9 到 15 之间的项目的条目”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-18T18:41:11.497

这个怎么样....你可以在for-each循环中做任何你想做的事情，或者你可以只取变量中返回的节点集并在其他地方使用它。

```
 <?xml version='1.0'?>
    <xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:template match="/">
        <!-- Your first param -->
        <xsl:param name="Param1" select="4"/>
        <!-- Your second param -->
        <xsl:param name="Param2" select="9"/>
            <xsl:variable name="ResultNodeSet">
                <xsl:for-each select="/container/entry/item[number(.) &gt;= $Param1 and number(.) &lt;= $Param2]">
                  <!-- What ever else you want to do can go here-->
                  <xsl:copy-of select="."/>
                </xsl:for-each>
            </xsl:variable>  
        <xsl:value-of select="$ResultNodeSet"/>
    </xsl:template> 
    </xsl:stylesheet> 
```

# asp.net-mvc - 我可以在存储库模型中使用它吗？

> ID：1014386
> 
> 赞同：2
> 
> 时间：2009-06-18T18:28:02.703
> 
> 标签：asp.net-mvc, domain-driven-design, repository-pattern

我正在使用 ASP.NET MVC 和存储库模型开发一个项目。我有存储库类和使用这些存储库类的服务。我的问题是：从我的存储库类返回 IQueryable 然后在服务中使用“.Where”和“.OrderBy”生成列表是否正确？如果是，这是最佳做法吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T19:00:56.067

对于初学者：这里没有“正确”或“错误”。这只是最适合您和您正在构建的系统的问题。例如，Rob Conery 使用您所描述的模式创建了一个名为 Storefront 的 ASP.NET 示例应用程序，它引发了一场激烈的战争。大部分讨论围绕存储库模式展开，该模式被认为是 Eric Evans 在他的《[领域驱动设计](https://rads.stackoverflow.com/amzn/click/com/0321125215)》一书中所描述的“原始模式”，并将存储库的接口描述为接受和/或返回实际实例（实例列表），而不是一些查询界面。

理论就这么多了。为您的系统选择什么？我不会直接选择 IQueryable 路由的原因是它实际上将我的一些持久性策略泄漏到客户端层（在这种情况下是服务层）。因为如果您使用 LINQ 从数据库中检索对象到 [数据库访问方法（如 SQL、实体，...）]，则返回 IQueryable 主要是有意义的。只有这样 .Where 或 .OrderBy 才会优化您的查询结果。如果您使用一些数据库访问代码代码来获取完整列表，然后使用 LINQ to Objects 从存储库中公开该列表，这显然没有意义。简而言之：您确实将您的客户端层绑定到您正在使用的基于 LINQ 的数据库访问策略中。

作为一个纯粹主义者，我不希望从我的存储库中将这种与 LINQ 的联系浮出水面，我会选择通过存储库操作的参数提供 where 和 order-by 标准。我可以在存储库中进行所有检索优化，并返回一组干净整洁的域对象。

所以最后归结为：最适合你的就是好的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T18:35:56.433

我不明白为什么这会是一个问题。如果您将在服务层中检索的数据变得更加具体，这意味着在应用程序和数据库之间传输的数据更少——这意味着更高的效率。这样做意味着您还将实现延迟加载，或在绝对需要时获取数据。考虑到网络的无状态，这是一件好事。您不希望检索所有数据以防万一您*使用*它。

换句话说，获取完整的用户列表，简单地选择名字是“Jackolantern”的用户是没有意义的。

**最好的想法是这样的——如果你决定明天从 MSSQL 切换到 MySQL，你是否必须复制业务逻辑？** 如果是这样，那么您正在错误地使用您的存储库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T18:41:28.860

是的，我对返回 IQueryable 的存储库感到非常满意，但有一个警告：一些 Linq 函数并非在所有提供程序中都可用。例如，Single / SingleOrDefault 方法在 Linq to Entities 中不可用。因此，您的服务层可能不得不跳过一些环节，具体取决于您使用的存储库的具体实现。

我通常将存储库类的接口放在领域层，将实际实现放在服务层。

# asp.net - 拒绝访问时 ASP.NET 成员身份重定向用户

> ID：1014389
> 
> 赞同：0
> 
> 时间：2009-06-18T18:28:31.203
> 
> 标签：asp.net, redirect, membership

当她/他由于 ASP.NET 成员身份的角色而被拒绝访问页面时，我想将用户重定向到自定义错误页面。我认为这可以通过 web.config 文件的 customErrors 部分解决，但我尝试过的错误都没有发现它。

换句话说，如果用户具有“项目焦点”角色访问权限，并尝试访问仅对“管理员”角色中的用户授权的页面，我希望 ASP.NET 将此用户重定向到一个特殊页面，其中我可以记录错误并帮助用户。

这听起来像是一个简单的要求，但我的谷歌搜索都没有找到答案。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T18:37:03.313

你的答案就[在这里](http://www.codeproject.com/KB/aspnet/Custon401Page.aspx)

它有一个很好的解释，以及为什么在这种情况下必须使用 Application_EndRequest。

# javascript - 这两种执行风格有什么不同？

> ID：1014391
> 
> 赞同：0
> 
> 时间：2009-06-18T18:29:09.970
> 
> 标签：javascript, dom

1.

```
<div id="test"></div>
<script type="text/javascript">
//operate document.getElementById('test')
</script> 
```

2.

```
<div id="test"></div>
<script type="text/javascript">
window.onload = function()
{
  //operate document.getElementById('test')
};
</script> 
```

我们可以通过将javascript放在它下面来确保document.getElementById（'test'）存在吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-18T18:34:35.110

在我的主观测试中，它总是这样工作，是的。DOM 在页面上按从上到下的顺序进行解析，因此如果您的脚本标记低于您定位的元素，它将按顺序加载并工作。

window.onload 在您的脚本位于文件头部、从外部文件加载或者可能不适合内联在页面中的情况下很有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T19:57:08.500

[http://developer.yahoo.com/yui/event/#onavailable](http://developer.yahoo.com/yui/event/#onavailable)

YUI 允许您为 onAvailable、onContentReady 和 onDOMReady 定义事件处理程序，而不是 window.onload

这些方法将在 window.onload 触发之前执行

此外，onDOMReady 对于这样的代码来说是一个更安全的地方，因为它可以防止 IE6 中的一些错误发生。在 DOM 仍在构建时添加 DOM 节点可能会导致 IE 中的一些模糊错误。

```
<script type="text/javascript">

 function init() {
    //operate document.getElementById('test')
 }
 YAHOO.util.Event.onDOMReady(init);

 // As with addListener, onAvailable, and onContentReady, you can pass a data object and adjust the scope
 // YAHOO.util.Event.onDOMReady(init, data, scope);

 </script>
 <div id="test"></div> 
```

# vb.net - 检测用户存在

> ID：1014392
> 
> 赞同：3
> 
> 时间：2009-06-18T18:29:25.617
> 
> 标签：vb.net, winapi

我想做的是检测用户是否正在积极使用运行 Windows（2000 或更高版本）的计算机。最好，我想在不使用屏幕保护程序的情况下做到这一点。

背景：我们有一个客户服务部门，它位于寻线组中，可以“可用”或不可用。如果他们是“可用”的呼叫将被路由到他们的电话，而不是坐在队列中。当电话在分机上振铃时，呼入的呼叫者听到“振铃”的声音而不是保持音乐。不幸的是，我们也有代表在去吃午饭或离开一天时忘记将自己从“可用”中取出。

最终结果可能会使用 .NET 编写

有什么想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-18T19:47:24.073

API [GetLastInputInfo](http://msdn.microsoft.com/en-us/library/ms646302(VS.85).aspx) () 应该用于此。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-18T18:59:53.260

如果用户锁定了他们的工作站，或者如果组策略在空闲时间后强制锁定屏幕，您可以使用 Windows API 使用[WTSRegisterSessionNotification](http://msdn.microsoft.com/en-us/library/aa383841(VS.85).aspx)和[WTSUnRegisterSessionNotification](http://msdn.microsoft.com/en-us/library/aa383847(VS.85).aspx)订阅“会话通知”事件。一旦您要求 Windows 让您的应用程序知道会话已锁定，您可以将其用作用户不存在的指示。

好读： http: [//support.microsoft.com/kb/310153](http://support.microsoft.com/kb/310153)

例子：

```
private const int NOTIFY_FOR_THIS_SESSION = 0x0;
private const int WM_WTSSESSION_CHANGE = 0x2B1;
private const int WTS_CONSOLE_CONNECT = 0x1;
private const int WTS_CONSOLE_DISCONNECT = 0x2;
private const int WTS_SESSION_LOCK = 0x7;
private const int WTS_SESSION_UNLOCK = 0x8;
private const int WM_DESTROY = 0x2;
private const int WM_ACTIVATEAPP = 0x1C;

// The WTSUnRegisterSessionNotification function unregisters the specified 
// window so that the specified window receives no more session-change notifications.
[DllImport("Wtsapi32.dll")]
private static extern bool WTSUnRegisterSessionNotification(IntPtr hWnd);

// The WTSRegisterSessionNotification function registers the specified 
// window to receive session-change notifications.
[DllImport("Wtsapi32.dll")]
private static extern bool WTSRegisterSessionNotification(IntPtr hWnd, Int32 dwFlags);

// The PostQuitMessage function indicates to the system that a thread 
// has made a request to quit. The PostQuitMessage function is typically used in 
// response to a WM_DESTROY message.
[DllImport("user32.dll")]
private static extern void PostQuitMessage(Int32 nExitCode);

[DllImport("user32.dll", CharSet = CharSet.Auto)]
public static extern IntPtr PostMessage(HandleRef hwnd, int msg, int wparam, int lparam);

private void Unsubscribe() {
   if (this.Handle != IntPtr.Zero) {
      WTSUnRegisterSessionNotification(this.Handle);
   }
}

private void Subscribe() {
   if (this.Handle != IntPtr.Zero) {
      WTSRegisterSessionNotification(this.Handle, NOTIFY_FOR_THIS_SESSION);
   }
}

// override WndProc in order to catch process the Session-Notification events:
protected override void WndProc(ref Message m) {
   switch (m.Msg) {
      case WM_WTSSESSION_CHANGE:
         switch (m.WParam.ToInt32()) {
            case WTS_CONSOLE_CONNECT:
               // User-switch : Sign-on
               break;
            case WTS_CONSOLE_DISCONNECT:
               // User-switch : Sign-off
               break;
            case WTS_SESSION_LOCK:
               // Screen Lock
               break;
            case WTS_SESSION_UNLOCK:
               // Screen Unlock
               break;
            default:
               break;
         }
         break;
      default:
         break;
   }

   base.WndProc(ref m);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T18:36:19.757

看看[SetWindowsHookEx](http://msdn.microsoft.com/en-us/library/ms644990(VS.85).aspx)和 WH_FOREGROUNDIDLE 类。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-18T18:32:39.170

您可以使用 Windows API 添加一个低级键盘/鼠标挂钩，然后在一段时间内没有活动时标记为离开，然后在活动再次开始时标记为可用。

[http://www.codeproject.com/KB/cs/globalhook.aspx](http://www.codeproject.com/KB/cs/globalhook.aspx)对此有所了解，但它在 C# 中。

# java - 将 != 与计数器控制的循环一起使用

> ID：1014396
> 
> 赞同：6
> 
> 时间：2009-06-18T18:30:21.123
> 
> 标签：java, c++

今天的最后一个问题......我明天会回来......我有很多事情要跟进......

我正在查看 Reilly Java 文本 - 谈论计数器控制的循环模式..（不管什么语言..）

计数器控制循环（for、while 等）和嵌套循环的作者......使用 != 进行测试......现在我意识到 != 用于具有事件控制循环的某些情况，如哨兵或 EOF 类型循环——但对我来说——将它与计数器控制的循环一起使用是一个坏主意……很容易出错……

例子：

```
x = 0;
while (x != 100) {
   y = 0;
  while (y != 100) {

   ...
   y++;
 }
  x++;
} 
```

直接说......使用其他关系运算符会更好......

```
x = 0;
while (x < 100) {   //or even better some defined constant...
   y = 0;
  while (y < 100) {

   ...
   y++;
 }
  x++;
} 
```

据我所见，这通常是 texts..classes.etc 中呈现的方式。

再一次 - 你会认为这很糟糕 - 还是只是一种不同的方式......谢谢......

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-18T18:37:42.640

您希望循环条件与所需的后置条件完全相反。

```
i= 0;
while( i != 100 ) {
    i += 1;
}
assert i == 100; 
```

您可以轻松地看到循环后置条件与循环终止条件完全匹配。没有奥秘。

此外，您可以从初始条件和正文证明它将达到 100，而不会“以某种方式”神奇地跳过一个值。

如果你有一个非常复杂的循环体，那么简单的并行结构是必不可少的。

如果您使用[最弱前置条件技术](http://en.wikipedia.org/wiki/Predicate_transformer_semantics)从后置条件派生循环，则循环条件将是如上所示的简单匹配条件。

这`i < 100`是一个坏主意，因为您的循环可能有一个不正确的主体，它严重地增加了变量并且仍然“似乎”工作。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-18T18:33:53.457

我只会用

```
while (x != 100) 
```

*如果我希望循环在 x正好*为 100时终止。所以在绝大多数情况下，我会使用

```
while (x < 100) 
```

这对于计数器控制循环更为常见。

编辑：再想一想，我总是在反控制循环中使用 for 语法，所以这个例子应该是

```
for(int i=0; i < 100; ++i) 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-06-18T18:45:15.140

使用`<`在 Java 中更为常见。现代 C++ 使用`!=`.

`!=`更有可能在您的代码中发现错误。在大多数情况下，这是一件好事。如果由于某种原因计数器不仅达到而且超过了界限（通常在第一次迭代中），那么主体将以非法值执行。只要循环体没有隐藏错误，你就会得到一个异常。如果主体隐藏了错误，则循环将执行数十亿次，并且应该很明显存在错误。

例如，去年在 Adob​​e Flash 的实现中发现了一个有趣的漏洞。用作数组的指针可能会被初始化为`null`. 通常不是问题——只要第一次取消引用，进程就会安全地崩溃。但是，使用了一个循环`<`，允许主体永远不会执行，然后允许执行继续。之后，可以在攻击者指定的位置写入内存。因为 的值`null`总是`0`，所以攻击者确切地知道正在写入哪些内存位置。如果循环使用了`!=`.

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-06-18T18:48:25.947

正如其他答案所示，
`while(i < 100)`是安全`*`的，
`while(i != 100)`是精确的`**`。

顺便说一句，您可能想尝试`while(i++ < 100)`或`for(i = 0; i < 100; ++i)`代替您展示的更简单的 while 循环——忘记在循环结束时增加计数器是一个真正的痛苦。请注意，如果`i=0`,`i++`将等于 0，然后在下一次递增 i，并且`++i`将递增 i 然后等于 1，因此对于`while(i++ < 100)`，后缀 ++ 运算符是必要的。

另请注意，如果`i`在条件中进行测试时为 0，那么它将在循环体中为 1（对于 while 示例），因此 if`i`是数组或其他内容的索引，而不仅仅是跟踪循环迭代，你最好只坚持一个 for 循环（每次迭代后递增 i ）。

* * *

`*`: 安全在这里意味着不太可能进入无限循环。它也是不安全的，因为它可以隐藏潜在的错误，如果循环不是微不足道的

`**`: 确切地说，如果它没有完全按照你的预期去做，它就会失败，你会注意到。其他一些答案也描述了如何在这种循环中更多地保护您免受错误的影响。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-06-18T18:51:23.600

使用 "!=" 而不是 "<" 的主要优点是有些事情会失败，它应该会失败**big**。

例如，如果某处的错误导致 x 进入设置为 110 的循环，`x < 100`则将永远不会进入循环 --- 您在调试时可能会错过这一事实。OTOH，如果您使用`x!=100`，它将永远不会退出循环——调试中不能缺少的东西。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-06-18T18:47:15.120

我认为 < 不一定比 != 为您提供更多保护。如果您遇到的情况`i`是以您未预料到的方式递增，您应该抛出异常，而不是用 < 将其扫在地毯下。

例如，如果你真的担心你的 while 循环搞砸了，你可以这样做：

```
x = 0;
while (x != 100) 
{
   assert x >= 0;
   assert x < 100;

   y = 0;
   while (y != 100) 
   {    
     assert y >= 0;
     assert y < 100;

     ...
     y++;
   }
   x++;
} 
```

这样一来，当你的循环越界时，你的程序就会立即死掉（早早崩溃，经常崩溃），你就知道你的代码已经搞砸了。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-06-18T19:59:10.697

我怀疑这可能与 C++ 迭代器有关。

如果您使用整数或指针，`<`则具有明确定义的含义。如果您在循环中使用 C++ 迭代器，`<`则可能没有定义，或者可能难以计算。

例如，在遍历列表时，C++ 方式将是：

```
for(std::list<foo>::const_iterator i = bar.begin(); i != bar.end(); ++i) 
```

实际上，查看 i 是否在 bar.end() 之前的唯一方法是无限增加 i 并查看它是否等于 bar.end()。

始终以同样的方式做一些小事是有相当大的价值的。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-18T18:32:51.913

我相信它们在语义上是相同的，唯一的区别是 != 大于 100 的数字显然也会满足条件，因为 < 将阻止任何大于 100 的数字通过。

但是，在给定的情况下，两个运算符将产生相同的输出。现在，如果 x 和 y 变量以某种方式在该代码之外被作用，“<”将是确保在 100 处存在截止值的更好方法，即使它们以 90 的值输入，并且无法如果他们以 4000 的值输入，则继续。显然，您当时所做的事情的意图将决定您选择哪个运算符，通常有几种方法可以达到相同的结果，而不总是一种“正确”的方式。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-18T18:36:50.113

是的。它们在语义上是相同的。

使用“<”运算符的第二种语法是人们在这种情况下通常使用的语法，并且看起来更直观（因为变量的值在循环中递增）。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-06-18T18:34:23.283

最好在循环中使用小于 <。代码中的错误可能会导致计数器增加两次。这意味着循环会突然变成一个无限循环（或者直到你吹出 MAXINT ）。

# version-control - 从一种源代码控制工具过渡到另一种。请指教？

> ID：1014410
> 
> 赞同：0
> 
> 时间：2009-06-18T18:32:54.660
> 
> 标签：version-control, perforce

最近有人告诉我，我必须将我们的 Perforce 存储库迁移到 TrueChange [(McCabe TrueChange)](http://www.mccabe.com/cm.htm)。在那之前我还没有听说过 TrueChange。到目前为止，我已经使用过 cvs、subversion、vss 和 perforce。我正在努力寻找任何明智的说法来进行这种转变以及对 TrueChange 的期望。我喜欢与 Perforce 一起工作，我发现过渡到它相当简单。

你能帮我吗？我正在使用 VS2005、RAD 和 CruiseControl。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-20T02:19:04.490

自 1999 年 9 月以来，我一直在使用 TRUEchange，我认为您很幸运，您被告知必须从 Perforce 迁移到 TRUEchange。

我曾使用过许多开源、本土和商业 CM 软件系统，而且到目前为止，TRUEchange 是我用过的最好的产品。

让 TRUEchange 如此出色的四件事（不止四件事——这些是四个关键）：

1.  **基于更改集而不是基于文件差异**. 如果将 50 个文件作为一个组签出、修改然后重新签入，则对这 50 个文件的更改是一个称为更改集的单元。TRUEchange 比我用过的任何 CM 软件都能更好地处理并发并行基线。Cset 可以迁移到编号较低的基线或迁移到编号较高的基线。迁移/合并冲突很少见，客户端内置了 3 路合并工具，允许用户非常轻松地处理冲突。更改集可以从特定版本中删除（以任何顺序）并且可以重新添加。如果在 5 个不同的更改集中对文件进行了 5 次更改，则可以删除第二个更改，同时保留更改 1、3、4和 5 完好无损。它还保留完整的元数据，以支持将文件从一个目录移动到另一个目录、重命名文件或重命名目录。可以删除文件，并且有一个更改集可以删除该文件。由于删除文件的更改集保留了文件的文件 ID、文件名和父目录，因此可以随时恢复文件，而无需再次将它们加载到系统中。恢复文件时会恢复更改历史记录。

2.  **基于项目版本而不是基于文件版本**. 当一个版本被检查点（类似于标记）时，整个项目中所有文件的内容都被记录为一个单元。您不必跟踪 5000 个文件的各个版本号，您只需跟踪包含这些文件的项目的检查点。维护已为 QA 或部署构建的内容的历史记录“非常简单”，因为不必跟踪文件版本。TRUEchange 使用构建配置将相关项目组合在一起，以及文件在构建过程中提取到的文件路径 - 在 Unix/Linux、Windows 或 VMS 文件系统上。我们使用三段版本号，例如 2.1.0。版本的第一个构建（或迭代）将是 2.1.0.1。第二个是 2.1.0.2 等等。当我们运行构建并完成时，我们获取构建配置的详细信息并将数据插入到两个数据库表中。一张表包含构建配置级别信息，例如构建配置名称、主要版本号、次要版本号、子版本号、迭代、描述性标题、构建类型（QA 或生产）以及完成日期和时间。另一个表包含指向第一个表中构建配置级别行的外键，并包含项目名称、主要版本号、次要版本号、子版本号和用于运行构建的检查点的迭代。通过构建配置级别信息和项目级别信息，我们可以查询数据库并立即了解任何构建运行的确切内容。我们目前有自 2001 年 9 月以来的构建历史 - 将近 33 个，500 个构建和超过 228,000 个子记录。在一两分钟内，我可以为过去 8 年中的任何构建运行重新创建源目录结构，并且知道它绝对准确并且与最初的构建运行相同。如果我必须使用基于文件版本的 CM 系统来做到这一点，那么重新创建任何给定的构建都需要很长时间。

3.  **命令行命令、Windows GUI、Java GUI 客户端 (StreamCM)、可定制性和可靠性**. TRUEchange 具有大量命令行命令，可实现高度自动化。使用 shell 脚本和 PHP，我们已经能够开发完全自动化的构建周期和定制的 Web 界面，供开发人员与 CM 系统交互。开发构建作为配置管理用户运行，从 TRUEchange 检索文件是从网页运行的。这保证了工程师签入的代码将在 CM 运行时构建。StreamCM 可在多种平台上运行 - Unix（Solaris、AIX、HP-UX、Irix 等）、Linux（Red Hat、Fedora、Gentoo 等）、Windows（XP、Vista）和 MacOS（PPC 和 Intel） ）。这个统一的界面允许开发人员使用多个平台，并让客户端的行为与操作系统无关。TRUEchange 可以使用他们的脚本语言进行高度定制。我们定制了 TRUEchange 以与在 PostgreSQL 下运行的 CM 数据库进行交互，因此基于 Web 的应用程序可以从数据库中读取元数据，而不是查询 CM 系统。我们还定制了 TRUEchange，以便通过与 Oracle 数据库的连接与 Mercury Interactive Test Director 中的问题跟踪系统进行交互。它非常可靠。在将近 10 年的时间里，由于磁盘错误，我们遇到了一次需要返回备份的存储库故障。由于 TRUEchange 维护针对每个存储库发布的事务，我们能够按照最初应用的确切顺序重放修改存储库的事务。这是一个很少使用的存储库，但只需要 10 分钟就可以重播三天内的所有交易。我们拥有超过 200 个用户许可证，并且我们从未有超过两名 CM 工程师来支持用户群。2008 年，我和另一位 CM 工程师执行了 6300 多个 QA 构建，并为生产部署创建了 1800 多个部署映像。与我曾经使用过的任何其他 CM 系统相比，TRUEchange 需要的管理要少得多 - 幅度很大。另一个优点是 McCabe 愿意根据客户的需求改进产品。多年来，我们要求进行许多改进，他们几乎满足了每一个要求，超出了我们的预期。TRUEchange 的另一个优点是它被设计为在分布式环境中运行。许可证管理器控制对系统的访问并跟踪存储库实际运行在哪些服务器上。我们有一个许可证服务器和四个运行 97 个存储库的 Linux 服务器。如果我们需要添加服务器来容纳额外的存储库，只需启动这些服务器、创建存储库（或将现有存储库移动到新服务器）、重新创建启动和停止脚本（通过自动化过程）和在新服务器上启动存储库。无需客户干预。我们管理着近 5200 万行源代码和二进制文件（如 gif 文件、jpeg 文件等）。重新创建启动和停止脚本（通过自动化过程）并在新服务器上启动存储库。无需客户干预。我们管理着近 5200 万行源代码和二进制文件（如 gif 文件、jpeg 文件等）。重新创建启动和停止脚本（通过自动化过程）并在新服务器上启动存储库。无需客户干预。我们管理着近 5200 万行源代码和二进制文件（如 gif 文件、jpeg 文件等）。

4.  **巡航控制插件**。随着最新版本的软件，McCabe 开发了一个 CruiseControl 插件，允许 TRUEchange 集成。我们目前还没有使用 CruiseControl，因为我们的软件非常复杂，具有许多相互依赖关系。这不是 TRUEchange 的缺点，而是 CruiseControl 的缺点。它似乎最适合不严重依赖其他系统的独立系统。

为了轻松地从另一个 CM 产品迁移到 TRUEchange，它只是掌握面向项目与面向文件的概念，然后设置存储库以满足安全要求（谁可以访问什么以及在什么级别）和逻辑项目组织软件系统。如果存储库和项目设置正确，只需将文件从旧的 CM 系统中提取出来，然后将它们批量加载到 TRUEchange 项目中即可。

# asp.net-mvc - 从自定义身份验证迁移到 Open ID

> ID：1014411
> 
> 赞同：7
> 
> 时间：2009-06-18T18:33:07.030
> 
> 标签：asp.net-mvc, openid

有人对从基于单独自定义数据库的身份验证迁移到 Open ID 有任何建议吗？就像陷阱和陷阱。我真的很想为那些不喜欢/不喜欢 OpenID 的人提供这两者。这是一个 ASP.Net MVC 应用程序的记录。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-18T18:44:00.477

实际上你可以很容易地使用 OpenID。只要您断开帐户/个人资料数据与实际登录机制的连接，您在技术上应该能够使用其中之一或无缝地使用。然后，您可以保留一个登录表，该表可以保存那些不喜欢使用 OpenID 方案的用户的用户名和（加密）密码。然后将您的登录详细信息（用户上次登录时间等）保存在 Accounts 表中，以便您可以让用户使用您的本地登录系统或 Open ID 样式 API 登录的各种提供商。然后，您可以创建各种类来处理通过本地系统登录、通过 Gmail 登录、通过 Open ID 登录等的管道细节。然后让所有这些类符合相同的接口。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-18T18:54:35.203

我建议不要停止支持您当前的身份验证方法，而是将 OpenID 帐户与您当前的用户表相关联。

我最近在我的网站上做了这个，它完美无缺。

[这是 Plaxo 过程的一个很好的概述。](http://www.plaxo.com/api/openid_recipe)

# javascript - 图像不会在 Internet Explorer 中显示为链接

> ID：1014413
> 
> 赞同：1
> 
> 时间：2009-06-18T18:33:17.763
> 
> 标签：javascript, html, css, internet-explorer, hyperlink

我正在设计一个结合 CSS 和 JavaScript 效果的菜单栏。它由带有文本的大图标组成，当鼠标悬停在上面时会出现。它将部署在 Intranet 上，因此只需在 IE 7、8 和 Firefox 中运行。当然，Firefox 似乎执行了我直觉认为的 HTML 应该看起来的样子，显示带有大点击区域的大块链接。然而，IE7 显示的块链接类似于 Javascript 的链接并正确悬停（在我通过添加透明背景图像破解它之后），但是当我单击它时不提供手指光标或跟随 href。

有趣的是，图像周围的链接区域确实有手指光标，但是一旦我将图像悬停，它就会变回箭头。

```
<div id="navigation">           
<ul>
<li><a href="#" onMouseOver="vtoggle('txtHome');" onMouseOut="vtoggle('txtHome');">
<span class="icon"><img src="iconImage.png" alt="Home" /></span>
<span class="icontxt" id="txtHome" style="visibility:hidden;">Home</span>
</a></li>
...
</ul>
</div>

<script type="text/javascript">
function vtoggle(x) {
    if (document.getElementById(x).style.visibility == 'hidden') {
        document.getElementById(x).style.visibility = 'visible';
    } else {
        document.getElementById(x).style.visibility = 'hidden';
    }
}
</script>

#navigation{
margin:0px auto;
padding:0px;
padding-left:10px;
height:64px;
list-style:none;
}
#navigation li{
float:left;
clear:none;
list-style:none;
}
#navigation li a, #navigation li a:link{
color:#fff;
display:block;
font-size:12px;
text-decoration:none;
padding:8px 18px;
margin:0px;
margin-left:-20px;
width:80px;
height:64px;
background:url(../images/transparent.gif);
}
#navigation li a:hover{
background:url(../images/glow.png);
background-repeat:no-repeat;
background-position:10px -2px;
}
.icon{
float:left;
width:100%;
text-align:center;
}
.icontxt{
float:left;
font-size:10px;
color:white;
font-weight:bold;
clear:left;
text-align:center;
width:100%;
margin-top:-1px;
} 
```

任何帮助深表感谢。

-- 编辑 -- 我解决了我的问题（我将在下面发布答案以符合惯例）但我仍然想听听为什么 IE 不允许

```
<a href="#"><span><img /></span></a> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T18:50:14.007

我解决了这个问题。我不得不删除图标周围的 SPAN 标签。

这是我的新 HTML 代码：

```
<li><a href="#" onMouseOver="vtoggle('txtHome');" onMouseOut="vtoggle('txtHome');">
<img src="images/webapp48/profile.png" alt="Home" />
<span class="icontxt" id="txtHome" style="visibility:hidden;">Home</span>
</a></li> 
```

我将 span 标签中的一些 CSS 移到了 link 标签中以保留格式。现在它可以正常工作了，但我仍然不明白为什么 SPAN 标签会禁用链接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-30T01:43:55.730

确保您的 SPAN 未设置为 BLOCK。同样的事情发生在我身上。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-06-18T18:43:36.750

如果您只担心光标，并且链接本身有效，您可以使用 CSS 添加它：

```
cursor: hand; 
```

希望这可以帮助！

# c# - 性能：在堆栈上调用 reverse 或将项目弹出到数组中更快

> ID：1014422
> 
> 赞同：1
> 
> 时间：2009-06-18T18:34:44.923
> 
> 标签：c#, performance

我想知道哪个实现会有更好的性能：

我需要清除堆栈中的所有项目，除了头部的前 10 个项目。

然后必须将这 10 个按原始顺序放入堆栈中。

我想到了两种方法

首先：

```
FilterRecord[] records = new FilterRecord[10];

       for (int i = 0; i < records.Length; i++)
       {
           records[i] = _InternalCollection.Pop();
       }

       _InternalCollection.Clear();

       for (int i = records.Length - 1; i >= 0; i--)
       {
           _InternalCollection.Push(records[i]);
       } 
```

第二：

```
int count = _InternalCollection.Count - 10;
               _InternalCollection.Reverse();

               for (int i = 0; i < count; i++)
               {
                   _InternalCollection.Pop();
               }

               _InternalCollection.Reverse(); 
```

欢迎任何帮助或指导方针或其他障碍。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T18:39:01.140

你的第一个算法有两个 for 循环，所以 O(2N)。您的第二种算法有一个 for 循环，但我们必须假设内部 Reverse() 是一个 O(N) 操作，所以它是 O(3N)。

我不确定您的第一个算法中的 Clear() 调用是 O(N) 还是 O(C)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-18T18:42:29.903

这取决于。你可以做两件事：

*   通过运行它进行几百次迭代来测试它（根据大小不同或更多）
*   看看他们的实现

分析实现堆栈的方法（从概念上），**使用 reverse 将是最慢的，因为它必须弹出堆栈的所有内容，然后**以相反的顺序将它们弹出回。如果在内部，它只是选择从哪里开始弹出的不同起始索引，它可能会更快。

无论哪种方式，简单地说，使用 Reverse() 似乎效率低下，因为您执行该操作两次。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-18T18:44:52.300

如果堆栈中的项目很少，那么差异就会很小，不值得优化。

如果堆栈中有很多项目，这将是最快的：

```
FilterRecord[] records = new FilterRecord[10];

for (int i = 0; i < records.Length; i++) {
   records[i] = _InternalCollection.Pop();
}

_InternalCollection = new Stack<FilterRecord>();

for (int i = records.Length - 1; i >= 0; i--) {
   _InternalCollection.Push(records[i]);
} 
```

即，在你得到你想要保留的项目后，扔掉当前的堆栈，让垃圾收集器来处理它。如果您使用 Clear 方法，这将从堆栈中删除引用，但它会保留它的容量。

因为无论堆栈中有多少项，您只触摸十个项目，这是一个 O(1) 操作而不是 O(n) 操作。

（请注意，声明数组时使用数组的大小，而不是最高索引。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-18T18:38:03.140

这取决于，您假设 Reverse() 方法并没有完全做到这一点。只有两种方法可以知道：1.) 运行您的代码并告诉我们 2.) 查找 Reverse() 的实现。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-18T18:41:24.240

通常很难说出这些类型的事情。只需制作一个非常大的筹码，同时跟注并计时。那你就知道了。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-18T18:43:09.137

我建议看一下 Reverse() 的实际实现——你可能会发现[.Net Reflector](http://www.red-gate.com/products/reflector/)对此很有用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-18T18:46:18.553

我认为避免将项目从堆栈中弹出将比您建议的两种方法之间的替代方案更能提高代码的性能。我建议使用 linq 为堆栈中最后一项的内容分配一个新堆栈，如下所示：

```
var newStack = new Stack<FilterRecord>( 
   _InternalCollection.Take( 10 )
                      .Reverse() );

_InternalCollection = newStack; 
```

如果你不使用泛型，你可以对内置的迭代器做同样的事情：

```
var iterator = _InternalCollection.GetEnumerator();
int i = 9;
while( iterator.MoveNext() && i-- >= 0 )
{
   newStack.Push( iterator.Current );
}
_InternalCollection = newStack; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-18T18:51:58.483

首先不使用堆栈怎么样？包装一个 LinkedList 然后使用 RemoveLast 方法来做你需要的怎么样？

一些粗略的代码，需要更多的工作，但你得到了基本的想法：

```
 public class CustomStack<T>
    {
        private LinkedList<T> list;

        public CustomStack()
        {
            list = new LinkedList<T>();
        }

        public void Push(T item)
        {
            list.AddFirst(item);
        }

        public T Pop()
        {

            var result = list.First.Value;
            list.RemoveFirst();
            return result;
        }

        public void TrimLast(int amountToLeave)
        {
            while (list.Count > amountToLeave)
            {
                list.RemoveLast();
            }
        }
    } 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-18T19:43:57.107

我认为您几乎可以指望 Double reverse 变慢。就 _InternalCollection.Length （假设 Clear 是恒定时间）而言，您 1) 的运行时间是恒定的 (O(1))，就您要保留的元素数量而言是 O(n)。2) 会变慢，线性越大 _InternalCollection 是 (O(n))

您可能还需要考虑将 _InternalCollection 更改为 Deque（双端队列）。Deque 支持 O(1) 摊销时间从任一端添加/删除项目。当然（AFAIK）没有标准实现，所以你必须自己动手或[使用第三方实现](http://www.codeproject.com/KB/recipes/deque.aspx)。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-06-18T21:06:10.280

`memcpy`堆栈上的最后 10 个项目到您想要的位置。

然后将堆栈声明为 10 项长。

# objective-c - 在为多个版本编译时，如何包含对仅存在于一个操作系统版本中的方法的调用？

> ID：1014427
> 
> 赞同：0
> 
> 时间：2009-06-18T18:35:50.287
> 
> 标签：objective-c, macos, cocoa, osx-leopard, osx-tiger

我有一个应用程序正在编译，其最低系统要求为 Tiger (OS X 10.4)，但如果应用程序在 Leopard (OS X 10.5) 上执行，我需要包含一些代码来处理 Spaces。

我该怎么做呢？

（我需要打的电话是`-[NSWindow setCollectionBehavior:]`）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-18T18:40:28.890

1.  将您的 Base SDK（针对您正在构建的目标的所有配置）设置为包含调用的操作系统版本。
2.  将部署版本设置为您希望代码启动的最早操作系统。
3.  对于早期版本的操作系统中不存在的所有调用，您必须在调用之前进行测试，方法是使用 respondsToSelector:（用于方法）或针对 nil 进行测试（用于函数和静态）。如果您愿意，可以检查操作系统版本，但检查特定调用更为可靠。

[Cross-Development Programming Guide](http://developer.apple.com/documentation/DeveloperTools/Conceptual/cross_development/index.html)详细描述了这些技术。

# html - 具有两行文本的表格行

> ID：1014432
> 
> 赞同：0
> 
> 时间：2009-06-18T18:36:52.500
> 
> 标签：html, css, html-table

我有两张桌子并排。我需要将行对齐，但有时由于页面上的宽度限制，内容可能比表格行长，它会中断并形成两行表格行。

是否可以制作像双行这样可以容纳两行文本的东西，所以无论内容是 1 行还是 2 行，所有内容都排成一行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T12:23:07.650

你可以解决这两种方法，一种是像你建议的那样创建具有固定高度的行，另一种解决方案是创建一个有 3 列的大表，在其中删除中间列的边框，使其看起来像 2 个表。

您要求的解决方案可能如下：

```
<style>
td { vertical-align: top; }
td div { height: 40px; overflow: hidden; }
</style>
<table width="400">
  <tr>
    <td><div>short content</div></td>
    <td><div>long content long content long content long content</div></td>
    <td><div>long content long content long content long content</div></td>
  </tr>
  <tr>
    <td><div>long content long content long content long content</div></td>
    <td><div>short content</div></td>
    <td><div>long content long content long content long content</div></td>
  </tr>
</table> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T18:40:24.023

您可以为表格行或单元格添加（最小）高度（尽管它在 IE6 等旧浏览器中不起作用），例如：

```
tr {
   min-height: 2em;
} 
```

或者

```
tr {
   min-height: 24px;
} 
```

如果您需要它在 IE6 中同样工作，您可以添加 'height: ...' 来代替。

希望这可以帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T18:40:50.093

给 TD 高度：2.5em 左右（你必须使用这个值，取决于其他参数，如你使用的边距/填充/行高。

# joomla1.5 - 用户在 Joomla 中创建的组

> ID：1014434
> 
> 赞同：0
> 
> 时间：2009-06-18T18:37:03.157
> 
> 标签：joomla1.5

我正在寻找一种方法让我网站上的某些用户能够创建组并邀请其他用户加入他们的组。在这些群组中，用户只能看到他们的群组成员文章和其他群组内容。如果您不在群组中，您将只能看到公共内容，但一旦您加入群组，您将能够看到他们的文章、菜单和其他内容。您应该能够属于许多组，但只能通过邀请。

有谁知道此功能的扩展或解决方案？

我正在使用 Joomla 1.5

最好的祝福

尼克拉斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T18:45:37.963

我会查看[Community Builder](http://www.joomlapolis.com/)。从文档：

“为您的会员提供额外的特权和可做的事情。让他们为您的网站创建内容。个人博客、图片库、论坛集成（内置 Kunena 支持）、会员组（使用 GroupJive 组件和插件）以及更多其他 CB 插件添加更多特性和功能。”

顺便说一句，它是 1.5 原生的。

Groupjive 可以在[这里](http://www.groupjive.org/)找到，它只允许邀请组。

# c# - ASP.NET 异常“线程被中止”导致方法退出

> ID：1014439
> 
> 赞同：23
> 
> 时间：2009-06-18T18:37:50.283
> 
> 标签：c#, .net, asp.net

在下面的代码中，有时会`someFunctionCall()`产生异常：

> 威胁已经被清除了。

为什么代码块 B 中的代码永远不会运行？ASP.NET 是否为每个方法调用启动一个新线程？我惊讶地发现，当这个异常发生时，块 B 中的代码永远不会运行，方法返回，我的应用程序继续运行。有人可以解释一下吗？

```
public void method()
{
     // CODE BLOCK A
     //...    

     try 
     {
         someFunctionCall(); // this call is generating thread abort exception
     }
     catch(Exception ex)
     {
         // log exception message
     }

    // CODE BLOCK B
    // ...    
} 
```

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-06-18T18:44:08.497

这是一个`ThreadAbortException`；这是一个特殊的异常，会在每个 catch 块结束时自动重新抛出，除非你调用`Thread.ResetAbort()`.

ASP .Net 方法，如`Response.End`or `Response.Redirect`（除非您通过`false`）抛出此异常以结束当前页面的处理；您`someFunctionCall()`可能正在调用其中一种方法。

ASP .Net 本身处理此异常并调用`ResetAbort`以继续处理。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-08-19T10:35:17.667

要变通解决此问题，请使用下列方法之一： 对于`Response.End`，调用该`HttpContext.Current.ApplicationInstance.CompleteRequest`方法而不是`Response.End`绕过`Application_EndRequest`事件的代码执行。

对于`Response.Redirect`，使用重载，`Response.Redirect(String url, bool endResponse)`为参数传递 false`endResponse`以抑制对 的内部调用`Response.End`。例如：

```
Response.Redirect ("nextpage.aspx", false); 
```

如果您使用此解决方法，`Response.Redirect`则会执行以下代码。对于`Server.Transfer`，请改用该`Server.Execute`方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-11-17T18:06:05.993

对我有用的是增加 IIS 上应用程序池的“空闲超时（分钟）”属性。

我将其设置为最大值“43200”。

我还调整了回收设置...

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-12-25T06:28:19.817

试试这种方式：

**这是我的扩展方法：**

```
 public static void WriteJSONObject(this HttpResponse response, object content) {
            response.ContentType = "application/json";
            response.Write(new JavaScriptSerializer().Serialize(content));
            response.End();

 } 
```

**和逻辑：**

```
public void RegisterUser() {
    try {
        Response.WriteJSONObject(new { Result = "See hello" });
    } 
    catch (Exception err) {
        if (err.Message != "Thread was being aborted.")
            Response.WriteJSONObject(new { Result = err.Message });
        else {
            Response.End();
        }
    }
} 
```

# c++ - 如何判断对象是在构造函数上静态分配还是动态分配？

> ID：1014440
> 
> 赞同：1
> 
> 时间：2009-06-18T18:37:51.377
> 
> 标签：c++, constructor, memory-management

> **可能重复：**
> [检测动态分配的对象？](https://stackoverflow.com/questions/7434062/detect-dynamically-allocated-object)

我有一个对象需要稍微不同的构造，无论它的实例是静态分配还是动态分配。该对象应该只有一个默认构造函数。因此，拥有两个构造函数，每种情况一个，并让用户显式选择正确的构造函数是不可能的。

有没有合适的方法来实现这一点？

这就是我目前这样做的方式：我为该对象重载 new 运算符，分配内存，并使用返回的指针作为指向（尚未初始化的）实例的指针，并将对象的特定数据成员设置为一些魔法值。然后，在 consutrctor 中，我检查了成员的值。如果是魔法值，那么对象是动态分配的 99.9%。

在发布和调试模式下，这种方法对我来说还没有失败，但是，这似乎是一个可怕的 hack。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T18:53:32.583

您应该能够实现您想要的，同时留下一个用户可访问的默认构造函数（将用于静态*和自动*对象 - 您似乎忽略了自动对象的存在，例如局部变量，所以我想您想要同等对待这些情况）。

使`operator new`和单独的构造函数都是私有的，并创建一个公共静态方法（这是“工厂方法”设计模式的一种情况），它只做一个`return new TheClass(123);`（假设单独的构造函数采用例如整数，但当然你可以选择任何类型您想要的论点，因为无论如何都没有使用该论点）。

您知道您说过该对象应该有一个构造函数，但从用户的角度来看，这正是该类的行为，并且用户方面没有“构造函数的显式选择”（他只是不能`new`显式调用，但必须通过您提供的工厂方法，仅此而已）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T18:44:12.927

任何构造函数都可以用于静态或动态分配。无论他以何种方式分配对象，您都无法强制对象的用户使用特定的构造函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T18:56:40.237

我不认为你可以在构造函数中说出来。

我不知道这是否有帮助，但是您可以通过将析构函数设为私有来*防止*对象被静态创建。您还需要有一个公共的“Delete”方法，该方法执行`delete this`动态分配此类对象的代码 - 他们必须执行`obj->Delete()`而不是`delete obj`.

# ruby-on-rails - 自动化 rails.vim

> ID：1014441
> 
> 赞同：1
> 
> 时间：2009-06-18T18:37:58.053
> 
> 标签：ruby-on-rails, vim

我在 OSX 或 Ubuntu 上使用 vim(in console) 7.1 进行 Rails 开发。这是我在编辑 rails 文件时反复做的事情。

cd RAILS_ROOT vim

:R项目.项目

有没有办法自动完成最后一部分？例如，我只需输入 'vim -some_arg' 并自动触发 ":Rproject .project"？如果那不可能，我可以将“Rproject .project”别名为“Rp”吗？

我熟悉 vim 编辑，但不熟悉 vim 脚本。请帮帮我。

山姆

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-18T19:06:04.887

可能有更好的方法来做到这一点，但我不想搞乱加载顺序等。

您可以编辑 rails.vim 并添加一行。它可以像我在测试中所期望的那样工作。

```
" Initialization {{{1

augroup railsPluginDetect
  autocmd!
  autocmd BufNewFile,BufRead * call s:Detect(expand("<afile>:p"))
  autocmd VimEnter * if expand("<amatch>") == "" && !exists("b:rails_root") | call s:Detect(getcwd()) | endif | if exists("b:rails_root") | silent doau User BufEnterRails | endif
  autocmd FileType netrw if !exists("b:rails_root") | call s:Detect(expand("<afile>:p")) | endif | if exists("b:rails_root") | silent doau User BufEnterRails | endif
  autocmd BufEnter * if exists("b:rails_root")|silent doau User BufEnterRails|endif
  autocmd BufLeave * if exists("b:rails_root")|silent doau User BufLeaveRails|endif
  autocmd Syntax railslog if s:autoload()|call rails#log_syntax()|endif

  " Add this line here
  autocmd VimEnter * if expand("<amatch>") == "" && !exists("b:rails_root") | call s:Detect(getcwd()) | endif | if exists("b:rails_root") | Rproject .project | endif
  " ^ this one

augroup END 
```

# javascript - jQuery函数调用

> ID：1014444
> 
> 赞同：1
> 
> 时间：2009-06-18T18:38:15.040
> 
> 标签：javascript, jquery

我正在尝试让回调调用 $(document).ready(..) 中的函数

如何从外部调用函数？

例如：

```
$(document).ready( function(foo) {
   var bar = function() { ... };
});

// How do I call bar() from here? 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-18T18:39:49.703

这取决于您希望如何确定范围。如果您只想让 bar 在全局范围内，那么只需执行以下操作：

```
$(document).ready( function(foo) {
   var bar = function() { ... };
   window.bar = bar;
}); 
```

请记住，在 JavaScript 中，唯一具有作用域的代码块是函数，因此在 , 和其他类型的代码块中声明的变量`if{}`对于`while{}`它们所属的任何函数都是全局的，除非它们没有被声明。

如果您使用变量而不声明它，则与执行以下操作相同：

```
// Both of these variables have global scope, assuming
// 'bar' was never declared anywhere above this
window.foo = "Hello World!";
bar = "Hello World!"; 
```

因此，上面的示例可以通过以下方式缩短一行：

```
$(document).ready( function(foo) {
   window.bar = function() { ... };
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-18T18:45:44.560

不要在 ready 函数中声明所有内容

```
$(document).ready( function() {
  ...
  bar();
});

function bar() {
  ...
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T18:41:42.227

您可以在准备函数之外声明 bar 。届时它将是全球性的。

```
var bar;

$(document).ready( function(foo) {
   bar = function() { ... };
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-18T18:44:26.030

如果你想`bar()`从外部调用，为什么不在外部声明它，从内部范围传递你需要的任何参数呢？

```
function bar(baz, qix) { ...};

$(document).ready(function(foo) {
        bar(whatever, whatnot);
        });
bar(something, else); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-18T18:51:37.953

阅读您的评论后，也许您想做这样的事情。如果`myUtilities`您想要访问`ready`.

```
var myUtilities={};

$(document).ready( function(foo) {
   myUtilities.bar = function() { ... };
});

// How do I call bar() from here?
a = myUtilities.bar(); 
```

抱歉，未经测试。可能是一个或两个愚蠢的语法错误。

# sql-server - 如何在 SQL Server Management Studio 中键入换行符

> ID：1014447
> 
> 赞同：43
> 
> 时间：2009-06-18T18:38:51.827
> 
> 标签：sql-server, character-encoding, ssms

在打开的数据表的“datagrid”视图中，如何在 SSMS 中直接在 nvarchar 字段中键入换行符？

有替代代码吗？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-06-18T19:10:52.197

~~你不能~~。（编辑：其他好的答案已经发布了一些可行的方法。）

我首选的方法是通过直接 SQL 更新。

两种通用技术：

```
--Literal returns inside strings
UPDATE mytable
SET textvalue = 
'This text
can include
line breaks'
WHERE rowid = 1234

--Concatenating CHAR codes
UPDATE mytable
SET textvalue = 'This text' + CHAR(10) + CHAR(13) 
   + 'can include' + CHAR(10) + CHAR(13)
   + 'line breaks'
WHERE rowid = 1234 
```

前者更容易使用，但如果您从外部来源粘贴带有未知行尾代码的文本，则可能会产生不一致的结果。

后者更难使用，但更有可能为您提供一致且可靠的结果。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-08-31T14:01:38.240

您可以从使用 UNIX 样式行结尾 (CR+LF) 的文本编辑器中粘贴这些行。我使用记事本++。首先转到 Settings/Preferences/New Document 并将格式从 Windows 更改为 Unix。然后打开一个新文档，输入您的行，然后将它们复制到 SSMS 中。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-06-18T19:26:45.737

您可以在记事本中准备文本，然后将其粘贴到 SSMS 中。SSMS 不会显示换行符，但它们在那里，您可以通过选择进行验证：

```
select *
from YourTable
where Col1 like '%' + char(10) + '%' 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2010-10-22T18:19:15.987

要么要么`char(13)`会`char(10)`工作。但建议使用`char(13) + char(10)`

*   `char(10)`= `\n`- 新行
*   `char(13)`= `\r`- 转到行首

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2020-10-20T04:21:44.263

在 SSMS 中，您不能使用 select 打印新行，而只能使用 PRINT

```
DECLARE @text NVARCHAR(100)
SET @text = concat(N'This is line 1.', CHAR(10), N'This is line 2.')
PRINT @text 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-01-23T05:19:23.663

如果您在该行或另一行中有一个现有的换行符，这*是可能的。*

选择代表现有换行符的方框，将其复制 (control-C)，然后将其粘贴 (control-V) 到您想要的位置。

这有点俗气，但我确实让它在 SSMS 2008 中工作，我无法让任何其他建议（control-enter、alt-13 或任何 alt-##）工作。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-06-26T18:43:04.153

最初我遇到了麻烦（不知道为什么），但我终于得到了以下内容来使用 SQL Server 2008 的 SSMS。

在 varchar 类型列中的文本中所需的位置插入 ALT-13 然后 ALT-10 （音乐符号和正方形出现并在您离开该行时保存）。最初，您会在离开该行后在该行的左侧收到一个警告（！）。只需重新执行您的 SELECT 语句。符号和警告将消失，但 CR/LF 被保存。如果要在 HTML 中正确显示文本，则**必须包含 ALT-13。**要快速确定这是否有效，请将保存的文本从 SSMS 复制到记事本。

或者，如果你不能让它工作，你可以从一个 nvarchar 列开始做同样的事情。但是，符号将保存为文本，因此在完成将符号转换为 CR/LF 后，您**必须将该列转换为 varchar。**

如果您想从其他来源（另一行或表格、HTML、记事本等）复制和粘贴文本，并且在第一个 CR 处不截断您的文本，我发现以下链接中提到的解决方案（程序员记事本）适用于使用 varchar 和 nvarchar 列类型的 SQL Server 2008 的 SSMS。

[http://dbaspot.com/sqlserver-programming/409451-how-i-enter-linefeed-when-modifying-text-field-2.html#post1523145](http://dbaspot.com/sqlserver-programming/409451-how-i-enter-linefeed-when-modifying-text-field-2.html#post1523145)

帖子的作者 (dbaspot) 提到了一些关于创建 SQL 查询的内容 - 不确定他的意思。只需按照有关程序员记事本的说明，您就可以在 SSMS 中复制和粘贴文本，并以两种方式保留 LF（使用程序员记事本，而不是记事本）。要在 HTML 中正确显示文本，您**必须**将 CR 添加到复制到 SSMS 的文本中。执行此操作的最佳方法是使用 REPLACE 函数执行 UPDATE 语句来添加 CR，如下所示：

```
UPDATE table_name
SET column_name = REPLACE(column_name , CHAR(10), CHAR(13) + CHAR(10)). 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-18T19:06:17.727

罗尼，

数据网格似乎正在吞噬任何粘贴换行符的尝试，包括使用 ALT+010。Microsoft 没有列出任何有用的快捷键。普通嫌疑犯

```
<ctrl>enter, 
<alt> enter, 
<ctrl><alt> enter, 
<shift> enter, etc 
```

不工作，正如你所指出的。

作为记录，如果您正在进行 Web 开发，则换行符无论如何都不会显示在浏览器中（它们被解释为额外的空格，并被忽略）。我不得不用

```
<br> 
```

我希望在浏览器中显示换行符的任何地方（文本区域将接受换行符作为可用输入）。

即使您可以插入换行符，我也不认为 SSMS 中的数据网格视图能够显示它。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-08-28T20:35:51.937

尝试改用 MS Access。创建一个新文件并选择“使用现有数据进行项目”模板。这将创建 .adp 文件。

然后只需打开您的表格并按`Ctrl`+`Enter`换行。

从剪贴板粘贴也可以正常工作。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-08-10T17:12:03.033

我发现实现不可重复更新的简单方法是使用 MS Access 并创建一个链接表，然后根据需要更新数据。我猜 MS Access 团队不会与 SMSS 团队交谈 :)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-06-18T18:54:54.360

我使用 INSERT 'a' + Char(10) + 'b' INTO 无论在哪里

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-06-18T19:13:07.370

您说的是右键单击表格并选择“编辑前 50 行”，对吗？

我尝试了 [Ctl][Enter] 和 [Alt][Enter]，但这些都不起作用。

即使当我使用 CR/LF 插入数据（使用标准 INSERT 语句）时，它也会显示在一行中，其中一个矩形表示控制代码。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-06-18T19:29:17.790

如果您尝试在网格视图中直接将数据输入到表中（可能是右键单击 TableName 并选择打开表），那么您可以输入您的 unicode 文本字符串，并且在任何您想要回车的地方输入 13 并按下 alt 键数字键盘。

那将是 Alt+13。这仅适用于数字小键盘，不适用于键盘顶部的数字键。回车将存储为正方形

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2017-03-07T09:45:37.713

我尝试使用 Excel 表输入换行符。我通过在 Excel 中的空白单元格下方写入“abc”来输入数据，然后使用包含“abc”的单元格上方的空单元格和带有数据的单元格更新我的数据库。我复制粘贴了我的 SSMS 中的两个单元格。它对我有用

# sql-server-2005 - sql-server-2005-备份-不被删除

> ID：1014449
> 
> 赞同：2
> 
> 时间：2009-06-18T18:39:31.280
> 
> 标签：sql-server-2005, backup

我有一个客户在 Windows 2008 Server 下运行 SQL Server 2005。即使维护计划成功完成且没有错误，备份文件也不会被删除。

这是子计划命令，它设置为删除超过一天的文件：EXECUTE master.dbo.xp_delete_file 0,N''C:\Program Files\Microsoft SQL Server\MSSQL.1\MSSQL\Backup'',N' '.bak'',N''2009-06-16T23:06:05'',1

备份命令和删除命令指向同一个位置。备份有效，而不是删除。显示“包括第一级子文件夹”的复选框到底有什么作用？任务之间应该有什么颜色的箭头？成功还是完成？

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-06T19:21:27.213

再次回来，

我已经研究了这个关于为什么备份没有删除的特殊问题，许多其他网站一直在谈论“确保文件扩展名正确”他们是对的。然而，他们需要更清楚地表达这一点。换句话说：

> **确保维护计划的两个部分的文件扩展名 (IE BAK) 相同！**

发生在我的客户身上的是，计划的备份部分指定了“BAK”，而清理部分指定了“.BAK”，那一小段时间就完全不同了。清理工作没有任何错误，但是它正在寻找 .bak 扩展而不是 bak 扩展。正如您在我的原始帖子中看到的那样，清理子计划命令指定了 .bak。咳咳。

谢谢大家。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T19:17:24.727

包括第一级子文件夹可确保删除命令在您指向的折叠的子目录中查找。如果（例如）您备份到名为“Backups”的文件夹中，这一点很重要，但每个单独的数据库的备份都驻留在它们自己的名为子文件夹 (Backups\MyDB) 中。如果是这种情况，它解释了为什么您没有看到备份删除。

是否使用成功条件或完成条件取决于您（和您的要求），但如果所有步骤都成功完成，那么您的问题不太可能与转换条件有关。

# eclipse - 如何在 Eclipse 中更改行高/行距？

> ID：1014454
> 
> 赞同：67
> 
> 时间：2009-06-18T18:40:13.867
> 
> 标签：eclipse, ide, editor

我正在使用 Eclipse 进行 Java 编程，但编辑器中的行看起来太靠近了。

我想更改行之间的间距/间隙。Eclipse 中是否有可以用来执行此操作的选项？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-03-01T11:45:02.367

我已经克隆并安装了字体

[https://github.com/andreberg/Meslo-Font](https://github.com/andreberg/Meslo-Font)

并使其成为 Eclipse 的 IDE 编辑器字体。行间距现在好多了！

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2015-10-15T09:59:57.863

在尝试了各种替代字体之后，我`Consolas`在字体编辑器中采用了原始和增加的行高，将生成的`ConsolasHigh`字体包安装到系统中，并在 Eclipse 编辑器中将其设置为默认值：

[![在此处输入图像描述](../Images/bb358e80bde0b1040e523501c9841228.png)](https://i.stack.imgur.com/k6tNr.png)

**查看：[https ://github.com/Salauyou/Consolas-High-Line](https://github.com/Salauyou/Consolas-High-Line)**

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-06-18T18:49:24.337

您可以配置格式化程序（首选项 | Java | 代码样式）以注入额外的空行。否则，您可能会找到具有大量内置空白的字体（首选项 | 常规 | 外观 | 颜色和字体）。在 Windows 上，我喜欢“consolas”——它不是特别的空白，但它是一种很好的单行距、可读字体。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2011-04-08T09:12:01.457

您可以在某处的某些评论中放置过高的字符，请尝试“|ÄÁg$ÑĈђךןﭼژçÅẤДАБψ”。一旦 Eclipse 在文件中看到这一点，它就会增加整个文件的行分隔符以正确显示这些字符。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2011-05-03T03:37:52.773

创建您自己的位图字体，该字体使用字体顶部的所有行。它确实有效，并且似乎在 17 点字体中最多可以保存 4 行像素。我这样做如下：

*   安装 otf2bdf
    *   转到字体文件夹，大概在根终端中
    *   使用 otf2bdf 将您最喜欢的字体（可能是 truetype 字体）克隆到您想要的大小
    *   安装字体
    *   编辑字体，使其使用行上方的所有行作为大写字母
        *   通常有大约 3 行像素是空白的，这就是为什么行之间有这么多空间
        *   如果您希望也可以使用该行下方的一些行，但我认为这些通常用于像 y 这样的小写字母，它们位于该行下方（编程时并不那么重要）
    *   通过以下方式安装字体：
        *   将其保存到字体文件夹之一中，例如 /usr/local/share/fonts
        *   使用 fc-cache -f -v 在根终端中更新字体 chache
    *   使用新字体

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2011-05-03T19:47:47.210

关于我上面的回复，我现在可以提供有关如何创建字体的更多详细信息，以及创建更好字体的建议（从 truetype 字体开始）：

*   选择您希望使用的 truetype 字体（我使用了 arial 字体）
*   下载并安装 fontforge
*   启动fontforge并打开字体文件；我使用了根终端，以便确保将文件保存在受保护的字体文件夹中
*   选择所有字符（编辑/选择/全选）
*   元素字体信息 PS 名称
*   指定名称 - 我称之为 ArialMTVerticallyTighter；确保更改此选项卡上的所有名称，否则它可能会使用新字体而不是您不希望使用的旧字体

    *   元素变换
    *   原点字形原点
    *   均匀缩放 120 %
        （更多会太大，如果你想要更多的行间距，请使用更少）
*   元素 一般 1792 256 2048 规模 -142 150
*   OS/2 指标

    *   关闭是偏移整个选项卡和 t
    *   打开真正使用错字指标
    *   1792 512 1792 -512 0 1792 -512 0
*   文件生成字体 - 真实类型 - 进入字体文件夹 - 使用新字体名称
*   文件保存（以防万一你搞砸了，所以你可以回去）到新名称
*   使用字体查看器（通过双击）打开新字体文件（在 nautilus 中）
*   安装它
*   启动 Eclipse
*   在eclipse中将其设置为字体
    （窗口>首选项>常规>外观>java编辑器>文本字体为新字体）

请记住，您在 Eclipse 中看到的特定设置（例如 9）的字体大小实际上对应于大约 11 磅的字体，行之间的空间更小

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-06-18T18:54:30.850

在带有 gtk 的 linux 上，您还可以使用 .gtkrc 文件。请参阅[此处](http://techtavern.wordpress.com/2008/09/24/smaller-font-sizes-for-eclipse-on-linux/)和[此处](http://blog.xam.dk/archives/81-Making-Eclipse-look-good-on-Linux.html)作为示例。

当然这对 Windows 没有任何帮助:)

# wpf - 我将如何制作一个显示任意内容的组合框作为项目模板的一部分？

> ID：1014465
> 
> 赞同：0
> 
> 时间：2009-06-18T18:42:05.770
> 
> 标签：wpf, combobox

我需要创建几个组合框来表示枚举值。我希望用左侧的图形预览和右侧的文本来表示这些值。显示的“预览”部分可能是控件、图像或其他一些内容。我尝试了两种方法，但都失败了，所以我很好奇一些替代方案可能是什么。在我的测试中，“预览”是一个按钮，因为它创建起来很方便，但实际上它要么是自定义控件，要么是 DrawingImage 控件。

对于第一种方法，我决定使用`ContentPresenter`为我显示预览内容。为此，我创建了一个具有适当属性和模板的控件。我创建了一个用这个控件的实例填充自己的集合类型，然后将集合的一个实例放入我的窗口资源中。我将 ComboBox 的*ItemSource*属性绑定到此集合。当有一个 ComboBox 时效果很好，但是当有多个 ComboBoxes 使用该资源时，其中一个 ComboBoxes 不显示任何值。我相信这可能与控件是它的内容这一事实有关，并且正在发生某种重新父母的问题。

我认为这是错误的处理方法，并尝试使用 ComboBox 的 ItemTemplate 来完成我的肮脏工作。我重新设计了数据类以继承 DependencyObject 而不是 Control，并使用控件的旧样式作为数据类型的数据模板。如果多个 ComboBox 绑定到同一个资源实例，这仍然存在问题；第一个 ComboBox 正确显示预览内容，但是一旦您下拉第二个 ComboBox，预览内容就会从两个 ComboBox 中消失。在这种方法中，所选项目也不会显示在 ComboBox 中，尽管我可能错过了需要为此设置的其他模板。如果我直接将 DataTemplate 设置为 ComboBox 的 ItemTemplate，则所选项目会正确显示，但会破坏弹出窗口中的控件。我绝对不会在这里做事。

如果我在我的资源中创建集合的两个实例，则第二种方法有效，但这并不实际。我可以重组我的应用程序以在代码中设置与集合的私有实例的绑定，但这似乎有点讨厌。我可以为每种类型的集合派生一个新的 ComboBox 并让它自动使用该集合的新实例，但这似乎工作量太大。似乎我想要的东西并不少见，但我似乎找不到有效的东西。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T19:18:08.237

您不应将 FrameworkElement 派生对象用作 ItemControls 中的内容，因为它们只能显示一次。

相反，使用 DataTemplates 来控制您的项目在 ComboBox 中的显示方式。在非常复杂的情况下，您可以使用 DataTemplate 选择器。Bea Stollnitz 在[这里](http://www.beacosta.com/blog/?p=16)有一篇关于这个的优秀帖子。

# c++ - HTTP 输入流类 (C++)

> ID：1014472
> 
> 赞同：0
> 
> 时间：2009-06-18T18:43:26.000
> 
> 标签：c++, http, inputstream

我目前正在开发一个项目，该项目对其需要的数据执行大量 HTTP 请求。它的工作原理是将所有数据写入缓冲区，然后将该缓冲区返回给调用者。似乎等待整个文件下载基本上可以流式传输的数据是一个坏主意。

问题 1：是否已经有一个库/公共代码可以发出 HTTP 和经过身份验证的 HTTP 请求作为流工作？

问题2：如果没有这样的库，为什么不呢？有没有理由从来不需要这样的东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T18:50:45.147

让[boost::asio](http://www.boost.org/doc/libs/1_36_0/doc/html/boost_asio.html)做到这一点并不难，但据我所知，它没有内置 HTTP 协议（​​而且我想不出有这样的库，或者为什么不)，因此您必须编写标题/正文解析（可能很乏味且容易出错）。

一些谷歌搜索对此进行了一些尝试，[就像这样](http://xtalk.msk.su/~ott/en/cpp/BoostAsioProxy.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T19:00:39.420

有许多处理 http 请求的 C 库，它们使用 C 而不是 C++ 的原因仅仅是因为 C++ 可以*轻松*使用 C 库，但反之则不然。

因此，C 库在两个领域都很有用......

[libwww](http://www.w3.org/Library/)是用于 http 函数的 W3C 库。

[Curl](http://curl.haxx.se/libcurl/)也有一个带有 C++[包装器](http://rrette.com/curlpp.html)项目的库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T19:06:41.203

我不知道现有的库，但是用[Boost.Iostreams包装](http://www.boost.org/doc/libs/1_39_0/libs/iostreams/doc/index.html)[Curl](http://curl.haxx.se/libcurl/)（或[WinInet](http://msdn.microsoft.com/en-us/library/aa383630(VS.85).aspx)，如果那是你的一杯茶的话）应该不会太难。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-10T03:09:46.907

这似乎是您正在寻找的：

[http://sourceforge.net/projects/urdl/](http://sourceforge.net/projects/urdl/)

# ruby-on-rails - 如何查看或编辑在 netbeans 中创建的数据库？

> ID：1014492
> 
> 赞同：0
> 
> 时间：2009-06-18T18:45:57.230
> 
> 标签：ruby-on-rails, database, netbeans, migration, sqlite

我正在使用 Netbeans 6.5 进行 RoR 开发。我相信我的 sqlite3 数据库与 rails 迁移不同步。如何查看和操作数据库（通过 netbeans 或命令行）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T18:50:17.220

如果您打开“服务”选项卡，您将看到数据库节点。右键单击它并选择“新建连接”。按照提示提供您要连接的数据库的详细信息。在某些时候，您必须提供一个包含 sqlite 的 JDBC 驱动程序的 Jar。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-19T11:03:02.917

我对 Ruby 或其迁移一无所知，但 sqlite3 提供了从终端访问数据库的命令：`sqlite3 ./database.db`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T20:02:29.690

运行`script/dbconsole`它会将您放入 RDBMS 的命令行（假设您的`database.yml`文件已配置为正确访问您的数据库）。然后使用 SQL 来做你需要做的事情。

# python - TypeError: cannot concatenate 'str' and 'list' objects 是什么意思？

> ID：1014503
> 
> 赞同：8
> 
> 时间：2009-06-18T18:49:36.020
> 
> 标签：python, string

这个错误是什么意思？

> TypeError：无法连接“str”和“list”对象

以下是部分代码：

```
for j in ('90.','52.62263.','26.5651.','10.8123.'):
    if j == '90.':
        z = ('0.')
    elif j == '52.62263.':
        z = ('0.', '72.', '144.', '216.', '288.')

    for k in z:
        exepath = os.path.join(exe file location here)
        exepath = '"' + os.path.normpath(exepath) + '"'
        cmd = [exepath + '-j' + str(j) + '-n' + str(z)]

        process=Popen('echo ' + cmd, shell=True, stderr=STDOUT )
        print process 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-18T19:03:32.473

我不确定您是否知道这`cmd`是一个单元素`list`，而不是字符串。

将该行更改为下面将构造一个字符串，您的其余代码将起作用：

```
# Just removing the square brackets
cmd = exepath + '-j' + str(j) + '-n' + str(z) 
```

我假设您使用括号只是为了对操作进行分组。如果一切都在一条线上，那就没有必要了。如果你想把它分成两行，你应该使用括号，而不是括号：

```
# This returns a one-element list
cmd = [exepath + '-j' + str(j) + 
       '-n' + str(z)]

# This returns a string
cmd = (exepath + '-j' + str(j) + 
       '-n' + str(z)) 
```

python 中方括号之间的任何内容*始终*是`list`. 括号之间的表达式按正常计算，除非表达式中有逗号，在这种情况下，括号充当`tuple`构造函数：

```
# This is a string
str = ("I'm a string")

# This is a tuple
tup = ("I'm a string","me too")

# This is also a (one-element) tuple
tup = ("I'm a string",) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-18T18:52:10.447

字符串对象只能与其他字符串连接。Python 是一种强类型语言。它不会为您强制类型。

你可以做：

```
'a' + '1' 
```

但不是：

```
'a' + 1 
```

在您的情况下，您正在尝试连接字符串和列表。这行不通。如果这是您想要的结果，您可以将该项目附加到列表中：

```
my_list.append('a') 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-19T00:02:54.417

OP 的代码中还有另一个问题：

`z = ('0.')`然后稍后`for k in z:`

第一个语句中的括号将被忽略，导致第二个语句`k`首先绑定到`'0'`然后`'.'`... 看起来像`z = ('0.', )`预期的那样。

# iphone - 如何在 iPhone 中播放应用程序包中的视频

> ID：1014504
> 
> 赞同：0
> 
> 时间：2009-06-18T18:49:44.883
> 
> 标签：iphone

我的 iPhone 应用程序文档目录中有一个视频。我想使用 mpmovieplayercontroller 播放。可以一些邮政编码来做到这一点。

谢谢，纳雷什

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T19:32:28.767

这是 mpmovieplayercontroller 文档的链接： http: [//developer.apple.com/iphone/library/documentation/MediaPlayer/Reference/MPMoviePlayerController_Class/MPMoviePlayerController/MPMoviePlayerController.html#//apple_ref/occ/instm/MPMoviePlayerController/initWithContentURL](http://developer.apple.com/iphone/library/documentation/MediaPlayer/Reference/MPMoviePlayerController_Class/MPMoviePlayerController/MPMoviePlayerController.html#//apple_ref/occ/instm/MPMoviePlayerController/initWithContentURL)：

就像使用以下命令创建本地文件的 url 一样简单：

```
[[NSBundle mainBundle] pathForResource: ofType:] 
```

然后将此网址传递到：

```
[[MPMoviePlayerController alloc] initWithContentURL:] 
```

# security - ACM ICPC Online Judge如何防止恶意攻击？

> ID：1014505
> 
> 赞同：10
> 
> 时间：2009-06-18T18:49:54.273
> 
> 标签：security

我花了几个多小时在[ACM ICPC 的问题集存档](http://acm.uva.es/problemset/)上自卑，我想知道在线法官如何能够编译和运行任何用户的源代码并防止对其系统的恶意攻击。

编译后的二进制文件是否从某种有限的沙箱中运行？如何设置这种沙箱？你会使用什么操作系统？您将如何启动用户编译的可执行文件？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-18T20:20:03.883

您可以在 Linux chroot jail 中运行它，或者将它链接到不实现任何文件 I/O 的 libc。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-07-14T15:07:09.160

这些程序在运行时间有限的 chroot 监狱中运行。裁判计算机分布在多个服务器上，以帮助防止单点故障或 DOS 攻击。

我是区域比赛管理员。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-05-26T12:43:55.723

形成沙箱的简单方法（假设 Linux 作为服务器操作系统，这对于 ACM 来说很常见）是使用（古老的）chroot 或一些内核补丁。现在内核中有一些更高级的沙盒技术，例如：

*   [seccomp](http://en.wikipedia.org/wiki/Seccomp) - Linux 2.6.12+ - 进程可以使用特殊`prset`调用询问操作系统，以将进程能力限制为：退出、读取和写入已打开的文件。操作系统将拒绝执行任何其他有效地将程序与外部世界隔离的系统调用。并且没有办法重新设置这些功能。（此解决方案可能会破坏一些希望在运行时加载一些插件的渐进式语言，如 python、perl、ruby 等。）

*   命名空间隔离[-cgroups](http://en.wikipedia.org/wiki/Cgroups)。chroot 是一个仅更改（隔离）文件系统名称空间的程序，还有其他名称空间，例如网络或进程。使用 cgroups，我们可以限制更多，仅使用 chroot。

一些内核补丁，为在线评委编写，例如 * ejudge.ru 有补丁到 2.6.38.8、3.4.15、3.7.5；还有一些适用于 Windows 的解决方案。（俄文网站。）我认为，这个系统可能会在俄罗斯的一些比赛中使用，不确定1/4 ACM ICPC。

一些法官系统使用`ptrace()`系统调用 - 换句话说，它们就像被测程序的调试器，并且法官可以控制所有系统调用，并且可以取消其中任何一个而不将其传递给内核。

还有开源的裁判系统，例如[https://openjudge.net/](https://openjudge.net/) (libsandbox)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-17T15:22:45.313

我认为他们不运行任何代码。例如，当您尝试在 C++ 中读取或写入文件“ofstream”和“ifstream”时，有时会出现此错误“Restricted function”

# ruby-on-rails - ImageMagickError 无法读取字体 `(null)': `(null)'

> ID：1014506
> 
> 赞同：12
> 
> 时间：2009-06-18T18:50:09.733
> 
> 标签：ruby-on-rails, imagemagick, rmagick

我的生产服务器（运行 ImageMagick、Rmagick 等的 Ubuntu）上的这个错误已经有一段时间了。

从谷歌搜索它似乎没有找到正确的字体使用，这需要正确设置

```
sudo nano /usr/lib/ImageMagick-6.3.7/config/type-ghostscript.xml 
```

当我打开这个文件时，它会在这个目录中列出一堆字体

```
/usr/share/fonts/type1/gsfonts/ 
```

它们都存在。我尝试更改这些字体的所有者和权限。似乎没有帮助。

有没有人遇到过这个并能够解决它？谢谢！

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2014-12-05T14:01:27.783

我对 MacOS Yosemite 的修复：

```
$brew install gs 
```

问题解决了（对我来说）。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-07-20T20:46:07.920

几个月后终于解决了！！

答案在这里：[http ://rubyforge.org/forum/forum.php?thread_id=8742&forum_id=4402](http://rubyforge.org/forum/forum.php?thread_id=8742&forum_id=4402)

必须使用“--with-gs-font-dir=/where/your/gs/fonts/live”标志编译imagemagick

做了一个“定位.pfb”来找到他们在哪里。对我来说，它是 ubuntu 上的“--with-gs-font-dir=/usr/share/fonts/type1/gsfonts”

完成以下步骤。请注意，由于此处描述的另一个奇怪错误，我还必须使用“–disable-openmp”标志：[http ://computerplumber.com/2009/01/installing-rmagick-28-gem-on-hardy/](http://computerplumber.com/2009/01/installing-rmagick-28-gem-on-hardy/)

```
# remove in case you already installed imagemagick from apt-get
sudo apt-get remove imagemagick
sudo apt-get install libperl-dev gcc libjpeg62-dev libbz2-dev libtiff4-dev libwmf-dev libz-dev libpng12-dev libx11-dev libxt-dev libxext-dev libxml2-dev libfreetype6-dev liblcms1-dev libexif-dev perl libjasper-dev libltdl3-dev graphviz gs-gpl pkg-config

#get image magick from source and compile it
cd ~/sources
wget ftp://ftp.imagemagick.org/pub/ImageMagick/ImageMagick.tar.gz
tar xvfz ImageMagick.tar.gz
cd ImageMagick-6.5.4-2
./configure --disable-openmp --with-gs-font-dir=/usr/share/fonts/type1/gsfonts
make
sudo make install

#reinstall rmagick gem
sudo gem uninstall rmagick
sudo gem install rmagick 
```

由于这个和许多其他错误，这可能是我一生中遇到的最糟糕的安装体验。对 imagemagick 和 rmagick 感到羞耻。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-18T21:52:31.823

试试这个：[http ://rmagick.rubyforge.org/install-faq.html#fonts](http://rmagick.rubyforge.org/install-faq.html#fonts)

RMagick 完全依赖 ImageMagick 进行字体管理。问题一定出在 ImageMagick 的配置上。要查看如何为字体配置 ImageMagick，请使用以下命令：

```
 convert -list font 
```

输出将显示 ImageMagick 知道使用的字体。该列表可能不包括您系统上安装的所有字体！

查找以“字形：”开头的行。这些是您可以在 RMagick 的当前安装/配置中使用的字体。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-02-20T15:18:01.697

轻松修复，去[http://sourceforge.net/projects/gs-fonts/?source=dlp](http://sourceforge.net/projects/gs-fonts/?source=dlp)下载字体并将它们复制到 /usr/local/share/ghostscript/fonts

# c++ - 有条件地初始化 C++ 成员变量的正确方法？

> ID：1014518
> 
> 赞同：13
> 
> 时间：2009-06-18T18:52:00.340
> 
> 标签：c++, class, member-initialization

我敢肯定这是一个非常简单的问题。以下代码显示了我正在尝试做的事情：

```
class MemberClass {
public:
    MemberClass(int abc){ }
};

class MyClass {
public:
    MemberClass m_class;
    MyClass(int xyz) {
        if(xyz == 42)
            m_class = MemberClass(12);
        else
            m_class = MemberClass(32);
    }
}; 
```

这不会编译，因为`m_class`是使用空构造函数（不存在）创建的。这样做的正确方法是什么？我的猜测是使用指针和实例化`m_class`using `new`，但我希望有一种更简单的方法。

**编辑：**我应该早点说，但我的实际问题还有一个复杂的问题：我需要在初始化 m_class 之前调用一个方法，以便设置环境。所以：

```
class MyClass {
public:
    MemberClass m_class;
    MyClass(int xyz) {
        do_something(); // this must happen before m_class is created
        if(xyz == 42)
            m_class = MemberClass(12);
        else
            m_class = MemberClass(32);
    }
}; 
```

是否可以通过花哨的初始化列表技巧来实现这一点？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-06-18T18:57:10.377

使用条件运算符。如果表达式较大，请使用函数

```
class MyClass {
public:
    MemberClass m_class;
    MyClass(int xyz) : m_class(xyz == 42 ? 12 : 32) {

    }
};

class MyClass {
    static int classInit(int n) { ... }
public:
    MemberClass m_class;
    MyClass(int xyz) : m_class(classInit(xyz)) {

    }
}; 
```

要在初始化 m_class 之前调用函数，您可以在该成员之前放置一个结构并利用 RAII

```
class MyClass {
    static int classInit(int n) { ... }
    struct EnvironmentInitializer {
        EnvironmentInitializer() {
            do_something();
        }
    } env_initializer;
public:
    MemberClass m_class;
    MyClass(int xyz) : m_class(classInit(xyz)) {

    }
}; 
```

这将`do_something()`在初始化之前调用`m_class`。`MyClass`请注意，在构造函数初始化程序列表完成之前，不允许调用非静态成员函数。该函数必须是其基类的成员，并且必须已经完成基类的ctor才能使其工作。

还要注意，当然，对于创建的每个单独的对象，总是调用该函数 - 不仅是为创建的第一个对象。如果你想这样做，你可以在初始化器的构造函数中创建一个静态变量：

```
class MyClass {
    static int classInit(int n) { ... }
    struct EnvironmentInitializer {
        EnvironmentInitializer() {
            static int only_once = (do_something(), 0);
        }
    } env_initializer;
public:
    MemberClass m_class;
    MyClass(int xyz) : m_class(classInit(xyz)) {

    }
}; 
```

它使用逗号运算符。`do_something`请注意，您可以使用 function-try 块捕获任何引发的异常

```
class MyClass {
    static int classInit(int n) { ... }
    struct EnvironmentInitializer {
        EnvironmentInitializer() {
            static int only_once = (do_something(), 0);
        }
    } env_initializer;
public:
    MemberClass m_class;
    MyClass(int xyz) try : m_class(classInit(xyz)) {

    } catch(...) { /* handle exception */ }
}; 
```

如果该函数抛出导致对象创建失败`do_something`的异常，下次将再次调用该函数。`MyClass`希望这可以帮助 ：）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-18T18:55:40.410

使用初始化列表语法：

```
class MyClass {
public:
    MemberClass m_class;
    MyClass(int xyz) : m_class(xyz == 42 ? MemberClass(12) : MemberClass(32)
                               /* see the comments, cleaner as xyz == 42 ? 12 : 32*/)
    { }
}; 
```

可能是工厂清洁工：

```
MemberClass create_member(int x){
   if(xyz == 42)
     return MemberClass(12);
    // ...
}

//...
 MyClass(int xyz) : m_class(create_member(xyz)) 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-18T18:56:26.493

```
 MyClass(int xyz) : m_class(xyz==42 ? 12 : 32) {} 
```

要回答您修改后的问题，这有点棘手。最简单的方法是制作`m_class`一个指针。如果你真的想要它作为数据成员，那么你必须要有创意。创建一个新类（最好在 MyClass 内部定义它）。让它的 ctor 成为需要调用的函数。将它*首先*包含在数据成员的声明中（这将使其首先被实例化）。

```
class MyClass 
{
     class initer { public: initer() {
                    // this must happen before m_class is created
                    do_something();                        
                    }
                   }

    initer     dummy;
public:

    MemberClass m_class;
    MyClass(int xyz) : m_class(xyz==42? 12 : 43)
    {
        // dummy silently default ctor'ed before m_class.
    }
}; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-18T18:59:44.227

或者：

```
class MemberClass {
public:
    MemberClass(int abc){ }
};

class MyClass {
public:
    MemberClass* m_class;
    MyClass(int xyz) {
        if(xyz == 42)
            m_class = new MemberClass(12);
        else
            m_class = new MemberClass(32);
    }
}; 
```

如果您仍然想保持相同的语法。不过，成员初始化更有效。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-18T19:03:13.753

试试这个：

```
class MemberClass
{
public:    
   MemberClass(int abc = 0){ }
}; 
```

这给了它一个默认值，以及你的默认构造函数。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-18T19:23:16.213

要在其他事情发生后进行初始化，您确实需要使用指针，如下所示：

```
class MyClass {
public:
    MemberClass * m_pClass;
    MyClass(int xyz) {
        do_something(); // this must happen before m_class is created
        if(xyz == 42)
            m_pClass = new MemberClass(12);
        else
            m_pClass = new MemberClass(32);
    }
}; 
```

唯一的区别是您需要在析构函数中访问成员变量，`m_pClass->counter`而不是`m_class.counter`, 。`delete m_pClass`

# java - Hibernate findByCriteria 奇怪的行为

> ID：1014520
> 
> 赞同：0
> 
> 时间：2009-06-18T18:52:34.190
> 
> 标签：java, oracle, hibernate

我有一个简单的方法，它只执行两行并尝试返回 oracle 数据库表中的所有对象：

```
DetachedCriteria criteria = DetachedCriteria.forClass(Object.class);
return (Collection)getHibernateTemplate().findByCriteria(criteria); 
```

但是，我收到“ORA-01031：权限不足”错误。当我检查 show_sql 的日志时，我发现了这个：

```
Hibernate: select this_.NAME as NAME8_0_, from PL_VW this_ where ID=?
Hibernate: update PL_VW set NAME=? where ID=?
Hibernate: update PL_VW set NAME=? where ID=?
Hibernate: update PL_VW set NAME=? where ID=?
Hibernate: update PL_VW set NAME=? where ID=?
Hibernate: update PL_VW set NAME=? where ID=?
... 
```

为什么 findByCriteria 会选择一个 ID 并进行多次更新？必须为所有与休眠挂钩的表提供更新访问权限吗？我不希望更新表格！

还是代码有问题？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-19T18:45:14.460

是的，它应该返回所有对象。

我发现了最不明显的问题：

在 getName 方法中，我做了一些子字符串函数并返回了修改后的字符串。

我猜 hibernate 立即尝试使用 getName 中返回的内容更新数据库。（什么为什么？！）

这是在 Hibernate 文档中的任何地方提到的还是应该是常识？？？我真是个菜鸟。

无论如何，谢谢你们的帮助。

# unix - ASH 变量间接引用

> ID：1014522
> 
> 赞同：3
> 
> 时间：2009-06-18T18:52:48.043
> 
> 标签：unix, shell

我正在尝试将脚本从 BASH 移植到 ASH (Almquist SHell)，并且遇到了间接引用的问题。以下函数

```
cmd() {
    # first argument is the index to print (ie label)
    arg=$1
    # ditch the first argument
    shift
    # print the label (via indirect reference)
    echo "${!arg}"
} 
```

应该产生以下输出

```
cmd 1 one two three
one
cmd 2 one two three
two
cmd 3 one two three
three 
```

这在 BASH 下按预期工作，但在 ASH（或 DASH）下运行时会生成“语法错误：错误替换”。这应该工作吗？如果没有，是否有替代使用间接引用的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-18T19:05:02.907

你可以试试`eval`：

```
cmd() {
    arg=$1
    shift
    eval "echo \$$arg"
} 
```

# python - 在 python 中将列表元素置于最前面的简单语法？

> ID：1014523
> 
> 赞同：81
> 
> 时间：2009-06-18T18:52:58.340
> 
> 标签：python

我有一个包含一组元素的数组。我想把一个给定的元素放在前面，否则保持顺序不变。人们对最干净的语法有什么建议吗？

这是我能想到的最好的方法，但是当 N 操作可以执行时，执行 N log N 操作似乎是一种不好的形式。

```
 mylist = sorted(mylist,
                    key=lambda x: x == targetvalue,
                    reverse=True) 
```

干杯，/YGA

* * *

## 回答 #1

> 赞同：146
> 
> 时间：2009-06-18T18:57:35.477

我会去：

```
mylist.insert(0, mylist.pop(mylist.index(targetvalue))) 
```

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2009-06-18T18:55:17.447

要将（例如）第 6 个元素放在前面，请使用：

```
mylist.insert(0, mylist.pop(5)) 
```

（*python 使用标准的基于 0 的索引*）

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2015-02-06T16:48:56.420

这只需要两个列表操作（无索引）： `mylist.remove(targetvalue) mylist.insert(0, targetvalue)`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-18T19:03:40.227

注意：以下代码（以及您提供的示例代码）会将*所有*匹配的元素放在前面。

```
x = targetvalue
for i in range(len(mylist)):
    if(mylist[i] == x):
        mylist = [mylist[i]] + mylist[:i] + mylist[i+1:] 
```

例如，如果 mylist = [1, 2, 3, 4, 3] 和 x = 3，这将导致 [3, 3, 1, 2, 4]。

# build - 如何将构建卸载到服务器以保持生产力？

> ID：1014524
> 
> 赞同：2
> 
> 时间：2009-06-18T18:53:16.513
> 
> 标签：build, distributed

我有几个我正在从事的大型项目。根据项目和选项，构建时间从 10 到 100 分钟不等，这让我在那段时间毫无用处。

不过，我确实有几台额外的电脑。无论如何我可以将这些计算机配置为“编译节点”，以便在构建进行时我仍然可以工作？

我听说过 Visual Studio 的软件插件可以做到这一点，但我已经看到了价格标签。我正在寻找最好是免费或低于 100 美元的东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-18T18:58:04.417

您可以设置免费的[TeamCity](http://www.jetbrains.com/teamcity/)持续集成构建服务器。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-18T18:58:47.927

[偷懒](http://xkcd.com/303/)太多了？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-18T18:59:03.527

您*可以将*它们连接起来并建立局域网，不是吗？如果您只想快速而肮脏地进行操作。在每台机器上设置一个编译器，然后将代码发送到你本地的一系列管道，在你的一台构建机器上编译并继续工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-18T19:00:27.703

我爱哈德森 ( [http://hudson-ci.org/](http://hudson-ci.org/) )。它功能齐全，稳定且免费。它主要专注于 Java，但可以很容易地用于构建非 Java 项目

# asp.net - ASP.NET 下一个/上一个按钮在表单中显示单行

> ID：1014526
> 
> 赞同：1
> 
> 时间：2009-06-18T18:53:23.410
> 
> 标签：asp.net, postback

我正在寻找在 ASP.NET 中实现此功能的最佳方法。

在页面上，用户可以选择通过带有下一个和上一个按钮的订阅号码“翻页”。

当用户点击下一个/上一个按钮时，页面被回发（部分，AJAX），订阅详情以表格形式显示。一次只显示一行。

大约有 10,000 个订阅号，所以如果我们可以避免在每次回发时加载所有订阅号，我们更愿意这样做。

不知何故，我需要一个计数器来跟踪总项目和当前位置，不是吗？如果是这样，您将如何存储它们以便它们在回发时持续存在？

提前致谢。非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-18T19:01:04.117

您可以在页面上创建属性变量并将值存储在页面的 ViewState 中。这是一个例子：

```
public int CurrentPosition
{
  get{return (int)(ViewState["CurrentPosition"] ?? 0);}
  set{ViewState["CurrentPosition"] = value;}
} 
```

在此示例中，在回发之间，无论是全部回发还是部分回发，保存在 CurrentPosition 属性中的值都将被持久化。

最初 CurrentPosition 将等于 0，然后在您的查询中使用 like 检索`WHERE ID = CurrentPosition + 1`，然后将 CurrentPosition 的值增加一。如果返回结果，则减 1。

# java - Java 的异步 HTTP 客户端

> ID：1014528
> 
> 赞同：20
> 
> 时间：2009-06-18T18:53:43.050
> 
> 标签：java, actionscript-3, http, httpwebrequest

作为 Java 世界中的一个相对新手，我发现许多其他框架中相对微不足道的事情令人沮丧地难以完成。一个主要示例是异步 http 请求的简单解决方案。看到一个似乎并不存在，最好的方法是什么？使用像 httpclient 这样的阻塞类型库或内置的 java http 东西创建我自己的线程，或者我应该使用更新的非阻塞 io java 东西 - 对于应该简单的东西来说似乎特别复杂。

我正在寻找的是从开发人员的角度来看易于使用的东西 - 类似于 AS3 中的 URLLoader - 您只需创建一个 URLRequest - 附加一堆事件处理程序来处理完成、错误、进度等，然后调用一种将其关闭的方法。

如果您不熟悉 AS3 中的 URLLoader，它非常简单，看起来像这样：

```
private void getURL(String url)
{
    URLLoader loader = new URLLoader();
    loader.addEventListener(Event.Complete, completeHandler);
    loader.addEventListener(HTTPStatusEvent.HTTP_STATUS, httpStatusHandler);
    loader.addEventListener(IOErrorEvent.IO_ERROR, ioErrorHandler);

    URLRequest request = new URLRequest(url);

    // fire it off - this is asynchronous so we handle
    // completion with event handlers
    loader.load(request);
}

private void completeHandler(Event event)
{
    URLLoader loader = (URLLoader)event.target;
    Object results = loader.data;

    // process results
}

private void httpStatusHandler(Event event)
{
    // check status code
}

private void ioErrorHandler(Event event)
{
    // handle errors
} 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2010-04-16T07:38:32.743

使用以前称为 ning http 客户端库的“Async Http Client”。见 [https://github.com/AsyncHttpClient/async-http-client](https://github.com/AsyncHttpClient/async-http-client)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-11-14T23:04:16.617

Apache Commons HttpClient 4.0 版（现在在[HttpComponents/HttpCore 中](http://hc.apache.org/httpcomponents-core/httpcore-nio/index.html)）也支持 Java 的 NIO（非阻塞 IO）。我认为这是你最好的选择。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-06-19T04:57:29.897

如果您还没有看过它，请查看 Java 5 java.util.concurrent——它使多线程应用程序更易于开发。您可以设置一个管理四个线程的 ThreadPoolExecutor。然后，您可以向池提供任意数量的任务以完成。每个任务都是一个 Runnable。ThreadPoolExecutor 将对 Runnable 任务进行排队，并将它们并行提供给可用的线程。每个 Runnable 任务完成时都会调用 Pool 的 afterExecute() 方法。

我清楚地记得在 1999 年为一个用 Java 编写的 Web 浏览器编写了一个 fetch 线程池，而且它是**正确**的。上个月，我为 Web 服务器编写了一个负载测试器。测试器有一个 ThreadPoolExecutor，它有 n 个线程，我提供给它的 Runnable 任务每个都使用 Apache HTTP 客户端获取一个页面。只花了一两个小时就让它工作得相当好。我认为您会喜欢 java.util.concurrent 与 Apache HTTP 客户端相结合，尽管听起来您需要对进度指示进行一些自定义。

（请注意，Apache HTTP 客户端有自己的线程池，默认配置将您限制为最多 20 个线程，并且每个 Web 服务器只有两个。）

更新：这是[Apache HTTP Client](http://hc.apache.org/httpclient-3.x/)的链接。请务必阅读[MultiThreadedHttpConnectionManager](http://hc.apache.org/httpclient-3.x/threading.html)，它负责处理连接池，并且在最基本的示例中没有显示。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-11-14T23:01:31.910

[Jetty HTTP 客户端](http://wiki.eclipse.org/Jetty/Tutorial/HttpClient)是异步的。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-06-18T19:01:05.300

看起来你想要 NIO 的（一部分）——这里有一个很好的教程[，](http://www.cs.brown.edu/courses/cs161/papers/j-nio-ltr.pdf)异步网络部分从 p 开始。30，最后有很多有用的链接。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2015-11-16T15:54:32.310

在 NIO/Netty 之上编写了一些库和框架 - [RxNetty](https://github.com/ReactiveX/RxNetty)和[Vertx](http://vertx.io/docs/)有助于编写异步 HTTP 客户端

下面是使用 vertx 的示例代码

```
public class Client extends AbstractVerticle {

  @Override
  public void start() throws Exception {
    //lambda callback would be called when the response comes back
    vertx.createHttpClient().getNow(8080, "localhost", "/", resp -> {
      System.out.println("Got response " + resp.statusCode());
      resp.bodyHandler(body -> {
        System.out.println("Got data " + body.toString("ISO-8859-1"));
      });
    });
   //this code statement will execute before response comes back
   System.out.println("I am not blocked");
  }
} 
```

[你可以从这里](https://github.com/vert-x3/vertx-examples/blob/master/core-examples/src/main/java/io/vertx/example/core/http/simple/Client.java)找到完整的示例代码

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-07-18T11:05:10.910

还可以查看[http://www.javaworld.com/javaworld/jw-03-2008/jw-03-asynchhttp.html](http://www.javaworld.com/javaworld/jw-03-2008/jw-03-asynchhttp.html) 本文讨论基于名为 xLightweb 的 HttpClient 的异步 HTTP

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-18T19:33:42.417

因此，可能值得考虑的是 actionscript 和 Java 不服务于相同的利基市场。例如，Java 确实让一些事情变得更加乏味 - 但通常是为用户提供更多选项，例如如何执行 HTTP 连接，而 actionscript 可能会抽象出细节或可能的错误以方便使用。但是，你的观点仍然成立。

我自己不知道 Java 的异步 HTTP 客户端。Alex Martelli 的回答谈到了 Java 的 NIO，如果您有兴趣在自己的代码中实现 HTTP 协议，这是一个很好的回答。NIO 将允许您使用套接字连接到 Web 服务器 - 但是您必须手动创建自己的 GET 请求并解析传入的 HTTP 标头/数据。

另一种选择是使用 java.net.URL 类 - 您可以在网上和 stackoverflow 上找到许多教程。您可以将它们包装在线程中 - 因此您的 java 程序有多个执行线程。

但是随后您遇到了同步问题。我同意，这是一种痛苦，但它提供了更细粒度的灵活性。

（我意识到这并不能回答你的问题——如果有人真的知道一个 java 工具来执行异步 http 请求，我很想知道！）

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-06-18T19:51:58.230

AFAIK TCPMon 工具采用与您描述的方法类似的方法。您可以在他们的[SVN 浏览器中查看源代码](https://github.com/antvale/tcpmon)

还可以查看[WGET-java](http://code.google.com/p/wget-java/)以了解阻塞代码的内容。

但是你必须用Java写这个吗？还有很多其他方法使用 JRuby 或 Rhino 来轻松完成类似的事情，这些方法将在 JVM 上运行，但不是用 Java 编写的。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-06-18T20:19:23.587

[httpunit](http://httpunit.sourceforge.net/)和[htmlunit](http://htmlunit.sourceforge.net/)是 2 个可定制和可配置的 Java http 客户端，能够用于任何浏览器，例如模拟 firefox、无头浏览、预定软件客户端和代理。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-06-18T20:26:17.677

I'd recommend firing separate threads for that.

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2010-07-29T12:21:49.530

Asyncweb 提供了一个异步 http 客户端及其 http 服务器。可从以下位置下载：

[https://svn.apache.org/repos/asf/mina/asyncweb/trunk](https://svn.apache.org/repos/asf/mina/asyncweb/trunk)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-08-07T18:06:29.360

我刚刚偶然发现了在 Geronimo 中实现的异步 HTTP 客户端。您可能还想看看它，在[http://svn.apache.org/viewvc/geronimo/sandbox/AsyncHttpClient/](http://svn.apache.org/viewvc/geronimo/sandbox/AsyncHttpClient/) - 警告：最新的提交似乎超过一年了。

另一个构建异步 HTTP 客户端的项目是 xsocket：xsocket.sourceforge.net

# c# - 在c#中捕获链接的rel类型和href

> ID：1014534
> 
> 赞同：3
> 
> 时间：2009-06-18T18:55:20.833
> 
> 标签：c#, parsing

我有一个字符串，它应该包含表单中的项目列表，{0}、{1} 和 {2} 是字符串，我想基本上提取它们。

我确实想为部分 html 解析问题执行此操作，并且我听说使用正则表达式解析 html 很糟糕。（像[这里](https://stackoverflow.com/questions/671323/getting-the-value-of-href-attributes-in-all-a-tags-on-a-html-file-with-python)）

我什至不确定如何使用正则表达式来做到这一点。

这是据我所知

```
string format = "<link rel=\".*\" type=\".*\" href=\".*\">";
Regex reg = new Regex(format);
MatchCollection matches = reg.Matches(input, 0);
foreach (Match match in matches)
 {
        string rel = string.Empty;
        string type = string.Empty;
        string href = string.Empty;
        //not sure what to do here to get these values for each from the match
 } 
```

在我的研究出现之前，我使用正则表达式可能完全走错了路。

您将如何使用我选择的方法或使用 HTML 解析器来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T18:59:31.433

使用 HTML Agility 包库解析你的 HTML，可以在[这里找到](http://www.codeplex.com/htmlagilitypack)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T19:12:46.483

您最好使用真正的 HTML 解析器，例如 Html Agility Pack。你可以在[这里](http://www.codeplex.com/htmlagilitypack)得到它。

不使用正则表达式进行 HTML 解析的一个主要原因是它的格式可能不正确（几乎总是如此），这可能会破坏您的正则表达式解析器。

然后，您将使用 XPath 获取您需要的节点并将它们加载到变量中。

```
HtmlDocument htmlDoc = new HtmlDocument();
htmlDoc.LoadHtml(pageMarkup);
HtmlNodeCollection nodes = htmlDoc.DocumentNode.SelectNodes("//link");
string rel;

if(nodes[0].Attributes["rel"] != null)
{
    rel = nodes[0].Attributes["rel"]; 
} 
```

# c# - float.Parse() 不能按我想要的方式工作

> ID：1014535
> 
> 赞同：18
> 
> 时间：2009-06-18T18:55:21.830
> 
> 标签：c#

我有一个文本文件，我用它来将信息输入到我的应用程序中。问题是某些值是浮动的，有时它们是空的，这就是我得到异常的原因。

```
 var s = "0.0";
        var f = float.Parse(s); 
```

上面的代码在第 2 行“输入字符串格式不正确”抛出异常。

我相信解决方案将是 float.Parse 的高级重载，其中包括 IFormatProvider 作为参数，但我对此一无所知。

如何解析“0.0”？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-06-18T19:00:47.470

点符号“.” 不用作分隔符（这取决于文化设置）。因此，如果您想绝对确定 dot 被正确解析，您需要编写如下内容：

```
CultureInfo ci = (CultureInfo)CultureInfo.CurrentCulture.Clone();
ci.NumberFormat.CurrencyDecimalSeparator = ".";
avarage = double.Parse("0.0",NumberStyles.Any,ci); 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2015-01-25T11:18:47.267

以下对我有用：

```
string stringVal = "0.0";
float floatVal = float.Parse(stringVal , CultureInfo.InvariantCulture.NumberFormat); 
```

相反的情况（适用于所有国家）：

```
float floatVal = 0.0f;
string stringVal = floatVal.ToString("F1", new CultureInfo("en-US").NumberFormat); 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-06-19T13:55:36.433

您可以先检查 null 或空字符串。

[`Parse`](http://msdn.microsoft.com/library/system.single.parse)您还可以使用（甚至使用）的重载之一[`TryParse`](http://msdn.microsoft.com/library/system.single.parse)来提供更具体的控制。

例如，使用不变的文化进行检查，以避免与非用户可见数据（例如来自 A2A 通信）的小数分隔符变化：

```
float SafeParse(string input) {
  if (String.IsNullOrEmpty(input)) { throw new ArgumentNullException("input"); }

  float res;
  if (Single.TryParse(input, NumberStyles.Float, CultureInfo.InvariantCulture, out res)) {
    return res;
  }

  return 0.0f; // Or perhaps throw your own exception type
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-18T18:59:39.093

我刚刚尝试过，它根本没有抛出任何异常。

您的数字格式是使用十进制逗号而不是小数点吗？你有没有尝试过：

```
var s = "0,0";
var f = float.Parse(s); 
```

*问了这个之后，我刚刚用逗号尝试了它，希望得到一个例外，但没有。所以这可能不是答案。*

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-18T19:00:34.863

或者，您可以简单地检查输入文本是否不为空或为空。

另外，要小心，因为在某些国家，“。” （点）分隔浮点数是“，”（逗号）

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2020-04-21T10:19:58.750

这应该有效。

`var s = "0.0"; var f = float.Parse(s, CultureInfo.InvariantCulture);`

# c++ - 共享库中的静态类成员

> ID：1014538
> 
> 赞同：3
> 
> 时间：2009-06-18T18:55:55.560
> 
> 标签：c++, visual-studio, dll, shared-libraries, unresolved-external

我有一个像

```
class K {
  static int a;
  static int b;
} 
```

我想创建一个包含此类的共享库 (dll) `K`。在我调用的库中编译的 cpp 文件中

```
int K::a = 0;
int K::b = 0; 
```

实例化静态变量。dll 确实编译没有错误，但是当我使用该库时，我得到了成员的未解决的外部符号错误`K::a`和`K::b`. 在我想使用它的主程序中，我在 class 的声明中包含相同的头文件`K`，唯一的区别是我使用的库 `class __declspec( dllexport ) K { ... }` 和主程序`class K { ... }`

可能我犯了不止一个错误，所以我的问题是，我怎么能

*   告诉链接器共享库中的静态成员类？
*   在主程序中使用库中实例化的静态类成员？

PS。我使用 Visual Studio 2008...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T19:50:32.443

应该`__declspec( dllimport )`在主应用程序的标题中使用。

所以这是解决方案。头文件（包含在库和主应用程序中）是：

```
#ifdef COMPILE_DLL
#define DLL_SPEC __declspec( dllexport )
#else
#define DLL_SPEC __declspec( dllimport )
#endif

class DLL_SPEC K {
   static int a;
   static int b;
} 
```

库中的 cpp 文件包含：

```
int K::a = 0;
int K::b = 0; 
```

要编译库，必须定义宏 COMPILE_DLL，对于主应用程序，它不应该被定义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T19:12:52.880

静态链接库而不是动态链接。

或者在 DLL 中添加一个返回值的全局函数。

# jquery - jQuery 显示隐藏内容和更改链接

> ID：1014539
> 
> 赞同：5
> 
> 时间：2009-06-18T18:56:10.770
> 
> 标签：jquery

在我的一些公司页面上，我想在单击链接时使用显示和隐藏切换详细信息。

我用过 .toggle() 但是....

但这是一个小问题，当用户点击**显示更多**内容时应该向下滑动，更重要的是这个文本“显示更多”应该更改为“**显示更少**”，这应该是切换。我希望你清楚我真正需要什么。

谢谢

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-06-18T19:21:17.060

约翰麦科勒姆基本上有你的答案，但你也可以使用 Javascript 速记来让你的代码更紧凑一点：

```
$('#toggle').click(function(ev) { 
    $('#content').toggle(); 
    this.html(($('#toggle').text() == 'Show more') ? 'Show less' : 'Show more');
 }) 
```

编辑：为清楚起见，我还将添加`html`上述代码正常工作所需的标记。在此示例中，所有内容都显示为开始。

```
<p><a id="toggle" href="#">Show less</a></p>
<div id="content"><!-- your stuff goes here. --></div> 
```

如果您希望一开始就隐藏它，您只需将链接文本更改为`"Show more"`并将以下样式规则添加到您的样式表中：

```
#content { display: none; } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-18T19:19:05.317

创建切换功能以设置链接文本并为内容 div 设置动画

```
$('a.toggle').toggle( 
    function() { 
        $('#contentDiv').slideDown(); 
        $(this).html('Show less');
    }, 
    function() { 
        $('#contentDiv').slideUp(); 
        $(this).html('Show more');
    } 
); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-18T19:17:12.200

这个应该做...

HTML：

```
 <a href="#" id="expand">
        <span class="linktext" >Show More</span>
        <span class="linktext" style="display:none">Show Less
        </span>
    </a>
    <div id="details" style="display:none"><h1>This is the details</h1></div> 
```

Javascript：

```
$('a#expand').click(function() {
        $('div#details').slideToggle();
        $('span.linktext').toggle();
    }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-18T19:00:01.590

您可以通过执行以下操作更改具有 id 'toggle' 的链接的值：

HTML：

```
<a href="#" id="toggle">Show More</a> 
```

jQuery（在您的切换功能中）：

```
$('a#toggle').text('Show less'); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-18T19:06:30.317

[`hide()`](http://api.jquery.com/hide/)您可以使用 jquery和函数隐藏和显示元素[`show()`](http://api.jquery.com/show/)，还有一个[`slideDown`](http://api.jquery.com/slideDown/)函数。

所以你会在onclick上触发这样的事情

```
$("#showMore").click(function(){
    $("#showMore").hide();
    $("#showLess").show();
    $("#contentDiv").slideDown();
} 
```

应该就可以了，如果您还有其他问题，请告诉我。

# .net - 在 .NET 中动态更改委托功能的公认方法是什么？

> ID：1014542
> 
> 赞同：1
> 
> 时间：2009-06-18T18:56:47.150
> 
> 标签：.net, vb.net, delegates

假设我有一个类，它表示要使用多种不同定价策略之一定价的产品。此定价每秒发生数百次，因此为了消除重复的 if/else 语句，我改为使用委托来启动适当的策略，如下所示：

```
Private Delegate Sub PricingModel(ByVal params As PricingParameters)
Private myPricingModel As PricingModel
Private myPricingParameters As PricingParameters

Public Sub RunPricingModel()
    myPricingModel(myPricingParameters)
End Sub 
```

我的问题是：如果我希望能够改变策略，我该如何处理 myPricingModel？目前我只是将它设置为一个新的定价模型：

```
Public Sub SwitchStrategy(ByVal strategy As PricingStrategy)
    Select Case strategy
        Case PricingStrategy.STRATEGY_X
            myPricingModel = New PricingModel(AddressOf PricingModelStrategyX)
        Case PricingStrategy.STRATEGY_Y
            myPricingModel = New PricingModel(AddressOf PricingModelStrategyY)
        Case Else
            Exit Sub
    End Select
End Sub 
```

但这对我来说看起来不正确（尽管它似乎有效）。有没有一种可接受的/更好的方法来做到这一点？还是这是标准方式？或者这只是从一开始就注定要失败的方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-18T19:00:00.887

这种整体方法本质上没有任何问题。只要 PricingStrategy 作为枚举在其他方面是可以接受的，那么这是为不同的定价策略改变私有行为的一种完全可以接受的方式。

我唯一挑剔的评论是，在“Case Else”中，您应该避免默默地失败。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T19:02:02.023

您可以拥有一个带有定价策略 (C#) 的静态类：

```
public static class PricingStrategies {
    public static PricingStrategyX( PricingParameters parameters ) { /* here is body */ }
    public static PricingStrategyY( PricingParameters parameters ) { /* here is body */ }
}

// ... somewhere elsewhere ...
public PricingStrategyDelegate Pricing;
// ...
this.Pricing = PricingStrategies.PricingStrategyX; 
```

# apache - 如何在 wamp 上配置 codeigniter mod_rewrite？

> ID：1014547
> 
> 赞同：2
> 
> 时间：2009-06-18T18:57:58.067
> 
> 标签：apache, mod-rewrite, wamp

大家好，你能告诉我如何在 wamp 上配置 codeigniter mod_rewrite 吗？

我尝试通过 wamp 菜单（wamp-->apache-->apache 模块-->rewrite 模块）启用它并重新启动 wamp，但它就像什么也没发生。

我问你们这是因为我需要通过 .htaccess 摆脱我的 codeigniter url 中的 index.php

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-05T04:54:18.183

您需要遵循总共 4 个简单的步骤（我认为您已经安装了 WAMP，`C:\wamp`并且 CodeIgniter 已被提取到`C:\wamp\www\codeigniter\`）：

1.  创建一个 .htaccess 文件，如[http://codeigniter.com/wiki/mod_rewrite](http://codeigniter.com/wiki/mod_rewrite)`RewriteBase /`中所述，但根据`RewriteBase /codeigniter/`您的路径替换。
2.  将此文件放在`C:\wamp\www\codeigniter\`文件夹中
3.  `WAMP->Apache->httpd.conf`从或手动打开 httpd.conf 文件，`C:\wamp\bin\Apache\conf\httpd.conf`然后找到该行`#LoadModule rewrite_module modules/mod_rewrite.so`并从开头替换哈希（#），使完整的行变为`LoadModule rewrite_module modules/mod_rewrite.so`. 现在重新启动 Apache。
4.  最后打开文件`C:\wamp\www\codeigniter\application\config\config.php`并`$config['index_page'] = "index.php";`用这个替换`$config['index_page'] = "";`

您的网址现在应该是干净的示例`http://localhost/codeigniter/blog`等。

如果它不起作用，请参阅官方 wiki：[http ://codeigniter.com/wiki/mod_rewrite](http://codeigniter.com/wiki/mod_rewrite)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-09-30T08:51:08.607

1.  按照上述步骤（ans 1）**启用 mod_rewrite**。

2.  要检查是否启用，请使用 WAMPManager 菜单，如下所示： **wampmanager -> Apache -> 模块**（滚动列表并确保已勾选）

3.  在 index.php 所在的根 CI 文件夹上创建/编辑 .htaccess。

    ```
    <IfModule mod_rewrite.c>

        RewriteEngine On

        RewriteCond %{REQUEST_FILENAME} !-f

        RewriteCond %{REQUEST_FILENAME} !-d

        RewriteRule ^(.*)$ index.php/$1 [L]

    </IfModule> 
    ```

    [CodeIgniter 网址](https://www.codeigniter.com/userguide3/general/urls.html)

4.  编辑**config.php**到`$config['index_page'] = '';`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-10-04T04:30:45.840

可能是根（应用程序文件夹）中的 .htaccess 文件拒绝写入。将其更改为允许所有人

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-03-22T16:04:24.257

在您的根 CI 文件夹（index.php 所在的位置）上创建/编辑 .htaccess

```
<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteCond %{REQUEST_URI} ^system.*
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^(.*)$ index.php?/$1 [L]
    RewriteRule ^(.*)$ /index.php?/$1 [L]
</IfModule> 
```

# c++ - mfc 复制 CString 的某些部分

> ID：1014550
> 
> 赞同：2
> 
> 时间：2009-06-18T18:58:08.207
> 
> 标签：c++, mfc, stl, cstring

假设我有一个带有字符串“Bob Evans”的 CString 变量。我想从位置 4 复制到原始 CString 的末尾到一个新的 CString，但是我很难找到语义示例：

```
CString original("Bob Evans");
// Below is what I'm trying to do
// CString newStr = original.copy(4, original.GetLength()); 
```

我还考虑过将变量**original**复制到 STL C++ 字符串，但就转换而言，实现这一点也不是那么容易。您对此有何建议？我可以先将字符串存储在 STL 字符串中，但这将是最后的手段之一，因为我不想重组大量代码只是为了将数据存储在 STL 字符串而不是 CString 中。提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-18T19:00:02.993

```
newStr = original.Mid(4); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T19:10:03.150

`CString`将 a转换为标准字符串并不难。唯一的问题是，如果您为 MFC 程序采用默认设置，您可能正在使用 Unicode。这意味着您将要使用`std::wstring`而不是`std::string`.

我没有对此进行测试，但我认为默认转换会让它“正常工作”。否则将 CString 转换为 LPCTSTR。

```
std::wstring copyOfOriginal(original); 
```

# javascript - jQuery Datepicker 触发 POST

> ID：1014554
> 
> 赞同：0
> 
> 时间：2009-06-18T18:58:53.823
> 
> 标签：javascript, jquery, jquery-ui, datepicker, uidatepicker

我想使用 jquery UI 的 datepicker 来触发一个 POST，然后从我的数据库中的 datepicker 上选择的日期加载信息。

所以我想这是一个两部分的问题

有没有一种方法可以让日期选择器日期在被选中时被传递到一个 POST 中，所以有人会点击 2010 年 1 月 1 日，它会自动转到 mysite.com?date=01012010 或类似的方式现在是 datepicker 只是用日期更新一个文本框，所以在点击 2010 年 1 月 1 日时，文本框会填充 01-01-2010

如果无法执行我在第 1 部分中提出的要求，这会将我带到第 2 部分，是否有一种方法可以触发正在更新的文本框上的事件，这样我就可以做到

onTextUpdate{

重定向到 - mysite.com?date=$whateverIsInTextBox

}

或类似的东西

如果您有任何解决方案或想法，请告诉我，非常感谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-18T19:07:42.450

如果你不想使用 ajax，你可以这样做：

```
$("#datepicker").datepicker({

    onSelect: function(date, instance) {
            window.location = "www.example.com/?date="+date;
    }
}); 
```

如果你这样做：

```
$("#datepicker").datepicker({

    onSelect: function(date, instance) {

        $.ajax
        ({
            type: "GET",
            url: "www.example.com",
            data: "date="+date,
            success: function(result)
            {
               //do something
            }
       });  
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T19:02:28.090

使用日期选择器的 OnSelect 事件

```
$('id').datepicker({
   onSelect: function(dateText, ins) { ... }
}); 
```

您可以根据您的要求尝试日期选择器控件的其他事件

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T19:02:58.213

jQuery datepicker 小部件附加了许多事件；onSelect 应该涵盖上面的第 1 点：

```
$('.selector').datepicker({
   onSelect: function(dateText, inst) { ... }
}); 
```

在您的情况下，您可以使用 $.GET 或 $.POST 函数将数据传递给服务器。

# sharepoint - 自定义列表比较 Sharepoint 中的日期

> ID：1014568
> 
> 赞同：2
> 
> 时间：2009-06-18T19:00:15.660
> 
> 标签：sharepoint, moss, date, compare

我正在创建两列开始和结束日期，当用户输入结束日期时，我应该用开始日期验证它以检查它是否大于开始日期，有没有办法做到这一点？我为此使用自定义库，我的要求是我必须存储一个包含开始日期和结束日期的文档，并且我需要对其进行一些验证。

谢谢您的帮助

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-18T19:43:05.657

如果您需要在 UI 中进行验证，我会使用自定义字段类型。

如果您需要在库中创建时进行检查，我会使用 eventreceiver 和 ItemUpdating/ItemAdding 事件。

或者也许是一个组合......

如果这是您想要的，请告诉我，我会为您提供一些代码示例（如果您需要）。

**更新：**

如果您需要自定义字段类型的示例，请参阅这篇[文章](https://stackoverflow.com/questions/997448/how-to-manage-column-based-access-control-in-sharepoint-lists/997773#997773)。实际上，如果您将一个特殊的 css 类添加到呈现的控件，然后添加您的 JQuery 以在客户端验证它，您实际上可以将它与一些 JQuery 结合起来。

我不知道您是否需要事件接收器的示例或如何添加一个，但无论如何这里有一个链接：

[添加 eventreceiver 扩展方法示例](http://johanleino.spaces.live.com/blog/cns!6BE273C70C45B5D1!178.entry)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-18T22:31:34.193

自定义字段类型似乎有点矫枉过正（至少对于 UI 验证而言）。我会为此使用 JQuery，然后按照 Johan 的 eventreciever 建议来验证服务器端。

编辑：如果需要，我可以将 JQuery 串在一起以验证字段。

# python - 使用 urllib2 进行 Python 身份验证

> ID：1014570
> 
> 赞同：4
> 
> 时间：2009-06-18T19:00:28.047
> 
> 标签：python

因此，我正在尝试使用 python 从名为 vsearch.cisco.com 的站点下载文件

[Python]

```
#Connects to the Cisco Server and Downloads files at the URL specified

import urllib2

#Define Useful Variables

url = 'http://vsearch.cisco.com'
username = 'xxxxxxxx'
password = 'xxxxxxxx'
realm = 'CEC'

# Begin Making connection

# Create a Handler -- Also could be where the error lies

handler = urllib2.HTTPDigestAuthHandler()
handler.add_password(realm,url,username,password)

# Create an Opener

opener = urllib2.build_opener(handler)
urllib2.install_opener(opener)

try:
    urllib2.urlopen(url)
    print f.read()

except urllib2.HTTPError, e:
    print e.code
    print e.header 
```

[/Python]

我的错误是 ValueError: AbstractDigestAuthHandler 不知道基本的

我尝试过使用基本 HTML 授权处理程序，甚至 HTTPS 处理程序。没有什么可以让我访问。但是，此错误与所有其他错误不同。其他错误只是 401 HTML 错误

关于如何做到这一点的任何建议？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-18T19:13:13.270

“密码管理器”可能会有所帮助：

```
 mgr = urllib2.HTTPPasswordMgrWithDefaultRealm()
    mgr.add_password(None, url, user, password)        
    urllib2.build_opener(urllib2.HTTPBasicAuthHandler(mgr),
                         urllib2.HTTPDigestAuthHandler(mgr)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T19:09:54.117

至于我在测试中尝试的内容（[http://devel.almad.net/trac/django-http-digest/browser/djangohttpdigest/tests/test_simple_digest.py](http://devel.almad.net/trac/django-http-digest/browser/djangohttpdigest/tests/test_simple_digest.py)），错误可能在您的网址中 - 为了使其正常工作，我已经包含了 http:// 部分，而不仅仅是主机。

# c# - 由于没有 Sqlserver 数组参数，那么最好的方法是什么？

> ID：1014571
> 
> 赞同：4
> 
> 时间：2009-06-18T19:00:28.623
> 
> 标签：c#, asp.net, sql-server, sql-server-2005, stored-procedures

我需要在 sqlserver 中创建多个记录，每个记录在 A 列中具有相同的值，但在 B 列中具有唯一值。我在数组中有 B 列的值。

我正在使用 VS2008、aspnet、c# 3.5、sqlserver 2005。

我过得更好吗

选项1。

从 c# 代码对 sqlserver 中的存储过程进行 1 次调用，然后在 tsql 中的存储过程中进行所有处理工作？

这将涉及将 c# 数组中的所有值组合成一个逗号分隔的字符串，并将该字符串作为参数传递给 tsql，然后循环并将字符串拆分为单独的值，并为每个值插入一条记录，所有这些都在存储过程中。

据我所知，如果需要，这将涉及简单的回滚，但在 tsql 中字符串处理非常笨拙。

或者

选项 2。

在 c# 中进行循环并将数据作为 sqlparams 从 c# 一次记录一条记录传递到存储的 proc 以插入每条记录。

即，foreach（myarray 中的 int 键）……插入一条记录

我可以在睡梦中执行此代码，但如果在处理过程中发生某些事情，我将如何回滚？我应该在单个connection.open和connection.close中进行循环吗？

有人有其他选择吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-18T19:02:36.110

此处广泛介绍了此主题：[SQL 2005 中的数组和列表](http://www.sommarskog.se/arrays-in-sql-2005.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-18T19:14:44.577

实现这一点的最简单方法是使用选项 1：将数组作为分隔字符串传递。我曾经在 sql2005 之前的日子里结合这个**[TSQL Split Function](http://blogs.microsoft.co.il/blogs/itai/archive/2009/02/01/t-sql-split-function.aspx)**来做这件事。我会使用“|”传递数组 作为分隔符。

这些天来，我将数组序列化为 XML，然后将内容插入到表变量中，以便使用**[`sp_xml_preparedocument`](http://msdn.microsoft.com/en-us/library/ms187367.aspx)**存储过程进行处理。

我不会使用选项 2，因为它会多次调用数据库。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-18T19:04:20.990

两个选项都有其优点（选项 1 是单次往返，选项 2 不使用伪字符串处理），但我最终可能会选择选项 2。选项 1 的大小限制为`varchars`(8000，除非您使用; 我不知道在一个非常长的逗号分隔的字符串`varchar(MAX)`上会有什么表现）。`varchar(MAX)`

至于回滚，是的，只需在一个打开的连接上执行所有操作并使用一个`SqlTransaction`对象。

例如...

```
using(SqlConnection conn = new SqlConnection("connection string"))
{
    conn.Open();

    using(SqlTransaction trans = conn.BeginTrasnaction())
    {
        try
        {
            using(SqlCommand cmd = new SqlCommand("command text", conn, trans))
            {
                SqlParameter aParam = new SqlParameter("a", SqlDbType.Int);
                SqlParameter bParam = new SqlParameter("b", SqlDbType.Int);

                cmd.Parameters.Add(aParam);
                cmd.Parameters.Add(bParam);

                aParam.Value = 1;

                foreach(int value in bValues)
                {
                    bValue = value;

                    cmd.ExecuteNonQuery();
                }
            }

            trans.Commit();
        }
        catch
        {
            trans.Rollback();

            throw; // so the exception can propogate up
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-18T19:15:57.320

不确定这是否完全适合您的情况，但很多时候，当我们需要将 N 大小的数据数组传递到存储过程中时，我们将使用临时表技巧。仅此而已：

```
using (SqlConnection connection = new SqlConnection(connectionstring)) {
   connection.Open();

   string sql = "CREATE TABLE #foo (myvalue [INT]) ";
   using (SqlCommand command = connection.CreateCommand()) {
      command.CommandText = sql;
      command.CommandType = CommandType.Text;

      command.ExecuteNonQuery(); // create the temp table

      foreach (int value in myValuesList) {
         command.CommandText = "INSERT INTO #foo ([myvalue]) VALUES (" + value + ") ";

         command.ExecuteNonQuery();
      }

      command.CommandType = CommandType.StoredProcedure;
      command.CommandText = "StoredProcThatUsesFoo";

      // fill in any other parameters

      command.ExecuteNonQuery();
   }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-18T19:23:17.180

如果您想在 C# 的循环中执行多个插入操作，请查看 TransactionScope。这将允许您将对存储过程的多个调用滚动到具有回滚功能的事务中。另一种选择是您可以将数组作为 XML 传递，并且在存储的过程中，您可以将该 XML 分解到临时表中以在您的过程中使用。

您应该做的最后一件事是将[表值参数](http://msdn.microsoft.com/en-us/library/bb510489.aspx)添加到您升级到下一版本 SQL Server 的原因的愿望清单中。随着愿望清单的增加，您花钱升级的理由变得更容易了。

# html - 访问 iFrame 中的变量，反之亦然

> ID：1014576
> 
> 赞同：1
> 
> 时间：2009-06-18T19:00:47.983
> 
> 标签：html, iframe, variables, air, adobe

我有一个带有 iFrame 的 html 页面，我想从中读取一些变量。它基本上是一张地图，我想从中检索纬度和经度值。

我一直在使用 Adob​​e AIR，并且尝试从 innerHTML、contentWindow 中检索值，但仍然无法使其正常工作。

有什么好方法可以完成这项工作吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T17:21:54.943

浏览器安全模型禁止任何跨域流量/通信。如果我们处理不同的子域，规则可以放宽到顶级域。但最终，你没有追索权。

如果您的应用程序需要跨域边界进行通信，那么通过后端通常是您最好的选择。如果您不控制 iframe 中的内容，您通常会很不走运。仅供参考，谷歌地图确实提供了一个 API 来使用他们的应用程序。[http://code.google.com/apis/maps/index.html](http://code.google.com/apis/maps/index.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-23T08:17:01.757

在跨域通信的情况下，非应用程序沙箱桥的应用程序工作。

谢谢各位回复。。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-21T09:44:27.920

您必须使用应用程序到非应用程序沙箱桥接。这将允许您在两个区域（iframe 和一般）之间进行通信。看看这里[http://www.adobe.com/devnet/air/ajax/quickstart/sandbox_bridge.html](http://www.adobe.com/devnet/air/ajax/quickstart/sandbox_bridge.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-18T19:23:42.063

您可以使用 jQuery 访问 iframe 中的内容。

```
<iframe id="iframeId" ...> .... <div id='someData'>data</div> ....</iframe>
$('#iframeId').contents().find('#somedata').html(); // returns data 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-22T04:57:47.610

谢谢各位回复，

@svend：“通过后端”到底是什么？我明白了。我确实控制了 iFrame 中的内容，该 iFrame 位于另一个域中。

@Webber：感谢那个链接韦伯......看起来它会为我工作......我会试试......

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-02-02T09:11:36.170

我不得不这样做：

1- 在包含 iframe 的文件中添加隐藏输入，只要用户更改它们，它们就会在其中保存 lng 和 lat。

2-在js上创建这个函数：

```
function getFrameWindow(frameId) {

  var frame = document.getElementById(frameId);
  var result = null;
  if (frame.contentDocument) {
    // For NS6
    result = frame.contentDocument.window || frame.contentDocument.defaultView; 
  } else if (frame.contentWindow) {
    // For IE5.5 and IE6
    result = frame.contentWindow;
  } else if (frame.document) {
    // For IE5
    result = frame.document.window;
  }
  return result;
} 
```

3-使用包含 iframe 的 javascript 中的此代码：

```
getFrameWindow("iframe").document.getElementById("lat").value 
```

# iphone - iPhone Accelerometer 应用程序崩溃

> ID：1014580
> 
> 赞同：1
> 
> 时间：2009-06-18T19:01:29.870
> 
> 标签：iphone, accelerometer

我有一个基于导航的应用程序，我想使用加速度计检测抖动并导致滚动视图滚动到下一页。我已将加速度计代码添加到我的 scrollView 的视图控制器中，效果很好；震动调用我的页面更改方法。但是当我从导航堆栈中卸载 scrollViewController 时，应用程序崩溃了。

我在scrollViewController的viewDidLoad方法中设置了加速度计，并在加速度计中响应抖动：didAccelerate：委托方法。

当 scrollViewController 被释放时，应用程序崩溃。

我错过了什么？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-18T20:22:53.487

Found the answer in another thread:

[How do you release a shared accelerator instance on the iPhone?](https://stackoverflow.com/questions/740519/how-do-you-release-a-shared-accelerator-instance-on-the-iphone)

I needed to set the accelerometer's delegate to nil when my scrollView deallocated. The accelerometer is a singleton that retains a reference to it's delegate, in this case my scrollViewController. When my scrollViewController popped off the stack, the reference was left hanging, crashing he app.

Thanks to Phil Nash for the answer!

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T20:23:33.487

Simple: by setting the delegate method you have told another object (the accelerometer) that the scrollview exists.

But did you tell it when it ceased to exist, so it could no not to send any messages to it?

I guess not. You need to set the delegate again, to nil this time.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T19:04:00.303

加速度计的更新速率是多少？我听说如果它太高会发生奇怪的事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-18T20:09:49.160

我无法发表评论，所以我不得不在答案中发布这个。您可以显示新视图页面的加载方式吗？据我了解，一旦您摇动它，它就会切换到新视图。你能显示你对新视图的调用吗？

# iphone - ipod touch 上的临时分发

> ID：1014582
> 
> 赞同：1
> 
> 时间：2009-06-18T19:02:03.600
> 
> 标签：iphone, ipod-touch, provisioning, adhoc

我正在为 iPhone 开发一款游戏，并且至少有 8 个人使用 ad-hoc 分发为我进行 beta 测试。我创建了一个包含所有电话 ID 的配置文件，并使用该配置文件构建了我的应用程序。

我通过电子邮件将应用程序和移动配置文件发送给人们。其中三个有 ipod touch 设备。它似乎可以在 iphone 上正确安装。但是 ipod touch 的两个用户尝试安装它并且遇到了问题（第三个直到今晚才能尝试），文件的拖动似乎被 iTunes 接受，然后在同步期间应用程序被拒绝为未经授权（消息类似于“无法验证应用程序”）。

对可能发生的事情有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T19:45:00.333

我以前也看到过这种情况发生在 iPhone 上。我认为正在发生的事情是，有时应用程序会在配置文件之前尝试同步。通常第二次同步将允许应用程序安装得很好。您可能让您的用户尝试的另一件事是通过 iPhone 配置实用程序 ( [http://www.apple.com/support/iphone/enterprise/](http://www.apple.com/support/iphone/enterprise/) ) 安装配置文件和应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-23T16:21:45.177

为了解决这个问题，我首先必须清除我的所有证书并重新创建它们，以确保电子邮件地址和名称与开发者网站认为的完全匹配。

然后我必须创建一个 Ad-Hoc 分发配置文件（在我只创建一个开发配置文件之前）

我在这个[网站上找到了答案](http://www.gqadonis.com/?p=47)

# java - 强制 Java 调用我的 C++ 析构函数 (JNI)

> ID：1014584
> 
> 赞同：11
> 
> 时间：2009-06-18T19:02:14.190
> 
> 标签：java, c++, java-native-interface

我以为以前会问过这个问题，但我在这里找不到...

我使用 SWIG 围绕 C++ 类创建了一个 JNI 包装器。一切都很好，除了 Java 似乎从不调用类的 finalize()，因此，反过来，我的类的析构函数永远不会被调用。该类的析构函数执行一些最终文件 I/O，因此不幸的是，这不仅仅是轻微的内存泄漏。

通过谷歌搜索，似乎没有办法强制 Java 进行 GC 并销毁对象。真的？

我知道我可以操纵我的 SWIG 文件并创建一个调用 C++ 析构函数的 java 函数，但是这个类被最终用户在几种不同的平台/语言中使用，所以添加一个纯 Java 会造成我们的技术不一致作家们不会喜欢的。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-18T19:50:57.483

您不能使用 System.gc() 强制 GC。此外，如果您的应用程序仅运行很短的时间然后您的终结器根本不会运行（JVM 在退出时不会运行它），也不能保证会运行 GC。您应该为您的类创建一个 close() 或 destroy() 或任何函数，并在使用完此类的实例后调用它，最好从 finally 块中调用它，例如。

```
 MyClass x = null;
try{
    x = new MyClass();
    x.work();
} finally {
    if (x!=null)
        x.close();
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-18T19:45:36.573

在我看来，Java 终结器大多没用，当然也不能替代 C++ 析构函数。不幸的是，Java 无法替代 C++ RAII。

不要费心试图强制 Java 完成。当您完成任何事情时，所有功能都会处理它。这就是你所能做的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-18T21:15:26.017

如果您依赖`finalize`方法中的代码在某个时间运行，则需要重新考虑您的方法。这里的问题是你不知道`finalize`JVM 什么时候会调用，因为你不知道对象什么时候会被垃圾回收。

由于您的类将在其他项目中重用，因此您应该考虑的一件事是，最终用户可能会以不会被收集或垃圾收集的方式使用类的实例不太可能，例如创建对类实例的静态引用。我认为创建`close`or`destroy`方法是确保与您的 Java 对象关联的 C++ 类的实例正在使用的资源被适当释放的最安全的选择。

由于重用是一个问题，您可以让 C++ 析构函数检查资源是否已释放，如果没有释放，则调用相同的代码，如下所示：

```
class MyThing {
  public:
    void close();
    ~MyThing();

  private:
    bool released = false;
};

void
MyThing::close() {
  // close logic here
  this->released = true;
}

MyThing::~MyThing() {
  if (!released) {
    this->close();
  }
} 
```

通过这种方式，您现有的 C++ 代码有望不必进行太多更改，并且您可以确保在通过 JNI 运行的本机代码的上下文中以确定性方式释放资源。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-19T13:15:00.557

在仔细查看 SWIG 生成的代码之后，我发现 SWIG 人员实际上已经处理了这个问题——他们为您添加了一个 delete() 函数。它看起来很好地处理了程序员和 GC 删除对象的可能性。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-06-18T20:02:50.220

像这样的问题是 C# 选择[IDisposable](http://msdn.microsoft.com/en-us/library/system.idisposable.aspx)模式进行确定性终结的原因。

我建议您遵循相同的模式并针对您的 Java 用户进行调整。

在您的 c++ 类中，创建一个单独的公共方法来处理您的资源。称它为关闭，或处置，或其他东西。

让您的 C++ 析构函数调用公共方法，并告诉 C++ 类的托管/GC 用户他们必须调用该方法以避免内存泄漏。

# c# - 单击单元格时的单元格信息

> ID：1014587
> 
> 赞同：0
> 
> 时间：2009-06-18T19:02:33.443
> 
> 标签：c#, excel, events, excel-2007

单击工作表上的任何单元格时是否可以显示单元格信息？例如，如果单击单元格 A1，它将显示 A1，依此类推……如果是，你能举个例子吗？

我需要这个，因为我有 ac# 程序，它应该知道点击了哪个单元格。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T06:20:44.540

您需要使用该`WorksheetSelectionChange`事件，MSDN 上有示例代码 - [http://msdn.microsoft.com/en-us/library/microsoft.office.tools.excel.worksheet.selectionchange.aspx](http://msdn.microsoft.com/en-us/library/microsoft.office.tools.excel.worksheet.selectionchange.aspx)

```
private void WorksheetSelectionChange()
{
this.SelectionChange += 
    new Excel.DocEvents_SelectionChangeEventHandler(
    Worksheet1_SelectionChange);
}

void Worksheet1_SelectionChange(Excel.Range Target)
{
this.Application.StatusBar = this.Name + ":" +
    Target.get_Address(missing, missing,
    Excel.XlReferenceStyle.xlA1, missing, missing);
} 
```

# python - 遍历django模板中的外键相关表

> ID：1014591
> 
> 赞同：32
> 
> 时间：2009-06-18T19:02:45.017
> 
> 标签：python, django, django-models, django-templates

## 看法

```
categories = Category.objects.all()
t = loader.get_template('index.html')
v = Context({
    'categories': categories
})
return HttpResponse(t.render(v)) 
```

## 模板

```
{% for category in categories %}
    <h1>{{ category.name }}</h1>
{% endfor %} 
```

这很好用。现在我正在尝试打印该类别中的每家公司。公司表具有类别表的外键

我试过了

```
{% for company in category.company_set.all() %} 
```

似乎 django 不喜欢模板中的 ()

在 .96、1.0 和开发版本之间，我一直在 django 网站上迷失方向。我正在运行 django 版本 1.0.2

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2009-06-18T19:06:31.767

只需去掉括号：

```
{% for company in category.company_set.all %} 
```

这是[适当的文档](http://docs.djangoproject.com/en/dev/topics/templates/#variables)。您可以通过这种方式调用采用 0 个参数的方法。

# asp.net - HTML.Encode() - 它是什么/如何防止 ASP .NET 中的脚本安全问题？

> ID：1014593
> 
> 赞同：13
> 
> 时间：2009-06-18T19:03:04.533
> 
> 标签：asp.net, security

当我处理用户输入，特别是脚本问题时，HTML.Encode() 为我提供了哪些安全保护？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-06-18T19:06:40.097

请参阅[`Server.HTMLEncode`](http://msdn.microsoft.com/en-us/library/ms525347.aspx)：

> HTMLEncode 方法将 HTML 编码应用于指定的字符串。在您的 Web 应用程序中使用表单数据和其他客户端请求数据之前，这是一种快速编码表单数据和其他客户端请求数据的方法。编码数据将潜在的不安全字符转换为它们的 HTML 编码等效字符。
> 
> 如果要编码的字符串不是 DBCS，则 HTMLEncode 将字符转换如下：
> 
> *   小于号 (<) 转换为`&lt;`.
> *   大于号 (>) 转换为`&gt;`.
> *   & 符号 (&) 转换为`&amp;`.
> *   双引号字符 (") 转换为`&quot;`.
> *   任何代码大于或等于 0x80 的 ASCII 代码字符都将转换为`&#<number>`，其中 是 ASCII 字符值。

这意味着，如果您要将一些数据转储到请求流并且该数据从用户输入的字段保存到数据库中，它将阻止用户说出他们的名字是：

```
<script type="text/javascript">
    function doSomethingEvil() { /* ... */ }
</script> 
```

在此示例中，`Server.HTMLEncode`将编码`<`、`>`和`"`留下以下字符：

```
&lt;script type=&quot;text/javascript&quot;&gt;
    function doSomethingEvil() { /* ... */ }
&lt;/script&gt; 
```

如果在浏览器中呈现，它将如下所示：

> <script type="text/javascript"> function doSomethingEvil() { /* ... */ } </script>

而不是实际执行。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-18T19:09:18.220

它可以防止 XSS（跨站点脚本）攻击，因为如果它**阻止**用户输入变成可用于执行此类攻击的脚本

# actionscript-3 - Flex 弹出窗口：堆栈溢出？

> ID：1014603
> 
> 赞同：2
> 
> 时间：2009-06-18T19:04:59.087
> 
> 标签：actionscript-3, user-interface, flex3, stack-overflow

我以某种方式在 Flex 3 中创建了堆栈溢出...我试图从模态对话窗口中获取数据，如下所示：

主要应用：

```
var myPopup:MyPopup;

function buttonClick( event:MouseEvent ):void
{
myPopup = MyPopup( PopUpManager.createPopUp( this, MyPopUp, true ) );
myPopup.addEventListener( CloseEvent.CLOSE, handler, false, 0, true );
}

function handler():void
{
//get data
} 
```

我的弹出窗口：

```
function buttonHandler( MouseEvent:event ):void
{
PopUpManager.remove( this );
this.dispatchEvent( new CloseEvent( CloseEvent.CLOSE ) );
} 
```

如果这是不正确的，那么以允许我使用和检索对象数据的方式处理弹出窗口的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-20T11:24:36.457

我已经重新创建了你的代码，它对我来说很好:(这意味着要么我误解了你的问题，要么错误在你的代码中的其他地方。

您是否有机会发布有关该问题的更多详细信息？

山姆

PS这是我用来测试的代码：

应用程序.mxml：

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" layout="absolute">

    <mx:Button x="10" y="10" label="Button" click="buttonClick(event)" id="popupButton"/>

    <mx:Script>
        <![CDATA[
            import mx.core.IFlexDisplayObject;
            import mx.managers.PopUpManager;

            private var popup:Popup;

            private function buttonClick(e:MouseEvent):void {
                popup = PopUpManager.createPopUp(this, Popup, true) as Popup;
                popup.addEventListener(Event.CLOSE, popupClose, false, 0, true);
            }

            private function popupClose(e:Event):void {
                trace(popup);
                popupButton.label = "Closed";
            }
        ]]>
    </mx:Script>

</mx:Application> 
```

弹出窗口.mxml

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Canvas xmlns:mx="http://www.adobe.com/2006/mxml" width="400" height="300">
    <mx:Button x="167" y="123" label="Close me" click="buttonClick(event)"/>

    <mx:Script>
        <![CDATA[
            import mx.managers.PopUpManager;

            private function buttonClick(e:MouseEvent):void {
                dispatchEvent(new Event(Event.CLOSE));
                PopUpManager.removePopUp(this);
            }
        ]]>
    </mx:Script>

</mx:Canvas> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-21T18:49:09.560

也许您可以尝试向您的处理程序添加一个事件参数。我不太确定 ActionScript 是否总能容忍不提供的情况。例子：

```
function handler(event:CloseEvent):void {
    // Handle away
} 
```

我还支持在 Justin 提到的关闭弹出窗口之前调用处理程序的做法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-09-18T22:00:30.750

在您的示例中，移至`PopUpManager.removePopUp(this);`关闭事件处理程序，即`popupClose(e:Event)`. 您还需要将参数替换为`this`弹出窗口。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-11-27T01:04:55.937

您还需要在弹出窗口中创建一个 dispose 函数来清理事件、模型等。否则它不会被垃圾收集并减慢您的应用程序。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-18T19:19:59.230

不确定 PopUpManager 的行为方式，但您可能希望在 buttonHandler 中切换语句：

```
function buttonHandler(MouseEvent:event):void
{
    this.dispatchEvent(new CloseEvent(CloseEvent.CLOSE));
    PopUpManager.remove(this);
} 
```

当您的事件代码运行时，弹出窗口会一直保持，但它应该在您触发尝试从中获取数据的代码之前处理您的弹出对象被释放的情况。

# c# - 我应该如何将 TreeView 控件中的分层数据公开给 MVP 演示者？

> ID：1014618
> 
> 赞同：1
> 
> 时间：2009-06-18T19:08:00.220
> 
> 标签：c#, data-structures, collections, mvp, passive-view

我在 Winforms TreeView 控件中有一些分层数据，我需要将其作为属性公开，以便我的演示者可以同步对其的更改。为了清楚起见，我使用的是*被动视图*模式。对于大多数 WinForm 控件来说，这是显而易见的。控件本身将其数据公开为系统类型，可以轻松传递给演示者。TreeViews，因为它们的复杂性，不容易映射到系统类型。我寻找了一个框架集合类型，但树似乎被忽略了。（微软似乎在引擎盖下使用树结构用于几个更高级别的类，但选择不创建通用*树*类家族。）

在任何情况下，我试图公开的数据都不会超过两个节点的深度，所以我什至不确定我是否会继续使用 TreeView。更有理由避免将演示者绑定到 TreeNodeCollection。

我已经提出了一些想法，但我只是想将它们从 SO 社区中反弹：

*   将树公开为集合的集合......比如说一个列表字典。
*   创建自定义树结构，在流程中将依赖项引入视图。

顶级节点平均有 5-10 个条目，而它们的子节点理论上可以达到 50 个，但实际上不会超过 3 或 4 个。

有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-20T17:45:26.977

我认为您必须从相反的方向思考：**presenter 应该如何将层次结构暴露给 view**。而且您应该以抽象的方式考虑视图，而不是过多地关注具体实现（在您的情况下为 TreeView）。通常，当您开始使用 MVP 模式实现东西时，您将开始编写演示器逻辑，同时定义视图界面。理想情况下，您将使用 TDD 和视图的模拟实现来执行此操作。只有这样你才能实现一个具体的视图（Windows 窗体或控件）。

所以：您必须创建一个模型，然后将其传递给视图。我建议实现一个自定义层次结构（请参阅[复合模式](http://en.wikipedia.org/wiki/Composite_pattern)）。

在您的情况下，视图的实现可以使用 TreeViewNode 的 Tag 属性在 TreeView 的节点和模型中的元素之间进行映射。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T19:38:42.640

以下是三个包含树集合实现的免费 .NET 库的链接：

*   [通用树集合](http://www.codeproject.com/KB/recipes/treecollection2.aspx)
*   [Wintellect 的 .NET 电源集合](http://powercollections.codeplex.com/)
*   [C5 通用集合库](http://www.itu.dk/research/c5/)

我对他们中的任何一个都没有经验。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T19:48:44.413

如果这是一个依赖性能的应用程序，我建议使用基于树的集合

# bison - 如何解决 Bison 警告“...没有声明的类型”

> ID：1014619
> 
> 赞同：50
> 
> 时间：2009-06-18T19:08:10.500
> 
> 标签：bison

在此文件上运行 Bison：

```
%{
    #include <iostream>
    int yylex();
    void yyerror(const char*);
%}

%union
{
    char    name[100];
    int     val;
}

%token NUM ID
%right '='
%left '+' '-'
%left '*'

%%

exp :   NUM     {$$.val = $1.val;}
    | ID        {$$.val = vars[$1.name];}
    | exp '+' exp   {$$.val = $1.val + $3.val;}
    | ID '=' exp    {$$.val = vars[$1.name] = $3.val;}
;

%% 
```

导致以下警告：

> 警告：'exp' 的 $$ 没有声明的类型。

**这是什么意思，我该如何解决？**

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-06-18T19:08:34.710

定义的联合 (%union) 不打算直接使用。相反，您需要告诉 Bison 哪个成员被哪个表达式使用。

这是通过[%type 指令](http://www.gnu.org/software/bison/manual/html_node/Type-Decl.html)完成的。

代码的固定版本是：

```
%{
    #include <iostream>
    int yylex();
    void yyerror(const char*);
%}

%union
{
    char    name[100];
    int     val;
}

%token NUM ID
%right '='
%left '+' '-'
%left '*'

%type<val> exp NUM
%type<name> ID

%%

exp :   NUM     {$$ = $1;}
    | ID        {$$ = vars[$1];}
    | exp '+' exp   {$$ = $1 + $3;}
    | ID '=' exp    {$$ = vars[$1] = $3;}
;

%% 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-18T19:41:30.467

作为进一步的想法，如果你想更明确地减少你的减少（如果你正在做 AST 注释，这可能很方便），那么你可以让你的堆栈值指针，然后自己处理类型值。很像标量类型：

```
struct myScalar {
    union {
        int num;
        char *id;
        char *float_lexeme;
    }payload;

    enum {
        TYPE_NUM,
        TYPE_IDENTIFIER,
        TYPE_FLOAT_CHAR
    } type;
    char *orig_lexeme;
}; 
```

并有一个 typedef 和`scalar_val *val`堆栈。

当您转向更复杂的编译器前端时，它可以帮助您像这样构建您的 AST，这样当您遍历树时，您可以获得更好的元数据，并且您还可以通过前语义类型的翻译来增加翻译。然后归结为您的叶子产品，例如 ID，将词位洗牌到正确的标量有效负载中。

不是一个完整的解释，但你明白了。

希望这对您未来的 Bison/Lex 前端和...有所帮助

**祝你好运**

# java - 检测代码是否在应用程序服务器 java 中运行的最佳方法

> ID：1014620
> 
> 赞同：12
> 
> 时间：2009-06-18T19:08:16.757
> 
> 标签：java, joptionpane

对于 J2EE bean，我正在重用为 java swing 应用程序开发的代码。`JOptionPane.showMessageDialog()`不幸的是常用的。幸运的是，大多数发生在 J2EE 应用程序未重用的代码部分中，但在某些情况下，较低级别的代码具有`JOptionPane.showMessageDialog()`. 显然，这会导致服务器上弹出对话框，这是我想要避免的。

作为第一步，我想以某种方式确保服务器上不会出现任何对话框。

有人建议在某些事件或绘画队列中偷看（我不记得是哪一个）：那将是：

```
// old code: JOptionPane.showMessageDialog(msg);
if ( someEventQueue.size() == 0 ) // <== consider this pseudo-code
  Log.log(msg); // I am running on a server. Tell the log.
else
  JOptionPane.showMessageDialog(msg); // I have a user made of meat. Tell him! 
```

我从来没有*真正做到*这一点。你会怎么办？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-06-18T19:19:52.240

确保服务器以

```
java -Djava.awt.headless=true 
```

默认情况下，大多数服务器应该以这种方式启动。然后你可以检查：

```
boolean headless_check = GraphicsEnvironment.isHeadless(); 
```

[此处](http://www.oracle.com/technetwork/articles/javase/headless-136834.html)提供有关无头的更多详细信息：

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-30T14:49:06.613

我刚刚在 Linux 上使用 OpenJDK Runtime Environment (IcedTea 2.4.3) (Gentoo build 1.7.0_45-b31) 对此进行了测试，我发现这`unset DISPLAY`也足以让`isHeadless()`（和`isHeadlessInstance()`）返回`true`。

因此，此方法不仅告诉您 AWT 是否被迫忽略系统的图形功能，还告诉您您的进程是否完全可以访问图形功能。

示例：
代码在没有显示卡的某个盒子上运行（*这可能是您想知道的*），因此如果出于某种原因您想知道是否**强制**使用无头模式，您可以随时检查系统属性。

# .net - 错误 PRJ0019：工具从“正在复制 DLL...”返回错误代码

> ID：1014627
> 
> 赞同：2
> 
> 时间：2009-06-18T19:09:43.213
> 
> 标签：.net, c++, visual-studio

Visual Studio 出现错误**PRJ0019：工具从“正在复制 DLL...”返回错误代码。**控制台窗口包括输出：“CopyDLL.cmd”不被识别为内部或外部命令。

以下是关于为什么我不知道正在复制的工具的一些背景。有人在一年前离开公司，忘记签入他们使用 C# 和 C++ 的 MS Visual Studio 2008 项目的最新版本代码。现在我们需要修复程序，但找不到代码，我被分配尝试清理混乱。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-18T19:27:49.963

您应该检查所有项目和所有文件的自定义构建步骤（项目属性->配置属性->自定义构建步骤）。

在文本编辑器中打开 *.vcproj 文件并检查项目中各个文件下的标签可能更容易。查找任何具有非空 CommandLine 属性的标签。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-18T19:27:46.233

使用 Tools -> Options -> Projects and Solutions -> Build and Run 打开构建输出

将 MSBuild 项目构建输出详细程度设置为高于默认值。我会一次提高一个级别，因为最高级别是病态的冗长。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T09:02:08.493

转到工具->选项->目录并添加这个... C:\Program Files\Microsoft Visual Studio 9.0\Common7\IDE

这应该够了吧...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-26T19:56:31.957

我以前从未注意到，但每次你进行构建时，输出窗口都会打印一行内容：

> 构建日志保存在“file://...

按住 CTRL 键单击该链接将提供有关失败构建的更多详细信息。

就我而言，我发现了 3 个“复制”命令，文件名错误，这将我指向 vsproj 文件中的 CommandLine 属性，正如 Andrew Garrison 所建议的那样。

# iphone - Objective-C Safari 失败 - 重定向过多 - LinkSynergy - iPhone

> ID：1014629
> 
> 赞同：0
> 
> 时间：2009-06-18T19:09:57.987
> 
> 标签：iphone, objective-c, safari

所以，我正在开发一个 iPhone 应用程序，我希望通过使用 Apple 的链接协同程序重定向到 iPhone 游戏来赚钱。问题是，链接生成了太多重定向，Safari 说“Safari 无法打开页面，因为发生了太多重定向”。我的代码很简单：

```
NSURL *toOpen=[NSURL URLWithString:@"http://click.linksynergy.com/fs-bin/click?id=rSBwlRaBsug&offerid=146261.710610416&type=10&subid="];
[[UIApplication sharedApplication] openURL:toOpen]; 
```

我正在使用他们使用链接协同程序发送给您的应用程序，但这些链接在 iPhone 上不起作用。iphone 是否有另一个链接生成器，或者有没有办法直接链接到 iTunes 但仍然获得 5% 的推荐？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-05T23:37:00.017

不用担心。它只发生在模拟器中。在设备上，您的代码可以完美运行。它是 iPhone 模拟器特有的。

因此，您可以在任何 iPhone OS 版本的开发中使用您的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-01T16:24:24.857

尝试删除域的 cookie

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-01-19T20:37:11.707

“这是 cydia 插件类别！如果您安装了类别，则不会导致以下问题：-如果您隐藏 youtube 应用程序或将其放入文件夹，它将自动打开内容限制，因此在 safari 和应用程序中不起作用-如果您在文件夹中有 iTunes 或 appstore 或将其隐藏，这将导致所有应该使用它们中的任何一个打开的链接都被 safari 打开，从而为您提供上述错误......”

# c++ - 清理你的#include 语句？

> ID：1014632
> 
> 赞同：32
> 
> 时间：2009-06-18T19:10:04.943
> 
> 标签：c++, file, include, header

您如何维护 C 或 C++ 项目中的#include 语句？似乎几乎不可避免的是，最终文件中的包含语句集要么不足（但由于项目的当前状态而恰好可以工作），要么包含不再需要的内容。

您是否创建了任何工具来发现或纠正问题？有什么建议么？

我一直在考虑编写一些东西，多次单独编译每个非头文件，每次删除#include 语句。继续这样做，直到获得最少的包含集。

为了验证头文件是否包含他们需要的所有内容，我将创建一个源文件，它所做的只是包含一个头文件并尝试编译它。如果编译失败，则头文件本身缺少包含。

不过，在我创造一些东西之前，我想我应该在这里问一下。这似乎是一个有点普遍的问题。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-06-18T19:19:06.643

> 为了验证头文件是否包含他们需要的所有内容，我将创建一个源文件，它所做的只是包含一个头文件并尝试编译它。如果编译失败，则头文件本身缺少包含。

通过制定以下规则可以获得相同的效果：*foo* .c 或*foo* .cpp 必须包含的第一个头文件应该是相应命名的*foo* .h。这样做可以确保*foo* .h 包含它需要编译的任何内容。

此外，Lakos 的《*大型 C++ 软件设计*》一书（例如）列出了许多将实现细节从标头中移出并移入相应 CPP 文件的技术。如果您将其发挥到极致，使用 Cheshire Cat（隐藏所有实现细节）和 Factory（隐藏子类的存在）之类的技术，那么许多标头将能够在不包含其他标头的情况下独立存在，而只需将声明转发到不透明类型...除了模板类。

最后，每个头文件可能需要包括：

*   作为数据成员的类型没有头文件（相反，使用“柴郡猫”又名“pimpl”技术在 CPP 文件中定义/隐藏数据成员）

*   作为方法的参数或返回类型的类型没有头文件（相反，这些是预定义的类型，例如`int`; 或者，如果它们是用户定义的类型，那么它们是引用，在这种情况下，是前向声明的不透明类型声明像仅仅`class Foo;`而不是`#include "foo.h"`在头文件中就足够了）。

那么你需要的是头文件：

*   超类，如果这是一个子类

*   可能是用作方法参数和/或返回类型的任何模板化类型：显然您也应该能够前向声明模板类，但是某些编译器实现可能对此有问题（尽管您也可以封装任何模板例如`List<X>`作为用户定义类型的实现细节，例如`ListX`）。

在实践中，我可能会制作一个“standard.h”，其中包括项目中任何/所有头文件使用的所有系统文件（例如 STL 头文件、O/S 特定类型和/或任何`#define`s 等），并将其作为每个应用程序头文件中的第一个头文件包含在内（并告诉编译器将此“standard.h”视为“预编译头文件”）。

* * *

```
//contents of foo.h
#ifndef INC_FOO_H //or #pragma once
#define INC_FOO_H

#include "standard.h"
class Foo
{
public: //methods
  ... Foo-specific methods here ...
private: //data
  struct Impl;
  Impl* m_impl;
};
#endif//INC_FOO_H 
```

* * *

```
//contents of foo.cpp
#include "foo.h"
#include "bar.h"
Foo::Foo()
{
  m_impl = new Impl();
}
struct Foo::Impl
{
  Bar m_bar;
  ... etc ...
};
... etc ... 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-06-18T21:34:38.490

我习惯将我的包含从高抽象级别排序到低抽象级别。这要求标头必须是自给自足的，并且隐藏的依赖关系会迅速显示为编译器错误。

例如，“俄罗斯方块”类有一个俄罗斯方块.h 和俄罗斯方块.cpp 文件。Tetris.cpp 的包含顺序为

```
#include "Tetris.h"     // corresponding header first
#include "Block.h"      // ..then application level includes
#include "Utils/Grid.h" // ..then library dependencies
#include <vector>       // ..then stl
#include <windows.h>    // ..then system includes 
```

现在我意识到这并不能真正回答你的问题，因为这个系统并不能真正帮助清理不需要的包含。呃，好吧..

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-06-18T23:43:00.057

根据项目的大小，查看由[doxygen](http://www.doxygen.nl/)创建的包含图（使用`INCLUDE_GRAPH`on 选项）可能会有所帮助。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-06-18T19:40:01.327

[在这个问题](https://stackoverflow.com/questions/614794/c-c-detecting-superfluous-includes)中已经讨论了检测多余的包含。

我不知道有任何工具可以帮助检测不足但发生在工作中的包括，但良好的编码约定可以在这里提供帮助。例如，[Google C++ 风格指南](http://google-styleguide.googlecode.com/svn/trunk/cppguide.xml#Names_and_Order_of_Includes)要求以下内容，目的是减少隐藏的依赖：

在`dir/foo.cc`中，其主要目的是实现或测试中的东西`dir2/foo2.h`，按如下顺序排列您的包含：

1.  `dir2/foo2.h`（首选位置 - 请参阅下面的详细信息）。
2.  C 系统文件。
3.  C++ 系统文件。
4.  其他库的 .h 文件。
5.  您项目的 .h 文件。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-06-19T17:17:01.377

删除标头并重新编译技术的一个大问题是它可能导致仍在编译但错误或效率低下的代码。

1.  模板特化：如果您在一个标头中有特定类型的模板特化，而在另一个标头中有更通用的模板，则删除特化可能会使代码处于可编译状态，但会产生不希望的结果。

2.  重载解决：一个类似的问题 - 如果您在不同的标头中有一个函数的两个重载，但采用某种兼容的类型，您最终可以删除更适合一种情况的版本，但仍然可以编译代码。这可能比模板专业化版本更不可能，但它是可能的。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-06-19T02:34:42.253

> 我一直在考虑编写一些东西，多次单独编译每个非头文件，每次删除#include 语句。继续这样做，直到获得最少的包含集。

我认为这是被误导的，并且会导致“不足但恰好起作用”的包含集。

假设您的源文件使用`numeric_limits`，但还包含一些头文件，由于其自​​身的原因包含`<limits>`. 这并不意味着您的源文件不应该包含`<limits>`. 可能没有记录其他头文件来定义 中定义的所有内容`<limits>`，只是碰巧这样做了。有一天它可能会停止：也许它只使用一个值作为某个函数的默认参数，并且可能该默认值从`std::numeric_limits<T>::min()`变为 0。现在您的源文件不再编译，并且该头文件的维护者没有甚至不知道您的文件存在，直到它破坏了他的构建。

除非您此刻遇到严重的构建问题，否则我认为删除冗余包含的最佳方法就是养成每当您触摸文件进行维护时查看列表的习惯。如果您发现您有几十个包含，并且在查看了文件后您仍然无法弄清楚每个包含的内容，请考虑将其分解为较小的文件。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-02-16T14:55:42.020

如果您使用 Visual Studio 编译器，您可以尝试 /showIncludes 编译器选项，然后解析它向 stderr 发出的内容。MSDN：“导致编译器输出包含文件的列表。还显示嵌套的包含文件（包含在您包含的文件中的文件）。”

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-18T19:13:17.933

是的。我们有自己的预处理器，可以让我们访问自己的宏语言。它还检查头文件是否只包含一次。创建一个简单的预处理器检查多个包含应该相当容易。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-06-18T20:46:04.393

就工具而言，我在 Windows 上使用了 Imagix（大约 6 年前）来识别不需要的包含以及需要但通过另一个包含间接包含的包含。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-04-09T12:47:09.140

看看[cppclean](http://code.google.com/p/cppclean/)项目。虽然他们还没有实现该功能，但计划完成。

从项目现场：

> CppClean 试图在 C++ 源代码中发现会减慢开发速度的问题，尤其是在大型代码库中。它类似于 lint；但是，CppClean 侧重于查找全局模块间问题，而不是类似于其他静态分析工具的局部问题。
> 
> 我们的目标是在大型代码库中找到减缓开发的问题，这些代码库随着时间的推移而修改，留下未使用的代码。此代码可以以多种形式出现，从未使用的函数、方法、数据成员、类型等到不必要的#include 指令。不必要的#includes 会导致大量额外的编译，增加编辑-编译-运行周期。

特别是在#include 功能上：

> *   （计划中）查找不必要的头文件#included
>     *   没有直接引用标题中的任何内容
>     *   如果类是向前声明的，则不需要标题
> *   （计划中）不直接#included 引用头文件的源文件，即依赖来自另一个头文件的传递#include 的文件

[在这里](https://bitbucket.org/robertmassaioli/cppclean)，您可以在 BitBucket 找到一面镜子。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-10-10T03:00:02.313

如果您在 Eclipse 中使用 CDT 进行编码，则可以使用 Organize Includes 命令。只需按 Ctrl+Shift+O，它将添加必要的包含并删除不需要的包含。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2009-06-18T19:20:22.333

我通常会创建一个源文件（例如 main.c）和一个用于该源文件的头文件（main.h）。在源文件中，我将我在该文件中使用的所有主要类型的“接口”函数（在 main 中，它`main()`是 在头文件中，我声明了一些`extern`在其他源文件中定义的函数，但在使用该头文件的源文件中使用。然后我声明我在该源文件中使用的任何结构或其他数据类型。

然后我只是编译并将它们链接在一起。它保持干净整洁。一个典型的 include ... 部分，在我当前的项目中看起来像这样

```
#include<windows.h>
#include<windowsx.h>
#include<stdio.h>

#include"interface.h"
#include"thissourcefile.h"

//function prototypes

//source 
```

有一个`interface`标题可以跟踪我在项目中所有表单中使用的数据结构，然后`thissourcefile.h`它完全按照我刚刚解释的方式进行（声明`externs`等）。

此外，我从不在标题中定义任何内容，我只在其中放置声明。这样，它们可以被不同的源文件包含，并且仍然可以成功链接。函数原型（extern、static 或其他）和声明放在头文件中，这样它们可以被多次使用——定义放在源代码中，因为它们只需要在一个地方。

如果您正在创建一个库或类似的东西，这显然会有所不同。但仅对于内部项目链接，我发现这可以保持一切都干净整洁。另外，如果您编写一个 makefile（或者您只使用 IDE），那么编译非常简单且高效。

# web-services - 通过 Spring WebServiceTemplate 使用第三方 Web 服务

> ID：1014633
> 
> 赞同：0
> 
> 时间：2009-06-18T19:10:23.867
> 
> 标签：web-services, spring, wsdl, spring-ws, webservicetemplate

我正在尝试通过提供的 wsdl 文件来使用第三方 Web 服务。我将从 WEB-INF 文件夹下的基于 Spring-J2EE 的项目本地加载文件。

wsdl 可能暴露了多个操作。所以我需要一种方法来选择要调用的方法。我还需要使用 JaxbMarshaller。

任何人都可以帮助提供相同的代码片段吗？

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-20T08:36:59.570

WebServiceTemplate 和 Spring-WS 一般不将 WSDL 作为起点。相反，它是面向模式的。

当您使用 WebServiceTemplate 时，插入 JaxmMarshaller，然后调用 marshalSendAndReceiver 方法，传入包含您要调用的 SOAP 操作的 SoapActionCallback。您可以从 WSDL 获取 SOAP 操作 URI。WebServiceTemplate 将编组您的请求，使用您指定的 SOAP 操作将其包装在 WSDL 信封中，然后将其关闭。

如果您想要一个从您的 WSDL 生成存根的框架，那么 Spring-WS 不适合您。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-17T07:09:26.587

这是调用 Web 服务的简单方法。详情请[点击这里](https://stackoverflow.com/questions/26796149/how-to-consume-third-party-wsdl-services-in-spring-mvc)

```
public void createSoapActionCallBack(ValidateCardRequest validateCardRequest) {

        //This is used to send header message
        SoapActionCallback actionCallBack=new SoapActionCallback(soapAction);
        try{

            actionCallBack = new SoapActionCallback(SOAPACTION_DEFAULT_URL) {
            public void doWithMessage(WebServiceMessage msg) {
                    SoapMessage smsg = (SoapMessage)msg;                
                    SoapHeader soapHeader = smsg.getSoapHeader();

                    try{
                        //To send header message
                        StringSource headerSource = new StringSource("<UserCredentials xmlns='URL'>\n" +
                                        "<userid>"+"ABCD"+"</userid>\n" +
                                        "<password>"+"ABCD"+"</password>\n" +
                                        "</UserCredentials>");
                        Transformer transformer = TransformerFactory.newInstance().newTransformer();
                        transformer.transform(headerSource, soapHeader.getResult());

                        smsg.setSoapAction(soapAction);
                    }catch(Exception e)
                    {
                        e.printStackTrace();
                    }
                }
                }; 
               validateCardResponse = (FVValidateCardResponse) webServiceTemplate.marshalSendAndReceive(URL, validateCardRequest, actionCallBack);  

            } catch (Exception e) {
                e.printStackTrace();
            }       
} 
```

# windows - 如何使用 MS C++ Express 2008 在 Windows 上构建 Perl Unicode::Map？

> ID：1014637
> 
> 赞同：0
> 
> 时间：2009-06-18T19:11:55.690
> 
> 标签：windows, perl, build, module

我目前正在尝试制作 Unicode-Map-0.112 模块，但遇到错误，`'0x1'`这显然与使用`nmake`. 我试图遵循关于 Perl Monks 的建议，即 [http://www.perlmonks.org/?node_id=434813](http://www.perlmonks.org/?node_id=434813)

但是，我无法使用 ppm 的功能，因为我在没有网络连接的 Windows 机器上，而唯一的另一台机器是 Mac。事实证明，机器上安装了 MS C++ Express 2008，所以我可以使用它来克服错误吗？

更多错误详情：

```
cl -c - nologo - GF -W3 -MD...

'cl' is not recognized as an internal...command
operable programe or batch file
NMAKE: fatal error U10777 'cl' : return code '0x1'
Stop 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-18T19:15:24.450

错误是说 cl.exe 不在您的路径中。我不记得 Express SKU 是否有“Visual Studio 命令提示符”（检查您的开始菜单）。

如果不只是找到 cl.exe（假设它是 c:\path\to\vstools\cl.exe）并执行以下操作：

设置 PATH=%PATH%;c:\path\to\vstools

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T00:08:37.463

你不能在Mac上下载所需的文件，把它们放在U盘上，然后`ppm`用来安装吗？

在 Mac 上下载：

```
$ wget http://trouchelle.com/ppm10/Unicode-Map.ppd
$ wget http://trouchelle.com/ppm10/MSWin32-x86-multi-thread-5.10/Unicode-Map-0.112.zip
$ mkdir MSWin32-x86-multi-thread-5.10
$ mv Unicode-Map-0.112.zip MSWin32-x86-multi-thread-5.10 
```

然后移动到 Windows 机器。打开命令提示符，切换到 U 盘上包含 ppd 文件的目录：

```
F:\> ppm install -area site Unicode-Map.ppd
Unpacking Unicode-Map-0.112...done
Generating HTML for Unicode-Map-0.112...done
Updating files in site area...done
110 files installed 
```

# c# - 是否有通过主键获取 Linq2SQL 实体的通用方法？

> ID：1014639
> 
> 赞同：2
> 
> 时间：2009-06-18T19:12:06.763
> 
> 标签：c#, .net, asp.net, linq-to-sql

好的，简短的版本是我有一个来自 LinqDataSourceUpdateEventArgs 的 Linq 实体，我需要手动处理更新，因为 MS 很愚蠢。

我可以从数据上下文中获取 Table 对象，这让我可以这样做：

```
var newObj = e.NewObject;

var table = FormContext.GetTable(e.NewObject.GetType());

table.Attach(newObj, e.OriginalObject);

if (BuildingObject != null)
    BuildingObject(sender, new HeirarchicalBuildObjectEventArgs(newObj));

FormContext.SubmitChanges(); 
```

不幸的是，我收到异常“无法使用已在使用的密钥添加实体”。

当然，有趣的是我在 FormContext.SubmitChanges() 上得到了它，而不是在 table.Attach() 上......这对我来说毫无意义，但无论如何。

我在想我需要从上下文中实际获取对象，并使用它而不是 e.OriginalObject 来附加...或者，作为最后的手段，我需要获取原始对象并编写一个循环来复制每个属性都放入我从数据上下文中获得的属性中。

无论哪种方式，我都需要在不知道对象类型的情况下通过它的主键来查找对象。有没有办法做到这一点？

编辑：好的，看看.NET Reflector，我注意到，除其他外，LinqDataSourceView 附加了旧数据对象，然后将所有值复制到其中......但这显然跳过了关联。我想尝试附加旧对象并复制值...

真正有趣的部分？很久以前，我编写了一个将属性从一个实体实例复制到另一个实体实例的函数，它包含以下注释：

//我们不能复制关联，而且可能不应该

有时我希望我的评论更彻底...

编辑编辑：好的，所以再次正确答案是：我问错了问题！

正确的代码是：

```
 var newObj = e.NewObject;

        var table = FormContext.GetTable(e.NewObject.GetType());

        if (BuildingObject != null)
            BuildingObject(sender, new HeirarchicalBuildObjectEventArgs(newObj));

        table.Attach(newObj, e.OriginalObject);

        FormContext.SubmitChanges();

        e.Cancel = true; 
```

我最初试图在 BuildingObject 之后附加，但遇到了一些其他错误并移动了附加语句以纠正它。（我想是因为我调用了错误版本的 Attach。或者我的论点颠倒了......）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-18T21:16:26.000

我经常使用 Sutekishop 的通用存储库实现，这是使用 asp.net mvc 和 L2S 构建的开源电子商务网上商店。
它对泛型类型 T 有很好的 GetByID，它依赖于模型类的 L2S 属性。这是完成这项工作的部分：

```
public virtual T GetById(int id)
{
    var itemParameter = Expression.Parameter(typeof(T), "item");

    var whereExpression = Expression.Lambda<Func<T, bool>>
        (
        Expression.Equal(
            Expression.Property(
                itemParameter,
                typeof(T).GetPrimaryKey().Name
                ),
            Expression.Constant(id)
            ),
        new[] { itemParameter }
        );
     return GetAll().Where(whereExpression).Single();
} 
```

以及查找主键属性的扩展方法；如您所见，它在类属性上需要带有“IsPrimaryKey”的“Column”属性。扩展方法：

```
public static PropertyInfo GetPrimaryKey(this Type entityType) {
    foreach (PropertyInfo property in entityType.GetProperties()) {
        if (property.IsPrimaryKey()) {
            if (property.PropertyType != typeof (int)) {
                throw new ApplicationException(string.Format("Primary key, '{0}', of type '{1}' is not int", property.Name, entityType));
            }
            return property;
        }
    }
    throw new ApplicationException(string.Format("No primary key defined for type {0}", entityType.Name));
} 

public static TAttribute GetAttributeOf<TAttribute>(this PropertyInfo propertyInfo) {
    object[] attributes = propertyInfo.GetCustomAttributes(typeof(TAttribute), true);
    if (attributes.Length == 0)
        return default(TAttribute);
    return (TAttribute)attributes[0];
}

public static bool IsPrimaryKey(this PropertyInfo propertyInfo) {
    var columnAttribute = propertyInfo.GetAttributeOf<ColumnAttribute>();
    if (columnAttribute == null) return false;
    return columnAttribute.IsPrimaryKey;
} 
```

此代码的所有功劳[归于 Mike Hadlow](http://mikehadlow.blogspot.com/)！整个实现可以在[sutekishop 源码中找到](http://code.google.com/p/sutekishop/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-18T21:15:43.897

尝试以下方法通过 ID 获取实体：

（ LinqToSql 生成的类的类型*在哪里`TLinqEntity`......并且是类本身的通用参数。*）

```
 protected TLinqEntity GetByID(object id, DataContext dataContextInstance)
    {
        return dataContextInstance.GetTable<TLinqEntity>()
            .SingleOrDefault(GetIDWhereExpression(id));
    }

    static Expression<Func<TLinqEntity, bool>> GetIDWhereExpression(object id)
    {
        var itemParameter = Expression.Parameter(typeof(TLinqEntity), "item");
        return Expression.Lambda<Func<TLinqEntity, bool>>
            (
            Expression.Equal(
                Expression.Property(
                    itemParameter,
                    TypeExtensions.GetPrimaryKey(typeof(TLinqEntity)).Name
                    ),
                Expression.Constant(id)
                ),
            new[] { itemParameter }
            );
    }

    static PropertyInfo GetPrimaryKey(Type entityType)
    {
        foreach (PropertyInfo property in entityType.GetProperties())
        {
            var attributes = (ColumnAttribute[])property.GetCustomAttributes(typeof(ColumnAttribute), true);
            if (attributes.Length == 1)
            {
                ColumnAttribute columnAttribute = attributes[0];
                if (columnAttribute.IsPrimaryKey)
                {
                    if (property.PropertyType != typeof(int))
                    {
                        throw new ApplicationException(string.Format("Primary key, '{0}', of type '{1}' is not int",
                            property.Name, entityType));
                    }
                    return property;
                }
            }
        }
        throw new ApplicationException(string.Format("No primary key defined for type {0}", entityType.Name));
    } 
```

* * *

这是更新方法（感谢[Marc Gravell](https://stackoverflow.com/questions/880090/c-linq-sql-an-updatebyid-method-for-the-repository-pattern)）：

```
 public virtual void Update(DataContext dataContext, TLinqEntity obj)
    {
        // get the row from the database using the meta-model
        MetaType meta = dataContext.Mapping.GetTable(typeof(TLinqEntity)).RowType;
        if (meta.IdentityMembers.Count != 1)
            throw new InvalidOperationException("Composite identity not supported");
        string idName = meta.IdentityMembers[0].Member.Name;
        var id = obj.GetType().GetProperty(idName).GetValue(obj, null);

        var param = Expression.Parameter(typeof(TLinqEntity), "row");
        var lambda = Expression.Lambda<Func<TLinqEntity, bool>>(
            Expression.Equal(
                Expression.PropertyOrField(param, idName),
                Expression.Constant(id, typeof(int))), param);

        object dbRow = dataContext.GetTable<TLinqEntity>().Single(lambda);

        foreach (MetaDataMember member in meta.DataMembers)
        {
            // don't copy ID or timstamp/rowversion
            if (member.IsPrimaryKey || member.IsVersion) continue;
            // (perhaps exclude associations too)

            member.MemberAccessor.SetBoxedValue(
                ref dbRow, member.MemberAccessor.GetBoxedValue(obj));
        }
        dataContext.SubmitChanges();
    } 
```

# wcf - .NET 3.0 和 .NET 3.5 之间的 WCF 差异

> ID：1014649
> 
> 赞同：1
> 
> 时间：2009-06-18T19:14:33.233
> 
> 标签：wcf

使用 .NET 3.0 与 .NET 3.5 的 WCF 有什么区别？我需要了解 .NET 版本之间的改进。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-18T19:20:55.453

在 3.5 你得到

*   WCF 和 WF 集成 - 工作流服务
*   持久服务
*   WCF Web 编程模型
*   WCF 联合
*   WCF 和部分信任
*   WCF 和 ASP.NET AJAX 集成
*   Web 服务互操作性

有关详细信息，请参阅[http://msdn.microsoft.com/en-us/library/bb332048.aspx](http://msdn.microsoft.com/en-us/library/bb332048.aspx)

如果你应用 .NET 3.5 SP1，你会得到

*   在 Web 托管的应用程序场景中显着的可扩展性改进 (5-10 倍)
*   支持在 WCF 合同中使用 ADO.NET Entity Framework 实体
*   使用 DataContract 序列化程序以及 UriTemplate 和 WCF Web 编程模型改进 API 可用性
*   VS 2008 SP1 中增强的 TestClient 支持
*   VS 2008 SP1 中用于 WCF 服务项目的新托管向导
*   改进了部分信任场景中的调试支持

# gwt - GWT 和 JSR-168/286 portlet 命名空间？

> ID：1014665
> 
> 赞同：2
> 
> 时间：2009-06-18T19:18:24.473
> 
> 标签：gwt, portlet

我们正在为 Liferay 开发一组 portlet。目前我们使用 JSP，因此我们可以使用标签作为 DIV 和元素 ID，以便它们在页面上是唯一的，即使页面上出现同一个 portlet 的多个实例；例如：

```
<div id='<portlet:namespace/>div'>  
<form>
    Enter your name here: <input type='text' id='<portlet:namespace/>name'/>  
</form>  
</div> 
```

现在我们想尝试使用 GWT 而不是 JSP 构建 portlet。我发现的任何 GWT portlet 示例（其中只有几个）都不能解决“如何为 div 和元素分配唯一 ID”问题，因为 GWT 似乎在 ID 之前已预编译为 Javascript曾经产生过。关于如何将 portlet 的名称空间合并到 div/元素 ID 中的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-09-04T03:45:51.197

GWT 包含您可以使用的 Element 类的 setId() 方法。

如果您使用小部件，您可以调用 widget.getElement().setId(...)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-09-25T19:11:18.387

这是我找到的最佳链接：http: [//xantorohara.blogspot.com/2007/07/portlets-and-gwt.html](http://xantorohara.blogspot.com/2007/07/portlets-and-gwt.html)

我通过在根容器级别为每个基于 GWT 的 portlet 使用唯一 id 解决了这个问题。除此之外，我实现了 Command 模式并拥有一个基于 GWT 历史支持的 Command 分派器，该分派器将适当的操作分派到 portlet 而不会干扰其他 portlet。

由于 liferay 支持 jsr 286，您可以安排一个 GWT ajax 调用，该调用将返回 portlet id 并使用该 id 来区分不同的 portlet。

# internet-explorer - 强制 IE8 进入 IE7 兼容模式

> ID：1014666
> 
> 赞同：59
> 
> 时间：2009-06-18T19:18:42.273
> 
> 标签：internet-explorer, internet-explorer-8, internet-explorer-7, cross-browser

有没有办法使用 .NET 或 Javascript 强制 IE8 进入 IE7 兼容模式？

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2009-06-18T19:23:00.753

如果您将此添加到您的元标记中：

```
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" /> 
```

IE8 会像 IE7 一样呈现页面。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2010-08-23T12:44:16.080

您可以在 web.config 中执行此操作

```
 <httpProtocol>
        <customHeaders>
            <add name="X-UA-Compatible" value="IE=7"/>
        </customHeaders>
    </httpProtocol> 
```

与上述解决方案相比，我有更好的结果。不知道为什么这没有作为解决方案给出。:)

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-06-18T19:23:04.200

我现在可能已经找到了。 [http://blog.lroot.com/articles/the-ie7-compatibility-tag-force-ie8-to-use-the-ie7-rendering-mode/](http://blog.lroot.com/articles/the-ie7-compatibility-tag-force-ie8-to-use-the-ie7-rendering-mode/)

该网站说添加此元标记：

```
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7"> 
```

或将其添加到 .htaccess

```
Header set X-UA-Compatible: IE=EmulateIE7 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-06-18T19:24:04.247

您可以设置[一个 HTTP 标头](http://blogs.msdn.com/ie/archive/2008/06/10/introducing-ie-emulateie7.aspx)，该标头将强制 IE8 使用 IE7 兼容模式。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-06-18T19:23:15.587

它甚至比这更简单。使用 HTML，您只需将此元标记添加到您的页面（页面上的第一件事）：

```
<meta http-equiv="X-UA-Compatible" content="IE=7" /> 
```

如果你想使用.net 来做，你只需要发送带有元信息的 HTTP 请求。这需要页面刷新才能工作。

此外，您可以在此处查看类似的问题： [IE8 中使用 VBScript 的兼容模式](https://stackoverflow.com/questions/934178/compatibility-mode-in-ie8-using-vbscript)

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2010-02-02T08:14:53.257

如果您想在 IE 8 标准模式下切换 IE 8 页面渲染，则再选择一个

```
<meta http-equiv="X-UA-Compatible" content="IE=100" /> <!-- IE8 mode --> 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-07-07T13:18:22.837

对此的说明：

IE 8.0s 仿真只承诺以相同的方式显示页面。存在可能导致功能中断的细微差异。我最近遇到了一个问题。在 IE 7.0 使用 IE 8.0 中称为“anonymous()”的 javascript 包装器函数的地方，包装器的名称不同。

所以不要期望像 JavaScript 这样的东西“正常工作”，因为你打开了仿真。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-10-25T06:13:54.997

这可以在 IIS 中完成： [http ://weblogs.asp.net/joelvarty/archive/2009/03/23/force-ie7-compatibility-mode-in-ie8-with-iis-settings.aspx](http://weblogs.asp.net/joelvarty/archive/2009/03/23/force-ie7-compatibility-mode-in-ie8-with-iis-settings.aspx)

阅读评论：2009 年 4 月 1 日，星期三，上​​午 8:57，作者：John Moore

快速跟进。只要我使用 IE=EmulateIE7 值，这对我的网站非常有用。尝试使用 IE=7 导致我的网站在 IE8 上运行时基本上挂起。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-01-15T08:44:27.520

我的代码有这个标签

meta http-equiv="X-UA-Compatible" 内容="IE=7" />

有没有一种方法可以让我跳过这个标签，但使用该标签可以很好地显示布局，显示器将在 IE 7 上运行，但我想在更多版本中运行它......

# java - Java for 循环的括号中可以包含什么？

> ID：1014667
> 
> 赞同：6
> 
> 时间：2009-06-18T19:18:50.557
> 
> 标签：java, syntax, for-loop

我的问题是关于 Java`for`声明，例如

```
for (int i = 0; i < 10; ++i) {/* stuff */} 
```

我不明白的是我可以在括号中放入多少代码/什么样的代码（即`int i = 0; i < 10; ++i`我的示例中的代码） - 我不太了解这里用来描述它的语言：

[http://java.sun.com/docs/books/jls/third_edition/html/statements.html#24588](http://java.sun.com/docs/books/jls/third_edition/html/statements.html#24588)

基本上我的问题归结为要求翻译规范中的位，如下所示：

ForInit：StatementExpressionList LocalVariableDeclaration

编辑：哇。我想真正的答案是“学习阅读和理解 JLS 中使用的符号——它的使用是有原因的”。谢谢你的所有答案。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-06-18T19:37:40.503

两者`StatementExpressionList`和`LocalVariableDeclaration`在页面的其他地方定义。我会在这里复制它们：

```
StatementExpressionList:
        StatementExpression
        StatementExpressionList , StatementExpression

StatementExpression:
        Assignment
        PreIncrementExpression
        PreDecrementExpression
        PostIncrementExpression
        PostDecrementExpression
        MethodInvocation
        ClassInstanceCreationExpression 
```

和

```
LocalVariableDeclaration:
        VariableModifiers Type VariableDeclarators

VariableDeclarators:
        VariableDeclarator
        VariableDeclarators , VariableDeclarator

VariableDeclarator:
        VariableDeclaratorId
        VariableDeclaratorId = VariableInitializer

VariableDeclaratorId:
        Identifier
        VariableDeclaratorId [ ]

VariableInitializer:
        Expression
        ArrayInitializer 
```

进一步遵循语法没有多大意义。我希望它很容易阅读。

这意味着您可以在该部分中*包含任意*数量的`StatementExpressions`，用逗号分隔的，*或*a 。并且 a可以由任意数量的 " " 对组成，以逗号分隔，前面是它们的类型。`LocalVariableDeclaration``ForInit``LocalVariableDeclaration``variable = value`

所以这是合法的：

```
for (int i = 0, j = 0, k = 0;;) { } 
```

因为 " `int i = 0, j = 0, k = 0`" 是有效的`LocalVariableDeclaration`。这是合法的：

```
int i = 0;
String str = "Hello";
for (str = "hi", i++, ++i, sayHello(), new MyClass();;) { } 
```

因为初始化程序中的所有这些随机事物都符合`StatementExpressions`.

由于`StatementExpressionList`在 for 循环的更新部分是允许的，这也是有效的：

```
int i = 0;
String str = "Hello";
for (;;str = "hi", i++, ++i, sayHello(), new MyClass()) { } 
```

你开始看图了吗？

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-18T19:38:31.423

提醒一句：我们希望在括号中看到非常简单、非常熟悉的内容。超越

```
for (int i = 0; i < n; i++) 
```

可能会使您的代码的未来读者感到困惑。有时您需要以相反的顺序进行迭代——甚至开始和结束条件都会给许多程序员带来麻烦（是 n、n-1、n+1 吗？是 >0、>=0、...？）

在*某些*情况下，需要详细说明。我只是说 - 在你去那里之前要小心，考虑更简单的表示。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-18T19:24:23.917

基本上，对于一个简单的 FOR 循环：

```
for (startCondition; endCondition; increment) 
```

在 startCondition 中，您设置用于运行循环的变量的起始值；在很多情况下，你会像*我一样看到它*

```
int i = 0 
```

在 endCondition 中，您指定循环继续进行的比较。所以，如果你想在 i = 15 时停止循环，你可以放

```
i <= 15 
```

或者

```
i != 15 
```

您还可以执行与布尔值比较之类的操作，例如

```
i == true 
```

在增量中，您指定每次循环后计数器变量应增加多少。如果你想简单地增加 1，你会放

```
i++ 
```

在 startCondition 和 endCondition 中使用更多表达式以及多个计数器会变得更加复杂，但这是一个简单的 FOR 循环。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-18T19:26:14.520

**语句表达式列表**

意味着你可以这样做：

```
int x = 0; 
int y = 0;
int z = 0;

for ( x++, y++; x+ y < z; z++) {
// whatever
} 
```

其中 x++, y++ 是表达式列表的列表。基本上你想在循环开始时执行的语句。

**LocalVariableDeclaration**看起来像

```
int j = 0, i = 0, k = 0; 
```

所以

```
for ( int j = 0, i = 0, k = 0; i+j+k < 10; i++, j++, k++ ){
// whatever
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-18T19:40:10.343

for 循环中的第二条语句（条件语句）可以是任何计算结果为布尔值或布尔值的语句。通常，这类似于`i < max`，但也可能是`hasMore()`,`(x > y) == bool`或类似于`myclient.getMapOfIntsToBools().get(i)`。只要表达式的结果是一个布尔值，它有多长并不重要。

其他两个部分基本上可以是任何单个语句：无论它的最终返回类型是什么，它都会被忽略（就像它在一个空行上一样）。第一条语句总是在第一个循环开始时精确执行一次，而另一个语句在每个循环结束时执行。

另一种思考方式是：

```
if (A; B; C){
  ...
} 
```

变成这样：

```
A
while (B){
  ...
  C
} 
```

A 和 C 可以是您希望它们成为的任何单个语句（不包括任何内容）。B*必须*是评估为布尔值的东西。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-18T19:26:42.260

你可以把

`for(stmt a,stmt b, stmt,c.... ; stmt 1; alpha, beta, omega,...){`}

其中 stmt ：声明；

a、b、c等都可以

局部变量或其他语句的定义

```
for(int a=0,b=0;;){} 
```

将 a 和 b 声明并初始化为 0；

```
for(a=i,b=a+1;;){} 
```

将 a 和 b 分配给这些值

使用迭代器，您可以

```
 for(Iterator it= my_list.iterator();;){} 
```

1、2、3 等必须返回布尔值，

所以你不能放类似的东西

```
 for (;a++;) 
```

但是你可以

```
for (;a<b;) 
```

或者

```
for(;it.hasNext();) 
```

这基本上是一个while循环。

或者什么都没有:)

```
 for(int a=0;;a++) 
```

至于 alpha, omega.. 部分，应该使用赋值运算符

```
for(;;a){} 
```

不会编译，但是

```
for(;;a++){}
for(;;a=b;a++){} 
```

将要。

然后你有**foreach 结构**，它更简单

```
for (A a:getAList()) 
```

并遍历整个列表， a 具有当前元素。不需要控制变量。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-18T19:51:57.230

> BasicForStatement: for ( ForInitopt ; Expressionopt ; ForUpdateopt ) 语句

for 语句由 ForInit、Expression 和 ForUpdate 组成，它们都是可选的

> ForInit: StatementExpressionList LocalVariableDeclaration forInit 是用逗号分隔的语句和表达式列表（见下文）或局部变量的声明
> 
> ForUpdate：StatementExpressionList

forUpdate 是用逗号分隔的语句和表达式的列表...基本上，您可以输入：Assignment
PreIncrementExpression PreDecrementExpression PostIncrementExpression PostDecrementExpression MethodInvocation ClassInstanceCreationExpression

> StatementExpressionList: StatementExpression StatementExpressionList , StatementExpression

什么是声明：

> > 程序的执行顺序是由语句控制的，这些语句是为了执行它们的效果而执行的，并且没有值。
> 
> 一些语句包含其他语句作为其结构的一部分；此类其他陈述是该陈述的子陈述。如果不存在不同于 S 和 U 的语句 T 使得 S 包含 T 并且 T 包含 U，则我们说语句 S 立即包含语句 U。以同样的方式，某些语句包含表达式作为其结构的一部分。

一个表达式是

> 程序中的大部分工作都是通过评估表达式来完成的，要么是为了它们的副作用，例如对变量的赋值，要么是它们的值，它们可以用作更大表达式中的参数或操作数，或者影响语句中的执行顺序， 或两者。

所以基本上你可以在中间有任何有效的java表达式（你不需要比较）但是这个表达式仍然必须返回一个布尔值......

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-19T01:25:50.113

您可能会发现 for each 表示法通常更简单、更清晰。我建议在适当的时候使用 for each 循环。例如

```
for(Element element: arrayOfElement) { /* stuff */ }
// or
for(Element element: iterableOfElement) { /* stuff */ } 
```

Collection、Set 和 List 是可迭代的，但您可以自己制作。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-18T19:27:33.287

```
for(startCondition(s); endCondition(s); Action) {} 
```

只要 startCondition(s) 和 endCondition(s) 被评估为布尔值（真或假，1 或 0 取决于语言），您就可以根据需要拥有“长”的条件列表。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-06-18T19:29:47.213

你可以有多个语句；然后是在每个循环中评估的单个条件，最后是另一组语句

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-06-18T19:39:27.083

用循环翻译规范

```
for (initFor; endCondition; update) 
```

`startCondition`是其值被丢弃的语句列表（包括无语句）。他们指定`LocalVariableDeclaration`要注意，如果局部变量声明在语句中（例如 int x = 0），则局部变量“作用域”到 for 语句的块（即该值在块之外或声明）。

`endCondition`是一个布尔表达式。同样它是可选的（如果不存在，则循环永远继续）

`update`是一个语句列表，通常处理每个循环后所需的更新。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-06-18T19:44:02.037

您收到的很多回复并没有真正回答您的问题。正确的答案是你可以放任何你想要的东西。`break`如果你的 for 循环中有一个语句，你甚至不需要一个有效的结束条件。在使用迭代器循环的情况下，您也不需要三个语句。

编辑：好的，不太正确。您不能在第一个分号之后初始化新变量。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-06-18T19:44:04.797

for 循环的所有三个子句都是可选的，但分号必须在那里。

在 for 循环的第一个子句中，可以放置任意数量的以逗号分隔的语句。或者，在替代方案中（但不能混合使用），您可以声明可用于 for 循环的单一类型的新变量（例如 int i = 1, j= 2）。此处声明的任何变量都可用于 for 循环之后的语句（或使用花括号的语句）。

for 循环的第二个子句是一个返回布尔值的语句。这将被评估以考虑 for 循环是否应该继续。

for 循环的第三个子句可以包含任意数量的以逗号分隔的语句，但不能声明任何变量。

# html - 如何将文本居中放置在图像上？

> ID：1014672
> 
> 赞同：1
> 
> 时间：2009-06-18T19:19:18.343
> 
> 标签：html, css

我正在尝试在按钮图像上放置一些文本。我设法在按钮上将其从左到右对齐，但垂直对齐对其余部分不起作用。CSS中有没有一种方法可以使文本垂直居中。

![替代文字](../Images/e3aac39c7a8a389dad681872900ea53a.png)

```
.selectedTabOnPlacementMenu
{
    background: url('/Content/Images/Blank_Yellow.png') no-repeat;
    width:88px;
    height:28px;
    text-align:center;
    font-weight:bold;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-18T19:27:29.260

如果是单行文字，可以设置行高。

```
<div style="height:50px;background-color:#ccc;">
    <p style="line-height:50px;">test</p>
</div> 
```

垂直居中多行文本要困难得多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T04:15:34.657

把代码放上去

```
line-height:28px; 
```

在你的课上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T19:21:07.027

您可以使用 margin-top: 5px; 或填充顶部：5px；（取决于您的 div 的设置方式）在您有文本的 div 中将其向下推。

干杯

# .net - CCNet 触发构建，但即使我将错误代码签入到 svn 也会成功

> ID：1014678
> 
> 赞同：0
> 
> 时间：2009-06-18T19:20:34.207
> 
> 标签：.net, svn, nant, ccnet-config

我已经使用 SVN 作为我的源代码控制并使用 NAnt 构建脚本为 .NET 设置了 CruiseControl。当我手动构建 Visual Studio 解决方案时，我得到了错误，这是正确的，因为我有一些错误的代码。在我将代码签入 svn 后，CCNet 触发了构建，但结果显示为 SUCCESS。请参阅下面的配置和构建文件：

**NAnt 构建文件：**

```
<project name="MyServiceClient" default="build">
  <target name="init" depends="clean" />
  <target name="clean" />
  <target name="checkout"/>
  <target name="compile"/>
  <!--<target name="deploy"/>
  <target name="test"/>
  <target name="inspect"/>-->
  <target name="build" depends="init, checkout">
    <call target="compile" />
<!--    <call target="inspect" />
    <call target="test" />
    <call target="deploy" />-->
  </target>
</project> 
```

## **ccnet.config**

```
<cruisecontrol>

  <project name="MyServiceClient">
<sourcecontrol type="svn">
  <trunkUrl>https://dev-wks28.dev.va.root:8443/svn/test/trunk/MyServiceClient</trunkUrl>
  <executable>C:/Program Files/VisualSVN Server/bin/svn.exe</executable>
  <workingDirectory>C:\test\MyServiceClient</workingDirectory>
  <username>kpedda</username>
  <password>Password1</password>
  <autoGetSource>true</autoGetSource>
</sourcecontrol>
<workingDirectory>C:\test\MyServiceClient</workingDirectory>
<triggers>
  <intervalTrigger seconds="90" buildCondition="IfModificationExists" />
  <scheduleTrigger time="10:00" buildCondition="ForceBuild" />
</triggers>
<tasks>
  <nant>
    <executable>C:/Program Files/NAnt/bin/nant.exe</executable>
    <baseDirectory>C:/Apps</baseDirectory>
    <!--<workingDirectory>C:/test/MyServiceClient</workingDirectory>-->
    <!--<projectFile>MyServiceClient.sln</projectFile>-->
    <buildFile>default.build</buildFile>
    <targetList>
      <target>build</target>
    </targetList>
  </nant>
</tasks>
<publishers>
  <xmllogger/>
</publishers> 
```

谁能告诉我发生了什么事？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-11-05T16:02:47.930

您的 NANT 再次粘贴：

```
<?xml version="1.0"?>
<project name="MyServiceClient" default="build">
    <target name="init" depends="clean" /> <target name="clean" />
    <target name="checkout"/>
    <target name="compile"/>
    <!--<target name="deploy"/> <target name="test"/> <target name="inspect"/>-->
    <target name="build" depends="init, checkout">
         <call target="compile" />
         <!-- <call target="inspect" /> <call target="test" /> <call target="deploy" />-->
    </target>
</project> 
```

这个脚本什么都不做。NANT 甚至不使用此脚本查看您的源代码。

# mysql - Wordpress：从特定类别的帖子生成标签数组

> ID：1014689
> 
> 赞同：0
> 
> 时间：2009-06-18T19:22:44.683
> 
> 标签：mysql, wordpress

使用 Wordpress，我需要从特定类别的帖子中生成一组标签（术语）。

例如，如果我有两个类别，“apple”和“orange”，我想要一组仅在 apple 类别的帖子中使用的术语，而不是在 orange 类别中。*（不过，如果在两者*中都使用了一个术语，则应包括在内）

我尝试使用一些 wordpress 函数，但没有一个返回我想要的（包括 tag_cloud 函数）。我的猜测是我留下了一个查询电话......但到目前为止，我所有的查询都没有给我我想要的列表。

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-22T18:41:10.647

这是使用 WordPress 函数完成此操作的方法

```
<?php
$tags = array();

$posts = get_posts('category_name=new-cat&numberposts=-1'); //get all posts in category

foreach ($posts as $post){
    $posttags = get_the_tags($post->ID); //check for tags
    if ($posttags){
        foreach ($posttags as $posttag){
            $tags[$posttag->term_id] = $posttag->name; // add to array of tag ids => names
        }
    }
}
print_r($tags);
?> 
```

这可能比原始 sql 查询更可取，因为当 WordPress 更新其数据库模式时，这些查询经常会中断。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T02:17:14.270

我不确定您是否可以使用 WordPress 提供的功能来完成您想要的工作。这是一个 SQL 查询，似乎可以满足您的要求：

```
SELECT tag_terms.name, COUNT(wp_posts.ID) FROM wp_posts 

INNER JOIN wp_term_relationships AS cat_term_relationships ON wp_posts.ID= cat_term_relationships.object_ID 
INNER JOIN wp_term_taxonomy AS cat_term_taxonomy ON cat_term_relationships.term_taxonomy_id= cat_term_taxonomy.term_taxonomy_id 
INNER JOIN wp_terms AS cat_terms ON cat_term_taxonomy.term_id= cat_terms.term_id 

INNER JOIN wp_term_relationships AS tag_term_relationships ON wp_posts.ID= tag_term_relationships.object_ID 
INNER JOIN wp_term_taxonomy AS tag_term_taxonomy ON tag_term_relationships.term_taxonomy_id= tag_term_taxonomy.term_taxonomy_id 
INNER JOIN wp_terms AS tag_terms ON tag_term_taxonomy.term_id= tag_terms.term_id 

WHERE cat_term_taxonomy.taxonomy='category' AND cat_terms.name='apple' AND tag_term_taxonomy.taxonomy='post_tag'
GROUP BY tag_terms.name 
```

它的要点是您将 wp_posts 表与分类表连接几次以获取所需类别中的帖子 ID，然后将这些 ID 与分类表再连接几次以获取相关标签。

# iis - IE 随机不显示图像

> ID：1014703
> 
> 赞同：0
> 
> 时间：2009-06-18T19:24:56.833
> 
> 标签：iis, internet-explorer-8

当我在 IE 中加载我的网站时（我使用的是 8，但我在 7 和 6 上也看到过这种情况），每隔一段时间它就会显示一些图像的“红色 x”。我知道这些图像存在，所以我刷新了页面。当它再次渲染时，那些带有“红色 x”的图像现在可以正确显示，但其他图像，即使是在上次渲染中正确显示的图像，现在也有一个“红色 x”。

我通常需要刷新几次才能正确呈现整个页面。

我不知道是什么原因造成的，也不知道如何重复。

我确实查看了 Firefox 中的网络流量，并注意到大多数图像都返回 403 Not Modified。

有没有其他人经历过这个？你知道任何修复它的方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-18T19:30:29.770

使用[Fiddler](http://www.fiddler2.com)调试 HTTP 流量，并在您的网络服务器日志中查找请求。

未修改的是 304（不是 403）。如果你得到 304，这意味着它认为你的缓存版本很好。

如果您收到 403，那么您没有该文件的权限。它不应该加载。查看您是否收到 403，然后是带有授权标头的重新请求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T19:32:45.710

[我会破坏像Fiddler](http://www.fiddler2.com/fiddler2/)或[Charles](http://www.charlesproxy.com/) （对于 Mac）这样的 HTTP 调试器，并确保问题是 IE 而不是其他问题（如 IIS 丢弃/错误处理请求等）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-20T12:21:47.980

我有同样的问题。我使用 javascript Dom 对象创建的动态图像正在发生。所以我解决了这个问题。现在正常的日常图像标签在 IE7 中不显示。在 Firefox 中完美运行。我可以坐下来放松一下，看看有时图像在那里，有时它们不在。这是一个平面 html 文件，其中 javascritp 直接从我机器上的文件运行。没有意义。没有服务器或没有流量问题。它在我的机器上运行。我猜它是一个IE错误。我讨厌 IE。

# iphone - 自定义 iPhone 键盘

> ID：1014705
> 
> 赞同：11
> 
> 时间：2009-06-18T19:25:23.040
> 
> 标签：iphone, objective-c, cocoa-touch

有没有办法修改或制作自己的 iPhone 键盘，以便您可以输入不受支持的语言？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2011-06-21T13:54:43.387

您*可以*创建自己的键盘，但实际使用起来更加困难。

创建它：

1.  创建键盘视图。您可以使用任何您想要的子视图。最有用的方法可能是创建一个 UIView 子类。
2.  安排由任何 UIResponder 的[`inputView`](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIResponder_Class/Reference/Reference.html#//apple_ref/occ/instp/UIResponder/inputView)属性返回的键盘视图实例。对于 UITextView 和 UITextField，这就像分配属性一样简单；对于其他类，您可能必须对访问器进行子类化或调整，因为默认情况下该属性被声明为只读。

有关这方面的更多详细信息，请[参阅文档](http://developer.apple.com/library/ios/documentation/StringsTextFonts/Conceptual/TextAndWebiPhoneOS/InputViews/InputViews.html#//apple_ref/doc/uid/TP40009542-CH12-SW1)。

不幸的是，实际*使用*这个自定义键盘更加困难。从 iOS 4.3 开始， UITextField 和 UITextView 都不符合[`UITextInput`协议](http://developer.apple.com/library/ios/#documentation/uikit/reference/UITextInput_Protocol/Reference/Reference.html#//apple_ref/occ/intf/UITextInput)，这对于此目的来说是理想的。对于 UITextView，您应该能够使用该类提供的方法使其工作，但由于 UITextField 没有提供任何方法来查找当前选择或光标位置，您将无法使用公开创建功能齐全的键盘- 记录的方法（追加和从末尾删除是可能的，甚至可以[通过操作剪贴板在当前位置插入](https://stackoverflow.com/questions/1317929/insert-string-at-cursor-position-of-uitextfield/1618690#1618690)，但是像标准键盘上的“删除前一个字符”按钮将被证明是不可能的）。

从 iOS 5.0 开始，UITextField 和 UITextView 终于实现了 UITextInput 协议。现在在光标位置插入和删除文本应该是一件简单的事情。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-18T19:30:31.143

不，目前没有办法做到这一点。

有一些通过添加子视图来添加自己的按钮的 hacky 方法。但它不受支持，随时可能失败。

如果您决定创建自己的，您可能必须滚动您自己的文本框控件和任何其他需要键盘的控件。换句话说，这并不是一个真正理想的选择。

# c - 使用 ptr 按列读取

> ID：1014719
> 
> 赞同：0
> 
> 时间：2009-06-18T19:29:35.530
> 
> 标签：c

如果我想按行打印

```
char boo[] = 
     "abcd"
     "efgh"
     "ijkl"
     "mnop"; 
```

我会去

```
for(i = 0; i < 4; i++)
{
  char row[] = "";
  for(j = 0; j < 4; j+)
    printf("%c", *(boo++))
  putchar('\n');
  puts(row);

} 
```

我的问题是如何打印列所以我得到
aeim
bfjn
cgko
dhlp

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T19:31:55.570

因为它看起来像一个家庭作业，我只是给你一个线索。

你`boo`不是一个字符串数组 - 预处理器将所有相邻的字符串文字粘合到一个字符串中，所以你得到一个字符串“ `abcdefghijklmnop`”

您需要将其声明为

```
char *boo[] = {"abcd", "efgh", ...}; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-18T20:04:51.683

其他解决方案涉及修改 boo，您说这是违反规则的，这里是一个简单的解决方案。只需使用相对于外循环打印每 4 个字符的内循环。

```
int main() {
    int i, j;
    for(i = 0; i < 4; ++i) {
        for(j = 0; j < 4; ++j) {
            putchar(boo[i + j * 4]);
        }
        putchar('\n');
    }
} 
```

这样想，这实际上是手动将 boo 视为 2d 字符数组。由于用 2d 索引 1d 数组的公式是 (x + y * width)，因此您可以想象 i 是 x 坐标，j 是 y 坐标。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-18T19:44:43.237

```
#include <stdio.h>

int main (int argc, char* argv[])
{
    char *boo[] = {"abcd", "efgh", "ijkl", "mnop"};
    int i, j;

    for(i = 0; i < 4; i++) {
        for(j = 0; j < 4; j++)
            printf("%c", boo[j][i]);

        printf("\n");
    }
} 
```

-m

# asp.net - GridLines 没有显示在带有 CSS 重置的 GridView 中？

> ID：1014721
> 
> 赞同：3
> 
> 时间：2009-06-18T19:29:47.790
> 
> 标签：asp.net, css, gridview

我有一个包含 CSS 重置的页面。在该页面上，我有一个 GridLines="Both" 属性设置为 true 的 gridview，但没有出现网格线。如果我删除 css 重置，网格线就会出现。这只发生在 IE 中。我想要重置，我想要网格线出现。有谁知道这个问题的解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T21:58:28.363

确保调用样式表或定义在您调用重置样式表*后出现的网格线的样式。*

如果无法确保在重置样式表中没有定义更具体的选择器，则会覆盖您希望出现网格线的元素样式。也没有什么可以阻止您*在*重置样式表中定义网格线，就像检查覆盖样式的定义位置一样。

但是，正如 Jab 对您的问题的评论中所述，使用[Firebug](http://getfirebug.com/ "链接到“获取萤火虫”网站。")将是查看样式来自何处的最快方法。如果您使用的是 IE，假设您使用的是 IE8，那么您也可以使用[Firebug](http://elegantcode.com/2008/03/06/ie-team-ports-firebug-to-ie8/)，尽管他们将其称为[Developer Tools](http://blogs.msdn.com/ie/archive/2008/03/07/improved-productivity-through-internet-explorer-8-developer-tools.aspx)。

# mysql - '加载数据'的Mysql权限错误

> ID：1014724
> 
> 赞同：20
> 
> 时间：2009-06-18T19:30:32.173
> 
> 标签：mysql, load-data-infile, mysql-error-1045

尝试将平面文件数据库转储中的数据加载到新表中时遇到权限错误。我知道文件的架构和我的表是相同的，我尝试调整权限。我还应该尝试什么？

```
mysql> load data infile 'myfile.txt' into table mytable fields terminated by ',' enclosed by '"';
ERROR 1045 (28000): Access denied for user 'user'@'%' 

grant all on mytable.* to 'user'@'% 
```

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-06-18T19:39:46.007

[这是 MySQL 论坛上的一个线程](http://forums.mysql.com/read.php?30,12298,12313#msg-12313)，正是讨论了这一点。

这是答案，由 Ken Tassell 发布

> 使用以下命令解决了问题：

```
grant file on *.* to kentest@localhost identified by 'kentest1'; 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-18T19:42:36.297

您可能对目标表具有 MySQL 权限，但您还需要`FILE`执行权限`LOAD DATA`，当然 MySQL 服务器进程也需要对数据文件具有操作系统权限。

# iphone - NSMutableArray。将其转换为普通 ole C 数组的最快方法是什么

> ID：1014725
> 
> 赞同：2
> 
> 时间：2009-06-18T19:30:40.597
> 
> 标签：iphone, opengl-es, nsmutablearray

我喜欢 NSMutableArray 的便利性，但有时你只需要下拉到好的 ole C 数组。就像您将交错的顶点数组提供给 OpenGL 时一样。

将 NSMutableArray 的内容复制到 C 数组的最快方法是什么？

是的，我意识到这种混洗会导致效率低下，但我想看看我是否可以在不影响帧速率的情况下通过这种方法偷偷摸摸。

干杯，道格

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-18T20:04:59.093

[来自 Cocoabuilder 邮件列表](http://www.cocoabuilder.com/archive/message/cocoa/2007/10/2/190184)

```
id *buffer = malloc(numberOf_ItemsIWant_ToFetch * sizeof(id));
[myArray getObjects:buffer range:rangeOfItems] 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-18T19:42:21.290

见[`-[NSArray getObjects:]`](http://developer.apple.com/DOCUMENTATION/Cocoa/Reference/Foundation/Classes/NSArray_Class/Reference/Reference.html#//apple_ref/occ/instm/NSArray/getObjects:)。只需给它一个适当大小的缓冲区，NSArray 就会用它的内容填充缓冲区。NSMutableArray 是 NSArray 的子类，因此它响应所有相同的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-18T19:37:50.833

```
NSMutableArray *arrayOfThings;
Element elements[arrayOfThings.count+1];

for (int i=0;i<arrayOfThings.count;i++)
{
    elements[i] = [arrayOfThings objectAtIndex:i];
} 
```

或类似的东西。我在 Apple 文档中看不到任何简单的方法来做到这一点。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-18T19:43:09.073

```
int i=0;
foreach(YourClass *obj in array)
{
   carray[i++] = [obj yourMethodToConvertToCType];
} 
```

# c# - 使用 System.IO.BinaryWriter 写入字符串与 char 数组的区别

> ID：1014727
> 
> 赞同：4
> 
> 时间：2009-06-18T19:30:50.987
> 
> 标签：c#, string, encoding, file, binaryfiles

我正在将文本写入 C# 中的二进制文件，并看到写入字符串和字符数组之间写入的数量差异。我正在使用 System.IO.BinaryWriter 并在写入发生时观看 BinaryWriter.BaseStream.Length。这些是我的结果：

```
using(BinaryWriter bw = new BinaryWriter(File.Open(“data.dat”), Encoding.ASCII))
{
  string value = “Foo”;

  // Writes 4 bytes
  bw.Write(value);

  // Writes 3 bytes 
  bw.Write(value.ToCharArray());
} 
```

我不明白为什么当我只写 3 个 ASCII 字符时字符串重载会写 4 个字节。谁能解释一下？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-18T19:40:56.787

for 的文档[`BinaryWriter.Write(string)`](http://msdn.microsoft.com/en-us/library/yzxa6408.aspx)指出它将一个以长度为前缀的字符串写入此流。for 的重载[`Write(char[])`](http://msdn.microsoft.com/en-us/library/k13xbf58.aspx)没有这样的前缀。

在我看来，额外的数据是长度。

编辑：

为了更明确一点，使用反射器。你会看到它有这段代码作为`Write(string)`方法的一部分：

```
this.Write7BitEncodedInt(byteCount); 
```

这是一种使用尽可能少的字节数对整数进行编码的方法。对于短字符串（我们日常使用的少于 128 个字符的字符串），它可以用一个字节来表示。对于更长的字符串，它开始使用更多字节。

以下是该函数的代码，以防您感兴趣：

```
protected void Write7BitEncodedInt(int value)
{
    uint num = (uint) value;
    while (num >= 0x80)
    {
        this.Write((byte) (num | 0x80));
        num = num >> 7;
    }
    this.Write((byte) num);
} 
```

在使用此编码为长度添加前缀后，它会以所需编码写入字符的字节。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-18T19:42:59.213

从`BinaryWriter.Write(string)` [文档](http://tinyurl.com/n5fsap)：

以 BinaryWriter 的当前编码将**长度前缀**字符串写入此流，并根据使用的编码和写入流的特定字符推进流的当前位置。

这种行为可能是为了在使用`BinaryReader`字符串读回文件时可以识别。（例如`3Foo3Bar6Foobar`，可以解析成字符串“Foo”、“Bar”和“Foobar”但`FooBarFoobar`不能。）事实上，`BinaryReader.ReadString`正是使用这些信息`string`从二进制文件中读取。

从`BinaryWriter.Write(char[])` [文档](http://tinyurl.com/klk2ud)：

将字符数组写入当前流，并根据使用的编码和写入流的特定字符推进流的当前位置。

很难夸大 MSDN 上的文档的全面性和实用性。始终先检查它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-18T19:54:29.317

如前所述，BinaryWriter.Write(String) 在写入字符串本身之前将字符串的长度写入流。

这允许 BinaryReader.ReadString() 知道字符串有多长。

```
using (BinaryReader br = new BinaryReader(File.OpenRead("data.dat")))
{
    string foo1 = br.ReadString();
    char[] foo2 = br.ReadChars(3);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-18T19:33:09.483

你看过实际写的内容吗？我猜是一个空终止符。

# visual-studio - Visual Studio 找不到 CPPUNIT 调试数据库

> ID：1014745
> 
> 赞同：0
> 
> 时间：2009-06-18T19:36:56.683
> 
> 标签：visual-studio, cppunit

我正在使用带有 CPPUNIT 的 Visual Studio 2008。我已经编译了 CPPUNIT 并将 CPPUNIT 路径添加到 Include 和 Library 路径。目前，我可以使用 CPPUNIT 库编译我的程序。

但是，链接器会生成以下警告：

> 警告 2 警告 LNK4099：在“C:\Program Files\cppunit\cppunit-1.12.1\lib\cppunitd.lib”或“c:\Users\hide1713\Desktop\3d_tank\”中找不到 PDB“vc90.pdb” cpp_pj\bin\vc90.pdb'; 链接对象好像没有调试信息 cppunitd.lib GameUnitTest

有一个 cppunitd_dll.pdb 文件以及 cppunitd.lib。如何告诉链接器在哪里可以找到 CPPUNIT 调试数据库？

谢谢大家。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-26T20:42:58.583

在您的 CppUnit 项目中，确保您的编译器发出与您的主项目兼容的程序数据库文件。在 CppUnit 项目属性窗口中，在 Config properties / C++ / General 树下，您将看到 Debug Information Format 框。选择“Program Database /Zi”或与主项目中的相同设置完全匹配的任何值。当然，您随后必须重新编译它们。

# c - C：更好的方法来做 sizeof(((SomeStruct *) 0)->some_member)？

> ID：1014750
> 
> 赞同：1
> 
> 时间：2009-06-18T19:37:45.263
> 
> 标签：c, ffi

我想获取结构中特定成员的大小。

`sizeof(((SomeStruct *) 0)->some_member)`对我有用，但我觉得可能有更好的方法来做到这一点。

我可以`#define SIZEOF_ELEM(STRUCT, ELEM) sizeof(((STRUCT *) 0)->ELEM)`然后使用`SIZEOF_ELEM(SomeStruct, some_member)`，但我想知道是否已经有更好的内置功能。

我的具体用例在 hsc2hs（Haskell C 绑定）中。

```
pokeArray (plusPtr context (#offset AVFormatContext, filename)) .
  take (#size ((AVFormatContext *) 0)->filename) .
  (++ repeat '\NUL') $ filename 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-18T19:51:44.080

如果你不能保证你有一个变量可以取消引用，那么你所得到的就是尽可能干净。（如果可以，当然可以只使用`sizeof(var.member)`or `sizeof(ptr->member)`，但这在某些需要编译时常量的情况下不起作用。）

很久很久以前（大约 1990 年），我遇到了一个编译器，它`offsetof`使用基地址 0 定义了 ' '，然后它崩溃了。我通过`<stddef.h>`使用 1024 而不是 0 解决了这个问题。但是你现在不应该遇到这样的问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-18T19:52:37.103

我相信您已经在那里找到了正确的解决方案。您可以挖掘您的 stddef.h 并查看 offsetof 是如何定义的，因为它做了非常相似的事情。

请记住，由于填充，成员的大小和该成员的偏移量与下一个成员的偏移量之间可能存在差异。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-18T19:53:08.507

在 C++ 中，您可以执行 sizeof(SomeStruct::some_member)，但这是 c，您没有范围解析运算符。就我所知，你写的已经写得很好了。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-18T20:03:38.033

Microsoft 在其标题之一中包含以下内容：

```
#define RTL_FIELD_SIZE(type, field) (sizeof(((type *)0)->field)) 
```

我认为没有理由做任何不同的事情。

他们有相关的宏：

```
RTL_SIZEOF_THROUGH_FIELD()
RTL_CONTAINS_FIELD() 
```

和漂亮的：

```
CONTAINING_RECORD() 
```

这有助于在直接 C 中实现通用列表，而不必要求链接字段位于结构的开头。有关详细信息，请参阅这篇[Kernel Mustard 文章](http://kernelmustard.com/2006/11/04/containing_record-for-fun-and-profit/)。

# lua - 为 Lua 声明变量和范围问题

> ID：1014757
> 
> 赞同：5
> 
> 时间：2009-06-18T19:38:50.550
> 
> 标签：lua, scope

我是[Bitfighter](http://bitfighter.org)的首席开发人员，我们使用 Lua 作为脚本语言来允许玩家编写他们自己的自定义机器人飞船。

在 Lua 中，您不需要声明变量，所有变量默认为全局范围，除非另有声明。这会导致一些问题。以下面的代码片段为例：

```
loc = bot:getLoc()
items = bot:findItems(ShipType)     -- Find a Ship

minDist = 999999
found = false

for indx, item in ipairs(items) do           
   local d = loc:distSquared(item:getLoc())  

   if(d < minDist) then
      closestItem = item
      minDist = d
   end
end

if(closestItem != nil) then 
   firingAngle = getFiringSolution(closestItem) 
end 
```

在这个片段中，如果 findItems() 没有返回任何候选者，那么最近的Item 仍然会引用它最后一次找到的任何船，并且在中间时间，该船可能已经被杀死。如果这艘船被杀死，它就不再存在，getFiringSolution() 将失败。

你发现问题了吗？好吧，我的用户也不会。这是微妙的，但具有戏剧性的效果。

一种解决方案是要求声明所有变量，并将所有变量默认为本地范围。虽然这种变化不会使程序员无法引用不再存在的对象，但它会使无意中这样做变得更加困难。

有没有办法告诉 Lua 将所有变量默认为本地范围，和/或要求声明它们？我知道其他一些语言（例如 Perl）有这个选项可用。

谢谢！

* * *

这里有很多好的答案，谢谢！

我决定使用 Lua 'strict' 模块的略微修改版本。这似乎让我到达了我想去的地方，我会稍微改进一下以改进消息并使它们更适合我的特定环境。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-18T20:56:29.707

没有设置此行为的选项，但标准安装提供了一个“严格”模块，它正是这样做的（通过修改元表）。用法：要求“严格”

有关更深入的信息和其他解决方案：http: [//lua-users.org/wiki/DetectingUndefinedVariables](http://lua-users.org/wiki/DetectingUndefinedVariables)，但我推荐“严格”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-18T20:16:38.303

排序。

在 Lua 中，全局变量名义上存在于全局变量表中`_G`（实际情况要复杂一些，但从 Lua 方面来看，无法告诉 AFAIK）。与所有其他 Lua 表一样，可以将元表附加`__newindex`到`_G`控制如何将变量添加到其中的元表。当有人创建一个全局变量时，让这个`__newindex`处理程序做任何你想做的事情：抛出一个错误，允许它但打印一个警告，等等。

插手`_G`，使用起来最简单，最干净`setfenv`。请参阅[文档](http://www.lua.org/pil/14.3.html)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-19T07:39:14.183

“本地默认是**错误**的”。请参见

[http://lua-users.org/wiki/LocalByDefault](http://lua-users.org/wiki/LocalByDefault)

[http://lua-users.org/wiki/LuaScopingDiscussion](http://lua-users.org/wiki/LuaScopingDiscussion)

您需要使用某种全球环境保护措施。有一些静态工具可以做到这一点（不太成熟），但最常见的解决方案是使用运行时保护，基于`__index`和`__newindex`in`_G`的元表。

耻辱插件：这个页面也可能有用：

[http://code.google.com/p/lua-alchemy/wiki/LuaGlobalEnvironmentProtection](http://code.google.com/p/lua-alchemy/wiki/LuaGlobalEnvironmentProtection)

请注意，虽然它讨论了嵌入到 swf 中的 Lua，但所描述的技术（参见[源代码](http://github.com/lua-alchemy/lua-alchemy/blob/v0.2/alchemy/lua-lib/assets/lua_alchemy/lua/strict.lua)）确实适用于通用 Lua。我们在工作中的生产代码中使用了这些方面的东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T01:21:34.787

实际上，带有对船的陈旧引用的额外全局变量将足以防止 GC 丢弃该对象。因此，它可以在运行时通过注意到这艘船现在“死亡”并拒绝对它做任何事情来检测到。它仍然不是正确的船，但至少你不会坠毁。

您可以做的一件事是将用户脚本保存在一个[沙箱](http://lua-users.org/wiki/SandBoxes)中，可能每个脚本都有一个沙箱。通过正确操作沙箱的环境表或其元表，您可以安排在调用用户代码之前（或之后）丢弃沙箱中的所有或大部分全局变量。

调用后清理沙箱的好处是可以丢弃对不应该闲逛的东西的额外引用。这可以通过保留允许保留在环境中的字段的白名单并删除所有其余字段来完成。

例如，以下实现了对用户提供的函数的沙盒调用，其环境仅包含为每个调用提供的新暂存表后面的白名单名称。

```
-- 可供用户脚本使用的全局变量表
本地用户_G = {
        打印=_G.打印，
        数学=_G.math，
        -- ...
    }
-- 用户沙箱的元表
本地 env_mt = { __index=user_G }

-- 在一个沙箱中调用函数，在这个环境中新的全局
-- 变量可以被创建和修改，但是当
-- 用户代码完成。
函数 doUserCode(user_code, ...)
    local env = setmetatable({}, env_mt) -- 使用 RO 全局变量创建一个全新的用户环境
    setfenv(user_code, env) -- 挂在用户代码上
    本地结果 = {pcall(user_code, ...)}
    setfenv(user_code,{})
    返回解包（结果）
结尾

```

如果您愿意，可以通过将全局表推回到另一个元表访问之后，将其扩展为只读。

请注意，完整的沙盒解决方案还将考虑如何处理意外（或恶意）执行无限（或仅非常长）循环或其他操作的用户代码。[通用解决方案是Lua 列表](http://www.lua.org/lua-l.html)中偶尔讨论的话题，但好的解决方案很难。

# jquery - jQuery UI 日历显示太大，想要演示大小吗？

> ID：1014766
> 
> 赞同：35
> 
> 时间：2009-06-18T19:40:09.017
> 
> 标签：jquery, user-interface, jquery-ui

所以我为 jQuery 下载了一个自定义主题的 UI，并将日历控件添加到我的站点（例如：[链接文本](http://jqueryui.com/demos/datepicker/)）。在示例中，它显示/显示我想要的大小，但在我的网页上它大约是两倍大小。为什么？？？

我确实有很多其他的 CSS，但我无法控制页面的外观和感觉（无法触摸当前的 CSS，MEH ！！）。有没有办法在我的网站上获得演示外观？

我认为这是 jQuery UI 的代码可能会使事情复杂化

```
/* Component containers
----------------------------------*/
.ui-widget { font-family: Arial, Helvetica, Verdana, sans-serif; font-size: 1.1em; }
.ui-widget input, .ui-widget select, .ui-widget textarea, .ui-widget button { font-family: Arial, Helvetica, Verdana, sans-serif; font-size: 1em; }
.ui-widget-content { border: 1px solid #B9C4CE; background: #ffffff url(../images/ui-bg_flat_75_ffffff_40x100.png) 50% 50% repeat-x; color: #616161; }
.ui-widget-content a { color: #616161; }
.ui-widget-header { border: 1px solid #467AA7; background: #467AA7 url(../images/ui-bg_highlight-soft_75_467AA7_1x100.png) 50% 50% repeat-x; color: #fff; font-weight: bold; }
.ui-widget-header a { color: #fff; } 
```

它是自定义 UI CSS 的一部分

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2009-06-22T17:09:43.527

我想到了。正是字体大小使整个事情变得混乱。我添加了这个标签来正确显示我想要的尺寸：

```
#ui-datepicker-div { font-size: 12px; } 
```

如果其他人需要这样的东西，效果很好

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2010-10-05T17:03:04.550

```
.ui-widget{ font-size: 0.8em; } 
```

那是解决方案，但是，我不知道的是，如果您将其放入 head 元素中，如下所示：

```
<style type="text/css">
.ui-widget { font-family: Lucida Grande, Lucida Sans, Arial, sans-serif; font-size: 0.8em; }
</style> 
```

**它会覆盖其他设置**，因此您仍然可以加载 google 托管的 css 但使用它来覆盖它 =)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2010-08-22T02:52:43.413

要修复日历控件的大小，请更改此：

```
.ui-widget { font-family: Lucida Grande, Lucida Sans, Arial, sans-serif; font-size: 1.1 em; } 
```

对此：

```
.ui-widget { font-family: Lucida Grande, Lucida Sans, Arial, sans-serif; font-size: 0.8em; } 
```

有关详细说明，请访问 - [http://blog.greatdevelopers.com/?p=33](http://blog.greatdevelopers.com/?p=33)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2010-06-16T11:27:28.340

如果要为所有 jQuery 小部件设置字体大小或字体系列，最好设置如下内容：

```
.ui-widget {
    font-size: .7em;
} 
```

在调用加载 jQuery UI CSS 文件之后。

所有 jQuery UI 组件都是小部件并继承`.ui-widget`顶层的样式。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-18T19:47:52.870

DOM 检查器（例如，Firebug、IE Developer Toolbar 等）应该可以帮助您确定哪些 CSS 样式正在影响您的日历。

也许任何一方阻止你接触 CSS 都会让你在容器中自由支配？IE，

```
<div id="foo">Your stuff goes here. All your selectors must start with #foo</div> 
```

如果没有，您显然可以控制 JS。您应该能够用它编写内联样式。

编辑

您还可以查看是否可以将内容包装在 iframe 中。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-05-07T18:55:38.793

为了让我的日历更小，我必须对 css 进行更多更改。
正如其他一些人已经提到的那样，我将以下行添加到页面内的样式标记中（因此它不会影响我网站上的所有其他日期选择器）

```
div.ui-datepicker{ font-size:7px;} 
```

但这只会使标题大小变小（月年）。为了使工作日标签和天数更小，我还必须从 jquery-ui-1.8.18.custom.css 中复制以下两行并将它们放在我的页面中，但随后我还必须添加字体两者的尺寸规格。

```
.ui-datepicker th { padding: .7em .3em; text-align: center; font-weight: bold; border: 0;}
.ui-datepicker td { border: 0; padding: 1px; } 
```

所以我最终得到的是以下内容：

```
<style type="text/css">
div.ui-datepicker{ font-size:7px;}
.ui-datepicker th { padding: .7em .3em; text-align: center; font-weight: bold; border: 0; font-size: 1.6em;}
.ui-datepicker td { border: 0; padding: 1px; font-size: 1.6em;}
</style> 
```

这使我可以控制日期和年份、工作日标签和日期数字的字体大小。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-07-17T08:15:21.353

我会推荐你​​使用

```
.ui-datepicker { font-size:10px !important; } 
```

而不是使用

```
#ui-datepicker-div { font-size:10px !important; } 
```

因为与仅用于特定元素的元素选择器相比，css 类选择器的范围更广。您需要做的就是创建另一个类类型的 html 元素，您完全不必担心任何事情。

但是，在您的问题中，您无需执行任何操作，只需将类选择器添加到您自己的 css 文件中，而不是 jquery-ui 文件中，并且您已排序，如果您需要创建另一个日期选择器，您将不必担心以这种方式再次修改css。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-06-20T14:49:48.367

使用 CSS 缩放

```
.ui-widget{ 
    -ms-transform: translate(-15%,-15%) scale(0.7);//translate must be before scale
    -moz-transform: translate(-15%,-15%) scale(0.7);
    -webkit-transform: translate(-15%,-15%) scale(0.7);
    transform: translate(-15%,-15%) scale(0.7);
} 
```

在上面的代码中，我使用了“scale(0.7)”，这意味着新的宽度和高度将是原始值的 70%。转换后的元素**将与原始元素具有相同的中心**，因此宽度减少 30%，这意味着从左侧减少 15%，从右侧减少 15%，高度也是如此。所以我们必须使用 translate 将新元素移动到左上角。“翻译”必须在“缩放”之前，因此“15%”将是原始宽度的 15%（即在我们缩放之前），而不是转换后的新宽度。

[![在此处输入图像描述](../Images/79393bc432972b0d9ab43cece79a85b1.png)](https://i.stack.imgur.com/TB9vL.png)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-18T19:48:50.670

检查您的页面上没有 css 冲突 - 例如 html/body 或容器字体大小设置会向下流入日历。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-08-20T09:05:25.440

无论您想要什么大小您都可以通过在 css 中编辑此行来设置。

```
.ui-widget { font-family: Arial, Helvetica, Verdana, sans-serif; font-size: 1.1em; } 
```

只需提供另一种字体大小，例如 .5em 或 .8em

```
 .ui-widget { font-family: Arial, Helvetica, Verdana, sans-serif; font-size: .5em; } 
```

它会工作，我没有。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-08-20T20:56:20.010

这很简单：Jquery-ui 只是使用对象样式完成他的工作。我是说 ：

```
<html>
   <body
     <input type="text" id="date"/>
     <script type="text/javascript"> $("#date").datepicker()</script>
   </body>
</html> 
```

日期编号和月份名称的大小将在 $("#date").css("font-size") 的函数中设置。因此，如果输入的字体大小为 6px，则 datepicker 看起来会很小。如果 font-size 为 42pt，它将是一个盲目的日期选择器！

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-10-03T13:49:42.317

我只是偶然发现了这一点，但尝试将 DOCTYPE html 添加到您的文档中

```
<!DOCTYPE html>
<html>
    <body>
    </body>
</html> 
```

在您打开 html 标记之前。

# gawk - 致命：先前定义的函数名

> ID：1014782
> 
> 赞同：1
> 
> 时间：2009-06-18T19:43:04.347
> 
> 标签：gawk

对于下面的清单，我收到一个错误：

> 致命：先前定义的函数名称“myprint”

```
$3 > 0     { myprint ($3) }

function myprint(num)
{
    printf "%6.3g\n", num
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T19:44:20.523

我发现在调用之后和参数之间有一个额外的空间：

```
myprint ($3) 
```

应该：

```
myprint($3) 
```

# c# - 将 Excel 工作表放入 C# 打印预览对话框

> ID：1014787
> 
> 赞同：0
> 
> 时间：2009-06-18T19:43:46.810
> 
> 标签：c#, excel, excel-2007

我正在使用 C# 和 Excel 2007。谁能告诉我如何将 Excel 工作表放在 C# 打印预览对话框中？以及如何将 Excel 工作表放入一张纸的可打印区域。提前致谢！

是否可以在打印预览对话框中添加额外的按钮？我想在那里放置一个文本字段，以便用户可以输入要打印在纸上的文本。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-19T15:31:53.290

[SpreadsheetGear for .NET](http://www.spreadsheetgear.com/)有一个 WorkbookView.PrintPreview() 方法，该方法在 .NET 打印预览窗口中显示 Excel 工作簿，并支持 IPageSetup.FitToPagesTall / FitToPagesWide 属性以强制在一页上打印。

您可以下载[免费试用版](https://www.spreadsheetgear.com/downloads/register.aspx)并在 C# 控制台应用程序中运行此代码（首先添加对 SpreadsheetGear.dll 和 System.Windows.Forms.dll 的引用）：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using SpreadsheetGear;

namespace SpreadsheetGearPrintPreview
{
    class Program
    {
        static void Main(string[] args)
        {
            // Create a workbook to preview.
            IWorkbook workbook = Factory.GetWorkbook();
            IWorksheet worksheet = workbook.Worksheets[0];
            worksheet.Name = "MySheet";
            worksheet.Cells["A1:J100"].Formula = "=ROUND(RAND()*ROW()*COLUMN(),0)";

            // Set the print area.
            IPageSetup pageSetup = worksheet.PageSetup;
            pageSetup.PrintArea = "A1:J100";

            // This will force the workbook to be printed on one page.
            pageSetup.FitToPagesTall = 1;
            pageSetup.FitToPagesWide = 1;

            // Create a WorkbookView and display the workbook in Print Preview.
            var workbookView = new SpreadsheetGear.Windows.Forms.WorkbookView(workbook);
            workbookView.PrintPreview();
        }
    }
} 
```

您还可以使用 SpreadsheetGear WorkbookView 控件来允许用户编辑工作簿。SpreadsheetGear 不支持修改打印预览窗口。它确实有 SpreadsheetGear.Drawing.Image API，您可能会在自己的打印预览窗口中使用这些 API，但这可能需要相当多的工作，而且我不确定 .NET 打印预览框架的可定制性如何。

免责声明：我拥有 SpreadsheetGear LLC

# apache-flex - 用于浏览器的 Adob e Flash/Flex 中的键盘代码映射

> ID：1014793
> 
> 赞同：2
> 
> 时间：2009-06-18T19:44:28.807
> 
> 标签：apache-flex, flash, browser, user-interface, keyboard

**注意请记住***键*码和*字符*码 之间的区别。例如，数字 1（一）和字符 ! (bang) 两者的*键*码相同，但*字符*码不同。同样，数字行中的数字 7 和小键盘中的数字 7 具有不同的*键*码，但*字符*码相同。

我正在 Adob​​e Flex 中编写音乐节奏游戏，并想绑定键盘键。这不是问题，但我肯定会遇到问题，例如，将默认键设置为 A、S、D 和 F 并告诉用户是这种情况。

如果您查看[flash.ui.Keyboard](http://livedocs.adobe.com/flex/3/langref/flash/ui/Keyboard.html)的文档，您会看到键盘键到键码的常量。但是，这些仅在 Adob​​e AIR 中可用，在浏览器中不可用。这是有道理的，因为并非所有操作系统和键盘都相同（或存在！），因此键码可能会有所不同。

**那么，我怎样才能分配有意义的默认键而不是选择键码和祈祷呢？**

我唯一理智的想法是存储键绑定的*字符*代码，然后为字符串映射提供字符代码，以便我可以告诉用户按什么。 **然而，我的直觉告诉我，这将以微妙或不那么微妙的方式打破。** 像大写字母一样。

谢谢。

**更新：**我目前正在使用[radekg 的](https://stackoverflow.com/questions/1014793/keyboard-code-mapping-in-adobe-flash-flex-for-the-browser/1015239#1015239)答案，但我仍然认为这很容易打破。如果有人说服我这是正确的，我会感觉更舒服。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-18T21:20:03.060

根据 Flash 8 文档，您可以简单地依赖 ASCII 代码。查看 Flash 8 文档的这些主题：

*   [http://livedocs.adobe.com/flash/mx2004/main_7_2/wwhelp/wwhimpl/common/html/wwhelp.htm?context=Flash_MX_2004&file=00001113.html](http://livedocs.adobe.com/flash/mx2004/main_7_2/wwhelp/wwhimpl/common/html/wwhelp.htm?context=Flash_MX_2004&file=00001113.html)
*   [http://livedocs.adobe.com/flash/mx2004/main_7_2/wwhelp/wwhimpl/common/html/wwhelp.htm?context=Flash_MX_2004&file=00001115.html#71579](http://livedocs.adobe.com/flash/mx2004/main_7_2/wwhelp/wwhimpl/common/html/wwhelp.htm?context=Flash_MX_2004&file=00001115.html#71579)
*   [http://livedocs.adobe.com/flash/mx2004/main_7_2/wwhelp/wwhimpl/common/html/wwhelp.htm?context=Flash_MX_2004&file=00001116.html#71709](http://livedocs.adobe.com/flash/mx2004/main_7_2/wwhelp/wwhimpl/common/html/wwhelp.htm?context=Flash_MX_2004&file=00001116.html#71709)
*   [http://livedocs.adobe.com/flash/mx2004/main_7_2/wwhelp/wwhimpl/common/html/wwhelp.htm?context=Flash_MX_2004&file=00001114.html#71525](http://livedocs.adobe.com/flash/mx2004/main_7_2/wwhelp/wwhimpl/common/html/wwhelp.htm?context=Flash_MX_2004&file=00001114.html#71525)

据我所知，所有现代操作系统都使用标准 ASCII。这些代码自 Flash 5 时代以来没有改变。如果您不想依赖 ASCII 代码来比较字母：

```
private function compareChar(code:Number):void {
    if ( "a" == String.fromCharCode( code ).toLowerCase() ) {
        trace("A pressed");
    } else {
        trace("You pressed " + String.fromCharCode(code));
    }
}
...
compareChar(65); // 65 is A
compareChar(96); // 96 is numpad 0 
```

但是我认为你可以依赖 ASCII 码。希望这可以帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-24T18:37:48.930

Radkg 基本上是正确的。

Flash 有一个内置的 Flash.ui.KeyLocation 类，它具有四个静态属性：LEFT、RIGHT、NUM_PAD、STANDARD。这意味着即使键盘已重新映射，您也可以确定按下了哪个键。如果你将它与 String.fromCharCode 结合使用，你应该能够相当巧妙地解决这个问题。

您的最终代码可能如下所示：

```
import flash.ui.KeyLocation;
import flash.events.KeyboardEvent;

function handleKeyboardEvent( event:KeyboardEvent )
{
    // This will work for a majority of the keys.
    var key:String = String.fromCharCode( event.charCode ).toLowerCase();

    // Use strict comparison
    if( event.keyLocation !== KeyLocation.STANDARD )
    {
        // The key is a number, then it needs to be re-identified.
        if( event.keyLocation == KeyLocation.RIGHT  )    key = "r" + key;
        if( event.keyLocation == KeyLocation.LEFT   )      key = "l" + key;
        if( event.keyLocation == KeyLocation.NUM_PAD)   key = "n" + key;
    }

    switch( key )
    {
        case "r1":
            // Do something with the one which is not on the keypad.
            break;
        case "n.":
            // Do something with the number pad's period.
            break;
        case "n":
            // Do something with the letter N.
            break;
    }
} 
```

我承认，我不确定 String.fromCharCode 和控制键（F1、Alt、Ctrl 等）会发生什么，但 KeyboardEvent 确实支持 event.shiftKey、event.ctrlKey、event.altKey

# internet-explorer-8 - 如何让 WatiN 在带有 IE8 的 Windows Server 2008 上工作？

> ID：1014815
> 
> 赞同：21
> 
> 时间：2009-06-18T19:49:49.777
> 
> 标签：internet-explorer-8, nunit, windows-server-2008, watin

我的问题是我无法在运行 Windows Server 2008 和 IE8 的开发机器上进行简单的 WatiN 测试以可靠地工作。

我已经看到了一些关于此的好帖子，但仍然遇到问题。以下是帖子：

*   [MSDN 测试文章](http://msdn.microsoft.com/en-us/magazine/dd744751.aspx)
*   [堆栈溢出-WatiN 第二种方法失败](https://stackoverflow.com/questions/679347/watin-in-visual-studio-2008-second-test-method-fails)

第一篇文章中的步骤似乎有所帮助（在我的主机文件中注释掉“::1”，将我的站点放在受信任的站点中，并确保我的 app.config 具有“STA”并设置为“如果较新”，但它们并没有可靠地帮助。我尝试了第二个示例中的代码，希望它会有所帮助，但它没有。我使用的是 WatiN 2.0 beta 1。

我的 NUnit 代码如下所示：

```
protected Browser Browser { get; set; }

[TestFixtureSetUp]
public void SetupPriorToTestsInThisFixture()
{
    Browser = new IE();
    Browser.GoTo(Constants.SiteCollectionUrl);
}

[TestFixtureTearDown]
public void TearDownAfterTestsInThisFixture()
{
    if (Browser != null)
    {
        Browser.Dispose();
    }
}

[Test]
public void WaterThroughThePipes()
{
    Link link = Browser.Link(Find.ByText("Calendar"));
    bool exists = link.Exists;
    Assert.That(exists, Is.True, "Could not find 'Calendar' link.");
} 
```

我所看到的是有时（尽管很少）我的测试通过了。有时断言失败（exists = false），有时我在尝试打开浏览器时超时，有时我在尝试访问 link.Exists 时遇到错误。

访问 link.Exists 的错误如下所示：

> MyFixture.WaterThroughThePipes：System.Runtime.InteropServices.COMException：接口未知。（来自 HRESULT 的异常：0x800706B5）

我现在似乎无法重现超时错误，所以我目前无法提供（尽管这曾经一直发生）。

在调试模式下运行与不在调试模式下运行时，我倾向于看到不同的结果。

对于它的价值，Firefox 3.0.6 从来没有为我工作过。我愿意，但无论如何都需要 IE 才能工作。这是我在使用 Firefox 时遇到的错误。

> MyFixture (TestFixtureSetUp): WatiN.Core.Native.Mozilla.FireFoxException : 无法连接到 jssh 服务器，请确保您已正确安装 jssh.xpi 插件 ----> System.Net.Sockets.SocketException : 无法连接因为目标机器主动拒绝它 127.0.0.1:9997

有任何想法吗？我真的不想回到 Selenium（去过那里，做过那个），但我可能不得不这样做。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-10-15T19:14:50.503

以管理员身份运行 Visual Studio

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2010-12-15T21:16:30.103

通过将我的 Internet 安全设置调整为“启用保护模式”，即使对于本地 Intranet 站点，我也能够让这个 COM 错误消失 - 并使我的测试正常运行。这个单一的复选框使一切变得不同。（而且我不必以管理员身份运行 Visual Studio。）

[请参阅此博客文章](http://spin.atomicobject.com/2010/12/15/watin-and-com-errors-enable-ie-protected-mode-for-local-intranet-zone)以解决此问题，而无需以管理员身份运行 Visual Studio。

简要地：

在 Internet Explorer 中，打开工具 -> Internet 选项 -> 安全 -> 本地 Intranet，然后选中“启用保护模式”框。

我在 Windows 7 上运行 IE 8 和 Visual Studio 2010。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-23T03:42:02.903

IE8 definatley 与 WatiN 合作，自 IE8 首次公开发布以来一直如此。

如果某些东西在调试中工作但在运行时没有工作，通常表明存在时间或 Server 2008 安全锁定问题。

您应该将失败的行放在 try catch 中，然后如果有异常暂停半秒，然后重试。

还要确保您已关闭所有额外的服务器安全锁定，并以管理员身份运行 nUnit 以避免 UAC 妨碍。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-13T15:57:16.133

关于您在 Firefox 上看到的错误...这可以通过安装[FireWatir FF 插件](http://code.google.com/p/firewatir/downloads/list)来克服。（或者至少在 3.5.3 上对我有用）

但正如已经提到的，IE 是受支持的，并且在 WatiN 上下文中，使用 FireFox 并不是什么神奇的解决方案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-06-29T10:01:57.353

避免以管理员身份运行 Visual Studio 或 NUnit 的另一种选择是在计算机级别禁用 UAC，如果您以最低权限运行（应该是），这不应该是安全问题。

# ruby-on-rails - 刷新后表单保留值

> ID：1014819
> 
> 赞同：3
> 
> 时间：2009-06-18T19:50:50.963
> 
> 标签：ruby-on-rails, ruby, forms

所以我继承了这个遗留的 Rails 代码库，我需要修复一个错误，即使在页面刷新之后，给定表单仍保留值（尚未保存到数据库）。

用例：用户在表单中填写数据但没有按提交。用户单击浏览器上的刷新按钮。保留表单中的值，而不是刷新整个页面。

我可以从哪里开始寻找任何想法？在我简短的、有限的 Rails 经验中，这不是默认情况下发生的那种事情，所以它必须在某个地方编码？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-18T19:52:31.317

有时浏览器会这样做。（我不是在谈论自动填充下拉菜单，浏览器也会这样做......只是在谈论部分填写，从未提交，然后刷新的表单）。

通过检查 HTML 源窗口，确保字段中的值实际上来自您的 Rails 应用程序。

由于之前的条目，浏览器提供的值不会出现在 VALUE 属性中，但服务器提供的值会出现。

避免这种情况的一些选择可能是：

*   使用 POST 将用户发送到表单。因此，任何刷新都会导致“您要重新提交”等。我*认为*浏览器不会在这种情况下预先填写任何字段（与用户发布然后点击后退按钮时相同）。
*   使用 onload() 事件清除表单字段值。

可能有一个更简单的解决方案...... Ctrl-F5 有时可以解决问题，但我想我以前也见过这种方法不起作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-11-08T23:13:10.327

我也遇到了这个问题，甚至`<body onload="myform.reset()">`没有工作。这尤其是一个问题，因为无论好坏，我都使用隐藏输入作为计数器（例如，跟踪文件上传字段的动态数量）。这些显然需要在重新加载时重置，以防止出现不适用的警告消息。我出于内部目的“修复”了它，放弃了重置按钮以支持链接。而不是`<input type="reset"/>`我正在使用`<a href=".">Reset</a>`（文件名是 index.php）。远非优雅，但它适用于我的目的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-18T19:52:27.527

告诉用户按 CTRL+F5

-- 编辑如果你不能告诉用户[按下 CTRL+F5](https://stackoverflow.com/questions/385367/whats-the-difference-between-hit-f5-and-ctrl-f5-in-browser)（根据我的经验，除非浏览器有问题，或者除非出现*其他*问题，否则它总是有效的），只需在**onload**事件中**触发 form.reset()即可。**这会将表单中的字段清除为默认值。但是，如果您在字段中有默认值（例如 <input type="text" value="enter name here" />），那么当您触发 .reset() 时，它将重置为默认值。

 *** * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-01-27T07:10:13.767

我在 Rails 7 应用程序中遇到了这个问题。当导航到一个`form`一切都是空白的视图时，当我点击刷新时，所有输入都会被浏览器（而不是 Rails）填充。为了使输入保持空白，我使用了所有现代浏览器都支持的[autocomplete](https://developer.mozilla.org/en-US/docs/Web/Security/Securing_your_site/Turning_off_form_autocompletion)属性：

```
<!-- for the whole form -->
<form method="post" action="/form" autocomplete="off">

<!-- for a specific input element -->
<input type="text" id="foo" name="foo" autocomplete="off"> 
```**

# x11 - 如何知道哪个窗口有焦点以及如何改变它？

> ID：1014822
> 
> 赞同：15
> 
> 时间：2009-06-18T19:51:42.300
> 
> 标签：x11

我想知道如何询问 X11 哪些窗口有焦点。如果出于任何原因我自己的应用程序（可能可见或不可见）获得焦点，我希望能够让以前的窗口再次获得焦点。

例如，我的应用程序与许多其他应用程序一起运行（例如 firefox、gvim、nautilus、...）

假设一开始 Firefox 有焦点，并且用户点击了我现在拥有焦点的应用程序。我希望我的应用程序再次关注 Firefox。

有谁知道如何实现这一目标？书籍推荐会非常好。

非常感谢。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-06-19T13:36:06.380

看看`_NET_ACTIVE_WINDOW`大多数现代窗口管理器设置的根窗口的值：

```
xprop -root _NET_ACTIVE_WINDOW 
```

当然，这个值可以使用 Xlib 库调用来获得。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2015-03-06T02:47:59.167

你可能想`XGetInputFocus`打电话。

```
Window focused;
int revert_to;

XGetInputFocus(dpy, &focused, &revert_to); 
```

在这个片段中，`focused`将是具有当前输入焦点的窗口，获取键盘事件和鼠标按钮按下。

即使窗口管理器没有`_NET_ACTIVE_WINDOW`按照 EWMH 的规定在根窗口上设置属性，这也会起作用。一些窗口管理器，例如 dwm 和 my 9wm，没有设置这个。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2018-10-02T12:00:30.353

我推荐一个名为 XDoTool 的应用程序。它支持相当多的查询、控件甚至钩子。

```
> xdotool getwindowfocus               # 29360135
> xdotool getwindowfocus getwindowpid  # 12988
> xdotool getwindowfocus getwindowname # tilda
> xdotool getwindowfocus behave '%@' blur getmouselocation
#      or focus, mouse-enter, etc.
x:514 y:317 screen:0 window:56623121
x:271 y:26 screen:0 window:56623121
... 
```

接受回调之类的命令`behave`，可以是内置的，也可以是`getmouselocation`外部的`exec notify-send 'focused window'`，例如，`exec zsh myscript.zsh`等，但是您想使用它。

`xdotool windowfocus [options] [window]`编辑 - 您可以使用，如 中的焦点`xdotool search --class firefox windowfocus`。就我而言，这会导致错误，因为 Firefox 显示为几十个“窗口”，但都具有相同的 PID；给定正确的ID，它就可以工作。希望这是一个开始。

编辑 2 - 'window ID' 是窗口指针的十进制表示，例如来自[xprop](https://stackoverflow.com/a/1017988/1043529)：

```
> xprop -root _NET_ACTIVE_WINDOW
_NET_ACTIVE_WINDOW(WINDOW): window id # 0x1c00007, 0x0
> xdotool getwindowfocus
29360135
> printf '%d\n' '0x1c00007'
29360135 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-06-18T20:00:42.860

使用此**XQueryTree**查找当前活动的或最顶层的窗口。

这是一个函数，当给定一个显示时，它将找到当前窗口的焦点：

```
static Window
GetCurrWindow(d)
Display *d;
{
Window foo;
Window win;
int bar;

    do{
    (void) XQueryPointer(d, DefaultRootWindow(d), &foo, &win,
        &bar, &bar, &bar, &bar, &bar);
    } while(win <= 0);

#ifdef VROOT
    {
    int n;
    Window *wins;
    XWindowAttributes xwa;

    (void) fputs("=xwa=", stdout);

    /* do{  */
        XQueryTree(d, win, &foo, &foo, &wins, &n);
    /* } while(wins <= 0); */
    bar=0;
    while(--n >= 0) {
        XGetWindowAttributes(d, wins[n], &xwa);
        if( (xwa.width * xwa.height) > bar) {
        win = wins[n];
        bar = xwa.width * xwa.height;
        }
        n--;
    }
    XFree(wins);
    }
#endif
    return(win);
} 
```

[http://tronche.com/gui/x/xlib/window-information/XQueryTree.html](http://tronche.com/gui/x/xlib/window-information/XQueryTree.html)

我找到了来源：

[http://examples.oreilly.com/networksa/tools/xsnoop.c](http://examples.oreilly.com/networksa/tools/xsnoop.c)

**祝你好运**

# java - 如何在 netbeans 中获取 JList 以从模型中的向量中获取数据？

> ID：1014835
> 
> 赞同：1
> 
> 时间：2009-06-18T19:54:11.283
> 
> 标签：java, netbeans, jlist

我是一位经验丰富的 Java 用户，但我刚刚开始尝试使用 NetBeans 构建 GUI。以前我手动编写 GUI，但这是一个更大的项目。

无论如何，我的模型中有一个向量（MVC 设计），我想让列表填充我的向量中的元素。我知道如何手动执行此操作 - 我会像这样启动列表：

JList 列表 = 新 JList(model.getVector());

但问题是我无法编辑 netbeans 用于初始化组件的代码部分......所以我想知道如何使用 IDE 在启动时抓取这个向量......我假设它与编辑属性有关，但我看不到任何完全有希望的东西。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T20:14:23.223

阅读 mmyers 的建议；我用谷歌搜索“自定义创建代码”并弄清楚了-

我在设计视图中右键单击列表，单击“自定义代码”，在初始化部分，我将下拉框更改为“自定义创建”并手动编辑代码：P

# sql - DCount 与 SQL SELECT COUNT(*)？

> ID：1014839
> 
> 赞同：0
> 
> 时间：2009-06-18T19:54:51.953
> 
> 标签：sql, sql-server, vba, ms-access

我正在尝试根据分配给供应商的采购订单来计算发送给供应商的所有物品。但我似乎无法让控件根据采购订单实例显示许多项目 - 它不断抛出#name？或#错误！激活表单时文本框中的消息。

为 tblPODetail 创建语句

```
USE [instkeeper_test]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[tblPODetail](
    [intPurchaseOrderInstance] [int] IDENTITY(1,1) NOT NULL,
    [intPONumber] [int] NOT NULL,
    [datDateEntered] [datetime] NOT NULL,
    [bolPOOpen] [bit] NOT NULL,
    [intRMANumber] [nvarchar](255) NULL,
    [strSupplierCode] [nvarchar](50) NOT NULL,
    [strSupplierLastAddress] [nvarchar](50) NULL,
    [strSupplierLastCity] [nvarchar](50) NULL,
    [strSupplierLastState] [nvarchar](50) NULL,
    [strSupplierLastPostalCode] [nvarchar](50) NULL,
    [strSupplierLastCountry] [nvarchar](50) NULL,
    [strSupplierLastPhone] [nvarchar](50) NULL,
    [strSupplierLastFax] [nvarchar](50) NULL,
    [datDateSent] [datetime] NULL,
    [datDateReceived] [datetime] NULL,
    [bolAdvGageTrakNoTouch] [bit] NOT NULL,
    [bolAdvHardCopies] [bit] NOT NULL,
    [bolFreightShip] [bit] NOT NULL,
    [bolReturnableUsed] [bit] NOT NULL,
    [bolInHouse] [bit] NOT NULL,
    [strUPSTrackNumOut] [nvarchar](255) NULL,
    [strFedExTrackNumOut] [nvarchar](255) NULL,
    [strFreightTrackNumOut] [nvarchar](255) NULL,
    [strUPSTrackNumIn] [nvarchar](255) NULL,
    [strFedExTrackNumIn] [nvarchar](255) NULL,
    [strFreightTrackNumIn] [nvarchar](255) NULL,
    [SSMA_TimeStamp] [timestamp] NOT NULL
) ON [PRIMARY]

GO

ALTER TABLE [dbo].[tblPODetail]  WITH CHECK ADD  CONSTRAINT [SSMA_CC$tblPODetail$strSupplierCode$disallow_zero_length] CHECK  ((len([strSupplierCode])>(0)))
GO

ALTER TABLE [dbo].[tblPODetail] CHECK CONSTRAINT [SSMA_CC$tblPODetail$strSupplierCode$disallow_zero_length]
GO

ALTER TABLE [dbo].[tblPODetail] ADD  CONSTRAINT [DF__tblPODeta__intPO__6C190EBB]  DEFAULT ((0)) FOR [intPONumber]
GO

ALTER TABLE [dbo].[tblPODetail] ADD  CONSTRAINT [DF__tblPODeta__datDa__6D0D32F4]  DEFAULT (getdate()) FOR [datDateEntered]
GO

ALTER TABLE [dbo].[tblPODetail] ADD  CONSTRAINT [DF__tblPODeta__bolPO__6E01572D]  DEFAULT ((1)) FOR [bolPOOpen]
GO

ALTER TABLE [dbo].[tblPODetail] ADD  CONSTRAINT [DF__tblPODeta__bolAd__6EF57B66]  DEFAULT ((1)) FOR [bolAdvGageTrakNoTouch]
GO

ALTER TABLE [dbo].[tblPODetail] ADD  CONSTRAINT [DF__tblPODeta__bolAd__6FE99F9F]  DEFAULT ((1)) FOR [bolAdvHardCopies]
GO

ALTER TABLE [dbo].[tblPODetail] ADD  CONSTRAINT [DF__tblPODeta__bolFr__70DDC3D8]  DEFAULT ((0)) FOR [bolFreightShip]
GO

ALTER TABLE [dbo].[tblPODetail] ADD  CONSTRAINT [DF__tblPODeta__bolRe__71D1E811]  DEFAULT ((0)) FOR [bolReturnableUsed]
GO

ALTER TABLE [dbo].[tblPODetail] ADD  CONSTRAINT [DF__tblPODeta__bolIn__72C60C4A]  DEFAULT ((0)) FOR [bolInHouse]
GO 
```

为 tblPOGaugeDetail 创建语句

```
USE [instkeeper_test]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[tblPOGaugeDetail](
    [intItemPOID] [int] IDENTITY(1,1) NOT NULL,
    [intGagePOID] [int] NOT NULL,
    [strGageDetailID] [nvarchar](50) NULL,
    [datGageSent] [datetime] NULL,
    [datGageReceived] [datetime] NULL,
    [bolGageCalibrate] [bit] NOT NULL,
    [bolGageRepair] [bit] NOT NULL,
    [bolGageEvaluate] [bit] NOT NULL,
    [bolGageAccredited] [bit] NOT NULL,
    [bolGageReturned] [bit] NOT NULL,
    [bolGageException] [bit] NOT NULL,
    [bolGageExceptResolved] [bit] NOT NULL,
    [bolGageLeavePriceBlank] [bit] NOT NULL,
    [intGageCost] [real] NULL,
    [intTurnaroundDaysOut] [int] NULL,
    [SSMA_TimeStamp] [timestamp] NOT NULL,
 CONSTRAINT [tblPOGaugeDetail$PrimaryKey] PRIMARY KEY CLUSTERED 
(
    [intItemPOID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

ALTER TABLE [dbo].[tblPOGaugeDetail]  WITH CHECK ADD  CONSTRAINT [tblPOGaugeDetail$tblPODetailtblPOGaugeDetail] FOREIGN KEY([intGagePOID])
REFERENCES [dbo].[tblPODetail] ([intPurchaseOrderInstance])
ON UPDATE CASCADE
GO

ALTER TABLE [dbo].[tblPOGaugeDetail] CHECK CONSTRAINT [tblPOGaugeDetail$tblPODetailtblPOGaugeDetail]
GO

ALTER TABLE [dbo].[tblPOGaugeDetail] ADD  DEFAULT ((0)) FOR [intGagePOID]
GO

ALTER TABLE [dbo].[tblPOGaugeDetail] ADD  DEFAULT ((1)) FOR [bolGageCalibrate]
GO

ALTER TABLE [dbo].[tblPOGaugeDetail] ADD  DEFAULT ((0)) FOR [bolGageRepair]
GO

ALTER TABLE [dbo].[tblPOGaugeDetail] ADD  DEFAULT ((0)) FOR [bolGageEvaluate]
GO

ALTER TABLE [dbo].[tblPOGaugeDetail] ADD  DEFAULT ((0)) FOR [bolGageAccredited]
GO

ALTER TABLE [dbo].[tblPOGaugeDetail] ADD  DEFAULT ((0)) FOR [bolGageReturned]
GO

ALTER TABLE [dbo].[tblPOGaugeDetail] ADD  DEFAULT ((0)) FOR [bolGageException]
GO

ALTER TABLE [dbo].[tblPOGaugeDetail] ADD  DEFAULT ((0)) FOR [bolGageExceptResolved]
GO

ALTER TABLE [dbo].[tblPOGaugeDetail] ADD  DEFAULT ((0)) FOR [bolGageLeavePriceBlank]
GO

ALTER TABLE [dbo].[tblPOGaugeDetail] ADD  DEFAULT ((0)) FOR [intGageCost]
GO

ALTER TABLE [dbo].[tblPOGaugeDetail] ADD  DEFAULT ((0)) FOR [intTurnaroundDaysOut]
GO 
```

我希望计数出现在其中的采购订单详细信息的查询语句

```
SELECT dbo_tblPODetail.intPurchaseOrderInstance, dbo_tblPODetail.strSupplierCode, dbo_tblPODetail.bolPOOpen, dbo_tblPODetail.intPONumber, dbo_tblPODetail.datDateSent
FROM dbo_tblPODetail
WHERE (((dbo_tblPODetail.bolPOOpen)=True))
ORDER BY dbo_tblPODetail.datDateSent; 
```

当我读了一些关于 DCount() 和 SELECT COUNT(*) 的内容时，我有点沮丧，但似乎无法让它们中的任何一个工作。任何帮助将不胜感激！提前致谢！

-- 2009 年 6 月 18 日编辑 @ 1542 小时 --

这是当子窗体的 On Current 事件触发时我尝试在代码中使用的 SELECT COUNT 示例：

```
SELECT COUNT(*) AS ItemsSent 
FROM [dbo_tblPOGaugeDetail] 
WHERE [dbo_tblPOGageDetail]![intGagePOID] = [dbo_tblPODetail]![intPurchaseOrderInstance] 
```

这是附加到子窗体中的控件的 =DCOUNT 语句的示例。

```
=DCOUNT("*", "[dbo_tblPOGaugeDetail]", "[intGagePOID] = [Forms]![frmSupplierInfoMain]![subfrmOpenPOBySupplierID]![intPurchaseOrderInstance]") 
```

这些都不起作用 - 可悲的是。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T21:03:15.963

您的查询在没有计数（*）的情况下是否有效？

对 DCount 的第一个参数使用实际的字段名称从 where 字符串中获取控件名称。

```
For DCOUNT("[intItemPOID],"[dbo_tblPOGaugeDetail]","[intGagePOID]=" & Forms]![frmSupplierInfoMain]![subfrmOpenPOBySupplierID]![intPurchaseOrderInstance]) 
```

# c# - 当我清除以前分配给它的列表时清除 C# 字典值....为什么？

> ID：1014849
> 
> 赞同：2
> 
> 时间：2009-06-18T19:57:09.280
> 
> 标签：c#, dictionary

```
Dictionary <string, List <SaleItem>> saleItemNew = new Dictionary<string, List<    SaleItem>> ();

saleItems = new List <SaleItem> ();

saleItemNew.Add("1", saleItems); 
```

**此时字典中的列表具有值。**

```
saleItems.Clear(); 
```

**但是，当我清除之前分配给它的列表时，字典的值 List 现在是空的……为什么？**

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-18T20:01:05.870

字典包含对列表的相同引用，因此修改列表将更改两个引用。

有关引用类型的 Microsoft 文档：http: [//msdn.microsoft.com/en-us/library/490f96s2.aspx](http://msdn.microsoft.com/en-us/library/490f96s2.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T20:00:48.227

原因是 Dictionary 是一个引用而不是一个值类型。当您将 Dictionary 分配给另一个变量时，它不会执行深层复制。相反，它只是将另一个引用指向同一个对象。由于只有一个对象，因此通过任一引用清除对两个引用都是可见的。

这与 .Net Framework 中的值类型形成对比。值类型的赋值本质上是执行数据的浅拷贝并创建两个独立的对象。注意，如果值类型有一个引用字段，那么两个值类型中的两个字段仍然会指向同一个对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T20:11:58.297

它与内存使用和指针有关。在为对象分配内存时，您有一个堆栈和一个堆，该内存就是堆之一。您的 saleItems 变量在堆栈上定义并指向堆上的内存地址。您的字典也在指向堆的堆栈上。

当你说：

```
saleItems = new List<SaleItem>() 
```

变量 saleItems 被压入堆栈并包含指向堆上数据位置的内存地址。让我们说`0x0100`。现在您`DictionaryItem`向字典中添加一个新的。`DictionaryItem`放置在具有两个属性 Key 和 Value 的堆上。在这种情况下，您添加了`saleItems`as `Value`，`Value`地址也添加了`0x0100`。现在`DictionaryItem.Value`指向与 saleItems 相同的内存。当您调用 saleItems.Clear 时，您说的是在地址处查找列表`0x0100`并删除所有项目。所以字典和变量都是空的，因为它们指向同一个内存。你要做的就是再说`saleItems = new List<SaleItem>();`一遍。现在 saleItems 将指向堆上的一个新地址（比如`0x0200`）。 `DictionaryItem.Value`仍然指向内存地址`0x0100`，因此您可以对`saleItems`变量进行操作而不会影响字典中的数据。

有关 c# 中堆栈和堆的更多信息，请尝试这篇文章：[http ://www.c-sharpcorner.com/UploadFile/rmcochran/csharp_memory01122006130034PM/csharp_memory.aspx?ArticleID=9adb0e3c-b3f6-40b5-98b5-413b6d348b91](http://www.c-sharpcorner.com/UploadFile/rmcochran/csharp_memory01122006130034PM/csharp_memory.aspx?ArticleID=9adb0e3c-b3f6-40b5-98b5-413b6d348b91)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-18T20:33:51.453

将列表添加到字典中只是一个浅拷贝......不会创建和添加具有相同值的新列表（深拷贝）；而是添加了对旧列表的引用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-19T13:43:07.520

它使用相同的参考。

一个更好的方法是

```
Dictionary <string, List <SaleItem>> saleItemNew = new Dictionary<string, List<SaleItem>>();
saleItemNew.Add("1", new List<SaleItem>()); 
```

并用于清算

```
saleItemNew["1"] = new List<SaleItem>(); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-07-06T18:14:45.227

因为它是一个引用类型，所以只复制指向内存中值的指针，而不是值本身。您可以使用构造函数指定所需的行为：

From dot net perls: // // 将字典复制到第二个对象。// 字典副本 = new Dictionary(dictionary);

# c# - C#：公共新字符串 ToS tring() VS 公共覆盖字符串 ToS tring()

> ID：1014853
> 
> 赞同：21
> 
> 时间：2009-06-18T19:57:58.530
> 
> 标签：c#, oop

我想在我的一个类中重新定义 ToString() 函数。

我写

```
public string ToString() 
```

......它工作正常。但是 ReSharper 告诉我将其更改为

```
public new string ToString() 
```

或者

```
public override string ToString() 
```

有什么不同？为什么 C# 需要这样的东西？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-06-18T20:01:19.833

如果您使用`public string ToString()`它，则不清楚您**打算**做什么。如果你的意思是通过多态改变行为`ToString`，那么`override`. 您**可以**添加一个`new ToString()`，但这很愚蠢。不要那样做！

不同之处在于您这样做时会发生什么：

```
MyType t = new MyType();
object o = t;
Console.WriteLine(t.ToString());
Console.WriteLine(o.ToString()); 
```

如果你`override`，两者都会输出你的新版本。如果你`new`，只有第一个会使用你的新版本；第二个将使用原始实现。

我认为我**从未见过**有人`new`在`ToString()`.

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-06-18T19:59:39.727

问题是 ToString 是一个虚方法。为了覆盖 C# 中的虚拟方法，您需要指定 override 关键字。

您几乎可以肯定不想要“新”版本。.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-18T20:04:34.723

[new 修饰符](http://msdn.microsoft.com/en-us/library/51y09td4(VS.71).aspx#vclrfnew_newmodifier)将隐藏或“隐藏”基类中具有相同签名的成员，因为[覆盖](http://msdn.microsoft.com/en-us/library/ebca9ah3(VS.71).aspx)提供了从基类继承的成员的新实现。这是一篇关于阴影和覆盖之间差异的[好文章。](http://msdn.microsoft.com/en-us/library/ms172785.aspx)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-18T20:00:48.430

你想覆盖。隐藏在您的案例中（使用“新”）确实没有任何优势。

这是一篇关于[覆盖和隐藏之间差异](http://www.akadia.com/services/dotnet_polymorphism.html)的文章。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-18T20:01:14.780

C# 不需要它；Resharper 可以。它需要它，因为这两个关键字代表明显不同的行为，如果您不指定，阅读您的代码的人可能不完全清楚默认行为是什么（它是`new`.）

在这种情况下，您显然想要覆盖。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-01-30T06:34:12.350

ToString 是基类中的虚方法。要使当前成员覆盖该实现，请添加 override 关键字。否则添加新关键字。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-18T20:03:16.960

你所做的一切都取决于你想要的行为。[本文](http://msdn.microsoft.com/en-us/library/aa302308.aspx#drguinet2_update_topic4)解释了 ToString 的行为是如何工作的，具体取决于您定义方法的方式以及您调用 ToString 的类层次结构中的哪个级别。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-18T20:10:45.603

我个人的建议是不要使用隐藏；它会导致许多歧义并解决一些问题。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-09-21T10:59:15.890

**ToString() 方法可用于 .NET 中的每种类型**，因为此方法在 System.Object 基类中定义为虚拟方法，并且所有类型都直接或间接继承自 System.Object。如果 ToString() 方法的默认实现不能满足您的目的，您可能希望覆盖（使用 override 关键字）或隐藏（使用 new 关键字）它。

我遇到了以下 2 篇优秀的文章，解释了重写 ToString() 方法的原因，以及方法隐藏和方法重写之间的区别。还有一个关于相同概念的 youtube 视频
[覆盖 ToString() 的原因](http://csharp-video-tutorials.blogspot.com/2012/07/part-57-c-tutorial-why-should-you.html)
[方法隐藏和方法覆盖之间的区别](http://csharp-video-tutorials.blogspot.com/2012/06/part-24-c-tutorial-difference-between.html)

# jquery - jQuery AutoComplete 使用两个数据集？

> ID：1014856
> 
> 赞同：0
> 
> 时间：2009-06-18T19:58:21.523
> 
> 标签：jquery

我最近一直在为我的 Web 应用程序使用 jQuery 进行轻量级 DOM 操作，并且效果很好。我现在被要求为用户必须填写的数据字段添加自动完成功能。该字段中的数据来自非常有限的一组数据，但用户可以输入完整格式的数据，例如产品名称和代码格式，例如文章 ID。例如，“Panasonic DVD Player”和 PAN-DV-24 是等价的。

数据集真的很小，可能有 300 行，所以我考虑使用 jQuery 实现自动完成，从定义了完整格式和代码格式的一组数据中进行搜索。我环顾四周，关于 jQuery 的自动完成插件的状态似乎存在很多不确定性，我不确定您将如何实现将两列数据视为“同义词”的自动完成。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-18T20:09:29.910

数据问题应该在您的服务层之后。您通过 jquery 将查询词传递给您的 Web 服务。Web 服务搜索您的两个或三个或四个数据列表并返回一个适当术语的列表。但是关于如何实现搜索的逻辑应该对客户端隐藏！从那里您可以使用 DHTML 显示找到的单词列表。

# language-agnostic - 为爱好项目编写规范是完成它们的唯一途径吗？

> ID：1014858
> 
> 赞同：43
> 
> 时间：2009-06-18T19:58:51.100
> 
> 标签：language-agnostic, specifications

这就是我想知道的。每天晚上，当我们 3 个月大的宝宝让我们睡觉时，我都会跳到电脑前，开始编写我的爱好项目。我正在从事大约 20 个不同的项目：不同类型的项目，从 C++ 游戏到 Web 应用程序以及对开源项目的一些贡献。这确实是一种激情，并且已经持续了很多年。

然而，当我回头看时，我发现我还没有完全完成我的一个爱好项目。我一直都在做原型并设置最重要的功能，但随着时间的推移，我最终没有完成我的项目，而是切换到另一个目前看起来“更酷”的项目。因此，我通常会得到没有结局和故事的错误和不完整的游戏，拥有有史以来最快的 PolygonDraw 例程的 3D 引擎，但缺乏实现其他任何东西，等等......这个列表很长。我想我一定已经写了一百多次不同的未完成的乒乓球！

**有人告诉我，补救办法是为我的爱好项目编写规范。**

一方面，我在工作中写了很多规范。我知道它们对于定义产品的路线图和按时完成是多么重要。另一方面，规格和爱好项目似乎完全不符合！在我看来，构建游戏的学习曲线实际上是让它变得有趣的原因。不是游戏本身。因此，浪费时间重组整个引擎的乐趣，创造最无用功能的乐趣，等等......

那么问题来了：你有没有为你的爱好项目写过规范？他们与工作中的人有何不同？你是如何完成你的爱好项目的？

当我在做我的新项目时，我很高兴知道：钢琴奏鸣曲发生器 :)

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-06-18T20:07:00.570

我不认为编写规范是解决您问题的方法。显然，你的“爱好项目”是你觉得有趣的事情。您编写有趣的部分，然后避免完成某些事情所必需的不有趣的部分。

如果你只是“为了好玩而编程”，那很好，你就成功了。我不认为编写规范很有趣。

如果你真的想“完成”某件事，最好的方法不是写规范，而是当有趣因素下降时不要跳到另一个项目。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-06-18T20:05:01.120

这完全是关于“自我项目管理”......即使是为了好玩。

我对你有感觉……我曾经有很多回购协议都倾向于卡在 200 左右的修订版上。

这是过去发生的事情，因为我没有做足够的计划，在大约 200 次提交之后，事情变得一团糟，需要重写……然后兴趣就消失了，因为这似乎太麻烦了。

我学会了编写自己的规格供个人使用

至

1.  让我专注于完成工作，而不是进入功能蠕变通道
2.  提醒我正在努力的方向
3.  在我开始编码之前有好的想法
4.  让事情更有趣更长时间

**对我来说，编写自己的规范对于完成任何事情都至关重要！**

没有计划就不会创业吧？

对于个人项目，我有大量的 moleskine 书籍，里面充满了粗略的规格和想法。当它们成熟时，它们会从笔记本迁移到真实的文档中，然后开始编码。

**大编辑**：为了提高个人效率并完成项目。我读过*“把事情做好”* ……尽管关于“心理”和不同层次的思想（我确信这不是基于任何科学）的所有嬉皮士废话，但这些技巧非常好。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-06-18T20:05:12.273

我不会太复杂，但列出您希望包含在应用程序中的所有功能和要求确实会有所帮助。与大多数爱好项目一样，您通常不只是坐下来直接编写代码 2 个月并完成它们。这里是一个小时，那里是两个小时，等等。基本上，忘记你最后在做什么以及这个应用程序的超级好主意的最初目的是什么是很常见的。

如果您花几个小时写下规格和要求，那么这对您在 6 个月后获得一些空闲时间或您的 ADD 切换到该项目并尝试记住它应该做什么时将非常有价值。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-06-18T20:11:01.747

我最近才发现，编写规范确实是我完成项目所需要的。

我有点像你，有很多项目，从一个跳到另一个，从来没有完成过。直到大约 6 个月前，当我开始实际编写规范并为我的项目制定路线图时。

我只能说，它确实有效，因为您将项目分成更小的步骤，就像与检查点的比赛一样，当您开始将检查点标记为完成时，感觉很好，令人上瘾，您的注意力将集中在终点线。

这样，您只能同时保留 1 或 2 个项目，但实际上完成了它们。当然，即使您大约一个月或更长时间不碰它，您也可以获得额外且非常有价值的奖励来跟上该项目。规范将始终提醒您项目的目标和目的。

这只是我的个人经验，我相信你应该试一试。希望它也能为你锻炼。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-06-18T20:17:27.397

我已经能够做一些爱好项目并完成其中一些。我试图完成所有这些，但有些我无法召集。

我认为的原因是完成一个项目所需的细节太多，以至于它从一个热情的项目变成了一个杂务。

帮助我完成大部分工作的是，他们一直保持热情，直到最后的润色结束。所以我只是穿过它们。

规范会有所帮助吗，在某种程度上是的。他们让你更深入地了解项目，但几乎总是会有激情消退的时候，你会寻找下一个闪亮的对象。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-06-18T20:37:26.360

它对我不起作用！事实上，每当我编写规范时，我通常都会让项目变得更大，并且不太可能完成。

有时最好的方法就是去做。

泽弗兰克对此的解释比我好得多： [http](http://www.zefrank.com/theshow/archives/2006/07/071106.html) ://www.zefrank.com/theshow/archives/2006/07/071106.html （带有脏话的视频链接）

编辑：只是补充。如果你发现你想离开你半成品的项目去寻找一个新的、伟大的想法......去做吧！不要回头！

完成不是您自己的宠物项目的要求。**没有人会责怪你没有完成几乎没有人会费心开始的事情。**

你开始的原因是因为热情。这是非常重要的。你不应该强迫自己在空闲时间“坚持到底”。你会耗尽你的激情，这是你最重要的资源。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-06-18T21:18:38.773

你*想*完成它们吗？

我认为永远不会完成一个爱好项目是合理的。只要你活着，你就可以继续努力。Aciddose 多年来一直在研究他的虚拟乐器[xhip](http://www.kvraudio.com/get/1427.html) ，但一直没有达到 1.0，这使得人们编写的乐器补丁从一个版本到下一个版本都毫无价值。然而，他和他的软合成器的用户似乎玩得很开心。

也许如果你只瞄准“发布”而不是“完成”，你会更满意。Beta让你继续梦想。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-06-18T21:10:17.743

我所发现的帮助完成的最好的事情就是让其他人与您一起完成该项目。找一个（或两个）对相同事物感兴趣的朋友并与他们一起设计/编码。你不仅有人可以提出想法，而且还有人可以激励你，更不用说进步速度是两倍，所以你希望在放弃之前完成:)

当然，它需要源代码控制，但您已经在项目中使用它，对吧？:)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-06-18T20:06:11.837

我通常在开始时编写第一组规范。

我也是纸质思维的忠实粉丝，所以我会画屏幕、UML、图表、流程图、设计元素……这只是定义你的项目范围并能够看到你所拥有的东西的问题头脑。它真的帮助我思考。

这些文件将是我对整个项目的规范。我会在我去的时候添加其他的，但我并没有像我希望的那样去维护旧的，这是一个工作项目：我知道我要去哪里，我可以跟踪我的变化代码。

当然，我的一些爱好项目是合作完成的。在这些情况下，我会写下更多规范，以便与我的团队进行更好的沟通，并尝试使数据库图等文档保持最新。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-06-18T20:06:56.467

我还有几个爱好项目还没有完成。我有大约 10 个，并且已经为其中一个编写了规范，范围最大（也是一个游戏）。

我还没有完成没有规格的，也没有完成的。我认为这是因为我从不发布作品或向任何人展示它，所以它仍然充满错误并且从未“完成”。

我想这意味着不管你有没有规范，它不会像其他因素那样影响项目的成功，比如有时间、有动力、有帮助和有信心。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-06-18T20:04:36.160

是和不是。我一边思考一边在笔记本上写笔记，并在实施时添加笔记。这与其他人可能必须查看规范的工作项目有些不同。

我完成了大约一半的开始。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-06-18T20:39:44.530

我帮助开发了一系列系统，从安全关键的航空电子设备到像数独求解器这样的一次性个人项目。显然，对于航空电子系统，规范对于系统的安全运行和防止杀人至关重要，但我从不为我的个人项目而烦恼。

我认为这是因为规范通常读起来很无聊。Joel 写了一篇关于这个的有趣文章，以及如果你写它们如何让它们变得更好：

[无痛功能规格](http://www.joelonsoftware.com/articles/fog0000000036.html)

不幸的是，我还没有勇气尝试让我的规范在工作中阅读起来更有趣。

也许除了编写规范之外，您应该尝试为其他人或与其他人一起做一些项目？这可以提供一些外部动力。我为表弟在剧院里开车做一些网络开发，如果他们需要一个功能，他们会在我完成之前不停地询问我。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-06-18T20:47:07.633

我能给你的最大的一条建议就是拿出一些东西——让你的第一个版本的规范足够小，以至于你真的觉得你可以完成它，即使它几乎没有你想要的所有功能。

一旦你得到了一些东西，来自你的软件用户的压力将足以让你继续坚持下去。它还确保您在开发中采用的方向与您的用户希望您走的方向相同。

如果您实际上没有获得任何用户，那么放弃该项目也不要太难过——如果没有人感兴趣，那么它可能不值得追求。

如果来自用户的压力不足以让你保持专注，那就开源吧。如果对它有足够的兴趣，其他人会从你停下来的地方继续它，你可以自由地继续做更大更好的事情。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-06-18T20:21:14.643

Short answer: developing specifications for a hobby project is neither necessary nor sufficient to guarantee completion.

That being said...

I keep an engineering notebook for all of my personal projects. I use the notebook to capture all sorts of things about the projects on which I work. This includes project motivation, valuable resources leveraged during the project, things developed over the course of the project that might potentially be reused later, key insights gained, etc. etc. It also includes, more to your question, specifications for most of the projects. I employ an [agile/lean approach](http://www.agilemodeling.com/) to creating these specifications which, for me, is compelling from a cost/benefit perspective.

btw...I have many, many personal projects that did not culminate in a complete working system. Some of these I might get around to completing 'someday maybe'. I consciously chose to stop working on some of the others because they had served their purpose (e.g. introduced me to a new technology, helped me better understand a language feature, etc.) Continuing to crank away at projects like these would have led to diminishing returns so I chose to reallocate my time to projects I felt were higher leverage.

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-06-18T20:31:13.983

Unfortunately, after writing specs for the core of the DIFL engine (don't bother looking it up, as there's no trace of it outside my home systems), I still didn't finish it up.

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-06-18T22:38:36.707

我不确定编写规范是否可以解决您的问题（或我的问题似乎相似），但是在我想做的不仅仅是一次性实验的情况下，有一些事情可以稍微帮助我而不会带来乐趣其中。

规格确实非常严格，应该是技术性的，但对于一种爱好方法，你可以写一些类似的更宽松的东西，概述你想要展示的一些东西，并展示它们如何在某种设计草案中组合在一起. 尽管不像适当的规范那样详细或限制性强，但它可能有助于使修补工作朝着正确的方向发展。

其次，您可以将其分解并根据您的时间余量添加一些目标。如果您专注于构建项目的一部分，将其分解为最终可以链接在一起的子项目，它给人一种感觉当你从一个部分移动到另一个部分时取得进步，而不是感觉你多年来一直在做同样的事情并且不能再被打扰了。如果您在清单上勾选它，它就会起作用，因为通常它至少必须在精神上发生。

这么说，如果您的目标是玩某些概念而不是实际创建最终产品，那么您可能不会这样做，因为您没有朝着它努力。一种方法可能是采用上述想法，将其分解，然后找到一种方法，在每个让您感到厌烦的部分中添加一些个人有趣的东西，也许尝试在其中添加挑战之类的东西。

我仍然没有特别的学习经验，但这就是我保持修补的方式（有时除非我因缺乏经验而完全陷入困境），以及在过去几年中，我如何以业余爱好接触许多多媒体和网络项目。虽然当你感到无聊时说开源它并让其他人接受它的人，但如果你想看到你的代码被使用但满足你的个人目标，那是一个好主意。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2013-04-15T16:01:46.663

Joel 关于[基于证据的调度](http://www.joelonsoftware.com/items/2007/10/26.html)的文章对我有用。虽然我以不同的方式实现它。

这个想法是将项目分解为小任务并给出估计，然后根据完成的任务完成它们所花费的时间来预测你的项目何时完成。

您可能认为您的项目需要数年才能完成，但实际上估计只需两个月或更短的时间。如果您工作更多并快速完成任务，您会看到完成日期提前。

我认为最能激励你前进的事情就是看到你跑向的目标越来越近。

另外：创造一些你以后会用到的东西。使用东西可以激励你以后改进它。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-06-18T21:29:15.943

真正的问题是：你的爱好是什么？是完成一个项目，还是修修补补。如果最后十码是一件苦差事，你必须决定这对你来说是否值得。编写详细的规格将起作用；如果你喜欢这种自律，那么自责也会如此。如果它不利于你的化妆，没有什么能让事情变得容易，所以你必须决定最终目标对你来说是否值得。

而且，只是为了证明这一点与编程无关，您可能真的很喜欢[这个人](http://www.wired.com/wired/archive/14.07/genius.html)。他作品中的一个要点是，毕加索和达芬奇等概念艺术家从不真正关心最终的执行——想法就是一切，而且，在断言它之后，他们奇怪地满足于其他人完成实际工作或留下未完成和未发表的草图。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-06-19T00:37:36.203

我有很多同样的问题。我注意到的一件事有帮助，就是降低了我的野心。像WAY WAY一样低。如果您对规范有某种限制规则，例如“规范只能是一页”，或者“规范不能超过 300 字”，那么编写规范是实现抱负的一种方式，或者“只指定我可以在一天的编码中完成的事情”。保持平衡可能需要一些练习。如果您使用最后一个限制，如果您无法在一天内完成，您可以强制执行该项目的强制解雇规则。

这样做的好处是，它将您限制在可实现的目标上。起初这听起来可能很愚蠢或错误。又或许这听起来很合理，但你就是忍不住，你想做惊人的事情，而不是平凡的事情！不小的事情，你只能在几个小时内完成！

但请记住这一点：

> “一个有效的复杂系统总是被发现是从一个有效的简单系统演变而来的。相反的命题似乎也是正确的：从零开始设计的复杂系统永远不会工作，也不能让它工作。你必须重新开始，从一个工作简单的系统开始。”</p>

——约翰·加尔

如果您已经有一个 FINISHED 和 WORKING 项目可以作为它的基础，那么制作这个雄心勃勃的项目会容易得多。那么“更复杂的事情”可以是一个适合一天的项目。这是我正在努力的理想和理念，因为我认为它最有可能成功。回顾过去成功的项目，无论是有意还是无意，绝大多数都是以这种方式发展的。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-07-23T16:48:16.297

我的大多数爱好项目也没有真正完成。只要我在做某事并学习，尽管我认为那不是问题。目前我没有写规范，但我正在练习/培训 TDD。我在编写规范的测试时提出了它。有时我会坐下来创建一堆测试，概述软件应该做什么。有时我会让这些测试通过。令人愉快的是，我不必将所有代码都记在脑海中，并且在任何时候我都可以坐下来通过修复损坏的测试来取得进一步的进展。一切正常，有点超现实。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2009-06-24T10:21:15.117

在工作、大学和业余时间，我不断为我的项目编写规范。程序员最大的弱点是他/她的记忆力，所以我发现通过将我的每一个想法写成某种结构化文档来让自己在思考时间保持忙碌是件好事。在不知不觉中，您已经编写了完整的数据库模式或拥有需求规范。

目前，我正在努力提高我的 SQL 技能，并且在写下我的经验的查询之间花费了很多空闲时间。经过几次调整后，我得到了一份体面的文件，概述了需要做的事情。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2009-06-30T11:38:37.513

我认为核心问题不是缺乏规范，而是完成某件事（任何事情）都**很难**。

这是一项艰苦的**工作**。看起来你的程序已经完成了 90%。但是完成最后 10%（消除所有错误、让应用程序发布质量、编写文档等）需要与前 90% 一样多的工作。如果你想认真地营销你的程序，回复支持电子邮件，修复其他人的错误，那还有更多的工作。也许不是你最感兴趣的工作。

**精神上**也很辛苦。未完成的项目具有无限的潜力。这是一块空白的画布，你可以在其中投射出你肆无忌惮的野心、崇高的理想和革命思想。一旦它完成并成为现实，你必须看看它是什么。有限的。有缺陷的。从来没有像产生它的想法那样漂亮。

也就是说，完成某事也可以是非常有益的。你学到很多东西，对你的想法进行现实检查，完成某件事的满足感，你可以看到其他人对你的工作的看法。

一些忠告：

*   确保你**真的想要**完成这个项目。即，奖励是值得所有辛勤工作的。（如果不是，那么接受这个事实并保持一个快乐的修补匠。）

*   通过“无聊”的部分找到激励自己的方法。规格，也许，如果它让你专注。但是找到适合你的东西，无论是待办事项的滴答声、用饼干犒赏自己还是梦想成名和财富。

*   **尽早发布，经常发布。**您为“大版本”保存的越多，该版本永远不会发生的机会就越大。

*   **先发布，再重写。**当您有进行重大重写的冲动时，请先发布，然后再进行重写（如果您仍然准备好的话）。软件从来都不是完美的。如果您在没有任何压力发布半生不熟（但现有）的代码的情况下力求完美，那么您将永远不会完成。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2009-06-19T09:52:17.940

对我有很大帮助的是将新功能拆分为小任务，每个小任务都可以在晚上的黑客会议中完成。因此，如果我有时间，我只需从列表中选择一项任务并完成它。这通常足以“融入其中”并“再做一次”。

我一次只为一个功能这样做，这样我就不会被我可以添加到我的应用程序中的所有其他很酷的东西分散注意力。

# c++ - Stroustrup 天鹅书矢量问题

> ID：1014860
> 
> 赞同：1
> 
> 时间：2009-06-18T19:59:30.150
> 
> 标签：c++, vector

我正在使用 Stroustrup 的天鹅书。我遇到了从向量获取输出的问题。我按照 sec 中的文本示例进行操作。第 121 页的 4.6.3。我设法编译了源代码并能够执行它。在键入空格分隔的单词列表后，程序挂起并且没有按应有的方式列出向量的元素。我意识到如果重复，并不是每个元素都会被输出，但我根本没有收到任何输出。我在 Linux 上使用 g++ 4.3.2 编译器并在 Windows 上使用 Visual C++ express 2008 编译器编译并运行了它。两者都产生相同的结果。感谢您花时间阅读本文。这是我的来源：

```
#include "Supporting_files/std_lib_facilities.h"

    int main()
            {
        vector<string> words;
        string temp;
        cout << "Enter a list of words: ";
        while(cin>>temp)
            words.push_back(temp);
            cout << "Number of words: " << words.size() << endl;
            sort(words.begin(),words.end());
            for(int i=0;i<words.size();++i)
                if(i==0||words[i-1]!=words[i])
                    cout << words[i] << "\n";
            } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-18T20:05:14.473

while(cin>>temp) 仅在到达文件末尾时才结束。使用 control-D 将文件结尾发送到终端。

# css - 有 CSS 父选择器吗？

> ID：1014861
> 
> 赞同：3724
> 
> 时间：2009-06-18T19:59:36.653
> 
> 标签：css, css-selectors

如何选择`<li>`作为锚元素的直接父元素的元素？

例如，我的 CSS 是这样的：

```
li < a.active {
    property: value;
} 
```

显然有一些使用 JavaScript 的方法，但我希望有某种解决方法存在于 CSS Level 2 中。

我试图设置样式的菜单被 CMS 吐出，所以我无法将活动元素移动到`<li>`元素......（除非我为菜单创建模块设置主题，我不想这样做）。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3027
> 
> 时间：2009-06-18T20:16:50.707

目前没有办法在 CSS 中选择元素的父级。

如果有办法做到这一点，它将在当前的 CSS 选择器规范中：

*   [选择器 3 级规范](https://www.w3.org/TR/css3-selectors/#selectors)
*   [CSS 2.1 选择器规范](https://www.w3.org/TR/CSS2/selector.html#pattern-matching)

也就是说，[Selectors Level 4 Working Draft](https://dev.w3.org/csswg/selectors4/#relational)包括一个`:has()`伪类，可以提供这种能力。它将类似于[jQuery 实现](https://api.jquery.com/has-selector/)。

```
li:has(> a.active) { /* styles to apply to the li tag */ } 
```

但是，截至 2021 年，**[任何浏览器仍然不支持此功能](https://caniuse.com/#feat=css-has)**。

同时，如果您需要选择父元素，则必须使用 JavaScript。

* * *

## 回答 #2

> 赞同：265
> 
> 时间：2018-01-20T20:22:01.953

是的：[`:has()`](https://developer.mozilla.org/docs/Web/CSS/:has)

浏览器支持：[无](https://caniuse.com/#feat=css-has)

* * *

## 回答 #3

> 赞同：172
> 
> 时间：2009-06-18T20:08:22.487

我认为您不能仅在 CSS 中选择父级。

但是由于您似乎已经有一个`.active`类，因此将该类移到`li`（而不是`a`）会更容易。这样，您只能访问 the`li`和`a`via CSS。

* * *

## 回答 #4

> 赞同：146
> 
> 时间：2011-08-13T10:13:50.373

您可以使用[此脚本](https://github.com/Idered/cssParentSelector)：

```
*! > input[type=text] { background: #000; } 
```

这将选择文本输入的任何父级。但是等等，还有更多。如果需要，您可以选择指定的父级：

```
.input-wrap! > input[type=text] { background: #000; } 
```

或者在它处于活动状态时选择它：

```
.input-wrap! > input[type=text]:focus { background: #000; } 
```

看看这个 HTML：

```
<div class="input-wrap">
    <input type="text" class="Name"/>
    <span class="help hide">Your name sir</span>
</div> 
```

您可以`span.help`在活动时选择它`input`并显示它：

```
.input-wrap! .help > input[type=text]:focus { display: block; } 
```

还有更多功能；只需查看插件的文档即可。

顺便说一句，它适用于 Internet Explorer。

* * *

## 回答 #5

> 赞同：120
> 
> 时间：2009-12-14T14:51:14.483

正如其他几个人所提到的，没有办法仅使用 CSS 来设置元素的父级/s 样式，但以下适用于[jQuery](http://jquery.com/ "jQuery。 少写。 多做。")：

```
$("a.active").parents('li').css("property", "value"); 
```

* * *

## 回答 #6

> 赞同：85
> 
> 时间：2014-01-21T08:43:47.893

没有父选择器；就像没有以前的兄弟选择器一样。没有这些选择器的一个很好的原因是浏览器必须遍历一个元素的所有子元素来确定是否应该应用一个类。例如，如果你写：

```
body:contains-selector(a.active) { background: red; } 
```

然后浏览器将不得不等到它加载并解析所有内容，直到`</body>`确定页面是否应该是红色的。

文章*[为什么我们没有父选择器](http://snook.ca/archives/html_and_css/css-parent-selectors)*详细解释了它。

* * *

## 回答 #7

> 赞同：65
> 
> 时间：2009-06-18T20:06:44.813

在 CSS 2 中没有办法做到这一点。您可以将类添加到`li`并引用`a`：

```
li.active > a {
    property: value;
} 
```

* * *

## 回答 #8

> 赞同：47
> 
> 时间：2017-09-25T13:55:34.973

如果后代具有焦点，则伪元素`:focus-within`允许选择父元素。

如果元素具有`tabindex`属性，则它可以被聚焦。

[浏览器对焦点内的支持](http://www.caniuse.com/#feat=css-focus-within)

[表索引](https://developer.mozilla.org/en-US/docs/Web/HTML/Global_attributes/tabindex)

**例子**

```
.parent:focus-within {
  background: hsl(199deg, 65%, 73%);
}

/* demo styles */
body {
  margin: 0;
}
.parent {
  background: hsl(0, 0%, 80%);
  min-height: 100vh;
  display: grid;
  place-content: center;
}
.child {
  background: hsl(0, 0%, 0%);
  color: white;
  padding: 3rem;
  outline: 0;
  cursor: pointer;
  font: 18px/1.25 sans-serif;
  width: 20ch;
}
```

```
<div class="parent">
  <div class="child" tabindex="1">
    Click or Focus on me, my parent will change.
  </div>
</div>
```

* * *

## 回答 #9

> 赞同：38
> 
> 时间：2011-11-23T09:03:14.667

尝试切换`a`到`block`显示，然后使用您想要的任何样式。该`a`元素将填充该`li`元素，您将能够根据需要修改其外观。不要忘记将`li`填充设置为 0。

```
li {
  padding: 0;
  overflow: hidden;
}
a {
  display: block;
  width: 100%;
  color: ..., background: ..., border-radius: ..., etc...
}
a.active {
  color: ..., background: ...
} 
```

* * *

## 回答 #10

> 赞同：34
> 
> 时间：2011-06-30T14:00:09.683

CSS 选择器“<a href="https://developer.mozilla.org/en-US/docs/Web/CSS/General_sibling_selectors" rel="noreferrer">General Sibling Combinator”可以用于你想要的：

```
E ~ F {
    property: value;
} 
```

这匹配任何`F`前面有元素的`E`元素。

* * *

## 回答 #11

> 赞同：27
> 
> 时间：2009-06-18T20:09:01.503

据我所知，不在 CSS 2 中。CSS 3 具有更强大的选择器，但并非在所有浏览器中都一致地实现。即使使用改进的选择器，我也不相信它会完全完成您在示例中指定的内容。

* * *

## 回答 #12

> 赞同：25
> 
> 时间：2015-05-05T18:24:05.377

这是**Selectors Level 4**规范中讨论最多的方面。这样，选择器将能够通过在给定选择器 (!) 后使用感叹号来根据其子元素设置元素的样式。

例如：

```
body! a:hover{
   background: red;
} 
```

如果用户将鼠标悬停在任何锚点上，将设置红色背景色。

但是我们必须等待浏览器的实现:(

* * *

## 回答 #13

> 赞同：24
> 
> 时间：2012-02-13T11:22:34.927

您可以尝试使用超链接作为父级，然后在悬停时更改内部元素。像这样：

```
a.active h1 {color:red;}

a.active:hover h1 {color:green;}

a.active h2 {color:blue;}

a.active:hover h1 {color:yellow;} 
```

这样，您可以根据父元素的翻转更改多个内部标签中的样式。

* * *

## 回答 #14

> 赞同：24
> 
> 时间：2013-05-16T22:04:58.633

我知道 OP 正在寻找 CSS 解决方案，但使用 jQuery 很容易实现。在我的情况下，我需要找到包含在 child 中`<ul>`的标签的父标签。jQuery 具有选择器，因此可以通过它包含的子项来识别父项：`<span>``<li>``:has`

```
$("ul:has(#someId)") 
```

将选择具有 id*为 someId*`ul`的子元素的元素。或者要回答原始问题，类似以下内容应该可以解决问题（未经测试）：

 *```
$("li:has(.active)") 
```

* * *

## 回答 #15

> 赞同：20
> 
> 时间：2018-07-31T22:47:03.927

`pointer-events`这是一个使用with的技巧`hover`：

```
<!doctype html>
<html>
    <head>
        <title></title>
        <style>
/* accessory */
.parent {
    width: 200px;
    height: 200px;
    background: gray;
}
.parent, 
.selector {
    display: flex;
    justify-content: center;
    align-items: center;
}
.selector {
    cursor: pointer;
    background: silver;
    width: 50%;
    height: 50%;
}
        </style>
        <style>
/* pertinent */
.parent {
    background: gray;
    pointer-events: none;
}
.parent:hover {
    background: fuchsia;
}
.parent 
.selector {
    pointer-events: auto;
}
        </style>
    </head>
    <body>
        <div class="parent">
            <div class="selector"></div>
        </div>
    </body>
</html>
```

* * *

## 回答 #16

> 赞同：15
> 
> 时间：2015-10-27T17:55:16.927

只是水平菜单的一个想法......

### HTML 的一部分

```
<div class='list'>
  <div class='item'>
    <a>Link</a>
  </div>
  <div class='parent-background'></div>
  <!-- submenu takes this place -->
</div> 
```

CSS 的一部分

```
/* Hide parent backgrounds... */
.parent-background {
  display: none; }

/* ... and show it when hover on children */
.item:hover + .parent-background {
  display: block;
  position: absolute;
  z-index: 10;
  top: 0;
  width: 100%; } 
```

[更新了演示和其余代码](https://jsfiddle.net/ilyabogdanov/4fyxywee/)

[另一个](https://jsfiddle.net/ilyabogdanov/o4fkL7kv/)如何将它与文本输入一起使用的示例 - 选择父字段集

* * *

## 回答 #17

> 赞同：14
> 
> 时间：2014-03-21T12:58:43.207

目前没有父选择器，甚至在 W3C 的任何讨论中都没有讨论它。您需要了解浏览器如何评估 CSS 才能真正了解我们是否需要它。

这里有很多技术解释。

[Jonathan Snook 解释了如何评估 CSS](http://snook.ca/archives/html_and_css/css-parent-selectors)。

[Chris Coyier 谈论 Parent selector](http://css-tricks.com/parent-selectors-in-css/)。

[Harry Roberts 再次谈到编写高效的 CSS 选择器](http://csswizardry.com/2011/09/writing-efficient-css-selectors/)。

但[妮可沙利文有一些关于积极趋势的有趣事实](http://calendar.perfplanet.com/2011/css-selector-performance-has-changed-for-the-better/)。

这些人都是前端开发领域的顶尖人物。

* * *

## 回答 #18

> 赞同：14
> 
> 时间：2016-04-07T17:52:31.940

有一个插件可以扩展 CSS 以包含一些在设计网站时真正有用的非标准功能。它被称为[EQCSS](http://elementqueries.com)。

EQCSS 添加的其中一件事是父选择器。它适用于所有浏览器，Internet Explorer 8 及更高版本。这是格式：

```
@element 'a.active' {
  $parent {
    background: red;
  }
} 
```

所以在这里我们对每个元素都打开了一个元素查询`a.active`，并且对于该查询中的样式，诸如此类的事情是`$parent`有意义的，因为有一个参考点。浏览器可以找到父级，因为它与 JavaScript 中的非常相似`parentNode`。

[这是一个演示`$parent`](http://elementqueries.com/demos/parent.html)和[另一个`$parent`在 Internet Explorer 8 中工作的演示，](http://staticresource.com/parent.html)以及[一个屏幕截图，以防您没有 Internet Explorer 8 来测试](https://i.imgur.com/QyVAj2u.png)。

EQCSS 还包括[元选择器](http://elementqueries.com/#meta-selectors)：`$prev`用于选定元素之前的元素以及`$this`仅用于匹配元素查询的那些元素，等等。

* * *

## 回答 #19

> 赞同：12
> 
> 时间：2019-03-19T14:14:57.303

现在是 2019 年，[CS​​S 嵌套模块的最新草案](https://drafts.csswg.org/css-nesting-1/)实际上是这样的。引入`@nest`规则。

> 3.2\. 嵌套规则：@nest
> 
> 虽然直接嵌套看起来不错，但它有点脆弱。不允许使用某些有效的嵌套选择器，例如 .foo &，并且以某些方式编辑选择器可能会使规则意外无效。同样，有些人发现嵌套很难从视觉上与周围的声明区分开来。
> 
> 为了帮助解决所有这些问题，本规范定义了@nest 规则，它对如何有效嵌套样式规则施加的限制较少。它的语法是：
> 
> `@nest = @nest <selector> { <declaration-list> }`
> 
> @nest 规则的功能与样式规则相同：它以选择器开头，并包含适用于选择器匹配的元素的声明。唯一的区别是@nest 规则中使用的选择器必须是包含嵌套的，这意味着它在某处包含一个嵌套选择器。如果所有单独的复杂选择器都包含嵌套，则选择器列表是包含嵌套的。

（从上面的 URL 复制并粘贴）。

本规范下的有效选择器示例：

```
.foo {
  color: red;
  @nest & > .bar {
    color: blue;
  }
}
/* Equivalent to:
   .foo { color: red; }
   .foo > .bar { color: blue; }
 */

.foo {
  color: red;
  @nest .parent & {
    color: blue;
  }
}
/* Equivalent to:
   .foo { color: red; }
   .parent .foo { color: blue; }
 */

.foo {
  color: red;
  @nest :not(&) {
    color: blue;
  }
}
/* Equivalent to:
   .foo { color: red; }
   :not(.foo) { color: blue; }
 */ 
```

* * *

## 回答 #20

> 赞同：11
> 
> 时间：2011-08-16T04:43:30.857

W3C 排除了这种选择器，因为它会对浏览器产生巨大的性能影响。

* * *

## 回答 #21

> 赞同：11
> 
> 时间：2015-10-14T10:08:04.877

从技术上讲，没有直接的方法可以做到这一点。但是，您可以使用 jQuery 或 JavaScript 对其进行排序。

但是，您也可以这样做。

```
a.active h1 {color: blue;}
a.active p {color: green;} 
```

**jQuery**

```
$("a.active").parents('li').css("property", "value"); 
```

如果您想使用 jQuery 来实现这一点，这里是[jQuery 父选择器](http://www.snoopcode.com/jquery/jquery-parent-selector)的参考。

* * *

## 回答 #22

> 赞同：11
> 
> 时间：2017-06-16T18:06:57.833

简短的回答是**否定**的；在 CSS 的这个阶段我们没有`parent selector`，但如果你不需要交换元素或类，第二个选择是使用 JavaScript。像这样的东西：

```
var activeATag = Array.prototype.slice.call(document.querySelectorAll('a.active'));

activeATag.map(function(x) {
  if(x.parentNode.tagName === 'LI') {
    x.parentNode.style.color = 'red'; // Your property: value;
  }
}); 
```

如果您在应用程序中使用**jQuery ，或者更短的方法：**

```
$('a.active').parents('li').css('color', 'red'); // Your property: value; 
```

* * *

## 回答 #23

> 赞同：9
> 
> 时间：2017-02-18T17:06:00.673

虽然目前标准 CSS 中没有父选择器，但我正在开发一个名为**ax**（即*增强 CSS 选择器语法 / ACSSSS*）的（个人）项目，在它的 7 个新选择器中，包括以下两个：

1.  一个*直接父*选择器`<`（它可以启用相反的选择`>`）
2.  一个*任何祖先选择器* `^`（它可以启用相反的选择`[SPACE]`）

**ax**目前处于相对早期的 BETA 开发阶段。

在此处查看演示：

```
.parent {
  float: left;
  width: 180px;
  height: 180px;
  margin-right: 12px;
  background-color: rgb(191, 191, 191);
}

.child {
  width: 90px;
  height: 90px;
  margin: 45px;
  padding-top: 12px;
  font-family: sans-serif;
  text-align: center;
  font-size: 12px;
  background-color: rgb(255, 255, 0);
}

.child.using-axe < .parent {
  background-color: rgb(255, 0, 0);
}
```

```
<div class="parent">
  <div class="child"></div>
</div>

<div class="parent">
  <div class="child using-axe">Here, the axe parent selector turns the outer square red.</div>
</div>

<script src="https://rouninmedia.github.io/axe/axe.js"></script>
```

在上面的例子`<`中是**直接父选择器**，所以

*   `.child.using-axe < .parent`

方法：

> 任何直系父母`.child.using-axe`是`.parent`

您也可以使用：

*   `.child.using-axe < div`

这意味着：

> 任何直系父母`.child.using-axe`是`div`

* * *

## 回答 #24

> 赞同：4
> 
> 时间：2018-02-01T14:18:25.007

至少在 CSS 3 之前（包括 CSS 3），您不能这样选择。但是现在用 JavaScript 可以很容易地做到这一点，你只需要添加一些 vanilla JavaScript，注意代码很短。

```
cells = document.querySelectorAll('div');
[].forEach.call(cells, function (el) {
    //console.log(el.nodeName)
    if (el.hasChildNodes() && el.firstChild.nodeName=="A") {
        console.log(el)
    };
});
```

```
<div>Peter</div>
<div><a href="#">Jackson link</a></div>
<div>Philip</div>
<div><a href="#">Pullman link</a></div>
```

* * *

## 回答 #25

> 赞同：4
> 
> 时间：2021-12-21T18:20:48.207

CSS 父选择器（也称为**:has() 选择器**）终于登陆 Safari TP 137。该功能目前也在 Chrome 中实现。（[MDN 文档](https://developer.mozilla.org/docs/Web/CSS/:has)）

父选择是通过伪类完成的`:has()`。例如，`div:has(> .child)`将选择所有`<div>`具有子`child`类的元素。

其他示例：

**选择元素的直接父级**

```
<div>
  <p>Child Element</p>
</div> 
```

```
div:has(> p) 
```

**选择一个元素的所有父元素**

```
<div id="grandparent">
      <div id="parent">
            <div id="child"></div>
      <div>
</div> 
```

以下选择器将同时选择`grandparent`和`parent`

```
div:has(.child) 
```

您还可以将它用于嵌套选择器，甚至用于其他伪类：

```
div:has(> :nth-child(10)) 
```

其他有效的 CSS 运算符可用于自定义查询。

请留意[caniuse.com/css-has](https://caniuse.com/css-has)以了解浏览器兼容性。

* * *

## 回答 #26

> 赞同：3
> 
> 时间：2015-11-27T21:16:35.307

不，您不能仅在 CSS 中选择父级。

但是由于您似乎已经有一个`.active`类，因此将该类移到`li`（而不是`a`）会更容易。这样，您只能访问 the`li`和`a`via CSS。

* * *

## 回答 #27

> 赞同：3
> 
> 时间：2019-06-08T06:31:18.203

> 有任何想法吗？

如果 CSS4在*向后走时添加了一些**钩子*，那它会很漂亮。在此之前，可以（尽管**不**建议）使用和/或*s*来*打破*事物连接的通常方式，并通过这种方式也允许 CSS 在其正常范围之外运行......***`checkbox``radio` *`input`****

 ****```
/* Hide things that may be latter shown */
.menu__checkbox__selection,
.menu__checkbox__style,
.menu__hidden {
  display: none;
  visibility: hidden;
  opacity: 0;
  filter: alpha(opacity=0); /* Old Microsoft opacity */
}

/* Base style for content and style menu */
.main__content {
  background-color: lightgray;
  color: black;
}

.menu__hidden {
  background-color: black;
  color: lightgray;
  /* Make list look not so _listy_ */
  list-style: none;
  padding-left: 5px;
}

.menu__option {
  box-sizing: content-box;
  display: block;
  position: static;
  z-index: auto;
}

/* &#9660; - \u2630 - Three Bars */
/*
.menu__trigger__selection::before {
  content: '\2630';
  display: inline-block;
}
*/

/* &#9660; - Down Arrow */
.menu__trigger__selection::after {
  content: "\25BC";
  display: inline-block;
  transform: rotate(90deg);
}

/* Customize to look more `select` like if you like */
.menu__trigger__style:hover,
.menu__trigger__style:active {
  cursor: pointer;
  background-color: darkgray;
  color: white;
}

/**
 * Things to do when checkboxes/radios are checked
 */

.menu__checkbox__selection:checked + .menu__trigger__selection::after,
.menu__checkbox__selection[checked] + .menu__trigger__selection::after {
  transform: rotate(0deg);
}

/* This bit is something that you may see elsewhere */
.menu__checkbox__selection:checked ~ .menu__hidden,
.menu__checkbox__selection[checked] ~ .menu__hidden {
  display: block;
  visibility: visible;
  opacity: 1;
  filter: alpha(opacity=100); /* Microsoft!? */
}

/**
 * Hacky CSS only changes based off non-inline checkboxes
 * ... AKA the stuff you cannot unsee after this...
 */
.menu__checkbox__style[id="style-default"]:checked ~ .main__content {
  background-color: lightgray;
  color: black;
}

.menu__checkbox__style[id="style-default"]:checked ~ .main__content .menu__trigger__style[for="style-default"] {
  color: darkorange;
}

.menu__checkbox__style[id="style-one"]:checked ~ .main__content {
  background-color: black;
  color: lightgray;
}

.menu__checkbox__style[id="style-one"]:checked ~ .main__content .menu__trigger__style[for="style-one"] {
  color: darkorange;
}

.menu__checkbox__style[id="style-two"]:checked ~ .main__content {
  background-color: darkgreen;
  color: red;
}

.menu__checkbox__style[id="style-two"]:checked ~ .main__content .menu__trigger__style[for="style-two"] {
  color: darkorange;
}
```

```
<!--
  This bit works, but will one day cause troubles,
  but truth is you can stick checkbox/radio inputs
  just about anywhere and then call them by id with
  a `for` label. Keep scrolling to see what I mean
-->
<input type="radio"
       name="colorize"
       class="menu__checkbox__style"
       id="style-default">
<input type="radio"
       name="colorize"
       class="menu__checkbox__style"
       id="style-one">
<input type="radio"
       name="colorize"
       class="menu__checkbox__style"
       id="style-two">

<div class="main__content">

  <p class="paragraph__split">
    Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
    tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
    quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
  </p>

  <input type="checkbox"
         class="menu__checkbox__selection"
         id="trigger-style-menu">
  <label for="trigger-style-menu"
         class="menu__trigger__selection"> Theme</label>

  <ul class="menu__hidden">
    <li class="menu__option">
      <label for="style-default"
             class="menu__trigger__style">Default Style</label>
    </li>

    <li class="menu__option">
      <label for="style-one"
             class="menu__trigger__style">First Alternative Style</label>
    </li>

    <li class="menu__option">
      <label for="style-two"
             class="menu__trigger__style">Second Alternative Style</label>
    </li>
  </ul>

  <p class="paragraph__split">
    consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
    cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
    proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
  </p>

</div>
```

... 相当*恶心*，但仅使用 CSS 和 HTML 就可以通过链接/ *s*和*触发器*的and属性，从几乎任何地方触摸和重新触摸除`body`and之外的任何东西；可能有人会在某个时候展示如何重新触摸它们。`:root``id``for``radio``checkbox` *`input`*`label`

 *一个额外的警告是，只有**一个** `input`特定的`id`可能被使用，首先`checkbox`/`radio` *赢得*切换状态，换句话说......**但是**多个标签都可以指向同一个`input`，尽管这会使 HTML 和 CSS 看起来更加粗糙。

* * *

> ...我希望有某种解决方法存在于 CSS Level 2 中...

我不确定其他伪类，但我`:checked`是 CSS 3 之前的版本。如果我没记错的话，`[checked]`这就是为什么你可以在上面的代码中找到它的原因，例如，

```
.menu__checkbox__selection:checked ~ .menu__hidden,
.menu__checkbox__selection[checked] ~ .menu__hidden {
 /* rules: and-stuff; */
} 
```

...但是对于诸如`::after`and之类的东西`:hover`，我完全不确定它们最初出现在哪个 CSS 版本中。

综上所述，请永远不要在生产中使用它，即使是愤怒也不行。作为一个玩笑，或者换句话说，仅仅因为*可以*做某事并不总是意味着它*应该*做。

* * *

## 回答 #28

> 赞同：3
> 
> 时间：2019-07-05T06:34:42.373

当前仅当我们在父元素中有一个元素时，才能根据子元素更改父`<input>`元素。当输入获得焦点时，其对应的父元素可以使用 CSS 受到影响。

以下示例将帮助您了解`:focus-within`在 CSS 中的使用。

```
.outer-div {
  width: 400px;
  height: 400px;
  padding: 50px;
  float: left
}

.outer-div:focus-within {
  background: red;
}

.inner-div {
  width: 200px;
  height: 200px;
  float: left;
  background: yellow;
  padding: 50px;
}
```

```
<div class="outer-div">
  <div class="inner-div">
    I want to change outer-div(Background color) class based on inner-div. Is it possible?
    <input type="text" placeholder="Name" />
  </div>
</div>
```

* * *

## 回答 #29

> 赞同：2
> 
> 时间：2020-01-31T15:53:33.230

由于“CSS 工作组之前拒绝父选择器提案的主要原因与浏览器性能和增量渲染问题有关”，因此没有 css（因此在 css 预处理器中）父选择器。

* * *

## 回答 #30

> 赞同：2
> 
> 时间：2021-01-28T17:38:45.710

试试这个...

**该解决方案使用无 Javascript 的纯 CSS2 规则，适用于所有新旧浏览器**。单击时，子`anchor`标签会激活其`active`伪类事件。然后它只是简单地隐藏自己，让`active`事件冒泡到父`li`标签，然后父标签重新设置自己的样式，并以新的样式再次显示他的锚子。孩子已经为父母设置了样式。

使用您的示例：

```
<ul>
    <li class="listitem">
        <a class="link" href="#">This is a Link</a>
    </li>
</ul> 
```

现在将这些样式与`active`伪类一起应用`a`以在单击链接时重新设置父`li`标记的样式：

```
a.link {
    display: inline-block;
    color: white;
    background-color: green;
    text-decoration: none;
    padding: 5px;
}

li.listitem {
    display: inline-block;
    margin: 0;
    padding: 0;
    background-color: transparent;
}

/* When this 'active' pseudo-class event below fires on click, it hides itself,
triggering the active event again on its parent which applies new styles to itself and its child. */

a.link:active {
    display: none;
}

.listitem:active {
    background-color: blue;
}

.listitem:active a.link {
    display: inline-block;
    background-color: transparent;
} 
```

您应该会看到带有绿色背景的链接现在在单击时变为列表项的蓝色背景。

[![在此处输入图像描述](../Images/b92f85dbe489e42fc81af582eda5d791.png)](https://i.stack.imgur.com/2MTVy.png)

转向

[![在此处输入图像描述](../Images/01746e5e9a9fae9478220a294ea20c34.png)](https://i.stack.imgur.com/aRVcH.png)

点击。

* * *

## 回答 #31

> 赞同：1
> 
> 时间：2019-06-13T08:25:27.050

我会雇用一些 JavaScript 代码来做到这一点。例如，在 React 中，当您遍历数组时，将另一个类添加到父组件，这表明它包含您的子组件：

```
<div className={`parent ${hasKiddos ? 'has-kiddos' : ''}`}>
    {kiddos.map(kid => <div key={kid.id} />)}
</div> 
```

然后简单地说：

```
.parent {
    color: #000;
}

.parent.has-kiddos {
    color: red;
} 
```

* * *

## 回答 #32

> 赞同：1
> 
> 时间：2021-10-23T11:04:56.533

这是对类似（但我感觉不完全一样）问题的回答，该问题已关闭以支持该问题，因此我在此处[检查输入时对如何更改边框颜色进行](https://stackoverflow.com/questions/69682775/how-to-change-the-border-color-when-input-is-checked?noredirect=1#comment123177057_69682775)了回答。

由于无法使用纯 CSS 根据子级的状态设置父级的样式，因此此代码段会更改 HTML，以便紧跟输入元素后有一个空的 span 元素。这个 span 元素什么都不做，直到输入悬停在它显示自身并扩展以适应与已设置位置的祖先相同的大小。这是标签本身，而不是输入。因此，边框（阴影）就像在标签上一样。

```
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

.OuterField {
  display: flex;
}

.listLabel {
  padding: 8px 5px;
  border: 2px solid black;
  width: 32%;
  margin: 1%;
  display: flex;
  justify-content: space-between;
  align-items: center;
  flex-flow: row;
  position: relative;
}

input[type="radio"]~span {
  display: none;
}

input[type="radio"]:checked~span {
  display: inline-block;
  width: 100%;
  height: 100%;
  border: 2px solid red;
  box-shadow: 0 0 0 3px orange;
  position: absolute;
  top: 0;
  left: 0;
}
```

```
<div class="OuterField">
  <label for="List1" class="listLabel">List 1
        <input type="radio" id="List1" name="list" value="List1">
        <span></span>
     </label>
  <label for="List2" class="listLabel">List 2
         <input type="radio" id="List2" name="list" value="List2">
         <span></span>
     </label>
</div>
```

* * *

## 回答 #33

> 赞同：-2
> 
> 时间：2022-02-11T09:48:12.797

答案中有许多复杂的解决方案。但是你知道父母，所以解决方案并不复杂。例如，如果您想在选中时更改样式。

```
.parentDiv > input[type="checkbox"]:checked {
    //style it
} 
```******

# javascript - JQuery 滑块控件 - 滑块句柄不移动

> ID：1014873
> 
> 赞同：1
> 
> 时间：2009-06-18T20:01:24.043
> 
> 标签：javascript, jquery, jquery-ui, scroll, slider

我有一个用 JQuery 制作的文本滚动框。它单独工作时工作正常（nationalboston.com/temp），但是当我将其交给 Joomla 页面时，滑块手柄不会移动（[此处](http://www.nationalboston.com/staging/index.php?option=com_content&view=article&id=112&Itemid=28)）。据我所知，其他一切都很好。

我在 Chrome Inspector 中检查了计算出的 CSS，似乎手柄的样式应该是这样的（位置：绝对；顶部：自动；）。我究竟做错了什么？！

编辑：在 Safari 3.x Mac 和 Chrome 3 Alpha Mac 中似乎是这种情况，而不是在 Firefox Mac 中。我没有做进一步的测试。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T20:16:10.083

我在 Mac 上的 Firefox 3.0.11 中关注了您的链接，滑块运行良好。你找到解决问题的方法了吗？当我读到你的问题时，我的第一个想法是你可能有一个 javascript 命名空间冲突（使用多个 JS 框架？）。一个可能的解决方案是在无冲突模式下运行 JQuery，如下所示：

```
jQuery.noConflict();
// Do something with jQuery
jQuery("div p").hide();
// Do something with another library's $()
$("content").style.display = 'none'; 
```

更多信息：[http://docs.jquery.com/Core/jQuery.noConflict](http://docs.jquery.com/Core/jQuery.noConflict)

# c# - WPF - 为 ItemsPresenter 实现 ItemTemplate？

> ID：1014881
> 
> 赞同：5
> 
> 时间：2009-06-18T20:02:53.840
> 
> 标签：c#, wpf, itemtemplate, itemspresenter

我一直在为 WPF 开发一个 SplitButton 控件，它基本上已经完成，但我正在尝试检查可以在其上设置的所有可能的属性，并确保它们得到实际实现。我主要只剩下两个要实现的属性，即`ItemTemplate`and `ItemTemplateSelector`（和`AlternationCount`，好吧，所以 3 个属性）。

我能够通过将and绑定到它们上来获得`HeaderTemplate`and工作。这是用于控件的按钮部分。对于控件的下拉部分，我使用了 Popup、Border 和. 问题是我不知道如何为.`HeaderTemplateSelector``ContentTemplate``ContentTemplateSelector``ContentPresenter``ItemsPresenter``ItemTemplate``ItemTemplateSelector``ItemsPresenter`

有任何想法吗？

* * *

**更新**：SplitButton 的完整源代码现在可在以下网址获得：http: [//anothersplitbutton.codeplex.com/](http://anothersplitbutton.codeplex.com/)

这是 Luna.NormalColor.xaml 文件：

```
<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:WpfSplitButton="clr-namespace:WpfSplitButton"
                    xmlns:mwt="clr-namespace:Microsoft.Windows.Themes;assembly=PresentationFramework.Luna"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <!-- SplitButtonHeader Style -->
    <Style x:Key="{x:Type WpfSplitButton:SplitButtonHeader}"
           TargetType="{x:Type WpfSplitButton:SplitButtonHeader}">

        <Style.Resources>
            <Style x:Key="ButtonFocusVisual">
                <Setter Property="Control.Template">
                    <Setter.Value>
                        <ControlTemplate>
                            <Rectangle Margin="2"
                                       StrokeThickness="1"
                                       Stroke="Black"
                                       StrokeDashArray="1 2"
                                       SnapsToDevicePixels="True" />
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
        </Style.Resources>

        <Style.Setters>
            <Setter Property="FocusVisualStyle"
                    Value="{StaticResource ButtonFocusVisual}" />
            <Setter Property="HorizontalContentAlignment"
                    Value="Center" />
            <Setter Property="PastLeftDetection"
                    Value="True" />
            <Setter Property="VerticalContentAlignment"
                    Value="Center" />

            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate>
                        <mwt:ButtonChrome x:Name="Chrome"
                                          BorderBrush="{TemplateBinding Border.BorderBrush}"
                                          RenderDefaulted="{TemplateBinding Button.IsDefaulted}"
                                          RenderMouseOver="{TemplateBinding UIElement.IsMouseOver}"
                                          RenderPressed="{TemplateBinding ButtonBase.IsPressed}"
                                          SnapsToDevicePixels="True">

                            <Grid Background="{TemplateBinding ButtonBase.Background}">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>

                                <ContentPresenter Content="{TemplateBinding ContentControl.Content}"
                                                  ContentTemplate="{TemplateBinding ButtonBase.ContentTemplate}"
                                                  ContentTemplateSelector="{TemplateBinding ButtonBase.ContentTemplateSelector}"
                                                  HorizontalAlignment="{TemplateBinding Control.HorizontalContentAlignment}"
                                                  Margin="{TemplateBinding Control.Padding}"
                                                  RecognizesAccessKey="True"
                                                  SnapsToDevicePixels="{TemplateBinding UIElement.SnapsToDevicePixels}"
                                                  VerticalAlignment="{TemplateBinding Control.VerticalContentAlignment}" />

                                <Border x:Name="PART_DropDownInitiator"
                                        Background="Transparent"
                                        BorderBrush="{Binding Path=BorderBrush, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type WpfSplitButton:SplitButtonHeader}}}"
                                        BorderThickness="1,0,0,0"
                                        Grid.Column="1"
                                        HorizontalAlignment="Stretch"
                                        Margin="0,0,0,0"
                                        Padding="4,0,4,0"
                                        VerticalAlignment="Stretch">

                                    <Path Fill="{Binding Path=Foreground, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type WpfSplitButton:SplitButtonHeader}}}"
                                          VerticalAlignment="Center">

                                        <Path.Style>
                                            <Style>
                                                <Setter Property="Path.Fill"
                                                        Value="{DynamicResource {x:Static SystemColors.WindowTextBrushKey}}" />

                                                <Style.Triggers>
                                                    <Trigger Property="WpfSplitButton:SplitButton.IsMouseOver"
                                                             Value="True">
                                                        <Setter Property="Path.Fill"
                                                                Value="{DynamicResource {x:Static SystemColors.HighlightTextBrushKey}}" />
                                                    </Trigger>
                                                </Style.Triggers>
                                            </Style>
                                        </Path.Style>

                                        <Path.Data>
                                            <PathGeometry>
                                                <PathGeometry.Figures>
                                                    <PathFigureCollection>
                                                        <PathFigure IsClosed="True"
                                                                    StartPoint="0,0">
                                                            <PathFigure.Segments>
                                                                <PathSegmentCollection>
                                                                    <LineSegment Point="8,0" />
                                                                    <LineSegment Point="4,5" />
                                                                </PathSegmentCollection>
                                                            </PathFigure.Segments>
                                                        </PathFigure>
                                                    </PathFigureCollection>
                                                </PathGeometry.Figures>
                                            </PathGeometry>
                                        </Path.Data>
                                    </Path>
                                </Border>
                            </Grid>
                        </mwt:ButtonChrome>

                        <ControlTemplate.Triggers>
                            <Trigger Property="UIElement.IsKeyboardFocused"
                                     Value="True">
                                <Setter TargetName="Chrome"
                                        Property="mwt:ButtonChrome.RenderDefaulted"
                                        Value="True" />
                            </Trigger>

                            <Trigger Property="ToggleButton.IsChecked"
                                     Value="True">
                                <Setter TargetName="Chrome"
                                        Property="mwt:ButtonChrome.RenderPressed"
                                        Value="True" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style.Setters>
    </Style>

    <!-- SplitButton -->
    <Style x:Key="{x:Type WpfSplitButton:SplitButton}"
           TargetType="{x:Type WpfSplitButton:SplitButton}">

        <Style.Resources>
            <LinearGradientBrush x:Key="ButtonNormalBackgroundFill"
                                 EndPoint="0.5,1"
                                 StartPoint="0.5,0">
                <LinearGradientBrush.GradientStops>
                    <GradientStop Color="#FFFFFFFF"
                                  Offset="0" />
                    <GradientStop Color="#FFF0F0EA"
                                  Offset="0.9" />
                </LinearGradientBrush.GradientStops>
            </LinearGradientBrush>

            <SolidColorBrush x:Key="ButtonBorder"
                             Color="#FF003C74" />
        </Style.Resources>

        <Setter Property="AutoUpdateHeader"
                Value="True" />

        <Setter Property="Background"
                Value="{StaticResource ButtonNormalBackgroundFill}" />

        <Setter Property="BorderBrush"
                Value="{StaticResource ButtonBorder}" />

        <Setter Property="BorderThickness"
                Value="1" />

        <Setter Property="Foreground"
                Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}" />

        <Setter Property="HorizontalContentAlignment"
                Value="Center" />

        <Setter Property="Padding"
                Value="4,4,4,4" />

        <Setter Property="VerticalContentAlignment"
                Value="Center" />

        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type WpfSplitButton:SplitButton}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>

                        <WpfSplitButton:SplitButtonHeader x:Name="PART_Header"
                                                          Background="{TemplateBinding Background}"
                                                          BorderBrush="{TemplateBinding BorderBrush}"
                                                          BorderThickness="{TemplateBinding BorderThickness}"
                                                          Content="{TemplateBinding Header}"
                                                          ContentTemplate="{TemplateBinding HeaderTemplate}"
                                                          ContentTemplateSelector="{TemplateBinding HeaderTemplateSelector}"
                                                          Cursor="{TemplateBinding Cursor}"
                                                          Foreground="{TemplateBinding Foreground}"
                                                          Grid.Row="0"
                                                          HorizontalAlignment="Stretch"
                                                          HorizontalContentAlignment="{TemplateBinding HorizontalContentAlignment}"
                                                          Padding="{TemplateBinding Padding}"
                                                          VerticalAlignment="Stretch"
                                                          VerticalContentAlignment="{TemplateBinding VerticalContentAlignment}" />

                        <Popup x:Name="PART_Popup"
                               AllowsTransparency="True"
                               Grid.Row="1"
                               IsOpen="{Binding Path=IsDropDownOpen, RelativeSource={RelativeSource TemplatedParent}, Mode=TwoWay}"
                               MinWidth="{Binding Path=ActualWidth, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type WpfSplitButton:SplitButton}}}"
                               Placement="Bottom"
                               PlacementTarget="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type WpfSplitButton:SplitButton}}}"
                               PopupAnimation="{DynamicResource {x:Static SystemParameters.ComboBoxPopupAnimationKey}}"
                               StaysOpen="False">

                            <mwt:SystemDropShadowChrome Color="Transparent">
                                <Border x:Name="DropDownBorder"
                                        Background="{TemplateBinding Background}"
                                        BorderBrush="{TemplateBinding BorderBrush}"
                                        BorderThickness="{TemplateBinding BorderThickness}">

                                    <ItemsPresenter SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                                </Border>
                            </mwt:SystemDropShadowChrome>
                        </Popup>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>

        <Style.Triggers>
            <Trigger Property="IsEnabled"
                     Value="False">
                <Setter Property="Foreground"
                        Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}" />
            </Trigger>
        </Style.Triggers>
    </Style>
</ResourceDictionary> 
```

* * *

**更新 2** 我尝试使用 ItemsControl 切换 ItemsPresenter，但我似乎无法让 ItemTemplate 属性执行任何操作。这是更改后的代码部分：

```
<ItemsControl DataContext="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type WpfSplitButton:SplitButton}}}"
              AlternationCount="{TemplateBinding AlternationCount}"
              IsTabStop="{TemplateBinding IsTabStop}"
              IsTextSearchEnabled="{TemplateBinding IsTextSearchEnabled}"
              ItemContainerStyle="{TemplateBinding ItemContainerStyle}"
              ItemContainerStyleSelector="{TemplateBinding ItemContainerStyleSelector}"
              ItemBindingGroup="{TemplateBinding ItemBindingGroup}"
              ItemsPanel="{TemplateBinding ItemsPanel}"
              ItemsSource="{Binding Path=Items}"
              ItemStringFormat="{TemplateBinding ItemStringFormat}"
              ItemTemplateSelector="{TemplateBinding ItemTemplateSelector}"
              SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}">
    <ItemsControl.ItemTemplate>
        <DataTemplate>
            <TextBlock Text="HELLO" />
        </DataTemplate>
    </ItemsControl.ItemTemplate> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-23T20:01:35.770

您是否考虑过使用 an`ItemsControl`而不是`ItemsPresenter`？这将为您提供`ItemTemplate`and`ItemTemplateSelector`财产以及`AlternationCount`财产。

**更新：** 我使用上面发布的 ItemsControl 让它工作得很好，使用以下行绑定到 Classic.xaml 文件中的 ItemsTemplate 属性：

```
 ItemTemplate="{TemplateBinding ItemsTemplate, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type WpfSplitButton:SplitButton}}}" 
```

然后在您的 MainWindow 资源中，我刚刚添加了以下模板：

```
<DataTemplate x:Key="Test">
    <MenuItem Header="{Binding}" />
</DataTemplate> 
```

然后我在 SplitButton 上设置 ItemTemplate 属性：

```
ItemTemplate="{StaticResource Test}" 
```

因此，只需连接您的 ItemSource 就可以了……我只是在后面的代码中使用了一个简单的字符串 []……希望这会有所帮助！

# jquery - 如何确定页面加载的瓶颈？

> ID：1014884
> 
> 赞同：3
> 
> 时间：2009-06-18T20:03:30.623
> 
> 标签：jquery, jquery-ui, datepicker, pageload

我有一个使用 jQuery UI 的页面，并在 2 个不同的文本框上调用 datepicker。没有电话，即。只需加载页面而不附加任何日期选择器，页面将在 1.20 秒内加载。附加日期选择器后，页面加载时间为 3.92 秒。（这是在Firefox中）

我怎样才能加快这个速度？根据 Firebug 中的网络图，这不是网络问题，但它似乎在 datepicker 附件中。有没有办法加快这个速度？

此外，该行为仅在 Firefox 3.0.11 中可见。Chrome 既快速又活泼，IE7 也是如此。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-18T20:26:32.247

尝试运行[Firebug 的代码分析器](http://getfirebug.com/js.html)以查看哪些函数使事情陷入困境。基本上，点击“配置文件”按钮，刷新页面，让它加载，然后再次点击“配置文件”按钮以读取消耗最多资源或花费时间最长的内容。

分析器应该让您了解正在发生的事情：无论是在您的代码中还是在 jQuery UI 中。

在更一般的意义上，确保您使用高效的选择器来选择将日期选择器绑定到的元素。此外，日期选择器是否有可能向 DOM（样式表、图像等）注入一些瓶颈（自从我使用 jQuery UI 的日期选择器以来已经有一段时间了，所以这可能不是问题）？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T13:12:50.110

dfa 在我的主要帖子的评论中是正确的。问题是萤火虫。我猜它只是不能很好地加载日期选择器。一旦萤火虫被关闭，页面加载时间大约是 0.5 秒，就在他们应该在的地方。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T20:07:08.417

我建议看看这个链接： http: [//net.tutsplus.com/articles/web-roundups/20-tools-to-make-the-life-of-a-web-developer-easier/](http://net.tutsplus.com/articles/web-roundups/20-tools-to-make-the-life-of-a-web-developer-easier/)。在那里，您将找到指向[http://tools.pingdom.com/](http://tools.pingdom.com/)的链接，该链接将帮助您确定页面加载问题。试试你的页面的两个版本，看看这个工具为你发现了什么。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-18T20:39:40.787

使用 FireFox 的[FireBug](http://getfirebug.com/)和[YSlow](http://developer.yahoo.com/yslow/)插件。前者允许执行计时和日志记录，后者有一个规则列表并就调整的内容提出建议。

# c - 一个小 C 程序的结果

> ID：1014886
> 
> 赞同：4
> 
> 时间：2009-06-18T20:04:17.877
> 
> 标签：c, unix, fork

我们需要告诉以下 C 程序的结果：

```
main()
{
    int pid, k, som;
    som = 0; k = 2;
    pid = fork();
    if(pid == 0)
        k=5;
    else
        wait(0);
    for(int i = 1; i <= k; i++)
        som += i;
    printf("%d", som);
} 
```

我的第一个期望是 3。当进行 fork 调用时，进程的内存被复制，两个程序都开始运行。子进程然后执行，但k仍然等于2。所以最后它执行1 + 2 = 3；

但是当这个程序被执行时，它会输出 153。我没有得到最近的线索为什么它会输出那个。

谁能告诉我为什么？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-06-18T20:06:40.167

原因是您有 2 个进程打印到同一个控制台。"fork" 是一个 unix/linux 命令，被调用一次并返回两次。返回之一将在调用 fork 的原始进程中，并将返回生成的子进程的 PID。第二个返回值为 0，这表明它是子进程。

其中一个程序，我相信的孩子，首先执行并计算 15 作为值并最后将其打印到控制台。由于 wait(0)，父程序第二次执行并产生值 3。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-18T20:09:02.610

`15`由孩子和`3`父母打印。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-18T20:11:07.333

A 是父母，B 是孩子，这是重要的几行：

```
A: pid = fork(); // returns 0 for the child process
A: wait(0);
B: k = 5;
B: for(int i = 1; i <= k; i++) som += i; // som = 15
B: printf("%d", som); // prints 15, B finishes, goes back to A
A: for(int i = 1; i <= k; i++) som += i; // som = 3
A: printf("%d", som); // prints 3 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-18T20:10:52.310

值之间没有打印换行符，因此父母的答案出现在孩子的答案之后。

贾里德关于价值观的原因是正确的。

# c# - 比较数据集或更好的想法

> ID：1014906
> 
> 赞同：2
> 
> 时间：2009-06-18T20:07:12.223
> 
> 标签：c#, linq, ado.net, .net-2.0, dataset

如何比较一个数据集与另一个数据集的值。

**第一个数据集**["proper records"] 来自 SQL Server，列名

```
 [id], [subsNumber] 
```

**第二个数据集**[“正确和不正确的记录”] 来自进度数据库，除了 1 之外有不同的列`subsNumber`

如何制作另一个数据集，其中包含来自 ["proper records"] 的所有数据集和`[subsNumber]`来自 2nd datset ["proper inproper records"] 的匹配记录？

或者

删除 2nd dataset["proper and inproper records"] 中与第 1 个数据集中的 "subsNumber" 列不匹配的所有记录

或任何其他想法

基本上我如何从与第一个数据集具有相同“subsNumber”的第二个数据集中获取所有记录

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T13:56:50.783

关键是使用 System.Data.DataRelation 将您的 2 个数据表连接到一个公共列（或多个列）上。

[这是从KC 的 See Sharp 博客上](http://kseesharp.blogspot.com/2007/12/compare-2-datatables-and-return-3rd.html)的帖子中得出的一些代码

```
public DataTable GetImproperRecords(DataTable ProperRecords, DataTable ImproperRecords) {
  DataTable relatedTable = new DataTable("Difference");
  try {
     using (DataSet dataSet = new DataSet()) {
        dataSet.Tables.AddRange(new DataTable[] { ProperRecords.Copy(), ImproperRecords.Copy() });

        DataColumn properColumn = new DataColumn();
        properColumn = dataSet.Tables[0].Columns[1]; // Assuming subsNumber is at index 1

        DataColumn improperColumn = new DataColumn();
        improperColumn = dataSet.Tables[1].Columns[0]; // Assuming subsNumber is at index 0

        //Create DataRelation
        DataRelation relation = new DataRelation(string.Empty, properColumn, improperColumn, false);

        dataSet.Relations.Add(relation);

        //Create columns for return relatedTable
        for (int i = 0; i < ImproperRecords.Columns.Count; i++) {
           relatedTable.Columns.Add(ImproperRecords.Columns[i].ColumnName, ImproperRecords.Columns[i].DataType);
        }

        relatedTable.BeginLoadData();

        foreach (DataRow parentrow in dataSet.Tables[1].Rows) {
           DataRow[] childrows = parentrow.GetChildRows(relation);

           if (childrows != null && childrows.Length > 0)
              relatedTable.LoadDataRow(parentrow.ItemArray, true);

        }

        relatedTable.EndLoadData();

     }
  }
  catch (Exception ex) {
     Console.WriteLine(ex.Message);
  }

  return relatedTable;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-22T15:10:41.180

我解决了这个问题：

第一个数据集--> 循环并获取 subsNumber

调用函数并将 subsNumber 和第二个数据集传递给它然后为新数据集启动另一个循环

如果 subsnumber 不匹配则继续如果 subsNumber 匹配该数据，例如将列添加到 sqlserver 表等。

代码：

```
 foreach (DataRow row in ecommDS.Tables["EcommData"].Rows)
 {           
     //string statCode = ""
     string prdCode = ""; //declaring var for getting string format from ecomm
     string checking = "";
     prdCode = row["PRD-CDE"].ToString();
     checking = row["SUBS-NUM"].ToString();

     if(checking != subsNum)
     {
         continue;
     } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T20:12:48.110

要从第二个数据集中获取与第一个数据集的记录匹配的所有记录，如下所示：

IEnumerable list3 = list2.Where(l2=>list1.Contains(l1=>l1.subsNumber == l2.subsNumber));

类似的东西！

# vb.net - 'For Each' VB.NET 迭代计数

> ID：1014908
> 
> 赞同：11
> 
> 时间：2009-06-18T20:07:51.833
> 
> 标签：vb.net

Visual Basic 中的循环是否[`For Each`](http://msdn.microsoft.com/en-us/library/vstudio/5ebk1751.aspx)有迭代计数，还是我必须自己做？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-18T20:08:47.587

不幸的是，你必须自己做。该`For Each`构造使用[`IEnumerator`](http://msdn.microsoft.com/en-us/library/78dfe2yb.aspx)接口实现来迭代序列，并且`IEnumerator`接口不公开任何成员来指示其在序列中的位置或当前索引。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-20T10:08:25.360

如果我需要一个迭代器变量，我会使用一个`for`循环来代替（每个 IEnumerable 都应该有一个 .Count 属性）。

代替

```
For Each element as MyType in MyList
    ....
Next 
```

写

```
For i as integer = 0 to MyList.Count - 1
    element = MyList(i)
    ....
Next 
```

这将是相同的结果。您有`i`作为迭代器并`element`保存当前元素。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-06-18T20:09:47.367

如果您使用的是 Visual Studio 2009（或 VB.Net 9.0），则可以使用 Select override 来获取值的计数。

```
For Each cur in col.Select(Function(x,i) New With { .Index = i, .Value = x })
 ...
Next 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-18T20:09:16.573

你必须自己做。大多数情况下，如果您正在执行 For Each（C# 中的 foreach），那么您并不关心迭代次数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-18T20:09:46.040

Foreach 对它在 M 个元素的集合中找到的每个元素 M 进行循环。

所以，不，没有明确的迭代计数，就像在 FOR 循环中那样。

# php - LSA - 潜在语义分析 - 如何在 PHP 中编码？

> ID：1014927
> 
> 赞同：9
> 
> 时间：2009-06-18T20:10:31.717
> 
> 标签：php, tagging, semantics, linguistics, lsa

我想在 PHP 中实现潜在语义分析（LSA），以便找出文本的主题/标签。

这是我认为我必须做的。**它是否正确？如何在 PHP 中编写代码？我如何确定选择哪些词？**

我不想使用任何外部库。[我已经实现了 Singular Value Decomposition (SVD)](https://stackoverflow.com/questions/960060/singular-value-decomposition-svd-in-php)。

1.  从给定文本中提取所有单词。
2.  加权单词/短语，例如使用[tf–idf](http://en.wikipedia.org/wiki/Tf%E2%80%93idf)。如果加权太复杂，只取出现次数。
3.  建立一个矩阵：列是数据库中的一些文档（越多越好？），行都是唯一的单词，值是出现次数或权重。
4.  执行奇异值分解 (SVD)。
5.  使用矩阵 S (SVD) 中的值进行降维（如何？）。

我希望你能帮助我。非常感谢您！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-24T15:17:29.607

LSA 链接：

*   [Landauer（共同创作者）关于 LSA 的文章](http://www.scholarpedia.org/article/Latent_semantic_analysis)
*   [R-project lsa 用户指南](http://cran.r-project.org/web/packages/lsa/lsa.pdf)

这是完整的算法。如果您有 SVD，那么您就已经成功了。上面的论文比我解释得更好。

假设：

*   *您的 SVD 函数将按降序给出奇异值和奇异向量。* 如果没有，你必须做更多的杂技。

**M**：语料库矩阵，w（单词）乘 d（文档）（w 行，d 列）。这些可以是原始计数，也可以是 tfidf 或其他。停用词可能会或可能不会被消除，并且可能会发生词干（Landauer 说保留停用词并且不要词干，但对 tfidf 是肯定的）。

```
U,Sigma,V = singular_value_decomposition(M)

U:  w x w
Sigma:  min(w,d) length vector, or w * d matrix with diagonal filled in the first min(w,d) spots with the singular values
V:  d x d matrix

Thus U * Sigma * V = M  
#  you might have to do some transposes depending on how your SVD code 
#  returns U and V.  verify this so that you don't go crazy :) 
```

然后是减少性......实际的 LSA 论文提出了一个很好的基础近似值是保持足够的向量，使得它们的奇异值超过奇异值总数的 50%。

更简洁...（伪代码）

```
Let s1 = sum(Sigma).  
total = 0
for ii in range(len(Sigma)):
    val = Sigma[ii]
    total += val
    if total > .5 * s1:
        return ii 
```

这将返回新基的等级，之前是 min(d,w)，现在我们将使用 {ii} 进行近似。

（这里，'-> 素数，不是转置）

我们创建新矩阵：U',Sigma', V'，大小为 wx ii、ii x ii 和 ii x d。

这就是LSA算法的本质。

这个结果矩阵 U' * Sigma' * V' 可用于“改进的”余弦相似度搜索，或者您可以选择其中每个文档的前 3 个单词，例如。这是否不仅仅是一个简单的 tf-idf 是一个有争议的问题。

对我来说，LSA 在现实世界的数据集中表现不佳，因为多义性和主题太多的数据集。它的数学/概率基础是不健全的（它假设正态分布（高斯），这对字数没有意义）。

您的里程肯定会有所不同。

**使用 LSA 进行标记（一种方法！）**

1.  使用 SVD 和缩减启发式构造 U'Sigma'V' 降维矩阵

2.  手动查看 U' 矩阵，并提出描述每个“主题”的术语。例如，如果该向量的最大部分是“布朗克斯、洋基队、曼哈顿”，那么“纽约市”可能是一个很好的术语。将它们保存在关联数组或列表中。这一步应该是合理的，因为向量的数量是有限的。

3.  假设您有一个文档的单词向量 (v1)，那么 v1 * t(U') 将为该文档提供最强的“主题”。选择 3 个最高的，然后给出他们在上一步中计算的“主题”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-23T13:40:53.427

这个答案不是直接针对发布者的问题，而是针对如何自动标记新闻项目的元问题。OP 提到了命名实体识别，但我相信它们的含义更接近自动标记。如果他们真的是指NER，那么这个回应就是胡说八道:)

鉴于这些具有不同来源的限制（600 项/天，100-200 个字符/项），这里有一些标记选项：

1.  用手。分析师每天可以轻松完成 600 次此类操作，可能需要几个小时。像亚马逊的 Mechanical Turk 或让用户这样做，也可能是可行的。拥有一些“手工标记”，即使它只有 50 或 100 个，也将成为比较下面自动生成的方法为您提供的任何内容的良好基础。

2.  使用 LSA、Topic-Models（潜在 Dirichlet 分配）等来减少维度……我在现实世界的数据集上对 LSA 的运气真的很差，而且我对它的统计基础不满意。LDA 我发现要好得多，并且有一个 [令人难以置信的邮件列表](https://lists.cs.princeton.edu/mailman/listinfo/topic-models)，它对如何将主题分配给文本有最好的思考。

3.  简单的启发式方法...如果您有实际的新闻项目，则**利用新闻项目的结构**。关注第一句，扔掉所有常用词（停用词），从前两句中选出最好的 3 个名词。或者，见鬼，把第一句话中的所有名词都拿走，看看你会得到什么。如果文本都是英文的，那么对整个 shebang 进行词性分析，看看能得到什么。对于结构化项目，如新闻报道、LSA 和其他与订单无关的方法 (tf-idf) 会抛出大量信息。

祝你好运！

（如果您喜欢这个答案，也许可以重新标记问题以适应它）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T21:55:52.417

一切看起来都不错，直到最后一步。SVD 的常用符号是它返回三个矩阵 A = USV*。S 是一个对角矩阵（意味着对角线外全为零），在这种情况下，它基本上给出了每个维度捕获原始数据的多少的度量。数字（“奇异值”）会下降，您可以寻找有多少维度有用的下降。否则，您将只想选择一个任意数字 N 来表示要采用多少维。

在这里我有点模糊。降维空间中术语（单词）的坐标是 U 还是 V，我认为取决于它们是在输入矩阵的行还是列中。顺便说一句，我认为单词的坐标将是 U 的行。即 U 的第一行对应于输入矩阵的第一行，即第一个单词。然后，您只需将该行的前 N ​​列作为单词在缩小空间中的坐标。

高温高压

更新：

到目前为止，这个过程并没有准确地告诉你如何挑选标签。我从未听说过有人使用 LSI 来选择标签（机器学习算法可能更适合这项任务，比如决策树）。LSI 告诉您两个词是否相似。这距离分配标签还有很长的路要走。

有两个任务 - a) 要使用的标签集是什么？b) 如何选择最好的三个标签？我不太了解 LSI 将如何帮助您回答 (a)。您可以手动选择标签集。但是，如果您使用的是 LSI，标签可能应该是文档中出现的单词。然后对于 (b)，您想要挑选出与文档中找到的单词最接近的标签。您可以尝试几种实现方式。*选择最接近文档中任何*单词的三个标签，其中接近度通过标签坐标（U 中的行）和单词坐标（U 中的行）之间的余弦相似度（参见 Wikipedia）来衡量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-23T13:51:31.847

[在链接文本](https://stackoverflow.com/questions/960060/singular-value-decomposition-svd-in-php)处有一个额外的 SO 线程，说明在 PHP 中执行此操作的风险。

[具体来说，这里有一个关于潜在语义映射](http://www.ling.upenn.edu/courses/cogs501/BellegardaIEEE.pdf)的论文的链接，它描述了如何获取文本的结果“主题”。

# html - 如何将 div 渲染为 100% 的父母而不是孩子

> ID：1014928
> 
> 赞同：0
> 
> 时间：2009-06-18T20:10:39.987
> 
> 标签：html, css, html-table

我正在尝试在表格单元格中创建一个可滚动面板。

我想要的是 div 与表格单元格一样宽，然后为内容呈现滚动条。

当我尝试以下操作时，div 将其宽度设置为包含的 span 标签的 100%，而不是单元格

```
<table cellpadding="3" width="90%" align="center" border="0">
  <tr>
    <td>
       <div style="border: solid 1px red; height: 10px; width: 100%; overflow: auto;">
          <span style="width: 2000px;">a</span>
       </div>
    </td>
  </tr>
</table> 
```

我印象深刻的是 width=100% 应该是父母的大小而不是孩子的大小？

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-18T20:17:19.317

空表格单元格没有宽度，跨度是强制单元格宽度的跨度。这就是为什么 div 宽度等于单元格宽度的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T20:17:46.320

我在包含 div 而不是表格中尝试了它，它工作正常。

我假设内部跨度宽度导致 td 宽度为 2000px

# c# - 发布数据后如何读取 WebClient 响应？

> ID：1014935
> 
> 赞同：22
> 
> 时间：2009-06-18T20:12:05.193
> 
> 标签：c#, .net, webclient

看代码：

```
using (var client = new WebClient())
{
    using (var stream = client.OpenWrite("http://localhost/", "POST"))
    {
        stream.Write(post, 0, post.Length);
    }
} 
```

现在，我如何读取 HTTP 输出？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-06-18T20:14:29.870

看起来您有一些`byte[]`数据要发布；在这种情况下，我希望您会发现它更易于使用：

```
byte[] response = client.UploadData(address, post); 
```

如果响应是文本，例如：

```
string s = client.Encoding.GetString(response); 
```

（或您的选择`Encoding`- 也许`Encoding.UTF8`）

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2017-01-19T14:46:00.197

如果您想在任何地方保留流并避免分配大量字节数组，这是一种很好的做法（例如，如果您打算发布大文件），您仍然可以使用 WebClient 的派生版本来做到这一点。这是一个示例代码。

```
using (var client = new WebClientWithResponse())
{
    using (var stream = client.OpenWrite(myUrl))
    {
        // open a huge local file and send it
        using (var file = new FileStream(filePath, FileMode.Open, FileAccess.Read, FileShare.ReadWrite))
        {
            file.CopyTo(stream);
        }
    }

    // get response as an array of bytes. You'll need some encoding to convert to string, etc.
    var bytes = client.Response;
} 
```

这是定制的WebClient：

```
public class WebClientWithResponse : WebClient
{
    // we will store the response here. We could store it elsewhere if needed.
    // This presumes the response is not a huge array...
    public byte[] Response { get; private set; }

    protected override WebResponse GetWebResponse(WebRequest request)
    {
        var response = base.GetWebResponse(request);
        var httpResponse = response as HttpWebResponse;
        if (httpResponse != null)
        {
            using (var stream = httpResponse.GetResponseStream())
            {
                using (var ms = new MemoryStream())
                {
                    stream.CopyTo(ms);
                    Response = ms.ToArray();
                }
            }
        }
        return response;
    }
} 
```

# sql-server-2005 - 在 SQL Server 2005 中为表索引编写脚本时删除关系索引选项

> ID：1014937
> 
> 赞同：3
> 
> 时间：2009-06-18T20:12:59.873
> 
> 标签：sql-server-2005, smo

使用 Microsoft.SqlServer.Management.Smo.Scripter 对象，我为数据库中的每个表生成脚本，包括索引/约束。但是，当它生成脚本时，它包括所有索引选项，即使它们是默认值，例如，

```
CREATE TABLE [dbo].[AgeGroup](
   [AgeGroupID] [int] NOT NULL),
CONSTRAINT [PK_AgeGroup] PRIMARY KEY CLUSTERED 
(
   [AgeGroupID] ASC
) WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, 
       ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY], 
```

主键约束的 WITH 子句中的所有选项都设置为默认值（至少根据 SQL Server 联机丛书）。如何让 Scripter 对象*不*输出这些选项？

这是我的代码：

```
Server server = new Server("MYSERVER");

Scripter scripter = new Scripter(server);
scripter.Options.Indexes = true;
scripter.Options.AnsiPadding = true;
scripter.Options.AnsiFile = true;
scripter.Options.Permissions = true;
scripter.Options.ClusteredIndexes = true;
scripter.Options.DriAll = true;

Urn[] urns = new Urn[1];

Table t = server.Databases["MYDATABASE"].Tables["AgeGroup"];
urns[0] = t.Urn;

StringCollection sc = scripter.Script(urns);

using (StreamWriter sw = File.CreateText("AgeGroup.Table.sql"))
   foreach (string str in sc)
      sw.WriteLine(str); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-18T21:33:36.887

显然，没有脚本选项可以控制它。在 SMO.Scripting 中（即不受控制的）这样的事情比大多数人意识到的要多。例如，没有选项可以编写 ALTER 命令而不是 CREATES，即使 SSMS 为对象快速菜单修改项执行此操作。

在我见过的大多数情况下，通过扫描并替换有问题的文本，在我的代码中处理它是相当容易的。脚本编写器的输出格式非常严格，所以我什至不需要 RegEx 来执行此操作。因此，当您获得表对象的 CREATE 脚本时，我将搜索“ *) WITH (PAD_INDEX* ) ON”并将其替换为“ON”（确保您的通配符将跨越换行符）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T19:05:32.070

使用这个，你几乎可以得到你想要的：

private static Sc​​ripter CreateScripter(Server server)

```
{
    Scripter returnValue = new Scripter(server);
    returnValue.Options.TargetServerVersion = SqlServerVersion.Version90;
    returnValue.Options.TargetDatabaseEngineType = DatabaseEngineType.SqlAzureDatabase;
    returnValue.Options.NoTablePartitioningSchemes = true;
    returnValue.Options.NoFileGroup = true;
    return returnValue;
} 
```

结果是：

```
CREATE TABLE [dbo].[CacheData](
    [LastFileSystemUpdate] [uniqueidentifier] NOT NULL,
 CONSTRAINT [PK_CacheData] PRIMARY KEY CLUSTERED 
(
    [LastFileSystemUpdate] ASC
)WITH (STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF)
) 
```

# ms-access-2007 - MS Access 2007 和 SQL Server 2000

> ID：1014943
> 
> 赞同：1
> 
> 时间：2009-06-18T20:14:27.700
> 
> 标签：ms-access-2007

我最近升级到了 Office 2007。我有几个链接到 SQL Server 2000 数据库的 Access 数据库（出于多种原因，我一直保持 Access 2000 格式）。我经常使用这些数据库中的几十个查询。我每天都会创建新的查询，对数据进行排序、总结和一般分析。

自升级以来，一些查询需要很长时间才能完成（几分钟而不是几秒钟），而我尝试运行的一个新查询根本没有完成，我必须在 Access 上结束任务。这是一个相当简单的查询，它连接 3 个表，并对其中一个字段进行排序。我一直这样做，现在看来我做不到。

我搜索了类似问题的讨论，但没有看到具体的建议。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T21:04:55.803

我建议删除所有 ODBC 链接表并从头开始重新创建它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T12:58:44.527

我会在 SQL Server 2000 中使用 Access Data Projects。当你的 SQL 后端太旧时，它会很好用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-20T22:08:29.310

如果您的查询不需要对数据进行任何更改，您可能会发现将它们转换为 SQL Pass through 查询将大大加快它们的速度。请注意，这些查询不是通过 Jet DB 引擎解析的，而是直接发送到服务器并绕过任何链接表。

您将不得不使用 MS SQL 语法并丢失 QBE 网格，结果将是只读的。

如果您需要更新数据，那么存储过程可能是可行的方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-20T06:15:44.927

当我转换到 SQL Server 后端时，我使用了 SQL Server 迁移助手。我强烈推荐它。它非常擅长它的工作。

话虽如此，我假设您在 FE 中使用链接表。我通过从 Access 复制 SQL 来转换缓慢移动的查询，然后将其粘贴到 SQL Server Management Studio 上的“新查询”窗口中。然后，一次完成所有语法更改，我将查询转换为 T-SQL 并将其保存为与 Access 中的查询同名的视图。

我有一个小例程，然后将 Access 查询重命名为“Local_”，然后为 SQL Server 上的视图创建一个链接表条目。您会发现以前运行几分钟的查询会以这种方式运行几秒钟。当然，您可以手动执行此操作。

顺便说一句，SQL Server 迁移助手将转换许多查询（它不会尝试转换操作查询，仅选择查询......）而很少或没有干预。

# sharepoint - 锁定 InfoPath 模板

> ID：1014945
> 
> 赞同：1
> 
> 时间：2009-06-18T20:15:07.807
> 
> 标签：sharepoint, ms-office, infopath

有谁知道如何防止用户在设计模式下编辑 InfoPath 表单？用户在 SharePoint 中存储 InfoPath 表单，似乎任何人都可以在设计模式下编辑表单，我们需要能够将其锁定。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T20:41:45.850

阻止这种情况发生的唯一方法是将表单模板发布到他们无权访问的地方。我通常将它们发布到顶级站点的“表单模板库”；并以这种方式锁定访问权限。

编辑：为了澄清，用户无法打开以前保存的表单并以这种方式编辑模板。他们必须能够获得物理“表单模板”，这就是您必须锁定的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-08T05:26:36.403

有一个组策略项，您可以禁用设计按钮。

看看这个关于 infopath 2003 [Pashman 的 InfoPath Goldmine 的博客](http://blogs.msdn.com/timpash/archive/2006/02/08/Prevent-Design-Mode-For-Users.aspx)

对于信息路径 2003

```
User Configuration
   Administrative Templates
      Microsoft Office InfoPath 2003
         Miscellaneous
             Disable InfoPath Designer Mode 
```

对于 Infopath 2007
[Microsoft 安全技术中心](http://technet.microsoft.com/en-us/library/cc148230.aspx)
搜索：信息权限管理

```
User Configuration
    Administrative Templates
        Classic Administrative Templates (ADM)
            Microsoft Office InfoPath 2007
                Restricted Features 
```

# php - PHP 中的 json_decode 是否保证在返回数组时保留元素的顺序？

> ID：1014946
> 
> 赞同：8
> 
> 时间：2009-06-18T20:15:11.910
> 
> 标签：php, json, sorting

您可以将布尔值传递给 json_decode 以返回数组而不是对象

```
json_decode('{"foo", "bar", "baz"}', true);  // array(0 => 'foo', 1 => 'bar', 2 => 'baz') 
```

我的问题是这个。在解析对象文字时，这是否保证项目的顺序将被保留？我知道 JSON 对象属性没有排序，但 PHP 数组是排序的。我在 PHP 手册中找不到明确解决此问题的任何地方。在谨慎方面犯错可能是值得的，但如果可能的话，我想避免包含某种“索引”子属性。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-18T20:19:28.220

在这种情况下，在将 JSON 传递给 PHP 时使用数组不是更有意义吗？如果 JSON 中没有任何对象键（在 PHP 中成为关联数组键），只需将其作为数组发送。这样您就可以保证它们在 PHP 中的顺序与在 javascript 中的顺序相同。

```
json_decode('{["foo", "bar", "baz"]}');
json_decode('["foo", "bar", "baz"]'); //I think this would work 
```

如果您需要关联数组（这就是您将第二个参数作为 传递的原因`true`），您将不得不想出一些方法来在传递时保持它们的顺序。在将结果数组解码为您想要的格式后，您将不得不对结果数组进行一些后处理。

```
$json = '{[ {"key" : "val"}, {"key" : "val"} ]}';
json_decode($json, true); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T20:22:18.527

我曾经使用过 json_decode() 几次，并且 PHP 客户端应用程序的结果顺序保持不变。但是以 Python 为例，它不会保留顺序。

一种让人放心的方法是用多个示例对其进行测试。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-18T20:34:20.610

就个人而言，我从不相信任何系统会返回确切的订单，除非该订单是明确定义的。如果您确实需要订单，请使用字典，即二维数组，并为列表中的每个值分配一个位置值 (0,1,2,3...)。

如果您将此规则应用于所有内容，您将永远不必担心该数组的交付/存储，无论是 XML、JSON 还是数据库。

请记住，仅仅因为某些事情以某种方式发生，并不意味着它是故意这样做的。这类似于认为数据库中的行有顺序，而实际上它们没有顺序，除非您使用 ORDER BY 子句。在 SELECT 中认为 ID 1 总是在 ID 2 之前是不安全的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-18T21:43:46.943

缺少明确的声明，我会说，根据定义，不会保留任何明确的顺序。

我的主要想法是，这将保留什么顺序？json_decode 函数将*javascript 对象文字的字符串表示形式*作为参数，然后返回对象或数组。函数的输入（作为字符串的对象文字）没有明确的顺序，这意味着 json_decode 函数没有明确的顺序来维护。

# wpf - WPF，Prism v2，模式对话框中的区域，在代码后面添加区域

> ID：1014948
> 
> 赞同：12
> 
> 时间：2009-06-18T20:15:25.077
> 
> 标签：wpf, prism, composite

我有一个复合 WPF 应用程序。在我的一个模块中，我想制作一个向导并将步骤显示在一个区域中，以便我可以更轻松地在步骤之间切换。最初我让这个向导出现在选项卡区域中，并且嵌套区域运行良好。现在我想把它变成一个模态对话框，但是在我打开它之后，内部区域永远不会被区域管理器注册；所以我不能添加我的向导步骤。

我的印象是区域经理是全球性的，只需添加 cal:RegionManager.RegionName="WizardSteps" 就可以了，但显然不是。

如果我将区域管理器传递给视图，我也许可以使用它...有谁知道如何在后面的代码中将区域添加到 ContentControl？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-06-19T17:05:51.140

问题是区域在可视化树中搜索 RegionManager 附加属性，然后向该管理器注册自己。在主窗口中很好，但在子窗口中不会发生这种情况。

在 Bootstrapper 中，创建 shell 后，执行以下代码。

```
RegionManager.SetRegionManager(shell, this.Container.Resolve<IRegionManager>());
RegionManager.UpdateRegions(); 
```

要让区域管理器与您的子窗口一起工作，请在创建窗口后立即执行相同的操作。

编辑

要设置控件的区域名称，您还需要设置 RegionManager 的附加属性，如下所示...

```
RegionManager.SetRegionName(control, "MyRegion"); 
```

但是，您也可以在 xaml 中执行此操作。单独窗口中的区域不起作用的原因是需要在基本窗口上设置 RegionManager，就像我在上面展示的那样。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2010-03-30T07:03:43.287

其实很简单。

在您的弹出 xaml 中添加一个区域名称，就像您在 shell 中所做的那样。然后在弹出窗口构造函数中，添加以下调用：

```
public Popup(IRegionManager regionManager)
{
     InitializeComponent();
     RegionManager.SetRegionManager(this,regionManager);
} 
```

这在 Prism v.1 中对我有用——在以后的版本中应该不会有太大的不同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-22T15:32:55.657

我发现了一些几乎可以工作的东西。我确定如果我可以将该区域的活动视图绑定到 contentContol 的内容属性，那么它会起作用，但我还没有做到这一点。

```
IRegionManager MyRegionManager = container.Resolve<IRegionManager>();
SingleActiveRegion newRegion = new SingleActiveRegion();
MyRegionManager.Regions.Add("WizardSteps", newRegion);

//Binding
Binding myBinding = new Binding("ActiveViews");
myBinding.Source = newRegion;
view.stepControl.SetBinding(ContentControl.ContentProperty, myBinding); 
```

# javascript - Extjs 表单验证

> ID：1014949
> 
> 赞同：3
> 
> 时间：2009-06-18T20:15:39.413
> 
> 标签：javascript, extjs

我正在使用 Extjs Ext.form.FormPanel 创建一个表单，其中将包含一些字段，如姓名、公司、...等。其中的字段将是邮政编码和电话号码，我们以邮政编码为例，邮政编码可以是 5 个数字或 5 个数字加 4 个字符，我不想为邮政编码创建两个单独的字段，有没有这样我就可以创建一个字段并防止用户错误地输入邮政编码，就像下面的 jQuery 插件一样：

[http://digitalbush.com/projects/masked-input-plugin/](http://digitalbush.com/projects/masked-input-plugin/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-18T20:16:54.513

ExtJS 有[vtypes](http://www.extjs.com/deploy/dev/examples/form/adv-vtypes.html)，可以让你编写验证代码。

**更简单：** `TextField` s 具有`regex`强制匹配验证的配置选项。您的正则表达式可以是（假设空格分隔符然后仅 az，不区分大小写）：

```
/^\d{5}(? [a-z]{4})?$/i 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T20:35:45.083

如果您的意图是接受 ZIP 或 ZIP+4，则正则表达式格式应如下所示：

```
/^\d{5}(?-\d{4})?$ 
```

可选的分隔符应该是破折号，四个“字符”应该始终是数字。

# architecture - 构建文档管理系统的思路

> ID：1014952
> 
> 赞同：4
> 
> 时间：2009-06-18T20:16:00.770
> 
> 标签：architecture, scalability

客户需要一个[文档管理系统](http://en.wikipedia.org/wiki/Document_management_system)，我正在构建有关此的信息。

我知道 sharepoint 和 alfresco，但在这种情况下，我正在评估从头开始构建它的必要信息，所以请不要建议使用其中任何一个（我们正在单独对它们进行评估，这都是关于开发，不实施现有的解决方案）。

这是要求：

*   对特定于我们当地政府的文件的法律管理有非常具体的要求，但除此之外：
*   从最终用户的角度来看，类似于 google docs 的操作
*   需要来自 200 + 最终用户的商店信息（更新：真的是 +700 最终用户）
*   主要是办公文件，pdf，文本。我已经从这个二进制文件中提取了纯文本。
*   没有wiki，没有门户创建，几乎没有工作流程但非常简单，只是文件管理
*   中央存储库，全公司共享，与 Active Directory 集成
*   快速搜索
*   透明桌面集成
*   网页界面
*   多平台，如果可能的话

所以，这就是我头顶上的事情：

*   存储：我知道共享点将所有内容都保存在数据库中（Alfresco 也是？）。这是一场噩梦，恕我直言。我更喜欢将元数据放在数据库中，并将文件放在磁盘上。

我考虑在这种情况下强制使用 ZFS，并利用它们的版本控制、快照和扩展功能。或者也许使用 git 作为存储后端（git 可以正常工作吗？）

那么，我在哪里可以了解更多关于如何在 ZFS 或任何常规文件系统中处理大量文档的信息？例如，如何布局文件夹结构以易于管理和快速响应，轻松备份等。

*   元数据：我认为这里是常规数据库，但想知道是否有更多优点可以保存 Lucene 中的所有内容（我对 Lucene 有一些经验，但担心因为 Lucene 不能被联合起来，对吗？）。

如果我使用搜索引擎作为元数据数据库，我可以节省一些工作（不需要第二遍进行索引），但常规数据库引擎更标准。

*   技术：我可能会在 Django、PyLucene、Postgress 中构建它，并为 windows 进行 shell 集成（我没有这样做的问题）。

我将了解如何正确实施此解决方案的任何提示或信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T04:48:34.150

恕我直言，我个人觉得“类似于 Google Docs”和“透明桌面集成”的要求有点模糊。但从问题来看，您更关心后端和文档存储，更关注使用更开源的堆栈（与 AD 集成）？

无论如何，我个人使用[KnowledgeTree](http://www.knowledgetree.com/)作为我们的文档管理系统，它们的实现是所有文件都驻留在文件目录中，数据库将跟踪路径、相应的元数据、访问日志和版本信息。如果文档已更新，他们基本上会保留同一文件的多个版本 - 我认为考虑到 Microsoft Office 文档主要是二进制文件（直到 2003 年），这是一个足够公平的想法实施方式。

您可能想了解他们目前拥有多少文档，以及他们希望每天有多少文档流入该系统。（或者从不同的角度来看，他们计划存储什么样的文档通常会给您提示您的服务器应该处理什么样的负载）

我的猜测是，除非您确定系统每天要处理大量的文档（想象一下 Flickr 的文档； ））。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T20:27:35.473

1.  SharePoint 和 Alfresco 是您可以进行大量自定义的平台，因此即使使用它们也确实意味着您正在构建一些东西。

2.  SharePoint 默认将 blob 存储在数据库中，[但有办法将它们放在文件系统上](http://www.atalasoft.com/cs/blogs/loufranco/archive/2009/04/28/document-storage-database-blobs-or-the-filesystem.aspx)

3.  如果您自己制作，请支持 Office 应用程序用来与 SharePoint 和 Alfresco 通信的首页扩展，并提供带有正确标题的文档，告诉 IE 启动应用程序。通过这种方式，您可以获得与 SharePoint 所具有的 Office 应用程序相同的集成（用户非常喜欢此功能）——它只是一个简单的 HTTP 协议

4.  如果您使用 SharePoint，我的公司将其作为[免费的文档预览](http://vizitsp.com)器，可以查看 PDF，并且很快将拥有 Office 文档。我们出售底层技术，但仅限于 Windows。

5.  我喜欢 Django，并将它用于所有个人项目，但我真的认为 .NET 和 Java 将为你需要的东西提供更多第三方支持，如果你决定去的话，你的大部分代码都可以移植到 SharePoint 或 Alfresco以后那样。

**编辑**：根据要求提供有关#3的更多信息

[http://blogs.msdn.com/mikefitz/archive/2005/03/14/395112.aspx](http://blogs.msdn.com/mikefitz/archive/2005/03/14/395112.aspx) [http://blogs.msdn.com/stcheng/archive/2008/12/17/wss-use-rpc-protocol -to-access-wss-v3-site.aspx](http://blogs.msdn.com/stcheng/archive/2008/12/17/wss-use-rpc-protocol-to-access-wss-v3-site.aspx) 官方文档：http: [//msdn.microsoft.com/en-us/library/ms442469.aspx](http://msdn.microsoft.com/en-us/library/ms442469.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-06T19:30:17.973

Alfresco 在这里应该是一个很好的解决方案。它支持你的要求列表中的每一个，除了政府的东西。

但是，如果您是“从头开始”构建，至少可以从中汲取灵感？

存储：文件内容保存在文件系统中。易于管理、存储、备份等。这些文件不保留名称，只是它们的内容以二进制格式保存，文件被命名为散列（我猜是内容的散列？）

元数据：放置在数据库中。快速访问，更改，更新和东西。每个节点都有属性——名称、标题、描述、日期、审计信息，无论你需要什么。它只是信息，它都保存在“属性”表中。

搜索：Alfresco 使用 Solr 进行搜索，以前是 Lucene。我有相当大的安装，如果你把 lucene index 放在 SSD 上，它的速度非常快。（无论如何，lucene 很快）。它同时索引文件内容和属性——因此您可以非常快速地获得节点 ID。

Alfresco 实现了 CIFS，以及 webdav、ftp 等。关键是，您可以将其作为文件夹或磁盘安装到用户的桌面上。

Web 界面在那里，中央 repo mgmt 在那里，所有的要求。而且由于它是开源的，您可以获取其中的一些源并在您的项目中使用它。尽管如果您感觉还好，加入 Alfresco 社区并回馈一点会更好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-04-30T07:48:42.590

您是否正在尝试构建文档管理系统？露天和 SharePoint？Alfresco & SharePoint 是项目管理解决方案，而不是文档管理解决方案。Alfresco 是某种 DMS 解决方案，但不是很好。是的！对于项目管理解决方案，它是一个很好的软件。

我建议你购买文件管理解决方案，它是对文件的合法管理，也是当地政府特有的。有一些文档管理系统提供商，例如 Laserfiche 和 OnBase，他们的工作类似于 Google Docs。您可以为公司或企业的每个员工创建一个帐户。

是的，所有文件都是 MS Office 格式，例如 Ms-Word、Ms-excel、PDF 和 PPT

**文档管理系统的工作流程非常高效且易于处理**

是的，通过使用 DMS，您可以在几分钟内轻松找到文件（Laserfiche 软件需要 10 分钟来提取文件或文件夹） Laserfiche DMs 是 Web 界面软件。您可以登录软件并轻松从不同位置访问文件或文件夹

**贮存**

在 DMS 系统中，所有数据都受到保护并存储在云存储中。您只需登录您的帐户即可轻松访问文档。如果丢失或任何畸形，您可以从公司获取丢失的数据。

**元数据**

DMs 系统是常规的数据库引擎，因为所有业务数据都定期保存在云存储中

**科技**

无需构建任何东西；您只需要购买 DMS 软件。我向您推荐 Laserfiche，因为我们正在使用他们的服务

# apache-flex - 等待 Flex 效果完成

> ID：1014968
> 
> 赞同：1
> 
> 时间：2009-06-18T20:18:33.887
> 
> 标签：apache-flex, actionscript-3

我是一名 Flex 新手，负责增强现有应用程序。其中一项改进是让当前显示时间的字段在显示时间和日期之间平滑地来回淡化。

我知道这样做的正确方法是将字体文件嵌入到应用程序中，这样我就可以直接淡入淡出标签。如果可以的话，我会尽量避免这种情况，因为我更愿意让我的更改尽可能不引人注目。

我想出了一个我认为合理的解决方法：创建一个“隐私屏幕”，恰好是时钟背景的确切大小、形状和颜色；将其 alpha 初始化为 0；然后在更改时间/日期时，淡入隐私屏幕，进行更改，然后再次淡出屏幕。

代码看起来像这样：

```
 var targets:Array = new Array();
    targets.push(this.privacyScreen);
    this.effectFadeIn.play(targets);
    this.mylabel.text = "I am a date and/or time";
    this.effectFadeOut.play(targets); 
```

...关键组件如下所示：

```
 <mx:Label text="" id="mylabel" width="100%" height="100%" x="0" y="0" color="0xff0000"/>
<mx:Canvas id="privacyScreen" width="100%" height="100%" x="0" y="0" alpha="1" backgroundColor="{myConfiguration.backgroundColor}"/>
<mx:Fade id="effectFadeIn" alphaFrom="0.0" alphaTo="1.0" duration="250"/>
<mx:Fade id="effectFadeOut" alphaFrom="1.0" alphaTo="0.0" duration="250"/> 
```

我确信经验丰富的 Flex 设计师已经知道，这段代码是由美味的鲜榨**FAIL 制成的。** 执行将等待淡入效果完成的基本假设是错误的，并且淡出效果在淡入仍在进行时显然被忽略了。

所以我想我有两个相关的问题：

1.  在等待效果运行完成时是否可以暂停执行？
2.  这种方法是否可行，或者它只是从上到下都在做错事？

我提前感谢任何人可以提供的任何见解。

（我提前承认，我越是尝试通过实践来学习这一点，我就越意识到我需要利用一些在线[培训](http://www.adobe.com/devnet/flex/videotraining/) [资源](http://joshblog.net/2007/04/05/ten-ways-beginners-can-learn-adobe-flex/)。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T21:33:02.317

我只是玩了一下你的代码，这是你要找的吗？

```
<?xml version="1.0" encoding="utf-8"?>
<mx:WindowedApplication xmlns:mx="http://www.adobe.com/2006/mxml"
    layout="absolute"
    creationComplete="onComplete();">

    <mx:Script>
        <![CDATA[
            private var targets:Array = new Array();
            private function onComplete():void {
                targets.push(canv);
                effectFadeOut.play(targets);
            }
            private function onFadeInEnd():void {
                effectFadeOut.play(targets);
            }
            private function onFadeOutEnd():void {
                effectFadeIn.play(targets);
            }
        ]]>
    </mx:Script>

    <mx:Label text="{(new Date()).toString()}" id="lbl" x="0" y="0" color="0xff0000"/>
    <mx:Canvas id="canv" width="100%" height="{lbl.height+5}" x="0" y="0" backgroundColor="#000000"/>

    <mx:Fade id="effectFadeIn" alphaFrom="0.0" alphaTo="1.0" duration="250"
        effectEnd="onFadeInEnd();" />
    <mx:Fade id="effectFadeOut" alphaFrom="1.0" alphaTo="0.0" duration="250"
        effectEnd="onFadeOutEnd();" />

</mx:WindowedApplication> 
```

希望有帮助:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T20:43:02.353

您的代码*在*标签消失时执行。this.effectFadeIn.play() 不会等待它完成。我会在稍后需要调用的代码行中添加一个 setTimeout 调用，或者更好的是，将它们放在另一个函数中。然后，在一定间隔后再次调用该函数。

```
import flash.utils.*;

private function FadeIn () : void {
    var targets:Array = new Array();
    targets.push(this.privacyScreen);
    this.effectFadeIn.play(targets);
    this.mylabel.text = "I am a date and/or time";
    setTimeout (function (): void {FadeOut (targets);}, effectFadeIn.duration); // Function and duration
}
private function FadeOut (targets : Array) : void {
    this.effectFadeOut.play(targets);
    setTimeout (FadeIn (), this.effectFadeOut.duration;
} 
```

我很确定这应该工作......

# ruby - 使用 ruby 查找 json 错误

> ID：1014969
> 
> 赞同：2
> 
> 时间：2009-06-18T20:18:39.127
> 
> 标签：ruby, json, validation

我正在使用 ruby​​ gems json_pure，当我遇到解析错误时，我无法确定发生错误的行号。我期待找到一个用 ruby​​ 编写的验证器，它会告诉我行号。快速查找 json 错误的最佳 ruby​​ 方法是什么？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-01-16T20:30:22.240

你可以试试 Kwalify：[http ://www.kuwata-lab.com/kwalify/ruby/users-guide.html](http://www.kuwata-lab.com/kwalify/ruby/users-guide.html)

它不仅仅是一个 JSON/YAML 验证器，而是你给它一个模式，它会根据它进行验证。

您可以使用它来验证您的配置文件是否正确（根据您对“正确”的定义）以及正确的 JSON（或 YAML），它会告诉您错误发生的行号以及一些上下文对于错误也是如此。

我从他们文档中的示例中删除了一个“]”，它给我的错误消息是

```
ERROR: document12a.json:10:1 [/favorite] flow sequence is not closed by ']'. 
```

如果需要，它还可以生成数据绑定类。它似乎是一个非常好的配置管理/验证工具。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-01-14T15:54:17.723

[您可能会发现使用http://www.jsonlint.com/](http://www.jsonlint.com/)来检查 JSON 是否有效更容易- 它会突出显示任何有问题的行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-04-04T15:23:04.587

这是一个老问题，但在当前的 Ruby 中仍然是一个问题。

Ruby 中的默认 JSON 解析器不会告诉您发生解析错误的行号和/或列号。只是“解析”错误，就是这样。

您可以将解析器更改为[Oj](https://github.com/ohler55/oj)并与[MultiJson](https://github.com/intridea/multi_json) gem 一起使用。oj很棒，速度非常快，而且会显示解析错误发生的行甚至列号！伟大的。

一行非常大的 JSON (170KB+) 的示例错误，Oj 将给出列 102421。

```
.../adapters/oj.rb:15:in `load': unexpected character at line 1, column 102421 [parse.c:666] (MultiJson::ParseError) 
```

* * *

## 回答 #4

> 赞同：-4
> 
> 时间：2009-06-18T20:28:37.563

JSON is supposed to be sent over the network as a string, so there's actually only one line.

# vb.net - 自定义代码进入标准 DotNetNuke 登录？

> ID：1014985
> 
> 赞同：0
> 
> 时间：2009-06-18T20:21:56.763
> 
> 标签：vb.net, login, dotnetnuke, login-control

我在哪里可以找到处理 DNN 登录的函数？我想为登录添加自定义功能，但在 Login.ascx.vb 中看不到该功能（除非我错过了）。

有一个标签和一个构成登录的标签。我认为其中一个具有实际的“登录”按钮，但我似乎无法弄清楚它们来自哪里。

据我所知，这是登录所在的位置

```
 <DNN:DNNTabStrip 
                ID="tsLogin" 
                runat="server" 
                TabRenderMode="All"
                CssTabContainer="LoginTabGroup"
                CssContentContainer="LoginContainerGroup" 
                DefaultContainerCssClass="LoginContainer"
                DefaultLabel-CssClass="LoginTab"
                DefaultLabel-CssClassHover="LoginTabHover"
                DefaultLabel-CssClassSelected="LoginTabSelected" 
                visible="false" />
            <asp:Panel ID="pnlLoginContainer" runat="server" style="text-align:left" CssClass="LoginPanel" Visible="false" /> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T18:57:08.747

查看 /desktopmodules/AuthenticationServices 目录。开箱即用的登录控件应该来自 DNN/Login.ascx。

您应该能够将用户控件添加到该文件。

# asp.net-mvc - 如何在我的 MVC 项目的代码隐藏中访问服务器端控件？

> ID：1014987
> 
> 赞同：5
> 
> 时间：2009-06-18T20:22:16.623
> 
> 标签：asp.net-mvc, asp.net-mvc-routing, code-behind

首先让我声明，我知道在我的视图中访问服务器端控件在 MVC 中是不受欢迎的。但是，我需要在我的情况下（据我所知）。这是我的故事。:)

我在我的 Web 应用程序中使用了第 3 方控件。我目前的任务是将我们的 WebForms 解决方案移植到 MVC。这个特定的第三方 Web 控件需要 WebForms 架构，所以我希望只使用我的 WebForms 项目中的相同代码。

我[最初的方法](https://stackoverflow.com/questions/1008712/how-to-configure-and-debug-a-web-application-using-mvc-and-webforms)是创建两个网站（一个 WebForms 站点和一个 MVC 站点），然后使用 MVC 端的 iFrame 将这两个站点链接起来。虽然我知道这会起作用，但仅仅使用这个特定的控件有点过头了。在做了更多研究之后，我[发现](http://www.hanselman.com/blog/PlugInHybridsASPNETWebFormsAndASPMVCAndASPNETDynamicDataSideBySide.aspx)我可以“混合男孩”并在 MVC 项目中使用 WebForms 架构。因此，我采用的新方法是*仅*将使用此 3rd 方控件的页面复制到特定目录（即“View\SomeDir\WebForms”），然后在我的 global.asax 文件中忽略该目录，所以MVC 路由系统没有拾取它：

```
routes.IgnoreRoute("View\SomeDir\WebForms\{*pathInfo}"); 
```

不幸的是，当我将 ASPX 页面复制到我的 MVC 项目时，我发现 CodeBehind 并没有授予我对页面上的控件的访问权限。这是设置的方式：

```
<%@ Register 
  Assembly="..." 
  Namespace="..." 
  TagPrefix="custom" %>

<custom:SomeControl ID="customControl" runat="server" /> 
```

这是我背后的代码的样子：

```
public class MyPage : Page
{
  protected void Page_Load(object sender, EventArgs args)
  {
     Debug.WriteLine(customControl.ID); // <-- COMPILE ERROR: Cannot resolve symbol 'customControl'
  }
} 
```

不幸的是，我的项目甚至无法编译，因为我的 CodeBehind 中的每个控件都出现此错误。将其他控件（即标签、面板、文本框等）转换为客户端标签不是问题，但我需要在我的代码中访问此自定义控件，以便我可以收听它（服务器端) 事件并作出相应响应；基本的 WebForms 东西...

我想要做的甚至可能吗？我想到的另一种方法`might`是在控制器类中初始化和捕获服务器端事件。但是，我想避免在视图中序列化控件的状态，只是将其传递给控制器​​并在可能的情况下返回？

提前感谢您的任何建议！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-18T20:41:37.410

碉堡了！！我在发布此内容 10 分钟后找到了解决方案。

解决方法是右键单击我的项目并说“转换为 Web 应用程序”并将我的 CodeBehind 类更改回“部分”。我的所有控件现在都可以通过后面的代码访问。

感谢您的阅读，我希望我的问题/答案有一天会对其他人有所帮助。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T20:43:35.800

我不认为将某些东西移植到 MVC 只是为了将其中的一半保留在传统的 WebForms 中。

这种方法意味着任何未来的开发人员都需要熟悉这两种技术，并且在我看来并不干净。

我会选择其中一个，并尽量避免将两者混合。

# sql-server - 在数据仓库场景中使用 WITH(NOLOCK) 有什么缺点吗

> ID：1014993
> 
> 赞同：8
> 
> 时间：2009-06-18T20:22:49.900
> 
> 标签：sql-server, sql-server-2005, data-warehouse, nolock

我有一个 Kimball 风格的 DW（星型模型中的事实和维度 - 没有迟到的事实行或列，除了作为类型 2 缓慢变化维度的一部分过期外，没有列的维度发生变化），每天处理繁重的插入和更新行（新日期）以及每月和每日报告流程。事实表按日期分区，以便于旧数据的滚降。

我理解这`WITH(NOLOCK)`可能会导致读取未提交的数据，但是，我也不希望创建任何会导致 ETL 进程失败或阻塞的锁。

在所有情况下，当我们从 DW 中读取数据时，我们正在从事实表中读取一个不会更改的日期（事实表按日期分区）和维度表，这些数据表的属性不会因为它们链接到的事实而发生变化.

那么 - 有什么缺点吗？- 可能在执行计划或此类操作中`SELECT`- 仅在同一张表上并行运行的查询。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-19T02:58:23.033

这可能是您需要的：

`ALTER DATABASE AdventureWorks SET READ_COMMITTED_SNAPSHOT ON;

ALTER DATABASE AdventureWorks SET ALLOW_SNAPSHOT_ISOLATION ON；`

然后继续使用

`SET TRANSACTION ISOLATION LEVEL READ COMMITTED`

在您的查询中。根据 BOL：

READ COMMITTED 的行为取决于 READ_COMMITTED_SNAPSHOT 数据库选项的设置：

如果 READ_COMMITTED_SNAPSHOT 设置为 OFF（默认值），则数据库引擎使用共享锁来防止其他事务在当前事务正在运行读取操作时修改行。共享锁还阻止语句读取其他事务修改的行，直到其他事务完成。共享锁类型决定何时释放。在处理下一行之前释放行锁。读取下一页时释放页锁，语句完成时释放表锁。

如果 READ_COMMITTED_SNAPSHOT 设置为 ON，则数据库引擎使用行版本控制为每个语句提供数据的事务一致快照，因为它在语句开始时就存在。锁不用于保护数据不被其他事务更新。

希望这有帮助。拉吉

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-18T20:24:55.497

只要都是无更新数据就没有害处，但如果有很多好处，我会感到惊讶。我会说值得一试。最糟糕的情况是，如果您处于批量插入的中间，您将获得不完整和/或不一致的数据，但您可以决定这是否会使任何有用的东西失效。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-19T10:06:09.657

您是否考虑过为您的 DW 创建一个[DATABASE SNAPSHOT](http://msdn.microsoft.com/en-us/library/ms175158.aspx)并运行您的报告？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-18T23:11:23.973

是的。您的 SQL 的可读性将大大降低。您将不可避免地错过一些 NOLOCK 提示，因为使用 NOLOCK 策略的 SQL SELECT 命令必须把它放在所有地方。

[你可以通过设置隔离级别得到同样的东西](http://www.eggheadcafe.com/conversation.aspx?messageid=32492891&threadid=32492864)

[设置事务隔离级别读取未提交](http://msdn.microsoft.com/en-us/library/aa259216(SQL.80).aspx)

最后你得到了 10% 的性能提升（对不起，我太懒了，也懒得去查这篇文章，但它就在那里）

我会说 10% 的收益不值得降低可读性。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-19T00:03:03.590

如果使整个数据库只读是可能的，那么这是一个更好的选择。您将获得未提交的读取性能，而无需修改所有代码。

```
ALTER DATABASE adventureworks SET read_only 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-07-16T17:10:09.957

NOLOCK 执行“脏读”（不雅读 READ UNCOMMITTED 与 NOLOCK 做同样的事情）。如果数据库在您阅读时正在更新，那么您可能会收到不一致的数据。唯一的选择是要么接受锁定并因此阻塞，要么选择[此处讨论](http://www.codefromasmallisland.com/2009/07/painting-consistent-picture-from-moving.html)的 SQL 2005 及更高版本中提供的两个新隔离级别之一。

# iphone - UITextField 焦点

> ID：1014999
> 
> 赞同：63
> 
> 时间：2009-06-18T20:23:38.570
> 
> 标签：iphone, textinput

如何以编程方式将焦点分配给视图中的特定 UITextField？我有几个字段并且在视图显示中，我想将光标放在特定字段上，而不是顶部的第一个字段。

* * *

## 回答 #1

> 赞同：149
> 
> 时间：2009-06-18T20:26:07.147

尝试这样做`viewWillAppear:`

```
[desiredField becomeFirstResponder]; 
```

通过使该字段成为第一响应者，它具有焦点并且将显示键盘。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-18T20:26:11.827

将视图的第一响应者设置为文本字段。这可以在 IB 中完成。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-05-04T11:55:12.937

迅速：

```
desiredField.becomeFirstResponder() 
```