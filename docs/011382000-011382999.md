# StackOverflow 问答 11382000-11382999

# magento - 如何使magento搜索仅返回magento multistore网站中特定商店的产品？

> ID：11382001
> 
> 赞同：2
> 
> 时间：2012-07-08T09:20:44.030
> 
> 标签：magento, search

我有一家 magento 多店。当我在商店 A 中搜索产品时，它会返回商店 B 的产品。在商店 A 中进行搜索时，如何限制搜索仅返回商店 A 的产品？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T20:43:49.047

You can also setup different folders for your stores to seperate them more:

e.g.:

```
de-de/
de-en/
ch-de/
ch-fr/ 
```

put in each folder the "errors" folder and the index.php. Edit the index.php and add at the end:

```
Mage::run('chde','store'); 
```

sure, depending on your whole store configuration.

In each template use either the `<base href>` or prepend any link with Mage::getBaseUrl()

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T06:55:58.073

如果您询问 php 代码实现，请查看下面的示例

```
//create product collection
$collection = Mage::getResourceModel('catalog/product_collection'); 
//.... //add necessary filters, conditionas, etc

$collection->addStoreFilter(); // add current store filter to products collection 
```

# c# - 从委托构造委托。新的代表指向什么？

> ID：11382002
> 
> 赞同：3
> 
> 时间：2012-07-08T09:20:48.367
> 
> 标签：c#, reference, delegates, deep-copy, shallow-copy

考虑以下：

```
Action<int, T> a1 = new Action<int, T>(_insert);

Action<int, T> a2 = new Action<int, T>(a1); 
```

a2 指的是什么？它是 a1，a1 的浅拷贝还是 a1 的深拷贝？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-08T09:29:24.557

`a2`正在引用`a1`. 这是IL：

```
.method private hidebysig static void Main() cil managed
{
    .entrypoint
    .maxstack 3
    .locals init (
        [0] class [mscorlib]System.Action a1,
        [1] class [mscorlib]System.Action a2)
    L_0000: nop 
    L_0001: ldnull 
    L_0002: ldftn void WebTools.ConsoleTest.Program::Main()
    L_0008: newobj instance void [mscorlib]System.Action::.ctor(object, native int)
    L_000d: stloc.0 
    L_000e: ldloc.0 
    L_000f: ldftn instance void [mscorlib]System.Action::Invoke() #1
    L_0015: newobj instance void [mscorlib]System.Action::.ctor(object, native int)
    L_001a: stloc.1 
    L_0020: nop 
    L_0021: ret 
} 
```

在 #1 处，IL 代码引用`a1`了 Invoke 方法和实例`a1`本身。

浅拷贝意味着复制了 的内容`a1`，但没有复制任何内容。该对象`a1`被视为黑盒。因此相对于GC`a2`会保持存活。`a1`

# java - android中的java.lang.NoClassDefFoundError

> ID：11382005
> 
> 赞同：1
> 
> 时间：2012-07-08T09:21:06.760
> 
> 标签：java, android, classnotfoundexception

我是 Android 开发的新手。我正在从事一个涉及使用存根进行 Web 服务的项目。当我尝试使用它时，我收到以下错误：

![在此处输入图像描述](../Images/9d80f25c09cf91089e61c115b7875f26.png)

我在这里被困了一个星期，所以非常感谢一些帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T10:08:22.510

您在项目中使用的包含的库似乎存在一些打包或部署问题。`Java Virtual Machine`当或`ClassLoader`实例尝试加载类的定义但无法在任何地方找到它时，将引发此错误。在大多数情况下，当您的项目配置出现问题时会发生这种情况，但我无法从提供的信息中分辨出什么。一个解决方案是从头开始配置您的项目，因为大多数时候这比查找导致问题的原因更容易。另外，如果您有旧版本的(<17)[这个 SO question](https://stackoverflow.com/questions/9870995/android-java-lang-noclassdeffounderror)`ADT`的答案可能有用。最后，如果您要导入任何 javax 库（或其中包含 javax 组件的库），这可能是您问题的根源，因为 Adroid 不支持 javax 库。

# java - 如何创建只有 2 列的简单数据库并在 Android 中使用？（使用 SQLiteOpenHelper）

> ID：11382014
> 
> 赞同：0
> 
> 时间：2012-07-08T09:22:54.537
> 
> 标签：java, android, sqlite

好吧，我在下面有一些代码，但我真的不知道它是如何工作的以及如何填充它。我需要用大约 3 万个元素填充它。

```
public class DatabaseHelper extends SQLiteOpenHelper {
 static final String dbName="demoDB";

 static final String quoteTable="Quote";
 static final String quoteID="ID";
 static final String quoteText="Quote";

 static final String viewEmps="ViewEmps";

 public DatabaseHelper(Context context) {
      super(context, dbName, null,33);
      }

public void onCreate(SQLiteDatabase db) {

    db.execSQL("CREATE TABLE "+quoteTable+" ("+
    quoteID+ " INTEGER PRIMARY KEY , "+
            quoteText+ " TEXT)");

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T09:39:17.393

查看这三个有用的教程：

*   [在沃杰拉](http://www.vogella.com/articles/AndroidSQLite/article.html)
*   [在代码项目上](http://www.codeproject.com/Articles/119293/Using-SQLite-Database-with-Android)
*   [在 androidhive 上](http://www.androidhive.info/2011/11/android-sqlite-database-tutorial/)

# android - 应用程序每次都在android中停止

> ID：11382020
> 
> 赞同：0
> 
> 时间：2012-07-08T09:23:39.943
> 
> 标签：android, android-emulator

当我启动我的应用程序时，我总是收到此消息：“不幸的是，'sql' 已停止”。这是我的 logcat 显示的内容：

```
 07-12 10:53:33.607: E/AndroidRuntime(940): FATAL EXCEPTION: main
    07-12 10:53:33.607: E/AndroidRuntime(940): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.formation.sql/com.formation.sql.Main}: java.lang.IllegalArgumentException: column '_id' does not exist
    07-12 10:53:33.607: E/AndroidRuntime(940):  at  android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1956)
    07-12 10:53:33.607: E/AndroidRuntime(940):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1981)
    07-12 10:53:33.607: E/AndroidRuntime(940):  at android.app.ActivityThread.access$600(ActivityThread.java:123)
    07-12 10:53:33.607: E/AndroidRuntime(940):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1147)
    07-12 10:53:33.607: E/AndroidRuntime(940):  at android.os.Handler.dispatchMessage(Handler.java:99)
    07-12 10:53:33.607: E/AndroidRuntime(940):  at android.os.Looper.loop(Looper.java:137)
    07-12 10:53:33.607: E/AndroidRuntime(940):  at android.app.ActivityThread.main(ActivityThread.java:4424)
    07-12 10:53:33.607: E/AndroidRuntime(940):  at java.lang.reflect.Method.invokeNative(Native Method)
    07-12 10:53:33.607: E/AndroidRuntime(940):  at java.lang.reflect.Method.invoke(Method.java:511)
    07-12 10:53:33.607: E/AndroidRuntime(940):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
    07-12 10:53:33.607: E/AndroidRuntime(940):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
    07-12 10:53:33.607: E/AndroidRuntime(940):  at dalvik.system.NativeStart.main(Native Method)
    07-12 10:53:33.607: E/AndroidRuntime(940): Caused by: java.lang.IllegalArgumentException: column '_id' does not exist
    07-12 10:53:33.607: E/AndroidRuntime(940):  at android.database.AbstractCursor.getColumnIndexOrThrow(AbstractCursor.java:267)
    07-12 10:53:33.607: E/AndroidRuntime(940):  at android.widget.CursorAdapter.init(CursorAdapter.java:168)
    07-12 10:53:33.607: E/AndroidRuntime(940):  at android.widget.CursorAdapter.(CursorAdapter.java:116)
    07-12 10:53:33.607: E/AndroidRuntime(940):  at android.widget.ResourceCursorAdapter.(ResourceCursorAdapter.java:52)
    07-12 10:53:33.607: E/AndroidRuntime(940):  at android.widget.SimpleCursorAdapter.(SimpleCursorAdapter.java:78)
    07-12 10:53:33.607: E/AndroidRuntime(940):  at com.formation.sql.Main.DataBind(Main.java:94)
    07-12 10:53:33.607: E/AndroidRuntime(940):  at com.formation.sql.Main.onCreate(Main.java:33)
    07-12 10:53:33.607: E/AndroidRuntime(940):  at android.app.Activity.performCreate(Activity.java:4465)
    07-12 10:53:33.607: E/AndroidRuntime(940):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049)
    07-12 10:53:33.607: E/AndroidRuntime(940):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1920)
    07-12 10:53:33.607: E/AndroidRuntime(940):  ... 11 more 
```

这是主要的：

```
 package com.formation.sql;

    import android.app.ListActivity;
    import android.database.Cursor;
    import android.os.Bundle;
    import android.os.SystemClock;
    import android.view.ContextMenu;
    import android.view.ContextMenu.ContextMenuInfo;
    import android.view.Menu;
    import android.view.MenuItem;
    import android.view.View;
    import android.view.View.OnClickListener;
    import android.widget.AdapterView;
    import android.widget.Button;
    import android.widget.ListView;
    import android.widget.SimpleCursorAdapter;
    import android.widget.Toast;

    public class Main extends ListActivity implements OnClickListener {
    /** Called when the activity is first created. */

    DBAdapter db;

    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        getListView().setOnCreateContextMenuListener(this);
        ((Button)findViewById(android.R.id.button1)).setOnClickListener(this);
        db = new DBAdapter(this);
        db.open();
        DataBind();
    }

    // Création du menu principal
    public boolean onCreateOptionsMenu(Menu menu) {     
        menu.add(0,100,0,"Tout effacer");
        return true;
    }

     // Selection d'un item du menu
    public boolean onOptionsItemSelected(MenuItem item) {
        switch(item.getItemId()){
        case 100: 
            db.Truncate();
            DataBind();
            break;      
        }
        return true;
    }

    @Override // Selection d'un item de la liste
    protected void onListItemClick(ListView l, View v, int position, long id) {
        Cursor cursor = (Cursor)l.getAdapter().getItem(position);
        String titre  = cursor.getString(cursor.getColumnIndex("titre"));
        Toast.makeText(this,"Item id "+id+" : "+titre, Toast.LENGTH_SHORT).show();
        super.onListItemClick(l, v, position, id);
    }

    @Override // Creation du menu contextuel
    public void onCreateContextMenu(ContextMenu menu, View v, ContextMenuInfo menuInfo)    {
        super.onCreateContextMenu(menu, v, menuInfo);
        menu.setHeaderTitle("Action");
        menu.add(0,100,0,"Supprimer");
        menu.add(0,200,1,"Editer");
    }

    @Override // Selection d'un item du menu contextuel
    public boolean onContextItemSelected(MenuItem item) {
        AdapterView.AdapterContextMenuInfo info =   (AdapterView.AdapterContextMenuInfo) item.getMenuInfo();
        switch(item.getItemId()){
        case 100:
            db.supprimerprovince(info.id);
            DataBind();
            break;
        case 200:
            Toast.makeText(this, "TODO", Toast.LENGTH_SHORT).show();                
            break;          
        }
        return true;
    }

    @Override
    protected void onDestroy() {
        db.close();
        super.onDestroy();
    }

    public void DataBind(){
        Cursor c = db.recupererprovinceliste();
        startManagingCursor(c);
        SimpleCursorAdapter adapter = new SimpleCursorAdapter(this,   R.layout.list_item,c,new String[]{"titre","description","codebarre"}, new int[] {R.id.textTitre,R.id.TextDescription,R.id.TextCodeBarre});    setListAdapter(adapter);
    }

    public void onClick(View v) {
        long num = SystemClock.currentThreadTimeMillis();
        db.insererprovince(""+num);
        DataBind();
    }

} 
```

这是创建数据库的 DBAdapter 代码：

```
 package com.formation.sql;

    import java.util.ArrayList;
    import java.util.List;

    import android.content.ContentValues;
    import android.content.Context;
    import android.database.Cursor;
    import android.database.sqlite.SQLiteDatabase;
    import android.database.sqlite.SQLiteOpenHelper;
    import android.widget.Toast;

    public class DBAdapter {

    DatabaseHelper  DBHelper;
    Context         context;
    SQLiteDatabase  db;
    public DBAdapter(Context context){
        this.context = context;
        DBHelper = new DatabaseHelper(context);
    }   

    public class DatabaseHelper extends SQLiteOpenHelper{

        Context         context;

        public DatabaseHelper(Context context) {
            super(context, "provinces", null, 1);
            this.context = context;
        }

        public void onCreate(SQLiteDatabase db) {
            db.execSQL("create table if not exists provinces (_idprovince     INTEGER PRIMARY KEY AUTOINCREMENT,"
                    +"nomprovince text not null"
                    +");");         
        }

        public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
            Toast.makeText(context, "Mise à jour de la Base de données version      "+oldVersion+" vers "+newVersion, Toast.LENGTH_SHORT).show();
            db.execSQL("DROP TABLE IF EXISTS provinces");
            onCreate(db);
        }

    }

    public DBAdapter open(){
        db = DBHelper.getWritableDatabase();
        return this;
    }

    public void close(){
        db.close();
    }

    public void Truncate(){
        db.execSQL("DELETE FROM provinces");
    }

    public long insererprovince(String nom){
        ContentValues values = new ContentValues();
        values.put("nom", nom);
        return db.insert("provinces", null, values);
    }

       public boolean supprimerprovince(long id){

            return db.delete("provinces", "_idprovince="+id, null)>0;
        }

       public Cursor recupererprovinceliste(){

          return db.query("provinces",new String[]{"nomprovince"}, null, null, null, null, null);
        }
        /**
        * Getting all labels
        * returns list of labels
        * */
       public List getAllprovinces(){
           List labels = new ArrayList();

           // Select All Query
           String selectQuery = "SELECT  * FROM provinces"  ;

           SQLiteDatabase db = this.getReadableDatabase();
           Cursor c = db.rawQuery(selectQuery, null);

           // looping through all rows and adding to list
           if (c.moveToFirst()) {
               do {
                   labels.add(c.getString(1));
               } while (c.moveToNext());
           }

           // closing connection
           c.close();
           db.close();

           // returning lables
           return labels;
       }

        private SQLiteDatabase getReadableDatabase() {
            // TODO Auto-generated method stub
            return null;
        }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T09:25:32.827

查看导致异常的原因。

```
07-08 09:00:36.917: E/AndroidRuntime(825): Caused by:   
android.database.sqlite.SQLiteException: near ")":
syntax error: , while compiling: create table if not
exists provinces (_idprovince INTEGER PRIMARY KEY AUTOINCREMENT,
nomprovince text not null)); 
```

看起来你`)`最后可能有一个额外的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T09:44:28.250

在 db.executeSQL() 方法中有额外的右小括号。请在下面找到更正后的：

```
db.execSQL("create table if not exists provinces (_idprovince INTEGER PRIMARY KEY AUTOINCREMENT, "+"nomprovince text not null);"); 
```

# jquery - 为什么即使我的页面有要关闭的代码，fancybox 也没有关闭

> ID：11382021
> 
> 赞同：0
> 
> 时间：2012-07-08T09:23:42.823
> 
> 标签：jquery, iframe, fancybox, fancybox-2

这是用于从远程域加载外部页面的父页面的代码，但是当我单击 iframe 页面中的关闭链接时，它并没有关闭。谁能指导我，我哪里出错了？

```
<!DOCTYPE html>
<html>
<head>
    <title>fancyBox - Fancy jQuery Lightbox Alternative | Demonstration</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

    <!-- Add jQuery library -->
    <script type="text/javascript" src="../lib/jquery-1.7.2.min.js"></script>

    <!-- Add fancyBox main JS and CSS files -->
    <script type="text/javascript" src="../source/jquery.fancybox.js?v=2.0.6"></script>
    <link rel="stylesheet" type="text/css" href="../source/jquery.fancybox.css?v=2.0.6" media="screen" />

    <script type="text/javascript">
        $(document).ready(function() {

            $("#fancybox-manual-b").click(function() {
                $.fancybox.open({
                    href : 'http://2792.a.hostable.me/testing/instagram/tester.php',
                    type : 'iframe',
                    padding : 5 
                });
            });

        });
    </script>
    <style type="text/css">
        .fancybox-custom .fancybox-skin {
            box-shadow: 0 0 50px #222;
        }
    </style>
</head>
<body>
<a id="fancybox-manual-b" href="javascript:;">Open single item, custom options</a>
</body>
</html> 
```

远程页面中的代码如下

```
<!DOCTYPE html>
<html>
<head>
    <title>fancyBox - iframe demo</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
</head>
<body>
    <h1>fancyBox - iframe demo</h1>

    <p>
<a href="javascript:parent.$.fancybox.close();">Close me</a>

        |

        <a href="javascript:parent.document.returnval('asdf');">return some value</a>
    </p>

    <p>
        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam scelerisque justo ac eros consectetur bibendum. In hac habitasse platea dictumst. Nulla aliquam turpis et tellus elementum luctus. Duis sit amet rhoncus velit. Duis nisl ligula, mattis interdum blandit laoreet, mattis id ante. Cras pulvinar lacus vitae nisi egestas non euismod neque bibendum. Vestibulum faucibus libero id ante molestie ultricies. Vestibulum quis nibh felis. Vestibulum libero nisl, vehicula vel ullamcorper sit amet, tristique sit amet augue. Etiam urna neque, porttitor sed sodales lacinia, posuere a nisl. Vestibulum blandit neque in sapien volutpat ac condimentum sapien auctor. Ut imperdiet venenatis ultricies. Phasellus accumsan, sem eu placerat commodo, felis purus commodo ipsum, sit amet vulputate orci est viverra est.
    </p>

    <p>
        Aenean velit est, condimentum ut iaculis ut, accumsan at mi. Maecenas velit mi, venenatis ut condimentum at, ultrices vel tortor. Curabitur pharetra ornare dapibus. Ut volutpat cursus semper. In hac habitasse platea dictumst. Donec eu iaculis ipsum. Morbi eu dolor velit, a semper nunc.
    </p>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T10:59:51.900

你的代码对我有用，但是在使用 iframe 时你应该考虑[同源策略。](http://en.wikipedia.org/wiki/Same_origin_policy)

当您尝试关闭页面时，它会触发此错误

```
Timestamp: 08/07/2012 3:50:25 AM
Error: Permission denied to access property '$'
Source File: javascript:parent.$.fancybox.close();
Line: 1 
```

这意味着它可能存在对该主机执行来自不同域的脚本的限制。

如果您在本地测试或两个页面存在于同一台服务器（同一域）上，那么它将无缝运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T09:28:07.153

您打开的页面也需要fancybox JS 引用，否则它将无法识别试图关闭自身的代码。

如果您使用的是现代浏览器，您应该可以访问一个控制台（通常 F12 会打开它），该控制台应该会显示任何 JS 错误。

# python - Ubuntu：Python 版本、virtualenvwrapper 和 django

> ID：11382024
> 
> 赞同：1
> 
> 时间：2012-07-08T09:23:57.090
> 
> 标签：python, django, virtualenv, virtualenvwrapper

我对 virtualenvs 和 django 有疑问。显然我只是不明白他们应该如何工作。

我在 /opt/bin/python 中安装了 python 2.7.3 ucs2，它工作得很好我安装了 virtualenv 和 virtualenvwrapper 并创建了名为 py273ucs2 的虚拟环境，所以当我输入 workon py273ucs2 时，我得到了正确的虚拟环境。

当我创建python脚本时

```
#!/home/alan/python/virtualenvs/py273ucs2/bin/python

import sys
print sys.maxunicode 
```

我得到 65535，这对于 ucs2 python 是正确的。

同时我不知道如何为我的 django 应用程序使用正确的虚拟环境，所以我可以使用 ucs2 python 而不是 ucs4 之一。我尝试使用 virtualenvwrapper.django 创建一个测试项目，认为它的 wsgi 文件或 manage.py 会给我关于如何在正确的环境下启动 wsgi 脚本的提示——没有这样的运气。

我找到了这个网站： http: [//www.saltycrane.com/blog/2009/05/notes-using-pip-and-virtualenv-django/](http://www.saltycrane.com/blog/2009/05/notes-using-pip-and-virtualenv-django/)

基本上（除了我已经做过的其他事情）告诉我将其添加到我的 wsgi 文件中：

```
site.addsitedir('/srv/python-environments/saltycrane/lib/python2.5/site-packages') 
```

在我的情况下是：

```
site.addsitedir('/home/alan/python/virtualenvs/py273ucs2/lib/python2.7/site-packages') 
```

试过 - 没有运气。然后有这样的页面： [http](http://www.gyford.com/phil/writing/2011/06/27/virtualenv-webfaction.php) ://www.gyford.com/phil/writing/2011/06/27/virtualenv-webfaction.php 除了最后一页，它建议我添加：

```
activate_this = os.path.expanduser("~/.virtualenvs/my_env_name/bin/activate_this.py")
execfile(activate_this, dict(__file__=activate_this)) 
```

在我的情况下是：

```
activate_this = os.path.expanduser("/home/alan/python/virtualenvs/py273ucs2/bin/activate_this.py")
execfile(activate_this, dict(__file__=activate_this)) 
```

再次没有运气..查看

```
def base(request):
    return HttpResponse(sys.version+' maxunicode ' +str(sys.maxunicode)) 
```

打印出 python 版本 2.7.2 和 maxunicode 1114111 而不是 65535。

然后在stackoverflow这里有这条消息： [django如何与virtualenv一起工作？](https://stackoverflow.com/questions/11111434/how-does-django-work-with-virtualenv) 这表明我在 httd.conf 中添加了参数-也尝试过但也不起作用。

老实说-我没有得到这个。也许版本应该保持 2.7.2 而不是 2.7.3 ......那么 virtualenvs 的意义是什么......或者我做错了什么并且没有从这些例子中得到什么。我还检查了有关 virtualevns 的 wsgi wiki：

[http://code.google.com/p/modwsgi/wiki/VirtualEnvironments](http://code.google.com/p/modwsgi/wiki/VirtualEnvironments)

并将我的 httpd.conf 修改为：

```
WSGIPythonHome /home/alan/python/virtualenvs/py273ucs2
WSGIPythonPath /home/alan/python/virtualenvs/py273ucs2/lib/python2.7/site-packages
WSGIDaemonProcess printer user=alan group=alan processes=5 threads=5 python-path=/home/alan/python/virtualenvs/py273ucs2/lib/python2.7/site-packages
WSGIProcessGroup printer
WSGIScriptAlias / /home/alan/projects/printer/printer.wsgi 
```

没有。仍然在视图中看到 python 2.7.2...

有人可以帮我吗:)

艾伦

编辑1：回答评论：

1) 如果我想使用虚拟环境，我必须安装/编译新的 mod_wsgi？为什么？

2）如果我这样做：

```
alan@alan:~$ workon py273ucs2
(py273ucs2)alan@alan:~$ cd projects/printer/
(py273ucs2)alan@alan:~/projects/printer$ python manage.py runserver
Validating models...

0 errors found
Django version 1.3, using settings 'printer.settings'
Development server is running at http://127.0.0.1:8000/
Quit the server with CONTROL-C.
[08/Jul/2012 05:01:00] "GET / HTTP/1.1" 200 68 
```

然后我的观点告诉我：

2.7.3（默认，2012 年 5 月 16 日，10:58:59）[GCC 4.6.1] maxunicode 65535

Edit2：感谢 modwsgi google group 的 Graham Dumpleton 的帮助，我设法为 ucs2 python ( [https://groups.google.com/forum/?fromgroups#!topic/modwsgi/F5Wn4uWrQAg](https://groups.google.com/forum/?fromgroups#!topic/modwsgi/F5Wn4uWrQAg) ) 安装了 mod_wsgi。

但是当我开始这个网站时，我仍然得到

2.7.2+（默认，2011 年 10 月 4 日，20:41:12）[GCC 4.6.1] maxunicode 1114111

不是

2.7.3（默认，2012 年 7 月 9 日，13:32:29）[GCC 4.6.1] maxunicode 65535

顺便说一句 apache 错误日志打印出这个：

[2012 年 7 月 9 日星期一 14:13:19] [警告] mod_wsgi：为 Python/2.7.3 编译。[2012 年 7 月 9 日星期一 14:13:19] [警告] mod_wsgi：运行时使用 Python/2.7.2+。

最终编辑：

mod_wsgi 的安装方式存在几个问题。当您点击此链接时，您可以找到所有必要的信息：[https](https://groups.google.com/forum/?fromgroups#!topic/modwsgi/F5Wn4uWrQAg) ://groups.google.com/forum/?fromgroups#!topic/modwsgi/F5Wn4uWrQAg 。

但在这些问题之后，重点是 Ubuntu python 安装的方式与其他 python 冲突（可能不是最好的解释，但如果你点击上面的链接，你会发现 Graham Dumpleton 的解释很好）。当我删除 libapache2-mod-python 包时，虚拟 python 和 mod_wsgi 开始工作。它引起了其他问题，但这些问题是由 ubuntu 及其 python 包的设置方式引起的。

因此，如果您是 ubuntu 用户并且碰巧发现了同样的问题，那么这个页面和 Graham Dupmpletons 的巨大努力可能也会对您有所帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T09:34:35.370

您无法安装尚未安装的 python 版本的 virtualenv。

virtualenv 的重点是隔离你的包。如果您使用`--no-site-packages`. 它不会使用系统上已经安装的软件包。换句话说，这意味着您可以为一个 pythone 二进制文件安装每个包的多个版本。

拥有 virtualenv 也使开发变得更容易，因为您不需要 root 访问权限来使用`python setup.py`or安装包`pip install`。

从您发布的内容中不清楚，为什么它不起作用。

激活一个virtualenv。你所要做的

```
source path/to/env/bin/activate 
```

从配置运行脚本时，指出 python 所在的位置就足够了。如果你做 add_site_package，它可能只是默认添加到 python 而不是你想要的。

如果没有任何效果，您也许可以这样做。如果不需要其他 python 可执行文件，它应该可以解决您的问题。

使用`which python`，您应该能够知道当前 python 可执行文件的位置。

您可以将默认 python 的符号链接替换为您的 python2.7.3ucs。但我不能保证它不会在某个地方破坏某些东西。由于某些程序可能依赖于特定的 python2.7.2

**编辑**

显然，您的问题绝对不在于 virtualenv。但是使用 mod_wsgi。这是一个描述如何为所需的 python 版本编译 mod_wsgi 的站点。

[http://technomilk.wordpress.com/2011/08/10/running-our-django-site-with-mod_wsgi-and-virtualenv-part-2/](http://technomilk.wordpress.com/2011/08/10/running-our-django-site-with-mod_wsgi-and-virtualenv-part-2/)

这一行：

```
$ ./configure --with-python=/home/isigma/.pythonbrew/pythons/Python-2.7.2/bin/python 
```

这是您放置 python 版本的路径，然后按照步骤操作的地方。希望它会像黄油一样起作用。

**编辑 2**

如果没有其他工作，这可能意味着您必须检查 mod_wsgi 的替代品。

这是一个很好的。

[http://projects.unbit.it/uwsgi/wiki/Example](http://projects.unbit.it/uwsgi/wiki/Example)

**编辑 3**

像这样创建一个新的virtualenv

```
virtualenv --no-site-packages --python=/opt/bin/python 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T23:37:24.660

副本：

[https://groups.google.com/forum/?fromgroups#!topic/modwsgi/F5Wn4uWrQAg](https://groups.google.com/forum/?fromgroups#!topic/modwsgi/F5Wn4uWrQAg)

问题记录在：

[http://code.google.com/p/modwsgi/wiki/InstallationIssues#Mixing_32_Bit_And_64_Bit_Packages](http://code.google.com/p/modwsgi/wiki/InstallationIssues#Mixing_32_Bit_And_64_Bit_Packages)

配置/安装 Python 时使用“--enable-shared”。

# javascript - 在使用 socket.io 的 node.js 中，如何动态添加到套接字侦听器？

> ID：11382026
> 
> 赞同：1
> 
> 时间：2012-07-08T09:24:10.080
> 
> 标签：javascript, node.js, scope, socket.io

如果有标准`socket.io`设置：

```
var app = require('http').createServer().listen(80,'127.0.5.12'),
io = require('socket.io').listen(app);

session = require('./local_modules/session.js');

// creating a new websocket to keep the content updated without any AJAX request
io.sockets.on('connection', function(socket) {

  // session, login, logout
  socket.on( 'session', session.session.bind(socket) );
  socket.on( 'login', session.login.bind(socket) );
  socket.on( 'logout', session.logout.bind(socket) );

  // what to add new listener here!
}); 
```

稍后在程序中，一旦它知道它想要做什么，它希望向套接字侦听器添加新功能。例如，在“会话”中间可能希望添加“新事物”：

```
exports.session = function( sid) {
  var socket = this;
  ...
  // everything cool, now want to add 'something-now' to socket
  // do I simply - will something simple as this work?
  socket.on( 'something-new', session.something_new.bind(socket) );
}

exports.something_new = function( arg ) {
} 
```

这是正确的 - 它似乎是错误的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T09:59:53.517

如果您只想在套接字事件 'something-new' 上调用 'whatever.func()'

```
socket.on('something-new', whatever.func(data) ); 
```

或者

```
socket.on('something-new', function(data){
  whatever.func(data);
  whatelse.func(data.someproperty);
}); 
```

应该可以工作，而 'data' 是传递的第一个参数，当发出 'something-new' 时。

# php - 为每次更新发布数组并使用唯一 ID 更新 mysql 表？

> ID：11382032
> 
> 赞同：0
> 
> 时间：2012-07-08T09:25:16.663
> 
> 标签：php, mysql, arrays, serialization

我在萤火虫中有这个：

```
s:17:"id=12&id=15&id=16";s:19:"qty=15&qty=5&qty=12";s:43:"note=note+one¬e=note+two¬e=note+three"; 
```

我有以上作为结果：

```
itemid: $('input.id').serialize(),
qty: $('input.qty').serialize(),
note: $('textarea.note').serialize(),  
name: $('input#fname').val(),
phone: $('input#phone').val(),
email:  $('input#email').val() 
```

我的 php 进程文件中有这个：

```
$id             = serialize($_POST['itemid']);
$qty            = serialize($_POST['qty']);
$note           = serialize($_POST['note']);

$ids        = explode(',', $id);    
$qtys       = explode(',', $qty);
$notes      = explode(',', $note);          

$count = count($ids,$qtys,$notes);      

for ($i=0; $i < $count; $i++) {               
$query = "UPDATE bookings SET qty='{$qtys[$i]}', note='{$notes[$i]}' WHERE id='{$ids[$i]}'";   
$result = mysql_query($query) or die(mysql_error());
mysql_close(); 
```

真正想弄清楚这是如何完成的。必须发生的是，id= 数组中的每个 id 都会发生更新，并且值会在 qty 和 notes 所在的字段中发生变化。

有没有一种非常简单的方法可以做到这一点？

提前谢谢强尼

# c# - 如何在 ASP.NET Web 应用程序的 C# 方法中执行/调用 javascript 方法

> ID：11382033
> 
> 赞同：1
> 
> 时间：2012-07-08T09:25:21.847
> 
> 标签：c#, javascript, asp.net, methods, execute

我正在开发一个 asp.net Web 应用程序，我在源代码中有这个脚本：

```
 <script language="javascript" type="text/javascript">
    function showWindow(URL, controlID, targetControlID,id)
    {
      noweOkno = window.open( URL + '?controlID='+controlID+'&targetControlID=' + 
         targetControlID+'&id='+ id, '_blank', 
         'menubar=no, toolbar=no, location=no, scrollbars=no, resizable=no, ' +
         'status=no, width=760, height=600, left=30, top=30')
      noweOkno.focus();
    }
   </script> 
```

我可以用这段代码调用它：

```
Button4.Attributes["onClick"] = string.Format("showWindow( 'Child.aspx','{0}', '{1}','{2}');", tbVer.ClientID, Hidden1.ClientID, id_act); 
```

我的问题是，如何在某些 C# 方法中调用 javascript，例如：

```
protected void someMethod()
{
-I want to call showWindow('Child.aspx','{0}', '{1}','{2}');", tbVer.ClientID, Hidden1.ClientID, id_act);
} 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T09:32:36.280

你可以使用客户端脚本管理器

```
 ClientScriptManager.RegisterStartupScript(this.GetType(), "AKey", "MyFunction();", true); 
```

[http://msdn.microsoft.com/en-us/library/asz8zsxy.aspx](http://msdn.microsoft.com/en-us/library/asz8zsxy.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T09:33:07.320

您可以注册脚本块以在页面上运行，例如：

```
ClientScript.RegisterStartupScript(GetType(),"hwa","function_name;",true); 
```

# android - 天气度xml解析

> ID：11382034
> 
> 赞同：0
> 
> 时间：2012-07-08T09:25:23.440
> 
> 标签：android

我刚刚尝试了从谷歌天气 xml 获取天气的示例代码，但代码给出了 IOException，但我不知道我刚刚和视频一样的原因：http://www.youtube.com/watch?v=Z1rtldBTzCE 这是我的代码：

```
public class MyProjectActivity extends Activity implements android.view.View.OnClickListene  {
    /** Called when the activity is first created. */
    TextView tv;
    EditText edt1,edt2;
    Button btn;
    String site="hhttp://www.google.com/ig/api?weather=Lincoln,Nebraska";

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    tv=(TextView) findViewById(R.id.TV);
    edt1=(EditText) findViewById(R.id.et1);
    edt2=(EditText) findViewById(R.id.et2);
    btn=(Button) findViewById(R.id.b1);

    btn.

setOnClickListener( this);

    }

public void onClick(View V){

        String c=edt1.getText().toString();
        String s=edt2.getText().toString();
        StringBuilder url=new StringBuilder();
        url.append(c+","+s);
        String fullUrl=url.toString();
        try{
            URL website=new URL(fullUrl);
            SAXParserFactory spf=SAXParserFactory.newInstance();
            SAXParser sp=spf.newSAXParser();
            XMLReader xr=sp.getXMLReader();
            handler work=new handler();
            xr.setContentHandler(work);
            xr.parse(new InputSource (website.openStream()));
            String information=work.getInfo();
            tv.setText(information);
        }catch(Exception e)
        {
            tv.setText("error");
        }

    }

package com.myProject.pro;

import org.xml.sax.Attributes;
import org.xml.sax.SAXException;
import org.xml.sax.helpers.DefaultHandler;

public class handler extends DefaultHandler {

    geterSetter info=new geterSetter();

    public String getInfo(){
        return info.dataToString();
    }
    @Override
    public void startElement(String uri, String localName, String qName,
            Attributes attributes) throws SAXException {
        // TODO Auto-generated method stub
    if(localName.equals("city")){
        String city=attributes.getValue("data");
        info.setCity(city);
        }else if(localName.equals("temp_c")){
            String t=attributes.getValue("data");
            int temp=Integer.parseInt(t);
            info.setTemp(temp);
            }

    }

} 
```

//设置获取类包com.myProject.pro;

```
public class geterSetter {
    int temp;
    String city;

    public void setCity(String c){
        city=c;
    }
    public void setTemp(int t){
        temp=t;
    }
   public String dataToString(){
       return city+temp;
   }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T09:29:41.840

也许您对您的 url 架构有 2 个 Hs: `hhttp`not `http`:的事实感到困扰`hhttp://www.google.com/ig/api?weather=Lincoln,Nebraska`。删除一个`h`。

# objective-c - 如何在 Objective C 中使用我的 file.c 中的函数

> ID：11382040
> 
> 赞同：0
> 
> 时间：2012-07-08T09:25:56.397
> 
> 标签：objective-c

如何在Objective C中使用我的file.c中的函数我在file2.m中尝试了#include <file.c>，我想在其中调用这个函数并且找不到Lexical or Prepocesor Issue <file.c>，当我使用#包括“文件”我得到 Apple Mach-O 链接器 (ID) 错误。当我使用#import 而不是#include 时出现同样的错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T09:29:59.420

如果在“file.m”中你有这样的功能：

```
void hello()
{
    printf("Hello world!");
} 
```

您还必须创建一个可能称为“file.h”的头文件，在该文件中您只声明函数但实际上并未实现它；

```
void hello(); 
```

然后你必须`#import`或`#include`从file2.m thw file.h 文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T09:29:14.907

你`file.c`有`file.h`函数声明吗？你会想要`#include`那个，并确保它`file.c`被编译和链接。

# android - 如何防止默认浏览器在我的应用启动时生成新会话？

> ID：11382041
> 
> 赞同：0
> 
> 时间：2012-07-08T09:25:59.240
> 
> 标签：android, servlets

我使用HttpUrlConnection与servlet连接，servlet将sessionid返回给我的应用程序，然后我的应用程序启动默认浏览器。在servlet返回sessionid之前，我在会话中设置了一个属性。

```
 HttpSession session = request.getSession();
    session.setAttribute("ErrorInfo", "wrong!"); 
```

在 android 应用程序中，它获取 sessionid 并启动默认浏览器。

```
 Uri uri = Uri.parse("https://192.168.1.100:8443/test/error.jsp;jsession=" + sessionid);
    Intent intent = new Intent(Intent.ACTION_VIEW, uri);
    intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
    startActivity(intent); 
```

在error.jsp中，它会得到这样的属性：

```
 <%=session.getAttribute("ErrorInfo") %>
    <%=session.getId() %> 
```

测试的时候，我以为会显示“错误！”，但是jsp页面显示“null”，浏览器生成了一个新的会话。地址栏中的sessionid与session.getId()的值不同。

例如地址栏中的url是“https://192.168.1.100:8443/test/error.jsp;jsessionid=C4E6732EBB4C17F409AB41143735C096”。

在这种情况下，我认为浏览器不应该生成新的会话，但它确实生成了。

好的，我自己解决了这个问题。问题是由浏览器引起的。首先，我使用浏览器访问网站，浏览器生成一个会话，然后浏览器会使用这个会话，直到浏览器关闭。所以我的应用程序传递的 sessionid 将被浏览器忽略。为了解决这个问题，我让app获取浏览器的session，并在HttpUrlConnection中使用这个session，所以整个过程只有一个session。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T16:25:41.453

你可以尝试使用'？代替 ';' 附加 queryString 部分时，您的 URL 中的字符？

# python - 为什么我的（局部）变量表现得像一个全局变量？

> ID：11382047
> 
> 赞同：1
> 
> 时间：2012-07-08T09:27:14.820
> 
> 标签：python, list, global-variables

我没有使用全局变量，也从未明确定义过，但我的代码中似乎有一个。你能帮我把它本地化吗？

```
def algo(X): # randomized algorithm
    while len(X)>2:
        # do a bunch of things to nested list X
    print(X) 
    # tracing: output is the same every time, where it shouldn't be.
    return len(X[1][1])

def find_min(X): # iterate algo() multiple times to find minimum 
    m = float('inf')
    for i in some_range:
        new = algo(X)
        m = min(m, new)
    return m

X = [[[..], [...]],
     [[..], [...]],
     [[..], [...]]]

print(find_min(X))
print(X) 
# same value as inside the algo() call, even though it shouldn't be affected. 
```

X 似乎表现得像一个全局变量。随机算法`algo()`实际上只在第一次调用时执行一次，因为 X 保留其更改的值，它永远不会进入`while`循环。迭代的目的`find_min`因此被打破。

我是 python 的新手，甚至是这个论坛的新手，所以如果我需要澄清我的问题，请告诉我。谢谢。

**更新**非常感谢到目前为止的所有答案。我几乎理解它，除了我以前做过这样的事情，结果更快乐。你能解释一下为什么下面的代码不同吗？

```
def qsort(X):
    for ...
        # recursively sort X in place
        count+=1 # count number of operations
    return X, count

X = [ , , , ]
Y, count = qsort(X)
print(Y) # sorted
print(X) # original, unsorted. 
```

谢谢你。

**更新二**要回答我自己的第二个问题，不同之处似乎是在第一个代码（未显示）中使用了列表方法，而在第二个代码中则没有。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-08T09:42:17.703

正如其他人已经指出的那样，问题在于列表作为对函数的引用传递，因此函数体内的列表与您作为参数传递给它的对象完全相同。因此，您的函数执行的任何突变都可以从外部看到。

为了解决这个问题，您的`algo`函数应该对它传递的列表的副本进行操作。

当您对嵌套列表进行操作时，您应该使用模块中的`deepcopy`函数`copy`来创建列表的副本，您可以自由地对其进行变异，而不会影响函数之外的任何内容。内置`list`函数也可用于复制列表，但它只创建浅表副本，这不是嵌套列表想要的，因为内部列表仍然只是指向相同对象的指针。

```
from copy import deepcopy

def algo (X):
    X = deepcopy(X)
    ... 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-08T09:32:38.787

当你这样做时`find_min(X)`，你将对象 X （在这种情况下是一个列表）传递给函数。如果该函数改变列表（例如，通过附加到它），那么是的，它将影响原始对象。Python 不会因为您将对象传递给函数而复制对象。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-08T09:33:52.343

当您将对象传递给 python 函数时，不会复制该对象，而是传递一个指向该对象的指针。

这是有道理的，因为它大大加快了执行速度——在一个长列表的情况下，不需要复制它的所有元素。

但是，这意味着当您修改传递的对象（例如，您的列表 X）时，修改将应用于该对象，即使在函数返回之后也是如此。

例如：

```
def foo(x):
    x.extend('a')
    print x

l = []
foo(l)
foo(l) 
```

将打印：

['一种']

['一个'，'一个']

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-08T09:34:16.697

Python 列表是可变的（即，它们可以更改），并且函数调用`algo`中的使用*确实会*更改的值（即，它是列表的按引用传递）。例如，请参阅[这个 SO question](https://stackoverflow.com/questions/986006/python-how-do-i-pass-a-variable-by-reference)。`find_min`*`X`*

# javascript - jQuery + head.js：如何从 head.js 的就绪回调内部手动触发 $(document).ready()？

> ID：11382048
> 
> 赞同：4
> 
> 时间：2012-07-08T09:27:33.530
> 
> 标签：javascript, jquery, head.js

我需要优化 Web 应用程序的加载时间，该应用程序的每个 HTML 页面中都包含大量 javascript 文件。我想在一个这样的页面中尝试[head.js](http://headjs.com)，看看它是否会缩短加载时间。这些 JS 文件中有很多`$(document).ready(callback)`回调，这些回调是在加载 DOM 时调用的，而 head.js 仍在下载剩余的 JS 文件。

有没有办法告诉jQuery不要自己触发`ready`事件，而是让我从head.js的就绪回调中触发它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T16:38:39.190

我不确定您为什么要手动触发文档就绪事件。

相反，使用 jQuery 的内置`trigger`&`bind`功能订阅和发布您自己的事件。这是最佳实践和最佳解决方案。

**[工作 JSFiddle 演示](http://jsfiddle.net/bmgonzal/ZLqJ9/1/)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-28T15:49:34.203

创建一个函数将其注册到文档中

`$(document).ready(readyFunc);`

```
readyFunction(){
   /// something to do;
} 
```

如果您想手动使用它们，只需调用 readyFunction();

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-22T15:19:45.097

我做了一个小实验。就像是：

```
<html> 
<head>
<script src="head.js"></script>
<script src="jquery.min.js"></script>
</head>
<body>
<script type="text/javascript">
jQuery("document").ready(function() {
    console.log("ready.document");
});
</script>
...
<script type="text/javascript">
head.js("a.js", "b.js", "c.js", "test.js", function() {
        console.log("init.scripts");
        var millis = 2000;
        var date = new Date();
        var curDate = null;

        do {curDate = new Date(); } 
            while(curDate-date < millis);
        jQuery("#ddd").text(testTT);
        console.log("init.end");

});

</script>
... a lot of html content ...
<div id="ddd"></div>
...
<script type="text/javascript" >
console.log("last line");
</script>
</body> 
```

test.js 写入控制台并定义**testTT**。结果如下

```
last line
init.testTT
init.scripts
init.end
ready.document 
```

因此，在这个简单的情况下（使用 jQuery 1.8），首先执行加载的 *.js 中的代码，然后在 init 事件上生成 head.js，最后生成 jQuery 就绪事件。所以等到 JQuery 生成就绪事件应该没问题。但是，如果这仍然是一个问题，您可以执行以下操作。

```
head.js("a.js", "b.js", "c.js", function() { 
 jQuery("document").ready(function() {
      jQuery("body").trigger("your_event");
 });
}); 
```

而不是`jQuery("document").ready...`在您的 *.js 中收听，而是开始收听您正在触发的自定义事件`jQuery("body").on("your_event", handler)`。

# java - 使用数据库作为我的上下文绑定而不是文件系统

> ID：11382050
> 
> 赞同：1
> 
> 时间：2012-07-08T09:27:41.627
> 
> 标签：java, jboss, jndi

目前我的 jboss-service.xml 文件指向我硬盘上的 context-bindings.xml 文件。我们有一个 db 结构，它在数据库中保存上下文绑定和引用地址。我如何告诉 Jboss 指向数据库而不是我硬盘上的 context-bindings.xml 文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T15:52:51.980

找到了。答案是设置 DataSource 属性而不是 FileName 属性

所以，而不是，

```
<attribute name="FileName">C:\context-bindings.xml</attribute> 
```

而是使用，

```
<attribute name="DataSource">java:txLifeDS</attribute> 
```

# mysql - mySQL 触发器无法更新表：已被调用触发器的语句使用

> ID：11382052
> 
> 赞同：0
> 
> 时间：2012-07-08T09:27:50.157
> 
> 标签：mysql, triggers

所以我编辑了我的代码我在另一个触发器中遇到了这个问题但是这次即使更改 WHERE 子句也无济于事

```
DELIMITER $$

CREATE TRIGGER pic_album_change  AFTER UPDATE  ON pictures
  FOR EACH ROW BEGIN
    UPDATE albums SET counter = counter + 1 WHERE albums.id = NEW.album_id;
    UPDATE albums SET counter = counter - 1 WHERE albums.id = OLD.album_id;

END $$
DELIMITER ; 
```

错误 ：

```
 <p>Error Number: 1442</p><p>Can't update table 'pictures' in stored function/trigger because it is already used by statement which invoked this stored function/trigger. 
```

我在此触发器中的图片表上没有看到任何变化

我有另一个涉及这两个表的触发器

```
DELIMITER $$
CREATE TRIGGER  album_change
  AFTER UPDATE
  ON albums
  FOR EACH ROW
BEGIN
  UPDATE pictures
     SET

      level = NEW.level

    WHERE
   pictures.album_id =  NEW.id   ;

END $$
DELIMITER ; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T09:52:19.713

你的`WHERE`条款是错误的。

```
WHERE albums.id = NEW.album_id 
```

会导致`albums.counter`增加（大概是每个相册中的图片数量）。

这很重要，因为表上的连接不是可交换的——连接的方向很重要。这里需要根据 in`albums`中行的值找到要更新的记录`pictures`。

虽然*在这种情况下*实际上没有任何歧义，但 SQL 需要遵循有关连接的规则。

* * *

第二个触发器的问题是 MySQL 阻止了连续的更新循环。您有一个触发器`pic_album_change`，它会在更新`albums`时`pictures`更新。而且您有一个触发器，该触发器`album_change`在更新`pictures`时`albums`更新。这些触发器将相互触发。

在我看来，数据库设计可能需要更改。你真的需要`albums.counter`什么时候可以找到这些数据`SELECT count(*) FROM pictures WHERE album_id=...`吗？应该可以对数据进行规范化，以便触发器中没有循环引用。事实上，触发器可能根本不需要。

# jquery - 如果元素的类与单击元素的 ID 相同，请执行某些操作

> ID：11382055
> 
> 赞同：0
> 
> 时间：2012-07-08T09:28:03.553
> 
> 标签：jquery, class, filter

我认为标题是不言自明的。需要发生的是，当用户单击菜单项时，屏幕上的图像会被过滤。这仅通过显示与单击元素的 ID 具有相同类别的图像来实现。这是我到目前为止尝试过的代码：

```
var imgFilterBtn = $("nav > ul > li > ul > li > a");

imgFilterBtn.click(function() {
    $("img").fadeOut("fast");
    var fadeInClass = $(this).attr("id");

    $("img").hasClass(fadeInClass).fadeIn("fast");
}); 
```

我还尝试将图像放入包装器中并与孩子一起过滤它们：

```
var imgFilterBtn = $("nav > ul > li > ul > li > a");

imgFilterBtn.click(function() {
    $("img").fadeOut("fast");
    var fadeInClass = $(this).attr("id");

    $("#imgWrap").children("." + fadeInClass).fadeIn("fast");
}); 
```

但这也不起作用！对此有什么帮助吗？谢谢。

​</p>

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T09:29:50.990

`.hasClass()`返回一个布尔值，而不是 jQuery 集合。您可以直接在选择器中使用类名。

```
 var fadeInClass = $(this).attr("id");
 $("img."+fadeInClass).fadeIn("fast"); 
```

# iphone - 声明委托协议

> ID：11382057
> 
> 赞同：5
> 
> 时间：2012-07-08T09:28:17.927
> 
> 标签：iphone, objective-c, ios

我想知道`protocol`在同一个类中声明 a 和在单独的文件中声明它有什么区别；例子 ：

```
#import <UIKit/UIKit.h>

@class MyClassA;

@protocol MyDelegate <NSObject>

@required
- (MyClassA*)myMythod;

@optional
- (void)anOtherMethod:(NSString*)ID;

@end

@interface MyClassB : UIViewController <UITableViewDataSource, UITableViewDelegate>

@property (nonatomic, assign) id <MyDelegate> delegate;
...... 
```

在这里，我在与 MyClassB 相同的文件中声明协议委托，我可以在单独的源文件中声明它（协议委托）。在与类相同的文件中声明它和在单独的文件中声明它有什么区别？谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-08T10:28:06.417

肯定有细微的差别。

如果您正在谈论的协议是**一个**特定类使用的委托，例如，`MySpecialViewController`和`MySpecialViewControllerDelegate`，那么您可能非常希望将这两者的声明保留在同一个标​​头中。例如，如果另一个类要实现该协议，它可能会在**逻辑**上依赖于`MySpecialViewController`该类。因此，您不会引入任何其他依赖项。

但是，使用协议还有另一个重要原因（至少）。您可能正在尝试解耦两个类之间的双向依赖关系。当然，编译器不会让两个头文件`#import`相互连接。但是，即使您将一个类`#import`移到**.m**文件中，让两个类各自完全了解彼此的完整 API 通常是设计不佳的标志。

*稍微解耦这种关系的一种*方法是让一个类仅通过另一个类实现的协议来了解另一个类。也许`Parent`拥有并创建`Child`类，因此必须`#import "Child.h"`。但是，`Child`也需要`foo:bar:`调用`Parent`. 你可以做一个`FooProtocol`：

```
@protocol FooProtocol
  - (void) foo: (int) arg1 bar: (BOOL) arg2;
@end 
```

然后在 Parent.h 中：

```
@interface Parent : SomeBaseClass<FooProtocol> {
} 
```

允许`Child`这样做：

```
@interface Child {
}
@property (assign) id<FooProtocol> fooHandler; 
```

并使用它

```
[fooHandler foo: 1 bar: YES]; 
```

这使孩子没有直接依赖于`Parent`类（或 Parent.h）。但是，这仅在您将声明保留`FooProtocol`在 FooProtocol.h 中而不是在 Parent.h 中时才有效。同样，如果`FooProtocol`它只被 使用过`Child`，那么**将**它保存在 Child.h 中是有意义的，但**如果这个协议被除`Child`**.

因此，总而言之，**如果您想保留最大程度地分离类之间的相互依赖关系，或者鼓励在设计中更好地分离，请将您的协议保留在单独的标头中**。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T09:32:04.527

没有不同。这只是您喜欢如何组织标题的问题。

例如，我喜欢将与“一个功能实体”相关的所有内容（无论这意味着什么，定义各不相同 :-)）都保存在一个文件中。因此，使用实现协议的委托的类将在同一个标​​头中声明类和协议，因为它们几乎只是同一建筑物的不同砖块。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-08T09:35:16.773

将协议放在单独的头文件与类的头文件之间的唯一区别是它允许将协议包含为可选的，这有助于解决任何命名冲突，但为协议添加前缀应该是解决方案。

约定似乎是在类的头文件中包含相关协议，因为这样可以更有条理并保持在一起，但是如果您有非常大的协议，将它们放在单独的文件中以使您的类头文件可能更有意义更容易阅读。

# android - startDrag() 之后的代码不执行

> ID：11382079
> 
> 赞同：1
> 
> 时间：2012-07-08T09:32:37.743
> 
> 标签：android, drag-and-drop

我想做的是在一个视图上有 4 个 ImageButtons，然后当我将一个按钮拖到另一个按钮时，Logcat 中会打印一条消息。问题是即使 Drag 事件通过 START、ENTERED、LOCATION、EXITED、DROP、ENDED 都没有问题，但是 onLongClick() 的其余部分，v.startDrag() 之后的代码不起作用。先谢谢了。

```
public class HomeAcitivity extends Activity implements OnClickListener, OnLongClickListener 
    {
    //int windowWidth = getWindowManager().getDefaultDisplay().getWidth();
    //int windowHeight = getWindowManager().getDefaultDisplay().getHeight();

    public static int action = 0; // what action to take:
                                    // 0: nothing
                                    // 1: song to album
                                    // 2: song to genre
                                    // 3: song to artist

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_home);
        initialization(savedInstanceState);
    }

    public void initialization(Bundle savedInstanceState)
    {
        ImageButton songsMap = (ImageButton) findViewById(R.id.songsmap);
        songsMap.setContentDescription("none");
        songsMap.setOnClickListener(this);
        songsMap.setOnLongClickListener(this);
        ImageButton albumsMap = (ImageButton) findViewById(R.id.albumsmap);
        albumsMap.setContentDescription("none");
        albumsMap.setOnClickListener(this);
        albumsMap.setOnLongClickListener(this);
        ImageButton artistsMap = (ImageButton) findViewById(R.id.artistsmap);
        artistsMap.setOnClickListener(this);
        artistsMap.setOnLongClickListener(this);
        ImageButton genresMap = (ImageButton) findViewById(R.id.genresmap);
        genresMap.setOnClickListener(this);
        genresMap.setOnLongClickListener(this);
        myDragEventListener mAlbumDragListener = new myDragEventListener();
        albumsMap.setOnDragListener(mAlbumDragListener);
        myDragEventListener mSongDragListener = new myDragEventListener();
        songsMap.setOnDragListener(mSongDragListener);
        myDragEventListener mArtistDragListener = new myDragEventListener();
        artistsMap.setOnDragListener(mArtistDragListener);
        myDragEventListener mGenreDragListener = new myDragEventListener();
        genresMap.setOnDragListener(mGenreDragListener);

    }

    public boolean songtoalbum()
    {
        Log.d("Song to album:", "true");
        return true;
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_home, menu);
        return true;
    }

    public void onClick(View arg0) 
    {

    }

    public boolean onLongClick(View v) 
    {
        if (v.getId() == R.id.musicmapparent)
        {
            // here modify wallpaper
            return true;
        }
        // Drag and drop
        ClipData.Item item = new ClipData.Item((CharSequence) v.getTag());
        // this part is different from the android dev:
        String[] mimetype = new String[1];
        mimetype[0] = ClipDescription.MIMETYPE_TEXT_PLAIN;

        ClipData dragData = new ClipData((CharSequence) v.getTag(), 
                                        mimetype, 
                                        item);
        View.DragShadowBuilder myShadow;

        switch(v.getId())
        {
        case R.id.albumsmap:
            myShadow = 
                new MyDragShadowBuilder (v, getResources().getDrawable(R.drawable.ic_launcher));        
                break;
        case R.id.songsmap:
            myShadow = 
                new MyDragShadowBuilder (v, getResources().getDrawable(R.drawable.ic_launcher));

            break;
        case R.id.artistsmap:
            myShadow = 
                new MyDragShadowBuilder (v, getResources().getDrawable(R.drawable.ic_launcher));

            break;
        case R.id.genresmap:
            myShadow = 
                new MyDragShadowBuilder (v, getResources().getDrawable(R.drawable.ic_launcher));
            break;
        default:
            myShadow = null;
        }

        //---------------------------------------------------------------------------

        //v.setOnDragListener(mDragListener);
        v.startDrag(dragData,  // the data to be dragged
                myShadow,  // the drag shadow builder
                null,      // no need to use local data
                0          // flags (not currently used, set to 0)
                );

        // Stuck here >"<
        Log.d("Out of Drag", "At least we get here");
        switch (HomeAcitivity.action)
        {
        case 0:
            break;
        case 1:
            Log.d("ACTION: ", "Song to album");

            //songtoalbum();

            break;
        case 2:
            Log.d("ACTION: ", "Song to genre");
            //songtogenre();
            break;
        case 3:
            Log.d("ACTION: ", "Song to artist");
            //songtoartist();
            break;
        default:
            Log.d("ACTION", "nothing");
            break;

        }
        return true;

    }

}

// To create the shadow for the object
class MyDragShadowBuilder extends View.DragShadowBuilder {

    // The drag shadow image, defined as a drawable thing
    private static Drawable shadow;

        // Defines the constructor for myDragShadowBuilder
        public MyDragShadowBuilder(View v, Drawable drawable) {
            super(v);
            shadow = drawable;
        }

        // Defines a callback that sends the drag shadow dimensions and touch point back to the
        // system.
        @Override
        public void onProvideShadowMetrics (Point size, Point touch)
        {
            // Defines local variables
            int width, height;

            // Sets the width of the shadow to half the width of the original View

            width = getView().getWidth();

            // Sets the height of the shadow to half the height of the original View
            height = getView().getHeight();

            // The drag shadow is a ColorDrawable. This sets its dimensions to be the same as the
            // Canvas that the system will provide. As a result, the drag shadow will fill the
            // Canvas.
            shadow.setBounds(0, 0, width, height);

            // Sets the size parameter's width and height values. These get back to the system
            // through the size parameter.
            size.set(width, height);

            // Sets the touch point's position to be in the middle of the drag shadow
            touch.set(width / 2, height / 2);
        }

        // Defines a callback that draws the drag shadow in a Canvas that the system constructs
        // from the dimensions passed in onProvideShadowMetrics().
        @Override
        public void onDrawShadow(Canvas canvas) {

            // Draws the ColorDrawable in the Canvas passed in from the system.
            shadow.draw(canvas);
        }
    }

class myDragEventListener implements OnDragListener {
    // This is the method that the system calls when it dispatches a drag event to the
    // listener.
    public boolean onDrag(View v, DragEvent event) {

        // Defines a variable to store the action type for the incoming event
        final int action = event.getAction();

        // Handles each of the expected events
        CharSequence dragData = null;
        switch(action) {

            case DragEvent.ACTION_DRAG_STARTED:

                // Determines if this View can accept the dragged data
                if (event.getClipDescription().hasMimeType(ClipDescription.MIMETYPE_TEXT_PLAIN)) {
                    switch(v.getId())
                    {
                    case R.id.albumsmap:

                        break;
                    case R.id.songsmap:
                        v.setContentDescription("songstart");
                        break;

                    case R.id.artistsmap:

                        break;

                    case R.id.genresmap:

                        break;

                    }
                    // As an example of what your application might do,
                    // applies a blue color tint to the View to indicate that it can accept
                    // data.
                    ((ImageView) v).setColorFilter(Color.BLUE);

                    // Invalidate the view to force a redraw in the new tint
                    v.invalidate();
                    dragData = (CharSequence) v.getTag();
                    // returns true to indicate that the View can accept the dragged data.
                    return(true);

                    } else {

                    // Returns false. During the current drag and drop operation, this View will
                    // not receive events again until ACTION_DRAG_ENDED is sent.
                    return(false);

                    }
                //break;

            case DragEvent.ACTION_DRAG_ENTERED:

                // Applies a green tint to the View. Return true; the return value is ignored.

                ((ImageView) v).setColorFilter(Color.GREEN);

                // Invalidate the view to force a redraw in the new tint
                v.invalidate();

                return(true);

                //break;

            case DragEvent.ACTION_DRAG_LOCATION:

                //
                switch(v.getId())
                {
                case R.id.albumsmap:
                    ((ImageView) v).setColorFilter(Color.RED);
                    break;
                case R.id.songsmap:
                    ((ImageView) v).setColorFilter(Color.YELLOW);
                    break;

                case R.id.artistsmap:
                    ((ImageView) v).setColorFilter(Color.WHITE);
                    break;

                case R.id.genresmap:
                    ((ImageView) v).setColorFilter(Color.BLACK);
                    break;

                }
                return(true);

                //break;

                case DragEvent.ACTION_DRAG_EXITED:

                    // Re-sets the color tint to blue. Returns true; the return value is ignored.
                    ((ImageView) v).setColorFilter(Color.BLUE);

                    // Invalidate the view to force a redraw in the new tint
                    v.invalidate();

                    return(true);

                //break;

                case DragEvent.ACTION_DROP:

                    // Gets the item containing the dragged data
                    ClipData.Item item = event.getClipData().getItemAt(0);

                    // Gets the text data from the item.
                    dragData = item.getText();
                    Log.d("DRAGDATA = ", (String) dragData);
                    Log.d("V.ID = ", Integer.toString(v.getId()));

                    Log.d("Album.ID = ", Integer.toString(R.id.albumsmap));
                    // Displays a message containing the dragged data.
                    //Toast.makeText(this, "Dragged data is " + dragData, Toast.LENGTH_LONG);

                    // Turns off any color tints
                    ((ImageView) v).clearColorFilter();

                    // Invalidates the view to force a redraw
                    v.invalidate();
                    String dragDataString = (String) dragData;
                    Log.d(dragDataString, dragDataString);
                    //
                    switch(v.getId())
                    {
                    case R.id.albumsmap:
                        ((ImageView) v).setColorFilter(Color.RED);

                        if (dragDataString.equals("SONG_MAP_BUTTON"))
                        {
                            HomeAcitivity.action = 1;
                            v.invalidate();

                        }
                        break;
                    case R.id.songsmap:
                        ((ImageView) v).setColorFilter(Color.YELLOW);
                        break;

                    case R.id.artistsmap:
                        if (dragDataString.equals("SONG_MAP_BUTTON"))
                        {
                            HomeAcitivity.action = 3;
                            Log.d("TAG: ", "This should be song to artist map");
                            v.invalidate();
                        }

                        break;

                    case R.id.genresmap:
                        if (dragDataString.equals("SONG_MAP_BUTTON"))
                        {
                            HomeAcitivity.action = 2;
                            Log.d("TAG: ", "This should be song to genre map");
                            v.invalidate();
                        }
                        break;

                    }

                    // Returns true. DragEvent.getResult() will return true.
                    return(true);

                //break;

                case DragEvent.ACTION_DRAG_ENDED:

                    // Turns off any color tinting
                    ((ImageView) v).clearColorFilter();

                    // Invalidates the view to force a redraw
                    v.invalidate();

                    // Does a getResult(), and displays what happened.
                    if (event.getResult()) {
                        Log.d("End: ", "Well, end" + v.getId());
                        //Toast.makeText(this, "The drop was handled.", Toast.LENGTH_LONG);

                    } else {
                        //Toast.makeText(this, "The drop didn't work.", Toast.LENGTH_LONG);

                    };

                    // returns true; the value is ignored.
                    return(true);

                //break;

                // An unknown action type was received.
                default:
                    Log.e("DragDrop Example","Unknown action type received by OnDragListener.");

                break;
        };
        return true;
    };

}; 
```

# android - DatePicker 在设置日期时给出 NullPointerException

> ID：11382083
> 
> 赞同：0
> 
> 时间：2012-07-08T09:33:23.790
> 
> 标签：android, datepicker, nullpointerexception, arabic

我将 Android Emulator 的语言环境更改为阿拉伯语，以测试我的应用程序的阿拉伯语版本。日期选择器如下图所示，

![阿拉伯语日期选择器](../Images/5150521a1cf0c622406ccf4c353281a6.png)

尽管 DatePicker 在我的应用程序的英文版中运行良好，但现在 t 给了我以下错误。

```
07-08 11:13:44.544: E/AndroidRuntime(696): FATAL EXCEPTION: main
07-08 11:13:44.544: E/AndroidRuntime(696): java.lang.NullPointerException
07-08 11:13:44.544: E/AndroidRuntime(696):  at org.digitalhealthagency.elaj.gui.AppointmentReservationActivity$DoctorWorkingDaysTask.access$2(AppointmentReservationActivity.java:927)
07-08 11:13:44.544: E/AndroidRuntime(696):  at org.digitalhealthagency.elaj.gui.AppointmentReservationActivity$5.onDateSet(AppointmentReservationActivity.java:454)
07-08 11:13:44.544: E/AndroidRuntime(696):  at android.app.DatePickerDialog.tryNotifyDateSet(DatePickerDialog.java:148)
07-08 11:13:44.544: E/AndroidRuntime(696):  at android.app.DatePickerDialog.onStop(DatePickerDialog.java:155)
07-08 11:13:44.544: E/AndroidRuntime(696):  at android.app.Dialog.dismissDialog(Dialog.java:326)
07-08 11:13:44.544: E/AndroidRuntime(696):  at android.app.Dialog.dismiss(Dialog.java:302)
07-08 11:13:44.544: E/AndroidRuntime(696):  at com.android.internal.app.AlertController$ButtonHandler.handleMessage(AlertController.java:170)
07-08 11:13:44.544: E/AndroidRuntime(696):  at android.os.Handler.dispatchMessage(Handler.java:99)
07-08 11:13:44.544: E/AndroidRuntime(696):  at android.os.Looper.loop(Looper.java:137)
07-08 11:13:44.544: E/AndroidRuntime(696):  at android.app.ActivityThread.main(ActivityThread.java:4745)
07-08 11:13:44.544: E/AndroidRuntime(696):  at java.lang.reflect.Method.invokeNative(Native Method)
07-08 11:13:44.544: E/AndroidRuntime(696):  at java.lang.reflect.Method.invoke(Method.java:511)
07-08 11:13:44.544: E/AndroidRuntime(696):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
07-08 11:13:44.544: E/AndroidRuntime(696):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
07-08 11:13:44.544: E/AndroidRuntime(696):  at dalvik.system.NativeStart.main(Native Met
hod) 
```

我错过了我应该为阿拉伯语版本做的事情吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T09:59:11.600

我在 Android 4.1 模拟器上测试时发现这个问题出现了。看起来完全不同，`DatePickerDialog`有一个按钮而不是两个，但我的代码在 Android 4.0.3 模拟器及更低版本上正常工作。

在这里发布了另一个问题[Android: Android 4.1 Emulator Invoking onDateSet Twice from DatePicker Dialog](https://stackoverflow.com/questions/11383592/android-android-4-1-emulator-invoking-ondateset-twice-from-datepicker-dialog)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T09:44:42.387

我想不出任何特定于阿拉伯语的东西。在没有任何代码的情况下，我能做的最好的就是建议一些调试技术。

如果您查看 AppointmentReservationActivity.java 的第 927 行上的代码，我怀疑您访问的方法/字段的任何内容都会泄露它。

如果您没有立即看到它，请尝试在该行设置断点并检查您的变量。

# jquery - ajax发布后的Codeigniter返回值

> ID：11382084
> 
> 赞同：3
> 
> 时间：2012-07-08T09:33:29.923
> 
> 标签：jquery, ajax, codeigniter

首先对不起，我是一个非常大的初学者。

我遇到了一个我无法真正解决的问题，我正在建造一个类似 facebook 的墙。发送帖子后，我希望将结果附加到 div 中，但我完全迷失了。

问题是它发送完美，但没有显示结果

这是我的代码

html

```
<?php foreach($stream_posts as $sp): ?>
    <div id="sp_<?php echo $sp->sid; ?>" class="row stream-posts">
        <div class="span1 stream-thumb">
            <ul class="thumbnails">
              <li>
                <a href="#" class="thumbnail">
                  <img src="http://placehold.it/60x60" alt="">
                </a>
              </li>
            </ul>
        </div>  
        <div class="span5 stream-content">
            <a href="#" class="author"><?php echo $sp->first_name ." ". $sp->last_name; ?></a>
            <p>
                <?php echo nl2br($sp->text); ?>
            </p>
        </div>

    </div>
    <?php endforeach; ?> 
```

jQuery

```
$('.stream-form').on('submit', function(){
        var streamData = $(this).serialize();
        $.ajax({
            url: "<?php echo base_url(); ?>stream/insert_stream",
            type: "POST",
            data: streamData,
            dataType: "json",
            success: function(stream) {

                if(stream.error == 0)
                {
                    $('.stream-text').val("");
                    $('.stream-posts').append().text(stream.text);

                }   
            }
        });
        return false;
    }); 
```

在这个 jQuery 代码中，它附加了所有内容并打破了 div，我想向新帖子显示提交的内容

模型

```
 function add_stream()
    {

        $data = array(
            'added_by' => $this->session->userdata('user_id'),
            'text' => $this->input->post('stream_text')
        );

        $this->db->insert('pf_stream', $data);

    }

function load_stream_post()
{
    $this->db->select('*');
        $this->db->from('pf_stream');
        $this->db->join('pf_users', 'pf_users.id = pf_stream.added_by');
        $this->db->order_by('pf_stream.sid', 'DESC');
        $this->db->limit(1);
        $query = $this->db->get();

        if($query->num_rows() > 0)
        {   
            foreach($query->result() as $row)
            {
                $sdata[] = $row;
            }
        return $sdata;  
        }

}
    // this is for the view
    function select_stream()
    {
        $this->db->select('*');
        $this->db->from('pf_stream');
        $this->db->join('pf_users', 'pf_users.id = pf_stream.added_by');
        $this->db->order_by('pf_stream.sid', 'DESC');
        $this->db->limit(5);
        $query = $this->db->get();

        if($query->num_rows() > 0)
        {   
            foreach($query->result() as $row)
            {
                $data[] = $row;
            }
        return $data;   
        }
    } 
```

控制器

```
 public function index()
   {
        $this->load->view('partials/header');
        $data['stream_posts'] = $this->stream_model->select_stream();
           $this->load->view('stream_view', $data);
        $this->load->view('partials/footer');
   }

    function insert_stream()
    {
        $this->form_validation->set_rules('stream_text', 'Üzenet', 'trim|required|xss_clean');

        if($this->form_validation->run() == false)
        {
            $stream = array('error' => 1);
        } else {
            $this->stream_model->add_stream();
            $data['stream_result'] = $this->stream_model->load_stream_post();
            $stream = array(
               'error' => 0, 
               'sid' => $data['stream_result'][0]->sid,
               'text' => $data['stream_result'][0]->text,
               'author' => $data['stream_result'][0]->first_name . " " . $data['stream_result'][0]->last_name,
            );
        }
        echo json_encode($stream);
    } 
```

有人可以给我一个提示我错过了什么吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-08T10:07:45.240

我认为问题在于，这里

```
$('.stream-posts').append().text(stream.text); 
```

这应该是

```
$('.stream-posts').append(stream.text); 
```

# c# - 如何根据用户选择的下拉列表设置不可选择的日历日期？

> ID：11382086
> 
> 赞同：0
> 
> 时间：2012-07-08T09:33:45.163
> 
> 标签：c#, asp.net

如何根据用户选择的 DropDownList 中的名称设置无法选择的日历日期？换句话说，DropDownList 中的每个名称都将设置不同的不可选择的日期，我尝试使用以下代码来执行我的程序，但它似乎无法正常工作。我该怎么做？

```
protected void DropDownList1_SelectedIndexChanged(object sender, EventArgs e)
{
    if (DropDownList1.SelectedItem.Text == "WeddingPlanner1")
    {
        if (e.Day.Date.Month == 7 || e.Day.Date.Month == 9 || e.Day.Date.Month == 12)
    {

        if (e.Day.Date.Day == 5 || e.Day.Date.Day == 14 || e.Day.Date.Day == 18)
        {
            e.Day.IsSelectable = false;
            e.Cell.ForeColor = System.Drawing.Color.Black;
            e.Cell.BackColor = System.Drawing.Color.White;
            e.Cell.Font.Bold = true;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T09:48:24.380

您可以使用与您所拥有的相同的代码，但在 _DayRender 事件中，将 asp.net 日历控件的一天设为只读

# iphone - 使用 iOS 应用程序的拨号器

> ID：11382093
> 
> 赞同：1
> 
> 时间：2012-07-08T09:34:45.263
> 
> 标签：iphone, ios

> **可能重复：**
> [如何调出 iPhone 通话屏幕](https://stackoverflow.com/questions/3571790/how-can-i-bring-up-the-iphone-call-screen)

我需要在我的 iOS 应用程序中使用拨号器，如下图所示。如何自定义/重用 iPhone 的拨号器视图？ ![在此处输入图像描述](../Images/8405277d68fe149f15fb83acfc7e48b3.png)

# ruby-on-rails - 捕获断言语句的结果？

> ID：11382098
> 
> 赞同：1
> 
> 时间：2012-07-08T09:35:07.223
> 
> 标签：ruby-on-rails, ruby, unit-testing, testing

我正在编写一个测试助手，它有这个方法：

```
def todo msg = ''
  assert false, '@TODO: ' + msg
end 
```

基本上我想要一个快速的方法来让测试失败。接下来，我想测试一下这个方法（因为它会被封装在一个可交付的 helper 中）。所以我想写这样的东西：

```
test 'todo' do
  result = todo
  expected = '@TODO: '
  assert_equal expected, result
end 
```

`assert false`但它只是在被调用时失败。那么，我将如何测试这种方法呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-08T09:50:02.770

这个助手应该和 一起工作`Test::Unit`，对吗？我相信这`assert false`会引发一个被`Test::Unit`. 您可以将调用包装`todo`在一个`begin...rescue`块中并捕获该异常。

Ruby 标准库中的`test/unit`内容实际上是`Minitest::Unit`——当一个断言失败时，它会引发一个`Minitest::Assertion`异常。你可以`rescue`这样。

对于 "real" ，它会在断言失败时`Test::Unit`引发 a 。`Test::Unit::AssertionFailedError`

# c# - 如何从一个纹理中显示许多精灵并让它们每隔一段时间移动 XNA 4.0

> ID：11382101
> 
> 赞同：1
> 
> 时间：2012-07-08T09:35:41.410
> 
> 标签：c#, xna, xna-4.0

嗨，我是 xna 的新手，我正在尝试制作一个简单的游戏，其中您的小船可以四处移动并避免小行星从顶部掉到底部。我让船在移动，一颗小行星坠落，但我不知道如何让许多小行星从相同的纹理中坠落，以及如何让它们不时坠落。到目前为止，这是我的小行星类：

```
namespace Asteroids
{
class Asteroids
{
    Texture2D AsteroidTexture;
    Vector2 Position;
    Random random = new Random();
    float AsteroidSpeed = 5;

    public void Initialize()
    {
        Position.Y = 0;
        Position.X = random.Next(0, 1000);
    }

    public void Update()
    {
        Position.Y += AsteroidSpeed;
        if (Position.Y > 600)
        {
            Position.Y = 0;
            Position.X = random.Next(0, 1000);
        }
    }

    public void Load_Content(ContentManager Content)
    {
        AsteroidTexture = Content.Load<Texture2D>("asteroid");
    }

    public void Draw(SpriteBatch SpriteBatch)
    {
        SpriteBatch.Draw(AsteroidTexture, Position, Color.White);
    }
}
} 
```

这是我的 Game1 课：

```
namespace Asteroids
{
public class Game1 : Microsoft.Xna.Framework.Game
{
    GraphicsDeviceManager graphics;
    SpriteBatch spriteBatch;
    KeyboardState keyboardState;

    Ship ship;
    Asteroids asteroids;

    public Game1()
    {
        graphics = new GraphicsDeviceManager(this);
        Content.RootDirectory = "Content";
    }

    /// <summary>
    /// Allows the game to perform any initialization it needs to before starting to run.
    /// This is where it can query for any required services and load any non-graphic
    /// related content.  Calling base.Initialize will enumerate through any components
    /// and initialize them as well.
    /// </summary>
    protected override void Initialize()
    {
        ship = new Ship();
        asteroids = new Asteroids();

        asteroids.Initialize();

        this.graphics.PreferredBackBufferWidth = 1000;
        this.graphics.PreferredBackBufferHeight = 600;
        //this.graphics.IsFullScreen = true;
        this.graphics.ApplyChanges();

        base.Initialize();
    }

    /// <summary>
    /// LoadContent will be called once per game and is the place to load
    /// all of your content.
    /// </summary>
    protected override void LoadContent()
    {
        // Create a new SpriteBatch, which can be used to draw textures.
        spriteBatch = new SpriteBatch(GraphicsDevice);

        ship.Load_Content(this.Content);
        asteroids.Load_Content(this.Content);
    }

    /// <summary>
    /// UnloadContent will be called once per game and is the place to unload
    /// all content.
    /// </summary>
    protected override void UnloadContent()
    {
        // TODO: Unload any non ContentManager content here
    }

    /// <summary>
    /// Allows the game to run logic such as updating the world,
    /// checking for collisions, gathering input, and playing audio.
    /// </summary>
    /// <param name="gameTime">Provides a snapshot of timing values.</param>
    protected override void Update(GameTime gameTime)
    {
        // Allows the game to exit
        if (GamePad.GetState(PlayerIndex.One).Buttons.Back == ButtonState.Pressed)
            this.Exit();
        keyboardState = Keyboard.GetState();
        if (keyboardState.IsKeyDown(Keys.Escape))
            this.Exit();

        ship.Update();
        asteroids.Update();

        base.Update(gameTime);
    }

    /// <summary>
    /// This is called when the game should draw itself.
    /// </summary>
    /// <param name="gameTime">Provides a snapshot of timing values.</param>
    protected override void Draw(GameTime gameTime)
    {
        GraphicsDevice.Clear(Color.Black);

        spriteBatch.Begin();
        asteroids.Draw(this.spriteBatch);
        ship.Draw(this.spriteBatch);
        spriteBatch.End();

        base.Draw(gameTime);
    }
}
} 
```

提前致谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-08T13:19:34.200

**重要提示：**密切注意我的代码中的大写和复数。这很重要。

* * *

首先，您需要确定每个小行星实例应该存在哪些数据，以及应该在所有小行星之间共享哪些数据。以及应该为您的整个程序共享哪些数据。

*   每个小行星都应该存在小行星位置
*   小行星纹理可以在小行星的每个实例之间共享
*   每个程序应该存在一个类的实例`Random`（技术上每个线程一次 - 但现在我们不要担心）

所以这就是代码中的样子。（**请注意**，为了便于阅读，我在整个答案中都散布了类的内容——您必须自己合并每个部分的代码。）

```
class Asteroid
{
    // Static variables are shared between all instances of a class
    static Texture2D asteroidTexture;

    // Non-static variables exist once for each instance of the class
    Vector2 position;

    // Constants are fixed at compile time and cannot be modified
    const float asteroidSpeed = 50; // units per second
}

// A static class can only contain static variables (and constants)
// (You can't create an instance of it, so you can't have variables.)
static class Shared
{
    // "readonly" prevents anyone from writing to a field after it is initialised
    public static readonly Random Random = new Random();
} 
```

* * *

接下来，您需要决定如何初始化和修改该数据：

注意（上面）我们是如何初始化类`Shared.Random`的新实例的`Random`。（实际初始化将在首次使用之前由运行时自动完成。）

首先让我们看看加载纹理：

```
class Asteroid
{
    // Static methods can only act on static data
    public static void LoadContent(ContentManager content)
    {
        asteroidTexture = content.Load<Texture2D>("asteroid");
    }
}

public class Game1 : Microsoft.Xna.Framework.Game
{
    protected override void LoadContent()
    {
        Asteroid.LoadContent(Content);
    }
} 
```

因为我们知道`Game1.LoadContent`在程序开始时会调用一次，所以它是一个合适的调用位置`Asteroid.LoadContent`。

* * *

现在让我们看看每个小行星的每个实例数据。每颗小行星在首次创建时都需要设置其位置。我们通过给`Asteroid`类一个构造函数来做到这一点，然后每当我们希望创建一个小行星时调用它。

```
class Asteroid
{
    public Asteroid(Vector2 position)
    {
        this.position = position;
    }
} 
```

现在我们要创建和存储我们的小行星类的多个实例：

我们使用一个循环来创建多个实例——每个实例在屏幕宽度内都有一个随机的 X 位置。我们在创建它们时使用一个列表来存储它们：

```
public class Game1 : Microsoft.Xna.Framework.Game
{
    List<Asteroid> asteroids = new List<Asteroid>();

    protected override void Initialize()
    {
        int screenWidth = GraphicsDevice.Viewport.Width;

        // Create 15 asteroids:
        for(int i = 0; i < 15; i++)
        {
            float xPosition = Shared.Random.Next(0, screenWidth);
            asteroids.Add(new Asteroid(new Vector2(xPosition, 0)));
        }
    }
} 
```

* * *

最后，我们要更新并绘制我们之前创建的列表中的每一个小行星。这是一个简单的循环遍历小行星列表，在每个实例上调用`Draw`or方法的问题。`Update`

```
class Asteroid
{
    public void Update(float elapsedSeconds)
    {
        position.Y += asteroidSpeed * elapsedSeconds;
    }

    public void Draw(SpriteBatch spriteBatch)
    {
        spriteBatch.Draw(asteroidTexture, position, Color.White);
    }
}

public class Game1 : Microsoft.Xna.Framework.Game
{
    protected override void Update(GameTime gameTime)
    {
        foreach(Asteroid asteroid in asteroids)
        {
            asteroid.Update((float)gameTime.ElapsedGameTime.TotalSeconds);
        }
    }

    protected override void Draw(GameTime gameTime)
    {
        foreach(Asteroid asteroid in asteroids)
        {
            asteroid.Draw(spriteBatch);
        }
    }
} 
```

请注意我考虑方法中经过的时间的`Update`方式。这就是为什么我之前在小行星速度上加上了“每秒单位”的评论。

这是一种很好的做法，因为它使您的游戏逻辑独立于您的游戏运行的帧速率。（默认情况下，XNA 以固定的帧速率运行 - 但无论如何编写与帧速率无关的代码是一个好习惯。）

* * *

**至此，您应该有完整的`Asteroid`类和使用它的代码。**让我们做一些补充：

你想知道如何让小行星不时坠落。为此，您需要在时间流逝时累积时间，并且每当达到某个阈值时，创建一个新的小行星并重置计时器。

```
public class Game1 : Microsoft.Xna.Framework.Game
{
    float asteroidSpawnTimer;
    const float asteroidSpawnDelay = 5; // seconds

    void CreateAsteroid()
    {
        // This is the same code as I used in Initialize().
        // Duplicate code is extremely bad practice. So you should now modify 
        // Initialize() so that it calls this method instead.

        int screenWidth = GraphicsDevice.Viewport.Width;
        float xPosition = Shared.Random.Next(0, screenWidth);
        asteroids.Add(new Asteroid(new Vector2(xPosition, 0)));
    }

    protected override void Update(GameTime gameTime)
    {
        // ... other stuff ...

        asteroidSpawnTimer += (float)gameTime.ElapsedGameTime.TotalSeconds;
        if(asteroidSpawnTimer >= asteroidSpawnDelay)
        {
            asteroidSpawnTimer -= asteroidSpawnDelay; // subtract "used" time
            CreateAsteroid();
        }
    }
} 
```

在添加小行星时 - 删除不再需要的旧小行星是个好主意 - 例如当它们到达屏幕底部时。

首先，您需要某种方式从外部访问小行星的位置。因为我们没有指定访问修饰符，所以我们的`position`字段默认为私有，不能在`Asteroid`类外访问。但是我们可以创建一个可以从外部访问的公共属性，它提供了以下位置：

```
class Asteroid
{
    public Vector2 Position { get { return position; } }
} 
```

（您可能希望考虑完全摆脱该`position`字段并使用带有私有设置器的[自动实现的属性。）](http://msdn.microsoft.com/en-us/library/bb384054.aspx)

当您希望它与小行星交互时，您将希望使用相同的方法来访问您的船对象的属性。对于一个简单的游戏来说，做这种对象间逻辑是可以的`Game1.Update`（[这里有一个深入的讨论](https://stackoverflow.com/a/5459955/165500)）。

无论如何，现在我们有了访问的方法`Asteroid.Position`，我们可以移除掉出屏幕的小行星。

```
public class Game1 : Microsoft.Xna.Framework.Game
{
    protected override void Update(GameTime gameTime)
    {
        // ... other stuff ...

        int screenHeight = GraphicsDevice.Viewport.Height;

        // Loop backwards through all asteroids.
        //
        // Note that you must iterate backwards when removing items from a list 
        // by index, as removing an item will change the indices of all items in
        // the list following (in a forward order) the item that you remove.
        for(int i = asteroids.Count - 1; i >= 0; i--)
        {
            if(asteroids[i].Position.Y > screenHeight)
                asteroids.RemoveAt(i);
        }
    }
} 
```

* * *

现在，这是一个非常长的答案 - 我已经涵盖了很多主题（在初学者级别）。所以有很多细节我没有涉及。因此，如果您对某事感到困惑 - 寻找我用来描述该事物的关键词并进行搜索。Microsoft 在 MSDN 上的文档是一个特别好的地方（[这里是 XNA 文档](http://msdn.microsoft.com/en-us/library/bb200104.aspx)）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T09:57:05.053

您可以将它们定义在一个数组中，并且在 Update 方法的固定时间间隔内，您可以根据 gameTime 添加一个新的小行星。希望这很有用

# sql - SET XACT_ABORT ON 在创建过程中不起作用

> ID：11382105
> 
> 赞同：0
> 
> 时间：2012-07-08T09:36:05.853
> 
> 标签：sql, sql-server, sql-server-2008, stored-procedures, xact-abort

我使用 SQL Server 2008 SP3 (10.0.5500) 并且我在回滚事务方面遇到了一些问题，首先我需要知道一些事情。这是我的创建过程脚本：

```
USE [MYDB]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET XACT_ABORT ON
GO

If Exists(Select * From Sys.Objects Where [object_id]=Object_Id(N'[Members].[MyProc]') And ObjectProperty([object_id], N'IsProcedure') = 1)
Begin
Drop Procedure [Members].[MyProc]
Print 'Procedure [Members].[MyProc] Dropped!'
End
GO

CREATE PROCEDURE [Members].[MyProc](

 ....

)
AS 
BEGIN
    BEGIN TRANSACTION [MyProcCHK]
    ....
    COMMIT TRANSACTION [MyProcCHK]
END
GO 
```

运行此脚本后，我检查程序来自：`MyDB ->Programmability->StoredProcedures`然后单击修改`[Members].[MyProc]`然后这是显示的脚本：

```
USE [MYDB]
GO
/****** Object:  StoredProcedure ... ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

ALTER PROCEDURE [Members].[MyProc](

 ....

)
AS 
BEGIN
    BEGIN TRANSACTION [MyProcCHK]
    ....
    COMMIT TRANSACTION [MyProcCHK]
END
GO 
```

那么在哪里`SET XACT_ABORT ON`？为什么这里没有显示？由于存储过程中的回滚事务存在一些问题，我认为`SET XACT_ABORT ON`从未保存过。我对吗？如果是，解决方案是什么？我不能`SET XACT_ABORT ON`在存储过程中使用？或者我的错在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T09:54:34.543

`set xact_abort on`您需要在 Create procedure 语句中提及

```
 CREATE PROCEDURE [Members].[MyProc](
 ........

 )
 AS
 SET XACT_ABORT ON
BEGIN
BEGIN TRANSACTION [MyProcCHK]
....
COMMIT TRANSACTION [MyProcCHK]
END
GO 
```

# border - 如何处理具有透明背景和背景图像的边框图像

> ID：11382112
> 
> 赞同：1
> 
> 时间：2012-07-08T09:37:13.463
> 
> 标签：border, background-image, transparent, css

> **可能重复：**
> [css3边框图像的透明png问题](https://stackoverflow.com/questions/4052295/css3-border-images-transparent-png-issue)

我有一个透明背景和宽度为 7px 的边框图像，如下所示：

![在此处输入图像描述](../Images/4db04a90020b42496b67dc65a7aa0fe6.png)

我在同一个 div 上有一个重复的背景图像，它要么与边框图像重叠，要么在我使用 CSS 时留下一个间隙：

```
background-clip: padding-box; 
```

父 div 上还有一个背景图像，这就是为什么我需要在外部的边框图像上使用透明背景。

所以我想知道我必须使用哪些选项来使重复的背景图像适合边框图像。我可以设置背景位置，但据我了解，我只能设置带有 x 和 y 值的起始位置，因此这不适用于右侧和底部位置。

也许那时我唯一的选择是用我在 Adob​​e Illustrator 中用作背景图像的图像填充边框图像，但是我必须弄清楚如何在 Illustrator 中的画板上重复图案。边框图像的中心部分如何在页面上重复也可能存在问题（即背景图像在边框图像的部分连接处看起来是否正常？）。

对于如何最好地实现我正在寻找的结果的任何建议，我将不胜感激。[您可以在此页面](http://soteriabrighton.co.uk/)上看到正在运行的边框图像。主要内容和侧边栏，以及向下滑动的联系表单都有一个与边框图像重叠的背景图像。

**截屏：**

![在此处输入图像描述](../Images/9587fa6e7047d845493a3a485129c2aa.png)

# delphi-xe2 - 如果 TeeOpenGL.Active 为真，则 TChart 不会在表单创建时呈现

> ID：11382115
> 
> 赞同：0
> 
> 时间：2012-07-08T09:37:24.510
> 
> 标签：delphi-xe2, teechart

如果我在 FormCreate 中将 TeeOpenGL.Active 设置为 true，则 TChart 将显示为白色空白方块。有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T08:09:43.297

恐怕这是一个错误。我已将它 (TV52016245) 添加到缺陷列表中，以便在下一个版本中修复。

# android - 语法错误，插入“枚举标识符”以完成 EnumHeaderName

> ID：11382116
> 
> 赞同：1
> 
> 时间：2012-07-08T09:37:27.273
> 
> 标签：android, eclipse

我最近开始学习在 android 中进行开发，现在我遇到了一个似乎无法修复的错误。这是由于*语法错误而无法编译的代码，插入“enum Identifier”以完成 EnumHeaderName*错误。我想这是微不足道的，但我找不到它。谢谢你的帮助

**编辑：这是完整的代码。**

不要对方法的功能感到困惑，我在这个项目中尝试了不同的东西，所以它们没有相互连接。

```
public class MainActivity extends Activity {
boolean running = false;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.activity_main, menu);
    return true;
}

public void findRoot(View view){
    EditText ed = (EditText)findViewById(R.id.editText1);
    double base = Double.parseDouble(ed.getText().toString());
    double res = Math.sqrt(base);

    TextView t = (TextView)findViewById(R.id.resultText);
    t.setText(getString(R.string.result_caption) + Double.toString(res));
}

int counter = 0;
final Handler mHandler = new Handler();    
final Runnable mUpdateView = new Runnable(){
    public void run(){
        updateStopWatchView();
    }
};

protected void startStopWatch(){
    Thread t = new Thread(){
        public void run(){
            counter++;
            mHandler.post(mUpdateView);
        }
    };

    t.start();
}

public void updateStopWatchView(){
    //
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T10:30:25.810

编辑：请升级到 ADT 20.0.1。该错误已得到修复。

* * *

只是在黑暗中拍摄：Eclipse 问题视图是否在此错误的“*类型”列中显示“Android Lint 问题”？*如果是这样，请打开查看*Lint 警告*并点击“全部删除”按钮。Lint 有时会感到困惑并接管 Java 错误，即使在错误已修复后仍保持活动状态。

# c# - 进程没有获取命令行参数

> ID：11382120
> 
> 赞同：-1
> 
> 时间：2012-07-08T09:37:53.747
> 
> 标签：c#, .net, process

我有 .NET 3.5 C# 应用程序，它正在运行带有参数的第二个应用程序。

如果我使用 Visual Studio 2012 RC 运行 C# 应用程序，它运行良好。但是当我通过快捷方式运行 C# 应用程序或双击其 .exe 文件时，它不会。

这就是我从 C# 应用程序启动第二个应用程序的方式：

```
serv = "100";
string cmd_args = " -nojoy -nomaster -nointro -game cstrike -appid 10 -gl -steam +connect 80.241.245.102:" + serv;
Process.Start(ucp_path, cmd_args); 
```

问题是第二个应用程序没有获取从 C# 应用程序传递给它的参数。

有谁知道出了什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T09:49:49.687

用引号 "\" [args] \"" 将你的论点括起来。还要检查路径是否是绝对的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T09:49:39.007

使用`ProcessStartInfo`：

```
Process.Start(new ProcessStartInfo(filename, arguments)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-08T12:54:51.360

使用您给定的信息，该错误无法重现，并且该进程正确接收所有参数，无论它是使用 VS 中的父程序还是使用父 ' exe（快捷方式）启动的。也许问题出在流程代码中，或者需要更多信息来回答这个问题。

# c# - 我什么时候应该加密我的配置文件？

> ID：11382121
> 
> 赞同：0
> 
> 时间：2012-07-08T09:37:59.177
> 
> 标签：c#, encryption, app-config

我有一个带有 app.config 文件的 C# 应用程序。该应用程序构建在构建服务器上并部署给多个用户。
我想对 app.config 进行加密，但我不确定何时这样做：如果我在构建后立即进行，加密不会依赖于构建服务器凭据吗？应用程序如何在其他机器上解密？如果我在用户机器上进行加密，这不会在 app.config 不受保护时留下时间吗？

谢谢

编辑：
我正在考虑使用[DPAPI](http://weblogs.asp.net/jgalloway/archive/2008/04/13/encrypting-passwords-in-a-net-app-config-file.aspx)。它使用用户的凭据来加密和解密。这就是为什么我认为向用户提供加密文件时可能会遇到问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T10:17:30.730

我刚刚阅读了您帖子的补充内容，我认为您实际上根本不需要加密...

您说您打算使用基于用户凭据进行加密/解密的系统。这意味着两件事：

1.  您在构建期间不加密；由于 yoy 指出的原因，您*不能*在构建期间使用这种系统。
2.  您似乎对有权访问数据的用户感到满意。在这种情况下，您根本不应该使用配置，但您应该提示他们输入登录信息（也许之后安全地保存以供重复使用）或仅使用他们的 Windows/域登录。

无论哪种方式，您都不需要加密文件来保护它......您只需将登录信息或其他配置信息存储为*用户设置*，而不是所有用户都可以读取的配置。

# sql - SSIS。晚上 10 点后停止跑步

> ID：11382125
> 
> 赞同：-4
> 
> 时间：2012-07-08T09:38:16.520
> 
> 标签：sql, sql-server, ssis

我有一个带有 for 循环的 SSIS 包。我想在我的 sql 数据库中保留值“10pm”，并且我希望每次循环检查它是否在“10pm”的这个值之后（或者我决定放入数据库中的任何内容）。如果现在时间是晚上 10 点之后，则停止循环。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T10:17:36.220

在 For 循环之前使用执行 SQl 任务。编写表达式以获取时间。

```
select case
      when DATEPART(hour,getdate()) > 12 
      then Parsename(replace(LTRIM(RIGHT(CONVERT(VARCHAR(20), GETDATE(), 100), 7)),':','.'),2)
      else 0
      End 
```

将上述值存储在变量中并在优先约束中检查变量值是否大于 10 然后失败否则成功

```
@Variable>10 
```

# xsd - 用于电视列表的 XML

> ID：11382129
> 
> 赞同：-1
> 
> 时间：2012-07-08T09:38:29.987
> 
> 标签：xsd

我有 webage tvguide [tvguide](http://www.tvguide.com/Listings/)，我在如何开始为它编码 xml 时遇到问题，只是示例数据我可以省略广告元素 XML 语言应该包括：
a。XML 样本数据
b. DTD 来定义样本数据
c．XML XSLT 或 XSL-FO
d．如果选择 XSLT，则为 CSS

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T09:47:09.507

你的问题不是很清楚：

1.  要从 xsd 生成 xml，您可以使用在线工具，例如：http: [//xmlgrid.net/genXml.html](http://xmlgrid.net/genXml.html)
2.  您还可以使用 Eclipse 或任何其他 IDE。
3.  为什么需要DTD？XSD 就像 DTD 只是更好。
4.  XSLT 有助于将一种 XML 转换为另一种，为什么需要它？
5.  CSS是如何相关的？

# java - 将类型参数 k 添加到 meth() 是什么意思？

> ID：11382130
> 
> 赞同：0
> 
> 时间：2012-07-08T09:38:32.140
> 
> 标签：java

我是 Java 新手，我无法理解两者之间的区别

```
public static <V> void meth() 
```

和

```
public static void meth() 
```

Q1。<V> 作为参数是什么意思？这是一个泛型类型，这是否意味着该方法返回/采用 V 类型的参数？

这是我的代码：

```
public static <V> void meth(){
     Map<K, V> m = new HashMap<K, V>();
} 
```

然后编译器显示错误：

" 将类型参数'k' 添加到 meth()<V> 中"
Q2.这是什么意思？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T09:40:30.907

您正在使用泛型类型 ( `Map<K, V>`and `HashMap<K, V>`)，`K`但未声明或称为类型。所以你要么需要创建一个类，要么给方法`K`添加一个类型参数`K`，这样编译器就知道`K`在使用它时应该是什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T09:46:06.740

您正在使用泛型。

K 和 V 在您的示例中不是定义的类型。它们用于创建对不同数据类型行为相同的泛型类。

如果您想了解更多关于它的信息，您可以去那里。

[http://en.wikipedia.org/wiki/Generics_in_Java](http://en.wikipedia.org/wiki/Generics_in_Java)

简而言之，你可能有类似的东西。

*   `List`# 将包含任何作为对象的对象
*   `List<Integer>`将是一个整数列表。
*   `List<String>`将是一个字符串列表

因此`K, V`，您可以使用类似`Map<Integer, String>`...

在泛型中，您放置的参数是类名而不是变量。

# jquery - jQuery：函数被多次触发

> ID：11382136
> 
> 赞同：0
> 
> 时间：2012-07-08T09:39:07.553
> 
> 标签：jquery, load, each

我有以下函数，它在某些 div（#block_profile）上执行 qtip2 工具提示，问题是它被多次触发。因此，如果我单击第 4 个 #block_profile 它会调用此函数 4 次。我怎样才能让它只针对已点击的确切 div 执行？

```
// Create the tooltips only on document load
$(document).ready(function () {
    // Make sure to only match links to wikipedia with a rel tag
    $('div.block_profile[rel]').each(function () {

        // We make use of the .each() loop to gain access to each element via the "this" keyword...
        $(this).qtip(
            {
                content:{
                    // Set the text to an image HTML string with the correct src URL to the loading image you want to use
                    text:'<img src="/assets/ux/modal/loading.gif" alt="Loading..." />',
                    ajax:{
                        url:'/profiles/get_info/' + $(this).attr('rel') // Use the rel attribute of each element for the url to load
                    },
                    title:{
                        button:false
                    }
                },
                position:{
                    my:'top left',
                    target: 'mouse',
                    viewport:$(window), // Keep the tooltip on-screen at all times
                    adjust:{
                        x:10, y:10
                    }
                },
                hide:{
                    fixed:false // Helps to prevent the tooltip from hiding ocassionally when tracking!
                },
                style:{
                    classes:'container ui-tooltip ui-tooltip-tip'
                }
            })
    })

        // Make sure it doesn't follow the link when we click it
        .click(function (event) {
            event.preventDefault();
        });
}); 
```

的HTML：

```
<div id ="block_profile" class ="block_profile rel="1">div 1</div>
<div id ="block_profile" class ="block_profile rel="2">div 2</div>
<div id ="block_profile" class ="block_profile rel="3">div 3</div>
<div id ="block_profile" class ="block_profile rel="4">div 4</div>
<div id ="block_profile" class ="block_profile rel="5">div 5</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T09:48:39.370

您应该使用以下代码：

```
// Create the tooltips only on document load
$(document).ready(function () {
    // Make sure to only match links to wikipedia with a rel tag
    $('div.block_profile[rel]')
        .qtip({
            ...
        })
        .click(function (event) {
            event.preventDefault();
        });
}); 
```

`each`没有必要打电话。例如查看[这个演示](http://craigsworks.com/projects/qtip/demos/content/basic)。

# objective-c - Core Data undo后台线程删除

> ID：11382148
> 
> 赞同：0
> 
> 时间：2012-07-08T09:41:30.530
> 
> 标签：objective-c, core-data

我正在开发一种用户在画布上设置点的绘图应用程序。正在绘制的内容存储为 NSManagedObjects。我还启用了撤消管理器，因此用户可以通过按下按钮来撤消最后的绘图手势。

这一切都按预期工作。

然后我有一个按钮可以删除画布上的所有内容（清除画布）。当按下时，我在后台线程上进行删除操作，因为它可能需要一段时间，我想显示一个进度条。然后我将后台线程的模型对象上下文与主线程的模型对象上下文合并。这也很好。

但我希望用户只需点击撤消按钮即可撤消完整的删除操作。这是我无法做到的。

对于多线程部分，我正在关注本教程：[http ://www.cimgf.com/2011/05/04/core-data-and-threads-without-the-headache/](http://www.cimgf.com/2011/05/04/core-data-and-threads-without-the-headache/)

似乎除了两个线程的合并之外，我无法撤消它（虽然它工作过一次，但我不知道为什么）。不知道我是否应该将整个事情嵌套在撤消组中。我已经尝试过，但仍然没有运气。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T17:52:23.577

我相信您可以使用嵌套的撤消组来做到这一点。包装您的操作并合并

```
-(void)beginUndoGrouping;
-(void)endUndoGrouping; 
```

...并用于`-(void)undoNestedGroup`撤消。

# windows - 为什么我的按钮同时保持突出显示？

> ID：11382150
> 
> 赞同：0
> 
> 时间：2012-07-08T09:41:46.227
> 
> 标签：windows, winapi, visual-c++, button, window

您通常只有*一个*看起来像“默认按钮”的按钮。

但是，我制作了一个子窗口并在其中放置了两个按钮（以子窗口为父窗口）。然后我将子窗口放在一个对话框中并显示它。

突然，即使我单击其他按钮，这些按钮也会*保持突出显示！*

为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T09:41:47.193

您的子窗口需要`WS_EX_CONTROLPARENT`样式，以允许对话框处理来自其子级的通知。

# ffmpeg - 使用 ffmpeg 转码和生成缩略图

> ID：11382153
> 
> 赞同：2
> 
> 时间：2012-07-08T09:41:55.587
> 
> 标签：ffmpeg

使用 ffmpeg 并假设它是可行的，我如何将输入视频从一种格式转换为另一种格式（例如 MPEG-2 到 MPEG-4）并同时每*n*秒生成缩略图？

问候， 马特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-03-21T00:17:18.340

此命令将接收.flv 并转码为 .webm 和 .mp4，同时生成单个缩略图。

```
ffmpeg -y -threads '1' -i 'in.flv' \
  -map '0:v' -map '0:a' -c:v 'libx264' -c:a 'libvo_aacenc' out.mp4 \
  -map '0:v' -map '0:a' -c:v 'libvpx' -c:a 'libvorbis' out.webm \
  -map '0:v' -r '1' -t '1' 'out.png' 
```

要每 n 秒生成一个缩略图，请将 -r（帧速率）更改为 n 的倒数并删除 -t（以便在视频结束之前拍摄缩略图）。例如，要每 4 秒生成一个缩略图，您需要 1/4 的帧速率。

```
ffmpeg -y -threads '1' -i 'in.flv' \
  -map '0:v' -map '0:a' -c:v 'libx264' -c:a 'libvo_aacenc' out.mp4 \
  -map '0:v' -map '0:a' -c:v 'libvpx' -c:a 'libvorbis' out.webm \
  -map '0:v' -r '1/4' 'out-%d.png' 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-09T07:53:30.060

看看gstreamer，你可以在管道的每个阶段访问数据。所以要将 MPEG-4 转换为 MPEG-2 ，你做

```
filesrc | decodebin | tee | jpegencode | filesink(thumbnail) tee | mpeg2enocde | filesink(mpeg2 file) 
```

请查找 gstreamer 管道的确切元素。

# google-bigquery - 影响查询性能的 BigQuery 表属性

> ID：11382154
> 
> 赞同：0
> 
> 时间：2012-07-08T09:42:08.840
> 
> 标签：google-bigquery

此问题与 BigQuery 中查询数据的性能有关。

任何会影响查询性能的特定表或列设置，或者表中的所有列实际上是否被 BigQuery 平等对待，以便列的顺序或应用于列的任何定义不会以任何可区分的方式影响数据获取？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T15:47:33.783

BigQuery 平等对待所有列。顺序根本不重要。没有任何设置会影响性能，但是如果您以非常多的小块（例如，超过几千个）导入表格，则可能会导致速度变慢。

# java - 休息。球衣。如何以编程方式选择要返回的类型：JSON 还是 XML？

> ID：11382158
> 
> 赞同：11
> 
> 时间：2012-07-08T09:42:31.107
> 
> 标签：java, xml, json, rest, jersey

我有两个问题：

**1.**我可以创建**一个**类，用 JAXB 注释（用于 XML 支持）注释它并声明`web.xml`

```
<init-param>
    <param-name>com.sun.jersey.api.json.POJOMappingFeature</param-name>
    <param-value>true</param-value>
</init-param> 
```

JSON（杰克逊库）支持？或者我需要为 JSON 和 XML 分别创建两个类？

或者可能存在一些更优雅的方式来导致 REST 服务返回 JSON 和 XML？

**2.**如何以编程方式选择要返回的类型（JSON 或 XML）？

谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-08T11:16:10.203

**注意：** 我是[**EclipseLink JAXB (MOXy)**](http://www.eclipse.org/eclipselink/moxy.php)负责人，也是[JAXB (JSR-222)](http://jcp.org/en/jsr/detail?id=222)专家组的成员。

* * *

> 我可以创建一个类，使用 JAXB 注释（用于 XML 支持）对其进行注释并在 web.xml 中声明以支持 JSON（杰克逊库）吗？

您始终可以使用`Application`类来为 JSON 绑定指定`MessageBodyReader`/ `MessageBodyWriter`。我相信杰克逊在其 jar 中提供了一个实现。下面是一个将`Application`MOXy 指定为 JSON 提供程序的类的示例：

```
package org.example;

import java.util.*;
import javax.ws.rs.core.Application;
import org.eclipse.persistence.jaxb.rs.MOXyJsonProvider;

public class CustomerApplication  extends Application {

    @Override
    public Set<Class<?>> getClasses() {
        HashSet<Class<?>> set = new HashSet<Class<?>>(2);
        set.add(MOXyJsonProvider.class);
        set.add(CustomerService.class);
        return set;
    }

} 
```

> 或者我需要为 JSON 和 XML 分别创建两个类？

EclipseLink JAXB (MOXy) 提供原生 XML 绑定，旨在使您能够[对 JSON 和 XML 使用相同的对象模型](http://blog.bdoughan.com/2011/08/binding-to-json-xml-geocode-example.html)。您可以使用以下类将其集成到您的 JAX-RS 应用程序中`MOXyJsonProvider`：

*   [http://blog.bdoughan.com/2012/05/moxy-as-your-jax-rs-json-provider.html](http://blog.bdoughan.com/2012/05/moxy-as-your-jax-rs-json-provider.html)

* * *

> 如何以编程方式选择要返回的类型（JSON 或 XML）？

**服务器端**

`@Produces`您可以使用注释指定您的服务同时提供 XML 和 JSON 消息。

```
@GET
@Produces({MediaType.APPLICATION_XML, MediaType.APPLICATION_JSON})
@Path("{id}")
public Customer read(@PathParam("id") long id) {
    return entityManager.find(Customer.class, id);
} 
```

***了解更多信息***

*   [http://blog.bdoughan.com/2012/03/moxy-as-your-jax-rs-json-provider.html](http://blog.bdoughan.com/2012/03/moxy-as-your-jax-rs-json-provider.html)

**客户端**

您可以使用 MediaType 来指示消息的类型。下面是一个使用 Jersey 客户端 API 的示例。注意 URL 是一样的，只是请求的媒体类型不同。

```
Client client = Client.create();
WebResource resource = client.resource("http://localhost:8080/CustomerService/rest/customers");

// Get XML response as a Customer
Customer customer = resource.path("1")
    .accept(MediaType.APPLICATION_XML)
        .get(Customer.class);
System.out.println(customer.getLastName() + ", "+ customer.getFirstName());

// Get JSON response as a Customer
Customer customer = resource.path("1")
    .accept(MediaType.APPLICATION_JSON)
        .get(Customer.class);
System.out.println(customer.getLastName() + ", "+ customer.getFirstName()); 
```

***了解更多信息***

*   [http://blog.bdoughan.com/2010/08/creating-restful-web-service-part-55.html](http://blog.bdoughan.com/2010/08/creating-restful-web-service-part-55.html)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-07-08T11:09:22.210

如果您的客户端想要使用 URL 的一部分来配置响应类型，您可以使用 Servlet 过滤器。

实现覆盖表示（媒体类型）的简单方法可以使用 URL 查询参数：

/resources/todo?format=json

Servlet 过滤器解析 URL 查询参数，如果 format=json 存在，则替换或添加接受标头“application/json”。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-08T09:58:41.760

不需要单独的类，您需要的是单独的方法：

```
@GET
@Produces({ MediaType.APPLICATION_XML, MediaType.APPLICATION_JSON })
public Todo getXML() {
    Todo todo = new Todo();
    todo.setSummary("This is my first todo");
    todo.setDescription("This is my first todo");
    return todo;
} 
```

然后在客户端，当您请求服务时，您需要以什么格式指示它：

```
// Get XML
System.out.println(service.path("rest").path("todo").accept(MediaType.TEXT_XML).get(String.class));
// Get XML for application
System.out.println(service.path("rest").path("todo").accept(MediaType.APPLICATION_XML).get(String.class));
// Get JSON for application
System.out.println(service.path("rest").path("todo").accept(MediaType.APPLICATION_JSON).get(String.class)); 
```

# security - tomcat 7 基于表单的身份验证

> ID：11382159
> 
> 赞同：4
> 
> 时间：2012-07-08T09:42:43.697
> 
> 标签：security, authentication, tomcat, servlets, form-authentication

给定一个 Servlet HelloServlet：

```
@WebServlet("/HelloServlet")
public class HelloServlet extends HttpServlet {
    private static final long serialVersionUID = 1L;

    /**
     * Default constructor.
     */
    public HelloServlet() {
    // TODO Auto-generated constructor stub
    }

   @Override
    protected void doGet(HttpServletRequest request,
        HttpServletResponse response) throws ServletException, IOException {
    // TODO Auto-generated method stub
    System.out.print("hello my Friend: " + request.getRemoteUser());
    response.setContentType("text/html");
    PrintWriter out = response.getWriter();
    out.println("This is the Test Servlet");

    Enumeration headerNames = request.getHeaderNames();
    while (headerNames.hasMoreElements()) {
        String headerName = (String) headerNames.nextElement();
        out.print("<br/>Header Name: <em>" + headerName);
        String headerValue = request.getHeader(headerName);
        out.print("</em>, Header Value: <em>" + headerValue);
        out.println("</em>");
    }
    }
....
} 
```

在 web.xml 中声明了 tomcat 安全策略：

```
<security-constraint>
    <web-resource-collection>
        <web-resource-name>my application</web-resource-name>
        <url-pattern>/*</url-pattern>
        <http-method>GET</http-method>
        <http-method>POST</http-method>
    </web-resource-collection>

    <auth-constraint>
        <role-name>tomcat</role-name>
    </auth-constraint>
</security-constraint>
<login-config>
    <auth-method>FORM</auth-method>
    <form-login-config>
        <form-login-page>/login.jsp</form-login-page>
        <form-error-page>/login-failed.jsp</form-error-page>
    </form-login-config>
</login-config> 
```

和 conf/tomcat-users.xml 中的 tomcat-roles 定义

```
 <role rolename="tomcat"/>
  <role rolename="role1"/>
  <user username="tomcat" password="tomcat" roles="tomcat"/>
  <user username="both" password="tomcat" roles="tomcat,role1"/>
  <user username="role1" password="tomcat" roles="role1"/> 
```

“server.xml”中的领域是：

```
 <Realm className="org.apache.catalina.realm.LockOutRealm">
    <!-- This Realm uses the UserDatabase configured in the global JNDI
         resources under the key "UserDatabase".  Any edits
         that are performed against this UserDatabase are immediately
         available for use by the Realm.  -->
    <Realm className="org.apache.catalina.realm.UserDatabaseRealm"
           resourceName="UserDatabase"/>
  </Realm> 
```

，我尝试使用 url localhost/jsfWorkgroup/HelloServlet 访问 Servlet“HelloServlet”。

像预期的那样，我被（重新）定向到登录页面：

```
<form method="POST" action="j_security_check">
<table>
  <tr>
    <td colspan="2">Login to the Tomcat-Demo application:</td>
  </tr>
  <tr>
    <td>Name:</td>
    <td><input type="text" name="j_username" /></td>
  </tr>
  <tr>
    <td>Password:</td>
    <td><input type="password" name="j_password"/ ></td>
  </tr>
  <tr>
    <td colspan="2"><input type="submit" value="Go" /></td>
  </tr>
</table>
</form> 
```

无论我使用哪个 id-Token：

1.  用户名：tomcat 密码：tomcat
2.  用户名：两个密码：tomcat

我还是来了失败/login-failed.jsp。

这是我对此的看法：tomcat 将我重定向到登录页面，但不会读取 conf/tomcat-users.xml 来验证我的登录（即使在多次重新启动后）。

你怎么看待这件事 ？

配置：Tomcat 7.0.23，Eclipse-Indigo

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T16:30:43.267

遵循@pd40 的提议，我尝试了示例/jsp/security/protected/ 示例，但不在 Eclipse IDE 中，Tomcat 通常与其他服务器（Glassfish、JBoss 等）一起嵌入，而是我启动了 tomcat 服务器作为独立的（在其 /bin 目录中）.. 它在那里工作。

但是当它试图在 Eclipse 中的 Tomcat 中运行基于安全的 Web 应用程序时，它再次失败，即使使用上述配置也是如此。

我不知道我是否正确，但只有当tomcat在eclipse之外运行时才支持Web-Application Security ..

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-21T04:24:00.930

这对我来说太迟了，但也许来这里的人可能会觉得这很有用。

实际上，如果您遇到无法通过 eclipse 运行 tomcat 配置并在其外部运行的问题，那么只需从 eclipse 服务器选项卡中删除服务器并再次添加。这应该可以解决问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-08T10:30:30.630

tomcat 示例 web.xml 包括以下部分`<login-config>`：

```
<!-- Security roles referenced by this web application -->
<security-role>
  <role-name>role1</role-name>
</security-role>
<security-role>
  <role-name>tomcat</role-name>
</security-role> 
```

您可能需要。

* * *

Tomcat 包含一个示例战争，其中包含使用**tomcat-users.xml**的身份验证，类似于您正在尝试的内容。如果部署了**tomcat home/webapps/examples**，请尝试访问**http://localhost/examples/jsp/security/protected/**。确保已删除围绕**tomcat-users.xml**的角色/用户部分的 XML 注释。它们默认被注释掉。

```
<!-- Un comment me 
<role rolename="tomcat"/>
<role rolename="role1"/>
<user username="tomcat" password="tomcat" roles="tomcat"/>
<user username="both" password="tomcat" roles="tomcat,role1"/>
<user username="role1" password="tomcat" roles="role1"/>
--> 
```

* * *

您可以考虑增加[日志记录](http://tomcat.apache.org/tomcat-7.0-doc/logging.html)以帮助诊断身份验证问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-09-20T08:36:35.557

通过在 web.xml 中定义安全页面，您可以限制对内容的访问：

```
<url-pattern>/*</url-pattern> 
```

该通配符是指内容路径中的所有页面。因此，您获得了重定向到登录页面的不定式循环。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-10-15T10:45:34.240

我发现如果您更改嵌入在 eclipse 中的 tomcat-users.xml 中的用户配置，您必须重新启动 eclipse 而不仅仅是服务器才能识别新用户。我猜 Eclipse 缓存了 tomact-user.xml 文件。

# algorithm - 计算圆形地图上两点之间的距离

> ID：11382161
> 
> 赞同：8
> 
> 时间：2012-07-08T09:42:48.987
> 
> 标签：algorithm, 2d

我目前正在尝试创建一个视频游戏，其中角色是 AI，并且位于带有资源的圆形地图中。

我目前正在尝试计算此地图上 2 点之间的最短距离，但我的问题是地图是圆形的：例如

如果我的地图是 20*20 并且我在 (0,0) 中，则 (19,0) 点的距离仅为 1。我一直在网上寻找，但我没有找到我的问题的答案。我也必须注意我的角色的方向（南北西东），因为他必须转身去点，距离必须更长。

有现成的公式吗？

谢谢阅读 ！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-08T09:47:05.577

对于每个坐标选择最小距离，然后像往常一样使用它。

```
int dx = min(abs(x0-x1),20-abs(x0-x1));
int dy = min(abs(y0-y1),20-abs(y0-y1)); 
```

对于欧几里得距离：

```
double dist = sqrt(dx * dx + dy * dy); 
```

对于曼哈顿距离：

```
int dist = dx + dy; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-08T09:46:11.667

该问题仍然是图中的[最短路径问题](http://en.wikipedia.org/wiki/Shortest_path_problem)，您只需为圆形地图添加边：

`G = (V,E)`在哪里`V = {all squares}`和`E = { (u,v) | [(u.x + 1 % 20 = v.x or u.x -1 % 20 = v.x) and u.y == v.y] or ... [same for y] }`

上面的数学符号表示：当（且仅当）两个正方形之间存在一条边时，它们的 x 或 y 坐标之间的差异在 Z [20]（模数 20 环）中为 1 或 -1。由于环 Z [20]本身是圆形的 - 它解决了地图的圆形问题。

鉴于此图，您可以使用[BFS](http://en.wikipedia.org/wiki/Breadth-first_search)从单个源中找到最短路径（不需要 dijkstra 算法，因为该图未加权）

注意：如果没有障碍物，只需使用常规距离函数进行计算，但在数学中使用 Z [20]环而不是 Z 字段。

# php - 在 php 或 python/其他东西中阅读 RSS 提要？

> ID：11382163
> 
> 赞同：0
> 
> 时间：2012-07-08T09:43:30.810
> 
> 标签：php, python, symfony

我目前正在 Symfony2 框架中开发一个网站，并且我编写了一个每 5 分钟运行一次的命令，它需要读取大量的 RSS 新闻提要，从中获取新项目并将它们放入我们的数据库中。

现在，该命令需要大约 45 秒才能运行，在这 45 秒内，它还需要大约 50% 到 90% 的 CPU，尽管我已经对其进行了很多优化。

所以我的问题是，用其他东西（例如 python）重写相同的命令是个好主意吗？可用于 python 的 RSS/Atom 库是否比可用于 PHP 的库更快、更优化？

在此先感谢，雅普

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T09:47:44.783

您可以使用 lxml 解析原始 XML，其中用户是 libxml C iibrary 的基础：

[http://lxml.de/parsing.html](http://lxml.de/parsing.html)

因为解析是使用本机代码完成的，所以速度很快。

有人已经在做：

[使用 lxml 解析 RSS 时出现编码错误](https://stackoverflow.com/questions/5812009/encoding-error-while-parsing-rss-with-lxml)

另一方面，如果瓶颈不是 XML 解析，而是下载数据并对其进行整理，那么瓶颈就在其他地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T12:44:26.697

通过在每次提要迭代结束时添加一个 usleep() 函数来解决这个问题。这大大降低了 CPU 和内存消耗。过去这个过程大约需要 20 分钟，现在只需要大约 5 分钟！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-09T10:17:20.263

您可以尝试在解析它们之前先检查提要的缓存标头。
通过这种方式，您可以节省可能大量提要的昂贵的解析操作。

在您的数据库中为源存储一个 last_updated 日期，然后检查可能的缓存标头。有几个，所以看看什么最适合或服务最多或检查所有。
标头可以是：

*   过期
*   最后修改
*   缓存控制
*   编译指示
*   电子标签

但请注意：您必须信任您的提要来源。
并非每个提要都提供此类标题或正确提供它们。
但我相信他们中的很多人都这样做。

# php - 如何在 curl 中使用多个代理？

> ID：11382169
> 
> 赞同：0
> 
> 时间：2012-07-08T09:44:53.550
> 
> 标签：php, curl, proxytunnel

这个问题已经[在这里](https://stackoverflow.com/questions/8022672/curl-using-multiple-proxies-in-a-chain)问过了，但没有具体的答案。

下面的 PHP 函数使用给定的代理获取页面。我可以使用 curl 使用两个代理来获取页面吗？例如：我可以使用代理 xxxx:x 获取页面[http://example.com](http://example.com)我想做的是，使用代理 xxxx:x 获取页面[http://example.com](http://example.com)但 xxxx:x 应该是彻底连接 yyyy:y (我的服务器->proxy1->proxy2->destination )

```
 function fetchPage($proxy, $url, $timeout) {
        $ch = curl_init();
        curl_setopt($ch, CURLOPT_URL, $url);
        curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
        curl_setopt($ch, CURLOPT_PROXY, $proxy);   
        curl_setopt($ch, CURLOPT_HTTPPROXYTUNNEL, 1);

        $result = curl_exec($ch);

        curl_close($ch);

        return $result;
    } 
```

# android - 在 ANativeWindow_lock() 期间只写入一些像素

> ID：11382170
> 
> 赞同：0
> 
> 时间：2012-07-08T09:44:55.423
> 
> 标签：android, android-ndk

当仅将一些像素写入使用 ANativeWindow_lock() 获得的像素缓冲区时，我注意到一些奇怪的行为。假设我想画一条从 (0|0) 到 (320|240) 的线。为此，我调用 ANativeWindow_lock() 并将边界参数设置为：

```
ARect b;
b.left = 0;
b.top = 0;
b.right = 320;
b.bottom = 240; 
```

然后我使用 Bresenham 的算法将我的线画到像素缓冲区。因为这条线不是直的，所以我只需要修改从 ANativeWindow_lock() 获得的像素缓冲区中的极少数像素。在我的 Bresenham 实现修改的像素缓冲区中，它主要是每个扫描线只有一个像素。像素缓冲区的其余部分保持不变。

现在出现了奇怪的行为：当我现在调用 ANativeWindow_unlockAndPost() 时，我没有修改的所有像素通常包含一些随机颜色，而不是最后绘制的颜色。这让我很困惑：为什么这些像素不保留我上次写给它们的颜色值？

考虑以下案例以了解发生了什么：

1.  用蓝色填充整个屏幕。
2.  用红色填充整个屏幕。
3.  在整个屏幕上画一条对角线。
4.  现在我没有修改的像素缓冲区部分突然出现在蓝色，尽管我在画线之前已经将屏幕清除为完全红色。

有人解释为什么会这样吗？解决此问题的唯一方法是始终修改从 ANativeWindow_lock() 获得的像素缓冲区中的所有像素。但是当然，如​​果只需要绘制一些像素，这通常意味着很多开销，例如在线条的情况下！

在 Android 2.3 和 3.1 上测试。

有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T12:56:29.010

David Turner 解释了 Android NDK 邮件列表中发生的事情：Android 使用双重甚至三重缓冲，这就是为什么在调用 ANativeWindow_lock() 时不能对像素缓冲区中的内容做出任何假设，并且总是必须刷新矩形中的所有像素应该更新。

# sharepoint - 错误：Sharepoint 2010 Web 部件。图表处理程序配置中的临时目录无效

> ID：11382173
> 
> 赞同：0
> 
> 时间：2012-07-08T09:45:20.840
> 
> 标签：sharepoint

我有一个 sp2010 网站，我正在尝试对图像使用网络路径，因为我有一个 WebFarm，它使用 CISCO ACE 设备硬件进行负载平衡（没有 IP 粘性）。我使用网络共享文件夹的原因是有时图表不显示 PNG 图像。我正在使用带有 Timer 的 UpdatePanel 每分钟更新一次图表。

当我最初有如下所示的 web.config 设置时，在 Web Farm 中显示 PNG 图像的问题就出现了。

```
<add key="ChartImageHandler" value="storage=file;timeout=10;dir=c:\TempImageFiles\;" /> 
```

因此，我根据文章使用了网络共享路径，其中我对每个人都有完整的权限，网络服务。

以下是我对网络共享文件夹路径的当前设置，我不断收到此错误：图表处理程序配置中的临时目录无效

```
<add key="ChartImageHandler" value="storage=file;timeout=10;dir=\\servername\TempImageFiles\;" /> 
```

有人可以帮忙吗。

Rgds,

SSP

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T09:54:30.813

AFAIK，您不能在图表的`dir`属性中提供 UNC 路径，而是您可以做的是将网络路径映射到服务器上的驱动器并将该路径用作图表的`dir`值，例如映射`\\servername\TempImageFiles\`到`z:\`驱动器并使用它

```
 value="storage=file;timeout=10;dir=z:\;" 
```

# c# - issue to use contains() method in wpf

> ID：11382176
> 
> 赞同：0
> 
> 时间：2012-07-08T09:45:33.847
> 
> 标签：c#, wpf

I tried to check the given value is contained or not in particular field. Here the code what i wrote

```
bool _Contains = LabelDetails.Name.Contains("1"); 
```

Now want to check multiple value in cantains method.I tried like below but showing exception("**No overload for method 'Contains' takes 3 arguments**");

```
bool _Contains = LabelDetails.Name.Contains("1","2","3"); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-08T09:47:58.630

That is because [`Contains`](http://msdn.microsoft.com/en-us/library/dy85x1sa.aspx) just checks whether a substring exists in the given string. How should it know what you would mean by `.Contains("foo", "bar")`? Contains one of the two? Contains both? Contains them one after the other but not the other way around?

You could use a regex to check for existence of one of a given list of strings:

```
Regex.IsMatch("foo|bar|baz", LabelDetails.Name) 
```

or create a few extension methods:

```
public static bool ContainsAll(this string s, params string[] args) {
    foreach (string x in args) {
        if (!s.Contains(x)) return false;
    }
    return true;
}

public static bool ContainsAny(this string s, params string[] args) {
    foreach (string x in args) {
        if (s.Contains(x)) return true;
    }
    return false;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-08T10:03:39.237

I assumed that you have one textbox with text values.Then you want check some list values are contained or not in your text box and get the result in bool(true or false). True means you want to do something.False means you want to do something

```
List<string> Items = new List<string>() { "1", "2", "3" };
foreach (string item in Items)
{
    bool _Contains = TextBox.Text.Contains(item);
     if (_Contains == true)
        {
           //do something
        }
    else
       {
          //do something
       }
 } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-08T10:09:01.357

You can achieve this by passing the name in a custom method also if you want you make this as extension method of the string class

```
public bool Contains(string name, params string[] pStrings )
{
    return pStrings.Any(pString => name.Contains(pString));
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-08T10:15:08.890

You can refer to In Extension method

[https://stackoverflow.com/a/833477/649524](https://stackoverflow.com/a/833477/649524)

```
public static bool In<T>(this T source, params T[] list)
{
  if(null==source) throw new ArgumentNullException("source");
  return list.Contains(source);
} 
```

# mysql - 返回具有相同计数的所有值

> ID：11382178
> 
> 赞同：0
> 
> 时间：2012-07-08T09:45:51.327
> 
> 标签：mysql, sql

我有以下查询

```
select id, nameOfPet, count(fed)
from petLover, pets
where id = 180 and petLover.nameOfPet = pets.nameOfPet
group by fed
order by fed desc; 
```

因此，查询所做的是获取一个人的 id，获取他拥有的所有宠物的名称，在表中查找同一个人的 pets，并检查哪个宠物已经喂了多少次，然后输出这个人的 id，即宠物的名字宠物以及喂食的频率。

现在我只想输出喂得最多的宠物。我当然可以使用`limit 1`，但如果几只宠物的喂食次数相同，我想全部输出。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T09:55:55.630

嵌套查询派生了计数。除了只有一列之外，它与最外面的查询相同。

```
select id, nameOfPet, count(fed)
from petLover, pets
where id = 180 and petLover.nameOfPet = pets.nameOfPet
group by fed
having count(fed) >= ALL (
    select count(fed)
    from petLover, pets
    where id = 180 and petLover.nameOfPet = pets.nameOfPet
    group by fed
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T10:07:34.650

您发布的查询不会运行；您需要按 id、nameOfPet 分组。这是个人偏好，但我也会指定您的联接（以使其更具可读性并且更容易在联接类型之间进行更改）：

```
SELECT id, nameOfPet, COUNT(p.fed)
FROM petLover pl
LEFT OUTER JOIN pets p ON pl.nameOfPet = p.nameOfPet
WHERE id = 180
GROUP BY id, nameOfPet
ORDER BY COUNT(p.fed) 
```

LEFT OUTER JOIN 将确保您从 petLover 返回所有结果，即使没有喂食（即，如果没有喂食，您将返回所有 petLovers）。如果您只想要动物喂食后的结果，请将其更改回 INNER JOIN。这是一个修改后的查询，用于执行您要查找的内容（基于行）：

```
SELECT pl.id, pl.nameOfPet, COUNT(*)
FROM petLover pl
LEFT OUTER JOIN pets p ON pl.nameOfPet = p.nameOfPet
GROUP BY pl.id, pl.nameOfPet
HAVING COUNT(*) >= ALL (
    SELECT COUNT(*)
    FROM petLover pl
    LEFT OUTER JOIN pets p ON pl.nameOfPet = p.nameOfPet
    GROUP BY pl.id, pl.nameOfPet
)
ORDER BY COUNT(*) DESC 
```

* * *

**编辑**

除了原始评论中我的问题的答案之外，您应该能够执行以下操作来修改上面的 SQL：

```
SELECT pl.id, pl.nameOfPet, SUM(p.fed)
FROM petLover pl
LEFT OUTER JOIN pets p ON pl.nameOfPet = p.nameOfPet
GROUP BY pl.id, pl.nameOfPet
HAVING SUM(p.fed) >= ALL (
    SELECT SUM(p.fed)
    FROM petLover pl
    LEFT OUTER JOIN pets p ON pl.nameOfPet = p.nameOfPet
    GROUP BY pl.id, pl.nameOfPet
)
ORDER BY SUM(p.fed) DESC 
```

# excel - 分析服务 - 拒绝访问特定维度和相关度量数据

> ID：11382182
> 
> 赞同：0
> 
> 时间：2012-07-08T09:46:15.180
> 
> 标签：excel, sql-server-2008-r2, ssas

我无法弄清楚为什么会发生以下事情以及如何正确实施它:-)。

我创建了一个简单的多维数据集，它基于具有一个事实表和四个维度的星型模式。然后我想做的是只允许使用角色定义访问特定的销售组织（这是维度之一）。在“维度数据”选项卡中定义允许的销售组织后，我认为与被拒绝的销售组织相关的所有度量数据将不再可见。但它们仍然存在......从我的 Excel 客户端我无法看到其他销售组织，但要检索与我允许的销售组织相关的数据，我仍然必须手动过滤。

在我的情况下，这些度量数据是销售配额数。因此，在 Excel 中访问多维数据集时，我仍然会看到所有销售配额数据的累积数量。在为允许的销售组织设置过滤器后，该数字将更改为正确的值。

但我做错了吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T14:03:25.560

在角色定义中配置维度安全性时，听起来您需要[启用视觉总计]。

这是一篇不错的博客文章，其中包含更多详细信息... [http://blogs.microsoft.co.il/blogs/barbaro/archive/2008/02/06/visual-totals-in-mdx-and-role-security.aspx](http://blogs.microsoft.co.il/blogs/barbaro/archive/2008/02/06/visual-totals-in-mdx-and-role-security.aspx)

# php - 代码是否在函数中的区别

> ID：11382186
> 
> 赞同：0
> 
> 时间：2012-07-08T09:47:29.040
> 
> 标签：php

我有这个代码：

```
$img=imagecreatefrompng('http://partner-ad.photobucket.com/albums/g46/xanatha/WidgieWorld/Small-Yellow-Ball.png');

function foo($x,$y)
{
    $col=imagecolorat($img,$x,$y);
    $col=imagecolorsforindex($img,$col);
    var_dump($col);
}
foo(0,0);

echo '<br />';

$col=imagecolorat($img,0,0);
$col=imagecolorsforindex($img,$col);
var_dump($col); 
```

乍一看，我们会认为它会输出两次相同的结果。

但输出是：

```
NULL
array(4) { ["red"]=> int(255) ["green"]=> int(255) ["blue"]=> int(255) ["alpha"]=> int(0) } 
```

怎么会这样？
我必须做什么才能将代码放入函数中并使其工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T09:49:27.083

您是否尝试通过`$img`as 参数？

或者，如果您真的坚持不`$img`作为论点传递。你也可以把它放在你的函数的顶部。

```
global $img; 
```

正如有人所说的这个问题。`$img`未在函数范围内定义。要访问它，您要么必须使用`global`它是否为全局变量。或者您必须将其作为参数传递。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T09:52:48.210

`$img`在函数内部不可见。您必须在函数内使用关键字 global 使其可见。

```
$img=imagecreatefrompng('http://partner-ad.photobucket.com/albums/g46/xanatha/WidgieWorld/Small-Yellow-Ball.png');

function foo($x,$y)
{
    global $img; //<--------------Makes $img visible inside the function
    $col=imagecolorat($img,$x,$y);
    $col=imagecolorsforindex($img,$col);
    var_dump($col);
}
foo(0,0);

echo '<br />';

$col=imagecolorat($img,0,0);
$col=imagecolorsforindex($img,$col);
var_dump($col); 
```

见[php.net/manual/language.variables.scope.php](http://php.net/manual/language.variables.scope.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-08T09:50:32.777

```
function foo($x,$y,$img)
{
    $img_png = imagecreatefrompng($img);
    $col=imagecolorat($img_png,$x,$y);
    $col=imagecolorsforindex($img_png,$col);
    var_dump($col);
}
foo(0,0,'http://partner-ad.photobucket.com/albums/g46/xanatha/WidgieWorld/Small-Yellow-Ball.png'); 
```

无法访问在函数外部定义的变量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-08T09:50:55.557

变量具有*函数作用域*。`$img`未定义且在您的`foo`函数中不可用。您还需要将其传递给函数。

# algorithm - 将国王放在棋盘上的方法数

> ID：11382189
> 
> 赞同：5
> 
> 时间：2012-07-08T09:47:50.023
> 
> 标签：algorithm

你有一个 N x N 棋盘，你想在上面放 N 个国王。每一行和每一列都应该包含一个国王，并且没有两个国王应该互相攻击（如果两个国王出现在共享一个角落的方格中，则两个国王会互相攻击）。

棋盘前K行的K已经被放置。以数组 pos[ ] 的形式给出这些国王的位置。pos[i] 是已经放置第 i 行国王的列。所有索引均为 0 索引。剩下的国王可以以多少种方式放置？

```
Input:
The first line contains the number of test cases T. T test cases follow. Each test case contains N and K on the first line, followed by a line having K integers, denoting the array pos[ ] as described above.

Output:
Output the number of ways to place kings in the remaining rows satisfying the above conditions. Output all numbers modulo 1000000007.

Constraints:
1 <= T <= 20
1 <= N <= 16
0 <= K <= N
0 <= pos_i < N
The kings specified in the input will be in different columns and not attack each other.

Sample Input:
5
4 1
2
3 0

5 2
1 3
4 4
1 3 0 2
6 1
2

Sample Output:
1
0
2
1
18 
```

解释：对于第一个例子，第0行第2列已经有一个国王。第二行的国王必须属于第0列。第三行的国王必须属于第3列，最后一个国王必须属于到第 1 列。因此只有 1 个有效的展示位置。

对于第二个示例，没有有效的展示位置。

我应该如何解决这个问题

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-08T15:55:02.337

这个问题本质上是要求我们计算`1 2 ... N`这样的排列`i`并且`i+1`不相邻`1 <= i <= N-1`。

此外，我们有一个前缀约束。我们应该只计算那些以 开头的排列`pos_1 pos_2 ... pos_k`。

如果不是前缀约束，您可以使用[OEIS 中](http://oeis.org/A002464)的公式在 O(N) 时间内找到答案。那就是如果`N`不是太大。答案中的位数随着 Θ(N log N) 的增长而增长，因此乘法和加法会产生额外的开销。或者你可以以某个数字为模来计算答案。这个问题是在[埃及信息学奥林匹克竞赛（2009）](http://www.spoj.pl/problems/FLWRS/)中提出的。

使用前缀约束，我有一个 O(N ² ) 动态规划解决方案。但是，由于 N 小到 16，因此使用多项式时间算法是多余的。存在一个在时间 O(2 ^N N ² ) 上运行的更简单的动态规划解决方案。虽然这个算法可能比以前的解决方案需要更长的时间来编码，但它的思考速度要快得多。然而，在最坏的情况下，回溯解决方案需要 20 到 100 小时（在普通台式机/笔记本电脑上）才能运行。N =有`2806878055610`单独的解决方案可供访问`16`。除此之外，访问非解决方案的死胡同可能会付出沉重的代价。

## O(2 ^N N ² ) 解

该解决方案可以推广到在图中找到哈密顿路径的数量。

我们的状态是一对`(S, i)`；其中`S`是 的子集，`{1,2...N}`是`i`的元素`S`。设`S`be的基数`M`。

定义`F(S,i)`为将元素放置在`1, 2, ..., M`指定位置的方式数`S`；尊重永远不会一起出现的约束`k`；`k+1`并且元素`M`被放置在位置`i`。

基本情况是`F(P,pos_k) = 1`直接`P = {pos_1, pos_2 ... pos_k}.`计算所有`F(S,i)`时间O(2 ^N N ² )。`S``i`

最后的答案是`F([N],1) + F([N],2) + ... + F([N],N)`哪里`[N] = {1,2...N}`。

C++ 代码如下。[位掩码](http://en.wikipedia.org/wiki/Mask_%28computing%29)用于表示`{1,2...N}`.

```
const int MAXN = 18;
long long DP[1 << MAXN][MAXN];

void solve() {
    int n, k;
    cin >> n >> k;

    int pmask = 0, p;
    for(int i = 0; i < k; i++){
        cin >> p;
        pmask |= (1<<p);
    }

    // base cases
    if(k > 0) {
        DP[pmask][p] = 1;
    }
    else {
        for(int i = 0; i < n; i++) 
            DP[1<<i][i] = 1;
    }

    long long ans = 0;
    for(int bitmask = pmask; bitmask < (1<<n); bitmask++) { 
        for(int i = 0; i < n; i++){
            for(int j = 0; j < n; j++){
                if((bitmask & (1<<j)) or abs(i-j) == 1) 
                    continue;
                DP[bitmask | (1<<j)][j] += DP[bitmask][i]; 
            }
            if(bitmask == ((1<<n) - 1)) 
                ans += DP[bitmask][i];
        }
    }

    cout << ans << endl;
} 
```

## O(N ² ) 解

如果您以前没有遇到过这个想法，那么很难想到这个解决方案。

首先，让我们解决没有前缀的问题。

这个想法是通过将元素 1、2 .. N 一个一个放置来“构建”所有有效的排列。

让我们从一个插图开始。假设我们正在构建一个排列，例如 1 2 .. 5。首先，我们放置 1。在放置 1 之后，我们还插入一个占位符元素以填充后面的数字。更准确地说，每个状态都是一类排列，其中占位符`x`被非空的元素序列替换。

我们的排列，在插入 1 之后，看起来像 3 种情况之一：

*   `1 x`- 1 是第一个元素。占位符`x`将按某种顺序包含所有元素 2、3、4、5。
*   `x 1`- 1 是最后一个元素。
*   `x 1 x`- 1 既不是第一个元素也不是最后一个元素。

接下来，我们放置 2。它必须属于前 3 个类之一中的占位符之一。

*   假设它属于`1 x`. 由于 2 不能与 1 相邻，所以在放置 2 之后，我们*必须*在它们之间插入另一个占位符。这导致了状态`1 x 2`。此外，当 2 不是最后一个元素时，我们需要考虑排列。我们还产生了一个 state `1 x 2 x`。

*   对于`x 1`，我们类似地创建状态`2 x 1`和`x 2 x 1`。

*   对于`x 1 x`，我们有两个选择的占位符来放置 2。像前面的情况一样，我们创建状态`2 x 1 x`, `x 2 x 1 x`, `x 1 x 2`, `x 1 x 2 x`。但是请注意，例如，`x 2 x 1 x`最后一个占位符与其他两个不同 - 因为 3 可以出现在其中而无需创建另一个屏障！我们通过为占位符使用不同的符号来记录这一点。那就是我们使用`x 2 x 1 o`and`o 1 x 2 x`来代替。

假设接下来，我们将 3 插入`x 2 x 1 o`. 如果我们像以前一样将 3 放在一个`x`中，我们必须创建一个屏障占位符。但是，我们确实可以选择在与屏障占位符*相反的方向上创建或省略占位符。*如果我们将 3 放在`o`占位符中，我们可以选择*在两个方向上*创建或省略占位符。

此外，我们还必须`x`将不使用的占位符“提升”为占位`o`符。这是因为，旧`x`占位符没有像对 3 那样为下一个元素 4 提供约束。

我们已经可以开始猜测发展模式了。在一般情况下，在插入 i 时：

*   首先，我们必须选择在哪个占位符中放置 i。

*   接下来，假设我们将 i 放在一个`x`占位符中。我们必须建立一个屏障占位符。我们可以选择是否在另一个方向构建占位符。

*   如果我们使用`o`占位符，我们可以选择在两个方向上构建额外的占位符。也就是一共4个选择。

*   我们必须将`x`未使用的占位符更新为占位`o`符。

将这个想法转化为有效算法的最后一个观察结果是，我们可以将具有相同数量的放置元素和相同数量的**和****占位符****的排列类聚集在一起`x``o`**。这是因为，对于共享所有这三个参数的两个不同类，它们表示的排列数是相等的。

为了严格证明这一说法，观察我们列举的类是详尽且不重叠的就足够了。

### 前缀

稍加思考就会发现，在前缀问题中，我们只需要计算以某个元素开头的排列，（称为 b）；`i`和之间的一些约束`i+1`不再适用。

第二个修改很容易修复：如果 i-1 和 i 之间的约束不适用，那么在插入 i 之前，将所有`x`占位符更新为占位`o`符。

对于第一次修改，我们应该确保在开始之前总是有一个占位符，直到`b`被放置。在放置`b`时，我们很乐意将它放入开始的占位符中，并且不要在它之前添加任何占位符。

### 执行

让`DP[i][no][nx]`是构建放置第一个元素的类的方法的数量，并且分别`i`有`no`和`nx`类型的占位符。在任何状态下，占位符的数量都在 0 到 2 之间。因此状态空间为 O(N^2)。状态转换是恒定的时间，正如上面所描述的。`o``x``x`

## 没有前缀约束的问题的 O(N) 解

根据 OEIS，*A [n] = (n+1)A [n-1] - (n-2)A [n-2] - (n-5)A [n-3] + (n-3)A [n-4]*；其中*A [n]*是`i`和`i+1`从不连续的排列数。

我们可以在 O(n) 中计算序列 A [n 。]（也就是说，假设我们计算 A [n]以一个相当小的数字为模。）

下面是公式的推导：

定义辅助序列：

*   B [n =]**恰好违反了一个**`1 2 ... N`邻接约束的排列数。**`N-1`**

***   C [n =]**仅**违反`1 2 ... N`涉及元素的邻接约束的排列数。也就是说，在这些排列中彼此相邻；并且满足所有其他邻接约束。**`N``N-1``N`**** 

 ****我们现在寻找序列 A、B 和 C 的递归。

**[A n]的复发**

假设我们`n`从一个有效的 permutation中删除元素`P`，其中`i`和`i+1`从不相邻。`Q`的结果排列`1 .. n-1`必须恰好满足以下两种情况之一：

*   中没有相邻的数字`1 ... n-1`是相邻的`Q`。即，是 A [n-1]`Q`中考虑的排列之一。

*   恰好一对`(i,i+1)`连续出现在`Q`和`i+1 =/= n-1`中。即，`Q`是从 B [n-1] - C [n-1]的排列。

在第一种情况下，`n`可以将元素插入精确的`n - 2`位置。其中两个位置被元素挡住了`n - 1`。`n`在第二种情况下， - 在连续元素之间的位置只有一种选择。

我们得到递归：***A [n] = (n - 2)A [n-1] + B [n-1] - C [n-1]***。

**[B n]的复发**

令 B [n,k]`k`为其中和`k+1`连续出现的排列数。我们可以将一个元素合并在一起，并考虑元素的排列`k`，保持相对顺序。`k+1``Q``n-1`

*   如果`k-1`和（原始标签）都没有出现在合并元素`k+2`旁边，则对*B* *[n,k]*贡献排列- 它们对应于排列并在合并元素内。这样的数量是*A* *[n-1]*。`(k,k+1)``Q``2``k k+1``k+1 k``Q`

*   如果其中一个`k-1`或出现在元素`k+2`旁边，则有助于排列。这样的数量是*B* *[n-1,k-1]* *+ B* *[n-1,k]*。`(k,k+1)``Q``1``Q`

*   如果两者都`k-1`出现在元素`k+2`旁边，则有助于排列。这样的数量是*B* *[n-2,k-1]*。`(k,k+1)``Q``1``Q`

我们有*B [n,k] = 2A [n-1] + B [n-1,k-1] + B [n-1,k] + B [n-2,k-1]*。（某些项在 时消失`k = 1 and k = n-1`）。

求和`k`，我们得到递归：***B [n] = 2(n-1)A [n-1] + 2B [n-1] + B [n-2]***。

**[C n]的复发**

好吧，*C [n]*只是*B [n,n-1]*。从前面的结果可知， ***C [n] = 2A [n-1] + C [n-1]***。

**把它们放在一起**

我们应该能够消除*B*和*C以仅在**A*中重现。它留作练习。:-)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-25T08:55:49.397

回溯可能太慢了。考虑到某一行 k 的解决方案数量仅取决于 k-1 行中国王的位置以及行 <k 的占用位置集，可以使用记忆化提高其速度。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-08T11:13:36.647

你应该使用回溯来解决这个问题，像下面这样一个简单的函数可以解决你的问题，（处理输入文件和输出很容易，所以我跳过它）。

```
int CanPlaceKingInPosition(int pos[],int MaxIndex,int NewCol){
    for(int i=0;i<MaxIndex-1;i++)
        if(pos[i]==NewCol)
            return 0;
    //MaxIndex is the index of the above row of the new king, so we have to check attacking conditions

    if (abs(pos[MaxIndex-1]-NewCol)<=1)
       return 0;
    return 1;
}

int solver(int pos[], int N, int K){      
    int result=0;
    if (K>N) //termination condition
        return result;
    if (K==N-1) //last row
        return IsOnlyPossibleColAGoodOne(pos,N,N-1);
    for (int i=0;i<N;i++){ //for each column if we can place the king in it, move one step forward
        if (CanPlaceKingInPosion(pos,K,i)){
            pos[K]=i;  //add new king
            result+=solver(pos,N,K+1);  
        }
    }
    return result;
} 
```

您可以像这样从 main() 调用此函数： `//read N,K` `//fill pos`

```
printf("%d",solver(pos,N,K+1) % 1000000007) 
```

“IsOnlyPossibleColAGoodOne”函数返回 1，如果可以将国王放置在船上唯一的空闲列中（一个简单的 for 就可以了）。我没有测试过这个功能，所以你应该把它当作一个指导而不是一个实际的代码。（它可能工作得很好，但我没有测试过）

PS：是ACM/ICPC的问题吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-15T14:23:28.907

您好使用下面的代码我可以生成有效国王位置的排列，如果内存不受限制，我们可以生成最多 16X16 的所有排列并将它们存储在给定测试用例的相应表中生成可以匹配已经生成的排列的相应不完整排列相应的 NXN 板，数一数那将是答案

```
int columns[]={1,2,3,4,5,6,7,8,9,10,11,12};

public void displayPermitationsBoth(int prev,StringBuilder sb,int n,int stage){
    if(stage==n){
        display(sb);
        return;
    }
    String localStr=sb.toString();
    int localStage=stage;
    for(int i=0;i<n;i++){
        if((sb.toString().contains("-"+Integer.toString(columns[i])+"-"))||(Math.abs(prev-columns[i])==1)){
            continue;
        }
        displayPermitationsBoth(columns[i],sb.append("-"+columns[i]+"-"),n,++stage);
        stage=localStage;
        sb.delete(0,sb.capacity());
        sb.append(localStr);
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-10-08T13:24:56.913

```
import java.util.*;

/**
*
* @author BENDIABDELLAH
**/
public class Solution {

boolean boards[][];
Set<Integer> occupied_CL = new HashSet<Integer>();

Solution(int n) {
    boards = new boolean[n][n];
}

Solution() {
}

void setBoard(boolean[][] boards) {
    this.boards = boards;
    for (int i = 0; i < boards.length; ++i) {
        for (int j = 0; j < boards.length; ++j) {
            if (boards[i][j]) {
                occupied_CL.add(j);
            }
        }
    }
}

int waysToPlace(int k) {
    if (k == boards.length - 1) {
        return 1;
    }
    int totalWays = 0;
    for (int pos = 0; pos < boards.length; ++pos) {
        int ways = 1;
        if (!isAttack(k + 1, pos)) {
            boards[k + 1][pos] = true;
            occupied_CL.add(pos);
            ways *= waysToPlace(k + 1);
            boards[k + 1][pos] = false;
            occupied_CL.remove(pos);
        } else {
            ways = 0;
        }
        totalWays += ways;
    }
    return totalWays;
}

boolean isAttack(int row, int col) {
    if (occupied_CL.contains(col)) {
        return true;
   }
    if ((col > 0 && row > 0 && boards[row - 1][col - 1]) || (col < boards.length - 1 && row > 0 && boards[row - 1][col + 1])) {
        return true;
    }
    return false;
}

void printArray() {
    for (int i = 0; i < boards.length; ++i) {
        for (int j = 0; j < boards.length; ++j) {
            System.out.print(boards[i][j] + " ");
        }
        System.out.println();
    }
}

public static void main(String args[]) {
    //Solution sol = new Solution(5);
    // System.out.println(sol.waysToPlace(-1));
    //sol.printArray();
    readInput();
}

static void readInput() {
    Scanner scan = new Scanner(System.in);
    int t = scan.nextInt();
    for (int i = 0; i < t; ++i) {
        int n = scan.nextInt();
        //System.out.println(" n "+n );
        int k = scan.nextInt();
        // System.out.println(" k "+k );
        boolean boards[][] = new boolean[n][n];
        for (int row = 0; row < k; ++row) {
            int col = scan.nextInt();
            boards[row][col] = true;
        }
        Solution s = new Solution();
        s.setBoard(boards);
        int ways = s.waysToPlace(k - 1);
        System.out.println(ways);
        }
    }
} 
```****

# grails - grails中的在线-离线状态实现

> ID：11382209
> 
> 赞同：1
> 
> 时间：2012-07-08T09:51:15.533
> 
> 标签：grails, status

我如何实现检查功能，用户在grails中是在线还是离线？我可以在数据库中使用状态字段并在每次身份验证时更新该字段的值，还是我必须使用一些 js 的东西？也许你知道一些关于它的导师？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-08T11:08:57.957

假设在线用户是至少 10 分钟前请求应用程序的用户。因此，您可以为用户域创建特殊字段，例如：

```
User {
  Date lastSeenAt

  static transients = ['online']

  boolean isOnline() {
     return lastSeenAt && lastSeenAt.after(new Date(System.currentTimeMillis() - TimeUnit.MINUTES.toMillis(10))
  } 
} 
```

并定期在过滤器或控制器中更新它：

```
User user = //...   
if (!user.lastSeenAt || user.lastSeenAt.before(new Date(System.currentTimeMillis() - TimeUnit.MINUTES.toMillis(5))
  user.lastSeenAt = new Date()
  user.save()
} 
```

可能您不应该在每次请求时都更新它，除非上次更新是在一段时间前进行的，在这个例子中是 5 分钟。这个值可以更低，取决于你喜欢什么精度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T09:55:08.730

在很多地方这样做的方式是检查用户的最后一个活动。如果从现在到最后一个活动的时间达到某个点，则将用户标记为离线。

# html - 特定字段的多个重置按钮

> ID：11382210
> 
> 赞同：0
> 
> 时间：2012-07-08T09:51:28.987
> 
> 标签：html, forms

我的重置按钮能够工作，但在我的示例表单中，我有两个文件可以单独重置它们。现在，当我按下我的重置按钮时，它将重置两个字段。我不能`form.reset()`用来呼出，因为我不想重置我的整个表单值。因此，如果我为`browse`and选择了两个文件，`browseAssign`然后单击取消。两个值都消失了。

```
Updated Code:
<form name = "sample" id = "sample" action ="nextpage.php">
<input name="Name" type="text" id="Name" value="Joey"/>
<input name="browse" type="file"/>
<button type="reset" title="Cancel" onClick="document.getElementsByName('browse').value=''"><span>cancel</span></button>

<input name="browseAssign" type="file"/>
<button type="reset" title="Cancel" onClick="document.getElementsByName('browseAssign').value=''"><span>cancel</span></button>

</form> 
```

它仍然重置了两个浏览字段。请告知。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T10:33:15.937

用这个：

```
<form name="sample" id="sample" action="nextpage.php">
<input name="Name" type="text" id="Name" value="Joey" />
<input id="browse" name="browse" type="file" />
<button title="Cancel" onclick="event.preventDefault();document.getElementById('browse').value='';"><span>cancel</span></button>
<input id="browseAssign" name="browseAssign" type="file" />
<button title="Cancel" onclick="event.preventDefault();document.getElementById('browseAssign').value='';"><span>cancel</span></button>
</form> 
```

工作原理：将 ID 添加到文件输入，然后在`onclick`事件中阻止默认操作（提交表单），然后将相关输入的值重置为`''`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T09:54:14.670

采用`element.value = "";`

例子：

```
<button type="reset" title="Cancel" onClick="document.getElementsByName('browse').value=''"><span>cancel</span></button> 
```

# haskell - 是否可以在 Haskell 的 HXT 上使用 Text 或 ByteString？

> ID：11382211
> 
> 赞同：8
> 
> 时间：2012-07-08T09:51:32.350
> 
> 标签：haskell, text, web-scraping, bytestring, hxt

我认为 Haskell 中的 XML/HTML 处理库 HXT 具有非常灵活和强大的方法，可以通过 Arrows 遍历和操作 DOM 树。 [http://adit.io/posts/2012-04-14-working_with_HTML_in_haskell.html](http://adit.io/posts/2012-04-14-working_with_HTML_in_haskell.html)

然而，HXT 似乎只有 DOM 节点内容的字符串表示。 [http://hackage.haskell.org/packages/archive/hxt/9.1.6/doc/html/Text-XML-HXT-DOM-TypeDefs.html#t:XNode](http://hackage.haskell.org/packages/archive/hxt/9.1.6/doc/html/Text-XML-HXT-DOM-TypeDefs.html#t:XNode)

是否可以将 ByteString 或 Text 用于 HXT？Text 是首选，因为我将 HXT 与 Yesod 一起使用，它似乎主要使用 Text。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-08T13:55:55.897

HXT 和 HaXml 似乎都不支持字节串或文本，但如果您使用 Yesod，您可能应该使用[xml-conduit](http://hackage.haskell.org/package/xml-conduit)和[html-conduit](http://hackage.haskell.org/package/html-conduit)。

# build - Quickbuild - 导出运行时变量

> ID：11382212
> 
> 赞同：1
> 
> 时间：2012-07-08T09:51:49.453
> 
> 标签：build, quickbuild

我正在使用 Quickbuild 1.3 我想将构建作业的所有运行时变量导出到属性文件。

我知道在 Quickbuild 中您可以引用每个变量并使用 OGNL 获取其值，但我不知道如何在运行时获取所有可用变量并列出它们。

你知道怎么做吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T10:16:16.943

这是 quickbuild 的一个非常旧的版本，如果可能的话，您应该将更改定义为较新的版本。您可以使用以下表达式访问变量：

```
${vars.getValue("yourVariableName")} 
```

在新版本中，您还可以使用 groovy 脚本来访问所有内部 Java 对象并编写更复杂的条件语句，例如：

```
${groovy:
message="Some message";
if(step.isFailed()) {
variable = vars.get("BUILD_DESCRIPTION");
if(variable != null) {
  variable.setValue(message);
\}
\}
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-02-08T18:47:07.150

自从有人想要这个以来似乎已经有很多时间了......无论如何它可能有一天会帮助某人:)

```
${groovy:
    import com.pmease.quickbuild.variable.VariableWrapper
    for (VariableWrapper var : vars.getAll()) { 
        logger.warn(var.getName())
        logger.warn(var.getValue())
        logger.warn(var.asInt())
        logger.warn(var.asBool())
        if (var.getName().equals("CoolVar"))
            var.setValue(666)
        else
            var.setValue("Strings are ok too")
    /}
} 
```

# php - 将php字符串拆分成不同长度的块

> ID：11382217
> 
> 赞同：11
> 
> 时间：2012-07-08T09:53:01.270
> 
> 标签：php, arrays, string, split

我正在寻找将字符串拆分为数组的方法，排序为`str_split()`，其中块的大小都不同。

我可以通过用一堆 遍历字符串来做到这一点`substr()`，但这看起来既不优雅也不高效。是否有一个函数可以接受一个字符串和一个数组，比如 ( `1, 18, 32, 41, 108, 125, 137, 152, 161`)，并产生一个适当切分的字符串片段数组？

Explode 是不合适的，因为块由不同数量的空格分隔。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-08T09:57:40.160

PHP 中没有任何东西可以为您做到这一点（它有点具体）。所以作为 radashk 就是 siad，你只需要写一个函数

```
function getParts($string, $positions){
    $parts = array();

    foreach ($positions as $position){
        $parts[] = substr($string, 0, $position);
        $string = substr($string, $position);
    }

    return $parts;
} 
```

类似的东西。然后你可以在任何你喜欢的地方使用它，所以它很干净：

```
$parts = getParts('some string', array(1, ... 161)); 
```

如果你真的想要，你可以将它内爆成一个正则表达式：

```
^.{1}.{18} <lots more> .{161}$ 
```

会匹配你想要的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-10-30T19:10:54.473

仅供将来参考，@jay 建议的正则表达式方法如下所示：

```
 $regex="/(.{1})(.{18})(.{32})(.{41})(.{108})(.{125})(.{137})(.{152})(.{161})/";
 preg_match($regex,$myfixedlengthstring,$arr); 
```

其中**$myfixedlengthstring**是目标字符串，**$arr**给你结果

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2018-07-05T15:41:11.173

我会使用[解包](http://php.net/unpack)（）：

```
$str = "?ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890....";
$array = unpack("a1first/a26second/a10third/a*rest",$str);
print_r($array); 
```

这将返回：

```
Array
(
    [first] => ?
    [second] => ABCDEFGHIJKLMNOPQRSTUVWXYZ
    [third] => 1234567890
    [rest] => ....
) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-13T13:05:26.543

一个更灵活的变体，用于解析具有固定长度记录的 ASCII 表：

```
function ParseIrregularString  ($string, $lengths)
{ 
$parts = array(); 

foreach ($lengths as $StringKey => $position)
    { 
    $parts[$StringKey] = substr($string, 0, $position); 
    $string = substr($string, $position); 
    } 

return $parts; 
} 
```

提交以下内容：

```
$string = "abcdefghiklmnopqrstuvz";
$lengths = array ("field1"=>4, "field2"=>3, "field3"=>5, "field4"=>2);
print_r (ParseIrregularString ($string, $lengths)); 
```

返回：

```
Array ( [field1] => abcd [field2] => efg [field3] => hiklm [field4] => no ) 
```

# android - 在 Chrome 浏览器 e 上构建应用程序而不是使用现有的 android 浏览器？

> ID：11382218
> 
> 赞同：1
> 
> 时间：2012-07-08T09:53:01.330
> 
> 标签：android, google-chrome, cordova, web-worker

我正在 Android 上开发一个带有 phonegap 的应用程序。Android 上的股票浏览器不支持“Web Worker”，而 Chrome 支持它。我的问题是：是否可以直接使用 Chrome 浏览器而不是使用现有的 android 浏览器使用 eclipse 构建我的应用程序？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T04:25:38.240

不是现在。请参阅[常见问题解答](https://developers.google.com/chrome/mobile/docs/faq)：

> 问：Chrome for Android 现在是否支持混合原生/Web 应用程序的嵌入式 WebView？
> 
> 答：我们正在评估我们可以通过 Chrome 支持 WebView 的方式，但目前没有任何计划宣布。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-06T17:26:40.537

这与这个问题松散相关 - 我相信 - 将[Chrome 浏览器打包到 HTML5 Android 应用程序中](https://stackoverflow.com/questions/16409294/package-chrome-browser-into-a-html5-android-app)

*您可能*对 Crosswalk 项目感兴趣。

# android - Android“吐司”命令解释

> ID：11382219
> 
> 赞同：-1
> 
> 时间：2012-07-08T09:53:31.847
> 
> 标签：android, android-layout, android-widget, spinner

```
public void someClass(AdapterView<?>arg0,View arg1,int arg2,long arg3)     
         {
              Toast.makeText(arg0.getContext(), "<SOME STRING> 
               "+arg0.getItemAtPosition(arg2).toString(), Toast.LENGTH_SHORT).show();   
          } 
```

你能解释一下这段代码是如何工作的吗？这段代码是做什么的？我正在创建一个简单的微调器应用程序，想了解“toast”命令语法！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T10:00:38.680

“toast”是在某些操作后显示的小帮助字符串显示的名称。一个例子是 gmail 中发送成功的消息。

上面的函数将创建一个带有“Some String”的toast，并在提供的上下文中显示“Short”时间。

# javascript - 异步 http 请求服务

> ID：11382223
> 
> 赞同：1
> 
> 时间：2012-07-08T09:54:42.847
> 
> 标签：javascript

我的页面在后台发送了几个 HTTP 请求。这些请求由一些用户操作触发。一些用户操作可能会导致重定向 - 这里我们遇到了一个问题：我们希望仅在发送所有请求时才发生重定向。

问题是：是否有任何 Javascript 库可以推荐，允许等待所有报告发送并仅在之后触发重定向？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T10:04:09.717

使用[jquery](/questions/tagged/jquery "显示标记为“jquery”的问题")，您可能可以利用事件，该事件在*所有*[`ajaxStop`](http://api.jquery.com/ajaxStop/)AJAX 调用完成时触发（不再有挂起的连接）。[这是一个例子](http://jsfiddle.net/nurkiewicz/uEm45/)：

 *```
$(document).ajaxStop(allDone);

function allDone() {
    console.info("Now redirecting");
}

$.getJSON('/echo/json/', function() {
    console.info("First done");
    $.getJSON('/echo/json/', function() {
        console.info("Third done");
    });
});
$.getJSON('/echo/json/', function() {
    console.info("Second done");
}); 
```

无论响应的顺序是什么，`allDone()`回调总是最后执行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T10:11:21.387

您想使用 jQuery Deferred 模式，它允许您链接（AJAX）对象和

*   如果全部成功完成，则有成功回调

*   如果任何请求失败，则有失败回调

[http://api.jquery.com/category/deferred-object/](http://api.jquery.com/category/deferred-object/)

例子：

[如何使用 jquery 链接 ajax 调用](https://stackoverflow.com/questions/8612894/how-to-chain-ajax-calls-using-jquery)*

# python - Python - 评估列表子集的元素

> ID：11382224
> 
> 赞同：2
> 
> 时间：2012-07-08T09:54:44.417
> 
> 标签：python, list, python-2.7

我有一个包含布尔值的列表：

```
my_list = [False, False, False, True, True, True] 
```

我想评估对于具有 (start, end) 索引的给定元组，列表是否包含一个`True`值，例如

```
contains_true(my_list, (0,0)) => False
contains_true(my_list, (0,2)) => False
contains_true(my_list, (0,3)) => True
contains_true(my_list, (3,5)) => True
contains_true(my_list, (5,5)) => True 
```

目前我正在这样做：

```
def contains_true(my_list, indexes_tuple):
    start = indexes_tuple[0]
    end = indexes_tuple[1] + 1
    indexes = range(start, end)

    for i in indexes:
        if my_list[i]:
            return True
    return False 
```

有没有更好的方法在 Python 中做到这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-08T09:57:25.370

```
>>> my_list = [False, False, False, True, True, True]
>>> def contains_true(seq, bounds):
        start, end = bounds
        return any(seq[start:end+1])

>>> contains_true(my_list, (0,0))
False
>>> contains_true(my_list, (0,2))
False
>>> contains_true(my_list, (0,3))
True
>>> contains_true(my_list, (3,5))
True
>>> contains_true(my_list, (5,5))
True 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-08T09:57:27.503

你可以做：

```
def contains_true(data, indices):
     return any(data[indices[0]:indices[1] + 1]) 
```

如果给定的可迭代对象包含 ，则该函数[`any`](http://docs.python.org/library/functions.html#any)返回 True `True`。上面的函数对列表进行切片，如果切片包含至少一个 True 值，则返回 True。这给出了您的预期结果：

```
contains_true(my_list, (0,0)) => False
contains_true(my_list, (0,2)) => False
contains_true(my_list, (0,3)) => True
contains_true(my_list, (3,5)) => True
contains_true(my_list, (5,5)) => True 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-08T10:16:10.823

蟒蛇2：

```
contains_true = lambda L, (start, end): any(L[start:end+1]) 
```

或者在 Python 2 和 3 中：

```
contains_true = lambda L, start_end: any(L[start_end[0]:start_end[1]+1]) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-08T10:00:04.553

您的代码有一个错误。

> 对此还有一个变体，它表示计算机科学中有两件困难的事情：缓存失效、命名事物和一个错误。

您的示例列表显示“结束”是*inclusive*，`(0,0)`并且`(5,5)`都选择长度为 1 的子列表。

但是`range(0,0)`and`range(5,5)`将第二个“结束”视为*排他性*，`range(0,0)`并且`range(5,5)`是索引的空列表。

您需要将 1 添加到范围调用的“结束”索引，以使您的代码按预期工作。

有没有更好的办法？您可以使用`import itertools`and`itertools.islice`获取子列表并将其传递给`any`函数。这对你更好吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-08T10:07:36.273

你的 List 应该是一个 numpy 数组，所以：

```
import numpy as np 
```

那么你的函数可能如下所示：

```
def contains_true(list,tupel):
    if l[tupel[0]:tupel[1]].any()==True: 
        return True
    else: 
        return False 
```

# google-maps - JQuery Mobile - 用地图填充内容 div，没有滚动

> ID：11382225
> 
> 赞同：2
> 
> 时间：2012-07-08T09:55:02.207
> 
> 标签：google-maps, jquery-mobile

我尝试了很多解决方案，但都没有奏效。

我有一个带有固定页眉和页脚的布局（真正固定不消失），我喜欢`<div data-role="content">`用地图填充。我还希望在此内容 div 中禁用垂直和水平滚动。

解决方案不起作用：
[当嵌入到 jQuery Mobile 中的 jQuery Mobile“页面”](https://stackoverflow.com/questions/5912623/google-map-extends-off-edge-of-page-when-embedded-inside-jquery-mobile-page?rq=1)
[谷歌地图中时，Google Map 会延伸到页面边缘](https://stackoverflow.com/questions/4574097/google-maps-in-jquery-mobile?rq=1)
[如何使用 jquery mobile 创建 100% 高度的 div？](https://stackoverflow.com/questions/7541780/how-to-create-div-with-100-height-with-jquery-mobile?rq=1)
[JQuery-Mobile 内容区域 100% 头和脚之间的高度](https://stackoverflow.com/questions/7445977/jquery-mobile-content-area-100-height-between-head-and-foot)
[在 Jquery Mobile 中最大化 div[data-role=content]](https://stackoverflow.com/questions/8161634/maximise-divdata-role-content-in-jquery-mobile?rq=1)
[如何使用 jQuery Mobile 显示全屏谷歌地图？](https://stackoverflow.com/questions/10406252/how-can-i-display-a-full-screen-google-map-with-jquery-mobile?rq=1)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-11-13T17:55:24.807

一年多后，但如果有人仍然想解决这个问题，这里是如何：

*使用 jquery mobile 1.3.1 和 Google Maps API v3 测试*

在 HTML 中，将其用于内容：

```
<div data-role="content">
    <div id="mapDiv"></div>
</div> 
```

**提示：**不要`data-fullscreen`在页面的任何 div 上使用。

比，在你的 CSS 中，使用这个：

```
#mapDiv {
    padding: 0;
    position : absolute !important; 
    top : 40px !important;  
    right : 0; 
    bottom : 58px !important;  
    left : 0 !important;     
} 
```

记得在你的 mapDiv 中创建你的地图，所以你的 JS 会是这样的：

```
map = new google.maps.Map(document.getElementById('mapDiv'), mapOptions); 
```

就是这样！即使您旋转显示它的设备，它也会起作用。

**提示：**您必须在页眉和页脚中使用`data-position="fixed"`and `data-tap-toggle="false"`。

# ios - iOS - iAd 未加载

> ID：11382230
> 
> 赞同：1
> 
> 时间：2012-07-08T09:55:17.520
> 
> 标签：ios, iad

我们最近制作了一个应用程序并添加了 iAds。

发布到应用商店后，我们对游戏进行了测试。每次启动应用程序时，加载 iAd 时一切正常。

打开和关闭应用程序大约 10 次后，iAd 停止显示。

即使在删除应用程序并重新安装后，广告也不会加载。

有人知道为什么吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T10:10:47.617

苹果只有这么多广告要发布。当 iAd 横幅视图出现在屏幕上时，它会请求一个广告，但并不总是可以填充它。这就是为什么您需要实现 ADBannerViewDelegate 方法，以在横幅无法接收广告时将其从屏幕上移除。像这样的东西：

```
- (void)bannerView:(ADBannerView *)banner didFailToReceiveAdWithError:(NSError *)error{
    [banner removeFromSuperview];
} 
```

然后，当您收到成功加载的委托调用时，您可以将其放回原处。

```
- (void)bannerViewDidLoadAd:(ADBannerView *)banner{
    [self.view addSubview:banner];
} 
```

[https://developer.apple.com/library/ios/#documentation/UserExperience/Reference/ADBannerViewDelegate_Ref/Reference/Reference.html](https://developer.apple.com/library/ios/#documentation/UserExperience/Reference/ADBannerViewDelegate_Ref/Reference/Reference.html)

如果您查看 iAd Network 数据，您会在 iTunes Connect 中注意到您将获得平均填充率以及其他信息。

# android - 如何为多个连续条目创建对话框？

> ID：11382231
> 
> 赞同：1
> 
> 时间：2012-07-08T09:55:29.523
> 
> 标签：android

我目前正在开发一个可以管理纸牌游戏的 Android 应用程序。我有（比方说）4 名球员，在每一轮之后，我点击一个按钮，打开一个对话框，输入这一轮球员的得分。如何在打开的对话框中实现这一点？我尝试了几件事，例如对话框中的 ViewFlipper，到目前为止都没有工作。例如，ViewFlipper 没有机会进入下一个视图，因为当我点击 OK 按钮时对话框已经再次关闭。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T10:13:26.593

您可以使用具有对话框外观的 Activity 来代替对话框。要实现这一点，请将其添加到您的 Activity 定义中：

```
<activity android:theme="@android:style/Theme.Dialog" /> 
```

`<Application>`在 Android的标签内`Manifest.xml`。

**编辑**要在您的活动和对话框 UI 活动之间来回传递数据，您可以使用`Intents`. 例如，假设您想将一个`String`从 CustomActivity 传递给 DialogActivity。CustomActivity 的代码将是：

```
Intent i = new Intent(getApplicationContext(), DialogActivity.class);
i.putExtra("your_variable_name","value");
startActivity(i); 
```

然后在您的 DialogActivity 中访问您将使用的数据：

```
Bundle extras = getIntent().getExtras();
if (extras != null) {
    String variable_value = extras.getString("your_variable_name");
} 
```

当您想将数据从 DialogActivity 发送到 CustomActivity 时，同样的逻辑也是如此。

您也可以使用`startActivityForResult`和`onActivityResult`方法来做到这一点。有关这两种方法的更多信息，请参见[此处](http://rahulonblog.blogspot.gr/2010/05/android-startactivityforresult-example.html)。

# javascript - Mootools Drag 完成后获取元素的新位置

> ID：11382242
> 
> 赞同：0
> 
> 时间：2012-07-08T09:57:10.203
> 
> 标签：javascript, mootools, draggable

我想获取左侧定位或 margin-left 的值或显示 div 元素被拖动到左侧多远的东西。我不知道如何访问它。试图让“左”只是显示自动。

[http://jsfiddle.net/nicekiwi/ZzwNt/1/](http://jsfiddle.net/nicekiwi/ZzwNt/1/)

甚至可能吗？

假设我将图像向右拖动 20px，我希望 onComplete 中的警报框返回 20 的值。希望你明白这一点。

我试过使用 el.getComputedSize.computedLeft，但它只返回 0。

Mootools 1.4

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T08:52:32.433

我认为[getScroll()](http://mootools.net/docs/core/Element/Element.Dimensions#Element%3agetScroll)函数是您正在寻找的，因为它返回您包含的 div 从左上角滚动的数量。

```
onComplete: function(el){
    var imgPosition = el.getScroll();
    console.log(imgPosition.x);
    console.log(imgPosition.y);
} 
```

这里以更新的小提琴为例 - [http://jsfiddle.net/ZzwNt/2/](http://jsfiddle.net/ZzwNt/2/)

希望这可以帮助。

# django - 在 django 视图中动态生成模板（上下文）对象

> ID：11382245
> 
> 赞同：-1
> 
> 时间：2012-07-08T09:57:29.153
> 
> 标签：django, django-views

我目前正在我的views.py中做这样的事情：

```
def home(request):
    ingredients = Ingredience.objects.all()
    drinks = Ingredience.objects.filter(category_id=1)
    fruits =  Ingredience.objects.filter(category_id=2)
    etc.
    meats = Ingredience.objects.filter(category_id=25)

    return render_to_response('home.html', {'ingredients': ingredients, 'drinks': drinks, 'fruits': fruits, 'meats': meats,}, context_instance=RequestContext(request)) 
```

这是我的models.py：

```
from django.db import models

class IngredienceCategory(models.Model):
    name = models.CharField(max_length=30)

    def __unicode__(self):
        return self.name

class Ingredience(models.Model):
    name = models.CharField(max_length=30)
    category = models.ForeignKey(IngredienceCategory, null=True, blank=True)

    def __unicode__(self):
        return self.name

class Food(models.Model):
    name = models.CharField(max_length=30)
    ingredients = models.ManyToManyField(Ingredience)

    def __unicode__(self):
        return self.name 
```

django 中是否有一些技巧可以动态生成模板对象（即饮料、水果、肉类）？我什至不知道从哪里开始，但我想这样做：遍历所有成分对象并返回字典，该字典将保存按类别分组的项目（如第一个示例中所示）。

我试图用这个解决两个问题：

1.  每个类别对象的代码几乎相同，因此有很多冗余。
2.  每次向数据库添加新类别时，我都必须更新 views.py。

**编辑：**在我的模板中，我需要能够通过自己的变量（例如{{饮料}}访问每个对象（即饮料、水果、肉类等）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T10:16:19.743

好的，根据您的评论，您希望能够访问模板中的`fruits`,`meats`等。这是一种可能的解决方案，它既不是令人难以置信的 Pythonic 也不是高效的，但这只是为了让它更容易理解：

```
ingredients = Ingredience.objects.all()
context = {}
for i in ingredients:
    context[i.category.name + 's'] = context.get(i.category.name + 's', []) + [i]
return render_to_response('home.html', context, context_instance=RequestContext(request)) 
```

然后你可以访问它`fruits`，`meats`等。Django 是否有你正在寻找的东西？据我所知，这是一个非常罕见的用例 - 但也许其他一些人可以提供答案。本质上，您要实现的是对上下文字典对象的一些巧妙操作，以便类别成为键。如果是这种情况，您可能会在查看[这个 SO question](https://stackoverflow.com/questions/1123337/django-converting-an-entire-set-of-a-models-objects-into-a-single-dictionary)时发现一些用处。

**Update**: Just to clarify what I'm doing in the code above: I create a dictionary called `context`, and then proceed to loop through all the ingredients. For every ingredient, I add a dictionary entry for the category name, containing an array with the Ingredient. If the name is already in the context dictionary, then it just appends this Ingredient. It does this until all the ingredients have been added to an array accessible by the name of the category it is in.

# php - 如何访问扩展类中的单例类对象

> ID：11382249
> 
> 赞同：0
> 
> 时间：2012-07-08T09:57:48.873
> 
> 标签：php, object, singleton, this

请告诉我我在哪里做错了......

我有3节课。这些都是这样的。。

1.  我遵循单例设计模式的单例类
2.  类公羊
3.  山姆班

在“ram”类中，我正在为单例类对象设置数据。

现在，在“sam”类中。我正在尝试访问 sam 类的 show_data() 函数中的单例类对象。

什么时候，我用..

```
Print_r($this) : showing empty object 
```

但是，当我使用以下代码时..

```
$singleton_obj = Singleton::getInstance();
print_r($singleton_obj); : Showing content of singleton object 
```

**我的问题是，** 为什么在**Print_r($this)**的情况下它显示的是空对象。有什么办法，我可以使用**Print_r($this)**获取单例类对象的内容。

**我的课程文件是这个..**

```
<?php 
class Singleton
{
 // A static property to hold the single instance of the class
private static $instance;

// The constructor is private so that outside code cannot instantiate
public function __construct() { }

// All code that needs to get and instance of the class should call
// this function like so: $db = Database::getInstance();
public function getInstance()
{
  // If there is no instance, create one
  if (!isset(self::$instance)) {
    $c = __CLASS__;
    self::$instance = new $c;
  }
  return self::$instance;
}

// Block the clone method
private function __clone() {}

// Function for inserting data to object
public function insertData($param, $element)
{
$this->{$param} = $element;
}
}

//---CLASS ram---
class ram
{
    function __construct() 
    {
        $db = Singleton::getInstance();
        $db->insertData('name', 'Suresh');
    }
}

$obj_ram = new ram;

//---CLASS sam---
class sam extends Singleton
{
    function __construct()
    {
        parent::__construct();
   }

   public function show_data()
   {
    echo "<br>Data in current object<br>";
    print_r($this);

    echo "<br><br>Data in singleton object<br>";
        $singleton_obj = Singleton::getInstance();
        print_r($singleton_obj);
   } 
}

$obj_sam = new sam;
echo $obj_sam->show_data(); 
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T10:28:26.353

您正在`sam`通过“”创建一个“”对象`new sam`，您应该使用“ `sam::getInstance()`”；到达静态实例但它不是“sam object”类型将是“Singleton”“。” **__ *CLASS* __** " 给出范围类而不是真正的对象类。

**第一**：你必须阅读php中的“[后期静态绑定](http://php.net/manual/en/language.oop5.late-static-bindings.php)”，了解self::和**__CLASS__** *使用“ `static::`”而不是“ ”的**局限性（** ***5.3+***`self::`）*

 *或者你可以改变所有的模式使用静态像;

```
 <?php 
    class Singleton
    {
        // A static property to hold the single instance of the class
        private static $instance;

        // The constructor is private so that outside code cannot instantiate
        public function __construct() { }

        // All code that needs to get and instance of the class should call
        // this function like so: $db = Database::getInstance();
        public static function getInstance()
        {
            // If there is no instance, create one
            if (!isset(self::$instance)) {
                $c = __CLASS__;
                self::$instance = new $c;
            }
            return self::$instance;
        }

        // Block the clone method
        private function __clone() {}

        // Function for inserting data to object
        public function insertData($param, $element)
        {
            $this->{$param} = $element;
        }
    }

    //---CLASS ram---
    class ram
    {
        function __construct() 
        {
            $db = Singleton::getInstance();
            $db->insertData('name', 'Suresh');
        }
    }

    $obj_ram = new ram;

    //---CLASS sam---
    class sam extends Singleton
    {
        function __construct()
        {
            parent::__construct();
        }

        public static function show_data()
        {
            echo "<br>Data in current object<br>";
            print_r(self::getInstance());
            echo "<br><br>Data in singleton object<br>";
            $singleton_obj = Singleton::getInstance();
            print_r($singleton_obj);
        } 
    }

$obj_sam = sam::getInstance();
print_r($obj_sam);

    echo sam::show_data(); 
```

这是一个将属性指针设置为当前对象的示例，例如“CI”

```
<?php 
    class Singleton
    {
        // A static property to hold the single instance of the class
        private static $instance;

        // The constructor is private so that outside code cannot instantiate
        public function __construct() {

            if(isset(self::$instance))
                foreach(self::$instance as $key => &$val)
                {
                    $this->{$key} = &$val;
            }
        }

        // All code that needs to get and instance of the class should call
        // this function like so: $db = Database::getInstance();
        public static function getInstance()
        {
            // If there is no instance, create one
            if (!isset(self::$instance)) {
                $c = __CLASS__;
                self::$instance = new $c;
            }
            return self::$instance;
        }

        // Block the clone method
        private function __clone() {}

        // Function for inserting data to object
        public function insertData($param, $element)
        {
            $this->{$param} = $element;
        }
    }

    //---CLASS ram---
    class ram
    {
        function __construct() 
        {
            $db = Singleton::getInstance();
            $db->insertData('name', 'Suresh');
        }
    }

     class ram2
    {
        function __construct() 
        {
            $db = Singleton::getInstance();
            $db->insertData('name', 'Suresh');
            $db->insertData('name2', 'Suresh2');
        }
    }

    $obj_ram = new ram;
    $obj_ram = new ram2;

    //---CLASS sam---
    class sam extends Singleton
    {
        function __construct()
        {
            parent::__construct();
        }

        public function show_data()
        {
            echo "<br>Data in current object<br>";
            print_r($this);

            echo "<br><br>Data in singleton object<br>";
            $singleton_obj = Singleton::getInstance();
            print_r($singleton_obj);
        } 
    }

    $obj_sam = new sam;
    echo $obj_sam->show_data(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T10:08:42.400

您的单身人士没有得到“初始化” - 它不会创建任何对象。所以`$this`是指什么都没有。

编辑：原来我错了——我经常看到单身人士将 __construct() 声明为`private`. 这就是拒绝实例化类的新实例的方式。不知道你的情况是怎么回事。

编辑2：有什么问题？您的代码按预期运行。您正在创建一个`sam`没有数据的新对象，因此您得到一个空对象。当您打印单例对象时，您会看到单例的数据。

编辑 3：我从未见过单例被扩展。我认为这是模式的错误应用，我当然可能是错的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-08T10:29:33.860

您不能从该类对象中访问类的静态属性。

`A property declared as static can not be accessed with an instantiated class object (though a static method can).`

[http://php.net/manual/en/language.oop5.static.php](http://php.net/manual/en/language.oop5.static.php)*

# php - 编写自定义 CMS 与使用现有开源产品

> ID：11382257
> 
> 赞同：0
> 
> 时间：2012-07-08T09:58:52.697
> 
> 标签：php, content-management-system

我一直在开发自定义 CMS，如果有客户，我想使用它。但我问了我的一些朋友我应该怎么做：只使用现有的 CMS，如 Joomla 或 Wordpress，或者自己编写。

我想使用自定义 CMS 的原因是因为我学会了更快地编写脚本，并且我可以完全控制一切，而且我确切地知道发生了什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-08T10:02:27.647

开发自定义解决方案总是感觉很快，因为您自己正在积极编写代码。

另一方面，在使用 Joomla 或 Wordpress 时，您需要学习现有系统，并且您会在学习方面花费更多时间。

如果 CMS 不是专门的（视频、政府文件等），编写自定义内容很少有回报：最终您需要编写更多代码，尽管开发可能感觉速度很快。PHP CMS 产品化程度很高，选择一个 CMS 的好处超过了维护由一个人（您）编写的大型代码库的好处。使用开源 CMS，您可以在更大的池中提取资源。

此外，在您可能无法使用的情况下，将代码库基于知名产品也是您的客户利益。如果您不告诉客户开源的好处，那将是不诚实的生意。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-08T10:05:51.667

那里有大量众所周知/经过深思熟虑的 CMS，客户学会了喜欢和使用它们。

编写自己的 CMS 绝非易事（这是轻描淡写的）。

如果只是出于学习目的，那么请务必自己编写，但对于客户项目，我建议您使用现有项目之一。

至于灵活性，今天的大多数 CMS 几乎都提供了最大的灵活性。几乎没有什么是你不能用它们做的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-08T10:06:01.387

我会去学习如何扩展现有的 CMS。

这样做有几个原因：

*   您不必为诸如此类的东西重新发明轮子
    *   用户管理
    *   验证
    *   授权
    *   与社交网络的整合
*   Drupal、Wordpress 和 Joomla 都有很棒的社区，所以你几乎肯定会得到：

    *   成熟的代码库
    *   大量的生产测试
    *   最终客户的文档
    *   大量的模板和插件
*   您的客户需要的大多数功能可能已经由那些成熟的 CMS 实现

众所周知，创建自己的代码比尝试理解别人的代码更容易。这可能是您应该开始创建自己的唯一原因。

尽管试想一下，在数百名从事这些成熟 CMS 的编码工作的 10 多年中，在架构、设计和模式方面犯了多少错误并被纠正了。你准备好重复和纠正它们了吗？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-08T10:28:04.043

正如您在评论中所建议的那样，如果您想这样做以获得学习体验，当然，请继续！这将是一次巨大的学习经历。你不能放弃并不断努力改进它。

然而，即使你在接下来的 6 个月里只用在你的 CMS 上，它也可能没有 Drupal 或任何其他 CMS 一样强大和完善。您可能对客户不利。

但谁知道呢，如果你要带来一种全新的内容思考范式，你可能只是聚集了一个巨大的社区，然后你的 CMS 就成为了现有数百个的可行替代方案。

没有大量的研究和计划，不要进入这个。

# opengl - glMapBufferARB 在 GDB 中返回“越界”地址？

> ID：11382259
> 
> 赞同：1
> 
> 时间：2012-07-08T09:59:15.960
> 
> 标签：opengl, gdb, pbo

当我使用 GDB 调试 OpenGL 程序时，GDB 存在误导行为。

我从 glMapBufferARB 得到一个地址，GDB 中的地址显示

```
$35 = (GLubyte *) 0xb74bb000 <Address 0xb74bb000 out of bounds> 
```

而且我无法打印它的内容。

但是，我可以在我的程序中访问它的内容。

glMapBufferARB返回的地址和普通的内存地址有区别吗？为什么GDB不能访问它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T10:27:36.280

> glMapBufferARB返回的地址和普通的内存地址有区别吗？

是的，它可能是映射到您的进程地址空间的 GPU 上的 DMA 缓冲区或内存。因此，内存位于您的进程分配之外。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T21:26:16.590

> glMapBufferARB返回的地址和普通的内存地址有区别吗？

它可能很特别——OpenGL 用户空间库和内核驱动程序可能会合谋安排一个只有他们理解的特殊映射。

> 为什么GDB不能访问它？

GDB 用于`ptrace(2)`读取劣质（正在调试的）进程内存。实际上与您的显卡通信的内核设备驱动程序很可能不支持`ptrace`，并且 GDB 读取该内存的尝试失败。这可能是设备驱动程序中的错误，但如果您使用的是闭源驱动程序（Nvidia？），您可能无能为力。

# ios - 在 Objective C 中创建字符串数组

> ID：11382260
> 
> 赞同：-11
> 
> 时间：2012-07-08T09:59:37.190
> 
> 标签：ios

我正在尝试创建一个字符串数组并尝试使用下面的代码。这将创建带有垃圾数据的数组。谁能解释我为什么会这样？

NSString *str[2];

str[0] = @"欢迎";

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-08T10:02:28.420

```
NSString *str = [array objectAtIndex:0]; 
```

**--- iOS 7 更新 ---**

iOS 7 SDK 现在公开`firstObject`在数组上公开一个方法，如果数组为空，该方法不会抛出越界异常。它可以这样使用：

```
NSString *str = [array firstObject];
if(str != nil){
  // Your code here
}else{
  // Array was empty
} 
```

# c# - XML 排序异常

> ID：11382268
> 
> 赞同：3
> 
> 时间：2012-07-08T10:01:05.960
> 
> 标签：c#, xml, linq, exception, sorting

我正在尝试通过元素的属性对 LINQ 中的 XML 文件中的元素进行排序：

```
public void SortXml()
{
    XDocument doc = XDocument.Load(filename);
    XDocument datatemp = new XDocument(doc);

    doc.Descendants("Thing").Remove();
    var module = datatemp.Descendants("Thing").OrderBy(x => 
        (int)int.Parse(x.Attribute("ID").Value));
    doc.Element("Thing").Add(module);

    doc.Save(filename);
} 
```

XML:

```
<Entry>
  <Properties>
    <Thungs Count="2">
      <Thing ID="1">
        <thing1 num="8" />
        <thing1 num="16" />
      </Thing>
      <Thing ID="31">
        <thing1 num="8" />
        <thing1 num="16" />
      </Thing>
    </Thungs>
  </Properties>
</Entry> 
```

但在这条线上，`doc.Element("Thing").Add(module);`我得到了一个`NullReferenceException`. 怎么了？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-08T10:09:57.570

`doc.Element("Thing")`将返回`null`，因为没有元素被调用`"Thing"`：`doc.Descendants("Thing").Remove();`调用已将它们全部删除。即使没有，`XElement`'`Element`方法也不会查看间接后代，因此您需要提供正确的元素名称链，指向您要修改的元素。

你的意思是写

```
doc.Element("Entry").Element("Properties").Element("Thungs").Add(module); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T10:54:33.033

如果您要简化它，为什么不一路走下去呢？

```
XDocument doc = XDocument.Load(filename);
var ordered = doc.Descendants("Thing")
                 .OrderBy(thing => thing.Attribute("ID").Value)
                 .ToList(); // force evaluation
doc.Descendants("Thing").Remove();
doc.Descendants("Thungs").Single().Add(ordered);
doc.Save(filename); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-08T10:44:23.473

你甚至不需要创建两个`XDocument`对象：

```
 XDocument doc = XDocument.Load(filename);

        var query = from things in doc.Descendants("Thing")
                    orderby things.Attribute("ID").Value
                    select things;

        var orderedThings = query.ToList<XElement>();
        doc.Descendants("Thing").Remove();
        doc.Descendants("Thungs").First().Add(orderedThings);

        doc.Save(filename); 
```

编辑：如果您知道 XML 架构中的“路径”，最好使用 dasblinkenlight 建议使用：

```
 doc.Element("Entry").Element("Properties").Element("Thungs").Add(orderedThings); 
```

而不是`Descendants("Thungs").First()`线。

# asp.net - Webservice 隐藏了原始类名

> ID：11382270
> 
> 赞同：0
> 
> 时间：2012-07-08T10:01:33.133
> 
> 标签：asp.net, web-services, strongly-typed-dataset

我有一个带有类型数据集的 DataLayer 项目。

我有另一个名为 SiteWebServices 的项目，它只包含 web 服务。

我有另一个 Web 应用程序项目，它是普通网站。这使用使用 DataLayer 的 SiteWebServices。

现在 SiteWebServices 项目用自己的命名空间隐藏了原始的 DataLayer 类。例如；DataLayer.SiteDS.COMPLAINTDataTable 公开为 SiteWebServices.SiteDS.COMPLAINTDataTable。

一切正常，除了在 webmethod 中可以正常接收数据，但是在网站中使用它时，什么也没有收到。任何地方都不会产生错误。

我已经在我的网站上上传了代码（安全）[源代码](http://www.tracknifty.com/webappsl.rar)。在各自的项目中有2个webservices和2个对应的测试页面，在2个webmethods中有适当的注释。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T10:07:39.547

需要更多解释，您应该更好地使用 SOAPUI (http://www.soapui.org/) 独立测试 Web 服务

# rest - Restlet - Jax-RS 2.0 知道吗？

> ID：11382273
> 
> 赞同：0
> 
> 时间：2012-07-08T10:02:27.397
> 
> 标签：rest, jax-rs, restlet

我看到 Restlet 已经有一个稳定的 2.0 版本，甚至进一步测试和不稳定的 2.1 和 2.2 版本。他们是否已经了解 JAX-RS 2.0？如果这是真的，那么它们在 JAX-RS 实现中似乎比 jersey jax-rs 参考框架更进一步。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T13:34:07.147

Restlet Framework (RF) 版本根本不与 JAX-RS 版本同步。目前 RF 2.1 仅支持 JAX-RS 1.0。

但是请注意，我们通过 org.restlet.ext.jaxrs.JaxRsClientResource 类在 RF 2.1 中添加了（非标准）JAX-RS 客户端支持。

我们期待在标准 JAX-RS API 2.0 版本稳定时支持它，可能在 RF 3.0 中。

# image - GWT 2：我可以将图像资源作为数组处理吗？

> ID：11382278
> 
> 赞同：0
> 
> 时间：2012-07-08T10:03:22.870
> 
> 标签：image, gwt, resources

在我的 GWT 项目中，我有一些单独的图像集。最方便的是将这组图像作为 ImageResource 数组处理。即我想在我的 Resources 接口中有一个方法，它可以返回这些 ImageResources 实例的数组，而不是一个一个地返回它们。

是否可以在 GWT 2.4 中对此进行编码？

ps 是的，我知道我可以将它们一一返回，然后手动创建该数组。但可能有更好的解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T16:46:31.703

我不知道这样做的任何界面。
但或者，您可以查看[ClientBundleWithLookup](http://google-web-toolkit.googlecode.com/svn/javadoc/latest/com/google/gwt/resources/client/ClientBundleWithLookup.html)。
根据您的用例，它可能对您有用。

# php - 使用 ZIP 处理文件和文件夹

> ID：11382280
> 
> 赞同：2
> 
> 时间：2012-07-08T10:03:38.080
> 
> 标签：php, html, zip

我们有一些 html 代码，例如：

```
<body>Some text</body> 
```

和一个变量`$contents`。

这是我第一次在 php 中使用 zip，有几个问题。

我如何能：

1.  创建一个名为的文件夹`HTML`并将其放在里面`$contents`（**在 ftp 上没有真正的创建**，只是在变量中）

2.  创建一个`index.html`并将其放在`HTML`文件夹中，该文件夹位于`$contents`

    所以`$contents`之前的 zip 应该包含：

    ```
     /HTML/index.html (with <body>Some text</body> code inside) 
    ```

3.  创建一个包含`$contents`变量内所有内容的 zip 存档。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T10:06:26.863

如果我理解正确：

```
$contents = '/tmp/HTML';
// Make the directory
mkdir($contents);
// Write the html
file_put_contents("$contents/index.html", $html);
// Zip it up
$return_value = -1;
$output = array();
exec("zip -r contents.zip $contents 2>&1", $output, $return_value);
if ($return_value === 0){
    // No errors
    // You now have contents.zip to play with
} else {
   echo "Errors!";
   print_r($output);
} 
```

我没有使用库来压缩它，只是命令行，但如果你愿意，你可以使用库（但我正在检查是否`zip`正确执行）。

* * *

如果你真的想在内存中做所有事情，你可以这样做：

```
$zip = new ZipArchive;
if ($zip->open('contents.zip') === TRUE) {
    $zip->addFromString('contents/index.html', $html);
    $zip->close();
    echo 'ok';
} else {
    echo 'failed';
} 
```

[http://www.php.net/manual/en/ziparchive.addfromstring.php](http://www.php.net/manual/en/ziparchive.addfromstring.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T10:31:10.317

我建议使用该[`ZipArchive`](http://www.php.net/manual/en/class.ziparchive.php)课程。所以你可以有这样的东西

```
$html = '<body>some HTML</body>';
$contents = new ZipArchive();
if($contents->open('html.zip', ZipArchive::CREATE)){
    $contents->addEmptyDir('HTML');
    $contents->addFromString('index.html', $html);
    $contents->close()
} 
```

# java - java正则表达式用{var}乘以{var}px替换{var}px

> ID：11382293
> 
> 赞同：3
> 
> 时间：2012-07-08T10:06:20.343
> 
> 标签：java, regex, variables

我有以下字符串：

```
<div height="40px" width="30px" /> 
```

我想用正则表达式替换所有后面有 px 的数字，它们的值是 X 倍。（X 是一个变量）。

所以如果 X=3，结果将是

```
<div height="120px" width="90px" /> 
```

请注意，X 必须是我将检索到函数的变量

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-08T10:19:32.023

以下代码将使用正则表达式替换字符串中的`30px`with ：`240px``s`

```
import java.util.regex.Pattern;
import java.util.regex.Matcher;

public class Example {
    public static void main(String[] args) {
        String s = "abc 30px def";
        int var = 8;

        Pattern patt = Pattern.compile("([0-9]+)px");
        Matcher m = patt.matcher(s);
        StringBuffer sb = new StringBuffer(s.length());
        while (m.find()) {
            int px = Integer.parseInt(m.group(1));
            String next = String.valueOf(var * px) + "px";
            m.appendReplacement(sb, Matcher.quoteReplacement(next));
        }
        m.appendTail(sb);
        System.out.println(sb.toString());
    }
} 
```

以下是它执行的步骤：

*   创建一个编译的正则表达式。当稍后再次使用正则表达式时，这会提高性能。
*   在字符串中搜索`s`匹配项和每个匹配项：
    *   将字符串转换为整数并将其乘以`var`.
    *   再次追加`px`并将其作为替换字符串传递。
*   最后，用替换的某些字符串再次打印输入字符串。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-08T10:21:05.397

普通的正则表达式无法*计算*。有一些扩展，例如在 Perl 中，但我认为它们在 Java 中不可用。所以你将不得不走很长的路：

*   使用正则表达式进行加工
*   提取匹配值
*   建立重置价值
*   代替

抱歉，没有可用的单线解决方案。（但这并不难，除了你需要一个 for 循环）。

# jquery - 使用 jQuery 更改按钮 ID

> ID：11382299
> 
> 赞同：0
> 
> 时间：2012-07-08T10:06:52.073
> 
> 标签：jquery, button

我有一个带有一个按钮的表单，其初始值为`'Submit'`，其 ID 由`'submit1'`它使用：

```
$( function(){
$("#submit1").click(function () {
    alert("i got ");
    var dname = $("#dname").attr('value');
    if(jQuery.trim(dname).length == 0){
        $("#dnametd").append("<span id='requiredsp' class='vanadium-advice vanadium-invalid'>Thissss is a required field.</span>");
        $("#dname").keyup(function () {
            $("#requiredsp").remove();
        });
    }
    else{
var dname = $("#dname").attr('value');
var symptons = $("#symptons").attr('value');
$.ajax({
                type: "POST",
                data: "method=" +"addDisease"+"&dname="+dname+"&symptons="+symptons+"&status="+"y",
                url:  "classes/disease_type.class.php",
                success: function(){
                gettables();
                    }
               }); 
        $("#newformreg").hide( { direction: "left" }, 1500);
        $("#dname").val('');
        $("#symptons").val('');
    }

    });
}); 
```

稍后我从服务器获取数据，并在上面的表单中获取这些数据，其中包含一个隐藏的 id 文本框，并且我将按钮值更改为更新，并将 id 更改为如下所示。

```
 function doEdit(id){
        $.ajax({
                type: "POST",
                data: "method=" +"getDisease"+"&did="+id,
                url:  "classes/disease_type.class.php",
                success: function(myVar){
                    $("#newformreg").show( { direction: "left" }, 1000);
                    arr3=myVar.split('%');
                    $('<input>').attr({type:'hidden',id:'did'}).appendTo("#insertForm");
                    $("#did").val(arr3[0]);
                    document.getElementById("dname").value=arr3[1];
                    //$("#dname").val(arr3[1]);
                    $("#symptons").val(arr3[2]);
                    $("#submit1").prop({id:'update',value:'Update'});
                    //document.getElementById("submit").value="Update";
                    //document.getElementById("submit").id="update";
                },
                }); 
                            }

            $( function() {
            $("#update").click(function () {
            var upvalue = $("#update").attr('value');
            alert("updateclick");
            alert(upvalue);
            var dnamee = document.getElementById("dname").value;

            if(jQuery.trim(dname).length == 0){
                $("#dnametd").append("<span id='requiredsp' class='vanadium-advice vanadium-invalid'>Thissss is a required field.</span>");
                $("#dname").keyup(function () {
                    $("#requiredsp").remove();
                });
            }
            else{
                alert("proper");
            var did = $("#did").attr('value');      
            var dname = $("#dname").attr('value');
            var symptons = $("#symptons").attr('value');

                $.ajax({
                type: "POST",
                data: "method=" +"updateDisease"+"&dname="+dname+"&symptons="+symptons+"&did="+did+"&doUpdate="+"edit",
                url:  "classes/disease_type.class.php",
                success: function(){
                    $("#msgdiv").addClass("msg success").add('<span>Record Updated Successfuly</span>');
                    }
               }); 
            }
        }); 
    alert("out");
           }); 
```

但即使在这样做之后，每当我点击更新时，它都会执行上述提交按钮的功能并且不会更新。此外，当我的页面打开时，它给了我上面`alert("out");`。我不明白发生了什么事。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T10:13:00.063

您`$("#update").click()`用于绑定点击事件，但页面第一次加载时“更新”ID 不存在。

为了动态绑定事件，您需要使用该`.on()`方法。[在这里](http://api.jquery.com/on/)查看更多细节。

**编辑**：

你的代码写得不太好，我建议你给按钮一个 ID (#submitBtn) 并给它一个更新/保存类。然后你这样做：

```
$("#submitBtn").click(){
    if ($(this).hasClass('save')){
    //do save code
    }
    else{
      //do update code
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T10:16:13.177

```
alert("out"); 
```

工作正常。当您在代码 **$( function() {**中使用它时，这意味着准备就绪。

# iphone - 点击/单击查看操作 Xcode

> ID：11382304
> 
> 赞同：3
> 
> 时间：2012-07-08T10:07:57.350
> 
> 标签：iphone, objective-c, ios, xcode, ios5

有`Touch Up Inside`意见吗？当用户点击或单击视图时，我想调用一个动作。目前我在这个视图上使用了一个隐藏按钮，但这不是一个聪明的方法。

任何帮助表示赞赏:)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-08T10:24:11.120

那么你也可以像这样在 UIView 上使用 addGestureRecognizer 方法：

```
// In some View controller
UITapGestureRecognizer *tapGR;
tapGR = [[[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(handleTap:)] autorelease];
tapGR.numberOfTapsRequired = 1;
[myUIView addGestureRecognizer:tapGR];

// Add a delegate method to handle the tap and do something with it.
-(void)handleTap:(UITapGestureRecognizer *)sender
{
    if (sender.state == UIGestureRecognizerStateEnded) {
        // handling code
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-08T10:14:12.323

我不明白为什么使用隐藏按钮不是一种聪明的方式......这是Apple自己建议的方式，我认为它很聪明，目前是更好的方式......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-08T10:41:35.190

如果`- (void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event`您希望检测屏幕上没有按钮的任何位置的触摸，请使用此选项。您还可以像这样找到触摸的位置：

```
- (void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event {
    UITouch *touch = [touches anyObject];   
    CGPoint *tLocation = [touch locationInView:self.view];
} 
```

注意：**每次**`touchesEnded`点击视图时都会调用它，因此每次用户触摸屏幕时，上述内容都会改变。**`tLocation`**

# jquery - 从序列化字符串中删除空字段/输入

> ID：11382318
> 
> 赞同：1
> 
> 时间：2012-07-08T10:11:02.840
> 
> 标签：jquery, serialization

> **可能重复：**
> [如何使用 jQuery 的 form.serialize 但排除空字段](https://stackoverflow.com/questions/608730/how-do-i-use-jquerys-form-serialize-but-exclude-empty-fields)

如果未在表单上填写未使用的输入名称，我需要从序列化字符串中删除它们。请参阅随附的 JSFIddle。目前，如果有人只填写 Q1 和 Q3 的名称，则字符串显示如下`/static/url/to/file.php?Q1=Bob&Q2=&Q3=Dan&Q4=`。因此，我想在提交之前从字符串中删除`Q2=`和名称。`Q4=`谢谢

[JSFiddle - 序列化](http://jsfiddle.net/4Nmcx/125/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T10:17:15.323

试试这个：

```
$('#form1').find('input[type="text"]').not('#url').change(function(){
    var val = "";
    var url = '/static/url/to/file.php?';
    $('form input[type="text"]').not('#url').each(function(){
        if ($.trim(this.value).length > 0 ) { 
          val += ($(this).attr('name') + "=" + this.value + "&");
        }  
    })
    $('#url').val(url+val);
});

$('#button').click(function(){
    window.location = $('#url').val();
}); 
```

[演示](http://jsfiddle.net/4Nmcx/133/)

# c# - 将附加属性添加到现有控件

> ID：11382323
> 
> 赞同：0
> 
> 时间：2012-07-08T10:13:01.380
> 
> 标签：c#, .net, wpf, xaml, attached-properties

我想向按钮控件添加一个属性，例如“描述”，我在工具提示中使用它。如何将属性添加到控件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T14:43:02.487

您可以使用按钮上的 Tag 属性，即 Object 类型，如果您愿意，可以在其中存储描述文本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T10:27:08.087

附加属性不会添加到任何特定控件。

附加属性在静态类中定义，可以与任何 UI 控件一起使用。

有关添加自定义附加属性的演练，请参阅[此链接](http://msdn.microsoft.com/en-us/library/ms753957.aspx)。

您可以绑定[ToolTipService](http://www.codeproject.com/Articles/36930/Tooltip-service-and-tooltip-facility-of-WPF) 以显示工具提示。您需要将其绑定到描述附加属性。

如果只想将属性放在一个控件中（使其他控件无法使用），则需要扩展控件，并在其中定义[Dependency 属性](http://msdn.microsoft.com/en-us/library/ms753358.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-08T10:16:44.543

创建一个从现有控件继承的新控件。

# c-preprocessor - 编译器应该为#define 的某些组合引发错误

> ID：11382324
> 
> 赞同：1
> 
> 时间：2012-07-08T10:13:24.230
> 
> 标签：c-preprocessor, preprocessor-directive

在当前的项目中，我进行了很多试验，以了解不同解决方案对性能的影响。因为我喜欢保留所有代码，所以我有很多#ifdef 指令，这使我可以轻松地打开和关闭一些优化。但是，某些定义组合并未涵盖。如果发生这种情况，我希望看到编译器错误，即：

```
#define A
#define B

#ifdef A
#ifdef B
//invalid combination of defines. Compiler should raise an error.
#endif
#endif

#ifdef A
//do something
#endif
#ifdef B
//do something else
#endif 
```

那可能吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-08T10:15:31.373

是的。只需使用[错误指令](https://stackoverflow.com/questions/2221517/how-to-generate-an-error-and-warning-in-c-preprocessor)( `#error`)。

```
#ifdef A
#ifdef B
#error "invalid combination of defines."
#endif
#endif 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-08T10:15:43.027

```
#ifdef A
#ifdef B
//invalid combination of defines. Compiler should raise an error.
#error Invalid combination
#endif
#endif 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-08T10:18:28.847

使用错误预处理器指令：

```
#error "Invalid combination" 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-08T10:19:22.397

```
#if defined(A) && defined(B)
#error invalid combination of defines
#endif 
```

# python - Pygame，操纵杆检测不起作用

> ID：11382335
> 
> 赞同：2
> 
> 时间：2012-07-08T10:15:48.423
> 
> 标签：python, pygame, joystick

我正在尝试使用 Pygame 检测 USB 操纵杆。每次我运行此代码时，程序都会因错误而崩溃：第 10 行中的“操纵杆未初始化”。

```
import pygame as p

p.init()
stick = p.joystick.Joystick(0)
#get init returns always False
print("initialized:",bool(stick.get_init()))
#getting the name works as it should
print(stick.get_name())
#says always "pygame.error: Joystick not initialized"
print("axis_0",stick.get_axis(0))   
p.quit() 
```

我做错了什么还是这是一个错误？（我在 Python 3.2 和 Windows 7 上使用最新的 pygame 版本。）感谢您提供的所有信息

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-03T19:17:52.800

我自己刚开始使用 Pygame。我`pygame.joystick.init()`先用了。所以，我猜你会`p.init()`用`p.joystick.init()`.

来自 Pygame 文档：（http://www.pygame.org/docs/ref/joystick.html）

> 您可以调用 Joystick.get_name - 获取 Joystick 系统名称和 Joystick.get_id - 获取 Joystick ID 函数，而无需初始化 Joystick 对象。

我认为您还必须在其中写一行：

```
stick.init() 
```

然后初始化棒并从中接收事件。

# c# - 将 C++ 代码（com 接口）翻译成 C#

> ID：11382341
> 
> 赞同：0
> 
> 时间：2012-07-08T10:16:25.073
> 
> 标签：c#, com

我正在尝试编写 DirectSound Wrapper。所以我必须将 dsound.h 文件的 Cominterfaces 导入 c#。我目前正在研究 IDirectSoundBuffer。这是这样声明的：

```
DEFINE_GUID(IID_IDirectSoundBuffer, 0x279AFA85, 0x4981, 0x11CE, 0xA5, 0x21, 0x00, 0x20, 0xAF, 0x0B, 0xE5, 0x60);

#undef INTERFACE
#define INTERFACE IDirectSoundBuffer

DECLARE_INTERFACE_(IDirectSoundBuffer, IUnknown)
{
    // IUnknown methods
    STDMETHOD(QueryInterface)       (THIS_ __in REFIID, __deref_out LPVOID*) PURE;
    STDMETHOD_(ULONG,AddRef)        (THIS) PURE;
    STDMETHOD_(ULONG,Release)       (THIS) PURE;

    // IDirectSoundBuffer methods
    STDMETHOD(GetCaps)              (THIS_ __out LPDSBCAPS pDSBufferCaps) PURE;
    STDMETHOD(GetCurrentPosition)   (THIS_ __out_opt LPDWORD pdwCurrentPlayCursor, __out_opt LPDWORD pdwCurrentWriteCursor) PURE;
    STDMETHOD(GetFormat)            (THIS_ __out_bcount_opt(dwSizeAllocated) LPWAVEFORMATEX pwfxFormat, DWORD dwSizeAllocated, __out_opt LPDWORD pdwSizeWritten) PURE;
    STDMETHOD(GetVolume)            (THIS_ __out LPLONG plVolume) PURE;
    STDMETHOD(GetPan)               (THIS_ __out LPLONG plPan) PURE;
    STDMETHOD(GetFrequency)         (THIS_ __out LPDWORD pdwFrequency) PURE;
    STDMETHOD(GetStatus)            (THIS_ __out LPDWORD pdwStatus) PURE;
    STDMETHOD(Initialize)           (THIS_ __in LPDIRECTSOUND pDirectSound, __in LPCDSBUFFERDESC pcDSBufferDesc) PURE;
    STDMETHOD(Lock)                 (THIS_ DWORD dwOffset, DWORD dwBytes,
                                           __deref_out_bcount(*pdwAudioBytes1) LPVOID *ppvAudioPtr1, __out LPDWORD pdwAudioBytes1,
                                           __deref_opt_out_bcount(*pdwAudioBytes2) LPVOID *ppvAudioPtr2, __out_opt LPDWORD pdwAudioBytes2, DWORD dwFlags) PURE;
    STDMETHOD(Play)                 (THIS_ DWORD dwReserved1, DWORD dwPriority, DWORD dwFlags) PURE;
    STDMETHOD(SetCurrentPosition)   (THIS_ DWORD dwNewPosition) PURE;
    STDMETHOD(SetFormat)            (THIS_ __in LPCWAVEFORMATEX pcfxFormat) PURE;
    STDMETHOD(SetVolume)            (THIS_ LONG lVolume) PURE;
    STDMETHOD(SetPan)               (THIS_ LONG lPan) PURE;
    STDMETHOD(SetFrequency)         (THIS_ DWORD dwFrequency) PURE;
    STDMETHOD(Stop)                 (THIS) PURE;
    STDMETHOD(Unlock)               (THIS_ __in_bcount(dwAudioBytes1) LPVOID pvAudioPtr1, DWORD dwAudioBytes1,
                                           __in_bcount_opt(dwAudioBytes2) LPVOID pvAudioPtr2, DWORD dwAudioBytes2) PURE;
    STDMETHOD(Restore)              (THIS) PURE;
}; 
```

所以我试着这样翻译：

```
[ComImport, InterfaceType(ComInterfaceType.InterfaceIsIUnknown),
Guid("279AFA85-4981-11CE-A521-0020AF0BE560")]
public interface IDirectSoundBuffer : IUnknown
{
    //int QueryInterface(ref Guid guid, out IntPtr comObject);
    //int AddReference();
    //int Release();

    //IDirectSoundBuffer methods
    void GetCaps([MarshalAs(UnmanagedType.LPStruct)] DSBufferCaps pDSBufferCaps); //TODO
    void GetCurrentPosition([Out] out UInt32 pdwCurrentPlayCursor, [Out] out UInt32 pdwCurrentWriteCursor);
    void GetFormat([Out, MarshalAs(UnmanagedType.CustomMarshaler, MarshalType = "AMEngine.Wave.WaveFormatMarshaler")] out AMEngine.Wave.WaveFormat pwfxFormat,
                    int dwSizeAllocated, [Out] out int pdwSizeWritten); //TODO implement
    [return: MarshalAs(UnmanagedType.I4) /*See http://msdn.microsoft.com/en-us/library/aa288468%28v=vs.71%29.aspx */]
    Int32 GetVolume();
    [return: MarshalAs(UnmanagedType.I4)]
    Int32 GetPan();
    [return: MarshalAs(UnmanagedType.I4)]
    Int32 GetFrequency();
    [return: MarshalAs(UnmanagedType.I4)]
    Int32 GetStatus();
    void Initialize([In, MarshalAs(UnmanagedType.Interface)] IDirectSound pDirectSound, [In] DSBufferDescription pcDSBufferDesc);
    void Lock(int dwOffset, int dwBytes,
              [Out] out IntPtr ppvAudioPtr1, [Out] out int pdwAudioBytes1,
              [Out] out IntPtr ppvAudioPtr2, [Out] out int pdwAudioBytes2,
              DSBLock dwFlags );
    void Play(int dwReserved1, int dwPriority, DSBPlayFlags dwFlags); 
    void SetCurrentPosition(int dwNewPosition);
    void SetFormat([In] AMEngine.Wave.WaveFormat pcfxFormat);
    void SetVolume(int lVolume);
    void SetPan(int lPan);
    void SetFrequency(int dwFrequency);
    void Stop();
    void Unlock([In] IntPtr pvAudioPtr1, int dwAudioBytes1,
                [In] IntPtr pvAudioPtr2, int dwAudioBytes2);
    void Restore();

} 
```

IUnknown 是这个接口：

```
[Guid("00000000-0000-0000-C000-000000000046")]
public interface IUnknown
{
    int QueryInterface(ref Guid gidd, out IntPtr ppvObject);
    int AddRef();
    int Release();
} 
```

接口 IDirectSoundBuffer 本身可以工作。但是对于像 SetVolume 这样的成员，我遇到了异常 E_NONINTERFACE，它告诉我必须实现 QueryInterface。所以我创建了 IUnknown。但我可以尝试任何我喜欢的东西。它永远不会起作用。当我尝试上面的解决方案时，当我尝试播放主缓冲区时出现异常。它告诉我，我必须将其他标志设置为 primarybufferdescritption。但是如果我设置其他标志，我会在尝试创建缓冲区时遇到异常。最后我得出的结果是接口声明一定是错误的，因为如果我删除所有 IUnknown 东西我可以播放音频但我不能设置音量，平移，......但我可以播放它工作这么远。

几周以来我一直在尝试解决这个问题，但我找不到任何解决方案。所以你是我最后的希望:(

# java - 仅在第一次调用方法时调用方法块

> ID：11382342
> 
> 赞同：3
> 
> 时间：2012-07-08T10:16:25.100
> 
> 标签：java

我有一个方法，在这个方法里面我有一个块：

```
public void method()
{
   [block instructions]
} 
```

但是这个方法在我的程序中被调用了两次。我希望这个块只执行一次，并且只在方法的第一次出现时执行。什么是最好和优雅的方式来做到这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-08T10:17:48.017

```
private static final AtomicBoolean hasRunAtom = new AtomicBoolean();

public void method() {
  if (hasRunAtom.getAndSet(true)) return;
  [block instructions]
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-08T10:28:32.657

冒着过度设计的风险，我实际上建议[使用 state-pattern](/questions/tagged/state-pattern "显示标记为“状态模式”的问题")。本质上你有一个`State`抽象：

```
interface State extends Runnable {} 
```

有两种实现：

```
class FirstState extends State {
    public void run() {
        //[block of code]
        state = new SecondState();
    }
}

class SecondState extends State {
    public void run() {
        //[block instructions]
    }
} 
```

`FirstState`开关`state`电流：

```
private State state = new FirstState(); 
```

您`method()`现在没有条件逻辑：

```
public void method()
{
    state.run();
} 
```

然而，在 99% 的情况下，`boolean`标志就足够了……

更新：上面的解决方案不是线程安全的。如果你需要它，简单`AtomicReference<State> state` ~~*惯于*~~就足够了（请参阅下面的*Marko Topolnik*评论）或者您需要同步整个`method()`：

```
public synchronized void method()
{
    state.run();
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-06-27T16:20:30.023

一个简单的解决方案是使用静态布尔标志：

```
static boolean flag = true;

public void method()
{  
  if (flag)
  {

      [block instructions]
      flag = false;  

  }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-08T11:07:02.940

首先，如果您想要简单快捷的方法，请使用简单的布尔标志（只是不要忘记并发问题并使用@Marko Topolnik 解决方案）。

但是如果我们已经开始了理论讨论并谈到了设计模式，而不是像@Tomasz Nurkiewicz 提到的那样使用状态模式，我建议考虑[单例](/questions/tagged/singleton "显示标记为“单身人士”的问题")（有人会说它更反设计模式）以及如何实现只有一个这个类的实例，所以如果请求这个类的实例，构造函数只会在第一次调用时被调用。

如果您想要更多“开箱即用”的解决方案，您可以使用[aop](/questions/tagged/aop "显示标记为“aop”的问题")

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-08T15:06:24.803

您可能应该重新设计您的方法。如果一个方法在第二次运行时做了不同的事情，这会让试图理解你的程序的人感到困惑。

它是第二次从程序中的不同位置调用吗？如果是这种情况，最简单的方法是将复制的位提取到另一种方法中。

```
method() {
    // Do stuff that's run only the first time
    method2()
}

method2() {
    // Do stuff that's run both times
} 
```

如果它是从同一个地方调用的，你应该问自己为什么你的代码期望第二次发生不同的事情。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-12-30T21:08:43.270

Marko 的回答在概念上很简单，但现在每次调用方法都需要对 AtomicBoolean 执行原子操作。如果 method() 被非常普遍地调用，这将导致显着的性能损失。

这是我提出的另一个基于单例模式的线程安全解决方案。我希望这会显着减少性能开销。

```
public class MyClass {
    public void method() {
        BlockRunner.runIfFirst();
    }

    private static class BlockRunner {
        static {
            [block insturctions]
        }

        public static void runIfFirst() {}
    }
} 
```

此解决方案基于[此处描述](https://stackoverflow.com/questions/70689/what-is-an-efficient-way-to-implement-a-singleton-pattern-in-java)的 Singleton 惰性初始化概念。

如果我的理解是正确的，当 BlockRunner 第一次通过调用 runIfFirst() 调用时，静态代码块将被调用。以后对 runIfFirst() 的所有调用都将立即返回，而不会执行任何实际代码。从性能的角度来看，您正在用简单的分支和返回操作替换繁重的原子操作。

# cuda - cusparse csrsv_analysis 的性能非常慢

> ID：11382346
> 
> 赞同：3
> 
> 时间：2012-07-08T10:17:03.040
> 
> 标签：cuda, linear-algebra, sparse-matrix

我写了一个带有 LU 预处理的共轭梯度求解器（用于线性方程组），我使用 Maxim Naumov 博士在 nvidia 研究社区上的[论文](https://developer.nvidia.com/sites/default/files/akamai/cuda/files/psts_white_paper_final.pdf)作为指导，残差更新步骤，这需要求解下三角矩阵系统，然后求解上三角矩阵系统分为两个阶段：

1.  分析阶段（利用稀疏模式并决定并行化级别）。
2.  解决阶段本身。

根据与该主题相关的所有帖子以及 Naumov 的论文本身，分析阶段比求解阶段慢得多，但它只执行一次，因此考虑到整个执行时间，这应该不是问题，但是，在我的程序中，分析阶段需要大约 35-45% 的整个求解时间（执行所有迭代所需的时间！），这很烦人，另一件事是我很确定矩阵的稀疏模式不会允许大量并行化，因为几乎所有元素都需要知道先前的元素（因为在 CFD 中，每个节点都需要至少相邻的 6 个节点（六面体体积）围绕它，并且每行都重复），所以分析阶段反正不会很有用！

***这段代码中的matrixLU***同时包含上三角矩阵和下三角矩阵，上三角矩阵使用原始矩阵对角线，下三角矩阵有单位对角线（LU分解）。

```
// z = inv(matrixLU)*r
cusparseMatDescr_t descrL = 0 ;
cusparseMatDescr_t descrU = 0 ;
cusparseStatus = cusparseCreateMatDescr(&descrL) ;
cusparseStatus = cusparseCreateMatDescr(&descrU) ;

cusparseSetMatType(descrL,CUSPARSE_MATRIX_TYPE_GENERAL) ;
cusparseSetMatIndexBase(descrL,CUSPARSE_INDEX_BASE_ONE) ;
cusparseSetMatDiagType(descrL,CUSPARSE_DIAG_TYPE_UNIT) ;
cusparseSetMatFillMode(descrL,CUSPARSE_FILL_MODE_LOWER) ;

cusparseSetMatType(descrU,CUSPARSE_MATRIX_TYPE_GENERAL) ;
cusparseSetMatIndexBase(descrU,CUSPARSE_INDEX_BASE_ONE) ;
cusparseSetMatDiagType(descrU,CUSPARSE_DIAG_TYPE_NON_UNIT) ;
cusparseSetMatFillMode(descrU,CUSPARSE_FILL_MODE_UPPER) ;

cusparseSolveAnalysisInfo_t inforL = 0 ;
cusparseSolveAnalysisInfo_t inforU = 0 ;
cusparseStatus = cusparseCreateSolveAnalysisInfo(&inforL) ;
cusparseStatus = cusparseCreateSolveAnalysisInfo(&inforU) ;

double startFA = omp_get_wtime() ;
cusparseStatus = cusparseDcsrsv_analysis(cusparseHandle, CUSPARSE_OPERATION_NON_TRANSPOSE, N, NZ, descrL, matrixLU, iRow, jCol, inforL) ;
if(cusparseStatus != CUSPARSE_STATUS_SUCCESS) printf("%s \n\n","cusparseDcsrsv_analysis1 Error !") ;
cusparseStatus = cusparseDcsrsv_analysis(cusparseHandle, CUSPARSE_OPERATION_NON_TRANSPOSE, N, NZ, descrU, matrixLU, iRow, jCol, inforU) ;
if(cusparseStatus != CUSPARSE_STATUS_SUCCESS) printf("%s \n\n","cusparseDcsrsv_analysis2 Error !") ;
double finishFA = omp_get_wtime() ; 
```

那么，有人知道为什么分析阶段如此缓慢吗？以及如何加速？（分析阶段执行时间）/（求解阶段执行时间）**比率**是否取决于 GPU？

**编辑：** 我在很多情况下都尝试了这个求解器，结果很接近，但在我关心的特定情况下，它具有以下条件：

*   尺寸 ( ***N*** ) : ~ **860,000 * 860,000**
*   非零数 ( ***NZ*** ): ~ **6,000,000**
*   收敛所需的迭代次数：**10**
*   **分析**阶段执行时间：**210 ms**
*   **求解**阶段执行时间（总结**所有迭代**）：**350 ms**
*   所有浮点运算都以**双精度**格式执行
*   显卡：**GeForce GTX 550 Ti**
*   操作系统：**Windows 7**终极版，**64 位**

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-12T04:45:39.837

我联系了 NVIDIA 的线性代数库团队，他们提供了以下反馈。

1.  关于性能结果：

    1.  CG 迭代法只执行 10 次迭代，直到找到线性系统的解。在这种情况下，这似乎不足以分摊分析阶段消耗的时间。**（编辑：）**收敛到解决方案所需的步骤数量因不同的应用程序而异。在一些无条件的迭代方法中，不收敛（或需要数千次迭代），而有条件的迭代方法需要数十次（或数百次）迭代才能收敛到一个解。在这个特定的应用中，迭代方法在 10 次迭代中收敛的事实并不一定代表所有应用。

    2.  分析和求解阶段的比率为 6 = 210/35，这与我们在其他矩阵上的实验一致，通常在区间 [4,10] 内。目前尚不清楚分析和求解阶段的时间与 CPU 上稀疏三角求解所花费的时间相比如何。（这将是有趣的信息。）

2.  关于算法：
    1.  不幸的是，您只能做一些事情来恢复一点点性能（没有真正的方法可以加快分析阶段）。例如，您可以将 matrixLU 拆分为单独的下三角部分和上三角部分。使用单独的三角形部分进行计算通常比使用嵌入在一般矩阵中的三角形部分进行计算要快。如果您使用填充为 0 的不完全分解作为预条件子，您还可以利用 GPU 上填充为 0 的不完整 LU/Cholesky，该功能最近在 CUSPARSE 库中可用。（**编辑**：） CUDA Toolkit 5.0 版本中提供了填充为 0 的不完整 LU 分解。目前该版本的抢先体验版可供[注册开发者获取](http://www.nvidia.com/content/cuda/cuda-toolkit.html)在 NVIDIA 网站上。
    2.  我们从未研究过不同 GPU 之间分析和求解阶段的比例如何变化；我们所做的所有实验都是在 C2050 上进行的。
    3.  分析阶段很慢，因为它必须收集有关哪些行可以一起处理成级别的信息。求解阶段更快，因为它只处理关卡（参见[本文](http://research.nvidia.com/publication/parallel-solution-sparse-triangular-linear-systems-preconditioned-iterative-methods-gpu)）。

最后，您还提到您认为问题中没有足够的并行性。但是仅从矩阵中很难猜出并行度的数量。如果确实很少有并行性（每一行都依赖于前一行），那么 CUSPARSE 稀疏三角求解可能不是解决这个问题的正确算法。此外，您可以尝试在不进行预处理或使用其他类型的可能更适合您的问题的预处理器的情况下运行 CG 迭代方法。

如前所述，了解这段代码在 GPU 和 CPU 上的性能比较会很有趣。

**编辑：** 关于一些评论......如前所述，预条件迭代方法的最终迭代次数因不同的应用程序而异。在某些情况下，它可能非常小（例如，在您的应用程序中为 10），但在其他情况下，它可能相对较大（以 100 秒为单位）。这篇论文关注的不是“胜利”，而是算法的权衡。它试图让用户对例程有更深入的了解，以便有效地使用它。同样，如果手头的稀疏模式没有任何并行性，那么这不是适合您的算法。

CPU和GPU的比较，有一些问题（比如密集矩阵-矩阵或者稀疏矩阵-向量乘法）GPU是很好的，还有其他的（比如遍历链表或者执行完全顺序的一段代码），它不是。稀疏三角线性系统的解决方案介于这些算法之间（取决于系数矩阵的稀疏模式和线性系统的其他属性，它可能适合您，也可能不适合您）。此外，使用 GPU 的决定不仅仅基于单一算法，例如稀疏三角求解，而是基于应用程序使用的整套算法。最终，GPU 在加速和提高整个应用程序的性能方面通常非常成功。

最后，关于 trsm 与 csrsv，我们并不感到惊讶的是，对于小矩阵，在密集存储中执行操作比在稀疏存储中更快（即使这些小矩阵可能是稀疏的）。这通常不仅适用于三角求解，而且适用于其他线性代数运算（不过，根据运算和矩阵的稀疏模式，它可能发生在不同的交叉点）。同样，稀疏三角求解算法被设计为在迭代设置中运行，其中分析完成一次​​，求解完成多次。因此，运行一次（并在分析阶段计数）会导致更高的交叉点，从而使此操作在稀疏而不是密集格式中更有效，这并不奇怪。

# javascript - 当另一个 CSS 值更改时更改 CSS 值的方法？

> ID：11382348
> 
> 赞同：2
> 
> 时间：2012-07-08T10:17:27.190
> 
> 标签：javascript, jquery, css

我的 div 结构如下：

```
<div id='head'>
    <div class='graphData'>
        <table>...</table>
    </div>
    <div class='graph'>...</div>
</div> 
```

**编辑**：

抱歉，我忘记了结构的几个重要部分。

`head`，`graphData`并且`graph`都将其`min-heights`设置为 300px。

我的问题是，当min-height 增加或减少时，如何更改`head`和`graph's`min-height 以匹配min-height？有什么方法可以通过 jQuery 或 javascript 检测 css 样式更改？`graphData's``graphData's`

由于我的数据库中动态生成的行，graphData 的高度会发生变化。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-08T10:22:14.820

CSS 或 jQuery 没有内置方法来检测这种性质的变化。您可能会想到做的是每隔一段时间检查元素的高度并将它们与最后一个已知值进行比较。如果存在差异，则意味着高度发生了变化。

```
var oldHeight = $("#graph").height();

var heightChangeTimer = setInterval(function(){
  var newHeight = $("#graph").height();
  if (newHeight != oldHeight){
   oldHeight = newHeight;
   // do some actions on height change...
  }
},100); 
```

目前，我已将间隔设置为每 100 毫秒，但您可以调整该值以满足您的需要 - 或许将 IE 稍微小一点。更频繁地运行检查...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T10:24:58.367

在 CSS 中没有真正的事件系统（嗯，jQuery 有一个）。这取决于您的图形元素的变化方式。如果当用户与任何元素交互时它的高度发生变化，您可以使用 jQuery 的点击功能：

```
$("#myElement").click(function() {
  $("#head").addClass("higher"); // change height or something
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-08T10:25:22.490

[jQuery：如何监听 DOM 变化？](https://stackoverflow.com/questions/9488653/jquery-how-to-listen-for-dom-changes)

您可能需要阅读此内容。

基本上，我认为您想要做的是将事件侦听器绑定到图表的 div 上（文档将等待并侦听发生在它身上的任何事件）。它需要侦听的事件是 CSS 中的更改（可能是 DOMSubtreeModified 事件，但我会寻找样式属性修改事件，不确定是否存在）。

当对图表的更改触发时，处理头部 div。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-08T10:29:17.460

你可以使用这个插件[http://benalman.com/projects/jquery-resize-plugin/](http://benalman.com/projects/jquery-resize-plugin/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-08T10:23:49.880

您可以并排设置，也可以设置`min-height: inherit`为内部 div。

# jquery - 在鼠标滚轮滚动时，除非执行特定功能，否则窗口不会移动

> ID：11382352
> 
> 赞同：0
> 
> 时间：2012-07-08T10:18:28.123
> 
> 标签：jquery, scroll

我想实现这一点：

当用户开始滚动鼠标滚轮时，应在窗口静止时执行特定功能。功能完成后窗口开始移动。

像这样的东西：http: [//getcirulis.com/](http://getcirulis.com/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T11:07:33.057

解决了[http://johnpolacek.github.com/superscrollorama/](http://johnpolacek.github.com/superscrollorama/)插件

# javascript - JavaScript/jQuery：在特殊字符和关闭 html 标记后插入空格

> ID：11382354
> 
> 赞同：0
> 
> 时间：2012-07-08T10:18:45.400
> 
> 标签：javascript, regex, replace

我有以下字符串：

```
<h1 class="title">This is some heading?</h1><h2 class="desc">Here is the description for it.</h2> 
```

想让它看起来像：

```
<h1 class="title">This is some heading? </h1> <h2 class="desc">Here is the description for it.</h2> 
```

上面有2个部分：

1.  在每个特殊字符后插入空格。所以在上面的例子中，它可能不是问号，而是！或 & 或 ( 或 ) 或 % 等，我需要在这些特殊字符之后插入空格。
2.  删除所有打开的 html 标记并用空格替换关闭的 html 标记。

**对于 1，我试过这个：**

```
str = str.replace(/\?/g,'? '); 
```

以上是否在 ? 之后插入空格？但它非常僵硬。我不能对所有特殊字符应用相同的规则。那么该怎么做呢？

**对于2，我试过这个：**

```
//To entirely remove all opening html tags    
str = str.replace(/<.*?>/g, '');

//To replace closing tag with space    
str = str.replace(/<\/.*?>/g, ' '); 
```

上面代码的问题是后面的部分运行良好。第一部分，即删除所有打开的 html 标记的代码也会影响关闭的 html 标记，这是不可取的。那么如何修改上面的代码，以便删除诸如`<h1>, <div>,`etc. 之类的开始标签呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T10:30:38.723

匹配 ：

```
\s*(?<ws>[<>])\s* 
```

并替换为

```
$1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T10:35:35.947

对于第一个问题，您可以使用：

```
s.replace(/([?%])/g, '$1 ') //you could put more characters within `[..]` 
```

对于打开标签问题，您可以使用：

```
str.replace(/<[^/].*?>/g, '') 
```

基本上，`[abcdef]`意味着它是任何 a、b、c、d、e、f 的占位符。`%`和类似`?`。将 a`^`放在类中（方括号）意味着它是除后面的字符之外的任何字符的**占位**符`^`。所以`<[^/]`不会接受`</`字符串。

# php - 在 Rails 应用程序中启用 PHP 文件夹？

> ID：11382355
> 
> 赞同：6
> 
> 时间：2012-07-08T10:18:54.407
> 
> 标签：php, ruby-on-rails, ajax, apache, .htaccess

我需要通过一些 JS ajax 调用在 Rails 应用程序中运行一些用 PHP 编写的脚本。我遇到了跨域问题，我的脚本在 localhost/scripts 上处于活动状态，而我的应用在 localhost:3000/myapplication 上处于活动状态。对 localhost 的 Ajax 请求返回一个跨域错误。

我能够实现 jsonp 解决方法，并且工作正常，但理想情况下我希望从 rails 文件夹中访问 php 文件。我读到它可以配置 apache 服务器以在框架内的文件夹上启用 PHP。我在 Linux 上运行 Apache2。

[尝试的解决方案](http://blog.hulihanapplications.com/browse/view/27-running-php-inside-a-rails-app) 我不能 100% 确定在哪里可以找到 .htaccess 文件，所以我只是在目录（public/php-scripts）中创建了一个。不确定这是否有效......

尝试 2：我似乎无法正确配置我的服务器：我安装了所有乘客组件并修改了我的文件：/etc/apache2/sites-available/default

```
LoadModule passenger_module /usr/lib/ruby/gems/1.8/gems/passenger-2.1.3/ext/apache2/mod_passenger.so
PassengerRoot /usr/lib/ruby/gems/1.8/gems/passenger-2.1.3
PassengerRuby /usr/bin/ruby1.8
<VirtualHost *:80>
        ServerName myservername
        DocumentRoot /var/www/myapp/public

        <Directory /var/www/myapp/public>
                Allow from all
                Options -MultiViews
        </Directory>
</VirtualHost>

<VirtualHost *:80>
        ServerAdmin webmaster@localhost

        DocumentRoot /var/www/

        <Directory /var/www/>
          Options FollowSymLinks
          AllowOverride None
        </Directory>

        ScriptAlias /cgi-bin/ /usr/lib/cgi-bin/
        <Directory "/usr/lib/cgi-bin">
                AllowOverride None
                Options +ExecCGI -MultiViews +SymLinksIfOwnerMatch
                Order allow,deny
                Allow from all
        </Directory>

        ErrorLog ${APACHE_LOG_DIR}/error.log

        # Possible values include: debug, info, notice, warn, error, crit,
        # alert, emerg.
        LogLevel warn

        CustomLog ${APACHE_LOG_DIR}/access.log combined

        Alias /doc/ "/usr/share/doc/"
        <Directory "/usr/share/doc/">
        Options Indexes MultiViews FollowSymLinks
         AllowOverride None
        Order deny,allow
        Deny from all
        Allow from 127.0.0.0/255.0.0.0 ::1/128
        </Directory>

</VirtualHost> 
```

我重新启动了服务器。我错过了什么？我导航到 myservername/ 和 myservername/myapp 并收到一条禁止消息

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-08T10:43:56.593

您是否尝试过使用 apache 的[乘客。](http://www.modrails.com/)

这应该可以帮助你。

[http://www.abletech.co.nz/blog/serving-php-from-a-rails-app-with-passenger](http://www.abletech.co.nz/blog/serving-php-from-a-rails-app-with-passenger)

关键是禁用特定路线的乘客。

这对我有用

将此行放在 /etc/apache2/sites-available/default 或 /etc/apache2/httpd.conf 文件中（我不是服务器配置专家，所以决定一个，我在 httpd.conf 中有这个）

```
LoadModule passenger_module /usr/lib/ruby/gems/1.8/gems/passenger-2.1.3/ext/apache2/mod_passenger.so
PassengerRoot /usr/lib/ruby/gems/1.8/gems/passenger-2.1.3
PassengerRuby /usr/bin/ruby1.8

<VirtualHost *:80>
        ServerName myservername
        DocumentRoot /var/www/myapp/public

        <Directory /var/www/myapp/public>
                Allow from all
                Options -MultiViews
        </Directory>
  # route for php app im my example /blog
  Alias /blog /var/www/blog  
  <Location /blog>
    PassengerEnabled off  
  </Location>
</VirtualHost> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-23T22:19:33.270

这是我使用 php-fpm 对 nginx 服务器的配置。

您需要添加“passenger_enabled off;” 在 php 位置块中，因此 /public 中的所有 php 文件都可以正常工作。

```
server {
  listen 80;
  server_name www.rails-site.com;
  root /var/www/rails_site/public;
  access_log logs/www.rails-site.com.log combined;

  passenger_enabled on;
  passenger_min_instances 10;
  rails_env production;
  client_max_body_size 150M;

  location ~ \.php$ {
    passenger_enabled off;

    fastcgi_pass   127.0.0.1:9000;
    fastcgi_index  index.php;
    fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;
    include fastcgi_params;
  }
} 
```

# javascript - 从 Flowplayer 输出当前剪辑文件名或 URL

> ID：11382360
> 
> 赞同：0
> 
> 时间：2012-07-08T10:19:40.467
> 
> 标签：javascript, jquery, flowplayer

我正在尝试在 Flowplayer 中获取当前正在播放的视频的文件名或 URL，并将其显示在我的 show div 中。我以为我可以使用`getClip().completeUrl`，但我得到未定义的输出。如果我做一些不是字符串的事情，比如 getClip().fullDuration （一个整数），输出会按预期工作。为什么我变得不确定？

这是我的javascript：

```
function getURL(){
var url = flowplayer().getClip().completeUrl;
$("#show").empty();
$('#show').append(url);
} 
```

这是我的 HTML：

```
<input type="button" id="get" value="Get URL" onclick="getURL()" />
<input type="text" id="show" name="show" /> 
```

这是播放器的javascript：

```
$f("player", "http://releases.flowplayer.org/swf/flowplayer-3.2.11.swf", {
buffering : false,
clip: {
        provider: 'rtmp',
        baseUrl: 'http://example.com',

        streams: [

        { url: 'flv:video123'},

        ]
    },
    plugins: {
        rtmp: {
                url: "flowplayer.rtmp-3.2.10.swf",
                netConnectionUrl: 'rtmp://example.com/vod'
        }
    } 
```

});

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T10:34:41.627

以下是[Flowplayer 文档所说](http://flowplayer.org/documentation/api/clip.html)的`completeUrl`：

> 这是剪辑的 baseUrl 属性和剪辑的 url 属性的串联。如果您没有明确设置 baseUrl，则它是未定义的。

如果您没有设置`baseUrl`，这可能意味着`completeUrl`无法构建。但在这种情况下，它与`url`反正是相同的，所以你可以使用那个。

```
var url = flowplayer().getClip().url; 
```

### 更新

`completeUrl`正如 OP 发现的那样，使用 RTMP 流列表时显然没有。但它在使用没有流列表的 RTMP 时有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T10:33:14.137

尝试使用文本框或标签代替 div 标签。因为通常 div 标签没有 value 属性。然后尝试

`onclick="return getURL();"`而不是 `onclick="getURL()"`. 你试过 var`url = flowplayer().getClip(0).url;`

# c# - 在c#中将鼠标左键单击发送到sopcast静音按钮

> ID：11382361
> 
> 赞同：0
> 
> 时间：2012-07-08T10:19:40.450
> 
> 标签：c#

我正在尝试将鼠标左键单击发送到 c# 中的 sopcast 静音按钮，但没有结果。这是我所做的：

```
 const int BN_CLICKED = 245;  
public static void mute_sopcast() 
{ 

    IntPtr hwnd = FindWindow("#32770", null); 
    IntPtr chwnd1 = FindWindowEx(hwnd, IntPtr.Zero, "AfxOleControl70su", null); 
    IntPtr chwnd2 = FindWindowEx(chwnd1, IntPtr.Zero, "#32770", null); 
    IntPtr chwnd3 = FindWindowEx(chwnd2, IntPtr.Zero, "Button", "Mute"); 

    PostMessage(chwnd3, BN_CLICKED, 0, (int)IntPtr.Zero); 

    //The code bellow I made it to see if chwnd… is zero or not.

    if (chwnd3 == new IntPtr(0)) 
    { 
        MessageBox.Show("IntPtr(0)"); 
    } 
    else if (chwnd3 == IntPtr.Zero) 
    { 
        MessageBox.Show("IntPtr.Zero"); 
    } 
    else 
    { 
        MessageBox.Show("IntPtr.Zero not empty"); 
    } 

} 
```

Winspector Spy 给了我这个：

```
000E036E: #32770
    …
    00070406：AfxOleControl70su
        002C06A2：#32770
            …
            000F03A4：“静音”按钮

```

有人能告诉我哪里错了吗？非常感谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T11:54:54.743

你有没有尝试过：

```
SendMessage(chwnd4, WM_LBUTTONDOWN, IntPtr.Zero, IntPtr.Zero);
SendMessage(chwnd4, WM_LBUTTONUP, IntPtr.Zero, IntPtr.Zero); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T12:04:12.810

[BN_CLICKED](http://msdn.microsoft.com/en-us/library/windows/desktop/bb761825%28v=vs.85%29.aspx)不是窗口消息 - 它是作为`WPARAM`WM_COMMAND 消息的一部分发送的通知代码。WM_COMMAND 消息也需要外部不可用的控件 ID。WM_COMMAND 消息也被发送到控件的父窗口，而不是控件本身。

发送这个的正确方法是：

```
const int WM_COMMAND = 0x111;
const int BN_CLICKED = 245; 

int controlID = ??; // Something you don't know
int wParam = BN_CLICKED >> 16 | controlID;

PostMessage(chwnd3, WM_COMMAND, wParam , (int)chwnd4); 
```

当然，这假设代码正在使用 WM_COMMAND 消息，而不是直接侦听按钮向上/向下消息。

更好的选择是将焦点设置为按钮，然后发送空格键以使用[SendKeys](http://msdn.microsoft.com/en-us/library/system.windows.forms.sendkeys.aspx)执行按钮单击。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-21T21:50:25.553

使用系统；

```
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.Runtime.InteropServices;

namespace automouse
{
    public partial class Form1 : Form
    {
        public const int WM_LBUTTONDOWN = 0x0201;
        public const int WM_LBUTTONUP = 0x0202;

        [DllImport("user32.dll", CharSet = CharSet.Auto)]
        private static extern int SendMessage(IntPtr hWnd, int wMsg, IntPtr wParam, IntPtr lParam);

        public Form1()
        {
            InitializeComponent();
        }

        private void button1_Click(object sender, EventArgs e)
        {
            SendMessage(button2.Handle, WM_LBUTTONDOWN, IntPtr.Zero, IntPtr.Zero);
            SendMessage(button2.Handle, WM_LBUTTONUP, IntPtr.Zero, IntPtr.Zero);
        }

        private void button2_Click(object sender, EventArgs e)
        {
            MessageBox.Show("Button2 clicked!");
        }
    }
} 
```

# cocoa - 识别应用程序是否没有响应

> ID：11382367
> 
> 赞同：4
> 
> 时间：2012-07-08T10:21:22.097
> 
> 标签：cocoa

在我的应用程序中，我可以通过在 NSWorkspace 的共享实例上调用 runningApplications 方法来检索正在运行的应用程序。

现在我想确定应用程序是否“没有响应”，就像应用程序无响应时它在“强制退出”窗口中的显示方式一样。

有什么方法可以识别吗？

# dom - 如何在 svg 中嵌入 HTML div

> ID：11382369
> 
> 赞同：6
> 
> 时间：2012-07-08T10:21:41.803
> 
> 标签：dom, svg

例子：

```
<div> Hello World </div>

<svg>
<div> From SVG Land</div>
</svg> 
```

问题：

尽管有标签，SVG 对象是单独解析的，而不是 dom 树的某个适当部分吗？如何在 SVG 元素中获取 DIV？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2017-11-15T05:41:30.297

正如@Stasik 所提到的，可以使用foreignObject。

*例子：*

```
<svg>
    <foreignObject width="100" height="50"
               requiredExtensions="http://www.w3.org/1999/xhtml">
      <!-- XHTML content goes here -->
      <body xmlns="http://www.w3.org/1999/xhtml">
        <p>Here is a paragraph that requires word wrap</p>
      </body>
    </foreignObject>
<svg> 
```

*摘自：* [https ://developer.mozilla.org/en-US/docs/Web/SVG/Element/foreignObject](https://developer.mozilla.org/en-US/docs/Web/SVG/Element/foreignObject)

# c# - Rest API 和 UserSign - 正确的端点

> ID：11382371
> 
> 赞同：1
> 
> 时间：2012-07-08T10:21:59.180
> 
> 标签：c#, wcf, api, rest

我打算制作一个 WCF rest api，但我对某些事情感到困惑。

我知道休息 api 如何用于获取或注册用户......

获取用户

```
GET
/user/username 
```

注册用户

```
POST
/user
[POST DETAILS] 
```

我没有得到的是用户登录。逻辑上它应该在“用户”端点上，但它并不真正适用于 CRUD 模型。

它应该只是在它自己的 /login 端点上吗？如果是这样，它应该是 GET 还是 POST？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-08T10:27:00.440

它应该在`/login`端点上：

```
POST /login
[CREDENTIALS] 
```

# python - 卡尔曼滤波器 python OpenCV 2.4.0 中的断言错误

> ID：11382373
> 
> 赞同：4
> 
> 时间：2012-07-08T10:22:15.940
> 
> 标签：python, opencv, assertion, kalman-filter

当我试图预测卡尔曼时，

```
k = cv2.KalmanFilter(2,1,0)
c = np.array([(0.0),(0.0)]).reshape(2,1)
a = k.predict(c) 
```

我得到以下断言错误。

> 错误：/home/jay/Downloads/OpenCV-2.4.0/modules/core/src/matmul.cpp:711：错误：(-215) type == B.type() && (type == CV_32FC1 || type == CV_64FC1 || 类型 == CV_32FC2 || 类型 == CV_64FC2) 在函数 gemm

所以，我添加了以下代码行`OpenCV-2.4.0/modules/core/src/matmul.cpp`

```
printf("%d %d\n",type,B.type()); 
```

所以，现在它给了我输出，

> 5 5
> 
> 0 6

我在这里做错了吗？有什么问题 ？

# java - Java：不能重绘（）？

> ID：11382376
> 
> 赞同：3
> 
> 时间：2012-07-08T10:23:07.310
> 
> 标签：java, swing, jpanel, repaint, paintcomponent

我正在编写一些代码来创建文本的彩色可视化。以下管理可视化面板，并且从程序的其他地方（正确）调用了 setCT(String c) 方法。

不幸的是，所需的可视化仅在调整窗口大小时发生。在那之前，可见面板只是保持黑色！到底是怎么回事？我已经尝试使用 validate() 方法并根据其他地方的指南创建一个新的 Runnable() ，但无济于事。这是我的代码：

```
import java.awt.Color;
import java.awt.Dimension;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.geom.Rectangle2D;
import java.awt.image.BufferedImage;

import javax.swing.JPanel;
import javax.swing.SwingUtilities;
import javax.swing.Timer;

public class Visualiser extends JPanel implements ActionListener {

    /**
     * 
     */
    private static final long serialVersionUID = -3936526023655045114L;
    public static final Color DEFAULT_BG_COL = Color.black;
    private static Color bgCol;
    private static String ct;
    private static BufferedImage stat;
    private static boolean doVis=false;
    private Timer refreshTimer=new Timer(100, this);

    public Visualiser() {
        this(200, 250);
    }

    public Visualiser(int w, int h) {

        super.setSize(new Dimension(w, h));
        super.setPreferredSize(new Dimension(w, h));
        bgCol = Visualiser.DEFAULT_BG_COL;      
        super.setBackground(bgCol);
        stat = new BufferedImage(w, h, BufferedImage.TYPE_INT_ARGB);
        refreshTimer.start();

    }

    /*public void paint(Graphics g) {
     * REPLACED BY paintComponent() METHOD AS PER SUGGESTION
        super.paint(g);
        if (Visualiser.doVis==true) {
            System.out.println("passed doVis test");
            doVis(g);
        }

    }*/

    public void paintComponent(Graphics g) {
        if(Visualiser.doVis) {
            doVis(g);
        }
    }

    public Color getBGCol() {
        return bgCol;
    }

    public void setBGCol(Color b) {
        bgCol = b;
        super.setBackground(bgCol);
    }

    public void doVis(Graphics g) {
        // all of my code to actually paint the visualisation is here
        //doStatic(g);
        // establish the block size and height using length of the string
        int numBlocks = 3*ct.length();
        if (numBlocks != 0) {
            int blockSize = (int) Math.sqrt((this.getWidth()*this.getHeight())/numBlocks) ;
            Graphics2D g2 = stat.createGraphics();
            int blocksX=Math.round(this.getWidth()/blockSize);
            int blocksY=Math.round(this.getHeight()/blockSize);
            char chars[]=ct.toCharArray();
            int c=0;
            int cc=0;
            for(int i = 1; i< blocksX; i++) {
                for(int j=1; j<blocksY; j++) {
                    cc=c+4;
                    if(cc < chars.length) {
                        //System.out.println("char length is: " + chars.length + " and c is: " + c);
                        g2.setColor(new Color((int) chars[c]%255, (int) chars[c+1]%255, (int)chars[c+2]%255));
                        //System.out.println("color: " + g2.getColor().toString());
                    }
                    g2.fill(new Rectangle2D.Double(i*blockSize, j*blockSize, blockSize, blockSize));
                    c++;
                }
            }

            g.drawImage(stat, 0, 0, this);
        }

    }

    private void doStatic(Graphics g) {
        Graphics2D g2 = stat.createGraphics();
        int x=this.getWidth();
        int y=this.getHeight();
        //System.out.println("x, y: " + x + " " + y);
        for (int i=1; i<x; i++) {
            for(int j=1; j<y; j++) {
                g2.setColor(new Color(getRandom(0, 255), getRandom(0,255), getRandom(0,255)));
                g2.fill(new Rectangle2D.Double(i, j, 1, 1));
            }
        }
        g.drawImage(stat,  0, 0, this);

    }

    private int getRandom(int min, int max) {
        int random = min + (int) (Math.random() * (max - min));

        return random;

    }

    public void setCT(String c) {
        Visualiser.doVis=true;
        ct=c;
        SwingUtilities.invokeLater(new Runnable() {
            public void run() {
                System.out.println("got to the new runnable thingie");

                repaint();
            }
        });

    }

    public void actionPerformed(ActionEvent e) {
        if(e.getSource().equals(this.refreshTimer)) {
            // the timer is the source so do some refreshing!

            repaint();
        }

    }

} 
```

doVis 和 ct 变量都是这个（Visualiser）类的公共静态布尔值和字符串，并且paint方法在决定绘制什么之前检查doVis值。这部分没问题。它迫使 Java 进行适当的重绘，这就是问题所在！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T10:45:26.953

当您扩展 a`JPanel`时，实现您想要的快速、简单和干净的方法是覆盖`JPanel.paintComponent()`您进行渲染的方法。

如果您想自动刷新您的 GUI，那么我建议您使用不时调用的摇摆计时器`JPanel.validate()`。您的面板可能如下所示：

```
public class TextRendererPanel extends JPanel{
   protected void paintComponent(Graphics g){
       // Do your rendering stuff here.
   }
} 
```

创建后，面板可以像这样刷新：

```
TextRendererPanel textRendererPanel = new TextRendererPanel();
textRendererPanel.invalidate(); 
```

这里有一个关于摇摆计时器的[教程，你可以从它开始。](http://docs.oracle.com/javase/tutorial/uiswing/misc/timer.html)

# jasper-reports - JasperReports Server Pro 4.5 / JasperReports 4.5 将角色分配给报告的特定部分

> ID：11382378
> 
> 赞同：0
> 
> 时间：2012-07-08T10:23:23.067
> 
> 标签：jasper-reports, jasperserver

我有一份不同类别/部门的报告，比如说（销售、会计、IT）和 4 个用户：

*   用户 1 -（管理员）查看所有部门。
*   用户 2 - 销售和会计。
*   用户 3 - 仅会计。
*   用户 4 - 仅限销售。

权限将已存储在数据库中。

我想要这样的东西：

```
SELECT depname FROM dept 
WHERE permission=(retriev_from_jasperserver_pro_users_role) 
```

可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T20:46:53.240

您可以使用这些内置参数：

```
WHERE my_column in $P{LoggedInUserRoles}
AND another_column = $P{LoggedInUsername} 
```

# jquery - 如何将自定义 HTML 添加到 jQuery 自动完成项？

> ID：11382385
> 
> 赞同：2
> 
> 时间：2012-07-08T10:24:38.960
> 
> 标签：jquery, jquery-ui, autocomplete

是否可以将一些 html 添加到 jquery 自动完成 ui 项？例如，我想将`<strong></strong>`标签添加到自动完成结果 item `label: item['name']`。我试过这样做`label: '<strong>'+item['name']+'</strong>`，但它是作为文本应用的，而不是 HTML。

```
$('input[name="customer"]').catcomplete({
    delay: 0,
    source: function(request, response) {
        $.ajax({
            url: 'index.php?route=sale/customer/autocompletefilter_name=' +  encodeURIComponent(request.term),
            dataType: 'json',
            success: function(json) {   
                response($.map(json, function(item) {
                    return {
                        category: item['customer_group'],
                        label: item['name'],
                        customer : item['name'],
                        value: item['customer_id'],
                        customer_group_id: item['customer_group_id'],
                        firstname: item['firstname'],
                        lastname: item['lastname'],
                        email: item['email'],
                        telephone: item['telephone'],
                        fax: item['fax'],
                        address: item['address']
                    }
                }));
            }
        });
    }, 
    select: function(event, ui) {
        //some actions on select
    }
}); 
```

谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-08T10:29:49.577

查看 Scott Gonzales 的自动完成 HTML 扩展 - [https://github.com/scottgonzalez/jquery-ui-extensions/blob/master/src/autocomplete/jquery.ui.autocomplete.html.js](https://github.com/scottgonzalez/jquery-ui-extensions/blob/master/src/autocomplete/jquery.ui.autocomplete.html.js)。它将允许您为标签选项传递 HTML。

**示例**- [http://jsfiddle.net/eay3d/1/](http://jsfiddle.net/eay3d/1/)

```
$(function() {
    var availableTags = [
        { label: 'Apple1', value:'Apple1' },
        { label: '<strong>Apple2</strong>', value:'Apple2' },
        { label: 'Apple3', value:'Apple3' }             
    ];
    $( "#tags" ).autocomplete({
        source: availableTags,
        html: 'html'
    });
}); 
```

* * *

**编辑 09/22/2013**：源链接已修复，但*不再维护*。

# c# - 通过 IUserType 映射集合

> ID：11382386
> 
> 赞同：0
> 
> 时间：2012-07-08T10:24:46.390
> 
> 标签：c#, nhibernate, fluent-nhibernate, usertype, iusertype

我需要用一些逻辑加载一个类（调整），所以我在 Nhibernate 中实现了 IUserType。当它是一个单一的参考，它工作正常：

```
 Map(p => p.DefaultAdjustment)
        .CustomType(typeof(AdjustmentCustomMap)); 
```

它的 SqlType 是字符串。
但是，我也有一个来自 Adjustment 的集合，我不知道如何映射它！

```
 HasMany(p => p.Adjustments)
            .Cascade.AllDeleteOrphan()
            .Inverse())
            ; 
```

**如何让我的 IUserType 实现来加载集合？**
我正在使用 NH 3.3
提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T10:55:57.140

尝试`.Element()`与您的`HasMany`映射一起使用。由于您不是映射实体集合，而是*简单*对象的集合，因此您需要使用与映射`string`, `int`, `Guid`...的集合相同的映射。

```
HasMany(p => p.Adjustments)
    .Element("Adjustment", e => e.Type<AdjustmentCustomMap>())
    .Cascade.AllDeleteOrphan()
    .Inverse())
    ; 
```

方法的第一个参数`Element`是列名。

# ruby-on-rails - 如何使用自定义 ID 制作可点击的 gmaps-for-rails 地图？

> ID：11382387
> 
> 赞同：0
> 
> 时间：2012-07-08T10:24:54.653
> 
> 标签：ruby-on-rails, gmaps4rails

我在 Rails 3.2 应用程序中使用 Google_maps_for_Rails。我正在尝试实现一个可点击的地图来更新纬度/经度字段。我在应用程序的其他部分运行它，但无法让它在某些条件下运行。如果地图具有非默认 ID，则可点击功能不起作用。

尝试在页面上显示两个地图时遇到了这个问题。两个地图都有一个自定义 ID（即不是 gem 定义的默认 ID）。其中一张地图应该可以单击以设置纬度/经度字段，但这似乎不适用于自定义 ID。

如果我暂时将可点击地图恢复为默认 ID，则这些功能将按预期工作。但就我而言，这不是一个长期的解决方案。

我正在使用[gem 的 wiki](https://github.com/apneadiving/Google-Maps-for-Rails/wiki/Javascript-goodies)中建议的 javascript 。我看不到任何明显定义该函数应应用于的地图 ID 的内容。

如何定义地图 ID，以便该功能适用​​于指定的地图？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T19:00:38.387

从您提供的链接：

> 所有 javascript 地图对象都存储在 Gmaps 对象中。
> 
> 要访问这些，只需键入：Gmaps.the_map_id
> 
> 默认情况下，它是 Gmaps.map

# javascript - 单击链接时如何使表单呈现？

> ID：11382391
> 
> 赞同：1
> 
> 时间：2012-07-08T10:25:36.403
> 
> 标签：javascript, jquery, html, css

我是 javascript 的新手，我想在用户单击按钮时呈现表单，我尝试了不同的方法，但没有成功。这是代码：

```
 <a href="" id="reply">Reply</a>
 <form action="" method="post" >
     <textarea name="comment" class="comment_textarea"></textarea>
     <input type="hidden" name="id" value="5"> 
     <input type="submit" class="btn"  value="Reply">
 </form> 
```

我在线程评论中使用它。我只想在用户单击回复按钮时呈现此表单，否则不应显示此表单。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-08T10:28:03.810

您可以使用 css 隐藏表单：

```
 <a hred="" id="reply">Reply</a>
 <form action="" method="post" id="reply-form" style="display:none">
     <textarea name="comment" class="comment_textarea"></textarea>
     <input type="hidden" name="id" value="5"> 
     <input type="submit" class="btn"  value="Reply">
 </form> 
```

然后在用户单击回复按钮时显示它：

```
$('#reply').click(function() { $('#reply-form').toggle(); }); 
```

**更新**现在，当我看到您的 HTML 时：

首先，永远不要将一个 id 用于多个元素，而是使用 class：

```
<a hred="" class="reply">Reply</a> 
```

现在您可以使用`next()`来切换表单：

```
//  for each element with class reply, find next form element and toggle visibility
$('.reply').click(function() { $(this).next('form').toggle(); });​​​​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T10:39:49.280

正如@des 所说，您可以`a#reply`用作触发器。在 jquery 中它只需要几行代码：

```
 $('.reply').click(function() { 

  $(this).parent().find('.reply-form').toggle(); 

 });​ 
```

[例子](http://jsfiddle.net/hLHJ3/3/)

# java - 如何在背景渲染时让 AlertDialog 工作，而不会使应用程序崩溃？

> ID：11382394
> 
> 赞同：0
> 
> 时间：2012-07-08T10:26:20.290
> 
> 标签：java, android, android-alertdialog, looper

这是来源：

```
package ff.ff;

import android.app.Activity;
import android.app.AlertDialog;
import android.content.Context;
import android.content.DialogInterface;
import android.graphics.Canvas;
import android.os.Bundle;
import android.os.Looper;
import android.util.Log;
import android.view.SurfaceHolder;
import android.view.SurfaceView;
import android.view.Surface.OutOfResourcesException;

public class Basic extends Activity {
    private Render view;

    public class Render extends SurfaceView implements Runnable {

        //TODO: Test if AlertDialog can be able to work while another
        //thread is running continuously.
        //
        // Failed miserably.

        //ERROR Received:
        /*
         * 07-08 17:34:51.035: E/AndroidRuntime(7356): FATAL EXCEPTION: Thread-12
         * 07-08 17:34:51.035: E/AndroidRuntime(7356): java.lang.RuntimeException: Main thread not allowed to quit
         * 07-08 17:34:51.035: E/AndroidRuntime(7356):  at android.os.MessageQueue.enqueueMessage(MessageQueue.java:191)
         * 07-08 17:34:51.035: E/AndroidRuntime(7356):  at android.os.Looper.quit(Looper.java:231)
         * 07-08 17:34:51.035: E/AndroidRuntime(7356):  at ff.ff.Basic$Render$1$1.run(Basic.java:45)
         * 07-08 17:34:51.035: E/AndroidRuntime(7356):  at java.lang.Thread.run(Thread.java:1027) 
         * 
         */

        private int r, g, b;

        private boolean running;
        private SurfaceHolder holder;
        private AlertDialog.Builder builder;
        private AlertDialog dialog;

        public Render(Context context) {
            super(context);
            holder = this.getHolder();
            r = g = b = 0;
            builder = new AlertDialog.Builder(context);
            builder.setTitle("Enter");
            builder.setPositiveButton("OK", new DialogInterface.OnClickListener() {
                @Override
                public void onClick(DialogInterface dialog, int which) {
                    Log.d("Render Dialog", "Working...");
                    Log.d("Render Dialog", "Exiting the Looper loop...");
                    new Thread(new Runnable(){
                        public void run(){
                            Looper.getMainLooper().quit();
                        }
                    }).start();
                }
            });
            dialog = builder.create();
        }

        public void setLoopFlag(boolean value) {
            running = value;
        }

        public void run() {
            boolean flag = false;
            while(running) {
                if (holder.getSurface().isValid()) {
                    Canvas c = null;
                    try {
                        c = holder.getSurface().lockCanvas(null);
                    }
                    catch(IllegalArgumentException e) {
                        e.printStackTrace();
                    }
                    catch(OutOfResourcesException e) {
                        e.printStackTrace();
                    }
                    c.drawARGB(255, r, g, b);
                    r++;
                    g++;
                    b++;
                    if (r > 250 || g > 250 || b > 250) {
                        r = 0;
                        g = 0;
                        b = 0;
                    }
                    if (!flag){
                        flag = true;
                        Looper.prepare();
                        dialog.show();
                        Looper.loop();
                    }
                    holder.getSurface().unlockCanvasAndPost(c);
                }
            }
        }
    }

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        view = new Render(this);
        view.setLoopFlag(true);
        setContentView(view);
        Thread thread = new Thread(view);
        thread.setName("Render Thread");
        thread.start();
    }
} 
```

你知道当一个游戏结束时，游戏会要求玩家输入一个名字，这样记分板上就会有一个名字和一个分数吗？通常，就是这样。我有一个将所有 3 个对象都渲染到屏幕上的游戏。当满足某个条件时，游戏会出现一个对话框，询问玩家的名字并祝贺玩家完成它。

正是这个为玩家名字弹出对话框的简单任务引起了很多头痛。上面给出了提供的源代码。

当线程处于紧密循环中时（例如游戏循环），当程序想要向用户显示对话框时，通常推荐的执行方式是什么？为什么 Looper.prepare() 在这种情况下有用？

我无法理解这一点。:(

* * *

**编辑（更多信息）：**

我尝试使用 AsyncTask，它真的让我更加困惑。并不是说我不想使用 AsyncTask，而是一个简单的“在背景更改颜色时显示对话框”工作如何变得越来越难以修复？

日志猫：

```
07-08 20:20:02.445: E/AndroidRuntime(11085): FATAL EXCEPTION: AsyncTask #1
07-08 20:20:02.445: E/AndroidRuntime(11085): java.lang.RuntimeException: An error occured while executing doInBackground()
07-08 20:20:02.445: E/AndroidRuntime(11085):    at android.os.AsyncTask$3.done(AsyncTask.java:200)
07-08 20:20:02.445: E/AndroidRuntime(11085):    at java.util.concurrent.FutureTask$Sync.innerSetException(FutureTask.java:274)
07-08 20:20:02.445: E/AndroidRuntime(11085):    at java.util.concurrent.FutureTask.setException(FutureTask.java:125)
07-08 20:20:02.445: E/AndroidRuntime(11085):    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:308)
07-08 20:20:02.445: E/AndroidRuntime(11085):    at java.util.concurrent.FutureTask.run(FutureTask.java:138)
07-08 20:20:02.445: E/AndroidRuntime(11085):    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1088)
07-08 20:20:02.445: E/AndroidRuntime(11085):    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:581)
07-08 20:20:02.445: E/AndroidRuntime(11085):    at java.lang.Thread.run(Thread.java:1027)
07-08 20:20:02.445: E/AndroidRuntime(11085): Caused by: java.lang.RuntimeException: Can't create handler inside thread that has not called Looper.prepare()
07-08 20:20:02.445: E/AndroidRuntime(11085):    at android.os.Handler.<init>(Handler.java:121)
07-08 20:20:02.445: E/AndroidRuntime(11085):    at android.app.Dialog.<init>(Dialog.java:122)
07-08 20:20:02.445: E/AndroidRuntime(11085):    at android.app.AlertDialog.<init>(AlertDialog.java:63)
07-08 20:20:02.445: E/AndroidRuntime(11085):    at android.app.AlertDialog.<init>(AlertDialog.java:59)
07-08 20:20:02.445: E/AndroidRuntime(11085):    at android.app.AlertDialog$Builder.create(AlertDialog.java:786)
07-08 20:20:02.445: E/AndroidRuntime(11085):    at ff.ff.Basic$DialogTask.doInBackground(Basic.java:112)
07-08 20:20:02.445: E/AndroidRuntime(11085):    at ff.ff.Basic$DialogTask.doInBackground(Basic.java:1)
07-08 20:20:02.445: E/AndroidRuntime(11085):    at android.os.AsyncTask$2.call(AsyncTask.java:185)
07-08 20:20:02.445: E/AndroidRuntime(11085):    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:306)
07-08 20:20:02.445: E/AndroidRuntime(11085):    ... 4 more
07-08 20:20:03.276: E/msm8660.gralloc(11085): [unregister] handle 0x341330 still locked (state=c0000001) 
```

来源：

```
package ff.ff;

import android.app.Activity;
import android.app.AlertDialog;
import android.app.AlertDialog.Builder;
import android.content.Context;
import android.content.DialogInterface;
import android.graphics.Canvas;
import android.os.AsyncTask;
import android.os.Bundle;
import android.os.Handler;
import android.util.Log;
import android.view.Surface.OutOfResourcesException;
import android.view.SurfaceHolder;
import android.view.SurfaceView;

public class Basic extends Activity {
    private Render view;

    public class Render extends SurfaceView implements Runnable {

        //TODO: Test if AlertDialog can be able to work while another
        //thread is running continuously.
        //
        // Failed miserably.

        //ERROR Received:
        /*
         * 07-08 17:34:51.035: E/AndroidRuntime(7356): FATAL EXCEPTION: Thread-12
         * 07-08 17:34:51.035: E/AndroidRuntime(7356): java.lang.RuntimeException: Main thread not allowed to quit
         * 07-08 17:34:51.035: E/AndroidRuntime(7356):  at android.os.MessageQueue.enqueueMessage(MessageQueue.java:191)
         * 07-08 17:34:51.035: E/AndroidRuntime(7356):  at android.os.Looper.quit(Looper.java:231)
         * 07-08 17:34:51.035: E/AndroidRuntime(7356):  at ff.ff.Basic$Render$1$1.run(Basic.java:45)
         * 07-08 17:34:51.035: E/AndroidRuntime(7356):  at java.lang.Thread.run(Thread.java:1027) 
         * 
         */

        private int r, g, b;

        private boolean running;
        private SurfaceHolder holder;
        private DialogTask task;

        public Render(Context context) {
            super(context);
            holder = this.getHolder();
            task = new DialogTask(context);
            r = g = b = 0;
        }

        public void setLoopFlag(boolean value) {
            running = value;
        }

        public void run() {
            boolean flag = false;
            while(running) {
                if (holder.getSurface().isValid()) {
                    Canvas c = null;
                    try {
                        c = holder.getSurface().lockCanvas(null);
                    }
                    catch(IllegalArgumentException e) {
                        e.printStackTrace();
                    }
                    catch(OutOfResourcesException e) {
                        e.printStackTrace();
                    }
                    c.drawARGB(255, r, g, b);
                    r++;
                    g++;
                    b++;
                    if (r > 250 || g > 250 || b > 250) {
                        r = 0;
                        g = 0;
                        b = 0;
                    }
                    if (!flag){
                        flag = true;
                        Void[] v = new Void[1];
                        v[0] = null;
                        task.execute(v);
                    }
                    holder.getSurface().unlockCanvasAndPost(c);
                }
            }
        }
    }

    public class DialogTask extends AsyncTask<Void, Void, Void>{

        private Context context;
        private boolean exit;

        public DialogTask(Context c){
            context = c;
            exit = false;
        }

        @Override
        protected Void doInBackground(Void... params) {
            AlertDialog.Builder builder = new AlertDialog.Builder(context);
            builder.setPositiveButton("OK", new DialogInterface.OnClickListener() {
                @Override
                public void onClick(DialogInterface dialog, int which) {
                    exit = true;
                }
            });
            builder.setTitle("Enter...");
            AlertDialog dialog = builder.create();
            dialog.show();
            return null;
        }

    }

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        view = new Render(this);
        view.setLoopFlag(true);
        setContentView(view);
        Thread thread = new Thread(view);
        thread.setName("Render Thread");
        thread.start();
    }
} 
```

* * *

编辑#2（runOnUIThread() 和 onTouchEvent(MotionEvent e) 锁定，源代码如下：

```
public class Basic extends Activity {
    Render view;
    public class Render extends SurfaceView implements Runnable {
        private Activity activity;
        private SurfaceHolder holder;
        private boolean running;
        public Render(Activity a){
            super(a);
            activity = a;
            holder = this.getHolder();
            running = true;
        }

        public void run(){
            int r = 0;
            while (running){
                if (holder.getSurface().isValid()){
                    Canvas canvas = holder.lockCanvas();
                    canvas.drawARGB(255, r, 255, 255);
                    r++;
                    if (r > 255)
                        r = 0;
                    holder.unlockCanvasAndPost(canvas);
                }
            }   
        }

        public void start(){
            new Thread(this).start();
        }

        public boolean onTouchEvent(MotionEvent event){
            activity.runOnUiThread(new Runnable(){
                public void run(){
                    AlertDialog.Builder builder = new AlertDialog.Builder(activity);
                    builder.setPositiveButton("OK", new DialogInterface.OnClickListener() {

                        @Override
                        public void onClick(DialogInterface dialog, int which) {
                            Log.d("Activity", "It worked also......");  
                        }
                    });
                    AlertDialog dialog = builder.create();
                    dialog.show();
                }
            });
            return false;
        }

        public void stop(){
            running = false;
            boolean r = true;
            while(r){
                try {
                    Thread.currentThread().join();
                    r = false;
                }
                catch(InterruptedException e) {
                    r = true;
                }
            }
        }
    }

    public void onCreate(Bundle b){
        super.onCreate(b);
        view = new Render(this);
        this.setContentView(view);
    }

    public void onPause(){
        super.onPause();
        view.stop();
    }

    public void onResume(){
        super.onResume();
        view.start();
    }
} 
```

* * *

**编辑＃3（我认为这是当天的最后一次编辑）**

这是迄今为止我得到的“解决方法”。所有功劳都归功于 Nate 的帮助。

```
package ff.ff;

import android.app.Activity;
import android.app.AlertDialog;
import android.content.Context;
import android.content.DialogInterface;
import android.graphics.Canvas;
import android.os.Bundle;
import android.util.Log;
import android.view.MotionEvent;
import android.view.SurfaceHolder;
import android.view.SurfaceView;

public class Basic extends Activity {
    private AlertDialog dialog;
    private AlertDialog.Builder builder;
    private BackgroundColors view;

    public class BackgroundColors extends SurfaceView implements Runnable {
        private Thread thread;
        private boolean running;
        private SurfaceHolder holder;

        public BackgroundColors(Context context) {
            super(context);
        }

        public void run() {
            int r = 0;
            while (running){
                if (holder.getSurface().isValid()){
                    Canvas canvas = holder.lockCanvas();
                    if (r > 250)
                        r = 0;
                    r += 10;
                    canvas.drawARGB(255, r, 255, 255);
                    holder.unlockCanvasAndPost(canvas);
                }
            }
        }

        public void start() {
            running = true;
            thread = new Thread(this);
            holder = this.getHolder();
            thread.start();
        }

        public void stop() {
            running = false;
            boolean retry = true;
            while (retry){
                try {
                    thread.join();
                    retry = false;
                }
                catch(InterruptedException e) {
                    retry = true;
                }
            }
        }

        public boolean onTouchEvent(MotionEvent e){
            dialog.show();
            return false;
        }
    }

    public void onCreate(Bundle b) {
        super.onCreate(b);
        view = new BackgroundColors(this);
        this.setContentView(view);
        builder = new AlertDialog.Builder(this);
        builder.setPositiveButton("OK", new DialogInterface.OnClickListener() {
            @Override
            public void onClick(DialogInterface dialog, int which) {
                Log.d("Basic", "It worked");
            }
        });
        dialog = builder.create();
    }

    public void onPause(){
        super.onPause();
        view.stop();
    }

    public void onResume(){
        super.onResume();
        view.start();
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T11:13:21.487

崩溃的原因是您试图关闭**主**循环器。主（又名 UI）线程总是需要至少有一个 looper。

所以，永远不要打电话

```
getMainLooper().quit(); 
```

可能，你想打电话`Looper.myLooper()`而不是`Looper.getMainLooper()`？但是，我不完全确定您的程序要做什么。

您可能[想阅读这个 Android 线程教程](http://www.aviyehuda.com/blog/2010/12/20/android-multithreading-in-a-ui-environment/)。

[AsyncTask](http://developer.android.com/reference/android/os/AsyncTask.html)也可能会让你更容易使用，尽管我对你的应用程序的功能有点不清楚，也许不是。

此外，至少看起来您的`boolean running`标志不是线程安全的。它被多个线程访问而没有保护。这不会导致您发布的消息的崩溃，我只是指出来。

**编辑：**实际上，现在我看了一下，即使您的`running`变量中存在潜在的不安全性，它看起来也只是在创建后台线程之前设置了一次。所以，如果这是你唯一的用法，它不是不安全的......但是，价值也永远不会改变。所以，它要么没用，要么你在其他地方打电话`setLoopFlag()`，这可能是不安全的（？）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T12:52:34.473

此答案与您尝试使用的问题更新有关`AsyncTask`。您拥有的代码实际上与`AsyncTask`打算使用的方式相反。An`AsyncTask`有多种方法，旨在从不同的线程运行。您实现的方法`doInBackground()`是从后台线程调用的。因此，您不应该在该方法中（直接）更新 UI。

在an**末尾**运行的方法`AsyncTask`是`onPostExecute()`. 它在 UI 线程上运行，并且可以安全地进行 UI 调用，例如显示`Dialog`. 如果您需要在任务运行**期间**`onProgressUpdate()`更新 UI，则可以实现第三种方法。对于 UI 操作也是安全的。如果您的后台处理（在 中`doInBackground()`）需要将信息传递给`onProgressUpdate()`方法，那么它可以通过调用`publishProgress()`方法来实现，在 中传入任何需要的数据`onProgressUpdate()`。这些调用的参数是*通用*的，所以你几乎可以把它们做成任何东西。典型的实现将完成百分比作为整数传递。

有关一个非常简单的示例，[请参阅 AsyncTask 的 API 文档的开头。](http://developer.android.com/reference/android/os/AsyncTask.html)

但是，听起来更简单的东西对你有用。如果您将`Render`类的构造函数更改为采用`Activity`, 而不是 a `Context`：

```
 private Activity parent;

    public Render(Activity activity) {
       super(activity);
       parent = activity; 
```

`runOnUiThread()`那么，就可以在Activity中使用超级好用的方法了：

```
 parent.runOnUiThread(new Runnable() {
       public void run() {
          AlertDialog.Builder builder = new AlertDialog.Builder(parent);
          builder.setPositiveButton("OK", new DialogInterface.OnClickListener() {
             @Override
             public void onClick(DialogInterface dialog, int which) {
                 exit = true;
             }
          });
          builder.setTitle("Enter...");
          AlertDialog dialog = builder.create();
          dialog.show();
       }
    }); 
```

上面的代码块可以安全地放在**任何地方**。你可以把它放在你的`doInBackground()`方法中，或者在后台线程中的`run()`方法中。`Runnable`试试看。

# php - 建立一个 PHP 论坛，如何链接到分页线程中的最后一个帖子永久链接

> ID：11382398
> 
> 赞同：0
> 
> 时间：2012-07-08T10:27:18.010
> 
> 标签：php, mysql, forum

我正在构建一个相对简单的 PHP 论坛，并尝试添加一些来自 phpBB 等主流板的不错的功能。

数据库结构是简单的 3 表方法。类别、主题和帖子。

我正在为每个类别和线程实现“最后一篇文章”功能。我已经有了最后的发布信息，因为它存储在数据库中，这不是问题。我想要解决的是如何在一个有**分页**回复的线程中链接到这篇文章，比如每页 25 个。如果我的帖子是 26 篇文章中的第 26 篇，你将如何编写线程以转到第二页？假设我想永久链接到 90 个中的 30 个，您如何链接到第 2 页并确保两边的回复/页面数量正确？

我一直在试图弄清楚 phpBB 是如何做到的，但我认为你可以花一整年时间把它撕开，却无处可去。我看到他们将 post_id 作为带有 thread_id 的附加参数传递，但我无法弄清楚他们如何使用该信息。有什么想法可以作为起点吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T11:47:13.183

我不知道 phpBB 是如何做到这一点的。但我要做的是通过它自己的 ID 跟踪最后一篇文章。对于每个永久链接请求，我会在内部“渲染”线程（只是准系统，甚至不需要从数据库中获取诸如正文之类的帖子信息）。只需获取线程上的答案数量，然后按照通常的逻辑将其分成页面即可。

由此，我可以很容易地找出最后一篇文章进入哪个页面，而不是试图从我的角度“确保”任何事情（看看系统在做什么，不要试图按照你的意愿弯曲它） - 然后，当然，这是一个相对简单的重定向到该页面，并将 HTML `anchor`id 附加到帖子和 URL 以便浏览器自动滚动到该帖子。

嗯，这不是我的想法。成熟的系统可能会以更优雅的方式解决它，请随时研究并在这里发帖:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T11:49:42.813

你可以试试这个例子，在一个线程的每个页面上呈现 5 个帖子，有 20 个帖子
查询

```
// get the first 5 posts<br/>
SELECT posts FROM topics WHERE topicid = 1 LIMIT 0,5

// get the next five posts<br/>
SELECT posts FROM topics WHERE topicid = 1 LIMIT 5,10 
```

在 php 方面，页面控件（第一个、下一个、上一个、最后一个）是表单按钮，用于提交表单和位置标识符，例如第一页 X、下一页 Y、上一页 Z、最后一页 S .. 使用 GET 方法的 url

[http://example.com/forum/topic.php?id=1&cur=5&next=10&previous=5&last=20](http://example.com/forum/topic.php?id=1&cur=5&next=10&previous=5&last=20)

这种关于跟踪用户的信息在主题中，可以存储在会话中或使用 POST 方法提交

希望它有所帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-08T16:59:56.187

我提出了一个基于@aditya-menon 和@GeoPhoenix 所说的解决方案。我已经知道帖子总数，所以我只是将其除以每页的帖子以获得总页数。最后一篇文章总是在最后一页，所以这很容易。

挑战在于确定帖子位于线程中间的哪个页面。我已经运行了`BETWEEN`这样的查询来计算特定帖子中有多少帖子进入线程

```
SELECT COUNT(post_id) FROM posts 
WHERE topic_id = $TOPIC_ID AND post_id BETWEEN 0 AND $POST_ID 
```

然后将每页的帖子除以这个数字，并`ceil()`给出帖子所在的页码。

不太确定该查询对于大型论坛的效率如何，但它似乎可以完成这项工作。多谢你们

# eclipse - Eclipse 中的 JSF Hello World - 无法运行 :-(

> ID：11382402
> 
> 赞同：2
> 
> 时间：2012-07-08T10:27:41.490
> 
> 标签：eclipse, jsf

您如何能够从帖子标题中阅读我的问题将是相当新奇的。我试图了解如何让 JSF 与 Eclipse 一起工作，并试图让一个漂亮而著名的 Hello world 运行。

作为模板，我使用了 Oracle Java EE 6 Book 中的代码。

我在 de.kuntze 包中创建了这个 ManagedBean - Hello.java

```
package de.kuntze;

import javax.faces.bean.ManagedBean;

@ManagedBean
public class Hello {
    final String world = "Hello World!";

    public String getWorld(){
        return world;
    } 
```

}

再简单不过了......我将它与以下站点一起使用 - beanhello.xhtml：

```
<html xmlns="http://www.w3.org/1999/xhtml"
xmlns:h="http://java.sun.com/jsf/html">
<h:head>
    <title>Facelets Hello World</title>
</h:head>
<h:body>
    #{hello.world}
</h:body>
</html> 
```

也很简单...这里是 web.xml 的代码：

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd" version="3.0">
  <display-name>CopyCat</display-name>
  <servlet>
    <servlet-name>Faces Servlet</servlet-name>
    <servlet-class>javax.faces.webapp.FacesServlet</servlet-class>
    <load-on-startup>1</load-on-startup>
  </servlet>
  <servlet-mapping>
    <servlet-name>Faces Servlet</servlet-name>
    <url-pattern>/faces/*</url-pattern>
  </servlet-mapping>
</web-app> 
```

我让它在我与 Eclipse 集成的 Tomcat 7 服务器上运行，到目前为止，输出对我来说看起来不错 - 如果我可以提供任何日志记录详细信息，请告诉我！

该项目的名称是“CopyCat”，我希望它能够在我的

```
http://localhost:8080/CopyCat/hello 
```

但它给了我一个与 URL 相同的 404 错误

```
http://localhost:8080/CopyCat/ 
```

和

```
http://localhost:8080/hello. 
```

我是不是太愚蠢了，看不到我的代码去了哪里，或者我错过了什么？我知道这个问题非常低级，但我只是不明白，也不想开始使用现有项目进行编码 - 已经向我建议过：-/

问候并提前感谢您的任何答案

安德烈

**更新并以某种方式解决**

1.  总而言之，该问题的解决方案是使用另一个 URL：

    ```
    http://localhost:8080/CopyCat/faces/beanhello 
    ```

2.  将tomcat与eclipse一起使用给了我一些错误（见下文），到目前为止我可以建议两件事（顺便说一句：JSTL.jar不是必需的）：

    a) 通过 coreservlets (http://www.coreservlets.com/JSF-Tutorial/jsf2/#Getting-Started) 使用 Eclipse 工作区作为启动环境。

    b) 将 URL 模式更改为***.jsf**

    并通过 URL 访问代码

    ```
    http://localhost:8080/HelloWorld/beanhello.jsf 
    ```

如果您处于类似情况，希望这会有所帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T10:35:22.727

尝试`http://localhost:8080/CopyCat/faces/beanhello`

因为你的页面名称是`beanhello.xhtml`

你的*servlet-mapping* *url-pattern*是`/faces/*`

关于你的例外

[在动态 Web 应用程序、Eclipse、JSF 中](https://stackoverflow.com/a/11328801/617373)阅读 BalusC Exception java.lang.NoClassDefFoundError 的答案

# php - 合并这两个数据库选择查询

> ID：11382407
> 
> 赞同：0
> 
> 时间：2012-07-08T10:28:25.903
> 
> 标签：php, mysql

我想知道是否有一种方法可以合并这两个数据库查询以便拥有一个：

```
$result = $wpdb->get_row("SELECT meta_value FROM ".$wpdb->prefix.
        "postmeta WHERE meta_key = '_cat_num' AND post_id = $var");

$name = $wpdb->get_row("SELECT name FROM ".AH_FEED_DETAILS_TABLE.
        " WHERE id = " . (int)$result->meta_value);

return $name->name; 
```

第一个查询找到类别值，然后使用该值在 AH_FEED_DETAILS_TABLE 表中查找名称字段

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T10:31:37.053

您可以通过使用带有子查询的 IN 来让数据库为此工作，如下所示：

```
$name = $wpdb->get_row("SELECT name FROM ".AH_FEED_DETAILS_TABLE.
        " WHERE id IN (SELECT meta_value FROM ".$wpdb->prefix.
        "postmeta WHERE meta_key = '_cat_num' AND post_id = $var)"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T10:36:51.280

```
 $result = $wpdb->get_row("SELECT name FROM ".$wpdb->prefix
                    .AH_FEED_DETAILS_TABLE." AS cat_tbl JOIN postmeta ON 
                    cat_tbl.id=postmeta.meta_value 
                    WHERE postmeta.meta_key = '_cat_num' AND postmeta.post_id = $var");

return $result->name; 
```

我希望这有助于提出这个想法

# database - 可以在过滤器中使用非索引字段吗？

> ID：11382410
> 
> 赞同：0
> 
> 时间：2012-07-08T10:28:33.127
> 
> 标签：database, optimization, teradata

在 teradata 源中，我有过滤器来限制不必要的数据读取，因为它包含超过 10 亿条记录，用于优化目的。现在过滤器条件只包含索引字段。我的问题是我可以在过滤器中使用非索引字段吗？如果是，请提供一些证明相同的材料。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T14:29:28.580

如果通过“过滤器”您指的是 WHERE 子句或 ON 条件，那么是的，您可以引用非索引列。为了获得最佳性能，您可能希望在该列上“收集统计信息”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-28T12:11:24.120

是的，你可以，但如果它没有被索引，那么性能会很差。有关在 Teradata 13.10 中收集统计信息的更多信息，请参阅链接[http://developer.teradata.com/blog/carrie/2012/04/teradata-13-10-statistics-collection-recommendations](http://developer.teradata.com/blog/carrie/2012/04/teradata-13-10-statistics-collection-recommendations)

# javascript - 当 Angular 中的模型更改时自动更新深层链接的 url

> ID：11382411
> 
> 赞同：8
> 
> 时间：2012-07-08T10:28:58.557
> 
> 标签：javascript, angularjs, url-routing

所以。我一直在使用 AngularJS（我使用它的每一分钟都让我感到惊讶），我想知道，当使用 $routeProvider 和 $routeParams 时，有没有办法强制当前的 url/location/deep-link当页面上的某些模型发生变化时，浏览器中的位置栏会自动更新吗？

[这是我正在搞乱的应用程序。](http://www.brandonep.org/angular-test-phonecat/) 它是 Angular 网站上教程中的应用程序，除了我已经搞砸了它并添加了一些功能，如分页。如果您注意到，在访问此链接时，您将被重定向到`#/phones//age/5/0`. 第一部分是控制器，而最后 4 个描述过滤器，分别是文本查询、要排序的“列”、每页的项目数和页码。

控制器通过 $routeParams 接收这些并像平常一样更新模型/视图，但是当用户更改模型/视图时，如何强制 url 自动更改？因此，如果您在第一次访问时在页面上的查询框中键入，则位置栏中的 url 将在您键入时立即`xoom`更改为。`http://brandonep.org/angular-test-phonecat/#/phones/xoom/age/5/0`

提前致谢！对不起，如果我不清楚，但我尽力了：P

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-09T01:31:06.543

我会在你的 url ( `/?a=1&b=2`) 上使用参数，然后注入`$routeParams`你的控制器来解释控制器负载的参数。

然后您可以使用`$watch`来观看您的模型，并且每次更改设置`window.location.url`。这是一个例子：http: [//jsfiddle.net/andytjoslin/eYJmR/](http://jsfiddle.net/andytjoslin/eYJmR/)

# ruby-on-rails - rails 3.2 capybara Capybara::ElementNotFound:Unable to find xpath "/html"

> ID：11382415
> 
> 赞同：5
> 
> 时间：2012-07-08T10:29:28.230
> 
> 标签：ruby-on-rails, capybara

我正在尝试使用 rspec 2.10.0 + capybara 1.1.2 测试我的 rails 应用程序。这是我的测试文件

```
require 'spec_helper'

    describe AdminPanelController do
      describe "index" do
        it "should have return code 200" do
          visit '/admin'
          page.should have_content "hello"
          #response.status.should be(200)
        end
      end
    end 
```

这是测试结果

```
 Failure/Error: page.should have_content "hello"
 Capybara::ElementNotFound:
   Unable to find xpath "/html" 
```

我在谷歌上搜索了这个问题，但只找到了 webrat 可能是一个问题的信息，但是我没有安装这个 gem。感谢您的任何建议。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-17T05:19:25.800

测试类型错误。这看起来像一个控制器测试，它使用 get 和 post 等方法进行测试，并且位于 spec/controllers 文件夹中。使用 capybara 的请求规范位于 spec/requests 中。跑去`$ rails generate scaffold SomeModel`看看他们每个人的样子。

如果您了解上述内容但仍想使用 capybara 进行控制器测试，请修改您的描述块：

```
describe AdminPanelController, :type => :request do
  ...
end 
```

# javascript - 我是否必须在第一次填充 sqlite db 时创建所有表？

> ID：11382421
> 
> 赞同：3
> 
> 时间：2012-07-08T10:30:04.907
> 
> 标签：javascript, html, sqlite, cordova

我正在创建一个 Sqlite 数据库，并且我有很多页面要从中访问数据库。

如果我要创建一个新表，是否必须再次执行整个数据库？

如果我有一个像（删除，插入，...）这样的语句。我可以从代码中的任何位置访问数据库并在需要时调用“db.executesql（）”吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T14:04:36.603

[正如http://docs.phonegap.com/en/1.9.0/cordova_storage_storage.md.html#Storage](http://docs.phonegap.com/en/1.9.0/cordova_storage_storage.md.html#Storage)上的 PhoneGap 文档所说，您可以这样做：

```
// Cordova is ready
function onDeviceReady() {
    var db = window.openDatabase("Database", "1.0", "Cordova Demo", 200000);
    db.transaction(populateDB, errorCB, successCB);
}

// Populate the database 
function populateDB(tx) {
     tx.executeSql('DROP TABLE IF EXISTS DEMO');
     tx.executeSql('CREATE TABLE IF NOT EXISTS DEMO (id unique, data)');
     tx.executeSql('INSERT INTO DEMO (id, data) VALUES (1, "First row")');
     tx.executeSql('INSERT INTO DEMO (id, data) VALUES (2, "Second row")');
}

// Transaction error callback
function errorCB(tx, err) {
    alert("Error processing SQL: "+err);
}

// Transaction success callback
function successCB() {
    alert("success!");
} 
```

因此，您需要先打开数据库，然后执行 sql，如示例中所示：

```
var db = window.openDatabase("Database", "1.0", "Cordova Demo", 200000);
db.transaction(populateDB, errorCB, successCB); 
```

为了不同的目的，只需使用不同的 sql 执行代码创建不同的函数，就像`populateDB`上面一样。

# c# - 如何在 ListView 中显示基于两个日期的搜索结果？

> ID：11382423
> 
> 赞同：0
> 
> 时间：2012-07-08T10:30:08.760
> 
> 标签：c#, asp.net, sql, sql-server-2008-r2

我正在尝试使用带有两个文本框的 AjaxToolKit CalendarExtender 控件来开发搜索过滤器。第一个文本框用于（开始日期），第二个文本框用于结束日期，单击（搜索）按钮后，结果应显示在 ListView 中，并在 ListView 的第一列添加一个复选框。

仅供参考，数据库设计如下：

```
Employee Table: Username, Name...
SuggestionsLog: ID, Title, Description, DateSubmitted, StatusID
SuggestionsStatus: ID, Status 
```

（DateSubmitted 是一个日期时间数据类型字段）

StartDate 和 EndDate 将基于数据库中 SuggestionsLog 表中的 DateSubmitted 列。**问题是从 Ajax CalendarExtender 中选择的日期格式为（2012 年 7 月 2 日）。**另外，我写的查询是：

```
SELECT     dbo.SafetySuggestionsLog.Title, dbo.SafetySuggestionsLog.Description, dbo.SafetySuggestionsLog.Username, dbo.SafetySuggestionsLog.DateSubmitted, 
                      dbo.SafetySuggestionsStatus.Status
FROM         dbo.SafetySuggestionsLog INNER JOIN
                      dbo.SafetySuggestionsStatus ON dbo.SafetySuggestionsLog.StatusID = dbo.SafetySuggestionsStatus.ID
WHERE     (dbo.SafetySuggestionsLog.DateSubmitted = @startDate) AND (dbo.SafetySuggestionsLog.DateSubmitted = @finishDate) 
```

我想在 ListView 中显示结果，但是 ListView 上没有显示任何内容，我不知道为什么。**你能帮我解决这个问题吗？**

ASP.NET：

```
<div>
                    <asp:Label ID="Label2" runat="server" Text="From: " />
                    <asp:TextBox ID="txtStartDate" runat="server" />
                    <asp:CalendarExtender ID="CalendarExtender1" runat="server" Enabled="True" 
                        Format="MMMM d, yyyy" TargetControlID="txtStartDate">
                    </asp:CalendarExtender>

                    <asp:Label ID="Label3" runat="server" Text="To: " />
                    <asp:TextBox ID="txtEndDate" runat="server" /> 
                    <asp:CalendarExtender ID="CalendarExtender2" runat="server" Enabled="True" 
                        Format="MMMM d, yyyy" TargetControlID="txtEndDate">
                    </asp:CalendarExtender>
                    <asp:Button ID="searchButton" runat="server" Text="Search" 
                        onclick="searchButton_Click" />

                    <asp:ListView ID="FilteredSuggestions" runat="server"></asp:ListView>
                </div> 
```

代码隐藏：

```
protected void searchButton_Click(object sender, EventArgs e)
    {
        string connString = ConfigurationManager.ConnectionStrings["testConnectionString"].ConnectionString;
        SqlConnection conn = new SqlConnection(connString);
        string cmd = @"SELECT     dbo.SafetySuggestionsLog.Title, dbo.SafetySuggestionsLog.Description, dbo.SafetySuggestionsLog.Username, dbo.SafetySuggestionsLog.DateSubmitted, 
                                 dbo.SafetySuggestionsStatus.Status
                        FROM         dbo.SafetySuggestionsLog INNER JOIN
                                    dbo.SafetySuggestionsStatus ON dbo.SafetySuggestionsLog.StatusID = dbo.SafetySuggestionsStatus.ID
                        WHERE     (dbo.SafetySuggestionsLog.DateSubmitted = @startDate) AND (dbo.SafetySuggestionsLog.DateSubmitted = @finishDate)";

        SqlDataAdapter sda = new SqlDataAdapter(cmd,conn);
        sda.SelectCommand.Parameters.AddWithValue("@startDate", txtStartDate.Text);
        sda.SelectCommand.Parameters.AddWithValue("@finishDate", txtEndDate.Text);
        DataSet ds = new DataSet();
        sda.Fill(ds, "table");

        FilteredSuggestions.DataSource = ds.Tables["table"];
        FilteredSuggestions.DataBind();
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T10:34:36.597

试试这个：

**使用 BETWEEN 指定日期范围**

```
SELECT     dbo.SafetySuggestionsLog.Title, dbo.SafetySuggestionsLog.Description, dbo.SafetySuggestionsLog.Username, dbo.SafetySuggestionsLog.DateSubmitted, 
                      dbo.SafetySuggestionsStatus.Status
FROM         dbo.SafetySuggestionsLog INNER JOIN
                      dbo.SafetySuggestionsStatus ON dbo.SafetySuggestionsLog.StatusID = dbo.SafetySuggestionsStatus.ID
WHERE     (dbo.SafetySuggestionsLog.DateSubmitted Between @startDate AND @finishDate) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T11:08:15.073

BETWEEN 假设一天开始时的午夜：

[日期之间的 T-SQL 混淆](https://stackoverflow.com/questions/5434001/t-sql-between-dates-confusion)

所以它将有效地*排除*@finishDate。如果您使用的是“Between”运算符，请注意这一点。如果这不是您想要的，`'<', '>', '<=', '>='`请在建立时间窗口时使用运算符。

```
WHERE (NOT((finishDate <= @startDate) OR (startDate > @finishDate))) 
```

# c# - 如何在 C# 中清除面板的图形？

> ID：11382429
> 
> 赞同：1
> 
> 时间：2012-07-08T10:31:21.357
> 
> 标签：c#, graphics, panel

我在面板中使用了图形。在程序开始时，我在面板中绘制了一些点，之后我想绘制连接这些点的线。问题是当我按下选项卡按钮时，创建的图形会消失（但这在程序中会发生一次）。下一个问题是我想清除我使用以下代码清除面板的面板：

```
Panel1.Invalidate(); 
```

但这只会清除线条，但不会清除最初创建的那些点。有没有人有一个简单的解决方案，因为我不想重新创建面板。

技术细节：在面板中绘制初始点，`panel1`使用绘制事件：

```
Graphics gfx = e.CreateGraphics() 
```

对于线条，有一个单独的函数，在按钮单击时调用，我使用了：

```
Graphics gfx = Panel1.CreateGraphics(); 
```

另一个用于清除面板的按钮具有以下代码：

```
Panel1.invalidate(); 
```

但它只清除线条图形，而不是那些初始点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-12T07:00:17.950

在 panel1 的绘制事件中创建初始点是我犯了一个错误。所以每次我打电话

```
Panel1.Invalidate(); 
```

它回忆起绘画事件，这些点被重绘而不是清除。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-08T10:34:08.400

您是否将积分保存在某种集合中并在`Paint`活动中绘制它们？

然后你应该清空集合，然后调用`Invalidate`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-09T18:17:26.410

面板在绘画事件中重绘。这意味着您必须在此方法中绘制所有内容，而不是直接访问图形上下文。

`Graphics gfx = Panel1.CreateGraphics();`这解释了为什么每次重绘控件时您使用时绘制的所有内容都会丢失，因为在绘制事件期间，您仅绘制初始点，仅此而已。

# android - 适用于 Android 的 libgdx 3D 游戏引擎

> ID：11382431
> 
> 赞同：0
> 
> 时间：2012-07-08T10:31:32.347
> 
> 标签：android, libgdx

我想使用 libGDX 游戏引擎构建一个 3D 游戏。我不知道如何使用 libGDX。谁能帮助我如何使用 libGDX 创建 3D 游戏？任何示例代码？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-08T11:20:53.467

除了非常适合开始使用的 wiki 页面外，我建议您看看这里

演示： [https ://github.com/badlogic/libgdx/tree/master/demos](https://github.com/badlogic/libgdx/tree/master/demos)

测试： [http ://code.google.com/p/libgdx/source/browse/#svn%2Ftrunk%2Ftests%2Fgdx-tests%2Fsrc%2Fcom%2Fbadlogic%2Fgdx%2Ftests](http://code.google.com/p/libgdx/source/browse/#svn%2Ftrunk%2Ftests%2Fgdx-tests%2Fsrc%2Fcom%2Fbadlogic%2Fgdx%2Ftests)

这可能需要一些时间，但您可以从这些资源中学到很多东西

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-08T10:38:47.933

你可以查看 libGDX wiki 页面以获得很棒的教程！！它甚至包含一个小游戏示例:)

[http://code.google.com/p/libgdx/wiki/TableOfContents?tm=6](http://code.google.com/p/libgdx/wiki/TableOfContents?tm=6)

# jquery - 导航项目上的悬停功能不起作用

> ID：11382433
> 
> 赞同：0
> 
> 时间：2012-07-08T10:31:42.387
> 
> 标签：jquery, menu, navigation, slidedown

我有以下悬停脚本应该处理导航栏中子菜单的向下和向上滑动：

```
$j('body').ready(function() {
    $j('.menu-item').hover(function() {
        $j(this).find('.sub-menu').slideDown("slow");
    },
        function() {
            $j(this).find('.sub-menu').slideUp("slow");
        });
}); 
```

它向下滑动很好，但由于某种原因它没有向上滑动，而是在离开 div 时消失了。

[您可以在此页面](http://soteriabrighton.co.uk/)上看到正在运行的导航项目，特别是在“新闻”项目上，该项目有一个事件页面的下拉菜单。由于网站正在开发中，您将需要输入以下凭据：

用户名：访客

密码：stackoverflow

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T10:35:34.027

尝试这个：

```
$j(document).ready(function() {
    $j('.menu-item').hover(function() {
        $j(this).find('.sub-menu').stop().slideToggle("slow");
    });
}); 
```

您应该相对定位元素：

```
.sub-menu {
   position: relative;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T10:35:43.293

```
$j('.menu-item').mouseover(function() {
    $j(this).find('.sub-menu').slideDown("slow");
});
$j('.menu-item').mouseout(function() {
    $j(this).find('.sub-menu').slideUp("slow");
}); 
```

# c# - 如何选择按周分组的记录（包含日期）

> ID：11382434
> 
> 赞同：0
> 
> 时间：2012-07-08T10:32:04.577
> 
> 标签：c#, sql-server, group-by

我有一个表，其中包含一个日期字段 + 一个名为 WeekDayID 的字段（sun=0，mon=1，tue=2，wed=3，thu=4，fri=5，sat=6）+ 一些其他字段（不重要提），我需要两份报告：
1.基于月
2.基于周

我已经完成了第 1 号报告

我的问题是我如何才能达到报告 2，我需要一些东西来给我这个：

* * *

假设我们的日期从 2001/01/01 到 2001/01/31

我想按周对所有天进行分组，例如，如果 2001/01/01 是星期日，我想要这样的组：

第 1 周 : 2001/01/01 - 2001/01/02 - ... - 2001/01/07
第 2 周 : 2001/01/08 - ... - 2001/01/14
第 3 周 : 2001/01/15 - ... - 2001/01/21
第 4 周 : 2001/01/22 - ... - 2001/01/28
第 5 周 : 2001/01/29 - 2001/01/30 - 2001/01/31

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T12:49:35.643

对于周数，您可以使用 Datepart 函数，第一个参数的值为 'ww'：

```
SELECT Datepart(ww, myDate) FROM myTable 
```

对于日期范围，您可以做一些数学技巧： 减去工作日的日期以获得一周的第一天：

```
SELECT DateAdd(day, - DatePart(weekday, myDate), myDate) Week_Start
from myTable 
```

这里有一个 DatePart 函数的链接：

[http://msdn.microsoft.com/es-es/library/ms174420.aspx](http://msdn.microsoft.com/es-es/library/ms174420.aspx)

# php - PHP Documentor --output 选项

> ID：11382436
> 
> 赞同：9
> 
> 时间：2012-07-08T10:32:53.657
> 
> 标签：php, phpdoc

我已经通过 PEAR 安装了 PHP Documentor。但输出选项不起作用。当我使用简单的命令时

> phpdoc -d 源/路径 -t 目标/路径 --template 响应式

它工作正常。但是当我像这样使用 -o 或 --output 选项时

> phpdoc -d 源/路径 -t 目标/路径 -o PDF：默认值：*

它给出了以下错误。

> [运行时异常]
> 
> “-o”选项不存在。

我尝试过其他输出格式以及 -o HTML:Smarty:PHP 和 -o HTML:Smarty:default 但结果是一样的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-08T10:39:43.307

-o 选项在 phpdocs 2 Look 选项中不存在：

```
phpdoc -h 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-04-14T14:21:44.610

在新版本 2.* 中还没有这样的 pdf 模板。也没有选项-o。

只有[http://www.phpdoc.org/templates](http://www.phpdoc.org/templates)

模板选择

```
phpdoc --template="clean" --template="checkstyle" -d . 
```

* * *

顺便说一句，我使用的是旧版本（1.4.4），我想保存为 pdf。

```
phpdoc -o PDF:default:default -t ./docs -d ./ 
```

但是创建了一个错误的文档。也许版本 1.4.4 不适用于 PHP 5.5.11 在 PDF 格式的问题上。

我在 1.4.4 版本中管理只生成 HTML。

```
phpdoc -o HTML:frames:earthli -t ./docs -d ./ 
```

所以我回到版本 2 * 并等待 pdf 模板。

# c# - 如何在 C# 中将控件添加到另一个控件？

> ID：11382437
> 
> 赞同：1
> 
> 时间：2012-07-08T10:33:07.940
> 
> 标签：c#, user-controls

我想通过扩展现有控件来创建自定义控件。其实我是想给原来的控件增加一些功能。如何在其构造函数或其他任何地方为我的自定义控件添加另一个控件（例如 TextBox）？

```
public partial class AdvancedKnob : KnobControl
{

    private DoubleInput Field_ValueControl =  null;

    public AdvancedKnob()
    {
        this.InitializeComponent();
        this.Field_ValueControl = new DoubleInput();
        this.Container.Add(this.Field_ValueControl); //DOES NOT WORK!!
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T10:37:47.987

尝试这个：

```
this.Controls.Add(this.Field_ValueControl); 
```

有关详细信息，请转到：[如何使用 Visual C# 在运行时以编程方式将控件添加到 Windows 窗体](http://support.microsoft.com/kb/319266)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T10:36:53.333

利用

```
this.Controls.Add(control); 
```

# php - 在for循环外使用数组的值

> ID：11382444
> 
> 赞同：0
> 
> 时间：2012-07-08T10:33:51.530
> 
> 标签：php, for-loop

我有下面的代码。我有一个表单设置，其中设置了 10 个输入字段，5 个用于 column1，5 个用于 column2。

```
try
{
    $count = count($_POST['column1']);
    $sql = 'INSERT INTO tablename (column1, column2) VALUES ';

    for ($i=0; $i< $count; $i++) 
    {
        $sql2 = '(' .$_POST['column1'][$i] . ', ' . $_POST['column2'][$i] . ')';
        if ($i <$count - 1) {
           $sql2 .= ',';
        }
        echo "$sql2 'indside'<br>";
    }
    echo "$sql2  'outside'<br>";
    $sql3 = "$sql $sql2";
    $pdo->exec($sql3);
}
catch (PDOException $e)
{
  $output = 'Error: ' . $e->getMessage();
  exit();
} 
```

如果我在 10 个输入字段中输入 1,2,3,4,5,6,7,8,9,10 并点击提交，我会得到

```
(1, 6), 'indside'
(2, 7), 'indside'
(3, 8), 'indside'
(4, 9), 'indside'
(5, 10) 'indside'
(5, 10) 'outside' 
```

5 被插入到第 1 列，10 被插入到我的数据库的第 2 列。

我真正想要的是插入 5 个单独的行，因此在第 1 行中插入 1,6，在第 2 行中插入 2,7 等。但是当它在 for 循环中时，我无法弄清楚如何获取 $sql2 的值。这可能吗？或者他们是我可以采取的另一种方法来实现这一点吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T10:52:28.640

这看起来像一个简单的错误；

线

```
 $sql2 = '(' .$_POST['column1'][$i] . ', ' . $_POST['column2'][$i] . ')'; 
```

正在重置 $sql2 - 当它应该附加到它时，即

```
 $sql2 .= '(' .$_POST['column1'][$i] . ', ' . $_POST['column2'][$i] . ')'; 
```

结果是：

```
INSERT INTO tablename (column1, column2) VALUES  (1, 6),(2, 7),(3, 8),(4, 9),(5, 10) 
```

整个固定片段，包括@Thrustmaster 指出的修复 SQL 注入

```
try
{
    $count = count($_POST['column1']);
    $sql = 'INSERT INTO tablename (column1, column2) VALUES ';
    $sql2 = '';
    for ($i=0; $i< $count; $i++) 
    {
        if ($sql2 != '') $sql2 .= ",";

        $sql2 = '(' .mysql_real_escape_string($_POST['column1'][$i])
                   . ', ' . mysql_real_escape_string($_POST['column2'][$i]) . ')';
        echo "$sql2 'indside'<br>";
    }
    echo "$sql2  'outside'<br>";
    $sql3 = "$sql $sql2";
    $pdo->exec($sql3);
}
catch (PDOException $e)
{
  $output = 'Error: ' . $e->getMessage();
  exit();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T10:52:15.573

这是因为在循环的每次迭代中，变量 $sql2 都会被覆盖。您需要在上一次迭代之后“附加”到该值。

代替：

```
$sql2 = '(' .$_POST['column1'][$i] . ', ' . $_POST['column2'][$i] . ')'; 
```

和：

```
$sql2 .= '(' .$_POST['column1'][$i] . ', ' . $_POST['column2'][$i] . ')';
//    ^ Append to the string. 
```

并且不要忘记`$sql2='';`在 for 循环之前进行初始化。

* * *

现在的情况是，您对[SQL 注入攻击持](http://en.wikipedia.org/wiki/SQL_injection)开放态度。请为您的 mysql 查询使用[准备好的语句。](http://php.net/manual/en/pdo.prepared-statements.php)如果没有，至少[`mysql_real_escape_string($_POST['column1'][$i])`](http://php.net/manual/en/function.mysql-real-escape-string.php)在构建查询之前使用。

# android - 我需要在同一台设备上安装多个产品（android 应用程序）

> ID：11382452
> 
> 赞同：0
> 
> 时间：2012-07-08T10:34:45.457
> 
> 标签：android, xamarin.android

我有一个由 sqlite 数据库组成的 android 应用程序。数据库决定了它是什么产品。为了说明，我对不同的州有不同的旅游细节数据库。每个数据库大小为 10+ MB，一个产品将是一个包含特定状态的数据库（作为资产）的 android 应用程序。

我面临的挑战是如何在单个设备上安装多个此类产品？提前感谢您的建议和帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T10:37:03.343

将所有代码放入库项目中，并为您的每个产品创建一个新项目。

每个项目都将包括库项目，并将具有唯一的包名称和所需的数据库文件。

图书馆项目：http: [//developer.android.com/tools/projects/projects-eclipse.html#SettingUpLibraryProject](http://developer.android.com/tools/projects/projects-eclipse.html#SettingUpLibraryProject)

# php - 如何打开多个按钮？

> ID：11382453
> 
> 赞同：0
> 
> 时间：2012-07-08T10:34:55.780
> 
> 标签：php, jquery

在下面的代码中有一堆字母按钮：

```
<?php
    $a = range("A","Z");
?>

<table id="answerSection">
    <tr>

<?php
    $i = 1;
    foreach($a as $key => $val){
        if($i%7 == 1) echo"<tr><td>";
        echo"<input type=\"button\" onclick=\"btnclick(this);\" value=\"$val\" id=\"answer".$val."\" name=\"answer".$val."Name\" class=\"answerBtns answers answerBtnsOff\">";      
        if($i%7 == 0) echo"</td></tr>";
        $i++;
    }
?>
    </tr>
</table> 
```

现在下面的代码能够打开一个回答按钮：

```
$('#answer'+btn).addClass("answerBtnsOn"); 
```

以下是单击“添加”按钮时的代码，它从列中检索“答案”：

```
 echo '<td class="answertd">'.htmlspecialchars($searchAnswer[$key]).'</td>';
echo "<td class='addtd'><button type='button' class='add' onclick=\"parent.addwindow('$searchAnswer[$key]');\">Add</button></td></tr>"; 
```

下面是每个按钮（btn）的代码，它打开/关闭按钮：

```
function btnclick(btn)
{

    if ($(btn).hasClass("answerBtnsOn")) {
        $(btn).removeClass("answerBtnsOn").addClass("answerBtnsOff");
        return false;
    }

    if ($(btn).hasClass("answerBtnsOff")) {
        $(btn).removeClass("answerBtnsOff").addClass("answerBtnsOn");
        return false;
    }
} 
```

但唯一的问题是上面的代码只能打开一个回答按钮。例如如果“答案”是B，那么它会打开答案按钮B，这很好，或者如果“答案”是E，它可以打开答案按钮E。

问题是，如果有多个答案。如果“Answer”是BE，则不打开按钮B和E，如果“Answer”是ADF，则不打开按钮AD和F。

所以我的问题是，如果有多个答案，我该如何打开多个按钮？

演示：

单击[此处](http://helios.hud.ac.uk/u0867587/Mobile_app/Text16.php)查看演示，请按照以下步骤使用演示：

*   第一步：当你打开应用程序时，你会在页面上看到一个绿色的加号按钮，点击它会显示一个模态窗口。
*   第2步：在模态窗口有一个搜索栏，输入“AAA”并提交搜索，你会看到一堆行出现。
*   第 3 步：在第一行的“Answer”列下，您看到答案为 B，单击该行内的“Add”按钮，模态窗口将关闭，您将看到答案按钮已显示为“B”按钮突出显示。

现在这工作正常，但它只适用于单一答案，请按照以下步骤操作：

*   第四步：再次点击绿色的加号按钮，同样搜索“AAA”；

*   第5步：这次选择在“答案”列下有多个答案的行，例如第三行在“答案”列下有答案“A C”。通过单击“添加”按钮添加此行

*   第 6 步：您会看到它显示了相关按钮，但没有打开任何答案按钮，“A”按钮和“C”按钮未突出显示为绿色。这是我遇到的问题

更新：

```
//I can't use the toggle method you have mentioned because there is a suitable reason for this (long story)
    if ($(btn).hasClass("answerBtnsOn")) {
            $(btn).removeClass("answerBtnsOn").addClass("answerBtnsOff");
            return false;
        }

        if ($(btn).hasClass("answerBtnsOff")) {
            $(btn).removeClass("answerBtnsOff").addClass("answerBtnsOn");
            return false;
        }

//When "Add" button is clicked, it should turn on correct buttons
    function addwindow(condition) { 

    $('input[type=button]').each(function(){
        if (condition){
            $(this).addClass('correct');
        }
    });

    } 
```

HTML 代码与问题顶部的 html 代码相同

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T10:39:40.493

您需要使用类而不是 ID 并为所有正确答案提供相同的类，因此所有正确答案都将获得 .correct 类，然后在 jquery 中：

```
$('.correct').addClass("answerBtnsOn"); 
```

**编辑：**

在评论中回答您的问题 - 是的，您应该创建一个按钮数组，在其上运行并将`.correct`该类添加到所有正确答案中。

还将您的代码更改为：

```
if ($(btn).hasClass("answerBtnsOn")) {
        $(btn).removeClass("answerBtnsOn").addClass("answerBtnsOff");
        return false;
    }

    if ($(btn).hasClass("answerBtnsOff")) {
        $(btn).removeClass("answerBtnsOff").addClass("answerBtnsOn");
        return false;
    } 
```

至：

```
$(btn).toggleClass("answerBtnsOn");
$(btn).toggleClass("answerBtnsOff"); 
```

它应该用更少的代码做同样的事情。

**EDIT2：** 循环将是这样的：

```
$('input[type=button]').each(function(){
    if (condition){
        $(this).addClass('correct'));
    }
}); 
```

如果此答案正确，则条件为真。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T11:51:20.607

这是修改后的代码。首先我们初始化php变量：

```
$a = range("A","Z");
$correct = "ADERW"; // some string with correct letters (aka answers) 
```

现在我们将 javascript 函数放入页面头部（或外部文件）：

```
var oanswers = new Object(); // this object's attributes are named as correct letters
var answers = '<?php echo $correct; ?>'; //string
for (var i=0; i<answers.length; i++) {
  oanswers[answers[i]] = true;
}

function btnclick(btn) {
    if (!oanswers.hasOwnProperty(btn.id[6])) {
        return;
    }
    if ($(btn).hasClass('answerBtnsOff')) {
        $('.answers').each(function(){ // turn all correct answers on
            if (oanswers.hasOwnProperty(this.id[6])) {
                $(this).addClass('answerBtnsOn');
                $(this).removeClass('answerBtnsOff');
            }
        });
    } else {
        $('.answers').each(function(){ // turn all correct answers off again
            if (oanswers.hasOwnProperty(this.id[6])) {
                $(this).addClass('answerBtnsOff');
                $(this).removeClass('answerBtnsOn');
            }
        });
    }
} 
```

btnclick 功能可以关闭和打开所有正确答案。如果您不想切换，只需擦除整个`else`分支。现在它测试对象的属性是否已定义，而不是测试 .created 类的存在。

# xml-sitemap - 如何为可能具有大量 URL 的不断增长的站点创建站点地图？

> ID：11382458
> 
> 赞同：0
> 
> 时间：2012-07-08T10:36:07.437
> 
> 标签：xml-sitemap

我有一个可能包含大量 URL 的网站，我希望 google bot 了解它们。所以我想我将使用一个站点地图索引，该索引将指向树中的另一个站点地图索引，就像树的叶级将指向 URL 一样。但据我了解，站点地图索引不能引用另一个站点地图索引。那么如何在不必每次手动提交包含 50,000 个链接的新站点地图索引的情况下包含所有 URL？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T01:55:31.280

您的站点地图索引 (http://yourdomain.com/sitemap.xml) 应该是站点地图的站点地图索引，而不是站点地图索引。

一个站点地图最多可以包含 50,000 个链接。这意味着您可以拥有一个包含 50,000 个站点地图的站点地图索引 (sitemap.xml)，每个站点地图包含 50,000 个链接。那是 25 亿页。

如果您的页面不超过 25 亿，您只需要一个指向所有站点地图的站点地图索引。

这是我过去研究过的站点地图的[示例层次结构。](http://www.elance.com/sitemap.xml)

# html - 如何使 'content' div 浮动到 'subMenu' div 的右侧？

> ID：11382460
> 
> 赞同：0
> 
> 时间：2012-07-08T10:36:43.667
> 
> 标签：html, css

我知道这很简单，但我已经挣扎了一段时间，我就是无法让它发挥作用。我想这里有人可能能给我一个快速的答案。

我正在尝试使 div 浮动并与另一个 div 对齐。我正在尝试通过更改**浮动**和**显示**css 属性，但没有运气。

我已经设置了一个 jsFiddle：[jsFiddle](http://jsfiddle.net/zaRqz/9/)

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T10:41:32.923

这里：[jsfiddle](http://jsfiddle.net/zaRqz/27/)

我只是更改了 div 的高度以使示例看起来更好，但您可以将其设置回您网站的高度。

我会在整个容器 div 上设置 margin-top 以便您只定义一次该属性，而不是分别为菜单和内容设置它：每当您定义一个值两次时，您应该尝试放置一个包装器并且只定义一次。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-08T10:44:46.917

如果屏幕足够宽，您的代码运行良好。只有当它不是`#content`被推到`submenu`. 为了解决这个问题，给你`#container`一个可以容纳两者的宽度 - [http://jsfiddle.net/zaRqz/11/](http://jsfiddle.net/zaRqz/11/)

```
#container {
    width: 1040px;
    overflow: hidden;
} 
```

# memory-leaks - 使用 ImageMagick 调整动画 gif 大小时的内存泄漏

> ID：11382465
> 
> 赞同：3
> 
> 时间：2012-07-08T10:37:02.187
> 
> 标签：memory-leaks, resize, imagemagick, animated-gif, magickwand

我正在尝试使用 ImageMagick MagickWand 调整动画 gif 的大小，但会出现一些小的内存泄漏。每 400 个 gif 约 3 Mb。我不能 100% 确定我是否正确使用了 MagickWand。

```
MagickWandGenesis();
MagickCore::MagickWand *magick_wand = NewMagickWand();
MagickCore::MagickWand *magick_wand2 = NewMagickWand();

for(std::vector<string>::iterator it = gifs.begin(); it != gifs.end(); ++it)
{   
    inputFileName = "C:\\Projects\\gifs\\" + *it + ".gif";
    outputFileName = "C:\\Projects\\gifs\\out\\" + *it + ".gif";

    MagickReadImage(magick_wand, inputFileName.c_str());

    int width = MagickGetImageWidth (magick_wand);
    int height = MagickGetImageHeight (magick_wand);

    magick_wand2 = MagickCoalesceImages(magick_wand);
    ClearMagickWand(magick_wand);

    if(width > THUMBNAIL_WIDTH)
    {
        height = static_cast<int>(height * THUMBNAIL_WIDTH / width);
        width = 144;
    }

    if(height > THUMBNAIL_HEIGHT)
    {
        width = static_cast<int>(width * THUMBNAIL_HEIGHT / height);
        height = 144;
    }

    MagickResetIterator(magick_wand2);
    while (MagickNextImage(magick_wand2) != MagickFalse)
        MagickResizeImage(magick_wand2, width, height, MitchellFilter, 1 );

    magick_wand = MagickOptimizeImageLayers(magick_wand2);
    ClearMagickWand(magick_wand2);

    MagickWriteImages(magick_wand, outputFileName.c_str(), MagickTrue);             
    ClearMagickWand(magick_wand);
}

DestroyMagickWand(magick_wand);
DestroyMagickWand(magick_wand2);
MagickWandTerminus(); 
```

我尝试使用一个 MagickWand 而不是两个，但是功能无法正常工作，并且泄漏甚至更高。我也尝试在 for 循环中初始化 MagickWand，但没有帮助。使用此代码，可以正确调整 gif 的大小和优化。由 检测到的内存泄漏`_CrtDumpMemoryLeaks()`。它们在 Windows 任务管理器中也很明显。

# javascript - 发布方法数据未在 jquery mobile 中正确发送

> ID：11382468
> 
> 赞同：0
> 
> 时间：2012-07-08T10:37:27.843
> 
> 标签：javascript, jquery, jquery-ui, jquery-mobile

嗨，我想使用 post 方法将数据发送到服务器，但不使用 ajax 我正在发送这样的数据：

```
function handleLogin()
{

var form = $("#loginForm");    
 var u = $("#username", form).val();
var p = $("#password", form).val();
var d = $("#dob", form).val();

if(u != '' && p!= '')
{

    var finalStr = u+encodeURIComponent("|^")+p+encodeURIComponent("|^")+encodeURIComponent("|^")+"X"+encodeURIComponent("|^")+d+encodeURIComponent("|^")+"1.0"+encodeURIComponent("|^|$");
    var encodedURL = encodeURI(intranetUrl+"customer/Ri_logon5.asp?requestString=");
    var parameters =  decodeURIComponent(finalStr);
    post_to_url(encodedURL,parameters);      

}

else
{

    alert("You must enter a username and password", function() {});
    $("#submitButton").removeAttr("disabled");
}

} 
```

我的 post_to_url 函数如下：

```
function post_to_url(url, params) {
var form = document.createElement('form');
form.action = url;
form.method = 'POST';

for (var i in params)
{
    if (params.hasOwnProperty(i))
    {
        var input = document.createElement('input');
        input.type = 'hidden';
        input.name = i;
        input.value = params[i];
        form.appendChild(input);                      
    }
}

 form.submit();
} 
```

但是从服务器我得到的响应不是当你传递错误参数时出现的对象。但是当我用 ajax 10 传递相同的参数时，它工作得很好。为什么会这样？

我的网址格式是：http://myDomain/Ri_logon5.asp?requestString=

参数格式如下：manish|^info1234|^|^X|^11111985|^1.0|^|$

如果我输入 url 并在 rest 客户端中传递参数，那么它会给出正确的响应。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T13:37:12.757

我在 ajax 中使用了以下 mwthod，效果很好：

```
$.ajax({
                            type: "POST",
                            contentType:"application/x-www-form-urlencoded; charset=UTF-8",
                            url: clientDetailURL,
                            data: finalclientDetailParam
                          }).done(function( msg1 )
                          {
                                      var clientDetailResponse = msg1;
                                      console.log("Client detail response is:"+clientDetailResponse);

                          }); 
```

这里的 clientDetailURL 是：http://myDomain/Ri_logon5.asp?requestString= 和 finalClientDetailParam 是：manish|^info1234|^|^X|^11111985|^1.0|^|$

对于这个 ajax，它可以正常工作，但对于没有 ajax 的 POST 方法则不同。这完全令人困惑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T11:34:33.690

看到您想使用 POST 而不是 GET，您应该更改您的代码以传递多个 post 值。您想要的只是发布 requestString。此外，您应该将 url 更改为：myDomain/Ri_logon5.asp

```
function post_to_url(url, params) {
var form = document.createElement('form');
form.action = url;
form.method = 'POST';

// Change this to fetch the arguments and build the string accordingly
var postString = 'manish|^info1234|^|^X|^11111985|^1.0|^|$'; 

var input = document.createElement('input');
input.type = 'hidden';
input.name = 'requestString';
input.value = postString
form.appendChild(input);  

 form.submit();
} 
```

# php - 如何选择不同的层次结构节点（MySQL）

> ID：11382472
> 
> 赞同：0
> 
> 时间：2012-07-08T10:38:40.937
> 
> 标签：php, mysql, database, codeigniter

我正在使用邻接模型列表，例如：

父母杰克 id 1

孩子 some_name parent_id 1

孩子 some_name parent_id 1

孩子 some_name parent_id 1

因此，当我进行查询时，可以说深度约为 1 lvl，它会呈现以下内容：

杰克-> some_name

杰克-> some_name

杰克-> some_name

但我怎样才能让它像这样呈现：

杰克-> {

一些名字

一些名字

一些名字

}

这可能吗？，因为关键字 DISTINCT 和 GROUP BY 没有帮助:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T11:15:20.000

考虑使用 JSON 来格式化您的数据。

使用 json_encode：

```
$persons = array ();
while ($row = mysql_fetch_assoc($result))
{
    if (empty($persons[$row['person']]))
        $persons[$row['person']] = array ();
    array_push ($persons[$row['person']], $row['child']);
}

echo json_encode ($persons); 
```

它应该导致以下结果：

```
{
    'jack': [
        'some_name',
        'some_name',
        'some_name'
    ]
} 
```

[从https://stackoverflow.com/a/1951130/443219](https://stackoverflow.com/a/1951130/443219)获得大部分代码

# javascript - 调整外部网站内容的大小以适合 iFrame 宽度

> ID：11382473
> 
> 赞同：42
> 
> 时间：2012-07-08T10:38:44.367
> 
> 标签：javascript, html, css, iframe, web

我有一个包含 2 个 iFrame 的网页。它们都具有固定的宽度和高度。我正在其中加载外部网站。如何调整这些外部网站的宽度以适应 iFrame（就像移动浏览器通过更改视口所做的那样）？

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2012-07-08T11:09:53.900

您可以做的是为您的 iframe 设置特定的宽度和高度（例如，这些可能等于您的窗口尺寸），然后对其应用缩放转换。比例值将是您的窗口宽度与您要设置到 iframe 的尺寸之间的比率。

例如

```
<iframe width="1024" height="768" src="http://www.bbc.com" style="-webkit-transform:scale(0.5);-moz-transform-scale(0.5);"></iframe> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-05-14T19:16:06.027

1 个网站调整高度大小的提示。但是您可以更改为 2 个网站。

这是我使用外部网站调整 iframe 大小的代码。您需要在父（带有 iframe 代码）页面和外部网站中插入代码，因此，这不适用于您无权编辑外部网站。

*   本地（iframe）页面：只需插入代码片段
*   远程（外部）页面：您需要一个“body onload”和一个包含所有内容的“div”。并且正文需要设置为“margin：0”

当地的：

```
<IFRAME STYLE="width:100%;height:1px" SRC="http://www.remote-site.com/" FRAMEBORDER="no" BORDER="0" SCROLLING="no" ID="estframe"></IFRAME>

<SCRIPT>
var eventMethod = window.addEventListener ? "addEventListener" : "attachEvent";
var eventer = window[eventMethod];
var messageEvent = eventMethod == "attachEvent" ? "onmessage" : "message";
eventer(messageEvent,function(e) {
  if (e.data.substring(0,3)=='frm') document.getElementById('estframe').style.height = e.data.substring(3) + 'px';
},false);
</SCRIPT> 
```

您需要这个“frm”前缀来避免其他嵌入代码（如 Twitter 或 Facebook 插件）出现问题。如果您有一个普通页面，则可以删除两个页面（脚本和 onload）上的“if”和“frm”前缀。

偏僻的：

您需要 jQuery 来完成“真实”页面高度。我无法意识到如何使用纯 JavaScript，因为在使用 body.scrollHeight 或相关调整高度（从高到低）时会遇到问题。出于某种原因，它将始终返回最大高度（预先调整尺寸）。

```
<BODY onload="parent.postMessage('frm'+$('#master').height(),'*')" STYLE="margin:0">
<SCRIPT SRC="path-to-jquery/jquery.min.js"></SCRIPT>
<DIV ID="master">
your content
</DIV> 
```

因此，父页面 (iframe) 的默认高度为 1px。该脚本从 iframe 插入“等待消息/事件”。当收到一条消息（post message）并且前 3 个字符是“frm”（以避免提到的问题）时，将从第 4 个位置获取数字并设置 iframe 高度（样式），包括 'px' 单位。

外部站点（加载在 iframe 中）将使用“frm”和主 div 的高度（在本例中为 id“master”）向父级（opener）“发送消息”。邮件中的“*”表示“任何来源”。

希望这可以帮助。对不起我的英语不好。

# iphone - PhoneGap + iOS 异常：[UIWebOverflowScrollView _viewDelegate] 消息发送到已释放实例 0x21e330

> ID：11382476
> 
> 赞同：0
> 
> 时间：2012-07-08T10:39:06.413
> 
> 标签：iphone, cordova, uiwebview, crash, barcode-scanner

在使用我用 PhoneGap + iOS 创建的应用程序一段时间后，应用程序崩溃并显示以下错误消息：

```
[UIWebOverflowScrollView _viewDelegate]: message sent to deallocated instance 0x21e330 
```

我不知道为什么会发生这个问题。我无法重现错误，它只是突然发生的。我知道这个问题与已发布的任何类型的对象有关，但是当我使用 PhoneGap（+ QrCode 插件）时，我确信这个问题与 Phonegap 或 BarcodeScanner 插件有关。有人能给我关于如何解决这个问题的任何见解吗？我已经更新到新的 PhoneGap 版本 1.9.0。

相关问题：[Phonegap 应用程序中的 UIWebOverflowScrollView 异常](https://stackoverflow.com/questions/10378946/uiweboverflowscrollview-exception-in-phonegap-application)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T10:50:56.467

您是否在 CSS 中使用“-webkit-overflow-scrolling: touch”？

我们的 phonegap-app 也遇到了同样的问题，它有时会崩溃并显示相同的错误消息（有时只锁定上部屏幕），并通过删除该部分 CSS 来修复它。

如果您使用的是“-webkit-overflow-scrolling: touch”，也许测试一下如果没有它，您的应用程序是否会崩溃？

有关上述错误和可能的解决方案的更多信息，请参见[apache.org 。](https://issues.apache.org/jira/browse/CB-593)

我们通过使用[iScroll](http://cubiq.org/iscroll-4)而不是 CSS 解决了这种情况。

很抱歉回答迟了，我们刚刚解决了我们的问题：P。

# java - 第二次读取时 Netty http keep-alive 超时

> ID：11382482
> 
> 赞同：0
> 
> 时间：2012-07-08T10:40:22.073
> 
> 标签：java, timeout, netty

我正在使用 netty 编写一个网页游戏服务器，并打算使用 keep-alive 来获得更高的性能。
如果我将 CachedThreadPool 用于老板和工作人员执行程序，则服务器对于保持活动和非保持活动连接都可以正常工作。
但是，如果我使用 FixedThreadPool(1) 一个用于老板，一个用于工作人员，第一个响应会发送到客户端，但如果浏览器使用该连接发送第二个请求，它将被阻塞并在服务器超时，我关闭该连接并 firefox 打开新套接字，这个套接字在第一次响应时也可以正常工作。（我已经在响应头中包含了 Connection Keep-alive 和 ContentLength 并使用 httpAnalyzer 工具仔细检查它。
那么有人可以告诉我为什么会发生这种情况以及将线程与netty一起用于网络游戏服务器的最佳实践是什么。如果 netty 是异步的，这不应该发生吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T12:49:25.850

您应该始终使用 CachedThreadPool 并使用 NioSocketChannelFactory 的构造函数来限制使用的线程。我认为它也记录在 javadocs 中。

# mysql - MySQL 用另一个表的总和值更新表

> ID：11382485
> 
> 赞同：0
> 
> 时间：2012-07-08T10:40:30.833
> 
> 标签：mysql, sum

我有一个查询，我似乎无法在 MySQL 的 SUM 函数中操作：

这是我想要的：

> 将 account_seeds 更新为
> 内部联接 b AS b ON b.accountID = a.accountID AND a.areaID = b.areaID 内部
> 联接 b_seed AS s ON s.buildingID = b.buildingID 内部
> 联接 seed_class AS c ON c.seedID = s。 seedID
> SET a.amount = a.amount + ***SUM(s.amount)***
> 其中 b.status='active' AND a.seedID = s.seedID

现在它显然不会让我在不分离的情况下在更新中使用 SUM。我曾尝试加入选择查询，但无法完全理解它。基本前提是我有多个建筑物（行），它们的种子值将增加特定帐户该区域中该类型的总种子数。如果没有总和，它只会更新具有匹配种子值的建筑物之一

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T14:17:01.313

```
UPDATE 
    account_seeds AS a 
  INNER JOIN 
    ( SELECT b.accountID, b.areaID, s.seedID
           , SUM(s.amount) AS add_on 
      FROM b AS b 
        INNER JOIN b_seed AS s 
          ON s.buildingID = b.buildingID
        INNER JOIN seed_class AS c 
          ON c.seedID = s.seedID
      WHERE b.status = 'active' 
      GROUP BY b.accountID, b.areaID, s.seedID
    ) AS g
    ON  g.accountID = a.accountID 
    AND g.areaID = a.areaID
    AND g.seedID = a.seedID
SET 
    a.amount = a.amount + g.add_on ; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T12:04:28.927

也许您可以使用嵌套查询：

```
UPDATE account_seeds AS a 
INNER JOIN b AS b ON b.accountID = a.accountID AND a.areaID = b.areaID
INNER JOIN b_seed AS s ON s.buildingID = b.buildingID
INNER JOIN seed_class AS c ON c.seedID = s.seedID
SET a.amount = a.amount + (SELECT SUM(amount) FROM b_seed)
WHERE b.status='active' AND a.seedID = s.seedID 
```

你能试试吗？

# jquery - jQuery/CSS：变暗/屏蔽所有 div/浏览器窗口 - 除了一个选定的 div

> ID：11382487
> 
> 赞同：2
> 
> 时间：2012-07-08T10:41:14.880
> 
> 标签：jquery, css, mask

我正在开发一个单页网站上的一些 jQuery Isotope 插件逻辑。

当一个*项目*被*选中*并*最大化*以显示某些内容时，我想在它们被*最小化后使***所有其他项目变暗/变暗/屏蔽**- 除了被点击的那个。这是我现在的工作逻辑；单击的*项目*会添加所选的类*，*已*选择*的*item* 会在单击时删除*所选的类：*

 ***```
$('.item').click(function(){
    if($(this).hasClass('selected')){
        $(this).removeClass('selected');
        $(this).children('.maximised').hide()
        $(this).children('.minimised').show()
    }else{
        $(this).addClass('selected');
        $(this).children('.minimised').hide()
        $(this).children('.maximised').show()
    }
    $container.isotope('shuffle');
    $container.isotope('reLayout');
}); 
```

处理透明度看起来不太好，因为背景图像/视频变得可见。也许我可以轻松地以某种方式“调暗”整​​个浏览器窗口？理想情况下，我会避免使用另一个插件。你有什么建议我可以达到预期的效果吗？

非常感谢您！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-08T11:22:54.190

我认为您正在寻求以下解决方案。

```
$(".item").click(function(e) {
    //code
    $("body").append($("<div>").css({
        position: "fixed"
        ,width: "100%"
        ,height: "100%"
        ,"background-color": "#000"
        ,opacity: 0.6
        ,"z-index": 999
        ,top: 0
        ,left: 0
    }).attr("id","page-cover"));
    //more code
}); 
```

当然，您可能需要使用`z-index`for this div，并且可以将所有 CSS 放入样式表中。

**备用**

您可以将此 div 放在`BODY`标签的末尾并使用此 CSS：

```
#page-cover {
    display: none;
    position: fixed;
    width: 100%;
    height: 100%;
    background-color: #000;
    z-index: 999;
    top: 0;
    left: 0;
} 
```

有了这个 JS：

```
//on click of .item
$("#page-cover").show().css("opacity",0.6); 
```***

# javascript - 使用实时不工作的焦点 - jQuery

> ID：11382490
> 
> 赞同：1
> 
> 时间：2012-07-08T10:41:34.847
> 
> 标签：javascript, jquery

我正在尝试`focusin event`使用 jquery 1.5.2 在未来元素上附加 a 。澄清[一下，使用 jQuery 1.7.2 也曾尝试过同样的问题。](http://jsfiddle.net/5T3SG/4/)

该事件没有像我预期的那样触发。然而，类似的点击事件可以正常使用`.live`

我在这里整理了一个示例，供您查看我的代码。希望这不是一个简单的问题（尽管它似乎总是如此！）。

[链接到 jsfiddle](http://jsfiddle.net/5T3SG/2/)

这是我要附加的焦点事件

```
$(".active").live("focusin", function() {
    $(this).text("focusin using live");
}); 
```

我相信我已经找到了一些相关的问题，但我无法使用它们修复我的代码。我更喜欢“这是您的代码更正答案”的解释。

如果您认为我需要为我的问题添加更多信息，请发表评论。

**有关的**

[jQuery focusin 和 focusout 实时事件没有触发](https://stackoverflow.com/questions/3524454/jquery-focusin-and-focusout-live-events-are-not-firing)

[为什么不调用“focusin”事件处理程序？](https://stackoverflow.com/questions/4039952/why-the-focusin-event-handler-isnt-called)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T10:52:06.623

如果您希望`focusin`事件触发，则需要关注元素。您在类中应用 DOM 元素这一`.active`事实并不意味着您正在关注它。

```
$('.active').live('focusin', function() {
    $(this).text('focusin using live');
});

$('.active').focus();
​ 
```

[这是一个演示](http://jsfiddle.net/5T3SG/6/)。

您会注意到的另一件事是`.live()`支持`focusin`从 jQuery 1.7.1 开始的事件。显然，在这个版本的 jQuery 中，`.live()`已弃用，您应该使用[`.on()`](http://api.jquery.com/on/)：

```
$(document).on('focusin', '.active', function() {
    $(this).text('focusin using on');
});

$('.active').focus(); 
```

​</p>

# javascript - 如何确保通过 socket.io 的消息已收到客户端？

> ID：11382495
> 
> 赞同：22
> 
> 时间：2012-07-08T10:42:00.710
> 
> 标签：javascript, node.js, websocket, socket.io

如何检查使用**socket.io**库发送的消息是否已接收到客户端。socket.io 中是否有特殊的方法？

感谢您的回答！

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-07-08T11:51:45.080

您应该在定义事件处理程序时使用回调参数。

一个典型的实现如下：

客户端

```
var socket = io.connect('http://localhost');
socket.emit('set', 'is_it_ok', function (response) {
    console.log(response);
}); 
```

服务器端

```
io.sockets.on('connection', function (socket) {
    socket.on('set', function (status, callback) {
        console.log(status);
        callback('ok');
    });
}); 
```

现在检查服务器端的控制台。它应该显示“is_it_ok”。接下来检查客户端的控制台。它应该显示“确定”。那是确认信息。

## 更新

socket.io 连接本质上是持久的。以下内置函数可让您根据连接状态采取行动。

```
socket.on('disconnect', function() {} ); // wait for reconnect
socket.on('reconnect', function() {} ); // connection restored  
socket.on('reconnecting', function(nextRetry) {} ); //trying to reconnect
socket.on('reconnect_failed', function() { console.log("Reconnect failed"); }); 
```

使用上面显示的回调选项实际上是以下两个步骤的组合：

```
socket.emit('callback', 'ok') // happens immediately 
```

在客户端

```
socket.on('callback', function(data) {
    console.log(data);
}); 
```

所以你不需要使用计时器。回调会立即运行，除非连接具有以下任何状态 - 'disconnect'、'reconnecting'、'reconnect_failed'。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-08-25T18:57:20.603

您可以使用 socket.io 的确认。

引用 socket.io 文档：

> 有时，您可能希望在客户端确认消息接收时获得回调。
> 
> 为此，只需将函数作为`.send`or 的最后一个参数传递`.emit`。更重要的是，当你使用时`.emit`，确认是由你完成的，这意味着你也可以传递数据。

在客户端只需使用您的数据发出事件，只要服务器响应您的事件，就会调用该函数：

```
client.emit("someEvent", {property:value}, function (data) {
  if (data.error) 
    console.log('Something went wrong on the server');

  if (data.ok)
    console.log('Event was processed successfully');
}); 
```

在服务器端，您会被调用数据和回调句柄以发送响应：

```
socket.on('someEvent', function (data, callback) {

  // do some work with the data

  if (err) {
    callback({error:'someErrorCode', msg:'Some message'});
    return;
  }

  callback({ok:true});
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-08T11:49:42.197

当你添加一个函数作为`.send()`或`.emit()`方法调用的最后一个参数时，当对方收到消息时调用这个函数。

```
socket.send('hi', function() {
    // if we are here, our salutation has been received by the other party.
}); 
```

# c - 结构节点下一个指针

> ID：11382498
> 
> 赞同：0
> 
> 时间：2012-07-08T10:42:11.967
> 
> 标签：c, pointers, free

我有一个结构，它包含一个`next`指向相同类型结构的指针。

我有以下代码存储`node`指针存储的结构的编号，释放它，并将节点设置为`node->next`. 如果在它之前被调用，怎么`node->next`知道它是什么？`free`

```
double data = node->element;
free(node)
node = node->next;
return data; 
```

但是，遵循相同的逻辑，以下代码会出现段错误。唯一的区别是它使用了一个`node`，而另一个只是将元素存储在它的基本数据类型中。

```
struct node *temp;
temp = node;
free(node);
node = node->next;
return temp; 
```

为什么会这样？第一段代码是如何工作的？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T10:47:22.757

你*永远*不应该取消引用一个释放的指针——它是在自找麻烦，很可能是你的段错误的根源。即使它没有段错误，您也无法对该内存地址处数据的有效性做出任何假设，因此这不是一件好事。你没有在你的问题中提供太多细节，但为什么不稍微修改你的代码来尝试这个顺序

```
struct node *temp = node->next;
free(node);
return temp; 
```

这样你在删除之前存储指针`node`并且不应该得到段错误

至于第一个代码

```
double data = node->element;
free(node)
node = node->next;
return data; 
```

为什么不直接替换为

```
double data = node->element;
free(node)
return data; 
```

因为这会删除访问已释放内存的代码，以及您的行

```
node = node->next; 
```

`node`无论如何， 当您在下一行免费时，这实际上是毫无意义的。

# android - SharedPreferences 在杀死应用程序后消失了

> ID：11382500
> 
> 赞同：0
> 
> 时间：2012-07-08T10:43:12.230
> 
> 标签：android, sharedpreferences

杀死应用程序时不应删除 SharedPreferences ，但在我的情况下它确实如此。我之前使用 SharedPreference 没有遇到这些问题。但是由于某种原因，当我杀死应用程序时，我的 SharedPreference 被删除了。以下是要保存的代码：

```
private void SavePreferences(String key, String value){
    SharedPreferences sharedPreferences = getSharedPreferences("MY_SHARED_PREF", MODE_PRIVATE);
    SharedPreferences.Editor editor = sharedPreferences.edit();
    editor.putString(key, value);
    editor.commit();
   } 
```

并保存一个字符串：

```
SavePreferences("NAMEOFPREFERENCE", ("WhatToSave")); 
```

并加载：

```
final SharedPreferences sharedPreferences = getSharedPreferences("MY_SHARED_PREF", MODE_PRIVATE);

sharedPreferences.getString("NAMEOFPREFERENCE", ""); 
```

什么可能导致问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T16:16:10.307

我不确定，但您应该使用[PreferenceManager](http://developer.android.com/reference/android/preference/PreferenceManager.html)与[应用程序上下文](http://developer.android.com/reference/android/content/Context.html#getApplicationContext%28%29)：

```
SharedPreferences pref = PreferenceManager.getDefaultSharedPreferences(getApplicationContext()); 
```

# objective-c - Objective-C 中的静态变量声明有何不同？

> ID：11382502
> 
> 赞同：7
> 
> 时间：2012-07-08T10:43:25.143
> 
> 标签：objective-c, c, cocoa, global-variables, static-variables

请查看此标题：

```
// Test.h
@interface Test : NSObject @end

extern id A;               // (0)
//extern static id B;      // (1) Uncomment to get a compiling error
extern id C;               // (2)
//extern static id D;      // (3) Uncomment to get a compiling error 
```

并进入这个实现：

```
// Test.m
#import "Test.h"

id A = @"A";               // (4)
static id B = @"B";        // (5)

@implementation Test

id C = @"C";               // (6)
static id D = @"D";        // (7)

@end

// Still Test.m

@interface Test2 : NSObject @end
@implementation Test2 : NSObject

+ (void)initialize {
    NSLog(@"%@ %@", A, B); // (8)
    NSLog(@"%@ %@", C, D); // (9)
}

@end 
```

我有以下问题：

1.  声明 (4) 和 (5) 或 (6) 和 (7) 之间有什么根本区别吗？
2.  “外部”声明（4）和包含在实现范围内的（6）之间有什么区别吗？
3.  为什么在实现范围内声明的 (6) 和 (7) 可以在另一个实现范围 (9) 中访问？
4.  为什么（2）在标头中声明可以访问（6）在实现范围内声明？
5.  为什么 (1) 和 (3) 生成错误`Cannot combine with previous 'extern' declaration specifier`，但 (0) 和 (2) 编译时没有错误？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-08T11:03:00.237

1.  是的，`static`在这种情况下使用将变量限制在文件的范围内。

    如果您有 (4) 并`id A = @"A"`在项目的另一个文件中声明，即使`extern`在标头中没有声明，您也会收到编译器错误。

    在 (5) 的情况下，如果您`static id B = @"B"`在另一个文件中声明，那么它将正常工作。

2.  不，这些是 C 变量声明，不遵循 Objective-C 范围规则。

3.  由于 Objective-C 是 C 的超集，因此 (6) 和 (7) 只是像在 C 中一样声明的全局变量。

4.  (2) 并没有真正引用 (6)，它只是向其他文件声明`#import`它“相信我，`C`在另一个文件中声明了一个名为的变量”，稍后在链接编译的目标文件时解决这个问题。

5.  如前所述`static`，将变量的范围限制为当前文件，因此它与`extern`变量在另一个文件中声明的说法相冲突。

# asp.net-mvc - 如何防止基于下拉列表选择的点击事件？

> ID：11382504
> 
> 赞同：0
> 
> 时间：2012-07-08T10:43:42.447
> 
> 标签：asp.net-mvc, jquery-ui, drop-down-menu

我在 ASP.NET 项目中有一个下拉列表，其中包含四个选项和一个默认状态。还有一个按钮可以打开弹出对话框。如果用户选择某些选项，我想禁用打开弹出窗口的按钮，因为 ddl 上的某些选项不需要弹出对话框。弹出窗口通过绑定到图像的 onClick 事件调用。如何阻止 onClick 事件触发四个 ddl 选项中的两个？这是代码的简化版本：

HTML结构：

```
<select class="selClass" id="selID" name="selName"><option value="">- Select -</option>

<option value="Option1">Option1</option>

<option value="Option2">Option2</option>

<option value="Option3">Option3</option>

<option value="Option4">Option4</option>

</select> 
```

查询：

```
$(function () {
if ($("#ddlID option:selected").text() == "- Select -")
    $('img.popButton').button({ disabled: true })

else if ($("#ddlID option:selected").text() == "Option1")
    $('img.itemgridimg').button({ disabled: false });

else if ("#ddlID option:selected").text() == "Option2")
    $('img.itemgridimg').button({ disabled: true });

else if ("#ddlID option:selected").text() == "Option3")
    $('img.itemgridimg').button({ disabled: true });

else if ("#ddlID option:selected").text() == "Option4")
    $('img.itemgridimg').button({ disabled: false });
}); 
```

我希望这会完全禁用按钮的 onClick 事件，但它只会改变按钮的视觉状态（基于 ui-diabled 类），但弹出窗口仍处于激活状态。

正如我之前所说，弹出窗口是通过图像标签内动态生成的 onClick 事件调用的。当用户仅选择选项 2 或 3 时，如何阻止弹出事件触发？

更新：

根据下拉菜单中的某些选择简单地隐藏按钮绝对是一种更好的方法，但是现在，我想在隐藏另一个 div 的同时动态插入新图像。我认为这将是一个简单的等式，但我在某些地方犯了错误......我无法将图像插入旧 div，因为它是隐藏的，那么如何动态插入带有备用图像的新 div？我更新的代码如下，但由于该功能我收到错误......有什么建议吗？

```
$('img.itemgridimg').hide();

$("[id][name*='Status']:eq(0)").change(function () {
if ($("[id][name*='Status']:eq(0) option:selected").text() == "- Select -")
    $('img.itemgridimg').eq(0).hide();

$("<div/>",{
"html"  : "<img src='../Images/btnOff.png'>"
}); // <---- bad code…need help 

else if ($("[id][name*='Status']:eq(0) option:selected").text() == "Missing")
    $('img.itemgridimg').eq(0).show();

else if ($("[id][name*='Status']:eq(0) option:selected").text() == "Not Applicable")
    $('img.itemgridimg').eq(0).hide();

else if ($("[id][name*='Status']:eq(0) option:selected").text() == "Functional / Acceptable As Is")
    $('img.itemgridimg').eq(0).hide();

else if ($("[id][name*='Status']:eq(0) option:selected").text() == "Needs Repair/Replace/Cleaning")
    $('img.itemgridimg').eq(0).show();

}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T10:49:51.000

为了防止按钮点击罚款尝试使用这个：

```
$('img.popButton').on('click', function(){
return false;
}); 
```

或者，您可以使用：

```
$("img.popButton").click(function(event) {
  event.preventDefault();
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T11:04:14.020

如果您真的无法控制 的`onclick`处理程序，`<img />`那么我只会在选择`Option2`或时隐藏图像`Option3`。从可用性的角度来看，我发现用户对禁用的 UI 项目感到困惑，所以我通常最终隐藏了他们无论如何都无法交互的控件。

您可以使用以下方法执行此操作。

```
$('#selID').on('change', function() {
    var value = $(this).val();
    if (value == 'Option2' || value == 'Option3') {
        $('.popButton').hide();   
    } else {
        $('.popButton').show();
    }
});​ 
```

**示例**- [http://jsfiddle.net/eNEeC/](http://jsfiddle.net/eNEeC/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-08T23:09:26.213

此代码将不起作用：

```
$("<div/>",{
    "html"  : "<img src='../Images/btnOff.png'>"
}); // <---- bad code…need help 
```

如果这应该创建一个 div 并附加一个孩子（img），那么方法应该是：

```
$('<div/>').html("<img src='../Images/btnOff.png'>"); 
```

上面的代码只会生成 div。您需要将其附加到它所属的页面。

例子：

```
var my_div = $('<div/>').html("<img src='../Images/btnOff.png'>");
$('body').append(my_div); 
```

# hibernate - OSGi 和 JNI 的类加载问题

> ID：11382509
> 
> 赞同：1
> 
> 时间：2012-07-08T10:44:52.680
> 
> 标签：hibernate, java-native-interface, log4j, classloader, apache-felix

我有一个 OSGi 应用程序，它可以从命令行启动并正常运行。然而，在生产环境中，这个应用程序必须从用 C 编写的小程序启动。这个程序检查许可证，做其他事情并使用 JNI 和我的应用程序启动 java 虚拟机。这样，我从 log4j 和休眠中得到了奇怪的错误（我启用了 -verbose:class JVM 标志）：

```
[Loaded org.apache.log4j.Appender from reference:file:/opt/dc/lib/log4j-1.2.15.jar]
[Loaded org.apache.log4j.Appender from file:/opt/dc/lib/log4j-1.2.15.jar]
...
[Loaded org.apache.log4j.RollingFileAppender from file:/opt/dc/lib/log4j-1.2.15.jar]
log4j:ERROR A "org.apache.log4j.RollingFileAppender" object is not assignable to a     "org.apache.log4j.Appender" variable.
log4j:ERROR The class "org.apache.log4j.Appender" was loaded by 
log4j:ERROR [org.apache.felix.framework.BundleWiringImpl@eafb71] whereas object of type 
log4j:ERROR "org.apache.log4j.RollingFileAppender" was loaded by [sun.misc.Launcher$AppClassLoader@1cde100].
log4j:ERROR Could not instantiate appender named "ROLLINGFILE".
...
[Loaded org.dom4j.DocumentFactory from reference:file:/opt/dc/lib/dom4j-1.6.1.jar]
...
[Loaded org.dom4j.DocumentFactory from file:/opt/dc/lib/dom4j-1.6.1.jar]
...
java.lang.ClassCastException: org.dom4j.DocumentFactory cannot be cast to     org.dom4j.DocumentFactory
    at org.dom4j.DocumentFactory.getInstance(DocumentFactory.java:97)
    at org.dom4j.io.DOMReader.<init>(DOMReader.java:38)
    at org.hibernate.util.XMLHelper.createDOMReader(XMLHelper.java:69)
    at org.hibernate.cfg.Configuration.configure(Configuration.java:1615)
    at org.hibernate.cfg.AnnotationConfiguration.configure(AnnotationConfiguration.java:1218) 
```

为什么这些类被加载两次？为什么有些是从 Felix 加载的，有些是从 Java 类加载器加载的？我怀疑一些本机代码在 OSGi 应用程序启动之前调用 java（例如日志记录），并且这些加载的类以某种方式被重用导致 ClassCastExceptions - 我如何证明或反驳这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T15:30:01.460

问题出在程序启动器内部。尽管只需要 Felix jar，但它正在将所有包添加到 JVM 的类路径中。

# jquery - 带有 jquery 的 IE 8 中的 PNG 显示为灰色

> ID：11382512
> 
> 赞同：2
> 
> 时间：2012-07-08T10:45:09.127
> 
> 标签：jquery, internet-explorer, png

我试图在悬停时找到这个可怕的灰色 png 的解决方案（这意味着透明的黄色，它似乎只在 IE 中显示为这样。我尝试的任何方法似乎都不起作用。任何帮助或提示都会非常方便。

这是jQuery。

```
 $('#header').hover(
function() {
$("#slideshow_bg").stop().animate({"opacity": "1"}, "fast");
},
function() {
$("#slideshow_bg").stop().animate({"opacity": "0"}, "fast");

});
}); 
```

这是html

```
<div id="header">

    <div id="ql_container" > 
        <span class="qltext">Our Systems</span>

            <div id="slidetabs">
                <a href="#">Therm Masonry</a>
                <a href="#">Concrete Block</a>
                <a href="#c">Precast Concrete</a>

            </div>

    </div>

    <!-- container for the slides -->
    <div class="images" style="float:left;">

        <!-- first slide -->
          <div class="slides" style="display:; position:absolute; background-image:url(03_building/02_concrete_block/02_IMAGES/02_HeroShot_1.jpg); width:779px; height:448px;" />
        <div id="slideshow_bg" style="opacity:;">

             <h2>lorem ipsum</H2>
             <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nam volutpat mauris in dolor egestas id iaculis tortor dignissim. Duis auctor dui vitae augue viverra pretium. Vestibulum ullamcorper iaculis tincidunt.</p>
             <p><a href="#"> Specifications</a> | <a href="#">Details</a></p>

      </div>
   </div>
</div>
</div> 
```

这是CSS

```
#slideshow_bg{
opacity : 0;
/* IE 8 */
-ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";
/* IE 5-7 */
filter: alpha(opacity=0);
zoom:1;
width:170px;
height:398px;
padding:25px 20px 25px 20px; 
position:absolute;
overflow:hidden;
background-image:url(../../images/slidesshow_desc_bg.png);
_background:none;
_filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src='../../images/slidesshow_desc_bg.png',sizingMethod='crop');
} 
```

我知道这可能看起来很乱，但是，任何帮助将不胜感激:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T21:21:55.907

您的 div 与类幻灯片有问题。显示属性有问题。它必须是这样的：

```
<div class="slides" style="position:absolute; 
    background-image:url(03_building/02_concrete_block/02_IMAGES/02_HeroShot_1.jpg);     
    width:779px; height:448px;" /> 
```

或者你给你的显示属性一个值。

此 div 相同：

```
<div id="slideshow_bg" style="opacity:;"> 
```

希望这能解决您的问题。让我知道。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-10T07:56:10.867

看一下z-index。您可以使用它将元素分层。

[单击此处获取有关 z-index 的一些信息](http://www.quackit.com/css/properties/css_z-index.cfm)

# iphone - 按下按钮从 UIView 切换到 UITableview

> ID：11382515
> 
> 赞同：-1
> 
> 时间：2012-07-08T10:45:35.083
> 
> 标签：iphone, ios, cocoa-touch

我制作了一个按钮并将其连接到界面生成器中的一个操作。从显示视图切换到显示表格视图的操作方法中我需要做什么？

这是我的一些代码：

```
//  SwitchToTableViewController.h

#import <UIKit/UIKit.h>

@interface SwitchToTableViewController : UIViewController {

}

-(IBAction) switch : (id) sender;

@end 
```

和

```
//SwitchToTableViewController.m
#import "SwitchToTableViewController.h"
#import "Table.h"
@implementation SwitchToTableViewController

-(IBAction) switch : (id) sender{

    // what is i need to write here to switch to tableview

}

@end 
```

和

```
//table.m
#import <UIKit/UIKit.h>

@interface Table : UITableViewController {

}

@end 
```

和

```
//table.h
#import "Table.h"

@implementation Table

#pragma mark Table view methods

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView {
    return 1;
}

// Customize the number of rows in the table view.
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {
    return 2;
}

// Customize the appearance of table view cells.
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {

    static NSString *CellIdentifier = @"Cell";

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
        cell = [[[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier] autorelease];
    }

    // Set up the cell...

    return cell;
}

@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T11:18:23.843

你需要：

1.  创建一个瞬间的表格。

2.  将任何数据传递到这一时刻，很可能是一个数组，以便您可以使用它来显示单元格数据。您需要先在 Table 类中创建一些 iVar。目前你没有。

3.  从多种方式中选择一种即时呈现您的表格。

查看 Apple 的[文档](http://developer.apple.com/library/ios/ipad/#documentation/uikit/reference/UITableViewController_Class/Reference/Reference.html)。它有相当多的示例代码。

编辑示例代码：

在您的`SwitchToTableViewController.h`文件中，添加以下行：

```
#import "Table.h" 
```

在您的`SwitchToTableViewController.m`中，进行此更改

```
-(IBAction) switch : (id) sender{

    // what is i need to write here to switch to tableview
    Table *myTable = [[Table alloc]init];
    myTable.cellArray = [NSArray arrayWithObjects:@"Item1", @"Item2", @"Item3", nil];  //only an example to be displayed
    [self presentViewController:myTable animated:YES completion:nil];  // present your Table - view controller

} 
```

您的`Table.h`文件应如下所示：

```
#import <UIKit/UIKit.h>

@interface Table : UITableViewController {

}
@property (nonatomic, strong) NSArray *cellArray;  // adding this line to get data from the parent
@end 
```

在您的`Table.m`中，进行此更改

```
@implementation Table

@synthesize cellArray;  //add this line right after @implementation Table

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    // Return the number of sections.
    return 1;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{

    // Return the number of rows in the section.
    return cellArray.count;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"Cell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    // Configure the cell...
    if (cell == nil)
    {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
        cell.textLabel.text = [cellArray objectAtIndex:indexPath.row];
    }

    return cell;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T12:05:28.617

您在这里有两个视图*控制器*，而不是两个视图。认识到这两个概念之间的区别非常重要。我在您需要阅读的其他关键词下方的答案中加粗。

要显示另一个视图控制器以响应按钮按下之类的操作，您需要创建目标视图控制器的新实例，然后以某种方式将其显示在屏幕上。

有很多方法可以做到这一点，但对于初学者来说，最简单的方法是在**storyboards**中完成所有这些。将两个视图控制器都添加到情节提要中。

您的初始视图控制器（带有按钮）应嵌入**UINavigationController**中。**按住 Control 从按钮拖动**到您的表格视图控制器。这将创建一个**segue**。从选项列表中选择“推送”。

嘿 presto，当您按下按钮时，您的表格视图现在将出现在屏幕上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-08T18:17:39.637

首先创建一个 SingleView 应用程序（基于 UIViewController），将其命名为 SwitchingView。

然后在视图上方添加一个 UITableView。使用接口生成器连接。将 tableview 的委托和数据源设置为 SwitchingView。

还要在视图上添加一个按钮（在添加表格视图之前）。使用 IB（界面生成器）隐藏设置表视图。

在按钮动作中

```
 tableview.hidden = NO; 
```

这将显示您的表格视图！！！如果你想再次显示视图，只需

```
 tableview.hidden = YES; 
```

在 tableView:didSelectForIndexPathRow 方法中。

# ruby-on-rails - Shopify Order API 是否允许按嵌套字段过滤？

> ID：11382519
> 
> 赞同：6
> 
> 时间：2012-07-08T10:46:16.253
> 
> 标签：ruby-on-rails, shopify

我正在使用`shopify_api`宝石。

[API 文档](http://api.shopify.com/order.html)显示您可以`ShopifyAPI::Order`通过告诉它返回哪些字段来缩小响应。例如，以下将仅返回`id`属性，而`shipping_address`属性

`ShopifyAPI::Order.find(:all, params: {fields: "id,shipping_address"})`

`shipping_address`恰好是其中包含多个字段的哈希。**是否可以指定要返回****的嵌套字段？`shipping_address`**例如

`ShopifyAPI::Order.find(:all, params: {fields: "id,shipping_address['country_code']"})`

这可能会返回类似

```
 #<ShopifyAPI::Order:0x0000010558b348 
    @attributes={
      "id"=>12345678, 
      "shipping_address"=>#<ShopifyAPI::ShippingAddress:0x0000010558aa88 
        @attributes={"country_code"=>"US"}, 
        @prefix_options={}, 
        @persisted=false>
      }, 
    @prefix_options={}, 
    @persisted=true> 
```

我知道我可以自己挑选出这些属性（`order.shipping_address.country_code`），但这更符合“精简”响应的利益。

*额外问题 1：*`fields`使用参数的可感知优势是什么？

*额外问题 2：* Shopify 什么时候（如果有的话）可能会返回零送货地址？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-08T11:58:16.327

通常最好为每个问题单独发布，但这里有答案。

1.  不。
2.  如果您限制返回的数据，则生成响应所需的时间会更少，通过网络传输的数据也会更少，解析的数据也会更少。这意味着您应该更快地进行操作。这取决于许多不同的因素，很难说您将获得多少性能提升。我的感觉是，除非您执行大量请求，否则它是微乎其微的。
3.  如果订单（即所有订单项）不需要送货，送货地址可能为空。

# html - 如何删除填充/边距并使 div 占据所有空间？

> ID：11382520
> 
> 赞同：0
> 
> 时间：2012-07-08T10:46:18.920
> 
> 标签：html, css, twitter-bootstrap

这个问题可能听起来有点……愚蠢。但我有点卡住了。

我正在使用 Twitter 引导程序。我的测试代码是：

```
<div class="container-fluid">
    <div class="row-fluid">
            <div class="span3" style="background:#eee; border:1px solid blue;">

            <ul class="nav nav-list">
            <!-- List contents -->
            </ul>

            </div><!--/span-->
            <div class="span9" style='background:#fff; padding-left:10px; border:1px solid red'>
                <div class="hero-unit">
                        <h1>Hello, world!</h1>
                        <p>This is a template for a simple marketing or informational website...</p>
                        <p><a class="btn btn-primary btn-large">Learn more &raquo;</a></p>
                </div>
                <div class="row-fluid">
                    <!-- The content -->

                </div><!--/row-->
        </div>
    </div>
</div> 
```

这就是它的样子（我使用彩色边框向您展示 2 个 div 中的每一个在哪里）：

![在此处输入图像描述](../Images/de0a6732f0154b5d845c2233cb3c77fa.png)

**现在，我的问题是：**

有什么办法可以让第二个红色边框的 div ( `span9`) 占据整个最右边的列（周围没有任何边距），因此最终结果如下所示：

*   左侧的控制面板（带有灰色背景的一整列）
*   最右边的 div （占用所有剩余空间，白色背景）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T14:16:07.500

我对 twitter bootstrap 没有太多经验，但我假设答案是查看“row-fluid”类的 css 属性并检查边距和宽度。

边距：0 自动；将删除任何边距（div 外部周围的空间）并将其居中放置在容器中

如果 ^ 已经为真，则宽度=50%；（如果你要同时拥有两者）

希望有帮助！

# ruby-on-rails - 使用参数渲染动作

> ID：11382521
> 
> 赞同：0
> 
> 时间：2012-07-08T10:46:42.913
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我有这个问题。我有更新产品的编辑视图，这里是我在 product_controller 中的操作

```
 def edit_product

    @product = Product.find(params[:product][:id])

    respond_to do |format|
      if @product.update_attributes(params[:product])
        format.html { render action: "edit_product"  }
      else

        format.html { render action: "edit" }
        format.json { render json: @product.errors, status: :unprocessable_entity }
      end
    end

  end 
```

问题是，当我调用编辑视图时，我通过了 id_product 而现在我不能在渲染操作中，它给出了错误

如何解决它并呈现类似 edit?id_product= ??

这是我的产品资源

```
 resources :products, :only => [:index] do
    collection do
      post 'new_product'
      post 'edit_product'
    end    
  end 
```

# android - 如何在启动应用程序时在 android 中启动特定活动

> ID：11382522
> 
> 赞同：0
> 
> 时间：2012-07-08T10:47:05.467
> 
> 标签：android, database

我正在做的是，如果数据库有 0 行，那么 start`activity1`否则 start `activity2`。

那么这怎么可能呢？我收到错误，应用程序每次都崩溃。
我使用了 if-else，但它不起作用。
请帮忙。

这是代码：

```
if (db.fetchnumber(1) == null) 
{
    super.onCreate(savedInstanceState); 
    setContentView(R.layout.main); 
} else {
    super.onCreate(savedInstanceState);
    Intent i = new Intent(this,activity2.class);    
    startActivity(i); 
} 
```

`fetchnumber`方法是：

```
public String fetchnumber(long rowID) throws SQLException
{
    String selectQuery = "SELECT " + PHONE_NUMBER + " FROM " + DATABASE_TABLE + " where " + KEY_ROWID + " = 1 ;"

    SQLiteDatabase db = this.getReadableDatabase();
    Cursor csr = db.query(DATABASE_TABLE, new String[] { KEY_ROWID, PHONE_NUMBER }, KEY_ROWID + "=" + rowID ,null, 
            null,null,null,null);
    String str = null;
    if (csr != null)
    {  
        csr.moveToFirst();
    str = csr.getString(1);
    }

    return str;

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T10:53:04.910

请按照以下步骤操作。

1）创建一个活动（在清单中注册它......在其清单中设置启动器和主标签）

2）在第一步中，您现在创建了一个主要活动，说活动 A

3）在A的`onCreate()`方法中获取你的数据库方法来查看数据库是否有一些值。

4) 如果 db 在步骤 3 中返回 null，您可以启动 activity1，否则您可以启动 activity2。

开始一个活动使用`startActivity(intent)`方法

要读取数据库行，您可以查看`cursor.getCount()`哪个返回游标指向的表中的行数。

您的代码应如下所示

```
public class MainActivity extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState); 
        setContentView(R.layout.main); 
        DatabaseClass db = new DatabasClass(this);

        if(db.fetchDB() == null)
            StartActivity(intent1);
        else
            startActivity(intent2);

    }

} 
```

# java - 实现“三角形内检查点”算法时的错误

> ID：11382523
> 
> 赞同：6
> 
> 时间：2012-07-08T10:47:14.070
> 
> 标签：java, algorithm, collision-detection

我正在按照[本文](http://www.sunshine2k.de/stuff/Java/PointInTriangle/PointInTriangle.html)中的算法 1来检查一个点是否在三角形内。这是我的代码：

```
//========================================================================================================================//
// Methods
//========================================================================================================================//

private float getPerpDotProduct(final PointF p1, final PointF p2) {
    return p1.x * p2.y - p1.y * p2.x;
}

private boolean isInside(final PointF pPoint) { 
    final float c1 = this.getPerpDotProduct(this.mA, pPoint);
    final float c2 = this.getPerpDotProduct(this.mB, pPoint);
    final float c3 = this.getPerpDotProduct(this.mC, pPoint);

    return ((c1 >= 0 && c2 >= 0 & c3 >= 0) || (c1 <= 0 && c2 <= 0 && c3 <= 0));
} 
```

这是我的测试： ![在此处输入图像描述](../Images/ffbc9af3fff6dc58ad9f5731f27ae4a8.png)

青色区域：我给出的真实三角形。

粉色区域：三角形“内部”

蓝色区域：三角形“外部”

**编辑：**

这是我用向量计算的新代码：

```
private PointF getVector(final PointF pPoint1, final PointF pPoint2) {
    return new PointF(pPoint2.x - pPoint1.x, pPoint2.y - pPoint1.y);
}

private float getPerpDotProduct(final PointF p1, final PointF p2) {
    return p1.x * p2.y - p1.y * p2.x;
}

private boolean isInside(final PointF pPoint) { 
    final float c1 = this.getPerpDotProduct(getVector(this.mA, this.mB), getVector(this.mA, pPoint));
    final float c2 = this.getPerpDotProduct(getVector(this.mB, this.mC), getVector(this.mB, pPoint));
    final float c3 = this.getPerpDotProduct(getVector(this.mC, this.mA), getVector(this.mC, pPoint));

    return ((c1 > 0 && c2 > 0 & c3 > 0) || (c1 < 0 && c2 < 0 && c3 < 0));
} 
```

请澄清我的代码。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T11:19:08.540

文章对需要做的事情的描述中有一个“错误”：

> 计算所有三个点 V1、V2、V3 与测试点 P 的 perpDotProduct/crossproduct

应该是“计算所有三个**向量**的 perpDotProduct/crossproduct向量到测试点 P”。

`true`如文章中所述，如果所有三个点从原点（图片的左上角）在相同的“角度方向”上可见，则算法返回。您的图片也准确地显示了它：`(0, p)`所有粉红色点的矢量如果位于蓝色区域上方，则需要顺时针旋转才能到达三角形；如果它们低于蓝色区域，则矢量需要逆时针移动。

要修复算法，您需要计算向量`{(V1-V2), (V1-P)}`、`{(V2-V3), (V2-P)}`和的叉积`{(V3-V1), (V3-P)}`。看看[这篇文章](http://www.blackpawn.com/texts/pointinpoly/default.html)的伪代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T11:37:44.160

我通常使用重心坐标进行这样的数学运算：（考虑 4 个点，其中 p1,p2,p3 是三角形，p4 是您要检查的点：将 (p1,p3) 视为向量 p1 -> p3

```
dot00 = (p1,p3).(p1,p3)
dot01 = (p1,p3).(p1,p2)
dot02 = (p1,p3).(p1,p4)
dot11 = (p1,p2).(p1,p2)
dot12 = (p1,p2).(p1,p4)

inverseDenominator = (1 / (dot00*dot11 - dot01*dot01)

u = (dot11 * dot02 - dot01*dot12) * inverseDenominator
v = (dot00 * dot12 - dot01*dot02) * inverseDenominator 
```

现在我们已经计算了重心坐标，验证很简单，如果 P4 位于三角形 (P1,P2,P3)$ 内，那么它们必须都是正数`u`并且`v`加起来必须小于 1：

```
u >= 0 && v >= 0 && u + v < 1 
```

这是我在做论文时学习如何做到这一点的文章：http: [//www.blackpawn.com/texts/pointinpoly/default.html](http://www.blackpawn.com/texts/pointinpoly/default.html) （你会发现与变量名的相似之处：p）

# actionscript-3 - 使用 OSMF 检测 VOD 流的结束？

> ID：11382525
> 
> 赞同：1
> 
> 时间：2012-07-08T10:47:23.193
> 
> 标签：actionscript-3, streaming, osmf, akamai

我有事件监听器：

```
mediaPlayerSprite.mediaPlayer.addEventListener(MediaPlayerStateChangeEvent.MEDIA_PLAYER_STATE_CHANGE, playerStateChange); 
```

但这似乎并没有表明流已经结束......即根据： [http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/org/osmf/media/MediaPlayerState。 html](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/org/osmf/media/MediaPlayerState.html)

Stream Ended 没有事件......那么你如何可靠地检测到这一点？

如果它是相关的，我正在使用 Akamai 高级插件

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T15:33:18.017

明白了......这是 TimeEvent.COMPLETE :)

# php - 用php搜索和替换base64图像字符串

> ID：11382530
> 
> 赞同：2
> 
> 时间：2012-07-08T10:48:20.137
> 
> 标签：php, image, replace

我有一个从数据库中获取的 HTML 字符串。该字符串有几个base64图像，我需要用应该从base64图像字符串生成的图像文件替换它们。我不知道我该怎么做。任何指针将不胜感激。

**原始 html**

<img width="217" height="113" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAY4AAADPCAYAAADidzYBAAASK0lEQVR4nO3dXYxc5X3H8e+FL3zhC69kyb5AsApVy0VAaBUJalGVl0ogQBVClpqoSYtcK4I2QkjEShAJ2hCpRKXEdbFKJUJDGingIGqRpEAbE0zqZNPSlJbIwSHlxRBMKcSYF7+vPb347+mcmZ3dnbN75jxzzvl+pEdaz779PT7j35zz/M/zgCRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiSp5iaA6b5xZbJqpHJcSe8xPZGwFqlxzgVm6H2R7cQXmuprEthG93jeDtyarhypec4lXmR5eow4I1FN/C+24CqNLxPH3vmpC2m4NUTr7XmpC1lAPkBOYoCMvYuJd3y24CqF49iCW4VPEneGjzsDpCb+GVtwlUbWgntr6kJa4LvAdSX9rLuJe0C2MbpJdgNkjK0jzjZswVUKb+GxV4V1wJvEyhArdRWxrtVZwPeJ1XRHaRNxB7oBMkayO8UfTl2IWifr5HssdSEt8BkG37exGZieGxO5x6dzY6r/JKYGPCY1kcEhSSrE4JAkFTKJq3pIkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkqTC/g9W561Faz0ASAAAAABJRU5ErkJggg== ">

**预期的html**

<img width="217" height="113" src="images/image_from_png.png">

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-08T10:55:09.603

```
echo preg_replace_callback('#(<img\s(?>(?!src=)[^>])*?src=")data:image/(gif|png|jpeg);base64,([\w=+/]++)("[^>]*>)#', "data_to_img", $content);

function data_to_img($match) {
    list(, $img, $type, $base64, $end) = $match;

    $bin = base64_decode($base64);
    $md5 = md5($bin);   // generate a new temporary filename
    $fn = "tmp/img/$md5.$type";
    file_exists($fn) or file_put_contents($fn, $bin);

    return "$img$fn$end";  // new <img> tag
} 
```

# ios - 任何人都可以让 FMDB 与 Rubymotion 一起工作吗？

> ID：11382532
> 
> 赞同：0
> 
> 时间：2012-07-08T10:48:40.683
> 
> 标签：ios, fmdb, rubymotion

我正在尝试让 FMDB 与 Rubymotion 一起使用，但每次我尝试构建应用程序时都会收到此错误：

```
FMDBTest(master):rake
     Build ./build/iPhoneSimulator-5.1-Development
     Build vendor/Pods
      Link ./build/iPhoneSimulator-5.1-Development/FMDBTest.app/FMDBTest
ld: duplicate symbol _main in ./build/iPhoneSimulator-5.1-Development/objs/main.o and /Users/Bodacious/Apps/FMDBTest/vendor/Pods/build-iPhoneSimulator/libPods.a(fmdb.o) for architecture i386 
```

这是我用来测试的应用程序：[https ://github.com/Bodacious/FMDBTest](https://github.com/Bodacious/FMDBTest)

其他人有这个工作吗？：/

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T11:38:18.540

我不知道 RubyMotion，但在我将 FMDB 包含到项目中时遇到了类似的问题。最重要的是，从您的构建中排除 fmdb.m。它有自己的 main() 函数，这对测试很有用，但是当它包含在项目中时，它会给你这样的错误。您需要 FMDB 类，但不需要 fmdb.m。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T02:45:14.850

我已经为使用 FMBD 的 MotionModel 构建了一个类似 ActiveRecord 的适配器。截至目前，它可以在[https://github.com/aceofspades/MotionModel/commits/sql](https://github.com/aceofspades/MotionModel/commits/sql)找到。

# python - 在文件中搜索一个变量并用python获取它的值

> ID：11382536
> 
> 赞同：2
> 
> 时间：2012-07-08T10:49:13.427
> 
> 标签：python

我想要一些存储在文件（文本文件或 yaml 文件）中的变量

例如，如果我将这些变量存储在文件中

```
employee = ['Tom', 'Bob','Anny']
salary = 200
managers = ['Saly','Alice'] 
```

我希望用户输入列表名称或变量名称，例如

如果用户输入员工并想要对列表值进行一些操作，以便用户应该访问`employee[0]`，`employee[1]`....等

我如何编写一个 python 脚本，它将去文件搜索正确的变量并让用户访问它的值

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-08T11:02:42.263

就像@Levon 所说的那样，有几种方法可以让你做到这一点，最好的方法取决于你的问题背景。例如，你可以

1.  通过格式化文件自己读取文件，例如，通过文件中的分隔符“=”
2.  使用数据库来存储您的数据
3.  使用 pickle 或 shelve 序列化您的变量并稍后取回它们。
4.  将变量放在 python 模块中并导入它

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T13:26:39.340

假设您的文件内容有些一致，这种方法可能是一种方法：

**更新：**我添加了解析以前未提供的列表所需的代码。

代码获取文件中的所有数据并将其分配给适当类型的变量（即浮点数和列表）。列表解析不是特别漂亮，但它很实用。

```
import re
with open('data.txt') as inf:
    salary = 0
    for line in inf:
        line = line.split('=')
        line[0] = line[0].strip()
        if line[0] == 'employee':
            employee = re.sub(r'[]\[\' ]','', line[1].strip()).split(',')
        elif line[0] == 'salary':
            salary = float(line[1])
        elif line[0] == 'managers':
            managers = re.sub(r'[]\[\' ]','', line[1].strip()).split(',')

print employee
print salary
print managers 
```

产量：

```
['Tom', 'Bob', 'Anny']
200.0
['Saly', 'Alice'] 
```

# android - 切换 ChoiceMode 时 Android ListView 选择更改的问题

> ID：11382539
> 
> 赞同：1
> 
> 时间：2012-07-08T10:49:50.077
> 
> 标签：android, listview, selection

我在尝试清除 ListView 中项目的选择（选择）时遇到了一个奇怪的行为。该代码运行良好，其功能允许（在 CHOICE_MODE_MULTIPLE 中一次）通过点击、全选、全选和反转当前选择来选择单个项目。由于 ListView 应该在两种模式（_NONE 和 _MULTIPLE）下工作，我有这个菜单项可以在这些模式之间切换，允许用户“打开”一个项目或一次选择多个项目进行批处理操作。

我面临的问题仅在将选择模式从 CHOICE_MODE_MULTIPLE 更改回 CHOICE_MODE_NONE 时出现。我要做的不仅是恢复到 CHOICE_MODE_NONE，而且还要清除任何选择。奇怪的是，虽然所有函数都可靠地工作，但当我在更改回 CHOICE_MODE_NONE 之前调用“select non”函数时，所有项目都保持选中状态，无论我在代码中何时何地调用“select none”函数。

处理选择更改的函数如下：

```
private void changeItemSelection(int selection) {
    NotesAdapter adapter = (NotesAdapter)listView.getAdapter();

    if (selection == SELECT_ALL) {
        for(int iCount = 0; iCount < adapter.getCount(); iCount++) {
            listView.setItemChecked(iCount, true);
        }
    }
    else if (selection == SELECT_NONE) {
        for(int iCount = 0; iCount < adapter.getCount(); iCount++) {
            listView.setItemChecked(iCount, false);
        }
    }
    else if (selection == SELECT_INVERT) {
        for(int iCount = 0; iCount < adapter.getCount(); iCount++) {
            listView.setItemChecked(iCount, !listView.isItemChecked(iCount));
        }       
    }
    adapter.notifyDataSetChanged();
    checkedItemCountInvalid = true; // Invalidate checked indices cache
} 
```

这是当用户点击切换选择模式的菜单项时发生的情况：

```
@Override
public boolean onOptionsItemSelected(MenuItem item) {
    switch (item.getItemId()) {
        case R.id.menu_multisel:
            toggleSelectionMode();
            return true;                
        default:
            return super.onOptionsItemSelected(item);        
    }
}

private void toggleSelectionMode() {
    if (listView.getChoiceMode() == ListView.CHOICE_MODE_NONE) {
        listView.setChoiceMode(ListView.CHOICE_MODE_MULTIPLE);
    }
    else {
        listView.setChoiceMode(ListView.CHOICE_MODE_NONE);
    }       
    changeItemSelection(SELECT_NONE);
} 
```

无论我将“changeItemSelection(SELECT_NONE)”放在上面的代码块中的哪个位置，它都无法正常工作。但是当我删除“listView.setChoiceMode(ListView.CHOICE_MODE_NONE)”时，它神奇地开始按预期工作。这让我发疯了......我真的很感激对此的任何见解。

谢谢阅读！

编辑：我所说的“不工作”是指选择保持不变。因此，如果 item1 和 item3 被选中，调用 select none 不会取消选中它们，但只有当我在上面提到的代码部分调用函数时。在不尝试更改选择模式的情况下调用 select none 效果很好。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-06T17:32:11.793

我遇到同样的问题。似乎已经有[相关问题](https://stackoverflow.com/questions/9754170/listview-selection-remains-persistent-after-exiting-choice-mode)的答案表明它是 Android 中的一个错误。

*我想这应该是评论，而不是回答。但我只是没有足够的声誉在这里发表评论。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-12T16:09:06.323

我不知道你是否已经解决了这个问题，所以这个答案可能为时已晚。

我认为，如果您在将选择模式设置回无（然后调用您的方法以清除检查）之前尝试使用[clearChoices()](http://developer.android.com/reference/android/widget/AbsListView.html#clearChoices%28%29)，它将按您的意愿工作。

```
private void toggleSelectionMode() { 
    if (listView.getChoiceMode() == ListView.CHOICE_MODE_NONE) { 
        listView.setChoiceMode(ListView.CHOICE_MODE_MULTIPLE); 
    } 
    else { 
        listview.clearChoices();
        listView.setChoiceMode(ListView.CHOICE_MODE_NONE); 
    }        
    changeItemSelection(SELECT_NONE); 
} 
```

# c# - 在添加后台传输请求之前检查文件大小

> ID：11382541
> 
> 赞同：2
> 
> 时间：2012-07-08T10:50:07.937
> 
> 标签：c#, silverlight, windows-phone-7, networking, download

我是新手，我正在开发后台传输功能来下载文件。它适用于 windows phone 7。但问题是无法使用“传输首选项 = 允许电池”下载超过 100 MB 的文件，如果我使用“传输首选项 = 无”，则手机必须连接到电源才能传输（任何文件大小）。到目前为止，这是我尝试过的，但它不适用于超过 100MB 的文件。任何帮助或建议都会很棒。谢谢！

```
 private void downloadTrigger()
    {
        string transferFileName = urlTextBox.Text;
        var transferUri = new Uri(Uri.EscapeUriString(transferFileName), UriKind.Absolute);

        BackgroundTransferRequest transferRequest = new BackgroundTransferRequest(transferUri);
        transferRequest.Method = "GET";

        string downloadFile = transferFileName.Substring(transferFileName.LastIndexOf("/") + 1);
        Uri downloadUri = new Uri("shared/transfers/" + downloadFile, UriKind.Relative);
        transferRequest.DownloadLocation = downloadUri;
        transferRequest.Tag = downloadFile;

        if (transferRequest.TotalBytesToReceive >= 104857600)
        {
            try
            {
                transferRequest.TransferPreferences = TransferPreferences.None;
                MessageBox.Show("For files over 100MB an external power is required to start copy.", "News box", MessageBoxButton.OK);
                BackgroundTransferService.Add(transferRequest);
                feedbackTextBlock.Text = "Queueing " + downloadFile;
                return;
            }
            catch
            {
            }
        }

        try
        {
            transferRequest.TransferPreferences = TransferPreferences.AllowBattery;
            BackgroundTransferService.Add(transferRequest);
            feedbackTextBlock.Text = "Copying " + downloadFile;
        }
        catch
        {
        }
    } 
```

# github - GitHub 页面自定义域无限重定向循环

> ID：11382544
> 
> 赞同：15
> 
> 时间：2012-07-08T10:50:54.747
> 
> 标签：github, dns, jekyll, github-pages

我正在尝试使用 github 页面设置自定义 TLD 域，这绝对是一场噩梦。出于某种原因，在无限重定向循环中一遍又一遍地`http://www`重定向到`http://`然后再返回。`http://www`

我的 123-reg 设置是：

```
DNS ENTRY   TYPE        TARGET/DESTINATION
@           A           204.232.175.78        
www         CNAME       scottyv.me. 
```

我在我的仓库中正确设置了 CNAME 文件。有人可以告诉我我做错了什么吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-22T21:08:33.573

不确定你是否已经解决了这个问题，但我在重定向和 123-reg 方面遇到了类似的问题。我认为您缺少的是另一个“www” DNS 条目，它指向为 DNS 条目“@”定义的 IP 地址。

[我写了一篇关于它的快速博客文章，带有一些图片](http://donalfarrell.com/2012/07/13/Setting-up-GitHub-redirects.html)

希望这可以帮助。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2017-11-14T15:07:16.570

我有一个类似的问题。就我而言，我的 DNS 是正确的（网络解决方案），但我在 CNAME 文件中遗漏了“www”。我有“yoursite.com”而不是“www.yoursite.com”。一旦我添加了“www”，无限重定向就被修复了。

# c++ - 在 C++ 中的参数列表中实例化的对象的内存管理

> ID：11382547
> 
> 赞同：1
> 
> 时间：2012-07-08T10:51:29.890
> 
> 标签：c++, memory-leaks, instantiation

如果我在参数列表中实例化对象而不使用 new 关键字，我会得到内存泄漏吗？例如，我有一个 tile 类：

```
// tile.h (too small for implementation)
class Tile {
  public:
    enum Type {
        TYPE_NONE = 0,
        TYPE_NORMAL,
        TYPE_BLOCK
    };

    inline Tile(const int id, const Type type) : id_(id), type_(type) {};
    inline int id() const { return id_; };
    inline Type type() const { return type_; };

  private:
    int id_;
    Type type_;
}; 
```

稍后我将加载文本文件中指定的一些图块：

```
// ...
int tile_id;
Tile::Type tile_type;
fscanf(file_handle, "%d:%d ", &tile_id, &tile_type);
tile_list_.push_back(Tile(tile_id, tile_type)); // this is the line of interest
// ... 
```

这似乎有效。`Tile(tile_id, tile_type)`是我不确定的部分，我不知道它最终是堆栈还是堆。`tile_list_`是一个`std::vector<Tile>`，到目前为止我假设它会处理`Tile`我传递给它的对象的内存。它是否正确？

现在我正在考虑在其他地方创建一个可以将类似实例化的对象作为参数的方法。这在参数列表中看起来如何，在方法和调用代码中必须做什么以确保没有内存泄漏？

PS 也欢迎任何关于代码风格的评论，我觉得 Tile 作为一个结构可能会更好，所以特别欢迎对此发表评论。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-08T10:53:00.143

您不会有内存泄漏，并且对象将在表达式之后被销毁。

```
tile_list_.push_back(Tile(tile_id, tile_type)); 
```

它的副本被插入到向量中。*理论上*。实际上，在这种情况下可能会发生复制省略，但这无关紧要，我只是为了答案的完整性而说明这一点。

一般来说，如果你不使用`new`or `malloc`，你就不会发生内存泄漏，除非你当然使用了一个在后端分配内存并且不使用 RAII 的糟糕库。但这里不是这种情况，因为您使用的是`std`.

# authentication - 使用 OAUTH HOTP 在窗口中生成重复 OTP 的概率？

> ID：11382548
> 
> 赞同：1
> 
> 时间：2012-07-08T10:51:43.617
> 
> 标签：authentication

我正在使用 HOTP 为第二因素身份验证生成 OTP。如果客户端和服务器的计数器不匹配，我正在使用基于事件的 OTP 生成并提供 10 次迭代的窗口。

但是，有人问我，如果在任何时间点从过去重新生成 OTP 会发生什么。

由于 OTP 是一个 6 位数字，因此可能只有 999999 种组合可供用户使用。因此，OTP 在生命周期中不可能是唯一的，它会在某个时间点重新生成。当一个特定的 OTP 重复时，会不会有一种模式？

此外，如果在 10 的窗口大小内重新生成 OTP，情况可能会更糟，因为它容易受到重放攻击。

请指导我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T16:50:11.740

[不，如果您不使用随机性](http://en.wikipedia.org/wiki/One-time_password#How_OTPs_are_generated_and_distributed)知道密钥，则不应该存在重复的可预测模式（否则将是算法中的一个重要发现和缺陷）。

尽管您可以容忍 10 的窗口大小，但只能容忍这种情况。永远不要接受小于最后确认计数器的令牌，否则您将打开重放攻击。

当然，HOTP、TOTP 或其他任何东西都不能免受所有形式的攻击，因此您需要一种多层方法来确保您的安全，这种方法在攻击向量与防御成本方面是现实的。

最好在[这里](https://security.stackexchange.com/)进行更深入的讨论。在这个答案中，我试图坚持实施问题。

# java - 如何在 Android 中验证用户输入？

> ID：11382554
> 
> 赞同：2
> 
> 时间：2012-07-08T10:52:53.580
> 
> 标签：java, android, regex

我有一个简单的 EditText，用户可以在其中插入三个用逗号分隔的值。例如，我可以有以下模板：

```
value1, value2, value3 
```

其中 value1, value2 是 double 类型， value3 是整数。

如何验证用户是否根据此模板输入了文本？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-08T10:56:33.383

使用正则表达式[`Matcher`](http://developer.android.com/reference/java/util/regex/Matcher.html)。

```
final String DOUBLE = "\\d+(?:\\.\\d+)?";
final Pattern PATTERN = Pattern.compile(DOUBLE + ", " + DOUBLE + ", \\d+");
Matcher matcher = PATTERN.matcher(textView.getText().toString());
if (!matcher.matches()) {
    // invalid input
} 
```

# c# - Windows 窗体应用程序中的 WPF 用户控件和 Windows 窗体用户控件

> ID：11382557
> 
> 赞同：1
> 
> 时间：2012-07-08T10:53:18.300
> 
> 标签：c#, wpf-controls

我是 WPF 新手，所以我有一个问题。

我有一个 Windows 应用程序项目，其中包含一个 WPF UserContorl（称为 PaintingArea），它必须与一个 WindowsFormUserControl（称为 Keyboard）进行通信。

“PaintingArea”使用 ElementHost1 托管在父窗体中。现在，当我在“PaintingArea”中完成一个文本框的绘制时，“键盘”将不得不出现。

无论如何，我可以让“PaintingArea”调用（调用）“键盘”（WPF UserControl 调用 WindowsFormUserControl）吗？和虎钳verca？

我应该使用事件处理程序吗？如何？

或者将“键盘”转换为 wpf UserControl，然后尝试从“PaintingArea”调用它（一个 WPF UserControl 调用另一个 WPF UserControl）？如何？

进行此类沟通的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T12:36:09.707

如果您希望在 Windows 窗体应用程序中托管 WPF 用户控件，您可以使用控件[ElementHost](http://msdn.microsoft.com/en-us/library/system.windows.forms.integration.elementhost.aspx)。此控件有一个名为 Child 的属性，您可以将 UIElement 的实例分配给该属性。

此外，如果您正在寻找好的示例，[Code Project](http://www.codeproject.com/Articles/26311/Integrate-WPF-UserControls-in-WinForms)有一个。

# git - 如果远程根本不存在，如何 git 推送到远程

> ID：11382565
> 
> 赞同：10
> 
> 时间：2012-07-08T10:55:12.490
> 
> 标签：git

如果远程（使用 ssh）不包含 git 存储库，是否仍然可以将本地存储库复制到远程并设置远程跟踪，而无需使用 scp 手动复制文件，然后执行 git clone？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-08T11:01:14.427

您*确实*需要在远程设置存储库，但不应手动复制文件。至少，你不会得到它的历史。

首先，通过 ssh 连接到您的遥控器并执行以下操作：

```
mkdir your_repo.git
cd your_repo.git
git init --bare 
```

`.git`in 目录名称是完全可选的。该`--bare`选项使存储库没有索引，因此是可推送的。

然后，您返回本地存储库并添加远程：

```
git remote add remote_name user@remote.address:path/to/your_repo.git 
```

你都准备好了。您现在需要做的就是：

```
git push remote_name 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-08T10:58:43.133

> 是否仍然可以将本地存储库复制到远程并设置远程跟踪，而无需使用 scp 手动复制文件，然后执行 git clone？

如果您有 ssh 访问权限，则可以复制 repo（是的，使用 a `scp`），但只复制*一个*文件： a **[`git bundle`](https://stackoverflow.com/questions/2129214/backup-a-local-git-repository/2129286#2129286)**。

从那里，您可以将该捆绑包*克隆*为远程服务器上的裸存储库（一个文件充当您可以克隆的存储库）并将其用作远程存储库（您可以推送到远程裸存储库）。

与直接推送到空的裸存储库相比，优势在于这里的初始副本是一个文件。对于大型存储库，这可以使初始化更容易/更少依赖网络。

# python - 在共享托管服务器上设置 Django 应用程序

> ID：11382569
> 
> 赞同：0
> 
> 时间：2012-07-08T10:55:25.970
> 
> 标签：python, django, apache, shared-hosting

好的，所以我有共享主机，所以这意味着我几乎无法访问任何东西，所以我在设置我的 django 应用程序时遇到了问题。

查看谷歌搜索有一种方法可以使用 .htaccess 和 .wgsi 文件，但我没有运气。由于我通常使用 php，因此我对此类事情的了解很少。

到目前为止，我已经在 htaccess 文件中添加了一些代码，但它总是出现这个错误..

未找到 在此服务器上未找到请求的 URL /dispatch.wsgi/。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-14T14:37:59.253

你应该看看这个：

在 django 文档的这一**[部分中，](http://www.djangobook.com/en/2.0/chapter12.html#running-django-on-a-shared-hosting-provider-with-apache)**他们解释了如何:)

> 使用 Apache 在共享主机提供商上运行 Django 许多共享主机提供商不允许您运行自己的服务器守护进程或编辑 httpd.conf 文件。在这些情况下，仍然可以使用 Web 服务器生成的进程来运行 Django。

祝你今天过得愉快 ：）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T00:03:38.437

你有`dispatch.wsgi`具体的路径吗？它应该位于为您的静态文件提供服务的公用文件夹之类的地方，例如`/public_html`or `/www`。

我已经从一个小橙子中为 django 使用了共享主机。我按照他们的[这个教程](https://help.asmallorange.com/index.php?/Knowledgebase/Article/View/140)开始工作，也许也为你工作。

# php - 在 cookie 中存储数组

> ID：11382571
> 
> 赞同：4
> 
> 时间：2012-07-08T10:55:42.853
> 
> 标签：php, arrays, cookies

我需要在 cookie 中存储一些数组数据，我一直在研究最好的方法，很多人似乎说使用`serialize`是要走的路，但是在这个线程中：

[PHP如何将数组字符串化并存储在cookie中](https://stackoverflow.com/questions/4672130/php-how-to-stringify-array-and-store-in-cookie)

..有人建议不要将其用作“序列化将调用序列化类的构造函数。这很糟糕，因为它会导致代码执行。”

所以我想知道我还有什么其他选择？怎么样`base64_encode`？

我不能使用`sessions`，因为我需要在浏览器关闭后保留数据；虽然我也担心 Cookies`4KB`限制。

FWIW我正在存储存储在某人购物车中的购物车数据，当他们回来时需要将其加载回他们的购物车中。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-08T10:57:34.360

如何生成一个唯一 ID，将其存储在 cookie 中，并将序列化数组和 ID 存储在数据库中？

例子：

```
// ------------ STORING TO COOKIE AND DATABASE ------------ //
$id = uniqid();
setcookie("id", $id, time()+60*60*24); // 1 day

$serialized = serialize($array);
mysql_query("INSERT INTO yourTable (id, array) VALUES ('$id', '$serialized')");

// ------------ SELECTING FROM DATABASE ------------ //
if(!isset($_COOKIE['id'])) die();
$id = mysql_real_escape_string($_COOKIE['id']);

$result = mysql_query("SELECT array FROM yourTable WHERE id = $id LIMIT 1");
if(!is_resource($result)) die();
$serialized = mysql_result($result, 0);
$array = unserialize($serialized); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-08T11:05:48.550

扩展先前的评论和答案，您应该非常努力地避免将**数据**存储在 cookie 中，而不是**指向 data 的指针**，例如指向数据库行的 ID。

假设所有客户端都是敌人（我认为这是合理的假设），一个错误的 cookie - 无论是恶意的还是简单的错误 - 如果它只包含一个指针，它将无法造成太大的伤害：

*   无效：默默放下
*   错误：通过将 ID 与请求它的用户进行比较来检查；如果是的话，默默地放下它
*   有效的; 用它

我个人更喜欢静默丢弃错误消息，因为我有直觉，这可能会让极少数真正恶意的用户更难。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-08T11:04:34.767

Cookie 不是存储用户数据的最佳方式 用户必须在您的站点上获得授权，并且所有数据必须通过 user_id 存储在数据库中

# java - JTable 和 DefaultTableModel

> ID：11382572
> 
> 赞同：4
> 
> 时间：2012-07-08T10:55:51.403
> 
> 标签：java, mysql, swing, jtable, defaulttablemodel

我有一个从本地 MySQL 服务器获取信息的表。它可以很好地读取数据并将其发布在 GUI 上。

我的问题是，当我更改表命令时如何刷新表，例如：

```
private String sql = "select * from profildb.tbl_detailed";  //to
private String sql = "select * from profildb.tbl_detailed where Y.."; //this 
```

此操作将在我的 Button Action Listener 中处理；

```
 JButton btnOK = new JButton("");
    btnOK.addActionListener(new ActionListener() {
        public void actionPerformed(ActionEvent arg0) {

            if( (tfBirinci.getText().isEmpty() || tfBirinci.getText() == null) && (tfIkinci.getText().isEmpty() || tfIkinci.getText() == null ))
            {
                taLog.setText("Database alani bos birakilamaz...\n");
            }
            else if ( (!(tfBirinci.getText().isEmpty() )) && (tfIkinci.getText().isEmpty() || tfIkinci.getText() == null ) )
            {
                sql = ("SELECT * FROM " + tfBirinci.getText());
                taLog.setText("Komut elde edildi : " + sql + "\n");
                System.out.println("aaaa " + tfBirinci.getText());
                //anaFrame.dispose();
                //databaseHistoryCalistir(); doesnt work
            }
            else if ( ( !(tfBirinci.getText().isEmpty() ) &&  !(tfBirinci.getText() == null) )  && ( !(tfIkinci.getText().isEmpty() ) && !(tfBirinci.getText() == null) ) )
            {
                sql = ("SELECT * FROM " + tfBirinci.getText() + " WHERE " + tfIkinci.getText());
                taLog.setText("Komut elde edildi : " + sql + "\n" );
                System.out.println("bbbb " + tfBirinci.getText());
                //anaFrame.dispose();
                //databaseHistoryCalistir(); doesnt work
            }else 
                taLog.setText("Lütfen Database alanini doldurunuz, aksi taktirde komut elde edilemez...\n");
        }
    }); 
```

那么，当我更改字符串的语句时，我只需要更新表就需要实现什么？

提前致谢。（举一个关于 DefaultTableModel 的例子会很棒）

编辑，你可以在这里看到我的完整代码：http: [//pastebin.com/eQCJVuKn](http://pastebin.com/eQCJVuKn)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-08T11:05:49.553

1)[通过@camickr 使用数据库中的表](http://tips4java.wordpress.com/2009/03/12/table-from-database/)

2）使用其中之一`ResultsetTableModel`

3）从调用SQL语句`Runnable#Thread`，但输出到`XxxTableModel`必须在里面`invokeLater`，更多[在Swing的Concurency中](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/index.html)讲`Event Dispatch Thread (EDT)`

[4) 从SwingWorker](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/worker.html)调用 SQL 语句，然后从 输出`progress()`，`publish()`或者`done()`应该在 EDT

5)`DefaultTableModel`不需要覆盖方法`fireXxxTableXxx`，所有方法都正确实现

6) 逻辑`Table from Database (ResultsetTableModel)`和`Runnable#Thread(SwingWorker)`是之间的区别

*   `Table from Database (ResultsetTableModel)`在 EDT 上调用所有更新，然后等待所有事件的 GUI 完成，在从数据库加载数据期间 GUI 不负责任或冻结

*   `Runnable#Thread(SwingWorker)`所有更新都来自 backgourng 任务，GUI 可用于鼠标和键盘事件，

# jquery - jquery让用户输入3个字符然后禁用编辑文本字段并从自动完成中选择

> ID：11382576
> 
> 赞同：0
> 
> 时间：2012-07-08T10:56:13.370
> 
> 标签：jquery, drop-down-menu, autocomplete, edit

我正在尝试使用 jquery 来推进一个自动完成的文本字段。

*   用户输入 3 个字符
*   城市被加载到下拉列表中（使用 ajax 自动完成）

现在我想：

*   防止用户手动输入城市名称，而是从下拉列表中选择它。有没有好的方法来做到这一点？我已经搜索和搜索但没有找到一个好的解决方案，因为用户首先必须能够在文本字段中输入一些字符，才能触发自动完成。

到目前为止，我的函数可以正常工作（它现在只返回 city_name）：

```
 $("#user_profile_attributes_city_id").autocomplete({
    source: "/data/living",
    minLength: 1,
    select: function( event, ui ) {
      $(this).val(ui.item.label);
      $(this).find("#country_id").val(ui.item.country_id);
      $(this).find("#city_id").val(ui.item.city_id);
      event.preventDefault;
    }
  }) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T11:00:25.560

```
$('#element').bind('keyup', function() {
  if ($(this).val().length == 3) {
    $(this).prop('disabled', true);
    // ajax-call
  }
});​ 
```

[jsFiddle](http://jsfiddle.net/TPPnP/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T11:05:29.003

您最初可以放置自动完成功能，

```
 <input autocomplete="off" /> 
```

实际上，如果值在您想要的列表中，您应该对 FORM 提交进行一些验证。

```
 $('form#id').submit(function(){

//validate
if ($(this).val().length > 3) {
    return false;
}
if ( $(this).val()  is_in_list ) {
    return false;
}
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-08T11:42:01.593

您可以利用自动完成的“打开”和“关闭”事件来实现这一点。检查[文档](http://jqueryui.com/demos/autocomplete/)

# c++ - 类类型未知时指向非静态成员函数的函数指针？

> ID：11382577
> 
> 赞同：-1
> 
> 时间：2012-07-08T10:56:17.233
> 
> 标签：c++, inheritance, callback, function-pointers

我正在开发一个游戏项目，该项目具有渲染到 opengl 上下文中的临时构建控件；诸如按钮、滚动条、列表框等之类的东西。其中许多控件是嵌套的；例如，我的列表框有一个滚动条，一个滚动条有 3 个按钮，等等。

当滚动条更改值时，我希望它调用响应更改的“某些”函数（通常在它的父对象中）。例如，如果列表框有一个滑块，它应该实例化滑块，然后告诉新滑块它应该调用列表框的“onScroll(float)”函数。所有控件共享一个公共基类，所以我可以有一个“base* parent”父指针，然后执行“parent->onScroll(val)”。但问题是当父母没有从基地继承时会发生什么；没有虚拟的 onScroll() 可以执行，因此顶级父级必须定期检查是否有任何子控件更改了值。这也会混淆其他控件，因为它们甚至可能没有孩子，

更好的解决方案是让子对象维护一个通用函数指针（如回调），它可以由父对象设置，并在必要时由子对象调用。像这样的东西：

```
typedef (*ptFuncF)(float);

class glBase {
public:
  //position,isVisible,virtual mouseDown(x,y),etc
};

class glDerivedChild : public glBase {
public:
  glDerivedChild();
  ~glDerivedChild();

  void changeValue(float fIn) {
    Value = fIn; //ignore these forward declaration errors
    (*callBack)(fIn);
  }

  void setCallBack(ptFuncF pIn) {callBack = pIn;}

  ptFuncF callBack;
  float Value;
};

class glDerivedParent : public glBase {
public:
  glDerivedParent() {
    child = new glDerivedChild();
    child->setCallBack(&onScroll);
  }
  ~glDerivedParent() {delete child;}

  void onScroll(float fIn) {
    //do something
  }

  glDerivedChild* child;
};

class someFoo {
public:
  someFoo() {
    child->setCallBack(&setValue);
  }

  void setValue(float fIn) {
    //do something else
  }

  glDerivedChild child;
}; 
```

我对函数指针有点陌生，所以我知道我（显然）做错了很多事情。我怀疑它可能涉及“typedef (glBase::*ptFuncF)(float);”之类的东西 'onScroll(f)' 是一个被覆盖的虚函数，可能具有像'virtual void childCallBack(float)' 这样的通用名称。我更愿意让解决方案尽可能接近原版，所以我想避免像 boost 这样的外部库。在 8 小时的大部分时间里，我一直在摸索这个问题，我希望有人能提供帮助。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T16:32:30.517

指向类的成员函数的函数指针具有这样的类型：

```
<return type> (<class name>::*)(<arguments>) 
```

例如：

```
typedef void (glBase::*ptFuncF)(float);
        ^^^^
      by the way, you have forgot the `void` in your `typedef`

ptFuncF func = &glDerivedChild::onScroll; 
```

你像这样使用它：

```
glDerivedChild c;
(c.*func)(1.2); 
```

* * *

在您的特定示例中，该函数是派生类本身的成员，因此您应该这样称呼它：

```
(c.*c.callback)(1.2); 
```

内部`c.callback`是函数指针。其余的和上面的完全一样，也就是：

```
(class_instance.*function_pointer)(arguments); 
```

您可能还想看看[这个问题](https://stackoverflow.com/questions/990625/c-function-pointer-class-member-to-non-static-member-function)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T11:14:14.430

我认为，您想要的是某种事件或信号机制。

例如，您可以研究如何在*Windows*上组织事件处理。简而言之，您的滚动条在系统中生成新事件，然后系统将其传播到系统中注册的所有元素。

更方便的机制是信号/槽机制。[Boost](http://www.boost.org/doc/libs/1_50_0/doc/html/signals.html)或[Qt](http://qt-project.org/doc/qt-5.0/signalsandslots.html)提供了这样的工具。*我会推荐这个解决方案*。

但是，如果您仍想*仅使用回调*，我建议您使用[std::function](http://en.cppreference.com/w/cpp/utility/functional/function) ( [boost::function](http://www.boost.org/doc/libs/1_50_0/doc/html/function.html) )（在需要时与[std::bind](http://en.cppreference.com/w/cpp/utility/functional/bind) ( [boost::bind](http://www.boost.org/doc/libs/1_50_0/libs/bind/bind.html) ) 结合使用）而不是原始函数指针。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-08T11:14:32.497

使用`boost::function`（或`std::function`如果可用）。像这样（使用你的符号）：

```
typedef std::function<void (float)> ptFuncF; 
//...
void setCallBack(const ptFuncF &pIn);
//...
child->setCallBack(std::bind(&glDerivedParent::onScroll, this, _1)); 
//...
child->setCallBack(std::bind(&someFoo::setValue, this, _1)); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-07-08T19:02:20.677

好的，我想出的解决方法有一些额外的开销和分支，但在其他方面是合理的。

基本上，每个回调函数都被实现为一个虚拟成员函数，它接收所需的参数，包括`void*`指向进行调用的对象的指针。每个派生对象还有一个基类指针，它指向应该接收它发出的任何事件的对象（通常是它的父对象，但可以是继承自基类的任何对象）。如果控件有多个子控件，回调函数使用`void*`指针来区分它们。这是一个例子：

```
class glBase {
public:
  virtual onChildCallback(float fIn, void* caller);

  glBase* parent;
};

class glSlider : public glBase {
public:
  glSlider(glBase* parentIn);

  void changeValue(float fIn) {
    Value = fIn;
    parent->onChildCallback(fIn, this);
  }

  float Value;
};

class glButton : public glBase {
public:
  glButton(glBase* parentIn);

  void onClick() {
    parent->onChildCallback(0, this);
  }
};

class glParent : public glBase {
public:
  glParent(glBase* parentIn) : parent(parentIn) {
    childA = new glSlider(this);
    childB = new glButton(this);
  }

  void onChildCallback(float fIn, void* caller) {
    if (caller == childA) {
      //slider specific actions
    } else if (caller == childB) {
      //button specific actions
    } else {
      //generic actions
    }
  }

  glSlider* childA;
  glButton* childB;
}; 
```

除了相当少量的开销外，该方案足够灵活，派生类可以忽略某些组件或完全省略它们。稍后我可能会回到函数指针的想法（感谢 shahbaz），但无论如何，两种方案的一半基础架构都是相同的，额外的开销很小，特别是因为控件的数量和种类都相当少。让回调函数使用嵌套响应实际上会更好一些，因为您不需要为每个子对象（例如 onUpButton、onDownButton 等）使用单独的函数。

# java - Java NIO Selector 最多只能选择 50 个 SelectionKeys？

> ID：11382581
> 
> 赞同：4
> 
> 时间：2012-07-08T10:57:10.247
> 
> 标签：java, select, nio

我使用[siege](http://www.joedog.org/siege-home/)对我的手工构建的文件服务器进行压力测试，它对于小文件（小于 1KB）非常有效，而在使用 1MB 文件进行测试时，它不能按预期工作。

下面是用小文件测试的结果：

```
neevek@~$ siege -c 1000 -r 10 -b http://127.0.0.1:9090/1KB.txt
** SIEGE 2.71
** Preparing 1000 concurrent users for battle.
The server is now under siege..      done.

Transactions:              10000 hits
Availability:             100.00 %
Elapsed time:               9.17 secs
Data transferred:           3.93 MB
Response time:              0.01 secs
Transaction rate:        1090.51 trans/sec
Throughput:             0.43 MB/sec
Concurrency:                7.29
Successful transactions:       10000
Failed transactions:               0
Longest transaction:            1.17
Shortest transaction:           0.00 
```

以下是一个 1MB 文件的测试结果：

```
neevek@~$ siege -c 1000 -r 10 -b http://127.0.0.1:9090/1MB.txt
** SIEGE 2.71
** Preparing 1000 concurrent users for battle.
The server is now under siege...[error] socket: read error Connection reset by peer sock.c:460: Connection reset by peer
[error] socket: unable to connect sock.c:222: Connection reset by peer
[error] socket: unable to connect sock.c:222: Connection reset by peer
[error] socket: unable to connect sock.c:222: Connection reset by peer
[error] socket: read error Connection reset by peer sock.c:460: Connection reset by peer
[error] socket: unable to connect sock.c:222: Connection reset by peer
[error] socket: read error Connection reset by peer sock.c:460: Connection reset by peer
[error] socket: read error Connection reset by peer sock.c:460: Connection reset by peer
[error] socket: read error Connection reset by peer sock.c:460: Connection reset by peer
[error] socket: read error Connection reset by peer sock.c:460: Connection reset by peer 
```

当`siege`以上述错误终止时，我的文件服务器仍然以固定数量的`WRITABLE`SelectionKey 旋转，即`Selector.select()`不断返回一个固定的数字，比如 50。

通过上面的测试，在我看来我的文件服务器不能接受不超过 50 个并发连接，因为当用小文件运行测试时，我注意到服务器有`select`1 个或 2 个 SelectionKeys，当用大文件运行时，它`select`是每次最多50个。

我试图`backlog`在`Socket.bind()`没有帮助的情况下增加。

问题的原因可能是什么？

**编辑**

更多信息：

在使用 1MB 文件进行测试时，我注意到它因错误而`siege`终止`Broken pipe`，并且文件服务器只接受了**198 个**连接，尽管我指定了 1000 个并发连接 x 10 轮（1000*10=10000）来淹没服务器。

**编辑 2**

我已经使用以下代码（单个类）进行了测试以重现相同的问题，在此代码中，我只**接受**连接，我不**读取**或**写入**，客户端在连接超时之前`siege`终止`Connection reset`或错误。`Broken pipe`我还注意到 Selector 只能选择少于 1000 个键。您可以尝试下面的代码来见证问题。

```
public class TestNIO implements Runnable {
    ServerSocketChannel mServerSocketChannel;
    Selector mSelector;

    public static void main(String[] args) throws Exception {
        new TestNIO().start();
    }

    public TestNIO () throws Exception {
       mSelector = Selector.open();
    }

    public void start () throws Exception {
        mServerSocketChannel = ServerSocketChannel.open();
        mServerSocketChannel.configureBlocking(false);
        mServerSocketChannel.socket().bind(new InetSocketAddress(9090));
        mServerSocketChannel.socket().setSoTimeout(150000);
        mServerSocketChannel.register(mSelector, SelectionKey.OP_ACCEPT);

        int port = mServerSocketChannel.socket().getLocalPort();
        String serverName = "http://" + InetAddress.getLocalHost().getHostName() + ":" + port;
        System.out.println("Server start listening on " + serverName);

        new Thread(this).start();

    }

    @Override
    public void run() {
        try {
            Thread.currentThread().setPriority(Thread.MIN_PRIORITY);
            while (true) {
                int num = mSelector.select();

                System.out.println("SELECT = " + num + "/" + mSelector.keys().size());
                if (num > 0) {
                    Iterator<SelectionKey> keys = mSelector.selectedKeys().iterator();

                    while (keys.hasNext()) {
                        final SelectionKey key = keys.next();

                        if (key.isValid() && key.isAcceptable()) {
                            accept(key);
                        }

                    }
                    // clear the selected keys
                    mSelector.selectedKeys().clear();
                }
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    private void accept (SelectionKey key) throws IOException {
        SocketChannel socketChannel = mServerSocketChannel.accept();
        socketChannel.configureBlocking(false);
        socketChannel.socket().setSoTimeout(1000000);
        socketChannel.socket().setKeepAlive(true);
        // since we are connected, we are ready to READ
        socketChannel.register(mSelector, SelectionKey.OP_READ);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-08T05:10:35.870

它实际上与为 ServerSocketChannel 设置的默认积压值有关

[http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/6-b14/sun/nio/ch/ServerSocketChannelImpl.java#138](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/6-b14/sun/nio/ch/ServerSocketChannelImpl.java#138)

您可以通过将积压值作为第二个参数传递给 bind 方法来解决此问题。

mServerSocketChannel.socket().bind(new InetSocketAddress(9090), "积压值")

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T09:48:38.507

检查打开文件数（文件描述符）的ulimit和硬限制

我猜你正在使用linux。您可以查看limits.conf /etc/security/limits.conf

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-09T16:44:23.173

这个问题可能与我的代码无关，我对本地运行的 nginx 服务器（MacOSX）运行相同的测试，发生相同的错误。所以它很可能与硬件或`siege`客户端有关。

# apache - 服务器别名不起作用

> ID：11382583
> 
> 赞同：8
> 
> 时间：2012-07-08T10:57:20.807
> 
> 标签：apache, server-name

我对 ServerAlias 指令有疑问。配置如下所示：

```
ServerName d.geosurf.ru
ServerAlias www.d.geosurf.ru divo32pro.ru www.divo32pro.ru 
```

但！例如，每当我尝试访问 divo32pro.ru 时，我都会得到 d.geosurf.ru（服务器名称）。似乎没有重定向，但是出了点问题...有什么想法吗？...

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-08T11:37:44.987

`ServerAlias`只需声明可用于寻址同一站点的替代名称（或`<VirtualHost>`. 所以如果我有

```
ServerName www.example.com
ServerAlias example.com 
```

我将看到 和 的相同`http://www.example.com/foo/`内容`http://example.com/foo/`。

但是，如果 Apache 服务器出于任何原因需要发出重定向（例如，从没有尾部斜杠的目录名称到带有斜杠的相应名称），则行为取决于[UseCanonicalName](http://httpd.apache.org/docs/2.4/mod/core.html#usecanonicalname)设置。如果这是未指定的，或者`Off`它将执行您期望的操作（`http://example.com/foo`-> `http://example.com/foo/`），但如果设置为，则无论原始请求 URL （即-> ）如何，`On`重定向都将指向。检查您的配置中是否有此设置。`ServerName``http://example.com/foo``http://www.example.com/foo/`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-08T11:11:51.563

`ServerAlias`不会将您重定向到新站点。

`ServerName`只是说“这是我的服务器名称”，并`ServerAlias`说如果有人去 XY 或 Z，那么请把他们当作直接来`ServerName`

# spring-security - 记住我的结果被spring security忽略了，我仍然被重定向到登录页面

> ID：11382588
> 
> 赞同：0
> 
> 时间：2012-07-08T10:59:01.230
> 
> 标签：spring-security, remember-me

我的 Spring Security XML 如下：

```
 <http use-expressions="true">
        <intercept-url pattern="/login" access="isAnonymous()" requires-channel="https"/>
        <intercept-url pattern="/login/" access="isAnonymous()" requires-channel="https" />
        <intercept-url pattern="/logout-success" access="isAnonymous()" />
        <intercept-url pattern="/logout-success/" access="isAnonymous()" />     
        <intercept-url pattern="/logout" access="isAuthenticated()" />

        <intercept-url pattern="/**" access="hasRole('ROLE_SUPER_ADMIN')" />
        <form-login login-page="/login/" default-target-url="/example/Login_execute"/>
        <logout logout-url="/logout" logout-success-url="/logout-success" />
        <remember-me services-ref="rememberMeServices"/>

        <port-mappings>
            <port-mapping http="8080" https="8443"/>
        </port-mappings>        
    </http>

...

    <beans:bean id="userDetailsService" class="com.myownpackage.UserAccountServiceImpl"/>

    <beans:bean id="rememberMeServices" class="org.springframework.security.web.authentication.rememberme.PersistentTokenBasedRememberMeServices">
        <beans:property name="userDetailsService" ref="userDetailsService" />
        <beans:property name="tokenRepository" ref="persistentTokenRepository" />
        <beans:property name="key" value="myownkey" />
    </beans:bean>

<beans:bean id="persistentTokenRepository" class="com.myownpackage.PersistentTokenRepositoryImpl" /> 
```

每当我登录并勾选记住我时，我的程序都会保存一些东西来记住我的数据库表（这是正确的）。

如果我关闭浏览器，重新打开浏览器并打开需要身份验证的页面，我的程序将在 PersistentTokenBasedRememberMeServices 执行 processAutoLoginCookie 并返回正确的 UserDetails（这也是正确的）

但是，即便如此，我仍然被重定向到登录页面。

顺便说一句，登录页面是自定义的，我所做的只是显示带有登录表单的 JSP 文件。

在编写 Spring Security XML 时，我是否遗漏了任何步骤？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T11:14:39.967

Spring Security 的“记住我”在客户端使用了一个 Cookie，也就是你的浏览器。

来自[Spring 的文档](http://static.springsource.org/spring-security/site/docs/3.1.x/reference/springsecurity-single.html#remember-me)：

> 记住我或持久登录身份验证是指网站能够记住会话之间主体的身份。这通常是通过向浏览器发送 cookie 来完成的，该 cookie 在未来的会话中被检测到并导致自动登录发生。Spring Security 为这些操作的发生提供了必要的钩子，并且有两个具体的 remember-me 实现。一种使用散列来保护基于 cookie 的令牌的安全性，另一种使用数据库或其他持久存储机制来存储生成的令牌。

Spring 的想法是你将能够在不同的 Session 之间自动登录：

**服务器的**会话，意味着当服务器“反弹”（下降然后上升）时，例如由 Persistency 处理。

**客户的**会话由浏览器（Cookie）处理。浏览器使用 Spring 发送的 Cookie，Server 验证此 Cookie 并让用户自动登录，无需再次输入凭据。

检查浏览器中的 Cookie。

HTH。

哦哈德。

# c++ - 尝试执行 heapify 程序，在我错的地方找不到错误

> ID：11382594
> 
> 赞同：0
> 
> 时间：2012-07-08T11:00:08.347
> 
> 标签：c++, heap

我正在使用一种简单的方法以自下而上的方式将数组转换为堆。我找不到错误。有人可以看看，让我知道。

基本上我是以自下而上的方式制作一个随机数组。

```
for(int i=n/2;i>=1;i--)
        {
                    heapify(i,n,arr);
        } 
```

heapify 程序存在一些问题，有时会给出正确的结果，但大多数时候是错误的。

```
`#include<iostream>
#include<conio.h>
using namespace std;
int min(i
nt x,int y,int z)
{
    return ((x>y?x:y)>z?(x>y?x:y):z);
}
int left(int i)
{
    return (2*i);enter code here
}
int right(int i) 
{
    return (2*i+1);
}
int parent(int i)
{
    return (i/2);
}
int heapify(int i,int n,int arr[])
{
    int temp;
    int l=left(i);
    int r=right(i);
    temp=i;
    if(l<=n&&arr[l]<arr[i])
    temp=l;
    else if(r<=n&&arr[temp]>arr[r])
    temp=r;
    if(temp!=i)
    {
               int x=arr[temp];
               arr[temp]=arr[i];
               arr[i]=x;
               heapify(temp,n,arr);
    }   
    //else return 0;
}
int deletemin(int n,int arr[])
{
               cout<<arr[1]<<"\ndeLeted\n";   
               arr[1]=arr[n];

}
int insert(int x,int size,int arr[])
{
    arr[size]=x;
    int i=(size);
    do
    {
    i=parent(i);
    if(arr[i]!=min(arr[i],arr[left(i)],arr[right(i)]))
    heapify(i,(size),arr);
    else
    return 0;
    }while(i!=1);
}

int main()
{
    int n,t,arr[100];
    cin>>t;
    while(t--)
    {
    cin>>n;
    for(int i=1;i<=n;i++)
    cin>>arr[i];
    for(int i=n/2;i>=1;i--)
    {
                heapify(i,n,arr);
    }
    for(int i=1;i<=n;i++)
    cout<<arr[i]<<" ";
    deletemin(n,arr);
    n--;
    heapify(1,n,arr);
    for(int i=1;i<=n;i++)
    cout<<arr[i]<<" ";
    int y;
    cout<<"what value do you want to insert\n";
    cin>>y;
    n++;
    insert(y,n,arr);
    for(int i=1;i<=n;i++)
    cout<<arr[i]<<" ";

    }

    getch();
    return 0;
}

` 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T11:08:07.243

一个简单的观察是你的 min 函数是错误的！它不返回 3 个数字的最小值。暂时用 ifs 来做吧！

# php - PyroCMS 中的“无法安装模块”错误

> ID：11382598
> 
> 赞同：2
> 
> 时间：2012-07-08T11:00:54.940
> 
> 标签：php, codeigniter, pyrocms

我一直在 PyroCMS 中构建一个模块并制作了它的结构。我正在使用 Streams API 来构建表单并执行我的操作，还执行了一个虚拟安装以检查一切是否正常。然后我继续修改假人的内容并完成我的结构。但是，在`details.php`文件中，我进行了更改，创建了一个外键（字段的关系类型，如果您知道 API 术语）以从另一个流（在我当前流之后定义的另一个流）中检索一个字段，现在何时我安装了模块，它显示“无法安装模块”错误，但我可以看到模块已安装。我试图注释掉外键引用，但问题仍然存在。

这是我的 details.php 文件：

类 Module_Employer 扩展模块 {

```
public $version = '1.0';

public function info()
{
    return array(
        'name' => array(
            'en' => 'Employer'
        ),
        'description' => array(
            'en' => 'Module for Employer'
        ),
        'frontend' => true,
        'backend' => true,
        'menu' => 'content',
        'shortcuts' => array(
            'create' => array(
                'name' => 'Employer:new',
                'uri' => 'admin/employer/create',
                'class' => 'add'
            )
        )
    );
}

public function install()
{
    // We're using the streams API to
    // do data setup.
    $this->load->driver('Streams');

    $this->load->language('employer/emp');

    // Add streams
    if ( ! $this->streams->streams->add_stream(lang('Employer:employers'), 'employers', 'employer', null, 'This is the Employer Stream')) return false;
    if ( ! $this->streams->streams->add_stream(lang('Employer:company'), 'company', 'company', null, 'This is the Company Stream')) return false;
    if ( ! $this->streams->streams->add_stream(lang('Employer:job'), 'jobs', 'job', null, 'This is the Job Stream')) return false;

    // Fields for employers table
    $employer_fields = array(
        array(
            'name' => 'Name',
            'slug' => 'name',
            'namespace' => 'employer',
            'type' => 'text',
            'extra' => array('max_length' => 100),
            'assign' => 'employers',
            'title_column' => true,
            'required' => true,
            'unique' => true
        ),
        array(
            'name' => 'Username',
            'slug' => 'username',
            'namespace' => 'employer',
            'type' => 'text',
            'extra' => array('max_length' => 100),
            'assign' => 'employers',
            'title_column' => true,
            'required' => true,
            'unique' => true
        ),
        array(
            'name' => 'Password',
            'slug' => 'password',
            'namespace' => 'employer',
            'type' => 'encrypt',
            'extra' => array('hide_typing' => 'yes'),
            'assign' => 'employers',
            'title_column' => true,
            'required' => true,
            'unique' => true
        ),
        array(
            'name' => 'Credits',
            'slug' => 'credits',
            'namespace' => 'employer',
            'type' => 'integer',
            'extra' => array('max_length' => 10),
            'assign' => 'employers',
            'title_column' => true,
            'required' => true,
            'unique' => true
        ),  
        array(
            'name' => 'Company name',
            'slug' => 'company_name',
            'namespace' => 'employer',
            'type' => 'relationship',
            'extra' => array('choose_stream' => 'company'),
            'assign' => 'employers',
            'title_column' => true,
            'required' => false,
            'unique' => false
        )
    );
    $this->streams->fields->add_fields($employer_fields);

    //Fields for company stream
    $company_fields = array(
        array(
            'name' => 'Username',
            'slug' => 'username',
            'namespace' => 'company',
            'type' => 'relationship',
            'extra' => array('choose_stream' => 'employers'),
            'assign' => 'company',
            'title_column' => true,
            'required' => false,
            'unique' => false
        ),
        array(
            'name' => 'E-mail',
            'slug' => 'email',
            'namespace' => 'company',
            'type' => 'email',
            'assign' => 'company',
            'title_column' => true,
            'required' => true,
            'unique' => false
        ),
        array(
            'name' => 'Company Name',
            'slug' => 'company_name',
            'namespace' => 'company',
            'type' => 'text',
            'extra' => array('max_length' => 100),
            'assign' => 'company',
            'title_column' => true,
            'required' => true,
            'unique' => true
        ),
        array(
            'name' => 'Logo',
            'slug' => 'logo',
            'namespace' => 'company',
            'type' => 'image',
            'extra' => array('folder' => 'upload'),
            'assign' => 'company',
            'title_column' => true,
            'required' => false,
            'unique' => false
        ),
        array(
        'name' => 'Designation',
        'slug' => 'designation',
        'namespace' => 'company',
        'type' => 'text',
        'extra' => array('max_length' => 100),
        'assign' => 'company',
        'title_column' => true,
        'required' => false,
        'unique' => false
        ),
        array(
        'name' => 'Contact No.1',
        'slug' => 'contact1',
        'namespace' => 'company',
        'type' => 'integer',
        'extra' => array('max_length' => 10),
        'assign' => 'company',
        'title_column' => true,
        'required' => true,
        'unique' => false
        ),
        array(
        'name' => 'Contact No.2',
        'slug' => 'contact2',
        'namespace' => 'company',
        'type' => 'integer',
        'extra' => array('max_length' => 10),
        'assign' => 'company',
        'title_column' => true,
        'required' => false,
        'unique' => false
        ),
        array(
        'name' => 'Contact No.3',
        'slug' => 'contact3',
        'namespace' => 'company',
        'type' => 'integer',
        'extra' => array('max_length' => 10),
        'assign' => 'company',
        'title_column' => true,
        'required' => false,
        'unique' => false
        ),
        array(
        'name' => 'Address',
        'slug' => 'address',
        'namespace' => 'company',
        'type' => 'textarea',
        'assign' => 'company',
        'title_column' => true,
        'required' => true,
        'unique' => false
        ),
        array(
        'name' => 'Billing ddress',
        'slug' => 'billing_address',
        'namespace' => 'company',
        'type' => 'textarea',
        'assign' => 'company',
        'title_column' => true,
        'required' => true,
        'unique' => false
        ),
    );
    $this->streams->fields->add_fields($company_fields);

    //Fields for company stream
    $job_desc_fields = array(
        array(
            'name' => 'Username',
            'slug' => 'username',
            'namespace' => 'company',
            'type' => 'relationship',
            'extra' => array('choose_stream' => 'employers'),
            'assign' => 'jobs',
            'title_column' => true,
            'required' => false,
            'unique' => false
        ),
        array(
            'name' => 'Key Skills',
            'slug' => 'keyskills',
            'namespace' => 'company',
            'type' => 'textarea',
            'assign' => 'jobs',
            'title_column' => true,
            'required' => true,
            'unique' => false
        ),
        array(
            'name' => 'Position Summary',
            'slug' => 'position_summary',
            'namespace' => 'company',
            'type' => 'textarea',
            'assign' => 'jobs',
            'title_column' => true,
            'required' => false,
            'unique' => false
        ),
        array(
            'name' => 'Experience',
            'slug' => 'experience',
            'namespace' => 'company',
            'type' => 'text',
            'assign' => 'jobs',
            'title_column' => true,
            'required' => true,
            'unique' => false
        ),
        array(
            'name' => 'Industry',
            'slug' => 'industry',
            'namespace' => 'company',
            'type' => 'text',
            'assign' => 'jobs',
            'title_column' => true,
            'required' => false,
            'unique' => false
        ),
        array(
            'name' => 'Functional Area',
            'slug' => 'functional_area',
            'namespace' => 'company',
            'type' => 'text',
            'assign' => 'jobs',
            'title_column' => true,
            'required' => false,
            'unique' => false
        ),
        array(
            'name' => 'Salary',
            'slug' => 'salary',
            'namespace' => 'company',
            'type' => 'text',
            'assign' => 'jobs',
            'title_column' => true,
            'required' => false,
            'unique' => false
        ),
        array(
            'name' => 'Start Date',
            'slug' => 'start_date',
            'namespace' => 'company',
            'type' => 'datetime',
            'assign' => 'jobs',
            'extra' => array('input_type' => 'datepicker'),
            'title_column' => true,
            'required' => false,
            'unique' => false
        ),
        array(
            'name' => 'Job Type',
            'slug' => 'job_type',
            'namespace' => 'company',
            'type' => 'choice',
            'assign' => 'jobs',
            'extra' => array('input_type' => 'datepicker'),
            'title_column' => true,
            'required' => false,
            'unique' => false
        ),
    );
    return true;
}

public function uninstall()
{
    $this->load->driver('Streams');

    $this->streams->utilities->remove_namespace('employer');

    return true;
}

public function upgrade($old_version)
{
    // Your Upgrade Logic
    return true;
}

public function help()
{
    // Return a string containing help info
    // You could include a file and return it here.
    return "No documentation has been added for this module.<br />Contact the module developer for assistance.";
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T06:31:32.773

我之前已经“安装”了该模块，但是在 uninstall() 函数下，我忘记添加删除所有流的代码（PS：我有 3 个流，在 install() 函数中定义了单独的命名空间）。我只有以下内容：

```
$this->streams->utilities->remove_namespace('employer'); 
```

因此，其他流在系统中“存在”，尽管从表面上看，模块已被卸载，每当我尝试重新安装模块时，我都会收到错误**Could not install module**，因为在创建表/流时在数据库中，查询返回*FALSE*，因为表已经存在。

但是，我随后添加了代码以删除所有其他流，只需在调用中包含它们的命名空间，例如：

```
$this->streams->utilities->remove_namespace('employer');
$this->streams->utilities->remove_namespace('job');
$this->streams->utilities->remove_namespace('company'); 
```

..问题已解决！

# javascript - 在页面加载时，发送/模拟一个组合键 [CTRL+L]

> ID：11382599
> 
> 赞同：1
> 
> 时间：2012-07-08T11:01:04.253
> 
> 标签：javascript, key, keypress, onload

在页面加载时，发送/模拟组合键 [CTRL+L] 或​​ [CTRL+L+BACKSPACE] 以关注 URL 地址栏或清除它（带焦点）。

这是用于替换 Chrome 和其他浏览器中默认的新标签页的页面。

原因是默认情况下，当您打开一个新选项卡时，您的 URL 地址栏会自动聚焦，您可以立即开始输入。

这是这个新标签替换页面中的一个问题，因为它现在阻止您开始输入，这对 Chrome 用户来说是一个大习惯。他们开始输入以显示自动完成的 URL 地址或进行快速的 Google 搜索。

我花了一个半小时的谷歌搜索网站、Stack-overflow 和其他网站是否已经完成，我没有找到一个我能找到的结果，至少没有一个我必须订阅的结果到付款的事情来查看答案。

我知道在页面加载时激活一个键是可能的。我知道做一个组合键是可能的。我想将两者混合在一起以在页面加载时让脚本模拟按键组合，并导致浏览器专注于它的 URL 地址栏。

项目页面（如果有帮助）：http: [//flatline.in/tab/](http://flatline.in/tab/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T11:05:46.913

好吧，老实说，我希望这不能通过 Javascript 来完成。

如果开发人员可以仅使用 Javascript 修改桌面和/或浏览器行为，那么编写黑客和恶意软件代码将变得非常容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-16T16:33:17.820

我实际上找到了它...我通常在我提出问题后就找到一些东西...我的大脑工作得更好:)

它可以通过 Chrome 中的扩展程序来完成。

```
chrome.tabs.getCurrent(function(tab) {
            chrome.tabs.update(tab.id, { 'url': url, 'selected': true });
        }); 
```

'selected': true 是成功的关键:)

# ruby-on-rails - PRNG 未播种错误

> ID：11382600
> 
> 赞同：4
> 
> 时间：2012-07-08T11:01:12.880
> 
> 标签：ruby-on-rails, ruby, openssl, prng

我收到一个间歇性错误，说在尝试生成表单身份验证令牌时没有播种伪随机数生成器。我已经复制了下面堆栈跟踪的相关部分。

这是我所知道/看到的： - 重新启动乘客似乎暂时解决了问题 - 从控制台运行相同的代码按预期工作 - /dev/urandom 存在，因此它应该能够使用它来播种 - 这发生在 ubuntu 10.04 ，openssl 0.9.8k，ree 1.8.7 p253，passenger 3.0.3。- 我读过一个关于独角兽的问题，听起来有点像重新启动工人时发生的事情，但没有看到乘客描述的类似情况。

```
SessionsController#new (ActionView::TemplateError) "PRNG not seeded"
/usr/local/lib/ruby/1.8/securerandom.rb:53:in `random_bytes'
/usr/local/lib/ruby/1.8/securerandom.rb:53:in `random_bytes'
/usr/local/lib/ruby/1.8/securerandom.rb:105:in `base64'
vendor/bundle/ruby/1.8/gems/actionpack-2.3.14/lib/action_controller/request_forgery_protection.rb:109:in `form_authenticity_token'
(eval):2:in `send'
(eval):2:in `form_authenticity_token' 
```

很难过。非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T08:00:54.323

假设`/dev/random`和`/dev/urandom`都是可读/写的，并且您仍然收到此错误，也许您需要运行/安装熵生成器，例如`prngd`？

尝试：

```
 $ sudo /etc/init.d/prngd start 
```

如果失败，请先安装`prngd`：

```
 $ sudo apt-get install prngd 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T23:12:43.013

一个牵强的假设。相关的代码应该是这样的（可能这不是同一个版本）：

```
def self.random_bytes(n=nil)
  n ||= 16
  if defined? OpenSSL::Random
    @pid = 0 if !defined?(@pid)
    pid = $$
    if @pid != pid
      now = Time.now
      ary = [now.to_i, now.usec, @pid, pid]
      OpenSSL::Random.seed(ary.join('.'))
      @pid = pid
    end
    return OpenSSL::Random.random_bytes(n)
end 
```

我们知道，如果输入的熵少于 128 位，OpenSSL 会给出您报告的错误。总共 16 个字节（或 18..22，如果 OpenSSL 足够聪明，可以发现一串 ASCII 可打印字符并忽略高位）。

初始化 OpenSSL 的序列类似于 1342652367.A.0.B；是否有可能，有时 pid 足够小，并且微秒足够接近零，从而产生的熵低于临界阈值？

这应该很容易测试：替换

```
ary.join('.') 
```

和

```
Digest::MD5.hexdigest(ary.join('.')) 
```

为了获得合理的不可预测性的肯定 128 位，甚至可能是 256 位的字符串长度。

更明确的检查是添加一个异常并打印出触发错误时的 ary 是什么。

# javascript - Javascript Date.toJSON 没有得到时区偏移

> ID：11382606
> 
> 赞同：13
> 
> 时间：2012-07-08T11:02:01.723
> 
> 标签：javascript, date, timezone

那么问题是我使用的是这样的代码：

```
new Date().toJSON().slice(0, 10) 
```

将我的日期作为`YYYY-MM-DD`字符串，然后我在一些 mysql 查询和一些条件语句中使用它作为参数。在一天结束时，我没有得到正确的日期，因为它仍然在前一天（我的时区偏移量是 +2/3 小时）。

我没有注意到该`toJSON`方法没有考虑到您的时区偏移量，所以我最终得到了这个 hacky 解决方案：

```
var today = new Date();
today.setHours( today.getHours()+(today.getTimezoneOffset()/-60) );
console.log(today.toJSON().slice(0, 10)); 
```

有没有更优雅的解决方案？

*   这是测试代码：http: [//jsfiddle.net/simo/qwhYw/](http://jsfiddle.net/simo/qwhYw/)
*   JavaScript [toJSON 方法](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/toJSON)
*   JavaScript[日期对象](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date)

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-07-08T12:08:11.407

ECMAScript 中的日期对象在内部是 UTC。时区偏移量用于当地时间。

[Date.prototype.toJSON](http://es5.github.com/#x15.9.5.44)的规范说它使用[Date.prototype.toISOString](http://es5.github.com/#x15.9.5.43)，它指出“时区始终是 UTC”。您的解决方案正在做的是将日期对象的 UTC 时间值偏移时区偏移量。

考虑将您自己的方法添加到 Date.prototype，例如

```
Date.prototype.toJSONLocal = function() {
  function addZ(n) {
    return (n<10? '0' : '') + n;
  }
  return this.getFullYear() + '-' + 
         addZ(this.getMonth() + 1) + '-' + 
         addZ(this.getDate());
} 
```

### 编辑

如果你想挤压额外的性能，以下应该更快：

```
Date.prototype.toJSONLocal = (function() {
    function addZ(n) {
        return (n<10? '0' : '') + n;
    }
    return function() {
      return this.getFullYear() + '-' +
             addZ(this.getMonth() + 1) + '-' +
             addZ(this.getDate());
    };
}()) 
```

但这有点过早优化的味道，所以除非你在很短的时间内调用它数千次，否则我不会打扰。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T11:22:23.423

> 我没有注意到 toJSON 方法没有考虑到您的时区偏移

但确实如此，它将本地时间转换为祖鲁语（查看字符串的末尾：Z）

```
new Date( "2012-01-02T03:04:05+02:00" ).toJSON()
"2012-01-02T01:04:05.000Z" 
```

# php - PHP - 从字符串中删除特定字符串

> ID：11382611
> 
> 赞同：0
> 
> 时间：2012-07-08T11:02:57.897
> 
> 标签：php, string, strip

我有这个字符串，但我需要从中删除特定的东西......

原始字符串：`hr-165-34.sh-290-92.ch-215-84.hd-180-1.lg-280-64`.

我需要的字符串：`sh-290-92.ch-215-84.lg-280-64`.

我需要删除`hr-165-34\. and hd-180-1`. ！

编辑：啊，我遇到了障碍！

字符串总是在变化，所以我需要删除的位，比如“hr-165-34”。总是在变化，它永远是“hr-SOMETHING-SOMETHING”。

所以我使用的方法不起作用！

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-08T11:09:45.553

取决于您为什么要准确删除那些子串...

*   如果您总是想完全删除这些子字符串，您可以使用[`str_replace`](http://php.net/manual/en/function.str-replace.php)
*   如果你总是想删除相同位置的字符，你可以使用[`substr`](http://php.net/manual/en/function.substr.php)
*   如果您总是想删除两个点之间符合某些条件的子字符串，您可以使用[`preg_replace`](http://php.net/manual/en/function.preg-replace.php)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-08T11:09:02.277

```
$str = 'hr-165-34.sh-290-92.ch-215-84.hd-180-1.lg-280-64';
$new_str = str_replace(array('hr-165-34.', 'hd-180-1.'), '', $str); 
```

上的信息[`str_replace`](http://php.net/manual/en/function.str-replace.php)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-08T11:06:54.977

最简单快捷的方法是使用[str_replace](http://php.net/manual/en/function.str-replace.php)

```
$ostr = "hr-165-34.sh-290-92.ch-215-84.hd-180-1.lg-280-64";
$nstr = str_replace("hr-165-34.","",$ostr);
$nstr = str_replace("hd-180-1.","",$nstr); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-08T11:13:03.007

```
<?php    
$string = 'hr-165-34.sh-290-92.ch-215-84.hd-180-1.lg-280-64';

// define all strings to delete is easier by using an array
$delete_substrings = array('hr-165-34.', 'hd-180-1.');
$string = str_replace($delete_substrings, '', $string);

assert('$string == "sh-290-92.ch-215-84.lg-280-64" /* Expected result: string = "sh-290-92.ch-215-84.lg-280-64" */');
?> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-08T12:34:34.373

我想通了！

```
$figure = $q['figure']; // hr-165-34.sh-290-92.ch-215-84.hd-180-1.lg-280-64

$s = $figure;
$matches = array();
$t = preg_match('/hr(.*?)\./s', $s, $matches);

$s = $figure;
$matches2 = array();
$t = preg_match('/hd(.*?)\./s', $s, $matches2);

$s = $figure;
$matches3 = array();
$t = preg_match('/ea(.*?)\./s', $s, $matches3);

$str = $figure;
$new_str = str_replace(array($matches[0], $matches2[0], $matches3[0]), '', $str);
echo($new_str); 
```

多谢你们！

# javascript - 禁用 Javascript 时显示占位符 HTML

> ID：11382613
> 
> 赞同：0
> 
> 时间：2012-07-08T11:03:21.600
> 
> 标签：javascript, html

当 java 脚本被禁用时，我需要在我的 HTML 文件中显示横幅，就像在 stackoverflow 站点中一样。在 stackoverflow 站点中，禁用 java 脚本时会显示红色横幅。当 JS 被禁用时，整个 HTML 页面稍微向下并显示一条红色消息是很好的，就像在这个 stackoverflow 站点中一样。任何人都可以帮我做到这一点..

提前致谢..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-08T11:06:19.610

使用`<noscript>`标签：

[https://developer.mozilla.org/en/HTML/Element/noscript](https://developer.mozilla.org/en/HTML/Element/noscript)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-08T11:06:32.190

我不知道这是否仍然是这样做的方法，但`noscript`适用于此。

```
<noscript>Javascript is disabled</noscript> 
```

所以我认为应该有一个特定`div`的内部`noscript`人员来完成这项工作。

```
<html>
        <head>
                <title>noscript test</title>
                <style>
                        #nojs {
                                top: 0px;
                                width: 100%;
                                position: absolute;
                                background-color: red;
                                color: white;
                                border-bottom: solid 5px black;
                        }
                </style>

        </head>

        <body>

        <noscript><div id="nojs">You should enable javascript!!</div></noscript>

        </body>
</html> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-08T11:06:03.433

显示横幅并使用 JavaScript 隐藏它。因此，如果未启用 JavaScript，则会显示！

例如

```
<img src="myimage.gif" id="myImage" />

<script type="text/javascript">

window.onload = function(){
   document.getElementById("myImage").style.display="none";
}

</script> 
```

# lldb - LLDB 中的浮点格式（调试 C++）

> ID：11382615
> 
> 赞同：2
> 
> 时间：2012-07-08T11:03:42.580
> 
> 标签：lldb

给定 a `double d`，我可以打印它，

```
(lldb) expr d
(double) $2 = 3.05658e-08 
```

有没有办法打印更多的d位数，例如

```
printf("%.15f", d) ? 
```

有问题的 LLDB 版本是 LLDB-112.2，随 OS X 10.7.4 提供

**编辑：**使用

```
(lldb) expr (int) printf("%.15f", d) 
```

导致进程被杀死，并带有

```
LLVM ERROR: Internal relocations not supported. 
```

错误信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T05:15:44.737

lldb-112.2 在这一点上有点老了（我想大概有六七个月大了）；根据 Xcode 4.5 lldb（lldb-167 左右）检查它，现在看起来它可以正常工作了。

```
0.000000030565830
Process 77907 stopped
* thread #1: tid = 0x1c03, 0x0000000100000f34 a.out`main + 52 at a.c:6, stop reason = breakpoint 1.1
    #0: 0x0000000100000f34 a.out`main + 52 at a.c:6
   3    {
   4      double d = .00000003056583;
   5      printf ("%.15f\n", d);
-> 6      return 5;
   7    }
(lldb) p d
(double) $0 = 3.05658e-08
(lldb) expr (int)printf("%.15f\n", d)
(int) $1 = 18
0.000000030565830 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T11:06:10.613

你有没有尝试过：

```
printf("%.15f", d) 
```

?

# c# - 在 C# 中将数组添加到列表对象

> ID：11382618
> 
> 赞同：-2
> 
> 时间：2012-07-08T11:04:10.803
> 
> 标签：c#, .net, windows

我有以下代码，并在启动器中添加了一个数组：

```
 var GraphList = new List<object>{
  new []{ "Year", "Sales", "Expenses"},
  new []{ "2010", "2012", "2001" },
  new []{ "80", "100", "200"} 
```

如何不使用构造函数添加新数组，即

```
GraphList.Add.new []{ "80", "100", "200"}; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-08T11:05:09.813

这应该有效（我认为这`GraphList`在范围内）：

```
GraphList.Add(new []{ "80", "100", "200"}); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-08T11:05:36.990

```
GraphList.Add(new[] { "80", "100", "200" }); 
```

# android - 果冻豆谷歌语音文本到语音API？

> ID：11382621
> 
> 赞同：4
> 
> 时间：2012-07-08T11:04:18.153
> 
> 标签：android, voice, android-4.2-jelly-bean

有没有办法可以使用新版 Google Voice 中的文字转语音功能？在 Jelly Bean 中，发音非常流畅，所以我在想可能有某种 API 可以访问该服务？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T17:07:34.140

是的，可以使用 Android TTS API 访问 Google Now 语音。您需要在 TextToSpeech.speak() 调用的“params”参数中使用“KEY_FEATURE_NETWORK_SYNTHESIS”。

看

[http://developer.android.com/reference/android/speech/tts/TextToSpeech.Engine.html#KEY_FEATURE_NETWORK_SYNTHESIS](http://developer.android.com/reference/android/speech/tts/TextToSpeech.Engine.html#KEY_FEATURE_NETWORK_SYNTHESIS)

和

[http://developer.android.com/reference/android/speech/tts/TextToSpeech.html#speak(java.lang.String,int,java.util.HashMap)](http://developer.android.com/reference/android/speech/tts/TextToSpeech.html#speak%28java.lang.String,%20int,%20java.util.HashMap%3Cjava.lang.String,%20java.lang.String%3E%29)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T15:55:45.620

您是否尝试过仅使用标准 TextToSpeech 类？

有关用法，请参阅[参考](http://developer.android.com/reference/android/speech/tts/TextToSpeech.html)。您可以将“引擎”字符串传递给构造函数。如果 JB TTS 引擎显示为不同的引擎，您可以在那里选择它。但我假设如果您只选择标准 TTS 引擎，则会自动使用新的 JB TTS 引擎。

# java - 在Java中按类获取子列表

> ID：11382623
> 
> 赞同：1
> 
> 时间：2012-07-08T11:05:02.250
> 
> 标签：java, list, generics, subclass

假设我有一个

```
ArrayList<Fruit> 
```

我想从任何给定的 Fruit 子类的列表中获取所有元素，例如

```
ArrayList<Apple> 
```

C#似乎有一个比较好用的

```
OfType<T>() 
```

方法。在 Java 中是否有等效的方法？

干杯

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-08T11:11:05.827

```
public static <T> Collection<T> ofType(Collection<? super T> col, Class<T> type) {
  final List<T> ret = new ArrayList<T>();
  for (Object o : col) if (type.isInstance(o)) ret.add((T)o);
  return ret;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-08T11:25:09.100

使用[Guava](https://code.google.com/p/guava-libraries/)，它只是

```
List<Apple> apples =
  Lists.newArrayList(Iterables.filter(fruitList, Apple.class)); 
```

（披露：我为 Guava 做出了贡献。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-08T11:16:41.467

```
List<Fruit> list=new ArrayList<Fruit>();
//put some data in list here
List<Apple> sublist=new ArrayList<Apple>();
for (Fruit f:list)
    if(f instanceof Apple)  
        sublist.add((Apple)f); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-08T11:19:20.713

我们创建了一个名为 JLinq 的小实用程序来获得类似于 java 中 C# 中的 linq 的功能，其中一个类似于 typeof：

```
 /**
 * @param <T> the type of the list
 * @param list the list to filter
 * @param type the desired object type that we need from these list
 * @return a new list containing only those object that from the given type 
 */
public static <T> LinkedList<T> filter(LinkedList<T> list, Class<T> type) {
    LinkedList<T> filtered = new LinkedList<T>();
    for (T object : list) {
        if (object.getClass().isAssignableFrom(type)) {
            filtered.add(object);
        }
    }
    return filtered;
} 
```

# javascript - 将javascript值插入websql数据库

> ID：11382636
> 
> 赞同：0
> 
> 时间：2012-07-08T11:06:34.517
> 
> 标签：javascript, jquery, sql, jquery-mobile, web-storage

我正在尝试将各种选择列表/单选按钮的总值插入 websql 数据库。初始表单正确插入，但是一旦我尝试添加总变量，一切都会中断。我以为我可以使用 getElementByID("total") 并将其添加到表中，但这不起作用。任何想法都非常感谢。（下面的代码在添加似乎破坏它的总 var 更新之前也显示了 db 脚本）

```
 <div id="content">
    <h1> 
         webSQL example
    </h1>
    <div id="form">
        <form id="myRecord">
            <table class="form">
                <tr><td class="label"> Date </td><td> <input type="date" name="date" /> </td></tr>
                <tr><td class="label"> Name </td><td> <input type="text" name="name" /> </td></tr>
                <tr><td class="label"> Number </td><td> <input type="number" name="number" /> </td></tr>
               <tr><td> <label for="select1">Select characteristics present:</label></td></tr>
                <select name="optionsNew" id="select2" multiple="multiple" data-native-menu="false">
                    <option>Click for Options:</option>
                    <option value="value1" data-value="1">one</option>
                    <option value="value2" data-value="1">two</option>
                    <option value="value3" data-value="1">three</option>
                    <option value="value4" data-value="1">four</option>

                </select>
                <tr><td colspan="2" class="button">
                    <input id="formSubmit" type="button" name="goButton" value="Add" onClick="javascript:dbGo()" />
                </td></tr>
            </table>

        <input id="inputAction" type="hidden" name="action" value="add" />
        <input id="inputKey" type="hidden" name="key" value="0" />
        </form>
    </div>

    <p id="rcp" class="message">
        There are <span id="rowCount">_</span> rows in the table.
        <input type="button" value="Empty" onClick="javascript:clearDB()" />
    </p>
 <script>
        $(function() {
    $("select[name='optionsNew']").change(function() { updateTotal(); });
    updateTotal();
});

function updateTotal() {
    var newTotal = 0;
    $("select[name='optionsNew'] option:selected").each(function() {
        newTotal += parseFloat($(this).data('value'));
    });
    $("#total").text("Total: " + newTotal);
}
</script>
        <div id="total">Total : </div>
    <div id="results">
    </div>
</div>
         </div>
            </section> 
```

和 db 帮助脚本：

```
// JavaScript Document

 var db = prepareDatabase();
        var createSQL = 'CREATE TABLE IF NOT EXISTS myDB (' +
                'id INTEGER PRIMARY KEY,' +
                'date TEXT,' +
                'name TEXT,' +
                'number REAL' +

            ')';

        // Check if this browser supports Web SQL
        function getOpenDatabase() {
            try {
                if( !! window.openDatabase ) return window.openDatabase;
                else return undefined;
            } catch(e) {
                return undefined;
            }
        }

        // Open the Web SQL database
        function prepareDatabase() {
            var odb = getOpenDatabase();
            if(!odb) {
                dispError('Web SQL Not Supported');
                return undefined;
            } else {
                var db = odb( 'myDB1', '1.0', ' Database Test', 5 * 1024 * 1024 );
                db.transaction(function (t) {
                    t.executeSql( createSQL, [], function(t, r) {}, function(t, e) {
                        alert('create table: ' + e.message);
                    });
                });
                return db;
            }
        }

 // add or update rows in the table
        function dbGo() {
            if(errorMessage) return;
            var f = element('myRecord');
            var action = f.elements['inputAction'].value;
            var date = f.elements['date'].value;
            var name = f.elements['name'].value;
            var number = f.elements['number'].value;
            <!--var total = document.getElementById("total").value;
-->
            <!--var total = f.elements['total'].value;-->

            var key = f.elements['key'].value;

          // handle either "add" or "update" action
    switch(action) {
    case 'add': 
        if(! (date || name || number)) break;
          db.transaction( function(t) { t.executeSql(' INSERT INTO myDB (date, name, number ) VALUES ( ?, ?, ?) ',
                [ date, name, number ]
            );
        }, function(t, e){ alert('Insert row: ' + e.message); }, function() {
            resetmyRecord();
        });
        break;
    case 'update':
        if(! (date || name || number)) break;
        db.transaction( function(t) {
            t.executeSql(' UPDATE myDB SET date = ?, name = ?, number = ?  WHERE id = ?',
                [ date, name, number , key ]
            );
        }, function(t, e){ alert('Update row: ' + e.message); }, function() {
            resetmyRecord();
        });
        break;
  }
            dispResults();
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T20:00:36.740

Got it, just bad create statement, and using .html works fine.

```
var db = prepareDatabase();
        var createSQL = 'CREATE TABLE IF NOT EXISTS myDB (' +
                'id INTEGER PRIMARY KEY,' +
                'date TEXT,' +
                'name TEXT,' +
                 'total INTEGER,' +
                'number REAL' +

            ')';

 function dbGo() {
            if(errorMessage) return;
            var f = element('myRecord');
            var action = f.elements['inputAction'].value;
            var date = f.elements['date'].value;
            var name = f.elements['name'].value;
            var number = f.elements['number'].value;
        var total=$('#total').html();
            var key = f.elements['key'].value;

    switch(action) {
    case 'add': 
        if(! (date || name || number || total )) break; 
```

# java - 如何返回一个通用的 ArrayList

> ID：11382643
> 
> 赞同：0
> 
> 时间：2012-07-08T11:06:55.510
> 
> 标签：java, generics, arraylist

抱歉，不知道谁最好地提出问题，但我会在这里尝试解释我的问题，我有以下课程：

```
public class ReadOnlyTable<T extends Model> implements ReadOnly<T> {
...

protected ReadOnlyTable() {
    initTable();
}

protected void reloadDataSource() {
    initTable();
}

...

@Override
public ArrayList<T> findAll() {
    ArrayList<T> result = null;

    try {
        long startTime = System.currentTimeMillis();
        result = datasource.getAllEntries();
        //  // Logger.getLogger().write("FindAllQuery time was " + (System.currentTimeMillis() - startTime) + "ms");
    } catch (Exception e) {
        e.printStackTrace();
        return null;
    }

    return result;
} 
```

假设 T 是类“Galaxy”，然后我尝试使用以下代码遍历返回的数组中的所有元素

```
 for (Galaxy gal : gDAO.findAll()) {

    } 
```

为什么它给我一个错误，说需要 Galaxy，但找到了对象？我做错了什么，我有返回类型 ArrayList 而不是 ArrayList<T>

**编辑1：**

gDAO 是这样定义的

```
private static GalaxyDAO gDAO = (GalaxyDAO) DAOFactory.get(GalaxyDAO.class); 
```

而 DAOFactory 看起来像这样

```
 public static <T> T get(Class clazz) {
    if (!instanceList.containsKey(clazz)) {
        try {

            GenericDAO genericDAO = null;
            Constructor constructor;
            constructor = clazz.getDeclaredConstructor();
            constructor.setAccessible(true);
            genericDAO = (GenericDAO) constructor.newInstance();
            instanceList.put(clazz, genericDAO);

            return (T)genericDAO;
        } catch (NoSuchMethodException ex) {
            DebugBuffer.writeStackTrace(DAOFactory.class.getName(), ex);
        } catch (SecurityException ex) {
            DebugBuffer.writeStackTrace(DAOFactory.class.getName(), ex);
        } catch (InstantiationException ex) {
            DebugBuffer.writeStackTrace(DAOFactory.class.getName(), ex);
        } catch (IllegalAccessException ex) {
            DebugBuffer.writeStackTrace(DAOFactory.class.getName(), ex);
        } catch (InvocationTargetException ex) {
            DebugBuffer.writeStackTrace(DAOFactory.class.getName(), ex);
        }
    }else{
        return (T)instanceList.get(clazz);
    }

    return null;
} 
```

最后

```
public class GalaxyDAO extends ReadWriteTable<Galaxy> implements GenericDAO { 
```

是的.. ReadWriteTable 扩展了 ReadOnlyTable

```
public abstract class ReadWriteTable<T extends Model> extends ReadOnlyTable implements ReadWrite<T> {
public ReadWriteTable() {              
    super();
} 
```

**公认解决方案的附录**

我的推断中有一个错误，导致无法将类型提供给 ReadOnlyTable 参见

```
public interface ReadWrite<T> extends ReadOnly { 
```

代替

```
public interface ReadWrite<T> extends ReadOnly<T> { 
```

修复后我也可以更改以下行

```
public abstract class ReadWriteTable<T extends Model> extends ReadOnlyTable<T> implements ReadWrite<T> { 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T11:15:42.243

`gDAO`是你的类的一个实例`ReadOnlyTable<T extends Model>`？它的类型参数是什么（你是如何声明的）？

它必须是`Galaxy`，否则将无法正常工作。

更新：既然你发布了更多代码，问题是你必须将类型参数传递给方法所在`Galaxy`的类，否则它不知道 T 是什么，并且会返回。`ReadOnlyTable<T extends Model>``findAll``ArrayList<Object>`

这条线是问题所在：

```
public abstract class ReadWriteTable<T extends Model> extends ReadOnlyTable implements ReadWrite<T> 
```

ReadOnlyTable 类也必须接收类型参数：

```
ReadOnlyTable<T extends Model> 
```

所以这条线必须是：

```
public abstract class ReadWriteTable<T extends Model> extends ReadOnlyTable<T extends Model> implements ReadWrite<T> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T11:27:08.853

问题在于`ReadWriteTable`声明，您已将其声明为

```
public abstract class ReadWriteTable<T extends Model> extends ReadOnlyTable implements ReadWrite<T> 
```

扩展原始类型`ReadOnlyTable`而不是参数化的`ReadOnlyTable<T>`. 将其更改为

```
public abstract class ReadWriteTable<T extends Model> extends ReadOnlyTable<T> implements ReadWrite<T> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-08T11:35:56.080

问题是您将 GalaxyDAO 声明为行类型，​​它应该这样声明：

```
public class GalaxyDAO<Galaxy> extends ReadWriteTable<Galaxy> implements GenericDAO 
```

我很担心你收到了编译器警告，不要忽视警告，你应该像错误一样威胁他们！

# php - 如何使用 nohup 从 php-cgi 执行 php-cli

> ID：11382644
> 
> 赞同：4
> 
> 时间：2012-07-08T11:06:57.680
> 
> 标签：php

我正在尝试从 php-cgi 执行 php-cli 脚本
我在下面得到的内容不适用于 cgi。
但是，当我直接从 shell 执行它时，它确实有效。
有没有办法做到这一点？

```
<?php 

if (PHP_SAPI === 'cli')
{
    require '../boot.php';
    Logger::mailit();
    exit;
}

class Logger {

    private static $instance = NULL;

    private function __construct(){}

    public function __destruct()
    {
        if (PHP_SAPI != 'cli')
        {
            exec('nohup php '. __FILE__ .' &');
        }
    }

    public static function mailit(){

        // Database stuff ...

        mail( $row->email, $row->subject, $row->message, $row->headers);
    }

}
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T11:23:31.413

您必须将类的调用 ( `Logger::mailit()`) 放在类的定义 ( `class Logger`) 之后。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T11:55:12.073

得到它实际工作，这只是一个小错误

改变了这个：

```
require '../boot.php'; 
```

对此：

```
require __dir__.'/../boot.php'; 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-08T11:33:47.033

您可以删除 CLI 检查`if (PHP_SAPI === 'cli')`，或包含该文件并 `require '../boot.php'; Logger::mailit();`自己调用。或者您可以查看[exec()](http://php.net/exec)（或[proc_open()](http://php.net/proc_open)，...）将脚本作为自己的进程执行。如果您需要沙盒，这可能是必要的。

* * *

你试过类似的东西`exec('your/script.php &')`吗？（[诺胡普](http://en.wikipedia.org/wiki/Nohup)）

* * *

使用[proc_open()](http://php.net/proc_open)你可以为你的脚本设置环境（包括时髦的文件描述符）。使用[proc_get_status()](http://php.net/proc_get_status)，您可以获得使用 proc_open() 启动的进程的 PID。使用[posix_kill()](http://php.net/posix_kill)您可以向进程发送信号。

如果我没记错的话，您的父进程（在您的情况下是 php-cgi）会一直运行，直到子进程（在您的情况下是 php-cli）完成 - 即使您设置了非阻塞执行。

# jquery - 如果字段等于某个值，jquery addclass to field

> ID：11382655
> 
> 赞同：3
> 
> 时间：2012-07-08T11:09:17.927
> 
> 标签：jquery, onchange, jquery-chosen

如果所选值等于某个值，我试图将一个类动态添加到输入中。

```
$("#schedule_event").chosen().change( function() {
        $('#1').slideUp();
        $('#2').slideUp();
        $('#3').slideUp();
        $('#' + $(this).val()).slideDown();
        if($(this).val == 1) {
            $("#schedule_opponent_id").addClass("required");
        } 
```

或者如果有办法通过 RoR 验证器验证这一点，将非常感谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-08T11:12:12.223

您有正确的方法，但`val`它是一种方法而不是属性（因此您需要添加`()`来调用它）。如果不满足您的条件，您可能还应该删除该课程。这样，如果该字段更改为具有`1`该`#schedule_opponent_id`字段以外的值的选项，将不再具有`required`该类。

```
$("#schedule_event").chosen().change( function() {
    $('#1').slideUp();
    $('#2').slideUp();
    $('#3').slideUp();
    $('#' + $(this).val()).slideDown();
    if($(this).val() == 1) {
        $("#schedule_opponent_id").addClass("required");
    } else {
        $("#schedule_opponent_id").removeClass("required");
    } 
```

# css - CSS：如何更改活动导航页面菜单的颜色

> ID：11382664
> 
> 赞同：13
> 
> 时间：2012-07-08T11:11:37.507
> 
> 标签：css, navigation

我正在尝试更改用户在我的网站上选择的活动或当前页面导航链接的颜色。我究竟做错了什么？谢谢。

到目前为止，CSS 看起来像这样：

```
div.menuBar
{
   font-family: BirchStd;
   font-size: 40px;
   line-height: 40px;
   font-weight: bold;
   text-align: center;
   letter-spacing: -0.1em;
}

div.menuBar li{list-style:none; display: inline;}
div.menuBar li a:active{color:#FF0000;}
div.menuBar ul{margin:0;} 
```

我的 HTML 使用 include PHP 函数调用导航菜单的页面模板：

```
<div class="menuBar">
  <ul>
  <li><a href="index.php">HOME</a></li>
  <li><a href="two.php">PORTFOLIO</a></li>
  <li><a href="three.php">ABOUT</a></li>
  <li><a href="four.php">CONTACT</a></li>
  <li><a href="five.php">SHOP</a></li>
 </ul> 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-07-08T11:20:13.813

我认为您对`a:active`CSS 选择器的作用感到困惑。这只会在您单击链接时更改链接的颜色（并且仅在单击期间，即鼠标按钮保持按下的时间）。您需要做的是`.selected`在您的 CSS 中引入一个新类，例如，当您选择一个链接时，使用新类更新选定的菜单项，例如

```
<div class="menuBar">
    <ul>
        <li class="selected"><a href="index.php">HOME</a></li>
        <li><a href="two.php">PORTFOLIO</a></li>
        ....
    </ul>
</div>

// specific CSS for your menu
div.menuBar li.selected a { color: #FF0000; } 
// more general CSS
li.selected a { color: #FF0000; } 
```

您需要更新模板页面以接收`selectedPage`参数。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-08T11:18:42.270

CSS`:active`状态是指被点击链接的活动状态——例如，当您点击它但尚未释放鼠标按钮的那一刻。它不知道您在哪个页面上，也无法将任何样式应用于菜单项。

要解决您的问题，您必须创建一个类并将其手动添加到当前页面的菜单中：

```
a.active { color: #f00 }

<ul>
    <li><a href="index.php" class="active">HOME</a></li>
    <li><a href="two.php">PORTFOLIO</a></li>
    <li><a href="three.php">ABOUT</a></li>
    <li><a href="four.php">CONTACT</a></li>
    <li><a href="five.php">SHOP</a></li>
</ul> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-08T11:15:27.203

`current`为活动/当前页面添加 ID ：

```
<div class="menuBar">
  <ul>
  <li id="current"><a href="index.php">HOME</a></li>
  <li><a href="two.php">PORTFOLIO</a></li>
  <li><a href="three.php">ABOUT</a></li>
  <li><a href="four.php">CONTACT</a></li>
  <li><a href="five.php">SHOP</a></li>
 </ul>

#current a { color: #ff0000; } 
```

# php - PHP MYSQL 语法

> ID：11382669
> 
> 赞同：0
> 
> 时间：2012-07-08T11:12:03.443
> 
> 标签：php, mysql, select, drop-down-menu

我的 MYSQL 查询有点问题

我有一个装满产品的数据库，我有一个下拉菜单，让用户可以选择他们希望在一天中的什么时间获得结果：-

*   落下
    *   早餐
    *   午餐
    *   晚上
    *   随时

目前我的声明是

```
SELECT * from DEALS WHERE timeofday='post data from form'; 
```

现在这工作正常，但使用“随时”选项，我希望查询能够搜索上述所有/任何结果的结果。

我在想也许做一个 IF 语句，它会触发 2 个单独的查询，一个说如果`$_POST['timeofday'] == 'Anytime'`然后触发

```
SELECT * from DEALS where timeofday='Breakfast' 
OR timeofday='Lunch' OR timeofday='Evening'; 
```

否则只需执行正常查询，尽管想知道是否可以仅在一个语句中执行此操作。

亲切的问候

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-08T11:15:31.983

```
$query = 'SELECT * from DEALS';
if ($_POST['timeofday'] != 'Anytime') {
    $query .= ' WHERE timeofday="' . $_POST['timeofday'] . '"';
} 
```

正如 DCoder 所提到的，这种方法容易受到 sql 注入的影响......您应该检查/清理输入或使用准备好的语句。在这种情况下，如果有一组预定义的值，您可以：

```
$knownTimesOfDay = array('Breakfast', 'Lunch', 'Evening', 'Anytime');
if (!in_array($_POST['timeofday'])) {
    die('Unsuppotred time of day... Did it really come from the form?');
}
$query = 'SELECT * from DEALS';
if ($_POST['timeofday'] != 'Anytime') {
    $query .= ' WHERE timeofday="' . $_POST['timeofday'] . '"';
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T11:16:22.827

不要认为它可以在一个声明中完成。

无论如何，您将不得不使用 if 语句。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-08T11:16:45.787

如果这些是 timeofday 的唯一 3 个可能值，那么您可以在 php 脚本中设置一个 if，如下所示：

```
if($_POST['timeofday'] != 'Anytime' )
    sql .= "where timeofday='".$_POST['timeofday']."'"; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-08T11:51:33.463

根据表中的项目，这可能会变成负数，但您可以使用：

```
SELECT * from DEALS where timeofday LIKE '%{$post_data}%' 
```

`timeofday`如果 $post_data 是空字符串，它将返回所有结果。

# sql - 编写查询以插入标识列

> ID：11382672
> 
> 赞同：0
> 
> 时间：2012-07-08T11:12:51.217
> 
> 标签：sql, sql-server

我在表的列中使用了身份密钥，例如

```
create table test(testid int identity(1,1),testname varchar(10)) 
```

然后我插入了 2 行

```
Insert into test(testname) values('c')
Insert into test(testname) values('c#') 
```

现在，我的表包含如下：

```
1     c    
2     c# 
```

但是，我想在这个表测试中插入另一行，比如 5 c++

所以，我的表将包含

```
1       c   
2       c#  
5      c++ 
```

所以，请尽快将输出发送给我。请帮助我。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-08T11:17:46.340

您可以使用[SET IDENTITY_INSERT](http://msdn.microsoft.com/en-us/library/aa259221.aspx)：

```
SET IDENTITY_INSERT test ON;

Insert into test(testid, testname)values(5, 'c++');

SET IDENTITY_INSERT test OFF; 
```

[SQL 小提琴](http://sqlfiddle.com/#!3/81ea0/4)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T11:17:31.130

```
SET IDENTITY_INSERT test ON

INSERT test (testid , testname)
VALUES (5, 'c++')

SET IDENTITY_INSERT test OFF 
```

# objective-c - 目标c中的scanf返回奇怪的结果

> ID：11382673
> 
> 赞同：1
> 
> 时间：2012-07-08T11:12:59.327
> 
> 标签：objective-c, scanf

以下返回目标 c 中的奇数结果。

```
#import <Foundation/Foundation.h>
#import <math.h>
#import <stdio.h>
#import <string.h>

char risk[2];
char gen1[1];
printf("Enter gender: ");
scanf("%s",gen1);
printf("Enter risk: ");
scanf("%s",risk); 
```

我得到了 gen1 的结果 gen1 + risk 而不仅仅是 gen1。换句话说，如果 gen1 = "m" 和 risk = "ns" 那么我得到 gen1 = "mns" 而不仅仅是 "m"。

在以前的版本中，这工作得很好。最近将 OS X 更新到 7.8 以及新的预览版 XCode。不知道我在这里做错了什么。

谢谢大家，

娄

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T11:17:12.417

您必须为终止 NUL 字符腾出空间：

```
char risk[3];
char gen1[2]; 
```

gen1 为“mns”的可能原因是在风险之后立即分配在堆栈上，并且 scanf 覆盖了 gen1 的终止 NUL 字符，有效地将其与风险连接起来。

# vb.net - 在 vb.net 中引用未实例化的对象

> ID：11382679
> 
> 赞同：5
> 
> 时间：2012-07-08T11:13:57.750
> 
> 标签：vb.net

嗨，我必须学习 VB.net 才能获得一份以前是 C# 人的新工作。我刚刚遇到了 VB.net 的一个有趣的特性。我可以在第二个表单上引用尚未实例化的对象！

所以从 Form1 我可以得到 Form2 上 textbox1 的 text 属性，如下所示

```
Dim txt As String = Form2.TextBox1.Text 
```

谁能解释这是如何工作的？是否所有表单都在程序开始时设置，然后在整个程序生命周期内切换它们的可见性？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-08T11:18:55.170

VB 中的表单是一种特殊情况。[`My.Forms`编译器在命名空间的对象](http://msdn.microsoft.com/en-us/library/87y2hdsf%28v=vs.80%29.aspx)中生成一个强类型的表单列表 `My`。每个表单都作为一个属性公开`My.Forms.TheNameOfTheForm`。这些属性总是返回有效的实例——即如果一个表单之前没有被实例化，它会在你第一次使用该属性时被实例化。

到现在为止还挺好。

但微软也做出了脑死（！）的决定，即`My.Forms`默认从对象导入属性，*无处不在*，你无能为力。从表面上看，这是出于向后兼容 VB6 的原因，但这是无稽之谈，因为 VB7 (.NET 1.0) 没有此功能，它只是后来才出现的。

但只是为了澄清：

> 是否所有表格都在程序开始时设置...？

不，幸运的是没有。它们在您第一次访问该属性时被实例化。

# asp.net - Plupload完成上传后执行vb.net Code Behind Method

> ID：11382682
> 
> 赞同：2
> 
> 时间：2012-07-08T11:14:10.767
> 
> 标签：asp.net, .net, ajax, vb.net, plupload

又遇到了一个路障。现在我有一个页面，其中包含`Plupload`一个转发器，它基本上从数据库中提取所有上传的图像。此页面在 中动态加载`colorbox`。

我需要的是转发器在新图像上传到数据库时自行更新。为此，我只需调用中继器并对其进行数据绑定 (Repeater1.Databind())。我很确定解决方案在于，`Ajax`但我环顾四周，甚至用它们来调用 Web 服务，但是你如何执行方法背后的代码？

我要执行的方法背后的代码是：

```
Public Sub reBind()
    Dim dt2 As DataTable = blOrgLogo.getOrgLogo(userId, False).Tables(0)
    If (dt2 Is Nothing) Or (dt2.Rows.Count = 0) Then
        ' Nothing is returned
    Else
        repLogoCollection.DataSource = dt2
        repLogoCollection.DataBind()
    End If
End Sub 
```

我在网上看到的一个例子表明这可以使用`PageMethods`，但我无法使用上述方法。

我无法使用该`ASP.Net Ajax Timer`控件，因为当通过颜色框加载页面时它似乎无法正常工作。（如果有人对此有解决方案，那就太棒了，因为这会简化一切哈哈）

我不确定是否有用的另一条信息是转发器绑定在 page_load 中。

```
Protected Sub Page_Load(sender As Object, e As System.EventArgs) Handles Me.Load
    userId = Session("UserID")
    Dim dt As DataTable = blOrgLogo.getOrgLogo(userId, False).Tables(0)

    If (Not IsPostBack) Then
        If (dt Is Nothing) Or (dt.Rows.Count = 0) Then
            ' Nothing is returned
        Else
            Repeater1.DataSource = dt
            Repeater1.DataBind()
        End If
    End If
End Sub 
```

Plupload javascript：

```
// Client side form validation
$('#uploader').submit(function (e) {
    var uploader = $('#uploader').pluploadQueue();

    // Validate number of uploaded files
    if (uploader.total.uploaded == 0) {
        // Files in queue upload them first
        if (uploader.files.length > 0) {
            // When all files are uploaded submit form
            uploader.bind('UploadProgress', function () {
                if (uploader.total.uploaded == uploader.files.length)
                    $('form').submit();
            });

            uploader.start();

        } else
            alert('You must at least upload one file.');

        e.preventDefault();
    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T18:38:18.200

您将需要使用

```
 $.ajax({
            type: "POST",
//Location to the webservice or the webmethod
            url: "Services/Service.asmx/reBind",
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function(data) {
            //on success     
            },
            error: function(ex) {
           //on error            
            }
        }); 
```

在你的方法之上添加`[WebMethod(true)]`你可能需要找到这个的 vb.net 等价物，因为那是我用于 c# 的。

至于 ajax 调用，我不确定您是否必须将代码放在 Web 服务中，我很确定即使它在一个类中它也会起作用，您可能必须同时尝试这两种方法。

# blackberry - 调试时的 BlackBerry 应用程序抛出 java.langNoClassDefFoundError

> ID：11382683
> 
> 赞同：0
> 
> 时间：2012-07-08T11:14:13.233
> 
> 标签：blackberry, noclassdeffounderror

> **可能重复：**
> [NoClassDefFoundError 导入库项目](https://stackoverflow.com/questions/3244621/noclassdeffounderror-importing-a-library-project)

我的黑莓应用程序突然停止工作。我的模拟器或/和我的应用程序没有加载，我得到“未捕获的异常：java.lang.NoClassDefFoundError”。自上次测试以来，我没有对我的代码进行任何更改。出了什么问题？

```
package mypackage;

import java.io.DataInputStream;
import java.io.DataOutputStream;
import java.io.IOException;
import java.io.InputStream;
import java.io.OutputStream;
import java.rmi.RemoteException;
import java.util.Hashtable;
import java.util.Vector;

import javacard.framework.UserException;

import javax.microedition.io.Connector;
import javax.microedition.io.HttpConnection;
import javax.microedition.location.Location;
import javax.microedition.location.LocationProvider;

import org.kobjects.base64.Base64;
import org.ksoap2.SoapEnvelope;
import org.ksoap2.serialization.SoapObject;
import org.ksoap2.serialization.SoapPrimitive;
import org.ksoap2.serialization.SoapSerializationEnvelope;
import org.ksoap2.transport.HttpTransport;
import org.xmlpull.v1.XmlPullParserException;

import net.rim.device.api.system.*;
import net.rim.device.api.ui.*;
import net.rim.device.api.ui.component.*;
import net.rim.device.api.ui.component.pane.TitleView;
import net.rim.device.api.ui.container.*;
import net.rim.device.api.ui.image.Image;

public class LoginTest extends UiApplication 
{

    public static void main(String[] args)  
    {
         //Create a new instance of the app
         //and start the app on the event thread.

        LoginTest app = new LoginTest();
        app.enterEventDispatcher();
    }

    public LoginTest()
    {
         //Display a new screen.
         pushScreen(new LoginTestScreen());
    }

}

//Create a new screen that extends MainScreen and provides
//behaviour similar to that of other apps.

final class LoginTestScreen extends MainScreen
{
   //declare variables for later use
   private InfoScreen _infoScreen;
   private ObjectChoiceField choiceField;
   private int select;
   BasicEditField username;
   PasswordEditField passwd;
   CheckboxField checkBox1;
   ButtonField loginBtn;

   public LoginTestScreen()
   {
        //Invoke the MainScreen constructor.

        super();

        //Add a screen title.

        setTitle("Track24ELMS");

        LabelField login = new LabelField("ELMS Login", LabelField.FIELD_HCENTER); 
        login.setFont(Font.getDefault().derive(Font.BOLD, 30));
        login.setMargin(10, 0, 20, 0); //To leave some space from top and bottom

        HorizontalFieldManager user = new HorizontalFieldManager();
        user.setMargin(0, 0, 10, 0);
        HorizontalFieldManager pass = new HorizontalFieldManager();
        pass.setMargin(0, 0, 20, 0);
        HorizontalFieldManager checkbox = new HorizontalFieldManager();
        checkbox.setMargin(0, 0, 30, 0);
        HorizontalFieldManager btns = new HorizontalFieldManager(HorizontalFieldManager.FIELD_HCENTER);

        LabelField usernameTxt = new LabelField("Username :");
        LabelField passwordTxt = new LabelField("Password :");

        username = new BasicEditField();
        passwd = new PasswordEditField();

        loginBtn = new ButtonField("Login", ButtonField.CONSUME_CLICK); 
        loginBtn.setChangeListener(new LoginButtonListener());

        checkBox1 = new CheckboxField("Remember me",false);

        user.add(usernameTxt);
        user.add(username);
        pass.add(passwordTxt);
        pass.add(passwd);
        btns.add(loginBtn);
        add(login);
        add(user);
        add(pass);
        add(checkBox1);
        add(btns);

}

   private class LoginButtonListener implements FieldChangeListener {
       public void fieldChanged(Field field, int context) {
//Open a new screen

       String uname = username.getText();
       String pwd = passwd.getText();
       String sep = "</>";
       //If there is no input
       if (uname.length() == 0 || pwd.length()==0)
       Dialog.alert("One of the textfield is empty!");
       else 
       {
           String URL = "http://xxx.xxx.com/xxx/xxx.asmx";
           String METHOD_NAME = "ValidateCredentials";
           String NAMESPACE = "http://tempuri.org/";
           String SOAP_ACTION = NAMESPACE+METHOD_NAME;
           //final String URL = "http://prerel.track24elms.com/Android/T24AndroidLogin.asmx/ValidateCredentials";

           SoapObject resultRequestSOAP = null;
           HttpConnection httpConn = null;
           HttpTransport httpt;
           System.out.println("The username" + uname + "password" + pwd );
           SoapPrimitive response = null;
           SoapObject request = new SoapObject(NAMESPACE, METHOD_NAME);
           //String usernamecode = Base64.encode(uname.getBytes());
           //String pwdEncodeString = Base64.encode(pwd.getBytes());
           request.addProperty("username", uname);
           request.addProperty("password", pwd);
           System.out.println("The request is=======" + request.toString());
           SoapSerializationEnvelope envelope = new SoapSerializationEnvelope(SoapEnvelope.VER11);
           //envelope.bodyOut = request;
           envelope.dotNet = true;
           //envelope.encodingStyle = SoapSerializationEnvelope.XSD;
           envelope.setOutputSoapObject(request);
           System.out.println("The envelope has the value++++"+ envelope.toString());

          /* URL+  Here you can add paramter so that you can run on device,simulator etc. this will work only for wifi */
           httpt = new HttpTransport(URL+ ";deviceside=true;ConnectionUID=S TCP");
           //httpt.setXmlVersionTag("<?xml version=\"1.0\" encoding=\"UTF-8\"?>");
           httpt.debug = true;
           try
           {
               System.out.println("SOAP_ACTION    ==   " + SOAP_ACTION);
               httpt.call(SOAP_ACTION, envelope);
               response = (SoapPrimitive) envelope.getResponse();
               String result =  response.toString();
               System.out.println("response    ==   " + result);
               resultRequestSOAP = (SoapObject) envelope.bodyIn;
               System.out.println("result    ==   " + resultRequestSOAP); 

               String[] listResult = split(result, sep);

           }
           catch (IOException e) {
               // TODO Auto-generated catch block
               System.out.println("The exception is IO==" + e.getMessage());
           } catch (XmlPullParserException e) {

               // TODO Auto-generated catch block
               System.out.println("The exception xml parser example==="
                       + e.getMessage());
           }
           System.out.println( resultRequestSOAP);
           //UiApplication.getUiApplication().pushScreen(new InfoScreen()); //Open a new Screen

       }
       }

       };

     private String[] split(String original, String separator) {
            Vector nodes = new Vector();
            int index = original.indexOf(separator);
            while (index >= 0) {
                nodes.addElement(original.substring(0, index));
                original = original.substring(index + separator.length());
                index = original.indexOf(separator);
            }
            nodes.addElement(original);
            String[] result = new String[nodes.size()];
            if (nodes.size() > 0) {
                for (int loop = 0; loop < nodes.size(); loop++) {
                    result[loop] = (String) nodes.elementAt(loop);
                    System.out.println(result[loop]);
                }
            }
            return result;
       }

   //To display a dialog box when a BlackBerry device user
   //closes the app, override the onClose() method.

   public boolean onClose()
   {
       Dialog.alert("Goodbye!");
        System.exit(0);
        return true;
   }

   //Create a menu item for BlackBerry device users to click to see more 
   //information about the city they select.

   private MenuItem _viewItem = new MenuItem("More Info", 110, 10) 
   {
        public void run() 
        {
             //Store the index of the city the BlackBerry device user selects

             select = choiceField.getSelectedIndex();

             //Display a new screen with information about the
             //city the BlackBerry device user selects

                 _infoScreen = new InfoScreen();
                UiApplication.getUiApplication().pushScreen(_infoScreen);
        }
   };

   //Create a menu item for BlackBerry device users to click to close 
   //the app.

   private MenuItem _closeItem = new MenuItem("Close", 200000, 10) 
   {
        public void run()
        {
             onClose();
        }
   };

   //Create an inner class for a new screen that displays
   //information about the city a BlackBerry device user selects.

   private class InfoScreen extends MainScreen
   {
       String latitude, logitude, altitude;

        public InfoScreen() 
        {
             super();

             setTitle("Itinerary");

             LabelField login = new LabelField("Employee Itinerary", LabelField.FIELD_HCENTER); 

             HorizontalFieldManager userDetails = new HorizontalFieldManager();
             userDetails.setMargin(0, 0, 10, 0);
             HorizontalFieldManager statusBox = new HorizontalFieldManager();
             statusBox.setMargin(0, 0, 20, 0);
             HorizontalFieldManager locationDetails = new HorizontalFieldManager();
             locationDetails.setMargin(0, 0, 30, 0);
             HorizontalFieldManager imgBtn = new HorizontalFieldManager();
             imgBtn.setMargin(0, 0, 40, 0);

             //BitmapField userImg = new BitmapField(Bitmap.getBitmapResource("img1.jpg"));
             LabelField userFetched = new LabelField("Sarah Farukh");
             LabelField lastStatus = new LabelField("I am OK");
             EditField statusMsg = new EditField("Status Message", "Update status here");

             EditField lat = new EditField("Latitude", "latitude");
             EditField longi = new EditField("Longitude", "logitude");
             EditField alti = new EditField("Attitude", "altitude");

             //BitmapField btnOK = new BitmapField(Bitmap.getBitmapResource("ok.png"),Field.FIELD_BOTTOM);
             //BitmapField btnNO = new BitmapField(Bitmap.getBitmapResource("no.png"),Field.FIELD_BOTTOM);
             //BitmapField btnHN = new BitmapField(Bitmap.getBitmapResource("hn.png"),Field.FIELD_BOTTOM);

             //userDetails.add(userImg);
             userDetails.add(userFetched);
             userDetails.add(lastStatus);
             statusBox.add(userFetched);
             locationDetails.add(lat);
             locationDetails.add(longi);
             locationDetails.add(alti);
             //imgBtn.add(btnOK);
             //imgBtn.add(btnNO);
             //imgBtn.add(btnHN);
             add(login);
             add(userDetails);
             add(statusBox);
             add(locationDetails);
             add(imgBtn);

        }
   }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T11:26:27.703

您可能正在访问单独库中的类。您已经设置了项目，以便**在构建时**找到该类。

**如果该库由于某种原因没有部署到设备上（忘记了？部署时出错？），那么在运行时**将找不到您的类。

确保将此库正确部署到设备上（通过上传正确的编译 COD 文件）。或者通过正确设置构建路径将库包含到您的项目中。

（我的答案基于这个：[NoClassDefFoundError importing a library project](https://stackoverflow.com/a/8379228/383414)）

# android - 从 Android Alarmmanager 打开 Activity

> ID：11382686
> 
> 赞同：-1
> 
> 时间：2012-07-08T11:14:40.160
> 
> 标签：android, android-manifest, android-alarms

我为 Alarmmanager 找到了这些 Toturials： [http ://michael.theirwinfamily.net/articles/android/android-creating-alarm-alarmmanager](http://michael.theirwinfamily.net/articles/android/android-creating-alarm-alarmmanager)

这是一个不使用广播的。

但这并不是说我应该在清单文件中放入什么，因此活动开始了。

我尝试了以下方法，但这些都不起作用：

```
<receiver android:name="alarm.starter.AlarmReceiverActivity"></receiver>
<receiver android:name=".AlarmReceiverActivity"></receiver>
<receiver android:name="AlarmReceiverActivity"></receiver> 
```

请帮忙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T14:03:54.280

这不使用任何 BroadcastReceiver，因此您无需向`<receiver>`清单添加任何标签。警报只是启动一个活动。您只需要在`<activity>`标签中声明您的 AlarmReceiverActivity。你也不需要`intent.setAction()`打电话。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T11:27:49.400

您需要在清单文件中添加操作字符串，阅读[此](https://stackoverflow.com/questions/11366332/making-an-alarm-program-not-working/11366469#11366469)答案可能会对您有所帮助

尽管您刚才共享的代码表明您没有启动任何正在使用活动的接收器，因此请在清单中添加以下行

```
<activity android:name=".AlarmReceiverActivity"/> 
```

# android - 使用 Http 请求使用 AsyncTask 解析 xml

> ID：11382688
> 
> 赞同：0
> 
> 时间：2012-07-08T11:15:21.727
> 
> 标签：android, xml, parsing, dom, android-asynctask

我正在使用 HTTP 请求建立与 Internet 的连接，解析 XML 一切正常，但我想做的是从 AsyncTask 为新版本的 android sdk 建立连接。通常不应该给出问题，但我正在关注一个教程，在尝试了许多选项并在这个网站上看到类似的线程之后，我无法正确应用它。

这是我正在使用的代码

活动一：

```
public class CustomizedListView extends Activity {
    // All static variables
    static final String URL = "http://api.androidhive.info/music/music.xml";
    // XML node keys
    static final String KEY_SONG = "song"; // parent node
    static final String KEY_ID = "id";
    static final String KEY_TITLE = "title";
    static final String KEY_ARTIST = "artist";
    static final String KEY_DURATION = "duration";
    static final String KEY_THUMB_URL = "thumb_url";

    private ArrayList<HashMap<String, String>> data;

    ListView list;
    LazyAdapter adapter;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        final ArrayList<HashMap<String, String>> songsList = new ArrayList<HashMap<String, String>>();

        XMLParser parser = new XMLParser();
        String xml = parser.getXmlFromUrl(URL); // getting XML from URL
        Document doc = parser.getDomElement(xml); // getting DOM element

        NodeList nl = doc.getElementsByTagName(KEY_SONG);
        // looping through all song nodes <song>
        for (int i = 0; i < nl.getLength(); i++) {
            // creating new HashMap
            HashMap<String, String> map = new HashMap<String, String>();
            Element e = (Element) nl.item(i);
            // adding each child node to HashMap key => value
            map.put(KEY_ID, parser.getValue(e, KEY_ID));
            map.put(KEY_TITLE, parser.getValue(e, KEY_TITLE));
            map.put(KEY_ARTIST, parser.getValue(e, KEY_ARTIST));
            map.put(KEY_DURATION, parser.getValue(e, KEY_DURATION));
            map.put(KEY_THUMB_URL, parser.getValue(e, KEY_THUMB_URL));

            // adding HashList to ArrayList
            songsList.add(map);
        }

        list=(ListView)findViewById(R.id.list);

        // Getting adapter by passing xml data ArrayList
        adapter=new LazyAdapter(this, songsList);        
        list.setAdapter(adapter);

    }   
} 
```

这是第二个活动：

```
public class XMLParser {

    // constructor
    public XMLParser() {

    }

    /**
     * Getting XML from URL making HTTP request
     * @param url string
     * */
    public String getXmlFromUrl(String url) {
        String xml = null;

        try {
            // defaultHttpClient
            DefaultHttpClient httpClient = new DefaultHttpClient();
            HttpPost httpPost = new HttpPost(url);

            HttpResponse httpResponse = httpClient.execute(httpPost);
            HttpEntity httpEntity = httpResponse.getEntity();
            xml = EntityUtils.toString(httpEntity);

        } catch (UnsupportedEncodingException e) {
            e.printStackTrace();
        } catch (ClientProtocolException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }
        // return XML
        return xml;
    }

    /**
     * Getting XML DOM element
     * @param XML string
     * */
    public Document getDomElement(String xml){
        Document doc = null;
        DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();
        try {

            DocumentBuilder db = dbf.newDocumentBuilder();

            InputSource is = new InputSource();
                is.setCharacterStream(new StringReader(xml));
                doc = db.parse(is); 

            } catch (ParserConfigurationException e) {
                Log.e("Error: ", e.getMessage());
                return null;
            } catch (SAXException e) {
                Log.e("Error: ", e.getMessage());
                return null;
            } catch (IOException e) {
                Log.e("Error: ", e.getMessage());
                return null;
            }

            return doc;
    }

    /** Getting node value
      * @param elem element
      */
     public final String getElementValue( Node elem ) {
         Node child;
         if( elem != null){
             if (elem.hasChildNodes()){
                 for( child = elem.getFirstChild(); child != null; child = child.getNextSibling() ){
                     if( child.getNodeType() == Node.TEXT_NODE  ){
                         return child.getNodeValue();
                     }
                 }
             }
         }
         return "";
     }

     /**
      * Getting node value
      * @param Element node
      * @param key string
      * */
     public String getValue(Element item, String str) {     
            NodeList n = item.getElementsByTagName(str);        
            return this.getElementValue(n.item(0));
        }
} 
```

...我知道它必须封装在 AsycTask 中是：

```
try {
            // defaultHttpClient
            DefaultHttpClient httpClient = new DefaultHttpClient();
            HttpPost httpPost = new HttpPost(url);

            HttpResponse httpResponse = httpClient.execute(httpPost);
            HttpEntity httpEntity = httpResponse.getEntity();
            xml = EntityUtils.toString(httpEntity);

        } catch (UnsupportedEncodingException e) {
            e.printStackTrace();
        } catch (ClientProtocolException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }
        // return XML
        return xml; 
```

...但是要使用两个活动的字符串，我找不到办法

非常感谢你的帮助

问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T12:00:06.067

在您的活动中使用这种类型的类作为子类：

```
 private class YourDownload extends AsyncTask<Void, Void, Void> {

        @Override
        protected Void doInBackground(Void... params) {
            /*
                        make connection & download XML here, 
                        use your XML parser class object to parse the xml from here

                        create ArrayList & etc. from here...

                    */
            return null;

        }

        @Override
        protected void onPostExecute(Void result) {
            // postexecute logic
            super.onPostExecute(result);
        }

        @Override
        protected void onPreExecute() {
            // pre execute logic
            super.onPreExecute();
        }

    } 
```

使用*onCreate()*中的*YourDownload*作为*`new YourDownload().execute();`*

 *可能这会帮助你..*

# c - printf 参数相互影响

> ID：11382694
> 
> 赞同：2
> 
> 时间：2012-07-08T11:15:42.707
> 
> 标签：c, double, printf

我有以下代码：

```
double dtemp = (some value)
printf("\n***Hand washing: cost per kg/item: %.2f, cost: %.2f.\n", 5, dtemp); 
```

它打印出来：

> ***手洗：每公斤/件的成本：0.00，成本：0.00。

当我将常量 5 更改为持有 5 的双变量时，它会打印（根据输入）：

> ***手洗：每公斤/件的成本：5.00，成本：20.00。

为什么常数 5 会影响 dtemp 的评估？我正在使用 gcc 4.6.2 (MinGW) 并在 TCC 中对其进行了测试。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-08T11:17:06.247

`f`转换说明符`double`在与`printf`函数一起使用时需要 a 并且您正在传递`int`. 传递 an`int`是未定义的行为，这意味着任何事情都可能发生。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-07-08T11:18:11.180

我的编译器 (gcc 4.4.3) 警告消息解释了这一点：

```
 format ‘%.2f’ expects type ‘double’, but argument 2 has type ‘int’ 
```

由于您传递的值类型`int`( ) 与格式字符串中指定的 ( ) 类型不同`double`，因此由于这种不匹配，行为未定义

正如您所观察到的，一旦您将其调整为一致，您就会得到您期望的输出。IE，

```
/* provide a double value */
printf("\n***Hand washing: cost per kg/item: %.2f, cost: %.2f.\n", 5.0, dtemp); 
```

输出：

```
***Hand washing: cost per kg/item: 5.00, cost: 3.14. 
```

或者

```
/* specify an integer value in the format string */
printf("\n***Hand washing: cost per kg/item: %d, cost: %.2f.\n", 5, dtemp); 
```

输出：

```
***Hand washing: cost per kg/item: 5, cost: 3.14. 
```

提高编译器上的警告级别，然后跟进所有警告，并慎重决定哪些可以忽略，哪些不能忽略，这始终是一个好主意。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-08T11:41:44.827

e printf函数第一个参数是字符串，每隔%d检查一次，然后移动点，例如：%d,move 4 len；%lld 移动 8\. int64_t a = 1;int b = 2; printf("%d, %d\n", a, b); 答案是 1,0。因为这两个 %d 只是得到较低的 4 字节和高 4 字节。

printf("\n***洗手：每公斤/件的成本：%.2f，成本：%.2f.\n", 5, dtemp); sizeof(doubel) = 8 ，所以 printf 函数只得到 0x0000000000000005。

我希望它会帮助你。

# uml - UML 状态机：如何退出正交子区域？

> ID：11382695
> 
> 赞同：3
> 
> 时间：2012-07-08T11:15:58.080
> 
> 标签：uml, state-machine

基于[Wikipedia](http://en.wikipedia.org/wiki/UML_state_machine#Orthogonal_regions)，我可以进行分层状态分解，其中我有多个正交区域，可以独立更改状态。

该图显示了如何输入正交区域。我假设该条目在所有地区并行发生。我想知道的是，你如何表达出口？如果每个区域都有出口，那么全局父状态是在第一个子区域退出时退出，还是在它们全部退出时退出？我想表达的是，退出发生在他们*全部*退出时。*由于所有子区域都已退出*，您如何表示全局父状态转换到下一个全局状态？这总是隐含的吗？

我的具体问题是我的 FSM 以 Initializing 全局状态开始。它以并行方式异步向多个外部系统发送多个查询。只有在收到每个查询的答案后，它才能继续。因此，我将每个异步并行查询建模为全局初始化状态内的正交区域。每个子区域都可以独立改变状态。当所有子区域都达到最终状态时，我可以继续前进。

FSM 将在 Actor 框架中实现，其中异步消息（事件）是唯一的通信方式。

理想情况下，我希望答案指向一个示例图像，因为这样的事情很难用语言表达。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-08T15:27:38.730

从正交状态的完成转换将起到作用，因为它将在所有正交区域都完成时进行。

当进入复合状态（具有内部状态和/或正交区域的状态）时，每个区域从其初始状态开始，使用分叉伪节点到每个区域中的不同状态，或者如果进入状态，则到每个区域的最后状态通过历史伪状态。退出复合状态可以通过从内部状态之一开始的转换来完成，该内部状态存在与其当前状态的所有正交区域。如果您想在机器进入不同区域的一组状态时退出，您还可以使用连接伪状态。

如您所见，可能性几乎是无穷无尽的。我还不能添加图像，但我会在手头有一个好的 UML 编辑器时添加它。

一个现在的例子。假设您有以下状态机： ![示例状态机](../Images/50478af0aa642106fe031fa7d5762d4b.png)

1.  如果两个并行区域都完成（到达最终节点），则完成转换将使机器从`S1`到`S5`。如果
2.  如果机器当前在`S3`并且接收`e1`，它将退出`S1`并转到`S6`。
3.  如果机器在`S7`并且`S8`它们都完成了，它将进入连接，然后进入`S6`。

这就是我知道状态机工作的方式。

# linux - 为什么 syslog 文件中的内核日志消息（或重定向到终端的消息）恰好落后一个“消息”？

> ID：11382698
> 
> 赞同：1
> 
> 时间：2012-07-08T11:16:34.813
> 
> 标签：linux, linux-kernel, syslog

我在 Ubuntu 10.04 机器上写了一个简单的 hello-world 模块。加载和卸载模块时，printk 应该记录来自以下 hello_world 和 bye_world 函数的消息。

```
static int hello_world()
{
        printk(KERN_INFO "Hello, beautiful world");
        return 0;
}

static void bye_world()
{
        printk(KERN_INFO "Good-bye kernel uncle");
}

module_init(hello_world);
module_exit(bye_world); 
```

但是，当实际插入和删除 hello.ko 模块时，我看到终端上打印的消息（我将其重定向到当前终端）恰好是后面的一条消息。

> ```
> # rmmod hello.ko
> # Jul  8 16:34:02 panchavati kernel: [64599.954113] Hello, beautiful world
> 
> # insmod hello.ko
> # Jul  8 16:34:57 panchavati kernel: [65456.367422] Good-bye kernel uncle 
> ```

从 dmesg 输出中，我可以看到下一条消息条目（对应于 insmod）已被记录，只是尚未打印。

> ```
> chanakya@panchavati:~$ dmesg | tail -2
> [65456.367422] Good-bye kernel uncle
> [65511.198299] Hello, beautiful world 
> ```

该条目`[65511.198299]`存在于内核日志中，但仅`[65456.367422] Good-bye kernel uncle`打印了前一个条目。为什么会这样？

我之前认为/etc/syslog.conf 中使用的[“-”说明符](http://linux.die.net/man/8/syslogd)可能必须对此做一些事情（它会阻止每次写入后的同步），但删除它也不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T02:58:10.863

您是否尝试过使用`tailf`（或`tail -f`）？它会在消息到达时打印出来。例如：

```
 tailf /var/log/messages 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-04-07T23:05:03.627

尝试用换行符（“\n”）结束你的字符串。

# google-maps - Google Maps API 点击地图获取经度和纬度

> ID：11382699
> 
> 赞同：-1
> 
> 时间：2012-07-08T11:16:36.987
> 
> 标签：google-maps, google-maps-api-3

我正在尝试构建一个非常有用的网络服务，并希望简化使用谷歌地图的地点选择。是否有可能通过单击地图获得经度和纬度并将其写下来以输入标签？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-08T11:23:02.770

这是我将如何做到这一点：

```
var map = ...;
google.maps.event.addListener(map, 'click', function (event) {
    $('input.latitude').val(event.latLng.lat());
    $('input.longitude').val(event.latLng.lng());
}); 
```

# c# - 一致性：将整数除以 2 的幂与 10 的幂？

> ID：11382708
> 
> 赞同：1
> 
> 时间：2012-07-08T11:17:34.013
> 
> 标签：c#, actionscript-3, floating-point, deterministic, non-deterministic

这是一个关于浮点运算的跨平台一致性和确定性的问题（IE 在不同的 CPU/系统上产生不同的结果）

哪一个更有可能保持跨平台一致（伪代码）：

```
float myFloat = float ( myInteger) / float( 1024 ) 
```

或者

```
float myFloat = float ( myInteger ) / float( 1000 ) 
```

平台是 C# 和 AS3。

.

AS3 版本：

```
var myFloat:Number = myInteger  /  1000 // AS3
var myFloat:Number = myInteger  /  1024 // AS3 
```

- 好的，我添加了 AS3 版本以进行澄清，相当于上面的“C 伪代码”。正如您在 AS3 中看到的，所有计算，即使是整数，都会自动作为浮点数执行，不需要强制转换（也不能避免它或强制运行时执行真正的整数除法）希望这可以解释为什么我“强制转换”所有内容成花车：我不是！这只是在一种目标语言中发生的事情！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T11:40:21.253

第一个在两个平台上可能相同，因为不存在表示问题。特别是对于小整数（最高 8 位未使用），只有一个确切的结果，并且很可能会使用该结果。

但我不会依赖它。如果您需要有保证的确定性，我建议您自己在纯整数之上实现所需的算术。例如使用定点表示。

第二个可能不一致，即使在不同的硬件或 .net 版本上使用相同的 C# 代码也是如此。请参阅相关问题[C# 中的浮点数学是否一致？是真的吗？](https://stackoverflow.com/questions/6683059/are-floating-point-numbers-consistent-in-c-can-they-be)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T12:54:14.413

我建议您阅读 IEEE 754-1985 标准。[可以以 43 美元的价格购买一份副本。](http://ieeexplore.ieee.org/xpl/mostRecentIssue.jsp?punumber=2355)尽管已被 2008 版本取代，但它是对浮点的极好介绍，因为它只有 20 页，而且可读性很强。它将向您展示为什么除以 1000 和除以 1024 都是确定性的，以及为什么前者可能有错误但后者没有（下溢除外）。它还将为您理解所获得的答案以及为什么您走错了路提供了基础。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-08T14:05:01.830

> 哪一个更有可能保持跨平台一致（伪代码）：

除以 1024。 *每个*基于二进制的浮点系统（IEEE754、IBM、VAX、Cray）将除以 1024 应用于所有*有限*数将在给定的表示中产生*精确的*结果。原因是除以 1024 等价于

*   将位向右移动 10 个位置，这意味着
*   将二进制指数减 10

如果数字太小（对于IEEE754 1E-38/1E-308），你会失去一个精确的结果，但这不是操作的问题，而是数字的有限范围......它根本无法显示这么小的结果准确无误。

由于不需要舍入，因此舍入不会有任何差异（是的，虽然大多数编程语言使用舍入到偶数，但有些语言可以选择另一种舍入模式）。

# javascript - 将动态创建的 ASP.NET 控件传递给 Javascript

> ID：11382713
> 
> 赞同：0
> 
> 时间：2012-07-08T11:18:32.100
> 
> 标签：javascript, asp.net, dynamic-controls

我在我的 ASP.NET Web 应用程序表行中动态生成一个文本框和一个下拉列表，我想使用 javascript 根据 dropdownlist selectedindex 更改文本框的值，但我不知道如何将这些动态创建的控件传递给我的 Javascript功能。

```
 TextBox t = new TextBox();
                tc.Controls.Add(t);
                tr.Cells.Add(tc);

                tc = new TableCell();
                DropDownList ddl = new DropDownList();
                ddl.Attributes.Add("onChange", "return OnFoodChange(this," + t + ");");
                tc.Controls.Add(ddl); 
```

我通过'this'而不是我的组合框，它工作正常，但在我的以下javascript函数中未检测到文本框：

```
 function OnFoodChange(myCmb,myTxt) {
try{
               var q = document.getElementById('<%= HFFoodPrice.ClientID %>').value.toString();
               var q2 = q.split(';');
               alert(myCmb.selectedIndex.toString());
               alert(document.getElementById(myTxt.value));
               for (var j = 0; j < q2.length; j++) {
                   if (q2[j] != '') {
                       var q3 = q2[j].split(',');
                   {

                   }
               }
           }
           }
           catch(err)
           {
           alert(err.message);
           }
       } 
```

将动态创建的控件传递给 javascript 函数的正确方法是什么？我应该在我的代码隐藏中设置控件 ID 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T11:26:34.087

在 C# 中：

```
ddl.Attributes.Add("onChange", "return OnFoodChange(this," + t.ClientID + ");"); 
```

在 Javascript 中，试试这个：

```
alert(document.getElementById(myTxt).value); 
```

# mongodb - 是否可以在 Doctrine 2 ODM 中的多个字段上使用 sort()？

> ID：11382716
> 
> 赞同：9
> 
> 时间：2012-07-08T11:18:54.927
> 
> 标签：mongodb, sorting, symfony1, doctrine-orm, odm

我正在对我的学说*mongodb* *odm* 中的结果文档进行查询。文档中有两个索引字段，我想在排序中使用它们。我写过类似的东西：

```
$results = $this->createQueryBuilder('Document\Score')
            ->sort('finalScore', 'desc')
            ->sort('date', 'desc')
            ->getQuery()
            ->execute(); 
```

这里第二个`sort()`函数覆盖第一个函数，并且永远找不到指定的结果。

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-08T11:55:49.090

试试这个

```
$qb = $this->createQueryBuilder('Document\Score');
$qb->sort(array(
    'finalScore' => 'desc',
    'date'       => 'desc',
));
$results = $qb->getQuery()->execute(); 
```

# spring - 上下文初始化失败或加载属性

> ID：11382718
> 
> 赞同：2
> 
> 时间：2012-07-08T11:19:08.417
> 
> 标签：spring, properties, compiler-errors, applicationcontext

我在构建应用程序时遇到问题，我收到此错误：

```
VII 08, 2012 10:03:46 DOP. org.apache.catalina.startup.Embedded start
INFO: Starting tomcat server
VII 08, 2012 10:03:46 DOP. org.apache.catalina.core.StandardEngine start
INFO: Starting Servlet Engine: Apache Tomcat/6.0.29
VII 08, 2012 10:03:47 DOP. org.apache.catalina.core.ApplicationContext log
INFO: Initializing Spring root WebApplicationContext
INFO : org.springframework.web.context.ContextLoader - Root WebApplicationContext: initialization started
INFO : org.springframework.web.context.support.XmlWebApplicationContext - Refreshing Root WebApplicationContext: startup date [Sun Jul 08 10:03:47 CEST 2012]; root of context hierarchy
INFO : org.springframework.beans.factory.xml.XmlBeanDefinitionReader - Loading XML bean definitions from URL [file:/D:/work/projekty/java/evrem/target/classes/META-INF/spring/root-context.xml]
INFO : org.springframework.context.annotation.ClassPathBeanDefinitionScanner - JSR-330 'javax.inject.Named' annotation found and supported for component scanning
INFO : org.springframework.beans.factory.xml.XmlBeanDefinitionReader - Loading XML bean definitions from URL [file:/D:/work/projekty/java/evrem/target/classes/META-INF/spring/bean-context.xml]
INFO : org.springframework.beans.factory.xml.XmlBeanDefinitionReader - Loading XML bean definitions from URL [file:/D:/work/projekty/java/evrem/target/classes/META-INF/spring/security-context.xml]
INFO : org.springframework.beans.factory.support.DefaultListableBeanFactory - Destroying singletons in org.springframework.beans.factory.support.DefaultListableBeanFactory@28f2525: defining beans [org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping#0,org.springframework.format.support.FormattingConversionServiceFactoryBean#0,org.springframework.validation.beanvalidation.LocalValidatorFactoryBean#0,org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter#0,org.springframework.web.servlet.handler.MappedInterceptor#0,org.springframework.web.servlet.mvc.method.annotation.ExceptionHandlerExceptionResolver#0,org.springframework.web.servlet.mvc.annotation.ResponseStatusExceptionResolver#0,org.springframework.web.servlet.mvc.support.DefaultHandlerExceptionResolver#0,org.springframework.web.servlet.handler.BeanNameUrlHandlerMapping,org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter,org.springframework.web.servlet.mvc.SimpleControllerHandlerAdapter,org.springframework.context.annotation.internalConfigurationAnnotationProcessor,org.springframework.context.annotation.internalAutowiredAnnotationProcessor,org.springframework.context.annotation.internalRequiredAnnotationProcessor,org.springframework.context.annotation.internalCommonAnnotationProcessor,org.springframework.context.annotation.internalPersistenceAnnotationProcessor,userRepository,org.springframework.data.repository.core.support.RepositoryInterfaceAwareBeanPostProcessor#0,org.springframework.dao.annotation.PersistenceExceptionTranslationPostProcessor#0,org.springframework.orm.jpa.support.PersistenceAnnotationBeanPostProcessor#0,org.springframework.aop.config.internalAutoProxyCreator,org.springframework.transaction.annotation.AnnotationTransactionAttributeSource#0,org.springframework.transaction.interceptor.TransactionInterceptor#0,org.springframework.transaction.config.internalTransactionAdvisor,homeController,org.springframework.beans.factory.config.PropertyPlaceholderConfigurer#0,entityManagerFactory,transactionManager,dataSource,messageSource,org.springframework.web.servlet.handler.MappedInterceptor#1,localeResolver,pageUtil,org.springframework.security.web.PortMapperImpl#0,org.springframework.security.web.context.HttpSessionSecurityContextRepository#0,org.springframework.security.web.authentication.session.SessionFixationProtectionStrategy#0,org.springframework.security.authentication.ProviderManager#0,org.springframework.security.web.access.expression.DefaultWebSecurityExpressionHandler#0,org.springframework.security.access.vote.AffirmativeBased#0,org.springframework.security.web.access.intercept.FilterSecurityInterceptor#0,org.springframework.security.web.access.DefaultWebInvocationPrivilegeEvaluator#0,org.springframework.security.authentication.AnonymousAuthenticationProvider#0,org.springframework.security.authentication.RememberMeAuthenticationProvider#0,org.springframework.security.web.savedrequest.HttpSessionRequestCache#0,org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter#0,org.springframework.security.config.http.UserDetailsServiceInjectionBeanPostProcessor#0,org.springframework.security.filterChainProxy,org.springframework.security.provisioning.JdbcUserDetailsManager#0,org.springframework.security.authentication.dao.DaoAuthenticationProvider#0,org.springframework.security.authentication.DefaultAuthenticationEventPublisher#0,org.springframework.security.authenticationManager,org.springframework.context.annotation.ConfigurationClassPostProcessor$ImportAwareBeanPostProcessor#0]; root of factory hierarchy
ERROR: org.springframework.web.context.ContextLoader - Context initialization failed
org.springframework.beans.factory.BeanDefinitionStoreException: Invalid bean definition with name 'dataSource' defined in URL [file:/D:/work/projekty/java/evrem/target/classes/META-INF/spring/root-context.xml]: Could not resolve placeholder 'jdbc.url'
    at org.springframework.beans.factory.config.PlaceholderConfigurerSupport.doProcessProperties(PlaceholderConfigurerSupport.java:209)
    at org.springframework.beans.factory.config.PropertyPlaceholderConfigurer.processProperties(PropertyPlaceholderConfigurer.java:220)
    at org.springframework.beans.factory.config.PropertyResourceConfigurer.postProcessBeanFactory(PropertyResourceConfigurer.java:84)
    at org.springframework.context.support.AbstractApplicationContext.invokeBeanFactoryPostProcessors(AbstractApplicationContext.java:681)
    at org.springframework.context.support.AbstractApplicationContext.invokeBeanFactoryPostProcessors(AbstractApplicationContext.java:656)
    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:446)
    at org.springframework.web.context.ContextLoader.configureAndRefreshWebApplicationContext(ContextLoader.java:385)
    at org.springframework.web.context.ContextLoader.initWebApplicationContext(ContextLoader.java:284)
    at org.springframework.web.context.ContextLoaderListener.contextInitialized(ContextLoaderListener.java:111)
    at org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:4135)
    at org.apache.catalina.core.StandardContext.start(StandardContext.java:4630)
    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1045)
    at org.apache.catalina.core.StandardHost.start(StandardHost.java:785)
    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1045)
    at org.apache.catalina.core.StandardEngine.start(StandardEngine.java:445)
    at org.apache.catalina.startup.Embedded.start(Embedded.java:825)
    at org.codehaus.mojo.tomcat.AbstractRunMojo.startContainer(AbstractRunMojo.java:558)
    at org.codehaus.mojo.tomcat.AbstractRunMojo.execute(AbstractRunMojo.java:255)
    at org.apache.maven.plugin.DefaultBuildPluginManager.executeMojo(DefaultBuildPluginManager.java:107)
    at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:209)
    at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:153)
    at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:145)
    at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:84)
    at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:59)
    at org.apache.maven.lifecycle.internal.LifecycleStarter.singleThreadedBuild(LifecycleStarter.java:183)
    at org.apache.maven.lifecycle.internal.LifecycleStarter.execute(LifecycleStarter.java:161)
    at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:319)
    at org.apache.maven.DefaultMaven.execute(DefaultMaven.java:156)
    at org.apache.maven.cli.MavenCli.execute(MavenCli.java:534)
    at org.apache.maven.cli.MavenCli.doMain(MavenCli.java:196)
    at org.apache.maven.cli.MavenCli.main(MavenCli.java:141)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.codehaus.plexus.classworlds.launcher.Launcher.launchEnhanced(Launcher.java:290)
    at org.codehaus.plexus.classworlds.launcher.Launcher.launch(Launcher.java:230)
    at org.codehaus.plexus.classworlds.launcher.Launcher.mainWithExitCode(Launcher.java:409)
    at org.codehaus.plexus.classworlds.launcher.Launcher.main(Launcher.java:352)
VII 08, 2012 10:03:48 DOP. org.apache.catalina.core.StandardContext listenerStart
SEVERE: Exception sending context initialized event to listener instance of class org.springframework.web.context.ContextLoaderListener
org.springframework.beans.factory.BeanDefinitionStoreException: Invalid bean definition with name 'dataSource' defined in URL [file:/D:/work/projekty/java/evrem/target/classes/META-INF/spring/root-context.xml]: Could not resolve placeholder 'jdbc.url'
    at org.springframework.beans.factory.config.PlaceholderConfigurerSupport.doProcessProperties(PlaceholderConfigurerSupport.java:209)
    at org.springframework.beans.factory.config.PropertyPlaceholderConfigurer.processProperties(PropertyPlaceholderConfigurer.java:220)
    at org.springframework.beans.factory.config.PropertyResourceConfigurer.postProcessBeanFactory(PropertyResourceConfigurer.java:84)
    at org.springframework.context.support.AbstractApplicationContext.invokeBeanFactoryPostProcessors(AbstractApplicationContext.java:681)
    at org.springframework.context.support.AbstractApplicationContext.invokeBeanFactoryPostProcessors(AbstractApplicationContext.java:656)
    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:446)
    at org.springframework.web.context.ContextLoader.configureAndRefreshWebApplicationContext(ContextLoader.java:385)
    at org.springframework.web.context.ContextLoader.initWebApplicationContext(ContextLoader.java:284)
    at org.springframework.web.context.ContextLoaderListener.contextInitialized(ContextLoaderListener.java:111)
    at org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:4135)
    at org.apache.catalina.core.StandardContext.start(StandardContext.java:4630)
    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1045)
    at org.apache.catalina.core.StandardHost.start(StandardHost.java:785)
    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1045)
    at org.apache.catalina.core.StandardEngine.start(StandardEngine.java:445)
    at org.apache.catalina.startup.Embedded.start(Embedded.java:825)
    at org.codehaus.mojo.tomcat.AbstractRunMojo.startContainer(AbstractRunMojo.java:558)
    at org.codehaus.mojo.tomcat.AbstractRunMojo.execute(AbstractRunMojo.java:255)
    at org.apache.maven.plugin.DefaultBuildPluginManager.executeMojo(DefaultBuildPluginManager.java:107)
    at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:209)
    at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:153)
    at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:145)
    at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:84)
    at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:59)
    at org.apache.maven.lifecycle.internal.LifecycleStarter.singleThreadedBuild(LifecycleStarter.java:183)
    at org.apache.maven.lifecycle.internal.LifecycleStarter.execute(LifecycleStarter.java:161)
    at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:319)
    at org.apache.maven.DefaultMaven.execute(DefaultMaven.java:156)
    at org.apache.maven.cli.MavenCli.execute(MavenCli.java:534)
    at org.apache.maven.cli.MavenCli.doMain(MavenCli.java:196)
    at org.apache.maven.cli.MavenCli.main(MavenCli.java:141)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.codehaus.plexus.classworlds.launcher.Launcher.launchEnhanced(Launcher.java:290)
    at org.codehaus.plexus.classworlds.launcher.Launcher.launch(Launcher.java:230)
    at org.codehaus.plexus.classworlds.launcher.Launcher.mainWithExitCode(Launcher.java:409)
    at org.codehaus.plexus.classworlds.launcher.Launcher.main(Launcher.java:352)

VII 08, 2012 10:03:48 DOP. org.apache.catalina.core.StandardContext start
SEVERE: Error listenerStart
VII 08, 2012 10:03:48 DOP. org.apache.catalina.core.StandardContext start
SEVERE: Context [/evrem] startup failed due to previous errors
VII 08, 2012 10:03:48 DOP. org.apache.catalina.core.ApplicationContext log
INFO: Closing Spring root WebApplicationContext
VII 08, 2012 10:03:48 DOP. org.apache.catalina.loader.WebappClassLoader clearReferencesJdbc
SEVERE: The web application [/evrem] registered the JBDC driver [com.mysql.jdbc.Driver] but failed to unregister it when the web application was stopped. To prevent a memory leak, the JDBC Driver has been forcibly unregistered. 
```

我的 web.xml

```
<?xml version="1.0" encoding="UTF-8"?>

<web-app version="2.4" xmlns="http://java.sun.com/xml/ns/j2ee"
 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
 xsi:schemaLocation="http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd"> 

  <display-name>evrem</display-name>
  <context-param>
    <param-name>defaultHtmlEscape</param-name>
    <param-value>true</param-value>
  </context-param>
  <filter>
    <filter-name>encodingFilter</filter-name>
    <filter-class>org.springframework.web.filter.CharacterEncodingFilter</filter-class>
    <init-param>
      <param-name>encoding</param-name>
      <param-value>UTF-8</param-value>
    </init-param>
    <init-param>
      <param-name>forceEncoding</param-name>
      <param-value>true</param-value>
    </init-param>
  </filter>
  <filter-mapping>
    <filter-name>encodingFilter</filter-name>
    <url-pattern>/*</url-pattern>
  </filter-mapping>
  <context-param>
    <param-name>contextConfigLocation</param-name>
    <param-value>
            classpath*:/META-INF/spring/root-context.xml,
            classpath*:/META-INF/spring/security-context.xml
        </param-value>
  </context-param>
  <listener>
    <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
  </listener>
  <servlet>
    <servlet-name>default1</servlet-name>
    <servlet-class>
          org.apache.catalina.servlets.DefaultServlet
        </servlet-class>
    <init-param>
      <param-name>debug</param-name>
      <param-value>0</param-value>
    </init-param>
    <init-param>
      <param-name>listings</param-name>
      <param-value>true</param-value>
    </init-param>
    <load-on-startup>1</load-on-startup>
  </servlet>
  <servlet>
    <servlet-name>appServlet</servlet-name>
    <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
    <init-param>
      <param-name>contextConfigLocation</param-name>
      <param-value>classpath*:/META-INF/spring/appServlet/servlet-context.xml</param-value>
    </init-param>
    <load-on-startup>1</load-on-startup>
  </servlet>
  <servlet-mapping>
    <servlet-name>appServlet</servlet-name>
    <url-pattern>/</url-pattern>
  </servlet-mapping>
  <filter>
    <filter-name>springSecurityFilterChain</filter-name>
    <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
  </filter>
  <filter-mapping>
    <filter-name>springSecurityFilterChain</filter-name>
    <url-pattern>/*</url-pattern>
  </filter-mapping>
  <error-page>
    <error-code>404</error-code>
    <location>/WEB-INF/views/error/404.jsp</location>
  </error-page>
  <servlet-mapping>
    <servlet-name>default</servlet-name>
    <url-pattern>*.css</url-pattern>
  </servlet-mapping>
  <servlet-mapping>
    <servlet-name>default</servlet-name>
    <url-pattern>*.js</url-pattern>
  </servlet-mapping>
  <servlet-mapping>
    <servlet-name>default</servlet-name>
    <url-pattern>*.gif</url-pattern>
  </servlet-mapping>
  <servlet-mapping>
    <servlet-name>default</servlet-name>
    <url-pattern>*.jpg</url-pattern>
  </servlet-mapping>
  <servlet-mapping>
    <servlet-name>default</servlet-name>
    <url-pattern>*.png</url-pattern>
  </servlet-mapping>
  <servlet-mapping>
    <servlet-name>default</servlet-name>
    <url-pattern>*.txt</url-pattern>
  </servlet-mapping>
</web-app> 
```

根上下文.xml

```
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beans xmlns="http://www.springframework.org/schema/beans" xmlns:aop="http://www.springframework.org/schema/aop" xmlns:context="http://www.springframework.org/schema/context"
    xmlns:jee="http://www.springframework.org/schema/jee" xmlns:jpa="http://www.springframework.org/schema/data/jpa" xmlns:tx="http://www.springframework.org/schema/tx"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:mvc="http://www.springframework.org/schema/mvc"
    xsi:schemaLocation="http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.0.xsd
             http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
             http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd         
             http://www.springframework.org/schema/jee http://www.springframework.org/schema/jee/spring-jee-3.0.xsd
             http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.0.xsd
             http://www.springframework.org/schema/data/jpa http://www.springframework.org/schema/data/jpa/spring-jpa.xsd
             http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd">

    <!-- INITIAL SETTINGS -->

    <mvc:annotation-driven />
    <context:annotation-config />
    <jpa:repositories base-package="com.evrem.webapp.repository" />
    <tx:annotation-driven transaction-manager="transactionManager" />
    <context:component-scan base-package="com.evrem.webapp" />

    <!-- PROPERTIES FILES -->

    <bean
        class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
        <property name="locations">
            <list>
                <value>classpath*:*.properties</value>
            </list>
        </property>
    </bean>

    <!-- DATABASE CONNECTION -->

    <bean id="entityManagerFactory" class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
        <property name="persistenceUnitName" value="persistenceUnit" />
        <property name="dataSource" ref="dataSource" />
        <property name="jpaDialect">
            <bean class="org.springframework.orm.jpa.vendor.HibernateJpaDialect" />
        </property>
    </bean>

    <bean id="transactionManager" class="org.springframework.orm.jpa.JpaTransactionManager">
        <property name="entityManagerFactory" ref="entityManagerFactory" />
    </bean>

    <bean id="dataSource" class="com.mysql.jdbc.jdbc2.optional.MysqlDataSource">
        <property name="url" value="${jdbc.url}" />
        <property name="user" value="${jdbc.username}" />
        <property name="password" value="${jdbc.password}" />
    </bean>

    <!-- LOCALE RESOLVER -->

    <bean id="messageSource" class="org.springframework.context.support.ReloadableResourceBundleMessageSource">
        <property name="basename" value="classpath:localization/messages" />
        <property name="defaultEncoding" value="UTF-8" />
    </bean>

    <mvc:interceptors>
        <bean class="org.springframework.web.servlet.i18n.LocaleChangeInterceptor">
            <property name="paramName" value="lang" />
        </bean>
    </mvc:interceptors>

    <bean id="localeResolver" class="org.springframework.web.servlet.i18n.CookieLocaleResolver">
        <property name="defaultLocale" value="cs_CZ" />
        <property name="cookieMaxAge" value="15768000" />
    </bean>

    <!-- ADDITIONAL BEANS -->

    <import resource="bean-context.xml" />

</beans> 
```

我在 src/main/config 路径中​​有带有 jdbc.url、jdbc.username 和 jdbc.password 的 database.properties。

另外，我想问一下我的项目结构是否正确。

![在此处输入图像描述](../Images/be45f35d18f103b9ba9ae33ad6fa82c8.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-08T11:37:53.270

> 另外，我想问一下我的项目结构是否正确。

不，这实际上导致了您的问题。即使`src/main/config`在 Eclipse 中被标记为项目目录，maven 也不会以任何特殊方式对待它，特别是它不会在 CLASSPATH 中包含该文件夹。检查您构建的 WAR 文件，它甚至不包含这些文件！

通过简单地将所有`*.properties`文件移动到`src/main/resources`您的应用程序应该构建和运行良好。

# php - 意外的“。” PHP中的语法错误

> ID：11382727
> 
> 赞同：-1
> 
> 时间：2012-07-08T11:20:34.700
> 
> 标签：php, syntax

我有一个`Parse error: syntax error, unexpected '.'`. 我检查了报告位置周围的线条，但我不明白为什么它会引发错误。有没有办法得到一个与 PHP 报告中发现的行无关的语法错误？

显然发现错误的代码：

```
$current = "<a href='http://example.com/garrysmod/donate/donate.php?c=" .. $choice .. "&steam=" .. $steam_id .. "'>" .. $words .. "</a>"; 
```

完整的、未完成的代码可以在[这里](http://pastie.org/4219871)找到。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-08T11:21:43.970

双点？它们在 PHP 中没有任何意义！

尝试查看[有关 string concatenation 的手册](http://php.net/manual/en/language.operators.string.php)，您会看到连接字符串只需使用单点即可。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T11:22:16.217

```
$current = "<a href='http://www.example.com/garrysmod/donate/donate.php?c=" .. $choice .. "&steam=" .. $steam_id .. "'>" .. $words .. "</a>"; 
```

应该

```
$current = "<a href='http://www.example.com/garrysmod/donate/donate.php?c=".$choice. "&steam=".$steam_id."'>".$words."</a>"; 
```

# c# - 在java中读取c#二进制文件

> ID：11382728
> 
> 赞同：2
> 
> 时间：2012-07-08T11:20:49.180
> 
> 标签：c#, java, binary

我在 C# .net 中有一个程序，它使用 .net 将 1 个整数和 3 个字符串写入文件`BinaryWriter.Write()`。

现在我正在用 Java 编程（对于 Android，我是 Java 新手），我必须访问以前使用 C# 写入文件的数据。

我尝试使用`DataInputStream.readInt()`and `DataInputStream.readUTF()`，但我无法获得正确的结果。我通常得到一个`UTFDataFormatException`：

> java.io.UTFDataFormatException：字节 21 左右的输入格式错误

或者我得到的是错误的`String`......`int`

```
FileInputStream fs = new FileInputStream(strFilePath);
DataInputStream ds = new DataInputStream(fs);
int i;
String str1,str2,str3;
i=ds.readInt();
str1=ds.readUTF();
str2=ds.readUTF();
str3=ds.readUTF();
ds.close(); 
```

这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-15T04:50:30.697

[我在这里](https://github.com/vrecan/Thaw-Giant)写了一个关于如何在 java 中读取 .net 的 binaryWriter 格式的快速示例

摘自链接：

```
 /**
 * Get string from binary stream. >So, if len < 0x7F, it is encoded on one
 * byte as b0 = len >if len < 0x3FFF, is is encoded on 2 bytes as b0 = (len
 * & 0x7F) | 0x80, b1 = len >> 7 >if len < 0x 1FFFFF, it is encoded on 3
 * bytes as b0 = (len & 0x7F) | 0x80, b1 = ((len >> 7) & 0x7F) | 0x80, b2 =
 * len >> 14 etc.
 *
 * @param is
 * @return
 * @throws IOException
 */
public static String getString(final InputStream is) throws IOException {
    int val = getStringLength(is);

    byte[] buffer = new byte[val];
    if (is.read(buffer) < 0) {
        throw new IOException("EOF");
    }
    return new String(buffer);
}

/**
 * Binary files are encoded with a variable length prefix that tells you
 * the size of the string. The prefix is encoded in a 7bit format where the
 * 8th bit tells you if you should continue. If the 8th bit is set it means
 * you need to read the next byte.
 * @param bytes
 * @return
 */
public static int getStringLength(final InputStream is) throws IOException {
    int count = 0;
    int shift = 0;
    boolean more = true;
    while (more) {
        byte b = (byte) is.read();
        count |= (b & 0x7F) << shift;
        shift += 7;
        if((b & 0x80) == 0) {
            more = false;
        }
    }
    return count;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T11:51:34.817

顾名思义，BinaryWriter 以二进制格式写入。准确地说是.Net 二进制格式，并且由于java 不是.Net 语言，它无法读取它。您必须使用可互操作的格式。

您可以选择现有格式，如 xml 或 json 或任何其他互操作格式。

或者您可以创建自己的，只要您的数据足够简单，可以这样（这里似乎就是这种情况）。只要您知道字符串的格式，只需将字符串写入文件（例如使用 StreamWriter）。然后从java中读取你的文件作为一个字符串并解析它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-08T12:35:37.367

在这个问题中对 BinaryWriter 使用的格式有一个很好的解释[Right Here](https://stackoverflow.com/q/1488486/1045728)应该可以使用 ByteArrayInputStream 读取数据并编写一个简单的翻译器。

# python - 如何从 django 项目中删除应用程序

> ID：11382734
> 
> 赞同：27
> 
> 时间：2012-07-08T11:22:33.297
> 
> 标签：python, django

最初，我在 Django 的一个项目中制作了 2 个应用程序（app_a 和 app_b）。现在我想删除一个（比如 app_a）。我该怎么做？从设置文件中删除应用程序名称是否`INSTALLED_APPS`足够？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2012-07-08T11:27:55.130

您需要删除或检查以下内容：

*   从 中删除应用程序`INSTALLED_APPS`。
*   删除该应用程序中模型的所有数据库表（参见`app_name_model_name`您的数据库）。
*   检查其他应用程序中的任何导入（可能是他们正在从该应用程序导入代码）。
*   检查模板是否正在使用该应用程序的任何模板标签（如果该应用程序不再存在，则会产生错误）。
*   检查您的设置文件，看看您是否没有使用该应用程序中的任何代码（例如 中的上下文处理器`your_app/context_processors.py`，如果它有这样的文件）。
*   检查应用程序的任何静态内容是否在其他应用程序中使用。
*   完全删除应用程序目录。

如果您一直遵循正确的编码原则（即，每个 Django 应用程序都是 Web 应用程序的独立部分），那么上述大多数情况都不会发生。但是当其他应用程序确实使用了该应用程序的某些部分时，您需要首先检查它，因为它可能需要在删除应用程序之前进行重构。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T11:31:05.827

这取决于应用程序（安装方式、使用方式等），但通常您可以从中删除应用程序`INSTALLED_APPS`，然后删除其在数据库中的表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-03-28T12:55:52.633

如果在**Simeon Visser解释的操作和****Elias Dorneles**在评论中引用的其他答案之后，在 runserver 之后你会得到这样的东西：

```
System check identified 1 issue (0 silenced).
Exception in thread django-main-thread:
Traceback (most recent call last):
  File "C:\python\releases\381_x64\lib\threading.py", line 932, in _bootstrap_inner
  [...]
  File "c:\python\env\django3python381\lib\site-packages\django\db\migrations\graph.py", line 58, in raise_error
    raise NodeNotFoundError(self.error_message, self.key, origin=self.origin)
django.db.migrations.exceptions.NodeNotFoundError: Migration oeuvres.0001_initial dependencies reference nonexistent parent node ('medias', '0001_initial') 
```

浏览到您的 appname.migrations 文件夹并评论对您要删除的应用程序的任何引用。在上述情况下，**oeuvres**应用程序对我要删除的**medias**应用程序有依赖关系，它在**oeuvres.0001_initial**迁移文件中定义。

我不认为/不知道这是否会对迁移过程产生影响，但我打算重置所有迁移内容以进行生产，然后导入数据，即如此处所述： [https ://simpleisbetterthancomplex.com/tutorial/2016/ 07/26/how-to-reset-migrations.html](https://simpleisbetterthancomplex.com/tutorial/2016/07/26/how-to-reset-migrations.html)

# asp.net - 如何在 ReportViewer 中以编程方式进行页面导航？

> ID：11382735
> 
> 赞同：4
> 
> 时间：2012-07-08T11:22:35.557
> 
> 标签：asp.net, reporting-services

我正在使用 Reporting Services 在 ASP.NET 中编写报告。我想隐藏 ReportViewer 的工具栏并拥有自己的“下一页”和“上一页”按钮。有没有办法以编程方式浏览 ReportViewer 页面？是否有“NextPage”和“PreviousPage”等方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-11-13T15:54:52.557

我只是想我会添加到这一点，因为我一直在做类似的事情，并构建了一组 JavaScript（使用 JQuery）函数，您可以在其中传递 ReportViewerID，它允许您添加下一个、上一个、第一个和最后一个等等到您自己的自定义工具栏按钮。只需在文档准备好时使用 ReportViewer_HideToolbar 功能隐藏工具栏。认为值得分享，因为我在昨天搜索几个小时时找不到任何东西。即使它只是某人的起点，至少它更接近并且有帮助:-)

ps 我使用的是 ReportViewer 10，其他的可能不同，无法正常工作。

```
function ReportViewer_FirstPage(ReportViewerID) {
    var ReportViewer = $("span[id$='" + ReportViewerID + "_ReportViewer'")
    ReportViewer.find("input[title='First Page']").first().click()
}

function ReportViewer_NextPage(ReportViewerID) {
    var ReportViewer = $("span[id$='" + ReportViewerID + "_ReportViewer'")
    ReportViewer.find("input[title='Next Page']").first().click()
}

function ReportViewer_PreviousPage(ReportViewerID) {
    var ReportViewer = $("span[id$='" + ReportViewerID + "_ReportViewer'")
    ReportViewer.find("input[title='Previous Page']").first().click()
}

function ReportViewer_LastPage(ReportViewerID) {
    var ReportViewer = $("span[id$='" + ReportViewerID + "_ReportViewer'")
    ReportViewer.find("input[title='Last Page']").first().click()
}

var tReportViewerLastFindText = ""
function ReportViewer_Set_SearchText(ReportViewerID, tText) {
    var ReportViewer = $("div[id$='MainPlaceHolder_" + ReportViewerID + "'")
    ReportViewer.find("input[title='Find Text in Report']").val(tText)
    var m_reportViewer = $find($(ReportViewer).attr('id'))
    if (tReportViewerLastFindText != tText) {
        m_reportViewer.find(tText)
        tReportViewerLastFindText = tText
    } else {
        m_reportViewer.findNext()
    }
}

function ReportViewer_Set_PageNumber(ReportViewerID, tPageNumber) {
    var ReportViewer = $("span[id$='" + ReportViewerID + "_ReportViewer'")
    var CurrentPage = ReportViewer.find("input[title='Current Page']")
    $(CurrentPage).val(tPageNumber)
    __doPostBack(CurrentPage.attr("name"), '')
}

function ReportViewer_Print(ReportViewerID) {
    var ReportViewer = $("div[id$='MainPlaceHolder_" + ReportViewerID + "'")
    var m_reportViewer = $find($(ReportViewer).attr('id'))
    m_reportViewer.invokePrintDialog()
}

function ReportViewer_HideToolbar(ReportViewerID) {
    var ReportViewer = $("span[id$='" + ReportViewerID + "_ReportViewer'")
    $(ReportViewer).find("div[style$='toolbar_bk.png);']").hide()
} 
```

问候利亚姆

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-18T22:10:34.547

如果您隐藏工具栏并拥有自己的页面导航控件，则可以在代码中设置 ReportViewer 的[CurrentPage](http://msdn.microsoft.com/en-US/library/microsoft.reporting.webforms.reportviewer.currentpage%28v=vs.100%29)属性。

# php - Yii 框架：如何设置默认用户角色

> ID：11382740
> 
> 赞同：4
> 
> 时间：2012-07-08T11:23:21.023
> 
> 标签：php, yii

我已经阅读了 Yii 关于“基于角色的访问控制”的文档，但我没有找到在哪里配置默认用户角色。

我已经添加：

```
'authManager'=>array(
         'class'=>'CDbAuthManager',
         'connectionID'=>'db',
         'defaultRoles'=>array('guest', 'authenticated', 'admin'),
), 
```

到受保护的/config/main.php

但是我必须把这些业务规则放在哪里？

```
$bizRule='return !Yii::app()->user->isGuest;';
$auth->createRole('authenticated', 'authenticated user', $bizRule);

$bizRule='return Yii::app()->user->isGuest;';
$auth->createRole('guest', 'guest user', $bizRule);

$bizRule='return Yii::app()->user->admin;';
$auth->createRole('admin', 'admin user', $bizRule); 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T14:47:13.343

通过您开始的代码执行此操作将很痛苦。而是使用为此作业创建的[权限扩展。](http://www.yiiframework.com/extension/rights/)

[权限](http://www.yiiframework.com/extension/rights/)扩展利用 Yii 的内置数据库授权管理器 (CDbAuthManager) 为高级访问控制提供 Web 界面。

# jquery - mvc3 中的 jQuery 移动自定义验证

> ID：11382743
> 
> 赞同：0
> 
> 时间：2012-07-08T11:23:38.450
> 
> 标签：jquery, asp.net-mvc-3

对于表单验证来检查电子邮件是否存在我需要自定义验证我试过钱但没有工作它总是返回电子邮件已经存在我粘贴代码请确认我错误

jQuery 代码在视图中

```
<script type="text/javascript">
        $(document).ready(function () {

             var response;
             //<!-- add vlidator -->
             $.validator.addMethod(
             "unique_email",function(value,element){
                $.ajax({
                url:'SignUp/emailExist',
                type: 'POST',
                data: 'email='+value,
                contentType: 'application/json; charset=utf-8',
                success:function(msg){
                    response = ( msg == 'true' ) ? true : false;
                }              
                })
                return response;
             },"email already exist"
             );
            jQuery.validator.classRuleSettings.unique_email = { unique_email: true };
            $("#register-form").validate({

                submitHandler: function (form) {
                    $('#register-form').submit();
                }
            });

        });
    </script> 
```

jQuery 移动代码

```
<div data-role="fieldcontain">
                <label for="email">
                <em>* </em> Email: </label>
               <label> <input type="text" id="email" 
                    name="email" class="required email unique_email" /></label>                  
            </div> 
```

最后是通过 ajax 使用的实际代码

```
[HttpPost]
        public ActionResult emailExist(string email)
        {
            //here i m checking from db that email exist or not result will return 1 
            //if an email exist and 0 if not so i m return false if i found email that is on 1
            int value = su.isEmailExist(email);
            if (value == 1)
                return Json(new { success = false});
            else
                return Json(new { success = true});
        } 
```

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T15:43:41.243

由于您的 ajax 请求是异步的，因此您的验证器将始终响应未定义（或 false）的响应，因为该函数在 ajax 请求完成之前返回。

您需要在函数返回之前使您的请求同步以设置响应。您可以通过在 ajax 请求中添加“async: false”参数来做到这一点

```
async: false 
```

编辑：

您的代码还有其他问题。您需要添加一种数据类型来告诉 JSON 您期待 JSON 响应。此外，`msg`成功响应中的变量需要一个字符串，但这是不正确的，因为 JSON 对象的第一个属性是`success:`. 当您使用`$.ajax`dataType 'json' 时，您现在需要将数据作为 JSON 字符串传递。我已经测试了以下 javascript 代码，它似乎可以工作：

```
 $(document).ready(function () {

         var response;
         //<!-- add vlidator -->
         $.validator.addMethod(
             "unique_email",function(value,element){
                $.ajax({
                url:'SignUp/emailExist',
                type: 'POST',
                data: "{ email: '" + value + "' }",
                contentType: 'application/json; charset=utf-8',
                success:function(json){
                    response = json.success;
                },
                async: false,
                dataType: 'json'          
                });
                return response;
             },"email already exist"
         );
        jQuery.validator.classRuleSettings.unique_email = { unique_email: true };
        $("#register-form").validate({

            submitHandler: function (form) {
                form.submit();
            }
        });

    }); 
```

# php - PHP（或 Javascript）浮动标题开/关

> ID：11382744
> 
> 赞同：1
> 
> 时间：2012-07-08T11:23:40.610
> 
> 标签：php, javascript, html, css

我最近使用 CSS 在我的网站上实现了一个浮动（？）标题，但我想让特定页面只有一个正常的标题，因为某些页面的性质不保证它。将来（或者可能同时？）如果有意义的话，我想为用户提供切换浮动的选项。

（请耐心等待，我仍然是 PHP/Javascript 新手！）

因此，当前页眉将在窗口顶部保持可见，即使用户向下滚动页面，在所有页面上也是如此。但是，有些页面不需要浮动标题。对于其他需要的页面，我希望用户可以选择切换浮动标题，因为有些人可能不需要快速访问标题中的工具链接。理想情况下，右上角会有一个持续可见的 CSS 按钮，上面写着“查看/隐藏导航栏”或“停止关注我！” （我现在更关心实际功能。）所以无论标题是可见还是隐藏，切换按钮总是需要可见。

我是否会让用户选择在所有页面上切换标题（即使在没有浮动标题的页面上），我不知道。取决于实施的难易程度。

到目前为止，我这样做是为了在所有页面上显示标题：

```
 #header
{
    position:fixed;
    width:914px;
    z-index:1;
}

    #rest of header content.... 
```

在每个 .php 页面上，我将标题背景和导航栏放在 . 到目前为止，一切都很好。

使用 PHP 或 Javascript，如何引入切换功能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T11:36:55.170

这很简单——在一个复选框或你喜欢选择的任何形式的用户设置实现中——让它激活你将要创建的 PHP 函数。该函数（不必是函数，请注意）将保存用户对标题的偏好。您可以通过以下方式执行此操作：

1.  **会话**- 将在浏览器关闭时重置
2.  **Cookies** - 将在浏览器关闭时或在特定时间重置，具体取决于您的操作
3.  **数据库**- 只有当你告诉它时才会重置 - 以及其他用户偏好（你熟悉动态内容吗？）

假设您不希望数据过载并且您不强迫人们加入您的网站（并且不想为每个访问者打开任意临时帐户） - 我会说使用**cookie**并将它们设置为过期日期远非现在。PHP 有一个[内置](http://php.net/manual/en/function.setcookie.php)的 cookie 函数：

```
setcookie ($name , $value, $expire); 
```

例如：

```
setcookie('header_float', 'true', time() + (365 * 24 * 60 * 60)); 
```

将设置一个 cookie 从现在起一年后过期。`$_COOKIE['header_float']`您可以使用超全局变量访问此 cookie 。

```
<div id="header" <?=($_COOKIE['header_float']) ? ' class="float"' : ''?>>
...
</div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T11:29:33.090

一个简单的方法是设置一个类 on `<body>`or even `<html>`：

```
<body class="fixed-header"> 
```

对比

```
<body class=""> 
```

并让您的 CSS 对该类做出反应。

```
.fixed-header #header {
    position:fixed;
    width:914px;
    z-index:1;
} 
```

（无论您是通过 PHP 还是 Javascript 设置该类。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-08T11:30:47.760

代码对你来说当然会有所不同，但下面是一种可以实现的方式。`div`基本上，如果它是一个不想有“浮动”标题的页面，PHP 会添加一个类。

```
<div id="header"<?php echo in_array($page,array('ignore-page','ignore-page2')) ? ' class="static"' : ''; ?>>
    blah
</div> 
```

CSS：

```
#header
{
    position:fixed;
    width:914px;
    z-index:1;
}

#header.static {
    position: absolute;
} 
```

# android - 将应用程序与网站连接

> ID：11382745
> 
> 赞同：0
> 
> 时间：2012-07-08T11:23:40.720
> 
> 标签：android

我想实现一个与站点连接的应用程序，如果我在该站点上传文件，它将直接出现在应用程序中并通知用户有新的上传文件，然后用户可以从应用程序下载文件我的问题是什么是开始实施应用程序的主要步骤。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T11:35:56.267

试试[谷歌云消息](http://developer.android.com/guide/google/gcm/index.html)。有示例代码可以帮助你....

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T13:10:06.443

如果您的应用程序只是呈现来自网站的内容，您可能需要考虑仅使用自定义 Web 界面并从 Web 浏览器访问它的选项。它使更新内容、布局等变得更加简单。

另一种选择是使用 WebView 创建一个可以让您直接嵌入 Web 内容的应用程序。看看这里：http: [//developer.android.com/guide/webapps/overview.html](http://developer.android.com/guide/webapps/overview.html)

如果这些不适合您的需要，您可能必须创建一个与您的网站对话的常规独立 android 应用程序。然后，您需要为此通信定义一些 API/消息。具体细节取决于您的应用程序究竟做了什么，但消息传递可以像几个 http GET 请求一样简单，假设您在另一端运行了一个网络服务器。例如，您可以调用 http GET 来获取要下载的文件列表。然后要下载每个文件，您可以在适当的 url 上发出单独的 GET 请求。您可以在后台运行一个 android 服务，该服务会定期执行 http 获取以刷新内容。

请参阅此链接以运行后台服务来执行 http 操作： [Android - httpclient as a backgroundservice](https://stackoverflow.com/questions/5682632/android-httpclient-as-a-backgroundservice)

# domain-name - 如何将多个域名指向一个后缀？

> ID：11382747
> 
> 赞同：0
> 
> 时间：2012-07-08T11:24:05.780
> 
> 标签：domain-name

我有两个指向同一个站点的域名，除了后缀（'.com' 和 '.co.nz'）外，名称相同。

在某个地方，我的印象是最好将一个观点指向另一个观点，例如。无论我在地址栏中输入哪个后缀，在我按 Enter 后它总是显示“.com”版本。

这个过程有一些可笑的难以忘怀的名字——因为我不记得了，我什至无法搜索到为什么我这样做很重要！

任何帮助将不胜感激！提前致谢， 亚历克斯·卡拉苏拉斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T12:05:08.960

您当前的方法以及具有相同内容的 .com 和 .co.nz 域的问题在于，搜索引擎[通常](http://support.google.com/webmasters/bin/answer.py?hl=en&answer=93633)将它们视为不同的网站，但会惩罚它们，因为它们没有独特的内容。

因此，Google[建议使用 301 重定向](http://support.google.com/webmasters/bin/answer.py?hl=en&answer=93633)从您的第二个域重定向到您的主域，以便他们知道它们都属于一个网站。然后，他们可以例如汇总网络上指向您网站的链接数量，以生成一个 pagerank。

# c++ - 自定义堆栈分配器，覆盖删除

> ID：11382748
> 
> 赞同：2
> 
> 时间：2012-07-08T11:24:07.840
> 
> 标签：c++, stack, new-operator, delete-operator

我想在我的应用程序中创建一个全局堆栈，并将某些对象放在这个堆栈上。这些对象不是固定大小的。

我目前有；

```
static char contextStack[CONTEXT_MAX_SIZE];
static char *top = &contextStack[0]; 
```

我重写了`new`继承的基类的运算符

```
static void *operator new(size_t size) {
  void *Result;
  Result = top;
  top = top + size;
  return Result;
}; 
```

问题是我将如何实现`delete`运算符以将其从堆栈中弹出？它没有告诉我物品有多大？我是否必须将每个条目的大小存储在数组中？

(ps) 最后创建的总是最先被删除的。并符合堆栈。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T11:33:12.130

> 我是否必须将每个条目的大小存储在数组中？

您可以使用单独的存储区域，也可以使用`malloc`实现经常遵循的策略：它们将大小存储在它们返回给您的指针前面的已知位置。当您调用 时`free`，它们会检查您传入的指针之前的位置，从那里获取大小，然后继续释放。

在您的情况下，您可以在块本身之后立即推送块的大小。到了出栈的时候，先出栈大小，再出栈数据块。

使用堆栈时需要注意的一件事是数据对齐：根据架构，将多字节类型存储在奇数偏移量（不能被四、八等分的偏移量）可能会导致性能下降或总线错误。您需要检查您的平台细节，看看是否需要在推入堆栈的连续元素之间引入额外的“填充”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T11:40:34.607

在这种情况下，有不同的选项来处理内存。如果您以递增的顺序返回内存（似乎是这种情况），则不需要记住大小。最后分配的内存块将从*分配的指针指向*top *，*您甚至不需要执行算术运算，因为将 top 设置为传递给的指针`delete`就足够了。

如果您按降序分配内存（这在堆栈中很常见），您可以将大小存储在堆栈本身中。执行指针运算以获得 new `Result`( `top - requested_size`)，然后递减`sizeof(int)`，将大小存储在那里并将指针设置`top`为该指针。

您应该了解平台中的对齐限制，即使平台允许对所有数据类型进行非对齐访问，出于性能（和线程安全）原因，您可能仍希望对齐数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-08T12:03:44.600

如果您使用模板类来创建堆栈，则无需知道每个项目的大小，这会容易得多。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-08T11:32:26.217

从我在处理堆栈时使用 Assembly 的经验来看：当代码想要从堆栈中弹出一些东西时，该代码负责知道该东西有多大或预期有多大。堆栈只是连续的一大块数据，从技术上讲，只要有那么多数据，您就可以从技术上取出任意大的数据块。

所以你的代码需要提前知道对象有多大（你似乎没有的信息）。当然，您可以通过任何其他方式实现您的“堆栈”，包括您建议将大小存储在数组中。这样做会使堆栈的简单性进一步复杂化，但在您的实现中可能是必需的。

# php - Android调用php脚本下载文件并保存到sd-card

> ID：11382751
> 
> 赞同：1
> 
> 时间：2012-07-08T11:24:20.583
> 
> 标签：php, android, sd-card, file-transfer

我对php有点陌生。我尝试在 android 中制作一个从 eClass 平台下载文件的应用程序。我开发了这个脚本：

```
 <?php
            $code=$_GET['code'];
            $code = stripslashes($code);
            $code = mysql_real_escape_string($code);

            $filename=$_GET['filename'];
            $filename = stripslashes($filename);
            $filename = mysql_real_escape_string($filename);

            $path = "C:\\xampp\\htdocs\\openeclass-2.5\\courses\\".$code."\\dropbox\\".$filename;
            $fullPath = $path.$_GET['download_file'];

            if ($fd = fopen ($fullPath, "r")) {
                $fsize = filesize($fullPath);
                $path_parts = pathinfo($fullPath);
                $ext = strtolower($path_parts["extension"]);
                switch ($ext) {
                    case "pdf":
                    header("Content-type: application/pdf"); // add here more headers for diff. extensions
                    header("Content-Disposition: attachment; filename=\"".$path_parts["basename"]."\""); // 

            use 'attachment' to force a download
                    break;
                    default;
                    header("Content-type: application/octet-stream");
                    header("Content-Disposition: filename=\"".$path_parts["basename"]."\"");
                }
                header("Content-length: $fsize");
                header("Cache-control: private"); //use this to open files directly
                while(!feof($fd)) {
                    $buffer = fread($fd, 2048);
                    echo $buffer;
                }
            }
            fclose ($fd);
            exit;
            ?> 
```

它在从浏览器（在我的本地主机中）调用时下载文件，并将代码和文件名作为 url 中的参数。现在我想在我的 android 应用程序中构建一个调用这个脚本的函数，获取文件并将其保存在 sd 卡中的某个位置

我怎样才能做到这一点？也可以在模拟器中完成吗？先感谢您！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T13:06:27.440

不幸的是，您不能通过 php 强制下载图像。您需要的是创建一个类，该类将从网络位置流式传输文件并将其保存到 sd 卡。

我的应用程序中有两个类似的代码：

```
try {
    newurl = new URL(iurl); // iurl is a String value
        b = BitmapFactory.decodeStream(newurl.openConnection().getInputStream());
    } catch (MalformedURLException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    } 
try {
    b.compress(CompressFormat.JPEG, 100, new FileOutputStream(
        sdcard_image)); // sdcard_image is a String value of local filename (including dir)
    } catch (FileNotFoundException e1) {
        e1.printStackTrace();
    } 
```

希望这会有所帮助

# ios - 将 iOS 键盘布局更改为表情符号？

> ID：11382753
> 
> 赞同：18
> 
> 时间：2012-07-08T11:24:29.993
> 
> 标签：ios, uikit, uikeyboard, emoji, uikeyboardtype

当 UITextField 成为第一响应者时，是否可以将键盘布局更改为表情符号？或根据用户操作，如点击 UIButton

我知道我可以将键盘布局更改为以下之一：

```
typedef enum {
    UIKeyboardTypeDefault,                // Default type for the current input method.
    UIKeyboardTypeASCIICapable,           // Displays a keyboard which can enter ASCII characters, non-ASCII keyboards remain active
    UIKeyboardTypeNumbersAndPunctuation,  // Numbers and assorted punctuation.
    UIKeyboardTypeURL,                    // A type optimized for URL entry (shows . / .com prominently).
    UIKeyboardTypeNumberPad,              // A number pad (0-9). Suitable for PIN entry.
    UIKeyboardTypePhonePad,               // A phone pad (1-9, *, 0, #, with letters under the numbers).
    UIKeyboardTypeNamePhonePad,           // A type optimized for entering a person's name or phone number.
    UIKeyboardTypeEmailAddress,           // A type optimized for multiple email address entry (shows space @ . prominently).

    UIKeyboardTypeAlphabet = UIKeyboardTypeASCIICapable, // Deprecated

} UIKeyboardType; 
```

我想知道是否有办法对表情符号布局做同样的事情？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2017-06-26T05:51:51.530

像这样创建 UITextField 的子类：

```
class EmojiTextField: UITextField {

    // required for iOS 13
    override var textInputContextIdentifier: String? { "" } // return non-nil to show the Emoji keyboard ¯\_(ツ)_/¯ 

    override var textInputMode: UITextInputMode? {
        for mode in UITextInputMode.activeInputModes {
            if mode.primaryLanguage == "emoji" {
                return mode
            }
        }
        return nil
    }
} 
```

在 Interface Builder 中，选择此类作为自定义类来代替 UITextField。

这会导致键盘在字段成为第一响应者时选择表情符号键盘（如果可用）。当然，用户可以随时将键盘改回其他任何东西，但至少它提供了您想要的初始选择。

> 感谢[blld](https://stackoverflow.com/users/4143698/blld)在这里的回答[https://stackoverflow.com/a/58537544/1852207](https://stackoverflow.com/a/58537544/1852207)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2020-03-27T23:02:23.367

我已经设法防止用户切换键盘！

使用此线程[iOS：如何将键盘更改事件检测](https://stackoverflow.com/questions/51896904/ios-how-to-detect-keyboard-change-event)为一种成分。

完整解决方案：

```
class EmojiTextField: UITextField {

    // required for iOS 13
    override var textInputContextIdentifier: String? { "" } // return non-nil to show the Emoji keyboard ¯\_(ツ)_/¯

    override var textInputMode: UITextInputMode? {
        for mode in UITextInputMode.activeInputModes {
            if mode.primaryLanguage == "emoji" {
                return mode
            }
        }
        return nil
    }

    override init(frame: CGRect) {
        super.init(frame: frame)

        commonInit()
    }

    required init?(coder: NSCoder) {
        super.init(coder: coder)

        commonInit()
    }

    func commonInit() {
        NotificationCenter.default.addObserver(self,
                                               selector: #selector(inputModeDidChange),
                                               name: UITextInputMode.currentInputModeDidChangeNotification,
                                               object: nil)
    }

    @objc func inputModeDidChange(_ notification: Notification) {
        guard isFirstResponder else {
            return
        }

        DispatchQueue.main.async { [weak self] in
            self?.reloadInputViews()
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-10-28T19:51:02.517

以下简化适用于 2021 年的 iOS 15：

```
class EmojiTextField: UITextField {
    override var textInputMode: UITextInputMode? {
        .activeInputModes.first(where: { $0.primaryLanguage == "emoji" })
    }
} 
```

iOS 15 似乎不需要`textInputContextIdentifier`，因为在其他答案中表明 iOS 13 需要。表情符号键盘在没有声明的情况下打开。

# sql-server - 如何设置 QA 和发布流程

> ID：11382758
> 
> 赞同：3
> 
> 时间：2012-07-08T11:25:30.317
> 
> 标签：sql-server, qa, release-management

我在一家网络创业公司工作，我们的产品终于接近了市场。迄今为止，它几乎是靠座位飞行，所有开发人员都在 SVN 的同一个分支上工作，这没关系。但是现在我们即将发布并即将聘请 QA，我们需要开始更多地按书构建事物。我负责设计我们的 QA 和发布流程。只是，我不完全确定我应该按照什么“书”来做事。我知道有许多不同的选项可供选择，我向您求助 StackOverflowers，请您就我们所拥有的最合适的解决方案提供建议：

*   数据库是 MS SQL Server 2008（即将是 2012）。
*   我们计划购买[RedGate 的 SQL Developer Bundle 的](http://www.red-gate.com/products/sql-development/sql-developer-bundle/)许可证，经过 1 周的评估，它看起来是一个非常有用的工具。
*   服务器端代码是 C#。
*   UI 是 ASP.NET 和 Flex/Flash 的组合。
*   我们确实有单独的服务器可用于开发、QA 和 Live。
*   通过 SVN 进行源代码控制。

我想要的结果是一键构建并发布到 QA 的**所有内容**。一旦 QA 批准了它，它应该再次一键推送它。

请推荐您会做的任何事情，从如何管理代码分支到任何可以节省我们时间和金钱的第三方软件。在这个阶段，只要成本合理，我们愿意接受任何建议或改变我们做事的方式。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-09T04:50:30.367

> 只是，我不完全确定我应该按照什么“书”来做事。

一定要看看[持续交付](http://martinfowler.com/delivery.html) 你需要大量的自动化——在测试和部署中。工具肯定是需要的，但它们只会走这么远。所有在主干/主线上工作的开发人员都可以。长期存在的分支只会在以后增加集成挑战。参考书在这方面有很多很好的建议。全面披露：我与本书的一位作者在同一家公司工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-15T19:32:59.820

这听起来与我们刚开始时遇到的问题非常相似。我们在组建 QA 团队时奠定的基础今天仍然存在，并且是发布过程成功的基石。

关于我们如何构建构建版本的一些高级观点

*   我们必须在任何时候都知道代码中发生了什么以及为什么。跟踪某种错误跟踪系统中更改的意图。

*   所有代码签入都必须引用一组已提交的工作。如果它是 QOL 增强，则有人创建票证 t 参考。没有未参考的签到！

*   代码每天至少从头开始构建一次，最好每天多次。QA**始终**从最新版本进行测试。

*   构建失败将得到最紧迫的处理；立即修复。

*   构建必须以某种形式长期存储，并用作交付的基础。主要里程碑不仅标记在源代码控制上，而且标记在长期存储机器上。为此，我们使用了一台名为*BuildManager的机器*

*   我个人不相信将部署与 QA 团队分开。我相信每个 QA 工程师都应该知道如何部署应用程序并自己创建必要的测试数据。这种方法有一些权衡，如果有兴趣，我很乐意进一步讨论

*   部署代码后，必须运行某种健全性测试。无论是系统/配置测试，还是实际的功能验证，您都必须尽您所能确保此构建不会浪费任何人的时间。减少代码签入之间的间隔时间并知道有一个可靠的构建是您可以进行的最佳自动化投资之一。

从这里开始，QA 的结构以及他们如何与团队的其他成员合作与刚刚讨论的基础一样重要。

# zeromq - 用于 zeromq 的 HA 和集中配置存储 - zookeeper 和 doozer 的替代品

> ID：11382767
> 
> 赞同：1
> 
> 时间：2012-07-08T11:27:40.910
> 
> 标签：zeromq, high-availability, doozer

是否有最佳品种的 Zookeeper 或 doozer 的替代品？我不想使用 java 并且 doozer 安装相当困难。

我想要一个本着 zookeeper 和 doozer 精神的 HA 服务，机器可以在那里注册 IP 地址和服务器类型，例如工作程序或 Web 应用程序。这将需要 zeromq ，其中工作人员需要知道要连接的服务器。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T15:01:10.043

您可以考虑[zpax](https://github.com/cocagne/zpax)，它在基本概念上类似于 zookeeper/doozer，但它旨在直接嵌入到目标应用程序中。但是，它仍处于开发过程的早期阶段。如果您有时间和动力在这个领域投入一些精力，那么它可能值得一看。

# objective-c - 为什么你必须在目标 C 中编写接口和实现而不是实现

> ID：11382768
> 
> 赞同：-3
> 
> 时间：2012-07-08T11:27:45.687
> 
> 标签：objective-c, oop

我想知道，为什么在 Objective C 中为每个类编写接口和实现如此重要。在其他语言中，这种技术只是可选的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T11:40:05.267

在 Objective-C 中，编写接口也是可选的（声明方法也是如此），尽管编译器可能会警告你。编写接口允许其他人重用您的代码的二进制形式，而无需重新编译它；这样，您还可以向重用您的类的人隐藏实现细节/代码。此外，如果您只使用自己的类，编译器可能在编译时需要一些关于您编写​​的类的信息（尽管 Objective-C 是一种动态语言）——在这种情况下，您不能将整个实现文件包含在内会导致复制整个类，从而导致链接器错误。与任何 C 库都有头文件的原因相同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T11:39:15.450

接口描述了其他类及其实例将如何与您的类及其实例交互。您*可以*只创建实现，但这会破坏 OOP 的目的。

# c# - 通过 Internet 远程联系桌面应用程序的最佳方式

> ID：11382772
> 
> 赞同：0
> 
> 时间：2012-07-08T11:28:13.893
> 
> 标签：c#, asp.net, winforms, web

我想通过互联网将某些参数远程传递给桌面应用程序。我不希望我的应用程序反复联系服务器，因为许多这样的应用程序可以很容易地关闭服务器。有没有办法从服务器启动连接？我如何识别这些应用程序，因为它们中的许多将在全球某处的许多计算机上运行。我不知道从哪里开始 - 我正在尝试在服务器端的 C# 和 ASP.NET/PHP 中执行此操作。请给一些建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T11:30:03.773

> 有没有办法从服务器启动连接？

不。不是没有客户端首先与服务器联系，通知它 IP 地址，要使用的端口等......服务器需要为*每个*客户端保留哪些，希望它们不会更改（或在何时更新他们确实改变了）。

客户端的长轮询是您正在做的事情的正确解决方案，即使您不想使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T20:23:25.980

There are many different ways you could approach this, just thinking out of the box, both your app and the server could utilize a different mechanism for transferring the settings. I'm not recommending any of these methods, please don't shoot me down, they are all just ideas.

As an example, your server could connect out using FTP and output the updated settings to an FTP server on each PC. You could install something like [Filezilla](http://filezilla-project.org/) on each machine which runs your app. You'd obviously need to configure port forwarding on the router to allow the server FTP access.

You could use email. Setting up an email account where your server can login to send out the settings. Your app could possibly login to the same email account possibly even a single Gmail account to retrieve the settings.

Another idea would be to use a file sharing service like Dropbox, Google Drive or similar and where the settings could be shared. Obviously this would involve learning any API and I'm not sure if there are any restrictions on this approach.

The last idea and probably my preferred approach would be to host a web service and database on a remote server, both your server and the applications would connect to the same service to transfer the settings. This approach is obviously firewall/router friendly as all the clients connect out to the web service to collect the required data.

Hope this helps?

# git - 合并分支的交互式变基

> ID：11382774
> 
> 赞同：12
> 
> 时间：2012-07-08T11:28:19.400
> 
> 标签：git, git-rebase

我正在使用 git，我正在进入这个状态：

```
 X --- Y --------- M1 -------- M2 (my-feature)
     /                 /           /
    /                 /           /
   a --- b --- c --- d --- e --- f (stable) 
```

当我们在“my-feature”分支上工作超过一天时，就会发生这种情况。M1 和 M2 从稳定分支合并到特征分支。M1 和 M2 可能已合并冲突，但已解决。将 stable 分支合并到 feature 分支的整个想法是尽早处理冲突。

一旦功能完成，我们希望将功能分支重新设置为一两次提交。

问题是当我们进行交互式 rebase 时，git 向我们展示了我们在 M1 和 M2 合并期间已经解决的相同合并冲突。

有没有办法让 git 重用我们在 M1 和 M2 中已经完成的合并决策？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-08T15:51:06.497

如果合并冲突相同，这是`git rerere`git 中最有用（尽管鲜为人知）命令之一的完美用例。从手册页：

> 在使用相对较长生命周期的主题分支的工作流中，开发人员有时需要一遍又一遍地解决相同的冲突，直到主题分支完成（合并到“发布”分支，或者发送出去并接受上游）。
> 
> 此命令通过在初始手动合并上记录冲突的自动合并结果和相应的手动解决结果并将先前记录的手动解决方案应用于其相应的自动合并结果来协助开发人员完成此过程。

`git rerere`记录您的冲突解决方案，并在 、 或 （提交合并时）遇到相同的冲突时自动`git merge`应用`git rebase`它们`git commit`。Scott Chacon[在这里发布了一些很好的示例，](https://git-scm.com/book/en/v2/Git-Tools-Rerere)手册[页也值得一读。](http://man.github.com/git/git-rerere.html#Discussion)

您可以通过发出以下命令`git rerere`来启用：`merge``rebase`

```
git config --global rerere.enabled true 
```

`--global`如果您只想为单个存储库启用该选项，请删除该标志。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-07-08T11:46:36.010

```
git rebase --interactive --preserve-merges

```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-01-11T22:43:48.570

通过一次提交将功能分支`feature`变为新分支的显式方法`feature-one-commit`：

```
git checkout -b feature-one-commit \
"$(git commit-tree HEAD^{tree} -m "Commit message" -p master)" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-08T11:36:09.553

您总是可以使用 -f 标志强制它

# c# - C# 数组“圆”

> ID：11382777
> 
> 赞同：0
> 
> 时间：2012-07-08T11:29:00.537
> 
> 标签：c#, arrays, counter

我有一个数组：

```
class Words
{
   public static string[] wordsArray = { "one", "two", "three", "four" };
} 
```

显示值数组的 TextBlock 和显示数组下一个值的按钮：

```
private int counter = 0;

    private void goButton_Click(object sender, RoutedEventArgs e)
    {

        if (counter < Words.wordsArray.Length)
        {
            enWordTextBlock.Text = Words.wordsArray[counter++];
        }
    } 
```

当方框出现在数组的最后一个值上时，程序会继续不工作，如何让它在一个“圆圈”内工作？

谢谢大家！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-08T11:30:59.730

这应该有效：

```
 private void goButton_Click(object sender, RoutedEventArgs e)
{
    counter++; //increase the counter
    int i = counter % Words.wordsArray.Length; //modulo operation
    enWordTextBlock.Text = Words.wordsArray[i]; //set text
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-08T11:34:06.997

```
private int counter = 0;

private void goButton_Click(object sender, RoutedEventArgs e)
{
    enWordTextBlock.Text = Words.wordsArray[counter++ % Words.wordsArray.Length];
} 
```

[编辑]
好的，这是与 user1397396 评论相关的编辑。我不确定我是否正确理解您，但您可能对负值模数有疑问。例如：

```
int counter = 0;
int mod = 4;
counter--; // counter is -1 after this line is executed
int result = counter % mod; // result is -1
result = (counter + mod) % mod; // result is now 3 as desired 
```

以下是我将如何实现这些 Next 和 Previous 按钮。

```
private int counter = 0;

private void NextButton_Click(object sender, RoutedEventArgs e)
{
    enWordTextBlock.Text = Words.wordsArray[counter % Words.wordsArray.Length];
    counter++; // put ++ operator in new line to avoid confusion
}

private void PreviousButton_Click(object sender, RoutedEventArgs e)
{
    int wordCount = Words.wordsArray.Length;
    // add wordCount before applying modulus (%) to avoid negative results
    // -1 % 5 = -1; -2 % 5 = -2; -6 % 5 = -1 etc
    // negative values would cause exception when accessing array
    counter = ((counter - 1) + wordCount) % wordCount; 
    enWordTextBlock.Text = Words.wordsArray[counter];
} 
```

例如，此代码将导致按 Next、Previous、Next 为您提供：“one”、“four”、“one”。

更好的解决方案是使用如下方法（或内联代码）：

```
private static int GetPositiveIntModulus(int value, int mod)
{
    return ((value % mod) + mod) % mod;
} 
```

对于任何值，它都会给你一个积极的结果，即使是`value < -mod`. 所以你可以这样写上面的代码：

```
private int counter = 0;

private void NextButton_Click(object sender, RoutedEventArgs e)
{
    // uncomment this to ensure valid counter
    // if it is changed somewhere else in the program
    //counter = GetPositiveIntModulus(counter, Words.wordsArray.Length);
    enWordTextBlock.Text = Words.wordsArray[counter];
    counter = GetPositiveIntModulus(counter + 1, Words.wordsArray.Length);
}

private void PreviousButton_Click(object sender, RoutedEventArgs e)
{
    counter = GetPositiveIntModulus(counter - 1, Words.wordsArray.Length);
    enWordTextBlock.Text = Words.wordsArray[counter];
} 
```

# algorithm - 如何在 1 秒内找到数独游戏的所有解决方案（计数）？

> ID：11382781
> 
> 赞同：1
> 
> 时间：2012-07-08T11:29:47.480
> 
> 标签：algorithm

我已经尝试过跳舞链接和其他一些搜索算法，但它不会在 1 秒的给定时间限制内工作。对于具有大约 100 万个解决方案的数独游戏，计算所有解决方案大约需要 10 秒。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T12:13:00.200

1M 的结果听起来有点吓人，但为了快速求解，基本上你必须使用消除/约束传播过程和对可能值最少的字段进行详尽搜索。

Peter Norvig 的一篇优秀文章：[解决每个数独难题](http://norvig.com/sudoku.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T21:01:03.990

Standard solving algorithms for Sudoku (all solutions) use [backtracking](http://en.algoritmy.net/article/42521/Sudoku). Classic variant of Sudoku has only one solution (or at least should have), so there you might use human-like techniques, but this is in the case not possible. So backtracking will be probably the only way.

But you might want to use several tricks

*   Prunning of the tree (extend basic prunnign strategy of backtracking algorithm with more sophisticated conditions)
*   Massive parallelism (I think that that you might benefit of superlinear accelaration of the solution, because some sub-problems might be the same, hence solvable only once, or might prune some branches of other threads)
*   Use symmetry and some special properties of your setting, this is probably the best strategy, if you have some implicit knowledge
*   You might try some blackbox approaches - for example [constraint](http://www.jacop.eu/) ([logic](http://eclipseclp.org/)) programming, which are highly optimized in searching in massive search space...

# c# - 多对多映射表

> ID：11382783
> 
> 赞同：61
> 
> 时间：2012-07-08T11:30:04.720
> 
> 标签：c#, entity-framework, ef-code-first, many-to-many

从我在网上和编程实体框架 CodeFirst 书中看到的示例中，当您在两个类上都有一个集合时，EF 将创建一个映射表，例如`MembersRecipes`，每个类的主键将链接到该表。

但是，当我执行以下操作时，我会在`Recipes`表中得到一个名为的新字段`Member_Id`和表`Recipe_Id`中的一个`Members`。

这只创建了两个一对多的关系，而不是多对多的关系，所以我可以让成员 3 链接到食谱 (4,5,6) 和食谱 4 链接到成员 (1,2,3) 等。

有没有办法创建这个映射表？如果是这样，您如何将其命名为其他名称，例如“食谱”？

谢谢

```
 public abstract class Entity {
        [Required]
        public int Id { get; set; }
    }   

    public class Member : Entity {
        [Required]
        public string Name { get; set; }

        public virtual IList<Recipe> Recipes { get; set; }
    }

    public class Recipe : Entity {  
        [Required]
        public string Name { get; set; }

        [ForeignKey("Author")]
        public int AuthorId { get; set; }
        public virtual Member Author { get; set; }

            ....

        public virtual IList<Member> Members { get; set; }
    } 
```

**更新：** 下面是我尝试过的另一种方法，它不使用 Fluent API 并用所有者标志替换`AuthorId`& `Author`on `Recipe`，我还将下面的示例从`Cookbooks`to重命名`MembersRecipes`，这也解决了与答案类似的问题，但如上所述进一步的影响。

```
public class MembersRecipes {

    [Key, Column(Order = 0)]
    [ForeignKey("Recipe")]
    public int RecipeId { get; set; }
    public virtual Recipe Recipe { get; set; }

    [Key, Column(Order = 1)]
    [ForeignKey("Member")]
    public int MemberId { get; set; }
    public virtual Member Member { get; set; }

    public bool Owner { get; set; }
} 
```

在`Recipe`&`Member`类中，我将集合更改为

```
public virtual IList<MembersRecipes> MembersRecipes { get; set; } 
```

* * *

## 回答 #1

> 赞同：98
> 
> 时间：2012-07-08T11:55:41.930

在您的 DbContext OnModelCreating 上执行此操作：

```
protected override void OnModelCreating(DbModelBuilder modelBuilder)
{    
    modelBuilder.Entity<Recipe>()
        .HasMany(x => x.Members)
        .WithMany(x => x.Recipes)
    .Map(x =>
    {
        x.ToTable("Cookbooks"); // third table is named Cookbooks
        x.MapLeftKey("RecipeId");
        x.MapRightKey("MemberId");
    });
} 
```

你也可以反过来做，它是一样的，只是同一枚硬币的另一面：

```
modelBuilder.Entity<Member>()
    .HasMany(x => x.Recipes)
    .WithMany(x => x.Members)
.Map(x =>
{
  x.ToTable("Cookbooks"); // third table is named Cookbooks
  x.MapLeftKey("MemberId");
  x.MapRightKey("RecipeId");
}); 
```

* * *

更多示例：

[http://www.ienablemuch.com/2011/07/using-checkbox-list-on-aspnet-mvc-with_16.html](http://www.ienablemuch.com/2011/07/using-checkbox-list-on-aspnet-mvc-with_16.html)

[http://www.ienablemuch.com/2011/07/nhibernate-equivalent-of-entity.html](http://www.ienablemuch.com/2011/07/nhibernate-equivalent-of-entity.html)

* * *

**更新**

为了防止对您的 Author 属性进行周期性引用，除上述之外，您需要添加以下内容：

```
modelBuilder.Entity<Recipe>()
    .HasRequired(x => x.Author)
    .WithMany()
    .WillCascadeOnDelete(false); 
```

想法来源于这里：[EF Code First，具有多对多自引用关系](https://stackoverflow.com/questions/5273569/ef-code-first-with-many-to-many-self-referencing-relationship)

核心是，您需要通知 EF Author 属性（它是一个 Member 实例）没有 Recipe 集合（用 表示`WithMany()`）；这样，可以在 Author 属性上停止循环引用。

这些是从上面的 Code First 映射中创建的表：

```
CREATE TABLE Members(
    Id int IDENTITY(1,1) NOT NULL primary key,
    Name nvarchar(128) NOT NULL
);

CREATE TABLE Recipes(
    Id int IDENTITY(1,1) NOT NULL primary key,
    Name nvarchar(128) NOT NULL,
    AuthorId int NOT NULL references Members(Id)
);

CREATE TABLE Cookbooks(
    RecipeId int NOT NULL,
    MemberId int NOT NULL,
    constraint pk_Cookbooks primary key(RecipeId,MemberId)
); 
```

# java - 如何在liferay中制作友好的网址

> ID：11382784
> 
> 赞同：0
> 
> 时间：2012-07-08T11:30:12.097
> 
> 标签：java, liferay, friendly-url

我将我的 portlet 放在一个页面中，并且 portlet 正在使用来自 url 参数的值呈现。但我需要隐藏值并显示友好的网址..

检查这个网址...

> [http://betatest.businessworld.in/web/guest/storypage?CategoryID=37489&articleId=215754&version=1.1&journalArticleId=218207](http://betatest.businessworld.in/web/guest/storypage?CategoryID=37489&articleId=215754&version=1.1&journalArticleId=218207)

请帮忙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T14:34:43.910

你能检查一下这个网址吗，[http://www.liferay.com/documentation/liferay-portal/6.0/development/-/ai/optional%3A-adding-friendly-url-mapping-to-the-portlet](http://www.liferay.com/documentation/liferay-portal/6.0/development/-/ai/optional%3A-adding-friendly-url-mapping-to-the-portlet)，希望这将解决你的问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T12:10:32.353

我目前无法访问 liferay，但在管理区域的管理页面部分，它们是一个输入字段，它采用友好 url 的名称。你能检查一下吗

# c++ - std::map 和 std::set 是线程安全的吗？

> ID：11382792
> 
> 赞同：1
> 
> 时间：2012-07-08T11:32:03.503
> 
> 标签：c++, map, set

我有一个问题： std::map 和 std::set 线程安全吗？我在我的多线程应用程序上使用这个集合，有时映射和设置工作。

谢谢！

**更新。我的代码：**

```
std::map<int, unsigned long> ClientTable;

int sendulong(int socket, char * data) //<--- Many threads uses this function
{
  write(socket, ClientTable[socket]); //<--- ClientTable[[socket] <-- using of map
} 
```

如何修复此代码以确保线程安全？谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-08T11:37:33.740

这取决于你想做什么。如果您所做的只是从他们那里阅读，那么是的。如果您还写信给它们，并且一个单独的线程尝试做任何其他事情，或者有活的迭代器，它就不会按预期工作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-08T11:33:31.113

不，它们没有被定义为线程安全的。您必须在标准库容器之上添加同步机制。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-08T11:33:28.010

C++ 标准对此只字未提。1 您必须查看文档以了解您正在使用的标准库的特定实现。但它很可能不是线程安全的，因此您需要自己进行同步。

（如果您想知道如何做到这一点，那是一个不同的问题主题......）

* * *

[1\. C11 前。]

# java - 重命名后无法删除文件（文件已打开）

> ID：11382793
> 
> 赞同：1
> 
> 时间：2012-07-08T11:32:11.280
> 
> 标签：java, file, jakarta-ee, delete-file

我正在使用**icefaces**将文件上传到我的网络应用程序中的相对路径`(mywebapp/audio)`，然后在文件上传后我将其重命名以保存其扩展名，如下所示：

```
public static File changeExtToWav(FileInfo fileInfo,
            StringBuffer originalFileName) {
        log.debug("changeExtToWav");
        int mid = fileInfo.getFile().getName().lastIndexOf(".");
        String fileName = fileInfo.getFile().getName().substring(0, mid);
        originalFileName.append(fileName);
        log.debug("originalFileName: " + originalFileName);
        String newFileName = fileName + "_" + new Date().getTime() + "."
                + "wav";
        File newFile = new File(fileInfo.getFile().getParent() + "/"
                + newFileName);
        log.debug("newFileName: " + newFile.getName());
        fileInfo.getFile().renameTo(newFile);
        return newFile;
    } 
```

文件上传后，有时我想从 UI 按钮中删除它，如下所示：

```
try {

            File fileToDelete = new File(filePath); // correct file path
            log.debug("file exists: " + fileToDelete.exists()); // true
            fileToDelete.delete();
        } catch (Exception e) {
            e.printStackTrace();
        } 
```

文件路径是正确的，我没有例外，但文件没有被删除（我使用的是 java 6 btw）。请告知如何解决此问题。

**更新：**使用以下有用的方法，我可以得到**文件已打开**，任何想法如何关闭它？

```
public String getReasonForFileDeletionFailureInPlainEnglish(File file) {
    try {
        if (!file.exists())
            return "It doesn't exist in the first place.";
        else if (file.isDirectory() && file.list().length > 0)
            return "It's a directory and it's not empty.";
        else
            return "Somebody else has it open, we don't have write permissions, or somebody stole my disk.";
    } catch (SecurityException e) {
        return "We're sandboxed and don't have filesystem access.";
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T14:28:34.573

好吧，如果文件是打开的，那么有两种解决方案：

*   您的程序中有一个在此文件上打开的流。请注意，afaik 在 Windows 上是个问题，使用 Unix，即使在其上打开了流，我也可以删除文件。

*   您有其他进程正在使用此文件。所以在这种情况下，你不能从 Java 做任何事情。

在日志中它还告诉它可能是权限问题，您确定您有足够的权限吗？

您还可以使用[Files#delete(Path path)](http://docs.oracle.com/javase/7/docs/api/java/nio/file/Files.html#delete%28java.nio.file.Path%29) (jdk7) 了解有关该问题的更多详细信息。

# google-chrome-extension - NPAPI 插件的简单示例

> ID：11382794
> 
> 赞同：0
> 
> 时间：2012-07-08T11:32:14.083
> 
> 标签：google-chrome-extension, firefox-addon, npapi, gecko

我正在尝试找到一个简单的示例，说明如何编写一个将与我的 Chrome 扩展程序捆绑在一起的 NPAPI 插件。

我需要用 NPAPI 做的事情就是运行一个已经存在的本地程序，我有它的本地路径。

找不到任何可以让我这样做的简单示例。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-16T17:07:19.317

我从 OSX [https://github.com/niw/open_with_default开始](https://github.com/niw/open_with_default)

Linux/WinNT [http://code.google.com/p/npapi-file-io/](http://code.google.com/p/npapi-file-io/)

谢谢楼上

然后把它们放在我的 npapi 插件中

看看 [https://github.com/tg123/chrome-hostadmin](https://github.com/tg123/chrome-hostadmin)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-08T12:06:07.230

firebreath NPAPI 框架似乎有不错的文档：[http ://www.firebreath.org/display/documentation/FireBreath+Home](http://www.firebreath.org/display/documentation/FireBreath+Home)

# python - 没有反向关系的两个 ManyToMany 字段

> ID：11382801
> 
> 赞同：0
> 
> 时间：2012-07-08T11:33:27.377
> 
> 标签：python, django, django-models

我正在尝试创建一个包含 2 个 ManyToMany 字段的模型，而不允许反向关系。所以这里是模型：

```
class Camp(models.Model):
#...

free_options = models.ManyToManyField('Option', related_name='+')
paid_options = models.ManyToManyField('Option', related_name='+') 
```

尝试做之后

> python manage.py syncdb

我收到以下错误：

> 错误：一个或多个模型未验证：camps.camp：m2m 字段“free_options”的访问器与相关的 m2m 字段“Option.+”冲突。在“free_options”的定义中添加一个related_name 参数。camps.camp：m2m 字段“free_options”的反向查询名称与相关的 m2m 字段“Option.+”冲突。在“free_options”的定义中添加一个related_name 参数。

在同一个模型上不可能有2个没有反向关系的字段吗？我怎样才能解决这个问题？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T20:09:28.440

根据[ManyToManyField 的相关名称参数](https://docs.djangoproject.com/en/dev/ref/models/fields/#django.db.models.ManyToManyField.related_name)的 Django 文档：

> 如果您有多个指向同一模型的 ManyToManyField 并希望抑制向后关系，请将每个 related_name 设置为以“+”结尾的**唯一值**

强调我的。

因此，如果您想这样做，您应该能够简单地：

```
class Camp(models.Model):
    #...

    free_options = models.ManyToManyField('Option', related_name='free_options+')
    paid_options = models.ManyToManyField('Option', related_name='paid_options+')
    #                                                             ^^^^^^^^^^^^ 
```

抑制同一模型中多个 ManyToManyField 的反向关系。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T13:09:43.440

我会问你为什么对向后关系感到困扰，如果你不想要它就不要使用它。但是要回答这个问题，没有办法完全删除它。

# .net - 相同的绑定，不同的呈现方式？

> ID：11382804
> 
> 赞同：1
> 
> 时间：2012-07-08T11:33:33.547
> 
> 标签：.net, wpf, data-binding

```
<Window x:Class="WpfApplication1.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:System="clr-namespace:System;assembly=mscorlib"
        Title="MainWindow" Height="350" Width="525">
    <Window.Resources>
        <System:DateTime x:Key="d" >2012/7/8</System:DateTime>
    </Window.Resources>
    <StackPanel>
        <ContentControl Content="{Binding}" DataContext="{StaticResource d}" />
        <TextBlock Text="{Binding}" DataContext="{StaticResource d}"/>
    </StackPanel>
</Window> 
```

这段代码给了我以下窗口。

![在此处输入图像描述](../Images/77e2d7510a2114bf0e82759b2b68010f.png)

奇怪的是，相同的绑定在应用于 ContentControl 时仅显示日期部分，而当应用于 TextBlock 时也显示时间部分。

我只是想知道原因并询问是否可以交换演示文稿，我的意思是 TextBlock 只显示日期部分，而 ContentControl 显示这两个部分。

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-08T11:38:52.580

对于`ContentControl`，使用`ContentStringFormat`。对于`TextBlock`，使用 a`Binding`和 a `StringFormat`：

```
<ContentControl Content="{Binding}" ContentStringFormat="dd/MM/yyyy HH:mm:ss"/>
<TextBlock Text="{Binding ., StringFormat=dd/MM/yyyy}"/> 
```

简而言之，区别在于 a`ContentControl`可以将任何旧的内容显示`object`为内容（不仅仅是 a `string`），而`TextBlock.Text`只能是 a `string`。

# php - 转换后添加 XML 头信息

> ID：11382805
> 
> 赞同：0
> 
> 时间：2012-07-08T11:33:33.607
> 
> 标签：php, xml, xslt

我有一个 xml 文档，我对其进行转换、在浏览器中查看并保存到目录中。

我想将链接的样式表添加到文件的保存版本。我已经尝试了 str_replace 如下（可能使用不正确）并且还使用了 xsl 处理指令。

xsl 处理指令在一定程度上起作用，如果您在浏览器中查看源代码，您会看到样式表链接，但是它不会将此信息保存到保存的文件中！

我要做的就是获取原始 xml 文件，使用样式表对其进行转换，将其保存到一个目录并将 xsl 样式表附加到新文件的标题中，因此当在浏览器中打开新保存的 xml 文件时，样式表会自动应用。希望这是有道理的！

我的代码如下。

```
//write to the file
$id = $_POST['id'];//xml id
$path = 'xml/';//send to xml directory
$filename = $path. $id . ".xml";
$header = str_replace('<?xml version="1.0" encoding="UTF-8"?>', '<?xml version="1.0"     encoding="UTF-8" ?><?xml-stylesheet type="text/xsl" href="../foo.xsl"?>');
$article->asXML($filename);//saving the original xml as new file with posted id

$xml = new DOMDocument;
$xml->load($filename);

$xsl = new DOMDocument;
$xsl->load('insert.xsl');

$proc = new XSLTProcessor;
$proc->importStyleSheet($xsl);

echo $proc->transformToXML($xml); 
```

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T12:34:23.157

您可以使用[`<xsl:processing-instruction/>`](http://www.w3.org/TR/xslt/#section-Creating-Processing-Instructions)XSLT 文件中的标记来添加样式表链接。

```
<xsl:processing-instruction name="xml-stylesheet">
    type="text/xsl" href="../foo.xsl"
</xsl:processing-instruction> 
```

这将产生：

```
<?xml-stylesheet type="text/xsl" href="../foo.xsl"?> 
```

* * *

或者，您可以使用`DOMDocument`.

```
$newXml = $proc->transformToXML($xml);

// Re-create the DOMDocument with the new XML
$xml = new DOMDocument;
$xml->loadXML($newXml);

// Find insertion-point
$insertBefore = $xml->firstChild;
foreach($xml->childNodes as $node)
{
  if ($node->nodeType == XML_ELEMENT_NODE)
  {
    $inertBefore = $node;
    break;
  }
}

// Create and insert the processing instruction
$pi = $xml->createProcessingInstruction('xml-stylesheet', 'type="text/xsl" href="../foo.xsl"');
$xml->insertBefore($pi, $insertBefore);

echo $xml->saveXML(); 
```

# php - php需要命令错误

> ID：11382807
> 
> 赞同：0
> 
> 时间：2012-07-08T11:33:45.263
> 
> 标签：php, require

我有一个 home.php 文件，它使用 php require 命令引用 fileA，该命令位于同一文件夹中，即 localhost。代码是：

```
<?php // /localhost/home.php
require ('/fileA.php');
?> 
```

fileA 在其代码 fileB 中引用了另一个文件。到目前为止，当我使用`fileC.php` 参考文件A 访问时，它工作正常

```
<?php // /localhost/A/B/fileC.php
require ('../../fileA.php');
?> 
```

该代码能够获取fileA，但仅当fileB与fileC位于同一文件夹中时才能正常工作，否则会产生404错误。我无法理解为什么会发生这种情况，因为fileB是由fileA调用的。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T11:52:39.603

使用相对文件路径时，请记住它们与您当前的工作目录相关，而不是与执行包含的文件相关。当前工作目录是在第一次请求时自动设置的（`A/B`在您的情况下）。

一些简单的解决方案：始终`dirname(__FILE__)`在包含文件之前使用，这样它就与所在的文件相关：

```
<?php 
require(dirname(__FILE__)."/FileA.php"); 
require(dirname(__FILE__)."/../../FileB.php"); 
```

# javascript - 在错误元素上触发的焦点和模糊事件

> ID：11382810
> 
> 赞同：0
> 
> 时间：2012-07-08T11:33:48.683
> 
> 标签：javascript, jquery, focus, onblur, onfocus

我正在尝试一次为多个输入设置默认值，在焦点上删除该值并在输入为空时再次将其设置为模糊。为此，使用 jQuery，我得到了以下代码：

```
var settings = {
    value: '',
    focusColor: 'black',
    blurColor: '#CCC',
    value : 'test'
};

$.each($('input'), function(index, el) {
    $(el).on('blur', function(ev) {
        $el = $(this);
        console.log('blur ' + $el.attr('value') + ' ' + $el.attr('id'));
        if ($el.attr('value') == '') 
            $el.attr('value', settings.value).css('color', settings.blurColor);
    }).on('focus', function(ev) {
        console.log('focus ' + $el.attr('value') + ' ' + $el.attr('id'));
        if ($el.attr('value') == settings.value) 
            $(this).attr('value', '').css('color', settings.focusColor);
    });
    $(el).trigger('blur');
}); 
```

有这个 HTML：

```
<input id="text" type="text" />
<input id="email" type="email" /> 
```

问题是，如果我关注第一个输入，然后紧接着第二个，触发的事件是：关注第一个输入，模糊第一个输入并再次关注第一个输入。因此，如果我在第一个中输入一些内容，然后再次关注第二个和第一个，它不会删除示例文本，而是会删除我输入的内容。

[您可以在此处](http://jsfiddle.net/fnBeZ/2/)查看（不）工作示例。打开 JavaScript 控制台，您会清楚地看到错误行为。​</p>

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T11:40:59.643

你的意思是这样的：

```
$('input').on('blur', function(ev) {
    $el = $(this);
    console.log('blur ' + $el.va() + ' ' + $el.attr('id'));
    if ($el.val() == '')
        $el.attr('value', settings.value).css('color', settings.blurColor);
})

$('input').on('focus', function(ev) {
    $el = $(this);
    console.log('focus ' + $el.val() + ' ' + $el.attr('id'));
    if ($el.val() == settings.value) {
        $(this).val("");
        $(this).css('color', settings.focusColor);
    }
}); 
```

演示：http: [//jsfiddle.net/fnBeZ/4/](http://jsfiddle.net/fnBeZ/4/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T11:42:19.083

您忘记了焦点事件中的 set $el 。

```
$.each($('input'), function(index, el) {
$(el).on('blur', function(ev) {
    $el = $(this);
    console.log('blur ' + $el.attr('value') + ' ' + $el.attr('id'));
    if ($el.attr('value') == '') 
        $el.attr('value', settings.value).css('color', settings.blurColor);
}).on('focus', function(ev) {
    $el = $(this); // <-- should update $el
    console.log('focus ' + $el.attr('value') + ' ' + $el.attr('id'));
    if ($el.attr('value') == settings.value) 
        $(this).attr('value', '').css('color', settings.focusColor);
});
$(el).trigger('blur');
}); 
```

# asp.net - 生成静态 HTML 页面以替换动态页面

> ID：11382812
> 
> 赞同：3
> 
> 时间：2012-07-08T11:33:55.767
> 
> 标签：asp.net, asp.net-mvc-3, performance, razor

对于一个项目，我们必须生成静态 .html 页面，这些页面将发布在同一台服务器上，为数百万访问者提供服务。

我们必须从 ac# 代码自动创建这些文件，该代码从 SQL Server 数据库获取数据。

该项目已经使用 C# asp.net MVC3 开发，我们需要将动态生成的页面存储在 .html 中的相同 url 上以提供给访问者。

我想知道如何使用 asp.net MVC3/Razor 来生成那些 .html 页面？

我不想/不需要使用网络缓存，原因有很多（负载（每天加载数百万页），这些静态页面将缓存在 CDN 网络上以进一步超快速服务，而无需原始服务器进入图片，数字页面真的太多了（缓存只会在我经常访问相同页面的情况下对我有帮助，但是我会经常访问超过一百万个页面，所以我必须经常生成它们。）

所以我真的搜索了一些东西来生成 HTML 页面。

任何想法如何做到这一点......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T11:45:58.580

首先，确保您的路由都生成可以复制为静态 html 文件的 url。这样您对 Html.ActionLink 的调用将生成您可以使用的 url。

生成您的整个站点，就像您直接使用它一样，然后*让它在外部缓存*。

您可以在 Linux 上使用 wget 之类的东西来获取站点的整个 html 树，并将它们与内容文件一起放置；css、图片、javascript等

然后在有更改时重新下载该站点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-08T11:47:03.107

在我的公司，我们也做过类似的事情。我们有一个单独的程序，它通过一个 url 列表，向它们发送一个 http-request。保存结果并将其复制到 Web 服务器。这样，我们在网络内部只有一个带有 asp 代码的 Web 服务器，并且 Internet 上的服务器具有动态页面的静态副本。我们从中获得了一些出色的表现。

为了让您获得 url 列表，您可能必须创建一个特殊的视图/控制器来查询数据库中可用于查询所需信息的键。因此，例如，如果您有一个显示汉堡包的网站，则创建 url 的列表视图可能会查询您的 burger-table 并创建一堆 /myburger?name=Wopper 类型的 url。然后您的批处理程序读取这些 url 并如前所述，执行 http 请求并保存结果等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-09T05:26:20.330

如果要基于 mvc 视图和模型生成 html，可以使用 Razor。我已经使用它来生成电子邮件模板，我们使用 Razor 将模型注入到视图中。如果符合您的目的，您可以从视图生成 html 并将它们写入静态 html 文件。参考 NuGet 的 Razor Engine，你可以像这样使用它

```
var html = Razor.Parse(templateView, model); 
```

如果您想对其进行更多自定义，那么本教程可能会对您有所帮助。 [http://www.west-wind.com/weblog/posts/2012/May/30/Rendering-ASPNET-MVC-Views-to-String](http://www.west-wind.com/weblog/posts/2012/May/30/Rendering-ASPNET-MVC-Views-to-String)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-03-23T23:57:07.983

我总是使用自己的电子邮件生成方法而不是 MvcMailer。首先，您应该从您的视图或部分生成一个字符串，然后添加/删除一些 html 标签，例如`<html>`等，如果您需要...接下来将此字符串写入文件，将其保存为 .html 文件到您的路径。

```
public static string HTMLToString(ControllerContext context, string viewName, object model)
{
    if (string.IsNullOrEmpty(viewName))
        viewName = context.RouteData.GetRequiredString("action");

    var viewData = new ViewDataDictionary(model);

    using (var sw = new StringWriter())
    {
        var viewResult = ViewEngines.Engines.FindPartialView(context, viewName);
        var viewContext = new ViewContext(context, viewResult.View, viewData, new TempDataDictionary(), sw);
        viewResult.View.Render(viewContext, sw);

        return sw.GetStringBuilder().ToString();
    }
} 
```

# iphone - UIControl：sendActionsForControlEvents 省略 UIEvent

> ID：11382816
> 
> 赞同：5
> 
> 时间：2012-07-08T11:34:47.740
> 
> 标签：iphone, ios, ipad, subclass, uicontrol

我想实现 UIControl 的自定义子类。它工作得很好，除了一个让我吐牙的致命问题。每当我使用 sendActionsForControlEvents: 发送操作消息时，它都会忽略包含 UIEvent。例如，如果我将其链接到具有以下签名的方法：

```
- (IBAction) controlTouched:(id)sender withEvent:(UIEvent *)event 
```

...事件总是返回为零！该问题似乎发生在 sendActionsForControlEvents 中：

现在，我需要我的 IBAction 来确定触摸的位置。我通常通过从事件中提取触摸来做到这一点。当然必须有某种方法来确保传递正确的事件？这是使用 UIControl 的一个非常基本的部分！

有人知道合法的解决方法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-08T11:49:37.267

我认为这是因为该`sendActionsForControlEvents:`方法无法知道`UIEvent`您的控制事件应该与哪个（如果有）相关联。

您可以尝试分别发送所有操作（`sendActionsForControlEvents:`根据文档复制该方法的功能），因此您可以将它们与 a 相关联`UIEvent`：

```
UIEvent *event = ...;
UIControlEvents controlEvent = ...;

for (id target in [self allTargets]) {
    NSArray *actions = [self actionsForTarget:target forControlEvent:controlEvent];
    for (NSString *action in actions) {
        [self sendAction:NSSelectorFromString(action) to:target forEvent:event];
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T11:50:43.380

目前我有一个可能的解决方案，但我对此并不满意。对于其他面临同样问题的人来说，就是这样。首先，为 UIEvent 声明一个局部变量或属性：

```
@property (nonatomic, assign) UIEvent * currentEvent; 
```

现在，在您的触摸处理例程中，在调用 [self sendActionsForControlEvents:] 之前，将该局部变量设置为该例程的当前 UIEvent，当然，将 UIControlEventTouchDown 替换为您要发送的任何操作。

```
self.currentEvent = event;
[self sendActionsForControlEvents: UIControlEventTouchDown]; 
```

最后，重写以下方法：

```
- (void) sendAction:(SEL)action to:(id)target forEvent:(UIEvent *)event
{
    [super sendAction:action to:target forEvent:self.currentEvent];
} 
```

这*行得通*，但我一点也不喜欢它，所以如果有人有一个不依赖于对 UIEvent 进行弱引用的替代解决方案，我会很高兴听到它！

# box2d - 如何使精灵在场景中随机移动：-andengine

> ID：11382817
> 
> 赞同：2
> 
> 时间：2012-07-08T11:34:48.103
> 
> 标签：box2d, sprite, andengine, modifiers

我正在制作一个游戏，我需要大约 50 个小虫子从各个方向进入场景。我希望他们在屏幕上随机移动，但似乎不可能。似乎如果我使用 MoveModifier，我必须为每个精灵提供一个结束位置。有什么方法可以在不使用移动修饰符的情况下做到这一点。我不熟悉 box 2d 扩展，但我看到很多人通过将精灵附加到物理实体来使用它来移动精灵。我是否需要这个扩展我不清楚。我还需要精灵来检测它们自己和其他动画精灵之间的碰撞检测。我怎么能做到这一点我不太清楚。请帮忙。以下是我的代码.. 看起来对吗

```
 private Runnable mStartMosq = new Runnable() {
    public void run() {
        getWindowManager().getDefaultDisplay().getMetrics(dm);
        Log.d("Level1Activity", "width " + dm.widthPixels + " height " + dm.heightPixels);

        int i = nMosq++;

        Scene scene = Level1Activity.this.mEngine.getScene();
        float startX = gen.nextFloat() * CAMERA_WIDTH;
        float startY = gen.nextFloat() * (CAMERA_HEIGHT);   // - 50.0f);
        sprMosq[i] = new Sprite(startX, startY,
                mMosquitoTextureRegion,getVertexBufferObjectManager());
        body[i] = PhysicsFactory.createBoxBody(mPhysicsWorld, sprMosq[i], BodyType.DynamicBody, FIXTURE_DEF);

        sprMosq[i].registerEntityModifier(new SequenceEntityModifier(
                new AlphaModifier(5.0f, 0.0f, 1.0f), 
                new MoveModifier(60.0f, sprMosq[i].getX(), dm.widthPixels/2 , sprMosq[i].getY(), dm.heightPixels/2 , EaseBounceInOut.getInstance())));

        scene.getLastChild().attachChild(sprMosq[i]);
        mPhysicsWorld.registerPhysicsConnector(new PhysicsConnector(sprMosq[i], body[i], true, true));
        if (nMosq < 50) {
            mHandler.postDelayed(mStartMosq, 5000);
        }
    }
}; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-10T19:08:44.500

老实说，对于这个问题，你不需要 box2d，除非你想在你的 bug 发生冲突时做一些花哨的事情。为此，您需要使用 IUpdateHandler。我会给你一个粗略的例子，说明我将如何解决你的问题：

```
 //Velocity modifier for the bugs. Play with this till you are happy with their speed
    private final velocity = 1.0f;

    sprMosq[i] = new Sprite(startX, startY,
    mMosquitoTextureRegion,getVertexBufferObjectManager());

    //Register update handlers
    sprMosq[i].registerUpdateHandler(new IUpdateHandler(){

        @Override
        public void onUpdate(float pSecondsElapsed) {
            //First check if this sprite collides with any other bug.
            //you can do this by creating a loop which checks every sprite
            //using sprite1.collidesWith(sprite2)

            if(collision){
                doCollisionAction(); //Whatever way you want to do it
            } else {
                float XVelocity;  //Velocity on the X axis
                float YVelocity;  //Velocity on the Y axis
                //Generate a different random number between -1 and 1
                //for both XVelocity and YVelocity. Done using Math.random I believe

                //Move the sprite
                sprMosq[i].setPosition(XVelocity*velocity*pSecondsElapsed,
                                    YVelocity*velocity*pSecondsElapsed); 

            }

        }

        @Override
        public void reset() {
        }

    }); 
```

这应该会导致每个 bug 在渲染游戏的每一帧时随机移动。如果您想添加更多错误并消耗处理能力，您可以降低随机性的频率，但您可能希望检查的次数少于该算法所做的每一帧。为此，您可能希望使用 TimerHandler 代替它在一定时间后自动重置。

# sql-server-2008 - 启用以还原数据库

> ID：11382819
> 
> 赞同：0
> 
> 时间：2012-07-08T11:35:03.470
> 
> 标签：sql-server-2008, backup, restore

我已经从远程服务器成功下载了数据库文件。当我尝试在本地系统上恢复它时，它会抛出以下错误消息：

> System.Data.SqlClient.SqlError：媒体集有 2 个媒体系列，但只提供了 1 个。必须提供所有成员。(Microsoft.SqlServer.Smo)

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T11:40:06.050

备份在两个或多个不同文件之间拆分。您需要拥有所有备份文件才能恢复数据库。

要么找到备份集中的其余文件，要么对单个文件执行另一个备份。

# collections - 如何从列表中删除 bean 数据

> ID：11382822
> 
> 赞同：0
> 
> 时间：2012-07-08T11:35:25.347
> 
> 标签：collections, jsf-2, arraylist, javabeans

我`DrawingBean`有

```
public class DrawingBean {
    String drawingTitle;

    public String getDrawingTitle() {
        return drawingTitle;
    }

    public void setDrawingTitle(String drawingTitle) {
        this.drawingTitle = drawingTitle;
    }
} 
```

在 JSF 中，我的页面`drawingPatentss.xhtml`包含以下`h:form`标签。

```
<h:inputText value="#{PersonalInformationDataBean.drawingTitle}" size="80" id="drawingTitle" />
<h:commandButton value="Upload More Drawing" action="# {PersonalInformationDataBean.checkMyDrawingPageData()}" />

<h:dataTable id="patentDrawingList" var="patentDrawingList" value="#{PersonalInformationDataBean.drawingList}"  border="1" width="30%">
<h:column>
<f:facet name="header">
<h:outputText value="Drawing Title" />
</f:facet>
<h:outputText value="#{patentDrawingList.drawingTitle}"/> 
<h:commandButton value="Delete" action="#{PersonalInformationDataBean.removeDataFromDrawingList()}">
<f:setPropertyActionListener target="#{PersonalInformationDataBean.drawingTitle}" value="#{patentDrawingList.drawingTitle}" />
</h:commandButton>
</h:column>
</h:dataTable> 
```

在`PersonalInformationDataBean.java`我有

```
private List<DrawingBean> drawingList = new ArrayList<DrawingBean>();
private String drawingTitle;
DrawingBean drawingBean;
// getter and setter for all of above.

public String checkMyDrawingPageData() {
drawingBean = new DrawingBean();
drawingBean.setDrawingTitle(drawingTitle);
drawingList.add(drawingBean);
return "drawingPatentss?faces-redirect=true";
}

public String removeDataFromDrawingList() {
    drawingBean = new DrawingBean();
    drawingBean.setDrawingTitle(drawingTitle);
    boolean removedStatus = false;
    removedStatus = drawingList.remove(drawingBean);
    System.out.println("removed status === " + removedStatus);
    return "drawingPatentss?faces-redirect=true";
} 
```

但是，该 bean 并未从列表中删除...

但是，如果我在下面添加以下行`removeDataFromDrawingList()`，列表就会更新。

```
 drawingBean = new DrawingBean();
    drawingBean.setDrawingTitle("Temp Title");
    drawingList.add(drawingBean); 
```

请求 bean 没有从我拥有的列表中删除的任何原因。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T11:43:50.590

我得到了解决方案。我不得不使用`Iterator`类。下面的代码成功了......

```
drawingBean = new DrawingBean();
drawingBean.setDrawingTitle(drawingTitle);
boolean removedStatus = false;

for (Iterator itr=drawingList.iterator();itr.hasNext();) {
    drawingBean = (DrawingBean) itr.next();
    if (drawingBean.getDrawingTitle().equals(drawingTitle)) {
        itr.remove();
        removedStatus = true;
    }
} 
```

## [参考](https://stackoverflow.com/a/1310591/1066828)

# java - java中的图像图标

> ID：11382827
> 
> 赞同：4
> 
> 时间：2012-07-08T11:35:59.133
> 
> 标签：java, swing, jlabel, imageicon

我正在开发匹配照片游戏，我想我可以通过知道容器标签的名称来重置 imageIcon，然后在 ismatch 方法中返回 false 时重置标签图标。

在每个标签中写入以下代码，重置仅在第二个标签中起作用..我该怎么办？

```
public ImageIcon firstChoice;
    public ImageIcon SecoundChoice;
    public boolean isSelected = false;

    public boolean isMatch = true;

    public boolean ismatch(ImageIcon firstChoice, ImageIcon secoundChoce) {

        if (firstChoice.getImage() == secoundChoce.getImage()) {
            JOptionPane.showMessageDialog(null, " wowo you got it ^^");
            isMatch = true;
        } else {
            JOptionPane.showMessageDialog(null, "  notmatced");
            isMatch = false;

        }
        return isMatch;
    }

// label Mouse Clicked

private void label1MouseClicked(java.awt.event.MouseEvent evt) { 

    label1.setIcon(new ImageIcon("G:/Games/icons/File Server Asia.png"));

            if (isSelected == true) {
                ImageIcon icon1 = (ImageIcon) label1.getIcon();
                firstChoice = icon1;
                if (SecoundChoice != null && firstChoice != null) {
                }
                boolean match = ismatch(firstChoice, SecoundChoice);
                if (isMatch == false) {
                    label1.setIcon(null);
                    firstChoice = SecoundChoice = null;

                }

            } else {
                if (SecoundChoice == null) {

                    ImageIcon icon1 = (ImageIcon) label1.getIcon();
                    SecoundChoice = icon1;
                    isSelected = true;

                }

                if (isMatch == false) {
                    label1.setIcon(null);

                }

            }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T11:39:26.903

我建议您不要将 ImageIcons 传递到您的`ismatch(...)`方法中，而是传递两个保存 ImageIcons 的 JLabel。然后在方法内部，您可以提取 ImageIcons 并比较它们，与以前相同，但更重要的是，您可以引用保存图标的 JLabels，然后您可以将它们设置为背景或空图标。

```
// "second" is mispelled
public boolean ismatch(JLabel firstChoiceLabel, JLabel secoundChoceLabel) {

    ImageIcon firstChoice = firstChoiceLabel.getIcon();
    ImageIcon secoundChoice = secoundChoiceLabel.getIcon(); 

    if (firstChoice.getImage() == secoundChoce.getImage()) {
        JOptionPane.showMessageDialog(null, " wowo you got it ^^");
        isMatch = true;
    } else {
        JOptionPane.showMessageDialog(null, "  notmatced");
        isMatch = false;

        // here set Icon to null or to background icon.
        firstChoiceLabel.setIcon(null);
        secoundChoiceLabel.setIcon(null);
    }
    return isMatch;
} 
```

# php - PHP/Twitter/Facebook 应用程序的 OOP 结构

> ID：11382831
> 
> 赞同：2
> 
> 时间：2012-07-08T11:37:02.030
> 
> 标签：php, oop

我正在使用 Twitter/Facebook 集成制作一个简单的 PHP 应用程序来练习 OOP 概念和模式，我需要有关如何设计它的帮助。

### 我的应用程序会做什么

基本上，一旦用户登录，他就会显示一个带有**标题和正文**字段的表单。当他点击“发布”时，该内容将被适当地转换并发布到 Facebook 和 Twitter。当然，如果他还没有这样做，他还可以选择验证我的 FB/Twitter 应用程序。这就是我想要达到的目标。

### 到目前为止我想出的结构

由于必须在多个文件之间共享**数据库访问**，因此我使用的是单例模式。本质上，我有一个带有静态*mysqli 链接*的 DB 类和一个获取此数据库链接的静态方法。模型将通过这个单一链接使用 mysqli 函数。（我还不想抽象数据库类型。）

我有一个**User**类，它保存用户的数据，比如它的*id、username 和 hashed password*。它具有根据 id、凭据检索用户甚至将当前用户保存到数据库的方法。

**Auth**类管理会话并为有效用户返回一个User**对象**。因此，它管理登录，并在页面访问之间保持用户登录。

### 我遇到问题的结构

我现在需要访问用户的**Twitter 和 Facebook**信息。当然，它们将位于不同的表中，并有单独的类与它们交互。但是这个类中的每一个都与一个**User**相关联。

因此，当我从数据库中获取用户信息时，我还将使用 JOIN 从 Twitter 和 Facebook 表中获取相应的数据。然后，我的计划是在我的 User 对象中实例化一个 Twitter 和 Facebook 对象。所以，这两个类可以通过 $user->twitter->post("Something"); 来访问。

这是一个好的结构，还是有更好的组织课程的方法？这是一个简单的应用程序，编码不是我关心的。我关心的是结构，因为我应该能够向应用程序添加新的社交网络。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T03:37:35.440

最好将持久性功能保留在域对象之外。我将有一个接口，而不是让`User`类加载和保存自己，`UserRepository`例如：

```
interface UserRepository {
  public function findUser($username);
  public function save(User $user);
} 
```

和一个`MysqlUserRepository`实现这个接口的类。这样，您就可以将特定于数据库的代码排除在`User`类之外。

同样，我会将社交网络功能拉入它们自己的界面，例如：

```
interface SocialNetworkService {
  public function post($status);
} 
```

`FacebookService`和的单独实现`TwitterService`。这允许您添加对新社交网络的支持，而无需修改`User`类。

然后，这些服务可以简单地包装用户对象并为该用户提供服务：

```
$fb = new FacebookService($user);
$fb->post("blah"); 
```

所有这些决定背后的一个共同原则是单一责任原则：你的`User`类应该只有一个改变的理由，那就是当你需要改变用户的模型时。任何其他更改，例如处理数据库或社交网络，都不应影响`User`课程。

# c++ - 在 Windows 上安装 QJson

> ID：11382832
> 
> 赞同：1
> 
> 时间：2012-07-08T11:37:17.243
> 
> 标签：c++, qt, dll, qjson

现在我正在将我的项目从 Linux 移植到 Windows。

[我已经按照指令](http://qjson.sourceforge.net/get_it/windows.html)使用 QtCreator 构建了 QJson ，现在我有一个简单的问题：我应该将库 dll 文件移动到哪里，以及我应该在文件中指定`LIBS +=`什么`.pro`？

这是 Linux 中该行的内容：

```
LIBS += -L/usr/local/lib -lqjson 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T04:31:43.840

只需添加 `LIBS += YourPathTodllFile/Yourdll.dll` 您的个人资料。

# c# - 确定用户是否有权编辑注册表？

> ID：11382836
> 
> 赞同：0
> 
> 时间：2012-07-08T11:37:46.703
> 
> 标签：c#, registry

我正在编写一个使用 c# 编辑注册表的程序

我想检查用户是否有权在程序加载时进行编辑。检查 c# 的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T11:41:31.303

注册表中的每个节点都有自己的 ACL（访问凭证列表）。没有一项权利。

通常，每个应用程序都有自己的注册节点，在 HKLM 配置单元或 HKCU 配置单元中，或两者的组合。

在前一种情况下，用户必须是计算机的管理员，在后一种情况下，用户可以读/写自己的注册表。

要查看实际的访问权限，可以使用[`RegistryKey.GetAccessControl`方法](http://msdn.microsoft.com/en-us/library/x7fwef5z.aspx)。

但是，如上所述，您必须至少具有读取权限才能调用此方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T15:49:25.857

```
try{
    Registry.CurrentUser.OpenSubKey(@"PATH\TO\STUFF", true);
    // Have write permissions.
}
catch {
    // Do not have write permissions.
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-08T11:41:22.540

尝试`RegistryKey`用写权限打开一个。如果它给你一个`Exception`，你没有权限。您甚至可以将哪个异常指定给某个表示您没有权限的异常。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-08T11:43:44.560

用户不应该有权编辑“完整注册表”，他们应该只有权编辑注册表中的某些键。

你最好做一个try catch系统

```
try{
     // Do registry edit
} 
catch {
     Console.Log("Sorry you don't have permission to edit this key");
} 
```

每个用户都是不同的，并且可以使用 Windows ACL 访问注册表的某些部分、所有部分或没有部分。

看看这里的[第一个答案](https://stackoverflow.com/questions/721145/how-to-get-registry-write-permissions-in-c-sharp)。

# c# - 如何在 MS Access 中重置标识列

> ID：11382842
> 
> 赞同：4
> 
> 时间：2012-07-08T11:38:31.660
> 
> 标签：c#, .net, visual-studio-2010, ms-access

我有一个与`MS Access 2007`数据库连接的 Windows 应用程序

表中有 300 多条记录`Customer`。

我已经删除了所有记录。但插入新记录后`CustomerID`返回`301`；但我想将其设置为`1`.

我尝试了以下查询：

```
ALter Table Customer alter column CustomerID Counter(1,1) 
```

但它不起作用

如何重置 MSAccess 中的标识列？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-08T11:45:28.110

在操作方面，您可以删除该列。

在战略方面，我认为您应该重新考虑问题：如果身份列的**值**除了唯一性之外对您很重要，那么您可能正朝着危险的方向前进：您应该认为这样的列完全没有内容，除了是一种唯一解决一行的方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-08T18:09:12.887

如果您确实必须重置自动编号，并且您应该首先考虑@Eugene Rieck 的回答，您可以压缩和修复数据库，无论如何，您应该定期对后端数据库进行此操作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-08T12:00:57.493

见[这里](http://allenbrowne.com/func-ADOX.html#ResetSeed)。关键是：

```
strSql = "ALTER TABLE [" & strTable & "] ALTER COLUMN [" & strAutoNum & "] COUNTER(" & lngNext & ", 1);" 
```

或者，只需删除并重新创建表。

# c++ - 如何在 C++ 中停止应用程序 DoEvents 循环？

> ID：11382844
> 
> 赞同：1
> 
> 时间：2012-07-08T11:39:04.473
> 
> 标签：c++

这是一个 Visual Studio Express C++ Windows 窗体应用程序。

从按下“开始”按钮到按下“停止”按钮的时间，我想每 10 秒在 WAV 播放 wavPlayer 中播放 WAV 文件 strFileName.WAV。

当每 10 秒间隔结束时，TimerEventProcessor 播放 WAV 文件。

问题是我必须按两次“停止”才能让它工作。“停止”的第一次按下似乎被忽略了。

为什么第一次按“停止”时 btnStop_Click 没有执行？

```
private: System::Void bntStart_Click(System::Object^  sender, System::EventArgs^  e) {
  if (String::IsNullOrEmpty(strFileName)) {
    lblRunning->Text = L"Cannot Start Until File Is Loaded";
  }
  else {
    lblRunning->Text = L"Running";   
    myTimer->Interval = iIntervalSeconds * 1000;
    myTimer->Tick += gcnew EventHandler( TimerEventProcessor );
    myTimer->Enabled = true;
    while (lblRunning->Text == L"Running") {
      Application::DoEvents();
    }
  }
}

private: System::Void btnStop_Click(System::Object^  sender, System::EventArgs^  e) {
  lblRunning->Text = L"Stopped";
  myTimer->Enabled = false;
  wavPlayer->Stop();
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-08T11:43:22.460

摆脱

```
while (lblRunning->Text == L"Running") {
  Application::DoEvents();
} 
```

环形。当您从`bntStart_Click`表单返回时，将返回发送消息，并且计时器将按预期滴答作响。您无需创建手动`Application::DoEvents()`循环，这可能是您的问题的原因。

通过调用`Application::DoEvents();`循环，您正在为窗口消息创建一个池循环。没有任何睡眠调用此循环会导致 100% 的 CPU 使用率。通过让您`bntStart_Click`返回 WinForms 运行时将使您的进程休眠，直到消息准备好 - 导致 CPU 使用率非常低。

这种高 CPU 使用率可能使您的应用程序无响应，这就是为什么似乎没有处理点击的原因。

# recursion - Go 中的短变量声明和长变量声明之间的闭包范围区别是什么？

> ID：11382846
> 
> 赞同：15
> 
> 时间：2012-07-08T11:39:18.757
> 
> 标签：recursion, closures, go

根据我对规范的阅读：

> 短变量声明...是具有初始化表达式但没有类型的常规变量声明的简写...

[http://golang.org/ref/spec](http://golang.org/ref/spec)

我原以为两者是相同的：

```
var f func()
f = func() {
    ...
} 
```

和

```
f := func() {
    ...
} 
```

但似乎他们不是。我试图在外部函数中包装一个自递归函数，但这有效：

```
func myOuter() {
    var f func()

    f = func() {
        f()
    }

    f()
} 
```

但这不是，`undefined: f`在内部函数中说。

```
func myOuter() {
    f := func() {
        f()
    }

    f()
} 
```

那么区别是什么呢？有没有办法用简短的声明来写这个，或者我必须把它写出来？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-08T12:16:48.193

`f := func() { /* ... */ }`是相同的`var f func() = func() { /* ... */ }`（但在包级别只允许后一个）。在您的特定情况下，这两种变体都不起作用，因为该语句将从右到左进行评估。解决方案是 - 正如您已经建议的那样 - 将语句分成两部分。一个用于声明变量，另一个用于将递归函数分配给它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-09-21T15:17:20.797

在一个条件下，您的前两个代码示例在语义上是相同的：分配给变量的表达式需要在编译时解析。

这在任何情况下都是相同的，除非您尝试分配引用刚刚声明的变量（或函数）的表达式。这里的问题是，因为 golang 是右关联解析的，它会在将其分配给左侧之前尝试在右侧键入 resolve 表达式。如果您引用声明分配运算符左侧的变量，则您引用的是编译器尚不知道的变量，因此`undefined: f`.

另一个会产生类似结果的例子：

```
x := x + 1 
```

虽然这对于人们来说不太常见，因为很明显 x 还没有被分配。

# templates - Joomla：如何在模板中插入前端编辑图标？

> ID：11382847
> 
> 赞同：1
> 
> 时间：2012-07-08T11:39:19.303
> 
> 标签：templates, joomla, edit, frontend, joomla2.5

> **可能重复：**
> [Joomla 2.5 超级管理员无法编辑前端](https://stackoverflow.com/questions/11301399/joomla-2-5-super-administrator-cant-edit-front-end)

我确实安装了一个不显示前端图标的模板（不是 joomla 原生模板）。

知道我可以把它放在哪里以及如何放置吗？如果我知道我会从本地 joomla 模板中复制所需的代码。它会是什么样子？只是一些php的链接？任何的想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T12:17:02.793

这取决于您是使用 K2 还是 Joomla 文章管理器来显示文章。您需要的不是模板本身的代码。

如果您使用 K2，您需要在 K2 组件中创建一个新用户组，将您的用户名添加到其中，然后授予使用组编辑权限。

如果您使用的是默认的 Joomla，请访问：

Joomla Bakcned >> 文章管理器 >> 选项 >> 编辑布局选项卡

然后确保前 2 个参数设置为“是”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T17:19:47.830

这是我为解决问题所做的。

我替换了自定义模板 /templates/templatename/html/com_content/article 中的文件夹“article”

我从安装附带的 Joomla 模板之一（beez5）中复制/粘贴了原始“文章”文件该文件夹中有两个文件（上面给出的路径），它们包括：default.php index.html

# android - 需要帮助从 Webview 启动 android youtube 意图接收器

> ID：11382855
> 
> 赞同：0
> 
> 时间：2012-07-08T11:40:55.260
> 
> 标签：android, android-intent, webview

我有一个应用程序可以在 webview 中加载一个页面，这个页面有随机的 youtube 链接。我希望当用户选择这些链接之一时打开 youtube 应用程序。我试图创造一个没有运气的意图，我已经在互联网上搜索了几天没有运气。此外，每次页面加载时链接不一定相同，因此需要对其进行解析。有人能帮助我吗？我的代码如下

```
import android.app.Activity;

        import android.content.Intent;

        import android.net.Uri;

        import android.os.Bundle;

        import android.view.View;

        import android.widget.Button;

        import android.webkit.WebSettings.PluginState;

        import android.webkit.WebView;

        import android.webkit.WebViewClient;  

         public class Activity1 extends Activity {

            private WebView webView;

     @Override

     public void onCreate(Bundle savedInstanceState) {

        super.onCreate(savedInstanceState);

        setContentView(R.layout.main);

        webView = (WebView) findViewById(R.id.webView);  

        webView.setWebViewClient(new WebViewClient());  

        webView.getSettings().setPluginState(PluginState.ON);

        webView.getSettings().setJavaScriptEnabled(true);  

        webView.loadUrl("http://www.beatdrop.us/blog");  

        webView.setWebViewClient(new WebViewClient()

        {

         public boolean shouldOverrideUrlLoading(WebView view, String url)

         {

          // YouTube video link

          if (url.startsWith("vnd.youtube:"))

          {

           int n = url.indexOf("?");

           if (n > 0)

           {

        startActivity(new Intent(Intent.ACTION_VIEW,                                          
        Uri.parse(String.format("http://www.youtube.com/v/%s",
         url.substring("vnd.youtube:".length(),n)))));

           }

           return (true);

          }

          return (false);

         }

        });

        Button next = (Button) findViewById(R.id.Button01);

        next.setOnClickListener(new View.OnClickListener() {

            public void onClick(View view) {

                Intent myIntent = new Intent(view.getContext(), Activity2.class);

                startActivityForResult(myIntent, 0);

            }

             });

            }

    }
            <intent-filter> <action android:name="android.intent.action.MAIN" />
      <category android:name="android.intent.category.DEFAULT" />
      <category android:name="android.intent.category.BROWSABLE" />
      <data android:scheme="http"  android:host="youtube.com" android:pathPrefix="/watch" />
      <data android:scheme="https" android:host="youtube.com" android:pathPrefix="/watch" />
    </intent-filter>
            <intent-filter> <action android:name="android.intent.action.MAIN" />
      <category android:name="android.intent.category.DEFAULT" />
      <category android:name="android.intent.category.BROWSABLE" />
      <data android:scheme="http"  android:host="*.youtube.com" android:pathPrefix="/watch" />
  <data android:scheme="https" android:host="*.youtube.com" android:pathPrefix="/watch" />
     </intent-filter>
            <intent-filter> <action android:name="android.intent.action.MAIN" />
      <category android:name="android.intent.category.DEFAULT" />
      <category android:name="android.intent.category.BROWSABLE" />
      <data android:scheme="http"  android:host="www.youtube.com" android:pathPrefix="/v/" />
      <data android:scheme="https" android:host="www.youtube.com" android:pathPrefix="/v/" />
      <data android:scheme="http"  android:host="www.youtube.com" android:pathPrefix="/e/" />
      <data android:scheme="https" android:host="www.youtube.com" android:pathPrefix="/e/" />
      <data android:scheme="http"  android:host="www.youtube.com"      android:pathPrefix="/embed/" />
        <data android:scheme="https" android:host="www.youtube.com" android:pathPrefix="/embed/" />
    </intent-filter>
            <intent-filter> <action android:name="android.intent.action.MAIN" />
        <category android:name="android.intent.category.DEFAULT" />
        <category android:name="android.intent.category.BROWSABLE" />
        <data android:scheme="vnd.youtube" />
    </intent-filter> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-25T23:54:16.163

```
 webView.setWebViewClient(new WebViewClient()
    {
        @Override
        public boolean shouldOverrideUrlLoading(WebView view, String url) {
            startActivity(new Intent(Intent.ACTION_VIEW, Uri.parse(url)));
            return true;
        }

        @Override
        public void onPageFinished(final WebView view, String url) {
            String javascript = "javascript:" +
                "var iframes = document.getElementsByTagName('iframe');" +
                "for (var i = 0, l = iframes.length; i < l; i++) {" +
                "   var iframe = iframes[i]," +
                "   a = document.createElement('a');" +
                "   a.setAttribute('href', iframe.src);" +
                "   d = document.createElement('div');" +
                "   d.style.width = iframe.offsetWidth + 'px';" +
                "   d.style.height = iframe.offsetHeight + 'px';" +
                "   d.style.top = iframe.offsetTop + 'px';" +
                "   d.style.left = iframe.offsetLeft + 'px';" +
                "   d.style.position = 'absolute';" +
                "   d.style.opacity = '0';" +
                "   d.style.filter = 'alpha(opacity=0)';" +
                "   d.style.background = 'black';" +
                "   a.appendChild(d);" +
                "   iframe.offsetParent.appendChild(a);" +
                "}";
            view.loadUrl(javascript);

            super.onPageFinished(view, url);
        }
    }); 
```

# sql - How to change the format of the date with datetime DateType in SQL Server?

> ID：11382865
> 
> 赞同：1
> 
> 时间：2012-07-08T11:42:08.193
> 
> 标签：sql, sql-server-2008-r2

I have the following query that retrieves what I need from the database:

```
SELECT     
   dbo.SafetySuggestionsLog.ID, dbo.SafetySuggestionsLog.Title, 
   dbo.SafetySuggestionsLog.Description, dbo.employee.Name, 
   dbo.SafetySuggestionsLog.Username, dbo.Divisions.DivisionShortcut, 
   dbo.SafetySuggestionsType.Type, 
   ISNULL(dbo.SafetySuggestionsStatus.Status, '-') AS Status, 
   dbo.SafetySuggestionsLog.DateSubmitted
FROM 
   dbo.employee 
INNER JOIN
   dbo.SafetySuggestionsLog ON dbo.employee.Username = dbo.SafetySuggestionsLog.Username 
INNER JOIN
   dbo.Divisions ON dbo.employee.DivisionCode = dbo.Divisions.SapCode 
INNER JOIN
   dbo.SafetySuggestionsType ON dbo.SafetySuggestionsLog.TypeID = dbo.SafetySuggestionsType.ID 
LEFT OUTER JOIN
   dbo.SafetySuggestionsStatus ON dbo.SafetySuggestionsLog.StatusID = dbo.SafetySuggestionsStatus.ID
ORDER BY 
   dbo.SafetySuggestionsLog.DateSubmitted DESC 
```

Instead of showing the date under `DateSubmitted` column as (`6/23/2012 7:15:00 AM`), I want to display it as `(Jun-2012)`.

How to do that?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T11:49:00.620

You can have above format using below example query :

```
 SELECT REPLACE(RIGHT(CONVERT(VARCHAR(11), CAST('6/23/2012 7:15:00 AM' AS DATETIME), 106), 8), ' ', '-') AS [Mon-YYYY] 
```

In your query, you can try like this :

```
SELECT     dbo.SafetySuggestionsLog.ID, dbo.SafetySuggestionsLog.Title, dbo.SafetySuggestionsLog.Description, dbo.employee.Name, 
                      dbo.SafetySuggestionsLog.Username, dbo.Divisions.DivisionShortcut, dbo.SafetySuggestionsType.Type, ISNULL(dbo.SafetySuggestionsStatus.Status, '-') AS Status, 
                      REPLACE(RIGHT(CONVERT(VARCHAR(11),dbo.SafetySuggestionsLog.DateSubmitted, 106), 8), ' ', '-') AS [Mon-YYYY]
FROM         dbo.employee INNER JOIN
                      dbo.SafetySuggestionsLog ON dbo.employee.Username = dbo.SafetySuggestionsLog.Username INNER JOIN
                      dbo.Divisions ON dbo.employee.DivisionCode = dbo.Divisions.SapCode INNER JOIN
                      dbo.SafetySuggestionsType ON dbo.SafetySuggestionsLog.TypeID = dbo.SafetySuggestionsType.ID LEFT OUTER JOIN
                      dbo.SafetySuggestionsStatus ON dbo.SafetySuggestionsLog.StatusID = dbo.SafetySuggestionsStatus.ID
ORDER BY dbo.SafetySuggestionsLog.DateSubmitted DESC 
```

Be sure,`dbo.SafetySuggestionsLog.DateSubmitted` column should be `datetime` type, otherwise cast it to `datetime` type

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T12:57:29.950

Another alternative that is more self-explanatory:

```
SELECT CONVERT(CHAR(3), DATENAME(MONTH, GETDATE())) + '-' + RTRIM(YEAR(GETDATE())); 
```

Used in your query (along with aliases, which will make your queries much easier for you and others to read):

```
SELECT 
  sl.ID, 
  sl.Title, 
  sl.[Description], 
  e.employee.Name, 
  sl.Username, 
  d.DivisionShortcut, 
  st.[Type], 
  ISNULL(ss.[Status], '-') AS [Status],
  sl.DateSubmitted,
  MonthSubmitted = CONVERT(CHAR(3), DATENAME(MONTH, sl.DateSubmitted)) 
    + '-' + RTRIM(YEAR(sl.DateSubmitted))
FROM 
  dbo.employee AS e
  INNER JOIN dbo.SafetySuggestionsLog AS sl
    ON e.Username = sl.Username 
  INNER JOIN dbo.Divisions AS d
    ON e.DivisionCode = d.SapCode 
  INNER JOIN dbo.SafetySuggestionsType AS st
    ON sl.TypeID = st.ID 
  LEFT OUTER JOIN dbo.SafetySuggestionsStatus AS ss 
    ON sl.StatusID = ss.ID
ORDER BY 
  sl.DateSubmitted DESC; 
```

In SQL Server 2012, this will be much easier with the new [`FORMAT()`](http://msdn.microsoft.com/en-us/library/hh213505.aspx) function, which has rough parity with the [C# format function](http://msdn.microsoft.com/en-us/library/az4se3k1.aspx), supports optional culture, and doesn't require having to memorize style numbers:

```
SELECT FORMAT(GETDATE(), 'MMM-yyyy'); 
```

# mysql - 层次关系的 SQL

> ID：11382866
> 
> 赞同：7
> 
> 时间：2012-07-08T11:42:12.243
> 
> 标签：mysql, sql

我有一个表格，其中产品根据层次关系进行分类，如树形结构。我必须在任何级别选择一个类别和所有子类别。见下图：

![在此处输入图像描述](../Images/f42979e8f5508393384698199f5cb6df.png)

例如，我想要一个 sql 语句，当我查询传递 id=11 时，它返回我 (19,20,21,22,23,24,25,26)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-08T11:46:55.910

在 MySQL 中存储分层数据有几种不同的方法。查看 Bill Karwin 的[演示文稿](http://www.slideshare.net/billkarwin/models-for-hierarchical-data)，其中演示了四个选项。

*   邻接表
*   路径枚举
*   嵌套集
*   封闭表

您正在使用**邻接列表**模型来存储分层数据，但不幸的是，这是您可以选择用于查询子树的**最难的模型。**

![嵌套集查询子树](../Images/030f8e4a2f4a0c9a59a14a957a0157df.png)

您的选择是：

*   更改为不同的模型。
*   将查询限制在 n 级深。
*   使用存储过程递归查询。有关这方面的更多信息，请参阅 Quassnoi 的系列文章 - [MySQL 中的分层查询](http://explainextended.com/2009/03/17/hierarchical-queries-in-mysql/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T11:46:12.710

```
SELECT * FROM `Products` 
WHERE parentId IN (
    SELECT id FROM `Products` 
    WHERE parentId = 11) 
```

注意：如果您的层次结构深于 2 个级别，这将不起作用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-08T11:47:22.373

您能否稍微更改您的数据结构以包含计算的 linage 列。有一篇[很棒的文章](http://www.sqlteam.com/article/more-trees-hierarchies-in-sql)向您展示了通用概念（忽略数据库类型）。

基本上，您计算的 linage 列应包含其中的父母列表，例如

第 26 项将包含`\11\`

如果你有一个子项目，你可以有

`\11\subitem\`

然后你可以简单地对你的 linage 表做一个类似的检查，它比迭代搜索快得多，你可以使用存储的过程或触发器来创建它。

```
Node    ParentNode  EmployeeID  Depth   Lineage
100        NULL         1001            0   /
101        100          1002            1   /100/
102        101          1003            2   /100/101/
103        102          1004            3   /100/101/102/
104        102          1005            3   /100/101/102/
105        102          1006            3   /100/101/102/ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-09T05:49:03.283

这很麻烦，你必须做 n 个联合，其中 n 是你的层次结构有多深，但它应该可以工作：

```
SELECT * FROM `Products` WHERE parentId IN (
    SELECT id FROM `Products` WHERE parentId = 11)
UNION
SELECT * FROM `Products` WHERE parentId IN (
    SELECT id FROM `Products` WHERE parentId IN (
         SELECT id FROM `Products` WHERE parentId = 11))
UNION
SELECT * FROM `Products` WHERE parentId IN (
    SELECT id FROM `Products` WHERE parentId IN (
        SELECT id FROM `Products` WHERE parentId IN (
             SELECT id FROM `Products` WHERE parentId = 11))) 
```

# javascript - javascript函数不起作用

> ID：11382868
> 
> 赞同：0
> 
> 时间：2012-07-08T11:43:13.793
> 
> 标签：javascript, html, google-chrome, alert

我目前正在开发一个网站。如果用户按下按钮，则需要调用 javascript 函数。我将此功能简化为：

```
<html>
<head>
<script type="text/javascript">
function newProd(number,customer,software,hardware,name)
{
       //I simplified this function
       alert('number is: '+number+'customer is: '+customer+' software is: '+software+' hardware is: '+hardware+' name is: '+name);
}
</script>
</head>

<body>
     <input type="text" name="textfieldCustomer"><br>
     <input type="text" name="textfieldSoftware"><br>
     <input type="text" name="textfieldHardware"><br>
     <input type="text" name="textfieldDescription"><br>
     <input type="button" name="button" value="go to function" onClick="newProd('a number',textfieldCustomer.value,textfieldSoftware.value,textfieldHardware.value,textfieldDescription.value)">
</body> 
```

当用户在 Internet Explorer 中按下按钮时，该功能完美运行！不幸的是，该功能在 Chrome 或 Safari 中不起作用。

有谁知道出了什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-08T11:47:38.020

表单字段不应该被定义为全局变量。也许在 IE 中它们是，但这不是你可以依赖的行为。试试这个：

```
onClick="newProd('a number',
    this.form.textfieldCustomer.value,
    this.form.textfieldSoftware.value,
    this.form.textfieldHardware.value,
    this.form.textfieldDescription.value)"> 
```

哦，当然还要添加一个表单来包装输入。

演示：http: [//jsfiddle.net/kdUMc/](http://jsfiddle.net/kdUMc/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T11:53:40.880

在我看来，您的代码中有两个大错误。首先，对输入字段的访问是错误的。它需要与实例变量的连接，例如“文档”。第二个，缺少表单标签。如果将输入字段包装到表单标签中，则可以访问 Esailija 发布的值。

# php - 使用 require_once 时无法从包含的文件中访问数组

> ID：11382873
> 
> 赞同：0
> 
> 时间：2012-07-08T11:43:56.803
> 
> 标签：php, arrays, require, require-once, var-dump

我的问题是，如果我使用 require_once 来包含具有数组的文件，则无法从包含它的文件中访问该数组。例如这是我的 foo.php 文件

```
<?php
$array['name'] = 'John';
$array['age'] = 34;
?> 
```

这是我的 bar.php 文件

```
<?php
//if i use require here instead of require once, the var_dump returns true
require_once('foo.php');
//This would return null
var_dump($array);
?> 
```

我怎样才能找到问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-18T15:15:01.287

好的，所以我刚刚解决了这个完全相同的问题。这是我遇到问题的原始设置。

```
<?php
require_once('SiteProcesses.class.php');
$login = new SiteProcess();

$login->testForLogin();

require_once('header.php');
require_once('settings.php'); # This is where the array was set

var_dump($array);
?> 
```

当然，输出是：

```
NULL 
```

再多一点信息：

我在“ ***testForLogin()*** ”方法和“ ***header.php ”文件中都包含了“*** ***settings.php*** ”文件。我终于让阵列在这个配置下正常工作：

 **```
<?php
require_once('settings.php'); # This is where the array was set

require_once('SiteProcesses.class.php');
$login = new SiteProcess();

$login->testForLogin();

require_once('header.php');

var_dump($array);
?> 
```

现在脚本工作正常。

```
array(2) { [1]=> string(1) "1" [2]=> string(1) "2" } 
```

因此，在包含所有其他文件之后，在包含设置文件之后，尝试从设置文件中调用数组显然出了点问题。只需将设置文件作为第一个包含的文件对我有用。

***名称已更改以保护无辜者*

***是的，我知道你们中的一些人在这篇文章中可能有不同的方式来做同样的事情，当然你认为你的方式更好。亚达亚达。请保留您的意见。如果我想要一种不同的方式，那么我会去寻找它。我不需要你在我的帖子中注入你不受欢迎的方式。谢谢你。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T13:51:46.100

没有问题。代码在 require_one 或 require 下运行良好。你做错了其他事情。**

# php - mysql自动增量 - 删除记录后重新分配

> ID：11382877
> 
> 赞同：1
> 
> 时间：2012-07-08T11:44:38.773
> 
> 标签：php, sql, auto-increment

我`auto-increment`用来为数据库中的每个新条目分配一个 ID。另外，我有一个 php 脚本，它根据当前的页码从这个数据库中选择 10 个条目。例如，如果当前页面为 2，则脚本应选择 id=20 和 id=29 之间的每个条目。

现在，如果我删除一个条目，则 ID 将丢失。因此，当 id28 被删除时，脚本只会显示 9 个条目。

有没有办法`auto-increment`在删除 e 记录后重新分配值？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-08T11:51:12.993

这通常被认为是可取的：如果条目号`28`被删除，将永远不会再有条目`28`。如果有人尝试引用它，他们显然是在尝试引用已删除的那个，您可以报告错误。

如果您返回并重新分配`28`到某个新条目，那么您现在不知道该人是指***旧*** `28`记录还是***新***记录。

让我们退后一步，重新审视你想做的事情。您的目标不是在`20`和之间显示十个条目`30`。您的目标是显示十个符合您条件的条目。为此，您可以使用内置`LIMIT`和`OFFSET`术语：

```
SELECT ...
FROM ...
WHERE ...
OFFSET 29
LIMIT 10 
```

告诉 MySQL从`OFFSET`哪里开始计数并`LIMIT`告诉它要计数多少。MySQL 会将整个结果集放在一起，然后从第 30 个条目开始为您提供 10 个条目。这是您的第四页结果。现在他们碰巧拥有什么 ID 已经无关紧要了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-08T11:50:43.337

您应该更改为页面选择条目的方式。

通过使用 LIMIT .. OFFSET 子句，您将能够选择 10 个条目，从第 N 个条目开始：

```
SELECT   *
FROM     table
ORDER BY id
LIMIT    10
OFFSET   19 
```

*   `LIMIT 10`表示*只返回 10 行*
*   `OFFSET 19`表示*在第 19 行之后返回行*

这样，如果某些 id 已被删除并且 id 不是连续的，则无关紧要。

只需更改偏移量：

*   第 1 页 => 偏移量 0
*   第 2 页 => 偏移量 9
*   第 3 页 => 偏移量 19
*   第 N 页 => 偏移量 (N-1)*10-1

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-08T11:51:41.917

您的问题建议像这样的查询

```
SELECT columns FROM table WHERE id BETWEEN 20 AND 29; 
```

或不那么优雅

```
SELECT columns FROM table WHERE id >= 20 AND id <= 29; 
```

如果是这样，我建议您阅读[LIMIT 条款](http://dev.mysql.com/doc/refman/5.5/en/select.html)并按照以下方式做一些事情

```
SELECT columns FROM table ORDER BY id LIMIT 20, 10; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-08T11:52:24.967

你可以，但你不应该。如果 id=29 存在，你将自增重设为 28，那么当自增想使用 id=29 但记录已经存在时，就会出现问题。

你最好写一个这样的查询：

```
select * from table order by ID LIMIT n,10; 
```

其中n是页码*10

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-08T11:55:00.833

重新分配自动增量值是不好的做法，因为 id 可能与其他表相关使用。使用偏移/限制构造，忘记重新分配自动增量 :)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-07-08T11:58:34.600

作为对您的问题 (auto_increment) 的直接回答，您可以使用以下查询更改其值：

```
ALTER TABLE `your_table` AUTO_INCREMENT = 200 
```

下一个创建的项目将其下一个 AI 列值设置为 200。这在某些情况下很有用，尽管我同意您最好使用 LIMIT 偏移量。

# unit-testing - 如何测试使用 linq2sql 和存储库模式实现的 DAL？

> ID：11382884
> 
> 赞同：0
> 
> 时间：2012-07-08T11:46:16.337
> 
> 标签：unit-testing, linq-to-sql, repository

这是我的 DAL 的一部分。

数据上下文接口：

```
public interface IDataContextFactory
{
    System.Data.Linq.DataContext Context { get; }
    void SaveAll();
} 
```

这是我的数据上下文类，其中包含生成的类：

```
partial class InternetRailwayTicketSalesDataContext: DataContext, IDataContextFactory
{
    public System.Data.Linq.DataContext Context
    {
        get { return this; }
    }

    public void SaveAll()
    {
        this.SubmitChanges();
    } 
} 
```

这是我的存储库界面：

```
public interface IRepository<T> where T : class
{
    /// <summary>
    /// Return all instances of type T.
    /// </summary>
    /// <returns></returns>
    IEnumerable<T> GetAll();
} 
```

这是我的存储库接口实现：

```
public class Repository<T> : IRepository<T> where T : class
{
    protected IDataContextFactory _dataContextFactory;

    /// <summary>
    /// Return all instances of type T.
    /// </summary>
    /// <returns></returns>
    public IEnumerable<T> GetAll()
    {
        return GetTable;
    }

    private System.Data.Linq.Table<T> GetTable
    {
        get { return _dataContextFactory.Context.GetTable<T>(); }
    }
} 
```

这是具体存储库类的接口：

```
interface IPasswayRepository
{ 
    bool IsPasswayExists(int id);
} 
```

最后是一个具体的存储库类实现：

```
class PasswayRepository:Repository<Passway>, IPasswayRepository
{
    public PasswayRepository(IDataContextFactory context)
        : base(context)    
    {                    
    }

    public bool IsPasswayExists(int id)
    {
        if (GetAll().Where(pass => pass.Id == id && pass.IsDeleted == false).Count() > 0)
            return true;
        else
            return false;           
    }   
} 
```

你能给我一个如何测试 IsPasswayExists 方法的例子吗？（如果您愿意，可以使用任何模拟框架）。

# events - 如何在 extjs 日期字段或日期选择器中访问更改月份事件

> ID：11382888
> 
> 赞同：0
> 
> 时间：2012-07-08T11:46:36.603
> 
> 标签：events, extjs, datepicker, listener

我想要这样的东西：

```
{
  xtype:'datefield',
  editable:false,
  fieldLabel:'date',
  listeners:{
    monthChange:function(picker){
      alert("selected month and year")
    }
  }
} 
```

换月有什么活动吗？如果没有，我该怎么写？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-01-13T12:44:26.117

这是扩展 'Ext.date.Picker' 的示例，因为没有 'monthchange' 事件：

```
Ext.define("YourCalendarPicker", {
    extend: "Ext.picker.Date",
    ...
    update : function(date, forceRefresh){
        var me = this,
            monthViewChange = me.isAnotherMonthView(date);
        me.callParent(arguments);
        if (monthViewChange){
            me.fireEvent("monthviewchange", me, date, me.activeDate);
        }
        return me;
    },
    ...

    /**
     * return true if the given date is in a different month view of the actual calendar date
     * @param {Date} date
     * @return {Boolean}
     */
    isAnotherMonthView: function(date){
        var activeDate = this.activeDate || date;
        return date.getYear() != activeDate.getYear() || date.getMonth() != activeDate.getMonth();
    }
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T04:36:06.650

确实没有monthChange事件，但是您可以在有人选择新日期时收听，然后也许您可以比较月份以查看它是否改变了？ [http://docs.sencha.com/ext-js/4-1/#!/api/Ext.picker.Date-event-select](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.picker.Date-event-select)

如果这不是您要解决的问题，更多信息会有所帮助。

# c - 结构中的数组和结构数组的动态内存分配

> ID：11382890
> 
> 赞同：1
> 
> 时间：2012-07-08T11:46:43.743
> 
> 标签：c, arrays, memory-management, struct

我是 C 的新手。我试图了解动态内存分配在结构和数组的情况下是如何工作的。所以例如我有一个类似的代码。

```
struct Person
{
    int id;
    char *name;
    char *place;
};

struct Database
{ 
    struct Person *data_rows;
}; 
```

我想为字符数组名称和位置动态分配内存..以及 struct data_rows 数组..将它们的大小作为输入..那么理想的分配顺序和正确的语法应该是什么？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T11:59:57.150

好吧，“显然”你需要先填写“struct Database”：

```
struct Database MyDatabase;

MyDatabase.data_rows=malloc(sizeof(MyDatabase.data_rows[0])*NumberOfPeople); 
```

忽略我没有检查 malloc() 是否失败的事实，这将为您提供一个“struct Person”数组，所有这些都未初始化。所以，很可能，你会想要初始化它们：

```
int i;
for (i=0; i<NumberOfPeople; i++)
{
   struct Person* MyPerson;

   MyPerson=&MyDatabase.data_rows[i];
   MyPerson->id=i;
   MyPerson->name=malloc(...);
   /* Do something to store the name in MyPerson->name */
   MyPerson->place=malloc(...);
   /* Do something to store the place in MyPerson->name */
} 
```

现在，这里的问题是我放在 malloc 上的“...”。如果您使用固定大小很容易，但是您可以将您的结构声明为类似

```
struct Person
{
    int id;
    char name[100];
    char place[200];
}; 
```

基本上，我只是不知道名称的长度应该是多少，因此我只是将其键入为“...”。

另外，我只是猜测“id”可能是什么。使用数组索引实际上有点毫无意义:-)

当然，您不必现在就全部完成。您可以只设置名称并将指针设置为 NULL 并稍后填写它们，例如当您从文件中读取数据时，或者您计划执行的任何操作时。或者，如果您确信您的代码始终“知道”哪些字段已初始化，哪些字段未初始化，则您可以根本不在这里初始化它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T12:03:26.183

我强烈建议编写一个函数`person_new`来`person_free`处理结构内存管理：

```
struct Person* person_new(char *name, char* place) {
  struct Person* person = malloc(sizeof(struct Person));

  person->name = strdup(name);
  person->place = strdup(place);

  return person;
}

void person_free(struct Person* person) {
  free(person->name);
  free(person->place);
  free(person);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-08T12:03:18.277

最好的办法是将你的结构转换为类，以下也适用于结构......

您在 Database 和 Person 中定义构造函数和析构函数，如下所示：

```
struct Person
{
    Person(){
        name = new char[256];
        place = new char[256]; 
    };
    ~Person(){
       delete name; 
       delete place;
    }

    int id;
    char *name;
    char *place;
};

struct Database
{ 
    Database(int nPersons){
       data_rows = new Person[nPersons]; 
    };
    ~Database(){
       delete data_rows;
    };
    struct Person *data_rows;
}; 
```

或者您可以在没有构造函数和析构函数的情况下执行此操作，并在代码中按顺序分配所有内容，这是一种非常丑陋的方法！

作为：

```
Database myData;
myData.data_rows = new Persons[40];
for(int i=0; i < 40; i++){
   myData.data_rows[i].name = new char[256];
   myData.data_rows[i].place = new char[256];
} 
```

请注意，这`data_rows[i]`只不过是 -> `*(data_rows + i)`将指针的地址移动 i 次，然后取消引用它！

# javascript - 内容依赖于 javascript 的 JQuery 对话框

> ID：11382901
> 
> 赞同：0
> 
> 时间：2012-07-08T11:48:16.490
> 
> 标签：javascript, jquery, user-interface

我正在使用 jQuery 在对话框窗口中创建表单。

我目前正在使用 jQuery load() 函数加载部分视图，然后将视图添加到 jQuery UI 对话框中。部分视图包含一个 html 表单，该表单还包含标记中的验证脚本。

这就是我加载视图并实例化对话框窗口的方式：

```
$('<div/>').load('/controller/view #targetDiv').dialog(); 
```

不幸的是 load() 函数丢弃了局部视图中的脚本。:(

验证脚本很重要，因为它在“输入模糊”事件上对表单控制器进行 ajax 调用，并返回服务器端表单验证响应。这意味着验证脚本必须在对话框内的表单上连续运行。

问题是我加载了视图但没有 javascript。

这个问题有什么解决办法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T11:51:19.840

您可以将 javascript 代码保存在单独的`.js`文件中并使用[`getScript()`](http://api.jquery.com/jQuery.getScript/)方法。

> 使用 GET HTTP 请求从服务器加载 JavaScript 文件，然后执行它。

# python - Python 的 TextMate 命令行参数

> ID：11382902
> 
> 赞同：5
> 
> 时间：2012-07-08T11:48:33.227
> 
> 标签：python, textmate, command-line-arguments

当您使用 CMD R 运行 python 脚本时，有没有办法让 TextMate 填充命令行参数？

# java - 如何使用 JSP 从 Apache Wink 返回 XHTML 输出？

> ID：11382903
> 
> 赞同：1
> 
> 时间：2012-07-08T11:48:50.153
> 
> 标签：java, jsp, rest, jax-rs, apache-wink

到目前为止，我已经成功地使用[Apache Wink](http://incubator.apache.org/wink/)设置了一个基本的 Web 服务。这包括根据提供的示例返回 Atom、JSON、HTML、XHTML、XML 和纯文本媒体类型。我还能够成功地使用 MessageBodyWriter 来“手动”生成 XHTML 输出。到目前为止，很棒。我很高兴通过现有的 Wink 机制返回大多数媒体类型。

我现在要做的是让返回的 XHTML 内容使用 JSP。即，我想使用 JSP 作为输出模板，将 POJO 作为参数发送，以填充 JSP 中的字段。下面是我现在所拥有的一些伪代码。

```
@Path("{id}")
@GET
@Produces({MediaType.APPLICATION_XHTML_XML})
public Response getXhtml( @PathParam("id") String id )
{
    try { 
        MyBean mybean = service.getBean(id);
        return Response.ok(new MyAsset(mybean))
                .location(new URI(baseurl+"Output.jsp"))
                .type(MediaType.APPLICATION_XHTML_XML).build();
    } catch ( Exception e ) {
        throw new WebApplicationException(e,Status.INTERNAL_SERVER_ERROR);
    }
} 
```

它似乎完全忽略了 JSP。如果我最终弄清楚如何，我需要知道如何将 POJO 作为参数传递。我知道我在这里缺少一些东西，因为我假设 Apache Wink 可以与基于 JSP 的 Web 服务互操作。Wink 文档通常很好，但我在这方面找不到任何东西。感谢您的帮助，最好是指向工作示例的链接。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T03:48:00.397

最后，我通过查看 Wink 的`DefectAsset`示例获得的一些想法，找到了解决方案。线索就是`HtmlDescriptor`类，它可以在 Wink 的内部 API 中找到。

我在 Asset 的构造函数中提供我的 bean 作为参数（即，注释为“ `@Asset`”的类），然后将 Asset 作为响应中的实体直接传递给 JSP：

```
MyBean mybean = service.getBean(id);
return Response.seeOther(new URI(baseurl+"Output.jsp"))
        .entity(new MyAsset(bean))
        .type(MediaType.APPLICATION_XHTML_XML).build(); 
```

这需要 MyAsset.java 中的一个方法：

```
@Produces({MediaType.APPLICATION_XHTML_XML})
public HtmlDescriptor getHtml()
{
    return new HtmlDescriptor(bean,"/Output.jsp","MyBeanPayload");
} 
```

在 Output.jsp 中，我通过作为 HtmlDescriptor 构造函数中的第三个参数提供的属性名称来访问 bean：

```
<%
  MyBean bean = (MyBean)request.getAttribute("MyBeanPayload");
  String id = bean.getId();
%> 
```

在 JSP 中，我使用 HTML 表单中的返回值，因此我使用 Apache Commons Lang 的[StringEscapeUtils.escapeHtml()](http://commons.apache.org/lang/api-release/org/apache/commons/lang3/StringEscapeUtils.html)方法对它们进行转义。返回的 URI 不包含任何内容，除了附加了“ `?alt=application%2Fxhtml%2Bxml`”的 RESTful 路径，用于指定媒体类型。

这似乎演示了如何通过 Apache Wink 将 POJO 传递到输出 JSP。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T12:50:53.367

没有将 POJO 作为参数传递的内置机制。您需要自己构建 URI。另外，我猜您想将重定向发送到您的 jsp 而不仅仅是`200 OK`. 所以你可以做这样的事情：

```
@Path("{id}")
@GET
@Produces({MediaType.APPLICATION_XHTML_XML})
public Response getXhtml( @PathParam("id") String id )
{
    try { 
        MyBean mybean = service.getBean(id);
        return Response.seeOther(UriBuilder.fromUri(baseurl+"Output.jsp")
                 .replaceQuery(convertMyBeanToQuery(mybean)).build())
                .type(MediaType.APPLICATION_XHTML_XML).build();
    } catch ( Exception e ) {
        throw new WebApplicationException(e,Status.INTERNAL_SERVER_ERROR);
    }
} 
```

您需要实现`convertMyBeanToQuery`构建查询字符串：`key=value&key1=value`

也可以`UriBuilder.queryPatam`用来一一添加参数。

# c - 以错误的方式定义结构

> ID：11382905
> 
> 赞同：1
> 
> 时间：2012-07-08T11:49:24.353
> 
> 标签：c, gcc

有人可以向我解释这段代码有什么问题吗？

```
#include<stdio.h>

struct A{
    int i;
    struct A* parent; 
    struct B test; // error: field ‘test’ has incomplete type
};
struct B{
    struct A* rootParent;
    int ref;
    int something;
};

int main(){
    struct A some, some2;
    some.i = 0;
    some.parent = &some2;
    some.test.rootParent = &some;
    some.test.ref = some.test.something = 0;
    some2.i =0; 
    some2.parent = 0;
    some2.test.rootParent = 0;
    some2.test.ref = some2.test.something = 0;
    return 0;
} 
```

看来我在这里缺少一些基本的东西。为什么 A 和 B 的顺序很重要？有没有可能让它变得无关紧要？

如果我改变减速顺序一切正常，B优先。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-08T12:05:12.770

[cnicutar](https://stackoverflow.com/a/11382918/41747)几乎是对的。这是重新排序声明的解释和正确答案。

`struct`编译器在读取定义时需要计算 a 的大小。在你的情况下，大小`struct B`是未知的，所以你得到一个错误。所以你可以在这个简单的情况下交换声明的顺序：

```
struct B{
    struct A* rootParent;
    int ref;
    int something;
};

struct A{
    int i;
    struct A* parent; 
    struct B test;
}; 
```

*即使`struct A`是未知类型*，它也会起作用。它之所以有效，是因为对类型的引用是一个指针，因此大小是已知的。如果您认为您需要两个包含彼此完整实例的类型，那么您不能使用此方法。事实上，您不能声明`struct A`包含一个包含成员*by-value*`struct B` *的*by-value 的 a 。事实证明，无论如何它都是相当荒谬的——其中一个链接必须是参考。`struct A`

# c++ - 为什么将迭代器定义为结构而不是类？

> ID：11382908
> 
> 赞同：2
> 
> 时间：2012-07-08T11:49:39.117
> 
> 标签：c++, stl, iterator

我有一些关于 STL 迭代器实现的小问题。

*   为什么将迭代器定义为结构而不是类？
*   主要原因是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-08T11:51:52.003

~~这是一种实施选择。~~ `class`和`struct`中几乎相同`C++`，区别在于默认访问说明符和继承，对于类是私有的，对于结构是公共的。因此，如果一个类型几乎不需要私有数据成员，那么将其实现为结构可能更有意义。但是您可以将完全相同的类型实现为：

```
struct Iterator : IteratorBase {
  SomeType x;
}; 
```

完全一样

```
class Iterator : public IteratorBase{
 public:
  SomeType x;
}; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-08T11:55:49.713

这是在标准**24.2**中定义的，它描述了`<iterator>`标题，它们是`struct`. 之所以做出这种选择，可能是因为迭代器提供了对容器元素的访问，并且使它们`class`毫无用处，唯一的区别是默认情况下`class`具有访问级别`private`，而`struct`具有`public`访问级别。

因此，如果声明迭代器`class`而不是`struct`：

*   make all members `public`, 没有用, 直接 make 也可以达到同样的效果`struct`.
*   制作吸气剂，这将提供不必要的开销和抽象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-08T11:51:37.103

谁说你迭代器是由结构定义的？在标准方面，它没有任何内容。结构和类只有一个区别——默认访问元素。因此，在结构中默认访问是公共的，而在类中默认访问是私有的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-08T16:31:48.683

喜欢最好的答案

除了访问之外，class和struct是相同的。所以使用struct或class没有太大区别。

我们知道 C++ 是包含 C

使用 struct 看起来很简单，并且区分了 struct 和 class。

这是迭代器的定义

```
struct output_iterator_tag{}
struct input_iterator_tag{}
struct forward_iterator_tag : public input_iterator_tag {};
struct bidirectional_iterator_tag : public forward_iterator_tag{}
struct random_accessl_iterator_tag : public bidirectional_iterator_tag{} 
```

# ejb-3.1 - EJB 3.1 安全角色（如果未指定）

> ID：11382912
> 
> 赞同：1
> 
> 时间：2012-07-08T11:50:04.023
> 
> 标签：ejb-3.1

我有一个使用某些角色的 EJB 3.1 bean。但是我当前的环境只支持用户，没有角色。

EJB 3.1 核心规范，第 17.4.2 章说，如果部署者没有将应用程序定义的逻辑安全角色分配给操作环境中的组，则必须假定逻辑角色映射到相同的主体或主体组姓名。这意味着如果环境中没有角色，则 bean 中给出的角色名称被假定为“用户”。因此，bean 将按预期工作而不会出现任何问题。您可以在您的环境中使用与 bean 中给出的所有角色名称相匹配的名称来定义用户。

所以，我的 bean 将在当前环境中正常工作，我可以在 bean 的业务方法中使用 isCallerInRole("user1") 来检查系统中定义的 user1？

# css - 我的垂直导航只和我的窗口一样高，不知道为什么

> ID：11382913
> 
> 赞同：0
> 
> 时间：2012-07-08T11:50:08.447
> 
> 标签：css, html, overflow

当站点的内容大于窗口时（无论您将窗口设置多高，此规则都适用）。这是非常不受欢迎的行为，因为它看起来像 #@!*...

我对网页设计很陌生，所以我可能真的在我的 css 中犯了一些大错误.. 这是 css 文件，希望有人能指出.. （可能使用 height: 100% 不好，但不知道是什么否则做=/。

而且我知道内容和东西绝对是非常糟糕的。

这就是“错误”的样子，当内容大于窗口时在底部：http: [//i49.tinypic.com/1zqa9th.png](http://i49.tinypic.com/1zqa9th.png)

这是一个html骨架：

```
<!DOCTYPE html>
<html>
  <head>
    <?php 
    $title_tags = "TITLE HERE";
    $meta_description = "";
    include('generalhead.php'); ?>
  </head>

  <body>
    <div class="wrapper">
        <div class="sidebar">
                        <div class = "wrap1">
        <img src="media/images/blub.png" class="blub"><br>

        <div class="cloud">
        <img src="media/images/dots.gif">
        <img class="cloud_text" src="media/images/cloud.png">
        <img src="media/images/dots.gif">
        </div>

        <div class="menu">
            <ul id="nav" class="navig">
                <h3 class="big_link"><a href="index.php">home</a></h3>      
                <h3 class="big_link"><a href="contact.php">contact</a></h3>                 
                <h3>Algemene dakwerken</h3>
                <li><a href="epdm.php">Epdm</a></li>
                <li><a href="pannen.php">pannen</a></li>
                <li><a href="zink.php">zink</a></li>
                <li><a href="koper.php">koper</a></li>
                <li><a href="dakconstructie.php">dakconstructie</a></li>
                <li><a href="velux.php">velux steken</a></li>
                <li><a href="oversteking.php">uitbekleden oversteking</a></li>
                <h3>binnenhuisinrichting</h3>
                <li><a href="ramen_deuren.php">ramen en deuren</a></li>
                <li><a href="gyproc.php">gyproc</a></li>
                <li><a href="muren_plafonds.php">muren en plafonds</a></li>
            </ul>
        </div>
    </div>
    </div>
        </div>

        <div class="content">
            <div class="content-top">
                <div class="content-head">
                blub
                </div>

                <div class="content-body">
                    CONTENT TEXT COMES HERE, BELLOW THIS ARE THE CONTENT PICTURES
                </div>

                <div class="content-pictures">
                    <!-- Slider-->
                    <div class="slider-wrapper theme-default">

                        <div id="slider" class="nivoSlider">
                            <?php 
                                $directory_name = "index";
                                include ("generate_photo_content.php");
                            ?>
                        </div>

                    </div>
                </div>

            </div>

        </div>

    </div>

    <?php include ('bottomscripts.php'); ?>
  </body>
</html>​ 
```

CSS在这里

```
 body{
    /* FALLBACK KLEUR ALS GRADIENT NIET WERKT*/
    background-color: #1b1000;

    height: 100%;
    font-size: 100%
}

/*ROND ALLES EN ZORGT VOOR GRADIENT OP BACKGROUND*/
.wrapper{
    display:block;

    /*set the div in the top-left corner of the screen*/
    position:absolute;
    top:0;
    left:0;

    /*set the width and height to 100% of the screen*/
    width: 100%;
    height:100%;

    /* IE10 Consumer Preview */ 
    background-image: -ms-radial-gradient(left center, circle farthest-side, #4D2D0F 0%, #1B1000 50%, #1B1000 100%);

    /* Mozilla Firefox */ 
    background-image: -moz-radial-gradient(left center, circle farthest-side, #4D2D0F 0%, #1B1000 50%, #1B1000 100%);

    /* Opera */ 
    background-image: -o-radial-gradient(left center, circle farthest-side, #4D2D0F 0%, #1B1000 50%, #1B1000 100%);

    /* Webkit (Safari/Chrome 10) */ 
    background-image: -webkit-gradient(radial, left center, 0, left center, 973, color-stop(0, #4D2D0F), color-stop(0.5, #1B1000), color-stop(1, #1B1000));

    /* Webkit (Chrome 11+) */ 
    background-image: -webkit-radial-gradient(left center, circle farthest-side, #4D2D0F 0%, #1B1000 50%, #1B1000 100%);

    /* W3C Markup, IE10 Release Preview */ 
    background-image: radial-gradient(circle farthest-side at left center, #4D2D0F 0%, #1B1000 50%, #1B1000 100%);
}

.sidebar {
    z-index: 999;
    background-color: #ffcc00;
    /*background-image: url(../images/bar-8.png);*/
    background-repeat: no-repeat;
    background-image: url(../images/bar.jpg);
    background-repeat:repeat-y;
    -moz-box-shadow: 5px 0px 6px #000000;
    -webkit-box-shadow: 5px 0px 6px #000000;
    box-shadow: 5px 0px 6px #000000;
    width: 200px;
    height: 100%;
    float: left;
}

.wrap1{
    position: relative;
    top:15px;
    }

.logo{
    position: absolute;
    top: 0;
    left: 4px;
}

.blub{
    position: relative;
    float:left;
    width: 100%;
    margin: 0 0 10px 0;
}

.cloud{
    position: relative;
    float: left;
    width: 100%
}
.cloud_text{
    margin: 0 0 0 0;
}

.menu{
    line-height: 1;
    margin: 0 0 0 10px;
    position: relative;
    float: left;
    width: 100%
}

a {
    text-decoration: none;
}

ul {
    margin: 0;
    padding: 0;
    list-style: none;
}

.menu {
    width: 200px;
    margin: 10px auto;
    font-size: 0.8125em;
    text-transform: uppercase;
}

.navig{
    width: auto;
    height: auto;
}

.navig > li > a{
    border-bottom: 1px solid #c68f00;
    width: 100%;
    height: 1.5em;
    font-size: 0.8em;
    line-height: 1.5em;
    text-indent: 16px;
    display: block;
    position: relative;
    font-family: "Helvetica Neue", Helvetica, Areal, sans-serif;
    font-weight: 600;
    color: #603913;
    text-shadow: 0px 1px 0px rgba(0,0,0,0.5);
    -webkit-transition: all 1s linear;
}
.navig > h3{
    margin: 0 0 0 0;
    border-bottom: 2px solid #c68f00;
    width: 100%;
    height: 2.25em;
    line-height: 2.75em;
    text-indent: 10px;
    display: block;
    position: relative;
    font-family: "Helvetica Neue", Helvetica, Areal, sans-serif;
    font-weight: 600;
    color: #603913;
    text-shadow: 0px 1px 0px rgba(0,0,0,0.5);
}

.navig > li > a:hover,
.navig > li > a:active{
     background-color: #fdda01;
    background-image: -webkit-gradient(linear, left top, left bottom, from(rgb(252, 219, 0)),to(rgb(255,204,0)));
    background-image: -webkit-linear-gradient(top, rgb(252, 219, 0), rgb(255,204,0));
    background-image: -moz-linear-gradient(top, rgb(252, 219, 0), rgb(255,204,0));
    background-image: -o-linear-gradient(top, rgb(252, 219, 0), rgb(255,204,0));
    background-image: -ms-linear-gradient(top, rgb(252, 219, 0), rgb(255,204,0));
    background-image: linear-gradient(top, rgb(252, 219, 0), rgb(255,204,0));
    filter: progid:DXImageTransform.Microsoft.gradient(GradientType=0,StartColorStr='#45c7eb', EndColorStr='#2698db');
    border-bottom: 1px solid #886304;
}

.big_link > a {
    margin: 0 0 0 0;
    border-bottom: 2px solid #c68f00;
    width: 100%;
    height: 2.25em;
    line-height: 2.75em;
    text-indent: 10px;
    display: block;
    position: relative;
    color: #603913;
    text-shadow: 0px 1px 0px rgba(0,0,0,0.5);
}
.big_link> a:active,
.big_link > a:hover{
    background-color: #fdda01;
    background-image: -webkit-gradient(linear, left top, left bottom, from(rgb(252, 219, 0)),to(rgb(255,204,0)));
    background-image: -webkit-linear-gradient(top, rgb(252, 219, 0), rgb(255,204,0));
    background-image: -moz-linear-gradient(top, rgb(252, 219, 0), rgb(255,204,0));
    background-image: -o-linear-gradient(top, rgb(252, 219, 0), rgb(255,204,0));
    background-image: -ms-linear-gradient(top, rgb(252, 219, 0), rgb(255,204,0));
    background-image: linear-gradient(top, rgb(252, 219, 0), rgb(255,204,0));
    filter: progid:DXImageTransform.Microsoft.gradient(GradientType=0,StartColorStr='#45c7eb', EndColorStr='#2698db');
    border-bottom: 2px solid #886304;
}

.selected{
    background-color: #fdda01;
    background-image: -webkit-gradient(linear, left top, left bottom, from(rgb(252, 219, 0)),to(rgb(255,204,0)));
    background-image: -webkit-linear-gradient(top, rgb(252, 219, 0), rgb(255,204,0));
    background-image: -moz-linear-gradient(top, rgb(252, 219, 0), rgb(255,204,0));
    background-image: -o-linear-gradient(top, rgb(252, 219, 0), rgb(255,204,0));
    background-image: -ms-linear-gradient(top, rgb(252, 219, 0), rgb(255,204,0));
    background-image: linear-gradient(top, rgb(252, 219, 0), rgb(255,204,0));
    filter: progid:DXImageTransform.Microsoft.gradient(GradientType=0,StartColorStr='#45c7eb', EndColorStr='#2698db');
    border-bottom: 1px solid #886304;

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T19:01:14.037

## **简短的回答：**

这是您当前的 HTML 标记和 CSS 定义以及所要求的最终结果：

请参阅此工作[小提琴示例](http://jsfiddle.net/zuul/KP8c5/2/)！

![在此处输入图像描述](../Images/d8ea9f0a83d30cc035b8e16effe20586.png)

* * *

## **长答案**

您当前在问题上提供的代码包含几个标记问题：

1.  **无序列表 ( `UL`)的**子元素：****

     **请参阅[W3C - HTML 文档中的列表](http://www.w3.org/TR/html401/struct/lists.html)

    `<ul/>`元素只能`<li/>`作为一个孩子。目前，您正在与元素`<h3/>`混合放置。`<li/>`** 
***   **元素的**结束标签**`<div/>`：**

     ***   您正在使用**12 个**开始标签。

    *   您正在使用**13 个**结束标签。

    *   在您使标记按预期工作之后松开一个结束`div`声明。`ul`**** 

 ***** * *

## **关于您的侧边栏高度问题**

我尝试使用您提供的代码，但结构很混乱，无法使用纯 CSS 解决方案实现您的目标。

所以我反其道而行之，准备了所需的结构以将您的内容应用于它。这个[**Fiddle Example**](http://jsfiddle.net/zuul/KP8c5/)上的标记解决了您的问题。

**HTML MARKUP** ^(基本布局)

```
<div class="wrapper">
    <div class="sidebar">
        <ul>
            <li>Sidebar stuff.</li>
        </ul>
    </div>     
    <div class="content">
        CONTENT TEXT COMES HERE, BELLOW THIS ARE THE CONTENT PICTURES
        </div>
    <div class="clear"></div>
</div> 
```

**CSS** ^(准备布局的基础知识)

```
* {
    margin: 0;
    padding: 0;
}
.clear { clear: both; }
.wrapper {
    position: relative;
}
.sidebar {
    width: 200px;
    float: left;
    background-color: #ffcc00;
    position: absolute;
    top: 0;
    left: 0;
    bottom: 0;
}
.content {
    margin-left: 200px;
} 
```

*您所要做的就是应用此标记并用您的内容填充它。*

![在此处输入图像描述](../Images/4ed032da1f1c4e40c7e282bf6e8a51c5.png)****

# jquery - 将 CheckBoxList 标签的宽度设置为全宽（以允许行选择）

> ID：11382915
> 
> 赞同：-1
> 
> 时间：2012-07-08T11:50:21.440
> 
> 标签：jquery, asp.net, css, checkboxlist

这似乎是一个直截了当的问题，但我在这里（或通过谷歌）找不到具体答案。

我`CheckBoxList`在覆盖的 div 中有一个 APS.Net（模拟下拉选择列表）。

默认情况下，为 CheckBoxLIst 生成的 HTML 如下所示：

```
<table id="MainContent_DropDownCheckBoxList4_checkBoxList">
    <tbody><tr>
        <td><input type="checkbox" value="ALL" name="ctl00$MainContent$DropDownCheckBoxList4$checkBoxList$0" id="MainContent_DropDownCheckBoxList4_checkBoxList_0" class="dropdowncheck"><label for="MainContent_DropDownCheckBoxList4_checkBoxList_0" class="dropdownlabel">All</label></td>
    </tr><tr>
        <td><input type="checkbox" value="0" name="ctl00$MainContent$DropDownCheckBoxList4$checkBoxList$1" id="MainContent_DropDownCheckBoxList4_checkBoxList_1" class="dropdowncheck"><label for="MainContent_DropDownCheckBoxList4_checkBoxList_1" class="dropdownlabel">Item 0</label></td>
    </tr><tr>
        <td><input type="checkbox" value="1" name="ctl00$MainContent$DropDownCheckBoxList4$checkBoxList$2" id="MainContent_DropDownCheckBoxList4_checkBoxList_2" class="dropdowncheck"><label for="MainContent_DropDownCheckBoxList4_checkBoxList_2" class="dropdownlabel">Item 1</label></td>
    </tr><tr>
        <td><input type="checkbox" value="2" name="ctl00$MainContent$DropDownCheckBoxList4$checkBoxList$3" id="MainContent_DropDownCheckBoxList4_checkBoxList_3" class="dropdowncheck"><label for="MainContent_DropDownCheckBoxList4_checkBoxList_3" class="dropdownlabel">Item 2</label></td>
    </tr><tr>
        <td><input type="checkbox" value="3" name="ctl00$MainContent$DropDownCheckBoxList4$checkBoxList$4" id="MainContent_DropDownCheckBoxList4_checkBoxList_4" class="dropdowncheck"><label for="MainContent_DropDownCheckBoxList4_checkBoxList_4" class="dropdownlabel">Item 3</label></td>
    </tr>
</tbody></table> 
```

问题是各个标签只是其中文本的宽度，但我希望整行都是可选的。请注意，我的控件/表格具有固定宽度，因此您无需计算长度等。

我看到的所有解决方案都建议使用`display: block`或变体，但这会导致文本出现在复选框下方的行上，甚至设置为 90% 宽度以及不适用于所有浏览器。

**如何使标签占据该行的其余部分？**JQuery 答案是可以接受的（甚至更可取，因为控件已经大量使用 JQuery），但请发布适用于所有浏览器的解决方案。您可以从 HTML 中看到，我已经通过 JQuery`dropdowncheck`在复选框中添加了一个类，并`dropdownlabel`在标签中添加了一个类（如果这有助于给出特定的 CSS 答案）。

## 简单的解决方案（基于 Henrik 的回答）：

```
.dropdowncheck
{
    float: left;

.dropdownlabel
{
    display: block;
} 
```

只要复选框和标签具有分配的类（即通过 JQuery），就可以正常工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T12:16:15.523

如何将标签设置为 display:block 并给出复选框 float:left ？

如果文本没有按照您的意愿水平对齐，只需在复选框上设置高度并为标签提供相等的行高。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T12:56:32.980

即使通过纯 jQuery，您也可以获得您正在寻找的结果。受此启发，我做了 [这个](http://www.learningjquery.com/2008/12/quick-tip-click-table-row-to-trigger-a-checkbox-click)[例子](http://jsfiddle.net/zPQMu/1/)。我不得不删除标签标签，因为在这种方法之后它们的功能被弃用了。

```
$('td').click(function(event){

if (event.target.type !== 'checkbox') {
  $(':checkbox', this).trigger('click');

}

})​ 
```

用一些 css 来调味

```
td{
width: 200px;
background: orange;
border-bottom: 1px solid black;
cursor: pointer;
}​ 
```

# php - 使用 PHP 在 MVC 结构中清理 URL

> ID：11382916
> 
> 赞同：0
> 
> 时间：2012-07-08T11:50:36.250
> 
> 标签：php, arrays, model-view-controller, url

我正在使用 MVC 结构创建一个网站。下面是我用来使用干净 URL 并加载适当文件的代码。但是它只适用于第一级。

说我想参观`mywebsite.com/admin`它会起作用，但`mywebsite.com/admin/dashboard`不会。问题出在数组中，如何让数组在第二级和第二级之后加载内容。

最好创建一个这样的数组吗？

```
Array
     - controller
     - view
          - dashboard 
```

这里的任何帮助都会很棒。也作为一个附带问题。设置“自定义”网址的最佳方式是什么。因此，如果我要放入`mywebsite.com/announcement`它会检查它是否有控制器，如果失败，请检查它是否有自定义内容（可能是“customs”文件夹中的同名文件，然后如果没有，则执行 404页面未找到的东西）虽然这不是一个优先问题，但与代码的工作方式松散相关，所以我认为最好添加。

```
function hook() {
    $params = parse_params();
    $url = $_SERVER['REQUEST_URI'];
    $url = str_replace('?'.$_SERVER['QUERY_STRING'], '', $url);

    $urlArray = array();
    $urlArray = explode("/",$url);
    var_dump($urlArray);
    if (isset($urlArray[2]) & !empty($urlArray[2])) {
        $route['controller'] = $urlArray[2];
    } else {
        $route['controller'] = 'front'; // Default Action
    }
    if (isset($urlArray[3]) & !empty($urlArray[3])) {
        $route['view'] = $urlArray[3];
    } else {
        $route['view'] = 'index'; // Default Action
    }
    include(CONTROLLER_PATH.$route['controller'].'.php');
    include(VIEW_PATH.$route['controller'].DS.$route['view'].'.php');
    var_dump($route['controller']);
    var_dump($route['view']);
    var_dump($urlArray);
    var_dump($params);

    // reseting messages
    $_SESSION['flash']['notice'] = '';
    $_SESSION['flash']['warning'] = '';
}
// Return form array
function parse_params() {
    $params = array();
    if(!empty($_POST)) {
        $params = array_merge($params, $_POST);
    }
    if(!empty($_GET)) {
        $params = array_merge($params, $_GET);
    }
    return $params;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T13:30:51.400

你能澄清一下吗：“问题出在数组中，我怎样才能让数组在第二级和第二级之后加载内容。”

我不明白你想让这个东西如何工作。我检查了你的代码，它可以工作。也许你只需要用2`$urlArray[1]`代替`$urlArray[2]`3 代替？数组中的第一个元素位于索引 0 处。

通常它是这样完成的：

网址格式：

```
/controller/action/param1/param2/...

-controller- should be a class. That class has a method/function called -action-.

ex. /shoes/show/121/   --> this will load controller shoes 
                           and execute the method/function show(121)
                           that will show the shoes that have the id 121 in the
                           database.

ex. /shoes/list/sport  --> this will load controller shoes
                           and execute function list('sport') that will list all
                           shoes in the sport category. 
```

如您所见，您只加载一个控制器，并且从该控制器只运行一个函数，该函数将获取路径的其余部分并将其用作参数。

如果您想为一个 URL 设置多个控制器，则必须从主控制器加载其余控制器。大多数 MVC（如 CodeIgniter）每个 URL 只加载一个控制器。

**第二个问题：**

漂亮网址的最佳方法是将它们保存在数据库中。这意味着您可以拥有这样的 URL：

```
/I-can-write-anything-here-No-need-to-add-ids-or-controller-names 
```

然后您获取此 URL 并在 db 中搜索它并获取此 URL 所需的 -controller- 和 -action-。

但我还没有看到流行的 MVC 框架做到这一点。我猜原因是数据库会收到大量文本匹配查询，这会减慢速度。

流行的 MVC 框架使用：

```
/controller/action/param1/param2 
```

这样做的好处是您可以直接从 url 中找到控制器/操作。缺点是您将获得如下网址：

```
/shoes/list/sport 
//when what you really want is
/shoes/sport 
//or just
/sport //if the website only sells shoes 
```

这可以通过重定向`/shoes/sport`到`/shoes/list/sport`

如果您制作自己的 MVC，那么您应该使用 OOP，因为如果不这样做，事情会很快变得丑陋：所有操作/函数都在同一个命名空间中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T11:57:37.493

就个人而言，我建议您使用现有的众多 PHP 框架之一，因为它会为您处理路由并让您专注于编写应用程序。CakePHP 是我使用过一段时间的一个，它让我的生活变得如此轻松。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-08T11:58:07.943

我做什么：

我创建了一个 .htaccess 文件，它将像 www.example.com/url/path/or/something 这样的 URL 重定向到 www.example.com/index.php?url=url/path/or/something，所以它会很漂亮很容易在你的 $_GET['url'] 上做一个爆炸第二，它更好，因为用户输入的所有内容都将被重定向到你的 index.php，所以你可以完全控制一切。

如果你愿意，我可以将我的 mvc (bitbucket) 的 url 给你，这样你就可以看看我是如何做到的；)

（对不起其他人，但我不喜欢将网址公开发布到我的网站）

编辑：为了更准确地回答您的特定问题；它将解决您的问题，因为一切都转到 index.php 并且您可以完全控制请求的 url。

# regex - 相对路径正则表达式

> ID：11382919
> 
> 赞同：4
> 
> 时间：2012-07-08T11:50:42.680
> 
> 标签：regex

我们的 Web 应用程序允许用户指定他们自己的“slugs”，其中可以包括相对路径，例如 /somedir/some-file.htm。

在我们的路由配置中，我们需要确保仅支持有效的 slug（带段）。

我正在使用的正则表达式是：

```
(^[a-z0-9])([a-z0-9-/]+)([a-z0-9])$ 
```

这表示：

*   一个有效的 slug 将匹配例如 some-file.htm
*   带有段（相对路径）的有效 slug 将匹配例如 somedir/subdir/some-file.htm
*   绝对 URL 将不匹配，例如 /somedir/some-file.htm
*   尾随 / 或 - 将不匹配，例如 -slug-

不幸的是，这也意味着双斜杠将匹配例如 somedir//subdir//some-file.htm，因为我的表达式允许一个或多个斜杠。

如何更改它以允许段之间有零个或多个斜杠。

我以为：

```
(^[a-z0-9])(/?[a-z0-9-]+/?)([a-z0-9])$ 
```

会工作，但它不会。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-08T12:13:45.010

`^[a-z0-9]([a-z0-9-]*[a-z0-9])?(/[a-z0-9]([a-z0-9-]*[a-z0-9])?)*$`

编辑：如果您喜欢第一个正则表达式，请使用这个：

`^(?!-)[a-z0-9-]+(?<!-)(/(?!-)[a-z0-9-]+(?<!-))*$`

它看起来凌乱而复杂，但根据您的规范似乎是正确的。

`[a-z0-9]([a-z0-9-]*[a-z0-9])?`

匹配单个名称。暂时忽略`/`s。

然后剩下的就是一个斜线，后面跟着同样的东西。

正如 Karoly 的回答中提到的，这不包括文字句点，例如“some-file.htm”与我写的正则表达式不匹配。

如果这是所需的行为，那么您实际上会想要：

`^[a-z0-9]([a-z0-9-\.]*[a-z0-9])?(/[a-z0-9]([a-z0-9-\.]*[a-z0-9])?)*$`

最后，如果您只想在最后一节中允许文字句点，那么您将需要：

`^[a-z0-9]([a-z0-9-]*[a-z0-9])?(/[a-z0-9]([a-z0-9-]*[a-z0-9])?)*(/[a-z0-9]([a-z0-9-\.]*[a-z0-9])?)?$`

编辑：

一个想法是，这可以使用前瞻和后视来简化一点。

`^[a-z0-9]([a-z0-9-]*[a-z0-9])?(/[a-z0-9]([a-z0-9-]*[a-z0-9])?)*(/[a-z0-9]([a-z0-9-\.]*[a-z0-9])?)?$`

变成：

`^(?!-)[a-z0-9-]+(?<!-)(/(?!-)[a-z0-9-]+(?<!-))*(/(?!-\.)[a-z0-9-\.]+(?<!-\.))?$`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T11:59:38.423

```
(^[a-z0-9]+)(/[a-z0-9-]+)*([a-z0-9])$ 
```

注意：我`.`在您的正则表达式中看不到。

就我个人而言，我会分别测试第一个和最后一个字符，这使得正则表达式更简单、更有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-23T08:01:35.737

检查有效路径（相对或绝对。点用于隐藏文件夹）：
`^([a-z]:)*(\/*(\.*[a-z0-9]+\/)*(\.*[a-z0-9]+))`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-09-25T11:01:05.577

我的要求非常不同，所以我是在回答其他来这里寻找答案的人，而不是回答这里发布的确切问题和要求。

**我的要求：**

*   它需要匹配同一字符串中的多个路径
*   已知每条路径都以`./`或`../`
*   它不能使用look behinds，因为它们不受支持
*   众所周知，每条路径都会在新的一行
*   文件夹将始终使用单个`/`字符分隔。

这就是我想出的（基于 JS RegEx 语法）：

> **我的解决方案**
> 
> `/\.\.?\/[^\n"?:*<>|]+\.[A-z0-9]+/g`

我将以此为例进行解释：

> ../path/to/file.ext lorem ipsum 文本

*   `/..../g`表示正则表达式将在同一字符串内多次匹配
*   `\.\.?\/`同时匹配`../`和`./`

    > `/\.\.?\//g`
    > 
    > `../`path/to/file.ext lorem ipsum 文本

*   `[^\n"?:*<>|]+`是不匹配字符的黑名单。
    *   `[^....]`= 不匹配此字符列表。
    *   `\n`= 新行（路径永远不会出现在同一行）
    *   所有其他字符都是文字。它们是非法的文件名字符。

        > `/\.\.?\/[^\n"?:*<>|]+/g`
        > 
        > `../path/to/file.ext lorem ipsum text`

*   `\.[A-z0-9]+`是确保它在文件扩展名的末尾停止。

    > `/\.\.?\/[^\n"?:*<>|]+\.[A-z0-9]+/g`
    > 
    > `../path/to/file.ext`lorem ipsum 文本

# sip - 在 Tomcat Mobicents 上的邀请消息上自动检索 100

> ID：11382922
> 
> 赞同：1
> 
> 时间：2012-07-08T11:51:00.307
> 
> 标签：sip, jain-sip

我正在尝试对 MSS 2.00 (Sip Servlet) 上的呼叫转移 B2BUA 应用程序示例进行负载测试。我在 linux Redhat 2.6 上对 4 个 Tomcat 实例执行 80 Caps 我面临的问题是，一旦在 MSS 上收到 100 For the UAC 邀请，就不会立即发送，它只发送一个来自 UAS 的 100 返回它。

我设法在 JBOSS 上找到了一个使用以下配置标志的案例

[http://code.google.com/p/mobicents/source/browse/trunk/servers/sip-servlets/sip-servlets-test-suite/sipp-scenarios/performance/jboss-5-setup/mss-sip-堆栈-jboss.properties?r=14623](http://code.google.com/p/mobicents/source/browse/trunk/servers/sip-servlets/sip-servlets-test-suite/sipp-scenarios/performance/jboss-5-setup/mss-sip-stack-jboss.properties?r=14623)

它似乎是某种旧的错误修复

[http://code.google.com/p/mobicents/issues/detail?id=1689](http://code.google.com/p/mobicents/issues/detail?id=1689)

但是，我尝试将以下条目放入 mss-sip-stack.properties

```
org.mobicents.ext.java.sip.TRANSACTION_FACTORY=org.mobicents.ext.javax.sip.MobicentsTransactionFactory
org.mobicents.ext.java.sip.SIP_PROVIDER_FACTORY=org.mobicents.ext.javax.sip.MobicentsSipProviderFactory    
org.mobicents.ext.java.sip.SEND_TRYING_RIGHT_AWAY=true 
```

但它没有改变

我试图深入研究代码并发现了这一点：

该标志在以下接口中定义

SipStackExtension

以及其他工厂

然而，唯一可用的实现是抽象类 ClusteredSipStackImpl

那么我应该怎么做才能在上面的配置中启用这个标志呢？

我在一个amd64刀片（12核）上进行了测试，我尝试了32位和64位，结果是一样的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T07:47:12.200

该标志在 Tomcat 上不可用，只有 JBoss 可用，现在已在[http://code.google.com/p/sipservlets/issues/detail?id=138](http://code.google.com/p/sipservlets/issues/detail?id=138)中修复，并将在我们的下一个版本 2.0.0.FINAL 中可用

谢谢让

# sql - $PARTITION 的好处？

> ID：11382926
> 
> 赞同：0
> 
> 时间：2012-07-08T11:51:21.007
> 
> 标签：sql, database, sql-server-2008

我不清楚`$PARTITION`在 SQL Server 中使用的目的？我已经阅读了 MSDN 的内容，但仍然不明白。

你可以使用它有什么好处？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T12:46:38.403

您可以使用此函数来确定将用于某个值的分区号。例如，对于按日期分区的表，这将告诉您哪个分区将用于 2001 年 7 月 1 日，甚至在您将值插入表之前：

```
SELECT $PARTITION.PF_RangeByYear('20010701') 
```

您还可以使用它来查找每个分区号中的行数：

```
SELECT $partition.PF_RangeByYear(orderdate) AS partition#,
  COUNT(*) AS cnt
FROM Orders
GROUP BY $partition.PF_RangeByYear(orderdate); 
```

可以说你可以从[`sys.partitions`](http://msdn.microsoft.com/en-us/library/ms175012.aspx)or做更简单的事情[`sys.dm_db_partition_stats`](http://msdn.microsoft.com/en-us/library/ms187737.aspx)。

（这两个例子都取自[Itzik 的 SQL Mag 文章](http://www.sqlmag.com/article/tsql3/partitioned-indexes-and-querying-metadata)。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T12:46:47.497

对数据库中的表进行分区意味着将其拆分为多个部分，同时仍将其视为单个表。我们在这里讨论的是水平分区，这意味着每个分区包含所有列，但只包含一些行。为此，您必须定义一个分区函数，该函数根据分区列中该行的值定义该行所属的分区。`$PARTITION`告诉你一行属于哪个分区。

假设我们有一个整数列来表示我们的行的评分，并且我们希望用户通常只会询问评分高于 4 的项目。我们可以根据评分进行分区。我们的分区函数可以是：

```
CREATE PARTITION FUNCTION partitionByRating (int) FOR VALUES (4); 
```

然后，要找出我们表的行属于哪个分区，我们可以查询：

```
SELECT $partition.partitionByRating(i.Rating) AS [Partition Number],
    rating AS [Rating],
    name AS [Item Name]
FROM dbo.Items AS i 
```

我们可能会得到如下结果：

```
Partition    Rating    Item Name
1            1         Ball
1            4         Scooter
2            5         Blaster 
```

这意味着 Ball 和 Scooter 将存储在一起，但根据您将分区分配给存储的方式，Blaster 可能存储在其他地方。

# python - 使用 lxml 解析 xml 时出现异常

> ID：11382932
> 
> 赞同：0
> 
> 时间：2012-07-08T11:51:48.017
> 
> 标签：python, xml, xml-parsing, lxml

我编写了这段代码来通过 xsd 验证我的 xml 文件

```
def parseAndObjectifyXml(xmlPath, xsdPath):
    from lxml import  etree

    xsdFile = open(xsdPath)
    schema = etree.XMLSchema(file=xsdFile)
    xmlinput = open(xmlPath)
    xmlContent = xmlinput.read()
    myxml = etree.parse(xmlinput) # In this line xml input is empty
    schema.assertValid(myxml) 
```

但是当我想验证它时，我的 xmlinput 是空的，但我的 xmlContent 不是空的。问题是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-08T11:55:38.273

python中的文件有一个“当前位置”；它从文件的开头（位置 0）开始，然后，当您读取文件时，当前位置指针会一直移动，直到它到达末尾。

您需要将该指针放回开头，然后 lxml 解析器才能完整读取内容。使用以下[`.seek()`方法](http://docs.python.org/library/stdtypes.html#file.seek)：

```
from lxml import  etree

def parseAndObjectifyXml(xmlPath, xsdPath):
    xsdFile = open(xsdPath)
    schema = etree.XMLSchema(file=xsdFile)
    xmlinput = open(xmlPath)
    xmlContent = xmlinput.read()
    xmlinput.seek(0)
    myxml = etree.parse(xmlinput)
    schema.assertValid(myxml) 
```

`xmlContent`仅当您也需要其他地方时才需要这样做；`.parse()`如果包装在对象中，您也可以将其传递给方法`StringIO`以提供必要的文件对象方法：

```
from lxml import  etree
from cStringIO import StringIO

def parseAndObjectifyXml(xmlPath, xsdPath):
    xsdFile = open(xsdPath)
    schema = etree.XMLSchema(file=xsdFile)
    xmlinput = open(xmlPath)
    xmlContent = xmlinput.read()
    myxml = etree.parse(StringIO(xmlContent))
    schema.assertValid(myxml) 
```

如果你*不*使用`xmlContent`其他任何东西，那么你也不需要额外的`.read()`调用，随后用 lxml 解析它不会有问题；只需完全省略调用，您也不需要将当前位置指针移回起点：

```
from lxml import  etree

def parseAndObjectifyXml(xmlPath, xsdPath):
    xsdFile = open(xsdPath)
    schema = etree.XMLSchema(file=xsdFile)
    xmlinput = open(xmlPath)
    myxml = etree.parse(xmlinput)
    schema.assertValid(myxml) 
```

要了解有关`.seek()`（及其对应的`.tell()`）的更多信息，[请阅读 Python 教程中的文件对象](http://docs.python.org/tutorial/inputoutput.html#methods-of-file-objects)。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-08T11:54:13.923

您应该使用已阅读的 XML 内容：

```
xmlContent = xmlinput.read()
myxml = etree.parse(xmlContent) 
```

代替：

```
myxml = etree.parse(xmlinput) 
```

# ajax - Ajax Bootstrap 弹出框：对象# has no method 'popover' I'm trying to build an Ajax Bootstrap Popover to display a page that contains a rating star system. The javascript here work nice the first time. Then I have this error: 问问题 问问题 2012-07-08T11:52:17.923 10831 次 This question shows research effort; it is useful and clear 10 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. I'm trying to build an Ajax Bootstrap Popover to display a page that contains a rating star system. The javascript here work nice the first time. Then I have this error: Uncaught TypeError: Object # has no method 'popover' I'm not really good in jQuery, but I guess it seems to be due to the ajax call, but I can't find where the problem is. $(".myRate") .popover({ offset: 10, trigger: 'manual', animate: false, html: true, placement: 'top', template: '' }); $('.myRate').mouseenter(popoverDisplay); popoverDisplay = function() { var el = $(this); var _data = el.attr('alt'); $.ajax({ type: 'GET', url: 'notes.php', data: _data, cache: false, dataType: 'html', success: function(data) { el.attr('data-content', data); el.popover('show'); } }); } I don't get what I am doing wrong... Any idea ? EDIT: After searching, it seems that, it's the loaded pages which causes this error. Exactly this part: It seems that loading jquery-1.7.2.js make the bug because if I remove it, the error disapear. Problem: I can't delete it because without it jRating doesn't work anymore :/ You can either use boostrap.js or (bootstrap-popover.js and bootstrap-tooltip.js) But not both because if you use both. You get Uncaught TypeError: Object # has no method 'popover' ajaxtwitter-bootstrappopover 4 6 回答 6 This answer is useful 23 I had this problem after running the rails twitter bootstrap generator, then switching to bootstrap-sass. It was caused by a filename collision because boostrap-sass references bootstrap.js instead of twitter/bootstrap, which clashes with the generated file. Just rename the generated app/assets/javascripts/bootstrap.js.coffee to something else, eg app/assets/javascripts/bootstrap_and_overrides.js.coffee, and you're good to go. 于 2013-04-09T11:10:47.160 回答 This answer is useful 7 I had this problem because i was trying to use the jQuery from bootstrap while also importing jQuery from googleapis (like it says in http://railscasts.com/episodes/205-unobtrusive-javascript) if you're using bootstrap, you'll have jquery 于 2012-09-04T00:47:38.457 回答 This answer is useful 2 i had the same problem . you might be loading jquery AFTER loading bootstrap.js . for some reason the sequence is important    loading jquery before bootstrap did the job for me . hope that helps 于 2013-02-23T01:06:34.777 回答 This answer is useful 2 I had the same problem. I was loading jQuery.js twice... Narf... 于 2013-05-24T01:23:45.527 回答 This answer is useful 0 I guess you're using rails, so it might come that assets/vendor/jquery is loaded after assets/vendor/bootstrap, because the load order is alphabetical. So you might rename the bootstrap file to fit the right loading order. I experienced that problem and it did the trick 于 2013-10-17T23:17:07.510 回答 This answer is useful 0 You can either use boostrap.js or (bootstrap-popover.js and bootstrap-tooltip.js) But not both because if you use both. You get Uncaught TypeError: Object # has no method 'popover' 于 2012-07-09T14:10:02.477 回答 Related 2 rss - EXT： RSS提要中的tt_news 1 python - Python 字典键作为一组数字 1 prolog - 使用 =.. 谓词在 Prolog 中执行 furmulas 的符号操作 2 java - 错误代码 500 的 Tomcat 7 中的自定义错误页面 3 host - 提供商托管的应用程序的 SharePoint 2013 未经授权的异常 2 macos - 挂载命令在 10.7.5 上失败 1 sql - 如何在solidDB中使用to_char 1 github - 如何将问题放到“问题”条目已关闭的存储库中？ 1 c# - 通过代码添加应用程序监听器 3 java - 在德国打发时间 - Android Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：11382935
> 
> 赞同：10
> 
> 时间：
> 
> 标签：ajax, twitter-bootstrap, popover

I'm trying to build an Ajax Bootstrap Popover to display a page that contains a rating star system.

The javascript here work nice the first time. Then I have this error:

> Uncaught TypeError: Object # has no method 'popover'

I'm not really good in jQuery, but I guess it seems to be due to the ajax call, but I can't find where the problem is.

```
$(".myRate")
        .popover({
            offset: 10,
            trigger: 'manual',
            animate: false,
            html: true,
            placement: 'top',
            template: '<div class="popover" onmouseover="$(this).mouseleave(function()  {$(this).hide(); });"><div class="arrow"></div><div class="popover-inner"><h3 class="popover-title"></h3><div class="popover-content"><p></p></div></div></div>'

        });
$('.myRate').mouseenter(popoverDisplay);

popoverDisplay = function() {
var el = $(this);
var _data = el.attr('alt');
$.ajax({
     type: 'GET',
     url: 'notes.php',
     data: _data,
     cache: false,
     dataType: 'html',
     success: function(data) {
        el.attr('data-content', data);
        el.popover('show');
     }
  });
} 
```

I don't get what I am doing wrong... Any idea ?

**EDIT:**

After searching, it seems that, it's the loaded pages which causes this error.

Exactly this part:

It seems that loading jquery-1.7.2.js make the bug because if I remove it, the error disapear. Problem: I can't delete it because without it jRating doesn't work anymore :/

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-04-09T11:10:47.160

I had this problem after running the rails twitter bootstrap generator, then switching to bootstrap-sass.

It was caused by a filename collision because boostrap-sass references bootstrap.js instead of twitter/bootstrap, which clashes with the generated file.

Just rename the generated app/assets/javascripts/bootstrap.js.coffee to something else, eg app/assets/javascripts/bootstrap_and_overrides.js.coffee, and you're good to go.

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-04T00:47:38.457

I had this problem because i was trying to use the jQuery from bootstrap while also importing jQuery from googleapis (like it says in [http://railscasts.com/episodes/205-unobtrusive-javascript](http://railscasts.com/episodes/205-unobtrusive-javascript)) if you're using bootstrap, you'll have jquery

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-23T01:06:34.777

i had the same problem . you might be loading jquery AFTER loading bootstrap.js . for some reason the sequence is important

```
</footer>
<script src="<?php echo "http://".$_SERVER['HTTP_HOST']. $_SERVER['REQUEST_URI']."assets/bootstrap/js/jquery-1.7.1.min.js" ;?>"></script>   
<script src="<?php echo "http://".$_SERVER['HTTP_HOST']. $_SERVER['REQUEST_URI']."assets/bootstrap/js/bootstrap.js" ;?>"></script>
<script type="text/javascript">
$(document).ready(function(){
    create_project_form=$('form#create_project_form');
    $('button#create_project_button').popover({title:'New Project',content:create_project_form});
});
</script>
</body>
</html> 
```

loading jquery before bootstrap did the job for me . hope that helps

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-05-24T01:23:45.527

I had the same problem. I was loading jQuery.js twice... Narf...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-10-17T23:17:07.510

I guess you're using `rails`, so it might come that `assets/vendor/jquery` is loaded after `assets/vendor/bootstrap`, because the load order is alphabetical. So you might rename the `bootstrap` file to fit the right loading order. I experienced that problem and it did the trick

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-09T14:10:02.477

You can either use boostrap.js or (bootstrap-popover.js and bootstrap-tooltip.js)

But not both because if you use both. You get `Uncaught TypeError: Object # has no method 'popover'`

# objective-c - 自定义 UITableViewRowAnimation 或持续时间

> ID：11382936
> 
> 赞同：2
> 
> 时间：2012-07-08T11:52:18.813
> 
> 标签：objective-c, ios, animation

我有一个应用程序，用户可以在其中`UITableViewCells`从一个拖动`TableView`到另一个。我通过在用户触摸的 UITableViewCell 顶部渲染一个“虚拟”单元格来做到这一点，并禁用“真实”单元格。然后我在目标中插入一个新行`UITableView`，在我为虚拟单元格设置动画之后，将插入新单元格的位置。这可以按我的意愿工作。但反过来，给我带来了很多问题。

当我双击目标 UITableView 中的一个单元格时，该单元格应该动画回到最初从中拖动它的源 UITableView。问题是我无法`UITableView`足够快地从目的地移除单元格。

我希望它立即消失，这样当我在它上面渲染一个虚拟单元格时，我不会看到同一个单元格的 2 个不同的动画。（虚拟单元移动到源`UITableView`的那个，以及实际单元从目标中移除的那个`UITableView`）。

A`reloadData`上`UITableView`还不够好，因为我仍然希望剩余的单元格在现在的空白空间上拉到一起，并带有动画。

那么，我可以以某种方式创建自定义动画，或者将持续时间设置`UITableViewRowAnimation`为零吗？`UITableViewRowAnimationNone`没有为我做任何事情。

哦，可能很重要的一点是，该应用程序不会在 App Store 上架，所以我不在乎我是否必须做一些 Apple 不会批准的事情。

# c# - 根据文本大小的边框高度

> ID：11382938
> 
> 赞同：0
> 
> 时间：2012-07-08T11:52:31.213
> 
> 标签：c#, xaml, microsoft-metro, windows-runtime, winrt-xaml

我正在使用 XAML 和 C# 开发 Metroapp，并且我正在使用本地化，其中文本将是动态的并且因语言而异。我的代码结构如下-Border 内的TextBlock。

```
<Border>
      <TextBlock Text="Foo">
      </TextBlock>
</Border> 
```

那么有没有什么办法可以根据文字的大小来改变Border或者TextBlock的高宽呢？

请帮我。提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T06:31:33.670

这样做：（快速测试，应该可以）

```
 <Border BorderBrush="AliceBlue" Background="SlateBlue" Width="{Binding ElementName=tb, Path=ActualWidth}" Height="{Binding ElementName=tb, Path=ActualHeight}">
                         <TextBlock FontSize="45" Name="tb" Text="12345" Foreground="AliceBlue"/>
                    </Border> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T13:39:12.973

检查继承类的类的`ActualHeight`and`ActualWidth`属性。`FrameworkElement``TextBlock`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-09T04:08:14.153

将它包裹在里面`StackPanel`应该可以工作。

# android - android数组、字符串、整数、列表、视图和完全混淆

> ID：11382940
> 
> 赞同：-1
> 
> 时间：2012-07-08T11:52:43.660
> 
> 标签：android, arrays, string, int, seekbar

应用程序有 16 个搜索栏，应用程序希望能够将它们的所有值保存到一个新数组中，并在微调器（项目）中引用/添加数组。然后应用程序希望能够从微调器中选择这些数组之一，并从中设置搜索栏进度 seekbar.setprogress(arrayitem)。

头脑中的眼睛在这里阅读了很多帖子，但找不到适合我的需求或真正从哪里开始的东西。什么是最简单和最有效的方法？

```
private SeekBar seekBar1, seekBar2, seekBar3, seekBar4, seekBar5, seekBar6, seekBar7, seekBar8, seekBar9, seekBar10, seekBar11, seekBar12, seekBar13, seekBar14, seekBar15, seekBar16;
private Button saveButton;
private Spinner spinner; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T12:09:55.017

```
private SeekBar seekBar1, seekBar2, seekBar3, seekBar4, seekBar5, seekBar6, seekBar7, seekBar8, seekBar9, seekBar10, seekBar11, seekBar12, seekBar13, seekBar14, seekBar15, seekBar16; 
```

是一个非常糟糕的做法。

改为使用`private SeekBar seekBar[16]`。

初始化（在您的活动的 onCreate 中）：

```
for(int nIndex=0; nIndex<16; nIndex++)
{
    seekBar[nIndex] = findViewById(Integer.getInteger("R.id.seekBar" + (nIndex+1)); // assuming that u've declared 16 seekbars in ur layout XML named seekBar1 ... to ... seekBar16
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T12:14:33.090

1.创建一个二维数组（以 16 个整数作为列，允许的最大模式数作为行）和 16 个搜索栏。

2.调用`onProgressChanged()`每个微调器并有一个静态值来计算更改的数量并相应地存储该值（例如：如果 onProgressChanged() 用于第二个搜索栏并且计数为 3，则将值存储在数组 [1] [2])。

3.使用以下代码进入 aspinner

```
Spinner spinner = (Spinner) findViewById(R.id.spinner);
ArrayAdapter<CharSequence> adapter = ArrayAdapter.createFromResource(this,
        R.id.thearray, android.R.layout.simple_spinner_item);
adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
spinner.setAdapter(adapter); 
```

4.使用foll。将所选值放入搜索栏的代码

```
 for(i=0;i<16;i++){
        public void onItemSelected(AdapterView<?> parent, View view, 
                    int pos, long id) {

                  seekbar.setprogress(thearray[pos][i]);
            }
        } 
```

# php - PHP 中的 Pagelet

> ID：11382944
> 
> 赞同：1
> 
> 时间：2012-07-08T11:53:50.200
> 
> 标签：php, facebook

有没有办法像 Facebook 那样使用 PHP 来实现“pagelets”概念？从他们的[博客文章中](http://www.facebook.com/note.php?note_id=389414033919)：

> BigPipe 是对动态网页服务系统的基本重新设计。总体思路是将网页分解为称为 pagelet 的小块，并通过 Web 服务器和浏览器内的多个执行阶段对它们进行管道传输。这类似于大多数现代微处理器执行的流水线操作：多条指令通过处理器的不同执行单元流水线化，以实现最佳性能。尽管 BigPipe 是对现有 Web 服务流程的基本重新设计，但它不需要更改现有的 Web 浏览器或服务器；它完全用 PHP 和 JavaScript 实现。

Facebook主页中的小页面；每个矩形对应一个 pagelet：

![Facebook 主页中的 Pagelets。 每个矩形对应一个pagelet。](../Images/5492cf3d78e1397d84296ef71155812f.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T11:56:04.303

> 有没有办法使用 PHP 实现 pagelets 概念

不，它几乎与服务器端 (PHP) 没有任何关系。

这是在客户端（浏览器）上的 Javascript 中完成的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T12:06:37.963

看来 FB 指的是`the widget problem`MVC 设计中所谓的。所以这肯定会出现在后端，但问题是非常开放的，无法回答。

我想说去看看一些允许你这样做的 HMVC 框架。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-08T11:56:22.403

pagelet 的概念与 PHP 完全无关，但是您可以在 PHP 中制作 3D 图形，当然有一种方法可以在 PHP 中实现这样的概念。

当您使用它时，我还建议在 PHP 中实现用户代理，这样您就可以完全在 PHP 中开发一个跨客户端-服务器-平台-pagelet 实现。

* * *

您可能正在寻找所谓的*EDGE Side Includes ，您可以在**Symfony2*框架中找到一个 PHP 实现。这还需要一个服务器组件，例如*Varnish* 或*Squid*。

# html - 如何使背景透明并在div的左右部分创建三角形？

> ID：11382945
> 
> 赞同：2
> 
> 时间：2012-07-08T11:53:51.177
> 
> 标签：html, css

我想要实现的位于此处：[http:](http://www.ppp-templates.de/tilability/) //www.ppp-templates.de/tilability/ ..您会在滑块附近看到左右三角形，箭头应该在哪里......

现在我在这里设置了那个 div，白色背景[http://teothemes.com/wp/](http://teothemes.com/wp/)。在那个网站上使用了背景图片，但我想通过 CSS 来做

这里有一些相关的东西，对于页脚三角形：[在带有白色 bg 图像的 div 上制作一个具有透明背景的 CSS 三角形？](https://stackoverflow.com/questions/11379085/make-a-css-triangle-with-transparent-background-on-a-div-with-white-bg-image)

我试图做同样的事情，但它没有奏效..

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T13:19:29.747

您可以做的第一件事是创建两个背景与网站背景相同的正方形，然后`45deg`使用`transform: rotate(45deg)`供应商前缀旋转它们。然后只需将内容 div 设置`overflow`为`hidden`.

我刚刚创建的类似这样的东西：http: [//cssdeck.com/labs/hggee4eg](http://cssdeck.com/labs/hggee4eg)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T13:37:49.213

在这里解释这个过程被证明是相当困难的，所以我创建了一个小提琴，它完成了实现这一目标所需的每个步骤，每个步骤都有一个小图例。

这是小提琴 - [http://jsfiddle.net/NXmge/3/](http://jsfiddle.net/NXmge/3/)

**编辑** - 我误解了这个问题。这是解决实际问题的方法：http: [//jsfiddle.net/joplomacedo/UJyAY/](http://jsfiddle.net/joplomacedo/UJyAY/)

前一个小提琴仍然有用，因为它有助于理解我在第二个小提琴上做了什么。我也会尽快更新我的答案，因为我可以直接包含对我所做的事情的一般解释。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-08T14:36:18.267

根据您希望实现的跨浏览器兼容性，有几个不同的 CSS3 类型选项可以让您将元素旋转 45 度。

但是，您链接到的示例仅使用了一个带有图形的大型背景图像：除了将其设置为容器背景之外，CSS 没有任何实现。

# mysql - MySQL复杂嵌套查询创建视图

> ID：11382946
> 
> 赞同：1
> 
> 时间：2012-07-08T11:54:09.747
> 
> 标签：mysql, view, nested-query

我想从这样的表中创建一个视图：

```
Configuration |   Size  | Runtime    
0             |    10   |  32.5    
1             |    10   |  30.8   
2             |    10   |  40.1    
0             |    20   |  61.0   
1             |    20   |  65.3   
2             |    20   |  56.8 
```

其中配置编号 0 是特殊的（它是默认配置）并且存在于每组“大小”值中。我的目标是创建这样的视图：

```
Configuration |   Size  | Speedup
0             |    10   |  1.0
1             |    10   |  1.05
2             |    10   |  0.81
0             |    20   |  1.0
1             |    20   |  0.93
2             |    20   |  1.07 
```

对于具有相同大小的每组行，我想找到默认配置（由数字 0 标识），然后计算所考虑行的运行时间与默认运行时间之间的比率。

这可以分为两个查询：

1.  查找给定“大小”的默认运行时
2.  执行运行时和默认值之间的比率。

问题是在查询号 1（应该是查询 2 的 select 语句中的子查询）中，我不知道我目前正在考虑哪个“大小”。我希望你明白我的意思。

我有办法解决这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T11:58:10.487

```
SELECT Configuration, Size, default.Runtime / t.Runtime AS Speedup FROM t JOIN (
  SELECT Size, Runtime FROM t WHERE Configuration = 0
) `default` USING (Size) 
```

在[sqlfiddle](http://www.sqlfiddle.com/#!2/fe3bb/1/0)上查看。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-08T11:59:11.363

您可以使用的另一种方法是子选择：

```
CREATE VIEW yourview AS
SELECT
    Configuration,
    Size,
    (SELECT Runtime
     FROM yourtable AS T2
     WHERE T1.Size = T2.Size
     AND T2.Configuration = 0) / Runtime AS SpeedUp
FROM yourtable AS T1 
```

在线查看它：[sqlfiddle](http://sqlfiddle.com/#!2/988c3/1)

# perl - 在 Perl 中，如何解析日期字符串并从它表示的日期中减去天数？

> ID：11382947
> 
> 赞同：2
> 
> 时间：2012-07-08T11:54:10.150
> 
> 标签：perl, datetime

我在字符串中有一个日期，如`$str1="20120704"`. 我想从该日期减去 1 天，并将日期的值作为字符串存储在`$str2`. 我该怎么做？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-08T15:12:22.453

这与您几天前提出的另一个问题非常相似。因此，不出所料，解决方案也非常相似。

Time::Piece 和 Time::Seconds 自 5.10.0 版以来一直是标准 Perl 发行版的一部分。你应该使用它们。

```
#!/usr/bin/perl

use strict;
use warnings;
use 5.010;

use Time::Piece;
use Time::Seconds;

my $format = '%Y%m%d';
my $str1 = '20120704';

my $dt1 = Time::Piece->strptime($str1, $format);
my $dt2 = $dt1 - ONE_DAY;
my $str2 = $dt2->strftime($format);
say $str2; 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-07-08T17:41:52.763

Perl 以易于操作的内部格式存储日期和时间。您所拥有的是 YYYYMMDD 格式的日期。所以，你需要做的是：

1.  将您的日期（格式为 YYYYMMDD）转换为 Perl 的日期/时间存储格式。
2.  使用 Perl 来操作这个日期和时间。
3.  当您想要输出结果时，您必须将其转换回您想要的格式。

### 将您的日期（格式为 YYYYMMDD）转换为 Perl 的日期/时间存储格式。

执行此操作的最佳模块是Perl 附带的[Time::Piece 。](http://perldoc.perl.org/Time/Piece.html)这很简单：

```
my $date = Time::Piece->strptime($str1, '%Y%m%d'); 
```

`$date`现在将是您的日期和时间，但以 Perl 可以理解和操作的格式存储。这`%Y%m%d`是对格式的描述，因此 Perl 知道在哪里可以找到年月日。您可以查看[strftime](http://www.unix.com/man-page/FreeBSD/3/strftime/)以查看各种格式参数。在你的情况下：

*   `%Y`- 表示带有世纪的年份，如`2012`.
*   `%m`- 将月份表示为两位数，例如`03`或`12`。
*   `%d`-如果一个月中有那么多天，则将月份的日期表示为从`01`to的两位数。`31`

### 下一步：操纵你的日期。

您可以使用另一个名为[Time::Seconds](http://perldoc.perl.org/Time/Seconds.html)的模块来为您解决这个问题。

`Time::Seconds`定义了一堆常量，比如`ONE_DAY`让事情变得更容易：

```
 my $date = $date - ONE_DAY; 
```

### 最后：将日期转换回您想要的格式。

同样，`Time::Piece`有一个漂亮、简单的方法可以为您做到这一点：

```
$date->ymd(""); 
```

这将转换`$date`为年-月-日格式的字符串。默认情况下，这将`-`在每个部分之间放置一个。但是，您可以将要用作分隔符的字符传递给它。在这种情况下，什么都没有。

全部一起：

```
use Time::Piece   # For manipulating and storing the date
use Time::Seconds # For the nice constants such as ONE_DAY and ONE_WEEK

my $date = Time::Piece->strptime($str1, '%Y%m%d');
my $date = $date - ONE_DAY;
my $str2 = $date->ymd(''); 
```

这很简单。

* * *

[戴夫克罗斯](https://stackoverflow.com/a/11384156/368630)给了你一个很好的答案。我通常只是投他一票，然后就这样。不过，他也提到你前几天问了一个类似的问题。对我来说，这意味着您可能使用过 Dave Cross 之前的答案，但您并不理解它。这不好。

查看[Time::Piece](http://perldoc.perl.org/Time/Piece.html)和[Time::Seconds](http://perldoc.perl.org/Time/Seconds.html)的文档。看看[strfdate](http://www.unix.com/man-page/FreeBSD/3/strftime/)并玩弄它。学习它并理解它。如果您对这些有任何疑问，请在 Stackoverflow 上提问。Stackoverflow 上的人们更乐于回答诸如“这是如何工作的？”之类的问题。而不是“你能为我做这件事吗？”。他们会花时间和精力来解释第一个，而大多数人要么忽略后者，要么给你一个粗略的答案。

这将使您成为更好的程序员，这意味着您对公司更有价值，并转化为更高的薪水。值得您花时间和精力。

试着理解它。玩弄它。

* * *

### 附录

> 正在使用较旧的 perl 版本 5.8，并考虑使用系统中的现有模块。也不确定 time::piece 是如何工作的

这是一个相当老的 Perl 版本，但在 Solaris 上很常见。

在这种情况下，我们将采用非常古老的方式。

有两个 Perl 函数称为[localtime](http://perldoc.perl.org/functions/localtime.html)和[gmtime](http://perldoc.perl.org/functions/gmtime.html)。这些取自 1970 年 1 月 1 日以来的秒数，并将其转换为一个值数组，每个值代表时间的特定部分（月、年、日、小时、分钟等）。

您需要的是反函数——它可以获取一组值并将其转换为自 1970 年以来的秒数。从 Perl 3.0 开始，每个版本的 Perl 中都包含了这样一个模块。在 Perl 5.x 中，tt 称为[Time::Local](http://perldoc.perl.org/Time/Local.html)。它为您提供了两个称为`timelocal`和的函数`timegm`。这些是我们需要的反函数。

首先，我们需要将您的字符串拆分为单独的年、月和日，将其放入一个数组中，`timegm`或者`timelocal`转换为自 1970 年 1 月 1 日以来的秒数。

接下来，我们将减去一天中的秒数。这是 60 * 60 * 24 或 86,400。

最后，我们将该新*日期*转换为一个数组，您可以使用该数组以 YYYYMMDD 顺序显示日期。

两个重要的警告！

*   该函数假定月份是从 0 到 11 而不是 1 到 12。这允许您创建一个数组以将月份编号转换为名称。这意味着我们必须在给它之前的月份减去 1，`gmtime`并在取回它时加上 1 `timegm`。
*   年份是自 1900 年以来的年数。这意味着我们必须在将 1900 给 给 之前减去 1900，`gmtime`从 取回时加上 1900 `timegm`。

而且，现在的程序：

```
#! /usr/bin/env perl

use strict;
use warnings;

use Time::Local;

my $date = 20120615;    #2012-June-15

$date =~ /(....)(..)(..)/;  #Parse the date

my $year = $1;
my $month = $2;
my $day = $3;

$month -= 1;    #Month is 0 to 11 and not 1 to 12
$year -= 1900;  #Year is number of years since 1900

my $seconds = 0;
my $minutes = 0;
my $hours = 0;

my $perl_date = timegm($seconds, $minutes, $hours, $day, $month, $year);

my $perl_date2 = $perl_date - (60 * 60 *24);

my ($seconds2, $minutes2, $hours2, $day2, $month2, $year2)  = gmtime($perl_date2);

$month2 += 1;   #Month is returned as 0 - 11\. Make 1 - 12
$year2 += 1900; #Year is given as years since 1900\. Add 1900 back to it. 

printf qq(The date is %04d-%02d-%02d \n), $year2, $month2, $day2; 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-07-08T12:01:55.870

我建议你使用模块`DateTime`和一个分机作为格式。您还可以查看模块`Date::Calc`或`Date::Parse`+`POSIX`函数 strftime。

```
use strict;
use DateTime;
use DateTime::Format::Strptime;

my $date_str = '20120704';
my $date_obj = DateTime::Format::Strptime->parse_datetime($date_str);

my $date_res = $date_obj->subtract(days => 1)->ymd; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-08T14:11:16.687

这是一个简单的`strptime`/`strftime`往返。由于`strftime`规范化输入，只需从 mday 字段中减去 1。

```
use POSIX 'strftime';
use POSIX::strptime 'strptime';

my $fmt = "%Y%m%d";
my @t = strptime "20120704", $fmt;
$t[3] -= 1;  # 1 day
my $str2 = strftime $fmt, @t; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-08T12:01:59.773

这会吗？

```
use Date::Parse;
use POSIX;

my $s1 = "20120704";
my $t = str2time($s1) - 86400;
my $s2 = strftime "%Y%m%d", localtime $t;

print "$s2\n"; 
```

如果您关心这些，请注意 vs 和闰秒`localtime`。`gmtime`

# javascript - HTML 中的 onclick 事件不工作 Chrome 和 Safari 我有不同的 JavaScript 函数与每个选项标签相关联，以在 OpenLayers 地图中打开/关闭图层。它在 Opera、Firefox 和 IE9 中运行良好，但在 Chrome 和 Safari 中却不行。我读到我可以在 select 标记上使用 onchange，但由于我是 JavaScript 新手，我真的不知道它会如何调用四个不同的函数？ <select size="1" name="usgsf</h1>
<blockquote>
        <p>ID：11382949</p>
        <p>赞同：8</p>
        <p>时间：2012-07-08T11:54:22.853</p>
        <p>标签：javascript, html, forms, google-chrome, safari</p>
        </blockquote>

            <hr/>
            <h2>回答 #1</h2>
            <blockquote>
            <p>赞同：16</p>
            <p>时间：2012-07-08T12:02:38.713</p>
            </blockquote>

<p>根据select的值调用函数：</p>

<pre>如果值是"usgs_hour"串联'display_' + 'usgs_hour' === 'display_usgs_hour'，则调用该函数。 jsfiddle 演示：http: //jsfiddle.net/Ag3kh/ 回答 #2 赞同：2 时间：2012-07-08T11:58:40.440 对选定值使用开关构造 $('#usgsfeed').change(function () { swith($(this).val()) { case 'usgs_hour': display_usgs_hour(); break;..... } }) 回答 #3 赞同：1 时间：2012-07-08T12:19:26.850 看看 jsFiddle 演示：jsfiddle.net/bWdaU/。 它onchange用来调用函数display_usgs_change。 我添加了一个临时<div>的来显示选择工作。 HTML： <select id="usgsfeed" name="usgsfeed" size="1" onchange="display_usgs_change();"> <option value="usgs_hour">Past hour, all earthquakes</option> <option value="usgs_day" selected="selected">Past day, magnitude > 1</option> <option value="usgs_week">Past week, magnitude > 2.5</option> <option value="usgs_month">Past month, magnitude > 2.5</option> <option value="none">None</option> </select> <div id="dummy">Remove this div!</div>​ JS： function display_usgs_change() { document.getElementById('dummy').innerHTML = event.target.value; }​ 回答 #4 赞同：1 时间：2012-07-08T12:05:06.403 你确实应该使用onchange！ 要在 javascript（不是 jquery）中执行此操作，这将起作用： JavaScript： <script type='text/javascript'> function SelectChanged() { if (document.aform.usgsfeed.value == "usgs_hour") { alert("usgs_hour chosen"); else if( ...etc) } } </script> HTML： <form name="aform"> <select size="1" name="usgsfeed" id="usgsfeed" onchange='SelectChanged();> <option value="usgs_hour">Past hour, all earthquakes</option> <option value="usgs_day" SELECTED>Past day, magnitude > 1</option> <option value="usgs_week">Past week, magnitude > 2.5</option> <option value="usgs_month">Past month, magnitude > 2.5</option> <option value="none">None</option> </select> </form><code><select onchange=" window['display_'+this.value]();"&gt;="" <="" code=""></select>

# django - Django 获取执行 QuerySet 的不必要字段

> ID：11382950
> 
> 赞同：0
> 
> 时间：2012-07-08T11:54:29.593
> 
> 标签：django, optimization, django-queryset

这个 QuerySet（假设`Model`模型有 12 个字段）：

```
objects = Model.objects.filter(...) 
```

这个模板：

```
{% for object in object %}
<a href='{{ object.get_absolut_url }}'>Foo: {{ object.bar }}</a>
{% endfor %} 
```

执行获取不必要字段（每 12 个字段 + 关系）的 SQL 查询。我希望 Django 只获得 'bar' 字段。我怎样才能做到这一点？

顺便说一句，我知道`values()`方法，但是由于它返回 dict，所以我不能调用`Model`诸如`get_absolute_url()`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T13:07:50.540

您只想使用（）：

objects = Model.objects.select_related().only("bar").filter(...)

但是请记住，如果您限制过多的数据，然后以其他方式使用对象，您实际上可能会导致 ORM 执行额外的查询，因此请确保使用 django-debug-toolbar 之类的东西来确保您不是t 删除这些不必要的字段只会招致大量不必要的查询，这是更糟糕的情况。

仅供参考，如果您想从另一个方向考虑，您也可以使用 defer() 列出您不想加载的字段。

# php - Zend Forms 电子邮件元素更改为文本

> ID：11382954
> 
> 赞同：3
> 
> 时间：2012-07-08T11:55:02.273
> 
> 标签：php, html, zend-framework, zend-form

我正在尝试`email`在 Zend Forms 中创建一个类型的输入，但我无法完成所需的结果。

我创建了一个自定义类：

```
namespace AAA\Forms\Elements;

class Email extends \Zend_Form_Element_Text
{
    function __construct($name, $label, $required)
    {
        parent::__construct($name);
        $this->setAttrib('type', 'email');
        $this->setLabel($label)->setRequired($required);
    }
} 
```

然后我像这样使用它：

```
class Application_Form_Register extends Zend_Form
{
    public function init()
    {
        // …
        $email = new AAA\Forms\Elements\Email('email', 'E-mail:', true);
        $this->addElement($email);
        // …
    }
} 
```

我得到的是：

```
<input type="text" name="email" id="email" value="" type="email"> 
```

注意这两个`type`参数。

我已经设置了 HTML5 文档类型（`$documentType = new Zend_View_Helper_Doctype(); $documentType->doctype('HTML5');`在*Bootstrap.php*中），我也试过这个：

```
function __construct($name, $label, $required)
{
    $options = array();
    $options['type'] = 'email';
    parent::__construct($name, $options);
    // …
} 
```

我已阅读[Zend HTML5 Form element types](https://stackoverflow.com/questions/6433555/zend-html5-form-element-types)，但没有一个答案有效。我也尝试过 Glitch 库，但结果是一样的。

任何人都知道如何强制 Zend Framework 使用 HTML5 表单控件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-08T21:33:00.477

您还需要实现自己的视图助手来呈现电子邮件表单元素。

`Zend_Form_Element_Text`使用`formText`视图助手 ( ) 来呈现 HTML 输入，并且在呈现元素时将`Zend/View/Helper/FormText.php`其硬编码为输出。`<input type="text"`

处理此问题的两种可能方法是：

*   从元素中移除`ViewHelper`装饰器并使用`ViewScript`助手渲染元素。
*   使您自己的视图助手`formEmail`几乎与`formText`输出相同`type="email"`；并将`$helper`Element 类中的公共属性设置为`formEmail`. 您必须使用注册`formEmail`助手的路径，以便装饰器`Zend_View::addHelperPath()`可以找到它。`ViewHelper`

# google-plus - 是否有用于 Google Plus 事件的 API

> ID：11382956
> 
> 赞同：11
> 
> 时间：2012-07-08T11:55:30.443
> 
> 标签：google-plus

Google Plus 最近添加了事件，但他们是否添加了 API 方法来访问公共数据？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-08T20:03:11.833

REST API 目前对读取公共活动的支持有限。

您可以使用活动 API 查看为公共事件创建的活动，并通过检查 URL 确定它们是事件，但 API 当前不提供对所有事件元数据的访问。

[这是您可以看到的公共事件](https://developers.google.com/apis-explorer/#p/plus/v1/plus.activities.get?activityId=z13pdphaylvksztxx04cibvggseginlbrp40k&alt=json&_h=7&)的示例。

# java - 为什么我的基于 Netty 的 TCP 服务器在 CPU 使用率为 100% 时挂起？

> ID：11382961
> 
> 赞同：2
> 
> 时间：2012-07-08T11:55:54.657
> 
> 标签：java, centos, nio, netty, openjdk

我开发了一个基于 Netty 的 TCP 服务器来接收与基于 GSM/GPRS 的设备的保持连接，并将这些数据保存在 MySql 数据库中。当前处理 5K 连接。设备以 30-60 秒的间隔发送周期性消息，但连接保持活动状态以保持双工通信。

服务器应用程序在正常运行中消耗 1-2% 的 CPU，峰值高达 10%，平均负载非常低。然而，在正常运行 6 小时到 48 小时后，服务器应用程序挂起并持续 100% 的 CPU 消耗，线程转储表明 epoll 选择器是高 CPU 使用率的原因。应用程序仍然保持连接几个小时，然后 CPU 消耗增加到 200%，并且大部分连接被释放。

在项目开始时，我们使用了 MINA，并且在 1K 活动连接时遇到了同样的问题，这就是我们切换到 Netty 的原因。在 5K 连接之前，Netty 更加稳定，挂断时间为 1-2 周。

**我们的服务器配置：**

*   I7-2600 四核 CPU，
*   8 GB 内存，Centos 5.0，
*   打开JDK 6.0，
*   Netty 3.2.4（几小时前Netty更新到3.5.2）

为了克服这个问题，我们将更新`JDK`到 7.0（`JDK`具有针对异步操作优化的新 I/O 实现）并尝试不同的操作系统，包括 FreeBSD、Windows Server，因为每个操作系统都有不同的处理 I/O 的策略。

任何帮助将不胜感激，谢谢..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-05-15T14:50:09.403

这听起来像 Epoll 错误。

该应用程序正在代理与后端系统的连接。代理有一个通道池，可用于向后端系统发送请求。如果池中的通道不足，则会生成新通道并将其放入池中，以便可以为发送到代理的请求提供服务。这些池在应用程序启动时填充，这就是为什么 CPU 不需要很长时间就能达到峰值的原因（应用程序生命周期的 22 秒）。[Source](https://github.com/netty/netty/issues/327)

Netty 有一个内置的解决方法。不知道是哪个版本的，以后会更新的。

```
System.setProperty("org.jboss.netty.epollBugWorkaround", "true"); 
```

# php - 代码点火器/表达式引擎 - 将多行插入自定义数据库表

> ID：11382966
> 
> 赞同：1
> 
> 时间：2012-07-08T11:56:40.130
> 
> 标签：php, codeigniter, expressionengine

我有一个表达式引擎 CMS，它列出了一系列成员，并允许用户对每个成员进行投票并添加评论。然后，我需要将所有这些成员作为单独的行提交到我在 EE 安装中创建的自定义数据库表中。我不确定如何准确调用从 EE 提交的表单。这是我的代码：

形式

```
<tr>
    <td><input type="text" name="user[0][name]" value=""></td>
    <td><input type="text" name="user[0][party]" value=""><br></td>
    <td><input type="text" name="user[0][marks]" value=""></td>
    <td><input type="text" name="user[0][comments]" value=""></td>
</tr>
<tr>
    <td><input type="text" name="user[1][name]" value=""></td>
    <td><input type="text" name="user[1][party]" value=""><br></td>
    <td><input type="text" name="user[1][marks]" value=""></td>
    <td><input type="text" name="user[1][comments]" value=""></td>
</tr> 
```

提交代码：

```
foreach($_POST['user'] as $user)
{
    $this->db->insert('mytable', $user);
} 
```

但是我如何从 EE 表单中调用这个 php 代码呢？它只是一个简单`<form action="url.php">?`的吗？我将如何设置该 php 代码以利用 EE 的数据库连接字符串？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T16:46:57.800

Aditya 并不遥远，您只需要实例化 EE。因此，对于您的表单将结果页面/模板作为普通 html 的目标，例如：（`<form action="/form-result">`或其他），那么快速而肮脏的方法就是在接收表单的模板中包含 PHP。

在该页面（接收表单）上，具有以下内容（模板必须启用 PHP）：

```
<?php
$EE =& get_instance();
$postUsers = $EE->input->post('user');

foreach($postUsers as $user) {
    // Extra Cleaning
    $user = $EE->db->escape_str($user);
    $user = $EE->security->xss_clean($user);
    // Fields and values to save to DB
    $dbFields = array(
        'user' => $user['name'],
        'party' => $user['party'],
        'marks' => $user['marks'],
        'comments' => $user['comments']
    );
    // Prefix variable used for good practice, but could hard code
    $EE->db->insert($EE->db->dbprefix . 'mytable', $dbFields);
}
?> 
```

我已经展示了重新创建数组以发送到数据库的长方法，以防您想要修改或添加更多字段，但您可以简单地将 $user （清理后）传递给数据库，因为数组将具有相同的结构.

如果它是表单发送的多个 POST 变量（而不是您暗示的数组），您需要类似：

```
foreach($_POST as $var) {
    $postUsers = $EE->input->post($var); 
```

更理想的解决方案是开发一个插件，该插件将从生成的模板中调用以触发上述操作，或者开发一个“侦听”要提交的适当表单的扩展，可能通过使用 EE 中内置的 ACT 安全功能。但这可能会为您的要求增加不必要的复杂性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T12:00:02.897

> 但是我如何从 EE 表单中调用这个 php 代码呢？

我通常用以下方式引用它们：

`<form action="<?php echo base_url('form_processing_controller') ?>">`

当我使用 CodeIgniter 时。

此外，`$_POST[]`当您可以使用 CodeIgniter 的自动加载的 Input 类时，为什么还要使用呢？

`$this->input->post('item_name')`

...这样，CI 会为您过滤掉一些恶意活动。查看用户指南：[http ://codeigniter.com/user_guide/libraries/input.html](http://codeigniter.com/user_guide/libraries/input.html)

# java - 如何安全地关闭 IndexReader？

> ID：11382971
> 
> 赞同：3
> 
> 时间：2012-07-08T11:57:51.573
> 
> 标签：java, lucene

我的问题很简单，当使用`IndexReader.openIfChanged (reader)`replace之前`reader`，如何安全关闭`oldReader`？

这是代码：（使用Lucene 3.5）

```
IndexReader newReader=IndexReader.openIfChanged(reader);
if(newReader!=null){
    IndexReader oldReader=reader;
    IndexSearcher oldSearcher=searcher;

    reader=newReader;
    searcher=new IndexSearcher(newReader);

    oldSearcher.close();
    oldReader.close();//or oldReader.decRef(),result is the same
} 
```

这段代码在一个守护线程中，每 5 秒运行一次

`IndexReader`instance( `reader`object) 是全局唯一的

由于这个变化，我得到一个例外：

```
org.apache.lucene.store.AlreadyClosedException: this IndexReader is closed
    at org.apache.lucene.index.IndexReader.ensureOpen(IndexReader.java:297)
    at org.apache.lucene.index.IndexReader.getSequentialSubReaders(IndexReader.java:1622)
    at org.apache.lucene.search.TermQuery$TermWeight.scorer(TermQuery.java:98)
    at org.apache.lucene.search.BooleanQuery$BooleanWeight.scorer(BooleanQuery.java:298)
    at org.apache.lucene.search.BooleanQuery$BooleanWeight.scorer(BooleanQuery.java:298)
    at org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:577)
    at org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:517)
    at org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:487)
    at org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:400)
    at org.zenofo.index.IndexManager.query(IndexManager.java:392)
    ... 
```

`IndexManager.java:392`使用`reader`对象（`IndexReader`实例，全局唯一）

`IndexManager.query`方法有大量并发请求，所有请求使用全局唯一的`IndexReader`实例（`reader`对象）

![在此处输入图像描述](../Images/ace00d2faddf887254313d49be51ae89.png)

我需要关闭`oldReader`只是因为：

*   [当用户数量增加时，Lucene Indexing 中打开的文件过多](https://stackoverflow.com/questions/8224413/too-many-open-files-in-lucene-indexing-when-number-of-users-increase)
*   [Lucene Wiki:打开的文件太多](http://wiki.apache.org/lucene-java/LuceneFAQ#Why_am_I_getting_an_IOException_that_says_.22Too_many_open_files.22.3F)

参考：

*   [API-IndexReader](http://lucene.apache.org/core/3_6_0/api/all/index.html?org/apache/lucene/index/IndexReader.html)
*   [API-IndexSearcher](http://lucene.apache.org/core/3_6_0/api/all/index.html?org/apache/lucene/search/IndexSearcher.html)

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-09T03:41:36.057

查看 NRTManager 和 SearcherManager。你真的不必自己处理这个。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-09T07:54:45.727

您需要在对var 的写入与从其他线程对它们的后续读取`happens-before`之间施加关系。`public static`如果您使用多个 var，则会遇到原子性问题，因此我建议您只使用一个 var，因为这就是您所需要的。

简单地说，这对你有用：

```
public class SearcherManager 
{
  public static volatile IndexSearcher searcher;

  private static void reopen() {
    // your code, just without assignment to reader
  }
} 
```

关键是`volatile`修饰符。确保在写入 var 之前完全初始化所有内容，但在写入之后关闭旧对象 - 换句话说，只需确保按照现在的方式继续执行它 :)

但是，正如@MJB 在他的回答中指出的那样，你**真的**不应该这样做，因为它都内置在 Lucene 中。查看[NRTManagerReopenThread 上的 Javadoc](http://lucene.apache.org/core/old_versioned_docs/versions/3_5_0/api/core/org/apache/lucene/search/NRTManagerReopenThread.html)以获取您需要的所有信息，包括完整的代码示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-09T03:07:37.730

看看 indexreader 引用计数方法。即当你实例化一个新的IndexSearcher时增加引用计数， `reader.incRef();`当你完成搜索结果时减少它，最好在try catch方法的finally语句中使用`reader.decRef()`;

`reader.decRef()`当引用数为 0 时自动关闭阅读器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-08T12:05:47.577

如果在阅读器（oldReader）上工作，我假设搜索器（后来被称为 oldSearcher），在这种情况下，当你关闭它时，它也会关闭它使用的阅读器，所以你不需要关闭它，oldSearcher.close() 是足够的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-08T12:07:08.403

我根本看不到 oldReader 和 oldSearcher 在做什么！！！！难道你不能把它们连同它们一起删除吗？`close()` 如果你仍然需要它们，那么我敢打赌，oldSearcher 在某种程度上与 oldReader 相关，所以调用`close()`oldSearcher 也会导致关闭 oldReader 这就是你得到异常的原因是整个代码量，还是你简化了它？如果是，则首先删除 oldReader 和 oldSearcher

干杯

# qt - 如何使 QGraphicsView 平面化？

> ID：11382975
> 
> 赞同：1
> 
> 时间：2012-07-08T11:58:12.503
> 
> 标签：qt, qgraphicsview, qtstylesheets, qframe

我怎样才能使`QGraphicsView`看起来平坦？它看起来像这样：

![在此处输入图像描述](../Images/957c084ba10bfdefe622400311cd6fb7.png)

我不希望显示轮廓。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-08T12:03:45.483

`QGraphicsView`继承自`QFrame`。使用[`setFrameStyle`](http://qt-project.org/doc/qt-4.8/qframe.html#setFrameStyle)方法和[`lineWidth`](http://qt-project.org/doc/qt-4.8/qframe.html#lineWidth-prop)属性来改变框架的[外观](http://qt-project.org/doc/qt-4.8/qframe.html#details)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-12-08T13:11:26.153

您还可以使用样式表自定义 QFrame 的外观（包括边框），请参阅[样式表文档](http://doc.qt.io/qt-5/stylesheet-examples.html#customizing-qframe)。

要使您的小部件看起来很扁平，只需添加以下 CSS：`border: 0px`

# php - PHP - 在数组中达到某个值

> ID：11382977
> 
> 赞同：0
> 
> 时间：2012-07-08T11:58:32.177
> 
> 标签：php, arrays

我使用的 API 向我发送了一个对象/数组（不确定）。这是我使用回来的信息`print_out($arr)`：

```
Array
(
    [0] => Array
    (
        [callID] => 40
        [PairCallLegId] => 
        [CallsCount] => 4
        [LocalName] => 151204
        [RemoteName] => 15740
        [type] => 1
        [isOut] => 0
        [FirstName] => Boris
        [lastName] => Ostrovsky
        [AvgMos] => 3.7432666239999963
        [AvgQoe] => 
        [AvgPL] => 
        [AvgJitter] => 
        [AvgVideoQP] => 
        [AvgBDW] => 1200
        [AvgFrameRate] => 
        [AvgTotalPkt] => 102433.80945757998
        [AvgTotalBytes] => 
    )
) 
```

我试图达到“CallsCount”中的值（应该是 4）

我尝试使用 `$arr[0]["CallsCount"]` and `$arr["0"]["CallsCount"]` 甚至 `$arr[0]->CallsCount`

没有工作。我`Internal Server Error (500)`每次都得到。

我应该怎么办？

# c# - IIS - 列出子网站和它们所在的应用程序池？

> ID：11382979
> 
> 赞同：0
> 
> 时间：2012-07-08T11:58:35.710
> 
> 标签：c#, iis-6, application-pool

我有一个 IIS 6.0 网站，其中包含很多子网站和多个应用程序池。

我想帮助确定每个子网站使用 c# 的应用程序池。

我查看了`DirectoryServices`命名空间，但仍然不确定该怎么做。

任何帮助表示赞赏。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T12:02:41.913

看看[这个问题](https://stackoverflow.com/questions/7607175/how-to-get-applications-associated-with-a-application-pool-in-iis7)，我意识到这是针对 IIS7 的，但可能值得一试

```
ServerManager manager = new ServerManager();
    foreach (Site site in manager.Sites)
    {
        foreach (Application app in site.Applications)
        {

            if (app.ApplicationPoolName.ToString() == AppPoolName)
            {
                 string appname = app.Path;
            }
        }
    } 
```

# php - 在 PHP 中运行 Javascript 的问题

> ID：11382987
> 
> 赞同：0
> 
> 时间：2012-07-08T11:59:59.487
> 
> 标签：php, jquery, json, yql

大家下午好。

我对下面的代码有一个持续的问题。我知道 Javascript/JQuery 和 JSON 工作正常，如此处所示 - [http://jsfiddle.net/Dvpmy/13/](http://jsfiddle.net/Dvpmy/13/)

我也知道当我尝试回显 Javascript 时 PHP 工作正常。但是，当我结合所有内容时，我似乎遇到了问题。Chrome 正在标记“意外标识符”，而 Firefox 认为参数后缺少右括号。我也无法找到并补救。

```
<html>
<head>
<script type="text/javascript" src="/Portfolio/jquery.js"></script>
<?php

mysql_connect(localhost,"user","password");
@mysql_select_db("database") or die( "Unable to select database");
$query="SELECT * FROM quote WHERE view='yes'";
$result=mysql_query($query);
$num=mysql_numrows($result);
mysql_close();
$i=0;
while ($i < $num) {

$ID=mysql_result($result,$i,"ID");
$EPIC=mysql_result($result,$i,"EPIC");

echo '<script type="text/javascript">';
echo'$.getJSON("http://query.yahooapis.com/v1/public/yql?     q=select%20*%20from%20yahoo.finance.historicaldata%20where%20symbol%20%3D%20%22DES%22%20and%20startDate%20%3D%20%222009-09-11%22%20and%20endDate%20%3D%20%222010-03-10%22&format=json&env=store%3A%2F%2Fdatatables.org%2Falltableswithkeys&callback=?", function(data) { console.log(data); var info = data.query.results.quote[0].Close; var date = data.query.results.quote[0].Date; var high = data.query.results.quote[0].High; $("div.quote").html("Test" $ID <br> $EPIC <br> high ); } );';
echo '</script>';

$i++;
}

?>
</head>
<body><div class='quote'></div></body></html> 
```

如果解决方案显而易见，我想提前道歉。我们将不胜感激地接受所有帮助。

非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-08T12:03:52.720

立即跳出的内容就在 JavaScript 块的末尾：

```
$("div.quote").html("Test" $ID <br> $EPIC <br> high ); 
```

之后的所有内容都在`"Test"`引号之外，并且会引发错误。

# c# - 在 foreach 循环中使用多个对象进行迭代

> ID：11382993
> 
> 赞同：4
> 
> 时间：2012-07-08T12:00:37.080
> 
> 标签：c#, .net, windows

我有一个多维列表：

```
 List<string>[] list = new List<string>[2];
    list[0] = new List<string>();
    list[1] = new List<string>(); 
```

我按如下方式迭代列表 - 但这仅迭代一个列表：

```
foreach (String str in dbConnectObject.Select()[0])
{
   Console.WriteLine(str);
} 
```

虽然我希望能够做类似的事情：

```
foreach (String str in dbConnectObject.Select()[0] & String str2 in dbConnectObject.Select()[1])
{
   Console.WriteLine(str + str2);
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-08T12:04:02.433

如果列表大小相同，则可以使用[`Enumerable.Zip`](http://msdn.microsoft.com/en-us/library/dd267698.aspx)：

```
foreach (var p in dbConnectObject.Select()[0].Zip(dbConnectObject.Select()[1], (a,b) => new {First = a, Second = b})) {
    Console.Writeline("{0} {1}", p.First, p.Second);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-08T12:05:14.873

如果要按顺序遍历这两个列表，可以使用[`IEnumerable<T>.Union(IEnumerable<T>)`扩展方法](http://msdn.microsoft.com/en-us/library/bb341731.aspx)：

```
IEnumerable<string> union = list[0].Union(list[1]);

foreach(string str int union)
{
     DoSomething(str);
} 
```

如果你想要一个组合矩阵，你可以加入列表：

```
var joined = from str1 in list[0]
             from str2 in list[1]
             select new { str1, str2};

foreach(var combination in joined)
{
    //DoSomethingWith(combination.str1, combination.str2);
    Console.WriteLine(str + str2);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-08T12:07:23.217

你可以试试下面的代码。如果尺寸不同，它也可以工作。

```
for (int i = 0; i < list[0].Count; i++)
{
    var str0 = list[0][i];
    Console.WriteLine(str0);
    if (list[1].Count > i)
    {
        var str1 = list[1][i];
        Console.WriteLine(str1);
    }
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-07-08T12:07:27.343

改用 LINQ：

`foreach (var s in list.SelectMany(l => l)) { Console.WriteLine(s); }`

# wix - 在注册表中设置默认值，如果没有

> ID：11382997
> 
> 赞同：3
> 
> 时间：2012-07-08T12:01:13.707
> 
> 标签：wix

我正在维护一个旧应用程序，其中用户配置存储在注册表中。卸载时留下*。*我现在正在用 WiX 重写安装程序。

如果注册表中没有默认值，安装程序应在注册表中添加一个默认值，否则应保留现有值。

我正在考虑如何在 WiX 中做到这一点。而我想出的解决方案有些繁琐：

```
 <Property Id="MY_PROPERTY">
      <RegistrySearch Root="HKLM" Key="SOFTWARE\MyProduct" Name="MyProperty" Type="raw" />
  </Property>

  <CustomAction Id="ca.SetDefaultValue" Property="MY_PROPERTY" Value="DefaultValue" />

  <InstallExecuteSequence>
      <Custom After="RegistrySearch" Action="ca.SetDefaultValue">Not MY_PROPERTY</Custom>
  </InstallExecuteSequence>

  <Component Id="c.Registry">
      <RegistryValue Root="HKLM" Key="SOFTWARE\MyProduct" Name="MyProperty" Type="string" Value="[MY_PROPERTY]" />
  </Component> 
```

因此，请进行注册表搜索以查找旧值。如果未设置，则使用计划的自定义操作设置为默认值。然后“像往常一样”创建值。

谁能想出一个更顺畅的方法来做到这一点？

请注意，我不能使用方便的变量，`Installed`因为值可能在那里，被以前的、现在已卸载的版本留下。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-08T16:53:50.077

[从Wix 记住属性模式](http://robmensching.com/blog/posts/2010/5/2/The-WiX-toolsets-Remember-Property-pattern)开始，但更进一步。`AppSearch`运行后，如果`REMEMBERME`属性获得或未获得值，请使用[`SetProperty`](http://wix.sourceforge.net/manual-wix3/wix_xsd_setproperty.htm)自定义操作分配默认值 if `REMEMBERME=""`。

不过，我更进一步。我有一个我称之为“财产优先”的概念。基本上，它是一个属性应该如何获得其价值的优先级列表。

从最高到最低：

1.  在 UI 期间输入的属性
2.  在命令行传入的公共属性
3.  期间发现的属性`AppSearch`
4.  [`Property`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa370908.aspx)表中定义的默认值

换句话说，在第一次静默安装期间，在命令行中没有传递任何属性，应该使用属性表中的默认值。

在没有在命令行传递任何属性的第二次静默安装期间，记住的值应优先于默认值。（如果不同）

在第一次或第二次静默安装期间，在命令行传递的属性应被视为覆盖值，并优先于默认值和记忆值。

在交互式安装期间，会发生上述规则，并且 UI 应显示该值。如果用户更改该值，则这是最终值。

我将由您决定如何实现各种自定义操作来执行此操作。它通常涉及一个 temp prop 和一个 real prop 以及一系列具有正确执行调度和条件的 Set Property CA，以执行您希望它执行的操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T21:59:04.860

您没有明确设置`keypath=yes`组件中的注册表值。但是，在这种情况下，wix 将选择第一个可以用作键路径的子项。来自[wix 组件元素文档](http://wix.sourceforge.net/manual-wix3/wix_xsd_component.htm)：

> 如果组件或子注册表值或文件的 KeyPath 未设置为“是”，WiX 将按顺序查看组件下的子元素并尝试自动选择其中一个作为键路径。

因此，您的注册表值是安装它的组件的[密钥路径。](https://stackoverflow.com/questions/2003043/what-is-the-wix-keypath-attribute)这意味着如果注册表值已经存在，则不会安装该组件。据我所知，这就是你想要的行为。

# javascript - 全局 CSS - 如何实现多个框架

> ID：11382998
> 
> 赞同：0
> 
> 时间：2012-07-08T12:01:26.540
> 
> 标签：javascript, css, stylesheet, global

我有一个主要是 javascript 的网络软件/网络应用程序。它使用 extJS 框架和相当多的自定义脚本。全局样式表，称为 main.css，由 extJS 库样式和我们自己的新样式和 extJS 样式覆盖组成。这都是使用 SASS 编译的。

现在，我想将应用程序嵌入到网页中。这是在没有嵌入包装器的情况下完成的，但实际上是在页面中运行应用程序，包括使用全局样式。

页面中的外部内容（非应用程序）是使用 Bootstrap CSS 框架和一些 jquery 元素以及一些 Bootstrap 覆盖和一些自定义样式的自定义设计。

我们不能将 Bootstrap 作为全局 CSS 加载，因为样式明显不同并且独立于应用程序样式，因此希望避免冲突。

我如何为它们的相关领域调用 syles，确保我们也可以轻松地执行版本控制/更新核心框架 - extJS、bootstrap、jquery 等，并避免全局样式之间的冲突 - 有效地将它们视为不同的孤岛？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T12:10:13.063

我可能误解了对此的一个关键部分，但是由于您使用的是 SASS，您可以简单地使用：

```
#some-custom-area {
    @import "path/to/bootstrap-result.css";
} 
```

也就是说，采用 Bootstrap CSS 框架和您为其编写的所有自定义规则（在编译后进入的任何 CSS 文件中）并将它们导入到您的全局样式表中......但包装在一个`#some-custom-area`选择器中。当 SASS 编译它时，它将确保来自 Bootstrap 端的所有规则仅在`#some-custom-area`.

这可行吗？