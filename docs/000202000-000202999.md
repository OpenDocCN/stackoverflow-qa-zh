# StackOverflow 问答 000202000-000202999

# c# - 如何在 C# 中打开文件并更改其属性？

> ID：202002
> 
> 赞同：3
> 
> 时间：2008-10-14T17:04:10.067
> 
> 标签：c#, ms-word

我需要打开一个 Microsoft Word 2003 文件并更改其文件属性。例如更改摘要选项卡中的主题。
![替代文字](https://i.stack.imgur.com/FEpJY.gif)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-14T21:14:17.457

Microsoft 提供了一个非常有用的小程序集，称为 DSOFile。通过在您的项目中引用它，您可以修改 Office 文档属性。它不一定让您打开实际的 Office 文件的属性对话框，但您当然可以模拟它。

据微软称：

> Dsofile.dll 文件允许您在未安装 Office 时编辑 Office 文档属性

更多详细信息和下载链接可在[http://support.microsoft.com/kb/224351找到](http://support.microsoft.com/kb/224351)

这是我多年前使用的一些（非常古老的）VB代码片段。抱歉，我还没有转换为 C#，并且请注意它是类的一部分，因此存在对实例变量的引用。尽管如此，它应该很容易理解并满足您自己的需求：

```
Private Sub ProcessOfficeDocument(ByVal fileName As String)
    Dim docDSO As New DSOFile.OleDocumentPropertiesClass
    Dim docTitle, docModified, docAuthor, docKeywords As String
    Try
        docDSO.Open(fileName, True)
        Dim docSummary As DSOFile.SummaryProperties = docDSO.SummaryProperties
        docTitle = docSummary.Title
        docAuthor = docSummary.Author
        docKeywords = docSummary.Keywords
        docModified = CStr(docSummary.DateLastSaved)

        If (Not String.IsNullOrEmpty(docTitle)) Then
            _Title = docTitle
        End If

        If (Not String.IsNullOrEmpty(docAuthor)) Then
            _Author = docAuthor
        End If

        If (Not String.IsNullOrEmpty(docModified)) Then
            _DateModified = DateTime.Parse(docModified)
        End If

    Catch ex As Exception
        'Do whatever you need to do here...'
    Finally
        If (Not docDSO Is Nothing) Then
            docDSO.Close()
        End If
    End Try
End Sub 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-14T17:07:20.547

我可以想到两种方法来做到这一点：

*   使用 Microsoft Office API。您必须在项目中引用它们，并且需要 [Primary Interop Assemblies](http://msdn.microsoft.com/en-us/library/aa163987.aspx)。
*   将文件转换为 Word 2003 XML 格式并更改 XML 文档中的值。这是有关文档属性的 MSDN 文档：http: [//msdn.microsoft.com/en-us/library/aa223625 (office.11​​).aspx](http://msdn.microsoft.com/en-us/library/aa223625(office.11).aspx)

如果可以的话，我会选择第二个选项，因为这样你就不必依赖系统上安装的 Word。

# php - 如何修复“http_client.c(227) 错误创建套接字”错误，这可能是由操作系统引起的

> ID：202005
> 
> 赞同：0
> 
> 时间：2008-10-14T17:06:37.333
> 
> 标签：php, c, web-services, ubuntu, axis

我正在我的 ubuntu 8.04 开发服务器上设置 wso2 php Web 服务框架。

但是我的网络服务失败了。查看 wsf_client.log （框架的自定义日志）文件给了我问题中的错误。

我相信错误是从轴返回的，但我不知道如何解决它，并且会感谢任何正确方向的指针。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-25T18:18:46.833

我只是在这里转发来自原始提问者的信息，发布在另一个论坛上：

> 解决了。
> 
> 谢谢回复，
> 
> 我认为我的问题是在 apache conf 中错误地设置了 localhost，
> 
> 这导致套接字尝试自行连接。
> 
> 无论如何，重新安装和更改 localhost 为我修复了它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-25T12:00:07.370

也许您没有以 root 身份启动应用程序，但它设置为侦听低于 1024 的端口号？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-14T19:33:44.680

在 Linux 上，您可以使用 strace 运行客户端：

strace myprogram 2>&1 > myprogram.log

并检查系统调用的日志，如 socket()。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-14T18:09:53.523

你检查 /var/log/messages 了吗？如果错误是在操作系统级别，您可能会有更多线索。

# c++ - 在 CView 而不是 CMainFrame 中创建停靠窗格

> ID：202007
> 
> 赞同：2
> 
> 时间：2008-10-14T17:06:59.500
> 
> 标签：c++, visual-studio-2008, mfc, mfc-feature-pack, docking

使用 VS2008 的 AppWizard（加上功能包）创建具有“Visual Studio”风格的 MDI 应用程序时，`CMainFrame`该类获得一个方法`CreateDockingWindows()`。

由于我不希望所有窗格始终可见，而是根据活动文档的类型显示它们，因此我将这些窗口设置为我的视图成员，并将创建移至`OnInitialUpdate()`. `CMainFrame`我以与将主框架设置为父窗口相同的方式创建这些窗格。

停靠窗口的位置会自动保存到注册表中，但它们不会被恢复，因为在框架初始化时停靠窗口还不存在。

使用视图创建停靠窗口是一个好主意，还是我应该期待更多问题？有没有更好的方法来完成我想要的？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T12:31:16.333

以下解决方案对我来说效果很好。

MainFrame 仍然拥有所有窗格，因此保留了所有现有的框架功能。

我从一个实现我需要的“CView-like”行为的类派生窗格：

```
/**
 * \brief Mimics some of the behavior of a CView
 *
 * CDockablePane derived class which stores a pointer to the document and offers
 * a behavior similar to CView classes.
 *
 * Since the docking panes are child windows of the main frame,
 * they have a longer live time than a view. Thus the (de-)initialization code
 * cannot reside in the CTor/DTor.
 */
class CPseudoViewPane :
    public CDockablePane,
{
    DECLARE_DYNAMIC(CPseudoViewPane)

public:
    /// Initializes the pane with the specified document
    void Initialize(CMyDoc* pDoc);

    void DeInitialize();

    /// Checks if window is valid and then forwards call to pure virtual OnUpdate() method.
    void Update(const LPARAM lHint);

protected:
    CPseudoViewPane();
    virtual ~CPseudoViewPane();

    CMyDoc* GetDocument() const { ASSERT(NULL != m_pDocument); return m_pDocument; }

    CMainFrame* GetMainFrame() const;

    /**
     * This method is called after a document pointer has been set with #Initialize().
     * Override this in derived classes to mimic a view's "OnInitialUpdate()-behavior".
     */
    virtual void OnInitialUpdate() = 0;

    /**
     * Called by #Update(). Overrider to mimic a view's "OnUpdate()-behavior".
     * This method has a simplified parameter list. Enhance this if necessary.
     */
    virtual void OnUpdate(const LPARAM lHint) = 0;

    DECLARE_MESSAGE_MAP()

private:
    CMyDoc* m_pDocument;
}; 
```

# windows - 如何检测 Windows 的语言版本

> ID：202009
> 
> 赞同：3
> 
> 时间：2008-10-14T17:07:17.473
> 
> 标签：windows, windows-xp, windows-server-2003

需要的是操作系统的真实语言版本，而不是用户界面语言或当前区域设置。

用例：必须应用安全设置和用户帐户创建的软件安装。脚本必须知道某些系统属性，例如操作系统原始语言中的用户组名称。

（应该适用于 Windows XP、Windows Server 2003、Vista，...）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-15T12:55:22.863

要检测操作系统语言，请使用[GetSystemDefaultUILanguage](http://msdn.microsoft.com/en-us/library/ms776263.aspx)。

但是，有更直接的方法可以在 Windows 中查找已知组名等内容。例如，要获取*用户*组的名称，请先调用[CreateWellKnownSid](http://msdn.microsoft.com/en-us/library/aa446585.aspx)，`WellKnownSidType = 27 (WinBuiltinUsersSid)`然后再调用[LookupAccountSid](http://msdn.microsoft.com/en-us/library/aa379166.aspx)。也可以查询其他[知名用户和组的名称。](http://support.microsoft.com/kb/243330)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-15T13:04:52.657

操作系统中的所有本地化名称都有一种语言中立的方式来访问它们，以供本机应用程序和设置脚本使用。管理员、用户、来宾组和管理员帐户具有众所周知的 SID，可用于代替本地化名称。需要考虑的额外一点是，内置主体的所有默认名称都可以更改，并且通常是好意但困惑的系统管理员，他们认为将域管理员帐户或组名更改为非默认名称等于提高了安全性。即使是操作系统安装语言的正确名称，您也不能依赖这些东西。更糟糕的是，某些语言本地化会在一种语言的操作系统版本之间发生变化。因此，您需要在操作系统版本和语言的预期名称之间构建一个非常仔细的映射。

宁可不要。了解如何为您的脚本环境构建区域设置中性 ID。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-14T17:21:27.710

到目前为止我最好的解决方案：枚举本地用户帐户和组，并与不同语言的已知名称列表进行比较。

# c# - 在 C# 中加密和解密字符串？

> ID：202011
> 
> 赞同：730
> 
> 时间：2008-10-14T17:07:32.963
> 
> 标签：c#, .net, encryption, mono, cryptography

如何在 C# 中加密和解密字符串？

* * *

## 回答 #1

> 赞同：428
> 
> 时间：2010-05-07T19:41:33.170

**编辑 2013 年 10 月**：虽然我随着时间的推移编辑了这个答案以解决缺点，但请参阅[jbtule 的答案](https://stackoverflow.com/a/10366194/157247)以获得更强大、更明智的解决方案。

[https://stackoverflow.com/a/10366194/188474](https://stackoverflow.com/a/10366194/188474)

**原答案：**

这是一个源自[“RijndaelManaged Class”文档](http://msdn.microsoft.com/en-us/library/system.security.cryptography.rijndaelmanaged%28v=VS.90%29.aspx)和[MCTS Training Kit](https://rads.stackoverflow.com/amzn/click/com/0735626197)的工作示例。

**编辑 2012-April**：编辑此答案以根据 jbtule 的建议预先添加 IV，如下所示：

[http://msdn.microsoft.com/en-us/library/system.security.cryptography.aesmanaged%28v=vs.95%29.aspx](http://msdn.microsoft.com/en-us/library/system.security.cryptography.aesmanaged%28v=vs.95%29.aspx)

祝你好运！

```
public class Crypto
{

    //While an app specific salt is not the best practice for
    //password based encryption, it's probably safe enough as long as
    //it is truly uncommon. Also too much work to alter this answer otherwise.
    private static byte[] _salt = __To_Do__("Add a app specific salt here");

    /// <summary>
    /// Encrypt the given string using AES.  The string can be decrypted using 
    /// DecryptStringAES().  The sharedSecret parameters must match.
    /// </summary>
    /// <param name="plainText">The text to encrypt.</param>
    /// <param name="sharedSecret">A password used to generate a key for encryption.</param>
    public static string EncryptStringAES(string plainText, string sharedSecret)
    {
        if (string.IsNullOrEmpty(plainText))
            throw new ArgumentNullException("plainText");
        if (string.IsNullOrEmpty(sharedSecret))
            throw new ArgumentNullException("sharedSecret");

        string outStr = null;                       // Encrypted string to return
        RijndaelManaged aesAlg = null;              // RijndaelManaged object used to encrypt the data.

        try
        {
            // generate the key from the shared secret and the salt
            Rfc2898DeriveBytes key = new Rfc2898DeriveBytes(sharedSecret, _salt);

            // Create a RijndaelManaged object
            aesAlg = new RijndaelManaged();
            aesAlg.Key = key.GetBytes(aesAlg.KeySize / 8);

            // Create a decryptor to perform the stream transform.
            ICryptoTransform encryptor = aesAlg.CreateEncryptor(aesAlg.Key, aesAlg.IV);

            // Create the streams used for encryption.
            using (MemoryStream msEncrypt = new MemoryStream())
            {
                // prepend the IV
                msEncrypt.Write(BitConverter.GetBytes(aesAlg.IV.Length), 0, sizeof(int));
                msEncrypt.Write(aesAlg.IV, 0, aesAlg.IV.Length);
                using (CryptoStream csEncrypt = new CryptoStream(msEncrypt, encryptor, CryptoStreamMode.Write))
                {
                    using (StreamWriter swEncrypt = new StreamWriter(csEncrypt))
                    {
                        //Write all data to the stream.
                        swEncrypt.Write(plainText);
                    }
                }
                outStr = Convert.ToBase64String(msEncrypt.ToArray());
            }
        }
        finally
        {
            // Clear the RijndaelManaged object.
            if (aesAlg != null)
                aesAlg.Clear();
        }

        // Return the encrypted bytes from the memory stream.
        return outStr;
    }

    /// <summary>
    /// Decrypt the given string.  Assumes the string was encrypted using 
    /// EncryptStringAES(), using an identical sharedSecret.
    /// </summary>
    /// <param name="cipherText">The text to decrypt.</param>
    /// <param name="sharedSecret">A password used to generate a key for decryption.</param>
    public static string DecryptStringAES(string cipherText, string sharedSecret)
    {
        if (string.IsNullOrEmpty(cipherText))
            throw new ArgumentNullException("cipherText");
        if (string.IsNullOrEmpty(sharedSecret))
            throw new ArgumentNullException("sharedSecret");

        // Declare the RijndaelManaged object
        // used to decrypt the data.
        RijndaelManaged aesAlg = null;

        // Declare the string used to hold
        // the decrypted text.
        string plaintext = null;

        try
        {
            // generate the key from the shared secret and the salt
            Rfc2898DeriveBytes key = new Rfc2898DeriveBytes(sharedSecret, _salt);

            // Create the streams used for decryption.                
            byte[] bytes = Convert.FromBase64String(cipherText);
            using (MemoryStream msDecrypt = new MemoryStream(bytes))
            {
                // Create a RijndaelManaged object
                // with the specified key and IV.
                aesAlg = new RijndaelManaged();
                aesAlg.Key = key.GetBytes(aesAlg.KeySize / 8);
                // Get the initialization vector from the encrypted stream
                aesAlg.IV = ReadByteArray(msDecrypt);
                // Create a decrytor to perform the stream transform.
                ICryptoTransform decryptor = aesAlg.CreateDecryptor(aesAlg.Key, aesAlg.IV);
                using (CryptoStream csDecrypt = new CryptoStream(msDecrypt, decryptor, CryptoStreamMode.Read))
                {
                    using (StreamReader srDecrypt = new StreamReader(csDecrypt))

                        // Read the decrypted bytes from the decrypting stream
                        // and place them in a string.
                        plaintext = srDecrypt.ReadToEnd();
                }
            }
        }
        finally
        {
            // Clear the RijndaelManaged object.
            if (aesAlg != null)
                aesAlg.Clear();
        }

        return plaintext;
    }

    private static byte[] ReadByteArray(Stream s)
    {
        byte[] rawLength = new byte[sizeof(int)];
        if (s.Read(rawLength, 0, rawLength.Length) != rawLength.Length)
        {
            throw new SystemException("Stream did not contain properly formatted byte array");
        }

        byte[] buffer = new byte[BitConverter.ToInt32(rawLength, 0)];
        if (s.Read(buffer, 0, buffer.Length) != buffer.Length)
        {
            throw new SystemException("Did not read byte array properly");
        }

        return buffer;
    }
} 
```

* * *

## 回答 #2

> 赞同：387
> 
> 时间：2012-04-28T18:07:48.510

**字符串的对称认证加密的现代示例。**

对称加密的一般最佳实践是使用带有关联数据的身份验证加密 (AEAD)，但这不是标准 .net 加密库的一部分。所以第一个例子使用[AES256](http://en.wikipedia.org/wiki/Advanced_Encryption_Standard)然后[HMAC256](http://en.wikipedia.org/wiki/HMAC)，两步[Encrypt 然后 MAC](https://crypto.stackexchange.com/a/205/1934)，这需要更多的开销和更多的密钥。

第二个示例使用 AES256- [GCM](http://en.wikipedia.org/wiki/Galois/Counter_Mode)的更简单实践，使用开源 Bouncy Castle（通过 nuget）。

这两个示例都有一个 main 函数，它接受秘密消息字符串、密钥和可选的非秘密有效负载，并返回和经过身份验证的加密字符串，可选地以非秘密数据开头。理想情况下，您可以将这些与随机生成的 256 位密钥一起使用，请参阅`NewKey()`.

这两个示例还有一个辅助方法，它使用字符串密码来生成密钥。这些帮助方法是为了方便与其他示例匹配而提供的，但是它们的*安全*性要低得多，因为密码的强度将*远低于 256 位密钥*。

**更新：** 添加`byte[]`了重载，并且由于 StackOverflow 回答限制，只有[Gist](https://gist.github.com/4336842)具有 4 个空格缩进和 api 文档的完整格式。

* * *

**.NET 内置加密 (AES)-Then-MAC(HMAC) [[要点]](https://gist.github.com/jbtule/4336842#file-aesthenhmac-cs)**

```
/*
 * This work (Modern Encryption of a String C#, by James Tuley), 
 * identified by James Tuley, is free of known copyright restrictions.
 * https://gist.github.com/4336842
 * http://creativecommons.org/publicdomain/mark/1.0/ 
 */

using System;
using System.IO;
using System.Security.Cryptography;
using System.Text;

namespace Encryption
{
  public static class AESThenHMAC
  {
    private static readonly RandomNumberGenerator Random = RandomNumberGenerator.Create();

    //Preconfigured Encryption Parameters
    public static readonly int BlockBitSize = 128;
    public static readonly int KeyBitSize = 256;

    //Preconfigured Password Key Derivation Parameters
    public static readonly int SaltBitSize = 64;
    public static readonly int Iterations = 10000;
    public static readonly int MinPasswordLength = 12;

    /// <summary>
    /// Helper that generates a random key on each call.
    /// </summary>
    /// <returns></returns>
    public static byte[] NewKey()
    {
      var key = new byte[KeyBitSize / 8];
      Random.GetBytes(key);
      return key;
    }

    /// <summary>
    /// Simple Encryption (AES) then Authentication (HMAC) for a UTF8 Message.
    /// </summary>
    /// <param name="secretMessage">The secret message.</param>
    /// <param name="cryptKey">The crypt key.</param>
    /// <param name="authKey">The auth key.</param>
    /// <param name="nonSecretPayload">(Optional) Non-Secret Payload.</param>
    /// <returns>
    /// Encrypted Message
    /// </returns>
    /// <exception cref="System.ArgumentException">Secret Message Required!;secretMessage</exception>
    /// <remarks>
    /// Adds overhead of (Optional-Payload + BlockSize(16) + Message-Padded-To-Blocksize +  HMac-Tag(32)) * 1.33 Base64
    /// </remarks>
    public static string SimpleEncrypt(string secretMessage, byte[] cryptKey, byte[] authKey,
                       byte[] nonSecretPayload = null)
    {
      if (string.IsNullOrEmpty(secretMessage))
        throw new ArgumentException("Secret Message Required!", "secretMessage");

      var plainText = Encoding.UTF8.GetBytes(secretMessage);
      var cipherText = SimpleEncrypt(plainText, cryptKey, authKey, nonSecretPayload);
      return Convert.ToBase64String(cipherText);
    }

    /// <summary>
    /// Simple Authentication (HMAC) then Decryption (AES) for a secrets UTF8 Message.
    /// </summary>
    /// <param name="encryptedMessage">The encrypted message.</param>
    /// <param name="cryptKey">The crypt key.</param>
    /// <param name="authKey">The auth key.</param>
    /// <param name="nonSecretPayloadLength">Length of the non secret payload.</param>
    /// <returns>
    /// Decrypted Message
    /// </returns>
    /// <exception cref="System.ArgumentException">Encrypted Message Required!;encryptedMessage</exception>
    public static string SimpleDecrypt(string encryptedMessage, byte[] cryptKey, byte[] authKey,
                       int nonSecretPayloadLength = 0)
    {
      if (string.IsNullOrWhiteSpace(encryptedMessage))
        throw new ArgumentException("Encrypted Message Required!", "encryptedMessage");

      var cipherText = Convert.FromBase64String(encryptedMessage);
      var plainText = SimpleDecrypt(cipherText, cryptKey, authKey, nonSecretPayloadLength);
      return plainText == null ? null : Encoding.UTF8.GetString(plainText);
    }

    /// <summary>
    /// Simple Encryption (AES) then Authentication (HMAC) of a UTF8 message
    /// using Keys derived from a Password (PBKDF2).
    /// </summary>
    /// <param name="secretMessage">The secret message.</param>
    /// <param name="password">The password.</param>
    /// <param name="nonSecretPayload">The non secret payload.</param>
    /// <returns>
    /// Encrypted Message
    /// </returns>
    /// <exception cref="System.ArgumentException">password</exception>
    /// <remarks>
    /// Significantly less secure than using random binary keys.
    /// Adds additional non secret payload for key generation parameters.
    /// </remarks>
    public static string SimpleEncryptWithPassword(string secretMessage, string password,
                             byte[] nonSecretPayload = null)
    {
      if (string.IsNullOrEmpty(secretMessage))
        throw new ArgumentException("Secret Message Required!", "secretMessage");

      var plainText = Encoding.UTF8.GetBytes(secretMessage);
      var cipherText = SimpleEncryptWithPassword(plainText, password, nonSecretPayload);
      return Convert.ToBase64String(cipherText);
    }

    /// <summary>
    /// Simple Authentication (HMAC) and then Descryption (AES) of a UTF8 Message
    /// using keys derived from a password (PBKDF2). 
    /// </summary>
    /// <param name="encryptedMessage">The encrypted message.</param>
    /// <param name="password">The password.</param>
    /// <param name="nonSecretPayloadLength">Length of the non secret payload.</param>
    /// <returns>
    /// Decrypted Message
    /// </returns>
    /// <exception cref="System.ArgumentException">Encrypted Message Required!;encryptedMessage</exception>
    /// <remarks>
    /// Significantly less secure than using random binary keys.
    /// </remarks>
    public static string SimpleDecryptWithPassword(string encryptedMessage, string password,
                             int nonSecretPayloadLength = 0)
    {
      if (string.IsNullOrWhiteSpace(encryptedMessage))
        throw new ArgumentException("Encrypted Message Required!", "encryptedMessage");

      var cipherText = Convert.FromBase64String(encryptedMessage);
      var plainText = SimpleDecryptWithPassword(cipherText, password, nonSecretPayloadLength);
      return plainText == null ? null : Encoding.UTF8.GetString(plainText);
    }

    public static byte[] SimpleEncrypt(byte[] secretMessage, byte[] cryptKey, byte[] authKey, byte[] nonSecretPayload = null)
    {
      //User Error Checks
      if (cryptKey == null || cryptKey.Length != KeyBitSize / 8)
        throw new ArgumentException(String.Format("Key needs to be {0} bit!", KeyBitSize), "cryptKey");

      if (authKey == null || authKey.Length != KeyBitSize / 8)
        throw new ArgumentException(String.Format("Key needs to be {0} bit!", KeyBitSize), "authKey");

      if (secretMessage == null || secretMessage.Length < 1)
        throw new ArgumentException("Secret Message Required!", "secretMessage");

      //non-secret payload optional
      nonSecretPayload = nonSecretPayload ?? new byte[] { };

      byte[] cipherText;
      byte[] iv;

      using (var aes = new AesManaged
      {
        KeySize = KeyBitSize,
        BlockSize = BlockBitSize,
        Mode = CipherMode.CBC,
        Padding = PaddingMode.PKCS7
      })
      {

        //Use random IV
        aes.GenerateIV();
        iv = aes.IV;

        using (var encrypter = aes.CreateEncryptor(cryptKey, iv))
        using (var cipherStream = new MemoryStream())
        {
          using (var cryptoStream = new CryptoStream(cipherStream, encrypter, CryptoStreamMode.Write))
          using (var binaryWriter = new BinaryWriter(cryptoStream))
          {
            //Encrypt Data
            binaryWriter.Write(secretMessage);
          }

          cipherText = cipherStream.ToArray();
        }

      }

      //Assemble encrypted message and add authentication
      using (var hmac = new HMACSHA256(authKey))
      using (var encryptedStream = new MemoryStream())
      {
        using (var binaryWriter = new BinaryWriter(encryptedStream))
        {
          //Prepend non-secret payload if any
          binaryWriter.Write(nonSecretPayload);
          //Prepend IV
          binaryWriter.Write(iv);
          //Write Ciphertext
          binaryWriter.Write(cipherText);
          binaryWriter.Flush();

          //Authenticate all data
          var tag = hmac.ComputeHash(encryptedStream.ToArray());
          //Postpend tag
          binaryWriter.Write(tag);
        }
        return encryptedStream.ToArray();
      }

    }

    public static byte[] SimpleDecrypt(byte[] encryptedMessage, byte[] cryptKey, byte[] authKey, int nonSecretPayloadLength = 0)
    {

      //Basic Usage Error Checks
      if (cryptKey == null || cryptKey.Length != KeyBitSize / 8)
        throw new ArgumentException(String.Format("CryptKey needs to be {0} bit!", KeyBitSize), "cryptKey");

      if (authKey == null || authKey.Length != KeyBitSize / 8)
        throw new ArgumentException(String.Format("AuthKey needs to be {0} bit!", KeyBitSize), "authKey");

      if (encryptedMessage == null || encryptedMessage.Length == 0)
        throw new ArgumentException("Encrypted Message Required!", "encryptedMessage");

      using (var hmac = new HMACSHA256(authKey))
      {
        var sentTag = new byte[hmac.HashSize / 8];
        //Calculate Tag
        var calcTag = hmac.ComputeHash(encryptedMessage, 0, encryptedMessage.Length - sentTag.Length);
        var ivLength = (BlockBitSize / 8);

        //if message length is to small just return null
        if (encryptedMessage.Length < sentTag.Length + nonSecretPayloadLength + ivLength)
          return null;

        //Grab Sent Tag
        Array.Copy(encryptedMessage, encryptedMessage.Length - sentTag.Length, sentTag, 0, sentTag.Length);

        //Compare Tag with constant time comparison
        var compare = 0;
        for (var i = 0; i < sentTag.Length; i++)
          compare |= sentTag[i] ^ calcTag[i]; 

        //if message doesn't authenticate return null
        if (compare != 0)
          return null;

        using (var aes = new AesManaged
        {
          KeySize = KeyBitSize,
          BlockSize = BlockBitSize,
          Mode = CipherMode.CBC,
          Padding = PaddingMode.PKCS7
        })
        {

          //Grab IV from message
          var iv = new byte[ivLength];
          Array.Copy(encryptedMessage, nonSecretPayloadLength, iv, 0, iv.Length);

          using (var decrypter = aes.CreateDecryptor(cryptKey, iv))
          using (var plainTextStream = new MemoryStream())
          {
            using (var decrypterStream = new CryptoStream(plainTextStream, decrypter, CryptoStreamMode.Write))
            using (var binaryWriter = new BinaryWriter(decrypterStream))
            {
              //Decrypt Cipher Text from Message
              binaryWriter.Write(
                encryptedMessage,
                nonSecretPayloadLength + iv.Length,
                encryptedMessage.Length - nonSecretPayloadLength - iv.Length - sentTag.Length
              );
            }
            //Return Plain Text
            return plainTextStream.ToArray();
          }
        }
      }
    }

    public static byte[] SimpleEncryptWithPassword(byte[] secretMessage, string password, byte[] nonSecretPayload = null)
    {
      nonSecretPayload = nonSecretPayload ?? new byte[] {};

      //User Error Checks
      if (string.IsNullOrWhiteSpace(password) || password.Length < MinPasswordLength)
        throw new ArgumentException(String.Format("Must have a password of at least {0} characters!", MinPasswordLength), "password");

      if (secretMessage == null || secretMessage.Length ==0)
        throw new ArgumentException("Secret Message Required!", "secretMessage");

      var payload = new byte[((SaltBitSize / 8) * 2) + nonSecretPayload.Length];

      Array.Copy(nonSecretPayload, payload, nonSecretPayload.Length);
      int payloadIndex = nonSecretPayload.Length;

      byte[] cryptKey;
      byte[] authKey;
      //Use Random Salt to prevent pre-generated weak password attacks.
      using (var generator = new Rfc2898DeriveBytes(password, SaltBitSize / 8, Iterations))
      {
        var salt = generator.Salt;

        //Generate Keys
        cryptKey = generator.GetBytes(KeyBitSize / 8);

        //Create Non Secret Payload
        Array.Copy(salt, 0, payload, payloadIndex, salt.Length);
        payloadIndex += salt.Length;
      }

      //Deriving separate key, might be less efficient than using HKDF, 
      //but now compatible with RNEncryptor which had a very similar wireformat and requires less code than HKDF.
      using (var generator = new Rfc2898DeriveBytes(password, SaltBitSize / 8, Iterations))
      {
        var salt = generator.Salt;

        //Generate Keys
        authKey = generator.GetBytes(KeyBitSize / 8);

        //Create Rest of Non Secret Payload
        Array.Copy(salt, 0, payload, payloadIndex, salt.Length);
      }

      return SimpleEncrypt(secretMessage, cryptKey, authKey, payload);
    }

    public static byte[] SimpleDecryptWithPassword(byte[] encryptedMessage, string password, int nonSecretPayloadLength = 0)
    {
      //User Error Checks
      if (string.IsNullOrWhiteSpace(password) || password.Length < MinPasswordLength)
        throw new ArgumentException(String.Format("Must have a password of at least {0} characters!", MinPasswordLength), "password");

      if (encryptedMessage == null || encryptedMessage.Length == 0)
        throw new ArgumentException("Encrypted Message Required!", "encryptedMessage");

      var cryptSalt = new byte[SaltBitSize / 8];
      var authSalt = new byte[SaltBitSize / 8];

      //Grab Salt from Non-Secret Payload
      Array.Copy(encryptedMessage, nonSecretPayloadLength, cryptSalt, 0, cryptSalt.Length);
      Array.Copy(encryptedMessage, nonSecretPayloadLength + cryptSalt.Length, authSalt, 0, authSalt.Length);

      byte[] cryptKey;
      byte[] authKey;

      //Generate crypt key
      using (var generator = new Rfc2898DeriveBytes(password, cryptSalt, Iterations))
      {
        cryptKey = generator.GetBytes(KeyBitSize / 8);
      }
      //Generate auth key
      using (var generator = new Rfc2898DeriveBytes(password, authSalt, Iterations))
      {
        authKey = generator.GetBytes(KeyBitSize / 8);
      }

      return SimpleDecrypt(encryptedMessage, cryptKey, authKey, cryptSalt.Length + authSalt.Length + nonSecretPayloadLength);
    }
  }
} 
```

* * *

**充气城堡 AES-GCM [[要点]](https://gist.github.com/jbtule/4336842#file-aesgcm-cs)**

```
/*
 * This work (Modern Encryption of a String C#, by James Tuley), 
 * identified by James Tuley, is free of known copyright restrictions.
 * https://gist.github.com/4336842
 * http://creativecommons.org/publicdomain/mark/1.0/ 
 */

using System;
using System.IO;
using System.Text;
using Org.BouncyCastle.Crypto;
using Org.BouncyCastle.Crypto.Engines;
using Org.BouncyCastle.Crypto.Generators;
using Org.BouncyCastle.Crypto.Modes;
using Org.BouncyCastle.Crypto.Parameters;
using Org.BouncyCastle.Security;
namespace Encryption
{

  public static class AESGCM
  {
    private static readonly SecureRandom Random = new SecureRandom();

    //Preconfigured Encryption Parameters
    public static readonly int NonceBitSize = 128;
    public static readonly int MacBitSize = 128;
    public static readonly int KeyBitSize = 256;

    //Preconfigured Password Key Derivation Parameters
    public static readonly int SaltBitSize = 128;
    public static readonly int Iterations = 10000;
    public static readonly int MinPasswordLength = 12;

    /// <summary>
    /// Helper that generates a random new key on each call.
    /// </summary>
    /// <returns></returns>
    public static byte[] NewKey()
    {
      var key = new byte[KeyBitSize / 8];
      Random.NextBytes(key);
      return key;
    }

    /// <summary>
    /// Simple Encryption And Authentication (AES-GCM) of a UTF8 string.
    /// </summary>
    /// <param name="secretMessage">The secret message.</param>
    /// <param name="key">The key.</param>
    /// <param name="nonSecretPayload">Optional non-secret payload.</param>
    /// <returns>
    /// Encrypted Message
    /// </returns>
    /// <exception cref="System.ArgumentException">Secret Message Required!;secretMessage</exception>
    /// <remarks>
    /// Adds overhead of (Optional-Payload + BlockSize(16) + Message +  HMac-Tag(16)) * 1.33 Base64
    /// </remarks>
    public static string SimpleEncrypt(string secretMessage, byte[] key, byte[] nonSecretPayload = null)
    {
      if (string.IsNullOrEmpty(secretMessage))
        throw new ArgumentException("Secret Message Required!", "secretMessage");

      var plainText = Encoding.UTF8.GetBytes(secretMessage);
      var cipherText = SimpleEncrypt(plainText, key, nonSecretPayload);
      return Convert.ToBase64String(cipherText);
    }

    /// <summary>
    /// Simple Decryption & Authentication (AES-GCM) of a UTF8 Message
    /// </summary>
    /// <param name="encryptedMessage">The encrypted message.</param>
    /// <param name="key">The key.</param>
    /// <param name="nonSecretPayloadLength">Length of the optional non-secret payload.</param>
    /// <returns>Decrypted Message</returns>
    public static string SimpleDecrypt(string encryptedMessage, byte[] key, int nonSecretPayloadLength = 0)
    {
      if (string.IsNullOrEmpty(encryptedMessage))
        throw new ArgumentException("Encrypted Message Required!", "encryptedMessage");

      var cipherText = Convert.FromBase64String(encryptedMessage);
      var plainText = SimpleDecrypt(cipherText, key, nonSecretPayloadLength);
      return plainText == null ? null : Encoding.UTF8.GetString(plainText);
    }

    /// <summary>
    /// Simple Encryption And Authentication (AES-GCM) of a UTF8 String
    /// using key derived from a password (PBKDF2).
    /// </summary>
    /// <param name="secretMessage">The secret message.</param>
    /// <param name="password">The password.</param>
    /// <param name="nonSecretPayload">The non secret payload.</param>
    /// <returns>
    /// Encrypted Message
    /// </returns>
    /// <remarks>
    /// Significantly less secure than using random binary keys.
    /// Adds additional non secret payload for key generation parameters.
    /// </remarks>
    public static string SimpleEncryptWithPassword(string secretMessage, string password,
                             byte[] nonSecretPayload = null)
    {
      if (string.IsNullOrEmpty(secretMessage))
        throw new ArgumentException("Secret Message Required!", "secretMessage");

      var plainText = Encoding.UTF8.GetBytes(secretMessage);
      var cipherText = SimpleEncryptWithPassword(plainText, password, nonSecretPayload);
      return Convert.ToBase64String(cipherText);
    }

    /// <summary>
    /// Simple Decryption and Authentication (AES-GCM) of a UTF8 message
    /// using a key derived from a password (PBKDF2)
    /// </summary>
    /// <param name="encryptedMessage">The encrypted message.</param>
    /// <param name="password">The password.</param>
    /// <param name="nonSecretPayloadLength">Length of the non secret payload.</param>
    /// <returns>
    /// Decrypted Message
    /// </returns>
    /// <exception cref="System.ArgumentException">Encrypted Message Required!;encryptedMessage</exception>
    /// <remarks>
    /// Significantly less secure than using random binary keys.
    /// </remarks>
    public static string SimpleDecryptWithPassword(string encryptedMessage, string password,
                             int nonSecretPayloadLength = 0)
    {
      if (string.IsNullOrWhiteSpace(encryptedMessage))
        throw new ArgumentException("Encrypted Message Required!", "encryptedMessage");

      var cipherText = Convert.FromBase64String(encryptedMessage);
      var plainText = SimpleDecryptWithPassword(cipherText, password, nonSecretPayloadLength);
      return plainText == null ? null : Encoding.UTF8.GetString(plainText);
    }

    public static byte[] SimpleEncrypt(byte[] secretMessage, byte[] key, byte[] nonSecretPayload = null)
    {
      //User Error Checks
      if (key == null || key.Length != KeyBitSize / 8)
        throw new ArgumentException(String.Format("Key needs to be {0} bit!", KeyBitSize), "key");

      if (secretMessage == null || secretMessage.Length == 0)
        throw new ArgumentException("Secret Message Required!", "secretMessage");

      //Non-secret Payload Optional
      nonSecretPayload = nonSecretPayload ?? new byte[] { };

      //Using random nonce large enough not to repeat
      var nonce = new byte[NonceBitSize / 8];
      Random.NextBytes(nonce, 0, nonce.Length);

      var cipher = new GcmBlockCipher(new AesFastEngine());
      var parameters = new AeadParameters(new KeyParameter(key), MacBitSize, nonce, nonSecretPayload);
      cipher.Init(true, parameters);

      //Generate Cipher Text With Auth Tag
      var cipherText = new byte[cipher.GetOutputSize(secretMessage.Length)];
      var len = cipher.ProcessBytes(secretMessage, 0, secretMessage.Length, cipherText, 0);
      cipher.DoFinal(cipherText, len);

      //Assemble Message
      using (var combinedStream = new MemoryStream())
      {
        using (var binaryWriter = new BinaryWriter(combinedStream))
        {
          //Prepend Authenticated Payload
          binaryWriter.Write(nonSecretPayload);
          //Prepend Nonce
          binaryWriter.Write(nonce);
          //Write Cipher Text
          binaryWriter.Write(cipherText);
        }
        return combinedStream.ToArray();
      }
    }

    public static byte[] SimpleDecrypt(byte[] encryptedMessage, byte[] key, int nonSecretPayloadLength = 0)
    {
      //User Error Checks
      if (key == null || key.Length != KeyBitSize / 8)
        throw new ArgumentException(String.Format("Key needs to be {0} bit!", KeyBitSize), "key");

      if (encryptedMessage == null || encryptedMessage.Length == 0)
        throw new ArgumentException("Encrypted Message Required!", "encryptedMessage");

      using (var cipherStream = new MemoryStream(encryptedMessage))
      using (var cipherReader = new BinaryReader(cipherStream))
      {
        //Grab Payload
        var nonSecretPayload = cipherReader.ReadBytes(nonSecretPayloadLength);

        //Grab Nonce
        var nonce = cipherReader.ReadBytes(NonceBitSize / 8);

        var cipher = new GcmBlockCipher(new AesFastEngine());
        var parameters = new AeadParameters(new KeyParameter(key), MacBitSize, nonce, nonSecretPayload);
        cipher.Init(false, parameters);

        //Decrypt Cipher Text
        var cipherText = cipherReader.ReadBytes(encryptedMessage.Length - nonSecretPayloadLength - nonce.Length);
        var plainText = new byte[cipher.GetOutputSize(cipherText.Length)];  

        try
        {
          var len = cipher.ProcessBytes(cipherText, 0, cipherText.Length, plainText, 0);
          cipher.DoFinal(plainText, len);

        }
        catch (InvalidCipherTextException)
        {
          //Return null if it doesn't authenticate
          return null;
        }

        return plainText;
      }

    }

    public static byte[] SimpleEncryptWithPassword(byte[] secretMessage, string password, byte[] nonSecretPayload = null)
    {
      nonSecretPayload = nonSecretPayload ?? new byte[] {};

      //User Error Checks
      if (string.IsNullOrWhiteSpace(password) || password.Length < MinPasswordLength)
        throw new ArgumentException(String.Format("Must have a password of at least {0} characters!", MinPasswordLength), "password");

      if (secretMessage == null || secretMessage.Length == 0)
        throw new ArgumentException("Secret Message Required!", "secretMessage");

      var generator = new Pkcs5S2ParametersGenerator();

      //Use Random Salt to minimize pre-generated weak password attacks.
      var salt = new byte[SaltBitSize / 8];
      Random.NextBytes(salt);

      generator.Init(
        PbeParametersGenerator.Pkcs5PasswordToBytes(password.ToCharArray()),
        salt,
        Iterations);

      //Generate Key
      var key = (KeyParameter)generator.GenerateDerivedMacParameters(KeyBitSize);

      //Create Full Non Secret Payload
      var payload = new byte[salt.Length + nonSecretPayload.Length];
      Array.Copy(nonSecretPayload, payload, nonSecretPayload.Length);
      Array.Copy(salt,0, payload,nonSecretPayload.Length, salt.Length);

      return SimpleEncrypt(secretMessage, key.GetKey(), payload);
    }

    public static byte[] SimpleDecryptWithPassword(byte[] encryptedMessage, string password, int nonSecretPayloadLength = 0)
    {
      //User Error Checks
      if (string.IsNullOrWhiteSpace(password) || password.Length < MinPasswordLength)
        throw new ArgumentException(String.Format("Must have a password of at least {0} characters!", MinPasswordLength), "password");

      if (encryptedMessage == null || encryptedMessage.Length == 0)
        throw new ArgumentException("Encrypted Message Required!", "encryptedMessage");

      var generator = new Pkcs5S2ParametersGenerator();

      //Grab Salt from Payload
      var salt = new byte[SaltBitSize / 8];
      Array.Copy(encryptedMessage, nonSecretPayloadLength, salt, 0, salt.Length);

      generator.Init(
        PbeParametersGenerator.Pkcs5PasswordToBytes(password.ToCharArray()),
        salt,
        Iterations);

      //Generate Key
      var key = (KeyParameter)generator.GenerateDerivedMacParameters(KeyBitSize);

      return SimpleDecrypt(encryptedMessage, key.GetKey(), salt.Length + nonSecretPayloadLength);
    }
  }
} 
```

* * *

## 回答 #3

> 赞同：115
> 
> 时间：2008-10-14T17:27:30.083

Here is an example using RSA.

**Important:** There is a limit to the size of data you can encrypt with the RSA encryption, `KeySize - MinimumPadding`. *e.g. 256 bytes (assuming 2048 bit key) - 42 bytes (min OEAP padding) = 214 bytes (max plaintext size)*

Replace your_rsa_key with your RSA key.

```
var provider = new System.Security.Cryptography.RSACryptoServiceProvider();
provider.ImportParameters(your_rsa_key);

var encryptedBytes = provider.Encrypt(
    System.Text.Encoding.UTF8.GetBytes("Hello World!"), true);

string decryptedTest = System.Text.Encoding.UTF8.GetString(
    provider.Decrypt(encryptedBytes, true)); 
```

For more info, visit [MSDN - RSACryptoServiceProvider](http://msdn.microsoft.com/en-us/library/system.security.cryptography.rsacryptoserviceprovider.aspx)

* * *

## 回答 #4

> 赞同：55
> 
> 时间：2013-03-14T11:14:24.330

如果您使用的是 ASP.Net，您现在可以使用 .Net 4.0 及更高版本中的内置功能。

[System.Web.Security.MachineKey](http://msdn.microsoft.com/en-us/library/system.web.security.machinekey.aspx)

.Net 4.5 具有`MachineKey.Protect()`和`MachineKey.Unprotect()`.

.Net 4.0 具有`MachineKey.Encode()`和`MachineKey.Decode()`. 您应该将 MachineKeyProtection 设置为“全部”。

在 ASP.Net 之外，这个类似乎会在每次应用重启时生成一个新密钥，因此不起作用。快速浏览一下 ILSpy，在我看来，如果缺少相应的 app.settings，它会生成自己的默认值。因此，您实际上可以在 ASP.Net 之外进行设置。

我无法在 System.Web 命名空间之外找到非 ASP.Net 等效项。

* * *

## 回答 #5

> 赞同：48
> 
> 时间：2012-11-22T11:22:32.097

[BouncyCastle](http://www.bouncycastle.org/)是一个很棒的 .NET 加密库，它可以作为[Nuget](http://nuget.org/packages/BouncyCastle)包安装到您的项目中。与 System.Security.Cryptography 库中当前可用的内容相比，我更喜欢它。它在可用算法方面为您提供了更多选择，并为这些算法提供了更多模式。

这是一个实现[TwoFish](http://en.wikipedia.org/wiki/Twofish)的示例，它由[Bruce Schneier](http://en.wikipedia.org/wiki/Bruce_Schneier)（我们所有偏执狂的英雄）编写。它是一种对称算法，如 Rijndael（又名 AES）。它是 AES 标准的三个决赛入围者之一，也是 Bruce Schneier 编写的另一个著名算法 BlowFish 的兄弟。

bouncycastle 的第一件事是创建一个加密器类，这将更容易在库中实现其他分组密码。以下加密器类接受一个通用参数 T，其中 T 实现 IBlockCipher 并具有默认构造函数。

**更新：** 由于大众的需求，我决定实现生成随机 IV 并将 HMAC 包含到此类中。虽然从风格的角度来看，这违背了单一职责的 SOLID 原则，但由于这个类的性质，我拒绝了。这个类现在将采用两个通用参数，一个用于密码，一个用于摘要。它使用 RNGCryptoServiceProvider 自动生成 IV 以提供良好的 RNG 熵，并允许您使用来自 BouncyCastle 的任何摘要算法来生成 MAC。

```
using System;
using System.Security.Cryptography;
using System.Text;
using Org.BouncyCastle.Crypto;
using Org.BouncyCastle.Crypto.Macs;
using Org.BouncyCastle.Crypto.Modes;
using Org.BouncyCastle.Crypto.Paddings;
using Org.BouncyCastle.Crypto.Parameters;

public sealed class Encryptor<TBlockCipher, TDigest>
    where TBlockCipher : IBlockCipher, new()
    where TDigest : IDigest, new()
{
    private Encoding encoding;

    private IBlockCipher blockCipher;

    private BufferedBlockCipher cipher;

    private HMac mac;

    private byte[] key;

    public Encryptor(Encoding encoding, byte[] key, byte[] macKey)
    {
        this.encoding = encoding;
        this.key = key;
        this.Init(key, macKey, new Pkcs7Padding());
    }

    public Encryptor(Encoding encoding, byte[] key, byte[] macKey, IBlockCipherPadding padding)
    {
        this.encoding = encoding;
        this.key = key;
        this.Init(key, macKey, padding);
    }

    private void Init(byte[] key, byte[] macKey, IBlockCipherPadding padding)
    {
        this.blockCipher = new CbcBlockCipher(new TBlockCipher());
        this.cipher = new PaddedBufferedBlockCipher(this.blockCipher, padding);
        this.mac = new HMac(new TDigest());
        this.mac.Init(new KeyParameter(macKey));
    }

    public string Encrypt(string plain)
    {
        return Convert.ToBase64String(EncryptBytes(plain));
    }

    public byte[] EncryptBytes(string plain)
    {
        byte[] input = this.encoding.GetBytes(plain);

        var iv = this.GenerateIV();

        var cipher = this.BouncyCastleCrypto(true, input, new ParametersWithIV(new KeyParameter(key), iv));
        byte[] message = CombineArrays(iv, cipher);

        this.mac.Reset();
        this.mac.BlockUpdate(message, 0, message.Length);
        byte[] digest = new byte[this.mac.GetUnderlyingDigest().GetDigestSize()];
        this.mac.DoFinal(digest, 0);

        var result = CombineArrays(digest, message);
        return result;
    }

    public byte[] DecryptBytes(byte[] bytes)
    {
        // split the digest into component parts
        var digest = new byte[this.mac.GetUnderlyingDigest().GetDigestSize()];
        var message = new byte[bytes.Length - digest.Length];
        var iv = new byte[this.blockCipher.GetBlockSize()];
        var cipher = new byte[message.Length - iv.Length];

        Buffer.BlockCopy(bytes, 0, digest, 0, digest.Length);
        Buffer.BlockCopy(bytes, digest.Length, message, 0, message.Length);
        if (!IsValidHMac(digest, message))
        {
            throw new CryptoException();
        }

        Buffer.BlockCopy(message, 0, iv, 0, iv.Length);
        Buffer.BlockCopy(message, iv.Length, cipher, 0, cipher.Length);

        byte[] result = this.BouncyCastleCrypto(false, cipher, new ParametersWithIV(new KeyParameter(key), iv));
        return result;
    }

    public string Decrypt(byte[] bytes)
    {
        return this.encoding.GetString(DecryptBytes(bytes));
    }

    public string Decrypt(string cipher)
    {
        return this.Decrypt(Convert.FromBase64String(cipher));
    }

    private bool IsValidHMac(byte[] digest, byte[] message)
    {
        this.mac.Reset();
        this.mac.BlockUpdate(message, 0, message.Length);
        byte[] computed = new byte[this.mac.GetUnderlyingDigest().GetDigestSize()];
        this.mac.DoFinal(computed, 0);

        return AreEqual(digest,computed);
    }

    private static bool AreEqual(byte [] digest, byte[] computed)
    {
        if(digest.Length != computed.Length)
        {
            return false;
        }

        int result = 0;
        for (int i = 0; i < digest.Length; i++)
        {
            // compute equality of all bytes before returning.
            //   helps prevent timing attacks: 
            //   https://codahale.com/a-lesson-in-timing-attacks/
            result |= digest[i] ^ computed[i];
        }

        return result == 0;
    }

    private byte[] BouncyCastleCrypto(bool forEncrypt, byte[] input, ICipherParameters parameters)
    {
        try
        {
            cipher.Init(forEncrypt, parameters);

            return this.cipher.DoFinal(input);
        }
        catch (CryptoException)
        {
            throw;
        }
    }

    private byte[] GenerateIV()
    {
        using (var provider = new RNGCryptoServiceProvider())
        {
            // 1st block
            byte[] result = new byte[this.blockCipher.GetBlockSize()];
            provider.GetBytes(result);

            return result;
        }
    }

    private static byte[] CombineArrays(byte[] source1, byte[] source2)
    {
        byte[] result = new byte[source1.Length + source2.Length];
        Buffer.BlockCopy(source1, 0, result, 0, source1.Length);
        Buffer.BlockCopy(source2, 0, result, source1.Length, source2.Length);

        return result;
    }
} 
```

接下来只需调用新类的加密和解密方法，这里是使用 twofish 的示例：

```
var encrypt = new Encryptor<TwofishEngine, Sha1Digest>(Encoding.UTF8, key, hmacKey);

string cipher = encrypt.Encrypt("TEST");   
string plainText = encrypt.Decrypt(cipher); 
```

替换另一个分组密码（如 TripleDES）同样容易：

```
var des = new Encryptor<DesEdeEngine, Sha1Digest>(Encoding.UTF8, key, hmacKey);

string cipher = des.Encrypt("TEST");
string plainText = des.Decrypt(cipher); 
```

最后，如果您想将 AES 与 SHA256 HMAC 一起使用，您可以执行以下操作：

```
var aes = new Encryptor<AesEngine, Sha256Digest>(Encoding.UTF8, key, hmacKey);

cipher = aes.Encrypt("TEST");
plainText = aes.Decrypt(cipher); 
```

加密最难的部分实际上是处理密钥而不是算法。您必须考虑存储密钥的位置，以及如果必须，如何交换它们。这些算法都经受住了时间的考验，极难破解。想要从您那里窃取信息的人不会花费永恒的时间对您的消息进行密码分析，他们会试图找出您的密钥在哪里或在哪里。所以#1 明智地选择你的密钥，#2 将它们存储在一个安全的地方，如果你使用 web.config 和 IIS，那么你可以[加密 web.config 的部分](http://msdn.microsoft.com/en-us/library/dtkwfdky%28v=vs.100%29.aspx)，最后如果你必须交换密钥，请确保你的交换密钥的协议是安全的。

**更新 2** 更改了比较方法以减轻计时攻击。在此处查看更多信息[http://codahale.com/a-lesson-in-timing-attacks/](http://codahale.com/a-lesson-in-timing-attacks/)。还更新为默认为 PKCS7 填充并添加了新的构造函数以允许最终用户选择他们想要使用的填充。感谢@CodesInChaos 的建议。

* * *

## 回答 #6

> 赞同：24
> 
> 时间：2015-05-25T12:26:02.750

免责声明：此解决方案应仅用于不向公众公开的静态数据（例如 - 配置文件或数据库）。仅在这种情况下，由于维护成本较低，因此可以认为快速而肮脏的解决方案比 @jbtule 的解决方案更好。

原始帖子：我发现[jbtule](https://stackoverflow.com/a/10366194/188474)的答案对于快速和肮脏的安全 AES 字符串加密有点复杂，而[Brett](https://stackoverflow.com/a/2791259)的答案有一个错误，即初始化向量是一个固定值，使其容易受到填充攻击，所以我修复了 Brett 的代码和添加了一个随机IV，该IV被添加到经过切片的字符串中，从而为相同值的每次加密创建不同的加密值：

加密：

```
public static string Encrypt(string clearText)
{            
    byte[] clearBytes = Encoding.Unicode.GetBytes(clearText);
    using (Aes encryptor = Aes.Create())
    {
        byte[] IV = new byte[15];
        rand.NextBytes(IV);
        Rfc2898DeriveBytes pdb = new Rfc2898DeriveBytes(EncryptionKey, IV);
        encryptor.Key = pdb.GetBytes(32);
        encryptor.IV = pdb.GetBytes(16);
        using (MemoryStream ms = new MemoryStream())
        {
            using (CryptoStream cs = new CryptoStream(ms, encryptor.CreateEncryptor(), CryptoStreamMode.Write))
            {
                cs.Write(clearBytes, 0, clearBytes.Length);
                cs.Close();
            }
            clearText = Convert.ToBase64String(IV) + Convert.ToBase64String(ms.ToArray());
        }
    }
    return clearText;
} 
```

解密：

```
public static string Decrypt(string cipherText)
{
    byte[] IV = Convert.FromBase64String(cipherText.Substring(0, 20));
    cipherText = cipherText.Substring(20).Replace(" ", "+");
    byte[] cipherBytes = Convert.FromBase64String(cipherText);
    using (Aes encryptor = Aes.Create())
    {
        Rfc2898DeriveBytes pdb = new Rfc2898DeriveBytes(EncryptionKey, IV);
        encryptor.Key = pdb.GetBytes(32);
        encryptor.IV = pdb.GetBytes(16);
        using (MemoryStream ms = new MemoryStream())
        {
            using (CryptoStream cs = new CryptoStream(ms, encryptor.CreateDecryptor(), CryptoStreamMode.Write))
            {
                cs.Write(cipherBytes, 0, cipherBytes.Length);
                cs.Close();
            }
            cipherText = Encoding.Unicode.GetString(ms.ToArray());
        }
    }
    return cipherText;
} 
```

将 EncryptionKey 替换为您的密钥。在我的实现中，密钥保存在配置文件 (web.config\app.config) 中，因为您不应该将其保存为硬编码。配置文件也应该[加密](https://msdn.microsoft.com/en-us/library/zhhddkxy.aspx)，这样密钥就不会以明文形式保存在其中。

```
protected static string _Key = "";
protected static string EncryptionKey
{
    get
    {
        if (String.IsNullOrEmpty(_Key))
        {
            _Key = ConfigurationManager.AppSettings["AESKey"].ToString();
        }

        return _Key;
    }
} 
```

* * *

## 回答 #7

> 赞同：15
> 
> 时间：2015-02-19T11:22:03.297

加密

```
public string EncryptString(string inputString)
{
    MemoryStream memStream = null;
    try
    {
        byte[] key = { };
        byte[] IV = { 12, 21, 43, 17, 57, 35, 67, 27 };
        string encryptKey = "aXb2uy4z"; // MUST be 8 characters
        key = Encoding.UTF8.GetBytes(encryptKey);
        byte[] byteInput = Encoding.UTF8.GetBytes(inputString);
        DESCryptoServiceProvider provider = new DESCryptoServiceProvider();
        memStream = new MemoryStream();
        ICryptoTransform transform = provider.CreateEncryptor(key, IV);
        CryptoStream cryptoStream = new CryptoStream(memStream, transform, CryptoStreamMode.Write);
        cryptoStream.Write(byteInput, 0, byteInput.Length);
        cryptoStream.FlushFinalBlock();
    }
    catch (Exception ex)
    {
        Response.Write(ex.Message);
    }
    return Convert.ToBase64String(memStream.ToArray());
} 
```

解密：

```
public string DecryptString(string inputString)
{
    MemoryStream memStream = null;
    try
    {
        byte[] key = { };
        byte[] IV = { 12, 21, 43, 17, 57, 35, 67, 27 };
        string encryptKey = "aXb2uy4z"; // MUST be 8 characters
        key = Encoding.UTF8.GetBytes(encryptKey);
        byte[] byteInput = new byte[inputString.Length];
        byteInput = Convert.FromBase64String(inputString);
        DESCryptoServiceProvider provider = new DESCryptoServiceProvider();
        memStream = new MemoryStream();
        ICryptoTransform transform = provider.CreateDecryptor(key, IV);
        CryptoStream cryptoStream = new CryptoStream(memStream, transform, CryptoStreamMode.Write);
        cryptoStream.Write(byteInput, 0, byteInput.Length);
        cryptoStream.FlushFinalBlock();
    }
    catch (Exception ex)
    {
        Response.Write(ex.Message);
    }

    Encoding encoding1 = Encoding.UTF8;
    return encoding1.GetString(memStream.ToArray());
} 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2019-05-17T10:59:52.863

以下示例演示了如何加密和解密示例数据：

```
 // This constant is used to determine the keysize of the encryption algorithm in bits.
    // We divide this by 8 within the code below to get the equivalent number of bytes.
    private const int Keysize = 128;

    // This constant determines the number of iterations for the password bytes generation function.
    private const int DerivationIterations = 1000;

    public static string Encrypt(string plainText, string passPhrase)
    {
        // Salt and IV is randomly generated each time, but is preprended to encrypted cipher text
        // so that the same Salt and IV values can be used when decrypting.  
        var saltStringBytes = GenerateBitsOfRandomEntropy(16);
        var ivStringBytes = GenerateBitsOfRandomEntropy(16);
        var plainTextBytes = Encoding.UTF8.GetBytes(plainText);
        using (var password = new Rfc2898DeriveBytes(passPhrase, saltStringBytes, DerivationIterations))
        {
            var keyBytes = password.GetBytes(Keysize / 8);
            using (var symmetricKey = new RijndaelManaged())
            {
                symmetricKey.BlockSize = 128;
                symmetricKey.Mode = CipherMode.CBC;
                symmetricKey.Padding = PaddingMode.PKCS7;
                using (var encryptor = symmetricKey.CreateEncryptor(keyBytes, ivStringBytes))
                {
                    using (var memoryStream = new MemoryStream())
                    {
                        using (var cryptoStream = new CryptoStream(memoryStream, encryptor, CryptoStreamMode.Write))
                        {
                            cryptoStream.Write(plainTextBytes, 0, plainTextBytes.Length);
                            cryptoStream.FlushFinalBlock();
                            // Create the final bytes as a concatenation of the random salt bytes, the random iv bytes and the cipher bytes.
                            var cipherTextBytes = saltStringBytes;
                            cipherTextBytes = cipherTextBytes.Concat(ivStringBytes).ToArray();
                            cipherTextBytes = cipherTextBytes.Concat(memoryStream.ToArray()).ToArray();
                            memoryStream.Close();
                            cryptoStream.Close();
                            return Convert.ToBase64String(cipherTextBytes);
                        }
                    }
                }
            }
        }
    }

    public static string Decrypt(string cipherText, string passPhrase)
    {
        // Get the complete stream of bytes that represent:
        // [32 bytes of Salt] + [32 bytes of IV] + [n bytes of CipherText]
        var cipherTextBytesWithSaltAndIv = Convert.FromBase64String(cipherText);
        // Get the saltbytes by extracting the first 32 bytes from the supplied cipherText bytes.
        var saltStringBytes = cipherTextBytesWithSaltAndIv.Take(Keysize / 8).ToArray();
        // Get the IV bytes by extracting the next 32 bytes from the supplied cipherText bytes.
        var ivStringBytes = cipherTextBytesWithSaltAndIv.Skip(Keysize / 8).Take(Keysize / 8).ToArray();
        // Get the actual cipher text bytes by removing the first 64 bytes from the cipherText string.
        var cipherTextBytes = cipherTextBytesWithSaltAndIv.Skip((Keysize / 8) * 2).Take(cipherTextBytesWithSaltAndIv.Length - ((Keysize / 8) * 2)).ToArray();

        using (var password = new Rfc2898DeriveBytes(passPhrase, saltStringBytes, DerivationIterations))
        {
            var keyBytes = password.GetBytes(Keysize / 8);
            using (var symmetricKey = new RijndaelManaged())
            {
                symmetricKey.BlockSize = 128;
                symmetricKey.Mode = CipherMode.CBC;
                symmetricKey.Padding = PaddingMode.PKCS7;
                using (var decryptor = symmetricKey.CreateDecryptor(keyBytes, ivStringBytes))
                {
                    using (var memoryStream = new MemoryStream(cipherTextBytes))
                    {
                        using (var cryptoStream = new CryptoStream(memoryStream, decryptor, CryptoStreamMode.Read))
                        {
                            var plainTextBytes = new byte[cipherTextBytes.Length];
                            var decryptedByteCount = cryptoStream.Read(plainTextBytes, 0, plainTextBytes.Length);
                            memoryStream.Close();
                            cryptoStream.Close();
                            return Encoding.UTF8.GetString(plainTextBytes, 0, decryptedByteCount);
                        }
                    }
                }
            }
        }
    }

    private static byte[] GenerateBitsOfRandomEntropy(int size)
    {
        // 32 Bytes will give us 256 bits.
        // 16 Bytes will give us 128 bits.
        var randomBytes = new byte[size]; 
        using (var rngCsp = new RNGCryptoServiceProvider())
        {
            // Fill the array with cryptographically secure random bytes.
            rngCsp.GetBytes(randomBytes);
        }
        return randomBytes;
    } 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2017-02-04T18:18:56.190

参考[Encrypt and Decrypt a String in c#](https://social.msdn.microsoft.com/Forums/vstudio/en-US/d6a2836a-d587-4068-8630-94f4fb2a2aeb/encrypt-and-decrypt-a-string-in-c?forum=csharpgeneral)，我找到了一个很好的解决方案：

```
static readonly string PasswordHash = "P@@Sw0rd";
static readonly string SaltKey = "S@LT&KEY";
static readonly string VIKey = "@1B2c3D4e5F6g7H8"; 
```

用于加密

```
public static string Encrypt(string plainText)
{
    byte[] plainTextBytes = Encoding.UTF8.GetBytes(plainText);

    byte[] keyBytes = new Rfc2898DeriveBytes(PasswordHash, Encoding.ASCII.GetBytes(SaltKey)).GetBytes(256 / 8);
    var symmetricKey = new RijndaelManaged() { Mode = CipherMode.CBC, Padding = PaddingMode.Zeros };
    var encryptor = symmetricKey.CreateEncryptor(keyBytes, Encoding.ASCII.GetBytes(VIKey));

    byte[] cipherTextBytes;

    using (var memoryStream = new MemoryStream())
    {
        using (var cryptoStream = new CryptoStream(memoryStream, encryptor, CryptoStreamMode.Write))
        {
            cryptoStream.Write(plainTextBytes, 0, plainTextBytes.Length);
            cryptoStream.FlushFinalBlock();
            cipherTextBytes = memoryStream.ToArray();
            cryptoStream.Close();
        }
        memoryStream.Close();
    }
    return Convert.ToBase64String(cipherTextBytes);
} 
```

用于解密

```
public static string Decrypt(string encryptedText)
{
    byte[] cipherTextBytes = Convert.FromBase64String(encryptedText);
    byte[] keyBytes = new Rfc2898DeriveBytes(PasswordHash, Encoding.ASCII.GetBytes(SaltKey)).GetBytes(256 / 8);
    var symmetricKey = new RijndaelManaged() { Mode = CipherMode.CBC, Padding = PaddingMode.None };

    var decryptor = symmetricKey.CreateDecryptor(keyBytes, Encoding.ASCII.GetBytes(VIKey));
    var memoryStream = new MemoryStream(cipherTextBytes);
    var cryptoStream = new CryptoStream(memoryStream, decryptor, CryptoStreamMode.Read);
    byte[] plainTextBytes = new byte[cipherTextBytes.Length];

    int decryptedByteCount = cryptoStream.Read(plainTextBytes, 0, plainTextBytes.Length);
    memoryStream.Close();
    cryptoStream.Close();
    return Encoding.UTF8.GetString(plainTextBytes, 0, decryptedByteCount).TrimEnd("\0".ToCharArray());
} 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2016-08-19T08:30:14.897

支持[mattmanser 回答](https://stackoverflow.com/a/15407665/991459)。这是一个使用 MachineKey 类加密/解密 URL 安全值的示例。

需要记住的是，如前所述，这将使用机器配置设置 ( [https://msdn.microsoft.com/en-us/library/ff649308.aspx](https://msdn.microsoft.com/en-us/library/ff649308.aspx) )。您可以在 web.config 文件中手动设置加密和解密密钥/算法（如果您的站点在多个服务器上运行，您可能特别需要此设置）。您可以从 IIS 生成密钥（请参见此处：[https ://blogs.msdn.microsoft.com/vijaysk/2009/05/13/iis-7-tip-10-you-can-generate-machine-keys-from- the-iis-manager/](https://blogs.msdn.microsoft.com/vijaysk/2009/05/13/iis-7-tip-10-you-can-generate-machine-keys-from-the-iis-manager/)）或可以使用在线机器密钥生成器，例如：http: [//www.developerfusion.com/tools/generatemachinekey/](http://www.developerfusion.com/tools/generatemachinekey/)

```
 private static readonly UTF8Encoding Encoder = new UTF8Encoding();

    public static string Encrypt(string unencrypted)
    {
        if (string.IsNullOrEmpty(unencrypted)) 
            return string.Empty;

        try
        {
            var encryptedBytes = MachineKey.Protect(Encoder.GetBytes(unencrypted));

            if (encryptedBytes != null && encryptedBytes.Length > 0)
                return HttpServerUtility.UrlTokenEncode(encryptedBytes);    
        }
        catch (Exception)
        {
            return string.Empty;
        }

        return string.Empty;
    }

    public static string Decrypt(string encrypted)
    {
        if (string.IsNullOrEmpty(encrypted)) 
            return string.Empty;

        try
        {
            var bytes = HttpServerUtility.UrlTokenDecode(encrypted);
            if (bytes != null && bytes.Length > 0)
            {
                var decryptedBytes = MachineKey.Unprotect(bytes);
                if(decryptedBytes != null && decryptedBytes.Length > 0)
                    return Encoder.GetString(decryptedBytes);
            }

        }
        catch (Exception)
        {
            return string.Empty;
        }

        return string.Empty;
    } 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2014-06-25T06:23:12.653

这是一个使用 AES CBC 模式使用随机 IV 和 HMAC 以及密码派生密钥在 C# 中加密字符串的简单示例，以显示基本的移动部分：

```
private byte[] EncryptBytes(byte[] key, byte[] plaintext)
{
    using (var cipher = new RijndaelManaged { Key = key })
    {
        using (var encryptor = cipher.CreateEncryptor())
        {
            var ciphertext = encryptor.TransformFinalBlock(plaintext, 0, plaintext.Length);

            // IV is prepended to ciphertext
            return cipher.IV.Concat(ciphertext).ToArray();
        }
    }
}

private byte[] DecryptBytes(byte[] key, byte[] packed)
{
    using (var cipher = new RijndaelManaged { Key = key })
    {
        int ivSize = cipher.BlockSize / 8;

        cipher.IV = packed.Take(ivSize).ToArray();

        using (var encryptor = cipher.CreateDecryptor())
        {
            return encryptor.TransformFinalBlock(packed, ivSize, packed.Length - ivSize);
        }
    }
}

private byte[] AddMac(byte[] key, byte[] data)
{
    using (var hmac = new HMACSHA256(key))
    {
        var macBytes = hmac.ComputeHash(data);

        // HMAC is appended to data
        return data.Concat(macBytes).ToArray();
    }
}

private bool BadMac(byte[] found, byte[] computed)
{
    int mismatch = 0;

    // Aim for consistent timing regardless of inputs
    for (int i = 0; i < found.Length; i++)
    {
        mismatch += found[i] == computed[i] ? 0 : 1;
    }

    return mismatch != 0;
}

private byte[] RemoveMac(byte[] key, byte[] data)
{
    using (var hmac = new HMACSHA256(key))
    {
        int macSize = hmac.HashSize / 8;

        var packed = data.Take(data.Length - macSize).ToArray();

        var foundMac = data.Skip(packed.Length).ToArray();

        var computedMac = hmac.ComputeHash(packed);

        if (this.BadMac(foundMac, computedMac))
        {
            throw new Exception("Bad MAC");
        }

        return packed;
    }            
}

private List<byte[]> DeriveTwoKeys(string password)
{
    var salt = new byte[] { 1, 2, 3, 4, 5, 6, 7, 8 };

    var kdf = new Rfc2898DeriveBytes(password, salt, 10000);

    var bytes = kdf.GetBytes(32); // Two keys 128 bits each

    return new List<byte[]> { bytes.Take(16).ToArray(), bytes.Skip(16).ToArray() };
}

public byte[] EncryptString(string password, String message)
{
    var keys = this.DeriveTwoKeys(password);

    var plaintext = Encoding.UTF8.GetBytes(message);

    var packed = this.EncryptBytes(keys[0], plaintext);

    return this.AddMac(keys[1], packed);
}

public String DecryptString(string password, byte[] secret)
{
    var keys = this.DeriveTwoKeys(password);

    var packed = this.RemoveMac(keys[1], secret);

    var plaintext = this.DecryptBytes(keys[0], packed);

    return Encoding.UTF8.GetString(plaintext);
}

public void Example()
{
    var password = "correcthorsebatterystaple";

    var secret = this.EncryptString(password, "Hello World");

    Console.WriteLine("secret: " + BitConverter.ToString(secret));

    var recovered = this.DecryptString(password, secret);

    Console.WriteLine(recovered);
} 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2019-05-07T13:30:12.327

以下代码是 Ghazal对类似[问题的](https://stackoverflow.com/q/10168240/5407188)[回答](https://stackoverflow.com/a/27484425/5407188)的改进版本。

```
public class EncryptionHelper
{
    private Aes aesEncryptor;

    public EncryptionHelper()
    {
    }

    private void BuildAesEncryptor(string key)
    {
        aesEncryptor = Aes.Create();
        var pdb = new Rfc2898DeriveBytes(key, new byte[] { 0x49, 0x76, 0x61, 0x6e, 0x20, 0x4d, 0x65, 0x64, 0x76, 0x65, 0x64, 0x65, 0x76 });
        aesEncryptor.Key = pdb.GetBytes(32);
        aesEncryptor.IV = pdb.GetBytes(16);
    }

    public string EncryptString(string clearText, string key)
    {
        BuildAesEncryptor(key);
        var clearBytes = Encoding.Unicode.GetBytes(clearText);
        using (var ms = new MemoryStream())
        {
            using (var cs = new CryptoStream(ms, aesEncryptor.CreateEncryptor(), CryptoStreamMode.Write))
            {
                cs.Write(clearBytes, 0, clearBytes.Length);
            }
            var encryptedText = Convert.ToBase64String(ms.ToArray());
            return encryptedText;
        }
    }

    public string DecryptString(string cipherText, string key)
    {
        BuildAesEncryptor(key);
        cipherText = cipherText.Replace(" ", "+");
        var cipherBytes = Convert.FromBase64String(cipherText);
        using (var ms = new MemoryStream())
        {
            using (var cs = new CryptoStream(ms, aesEncryptor.CreateDecryptor(), CryptoStreamMode.Write))
            {
                cs.Write(cipherBytes, 0, cipherBytes.Length);
            }
            var clearText = Encoding.Unicode.GetString(ms.ToArray());
            return clearText;
        }
    }
} 
```

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2017-01-04T23:15:09.827

[用于AES-GCM](https://bitbeans.gitbooks.io/libsodium-net/content/advanced/aes256_gcm.html)加密的BouncyCastle的替代方案是[libsodium-net](https://github.com/adamcaudill/libsodium-net)。它包装了 libsodium C 库。一个很好的优势是它使用 CPU 中的 AES-NI 扩展来进行非常快速的加密。不利的一面是，如果 CPU 没有扩展，它将根本无法工作。没有软件回退。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2013-10-01T20:12:16.917

这是布雷特放在这里的课程。但是，由于在将 URL 字符串用于加密和解密时收到错误“Base-64 字符数组的长度无效”，因此我做了一些修改。

```
public class CryptoURL
{
    private static byte[] _salt = Encoding.ASCII.GetBytes("Catto_Salt_Enter_Any_Value99");

    /// <summary>
    /// Encrypt the given string using AES.  The string can be decrypted using 
    /// DecryptStringAES().  The sharedSecret parameters must match. 
    /// The SharedSecret for the Password Reset that is used is in the next line
    ///  string sharedSecret = "OneUpSharedSecret9";
    /// </summary>
    /// <param name="plainText">The text to encrypt.</param>
    /// <param name="sharedSecret">A password used to generate a key for encryption.</param>
    public static string EncryptString(string plainText, string sharedSecret)
    {
        if (string.IsNullOrEmpty(plainText))
            throw new ArgumentNullException("plainText");
        if (string.IsNullOrEmpty(sharedSecret))
            throw new ArgumentNullException("sharedSecret");

        string outStr = null;                       // Encrypted string to return
        RijndaelManaged aesAlg = null;              // RijndaelManaged object used to encrypt the data.

        try
        {
            // generate the key from the shared secret and the salt
            Rfc2898DeriveBytes key = new Rfc2898DeriveBytes(sharedSecret, _salt);

            // Create a RijndaelManaged object
            aesAlg = new RijndaelManaged();
            aesAlg.Key = key.GetBytes(aesAlg.KeySize / 8);

            // Create a decryptor to perform the stream transform.
            ICryptoTransform encryptor = aesAlg.CreateEncryptor(aesAlg.Key, aesAlg.IV);

            // Create the streams used for encryption.
            using (MemoryStream msEncrypt = new MemoryStream())
            {
                // prepend the IV
                msEncrypt.Write(BitConverter.GetBytes(aesAlg.IV.Length), 0, sizeof(int));
                msEncrypt.Write(aesAlg.IV, 0, aesAlg.IV.Length);
                using (CryptoStream csEncrypt = new CryptoStream(msEncrypt, encryptor, CryptoStreamMode.Write))
                {
                    using (StreamWriter swEncrypt = new StreamWriter(csEncrypt))
                    {
                        //Write all data to the stream.
                        swEncrypt.Write(plainText);
                    }
                }

                outStr = HttpServerUtility.UrlTokenEncode(msEncrypt.ToArray());
                //outStr = Convert.ToBase64String(msEncrypt.ToArray());
                // you may need to add a reference. right click reference in solution explorer => "add Reference" => .NET tab => select "System.Web"
            }
        }
        finally
        {
            // Clear the RijndaelManaged object.
            if (aesAlg != null)
                aesAlg.Clear();
        }

        // Return the encrypted bytes from the memory stream.
        return outStr;
    }

    /// <summary>
    /// Decrypt the given string.  Assumes the string was encrypted using 
    /// EncryptStringAES(), using an identical sharedSecret.
    /// </summary>
    /// <param name="cipherText">The text to decrypt.</param>
    /// <param name="sharedSecret">A password used to generate a key for decryption.</param>
    public static string DecryptString(string cipherText, string sharedSecret)
    {
        if (string.IsNullOrEmpty(cipherText))
            throw new ArgumentNullException("cipherText");
        if (string.IsNullOrEmpty(sharedSecret))
            throw new ArgumentNullException("sharedSecret");

        // Declare the RijndaelManaged object
        // used to decrypt the data.
        RijndaelManaged aesAlg = null;

        // Declare the string used to hold
        // the decrypted text.
        string plaintext = null;

        byte[] inputByteArray;

        try
        {
            // generate the key from the shared secret and the salt
            Rfc2898DeriveBytes key = new Rfc2898DeriveBytes(sharedSecret, _salt);

            // Create the streams used for decryption.                
            //byte[] bytes = Convert.FromBase64String(cipherText);
            inputByteArray = HttpServerUtility.UrlTokenDecode(cipherText);

            using (MemoryStream msDecrypt = new MemoryStream(inputByteArray))
            {
                // Create a RijndaelManaged object
                // with the specified key and IV.
                aesAlg = new RijndaelManaged();
                aesAlg.Key = key.GetBytes(aesAlg.KeySize / 8);
                // Get the initialization vector from the encrypted stream
                aesAlg.IV = ReadByteArray(msDecrypt);
                // Create a decrytor to perform the stream transform.
                ICryptoTransform decryptor = aesAlg.CreateDecryptor(aesAlg.Key, aesAlg.IV);
                using (CryptoStream csDecrypt = new CryptoStream(msDecrypt, decryptor, CryptoStreamMode.Read))
                {
                    using (StreamReader srDecrypt = new StreamReader(csDecrypt))

                        // Read the decrypted bytes from the decrypting stream
                        // and place them in a string.
                        plaintext = srDecrypt.ReadToEnd();
                }
            }
        }
        catch (System.Exception ex)
        {
            return "ERROR";
            //throw ex;

        }
        finally
        {
            // Clear the RijndaelManaged object.
            if (aesAlg != null)
                aesAlg.Clear();
        }

        return plaintext;
    }

    static string ConvertStringArrayToString(string[] array)
    {
        //
        // Concatenate all the elements into a StringBuilder.
        //
        StringBuilder builder = new StringBuilder();
        foreach (string value in array)
        {
            builder.Append(value);
            builder.Append('.');
        }
        return builder.ToString();
    }

    private static byte[] ReadByteArray(Stream s)
    {
        byte[] rawLength = new byte[sizeof(int)];
        if (s.Read(rawLength, 0, rawLength.Length) != rawLength.Length)
        {
            throw new SystemException("Stream did not contain properly formatted byte array");
        }

        byte[] buffer = new byte[BitConverter.ToInt32(rawLength, 0)];
        if (s.Read(buffer, 0, buffer.Length) != buffer.Length)
        {
            throw new SystemException("Did not read byte array properly");
        }

        return buffer;
    }

} 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2018-10-10T21:05:38.677

```
using System;
using System.IO;
using System.Security.Cryptography;
using System.Text;

public class Program
{
    public static void Main()
    {
        var key = Encoding.UTF8.GetBytes("SUkbqO2ycDo7QwpR25kfgmC7f8CoyrZy");
        var data = Encoding.UTF8.GetBytes("testData");

        //Encrypt data
        var encrypted = CryptoHelper.EncryptData(data,key);

        //Decrypt data
        var decrypted = CryptoHelper.DecryptData(encrypted,key);

        //Display result
        Console.WriteLine(Encoding.UTF8.GetString(decrypted));
    }
}

public static class CryptoHelper
{
    public static byte[] EncryptData(byte[] data, byte[] key)
    {
        using (var aesAlg = Aes.Create())
        {
            aesAlg.Mode = CipherMode.CBC;
            using (var encryptor = aesAlg.CreateEncryptor(key, aesAlg.IV))
            {
                using (var msEncrypt = new MemoryStream())
                {
                    msEncrypt.Write(aesAlg.IV, 0, aesAlg.IV.Length);

                    using (var csEncrypt = new CryptoStream(msEncrypt, encryptor, CryptoStreamMode.Write))
                        csEncrypt.Write(data, 0, data.Length);

                    return msEncrypt.ToArray();
                }
            }
        }

    }

    public static byte[] DecryptData(byte[] encrypted, byte[] key)
    {
        var iv = new byte[16];
        Buffer.BlockCopy(encrypted, 0, iv, 0, iv.Length);
        using (var aesAlg = Aes.Create())
        {
            aesAlg.Mode = CipherMode.CBC;
            using (var decryptor = aesAlg.CreateDecryptor(key, iv))
            {
                using (var msDecrypt = new MemoryStream(encrypted, iv.Length, encrypted.Length - iv.Length))
                {
                    using (var csDecrypt = new CryptoStream(msDecrypt, decryptor, CryptoStreamMode.Read))
                    {
                        using (var resultStream = new MemoryStream())
                        {
                            csDecrypt.CopyTo(resultStream);
                            return resultStream.ToArray();
                        }
                    }
                }
            }
        }
    }
} 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2016-10-26T09:19:28.607

加密是编程中非常常见的事情。我认为最好安装一个包来为你完成任务。也许是一个简单的开源 NuGet 项目，例如 [Simple Aes Encryption](https://github.com/ArtisanCode/SimpleAesEncryption)

关键在配置文件中，因此在生产环境中很容易更改，我没有看到任何缺点。

```
<MessageEncryption>
  <EncryptionKey KeySize="256" Key="3q2+796tvu/erb7v3q2+796tvu/erb7v3q2+796tvu8="/>
</MessageEncryption> 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2019-06-03T09:52:12.450

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Security.Cryptography;
using System.IO;
using System.Text;  

/// <summary>
/// Summary description for Encryption
/// </summary>
public class Encryption
{
    public TripleDES CreateDES(string key)
    {
        MD5 md5 = new MD5CryptoServiceProvider();
        TripleDES des = new TripleDESCryptoServiceProvider();
        des.Key = md5.ComputeHash(Encoding.Unicode.GetBytes(key));
        des.IV = new byte[des.BlockSize / 8];
        return des;
    }
    public  byte[] Encryptiondata(string PlainText)
    {
        TripleDES des = CreateDES("DreamMLMKey");
        ICryptoTransform ct = des.CreateEncryptor();
        byte[] input = Encoding.Unicode.GetBytes(PlainText);
        return ct.TransformFinalBlock(input, 0, input.Length);
    }

    public string Decryptiondata(string CypherText)
    {
        string stringToDecrypt = CypherText.Replace(" ", "+");
        int len = stringToDecrypt.Length;
        byte[] inputByteArray = Convert.FromBase64String(stringToDecrypt); 

        byte[] b = Convert.FromBase64String(CypherText);
        TripleDES des = CreateDES("DreamMLMKey");
        ICryptoTransform ct = des.CreateDecryptor();
        byte[] output = ct.TransformFinalBlock(b, 0, b.Length);
        return Encoding.Unicode.GetString(output);
    }
    public string Decryptiondataurl(string CypherText)
    {
        string newcyperttext=CypherText.Replace(' ', '+');
        byte[] b = Convert.FromBase64String(newcyperttext);
        TripleDES des = CreateDES("DreamMLMKey");
        ICryptoTransform ct = des.CreateDecryptor();
        byte[] output = ct.TransformFinalBlock(b, 0, b.Length);
        return Encoding.Unicode.GetString(output);
    }

    #region  encryption & Decription
    public  string Encrypt(string input, string key)
    {
        byte[] inputArray = UTF8Encoding.UTF8.GetBytes(input);
        TripleDESCryptoServiceProvider tripleDES = new TripleDESCryptoServiceProvider();
        tripleDES.Key = UTF8Encoding.UTF8.GetBytes(key);
        tripleDES.Mode = CipherMode.ECB;
        tripleDES.Padding = PaddingMode.PKCS7;
        ICryptoTransform cTransform = tripleDES.CreateEncryptor();
        byte[] resultArray = cTransform.TransformFinalBlock(inputArray, 0, inputArray.Length);
        tripleDES.Clear();
        return Convert.ToBase64String(resultArray, 0, resultArray.Length);
    }
    public  string Decrypt(string input, string key)
    {
        byte[] inputArray = Convert.FromBase64String(input);
        TripleDESCryptoServiceProvider tripleDES = new TripleDESCryptoServiceProvider();
        tripleDES.Key = UTF8Encoding.UTF8.GetBytes(key);
        tripleDES.Mode = CipherMode.ECB;
        tripleDES.Padding = PaddingMode.PKCS7;
        ICryptoTransform cTransform = tripleDES.CreateDecryptor();
        byte[] resultArray = cTransform.TransformFinalBlock(inputArray, 0, inputArray.Length);
        tripleDES.Clear();
        return UTF8Encoding.UTF8.GetString(resultArray);
    }

    public string encrypt(string encryptString)
    {
        string EncryptionKey = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ";
        byte[] clearBytes = Encoding.Unicode.GetBytes(encryptString);
        using (Aes encryptor = Aes.Create())
        {
            Rfc2898DeriveBytes pdb = new Rfc2898DeriveBytes(EncryptionKey, new byte[] {
                0x49, 0x76, 0x61, 0x6e, 0x20, 0x4d, 0x65, 0x64, 0x76, 0x65, 0x64, 0x65, 0x76
            });
            encryptor.Key = pdb.GetBytes(32);
            encryptor.IV = pdb.GetBytes(16);
            using (MemoryStream ms = new MemoryStream())
            {
                using (CryptoStream cs = new CryptoStream(ms, encryptor.CreateEncryptor(), CryptoStreamMode.Write))
                {
                    cs.Write(clearBytes, 0, clearBytes.Length);
                    cs.Close();
                }
                encryptString = Convert.ToBase64String(ms.ToArray());
            }
        }
        return encryptString;
    }

    public string Decrypt(string cipherText)
    {
        string EncryptionKey = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ";
        cipherText = cipherText.Replace(" ", "+");
        byte[] cipherBytes = Convert.FromBase64String(cipherText);
        using (Aes encryptor = Aes.Create())
        {
            Rfc2898DeriveBytes pdb = new Rfc2898DeriveBytes(EncryptionKey, new byte[] {
                0x49, 0x76, 0x61, 0x6e, 0x20, 0x4d, 0x65, 0x64, 0x76, 0x65, 0x64, 0x65, 0x76
            });
            encryptor.Key = pdb.GetBytes(32);
            encryptor.IV = pdb.GetBytes(16);
            using (MemoryStream ms = new MemoryStream())
            {
                using (CryptoStream cs = new CryptoStream(ms, encryptor.CreateDecryptor(), CryptoStreamMode.Write))
                {
                    cs.Write(cipherBytes, 0, cipherBytes.Length);
                    cs.Close();
                }
                cipherText = Encoding.Unicode.GetString(ms.ToArray());
            }
        }
        return cipherText;
    }

    #endregion
} 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2014-12-17T06:46:17.743

这是最初由 ASP Snippets 提供的简单代码段

```
using System.Text;
using System.Security.Cryptography;
using System.IO;

 private string Encrypt(string clearText)
    {
        string EncryptionKey = "yourkey";
        byte[] clearBytes = Encoding.Unicode.GetBytes(clearText);
        using (Aes encryptor = Aes.Create())
        {
            Rfc2898DeriveBytes pdb = new Rfc2898DeriveBytes(EncryptionKey, new byte[] { 0x49, 0x76, 0x61, 0x6e, 0x20, 0x4d, 0x65, 0x64, 0x76, 0x65, 0x64, 0x65, 0x76 });
            encryptor.Key = pdb.GetBytes(32);
            encryptor.IV = pdb.GetBytes(16);
            using (MemoryStream ms = new MemoryStream())
            {
                using (CryptoStream cs = new CryptoStream(ms, encryptor.CreateEncryptor(), CryptoStreamMode.Write))
                {
                    cs.Write(clearBytes, 0, clearBytes.Length);
                    cs.Close();
                }
                clearText = Convert.ToBase64String(ms.ToArray());
            }
        }
        return clearText;
    }

 private string Decrypt(string cipherText)
    {
        string EncryptionKey = "yourkey";
        cipherText = cipherText.Replace(" ", "+");
        byte[] cipherBytes = Convert.FromBase64String(cipherText);
        using (Aes encryptor = Aes.Create())
        {
            Rfc2898DeriveBytes pdb = new Rfc2898DeriveBytes(EncryptionKey, new byte[] { 0x49, 0x76, 0x61, 0x6e, 0x20, 0x4d, 0x65, 0x64, 0x76, 0x65, 0x64, 0x65, 0x76 });
            encryptor.Key = pdb.GetBytes(32);
            encryptor.IV = pdb.GetBytes(16);
            using (MemoryStream ms = new MemoryStream())
            {
                using (CryptoStream cs = new CryptoStream(ms, encryptor.CreateDecryptor(), CryptoStreamMode.Write))
                {
                    cs.Write(cipherBytes, 0, cipherBytes.Length);
                    cs.Close();
                }
                cipherText = Encoding.Unicode.GetString(ms.ToArray());
            }
        }
        return cipherText;
    } 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2014-10-22T23:03:36.543

从类似的问题中复制了我的[答案：](https://stackoverflow.com/a/26518496/134761) [Simple two-way encryption for C#](https://stackoverflow.com/q/165808/134761)。

基于多个答案和评论。

*   加密文本前面的随机初始化向量 (@jbtule)
*   使用 TransformFinalBlock() 而不是 MemoryStream (@RenniePet)
*   没有预先填写的密钥，以避免任何人复制和粘贴灾难
*   正确配置和使用模式

代码：

```
/// <summary>
/// Simple encryption/decryption using a random initialization vector
/// and prepending it to the crypto text.
/// </summary>
/// <remarks>Based on multiple answers in https://stackoverflow.com/questions/165808/simple-two-way-encryption-for-c-sharp </remarks>
public class SimpleAes : IDisposable
{
    /// <summary>
    ///     Initialization vector length in bytes.
    /// </summary>
    private const int IvBytes = 16;

    /// <summary>
    ///     Must be exactly 16, 24 or 32 characters long.
    /// </summary>
    private static readonly byte[] Key = Convert.FromBase64String("FILL ME WITH 16, 24 OR 32 CHARS");

    private readonly UTF8Encoding _encoder;
    private readonly ICryptoTransform _encryptor;
    private readonly RijndaelManaged _rijndael;

    public SimpleAes()
    {
        _rijndael = new RijndaelManaged {Key = Key};
        _rijndael.GenerateIV();
        _encryptor = _rijndael.CreateEncryptor();
        _encoder = new UTF8Encoding();
    }

    public string Decrypt(string encrypted)
    {
        return _encoder.GetString(Decrypt(Convert.FromBase64String(encrypted)));
    }

    public void Dispose()
    {
        _rijndael.Dispose();
        _encryptor.Dispose();
    }

    public string Encrypt(string unencrypted)
    {
        return Convert.ToBase64String(Encrypt(_encoder.GetBytes(unencrypted)));
    }

    private byte[] Decrypt(byte[] buffer)
    {
        // IV is prepended to cryptotext
        byte[] iv = buffer.Take(IvBytes).ToArray();
        using (ICryptoTransform decryptor = _rijndael.CreateDecryptor(_rijndael.Key, iv))
        {
            return decryptor.TransformFinalBlock(buffer, IvBytes, buffer.Length - IvBytes);
        }
    }

    private byte[] Encrypt(byte[] buffer)
    {
        // Prepend cryptotext with IV
        byte[] inputBuffer = _rijndael.IV.Concat(buffer).ToArray();
        return _encryptor.TransformFinalBlock(inputBuffer, IvBytes, buffer.Length);
    }
} 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2016-05-25T06:45:26.613

AES算法：

```
public static class CryptographyProvider
    {
        public static string EncryptString(string plainText, out string Key)
        {
            if (plainText == null || plainText.Length <= 0)
                throw new ArgumentNullException("plainText");

            using (Aes _aesAlg = Aes.Create())
            {
                Key = Convert.ToBase64String(_aesAlg.Key);
                ICryptoTransform _encryptor = _aesAlg.CreateEncryptor(_aesAlg.Key, _aesAlg.IV);

                using (MemoryStream _memoryStream = new MemoryStream())
                {
                    _memoryStream.Write(_aesAlg.IV, 0, 16);
                    using (CryptoStream _cryptoStream = new CryptoStream(_memoryStream, _encryptor, CryptoStreamMode.Write))
                    {
                        using (StreamWriter _streamWriter = new StreamWriter(_cryptoStream))
                        {
                            _streamWriter.Write(plainText);
                        }
                        return Convert.ToBase64String(_memoryStream.ToArray());
                    }
                }
            }
        }
        public static string DecryptString(string cipherText, string Key)
        {

            if (string.IsNullOrEmpty(cipherText))
                throw new ArgumentNullException("cipherText");
            if (string.IsNullOrEmpty(Key))
                throw new ArgumentNullException("Key");

            string plaintext = null;

            byte[] _initialVector = new byte[16];
            byte[] _Key = Convert.FromBase64String(Key);
            byte[] _cipherTextBytesArray = Convert.FromBase64String(cipherText);
            byte[] _originalString = new byte[_cipherTextBytesArray.Length - 16];

            Array.Copy(_cipherTextBytesArray, 0, _initialVector, 0, _initialVector.Length);
            Array.Copy(_cipherTextBytesArray, 16, _originalString, 0, _cipherTextBytesArray.Length - 16);

            using (Aes _aesAlg = Aes.Create())
            {
                _aesAlg.Key = _Key;
                _aesAlg.IV = _initialVector;
                ICryptoTransform decryptor = _aesAlg.CreateDecryptor(_aesAlg.Key, _aesAlg.IV);

                using (MemoryStream _memoryStream = new MemoryStream(_originalString))
                {
                    using (CryptoStream _cryptoStream = new CryptoStream(_memoryStream, decryptor, CryptoStreamMode.Read))
                    {
                        using (StreamReader _streamReader = new StreamReader(_cryptoStream))
                        {
                            plaintext = _streamReader.ReadToEnd();
                        }
                    }
                }
            }
            return plaintext;
        }
    } 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2019-10-16T17:13:01.567

很好的例子，如何使用[PGPCore](https://www.nuget.org/packages/PgpCore/1.2.0)和 BouncyCastle，非常简单的解决方案： [https ://blog.bitscry.com/2018/07/05/pgp-encryption-and-decryption-in-c/](https://blog.bitscry.com/2018/07/05/pgp-encryption-and-decryption-in-c/)

我尝试了不同的解决方案，但这对我来说效果最好，有些有错误，但这对我来说是完美的。

```
using (PGP pgp = new PGP())
{
// Generate keys
pgp.GenerateKey(@"C:\TEMP\keys\public.asc", @"C:\TEMP\keys\private.asc", "email@email.com", "password");
// Encrypt file
pgp.EncryptFile(@"C:\TEMP\keys\content.txt", @"C:\TEMP\keys\content__encrypted.pgp", @"C:\TEMP\keys\public.asc", true, true);
// Encrypt and sign file
pgp.EncryptFileAndSign(@"C:\TEMP\keys\content.txt", @"C:\TEMP\keys\content__encrypted_signed.pgp", @"C:\TEMP\keys\public.asc", @"C:\TEMP\keys\private.asc", "password", true, true);
// Decrypt file
pgp.DecryptFile(@"C:\TEMP\keys\content__encrypted.pgp", @"C:\TEMP\keys\content__decrypted.txt", @"C:\TEMP\keys\private.asc", "password");
// Decrypt signed file
pgp.DecryptFile(@"C:\TEMP\keys\content__encrypted_signed.pgp", @"C:\TEMP\keys\content__decrypted_signed.txt", @"C:\TEMP\keys\private.asc", "password");

// Encrypt stream
using (FileStream inputFileStream = new FileStream(@"C:\TEMP\keys\content.txt", FileMode.Open))
using (Stream outputFileStream = File.Create(@"C:\TEMP\keys\content__encrypted2.pgp"))
using (Stream publicKeyStream = new FileStream(@"C:\TEMP\keys\public.asc", FileMode.Open))
    pgp.EncryptStream(inputFileStream, outputFileStream, publicKeyStream, true, true);

// Decrypt stream
using (FileStream inputFileStream = new FileStream(@"C:\TEMP\keys\content__encrypted2.pgp", FileMode.Open))
using (Stream outputFileStream = File.Create(@"C:\TEMP\keys\content__decrypted2.txt"))
using (Stream privateKeyStream = new FileStream(@"C:\TEMP\keys\private.asc", FileMode.Open))
    pgp.DecryptStream(inputFileStream, outputFileStream, privateKeyStream, "password");
} 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2018-10-11T07:31:01.237

[这是](https://github.com/lukemerrett/Bouncy-Castle-AES-GCM-Encryption/blob/master/Cryptography/EncryptionService.cs)如何使用 Bouncy castle 包完成 AES-GCM 加密/解密的示例。

当我在谷歌上搜索从 GOlang `crypto/aes`api 解密数据的可能性时，我发现了该示例：

```
const (
    gcmBlockSize         = 16 // this is key size
    gcmTagSize           = 16 // this is mac
    gcmStandardNonceSize = 12 // this is nonce
)

func encrypt(data []byte, passphrase string) []byte {
    block, _ := aes.NewCipher([]byte(createHash(passphrase)))
    gcm, err := cipher.NewGCM(block)
    if err != nil {
        panic(err.Error())
    }
    nonce := make([]byte, gcm.NonceSize())
    if _, err = io.ReadFull(rand.Reader, nonce); err != nil {
        panic(err.Error())
    }
    ciphertext := gcm.Seal(nonce, nonce, data, nil)
    return ciphertext
} 
```

.Net 示例就像一个带有密钥（256 位）、mac（128 位）和 nonce（96 位）的魅力。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2020-06-24T02:13:34.847

[我有一个名为X509Crypto](http://www.x509crypto.org)的开源项目，它利用证书来加密和解密字符串。它非常易于使用。以下是如何使用它的示例：

**1\. 使用[X509Crypto 命令行界面](https://github.com/MikeBrunoCISSP/x509Crypto/tree/master/zip)(CLI) 生成新的加密证书和密钥对**

```
>x509crypto.exe
X509Crypto> makecert -context user -keysize medium -alias myvault

Certificate with thumbprint B31FE7E7AE5229F8186782742CF579197FA859FD was added to X509Alias "myvault" in the user X509Context

X509Crypto> 
```

**2\. 使用**Encrypt** CLI 命令为您的新 X509Alias 添加密码**

```
X509Crypto> encrypt -text -alias myvault -context user -secret apikey -in "80EAF03248965AC2B78090"

Secret apikey has been added to X509Alias myvault in the user X509Context

X509Crypto> 
```

**3\. 在你的程序中引用秘密**

一旦你建立了一个*X509Alias*并添加了你的秘密，在安装了 Org.X509Crypto nuget 包的程序中检索它们是微不足道的：

```
using Org.X509Crypto;

namespace SampleApp
{
    class Program
    {
        static void Main(string[] args)
        {
            var Alias = new X509Alias(@"myvault", X509Context.UserReadOnly);
            var apiKey = Alias.RecoverSecret(@"apikey");
        }
    }
} 
```

* * *

## 回答 #24

> 赞同：-2
> 
> 时间：2014-04-23T13:08:10.607

为简单起见，我为自己制作了这个用于非加密目的的功能：将“yourpassphrase”替换为您的密码......

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Security.Cryptography;
using System.IO;

 namespace My
{
    public class strCrypto
    {
        // This constant string is used as a "salt" value for the PasswordDeriveBytes function calls.
    // This size of the IV (in bytes) must = (keysize / 8).  Default keysize is 256, so the IV must be
    // 32 bytes long.  Using a 16 character string here gives us 32 bytes when converted to a byte array.
    private const string initVector = "r5dm5fgm24mfhfku";
    private const string passPhrase = "yourpassphrase"; // email password encryption password

    // This constant is used to determine the keysize of the encryption algorithm.
    private const int keysize = 256;

    public static string encryptString(string plainText)
    {
        //if the plaintext  is empty or null string just return an empty string
        if (plainText == "" || plainText == null )
        {
            return "";
        }

        byte[] initVectorBytes = Encoding.UTF8.GetBytes(initVector);
        byte[] plainTextBytes = Encoding.UTF8.GetBytes(plainText);
        PasswordDeriveBytes password = new PasswordDeriveBytes(passPhrase, null);
        byte[] keyBytes = password.GetBytes(keysize / 8);
        RijndaelManaged symmetricKey = new RijndaelManaged();
        symmetricKey.Mode = CipherMode.CBC;
        ICryptoTransform encryptor = symmetricKey.CreateEncryptor(keyBytes, initVectorBytes);
        MemoryStream memoryStream = new MemoryStream();
        CryptoStream cryptoStream = new CryptoStream(memoryStream, encryptor, CryptoStreamMode.Write);
        cryptoStream.Write(plainTextBytes, 0, plainTextBytes.Length);
        cryptoStream.FlushFinalBlock();
        byte[] cipherTextBytes = memoryStream.ToArray();
        memoryStream.Close();
        cryptoStream.Close();
        return Convert.ToBase64String(cipherTextBytes);
    }

    public static string decryptString(string cipherText)
    {
        //if the ciphertext is empty or null string just return an empty string
        if (cipherText == "" || cipherText == null )
        {
            return "";
        }

        byte[] initVectorBytes = Encoding.ASCII.GetBytes(initVector);
        byte[] cipherTextBytes = Convert.FromBase64String(cipherText);
        PasswordDeriveBytes password = new PasswordDeriveBytes(passPhrase, null);
        byte[] keyBytes = password.GetBytes(keysize / 8);
        RijndaelManaged symmetricKey = new RijndaelManaged();
        symmetricKey.Mode = CipherMode.CBC;
        ICryptoTransform decryptor = symmetricKey.CreateDecryptor(keyBytes, initVectorBytes);
        MemoryStream memoryStream = new MemoryStream(cipherTextBytes);
        CryptoStream cryptoStream = new CryptoStream(memoryStream, decryptor, CryptoStreamMode.Read);
        byte[] plainTextBytes = new byte[cipherTextBytes.Length];
        int decryptedByteCount = cryptoStream.Read(plainTextBytes, 0, plainTextBytes.Length);
        memoryStream.Close();
        cryptoStream.Close();
        return Encoding.UTF8.GetString(plainTextBytes, 0, decryptedByteCount);
    }

} 
```

}

* * *

## 回答 #25

> 赞同：-2
> 
> 时间：2014-04-08T10:33:50.383

```
 using System;
            using System.Collections.Generic;
            using System.Text;
            using System.Text.RegularExpressions;  // This is for password validation
            using System.Security.Cryptography;
            using System.Configuration;  // This is where the hash functions reside

            namespace BullyTracker.Common
            {
                public class HashEncryption
                {
                    //public string GenerateHashvalue(string thisPassword)
                    //{
                    //    MD5CryptoServiceProvider md5 = new MD5CryptoServiceProvider();
                    //    byte[] tmpSource;
                    //    byte[] tmpHash;

                    //    tmpSource = ASCIIEncoding.ASCII.GetBytes(thisPassword); // Turn password into byte array
                    //    tmpHash = md5.ComputeHash(tmpSource);

                    //    StringBuilder sOutput = new StringBuilder(tmpHash.Length);
                    //    for (int i = 0; i < tmpHash.Length; i++)
                    //    {
                    //        sOutput.Append(tmpHash[i].ToString("X2"));  // X2 formats to hexadecimal
                    //    }
                    //    return sOutput.ToString();
                    //}
                    //public Boolean VerifyHashPassword(string thisPassword, string thisHash)
                    //{
                    //    Boolean IsValid = false;
                    //    string tmpHash = GenerateHashvalue(thisPassword); // Call the routine on user input
                    //    if (tmpHash == thisHash) IsValid = true;  // Compare to previously generated hash
                    //    return IsValid;
                    //}
                    public string GenerateHashvalue(string toEncrypt, bool useHashing)
                    {
                        byte[] keyArray;
                        byte[] toEncryptArray = UTF8Encoding.UTF8.GetBytes(toEncrypt);

                        System.Configuration.AppSettingsReader settingsReader = new AppSettingsReader();
                        // Get the key from config file
                        string key = (string)settingsReader.GetValue("SecurityKey", typeof(String));
                        //System.Windows.Forms.MessageBox.Show(key);
                        if (useHashing)
                        {
                            MD5CryptoServiceProvider hashmd5 = new MD5CryptoServiceProvider();
                            keyArray = hashmd5.ComputeHash(UTF8Encoding.UTF8.GetBytes(key));
                            hashmd5.Clear();
                        }
                        else
                            keyArray = UTF8Encoding.UTF8.GetBytes(key);

                        TripleDESCryptoServiceProvider tdes = new TripleDESCryptoServiceProvider();
                        tdes.Key = keyArray;
                        tdes.Mode = CipherMode.ECB;
                        tdes.Padding = PaddingMode.PKCS7;

                        ICryptoTransform cTransform = tdes.CreateEncryptor();
                        byte[] resultArray = cTransform.TransformFinalBlock(toEncryptArray, 0, toEncryptArray.Length);
                        tdes.Clear();
                        return Convert.ToBase64String(resultArray, 0, resultArray.Length);
                    }
                    /// <summary>
                    /// DeCrypt a string using dual encryption method. Return a DeCrypted clear string
                    /// </summary>
                    /// <param name="cipherString">encrypted string</param>
                    /// <param name="useHashing">Did you use hashing to encrypt this data? pass true is yes</param>
                    /// <returns></returns>
                    public string Decrypt(string cipherString, bool useHashing)
                    {
                        byte[] keyArray;
                        byte[] toEncryptArray = Convert.FromBase64String(cipherString);

                        System.Configuration.AppSettingsReader settingsReader = new AppSettingsReader();
                        //Get your key from config file to open the lock!
                        string key = (string)settingsReader.GetValue("SecurityKey", typeof(String));

                        if (useHashing)
                        {
                            MD5CryptoServiceProvider hashmd5 = new MD5CryptoServiceProvider();
                            keyArray = hashmd5.ComputeHash(UTF8Encoding.UTF8.GetBytes(key));
                            hashmd5.Clear();
                        }
                        else
                            keyArray = UTF8Encoding.UTF8.GetBytes(key);

                        TripleDESCryptoServiceProvider tdes = new TripleDESCryptoServiceProvider();
                        tdes.Key = keyArray;
                        tdes.Mode = CipherMode.ECB;
                        tdes.Padding = PaddingMode.PKCS7;

                        ICryptoTransform cTransform = tdes.CreateDecryptor();
                        byte[] resultArray = cTransform.TransformFinalBlock(toEncryptArray, 0, toEncryptArray.Length);

                        tdes.Clear();
                        return UTF8Encoding.UTF8.GetString(resultArray);
                    }

                }

            } 
```

* * *

## 回答 #26

> 赞同：-4
> 
> 时间：2011-04-01T06:37:58.467

```
using System;
using System.Data;
using System.Configuration;
using System.Text;
using System.Security.Cryptography;

namespace Encription
{
    class CryptorEngine
    {
        public static string Encrypt(string ToEncrypt, bool useHasing)
        {
            byte[] keyArray;
            byte[] toEncryptArray = UTF8Encoding.UTF8.GetBytes(ToEncrypt);
            //System.Configuration.AppSettingsReader settingsReader = new     AppSettingsReader();
           string Key = "Bhagwati";
            if (useHasing)
            {
                MD5CryptoServiceProvider hashmd5 = new MD5CryptoServiceProvider();
                keyArray = hashmd5.ComputeHash(UTF8Encoding.UTF8.GetBytes(Key));
                hashmd5.Clear();  
            }
            else
            {
                keyArray = UTF8Encoding.UTF8.GetBytes(Key);
            }
            TripleDESCryptoServiceProvider tDes = new TripleDESCryptoServiceProvider();
            tDes.Key = keyArray;
            tDes.Mode = CipherMode.ECB;
            tDes.Padding = PaddingMode.PKCS7;
            ICryptoTransform cTransform = tDes.CreateEncryptor();
            byte[] resultArray = cTransform.TransformFinalBlock(toEncryptArray, 0,     toEncryptArray.Length);
            tDes.Clear();
            return Convert.ToBase64String(resultArray, 0, resultArray.Length);
        }
        public static string Decrypt(string cypherString, bool useHasing)
        {
            byte[] keyArray;
            byte[] toDecryptArray = Convert.FromBase64String(cypherString);
            //byte[] toEncryptArray = Convert.FromBase64String(cypherString);
            //System.Configuration.AppSettingsReader settingReader = new     AppSettingsReader();
            string key = "Bhagwati";
            if (useHasing)
            {
                MD5CryptoServiceProvider hashmd = new MD5CryptoServiceProvider();
                keyArray = hashmd.ComputeHash(UTF8Encoding.UTF8.GetBytes(key));
                hashmd.Clear();
            }
            else
            {
                keyArray = UTF8Encoding.UTF8.GetBytes(key);
            }
            TripleDESCryptoServiceProvider tDes = new TripleDESCryptoServiceProvider();
            tDes.Key = keyArray;
            tDes.Mode = CipherMode.ECB;
            tDes.Padding = PaddingMode.PKCS7;
            ICryptoTransform cTransform = tDes.CreateDecryptor();
            try
            {
                byte[] resultArray = cTransform.TransformFinalBlock(toDecryptArray, 0,         toDecryptArray.Length);

                tDes.Clear();
                return UTF8Encoding.UTF8.GetString(resultArray,0,resultArray.Length);
            }
            catch (Exception ex)
            {
                throw ex;
             }
        }
    }
} 
```

* * *

## 回答 #27

> 赞同：-4
> 
> 时间：2012-08-25T13:22:43.377

`Rfc2898DeriveBytes`我想用我的 AES 代码（[这里](http://msdn.microsoft.com/en-us/library/system.security.cryptography.rfc2898derivebytes.aspx)是文档）algorhytm给你我的贡献，用C#（.NET 框架 4）编写，并且也完全适用于有限的平台，如 Windows Phone 7.0+ 的 .NET Compact Framework（不是全部平台支持 .NET 框架的所有加密方法！）。

我希望这可以帮助任何人！

```
using System;
using System.IO;
using System.Security.Cryptography;
using System.Text;

public static class Crypto
{
    private static readonly byte[] IVa = new byte[] { 0x0b, 0x0c, 0x0d, 0x0e, 0x0f, 0x11, 0x11, 0x12, 0x13, 0x14, 0x0e, 0x16, 0x17 };

    public static string Encrypt(this string text, string salt)
    {
        try
        {
            using (Aes aes = new AesManaged())
            {
                Rfc2898DeriveBytes deriveBytes = new Rfc2898DeriveBytes(Encoding.UTF8.GetString(IVa, 0, IVa.Length), Encoding.UTF8.GetBytes(salt));
                aes.Key = deriveBytes.GetBytes(128 / 8);
                aes.IV = aes.Key;
                using (MemoryStream encryptionStream = new MemoryStream())
                {
                    using (CryptoStream encrypt = new CryptoStream(encryptionStream, aes.CreateEncryptor(), CryptoStreamMode.Write))
                    {
                        byte[] cleanText = Encoding.UTF8.GetBytes(text);
                        encrypt.Write(cleanText, 0, cleanText.Length);
                        encrypt.FlushFinalBlock();
                    }

                    byte[] encryptedData = encryptionStream.ToArray();
                    string encryptedText = Convert.ToBase64String(encryptedData);

                    return encryptedText;
                }
            }
        }
        catch
        {
            return String.Empty;
        }
    }

    public static string Decrypt(this string text, string salt)
    {
        try
        {
            using (Aes aes = new AesManaged())
            {
                Rfc2898DeriveBytes deriveBytes = new Rfc2898DeriveBytes(Encoding.UTF8.GetString(IVa, 0, IVa.Length), Encoding.UTF8.GetBytes(salt));
                aes.Key = deriveBytes.GetBytes(128 / 8);
                aes.IV = aes.Key;

                using (MemoryStream decryptionStream = new MemoryStream())
                {
                    using (CryptoStream decrypt = new CryptoStream(decryptionStream, aes.CreateDecryptor(), CryptoStreamMode.Write))
                    {
                        byte[] encryptedData = Convert.FromBase64String(text);

                        decrypt.Write(encryptedData, 0, encryptedData.Length);
                        decrypt.Flush();
                    }

                    byte[] decryptedData = decryptionStream.ToArray();
                    string decryptedText = Encoding.UTF8.GetString(decryptedData, 0, decryptedData.Length);

                    return decryptedText;
                }
            }
        }
        catch
        {
            return String.Empty;
        }
        }
    }
} 
```

* * *

## 回答 #28

> 赞同：-5
> 
> 时间：2014-12-01T07:16:25.143

您必须使用 System.Security.Cryptography 来使用命名空间；并且 useHashing 是一个布尔类型，无论是真还是假。加密和解密的字符串变量“key”应该相同

```
//Encryption
public string EncryptText(string toEncrypt, bool useHashing)
    {
        try
        {
            byte[] keyArray;
            byte[] toEncryptArray = UTF8Encoding.UTF8.GetBytes(toEncrypt);

            string key = "String Key Value"; //Based on this key stirng is encrypting
            //System.Windows.Forms.MessageBox.Show(key);
            //If hashing use get hashcode regards to your key
            if (useHashing)
            {
                MD5CryptoServiceProvider hashmd5 = new MD5CryptoServiceProvider();
                keyArray = hashmd5.ComputeHash(UTF8Encoding.UTF8.GetBytes(key));
                //Always release the resources and flush data
                //of the Cryptographic service provide. Best Practice

                hashmd5.Clear();
            }
            else
                keyArray = UTF8Encoding.UTF8.GetBytes(key);

            TripleDESCryptoServiceProvider tdes = new TripleDESCryptoServiceProvider();
            //set the secret key for the tripleDES algorithm
            tdes.Key = keyArray;
            //mode of operation. there are other 4 modes. We choose ECB(Electronic code Book)
            tdes.Mode = CipherMode.ECB;
            //padding mode(if any extra byte added)
            tdes.Padding = PaddingMode.PKCS7;

            ICryptoTransform cTransform = tdes.CreateEncryptor();
            //transform the specified region of bytes array to resultArray
            byte[] resultArray = cTransform.TransformFinalBlock(toEncryptArray, 0,          toEncryptArray.Length);
            //Release resources held by TripleDes Encryptor
            tdes.Clear();
            //Return the encrypted data into unreadable string format
            return Convert.ToBase64String(resultArray, 0, resultArray.Length);
        }
        catch (Exception e)
        {
            throw e;
        }
    }

    //Decryption
    public string DecryptText(string cipherString, bool useHashing)
    {

        try
        {
            byte[] keyArray;
            //get the byte code of the string

            byte[] toEncryptArray = Convert.FromBase64String(cipherString);

            string key = "String Key Value"; //Based on this key string is decrypted

            if (useHashing)
            {
                //if hashing was used get the hash code with regards to your key
                MD5CryptoServiceProvider hashmd5 = new MD5CryptoServiceProvider();
                keyArray = hashmd5.ComputeHash(UTF8Encoding.UTF8.GetBytes(key));
                //release any resource held by the MD5CryptoServiceProvider

                hashmd5.Clear();
            }
            else
            {
                //if hashing was not implemented get the byte code of the key
                keyArray = UTF8Encoding.UTF8.GetBytes(key);
            }

            TripleDESCryptoServiceProvider tdes = new TripleDESCryptoServiceProvider();
            //set the secret key for the tripleDES algorithm
            tdes.Key = keyArray;
            //mode of operation. there are other 4 modes.
            //We choose ECB(Electronic code Book)

            tdes.Mode = CipherMode.ECB;
            //padding mode(if any extra byte added)
            tdes.Padding = PaddingMode.PKCS7;

            ICryptoTransform cTransform = tdes.CreateDecryptor();
            byte[] resultArray = cTransform.TransformFinalBlock
                    (toEncryptArray, 0, toEncryptArray.Length);
            //Release resources held by TripleDes Encryptor
            tdes.Clear();
            //return the Clear decrypted TEXT
            return UTF8Encoding.UTF8.GetString(resultArray);
        }
        catch (Exception ex)
        {
            throw ex;
        }
    } 
```

* * *

## 回答 #29

> 赞同：-5
> 
> 时间：2015-05-07T07:30:09.330

安全散列数据的一个很好的算法是[BCrypt](http://en.wikipedia.org/wiki/Bcrypt)：

> 除了加入盐来防止彩虹表攻击之外，bcrypt 还是一个自适应函数：随着时间的推移，可以增加迭代次数以使其变慢，因此即使计算能力增加，它仍然可以抵抗暴力搜索攻击。

有一个很好[的 BCrypt .NET 实现，](https://github.com/BcryptNet/bcrypt.net)也可以[作为 NuGet 包](https://www.nuget.org/packages/BCrypt.Net-Next/)使用。

# c# - ClickOnce 和独立存储

> ID：202013
> 
> 赞同：10
> 
> 时间：2008-10-14T17:08:07.907
> 
> 标签：c#, winforms, .net-2.0, clickonce, isolatedstorage

Winform 应用程序在我们的 Intranet 中随 ClickOnce 一起发布。我们将个人对 GUI 的偏好存储在独立存储中。一切都很好:)

问题是当我们有一个新版本的应用程序时，我们发布......所有的偏好都丢失了！用户需要在每个版本上设置他们的偏好。

有没有办法冻结整个应用程序而不是版本的隔离？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-10-22T19:32:03.277

您需要使用*应用程序*范围，而不是*域*范围的隔离存储。这可以通过使用**IsolatedStorageFileStream 的**重载构造函数之一来完成。

例子：

```
using System.IO;
using System.IO.IsolatedStorage;
...

IsolatedStorageFile appScope = IsolatedStorageFile.GetUserStoreForApplication();    
using(IsolatedStorageFileStream fs = new IsolatedStorageFileStream("data.dat", FileMode.OpenOrCreate, appScope))
{
... 
```

但是，现在您将遇到此代码仅在通过 ClickOnce 启动应用程序时才有效的问题，因为那是应用程序范围的隔离存储唯一可用的时间。如果您不通过 ClickOnce 启动（例如通过 Visual Studio），**GetUserStoreForApplication()**将引发异常。

解决*此*问题的方法是在尝试使用应用程序范围的隔离存储之前确保**AppDomain.CurrentDomain.ActivationContext不为空。**

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-14T17:25:44.393

不久前，我正在开发 ClickOnce 应用程序并使用 Environment.GetFolderPath(ApplicationData) - 例如漫游应用程序数据文件夹来存储所有设置。工作正常，并在众多更新中幸存下来。只需使用您的应用名称或 CompanyName/AppName 或其他名称创建一个子目录，然后将所有内容存储在其中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-12-07T11:34:36.687

其他答案的摘要：

```
IsolatedStorageFile isolatedStorage = IsolatedStorageFile.GetUserStoreForAssembly();//for visual studio
if (System.Deployment.Application.ApplicationDeployment.IsNetwor‌​kDeployed)
{
    isolatedStorage = IsolatedStorageFile.GetUserStoreForApplication();//for click once applications
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-14T17:12:44.620

您必须将用户设置的永久版本存储在更持久的存储中，例如数据库。如果可用，您的应用程序可以决定使用隔离存储。如果它不可用（因为新版本），应用程序应该从数据库中获取设置并使用它来重新初始化隔离存储中的设置。如果设置更改，您应该更新这两个地方。除非有更新版本的应用程序，否则您的应用程序不必从数据库获取设置。

# windows - 在 Windows 服务中使用 SHFileOperation

> ID：202031
> 
> 赞同：2
> 
> 时间：2008-10-14T17:13:20.393
> 
> 标签：windows, winapi, service, shell32

这是可能的，但在 Windows 服务中使用 SHFileOperation 是否合适？shell32.dll 中的所有这些 SHxxx API 函数似乎都是在考虑用户级程序的情况下编写的。我可以确定 SHFileOperation 永远不会显示 GUI 吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-14T19:36:10.510

根据[SHFILEOPTSTRUCT](http://msdn.microsoft.com/en-us/library/bb759795%28VS.85%29.aspx)文档，您可以使用以下标志来防止出现任何 UI：

```
FOF_SILENT | FOF_NOCONFIRMATION | FOF_NOERRORUI | FOF_NOCONFIRMMKDIR 
```

或（如果您的目标是 Windows Vista），`FOF_NO_UI`与上述相同。

查看`ShellAPI.h`Windows SDK 中的头文件，评论`FOF_NO_UI`说“根本不显示任何 UI”，因此我认为可以使用`SHFileOperation`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-14T17:24:21.040

我会说，这不是不合适或不可取的。大多数 shell32 API 都是在基本理解的情况下编写的，即它们将用于交互过程。我认为没有任何方法可以保证 SHFileOperation 永远不会显示 UI 组件。事实上，如果你看一下[IFileOperation](http://msdn.microsoft.com/en-us/library/windows/desktop/bb775771%28v=vs.85%29.aspx)（这是取代 SHFileOperation 的新 Vista 界面），它清楚地表明：

> 公开复制、移动、重命名、创建和删除 Shell 项的方法以及提供进度和错误对话框的方法。该接口取代了 SHFileOperation 函数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-15T08:35:48.313

我不得不同意：不合适或不可取。

使用 SHFileOperation 的主要原因是使用 UI 执行操作，和/或执行可逆操作。即使用 SHFileOperation 删除文件是将文件放入回收站而不是删除它们，从而允许当前交互式用户取消删除或撤消执行的操作。由于服务在非交互式桌面上运行，因此没有人能够清除回收站。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-02T13:21:16.170

我也遇到了这个问题，并且致力于在服务器和网络共享之间实现安全可靠的网络文件复制（这些共享中的大多数都是基于 CIFS / NetApp 文件管理器的）并且`SHFileOperation`不时失败。

现在开始使用`ROBOCOPY`（默认情况下在 Vista/Server 2008 以上的所有 Microsoft 操作系统中都可用），看起来确实很有趣且可靠。

这让我大开眼界：[https ://stackoverflow.com/a/1030752/559144](https://stackoverflow.com/a/1030752/559144)

# wix - 您可以在 Wix 中设置条件卸载吗？

> ID：202038
> 
> 赞同：2
> 
> 时间：2008-10-14T17:15:29.250
> 
> 标签：wix, uninstallation

安装程序设置了一个默认数据库（如果尚不存在），我想将其从卸载过程中排除（或者让用户选择是否删除它，一旦我花时间弄清楚自定义 GUI）

似乎最佳做法是在运行时而不是安装时创建数据库，但为了争论，这是否可能以及如何？

我知道如何设置它以有条件地安装它，如下所示：

```
<Feature Id="Database" Display="hidden" Level="1">
  <ComponentRef Id="DatabaseComponent"/>
  <!-- Cancels installing of new DB if it already exists-->
  <Condition Level="0">DBEXISTS</Condition>
</Feature> 
```

但我不确定如何对卸载设置条件。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-14T17:23:45.847

使组件永久化（Component@Permanent="yes"）。

# xsd - 格式化 XSD 方案以供同行评审

> ID：202049
> 
> 赞同：11
> 
> 时间：2008-10-14T17:17:45.657
> 
> 标签：xsd, datamodel, review

我设计了一个由 XSD 方案表示的数据模型。数据模型还提供了在 WSDL 描述符中用作 Web 服务参数的类型。

我想发送 XSD 方案并要求相关人员对数据模型进行同行评审。

您建议使用什么工具或演示方法作为同行评审的基础？数据模型对于非技术人员来说应该是可读的，至少在涉及到参数的语义含义时

**编辑：**

更具体地说：当然，从句法上讲，该方案是有效的。实际上，我已经在研究基于 JAXB 生成的类的代码。我的目标是

1.  冻结数据模型，从而冻结输入参数
2.  从语义（在业务相关的意义上）的角度来看，确保没有任何东西丢失或遗忘。

**编辑 2**

我一直在考虑如何最好地传播数据模型。我正在考虑用于 XSD 模式的 JavaDoc 之类的东西。任何人都知道是否存在类似的东西？基本上它可以通过一组 XSLT 来完成，对吧？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-02-10T17:09:51.470

我知道以下从 XML Schema 文件 (XSD) 生成文档的工具：

*   [xs3p](http://xml.fiforms.org/xs3p)
    *   从 XSD 生成单个 XHTML 的 XSLT 样式表
*   [xsddoc](http://xframe.sourceforge.net/xsddoc/index.html)
    *   免费/LGPL
    *   主要基于 XSLT
    *   类似 JavaDoc 的输出
    *   查看[xsddoc 示例](http://xframe.sourceforge.net/xsddoc/examples.html)
*   [xnsdoc](http://www.buldocs.com/xnsdoc/index.html)
    *   改进的 xsddoc 商业版本
    *   免费供个人/教育使用
    *   类似 JavaDoc 的输出
*   [XSDdoc 2.0](http://www.bluetetra.com/xsddoc)
    *   商业的
    *   类似 JavaDoc 的输出

对于小型 XML 模式，我可能会建议使用*xs3p* XSLT 样式表。对于更复杂的架构，我建议使用[xsddoc](http://xframe.sourceforge.net/xsddoc/index.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-14T17:22:59.953

我建议*使用*XSD 做一些事情。具体来说，展示一些实际的应用程序，并以示例作为真实代码。

实际应用程序使模式变得有趣。这些示例不必很大、复杂或完全现实。他们只需要编译。其他人会想要复制和粘贴代码示例。

这些示例是模式的“hello world”。它们充当模式的一种单元测试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-23T19:43:24.673

我见过的最接近 Javadoc 的 XML 模式是在从模式生成的源代码上运行 Javadoc 工具。这需要两件事：1) 您的模式具有记录它的内部注释元素，以及 2) 您的源生成器将这些注释用作 Javadoc 元素。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-08-11T09:54:42.723

** 披露：我为 Innovasys 工作，下面提到的文档工具的生产商***

您可以查看[Innovasys 文档！十](http://www.innovasys.com/products/dx2011/overview.aspx)。除了为每个元素、简单类型、复杂类型、组和属性组自动生成结构化和链接的页面外，它还将生成链接的 XSD 图（包括序列/选择等）和结构表，其中包括来自 XSD 的注释和理解架构中元素之间的关系。输出是基于模板的，因此您可以将其调整为您喜欢的样式和结构。它将构建输出到 web 就绪的 html 或编译的帮助文件。

独特的是，它还包括一个所见即所得的编辑器，允许您创作额外的内容来补充自动生成的内容和来自 XSD 源的注释 - 这样您就可以为同行评审提供额外的上下文信息。还有一个社区扩展功能，允许人们查看生成的输出以记录评论和反馈，并且可以直接从 Document 中查看和操作！X。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-03-29T13:39:00.180

非常有用的 Oxygen XML 开发人员还支持生成文档，请参阅 [http://www.oxygenxml.com/xml_schema_documentation.html](http://www.oxygenxml.com/xml_schema_documentation.html) （商业，但有一个功能齐全的 30 天试用版）

我现在就试一试，需要一种简单的方法来生成具有所有类型和可用 xsd:documentation 描述的文档作为简单的接口描述......

# javascript - 如何设置计时器以防止重叠 ajax 调用？

> ID：202060
> 
> 赞同：1
> 
> 时间：2008-10-14T17:22:42.387
> 
> 标签：javascript, jquery

我有一个页面，其中搜索结果显示在网格和地图上（使用动态生成的 KML，覆盖在嵌入式 Google 地图上）。我已经将它连接起来以在用户输入时工作；这是我的代码的骨架，它有效：

```
$(function() {
    // Wire up search textbox
    $('input.Search').bind("keyup", update);
});

update = function(e) {
    // Get text from search box
    // Pass to web method and bind to concessions grid
    $.ajax({  
        ...
        success: function(msg) {
            displayResults(msg, filterParams);
        },
    });

}

displayResults = function(msg, filterParams) {
        // Databind results grid using jTemplates
        // Show results on map: Pass parameters to KML generator and overlay on map
} 
```

根据搜索，可能有数百个结果；因此，`displayResults`在服务器（查询数据库、即时构建和简化 KML）和客户端（数据绑定结果网格、在地图上覆盖大 KML 文件）上发生的工作都是处理器密集型的。

我喜欢在输入时立即获得逐渐缩小的结果，但我想尽量减少刷新的次数。`update`在用户停止输入之后，在运行函数之前引入 N 秒延迟的最简单方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-14T17:33:08.277

与其`update()`直接调用，不如调用一个包装器来检查是否有任何挂起的延迟更新：

```
$('input.Search').bind("keyup", delayedUpdate);

function delayedUpdate() {
    if (updatePending) {
        clearTimeout(updatePending);
    }

    updatePending = setTimeout(update, 250);
}

function update() {
    updatePending = false;

    //$.ajax(...
} 
```

您还应该添加：

```
$('input.Search').bind("blur", update); 
```

当用户离开现场时，这将立即更新。但请确保您还添加了针对用户离开该字段而有待处理的延迟更新（首先取消延迟更新）的情况的处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-14T17:27:52.907

作为第一种方法，例如：

```
$('input.Search').bind("keyup", function() { setTimeout(update, 5) } ); 
```

（不确定确切的 setTimeout 语法）。

您还可以保留一个变量来跟踪是否已经安排了超时。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-14T17:30:32.510

您可以使用 Window.SetTimeOut(YourRefreshMethod) ，当调用 YourRefereshMethod 时，它会检查到目前为止输入的字符数，并将其与某个计数器进行比较，计数器将从 0 值开始，因此初始调用将不执行任何操作除了使用当前输入的字符数更新计数器之外，第二次调用您的方法时，它将检查输入的字符数，如果它与计数器记录的先前数字匹配，则表示用户没有输入任何内容new 并且您可以触发 Refresh 方法，否则您将更新计数器值

# apache - 覆盖所有域的 mod_rewrite 规则

> ID：202065
> 
> 赞同：1
> 
> 时间：2008-10-14T17:24:53.053
> 
> 标签：apache, mod-rewrite

有没有办法在盒子上请求的任何域上触发 RewriteRule？例如，我有 5 个 VirtualHost，它们应用了完全相同的 RewriteRule，目前每个 VirtualHost 指令都有规则，但我可以把它放在“全局”的某个地方，以便更容易维护吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-14T17:30:49.640

不，恐怕不会

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-15T15:08:50.393

你可以，但这有点像黑客。在 .htaccess 中创建您的 RewriteRule，例如：

> /www/redirects/global/.htaccess

现在只需将您的虚拟主机的 DocumentRoot 设置为 /www/redirects/global/，每个请求都将通过您的 RewriteRule 强制执行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-15T15:19:18.640

我还没有测试过，但是[mod_rewrite 文档](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html)说 RewriteRule 可以在服务器配置上下文中使用。

您可能还想查看[RewriteMap](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html#rewritemap)的工作方式。由于这些是一个文件，因此可以将它们视为“全局”源，但由于它们主要是静态的，因此对它们有限制。

# asp.net - 强制 ASP.NET 文本框显示带有 $ 符号的货币

> ID：202067
> 
> 赞同：4
> 
> 时间：2008-10-14T17:24:58.917
> 
> 标签：asp.net, formatting, textbox, currency

有没有办法让 ASP.NET 文本框只接受货币值，并且在验证控件时，预先插入 $ 符号？

例子：

10.23 变为 10.23
美元 1.45 美元保持 1.45 美元
10.a 由于不是有效数字而引发错误

我有一个正则表达式验证器，它正在验证数字是否有效，但我不知道如何将 $ 符号强制输入文本。我怀疑 JavaScript 可能会工作，但想知道是否有另一种方法可以做到这一点。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-14T17:30:23.883

[AJAX 控件工具包](https://github.com/DevExpress/AjaxControlToolkit/wiki)中的 ASP.NET [MaskedEdit](https://github.com/DevExpress/AjaxControlToolkit/wiki/MaskedEdit)控件可以完成您的要求。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-12-28T13:56:47.250

我知道答案已被接受，但我想为遇到相同问题并寻找多种解决方法的人提供另一种解决方案。

我这样做的方法是使用 jQuery[格式货币插件](http://code.google.com/p/jquery-formatcurrency/)在客户端绑定用户输入。在服务器端解析这个输入只需要：

```
// directive
using System.Globalization;

// code
decimal input = -1;
if (decimal.TryParse(txtUserInput.Text, NumberStyles.Currency, 
    CultureInfo.InvariantCulture, out input))
{
    parameter = input.ToString();
} 
```

唯一的缺点是用户可以关闭 javascript，在这种情况下，运行服务器端的 RegEx 验证器将作为后备。如果控件是数据绑定的，那么您所要做的就是`decimalValue.ToString("{0:c}")`，正如其他人所提到的，为了显示正确的货币格式。

很酷的一点是，如果用户输入文本框并显示`$0.00`在客户端，服务器端的 if 语句将返回 false。如果您的十进制值在数据库中不可为空，只需更改`decimal input = -1`为`decimal input = 0`，您将获得默认值 0。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-14T17:27:42.953

另一种方法可能是将美元符号放在文本框的左侧。是否真的需要在盒子内放置美元符号或一个简单的标签？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-12-28T05:58:29.650

```
decimal sValue = decimal.Parse(txtboxValue.Text.Trim());
// Put Code to check whether the $ sign already exist or not.
//Try making a function returning boolean
//if Dollar sign not available do this
{ string LableText = string.Format("{0:c}", sValue); }
else
{ string LableText = Convert.ToString(sValue); } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-03T10:56:07.607

```
string sValue = Convert.ToString(txtboxValue.Text.Trim());
// Put Code to check whether the $ sign already exist or not.
//Try making a function returning boolean
//if Dollar sign not available do this
{ string LableText = string.Format("{0:c}", "sValue"); }
else
{ string LableText = Convert.ToString(sValue); } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-14T17:45:53.337

在 .CS 中，您可以按照以下方式进行模式匹配，

```
string value = text_box_to_validate.Text;

string myPattern = @"^\$(\d{1,3},?(\d{3},?)*\d{3}(\.\d{0,2})|\d{1,3}(\.\d{2})|\.\d{2})$";
Regex r = new Regex(myPattern);
Match m = r.Match(value);

if (m.Success)
{
    //do something -- everything passed
}
else
{
    //did not match
    //could check if number is good, but is just missing $ in front
} 
```

# django - How to configure server for small hosting company for django-powered flash sites?

> ID：202068
> 
> 赞同：1
> 
> 时间：2008-10-14T17:25:10.837
> 
> 标签：django, hosting, nginx, lighttpd, server-configuration

I'm looking at setting up a small company that hosts flash-based websites for artist portfolios. The customer control panel would be django-powered, and would provide the interface for uploading their images, managing galleries, selling prints, etc.

Seeing as the majority of traffic to the hosted sites would end up at their top level domain, this would result in only static media hits (the HTML page with the embedded flash movie), I could set up lighttpd or nginx to handle those requests, and pass the django stuff back to apache/mod_whatever.

Seems as if I could set this all up on one box, with the django sites framework keeping each site's admin separate.

I'm not much of a server admin. Are there any gotchas I'm not seeing?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-21T03:44:54.170

也许。我不认为内置的管理界面真的是为了将管理员聚集到他们自己的网站上。该`sites`框架更适合在多个站点上发布相同的内容，而不是将用户限制在一个站点或另一个站点上。您最好编写自己的管理界面来强制执行这些分隔。

就提供内容而言，您似乎可以提供一个通用（静态）Flash 文件，该文件使用动态 XML 文件来填充内容。如果您使用 Django 生成 XML，那将为您提供所需的动态内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-09T00:32:27.770

这个 django 片段可能是您将它们分开所需要的：

[http://www.djangosnippets.org/snippets/1054/](http://www.djangosnippets.org/snippets/1054/)

“一个非常简单的多用户博客模型，其管理界面配置为只允许人们编辑或删除他们自己创建的条目，除非他们是超级用户。”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-12-14T15:34:50.517

根据您要托管的站点数量，使用管理员编写一次单个 Django 应用程序并为每个新站点创建一个单独的 Django 项目可能会更容易。这很简单，它确实有效，并且作为额外的好处，您可以向新站点添加功能，而不会冒在旧站点中引起问题的风险。

再说一次，自定义管理员可能会更方便，这样您就可以将用户可以看到的对象数量限制为给定站点本身的对象。这很容易做到，尽管您可能希望使用 RequestSite 而不是站点框架中的常用站点，因为这需要为每个站点单独设置。

ModelAdmin 中存在这种方法，您可以覆盖它以手动控制正在编辑的对象。

# c# - ASP.Net and GetType()

> ID：202073
> 
> 赞同：6
> 
> 时间：2008-10-14T17:26:29.553
> 
> 标签：c#, asp.net, reflection, resourcemanager

I want to get a type of a "BasePage" object that I am creating. Every Page object is based off BasePage. For instance, I have a Login.aspx and in my code-behind and a class that has a method Display:

```
Display(BasePage page) {
    ResourceManager manager = new ResourceManager(page.GetType());
} 
```

In my project structure I have a default resource file and a psuedo-translation resource file. If I set try something like this:

```
Display(BasePage page) {
    ResourceManager manager = new ResourceManager(typeof(Login));
} 
```

it returns the translated page. After some research I found that page.GetType().ToString() returned something to the effect of "ASP_login.aspx" How can I get the actual code behind class type, such that I get an object of type "Login" that is derived from "BasePage"?

Thanks in advance!

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-14T17:35:41.143

If your code-beside looks like this:

```
public partial class _Login : BasePage 
 { /* ... */ 
 } 
```

Then you would get the `Type` object for it with *`typeof(_Login)`*. To get the type dynamically, you can find it recursively:

```
Type GetCodeBehindType()
 { return getCodeBehindTypeRecursive(this.GetType());
 }

Type getCodeBehindTypeRecursive(Type t)
 { var baseType = t.BaseType;
   if (baseType == typeof(BasePage)) return t;
   else return getCodeBehindTypeRecursive(baseType);
 } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-14T17:53:54.477

After some additional research I found that if I call Page.GetType().BaseType it returns the code-behind type of the Aspx page.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-14T18:16:16.490

page.GetType().BaseType, it has been said before, but let me elaborate as to why.

Aspx pages inherit from their code-behind pages, meaning that the inheritance hierarchy looks like this:

```
...
Page
BasePage
Login
ASP_Login 
```

Where the top is the parent and the bottom is the child.

This allows your code behind to be accessible from the aspx page, without requiring all of the generated code related to your actual aspx page to be copied into the base class page.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-14T17:33:52.660

It depends where you're calling Display() from. If you're calling it from the ASPX, then you'llse "ASP_login.aspx". If you're calling it from the code-behind (i.e. the Page_Load() method) you should get the Login page type.

Instead of passing the Page in, you might consider just using the Page property (i.e. this.Page.GetType()) which should always be the current page/codebehind type, if I recall correctly.

I should also make the point that you might consider moving this sort of stuff out of the ASPX/codebehind and into some sort of service. It's generally a good idea to minimize the amount of things you do in a code behind and, instead, push logic into a presenter class and follow the MVP pattern for ASP.NET Web Forms development.

# wpf - WPF versus Windows Forms

> ID：202079
> 
> 赞同：81
> 
> 时间：2008-10-14T17:28:35.120
> 
> 标签：wpf, winforms

> **Possible Duplicate:**
> [When creating a new GUI, is WPF the preferred choice over Windows Forms?](https://stackoverflow.com/questions/57909/when-creating-a-new-gui-is-wpf-the-preferred-choice-over-windows-forms)

1.  What are the advantages and disadvantages between using WPF (Windows Presentation Foundation) over Windows Forms?

2.  What are the considerations that need to be made when choosing between the two?

# .net - How to change cell's ComboBox style in DataGridViewComboBoxColumn

> ID：202084
> 
> 赞同：8
> 
> 时间：2008-10-14T17:30:09.983
> 
> 标签：.net, datagridview

Cells in DataGridViewComboBoxColumn have ComboBoxStyle DropDownList. It means the user can only select values from the dropdown. The underlying control is ComboBox, so it can have style DropDown. How do I change the style of the underlying combo box in DataGridViewComboBoxColumn. Or, more general, can I have a column in DataGridView with dropdown where user can type?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-14T19:21:25.110

```
void dataGridView1_EditingControlShowing(object sender, 
    DataGridViewEditingControlShowingEventArgs e)
{
    if (e.Control.GetType() == typeof(DataGridViewComboBoxEditingControl))
    {
        DataGridViewComboBoxEditingControl cbo = 
            e.Control as DataGridViewComboBoxEditingControl;
        cbo.DropDownStyle = ComboBoxStyle.DropDown;
    }
} 
```

[组合框和数据绑定数据网格视图的问题](http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=13855&SiteID=1)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-15T02:03:23.177

以下解决方案对我有用

```
private void dataGridView1_CellValidating(object sender, 
    DataGridViewCellValidatingEventArgs e) 
{
    if (e.ColumnIndex == Column1.Index) 
    {
        // Add the value to column's Items to pass validation
        if (!Column1.Items.Contains(e.FormattedValue.ToString())) 
        {
            Column1.Items.Add(e.FormattedValue);
            dataGridView1.Rows[e.RowIndex].Cells[e.ColumnIndex].Value = 
                e.FormattedValue;
        }
    }
}

private void dataGridView1_EditingControlShowing(object sender, 
    DataGridViewEditingControlShowingEventArgs e) 
{
    if (dataGridView1.CurrentCell.ColumnIndex == Column1.Index) 
    {
        ComboBox cb = (ComboBox)e.Control;
        if (cb != null) 
        {
            cb.Items.Clear();
            // Customize content of the dropdown list
            cb.Items.AddRange(appropriateCollectionOfStrings);
            cb.DropDownStyle = ComboBoxStyle.DropDown;
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-07-28T23:47:47.820

```
if (!Column1.Items.Contains(e.FormattedValue.ToString())) { 
    Column1.Items.Add(e.FormattedValue);     
    dataGridView1.Rows[e.RowIndex].Cells[e.ColumnIndex].Value = e.FormattedValue; 
} 
```

可能总是返回 true，因为 `Column1.Items.Contains()` 正在搜索`String`值。如果`e.FormattedValue`不是 a`String`那么比较将失败。

尝试

```
if (!Column1.Items.Contains(e.FormattedValue.ToString())) { 
    Column1.Items.Add(e.FormattedValue.ToString());     
    dataGridView1.Rows[e.RowIndex].Cells[e.ColumnIndex].Value = e.FormattedValue.ToString(); 
} 
```

或者

```
if (!Column1.Items.Contains(e.FormattedValue)) { 
    Column1.Items.Add(e.FormattedValue); 
    dataGridView1.Rows[e.RowIndex].Cells[e.ColumnIndex].Value = e.FormattedValue; 
} 
```

# naming-conventions - 匈牙利符号的好例子？

> ID：202107
> 
> 赞同：16
> 
> 时间：2008-10-14T17:37:59.267
> 
> 标签：naming-conventions, hungarian-notation

这个问题是为了寻找匈牙利符号的好例子，所以我们可以把这些集合在一起。

**编辑：**我同意匈牙利语的类型不是那么必要，我希望有更具体的例子来增加可读性和可维护性，就像乔尔在他的文章中给出的那样（根据我的回答）。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2008-10-14T17:48:14.550

要求匈牙利符号的好例子的问题是每个人都会对一个好例子的样子有自己的想法。我个人认为最好的[Hungarian Notation](http://en.wikipedia.org/wiki/Hungarian_Notation "维基百科文章")是**no Hungarian Notation**。该符号最初旨在表示变量的*预期用途*而不是其类型，但它通常用于类型信息，特别是用于表单控件（例如，*txtFirstName*用于表示某人名字的文本框。）。这使得代码在可读性（例如，“prepIn nounTerms prepOf nounReadability”）和需要更改类型时的重构（Win32 API 中的“lParams”已更改类型）方面的可维护性降低。

您可能应该考虑根本不使用它。例子：

*   **strFirstName** - 这可以只是**firstName**，因为它的用途很明显，类型并不那么重要，在这种情况下应该很明显。如果不是很明显，IDE 可以帮助您。
*   **txtFirstName** - 这可以更改为**FirstNameTextBox**或**FirstName_TextBox**。它读起来更好，你知道它是一个控件，而不仅仅是文本。
*   **CAccount** - *C*用于 MFC 中的类名，但你真的不需要它。**帐户**足够好。大写名称是类型的标准约定（它们只出现在特定位置，因此不会与属性或方法混淆）
*   **ixArray**（*数组*的索引） -`ix`有点晦涩。试试**arrayIndex**。
*   **usState**（*State*的不安全字符串）- 看起来像“US State”。最好使用**状态`_`UnsafeString**或其他东西。甚至可能将其包装在***UnsafeString***类中，以至少使其类型安全。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2008-10-14T17:38:38.640

正如其他匈牙利帖子中提到的那样，现在经典的文章来自 Joel 的网站：

[http://www.joelonsoftware.com/articles/Wrong.html](http://www.joelonsoftware.com/articles/Wrong.html)

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2008-10-14T17:45:57.410

# p

（用于指针）。它几乎是我使用的唯一前缀。我认为它为变量增加了很多（例如，它是一个指针），因此应该更加尊重地对待它。

匈牙利语的数据类型有点过时了，现在 IDE 可以告诉你类型是什么（只需几秒钟将鼠标悬停在变量名上），所以它并不那么重要。但是将指针视为其数据不好，因此您要确保即使用户在编码​​时做出不应该假设的假设，它对用户来说也是显而易见的。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2008-10-14T17:57:42.613

**吨**

受污染的数据。为从不受信任的来源传入的所有数据添加前缀，以使该变量受到污染。在对其进行任何实际工作之前，应清理所有受污染的数据。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2008-11-30T05:52:00.843

用匈牙利语来表示类型是没有意义的，因为编译器已经为你做了。

匈牙利语的有用之处在于区分具有相同原始类型的逻辑不同类型的变量。例如，如果您使用整数来表示坐标，您可以在 x 坐标前面加上 x，在 y 坐标前面加上 y，在距离前面加上 d。所以你会有看起来像的代码

`dxHighlight = xStart - xEnd`

`yHighlight = yLocation + 3`

`yEnd = yStart + dyHeight`

`dyCode = dyField * 2`

等等。它很有用，因为您可以一眼就发现错误：如果您将 dy 添加到 ay，您总是会得到一个 y。如果你减去两个 x，你总是得到一个 dx。如果你将一个 dy 乘以一个标量，你总是得到一个 dy。等等。如果你看到像这样的线

`yTop = dyText + xButton`

你一眼就知道这是错误的，因为添加 dy 和 ax 没有意义。编译器无法为您捕捉到这一点，因为据它所知，您正在将一个 int 添加到一个 int 中，这很好。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-11-29T08:04:24.633

不要使用特定于语言的前缀。

我们用：

```
n：数字
p：百分比 1=100%（用于利率等）
c：货币
s：字符串
d：日期
e：枚举
o：对象（客户 oCustomer=新客户（）；）
...

```

我们对所有语言使用相同的系统：

```
SQL
C
C＃
Javascript
VB6
VB.net
...

```

这是一个救生员。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-10-14T17:49:41.380

Devil's Advocate：匈牙利符号的最好例子就是不要使用它。:D

在现代 IDE 中使用匈牙利符号没有任何优势，因为它们知道类型。它在重构变量的类型时增加了工作，因为名称也必须更改（并且大多数情况下，当您处理变量时，您知道它是什么类型）。

您还可以使用该符号解决排序问题。如果您使用 p 表示指针，a 表示地址，您是调用变量 apStreet 还是 paStreet？当你没有一致性时，可读性会降低，当你必须记住你必须写符号的顺序时，你必须占用宝贵的大脑空间。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2008-10-14T17:51:48.723

我发现匈牙利符号有时在动态语言中很有用。我特别想到了服务器端 Actionscript（基本上只是 javascript），但它可以应用于其他地方。由于根本没有真正的类型信息，匈牙利符号有时可以帮助使事情更容易理解。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2008-10-14T18:17:08.500

唯一真正有用的匈牙利语是 m_ 用于成员变量。（我也将 sm_ 用于静态成员，因为那是仍然存在的“其他”范围。）对于采用 80 亿字符长变量名称的宽屏监视器和编译器，缩写类型名称是不值得的。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2008-10-14T18:18:31.773

当你继承一个软件项目时，匈牙利符号（骆驼式，据我所知）是非常宝贵的。

是的，您可以使用 IDE 将“悬停”在一个变量上并找出它是什么类，但是如果您正在翻阅数千行代码，您不想在这几秒钟内停下来 - 每...... ..单身....时间....

记住——你不是为你自己或你的团队单独编写代码。您还为那些必须在 2-5 年后拾取此代码并对其进行增强的人编写它。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2010-09-08T12:27:03.363

I was strongly against Hungarian notation until I really started reading about it and trying to understand it's original intent.
After reading Joels post "Wrong" and the article "Rediscovering Hungarian Notation" I really changed my mind. Done correct I belive it must be extremly powerful.

Wrong by Joel Spolsky
[http://www.joelonsoftware.com/articles/Wrong.html](http://www.joelonsoftware.com/articles/Wrong.html)

Rediscovering Hungarian Notation
[http://codingthriller.blogspot.com/2007/11/rediscovering-hungarian-notation.html](http://codingthriller.blogspot.com/2007/11/rediscovering-hungarian-notation.html)

I belive that most Naysayers have never tried it for real and do not truly understand it. I would love to try it out in a real project.

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2008-10-14T18:55:08.363

我认为从上面链接的 Joel 的文章和一般的匈牙利符号中带走的关键是在变量有一些不明显的地方时使用它。

文章中的一个示例是编码字符串与非编码字符串，并不是说您应该将匈牙利语“us”用于不安全字符串，将“s”用于安全字符串，而是您应该有*一些*标识符来指示字符串是安全的或不。如果它成为标准，则很容易看出标准何时被打破。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-10-14T18:02:04.070

**米**

使用 ORM（例如休眠）时，您倾向于处理托管和非托管对象。更改托管对象将反映在数据库中，而无需调用显式保存，而处理托管对象需要显式保存调用。您处理对象的方式将根据对象的不同而有所不同。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2008-10-14T18:09:12.213

我发现唯一有用的一点是在声明界面控件时，txtUsername、txtPassword、ddlBirthMonth。它并不完美，但它有助于大型表单/项目。

我不将它用于变量或其他项目，仅用于控件。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2008-10-14T18:30:06.930

除了使用“p”作为指针之外，我还喜欢使用“cb”和“cch”来指示缓冲区大小参数（或变量）是字节数还是字符数（我也见过 -很少 - 'ce' 用于表示元素的数量）。因此，前缀不是传达类型，而是传达用途或意图。

我承认，我没有像我应该的那样始终如一地使用前缀，但我喜欢这个想法。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2008-10-14T20:33:45.340

我同意匈牙利符号不再特别有用。我以为它的初衷不是表示数据类型，而是表示实体类型。例如，在涉及客户、员工和用户名称的代码部分中，您可以命名本地字符串变量 cusName、empName 和 usrName。这将有助于区分听起来相似的变量名称。实体的相同前缀将在整个应用程序中使用。但是，当使用 OO 并且您正在处理对象时，这些前缀在 Customer.Name、Employee.Name 和 User.Name 中是多余的。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2008-11-30T06:54:35.397

**变量的名称应该描述它是什么。** 良好的变量命名使匈牙利表示法毫无用处。

但是，有时除了良好的变量命名之外，您还会使用匈牙利符号。m_numObjects 有两个“前缀”：m_ 和 num。 **m_**表示范围：它是绑定到*this*的数据成员。 **num**表示值*是*什么。

当我阅读“好”的代码时，我一点也不觉得受阻，即使它确实包含一些“匈牙利语”。对：我读代码，我不点击它。（事实上​​，在编码或任何特定于巫毒编程的查找功能时，我几乎不使用鼠标。）

当我阅读 m_ubScale 之类的内容时，我的速度变慢了（*是的，我在看着你，Liran！*），因为我必须查看它的用法（没有评论！）以找出它的缩放比例（如果有的话？）它是数据类型（恰好是定点字符）。更好的名称是 m_scaleFactor 或 m_zoomFactor，带有一个定点数的注释，甚至是 typedef。（事实上​​，typedef 会很有用，因为有几个类的其他几个成员使用相同的定点格式。但是，有些没有，但仍然标记为 m_ubWhatever！至少可以说令人困惑。）

我认为匈牙利语的目的是作为变量名的补充，而不是信息的替代品。此外，很多时候，匈牙利符号根本没有增加变量的可读性，浪费字节和读取时间。

只是我的2美分。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2009-05-28T00:04:15.347

一个非常古老的问题，但这里有几个我经常使用的“匈牙利”前缀：

> **我的**
> 
> 对于局部变量，以区分名称在全局上下文中可能有意义的位置。如果你看到 myFoo，它只用在这个函数中，不管我们在其他任何地方用 Foos 做什么。

```
myStart = GetTime();
doComplicatedOperations();
print (GetTime() - myStart); 
```

和

> **时间**
> 
> 用于循环或多步操作中值的临时副本。如果您看到两个 tmpFoo 变量相距超过几行，那么它们几乎肯定是不相关的。

```
tmpX = X; 
tmpY = Y;
X = someCalc(tmpX, tmpY);
Y = otherCalc(tmpX, tmpY); 
```

有时出于与**tmp**类似的原因**，**通常在更长的循环或函数中**。**

 *** * *

## 回答 #19

> 赞同：1
> 
> 时间：2008-10-14T18:01:34.803

我只使用 p 作为指针，仅此而已。只有当我使用 C++ 时。在 C# 中，我不使用任何匈牙利符号。例如

```
MyClass myClass;
MyClass* pMyClass; 
```

就这样 ：）

**编辑：**哦，我才意识到这是一个谎言。我也将“m_”用于成员变量。例如

```
class
{
private:
bool m_myVar;
} 
```

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2013-02-21T08:21:26.743

好吧，我只将它与窗口控制变量一起使用。我使用 btn_、txt_、lbl_ 等来发现它们。我还发现通过键入控件的类型（btn_ 等）来查找控件的名称很有帮助。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2008-10-14T17:57:20.023

没有匈牙利符号的好例子。只是不要使用它。即使您使用的是弱类型语言也不行。你会活得更快乐。

但是如果你真的需要一些理由不使用它，这是我最喜欢的一个，摘自 [这个很棒的链接](http://mindprod.com/jgloss/unmain.html)：

*匈牙利符号中的一个后续技巧是“更改变量的类型但保持变量名不变”。这几乎总是在 Windows 应用程序中完成，从 Win16 迁移：- WndProc(HWND hW, WORD wMsg, WORD wParam, LONG lParam) 到 Win32 WndProc(HWND hW, UINT wMsg, WPARAM wParam, LPARAM lParam) 其中 w 值提示它们是单词，但它们确实指的是多头。这种方法的真正价值随着 Win64 迁移而变得清晰，当参数将是 64 位宽时，旧的“w”和“l”前缀将永远保留。*

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2009-07-08T17:16:43.250

我发现自己使用“w”表示“工作”，而不是“temp”或“tmp”作为前缀，用于存储数据的局部变量，例如：

```
Public Function ArrayFromDJRange(rangename As Range, slots As Integer) As Variant

' this function copies a Disjoint Range of specified size into a Variant Array 7/8/09 ljr

Dim j As Integer
Dim wArray As Variant
Dim rCell As Range

wArray = rangename.Value ' to initialize the working Array
ReDim wArray(0, slots - 1) ' set to size of range
j = 0

For Each rCell In rangename
    wArray(0, j) = rCell.Value
    j = j + 1
Next rCell

ArrayFromDJRange = wArray

End Function 
```

# c# - How to stop worrying about using the best materials and just start learning .Net?

> ID：202113
> 
> 赞同：3
> 
> 时间：2008-10-14T17:41:03.877
> 
> 标签：c#, .net

For the past few years whenever I learn something I tend to spend way too much time researching on the best materials for the subject than actually studying it. What should I do to get over this mentality? I am stuck. How to stop worrying about getting or using the BEST books, training videos and online materials on .net and just start learning?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-14T17:44:27.507

Start doing a project with a deadline. You will code and learn together. If you cannot do that at work, think of a hobby project with some real requirements (like building a photo sharing site).

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-14T18:11:38.373

我完全同意刚开始的编码理念。项目的另一个想法是通过[Project Euler](http://projecteuler.net/)练习。它们是一些简单的数学问题，逐渐变得更难。如果您想不出一个项目或只有一点点时间，那就太好了。然后只需使用参考书或互联网来了解您需要了解的语言细节。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-14T18:04:30.477

1.  去下载[Visual Studio Express](http://www.microsoft.com/Express/)

    [http://www.microsoft.com/Express/](http://www.microsoft.com/Express/)

2.  去购买以下书籍之一：

    [ASP.NET 3.5 一步一步](https://rads.stackoverflow.com/amzn/click/com/0735624267)

    [C# 2008 一步一步](https://rads.stackoverflow.com/amzn/click/com/0735624305)

    [VB.NET 2008 一步一步](https://rads.stackoverflow.com/amzn/click/com/0735625379)

根据我的经验（当我在 1.0 天第一次开始使用 .NET 时）Microsoft 的 Step by Step 书籍是刚开始并开始使用 .NET 的最佳选择。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-14T22:58:14.563

最好的方法是边做边学！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-14T17:44:07.880

There is no single best resource on anything. The best way to learn is to practice. Get any book to get yourself started. Then just start writing some code at home. Play with the language and the platform. Read blogs, browse the questions here. You will start discovering and learning nuggets of information.

Others mentioned buying Visual Studio 2008\. It can be an expensive investment although it is totally worth it if you are a independent developer/consultant. However, if you just need something to get you started with coding, get the free [Visual C# Express](http://www.microsoft.com/express/vcsharp/). You can always grow into the professional SKUs when you need it.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-14T17:49:49.617

1) Stop researching 2) Start programming

Seriously, the only book you need to program in .NET is CLR Via C# by Jeffrey Richter. Read it cover to cover (save the first couple chapters until you've read the rest, btw), and start coding. When you hit stuff you have problems with (Linq, WPF, source control, unit testing), come here.

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-14T17:51:02.487

*   Buy visual studio 08, devise a small project, and complete it.
*   Make a deadline for yourself and don't push it back.
*   Buy a basic C# book for reference, don't worry about which one.

You can do it!

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-14T17:51:10.987

Firstly, don't beat yourself up for not having done things the right way before, as I'm sure you know, there never is a *right way*. Also, some of that searching for the best resources will pay for itself when you have a better understanding of things than the next guy. And, as has already been said, do a project, pick something harder than the usual, trivial examples, so that you have to think and ask questions and do some research. Finally, if you have a blog then post about what you are up to, that way you'll have more of a sense of a commitment to stay working on the project rather than bailing out as it gets hard, especially as that is usually the time when you are about to actually learn something (this works for me anyway!)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-14T22:40:36.817

找到您想使用的 .Net 区域，例如控制台应用程序、Windows 应用程序、ASP.Net 应用程序、Web 服务，然后构建一些“让您的脚湿透”之类的东西，例如基本的“Hello World！ " 例如，如果您确实获得了 SQL Express 或更丰富的版本，则可以进行一些简单的计算或使用 MS-SQL 后端。

不要忘记，如果你不进去，有些事情可能会与你擦肩而过。有多少 ASP.Net 1.0 或 1.1 应用程序使用您可能不熟悉的旧系统，这可能是您开始做的动力，而不是试图找到几年后就会过时的最佳应用程序。如果您想编写比简单的“Hello World！”更大的东西，请从 Martin Fowler 的“重构”之类的书中获取一些想法。程序。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-14T22:47:50.390

下载 Visual C# Express 2008。Google 获取介绍教程。挖掘并探索自己。

此 URL 是您*开始*使用 .NET 所需的全部内容：http: [//msdn.microsoft.com/en-us/vcsharp/aa336768.aspx ?wt.slv=RightRail](http://msdn.microsoft.com/en-us/vcsharp/aa336768.aspx?wt.slv=RightRail)

如果你想*掌握*.NET，有很多不同的想法，但只有一个*官方*的自学轨道。从 Microsoft Press 获取官方 MCTS / MCPD 培训指南。这些可以通过考试编号在亚马逊上搜索，例如考试 70-536。但只要您知道如何在 Google 上搜索问题和教程，就不需要太多其他东西了。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-14T18:26:03.273

当你在一份新工作中工作时，你会学到很多东西，因为你有很多优秀的人，他们会转移很多他们认为有用的知识。你可以回顾他们是如何做事的，哪些部分做得好，哪些部分做得不好。

孤立地学习是很困难的，尤其是当那里有这么多资源的时候。

我建议与您当地社区用户组或在线组中的个人联系，或者创建自己的组。这些人中的许多人将拥有现实世界的经验，可以帮助您更有效地指导您的学习路径。

# c - 如何在 Linux 上以编程方式设置硬件时钟？

> ID：202116
> 
> 赞同：12
> 
> 时间：2008-10-14T17:43:06.493
> 
> 标签：c, linux, time, clock, hwclock

Linux 提供 stime(2) 调用来设置系统时间。然而，虽然这会更新系统时间，但它不会将 BIOS 硬件时钟设置为与新系统时间相匹配。

Linux 系统通常在关机时和定期间隔将硬件时钟与系统时间同步。但是，如果机器在这些自动同步之一之前重新启动，则机器重新启动时的时间将不正确。

设置系统时间时如何确保硬件时钟得到更新？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-14T17:59:43.810

查看 rtc 手册页以获取详细信息，但如果您以 root 身份登录，则如下所示：

```
#include <linux/rtc.h>
#include <sys/ioctl.h>

    struct       rtc_time {
        int         tm_sec;      
        int         tm_min;      
        int         tm_hour;     
        int         tm_mday;     
        int         tm_mon;      
        int         tm_year;     
        int         tm_wday; /* unused */
        int         tm_yday; /* unused */
        int         tm_isdst;/* unused */
    };

int fd;
struct rtc_time rt;
/* set your values here */
fd = open("/dev/rtc", O_RDONLY);
ioctl(fd, RTC_SET_TIME, &rt);
close(fd); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-14T17:43:14.170

调用 stime() 后，执行以下操作：

```
system("/sbin/hwclock --systohc"); 
```

有关更多信息，请参见 hwclock(8) 手册页。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-14T17:48:49.447

我还想指出，硬件时钟只能精确到一个点（我见过的系统每天会丢失/增加几秒钟）。

您是否考虑过设置网络时间守护程序以将您的时钟与时间服务器同步？

诚然，这种同步直到守护程序启动后才会发生，因此保持硬件时钟同步也有助于在开机和时间守护程序与时间服务器同步的点之间。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-14T17:52:19.190

我将从阅读 hwclock 的源代码开始。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2010-10-30T08:03:42.570

如果文本编辑器与 kubuntu 不同（kate 是编辑器中的默认值），请`sudo`在终端中使用您自己的命令。

1.  运行终端
2.  复制并粘贴此命令 `sudo kate /etc/default/rcS`按`Enter`
3.  输入用户密码（您的登录密码）按`Enter`
4.  文本编辑器将在桌面上打开
5.  将行更改`UTC=yes`为`UTC=no`
6.  并单击保存（在文本编辑器选项卡栏的顶部）
7.  重启

# xml - 使用 JAXB 获取布尔属性的 getter

> ID：202124
> 
> 赞同：5
> 
> 时间：2008-10-14T17:44:26.570
> 
> 标签：xml, xsd, jaxb, jax-ws

我正在尝试使用 jax-ws 公开服务，但我得到的第一个惊喜是 Weblogic 不支持请求/响应对象的内部类。[在这里](https://stackoverflow.com/questions/144118/jaxb-binding-customization)克服这种情况后，我面临另一个挑战：

生成`getXXX()`而不是/附加到`isXXX()`方法。

我需要生成此方法，因为当我启动服务时我收到消息：

```
<WS data binding error>could not find getter for property 'IsXXX' on com.foo.MyClass 
```

尝试了自定义：

```
<jaxb:globalBindings generateIsSetMethod="false" enableJavaNamingConventions="false"> 
```

没有效果。:(

有什么帮助吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-02-14T10:49:32.030

在 jaxb 2.1.13 中已修复或更好地说支持（请参阅[JAXB-131](http://java.net/jira/browse/JAXB-131)了解更多详细信息）。升级您的依赖项并配置 enableIntrospection xjc 选项。有关 xjc 选项的更多详细信息，请参见此[链接](http://jaxb.java.net/nonav/2.1.13/docs/xjc.html)。如果您正在使用 org.codehause.mojo:jaxb2-maven-plugin:1.3.1 插件，请参阅[此问题评论](http://jira.codehaus.org/browse/MJAXB-37?focusedCommentId=291602&page=com.atlassian.jira.plugin.system.issuetabpanels%3acomment-tabpanel#comment-291602)以获取解决方法。

选项：-enableIntrospection

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-21T13:16:34.667

这是另一个解决问题的插件：

[http://code.google.com/p/nebulent-xjc-booleangetter/wiki/AboutThisProject](http://code.google.com/p/nebulent-xjc-booleangetter/wiki/AboutThisProject)

它会额外`getXXX()`生成 default `isXXX()`，因此，已经使用这些类的代码在应用插件后不会中断。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T21:25:39.773

用于 JAXB 的 BooleanGetter XJC 插件可在[http://fisheye5.cenqua.com/browse/~raw,r=1.1/jaxb2-commons/www/boolean-getter/index.html获得](http://fisheye5.cenqua.com/browse/~raw,r=1.1/jaxb2-commons/www/boolean-getter/index.html)

如果您使用的是 JavaSE 6，则需要重新打包 - 请参阅[http://forums.java.net/jive/message.jspa?messageID=319434](http://forums.java.net/jive/message.jspa?messageID=319434)

在 ant build 中使用如下：

```
 <taskdef name="xjc" classname="com.sun.tools.xjc.XJCTask" classpathref="development.classpath"/>

    <xjc schema="some.xsd" package="com.acme.jaxb" destdir="gen-src">
        <arg value="-Xcollection-setter-injector"/>  
        <arg value="-Xboolean-getter"/>
    </xjc> 
```

高温高压

# xna - 在 XBOX 360 上从 DVD 或 CD 运行 XNA 编译的游戏？

> ID：202130
> 
> 赞同：4
> 
> 时间：2008-10-14T17:46:13.853
> 
> 标签：xna, xbox360

是否可以从 DVD 或 CD 运行为 XBOX 360 编译的 XNA 游戏，还是必须将其复制到 HD 上？

是否可以在 XBOX 360 项目中包含不属于 .net 紧凑框架的库？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-14T18:54:43.107

XNA 游戏必须使用 XNA 游戏启动器复制到 360。它们不能从 CD/DVD 中加载。

您可以使用 360 上的其他库，但必须使用 Xbox 的 .net 库进行编译。因此，除非您可以访问源代码，或者愿意反编译并将所有对框架库的引用更改为 Xbox 库，然后删除任何在 360 上不存在的调用，否则您不应该尝试。

# javascript - 从 Django 模型中生成 JavaScript 对象

> ID：202131
> 
> 赞同：5
> 
> 时间：2008-10-14T17:46:15.957
> 
> 标签：javascript, django, django-models, code-generation

我正在浏览器中执行大量 JavaScript 工作，并希望在前端拥有一些后端功能。具体来说，让客户端可以使用函数`get()`、和会很好。此外，如果模型的字段列表已经在生成的 JavaScript 对象中可用，那就太好了。`save()``all()``count()`

当前用户是否可以读取或写入记录是一个单独的问题，我将使用 Django 的身份验证来处理。目前，检索将是一个开始。

简而言之，是否有可以从 Django 模型生成 JavaScript 模型的代码？

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-14T21:48:16.813

听起来您正在寻找模型和查询集 API 的完整 JavaScript 接口。我无法想象这会完成，甚至是一项简单的任务。您不仅需要以某种方式生成模型的 JavaScript 实例（比 JSON 序列化提供的要多得多，因为您还需要这些方法），而且您需要公开一个可以处理各种 DB-API 调用的 Web 服务。我什至无法想象从哪里开始，安全问题可能太多而无法轻松克服。

另一种（也更简单）的方法是使用各种 Django REST 模块和 JSON 序列化之一。您可以对资源执行 AJAX GET 请求，该请求可以通过一系列查询参数来识别，这些参数相当于链式查询集过滤器。这将返回模型值的 JSON 表示。然后，您可以修改 JavaScript 对象并使用重载的 AJAX POST 请求将更改保留回服务器。您将无法访问模型的方法，因此必须重新实现功能，但对模型进行任何更改都应该足够简单——这基本上是使用 HTML 表单修改数据的 JavaScript 等价物。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-14T19:42:32.527

你需要一个数据序列化器。您可以使用 django 内置的序列化程序来完成。它记录在官方 django 网站上。[djangoproject_topics-序列化](http://docs.djangoproject.com/en/dev/topics/serialization/#topics-serialization)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-01-27T12:02:21.883

我已经开始了一个我认为完全符合您要求的项目。你可以在 [github_bumby_jslib](http://github.com/bumby/jslib)找到它。
它目前只支持 get()，但我希望尽快扩展它。随意贡献补丁:)

*jslib 是一个 Django 应用程序，旨在简化与您的 Django 项目的 AJAX 集成。*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-14T17:50:46.947

听起来您想对对象数据进行[JSON 编码。](http://docs.djangoproject.com/en/dev/topics/serialization/?from=olddocs)有关数据格式的更多信息，请参见[JSON.org](http://www.json.org)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-07-23T21:10:18.473

因此，自从我发布原始问题以来已经有一段时间了，从那时起，Djangoland 有了一些发展。其中最重要的是一个很棒的小库，叫做 Django REST Framework。我将在一个新项目中使用它，它看起来很漂亮。

[http://www.django-rest-framework.org](http://www.django-rest-framework.org)

# c# - c# (more specifically xna) how can i request a xml file via http? Doesnt need to support xbox

> ID：202133
> 
> 赞同：1
> 
> 时间：2008-10-14T17:47:08.560
> 
> 标签：c#, xml, http, xna, request

So im working on a game in XNA and i need it to get a server list off our site.

so i just need to do a http request to [http://play.feedthezombie.com/?want=servers&enc=xml](http://play.feedthezombie.com/?want=servers&enc=xml) and get the contest as either a string or xml object.

any clues?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-14T17:52:40.033

Use [XmlDocument.Load](http://msdn.microsoft.com/en-us/library/875kz807.aspx) method. It can load XML from an URL.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-14T18:33:20.230

您可以在 Windows 上调用任何您喜欢的 .NET 框架类，包括进行网络访问和 XML 处理的类。在 Xbox 上，您仅限于 XNA 为您提供的内容，它是 .NET 框架的一个子集，并且唯一的网络访问是通过 Xbox Live API。

# algorithm - How to search a string based key/value collection fast

> ID：202136
> 
> 赞同：13
> 
> 时间：2008-10-14T17:48:30.523
> 
> 标签：algorithm, search, tree, ternary-search-tree

Hello fellow stackoverflowers!

I have a word list of 200.000 string entries, average string length is around 30 characters. This list of words are the key and to each key i have a domain object. I would like to find the domain objects in this collection by only knowing a part of the key. I.E. the search string "kov" would for example match the key "stackoverflow".

Currently I am using a Ternary Search Tree (TST), which usually will find the items within 100 milliseconds. This is however too slow for my requirements. The TST implementation could be improved with some minor optimizations and I could try to balance the tree. But i figured that these things would not give me the 5x - 10x speed improvement I am aiming at. I am assuming that the reason for being so slow is that i basically have to visit most nodes in the tree.

Any ideas on how to improve the speed of the algorithm? Are there any other algorithms that I should be looking at?

Thanks in advance, Oskar

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-14T18:06:59.643

## 后缀数组和*q* -gram 索引

如果您的字符串对大小有严格的上限，您可能会考虑使用[**后缀数组**](http://en.wikipedia.org/wiki/Suffix_array)：只需使用特殊字符（例如空字符）将所有字符串填充到相同的最大长度。然后连接所有字符串并在它们之上建立一个后缀数组索引。

这为您提供了*m* * log *n*的查找运行时间，其中*m*是查询字符串的长度，*n*是组合字符串的总长度。如果这仍然不够好并且您的*m*具有固定的小长度，并且您的字母 Σ 的大小受到限制（例如，Σ < 128 个不同的字符），您可以另外构建一个***q* -gram index**。**这将允许在恒定时间内**检索。但是，*q* -gram 表需要 Σ ^(*m*)个条目（在 3 个字符的情况下 = 8 MiB，4 个字符的情况下为 1 GiB！）。

## 使索引更小

可以通过调整散列函数来**减小*q* -gram 表**的大小（在最好的情况下是指数的）。您可能会使用有损散列函数，而不是为每个可能的*q* -gram分配唯一编号。然后，该表必须存储可能的后缀数组索引列表，而不是仅存储一个与精确匹配相对应的后缀数组条目。但是，这将需要查找不再是恒定的，因为必须考虑列表中的所有条目。

顺便说一句，我不确定您是否熟悉***q*** **-gram索引的工作原理***，因为 Internet 对这个主题没有帮助。我之前在另一个主题中提到过这一点。因此，我在我的[学士论文](http://madrat.net/my/bachelor/thesis.pdf)中包含了构造的描述和算法。*

 *## 概念证明

我已经编写了一个非常小的 C# 概念证明（因为您另外声明您使用 C#）。它可以工作，但是由于两个原因它*非常*慢。首先，后缀数组创建只是对后缀进行排序。仅此一项就有运行时*n* ² log *n*。有很多优越的方法。`SubString`然而，更糟糕的是我用来获取后缀的事实。不幸的是，.NET 为此创建了整个后缀的副本。要在实践中使用此代码，请确保使用不会不必要地复制任何数据的就地方法。从字符串中检索*q* -gram 也是如此。

不构造`m_Data`我的示例中使用的字符串可能会更好。相反，您可以保存对原始数组的引用并`SubString`通过处理此数组来模拟我的所有访问。

尽管如此，很容易看出这个实现基本上期望恒定时间检索（如果字典表现良好）！这是一项不可能被搜索树/特里树击败的成就！

```
class QGramIndex {
    private readonly int m_Maxlen;
    private readonly string m_Data;
    private readonly int m_Q;
    private int[] m_SA;
    private Dictionary<string, int> m_Dir = new Dictionary<string, int>();

    private struct StrCmp : IComparer<int> {
        public readonly String Data;
        public StrCmp(string data) { Data = data; }
        public int Compare(int x, int y) {
            return string.CompareOrdinal(Data.Substring(x), Data.Substring(y));
        }
    }

    private readonly StrCmp cmp;

    public QGramIndex(IList<string> strings, int maxlen, int q) {
        m_Maxlen = maxlen;
        m_Q = q;

        var sb = new StringBuilder(strings.Count * maxlen);
        foreach (string str in strings)
            sb.AppendFormat(str.PadRight(maxlen, '\u0000'));
        m_Data = sb.ToString();
        cmp = new StrCmp(m_Data);
        MakeSuffixArray();
        MakeIndex();
    }

    public int this[string s] { get { return FindInIndex(s); } }

    private void MakeSuffixArray() {
        // Approx. runtime: n^3 * log n!!!
        // But I claim the shortest ever implementation of a suffix array!
        m_SA = Enumerable.Range(0, m_Data.Length).ToArray();
        Array.Sort(m_SA, cmp);
    }

    private int FindInArray(int ith) {
        return Array.BinarySearch(m_SA, ith, cmp);
    }

    private int FindInIndex(string s) {
        int idx;
        if (!m_Dir.TryGetValue(s, out idx))
            return -1;
        return m_SA[idx] / m_Maxlen;
    }

    private string QGram(int i) {
        return i > m_Data.Length - m_Q ?
            m_Data.Substring(i) :
            m_Data.Substring(i, m_Q);
    }

    private void MakeIndex() {
        for (int i = 0; i < m_Data.Length; ++i) {
            int pos = FindInArray(i);
            if (pos < 0) continue;
            m_Dir[QGram(i)] = pos;
        }
    }
} 
```

## 使用示例：

```
static void Main(string[] args) {
    var strings = new [] { "hello", "world", "this", "is", "a",
                           "funny", "test", "which", "i", "have",
                           "taken", "much", "too", "far", "already" };

    var index = new QGramIndex(strings, 10, 3);

    var tests = new [] { "xyz", "aki", "ake", "muc", "uch", "too", "fun", "est",
                         "hic", "ell", "llo", "his" };

    foreach (var str in tests) {
        int pos = index[str];
        if (pos > -1)
            Console.WriteLine("\"{0}\" found in \"{1}\".", str, strings[pos]);
        else
            Console.WriteLine("\"{0}\" not found.", str);
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-14T18:23:08.927

这是给你的 WAG。 *在我的算法精通方面，我绝不是 Knuthian*

好的，所以朴素的 Trie 通过从树的根开始向下移动与键中的每个字母匹配的分支（从键的第一个字母开始）来对字符串键进行编码。因此键“foo”将被映射到`(root)->f->fo->foo`，值将存储在“foo”节点指向的位置。

您正在搜索键中的任何子字符串，而不仅仅是从键开头开始的子字符串。

因此，您需要做的是将节点与包含该特定子字符串的任何键相关联。在我之前给出的 foo 示例中，您不会在节点 'f' 和 'fo' 下找到对 foo 值的引用。在支持您要执行的搜索类型的 TST 中，您不仅会在所有三个节点（'f'、'fo' 和 'foo'）下找到 foo 对象，还会找到它在“o”和“oo”下也是如此。

扩展搜索树以支持这种类型的索引有几个明显的后果。首先，您刚刚分解了树的大小。惊人的。如果您可以存储它并以有效的方式使用它，您的搜索将花费 O(1) 时间。如果您的键保持静态，并且您可以找到一种对索引进行分区的方法，这样您就不会在使用它时承受巨大的 IO 损失，那么这可能是值得的。

其次，您会发现搜索小字符串会导致大量点击，这可能会使您的搜索毫无用处，除非您在搜索词上设置最小长度。

从好的方面来说，您可能还会发现您可以通过标记化（如 zip 压缩）或通过压缩不向下分支的节点（即，如果您有 'w'->'o'->' o'-> 并且第一个 'o' 没有分支，您可以安全地将其折叠为 'w'->'oo'）。也许即使是一个邪恶的哈希也可以让事情变得更容易......

无论如何，正如我所说的那样，WAG。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-15T14:40:50.123

*/编辑：我的一个朋友刚刚在我构建 q-gram 表时指出了一个愚蠢的假设。结构可以变得更简单——因此也更快。我已经编辑了源代码和解释以反映这一点。我认为这可能是**最终的解决方案**。*

受到 Rafał Dowgird 对我之前的回答的评论的启发，我更新了我的代码。我认为这值得一个自己的答案，因为它也很长。此代码不是填充现有字符串，而是在原始字符串数组上构建索引。后缀数组不是存储单个位置，而是存储一对：目标字符串的索引和后缀在该字符串中的位置。结果，只需要第一个数字。但是，第二个数字对于构造*q* -gram 表是必需的。

新版本的算法通过遍历后缀数组而不是原始字符串来构建*q -gram 表。*这节省了后缀数组的二分查找。因此，构造的运行时间从*O* ( *n* * log *n* ) 下降到*O* ( *n* )（其中*n*是后缀数组的大小）。

请注意，就像我的第一个解决方案一样，使用会`SubString`导致大量不必要的副本。显而易见的解决方案是编写一个扩展方法来创建轻量级包装器，而不是复制字符串。然后必须稍微调整比较。这留给读者作为练习。;-)

```
using Position = System.Collections.Generic.KeyValuePair<int, int>;

class QGramIndex {
    private readonly int m_Q;
    private readonly IList<string> m_Data;
    private Position[] m_SA;
    private Dictionary<string, int> m_Dir;

    public QGramIndex(IList<string> strings, int q) {
        m_Q = q;
        m_Data = strings;
        MakeSuffixArray();
        MakeIndex();
    }

    public int this[string s] { get { return FindInIndex(s); } }

    private int FindInIndex(string s) {
        int idx;
        if (!m_Dir.TryGetValue(s, out idx))
            return -1;
        return m_SA[idx].Key;
    }

    private void MakeSuffixArray() {
        int size = m_Data.Sum(str => str.Length < m_Q ? 0 : str.Length - m_Q + 1);
        m_SA = new Position[size];
        int pos = 0;
        for (int i = 0; i < m_Data.Count; ++i)
            for (int j = 0; j <= m_Data[i].Length - m_Q; ++j)
                m_SA[pos++] = new Position(i, j);

        Array.Sort(
            m_SA,
            (x, y) => string.CompareOrdinal(
                m_Data[x.Key].Substring(x.Value),
                m_Data[y.Key].Substring(y.Value)
            )
        );
    }

    private void MakeIndex() {
        m_Dir = new Dictionary<string, int>(m_SA.Length);

        // Every q-gram is a prefix in the suffix table.
        for (int i = 0; i < m_SA.Length; ++i) {
            var pos = m_SA[i];
            m_Dir[m_Data[pos.Key].Substring(pos.Value, 5)] = i;
        }
    }
} 
```

用法与另一个示例中的相同，但减去`maxlen`了构造函数所需的参数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-14T17:57:58.617

Would you get any advantage having your trie keys comparable to the size of the machine register? So if you are on a 32bit box you can compare 4 characters at once instead of each character individually? I don't know how bad that would increase the size of your app.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-14T18:16:23.527

是否可以“散列”键值？基本上有第二棵树将搜索指向第一棵树的键列表的所有可能值。

你需要两棵树；第一个是域对象的哈希值。第二棵树是哈希值的搜索字符串。第二棵树具有相同哈希值的多个键。

示例树 1：STCKVRFLW -> 域对象

树 2：堆栈 -> STCKVRFLW，STCK 结束 -> STCKVRFLW，VRBRD，VR

因此，使用在第二棵树上的搜索为您提供了在第一棵树上搜索的键列表。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-14T18:50:39.777

选择最小搜索字符串大小（例如四个字符）。浏览您的字符串条目列表并构建每四个字符子字符串的字典，映射到子字符串出现的条目列表。当您进行搜索时，根据搜索字符串的前四个字符进行查找以获取一个初始集，然后将该初始集缩小到仅与完整搜索字符串匹配的那些。

最坏的情况是 O(n)，但只有当您的字符串条目几乎全部相同时，您才会得到它。查找字典可能非常大，因此将其存储在磁盘上或使用关系数据库可能是个好主意 :-)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-03-29T09:11:55.263

要以有效的方式查询大量文本，您可以使用编辑距离/前缀编辑距离的概念。

> 编辑距离 ED(x,y)：从 x 到 y 的最小转换次数

但是计算每个术语和查询文本之间的 ED 是资源和耗时的。因此，我们可以使用一种称为**Qgram Index**的技术来提取可能的匹配项，而不是首先为每个术语计算 ED 。然后对这些选定的术语应用 ED 计算。

Qgram 索引技术的一个优点是它支持**模糊搜索**。

调整 QGram 索引的一种可能方法是使用 Qgram 构建倒排索引。在那里，我们存储了包含特定 Qgram 的所有单词（而不是存储完整的字符串，您可以为每个字符串使用唯一的 ID）。

> col : **col** mbia, **col** ombo, gan **col** a, ta **col** ama

然后在查询时，我们计算查询文本和可用术语之间的常见 Qgram 数量。

```
Example: x = HILLARY, y = HILARI(query term)
Qgrams
$$HILLARY$$ -> $$H, $HI, HIL, ILL, LLA, LAR, ARY, RY$, Y$$
$$HILARI$$ -> $$H, $HI, HIL, ILA, LAR, ARI, RI$, I$$
number of q-grams in common = 4 
```

对于具有大量常见 Qgram 的术语，我们根据查询术语计算 ED/PED，然后向最终用户建议该术语。

您可以在以下项目中找到该理论的实现。随意问任何问题。 [https://github.com/Bhashitha-Gamage/City_Search](https://github.com/Bhashitha-Gamage/City_Search)

要了解更多关于编辑距离、前缀编辑距离 Qgram 索引的信息，请观看 Hannah Bast 教授的以下视频 [https://www.youtube.com/embed/6pUg2wmGJRo](https://www.youtube.com/embed/6pUg2wmGJRo)（课程从 20:06 开始）

# active-directory - 如何使用 LDP.exe 在 AD 中重置密码？

> ID：202142
> 
> 赞同：0
> 
> 时间：2008-10-14T17:51:07.070
> 
> 标签：active-directory

我可以与有权设置密码的用户联系。我可以更改属性，但无法设置密码。

找到了一些将属性设置为的说明`unicodePwd`，`\UNC:"*password*"`但它说：

> 错误：修改：不愿意执行。<53>

将 LDAP_OPT_ENCRYPT 设置为 1 也不起作用。我使用的端口是 389。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-07T20:45:48.033

您应该设置属性 userpassword。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-13T08:24:40.873

要直接使用 ldp.exe 设置 unicodePwd，请设置 LDAP_OPT_ENCRYPT = 1 以绑定加密通道并使用以下语法：

\UNI:"pwdhere"

\UNI: 和引号非常重要，因为密码必须以 Unicode 格式传递，并且系统使用引号来分隔密码。

如果要替换现有密码和更改密码权限以执行删除和添加操作，您还需要重置密码权限。

从这里：[http ://microsoft.public.windows.server.active-directory.narkive.com/tBRamxYg/reset-password-problem](http://microsoft.public.windows.server.active-directory.narkive.com/tBRamxYg/reset-password-problem)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-04-24T04:55:18.180

AD上的密码修改操作只能通过加密连接进行。使用带有 636 端口的 open ssl 建立一个 ssl 连接，该连接将在建立连接后加密发送到服务器的所有内容。AD 阻止以明文形式发送密码，因此要求加密连接。打开 ssl 连接时，您必须在客户端计算机上安装证书，以完成服务器和客户端之间的握手。并且要使用的正确属性是用户密码。但是，在使用 unicodepwd 时，应输入正确的值，如 \UNI:"newpassword"

# version-control - 在没有真正的源代码控制的情况下合并代码更改

> ID：202144
> 
> 赞同：5
> 
> 时间：2008-10-14T17:51:24.730
> 
> 标签：version-control, merge

我们有几个开发人员在开发相同的 VS2005 解决方案，但我们的源代码控制非常糟糕。（我们公司使用 Harvest，我们投不信任票）。

现在，我们都只是在处理共享局域网驱动器上的文件。显然，这会导致一些问题。但我们认为这比在本地工作、在电子表格中跟踪我们接触的文件并手动合并所有内容要好。有人有合并我们更改的策略吗？

一些问题的存在是因为公司的官僚主义（比如强制 Harvest）。这些相同的政策阻止将新工具引入我们的环境。因此，避免购买/下载新软件的策略最适合我们。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-14T18:06:51.877

学习使用 Harvest。让事情顺利进行需要一点努力，但总的来说，它是一个优秀的源代码控制系统。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-14T18:10:00.327

另一种可能性是[Scooter 的 Beyond Compare](http://www.scootersoftware.com/)。它具有两路和三路合并以及文件和目录的强大差异功能。如果您想了解更多信息，请收听[Jim McKeith](https://stackoverflow.com/users/255/jim-mckeeth)的[delphi 播客](http://www.delphi.org/2008/09/episode-7-beyond-compare/)。

但像大多数其他人一样，我建议使用 Git 或学习 Harvest。如果源代码控制系统允许更改其差异应用程序，Beyond Compare 将是一个很好的替代品。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-14T17:56:52.147

将共享视为您的源代码控制系统。将共享设为只读，这将迫使开发人员获取本地副本以进行更改。然后你有一个比较稳定的版本来比较。这将有助于促进能够进行“合并”。“检查”代码必须包含文件的某种备份策略（可能制作带有时间戳和用户名的文件副本作为新文件名的一部分）并用新版本替换原始文件。

话虽如此，在没有真正可靠的源代码控制系统的情况下进行此类活动将是困难且容易出错的。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-14T18:00:06.070

获取 git 并将其安装在每个开发人员的机器上。然后将存储库设置为复制。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-14T20:03:22.810

有两个不同的问题：版本控制和合并。绝对没有理由不使用版本控制系统。如果公司已经决定了一个解决方案（无论出于何种原因），那么就使用它。不喜欢它或对它没有“信心”并不是不使用它的正当理由。并且使用共享驱动器来模仿源代码控制系统是非常疯狂的。

合并是第二个问题。您只需要一个差异/合并工具。选一个。没有人你怎么走了这么久？！

Araxis是一个伟大的。花费几块钱。一段时间以来，SourceGear 的人们一直在免费分发他们的差异/合并工具（Vault 附带的工具）。它也是一个有力的竞争者。这是我用过的两个，我知道现在仍在市场上。还有一些人已经提到过。

手动合并所有内容不是一个可行的解决方案。将其与*不*使用 VCS 相结合是灾难的根源。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-14T17:59:39.863

除非您想手动下载，否则您可能必须下载一些东西。我强烈推荐[Winmerge](http://www.winmerge.org/)。它是免费的、开源的，而且对于你来说可能更适合一个不会搞砸的小下载。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-14T18:02:07.643

有一个标准的 unix 命令行工具，称为 merge，它可以相当智能地将两组更改合并到一个文件中。语法是：

```
merge mine older yours 
```

其中“mine”是包含您更改的文件，“older”是原始文件，“yours”包含其他人的更改。

不过，不确定您是否有一个 UNIX（或 Mac OS X）盒子来执行此操作。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-14T18:05:06.123

这可能不是一个可行的选择，但也许您可以使用像[bazaar](http://bazaar-vcs.org/)、[git](http://git.or.cz/)或[Mercurial](http://www.selenic.com/mercurial/wiki/)这样的分布式系统。

我建议这些的原因是它们的开销非常低，并且可以与其他系统一起使用。我知道在集市上，存储库只是添加到目录中的隐藏文件夹。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-14T18:02:47.953

使用共享驱动器不是一个好主意，并且得到我的“不信任”投票。

覆盖其他人的更改太容易了，您没有更改跟踪，无法分支或标记/标签等。

# c# - 从 Compact .Net 1.0 应用程序启动另一个应用程序

> ID：202147
> 
> 赞同：1
> 
> 时间：2008-10-14T17:51:50.783
> 
> 标签：c#, windows-mobile, compact-framework

有没有办法从 Compact .Net 框架 1.0 中启动另一个应用程序，类似于

```
System.Diagnostics.Process.Start 
```

在 Windows 端？

我需要启动一个 CAB 文件进行安装。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-14T18:54:56.833

看一眼

[http://www.pinvoke.net/default.aspx/coredll/CreateProcess.html](http://www.pinvoke.net/default.aspx/coredll/CreateProcess.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-14T19:38:27.590

您可以 P/Invoke [CreateProcess](http://msdn.microsoft.com/en-us/library/ms885182.aspx)或[ShellExecuteEx](http://msdn.microsoft.com/en-us/library/aa923541.aspx)。另一种方法是使用较旧的[智能设备框架](http://opennetcf.com/Default.aspx?tabid=91)(1.4)，它将这些 P/Invokes 与对象模型一起包装以匹配桌面。前者是直截了当的。后者将使您的代码对托管开发人员更具可移植性和可读性。

# java - 用Java替换文本文件的第一行

> ID：202148
> 
> 赞同：9
> 
> 时间：2008-10-14T17:52:16.710
> 
> 标签：java

我有一个文本文件，我只想更改文件的第一行。该文件可能有数百万行长，所以我宁愿不必遍历所有内容，所以我想知道是否有另一种方法可以做到这一点。

我还想对第一行应用一些规则，以便将某些单词的实例替换为其他单词。

这可能吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-14T18:06:41.360

A`[RandomAccessFile](http://java.sun.com/javase/6/docs/api/java/io/RandomAccessFile.html)`可以解决问题，除非结果行的长度与原始行的长度不同。

如果事实证明您被迫执行复制（第一行被替换，其余数据应按原样复制），我建议使用`[BufferedReader](http://java.sun.com/javase/6/docs/api/java/io/BufferedReader.html)`and `[BufferedWriter](http://java.sun.com/javase/6/docs/api/java/io/BufferedWriter.html)`。首先使用`BufferedReader`'s`readLine()`读取第一行。修改它并将其写入`BufferedWriter`. 然后使用`char[]`数组对文件的其余部分执行暴力复制。这将比逐行复制更有效。如果您需要详细信息，请告诉我..

另一种选择是在同一个文件中执行读取和写入。不过会稍微复杂一些。:) 如果您还需要这方面的详细信息，请告诉我..

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-14T18:04:00.010

如果新行的字符（字节）数量与原始第一行不同，则必须重新编写整个文件以消除间隙或避免覆盖第二行的一部分。

当然，各种工具，如`String.replaceFirst(String regex, String replacement)`( [javadoc](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/String.html#replaceFirst(java.lang.String,%20java.lang.String)) ) 或`RandomAccessFile`( [javadoc](http://java.sun.com/j2se/1.4.2/docs/api/java/io/RandomAccessFile.html) ) 可以帮助您完成这项任务。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-14T18:00:22.123

你想要一个[RandomAccesssFile](http://java.sun.com/javase/6/docs/api/java/io/RandomAccessFile.html)。使用该文件，您可以在文件中的任何位置读取和写入。

它很像 InputStream 和 OutputStream，但它允许在任何你喜欢的地方进行读写。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-14T18:01:22.200

只应用一次正则表达式。String.replaceFirst("regex", "replacementstring") ：http: [//java.sun.com/j2se/1.5.0/docs/api/java/lang/String.html#replaceFirst (java.lang.String,% 20java.lang.String)](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/String.html#replaceFirst(java.lang.String,%20java.lang.String))

将文件作为 RandomAccessFile 打开。将第一行读入字符串，然后应用更改，然后将字符串写回。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-05-30T19:06:01.210

```
public void main() throws IOException {
    String newString = "The New String";
    File myFile = new File("PathToFile");
    // An array to store each line in the file
    ArrayList<String> fileContent = new ArrayList<String>();
    Scanner myReader = new Scanner(myFile);
    while (myReader.hasNextLine()) {
        // Reads the file content into an array
        fileContent.add(myReader.nextLine());
    }
    myReader.close();
    // Removes Original Line
    fileContent.remove(0);
    // Enters New Line
    fileContent.add(0, newString);
    // Writes the new content to file
    FileWriter myWriter = new FileWriter("PathToFile");
    for (String eachLine : fileContent) {
        myWriter.write(eachLine + "\n");
    }
    myWriter.close();
} 
```

* * *

## 回答 #6

> 赞同：-5
> 
> 时间：2008-10-15T11:10:28.673

为什么不编写一个 Perl 脚本并使用 Runtime.exec() 调用它。虽然不是纯 Java 解决方案。在深入之前还可以看看这篇文章[http://www.javaworld.com/javaworld/jw-12-2000/jw-1229-traps.html](http://www.javaworld.com/javaworld/jw-12-2000/jw-1229-traps.html)

# apache-flex - Flex/AIR：自动吸收未分配/禁用的快捷键

> ID：202151
> 
> 赞同：1
> 
> 时间：2008-10-14T17:52:31.640
> 
> 标签：apache-flex, air, keyboard-shortcuts

我有一个带有`<mx:HTML>`组件的 AIR 应用程序，它呈现一个包含`HTML/Javascript`基于`WYSIWYG/rich-text editor`. 为格式化分配了各种键盘快捷键以及您有什么，但如果我键入一个未分配的快捷键
（**例如** `cmd`或 [`ctrl`在 Windows 上] + `M`），
则输入字符就像没有按下修饰键一样。如果分配了快捷方式但其菜单项被禁用，这甚至是正确的。

检测按下修饰符但未分配快捷方式并且应该忽略而不是在没有修饰键的情况下传递到 HTML 视图的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-14T19:19:17.563

没关系，我想通了。显然，即使您阻止了 KeyboardEvent 上的默认操作，菜单系统也会运行：

```
public var OperatingSystem:String = !!NativeApplication.supportsDockIcon ?
    'mac' :
    !!NativeApplication.supportsSystemTrayIcon ?
    'win' :
    'other';

stage.addEventListener('keyDown', function(e:KeyboardEvent):void {
    if(e[(OperatingSystem == 'mac' ? 'commandKey' : 'ctrlKey')]) {
        e.preventDefault();
    }
}); 
```

# asp.net - 有没有一种方法可以轻松地从 ASP.NET 站点打印页面？

> ID：202165
> 
> 赞同：4
> 
> 时间：2008-10-14T17:58:47.120
> 
> 标签：asp.net, printing

我的 PM 刚刚路过，他想要一份我们所有页面的副本……有没有一种方法可以为所有页​​面执行此操作而无需访问每个页面？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-14T18:06:11.083

免费/开源应用程序来抓取您自己的网站：

> [http://www.httrack.com/](http://www.httrack.com/)

然后将生成的本地 html 文件发送到打印机。

* * *

应该提到 httrack 有[一个配置来控制](http://www.httrack.com/html/step9_opt2.html)你遍历站点层次结构的深度（和其他选项）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-14T18:01:34.897

这是一个非常疯狂的想法，但是怎么样：

获取数组中所有页面的列表，并使用 JavaScript 以大约 20 秒的间隔加载每个页面。当页面加载时触发 window.print() Javascript 函数。打印作业将在 20 秒内完成，新页面被加载，同样的事情将再次发生。

# components - 将对象建模为“组件集合”的游戏引擎在运行时如何工作？

> ID：202166
> 
> 赞同：4
> 
> 时间：2008-10-14T17:59:21.500
> 
> 标签：components, composition

我正在编写一个轻量级游戏引擎，并且在为它做一些研究的同时，我遇到了许多令人信服的文章，它们提倡通过“组件集合”模型而不是“从具体类继承”模型来实现游戏对象。有很多优点：

*   可以使用数据驱动设计技术组合对象，允许设计人员在不涉及程序员的情况下提出新对象；
*   源文件依赖项往往更少，从而可以更快地编译代码；
*   整个引擎变得更加通用；
*   可以避免必须更改继承层次结构较高的具体类的不可预见的后果；
*   等等。

但是系统的某些部分仍然不透明。其中主要是同一对象的组件如何相互通信。例如，假设在游戏中模拟子弹的对象是根据以下组件实现的：

*   一些用于视觉表示的几何图形
*   世界地位
*   用于与其他对象碰撞的体积
*   其他事情

在渲染时，几何图形必须知道它在世界中的位置才能正确显示，但它如何在对象中的所有兄弟组件中找到该位置？并且在更新时，碰撞体积如何找到对象在世界中的位置以测试它与其他对象的交集？

我想我的问题可以归结为：好的，我们有由许多组件组成的对象，每个组件都实现了一些功能。这在运行时工作的最佳方式是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-15T15:55:22.967

追求此策略的另一个重要原因是能够从行为组件中组合对象的行为，从而允许您跨多个游戏对象重用行为。

因此，例如，您有一个具有以下属性的基本游戏对象类：**burnable**、**movable**、 a **​​live**。默认情况下，每个都包含对 null 的引用。如果你想让你的对象可燃，设置：

```
object.burnable = new Burnable(object); 
```

现在，任何时候你想烧一个对象，使用：

```
if (object.burnable != null)
{
   object.burnable.burn();
} 
```

可燃行为将以您想要的任何方式修改游戏对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-04T14:35:08.617

我已经看到（并尝试过）几种方法来实现这一点：

1）组件不存在于真空中，而是收集在“实体”（或“游戏对象”）对象中。所有组件都有指向其实体的链接，因此您的冲突可能会执行诸如 GetEntity()->GetComponent("Position")->GetCoords() 之类的操作（可能检查空向量等 - 详细信息取决于您的语言）重新工作）。

在这种情况下，有时将一些常见信息直接放在实体中会很方便（位置、唯一 ID、“活动/非活动”状态）——在制作“纯粹”和通用的东西和快速制作东西之间需要权衡和高效。

2）没有实体，只有组件（我将它用于我自己的轻量级游戏引擎）。在这种情况下，组件必须显式链接到其他组件，因此您的“碰撞”和“图形”可能会保留指向“位置”的指针。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-14T18:18:24.990

可组合架构通常依赖于接口。组件然后是实现+数据，使设计人员能够重新使用具有不同数据的可用实现。例如使用火箭代码一次与火箭图形和一次与箭头图形。灵活性来自于能够在实际运行时之外“配置”这样的组合。

在运行时，对象通过接口接收和提供必要的信息。例如，一个对象将接收一个原点和一个参考方向来定位自己在世界中。对于实际绘制的东西，我假设一种图形上下文将被传递，并且基础设施负责为当前对象适当地对齐默认偏移/投影。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-12T11:10:05.517

我一直发现[Kyle Wilson 的博客](http://gamearchitect.net/)是一个有趣的来源，来自与此相关的人，并且似乎给了它很多思考。特别是这个条目可能很有趣： http: [//gamearchitect.net/2008/06/01/an-anatomy-of-despair-aggregation-over-inheritance/](http://gamearchitect.net/2008/06/01/an-anatomy-of-despair-aggregation-over-inheritance/)。这不是文章的重点，但基本上他所说的是他们（在开发“ [Fracture](http://www.lucasarts.com/games/fracture/) ”时）有不同的层次结构。一个用于游戏对象，一个用于视觉表示的场景图。我个人认为这是一个非常合理的设计，但我不是该领域的专家。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-14T18:20:42.347

是否可以将对象引用回 Game 对象？

这将允许通过返回到 Game 对象然后向下钻取到世界位置来找到世界位置。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-04-16T19:07:14.910

我也在研究这个问题，并提出了一些既快速又非侵入性的解决方案。

拥有基于组件的应用程序的目的是您可以在运行时随时添加和删除组件，并且很少或没有耦合；组件可以在不知道彼此的情况下共存。

那么，“渲染”组件如何知道它应该在哪里渲染，或者更糟的是，它应该渲染什么？我的回答是每个兄弟组件都可以访问其容器（通常是游戏实体或游戏对象）持有的共享属性表

例如，假设一个游戏对象具有运动组件、渲染组件和角色组件

渲染组件向其容器请求名为“positionx”、“positiony”和“positionz”的属性（如果它是 3D 游戏），然后请求“rendermodel”属性。基于这些，渲染器组件在 positionx、positiony 和 positionz 处渲染 rendermodel 返回的属性。定位属性由移动组件更改，移动组件本身要求容器上的“速度”属性，而该属性又由字符组件根据键盘输入进行调整。

如果这些属性不存在，则在请求它们时创建它们并使用有效值（例如：0）进行初始化。

在我看来，组件永远不应该查询其他组件，因为它们必须被视为尽可能通用。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-10-14T18:20:20.320

听起来有点过度设计。通过使位置成为对象的抽象组件而不是基本属性，您可以获得什么？

但是，如果您真的想这样做，我想您可以设置一个依赖关系图，其中所有内容都明确连接。因此（例如）碰撞体积具有连接到位置组件输出的位置输入。看看 Maya 的内部结构，了解它是如何工作的。

但是，恕我直言，这看起来很像矫枉过正。

# c# - 用于实时运输报价的 .NET 组件

> ID：202171
> 
> 赞同：0
> 
> 时间：2008-10-14T17:59:45.183
> 
> 标签：c#, .net, asp.net, vb.net, components

在开发定制电子商务解决方案时，您使用过哪些“现成的”基于 .NET 的运输组件？

它绝对必须提供实时运输报价，并且可以轻松集成到 ASP.NET 网站中。理想情况下，我希望它支持大多数常见的美国国内运输公司（UPS、FedEx、USPS 等）。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-15T09:08:28.233

有[.net SHIP](http://www.dotnetship.com/)，我没有使用过，但我成功使用了他们的 .net CHARGE 产品。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-14T18:05:43.283

UPS 有可用的网络服务，这些服务很容易通过 .NET 代理等公开。这就是我们所使用的。对于 DHL、FedEx 和 USPS 等其他托运人，我们会根据自己的运输和处理成本进行估算。

通常你会想用你自己的成本来弥补他们的成本。

# c# - 如何管理在 C# 中插入的并发性？

> ID：202184
> 
> 赞同：1
> 
> 时间：2008-10-14T18:03:05.177
> 
> 标签：c#, concurrency

许多乐观并发示例通过使用数据库时间戳或标志来引用更新。

但是，我想处理 INSERTS 的乐观并发

为了说明这里是一个假的场景：

多个用户可以同时插入一个日记帐分录，但每个日期只允许一个日记帐分录。

由于多个用户可以创建日记帐分录，因此没有任何并发​​控制，我最终可以在同一日期创建多个日记帐分录。

在不使用数据库（即数据库唯一键约束）的情况下，如何防止在应用层发生这种情况

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-14T18:09:51.527

无论您是否定义明确的唯一键约束，这正是您所要求的。

您可以在 SQL 代码中编写一个 IF 块来检查指定日期的日记帐分录是否存在。

但是明确的唯一键约束将提供更好的性能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-14T18:09:21.683

您可以编写一个“插入时”触发器来检查表的内容，然后在不满足您的条件时丢弃插入。这适用于大多数 RDBMS。

# linux - 我应该开始分发我的系统为 Wine 准备好了吗？

> ID：202188
> 
> 赞同：9
> 
> 时间：2008-10-14T18:05:09.697
> 
> 标签：linux, cross-platform, wine, opensuse, suse

我已经在 Wine（OpenSuse Linux）上测试了我在 Delphi（在 Windows XP 中）开发的所有系统，它们运行良好。我的问题是：我应该开始分发我的系统（在我可以支持的本地基础上）为 Wine 准备好还是我应该考虑其他问题？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-14T18:06:53.733

您可以做 Google 所做的事情，并将 Wine 与应用程序打包在一起。这样就不用担心 Wine 将来会改变某些东西并阻止您的应用程序运行。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-14T18:18:49.760

是的，这将是一个好主意。所有可以帮助 Linux 和 Windows 世界之间交流的东西都是一个加分项。如果您可以在 Linux 中本地编译您的代码，那就更好了。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-07T15:10:51.303

您应该将 Wine 列为受支持的平台，说明您测试过的 Wine 版本，并要求在[http://wiki.winehq.org/AppsThatSupportWine上将其添加到支持 wine 的应用程序列表中](http://wiki.winehq.org/AppsThatSupportWine)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-14T18:19:44.410

就个人而言，我很乐意看到您所描述的“预”跨平台的应用程序。

[@Mark 的](https://stackoverflow.com/questions/202188/should-i-start-distributing-my-systems-as-wine-ready#202194)回答也是一个好主意：分发 Wine 的静态链接版本，虽然它会使您的产品更大，但会确保它能够运行，即使存在会破坏某些东西的新版本（我想起了那些发布他们自己的 JRE 以确保他们的工具正确运行）。

也许葡萄酒社区应该采取行动，提供“为葡萄酒制造”的贴纸/标志？

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-04T04:26:08.857

是的...然后我们可以将您的应用添加到 [http://wiki.winehq.org/AppsThatSupportWine](http://wiki.winehq.org/AppsThatSupportWine)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-14T19:00:11.627

我会发布一个通知，说明您的应用程序已经过认证可以与 WINE 版本一起使用，并且它可能与其他版本的 WINE 一起使用，也可能不适用。您应该考虑使用 wine 的 beta 和 rc 版本测试您的应用程序，以确保它们在发布周期内保持兼容。

将您的 WINE 安装沙箱化很简单。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-22T01:23:15.063

[让你的应用程序使用Free Pascal](http://www.freepascal.org/)和[Lazarus](http://www.lazarus.freepascal.org/)构建在 Linux 系统上会是一个巨大的收获，但代价是给你带来一些痛苦。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-04T04:46:53.277

如果您的应用程序在 Wine 中运行，您能不尝试本地编译它并链接到 winelib 吗？

# ms-access - 如何在 MS Access 数据库模块中使用 sftp？

> ID：202197
> 
> 赞同：5
> 
> 时间：2008-10-14T18:07:29.113
> 
> 标签：ms-access, vba, sftp

我需要在 Access 中创建一个简单的数据库来收集一些用户数据，这些数据将被加载到另一个数据库中以供进一步报告。Access db 中将有一个模块，当用户调用（可能通过单击按钮）时，该模块会将查询输出到分隔文件。用户还需要一种机制（例如带有按钮的表单）来使用 sftp 轻松地将文件传输到远程服务器。有谁知道如何做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-14T18:41:39.280

如果您想完成此操作，您可以简单地通过批处理文件编写对 sftp 命令行客户端的调用。

查看 VBA 中的 Shell() 函数。

在表单上按钮的单击事件下，添加代码：

```
mySFTPCall = "sftp <insert your options here!>"
Call Shell(mySFTPCall, 1) 
```

我以前用它来直接跨网络共享复制文件等，以共享来自内部 Access DB 的数据。当然，如果有必要，你可以变得更花哨。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-20T08:52:22.850

您可以使用我们的[SFTPBlackbox (ActiveX Edition)](http://www.eldos.com/sbbdev/activex-sftp.php)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-14T18:28:56.997

我想你只需要找到一个 FTP COM 对象。然后，您应该能够在 Access 模块代码中实例化它。dart.com 有一个，我相信还有更多（只是 Google FTP COM）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-14T18:49:46.673

您可以对命令行应用程序（例如免费软件[MOVEit Freely](http://www.ipswitchft.com/products/moveit/client/freely/index.asp)）进行 shell 调用，以编写安全 ftp 传输脚本。我过去使用过它，它有一些不错的功能并且运行良好。

> *MOVEit Freely 是一个免费的命令行 FTP/安全 FTP SSL (FTPS) 客户端，适用于 Windows Vista Business Edition、2003、XP、2000、ME 和 NT 4.0 系统。*

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-14T18:54:08.787

[Chilkat](http://www.chilkatsoft.com/ftp-features.asp)有一个与 COM/ActiveX 一起工作的 FTP 组件。它说它支持 FTP over SSL (FTPS)，我认为它与 SFTP 相同。我以前在.Net 上使用过他们的一些其他产品，它们的效果非常好。他们提供免费试用，因此您可以下载并检查它们是否适合您，您不会有任何损失。

# ruby-on-rails - 实施社交活动流的最佳方式是什么？

> ID：202198
> 
> 赞同：270
> 
> 时间：2008-10-14T18:07:37.133
> 
> 标签：ruby-on-rails, android-activity, social-networking

我很想听听您的意见，哪些是实施社交活动流的最佳方式（Facebook 是最著名的例子）。涉及的问题/挑战是：

*   不同类型的活动（发布，评论..）
*   不同类型的对象（帖子、评论、照片..）
*   1-n 个不同角色的用户（“用户 x 回复了用户 y 对用户 Z 帖子的评论”）
*   同一活动项目的不同视图（“您评论了..”与“您的朋友 x 评论了”与“用户 x 评论了..”=>“评论”活动的 3 种表示）

.. 还有更多，特别是如果你把它提升到高水平，就像 Facebook 所做的那样，例如，将几个活动项目合并为一个（“用户 x、y 和 z 评论了那张照片”

任何关于模式、论文等关于实现此类系统、数据模型等的最灵活、最有效和最强大的方法的想法或指针将不胜感激。

尽管大多数问题与平台无关，但我最终可能会在 Ruby on Rails 上实现这样的系统

* * *

## 回答 #1

> 赞同：145
> 
> 时间：2008-10-15T16:45:31.913

我已经创建了这样的系统，并采用了这种方法：

具有以下列的数据库表：id、userId、type、data、time。

*   **userId**是生成活动的用户
*   **type**是活动的类型（即写博客文章、添加照片、评论用户照片）
*   **data**是一个序列化对象，其中包含活动的元数据，您可以在其中放入任何您想要的内容

这限制了搜索/查找，您可以在提要中对用户、时间和活动类型进行，但在 facebook 类型的活动提要中，这并不是真正的限制。并且在表格上使用正确的索引，查找*速度很快*。

使用这种设计，您必须决定每种类型的事件应该需要哪些元数据。例如，一张新照片的提要活动可能如下所示：

```
{id:1, userId:1, type:PHOTO, time:2008-10-15 12:00:00, data:{photoId:2089, photoName:A trip to the beach}} 
```

您可以看到，虽然照片的名称肯定存储在包含照片的其他表中，并且我可以从那里检索名称，但我将在元数据字段中复制名称，因为您不想这样做如果您想要速度，可以在其他数据库表上进行任何连接。为了显示来自 50 个不同用户的 200 个不同事件，您需要速度。

然后我有扩展基本 FeedActivity 类的类，用于呈现不同类型的活动条目。事件的分组也将在渲染代码中构建，以避免数据库的复杂性。

* * *

## 回答 #2

> 赞同：118
> 
> 时间：2011-02-16T21:34:26.167

这是一个很好的演示文稿，概述了 Etsy.com 如何构建他们的活动流。这是我在该主题上找到的最佳示例，尽管它不是特定于 Rails 的。

[http://www.slideshare.net/danmckinley/etsy-activity-feeds-architecture](http://www.slideshare.net/danmckinley/etsy-activity-feeds-architecture)

* * *

## 回答 #3

> 赞同：45
> 
> 时间：2013-10-30T13:13:55.363

我们已经开源了我们的方法： [https](https://github.com/tschellenbach/Stream-Framework) ://github.com/tschellenbach/Stream-Framework 它是目前最大的旨在解决这个问题的开源库。

构建 Stream Framework 的同一团队还提供了一个托管 API，它可以为您处理复杂性。查看[getstream.io](https://getstream.io)有适用于 Node、Python、Rails 和 PHP 的客户端。

另外看看这篇高可扩展性帖子，我们解释了一些涉及的设计决策：http: [//highscalability.com/blog/2013/10/28/design-decisions-for-scaling-your-high-traffic-提要.html](http://highscalability.com/blog/2013/10/28/design-decisions-for-scaling-your-high-traffic-feeds.html)

[本教程](http://www.mellowmorning.com/2013/10/18/scalable-pinterest-tutorial-feedly-redis/)将帮助您使用 Redis 设置像 Pinterest 的提要这样的系统。这很容易上手。

要了解有关提要设计的更多信息，我强烈建议阅读我们基于提要的一些文章：

*   [雅虎研究论文](http://research.yahoo.com/files/sigmod278-silberstein.pdf)
*   [Twitter 2013 基于 Redis](http://highscalability.com/blog/2013/7/8/the-architecture-twitter-uses-to-deal-with-150m-active-users.html)，带有回退
*   [Instagram 上的卡桑德拉](http://planetcassandra.org/blog/post/instagram-making-the-switch-to-cassandra-from-redis-75-instasavings)
*   [Etsy 饲料缩放](http://www.slideshare.net/danmckinley/etsy-activity-feeds-architecture/)
*   [脸书历史](http://www.infoq.com/presentations/Facebook-Software-Stack)
*   [Django 项目](http://django-activity-stream.readthedocs.io/en/latest/)，具有良好的命名约定。（但仅限数据库）
*   [http://activitystrea.ms/specs/atom/1.0/](http://activitystrea.ms/specs/atom/1.0/)（演员、动词、宾语、目标）
*   [Quora 上关于最佳实践的帖子](http://www.quora.com/What-are-best-practices-for-building-something-like-a-News-Feed?q=news%20feeds)
*   [Quora 扩展社交网络提要](http://www.quora.com/What-are-the-scaling-issues-to-keep-in-mind-while-developing-a-social-network-feed)
*   [Redis 红宝石示例](http://web.archive.org/web/20130525202810/http://blog.waxman.me/how-to-build-a-fast-news-feed-in-redis)
*   [FriendFeed 方法](http://backchannel.org/blog/friendfeed-schemaless-mysql)
*   [Thoonk 设置](http://blog.thoonk.com/)
*   [Twitter的方法](http://www.slideshare.net/nkallen/q-con-3770885)

尽管 Stream Framework 是基于 Python 的，但在 Ruby 应用程序中使用它并不难。您可以简单地将其作为服务运行并在其前面粘贴一个小型 http API。我们正在考虑添加一个 API 以从其他语言访问 Feedly。目前，您必须扮演自己的角色。

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2008-10-15T14:03:42.473

事件流的最大问题是可见性和性能。您需要将显示的事件限制为仅对该特定用户感兴趣的事件，并且您需要将整理和识别这些事件所需的时间保持在可管理的范围内。我建立了一个小型社交网络；我发现在小范围内，在数据库中保留一个“事件”表是可行的，但在中等负载下它会成为一个性能问题。

对于较大的消息和用户流，最好使用消息系统，其中事件作为消息发送到个人配置文件。这意味着您不能轻松订阅人们的事件流并非常容易地查看以前的事件，但是当您需要为特定用户呈现流时，您只是呈现一小组消息。

我相信这是 Twitter 最初的设计缺陷——我记得读过他们正在访问数据库以提取和过滤他们的事件。这与架构有关，与 Rails 无关，Rails（不幸的是）催生了“ruby 无法扩展”的模因。我最近看到一个演示文稿，其中开发人员使用 Amazon 的[Simple Queue Service](http://aws.amazon.com/sqs/)作为他们的消息传递后端，用于类似 twitter 的应用程序，该应用程序具有更高的扩展能力 - 如果您的负载足够高，可能值得将 SQS 作为您系统的一部分进行研究.

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2012-11-01T05:11:22.877

如果您愿意使用单独的软件，我建议您使用 Graphity 服务器，它可以完全解决活动流的问题（构建在 neo4j 图形数据库之上）。

这些算法已作为独立的 REST 服务器实现，因此您可以托管自己的服务器以提供活动流：[http ://www.rene-pickhardt.de/graphity-server-for-social-activity-streams-released-gplv3 /](http://www.rene-pickhardt.de/graphity-server-for-social-activity-streams-released-gplv3/)

在论文和基准测试中，我展示了检索新闻流仅线性依赖于您想要检索的项目数量，而不会从非规范化数据中获得任何冗余：

[http://www.rene-pickhardt.de/graphity-an-efficient-graph-model-for-retrieving-the-top-k-news-feeds-for-users-in-social-networks/](http://www.rene-pickhardt.de/graphity-an-efficient-graph-model-for-retrieving-the-top-k-news-feeds-for-users-in-social-networks/)

在上面的链接中，您可以找到截屏视频和这种方法的基准（表明 graphity 每秒能够检索超过 10k 个流）。

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2008-10-15T20:43:59.873

```
// 每个实际事件一个条目
事件{
  id、时间戳、类型、数据
}

// 每个事件一个条目，每个包含该事件的提要
events_feeds {
  event_id, feed_id
}

```

创建事件后，确定它出现在哪些提要中并将这些提要添加到 events_feeds。要获取提要，请从 events_feeds 中选择，加入事件，按时间戳排序。然后可以对该查询的结果进行过滤和聚合。使用此模型，您无需额外工作即可在创建后更改事件属性。

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2008-12-09T11:08:06.860

我昨天开始实施这样的系统，这就是我必须...

我创建了一个**StreamEvent**类，其中包含属性*Id*、*ActorId*、*TypeId*、*Date*、*ObjectId*和一个包含其他*详细信息*键/值对的哈希表。这在数据库中由**StreamEvent**表（*Id*、*ActorId*、*TypeId*、*Date*、*ObjectId*）和**StreamEventDetails**表（*StreamEventId*、*DetailKey*、*DetailValue*）表示。

ActorId 、*TypeId*和*ObjectId*允许捕获（并稍后查询）一个 Subject-Verb-Object 事件*。*每个操作都可能导致创建多个 StreamEvent 实例。

 **然后，我为每种类型的事件创建了 StreamEvent 的子类，例如**LoginEvent**、**PictureCommentEvent**。这些子类中的每一个都有更多特定于上下文的属性，例如*PictureId*、*ThumbNail*、*CommenText*等（事件所需的任何内容），它们实际上作为键/值对存储在 hashtable/StreamEventDetail 表中。

从数据库中提取这些事件时，我使用工厂方法（基于*TypeId*）来创建正确的 StreamEvent 类。

StreamEvent 的每个子类都有一个 Render( *context* As **StreamContext** ) 方法，该方法根据传递的**StreamContext**类将事件输出到屏幕。StreamContext 类允许根据视图的上下文设置选项。例如，如果您查看 Facebook，主页上的新闻提要列出了参与每个操作的每个人的全名（以及指向他们个人资料的链接），而查看朋友的提要，您只会看到他们的名字（但其他演员的全名） .

我还没有实现聚合提要（Facebook 主页），但我想我会创建一个**AggregateFeed**表，其中包含字段*UserId*、*StreamEventId*，它是基于某种“嗯，你可能会发现这个有趣的”算法填充的。

任何评论将不胜感激。

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2008-12-03T10:59:03.997

如果你决定要在 Rails 中实现，也许你会发现以下插件很有用：

活动流：http: [//github.com/face/activity_streams/tree/master](http://github.com/face/activity_streams/tree/master)

如果不出意外，您将看到一个实现，包括数据模型以及为推送和拉取活动提供的 API。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2008-11-19T17:44:50.077

我有一个与 heyman 类似的方法——一个非规范化的表，其中包含将在给定活动流中显示的所有数据。它适用于活动有限的小型网站。

如上所述，随着站点的增长，它可能会面临可扩展性问题。就个人而言，我现在并不担心扩展问题。我稍后会担心这个。

Facebook 显然在扩展方面做得很好，所以我建议你阅读他们的工程博客，因为它有很多很棒的内容 -> [http://www.facebook.com/notes.php?id=9445547199](http://www.facebook.com/notes.php?id=9445547199)

我一直在寻找比我上面提到的非规范化表更好的解决方案。我发现实现此目的的另一种方法是将给定活动流中的所有内容压缩到一行中。它可以以 XML、JSON 或您的应用程序可以读取的某种序列化格式存储。更新过程也很简单。活动后，将新活动放入队列（可能使用 Amazon SQS 或其他），然后不断轮询队列以获取下一项。抓取该项目，对其进行解析，并将其内容放入存储在数据库中的适当提要对象中。

这种方法的好处是，您只需在请求特定提要时读取单个数据库表，而不是抓取一系列表。此外，它允许您维护有限的活动列表，因为您可以在更新列表时弹出最旧的活动项。

希望这可以帮助！:)

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2013-04-18T15:54:27.237

关于这样的活动流有两个 railscasts：

*   [http://railscasts.com/episodes/406-public-activity](http://railscasts.com/episodes/406-public-activity)（带有 gem [public_activity](https://github.com/pokonski/public_activity)的活动源）
*   [http://railscasts.com/episodes/407-activity-feed-from-scratch](http://railscasts.com/episodes/407-activity-feed-from-scratch)（同样的事情从头开始）

这些解决方案不包括您的所有要求，但它应该给您一些想法。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2008-10-14T18:15:23.793

我认为[Plurk 的](http://plurk.com)方法很有趣：它们以一种看起来很像 Google Finance 的股票图表的格式提供您的整个时间线。

[Ning](http://ning.com)可能值得一看，看看社交网络是如何运作的。[开发人员](http://developer.ning.com)页面看起来特别有用。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-11-18T02:50:48.373

几个月前我解决了这个问题，但我认为我的实现太基础了。
我创建了以下模型：

```
HISTORY_TYPE

ID           - The id of the history type
NAME         - The name (type of the history)
DESCRIPTION  - A description

HISTORY_MESSAGES

ID
HISTORY_TYPE - A message of history belongs to a history type
MESSAGE      - The message to print, I put variables to be replaced by the actual values

HISTORY_ACTIVITY

ID
MESSAGE_ID    - The message ID to use
VALUES        - The data to use 
```

例子

```
MESSAGE_ID_1 => "User %{user} created a new entry"
ACTIVITY_ID_1 => MESSAGE_ID = 1, VALUES = {user: "Rodrigo"} 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2013-06-19T03:20:56.980

在实现活动流以在多个应用程序中启用社交订阅、微博和协作功能后，我意识到基本功能非常普遍，可以通过 API 转换为您使用的外部服务。如果您将流构建到生产应用程序中并且没有独特或非常复杂的需求，那么使用经过验证的服务可能是最好的方法。我绝对会向生产应用程序推荐这个，而不是在关系数据库之上滚动您自己的简单解决方案。

我的公司 Collabinate ( [http://www.collabinate.com](http://www.collabinate.com) ) 就是从这种认识中成长起来的，我们在图形数据库之上实现了一个可扩展的高性能活动流引擎来实现它。我们实际上使用了 Graphity 算法的一种变体（改编自 @RenePickhardt 的早期工作，他也在此处提供了答案）来构建引擎。

如果您想自己托管引擎或需要专门的功能，核心代码实际上是开源的，用于非商业目的，欢迎您查看。

# mysql - 如何让 MySQL 正确处理 UTF-8

> ID：202205
> 
> 赞同：115
> 
> 时间：2008-10-14T18:09:31.463
> 
> 标签：mysql, utf-8

[我昨天提出的一个问题](https://stackoverflow.com/questions/198721/converting-a-word-document-into-usable-html-in-php)的回答之一建议我应该确保我的数据库可以正确处理 UTF-8 字符。我怎么能用 MySQL 做到这一点？

* * *

## 回答 #1

> 赞同：102
> 
> 时间：2008-10-14T18:21:03.190

**更新：**

简短的回答 - 您应该几乎总是使用`utf8mb4`字符集和`utf8mb4_unicode_ci`排序规则。

要更改数据库：

```
ALTER DATABASE dbname CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci; 
```

看：

*   Aaron 对此答案的评论[如何使 MySQL 正确处理 UTF-8](https://stackoverflow.com/questions/202205/how-to-make-mysql-handle-utf-8-properly#comment28222734_202246)

*   [utf8_general_ci 和 utf8_unicode_ci 有什么区别](https://stackoverflow.com/questions/766809/whats-the-difference-between-utf8-general-ci-and-utf8-unicode-ci)

*   转换指南：[https ://dev.mysql.com/doc/refman/5.5/en/charset-unicode-conversion.html](https://dev.mysql.com/doc/refman/5.5/en/charset-unicode-conversion.html)

**原答案：**

MySQL 4.1 及更高版本有一个默认的 UTF-8 字符集。您可以在`my.cnf`文件中验证这一点，记住设置客户端**和**服务器（`default-character-set`和`character-set-server`）。

如果您有想要转换为 UTF-8 的现有数据，请转储您的数据库，然后将其导入为 UTF-8，确保：

*   `SET NAMES utf8`在查询/插入数据库之前使用
*   `DEFAULT CHARSET=utf8`创建新表时使用
*   此时，您的 MySQL 客户端和服务器应该是 UTF-8（请参阅 参考资料`my.cnf`）。请记住，您使用的任何语言（例如 PHP）也必须是 UTF-8。某些版本的 PHP 将使用他们自己的 MySQL 客户端库，它可能不支持 UTF-8。

如果您确实要迁移现有数据，请记住先备份！当事情没有按计划进行时，可能会发生很多奇怪的数据截断！

一些资源：

*   [完成 UTF-8 迁移](http://www.oreillynet.com/onlamp/blog/2006/01/turning_mysql_data_in_latin1_t.html)(cdbaby.com)
*   关于[php 函数的 UTF-8 准备情况的](http://www.phpwact.org/php/i18n/utf-8)文章（请注意其中一些信息已过时）

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2008-10-14T18:30:19.597

为了使这个“永久”，在`my.cnf`：

```
[client]
default-character-set=utf8
[mysqld]
character-set-server = utf8 
```

要检查，请转到客户端并显示一些变量：

```
SHOW VARIABLES LIKE 'character_set%'; 
```

验证它们都是`utf8`，除了`..._filesystem`，应该是`binary`and `..._dir`，它指向 MySQL 安装中的某个位置。

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2015-04-28T20:51:10.933

MySQL 4.1 及更高版本有一个它调用的默认字符集，`utf8`但它实际上只是 UTF-8 的一个子集（只允许三字节或更小的字符）。

`utf8mb4`如果您想要“完整”UTF-8，请用作您的字符集。

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2016-01-20T01:26:23.857

简短的回答：`utf8mb4`在 4 个地方使用：

*   您客户端中的字节是 utf8，而不是 latin1/cp1251/等。
*   `SET NAMES utf8mb4`或建立客户端与 MySQL 的连接时的等效项
*   `CHARACTER SET utf8mb4`在所有表/列上——除了严格为 ascii/hex/country_code/zip_code/etc 的列。
*   `<meta charset charset=UTF-8>`如果您要输出到 HTML。（是的，这里的拼写不同。）

[*更多信息*](http://mysql.rjweb.org/doc.php/charcoll#best_practice)；
[*一路UTF8*](https://stackoverflow.com/questions/279170/utf-8-all-the-way-through)

上述链接提供了“解决所有问题需要详细的规范答案”。-- 本论坛有空间限制。

**编辑**

除了`CHARACTER SET utf8mb4`包含“所有”世界的字符之外，`COLLATION utf8mb4_unicode_520_ci`还可以使用“最佳全能”排序规则。（对于那些想要这些语言的细微差别的人来说，还有土耳其语、西班牙语等排序规则。）

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-14T18:32:39.907

字符集是数据库（默认）和表的属性。你可以看看（MySQL命令）：

```
show create database foo; 
> CREATE DATABASE  `foo`.`foo` /*!40100 DEFAULT CHARACTER SET latin1 */

show create table foo.bar;
> lots of stuff ending with
> ) ENGINE=InnoDB AUTO_INCREMENT=252 DEFAULT CHARSET=latin1 
```

换句话说; 检查您的数据库字符集或更改它很容易：

```
ALTER TABLE `foo`.`bar` CHARACTER SET utf8; 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-05-20T12:14:19.900

我遵循了哈维尔的解决方案，但我在 my.cnf 中添加了一些不同的行：

```
[myslqd]
skip-character-set-client-handshake
collation_server=utf8_unicode_ci
character_set_server=utf8 
```

我在这里找到了这个想法：http: [//dev.mysql.com/doc/refman/5.0/en/charset-server.html](http://dev.mysql.com/doc/refman/5.0/en/charset-server.html)在页面底部的第一个/唯一用户评论中。他提到*跳过字符集客户端握手*具有一定的重要性。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2016-01-25T07:14:19.303

要将数据库本身的字符集编码更改为 UTF-8，请在 mysql> 提示符下键入以下命令。USE `ALTER DATABASE`.. 将 DBNAME 替换为数据库名称：

```
ALTER DATABASE DBNAME CHARACTER SET utf8 COLLATE utf8_general_ci; 
```

这是这个问题的副本[如何将整个 MySQL 数据库字符集和排序规则转换为 UTF-8？](https://stackoverflow.com/questions/6115612/how-to-convert-an-entire-mysql-database-characterset-and-collation-to-utf-8/34986915#34986915)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-01-25T08:01:34.123

将您的设置`database collation`为`UTF-8` 然后应用`table collation`到数据库默认值。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2016-01-20T06:04:45.443

您的答案是您可以通过 MySql 设置进行配置。在我的回答中可能有些断章取义，但这也知道对您有帮助。
*如何配置`Character Set`和`Collation`*。

> 对于使用默认 MySQL 字符集和排序规则 ( ) 存储数据的应用程序`latin1, latin1_swedish_ci`，不需要特殊配置。如果应用程序需要使用不同的字符集或排序规则存储数据，您可以通过多种方式配置字符集信息：

*   *指定每个数据库的字符设置。*例如，使用一个数据库`utf8`的应用程序可能需要 sjis，而使用另一个数据库的应用程序可能需要 sjis。
*   *在服务器启动时指定字符设置。*这会导致服务器将给定的设置用于不进行其他安排的所有应用程序。
*   *如果您从源代码构建 MySQL，请*在配置时指定字符设置。*这会导致服务器对所有应用程序使用给定的设置，而无需在服务器启动时指定它们。*

 *此处显示的示例为您设置 utf8 字符集的问题，此处还设置了排序规则以获得更多帮助（`utf8_general_ci`排序规则`）。

**指定每个数据库的字符设置**

```
 CREATE DATABASE new_db
  DEFAULT CHARACTER SET utf8
  DEFAULT COLLATE utf8_general_ci; 
```

**在服务器启动时指定字符设置**

```
[mysqld]
character-set-server=utf8
collation-server=utf8_general_ci 
```

**在 MySQL 配置时指定字符设置**

```
shell> cmake . -DDEFAULT_CHARSET=utf8 \
           -DDEFAULT_COLLATION=utf8_general_ci 
```

*要查看适用于您的连接的字符集和排序规则系统变量的值，请使用以下语句：*

```
SHOW VARIABLES LIKE 'character_set%';
SHOW VARIABLES LIKE 'collation%'; 
```

这可能是一个冗长的答案，但有办法，你可以使用。希望我的回答对你有所帮助。更多信息[http://dev.mysql.com/doc/refman/5.7/en/charset-applications.html](http://dev.mysql.com/doc/refman/5.7/en/charset-applications.html)

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2021-08-14T10:41:26.880

这对我有用：

mysqli_query($connection, "SET NAMES 'utf8'");

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2016-04-14T07:22:33.750

与 UTF-8 的数据库连接

```
$connect = mysql_connect('$localhost','$username','$password') or die(mysql_error());
mysql_set_charset('utf8',$connect);
mysql_select_db('$database_name','$connect') or die(mysql_error()); 
```

* * *

## 回答 #12

> 赞同：-3
> 
> 时间：2008-10-14T18:21:46.277

`SET NAMES UTF8`

这是诀窍

* * *

## 回答 #13

> 赞同：-3
> 
> 时间：2013-08-12T21:44:49.613

将数据库连接设置为 UTF8：

```
 if($handle = @mysql_connect(DB_HOST, DB_USER, DB_PASS)){          
         //set to utf8 encoding
         mysql_set_charset('utf8',$handle);
  } 
```

* * *

## 回答 #14

> 赞同：-3
> 
> 时间：2015-06-09T07:41:27.710

能够找到解决方案。[按照http://technoguider.com/2015/05/utf8-set-up-in-mysql/](http://technoguider.com/2015/05/utf8-set-up-in-mysql/)的规定运行以下内容

```
SET NAMES UTF8;
set collation_server = utf8_general_ci;
set default-character-set = utf8;
set init_connect = ’SET NAMES utf8′;
set character_set_server = utf8;
set character_set_client = utf8; 
```

# sql-server - 您会为 SQL Server 推荐哪种乐观锁定方案？

> ID：202206
> 
> 赞同：0
> 
> 时间：2008-10-14T18:09:51.433
> 
> 标签：sql-server, concurrency

我正在使用 .Net 1.1 和 SQL Server 2000 构建企业应用程序。我使用读提交隔离级别。然而，非功能性需求的变化使得有必要对不可重复读取和幻像采取措施。我看到两个选项：

1.  引入行版本控制以检查行在事务中读取后是否已被修改。这是通过将 VersionId 列添加到表 abd 来完成的，该列在行更改时递增该值。这将解决问题，但需要我们重写所有存储过程和应用程序的数据访问层。

2.  迁移到 SQL Server 2005 并使用快照隔离级别。这样可以省去我们重写代码的麻烦，但也有一些挑战：快照隔离级别在 .Net 1.1 中是未知的，因此我们必须额外往返服务器以手动设置它。湾。我们不能在存储过程中使用临时表，因为快照隔离级别不允许更改 tempdb 的架构。我不知道如何解决这个问题。

任何想法或建议都非常好

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-28T14:49:56.207

我建议您升级到 2005/2008 并启用读取提交快照选项。一旦启用，它会使任何要求读取已提交的事务使用行版本控制而不是锁。与完整快照隔离相比，它对 TempDB 的影响也较小。

您在使用临时表和快照时遇到什么问题？我可以毫无问题地在快照隔离中创建临时表。我知道的唯一限制是您是否使用全局临时表。要使全局临时表正常工作，必须`ALLOW_SNAPSHOT_ISOLATION`启用 tempDB，或者必须将锁定提示添加到查询中以将语句更改为另一个隔离级别。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-14T18:16:21.437

关于选项＃2的一些想法：

您无需额外往返服务器。我可以想到大约 3 种不同的方法来避免它，包括将命令预先添加到您现有的查询字符串、移动到存储过程并将其设置在那里等。
此外，您可以绕过 SQL Server 2005 并直接进入 SQL Server 2008 ，现在已经出来了。

如果您使用选项 #1，请查看将时间戳数据类型用于您的 versionid 列。

# c# - Outlook VSTO 未在 NewMailEx 事件中触发？

> ID：202212
> 
> 赞同：2
> 
> 时间：2008-10-14T18:10:07.050
> 
> 标签：c#, .net-3.5, outlook, vsto

我在 C# 中创建了一个 VSTO，它应该挂钩 Outlook 2007 的 NewMailEx 事件。但是，有时当我进行手动发送/接收时，或者当收件箱中只有 1 封未读邮件时，它不会触发。似乎它在消息实际到达之前就在收件箱中触发了。

除了使用 VSTO 的 ItemAdd 或 NewMailEX 之外，是否有更好的方法来监控**每次新消息？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-15T10:59:40.787

原因是：“GC 收集 .NET 对象，它从 Outlook 包装 COM 对象）”。解决方案是保持对这个 .NET 对象的引用。最简单的方法是：

```
// this is helper collection.
// there are all wrapper objects
// , which should not be collected by GC
private List<object> holdedObjects = new List<object>();

// hooks necesary events
void HookEvents() {
    // finds button in commandbars
    CommandBarButton btnSomeButton = FindCommandBarButton( "MyButton ");
    // hooks "Click" event
    btnSomeButton.Click += btnSomeButton_Click;
    // add "btnSomeButton" object to collection and
    // and prevent themfrom collecting by GC
    holdedObjects.Add( btnSomeButton );
} 
```

如果需要，您还可以为此（和其他）具体按钮（或其他对象）设置一个特殊字段。但这是最常见的解决方案。

# graphics - 为小型设备编写用户界面

> ID：202223
> 
> 赞同：3
> 
> 时间：2008-10-14T18:14:55.213
> 
> 标签：graphics, user-interface, embedded

我正在为我正在制作的设备寻找用户界面的想法/元素。 [完整的描述（和开发设置的视频）在这里。](http://mypic32.com/web/guest/contestantsprofiles?profileID=50331)

简而言之：

*   它本质上是一个测向仪，所以我开始思考“指南针”，但想知道其他设计模式是否适合
*   指南针没有太多接口 - 除了物理转动设备之外，我应该考虑哪些类型的输入？
*   我不喜欢深度菜单。这些都是针对孩子的，那么我应该考虑哪些游戏模式和界面来选择？我假设孩子们没有在计算机模式上投入大量资金，但不知道他们投入了哪些模式。

该设备的内存有限 - 因此每次刷新都必须动态绘制界面，没有视频缓冲区。在某些版本中，我将拥有彩色（160x128 和 320x240），而在其他版本中，我将拥有 15 级灰度（100x160）。我希望界面足够通用，并且足够矢量化，以便人们可以像使用其他设备一样轻松地使用任何设备。

你有什么想法？

我应该在哪里寻找这样的界面和设计模式？

我应该在哪里寻找低级图形编程（我希望动态生成矢量图形，但我这样想可能是错误的）？

-亚当

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-14T18:24:37.113

您的摘要页面表明您正在从两个设备获取 GPS 坐标……因此，对于孩子来说，一个不错的功能是为妈妈显示一个点，在显示中心为孩子显示一个点。在这些之间画一条线。画一个箭头，显示孩子最近到达 GPS 分辨率的方向。

告诉孩子按下“寻找妈妈”按钮，将箭头对准线上，然后沿着这条路走，根据需要绕过事物（箭头和线将始终让他们了解他们想要的方式如果可能的话，走路）。

使点、线和箭头大而友好。当您在最低 GPS 分辨率内或通常在喊叫距离内时，更改颜色或使事物闪烁。这样，如果孩子最终站在高障碍的另一边，他或她就知道大喊大叫是一种选择。

有趣的项目理念。我认为，如果您的设备中有足够好的运动检测传感器，那么移动物体并拥有“开启”按钮就足够了。它可能应该在一段时间后自动关机。

是否生成矢量图形不是主要问题……您可能应该为点（也是线的端点）以及箭头和箭头段生成坐标。所有这些都可以使用旧的 Bresenham 线和圆算法仅使用整数数学快速绘制在光栅显示器上。

维基百科的链接：

[http://en.wikipedia.org/wiki/Midpoint_circle_algorithm](http://en.wikipedia.org/wiki/Midpoint_circle_algorithm)

[http://en.wikipedia.org/wiki/Bresenham%27s_line_algorithm](http://en.wikipedia.org/wiki/Bresenham%27s_line_algorithm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-25T07:33:46.237

我当然会尝试查看一些 GPS，例如[Garmin eTrex Legend](https://buy.garmin.com/shop/shop.do?pID=173)之类的基本设备。它很便宜，它是灰度的，它可能也像您的设备一样受到内存限制，我相信您会在那里找到很多 UI 创意。我也会考虑看看 iPhone。这是一款完全不同的设备，但其中的许多 UI 概念都经过深思熟虑，甚至可以在简单的灰度设备上使用。您可以通过 iPhone 模拟器免费获得 iPhone SDK。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-25T07:14:44.527

我认为把它做成口袋妖怪的形状真的很酷。我只是说...

# windows-mobile - dotnet compact framework 3.5 sp1 检测设备分辨率

> ID：202231
> 
> 赞同：6
> 
> 时间：2008-10-14T18:16:42.700
> 
> 标签：windows-mobile, compact-framework

我需要自动检测设备分辨率，现在我有一个全局变量和硬连线分辨率：

```
Public gDeviceRes As String = "640"
'Public gDeviceRes As String = "320" 
```

然后为每个设备重新编译，有没有人有一个快速的代码片段？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-14T19:33:51.967

根据您的具体需求，您可以使用 Screen.PrimaryScreen 检查当前屏幕尺寸，[或者](http://msdn.microsoft.com/en-us/library/system.windows.forms.screen.primaryscreen.aspx)您可以使用 SM_CXSCREEN 或[GetDeviceCaps](http://msdn.microsoft.com/en-us/library/ms929295.aspx)使用 HORZRES P/Invoke [GetSystemMetrics 。](http://msdn.microsoft.com/en-us/library/ms929469.aspx)垂直尺寸同样可用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-14T20:03:43.823

这正是我需要的：

```
 Dim screensize As System.Drawing.Rectangle = Screen.PrimaryScreen.Bounds
  Public gDeviceRes As String = screensize.Height 
```

# solaris - Solaris 的命令行限制

> ID：202234
> 
> 赞同：1
> 
> 时间：2008-10-14T18:18:06.020
> 
> 标签：solaris

我有一个可以通过 SSH 在 Linux 服务器上执行命令的应用程序。当我连接到 Solaris 服务器时，一切都无法正常工作。似乎 Solaris 命令行被限制为 267 个字符。

有没有办法改变这个？

更新：如前所述，这是对 Solaris (sh) 与 Linux (bash) 的默认 shell 的限制。那么，现在的问题是，有没有办法改变 sh 的限制？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-01-13T13:08:51.010

您可以使用以下命令查看当前命令的最大长度：

```
$ getconf ARG_MAX
1048320 
```

我创建了一个脚本，[可以确定远程命令的最大长度](http://www.theeggeadventure.com/wikimedia/index.php/Ssh_argument_length)。正如克雷格建议的那样，如果可以的话，最好的办法是将命令输入标准输入。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-14T18:28:38.447

我相信（尽管可能是错误的）这与您连接的默认 shell 有关。如果您在 Solaris 上对您在 Linux 上使用的相同 shell 进行更改，是否可以解决问题？

如果有更好的解决方案路线，请发表评论，我会更改我的答案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-14T18:59:47.963

在我看来，您的选择是：

1.  通过更改用户的默认值来更改您在 Solaris 上使用的 shell。
2.  不要更改 shell，而是更改运行命令的方式。

第一个很简单，但需要管理员对每个用户/机器组合进行更改，并且可能会影响其他程序。从长远来看，更改运行命令的方式会更快，也更容易维护。例如，假设您需要执行以下操作：

```
/usr/bin/foo with a very long list of options and parameters 
```

现在你可能正在做这样的事情：

```
ssh user@machine "/usr/bin/foo with a very long list of options and parameters" 
```

但您可以改为执行以下操作：

```
echo "/usr/bin/foo with a very long list of options and parameters" | \
ssh user@machine "/bin/bash" 
```

这将做你想要的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-01-07T07:45:51.233

只需为用户更改 shell 解释器（编辑 /etc/passwd）或临时运行另一个 shell，例如。korn shell 如下：

```
serwer%

serwer% echo *

Arguments too long

serwer% ksh

$ echo *

file1

file2

....

file 10000

% exit

serwer% 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-15T04:15:06.733

当我在 Solaris 10 上运行 configure 并且 configure 脚本提供了一个命令行长度的数字时，答案通常在 256 KB 范围内。Solaris 上的标准 shell 肯定没有低于 300 字节的限制。

也就是说，我不确定你的问题是什么。我可能会猜测 Solaris SSH 的限制较短——我没有遇到过这个问题，但我倾向于使用 SSH 作为直接（交互）连接而不是运行长命令的一种方式。

# sql - SQL Server 中的自定义日期/时间格式

> ID：202243
> 
> 赞同：15
> 
> 时间：2008-10-14T18:20:24.033
> 
> 标签：sql, sql-server, datetime, stored-procedures, sql-convert

我正在尝试编写一个存储过程，它从表中选择列并将 2 个额外的列添加到 ResultSet。这 2 个额外的列是对表中的字段进行转换的结果，该字段是日期时间字段。

日期时间格式字段具有以下格式 'YYYY-MM-DD HH:MM:SS.S'

应采用以下格式的 2 个附加字段：

1.  DDMMM
2.  HHMMT，其中 T 是上午的“A”和下午的“P”

示例：如果字段中的数据是“2008-10-12 13:19:12.0”，则提取的字段应包含：

1.  12OCT
2.  0119P

我曾尝试使用 CONVERT 字符串格式，但没有一种格式与我想要获得的输出匹配。我正在考虑通过 CONVERT 提取字段数据，然后使用 REPLACE，但我在这里肯定需要一些帮助，因为我不确定。

任何精通存储过程的人都可以在这里帮助我吗？谢谢！

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-10-14T18:32:59.373

使用 DATENAME 并将逻辑包装在函数中，而不是存储过程

```
declare @myTime as DateTime

set @myTime = GETDATE()

select @myTime

select DATENAME(day, @myTime) + SUBSTRING(UPPER(DATENAME(month, @myTime)), 0,4) 
```

返回“14OCT”

如果可能，在处理日期时尽量不要使用任何基于字符/字符串的操作。它们是数字（浮点数），性能会受到这些数据类型转换的影响。

挖掘我多年来编写的这些方便的转换......

```
/* Common date functions */
--//This contains common date functions for MSSQL server

/*Getting Parts of a DateTime*/
    --//gets the date only, 20x faster than using Convert/Cast to varchar
    --//this has been especially useful for JOINS
    SELECT (CAST(FLOOR(CAST(GETDATE() as FLOAT)) AS DateTime))

    --//gets the time only (date portion is '1900-01-01' and is considered the "0 time" of dates in MSSQL, even with the datatype min value of 01/01/1753\. 
    SELECT (GETDATE() - (CAST(FLOOR(CAST(GETDATE() as FLOAT)) AS DateTime)))

/*Relative Dates*/
--//These are all functions that will calculate a date relative to the current date and time
    /*Current Day*/
    --//now
    SELECT (GETDATE())

    --//midnight of today
    SELECT (DATEADD(ms,-4,(DATEADD(dd,DATEDIFF(dd,0,GETDATE()) + 1,0))))

    --//Current Hour
    SELECT DATEADD(hh,DATEPART(hh,GETDATE()),CAST(FLOOR(CAST(GETDATE() AS FLOAT)) as DateTime))

    --//Current Half-Hour - if its 9:36, this will show 9:30
    SELECT DATEADD(mi,((DATEDIFF(mi,(CAST(FLOOR(CAST(GETDATE() as FLOAT)) as DateTime)), GETDATE())) / 30) * 30,(CAST(FLOOR(CAST(GETDATE() as FLOAT)) as DateTime)))

    /*Yearly*/
    --//first datetime of the current year
    SELECT (DATEADD(yy,DATEDIFF(yy,0,GETDATE()),0))

    --//last datetime of the current year
    SELECT (DATEADD(ms,-4,(DATEADD(yy,DATEDIFF(yy,0,GETDATE()) + 1,0))))

    /*Monthly*/
    --//first datetime of current month
    SELECT (DATEADD(mm,DATEDIFF(mm,0,GETDATE()),0))

    --//last datetime of the current month
    SELECT (DATEADD(ms,-4,DATEADD(mm,1,DATEADD(mm,DATEDIFF(mm,0,GETDATE()),0))))

    --//first datetime of the previous month
    SELECT (DATEADD(mm,DATEDIFF(mm,0,GETDATE()) -1,0))

    --//last datetime of the previous month
    SELECT (DATEADD(ms, -4,DATEADD(mm,DATEDIFF(mm,0,GETDATE()),0)))

    /*Weekly*/
    --//previous monday at 12AM
    SELECT (DATEADD(wk,DATEDIFF(wk,0,GETDATE()) -1 ,0))

    --//previous friday at 11:59:59 PM
    SELECT (DATEADD(ms,-4,DATEADD(dd,5,DATEADD(wk,DATEDIFF(wk,0,GETDATE()) -1 ,0))))

    /*Quarterly*/
    --//first datetime of current quarter
    SELECT (DATEADD(qq,DATEDIFF(qq,0,GETDATE()),0))

    --//last datetime of current quarter
    SELECT (DATEADD(ms,-4,DATEADD(qq,DATEDIFF(qq,0,GETDATE()) + 1,0))) 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2016-07-18T04:15:38.127

您可以在 SQL Server 中使用以下命令来制作它：

```
select FORMAT(getdate(), N'yyyy-MM-ddThh:mm:ss') 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-14T18:32:20.013

如果 dt 是您的日期时间列，则

对于 1：

```
SUBSTRING(CONVERT(varchar, dt, 13), 1, 2)
    + UPPER(SUBSTRING(CONVERT(varchar, dt, 13), 4, 3)) 
```

对于 2：

```
SUBSTRING(CONVERT(varchar, dt, 100), 13, 2)
    + SUBSTRING(CONVERT(varchar, dt, 100), 16, 3) 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-14T18:49:10.013

没有具体回答您的问题，但这不应该由您的应用程序的表示层处理。按照您描述的方式执行此操作会在数据库端创建额外的处理并添加额外的网络流量（假设数据库存在于与应用程序不同的机器上），对于可以在应用程序端轻松计算的内容，具有更丰富的日期处理库，并且与语言无关，尤其是在您的第一个示例包含缩写月份名称的情况下。无论如何，如果您仍然决定走这条路，其他人给您的答案应该为您指明正确的方向。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-14T18:55:36.287

> 日期时间格式字段具有以下格式 'YYYY-MM-DD HH:MM:SS.S'

这种说法是错误的。这就是企业管理器或 SQL Server 选择*显示*日期的方式。在内部，它是一个 8 字节的二进制值，这就是为什么 Andrew 发布的一些函数可以很好地工作的原因。

Kibbee 也提出了一个有效的观点，在一个完美的世界里，我会同意他的观点。但是，有时您希望将查询结果直接绑定到显示控件或小部件，而实际上没有机会进行任何格式化。有时表示层位于比数据库还要繁忙的 Web 服务器上。考虑到这些，知道如何在 SQL 中执行此操作不一定是坏事。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-06-16T07:42:37.540

是的，Depart 是一个解决方案，但我认为这种方法是长途旅行！

SQL 服务器：

```
SELECT CAST(DATEPART(DD,GETDATE()) AS VARCHAR)+'/'
+CAST(DATEPART(MM,GETDATE()) AS VARCHAR)
+'/'+CAST(DATEPART(YYYY,GETDATE()) AS VARCHAR)
+' '+CAST(DATEPART(HH,GETDATE()) AS VARCHAR)
+':'+CAST(DATEPART(MI,GETDATE()) AS VARCHAR) 
```

甲骨文：

```
Select to_char(sysdate,'DD/MM/YYYY HH24:MI') from dual 
```

您可以通过这种方式编写自己的函数，您可以摆脱这种混乱；

[http://sql.dzone.com/news/custom-date-formatting-sql-ser](http://sql.dzone.com/news/custom-date-formatting-sql-ser)

```
select myshortfun(getdate(),myformat)
GO 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-14T18:41:19.450

您将在这里需要 DATEPART。您可以将 DATEPART 调用的结果连接在一起。

要获取月份缩写，您可以使用 DATENAME；如果这对您不起作用，您可以在 DATEPART 上使用 CASE 语句。

DATEPART 也适用于时间字段。

我可以想到几种获取 AM/PM 指标的方法，包括比较通过 DATEPART 构建的新日期或计算一天中经过的总秒数，并将其与已知的 AM/PM 阈值进行比较。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-09-24T15:18:42.253

在 MS SQL Server 中，您可以执行以下操作：

设置日期格式 ymd

年月日，

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-02-07T15:05:04.240

如果是维度模型所需的更具体的东西，例如`DateKey`( `yyyymmdd`)，我建议不要进行任何强制转换/转换：

```
DECLARE @DateKeyToday int = (SELECT 10000 * DATEPART(yy,GETDATE()) + 100 * DATEPART(mm,GETDATE()) + DATEPART(dd,GETDATE()));
PRINT @DateKeyToday 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-02-23T20:59:21.163

我将这个答案（为我自己）添加为与自定义格式相关。

对于下划线 yyyy_MM_dd

```
REPLACE(SUBSTRING(CONVERT(VARCHAR, @dt, 120), 1, 10),'-','_') 
```

# sql - 结果集中行自动编号的纯 SQL 技术

> ID：202245
> 
> 赞同：6
> 
> 时间：2008-10-14T18:20:51.927
> 
> 标签：sql, mysql

我正在寻找一种对*结果集*（不是表）中的行进行顺序编号的方法。本质上，我从如下查询开始：

```
SELECT id, name FROM people WHERE name = 'Spiewak' 
```

`id`s 显然不是一个真正的序列（例如）`1, 2, 3, 4`。我需要的是结果集中包含这些自动编号的另一列。如果必须，我愿意使用 SQL 函数，但我宁愿在不使用 ANSI 规范的扩展的情况下这样做。

平台是 MySQL，但如果可能，该技术应该是跨平台的（因此希望避免非标准扩展）。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-14T18:28:21.693

要获得有意义的行号，您需要对结果进行排序。然后你可以做这样的事情：

```
SELECT id, name
    , (SELECT COUNT(*) FROM people p2 WHERE name='Spiewak' AND p2.id <= p1.id) AS RowNumber
FROM people p1
WHERE name = 'Spiewak'
ORDER BY id 
```

注意，子查询的 WHERE 子句需要匹配 WHERE 子句或主查询的主键和主查询*的*ORDER BY。

SQL Server 有 ROW_NUMBER() OVER 结构来简化这一点，但我不知道 MySQL 是否有什么特别的东西可以解决它。

* * *

由于我在这里的帖子被接受为答案，我还想指出 Dan Goldstein 的回复，这在方法上非常相似，但使用 JOIN 而不是子查询，并且通常会表现更好

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-14T18:30:08.413

AFAIK，没有“标准”方式。

MS SQL Server 有 row_number()，而 MySQL 没有。

在 MySQL 中执行此操作的最简单方法是

`SELECT a.*, @num := @num + 1 b from test a, (SELECT @num := 0) d;`

来源：[http ://www.xaprb.com/blog/2006/12/02/how-to-number-rows-in-mysql/中的评论](http://www.xaprb.com/blog/2006/12/02/how-to-number-rows-in-mysql/)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-10-14T18:31:00.500

一个非常低效但 ANSI SQL 的想法是计算具有较小 id 匹配相同条件的行数。我没有测试过这个 SQL，它可能不会工作，但类似：

```
SELECT id, name, sub.lcount
FROM people outer
JOIN (SELECT id, COUNT(id) lcount FROM people WHERE name = 'Spiewak' AND id < outer.id GROUP BY id) sub on outer.id = sub.id
WHERE name = 'Spiewak' 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-14T18:27:02.193

我知道没有 ANSI 标准的方法可以做到这一点。

在 SQL Server 中，您有一个可以使用的 ROW_NUMBER() 函数，而在 Oracle 中，有一个 ROWNUM 伪列。

在 MySQL 中，有[这种技术](http://squeejee.com/articles/9-mysql-oracle-rownum)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-14T18:29:28.680

这个页面应该给你一个标准的 SQL 方法：

[https://www.sqlteam.com/articles/returning-a-row-number-in-a-query](https://www.sqlteam.com/articles/returning-a-row-number-in-a-query)

希望这可以帮助。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-08-12T17:32:11.643

```
SELECT @i:=@i+1 AS iterator, t.*
FROM tablename t,(SELECT @i:=0) foo 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-11-08T19:32:53.067

在 oracle 中，我知道您想要做的唯一数据库是对数据进行子选择

IE

```
select rownum, id , blah, blah
from  (
select id, name FROM people WHERE name = 'Spiewak'
) 
```

基本概念是 rownum 将根据内部选择返回的结果集进行评估。

我希望这可以为您指出可以使用的解决方案。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-05-21T21:35:48.990

我知道这是一个旧线程，但我刚刚在寻找这个答案。我在 MySQL 中尝试了 Dan Goldstein 的查询，但它并没有像写的那样工作，因为 'outer' 是一个保留字。然后，我注意到它仍然在使用子查询。

所以，我想出了一个使用 JOIN 的版本，但没有子查询：

```
 SELECT SUM(IF(p1.id > p2.id, 0, 1)) AS `row`, p2.id, p2.name
  FROM people p1 JOIN people p2 ON p1.name = p2.name
  WHERE p1.name = 'Spiewak'
  GROUP BY p2.id 
```

这在 MySQL 5.1 中对我有用。对于 MySQL，GROUP BY p2.id 似乎就足够了。可以将明确的 ORDER BY p2.id 添加到查询的末尾，但无论哪种方式，我都得到了相同的结果。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2021-04-17T12:08:34.500

最近对问题的回答，但我相信窗口函数现在是 ANSI SQL 的标准，或者至少是大多数当前 SQL 风格的标准。因此，使用 ROW_NUMBER() 函数。

```
SELECT
    p.ROW_NUMBER() over (order by id) as 'row_id',
    p.id as 'id',
    p.name as 'name'
FROM
    people p
WHERE
    p.name = 'Spiewak' 
```

# nant - 使用 Nant，取消注释文件中的 xml 块

> ID：202249
> 
> 赞同：0
> 
> 时间：2008-10-14T18:21:53.297
> 
> 标签：nant

我需要取消注释我在 NAnt 中使用的文件中的部分 xml。这是xml的示例：

```
<navigation>
<!-- Navigation Section
    <something name="" />
    <something name="" />
-->
</navigation> 
```

我想要做的是将 --> 部分移到“导航部分”旁边。--> 的全局查找将不起作用，因为文件中有很多 --> 以及导航节点下。这个结束注释字符是导航节点中的最后一个。

任何人？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-22T22:02:56.090

这很hacky，但您可以搜索*字符串，然后从那里向后工作以用空字符串替换 xml 注释字符串。如果你可以在 C# 中实现它（正则表达式非常适合这个），那么将它包装在一个自定义的 nant 目标中是相当简单的（就像我在[这里](https://stackoverflow.com/questions/537988/how-can-i-use-nants-xmlpoke-target-to-remove-a-node/539365#539365)针对不同的问题所做的那样）。*

 *一种完全不同的方法是存储*[节点在不同的文件中，并使用xmlpoke](http://nant.sourceforge.net/release/latest/help/tasks/xmlpoke.html)将它们插入到这个 XML 文件中。这可能是比上述方法更好的方法，但这取决于您的具体情况。*

 *# jquery - jQuery表头排序

> ID：202252
> 
> 赞同：13
> 
> 时间：2008-10-14T18:23:38.520
> 
> 标签：jquery, sorting

有人知道一个插件，或者一个内置函数来使表中的列可排序吗？即我单击列标题并按该列对行进行排序？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-10-14T18:32:33.790

[http://tablesorter.com/docs/](http://tablesorter.com/docs/ "这个")使用起来非常简单，有多种选项可以满足您的需求。:)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-15T00:05:14.837

[http://www.flexigrid.info/](http://www.flexigrid.info/)

Flexigrid 是一个非常流行且易于使用的表格管理器/分类器。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-10-07T15:56:24.050

这里有两个排序和做很多其他的事情，我还没有看到列出：

*   [数据表](http://datatables.net/index)
*   [SlickGrid](https://github.com/mleibman/SlickGrid/wiki)

这里还有一个比较许多数据表的表：http: [//blog.sematext.com/2011/09/19/top-javascript-dynamic-table-libraries/](http://blog.sematext.com/2011/09/19/top-javascript-dynamic-table-libraries/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-14T18:42:22.787

有点重量级，但最终的jQuery表管理器是[jqGrid](http://plugins.jquery.com/project/jqGrid)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-04-03T01:50:03.593

一个进行排序、过滤和分页的jQuery插件：[breedjs](http://jjppof.github.io/breedjs/)

例子：

将数据放入 js 对象中，如下所示：

```
var data = {
    people: [
        {name: 'a', address: 'c', salesperson: 'b'},
        {name: 'b', address: 'b', salesperson: 'a'},
        {name: 'c', address: 'a', salesperson: 'c'},
    ]
};

breed.run({
    scope: 'people',
    input: data
}); 
```

HTML：

```
<table>
    <thead>
        <tr>
            <th sort='name'>Name</th>
            <th sort='address'>Address</th>
            <th sort='salesperson'>Sales Person</th>
        </tr>
    </thead>
    <tbody>
        <tr b-scope="people" b-loop="person in people">
            <td b-sort="name">{{person.name}}</td>
            <td b-sort="address">{{person.address}}</td>
            <td b-sort="salesperson">{{person.salesperson}}</td>
        </tr>
    </tbody>
</table> 
```

现在，每次您想按销售人员排序时，只需调用它：

```
breed.sort({
    scope: 'people',
    selector: //field name
}); 
```

看：

```
$("th").click(function(){
    breed.sort({
        scope: 'people',
        selector: $(this).attr('sort')
    });
}); 
```

[小提琴的工作示例](https://jsfiddle.net/jjppof/madqdjaf/)

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-10-14T18:25:41.277

[Ext JavaScript 库](http://extjs.com/)在这方面做得非常好。

# java - Eclipse & Tomcat：如何指定从项目中提供的文件夹？

> ID：202253
> 
> 赞同：7
> 
> 时间：2008-10-14T18:23:53.650
> 
> 标签：java, eclipse, tomcat, eclipse-3.4

我正在使用 Eclipse 3.4 和 Tomcat 5.5，并且设置了一个动态 Web 项目。我可以从[http://127.0.0.1:8080/project/](http://127.0.0.1:8080/project/)访问它，但默认情况下它提供来自 WebContent 文件夹的文件。我想要提供的真实文件可以在名为“share”的文件夹下找到。这个文件夹来自 CVS，所以我想使用它的给定名称而不是重命名它。如何才能做到这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-14T18:57:46.500

`.settings`在项目文件夹中，在名为的文件夹下应该有一个文件`org.eclipse.wst.common.component`，其中包含这样的 XML 片段：

```
<wb-module deploy-name="WebProjectName">
    <wb-resource deploy-path="/" source-path="/WebContent"/>
    <wb-resource deploy-path="/WEB-INF/classes" source-path="/src"/> 
```

您应该能够将源路径更改`wb-resource`为您的共享文件夹。为了安全起见，我会在关闭 Eclipse 项目的情况下进行这些更改。

这是您第一次在 Eclipse 中创建动态 Web 项目时选择的设置 - 我找不到如何通过 Eclipse 本身更改现有项目中的值。

如果您希望共享文件夹在部署时映射到不同的路径，例如`/share/`在您的 web 应用程序中，您可能只需添加另一个 wb-resource 元素。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-04-13T09:09:59.937

可以通过 Eclipse 完成，无需手动编辑 .settings 文件。

在 Eclipse 3.6（可能还有更早的版本）中，

1.  右键单击您的项目
2.  点击属性
3.  单击“部署程序集”
4.  添加...文件夹 -> 下一步
5.  导航到源文件夹
6.  结束

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-14T18:37:28.303

如果您正在运行 Windows，请使用 MS 的 junction 实用程序：[http](http://technet.microsoft.com/en-us/sysinternals/bb896768.aspx) ://technet.microsoft.com/en-us/sysinternals/bb896768.aspx并将您的共享目录映射到 Webcontent 文件夹。我经常定期做一些这样的映射。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-15T13:07:30.373

在 STS 2.5.1 上

1.  右键单击您的项目
2.  点击属性
3.  单击“Java 构建路径”
4.  单击“来源”选项卡
5.  导航到默认输出文件夹
6.  浏览并添加您的路径
7.  结束

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-04-01T17:55:56.410

您可以在 R-click 项目 > 属性 > 部署程序集上指定 web 内容的位置

这就是我在我的 STS 中所做的，您可以添加或删除位置。

# c# - 为什么这段代码在 C# 中无效？

> ID：202271
> 
> 赞同：42
> 
> 时间：2008-10-14T18:29:29.600
> 
> 标签：c#, nullable, conditional-operator, dbnull

以下代码将无法编译：

```
string foo = "bar";
Object o = foo == null ? DBNull.Value : foo; 
```

我得到：*错误 1 ​​条件表达式的类型无法确定，因为 'System.DBNull' 和 'string' 之间没有隐式转换*

要解决此问题，我必须执行以下操作：

```
string foo = "bar";
Object o = foo == null ? DBNull.Value : (Object)foo; 
```

这个演员表似乎毫无意义，因为这当然是合法的：

```
string foo = "bar";
Object o = foo == null ? "gork" : foo; 
```

在我看来，当三元分支是不同类型时，编译器不会将值自动装箱到类型对象......但是当它们是相同类型时，自动装箱是自动的。

在我看来，第一个声明应该是合法的......

谁能描述为什么编译器不允许这样做以及为什么 C# 的设计者选择这样做？我相信这在 Java 中是合法的......虽然我还没有验证这一点。

谢谢。

**编辑：**我要求了解为什么 Java 和 C# 以不同的方式处理这个问题，C# 中的幕后发生了什么使这无效。我知道如何使用三元，并且不是在寻找一种“更好的方式”来编写示例。我了解 C# 中三进制的规则，但我想知道为什么...

**编辑**（乔恩斯基特）：删除“自动装箱”标签，因为此问题不涉及装箱。

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2008-10-14T18:35:21.180

编译器要求第二个和第三个操作数的类型相同，或者一个可以隐式转换为另一个。在您的情况下，类型是 DBNull 和字符串，两者都不能隐式转换为另一个。将它们中的任何一个投射到对象上可以解决这个问题。

编辑：看起来它在 Java 中确实是合法的。当涉及到方法重载时，它是如何解决的，我不确定......我刚刚看过 JLS，当有两个不兼容的参考时，条件的类型是什么非常不清楚涉及的类型。C# 的工作方式有时可能更令人恼火，但 IMO 更清晰。

C# 3.0 规范的相关部分是 7.13，条件运算符：

> ?: 运算符的第二个和第三个操作数控制条件表达式的类型。设 X 和 Y 是第二个和第三个操作数的类型。然后，
> 
> *   如果 X 和 Y 是相同的类型，那么这是条件的类型
> *   否则，如果存在从 X 到 Y 的隐式转换（第 6.1 节），而不是从 Y 到 X，则 Y 是条件表达式的类型。
> *   Otherwise, if an implicit conversion (§6.1) exists from Y to X, but not from X to Y, then X is the type of the conditional expression.
> *   Otherwise, no expression type can be determined, and a compile-time error occurs.

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-10-14T18:31:54.493

`DBNull.Value`返回类型`DBNull`。

您希望类型为`string`.

虽然`string`可以`null`，但不能是`DBNull`.

在您的代码中，等号右侧的语句在分配给对象之前执行。

基本上，如果您使用：

```
[condition] ? true value : false value; 
```

在 .Net 中，true 和 false 选项都需要隐式转换为相同的类型，然后再分配给它们。

这是 C# 如何处理类型安全的结果。例如以下是有效的：

```
string item = "item";

var test = item != null ? item : "BLANK"; 
```

C#3 不支持动态类型，那么什么是测试？在 C# 中，每个赋值也是一个带有返回值的语句，因此尽管`var`构造在 C#3 中是新的，但 equals 右侧的语句始终必须解析为单一类型。

在 C#4 及更高版本中，您可以显式支持动态类型，但我认为这在这里没有帮助。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-10-14T18:56:19.967

By the way, your code is a special case that doesn't have to use the conditional operator at all. Instead, the null coalesce operator is more appropriate (but still requires casting):

```
object result = (object)foo ?? DBNull.Value; 
```

# php - 从另一个文件解析文件名

> ID：202273
> 
> 赞同：0
> 
> 时间：2008-10-14T18:29:55.060
> 
> 标签：php, file, class-design

我目前可以做到以下几点：

```
class SubClass extends SuperClass {
  function __construct() {
    parent::__construct();
  }
}

class SuperClass {
  function __construct() {
    // this echoes "I'm SubClass and I'm extending SuperClass"
    echo 'I\'m '.get_class($this).' and I\'m extending '.__CLASS__;
  }
} 
```

我想对文件名（`__FILE__`但动态评估）做类似的事情；我想从超类中知道子类所在的文件。有没有可能以任何优雅的方式？

我知道你可以用 做一些事情[`get_included_files()`](http://fi.php.net/get_included_files)，但这不是很有效，特别是如果我有很多实例。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-14T20:33:39.303

您可以使用反射。

```
$ref = new ReflectionObject($this);
$ref->getFileName(); // return the file where the object's class was declared 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-14T18:40:09.843

呃，不是真的，我能想到的。每个子类都需要有一个显式实现的方法返回`__FILE__`，这首先完全违背了继承点。

我也很好奇为什么这样的东西会有用。

# javascript - 使用 jQuery 触发按键...并指定按下了哪个键

> ID：202285
> 
> 赞同：4
> 
> 时间：2008-10-14T18:32:28.127
> 
> 标签：javascript, jquery, triggers, keypress

我想要一个通过触发特定击键来动态验证的输入元素（type=text）或 textarea 元素。这将用于中文拼音输入，例如：

用户在输入元素中键入“ma2”。每次击键都会触发 keydown 事件，并且 2 永远不会出现。相反，当用户按下“2”时，“a”将收到一个音标，例如：“á”。最后，用户将输入：“má”。

这可以通过使用 $(element).val() 读取和更改整个输入值来完成，但是，当输入元素具有焦点并且通过调用 .val("something") 设置其值时，光标将移动到末尾的文本。这在大多数情况下都可以正常工作，因为用户只是在字段末尾继续输入，但我希望这在*所有*情况下都能正常工作。

...这个问题的另一个解决方案是获取/设置光标在输入或文本区域元素中的位置。但是，我认为这在 javascript 中是不可能的。

* * *

所以，雷米肯定是在正确的轨道上。无论如何，触发按键不会让我输入特殊字符而没有很多麻烦。相反，我捕获 keydown 事件并设置输入/文本区域的值，然后移动插入符号。

我还没有发现任何有利于在 jQuery 中获取/设置插入符号的东西，但是下面的内容确实为我解决了这个问题。当它稳定时，我会发布一个指向我的最终拼音输入代码的链接。现在已经很接近了。

[http://blog.vishalon.net/Post/57.aspx](http://blog.vishalon.net/Post/57.aspx) [http://demo.vishalon.net/getset.htm](http://demo.vishalon.net/getset.htm)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-14T23:57:02.077

您可能不太幸运触发按键 - 我相当确定除非按键是可信的（即源自浏览器），否则它不会被拾取。

但是，您可以进行文本替换并将克拉重新插入原来的位置 - 而不是将其射到字符串的末尾。您需要使用 setSelectionRange 和 createTextRange（对于 IE）。

我整理了一个小演示 - 您将看到的替换与真实单词不匹配，但它显示了它是如何工作的：

[http://jsbin.com/emudi/](http://jsbin.com/emudi/)（编辑源[http://jsbin.com/emudi/edit](http://jsbin.com/emudi/edit)）

诀窍是记下克拉的位置，使用 substr 替换找到的单词（而不是正则表达式以避免替换错误的匹配项），然后将克拉重新放置在新单词的末尾。

替换是在空格键或模糊消失时触发的。关于这一点的注释 - 您可以触发特定字符（即“2”）的替换 - 但我不建议在*每次*按键时搜索替换。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-02-21T18:23:16.257

此外，对于以跨浏览器方式控制“插入符号”的简单代码，这可能很有用：

[http://javascript.nwbox.com/cursor_position/](http://javascript.nwbox.com/cursor_position/)

答案有点晚了，但我相信你仍然会发现这些旧东西很有用。

# javascript - 如何使用 javascript 和模板构建 DOM？

> ID：202289
> 
> 赞同：4
> 
> 时间：2008-10-14T18:33:13.163
> 
> 标签：javascript, templates

我正在构建一个应用程序，其中大部分 HTML 都是使用 javascript 构建的。DOM 结构是使用从服务器发送的一些 JSON 数据结构构建的，然后客户端代码为该数据构建 UI。

我目前的方法是遍历 JSON 数据结构，并调用 script.aculo.us 的 Builder.node 方法来构建 DOM 结构，然后将其附加到实际上在服务器发送的 HTML 中的某个元素上。在此过程中，我将事件侦听器注册到需要它们的各种元素。这允许很大的灵活性，并允许非常动态的界面。

但是，我觉得这不是很可持续，因为视图逻辑（即 DOM 结构）与遍历数据的代码、事件处理程序以及保存在内存中以维护状态，并且能够将这些更改传回服务器。

是否有任何类似模板的解决方案可以让我将 DOM 结构与驱动应用程序的代码分开？目前，我唯一的库依赖项是prototype.js 和script.aculo.us，所以我想避免引入任何大型库，但欢迎提出任何建议。

谢谢！

编辑：出于某种原因，[Javascript 支持什么好的模板语言？](https://stackoverflow.com/questions/128949/what-good-template-language-is-supported-in-javascript)当我输入这个问题时，没有出现在小搜索结果中。但是，它确实显示在此处的“相关”侧栏中。

我将阅读那里的一些建议，如果我找到解决方案，我将关闭这个问题。否则，我将解释这个问题，说明为什么这些解决方案对我不起作用。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-14T18:41:18.110

有一些模板解决方案，但它们并没有比你已经做的更多。jQuery 一直在[**沿着这些方向做一些工作**](http://ejohn.org/blog/javascript-micro-templating/)，并且一些 jQuery[**插件**](http://plugins.jquery.com/project/jTemplates)已经成为解决方案。Prototype.js 和其他人也有解决方案。

**一些选项包括：**

*   [**原型模板**](http://www.prototypejs.org/api/template)
*   [**Ajax 页面**](http://ajax-pages.sourceforge.net/)

一般来说，[**Ext js**](http://extjs.com/)有一些非常**疯狂和欺骗的**东西，包括一些[**模板**](http://extjs.com/deploy/dev/examples/core/templates.html)，但你会添加**另一个库**。这些天来，有太多的库被折腾了，实现一个**轻量级的**自定义解决方案通常要简单得多。尝试自己创建一些 DOM 对象。如果您有 JSON 数据，请将其解析到内存中并通过函数运行。这实际上是一个爆炸，很多人都在这样做。

**旁注：** 您正在做的事情可能是相当**可持续**和可**维护**的。请记住，当您发送 HTML 页面时，浏览器会将**DOM 结构放入内存**中，其方式与您的 javascript 所做的大致相同。我不特别推荐任何这些解决方案。听起来您已经为您的特定需求制作了一个不错的小系统，我通常会说，**改进您的设计**至少与迁移到其他人的模式一样有价值，并且能够**创建一些额外的好处你自己的依赖**。

**旁注：** 通常**不**建议在客户端**生成整个 DOM**，至少对于许多市场来说不是。有时它是一个 A-OK 解决方案，就像您的情况一样，但值得提醒广大观众注意的是，这种开发方式并不总是最好的旅行方式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-14T18:40:16.597

jQuery 有几个“模板”插件：

*   [js中继器](http://plugins.jquery.com/project/jsrepeater)
*   [j模板](http://plugins.jquery.com/project/jTemplates)
*   [无模板](http://plugins.jquery.com/project/noTemplate)
*   [模板](http://plugins.jquery.com/project/Template)

有一些 XSLT 附加功能可以在客户端进行所有转换，但我认为 XSL 不够“对设计师友好”

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-14T18:53:02.377

您的模板可以封装在一个小部件中。Prototype 可以创建附加组件，但我最熟悉如何在 jQuery 中执行此操作。我首先尝试了原型，但后来意识到 jQuery 拥有所有原型等等。它还有更多由用户社区创建的附加组件/小部件/插件。

Builder 只是原型的附加组件。然而，在 jQuery 中构建 html DOM 元素是核心功能的一部分。

[http://docs.jquery.com/Core/jQuery#html](http://docs.jquery.com/Core/jQuery#html) 结合： [http ://docs.jquery.com/Manipulation/append#content](http://docs.jquery.com/Manipulation/append#content)

这是构建一些 html 并将其添加到 jQuery 元素选择的示例。

```
$(document.body).append($('<div id="sub-menu-holder" style="position:absolute;top:0;left:0;border:0px none;"></div>')); 
```

您还可以从 ajax 调用中获取数据结构并使用它来创建实体，或者您可以从 ajax 调用中返回 html 并将其直接附加到适当位置的 DOM。

[http://docs.jquery.com/Ajax/load#urldatacallback](http://docs.jquery.com/Ajax/load#urldatacallback)

这是来自 jquery 加载函数文档的示例。

$(document).ready(function(){ $("#links").load("/Main_Page #jq-p-Getting-Started li"); });

就是这样。如果您的 ajax 调用返回所有要插入的 html，并且您知道它所在的元素 id，这就是您所需要的。现在您需要确定如何在服务器端创建 html。在不知道您正在构建的内容的具体细节的情况下很难回答。但是服务器端的模板引擎不需要知道生成的 html 的放置位置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-14T18:45:32.890

如果我理解这个问题，您是否希望能够动态构建 GUI，但基于预定义的 HTML 模板？我知道当有一种非常好的语言 (HTML) 可以使用 JS 构建 DOM 时，我经常感到奇怪。

您可以将 XMLHttpRequests 用于 XHTML 的样板块，然后根据代码中的需要修改这些块。当我这样做时，我发现它提供了更令人满意的逻辑和表示分离。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-14T18:53:00.533

ExtJS 具有出色的模板语法： [链接文本](http://extjs.com/deploy/dev/docs/?class=Ext.XTemplate)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-22T01:40:24.230

[QueryTemplates](http://code.google.com/p/querytemplates/)允许您将标记与逻辑完全分离。它使用 DOM 和 CSS 选择器来实现这一点。它有 JavaScript 的轻量版本（作为 jQuery 插件）和**可以生成原生 JS 代码的标准版本（不需要库来执行它）**。您需要 PHP 来生成标准版本的模板（CLI 版本很好）。库基于[phpQuery](http://code.google.com/p/phpquery/)，一个 PHP 的 jQuery 端口。

您可以看到[JavaScript 版本的演示](http://sandbox.meta20.net/querytemplates-js/demo.html)。使用标准版本，您可以在 PHP 中获得相当好的客户端体验 - 有 DOM 事件、JSON 支持，甚至是带有 JSONP 的 AJAX。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-01-17T01:56:37.547

如果您使用的是[Script#](http://projects.nikhilk.net/ScriptSharp)，您可能需要考虑[SharpTemplate](http://xtreemgeek.net/projects/sharptemplate/)，这是一个强类型、超高效的 HTML 模板引擎。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2012-11-23T00:20:53.500

你可以看看 soma-template，语法很轻量级。

纯 DOM 操作，许多特性，自然语法，可与其他库完全扩展，例如 underscore.string，带参数的函数调用，帮助程序，观察程序。如果需要，仅更新某些节点的能力，DOM 本身内部的模板。

[http://soundstep.github.com/soma-template/](http://soundstep.github.com/soma-template/)

# ruby-on-rails - 如何在 Rails 应用程序中存储年份

> ID：202294
> 
> 赞同：10
> 
> 时间：2008-10-14T18:35:06.513
> 
> 标签：ruby-on-rails, database-design, datetime

我只想将年份存储在我的一个模型中。目前我只有一个名为年份类型日期的数据库字段，但它似乎想要一个完整的日期（yyyy-mm-dd）而不是一年。

最好的存储方法是什么？在日期字段中，但使用某种方式获取它来存储日期位（在这种情况下，如何？），或在 int 字段中，或字符串字段或什么？在某些方面使用 int 字段感觉不对，但它可能是最简单的。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-14T18:42:25.563

这取决于可能的日期范围。如果您的日期从 BC 到遥远的未来（负数到 4 位以上），那么存储一个整数将是最简单的（仅出于排序原因）。如果您想进行计算或比较日期，这也是正确的。

否则我可能会选择一个字符串。

使用日期字段使用 1 月 1 日并在显示时提取年份部分。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-14T20:19:44.870

基于可维护性，我建议不要在日期字段中使用任意选择的日期。你会知道你已经任意选择了这个，但你的应用程序的后续维护者会吗？

我会选择一个 int ，因为这样你就不会存储除了你想要存储的东西之外的任何东西，而且它的含义不会有太多的混淆。

# reporting-services - 有什么方法可以导出/导入 sql server 报告服务订阅？

> ID：202295
> 
> 赞同：5
> 
> 时间：2008-10-14T18:35:16.123
> 
> 标签：reporting-services, subscriptions

我无法在 Report Manager 或 SQl Server Management Studio 中找到导出/导入订阅的方法。

有人知道这是否可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-22T05:44:43.913

您可以使用 SSRS Web 服务编写自己的东西。最大的农业取决于您的安全模型（双跳、Windows Auth、服务器场等）。

或者

如果你只是在移动东西，你可以试试这个应用程序：

[http://www.sqldbtips.com/showarticle.asp?ID=62](http://www.sqldbatips.com/showarticle.asp?ID=62)

# iphone - 登录到 iPhone 上的文件

> ID：202299
> 
> 赞同：18
> 
> 时间：2008-10-14T18:36:15.780
> 
> 标签：iphone, logging, nslog

将日志语句写入 iPhone 应用程序中的文件或数据库的最佳方式是什么？

理想情况下，可以使用 freopen() 将 NSLog() 输出重定向到文件，但我已经看到一些报告说它不起作用。有没有人已经这样做了，或者有任何想法如何最好地做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-10-15T02:43:25.327

如果你想使用 Cocoa，NSString 和 NSData 有读/写文件的方法，NSFileManager 给你文件操作。这是一个示例（应该在 iPhone 上工作）：

```
NSData *dataToWrite = [[NSString stringWithString:@"String to write"] dataUsingEncoding:NSUTF8StringEncoding];

NSString *docsDirectory = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) objectAtIndex:0];
NSString *path = [docsDirectory stringByAppendingPathComponent:@"fileName.txt"];

// Write the file
[dataToWrite writeToFile:path atomically:YES];

// Read the file
NSString *stringFromFile = [[NSString alloc] initWithContentsOfFile:path];  

// Check if file exists
NSFileManager *fileManager = [NSFileManager defaultManager];
[fileManager fileExistsAtPath:path]; // Returns a BOOL    

// Remove the file
[fileManager removeItemAtPath:path error:NULL];

// Cleanup
[stringFromFile release];
[fileManager release]; 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-10-14T18:52:05.873

我已成功在手机上使用 freopen(...) 将输出重定向到我自己的文件。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2010-01-20T16:38:34.700

这段代码对我很有用..

```
#if TARGET_IPHONE_SIMULATOR == 0
    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString *documentsDirectory = [paths objectAtIndex:0];
    NSString *logPath = [documentsDirectory stringByAppendingPathComponent:@"console.log"];
    freopen([logPath cStringUsingEncoding:NSASCIIStringEncoding],"a+",stderr);
#endif 
```

然后，您可以使用此处列出的方法从 iphone 获取日志文件[http://blog.coriolis.ch/2009/01/09/redirect-nslog-to-a-file-on-the-iphone/#more- 85](http://blog.coriolis.ch/2009/01/09/redirect-nslog-to-a-file-on-the-iphone/#more-85)

请注意，使用 freopen 将停止 XCODE 中的控制台工作。但是，由于某种原因，您可以在 xcode 的管理器中查看的控制台仍然运行良好。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-01-26T11:56:47.757

这段代码对我有用：

```
- (void)applicationDidFinishLaunching:(UIApplication *)application {
#if TARGET_IPHONE_SIMULATOR == 0
    freopen([@"/tmp/my_logs.txt" fileSystemRepresentation], "w", stderr);
#endif
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-12-28T15:44:21.887

考虑使用[Cocoa Lumberjack](https://github.com/robbiehanson/CocoaLumberjack)。它是一个轻量但灵活的实用程序，可替代 NSLog 功能。在我看来，它与 Log4J 属于同一类，允许自定义附加程序等。例如，它有一个 SQLite 记录器。

# algorithm - 四舍五入到任意数量的有效数字

> ID：202302
> 
> 赞同：84
> 
> 时间：2008-10-14T18:37:17.603
> 
> 标签：algorithm, rounding, significant-digits

如何将*任何*数字（不仅仅是大于 0 的整数）四舍五入为 N 个有效数字？

例如，如果我想四舍五入到三位有效数字，我正在寻找一个可以采用的公式：

1,239,451 并返回 1,240,000

12.1257 并返回 12.1

.0681 并返回 .0681

5 并返回 5

自然，该算法不应该被硬编码为仅处理 3 的 N，尽管这将是一个开始。

* * *

## 回答 #1

> 赞同：107
> 
> 时间：2009-10-17T00:20:15.390

这是Java中的相同代码，没有其他答案的12.100000000000001错误

我还删除了重复的代码，更改`power`为整数类型以防止`n - d`完成时出现浮动问题，并使长中间更清晰

该错误是由一个大数字乘以一个小数字引起的。相反，我将两个大小相似的数字相除。

**编辑**
修复了更多错误。添加了对 0 的检查，因为它会导致 NaN。使函数实际使用负数（原始代码不处理负数，因为负数的对数是复数）

```
public static double roundToSignificantFigures(double num, int n) {
    if(num == 0) {
        return 0;
    }

    final double d = Math.ceil(Math.log10(num < 0 ? -num: num));
    final int power = n - (int) d;

    final double magnitude = Math.pow(10, power);
    final long shifted = Math.round(num*magnitude);
    return shifted/magnitude;
} 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-10-14T19:20:32.587

这是一个简短的 JavaScript 实现：

```
function sigFigs(n, sig) {
    var mult = Math.pow(10, sig - Math.floor(Math.log(n) / Math.LN10) - 1);
    return Math.round(n * mult) / mult;
}

alert(sigFigs(1234567, 3)); // Gives 1230000
alert(sigFigs(0.06805, 3)); // Gives 0.0681
alert(sigFigs(5, 3)); // Gives 5 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2008-10-14T18:47:01.700

概括：

```
double roundit(double num, double N)
{
    double d = log10(num);
    double power;
    if (num > 0)
    {
        d = ceil(d);
        power = -(d-N);
    }
    else
    {
        d = floor(d); 
        power = -(d-N);
    }

    return (int)(num * pow(10.0, power) + 0.5) * pow(10.0, -power);
} 
```

* * *

所以你需要找到第一个非零数字的小数位，然后保存接下来的N-1个数字，然后根据其余的四舍五入第N个数字。

我们可以使用 log 来做第一个。

```
log 1239451 = 6.09
log 12.1257 = 1.08
log 0.0681  = -1.16 
```

所以对于数字 > 0，取对数的上限。对于数字 < 0，取日志的地板。

现在我们有了数字`d`：第一种情况下是 7，第二种情况下是 2，第三种情况下是 -2。

我们必须四舍五入`(d-N)`。就像是：

```
double roundedrest = num * pow(10, -(d-N));

pow(1239451, -4) = 123.9451
pow(12.1257, 1)  = 121.257
pow(0.0681, 4)   = 681 
```

然后做标准的四舍五入：

```
roundedrest = (int)(roundedrest + 0.5); 
```

并撤消战俘。

```
roundednum = pow(roundedrest, -(power)) 
```

其中power是上面计算的功率。

* * *

关于准确性：Pyrolistical 的答案确实更接近真实结果。但请注意，在任何情况下您都不能准确地表示 12.1。如果您按如下方式打印答案：

```
System.out.println(new BigDecimal(n)); 
```

答案是：

```
Pyro's: 12.0999999999999996447286321199499070644378662109375
Mine: 12.10000000000000142108547152020037174224853515625
Printing 12.1 directly: 12.0999999999999996447286321199499070644378662109375 
```

所以，使用 Pyro 的答案！

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-04-08T15:26:57.513

不是“短而甜”的 JavaScript 实现吗

```
Number(n).toPrecision(sig) 
```

例如

```
alert(Number(12345).toPrecision(3) 
```

?

抱歉，我在这里不是在开玩笑，只是使用 Claudiu 的“roundit”函数和 JavaScript 中的 .toPrecision 给了我不同的结果，但仅限于最后一位数字的舍入。

JavaScript：

```
Number(8.14301).toPrecision(4) == 8.143 
```

。网

```
roundit(8.14301,4) == 8.144 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2010-11-19T01:17:06.600

Pyrolistical（非常好！）的解决方案仍然存在问题。Java 中的最大 double 值约为 10^308，而最小值约为 10^-324。`roundToSignificantFigures`因此，在将函数应用于 . 的 10 次方以内的东西时，您可能会遇到麻烦`Double.MIN_VALUE`。例如，当您调用

```
roundToSignificantFigures(1.234E-310, 3); 
```

那么变量`power`的值将是 3 - (-309) = 312。因此，变量`magnitude`将变为`Infinity`，从那时起它都是垃圾。幸运的是，这不是一个无法克服的问题：它只是溢出的*因素* `magnitude`。真正重要的是*产品* `num * magnitude`，而且不会溢出。解决此问题的一种方法是将乘以因子`magintude`分解为两个步骤：

```
 public static double roundToNumberOfSignificantDigits(double num, int n) {

    final double maxPowerOfTen = Math.floor(Math.log10(Double.MAX_VALUE));

    if(num == 0) {
        return 0;
    }

    final double d = Math.ceil(Math.log10(num < 0 ? -num: num));
    final int power = n - (int) d;

    double firstMagnitudeFactor = 1.0;
    double secondMagnitudeFactor = 1.0;
    if (power > maxPowerOfTen) {
        firstMagnitudeFactor = Math.pow(10.0, maxPowerOfTen);
        secondMagnitudeFactor = Math.pow(10.0, (double) power - maxPowerOfTen);
    } else {
        firstMagnitudeFactor = Math.pow(10.0, (double) power);
    }

    double toBeRounded = num * firstMagnitudeFactor;
    toBeRounded *= secondMagnitudeFactor;

    final long shifted = Math.round(toBeRounded);
    double rounded = ((double) shifted) / firstMagnitudeFactor;
    rounded /= secondMagnitudeFactor;
    return rounded;
} 

```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2010-08-10T08:00:42.033

这个java解决方案怎么样：

```
double roundToSignificantFigure(double num, int 精度){
 返回新的 BigDecimal(num)
            .round(new MathContext(precision, RoundingMode.HALF_EVEN))
            .doubleValue();
}

```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2010-06-04T16:18:40.653

这是处理负数的 Ates 的 JavaScript 的修改版本。

```
function sigFigs(n, sig) {
    if ( n === 0 )
        return 0
    var mult = Math.pow(10,
        sig - Math.floor(Math.log(n < 0 ? -n: n) / Math.LN10) - 1);
    return Math.round(n * mult) / mult;
 } 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2015-05-04T22:56:25.090

## JavaScript：

```
Number( my_number.toPrecision(3) ); 
```

该`Number`函数会将表单的输出更改`"8.143e+5"`为`"814300"`.

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2013-10-22T00:07:22.410

这晚了 5 年，但我会分享给其他人，但仍然有同样的问题。我喜欢它，因为它很简单，并且在代码方面没有计算。有关更多信息，请参阅[用于显示重要数字的内置方法](https://stackoverflow.com/questions/19487506/built-in-methods-for-displaying-significant-figures/19506712#19506712)。

这是如果您只想打印出来。

```
public String toSignificantFiguresString(BigDecimal bd, int significantFigures){
    return String.format("%."+significantFigures+"G", bd);
} 
```

这是如果你想转换它：

```
public BigDecimal toSignificantFigures(BigDecimal bd, int significantFigures){
    String s = String.format("%."+significantFigures+"G", bd);
    BigDecimal result = new BigDecimal(s);
    return result;
} 
```

这是它的一个例子：

```
BigDecimal bd = toSignificantFigures(BigDecimal.valueOf(0.0681), 2); 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-14T18:52:37.913

您是否尝试过以手动方式对其进行编码？

1.  将数字转换为字符串
2.  从字符串的开头开始，计数数字 - 前导零不重要，其他一切都是。
3.  当您到达“第 n 个”数字时，向前看下一个数字，如果它是 5 或更高，则向上取整。
4.  用零替换所有尾随数字。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-10-17T00:41:19.240

*[更正，2009-10-26]*

本质上，对于 N 个有效*小数*位：

• 将数字乘以 10 ^N
• 加 0.5
• 截断小数位（即，将结果截断为整数）
• 除以 10 ^N

对于 N 个有效*整数*（非小数）数字：

• 将数字除以 10 ^N
• 加 0.5
• 截断小数位（即，将结果截断为整数）
• 乘以 10 ^N

您可以在任何具有“INT”（整数截断）运算符的计算器上执行此操作。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2010-06-22T00:25:30.727

```
/**
 * Set Significant Digits.
 * @param value value
 * @param digits digits
 * @return
 */
public static BigDecimal setSignificantDigits(BigDecimal value, int digits) {
    //# Start with the leftmost non-zero digit (e.g. the "1" in 1200, or the "2" in 0.0256).
    //# Keep n digits. Replace the rest with zeros.
    //# Round up by one if appropriate.
    int p = value.precision();
    int s = value.scale();
    if (p < digits) {
        value = value.setScale(s + digits - p); //, RoundingMode.HALF_UP
    }
    value = value.movePointRight(s).movePointLeft(p - digits).setScale(0, RoundingMode.HALF_UP)
        .movePointRight(p - digits).movePointLeft(s);
    s = (s > (p - digits)) ? (s - (p - digits)) : 0;
    return value.setScale(s);
} 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2011-06-21T16:10:45.743

这是 Visual Basic.NET 中 Pyrolistical 的（当前最佳答案）代码，如果有人需要的话：

```
Public Shared Function roundToSignificantDigits(ByVal num As Double, ByVal n As Integer) As Double
    If (num = 0) Then
        Return 0
    End If

    Dim d As Double = Math.Ceiling(Math.Log10(If(num < 0, -num, num)))
    Dim power As Integer = n - CInt(d)
    Dim magnitude As Double = Math.Pow(10, power)
    Dim shifted As Double = Math.Round(num * magnitude)
    Return shifted / magnitude
End Function 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2013-06-01T16:05:51.537

这是我在 VB 中提出的：

```
Function SF(n As Double, SigFigs As Integer)
    Dim l As Integer = n.ToString.Length
    n = n / 10 ^ (l - SigFigs)
    n = Math.Round(n)
    n = n * 10 ^ (l - SigFigs)
    Return n
End Function 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2017-03-27T16:22:43.120

`return new BigDecimal(value, new MathContext(significantFigures, RoundingMode.HALF_UP)).doubleValue();`

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2018-01-28T02:42:21.370

`math.Round()`我在 Go 中需要这个，由于 Go 标准库的缺乏（在 go1.10 之前），这有点复杂。所以我也不得不鞭打它。这是我对[Pyrolistical 出色答案的](https://stackoverflow.com/a/1581007/1068283)翻译：

```
// TODO: replace in go1.10 with math.Round()
func round(x float64) float64 {
    return float64(int64(x + 0.5))
}

// SignificantDigits rounds a float64 to digits significant digits.
// Translated from Java at https://stackoverflow.com/a/1581007/1068283
func SignificantDigits(x float64, digits int) float64 {
    if x == 0 {
        return 0
    }

    power := digits - int(math.Ceil(math.Log10(math.Abs(x))))
    magnitude := math.Pow(10, float64(power))
    shifted := round(x * magnitude)
    return shifted / magnitude
} 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2020-07-12T13:28:07.470

只需使用 FloatToStrF，您就可以避免使用 10 次幂等进行所有这些计算。

FloatToStrF 允许您（除其他外）选择输出值（将是一个字符串）中的精度（有效数字的数量）。当然，您可以然后将 StrToFloat 应用于此以将您的舍入值作为浮点数。

看这里：

[http://docs.embarcadero.com/products/rad_studio/delphiAndcpp2009/HelpUpdate2/EN/html/delphivclwin32/SysUtils_FloatToStrF@Extended@TFloatFormat@Integer@Integer.html](http://docs.embarcadero.com/products/rad_studio/delphiAndcpp2009/HelpUpdate2/EN/html/delphivclwin32/SysUtils_FloatToStrF@Extended@TFloatFormat@Integer@Integer.html)

* * *

## 回答 #18

> 赞同：-1
> 
> 时间：2013-05-19T05:51:47.980

```
public static double roundToSignificantDigits(double num, int n) {
    return Double.parseDouble(new java.util.Formatter().format("%." + (n - 1) + "e", num).toString());
} 
```

此代码使用内置格式化函数，该函数转换为舍入函数

# php - 创建 PHP DOM xml 文件并创建保存文件链接/提示，而无需在已发送标头时将文件写入服务器

> ID：202305
> 
> 赞同：2
> 
> 时间：2008-10-14T18:37:58.367
> 
> 标签：php, xml, dom, file

我创建了一个 PHP DOM xml 片段并将其保存到这样的字符串中：

```
<?php
  // create a new XML document 
  $doc = new DomDocument('1.0');
  ...  
  ...
  ...
  $xmldata = $doc->saveXML();
?> 
```

现在我不能使用标题发送文件下载提示，也不能将文件写入服务器，或者更确切地说，我不希望文件放在上面。

保存此文件链接或下载提示之类的东西会很好。我该怎么做？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-15T08:45:49.950

我从评论中看到您在 CMS 框架内工作，并且无法在您的代码所在的位置之前停止输出内容。

如果您正在使用的脚本已经输出了内容（超出了您的控制范围），那么您无法仅在一个脚本中完成您想要实现的目标。

您的脚本可以发送标头说“以下内容是 HTML”，然后输出 HTML，或者发送标头说“以下内容是 XML，是附件并具有特定文件名”。你不能两者都做。

您可以输出包含指向用于下载 XML 文件的单独脚本的链接的 HTML，也可以发出文件下载但不输出 HTML。

因此，您必须在正在修改的 CMS 脚本的输出中添加下载链接，然后在单独的脚本中处理下载。

我做了一个应该有所帮助的工作示例。该示例包括一个简单的 HTML 文档，其中包含一个下载链接，以及一个随后处理下载的 PHP 脚本。

查看下面的代码或查看[实时示例](http://webignition.net/examples/xmldownload/)。

**HTML（去除了多余的绒毛，不一定有效）**

```
<html>
<head>
<title>XML Download Example</title>
</head>

<body>

<a href="download.php">Download XML example</a>

</body>
</html> 
```

**PHP**

```
<?php
// Populate XML document
    $doc = new DomDocument();
    // ... various modifications to the document are made

// Output headers
    header('Content-type: "text/xml"; charset="utf8"');
    header('Content-disposition: attachment; filename="example.xml"');

// Output content
    echo $doc->saveXML();
?> 
```

如果您完全无法通过第二个脚本处理下载（也许您无法访问相关数据），您将不得不重新考虑问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-14T21:11:33.937

您可以在 php.ini 中启用 output_buffering，然后您可能有一些发送标头的选项。

[http://us.php.net/manual/en/function.headers-sent.php](http://us.php.net/manual/en/function.headers-sent.php)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-06-01T05:37:58.553

同样的事情对我有用。但我没有使用 XML DOM。我使用 SimpleXML 来解析我的 xml。

> $xml = new SimpleXMLElement("<root></root>");

我想给我的视图一个自定义 xml，它将根据他们通过表单提供的数据生成。在提交表单时，他们会以自己想要的名称下载 xml。

> header('内容类型: "text/xml"; charset="utf8"');
> 
> header('Content-disposition: attachment; filename="'.$_POST['filename'].'.xml"');
> 
> 回声 $xml->asXML();

# visual-studio - 如何在 Visual Studio 中自动增加程序集（内部版本）编号？

> ID：202306
> 
> 赞同：4
> 
> 时间：2008-10-14T18:38:13.497
> 
> 标签：visual-studio

如何在 Visual Studio 中自动增加程序集（内部版本）编号？

### 复制：

[/questions/650/自动更新版本号](https://stackoverflow.com/questions/650/)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-14T18:41:27.047

您可以在[AssemblyVersionAttribute](http://msdn.microsoft.com/en-us/library/system.reflection.assemblyversionattribute.assemblyversionattribute.aspx)中使用通配符：

```
[assembly: AssemblyVersion("1.0.*")] 
```

这将导致 build 等于自当地时间 2000 年 1 月 1 日以来的天数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-14T18:42:20.587

也许这就是您想要的[Code Project](http://www.codeproject.com/Articles/11160/Increment-Build-Number-in-VS-NET)。否则，您可以使用 *.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-14T18:42:51.570

我在批处理文件中使用[http://code.mattgriffith.net/UpdateVersion/](http://code.mattgriffith.net/UpdateVersion/)作为预构建步骤，并调用与我们的修订控制系统进行交互。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-14T18:43:25.843

设置它应该这样做：

```
[assembly: AssemblyVersion("1.0.*.*")] 
```

# jakarta-ee - 如何在不打开 Java 的情况下打印 Word 文档？

> ID：202322
> 
> 赞同：1
> 
> 时间：2008-10-14T18:42:40.290
> 
> 标签：jakarta-ee, printing, ms-word, web-based

我有一个基于 J2EE 的 Web 应用程序，在其中单击一个按钮我需要从 Java 创建一个 word 文件。我希望能够将打印命令发送到该文件，以便在用户无需打开文档并手动执行的情况下打印该文件。

谁能告诉我这是否可行，如果可以，如何进行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-14T18:47:53.370

生成文件很容易。看看[Apache POI](http://poi.apache.org/)，一个访问 Microsoft 格式文件的 Java API。该网站有很多例子。

关于打印它，我真的不知道这是否可能。我认为您总是需要在客户端打开它才能打印它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-14T18:48:30.247

您必须创建一个 ActiveX 来加载文档内容并触发打印命令。没有其他方法可以在客户端计算机中打开文件并触发命令。

编辑：如果你可以使用 HTML，你可以这样做

```
<script>
function load() {
window.print();
window.close();
}
</script> 
```

和

```
<body onLoad="load()" ...> 
```

在弹出窗口中打开文档并打印。然后关闭弹出窗口。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-07-08T16:17:40.863

您可以使用只有 2 行的简单**AutoIt**代码。并完成您的工作，在您的程序中执行该代码文件。

[http://www.autoitscript.com/site/autoit/](http://www.autoitscript.com/site/autoit/)

*像这样的代码：*

```
$sRTFfilename = "C:\t\t.rtf" ;Change this path to one of your own 
ShellExecute('"' & $sRTFfilename & '"', "", @ScriptDir, "print", @SW_HIDE) 
```

;-)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-14T19:08:14.373

当您特别提到 Java 作为您的环境时，您可能希望将 OpenOffice 或 StarOffice 考虑在内 - 它们有一个 API，它比 ActiveX 或远程控制 Word 更容易通过 Java 进行对话。

它并不比 Word 更重量级。参考资料和文档应该很容易找到。

我在一家公司工作过，我们经常使用 Remote-controlled-Word，最后改用 StarOffice。这不是用于打印，而是用于文档转换（例如从 Word 到 HTML），但应该足够相似。

当然，我说的是“旧版本的 Word”，但我们通常会遇到 Word 锁定的问题，其中一些任意对话框要求确认 Word 找到的任何内容 - 我们的服务器（在后台运行，没有桌面联系人）显然是一项操作没能。改用 StarSuite 后情况好多了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-14T19:25:15.557

是否可以改为以 HTML 格式呈现文档？如果你能做到这一点，那么你就可以相当简单地允许用户通过浏览器进行打印。您可能还可以更轻松地使用 PDF，至少它会更容易跨不同平台访问。

如果你被迫使用 MS Word，那么你能做的将非常有限。正如[Leonel](https://stackoverflow.com/questions/202322/how-do-i-print-a-word-document-in-java-without-opening-it#202341)所提到的，我认为 ActiveX 将是您唯一的选择，即使那样必须打开文档，您也可以从浏览器自动启动 Word。您甚至可以通过 ActiveX 将 Word 的实例嵌入到 IE 中，但我不能 100% 确定这一点。

# visual-studio - StackOverflow atom feed 与 VS2008 起始页一起使用

> ID：202323
> 
> 赞同：3
> 
> 时间：2008-10-14T18:42:48.653
> 
> 标签：visual-studio, visual-studio-2008, rss

我可以在 VS 起始页上使用 StackOverflow 的 URL 来代替从未更新的 MS 页面吗？VS 使用的 URL 可以在 Tools->Options::Startup 对话框中设置。

我已经尝试过[https://stackoverflow.com/feeds](https://stackoverflow.com/feeds) VS 投诉，但出现以下错误：

> 当前新闻频道可能不是有效的 RSS 提要，或者您的 Internet 连接可能不可用。要更改新闻频道，请在工具菜单上单击选项，然后展开环境并单击启动。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-14T18:48:57.393

[https://stackoverflow.com/tags/vs2008](https://stackoverflow.com/tags/vs2008)是我会选择的 - 将 vs2k8 的相关问题放在首位

**编辑**- 我不知道为什么这被否决了 - 该 URL 对 SO 有效。

如果您正在寻找特定的标签供稿，您可以获取类似[https://stackoverflow.com/feeds/tag/vs2008](https://stackoverflow.com/feeds/tag/vs2008)的内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-14T19:05:56.280

看来[https://stackoverflow.com/feeds](https://stackoverflow.com/feeds)实际上是一个原子提要，而不是 rss，所以这可能是 VS 问题的来源。

您可能必须创建一个中介并将原子转换为 rss。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-15T14:41:55.207

这是我对问题的不太优雅的解决方案..

您将需要访问 php 服务器。

提要需要从 atom 转换为 RSS，这里有一个非常好的 xsl 样式表可以满足要求：http: [//atom.geekhood.net/](http://atom.geekhood.net/)，特别是： http: [//atom.geekhood.net/atom2rss。 xsl](http://atom.geekhood.net/atom2rss.xsl)

提要中有一个 VS 似乎不喜欢的元素：

```
<link xmlns="http://www.w3.org/2005/Atom" xmlns:thr="http://purl.org/syndication/thread/1.0" rel="replies" type="application/atom+xml" href="http://stackoverflow.com/feeds/question/204696/answers" thr:count="5" /> 
```

要解决这个问题，请转到样式表的末尾并像我一样注释掉以下副本：

```
<!-- copy extensions -->
<x:template match='*'>
    <x:comment>Unknown element <x:value-of select="local-name(.)"/></x:comment>
<!--    
    <x:copy>
        <x:copy-of select='node()|@*'/>
    </x:copy>
-->
</x:template> 
```

现在在您的 php 服务器上创建一个包含以下内容的 php 文件：

```
<?php

$url=$_GET['url'];

$ch = curl_init($url);
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
$content = curl_exec($ch);
curl_close($ch);

$chan = new DOMDocument(); 
$chan->loadXML($content);  
$sheet = new DOMDocument(); 
$sheet->load('atom2rss.xsl'); 
$processor = new XSLTProcessor();
$processor->registerPHPFunctions();
$processor->importStylesheet($sheet);
$result = $processor->transformToXML($chan); 

echo $result;

?> 
```

现在将 atom2rss.xsl 文件移动到与您创建的 php 文件相同的目录中。

现在在 VS 中，您可以将新的 starpage url 添加为：

[http://yourserver.com/file.php?http://stackoverflow/feeds](http://yourserver.com/file.php?http://stackoverflow/feeds)

其中**yourserver.com**是您的域，而**file.php**是上面包含 php 内容的文件...

然后，您应该能够在 Visual Studio 的起始页面中享受来自 Stackoverflow.com 的 RSS 提要，当然，如果您喜欢那种东西的话。

这假设您正在运行 PHP5 并在服务器上启用了 php_curl.dll 和 php_xsl.dll。

享受

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-14T18:49:41.773

尝试主页的 RSS 提要：[https ://stackoverflow.com/feeds](https://stackoverflow.com/feeds)

**编辑**：哎呀，正如评论正确指出的那样，看起来它是 ATOM 提要而不是 RSS 提要，我应该在发布之前仔细检查！我尝试通过 FeedBurner 运行提要以将其转换为 RSS，但 VS 仍然不喜欢它。奇怪的是，当我将 FeedBurner 提要输出保存为静态 XML 文件并在本地提供时，VS 没有问题！

我已经玩了一段时间了，无法找到解决方法。我不确切知道 VS 不喜欢什么（大概是与标头相关的东西），但我猜这可能起作用的唯一方法是，如果 SO 人在他们的最后实现了一些东西，或者有人写了一个代理。

**再次编辑**：它实际上可能与编码有关。嗯……

# c# - 查询机器规格

> ID：202328
> 
> 赞同：3
> 
> 时间：2008-10-14T18:43:31.990
> 
> 标签：c#, wmi

有哪些方法可以通过编程接口查询本地机器的规格（CPU 规格、操作系统版本、显卡规格和驱动程序等一系列内容）？我们正在用 C# 编写一个简单的应用程序来测试我们的主应用程序的兼容性，并希望它转储一些系统指标，但我似乎无法找到从哪里开始，使用什么接口，库，任何东西。

我尝试了各种搜索，但只能找到需要用户交互或必须安装的程序和 GUI 程序。

或者，只要允许我们将其与测试应用程序一起分发，一个小型命令行程序也可以正常工作。

我找到了一个程序，它可以获得我想要的一些规范，[PsInfo](http://technet.microsoft.com/en-us/sysinternals/bb897550.aspx)。然而，它似乎要求每个用户在第一次运行时同意一些许可，即使它是一个命令行应用程序。另外，它只处理操作系统/CPU 信息，我需要的还不止这些。

另外：忘了明确提及，但这确实只对 Windows 机器是必需的。你们好快啊！

编辑：这个 WMI 看起来确实像我需要的，谢谢！虽然有很多蠕虫，所以我必须深入研究。它提到对于某些事情，用户必须具有管理员权限；这可能不会是一个大问题，但它可能会限制它一点。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-14T18:51:40.443

也许考虑使用[Windows Management Instrumentation](http://msdn.microsoft.com/en-us/library/aa394582(VS.85).aspx) (WMI)，假设它是您计划查询的 Windows 机器。看看 Microsoft 的[WMI Code Creator](http://www.microsoft.com/downloads/details.aspx?familyid=2cc30a64-ea15-4661-8da4-55bbc145c30e&displaylang=en)。它可以让您轻松使用几种语言的代码示例。

WMI 在 Windows 2000 时代一直运行良好，但在一些帮助下也可以在 Win98 机器上运行。

只要您拥有或可以为您尝试查询的机器提供管理员凭据，WMI 绝对是您的最佳选择。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-14T18:49:45.830

对于此类信息，[WMI](http://msdn.microsoft.com/en-us/library/aa394582(VS.85).aspx)是您的朋友。幸运的是，在 .NET 中处理 WMI 比在非托管环境中容易得多。有很多文章可以开始，比如[这篇](http://www.csharphelp.com/archives2/archive334.html)文章，或者[这篇](http://69.10.233.10/KB/system/Wmi_Processor_infoWrapper.aspx)文章来检索处理器信息。

您最终将针对 WMI 命名空间中的对象编写类似 SQL 的查询，以检索您想要的信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-15T17:22:34.273

我不妨按照这里的建议使用 WMI 发布我用来获取所需一切的基本代码。

必须在 c# 项目中包含对 System.Management 的引用。然后，源代码本身可能是非常糟糕的 c#，但我以前从未真正用它编写过它，它是用于内部工具的，所以这有点无关紧要。我已经简化了一点，所以它只是真正处理输出机器规格（除此之外，该工具还做其他事情）。对 LogClass() 的每次调用都会转储其所有属性。要转储更多类，只需查看[WMI 类](http://msdn.microsoft.com/en-us/library/aa394554(VS.85).aspx)的 MSDN 部分。

```
using System;
using System.Collections.Generic;
using System.Text;
using System.Management;
using System.IO;

namespace SyTest
{
  class Program
  {
    static StreamWriter specStream;

    static void Main(string[] args)
    {
      FileStream specFile =
          new FileStream("machine-specs.txt",FileMode.Create,FileAccess.Write);
      specStream = new StreamWriter(specFile);

      LogClass("Win32_DesktopMonitor");
      LogClass("Win32_VideoController");
      LogClass("Win32_Processor");
      // etc

      specStream.Close();
      specFile.Close();
    }

    static void LogClass(string strTable)
    {
      if (strTable.Length <= 0) return;
      specStream.Write("--- " + strTable + " ---\r\n\r\n");
      WqlObjectQuery wqlQuery =
          new WqlObjectQuery("SELECT * FROM " + strTable);
      ManagementObjectSearcher searcher =
          new ManagementObjectSearcher(wqlQuery);
      try
      {
        if (searcher.Get().Count <= 0)
        {
          specStream.Write("Class has no instances\r\n\r\n");
        }
        foreach (ManagementObject obj in searcher.Get())
        {
          specStream.Write("* " + obj.ToString() + "\r\n");

          if (obj.Properties.Count <= 0)
          {
            specStream.Write("Class instance has no properties\r\n");
            continue;
          }

          foreach (System.Management.PropertyData prop in obj.Properties)
          {
            LogAttr(obj, prop.Name);
          }

          specStream.Write("\r\n");
        }
      }
      catch { specStream.Write("Class does not exist\r\n\r\n"); }
    }
    static void LogAttr(ManagementObject obj, string str)
    {
      if (str.Length <= 0) return;
      string strValue = "";
      try
      {
        strValue = obj[str].ToString();
        try
        {
          string[] pstrTmp = ((string[])obj[str]);
          if (pstrTmp.Length > 0) strValue = String.Join(", ", pstrTmp);
        }
        catch { } // Problem casting, fall back on original assignment
      }
      catch { strValue = "[UNDEFINED]"; }
      specStream.Write(str + ": " + strValue + "\r\n");
    }
  }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-14T18:54:16.273

对于您将为 linux 开发的奇怪情况，您可以在伪文件系统中找到很棒的东西`/proc`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-27T17:10:55.047

如果您决定使用 WMI，您可能需要查看 Microsoft 的[WMI Code Creator](http://www.microsoft.com/downloads/details.aspx?familyid=2cc30a64-ea15-4661-8da4-55bbc145c30e&displaylang=en)。它使处理 WMI 变得非常容易。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-03-31T18:26:48.437

有一个名为 nuget 的包`MissingLinq.Linq2Management`，它几乎将有关 WMI 的所有内容都包装到了一个很好的强类型对象中。看起来还不错。

[https://missinglinq.codeplex.com/](https://missinglinq.codeplex.com/)

# c# - 在 C# 中构建 wParam 或 lParam 的好方法是什么？（比班次操作员更友好的东西？）

> ID：202330
> 
> 赞同：2
> 
> 时间：2008-10-14T18:44:20.023
> 
> 标签：c#, winapi

当 WIN32 文档说类似：

```
wParam
    The low-order word specifies the edit control identifier.
    The high-order word specifies the notification message. 
```

构建 wParam 的好方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-14T18:56:20.870

```
public static ushort LowWord(uint val)
{
    return (ushort)val;
}

public static ushort HighWord(uint val)
{
   return (ushort)(val >> 16);
}

public static uint BuildWParam(ushort low, ushort high)
{
    return ((uint)high << 16) | (uint)low;
} 
```

# machine-learning - 实现支持向量回归的最佳 MATLAB 工具箱？

> ID：202334
> 
> 赞同：10
> 
> 时间：2008-10-14T18:45:56.273
> 
> 标签：machine-learning, svm, matlab

在[这篇关于 SVM 的 Wikipedia 文章](http://en.wikipedia.org/wiki/Support_vector_machine#Software)中，有许多链接指向支持向量机的 MATLAB 工具箱的不同实现。任何人都可以建议在速度、易用性等方面哪些是最好的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-14T18:58:29.323

我用过[libSVM](http://www.csie.ntu.edu.tw/~cjlin/libsvm/)。它非常快速和简单，并且还提供了一些有用的工具。[这里](http://homepages.cae.wisc.edu/~ece539/matlab/)有一些使用它的例子。另一个好处是 C++ 和 Java 也有实现，所以如果您发现自己需要在 Matlab 之外进行开发（例如，将原型变成快速的东西），您将拥有一个熟悉的界面来使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-14T19:30:27.697

毫无疑问，考利是最好的。

[http://theoval.sys.uea.ac.uk/svm/toolbox/](http://theoval.sys.uea.ac.uk/svm/toolbox/)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-09-07T22:35:44.653

您始终可以在 Bioinformatics Toolbox 中使用 MathWorks 的 SVM 实现和以下功能：**svmtrain**和**svmclassify**，它们像往常一样具有出色的文档

* * *

## 回答 #4

> 赞同：-4
> 
> 时间：2009-11-05T21:21:20.547

这不会直接回答您的问题，但如果您想加快 M 脚本的速度，请查看嵌入式 matlab 工具箱和 MEX 函数。基本上，您可以使用这些工具来编译您的 M 脚本，我已经完成了，并且我得到了一个数量级的性能增益最小值。MW的人说你可以得到100倍的提升。

# c++ - 有没有一种方便的方法可以将 std::pair 包装为新类型？

> ID：202340
> 
> 赞同：13
> 
> 时间：2008-10-14T18:48:08.313
> 
> 标签：c++, stl

我经常发现自己使用 std::pair 将两个相关数量的逻辑分组定义为函数参数/返回值。一些示例：行/列、标签/值等。

很多时候，我真的应该滚动自己的课程，而不是仅仅使用 std::pair。当事情开始崩溃时很容易看出——当代码中到处都是 make_pair 时，首先，其次，很难记住什么是什么——与`std::pair<int, int>`type 相比，an 传达的意义更少`Position`。

您发现什么是将 std::pair 的功能包装在传达真实含义的类型中的最佳方法？

以下是我考虑过的一些事情：

```
typedef std::pair<int, int> Position; 
```

这至少在传递类型时为类型提供了一个有意义的名称，但类型不是强制的，它仍然只是一对，并且大多数相同的问题仍然存在。不过这写起来很简单。

```
struct Position : public std::pair<int, int>
{
    typedef std::pair<int, int> Base;
    Position() : Base() {}
    Position(const Position &x) : Base(x) {}
    Position(int a, int b) : Base(a, b) {}

    int &row() { return first; }
    const int &row() const { return first; }

    int &col() { return second; }
    const int &col() const { return second; }
}; 
```

这更好，因为我们可以通过一个合理的描述性名称来访问变量。这里的问题是您仍然可以访问 first 和 second，因此抽象很容易泄漏。此外，通过函数访问简单变量会使语法烦人。

显而易见的下一步是将继承设为私有：

```
struct Position : private std::pair<int, int>
{
    typedef std::pair<int, int> Base;
    Position() {}
    Position(const Position &x) : Base(x) {}
    Position(int a, int b) : Base(a, b) {}

    int &row() { return first; }
    const int &row() const { return first; }

    int &col() { return second; }
    const int &col() const { return second; }

    bool operator<(const Position &x) const { return Base(*this) < Base(x); }
    // other forwarding operators as needed...
}; 
```

所以现在至少我们已经摆脱了对first和second的访问，但是现在又出现了一个新问题。当我们想将类型存储在 std::set 中时，我们现在无法访问 operator< 重载，因为我们无法访问 first 和 second。这意味着我们必须为我们想要的每个运算符重载定义一个转发函数。对我来说，这通常是 ==、!= 和 <，但可能还有其他我想要的。是的，我知道我可能不应该重载 operator< 只是为了将它粘贴在关联容器中，但它让一切变得如此简单......为每种新类型定义这些运算符很痛苦，我们仍然必须通过函数访问. 我们可以解决这个问题：

```
struct Position
{
    Position() {}
    Position(const Position &x) : row(x.row), col(x.col) {}
    Position(int row, int col) : row(row), col(col) {}

    int row, col;
};
bool operator<(const Position &a, const Position &b)
{
    return a.row < b.row || (!(b.row < a.row) && a.col < b.col);
}
// more overloads as needed 
```

所以现在我们有了简单的变量访问，但是现在定义重载的操作符更加痛苦，因为不是仅仅将它们转发到对的实现，我们实际上每次都必须重新实现它们......

有没有我忽略的解决方案可以让这件事变得简单而没有缺点？如果没有，你会倾向于哪个？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-14T18:50:21.740

这就是[Boost.Tuple](http://www.boost.org/doc/libs/1_36_0/libs/tuple/doc/tuple_users_guide.html)的用途。

但是您现在可能应该使用[std::tuple](http://en.cppreference.com/w/cpp/utility/tuple) ...

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-14T19:22:48.307

一位同事向我指出了两种可能的解决方案：

使用[boost strong typedef](http://www.boost.org/doc/libs/1_36_0/boost/strong_typedef.hpp)作为 typedef 的改进版本。我以前从未听说过这个，而且它似乎并不是任何子库的一部分，只是有点浮动。

使用宏生成不同运算符所需的代码。这样我就不必在每个定义级别上显式编写任何内容，只需执行类似`DEFINE_PAIR_TYPE(Position, int, int, row, col);`. 这可能最接近我正在寻找的东西，但与其他人提出的一些解决方案相比，它仍然感觉有点邪恶。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-15T02:54:29.160

还有[Boost::Operators](http://www.boost.org/doc/libs/1_36_0/libs/utility/operators.htm#arithmetic)库可以自动生成操作符代码。它类似于[Martin York 建议](https://stackoverflow.com/questions/202340/is-there-a-convenient-way-to-wrap-stdpair-as-a-new-type#202425)的 SGI 库，但可能更便携。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-14T19:08:02.783

您可以使用一些有助于定义关系运算符的标准实用程序模板。

#include <实用程序>

[http://www.sgi.com/tech/stl/operators.html](http://www.sgi.com/tech/stl/operators.html)

### 类型要求

operator!= 的要求是 x == y 是一个有效的表达式
operator> 的要求是 y < x 是一个有效的表达式
operator<= 的要求是 y < x 是一个有效的表达式
operator> 的要求= 是 x < y 是一个有效的表达式

所以基本上它会自动生成其他运算符给 < 和 == 你所要做的就是包含 <utility>

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-14T18:52:57.790

您仍然可以`pair`通过转发来重用该功能：

```
bool operator< ( const Position &a, const Position &b ) 
{
    return
        std::make_pair( a.row, a.col ) < std::make_pair( b.row, b.col );
} 
```

尽管您最终仍然需要为您需要的每个手术室都这样做......

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-15T22:25:40.497

我必须说，为了制作一个简单的结构，需要花很多心思。

重载 operator< 和 operator== 就完成了。我在编写的很多代码中都使用它，主要是因为我通常要存储的成员变量多于 2 个。

```
struct MyStruct
{
    std::string var1;
    std::string var2;
    bool var3;

    struct less : std::binary_function<struct MyStruct, struct MyStruct, bool>
    {
        bool operator() (const struct MyStruct& s1, const struct MyStruct& s2) const
            { if (var1== a2.var1) return var2 < a2.var2; else return var3 < a2.var3; }
    };
};
typedef std::set<struct MyStruct, MyStruct::less> MySet; 
```

或将它们放在类定义中

```
bool operator==(const MyStruct& rhs) const 
    { return var1 == rhs.var1 && var2 == rhs.var2 && var3 == rhs.var3; };
bool operator<(const MyStruct& a2) const  
    { if (var1== a2.var1) return var2 < a2.var2; else return var3 < a2.var3; }; 
```

最好的理由是上面的内容很容易理解，它们可以很容易地滑入类定义中，并且如果您以后发现需要更多变量，它们很容易扩展。当有一个更简单的解决方案时，我永远不会尝试重载 std::pair 。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-09T22:50:32.367

不要使用它。

正是出于这个原因，我讨厌 std::pair 。您永远不知道哪个是哪个，并且由于对 first 和 second 的访问是公开的，因此您也无法执行合同。

但毕竟，这是一个品味问题。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-28T10:10:30.980

不幸的是[strong `typedef`s](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2006/n2141.html)不会进入[C++0x](http://www.open-std.org/JTC1/SC22/WG21/docs/papers/2008/n2565.html)，它已被归类为*Not ready for C++0x, but open to resubmit in future*。

# rss - 我可以获得 RSS 阅读量的统计数据吗？

> ID：202344
> 
> 赞同：4
> 
> 时间：2008-10-14T18:49:16.033
> 
> 标签：rss, google-analytics, analytics, google-reader

有什么方法可以获取有多少人正在阅读 RSS 提要的数字？我对提要阅读器的工作方式（例如 Google 阅读器）的理解是，它们会定期检查提要，缓存它，并将缓存的副本提供给任何请求它的人，直到它被刷新——这意味着没有办法获得可靠的数字读者。

### 跟进

有很多使用 FeedBurner 的建议，但他们有办法使用像 Google Reader 这样的基于网络的阅读器来计算单个读者吗？否则，@ifwdev 建议的跟踪像素方法似乎是最好的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-14T18:52:43.313

[Feedburner](http://www.feedburner.com/fb/a/home)提供该信息，您可以将您的提要委托给该服务。我真的不知道它是如何在幕后工作的（正如你所说，应该定期检查提要......）是否可靠。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-14T18:52:04.687

在您的帖子中包含一张图片，看看它获得了多少点击？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-14T18:52:50.457

您当然可以获得 RSS 统计信息。

如果您托管自己的 RSS 提要，则可以解析 IIS 或 Apache 日志以查找提要的所有请求，然后进行一些处理以在每台机器上汇总这些请求。

如果您的提要由任何博客引擎托管，它们通常会提供一些基本统计信息。

您还可以使用[Google 的 FeedBurner](http://www.feedburner.com/fb/a/home)生成一个 RSS 提要，该提要基本上重定向到您的真实提要。FeedBurner 提供了非常好的统计数据，还支持其他有趣的功能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-14T18:54:36.507

Feedburner 工作得相当好。[例如，他们为Perlbuzz](http://perlbuzz.com/)做所有的统计。此外，您还可以获得这些可以放在页面上的小部件（Perlbuzz 上的黄色框显示当前读者的数量）。

您可以自己跟踪日志，但我不介意让 Feedburner 为我做这件事。

# java - 自动 Java 错误报告系统

> ID：202345
> 
> 赞同：8
> 
> 时间：2008-10-14T18:49:27.377
> 
> 标签：java, error-logging

有人知道java中自动错误报告的系统吗？我们有一个安装在客户端服务器上的服务器产品。这个想法是，我们的服务器会将错误的详细信息打电话给我们的一台服务器，然后在我们的错误跟踪器中输入错误。最好，这将通过 http 发生。它不会发生在所有例外情况下，只是更严重的情况和任何未处理的情况。

我试图避免自己滚动。我们将自己捕获异常，但我希望这个系统能够在异常处理程序和错误跟踪器之间尽可能多地处理。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-14T19:16:20.097

不是传统的，但也许你可以使用[Log4J](http://logging.apache.org/log4j/1.2/index.html) appenders 来做到这一点。

SocketAppender允许您将[事件](http://logging.apache.org/log4j/1.2/apidocs/org/apache/log4j/net/SocketAppender.html)发送到远程日志服务器。您还可以使用 SMTPAppender 通过邮件进行通信（有点棘手但易于实现）。我不知道是否有任何其他附加程序通过 HTTP 与服务器通信（如果需要，您甚至可以实现它，我想这很容易）。

让我们看看 stackoverflow 的其他用户是否有更好的主意。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-08-16T15:26:44.503

> 这个想法是，我们的服务器会将错误的详细信息打电话给我们的一台服务器，然后在我们的错误跟踪器中输入错误。

看看[Ctrlflow Automated Error Reporting](https://ctrlflow.com/automated-error-reporting/)，这是一个相当新的错误报告工具。它针对 Java 和 Eclipse/OSGI 进行了优化，并带有[多个客户端](http://blog.ctrlflow.com/integrate-automated-error-reporting-java/)（对于您的服务器产品，Logback 或 Log4J 客户端可能很合适），它们将错误报告发送到中央服务器。

然后，服务器会自动过滤和汇总传入的错误报告。服务器与您的错误跟踪器同步，并可以自动打开新错误。它还提供仪表板和定期发送给开发人员的摘要邮件。

对于小型项目，它是免费的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-14T19:26:44.413

看看[SNMP4J](http://www.snmp4j.org/)。有很多系统管理工具可以汇总 SNMP 信息（请咨询您的系统管理员），[简单网络管理协议](http://en.wikipedia.org/wiki/Simple_Network_Management_Protocol)专为监控而设计。

如果您只需要将错误发送给您，您还可以使用 JavaMail 构建您自己的框架；它并不复杂，样板代码可以放在您的业务逻辑之外。

也许您的错误跟踪系统允许使用 Soap/XML 消息；那么 Axis 将是一个很好的选择，尽管它带有很多依赖项。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-07-23T18:51:20.010

您可以查看[https://github.com/kencochrane/raven-java](https://github.com/kencochrane/raven-java)这可以位于 log4j 上并向 Sentry（请参阅[http://sentry.readthedocs.org/](http://sentry.readthedocs.org/)）实例报告错误。Sentry有很多功能，请看一下。

# html - 无论如何将 html “放入” Silverlight 控件？

> ID：202351
> 
> 赞同：2
> 
> 时间：2008-10-14T18:50:33.893
> 
> 标签：html, silverlight, controls

我知道您可以做一个将 HTML 元素放在 Silverlight 应用程序顶部的技巧，但这不会全屏显示。无论如何要在 Silverlight 应用程序中显示 html 页面吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-18T07:41:23.840

[http://www.componentone.com/SuperProducts/HtmlHostSilverlight/](http://www.componentone.com/SuperProducts/HtmlHostSilverlight/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-14T18:59:11.910

答案是，你不能。至少现在你不能 - 将来可能会添加它，但这肯定不会在几年内发生（今天发布了 2.0 RTW）。

但是，此链接可能会引起一些兴趣：

[http://blogs.msdn.com/delay/archive/2007/09/10/bringing-a-bit-of-html-to-silverlight-htmltextblock-makes-rich-text-display-easy.aspx](http://blogs.msdn.com/delay/archive/2007/09/10/bringing-a-bit-of-html-to-silverlight-htmltextblock-makes-rich-text-display-easy.aspx)

它基本上会解析一些“HTML 文本”并将其显示在文本块中。适用于简单的东西，但可能不像您需要的那么复杂。

# c# - 关于泛型及其接口的最佳资源是什么？

> ID：202366
> 
> 赞同：0
> 
> 时间：2008-10-14T18:53:09.380
> 
> 标签：c#, generics, collections

我找到了许多关于`IEnumerator`、`IEnumerable`、及其通用对应物`ICollection`的文档和建议。`IList`遗憾的是，我还没有找到解释整个接口层次结构、这些接口的通用实现**以及**每种类型的最佳用法的教程或书籍。

关于泛型、它们的接口以及 C# 中的推荐用法示例，您最好的知识来源是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-14T19:19:16.677

我理解它们的主要方式就是查看它们的界面。

继承是这样的：

IList：ICollection：IEnumerable

当您查看 IEnumerable 的接口时，请注意它仅具有能够遍历一堆项目所需的最低限度。它没有计数或其他任何东西。即使您正在查看的只是通过电线传输的流，IEnumerable 也能很好地工作。

ICollection 添加计数。如果您正在实现某种集合，并且很容易知道它的大小，那么您应该实现它。在这种情况下，通用接口有点不同。ICollection<T> 还具有通过添加和删除成员来修改集合的方法。无序集将是 ICollection 的良好候选者。

IList 添加了按索引获取和设置集合成员的功能。当项目的顺序很重要时使用它。当你有索引时，你可以做一些事情，比如交换第 4 和第 5 项来改变它们的顺序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-14T20:23:07.250

你只是错过了一个:)

**IDictionary**：IList：ICollection：IEnumerable

# javascript - 如何在 ASP.NET 文本框中强制输入为大写？

> ID：202368
> 
> 赞同：34
> 
> 时间：2008-10-14T18:54:03.840
> 
> 标签：javascript, asp.net, html, textbox, uppercase

我正在编写一个 ASP.NET 应用程序。我在网络表单上有一个文本框，我想强制用户输入的任何内容为大写。我想在前端做这个。您还应该注意，此文本框上有一个验证控件，因此我想确保该解决方案不会干扰 ASP.NET 验证。

**澄清：** 似乎 CSS 文本转换使用户输入显示为大写。但是，在后台，由于验证控制失败，它仍然是小写字母。你看，我的验证控件检查是否输入了有效的状态代码，但是我使用的正则表达式只适用于大写字符。

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2008-10-14T19:49:03.107

为什么不使用 CSS 和后端的组合呢？利用：

```
style='text-transform:uppercase' 
```

在 TextBox 上，并在您的代码隐藏中使用：

```
Textbox.Value.ToUpper(); 
```

您还可以轻松地将验证器上的正则表达式更改为使用小写和大写字母。这可能是比在它们上强制大写更简单的解决方案。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2008-10-14T18:57:19.667

在文本框上使用 CSS 样式。你的 CSS 应该是这样的：

```
.uppercase
{
    text-transform: uppercase;
}

<asp:TextBox ID="TextBox1" runat="server" Text="" CssClass="uppercase"></asp:TextBox>; 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2011-08-30T21:33:41.297

好的，经过测试，这里有一个更好，更清洁的解决方案。

```
$('#FirstName').bind('keyup', function () {

    // Get the current value of the contents within the text box
    var val = $('#FirstName').val().toUpperCase();

    // Reset the current value to the Upper Case Value
    $('#FirstName').val(val);

}); 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2010-01-11T15:10:54.613

```
**I would do like:
<asp:TextBox ID="txtName" onkeyup="this.value=this.value.toUpperCase()" runat="server"></asp:TextBox>** 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-10-15T03:42:06.537

您可以拦截按键事件，取消小写事件，并将它们的大写版本附加到输入：

```
window.onload = function () {
    var input = document.getElementById("test");

    input.onkeypress = function () {
        // So that things work both on Firefox and Internet Explorer.
        var evt = arguments[0] || event;
        var char = String.fromCharCode(evt.which || evt.keyCode);

        // Is it a lowercase character?
        if (/[a-z]/.test(char)) {
            // Append its uppercase version
            input.value += char.toUpperCase();

            // Cancel the original event
            evt.cancelBubble = true;
            return false;
        }
    }
}; 
```

这适用于 Firefox 和 Internet Explorer。[您可以在这里](http://jsbin.com/avulo/edit)看到它的实际效果。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-08-27T09:08:12.887

```
<!-- Script by hscripts.com -->
<script language=javascript>
    function upper(ustr)
    {
        var str=ustr.value;
        ustr.value=str.toUpperCase();
    }

    function lower(ustr)
    {
        var str=ustr.value;
        ustr.value=str.toLowerCase();
    }
</script>

<form>
    Type Lower-case Letters<textarea name="address" onkeyup="upper(this)"></textarea>
</form>

<form>
    Type Upper-case Letters<textarea name="address" onkeyup="lower(this)"></textarea>
</form> 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2014-06-19T06:28:19.063

我使用一个简单的内联语句

```
<asp:TextBox ID="txtLocatorName" runat="server"
 style="text-transform:uppercase" CssClass="textbox"  
 TabIndex="1">
</asp:TextBox> 
```

如果您不想使用 css 类，您可以使用内联样式语句。（这只是明显地大写）:)

在服务器端使用

```
string UCstring = txtName.Text.ToUpper(); 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2016-06-22T04:07:01.130

**文本转换** `CSS property specifies how to capitalize an element's text. It can be used to make text appear in all-uppercase or all-lowercase`

**类**

WebControl.CssClass 属性

您可以了解更多信息 - [https://developer.mozilla.org/en/docs/Web/CSS/text-transform](https://developer.mozilla.org/en/docs/Web/CSS/text-transform)

[https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.webcontrol.cssclass(v=vs.110).aspx](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.webcontrol.cssclass(v=vs.110).aspx)

* * *

**使用** `Style="text-transform: uppercase;"`或`CssClass="upper"`

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-10-14T19:44:20.727

我今天刚做了类似的事情。这是修改后的版本：

```
<asp:TextBox ID="txtInput" runat="server"></asp:TextBox>
<script type="text/javascript">
    function setFormat() {
        var inp = document.getElementById('ctl00_MainContent_txtInput');
        var x = inp.value;
        inp.value = x.toUpperCase();
    }

    var inp = document.getElementById('ctl00_MainContent_txtInput');
    inp.onblur = function(evt) {
        setFormat();
    };
</script> 
```

基本上，该脚本附加了一个在文本框失去焦点时触发的事件。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-10-14T19:00:19.757

```
 style='text-transform:uppercase' 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2010-12-17T20:49:49.573

我在四个流行的浏览器版本上对这个问题做了一些分析。

1.  样式标签简单以大写显示字符，但控件值仍保持为小写
2.  使用上面显示的字符代码的按键功能有点担心，因为在 Firefox chrome 和 safari 中它禁用了`Ctrl`+`V`进入控件的功能。
3.  将字符级别转换为大写的另一个问题也不是将整个字符串转换为大写。
4.  我找到的答案是结合样式标签在 keyup 上实现这一点。

    ```
    <-- form name="frmTest" -->
    <-- input type="text" size=100 class="ucasetext" name="textBoxUCase" id="textBoxUCase" -->
    <-- /form -->

    window.onload = function() {
        var input = document.frmTest.textBoxUCase;
        input.onkeyup = function() {
            input.value = input.value.toUpperCase();
        }
    }; 
    ```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-08-28T05:33:36.823

我会使用 jQuery 来做到这一点。

```
<script src="Scripts/jquery-1.3.2.js" type="text/javascript"></script>
<script type="text/javascript">
    $(document).ready(function() {
        $("#txt").keydown(function(e) {
            if (e.keyCode >= 65 & e.keyCode <= 90) {
                val1 = $("#txt").val();
                $("#txt").val(val1 + String.fromCharCode(e.keyCode));
                return false;
            }
        });
    });
</script> 
```

`/script`文件夹中必须有 jQuery 库。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-10-14T18:57:19.997

将文本框上的样式设置为[text-transform: uppercase](http://devhints.wordpress.com/2006/11/01/css-make-it-all-uppercaselowercase/) ?

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-10-14T19:03:48.000

CSS 在这里可能会有所帮助。

```
style="text-transform: uppercase";" 
```

这有帮助吗？

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-10-14T19:26:08.393

在前端使用 text-transform CSS，然后在验证之前在字符串服务器端使用 toUpper 方法。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2011-08-30T21:21:34.537

这是一个对我有用的解决方案。

[http://plugins.jquery.com/project/bestupper](http://plugins.jquery.com/project/bestupper)

您必须从[http://plugins.jquery.com/files/jquery.bestupper.min.js.txt](http://plugins.jquery.com/files/jquery.bestupper.min.js.txt)获取 JavaScript，然后就可以了。

奇迹般有效！

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-10-14T18:57:41.960

JavaScript 具有字符串的“toUpperCase()”函数。

所以，沿着这些思路：

```
function makeUpperCase(this)
{
    this.value = this.value.toUpperCase();
} 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2013-03-30T10:58:02.150

```
 <telerik:RadTextBox ID="txtCityName" runat="server" MaxLength="50" Width="200px"
                            Style="text-transform: uppercase;"> 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2010-05-11T23:43:38.370

我意识到这有点晚了，但我找不到一个适用于 ASP.NET AJAX 的好答案，所以我修复了上面的代码：

```
function ToUpper() {
        // So that things work both on FF and IE
        var evt = arguments[0] || event;
        var char = String.fromCharCode(evt.which || evt.keyCode);

        // Is it a lowercase character?
        if (/[a-z]/.test(char)) {
            // convert to uppercase version
            if (evt.which) {
                evt.which = char.toUpperCase().charCodeAt(0);
            }
            else {
                evt.keyCode = char.toUpperCase().charCodeAt(0);
            }
        }

        return true;
    } 
```

像这样使用：

```
 <asp:TextBox ID="txtAddManager" onKeyPress="ToUpper()" runat="server" 
             Width="84px" Font-Names="Courier New"></asp:TextBox> 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2014-09-17T17:06:15.313

```
 $().ready(docReady);

     function docReady() {

            $("#myTextbox").focusout(uCaseMe);
     }

     function uCaseMe() {

            var val = $(this).val().toUpperCase();

            // Reset the current value to the Upper Case Value
            $(this).val(val);
        } 
```

这是一种可重用的方法。任何数量的文本框都可以通过这种方式完成，无需命名。通过更改 docReady 中的选择器可以实现页面范围的解决方案。

我的例子使用了失去焦点，问题没有在他们输入时指定。如果这在您的场景中很重要，您可以触发更改。

* * *

## 回答 #21

> 赞同：-1
> 
> 时间：2022-01-31T21:20:50.473

最少 8 个字符，至少 1 个字母和 1 个数字 <asp:TextBox ID="txtPolicy1" runat="server"></asp:TextBox>
<asp:RegularExpressionValidator ID="Regex1" runat="server" ControlToValidate="txtPolicy1" ValidationExpression="^(?=. *[A-Za-z])(?=.* \d)[A-Za-z\d]{8,}$" ErrorMessage="密码必须包含：最少 8 个字符，至少 1 个字母和 1 个数字" ForeColor="Red" />

有效密码示例：pass1234 或 PaSs1234 或 PASS1234

最少 8 个字符，至少 1 个字母、1 个数字和 1 个特殊字符 <asp:TextBox ID="txtPolicy2" runat="server"></asp:TextBox>
<asp:RegularExpressionValidator ID="Regex2" runat="server" ControlToValidate ="txtPolicy2" ValidationExpression="^(?=. *[A-Za-z])(?=.* \d)(?=. *[$@$!%* #?&])[A-Za-z\d $@$!%*#?&]{8,}$" ErrorMessage="最少 8 个字符，至少 1 个字母、1 个数字和 1 个特殊字符" ForeColor="Red" />

有效密码示例：pass@123 OR PaSS#123 OR PASS@123

最少 8 个字符，至少 1 个大写字母、1 个小写字母和 1 个数字 <asp:TextBox ID="txtPolicy3" runat="server"></asp:TextBox>
<asp:RegularExpressionValidator ID="Regex3" runat="server" ControlToValidate="txtPolicy3" ValidationExpression="^(?=. *[az])(?=.* [AZ])(?=.*\d)[a-zA-Z\d]{8,}$" ErrorMessage= "密码必须包含：至少 8 个字符，至少 1 个大写字母、1 个小写字母和 1 个数字" ForeColor="Red" />

有效密码示例：PaSs1234 或 pass1234

最少 8 个字符，至少 1 个大写字母、1 个小写字母、1 个数字和 1 个特殊字符

<asp:TextBox ID="txtPolicy4" runat="server"></asp:TextBox>
<asp:RegularExpressionValidator ID="Regex4" runat="server" ControlToValidate="txtPolicy4" ValidationExpression="^(?=. *[az ])(?=.* [AZ])(?=. *\d)(?=.* [$@$!% *?&])[A-Za-z\d$@$!%* ?&]{8, }" ErrorMessage="密码必须包含：最少 8 个字符，至少 1 个大写字母、1 个小写字母、1 个数字和 1 个特殊字符" ForeColor="Red" />

有效密码示例：PaSs@123 或 pAss@123

最少 8 个和最多 10 个字符，至少 1 个大写字母、1 个小写字母、1 个数字和 1 个特殊字符

<asp:TextBox ID="txtPolicy5" runat="server"></asp:TextBox>
<asp:RegularExpressionValidator ID="Regex5" runat="server" ControlToValidate="txtPolicy5" ValidationExpression="^(?=. *[az ])(?=.* [AZ])(?=. *\d)(?=.* [$@$!% *?&])[A-Za-z\d$@$!%* ?&]{8, 10}" ErrorMessage="密码必须包含：最少 8 个和最多 10 个字符，至少 1 个大写字母、1 个小写字母、1 个数字和 1 个特殊字符" ForeColor="Red" />

有效密码示例：PaSs@123

# php - 如何在相同的 apache 安装中同时使用 PHP 4 和 5？

> ID：202378
> 
> 赞同：0
> 
> 时间：2008-10-14T18:55:43.277
> 
> 标签：php, apache, cpanel, php4, whm

我正在尝试使此功能可用，可能在 apache .htaccess 文件中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T20:56:13.137

我使用虚拟服务器配置在我的 PC 上设置了几个使用 PHP5 和一些使用 PHP4 的文件夹来测试代码。我还为它们设置了不同的主机名（也在 Windows 主机文件中）。（我再也无法使用那台机器了，但这是我记得的。）

只需包括以下之一（对于 linux）

```
AddHandler php4 .php
Action php4 /cgi-bin/php4 
```

或者

```
AddHandler php5 .php
Action php5 /cgi-bin/php5 
```

在虚拟服务器配置中。

如果您想将它们用于同一（虚拟）服务器，则必须将其中一个文件扩展名重命名为 .php5、.php4 或类似名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-14T18:56:43.787

我的理解是 PHP 4 中的所有内容都在 PHP 5 中，所以如果您安装 PHP 5 并对其进行配置，您将能够使用 4 和 5 中的所有功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-14T18:58:34.533

只需使用 CGI 二进制文件。或者用 X 特性重新编译 PHP5。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-14T21:28:12.327

我的网络主机 (1&1) 这样做；要使用 php5，我必须使用 .php5 扩展名或添加 .htaccess 命令才能将 php5 用于我的 .php 文件。

我认为这只是将 php4 和 php5 安装到单独的目录并告诉 apache 用 php4 解释 .php 文件和用 php5 解释 .php5 文件的问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-16T01:08:58.543

如果您在服务器上使用控制面板应用程序，例如 cPanel，它可能已经为您处理了这个问题。

如果您在裸服务器上，只需使用一种方法（例如 DSO）运行 PHP 5，并使用另一种方法（例如 SuPHP）运行 PHP 4。然后，您可以使用 .htaccess 文件来确定要使用哪个版本的 PHP，或者只为 PHP 5 提供 .php 文件，为 PHP 4 文件提供 .php4 文件。

但是，PHP 4 和 PHP 5 之间有很大的重叠。我能想到的可能遇到的唯一主要区别是 XML 处理。

# c# - 如何从一个 Visual C# 项目构建两个不同的应用程序？

> ID：202379
> 
> 赞同：2
> 
> 时间：2008-10-14T18:56:02.447
> 
> 标签：c#, windows, visual-studio, build-process, build-automation

我有一个源代码库，它根据构建时定义的标志创建两个不同的应用程序。我可以使用 Makefile 来构建这两个应用程序，方法是指定两个不同的目标，一个使用标志编译，一个不使用标志编译，并且有一个可以构建两者的聚合目标。

如何在 Windows 上执行与 Visual C# Express 相同的操作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-14T19:02:21.890

使用同一文件夹中的两个项目文件创建一个解决方案。在您的解决方案中设置两种不同的配置，其中一种构建其中一个项目，另一种构建另一个项目。

或者，您可以拥有一个始终构建为中间二进制文件的项目，然后有一个构建后步骤，根据标志将其复制到最终二进制文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-14T19:03:03.277

发布与调试？您也可以创建自己的自定义配置。但是基于配置构建一个完全不同的应用程序似乎是个坏主意。

普通的视觉工作室可以在一个解决方案中拥有多个项目，我认为有一种方法可以将它硬塞到 Express 版中（也许通过打开在其他地方创建的解决方案）。

但实际上，您可能不得不满足于一次打开两个 Visual Studio 实例。如果需要，您始终可以将其中一个设置为直接构建到另一个项目的 /bin/Release/ 文件夹中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-14T20:54:51.723

我不完全了解 Express 版本，但在 Visual Studio 中有一个菜单项`Build->Batch Build`可以一次构建所有配置。

* * *

当我有复杂的构建输出场景时，我发现 Visual Studio 不容易使用。在这些情况下，我通常做的是将[NAnt](http://nant.sourceforge.net/)与像[CruiseControl.Net](http://cruisecontrol.sourceforge.net/)这样的持续集成工具一起使用。您还可以使用相同的 NAnt 脚本在本地构建项目输出。

NAnt 脚本本质上是一个具有更多功能的 Xml 构建文件。

# .net - 在生产 .NET 桌面程序中诊断应用程序挂起

> ID：202384
> 
> 赞同：5
> 
> 时间：2008-10-14T18:56:40.403
> 
> 标签：.net, freeze, production, diagnostics

我有麻烦了。我正在开发的应用程序的用户之一偶尔但经常遇到应用程序挂起。

发生这种情况时，我们会在机器的事件日志中找到一个来源为“应用程序挂起”的条目，其中包含信息性消息“挂起应用程序 [我的应用程序]，版本 [正确版本]，挂起模块挂起应用程序，版本 0.0.0.0，挂起地址 0x00000000。”

我正在记录我的应用程序抛出的所有未处理的异常，发生这种情况时我的日志文件中没有任何条目。

我目前的工作假设是，在应用程序调用不安全的遗留 API 期间会发生这种挂起。这不会让我感到惊讶；我使用这个 API 已经很多年了，虽然我以前没见过它挂起，但它确实是很糟糕的代码。此外，用户报告该程序似乎随机挂起。我不认为这是真的。并不是我不相信她，而是与遗留 API 对话的代码在 BackgroundWorker 调用的方法中运行。如果后台线程使应用程序挂起，这在用户看来很可能是随机发生的。

所以，我有两个问题，一个具体的，一个一般的。

具体问题：我希望如果在非 UI 线程上运行的方法挂起，它只会杀死线程。它真的会杀死整个应用程序吗？

一般问题：

我已经记录了所有未处理的异常。我的程序已经设置为使用跟踪（尽管我需要添加检测代码来跟踪可疑方法中的活动）。还有其他我应该做的事情吗？当 .NET 应用程序挂起时，是否有允许进行某种崩溃后分析的诊断工具？.NET 框架中是否有我可以调用的机制来捕获更多（和更有用的）数据？

**编辑：** 仔细检查我的代码，我记得它对 BackgroundWorker 的所有使用都是通过我实现的实用程序类来包装异常处理程序中调用的方法。此处理程序记录异常，然后将其作为实用程序对象的属性返回。UI 线程中的完成事件处理程序重新抛出异常（不太理想，因为我丢失了调用堆栈，但它已经被记录了），导致 UI 的主要异常处理程序将异常报告给消息框，然后终止应用程序。

由于这些都没有发生，我非常有信心在后台线程中没有抛出异常。好吧，无论如何，没有 .NET 例外。

**进一步跟进：**

幸运的是，我现在已经从用户那里获得了足够的数据，可以确定遗留 API 中没有发生挂起。这意味着这显然是我做错了，这意味着我可以修复它，所以，赢了。这也意味着我可以通过跟踪来隔离问题，这是另一个胜利。我对这个问题的答案感到非常高兴；我什至更高兴我可能不需要它们来解决这个问题。

另外：PostSharp 非常出色。如果您需要向现有应用程序添加检测代码，您几乎可以肯定应该使用它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-14T19:07:49.897

在回答您的具体问题时，当后台/工作线程阻塞或挂起时，对应用程序其余部分的影响在很大程度上取决于应用程序中线程之间发生的同步。没有特别的理由表明它一定会挂起整个应用程序，但它完全有可能会挂起。

诊断此问题的一种可能方法是在进程挂起时生成进程转储（假设有人在附近注意到它何时发生）。这将使用来自 dbghelp.dll 的[MiniDumpWriteDump来完成。](http://msdn.microsoft.com/en-us/library/ms680360.aspx)编写一个可以转储进程（基于其 pid）的简单工具相当简单，该工具可以提供给遇到问题的客户。由于这是一个托管应用程序，因此最好使用完整的内存转储 (MiniDumpWithFullMemory)，但普通转储仍应包含一些有用的信息。获得转储后，您可以使用 windbg 或您选择的事后调试器来查看可能发生的情况。

如果你走这条路，[这篇 msdn 文章](http://msdn.microsoft.com/msdnmag/issues/03/06/Bugslayer/)是托管转储调试的一个很好的起点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-14T19:08:39.693

我建议围绕您认为是问题根源的呼叫添加更详细的日志记录。

如果您使用的是 Vista，您可以使用新的 Vista API 在您的应用程序崩溃时让 Windows 调用您的代码。当您看到诸如 Office/IE 之类的 MS 产品说它们“正在尝试恢复您的数据”时，就会发生这种情况。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-14T19:07:47.383

想法 1）步入 .net 框架代码（来自我工作的 KB）：

如果你已经安装了 VS2008 SP1，你需要做的就是去工具 -> 选项 -> 调试

1.  取消选中仅启用我的代码
2.  选中启用 .NET Framework 源步进
3.  检查启用源服务器支持
4.  在 Debugging -> Symbols 下，添加[http://referencesource.microsoft.com/symbols的新位置](http://referencesource.microsoft.com/symbols)

现在，当调试调用堆栈中的框架代码变灰时，只需右键单击调用行并选择加载符号。

想法2）设置远程调试[http://msdn.microsoft.com/en-us/library/y7f5zaaa.aspx](http://msdn.microsoft.com/en-us/library/y7f5zaaa.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-14T19:10:05.353

如果您控制的线程上有未处理的执行，[它将关闭您的整个应用程序](http://msdn.microsoft.com/en-us/library/ms228965.aspx)。一旦线程死亡，就没有办法“处理”这个问题。您可能想了解如何将[APM 与代表一起](http://msdn.microsoft.com/en-us/library/ms228969.aspx)使用。这为其他线程上抛出的异常提供了一层保护，因为当您调用 EndInvoke() 时会捕获并提出异常。

至于你还能做什么，我[赞同查理的](https://stackoverflow.com/questions/202384/diagnosing-application-hang-in-a-production-net-desktop-program#202424)回答。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-14T21:27:39.723

我建议附加 WinDbg（是的，其中一个核心的东西）并使用 SOS（罢工之子）和 SOSEx 来分析死锁（！dlk）或手动检查同步块（！syncblk）以找到相互等待的锁。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-14T19:14:07.310

如果可能，将后台工作线程替换为[SafeThread](http://www.codeproject.com/KB/threads/SafeThread.aspx)并查看是否捕获了可疑异常。如果不是，则抛出的异常不是 CLR 异常，您可能无法从“纯”.NET 代码中处理它[尽管 C++ 中的 SEH 可能有效]

编辑：好的，不是这样。也许[这个](http://www.eventid.net/display.asp?eventid=1002&eventno=1522&source=Application%20Hang&phase=1)或[这个](http://www.tech-archive.net/Archive/Windows/microsoft.public.windows.terminal_services/2006-01/msg00743.html)可能会有所帮助。祝你好运！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-14T20:28:32.743

罗伯特，如果所有这些解决方案都失败了，并且您仍然认为遗留 API 是罪魁祸首，那么答案可能是将遗留 API 沙箱化到它自己的 AppDomain 或进程中。

.NET 3.5 框架使用 System.AddIn API 使这很容易做到。

# windows - 在 cygwin 下的 Windows 应用程序中有时无法识别输入键

> ID：202405
> 
> 赞同：9
> 
> 时间：2008-10-14T19:02:35.367
> 
> 标签：windows, cygwin

在工作中，我经常使用 Cygwin，因为它在广阔的 Windows 沙漠中为我提供了一片小绿洲。我不可避免地最终会通过 bash shell 运行一些非 Cygwin 程序，例如构建脚本（内部创建的批处理文件）和 Subversion CLI 二进制文件（我安装了 Windows 程序）。99% 的时间，我使用这个设置没有任何问题。然而，另外 1% 会导致一个奇怪的问题：

使用构建脚本和 SVN，大多数时候回车键被正确解释。例如，我将启动数据库创建脚本，它会提示我输入服务器名称。我输入“localhost”并回车。一切安好。然后它会结束，如果有错误，并使用`more`. 我按下的任何键都不被 识别`more`。我必须 Ctrl-C 退出它。

同样，如果我进行 Subversion 更新，通常一切都很好。但是，在发生交互式冲突解决的情况下，我通常会为“theirs-full”输入“tf”，然后按回车，但没有任何反应。我必须退出它并使用强制合并重新运行更新或在 Windows 中使用 TortoiseSVN 来执行此操作。

知道为什么 Cygwin 似乎随机不将回车键传递给程序吗？我认为这可能与 Unix 与 Windows 样式的行尾有关，所以我尝试手动输入这些字符，但这似乎没有什么区别。谢谢。

**编辑**：我刚刚再次发生这种情况，我意识到了一些事情。是 SVN 提示我输入密码。我输入了密码，它在屏幕上回显（错误），然后按回车...什么也没有。再按几次，光标移动，但没有任何反应。我按了 Ctrl-C，它把我转回 bash，然后它说“bash：[我的密码]：找不到命令”，然后是一些新的提示，等于我按 Enter 键的次数。所以发生的事情是输入从未进入 SVN，但在 SVN 退出后以某种方式被 bash 读取。我认为这可能会帮助某人弄清楚发生了什么。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-02T17:41:30.580

不幸的是，我认为您遇到了 Cygwin 和 windows/dos 控制台应用程序的问题之一。[请参阅http://www.cygwin.com/cygwin-ug-net/using-effectively.html](http://www.cygwin.com/cygwin-ug-net/using-effectively.html)上的“控制台程序” 。

这只是对 Windows 控制台应用程序的限制。例如，这种行为对于 windows myqsl cmd 客户端和 svn 客户端很常见。

这里有一些需要注意的事情——我已经成功地在 Windows mysql 和 Windows svn 客户端上使用了这种方法：

1）尝试确保您的 CYGWIN 环境变量中没有“tty”，看看是否有帮助（在我的电脑->属性->高级->环境变量中取消设置并关闭/重新启动任何 cygwin bash 提示）。

2) 不要使用 RXVT——而是使用基本的 Cygwin cmd 提示符。这是因为 RXVT 意味着“tty”并且会破坏上面的#1。

3) 尝试为您遇到问题的 cmds 找到“本机”Cygwin 包，而不是使用 Windows cmds。（不过，我还没有为 cygwin 找到 1.6 svn 客户端。）

祝你好运！达斯汀

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-15T07:13:40.720

关于 mintty 项目的冗长讨论在这里 - [http://code.google.com/p/mintty/issues/detail?id=56](http://code.google.com/p/mintty/issues/detail?id=56)

在我的案例中提到的一种解决方案（输入本地颠覆的身份验证密码）是**conin** - [http://code.google.com/p/mintty/downloads/detail?name=conin-0.0.2.zip&can=1&q=label %3AD发展](http://code.google.com/p/mintty/downloads/detail?name=conin-0.0.2.zip&can=1&q=label%3ADevelopment)

```
$ conin svn list https://{repo}
Password for 'user': ****** 
```

# regex - 调用字符串“a?c”的正则表达式无效？

> ID：202406
> 
> 赞同：4
> 
> 时间：2008-10-14T19:03:01.700
> 
> 标签：regex, validation

在我的用户模型中，我有一个名为“昵称”的属性，并进行如下验证：

> validates_format_of :nickname, :with => /[a-zA-Z0-9]$/, :allow_nil => true

但是，它目前让这个字符串作为有效传递：

a?c

我只想接受字母数字字符串 - 有谁知道我的正则表达式为什么失败？如果有人可以提出更好的正则表达式，我会全力以赴。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-14T19:04:42.867

如果字符串以有效字符结尾，那将匹配 true。中间没有任何验证。试试这个：

```
^[a-zA-Z0-9]*$ 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-14T19:04:29.887

您需要在两侧锚定图案：

```
/^[a-zA-Z0-9]+$/ 
```

# sql-server - Sql Server SHRINKDATABASE 命令

> ID：202417
> 
> 赞同：1
> 
> 时间：2008-10-14T19:06:17.810
> 
> 标签：sql-server, sql-server-2000, database-administration

当我使用 GUI 收缩 sql server 数据库时（所有任务->收缩数据库->接受所有默认值，单击确定），它很快完成。

但是如果我运行这个命令，它会花费很长时间。

```
DBCC SHRINKDATABASE('my_database') 
```

我错过了什么？

这是在 SQL Server 2000 中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-14T19:08:22.080

如果我没记错的话，界面会留下大约 20% 的增长空间，在没有任何参数的情况下运行 DBCC SHRINKDATABASE 会将其缩小到尽可能小。

我没有方便的企业管理器来检查默认值。但是您应该注意到手动运行的数据库文件比 GUI 运行的数据库文件小，因此时间差

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-10-18T09:31:42.353

可以在此处找到有关 DBCC SHRINKDATABASE 的详细信息：http: [//msdn.microsoft.com/en-us/library/ms190488.aspx](http://msdn.microsoft.com/en-us/library/ms190488.aspx)。请注意，这是针对 SQL Server 2005 ->

# asp.net-mvc - Mono 上的 ASP.NET MVC 预览版 5

> ID：202430
> 
> 赞同：10
> 
> 时间：2008-10-14T19:08:37.757
> 
> 标签：asp.net-mvc, mono

有没有人有任何关于让当前版本的 ASP.NET MVC (Preview 5) 在 Mono 2.0 上工作的信息？有关于旧版本的信息（预览 2，也许是预览 3），但我没有看到有关使预览 5 实际工作的详细信息。

[Mono 项目路线图](http://www.mono-project.com/Roadmap)表明ASP.NET 3.5 用于 Mono 2.4（明年）。在此之前如何获得这个有用的任何想法？

更多细节：基本的 MVC Preview 5 模板似乎可以工作，只要我避开根目录。如果我请求根，我得到：

```
Server Error in '/' Application
The virtual path '' maps to another application.

Description: HTTP 500\. Error processing request.

Stack Trace:

System.Web.HttpException: The virtual path '' maps to another application.
  at System.Web.HttpContext.RewritePath (System.String filePath, System.String pathInfo, System.String queryString, Boolean setClientFilePath) [0x00000] 
  at System.Web.HttpContext.RewritePath (System.String path, Boolean rebaseClientPath) [0x00000] 
  at System.Web.HttpContext.RewritePath (System.String path) [0x00000] 
  at MvcApplication1._Default.Page_Load (System.Object sender, System.EventArgs e) [0x00000] 
  at System.Web.UI.Control.OnLoad (System.EventArgs e) [0x00000] 
  at System.Web.UI.Control.LoadRecursive () [0x00000] 
  at System.Web.UI.Page.ProcessLoad () [0x00000] 
  at System.Web.UI.Page.ProcessPostData () [0x00000] 
  at System.Web.UI.Page.InternalProcessRequest () [0x00000] 
  at System.Web.UI.Page.ProcessRequest (System.Web.HttpContext context) [0x00000] 

Version information: Mono Version: 2.0.50727.42; ASP.NET Version: 2.0.50727.42 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-14T19:58:26.113

一个可能是 RewritePath to / 有某种错误，所以避免这种情况。将 RewritePath(Request.ApplicationPath) 更改为：

```
HttpContext.Current.RewritePath("/Home/Index"); 
```

似乎解决了这个问题，至少到目前为止演示工作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-23T12:44:46.527

Asp.Net MVC 1.0 将与 mono 的 2.4 分支一起使用，但您仍需要在 default.aspx.cs 的页面加载中修复 RewritePath

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-14T19:59:25.940

您使用的是来自 svn 的 Mono 还是稳定版？您使用的是哪种网络服务器？什么样的操作系统？您的网络服务器中有重写规则吗？

我可以使用 default.aspx.cs 的 page_load 方法在 Linux 中运行预览 4

```
HttpContext.Current.RewritePath(Request.ApplicationPath);
 ((IHttpHandler)new MvcHttpHandler()).ProcessRequest(HttpContext.Current); 
```

我有时也需要在 Windows 中使用它。我还没有在 Linux 中测试版本 5，所以它可能无法正常工作。

# logging - 如何最好地捕获和记录 scp 输出？

> ID：202432
> 
> 赞同：21
> 
> 时间：2008-10-14T19:08:52.173
> 
> 标签：logging, shell, scp

我正在尝试从安装脚本（使用 scp）捕获输出并记录它。但是，我没有得到 scp 打印的所有内容，即进度条。

屏幕输出：

> 将 /user2/cdb/builds/tmp/uat/myfiles/* 复制到服务器 /users/myfiles 作为 cdb
> 
> cdb@server 的密码：myfile 100% |**********************************| 2503 00:00

日志输出：

> 将 /user2/cdb/builds/tmp/uat/myfiles/* 复制到服务器 /users/myfiles 作为 cdb

我真的很想知道我的文件到了那里。这是我现在尝试的无济于事：

> myscript.sh 2>&1 | 三通 mylogfile.log

有没有人有一个很好的方法来捕获 scp 输出并记录它？

谢谢。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-10-17T00:21:38.713

scp 使用控制代码将其进度条打印到终端。它将检测您是否重定向输出并因此省略进度条。

您可以通过使用默认安装在大多数发行版上的“脚本”命令诱使 scp 认为它在终端中运行来解决这个问题：

```
script -q -c "scp server:/file /tmp/" > /tmp/test.txt 
```

test.txt 的内容将是：

```
file    0%    0     0.0KB/s   --:-- ETA
file   18%   11MB  11.2MB/s   00:04 ETA
file   36%   22MB  11.2MB/s   00:03 ETA
file   54%   34MB  11.2MB/s   00:02 ETA
file   73%   45MB  11.2MB/s   00:01 ETA
file   91%   56MB  11.2MB/s   00:00 ETA
file  100%   61MB  10.2MB/s   00:06 
```

...这可能是你想要的。

我在将交互式脚本的输出重定向到日志文件时偶然发现了这个问题。在日志中没有结果不是问题，因为您始终可以评估退出代码。但我真的希望交互式用户看到进度条。这个答案解决了这两个问题。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-14T19:21:37.187

看起来您只是错过了日志中的 scp 是否成功。

我猜滚动条不会打印到标准输出并使用 ncurses 或其他类型的 TUI？

你可以看看 scp 的返回值，看看它是否成功。像

```
scp myfile user@host.com:. && echo success! 
```

`man scp`说

```
scp exits with 0 on success or >0 if an error occurred. 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-12-07T15:00:07.857

这里没有一个答案对我有用，我需要在很长的地理距离上递归地复制包含大量文件的大目录，所以我想记录**进度**（`&& echo success!`到目前为止还不够）。

我最终设计并以某种方式工作的是：

```
scp -vrC root@host:/path/to/directory . 2> copy.log & 
```

使用`-v`详细日志记录的技巧（`-C`允许压缩和`-r`递归）。

整理日志文件

```
grep file copy.log | wc -l 
```

让我看到到目前为止复制的文件数量。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-14T19:20:51.180

也许您可以使用“[脚本](http://ayaz.wordpress.com/2006/11/19/script1-logging-terminal-sessions-to-files/)”来记录终端会话。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-07-03T06:46:15.827

```
scp myfile user@host.com:. && echo success! 
```

非常有帮助，但是要将消息写入日志文件，我将其更改为这样

```
scp myfile user@host.com:. && echo myfile successfully copied! >> logfile 2>&1 
```

这将写入“我的文件已成功复制！” 消息到日志文件。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-02-06T00:18:11.100

我还不能评论:(所以我会在这里添加更新...

@Martin 为我提供了最好的解决方案，尽管如果您的 scp 命令位于脚本的中间，那么它的输出*可能会*出现在之后实际运行的命令之后。

我认为这是因为脚本必须在子外壳中运行命令，但我还没有测试。

编辑：它确实产生了一个外壳，所以如果你需要以顺序方式运行（并且确实失败）（比如在构建脚本中），那么你必须围绕脚本命令的使用添加一些逻辑。

IE

脚本 -q -c "你的命令" && sleep 1

或类似的东西，以便您的父外壳在继续之前等待子外壳完成。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-08-12T03:06:36.680

是的，我最近试图从 proc_open() 的 php 脚本中获取输出我失去了一段时间试图获取输出的安静时间:-) 但是这里有点晚了，然后我在这里阅读这篇文章让我意识到我真的不需要这个垃圾输出到我的脚本

只需退出代码即可完成工作:-)

$exit_code = proc_close($process);

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-05-31T12:31:38.567

```
$ grep -r "Error" xyz.out > abc.txt 
```

在上面的命令中，我将输出存储到文件 abc.txt 中。

此命令用于在文件*xyz.out*`grep`中搜索包含*错误*的文本并将输出存储在*abc.txt*中而不显示在控制台上。

 *** * *

## 回答 #9

> 赞同：-1
> 
> 时间：2014-10-28T16:42:03.770

尝试：

```
scp server:/file /tmp/ > /dev/tty 
```

# .net - 从 WPF RichTextBox 获取 FontWeight/FontStyle/TextDecorations

> ID：202434
> 
> 赞同：4
> 
> 时间：2008-10-14T19:09:00.503
> 
> 标签：.net, wpf

如何检测 WPF RichTextBox 中光标位置的当前文本格式？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2010-08-10T21:24:09.877

该线程的作者还询问了您未提供示例代码的 TextDecorations 及其使用方式的不同之处。我将此作为**进一步的解决方案**发布：

```
var obj = _myText.GetPropertyValue(Inline.TextDecorationsProperty);

                    if (obj == DependencyProperty.UnsetValue)                   
                        IsTextUnderline = false;// mixed formatting 

                    if (obj is TextDecorationCollection)
                    {
                        var objProper = obj as TextDecorationCollection;

                        if (objProper.Count > 0)                        
                            IsTextUnderline = true; // all underlined                       
                        else                        
                            IsTextUnderline = false; // nothing underlined                   
                    } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-15T01:45:27.223

我会使用 CaretPosition 而不是选择开始和结束，就好像 RichTextBox 实际上有一个跨越多个格式区域的选择，你会得到 DependencyProperty.UnsetValue。

```
TextRange tr = new TextRange(rtb.CaretPosition, rtb.CaretPosition);
对象oFont = tr.GetPropertyValue(Run.FontFamilyProperty);

```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-09-09T04:02:40.267

这是一个确定 FontWeight、FontStyle、TextDecorations（删除线、下划线）以及 Super- 和 Subscripts 的解决方案。

```
 TextRange textRange = new TextRange(rtb.Selection.Start, rtb.Selection.End);

        bool IsTextUnderline = false;
        bool IsTextStrikethrough = false;
        bool IsTextBold = false;
        bool IsTextItalic = false;
        bool IsSuperscript = false;
        bool IsSubscript = false;

        // determine underline property
        if (textRange.GetPropertyValue(Inline.TextDecorationsProperty).Equals(TextDecorations.Strikethrough))
            IsTextStrikethrough = true; // all underlined   
        else if (textRange.GetPropertyValue(Inline.TextDecorationsProperty).Equals(TextDecorations.Underline))
            IsTextUnderline = true; // all strikethrough

        // determine bold property
        if (textRange.GetPropertyValue(Inline.FontWeightProperty).Equals(FontWeights.Bold))
            IsTextBold = true; // all bold

        // determine if superscript or subscript
        if (textRange.GetPropertyValue(Inline.BaselineAlignmentProperty).Equals(BaselineAlignment.Subscript))
            IsSubscript = true; // all subscript
        else if (textRange.GetPropertyValue(Inline.BaselineAlignmentProperty).Equals(BaselineAlignment.Superscript))
            IsSuperscript = true; // all superscript 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-14T20:48:04.390

试试下面的代码，其中 rtb 是 RichTextBox：

```
TextRange tr = new TextRange(rtb.Selection.Start, rtb.Selection.End);
object oFont = tr.GetPropertyValue(Run.FontFamilyProperty); 
```

# unit-testing - 您的测试中的最佳实践是什么？

> ID：202437
> 
> 赞同：-1
> 
> 时间：2008-10-14T19:10:18.143
> 
> 标签：unit-testing, testing

我想知道当你测试你的课程时你的做法是什么。

例如，我喜欢在我的灯具中使用继承。给定两个类 BaseClass、SubClass，我创建了另外两个类 BaseClassFixture 和 SubClassFixture（SubClassFixture 是 BaseClassFixture 的子类）。所以我确信我不会破坏使用 SubClass 作为 BaseClass 的代码（并且扩展我的类的人可以通过创建我的夹具的另一个子类来确定他们是否做对了）。

我也使用接口进行夹具继承。例如，当我为 IList 创建一个夹具时，我检查任何 Add，Count 是否加一。当我有一个实现 IList 的具体类时，我只需创建一个名为 MyConcreteClassIListFixture 的夹具。

在这种情况下，我的接口的夹具是抽象的，我让我的子类为我的测试创建实例。

我认为这是一种合同设计（参见 Bertrand Meyer），因为我在任何测试之前和之后检查不变量。

我特别是使用已发布的接口或类来执行此操作。

而你......你的做法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-14T19:15:07.293

我最重要的规则是每个测试都应该是原子的，并且不应该以特定的顺序运行。

对于单元测试，它们应该严格遵守关注点分离。对于集成测试，我会特别注意确保它们遵循最重要的规则。

此外，测试应与代码一起尽可能遵循 DRY 规则。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-14T19:23:34.280

编写单元测试时有几件重要的事情。

1）单元测试应该是独立的：

单元测试必须是独立的。这意味着你的单元测试不应该依赖于外部的东西来运行。这包括互联网连接、外部网络服务等。

2）单元测试应该很快：

单元测试应该运行得很快。您可以通过多种方式编写单元测试。其中一些包括数据访问，即使您不需要访问数据来运行测试。您始终可以使用模拟对象并模拟数据访问层。

3）良好的命名约定：

单元测试应该具有良好的命名约定，并且应该像故事一样阅读。

这是一个例子：

公共类 when_user_transfer_money_from_source_account_to_destination_account

公共无效make_sure_error_is_throw_when_source_account_has_insufficient_funds（）{

}

这是一个很好的截屏视频，涵盖了上述许多要点：

[http://screencastaday.com/ScreenCasts/32_Introduction_to_Mocking.aspx](http://screencastaday.com/ScreenCasts/32_Introduction_to_Mocking.aspx)

# c# - 将全文搜索与 SQL Server 结合起来有多难？

> ID：202440
> 
> 赞同：13
> 
> 时间：2008-10-14T19:11:39.187
> 
> 标签：c#, asp.net, sql, .net-3.5, full-text-search

我正在构建一个带有 SQL 后端的 C#/ASP.NET 应用程序。我在截止日期前完成我的页面，在左侧字段之外，我的一位设计师在我的一个页面上合并了全文搜索。到目前为止，我的“搜索”一直是过滤器，能够通过某些因素和列值缩小结果集。

由于我在截止日期前（你知道每晚睡 3 个小时，在我看起来像猫吃东西并呕吐的地方），我期待这个页面与其他页面非常相似，我正在尝试决定是否制造臭味。我以前从未在页面上进行过全文搜索......这是一座要爬的山还是有一个简单的解决方案？

谢谢你。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-10-14T19:20:27.610

首先，您需要在生产服务器上启用全文搜索索引，因此如果这不在范围内，您将不会想要这样做。

但是，如果已经准备好了，全文搜索就相对简单了。

T-SQL 有 4 个谓词用于全文搜索：

*   自由文本
*   自由文本
*   包含
*   包含稳定的

FREETEXT 是最简单的，可以这样做：

```
SELECT UserName
FROM Tbl_Users
WHERE FREETEXT (UserName, 'bob' )

Results:

JimBob
Little Bobby Tables 
```

FREETEXTTABLE 与 FreeTEXT 的工作方式相同，不同之处在于它以表格形式返回结果。

T-SQL 全文搜索的真正威力来自于 CONTAINS（和 CONTAINSTABLE）谓词……这个很大，所以我将它的用法粘贴到：

```
CONTAINS
    ( { column | * } , '< contains_search_condition >' 
    ) 

< contains_search_condition > ::= 
        { < simple_term > 
        | < prefix_term > 
        | < generation_term > 
        | < proximity_term > 
        | < weighted_term > 
        } 
        | { ( < contains_search_condition > ) 
        { AND | AND NOT | OR } < contains_search_condition > [ ...n ] 
        } 

< simple_term > ::= 
    word | " phrase "

< prefix term > ::= 
    { "word * " | "phrase * " }

< generation_term > ::= 
    FORMSOF ( INFLECTIONAL , < simple_term > [ ,...n ] ) 

< proximity_term > ::= 
    { < simple_term > | < prefix_term > } 
    { { NEAR | ~ } { < simple_term > | < prefix_term > } } [ ...n ] 

< weighted_term > ::= 
    ISABOUT 
        ( { { 
                < simple_term > 
                | < prefix_term > 
                | < generation_term > 
                | < proximity_term > 
                } 
            [ WEIGHT ( weight_value ) ] 
            } [ ,...n ] 
        ) 
```

这意味着您可以编写查询，例如：

```
SELECT UserName
FROM Tbl_Users
WHERE CONTAINS(UserName, '"little*" NEAR tables')

Results:

Little Bobby Tables 
```

祝你好运 ：）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-14T19:18:14.323

SQL Server 中的全文搜索非常简单，只需在查询端进行一些配置和微调，就可以开始了！我已经在不到 20 分钟的时间内为客户完成了，熟悉流程

这是[2008 年 MSDN 文章](http://msdn.microsoft.com/en-us/library/ms142571.aspx)，链接从那里转到 2005 年版本

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-14T19:25:18.083

我之前使用过 dtSearch 向文件和数据库添加全文搜索，它们的东西非常便宜且易于使用。

除了添加所有内容并配置 SQL，此脚本将搜索数据库中的所有列，并告诉您哪些列包含您要查找的值。我知道这不是“正确”的解决方案，但可能会为您争取一些时间。

```
/*This script will find any text value in the database*/
/*Output will be directed to the Messages window. Don't forget to look there!!!*/

SET NOCOUNT ON
DECLARE @valuetosearchfor varchar(128), @objectOwner varchar(64)
SET @valuetosearchfor = '%staff%' --should be formatted as a like search 
SET @objectOwner = 'dbo'

DECLARE @potentialcolumns TABLE (id int IDENTITY, sql varchar(4000))

INSERT INTO @potentialcolumns (sql)
SELECT 
    ('if exists (select 1 from [' +
    [tabs].[table_schema] + '].[' +
    [tabs].[table_name] + 
    '] (NOLOCK) where [' + 
    [cols].[column_name] + 
    '] like ''' + @valuetosearchfor + ''' ) print ''SELECT * FROM [' +
    [tabs].[table_schema] + '].[' +
    [tabs].[table_name] + 
    '] (NOLOCK) WHERE [' + 
    [cols].[column_name] + 
    '] LIKE ''''' + @valuetosearchfor + '''''' +
    '''') as 'sql'
FROM information_schema.columns cols
    INNER JOIN information_schema.tables tabs
        ON cols.TABLE_CATALOG = tabs.TABLE_CATALOG
            AND cols.TABLE_SCHEMA = tabs.TABLE_SCHEMA
            AND cols.TABLE_NAME = tabs.TABLE_NAME
WHERE cols.data_type IN ('char', 'varchar', 'nvchar', 'nvarchar','text','ntext')
    AND tabs.table_schema = @objectOwner
    AND tabs.TABLE_TYPE = 'BASE TABLE'
ORDER BY tabs.table_catalog, tabs.table_name, cols.ordinal_position

DECLARE @count int
SET @count = (SELECT MAX(id) FROM @potentialcolumns)
PRINT 'Found ' + CAST(@count as varchar) + ' potential columns.'
PRINT 'Beginning scan...'
PRINT ''
PRINT 'These columns contain the values being searched for...'
PRINT ''
DECLARE @iterator int, @sql varchar(4000)
SET @iterator = 1
WHILE @iterator <= (SELECT Max(id) FROM @potentialcolumns)
BEGIN
    SET @sql = (SELECT [sql] FROM @potentialcolumns where [id] = @iterator)
    IF (@sql IS NOT NULL) and (RTRIM(LTRIM(@sql)) <> '')
    BEGIN
        --SELECT @sql --use when checking sql output
        EXEC (@sql)
    END
    SET @iterator = @iterator + 1
END

PRINT ''
PRINT 'Scan completed' 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-14T20:13:39.140

我去过那儿。在您开始考虑可扩展性和高级搜索功能（例如搜索多个列并为每个列赋予不同的权重值）之前，它就像一种魅力。

例如，搜索**Title**和**Summary**列的唯一方法是拥有一个计算列，`SearchColumn = CONCAT(Title, Summary)`其索引超过`SearchColumn`。加权？`SearchColumn = CONCAT(CONCAT(Title,Title), Summary)`类似的东西。;) 过滤？忘掉它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-14T19:17:03.357

“有多难”是一个很难回答的问题。例如，已经做过 10 次的人可能会认为这很容易。我真正能说的是，如果您使用[NLucene](http://sourceforge.net/projects/nlucene)之类的东西而不是自己滚动，您可能会发现它更容易。

# javascript - 有哪些方法可以最大限度地减少来自外部 javascript 标注的页面等待？

> ID：202442
> 
> 赞同：1
> 
> 时间：2008-10-14T19:12:36.813
> 
> 标签：javascript

可以使用哪些技巧来阻止对各种在线服务的 javascript 标注减慢页面加载速度？

显而易见的解决方案是在页面底部进行所有 javascript 调用，但有些调用需要在顶部和中间进行。想到的另一个想法是使用 iframe。

您是否曾经不得不解开一个充满外部加载 javascript 的站点，该站点是如此缓慢以至于它不会释放 apache 并导致高负载时中断？有什么提示和技巧吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-14T19:49:38.067

window onload 是一个很好的概念，但更好的选择是使用 jQuery 并将您的代码放在“文档就绪”块中。这具有相同的效果，但您不必担心 onload 函数已经有订阅者。

[http://docs.jquery.com/Core/jQuery#callback](http://docs.jquery.com/Core/jQuery#callback)

```
$(function(){
  // Document is ready
}); 
```

或者：

```
jQuery(function($) {
  // Your code using failsafe $ alias here...
}); 
```

编辑：使用此模式调用所有外部服务。重构您的外部脚本文件，将它们对外部服务的 ajax 调用放在这些文档就绪块之一中，而不是内联执行。那么唯一的加载时间将是实际下载脚本文件所需的时间。

edit2：您可以在页面加载后或在页面上的任何其他 dom 事件中使用 jQuery 的内置功能加载脚本。

[http://docs.jquery.com/Ajax/jQuery.getScript](http://docs.jquery.com/Ajax/jQuery.getScript)

```
jQuery(function($) {
   $.getScript("http://www.yourdomain.com/scripts/somescript1.js"); 
   $.getScript("http://www.yourdomain.com/scripts/somescript2.js"); 
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-14T19:44:01.960

如果您使用的是第三方 JavaScript 框架/工具包/库，它可能会提供一个函数/方法，允许您在 DOM 完全加载后执行代码。[例如， Dojo Toolkit](http://dojotoolkit.org/)提供了[dojo.addOnLoad](http://api.dojotoolkit.org/jsdoc/dojo/1.2/dojo.addOnLoad)。类似地，[jQuery](http://jquery.com/)提供[Events/ready](http://docs.jquery.com/Events/ready)（或其[简写形式](http://docs.jquery.com/Core/jQuery#jQuery.28.C2.A0callback_.29)，可通过将函数直接传递给 jQuery 对象来访问）。

如果您坚持使用纯 JavaScript，那么诀窍是使用 window.onload 事件处理程序。虽然这最终会完成同样的事情，但 window.onload 在页面 - 以及页面上的所有内容，包括图像 - 完全加载后执行，而上述库在加载图像之前检测 DOM 准备就绪的第一时刻。

如果您需要从头部的脚本访问 DOM，这也是将脚本添加到文档末尾的首选替代方法。

例如（使用 window.onload）：

```
<html>
    <head>
        <title>Test Page</title>
        <script type="text/javascript">
            window.onload = function () {
                alert(document.getElementsByTagName("body")[0].className);
            };
        </script>
    <style type="text/css">
        .testClass { color: green; background-color: red; }
    </style>
    </head>
    <body class="testClass">
        <p>Test Content</p>
    </body>
</html> 
```

这将使您能够安排在页面完成加载后发生的特定操作。要查看实际效果，请将上述脚本与以下脚本进行比较，后者会阻止页面加载，直到您关闭模式警报框：

```
<html>
    <head>
        <title>Test Page</title>
        <script type="text/javascript">
            alert("Are you seeing a blank page underneath this alert?");
        </script>
        <style type="text/css">
            .testClass { color: green; background-color: red; }
        </style>
    </head>
    <body class="testClass">
        <p>Test Content</p>
    </body>
</html> 
```

如果您已经定义了 window.onload，或者您担心可能会重新定义它并破坏第三方脚本，请使用此方法附加到 -- 而不是重新定义 --window.onload。（这是[Simon Willison 的 addLoadEvent 函数](http://simonwillison.net/2004/May/26/addLoadEvent/)的略微修改版本。）

```
if (!window.addOnLoad)
{
    window.addOnLoad = function (f) {
        var o = window.onload;

        window.onload = function () {
            if (typeof o == "function") o();
            f();
        }
    };
} 
```

第一个示例中的脚本，修改为使用此方法：

```
window.addOnLoad(function () {
    alert(document.getElementsByTagName("body")[0].className);
}); 
```

修改为使用 Dojo：

```
dojo.addOnLoad(function () {
    alert(document.getElementsByTagName("body")[0].className);
}); 
```

修改为使用 jQuery：

```
$(function () {
    alert(document.getElementsByTagName("body")[0].className);
}); 
```

因此，既然您可以在页面加载时执行代码，您可能会想要动态加载外部脚本。就像上面的部分一样，大多数主要的框架/工具包/库都提供了这样做的方法。

或者，您可以自己滚动：

```
if (!window.addScript)
{
    window.addScript = function (src, callback) {
        var head = document.getElementsByTagName("head")[0];
        var script = document.createElement("script");
        script.src = src;
        script.type = "text/javascript";
        head.appendChild(script);
        if (typeof callback == "function") callback();
    };
}

window.addOnLoad(function () {
    window.addScript("example.js");
}); 
```

使用 Dojo ( [dojo.io.script.attach](http://api.dojotoolkit.org/jsdoc/dojo/1.2/dojo.io.script.attach) )：

```
dojo.addOnLoad(function () {
    dojo.require("dojo.io.script");
    dojo.io.script.attach("exampleJsId", "example.js");
}); 
```

使用 jQuery ( [jQuery.getScript](http://docs.jquery.com/Ajax/jQuery.getScript) )：

```
$(function () {
    $.getScript("example.js");
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-14T19:48:10.160

请参阅文章[Serving JavaScript Fast](http://www.thinkvitamin.com/features/webapps/serving-javascript-fast) and [Faster AJAX Web Services through multiple subdomain calls](http://www.codeproject.com/KB/ajax/FasterAjaxWebsevices.aspx)以获得一些建议。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-14T19:22:38.323

不容易解决。在某些情况下，可以将外部文件合并为一个单元并对其进行压缩，以最大限度地减少 HTTP 请求和数据传输。但是使用这种方法，您需要从您的主机提供新的 javascript 文件，这并不总是可行的。

我看不到 iframe 解决了这个问题……你能详细说明一下吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-14T20:05:00.110

如果您不需要特定的脚本广告加载时间，您可以稍后通过在运行时向页面添加另一个脚本元素来加载它。

# oracle - user_dump_dest 将其放在 NAS 上是否有害

> ID：202456
> 
> 赞同：1
> 
> 时间：2008-10-14T19:16:30.503
> 
> 标签：oracle, configuration

说 user_dump_dest 通常在本地驱动器上是否正确？

如果是这样，将 NAS 卷安装到 Unix 和 Windows 并指向 user_dump_dest 是否存在问题？

如果是这样，它们是什么？

在产品中是否有任何问题不值得这样做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-15T11:18:41.420

我已经在 NAS 上使用 user_dump_dest 运行了 9.2 实例，并且从未遇到过问题。

如果您担心，请让 oracle 将它们写入本地，然后将它们同步到您的 NAS 并从本地删除它们，不过我从来不需要这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-14T20:39:57.667

是的，通常（默认情况下）user_dump_dest 位于本地驱动器上。我不认为将它放在 NAS 上会有任何具体问题。但它会出现任何应用程序可能出现的所有潜在问题：(1) 如果无法访问 NAS，Oracle 将无法写出用户转储文件，以及 (2) 写入延迟会增加。延迟问题可能仅在您进行大规模跟踪以诊断性能问题时才重要，因为写入延迟会影响时序测量。我希望如果 NAS 因为无法访问而 Oracle 尝试写入它，它会默默地失败。

除非本地磁盘上的空间限制迫使我这样做，否则我认为我不会这样做。但通常这个目录的内容相对于你的数据应该是微不足道的。

# .net - 什么是gcnew？

> ID：202459
> 
> 赞同：64
> 
> 时间：2008-10-14T19:17:38.893
> 
> 标签：.net, c++-cli

我偶然发现了这段代码，并且很自豪地去问作者这是什么意思。

```
Hashtable^ tempHash = gcnew Hashtable(iterators_);

IDictionaryEnumerator^ enumerator = tempHash->GetEnumerator(); 
```

`gcnew`使用它而不是简单地使用它是什么以及有多重要`new`？（我也被插入符号难住了；我[在这里](https://stackoverflow.com/questions/202463/what-does-the-caret-mean-in-cnet)问过这个问题。）

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2008-10-14T19:18:43.290

[gcnew](http://msdn.microsoft.com/en-us/library/te3ecsc8.aspx)用于 .NET 引用对象；使用 gcnew 创建的对象会自动被垃圾回收；将 gcnew 与 CLR 类型一起使用很重要

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2008-10-14T19:19:19.937

`gcnew`是一个运算符，就像`new`运算符一样，只是你不需要`delete`用它创建任何东西；这是***垃圾******收集***的。您用于创建 .Net 托管类型和创建非托管类型。**`gcnew``new`**

 *** * *

## 回答 #3

> 赞同：6
> 
> 时间：2016-04-26T11:04:18.390

在声明类型时，插入符号 '^' 的作用与 C/C++ 中的 '*' 类似；

```
// pointer to new std::string object -> memory is not garbage-collected
std::string* strPtr = new std::string;

// pointer to System::String object -> memory is garbage-collected
System::String^ manStr = gcnew System::String; 
```

在将托管对象描述为托管对象时，我使用术语“指针”，可以将其与“nullptr”进行比较，就像 C/C++ 中的指针一样。C/C++ 中的引用不能与“nullptr”进行比较，因为它是现有对象的地址。

托管对象使用自动引用计数，这意味着当它们的引用计数为零时它们会被自动销毁，尽管如果两个或多个无法访问的对象相互引用，您仍然会有内存泄漏。请注意，自动引用计数在性能方面并不是免费的，因此请明智地使用它。

# .net - C++/CLI 中的插入符号 ('^') 是什么意思？

> ID：202463
> 
> 赞同：238
> 
> 时间：2008-10-14T19:18:38.893
> 
> 标签：.net, c++-cli

我刚刚遇到了这段代码，一些谷歌搜索没有找到对这种神秘（对我来说）语法的解释。

```
Hashtable^ tempHash = gcnew Hashtable(iterators_);

IDictionaryEnumerator^ enumerator = tempHash->GetEnumerator(); 
```

插入符号到底是什么意思？（这`gcnew`对我来说也是新的，我[在这里](https://stackoverflow.com/questions/202459/what-is-gcnew)问过这个问题。）

* * *

## 回答 #1

> 赞同：191
> 
> 时间：2008-10-14T19:20:11.183

这是[C++/CLI](http://en.wikipedia.org/wiki/C%2B%2B/CLI)，插入符号是 *（指针）的托管等效项，在 C++/CLI 术语中称为“引用类型”的[“句柄](https://docs.microsoft.com/en-us/cpp/extensions/handle-to-object-operator-hat-cpp-component-extensions)”（因为您仍然可以拥有非托管指针）。

（感谢 Aardvark 指出更好的术语。）

* * *

## 回答 #2

> 赞同：94
> 
> 时间：2013-01-17T11:45:00.060

```
// here normal pointer
P* ptr = new P; // usual pointer allocated on heap
P& nat = *ptr; // object on heap bind to native object

//.. here CLI managed 
MO^ mngd = gcnew MO; // allocate on CLI heap
MO% rr = *mngd; // object on CLI heap reference to gc-lvalue 
```

一般来说，标点符号`%`是 to`^`就像标点符号`&`是 to一样`*`。在 C++ 中，一元运算`&`符在 C++/CLI 中是一元运算`%`符。

虽然`&ptr`产生 a `P*`，但`%mngd`产生于`MO^`。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2008-10-14T19:21:58.060

这意味着这是对托管对象与常规 C++ 指针的引用。此类引用后面的对象由运行时管理，并且可以在内存中重新定位。它们也会自动进行垃圾收集。

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2008-10-14T19:23:38.087

当您分配托管内存时，垃圾收集器可以移动该内存。运算符是托管内存的指针，即使垃圾收集器移动它指向的对象，它也会`^`继续指向*正确的位置。*

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-10-14T19:23:26.340

从 MSDN 看来，插入符号意味着您正在获取正在创建的类型的句柄。

[https://web.archive.org/web/20150117095313/http://msdn.microsoft.com/en-us/library/te3ecsc8%28VS.80%29.aspx](https://web.archive.org/web/20150117095313/http://msdn.microsoft.com/en-us/library/te3ecsc8%28VS.80%29.aspx)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-10-14T19:23:05.530

在 C++/CLI 中，它表示托管指针。您可以在此处阅读有关它的更多信息（以及其他 C++/CLI 功能）：

[http://en.wikipedia.org/wiki/C%2B%2B/CLI](http://en.wikipedia.org/wiki/C%2B%2B/CLI)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-14T19:20:09.950

这意味着它是对托管对象的引用。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-06-06T10:35:23.653

还值得考虑以下几句话，它们以稍微不同的方式给出答案：

“句柄声明符（^，发音为“帽子”）修改类型说明符，表示当系统确定对象不再可访问时，应自动删除声明的对象。

“由于本机 C++ 指针 (*) 和引用 (&) 不是托管引用，因此垃圾收集器无法自动更新它们指向的地址。要解决此问题，请使用句柄声明符指定垃圾收集器知道的变量并且可以自动更新。”

（恕我直言，“本机”是比“句柄”更好的词，因为句柄可能是通过使用“Windows SDK”引入的更多词）

# c# - 如何在 C# 中计算 CRC_B

> ID：202466
> 
> 赞同：2
> 
> 时间：2008-10-14T19:19:09.343
> 
> 标签：c#, crc, iso

如何按照 ISO 14443 中的描述计算 C# 中的 CRC_B 编码？以下是一些背景信息：

> CRC_B 编码 本附件用于说明目的，并指示将存在于物理层中的比特模式。包含它是为了检查 CRC_B 编码的 ISO/IEC 14443-3 B 类实现。有关详细信息，请参阅 ISO/IEC 3309 和 CCITT X.25 2.2.7 和 V.42 8.1.1.6.1。初始值 = 'FFFF'

*   示例 1：对于 0x00 0x00 0x00，您应该以 0xCC 0xC6 的 CRC_B 结尾
*   示例 2：对于 0x0F 0xAA 0xFF 你应该以 0xFC 0xD1 的 CRC_B 结束

我尝试了一些随机的 CRC16 库，但它们并没有给我相同的结果。我也没有像[这里](http://www.lammertbies.nl/comm/info/crc-calculation.html)那样从在线检查中得到相同的结果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-15T03:07:45.480

[我从ISO/IEC JTC1/SC17 N 3497](http://wg8.de/wg8n1454_17n3497_Ballot_3rdCD14443-3.3.pdf)中的 C 代码中颠倒了这一点，所以它并不漂亮，但可以满足您的需要：

```
public class CrcB
{
    const ushort __crcBDefault = 0xffff;

    private static ushort UpdateCrc(byte b, ushort crc)
    {
            unchecked
            {
                byte ch = (byte)(b^(byte)(crc & 0x00ff));
                ch = (byte)(ch ^ (ch << 4));
                return (ushort)((crc >> 8)^(ch << 8)^(ch << 3)^(ch >> 4));
            }
    }

    public static ushort ComputeCrc(byte[] bytes)
    {
            var res = __crcBDefault;
            foreach (var b in bytes)
                    res = UpdateCrc(b, res);
            return (ushort)~res;
    }
} 
```

作为测试，请尝试以下代码：

```
 public static void Main(string[] args) 
 {
     // test case 1 0xFC, 0xD1
     var bytes = new byte[] { 0x0F, 0xAA, 0xFF };
     var crc = CrcB.ComputeCrc(bytes);
     var cbytes = BitConverter.GetBytes(crc);

     Console.WriteLine("First (0xFC): {0:X}\tSecond (0xD1): {1:X}", cbytes[0], cbytes[1]);

     // test case 2 0xCC, 0xC6
     bytes = new byte[] { 0x00, 0x00, 0x00 };
     crc = CrcB.ComputeCrc(bytes);
     cbytes = BitConverter.GetBytes(crc);
     Console.WriteLine("First (0xCC): {0:X}\tSecond (0xC6): {1:X}", cbytes[0], cbytes[1]);

     Console.ReadLine();
} 
```

# powershell - Windows Powershell 是否有 Try/Catch 或其他错误处理机制？

> ID：202470
> 
> 赞同：18
> 
> 时间：2008-10-14T19:19:28.983
> 
> 标签：powershell, scripting, try-catch

在脚本中，当 command-let 或其他可执行语句出错时，是否有 try/catch 类型的机制可以从这些错误中恢复？我在文档中没有遇到过。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-14T19:27:02.510

`Trap [exception-type] {}`在要处理异常的代码之前使用一个块。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-24T21:52:11.700

我在我的 TechNet 杂志专栏（technetmagazine.com，如果您有兴趣的话）中对此进行了介绍。

首先，PowerShell v2 将有一个标准的 Try...Catch，这很棒。

现有的 shell (v1) 支持 trap {} 构造。这些必须在异常发生之前定义。此外，大多数 cmdlet 需要 -EA“STOP”参数才能生成可捕获的异常。陷阱可以在任何范围内定义，并且会“冒泡”直到被捕获或到达全局（shell）范围。

在陷阱结束时，执行 Continue 以返回与陷阱相同范围内的下一行代码，或者执行 Break 以离开当前范围并抛出异常。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-11T20:44:11.130

这是使用 powershell 实现 try/catch/finally 的人（Adam Weigert）。我用它来代替内置的陷阱状态。显得更自然。

[http://weblogs.asp.net/adweigert/archive/2007/10/10/powershell-try-catch-finally-comes-to-life.aspx](http://weblogs.asp.net/adweigert/archive/2007/10/10/powershell-try-catch-finally-comes-to-life.aspx)

# objective-c - 是否可以在 Interface Builder 中设计 NSCell 子类？

> ID：202471
> 
> 赞同：22
> 
> 时间：2008-10-14T19:19:55.363
> 
> 标签：objective-c, cocoa, interface-builder, nstableview, nscell

我正在尝试将 NSCell 子类化以在 NSTableView 中使用。我要创建的单元格相当复杂，所以如果我可以在 Interface Builder 中设计它然后从 nib 加载 NSCell 将会非常有用。

这可能吗？我该怎么做？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-15T06:59:35.623

问题是关于 NSCell 的一个子类；其他答案似乎在做其他事情，可能利用 UITableViewCell 作为视图。

NSCell 不是视图。虽然在 IB 中放置自定义单元将是一件有用的事情，但我认为答案基本上是“不，这是不可能的”。当你继承 NSCell 时，你几乎只是在做你自己的绘图。没有支持子单元或参数化的自动布局（ala NSView 的弹簧和支柱），我怀疑你在寻找什么。

唯一需要注意的是，您可以设计一个 NSCell 子类来*进行*子元素的布局并提供用于设置这些子元素和所有可调整参数的参数。然后，您需要编写一个 IB 插件，以使该单元格和随附的检查器在 IB 中的设计时可用。

然而，这可能比编写一个或多或少做同样事情的小定制应用程序更难。将 NSCell 放在窗口中间的控件中，并为自己制作 UI 以调整您感兴趣的参数。绑定可以使定位内容变得非常简单（即将 x 值绑定到滑块），尽管您会当然不能直接操纵元素。完成后，您可以存档您的单元格并在运行时在您的真实应用程序中加载存档，或者您可以注销属性并在您的应用程序的代码中设置它们。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2010-08-08T11:28:25.127

该线程中的一些答案已经偏离主题，因为他们正在谈论 Cocoa Touch，而最初的问题是关于 Cocoa - 这两个 API 在这方面有很大不同，而 Cocoa Touch 使它变得容易，因为 UITableViewCell 是一个视图子类。NSCell 不是，这就是问题所在

对于信息，我最近不得不在 NSOutlineView 中做一些非常相似的事情 - 这基本上是相同的，但如果有的话，会有点困难，因为你必须处理级别的披露/崩溃。如果您对代码感兴趣，我在这里发布：http: [//www.stevestreeting.com/2010/08/08/cocoa-tip-using-custom-table-outline-cells-design-in-ib /](http://www.stevestreeting.com/2010/08/08/cocoa-tip-using-custom-table-outline-cells-designed-in-ib/)

高温高压

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-25T23:06:33.570

正如 Ken 所说，`NSCells`and`NSViews`是不同的，您只能`NSView`在 NIB 中布置层次结构，而不是`NSCells`（没有任何明确的层次结构）。

另一方面，没有什么能阻止你拥有一个层次结构`NSViews`并使用它来绘制你的`NSCell`——你可以将它们添加为你的单元格父视图的子视图，告诉它们显示，然后从窗口中删除它们，没有人会更聪明。

在这种情况下，使用 NIB 是可行的，尽管它看起来很麻烦。通常情况下，我只是用`NSCells`带有 my 的自定义对象替换了带有 my的对象`NSViews`，但这意味着要编写自己的鼠标处理代码，这非常棘手。

另一方面，我的方法可以让您在 NIB 中绑定视图的值，因此您不必做任何额外的工作，这很酷。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-15T04:56:19.817

在 IB 中，启动一个空的 XIB。现在转到调色板并拖入一个 UITableViewCell，双击调出并进行编辑。

仅包括自定义 UITableViewCell（没有其他 UIView 或其他顶级控件） - 确保它是 IB 中的真实 UITableViewCell，或者您不能设置重用标识符（而不是将 IB 中的 UIView 强制转换为自定义 UITableViewCell 类）。然后，您可以在单元格中添加标签或您喜欢的任何内容，以及设置重用标识符或设置您可能喜欢的任何披露指示符。

要使用，您在 tableView:cellForRow:atIndexPath: 方法中提供如下代码：

```
YourCustomCellClass *cell = (YourCustomCellClass *)[tableView dequeueReusableCellWithIdentifier:<IDYouSetInXIBFile>];
if ( cell == nil )
{
        NSArray *topLevelObjects = [[NSBundle mainBundle] loadNibNamed:<YourXIBName> owner:self options:nil];
    id firstObject = [topLevelObjects objectAtIndex:0];
    if ( [ firstObject isKindOfClass:[UITableViewCell class]] )
        cell = firstObject; 
    else cell = [topLevelObjects objectAtIndex:1];
} 
```

如果您有任何要在代码中引用的标签或其他控件，请将它们在 IB 中连接到您的自定义单元格类 - 而不是文件的所有者，您不需要使用上述代码进行设置（您可以将其保留为 NSObject ）。

编辑：我注意到您确实在寻找 NSCell 答案，但是在 Cocoa 中使用 IB 的代码方法应该与我上面使用的 Cocoa Touch 代码相同，因为 loadNibNamed 是标准的 Cocoa 调用。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-17T00:05:40.730

[几年前，Joar Wingfors 为Stepwise](http://www.stepwise.com/)写了一篇关于相关主题的文章，[*即 TableView Rows 中*](http://www.stepwise.com/Articles/Technical/2003-12-20.01.html "TableView 行中的子视图")的子视图。

主要技术是创建一个可以承载 NSView 的 NSCell。如果你要这样做，你可以在 Interface Builder 中设计一个 NSView 子类，你可以将它嵌入到任何你需要该特定单元格的地方。

如果您可以针对 Leopard，另一种可能性是查看您是否需要使用 NSTableView 或是否可以使用 NSCollectionView。集合视图直接根据“项目视图”而不是单元格进行处理，因此在 Interface Builder 中设计它们要简单得多。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-04-27T16:07:57.197

不过，我发现了一些我不完全理解的有趣的例子。

*   [GitX](https://github.com/uhees/gitx/tree/v0.8.1)扩展了`NSTextFieldCell`他们的[PBIconAndTextCell](https://github.com/uhees/gitx/blob/v0.8.1/PBIconAndTextCell.h)，引用了这篇[文章](http://www.cocoadev.com/index.pl?NSTableViewImagesAndText)。
*   WWDC 2009 - Session 110“使用表格视图和浏览器呈现用户数据”讨论“添加子视图”和“自定义单元格编辑器”。（不过我没有源代码。）
*   [在 NSTableView 中显示包含文本和图像的 NSTextfieldCell，#70](http://juliuspaintings.co.uk/cgi-bin/paint_css/animatedPaint/070-NSTableView-ImageAndTextCell.pl)
*   [在 NSTableView 中显示包含文本和图像的 NSTextfieldCell，#71](http://juliuspaintings.co.uk/cgi-bin/paint_css/animatedPaint/071-NSTableView-ATImageAndTextView.pl)

最后两个示例使用`NSTableViewDataSource`and `NSTableViewDelegate`。我想使用`Bindings`in`ArrayController`来`InterfaceBuilder`连接其他 UI 元素，如文本字段。

*   我偶然发现了[另一个讨论](https://stackoverflow.com/questions/4887559/what-is-the-easiest-way-to-custom-nstableview-cell)，其中[Abizern](https://stackoverflow.com/users/41116/abizern)指出[Alex Rozanski](https://github.com/Perspx/PXListView)的 PXListView看起来很有希望！

*   我正在尝试自己实施该问题的解决方案。[请在 github 上](https://github.com/johnjohndoe/NSTableViewCustomCell)找到我的项目，并在此处找到最新的[渲染问题](https://stackoverflow.com/questions/5884265/how-to-setup-a-nstableview-with-a-custom-cell-using-a-subview)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-15T00:08:34.143

我这样做：

```
/* example of a silly way to load a UITableViewCell from a standalone nib */

+ (CEntryTableViewCell *)cell
{
// TODO -- this is really silly.
NSArray *theObjects = [[NSBundle mainBundle] loadNibNamed:@"EntryTableViewCell" owner:self options:NULL];
for (id theObject in theObjects)
    if ([theObject isKindOfClass:self])
        return(theObject);
NSAssert(NO, @"Could not find object of class CEntryTableViewCell in nib");
return(NULL);
} 
```

但是，它不是很有效，如果您要加载大量数据，它可能会伤害您。当然，您应该使用重用标识符，它应该强制此代码在每个表中只运行几次。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-05-07T10:48:15.417

我想在这里提供一种更现代的方法。

从 iOS 5 开始，UITableView 有一个方法

`(void)registerNib:(UINib *)nib forCellReuseIdentifier:(NSString *)identifier`

注册包含您的单元格的 NIB 后，只需使用

`- (id)dequeueReusableCellWithIdentifier:(NSString *)identifier`

得到一个新的细胞。如果一个单元格可供重用，它将被返回，否则会自动创建一个新单元格，在这种情况下，这意味着从 NIB 文件中加载。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-06-05T10:48:55.247

1) 创建`NSViewController` `TableViewCell.h`

2）在`TableViewCell.h`一些程序中创建，如

```
-(void)setText:(NSString *)text image:(NSImage *)image 
```

3）在主类`#import "TableViewCell.h"`

4）在主类中 `-(NSView *)tableView:viewForTableColumn:row: write:`

```
NSImage *img = //some image
TableViewCell *cell = [[TableViewCell alloc] initWithWindowNibName:@"TableViewCell"];
cell.view.init;
[cell setText:@"some text" image:img];
return cell; 
```

希望这会有所帮助=)

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2008-12-27T13:11:37.440

将您的添加`UITableViewCell`到您的`tableviewcontroller`并声明一个`IBOutlet`属性：

```
@interface KuguTableViewController : UITableViewController {
    IBOutlet UITableViewCell *customTypeCell;
}

@property (readonly)  UITableViewCell *customTypeCell; 
```

...然后`cellForRowAtIndexPath`您可以使用您的单元格并将其设置为重复使用：

```
static NSString *CellIdentifier = @"CustomCell"
cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
if (cell == nil)
        cell = customTypeCell;
        cell.reuseIdentifier = CellIdentifier; 
```

# c# - 如何异步使用 HttpWebRequest (.NET)？

> ID：202481
> 
> 赞同：161
> 
> 时间：2008-10-14T19:22:27.870
> 
> 标签：c#, .net, asynchronous, httprequest

如何异步使用 HttpWebRequest (.NET, C#)？

* * *

## 回答 #1

> 赞同：128
> 
> 时间：2008-10-14T21:17:56.263

采用[`HttpWebRequest.BeginGetResponse()`](http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.begingetresponse.aspx)

```
HttpWebRequest webRequest;

void StartWebRequest()
{
    webRequest.BeginGetResponse(new AsyncCallback(FinishWebRequest), null);
}

void FinishWebRequest(IAsyncResult result)
{
    webRequest.EndGetResponse(result);
} 
```

异步操作完成时调用回调函数。您至少需要[`EndGetResponse()`](http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.endgetresponse.aspx)从此函数调用。

* * *

## 回答 #2

> 赞同：69
> 
> 时间：2014-04-11T05:15:07.530

到目前为止，最简单的方法是使用[TPL](http://msdn.microsoft.com/en-us/library/dd460717.aspx)中的[TaskFactory.FromAsync](http://msdn.microsoft.com/en-us/library/system.threading.tasks.taskfactory.fromasync.aspx)。[当与新的async/await](http://msdn.microsoft.com/en-us/library/hh191443.aspx)关键字结合使用时，它实际上是几行代码：

```
var request = WebRequest.Create("http://www.stackoverflow.com");
var response = (HttpWebResponse) await Task.Factory
    .FromAsync<WebResponse>(request.BeginGetResponse,
                            request.EndGetResponse,
                            null);
Debug.Assert(response.StatusCode == HttpStatusCode.OK); 
```

如果您不能使用 C#5 编译器，则可以使用[Task.ContinueWith](http://msdn.microsoft.com/en-us/library/system.threading.tasks.task.continuewith.aspx)方法完成上述操作：

```
Task.Factory.FromAsync<WebResponse>(request.BeginGetResponse,
                                    request.EndGetResponse,
                                    null)
    .ContinueWith(task =>
    {
        var response = (HttpWebResponse) task.Result;
        Debug.Assert(response.StatusCode == HttpStatusCode.OK);
    }); 
```

* * *

## 回答 #3

> 赞同：67
> 
> 时间：2010-12-13T22:31:56.520

考虑答案：

```
HttpWebRequest webRequest;

void StartWebRequest()
{
    webRequest.BeginGetResponse(new AsyncCallback(FinishWebRequest), null);
}

void FinishWebRequest(IAsyncResult result)
{
    webRequest.EndGetResponse(result);
} 
```

您可以发送请求指针或任何其他对象，如下所示：

```
void StartWebRequest()
{
    HttpWebRequest webRequest = ...;
    webRequest.BeginGetResponse(new AsyncCallback(FinishWebRequest), webRequest);
}

void FinishWebRequest(IAsyncResult result)
{
    HttpWebResponse response = (result.AsyncState as HttpWebRequest).EndGetResponse(result) as HttpWebResponse;
} 
```

问候

* * *

## 回答 #4

> 赞同：64
> 
> 时间：2012-12-20T00:03:00.093

到目前为止，每个人都错了，因为`BeginGetResponse()`在当前线程上做了一些工作。从[文档](http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.begingetresponse.aspx)中：

> BeginGetResponse 方法需要在此方法变为异步之前完成一些同步设置任务（例如 DNS 解析、代理检测和 TCP 套接字连接）。因此，永远不应在用户界面 (UI) 线程上调用此方法，因为在引发错误异常之前完成初始同步设置任务可能需要相当长的时间（长达几分钟，具体取决于网络设置）或该方法成功。

所以要做到这一点：

```
void DoWithResponse(HttpWebRequest request, Action<HttpWebResponse> responseAction)
{
    Action wrapperAction = () =>
    {
        request.BeginGetResponse(new AsyncCallback((iar) =>
        {
            var response = (HttpWebResponse)((HttpWebRequest)iar.AsyncState).EndGetResponse(iar);
            responseAction(response);
        }), request);
    };
    wrapperAction.BeginInvoke(new AsyncCallback((iar) =>
    {
        var action = (Action)iar.AsyncState;
        action.EndInvoke(iar);
    }), wrapperAction);
} 
```

然后，您可以对响应做您需要做的事情。例如：

```
HttpWebRequest request;
// init your request...then:
DoWithResponse(request, (response) => {
    var body = new StreamReader(response.GetResponseStream()).ReadToEnd();
    Console.Write(body);
}); 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2018-03-11T21:44:54.530

```
public static async Task<byte[]> GetBytesAsync(string url) {
    var request = (HttpWebRequest)WebRequest.Create(url);
    using (var response = await request.GetResponseAsync())
    using (var content = new MemoryStream())
    using (var responseStream = response.GetResponseStream()) {
        await responseStream.CopyToAsync(content);
        return content.ToArray();
    }
}

public static async Task<string> GetStringAsync(string url) {
    var bytes = await GetBytesAsync(url);
    return Encoding.UTF8.GetString(bytes, 0, bytes.Length);
} 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2013-03-06T18:10:07.707

我最终使用了BackgroundWorker，它与上面的一些解决方案不同，它绝对是异步的，它为您处理返回GUI线程，并且非常容易理解。

处理异常也很容易，因为它们最终会出现在 RunWorkerCompleted 方法中，但请确保您阅读了以下内容：[Unhandled exceptions in BackgroundWorker](https://stackoverflow.com/questions/1044460/unhandled-exceptions-in-backgroundworker)

我使用了 WebClient，但显然你可以根据需要使用 HttpWebRequest.GetResponse。

```
var worker = new BackgroundWorker();

worker.DoWork += (sender, args) => {
    args.Result = new WebClient().DownloadString(settings.test_url);
};

worker.RunWorkerCompleted += (sender, e) => {
    if (e.Error != null) {
        connectivityLabel.Text = "Error: " + e.Error.Message;
    } else {
        connectivityLabel.Text = "Connectivity OK";
        Log.d("result:" + e.Result);
    }
};

connectivityLabel.Text = "Testing Connectivity";
worker.RunWorkerAsync(); 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2017-10-19T15:39:35.497

自从发布了许多这些答案以来，.NET 已经发生了变化，我想提供一个更新的答案。使用异步方法启动`Task`将在后台线程上运行的：

```
private async Task<String> MakeRequestAsync(String url)
{    
    String responseText = await Task.Run(() =>
    {
        try
        {
            HttpWebRequest request = WebRequest.Create(url) as HttpWebRequest;
            WebResponse response = request.GetResponse();            
            Stream responseStream = response.GetResponseStream();
            return new StreamReader(responseStream).ReadToEnd();            
        }
        catch (Exception e)
        {
            Console.WriteLine("Error: " + e.Message);
        }
        return null;
    });

    return responseText;
} 
```

要使用异步方法：

```
String response = await MakeRequestAsync("http://example.com/"); 
```

**更新：**

此解决方案不适用于使用`WebRequest.GetResponseAsync()`代替的UWP 应用程序`WebRequest.GetResponse()`，并且它不会`Dispose()`在适当的情况下调用方法。@dragansr 有一个很好的替代解决方案来解决这些问题。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2012-10-08T06:02:34.883

```
public void GetResponseAsync (HttpWebRequest request, Action<HttpWebResponse> gotResponse)
    {
        if (request != null) { 
            request.BeginGetRequestStream ((r) => {
                try { // there's a try/catch here because execution path is different from invokation one, exception here may cause a crash
                    HttpWebResponse response = request.EndGetResponse (r);
                    if (gotResponse != null) 
                        gotResponse (response);
                } catch (Exception x) {
                    Console.WriteLine ("Unable to get response for '" + request.RequestUri + "' Err: " + x);
                }
            }, null);
        } 
    } 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-12-23T11:07:52.227

跟进@Isak 的回答，非常好。尽管如此，它最大的缺陷是它只会在响应状态为 200-299 时调用 responseAction。解决此问题的最佳方法是：

```
private void DoWithResponseAsync(HttpWebRequest request, Action<HttpWebResponse> responseAction)
{
    Action wrapperAction = () =>
    {
        request.BeginGetResponse(new AsyncCallback((iar) =>
        {
            HttpWebResponse response;
            try
            {
                response = (HttpWebResponse)((HttpWebRequest)iar.AsyncState).EndGetResponse(iar);
            }
            catch (WebException ex)
            {
                // It needs to be done like this in order to read responses with error status:
                response = ex.Response as HttpWebResponse;
            }
            responseAction(response);
        }), request);
    };
    wrapperAction.BeginInvoke(new AsyncCallback((iar) =>
    {
        var action = (Action)iar.AsyncState;
        action.EndInvoke(iar);
    }), wrapperAction);
} 
```

然后@Isak 如下：

```
HttpWebRequest request;
// init your request...then:
DoWithResponse(request, (response) => {
    var body = new StreamReader(response.GetResponseStream()).ReadToEnd();
    Console.Write(body);
}); 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2022-01-17T18:44:57.873

我一直在将它用于异步 UWR，希望它可以帮助某人

```
 string uri = "http://some.place.online";

    using (UnityWebRequest uwr = UnityWebRequest.Get(uri))
    {
        var asyncOp = uwr.SendWebRequest();
        while (asyncOp.isDone == false) await Task.Delay(1000 / 30); // 30 hertz

        if(uwr.result == UnityWebRequest.Result.Success) return uwr.downloadHandler.text;
        Debug.LogError(uwr.error);
    } 
```

# msbuild - 在 ClickOnce 部署中自动增加“最低要求的版本”？

> ID：202491
> 
> 赞同：19
> 
> 时间：2008-10-14T19:25:02.437
> 
> 标签：msbuild, clickonce

有没有办法自动增加 ClickOnce 部署中的“最低要求版本”字段以始终等于当前内部版本号？基本上，我总是希望我的部署在启动时自动更新。

我怀疑我需要一些构建前/构建后的事件，但我希望有更简单的方法。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-11-20T22:14:51.467

我回答这个问题可能有点晚了，但我发现很难在谷歌上找到解决方案，但最终想通了，所以我想分享一下。

使用 MSBuild 版本 4（VS2010 和 VS2012）可以通过插入以下目标来实现：

```
 <Target Name="AutoSetMinimumRequiredVersion" BeforeTargets="GenerateDeploymentManifest">
    <FormatVersion Version="$(ApplicationVersion)" Revision="$(ApplicationRevision)">
      <Output PropertyName="MinimumRequiredVersion" TaskParameter="OutputVersion"  />
    </FormatVersion>
    <FormatVersion Version="$(ApplicationVersion)" Revision="$(ApplicationRevision)">
      <Output PropertyName="_DeploymentBuiltMinimumRequiredVersion" TaskParameter="OutputVersion"  />
    </FormatVersion>
  </Target> 
```

$(ApplicationVersion) 与您可以在 VS IDE 的项目发布窗口中手动设置的设置相同，修订部分设置为星号。$(ApplicationRevision) 是用于已发布版本的实际修订。FormatVersion 任务是一个内置的 MSBuild 任务，它将两者格式化为一个完整的版本号。

这会将“最低要求版本”设置为与“发布版本”相同，因此确保新部署将始终由用户安装，即没有跳过更新的选项。

当然，如果你不想将最低要求版本设置为发布版本，而想使用不同的源属性，那么直接修改目标就可以了，但原理是一样的。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-23T19:33:20.417

我最终实际上将一个 AddIn 滚动到 VS，它可以同步所有版本号，然后只需单击一下即可构建和发布。这很容易。

```
 Public Sub Publish()
        Try
            Dim startProjName As String = Nothing
            Dim targetProj As Project = Nothing
            Dim soln As Solution2 = TryCast(Me._applicationObject.DTE.Solution, Solution2)
            If soln IsNot Nothing Then
                For Each prop As [Property] In soln.Properties
                    If prop.Name = "StartupProject" Then
                        startProjName = prop.Value.ToString()
                        Exit For
                    End If
                Next
                If startProjName IsNot Nothing Then
                    For Each proj As Project In soln.Projects
                        If proj.Name = startProjName Then
                            targetProj = proj
                            Exit For
                        End If
                    Next
                    If targetProj IsNot Nothing Then
                        Dim currAssemVersionString As String = targetProj.Properties.Item("AssemblyVersion").Value.ToString
                        Dim currAssemVer As New Version(currAssemVersionString)
                        Dim newAssemVer As New Version(currAssemVer.Major, currAssemVer.Minor, currAssemVer.Build, currAssemVer.Revision + 1)
                        targetProj.Properties.Item("AssemblyVersion").Value = newAssemVer.ToString()
                        targetProj.Properties.Item("AssemblyFileVersion").Value = newAssemVer.ToString()
                        Dim publishProps As Properties = TryCast(targetProj.Properties.Item("Publish").Value, Properties)
                        Dim shouldPublish As Boolean = False
                        If publishProps IsNot Nothing Then
                            shouldPublish = CBool(publishProps.Item("Install").Value)
                            If shouldPublish Then
                                targetProj.Properties.Item("GenerateManifests").Value = "true"
                                publishProps.Item("ApplicationVersion").Value = newAssemVer.ToString()
                                publishProps.Item("MinimumRequiredVersion").Value = newAssemVer.ToString()
                                publishProps.Item("ApplicationRevision").Value = newAssemVer.Revision.ToString()
                            End If
                        End If
                        targetProj.Save()
                        Dim build As SolutionBuild2 = TryCast(soln.SolutionBuild, SolutionBuild2)
                        If build IsNot Nothing Then
                            build.Clean(True)
                            build.Build(True)
                            If shouldPublish Then
                                If build.LastBuildInfo = 0 Then

                                    build.Publish(True)
                                End If
                            End If
                        End If
                    End If
                End If
            End If
        Catch ex As Exception
            MsgBox(ex.ToString)
        End Try
    End Sub 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-22T04:54:44.763

开箱即用，我不相信有办法。然而，旋转你自己的并不是太多的努力。

我使用的方法如下：

1) 创建一个 Version.Properties 文件

```
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <PropertyGroup>
    <Util-VersionMajor>1</Util-VersionMajor>
    <Util-VersionMinor>11</Util-VersionMinor>
    <Util-VersionBuild>25</Util-VersionBuild>
    <Util-VersionRevision>0</Util-VersionRevision>
    <Util-VersionDots>$(Util-VersionMajor).$(Util-VersionMinor).$(Util-VersionBuild).$(Util-VersionRevision)</Util-VersionDots>
    <Util-VersionUnders>$(Util-VersionMajor)_$(Util-VersionMinor)_$(Util-VersionBuild)_$(Util-VersionRevision)</Util-VersionUnders>
    <MinimumRequiredVersion>$(Util-VersionDots)</MinimumRequiredVersion>
    <ApplicationVersion>$(Util-VersionDots)</ApplicationVersion>
    <ApplicationRevision>$(Util-VersionRevision)</ApplicationRevision>
  </PropertyGroup>
</Project> 
```

2) 将 Version.Properties 文件导入到您的项目文件中

3) 创建一个任务来增加 Build 上的版本。这是我的

```
<Target Name="IncrementVersion" DependsOnTargets="Build" Condition="'$(BuildingInsideVisualStudio)'==''">
    <ItemGroup>
      <Util-VersionProjectFileItem Include="$(Util-VersionProjectFile)" />
    </ItemGroup>
    <PropertyGroup>
      <Util-VersionProjectFileFullPath>@(Util-VersionProjectFileItem->'%(FullPath)')</Util-VersionProjectFileFullPath>
    </PropertyGroup>
    <Exec Command="&quot;$(TfCommand)&quot; get /overwrite /force /noprompt &quot;$(Util-VersionProjectFileFullPath)&quot;" Outputs="" />
    <Exec Command="&quot;$(TfCommand)&quot; checkout /lock:checkout &quot;$(Util-VersionProjectFileFullPath)&quot;" Outputs="" />
    <Version Major="$(Util-VersionMajor)" Minor="$(Util-VersionMinor)" Build="$(Util-VersionBuild)" Revision="$(Util-VersionRevision)" RevisionType="None" BuildType="Increment">
      <Output TaskParameter="Major" PropertyName="Util-VersionMajor" />
      <Output TaskParameter="Minor" PropertyName="Util-VersionMinor" />
      <Output TaskParameter="Build" PropertyName="Util-VersionBuild" />
      <Output TaskParameter="Revision" PropertyName="Util-VersionRevision" />
    </Version>
    <XmlUpdate Prefix="msb" Namespace="http://schemas.microsoft.com/developer/msbuild/2003" XPath="/msb:Project/msb:PropertyGroup/msb:Util-VersionMajor" XmlFileName="$(Util-VersionProjectFile)" Value="$(Util-VersionMajor)" />
    <XmlUpdate Prefix="msb" Namespace="http://schemas.microsoft.com/developer/msbuild/2003" XPath="/msb:Project/msb:PropertyGroup/msb:Util-VersionMinor" XmlFileName="$(Util-VersionProjectFile)" Value="$(Util-VersionMinor)" />
    <XmlUpdate Prefix="msb" Namespace="http://schemas.microsoft.com/developer/msbuild/2003" XPath="/msb:Project/msb:PropertyGroup/msb:Util-VersionBuild" XmlFileName="$(Util-VersionProjectFile)" Value="$(Util-VersionBuild)" />
    <XmlUpdate Prefix="msb" Namespace="http://schemas.microsoft.com/developer/msbuild/2003" XPath="/msb:Project/msb:PropertyGroup/msb:Util-VersionRevision" XmlFileName="$(Util-VersionProjectFile)" Value="$(Util-VersionRevision)" />
    <Exec Command="&quot;$(TfCommand)&quot; checkin /override:AutoBuildIncrement /comment:***NO_CI***  &quot;$(Util-VersionProjectFileFullPath)&quot;" />
    <Exec Command="&quot;$(TfCommand)&quot; get /overwrite /force /noprompt &quot;$(Util-AssemblyInfoFile)&quot;" Outputs="" />
    <Exec Command="&quot;$(TfCommand)&quot; checkout /lock:checkout &quot;$(Util-AssemblyInfoFile)&quot;" Outputs="" />
    <AssemblyInfo CodeLanguage="CS" OutputFile="$(Util-AssemblyInfoFile)" AssemblyConfiguration="$(Configuration)" AssemblyVersion="$(Util-VersionMajor).$(Util-VersionMinor).$(Util-VersionBuild).$(Util-VersionRevision)" AssemblyFileVersion="$(Util-VersionMajor).$(Util-VersionMinor).$(Util-VersionBuild).$(Util-VersionRevision)" />
    <Exec Command="&quot;$(TfCommand)&quot; checkin /override:AutoBuildIncrement /comment:***NO_CI***  &quot;$(Util-AssemblyInfoFile)&quot;" />
  </Target> 
```

这里有一些额外的点击技巧[http://weblogs.asp.net/sweinstein/archive/2008/08/24/top-5-secrets-of-net-desktop-deployment-wizards.aspx](http://weblogs.asp.net/sweinstein/archive/2008/08/24/top-5-secrets-of-net-desktop-deployment-wizards.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-30T13:15:00.150

这是我处理这个的方法。首先，我创建了一个包含字符串替换的自定义任务：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using Microsoft.Build.Utilities;
using Microsoft.Build.Framework;

namespace SynchBuild
{
    public class RemoveAsterisk : Task
    {
        private string myVersion;

        [Required]
        public string Version
        {
            set{myVersion = value;}
        }

        [Output]
        public string ReturnValue
        {
            get { return myVersion.Replace("*", ""); }
        }

        public override bool Execute()
        {
            return true;
        }
    }
} 
```

所以它被内置到 SynchBuild.dll 中，您在下面的 UsingTask 中看到了它。现在我尝试覆盖 MinimumRequiredVersion 属性，但它似乎没有被拾取，所以我只是通过在我的 csproj 文件末尾添加以下行来覆盖 GenerateApplicationManifest 目标：

```
<UsingTask AssemblyFile="$(MSBuildExtensionsPath)\WegmansBuildTasks\SynchBuild.dll" TaskName="SynchBuild.RemoveAsterisk" />
  <Target Name="GenerateDeploymentManifest" DependsOnTargets="GenerateApplicationManifest" Inputs="&#xD;&#xA;            $(MSBuildAllProjects);&#xD;&#xA;            @(ApplicationManifest)&#xD;&#xA;            " Outputs="@(DeployManifest)">
    <RemoveAsterisk Version="$(ApplicationVersion)$(ApplicationRevision)">
      <Output TaskParameter="ReturnValue" PropertyName="MinimumRequiredVersion" />
    </RemoveAsterisk>
    <GenerateDeploymentManifest MinimumRequiredVersion="$(MinimumRequiredVersion)" AssemblyName="$(_DeploymentDeployManifestIdentity)" AssemblyVersion="$(_DeploymentManifestVersion)" CreateDesktopShortcut="$(CreateDesktopShortcut)" DeploymentUrl="$(_DeploymentFormattedDeploymentUrl)" Description="$(Description)" DisallowUrlActivation="$(DisallowUrlActivation)" EntryPoint="@(_DeploymentResolvedDeploymentManifestEntryPoint)" ErrorReportUrl="$(_DeploymentFormattedErrorReportUrl)" Install="$(Install)" MapFileExtensions="$(MapFileExtensions)" MaxTargetPath="$(MaxTargetPath)" OutputManifest="@(DeployManifest)" Platform="$(PlatformTarget)" Product="$(ProductName)" Publisher="$(PublisherName)" SuiteName="$(SuiteName)" SupportUrl="$(_DeploymentFormattedSupportUrl)" TargetCulture="$(TargetCulture)" TargetFrameworkVersion="$(TargetFrameworkVersion)" TrustUrlParameters="$(TrustUrlParameters)" UpdateEnabled="$(UpdateEnabled)" UpdateInterval="$(_DeploymentBuiltUpdateInterval)" UpdateMode="$(UpdateMode)" UpdateUnit="$(_DeploymentBuiltUpdateIntervalUnits)" Condition="'$(GenerateClickOnceManifests)'=='true'">
      <Output TaskParameter="OutputManifest" ItemName="FileWrites" />
</GenerateDeploymentManifest>
  </Target> 
```

最终结果是我们获取应用程序版本和修订版，将它们组合起来，删除星号，然后设置所需的最低版本。我在发布属性集中设置了自动递增应用程序版本，这就是递增发生的方式，然后我只是将 minimumrequiredversion 设置为始终匹配。我不使用团队构建，这只是为了让开发人员使用 Visual Studio可以进行所有需要的 clickonce 部署。希望这可以帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-01-10T08:21:55.257

如果您从 Visual Studio 发布 ClickOnce 应用程序，那么只需在您的项目中安装[AutoUpdateProjectsMinimumRequiredClickOnceVersion NuGet 包即可。](https://www.nuget.org/packages/AutoUpdateProjectsMinimumRequiredClickOnceVersion)

如果您从构建服务器或其他脚本发布，则可以使用[Set-ProjectFilesClickOnceVersion PowerShell 脚本](https://github.com/deadlydog/Set-ProjectFilesClickOnceVersion)。我的博客更详细地描述了[如何设置构建服务器以适应发布 ClickOnce 应用程序](http://blog.danskingdom.com/continuously-deploy-your-clickonce-application-from-your-build-server/)。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-10-17T21:30:48.063

您在寻找应用程序更新吗？

右键单击解决方案资源管理器中的项目，然后单击发布... 是获取应用程序更新的错误方法。您必须右键单击您的项目并单击“属性”，然后单击“发布”选项卡。单击更新...按钮，然后选中“应用程序应检查更新”复选框。您还可以在此处指定**应用程序所需的最低版本。**（我没有使用过该功能，但更新功能是我使用 ClickOnce 的核心原因，而且效果很好。）

# java - 适当的 Tomcat 5.5 启动参数来调整 JVM 以适应极高需求的大型堆 Web 应用程序？

> ID：202502
> 
> 赞同：11
> 
> 时间：2008-10-14T19:30:24.173
> 
> 标签：java, tomcat, jvm, performance

我们最近将一个大型、高需求的 Web 应用程序从 Tomcat 4 迁移到 Tomcat 5.5，并注意到一些似乎与 JVM 暂停有关的特殊减速行为。为了在 Tomcat 4 上运行我们的应用程序并支持随时间增加的负载，许多不那么标准的 JVM 参数被设置和调整如下，我希望有 Tomcat JVM 调整经验的人可以评论任何可能有害的事情到 Tomcat 5.5 安装。另请注意，其中一些可能是从以前版本的 Java 继承下来的（我们在 Java 1.6 上使用这些参数成功运行了 Tomcat 4 一段时间，但可能已经引入了一些来帮助 Java 1.4 上的垃圾收集，这是 Java 1.4 的基础。我们的 Tomcat 4 安装了很长时间，现在可能弊大于利）。

一些注意事项：

*   应用程序内存占用约为 1GB，可能略多一些。
*   CPU 不是问题 - 为应用程序服务的所有机器（负载平衡）的 CPU < 30%
*   机器上的物理内存有很多空间。
*   -XX:MaxPermSize=512m 是作为 5.5 升级的一部分添加的唯一参数，它是对内存不足 permgen 空间问题的反应（它已解决）。
*   在 Java 1.6、Solaris 操作系统上运行

-server -Xms1280m -Xmx1280m -XX:MaxPermSize=512m -XX:ParallelGCThreads=20 -XX:+UseConcMarkSweepGC -XX:+UseParNewGC -XX:SurvivorRatio=8 -XX:TargetSurvivorRatio=75 -XX:MaxTenuringThreshold=0 -XX:+ AggressiveOpts -XX:+PrintGCDetails -XX:+PrintGCTimeStamps -XX:-TraceClassUnloading -Dsun.io.useCanonCaches=false -Dsun.net.client.defaultConnectTimeout=60000 -Dsun.net.client.defaultReadTimeout=60000

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-14T20:14:03.197

Java 冠军之一，Kirk Pepperdine 的博客： http: [//kirk.blog-city.com/how_to_cripple_gc_ergonomics.htm](http://kirk.blog-city.com/how_to_cripple_gc_ergonomics.htm)。
引用 1 “GC 文档会告诉你设置会影响什么，但通常不会告诉你会产生什么影响。你走错岔路的最大线索是当你明确设置一个值，然后给 GC 一个提示"

引用 2 “正如我在之前的博客文章中所说，除非有充分的理由，否则不要触摸旋钮。如果您必须触摸旋钮，请小心谨慎，仅使用有助于人体工程学的那些，而不是那些这会削弱人体工程学来满足您的暂停时间和吞吐量目标的能力。”

所以，我建议你回到普通的
-server -Xms1280m -Xmx1280m -XX:MaxPermSize=512m -XX:+UseConcMarkSweepGC -XX:+PrintGCDetails -XX:+PrintGCTimeStamps -XX:-TraceClassUnloading -Dsun.io.useCanonCaches=假 -Dsun.net.client.defaultConnectTimeout=60000 -Dsun.net.client.defaultReadTimeout=60000

看看这是否能给你带来更好的表现。如果是，请坚持下去，
顺便说一句，-XX:MaxPermSize=378m 有什么问题吗？
Java 1.6 的人机工程学比 1.4 好得多。你可能想把它调到低于 1.4
顺便说一句，你试过 Tomcat 6 吗？Tomcat 6 在 Java 6 上的运行比 Tomcat 5.5 好得多。

PS：我使用 Tomcat 已经有一段时间了，通常会尝试让 sun 的 JDK 自由支配，而在这里和那里几乎没有调整。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-14T19:54:06.823

作为一个也在纠结这个问题的人，我当然没有任何明确的答案，尤其是考虑到这种事情是如何特定于应用程序的。您可能已经看到了一个很好的参考，在这里：

[http://java.sun.com/javase/technologies/hotspot/gc/gc_tuning_6.html](http://java.sun.com/javase/technologies/hotspot/gc/gc_tuning_6.html)

但是，这是一个很长的 jvm 参数列表，这表明可能设置了不必要的参数，特别是考虑到您有多个调试选项（PrintGCDetails、PrintGCTimeStamps、TraceClassUnloading），这在生产应用程序上并不好。60 秒超时也可能会占用资源。“服务器”是默认设置，但不会造成任何伤害。

应用程序如何以最少的调整参数（jvm 大小、MaxPermSize）运行？

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-14T20:49:38.520

刚刚从 tomcat 开发人员那里找到了一个关于调整 tomcat 的网络研讨会：http: [//springsource.com/node/555](http://springsource.com/node/555)。网络研讨会的后续行动：http: [//blog.springsource.com/2008/10/14/optimising-and-tuning-apache-tomcat-part-2/](http://blog.springsource.com/2008/10/14/optimising-and-tuning-apache-tomcat-part-2/)

BR，
~A

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-15T13:47:00.793

您可能还想查看更改 Tomcat 用于处理以下请求的最小/最大线程数`conf/server.xml`：

```
<Connector port="8080" maxThreads="150" minSpareThreads="25" maxSpareThreads="75" ... 
```

我在之前的工作中听到的一个经验法则是 maxThreads 应该等于您希望处理的同时连接的数量。我不确定这种说法有多科学，尽管我当然认为这是有道理的，因为您不希望客户端被阻塞等待线程释放以处理他们的请求。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-15T16:55:45.483

也可能值得尝试使用替代 JVM（如 JRockit）来查看垃圾收集模型中的差异是否非常适合您的应用程序。

# jquery - 如何使用 jQuery 将文本发送到 dom 对象？

> ID：202508
> 
> 赞同：0
> 
> 时间：2008-10-14T19:33:09.707
> 
> 标签：jquery, text

与其用 HTML CFM 或​​ PHP 等外部页面填充所说的 DOM 对象，如果我只是想发送文本怎么办？

我试过了：

$("#myDOMObject").val("一些文本");

没有错误，但对象值也不会更新。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-14T19:39:05.717

“myDOMObject”是什么元素？如果是文本输入，您的代码应该可以正常工作。如果是其他东西，请使用`$("#myDOMObject").text("some text");`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-14T19:48:10.970

如果你有一个 DOM 对象，你可以简单地这样做：

```
jQuery(your_dom_object).text('Hello World!'); 
```

但是，既然你无论如何都使用 jQuery，我认为你应该这样做

```
$('#the_id_of_your_dom_object').text('Hello World'); 
```

您可以使用任何 jQuery 查询而不是直接引用对象的 ID。有关更多详细信息，请参阅[jQuery 文档](http://docs.jquery.com)。

# asp.net - 将 jQuery 用于 AJAX 与 ASP.NET Webforms

> ID：202538
> 
> 赞同：61
> 
> 时间：2008-10-14T19:44:48.590
> 
> 标签：asp.net, jquery, ajax, webforms

任何人都知道一个好的文章/教程的链接，用于开始使用 jQuery 进行 AJAX 调用而不是 ASP.NET AJAX？我试图避免在这个应用程序中完全使用 UpdatePanels，这是我过去无法完成的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2010-11-07T19:09:14.493

我找到的关于这个主题的最完整的文章是[ASP.NET 和 jQuery to the Max](https://www.codeproject.com/Articles/95525/ASP-NET-and-jQuery-to-the-Max)。

它避免了更新面板、脚本管理器和视图状态。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-14T19:55:18.817

这里有几个链接：

*   [深入了解 JQuery API（已归档）](https://web.archive.org/web/20090414104717/http://www.highoncoding.com/Articles/407_A%20Look%20Into%20JQuery%20Ajax%20API.aspx)

*   [使用 FireBug Profiler 深入挖掘 MS AJAX 和 JQuery API（已归档）](https://web.archive.org/web/20090609194456/http://azamsharp.com/Posts/83_Using_FireBug_Profiler_to_Dig_Deep_into_MS_AJAX_and_JQuery_API.aspx)

*   [使用 JQuery Ajax API 按需加载（已归档）](https://web.archive.org/web/20090217113039/http://azamsharp.com/Posts/74_On_Demand_Loading_Using_JQuery_Ajax_API.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-05-03T14:27:46.497

Damien Edwards 刚刚在最近的 MIX11 会议上就这个话题发表了精彩的演讲。您可以[在线观看视频（存档 - 单击播放器下方的任何下载链接）](https://web.archive.org/web/20110724072836/http://channel9.msdn.com/events/MIX/MIX11/FRM12)并下载他的代码。他开发了一个 jquery-UI 扩展器项目，其工作方式与 ASP.NET AJAX 工具包的工作方式相同，但只是使用 jQuery 功能扩展了普通控件/标签/元素。该项目位于[CodePlex (archived)](https://web.archive.org/web/20190801214144/https://archive.codeplex.com/?p=jquery)上。

# c# - 使用长参数从 PHP 调用 C# Web 服务

> ID：202540
> 
> 赞同：1
> 
> 时间：2008-10-14T19:45:54.313
> 
> 标签：c#, php, web-services, 64-bit, integer

我们有一个客户试图从 PHP 代码调用我们用 C# 编写的 Web 服务。Web 服务调用需要一个 long as 参数。

此调用适用于从 C# 或 Java 调用的其他客户，但此客户从调用中收到错误消息。我还没有调试过他们的具体调用，但我猜测 64 位整数正在以某种方式从 PHP 中截断。客户说他们只是使用字符串进行 Web 服务调用，但是 PHP 中有一个包装器可以进行类型转换。这会丢失号码信息吗？

感谢您提供任何信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-14T20:09:18.867

大多数 PHP 安装不支持 64 位整数 - 最大值为 32。您可以通过读取 PHP_INT_SIZE 常量（4 = 32 位，8 = 64 位）或读取 PHP_INT_MAX 值来检查这一点。

```
<?php

echo PHP_INT_SIZE, "\n", PHP_INT_MAX;

?> 
```

如果他正在使用的 Web 服务类试图对 64 位整数的字符串表示进行类型转换，那么是的，它很可能被截断或转换为浮点数。您可以通过这个简单的测试看到这种行为

```
<?php

echo intval( "12345678901234567890" );
// prints 2147483647, the max value for a 32 bit signed int. 
```

在不知道他的实现细节的情况下，很难假设一个好的解决方案/解决方法可能是什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-14T23:05:32.397

如果您绝对必须采用这样的大数字，请将其设为字符串，然后在您的 Web 服务中将其转换为 long。

这会稍微打扰您的其他用户，但会使其对使用 PHP 的客户更加友好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-14T23:22:41.787

PHP 残酷地扼杀了它的整数支持，以至于您无法以可预测的方式知道它的特定安装将处理 32 位或 64 位整数。

处理此问题的最简单方法是公开一个接受字符串的新端点，然后将其投射到您的一端。

有关 PHP 史诗般失败的参考：

[http://www.mysqlperformanceblog.com/2007/03/27/integers-in-php-running-with-scissors-and-portability/](http://www.mysqlperformanceblog.com/2007/03/27/integers-in-php-running-with-scissors-and-portability/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-01T01:49:07.187

我写了一篇关于 PHP 使用 nuSoap 调用 C# Web 服务的文章……还没有遇到长 int 转换的问题，但我肯定会运行一些测试，看看我是否应该将它添加到我的文章中。谢谢，肖恩 [http://seanmcilvenna.com/blog/7-general/24-windows-php-development](http://seanmcilvenna.com/blog/7-general/24-windows-php-development)

# wcf - OutgoingWebResponseContext 不显示非英文字符

> ID：202541
> 
> 赞同：0
> 
> 时间：2008-10-14T19:46:47.180
> 
> 标签：wcf, .net-3.5, rest

我们在 .Net 3.5 中使用 WCF 实现了 REST 样式的获取服务。该服务检索研究文件。下面代码中指示的字符串“概要”包含非英语字符，浏览器将其传递为“????????”。

私人无效 ReturnSynopsisInfo（IApiWebOperationContext 上下文，OutgoingWebResponseContext 传出Resp，字符串概要）{ SetResponseHeaders（outgoingResp，HttpStatusCode.OK）；传出Resp.ContentType = "文本/html; charset=UTF-8"; context.Result = new MemoryStream(Encoding.ASCII.GetBytes(synopsis)); }

非常感谢任何建议。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-14T19:50:26.067

您似乎在内容类型标头中将编码声明为 utf-8，但实际上在流中使用 ASCII 编码。ASCII 编码器会默默地将任何非 ascii 字符更改为问号。

您可能想要使用`UTF8Encoding`rater than `ASCIIEncoding`。

# internet-explorer - Silverlight 2 RTW 崩溃 IE7

> ID：202544
> 
> 赞同：1
> 
> 时间：2008-10-14T19:48:48.363
> 
> 标签：internet-explorer, crash, silverlight-2.0

有没有人遇到过这个问题。您安装 Silverlight 2 RTW，然后打开您的旧项目。设计器中的一切都很好。您必须更改 DataGrid 的一些属性，因为“DisplayMemberBinding”已更改为“Binding”。按 F5，在 IEXPLORE.EXE 中收到 Win32 异常。你去查看事件查看器并在日志中看到：

应用程序：IEXPLORE.EXE
CoreCLR 版本：2.0.31005.0
描述：由于 IP 7B8F898E 的 .NET 运行时出现内部错误，退出代码为 8013150a，进程已终止。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-05T19:24:19.030

TextWrapping 没有被删除，它只是 TextWrapping 的一个属性。文档指出“WrapWithOverflow”不再受支持，应改为“Wrap”。我在我的 Silverlight 2 RTW 上有它，它工作正常......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-14T20:32:03.610

好的，

我很高兴报告我想通了。Silverlight 2 RTW 中有许多重大更改，建议您阅读此[文档](http://blogs.msdn.com/silverlight_sdk/attachment/8995057.ashx)。当你编译你的解决方案时，编译器不会告诉你你需要知道的一切，所以它仍然可以构建，但在你运行它时会崩溃。

导致问题的属性是“TextBlock”控件上的“TextWrapping”。该属性已在 RTW 中删除。为什么它会导致浏览器进程崩溃，我不知道，这只是一个简单的 Xaml 解析异常。当我通过在构造函数中设置断点将“App.xaml.cs”放入调试中时，我才发现这一点。

我希望这对其他人有帮助。

干杯!

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-14T20:38:39.353

对于那些想知道...这是我设置断点时收到的异常：

行：453
错误：Sys.InvalidOperationException：控件“Xaml1”中的 ManagedRuntimeError 错误 #4004：System.Windows.Markup.XamlParseException：属性 Property 的属性值 TextWrapping 无效。[Line: 152 Position: 30]
at System.Windows.Application.LoadComponent(Object component, Uri resourceLocator)
at UI.Silverlight.App.InitializeComponent()
at UI.Silverlight.App..ctor()

# windows - 如何找出浏览器的代理设置？

> ID：202547
> 
> 赞同：26
> 
> 时间：2008-10-14T19:49:28.377
> 
> 标签：windows, internet-explorer, firefox, proxy, browser

我正在为 Windows 编写一个命令行工具，它使用 libcurl 从 Internet 下载文件。

显然，当用户在代理服务器后面时，下载不起作用，因为需要配置代理。但是，我希望使我的工具尽可能简单，并且不必让用户承担配置代理的负担。我的工具甚至没有配置文件，因此用户必须在每个命令上传递代理设置，或者设置环境变量或诸如此类的东西——太麻烦了。

所以我想，每个人的浏览器通常都已经正确设置，代理配置和一切。即使是最基本的用户也是如此，否则“他们的互联网将无法正常工作”。

所以我想我可以通过查看 IE 的代理设置来确定是否使用代理。

我该怎么做？进一步来说：

*   Windows 中是否有一组“代理设置”，供所有浏览器（可能是 IE）使用，还是我必须为 IE、Firefox、Opera 等编写不同的例程？
*   我知道如果手动配置它们，我可能可以直接从适当的注册表位置读取值，但这是否也适用于“自动检测代理服务器”？我什至不得不为那个选项而烦恼，或者它（几乎）从未使用过？

在人们开始提出替代方案之前：我正在使用 C，所以我仅限于 Win32 API，我真的很想继续使用 C 和 libcurl。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2008-10-14T22:01:13.930

您正在寻找的函数是 WinHttpGetIEProxyConfigForCurrentUser()，它记录在[http://msdn.microsoft.com/en-us/library/aa384096(VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa384096(VS.85).aspx)中。默认情况下，Firefox 和 Opera 使用此函数来获取它们的代理设置，尽管您可以在每个浏览器中覆盖它们。不过，不要那样做。正确的做法（这是其他人所做的）是获取 IE 设置并假设它们是正确的，因为它们几乎总是正确的。

这是相关逻辑的示例，您应该根据自己的需要进行调整：

```
if( WinHttpGetIEProxyConfigForCurrentUser( &ieProxyConfig ) )
{
    if( ieProxyConfig.fAutoDetect )
    {
        fAutoProxy = TRUE;
    }

    if( ieProxyConfig.lpszAutoConfigUrl != NULL )
    {
        fAutoProxy = TRUE;
        autoProxyOptions.lpszAutoConfigUrl = ieProxyConfig.lpszAutoConfigUrl;
    }
}
else
{
    // use autoproxy
    fAutoProxy = TRUE;
}

if( fAutoProxy )
{
    if ( autoProxyOptions.lpszAutoConfigUrl != NULL )
    {
        autoProxyOptions.dwFlags = WINHTTP_AUTOPROXY_CONFIG_URL;
    }
    else
    {
        autoProxyOptions.dwFlags = WINHTTP_AUTOPROXY_AUTO_DETECT;
        autoProxyOptions.dwAutoDetectFlags = WINHTTP_AUTO_DETECT_TYPE_DHCP | WINHTTP_AUTO_DETECT_TYPE_DNS_A;
    }

    // basic flags you almost always want
    autoProxyOptions.fAutoLogonIfChallenged = TRUE;

    // here we reset fAutoProxy in case an auto-proxy isn't actually
    // configured for this url
    fAutoProxy = WinHttpGetProxyForUrl( hiOpen, pwszUrl, &autoProxyOptions, &autoProxyInfo );
}

if ( fAutoProxy )
{
    // set proxy options for libcurl based on autoProxyInfo
}
else
{
    if( ieProxyConfig.lpszProxy != NULL )
    {
        // IE has an explicit proxy. set proxy options for libcurl here
        // based on ieProxyConfig
        //
        // note that sometimes IE gives just a single or double colon
        // for proxy or bypass list, which means "no proxy"
    }
    else
    {
        // there is no auto proxy and no manually configured proxy
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-01T00:17:57.167

这是一个完整的代码示例，如何在 C# 中从库中调用`WinHttpGetIEProxyConfigForCurrentUser`方法`winhttp.dll`

```
[TestClass]
public class UnitTest1
{
    [StructLayout(LayoutKind.Sequential)]
    public struct WinhttpCurrentUserIeProxyConfig
    {
        [MarshalAs(UnmanagedType.Bool)]
        public bool AutoDetect;
        [MarshalAs(UnmanagedType.LPWStr)]
        public string AutoConfigUrl;
        [MarshalAs(UnmanagedType.LPWStr)]
        public string Proxy;
        [MarshalAs(UnmanagedType.LPWStr)]
        public string ProxyBypass;

    }

    [DllImport("winhttp.dll", SetLastError = true)]
    static extern bool WinHttpGetIEProxyConfigForCurrentUser(ref WinhttpCurrentUserIeProxyConfig pProxyConfig);

    [TestMethod]
    public void TestMethod1()
    {
        var config = new WinhttpCurrentUserIeProxyConfig();

        WinHttpGetIEProxyConfigForCurrentUser(ref config);

        Console.WriteLine(config.Proxy);
        Console.WriteLine(config.AutoConfigUrl);
        Console.WriteLine(config.AutoDetect);
        Console.WriteLine(config.ProxyBypass);
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-14T20:11:46.570

当然，您可以直接访问这些值的注册表项。您也可以在 .NET 中轻松完成此操作。我相信 WebClient 对象会根据当前设置为您协商代理设置。这在 C# 中看起来像这样：

```
using System.Net;

string url = "http://www.example.com";
WebClient client = new WebClient();
byte[] fileBuffer = client.DownloadFile(url); 
```

或者类似的东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-23T05:48:30.940

对于 Firefox/Seamonkey，由于存在许多配置文件，这个问题有点棘手。

如果您想假设只有一个配置文件，那么您只需要找到 prefs.js。您解析 network.proxy.type，然后使用它来决定要读取哪些相关值。

我正在为 mozilla 编写一些文档，因此请将您的后续问题放在此处（选中 wiki 框），我会尽力为您提供所需的信息。

# c++ - 在 C++ 中解析 iCal/vCal/Google 日历文件

> ID：202549
> 
> 赞同：1
> 
> 时间：2008-10-14T19:49:59.780
> 
> 标签：c++, mfc, icalendar, google-calendar-api, vcalendar

谁能推荐一个与 C/C++/MFC/ATL 兼容的即用型类/库，可以解析 iCal/vCal/Google 日历文件（重复出现）？它可以是免费的或商业的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-14T21:38:04.587

PHP 中有一个[iCal 解析器](http://www.phpclasses.org/browse/package/3278.html)，您可以下载并检查代码以适合您的语言。

对于 vCal/vCard 解析[，有一个 C Library](http://sourceforge.net/projects/ccard)。

对于谷歌日历，我找不到任何确切的答案，所以，尝试谷歌它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-15T02:15:58.550

对于 vCal，您可以尝试 SourceForge 上的[CCard](http://ccard.sourceforge.net/)项目：http: [//sourceforge.net/projects/ccard](http://sourceforge.net/projects/ccard)

它是一个 C 库，但它声明 Windows 是受支持的平台。

*编辑：balexandre 已经链接到它:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-18T09:51:20.173

CCard 项目的唯一问题是它是一个通用解析器（类似于我自己已经实现的解析器）——对我来说真正有价值的是“理解”所有类型的重复等等。vCal 和 iCal 之间也存在差异，从而增加了复杂性。

# visual-studio - 当程序集在 GAC 中时，Visual Studio 单元测试会抛出 MissingMethodException？

> ID：202551
> 
> 赞同：1
> 
> 时间：2008-10-14T19:52:13.613
> 
> 标签：visual-studio, gac

我的应用程序包含一段在组件服务内部执行的代码，因此我们需要在 GAC 中注册我们的业务规则层（及其依赖项）。这些依赖项之一是 FooCore.dll，它包含对整个应用程序可见的类和服务。

一切正常，直到我在 FooCore 的一个类中添加了一个新方法。现在，当我运行单元测试时，任何调用此新方法的测试都会引发 MissingMethodException，即使我使用最新版本的程序集更新了 GAC。唯一的解决方法是在运行测试之前从 GAC 中删除 FooCore。

我尝试了以下事情：

*   重建整个解决方案，刷新 GAC 中的内容，然后运行测试 = 失败
*   在测试项目中删除并重新添加了 FooCore 程序集引用 = 失败
*   确保 FooCore 在 properties = failure 中设置为“Copy Local”

我可以做些什么来确保 VSTS 从其明确定义的位置而不是从 GAC 加载引用的程序集？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-14T19:56:22.577

进一步的研究[在这个问题上出现了这个论坛主题](http://social.msdn.microsoft.com/Forums/en-US/vststest/thread/c7491db9-4b1c-46b8-800c-9b35d2691c8b/)，其中有人认为这可能是由于 VS2008 的性能分析功能保留了一个过时的程序集版本。

我能够通过以下方式解决我的问题：

1.  然后重建我的解决方案
2.  刷新 GAC 中的所有内容，然后
3.  在我的测试项目中删除并重新添加程序集引用，然后
4.  关闭并重新打开 Visual Studio 2008

我不确定其中哪些步骤是明确必要的，但这种“厨房水槽”方法为我解决了这个问题。

更新：[这篇 Microsoft 文章](http://msdn.microsoft.com/en-us/library/ez524kew(VS.80).aspx)指出，在编译解决方案时，GAC 中的程序集永远不会复制到输出 bin\ 文件夹中，即使“复制本地”设置为 true。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-23T14:28:56.223

就我而言，我有两个位置不同的相同（几乎）程序集。测试项目引用了第一个程序集，而 UnitTest 项目引用了第二个程序集（它们完全一样）。

因此，请仔细检查所有项目参考资料。

# c - 你如何获得指向 .text 部分的指针？

> ID：202552
> 
> 赞同：6
> 
> 时间：2008-10-14T19:52:38.887
> 
> 标签：c, embedded

您如何从该程序中获取指向该程序内存的 .text 部分的指针？作为在后台运行的连续自检的一部分，我还需要该部分的长度来进行“闪存到内存”比较。

该工具集会自动为我正在使用的工具生成链接器 .cmd 文件，而我正在使用的板的板支持包要求我使用生成的 .cmd 文件而不是自己制作。（也没有制作文件来添加一个脚本来处理它。）

编辑：我正在使用代码编写器 3.1 环境使用 TI TMS 6713 DSP。我使用的卡是由我们的客户签约并由另一个组织生产的，所以我无法向您指出任何有关它的信息。然而，BSP 依赖于 TI 的“DSP BIOS”配置工具，如果不深入研究超出范围的工作，我真的无法过多地捏造设置。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-14T20:00:15.860

您需要将“变量”放在链接描述文件中。

在我的一个项目中，我的一个部分中有这个：

```
 __FlashStart = .; 
```

在 C 程序中，我有这个：

```
extern unsigned long int _FlashStart;
unsigned long int address = (unsigned long int)&_FlashStart; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-15T03:47:55.510

如果您可以修改链接描述文件，那肯定会更容易。由于您不能，因此可以从程序二进制文件中提取部分名称、地址和大小。例如，以下是使用 libbfd 检查所有代码段的方法。

```
#include <bfd.h>

bfd *abfd;
asection *p;
char *filename = "/path/to/my/file";

if ((abfd = bfd_openr(filename, NULL)) == NULL) {
    /* ... error handling */
}

if (!bfd_check_format (abfd, bfd_object)) {
    /* ... error handling */
}

for (p = abfd->sections; p != NULL; p = p->next) {
    bfd_vma  base_addr = bfd_section_vma(abfd, p);
    bfd_size_type size = bfd_section_size (abfd, p);
    const char   *name = bfd_section_name(abfd, p);
    flagword     flags = bfd_get_section_flags(abfd, p);

    if (flags & SEC_CODE) {
        printf("%s: addr=%p size=%d\n", name, base_addr, size);
    }
} 
```

如果您只想查看 .text 段，则可以使用 strcmp 来查看段名。

这种方法的缺点是什么？Libbfd 是在 GPL 下获得许可的，因此您的整个项目都将受到 GPL 的约束。对于商业项目，这可能是一个非首发。

如果您的二进制文件是 ELF 格式，则可以改用 libelf。我不熟悉 libelf API 的工作原理，因此无法提供示例代码。Linux libelf 也是 GPL，但我相信 BSD 项目有自己的 libelf 供您使用。

**编辑：**当您在最小的实时操作系统环境中使用 DSP 时，这个答案是行不通的。对不起，我试过了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-15T04:12:52.167

您能否阐明您感兴趣的工具链和架构。

在我现在使用的编译器（IAR ARM C/C++）上，编译器内置了一些运算符，它们返回段开始地址`__sfb(...)`、段结束地址`__sfe(...)`和段大小`__sfs(...)`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-15T21:36:32.873

您要查找的符号是`__text__`和`__etext__`分别指向该`.text`部分的开头和结尾。

您可能会发现生成的`.map`文件很有用，因为它列出了应用程序中定义的所有符号和部分。

# html - 网页的最佳绝对宽度是多少？

> ID：202557
> 
> 赞同：27
> 
> 时间：2008-10-14T19:55:17.727
> 
> 标签：html, css, layout

假设不能选择流畅的布局（因为这是一个不同的讨论），站点布局的推荐宽度是多少？不同尺寸的优缺点是什么？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2008-10-14T20:00:55.593

我一直保持`960px`它在 上可见`1024x768`，并且可以被 2、3、4、5、6、8、10、12、15、16、20、24、30、32、40、48、60 整除， 64, 80, 96, 120, 160, 192, 240, 320 和 480 ......所以我可以干净地分割我的网站设计（使用三分法）。

**几年后编辑：**如果您不能使用流畅的布局， 请考虑使用[CSS 媒体查询使您的内容能够响应现在无数的设备。](https://developer.mozilla.org/en/CSS/Media_queries)我不确定是否可以在 2012 年声称一个像素宽度来统治它们。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-10-14T20:01:03.673

查看[http://browsersize.com](http://browsersize.com)，了解用户现在使用的屏幕分辨率的一些快速统计信息。您可以使用[http://setmy.browsersize.com](http://setmy.browsersize.com)快速调整浏览器大小，以模拟以特定屏幕分辨率查看您的网站。确保您的布局至少满足最广泛使用的屏幕分辨率 (1024 x 768)。

此外，不一定要占用最大的水平空间。理想情况下，文本的宽度（每行的字数）不应超过某个可用性阈值：

> 在非常常见的 1024×768 屏幕分辨率下，大多数固定布局的网站不会使用其内容左右两侧的所有可用空间。灵活的布局可以更好地利用水平空间，但很难保持可用的行长。可用性专家告诉我们，你应该在一行上写这么多字。8 到 12 个单词似乎是理想的行长。印刷媒体，尤其是报纸，毫不犹豫地使用更短的行。为什么？因为他们可以通过在多列中布置文本。

[http://www.alistapart.com/articles/css3multicolumn](http://www.alistapart.com/articles/css3multicolumn)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-14T19:57:02.980

如果您使用的固定宽度比**可能**访问您网站的最小屏幕宽，您会惹恼和挫败必须横向滚动才能访问其余内容的用户。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-14T20:00:10.820

曾经是`800px`；然而，越来越多的网站开始使用`1000px`. 这是因为访问者的低端分辨率通常为`1024x768`. 额外的 24 像素为您可能想要操作的浏览器镶边、填充和边距等留出了空间。

只是为了给出一些观点，即使是新一波的小屏幕上网本也有`1024x768`.

但是，最重要的是，按照@warren 的建议了解您的受众并加以利用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-14T20:30:01.463

我还使用 950 到 980px 之间的布局，并且始终居中，除非客户另有要求 :)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-01-15T01:22:49.073

1.  请记住，统计中经常引用的*显示器分辨率*不一定与*浏览器窗口的内部宽度*相同。用户可能有额外的侧边栏/工具栏，使用非最大化的浏览器窗口。屏幕越大，您就越不可能只在一页上使用它。

2.  很长的文本行更难阅读。最佳值是 25-30em（取决于许多因素，但您不应该简单地追求最大值）。

3.  移动浏览器具有用于缩放的“虚拟”屏幕分辨率，在 Opera Mini/Mobile 和 Mobile Safari 中约为 960 像素。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-04-20T15:40:07.287

我在此投票支持该议案。仅仅因为屏幕尺寸是 X 并不意味着 X 或任何接近它的东西是您网站的最佳设计。

您的网站目的与您选择的宽度有很大关系。

许多营销专家认为，更窄的列将更多的访问“转化”为销售。也许这是因为如果页面很窄，更容易引导人们的注意力。

另一方面，专门用于图像的站点应该以每个访问浏览器的最佳可用分辨率显示。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-14T20:18:17.757

您可以尝试开发多个布局并使用 Javascript 根据访问者的 window.innerWidth 在它们之间切换

也就是说，我通常使用 950px 到 980px 之间的东西。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-06-18T22:15:53.837

当与台式机和笔记本电脑相关时，获得最佳性能和跨显示器兼容性的最大网站宽度为 960 像素。

有关方式和原因的更多详细信息，请参阅以下文章：

[屏幕尺寸和分辨率](https://graphicdesign.stackexchange.com/questions/30731/what-width-should-i-design-for-when-creating-a-website)

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2008-10-14T20:00:49.867

根据[这些](http://www.w3schools.com/browsers/browsers_display.asp)统计数据，至少 1024 像素宽将覆盖大多数用户。

# c# - 我什么时候应该写静态方法？

> ID：202560
> 
> 赞同：17
> 
> 时间：2008-10-14T19:56:18.317
> 
> 标签：c#, oop

所以我了解什么是静态方法或字段，我只是想知道何时使用它们。也就是说，在编写代码时，哪些设计适合使用静态方法和字段。

一种常见的模式是将静态方法用作静态工厂，但这也可以通过重载构造函数来轻松实现。正确的？例如：

```
var bmp = System.Drawing.Bitmap.LoadFromFile("Image01.jpg"); 
```

至于静态字段，创建单例对象是他们的最佳用途吗？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-10-14T20:04:25.400

静态方法通常对于不需要来自类实例（from `this`）的任何数据的操作很有用，并且可以仅使用它们的参数来执行其预期目的。
一个简单的例子是`Point::distance(Point a, Point b);`计算两点之间的距离并且不需要实例的方法。

静态字段对于不经常更改并且被类的所有实例使用的常量非常有用。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-10-14T20:01:23.050

当您使用静态工厂时，它可以更好地了解意图 - 它还允许您拥有不同的工厂，它们采用相同的参数类型但具有不同的含义。例如，想象一下如果 Bitmap 有 LoadFromResource(string) - 不可能有两个都接受字符串的构造函数。

**编辑**：来自评论中的stevemegson

> 静态工厂也可以返回 null，并且可以更轻松地返回它从缓存中获取的实例。我的许多类都有一个静态的 FromId(int) 来从主键获取一个实例，如果我们有一个缓存实例，则返回一个现有的缓存实例。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-10-14T20:04:51.980

只要你有独立于实例状态的函数，我就会说使用静态方法，即。不依赖于任何实例字段。

方法所依赖的非本地状态越少，就越容易理解，因此`static`对代码读者来说是一个有用的信号。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-10-14T20:09:59.287

我通过记住实例方法在单个对象上/内部工作而静态方法为类做一些事情来保持清楚。

在 LoadFromFile() 的情况下，您需要一个静态方法，因为如果加载失败，您需要一个空引用 - 实例还不存在。如果您将其实现为构造函数，则必须在失败时抛出异常。

静态的其他良好用途：Compare(obj a, obj b)，Delete(obj a) 用于数据对象（一个对象不能删除自己，因为它的引用仍然存在），或者静态类，用于实际上不能的过程代码在对象中建模。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2018-04-03T10:51:05.847

当方法不属于特定对象时使用静态方法。

例如，如果您查看 .NET 框架中的 Math 类，您会发现所有方法都是静态的。为什么？因为没有理由必须创建一个对象才能使用这些方法。`Math`当您想要的只是某物的绝对值时，为什么要创建该类的对象 ？不，没有理由这样做，因此该方法是静态的。

所以当你设计一门课时，问问自己：

这个方法是属于一个对象，还是属于类本身？

一个方法属于一个对象，如果它修改了对象的状态。如果该方法不修改特定对象，则它很可能是静态的。

另一个例子，假设你想知道一个类有多少个对象被创建（不要问我为什么......）。对于这个任务，您可以创建一个静态方法`GetNumberOfObjects()`（显然您需要一个静态字段，以及构造函数中的一些代码）。你可能会问，我为什么要让它是静态的。那么，回答上面的问题，你会看到。该方法不属于任何特定对象。此外，它不会修改任何对象。

我希望这是有道理的。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-15T06:36:27.883

只要您有一个不依赖于该类的特定对象的函数，就应该使用静态方法。

添加 static 关键字并没有什么坏处：它不会破坏任何引用它的代码。因此，例如，无论您是否具有“静态”关键字，以下代码都是有效的：

```
class Foo
{
    public Foo(){}
    public static void bar(){}  // valid with or without 'static'
    public void nonStatic(){ bar(); }
}

...
Foo a = new Foo();
a.bar(); 
```

因此，您应该将“静态”添加到您可以使用的任何方法中。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-14T20:34:34.433

以下是您可能希望使用静态方法的一些示例：

1) 当函数不使用任何成员变量时。您不必在这里使用静态方法，但如果这样做通常会有所帮助。

2) 使用工厂方法创建对象时。如果您事先不知道要创建的类型，则它们尤其必要：例如

```
class AbstractClass {
    static createObject(int i) {
        if (i==1) {
           return new ConcreteClass1();
        } else if (i==2) {
           return new ConcreteClass2();
        }
     }
} 
```

3）当您控制或以其他方式跟踪类的实例化数量时。Singleton 是最常用的例子。

4) 声明常量时。

5) 诸如排序或比较之类的操作，它们对一个类的多个对象进行操作，并且不依赖于任何特定实例。

6) 在对象的第一次实例化之前必须进行特殊处理时。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-14T20:14:05.957

当类的客户端没有要使用的类的实例时，您可以使用静态方法。例如，单例设计模式用于确保系统中只存在一个类的一个实例。它要求 Singleton 的构造函数是私有的，这样客户端就不能创建任何实例。

那么如果你不能创建一个实例，你如何访问类的实例方法呢？通过调用返回类的 Singleton 实例的静态方法。

这当然只是一种情况，但还有很多其他情况。

# browser - 全屏 Direct3D 应用程序中的 Web 浏览器

> ID：202567
> 
> 赞同：3
> 
> 时间：2008-10-14T19:58:10.247
> 
> 标签：browser, direct3d

我需要在全屏 Direct3D 应用程序中有一个正常工作的 Web 浏览器。例如，当您加入服务器时，Valve 的基于 Source 的游戏（有点）在 MotD 窗口中执行此操作。关于在哪里看的任何提示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-14T20:31:05.533

Second Life 使用 ubrowser ( [http://ubrowser.com/](http://ubrowser.com/) ) 在 3D 世界中嵌入浏览器。由于源代码可用于 Second Life 客户端 ( [http://wiki.secondlife.com/wiki/Get_source_and_compile](http://wiki.secondlife.com/wiki/Get_source_and_compile) )，这将是一个了解他们如何完成它的好地方。

但是请注意，他们使用的是 OpenGL，而不是 Direct3D……但 ubrowser 本身并没有什么特定于 OpenGL 的。

# perl - Perl & mod_fcgid - 我如何确定它工作正常？

> ID：202578
> 
> 赞同：4
> 
> 时间：2008-10-14T20:02:15.763
> 
> 标签：perl, fastcgi, mod-fcgid

我有几个即将公开的 Perl 脚本，我想确保它们能够运行`mod_fcgid`，以尽可能降低服务器负载。以前，我只运行过测试 FastCGI 的脚本（即，`while ( my $q = new CGI::Fast ) { $count++; echo $count;})`或利用声称作为 FCGI 运行的较大 Perl 包（如 MovableType），只要您`mod_fcgid`正确设置 Apache 和 FastCGI/ 并将文件后缀更改为“ `.fcgi`”。

所以，这是我的问题：除了更改脚本的文件后缀之外，我还需要做任何事情吗？如果需要，怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-15T01:58:35.450

您需要安装 FastCGI 并配置您的 Apache 以使用它，但我假设您知道这一点。要测试您的代码是否实际上在 FCGI 而不是常规 CGI 下运行，您可以使用`IsFastCGI`来自[FCGI](http://search.cpan.org/~skimo/FCGI-0.67/FCGI.PL)请求对象的方法，CGI::Fast 在后台使用该方法。

```
use FCGI;

my $request = FCGI::Request();
if ( $request->IsFastCGI ) { 
    print "we're running under FastCGI!";
} else { 
    print "plain old boring CGI";
} 
```

# java - 最好的免费 Java .class 查看器？

> ID：202586
> 
> 赞同：24
> 
> 时间：2008-10-14T20:04:29.393
> 
> 标签：java, decompiling

我用过[DJ Java Decompiler](http://members.fortunecity.com/neshkov/dj.html)，它有一个方便的 GUI，但似乎最新版本只是试用版，并迫使你在几天后购买该软件（我记得大约一年前使用过早期的免费版本在以前的工作中）。

我知道 Jad 和 Jadclipse，但我喜欢 DJ Java Decompiler 的地方在于它与 Windows 资源管理器集成 - 所以我可以简单地在 WinRAR 之类的东西中打开一个 JAR，浏览这些包，然后双击一个 . class 文件以查看它的反编译源。

谁能推荐其他好的、免费的 .class 查看器？我想到的标准是：

*   基于图形用户界面
*   集成到 Windows 资源管理器（所以我不必像 JAD 那样运行一些命令行选项）
*   可选 - 还可以显示原始 JVM 字节码命令

换句话说 - 我想尽可能地找到最接近[.NET Reflector](http://www.red-gate.com/products/reflector/index.htm) for Java 的东西。

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2008-12-19T17:09:14.003

JAD 是当今最好的 Java 反编译器之一。这是一款出色的软件。尽管如此，JAD 1.5.8（2001 年 4 月 14 日）支持的最后一个 JDK 是 JDK 1.3。

DJ Java Decompiler、JadClipse、Cavaj 和 JarInspector 由 Jad 提供支持。Decafe Pro 的最后一个版本已于 2002-01-03 发布。

这些查看器无法显示 Java 5 源代码。

所以，我使用[JD-GUI](http://jd.benow.ca/)：逻辑，我是作者 :)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-06-20T12:16:17.433

**[Procyon](https://github.com/mstrobel/procyon/wiki/Java-Decompiler)**是一个新的开源反编译器，在大多数情况下已经超过了 JD-GUI。它是用 Java 编写的，装在一个独立的 jar 中。它由 StackOverflow 自己的[Mike Strobel](https://stackoverflow.com/users/175070/mike-strobel)积极开发。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-14T20:32:23.347

如果源不可用， Eclipse 将允许您[查看 classes 的字节码](http://archive.eclipse.org/eclipse/downloads/drops/R-3.3-200706251500/whatsnew/eclipse-news-part2.html)（搜索“disassembled bytecodes”）。

[看来这里](http://asm.objectweb.org/eclipse/index.html)还有一个使用 asm 的第三方插件。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-14T20:09:34.950

StackOverflow 上有另一个线程链接到[http://java.decompiler.free.fr/](http://java.decompiler.free.fr/)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-21T05:51:19.677

试试[JDGUI](http://java.decompiler.free.fr/)简单、轻量、快速

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-14T20:14:00.153

[罐子检查器](http://www.codeland.org/)

> Jar Inspector 是一个易于使用但功能强大的 Mac OS X jar 文件编辑器。它允许您轻松查看、编辑和反编译 jar 文件的内容。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-14T20:53:42.117

我用[cavaj](http://www.bysoft.se/sureshot/cavaj/)

我以前用过[Decafe Pro](http://www.versiontracker.com/dyn/moreinfo/win/9491)（现在找不到官方网站了），但免费版不会让你剪切-n-粘贴。

它们都是 JAD 的前端，因此它们在反编译功能方面具有相同的特性和限制。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-15T01:06:15.227

这些反编译器中有许多是基于 Jad 的：

*   [http://www.kpdus.com/jad.html](http://www.kpdus.com/jad.html)

我喜欢 JadClipse Eclipse 插件：

*   [http://sourceforge.net/projects/jadclipse](http://sourceforge.net/projects/jadclipse)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-11-12T01:58:10.483

我刚刚发布了一个独立的 Java Decompiler GUI（基于 Jad），您可以从 Util [Java Decompiler (JAD based) v1.0获得它](http://diniscruz.blogspot.co.uk/2012/11/util-java-decompiler-jad-based-v10exe.html)

这是一个基于 Windows 的 .NET 4.0 应用程序，它支持拖放 *.jar 文件。

它没有与 Window Explorer 集成，但由于它基于一个简单的 C# 脚本，并且代码是开源的，也许您可​​以添加该功能 :)

另一个想法是添加对其他免费 java 反编译器的支持。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-06-20T05:38:16.190

有一个免费的[Java 类查看器](https://github.com/amosshi/freeinternals)，我们可以`.class`交互地逐字节检查 Java 文件二进制数据。单击左侧文件结构的每个树节点时，`class`右侧会突出显示相应的字节数据。

这里有[一篇文章](https://www.codeproject.com/Articles/35915/Java-Class-Viewer)详细描述了 Java 类查看器的源代码。

[![Java 类查看器](https://i.stack.imgur.com/iRzCg.png)](https://i.stack.imgur.com/iRzCg.png)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-06-20T05:51:11.930

我使用 cavaj，安装简单，并为您提供了非常好的课程概述，eclipse 风格。

# .net - 是否可以在调用 Web 服务时覆盖 .NET 客户端的默认超时？

> ID：202588
> 
> 赞同：0
> 
> 时间：2008-10-14T20:04:58.220
> 
> 标签：.net, web-services, timeout

我希望 Web 服务代理类等待 2 分钟以上

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-16T19:02:14.883

需要考虑两件事 - 是的，TheSoftwareJedi 关于在代理上设置 Timeout 属性是正确的 - 很简单。其默认值为 100 秒。

您还必须意识到 IIS 也将具有超时设置，如果达到，它将覆盖 c# 设置。IIS 默认值为 120 秒。

因此，在代理上设置超时属性将使您在开始达到 IIS 超时之前再延长 20 秒。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-14T20:05:33.087

只需在代理上设置[超时属性](http://msdn.microsoft.com/en-us/library/system.web.services.protocols.webclientprotocol.timeout.aspx)

# sql-server - 将搜索文本规范化为全文搜索和 where 条件

> ID：202602
> 
> 赞同：-1
> 
> 时间：2008-10-14T20:09:26.807
> 
> 标签：sql-server, full-text-search

您想要的是用户只需像在 Google 中一样输入他们的搜索条件。一些单词，可能是一些引用的短语，可能是一些运算符，然后让它正常工作。

.Net 解决方案可在此处获得： [http ://ewbi.blogs.com/develops/2007/05/normalizing_sql.html](http://ewbi.blogs.com/develops/2007/05/normalizing_sql.html)

我正在寻找一个也支持 where 的纯 T-SQL 版本。（或 VbScript/javascript）

示例：“狗”粮价格：20..45

应该看起来像这样（对于 mssql）： select * from table t join containstable(desc, '"dog" and food*') k on k.key=t.id where t.price 在 20 到 45 之间

运算符：and、or、near、""、not、* 等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-16T16:23:26.847

如果不编写一个完整的解析器，该解析器使用数据库中存在的表关系和列数据类型进行编程，我看不出你怎么能拥有这个功能。

# javascript - 重复字符串 - Javascript

> ID：202605
> 
> 赞同：275
> 
> 时间：2008-10-14T20:10:18.087
> 
> 标签：javascript, string

返回重复任意次数的字符串的最佳或最简洁的方法是什么？

以下是我迄今为止最好的镜头：

```
function repeat(s, n){
    var a = [];
    while(a.length < n){
        a.push(s);
    }
    return a.join('');
} 
```

* * *

## 回答 #1

> 赞同：409
> 
> 时间：2008-10-14T20:17:25.387

> **新读者注意：**这个答案很旧，而且不是很实用——它只是“聪明”，因为它使用 Array 的东西来完成 String 的事情。当我写“更少的过程”时，我绝对指的是“更少的代码”，因为正如其他人在随后的答案中所指出的那样，它的表现就像一头猪。因此，如果速度对您很重要，请不要使用它。

我会直接把这个函数放到 String 对象上。无需创建一个数组，填充它，然后用一个空字符连接它，只需创建一个适当长度的数组，然后用你想要的字符串连接它。相同的结果，更少的过程！

```
String.prototype.repeat = function( num )
{
    return new Array( num + 1 ).join( this );
}

alert( "string to repeat\n".repeat( 4 ) ); 
```

* * *

## 回答 #2

> 赞同：209
> 
> 时间：2011-03-27T15:12:49.680

我已经测试了所有提议的方法的性能。

这是我得到**的最快的变种。**

```
String.prototype.repeat = function(count) {
    if (count < 1) return '';
    var result = '', pattern = this.valueOf();
    while (count > 1) {
        if (count & 1) result += pattern;
        count >>= 1, pattern += pattern;
    }
    return result + pattern;
}; 
```

或作为**独立**功能：

```
function repeat(pattern, count) {
    if (count < 1) return '';
    var result = '';
    while (count > 1) {
        if (count & 1) result += pattern;
        count >>= 1, pattern += pattern;
    }
    return result + pattern;
} 
```

它基于[artistoex](https://stackoverflow.com/users/345520/artistoex)算法。它真的很快。`count`与传统`new Array(count + 1).join(string)`方法 相比，它越大，速度越快。

我只改变了两件事：

1.  替换`pattern = this`为`pattern = this.valueOf()`（清除一种明显的类型转换）；
2.  添加了`if (count < 1)`从[prototypejs](http://www.prototypejs.org/api/string/times)到函数顶部的检查，以排除这种情况下不必要的操作。
3.  [Dennis](https://stackoverflow.com/users/1913959/dennis) [answer](https://stackoverflow.com/a/14026829/489553)的应用优化（加速 5-7%）

**UPD**

[在这里](http://jsfiddle.net/disfated/GejWV/)为感兴趣的人创建了一个小的性能测试游乐场。

*变量`count`〜0 .. 100：*

[![性能图](https://i.stack.imgur.com/i6JSb.png)](https://i.stack.imgur.com/i6JSb.png)

*常数`count`= 1024：*

[![性能图](https://i.stack.imgur.com/jidKX.png)](https://i.stack.imgur.com/jidKX.png)

如果可以的话，使用它并让它更快:)

* * *

## 回答 #3

> 赞同：50
> 
> 时间：2013-07-23T02:44:38.620

这个问题是 JavaScript 的一个众所周知的/“经典”优化问题，原因是 JavaScript 字符串是“不可变的”，并且通过将单个字符连接到字符串来添加需要创建，包括内存分配和复制到，一个全新的字符串。

不幸的是，此页面上接受的答案是错误的，其中“错误”意味着简单的单字符字符串的性能因子为 3 倍，短字符串重复多次的性能因子为 8x-97x，重复句子的性能因子为 300x，并且无限错误时将算法的复杂度比率限制为`n`无穷大。此外，此页面上还有另一个答案几乎是正确的（基于过去 13 年在互联网上流传的正确解决方案的许多代和变体之一）。然而，这个“几乎正确”的解决方案错过了正确算法的关键点，导致性能下降 50%。

[已接受答案的 JS 性能结果、表现最佳的其他答案（基于此答案中原始算法的降级版本）以及使用我 13 年前创建的算法的此答案](http://jsperf.com/repeating-strings "已接受答案、表现最佳的其他答案和此答案的 JS 性能结果")

~ 2000 年 10 月，我为这个确切的问题发布了一个算法，该算法被广泛改编、修改，但最终却鲜为人知并被遗忘。为了解决这个问题，我在 2008 年 8 月发表了一篇文章[http://www.webreference.com/programming/javascript/jkm3/3.html](http://www.webreference.com/programming/javascript/jkm3/3.html)解释了算法并将其用作简单的通用 JavaScript 优化示例。到目前为止，*Web Reference*已经从这篇文章中删除了我的联系信息，甚至我的名字。再一次，该算法已被广泛改编、修改，然后却鲜为人知，并在很大程度上被遗忘了。

> Joseph Myers 的原始字符串重复/乘法 JavaScript 算法，大约在 Y2K 作为 Text.js 中的文本乘法函数；2008 年 8 月由 Web Reference 以这种形式发表： [http](http://www.webreference.com/programming/javascript/jkm3/3.html) : //www.webreference.com/programming/javascript/jkm3/3.html名称“stringFill3”）

```
/*
 * Usage: stringFill3("abc", 2) == "abcabc"
 */

function stringFill3(x, n) {
    var s = '';
    for (;;) {
        if (n & 1) s += x;
        n >>= 1;
        if (n) x += x;
        else break;
    }
    return s;
} 
```

在那篇文章发表后的两个月内，同样的问题被发布到 Stack Overflow 并一直在我的雷达下飞行，直到现在，显然这个问题的原始算法再次被遗忘了。此 Stack Overflow 页面上可用的最佳解决方案是我的解决方案的修改版本，可能由几代人分开。不幸的是，这些修改破坏了解决方案的最优性。事实上，通过改变我原来的循环结构，修改后的解决方案执行了一个完全不需要的额外的指数复制步骤（因此将正确答案中使用的最大字符串与自身连接额外的时间，然后丢弃它）。

下面将讨论与此问题的所有答案相关的一些 JavaScript 优化，并为所有人谋福利。

## 技巧：避免引用对象或对象属性

为了说明这种技术是如何工作的，我们使用一个真实的 JavaScript 函数来创建所需长度的字符串。正如我们将看到的，可以添加更多优化！

像这里使用的功能是创建填充以对齐文本列、格式化货币或将块数据填充到边界。文本生成函数还允许可变长度输入，以测试对文本进行操作的任何其他函数。该函数是 JavaScript 文本处理模块的重要组成部分之一。

随着我们的继续，我们将介绍另外两种最重要的优化技术，同时将原始代码开发为用于创建字符串的优化算法。最终结果是一个工业级的高性能函数，我在任何地方都使用过——在 JavaScript 订单表单、数据格式和电子邮件/文本消息格式以及许多其他用途中对齐项目价格和总计。

**创建字符串的原始代码`stringFill1()`**

```
function stringFill1(x, n) { 
    var s = ''; 
    while (s.length < n) s += x; 
    return s; 
} 
/* Example of output: stringFill1('x', 3) == 'xxx' */ 
```

这里的语法很清楚。如您所见，在进行更多优化之前，我们已经使用了局部函数变量。

请注意，`s.length`代码中有一个对对象属性的无害引用会损害其性能。更糟糕的是，使用这个对象属性会假设读者知道 JavaScript 字符串对象的属性，从而降低了程序的简单性。

该对象属性的使用破坏了计算机程序的通用性。该程序假定它`x`必须是长度为 1 的字符串。这将`stringFill1()`函数的应用限制为除了单个字符的重复之外的任何内容。如果它们包含多个字节，例如 HTML 实体，即使单个字符也不能使用`&nbsp;`。

这种不必要地使用对象属性导致的最严重问题是，如果在空输入字符串上进行测试，该函数会创建一个无限循环`x`。要检查一般性，请将程序应用于尽可能少的输入。当被要求超过可用内存量时崩溃的程序有一个借口。像这样的程序在被要求不产生任何内容时崩溃是不可接受的。有时漂亮的代码是有毒的代码。

简单性可能是计算机编程的一个模棱两可的目标，但通常不是。当一个程序缺乏任何合理的通用性水平时，说“程序就其发展而言已经足够好”是无效的。如您所见，使用该`string.length`属性会阻止该程序在一般设置下工作，实际上，不正确的程序已准备好导致浏览器或系统崩溃。

有没有办法提高这个 JavaScript 的性能，同时解决这两个严重的问题？

当然。只需使用整数。

**用于创建字符串的优化代码`stringFill2()`**

```
function stringFill2(x, n) { 
    var s = ''; 
    while (n-- > 0) s += x; 
    return s; 
} 
```

**比较`stringFill1()`和的时序代码`stringFill2()`**

```
function testFill(functionToBeTested, outputSize) { 
    var i = 0, t0 = new Date(); 
    do { 
        functionToBeTested('x', outputSize); 
        t = new Date() - t0; 
        i++; 
    } while (t < 2000); 
    return t/i/1000; 
} 
seconds1 = testFill(stringFill1, 100); 
seconds2 = testFill(stringFill2, 100); 
```

**迄今为止的成功`stringFill2()`**

`stringFill1()`填充一个 100 字节的字符串需要 47.297 微秒（百万分之一秒），`stringFill2()`完成相同的操作需要 27.68 微秒。通过避免引用对象属性，这几乎使性能翻了一番。

## 技巧：避免在长字符串中添加短字符串

我们之前的结果看起来不错——实际上非常好。由于使用了我们的前两个优化，改进后的功能`stringFill2()`要快得多。如果我告诉你它可以改进到比现在快很多倍，你会相信吗？

是的，我们可以实现这个目标。现在我们需要解释如何避免将短字符串附加到长字符串。

与我们的原始函数相比，短期行为似乎相当不错。计算机科学家喜欢分析函数或计算机程序算法的“渐近行为”，这意味着通过使用更大的输入对其进行测试来研究其长期行为。有时不做进一步的测试，人们永远不会意识到可以改进计算机程序的方法。为了看看会发生什么，我们将创建一个 200 字节的字符串。

**出现的问题`stringFill2()`**

使用我们的计时函数，我们发现 200 字节字符串的时间增加到 62.54 微秒，而 100 字节字符串的时间增加到 27.68 微秒。做两倍工作的时间似乎应该加倍，但实际上是三倍或四倍。从编程经验来看，这个结果似乎很奇怪，因为如果有的话，函数应该稍微快一些，因为工作效率更高（每个函数调用 200 字节而不是每个函数调用 100 字节）。这个问题与 JavaScript 字符串的一个隐蔽属性有关：JavaScript 字符串是“不可变的”。

不可变意味着字符串一旦创建就不能更改。通过一次添加一个字节，我们不会再消耗一个字节。我们实际上是在重新创建整个字符串加上一个字节。

实际上，要向 100 字节的字符串添加一个字节，需要 101 个字节的工作量。让我们简要分析一下创建一串`N`字节的计算成本。添加第一个字节的成本是 1 个计算工作单位。添加第二个字节的成本不是一个单位而是 2 个单位（将第一个字节复制到新的字符串对象以及添加第二个字节）。第三个字节需要 3 个单位的成本，以此类推。

`C(N) = 1 + 2 + 3 + ... + N = N(N+1)/2 = O(N^2)`. 该符号`O(N^2)`发音为 Big O of N squared，这意味着从长远来看，计算成本与字符串长度的平方成正比。创建 100 个字符需要 10,000 个工作单位，创建 200 个字符需要 40,000 个工作单位。

这就是为什么创建 200 个字符所用的时间是创建 100 个字符所用时间的两倍多。事实上，它应该花费四倍的时间。我们的编程经验是正确的，因为对于较长的字符串，工作效率稍高一些，因此只用了大约三倍的时间。一旦函数调用的开销对于我们创建的字符串的长度变得可以忽略不计，实际上创建两倍长的字符串需要四倍的时间。

（历史注释：这种分析不一定适用于源代码中的字符串，例如`html = 'abcd\n' + 'efgh\n' + ... + 'xyz.\n'`，因为 JavaScript 源代码编译器可以将字符串连接在一起，然后再将它们变成 JavaScript 字符串对象。就在几年前，KJS 的实现JavaScript 在加载加号连接的长串源代码时会冻结或崩溃。由于计算时间很长`O(N^2)`，制作超载使用 KJS JavaScript 引擎核心的 Konqueror Web 浏览器或 Safari 的网页并不难。我首先我在开发标记语言和 JavaScript 标记语言解析器时遇到了这个问题，然后我在为 JavaScript Includes 编写脚本时发现了导致问题的原因。）

显然，这种性能的快速下降是一个巨大的问题。鉴于我们无法改变 JavaScript 将字符串作为不可变对象处理的方式，我们该如何处理呢？解决方案是使用尽可能少地重新创建字符串的算法。

澄清一下，我们的目标是避免将短字符串添加到长字符串中，因为为了添加短字符串，也必须复制整个长字符串。

该算法如何工作以避免将短字符串添加到长字符串

这是减少创建新字符串对象次数的好方法。将较长的字符串连接在一起，以便一次将一个以上的字节添加到输出中。

例如，制作一个长度为的字符串`N = 9`：

```
x = 'x'; 
s = ''; 
s += x; /* Now s = 'x' */ 
x += x; /* Now x = 'xx' */ 
x += x; /* Now x = 'xxxx' */ 
x += x; /* Now x = 'xxxxxxxx' */ 
s += x; /* Now s = 'xxxxxxxxx' as desired */ 
```

这样做需要创建一个长度为 1 的字符串，创建一个长度为 2 的字符串，创建一个长度为 4 的字符串，创建一个长度为 8 的字符串，最后创建一个长度为 9 的字符串。我们节省了多少成本？

旧成本`C(9) = 1 + 2 + 3 + 4 + 5 + 6 + 7 + 9 = 45`。

新成本`C(9) = 1 + 2 + 4 + 8 + 9 = 24`。

请注意，我们必须将长度为 1 的字符串添加到长度为 0 的字符串中，然后将长度为 1 的字符串添加到长度为 1 的字符串中，然后将长度为 2 的字符串添加到长度为 2 的字符串中，然后添加长度为 4 的字符串到长度为 4 的字符串，然后是长度为 8 的字符串到长度为 1 的字符串，以获得长度为 9 的字符串。我们所做的可以概括为避免将短字符串添加到长字符串，或者其他单词，试图将长度相等或几乎相等的字符串连接在一起。

对于旧的计算成本，我们找到了一个公式`N(N+1)/2`。新成本有公式吗？是的，但它很复杂。重要的是它是`O(N)`，因此将字符串长度加倍将大约使工作量增加一倍而不是四倍。

实现这个新想法的代码几乎和计算成本的公式一样复杂。当您阅读它时，请记住这`>>= 1`意味着右移 1 个字节。因此，如果`n = 10011`是二进制数，则`n >>= 1`结果为`n = 1001`。

您可能不认识的代码的另一部分是按位和运算符，写成`&`. 如果 的最后一个二进制位为 1，则表达式`n & 1`计算为真，如果 的最后`n`一个二进制位为 0，则该表达式计算为假`n`。

**新的高效`stringFill3()`功能**

```
function stringFill3(x, n) { 
    var s = ''; 
    for (;;) { 
        if (n & 1) s += x; 
        n >>= 1; 
        if (n) x += x; 
        else break; 
    } 
    return s; 
} 
```

在未经训练的人看来，它看起来很丑，但它的性能却是可爱的。

让我们看看这个函数的性能如何。看到结果后，你可能永远不会忘记`O(N^2)`算法和`O(N)`算法之间的区别。

`stringFill1()`创建一个 200 字节的字符串需要 88.7 微秒（百万分之一秒），`stringFill2()`需要 62.54，而`stringFill3()`仅需要 4.608。是什么让这个算法变得更好？所有的函数都利用了局部函数变量，但是利用第二和第三个优化技术，性能提高了 20 倍`stringFill3()`。

**更深入的分析**

是什么让这个特殊的功能让竞争对手彻底崩溃？

正如我所提到的，这两个函数`stringFill1()`和`stringFill2()`运行如此缓慢的原因是 JavaScript 字符串是不可变的。无法重新分配内存以允许一次多一个字节附加到 JavaScript 存储的字符串数据。每在字符串末尾添加一个字节，就会从头到尾重新生成整个字符串。

因此，为了提高脚本的性能，必须通过提前将两个字符串连接在一起来预先计算更长的字符串，然后递归地建立所需的字符串长度。

例如，要创建一个 16 个字母的字节字符串，首先会预先计算一个两个字节的字符串。然后将重用两个字节的字符串来预先计算一个四字节的字符串。然后将重新使用四字节字符串来预先计算八字节字符串。最后，将重用两个 8 字节字符串来创建所需的 16 字节新字符串。总共必须创建四个新字符串，一个长度为 2，一个长度为 4，一个长度为 8，一个长度为 16。总成本为 2 + 4 + 8 + 16 = 30。

从长远来看，这种效率可以通过以相反的顺序相加并使用以第一项 a1 = N 开始并且具有共同比率 r = 1/2 的几何级数来计算。几何级数的总和由下式给出`a_1 / (1-r) = 2N`。

这比添加一个字符来创建一个长度为 2 的新字符串、创建一个长度为 3、4、5 等直到 16 的新字符串更有效。以前的算法使用一次添加一个字节的过程，其总成本为`n (n + 1) / 2 = 16 (17) / 2 = 8 (17) = 136`。

显然，136 是一个比 30 大得多的数字，所以前面的算法需要很多很多的时间来构建一个字符串。

为了比较这两种方法，您可以看到递归算法（也称为“分而治之”）在长度为 123,457 的字符串上的速度有多快。在我的 FreeBSD 计算机上，该算法在`stringFill3()`函数中实现，在 0.001058 秒内创建字符串，而原始`stringFill1()`函数在 0.0808 秒内创建字符串。新功能速度提高了 76 倍。

随着字符串的长度变大，性能差异也会增加。在创建越来越大的字符串的限制中，原始函数的行为大致类似于`C1`(constant) times `N^2`，而新函数的行为类似于`C2`(constant) times `N`。

从我们的实验中，我们可以确定`C1`to be的值和to be`C1 = 0.0808 / (123457)2 = .00000000000530126997`的值。在 10 秒内，新函数可以创建一个包含 1,166,890,359 个字符的字符串。为了创建相同的字符串，旧函数需要 7,218,384 秒的时间。`C2``C2 = 0.001058 / 123457 = .00000000856978543136`

与十秒相比，这几乎是三个月！

我只是回答（晚了几年），因为我对这个问题的最初解决方案已经在互联网上流传了 10 多年，而且显然仍然为少数记得它的人所理解。我认为通过在这里写一篇关于它的文章我会有所帮助：

[高速 JavaScript 的性能优化 / 第 3 页](http://www.webreference.com/programming/javascript/jkm3/3.html "高速 JavaScript 的性能优化 / 第 3 页")

不幸的是，这里介绍的其他一些解决方案仍然需要三个月才能产生与适当解决方案在 10 秒内产生的相同数量的输出。

我想花时间在这里复制文章的一部分，作为 Stack Overflow 上的规范答案。

请注意，这里表现最好的算法显然是基于我的算法，并且可能是从其他人的第 3 或第 4 代改编继承而来的。不幸的是，这些修改导致其性能降低。我在这里提出的解决方案的变体可能不理解我的令人困惑`for (;;)`的表达，它看起来像用 C 编写的服务器的主无限循环，它的设计目的是允许仔细定位的 break 语句进行循环控制，这是最紧凑的方法避免额外的不必要的时间以指数方式复制字符串。

* * *

## 回答 #4

> 赞同：45
> 
> 时间：2014-12-05T21:53:59.163

好消息！[`String.prototype.repeat`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/repeat)现在[是 JavaScript 的一部分](http://www.ecma-international.org/ecma-262/6.0/index.html#sec-string.prototype.repeat)。

```
"yo".repeat(2);
// returns: "yoyo" 
```

除 Internet Explorer 外，所有主要浏览器都支持该方法。有关最新列表，请参阅[MDN：String.prototype.repeat > 浏览器兼容性](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/repeat#Browser_compatibility)。

MDN为不支持的浏览器提供[了一个 polyfill 。](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/repeat)

* * *

## 回答 #5

> 赞同：41
> 
> 时间：2010-11-11T08:39:17.983

这个效率很高

```
String.prototype.repeat = function(times){
    var result="";
    var pattern=this;
    while (times > 0) {
        if (times&1)
            result+=pattern;
        times>>=1;
        pattern+=pattern;
    }
    return result;
}; 
```

* * *

## 回答 #6

> 赞同：20
> 
> 时间：2015-04-07T04:33:16.397

[String.prototype.repeat](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/repeat)现在是 ES6 标准。

```
'abc'.repeat(3); //abcabcabc 
```

* * *

## 回答 #7

> 赞同：19
> 
> 时间：2010-03-12T14:30:06.383

扩展[P.Bailey 的解决方案](https://stackoverflow.com/questions/202605/repeat-string-javascript/202627#202627)：

```
String.prototype.repeat = function(num) {
    return new Array(isNaN(num)? 1 : ++num).join(this);
    } 
```

这样，您应该可以避免意外的参数类型：

```
var foo = 'bar';
alert(foo.repeat(3));              // Will work, "barbarbar"
alert(foo.repeat('3'));            // Same as above
alert(foo.repeat(true));           // Same as foo.repeat(1)

alert(foo.repeat(0));              // This and all the following return an empty
alert(foo.repeat(false));          // string while not causing an exception
alert(foo.repeat(null));
alert(foo.repeat(undefined));
alert(foo.repeat({}));             // Object
alert(foo.repeat(function () {})); // Function 
```

*编辑：[归功于杰罗](https://stackoverflow.com/users/108448/jerone)的优雅`++num`想法！*

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2015-08-21T06:33:41.313

采用`Array(N+1).join("string_to_repeat")`

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2009-09-11T16:26:37.623

```
/**  
@desc: repeat string  
@param: n - times  
@param: d - delimiter  
*/

String.prototype.repeat = function (n, d) {
    return --n ? this + (d || '') + this.repeat(n, d) : '' + this
}; 
```

这是如何使用分隔符多次重复字符串。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2012-12-25T00:46:15.197

这是对 disfated 答案的 5-7% 的改进。

通过停止`count > 1`并在循环之后执行额外的`result += pattnern`concat 来展开循环。这将避免以前未使用的最终循环`pattern += pattern`，而不必使用昂贵的 if-check。最终结果将如下所示：

```
String.prototype.repeat = function(count) {
    if (count < 1) return '';
    var result = '', pattern = this.valueOf();
    while (count > 1) {
        if (count & 1) result += pattern;
        count >>= 1, pattern += pattern;
    }
    result += pattern;
    return result;
}; 
```

这是为展开版本分叉的不满的小提琴：http: [//jsfiddle.net/wsdfg/](http://jsfiddle.net/wsdfg/)

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2011-10-04T14:58:41.957

各种方法的测试：

```
var repeatMethods = {
    control: function (n,s) {
        /* all of these lines are common to all methods */
        if (n==0) return '';
        if (n==1 || isNaN(n)) return s;
        return '';
    },
    divideAndConquer:   function (n, s) {
        if (n==0) return '';
        if (n==1 || isNaN(n)) return s;
        with(Math) { return arguments.callee(floor(n/2), s)+arguments.callee(ceil(n/2), s); }
    },
    linearRecurse: function (n,s) {
        if (n==0) return '';
        if (n==1 || isNaN(n)) return s;
        return s+arguments.callee(--n, s);
    },
    newArray: function (n, s) {
        if (n==0) return '';
        if (n==1 || isNaN(n)) return s;
        return (new Array(isNaN(n) ? 1 : ++n)).join(s);
    },
    fillAndJoin: function (n, s) {
        if (n==0) return '';
        if (n==1 || isNaN(n)) return s;
        var ret = [];
        for (var i=0; i<n; i++)
            ret.push(s);
        return ret.join('');
    },
    concat: function (n,s) {
        if (n==0) return '';
        if (n==1 || isNaN(n)) return s;
        var ret = '';
        for (var i=0; i<n; i++)
            ret+=s;
        return ret;
    },
    artistoex: function (n,s) {
        var result = '';
        while (n>0) {
            if (n&1) result+=s;
            n>>=1, s+=s;
        };
        return result;
    }
};
function testNum(len, dev) {
    with(Math) { return round(len+1+dev*(random()-0.5)); }
}
function testString(len, dev) {
    return (new Array(testNum(len, dev))).join(' ');
}
var testTime = 1000,
    tests = {
        biggie: { str: { len: 25, dev: 12 }, rep: {len: 200, dev: 50 } },
        smalls: { str: { len: 5, dev: 5}, rep: { len: 5, dev: 5 } }
    };
var testCount = 0;
var winnar = null;
var inflight = 0;
for (var methodName in repeatMethods) {
    var method = repeatMethods[methodName];
    for (var testName in tests) {
        testCount++;
        var test = tests[testName];
        var testId = methodName+':'+testName;
        var result = {
            id: testId,
            testParams: test
        }
        result.count=0;

        (function (result) {
            inflight++;
            setTimeout(function () {
                result.start = +new Date();
                while ((new Date() - result.start) < testTime) {
                    method(testNum(test.rep.len, test.rep.dev), testString(test.str.len, test.str.dev));
                    result.count++;
                }
                result.end = +new Date();
                result.rate = 1000*result.count/(result.end-result.start)
                console.log(result);
                if (winnar === null || winnar.rate < result.rate) winnar = result;
                inflight--;
                if (inflight==0) {
                    console.log('The winner: ');
                    console.log(winnar);
                }
            }, (100+testTime)*testCount);
        }(result));
    }
} 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2012-03-11T13:31:17.753

这是 JSLint 安全版本

```
String.prototype.repeat = function (num) {
  var a = [];
  a.length = num << 0 + 1;
  return a.join(this);
}; 
```

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2016-02-25T17:31:56.690

### 适用于所有浏览器

这是尽可能简洁：

```
function repeat(s, n) { return new Array(n+1).join(s); } 
```

如果您还关心性能，这是一个更好的方法：

```
function repeat(s, n) { var a=[],i=0;for(;i<n;)a[i++]=s;return a.join(''); } 
```

如果您想比较这两个选项的性能，请参阅[**这个 Fiddle**](https://jsfiddle.net/mf2jwjym/)和[**这个 Fiddle**](https://jsfiddle.net/mf2jwjym/2/)进行基准测试。在我自己的测试中，第二个选项在 Firefox 中大约快 2 倍，在 Chrome 中大约快 4 倍！

### 仅适用于现代浏览器：

在现代浏览器中，您现在也可以这样做：

```
function repeat(s,n) { return s.repeat(n) }; 
```

此选项不仅比其他两个选项短，而且比第二个选项[**更快。**](http://The%20numbers%20in%20the%20table%20specify%20the%20first%20browser%20version%20that%20fully%20supports%20the%20method.)

不幸的是，它不适用于任何版本的 Internet Explorer。表中的数字指定了完全支持该方法的第一个浏览器版本：

[![在此处输入图像描述](https://i.stack.imgur.com/B3PVU.png)](https://i.stack.imgur.com/B3PVU.png)

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2016-03-23T08:31:46.477

```
function repeat(pattern, count) {
  for (var result = '';;) {
    if (count & 1) {
      result += pattern;
    }
    if (count >>= 1) {
      pattern += pattern;
    } else {
      return result;
    }
  }
} 
```

您可以在[JSFiddle](https://jsfiddle.net/nikolay/h4kxoaog/)对其进行测试。以 hacky 为基准`Array.join`，我的大致速度是[10 (Chrome) 到 100 (Safari) 到 200 (Firefox) 倍](https://jsfiddle.net/nikolay/Lgshxrk8/)（取决于浏览器）。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2017-01-10T16:57:07.727

# 方法有很`ES-Next`多种

## 1\. `ES2015`/`ES6`已经实现了这个`repeat()`方法！

```
/** 
 * str: String
 * count: Number
 */
const str = `hello repeat!\n`, count = 3;

let resultString = str.repeat(count);

console.log(`resultString = \n${resultString}`);
/*
resultString = 
hello repeat!
hello repeat!
hello repeat!
*/

({ toString: () => 'abc', repeat: String.prototype.repeat }).repeat(2);
// 'abcabc' (repeat() is a generic method)

// Examples

'abc'.repeat(0);    // ''
'abc'.repeat(1);    // 'abc'
'abc'.repeat(2);    // 'abcabc'
'abc'.repeat(3.5);  // 'abcabcabc' (count will be converted to integer)
// 'abc'.repeat(1/0);  // RangeError
// 'abc'.repeat(-1);   // RangeError
```

## 2\. `ES2017`/`ES8`新添加`String.prototype.padStart()`

```
const str = 'abc ';
const times = 3;

const newStr = str.padStart(str.length * times, str.toUpperCase());

console.log(`newStr =`, newStr);
// "newStr =" "ABC ABC abc "
```

## 3\. `ES2017`/`ES8`新添加`String.prototype.padEnd()`

```
const str = 'abc ';
const times = 3;

const newStr = str.padEnd(str.length * times, str.toUpperCase());

console.log(`newStr =`, newStr);
// "newStr =" "abc ABC ABC "
```

## 参考

[http://www.ecma-international.org/ecma-262/6.0/#sec-string.prototype.repeat](http://www.ecma-international.org/ecma-262/6.0/#sec-string.prototype.repeat)

[https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/repeat](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/repeat)

[https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/padStart](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/padStart)

[https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/padEnd](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/padEnd)

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2017-01-28T00:36:23.107

只是另一个重复功能：

```
function repeat(s, n) {
  var str = '';
  for (var i = 0; i < n; i++) {
    str += s;
  }
  return str;
} 
```

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2008-10-14T20:17:15.217

```
function repeat(s, n) { var r=""; for (var a=0;a<n;a++) r+=s; return r;} 
```

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2011-07-02T14:54:55.073

这可能是最小的递归：-

```
String.prototype.repeat = function(n,s) {
s = s || ""
if(n>0) {
   s += this
   s = this.repeat(--n,s)
}
return s} 
```

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2013-01-29T10:21:17.603

如果您认为所有这些原型定义、数组创建和连接操作都是多余的，只需在需要的地方使用单行代码即可。字符串 S 重复 N 次：

```
for (var i = 0, result = ''; i < N; i++) result += S; 
```

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2014-08-05T09:57:10.660

小提琴：http: [//jsfiddle.net/3Y9v2/](http://jsfiddle.net/3Y9v2/)

```
function repeat(s, n){
    return ((new Array(n+1)).join(s));
}
alert(repeat('R', 10)); 
```

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2014-10-16T21:30:35.840

# 简单的递归连接

我只是想给它一个bash，并做了这个：

```
function ditto( s, r, c ) {
    return c-- ? ditto( s, r += s, c ) : r;
}

ditto( "foo", "", 128 ); 
```

我不能说我想了很多，它可能表明:-)

## *这*可以说更好

```
String.prototype.ditto = function( c ) {
    return --c ? this + this.ditto( c ) : this;
};

"foo".ditto( 128 ); 
```

这很像已经发布的答案 - 我知道这一点。

## 但是为什么要递归呢？

还有一点默认行为呢？

```
String.prototype.ditto = function() {
    var c = Number( arguments[ 0 ] ) || 2,
        r = this.valueOf();
    while ( --c ) {
        r += this;
    }
    return r;
}

"foo".ditto(); 
```

**因为**，尽管非递归方法可以处理任意大的重复而不会达到调用堆栈限制，但它的速度要慢得多。

## 为什么我要费心添加更多没有已经发布的方法一半*聪明的方法？*

部分是为了我自己的乐趣，部分是为了以最简单的方式指出我知道有很多方法可以给猫剥皮，并且根据情况，很可能表面上*最好*的方法并不理想。

在某些情况下，相对快速和复杂的方法可能会有效地崩溃和烧毁，而更慢、更简单的方法可能最终完成工作。

有些方法可能只不过是利用漏洞，因此很容易被*固定*为不存在，而其他方法可能在所有条件下都能很好地工作，但构造得如此之好，以至于*人们*根本不知道它是如何工作的。

*“那如果我不知道它是如何工作的呢？！”*

严重地？

JavaScript 受到其最大优势之一的影响。它对不良行为的容忍度很高，而且非常灵活，它会向后弯腰返回结果，如果它被折断可能对每个人都更好！

*“权力越大，责任越大”* ;-)

但更严肃和重要的是，虽然像这样的一般问题确实会以*聪明*的答案的形式导致令人敬畏，如果不出意外，扩大一个人的知识和视野，最后，手头的任务 - 使用结果方法的实用脚本 -可能需要比建议的少一点，或者更*聪明一点。*

这些*“完美”*的算法很有趣，但*“一刀切”*很少会比量身定制的更好。

由于缺乏睡眠和一时的兴趣，给你带来了这篇布道。继续编码！

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2014-12-18T14:23:10.533

首先，OP的问题似乎是关于简洁性——我理解它的意思是“简单易读”，而大多数答案似乎是关于效率——这显然不是一回事，而且我认为除非你实现一些非常特定的大数据操作算法，当您来实现基本的数据操作 Javascript 函数时，您不必担心。简洁更为重要。

其次，正如 André Laszlo 所指出的，String.repeat 是 ECMAScript 6 的一部分，并且已经在几个流行的实现中可用 - 所以最简洁的实现`String.repeat`是不实现它;-)

最后，如果您需要支持不提供 ECMAScript 6 实现的主机，André Laszlo 提到的 MDN 的 polyfill 绝不是简洁的。

所以，事不宜迟 - 这是我**简洁**的polyfill：

```
String.prototype.repeat = String.prototype.repeat || function(n){
    return n<=1 ? this : this.concat(this.repeat(n-1));
} 
```

是的，这是一个递归。我喜欢递归——它们很简单，如果做得正确很容易理解。关于效率，如果语言支持它，如果编写正确，它们会非常有效。

根据我的测试，这种方法比该`Array.join`方法快约 60%。尽管它显然与 disfated 的实现相去甚远，但它比两者都简单得多。

我的测试设置是节点 v0.10，使用“严格模式”（我认为它启用了某种[TCO](https://code.google.com/p/v8/issues/detail?id=457)），调用`repeat(1000)`10 个字符串一百万次。

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2015-11-04T19:55:11.980

将 Lodash 用于 Javascript 实用程序功能，例如重复字符串。

Lodash 提供了良好的性能和 ECMAScript 兼容性。

我强烈推荐它用于 UI 开发，它在服务器端也能很好地工作。

下面是如何使用 Lodash 将字符串 "yo" 重复 2 次：

```
> _.repeat('yo', 2)
"yoyo" 
```

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2011-10-04T14:28:05.063

使用分而治之的递归解决方案：

```
function repeat(n, s) {
    if (n==0) return '';
    if (n==1 || isNaN(n)) return s;
    with(Math) { return repeat(floor(n/2), s)+repeat(ceil(n/2), s); }
} 
```

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2013-03-15T02:21:13.873

我随机来到这里，以前从来没有理由在 javascript 中重复一个字符。

我对artistoex 的做法和disfated 的结果印象深刻。我注意到最后一个字符串 concat 是不必要的，正如 Dennis 也指出的那样。

当我把采样放在一起玩时，我注意到了更多的事情。

结果变化很大，通常有利于最后一次运行，类似的算法通常会争夺位置。我改变的一件事是不使用 JSLitmus 生成的计数作为调用的种子；由于各种方法产生的计数不同，我输入了一个索引。这使事情变得更加可靠。然后我查看了确保将不同大小的字符串传递给函数。这阻止了我看到的一些变化，其中一些算法在单个字符或更小的字符串上做得更好。然而，无论字符串大小如何，前 3 种方法都表现良好。

分叉的测试集

[http://jsfiddle.net/schmide/fCqp3/134/](http://jsfiddle.net/schmide/fCqp3/134/)

```
// repeated string
var string = '0123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789';
// count paremeter is changed on every test iteration, limit it's maximum value here
var maxCount = 200;

var n = 0;
$.each(tests, function (name) {
    var fn = tests[name];
    JSLitmus.test(++n + '. ' + name, function (count) {
        var index = 0;
        while (count--) {
            fn.call(string.slice(0, index % string.length), index % maxCount);
            index++;
        }
    });
    if (fn.call('>', 10).length !== 10) $('body').prepend('<h1>Error in "' + name + '"</h1>');
});

JSLitmus.runAll(); 
```

然后我包括了丹尼斯的修复，并决定看看我是否能找到一种方法来寻找更多。

由于 javascript 并不能真正优化事物，因此提高性能的最佳方法是手动避免事物。如果我将前 4 个微不足道的结果从循环中取出，我可以避免 2-4 个字符串存储并将最终存储直接写入结果。

```
// final: growing pattern + prototypejs check (count < 1)
'final avoid': function (count) {
    if (!count) return '';
    if (count == 1) return this.valueOf();
    var pattern = this.valueOf();
    if (count == 2) return pattern + pattern;
    if (count == 3) return pattern + pattern + pattern;
    var result;
    if (count & 1) result = pattern;
    else result = '';
    count >>= 1;
    do {
        pattern += pattern;
        if (count & 1) result += pattern;
        count >>= 1;
    } while (count > 1);
    return result + pattern + pattern;
} 
```

与丹尼斯的修复相比，这平均提高了 1-2%。但是，不同的运行和不同的浏览器会显示出足够公平的差异，以至于这些额外的代码可能不值得为之前的 2 种算法付出努力。

[图表](http://chart.apis.google.com/chart?chtt=String.repeat%28%29%20mesure%20-%20jsFiddle%20demo%20by%20schmide|Ops/sec%20%28Chrome%2025.0.1364.172%20on%20Windows%20NT%29&chts=000000,10&cht=bhg&chd=t:43623,125090,796212,1650378,3130496,3242799,3402753&chds=0,3402753&chxt=x&chxl=0%3a|0|3.4M&chsp=0,1&chm=t1.%20new%20Array.join%28%29%20%28prototypejs%29%2843.6K%29,000000,0,0,10|t2.%20array.push%28%29.join%28%29%28125.1K%29,000000,0,1,10|t3.%20%28result%20%2b%3D%20string%29%20x%20count%28796.2K%29,000000,0,2,10|t4.%20result%20%2b%3D%20growing%20pattern%281.7M%29,000000,0,3,10|t5.%20final%283.1M%29,000000,0,4,10|t6.%20final%20unrolled%283.2M%29,000000,0,5,10|t7.%20final%20avoid%283.4M%29,000000,0,6,10&chbh=15,0,5&chs=250x210)

编辑：我主要是在 chrome 下完成的。Firefox 和 IE 通常会偏爱几 % 的 Dennis。

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2013-05-28T20:33:25.943

简单方法：

```
String.prototype.repeat = function(num) {
    num = parseInt(num);
    if (num < 0) return '';
    return new Array(num + 1).join(this);
} 
```

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2014-08-30T21:25:21.597

人们将其复杂化到荒谬的程度或浪费性能。数组？递归？你一定是在开玩笑吧。

```
function repeat (string, times) {
  var result = ''
  while (times-- > 0) result += string
  return result
} 
```

**编辑。**我进行了一些简单的测试，以与 Artistoex / disfated 和其他一些人发布的按位版本进行比较。后者只是稍微快一点，但内存效率要高几个数量级。对于单词“blah”的 1000000 次重复，Node 进程使用简单的连接算法（上图）达到 46 兆字节，但使用对数算法只有 5.5 兆字节。后者绝对是要走的路。为了清楚起见，重新发布它：

```
function repeat (string, times) {
  var result = ''
  while (times > 0) {
    if (times & 1) result += string
    times >>= 1
    string += string
  }
  return result
} 
```

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2016-04-17T15:48:28.303

基于数字连接字符串。

```
function concatStr(str, num) {
   var arr = [];

   //Construct an array
   for (var i = 0; i < num; i++)
      arr[i] = str;

   //Join all elements
   str = arr.join('');

   return str;
}

console.log(concatStr("abc", 3)); 
```

希望有帮助！

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2019-05-02T02:09:52.643

使用 ES8，你也可以使用`padStart`or `padEnd`。例如。

```
var str = 'cat';
var num = 23;
var size = str.length * num;
"".padStart(size, str) // outputs: 'catcatcatcatcatcatcatcatcatcatcatcatcatcatcatcatcatcatcatcatcatcatcat' 
```

* * *

## 回答 #30

> 赞同：1
> 
> 时间：2020-08-29T01:09:03.080

要在指定次数内重复一个字符串，我们可以使用 JavaScript 中的内置`repeat()`方法。

这是一个将以下字符串重复 4 次的示例：

```
const name = "king";

const repeat = name.repeat(4);

console.log(repeat); 
```

输出：

```
"kingkingkingking" 
```

或者我们可以像这样创建自己的`repeat()`函数版本：

```
function repeat(str, n) {
  if (!str || !n) {
    return;
  }

 let final = "";
  while (n) {
    final += s;
    n--;
  }
  return final;
}

console.log(repeat("king", 3)) 
```

（最初发布在[https://reactgo.com/javascript-repeat-string/](https://reactgo.com/javascript-repeat-string/)）

# sql - What is the syntax to use a Select statement inside a PL/SQL Trigger?

> ID：202609
> 
> 赞同：10
> 
> 时间：2008-10-14T20:12:05.057
> 
> 标签：sql, oracle, plsql, ora-00923

This is what I currently have:

```
CREATE OR REPLACE TRIGGER MYTRIGGER
AFTER INSERT ON SOMETABLE
FOR EACH ROW    

DECLARE
 v_emplid varchar2(10);    

BEGIN
 SELECT
  personnum into v_emplid
 FROM PERSON
 WHERE PERSONID = :new.EMPLOYEEID;

dbms_output.put(v_emplid);

/* INSERT INTO SOMEOTHERTABLE USING v_emplid and some of the other values from the trigger table*/

END MYTRIGGER; 
```

DBA_ERRORS has this error: PL/SQL: ORA-00923: FROM keyword not found where expected

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-14T20:19:07.867

1) There must be something else to your example because that sure seems to work for me

```
SQL> create table someTable( employeeid number );

Table created.

SQL> create table person( personid number, personnum varchar2(10) );

Table created.

SQL> ed
Wrote file afiedt.buf

  1  CREATE OR REPLACE TRIGGER MYTRIGGER
  2    AFTER INSERT ON SOMETABLE
  3    FOR EACH ROW
  4  DECLARE
  5   v_emplid varchar2(10);
  6  BEGIN
  7   SELECT personnum
  8     into v_emplid
  9     FROM PERSON
 10    WHERE PERSONID = :new.EMPLOYEEID;
 11    dbms_output.put(v_emplid);
 12    /* INSERT INTO SOMEOTHERTABLE USING v_emplid and some of the other values
 from the trigger table*/
 13* END MYTRIGGER;
 14  /

Trigger created.

SQL> insert into person values( 1, '123' );

1 row created.

SQL> insert into sometable values( 1 );

1 row created. 
```

2) You probably want to declare V_EMPLID as being of type Person.PersonNum%TYPE so that you can be certain that the data type is correct and so that if the data type of the table changes you won't need to change your code.

3) I assume that you know that your trigger cannot query or update the table on which the trigger is defined (so no queries or inserts into someTable).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-14T20:34:59.503

You are playing with Lava (not just fire) in your trigger. DBMS_OUTPUT in a trigger is really, really bad. You can blow-out on a buffer overflow in your trigger and the whole transaction is shot. Good luck tracking that down. If you must do output-to-console like behavior, invoke an AUTONOMOUS TRANSACTION procedure that writes to a table.

Triggers are pretty evil. I used to like them, but they are too hard to remember about. They affect data often times leading to MUTATING data (scary and not just because Halloween is close).

We use triggers to change the value of columns like .new:LAST_MODIFIED := sysdate and .new:LAST_MODIFIED_BY := user. That's it.

Don't ever allow a TRIGGER to prevent a transaction from completing. Find another option.

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2008-10-14T20:15:15.813

I would not use a select statment in a trigger ever. Insert into the table rather than a select into. Once the table already exists select into does not work in most databases.

# bash - 如何在 bash 中重用具有不同参数的命令？

> ID：202610
> 
> 赞同：4
> 
> 时间：2008-10-14T20:12:50.203
> 
> 标签：bash, command-line, scripting

我有两个经常需要使用相同参数运行的脚本：

```
$ populate.ksh 9241 && check.ksh 9241 
```

当我需要更改参数时（本例中为**9241**），我可以返回并编辑历史记录中的行。但是由于我需要在两个地方更改数字，所以我有时会打错字。我希望能够只更改一次参数以在两个地方进行更改。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-14T20:19:36.147

在 bash 中：

```
!!:gs/9241/9243/ 
```

是的，它使用`gs///`，而不是`s///g`。:-)

（zigdon 的答案使用最后一个以 开头的命令`pop`，例如`populate.sh`。我的答案使用最后一个命令，句号。选择适合您的。）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-14T20:19:34.353

您还可以使用历史替换功能：

```
!pop:gs/9241/1234 
```

像这样：

```
$ populate.ksh 9241 && check.ksh 9241
...
$ !pop:gs/9241/1234
populate.ksh 1234 && check.ksh 1234
... 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-15T15:55:37.460

已经给出了正确的答案，但为了更一般的理解，请阅读手册页，特别注意**“历史扩展”**和相关的 shell 变量（例如“ `HISTCONTROL`”、“ `histchars`”等）。顺便说一句--您的寻呼机的搜索功能在阅读时非常有用`man bash`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-14T20:13:01.857

一种解决方案是简单地创建一个依次调用脚本的包装脚本 ( *populate_check.ksh* )：

```
r=$1
populate.ksh $r && check.ksh $r 
```

或者对于多个参数：

```
for r; do
   populate.ksh $r && check.ksh $r
done 
```

对于更短暂的任务，您还可以对命令进行参数化，以便更容易在历史记录中进行编辑：

```
$ r=9241; populate.ksh $r && check.ksh $r 
```

或者一次做几个：

```
$ for r in 9241 9242; do populate.ksh $r && check.ksh $r; done 
```

# oracle - Oracle 是否支持全文搜索？

> ID：202623
> 
> 赞同：30
> 
> 时间：2008-10-14T20:15:54.113
> 
> 标签：oracle, full-text-search, oracle-text

是否有与 MS SQL 的全文搜索服务相当的 Oracle？

如果是这样，有没有人实施它并有好的/坏的经验？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2008-10-14T20:22:20.853

[Oracle Text](http://download.oracle.com/docs/cd/B19306_01/server.102/b14220/content.htm#sthref2643)是等效的功能。

我有很好的经验。假设您正在异步维护文本索引，这往往是问题的第一个来源，因为在进行更改和索引更新之间可能会有一点，但这在正常操作期间通常是相当合理的。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-14T20:24:37.307

除了 Justin 所说的之外，您还可以[在此处](http://www.oracle.com/technetwork/database/enterprise-edition/index-098492.html)找到有关 Oracle Text 的更多信息。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-20T18:41:11.350

此外，贾斯汀所说的，可以创建索引，以便在提交时更新，尽管不建议对大量文本这样做。

它提供的功能比简单的 LIKE 与 %string% 的比较要强大得多。

# c# - 如何在 C# 中检测空引用？

> ID：202630
> 
> 赞同：4
> 
> 时间：2008-10-14T20:18:30.113
> 
> 标签：c#

如何确定 C# 中的对象引用是否为空，如果它为空则抛出异常？

即如果我有一个类引用被传入并且我不知道它是否为空。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-14T20:21:31.620

针对 null 的测试永远不会*抛出异常

```
void DoSomething( MyClass value )
{
    if( value != null )
    {
        value.Method();
    }
} 
```

* * *

* 从不*应该永远不会*。正如@Ilya Ryzhenkov 指出的那样，MyClass 的 != 运算符的*错误*实现可能会引发异常。幸运的是，Greg Beech 有一篇关于[在 .NET 中实现对象相等性](http://gregbee.ch/blog/implementing-object-equality-in-dotnet)的好博文。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-14T20:25:47.603

罗伯特说了什么，但对于那个特殊情况，我喜欢用这样的保护子句来表达它，而不是将整个方法体嵌套在 if 块中：

```
void DoSomething( MyClass value )
{
    if ( value == null ) return;
    // I might throw an ArgumentNullException here, instead

    value.Method();
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-14T20:50:33.807

请注意，在 MyClass 上定义运算符 != 可能会导致稍后执行不同的检查结果和 NullReferenceException。绝对确定，使用 object.ReferenceEquals(value, null)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-14T20:26:10.957

```
if(p != null)
{
   DoWork(p);
} 
```

此外，如果您想检测一个类是否属于正确的类型并一次性使用它，“as”关键字会很有帮助。

```
IExample e = p as IExample;
if(e != null)
    DoWork(e); 
```

在上面的示例中，如果您要像 (IExample)e 一样强制转换 e，如果 e 没有实现 IExapmle，它将引发异常。如果您使用 'as' 并且 e 没有实现 IExample e 将简单地为空。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-14T20:52:57.000

如果您查看大部分 .NET 框架源代码，您会发现它们将这样的检查置于其函数的顶部。

```
public void DoSomething(Object myParam)
{
  if (myParam == null) throw new ArgumentNullException("myParam");

  // Carry on
} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-02-01T15:40:23.517

在 C# 6.0 中，这更加优雅；你可以在一行中完成:-)

```
value?.Method(); 
```

如果“value”为空，则不会发生任何事情——也不例外。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-14T20:50:34.917

它很挑剔，但我总是像...

```
if (null == obj) {
   obj = new Obj();
} 
```

代替

```
if (obj == null) {
   obj = new Obj();
} 
```

避免误写

```
if (obj = null) {
   obj = new Obj();
} 
```

因为

```
if (null = obj) {
   obj = new Obj();
} 
```

会给你一个编译器错误

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-14T20:20:12.607

```
(YourObject != Null) 
```

你可以比较null吗？

如果它为 null 而不是抛出异常，您可以初始化您的对象。您可以使用空模式。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-14T20:23:33.457

或者，如果您使用的是值类型，您可以阅读有关可空类型的信息：[http ://www.c-sharpcorner.com/UploadFile/mosessaur/nullabletypes08222006164135PM/nullabletypes.aspx](http://www.c-sharpcorner.com/UploadFile/mosessaur/nullabletypes08222006164135PM/nullabletypes.aspx)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-14T20:31:45.670

我在应用程序的 xaml.cs 应用程序衍生定义中有：

```
private SortedList myList; 
```

我希望能够重用我的构造函数。所以我需要：

```
if ( myList == null)
   myList = new SortedList(); 
```

谢谢罗伯特！

# performance - 使用静态方法与实例化包含方法的类的性能

> ID：202631
> 
> 赞同：30
> 
> 时间：2008-10-14T20:18:32.033
> 
> 标签：performance, oop, static, methods, instance

我正在使用 C# 开发一个项目。以前的程序员不了解面向对象编程，所以大部分代码都在巨大的文件中（我们谈论的是大约 4-5000 行），分布在数十个甚至数百个方法中，但只有一个类。重构这样一个项目是一项艰巨的任务，所以我现在已经半学会了忍受它。

每当在其中一个代码文件中使用方法时，都会实例化该类，然后在对象实例上调用该方法。

我想知道这样做是否有任何明显的性能损失？我是否应该“暂时”将所有方法设为静态，最重要的是，应用程序会以任何方式从中受益吗？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-10-14T21:02:11.023

从[这里开始](http://msdn.microsoft.com/en-us/library/ms973852.aspx)，每次调用实例方法时，静态调用比构造实例快 4 到 5 倍。但是，我们仍然只讨论每次调用几十纳秒，所以你不太可能注意到任何好处，除非你有数百万次调用方法的非常紧密的循环，并且你可以通过在外部构造单个实例来获得相同的好处该循环并重用它。

由于您必须更改每个调用站点以使用新的静态方法，因此您最好将时间花在逐步重构上。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-12-25T03:16:51.060

我在工作的地方也处理过类似的问题。我之前的程序员创建了 1 个控制器类，其中所有 BLL 函数都被转储了。

我们现在正在重新设计系统，并根据它们应该控制的内容创建了许多控制器类，例如

用户控制器、地理控制器、购物控制器...

在每个控制器类中，它们都有静态方法，这些方法使用单例模式调用缓存或 DAL。

这给了我们两个主要优势。它稍微快一点（大约快 2-3 倍，但这里说的是纳秒；P）。另一个是代码更干净

IE

```
ShoppingController.ListPaymentMethods() 
```

代替

```
new ShoppingController().ListPaymentMethods() 
```

如果类不维护任何状态，我认为使用静态方法或类是有意义的。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-15T03:08:49.147

这取决于该对象包含的其他内容——如果“对象”只是一堆函数，那么它可能不是世界末日。但是如果对象包含一堆其他对象，那么实例化它将调用它们的所有构造函数（和析构函数，当它被删除时），你可能会得到内存碎片等等。

也就是说，听起来性能并不是你现在最大的问题。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-01-17T12:38:12.437

您必须确定重写的目标。如果您想拥有良好的可测试、可扩展和可维护的 OO 代码，那么您可以尝试使用对象及其实例方法。毕竟这是我们在这里讨论的面向对象编程，而不是面向类编程。

当您定义实现接口的类并执行实例方法时，伪造和/或模拟对象非常简单。这使得彻底的单元测试快速有效。

此外，如果您要遵循良好的 OO 原则（请参阅[http://en.wikipedia.org/wiki/SOLID_%28object-orientated_design%29](http://en.wikipedia.org/wiki/SOLID_%28object-oriented_design%29)上的 SOLID ）和/或使用设计模式，您肯定会做很多基于实例的，基于接口的开发，并没有使用很多静态方法。

至于这个建议：

> > 对我来说创建一个对象似乎很愚蠢，这样你就可以调用一个看似对对象没有副作用的方法（根据你的描述，我假设这一点）。

我在 dot net 商店中经常看到这种情况，对我来说这违反了封装，这是一个关键的 OO 概念。我应该无法通过该方法是否为静态来判断该方法是否具有副作用。除了打破封装之外，这意味着如果/当您修改它们以产生副作用时，您将需要将方法从静态更改为实例。我建议您阅读此原则的开放/封闭原则，看看上面引用的建议方法是如何考虑到这一点的。

记住那句老话，“过早的优化是万恶之源”。我认为在这种情况下，这意味着在您知道自己有性能问题之前，不要使用不适当的技术（即面向类的编程）跳过箍。即使然后调试问题并寻找最合适的。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2014-11-09T11:14:44.853

静态方法要快得多，并且使用的内存要少得多。有一种误解，认为它只是快一点。只要你不把它放在循环上，它就会快一点。顺便说一句，有些循环看起来很小，但实际上并不是因为包含循环的方法调用也是另一个循环。您可以区分执行渲染功能的代码。不幸的是，在许多情况下，内存要少得多。实例允许与姐妹方法轻松共享信息。静态方法会在需要时询问信息。

但就像驾驶汽车一样，速度带来责任。静态方法通常比它们的实例对应物具有更多的参数。因为实例会负责缓存共享变量，所以您的实例方法看起来会更漂亮。

```
ShapeUtils.DrawCircle(stroke, pen, origin, radius);

ShapeUtils.DrawSquare(stroke, pen, x, y, width, length); 
```

VS

```
ShapeUtils utils = new ShapeUtils(stroke,pen);

util.DrawCircle(origin,radius);

util.DrawSquare(x,y,width,length); 
```

在这种情况下，只要实例变量在大多数情况下被所有方法使用，实例方法就非常值得。实例与状态无关，它与共享有关，尽管公共状态是共享的自然形式，但它们并不相同。一般的经验法则是这样的：如果该方法与其他方法紧密耦合——它们非常相爱，以至于当一个被调用时，另一个也需要被调用，并且它们可能共享同一杯水—— - 应该是实例。将静态方法转换为实例方法并不难。您只需要获取共享参数并将它们作为实例变量。反过来更难。

或者您可以创建一个代理类来桥接静态方法。虽然它在理论上可能看起来效率更低，但实践却讲述了一个不同的故事。这是因为每当您需要调用一次 DrawSquare（或在循环中）时，您都会直接使用静态方法。但是，当您将它与 DrawCircle 一起反复使用时，您将使用实例代理。一个例子是 System.IO 类 FileInfo（实例）与 File（静态）。

静态方法是可测试的。事实上，甚至比实例一次更可测试。方法 GetSum(x,y) 不仅可用于单元测试，还可用于负载测试、集成测试和使用测试。实例方法对单元测试很好，但对所有其他测试（这比单元测试更重要）来说都是可怕的，这就是为什么我们这些天会遇到这么多错误的原因。使所有方法无法测试的是没有意义的参数，例如 (Sender s, EventArgs e) 或像 DateTime.Now 这样的全局状态。事实上，静态方法在可测试性方面非常出色，以至于您在新 Linux 发行版的 C 代码中看到的错误比普通的 OO 程序员要少（我知道他满脑子都是 s***）。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-14T21:08:04.210

我认为您已经按照您提出的方式部分回答了这个问题：您的代码中是否存在*明显*的性能损失？

如果惩罚不明显，您根本不需要做任何事情。（尽管毫无疑问，代码库将从逐渐重构为受人尊敬的 OO 模型中受益匪浅）。

我想我的意思是，只有当您注意到这是一个问题时，性能问题才是一个问题。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-14T20:26:36.510

对我来说创建一个对象似乎很愚蠢，这样你就可以调用一个看似对对象没有副作用的方法（根据你的描述，我假设这一点）。在我看来，更好的折衷方案是拥有几个全局对象并使用它们。这样，您可以将通常是全局的变量放入适当的类中，以便它们的范围略小。

从那里你可以慢慢地移动这些对象的范围越来越小，直到你有一个像样的 OOP 设计。

再说一次，*我*可能会使用的方法是不同的；）。

就个人而言，我可能会专注于结构和对其进行操作的函数，并尝试将它们一点一点地转换为具有成员的类。

至于问题的性能方面，静态方法应该稍快（但不多），因为它们不涉及构造、传递和解构对象。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-04-03T13:45:26.963

它在 PHP 中无效，
对象方法更快：
[http ://www.vanylla.it/tests/static-method-vs-object.php](http://www.vanylla.it/tests/static-method-vs-object.php)

# windows - 是否有用于 vista 的 API 来检测桌面是否正在全屏运行？

> ID：202644
> 
> 赞同：4
> 
> 时间：2008-10-14T20:21:03.087
> 
> 标签：windows, winapi, windows-vista, fullscreen

例如，用户是在全屏播放电影，还是在全屏模式下查看 powerpoint？

我可以发誓我以前看到过 IsFullScreenInteractive API，但现在找不到

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-30T12:38:44.607

以下是我解决此问题的方法：

```
using System;
using System.Collections.Generic;
using System.Data;
using System.Diagnostics;
using System.Runtime.InteropServices;

namespace Test
{
    class Program
    {
        static void Main(string[] args)
        {
            Console.WriteLine(IsForegroundWwindowFullScreen());
        }

        [DllImport("user32.dll")]
        static extern IntPtr GetForegroundWindow();

        [DllImport("user32.dll")]
        static extern int GetSystemMetrics(int smIndex);

        public const int SM_CXSCREEN = 0;
        public const int SM_CYSCREEN = 1;

        [DllImport("user32.dll")]
        [return: MarshalAs(UnmanagedType.Bool)]
        static extern bool GetWindowRect(IntPtr hWnd, out W32RECT lpRect);

        [StructLayout(LayoutKind.Sequential)]
        public struct W32RECT
        {
            public int Left;
            public int Top;
            public int Right;
            public int Bottom;
        }

        public static bool IsForegroundWwindowFullScreen()
        {
            int scrX = GetSystemMetrics(SM_CXSCREEN),
                scrY = GetSystemMetrics(SM_CYSCREEN);

            IntPtr handle = GetForegroundWindow();
            if (handle == IntPtr.Zero) return false;

            W32RECT wRect;
            if (!GetWindowRect(handle, out wRect)) return false;

            return scrX == (wRect.Right - wRect.Left) && scrY == (wRect.Bottom - wRect.Top);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-07-31T07:04:50.500

Vista 确实有一个几乎完全用于此目的的 API - 它称为[SHQueryUserNotificationState](http://msdn.microsoft.com/en-us/library/bb762242%28VS.85%29.aspx)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-14T20:32:02.630

使用 GetForegroundWindow 获取用户正在使用的窗口的句柄。GetClientRect 将给出窗口无边框活动部分的尺寸；使用 ClientToScreen 将矩形转换为监视器坐标。

调用 MonitorFromRect 或 MonitorFromWindow 获取窗口所在的监视器。使用 GetMonitorInfo 获取监视器的坐标。

比较两个矩形 - 如果窗口矩形完全覆盖了监视器矩形，则它是一个全屏窗口。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-12T19:38:18.757

检测窗口状态的首选方法是调用[GetWindowPlacement](http://msdn.microsoft.com/en-us/library/ms633518(VS.85).aspx)。如果与 GetForegroundWindow 一起执行此操作，则可以轻松检查用户是否看到全屏窗口。

# communication - 将复杂事物与外行人联系起来的有效谚语？

> ID：202645
> 
> 赞同：-2
> 
> 时间：2008-10-14T20:21:28.407
> 
> 标签：communication

例如：

> > 更新该遗留系统的代码就像在老房子里修理管道一样。有时它就像更换水龙头一样容易，但有时你花了几个小时在腐烂的木头周围工作，却发现到处都是垃圾。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-14T20:24:33.750

Visual Sourcesafe 就像一大堆冒着热气的恶臭......嗯，你明白了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-14T20:44:41.247

修辞比喻就像一个比喻。

*（对不起 - 我无法抗拒）*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-14T20:29:18.423

面向对象编程允许您做某事一次，并在未来自动完成。例如，每次做饭都必须洗碗。如果你能把自己所有的盘子都洗干净，然后把它们都收起来，以后你每次做饭就不用费心了，因为你会教盘子自己洗，这不是很好吗？

（在向 mgmt 解释为什么我们需要在开始将系统从 VB6 转换为 .NET 之前花时间构建框架时。）

是的，我知道最好告诉他们我正在教未来的盘子自己洗，但我认为这已经够复杂了！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-14T20:29:23.400

在 Excel 中编写大型、关键的数据库应用程序就像使用扳手敲钉子一样，它不适合这项工作。

**编辑：**实际上这不是一个有效的解释，但我认为它是准确的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-14T21:43:08.383

向业务人员解释为什么他们荒谬的变更请求不会被实施：

> 进行此更改就像在现有房屋中添加地下室一样。房子建好后不能更换地基。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-14T20:46:49.433

## 内存层次结构作为手袋办公桌图书馆

手是寄存器，图书馆是硬盘。（CD 和 DVD 就像馆际互借......）它有助于向相当聪明的投注者解释处理器中的缓存大小。（我以前卖电脑。）

## 内存通道

经典的。地址空间就像一条街道，在每个地址上都有一所房子，里面有 8 个……是的。

## 章节/页码

解释文件系统。“你或我可能会使用活页夹重新排列页面，但计算机必须列出一章的*所有*页面，因为它无法重新排列页面......”

## 明信片或包裹

网络堆栈。写下这周的假期。通过在明信片上写上 Jacks 地址发送给 Jack，邮件员工通过邮政编码发送它......等等。

## Bittorrent 作为谣言工厂

跟踪器跟踪谁对某个主题感兴趣，但不关心该主题本身。所以你问追踪者还有谁感兴趣，并让他们告诉你一些关于这件事的事情。

* * *

通常，诀窍似乎是在现实生活中找到具有相似形式或过程的事物。不是（通常）[平凡](http://www.catb.org/~esr/jargon/html/M/mundane.html)的人是愚蠢的，只是他们没有明智的切入点。

还有一大堆其他人。我需要考虑一下。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2008-10-14T20:24:54.983

写代码就像更换火花塞

![替代文字](https://i.stack.imgur.com/LH72b.gif)

# asp.net - ASP.NET 压缩

> ID：202653
> 
> 赞同：4
> 
> 时间：2008-10-14T20:22:23.053
> 
> 标签：asp.net, compression

从之前关于尝试提高网站性能的帖子中，我一直在研究 HTTP 压缩。我已经阅读了有关在 IIS 中设置它的信息，但对于所有 IIS 应用程序池来说，这似乎是一个全局性的事情，我可能不允许这样做，因为它上面还有另一个站点正在运行。然后我看到了一些代码放入 global.asax 以在每个网站的基础上实现相同的目标。

[见这里](http://www.stardeveloper.com/articles/display.html?article=2007110401&page=1)[http://www.stardeveloper.com/articles/display.html?article=2007110401&page=1]](http://www.stardeveloper.com/articles/display.html?article=2007110401&page=1]) [1](http://www.stardeveloper.com/articles/display.html?article=2007110401&page=1)

这和 IIS 中的设置一样好吗？效果如何？有任何已知问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-15T04:33:16.307

如果你继续这样做，我建议实施 HttpModule 与 global.asax。HttpModule 允许您通过配置更改而不是重建来禁用压缩，并允许您使用与 Web 应用程序分开的压缩程序集进行猴子。

Rich Crane 在这里有一个相当不错的 2.0 模块：http: [//www.codeplex.com/httpcompression/](http://www.codeplex.com/httpcompression/)如果您想快速启动和运行。

Steven Rogers 提到的[吹风机](http://blowery.org/httpcompress/)项目也是一个 HttpModule。

否则，编写自己的代码非常简单。HttpModule 为您提供与 global.asax 相同的事件 - BeginRequest、EndRequest 和更细粒度的事件，如 PostReleaseRequestState 和 PreSendRequestHeaders，您可能需要消除所有这些问题。

就 IIS 压缩与 HttpModule 而言，IIS 绝对更容易，因为您不必为另一个程序集大惊小怪。我在业务应用程序中使用了这两种方法，并且在负载测试下两者的性能大致相同。如果 IIS 可用，我会说使用它。

gzip 对 HTML、JS、CSS 和 XML 文件进行 60% 到 80% 的压缩是很常见的。请记住，您的许多有效负载可能是更难压缩的图像和多媒体对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-14T22:06:11.317

[http://blowery.org/httpcompress/](http://blowery.org/httpcompress/)

我们在我的工作中使用了这个压缩工具有一段时间了。不错。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-14T20:32:26.637

我认为 Global.asax 选项将是一个很好的选择，例如，如果您在共享主机环境中，您无法访问 IIS 配置。

IIS 6 提供基本的压缩支持，但如果您已经在 IIS 7 中，它会为您提供出色的[HTTP 压缩](http://blogs.iis.net/ksingla/archive/2006/06/13/changes-to-compression-in-iis7.aspx)支持，您可以根据配置文件中的 MIME 类型定义哪些文件被压缩...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-14T20:42:20.207

它实现了与 IIS 压缩基本相同的功能 - 最终都使用 gzip 压缩发送响应。我最近实现了这种方法，它始终将响应大小减少了 60%，而且没有值得担心的性能影响。

有几个可能的问题。首先，您需要小心输出缓存。您需要使用自定义 VaryBy 以确保为具有不同 Accept-Encoding 标头的请求缓存不同的版本。否则，如果压缩版本被缓存，那么所有用户都会收到它，无论他们的浏览器是否可以接受它。

其次，如果您使用 Response.End 或 Response.Flush，GZipStream 有时会截断响应中的最后几个字符，因为流直到为时已晚才关闭。我不知道有什么好的解决方案。

最后，这只会压缩您的 HTML。任何 CSS 或 Javascript 文件都将正常提供。例如，您需要通过自定义 IHttpHandler 提供这些文件以压缩它们。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-23T12:51:32.237

JavaScript 和 VBScript 存在问题。JavaScript 问题已在 xxldaniel 对[编码恐怖文章](http://www.codinghorror.com/blog/archives/000122.html)的评论中得到确认，并且我在使用类似于 JSON 的“Scripting.Dictionary”和“Microsoft.XMLHTTP”请求时遇到了 VBScript（用于 M$ Office 自动化）的问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-07-15T13:33:45.520

你可以试试[mod_gzip](http://www.helicontech.com/ape/doc/mod_gzip.htm)模块。它使用托管 ZLib 版本并允许高度可调的配置。语法与同名的 Apache 模块兼容，甚至可以扩展。因此，例如，您可以为不同的 mime 类型设置不同的压缩级别等等。

# lotus-notes - 导致错误 4063 的原因 - 数据库...数据库名称...尚未打开

> ID：202660
> 
> 赞同：1
> 
> 时间：2008-10-14T20:24:41.100
> 
> 标签：lotus-notes

我有一个计划代理正在尝试访问另一台服务器上的数据库。当它运行时，我收到错误 4063 - 数据库...数据库名称...尚未打开。

服务器在 ACL 中列为管理器。

此错误的其他一些可能原因是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-04T13:26:56.600

其他服务器是否信任执行代理的服务器？检查服务器文档 -> 安全 -> 受信任的服务器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-20T18:47:12.480

可以在不打开数据库的情况下获得数据库句柄。如果您尝试调用大多数方法而不先打开它，那么您将收到该错误。最可能的解释是您无权打开它。

什么id签了agent？可能不是服务器。代理将以代理签名者的权限运行，因此这是您尝试打开的数据库的 ACL 中需要的 id。

关于代理如何在不同的权限下并代表不同的用户运行，有很多规则。如果情况需要，这可能会变得非常复杂。但请检查代理签名者是否有权首先打开数据库，然后查看任何“代表运行”设置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-20T13:38:16.793

检查数据库所在服务器的服务器文档。在访问服务器部分中，受信任的服务器字段是否包含运行代理的服务器名称？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-01-26T09:19:31.750

一个提示：事先打印出 db.Server 和 db.Filepath 以查看您要打开的确切内容。

# com - 尝试创建 COM 对象时出现“对象变量或未设置块变量”

> ID：202662
> 
> 赞同：0
> 
> 时间：2008-10-14T20:25:24.467
> 
> 标签：com, vb6, dcom

我有一个 VB6 dll 正在尝试使用以下代码行创建一个 COM 对象：

```
Set CreateObj = CreateObject("OPSValuer.OPSValue") 
```

但是，这会失败并出现错误“对象变量或未设置块变量”。

我可以在 dcomcnfg 中看到 OPSValuer.OPSValue 并且它似乎注册得很好。有没有人对可能导致问题的原因有任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-14T21:13:19.130

您尝试实例化的类可能未正确安装或缺少某些依赖项。如果您有权访问 OLE 视图，则可以尝试在 VB 之外实例化该类。如果它不会实例化，那么您的安装错误或缺少依赖项。OLE View 随 Visual Studio 一起提供，在您的系统上搜索 OleView.exe。

它位于我的系统上：D:\Program Files\Microsoft Visual Studio 8\Common7\Tools\Bin

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-15T01:12:57.787

DMKing 对 OleView 的看法是正确的。还可以尝试查看[Dependency Walker](http://www.dependencywalker.com/)中的控件，任何缺少的依赖项都应该很快浮出水面。

由于这是一个 DCom 组件，因此组件构造函数中也可能出现故障，如果构造函数中出现任何故障，您将收到该错误。这是本地 DCom 对象还是在另一层上运行的东西？

而不是 CreateObject 尝试用标准的 New 实例化它，看看它是否会给你一个不同的错误。添加引用本身可能有助于确定该错误。您使用后期绑定而不是早期绑定是否有原因？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-14T21:18:10.587

该错误可能会在对象初始化例程中引发。我在 Google 上找不到“OPSValuer.OPSValue”，这让我认为这是遇到错误的自定义代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-17T19:15:22.203

假设是一个用 VB 编写的组件，这可能是在该组件事件中`OPSValuer.OPSValue`引发的错误。`Class_Initialize`如果你有组件的源代码，它应该很容易调试。

# vb6 - VB6，文件不存在，如何优雅处理？

> ID：202663
> 
> 赞同：5
> 
> 时间：2008-10-14T20:25:29.850
> 
> 标签：vb6, file-io

我正在测试一个检查文件是否存在于网络中的应用程序。在我的测试中，我故意拔掉网络插头，这样就找不到文件了。问题是这会导致我的应用程序在至少 15 秒内无响应。我在 VB6 中同时使用了 FileExists() 和 GetAttr() 函数。有谁知道如何解决这个问题？（不，我不能停止使用 VB6）

谢谢，查理

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-16T01:19:13.093

不幸的是，VB 并没有让这变得简单，但幸运的是 Win32 API 做到了，而且从 VB 中调用 Win32 函数非常简单。

对于 LAN/WAN，您可以使用以下 Win32 API 调用的组合来告诉您远程连接是否存在，而无需处理网络超时：

```
Private Declare Function WNetGetConnection Lib "mpr.dll" Alias _
    "WNetGetConnectionA" (ByVal lpszLocalName As String, _
    ByVal lpszRemoteName As String, ByRef cbRemoteName As Long) As Long

Private Declare Function PathIsNetworkPath Lib "shlwapi.dll" Alias _
    "PathIsNetworkPathA" (ByVal pszPath As String) As Long

Private Declare Function PathIsUNC Lib "shlwapi.dll" Alias "PathIsUNCA" _
    (ByVal pszPath As String) As Long 
```

对于 Internet，您可以使用 Win32 API 调用：

```
Private Declare Function InternetGetConnectedState Lib "wininet.dll" _
    (ByRef lpdwFlags As Long, ByVal dwReserved As Long) As Long

Const INTERNET_CONNECTION_MODEM = 1
Const INTERNET_CONNECTION_LAN = 2
Const INTERNET_CONNECTION_PROXY = 4
Const INTERNET_CONNECTION_MODEM_BUSY = 8 
```

这个 VB 站点有更多关于[可以通过 VB 在 Win32 API 中调用的面向路径的函数的讨论。](http://vbnet.mvps.org/index.html?code/fileapi/pathisnetworkpath.htm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-02-16T17:22:16.767

也用这个

```
Dim FlSize as long 
flsize=filelen("yourfilepath")
if err.number=53 then msgbox("file not found")
if err.number=78 then msgbox("Path Does no Exist") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-14T20:28:47.237

我不确定您是否可以更优雅地处理这个问题 - 如果网络出现问题，超时可能需要一段时间才能表明问题严重到无法正常工作。

如果 VB6 支持线程（老实说我不记得了），您可以将文件打开到后台线程中，并让 UI 允许用户取消它（或在有意义的情况下执行其他操作），但这引入了一个非常重要的额外的复杂性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-14T20:53:02.447

VB 本质上是单线程的，但您可以将工作转移到 COM 组件来执行异步文件检查并在完成时标记事件。这样，UI 线程至少保持响应。麻烦的是 - 这都是理论，我不知道这样的组件。

可是等等！谷歌刚刚发现了这个：[Visual Basic 6 Asynchronous File I/O Using the .NET Framework](http://msdn.microsoft.com/en-us/library/bb381704(VS.80).aspx)。这可能有帮助吗？

此外，他们在 CodeProject 上也有类似的内容：[异步处理 - 基础知识和 VB6/VB.NET 演练](http://www.codeproject.com/KB/vbscript/AsyncSample.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-14T20:56:15.577

VB6有一些联网功能，可以测试看网络是否连通。您应该能够在“参考”下添加“NetCon 1.0 类型库”。这会为您添加 NETCONLib。实施后，您应该能够首先测试网络连接，然后测试 FileExists 和 GetAttr。

让我知道这是否有帮助！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-10-08T18:59:08.543

此代码仅用于检查您的一个问题的连接（也许可以帮助您）：

```
Private Declare Function InternetGetConnectedState Lib "wininet.dll" (ByRef dwFlags As Long, ByVal dwReserved As Long) As Long

Private Const CONNECT_LAN As Long = &H2
  Private Const CONNECT_MODEM As Long = &H1
  Private Const CONNECT_PROXY As Long = &H4
  Private Const CONNECT_OFFLINE As Long = &H20
  Private Const CONNECT_CONFIGURED As Long = &H40

  Public Function checknet() As Boolean
Dim Msg As String

      If IsWebConnected(Msg) Then
checknet = True
      Else
         If (Msg = "LAN") Or (Msg = "Offline") Or (Msg = "Configured") Or (Msg = "Proxy") Then

          checknet = False
          End If
      End If

  End Function

Private Function IsWebConnected(Optional ByRef ConnType As String) As Boolean
      Dim dwFlags As Long
      Dim WebTest As Boolean
      ConnType = ""
      WebTest = InternetGetConnectedState(dwFlags, 0&)
      Select Case WebTest
          Case dwFlags And CONNECT_LAN: ConnType = "LAN"
          Case dwFlags And CONNECT_MODEM: ConnType = "Modem"
          Case dwFlags And CONNECT_PROXY: ConnType = "Proxy"
          Case dwFlags And CONNECT_OFFLINE: ConnType = "Offline"
          Case dwFlags And CONNECT_CONFIGURED: ConnType = "Configured"
          Case dwFlags And CONNECT_RAS: ConnType = "Remote"
      End Select
      IsWebConnected = WebTest
  End Function 
```

**在您的活动中：**

```
If checknet = False Then

...

else

...

end if 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-10-14T21:08:32.710

我同意威尔。这样的事情很容易用 Script.FileSystemObject 处理：

```
Dim objFSO As New FileSystemObject 
If objFSO.FileExists("C:\path\to\your_file.txt") Then
    ' Do some stuff with the file
Else
    ' File isn't here...be nice to the user.
EndIf 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-10-16T00:47:31.317

通过网络访问文件可能会导致这些挂起。

已经有一段时间了，但我记得 VB6 中的多线程实现起来相对痛苦。一个快速的解决方案是拥有一个可以处理此问题的小型 .exe（可能也在 VB 中编码）。您可以使用 DDE 进行应用程序间通信，或者使用非常简单但复杂的基于文件的管道，我的意思是两个应用程序将相互读取/写入以处理应用程序间通信的文件。当然，根据这个场景的细节，使用基于文件的管道可能会简单地夸大文件 I/O 延迟。

如果您可以在一定程度上预测用户将从哪里选择文件，您可以考虑先发制人地缓存目录列表并读取它而不是直接读取文件 - 假设目录内容不会经常更改。注意：通过网络获取目录列表将导致与通过网络获取单个文件 I/O 相同的延迟问题。记在脑子里。

# c# - Windows 窗体布局引擎

> ID：202669
> 
> 赞同：3
> 
> 时间：2008-10-14T20:28:12.900
> 
> 标签：c#, winforms, layout

是否有人拥有或知道在 WinForms 中实现自定义布局引擎的最佳实践？我看过[windowsclient.net](http://msdn.microsoft.com/en-us/library/ms973821.aspx)链接，但它有点过时（2001 年 9 月）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-14T21:14:45.133

当我尝试在 WinForms 中做自定义布局引擎时，我被 IArrangedElement 接口是内部的事实所阻止。它看起来很愚蠢，但除非您自己开发 System.Windows.Forms，否则您似乎无法以统一的方式获取布局属性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-21T10:38:53.070

您可以随时查看[DevExpress Layout Control](http://www.devexpress.com/Products/NET/Controls/WinForms/Layout/)。它不是免费的，但它令人大开眼界。

# internet-explorer - 我可以为 Internet Explorer 设置不同的数据目录吗？

> ID：202677
> 
> 赞同：5
> 
> 时间：2008-10-14T20:30:01.727
> 
> 标签：internet-explorer, command-line, google-chrome, sandbox

在 Google Chrome 中，我可以提供命令行参数 --user-data-dir="..." 让 Chrome 使用不同的目录来存储状态，如 cookie、缓存等。这使得从“新”浏览器轻松加载网页并模拟多个独立用户成为可能。

如何使用 Internet Explorer（6、7 或 8）做同样的事情？

**编辑**：看起来 IE 总是使用当前用户的配置文件，所以你必须在系统上设置多个用户并在它们之间切换。多么痛苦。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-14T22:30:06.667

我能想到的一个建议是在盒子上创建多个用户帐户，然后使用[RunAs 命令](http://technet.microsoft.com/en-us/library/cc781769.aspx)或使用 Run As...[上下文菜单选项](http://technet.microsoft.com/en-us/library/cc781763.aspx)创建 Internet Explorer 的快捷方式。

另见：
[http ://www.krunk4ever.com/blog/2006/12/01/how-to-run-explorerexe-as-another-user/](http://www.krunk4ever.com/blog/2006/12/01/how-to-run-explorerexe-as-another-user/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-14T20:42:57.957

呵呵。

使用 Chrome、FF 等。我实际上可以在一台机器上拥有多个*版本*并在不受干扰的情况下对其进行测试。IE 要求我设置虚拟机。因此，我编写的大部分代码只能在 IE6 上经过严格测试（因为这是在主机操作系统上安装的）。IE，如果你能原谅我的俚语，是个婊子——我不知道他们是如何在 MS 中有效地测试它的。

这就是说...你可以得到你想要*的东西。*如果您正在运行 XP 并且*不在*域中，或者正在运行 Vista，您可以配置“[快速用户切换](http://en.wikipedia.org/wiki/Fast_User_Switching)”。然后，配置多个用户帐户。最后，登录每一个，在每一个中启动 IE，并确保他们使用不同的配置文件/数据目录。或者，如果您正在运行 Windows 的服务器版本之一（我偏爱 2k3 r2），您可以设置终端服务并简单地使用[RDC](http://www.microsoft.com/windowsxp/downloads/tools/rdclientdl.mspx)创建多个并发登录。

# php - 从 Eclipse PDT 转换为 Vim

> ID：202685
> 
> 赞同：9
> 
> 时间：2008-10-14T20:32:54.593
> 
> 标签：php, eclipse, vim, eclipse-pdt

我真的很喜欢 VIM——它是我遇到的少数几个让你内心感到温暖和模糊的应用程序之一。但是，对于 PHP 开发，我仍然使用 PDT Eclipse，尽管我很想切换。

我现在不能完全理解的原因是我非常依赖的 CTRL+SPACE 代码辅助功能 - 它非常有用，尤其是在类型提示或使用 PHPDoc 变量注释块时。

我知道那里有很酷的 VIM 插件，它们可能可以复制这个功能，然后是一些 - 但它们是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-14T20:46:36.967

Vim内置了[OmniCompletion](http://vimdoc.sourceforge.net/htmldoc/version7.html#new-omni-completion)，你应该把它添加到你的 .vimrc 中：

```
filetype plugin on
au FileType php set omnifunc=phpcomplete#CompletePHP 
```

另外我推荐你这个插件：

*   [VTreeExplorer](http://www.vim.org/scripts/script.php?script_id=184)
*   [片段鸸鹋](http://www.vim.org/scripts/script.php?script_id=1318)

也可以看看[这篇](http://tech.blog.box.net/2007/06/20/how-to-debug-php-with-vim-and-xdebug-on-linux/)关于 Vim 中的 php 调试的文章，这篇[文章](http://www.scribd.com/doc/263139/VIM-for-PHP-Programmers)有很多关于在 PHP 开发中使用 Vim 的有用技巧。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-14T20:46:07.407

代码辅助它是 VIM 7 的新功能 [Ctrl+x] [Ctrl+o] 将自动完成您的代码或打开一个选项弹出窗口

VIM 7 的更多功能可以在这篇[博文中找到](http://linuxhelp.blogspot.com/2006/09/visual-walk-through-of-couple-of-new.html)

顺便说一句，我也喜欢 vim，但 PDT（和其他 IDE）的功能比代码辅助要多得多，这让我更喜欢它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-15T19:03:32.073

查看[SuperTab](http://www.vim.org/scripts/script.php?script_id=1643)以使 Vim 中的制表符自动完成功能比标准绑定更易于使用。如果您正在研究代码索引，您可能还想研究 ctags。 [谷歌“php vim ctags”](http://www.google.com/search?q=vim+ctags+php)，你会看到很多描述如何设置的文章。

官方 Vim Wiki 有一个[PHP 部分](http://www.vim.org/scripts/script.php?script_id=1643)，其中包含一些很好的技巧，例如集成官方 PHP 文档。

# .net - 什么是 .net 动态数据，我为什么要使用它？

> ID：202697
> 
> 赞同：8
> 
> 时间：2008-10-14T20:38:18.560
> 
> 标签：.net, dynamic-data

什么是 .net 动态数据，我为什么要使用它？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-14T20:41:42.297

ScottGu[的博客](http://weblogs.asp.net/scottgu/archive/2007/12/14/new-asp-net-dynamic-data-support.aspx)中关于如何使用动态数据的精彩文章。

> 很酷的新功能之一是我们称之为“ASP.NET 动态数据支持”的东西。简而言之，这使您能够真正快速地构建针对 LINQ to SQL（以及未来的 LINQ to Entities）对象模型的数据驱动的网站 - 并且可以选择允许您执行此操作而无需手动构建任何页面。

请参阅此[截屏视频](http://blogs.msdn.com/davidebb/archive/2007/12/12/dynamic-data-screencast-is-now-available.aspx)。这是非常有启发性的。

来自更官方的[ASP.NET 动态数据站点](http://www.asp.net/dynamicdata/)：

> ASP.NET 动态数据提供了一个框架，使您能够基于 LINQ to SQL 或实体框架数据模型快速构建功能性数据驱动的应用程序。它还以智能验证的形式为 DetailsView、FormView、GridView 和 ListView 控件增加了极大的灵活性和功能，并能够使用模板轻松更改这些控件的显示。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-14T21:50:23.080

它是一个集成到现有 ASP.NET 控件（如 GridView）中的插件。它着眼于 LINQ2SQL 或 EF 公开的模型，以提供更丰富的编辑界面。将它用于简单的 CRUD 应用程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-14T21:19:50.067

这是一个很好的工具，可以非常快速地制作一个简单的应用程序。用于原型设计或非常简单的网站，或临时“桥接”网站，以便在编写真正的应用程序时让用户启动并运行。

这不适用于构建具有复杂 UI、大量业务逻辑或非 CRUD 功能的强大、可扩展的企业应用程序。

它是您工具带的一种工具，而不是通用工具。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-14T20:53:44.300

ASP.NET DDS 是这里和那里的拖放更改，并且您有一个数据驱动的 Web 应用程序准备好去做一些事情。

[Matt Berseth](http://mattberseth.com/)有[一些关于此的好帖子](http://mattberseth.com/blog/dynamic_data/)

# silverlight-2.0 - 在 Silverlight 中克隆业务对象的最佳方法是什么？

> ID：202699
> 
> 赞同：8
> 
> 时间：2008-10-14T20:38:55.797
> 
> 标签：silverlight-2.0, clone

创建 DTO 克隆的最佳方法是什么？Silverlight 中没有 ICloneable 接口或 BinaryFormatter 类。反思是唯一的方法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2010-02-03T22:27:06.173

这是我们提出的用于克隆的代码。这适用于 Silverlight 2 和 3。

```
Public Shared Function Clone(Of T)(ByVal source As T) As T
    Dim serializer As New DataContractSerializer(GetType(T))
    Using ms As New MemoryStream
        serializer.WriteObject(ms, source)
        ms.Seek(0, SeekOrigin.Begin)
        Return DirectCast(serializer.ReadObject(ms), T)
    End Using
End Function 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-10-13T09:10:01.517

ICloneable 在 Silverlight 4 中不可用（我不知道 1/2/3 或即将发布的版本）。它已从 Silverlight 4 的公共 API 中删除。来自 Mike Schall 代码的帮助；它对我有用。

```
public LayerDto Clone(LayerDto source)
    {

        DataContractSerializer serializer = new DataContractSerializer(typeof(LayerDto));
        using (MemoryStream ms = new MemoryStream())
        {
            serializer.WriteObject(ms, source);
            ms.Seek(0, SeekOrigin.Begin);
            return (LayerDto)serializer.ReadObject(ms);
        }
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-10-13T08:53:21.987

如果我的源是 IEnumerable，如何创建克隆。这个LayerDto 也有一些对象类型（例如MetaItemDto）。

代码 ：

公共类 LayerDto { }
公共类 MetaItemDtoList ： System.Collections.ObjectModel.ObservableCollection { }

公共静态 IEnumerable 克隆（IEnumerable 源）

{

```
 IEnumerable<LayerDto> layers;

        DataContractSerializer serializer = new DataContractSerializer(typeof(IEnumerable<LayerDto>));
        using (MemoryStream ms = new MemoryStream())
        {
            serializer.WriteObject(ms, source);
            ms.Seek(0, SeekOrigin.Begin);
            //return (IEnumerable<LayerDto>)serializer.ReadObject(ms);
            layers = (IEnumerable<LayerDto>)serializer.ReadObject(ms);
            return layers;
        } 
```

}

但我面临的问题是该层没有显示它的元项目（对于每一层）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-19T21:10:15.000

我相信标准的克隆功能被遗漏了，以保持它的简单和轻量。我相信您可以使用 JSON 或 XML 序列化来实现相同的目标。但不确定性能成本。

# delphi - 如果 Delphi TSpeedButton 是组中唯一的一个，如何使其保持按下状态

> ID：202702
> 
> 赞同：12
> 
> 时间：2008-10-14T20:40:13.033
> 
> 标签：delphi, vcl, button

我不确定为什么 TSpeedButton 具有此属性，但是当 TSpeedButton 是给定 groupindex 的唯一按钮时，无论是否按下“AllowAllUp”，它都不会保持按下状态。也许绝地控制就足够了，但希望有一些解决办法。任何帮助或轶事表示赞赏。

顺便说一句，我（仍在）使用 Delphi 7，不确定这是否是一个全面的难题。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-10-14T20:47:15.920

我这里没有 D7，但在 D2006 中，如果 GroupIndex 的值 > 0，则 Speedbutton 保持关闭。

如果这不是您希望的行为，您可以在 OnClick-Eventhandler 中手动设置 Down-Property（确保 GroupIndex 为 0）。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-10-15T15:46:06.853

我刚刚在 Delphi 7 (Build 4.453) 中尝试过：

*   创建新应用程序
*   添加`TSpeedButton`到表单
*   放`AllowAllUp := true;`
*   放`GroupIndex := 1;`
*   运行应用程序

单击按钮时，它会切换其向下状态，而无需任何其他代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-14T21:48:12.943

Knight_killer 是正确的。我可以告诉你它可以在任何版本的 delphi 中工作：

```
object SpeedButton1: TSpeedButton
  Left = 152
  Top = 384
  Width = 23
  Height = 22
  AllowAllUp = True
  GroupIndex = 99
end 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-06-01T15:45:32.477

Delphi 为您完成工作，因此“不要编写任何代码”。

在 IDE 中选择您要作为一个组操作的所有 SpeedButton，然后将整个组的“GroupIndex”设置为“0”以外的其他值，您就完成了 - 没有代码 - NADA！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-14T20:45:15.630

嗯，很奇怪，我记得用这个成功了好几次。也许您应该尝试使用 SpeedButton 的`Down`属性？我不认为当你点击它时它会自动切换——你应该明确地切换`Down`，我猜......

[编辑：替换`Checked`为`Down`--- TSpeedButton 没有`Checked`属性，抱歉！]

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-03-10T06:14:01.663

要使其正常工作，您不能只切换 Down 属性，因为它在 OnClick 事件中始终处于关闭状态。你需要有另一个值：

```
procedure TForm1.SpeedButton1Click(Sender: TObject);
begin
  MyBoolProperty := not MyBoolProperty;
  SpeedButton1.Down := MyBoolProperty;
end; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-29T16:36:28.207

我正在为我的问题寻找解决方案，我认为这有点像。我想让 SpeedButton 像开关一样切换上下状态，我通过设置属性来管理它：

```
AllowAllUp := True; 
GroupIndex := 1; 
```

然后在`OnClick`按钮的情况下我写道：

```
procedure TForm1.SpeedButton1Click(Sender: TObject);
begin
  if( SpeedButton1.AllowAllUp ) then 
  begin 
    SpeedButton1.AllowAllUp := False; 
    SpeedButton1.Down := True; 
  end else 
  begin 
    SpeedButton1.AllowAllUp := True; 
    SpeedButton1.Down := False; 
  end; 
end; 
```

这会在单击按钮时向下切换按钮，并在再次单击按钮时向上切换。

希望它会有所帮助

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-30T07:17:45.667

诀窍是将 GroupIndex 设置为唯一值并将 AllowAllUp 设置为 true。如果你忘记了第一个，它就不会停下来，如果你忘记了第二个，它就不会再上升，一旦它下降了。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-03-04T23:05:45.050

将 AllowAllup 设置为 true，将 Down 设置为 false。

然后在`OnClick`事件中：

```
....
btn.AllowAllUp := not btn.AllowAllUp;
btn.Down       := not btn.Down;
.... 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-04-03T14:55:50.027

将 AllowAllUp 设置为 True。

将 GroupIndex 设置为非 0。

要将其全部保留在 OnClick 中，请尝试

```
 with Speedbutton1 do
 begin
      if tag = 1 then tag := 0 else tag := 1;
      down := (tag = 1);
 end; 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-10-20T11:57:58.297

`GroupIndex`对按钮进行分组。该组中只有一个按钮可能处于活动状态。它们都需要具有高于 的相同索引`0`。

`AllowAllUp`当连续点击 2 次时，允许上下切换按钮。

# linux - gtk+ 是否对大多数 linux 应用程序的笨拙外观负责？

> ID：202706
> 
> 赞同：2
> 
> 时间：2008-10-14T20:40:50.240
> 
> 标签：linux, gtk, gnome

现在，我知道这完全是主观的，所以请不要喷我。每当我决定安装像 Ubuntu、Fedora 等发行版时，我从未对 linux 完全满意，因为它们笨拙的定位和小部件的间距。

看看[这个](http://art.gnome.org/themes/gtk2/?sort_by=popularity&limit=12&view=list&order=DESC)：

![替代文字](https://i.stack.imgur.com/HT5d9.png)

![替代文字](https://i.stack.imgur.com/NyCiJ.png)

注意文本字段文本的尴尬间距。

我见过许多表面上看起来不错的 Gnome 主题，但它们都以某种方式崩溃了，尴尬的间距，奇怪的边框。等等。

例如，整个 linux 桌面没有 OSX 的视觉完整性，我想知道为什么。如果有任何好的集成 Linux 环境的例子，请告诉我，我真的很想使用 Linux。

（我知道，有 QT，还有其他管理器，比如 KDE 等。我注意到了同样的事情，所以它可能不仅仅是 GTK 或 Gnome）

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-14T20:45:07.237

我会说这与当时吸引更多编码人员而不是艺术家的开源运动有关。还要记住，苹果在他们的用户界面上花了很多钱，他们仍然接受[批评](http://www.indiehig.com/blog/2007/09/09/fix-the-leopard-folders/)。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-10-14T22:02:12.713

> 例如，整个 linux 桌面没有 OSX 的视觉完整性，我想知道为什么。如果有任何好的集成 Linux 环境的例子，请告诉我，我真的很想使用 Linux。
> 
> （我知道，有 QT，还有其他管理器，比如 KDE 等。我注意到了同样的事情，所以它可能不仅仅是 GTK 或 Gnome）

你基本上只是回答了你自己的问题——Mac OS X 有**一个**桌面环境（以 Cocoa 为中心），它有很多非常优秀的程序员*和*设计师花费大量时间设计、讨论和实现它。

有了“Linux”，不仅有不同的窗口管理器（Gnome、KDE、Flux/OpenBox、Enlightenment 等），还有不同的 UI 工具包（QT、GTK+、Tk、wx 等）、不同的版本（常用） ，以及无数使用/实现它们的不同方式。比较[（主要）Linux GUI 工具包列表与](http://en.wikipedia.org/wiki/List_of_widget_toolkits#Based_on_C_or_C.2B.2B_.28including_bindings_to_other_languages.2)[Macintosh](http://en.wikipedia.org/wiki/List_of_widget_toolkits#On_Macintosh)相比（所有这些，bar Cocoa，都适用于旧的 Mac OS 版本）。

有许多优秀的设计师和程序员在开发 GUI 工具包，但他们分布在许多不同的项目中。即使它们以某种方式被放到一个项目中（例如，“wxQtGnome”），仍然会有无数应用程序使用不同的框架，甚至是不同版本的框架。那么你仍然会遇到不一致的问题。同样，与 Mac OS X 相比，如果你有一个 GUI 应用程序，它很可能会使用 Cocoa（它有一个不错的 UI 创建工具，它可以帮助开发人员根据 Apples Human UI Guidelines 布局应用程序）。

至于一个好的、集成的 linux 桌面环境——我想说默认的 Ubuntu 安装可能是最接近这个的。一个不错的主题，所有应用程序都很好地结合在一起。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-14T21:30:57.267

主题的质量也各不相同。由于其基本选择和优先级，找到一个“严重错误”的主题应该不难。就个人而言，我喜欢非常压缩的主题。我什至使用了以吸引眼球着称的[Enlightenment](http://enlightenment.org)窗口管理器来完全摆脱窗口装饰。所以我可能会选择一个非常狭窄的主题并且非常高兴，尽管奇怪的小故障会让你假发。

相反，我会说 Gtk/Gnome 确实是您查看 GNU/Linux 桌面的真正*原因*。之前发生的事情，[*真的*是一直以来都令人发指](http://www.catb.org/~esr/writings/taouu/html/ch02s06.html#OpenLook) *！*（没有冒犯 XAW 的创造者，但他们可能没有“可舔”作为目标......）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-14T21:38:22.073

我正在将 KDE 与默认主题之一（塑料）一起使用，但我还没有看到任何尴尬的地方。

我也使用 Gtk2 应用程序，但仍然没有看到任何尴尬的地方。您应该知道，使用 Gnome/KDE 未*正式*支持的任何主题都可能存在错误。

然而，所有这些都可能是非常主观的。例如，我发现**某些**Windows XP UI 很笨拙和/或简直丑陋。不同的人有不同的口味和习惯。也许是因为我用的是Windows98，然后是Linux，然后是Windows XP，所以一切都很尴尬。你可能来自另一个方向。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-14T21:40:36.763

问题是双重的：

1.  每个人似乎都在使用他们选择的 UI 工具包，这导致了应用程序的严重不匹配。
2.  UI 设计师的成本很高，因此 Linux 中的大多数 UI 工作都是业余的，这表明了这一点。

此外，主题是邪恶的，不应该实施。但这只是我的 IHMO，它完全破坏了一致性。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-14T20:45:55.097

你知道，这只是一种不同的方法。特定主题之间的差异是不可避免的，因为没有任何共同的指导方针，AFAIK。

对我来说，Linux 主题是完全不可或缺的，我还没有经历过任何尴尬的感觉。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-14T20:57:20.207

好吧，类似 OSX 的主题具有未对齐的文本位置，但您链接的页面上的大多数其他主题对我来说都很好？

此外，修复这些东西并不难。正如@nemo 所说，在自由软件世界中，编码人员比艺术家多“方式”。如果您作为艺术家向主题制作者提出建议，它们可能会被合并到下一个版本中。这就是自由和开源软件世界的运作方式。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-16T16:41:18.083

至于示例图片，也许您可​​以为您喜欢的 GUI（Mac OS、Window ...）发布类似的图片？这可能更容易比较 GUI 并查看细微的差异。

无论如何，我认为 art.gnome.org 上的预览图像并不代表真实外观。如果您想将 GTK+ GUI 与其他工具包进行比较，我建议您查看真实应用程序的屏幕截图。比如默认主题的 Ubuntu 就应该很有代表性。

顺便提一句。Gnome HIG（人机界面指南）有一章关于布局和间距： http: [//library.gnome.org/devel/hig-book/stable/design-window.html.en](http://library.gnome.org/devel/hig-book/stable/design-window.html.en)。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-08-19T07:47:34.787

我不认为 GTK+ 本身对 Linux 应用程序的“尴尬外观”（这是您的主观意见！）负责。

事实上，GTK+*非常*灵活，可以为小部件应用主题甚至完全不同的渲染引擎（例如，参见流行的[Murrine](http://www.cimitan.com/murrine/)引擎）。它比 Windows 和 Mac OS X 的原生 GUI 库灵活得多。

你可以在例如[gnome-look.org](http://www.gnome-look.org/)上找到很多 GNOME 主题。甚至还有 GNOME 主题让您的 GNOME 桌面看起来几乎与 Windows Vista 或 Mac OS X 完全一样（我不明白为什么有人会想要它，但这是个人的事情......）。

一段时间以来，Ubuntu 背后的公司 Canonical 一直在表示，他们正在聘请专业设计师为未来的 Ubuntu 版本创建一个非常时尚且专业设计的桌面主题。

# database - 巨大的（20 位）主键和 SQLite

> ID：202714
> 
> 赞同：5
> 
> 时间：2008-10-14T20:43:11.500
> 
> 标签：database, sqlite, primary-key

如果我尝试将具有 20 位主键的数据插入 SQLite 数据库，第二个插入语句会出错，因为它“不是唯一的”。如果我选择从 SQLite 命令提示符中可以看到的值，则主键是用科学计数法编写的。列类型为十进制。有没有办法强制 SQLite “按原样”插入值，即使值那么长，也能保持精度/“正常表示”？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-14T20:46:51.053

将其作为“字符串”插入，而不是数字。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-14T20:53:17.720

主键字段必须是整数，最大值为 9223372036854775807。使用单独的（索引）字段，并将值作为字符串插入。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-23T00:38:06.467

奇怪，听起来您的包装器将数字作为浮点数放入。我认为 DECIMAL 在内部映射到整数。使用字符串会起作用，但对字符串而不是 int 的索引可能会很慢。

# database - 哪个免费数据库系统最适合存储和计算/分析大型文本比较，数据库可以从中得出可用的统计数据？

> ID：202715
> 
> 赞同：-3
> 
> 时间：2008-10-14T20:43:44.430
> 
> 标签：database, performance, system

我必须创建可以比较数千个大文本（彼此）的脚本。我想知道 MySQL 是否是最好的解决方案。有没有其他免费的数据库系统可以用来做简单但耗时的计算？

请把我扔进你的知识池！

编辑：文档的性质 - 500-7000 个字符的文档，-> 如果文本与其他文档匹配（抄袭）和统计数据，则比较文档 -> 找到具有类似设置的任何句子的百分比匹配我想设置多少个字符另一个字符串可能不同，仍被视为匹配项..

技术应该是基于服务器的，我对 DB 更感兴趣，然后我会选择合适的语言来编写脚本。

更多规范：数据库的大小必须是无限的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-14T21:12:18.583

您应该考虑使用 Lucene。它允许您存储大量文本并快速查询它们。具有良好的相关性匹配。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-14T20:50:45.867

你没有提到你将使用的技术；文本条目的大小或比较的性质。但是，我建立的[h2 数据库](http://www.h2database.com/html/main.html)非常出色。它是本机 Java，可用作内存数据库，使设置变得简单。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-14T20:52:31.213

PostgreSql 是一个免费的数据库引擎，除了 MySQL 之外，它具有良好的可扩展性和广泛使用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-14T20:45:10.900

Sql 服务器快递

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-14T21:10:28.650

我会推荐MySQL。它有很多内置的字符串处理函数。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-14T21:19:49.117

因为你没有指定，为什么不**[SQL Server 2008 Express Edition](http://www.microsoft.com/express/sql/default.aspx)**？

大哥 SQL Server 2008 的所有搜索功能，唯一的问题是不能超过 4Gb 的数据库。

# asp.net - ASP.NET 中的后退按钮上的随机 Page_Load 调用

> ID：202717
> 
> 赞同：0
> 
> 时间：2008-10-14T20:44:29.967
> 
> 标签：asp.net, ajax, asp.net-ajax

我希望有人以前见过这个，因为我一生都找不到问题。

我正在尝试在应用程序中执行旧的“修复后退按钮”操作，我认为我有一个相当不错的方法，问题是它依赖于应用程序在您回击时不调用 page_load 而是加载缓存版本的页面。

在我大约 60% 的页面上，这正是发生的情况。它加载缓存的版本，一切都很好。在另外 40% 时，当我点击返回按钮 page_load 调用时，强制刷新。作为参考，对 page_load 的调用不在回发中。

更奇怪的是，这只发生在 IE (6 & 7) 中。在 Firefox page_load 中永远不会被调用。

我在这两种类型的页面上都使用了 ASP.NET Ajax 框架。以前有人见过这样的事情吗？

- 更新 -

在进行了更多调查后，我发现当我使用搜索从一个页面导航到另一个页面时，应用程序对于不同页面的行为不同。在损坏的页面上，page_load 被调用了两次，搜索被调用了两次，在 fiddler 中，它变成了 2 个不同的重定向回发，其中第二个没有设置缓存。

在工作页面 page_load 和搜索只发生一次，它会立即重定向。

第二个 Response.Redirect 导致了这个问题。仍然不确定为什么会这样。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-15T03:01:53.200

检查服务器为缓存控制 http 标头返回的内容，然后尝试设置 Response.Cache.SetCacheability()/ 在页面上使用输出缓存页面指令，看看服务器是否说应该缓存页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-14T21:14:58.220

如果您使用的是 ASP.NET AJAX，为什么不使用历史服务器控件对象？

替换历史，后退按钮将转到您想要的链接。

[试试这个](http://quickstarts.asp.net/Futures/ajax/doc/history.aspx)

# c++ - 函数调用的结果可以用作默认参数值吗？

> ID：202718
> 
> 赞同：6
> 
> 时间：2008-10-14T20:44:37.113
> 
> 标签：c++, parameters, default-value

有没有一种很好的方法来编写带有函数调用的默认参数的 C/C++ 函数头？

我有一些带有该功能的标题：

```
int foo(int x, int y = 0); 
```

我在一个大型代码库中工作，其中许多函数调用此函数并依赖于此默认值。这个默认值现在需要更改为动态的，我正在寻找一种方法：

```
int foo(int x, int y = bar()); 
```

其中 bar() 是一些基于某些系统参数生成默认值的函数。或者，这个函数原型看起来像：

```
int foo(int x, int y = baz.bar()); 
```

其中 baz 是属于尚未在头文件中实例化的对象的函数。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-14T20:48:11.707

去搞清楚！它确实有效。[C++ 函数中的默认参数](http://publib.boulder.ibm.com/infocenter/lnxpcomp/v8v101/index.jsp?topic=/com.ibm.xlcpp8l.doc/language/ref/cplr237.htm)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-14T20:52:38.327

我会使用两个重载函数：

`int foo(int x, int y);`

`int foo(int x){return foo(x,bar);}`

如果您允许内联转发函数，那么性能损失可能会小到零。如果你在非头文件中保持它的主体不符合要求，可能会产生性能成本（可能很小），但在实现方面会有更大的灵活性并减少耦合。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-14T20:47:20.180

是的。你所写的作品。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-14T20:52:44.833

简单地删除第一个声明中的可选参数并提供单个参数重载有什么问题？

```
int foo(int x)
{
    Bar bar = //whatever initialization
    return foo(x,bar.baz());
}

int foo(int x,int y)
{
  //whatever the implementation is right now
} 
```

我认为这往往比尝试使用一些动态默认值更干净、更灵活。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-14T23:48:57.893

在标准的第 8.3.6 节（默认参数）第 5 段中，他们给出了一个仅使用这种方法的示例。具体来说，它指出默认参数是*表达式*，因此可以应用函数调用，尽管有名称查找和类型兼容性等限制。

在我的工作场所，我们使用过这样的签名：

```
void An_object::An_object(
  const Foo &a,
  const Bar &b,
  const Strategem &s = Default_strategem()
); 
```

允许客户端覆盖类构造函数中的行为。它对于影响翻译性能的条件行为非常有用......

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-14T21:32:07.280

切线，但在我看来，它会在未来引入依赖问题。我会采用 stbuton.myopenid.com 的方法。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-14T20:48:50.910

只要函数/对象的声明在范围内，在此上下文中调用全局函数或引用全局对象应该是完全有效的。它可能是可取的，也可能不是可取的（就良好的设计而言），但它应该有效。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-14T20:53:46.000

尝试使 bar() 成为静态成员函数。这将允许程序的任何部分在范围内具有这样的静态类来访问它。例如：

类Foo {公共：

静态 int bar(); };

然后你会声明：

int foo(int x, int y = Foo::bar());

如果您需要不同的对象，则改为传入对象的实例。

# localization - 用其他（口语）语言编码

> ID：202723
> 
> 赞同：107
> 
> 时间：2008-10-14T20:45:17.093
> 
> 标签：localization, translation, spoken-language

这是我一直想知道的事情，我在网上的任何地方都找不到任何提及。当一家来自日本的商店写代码时，我能用英文阅读吗？或者像 C、PHP 之类的语言有他们编写的日语翻译吗？

我想我要问的是世界上每个编码员是否都知道足够的英语来使用与我完全相同的保留字？

这段代码：

```
If (i < size){
    switch
        case 1:
            print "hi there"
        default:
            print "no, thank you"
} else {
    print "yes, thank you"
} 
```

显示与我现在用英语看到的完全相同，或者其他非英语国家的人会看到“if”、“switch”、“case”、“default”、“print”和“其他”用他们的母语？

编辑 - 是的，这很严重。我不知道一种语言的不同本地化是否有不同的关键字。或者是否有不同的本地化。

* * *

## 回答 #1

> 赞同：161
> 
> 时间：2008-10-14T21:08:31.573

如果我理解得很好，这个问题实际上是：“世界上每个程序员都知道足够的英语来使用与我完全相同的保留字吗？”

嗯..这里的主题不是英语，而是编程语言的保留字。我的意思是，当我大约 10 年前开始工作时，我对英语一无所知，即使我不知道它们的意思（英语），我仍然能够通过学习编程语言来编写简单的东西。事实上，这有助于我学习英语。

例如。我知道要做一个“迭代”（当然是迭代）我必须写：

```
 for( i = 0 ; i < 100 ; i++ ) {} 
```

对我来说，“for”，“;” 和“++”，其中简单的外来词或符号。后来我知道“for”的意思是“para”，“while”的意思是“mientras”等等，但同时我不需要懂英语，但就我而言，我需要的是知道“C”。

当然，当我需要学习更多东西时，我必须学习英语，因为文档是用那种语言编写的。

所以答案是：不，我看不到我的母语中的 if、while、for 等。我看到它们是英文的，但它们对我来说并不意味着它们对编程语言意味着任何其他东西。

就像 bash 中的 switch 语句：case .. esac。什么是“esac”...对我来说是 bash 中 switch 语句的结尾。

我想这就是我们所说的“抽象”

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2008-10-14T21:07:18.423

在 Java 语言中，由于 JavaBeans 约定，某些方法必须（至少部分地）使用英语命名。

此约定要求通过一对 getX() 和 setX() 方法建立属性 X。在加拿大法语区，一些开发人员不得不用法语编写代码，这导致了以下讽刺：

```
interface Foo {

  Color getCouleur();

  void setCouleur(Color couleur);
} 
```

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2008-11-15T21:19:45.277

我很难找到参考资料，但我想起了三个故事。

Lisp 黑客通过将诸如“cdr”和“car”之类的无意义函数与您的非母语编程进行比较来保护它们：http: [//people.csail.mit.edu/gregs/ll1-discuss-archive-html/msg01171。 html](http://people.csail.mit.edu/gregs/ll1-discuss-archive-html/msg01171.html)

当 Yukihiro Matsumoto（“Matz”）开始开发 Ruby 时，他使用英文关键字*，尽管他正在用日文编写所有文档！*. 几年来没有 Ruby 的英文文档，而且很少有美国人使用该语言。但现在它是一门世界级的语言，它诞生于日本的事实仅具有历史意义。如果该语言一直在平假名中使用关键字，那么它就很难获得普及。

我曾经读过一篇文章——也许别人能找到它，谷歌今天没有帮助——这表明翻译关键词是被误导的，因为这些词实际上不是英语——它们是行话。不仅（使用上面的例子）*para*和*pour不完全具有英语中**for*的确切含义，对于非程序员来说，“for loop”这个短语是胡言乱语。即使是美国人也必须学习新的含义。因此，将单词的表面含义翻译成另一种语言更像是制作跨语言的双关语，而不是真正有帮助。

* * *

## 回答 #4

> 赞同：25
> 
> 时间：2008-11-14T15:39:54.623

我以前真的没有过多考虑过用日语编程，但我们开始吧，使用问题的代码示例。

仅使用日语中的语言语句和英语中的变量：

```
// In Japanese, it makes more sense to put the keywords/modifiers as
// postfix expressions rather than prefix expressions.
(i < size)か {
     (l[i])は {
     1だ:
         「もしもし。」を書く;
     省略時値:
         「いいえ、いいですよ。」を書く;
     }
} ない {
     「はい、ありがとうございます。」を書く;
} 
```

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2008-10-15T02:24:23.073

正如许多人已经指出的那样，在大多数编程语言中，您只需要学习一些关键字，因此如果它们是英语（或其他语言，就此而言）并不重要。它只是您与某些构造相关联的符号。例如，在 VB 中你有“THEN”，在许多 C 风格的语言中它是“{”，它在可读性上并没有太大的区别（好吧，至少我是这么认为的，作为一个非英语母语者）。

但是事情有时会变得棘手，而（自然）语言的选择在命名标识符方面很重要。如果变量、函数、类等的名称由于语言障碍而对您来说没有有意义的名称，那么即使是最简单的代码也可能相当具有挑战性。

我记得曾经有人给了我一段从某个博客中截取的 Actionscript 的简短片段。这些名字是德语的，因为我不会说那种语言，所以也可以将这些东西称为 var_123、var_562 或 func_333（也许我更容易记住这些名字，或者至少有一个无需复制和粘贴即可正确拼写）。由于这是一个简短的、独立的片段，我使用在线翻译器以我的母语（西班牙语）为这些变量和函数赋予有意义的名称，之后一切都变得清晰了。关键是代码实际上很简单，但是当我克服语言障碍时，我只能在没有太多（不必要的）额外努力的情况下理解它。

从那以后，我改用英语来命名标识符。不管你喜不喜欢，它都是编程、工程和一般技术方面的“通行证”。大多数 API 都是用英语编写的，大多数文档也是如此（您可以找到的最好的资源也可能是英语）。顺便说一句，它使您的代码与您可能与之交互的代码更加一致，而且我认为它比其他语言（如西班牙语）更紧凑和简洁（否则这将是我的自然选择）。

当然，如果你至少看不懂一些英语，问题还是一样的，所以这不是一个完美的解决方案。但是，考虑到来自许多不同国家的许多开发人员，他们交流的通用语言（通过代码，当然还有其他方式）很可能是英语。所以，选择英语也许是最好的选择，即使它不是解决这个问题的完美方法。

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2008-10-14T20:49:25.807

编程语言定义了关键字和标准类名，最好的做法是给用户定义的类型、变量和函数也提供英文名称（作为非母语人士，我可以说 ;-)。

所以是的，如果一切顺利，您将能够阅读代码。

然而，像 Java 和 Perl 这样的语言允许标识符的完整 Unicode 集，所以如果有人用汉字写他的类名，你可能会遇到问题。

更新：对于 Perl，有一个[笑话模块](http://search.cpan.org/perldoc?Lingua::Romana::Perligata)允许您用拉丁文编写 Perl。但这真的只是一个笑话。没有人认真地使用这样的东西。

第二次更新：本地化编程语言的想法并不是那么荒谬。Excel 的宏语言是本地化的，但幸运的是它以一种规范语言（英语）存储在文件中，因此本地化只是普通事物之上的一层。这样的事情只对小的“程序”有意义，对于“真正的”程序，它变得难以维护。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2008-11-12T13:40:34.153

实际上有*一些*非[英语的编程语言](http://en.wikipedia.org/wiki/Non-English-based_programming_languages)（维基百科）

我是挪威人，但除了输出之外的所有代码我一直使用英语（忽略学校的一些愚蠢代码）。实际上，我通常用英语写所有东西，然后使用 gettext （或其他东西）将其*翻译*成我的母语。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2008-11-27T14:51:54.073

我是英国人，我们经常遇到的一个问题是美式/英式拼写冲突。这通常发生在与编程相关的术语中，例如 Initialise() 或 Initialize()、Analyse() 或 Analyze() 等。这可能（已经）导致尝试覆盖方法时出现问题，并且有时很难发现。

由于框架（在我们的例子中是 C#）是由美国人设计的，我们发现最好保持一致并使用美国拼写。我们甚至采用颜色。

我们的开发团队中有不同国籍的人，大多数非英国人自然倾向于使用美式拼写。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2008-10-15T02:44:37.027

AppleScript 曾经有法语和日语方言版本。我不知道它为什么被撤回。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2008-11-13T21:10:27.887

将其提升到一个新的水平，能够替换符号怎么样？

在看到像[Brainf**k](http://en.wikipedia.org/wiki/Brainfuck)和[Whitespace](http://compsoc.dur.ac.uk/whitespace/)这样的语言之后，我想到了制作这样一种语言：它与 C 相同，除了你使用右大括号打开、打开大括号关闭、交换 + 和 -、* 和 / 的含义, ; 和:、> 和< 等。

这个概念只不过是一个花哨的改变的 C 编译器。但是，就像以不同的方式思考关键字一样，如果您以前从未想过这些事情，它会挑战您重新思考一些基本假设。前任：

```
int foo)int i, char c( }
    int six = 2 / 3:
    int two = six + 4:
    if )i > 0( }
        printf)"i is negative"(:
    {
{ 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2008-11-17T08:41:20.957

我在一个用 C# 开发软件系统的法国团队中。尽管编程语言的关键字表面上是英文的，但我想你会很难阅读代码，因为所有的函数名、变量、代码注释、数据库表和列、技术规范、协议等都在法语，包括那些可爱的重音字符 ç、é、è、ù 等。由于本地化错误，我什至不确定系统是否会在其他地方运行，例如依赖逗号作为默认的十进制分隔符。

否则，WinDev 是法国流行的编程平台，其编程语言 WLanguage 有法语或英语的关键字，请参见此处的示例：[链接文本](http://fr.wikipedia.org/wiki/WLangage#Bilingue)

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2009-08-16T13:31:15.650

我看到的唯一本地化*语言是带有宏的 Excel。*如果您尝试使用意大利语版本的 Office 对列求和，则必须编写`SOMMA(A1:A10)`而不是 SUM。真可惜。

顺便说一句，只是因为它很有趣，下面是你的代码在意大利语关键字下的样子：

```
se (i < size){
    commuta
        caso 1:
            stampa "hi there"
        normalmente:
            stampa "no, thank you"
} altrimenti {
    stampa "yes, thank you"
} 
```

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2008-10-14T20:48:56.340

我已经看到 VBA 被翻译成类似西班牙语的命令。这是有史以来最丑陋的事情之一。我会很惭愧在我的电脑上有这样的东西。

PD：我碰巧认为西班牙语比英语好得多。但是翻译是错误的

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2008-10-14T20:52:33.430

好吧，正如其他人指出的那样，关键字和系统调用可能会保留为英文。

但是，理解语言的关键字只是理解代码的一小部分。变量名、函数名和注释都存在使用作者母语的风险。

**编辑**：我刚刚闪回到我的青年时代，我在 TRS-80 内置 BASIC 的映射表中将关键字切换为法语。我可以更改所有的关键字，但我不能让它们中的任何一个变大。为有趣的节目而生。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2008-10-14T21:12:03.187

不要拿这个开玩笑。几年前，微软发布了 G#（German Sharp）——带有德语关键字和 API 的 C#。当然，这是一个愚人节玩笑，但整个网站看起来都非常真实和专业（并且在 microsoft.com 上）。可怕的。

在工作中，我们使用两个现场总线系统，它们都是在德语国家开发的，它们的标识符混合了可怕的德语和英语，包括一些可爱的假朋友。一团糟。

不，英文关键字和标识符都可以。虽然有些人可能会争论它应该是颜色还是颜色:)

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2008-10-14T21:31:04.757

在我从事的几个 VBA 项目中（是的，在我职业生涯的早期），我们必须检测安装在用户机器上的 office 版本，并相应地更改电子表格中使用的公式。

当我用葡萄牙语编程时，“SUM”必须翻译成“SOMA”等等。我只是无法想象以多种语言实现这一点的必要工作。有没有其他人遇到过这个问题？

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2009-08-16T13:34:12.827

有些语言已经翻译了关键字。例如，Excel 公式。如果您在电子表格中编写一些计算，这将使用您的语言。

幸运的是，这不是一种普遍的做法，即使像我这样不会说英语的人也感谢上帝有一个标准的关键字语言：

*   分享你的工作更容易。
*   它可以防止文档成为它已经成为的更大的噩梦。
*   英语单词和句子通常很短且在句法上很实用。在文学方面，拉丁语要漂亮得多，但对于技术性的东西，英语却很出色。

在哪里停下来？你能想象古希腊语中的 C 吗？

关键字必须保持在一种语言中，而且，它以英语开头，让它保持这种状态。这可能是最糟糕的（亚洲语言？）。所以我们必须用英文写方法和注释。好的，我们需要做更多的工作，但至少国际代码库保持一致。

然而，在一种情况下，使用本地语言方法名称和注释可能是一种很好的做法：在第三世界国家。几个月后我要去塞内加尔管理一个 Django 项目。塞内加尔的字母表化率很高，因此他们花精力提高编程知识已经很棒了。法语是这里的母语，所以强迫他们同时学习计算和新语言是低效的。

顺便说一句，那将是您使用法语关键字的代码：

```
Si (i < taille) {
    cas par cas :
        cas 1:
            afficher "salut"
        défaut:
            afficher "non merci"
} sinon {
    afficher "oui, merci"
} 
```

并不是说翻译关键字与翻译字符串无关。当然，我们已经用我们的语言翻译了“嗨，那里”。欧洲编码员甚至比美国编码员更倾向于使用 I18N，因此他们的服务可以覆盖更广泛的受众。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2008-10-15T03:09:29.580

一般来说，大多数程序员都适应英语形式。我在 7 岁时学会了编程，并且只会说希伯来语（从右到左）并且不会说英语，这使它成为一次非常有趣的经历。

您通常会遇到的问题是文档、变量和函数名称。我已经看到我在使用英文字母的其他语言中的变量份额。

我熟悉的唯一被翻译的语言是古老的 Logo（直到今天仍然令人惊叹）。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2008-11-13T06:02:37.040

当我还是个孩子的时候，我们去了法国，在我们去过的博物馆里，我记得我找到了一个展示如何编写计算机程序的展示。该语言是某种 BASIC 变体，我清楚地记得它使用 POUR 而不是 FOR，等等。我当时 7 岁，刚学 BASIC，对我来说，法国人会有这样的自己的方言对我来说似乎是完全自然的！

我想我看到的可能是[LSE ？](http://en.wikipedia.org/wiki/LSE_(programming_language))

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2008-11-14T14:59:28.683

Filemaker 的脚本语言已本地化。脚本（和数据！）以可怕的“某种规范”形式存储。

所以如果你用美版写了一个脚本，然后用法文打开它，所有的关键字和内置函数名都是法文的。但是为什么不运行？！啊哈！法语版本使用“，”作为小数点，因此为避免歧义使用“;” 分隔函数参数——美国版本使用“。” 和“，”分别。这个转换你必须自己做。

因此，您通过极其糟糕的脚本编辑界面（您不能将脚本编写为文本文件）来修复所有这些问题。它运行！伟大的！结果都是错的！不好了！啊哈！您在美国版本中输入的 Jan-7-2004 日期被解释为 July-1-2004 - 显然日期不仅显示，而且*存储*在与区域设置相关的顺序中。 *我在开玩笑吗*？不。

[注意：Filemaker 8 和 9 可能很正常——我只使用过 3 - 7。]

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2008-11-20T03:47:49.173

关于 Perl，您的问题是一个有趣的问题，因为它的语法旨在遵循（英语）自然语言。我想知道这是否会让非英语人士变得更加困难......

当然，Perl 和 Perlers 拒绝按常规规则行事。疯狂的科学家 Damian Conway 编写了[Lingua::Romana::Perligata](http://search.cpan.org/perldoc?Lingua::Romana::Perligata)模块，它使用源过滤器的黑魔法让您可以用拉丁文编写 Perl！

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2008-11-27T01:57:36.633

在澳大利亚，我们仍然需要拼写**color** like **color**。但是，当其他（澳大利亚）开发人员在澳大利亚项目上工作时，我确实觉得这很烦人，他们决定内部变量名称需要以美国方式拼写。

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2008-10-14T20:51:07.380

恕我直言，对于 i18n 语言*语法*将毫无意义。它只会扼杀任何形式的可移植性。

唯一的例外是教育语言，例如 LOGO。它们是为便于学习而设计的，因此可移植性不是问题。

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2008-10-14T21:29:47.940

我读了很多代码，但问题总是出在变量/方法名称和注释上，如果他们用自己的语言注释代码，使用像日语或西里尔语这样的语言特殊字符，我们就有麻烦了！但我认为它们将保持英文原样的关键字。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2009-08-16T13:43:52.987

用意大利语

```
se (i < dimensione){
    scegli
        caso 1:
            stampa "ciao"
        mancante:
            stampa "no, grazie"
} altrimenti {
    stampa "sì, grazie"
} 
```

为了确认之前一些海报的担忧，我看到了一个带有宏的 Fortran 代码，包括将所有关键字从英语翻译成法语。请允许我不要继续说下去。

我还必须使用同时包含意大利语、德语、英语和法语标识符的代码，不仅因为它是在许多不同的地方开发的，还因为主要开发人员认为这很有趣并帮助他不重复标识符名称（当然，例行程序有 2000 行长....）

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2008-11-13T20:48:24.220

我认为 WordBasic 已本地化。在使用 VBA 之前，WordBasic 用于在 Word 中编写宏。

如果我没记错的话，只有英文版的 WordBasic 才能在所有本地化版本上执行。如果您要编写荷兰语版本，则只能在荷兰语单词上执行它。

# windows - 如何将自定义属性添加到 Windows 中的 AD 组？

> ID：202736
> 
> 赞同：3
> 
> 时间：2008-10-14T20:47:33.330
> 
> 标签：windows, active-directory, ldap

我想知道如何编写这个脚本。另外，是否有一个开箱即用的 GUI 工具可以让我这样做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-01T21:04:14.663

您是指扩展 AD 架构时交换添加的 CustomField 属性吗？如果是这样，那么您可以使用[ADSIEdit](http://technet.microsoft.com/en-us/library/cc773354.aspx)。

如果您想创建自己的字段，那么我认为您的选择是扩展架构或可能使用 ADAM。

我没有将 ADAM 用于 Groups，但我认为它仍然是可能的。

[在Microsoft 的 Script Center](http://www.microsoft.com/technet/scriptcenter/scripts/default.mspx?mfr=true)中有一些关于访问组的基本脚本。

# java - 有没有办法在tomcat中设置超时？

> ID：202740
> 
> 赞同：5
> 
> 时间：2008-10-14T20:48:46.760
> 
> 标签：java, jsp, tomcat, timeout

我可以在每页或服务器级别为 tomcat 中的 JSP 页面设置超时吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-23T16:22:20.647

在 Tomcat *server.xml*文件中，Connector 元素还有一个`connectionTimeout`以毫秒为单位的属性。

例子：

```
<Connector
    URIEncoding="UTF-8"
    acceptCount="100"
    connectionTimeout="20000"
    disableUploadTimeout="true"
    enableLookups="false"
    maxHttpHeaderSize="8192"
    maxSpareThreads="75"
    maxThreads="150"
    minSpareThreads="25"
    port="7777"
    redirectPort="8443" /> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-14T20:58:33.277

对于服务器级别，你可以试试这个。
你必须改变`catalina.bat`/`catalina.sh`文件

```
jvm OPTIONS : -Dsun.net.client.defaultConnectTimeout=60000 -Dsun.net.client.defaultReadTimeout=60000 
```

# nlp - 有人类可读的编程语言吗？

> ID：202750
> 
> 赞同：54
> 
> 时间：2008-10-14T20:51:13.777
> 
> 标签：nlp, grammar

我的意思是，是否有一种具有人类风格编码的编码语言？例如：

```
Create an object called MyVar and initialize it to 10;
Take MyVar and call MyMethod() with parameters. . . 
```

我知道它不是那么有用，但是创建这样的语法会很有趣。

* * *

## 回答 #1

> 赞同：123
> 
> 时间：2008-10-14T20:59:58.080

[LOLCODE](http://lolcode.com/home)怎么样？

```
HAI
CAN HAS STDIO?
VISIBLE "HAI WORLD!"
KTHXBYE 
```

简单本身！

* * *

## 回答 #2

> 赞同：104
> 
> 时间：2008-10-14T20:54:15.580

[COBOL](http://en.wikipedia.org/wiki/Cobol)很像这样。

```
SET MYVAR TO 10.
EXECUTE MYMETHOD with 10, MYVAR. 
```

来自维基百科的另一个示例：

```
ADD YEARS TO AGE.
MULTIPLY PRICE BY QUANTITY GIVING COST.
SUBTRACT DISCOUNT FROM COST GIVING FINAL-COST. 
```

奇怪的是，尽管它的设计可以用英语阅读，但大多数程序员用奇怪的命名约定完全破坏了这一点：

```
SET VAR_00_MYVAR_PIC99 TO 10.
EXECUTE PROC_10_MYMETHOD with 10, VAR_00_MYVAR_PIC99. 
```

* * *

## 回答 #3

> 赞同：97
> 
> 时间：2008-10-14T21:38:31.513

[**通知 7**](http://inform7.com/)

Inform 7 可能是我认为最适合以人类语言方式设计的语言。它是专门用于编写冒险游戏的应用程序。

它基于基于规则的语义，您可以在其中编写大量规则来描述对象及其位置之间的关系。例如，下面的部分是一个 Inform 7 程序：

```
"Hello Deductible" by "I.F. Author"

The story headline is "An Interactive Example".

The Living Room is a room. "A comfortably furnished living room."
The Kitchen is north of the Living Room.
The Front Door is south of the Living Room.
The Front Door is a door. The Front Door is closed and locked.

The insurance salesman is a man in the Living Room. The description is "An insurance salesman in a tacky polyester suit. He seems eager to speak to you." Understand "man" as the insurance salesman.

A briefcase is carried by the insurance salesman. The description is "A slightly worn, black briefcase."  Understand "case" as the briefcase.

The insurance paperwork is in the briefcase. The description is "Page after page of small legalese." Understand "papers" or "documents" or "forms" as the paperwork.

Instead of listening to the insurance salesman: 
    say "The salesman bores you with a discussion of life  insurance policies.  From his briefcase he pulls some paperwork which he hands to you.";
    move the insurance paperwork to the player. 
```

[引用自维基百科的示例](https://en.wikipedia.org/wiki/Inform#Example_game_2)

* * *

## 回答 #4

> 赞同：42
> 
> 时间：2008-10-14T20:53:44.270

AppleScript 与此非常接近，尽管这显然取决于平台。

这是打开 iTunes 并播放播放列表的脚本

```
tell application "iTunes"
    activate
    play playlist "Party Shuffle"
end tell 
```

来源：[AppleScript 示例](http://sial.org/code/applescript/)

* * *

## 回答 #5

> 赞同：32
> 
> 时间：2008-10-14T21:25:44.953

这是大约 1980 年代初的“下一件大事”，我在最初几年的大部分时间里作为一名编码员在“自然”中工作，这被认为是新的 4GL（第四代语言）中最好的，它旨在使数据访问（在这种情况下是对 ADABAS 数据库）具有人类可读性。

当然，它绝对没有做任何类型的事情。我们最终得到的只是冗长的结构不良的代码。这两种产品仍然存在，但您从未听说过它们，这在某种程度上证明了它的死胡同。

实际上，在那个时期，似乎普遍希望超越“编程”，进入某种 2001 年启发的人工智能天堂。甲骨文非常热衷于代码生成，我记得有一种兴趣被称为“最后一个”的产品被推销给经理，该产品可以自动生成您想要的任何程序，并使您所有的编程人员都变得多余。似乎没有达到预期;-)

值得记住的是，SQL 最初是在某些方面作为一种允许管理层直接查询其数据的方式销售的。我什至被派去学习基本 SQL 的课程（在一个大型的全国性铁路运输组织 - 钢铁品种），其中包括初级管理类型，因为他们计划将基本查询工具放在他们手中。那是怎样的一场灾难。

也许 50 年后可能会有所不同，但在游戏编码的当前阶段，需要一定的思路和实现清晰性，最好通过为这些目的设计的专用语法进行调解，而不是任何近似于不清楚和模棱两可的自然语言. 最接近的近似值可能是物理学，其中主题的本质在于所使用的数学（想想物理学的编程语言）而不是冗长的词。

**添加**

我忘记了，除了 COBOL 之外，还有 PL/1，它曾被认为允许 NASA 将一个人送上月球，它和 COBOL 一样冗长，并且更加努力地成为“经理可读的”。这就是为什么现在也没有人真正听说过它的原因:-)

* * *

## 回答 #6

> 赞同：32
> 
> 时间：2009-01-02T19:09:14.583

> 推广“自然语言”编程的项目本质上注定要失败。

—— Edsger W.Dijkstra，[我们如何说出可能会造成伤害的真相？](http://www.cs.virginia.edu/~evans/cs655/readings/ewd498.html)

* * *

## 回答 #7

> 赞同：18
> 
> 时间：2008-10-14T21:12:21.830

所有语言都是“人类可读的”。:) 其他人将如何创建它？话虽如此，支持 DSL 的语言可以非常直观，例如[Boo](http://boo.codehaus.org/)。

* * *

## 回答 #8

> 赞同：18
> 
> 时间：2008-10-15T00:29:06.723

[厨师](http://www.dangermouse.net/esoteric/chef.html)！任何人都可以阅读食谱吗？看[你好世界](http://www.dangermouse.net/esoteric/chef_hello.html)！

```
Ingredients.
72 g haricot beans
101 eggs
108 g lard
111 cups oil
32 zucchinis
119 ml water
114 g red salmon
100 g dijon mustard
33 potatoes

Method.
Put potatoes into the mixing bowl. Put dijon mustard into the mixing bowl. 
Put lard into the mixing bowl. Put red salmon into the mixing bowl. Put oil into the mixing bowl. 
Put water into the mixing bowl. Put zucchinis into the mixing bowl. Put oil into the mixing bowl. 
Put lard into the mixing bowl. Put lard into the mixing bowl. Put eggs into the mixing bowl. 
Put haricot beans into the mixing bowl. Liquefy contents of the mixing bowl. 
Pour contents of the mixing bowl into the baking dish. 
```

对不起，如果这不是一个严肃的答案，但这太棒了。:-)

* * *

## 回答 #9

> 赞同：15
> 
> 时间：2008-10-14T21:04:01.363

让编程语言读起来像（冗长的）普通语言，就像要求人们一直用法律术语交谈。所有多余的措辞都会妨碍您。

理想的编程语言应该具有尽可能透明的语法，并让程序背后的概念脱颖而出。显然，在快速学习曲线和使用最少但晦涩的语法（想想 Perl，甚至 K）之间需要权衡取舍。

* * *

## 回答 #10

> 赞同：13
> 
> 时间：2008-10-14T21:07:30.497

通过创建一组规则，可以像这样在[Prolog中进行逻辑编程。](http://en.wikipedia.org/wiki/Prolog)您可以为特定领域构建一个语法（或下载一个），创建一个知识库，然后对其进行查询。定义语法后，您可以执行以下操作：

```
bob is a parent of tim.
mary is a parent of bob.

?- X is a grandparent of tim.
X = mary

?- jim is a parent of bob.
false 
```

* * *

## 回答 #11

> 赞同：13
> 
> 时间：2008-10-15T13:49:44.717

我看到[莎士比亚的编程语言](http://en.wikipedia.org/wiki/Shakespeare_programming_language)还没有被提及。

这些程序被编码为看起来像莎士比亚戏剧，戏剧中的个体角色是可以容纳数字的变量，并且剧本中的各种短语操纵角色和他们持有的数字。例如，“说出你的想法”命令一个角色输出他的价值。

* * *

## 回答 #12

> 赞同：9
> 
> 时间：2008-10-14T20:54:22.210

[苹果脚本](http://developer.apple.com/applescript/)：

```
tell application "Finder"
 set the percent_free to ¬
 (((the free space of the startup disk) / (the capacity of the startup disk)) * 100) div 1
end tell
if the percent_free is less than 10 then
 tell application (path to frontmost application as text)
 display dialog "The startup disk has only " & the percent_free & ¬
 " percent of its capacity available." & return & return & ¬
 "Should this script continue?" with icon 1
 end tell
end if 
```

* * *

## 回答 #13

> 赞同：7
> 
> 时间：2008-10-14T21:29:14.230

我可以阅读 C。这意味着它是人类可读的（因为我是人类）。这对普通人来说太简洁了。编程语言的一般概念是最大化有关计算机应如何在给定行中运行的信息。

这就是 Ruby 如此受欢迎的原因。它以最少的文本最大化了功能。英语（或任何其他自然语言）是一种非常不精确的、低信息/字符语言。

总而言之，它是：（i）之前完成和（ii）一个已知的较弱的想法。

* * *

## 回答 #14

> 赞同：7
> 
> 时间：2008-10-14T22:22:52.343

这实际上是一个热门话题。

对于初学者 - 什么是人类可读的？

中国读者无法阅读俄语，反之亦然。如果您将您的领域缩小到例如中国药剂师编写一个处方，您可以围绕它设计一种语言。那将是*人类可读*的。

例如语言将属于[领域特定语言](http://en.wikipedia.org/wiki/Domain_Specific_Language)的范畴。

* * *

## 回答 #15

> 赞同：7
> 
> 时间：2009-03-20T10:47:34.943

SQL

```
SELECT name, address FROM customers WHERE region = 'Europe' 
```

* * *

## 回答 #16

> 赞同：6
> 
> 时间：2008-10-14T20:57:08.087

是的。它被称为[COBOL](http://www.csis.ul.ie/COBOL/examples/Accept/Multiplier.htm)，人们普遍讨厌它。

* * *

## 回答 #17

> 赞同：6
> 
> 时间：2008-10-14T21:43:48.757

[Inform 7](http://inform7.com/)是我见过的最成功的此类系统。与此处其他答案中列出的较粗略的系统相比，它有两个优点：它适用于特别适合自然语言（交互式小说）的领域，并且它基于更多的计算语言学知识对输入代码进行了更出色的分析，而不仅仅是传统的恰好使用英语单词而不是大括号等的编程语言语法。

* * *

## 回答 #18

> 赞同：6
> 
> 时间：2008-10-15T00:04:23.900

[HyperTalk](http://en.wikipedia.org/wiki/HyperTalk)及其后代[AppleScript](http://en.wikipedia.org/wiki/AppleScript)的设计类似于英语。

* * *

## 回答 #19

> 赞同：5
> 
> 时间：2008-10-14T20:53:16.190

Perl，有些人声称。

```
print "hello!" and open my $File, '<', $path or die "Couldn't open the file after saying hello!"; 
```

* * *

## 回答 #20

> 赞同：5
> 
> 时间：2008-10-14T20:54:57.137

用谷歌搜索“自然语言编程”，你会发现很多信息（包括为什么这是一个坏主意）。

* * *

## 回答 #21

> 赞同：5
> 
> 时间：2008-10-14T21:38:07.317

表达的清晰很重要。

但思路清晰远非常重要。

* * *

## 回答 #22

> 赞同：4
> 
> 时间：2008-10-14T20:54:54.203

VB是我能想到的最接近的一个：

If MyLife.Sucks Then MyLife.End Else MyLife.Continue

* * *

## 回答 #23

> 赞同：4
> 
> 时间：2008-10-15T15:02:13.870

当然，二郎。

```
-module(listsort).
-export([by_length/1]).

 by_length(Lists) ->
    F = fun(A,B) when is_list(A), is_list(B) ->
            length(A) < length(B)
        end,
    qsort(Lists, F).

 qsort([], _)-> [];
 qsort([Pivot|Rest], Smaller) ->
     qsort([ X || X <- Rest, Smaller(X,Pivot)], Smaller)
     ++ [Pivot] ++
     qsort([ Y ||Y <- Rest, not(Smaller(Y, Pivot))], Smaller). 
```

我是人类，它是一种编程语言，我可以阅读它。我不知道它是什么意思，但我认为那里有很多英文单词。

（舌头紧紧地贴在脸颊上。）

* * *

## 回答 #24

> 赞同：4
> 
> 时间：2008-11-13T19:03:57.113

DSL 看起来非常自然。请参阅使用[MGrammar](http://msdn.microsoft.com/en-us/library/dd129869.aspx)创建的[此示例](http://www.codinginstinct.com/2008/11/creating-watin-dsl-using-mgrammar.html)：

```
test "Searching google for watin"
    goto "http://www.google.se"
    type "watin" into "q"
    click "btnG"
    assert that text "WatiN Home" exists
    assert that element "res" exists
end 
```

* * *

## 回答 #25

> 赞同：3
> 
> 时间：2008-10-14T20:59:50.733

[COBOL](http://en.wikipedia.org/wiki/COBOL)旨在供管理人员阅读，并且具有“干扰词”以使其更具可读性。

有趣的是，它读起来有点像冗长的 DSL。

* * *

## 回答 #26

> 赞同：3
> 
> 时间：2008-11-13T19:36:19.373

比大多数人更易于阅读是 Ada 的早期卖点之一。这些天我觉得这是一个愚蠢的论点，因为任何语言的任何足够复杂的任务*都*需要有能力的从业者才能理解。但是，它确实击败了 C 语法语言。它的主要编码风格也可以增强这种效果。例如，比较 if 语句中的循环： Ada：

```
if Time_To_Loop then
   for i in Some_Array loop
      Some_Array(i) := i;
   end loop;
end if; 
```

C：

```
if (timeToLoop != 0) {
   for (int i=0;i<SOME_ARRAY_LENGTH;i++) {
      someArray[i] = i;
   }
} 
```

如果我使用像微软这样的匈牙利符号，C 代码看起来会更糟，但我正在努力变得更好。:-)

* * *

## 回答 #27

> 赞同：3
> 
> 时间：2010-09-29T14:41:16.977

有趣的问题。您的问题可以被解读为“*是否有任何人类易于阅读的编程语言*？”，或者 ELSE 为“*是否有可用于编程的人类语言*？”。这里所有的答案都集中在前者，所以让我尝试回答后者。

你听说过梵文吗？它是一种古老的印度语言，现代印度语言如印地语是基于它的。

[维基/梵文](http://en.wikipedia.org/wiki/Sanskrit)

多年来，我一直听说它足够精确和完整，可以作为计算机上的高级语言使用。当然，您需要一个编译器来将梵文指令转换为机器语言。我知道剧本，是的，它很精确（完全是拼音，所以你永远不必问“你是怎么拼写的”），但我不太了解语法。

这完全是轶事，所以我不保证它的准确性。只是想分享我对此的了解。:-)

* * *

## 回答 #28

> 赞同：2
> 
> 时间：2008-10-15T02:43:23.080

我同意这里的普遍共识。“人类可读”**的通用**编程语言大多是一个坏主意，但人类可读的领域特定语言非常值得。

REBOL 有一个很棒的系统来创建 DSL。

* * *

## 回答 #29

> 赞同：2
> 
> 时间：2010-07-20T02:46:15.690

研究生

它只有一个语句：**“你 - 给我写一个程序来做 x”**
它对 X 的所有值都有效，并且具有不需要定义 x 并且可以在编写程序后更改的优点。

有一种商业方言叫做实习生：开发成本较低，但不能保证有效

* * *

## 回答 #30

> 赞同：1
> 
> 时间：2008-10-14T20:55:31.223

[Cobol](http://en.wikipedia.org/wiki/Cobol)有点像这样。

* * *

## 回答 #31

> 赞同：1
> 
> 时间：2008-10-14T21:02:24.797

恕我直言，人类可读性是相当主观的。但是，如果您想了解更多信息，我建议您探索以下主题：

*   Python - 它使用更喜欢空格而不是“特殊字符”（例如 { & } 用于语法）。
*   Smalltalk - 允许通过方法名称传播参数。
*   红宝石
*   流利的 API / 领域特定语言

* * *

## 回答 #32

> 赞同：1
> 
> 时间：2008-10-14T21:55:23.787

虽然它本身不是一种编程语言，但[简约的 XML 速记语言 (PXSL)](http://community.moertel.com/pxsl/)使 XSL 比它已经可以说的更易于人类阅读（而且更简洁！）：

```
 <doc keywords="x y z">          doc -keywords=<<x y z>>
  <title/>                        title
  <body id="db13">                body -id=db13
    This is text.                   <<This is text.>>
  </body>
</doc> 
```

* * *

## 回答 #33

> 赞同：1
> 
> 时间：2008-10-15T13:59:55.760

我认为这两种结构有非常不同的目的。自然语言有一个非常松散的结构，需要解释，并假定存在一个高级推理引擎来理解它——并且预计它会在很大一部分时间被错误地解释！编程语言应该是精确的、明确的规范，几乎没有任何解释的余地​​。

鉴于您认为使用自然语言作为编程结构应该是驯服其可变性并阐明其含义的简单问题。但是一旦你完成了这些，你就剩下了编程语言的语义，不管它是如何在语法上包装和包装的。

* * *

## 回答 #34

> 赞同：1
> 
> 时间：2008-11-13T19:21:38.700

那必须是空格。唯一无需阅读的编程语言：[http://en.wikipedia.org/wiki/Whitespace_(programming_language)](http://en.wikipedia.org/wiki/Whitespace_(programming_language))

* * *

## 回答 #35

> 赞同：1
> 
> 时间：2009-03-20T10:24:20.883

有趣的。想象一个字母表问“有人类可读的报纸吗？”。

在你可以阅读之前，你必须先学会阅读。

* * *

## 回答 #36

> 赞同：1
> 
> 时间：2009-03-31T13:37:03.247

还没有看到[ABC](http://homepages.cwi.nl/~steven/abc/ "ABC 语言简介")提到过。在乌得勒支大学计算机科学专业的第一年就与它一起工作，并且一直认为它非常“人类可读”（无论这意味着什么）。

这是一个示例函数词，用于收集文档中所有词的集合：

```
 HOW TO RETURN words document:
      PUT {} IN collection
      FOR line IN document:
         FOR word IN split line:
            IF word not.in collection:
               INSERT word IN collection
      RETURN collection 
```

* * *

## 回答 #37

> 赞同：1
> 
> 时间：2010-08-02T07:34:51.440

你看过 Python 吗？

* * *

## 回答 #38

> 赞同：0
> 
> 时间：2008-10-14T20:55:24.080

Visual Basic（以及一般基于 BASIC 的语言）与您所获得的人类语言一样接近。我认为 Python 也非常接近。如果你足够关心，使用这些你可以让你的代码读成结构化的英语，但是不，没有自然的英语编译器，因为那里有太多的歧义。

* * *

## 回答 #39

> 赞同：0
> 
> 时间：2008-10-14T20:58:49.453

Basic 是朝这个方向发展的第一种方法，正如在另一个回复中所显示的那样，Perl 还允许使用非常接近人类语言的代码——如果你忽略所有这些标点符号。

[我刚刚阅读了一篇关于如何将拉丁语翻译成 Perl](http://www.csse.monash.edu.au/~damian/papers/HTML/Perligata.html)的非常有趣的文章（其中还有一个 Perl 模块）。

因此，如果人类语言具有足够的结构，并且您引入了足够的限制以避免歧义，那么您确实可以（大部分）使用人类语言进行编程。

但实际上没有人真正做到这一点，因为它非常冗长，而且很难使其既可读又准确。

* * *

## 回答 #40

> 赞同：0
> 
> 时间：2008-10-14T21:00:53.913

为什么要这么做？它对我们大脑中的 R2D2 机器不友好，它会向我们读取代码。

* * *

## 回答 #41

> 赞同：0
> 
> 时间：2009-03-29T14:03:53.370

在早期，微软实际上翻译了*WordBasic*（多年来被称为*Visual Basic for Applications*）以匹配 GUI 语言。像这样的构造

```
If <condition> Then
  <something>
End If 
```

在 Word 的荷兰语版本中，会像这样输入和显示

```
Als <condition> Dan
  <something>
Einde Als 
```

当然，理论上这让人们更容易理解录制的宏。但我怀疑那些人会从一开始就看一下代码......

* * *

## 回答 #42

> 赞同：0
> 
> 时间：2009-03-29T14:14:38.290

有很多很棒的**DSL**（领域特定语言）读起来很像人类语言。

一个很好的例子是星巴克。你可以写一个这样的DSL。这是使用 Ruby，但可以用许多不同的语言完成。Ruby 或 Python 的优势在于它们是动态语言，因此您可以使用 Duck Typing。

```
 venti = Starbucks.new(:kind => :coffee, :size => :venti)
half_foam_venti = add_half_foam(venti)
serve(half_foam_venti) 

```

但我不得不同意 Ruby / Python 可能是最接近开箱即用的。

肯特

* * *

## 回答 #43

> 赞同：0
> 
> 时间：2009-04-05T14:12:01.807

我说 LOLcode 是为了可读性：

海

我有一个 VAR ITZ “海德世界”，我已经结束了

可见 VAR

GIMMEH结束

KTHXBYE

或者

海

我已经结束了

可见“海德世界2.0”

GIMMEH结束

KTHXBYE

“w/o gimmeh，这东西只会停留一瞬间”去 lolcode.com 获取 moar 信息

* * *

## 回答 #44

> 赞同：0
> 
> 时间：2009-09-22T02:13:05.473

我曾经能够“阅读” OS/360 目标代码，这是一个在凌晨 2 点进行转储分析的人才，而 OP 经理在后台踱步。

所以我认为 OBJECT 代码算作人类可读的。

“自然语言”代码的主要问题是它们可能非常模棱两可。英语尤其依赖于文化、语境和“情绪”来正确解释句子。这就是为什么法律文件是用一种奇怪的生硬语言编写的，这是用英语达到任何精确度的唯一方法。

这是 COBOL 的一大陷阱。'IF A NOT = B OR C' 的编译器解释与普通读者的解释完全相反，即在 C "!(A == B) || A == C" 中，而您可能认为它应该是 !(A = = B || A == C)。

另一个大问题是标点符号。你的大脑“预处理”标点符号，所以你并没有真正“看到”它有意识的水平。时期 '。' 在早期的 COBOL 中非常重要，因为它们分隔了代码块，但是缺少或额外的句点非常难以发现。它有点像在 C 中发现 '=' 与 '==' 的区别，但要糟糕得多。

* * *

## 回答 #45

> 赞同：0
> 
> 时间：2009-09-22T02:17:52.123

我想你可能指的是函数式编程？我认为 F# 是 1。但作为开发人员，我似乎认为它对我来说更复杂

* * *

## 回答 #46

> 赞同：0
> 
> 时间：2009-09-22T02:23:30.570

您应该阅读 Martin Fowler 关于[Business-Readable DSLs](http://www.martinfowler.com/bliki/BusinessReadableDSL.html)的文章。

* * *

## 回答 #47

> 赞同：0
> 
> 时间：2009-10-08T10:46:51.657

Windev 是一种非常简单易读的语言。 [http://www.pcsoft.fr/windev/presentation.htm](http://www.pcsoft.fr/windev/presentation.htm)

* * *

## 回答 #48

> 赞同：0
> 
> 时间：2009-10-14T06:10:12.263

Rebol 接近尾声

* * *

## 回答 #49

> 赞同：0
> 
> 时间：2010-07-20T02:31:17.603

虽然我知道 COBOL（更接近我们...... SQL）可能很糟糕，但这些都是几十年前设计的。我还认为他们利用了关于“英语”编程语言的炒作，我认为他们在适当的语言分析方面做得还不够。我认为，如果优秀的程序员聚在一起分析语言并将其投入使用，我认为现在可以用英语编程（自然英语......语言）。这是一个大项目，但凭借我们拥有的计算能力，我很确定。换句话说，我不喜欢人们因为 COBOL 而放弃了类英语编程的想法。Cobol 是一种早期的编程语言，当时它的设计者决定以英语口语作为参考，因为他们不知道更好，他们不知道未来的复杂性，他们认为英语让它看起来很熟悉，也许它在营销材料上看起来也不错。我认为他们并没有真正努力让 COBOL 编译器阅读自然英语。如果现在认真努力从过去学习并完成一个适当的自然语言识别系统，那么我认为它可以工作 - 经过一段时间（很可能是几年）。假设这样，能够用简单的英语编程不是很好吗？当然，它必须是自学的（计算机必须即时学习）和交互的（计算机必须能够在用户感到困惑时要求用户在选择中进行选择）。如果现在认真努力从过去学习并完成一个适当的自然语言识别系统，那么我认为它可以工作 - 经过一段时间（很可能是几年）。假设这样，能够用简单的英语编程不是很好吗？当然，它必须是自学的（计算机必须即时学习）和交互的（计算机必须能够在用户感到困惑时要求用户在选择中进行选择）。如果现在认真努力从过去学习并完成一个适当的自然语言识别系统，那么我认为它可以工作 - 经过一段时间（很可能是几年）。假设这样，能够用简单的英语编程不是很好吗？当然，它必须是自学的（计算机必须即时学习）和交互的（计算机必须能够在用户感到困惑时要求用户在选择中进行选择）。

* * *

## 回答 #50

> 赞同：0
> 
> 时间：2011-11-08T14:43:09.163

请查看西北工业大学研究与孵化中心的 [网站 http://www.jumpulse.com](http://www.jumpulse.com)以查看人类语言编程语言*New*，它专门以人类语言与用户进行交流。新是基于一个完全自动化的软件。它应该可供 10 岁及以上的人使用。

* * *

## 回答 #51

> 赞同：-1
> 
> 时间：2009-09-22T02:48:38.787

[PERL](http://www.perl.org) ;-)

# .net - 设计问题：应用程序中的共享、同步、数据访问……最好的方法？

> ID：202751
> 
> 赞同：1
> 
> 时间：2008-10-14T20:51:28.347
> 
> 标签：.net, caching, synchronization, data-access

我有一个 Web 应用程序 (asp.net)，其中根据用户的工作量提交工作项并将其分配给用户。

用户的工作量是使用基于当前分配给用户的项目数（和一些其他因素）的算法计算的。每个新项目都分配给当前工作量最低的用户，从而增加了他们的工作量。当用户完成一个项目时，他们的工作量就会减少。项目将同时提交、分配和完成——因此工作量水平将不断变化。工作项存储在 SQL 数据库中。

我需要一种方法来确保每个分配决策都是使用整个用户群的最新工作负载图做出的。

我的想法是在缓存中提供工作负载信息的读/写同步存储。

这是最好的方法吗？或者我应该使用数据库来控制锁定？如何避免我的应用程序出现瓶颈？

建议非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-14T21:06:54.790

这取决于很多因素，当您提到缓存时，您是指 Asp.Net 提供的标准缓存吗？

始终拥有最新信息是否绝对重要，或者如果有两个请求被分配，那么在发出请求时是否可以将它们分配给两个最不忙的用户？

您确实可以使用缓存来存储此信息，但这通常假设您只会使用一台服务器，您是否可能会使用集群或负载平衡来处理高负载？

我能给你的最好建议是构建一个设计良好的应用程序，使用丰富的域模型来表示每个用户和队列的负载、松散耦合的数据访问以及大量的自动化单元和系统测试。通过这种方式，您可以构建一个工作应用程序，让系统快速启动并运行，而不必担心优化，并尽快开始性能测试\分析。

如果\当您遇到性能问题时，您可以通过分析\跟踪来识别瓶颈，并酌情添加优化，这可能是缓存或优化的查询\视图或事物的组合。

如果您尝试再次猜测瓶颈在哪里并消除它们，您可能会猜错并损坏系统的设计。一个设计良好的系统可以在您需要时进行优化。

我最初设想的方式是一个关系数据库（可能使用视图或存储过程来快速获取工作负载摘要信息），在它和域模型之间有一个数据映射层（它可以使用缓存、延迟加载和身份映射到如果需要，提供效率）。域模型将主要代表工作负载。

我希望这会有用户、工作项、工作队列和分配策略类。其中大部分可以保存在内存中或在请求之间本地存储，每个请求都可以由一个更新模型的事件来表示。

例如
，用户完成工作项
站点引发域事件以通知域模型更改
域模型接收事件并更新用户的工作负载

然后，工作分配将是要求域模型在需要时分配工作（它将通过找到分配最少的用户的策略来完成）。这可能发生在单独的工作请求和事件之外的后台，以便在用户下次请求工作时通知他们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-14T21:25:55.233

使用数据库来控制它。

如果出于某种原因，将来您需要扩展以利用网络农场，那么您将不会遇到问题。但是，如果您正在缓存数据并在本地工作，那么它将导致有趣的事情发生。

此外，您可以利用网络花园设置来帮助管理服务器的任何负载；这在缓存的情况下是不可能的。

其次，意识到这可能不一定是完美的。如果您有大量工作要做（例如在呼叫中心分发潜在客户），那么只要速度很快，就可以真正接近。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-14T21:05:41.827

我会使用数据库来控制这一点，因为用户不太可能足够快地完成工作以需要更实时的方法。

所以我会有一系列与工作项相关的表格，您可以查询这些表格来计算当前的工作级别，从而确定下一个接收特定工作项的人。

然后，您可以使用一系列存储过程将工作项标记为完成，或将工作项分配给某人。

为了最大限度地减少瓶颈，请确保您的数据库正常化，并且您的存储过程不使用很多表，这应该很好地增加。

要检查这一点，您可以编写一些测试工具来确保工作项的分配，并且性能是您在高使用率下所期望的。

# sharepoint - 具有给定 URL 的 CAML 查询项

> ID：202752
> 
> 赞同：2
> 
> 时间：2008-10-14T20:51:46.490
> 
> 标签：sharepoint, moss, caml

在 SP2007/MOSS 中，我需要对单个列表运行 CAML 查询，如下所示：

```
<Where>
    <Or>
        <Eq>
            <FieldRef Name='URL' />
            <Value Type='URL'>/path/item1.aspx</Value>
        </Eq>
        <Eq>
            <FieldRef Name='URL' />
            <Value Type='URL'>/path/item4.aspx</Value>
        </Eq>
        <Eq>
            <FieldRef Name='URL' />
            <Value Type='URL'>/path/item7.aspx</Value>
        </Eq>
    </Or>
</Where> 
```

这样做的实际结果是我有一个 SPListItemCollection，其中包含我拥有 URL 的项目。

但是，我收到错误消息“未正确安装一个或多个字段类型。转到列表设置页面以删除这些字段。

列表中的所有项目都具有相同的内容类型。SP 日志中唯一相关的错误显示相同的消息。

答案并没有解决这个特定问题，但最终是正确的（或者必须嵌套）。问题是我的字段值类型应该是 FileRef。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-16T10:08:13.790

此错误几乎总是因为您的 CAML 查询不正确。您是否尝试过像这样格式化它：

```
<Where>
    <Or>
        <Eq>
            <FieldRef Name='URL' />
            <Value Type='URL'>/path/item1.aspx</Value>
        </Eq>
        <Or>
            <Eq>
                <FieldRef Name='URL' />
                <Value Type='URL'>/path/item4.aspx</Value>
            </Eq>
            <Eq>
                <FieldRef Name='URL' />
                <Value Type='URL'>/path/item7.aspx</Value>
            </Eq>
        </Or>
    </Or>
</Where> 
```

我很确定在 Or 或 And 分支中只能有两个组件。

# crystal-reports - 水晶报表11：空白字段炸弹报表

> ID：202777
> 
> 赞同：2
> 
> 时间：2008-10-14T20:54:57.683
> 
> 标签：crystal-reports

我正在为 sage mas 500 AR 模块创建发票水晶报表。在其中，我尝试`tarinvoice.balance`使用以下公式添加字段：

```
if {tarPrintInvcHdrWrk.Posted} = 1 then 
    ToText({tarInvoice.Balance}) 
```

我假设当`{tarPrintInvcHdrWrk.Posted} = 1`条件语句为 FALSE 时，它不会尝试提取发票字段，因为当我从报告中删除公式时，没有它的表单会正确显示。

当条件语句在报表中呈现为真时，余额字段的行为正确。但是，由于公式在 CR 表单中呈现 FALSE，整个水晶报表会爆炸并显示空白。任何想法为什么或我做错了什么？

* * *

只是尝试将所有内容设置为零，但报告仍然炸弹。我开始认为它更多的是报告中的查询错误。我希望有一种方法可以在发布 = 0 时排除查询中的字段。

当`tarinvoice.balance`张贴 = 0 时删除，报告工作正常。
包含并`tarinvoice.balance`发布= 1，报告工作正常。

包含并`tarinvoice.balance`发布=0，报告炸弹。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-14T21:14:41.980

我相信如果遇到 NULL，条件语句会立即失败，因此您的公式需要先测试**IsNull({tarPrintInvcHdrWrk.Posted})**，然后再测试与“1”的相等性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-15T14:56:42.633

我将公式修改为：

```
if isnull({tarPrintInvcHdrWrk.Posted}) = FALSE then 
    if {tarPrintInvcHdrWrk.Posted} = 1 then 
        if isnull({tarInvoice.Balance}) = FALSE then 
            ToText({tarInvoice.Balance})
        else 
            "0.00" 
    else 
        "0.0"
else 
"0" 
```

水晶报告仍然会爆炸。尽管如此，它确实在适当的空间显示“0”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-25T04:22:38.360

也许您的报告中有 Suppress If Blank 部分。试着把：否则“”

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-31T22:54:30.340

如果您将 {tarInvoice.Balance} 直接放在报告上（进入详细的“调试”部分 - 经常需要，不要忘记在生产中抑制它:)），它显示什么值或报告变成空？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-15T06:08:52.963

您可以更改 Crystal 处理公式中值的空值的方式。在 Formula Workshop 的顶部有一个下拉框，通常显示“Exceptions For Nulls”。
将此更改为另一个选项“Nulls 的默认值”，您的公式不应再被炸毁。您过去可以指定应用的默认值，但最新版本的 Crystal 对这些进行了硬编码。在“Null Treatment”的帮助中搜索显示它们的表格。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-17T08:34:59.393

我在 Exp.Exch 上看到了一个建议，尝试在将字段转换为文本之前将其放入变量中。
例如

```
NumberVar InvoiceBalance;  
If isnull({tarInvoice.Balance}) then
    InvoiceBalance := 0
Else
    InvoiceBalance := {tarInvoice.Balance};

If {tarPrintInvcHdrWrk.Posted} = 1 then
    ToText(InvoiceBalance); 
```

我也尝试重新创建您的问题，因为我以前看到过类似的事情。
尽管尝试使用 CR 8.5 和 XI R2，但运气不佳。也许它也与链接表有关，因为我只尝试了一个简单的单表。
在运行总计中使用公式时，我也看到了类似的行为——它们根本不喜欢空值！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-10-07T10:00:06.620

```
if isnull({tarPrintInvcHdrWrk.Posted}) or {tarPrintInvcHdrWrk.Posted}=0 then
" "
else
if {tarPrintInvcHdrWrk.Posted} = 1 then 
    ToText({tarInvoice.Balance})
else
" " 
```

在制作报告以导出到 Excel 时，我遇到了这类字段的问题。没有数据的字段会将其右侧的所有列拉到“填补空白”。

# merge - 合并忽略 $Id 行的工具

> ID：202786
> 
> 赞同：6
> 
> 时间：2008-10-14T20:57:02.297
> 
> 标签：merge, cvs

我需要合并一个分叉的项目。不幸的是，CVS $Id 行不同，所以我尝试的合并工具报告所有文件都不同（其中 95% 的文件只有这一行不同）

是否有可以配置为忽略基于模式的行比较结果的合并工具？

[编辑] 我发现 WinMerge 有线路过滤器 - 正确设置它们实际上是有效的。

弗朗切斯科

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-14T21:11:37.697

我使用meld，它可以使用正则表达式过滤器来忽略。它有一些您可以选择的预设，包括 CVS 关键字。它用于该 BTW 的正则表达式是：

```
\$\w+(:[^\n$]+)?\$ 
```

您可以在任何 linux 发行版上获得融合或从此处下载：[http](http://meld.sourceforge.net/) : //meld.sourceforge.net/ [http://kdiff3.sourceforge.net/](http://kdiff3.sourceforge.net/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-17T16:53:55.967

好吧，您可以使用 cvs update -kk whick 不会扩展 $words。

当然这仍然是 $log 在提交而不是更新时扩展的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-14T21:05:30.190

[CompareIT](http://www.grigsoft.com/wincmp3.htm)允许使用[正则表达式](http://www.grigsoft.com/wincmp3/help/source/html/cmp_usingregularexpressions.htm)匹配。我将它用于自动生成的代码比较，它非常有用。

# html - DOCTYPE RSS & HTML 实体

> ID：202790
> 
> 赞同：4
> 
> 时间：2008-10-14T20:57:46.273
> 
> 标签：html, rss, feed, entities

我的 RSS 提要下有一个**“ldquo”**、**“rdquo”**和其他几个实体。好像如果我添加

```
<!DOCTYPE rss [
  <!ENTITY % HTMLspec PUBLIC
  "-//W3C//ENTITIES Latin 1 for XHTML//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml-special.ent">
  %HTMLspec; 
```

在**xml**标记下方和**rss**标记上方，我将能够包含这些实体。我添加了，但它似乎不起作用。有谁知道我错过了什么？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-15T04:58:25.163

许多提要读者似乎不太可能知道如何处理它。我建议坚持使用编号的实体引用。例如，更改`&ldquo;`为`&#8220;`。[您可以从 w3c](http://www.w3.org/TR/REC-html40/sgml/entities.html)获得完整的实体参考。

此外，你可以阅读[这篇文章](http://myst-technology.com/public/item/11878)和[这篇](http://dotjay.co.uk/2006/sep/named-html-entities-in-rss)文章，它提供了一些关于这个主题的好技巧。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-26T21:27:21.357

忘记实体。只需对所有字符使用 UTF-8。

无论 RSS 客户端是否正确解析 XML，它都会可靠地工作（遗憾的是，后者并不少见）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-13T23:37:39.077

奇怪的是，但在 RSS 而不是

`&rsquo;`

我用了

`&amp;rsquo;`

它适用于我拥有的所有浏览器（IE、Mozilla、Google Chrome）

# iphone - 在 CALayer 中使用 UIImage 会影响性能吗？

> ID：202792
> 
> 赞同：2
> 
> 时间：2008-10-14T20:57:55.087
> 
> 标签：iphone, objective-c, cocoa-touch

我正在使用一大堆 CALayers，创建与 GoogleMaps 不同的基于图块的图像（具有更多/更少细节的同一图像的不同版本）。

我用来执行此操作的代码是：

```
UIImage* image = [self loadImage:obj.fileName zoomLevel:obj.zoomLevel];
[CATransaction setValue:(id)kCFBooleanTrue
                 forKey:kCATransactionDisableActions];
obj.layerToAddTo.contents = [image CGImage];
[CATransaction commit]; 
```

我真的不想使用 CoreGraphics 从文件中加载 CGImage，因为我很懒。但如果有很大的性能提升，我会的！LoadImage 只是破坏一个字符串以获得加载所述图像的正确路径，而 obj 是一个 NSObject 结构，它包含我需要的所有信息。

帮助？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-14T21:31:05.473

性能并没有很大的提升——如果有的话，情况恰恰相反。通过 UIImage 来加载你的图像，你将获得它为你做的缓存的所有好处，它将是一个非常快速的生物，可以与你的各种 CALayer 一起使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-19T13:15:12.663

我刚刚尝试过，使用纯 CoreGraphics 加载图像而不是使用 UIImage 在一次加载许多图像时显着提高了速度。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-21T19:04:30.360

“我刚刚尝试过，使用纯 CoreGraphics 加载图像而不是使用 UIImage 在一次加载许多图像时显着提高了速度。”

你是如何避免使用 UIImage 的？或者更准确地说，如何在不通过 UIImage 的情况下将图像文件直接加载到 CoreGraphics 中？

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2010-09-28T18:13:31.537

不使用加载图像的一个原因`UIImage -imageNamed:`是它们存储在内部缓存中，并且在内存不足的情况下不会清除缓存。

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2008-10-16T15:53:04.953

我没有明确的答案，但我猜你在使用 UIImage 时会看到比使用 CGImage 时更慢的加载时间。使用 CGImage，您在创建过程中指定图像类型（jpg 或 png），但使用 UIImage，需要动态确定对象类型。诚然，这可能就像查看图像文件的前几个字节一样简单，但可能并非如此。

一旦图像实际被使用，我不会想象使用内部表示 UIImage 的 CGImage 与使用您自己创建的 CGImage 之间会有任何区别。我认为它们将完全等效。

# maven-2 - 使用 maven2 进行 Eclipse rcp 项目的构建自动化和持续集成？

> ID：202793
> 
> 赞同：8
> 
> 时间：2008-10-14T20:58:07.367
> 
> 标签：maven-2, continuous-integration, build-automation, eclipse-rcp

我的公司下周开始一个新项目。我们计划使用 eclipse rcp 开发应用程序。构建过程应该是完全自动化的，所以我们准备建立一个持续集成环境（例如 Continuum）。对于构建自动化部分，我打算使用 maven2，因为我想使用它的依赖管理。

我曾将 maven2 用于一个小型的老式 java 项目，但从未设置 maven 以将其与 eclipse rcp 一起使用。

最好的方法是什么？基本概念？常见的陷阱？那里有教程或书籍吗？我发现的教程和信息似乎过时或不完整。

PS：主项目将分为子项目（插件）。但我认为这对于 eclipse rcp 项目来说是典型的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-10T23:52:27.600

你应该看看第谷：

[the-future-of-maven-osgi-join-the-tycho-users-mailing-list](http://www.sonatype.com/people/2009/03/the-future-of-maven-osgi-join-the-tycho-users-mailing-list/)

[下一代构建工具用于 Eclipse 插件和 rcp 应用程序](http://www.sonatype.com/people/2008/11/the-next-generation-of-build-tools-for-eclipse-plugins-and-rcp-applications/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-23T18:37:19.890

像大多数 Maven 问题一样，这可以通过一个插件的链接来解决：

[“pde-maven-插件”](http://mojo.codehaus.org/pde-maven-plugin/)

其他建议：

1.  使用程序集插件构建更新站点
2.  考虑使用 hudson 而不是 Continuum

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-03T00:31:19.533

一段时间以来，我一直在与 maven2/Eclipse RCP 集成作斗争。关键不在于正确设置您的设置：您可以通过在 Maven 中对 Eclipse 的构建过程进行逆向工程来使其工作 - 最终。

根据我的经验，最困难的部分是让所有内容保持最新。每次 Eclipse 修改它们的库时，您都会发现自己为最新的 RCP 小部件或 SWT 库重新编写了一堆 pom 文件。自然，CI 在这方面有所帮助。问题在于 Eclipse 和 maven 对构建业务的方式非常挑剔，而且它们的方法也大不相同。更糟糕的是，PDE 开发（以及更普遍的 Eclipse 开发）由大量向导代码提供支持，这些代码有时对于幕后发生的事情非常不透明。

您真正需要问自己的问题是是否值得付出努力。在我的特殊情况下，我相信它已经发生了。（CI 太好了，不能没有。）但代价是您可能会发现自己是“构建者”，这可能会占用实际开发的宝贵时间，这可能是您最喜欢的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-22T20:35:54.827

我最近遇到了同样的问题：通过持续集成构建 eclipse RCP 应用程序。

我还没有应用它们，但我发现了一些有趣的文章：

1.  这是[第谷的文档](http://docs.codehaus.org/display/M2ECLIPSE/Tycho+user+docs)
2.  在 eclipse.org 上[使用 Maven 2 构建 Eclipse 插件](http://www.eclipse.org/articles/article.php?file=Article-Eclipse-and-Maven2/index.html)
3.  [使用 Maven 2 构建 Eclipse RCP 产品——这有多难？](http://aspsp.blogspot.com/2008/01/build-eclipse-rcp-products-using-maven.html)来自 Immo Hüneke 的博客
4.  这是一篇关于[PDE 构建自动化的文章](http://www.eclipse.org/articles/Article-PDE-Automation/automation.html)
5.  这是一个[自动化 JUnit 测试启动的 shell 脚本](http://wiki.eclipse.org/Starting_Eclipse_Commandline_With_Equinox_Launcher/Headless_JUnit_Testing)

# search - 在 Emacs 中搜索标记（选定）的文本

> ID：202803
> 
> 赞同：54
> 
> 时间：2008-10-14T21:00:36.113
> 
> 标签：search, emacs, text, text-editor

我使用 emacs 来查看和编辑代码和其他文本文件。我想知道是否有一种方法可以向前或向后搜索在当前缓冲区中标记的文本。类似于我可以在记事本或写字板中执行的操作。如我可以在缓冲区中标记一些文本并执行 Cs 或 Cr 并能够使用标记的文本进行搜索而无需实际输入整个搜索文本吗？

谢谢，

罗希特

* * *

## 回答 #1

> 赞同：112
> 
> 时间：2008-10-14T22:04:26.747

@Alex 说得通。

我经常使用的另一个选项是`C-s C-w`在当前标记之后搜索单词。重复点击`C-w`会增加附加词的搜索（例如，`C-s C-w C-w C-w`搜索当前标记之后的 3 个词）。

同样，`C-s M-s C-e`在当前标记之后搜索该行的其余部分并在该标记`C-s C-M-y`之后搜索字符。这些都可以以相同的方式重复（前者通过有点尴尬地重复`M-s C-e`after `C-s`）。

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2008-10-14T21:05:39.550

是的。 `M-W`（获取所选文本的副本）`C-s <RET> C-y <RET>`。然后根据需要重复`C-s`。同样对于`C-r`。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2012-08-13T07:40:07.887

我正在使用以下内容，它不存在必须键入多个连续 C 来查找以后出现的问题：

```
 (defun search-selection (beg end)
      "search for selected text"
      (interactive "r")
      (kill-ring-save beg end)
      (isearch-mode t nil nil nil)
      (isearch-yank-pop)
    )
    (define-key global-map (kbd "<C-f3>") 'search-selection) 
```

前面代码的缺点是选中的文本被复制到了stretch。下面的代码没有这个问题：

```
 (defun search-selection (beg end)
      "search for selected text"
      (interactive "r")
      (let (
            (selection (buffer-substring-no-properties beg end))
           )
        (deactivate-mark)
        (isearch-mode t nil nil nil)
        (isearch-yank-string selection)
      )
    )
    (define-key global-map (kbd "<C-f3>") 'search-selection) 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2015-08-14T04:07:41.510

其他答案描述了如何搜索复制的文本，或如何搜索该单词。但它们都没有真正描述如何“使用标记的文本进行搜索”。

添加以下钩子将使当前选择的文本成为用于 isearch 的文本：

```
(defun jrh-isearch-with-region ()
  "Use region as the isearch text."
  (when mark-active
    (let ((region (funcall region-extract-function nil)))
      (deactivate-mark)
      (isearch-push-state)
      (isearch-yank-string region))))

(add-hook 'isearch-mode-hook #'jrh-isearch-with-region) 
```

[提示：这很好地与expand-region](http://emacsrocks.com/e09.html)配对。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-10-15T09:37:00.873

执行此操作的最短键序列是`M`- `w` `C`- `s` `M`- `y`。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-04-21T18:01:56.453

有一个很棒的功能：`isearch-forward-symbol-at-point`. 它突出显示您的点所在的单词的所有出现 - 无需将点放在单词的开头。然后您可以使用 Cs 或 Cr 移至下一个或上一个。

请注意，它是完全匹配的：例如，如果您在其上使用它，`hi`则不会匹配`chill`。

我将 if 映射到`command-f`(mac OSX): `(global-set-key (kbd "s-f") 'isearch-forward-symbol-at-point)`在 init 文件中。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2015-03-15T04:51:16.777

上面的答案（包括接受的答案）太麻烦恕我直言。我找到了以下信息，并且更喜欢它：

> “Ctrl+s Ctrl+w”。这将搜索当前单词，但您必须先将光标移动到单词的开头。

[http://xah-forum.blogspot.com/2009/08/search-word-under-cursor-in-emacs.html](http://xah-forum.blogspot.com/2009/08/search-word-under-cursor-in-emacs.html)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-02-21T17:45:54.573

您可以通过执行 Ch k Cs 找到 Cs 帮助，它说：

> 键入 DEL 以取消搜索字符串末尾的最后一个输入项。键入 RET 退出，将点留在找到的位置。键入 LFD (Cj) 以匹配行尾。键入 Cs 再次向前搜索，键入 Cr 再次向后搜索。***键入 Cw 以提取缓冲区中的下一个单词或字符*** 到搜索字符串的末尾，然后搜索它。键入 CMw 以从搜索字符串的末尾删除字符。键入 CMy 将 char 从缓冲区拉到搜索字符串的末尾并搜索它。键入 Ms Ce 将剩余的行拉到搜索字符串的末尾并搜索它。键入 Cy 以拉出最后一串被杀死的文本。键入 My 以将刚刚进入搜索提示的字符串替换为在它之前被杀死的字符串。键入 Cq 以引用控制字符进行搜索。键入 Cx 8 RET 以添加一个字符以按 Unicode 名称搜索，并完成。搜索时或搜索失败时的 Cg 取消对已成功找到的内容的输入。搜索成功时 Cg 中止并将点移动到起点。
> 
> 如果您尝试在搜索字符串仍为空的情况下退出，则会调用非增量搜索。
> 
> 键入 Mc 以切换搜索是否区分大小写。键入 Ms i 以在不可见文本中切换搜索。键入 Mr 以切换正则表达式模式。键入 Ms w 切换单词模式。键入 Ms _ 以切换符号模式。键入 Ms ' 切换字符折叠。
> 
> 键入 Ms SPC 以切换空白匹配。在增量搜索中，一个或多个空格通常匹配由变量“search-whitespace-regexp”定义的任何空格；另请参见变量“isearch-lax-whitespace”和“isearch-regexp-lax-whitespace”。
> 
> 键入 Ms e 以编辑 minibuffer 中的搜索字符串。
> 
> 还支持前 16 个搜索字符串的搜索环。键入 Mn 以在搜索环中搜索下一项。键入 Mp 以在搜索环中搜索上一项。键入 CMi 以使用搜索环完成搜索字符串。
> 
> 键入 M-% 以使用要从最后一个搜索字符串替换的字符串运行“查询替换”。键入 CM-% 以使用最后一个搜索字符串运行“query-replace-regexp”。键入 Ms o 以运行显示最后一个搜索字符串的“发生”。键入 Ms hr 以运行突出显示最后一个搜索字符串的“highlight-regexp”。
> 
> 键入 Ch b 以显示所有 Isearch 键绑定。键入 Ch k 以显示 Isearch 键的文档。键入 Ch m 以显示 Isearch 模式的文档。

# .net - 如何检查 WCF 地址访问并避免 AddressAccessDeniedException？

> ID：202807
> 
> 赞同：0
> 
> 时间：2008-10-14T21:01:30.183
> 
> 标签：.net, wcf

.NET 框架中是否有一种方法可以验证进程是否可以访问特定的 WCF 地址命名空间，而无需尝试调用 ServiceHost.Open 并捕获生成的 AddressAccessDeniedException？

现在，如果抛出该异常，我将在提升（管理员）模式下重新启动服务，以便我可以正确保留命名空间。但似乎应该有一种方法可以做到这一点，而无需等待抛出异常，这在代码中更容易阅读。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2008-10-15T00:00:53.143

在此处查看代码：

[http://www.pluralsight.com/community/blogs/keith/archive/2005/10/17/15632.aspx](http://www.pluralsight.com/community/blogs/keith/archive/2005/10/17/15632.aspx)

# c# - 向 C# 数组添加值

> ID：202813
> 
> 赞同：626
> 
> 时间：2008-10-14T21:02:58.730
> 
> 标签：c#, arrays

这可能是一个非常简单的 - 我从 C# 开始，需要向数组添加值，例如：

```
int[] terms;

for(int runs = 0; runs < 400; runs++)
{
    terms[] = runs;
} 
```

对于那些使用过 PHP 的人，这是我在 C# 中尝试做的事情：

```
$arr = array();
for ($i = 0; $i < 10; $i++) {
    $arr[] = $i;
} 
```

* * *

## 回答 #1

> 赞同：954
> 
> 时间：2008-10-14T21:08:42.337

你可以这样做 -

```
int[] terms = new int[400];
for (int runs = 0; runs < 400; runs++)
{
    terms[runs] = value;
} 
```

或者，您可以使用列表 - 列表的优势在于，您在实例化列表时不需要知道数组大小。

```
List<int> termsList = new List<int>();
for (int runs = 0; runs < 400; runs++)
{
    termsList.Add(value);
}

// You can convert it back to an array if you would like to
int[] terms = termsList.ToArray(); 
```

**编辑：** [a) List<T> 上的**for循环比 List<T> 上的****foreach**循环便宜 2 倍多，b) 数组循环比 List<T> 循环便宜约 2 倍，c) 循环使用**for**的数组比使用**foreach**循环 List<T> 便宜 5 倍（我们大多数人都这样做）。](https://stackoverflow.com/a/365658/495455)

* * *

## 回答 #2

> 赞同：117
> 
> 时间：2017-04-04T09:24:21.300

使用[Linq](https://docs.microsoft.com/en-us/dotnet/api/system.linq)的方法[Concat](https://docs.microsoft.com/en-us/dotnet/api/system.linq.enumerable.concat)使这变得简单

```
int[] array = new int[] { 3, 4 };

array = array.Concat(new int[] { 2 }).ToArray(); 
```

结果 3,4,2

* * *

## 回答 #3

> 赞同：93
> 
> 时间：2008-10-15T00:30:29.013

如果您使用 C# 3 编写，则可以使用单行代码：

```
int[] terms = Enumerable.Range(0, 400).ToArray(); 
```

此代码片段假定您在文件顶部有一个用于 System.Linq 的 using 指令。

另一方面，如果您正在寻找可以动态调整大小的东西，就像 PHP 的情况一样（我从未真正学习过），那么您可能想要使用 List 而不是 int[] . 这是*该*代码的样子：

```
List<int> terms = Enumerable.Range(0, 400).ToList(); 
```

但是请注意，您不能通过将 terms[400] 设置为一个值来简单地添加第 401 个元素。相反，您需要调用 Add()，如下所示：

```
terms.Add(1337); 
```

* * *

## 回答 #4

> 赞同：44
> 
> 时间：2008-10-14T21:11:07.353

此处提供了有关如何使用数组执行此操作的答案。

但是，C# 有一个非常方便的东西，叫做 System.Collections :)

集合是使用数组的花哨替代品，尽管其中许多在内部使用数组。

例如，C# 有一个名为 List 的集合，其功能与 PHP 数组非常相似。

```
using System.Collections.Generic;

// Create a List, and it can only contain integers.
List<int> list = new List<int>();

for (int i = 0; i < 400; i++)
{
   list.Add(i);
} 
```

* * *

## 回答 #5

> 赞同：23
> 
> 时间：2020-10-16T10:55:10.770

到 2019 年你可以使用，`Append`只用一行`Prepend``LinQ`

```
using System.Linq; 
```

进而：

```
terms= terms.Append(21).ToArray(); 
```

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2015-07-21T14:59:12.073

正如其他人所描述的那样，使用 List 作为中介是最简单的方法，但是由于您的输入是一个数组并且您不只是想将数据保存在 List 中，我想您可能会担心性能。

最有效的方法可能是分配一个新数组，然后使用 Array.Copy 或 Array.CopyTo。如果您只想将一个项目添加到列表的末尾，这并不难：

```
public static T[] Add<T>(this T[] target, T item)
{
    if (target == null)
    {
        //TODO: Return null or throw ArgumentNullException;
    }
    T[] result = new T[target.Length + 1];
    target.CopyTo(result, 0);
    result[target.Length] = item;
    return result;
} 
```

如果需要，我还可以发布将目标索引作为输入的插入扩展方法的代码。稍微复杂一点，使用静态方法 Array.Copy 1-2 次。

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2015-09-11T03:51:39.617

根据 Thracx 的回答（我没有足够的分数来回答）：

```
public static T[] Add<T>(this T[] target, params T[] items)
    {
        // Validate the parameters
        if (target == null) {
            target = new T[] { };
        }
        if (items== null) {
            items = new T[] { };
        }

        // Join the arrays
        T[] result = new T[target.Length + items.Length];
        target.CopyTo(result, 0);
        items.CopyTo(result, target.Length);
        return result;
    } 
```

这允许向数组中添加多个项目，或者只是将数组作为参数传递以连接两个数组。

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2008-10-14T21:05:41.173

您必须先分配数组：

```
int [] terms = new int[400]; // allocate an array of 400 ints
for(int runs = 0; runs < terms.Length; runs++) // Use Length property rather than the 400 magic number again
{
    terms[runs] = value;
} 
```

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2008-10-14T21:08:12.010

```
int ArraySize = 400;

int[] terms = new int[ArraySize];

for(int runs = 0; runs < ArraySize; runs++)
{

    terms[runs] = runs;

} 
```

这就是我编码的方式。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2008-10-14T21:10:25.140

C# 数组是固定长度的并且总是被索引的。使用 Motti 的解决方案：

```
int [] terms = new int[400];
for(int runs = 0; runs < 400; runs++)
{
    terms[runs] = value;
} 
```

请注意，这个数组是一个密集数组，一个 400 字节的连续块，您可以在其中放置东西。如果您想要一个动态大小的数组，请使用 List<int>。

```
List<int> terms = new List<int>();
for(int runs = 0; runs < 400; runs ++)
{
    terms.Add(runs);
} 
```

int[] 和 List<int> 都不是关联数组——这将是 C# 中的 Dictionary<>。数组和列表都是密集的。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2015-05-10T03:18:38.323

如果你真的需要一个数组，下面可能是最简单的：

```
using System.Collections.Generic;

// Create a List, and it can only contain integers.
List<int> list = new List<int>();

for (int i = 0; i < 400; i++)
{
   list.Add(i);
}

int [] terms = list.ToArray(); 
```

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2008-10-14T21:08:37.967

您不能轻松地将元素添加到数组中。您可以将元素设置在给定位置，如*fall888*概述的那样，但我建议使用 a`List<int>`或 a`Collection<int>`代替，`ToArray()`如果需要将其转换为数组，请使用。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2013-01-31T07:55:29.833

```
int[] terms = new int[10]; //create 10 empty index in array terms

//fill value = 400 for every index (run) in the array
//terms.Length is the total length of the array, it is equal to 10 in this case 
for (int run = 0; run < terms.Length; run++) 
{
    terms[run] = 400;
}

//print value from each of the index
for (int run = 0; run < terms.Length; run++)
{
    Console.WriteLine("Value in index {0}:\t{1}",run, terms[run]);
}

Console.ReadLine(); 
```

> /*输出：</p>
> 
> 索引 0 中的
> 值：400 索引 1
> 中的值：400 索引 2
> 中的值：400 索引 3
> 中的值：400 索引 4
> 中的值：400 索引 5
> 中的值：400 索引 6
> 中的值：400 索引 7 中的值： 400 索引
> 中的值索引 8：400
> 索引 9 中的值：400
> */

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2019-06-03T07:10:56.467

我将为另一个变体添加这个。我更喜欢这种类型的功能编码线。

```
Enumerable.Range(0, 400).Select(x => x).ToArray(); 
```

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2020-04-06T15:48:32.340

一种方法是通过 LINQ 填充数组

如果你想用一个元素填充一个数组，你可以简单地写

```
string[] arrayToBeFilled;
arrayToBeFilled= arrayToBeFilled.Append("str").ToArray(); 
```

此外，如果你想用多个元素填充一个数组，你可以在循环中使用前面的代码

```
//the array you want to fill values in
string[] arrayToBeFilled;
//list of values that you want to fill inside an array
List<string> listToFill = new List<string> { "a1", "a2", "a3" };
//looping through list to start filling the array

foreach (string str in listToFill){
// here are the LINQ extensions
arrayToBeFilled= arrayToBeFilled.Append(str).ToArray();
} 
```

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2014-09-16T23:42:36.777

只是一种不同的方法：

```
int runs = 0; 
bool batting = true; 
string scorecard;

while (batting = runs < 400)
    scorecard += "!" + runs++;

return scorecard.Split("!"); 
```

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2015-05-18T23:13:50.113

如果您不知道数组的大小或已有要添加的数组。你可以通过两种方式来解决这个问题。第一种是使用泛型`List<T>`：为此，您需要将数组转换为 a`var termsList = terms.ToList();`并使用 Add 方法。然后在完成后使用该`var terms = termsList.ToArray();`方法转换回数组。

```
var terms = default(int[]);
var termsList = terms == null ? new List<int>() : terms.ToList();

for(var i = 0; i < 400; i++)
    termsList.Add(i);

terms = termsList.ToArray(); 
```

第二种方法是调整当前数组的大小：

```
var terms = default(int[]);

for(var i = 0; i < 400; i++)
{
    if(terms == null)
        terms = new int[1];
    else    
        Array.Resize<int>(ref terms, terms.Length + 1);

    terms[terms.Length - 1] = i;
} 
```

如果您使用的是 .NET 3.5`Array.Add(...);`

这两个都将允许您动态地执行此操作。如果您要添加很多项目，那么只需使用`List<T>`. 如果它只是几个项目，那么调整数组大小将具有更好的性能。这是因为您在创建`List<T>`对象时受到了更多的影响。

**时间** *刻度：*

**3 件**

> 数组调整时间：6
> 
> 列表添加时间：16

**400 项**

> 数组调整时间：305
> 
> 列表添加时间：20

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2020-08-05T10:48:23.700

你不能直接这样做。但是，您可以使用**Linq**来执行此操作：

```
List<int> termsLst=new List<int>();
for (int runs = 0; runs < 400; runs++)
{
    termsLst.Add(runs);
}
int[] terms = termsLst.ToArray(); 
```

如果数组*项*在开始时不是空的，您可以先将其转换为**List**然后再执行您的 stuf。像：

```
 List<int> termsLst = terms.ToList();
    for (int runs = 0; runs < 400; runs++)
    {
        termsLst.Add(runs);
    }
    terms = termsLst.ToArray(); 
```

> **注意：**不要错过添加 ' **using System.Linq;** ' 在文件的开头。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2020-09-16T15:49:39.717

这对我来说似乎少了很多麻烦：

```
var usageList = usageArray.ToList();
usageList.Add("newstuff");
usageArray = usageList.ToArray(); 
```

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2021-02-20T18:33:13.387

[数组推送示例](https://dotnetfiddle.net/dTnU2t)

```
public void ArrayPush<T>(ref T[] table, object value)
{
    Array.Resize(ref table, table.Length + 1); // Resizing the array for the cloned length (+-) (+1)
    table.SetValue(value, table.Length - 1); // Setting the value for the new element
} 
```

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2008-10-14T21:07:06.723

```
int[] terms = new int[400];

for(int runs = 0; runs < 400; runs++)
{
    terms[runs] = value;
} 
```

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2014-03-13T10:38:23.690

```
 static void Main(string[] args)
        {
            int[] arrayname = new int[5];/*arrayname is an array of 5 integer [5] mean in array [0],[1],[2],[3],[4],[5] because array starts with zero*/
            int i, j;

          /*initialize elements of array arrayname*/
            for (i = 0; i < 5; i++)
            {
                arrayname[i] = i + 100;
            }

             /*output each array element value*/
            for (j = 0; j < 5; j++)
            {
                Console.WriteLine("Element and output value [{0}]={1}",j,arrayname[j]);
            }
            Console.ReadKey();/*Obtains the next character or function key pressed by the user.
                                The pressed key is displayed in the console window.*/
        } 
```

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2014-03-13T10:44:56.263

```
 /*arrayname is an array of 5 integer*/
            int[] arrayname = new int[5];
            int i, j;
            /*initialize elements of array arrayname*/
            for (i = 0; i < 5; i++)
            {
                arrayname[i] = i + 100;
            } 
```

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2020-02-25T12:07:47.250

**使用 C# 将列表值添加到字符串数组而不使用 ToArray() 方法**

```
 List<string> list = new List<string>();
        list.Add("one");
        list.Add("two");
        list.Add("three");
        list.Add("four");
        list.Add("five");
        string[] values = new string[list.Count];//assigning the count for array
        for(int i=0;i<list.Count;i++)
        {
            values[i] = list[i].ToString();
        } 
```

值数组的输出包含：

一

二

三

四

五

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2020-09-20T02:00:19.977

你可以通过一个列表来做到这一点。这里是如何

```
List<string> info = new List<string>();
info.Add("finally worked"); 
```

如果您需要返回此数组，请执行

```
return info.ToArray(); 
```

# wpf - 如何从 SOS 评估 silverlight/WPF 中的依赖属性？

> ID：202816
> 
> 赞同：1
> 
> 时间：2008-10-14T21:03:43.297
> 
> 标签：wpf, silverlight, windbg, sos

这个问题相当简单——我正在尝试使用 sos 调试 silverlight 应用程序中的内存泄漏，我能够使用 !gcroot 获得一些好的信息来确定哪些对象具有对应该被清除的对象的开放引用；但在这些情况下，它们往往是核心 UI 元素（如网格和故事板），如果无法查看它们的依赖属性值（如名称），我无法真正区分它们。尝试使用 !dumpobj 查看依赖属性对我来说简直是天方夜谭，它们都是相互引用的静态类（即属性），我最终只能绕圈子。在任何时候，我都无法在任何地方找到依赖属性的单个实际值。

我在谷歌上搜索了很多，但只能找到其他人在问这个问题，或者猜测没有得到答案。 [http://blogs.msdn.com/tess/archive/2008/09/16/qa-reader-emails-about-net-memory-leaks-and-random-questions.aspx](http://blogs.msdn.com/tess/archive/2008/09/16/q-a-reader-emails-about-net-memory-leaks-and-random-questions.aspx)就是这样一个没有答案的页面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-17T13:52:56.880

在 Reflector 中查看 DependencyObject.GetValue 的来源让我觉得这在 Windbg 中并非易事。作为一种替代方法（我承认这是一个 hacky），在您自己的类中，您可以将标准 CLR 属性绑定到 Name DP，这样您就可以在调试器中读取一个值。

# .net - 开源 .Net 报告工具

> ID：202817
> 
> 赞同：31
> 
> 时间：2008-10-14T21:03:57.807
> 
> 标签：.net, visual-studio, reporting-services, reporting

我正在寻找 Visual Studio 的报告服务/工具。我唯一的限制是我的网络服务器对我来说是安装任何东西的限制。所以我需要一些可以包含在我的项目中的东西。

我的用户需要能够将报告导出为 PDF 并且无法使用 Crystal，我几乎迷路了。

有任何想法吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-10-14T21:09:20.167

[fyireporting](http://www.fyireporting.com/)（根据 Apache 许可发布）值得一试。

fyiReporting RDL 项目是一个基于报表定义语言 (RDL) 的强大报表和图表系统。完全支持表格、自由格式、矩阵、图表。报告输出可以显示为 HTML、PDF、XML、.Net Control、Web 存档和打印机。存在用于 ASP.NET、Windows .Net 和命令行应用程序的库。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-14T21:12:20.753

试试微软的[ReportViewer](http://msdn.microsoft.com/en-us/library/ms251671(VS.80).aspx)系统。它使用报表定义语言，但它已经准备好开箱即用。它不是开源的，但它是可再分发的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-08-24T15:45:25.113

正如 Ant 所建议的，还有[ReportingCloud](http://sourceforge.net/projects/reportingcloud/)，它是 fyiReporting 的一个分支

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-05-30T15:26:38.010

如果你愿意没有报表设计器并且开源是绝对要求，那么看看[iTextSharp](http://itextsharp.com/) - 4.0 版是完全开源的（5.0 你必须为商业用途付费）。

[报告软件信息](http://www.reportingsoftware.info/)中列出了一些额外的开源系统。

# database - 什么是非关系数据库的例子？它们在哪里/如何使用？

> ID：202819
> 
> 赞同：28
> 
> 时间：2008-10-14T21:04:03.437
> 
> 标签：database, non-relational-database

我一直在使用关系数据库，但直到最近我才意识到必须有其他类型的**非**关系数据库。

有哪些非关系数据库的例子，它们在现实世界中的哪些地方/如何使用？为什么你会选择使用非关系数据库而不是关系数据库？

**编辑**：答案中还提到了另外两个类似的问题：

*   [非关系型数据库系统。](https://stackoverflow.com/questions/51027/database-system-that-is-not-relational)
*   [不使用关系数据库的充分理由？](https://stackoverflow.com/questions/37823/good-reasons-not-to-use-a-relational-database)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-22T20:29:30.257

这里提到的数据库类型的一个公认的晦涩但有趣的替代方案是**关联数据库**，例如来自[LazySoft Technology](http://www.lazysoft.com/)的 Sentences 。有一个免费的个人版本，您可以下载并自行尝试。企业版也是免费的，但需要向公司提出要求。

从本质上讲，关联数据库允许您以与我们的大脑几乎相同的方式存储信息：作为事物和这些事物之间的关联。“句子”这个名字来自于这种信息可以用*主-动词-宾语*语法表示的方式：

*   汤姆*是*劳拉的兄弟
*   旧金山*位于*加利福尼亚
*   迈克*的信用额度*为 10,000 美元

一个句子可以是另一个句子的主语或宾语：

*   （公共汽车 570早上8 点 15 分*到达）**周日*
*   玛丽*说*（馅饼*是*威廉烤的）

所以，一切都可以归结为*实体*和*关联*。

当然，Sentences 比这里可以表达的要多得多。我建议您花一些时间在LazySoft的[白皮书中阅读有关它的更多信息。](http://www.lazysoft.com/docs/other_docs/amd_whitepaper.pdf)

[“数据的关联模型”](http://www.lazysoft.com/resources_downloads.htm)是 Sentences 的创建者之一 Simon Williams 以 PDF 格式提供的一本书。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-10-14T21:06:09.067

*   平面文件
    *   CSV 或其他分隔数据
    *   电子表格
    *   /etc/passwd
    *   mbox 邮件文件
*   分层的
    *   Windows 注册表
    *   Subversion 使用文件系统 FSFS，而不是 Berkley DB

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-10-14T21:09:28.387

我们一直在研究的面向非关系文档的数据库是[Apache CouchDB](http://incubator.apache.org/couchdb/)。

> Apache CouchDB 是一个分布式、容错和无模式的面向文档的数据库，可通过 RESTful HTTP/JSON API 访问。除其他功能外，它还提供具有双向冲突检测和解决功能的健壮、增量复制，并且可以使用面向表的视图引擎（以 JavaScript 作为默认视图定义语言）进行查询和索引。

我们的兴趣是提供一个分布式访问用户首选项存储，该存储不受形状变化的影响，我们可以从 Java 序列化首选项对象，并使用基于 XULRunner 的客户端应用程序的 Javascript 轻松访问这些对象。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-10-14T21:53:29.983

任何声称是“伯克利风格数据库”或“键/值”数据库的数据库都不是关系型的。

这些数据库通常基于复杂的散列算法并提供基于键的非常快速的查找 O(1)，但将任何形式的关系优势留给最终用户。

例如，在关系数据库中，您将规范化您的结构并将许多表连接在一起以创建单个结果集。

在键/值数据库中，您将尽可能地进行非规范化，然后使用唯一键来查找数据。

如果您需要从两个源中提取数据，则必须手动将结果集连接在一起。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-10-14T21:47:32.103

所有数据库最初都是非关系型的，直到 1980 年代中期 DB2 和 Oracle 的到来，它们才变得普遍。在此之前，大多数数据库要么是平面文件，要么是分层文件。

平面文件本来就很无聊，但分层数据库就不那么无聊了，尤其是 DB2 实际上是在第一个实例的分层实现（即 VSAM）之上实现的。我相信 VSAM 仍然存在于大型机系统中，并且具有相当重要的意义。

DB/1（现在太模糊了，我什至找不到维基百科链接）是 IBM 的前身黄金时间数据库到 DB2（因此得名）。这是分层的——基本上你有一个由任意数量或“根”记录组成的文件，通常可以通过一个键直接访问。然后每个根记录可以有任意数量的子记录，每个子记录又可以有它自己的子记录。最终效果是一个索引文件或根记录，每个根都是潜在树状结构的顶部。访问子记录可能很棘手 - 直接访问存在限制，因此通常您最终会遍历树以查找所需的记录。“数据库”中可以包含任意数量的这些文件，通常通过键关联。

这有很大的缺点——尤其是实际上做任何事情都需要编写完整的程序——基本上相当于我们现在可以在几分钟内用 SQL 完成的工作。然而它确实在执行速度上得分，在那些日子里，大型机的处理能力与你的 iPhone 差不多（尽管针对数据 I/O 进行了优化），而糟糕的 DB2 查询可能会导致数百万美元的安装死亡。这在 DB/1 中从来都不是问题，在程序员比 CPU 时间更便宜的世界里，这是有道理的。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-10-14T21:18:31.083

[谷歌应用引擎数据存储](http://code.google.com/appengine/docs/datastore/overview.html)：

> App Engine 数据存储区不是关系数据库。虽然数据存储接口具有许多与传统数据库相同的功能，但数据存储的独特特性意味着设计和管理数据的方式不同，以利用自动扩展的能力。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-10-14T21:05:38.427

OSIsoft 的 PI 历史数据库是非关系型的。它仅用于存档带时间戳的数据。它在行业中被大量使用，特别是作为所有这些“仪表板”的后端数据库。

因为没有连接，所以不需要关系。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-01-03T00:07:53.983

尚未出现的另外两种类型的数据库：

1.  内容存储库是为内容（即文件、文档、图像等）设计的数据库。它们通常具有附加结构，例如浏览内容的分层方式、搜索、不同格式之间的转换、版本控制和许多其他事情。示例 - Alfresco、Documentum、JackRabbit、Day、OpenText、许多其他 ECM 供应商。

2.  目录，即 Active Directory 或 LDAP 目录。这些数据库专为低写入/高读取场景而设计，并且高度分布在高地理距离/高延迟连接中。虽然主要用于身份验证/授权，但如果您的用例符合要求，则不必如此。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2008-10-14T21:47:08.967

维度数据库是非关系数据库的绝佳示例。它们非常常用于 KPI 和其他类型的聚合或统计数据的“业务仪表板”/“商业智能”。它们通常由关系数据库填充，在某些情况下可以提供更好的性能。

[http://en.wikipedia.org/wiki/Dimensional_database](http://en.wikipedia.org/wiki/Dimensional_database)

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2008-10-14T22:01:39.467

1.  XML 数据库，例如[xindice](http://xml.apache.org/xindice/)
2.  对象数据库，例如[db4o](http://www.db4o.com/)

请注意，关系数据库的概念是非常有争议的。像[CJ Date](http://en.wikipedia.org/wiki/Christopher_J._Date)这样的纯粹主义者会争辩说，许多常用数据库（如 Oracle 和 SQL Server）没有充分符合关系模型，因此不能被称为“关系”。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2008-11-16T13:25:51.973

非关系型数据库就是不符合 Codd 的要求。Intersystems Caché 对旧 Pick 操作系统的数据库进行了全面重写/重新设计。从我对 Caché 的一点了解来看，它似乎是一个做得很好的重新设计。它允许 .net 程序像访问 SQL 一样访问数据库。Caché 运行 Pick OS 程序，无需任何更改。通过将 Pick 文件导入 Caché，您仍然可以使用它运行旧的绿屏应用程序，还可以使用 .net 编写新程序，这样您就可以迁移到 Windows 应用程序，而不会放弃您已经投入多年的数据设计。这里是Pick DB 模型的一些背景知识。Pick 数据库使用完全可变长度的记录和字段。所有表都由一个唯一键作为键，并且无需读取索引即可访问。Pick 将系统设计为使用散列算法，该算法通常在第一次物理读取时从磁盘读取项目（假设系统维护已正确执行）。Pick 中的字段是非类型化的。所有数据都存储为字符串，而 Casting 由程序员决定。Null 存储为空字符串，因此 null 不会像在 SQL 中那样占用磁盘空间。不需要外键。在“关系世界”中，DBA 必须创建 Order Header 表和 Order Line Item 表。在“选择模型”中有一个表。例如，“订单日期”是一个字段，它将存储自“1967 年 12 月 13 日”以来的天数（数据 Pick OS 首次打开）。挑选程序员没有千年虫问题。第二列是客户编号。最大的不同是当您进入产品编号列时，这将是“多值”（Codd 不合格）。换句话说，数据库可以处理该列中的 1-32000 个产品#。其他列（如 Quantity Ordered）将与产品编号处于控制/依赖关系，并且也将是多值的。当您到达已发货数量时，Pick 将转到第三个维度并具有 Sub-Multi-Valued 字段。您将有一个货件编号列，它将按行项目进行多值化，并且包含该货件编号的该行的货件数量的子多值化。不需要内部连接。该订单的所有数据都存储在一个表和一条记录中。从来没有孤行！其次，数据定义有点不同。我们的字典可以包含不在此表中或正在被操作的数据的定义。几个例子是，顾客姓名。它将被定义为“使用客户编号列并从客户表中返回名称字段。另一个示例是 Line Item Extension 将定义为 Quantity*Price/PricePer 的计算。我相信我在某处读到 Caché 声称拥有超过 100,000 个安装。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2008-10-14T21:07:15.490

我认为 Excel 中的平面文件数据库是非关系型的，并且被很多人使用。

它实际上只是一个无法与其他表连接的数据库表。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2008-10-14T21:09:55.907

面向对象的数据库是一种有趣的非关系型数据库。

贸易部门有时会使用 OO 数据库，因为每个交易/合同可能看起来有点像该类别中的其他交易/合同，但也具有独特的属性。很难用关系来表示它。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2008-10-15T00:39:48.337

[eXist-db](http://exist-db.org)是一个已经存在很长时间的 xml 数据库。它对于处理大量 xml 文档的[xquery特别有用。](http://www.w3.org/TR/xquery/)

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2008-10-14T21:11:03.190

任何包含数据但不表达该数据内关系的文件或文件组都是非关系数据库。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2008-10-14T21:41:06.437

[RRDtool](http://oss.oetiker.ch/rrdtool/)旨在存储和汇总日志数据。您配置一个采样间隔并将数据输入其中，然后它会返回基于时间的结果。它针对固定大小的存储进行了优化，并在一段时间后开始汇总过去的结果。例如，假设您有一个时间间隔为 5 分钟的循环数据库。即使您每秒发送一次温度数据，它仍然只会以 5 分钟的增量存储结果。一周后，它将这些结果平均为每小时值。一个月后，将每小时结果平均为每日数字，依此类推。

RRDtool 通常用作[Cricket](http://cricket.sourceforge.net/)和[MRTG](http://oss.oetiker.ch/mrtg/)等工具的后端，以连续数月和数年跟踪网络和环境数据。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2008-10-14T22:02:44.927

对于基于图形的 dbms，你有 neo4j

对于分层 dbms，您有任何标准文件系统或“模式”支持任何 LDAP 实现。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2008-11-16T13:19:58.163

有很多答案，但它们最终都属于两个主要类别之一：

1.  导航。包括树/层次数据库和图形数据库。

2.  打破第一范式（多个值）的数据库。包括 Pick 数据库和 Lotus Notes 及其后代，如 CouchDB。

编辑：当然，像 BDB 这样的键/值存储不是关系型的，但这不言而喻不是吗？我的意思是，它们只是键/值存储。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2008-10-14T21:19:40.893

dBase。虽然它是这样销售的，但它不符合要求。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2008-10-14T21:24:11.633

作为一个 OO 数据库，我们想到了 Intersystems Caché。一些医学和图书馆系统建立在此之上。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2008-10-15T03:37:20.930

1.  在我的公司 www.smartsgroup.com 中，我们有一个专有的数据库引擎，我们称之为“事务日志数据库”。它建立在平面文件之上，每个文件都包含一系列二进制格式的“事件”或“消息”，以及该数据的各种索引和用于重现证券交易所订单簿状态的算法。它针对顺序更新和顺序访问进行了高度优化。

2.  在科学应用程序中，使用专有数据库引擎而不是 RDBMS 也很常见。我还曾在一家拥有世界上最大的脑电图脑记录数据库的公司工作：www.brainresource.com。我们在那里使用了一个平面文件数据库，它对我们很有效。

3.  SmartsGroup 还使用时态数据库，它类似于非关系数据库表，不同之处在于我们存储了所有字段的所有更改的历史记录，因此我们可以重现特定行在特定日期的状态。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2008-10-30T20:26:45.807

上面链接的维度数据库的 Wiki 页面似乎已经消失了。

一些[OLAP](http://en.wikipedia.org/wiki/Olap)系统得到了多维数据库 (MOLAP) 的支持，这些数据库经常用于财务分析。他们提供交互式客户端，允许人们浏览不同聚合级别的数据。

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2009-02-04T23:49:21.910

在我的大学里有一个研究[演绎数据库](http://en.wikipedia.org/wiki/Deductive_database)的小组。

# command-line - 从命令行启动/停止 Windows 2008 Server 上的服务 - 拒绝访问

> ID：202824
> 
> 赞同：1
> 
> 时间：2008-10-14T21:04:44.187
> 
> 标签：command-line, windows-server-2008

我正在尝试使用“net start SERVICENAME”从命令行启动服务，但出现拒绝访问错误。

我是该服务器的管理员，因为我在一个域组中，该域组是服务器上的管理员。我**可以**从服务工具启动/停止服务。

我是 2008/Vista 的新手，所以也许我只是错过了一些东西..

更新：我没有使用“以管理员身份运行”。这是 2008 年的新事物吗？我在哪里可以找到这个选项？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-14T21:30:27.317

这可能有效：

> runas /user:administrator net start SERVICENAME

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-14T21:12:03.080

1.  在开始菜单的搜索框中键入 cmd。

2.  右键单击 cmd.exe 并以管理员身份运行。

    如果您经常这样做，您还可以创建 cmd 的快捷方式并将快捷方式设置为以管理员身份运行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-15T03:08:20.020

或者，您可以：

```
runas /user:DOMAIN\Administrator cmd 
```

以管理员权限启动另一个 shell。

```
net start SERVICENAME 
```

如果您需要以管理员身份运行多个命令...

# wpf - 集成 WPF 和 Windows 窗体

> ID：202827
> 
> 赞同：3
> 
> 时间：2008-10-14T21:05:37.023
> 
> 标签：wpf, winforms

我正在学习 WPF，想知道是否有一种方法可以从现有的 C# WinForm 中显示 WPF 窗口，而无需在 WPF 中“托管”WinForm？我尝试在按钮单击事件上使用 myWPFWindow.show() 来显示窗口。窗口正在显示，但窗口中显示的文本框阻止我输入。有人可以为我指明正确的方向吗？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-14T21:20:41.890

是的，这是我一年前也遇到的一个奇怪问题。我不完全记得解决方案，但是[这个论坛帖子](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/442782b1-00a1-4e2e-9cc6-ae99b6699126/)应该为您指明正确的方向。

# c - 在 C 程序中使用 telnet

> ID：202859
> 
> 赞同：9
> 
> 时间：2008-10-14T21:10:08.370
> 
> 标签：c, networking, telnet

我正在从事机器人自动化项目，但遇到了障碍。要控制机器人，需要通过 telnet 与它进行无线连接，并通过 tcp/ip 协议发送命令。（例如，“Mabc”命令根据左轮速度 (a)、右轮速度 (b) 和时间 (c) 将其向前移动）。我想做的是在 C 程序中进行一些计算，然后根据计算值向机器人发送消息。

如何在 C 程序中通过 tcp/ip 协议发送命令？

谢谢！

埃里克

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-14T21:16:12.820

您正在寻找插座。[这是 C 中套接字编程的综合指南。](http://www.beej.us/guide/bgnet/) Telnet 也是一个定义明确的协议，虽然我不知道这个机器人是否会使用 telnet（对于一个不会有太多额外好处的协议来说，这是额外的处理开销）机器人控制程序）。Telnet 由[RFC 854详细介绍](http://www.faqs.org/rfcs/rfc854.html)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-14T21:25:30.243

[Expect](http://en.wikipedia.org/wiki/Expect)将允许您与外部程序进行交互，但我不知道期望的 C 端口。否则，您会在 C 中找到一个 telnet 库，或者使用套接字编程编写您自己的库。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-14T23:13:27.827

我会使用 libcurl：[http](http://curl.haxx.se/libcurl/) ://curl.haxx.se/libcurl/ 。它会做你想做的事，并处理你真的不想处理的所有 telnet goo。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-14T23:12:49.573

[Expect](http://expect.nist.gov/)正是为了做到这一点而设计的——通过交互式程序进行对话。它是用[Tcl](http://www.tcl.tk/)编写的，用各种命令扩展了 Tcl 解释器。Tcl 很容易扩展；它从一开始就被设计成一种嵌入式脚本语言。主要的 C API 使用 argv 风格的结构将参数传递给 Tcl 命令，并且非常易于使用。C API 的最佳指南是[Ousterhout 的原著](https://rads.stackoverflow.com/amzn/click/com/020163337X)，我花了两个小时的实验课来启动并运行我的第一个嵌入式 Tcl 解释器。

作为奖励，您还可以获得一个内置的 Tcl 解释器，您可以使用它来为您的应用程序添加脚本功能。如果您愿意，您可能会发现其中相当一部分可以在 Tcl 中实现，因此总体上可能会节省您的时间。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-14T22:58:34.453

我会：

*   编写一些简单的 shell 脚本，其中包含按照此处文档编写的 telnet 交互。
*   使用主目录中的 .telnetrc 文件来控制 telnet 会话的各个方面，例如 crmod
*   使用系统调用调用脚本。

这样，您更改与机器人交互的周转时间就不必一直重新编译您的程序。

顺便说一句，这听起来很有趣。

HTH。

干杯，

抢

# flash - Flash AS2.0 - 增加标签的字体大小

> ID：202860
> 
> 赞同：1
> 
> 时间：2008-10-14T21:10:17.903
> 
> 标签：flash, actionscript-2

我知道这听起来像是一个非常明显的问题，但事实证明它比我想象的更难弄清楚。我正在使用 Flash 8/ActionScript 2.0 进行开发。

我有一个标签组件，我正在动态地从 xml 文档中为其分配文本。例如：

```
label.text = "<b>" + xml_node.firstChild + "</b>"; 
```

这成功地将标签的文本更改为该 XML 节点中的任何内容，并且由于我启用了 HTML，它使其变为粗体。但是，我想增加标签字体的大小，并且使用`<font>`标签不起作用。

我错过了什么吗？如何让字体变大？ActionScript 就是这么挑剔！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-14T21:42:39.287

当您说“标签组件”时，您是指 Flex 2 标签还是 TextField？

在后一种情况下，字体标签应该可以正常工作。例如，将字体设置为 24px 文本。如果没有，您可以使用样式表类指定字体大小，然后将其分配给 TextField。

在 Flex 2 标签的情况下，例如使用 label.setStyle("fontSize", 24) 将其设置为 24px 文本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-16T17:12:05.683

感谢大家的投入！在阅读了 David Arno 的帖子后，我明白了。这就是我正在做的事情。

```
label.text = "<b><font size=24>" + xml_node.firstChild + "</font></b>"; 
```

这是有效的：

```
//note the 'single quotes' around the 24
label.text = "<b><font size='24'>" + xml_node.firstChild + "</font></b>"; 
```

我只是尝试了在其中输入 24 的不同方法，并且单引号起作用了。另外，不要忘记在标签的参数选项卡中将 HTML 设置为 true。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-14T21:40:52.317

我不能肯定地说，但我认为您可能需要设置标签的 fontSize 样式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-14T21:42:42.283

字体标签只有在你有像 Arial、Verdana 或 Times New Roman 这样的网络就绪字体时才真正起作用，即使那样它仍然有点傻。很多时候 AS 通常会忽略字体标签，至少我遇到过这样的情况。如果您想格式化您的文本，我会使用 TextFormat 类来操作您的文本，而不是尝试通过 HTML 标记来设置它。除非你设置 HTML 标签，因为它真的是用 CSS 格式化的？

在这种情况下，我会检查并确保您的文本字段已设置为 HTML 标记。而不是使用 label.text 我会尝试使用 label.htmlText？这真的可能是任何数量的问题......

# php - mcrypt 和 IIS - 模块不会在 PHP 中加载

> ID：202867
> 
> 赞同：2
> 
> 时间：2008-10-14T21:11:37.353
> 
> 标签：php, windows, iis, phpmyadmin, mcrypt

我有 Windows 2003 Standard、IIS 6、PHP、MySQL 和 amy 试图让 mcrypt 工作，这样我就可以使用 phpMyAdmin。

我在 php.ini 中有未推荐的 php_mcrypt.dll，该文件位于我的扩展文件夹 (c:\php) 中。

我已将 libmcrypt.dll 下载到 c:\php、c:\php\ext、c:\windows、c:\windows\system32。我还在下一个文件中找到了该文件的第二个版本并尝试了该文件。每次更改后，我都重新启动了 IIS。

无论我尝试什么，当我检查 php_info(); 时似乎都没有加载 mcrypt。但是没有显示错误。

是否有另一个版本的 php_mcrypt.dll？有没有人有不需要 mcrypt 的 phpMyAdmin 版本？有没有人遇到过这个问题/有解决方案？

所有帮助将不胜感激。

非常感谢，

蒂姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-11-24T09:47:47.293

我们在 W2k3( **x64** )/IIS6/PHP5.2.17 上遇到了同样的问题。**将libmcrypt.dll**复制到**%WINDIR%\SysWOW64**和**IISRESET**解决了这个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-15T07:45:26.933

我有同样的问题，发现我的 libmcrypt.dll 版本已损坏，当我从网上下载一个版本时，它很好。正如你已经这样做了，我怀疑这有帮助吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-30T20:01:59.190

*   确保 php.ini 中的 extension_dir 指向正确的路径（例如 c:/php5/ext）
*   每次更改后尝试重新启动 Windows 而不是 IIS。
*   libmcrypt.dll 只需在 c:\windows\system32 中
*   为确保（未）加载 mcrypt，请使用 phpinfo() 进行检查。

我也很难让 mcrypt 加载，但以上帮助我更接近解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-30T20:04:38.687

尝试使用*php -m*从命令行启动 php 。它将向您显示已加载模块的列表。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-17T13:07:29.877

我对 Win 2k3 Server + IIS 6 + PHP 5.2.9 + mcrypt 也有一个奇怪的问题。一旦我添加了 mcrypt（或 mhash）扩展，fastcgi 就超时了。当我从 php.ini 中删除这些扩展时，我看到了预期的 phpinfo() 页面。真正奇怪的是，当我从命令行运行 php -m 时，我可以看到加载的模块。

我从 XAMPP （在 php 文件夹中）获取所有 dll 并将它们全部粘贴在我的 PHP 安装文件夹中（对我来说是 C:\Program Files\PHP）。对我的 php.ini 进行更改后

扩展=php_mcrypt.dll

我完全重新启动了 IIS，而不是回收应用程序池，并且我的 phpinfo 页面按预期工作。我不知道为什么，但 fastcgi 无法“看到” system32 文件夹中的库，我不得不将它们放在我的 php 根文件夹中。

祝你好运。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-26T16:12:41.940

在我的情况下，我的网站给出了错误“PHP 警告：mcrypt_decrypt()...”
我使用 IIS6 - Plesk - PHP 2.5
因此，我将 Plesk CP 中的 PHP 版本更新为 5.3，然后错误消失了。
希望这可以帮助某人。

# nhibernate - 代码生成器不好吗？

> ID：202871
> 
> 赞同：17
> 
> 时间：2008-10-14T21:12:15.450
> 
> 标签：nhibernate, code-generation, poco

我使用 MyGeneration 和 nHibernate 来创建基本的 POCO 对象和 XML 映射文件。我听说有些人说他们认为代码生成器不是一个好主意。目前最好的想法是什么？当它生成数千行无法理解的代码时，代码生成是不是很糟糕？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-10-14T22:17:48.873

由代码生成器生成的代码不应（作为概括）用于随后由人工干预进行编辑的情况。一些系统，例如各种 Visual C++ 化身的向导生成的代码，然后期望程序员手动编辑这些代码。这并不流行，因为它要求开发人员分解生成的代码，理解它并进行修改。这也意味着生成过程是一次性的。

生成的代码应该与系统中的其他代码存在于不同的文件中，并且只能从生成器中生成。生成的代码代码应该清楚地标记，以表明人们不应该修改它。我有机会做了不少这样或那样的代码生成系统，并且*所有*这样生成的代码在序言中都有这样的东西：

```
-- =============================================================
-- === Foobar Module ===========================================
-- =============================================================
--
--         === THIS IS GENERATED CODE.  DO NOT EDIT. ===
--
-- ============================================================= 
```

[Code Generation in Action](https://rads.stackoverflow.com/amzn/click/com/1930110979)是一本关于这个主题的好书。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-10-15T01:49:51.300

**代码生成器很棒，糟糕的代码就是糟糕的。**

此页面上的大多数其他响应都是“不，因为生成的代码通常不是很好”。

这是一个糟糕的答案，因为：

1) 生成器和其他任何东西一样都是工具——如果你滥用它们，不要责怪工具。

2) 开发人员倾向于以自己一次编写出色代码的能力而自豪，但您不会将代码生成器用于一次性项目。

我们在所有 Java 项目中都使用代码生成系统来实现持久性，并且在生产环境中生成了数千个类。

**作为经理，我爱他们，因为：**

1) 可靠性：该代码中没有明显的剩余错误。多年来，它经过了如此详尽的测试和改进，而不是调试时，我从不担心持久层。

2) 标准化：每个开发人员的代码在这方面都是相同的，所以当一个人从同事那里接一个新项目时，学习的东西要少得多。

3) 进化：如果我们找到更好的方法来做事，我们可以更新模板并快速一致地更新 1000 多个类。

4) 革命：如果我们将来切换到不同的持久性系统，那么每个持久性类都有完全相同的 API 的事实使我的工作变得容易得多。

5) 生产力：只需单击几下即可从元数据构建持久对象系统 - 这可以节省数千个无聊的开发时间。

代码生成就像使用编译器——在个别情况下，您可能能够编写更好的优化汇编语言，但在大量项目中，您宁愿让编译器为您做这件事，对吗？

我们采用了一个简单的技巧来确保类总是可以在不丢失定制的情况下重新生成：每个生成的类都是抽象的。然后开发人员使用具体类对其进行扩展，添加自定义业务逻辑并覆盖他希望与标准不同的任何基类方法。如果元数据发生变化，他可以随时重新生成抽象类，如果新模型破坏了他的具体类，编译器会通知他。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-10-14T21:21:53.260

我在使用代码生成器时遇到的最大问题是在维护期间。如果您修改生成的代码，然后对架构或模板进行更改并尝试重新生成，您可能会遇到问题。

一个问题是，如果该工具不允许您保护对修改后的代码所做的更改，那么您的更改将被覆盖。

我看到的另一个问题，特别是 RSA 中用于 Web 服务的代码生成器，如果您过多地更改生成的代码，生成器会抱怨不匹配并拒绝重新生成代码。这可能发生在像更改变量类型这样简单的事情上。然后，您被困在为不同的项目生成代码并将结果合并回原始代码中。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-10-14T22:57:56.733

代码生成器可以提高生产力，但需要注意以下几点：

**让您以您想要的方式工作。**

如果您必须弯曲非生成代码以适应生成的代码，那么您可能应该选择不同的方法。

**作为常规构建的一部分运行。**

输出应生成到中间目录，而不是签入源代码控制。但是，输入必须签入源代码控制。

**无需安装**

理想情况下，您也可以将该工具签入源代码控制。在准备新的构建机器时让人们安装东西是个坏消息。例如，如果您进行分支，您希望能够使用代码对工具进行版本控制。

如果必须，请制作一个脚本，该脚本将使用带有源树副本的干净机器，并根据需要配置机器。请全自动。

**没有编辑输出**

您不必编辑输出。如果输出按原样不够有用，则该工具不适合您。

此外，输出应该清楚地说明它是一个生成的文件并且不应该被编辑。

**可读输出**

输出应该写得很好并且格式化。您希望能够轻松打开输出并阅读它。

**`#line`**

许多语言都支持`#line`指令之类的东西，它允许您将输出的内容映射回输入，例如在生成编译器错误消息或单步执行调试器时。这可能很有用，但也可能很烦人，除非做得很好，所以这不是必需的。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-10-14T21:13:39.660

我的立场是代码生成器还不错，但它们的许多用途都不错。

如果您使用代码生成器来节省时间并编写好代码，那很好，但通常它没有优化，或者增加了很多开销，在这些情况下，我认为它很糟糕。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-14T21:38:03.727

如果你想在你的类中混入行为，代码生成可能会让你有些不快。一个同样有效的替代方案可能是属性/注释和运行时反射。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-14T22:03:15.847

编译器是代码生成器，因此它们本质上并不坏，除非您只喜欢使用原始机器代码进行编程。

然而，我相信代码生成器应该始终完全封装生成的代码。也就是说，您*永远*不必手动修改生成的代码，任何更改都应通过修改生成器的输入并重新生成代码来完成。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-14T22:02:11.683

如果它是 Fran Tarkenton 试图向您推销的大型机 cobol 代码生成器，那么绝对可以！

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-14T22:23:33.200

我之前写过一些代码生成器——老实说，它们不止一次地救了我的命！

一旦你有一个明确定义的对象 - 集合 - 用户控件设计，你可以使用代码生成器为你构建基础，让你作为开发人员的时间更有效地用于构建复杂的东西，毕竟，谁真正想要编写 300 多个公共属性声明和变量实例？我宁愿陷入业务逻辑而不是所有无意识的重复任务。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-15T03:39:54.527

许多人在使用代码生成时犯的错误是编辑生成的代码。如果您记住，如果您觉得需要编辑代码，那么您实际上需要编辑代码生成工具，这对提高生产力很有帮助。如果你不断地与生成的代码作斗争，最终会降低生产力。

我发现最好的代码生成器是那些允许您编辑生成代码的模板的生成器。出于这个原因，我真的很喜欢 Codesmith，因为它是基于模板的，而且模板很容易编辑。当您发现生成的代码存在缺陷时，您只需编辑模板并重新生成您的代码，然后您就会永远保持良好状态。

我发现的另一件事是，很多代码生成器在源代码控制系统中使用起来并不容易。我们解决这个问题的方法是签入*模板*而不是代码，我们签入生成的源代码控制的唯一内容是生成的代码（主要是 DLL 文件）的编译版本。这为您省去了很多麻烦，因为您只需签入几个 DLL，而不是可能生成数百个文件。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-06-30T13:25:41.980

我们当前的项目大量使用了代码生成器。这意味着我第一次看到了生成代码的“明显”好处——没有编码错误、没有拼写错误、更好地遵守标准编码风格——以及在维护模式下几个月后，意外的缺点。实际上，我们的代码生成器最初确实提高了我们的代码库质量。我们确保它是完全自动化的，并与我们的自动化构建集成。但是，我想说：

(1) 代码生成器可以是拐杖。现在，我们的系统中有几个巨大的、丑陋的难以维护的代码块，因为在过去的某一时刻，向我们的代码生成 XML 文件中添加 20 个新类比进行适当的分析和类更容易重构。

(2) 规则的例外会害死你。我们使用代码生成器创建数百个 Screen 和 Business Object 类。最初，我们对类中可能出现的方法实施了一个标准，但像所有标准一样，我们开始制定例外。现在，我们的代码生成 XML 文件是一个巨大的怪物，其中充满了插入到选定类中的特殊 Java 代码片段。几乎不可能解析或理解。

(3) 由于我们的大量代码是使用数据库中的值生成的，因此开发人员很难在其各自的工作站上维护一致的代码库（因为可以有多个版本的数据库）。通过软件进行调试和跟踪要困难得多，而且由于类之间存在额外的抽象和隐式关系，团队的新手需要更长的时间才能弄清楚代码的“流程”。IDE 无法获取通过代码生成的类进行通信的两个类之间的关系。

现在大概就够了。我认为代码生成器非常适合作为开发人员个人工具包的一部分。一组写出样板代码的脚本使启动项目变得更加容易。但是代码生成器*不会*让维护问题消失。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-14T21:15:28.923

在某些（不是很多）情况下，它们很有用。例如，如果您想根据数据库表中的查找类型数据生成类。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-14T21:15:33.260

当代码生成使编程变得更加困难时（IE、生成不良的代码或维护噩梦）是不好的，但当它们使编程更高效时它们是好的。

它们可能并不总是生成最佳代码，但根据您的需要，您可能会决定节省的开发人员工时弥补了一些小问题。

综上所述，我对 ORM 代码生成器的最大不满是，如果架构发生变化，维护生成的代码可能是 PITA。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-10-14T21:15:53.867

代码生成器还不错，但有时它们会在存在另一种解决方案的情况下使用（即，当对象数组更适合并在几行代码中完成时，实例化一百万个对象）。

另一种情况是它们使用不正确或编码错误。太多的人因为错误或对如何正确配置它的误解而有过糟糕的体验而对代码生成器发誓。

但就其本身而言，代码生成器还不错。

-亚当

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-10-14T21:16:03.977

它们就像任何其他工具一样。有些提供比其他更好的结果，但由用户知道何时使用它们。如果你想拧螺丝，锤子是一种可怕的工具。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-10-14T21:16:58.483

这是那些极具争议的问题之一。就个人而言，我认为代码生成器非常糟糕，因为它们中的大多数都输出了未经优化的垃圾代码。

然而，这个问题真的是只有你才能回答的问题。在许多组织中，开发时间比项目执行速度甚至可维护性更重要。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-10-14T21:17:30.960

我们使用代码生成器来生成数据实体类、数据库对象（如触发器、存储过程）、服务代理等。在任何你看到大量重复代码遵循模式和涉及大量手动工作的地方，代码生成器都可以提供帮助。但是，您不应该过多地使用它，以至于可维护性是一种痛苦。如果您想重新生成它们，也会出现一些问题。

Visual Studio、Codesmith 等工具为大多数常见任务提供了自己的模板，并使此过程更容易。但是，很容易自行推出。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-10-14T21:17:35.593

当您必须返回并且无法理解代码中发生了什么时，它确实会成为可维护性的问题。因此，很多时候您必须权衡与易于维护相比，快速完成项目的重要性

可维护性<>简单或快速的编码过程

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-10-14T21:18:45.937

我将 My Generation 与实体空间一起使用，我对此没有任何问题。如果我有架构更改，我只需重新生成类，一切都很好。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2008-10-14T21:22:53.307

它们充当拐杖，可以使您无法长期维持该计划。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2008-10-14T21:39:42.163

第一个 C++ 编译器是生成 C 代码 (CFront) 的代码生成器。

我不确定这是支持还是反对代码生成器的论据。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2008-10-14T22:12:21.647

我认为米切尔击中了它的头部。代码生成有它的位置。在某些情况下，让计算机为您完成工作会更有效！当进行代码更改的时间成本很小时，它可以让您自由地改变对特定组件的实现的想法。当然，了解代码生成器的输出可能仍然很重要，但并非总是如此。我们刚刚完成的一个项目中有一个示例，其中许多 C++ 应用程序需要通过命名管道与 C# 应用程序进行通信。我们最好使用小而简单的文件来定义消息，并为事务的每一方生成所有类和代码。当程序员处理问题 X 时，

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2008-10-14T22:39:24.603

这是一个工作流程问题。ASP.NET 是一个代码生成器。XAML 解析引擎在转换为 MSIL 之前实际上会生成 C#。当代码生成器变成像 CodeSmith 这样与您的开发工作流程隔离的外部产品时，必须特别注意使您的项目保持同步。例如，如果生成的代码是 ORM 输出，并且您对数据库模式进行了更改，您要么必须完全放弃代码生成器，要么利用 C# 处理部分类的能力（允许您添加成员和现有类的功能而不继承它）。

我个人不喜欢生成器工作流程的孤立/ Alt-Tab 特性；如果代码生成器不是我的 IDE 的一部分，那么我觉得它是一个杂物。一些代码生成器，例如 Entity Spaces 2009（尚未发布），比前几代生成器集成度更高。

我认为代码生成器的灵丹妙药*可以*在预编译例程中使用。C# 和其他 .NET 语言缺乏这一点，尽管 ASP.NET 喜欢它，这就是为什么 SubSonic 在 ASP.NET 上工作得如此之好，但在其他方面就不行了。SubSonic 在正常 ASP.NET 编译开始之前的构建时生成 C# 代码。

要求您的工具供应商（即 Microsoft）更彻底地支持预构建例程，以便可以使用元数据将代码生成器集成到您的解决方案的工作流程中，而不是作为必须单独维护的外部输出代码文件手动管理。

乔恩

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2008-10-15T13:34:02.970

代码生成器的最佳应用是当整个项目是一个模型，并且项目的所有源代码都是从该模型生成的。我不是在谈论 UML 和相关的废话。在这种情况下，项目模型还包含自定义代码。

那么开发人员唯一需要关心的就是模型。一个简单的架构更改可能会导致数千行源代码的即时修改。但一切都保持同步。

这是恕我直言最好的方法。听起来乌托邦？至少我知道它不是;) 不久的将来会证明这一点。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2008-10-15T13:55:19.247

在最近的一个项目中，我们构建了自己的代码生成器。我们为我们的视图和视图控制器类生成了所有的数据库内容，以及所有的基本代码。尽管生成器花费了几个月的时间来构建（主要是因为这是我们第一次这样做，而且我们有几个错误的开始），但它在我们第一次运行它并为整个应用程序生成基本框架时就收回了成本大约十分钟。这一切都是用 Java 编写的，但 Ruby 是一种出色的代码编写语言，尤其适用于小型一次性项目。最好的事情是代码和项目组织的一致性。此外，您必须提前考虑基本框架，这总是好的。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2010-12-01T02:53:26.987

假设它是一个好的代码生成器，代码生成器就很棒。尤其是非常冗长的工作 c++/java。

# ruby-on-rails - Rails text_field 没有关联的方法

> ID：202907
> 
> 赞同：2
> 
> 时间：2008-10-14T21:22:07.597
> 
> 标签：ruby-on-rails

我在创建没有方法关联的 text_field 时遇到问题。也许我什至不需要它:-)

我有两个与同一方法关联的 radio_buttons：

```
<%= radio_button :comment, :author, "anonymous" %> Anonymous <br>
<%= radio_button :comment, :author, "real_name" %> Name <br> 
```

我想要做的是有一个文本字段，当用户单击单选按钮“real_name”时，我可以验证这个新文本字段中的值。

基本上我的控制器会是这样的：

@comment = Comment.new(params[:comment])

if @comment.author == "real_name" @comment.author = "value-from-the-new-textfield end

有什么办法吗？

问候，

胜利者

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-14T21:43:13.017

如果要生成没有关联对象/方法的 text_field，请使用[`text_field_tag`](http://api.rubyonrails.com/classes/ActionView/Helpers/FormTagHelper.html#M001701)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-15T09:21:51.170

您可以使用另一个参数而不是 :comment

```
<%= radio_button :verify, :author, "anonymous" %> Anonymous <br>
<%= radio_button :verify, :author, "real_name" %> Name <br> 
```

因此，在您的控制器中，您可以获得所选按钮的值

```
if params[:verify][:author] == 'real_name' ... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-16T16:15:28.013

`text_field_tag`绝对是最简单的方法，但如果你想添加一个作为模型一部分的字段，添加一个`attr_accessor`属性可能也值得研究。

# sql - Linq 中的分层数据 - 选项和性能

> ID：202912
> 
> 赞同：12
> 
> 时间：2008-10-14T21:24:18.250
> 
> 标签：sql, linq, sql-server-2005, c#-3.0, common-table-expression

我有一些分层数据 - 每个条目都有一个 id 和一个（可为空的）父条目 id。我想检索给定条目下树中的所有条目。这是在 SQL Server 2005 数据库中。我在 C# 3.5 中使用 LINQ to SQL 查询它。

LINQ to SQL 不直接支持[公用表表达式](http://msdn.microsoft.com/en-us/library/ms190766.aspx)。我的选择是使用多个 LINQ 查询在代码中组合数据，或者在显示 CTE 的数据库上创建视图。

当数据量变大时，您认为哪个选项（或其他选项）性能更好？Linq to SQL 是否支持SQL Server 2008 的[HierarchyId 类型？](http://msdn.microsoft.com/en-us/library/bb677173.aspx)

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-07-10T16:49:26.283

此[选项](http://www.scip.be/index.php?Page=ArticlesNET18)也可能很有用：

**LINQ AsHierarchy() 扩展方法**
[http://www.scip.be/index.php?Page=ArticlesNET18](http://www.scip.be/index.php?Page=ArticlesNET18)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2010-03-23T20:43:37.880

我很惊讶没有人提到替代数据库设计 - 当需要从多个级别展平层次结构并以高性能检索（不考虑存储空间）时，最好使用另一个实体 2 实体表来跟踪层次结构而不是 parent_id方法。

它不仅允许单亲关系，还允许多亲关系、级别指示和不同类型的关系：

```
CREATE TABLE Person (
  Id INTEGER,
  Name TEXT
);

CREATE TABLE PersonInPerson (
  PersonId INTEGER NOT NULL,
  InPersonId INTEGER NOT NULL,
  Level INTEGER,
  RelationKind VARCHAR(1)
); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-14T22:19:01.103

我会根据 CTE 设置一个视图和一个关联的基于表的函数。我的理由是，虽然您可以在应用程序端实现逻辑，但这将涉及通过线路发送中间数据以在应用程序中进行计算。使用 DBML 设计器，视图转换为表实体。然后，您可以将该函数与 Table 实体相关联，并调用在 DataContext 上创建的方法来派生视图定义的类型的对象。使用基于表的函数允许查询引擎在构造结果集时考虑您的参数，而不是在事后对视图定义的结果集应用条件。

```
CREATE TABLE [dbo].[hierarchical_table](
    [id] [int] IDENTITY(1,1) NOT NULL,
    [parent_id] [int] NULL,
    [data] [varchar](255) NOT NULL,
 CONSTRAINT [PK_hierarchical_table] PRIMARY KEY CLUSTERED 
(
    [id] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]

CREATE VIEW [dbo].[vw_recursive_view]
AS
WITH hierarchy_cte(id, parent_id, data, lvl) AS
(SELECT     id, parent_id, data, 0 AS lvl
      FROM         dbo.hierarchical_table
      WHERE     (parent_id IS NULL)
      UNION ALL
      SELECT     t1.id, t1.parent_id, t1.data, h.lvl + 1 AS lvl
      FROM         dbo.hierarchical_table AS t1 INNER JOIN
                            hierarchy_cte AS h ON t1.parent_id = h.id)
SELECT     id, parent_id, data, lvl
FROM         hierarchy_cte AS result

CREATE FUNCTION [dbo].[fn_tree_for_parent] 
(
    @parent int
)
RETURNS 
@result TABLE 
(
    id int not null,
    parent_id int,
    data varchar(255) not null,
    lvl int not null
)
AS
BEGIN
    WITH hierarchy_cte(id, parent_id, data, lvl) AS
   (SELECT     id, parent_id, data, 0 AS lvl
        FROM         dbo.hierarchical_table
        WHERE     (id = @parent OR (parent_id IS NULL AND @parent IS NULL))
        UNION ALL
        SELECT     t1.id, t1.parent_id, t1.data, h.lvl + 1 AS lvl
        FROM         dbo.hierarchical_table AS t1 INNER JOIN
            hierarchy_cte AS h ON t1.parent_id = h.id)
    INSERT INTO @result
    SELECT     id, parent_id, data, lvl
    FROM         hierarchy_cte AS result
RETURN 
END

ALTER TABLE [dbo].[hierarchical_table]  WITH CHECK ADD  CONSTRAINT [FK_hierarchical_table_hierarchical_table] FOREIGN KEY([parent_id])
REFERENCES [dbo].[hierarchical_table] ([id])

ALTER TABLE [dbo].[hierarchical_table] CHECK CONSTRAINT [FK_hierarchical_table_hierarchical_table] 
```

要使用它，您可以执行以下操作——假设一些合理的命名方案：

```
using (DataContext dc = new HierarchicalDataContext())
{
    HierarchicalTableEntity h = (from e in dc.HierarchicalTableEntities
                                 select e).First();
    var query = dc.FnTreeForParent( h.ID );
    foreach (HierarchicalTableViewEntity entity in query) {
        ...process the tree node...
    }
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-14T22:30:42.233

我已经做到了这两种方式：

1.  根据用户输入驱动树的每一层的检索。想象一个树视图控件，其中包含根节点、根的子节点和根的孙子节点。只有根和孩子被展开（孙子被折叠隐藏）。当用户展开子节点时，根的孙子节点被显示（先前被检索和隐藏），并且启动了对所有曾孙子节点的检索。重复 N 层深度的模式。这种模式对于大型树（深度或宽度）非常有效，因为它只检索所需的树部分。
2.  使用带有 LINQ 的存储过程。使用服务器上的公共表表达式之类的东西在平面表中构建结果，或在 T-SQL 中构建 XML 树。Scott Guthrie 有[一篇](http://weblogs.asp.net/scottgu/archive/2007/08/16/linq-to-sql-part-6-retrieving-data-using-stored-procedures.aspx)关于在 LINQ 中使用存储过程的精彩文章。如果结果是平面格式，则在结果返回时从结果构建您的树，或者如果您返回的是 XML 树，则使用 XML 树。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-14T22:59:53.190

此扩展方法可能会被修改为使用 IQueryable。我过去曾在一组对象上成功使用过它。它可能适用于您的场景。

```
public static IEnumerable<T> ByHierarchy<T>(
 this IEnumerable<T> source, Func<T, bool> startWith, Func<T, T, bool> connectBy)
{
  if (source == null)
   throw new ArgumentNullException("source");

  if (startWith == null)
   throw new ArgumentNullException("startWith");

  if (connectBy == null)
   throw new ArgumentNullException("connectBy");

  foreach (T root in source.Where(startWith))
  {
   yield return root;
   foreach (T child in source.ByHierarchy(c => connectBy(root, c), connectBy))
   {
    yield return child;
   }
 }
} 
```

我是这样称呼它的：

```
comments.ByHierarchy(comment => comment.ParentNum == parentNum, 
 (parent, child) => child.ParentNum == parent.CommentNum && includeChildren) 
```

此代码是[此处](http://weblogs.asp.net/okloeten/archive/2006/07/09/Hierarchical-Linq-Queries.aspx)找到的代码的改进、错误修复版本。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-14T21:30:18.503

在 MS SQL 2008 中您可以直接使用[HierarchyID](http://msdn.microsoft.com/en-us/library/bb677290.aspx)，在 sql2005 中您可能必须手动实现它们。ParentID 在大型数据集上表现不佳。另请查看[本文](http://msdn.microsoft.com/en-us/library/bb677173.aspx)以获取有关该主题的更多讨论。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-14T23:19:02.433

我从[Rob Conery 的博客](http://blog.wekeroad.com/mvc-storefront/)中获得了这种方法（在 Pt. 6 附近查看此代码，也在 codeplex 上），我喜欢使用它。这可以重新设计以支持多个“子”级别。

```
var categories = from c in db.Categories
                 select new Category
                 {
                     CategoryID = c.CategoryID,
                     ParentCategoryID = c.ParentCategoryID,
                     SubCategories = new List<Category>(
                                      from sc in db.Categories
                                      where sc.ParentCategoryID == c.CategoryID
                                      select new Category {
                                        CategoryID = sc.CategoryID, 
                                        ParentProductID = sc.ParentProductID
                                        }
                                      )
                             }; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-15T00:15:55.140

从客户端获取数据的问题在于，您永远无法确定需要走多远。此方法将在每个深度执行一次往返，并且可以联合在一次往返中从 0 到指定深度执行。

```
public IQueryable<Node> GetChildrenAtDepth(int NodeID, int depth)
{
  IQueryable<Node> query = db.Nodes.Where(n => n.NodeID == NodeID);
  for(int i = 0; i < depth; i++)
    query = query.SelectMany(n => n.Children);
       //use this if the Children association has not been defined
    //query = query.SelectMany(n => db.Nodes.Where(c => c.ParentID == n.NodeID));
  return query;
} 
```

但是，它不能做任意深度。如果您确实需要任意深度，则需要在数据库中执行此操作 - 这样您就可以做出正确的停止决定。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-03-31T12:28:37.313

请阅读以下链接。

[http://support.microsoft.com/default.aspx?scid=kb;en-us;q248915](http://support.microsoft.com/default.aspx?scid=kb;en-us;q248915)

# c# - 在 C# 中嵌入 Powershell CTP 2

> ID：202913
> 
> 赞同：0
> 
> 时间：2008-10-14T21:24:41.197
> 
> 标签：c#, .net, powershell

我有一个嵌入了 Powershell 1 的应用程序，但我们需要能够使用 Powershell STAThreaded，它在 Powershell 2 CTP 中可用。目前，System.Management.Automation 为 1.0.0.0。有谁知道如何让 Visual Studio 使用较新的 dll？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-14T22:11:17.967

我会调查一下，但你意识到绝对不能保证 CTP 中的任何内容都会保持现在的状态？很可能会，但我现在不会反对它。

编辑：事实上，这是来自 CTP 下载页面的引用：

> **本软件为预发布版本。它不会像软件的最终版本那样工作。功能将在最终发布之前更改。**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-14T13:28:51.797

我不确定您是否可以，要使用 powershell V1.0，您需要下载“Windows SDK for Windows Server 2008 and .NET Framework 3.5”以获取您引用的 dll 文件。您现在需要找到一个包含 CPT 文件 dll 的 SDK（也许 CPT 包含 dll，我认为它在 V1.0 版本中称为 System.Management.Automation.dll）。

祝你好运

# wpf - 在另一个 Storyboards 时间轴中启动 Storyboard

> ID：202914
> 
> 赞同：4
> 
> 时间：2008-10-14T21:25:05.907
> 
> 标签：wpf, animation, storyboard

我有一个故事板（1），可以在 2 秒内完成一些基本动画。我希望故事板（1）完成我设置的所有属性动画（这一切都很好）。但是在故事板（1）进入 3 秒后，我想在完全没有用户交互的情况下开始故事板（2）并退出故事板（1）。

我所看到的唯一允许我这样做的是用户点击某物时。我希望这是根据当前故事板（1）时间线的位置自动进行的。

我希望这有足够的意义。如果您需要我更详细地解释某些事情，请告诉我。

谢谢。

编辑：请用 XAML 或 VB.net 语言发布答案。:)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-15T15:15:40.613

通常，为了在时间轴期间控制动画，您将使用“关键帧”。关键帧动画允许您为在特定时间设置动画的属性定义特定值。在 WPF 中，每个动画都有一个对应的关键帧动画，例如“DoubleAnimation”有“DoubleAnimationUsingKeyFrames”。

我认为不可能从动画中开始新的故事板。但是，您可以通过将两个故事板放在同一时间线上并根据故事板 (1) 的持续时间以特定延迟启动故事板 (2) 来获得相同的结果。就像是：

```
<StackPanel>
    <Rectangle Name="recProgressBar"
               Fill="Orange"
               Width="1"
               Height="25"
               Margin="20"
               HorizontalAlignment="Left" />
    <Button Content="Start Animation"
            Width="150"
            Height="25">
        <Button.Triggers>
            <EventTrigger RoutedEvent="Button.Click">
                <BeginStoryboard>
                    <Storyboard>
                        <DoubleAnimation Storyboard.TargetName="recProgressBar"
                                         Storyboard.TargetProperty="Width"
                                         From="0"
                                         To="250"
                                         Duration="0:0:2" />
                        <Storyboard BeginTime="0:0:3">
                            <ColorAnimation Storyboard.TargetName="recProgressBar"
                                            Storyboard.TargetProperty="Fill.Color"
                                            To="DarkGreen"
                                            Duration="0:0:1" />
                        </Storyboard>
                    </Storyboard>
                </BeginStoryboard>
            </EventTrigger>
        </Button.Triggers>
    </Button>
</StackPanel> 
```

这里颜色动画将在宽度动画完成后 1 秒开始。这可能值得一试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-15T15:31:49.643

感谢 Megakemp，这就是我害怕做的事情。我不想在 XAML 中管理故事板的两个副本。如果我必须添加一个控件并通过情节提要（1）管理它，我将不得不记住将更改复制并粘贴到另一个情节提要（2）。我想这些是你必须跳过的箍，直到我正在寻找的功能出现。

现在我确实想到了另一个尝试但无法获得功能的想法。这是我下面的想法，我可以用代码更好地解释它。下面的代码不会编译，它只是为了表达我的意思。

```
Dim board As Storyboard = New Storyboard
board = DirectCast(TryFindResource("Animation1"), Storyboard)
If board IsNot Nothing Then
    board.Begin(Me)
    While board.GetCurrentState(Me) = ClockState.Active
        'Wait until Animation1 ends
    End While
    'Start Animation2
    board = DirectCast(TryFindResource("Animation2"), Storyboard)
    If board IsNot Nothing Then
        board.Begin(Me)
    End If
End If 
```

感谢您的帮助.. 如果其他人有其他答案或更多见解，请不要犹豫发布，我还没有完全放弃这个想法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-15T20:52:42.337

好吧，我想出了一个解决方案。我只是产生了一个新线程等待 3 秒，然后调用调用从该线程运行情节提要。

```
 Dim board As Storyboard = New Storyboard
    board = DirectCast(TryFindResource("DoSplit"), Storyboard)
    If board IsNot Nothing Then
        board.Begin(Me, True)

        Dim t As Thread
        t = New Thread(AddressOf Me.WaitToHidePanel)
        t.SetApartmentState(ApartmentState.STA)
        t.Start()

    End If 
```

做你的线程安全的委托和函数，你就会让它工作。在我看来，这是一个丑陋的黑客，但它现在有效。

# flash - 是否可以使用 Actionscript 仅读取文件的第一行？

> ID：202922
> 
> 赞同：1
> 
> 时间：2008-10-14T21:27:24.593
> 
> 标签：flash, actionscript, file-io, upload, csv

我有一个基于 PHP 的站点，我们允许用户上传一个逗号分隔的数据文本文件，以便由某些服务器端脚本导入。但是，有时我们需要调整上传数据的列顺序，如果我们能够在上传*之前*识别 CSV 文件中的列，将会非常有帮助。

我能想到的访问本地文件 I/O 的唯一方法是使用 Java 插件或嵌入式 Flash 脚本，我更喜欢后者。Flash 中是否有任何方法可以选择本地硬盘驱动器上的文本文件，然后使用 ActionScript**仅**检查第一行（在此示例中对应于列标题）？

有时这些文件可能大于 100 MB，因此将整个文件加载到内存中，然后将除第一行之外的所有文件都扔掉可能无法有效地工作，所以我想知道 ActionScript 中是否有语法来限制读取的数据量一次。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-14T21:48:37.857

Flash 电影无法访问本地文件系统，除非将文件上传到服务器。

我认为你的选择是：

1.  使用小程序在客户端使用 Java（简单）处理类。但是，正如您正确断言的那样，用户将需要授予对小程序的权限。
2.  [使用文件系统 API](http://labs.adobe.com/wiki/index.php/AIR:Articles:Adobe_AIR_Local_File_System_Access)提供一个用 Adob​​e Air 编写的小型客户端应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-15T06:22:39.253

当前版本的 Flash 播放器只能选择文件上传到服务器，要求所有处理都在服务器端。然而，下一个版本的播放器[Flash 10](http://labs.adobe.com/technologies/flashplayer10/)可以读取本地文件，而无需往返服务器。

我自己（还）没有使用过这个功能，所以我不确定是否可以只读取文件的一部分，但如果它都是本地的，这确实不是问题。

Flash 10 目前处于某种预发布测试版中，但我认为它很快就会推出。

编辑：确实很快，刚刚[在我的提要阅读器中看到了这个](http://www.mikechambers.com/blog/2008/10/14/flash-player-10-release-is-out/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-17T15:14:44.700

Flash Player 10，当前发布的版本（2 天前刚刚发布），允许您访问本地文件。你可以在这里找到一个例子：

[http://www.mikechambers.com/blog/2008/08/20/reading-and-writing-local-files-in-flash-player-10/](http://www.mikechambers.com/blog/2008/08/20/reading-and-writing-local-files-in-flash-player-10/)

但是，您必须加载整个文件。

如果您使用在 Adob​​e AIR 中运行的 SWF，那么您可以只阅读第一行（它具有更高级的文件 API）。

最好的解决方案可能是创建一个只返回第一行数据的 PHP API。

迈克室

网格@adobe.com

# sql-server - 数据库的单元测试框架

> ID：202940
> 
> 赞同：8
> 
> 时间：2008-10-14T21:37:19.113
> 
> 标签：sql-server, database, unit-testing

我正在寻找用于数据库开发的单元测试框架。我目前正在为 SQL Server 2000、2005 和 2008 进行开发。您知道任何具有类似 JUnit 和 NUnit 功能的优秀框架吗？
也许最好问一下，你用什么来单元测试你的存储过程和用户​​定义的函数？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-14T21:38:37.173

有 TSQLUnit... 链接在这里：[http ://tsqlunit.sourceforge.net/](http://tsqlunit.sourceforge.net/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-14T21:47:24.503

我倾向于使用数据访问程序集并使用 [http://weblogs.asp.net/rosherove/articles/dbunittesting.aspx](http://weblogs.asp.net/rosherove/articles/dbunittesting.aspx)中概述的想法使用 NUnit 进行测试， 它使用事务来回滚更改。这不是一种专用的数据库方法，但如果您想在比纯数据库更高的级别上进行测试，这是很好的选择。

可能值得一看[http://weblogs.asp.net/rosherove/archive/2004/07/12/180189.aspx](http://weblogs.asp.net/rosherove/archive/2004/07/12/180189.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-14T21:50:17.197

我目前在我的项目中使用 DBUnit。这是一个很好的工具来测试数据库以查看您期望的结果是否存在，而且它还可以将数据库中的数据更改为预定义的值，例如，它将数据库重置为您在测试之前使用的数据，保持表格不变。

[http://dbunit.sourceforge.net/](http://dbunit.sourceforge.net/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-09-22T16:10:42.470

我也遇到过 TST T-SQL 测试工具 [http://tst.codeplex.com/](http://tst.codeplex.com/)

# sql-server - MS Access 查询设计在连接到 SQL Server 时挂起

> ID：202944
> 
> 赞同：2
> 
> 时间：2008-10-14T21:38:05.350
> 
> 标签：sql-server, ms-access, odbc

Microsoft Access 是一种访问 MS SQL Server 后端数据库中数据的巧妙方法，但我在访问（可以这么说）大型数据表时总是遇到问题，尤其是在 Access 中尝试在结果和设计模式之间切换时。

Access 为我提供了许多漂亮的东西，其中最重要的是 Crosstabs，但这种与服务器的挂起连接让我有点抓狂！

是否有任何 MS Access 专家知道如何优化 ODBC 连接，因此当我只想调整和构建查询时，它不会执行看起来像是全表扫描的操作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-15T06:57:43.927

ODBC 驱动程序会将尽可能多的工作传递给 SQL Server，但是一旦您使用像 Nz 这样的 vba 函数或像 PIVOT 这样的非 SQL Server 语法，那么 ODBC 驱动程序必须拉回更多数据和索引才能完成工作客户端。

根据其他答案，要么在 SQL Server 中构建视图并链接到视图，要么使用 Access Data Project。

注意：在 SQL Server 中无法处理具有未知列数的 PIVOT 查询，其方式与 Access 将在本机执行此操作的方式相同 - 因此，如果您在 Access 中针对 SQL Server 数据运行数据透视，您可能会将整个表拉回。必须使用动态 SQL 技术在 SQL Server 中构建透视查询，或者使用硬编码所有列的预保存视图。查看此链接以了解执行此操作的一种方法：

[http://www.sqlservercentral.com/articles/Advanced+Querying/pivottableformicrosoftsqlserver/2434/](http://www.sqlservercentral.com/articles/Advanced+Querying/pivottableformicrosoftsqlserver/2434/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-15T07:27:08.017

正如其他人所说，提高大型表性能的唯一方法是让 SQL Server 数据库引擎为您完成工作。一种尚未提及的方法是使用传递查询，这将使您能够将所有代码保留在 MS Access 中，而无需在 SQL Server 上创建对象：

[http://support.microsoft.com/kb/303968](http://support.microsoft.com/kb/303968)

您将不得不编写 SQL Server T-SQL 而不是 Access 方言；但是，SQL 2005（在兼容模式 90 下运行时）确实支持 PIVOT 命令。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-08-18T12:23:21.263

我的类似问题是选择 Link table/ODBC 连接后 ORACLE ODBC 连接挂起。任务管理器说十分钟后没有响应。然后连接对所有可用表 ping ORACLE。我在 ORACLE ODBC 管理器上打开了日志记录，因此它必须将所有这些内容写入日志，这可能会使任何结果减慢几个小时。一小时后日志为 60 MB，当我将其关闭时，一切都很好！

要关闭它，请转到 Oracle 安装/网络管理/MS ODBC 管理员/跟踪选项卡并将其关闭！

关于 ODBC 的一个很好的资源在这里：[http ://eis.bris.ac.uk/~ccmjs/odbc_section.html](http://eis.bris.ac.uk/~ccmjs/odbc_section.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-15T00:47:43.377

不幸的是，Access 无法将大量工作推送到服务器，是的，当针对 SQL Server 中的多个表或视图设计查询时，它会进行大量的表扫描。

您可以使用 SSMS 在 SQL Server 中构建和调整查询（视图），并将视图存储在 SQL Server 中以大幅提升性能，同时仍将 Access 用于您的前端。

# .net - 缺少 ComponentOne licenses.licx 文件

> ID：202946
> 
> 赞同：8
> 
> 时间：2008-10-14T21:38:13.913
> 
> 标签：.net, componentone

我正在开发一个广泛使用 ComponentOne 的 C1FlexGrid 的应用程序。在我们使用的几十个中，三个丢失了他们的 licenses.licx 文件，并导致在我启动应用程序时弹出演示启动屏幕。

有什么方法可以确定哪些形式导致了这种行为。没有手动检查数百个目录，我没有办法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-11T17:05:45.830

根据 Microsoft 文档，只有可执行程序集需要 licenses.licx。带有表单的 Dll 程序集仍会创建一个，但会被忽略。这也是我的经验。我建议在设计器视图中打开每个表单并在该视图中重建。这通常会将任何缺少的许可证条目添加到 licenses.licx。但是，它不会更新现有条目。如果您更新了组件，这可能是个问题。对于 ComponentOne，您通常可以编辑 licenses.licx 并删除程序集名称后的版本信息。其他一些第三方组件更加挑剔，并且在编译时触摸它们的版本信息会导致错误。

在我看来，.NET 许可框架很繁琐，对开发人员来说是不必要的负担。有更简单的方法可以确保组件许可证得到尊重。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-11-30T21:58:39.677

您不必打开每个表格。每个项目都有一个 licenses.licx 文件。只需确保在这些文件中引用了 C1FlexGrid，然后进行完全重建（Build | Rebuild All）。

那应该解决这个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-28T07:57:52.653

有时，打开表单并重建整个解决方案甚至不起作用。所以在这种情况下。只需将一些 ComponentOne 控件从工具箱拖放到您的表单（之后您可以将其删除）。此拖放将在 Properties 文件夹中自动生成 licenses.licx。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-05-07T11:36:03.183

ComponentOne 有一个实用程序，它将（重新）为现有项目生成 licenses.licx 文件。

来源文章：[https ://www.grapecity.com/blogs/licensing-and-licenses-licx-file-licxgenerator-tool](https://www.grapecity.com/blogs/licensing-and-licenses-licx-file-licxgenerator-tool)

指示：

> # LicxGenerator 工具
> 
> 幸运的是 [生成 license.licx 文件] 可以自动化，非常感谢我们的客户 Dom Sinclair 的启发。[链接如下] LicxGenerator 工具创建一个 license.licx 文件，其中包含在指定路径下找到的所有控件的许可证信息条目。如果您运行它，它会要求您浏览二进制文件夹，然后将生成的文件放在同一路径下。如果您需要更多控制，可以使用命令行选项运行它。您还可以使用其他自动化任务运行它。
> 
> ## 用法：
> 
> ```
> LicxGenerator [-r] [-p prefix] [-s] [sourcePath] [outputPath] 
> ```
> 
> 参数：
> 
> *   `-r`：用于子文件夹中的递归搜索；
>     
>     
> *   `-p`：仅搜索名称以指定前缀开头的文件；
>     
>     
> *   `-s`： 静音模式。
>     
>     
> 
> 如果两者`sourcePath`和`-s`参数都未设置，该实用程序将显示文件夹选择对话框。如果`outputPath`未设置，它将与`sourcePath`value 相同。
> 
> 为您的项目生成 licenses.licx 文件：
> 
> 1.  首先构建您的项目，以便输出文件夹包含所有二进制文件；
>     
>     
> 2.  使用项目输出文件夹的路径运行 LicxGenerator；
>     
>     
> 3.  获取生成的 license.licx 文件并将其添加到项目中。
>     
>     
> 
> 这个免费工具将为您节省大量研究许可问题的时间。
> 
> *   [下载 LicxGenerator 应用程序](https://gccontent.blob.core.windows.net/gccontent/blogs/legacy/c1/2016/05/LicxGenerator.zip)
>     
>     
> *   [下载 LicxGenerator 源代码](https://gccontent.blob.core.windows.net/gccontent/blogs/legacy/c1/2016/01/LicxGenerator_SourceCode.zip)

# windows - Vista 中的 Microsoft Async RPC 崩溃

> ID：202951
> 
> 赞同：4
> 
> 时间：2008-10-14T21:38:36.287
> 
> 标签：windows, crash, operating-system, rpc, windows-vista

我正在开发一个程序，该程序可以在客户端和服务器在同一台机器上运行的情况下进行 RPC 调用。我希望客户端对服务器的调用超时，因为我们遇到了它在服务器上等待无响应的问题。

为了解决这个问题，我们使用了异步 RPC 调用，如果超时则取消它。

这在 XP 中运行良好，但现在我在 Vista 中发现崩溃，并且我有一个测试程序可以每次都重现这些崩溃（仅在 Vista 中，不在 XP 中）。这似乎是微软方面的一个错误。来自崩溃线程的调用堆栈不包括对我们代码的任何调用。以下是故障转储中的信息：

```
Call stack:
rpcrt4!_SEH_epilog4_GS+0x3979
rpcrt4!LRPC_CCALL::AbortCall+0x68
rpcrt4!LRPC_BASE_CCALL::HandleCancelMessage+0x6b
rpcrt4!LRPC_CCALL::HandleCancelMessage+0x42
rpcrt4!LRPC_CASSOCIATION::IoCompleted+0x341
rpcrt4!ProcessLrpcComplete+0x3b
rpcrt4!LOADABLE_TRANSPORT:Stick out tonguerocessIOEvents+0x212
rpcrt4!ProcessIOEventsWrapper+0xd
rpcrt4!BaseCachedThreadRoutine+0x5c
rpcrt4!ThreadStartRoutine+0x1e
kernel32!BaseThreadInitThunk+0xe
ntdll!__RtlUserThreadStart+0x23
ntdll!_RtlUserThreadStart+0x1b

Problem:
(ee4.139c): Access violation - code c0000005 (first/second chance not
available)
eax=01e0fcc4 ebx=002f8930 ecx=002f87e4 edx=002f87fc esi=002f87b0 edi=00000000
eip=76f08d9e esp=0200fe2c ebp=0200fe34 iopl=0 nv up ei pl nz na pe nc
cs=001b ss=0023 ds=0023 es=0023 fs=003b gs=0000 efl=00010206
rpcrt4!_SEH_epilog4_GS+0x3979:
76f08d9e a300000000 mov dword ptr ds:[00000000h],eax
ds:0023:00000000=???????? 
```

我想知道是否有人遇到过类似的问题并找到了解决方法？也许在这种情况下使用 RPC 以外的东西会更好？

# sql-server - 如何在 Windows 中使用 Perl 的 DBI 模块连接到 MSSQL 数据库？

> ID：202962
> 
> 赞同：11
> 
> 时间：2008-10-14T21:41:14.377
> 
> 标签：sql-server, windows, perl

如何在 Windows 中使用 Perl 的 DBI 模块连接到 MSSQL 数据库？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-14T22:27:19.837

使用 DBD::ODBC。如果您只是使用控制面板 -> 系统管理 -> ODBC 数据源 -> 系统数据源或用户数据源创建数据源（这些是我记得的名称，但我的 XP 不是英文的，所以我无法检查），那么您所要做的就是在 DBI 连接字符串中使用该数据源的名称。

```
my $dbh = DBI->connect("dbi:ODBC:$dsn", $user, $pwd, \%attr); 
```

User 和 System 数据源之间的区别在于后者可供任何用户使用。

另请参阅：[如何：在 Windows XP 中创建系统数据源名称](http://support.microsoft.com/kb/305599)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-14T21:45:46.380

在任何地方都找不到可靠的。使用类似的 Perl 代码

```
use DBI;
my $dbs = "dbi:ODBC:DRIVER={SQL Server};SERVER={ServerName}";
my ($username, $password) = ('username', 'password');

my $dbh = DBI->connect($dbs, $username, $password);

if (defined($dbh))
{
    #write code here
    $dbh->disconnect;
}
else
{
    print "Error connecting to database: Error $DBI::err - $DBI::errstr\n";
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-14T23:34:42.073

检查[Perlmonks](http://www.perlmonks.org/index.pl?node_id=669089 "佩尔蒙克斯")，我看到了实际使用 Sybase DBI 驱动程序连接到 MS SQL 的建议。这是有道理的，因为 MS SQL 起源于 Sybase 代码。当然，ODBC 也有效。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-06-08T22:56:30.510

使用具有集成安全性的 OLEDB（Windows 身份验证）：

`DBI:ADO:Provider=SQLOLEDB.1;Integrated Security=SSPI;Data Source=localhost;Initial Catalog=$dbName;`

# windows-xp - 在 Windows XP 上计算桌面图标间距的公式或 API

> ID：202971
> 
> 赞同：1
> 
> 时间：2008-10-14T21:43:21.207
> 
> 标签：windows-xp, desktop-wallpaper

我已经构建了一个简单的应用程序，它将网格线应用于图像或只是简单的颜色用作桌面壁纸。这个想法是桌面图标可以排列在网格内。问题是，取决于比我理解的更多的事情，像素的实际间距似乎因系统而异。我了解到，至少这些事情是一个因素：

*   分辨率（呵呵）
*   任务栏大小和位置
*   字体

必须有更多。也许有一些我不知道的 api 调用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-14T21:55:27.030

有 1001 种方法可以获取/设置它（但我只知道 2 种）:-D

窗口注册：

```
HKEY_CURRENT_USER\控制面板\桌面\WindowMetrics
```

值为**IconSpacing**和**IconVerticalSpacing**

通过代码：

`using System.Management;`

 `public string GetWinIconSpace()

{

```
ManagementObjectSearcher searcher = new ManagementObjectSearcher("root\\CIMV2","SELECT * FROM Win32_Desktop"); 

foreach (ManagementObject wmi in searcher.Get())
{
    try
    {

        return "Desktop Icon Spacing: " + wmi.GetPropertyValue("IconSpacing").ToString();

    }

    catch { }

}

return "Desktop Icon Spacing: Unknown"; 
```` 

`}`

我从未尝试过的第三个你可以[在这里找到](http://www.codeguru.com/vb/controls/vb_shell/article.php/c3055/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-14T21:53:26.257

如果请求的图标大小不可用，它们也可能是由于缩放算法造成的大小问题。
（因为图标文件实际上是图标的集合，正如这个关于[图标和光标知道它们来自哪里](http://blogs.msdn.com/oldnewthing/archive/2008/08/20/8880062.aspx)的线程中所解释的那样，来自[The Old New Thing](http://blogs.msdn.com/oldnewthing/default.aspx)）

# ruby-on-rails - Rails 的版本控制和部署工作流程是怎样的？

> ID：202974
> 
> 赞同：13
> 
> 时间：2008-10-14T21:46:03.417
> 
> 标签：ruby-on-rails, ruby, version-control, deployment, workflow

尤其是在考虑一个新的 Rails 项目时，您的版本控制和部署工作流程是什么样的？你用什么工具？

我对 Mac、*nix 和 Windows 工作机器的答案很感兴趣。假设一个 *nix 服务器。

如果需要，我会为清楚起见进行编辑。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-14T21:53:07.567

1.  使用预装的插件和冻结的 gem 创建我的个人 Rails 2.1.1 模板的副本。
2.  更改数据库密码、会话密码/名称和`deploy.rb`.
3.  根据需要在 GitHub 上创建私有或公共存储库。
4.  将空的 rails 项目推送到 GitHub。
5.  SSH 到服务器并配置 apache（从旧项目复制虚拟主机文件和 mongrel 配置文件）
6.  在 MySQL 服务器上创建空数据库
7.  `cap deploy:setup && cap deploy:cold`

如果到目前为止一切正常：开始开发并提交到 GitHub。`cap deploy`如所须。

**更新：**不要忘记为你所做的**一切编写测试！**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-15T02:09:28.907

在 Slicehost 上使用 Windows Vista 和全新的 Ubuntu 安装。

1.  在 NetBeans 中创建一个新的空项目。
2.  触发 deprec ( [http://www.deprec.org](http://www.deprec.org) ) 在目标切片上安装 Rails 堆栈，包括版本控制。
3.  将空项目提交到 Subversion。
4.  使用 Capistrano 测试部署。
5.  在我确认我可以访问 Rails 起始页并且可能还可以访问脚手架之后，开始实际开发。（这真的没有必要，因为我已经这样做了好几次了，软件就像它说的那样工作。）

Deprec 是非常神奇的——它需要从大约一个工作日到大约一个小时来清理启动一个 Rails 项目（包括服务器配置和所有那些爵士乐）所需的时间——这是你可以做的一个小时在安装所有内容时进行编码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-15T14:00:56.567

这家伙记录了他经历过的每一个工作流程

[http://subtlegradient.com/articles/2007/03/30/web-development-environment-and-workflow](http://subtlegradient.com/articles/2007/03/30/web-development-environment-and-workflow)

# wpf - 真的没有办法在xaml绑定中跟进数据集父关系吗？

> ID：202990
> 
> 赞同：1
> 
> 时间：2008-10-14T21:51:28.803
> 
> 标签：wpf, data-binding, xaml, dataset

假设我有一个包含这两个不朽表的数据集：Employee & Order
**Emp** -> ID, Name
**Ord** -> Something, Anotherthing, EmpID
和关系**Rel** : Ord (EmpID) -> Emp (ID)

它在标准的主/细节场景中效果很好
（显示员工、跟踪关系、显示相关订单），
但是当我不想走相反的路（显示带有 Emp.Name 的 Ord 表）时怎么办？

像这样的东西：

```
<stackpanel>   // with datacontext set from code to dataset.tables["ord"]
   <TextBox Text="{Binding Something}"/>
   <TextBox Text="{Binding Anotherthing}"/>
   <TextBox Text="{Binding ???}"/> // that's my problem, how to show related Emp.Name 
</stackpanel> 
```

有任何想法吗？我可以创建值转换器，但如果我不想使用从父模块获得的数据集实例，它就会变得棘手。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-24T08:56:43.573

如果要同步多个控件的内容，则需要通过在公共父控件上设置的**DataContext让它们共享相同的绑定源。**这是一个例子：

```
<StackPanel>
    <StackPanel.Resources>
        <ObjectDataProvider x:Key="ds" ObjectType="{x:Type mynamespace:MyDataSet}" />
    </StackPanel.Resources>

    <!-- We set the data context to the collection of rows in the table -->
    <StackPanel DataContext="{Binding Source={StaticResource ds}, Path=USERS.Rows}">
        <ListBox ItemsSource="{Binding}"
                 DisplayMemberPath="NAME"
                 IsSynchronizedWithCurrentItem="True" />
        <TextBox Text="{Binding Path=NAME}"/>
        <TextBox Text="{Binding Path=COUNTRIESRow.NAME}"/>
    </StackPanel>
</StackPanel> 
```

将**IsSynchronizedWithCurrentItem**属性设置为“True”将导致**ListBox.SelectedItem属性与绑定源的****CollectionView.CurrentItem**自动同步，即在**DataContext**中设置的行集合。这意味着 ListBox 中当前选定的行成为两个 TextBox 控件的绑定源。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-16T08:43:12.823

假设您使用的是强类型数据集，为了将 TextBox 绑定到“EmpRow.Name”属性，您可能必须将其作为“OrdDataTable”类的属性公开。

由于 Visual Studio 生成带有部分类的类型化 DataSet 代码，因此您可以通过以下方式将属性添加到“OrdDataTable”类：

```
using System.Data;

public partial class OrdDataTable : DataTable
{
    public string EmpName
    {
        get { return this.EmpRow.Name; }
    }
} 
```

然后，您将能够绑定到数据上下文中的“OrdDataTable”对象的“EmpName”属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-21T09:01:27.947

两个 TextBox 控件的 DataContext 是什么？
要使第二个绑定起作用，必须将**DataContext**设置为“USERSDataTable”的一个实例。由于这些都包含在 DataSet 中的数组中，因此您必须明确告诉您要绑定到哪个表。就像是：

```
<StackPanel>
    <StackPanel.Resources>
        <ObjectDataProvider x:Key="ds" ObjectType="{x:Type mynamespace:MyDataSet}" />
    </StackPanel.Resources>

    <!-- Notice we set the data context to the first item in the array of tables -->
    <StackPanel DataContext="{Binding Source={StaticResource ds}, Path=USERS[0]}">
        <TextBox Text="{Binding NAME}"/>
        <TextBox Text="{Binding COUNTRIESRow.NAME}"/>
    </StackPanel>
</StackPanel> 
```

# vb.net - VB.NET中的格式化输入框

> ID：202999
> 
> 赞同：2
> 
> 时间：2008-10-14T21:56:28.043
> 
> 标签：vb.net, formatted-input, maked-textbox

在 VB.NET 中是否有接受格式化输入的控件或方法？

即它接受给定格式##/##/## 或类似格式的输入？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-14T22:00:20.110

我相信你想要[MaskedTextBox](http://msdn.microsoft.com/en-us/library/system.windows.forms.maskedtextbox.aspx)控件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-14T22:00:39.237

肯定有:)

[对于 asp.net](http://www.asp.net/AJAX/AjaxControlToolkit/Samples/FilteredTextBox/FilteredTextBox.aspx)和[winforms](http://msdn.microsoft.com/en-us/library/system.windows.forms.maskedtextbox.aspx)来说是一个非常好的/不错的

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-14T22:01:47.173

像这样的东西？

[http://www.asp.net/AJAX/AjaxControlToolkit/Samples/MaskedEdit/MaskedEdit.aspx](http://www.asp.net/AJAX/AjaxControlToolkit/Samples/MaskedEdit/MaskedEdit.aspx)************