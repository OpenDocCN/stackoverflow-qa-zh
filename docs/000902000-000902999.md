# StackOverflow 问答 000902000-000902999

# ruby-on-rails - 如何仅基于 URL 从亚马逊获取产品信息？

> ID：902001
> 
> 赞同：3
> 
> 时间：2009-05-23T17:34:47.767
> 
> 标签：ruby-on-rails, ruby, amazon

我只有一个指向亚马逊产品页面的链接。如何仅使用此链接在我的 ruby​​ 程序中获取所有信息（照片、价格等）？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2011-11-17T12:35:24.130

这是亚马逊为其 oembed 披露的受支持 URL 列表，产品广告 API 只有在解析这些 URL 并获取 ASIN 后才会出现

> http://*亚马逊。*/gp/产品/*
> 
> http://*亚马逊。*/ */dp/*
> 
> http://*亚马逊。*/dp/*
> 
> http://*亚马逊。*/o/ASIN/*
> 
> http://*亚马逊。*/gp/offer-listing/*
> 
> http://*亚马逊。*/ */ASIN/*
> 
> http://*亚马逊。*/gp/产品/图像/*
> 
> http://*亚马逊。*/gp/aw/d/*
> 
> [http://www.amzn.com/](http://www.amzn.com/) *
> 
> [http://amzn.com/](http://amzn.com/) *

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-23T18:02:36.037

我发现这个库（我正在使用 Rails）amazon-ecs 我正在试验它。不过，我需要某种 ID（产品 ID？）来获取特定产品的详细信息。例如，考虑这个链接到 kindle

[http://www.amazon.com/Kindle-Amazons-Wireless-Reading-Generation/dp/B00154JDAI/ref=amb_link_84372271_1?pf_rd_m=ATVPDKIKX0DER&pf_rd_s=center-1&pf_rd_r=06JJGQP9J3BHKPE38SXP&pf_rd_t=101&pf_rd_p=478184871&pf_rd_i=507846](https://rads.stackoverflow.com/amzn/click/com/B00154JDAI)

在那个链接中，我注意到了 ASIN，它是 B00154JDAI。

看起来我可以使用这个 ID 来获取产品信息（使用 amazon-ecs）。我只需要解析 URL，获取 ASIN。

还有其他方法吗？

不，我不会进行屏幕抓取，这在任何时候都不是一个好主意。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-23T17:53:58.717

如果你想这样做，[Nokogiri](http://nokogiri.rubyforge.org/)或[hpricot](http://wiki.github.com/why/hpricot)库都允许 HTML 解析和搜索。然而，这种屏幕抓取是出了名的不可靠（因为它可能会在亚马逊决定重组其 HTML 的任何时候破坏），所以如果你打算在任何时间做这种事情，我建议利用[亚马逊](http://docs.amazonwebservices.com/AWSECommerceService/latest/DG/)而是[产品广告 API 。](http://docs.amazonwebservices.com/AWSECommerceService/latest/DG/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-23T17:39:57.290

在您的程序中：获取页面并解析 HTML。过滤掉所需的信息。Ruby 中可能有一些库（我不知道）可以解析 HTML。

[hpricot](http://wiki.github.com/why/hpricot "用于 Ruby 的快速、令人愉快的 HTML 解析器")似乎做你想做的事。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-26T11:52:47.570

您应该使用库 Ruby/AWS（谷歌，我的业力不够高，无法允许外部链接......）。它正是为此而写的。

您可能需要使用内置搜索来查找您要查找的项目。之后，API 允许访问图片、链接和所有可用信息。

# version-control - 在开发的早期阶段什么时候开始使用源代码控制？

> ID：902006
> 
> 赞同：4
> 
> 时间：2009-05-23T17:36:32.910
> 
> 标签：version-control

我们店里有两种人：

1.  自第一次成功编译后开始签入代码的那些。
2.  其他只在项目快完成时签入代码。

我是第 1 组的一员，并试图说服第 2 组的人像我一样行事。他们的论点如下：

1.  我是这个项目的独立开发者。
2.  这只是一个原型，也许我得从头开始重写。
3.  我不想用不完整的版本污染源代码管理。

如果我是对的，请帮助我提出论据以说服他们。如果你同意他们的观点，请告诉我为什么。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-23T17:45:08.497

当有人提出[不使用版本控制的好借口时](https://stackoverflow.com/questions/132520/good-excuses-not-to-use-version-control)，他们得到了 75 个答案和 45 个赞成票。

当他们问[我的团队为什么要采用源代码控制](https://stackoverflow.com/questions/559332/why-should-my-team-adopt-source-control)时，他们得到了 26 个答案。

也许你会在那里找到一些有用的东西。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-23T17:59:10.427

你不需要“说服他们的论据”。话语不是游戏，你不应该把你的作品当作一个辩论平台。这就是你的配偶的目的 :) 不过，说真的，**你需要解释为什么你关心其他开发人员如何在其他人不参与的单独项目中工作。**因为他们不使用源代码控制，您错过了什么？你需要看他们早期的想法才能理解他们后来的代码吗？如果你能成功地做到这一点，你就可以说服他们。

我个人一直使用版本控制，但这只是因为我不会在没有网络的情况下走钢丝。其他人有更多的勇气，更少的时间花在基础设施上等等。请注意，在我看来，在 2009 年，硬盘很少出现故障，重写的代码通常比它替换的代码更好。

当我用一个问题来回答一个问题时，让我再问一个问题：您的代码是否需要编译/工作/not-break-the-build 才能签入？我喜欢我的分支变得好坏，然后修复、工作、调试等。同时，我喜欢其他开发人员随心所欲地使用源代码控制。树枝就是为了这个原因而发明的：让那些不能相处的人不必同居。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-23T17:47:05.390

这是我对你的观点的看法。

1) 即使是单独的开发人员也需要在 PC 出现故障时在某个地方保存他们的代码。如果他们不小心删除了没有源代码控制的文件会怎样？

2/3) 原型属于源代码控制，因此其他团队成员可以查看代码。我们将原型代码放在主线分支的单独位置。我们称之为斯派克。这是一篇关于为什么要保留 Spike 代码的好文章 - [http://odetocode.com/Blogs/scott/archive/2008/11/17/12344.aspx](http://odetocode.com/Blogs/scott/archive/2008/11/17/12344.aspx)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-23T17:41:35.493

如果我是一个项目的唯一开发人员（换句话说，存储库或其中的一部分在我的完全控制之下），那么我会在编写源代码后立即开始提交，并且我倾向于在每次增量变化，无论它是否有效或代表任何类型的里程碑。

如果我正在与其他人一起在项目的存储库中工作，那么我倾向于尝试进行提交，以使他们不会破坏主线开发、通过任何测试等。

不管它是否是原型，都应该进入源代码控制；原型代表了很多工作，从中吸取的教训很有价值。此外，原型有一个糟糕的习惯，即成为生产代码，您需要在源代码控制中使用它。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-23T17:43:06.113

在编写第一个工件的第一行之前大约 20 分钟开始使用源代码控制。在你开始写东西*之后*，从来没有一个好的开始时间。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-23T17:43:27.487

有些人只能从经验中学习。

就像硬盘故障一样。或在删除实际有效的代码后将自己编码为死胡同

现在，我*并不是*说您应该擦除他们的硬盘驱动器，然后用“如果您使用了源代码控制”来嘲弄他们……但是如果发生类似的事情，希望首先进行备份；-)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-05-23T17:44:38.140

我尝试只编写可编译的代码（其他所有内容都用 TODO/FIXME 标签注释掉）......并将所有内容添加到源代码管理中。

论点 1：即使作为单个开发人员，回滚到正在运行的版本、跟踪进度等也很不错。

论点 2：谁在乎它是否只是一个原型？您可能会在六个月左右偶然发现类似的问题，然后开始寻找其他代码......

论点 3：为什么不使用多个 repo？我喜欢将杂项内容归档到我的个人仓库中。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-23T17:52:23.773

早期和经常。正如 Pragmatic Programmers 所说，源代码管理就像一台时间机器，你永远不知道什么时候会想回去。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-05-23T18:01:53.073

对我来说，这是关于有一个一致的过程。如果您正在编写代码，它应该遵循与您的生产代码相同的源代码控制过程。这有助于在整个开发团队中建立和实施良好的开发实践。

将代码归类为原型或其他非生产类型的项目应该仅用于确定您将其放在源代码控制树中的哪个位置。

我们在我工作的地方同时使用 CVS（用于非 .NET 项目）和 TFS（用于 .NET 项目），并且 TFS 存储库有一个 Developer Sandbox 文件夹，开发人员可以在其中签入个人实验项目（原型）。

如果项目开始在生产中使用，代码会从 Developer Sandbox 文件夹中移出到主树中它自己的文件夹中。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-05-23T18:43:04.253

我会对他们说...

> > > 我是这个项目的独立开发者。

当您离开或移交时，我们将拥有 0 个开发人员。更有理由使用源代码控制。

代码属于公司而不是你，公司希望承担一些责任。签入代码不需要太多努力：

```
svn ci <files> -m " implement ajax support for grid control 
```

下次有人想要对网格控件进行一些更改或做一些相关的事情时，他们将有一个很好的起点。所有项目都是从一两个人开始的。源代码控制现在比以往任何时候都容易——他们是否安排了一个 30 分钟的 Tortoise SVN 演示？

> 这只是一个原型，也许我得从头开始重写。

他们关心存储吗？存储很便宜。他们是否担心浪费在版本控制上的时间？与粗略的电子邮件检查相比，它花费的时间更少。如果它们正在重写位，那么源代码控制对于能够引用旧位就更加重要。

> 我不想用不完整的版本污染源代码管理。

这实际上是一个很好的问题。我曾经想过同样的事情，并且避免签入代码，直到它干净整洁，这本身并不是一件坏事，但很多时候我只是想胡闹。此时学习分支会有所帮助。虽然我希望 SVN 完全支持像 Perforce 这样的清除文件夹。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-05-23T19:04:47.457

让我们看看他们的论点：

> 1.  我是这个项目的独立开发者。
> 2.  这只是一个原型，也许我得从头开始重写。
> 3.  我不想用不完整的版本污染源代码管理。

第一个，第三个。我可以看到推理，但它是基于一个错误的假设。
在工作中，我们使用 Perforce，一个集中式 VCS，实际上，我们只在同行评审后检查成功编译并且不会破坏任何东西（理论上，当然！）的源代码。

所以当我开始一个不平凡的改变时，我觉得需要中间提交。例如，最近我开始对使用 JDom（XML 解析）的 Java 代码进行一些更改（不知何故，单独执行此特定任务，因此我针对第 1 点）。然后我被卡住了，想使用 Java 1.6 内置的 XML 解析。显然是时候跟踪当前的工作了，以防我的尝试失败并想回去。请注意，这种情况以某种方式解决了第 2 点。

我选择的解决方案很简单：我使用替代 SCM！尽管像 SVN 这样的集中式 VCS 可以在本地（在开发人员的计算机上）使用，但我被分布式 VCS 所吸引，在简要测试了 Mercurial（这很好）之后，我发现 Bazaar 更适合我的需求和品味。
DVCS 非常适合这项任务，因为它们轻量级、灵活、允许替代分支、不会“污染”源目录（所有数据都在项目根目录的一个目录中）等。
通过进行并行源管理，您不会污染其他开发人员的资源，同时保留返回或快速尝试替代解决方案的可能性。

最后，通过将最终版本提交给官方 SCM，结果是相同的，但在开发人员级别增加了安全性。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-05-23T19:55:17.433

我想补充两点。使用版本控制，您可以：

*   恢复到上一个​​工作的版本，或者至少检查一下它的样子。为此，您需要支持变更集/使用整个树提交的 SCM。
*   使用它来查找错误，通过使用所谓的“*差异调试*”来查找历史中引入错误的提交。您会想要以自动化或半自动化方式支持它的 SCM。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-05-23T20:07:17.067

就个人而言，我经常在第一次成功编译后启动版本控制。

我只是想知道为什么没有人在这种情况下提到分布式版本控制系统：如果您可以设法切换到分布式系统（git、bazaar、mercury），那么您第二组的大多数论点将变得毫无意义，因为他们可以在本地启动他们的存储库并在需要时将其推送到服务器（如果他们想从头开始重新启动，他们也可以将其删除）。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-05-23T17:42:26.770

我想说你应该在第一次构建*之前就开始添加源代码并签入。*这样就更容易避免签入生成的工件。我总是使用一些源代码控制，即使是对于我的小爱好，只是因为它会自动从噪音中过滤掉相关内容。

因此，当我开始进行原型设计时，我可能会创建一个项目，然后在构建它之前我会执行“git init, git add ., git commit -a -m ...”，这样当我想移动有趣的部分时，我就克隆过来使用 git，然后我可以将它添加到 subversion 存储库或我目前工作的任何地方。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-05-23T23:17:58.680

它被称为分支人们尝试使用该程序：p 原型设计？在一个分支工作。实验？在一个分支工作。新功能？在一个分支工作。

在有意义的时候将你的分支合并到主干中。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-05-23T23:40:07.263

如果代码可能永远不会被使用，我猜人们在最初设置源代码控制时往往会很放松。我有属于这两个组的项目，源代码控制之外的项目也同样重要。这是每天都被推迟的事情之一，而实际上它不应该被推迟。

另一方面，一旦我搞砸了一些 CSS 代码并且不知道我改变了什么，例如使网站的页脚最终位于页眉后面，我有时会很少提交复杂的还原。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-05-23T23:59:45.350

在开始编码之前，我在源代码管理中签入项目。我要做的第一件事是创建和组织项目和支持文件（例如 .NET 开发中的 .sln 文件）以及必要的支持库和工具（通常在 lib 文件夹中），我知道我将在我的项目中使用。如果我已经编写了一些代码，那么我也会添加它，即使它是一个不完整的应用程序。然后我检查一切。从那里开始，一切都照常进行，编写一些代码，编译，测试，签入...

您可能不需要从这一点分支或恢复您的更改，但我认为从一开始就将所有内容置于源代码控制之下是一个好习惯，即使您没有任何要编译的东西。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-05-23T17:44:59.933

在开始为项目编写代码之前，我在源代码管理中创建了一个目录。我在创建项目骨架后进行第一次提交。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-05-24T00:01:22.477

我喝醉了，我先 git -init 然后 vim foo.cpp。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-05-24T09:00:44.100

任何体面的现代源代码控制平台（VSS 不是其中之一）不应以任何方式因将源代码文件放入其中而受到污染。我认为任何预期寿命超过每小时 1/2 的东西都应该尽早进行源代码控制。单独开发不再是不使用源代码控制的有效借口。这与安全无关，它与错误和长期历史有关。

# vb6 - 从网页到应用程序中的文本框的数据？

> ID：902017
> 
> 赞同：0
> 
> 时间：2009-05-23T17:42:10.220
> 
> 标签：vb6

我看到一个程序（RAPGET）从 RapidShare 下载给定链接的文件？

我喜欢设计一个这样的程序，它从网页获取有关天气预报的信息，它应该显示在 vb6 的文本框中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-23T17:56:35.220

您可以从 VB6 调用 Web 服务。这是“[最简单的方法](http://msdn.microsoft.com/en-us/library/aa730836(VS.80).aspx)”。

[或者您可以查看对上一个 SO 问题](https://stackoverflow.com/questions/122607/what-is-the-best-way-to-consume-a-web-service-from-vb6/122645)的回复。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T17:53:07.003

您可以使用 winxp 及更高版本附带的 winHttp 组件。它作为一个名为 BITS [后台智能传输服务] 的软件包提供。使用它，您可以调用 Http 和 Ftp 服务器。因此，这将使您的 VB6 应用程序充当 HttpClient，它将从天气服务器接收数据。

第二件事是服务器。您必须知道从服务器获取数据的格式。是纯文本吗？肥皂？还是 XML？一旦您确定了数据传输的格式，您就可以使用 winHttp 从服务器接收数据并在您的应用程序中解析它们并获取所需的数据。

谢谢。

# php - 将值从 jQuery 传递到 PHP

> ID：902019
> 
> 赞同：1
> 
> 时间：2009-05-23T17:42:42.667
> 
> 标签：php, jquery

情况如下：

我正在使用 jquery.validate.js 来验证我的表单，但我需要添加一个服务器端验证层。jQuery Validate 使用表单元素中的类名来确定它应该做什么——我想将这些类名提取到 PHP 中，以便我可以在服务器端执行相同的验证。

我希望做这样的事情：

```
foreach($_POST as $key=>$value) {
     $class=array(...// get this #key element class name list with jQuery
     $error=...// based on the class names, perform specific PHP validations
     if($error=="")
         return true;
     else
         return false;
} 
```

问题是，我可以这样做吗？我可以使用 jQuery 获取元素类名称并将它们传递给 PHP 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-23T18:54:31.877

您可以让 jQuery 将类名与表单一起发送 - 但是这会导致严重的安全问题。看到发布到您服务器的所有内容实际上都是由您的用户浏览器完成的，您的用户将有能力更改您的验证规则并因此绕过它们，这将使您在这里的整个目的毫无用处。相反，我会建议以下内容。

在 php 中创建一个函数以获取表单元素的名称并返回适当的类名。在为表单生成每个表单元素时，调用此函数以获取类名（然后应用 jQuery 验证）。当您在 PHP 代码中读取表单时 - 使用相同的函数来获取类名，然后您就知道在服务器端 php 代码中应用哪些验证规则。

希望这是有道理的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-24T03:41:44.933

永远不要相信客户端（浏览器）！

您绝不应该允许客户端上的任何内容指示服务器如何测试发布信息的有效性。

这是一个非常糟糕的主意。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-23T20:48:03.613

客户端：

```
function validate()
{
    var params = {
       var1: {key:$('#field1').get(0).className, value:$('#field1').get(0).value},
       var2: {key:$('#field2').get(0).className, value:$('#field2').get(0).value},    
       ...
    }
    $.post('http://host/validate_script.php', params, onValidate);
}
function onValidate(data)
{
    alert(data);
} 
```

希望这会有所帮助...确保这是一种简单的方法，并且您可以更正式地进行操作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-23T18:49:51.433

[serializeArray](http://docs.jquery.com/Ajax/serializeArray)会将您的表单数据转换为 JSON：

```
var json = $('#formid').serializeArray(); 
```

通常，您可以将整个 JSON 字符串发送到可以从那里获取它的服务器。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-24T12:26:30.783

如上所述，您可以使用 AJAX 和 JSON 将值传递给 PHP。但是，这不会提供比常规 JS 验证更安全的验证（因为您的 PHP 仍将依赖于您的 JS）

如果您选择使用此方法，这里是对 Evgeniy Savichev 之前提供的脚本的一些改进

```
<script type="text/javascript">
params = {
    elementName : {
        className : $('elementId').attr('class'),
        elementValue : $('elemenetId').val()
    },
    anotherElement : {
        //etc
    }

}

$.post('http://host/validate_script.php', params, onValidate);

function onValidate(data)
{
    alert(data);
}
</script> 
```

然而，更好的解决方案是自动生成和验证您的表单元素。Zend 框架有一个很棒的类可以做到这一点。如果您决定编写自己的脚本，我已经包含了一个简化的版本。

我希望这可以对你有所帮助

*   维姆

    ```
    $elements = array(
        'email-field' => array('email', 'required'),
        'integer'  => array('integer')
    );

    if ( $_SERVER['REQUEST_METHOD'] == 'POST' ) {
        $error = false;
        foreach($elements as $elementName => $validators) {
            if (array_key_exists($elementName, $_POST)) {
                foreach ($elements[$elementName] as $validator ) {
                    switch($validator) {
                        case 'email':
                            if (filter_input(FILTER_VALIDATE_EMAIL, $elementValue)) {
                                $error = true;
                            }
                            break;
                        case 'integer':
                            // etc
                            break;
                        default :
                            break;
                    }
                }
            } else {
                if ( in_array('required', $validators) ) {
                    $error = true;
                }
            }
        }
        if ( $error ) {
            // etc
        }
    }
    ?> 
    ```

# git - 当主存储库和一些开发人员机器之间存在延迟时，GIT 会加速操作吗？

> ID：902022
> 
> 赞同：0
> 
> 时间：2009-05-23T17:43:17.627
> 
> 标签：git, version-control

我们的商店在地理上分布，并且我们当前的源代码控制是集中的，这减慢了远离它的开发人员的源代码控制操作（签入/签出）。如果我们迁移到 GIT，它会使这些操作中的任何一个更快吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-23T17:55:08.823

自己回答这个问题。

将您的代码放入 git（首先复制您的代码库）：

```
git init
git add *
git commit -m "Initial import" 
```

在你的网络上克隆它，提交，然后 git-push 回来。

```
git clone ssh://machine/path/to/repo.git
// Make some changes
git commit -a -m "Makin some changes"
git push origin 
```

**您实际上不必迁移您的存储库或您的工作来执行此测试。** 如果性能令人满意，则进行迁移或进行更多测试以确认。如果没有，则扔掉回购并继续前进。

将 git 设计为非本地化的直接优势是您的存储库状态被散列到 SHA1 散列中。这使得通过网络区分您的提交层次结构更加有效（它只发送最新的提交对象，而不必比较整个存储库以了解需要发送的内容：所有内容都包含在提交层次结构中）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-23T17:51:33.013

这取决于*它*在未来需要达到的中心化程度。例如，使用 Git，作为个人开发人员，您可以创建一个分支，做大量工作，为您所做/更改的每项新事物继续进行（即时）提交，并且在您执行`git push`! 当然，您所做的任何`git pull`事情仍然会像您`svn update`的一样多。

但是，如果您的工作流程如此集中，以至于您几乎期望集中提交（即推送），那么您仍然需要通过网络进行处理。除非你的连接*真的很*糟糕，否则协议和每个系统发送的内容的差异可能并不重要，即使 Git 有一点优势。

但是，一个潜在的优势可能是，如果您在多个站点有多个开发人员。然后，您可以在每个站点设置单独的 git 存储库，所有提交/签出仅通过本地网络（来自开发人员 POV），然后在商店之间同步存储库或与“中央”存储库每天同步一次或其他。

也许我误解了这个问题，但希望这至少有一点帮助.. :)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-23T17:48:08.477

Git 的网络效率很高。它应该比您当前的 SCM 解决方案更快。

# java - EnumSet 'and' operation

> ID：902025
> 
> 赞同：3
> 
> 时间：2009-05-23T17:44:34.817
> 
> 标签：java, enums

I'm porting some old code that uses the [int enum pattern](http://java.sun.com/j2se/1.5.0/docs/guide/language/enums.html) to Enum and EnumSet. It is very easy but I don't know how translate the following code to EnumSet: :

```
int mask = (kind == 'C' ? CLASS_MODIFIERS
            : kind == 'F' ? FIELD_MODIFIERS
            : kind == 'M' ? METHOD_MODIFIERS
            : (CLASS_MODIFIERS | FIELD_MODIFIERS | METHOD_MODIFIERS));
int bad_flags = flags & ~mask; // <--- this
flags &= mask; // <--- and this 
```

`~mask` is simple as typing `EnumSet.complementOf` but I don't see how do **&**.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-23T17:50:27.787

You want to use the `Set` method [retainAll](http://java.sun.com/javase/6/docs/api/java/util/Set.html#retainAll(java.util.Collection)) to get the intersection of two sets:

```
public class Test {
  public enum Kind { CLASS, FIELD, METHOD }

  public void applyMask(char kind, EnumSet<Kind> flags) {
    final EnumSet<Kind> mask;
    switch (kind) {
      case 'C': mask = EnumSet.of(Kind.CLASS);    break;
      case 'F': mask = EnumSet.of(Kind.FIELD);    break;
      case 'M': mask = EnumSet.of(Kind.METHOD);   break;
      default:  mask = EnumSet.allOf(Kind.class); break;
    }
    EnumSet<Kind> badFlags = EnumSet.copyOf(flags);
    badFlags.removeAll(mask); // See note below
    flags.retainAll(mask);
  }
} 
```

Note: I previously had the following line in place of the simpler `removeAll`. Tom Hawtin pointed out that `removeAll` is simpler and achieves the same end. Originally, I just copied the OP's original logic as closely as possible, without trying to optimize.

```
 badFlags.retainAll(EnumSet.complementOf(mask)); 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2009-05-23T17:50:53.887

`CLASS_MODIFIERS`, `FIELD_MODIFIERS`, and `METHOD_MODIFIERS` might be appropriate to leave as constants, since they are being used as [bit masks](http://en.wikipedia.org/wiki/Bitmask). The link might help to clarify the point of this code.

# windows - 从 UNC 路径检索服务器名称

> ID：902029
> 
> 赞同：1
> 
> 时间：2009-05-23T17:45:12.443
> 
> 标签：windows, winapi, networking

Windows 中是否有从 UNC 路径检索服务器名称的 api？(\\server\share)
还是我需要自己制作？
我找到了 PathStripToRoot，但它并没有解决问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-10T03:09:44.997

我不知道用于解析 UNC 路径的 Win32 API；但是您应该检查：

*   `\\computername\share`
*   `\\?\UNC\computername\share` （人们使用它来访问大于 260 个字符的长路径）
*   您还可以选择处理这种情况：`smb://computername/share`和这种情况`hostname:/directorypath/resource`

[阅读此处了解更多信息](http://en.wikipedia.org/wiki/Path_(computing)#Uniform_Naming_Convention)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-10T03:23:57.323

这是未经测试的，但也许 PathIsUNC() 和 PathFindNextComponent() 的组合可以解决问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-24T00:38:03.370

我不知道是否有特定的 API，我会自己实现简单的字符串处理（跳过“\\”或返回 null，查找下一个 \ 或字符串结尾并返回该子字符串）可能首先调用 PathIsUNC()

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-01-01T07:58:23.293

如果您将以纯文本形式接收数据，则应该能够使用简单的正则表达式对其进行解析，但不确定您使用哪种语言，但我倾向于使用 perk 进行此类快速搜索。假设您有一个包含多行的大文档，每行包含一个路径，您可以在 \\ 的即 m/\\\\([0-9][0-9][0-9]\.(repeat 3次，当然不记得IP地址要求，您可能需要确定修改第一个）然后\\）？为了使其成为可选并包含尾部斜杠，最后 (.*)\\/ig 它很粗糙，但应该可以解决问题，并且路径名应该在 $2 中以供使用！

我希望这已经足够清楚了！

# java - 如何在 Java/Swing 应用程序中实现多语言？

> ID：902031
> 
> 赞同：4
> 
> 时间：2009-05-23T17:46:57.513
> 
> 标签：java, swing, internationalization, multilingual

在 Swing 应用程序中实现多语言支持的不同方法是什么？

您是否将 ResourceBundle 与属性文件一起使用并在每一帧中实现它？它对你有好处吗？如果您使用某种 GUI 编辑器会怎样？还有其他方法吗？

在工作中，我们使用 Matisse4MyEclipse 并且每次保存屏幕时都会重新生成代码，因此在这里简单地使用 Externalize Strings 是行不通的。一种方法是将其定义为每个组件的自定义属性，这很烦人。另一种方法是在 matisse 生成代码之后再次检查多语言组件及其属性，这也很痛苦。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-24T11:13:19.527

好吧，你必须使用`ResourceBundle`s。但是，如果您要设置组件文本属性，则使用`RB.getString()`. 然后，如果 Matisse 从捆绑密钥中重新生成，则将保留并且本地化将起作用。例子：

我将使用 Matisse 页面中的这张图片：（[来源：][[myeclipseide.com](http://www.myeclipseide.com/documentation/quickstarts/m4m_overview/images/properties_view1.gif)][）] 。
[![插图](https://i.stack.imgur.com/cA94I.gif)](https://i.stack.imgur.com/cA94I.gif)

在那里你可以看到属性**文本**。有“我的新标签”的价值。取而代之的是，您可以使用`rb.getString("myNewLabel.my.message")`where `rb`is `ResourceBundle`。唯一的问题应该是过于智能的属性编辑器对你不利。我从不使用任何所见即所得的编辑器（个人喜好，我总是手工进行 UI 设计）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-23T20:02:59.760

这就是我实现国际化的方式：

*   为具有国际化文本的每个组件命名
*   在运行时，获取容器（框架、对话框、小程序），迭代所有组件并使用其名称和所有父名称为每个组件构建一个 i18n 键。
*   对于每个组件类型（JTextField、JLable 等），为每个国际化字段（文本、标签、提示等）定义一些键。
*   获取这个 i18n 键并查询您的 ResourceBundle，获取结果并填充组件字段。

它适用于生成的代码或手动创建的代码。

编辑：这里是：

```
public void buildIds() {
    buildId(true);
    int count = getComponentCount();
    if (count == 0) {
        return;
    }
    for (int i = 0; i < count; i++) {
        Component component = getComponent(i);
        if (component instanceof AbstractComponent) {
            ((AbstractComponent) component).buildIds();
        }
    }
}

protected void buildId(boolean fireChange) {
    String prevId = this.id;
    String computedId;
    if (getName() == null) {
        computedId = ClassUtilities.shortClassName(getClass()).toLowerCase() + "_" + Long.toHexString(ID_GENERATOR.getAndIncrement());
    } else {
        java.util.List<Component> parents = null;
        Component parent = getParent();
        if (parent != null) {
            StringBuilder buider = new StringBuilder(80);
            parents = new ArrayList<Component>();
            while (parent != null) {
                if (parent.getName() != null) {
                    parents.add(parent);
                }
                parent = parent.getParent();
            }
            Collections.reverse(parents);
            if (parents.size() > 0) {
                for (Component component : parents) {
                    if (buider.length() > 0) {
                        buider.append('.');
                    }
                    buider.append(component.getName());
                }
                buider.append('.');
            }
            buider.append(name);
            computedId = buider.toString().toLowerCase();
        } else {
            computedId = name;
        }
    }
    this.id = computedId;
    if (fireChange && prevId != null && !prevId.equals(computedId)) {
        componentIdChanged(this, prevId);
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-23T19:19:09.457

我不知道除了 ResourceBundle 之外的任何方法。

为什么要不断地重新生成代码？我想一旦你开始一个页面就可以了，但在那之后它基本上就没有必要了。听起来代码生成是你真正的问题。它没有为你节省任何东西。

您是否尝试使用多个组件组成页面？我可以想象一个不需要一直更改的通用页眉、页脚和菜单。这可能是一个设计问题。

Spring 对 I18N 有很好的支持。也许它可以在这里帮助你。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-02-17T05:10:53.073

使用 ResourceBundle 类并将语言设置为区域设置：

以下是java中的代码

```
private static Map<String, ResourceBundle> resourceBundles;

private static ResourceBundle loadBundle(String language) {
    if (resourceBundles == null) {
        resourceBundles = new HashMap<String, ResourceBundle>();
    }

    ResourceBundle currentBundle = resourceBundles.get(language);

    if (currentBundle == null) {

        Locale locale = new Locale(language);
        currentBundle = ResourceBundle.getBundle("i18n.Messages", locale);
        resourceBundles.put(language, currentBundle);
    }

    return currentBundle;
}

public static String messageForKey(String key, String language) {
    ResourceBundle currentBundle = loadBundle(language);
    return currentBundle.getString(key);
} 
```

# django - 如何检查 Django 模板中集合的大小？

> ID：902034
> 
> 赞同：183
> 
> 时间：2009-05-23T17:47:20.023
> 
> 标签：django, django-templates

我的 Django 模板中有一个列表。只有当列表的大小大于零时，我才想做一些事情。

我试过了`myList|length`，`myList|length_is`但他们没有成功。

我已经搜索了所有内容，但没有看到任何示例。我怎样才能检查这个？

* * *

## 回答 #1

> 赞同：338
> 
> 时间：2009-05-23T17:53:24.943

请参阅[https://docs.djangoproject.com/en/stable/ref/templates/builtins/#if](https://docs.djangoproject.com/en/stable/ref/templates/builtins/#if)：只需使用，重现他们的例子：

```
{% if athlete_list %}
    Number of athletes: {{ athlete_list|length }}
{% else %}
    No athletes.
{% endif %} 
```

* * *

## 回答 #2

> 赞同：112
> 
> 时间：2009-05-24T00:35:48.320

如果您使用的是最近的 Django，[changelist 9530](http://code.djangoproject.com/changeset/9530)引入了一个 {% empty %} 块，允许您编写

```
{% for athlete in athlete_list %}
  ...
{% empty %}
  No athletes
{% endfor %} 
```

当您想要做的事情涉及对可能为空的列表进行特殊处理时很有用。

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2009-05-23T17:52:10.670

如果列表`False`没有元素，则认为它是一个列表，因此您可以执行以下操作：

```
{% if mylist %}
    <p>I have a list!</p>
{% else %}
    <p>I don't have a list!</p>
{% endif %} 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2011-04-15T07:31:19.657

如果您尝试了 myList|length 和 myList|length_is 并且没有得到想要的结果，那么您应该使用`myList.count`

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2018-04-02T06:28:12.243

您可以尝试：

```
{% if theList.object_list.count > 0 %}
    blah, blah...
{% else %}
    blah, blah....
{% endif %} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-03-17T18:01:33.603

这有效：

```
{% if myList|length %}
    Do something!
{% endif %} 
```

为什么这里有这么多答案以及为什么有这么多困惑是这并不总是有效。我认为在某一时刻模板过滤器不能用于`if`语句的参数，这是后来添加的。现在也可以执行诸如`{% if myList|length >= 3 %}`. 过滤器应该等效于`len(myList)`任何可以处理的对象也可以处理`|length`过滤器。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-03-11T00:45:36.233

Collection.count 无括号

```
{% if request.user.is_authenticated %}
{{wishlists.count}}
{% else %}0{% endif %} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-07-31T04:46:28.367

我需要集合长度来决定是否应该渲染表格`<thead></thead>`

但不知道为什么*@Django 2.1.7*`forloop`选择的答案会在我之后失败（空） 。

我得用来`{% if forloop.first %} {% endif %}`克服：

```
<table>
    {% for record in service_list %}
        {% if forloop.first %}
            <thead>
            <tr>
                <th>日期</th>
            </tr>
            </thead>
        {% endif %}
        <tbody>
        <tr>
            <td>{{ record.date }}</td>
        </tr>
    {% endfor %}
    </tbody>
</table> 
```

# python - 为什么我无法查看我的 Google App Engine cron 管理页面？

> ID：902039
> 
> 赞同：1
> 
> 时间：2009-05-23T17:50:14.107
> 
> 标签：python, google-app-engine, cron, stack-trace

当我去[http://localhost:8080/_ah/admin/cron](http://localhost:8080/_ah/admin/cron)时，如谷歌文档中所述，我得到以下信息：

```
Traceback (most recent call last):
File "C:\Program Files\Google\google_appengine\google\appengine\ext\webapp\__init__.py", line 501, in __call__
handler.get(*groups)
File "C:\Program Files\Google\google_appengine\google\appengine\ext\admin\__init__.py", line 239, in get
schedule = groctimespecification.GrocTimeSpecification(entry.schedule)
File "C:\Program Files\Google\google_appengine\google\appengine\cron\groctimespecification.py", line 71, in GrocTimeSpecification
parser.period_string)
File "C:\Program Files\Google\google_appengine\google\appengine\cron\groctimespecification.py", line 122, in __init__
super(IntervalTimeSpecification, self).__init__(self)
TypeError: object.__init__() takes no parameters 
```

我有最新的 SDK，看起来我的配置文件是正确的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-24T08:30:19.980

这绝对是 Google App Engine 中的一个错误。如果您检查[groctimespecification.py](http://code.google.com/p/googleappengine/source/browse/trunk/python/google/appengine/cron/groctimespecification.py?r=54#112)，您会看到`IntervalTimeSpecification`继承自`TimeSpecification`，而后者又直接继承自`object`并且不会覆盖其`__init__`方法。

所以`__init__`of`IntervalTimeSpecification`是不正确的：

```
class IntervalTimeSpecification(TimeSpecification):
  def __init__(self, interval, period):
    super(IntervalTimeSpecification, self).__init__(self) 
```

我的猜测是，有人转换了旧式父类初始化调用：

```
TimeSpecification.__init__(self) 
```

到当前的，但忘记了`super`,`self`是隐式传递的。正确的行应如下所示：

```
super(IntervalTimeSpecification, self).__init__() 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-23T18:54:58.570

恭喜！你发现了一个错误。你能在[公共问题跟踪器](http://code.google.com/p/googleappengine/issues/list)上提交一个错误吗？如果您想立即为自己修复它，请删除该堆栈跟踪末尾引用的行中的“self”参数。

# d - libdnet 中的 eth_addr_t 和朋友是什么

> ID：902047
> 
> 赞同：1
> 
> 时间：2009-05-23T17:52:11.637
> 
> 标签：d

我正在尝试为 D 编程语言创建一个围绕[libdnet的包装器。](http://libdnet.sourceforge.net/)我遇到的问题是在转换[addr.h](http://www.google.com/codesearch/p?hl=en#uBwkDcB0O2A/honeyd-src-1.1.1/libdnet-1.10/include/dnet/addr.h)时不知道 eth_addr_t、ip_addr_t 和 ip6_addr_t 的下划线类型是什么。最后一个神秘类型是 sockaddr

而且我也对为什么会有一个总是错误的 do while 循环感兴趣。

```
#define addr_pack(addr, type, bits, data, len) do { \
    (addr)->addr_type = type; \
    (addr)->addr_bits = bits; \
    memmove((addr)->addr_data8, (char *)data, len); \
} while (0) 
```

C是否需要执行宏中的代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-23T19:15:21.977

这是 c 预处理器的定义宏。最后的那些反斜杠是因为它是跨越多行的单一定义。do while 循环类似于 while 循环，但评估在最后完成，允许它始终至少执行一次。在这种情况下，开发人员将该 while 循环用作一种 hack，以允许将他的代码放入自己的范围内。

从同一目录中的 eth.h ：

```
typedef struct eth_addr {
        uint8_t         data[ETH_ADDR_LEN];
} eth_addr_t; 
```

ip.h：

```
typedef uint32_t        ip_addr_t; 
```

ip6.h：

```
typedef struct ip6_addr {
        uint8_t         data[IP6_ADDR_LEN];
} ip6_addr_t; 
```

Honeyd-1.1.1/未使用/WinSock.h：

```
/*
 * Structure used by kernel to store most
 * addresses.
 */
struct sockaddr {
        u_short sa_family;              /* address family */
        char    sa_data[14];            /* up to 14 bytes of direct address */
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T21:09:50.437

你看过[htod](http://www.digitalmars.com/d/1.0/htod.html)吗？它应该自动将 .h 文件转换为 d 声明。

# iphone - 是否有将小时转换为秒、秒转换为小时等的简单函数？

> ID：902049
> 
> 赞同：1
> 
> 时间：2009-05-23T17:52:31.293
> 
> 标签：iphone, cocoa-touch, time, uikit

我想为此编写一些函数，但在此之前：是否有任何时间单位之间的转换？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-23T18:26:59.227

试试[NSDate 类](http://developer.apple.com/documentation/Cocoa/Conceptual/DatesAndTimes/DatesAndTimes.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T23:37:15.630

要将小时转换为秒，请将秒乘以 3600。要将秒转换为小时，请除以 3600。

但是如果还有剩余的分钟和秒呢？那么你可以做这样的事情假设你有一个**间隔**秒数的 NSTimeInterval ：

```
int mins, hours, remainderSeconds, remainderMins;
    mins = interval / 60;
    hours = mins/60;
    remainderMins = mins - (hours * 60);
    remainderSeconds = interval - (mins * 60); 
```

可能有更好的方法，但这是我过去所做的并且有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-23T23:33:13.343

是的，NSDateComponents 类用于在 NSDate 对象之间转换时间间隔，以及 NSCalendar 来处理本地化问题。不过，它真的只在处理日期时才有用。对于几秒钟和几分钟，我会自己进行转换。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-23T18:00:33.077

如果您使用的是 .Net 平台，那么您有一个直接的解决方案。使用名为**TimeSpan**的对象。

**TimeSpan**保存 2 个日期时间对象之间的差异。然后，这种差异可以表示为秒、分钟或小时或天......

前任：

```
DateTime d1 = DateTime.Now

DateTime d2 = DateTime.Now.AddHours(100);

TimeSpan _timeDiff = d1 - d2; 
```

谢谢。

# android - T-Mobile G1（品牌 HTC Dream）和 Google 的 ADP1（开发者设备）有什么区别？

> ID：902056
> 
> 赞同：8
> 
> 时间：2009-05-23T17:55:01.557
> 
> 标签：android, mobile

我正在搜索互联网，但找不到比较两者的网站。我有兴趣为 android 平台开发。G1 似乎和 ADP1 一样，但在开发过程中是否有任何值得注意的小变化？

第三方软件怎么样？G1 中存在哪些不属于 ADP1 捆绑包的 T-Mobile 软件，反之亦然？

我可以将原始 ADP1 固件换成 T-Mobile 品牌的固件吗？据我了解，人们已经可以破解 G1 来运行 ADP1 的非品牌固件。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-23T22:40:10.097

> 我正在搜索互联网，但找不到比较两者的网站。我有兴趣为 android 平台开发。G1 似乎和 ADP1 一样，但在开发过程中是否有任何值得注意的小变化？

如果您使用 SDK 进行开发是为了进行用户级应用程序开发，而不是内核开发或在框架本身上工作，那么您应该不会注意到任何差异。您可以通过`adb`命令与其中任何一个进行交互，并生成调试消息（在设置 → 应用程序 → 开发下。）

> 第三方软件怎么样？G1 中存在哪些不属于 ADP1 捆绑包的 T-Mobile 软件，反之亦然？

作为 Android 的一部分开发和分发的所有应用程序（[源代码树](http://android.git.kernel.org/ "安卓源")中的应用程序在 .）下`platform/packages/apps`。这包括闹钟、浏览器、计算器、日历、摄像机、相机、联系人、拨号器、电子邮件、图库、消息传递、音乐和语音拨号器应用程序。除此之外，这两个图像还包括专有的 Gmail、Google Talk、Google Maps 和 Android Market 应用程序。

您会注意到，如果发布者选择保护应用程序，Android Market 中的应用程序可能不会出现。这可能适用于付费和免费应用程序，但通常只有一些付费应用程序倾向于以这种方式受到保护。原因是 Android Development Phone 1 固件允许 root 访问，这将允许您绕过市场复制保护。

ADP1 固件不包括 Amazon MP3 商店或 T-Mobile 的 MyFaves 应用程序。它不包括 Google Talk 以外的即时消息应用程序，但在 T-Mobile G1 上，这些应用程序通过文本消息而不是数据连接工作。

> 我可以将原始 ADP1 固件换成 T-Mobile 品牌的固件吗？据我了解，人们已经可以破解 G1 来运行 ADP1 的非品牌固件。

ADP1和G1的区别是：

*   引导加载程序（工程与普通）
*   固件映像
*   背面的外壳设计

您可以随时使用 T-Mobile 固件进行刷写（这些固件尚未正式发布，但升级过程会打印映像的 URL 以进行调试）。您可以随时返回 ADP1 映像，因为固件闪存将保持引导加载程序不变，并且不需要使用 T-Mobile 的发布密钥对映像进行签名。

由于硬件是相同的，在利用早期版本中的漏洞获取 root 访问权限并有效地将 G1 转换为 ADP1 后，您始终可以在 T-Mobile G1 上加载工程（或自定义）引导加载程序（请参阅[xda 开发人员论坛有关详细信息，请参阅 HTC Dream](http://forum.xda-developers.com/forumdisplay.php?f=448 "XDA 开发者 HTC Dream")。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-23T18:28:38.490

一个很大但鲜为人知的区别是，市场上标记为“受版权保护”的应用程序在 ADP1 上浏览市场时不会出现。这是一个独立于免费与付费应用程序的设置，因此您会看到一些付费应用程序，并且可能看不到恰好在其市场设置中设置了该设置的免费应用程序，但通常您可以假设有很多付费应用程序使用默认图像无法通过市场轻松安装的应用程序。

编辑：此外，它不包括一些应用程序，包括 Amazon MP3 Store 和 MyFaves。原始图像不包括 VoiceDialer，但我相信它已添加到 HTC 提供的最新官方图像中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-23T17:57:06.357

硬件差异

*   ADP1的后盖有花哨的图案
*   T-Mobile 的 G1 有黑色和白色
*   ADP1的拨号键和挂机键是绿色和红色
*   T-Mobile 的 G1 前面有“T-Mobile”，后面有“Google”

由于硬件基本相同，因此两者的软件可以互换使用。虽然 ADP1 是开箱即用的 SIM 卡解锁，但在解锁和生根 T-Mobile G1 （包括降级、刷机等）方面需要付出更多努力。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-24T07:48:32.810

[非官方 Android 常见问题解答](http://android-dls.com/wiki/index.php?title=Android_FAQ)提到了零售 G1 和 Android 开发者手机之间的许多差异。

# c++ - C++ 中有哪些比较晦涩的部分？

> ID：902062
> 
> 赞同：8
> 
> 时间：2009-05-23T17:57:08.527
> 
> 标签：c++

我已经阅读了很多关于 C++ 的初学者书籍，还有一些内容，但是 C++ 有哪些比较晦涩的方面，或者我在哪里可以找到有关这些方面的信息/教程？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-23T19:05:26.973

[ADL](http://en.wikipedia.org/wiki/Argument_dependent_name_lookup)（又名 Koenig Lookup）相当晦涩，尽管人们在每个 Hello World 程序中都没有意识到它的使用。

“ [ScopeGuard](http://www.ddj.com/cpp/184403758)技巧”，其中作为函数返回值的 const 引用被绑定到它们被分配到的东西的范围，也相当模糊。不过，那篇文章提高了人们对它的认识。

还有一些 sizeof() 的属性和用法被认为是晦涩难懂的，尤其是在宏或模板元程序中使用时。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-23T18:03:54.130

候选特征的格言是“你并不经常需要它，但当你需要它时，你就很需要它”。

*   新的展示位置
*   外部“C++”
*   本地班
*   标准::分配器
*   可变的，显式的，易变的
*   指向任何类的任何成员的指针

因此，对于有理由使用这些功能的人（库作者）来说，它们不会晦涩难懂，而对于大多数 C++ 程序员来说，它们将是未知的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-23T18:07:40.520

实际上关心bad_alloc。

不？

编辑：我的意思是，在我有幸修复错误的许多有时巨大的 C++ 项目中，捕获 bad_alloc 并对其采取行动的概念已经缺失。这会将它放在 C++ 的“晦涩”部分，即使它不应该是。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-05-28T11:46:11.297

一些晦涩的 C++ 特性：

*   模拟文字 [http://web.archive.org/web/20120110153227/http://weegen.home.xs4all.nl/eelis/analogliterals.xhtml](http://web.archive.org/web/20120110153227/http://weegen.home.xs4all.nl/eelis/analogliterals.xhtml)
*   匿名/未命名命名空间[http://publib.boulder.ibm.com/infocenter/comphelp/v8v101/index.jsp?topic=%2Fcom.ibm.xlcpp8a.doc%2Flanguage%2Fref%2Funnamed_namespaces.htm](http://publib.boulder.ibm.com/infocenter/comphelp/v8v101/index.jsp?topic=%2Fcom.ibm.xlcpp8a.doc%2Flanguage%2Fref%2Funnamed_namespaces.htm)
*   强制转换函数将值返回为**void** [https://stackoverflow.com/a/689716/2028887](https://stackoverflow.com/a/689716/2028887)
*   更改函数默认参数[http://cpptruths.blogspot.fi/2005/07/sharing-c-function-default-arguments.html](http://cpptruths.blogspot.fi/2005/07/changing-c-function-default-arguments.html)
*   常量限定符[http://publib.boulder.ibm.com/infocenter/iadthelp/v7r1/index.jsp?topic=/com.ibm.etools.iseries.langref.doc/as400clr57.htm](http://publib.boulder.ibm.com/infocenter/iadthelp/v7r1/index.jsp?topic=/com.ibm.etools.iseries.langref.doc/as400clr57.htm)
*   直接初始化（原始类型）[https://stackoverflow.com/a/1029069/2028887](https://stackoverflow.com/a/1029069/2028887)
*   **显式**关键字[http://www.glenmccl.com/tip_023.htm](http://www.glenmccl.com/tip_023.htm)
*   功能**尝试**块[http://www.drdobbs.com/introduction-to-function-try-blocks/184401297](http://www.drdobbs.com/introduction-to-function-try-blocks/184401297)
*   本地课程[https://stackoverflow.com/a/3100801/2028887](https://stackoverflow.com/a/3100801/2028887)
*   主函数不需要返回语句[https://stackoverflow.com/a/1771776/2028887](https://stackoverflow.com/a/1771776/2028887)
*   **mutable** -keyword[除了允许 const 函数修改变量之外，“mutable”关键字是否还有其他用途？](https://stackoverflow.com/questions/105014/does-the-mutable-keyword-have-any-purpose-other-than-allowing-the-variable-to)
*   overloading operators ++ and -- [https://stackoverflow.com/a/3846374/2028887](https://stackoverflow.com/a/3846374/2028887)
*   placement **new** [http://www.parashift.com/c++-faq/placement-new.html](http://www.parashift.com/c++-faq/placement-new.html)
*   pure virtual function implementations [https://stackoverflow.com/a/2089176/2028887](https://stackoverflow.com/a/2089176/2028887)
*   ref qualifiers [http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2009/n2819.html](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2009/n2819.html)
*   references to temporary values [http://bytes.com/topic/c/answers/169672-const-reference-temporary-object-why](http://bytes.com/topic/c/answers/169672-const-reference-temporary-object-why)
*   **register**-keyword [http://en.cppreference.com/w/cpp/keyword/register](http://en.cppreference.com/w/cpp/keyword/register)
*   returning void values [https://stackoverflow.com/a/2176229/2028887](https://stackoverflow.com/a/2176229/2028887)
*   template argument as a friend [Template parameter as a friend](https://stackoverflow.com/questions/6510041/template-parameter-as-a-friend)
*   template template arguments [http://publib.boulder.ibm.com/infocenter/lnxpcomp/v8v101/index.jsp?topic=%2Fcom.ibm.xlcpp8l.doc%2Flanguage%2Fref%2Ftemplate_template_arguments.htm](http://publib.boulder.ibm.com/infocenter/lnxpcomp/v8v101/index.jsp?topic=%2Fcom.ibm.xlcpp8l.doc%2Flanguage%2Fref%2Ftemplate_template_arguments.htm)
*   variadic functions [http://en.cppreference.com/w/cpp/utility/variadic](http://en.cppreference.com/w/cpp/utility/variadic)
*   variadic macros [http://en.wikipedia.org/wiki/Variadic_macro](http://en.wikipedia.org/wiki/Variadic_macro)
*   virtual inheritance [https://stackoverflow.com/a/21607/2028887](https://stackoverflow.com/a/21607/2028887)
*   **volatile**-keyword [http://en.cppreference.com/w/cpp/keyword/volatile](http://en.cppreference.com/w/cpp/keyword/volatile)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-23T17:59:56.913

Herb Sutter 的书籍是该主题的绝佳来源——从[http://www.gotw.ca/publications/xc++.htm](http://www.gotw.ca/publications/xc++.htm)开始。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-12-21T08:14:52.757

非常晦涩：

*   无效运算符，（）；
*   短路
    逻辑表达式时运算符||() 和运算符&&() 的优先级
*   当你重载 operator&() 时会发生什么
*   有状态虚拟继承的初始化顺序。
*   引用指向模板成员的指针
*   功能尝试块
*   分配器::重新绑定语法
*   std::unexpected 的非默认行为
*   std::cout.imbue()
*   任何带有语言环境的东西，尤其是自定义方面
*   通过支配压倒一切
*   三元组

仅举几个

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-23T18:10:26.070

[模板元编程（由编译器执行](http://en.wikipedia.org/wiki/Template_metaprogramming)*的*C++ 中完整的小图灵完备编程语言）和使用预处理器的 hack 可能非常困难！（您甚至可以使用它创建全新的语法 - 只需看看[`boost::lambda`](http://www.boost.org/doc/libs/1_39_0/doc/html/lambda.html)）

但我认为学习和理解最重要的是 STL（C++ 标准库），它不可避免地有用，但可能看起来有些奇怪。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-23T18:33:00.323

所有书籍都解释了什么是例外。
但很少有人谈论异常安全和异常受赠者。

如何使用 RAII（简单示例智能指针）使您的代码异常安全。

您应该提供哪些例外保证。

*   析构函数应该被授予没有异常逃逸的权利。
*   一些 STL 算法使用诸如交换之类的东西，它也应该被授予在所有情况下都没有异常逃逸的东西。
*   ETC...

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-07-22T00:27:40.597

没有人提到我认为它是 C++ 中最奇怪的部分之一，显然是事后的想法，即前置递减和前置递增运算符的语法。

```
class A {
public:
  A &operator++() {...} // Post increment
  A &operator--() {...} // Post decrement
}; 
```

对比

```
class A {
public:
  A &operator++(int) {...} // Pre increment
  A &operator--(int) {...} // Pre decrement
}; 
```

当然，后增量意味着加一但返回前一个值，前增量意味着加一并返回新值。例如：

```
A a;
f(a++); // Post increment a
f(++a); // Pre increment a 
```

我不确定如果您尝试使用或传递“int”参数会发生什么。您可以尝试像这样传递它：

```
obj.operator++(0); 
```

我想这就是您在显式调用它们时区分这两个运算符的方式。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-23T18:39:42.357

就其他方法而言，某些方法的实现并不那么明显。

赋值运算符：
-> 实现为复制构造和交换。

operator +
-> 实现为复制构造和 operator +=

运算符 !=
-> 根据运算符 == 实现

ETC...

这个概念是工作应该本地化在一种方法中，而其他方法使用这种方法来完成真正的工作，然后添加它们独特的扭曲。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-23T18:42:50.807

如果您想了解一些关于 C++ 的晦涩难懂的知识，请深入尝试模板并阅读[Andrei Alexandrescu](http://erdani.org/)的[Modern C++ Design](http://erdani.org/)。这本书是关于模板元编程的经典。

# design-patterns - 装饰器设计模式与服务对象一起使用（单例）

> ID：902063
> 
> 赞同：2
> 
> 时间：2009-05-23T17:57:14.623
> 
> 标签：design-patterns, coldfusion, decorator

我正在做一个项目，我需要向服务对象添加一些功能，并且使用装饰器添加它似乎很合适。但是，我只使用过带有简单 bean 的装饰器，从来没有在像服务对象这样的单例上使用过。以前有没有人这样做过，有什么优点和缺点？在这种情况下，我认为创建子类不会起作用，因此装饰器似乎很合适。你对这样做有什么想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-02-01T13:10:14.107

我经常在我的单例服务对象上使用装饰器模式。事实上，每个服务都使用 $throw 之类的方法扩展了 BaseService 对象，这些方法允许我将业务层错误记录到 RSS 提要中。

去吧。

# svn - 我可以将 GIT 存储库与 SVN 客户端一起使用吗？

> ID：902067
> 
> 赞同：8
> 
> 时间：2009-05-23T17:59:55.463
> 
> 标签：svn, git, tortoisesvn, git-svn, ankhsvn

目前我正在使用以下 SVN 客户端：TortoiseSVN for Windows 和 AnkhSVN for Visual Studio 2005+。我听说 GIT 与 SVN 的互操作性很高。我的工具可以与 GIT 存储库一起使用吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-23T18:39:24.463

至少，关于 Tortoise，你有一个 git 等效项：

[**龟甲**](http://code.google.com/p/tortoisegit/)。

![来自 tortoisegit.googlecode.com/git/doc/images/en/ContextMenuDirControl.png 的上下文菜单](https://i.stack.imgur.com/9Sbrh.png)

并且[**gitExtension**](http://sourceforge.net/projects/gitextensions)可以帮助使用 Visual Studio，正如这个[SO question中所提到的](https://stackoverflow.com/questions/507343/using-git-with-visual-studio)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-23T18:07:32.190

没有。使用 git 客户端。Git 比 SVN 更复杂，结构也大不相同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-10T04:45:03.703

GitHub.com 对其 Git 托管存储库的 SVN 客户端具有读/写支持：[https ://github.com/blog/644-subversion-write-support](https://github.com/blog/644-subversion-write-support)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-01-15T13:28:06.603

您可以签出 git 存储库，但不能执行大多数其他操作。您可以设置 Tortoise git，尽管命令不同，但它为 Git 提供相同的界面。

# c# - 一个月过去了吗？

> ID：902074
> 
> 赞同：4
> 
> 时间：2009-05-23T18:02:22.010
> 
> 标签：c#, .net, linq-to-sql

在我的数据库中，我有一个包含一些订阅信息的表。我有一个 StartDate 和一个 EndDate 作为 DateTime。

我需要做一个 Linq 查询来获取所有到期付款的行。付款应该在每个月在他们注册的同一天（开始日期）进行，并在结束日期停止。因此，如果他们在 5 月 23 日注册，我需要在 6 月 23 日、7 月 23 日等再次向他们开具发票。

```
var query = from c in db.Subscription
            where c.StartDate.Value.Day == DateTime.Now.Day
            // What if today is Feb. 28 and a customer registered January 31.
            // What if.... 
```

我迷路了……请帮忙！

最好的，乔恩 2H

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-23T18:19:03.887

处理月结转日的一种方法是（假设您想在奇怪的情况下在当月的最后一天对其进行计费）：

```
var Tomorrow = DateTime.Today.AddDays(1);

var query = from c in db.Subscription
            where c.EndDate.Value > DateTime.Today &&
                  (c.StartDate.Value.Day == DateTime.Today.Day ||
                   (Tomorrow.Month > DateTime.Today.Month && 
                    c.StartDate.Value.Day > DateTime.Today.Day))
            select c; 
```

不过，您可能希望为到期付款创建一个新表并提前计算日期。这样，您就可以跟踪付款的时间，并使未来的生活更轻松。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-23T18:15:39.133

为什么不为所有到期付款创建一个单独的表。

取出新订阅后，您将计算该订阅的所有未来付款日期，并将带有 SubscriptionID、PaymentDate 和 Amount 的行添加到 DuePayments 表中。

行数将等于订阅开始日期和结束日期之间的月数，并且可以使用 DateTime.AddMonths(1) 轻松计算付款日期，而小于结束日期。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-23T18:12:40.373

```
select
    *
from
   Subscription s
where
   getdate() > dateadd(month, 1, isnull(s.lastBilledDate, s.StartDate) ) 
```

像这样的东西应该工作。希望您在数据库中的某处有一个字段显示最后的开票日期日期 - 这比订阅开始日期更好用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-23T18:11:57.923

DateTime 结构上有一个 AddMonths 方法。

[http://msdn.microsoft.com/en-us/library/system.datetime.addmonths.aspx](http://msdn.microsoft.com/en-us/library/system.datetime.addmonths.aspx)

是的，我想我也有点想只有一个月的差异。

抓取 StartDate.Value.Day == DateTime.Now.Day 或 (StartDate.Value.Day > DateTime.Now.Day 和 DateTime.Now.Day 是该月的最后一天的行怎么样，无论使用哪种方法是）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-24T09:08:30.700

您的问题不是严格与编程相关，而是与业务相关。假设我什至没有用于该项目/产品/等的计算机和软件。

如果计划从 1 月 31 日开始怎么办？我会在 2 月 31 日向他们收费吗？不是。然后什么时候？我该如何计算？

最好的办法是设置一个精确的天数（比如 30 天）并将其用作商业模式。在服务开始后的第 30 天，您将被收取费用。或者类似的东西。

在 T-SQL 和 .NET 中，为 DateTime 添加 30 天没什么大不了的：

。网 ：

```
DateTime value = DateTime.Now;
DateTime billTime = value.AddDays(30); 
```

T-SQL：

```
DATEADD(DAY,30,value) 
```

# c++ - 使用聚合初始化列表优于构造函数的优势？

> ID：902077
> 
> 赞同：1
> 
> 时间：2009-05-23T18:03:03.710
> 
> 标签：c++, constructor, aggregate

我是 C++ 新手，我有一个问题......

我尝试通过制作一个测试应用程序自己回答这个问题......在调试中，B类初始化生成较少的汇编代码，但在发布模式下，我真的不能说......它优化了初始化:(

假设我有两个课程：

```
class A
{
public:
    int a, b, c, d;

    A(int _a, int _b, int _c, int _d) : a(_a), b(_b), c(_c), d(_d)
    {
    }
};

class B
{
public:
    int a, b, c, d;
}; 
```

使用有什么好处吗

```
B b = {1, 2, 3, 4} 
```

代替

```
A a = A(1, 2, 3, 4); 
```

?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-23T18:36:06.073

对于全局对象和静态类成员，初始化列表不会在运行时调用任何代码。（初始化数据直接存储在二进制文件中）。

如果您正在初始化大量对象，或者构造函数代码很昂贵/很大，这可能会在加载时产生显着差异。

如前所述，这仅适用于普通旧数据，即可以使用 C++ < 0x 中的初始化列表初始化的所有内容

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-23T18:09:38.973

我不知道性能优势，但通常使用构造函数是首选。

这是因为对于 A，成员 a、b、c、d 可以设为私有。因此，您可以使用 A 方法进行封装，而 B 中没有这种方法。

作为类设计者，您可以通过构造函数强制严格使用和分配成员变量。在您的 B 类场景中，您不能。

因此，虽然您可能会因为使用 B 而在性能上得到小幅提升，但我敢打赌它可以忽略不计，并且会因拥有不受保护的班级成员的潜在头痛而被否定。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-23T18:18:35.400

您不必显式地编写构造函数和使用这种类型的初始化在 C++ 中工作的 C 代码。

如果您有简单数据文件的复杂复合结构，则使用初始化列表比使用构造函数更容易初始化变量：

```
B barr[5] = {
    {1,2,3,4},
    {5,6,7,8},
    ...
  }; 
```

它（当前）仅适用于仅具有 POD 成员变量的简单类并且程序员可能不太熟悉语法的缺点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-23T18:13:03.960

大多数类不能使用初始化列表（还没有！），所以最好使用构造函数来保持一致。在 c++0x 中，将存在 std::initializer_list 以允许任何类使用此语法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-09-28T12:34:09.053

## 以下是使用初始化列表时的场景：

1.  用于初始化非静态 const 数据成员。
2.  用于引用成员的初始化。
3.  用于初始化没有默认构造函数的成员对象。
4.  用于基类成员的初始化。
5.  当构造函数的参数名称与数据成员相同时。

# c++ - cout.width 的反面是什么？(C++)

> ID：902082
> 
> 赞同：2
> 
> 时间：2009-05-23T18:05:15.313
> 
> 标签：c++, iostream, cout

我试图`std::cout.width(int)`看看它做了什么，它将文本向右推以填充最小宽度：

```
TH 
```

变成：

```
 TH 
```

填充最小宽度为 10。我想知道 A）是否有办法扭转这种情况，在文本后放置多个空格以填充最小宽度，并且 B）有没有办法创建最大宽度和最小宽度？

顺便说一句，是否可以创建一个派生自`cout`or的类`ostream`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-23T18:23:22.430

宽度为您接下来使用 cout 打印的内容设置“列”大小。

```
std::cout << left << "Hello"; 
```

会将上面的内容打印为在您制作的列中对齐的“左”。

默认情况下，不同的“类型”与某些边对齐。

[此参考页面](http://www.cplusplus.com/reference/iostream/ios_base/flags/)上的更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T18:24:23.910

> 顺便说一句，是否可以创建一个从 cout 或 ostream 派生的类？

一次一个问题是个好主意，但你不能从 cout 派生，因为它是一个实例，而不是一个类。有关派生新输出流类型的详细信息，请阅读[本书](http://www.angelikalanger.com/iostreams.html)。

# python - Python中的自动重启系统

> ID：902085
> 
> 赞同：5
> 
> 时间：2009-05-23T18:07:22.220
> 
> 标签：python, linux, restart, pid

我需要检测程序何时崩溃或没有使用 python 运行并重新启动它。我需要一种不一定依赖于作为父进程的 python 模块的方法。

我正在考虑实现一个基本上可以做到的while循环

```
ps -ef | grep process name 
```

当找不到该进程时，它会启动另一个进程。也许这不是最有效的方法。我是 python 新手，所以可能已经有一个 python 模块可以做到这一点。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-23T18:50:19.750

为什么要自己实现？[像daemon](http://libslack.org/daemon/)或 Debian's这样的现有实用程序`start-stop-daemon`更有可能解决有关运行长期服务器进程的其他难题。

无论如何，当您启动服务时，将其 pid 放入`/var/run/<name>.pid`，然后让您的`ps`命令只查找该进程 ID，并检查它是否是正确的进程。在 Linux 上，您可以简单地`/proc/<pid>/exe`查看它是否指向正确的可执行文件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-23T19:22:54.020

请不要重新发明init。您的操作系统具有执行此操作的功能，几乎不需要系统资源，并且肯定会比您可以复制的任何东西更好、更可靠地做到这一点。

经典 Linux 有 /etc/inittab

Ubuntu 有 /etc/event.d（新贵）

OS X 已推出

Solaris 有 smf

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-23T20:55:14.270

以下代码在给定时间间隔内检查给定进程，并重新启动它。

```
#Restarts a given process if it is finished.
#Compatible with Python 2.5, tested on Windows XP.
import threading
import time
import subprocess

class ProcessChecker(threading.Thread):
    def __init__(self, process_path, check_interval):
        threading.Thread.__init__(self)
        self.process_path = process_path
        self.check_interval = check_interval

    def run (self):
        while(1):
            time.sleep(self.check_interval)
            if self.is_ok():
                self.make_sure_process_is_running()

    def is_ok(self):
        ok = True
        #do the database locks, client data corruption check here,
        #and return true/false
        return ok

    def make_sure_process_is_running(self):
        #This call is blocking, it will wait for the
        #other sub process to be finished.
        retval = subprocess.call(self.process_path)

def main():
    process_path = "notepad.exe"
    check_interval = 1 #In seconds
    pm = ProcessChecker(process_path, check_interval)
    pm.start()
    print "Checker started..."

if __name__ == "__main__":
    main() 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-10-07T01:08:17.807

也许你需要[http://supervisord.org](http://supervisord.org)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-23T18:31:42.430

我自己没有尝试过，但是有一个[Python System Information](http://pypi.python.org/pypi/PSI)模块可以用来查找进程并获取有关它们的信息。AFAIR 有一个`ProcessTable`类可以用来检查正在运行的进程，但它似乎没有很好的文档记录......

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-23T18:42:11.573

我会走命令行路线（这更容易恕我直言），只要您每隔一两秒检查一次，与任何不到 10 年的系统上的可用处理相比，资源使用量应该是无穷小的。

# android - 如何判断 sdcard 是否安装在 Android 中？

> ID：902089
> 
> 赞同：17
> 
> 时间：2009-05-23T18:09:15.150
> 
> 标签：android, android-sdcard

我正在开发一个需要查看用户存储的图像的 Android 应用程序。问题是如果用户通过 USB 电缆安装了 SD 卡，我无法读取磁盘上的图像列表。

有谁知道如何判断 USB 是否已安装，以便我可以弹出一条消息，通知用户它不起作用？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-05-23T22:50:47.767

如果您尝试访问设备上的图像，最好的方法是使用[MediaStore 内容提供程序](http://developer.android.com/reference/android/provider/MediaStore.Images.Media.html "android.provider.MediaStore.Images.Media")。将其作为[内容提供者](http://developer.android.com/guide/topics/providers/content-providers.html)访问将允许您查询存在的图像，并将`content://`URL 映射到设备上适当的文件路径。

如果您仍需要访问 SD 卡，Camera 应用程序包含一个[ImageUtils](http://android.git.kernel.org/?p=platform/packages/apps/Camera.git;a=blob;f=src/com/android/camera/ImageManager.java;h=073b8db811d1a010079c7a258a418aa90fae2326;hb=dafe31ead98304414f84f021bd0c155e62d833c2)类，用于检查 SD 卡是否已安装，如下所示：

```
static public boolean hasStorage(boolean requireWriteAccess) {
    //TODO: After fix the bug,  add "if (VERBOSE)" before logging errors.
    String state = Environment.getExternalStorageState();
    Log.v(TAG, "storage state is " + state);

    if (Environment.MEDIA_MOUNTED.equals(state)) {
        if (requireWriteAccess) {
            boolean writable = checkFsWritable();
            Log.v(TAG, "storage writable is " + writable);
            return writable;
        } else {
            return true;
        }
    } else if (!requireWriteAccess && Environment.MEDIA_MOUNTED_READ_ONLY.equals(state)) {
        return true;
    }
    return false;
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-06-20T03:33:05.333

这是`jargonjustin`post中的 checkFsWritable 缺失函数

```
private static boolean checkFsWritable() {
        // Create a temporary file to see whether a volume is really writeable.
        // It's important not to put it in the root directory which may have a
        // limit on the number of files.
        String directoryName = Environment.getExternalStorageDirectory().toString() + "/DCIM";
        File directory = new File(directoryName);
        if (!directory.isDirectory()) {
            if (!directory.mkdirs()) {
                return false;
            }
        }
        return directory.canWrite();
    } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-23T20:38:43.993

我很抱歉发布了一种非 Android 的方式，希望有人可以使用 Android API 提供答案。

您可以列出 sdcard 根目录上的文件。如果没有，则 sdcard 要么完全空白（不寻常，但可能），要么已卸载。如果您尝试在 sdcard 上创建一个空文件并且失败，这意味着您正在尝试在 sdcard 的挂载点创建一个文件，由于权限问题，该文件将被拒绝，因此您会知道 sdcard 不是安装。

是的，我知道这很丑……

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-09-27T07:03:35.383

```
public static boolean isSdPresent() {

return android.os.Environment.getExternalStorageState().equals(android.os.Environment.MEDIA_MOUNTED);

} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-08-11T15:29:15.170

在 jargonjustin 的帖子中：

文件[ImageManager.java](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android-apps/2.3.2_r1/com/android/camera/ImageManager.java#ImageManager)

> 方法[hasStorage](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android-apps/2.0_r1/com/android/camera/ImageManager.java#ImageManager.hasStorage%28%29) -->

```
public static boolean hasStorage(boolean requireWriteAccess) {
        String state = Environment.getExternalStorageState();

        if (Environment.MEDIA_MOUNTED.equals(state)) {
            if (requireWriteAccess) {
                boolean writable = checkFsWritable();
                return writable;
            } else {
                return true;
            }
        } else if (!requireWriteAccess
                && Environment.MEDIA_MOUNTED_READ_ONLY.equals(state)) {
            return true;
        }
        return false;
    } 
```

> 方法[checkFsWritable](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android-apps/2.0_r1/com/android/camera/ImageManager.java#ImageManager.checkFsWritable%28%29) -->

```
 private static boolean checkFsWritable() {
        // Create a temporary file to see whether a volume is really writeable.
        // It's important not to put it in the root directory which may have a
        // limit on the number of files.
        String directoryName =
                Environment.getExternalStorageDirectory().toString() + "/DCIM";
        File directory = new File(directoryName);
        if (!directory.isDirectory()) {
            if (!directory.mkdirs()) {
                return false;
            }
        }
        File f = new File(directoryName, ".probe");
        try {
            // Remove stale file if any
            if (f.exists()) {
                f.delete();
            }
            if (!f.createNewFile()) {
                return false;
            }
            f.delete();
            return true;
        } catch (IOException ex) {
            return false;
        }
    } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-17T14:40:53.513

我正在使用光标从 sd 卡中检索图像，当设备中没有插入 sd 卡时，光标为空。实际上，这是通过从设备中物理移除卡来卸载 sdcard 卷的情况。这是我使用的代码：

```
 Cursor mCursor = this.getContentResolver().query(MediaStore.Images.Media.EXTERNAL_CONTENT_URI, null, null, null, null);
    if (mCursor == null || !mCursor .moveToFirst()) {
                /**
                 *mCursor == null:
                 * - query failed; the app don't have access to sdCard; example: no sdCard 
                 *
                 *!mCursor.moveToFirst():
                 *     - there is no media on the device
                 */
            } else {
                 // process the images...
                 mCursor.close(); 
    } 
```

更多信息：http: [//developer.android.com/guide/topics/media/mediaplayer.html#viacontentresolver](http://developer.android.com/guide/topics/media/mediaplayer.html#viacontentresolver)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-01-04T06:39:18.877

在对外部存储进行任何操作之前，您应该始终调用 getExternalStorageState() 来检查媒体是否可用。媒体可能已安装到计算机、丢失、只读或处于其他状态。例如，您可以使用以下几种方法来检查可用性：

```
/* Checks if external storage is available for read and write */
public boolean isExternalStorageWritable() {
    String state = Environment.getExternalStorageState();
    if (Environment.MEDIA_MOUNTED.equals(state)) {
        return true;
    }
    return false;
}

/* Checks if external storage is available to at least read */
public boolean isExternalStorageReadable() {
    String state = Environment.getExternalStorageState();
    if (Environment.MEDIA_MOUNTED.equals(state) ||
        Environment.MEDIA_MOUNTED_READ_ONLY.equals(state)) {
        return true;
    }
    return false;
} 
```

来源：http: [//developer.android.com/guide/topics/data/data-storage.html](http://developer.android.com/guide/topics/data/data-storage.html)

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2014-06-09T07:15:26.557

```
Cool....Check it out...
try {
            File mountFile = new File("/proc/mounts");
            usbFoundCount=0;
            sdcardFoundCount=0;
            if(mountFile.exists())
             {
                Scanner usbscanner = new Scanner(mountFile);
                while (usbscanner.hasNext()) {
                    String line = usbscanner.nextLine();
                    if (line.startsWith("/dev/fuse /storage/usbcard1")) {
                        usbFoundCount=1;
                        Log.i("-----USB--------","USB Connected and properly mounted---/dev/fuse /storage/usbcard1" );
                    }
            }
         }
            if(mountFile.exists()){
                Scanner sdcardscanner = new Scanner(mountFile);
                while (sdcardscanner.hasNext()) {
                    String line = sdcardscanner.nextLine();
                    if (line.startsWith("/dev/fuse /storage/sdcard1")) {
                        sdcardFoundCount=1;
                        Log.i("-----USB--------","USB Connected and properly mounted---/dev/fuse /storage/sdcard1" );
                    }
            }
         }
            if(usbFoundCount==1)
            {
                Toast.makeText(context,"USB Connected and properly mounted", 7000).show();
                Log.i("-----USB--------","USB Connected and properly mounted" );
            }
            else
            {
                Toast.makeText(context,"USB not found!!!!", 7000).show();
                Log.i("-----USB--------","USB not found!!!!" );

            }
            if(sdcardFoundCount==1)
            {
                Toast.makeText(context,"SDCard Connected and properly mounted", 7000).show();
                Log.i("-----SDCard--------","SDCard Connected and properly mounted" );
            }
            else
            {
                Toast.makeText(context,"SDCard not found!!!!", 7000).show();
                Log.i("-----SDCard--------","SDCard not found!!!!" );

            }
        }catch (Exception e) {
            e.printStackTrace();
        } 
```

# c++ - c ++ typedef另一个类的枚举？

> ID：902095
> 
> 赞同：12
> 
> 时间：2009-05-23T18:10:39.300
> 
> 标签：c++, enums, typedef

所以这是我的问题：

```
struct A
{
    enum A_enum
    {
        E0,
        E1,
        E2
    };
};

struct B
{
    typedef A::A_enum B_enum;
    bool test(B_enum val)
    {
        return (val == E1); // error: "E1" undeclared identifier
    }
}; 
```

我具体不想说`A::E1`。如果我尝试`B_enum::E1`，我会收到不标准的警告。有没有一个好方法来做这样的事情？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-23T18:17:26.887

我认为 A 应该是命名空间而不是结构。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-23T18:41:18.390

将枚举放在全局范围内过于暴露，将它们放在一个类中可能会引入不希望的依赖关系。对于枚举没有紧密链接到一个类，这就是我使用的：

```
#define CLEANENUMS_BEGIN(name) namespace name { typedef enum {
#define CLEANENUMS_END(name) } internal_ ## name ## _e;} typedef name::internal_ ## name ## _e name ## _e; 
```

然后您可以在全局范围内使用：

```
CLEANENUMS_BEGIN(myEnum)
    horizontal,
    vertical,
CLEANENUMS_END(myEnum) 
```

这或多或少地模拟了处理枚举范围的 C# 方式。预处理器将生成以下代码：

```
namespace myEnum
{
    enum internal_myEnum_e
    {
        horizontal,
        vertical,
    }
}
typedef internal_myEnum_e myEnum_e; 
```

然后将给定的枚举引用为

```
myEnum_e val = myEnum::horizontal; 
```

希望有更好的方法来做到这一点，但到目前为止，这是我找到的唯一解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-11T15:18:39.123

我过去也遇到过同样的问题，这就是我解决它的方法。我希望能够在编译时切换库的实现。其中一个库正在使用这样的代码：

```
namespace Lib1 
{
  enum LibEnum { One, Two, Three };
  [...]
  void someFunc(LibEnum val);
} 
```

在我的代码中，我想从用户体验中隐藏库实现（因此我的代码的用户永远不会看到我在内部使用的库）：

解决方案1：

```
namespace MyCode 
{
  // Example to avoid copying a function from Lib1 here
  typedef Lib1::someFunc aFunctionImUsing;

  // This doesn't work
  // typedef LibEnum MyEnum; 
  // As such code doesn't compile:
  // aFunctionImUsing(One); // Error unknown identifier One
  // But this did:
  struct Type
  {
     enum MyType { One = Lib1::One, Two = Lib1::Two, Three = Lib1::Three };
  }
  static inline Lib1::LibEnum as(Type::MyType t) { return (Lib1::LibEnum)t; }

  // Now code like this compiles:
  aFunctionImUsing(as(Type::One));
  // This one doesn't:
  // aFunctionImUsing(Type::One); // Can't convert from Type::MyType to Lib1::LibEnum

  [...]
} 
```

解决方案2：

```
namespace MyCode 
{
  struct Type
  {
     enum MyType { One = Lib1::One, Two = Lib1::Two, Three = Lib1::Three };
  }

  // If you don't care about polluting your namespace with numerous wrapper 
  // you can write this instead of typedef someFunc:
  static inline void myFunc(Type::MyType t) { return Lib1::someFunc((Lib1::LibEnum)t); }

  // This one does:
  myFunc(Type::One); 
  [...]
} 
```

它们是上面代码片段的两个问题。第一个问题是您必须将枚举复制并粘贴到您的命名空间中（但在查找和替换中使用简单的正则表达式，您就完成了）。第二个问题是您的用户将不得不使用“as”方法，这意味着它并不简单，或者您必须使用第二种解决方案来包装方法/函数。

无论如何，因为不可能跨命名空间注入枚举，所以这个解决方案是你能做的最好的。请注意，您的代码用户甚至不知道您在示例代码中使用的是 Lib1 库。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-08-13T03:21:34.200

我遇到了同样的问题，我使用了这个解决方案，而不是使用多余的命名空间。它将枚举安全地隐藏在类及其显式用户中。

```
class TreeWindow abstract {
public:
  enum CheckState { On, Off, Partial }
};

class TreeControl abstract {
public:
  class ItemChecked abstract: public TreeWindow { // this is the hack needed
  public:
    using TreeWindow::CheckState;
  };

  void func(ItemChecked::CheckState);
};

TreeControl& tree = ...
tree.func(TreeControl::ItemChecked::Partial); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-16T11:57:59.163

似乎没有一个简单的解决方案。也烦我。如果您被允许更改 A，则如果不希望将枚举引入 A 之外的范围，则有一个不依赖于命名空间的解决方案。与使用命名空间相比，A 和 A_Enum 都可以是嵌套类。

```
struct A_Enum
{
    enum A_enum
    {
        E0,
        E1,
        E2
    };
};

struct A : public A_Enum
{
    using A_Enum::A_enum;
};

struct B : public::A_Enum
{
    using A_Enum::A_enum; // original enum name
    bool testA(A_enum val) { return (val == E1); }
}; 
```

EDIT2：再次删除了第二个解决方案，不像我想的那样工作。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-05-23T18:35:53.890

为什么你甚至在 struct B 中有测试方法？我认为这没有任何意义。

通过定义 struct A 并在其中定义一个枚举，您或多或少是在说“这是 struct A 范围内的一个枚举”，这与说“如果你想使用这个枚举，你必须参考结构 A”。

将枚举放在命名空间中不会解决您的问题。因为您将遇到相同的范围问题（C4482）

我认为你把事情弄得太复杂了。你觉得这怎么样？

```
struct A
{
    enum A_enum
    {
        E0,
        E1,
        E2
    };

    static bool test(A_enum val)
    {
        return (val == E1);
    }
};

int main()
{
    assert(A::test(A::E1));
    return 0;
} 
```

注意 A::test() 是静态的。这应该是因为您没有在结构状态上进行操作。而且由于它是静态的，因此您不需要 A 的实例来调用该方法。

# iphone - 给定附件类型的 UITableViewCell 的 contentView 的宽度

> ID：902096
> 
> 赞同：23
> 
> 时间：2009-05-23T18:10:52.373
> 
> 标签：iphone, cocoa-touch, uitableview

在 iPhone 上，当表格视图单元格的内容视图显示某个辅助视图（披露指示器等）时，如何计算它的宽度？

我需要这个来计算包含换行、可变长度文本的单元格的正确单元格高度。但是当表格视图委托被要求提供单元格高度时，它实际上并没有实际的单元格实例，因此它不能直接查询内容视图边界。

我可以轻松地在右侧硬编码一个 20 像素的边距，这对于带有披露指示器的纵向方向的普通样式表视图来说似乎是准确的，但我更愿意以正确的方式进行操作，以便在 Apple 决定时继续工作调整边距。

（这与[这个问题有关](https://stackoverflow.com/questions/494562/setting-custom-uitableviewcells-height)。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-11-16T20:10:59.433

就个人而言，我只会对值进行硬编码——更简单，事情将以可预测的方式中断。

但如果我以编程方式执行此操作，我会创建一个 UITableViewCell，设置您需要测量的编辑属性/附件视图，然后询问它的 contentView 有多大。

当然，我可能会大量缓存这一点——在询问 UITableView 时进行分配会询问您的高度信息，这对我来说听起来会很慢（不过，一如既往地先检查一下探查器）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-24T00:47:52.693

我会有一个 UITableViewCell 的子类，它包含它的所有子元素。当单元格进入并存在编辑模式时，您可以更改某些元素的框架。Apple 的 Table View Programming 指南中有关创建自定义表格视图单元格的部分中有一个很好的示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-24T14:23:02.157

我相信`UITableViewCell`的 contentView 属性是包含您的标签等的视图，因此其宽度应该是您可以使用的可用尺寸。

# hibernate - 异步搜索

> ID：902112
> 
> 赞同：3
> 
> 时间：2009-05-23T18:17:39.973
> 
> 标签：hibernate, search, lucene, hibernate-search

我目前正在使用 Lucene 和 Hibernate Search 为我的公司构建概念验证搜索解决方案。我已经构建了可以正常工作的单个组件。我现在正在考虑创建一个单一的 API，允许用户从不同的来源（域 + 数据）获取搜索结果。我想要实现的是像搜索管理器异步触发搜索请求到不同的搜索组件，当一组结果被处理后，在处理其余结果时将该结果返回给用户。处理完搜索结果后，通知客户端还有更多可用的搜索结果。

我想知道我是否有一个搜索管理器，它创建单独的线程来搜索单个搜索组件并保留搜索结果列表。一旦列表填充了一组，就将其返回给用户。添加的任何其他搜索结果都将涉及搜索管理器将结果推送给用户。

我不是在寻找任何代码示例（任何将不胜感激），但我想知道是否可以就如何解决这个问题获得一些指导。我是使用事件处理技术（GigaSpaces、Spring、JMS）还是使用标准 Java 并发库。管理列表和推送更新结果的有效方法是什么。

干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T22:20:59.443

这听起来非常适合 Java 5 及更高版本中的[Executor Service](http://java.sun.com/javase/6/docs/api/java/util/concurrent/ExecutorService.html "执行服务")抽象。您可以将任务提交到执行器线程池并异步轮询完成。

因此，在您的情况下，您将创建每个搜索作为它自己的任务，然后轮询这些任务以完成。完成后，获取结果并为用户汇总它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-31T15:27:11.793

我会研究[Scatter-Gather](http://www.enterpriseintegrationpatterns.com/BroadcastAggregate.html)模式：使用 JMS（或其他一些消息传递技术）异步广播查询，收集响应直到达到超时或返回最小数量的搜索结果，然后将结果报告给最终用户。

使用 JMS 或类似工具的好处是您可以避免占用多个线程等待响应，并且您有一种机制来处理在第一个结果集返回给用户之后到达的响应。

您可能想了解[Solr](http://lucene.apache.org/solr/)，一个基于 Lucene 的开源企业搜索服务器，以及它们如何处理这些问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T19:05:17.887

如果您为每种类型的搜索管理器创建一个类，例如 Lucene，每个都实现一个异步搜索接口，您应该能够只使用“普通”Java 的东西。

我会考虑以下几行：

创建一个线程安全的集合（如果您不想重复搜索，则为一组），具体取决于您是要排序，是随机访问其中的数据还是只是迭代。通常使用哪种数据结构。

与将集合作为参数的运行搜索方法接口 - 可能是另一种检查搜索是否已终止的方法。或者其他一些基于监听器的方法，无论你喜欢什么方法。

每种不同搜索方法的该接口的实现。每个搜索方法调用都会在调用运行搜索时创建自己的线程，该线程将搜索结果放入提供的集合中。

搜索管理器只是遍历所有已知的搜索引擎（在某处注册）并使用给定的查询对每个搜索引擎进行搜索。

希望有帮助。

# c# - C#如何使用参数读取控制台输出

> ID：902116
> 
> 赞同：2
> 
> 时间：2009-05-23T18:19:24.777
> 
> 标签：c#, console

是否可以运行控制台应用程序并将其输出的内容作为 C# 中的字符串返回？

我希望能够在运行控制台应用程序时使用参数：

```
c:\files\app.exe -a 1 -b 2 -c 3 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-23T18:25:08.090

这不是我今天读到的最清楚的内容，但我只能假设您正在生成一个进程（使用`Process.Start()`？）并希望将其输出返回到您的程序中。

如果是这样，[`Process.StandardOutput`](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.standardoutput.aspx)可能就是您正在寻找的。例如：

```
System.Diagnostics.ProcessStartInfo startInfo = 
    new System.Diagnostics.ProcessStartInfo(@"c:\files\app.exe",@"-a 1 -b 2 -c 3"); 
startInfo.UseShellExecute = false; 
startInfo.RedirectStandardOutput = true; 
Process p = Process.Start(startInfo);
string output = p.StandardOutput.ReadToEnd();
p.WaitForExit(); 
```

# jquery - jQuery 操作 DIV 但不是它的子元素

> ID：902117
> 
> 赞同：0
> 
> 时间：2009-05-23T18:19:59.020
> 
> 标签：jquery

这是我的布局：

```
<div id="outerwrap">
    <div id="innerwrap">
        <div id="centerc">...</div>

        <div id="rightc" style="font-weight:bold">
        </div>
        <div style="background-color:White;height:10px;top:284px;left:0px"></div>

        <div id="leftc">..</div>
    </div>
    <div id="footer" ">...</div>
</div>

<style>
    #outerwrap {
        background-color: #EE44E7;
    }

    #innerwrap {
        background-color: #EE44E7;
        margin-right: 200px;
        top: 0px;
        height: 100%;
    }

    #leftc {
        position: absolute;
        top: 111px;
        left: 0px;
        width: 197px;
        background-color: #EE44E7;
        font-size: 10px;
    }

    #centerc {
        position: relative;
        margin-left: 199px;
        padding: 0px;
        background-color: white;
    }

    #rightc {
        position: absolute;
        top: 111px;
        right: 0px;
        width: 199px;
        color: blue;
        background-color: #EE44E7;
        font-size: 10px;
    }

    #footer {
        padding: 0px;
        margin: 0px;
        width: 100%;
        height: 62px;
        visibility: hidden;
    }
</style>

    #outerwrap
    {
       background-color: #EE44E7;
    }

    #innerwrap
    {
       background-color: #EE44E7;
       margin-right: 200px;
       top:0px;
       height:100%;
    }

    #leftc
    {
       position: absolute;
       top: 111px;
       left: 0px;
       width: 197px;
       background-color: #EE44E7;
       font-size: 10px;
    }

    #centerc
    {
       position: relative;
       margin-left: 199px;
       padding: 0px;
       background-color: white;
    }

    #rightc
    {
       position: absolute;
       top:111px;
       right: 0px;         
       width: 199px;
       color: blue;
       background-color: #EE44E7;
       font-size: 10px;
    }

#footer
    {
    padding: 0px;
    margin: 0px;
    width: 100%;
    height: 62px;
visibility: hidden;
    } 
```

这是我写的查询：

```
<script type="text/javascript">
    $(document).ready(function () {
        $("#leftc").hover(
            function mouseover() {
                $(this).css({ width: "190px" });
                $("#centerc").css({ "margin-left": "195px" });
            },
            function mouseout() {
                $(this).css({ width: "25px" });
                $("#centerc").css({ "margin-left": "29px" });
            }
        );
    });
</script> 
```

我想要的是当页面加载时，左 div 应该只部分可见。现在当用户将鼠标悬停时，左边的 div(leftc) 应该扩大到 190px。悬停时，它应该返回到部分可见状态。

问题是 leftc div 里面还有一些图像和文本框，它们不受上面显示的代码的影响。它们保持相同的宽度？

div (leftc) 内的控件类似于以下内容：

```
<div id="leftc">
    <!-- Google Search Box Start -->
    <div id="searchBox">
        <table border="0" cellpadding="0" cellspacing="0" width="100%">
            <tr>
                <td> <input name="ctl00$q" type="text" value="Google Custom Search" maxlength="100" id="ctl00_q" onclick="ctl00$q.value=''" onfocus="this.className = 'highlight';" onblur="this.className = '';" style="border-color:#94C7EF;border-width:1px;border-style:solid;" /></td>
                <td align="right">
                    <input type="image" name="ctl00$_btnSearch" id="ctl00__btnSearch" src="images/search.gif" alt="Search" onclick="javascript:WebForm_DoPostBackWithOptions(new WebForm_PostBackOptions(&quot;ctl00$_btnSearch&quot;, &quot;&quot;, true, &quot;SearchGroup&quot;, &quot;&quot;, false, false))" style="border-width:0px;" />
                </td>
                <td width="5px" align="right">
                    <span id="ctl00__rfvQ" style="color:Red;visibility:hidden;"></span>
                    <input type="hidden" name="ctl00$cx" id="ctl00_cx" value="004354355454353138:kmy_68iupnm" />
                    <input type="hidden" name="ctl00$cof" id="ctl00_cof" value="FORID:11" />
                </td>
            </tr>
        </table>
    </div>
    <!-- Google Search Box End -->

    <br /><br />

    <div id="monthlabel">All this Month</div>
    <div id="monthall">
        <img id="ctl00_imgAuth" src="images/all/Jacor.jpg" style="border-width:0px;" /><br />
        <div style="margin-top:2px;"><a href="http://www.example.com/AllMonth.aspx">Jacor Jul</a></div>
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-23T18:54:59.740

您应该将左 div 的样式设置为：

```
overflow: hidden; 
```

这将防止显示包装或溢出。

# visual-studio - 如何使用 Visual Studio 将程序集编译并部署到自定义路径中？

> ID：902118
> 
> 赞同：1
> 
> 时间：2009-05-23T18:20:06.023
> 
> 标签：visual-studio, assemblies

我已经搜索了很长时间，我可以找到任何东西。我有2个项目。一种称为 ConsoleApp，另一种称为 ConsoleLib。ConsoleApp 引用了 ConsoleLib。我如何告诉 Visual Studio 将程序集复制到自定义路径而不是应用程序路径？我的意思是，当我构建解决方案时，我想获得这个文件夹结构

AppPath\ConsoleApp.exe
AppPath\Lib\
AppPath\Lib\ConsoleLib.dll

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-23T18:38:55.413

*   在您的 ConsoleApp 项目中，请参阅将在 ConsolApp\Bin 中接收 ConsolLib.dll 的 ConsolLib 项目。

*   现在在 ConsoleApp 项目中转到**PostBuild 命令**，您可以在其中指定您可能希望在构建后执行的操作，然后您可以将其复制到 ConsoleApp\Lib。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T18:52:09.370

您需要在应用程序项目中使用 postbuild 命令来创建 lib 目录并将库文件复制到其中。

如果你决定这样做（除非你有很多 dll 并且有强烈的组织它们的冲动，否则我不建议这样做）你还需要在你的 app.config 文件中添加一个探测路径元素，它会告诉它在哪里看对于图书馆。[见这里](http://msdn.microsoft.com/en-us/library/823z9h8w(VS.80).aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-05-18T09:13:29.847

使用 postbuild 命令（我在输出中使用 subdir “release”）

```
mkdir "$(TargetDir)release\"
mkdir "$(TargetDir)release\bin\"

copy "$(TargetDir)*.*" "$(TargetDir)release\"
copy "$(TargetDir)*.dll" "$(TargetDir)release\bin\"
copy "$(TargetDir)*.pdb" "$(TargetDir)release\bin\"  

del "$(TargetDir)release\*.pdb"
del "$(TargetDir)release\*.dll"
del "$(TargetDir)release\*vshost*.*" 
```

然后在 app.config 中：

```
<runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
        <probing privatePath="bin"/>
    </assemblyBinding>
</runtime> 
```

希望这可以帮助

# css - 为什么我的网站不使用 Tahoma 字体？

> ID：902120
> 
> 赞同：3
> 
> 时间：2009-05-23T18:21:37.207
> 
> 标签：css, fonts

我在 style.css 中设置了字体：

```
font-family: "Arial, Verdana, sans-serif"; 
```

但我的网站似乎仍然使用无衬线字体。这里有什么问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-23T18:24:21.990

CSS font-family 规范中的逗号需要在引号之外。

例如：

```
font-family: "Arial", "Verdana", sans-serif; /* And you should really 
omit the quotes if it's only one word */ 
```

不是

```
font-family: "Arial, Verdana, sans-serif"; 
```

否则，CSS 解析器会认为您正在寻找一种名为“Arial, Verdana, sans-serif”的字体，而这显然不存在。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-23T18:27:49.693

尝试从字体系列定义中删除您的“”：

```
font-family: tahoma, sans-serif; 
```

像那样。仅当您有多个单词时才使用“，例如

```
font-family: "mutiple word font name",tahoma, sans-serif; 
```

# javascript - 使用 Starbox（星级评分系统）插件时的原型 Ajax 功能帮助

> ID：902127
> 
> 赞同：0
> 
> 时间：2009-05-23T18:24:38.900
> 
> 标签：javascript, prototypejs

我在我的网站上使用[Starbox](http://www.nickstakenburg.com/projects/starbox/)插件，我想在访问者使用 AJAX 投票时发布投票值。我阅读了插件文档和教程，并且可以使用如下函数：

```
function myOnRate(element, memo) {
  new Ajax.Request('savestar.php', {
    parameters: memo,
    onComplete: function(xhr) {
      // optional callback
    }
  });
} 
```

现在我确实知道 PHP，但我并不真正了解 javascript 或 Prototype，我需要有关此功能的帮助。

我知道“元素”参数是评估者的 ID，而 savestar.php 是将使用 AJAX 调用的外部 php 文件。但除此之外，我不知道如何处理这个......

我想将投票值发送到 savestar.php，然后我将使用 POST 方法获取该值并将其插入数据库。我还需要发送“元素”，以便识别评估者。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-24T07:54:17.947

嗯....我自己找到了解决方案，所以这里是：

```
<script language='javascript' type='text/javascript'>

            function saveStar(event) {
                new Ajax.Request('savestar.php', {
                parameters: event.memo,
                onComplete: function(xhr) {
                    // optional callback
                }
                });
            }

            // observe just one
            document.observe('dom:loaded', function() { // once the DOM is loaded
                $('elementID').observe('starbox:rated', saveStar);
            });

            new Starbox('elementID', 8, { indicator: 'Rating: #{average} (#{total} votes)', total: 2 });

            </script> 
```

如果你正在阅读这篇文章，只是不明白，请给我发消息。

# sql - SQL SHA1 在 WHERE 中

> ID：902129
> 
> 赞同：2
> 
> 时间：2009-05-23T18:25:33.033
> 
> 标签：sql, mysql, sha1, where-clause, where

在我的程序中，我们将用户的 IP 地址存储在记录中。当我们向用户显示记录列表时，我们不想泄露其他用户的 IP，因此我们对其进行 SHA1 哈希处理。然后，当用户单击记录时，它会转到如下 URL：

```
http://www.example.com/allrecordsbyipaddress.php?ipaddress=SHA1HASHOFTHEIPADDRESS 
```

现在，我需要按 SHA1 哈希中指定的 IP 地址列出所有记录。我试过这个：

```
SELECT * FROM records 
WHERE SHA1(IPADDRESS)="da39a3ee5e6b4b0d3255bfef95601890afd80709" 
```

但这不起作用。我该怎么做？
谢谢，艾萨克·沃勒

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-23T19:12:26.723

不知道这是否重要，但您的`SHA1`哈希`da39a3ee5e6b4b0d3255bfef95601890afd80709`是空字符串的众所周知的哈希。

`IP`它只是一个示例还是您忘记向哈希计算函数提供实际地址？

**更新：**

您的网页代码是否生成`SHA1`小写的哈希？

此检查将失败`MySQL`：

```
SELECT  SHA1('') = 'DA39A3EE5E6B4B0D3255BFEF95601890AFD80709' 
```

在这种情况下，使用这个：

```
SELECT  SHA1('') = LOWER('DA39A3EE5E6B4B0D3255BFEF95601890AFD80709') 
```

，这将成功。

`SHA1`此外，您可以在将记录插入表时预先计算哈希：

```
INSERT
INTO    ip_records (ip, ip_sha)
VALUES  (@ip, SHA1(CONCAT('my_secret_salt', @ip))

SELECT  *
FROM    ip_records
WHERE   ip_sha = @my_salted_sha1_from_webpage 
```

这将为您返回原始文件`IP`并允许对 进行索引`ip_sha`，以便此查询可以快速运行。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-23T18:52:38.403

我会将 IP 的 SHA1 与原始 IP 一起存储在数据库中，以便查询变为

```
SELECT * FROM records WHERE ip_sha1 = "..." 
```

然后我会确保 SHA1 计算恰好*发生在代码中的一个地方*，这样就没有机会在多个地方稍微不同地完成它。这也让您有机会将盐混合到计算中，这样人们就不能简单地计算他们感兴趣的 IP 地址上的 SHA1 并手动传递。

将 SHA1 哈希存储在数据库中还可以让您有机会在 ip_sha1 上添加二级索引以加速该 SELECT。如果您有一个非常大的数据集，则在 WHERE 子句中执行 SHA1 会强制数据库执行完整的表扫描，并在每次扫描时为每条记录重做计算。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-23T18:39:24.773

每次我遇到意外的散列不匹配时，都是因为我不小心散列了一个包含一些空格的字符串，例如“ `\n`”。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-23T19:42:07.273

Just a quick thought: that's a very simple obfuscation. There are only 2^(32) possible IP addresses, so if somebody with technical knowledge wanted to figure it out, they could do that by calculating all 4 billion hashes, which wouldn't take very long. Depending on the sensitivity of those ip addresses, you may want to consider a private lookup table.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-23T18:38:29.177

您是否将哈希算法的输出与 MySQL 的 SHA1() 的输出进行了比较？例如 IP 地址 1.2.3.4？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-23T19:56:46.387

I ended up encrypting the IP addresses, and decrypting them on the other page. Then I can just use the raw IP address in the SQL query. Also, it protects against brute force attacks, like [Autocracy](https://stackoverflow.com/questions/902129/sql-sha1-inside-where/902305#902305) said.

# c# - 什么是条件同步？

> ID：902137
> 
> 赞同：5
> 
> 时间：2009-05-23T18:28:55.133
> 
> 标签：c#, synchronization, conditional-statements

有人可以向我解释条件同步吗？

一个例子（最好在 C# 中）也将不胜感激。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-23T19:49:09.520

听起来你的教授在谈论线程。线程使计算机程序一次可以做不止一件事。在一个已经运行的线程中启动一个新线程的行为被计算机程序员称为“启动一个线程”。

线程可以共享相同的内存空间。条件同步（或仅仅是同步）是保护内存区域不被两个不同线程同时修改的任何机制。

假设您外出购物，而妻子在家支付账单。这是一个幼稚的例子，它在现实生活中并没有真正以这种方式工作，但它可以作为一个简单的例子。

你的妻子正在网上支付账单。同时，您正在杂货店刷信用卡。这两种行为都涉及将资金从您的支票账户中转出。为了模拟这个活动，我们编写了以下代码：

```
public class MyBanking
{
    static double myAccountBalance;
    //
    public void DebitAccount(double debitAmount)
    {
        Console.Writeline("Your Old Balance is: " + myAccountBalance.ToString());
        Console.Writeline("Your Debit is:       " + debitAmount.ToString());
        myAccountBalance = myAccountBalance - amount;
        Console.Writeline("Your New Balance is: " + myAccountBalance.ToString());
    }
} 
```

假设您的妻子正在一个线程上运行此类的一个实例（“副本”），而您正在另一个线程上运行一个实例。myAccountBalance 变量被声明为静态变量，以允许它在两个正在运行的实例之间共享（您和您的妻子只有一个支票账户）。

您可以通过调用如下代码进行借记：

```
MyBanking bankingObject = new MyBanking();
bankingObject.DebitAccount(100); 
```

你的妻子同时扣款：

```
MyBanking bankingObject = new MyBanking();
bankingObject.DebitAccount(50); 
```

如果您的线程在您的旧余额打印到屏幕上之后，但在打印新余额之前被您妻子的线程中断，会发生什么？您妻子的线程从帐户中扣除，并将控制权返回给您的线程。你的妻子在屏幕上看到这个：

```
Your Old Balance is: 2000
Your Debit is:       50
Your New Balance Is: 1950 
```

当电脑在你的屏幕上打印新的余额时，它是错误的，因为你妻子的借记也会被计算在内。你会看到这样的东西：

```
Your Old Balance is: 2000
Your Debit is:       100
Your New Balance Is: 1850 
```

为了解决这个问题，我们用 lock 语句包围我们的方法代码。lock 语句**导致所有其他线程等待我们的实例完成。**新代码如下所示：

```
public class MyBanking
{
    static double myAccountBalance;
    //
    public void DebitAccount(double debitAmount)
    {
        lock (this)
        {
            Console.Writeline("Your Old Balance is: " + myAccountBalance.ToString());
            Console.Writeline("Your Debit is:       " + debitAmount.ToString());
            myAccountBalance = myAccountBalance - amount;
            Console.Writeline("Your New Balance is: " + myAccountBalance.ToString());
        }
    }
} 
```

你妻子的线程现在将在你妻子的代码开始执行之前等待你在 lock 语句中的代码完成执行。您的新余额现在将是正确的，因为在您完成交易时，您妻子的线程不再可能更改余额。在您的屏幕上，您现在将看到：

```
Your Old Balance is: 2000
Your Debit is:       100
Your New Balance Is: 1900 
```

你的妻子会看到这个：

```
Your Old Balance is: 1900
Your Debit is:       50
Your New Balance Is: 1850 
```

这是同步。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-23T19:07:19.870

基本上它是需要的线程的设计模式

a) 同步访问资源

b) 有时会等待其他线程，直到满足某个条件

您在 C# 上下文中提出此问题，.NET 使用 Monitor.Wait 和 Monitor.Pulse（以及围绕各种 Win32 对象的包装器，如 WaitEventhandle）提供对此的支持。

这是关于 SO的一个很好的[队列示例。](https://stackoverflow.com/questions/530211/creating-a-blocking-queuet-in-net)

主要技术细节如下：

```
lock(buffer)  // is Monitor.Enter(buffer) ... finally Monitor.Leave(buffer)
{
   while (buffer.Count < 1)
   {
      Monitor.Wait(buffer); 
   }
   ...
} 
```

请注意那里是如何锁定等待的。它看起来像死锁，但 Wait 会在等待时释放锁。内部的代码在`lock() { }`运行时仍然具有对缓冲区的独占访问权限。

然后另一个线程必须在将某些内容放入缓冲区时发出信号：

```
Monitor.Pulse(buffer); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-02-26T17:02:30.567

上面的代码几乎是正确的，但实际上是错误的。通过使用`lock(this)`，您将只锁定您的`MyBanking`类实例，但您的妻子将锁定她的。要锁定对共享变量的访问，您可以锁定类型（即`lock(typeof(MyBanking))`），或者您可以引入一个新的共享变量并锁定它（您不能锁定一个 int 所以通常人们按如下方式创建一个对象。

```
class MyBanking
{
    static object lockObj = new object();
    static double myAccountBalance;
    public void DebitAccount(double debitAmount)
    {
        lock (lockObj) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-11-06T21:09:55.093

同步已经清楚地解释过了。但是，***条件同步***明确规定进程/线程*仅*在满足某些条件后才执行。通常，条件是某个其他进程/线程已经执行。

在借记帐户和查看余额的给定示例中。如果查看您的余额是一种单独的同步方法，并且我们只想在您的帐户被扣款后查看余额，那么这将需要条件同步。

[生产者-消费者问题](http://en.wikipedia.org/wiki/Producer%E2%80%93consumer_problem)很好地描述了条件同步。

# asp.net - 母版页中的 webpart 控件

> ID：902139
> 
> 赞同：0
> 
> 时间：2009-05-23T18:30:06.787
> 
> 标签：asp.net, user-controls, master-pages, web-parts

我在网页上使用的控件中有一个 web 部件。该网页使用母版页，并且 MP 中有一个内容持有者，可以控制对齐/设计问题。除了 webpart 控件之外，一切都很好。当我将 webpart 放入容器时，我失去了移动 webpart 的能力，但是一旦我将它移出容器，它就可以正常工作。

默认.aspx

```
/// <summary>
        /// Set the selected item equal to the current display mode.
        /// </summary>
        /// <param name="sender"></param>
        /// <param name="e"></param>
        public void Page_PreRender(object sender, EventArgs e)
        {
            MyWebPartManager wpm = (MyWebPartManager)WebPartManager.GetCurrentWebPartManager(Page);

            Control control = (Control)Master.FindControl("divReturnBack");
            if (control != null)
            {
                control.Visible = true;
                control.Controls.Add(DisplayModeMenul1);
            }
        } 
```

显示模式.ascx

```
MyWebPartManager webPartManager;

        public void Page_Init(object sender, EventArgs e)
        {
            Page.InitComplete += new EventHandler(InitComplete);
        }
        public void InitComplete(object sender, System.EventArgs e)
        {
            webPartManager = (MyWebPartManager)WebPartManager.GetCurrentWebPartManager(Page);
            String browseModeName = WebPartManager.BrowseDisplayMode.Name;

            foreach (WebPartDisplayMode mode in
              webPartManager.SupportedDisplayModes)
            {
                String modeName = mode.Name;
                if (mode.IsEnabled(webPartManager))
                {
                    ListItem listItem = new ListItem(modeName, modeName);
                    ddlDisplayMode.Items.Add(listItem);
                }
            }
        }

        public void ddlDisplayMode_SelectedIndexChanged(object sender, EventArgs e)
        {
            String selectedMode = ddlDisplayMode.SelectedValue;

            WebPartDisplayMode mode = webPartManager.SupportedDisplayModes[selectedMode];
            if (mode != null)
            {
                webPartManager.DisplayMode = mode;
            }
        }

        public void Page_PreRender(object sender, EventArgs e)
        {
            ListItemCollection items = ddlDisplayMode.Items;
            int selectedIndex = items.IndexOf(items.FindByText(webPartManager.DisplayMode.Name));
            ddlDisplayMode.SelectedIndex = selectedIndex;
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-23T19:10:10.973

我将此代码移到回发部分之外，现在可以正常工作。

```
// move to container in masterpage
            Control control = (Control)Master.FindControl("divReturnBack");
            if (control != null)
            {
                control.Visible = true;
                control.Controls.Add(DisplayModeMenul1);
            } 
```

# enterprise - 如何提高企业应用的质量？

> ID：902140
> 
> 赞同：4
> 
> 时间：2009-05-23T18:30:30.093
> 
> 标签：enterprise

我使用过的许多企业应用程序让我感到非常沮丧，无论是糟糕的 UI/UX、迟缓，还是为了完成简单的事情而跳槽。这与我使用的开源应用程序完全不同。你有什么问题，你认为是什么导致了问题？如何改进它们？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-23T19:12:21.827

从从事企业应用程序的开发人员那里听到这种说法很常见：

*   无论如何它将在 Intranet 上，因此带宽不是问题。我们不要把时间浪费在优化和缓存上。
*   如果负载变高，我们将只添加另一个 Web 服务器。无论如何，整个组织是 15K 用户。
*   最古老的机器是 1.6Ghz 双核，所以我们不要在性能上浪费时间
*   这个界面有点复杂，但菲尔说会计方面的人很聪明。他将在本周五进行 5 小时的培训课程，向他们解释使用方法

传统的 Web 应用程序没有培训课程。它们专为最小公分母而设计。他们的目标是优化客户端，更重要的是服务器资源。用户群的规模没有真正的上限，达到 10 万用户是一种享受。而来自用户的批评通常等同于损失直接损失。

另一个问题是公司通常会为软件产品签订合同，而软件团队通常只是为了交付“要求”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T19:01:16.653

企业免受开源项目面临的批评，在许多情况下是由高层管理人员推动的集体。当一位高管在飞机上看到主流出版物上的一篇文章时，大多数举措都是由“阅读”优势推动的，然后过来并让他们所管理的部门的笼子嘎嘎作响。通常会成立一个称为“团队”的委员会，他们会定期开会，而不是在他们决定自己无法处理风险、需要客观意见或有时无法做出决定时，聘请顾问来提供“项目”。

有时，当您拥有一个可以推翻执行官的意愿或挑战前提的充满活力的团队时，此过程会很好地工作。强大的团队动力可以缩短分析周期，在某些情况下可以生产出好的产品。很多时候，团队成员只是默许高管的一时兴起，自己不做任何决定，只为实现高管的愿景而努力。没有反抗，没有反馈，只是将常识服从于指导他们的集体蜂巢母亲。

正如你所看到的，费用不是由生产性工作产生的——它是由一系列对合作的个人降神崇拜造成的。由于该项目花费了很长时间并增加了费用，因此您必须接受结果。多年来或直到高管继续前进。

如果您有兴趣完成伟大的事情，那么已经发现这一点的公司就是您想要工作的地方。或者，如果您想要一份咨询工作，在那里您可以获得很多报酬并且没有太多风险，那么它们可能是一个很好的工作场所。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-23T19:20:31.263

有很多方面，但我相信最终的根本原因是，企业项目不可避免地既没有被使用该应用程序的人请求、出售，也没有被接受。

结果，它们被高估以保证 CxO 注意力水平的预算，由于需要消耗预算的庞大团队而无法控制，“处理”到死亡以保持令人难以置信的臃肿团队忙碌，被肢解并无休止地变得无法使用涵盖由于快乐的阳光传递估计而导致的屁股大战，如果由 5 只白色乌鸦组成的团队处理 80% 的最高价值，这将相当有效，但是对于 100 名古怪的顾问来说，在永无止境的堑壕战中松懈 0 进展，而 5 级报告层次结构紧张地绿色 将新闻向上转移，直到整个努力被悄悄放弃，因为大量资金付诸东流现在已经足够重要了，即使是客户也不想承担承担整个惨败的公关风险。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-23T19:04:13.637

信不信由你，我确切地知道你的感受。:-) 可能只有一个（政治正确的）建议：[吃你的狗粮](http://www.google.com/search?hl=sk&q=eat+your+dog+food&lr=&aq=f&oq=)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-23T19:10:19.023

让他们去以前没有人去过的地方！

哈哈。但实际上，我认为问题在于过于激进的截止日期、缺乏适当的设计和缺乏沟通。

# wpf - 移动到收藏的新记录

> ID：902143
> 
> 赞同：0
> 
> 时间：2009-05-23T18:31:50.963
> 
> 标签：wpf, vb.net, collections, record

我刚刚开始使用集合（ObservableCollections），并且遇到了我认为很容易的一堵墙。我敢肯定这很容易，但我只是找不到答案。

我有一个 WPF 屏幕，左侧是 DataGrid，右侧是 TextBox。DataGrid 绑定到 ObservableCollection (Activities)，我可以上下单击 DataGrid 并看到我的 TextBoxes 刷新了正确的信息。然后我可以更改文本框中的信息并将其保存回数据库。一切正常！

但是，在向集合中添加记录时，我不知道正确的方法。我正在使用如下所示的 Add 方法，但是如何移动到这个新创建的记录以便可以对其进行编辑？我已经尝试了十几种方法，但我还没有找到正确的方法。文本框只关注最后编辑的记录。有任何想法吗？

```
Private Activities As ObservableCollection(Of ActivityRecord)

Private Sub AddMode()
    Dim _ActivityRecord As New ActivityRecord(0, DateTime.Now, Nothing, "", gWorkerID, "")
    Activities.Add(_ActivityRecord)
'Code to move to the newly created record should go here 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-23T19:58:43.357

在 WPF 中，每个 ItemsControl 派生控件（列出您的 DataGrid）都*秘密*使用 CollectionView 的派生类来促进记录/项目之间的导航 - 实际上，它是提供*货币*机制的类，可帮助其他控件（如文本框）确定哪些数据绑定项目是*当前的*。

如果您创建一个新对象并将其添加到您的 ObservableCollection，您可以使用 CollectionView 的 MoveXXX 方法之一移动以使该项目成为当前项目。您可以（取决于您获得的 CollectionView 类型）也可以调用 CollectionView 上的 Add 方法，它会自动调用底层 ObservableCollection 上的 Add 方法。

无论哪种方式，检索对 CollectionView 的引用都是秘密。您可以使用 CollectionView 的静态方法（我忘记它的名称）来检索用于 DataGrid 的视图，或者（这是我的首选方法）您可以显式创建一个 ListCollectionView 并将您的 DataGrid 绑定到它，而不是 ObservableCollection .

# collision-detection - 游戏应该只依赖帧率吗？

> ID：902147
> 
> 赞同：3
> 
> 时间：2009-05-23T18:34:19.993
> 
> 标签：collision-detection

我想听听你对这个问题的建议......

为简单起见，我将只考虑 x 轴。

对位置 10 的对象进行成像，其宽度也为 10 个单位，每秒向前移动 100 个单位，并且由于低帧，每次更新时它应该移动 80 个单位。

在调用第一次更新后，它的位置现在是 90，并且在位置 120 处还有另一个相同大小的对象。

下一次更新，会将对象移动到位置 170。考虑到我需要实现碰撞检测，计算更新之前或之后的碰撞，没有一个会起作用。

现在来一个简单的问题...

在这种情况下该怎么办？

执行以下操作：

```
Position start = destinationPos - currentPos;
for (int i; i < start; i++)
    if (IsColliding(movingObj.Position + i, staticObj))
        //do the colliding stuff here 
```

我不喜欢这个解决方案，在这种情况下可能没问题，但是如果你有 x、y、z 和很多移动物体怎么办？

我认为另一个很好的解决方案，但我不确定它是否可靠，是让另一个线程在一个循环中执行所有这些计算。

这个线程就像一个无限循环，在每次迭代中，我都会计算`elapsedTime`我认为会非常小的值并继续移动并计算碰撞，而渲染线程会慢得多，它会得到当前状态的对象，只是渲染它。

你们怎么看？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-23T18:43:04.113

幸运的是，对于我们这些数学白痴来说，这个问题或多或少已经得到了解决。您描述的问题是通过*动态*碰撞检测解决的，该检测用于确定两个对象是否在帧之间发生碰撞，并且对于某些类型的碰撞甚至可以准确地告诉您*碰撞*发生的时间，因此您可以更新世界的状态正确。

如果您对自己实现碰撞检测算法不是特别感兴趣，我会考虑使用已经完成此类事情的库：

*   [子弹物理引擎](http://www.bulletphysics.com/Bullet/wordpress/)
*   [G3D](http://g3d-cpp.sourceforge.net/)
*   [几何工具](http://www.geometrictools.com/)

很多关于这个主题的好书之一是[实时碰撞检测](http://realtimecollisiondetection.net/)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-23T19:17:37.370

Mike Daniels 谈到了这一点，但您的回答是否定的：您不想将您的对象视为在离散的“爆发”中移动。让我们在 1d 中举个例子：一辆汽车从 x = 0 开始，向前加速 2 个单位/秒^2。您不会重新计算每一帧的速度和位置。相反，您将使用一些简单的微积分：速度是加速度的积分，位置是加速度的积分。因此 v =`2*t`和 p = `t^2`。然后，您要做的就是根据自初始条件以来经过的时间来替换 t。

现在假设您在位置 100 有第二个物体，以 -3 个单位/秒^2 的速度加速。那么它的速度是`-3*t`，它的位置是`100 - (3/2)*t^2`。求解两个位置何时相等，我们可以看到它们在 t = 40 时发生碰撞。

然后，使用方程式，您可以查看帧之间是否发生碰撞。有几个框架甚至可以为您执行此操作，但对它的工作原理有基本的了解很重要。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-23T21:11:16.393

这是一个附带问题，但您可能会发现值得将逻辑更新速率与游戏的帧速率分离，并为物理和逻辑设置一个固定的时间步长。它使许多物理和碰撞的东西变得更简单，并在帧速率下降时阻止事物爆炸。

[Glenn Fiedler 的网站](http://gafferongames.com/game-physics/fix-your-timestep/)有一个以这种方式工作的游戏循环示例。就个人而言，如果可以选择，我总是会选择固定费率更新。它只是简化了很多事情，尤其是在物理学方面。

# c# - 如何保持进程在远程 Windows 服务器上运行

> ID：902152
> 
> 赞同：4
> 
> 时间：2009-05-23T18:36:50.583
> 
> 标签：c#, asp.net, multithreading, process

我需要实现一个在远程 Windows 服务器 24/7 上运行的后台进程。我的开发环境是 C#/ASP.NET 3.5。该过程的目的是：

*   在适当的时间向员工和客户发送提醒电子邮件（比如安排工作前一天的下午 5:00）
*   在员工应该外出工作时查询并保存他们的 GPS 坐标，以便我以后可以验证他们的位置是否在他们应该在的位置。

如果进程失败（它可能会失败，尤其是在添加更新时），我需要立即（或在几分钟内）重新启动它，因为如果此进程未能发送通知，我将遇到非常严重的问题，记录GPS 坐标，或它要执行的任何其他任务。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-23T23:47:26.700

1.  将您的流程实现为 Windows 服务。有关如何在 .Net 中编写 Windows 服务的简单示例，请参见[http://www.developer.com/net/csharp/article.php/2173801](http://www.developer.com/net/csharp/article.php/2173801)。

2.  要控制服务失败时发生的情况，请通过 services.msc 中服务上的“恢复”选项卡进行配置。（见下图）

3.  对于高度关键的操作，您可能会考虑设置一个服务器集群以减轻单个服务器故障（请参阅[http://msdn.microsoft.com/en-us/library/ms952401.aspx](http://msdn.microsoft.com/en-us/library/ms952401.aspx)）。

[![替代文字](https://i.stack.imgur.com/nFrdY.gif)](https://i.stack.imgur.com/nFrdY.gif)
[（来源：[microsoft.com](https://technet.microsoft.com/en-us/library/Bb742520.ssvc104_big(en-us,TechNet.10).gif)）]

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-23T18:42:09.420

您需要一个 Windows 服务。您可以在 Windows 服务中进行非可视化的迭代操作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-23T18:51:20.217

另一种选择是创建一个普通的应用程序并按计划运行它。您的应用程序每天在特定时间运行以执行其操作，具体取决于您需要记录 GPS 坐标和发送报告的频率。如果您的服务不需要持续运行，这通常是推荐的方法，因为服务应该仅限于始终在线的应用程序。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-23T18:49:53.353

除了作为服务之外，您可能还希望在集群上运行，并使集群管理软件知道您的服务。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-23T18:57:32.683

您可以创建 Windows 服务（Windows 上的服务器编程）或使用调度程序定期执行任务。

根据对高可用性的要求，程序可以安装在故障转移集群上，如果第一个（主动节点）死了，其他服务器（被动节点）将启动并作为热备份静静地等待。这是一个广泛的话题。从Wikipedia上的[高可用性](http://en.wikipedia.org/wiki/High_availability)开始。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-24T00:26:07.480

根据我的经验，如果您需要 24x7 全天候运行，则需要（一个或多个）看门狗进程来验证您的服务是否正常运行。仅仅依靠正常的服务框架并不能保证程序正常工作——即使它看起来正在运行。看门狗程序（也是一项服务）可以自动查询服务，例如发布消息检查响应时间、查询统计信息等 - 当它检测到问题时，它可以重新启动服务（或进行其他一些故障恢复）

有一个看门狗程序而不是仅仅依靠用户查询来检测错误的原因是它可以自动完成。这是首选方法，因为它允许主动检测。

# windows-vista - 如何快速启用/禁用监视器？

> ID：902154
> 
> 赞同：0
> 
> 时间：2009-05-23T18:37:54.777
> 
> 标签：windows-vista, multiple-monitors

是否有任何替代 UltraMon 能够快速打开和关闭屏幕的方法。

我正在使用多台显示器，但有一个软件的功能在启用两台显示器时不起作用。

Windows Vista、nvidia，目前使用的是 windows 控制面板。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-23T18:50:53.587

您可以使用任何自动化软件来操作控制面板。我自己喜欢[AutoIT](http://www.autoitscript.com/AutoIt/)

顺便提一句。这真的是一个编程问题吗？如果是这样，我建议修复软件而不是寻找 hacky 解决方法。如今，多台和/或大型显示器变得非常流行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T18:41:43.633

我发现打开/关闭外接显示器的最简单方法是使用 Windows 自己的控制面板。我有一个带两台显示器的工作站，但其中一台兼作笔记本电脑的外接显示器。当我的笔记本电脑需要它时，我只需使用控制面板将其关闭（右键单击桌面并选择“属性”）。

# flash - 有什么方法可以从基于 Flash 的网站中提取文本？

> ID：902172
> 
> 赞同：1
> 
> 时间：2009-05-23T18:43:22.163
> 
> 标签：flash, string

我想使用 Last.FM 的 API 为 Grooveshark 编写一个 scrobbling 实用程序，但我不知道是否可以从 Grooveshark 的 Flash 前端获取歌曲信息。有没有办法从 .swf 中获取字符串？

我会发布更多信息，但由于我是新用户，我还不能发布链接。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-23T18:49:32.840

奇怪的是歌曲信息没有嵌入在 SWF 中，而是通过 HTTP 调用传递，以 XML 或 AMF 编码。您可以使用 Web 调试代理来检查通过网络传输的信息。Charles 是一个很棒的工具，它同时支持 XML 和 AMF 编码。

[http://www.charlesproxy.com/](http://www.charlesproxy.com/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T18:48:11.937

我不认为有任何可能这样做。Flash 文件是独立的嵌入对象，其中包含自身的所有内容。您可以尝试搜索 Flash 文件解码器以从 Flash 编译文件中提取数据，但我不建议这种做法。

谢谢。

# c# - HttpHandler 返回零长度字节 []

> ID：902183
> 
> 赞同：1
> 
> 时间：2009-05-23T18:48:45.087
> 
> 标签：c#, .net, asp.net, web-services, httphandler

我有一个自定义 HttpHandler 调用 web 服务来获取文件。在测试中，我调用了生产 web 服务并且 HttpHandler 正确地返回了文件。当我在服务器上的生产环境中对其进行测试时，它也可以正常工作。但是，如果我从远程客户端（不在服务器上）调用 HttpHandler，则文件名和大小设置正确，但下载的文件字节为零。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-23T19:20:18.643

所以这是交易。我创建了一个[多部分范围处理程序](http://labs.apache.org/webarch/http/draft-fielding-http/p5-range.html)（您需要实现 RFC 才能将内容流式传输到 iPhone 或 Adob​​e Reader）。该规范假设在客户端请求一个字节范围而不是整个数组时启用处理文件。当客户想要整个 BLOB 时，我的处理程序出现了问题：

```
if (context.Request.Headers[HEADER_RANGE] != null)
{
  ...
}
else
{
    context.Response.ContentType = contentItem.MimeType;
    addHeader(context.Response, HEADER_CONTENT_DISPOSITION, "attachment; filename=\"" + contentItem.Filename + "\"");
    addHeader(context.Response, HEADER_CONTENT_LENGTH, contentItem.FileBytes.Length.ToString());
    context.Response.OutputStream.Write(contentItem.FileBytes, 0, contentItem.FileBytes.Length);
} 
```

注意有什么遗漏？？？

我忘了包括：

```
context.Response.Flush(); 
```

添加那行代码后，它开始在生产环境中工作。然而，我觉得这很奇怪，这是在服务器上而不是在任何客户端上工作的。任何人都能够阐明为什么会这样？

# python - Django，自定义模板过滤器 - 正则表达式问题

> ID：902184
> 
> 赞同：2
> 
> 时间：2009-05-23T18:48:57.177
> 
> 标签：python, regex, django, django-templates

我正在尝试在 Django 中实现一个 WikiLink 模板过滤器，它查询数据库模型以根据页面的存在给出不同的响应，与维基百科的红色链接相同。过滤器不会引发错误，而是不对输入做任何事情。

**WikiLink**定义为：`[[ThisIsAWikiLink | This is the alt text]]`

这是一个不查询数据库的工作示例：

```
from django import template
from django.template.defaultfilters import stringfilter
from sites.wiki.models import Page
import re

register = template.Library()

@register.filter
@stringfilter
def wikilink(value):
    return re.sub(r'\[\[ ?(.*?) ?\| ?(.*?) ?\]\]', r'<a href="/Sites/wiki/\1">\2</a>', value)
wikilink.is_safe = True 
```

输入( ) 是一个多行字符串，包含 HTML 和许多 WikiLink **。**`value`

预期**输出**替换`[[ThisIsAWikiLink | This is the alt text]]`为

*   `<a href="/Sites/wiki/ThisIsAWikiLink">This is the alt text</a>`

    **或者**如果数据库中不存在“ThisIsAWikiLink”：

*   `<a href="/Sites/wiki/ThisIsAWikiLink/edit" class="redlink">This is the alt text</a>`

和返回值。

这是非工作代码（根据评论/答案进行编辑）：

```
from django import template
from django.template.defaultfilters import stringfilter
from sites.wiki.models import Page
import re

register = template.Library()

@register.filter
@stringfilter
def wikilink(value):
    m = re.match(r'\[\[ ?(.*?) ?\| ?(.*?) ?\]\]', value)

    if(m):
        page_alias = m.group(2)
        page_title = m.group(3)
        try:
            page = Page.objects.get(alias=page_alias)
            return re.sub(r'(\[\[)(.*)\|(.*)(\]\])', r'<a href="Sites\/wiki\/\2">\3</a>', value)
        except Page.DoesNotExist:
             return re.sub(r'(\[\[)(.*)\|(.*)(\]\])', r'<a href="Sites\/wiki\/\2\/edit" class="redlink">\3</a>', value)
    else:
        return value
wikilink.is_safe = True 
```

代码需要做的是：

*   *提取价值*中的所有 WikiLinks
**   查询*Page*模型以查看页面是否存在*   用普通链接替换所有 WikiLink，其样式取决于每个 wikipage 的存在。*   返回更改后的*值**

 *更新后的问题是：什么正则表达式（方法）可以返回一个 WikiLinks 的 python 列表，可以更改并用于替换原始匹配项（更改后）。

编辑：

我想做这样的事情：

```
def wikilink(value):
    regex = re.magic_method(r'\[\[ ?(.*?) ?\| ?(.*?) ?\]\]', value)

    foreach wikilink in regex:
         alias = wikilink.group(0)
         text = wikilink.group(1)

         if(alias exists in Page):
              regex.sub("<a href="+alias+">"+ text +"</a>")
         else:
              regex.sub("<a href="+alias+" class='redlink'>"+ text +"</a>")

    return value 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-23T19:28:33.963

如果您的字符串包含除 wiki 链接之外的其他文本，则您的过滤器将不起作用，因为您使用`re.match`的是`re.search`. `re.match`匹配字符串的开头。`re.search`匹配字符串中的任何位置。请参阅[匹配与搜索](http://docs.python.org/library/re.html#matching-vs-searching)。

此外，您的正则表达式使用 greedy `*`，因此如果一行包含多个 wiki 链接，它将不起作用。改为`*?`使其不贪心：

```
re.search(r'\[\[(.*?)\|(.*?)\]\]', value) 
```

编辑：

至于如何修复代码的提示，我建议您使用[`re.sub`with a callback](http://docs.python.org/library/re.html#re.sub)。优点是：

*   如果您在同一行中有多个 wiki 链接，它可以正常工作。
*   一次通过字符串就足够了。您不需要通行证来查找 wiki 链接，也不需要通行证来进行替换。

这是实现的草图：

```
import re

WIKILINK_RE = re.compile(r'\[\[(.*?)\|(.*?)\]\]')

def wikilink(value):
  def wikilink_sub_callback(match_obj):
    alias = match_obj.group(1).strip()
    text = match_obj.group(2).strip()
    if(alias exists in Page):
      class_attr = ''
    else:
      class_attr = ' class="redlink"'
    return '<a href="%s"%s>%s</a>' % (alias, class_attr, text)

  return WIKILINK_RE.sub(wikilink_sub_callback, value) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-23T19:24:19.913

这种类型的问题很快就会落到一小组单元测试中。

可以单独测试的过滤器部分（通过一些代码重组）：

*   确定 value 是否包含您正在寻找的模式
*   如果有匹配的页面会生成什么字符串
*   生成的字符串是没有匹配的页面

这将帮助您找出问题所在。您可能会发现您需要重新连接正则表达式以考虑 | 周围的可选空格。

此外，乍一看，您的过滤器似乎是可利用的。您声称结果是安全的，但您没有过滤 alt 文本以查找诸如脚本标签之类的讨厌内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-23T21:57:04.490

代码：

```
import re

def page_exists(alias):
    if alias == 'ThisIsAWikiLink':
        return True

    return False

def wikilink(value):
    if value == None:
        return None

    for alias, text in re.findall('\[\[\s*(.*?)\s*\|\s*(.*?)\s*\]\]',value):
        if page_exists(alias):
            value = re.sub('\[\[\s*%s\s*\|\s*%s\s*\]\]' % (alias,text), '<a href="/Sites/wiki/%s">%s</a>' % (alias, text),value)            
        else:
            value = re.sub('\[\[\s*%s\s*\|\s*%s\s*\]\]' % (alias,text), '<a href="/Sites/wiki/%s/edit/" class="redtext">%s</a>' % (alias, text), value)

    return value 
```

样本结果：

```
>>> import wikilink
>>> wikilink.wikilink(None)
>>> wikilink.wikilink('')
''
>>> wikilink.wikilink('Test')
'Test'
>>> wikilink.wikilink('[[ThisIsAWikiLink | This is the alt text]]')
'<a href="/Sites/wiki/ThisIsAWikiLink">This is the alt text</a>'
>>> wikilink.wikilink('[[ThisIsABadWikiLink | This is the alt text]]')
'<a href="/Sites/wiki/ThisIsABadWikiLink/edit/" class="redtext">This is the alt text</a>'
>>> wikilink.wikilink('[[ThisIsAWikiLink | This is the alt text]]\n[[ThisIsAWikiLink | This is another instance]]')
'<a href="/Sites/wiki/ThisIsAWikiLink">This is the alt text</a>\n<a href="/Sites/wiki/ThisIsAWikiLink">This is another instance</a>'
>>> wikilink.wikilink('[[ThisIsAWikiLink | This is the alt text]]\n[[ThisIsAWikiLink | This is another instance]]') 
```

普通的留言：

*   *findall*是您正在寻找的神奇重新功能
*   更改*page_exists*以运行您想要的任何查询
*   容易受到 HTML 注入的影响（如上面 Dave W. Smith 所述）
*   每次迭代都必须重新编译正则表达式是低效的
*   每次查询数据库效率低下

我认为使用这种方法你会很快遇到性能问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-24T01:38:17.600

如果有人需要，这是工作代码：

```
from django import template
from django.template.defaultfilters import stringfilter
from sites.wiki.models import Page
import re

register = template.Library()

@register.filter
@stringfilter
def wikilink(value):
  WIKILINK_RE = re.compile(r'\[\[ ?(.*?) ?\| ?(.*?) ?\]\]')

  def wikilink_sub_callback(match_obj):
    alias = match_obj.group(1).strip()
    text = match_obj.group(2).strip()

    class_attr = ''
    try:
        Page.objects.get(alias=alias)
    except Page.DoesNotExist:
        class_attr = ' class="redlink"'
    return '<a href="%s"%s>%s</a>' % (alias, class_attr, text)

  return WIKILINK_RE.sub(wikilink_sub_callback, value)
wikilink.is_safe = True 
```

非常感谢所有的答案！

# zend-framework - 使用 Zend Lucene 搜索未找到任何命中

> ID：902190
> 
> 赞同：0
> 
> 时间：2009-05-23T18:50:50.200
> 
> 标签：zend-framework, search, lucene

因此，我一直在编写一个爬虫脚本，以使用 Zend Lucene 搜索来索引我网站上的所有页面。我已经能够让脚本工作，但由于某种原因在页面上找不到其他链接。问题似乎出在脚本遇到 find 方法时：

```
$hits = $index->find('url:'.$targets[$i]); 
```

当我执行脚本时，数组中没有命中，因此爬虫仅索引起始 URI。关于我可以尝试什么的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T18:56:36.563

有一个工具可以查看 lucene 索引，它可以让您查看正在索引的内容。[Luke](http://www.getopt.org/luke/)应该让您查看已编入索引的内容并测试一些搜索。

您确定在创建索引时 url 字段已编入索引，您可能只是存储信息而不是可搜索：

addField(Zend_Search_Lucene_Field::UnIndexed

不会被找到，因为它没有被索引

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-20T17:26:13.330

如果您的索引中有数字，这将有所帮助。

要识别数字，请使用： Zend_Search_Lucene_Analysis_Analyzer::setDefault(new Zend_Search_Lucene_Analysis_Analyzer_Common_TextNum_CaseInsensitive()); 作为默认分析器。有关更多信息，请参阅 [http://framework.zend.com/manual/en/zend.search.lucene.extending.html](http://framework.zend.com/manual/en/zend.search.lucene.extending.html)

# ruby - 如何从短网址获取长网址？

> ID：902192
> 
> 赞同：7
> 
> 时间：2009-05-23T18:51:15.643
> 
> 标签：ruby, url, bit.ly, short

使用 Ruby，如何将短 URL（tinyURL、bitly 等）转换为相应的长 URL？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-23T19:01:09.493

我不使用 Ruby，但一般的想法是向服务器发送一个 HTTP HEAD 请求，然后服务器将返回一个 301 响应（永久移动），`Location`其中包含 URI 的标头。

```
HEAD /5b2su2 HTTP/1.1
Host: tinyurl.com
Accept: */* 
```

回复：

```
HTTP/1.1 301 Moved Permanently
Location: http://stackoverflow.com
Content-type: text/html
Date: Sat, 23 May 2009 18:58:24 GMT
Server: TinyURL/1.6 
```

这比打开实际 URL 快得多，而且您并不想获取重定向的 URL。它还与 tinyurl 服务配合得很好。

查看 ruby​​ 中的任何 HTTP 或 curl API。这应该相当容易。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-23T21:15:20.800

您可以使用 httpclient ruby​​gem 来获取标头

```
#!/usr/bin/env ruby

require 'rubygems'
require 'httpclient'

client = HTTPClient.new

result = client.head(ARGV[0])
puts result.header['Location'] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-09T09:31:52.787

Python 中的 bitly API 有一个很棒的包装器： [http ://code.google.com/p/python-bitly/](http://code.google.com/p/python-bitly/)

所以 Ruby 一定有类似的东西。

# objective-c - 涉及绑定时如何覆盖 NSError 表示？

> ID：902194
> 
> 赞同：7
> 
> 时间：2009-05-23T18:51:40.870
> 
> 标签：objective-c, cocoa, core-data, error-handling, cocoa-bindings

我在 Cocoa Bindings 中一直遇到的一件事是错误呈现，例如，当用户在附加了格式化程序的文本字段中键入错误值时。通常我会覆盖`willPresentError:`响应程序链中的某个位置，但我的问题是 Bindings 系统创建的 NSError 对象没有包含足够的信息来告诉我失败的原因，或者它是否是我有兴趣自定义的错误。当验证问题发生时，我可以完全从方程式中删除绑定并创建自己的错误，但我觉得我会以这种方式扔掉一些有用的东西。

我已经能够通过实现 NSControl 委托方法并将失败的控件存储在我的视图控制器中的实例变量中来解决这个问题。如果到时候它不是零`willPresentError:`，我知道什么无法验证。

```
- (BOOL)control:(NSControl *)control didFailToFormatString:(NSString *)string errorDescription:(NSString *)error;
{
    _errorSender = [control retain];
    return NO;
}

- (NSError *)willPresentError:(NSError *)error;
{
    if ( _errorSender != nil )
    {
        NSMutableDictionary *userInfo = [NSMutableDictionary dictionaryWithDictionary:[error userInfo]];
        NSString *help = NSLocalizedString( @"Why are you always messing up? You are a terrible person.", @"" );

        [_errorSender release];
        _errorSender = nil;
        [userInfo setObject:help forKey:NSLocalizedRecoverySuggestionErrorKey];

        return [NSError errorWithDomain:[error domain] code:[error code] userInfo:userInfo];
    }

    return [super willPresentError:error];
} 
```

这在第一响应者更改时有效，但在我调用`commitEditing`视图控制器时无效，所以它对我来说只是部分有用。

我能看到的唯一其他选择是将 NSFormatter 排除在外，并`validateValue:forKey:error:`在我的 Core Data 托管对象中使用来处理验证。这对我来说没有使用格式化程序那么有意义，但至少我可以完全控制 NSError 对象。

我觉得我必须遗漏一些东西才能与错误处理产生这种脱节。有什么建议么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-23T19:39:01.570

> 当验证问题发生时，我可以完全从方程式中删除绑定并创建自己的错误，但我觉得我会以这种方式扔掉一些有用的东西。

您可以使用`NSUnderlyingErrorKey`将一个错误（该键的对象）包装在另一个错误（`userInfo`包含该键的错误）中。

> 我能看到的唯一其他选择是将 NSFormatter 排除在外，并在我的核心数据托管对象中使用 validateValue:forKey:error: 来处理验证。这对我来说没有使用格式化程序那么有意义，但至少我可以完全控制 NSError 对象。

这是两个独立的级别，它们并不相互排斥。格式化程序验证在视图层；键值验证（在这种情况下，在您的托管对象中）位于模型层。

如果有问题的验证应该发生在视图层，请将您的 NSFormatter 类子类化（如果您还没有）并实现`getObjectValue:forString:errorDescription:`以返回更具体的错误描述。（不过，我不知道 Bindings 是否真的使用了这个错误描述。你应该检查一下。）

如果验证应该发生在模型层，请在您的 NSManagedObject 子类中实现`validate<Key>:error:`（的单属性版本）。`validateValue:forKey:error:`

如果一些约束在模型层而其他约束在视图层，那么两者都做。如果这对您的应用程序和检查有意义，您可以自由地在格式化程序中实施一些检查并在模型中实施其他检查。

# mysql - SubSonic、SQL Server 和 MySQL 表名问题 [ ClienteEndereco Clienteendereco ]

> ID：902205
> 
> 赞同：0
> 
> 时间：2009-05-23T18:55:45.980
> 
> 标签：mysql, sql-server, subsonic

我正在使用 SQL Server 使用 SubSonic 进行测试，一切都很好。

我决定安装 MySQL 并进行相同的测试，但现在我有一个小问题

我的表名是 SQL Server 中的 ClienteEndereco，但是当我在 web.config 中进行更改以使用 MYSQL 并重新编译程序时，表名来自 Clienteendereco

```
SQL Server = Cliente**E**ndereco
MySql      = Cliente**e**ndereco 
```

我尝试使用`regexIgnoreCase="true"`但没有任何反应。

任何人都可以帮助解决这个问题吗？如何在 SQL Server 和 MySql 中制作亚音速“忽略大小写”？

谢谢你。

```
 <add name="mssql" 
       type="SubSonic.SqlDataProvider, SubSonic" 
       connectionStringName="mssql" 
       fixPluralClassNames="false" 
       generatedNamespace="ModeloDados" 
       regexMatchExpression="A-Za-z" 
       regexIgnoreCase="true" 
       removeUnderscores="false" 
       setPropertyDefaultsFromDatabase="true" 
       generateNullableProperties="true" 
       useExtendedProperties="true" 
       useUtc="true"/> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-25T16:10:01.780

正如 Pawel 指出的那样，Windows 和 OS X 上的 MySQL 默认只使用小写的表名。有一个配置选项可用于更改此行为。以下博客文章提供了简要概述：

[MySQL 大小写敏感问题](http://www.cybersite.com.au/node/69)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T01:58:34.590

我建立了一种方式..我使用了 "regexDictionaryReplace" 。这种方式在mysql和mssql中工作

```
 <add name="mysql" type="SubSonic.MySqlDataProvider, SubSonic"
             regexDictionaryReplace="Empresaendereco,EmpresaEndereco"
             fixDatabaseObjectCasing="true" connectionStringName="mysql"
             generateRelatedTablesAsProperties="true"
             fixPluralClassNames="false"
             generatedNamespace="ModeloDados"
             regexIgnoreCase="true"
             removeUnderscores="false"
             setPropertyDefaultsFromDatabase="true"
             generateNullableProperties="true"
             useExtendedProperties="true"
             useUtc="true" /> 
```

感谢大家的帮助！！！

# jquery - 触发下拉更改事件

> ID：902212
> 
> 赞同：91
> 
> 时间：2009-05-23T18:59:07.470
> 
> 标签：jquery, asp.net-mvc, triggers

我想使用 jquery 在 $(document).ready 中触发下拉的更改事件。

我在用户详细信息页面中有一个国家和州的级联下拉列表。如何使用 C# 在 MVC 中设置国家和州的值（根据用户 id 从数据库中获取）。

* * *

## 回答 #1

> 赞同：194
> 
> 时间：2009-05-24T15:18:25.103

我不太了解 JQuery，但我听说它允许使用这种语法触发本机事件。

```
$(document).ready(function(){

    $('#countrylist').change(function(e){
       // Your event handler
    });

    // And now fire change event when the DOM is ready
    $('#countrylist').trigger('change');
}); 
```

您必须在调用 trigger() 或 change() 之前声明更改事件处理程序，否则它不会被触发。感谢您提及@LenielMacaferi。

更多信息[在这里](http://docs.jquery.com/Events/trigger)。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-04-30T19:07:55.853

试试这个：

```
$(document).ready(function(event) {
    $('#countrylist').change(function(e){
         // put code here
     }).change();
}); 
```

定义更改事件，并立即触发。这确保在调用它之前定义事件处理程序。

可能会迟到回答原始海报，但其他人可能会从速记符号中受益，这遵循 jQuery 的链接等

[jQuery链接](http://www.w3schools.com/jquery/jquery_chaining.asp)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2014-11-18T14:47:20.183

试试这个：

`$('#id').change();`

为我工作。

与设置值一起在一行上： `$('#id').val(16).change();`

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-23T19:01:28.620

如果您尝试链接下拉列表，最好的方法是使用一个脚本来返回一个预构建的选择框和一个请求它的 AJAX 调用。

[如果需要，这里是 jQuery 的 Ajax 方法的文档。](http://docs.jquery.com/Ajax/jQuery.ajax)

```
$(document).ready(function(){

    $('#countrylist').change(function(e){
        $this = $(e.target);
        $.ajax({
            type: "POST",
            url: "scriptname.asp", // Don't know asp/asp.net at all so you will have to do this bit
            data: { country: $this.val() },
            success:function(data){
                $('#stateBoxHook').html(data);
            }
        });
    });

}); 
```

然后在您的状态选择框周围有一个跨度，其 id 为“stateBoxHook”

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-01-22T08:01:24.210

或者，您可以将 onchange 属性放在下拉列表本身上，该 onchange 将像这样调用某些 jquery 函数。

```
<input type="dropdownlist" onchange="jqueryFunc()">

<script type="text/javascript">
$(function(){
    jqueryFunc(){
        //something goes here
    }
});
</script> 
```

希望这个对您有所帮助，请注意，此代码只是一个粗略的草稿，未在任何 ide 上进行测试。谢谢

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-10-27T12:03:57.120

出于某种原因，此处提供的其他解决方案在从控制台运行脚本时有效，但是，当从 Chrome [Bookmarklets](https://en.wikipedia.org/wiki/Bookmarklet)`jQuery`触发时，它对我不起作用。

幸运的是，[这个 Vanilla JS 解决方案](https://stackoverflow.com/a/2856602)（`triggerChangeEvent`函数）确实有效：

```
/**
  * Trigger a `change` event on given drop down option element.
  * WARNING: only works if not already selected.
  * @see https://stackoverflow.com/questions/902212/trigger-change-event-of-dropdown/58579258#58579258
  */
function triggerChangeEvent(option) {
  // set selected property
  option.selected = true;

  // raise event on parent <select> element
  if ("createEvent" in document) {
    var evt = document.createEvent("HTMLEvents");
    evt.initEvent("change", false, true);
    option.parentNode.dispatchEvent(evt);
  }
  else {
    option.parentNode.fireEvent("onchange");
  }
}

// ################################################
// Setup our test case
// ################################################

(function setup() {
  const sel = document.querySelector('#fruit');
  sel.onchange = () => {
    document.querySelector('#result').textContent = sel.value;
  };
})();

function runTest() {
  const sel = document.querySelector('#selector').value;
  const optionEl = document.querySelector(sel);
  triggerChangeEvent(optionEl);
}
```

```
<select id="fruit">
  <option value="">(select a fruit)</option>
  <option value="apple">Apple</option>
  <option value="banana">Banana</option>
  <option value="pineapple">Pineapple</option>
</select>

<p>
  You have selected: <b id="result"></b>
</p>
<p>
  <input id="selector" placeholder="selector" value="option[value='banana']">
  <button onclick="runTest()">Trigger select!</button>
</p>
```

# locking - 监视器和锁定之间的区别？

> ID：902213
> 
> 赞同：11
> 
> 时间：2009-05-23T18:59:12.307
> 
> 标签：locking, thread-synchronization, mutual-exclusion

[监视器](http://en.wikipedia.org/wiki/Monitor_%28synchronization%29)和[锁](http://en.wikipedia.org/wiki/Lock_%28computer_science%29)有什么区别？

如果锁只是互斥的一种实现，那么监视器只是一种利用方法执行之间的等待时间的方法吗？

一个好的解释将非常有帮助谢谢....

问候

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-23T19:09:39.647

例如，在 C# .NET 中，lock 语句等效于：

```
Monitor.Enter(object);
try
{
    // Your code here...
}
finally
{
    Monitor.Exit(object);
} 
```

但是，请记住 Monitor 也可以`Wait()`和`Pulse()`，这在复杂的多线程情况下通常很有用。

**编辑：** 在 .NET 框架的更高版本中，这已更改为：

```
bool lockTaken = false;
try
{
    Monitor.Enter(object, ref lockTaken);
    // Your code here...
}
finally
{
    if (lockTaken)
    {
        Monitor.Exit(object);
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-23T19:01:40.537

他们是相关的。例如，在 C# 中，[lock](http://msdn.microsoft.com/en-us/library/c5kehkcz.aspx)语句是一个简单的 try-finally 包装器，围绕[进入 Monitor](http://msdn.microsoft.com/en-us/library/de0542zz.aspx)并在完成后[退出Monitor。](http://msdn.microsoft.com/en-us/library/system.threading.monitor.exit.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-23T19:43:29.003

监视器是编译器辅助的“半自动”锁。它们允许`synchronized`在类等上声明方法。这只是提供互斥的另一种方法。我发现[这本书](https://rads.stackoverflow.com/amzn/click/com/0201633388)是对这些概念最彻底的解释，尽管它主要面向操作系统开发人员。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-23T19:50:53.387

锁确保互斥。

监视器将要保护的数据与保护对数据的访问所需的互斥和同步原语相关联。
例如，当您需要一个线程等到事件发生时（例如，等到另一个线程将项目放入队列中）时，就会使用同步。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-04-07T16:30:24.933

Monitors 是一种编程语言结构，其功能与半量/锁相同，但 Monitors 通过在运行时同步来控制共享数据。相反，锁只是通过“旋转”来保护共享数据，这会导致 CPU 利用率低下。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-06-04T11:22:29.753

没有区别，lock 在 try/finally 块中生成 Monitor.Enter 和 Monitor.Exit。使用 Monitor over lock 可以进行微调，因为它具有 Pulse 和 PulseAll。如果您无法使用 TryEnter 获取锁，您还可以进行替代处理。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-11-19T13:00:52.120

Monitor 是概念，Lock 是实际的实现。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-04-21T07:07:39.930

就我目前所研究的而言，monitor 是一组线程同步的原则，而 lock 以及诸如 wait 和 notify 之类的“线程协作”设施是在 Java 中实现监视器的方式。如此有效，如果我们试图在这两个概念之间形成确切的关系，锁是监视器实现的一部分（另一个是等待和通知机制）。如果我错了，请纠正我，但如果更正非常具体，我将不胜感激。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2012-03-20T01:02:51.867

锁定只关注互斥，Moniter 会自动提供互斥。

所以我们不用担心在 Monitor 中使用互斥。只有在我们进行编程时，我们才需要注意 sycronzing 而不是 ME。

Monitor 提供了更系统的编程方式。因此，它是更先进的一种。

# uml - 有谁知道好的对象约束语言（OCL）教程？

> ID：902227
> 
> 赞同：7
> 
> 时间：2009-05-23T19:08:08.683
> 
> 标签：uml, constraints, modeling

我遇到了几个关于 OCL 表达式的问题。在阅读了一些大学幻灯片并在谷歌上搜索后，我仍然无法正确理解它。

我想知道你们中是否有人知道我应该阅读以理解这些东西的任何好资源。

* * *

困扰我的约束：

1.  在部门工作的每个人都有同一个经理。
2.  公司里没有人是他/她自己的经理。
3.  公司里没有人比他的经理挣得更多。

对于第一个我有：

背景部门

inv self.stuff -> forAll(manager = self.staff.manager)

第二个：

背景公司

inv self.employee -> select(manager = manager.manager) -> isEmpty()

第三个：

背景公司

inv self.employee -> select(salary > manager.salary) -> isEmpty()

但我不认为这些是正确的。我最不确定的是，在示例 2 和示例 3 中，我是否真的将个别员工与他们的实际经理/经理工资进行了比较。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-23T19:56:50.567

终于有好东西了！

这是来自 Object Management Group (OMG) 的内容丰富的文档 (PDF)：

[对象约束语言规范](http://www.omg.org/spec/OCL/2.0/PDF/)

我喜欢回答我自己的问题:)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-23T21:41:17.253

对于初学者，我会推荐这本书：对象约束语言：让您的模型为 MDA 做好准备，作者是 Jos Warmer 和 Anneke Kleppe（Jos 是 OCL 的主要创建者之一）。

还有这个免费的[OCL 教程](http://modeling-languages.com/ocl-tutorial/)（pdf + 幻灯片）

我也很喜欢你已经找到的官方规范（特别是提供语言的非正式描述的章节）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-09-16T10:00:58.410

@Artur 发布的 PDF 文件的链接已更改，这是新链接 [http://www.omg.org/spec/OCL/2.0/PDF/](http://www.omg.org/spec/OCL/2.0/PDF/)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-23T23:02:27.540

关于约束的快速解决方案：

上下文部门 inv: self.staff -> forAll(s1,s2| s1.manager = s2.manager)

上下文公司 inv: self.employee->forAll(e| e.manager<>e)

上下文公司 inv: self.employee->forAll(e| e.salary<=e.manager.salary)

顺便说一句，我真的不认为需要 Company 类（系统中有多少 company 类型的对象？）。如果约束二和三对所有公司都成立，那么它们可以以这种方式使用 Person 作为上下文来表达（例如，使用数字 2）： context Person inv: self.manager<>self)

我们还可以在进行比较之前添加检查以查看员工是否有经理

# gridview - 使用 C# 在 gridview 中添加带有文本框的列

> ID：902231
> 
> 赞同：3
> 
> 时间：2009-05-23T19:10:20.443
> 
> 标签：gridview

我正在网站上的购物车上工作，并且我的物品（已添加到购物车中）在数组列表中。并使用这些值，我已经从数据库中读取了其余的值，并成功地填充了 gridview。

```
 if (d1.Read())
        {
            d1.Close();
            sda.SelectCommand = searchResult;
            sda.Fill(dt);
            GridView2.DataSource = dt;
            GridView2.DataBind();
        } 
```

如何在此网格视图中添加一个名为“数量”的附加列以及一个文本框，以便用户可以为网格视图中显示的每个项目输入一个数量值？

任何帮助/建议/链接将不胜感激。

谢谢，

//编辑 2

```
<asp:GridView ID="GridView2" runat="server" BackColor="#388AD0"
    BorderColor="Black" BorderStyle="Solid" BorderWidth="1px" CellPadding="3" ForeColor="Black"
    GridLines="Vertical" Height="160px" Style="left: 72px;
    position: relative; top: 8px" Width="504px" AllowPaging="True" PageSize="5">
    <FooterStyle BackColor="#E0E0E0" />
    <PagerStyle BackColor="Silver" ForeColor="Black" HorizontalAlign="Center" />
    <SelectedRowStyle BackColor="#388AD0" Font-Bold="True" ForeColor="White" />
    <HeaderStyle BackColor="Black" Font-Bold="True" ForeColor="White" />
    <AlternatingRowStyle BackColor="#388AD0" />
    <PagerSettings Mode="NextPrevious" />
</asp:GridView> 
```

//编辑 3

```
public void additem(string additem) 
{
    DataTable dt = new DataTable();
    string ConnectionString = @"Data Source=.\SQLEXPRESS;AttachDbFilename=|DataDirectory|\ewap_k.mdf;Integrated Security=True;User Instance=True";
    using (SqlConnection searchCon = new SqlConnection(ConnectionString))
    {
        using (SqlCommand searchResult = new SqlCommand("SELECT ItemID, Name, RelDate, Price, Status FROM item_k WHERE ItemID IN ( " + itemIDs + ")", searchCon))
        {
            searchCon.Open();
            SqlDataReader d1 = searchResult.ExecuteReader();
            SqlDataAdapter sda = new SqlDataAdapter();

            if (d1.Read())
            {
                d1.Close();
                sda.SelectCommand = searchResult;
                sda.Fill(dt);
                GridView1.DataSource = dt;
                GridView1.DataBind();
            }
            else { }
            searchCon.Close();
        }
    }
} 
```

//编辑 4

```
<asp:GridView ID="GridView1" runat="server" Style="left: 8px; position: relative;
    top: 0px">
    <Columns>
        <asp:BoundField DataField="ItemID"  Visible="false"/>
        <asp:BoundField DataField="Name" />
        <asp:BoundField DataField="RelDate" />
        <asp:TemplateField>
        <ItemTemplate>
            <asp:TextBox ID="TextBox1" runat="server" Text=""></asp:TextBox>
        </ItemTemplate>
    </asp:TemplateField>
        <asp:BoundField DataField="Price" />
        <asp:BoundField DataField="Status" />
    </Columns>
</asp:GridView> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-23T19:14:08.890

您可以添加模板字段并将文本框拖放到 ItemTemplate 中，如下所示：

```
<asp:TemplateField>
            <ItemTemplate>
                <asp:TextBox ID="TextBox1" runat="server" Text=""></asp:TextBox>
            </ItemTemplate>
        </asp:TemplateField> 
```

[编辑] 这是一个更完整的网格：

```
<asp:GridView ID="GridView1" runat="server">
    <Columns>
        <asp:BoundField />
        <asp:BoundField />
        <asp:TemplateField>
            <ItemTemplate>
                <asp:TextBox ID="TextBox1" runat="server" Text=""></asp:TextBox>
            </ItemTemplate>
        </asp:TemplateField>
    </Columns>
</asp:GridView> 
```

请注意，无论我决定将它放在列列表中的任何位置，TemplateField 都会出现。如果这仍然不适合您，您可以发布您的 GridView 标记，以便我可以看到您有什么？

[编辑 2] 这是您的网格的更新版本。您只需要设置 BoundFields 以绑定到您需要的数据集中的任何值。

```
<asp:GridView ID="GridView2" runat="server" BackColor="#388AD0" BorderColor="Black"
    BorderStyle="Solid" BorderWidth="1px" CellPadding="3" ForeColor="Black" GridLines="Vertical"
    Height="160px" Style="left: 72px; position: relative; top: 8px" Width="504px"
    AllowPaging="True" PageSize="5">
    <Columns>
        <asp:BoundField />
        <asp:BoundField />
        <asp:TemplateField>
            <ItemTemplate>
                <asp:TextBox ID="TextBox1" runat="server" Text=""></asp:TextBox>
            </ItemTemplate>
        </asp:TemplateField>
    </Columns>
    <FooterStyle BackColor="#E0E0E0" />
    <PagerStyle BackColor="Silver" ForeColor="Black" HorizontalAlign="Center" />
    <SelectedRowStyle BackColor="#388AD0" Font-Bold="True" ForeColor="White" />
    <HeaderStyle BackColor="Black" Font-Bold="True" ForeColor="White" />
    <AlternatingRowStyle BackColor="#388AD0" />
    <PagerSettings Mode="NextPrevious" />
</asp:GridView> 
```

# xml - 如何获取谷歌地球建筑网格数据？

> ID：902232
> 
> 赞同：0
> 
> 时间：2009-05-23T19:10:52.530
> 
> 标签：xml, api, 3d, google-earth, mesh

我正在制作一个应用程序，我想在谷歌地球中导入 3D 建筑物，您可以在 Chi、NYC、SF 等地找到这些建筑物。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-10T07:00:28.083

不，由于许可问题。

但是，Google 地球中的一些 3D 建筑直接来自[Google 3D 仓库](http://sketchup.google.com/3dwarehouse/)，在这种情况下，它们可以以 COLLADA (.dae) 或 SketchUp (.skp) 格式下载。

# file - 如何找到某些指定文件的大小？

> ID：902233
> 
> 赞同：2
> 
> 时间：2009-05-23T19:11:17.880
> 
> 标签：file, size, sum

该命令尝试总结大小：

```
find . -iname "*.dmg" -exec du -sh '{}' \; 3&> /dev/null |
    awk '{print $1}' | summming_up_program??? 
```

你能找到更简单的解决方案吗？

**Ubuntu 解决方案。感谢 Ayman 的 Awk-end。**

```
find . -iname "*.dmg" -printf '%b\n' |
    awk 'BEGIN { s = 0 } {s += $1 } END { print "%dMB", s / 2^20 }' 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-23T19:17:58.977

```
find . -iname '*.dmg' -exec stat -f '%z' '{}' \; |
     awk 'BEGIN { s = 0 } {s += $1 } END { print s }' 
```

[`stat`](http://en.wikipedia.org/wiki/Stat_(Unix))用于获取文件的大小。`awk`用于汇总所有文件大小。

编辑：

不分叉的解决方案`stat`：

```
find . -iname '*.dmg' -ls | 
     awk 'BEGIN { s = 0 } {s += $7 } END { print s }' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T19:30:55.783

```
wc -c *.pyc | tail -n1 | cut -f 1 -d ' ' 
```

可能比通过管道处理文件更快。`wc -c`不计算字节，它从 inode 检索大小......或者我的硬盘读取速度为 717 GB/s :-)

```
$ time wc -c very-big.pcap
5394513291 very-big.pcap
real    0m0.007s
user    0m0.000s
sys     0m0.000s 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-23T19:26:28.787

猫 *.dmg | 厕所-c

cat 将所有文件复制到标准输出，wc 计算转储文件的大小。没有任何东西被写入磁盘。

效率不高，但即使我也能理解:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-23T19:54:59.027

增强的 Ayman 的非分叉命令：

```
find . -iname '*.dmg' -ls 3&> /dev/null | 
      awk 'BEGIN { s = 0 } {s += $7 } END { print "%dGB", s / 2^30 }' 
```

感谢 Ayman 纠正了我最初的回复。

# html - 关于 div 的简单 CSS 问题

> ID：902237
> 
> 赞同：0
> 
> 时间：2009-05-23T19:12:37.847
> 
> 标签：html, css

我有一个像这样的非常简单的页面

!!@#@ 显然我无法在 jsbin 上添加指向我的页面的链接，因为不允许新用户添加链接。

我想在提供给用户的不同选项之间有一定的差距（比如 15px）。

我的代码如下：

```
<div id="question" >
    What month is it?
    <div style="padding-right: 15px;" id="options">
        <input type="radio" name="question1" />Jan
        <input type="radio" name="question1" />Feb
        <input type="radio" name="question1" />May
        <input type="radio" name="question1" />Dec
    </div>
</div> 
```

我认为在右侧添加填充将为 div id 选项中的每个单选按钮添加填充。但是，它只是为整个 div 添加填充。

处理这个问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-23T19:14:36.847

您可以添加以下规则：

```
div#options input { padding-right: 15px } 
```

它将在 id 为“options”的 div 下的每个“input”元素的右侧添加填充

更新：在示例中，“id”被多次使用。Id 必须是唯一的，因此类会更合适。请参见以下示例：

```
div.options input { padding-right: 15px; }
<div class="options">
    <input type="radio">... 
```

该类可以用于您希望共享相同样式的其他元素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T19:24:18.887

要记住的是 an`inline style`将应用于定义它的标签的元素。要影响输入，您需要通过向它们添加 a`class`来直接定位它们（​​演示：1），定位所有输入（演示：2），或者如 jthompson 建议的那样，定位那些作为特定 div 后代的输入（参见汤普森的回答）。

1.  1.  `输入{padding-right: 15px; }`，或
    2.  `input[type="radio"] {padding-right: 15px; }` // 我认为这只是 CSS3。
2.  添加 `class="q1-radio-inputs"` 并使用 CSS `.q1-radio-inputs {padding-right: 15px; }`

还值得注意的是，使用内联样式没有多大意义，除非它只需要一次覆盖特定样式，它总是（据我所知）使用外部工作表更明智，以便缓存（如果没有别的），并且在重新设计/重新设计网站时更容易影响所有样式。

而且，作为附录，样式按以下顺序应用：inline-stlyes 覆盖在标题中定义的样式，而这些样式又会覆盖外部样式表。除非样式是用`!important`标记定义的，在这种情况下它不会被覆盖（一切都很好）。

以下（某种）帮助：[http://www.w3.org/TR/CSS2/cascade.html](http://www.w3.org/TR/CSS2/cascade.html)

* * *

## 根据评论编辑：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>

<style type="text/css" media="screen">
.div#options input { padding-right: 15px }
</style>
</head>
<body>
<div id="question" style="padding-bottom: 15px">
    What day is it today?
    <div id="options">

        <input type="radio" name="question1" />Sunday
        <input type="radio" name="question1" />Monday
        <input type="radio" name="question1" />Saturday
        <input type="radio" name="question1" />Tuesday
    </div>
</div>

<div id="question" >
    What month is it?
    <div id="options">
        <input type="radio" name="question1" />Jan
        <input type="radio" name="question1" />Feb
        <input type="radio" name="question1" />May
        <input type="radio" name="question1" />Dec
    </div>

</div>

</html> 
```

如果上面的 html 仍然代表您的网站（在此答案的评论中链接），那么问题很可能是：

`.div#options`

句点用于表示`class`名称，井号“#”用于表示`div`名称，一次只能使用一个或另一个：

```
div.options /* is fine, indicating a 'div' of class-name 'options' */
div#options /* is also fine (and both within the same document is, also, fine) indicating a div of id-name 'options' - an id is unique, and can be used only *once* per document */

.div#options /* could be fine, but appears to be targeting an element of id-name 'options' within an element of class-name 'div,' which is not found within your document. */ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-23T19:20:00.250

您的代码要求浏览器在 DIV 右侧放置 15px 的填充，因此您需要更具体地使用 CSS 声明：

```
#options input { padding-right:15px; } 
```

如果您将它放在样式标签之间或样式表中，它应该会按照您想要的方式进行。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-23T21:17:16.643

我认为问题的根源在于 HTML 而不是 CSS。

您的 HTML 不如预期的好/有用。您正在提供月份列表，因此请使用列表标记它们：

```
<ol id="options" class="formList">
   <li>
      <input type="radio" name="question1" />Jan
   <li/>
   ....
</ol> 
```

现在成为很好的语义 HTML 的一个副作用是它为您的样式提供了所有正确的钩子。表单的每个部分都在它自己的元素中，这使得应用 CSS 变得更加容易 - 在列表项周围添加空间使用类似的东西：

```
.formList li {margin:15px;} 
```

//无关：

您也应该真正将标签元素添加到您的标记中。在表单中使用标签元素将表单元素的文本标签与该表单元素显式关联，使网站更易于访问和使用 - 用户可以单击文本来激活单选按钮，从而为他们提供更大的目标，使您的表单更好，并且您的用户更快乐。

```
<label><input type="radio" name="question1" />Jan</label> 
```

或者

```
<input type="radio" id="radio1" name="question1" /><label for="radio1">Jan</label> 
```

# recursion - F# 中的递归 lambda

> ID：902243
> 
> 赞同：8
> 
> 时间：2009-05-23T19:16:04.627
> 
> 标签：recursion, lambda, functional-programming, f#, fixpoint-combinators

以这个示例代码为例（暂时忽略它非常低效）

```
let listToString (lst:list<'a>) = ;;' prettify fix

    let rec inner (lst:list<'a>) buffer = ;;' prettify fix
        match List.length lst with 
        | 0 -> buffer
        | _ -> inner (List.tl  lst) (buffer + ((List.hd lst).ToString()))

    inner lst "" 
```

这是我在 F# 中经常遇到的一种常见模式，我需要一个内部函数，它在某个值上递归自身 - 我只需要这个函数一次，有没有可能从它自身内部调用一个 lambda（一些魔术关键字或其他东西）？我希望代码看起来像这样：

```
let listToString2 (lst:list<'a>) = ;;' prettify fix

    ( fun 
        (lst:list<'a>) buffer -> match List.length lst with ;;' prettify fix
                                 | 0 -> buffer
                                 | _ -> ##RECURSE## (List.tl lst) (buffer + ((List.hd lst).ToString())) 
    ) lst "" 
```

但是正如您可能期望的那样，没有办法在其内部引用匿名函数，这是我放置##RECURSE##的地方所需要的

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-05-23T19:40:20.273

是的，可以使用所谓的[y 组合器](http://en.wikipedia.org/wiki/Y-combinator)（或`fixed-point combinators`）。前任：

```
let rec fix f x = f (fix f) x

let fact f = function
 | 0 -> 1
 | x -> x * f (x-1)

let _ = (fix fact) 5 (* evaluates to "120" *) 
```

我不知道 F# 的文章，但这个[haskell 条目](http://en.wikibooks.org/wiki/Haskell/Fix_and_recursion)可能也有帮助。

但是：如果有其他选择，我不会使用它们——它们很难理解。

您的代码（此处省略类型注释）是标准构造，并且更具表现力。

```
let listToString lst =

    let rec loop acc = function
        | []    -> acc
        | x::xs -> loop (acc ^ (string x)) xs

    loop "" lst 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T20:01:03.100

请注意，尽管您说您只使用该函数一次，但从技术上讲，您两次通过名称引用它，这就是给它一个名称的原因。

# vb.net - 什么会导致 Visual Studio 2008 在调试时挂起？

> ID：902244
> 
> 赞同：8
> 
> 时间：2009-05-23T19:16:29.570
> 
> 标签：vb.net, visual-studio-2008, freeze

我有一个 vb.net 项目，有时在 IDE 中运行时会突然挂起。通常这不会是一个问题。只需点击“暂停”，查看当前正在运行的线程，然后找到死锁（或其他任何东西）。

但是现在我遇到了一种情况，不仅程序挂起，而且试图暂停它会导致 Visual Studio 本身挂起。为了重新获得控制权，我必须终止正在调试的程序的进程，此时 Visual Studio 恢复生机并说它无法暂停执行。这很令人沮丧，因为杀死进程意味着程序状态丢失（当然），所以我不知道挂在*哪里*。

那么这种行为有什么常见的原因吗？我应该寻找什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-28T23:12:54.797

如果您的程序安装了全局挂钩（与应用程序通信） - 可能就是这种情况。钩子尝试与您的应用程序通信（由调试器暂停）并被锁定。并且调试器无法接收其窗口消息：钩子调试器（带有钩子 dll）和钩子应用程序之间的经典死锁。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-24T05:37:24.553

查找 Visual Studio 问题的特定修复程序可能很棘手：[http ://social.msdn.microsoft.com/Search/en-US/?query=visual%20studio%202008%20hang&ac=3](http://social.msdn.microsoft.com/Search/en-US/?query=visual%20studio%202008%20hang&ac=3)

此外，并非所有来自 Microsoft 的修补程序都直接向公众发布。有些仅提供给系统出现特定问题的客户。因此，您必须联系 Microsoft 以获得修复。他们这样做是为了限制发布可能会破坏其他内容的修补程序的潜在不利影响。因此，如果所有其他方法都失败了，请给他们打电话。

以下是我在 Visual Studio 开始发挥作用时喜欢做的其他一些事情：

1.  删除旧断点并监视变量。
2.  在 Visual Studio 未运行的情况下，删除智能感知文件 (.ncb)
3.  清理解决方案，然后重新构建所有代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-23T19:24:32.363

检查修补程序和服务包。我看到一个与.net 编程和调试相关的错误挂起。（有时在 64 位操作系统上调试 C++ 32 位应用程序时，VS 会挂起。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-06T06:41:27.637

我刚刚遇到了一个非常相似的问题（VS 无法中断执行），使用 Debug -> Delete all breakpoints 解决了这个问题。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-23T19:18:46.510

我会检查正在调试的程序的代码，我认为您尝试调试的代码中可能存在无限循环或竞争条件。过去我就是这种情况，尤其是在我曾经拥有的单核笔记本电脑上。当您尝试暂停时，您能否提供有关您认为执行在程序中的哪个位置的任何信息？

# regex - Perl 正则表达式没有按预期跳出直到循环

> ID：902254
> 
> 赞同：7
> 
> 时间：2009-05-23T19:20:56.147
> 
> 标签：regex, perl

当我打印正则表达式的结果时，我试图用它来控制 until 循环，它给了我我期望的 1 或 null 。为什么下面的代码不起作用，但如果我取消注释第五行它可以正常工作？

```
print("Please enter 1, 2, 3 or 4 : ");
my $channelSelection = "";

until ($channelSelection =~ /^[1-4]$/) {
    chomp(my $channelSelection = <STDIN>);
    #last if ($channelSelection =~ /^[1-4]$/);
    print ("Invalid choice ($channelSelection) please try again: ") 
        if ($channelSelection !~ /[1-4]/);
} 
```

我确定这已在其他地方解决，但无法通过搜索找到。指出我正确的方向会很棒。

我通常会做类似的事情。

```
print("Please enter 1, 2, 3 or 4 : ");
my $channelSelection = "";
while (1) {
    chomp(my $channelSelection = <STDIN>);
    last if ($channelSelection =~ /^[1-4]$/);
    print ("Invalid choice ($channelSelection) please try again: ") if ($channelSelection !~ /[1-4]/);
} 
```

但我试图摆脱无限循环。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-23T19:34:05.213

这里的问题是您在循环内重新声明 $channelSelection 但循环外部保留旧值。从内循环中删除“我的”。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-23T19:33:59.177

您已`$channelSelection`在 until 循环中本地重新声明。这样，每次循环执行时它的值都会丢失。所以正则表达式将不匹配，因为 then 的值`$channelSelection`将再次等于`""`。

`my`从循环中删除将解决问题。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-23T20:13:34.013

不担心怎么办？

```
#!/usr/bin/perl

use strict;
use warnings;

use Term::Menu;

my @channels = qw( 1 2 3 4 );

my $prompt = Term::Menu->new(
    aftertext => 'Please select one of the channels listed above: ',
    beforetext => 'Channel selection:',
    nooptiontext =>
        "\nYou did not select a valid channel. Please try again.\n",
    toomanytries =>
        "\nYou did not specify a valid channel, going with the default.\n",
    tries => 3,
);

my $answer = $prompt->menu(
    map { $_ => [ "Channel $_" => $_ ] } @channels
);

$answer //= $channels[0];

print "$answer\n";

__END__ 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-23T21:04:49.277

从用户那里获取输入的最佳解决方案是使用 IO::Prompt 模块。它支持重复、验证、菜单系统等等。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-24T16:45:17.563

这更像是一个风格问题（并且由于您无法安装模块，因此对您没有帮助），但我只想指出，在检查固定值时，使用正则表达式可能不是最佳解决方案。

这就是我要做的：

```
use List::MoreUtils;

my @allowed_values = qw( 1 2 3 4 );

# get $answer from prompt.

if(any { $_ == $answer } @allowed_values) {
    # All is good.
} 
```

其他时候可能会派上用场。

# iphone - 在同一部 iPhone 上使用不同的 Apple ID 进行应用程序测试和 App Store/iTunes 购买？

> ID：902256
> 
> 赞同：2
> 
> 时间：2009-05-23T19:22:24.613
> 
> 标签：iphone, testing

我使用新的 Apple ID 注册了 iPhone 开发者计划（现在正在等待批准），这个 ID 与我在 iPhone 上用于 iTunes/AppStore 购买的 ID 不同。

我只有一部 iPhone，想使用同一台设备进行应用程序测试和日常手机使用。我还不能尝试，但我猜当我同步我的 iPhone 应用程序进行测试时，iTunes/XCode 将使用新的 Apple ID。知道我是否仍然可以继续使用我使用其他 Apple ID 购买的那些应用程序吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-23T20:02:19.433

我还为开发者计划和 iTunes 购买使用单独的 Apple ID。在 iTunes 中，我使用一直用于购买的 Apple ID。我只使用我的开发者计划 ID 来登录开发者网站。这一切都很好，甚至可以从 iTunes 上的 ADC 下载各种内容。施展了足够的魔法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-23T19:34:13.623

你可以。这算不上问题。

# mysql - 如何在 MYSQL 中的 WHERE 语句之外进行计数

> ID：902259
> 
> 赞同：1
> 
> 时间：2009-05-23T19:22:56.610
> 
> 标签：mysql

我有一张桌子 - 比如：

```
A|B
1|1
1|2
1|3
2|1
2|3
2|4
2|5
3|5 
```

如果 A 中的不同值与 B 中的 1 或 2 值一致，我的查询将返回它们 - 所以

```
A
1
2 
```

我也试图在 A 列中返回 1 和 2 的原始计数 - 得到类似

```
A|Count
1|3
2|4 
```

请问有没有简单的方法来获得这个计数？但是，COUNT (A) 返回与初始 WHERE 语句重合的 A 的数量：

```
A|Count
1|2
2|1 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-23T19:29:57.547

我的 SQL 可能有点生疏，但我认为你可以这样做：

```
SELECT A, count(*) AS Count FROM MyTable WHERE B IN (1, 2) GROUP BY A; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T20:08:12.820

其他方式：

```
SELECT a, (SELECT count(*) FROM t t2 WHERE t2.a = t.a) a_count
FROM t
WHERE b IN (1,2)
GROUP BY a 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-23T19:30:17.890

```
SELECT t1.A, COUNT(DISTINCT t1.B)
FROM MyTable t1 JOIN MyTable t2 ON (t1.A = t2.A)
WHERE t2.A = t2.B
GROUP BY t1.A; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-23T19:36:18.363

类似于比尔卡尔文的回答：

```
SELECT
  A,
  Counted.CountOfB
FROM
  MyTable
  INNER JOIN (
    SELECT A, COUNT(B) AS CountOfB
    FROM   MyTable
    GROUP BY  A
  ) Counted ON Counted.A = MyTable.A
WHERE
  {your filter for MyTable} 
```

# javascript - 在javascript中解压缩字符串

> ID：902260
> 
> 赞同：6
> 
> 时间：2009-05-23T19:23:06.750
> 
> 标签：javascript, google-maps, zip, kml, unzip

任何人都知道一个实现 UNZIP 算法的简单 JavaScript 库吗？不能访问磁盘文件，只能压缩和解压缩一串值。

有 ActiveX，使用 WinZIP 和其他客户端依赖软件的 ZIP，用 JS 编写。但没有纯 JavaScript 算法实现。

我将使用它在带有 GMap 对象（谷歌地图）的 HTML 页面中显示 KMZ 文件。KMZ 文件只是一个压缩的 KML 文件。我想解压缩 KMZ 文件并将 KML 提供给 GMap。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-24T14:40:09.577

无需解压缩 KMZ 文件，因为[Google 地图完全理解它。](http://maps.google.com/support/bin/answer.py?hl=en&answer=41136)[您可以检查它，只需在Google 地图 Web 界面](http://maps.google.com/)中搜索您的 KMZ 文件所在的 URL，它就会在地图上显示其内容。

[这是一个演示](http://maps.google.com/maps?f=q&source=s_q&hl=en&geocode=&q=http:%2F%2Fwww.ceressuto.hu%2Fimages%2Fmaps%2Fmapceres-2359112.kmz&ie=UTF8&z=7)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T21:36:23.750

也许 Mozilla 的 ZipReader 可以用于您所追求的。

[https://developer.mozilla.org/en/nsIZipReader](https://developer.mozilla.org/en/nsIZipReader)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-24T14:32:27.957

[DotNetZip](http://dotnetzip.codeplex.com)有一个 COM 接口，可以从 Javascript 访问。它具有流到流的解压缩功能，但我从未尝试过在 Javascript 中使用它。
此外，我从未尝试在 IE 中以任何方式使用该库。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-04-13T05:03:43.510

kthoom 在二进制字符串上实现解压缩：http: [//kthoom.googlecode.com/](http://kthoom.googlecode.com/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-05-10T22:52:28.883

我知道这是一个已被接受的答案的老问题，但只是为了有趣的信息，我会发布另一个答案。我整理了一个纯 JavaScript 库来从任何浏览器读取和提取 zip 文件。它不需要 Mozilla 的 ZipReader 或任何 ActiveX（除了 XMLHttpRequest）。

您可以在这里看到一个工作示例：http:
[//cheeso.members.winisp.net/Unzip-Example.htm](http://cheeso.members.winisp.net/Unzip-Example.htm)

您可以从这里下载源代码：http:
[//cheeso.members.winisp.net/examples.aspx#js](http://cheeso.members.winisp.net/examples.aspx#js)

# c++ - C++ 中是否有一个不错的等待功能？

> ID：902261
> 
> 赞同：62
> 
> 时间：2009-05-23T19:23:52.210
> 
> 标签：c++, wait

我在 C++ 中学到的第一件事就是

```
#include <iostream>
int main()
{
    std::cout<<"Hello, World!\n";
    return 0;
} 
```

只会在没有停顿的情况下极快地出现和消失。为了防止这种情况，我不得不去记事本，并保存

```
helloworld.exe
pause 
```

酶

```
helloworld.bat 
```

当我需要创建一堆小测试程序时，这变得很乏味，最终我只是把我`while(true);`的大多数测试程序放在最后，这样我就可以看到结果了。我可以使用更好的等待功能吗？

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2009-05-23T19:27:45.040

您可以要求用户在关闭程序之前按回车键......这样的工作。

```
#include <iostream>
int main()
{
  std::cout << "Hello, World\n";
  std::cin.ignore();
  return 0;
} 
```

cin 读取用户输入，cin 的 .ignore() 函数告诉程序忽略输入。一旦用户点击回车，程序将继续。

[关联](http://en.cppreference.com/w/cpp/io/basic_istream/ignore)

* * *

## 回答 #2

> 赞同：57
> 
> 时间：2013-02-20T19:58:18.770

请注意，上面的代码是
在 Windows 7 上的 Code::Blocks 12.11 和 Visual Studio 2012 上测试的。

**要强制您的程序停止或等待，您有几个选择：**

* * *

*   **睡眠（无符号整数）**

该值必须是以毫秒为单位的正整数。这意味着如果您希望程序等待 2 秒，请输入 2000。

这是一个例子：

```
#include <iostream>     //for using cout
#include <stdlib.h>     //for using the function sleep

using namespace std;    //for using cout

int main(void)         
{
   cout << "test" << endl;
   sleep(5000);         //make the programme waiting for 5 seconds
   cout << "test" << endl;
   sleep(2000);         // wait for 2 seconds before closing

   return 0;
} 
```

如果您等待太久，那可能意味着该参数以秒为单位。所以把它改成这样：

```
sleep(5); 
```

对于那些在使用 sleep 时收到错误消息或问题的人，请尝试将其替换为 _sleep 或 Sleep，尤其是在 Code::Bloks 上。
如果您仍然遇到问题，请尝试在代码开头添加一个此库。

```
#include <stdio.h>
#include <time.h>
#include <unistd.h>
#include <dos.h>
#include <windows.h> 
```

* * *

*   **系统（“暂停”）**

Windows 控制台应用程序上的一个简单的“Hello world”程序可能会在您看到任何内容之前关闭。可以使用 system("Pause") 的情况。

```
#include <iostream>    

using namespace std;   

int main(void)         
{
    cout << "Hello world!" << endl;

    system("PAUSE");

    return 0;
} 
```

如果您收到消息“错误：'system' 未在此范围内声明”，只需在代码的 biggining 处添加以下行：

```
#include <cstdlib> 
```

* * *

*   **cin.ignore()**

使用 cin.ignore() 可以达到相同的结果：

```
#include <iostream>     

using namespace std;    

int main(void)         
{
    cout << "Hello world!" << endl;

    cin.ignore();

    return 0;
} 
```

* * *

*   **cin.get()**

例子 ：

```
#include <iostream>     

using namespace std;    

int main(void)         
{
    cout << "Hello world!" << endl;

    cin.get();

    return 0;
} 
```

* * *

*   **getch()**

只是不要忘记添加库 conio.h ：

```
#include <iostream>     
#include <conio.h>    //for using the function getch()

using namespace std;    

int main(void)
{

    cout << "Hello world!" << endl;

    getch();

    return 0;
} 
```

你可以有消息告诉你使用 _getch() insted of getch

* * *

## 回答 #3

> 赞同：55
> 
> 时间：2016-04-02T14:37:24.383

很多人建议使用 POSIX `sleep`、 Windows `Sleep`、 Windows `system("pause")`、 C++ `cin.get()`……甚至还有一个 DOS `getch()`，大约从 1920 年代后期开始。

***请*不要做这些。**

在我的团队中，这些解决方案都无法通过代码审查。这意味着，如果您提交此代码以包含在我们的产品中，您的提交将被阻止，您将被告知去寻找另一个解决方案。（有人可能会争辩说，当你只是一个业余爱好者时，事情并没有那么严重，但我建议在你的宠物项目中养成良好的习惯，这将使你成为商业组织中有价值的专业人士，并让你被录用。 )

保持控制台窗口打开以便您可以阅读程序的输出*不是*您的程序的责任！当您在程序末尾添加等待/睡眠/阻塞时，您违反了单一职责原则，造成大量抽象泄漏，并消除了程序的可重用性/可链接性。它不再接受输入并提供输出——它出于临时使用原因而阻塞。这是非常不好的。

相反，您应该配置您的*环境*以在程序完成其工作后保持提示打开。**您的批处理脚本包装器是一个好方法！**我可以看到必须继续手动更新是多么烦人，而且你不能从你的 IDE 中调用它。**您可以使脚本将要执行的程序的路径作为参数，并配置您的 IDE 以调用它而不是直接调用您的程序。**

一种临时的快速启动方法是将**IDE 的运行命令**从`cmd.exe <myprogram>`or更改`<myprogram>`为`cmd.exe /K <myprogram>`. 在给定路径的程序终止后，`/K`切换到`cmd.exe` **使提示保持打开状态**。这将比您的批处理脚本解决方案更烦人，因为现在您必须`exit`在阅读完程序输出后键入或单击红色的“X”，而不仅仅是敲击空格键。

* * *

^(*我假设使用 IDE，否则您已经从命令提示符调用，这首先不是问题。此外，我假设使用 Windows（基于问题中给出的细节），但这个答案适用于任何平台......顺便说一句，这是一半。*)

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2009-05-23T20:35:24.263

用于显示文本的窗口的出现和消失是程序运行方式的特征，而不是 C++ 的特征。

在持久的命令行环境中运行，或者*在*程序中包含窗口支持，或者使用`sleep`或等待输入，如其他答案所示。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2009-05-23T19:27:49.627

相当于批处理程序将是

```
#include<iostream>
int main()
{
    std::cout<<"Hello, World!\n";
    std::cin.get();
    return 0;
} 
```

附加行的作用完全`PAUSE`一样，等待单个字符输入

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2017-02-04T21:37:23.357

有一种 C++11 方法可以做到这一点。它非常简单，我相信它是便携的。当然，正如[Orbit 中的 Lightness Races](https://stackoverflow.com/a/36374595/3068259)指出的那样，您不应该为了能够在终端中看到*Hello World*而这样做，但是使用等待功能存在一些充分的理由。无需再费周折，

```
#include <chrono> // std::chrono::microseconds
#include <thread> // std::this_thread::sleep_for
std::this_thread::sleep_for(std::chrono::microseconds{}); 
```

更多详细信息可[在此处](http://en.cppreference.com/w/cpp/thread/sleep_for)获得。另请参阅[sleep_until](http://en.cppreference.com/w/cpp/thread/sleep_until)。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2015-10-17T11:14:30.373

实际上，与其他答案相反，我相信 OP 的解决方案是最优雅的解决方案。

这是您通过使用外部`.bat`包装器获得的收益：

1.  该应用程序显然在等待用户输入，因此它已经完成了您想要的操作。
2.  您不会因为尴尬的调用而使代码混乱。谁该等？`main()`?
3.  您不需要处理跨平台问题 - 看看`system("pause")`这里有多少人建议。
4.  如果没有这个，要在黑盒测试模型中以自动方式测试您的可执行文件，您需要模拟`enter`按键（除非您执行脚注中提到的操作）。
5.  也许最重要的是 - 如果任何用户想要通过终端（`cmd.exe`在 Windows 平台上）运行您的应用程序，他们**不想**等待，因为他们无论如何都会看到输出。使用`.bat`包装器技术，他们可以决定是运行`.bat`（或`.sh`）包装器，还是直接运行可执行文件。

专注于最后两点 - 使用任何其他技术，我希望程序至少提供`--no-wait`开关，以便我作为用户可以使用应用程序进行各种操作，例如管道输出，将其与其他程序等。这些是正常 CLI 工作流程的一部分，当您已经在终端中时，在最后添加等待只会妨碍用户体验并破坏用户体验。

由于这些原因，IMO`.bat`解决方案在这里是最好的。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-05-24T02:04:19.500

你所拥有的可以写得更容易。代替：

```
#include<iostream>
int main()
{
    std::cout<<"Hello, World!\n";
    return 0;
} 
```

写

```
#include<iostream>
int main()
{
    std::cout<<"Hello, World!\n";
    system("PAUSE");
    return 0;
} 
```

系统函数执行你给它的任何东西，就好像它是在命令提示符下写的一样。它会在命令执行时暂停程序的执行，因此您可以对它进行任何操作，甚至可以从您的 cpp 程序编译程序。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-05-23T19:28:09.610

句法：

无效睡眠（无符号秒）；

sleep() 暂停执行一段时间（秒）。调用 sleep 后，当前程序将暂停执行由参数 seconds 指定的秒数。间隔仅精确到最接近的百分之一秒或操作系统时钟的精确度，以较不精确的为准。

这个例子应该清楚地表明：

```
#include <dos.h>
#include <stdio.h>
#include <conio.h>

int main()
{
   printf("Message 1\n");
   sleep(2); //Parameter in sleep is in seconds
   printf("Message 2 a two seconds after Message 1");
   return 0;
} 
```

记住你必须#include dos.h

**编辑：**

您也可以使用 winAPI。

```
VOID WINAPI Sleep(
DWORD dwMilliseconds
); 
```

[睡眠功能(Windows)](http://msdn.microsoft.com/en-us/library/ms686298.aspx)

请注意，winapi提供的函数中的参数是以毫秒为单位的，所以上面代码片段中的sleep行看起来像这样“Sleep(2000);”

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-05-23T19:28:51.060

getchar() 提供了一个简单的答案（等待键盘输入）。退出前调用 Sleep(milliseconds) 休眠。 [睡眠功能 (MSDN)](http://msdn.microsoft.com/en-us/library/ms686298(VS.85).aspx)

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2009-05-23T19:27:11.140

您可以使用 sleep() 或 usleep()。

```
// Wait 5 seconds
sleep( 5 ); 
```

* * *

## 回答 #12

> 赞同：-2
> 
> 时间：2011-01-09T17:53:04.910

好吧，这是一篇旧帖子，但我只会为这个问题做出贡献——稍后有人可能会发现它很有用：

添加 'cin.get();' 在 main() 返回之前的函数似乎总是在打印结果之前阻止程序退出：请参见下面的示例代码：

int main(){ 字符串 fname, lname;

```
 //ask user to enter name first and last name
  cout << "Please enter your first name: ";
  cin >> fname;

  cout << "Please enter your last name: ";
  cin >> lname;     
  cout << "\n\n\n\nyour first name is: " << fname << "\nyour last name is: " 
  << lname <<endl;

  //stop program from exiting before printing results on the screen
  cin.get();
  return 0; 
```

}

* * *

## 回答 #13

> 赞同：-2
> 
> 时间：2013-02-10T09:03:30.607

在 main 中的 return 语句之前，插入以下代码：

系统（“暂停”）；

这将保持控制台，直到您按下一个键。

```
#include<iostream>
#include<string>

using namespace std;

int main()
{
    string s;
    cout << "Please enter your first name followed by a newline\n";
    cin >> s;
    cout << "Hello, " << s << '\n';
    system("pause");
    return 0; // this return statement isn't necessary
} 
```

* * *

## 回答 #14

> 赞同：-3
> 
> 时间：2009-05-23T19:47:00.227

要学习的第二件事（有人会争辩说这应该是第一件事）是操作系统的命令行界面以及编译器/链接器标志和开关。

# perl - 如何使用 Perl 制作 shell 脚本？

> ID：902272
> 
> 赞同：1
> 
> 时间：2009-05-23T19:28:19.330
> 
> 标签：perl, shell, find, replace

我有一个名为 replaceUp 的 Perl 脚本：

```
 #!/usr/bin/perl                                          

 search=$1
 replace=$2

 find . -type f -exec perl -p -i -e "s/$search/$replace/g" {} \; 
```

脚本未加载。这表明我的脚本是错误的。

**如何使用 Perl 制作 shell 脚本？**

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-23T19:29:26.380

第一行应该是`#!/bin/sh`，不是`#!/usr/local/bin/perl`。你误认为这是一个 Perl 脚本；它是一个调用 Perl 的 shell 脚本。

它也不会真正起作用，因为 $search 和 $replace 不会被插在单引号内。*在双引号内*尝试单引号。

或者更好的是，试试[我的批量搜索/替换 Perl 脚本](http://lostsouls.org/grimoire_convert_all)。我为此保留了一个纯 Perl 脚本，因为像大规模搜索/替换一样危险，您不需要多层次的 shell 元字符解释，将其从危险变为绝对致命。

# php - 在没有用户执行的情况下重置 MySQL 字段值

> ID：902277
> 
> 赞同：0
> 
> 时间：2009-05-23T19:29:08.173
> 
> 标签：php, mysql

我需要在午夜自动重置 MySQL 字段值。它是表中特定行中的特定列。我知道如何在 PHP 中执行此操作，但我不知道如何在午夜执行 PHP 脚本，而无需别人自己动手。您有任何可行的解决方案吗？

编辑：-------------------- 最好不使用 Cron Jobs。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-23T19:33:18.150

如果您在 linux 上运行，您将使用[cronjob](http://en.wikipedia.org/wiki/Cron)

在大多数发行版中，有一个名为 crontab 的命令可以为您安排任务以及您需要的特定格式：

```
0 0 * * * php /path/to/file.php 
```

**编辑：** 在你编辑你的之前写了这个：p 我不确定还有其他方法。您是否有特定的理由不使用 cronjob？

如果 php 文件被标记为可执行文件，您甚至可能不需要指定 php 部分，即

```
0 0 * * * /path/to/file.php 
```

只需在 linux 命令行中执行“chmod +x /path/to/file.php”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-24T02:22:27.090

也有基于 Web 的 cron 服务。基本上，您设置了一个帐户，然后他们会定期访问您选择的 URL。在您的服务器上，您设置了一个页面来完成您需要完成的工作。最好给它一个不太可能找到的名称，例如 myjob789273634ahhh8s2nhw8sghusgf874wfu.php。你明白了。（请记住，PHP 脚本会在 30 秒后超时。）

这是一个谷歌搜索：**哎呀我是新人，所以我显然不能发布 URL。只需搜索“基于网络的 cron”。

祝你好运/0

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-23T20:29:08.240

您可以在程序中编写一个作业调度程序，以类似 cron 的方式运行作业。它需要用户与系统交互才能触发，但根据您的需要，它可能已经足够好了。这比仅仅运行一个 cronjob 复杂得多，并且不能确保完美的时间（因为它在用户点击页面之前不会运行）。

您可能需要在数据库中添加一个表，该表将列出作业、您希望它们完成的时间以及一个锁定标志，以避免并发尝试运行该作业。每次您的脚本运行时，您都会检查此表中是否存在过期作业并根据需要运行它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-24T00:56:05.563

询问如何在没有 cron（或 Windows 上的计划任务）的情况下每晚同时可靠地启动脚本就像询问如何在没有服务器端语言的情况下制作动态网站。

如果您的应用程序完全依赖于在午夜运行的脚本，那么 cron 是必需的。如果您的用户拥有一家（愚蠢地）不允许 cron 的托管公司，那么他们将不走运。

# c# - 使用从 DataGridView 输入的数据序列化 DataTable

> ID：902279
> 
> 赞同：1
> 
> 时间：2009-05-23T19:29:54.350
> 
> 标签：c#, database, datagridview, datatable

我想知道是否可以通过 DataGridView 将数据添加到 DataTable 并通过序列化将数据保存在 DataTable 中——所有这些都无需创建底层数据库。一个 DataTable 足以满足我要存储的数据量，而数据库绝对是矫枉过正。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-23T20:02:32.287

我想我不明白你关于序列化的问题。

如果将 DataTable 分配给 DataGridView 的 DataSource 属性，当您在表单中输入数据时，它会自动添加到 DataTable 中。

如果要将数据保存在数据库外部的 DataTable 中，则应使用 DataTable WriteXml() 方法（和 ReadXml() 加载数据）。如您所见，数据以 xml 格式序列化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-02-24T21:41:02.007

不仅可能而且非常简单。我将使用包含使用 datagridviews 作为输入的数据表的数据集。dgv 使用 bindingsources 作为其数据源，而 bindingsource 将数据集作为其数据源，将数据表作为数据成员。

我将数据集序列化为 SQL Server 中的 varbinary(max) 列。

（我在我的业务对象上使用强类型属性，但这应该给你的想法）

```
 '-- Copy dataset to property

    '-- Establish locals
    Dim loFormatter As New BinaryFormatter()
    Dim loStream As New System.IO.MemoryStream()

    '-- Serialize the business object
    loFormatter.Serialize(loStream, Me.DsPolicies1)

    '-- Return the created stream
    Me.PoliciesBO1.Dataset_Bytes = loStream.ToArray() 
```

导航策略记录时，对属性进行反序列化

```
 If Me.PoliciesBO1.Count > 0 And Me.PoliciesBO1.CurrentRowIndex >= 0 Then

            Me.clear_bindingsources()

            Dim loformatter As New BinaryFormatter()
            Dim lomemorystream As MemoryStream = _
               New MemoryStream(Me.PoliciesBO1.Dataset_Bytes, 0, _
               Me.PoliciesBO1.Dataset_Bytes.Length, True)

            Me.DsPolicies1 = _
                  CType(loformatter.Deserialize(lomemorystream), dsPolicies)

            '-- Rehook datasource 

            Me.rehook_Bindingsources()

            Me.refresh_dgvs() 
```

最后两个 subs 只是为每个表重置 bindingsource 数据源和数据成员，然后刷新每个 dgv

（我用这些来收集数据来填写 PDF 表格）

唯一棘手的部分是要记住新记录上的数据源必须为空，并且必须在“父”记录指针移动后从数据中完全重新加载。

# asp.net - ASP 菜单栏，静态视图

> ID：902293
> 
> 赞同：0
> 
> 时间：2009-05-23T19:35:15.960
> 
> 标签：asp.net, menubar

我正在寻找一个具有特定类型“动作”的菜单栏

类似于这个网站上的酒吧

[英国广播公司体育](http://news.bbc.co.uk/sport/default.stm)

它完全是静态的，没有动态或“弹出”部分。单击顶部菜单时，页面将重新加载并以不同的颜色显示较低级别。

这可以通过标准 ASP:Menu 控件实现吗？

我不是弹出功能的忠实拥护者，但是我不希望我的所有选项都对我的 root 用户可见

希望这是有道理的

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-23T20:02:07.950

查看这个基本的[ASP.Net 菜单控制页面](http://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/navigation/menu.aspx)。您可以单击“运行”按钮查看非常基本的菜单版本。

使用这种特殊方法的优点是您可以将其绑定到站点地图，因此您不必不断更新菜单代码。您只需将页面添加到站点地图，菜单就会将其选中。

您还可以将菜单动态链接到不同的站点地图，例如一个用于管理菜单，另一个用于普通用户的菜单。

Menu 控件位于工具箱的导航部分。

要试验内置功能（在编写您自己的代码为您做的事情之前），只需将一个菜单控件拖放到您的表单上。然后，使用常用任务菜单：

*   自动格式化——适合快速和肮脏，因为它也设置了悬停样式
*   设置数据源
*   设置视图类型（静态或动态）
*   用编辑器定义菜单项
*   使用模板设置外观

您必须转到属性来设置菜单外观。

# iphone - 谁应该在以编程方式加载的视图上调用 viewDidLoad？

> ID：902294
> 
> 赞同：1
> 
> 时间：2009-05-23T19:36:15.740
> 
> 标签：iphone, cocoa-touch

当我需要以编程方式加载视图时，我执行以下操作：

```
MyController* myController = [[MyController alloc] init];
[[NSBundle mainBundle] loadNibNamed:@"myNib" owner:myController options:nil];
// use my controller here, eg. push it in the nav controller 
```

这工作正常，但我的控制器的 viewDidLoad 永远不会被调用。所以我在 loadNibNamed 调用之后手动调用它，但它似乎不正确。我期待框架代表我调用 viewDidLoad。这是正确的方法还是我错过了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2011-05-30T18:04:50.940

我是 Stack Overflow 的新手，但我发现了这个问题，并发现了其他几种加载 nib 文件的方法，以确保自动调用 viewDidLoad 方法。Ed Marty 的回答是正确的，但它需要您在 ViewController 的代码之外加载 nib 文件，我在这里提供的这两个示例允许您将代码保留在 ViewController 的实现中。不一定是更好的方法，只是不同。如果您知道这样做的任何缺点，请告诉我您的想法。

首先，在 UIViewController 子类的 initWithNibName:bundle: 方法中，您可以替换调用：
`self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];`

像这样：
`self = [super initWithNibName:@"NameOfAlternateNibFile" bundle:nibBundleOrNil];`

或者，您可以通过以下方式完成看似完全相同的事情：

```
[[NSBundle mainBundle] loadNibNamed:@"NameOfAlternateNibFile" owner:self options:nil];
[self setView:self.view]; //this line ensures that the viewDidLoad method is called 
```

关键是理解`$initWithNibName:bundle:`UIViewController.h 文件中函数定义上方的注释中写的内容（包含在我的答案底部，请参见斜体字）。

使用这两种方法中的任何一种方法的好处是 viewDidLoad 在任何一种情况下都会被调用。

以下是 UIViewController.h 中列出的指令：

> 指定的初始化器。如果你继承 UIViewController，你必须调用这个方法的超级实现，即使你没有使用 NIB。（为方便起见，默认的 init 方法将为您执行此操作，并为这两个方法的参数指定 nil。）在指定的 NIB 中，文件所有者代理应将其类设置为您的视图控制器子类，并带有视图出口连接到主视图。如果您使用 nil nib 名称调用此方法，则此类的 -loadView 方法将尝试加载名称与视图控制器的类相同的 NIB。如果实际上不存在这样的 NIB，那么您必须在调用 -view 之前***调用******-setView:*** *，或覆盖 -loadView 方法以编程方式设置您的视图。- (id)initWithNibName:(NSString *)nibNameOrNil 包:(NSBundle *)nibBundleOrNil;*

 ** * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-24T13:40:10.200

您应该加载视图控制器

```
MyController* myController = [[MyController alloc] initWithNibName:@"myNib" bundle:nil]; 
```

确保您`MyController`从 UIViewController 扩展，并且`View`在 Interface Builder 中正确设置了该属性。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-23T21:33:49.590

视图由 UIViewController 延迟加载。如果您`myController.view`在代码中使用访问器，则应该加载并`viewDidLoad`调用视图。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-04-13T17:09:10.963

我注意到了同样的事情。我认为 ViewDidLoad 必须由视图控制器调用。由于您的笔尖中没有视图控制器，因此您必须手动调用 viewdidload。我必须做同样的事情。

# iphone - 核心数据的生产者消费者问题

> ID：902297
> 
> 赞同：6
> 
> 时间：2009-05-23T19:37:07.987
> 
> 标签：iphone, cocoa, cocoa-touch, core-data

我有一个核心数据应用程序。在生产者线程中，我从 Web 服务中提取数据并将其存储在我的对象中并调用 save。我的消费者对象是一个显示相同的表视图控制器。但是，应用程序崩溃并且我收到 NSFetchedResultsController Error: expected to find object (entity: FeedEntry; id: 0xf46f40 ; data: ) in section (null) for delete

在控制台上。当我调试它时，一切正常。所以我明白这就像一个种族问题。

这类问题是如何解决的？使用核心数据设计生产者-消费者应用程序的最佳方式是什么？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-24T02:25:21.140

如果您的目标是 Leopard 或更高版本，Apple 让事情变得更容易。

在您的生产者线程中创建一个与您的主线程中的 MOC 具有相同 PSC 的 MOC。您可以在此线程中从您的 Web 服务中提取对象，创建新对象，然后照常保存它们。

在您的使用者线程中，将您的控制器添加为 NSManagedObjectContextDidSaveNotification 的观察者。您的回调应类似于：

```
- (void) managedObjectContextDidSave:(NSNotification *)notification
{
  NSManagedObjectContext *managedObjectContext = [notification object];
  if(managedObjectContext != self.managedObjectContext)
    [self.managedObjectContext mergeChangesFromContextDidSaveNotification:notification];
} 
```

这样，保存在生产者线程中的对象会自动拉到你的消费者线程中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T23:24:01.710

Core Data 通常不是线程安全的。我的偏好是在后台线程上做最少的工作，并在您从 Web 服务中检索到创建核心数据实体所需的数据后将其传递给主线程。但是，请查看[此文档](http://developer.apple.com/documentation/Cocoa/Conceptual/CoreData/Articles/cdMultiThreading.html)。如果需要，有一些跨线程使用 Core Data 的策略。

# c++ - 为什么这个程序显示看似随机的字符？(C++)

> ID：902309
> 
> 赞同：0
> 
> 时间：2009-05-23T19:46:05.223
> 
> 标签：c++, special-characters

好吧，不是随机的，因为每次都一样，但是

```
#include<iostream>
using namespace std;
int main()
{
    char box[10][10];
    for(int i=-1;i<11;i++)
    {
        cout<<"---------------------"<<endl<<"|";
        for(int j=0;j<10;j++)
        {
            cout<<box[j][i]<<"|";
        }
        cout<<endl;
    }
    intx;cin>>x;
    return 0;
} 
```

输出一系列国际字符（好吧，并非所有字符本身都是“国际”，但我得到了诸如 pi 和西班牙倒问号之类的东西）。无论如何，我知道这是因为程序访问字符尚未初始化，但为什么特定值会创建特定符号，符号的 ASCII 值是什么（如果它们具有 ASCII 值）以及如何在没有故障的情况下获得符号我的程序？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-23T19:48:43.580

你的循环我没有意义......

```
for(int i=-1;i<11;i++) 
```

当您在此处引用框时，这将命中两个无效的索引 -1 和 10：

```
cout<<box[j][i]<<"|"; 
```

与其他循环一样，它应该是 0 到 < 10。

此外，您还没有将 box 的内容初始化为任何内容，因此您正在打印未初始化的内存。你必须先把东西放进你的“盒子”，然后才能拿出任何东西。

符号本身可能是扩展的 ASCII，您可以通过任何扩展的 ASCII 表来获取它们。 [这个](http://www.cdrummond.qc.ca/cegep/informat/Professeurs/Alain/files/ascii.htm)首先出现在谷歌上。例如，您可以这样做：

```
cout << "My extended ascii character is: " << (char)162 << endl; 
```

得到一个疯狂的国际o。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-23T19:51:05.727

出于同样的原因

```
#include <iostream>
using namespace std;
int main()
{
   int x;
   cout << x;
} 
```

显示一个随机值。未初始化的变量（或数组）包含垃圾。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-23T19:50:08.787

> > for(int i=-1;i<11;i++)

那条线是可疑的。-1 到 10？应该是 0 到 9。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-23T19:51:42.450

ASCII码是

```
(int)(box[j][i]) 
```

您只需打印普通`char`的 s，它们是 ASCII 字符，代码从 0 到 255。当打印`wchar_t`s 时，相同的内存被解释为其他字符。

你的循环应该在 [0; 10[不在[-1; 11[

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-23T20:06:48.207

程序显示的符号取决于：

*   恰好在未初始化变量中的内容，以及
*   您计算机的语言环境或演示文稿中使用的编码。

Unicode 参考可能是识别显示特定符号所需的代码的最佳来源。

考虑到您的用户可能没有默认选择相同的编码（或具有正确符号的字体）。您应该检查当前语言环境，或者强制使用特定于您的输出的语言环境，以确保您的输出呈现您希望的方式。

# version-control - 编写我自己的文件版本控制程序

> ID：902314
> 
> 赞同：20
> 
> 时间：2009-05-23T19:47:14.377
> 
> 标签：version-control

似乎有过多的版本控制系统。因此，要得出一个不好的结论，必须很容易写一个。

为了编写一个简单的文件版本控制系统，必须考虑哪些问题？（最少的必要功能是什么？）

对于一个人来说，这是一项可行的任务吗？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-05-23T19:58:29.377

了解版本控制的好地方是[Eric Sink 的 Weblog](http://www.ericsink.com/)。例如，他最近的一篇文章是[版本控制存储中的时间和空间权衡](http://www.ericsink.com/entries/time_space_tradeoffs.html)。

另一个很好的例子是他的系列文章[Source Control HOWTO](http://www.ericsink.com/scm/source_control.html)。是的，这完全是关于如何*使用*源代码控制，但它包含大量关于开发人员在设计系统时必须做出的决策和权衡的信息。最好的例子可能是他关于[Repositories](http://www.ericsink.com/scm/scm_repositories.html)的文章，其中他解释了存储版本的不同方法。我真的从这个系列中学到了很多。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-23T20:59:19.113

多么简单？

可以说，您可以使用单行 shell 脚本 upversion.sh 编写版本控制系统：

```
cp $WORKING_COPY $REPO/$(date +"%s") 
```

对于大型二进制资产，这基本上就是您所需要的！它可以很容易地改进，例如通过将版本文件夹设置为只读，也许记录每个版本的元数据（`$REPO/$(date...).meta`例如，您可以有一个文本文件）

这听起来像是一个巨大的简化，但它与许多电影后期制作设施使用的资产管理系统相差不远（例如）

你真的需要知道你想要的版本，以及为什么..

对于大型二进制资产（例如视频），您需要专注于可视化比较版本的工具。您可能还需要处理依赖项（“我需要 image123.jpg 和 video321.avi 来生成此图像”）

使用代码，您需要专注于诸如使任何两个版本之间的差异变得非常容易之类的事情。此外，由于对源代码的编辑通常很小（来自数千行项目的几个字符），为每个版本复制整个项目的效率会非常低 - 所以你只存储每个版本之间的差异（[增量编码](http://en.wikipedia.org/wiki/Delta_encoding)）。

要对数据库进行版本化，您可能希望在架构上存储信息，跟踪新表或列，或对现有表进行调整（而不是计算数据库文件的增量，或像前两个系统那样制作副本）

没有完美的方法来对所有内容进行版本控制，您必须专注于做好一件事。Git 非常适合文本，但不适用于二进制文件。Adobe Version Cue 非常适合二进制文件（图像），但对文本无用..

我想要考虑的事情可以概括为..

*   你想要什么版本？
*   为什么我不能使用（或扩展/修改）现有系统？
*   我将如何跟踪版本之间的差异？（整个文件？增量？）
*   我还需要将哪些其他数据附加到版本？（作者？时间戳？依赖项？）
*   用户通常需要执行哪些任务（差异化？还原特定文件？）

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-23T20:15:24.647

查看关于 (D)VCS的问题“[**核心概念”。**](https://stackoverflow.com/questions/645008/what-are-the-basic-clearcase-concepts-every-developer-should-know)
简而言之，编写 VCS 将涉及对这些核心概念中的每一个做出决策（中央与分布式、线性与 DAG、以文件为中心与以存储库为中心……）

我相信这不是一个“快速”的项目；）

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-23T19:53:47.797

如果你是 Linus Torvalds，你可以在一个月内写出类似 Git 的东西。

但是“版本控制系统”是一个如此模糊且可扩展的概念，以至于您的问题确实无法回答。

我会考虑问自己想要实现什么（了解 VCS，学习一门语言，...），然后定义一些明确的目标。有一个项目固然好，但在短时间内有一个可达到的目标也很好。小小的成功有利于你的士气。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-23T21:05:05.250

[The Git Parable](http://tom.preston-werner.com/2009/05/19/the-git-parable.html)可以用较少技术性的方式给你一个很好的概述。它是对 git 原理的一个很好的抽象，但它很好地理解了 VCS 应该能够执行什么。除此之外的所有事情都是相当“低级”的决定。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-23T20:00:51.043

这真是一个糟糕的结论。我个人的观点是，问题领域是如此广泛且通常很难，以至于没有人能够“正确”地解决它，因此人们试图一遍又一遍地从不同的角度和不同的假设下解决它。

这当然并不意味着你不应该尝试。请注意，在您之前有很多聪明人，所以您应该做好功课。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-23T19:52:15.677

一个好的delta算法，良好的压缩和网络效率。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-23T19:54:22.630

一个人可以做一个简单的学习机会。您可能会考虑的一个问题是如何有效地存储纯文本增量。一种非常流行的增量格式是[来自 RCS](http://www.gsp.com/cgi-bin/man.cgi?section=5&topic=rcsfile)（许多版本控制程序使用）的格式。您可能想研究它以获得想法。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-23T20:09:02.867

要编写概念证明，您可能可以完成它，实施或借用 Alan 提到的工具。

恕我直言，VCS 最重要的方面是易用性。这听起来像是一个奇怪的说法，但仔细想想，硬盘空间是最容易水平扩展的 IT 商品之一，因此可以容忍糟糕的压缩甚至真正的马虎增量。人们要求改进版本控制系统的主要原因是为了更直观地完成常见任务，或者支持更多人们最终需要但在发布前并不明显的功能。而且由于版本控制工具往往是单一的并且在公司中完全集成，因此切换成本很高，并且可能无法在不破坏现有存储库的情况下支持新功能。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-23T20:11:52.160

最低限度的必要先决条件是详尽且准确的测试套件。没有人（包括您）愿意使用您的新系统，除非您能证明它可以工作、可靠且完全没有错误。

# double - 双打除法不准确（Visual C++ 2008）

> ID：902320
> 
> 赞同：1
> 
> 时间：2009-05-23T19:48:56.963
> 
> 标签：double, division, int64

我有一些代码可以将 QueryPerformanceCounter 返回的时间值转换为以毫秒为单位的双精度值，因为这样计算起来更方便。

该函数如下所示：

```
double timeGetExactTime() {
    LARGE_INTEGER timerPerformanceCounter, timerPerformanceFrequency;
    QueryPerformanceCounter(&timerPerformanceCounter);
    if (QueryPerformanceFrequency(&timerPerformanceFrequency)) {
        return (double)timerPerformanceCounter.QuadPart / (((double)timerPerformanceFrequency.QuadPart) / 1000.0);
    }
    return 0.0;
} 
```

我最近遇到的问题（我认为我之前没有遇到过这个问题，并且没有对代码进行任何更改）是结果不是很准确。结果不包含任何小数，但精确度甚至低于 1 毫秒。

当我在调试器中输入表达式时，结果与我预期的一样准确。

我知道双精度不能保持 64 位整数的精度，但此时，PerformanceCounter 只需要 46 位（双精度应该能够存储 52 位而不会丢失）此外，调试器使用似乎很奇怪用不同的格式来做除法。

这是我得到的一些结果。该程序在调试模式下编译，C++ 选项中的浮点模式设置为默认值（精确 (/fp:precise) ）

```
timerPerformanceCounter.QuadPart: 30270310439445
timerPerformanceFrequency.QuadPart: 14318180
double perfCounter = (double)timerPerformanceCounter.QuadPart;
30270310439445.000

double perfFrequency = (((double)timerPerformanceFrequency.QuadPart) / 1000.0);
14318.179687500000

double result = perfCounter / perfFrequency;
2114117248.0000000

return (double)timerPerformanceCounter.QuadPart / (((double)timerPerformanceFrequency.QuadPart) / 1000.0);
2114117248.0000000

Result with same expression in debugger:
2114117188.0396111

Result of perfTimerCount / perfTimerFreq in debugger:
2114117234.1810646

Result of 30270310439445 / 14318180 in calculator:
2114117188.0396111796331656677036 
```

有谁知道为什么调试器 Watch 中的精度与我的程序中的结果不同？

更新：在进行转换和除法之前，我尝试从 timerPerformanceCounter.QuadPart 中减去 30270310439445，现在它在所有情况下似乎都是准确的。也许我现在只看到这种行为的原因可能是因为我的计算机的正常运行时间现在是 16 天，所以值比我习惯的要大？所以这似乎是一个大数字的划分精度问题，但这仍然不能解释为什么在 Watch 窗口中划分仍然正确。它的结果是否使用比双精度更高的类型？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-23T20:59:13.640

阿迪翁，

如果您不介意性能下降，请在执行除法之前将您的 QuadPart 数字转换为十进制而不是两倍。然后将结果数字转换回两倍。

您对数字的大小是正确的。它会降低浮点计算的准确性。

有关这方面的更多信息，您可能想知道，请参阅：

每个计算机科学家都应该了解浮点运算 [http://docs.sun.com/source/806-3568/ncg_goldberg.html](http://docs.sun.com/source/806-3568/ncg_goldberg.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-24T09:00:57.953

谢谢，使用十进制也可能是一个解决方案。现在我采取了一种稍微不同的方法，它也很有效，至少只要我的程序在不重新启动的情况下运行时间不超过一周左右。我只记得我的程序启动时的性能计数器，并在转换为双精度并进行除法之前从当前计数器中减去它。

我不确定哪种解决方案最快，我想我必须先对其进行基准测试。

```
bool perfTimerInitialized = false;
double timerPerformanceFrequencyDbl;
LARGE_INTEGER timerPerformanceFrequency;
LARGE_INTEGER timerPerformanceCounterStart;
double timeGetExactTime()
{
    if (!perfTimerInitialized) {
        QueryPerformanceFrequency(&timerPerformanceFrequency);
        timerPerformanceFrequencyDbl = ((double)timerPerformanceFrequency.QuadPart) / 1000.0;
        QueryPerformanceCounter(&timerPerformanceCounterStart);
        perfTimerInitialized = true;
    }

    LARGE_INTEGER timerPerformanceCounter;
    if (QueryPerformanceCounter(&timerPerformanceCounter)) {
        timerPerformanceCounter.QuadPart -= timerPerformanceCounterStart.QuadPart;
        return ((double)timerPerformanceCounter.QuadPart) / timerPerformanceFrequencyDbl;
    }

    return (double)timeGetTime();
}
```

# java - 为所有子组件设置属性

> ID：902326
> 
> 赞同：4
> 
> 时间：2009-05-23T19:51:08.503
> 
> 标签：java, awt

我以前从未使用过 Java AWT，现在我有一段代码显示 a`JFrame`并将*所有*子组件的字体属性设置为相同的值。我只想将属性设置在*一个地方*。我怎样才能做到这一点？

在 .NET/WinForms 中，子控件从其父控件继承，因此设置`Form`实例的字体以使其传播到所有控件就足够了。出乎意料的是，这似乎不适用于 AWT。

以下小代码递归地设置所有组件的字体：

```
private void setFontForAll(JFrame f, java.awt.Font font) {
    f.setFont(font);
    setFontRecursive(f.getContentPane().getComponents(), font);
}

private static void setFontRecursive(Component[] components, java.awt.Font font) {
    for (Component c : components) {
        c.setFont(font);
        if (c instanceof java.awt.Container)
            setFontRecursive(((java.awt.Container)c).getComponents(), font);
    }
} 
```

但是，它有四个缺点：

1.  额外的代码，对于带有嵌套布局面板的大型表单，这实际上可能效率很低。
2.  代码是非通用的。如果将来我需要对另一个属性做同样的事情，我必须重写该方法（或以简洁为代价将其重构为更通用）。
3.  用法是非声明性的，即必须在表单创建的最后（在所有子组件都已初始化和添加之后）调用，而不是在任何地方以声明性方式调用。
4.  **它不起作用。**组件设置正确，但并非所有东西都是组件。例如，`TitledBorder`s 的`JPanel`s 没有被设置。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-23T22:00:54.233

[UIManager](http://java.sun.com/javase/6/docs/api/javax/swing/UIManager.html)类是您需要的。在构建用户界面之前，只需告诉它您想要什么字体。但请注意；定义了很多字体键，如果要全部更改，则必须全部设置。

```
UIManager.put( "Button.font", new Font( "Verdana", Font.BOLD, 12f );
UIManager.put( "Label.font", new Font( "Wingdings", Font.ITALIC, 12f );
// ...etc... 
```

您可以通过以编程方式检查返回哈希表的 UIManager.getDefaults() 来查看设置的键和值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-24T12:37:02.760

对于 Swing，您还可以使用命令行参数设置字体：

```
# java -Dswing.plaf.metal.controlFont=Georgia -Dswing.plaf.metal.userFont=Tahoma -jar foo.jar foo.Foo 
```

添加`-Dswing.aatext=true`抗锯齿，使整个 GUI 看起来更好。:)

# objective-c - 与 c++ 相比，objective c 的优势是什么？

> ID：902332
> 
> 赞同：1
> 
> 时间：2009-05-23T19:54:27.530
> 
> 标签：objective-c

> **可能重复：**
> [使用 Objective-C 优于 C++ 有什么优势](https://stackoverflow.com/questions/112702/what-are-the-advantages-of-using-objective-c-over-c)

你能告诉我objective c相对于c++有什么优势吗？读完objective c 编程指南？我认为 c++ 具有相同的功能，如果不相似的话。

为什么像 Webkit 这样的项目需要同时使用 c++ 和 Objective c？我的理解是 Webkit 通用代码在 c++ 中，而 MacOS 指定部分在目标 c 中。

感谢您的任何指点。

# c# - 在生产环境中安装开发工具

> ID：902335
> 
> 赞同：0
> 
> 时间：2009-05-23T19:55:36.140
> 
> 标签：c#, .net, visual-studio-2008

没有在实时生产 Web 服务器上安装 VS 2008 的原因是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-23T20:03:42.113

*鉴于 OP 给出的评论，给出了你这样*做的理由：

> 将使“在我的机器上工作”问题更容易调试

那么我为什么不应该安装它的答案是：消除尝试在实时生产 Web 服务器上调试问题的诱惑。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-23T20:23:07.300

不安装的最大原因：

这意味着您并没有在生产服务器上做一件非常愚蠢的事情。

如果您无法在开发机器上复制*代码中的问题，*那么您需要创建一个临时服务器来准确复制生产环境的配置和环境。如果您仍然无法复制该故障，则意味着您有 a：未能很好地复制环境，b：不了解您在生产环境中的配置足以能够复制它或 c：有未正确配置您的应用程序以应对环境变化。

另一个原因：

您不必在服务器上拥有源代码的副本，也不必在适当的位置轻松编译它。如果您被黑客入侵，您会很高兴您没有这样做，因为您的源代码将被盗，并且/或者黑客将有一种极其简单的方法将恶意代码插入您的应用程序。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-24T12:28:39.187

我同意一些明确指出您不应该在生产中进行开发或调试的帖子。如果发生错误，请确保您有适当的程序来记录必要的数据。

如果在部署新代码时出现任何问题，请恢复到旧代码并使用（异常）数据对开发或登台机器中的代码进行故障排除。

生产服务器应该只具有完成其角色所需的基本软件。在它上面安装一个完整的 IDE 似乎太重了。它还会提出一个问题，即一旦发布了 SP，您是否需要更新 IDE？如果安装出错了怎么办？所有这些问题都可以通过不在服务器上安装 VS 轻松避免。

生产服务器上的东西越少，出错的可能性就越小。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-23T20:11:29.460

我能想到几个：

*   不应在生产服务器上进行开发。

程序的开发和测试应始终在开发服务器上进行。然后将开发产品部署到生产服务器。在生产服务器上进行开发存在使生产服务器崩溃的风险。

*   仅应在生产服务器上安装生产软件

开发软件包含使生产服务器的操作环境复杂化的组件。例如，可能存在 DLL 版本控制问题。一般来说，生产服务器应该只包含完成其工作所需的软件。

*   在生产服务器上拥有开发（或其他）工具会鼓励使用非生产服务器的用途。

也许您正在考虑安装 VS 2008 以方便使用。触手可及的工具真是太好了。但是，现在在不遵循软件开发过程的情况下，偷工减料并在服务器上即时修复某些东西有多容易？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-24T05:30:35.997

如果您有足够的许可证并且团队纪律严明，我想知道您为什么不能这样做。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-23T20:01:58.247

没有其他原因，除了磁盘空间，也许是浪费了许可证，为什么不呢？但是，在现场生产 Web 服务器上安装 VS 2008 的原因是什么？你可以远程调试，如果你有一些你不能在你的开发或测试环境中复制的错误，并且真的必须实时调试它。所以我想不出任何理由这样做。

# file - Applescript 将文件复制到新文件夹

> ID：902342
> 
> 赞同：11
> 
> 时间：2009-05-23T19:57:59.783
> 
> 标签：file, copy, applescript, directory

我需要创建一个 AppleSript，它将指定文件从一个文件夹复制到新创建的文件夹。

这些文件需要在 AppleScript 编辑器中指定，例如：

```
start

fileToBeMoved = "Desktop/Test Folder 1/test.doc"
newfoldername = "Test Folder 2"

make newfolder and name it 'newfoldername'
copy 'fileToBeMoved' to 'newfolder'

end 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-26T06:57:20.753

一般来说：

```
tell application "Finder"
  make new folder at alias "Macintosh HD:Users:user:Desktop:" with properties {name:"Test Folder 2"}
  copy file "Macintosh HD:Users:user:Desktop:Test Folder 1:test.doc" to folder "Macintosh HD:Users:user:Desktop:Test Folder 2"
end tell 
```

您可以添加代表 POSIX 文件和路径的变量名称。

显然，冒号 (:) 是文件夹和文件名的保留字符。

```
set desktopFolder to "Macintosh HD/Users/user/Desktop/"
set desktopFdrPosix to quoted form of POSIX path of desktopFolder
set newFolderName to "Test Folder 2"
set destinationFdrPosix to quoted form of desktopFdrPosix & POSIX file newFolderName
set sourceFilename to "Test Folder 1/test.doc"
set sourceFnPosix to quoted form of desktopFdrPosix & POSIX file sourceFilename

tell application "Finder"
  make new folder at alias desktopFdrPosix with properties {name:newFolderName}
  copy file sourceFnPosix to folder destinationFdrPosix
end tell 
```

如果目标文件夹已存在，您可能还需要添加错误检查。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-26T06:44:18.300

AppleScript 的诀窍在于移动文件是使用别名完成的。

`do shell script`更现实的是，如果您使用 Automator 或类似的东西，制作一个可以从 AppleScript 运行的 shell 脚本可能会更容易。

```
#!/bin/sh

fileToBeMoved="$HOME/Desktop/Test Folder 1/test.doc"
newFolderName="Test Folder 2"
mkdir "$newFolderName"
cp -a "$fileToBeMoved" "$newFolderName" 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-08-20T14:21:01.493

```
set home_path to path to home folder as string
set work_folder to alias (home_path & "AutomationAppleScript:ScreenShots:")
tell application "Finder"
    duplicate every file of work_folder to folder "Archive" of home
end tell 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-05-19T17:20:32.197

这适用于复制到已安装的网络卷：

```
 mount volume "afp://compname.local/mountpoint"
    tell application "Finder"
      duplicate file "MyTextFile.txt" of folder "Documents" of home to disk "mountpoint"
      eject "mountpoint"
    end tell 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-22T17:04:47.900

如果您正在寻找同步，您可以在 AppleScript 中运行以下 shell 脚本：

`rsync -a /Users/username/folderToBeCopiedFrom /Volumes/folderToBeCopiedTo/`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-23T12:43:10.533

```
tell application "Finder"
    make new folder at desktop with properties {name:"folder"}
    duplicate POSIX file "/usr/share/doc/bash/bash.html" to result
end tell

POSIX file ((system attribute "HOME") & "/Documents" as text)
tell application "Finder" to result

tell application "Finder" to duplicate (get selection) to desktop replacing yes

-- these are documented in the dictionary of System Events
path to home folder
POSIX path of (path to documents folder)
path to library folder from user domain
path to desktop folder as text

-- getting files as alias list is faster
tell application "Finder"
    files of entire contents of (path to preferences folder) as alias list
end tell 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-01-15T01:23:14.010

我使用了 Chealions shell 脚本解决方案。不要忘记使您的脚本文件可执行： `sudo chmod u+x scriptFilename`

还要删除`=`变量赋值中符号之间的空格。不适用于空格，例如：`newFolderName="Test Folder 2"`

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-03-28T02:28:34.173

简单的方法如下所述

```
set home_path to path to home folder as string
set work_folder to alias (home_path & "AutomationAppleScript:ScreenShots:")
tell application "Finder"
    duplicate every file of work_folder to folder "Archive" of home
end tell 
```

# c++ - 鼠标坐标的3d点三角形交点？

> ID：902348
> 
> 赞同：2
> 
> 时间：2009-05-23T20:00:12.603
> 
> 标签：c++, opengl, 3d, mouse, intersection

我知道如何测试点和三角形之间的交点。

...但是我不明白，如何使用鼠标坐标将点的起始位置精确地移动到屏幕平面上，因此点角度应该根据鼠标光标在屏幕上的位置而改变，这也应该有效完全不管我在我的 OpenGL 应用程序中使用哪个透视角度，所以点角度在不同的透视角度上会有所不同...... gluPerspective() 是我正在谈论的函数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-23T20:15:25.350

好吧，我会试一试，猜猜你的意思。猜测是您想用鼠标选择对象。查看：

[glUn项目](http://nehe.gamedev.net/data/articles/article.asp?article=13)。

这会将屏幕坐标转换回 3d 世界坐标。

如果您遇到问题，[Google会提供更多信息。](http://www.google.se/search?hl=sv&rlz=1G1GGLQ_SVSE328&q=ray+picking+gluUnProject&btnG=S%C3%B6k&meta=)

干杯！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-24T10:59:08.057

是的，我想移动屏幕平面上的点，例如，我可以使用 3d 坐标在鼠标当前所在的那个点上渲染一个立方体，然后我从那个位置拍摄一条线到鼠标所在的地方正在指向，所以它会击中我的 3d 世界中的三角形，以及我如何用鼠标选择该对象。

抱歉不清楚：/

--

编辑：是的，我得到了它与那个 nehe 教程一起工作！谢谢，我不知道会这么容易！

这是我现在使用的代码，效果很好：

```
void GetOGLPos(int x, int y, GLdouble &posX, GLdouble &posY, GLdouble &posZ){
    GLint viewport[4];
    GLdouble modelview[16];
    GLdouble projection[16];
    GLfloat winX, winY, winZ;

    glGetDoublev(GL_MODELVIEW_MATRIX, modelview);
    glGetDoublev(GL_PROJECTION_MATRIX, projection);
    glGetIntegerv(GL_VIEWPORT, viewport);

    winX = (float)x;
    winY = (float)viewport[3]-(float)y;
    glReadPixels(x, int(winY), 1, 1, GL_DEPTH_COMPONENT, GL_FLOAT, &winZ);

    gluUnProject(winX, winY, winZ, modelview, projection, viewport, &posX, &posY, &posZ);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-24T11:13:14.537

您需要生成一条穿过鼠标位置垂直于屏幕的射线（线）。

我建议您先了解一些有关 3d 几何和 2d 投影的基本信息，然后再进一步了解。

查看[维基百科](http://en.wikipedia.org/wiki/3D_computer_graphics)

谷歌上的[图书搜索](http://books.google.co.uk/books?q=3d+graphics+basics&source=in&ei=fSsZSv7bDMS4jAe98YmrCw&sa=X&oi=book_group&ct=title&cad=bottom-3results&resnum=11)已经提出了相当多的书名。

Foley & Van Dam 虽然是权威书籍 - 在[Amazon.co.uk](http://www.amazon.co.uk/Computer-Graphics-reissued-2nd-Ed/dp/0201848406)或[Amazon.com上](https://rads.stackoverflow.com/amzn/click/com/0201848406)

# user-interface - 在 GTK+ (gtkD) 中处理按键

> ID：902349
> 
> 赞同：2
> 
> 时间：2009-05-23T20:00:46.143
> 
> 标签：user-interface, events, gtk, d, gtkd

我在玩[gtkD](http://www.dsource.org/projects/gtkd)（GTK+ 的 D 绑定）

我有一个`window`对象，实例`gtk.MainWindow`。我想处理它的按键。

*   如何？
*   如何处理特殊键（例如箭头键、pgup/pgdn 等）？

* * *

PS我知道这类问题可以用谷歌和其他东西来回答，但我在stackoverflow上看到了很多“更简单”的问题，所以我认为提问并没有什么坏处。

另外，有时，基本的东西往往会被隐藏在文档页面下。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-24T03:56:21.750

这是可能有帮助的示例代码

```
import gdk.Keysyms; //keys enums are defined here

private void func(Button sender)
{
    //button pressed
}

but.addOnClicked(&func);

private bool func2(GdkEventKey* ev, Widget sender)
{
    if(ev.keyval == GdkKeysyms.GDK_Tab) 
        return true; //we handle Tab ourselves and prevents default behaviour
    else
        return false; //we didnt handle it so gtk does default behaviour
}

win.addOnKeyPress(&func2); 
```

# unix - 无法通过 Vim/Emacs 停止创建到 root 的备份

> ID：902353
> 
> 赞同：0
> 
> 时间：2009-05-23T20:00:59.543
> 
> 标签：unix, vim, path, backup

**问题 1：**我的 Vim 使用扩展名 ~ 备份到我的根目录

我的 .vimrc 中有以下行

```
set backup backupdir=~/tmp/vim//,~/tmp//,.//,/var/tmp//,/tmp//$ 
```

但是，我在该行中看不到根目录。

**为什么我的*Vim***将带有扩展名 ~ 的**shell 脚本备份到我的根目录？**

* * *

**问题 2：**我的 Zsh 在登录时运行我的 PATH 中的 shell 脚本。例如，我的“replaceUp”shell 脚本在登录时从我的根目录开始。默认情况下，我将其保存在 ~/bin/shells/apps 中。

**为什么 Zsh 在登录时运行我的 PATH 中的 shell 脚本？**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-24T16:11:24.800

以 ~ 结尾的文件是 vim 在编辑文件时使用的交换文件。您可以尝试设置`backupdir`和`directory`变量

```
set backupdir=~/tmp/vim//,~/tmp//,.//,/var/tmp//,/tmp//
set directory=~/tmp/vim//,~/tmp//,.//,/var/tmp//,/tmp// 
```

# vb.net - := 语法有什么用？

> ID：902367
> 
> 赞同：6
> 
> 时间：2009-05-23T20:06:05.650
> 
> 标签：vb.net, syntax, function, language-features, byref

我是一名从事 VB.NET 项目的 C# 开发人员，当我调用带有 ByRef 参数的函数时，VS 一直试图让我使用 := thingie，如下所示：

```
While reader.Read()
HydrateBookFromReader(reader:=???) 
```

HydrateBookFromReader 函数具有以下签名：

```
Public Function HydrateBookFromReader(ByRef reader As SqlDataReader) As Book 
```

为什么智能感知一直坚持我使用 := 构造，它是做什么用的？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-23T20:11:29.400

在 VB 中，:= 用于指定命名参数。

```
Contact(Address:="2020 Palm Ave", Name:="Peter Evans") 
```

这对于指定可选参数特别有用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-23T20:14:08.147

> 为什么智能感知一直坚持我使用 := 构造，它是做什么用的？

重要的是要注意 IntelliSense 不是*坚持*，而是*建议*。在您的情况下使用它没有意义……此功能主要用于带有许多可选参数的非常长的参数列表，您只想传递最后一个参数。它在使用 Microsoft Office Interop 时很有用。

另外（因为您在标签中提到它）：这与`ByRef`. `ByRef`等效于 C# 中的`ref`and `out`，即它允许方法操作参数本身。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-23T20:21:45.617

Intellisense 可能建议使用 := 语法，但我怀疑没有它也可以编译。

```
HydrateBookFromReader(myReader); 
```

In future versions of C# where optional parameters are allowed, named parameters will allow you to specify some parameters but not others, and to specify parameters in a different order than they were declared. Named parameters will also allow you to optionally clarify the purpose of the parameter being passed in, making the code more readable in some cases.

Named parameters will be especially important in c# 4.0 for COM Interop, where many superfluous parameters can be eliminated.

Anders Hejlsberg has an excellent discussion about the future of C# on Channel 9 at [http://channel9.msdn.com/pdc2008/TL16/](http://channel9.msdn.com/pdc2008/TL16/). His discussion about named parameters is at 40 minutes and 45 seconds into the talk.

# workflow - 您推荐哪个工作流引擎？

> ID：902375
> 
> 赞同：5
> 
> 时间：2009-05-23T20:09:24.440
> 
> 标签：workflow

我正在考虑在这个即将到来的项目中使用工作流引擎的想法。我们知道使用工作流引擎有很多注意事项，并且我们在许多平台上拥有丰富的开发经验，因此我们愿意让工作流引擎的选择优先于我们最喜欢的工具集或开发人员 IDE。

我们对内部工作流（即用于轻松更改 ERP 目的而不涉及额外编码时间的 petri 网）比对外部工作流（即，将 SOAP 调用聚合到事务感知、更高级别的 SOA）更感兴趣。您会推荐哪个工作流引擎？我们对[甲骨文](http://www.oracle.com/technology/products/integration/workflow/workflow_fov.html)、[微软](http://msdn.microsoft.com/en-us/netframework/aa663328.aspx)和一些[开源产品的产品进行了](http://www.activevos.com/community-open-source.php) [粗略](http://www.yawl-system.com/)的研究。这一切都非常令人难以抗拒，因此请仅在您具有实施内部工作流程的真实生活经验时才做出回应。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2010-06-12T00:26:10.573

[如果您可以使用状态机，那么我会推荐Nicholas Blumhardt（Autofaq 创建者）](http://code.google.com/p/stateless/)名为 StateLess 的开源项目。他的方法避免了运行时引擎持有长时间运行的工作流的问题，因为状态是由一个简单的变量定义的，例如字符串或 int。

这是一个示例状态机：

```
var phoneCall = new StateMachine<State, Trigger>(State.OffHook);

phoneCall.Configure(State.OffHook)
    .Permit(Trigger.CallDialed, State.Ringing);

phoneCall.Configure(State.Ringing)
    .Permit(Trigger.HungUp, State.OffHook)
    .Permit(Trigger.CallConnected, State.Connected);

phoneCall.Configure(State.Connected)
    .OnEntry(() => StartCallTimer())
    .OnExit(() => StopCallTimer())
    .Permit(Trigger.LeftMessage, State.OffHook)
    .Permit(Trigger.HungUp, State.OffHook)
    .Permit(Trigger.PlacedOnHold, State.OnHold);

// ...

phoneCall.Fire(Trigger.CallDialled);
Assert.AreEqual(State.Ringing, phoneCall.State); 
```

您的状态可以是一个整数，这将允许您从数据库中为其提供当前状态。这可以在状态机的构造函数上设置如下：

```
var stateMachine = new StateMachine<State, Trigger>(
    () => myState.Value,
    s => myState.Value = s); 
```

与运行 Windows 工作流所需的多个项目相比，您可以在一个程序集中实现这一点。维护成本极低，没有为您生成代码的“设计师”等。同样，它很简单，而且美在其中。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-23T20:26:37.137

我过去部署过[K2](http://www.k2.com/en/index.aspx)和 WF 系统。K2很强大，但很花钱。WF是一个弱者，但进步很快。两者都很好地与 .NET 堆栈（特别是 MOSS）集成，并且都具有很好的工具集成。一旦您了解了工作流模型，两者都相对容易开发。

您可以从许多不同的 MS 合作伙伴那里获得解决方案支持，尽管我猜测 WF 更容易获得解决方案支持（即，更多的合作伙伴拥有更多了解 WF 的顾问而不是 K2）。

不幸的是，我对你提到的 Oracle 产品或开源替代品没有任何经验，所以我无法评论这些。

如果您不知所措，我建议您查看[WF Virtual Labs](http://msdn.microsoft.com/en-us/virtuallabs/aa740389.aspx)（页面底部）。他们会让你掌握技术，掌握术语，经历一些场景。一旦你有了这些，理解 WF 如何适应你想要做的事情应该会容易得多。另外，我可以推荐[Essential Windows Workflow——](https://rads.stackoverflow.com/amzn/click/com/0321399838)非常好的书。[这是PDC 对 WF 4.0](http://channel9.msdn.com/pdc2008/TL17/)的一个很好的介绍。

# dependency-injection - StructureMap 拦截器

> ID：902387
> 
> 赞同：6
> 
> 时间：2009-05-23T20:12:48.880
> 
> 标签：dependency-injection, structuremap, interceptor

我有一堆实现各种接口的服务。例如，`IAlbumService`等`IMediaService`。

我想记录对这些接口上每个方法的调用。如何使用 StructureMap 执行此操作？

[我意识到这与这个问题](https://stackoverflow.com/questions/420891/how-do-i-tell-windsor-to-add-an-interceptor-to-all-components-registered-that-imp)几乎相同，只是我没有使用温莎。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-11-29T11:57:41.057

我想你正在寻找[这个答案](https://stackoverflow.com/questions/23593914/interception-using-structuremap-3#23598815)。

```
static void Main()
{
    ObjectFactory.Configure(x =>
    {
        x.For<Form>().Use<Form1>()
            .InterceptWith(new ActivatorInterceptor<Form1>(y =>  Form1Interceptor(y), "Test"));
    });
    Application.Run(ObjectFactory.GetInstance<Form>());

}

public static void Form1Interceptor(Form f)
{
    //Sets the title of the form window to "Testing"
    f.Text = "Testing";
} 
```

我不会在实际应用程序中使用 ObjectFactory，但至少有这个概念。

# java - 如何使用 Java 确定 Google AppEngine 数据存储中的给定键是否存在对象？

> ID：902393
> 
> 赞同：4
> 
> 时间：2009-05-23T20:15:10.577
> 
> 标签：java, google-app-engine, sharding, google-cloud-datastore

我正在尝试将分片计数器示例 (code.google.com/appengine/articles/sharding_counters.html) 移植到 Java。唯一的问题是 Java API 没有类似于 Python 的“get_by_key_name”的调用。这是基本思想：

```
 Transaction tx = pm.currentTransaction();
            Key key = KeyFactory.createKey(CounterShard.class.getSimpleName(), counter + randomIndex);
            CounterShard shard = pm.getObjectById(CounterShard.class, key);
            if (shard == null) {  // API does not work this way...
                shard = new CounterShard(key, counter);
            }
            shard.increment();
            pm.makePersistent(shard);
            tx.commit(); 
```

不幸的是，这在我第一次运行它时会引发 JDOObjectNotFoundException。我可以运行查询以确定给定名称的计数器是否存在，但这不是事务性的。另一个线程可以做同样的事情，最后两者都会创建一个具有相同键的对象。

据我了解，事务中支持的唯一操作（对于 Java API）是 get 和 put。那么我如何才能通过键锁定一个尚不存在的对象（即没有'get'）并确保我是第一个也是唯一一个创建它的对象？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-24T05:18:18.303

在此处查看演示代码

[http://code.google.com/p/googleappengine/source/browse/trunk/java/demos/shardedcounter/README](http://code.google.com/p/googleappengine/source/browse/trunk/java/demos/shardedcounter/README)

# javascript - 如何劫持javascript中的键组合？

> ID：902407
> 
> 赞同：1
> 
> 时间：2009-05-23T20:20:32.657
> 
> 标签：javascript, keyboard-shortcuts

例如，在 Gmail 中，当一个人按下`Ctrl`+时`B`，它不会被传递给浏览器（通常会打开某种书签管理器），它会劫持它以进行格式化，即为邮件中的 ur 开启粗体格式作曲的中间。`Ctrl`+ `i`, `Ctrl`+相同`u`。

这是怎么做到的？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-23T21:03:39.277

您可以将一个`onkeydown`或`onkeyup`事件处理程序附加到全局`document`对象。例如，如果我想在每次按下 Ctrl-M 时将标题栏更改为“asdf”，我会通过 注册事件处理程序`window.onload`，如下所示：

```
window.onload = function()
{
    document.onkeydown = function(event)
    {
        var keyCode;

        if (window.event) // IE/Safari/Chrome/Firefox(?)
        {
            keyCode = event.keyCode;
        }
        else if (event.which) // Netscape/Firefox/Opera
        {
            keyCode = event.which;
        }

        var keyChar = String.fromCharCode(keyCode).toLowerCase();

        if (keyChar == "m" && event.ctrlKey)
        {
            document.title = "asdf";
            return false;  // To prevent normal minimizing command
        }
    };
}; 
```

W3Schools 有更多关于使用这些事件的信息：[`onkeydown`](http://www.w3schools.com/jsref/jsref_onkeydown.asp)和[`onkeyup`](http://www.w3schools.com/jsref/jsref_onkeyup.asp).

另外，我想我应该注意到浏览器之间在事件属性方面存在一些差异（例如，在 Firefox 中，您应该通过 访问键码`event.which`，而在 IE 中它是`event.keyCode`，尽管 Firefox 可能支持`event.keycode`- 混淆，不是吗？）。因此，我建议通过 JavaScript 框架（例如[Prototype](http://prototypejs.org)或[jQuery](http://jquery.com)）来完成这些工作，因为它们会为您处理所有令人讨厌的兼容性问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-24T02:40:23.670

这是使用 jQuery 并执行[htw 解决方案](https://stackoverflow.com/questions/902407/how-to-hijack-key-combos-in-javascript/902490#902490)的 HTML 页面的源代码。

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
  <head>
    <title>Hijack Example</title>
    <script type="text/javascript" src="../scripts/jquery-1.2.1.js">
    </script>
    <script type="text/javascript">
        $(function(){
            document.title = "before keypress detected";
            $(document).keydown(function(event) {
                // alert('stuff happened: ' + msg + " " + event.keyCode);
                var keyChar = String.fromCharCode(event.keyCode).toLowerCase();
                if (keyChar == "m" && event.ctrlKey) {
                    document.title = "ctrl-m pressed!";
                }
            });
         });
    </script>
  </head>

  <body id="body">
    <p>Change the path to jquery above as needed (search for ../scripts/jquery-1.2.1.js)</p>
    <p>Watch the title bar, then press control-M, then watch the title bar again!</p>
  </body>
</html> 
```

希望这对某人有帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-23T20:53:17.723

使用`onkeydown`or`onkeyup`事件触发处理函数：

```
var body = document.getElementsByTagName("body")[0];
body.onkeydown = function(event) {
    var str = "";
    for (var prop in event) {
        str += prop + ": " + event[prop] + "<br>";
    }
    body.innerHTML = str;
}; 
```

有了它，您可以看到*事件*对象具有哪些属性。

# python - 如何在 Python 的 SQL 语句中使用变量？

> ID：902408
> 
> 赞同：111
> 
> 时间：2009-05-23T20:20:33.747
> 
> 标签：python, sql

我有以下 Python 代码：

```
cursor.execute("INSERT INTO table VALUES var1, var2, var3,") 
```

其中`var1`是整数，`var2`是`var3`字符串。

如何在没有 Python 的情况下编写变量名，将它们作为查询文本的一部分？

* * *

## 回答 #1

> 赞同：135
> 
> 时间：2009-05-23T20:25:24.627

```
cursor.execute("INSERT INTO table VALUES (%s, %s, %s)", (var1, var2, var3)) 
```

请注意，参数作为元组传递。

数据库 API 对变量进行正确的转义和引用。注意不要使用字符串格式化运算符 ( `%`)，因为

1.  它不做任何转义或引用。
2.  它容易受到不受控制的字符串格式攻击，例如[SQL 注入](http://en.wikipedia.org/wiki/SQL_injection)。

* * *

## 回答 #2

> 赞同：84
> 
> 时间：2009-05-24T01:14:23.810

Python DB-API 的不同实现允许使用不同的占位符，因此您需要找出您正在使用的占位符——它可能是（例如使用 MySQLdb）：

```
cursor.execute("INSERT INTO table VALUES (%s, %s, %s)", (var1, var2, var3)) 
```

或（例如使用 Python 标准库中的 sqlite3）：

```
cursor.execute("INSERT INTO table VALUES (?, ?, ?)", (var1, var2, var3)) 
```

或其他人（在`VALUES`您可以拥有`(:1, :2, :3)`，或“命名样式”`(:fee, :fie, :fo)`或`(%(fee)s, %(fie)s, %(fo)s)`将 dict 而不是 map 作为第二个参数传递给 的地方`execute`）。检查您正在使用的 DB API 模块中的字符串常量，并在[http://www.python.org/dev/peps/pep-0249/](http://www.python.org/dev/peps/pep-0249/)`paramstyle`上查找 paramstyle以查看所有参数传递样式是什么！

* * *

## 回答 #3

> 赞同：59
> 
> 时间：2014-02-12T17:16:52.423

很多种方法。**不要**在实际代码中使用最明显的（`%s`with ），它容易受到[攻击](http://en.wikipedia.org/wiki/SQL_injection)。`%`

**[这里从 sqlite3 的 pydoc](http://docs.python.org/2/library/sqlite3.html)**复制粘贴：

```
# Never do this -- insecure!
symbol = 'RHAT'
c.execute("SELECT * FROM stocks WHERE symbol = '%s'" % symbol)

# Do this instead
t = ('RHAT',)
c.execute('SELECT * FROM stocks WHERE symbol=?', t)
print c.fetchone()

# Larger example that inserts many records at a time
purchases = [('2006-03-28', 'BUY', 'IBM', 1000, 45.00),
             ('2006-04-05', 'BUY', 'MSFT', 1000, 72.00),
             ('2006-04-06', 'SELL', 'IBM', 500, 53.00),
            ]
c.executemany('INSERT INTO stocks VALUES (?,?,?,?,?)', purchases) 
```

**如果您需要更多示例：**

```
# Multiple values single statement/execution
c.execute('SELECT * FROM stocks WHERE symbol=? OR symbol=?', ('RHAT', 'MSO'))
print c.fetchall()
c.execute('SELECT * FROM stocks WHERE symbol IN (?, ?)', ('RHAT', 'MSO'))
print c.fetchall()
# This also works, though ones above are better as a habit as it's inline with syntax of executemany().. but your choice.
c.execute('SELECT * FROM stocks WHERE symbol=? OR symbol=?', 'RHAT', 'MSO')
print c.fetchall()
# Insert a single item
c.execute('INSERT INTO stocks VALUES (?,?,?,?,?)', ('2006-03-28', 'BUY', 'IBM', 1000, 45.00)) 
```

* * *

## 回答 #4

> 赞同：27
> 
> 时间：2009-05-23T20:28:11.800

[http://www.amk.ca/python/writing/DB-API.html](http://web.archive.org/web/20090504233107/amk.ca/python/writing/DB-API.html)

当你简单地将变量的值附加到你的语句时要小心：想象一个用户给自己命名`';DROP TABLE Users;'`——这就是你需要使用 SQL 转义的原因，当你`cursor.execute`以体面的方式使用时，Python 为你提供了这种转义。URL 中的示例是：

```
cursor.execute("insert into Attendees values (?, ?, ?)", (name, seminar, paid)) 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2020-11-22T10:13:27.110

对于没有经验的 Python 用户来说，提供单个值的语法可能会让人感到困惑。

给定查询

```
INSERT INTO mytable (fruit) VALUES (%s) 
```

通常*，即使是单例，传递给的值`cursor.execute`仍然必须是[元组](https://docs.python.org/3/library/stdtypes.html#tuple)`(value,)`，因此我们必须提供单元素元组，如下所示：

```
cursor.execute("""INSERT INTO mytable (fruit) VALUES (%s)""", ('apple',)) 
```

传递单个字符串

```
cursor.execute("""INSERT INTO mytable (fruit) VALUES (%s)""", ('apple')) 
```

将导致错误，该错误因 DB-API 连接器而异，例如

*   psycopg2：

    > TypeError：字符串格式化期间并非所有参数都转换了

*   sqlite3

    > sqlite3.ProgrammingError：提供的绑定数量不正确。当前语句使用 1，提供了 5 个

*   mysql.connector

    > mysql.connector.errors.ProgrammingError: 1064 (42000): 你的 SQL 语法有错误；

* * *

* pymysql 连接器处理单个字符串参数而不会出错。但是最好将字符串包装在一个元组中，即使它是单个的，因为

*   如果您切换连接器包，则无需更改代码
*   您保持查询参数的一致心理模型是一系列对象而不是单个对象。

# c# - 选择哪个 WinForms CompositeUI 框架？

> ID：902414
> 
> 赞同：4
> 
> 时间：2009-05-23T20:24:10.107
> 
> 标签：c#, cab, acropolis

我的团队在为我们公司开发头部应用程序之前几分钟，我们在设计中遇到了障碍。我的团队使用 C#、.NET 3.5 开发 WinForms 应用程序。

我们在设计中需要做的第一件事是决定使用哪个 CompositeUI 框架。好吧，首先我们确定我们将使用 CAB。但考虑到 P&P 不再参与其中，这是正确的选择吗？雅典卫城呢？它足够稳定并且会在接下来的几年里一直在这里吗？

所以这是我的问题：什么是足够稳定并且适合将领导我的团队未来 3-4 年的应用程序的框架？

需要你的帮助。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-23T20:34:34.047

如果您打算使用 WinForms，[Smart Cient Software Factory](http://www.codeplex.com/smartclient)是您的最佳选择。从我在市场上看到的情况来看，大多数人正在远离 WinForms 并转向 WPF。我正在评估我的公司目前从 WinForms 迁移到 WPF 需要什么。我现在喜欢对 WinForms 的支持，但如果您的时间跨度是 3-4 年，我强烈建议您改用[WPF 。](http://msdn.microsoft.com/en-us/netframework/aa663326.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-23T20:50:38.960

如果你想坚持使用 Winforms，除了 Smart Client Software Factory 之外，还有很多第三方解决方案（例如[Empinia或](http://www.empinia.org/)[CodeProject](http://www.codeproject.com/KB/smart/GenesisSCFpI.aspx)上显示的 Genesis Hybrid Smartclient Framework ）。这里的问题仍然是它们是否足够稳定并且有足够的耐力在 3-4 年内仍然存在。

另一方面，如果您正在考虑这个相当长的时间框架，考虑 WPF 可能真的会得到回报。是的，这是一个学习曲线，是的，VS 2008 中的工具支持还没有完全满足。但是使用 VS 2010 情况会好很多，而且微软将在 WPF 上投入大量人力——VS 2010 本身是用 WPF 编写的。

对于 WPF，有[Prism](http://compositewpf.codeplex.com/)形式的 P&P 指导，这是非常有前途的并且看起来经过深思熟虑。进入 WPF 还为您带来了额外的好处，即基本上“免费”了解 Silverlight（它是 WPF 的一个子集，在其核心）。所以这可能是一个额外的好处。

马克

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-24T08:35:23.543

Glenn Block不久前发布了一些可能会引起兴趣的[指南。](http://codebetter.com/blogs/glenn.block/archive/2008/05/11/prism-cab-and-winforms-futures.aspx)

Brian Noyes 实际上将 PRISM 的一部分[移植](http://www.softinsight.com/bnoyes/2008/10/13/CompositeExtensionsForWindowsForms.aspx)到 WinForms，但我不知道它是否足够好和足够稳定，可以在接下来的几年中用作您的平台。=)

# vb.net - 有没有办法“锁定” ListView 中的最后一项以始终显示？

> ID：902422
> 
> 赞同：0
> 
> 时间：2009-05-23T20:26:48.510
> 
> 标签：vb.net, winforms, .net-3.5, listview

我在 ListView 中为我正在编写的 VB.NET WinForm 程序列出文件夹和文件夹大小。我想合计 ListView 的最后一个条目中的文件夹大小并“锁定”它显示它总是显示（即使滚动列表。

有没有办法做到这一点？我真的很想避免在 Windows 窗体上添加另一个控件来显示总数。

**编辑：** 空间有点问题，因为我试图让这个窗口足够小，以便在 800x600 的最小屏幕分辨率下工作（我知道，waaaaay 不是标准，但我想让老年人也能使用它视力有问题的社区。

谢谢！

-JFV

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-23T21:08:36.820

在 Webforms 和 WPF 中似乎有办法做到这一点，但在 Winforms 中没有。您可能应该使用文本框。任何试图破解固定总数行的尝试肯定会比所获得的好处付出更多的努力。这当然超出了我的能力范围。即使像 Telerik 这样的自定义控件商店似乎也没有这样做。

```
http://www.telerik.com/products/winforms/gridview.aspx 
```

如果您担心空间，请将网格视图缩小一点以容纳文本框。

# multithreading - 多线程对 IO-bound 操作有意义吗？

> ID：902425
> 
> 赞同：51
> 
> 时间：2009-05-23T20:27:22.033
> 
> 标签：multithreading, optimization

在执行许多磁盘操作时，多线程是有帮助、有阻碍还是没有区别？

例如，将多个文件从一个文件夹复制到另一个文件夹时。

**澄清**：我知道当执行其他操作时，并发显然会有所作为。如果任务是打开一个图像文件，转换为另一种格式，然后保存，则磁盘操作可以与图像操作同时执行。我的问题是当唯一执行的操作是磁盘操作时，并发排队和响应磁盘操作是否更好。

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2009-05-23T20:42:54.217

到目前为止，大多数答案都与操作系统调度程序有关。但是，我认为还有一个更重要的因素会导致您的回答。您是写入单个物理磁盘还是多个物理磁盘？

即使您使用多个线程并行化......对单个物理磁盘的 IO 本质上是一个序列化操作。每个线程都必须阻塞，等待它访问磁盘的机会。在这种情况下，多线程可能毫无用处……甚至可能导致争用问题。

但是，如果您将多个流写入多个物理磁盘，同时处理它们应该可以提高性能。对于托管磁盘尤其如此，例如 RAID 阵列、SAN 设备等。

我认为这个问题与操作系统调度程序没有太大关系，因为它更多地与您写入的磁盘的物理方面有关。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-23T20:40:27.000

这取决于您对“I/O 绑定”的定义，但通常多线程有两个效果：

*   同时使用多个 CPU（如果瓶颈是磁盘而不是 CPU [s]，这不一定有帮助）

*   即使一个线程被阻塞（例如等待 I/O 完成），也要使用 CPU（与另一个线程）

但是，我不确定 Konrad 的答案是否总是正确的：作为反例，如果“I/O bound”只是意味着“一个线程大部分时间都在等待 I/O 完成而不是使用 CPU”，但**并不**意味着“我们已经达到了系统 I/O 带宽限制”，那么具有多个线程（或异步 I/O）的 IMO 可能会提高性能（通过启用多个并发 I/O 操作）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-23T20:32:56.033

我认为这取决于许多因素，例如您正在运行的应用程序的类型、并发用户的数量等。

我目前正在从事一个具有高度线性（从头到尾读取文件）操作的项目。我们使用 NAS 进行存储，并且担心如果我们运行多个线程会发生什么。我们最初的想法是它会减慢我们的速度，因为它会增加磁头搜索。所以我们进行了一些测试，发现理想的线程数与计算机中的内核数相同。

但是您的里程可能会有所不同。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-23T20:33:03.927

它可以做到，因为只要线程有更多的工作要做（识别下一个要复制的文件），操作系统就会唤醒它，所以线程是一种简单的方法来连接到操作系统调度程序，但仍然以传统的方式编写代码顺序方式，而不必将其分解为带有回调的状态机。

这主要是对清晰的编程而不是性能的帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-11-09T11:57:40.417

在大多数情况下，使用多线程进行磁盘 IO 并不会提高效率。让我们想象两种情况：

1.  无锁文件：我们可以通过给它们不同的IO偏移量来为每个线程分割文件。例如，一个 1024B 字节的文件被分成 n 块，每个线程分别写入 1024/n。由于偏移量不同，这将导致大量详细的磁盘磁头移动。
2.  锁定文件：实际锁定每个临界区的 IO 操作。这将导致大量冗长的线程切换，结果只有一个线程可以同时写入文件。

如果我错了，请纠正我。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-23T20:32:28.530

不，这没有任何意义。在某些时候，操作必须被序列化（由操作系统）。另一方面，由于现代操作系统无论如何都必须处理多个进程，我怀疑是否会增加开销。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-23T20:43:27.820

我认为这会妨碍操作...您只有一个控制器和一个驱动器。

您可以使用第二个线程来执行操作，并使用一个显示更新 UI 的主线程。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-23T20:45:39.673

我认为这可能会使性能恶化，因为多个线程将争夺相同的资源。

您可以通过将一组文件从一个地方复制到另一个地方并测量时间来测试在同一设备上执行并发 IO 操作的影响，然后将该集合分成两部分并并行制作副本......第二个选项将慢一点。

# ruby - 如何捕获所有 HTTP 流量（本地代理）

> ID：902427
> 
> 赞同：5
> 
> 时间：2009-05-23T20:28:38.320
> 
> 标签：ruby, http, proxy, sniffing

我希望访问我的机器（我的 Windows 机器 - 不是服务器）上的所有 HTTP 流量。据我了解，拥有一个本地代理，所有交通路线都可以通过该代理。我一直在谷歌搜索，但没有找到任何资源（关于 Ruby）来帮助我。非常感谢任何提示或链接。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-23T20:46:23.900

WEBrick 中有一个 HTTP 代理（Ruby stdlib 的一部分），[这是](http://altentee.com/blogs/2008/httpwatch-a-free-alternative-using-ruby/)一个实现示例。

如果你喜欢生活在边缘，还有 Ilya Grigorik 的[em-proxy](http://github.com/igrigorik/em-proxy/tree/master)。

Ilya 的这篇[文章](http://www.igvita.com/2009/04/20/ruby-proxies-for-scale-and-monitoring/)暗示它似乎确实需要一些调整来解决您的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T20:37:44.773

在 Ruby 中构建代理是这里的重点吗？还是只是为了“访问您机器上的所有 HTTP 流量”？如果是后者，有一个名为[HTTP Sniffer and Analyzer](http://www.xibl.com/)的免费程序据说可以做到这一点。我没有使用它，但我看到它得到了一些积极的评价。还有其他几个这样的程序，尽管大多数似乎都是付费的。在 OS X、Linux 等上，您可以巧妙地使用内置的 tcpdump 来获得类似的效果。

# sql - 如果我正在查询数据库，如何从给定行取回第 5 行？

> ID：902430
> 
> 赞同：0
> 
> 时间：2009-05-23T20:30:18.033
> 
> 标签：sql, sql-server, select

如果我有一个行 ID，并且我想从该行返回第 5 行，我该怎么做？

通常我可以去

行 ID - 5

那将是第 5 行后面的 id ......

但是，我需要考虑是否删除了一行，这意味着，例如

39、40、41、42、43、44、45

如果 rowId 为 45，那么我的第 5 行返回的 rowId 为 40，但如果第 42 行被删除，那么我们将......

39, 40, 41, 43, 44, 45

并且 45 的 rowId 将再次给我一个 40 的 rowId，而它应该给我 39（因为它是第 5 行）。

我想不出任何办法来解决这个问题，我无法在删除后重新编号 id，因为该表可能会增长到一百万行长。有人有想法么？

谢谢，马特

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-23T20:37:31.607

您可以使用 T-SQL 的 ROW_NUMBER 排名函数...

下面是一些伪 SQL 代码：

```
SELECT id, value,
   ROW_NUMBER() OVER ( ORDER BY id) AS RowNo
FROM ranking AS r1
WHERE RowNo = selectedRowNo - 5 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-24T03:24:11.130

建立在自动的答案上

```
select top 1 * from (
     select top 5 * from table where Id < 45 order by id desc
) as fiverows order by id asc 
```

这将返回第 5 行，并且仅返回第 5 行。

**注意：**选择 * 是 baaaaaad, mkay? :-)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-23T20:35:38.443

如果您使用的是 Sql Server 2005 或更高版本，则可以使用 ROW_NUMBER：

```
SELECT *
FROM (
    SELECT TOP 5
         ROW_NUMBER() OVER (ORDER BY YourId DESC) AS RowNr,
         *
    FROM YourTable
    WHERE YourId < CurrentId
    ORDER BY YourId DESC
) vw
WHERE RowNr = 5 
```

“ORDER BY ID ASC”指定您希望如何对行进行编号；您可以将其更改为几乎任何排序顺序，例如：

```
ROW_NUMBER() OVER (ORDER BY YourTimestamp DESC) AS RowNr, 
```

在根据年龄查找前一行的查询中会很有帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-24T03:56:40.187

我通常使用 CTE 进行编号。这样的事情会做：

```
;WITH NumberedRows
AS
(SELECT   ID, ROW_NUMBER() OVER(ORDER BY ID ASC) AS RowNumber
FROM      MyTable)
SELECT    ID
FROM      NumberedRows
WHERE     RowNumber = (SELECT RowNumber FROM NumberedRows WHERE ID = @MyID) - 5 
```

它与已经提供的任何解决方案都没有太大不同，但我发现 CTE 的抽象使代码的意图更加清晰。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-23T20:38:47.613

在我看来，您希望根据顺序 ID 将第 5 行返回（这与数据库中的物理顺序无关）？

如果这是您想要的，并且您知道要从哪个 id 开始，例如 45，您可以

从 ID < 45 的表中选择前 5 * 按 id desc 排序

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-23T20:48:14.457

我意识到这是双重嵌套的，但如果你不经常这样做，和/或 RowNum 列被索引，它不应该造成太大的麻烦：

```
SELECT *
  FROM YourTable
 WHERE RowNum = (SELECT MIN(RowNum)
                   FROM (SELECT TOP 5 RowNum
                           FROM YourTable
                       ORDER BY RowNum DESC) t) 
```

此外，此解决方案也适用于旧版本的 SQL，而“over”子句仅适用于 2005+。

# c++ - 何时使用不声明类但具有函数定义的头文件

> ID：902432
> 
> 赞同：6
> 
> 时间：2009-05-23T20:32:37.187
> 
> 标签：c++, file, header

我对 C++ 相当陌生，我已经看到一堆在头文件中有方法定义的代码，并且它们没有将头文件声明为一个类。有人可以向我解释为什么以及何时你会做这样的事情。这是一个不好的做法吗？

提前致谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-23T20:36:14.653

> 这是一个不好的做法吗？

一般不会。有很多库，`header only`这意味着它们只提供头文件。这*可以*看作是编译库的轻量级替代方案。

但是，更重要的是，在某些情况下您*不能*使用单独的预编译编译单元：模板必须专门用于声明它们的同一编译单元。这可能听起来很神秘，但它有一个简单的结果：

函数（和类）模板不能在 cpp 文件中定义并在其他地方使用；相反，它们*必须*直接在头文件中定义（有一些值得注意的例外）。

此外，C++ 中的类完全是可选的——虽然您*可以*在 C++ 中编写面向对象的程序，但很多好的代码却不能。类补充 C++ 中的算法，而不是相反。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-23T21:52:14.563

这不是坏习惯。C++ 的伟大之处在于它可以让您以多种风格进行编程。这为该语言提供了极大的灵活性和实用性，但可能比其他迫使您以特定风格编写代码的语言更难学习。

如果你有一个小程序，你可以把它写在一个函数中——可能使用几个 goto 来进行代码流。

当你变得更大时，将代码拆分为函数有助于组织事物。

更大，类通常是分组处理特定数据集的相关函数的好方法。

更重要的是，命名空间会有所帮助。

但有时，编写一个函数来做某事是最简单的。这通常是您编写仅适用于原始类型（如 int）的函数的情况。int 没有类，所以如果你想写一个 printInt() 函数，你可以让它独立。此外，如果一个函数适用于来自多个类的对象，但实际上并不属于一个类而不属于另一个类，那么作为独立函数可能是有意义的。当您编写诸如 define less than 之类的运算符以便它可以比较两个不同类的对象时，这种情况经常发生。或者，如果一个函数可以用类的公共方法来编写，并且不需要直接访问该类的数据，那么有些人更喜欢将其编写为一个独立的函数。

但是，真的，选择权在你。解决问题的最简单方法是最好的。

您可能会从几个函数开始一个程序，然后确定一些是相关的并将它们重构为一个类。但是，如果其他独立函数不能自然地融入到一个类中，您不必强行将它们放入一个类中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-23T20:35:44.903

H 文件只是包含一堆声明的一种方式。C++ 中的许多东西都是有用的声明，包括类、类型、常量、全局函数等。

C++ 具有强大的面向对象方面。大多数 OO 语言解决了在哪里处理不依赖对象状态且实际上不需要对象的操作的问题。

在某些语言中，如 Java，语言限制强制所有内容都在一个类中，因此所有内容都成为静态成员函数（例如，具有数学实用程序或算法的类）。

在 C++ 中，为了保持与 C 的兼容性，您可以声明独立的 C 风格函数或使用 Java 风格的静态成员。我个人的观点是，如果可能的话，最好使用 OO 风格并围绕一个中心概念组织操作。

但是，C++ 确实提供了命名空间设施，并且通常以与在这些情况下使用类相同的方式使用它 - 将一组独立项目分组，其中每个项目都以“命名空间”名称为前缀。正如其他人指出的那样，许多 C++ 标准库函数都是这样定位的。我的观点是，这很像在 Java 中使用类。但是，其他人会争辩说 Java 使用类是因为它没有名称空间。只要您使用其中一个（而不是浮动的独立非命名空间函数），您通常会没事的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-24T01:54:45.023

> 我对 C++ 相当陌生，我已经看到一堆在头文件中有方法定义的代码，并且它们没有将头文件声明为一个类。

让我们澄清一下。

> 头文件中的方法定义

这意味着像这样：文件“Ah”：

```
class A {
void method(){/*blah blah*/} //definition of a method
}; 
```

这是你的意思吗？

后来你说“声明头文件”。在 C++ 中没有声明文件的机制。可以通过 witing 包含文件`#include "filename.h"`。如果你这样做，头文件的内容将被复制并粘贴到任何你有上述行的地方，然后再编译任何东西。

所以你的意思是所有的定义都在类定义中（不是在Ah FILE中的任何地方，而是特别是在类A中，受 'class A{' 和 '};' 限制）。在类定义中包含方法定义的含义是该方法将是“内联”（这是 C++ 关键字），这意味着只要调用它，方法体就会被粘贴。这是：

*   很好，因为函数调用机制不再减慢执行速度
*   如果函数比短语句长，则不好，因为可执行代码的大小增长得很厉害

正如上面所说的那样，模板的情况有所不同，但对他们来说，有一种方法可以定义方法，使它们不是内联的，但仍然在头文件中（它们必须在头文件中）。无论如何，这个定义必须在类定义之外。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-23T20:35:26.823

在 C++ 中，函数不必是类的成员。

# encryption - 关于在 J2ME 中使用 AES 加密的任何好的示例或建议？

> ID：902438
> 
> 赞同：3
> 
> 时间：2009-05-23T20:35:02.830
> 
> 标签：encryption, java-me, aes

我正在将 J2ME 中的 mi 手机应用程序连接到 Web 服务，并且我必须向其发送 SHA256 哈希以验证接收到的一些数据。我还需要能够将一些加密信息存储到手机中。我正在考虑使用 AES (rinjdael) 对称加密。

任何人都知道在 J2ME 中使用 AES 加密的任何代码示例吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-26T14:53:07.363

我建议查看开源 bouncycastle 库。

它已成功用于 J2ME 上的密码学。

# mysql - 在实时机器上更新（或替换）整个数据库表的最佳方法是什么？

> ID：902458
> 
> 赞同：8
> 
> 时间：2009-05-23T20:46:03.433
> 
> 标签：mysql, database, postgresql

我每周都会收到一个数据源，我将对其进行解析并放入数据库。数据每周不会有太大变化，但我应该定期更新数据库。除了每周更新，数据是静态的。

现在重建整个数据库不是问题，但最终这个数据库将是活动的，人们可能会在我重建它时查询数据库。数据量并不小（几百兆字节），所以它不会立即加载，我个人想要一个万无一失的系统，而不是“我希望数据库处于混乱状态时没有人查询”。

我想了几种不同的方法来解决这个问题，并且想知道最好的方法是什么。到目前为止，这是我的想法：

1.  不是替换整个表，而是查询我当前的数据库和我想在数据库中放置的内容之间的差异。不过，这似乎是不必要的工作量。

2.  创建虚拟数据表，然后重命名表（或让服务器代码指向新数据表）。

3.  只是告诉用户该站点正在进行维护并将系统离线几分钟。（由于显而易见的原因，这不是可取的，但如果它是最好的答案，我愿意接受。）

想法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-23T21:36:41.380

我不能代表 MySQL，但 PostgreSQL 有事务 DDL。这是一个很棒的功能，意味着您的第二个选项，将新数据加载到虚拟表中，然后执行表重命名，应该可以很好地工作。如果您想用 替换表格`foo`，`foo_new`您只需将新数据加载到`foo_new`并运行脚本来进行重命名。这个脚本应该在它自己的事务中执行，所以如果重命名出现问题，两者`foo`都会`foo_new`在它回滚时保持不变。

这种方法的主要问题是处理来自其他键的表的外键可能会有点混乱`foo`。但至少可以保证您的数据将保持一致。

我认为，从长远来看，更好的方法是直接对数据执行更新（您的第一个选择）。再一次，您可以在单个事务中坚持所有更新，因此您可以保证全有或全无语义。更好的是在线更新，只需在新信息可用时直接更新数据。如果您需要其他人的批处理作业的结果，这可能不是您的选择，但如果您能做到，这是最好的选择。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-23T21:40:17.707

```
BEGIN;
DELETE FROM TABLE;
INSERT INTO TABLE;
COMMIT; 
```

当您点击提交时，用户将立即看到转换。在提交之前启动的任何查询都将在旧数据上运行，之后的任何查询都将在新数据上运行。一旦最后一个用户完成了旧表，数据库实际上将清除它。因为一切都是“静态的”（你是唯一一个改变它的人，而且每周只有一次），你不必担心任何锁定问题或超时。对于 MySQL，这取决于 InnoDB。PostgreSQL 做到了，SQL Server 称之为“快照”，我不记得我脑海中的细节，因为我很少使用这个东西。

如果你用谷歌搜索“事务隔离”+你正在使用的任何数据库的名称，你会找到适当的信息。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-24T16:06:45.520

我们通过使用 PostgreSQL 的表继承/约束机制解决了这个问题。您创建一个触发器，该触发器自动创建基于日期字段分区的子表。

[这篇](http://valgogtech.blogspot.com/2008/04/table-partitioning-automation-triggers.html)文章是我使用的来源。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-23T20:52:54.777

您使用的是哪个数据库服务器？SQL 2005 及更高版本提供了一种称为“快照”的锁定方法。它允许您打开一个事务，进行所有更新，然后提交，同时数据库的用户继续查看事务前数据。通常，您的事务会锁定您的表并阻止它们的查询，但在您的情况下，快照锁定将是完美的。

更多信息在这里：http: [//blogs.msdn.com/craigfr/archive/2007/05/16/serializable-vs-snapshot-isolation-level.aspx](http://blogs.msdn.com/craigfr/archive/2007/05/16/serializable-vs-snapshot-isolation-level.aspx)

但它需要 SQL Server，所以如果你使用其他东西......

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-23T20:54:03.120

几个数据库系统（因为你没有指定你的，我会保持这个一般性）确实提供了 SQL:2003 标准语句`MERGE`，它基本上允许你

*   从尚不存在的源将新行插入目标表
*   根据源中的新值更新目标表中的现有行
*   甚至可以选择从目标中删除不再出现在导入表中的行

SQL Server 2008 是第一个具有此声明的 Microsoft 产品 -[在此处](http://www.builderau.com.au/program/sqlserver/soa/Using-SQL-Server-2008-s-MERGE-statement/0,339028455,339283059,00.htm)、[此处](http://www.sqlservercentral.com/articles/Advanced+Querying/3122/)或[此处](http://blog.sqlauthority.com/2008/08/28/sql-server-2008-introduction-to-merge-statement-one-statement-for-insert-update-delete/)查看更多信息。

其他数据库系统可能会有类似的实现——毕竟这是一个 SQL:2003 标准语句。

马克

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-23T21:51:10.773

使用不同的表名（mytable_[yyyy]_[wk]）和一个视图来为你提供一个常量名（mytable）。完全导入新表后，请更新您的视图，以便它使用该表。

# c# - 地图导航控制方法 - .NET

> ID：902464
> 
> 赞同：1
> 
> 时间：2009-05-23T20:49:23.753
> 
> 标签：c#, map

我想知道开发具有地图导航控件的 Windows 桌面应用程序的最佳方法是什么 - 非常类似于 Google Maps 和 Live Maps 中的那些，具有拖放支持等。

最初，由于时间限制，我正在考虑一个 WinForms 解决方案 - 我认为使用 WPF 的未来解决方案会更好，但我必须先学习所有 WPF 知识。

考虑到这一点，我应该采取什么方法来开发它？它可以是第三方工具，也可以是一些简单的实现/算法，我可以从中获取一些想法。老实说，我有点迷路了，所以任何想法都会有所帮助。

谢谢，祝你有美好的一天

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-23T20:52:29.177

看看这个 codeplex 项目。查看源代码并下载示例项目应该是一个好的开始。

[GMap.Net @ Codeplex](http://www.codeplex.com/gmap4dotnet)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-21T14:11:49.277

有用于浏览 OpenStreetMap 地图的开源应用程序 Kosmos [http://wiki.openstreetmap.org/wiki/Kosmos](http://wiki.openstreetmap.org/wiki/Kosmos)

然而，它读取 OSM 数据并即时渲染。

我想您需要一些示例来加载地图图块并将它们按正确的顺序放置。OpenStreetMap 有这样一个示例：sourceforge 上的项目 osmclient（抱歉无法发布链接，我是新手）

它可以简单地重做以加载其他源，甚至是 ArcGIS，但请确保它是否与 Map Provider 许可证兼容。例如，您不能选择 Google Maps，因为您必须在他们的 API 中使用 Google Maps。

# c++ - 有没有办法抑制 c++ 名称修改？

> ID：902468
> 
> 赞同：5
> 
> 时间：2009-05-23T20:51:53.327
> 
> 标签：c++, visual-studio, winapi, name-mangling

我有一个用 C++ 编写的 DLL，我想抑制一些导出方法的名称修改。这些方法是全局的，不是任何类的成员。有没有办法做到这一点？

顺便说一句：我正在使用 VS2008。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-05-23T20:55:05.753

用 extern "C" {} 包围函数定义

```
extern "C" {
    void foo() {}
} 
```

见[http://www.parashift.com/c++-faq-lite/mixing-c-and-cpp.html](http://www.parashift.com/c++-faq-lite/mixing-c-and-cpp.html)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-25T08:15:39.393

您可以使用带有 EXPORTS 部分的 .def 文件来避免导出函数的所有修改（C++、cdecl、stdcall...）。只需创建一个 MyDll.def 文件并将其添加到您的项目中：

```
LIBRARY "MyDLL"
EXPORTS
  Foo
  Bar 
```

实际上，向导很可能已经为您创建了一个 def 文件。您只需填写“出口”部分。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-05-26T08:35:38.077

“bradtgmurray”是对的，但对于 Visual C++ 编译器，无论如何您都需要显式导出函数。但是使用“Serge - appTranslator”建议的 .DEF 文件是错误的方法。

## 在 Visual C++ 上导出符号的通用方法是什么？

使用 declspec(dllexport/dllimport) 指令，该指令适用于 C 和 C++ 代码，无论是否修饰（而 .DEF 仅限于 C，除非您想手动修饰代码）。

因此，在 Visual C++ 中导出未修饰函数的正确方法是结合导出“C”习语（如“bradtgmurray”所回答）和 dllimport/dllexport 关键字。

## 一个例子 ？

例如，我在 Visual C++ 上创建了一个空的 DLL 项目，并编写了两个函数，一个被称为 CPP，因为它被修饰，另一个被称为 C，因为它没有。代码是：

```
// Exported header
#ifdef MY_DLL_EXPORTS
#define MY_DLL_API __declspec(dllexport)
#else
#define MY_DLL_API __declspec(dllimport)
#endif

// Decorated function export : ?myCppFunction@@YAHF@Z
MY_DLL_API int myCppFunction(short v) ;

// Undecorated function export : myCFunction
extern "C"
{
MY_DLL_API int myCFunction(short v) ;
} ; 
```

我想你已经知道了，但为了完整起见，MY_DLL_API 宏将在 DLL makefile（即 VCPROJ）中定义，而不是由 DLL 用户定义。

C++ 代码很容易编写，但为了完整起见，我将在下面编写：

```
// Decorated function code
MY_DLL_API int myCppFunction(short v)
{
   return 42 * v ;
}

extern "C"
{

// Undecorated function code
MY_DLL_API int myCFunction(short v)
{
   return 42 * v ;
}

} ; 
```

# flash - 解析 .dae 时出错，Flash 播放器中出现错误#1009，增强现实 Flash

> ID：902480
> 
> 赞同：0
> 
> 时间：2009-05-23T20:56:17.890
> 
> 标签：flash, papervision3d, augmented-reality

每当我尝试使用 animate.dae 文件时（我正在使用 flartoolkit+papervision3d+ascollada 创建小项目）。Flash 播放器报告我粘贴在下面的错误。如果我按继续，那么我可以看到我的 .dae 文件但是没有动画:(请注意，我没有使用任何繁重的动画。

错误：

> ```
> TypeError: Error #1009: Cannot access a property or method of a null object reference.
> 
> at org.papervision3d.objects.parsers::DAE/buildAnimationChannels()[C:\..\org\papervision3d\objects\parsers\DAE.as:657]
> 
> at org.papervision3d.objects.parsers::DAE/onParseAnimationsComplete()[C:\..\org\papervision3d\objects\parsers\DAE.as:1722]
> 
> at flash.events::EventDispatcher/dispatchEventFunction()
> 
> at flash.events::EventDispatcher/dispatchEvent()
> 
> at org.ascollada.io::DaeReader/loadNextAnimation()[C:\..\Libs\org\ascollada\io\DaeReader.as:169]
> 
> at flash.utils::Timer/_timerDispatch()
> 
> at flash.utils::Timer/tick() 
> ```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-04T01:03:36.143

Fenomas 是对的，这与 COLLADA 数据的制作方式有关。有一些非常具体的解决方法可用于帮助清理所有 COLLADA/DAE 的 XML。

[我在这里](https://stackoverflow.com/questions/673059/as3-dae-augmented-reality-papervision-3d)深深地触及了这一切。

有些人使用 Milk Shape 3D 甚至 Swift3D 之类的东西来导出他们的 XML。我在旅行中发现，来自 MAYA 和 MAX 的本地 COLLADA 出口商非常失败。如果您使用的是以前命名的软件的 2008 版，[feelingsoftware.com](http://www.feelingsoftware.com)将成为 papervision 喜爱的出色 COLLADA(DAE) 导出器！

# c# - 输出行号

> ID：902492
> 
> 赞同：1
> 
> 时间：2009-05-23T21:04:47.870
> 
> 标签：c#, vb.net, visual-studio, visual-studio-2008

有没有办法在 VB.NET 中输出源代码中的当前行号？例如：

```
Try
    ' The following line will purposly cause an error
    Dim BigNum As Int64
    Dim LittleNum As Int16 = CShort(BigNum)
Catch ex As Exception
    Dim LineNumber As Integer = <linenumber> ' How do I do this?
    MessageBox.Show("Error in source code. Line: " + LineNumber)
End Try 
```

有没有办法用导致错误的源代码中的实际行号填充上面示例中的 LineNumber 变量？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-23T21:10:01.370

这应该做的工作：

```
Dim stackTrace = New System.Diagnostics.StackTrace(ex)
Dim stackFrame = stackTrace.GetFrame(stackTrace.FrameCount - 1)
Dim lineNumber = stackFrame.GetFileLineNumber() 
```

请注意，`GetFrame(stackTrace.FrameCount - 1))`将*第一*帧推入堆栈。在这种情况下，这是包含当前 try-catch 块的帧，这是您想要的。有关更多信息，请参阅[MSDN 文档](http://msdn.microsoft.com/en-us/library/system.diagnostics.stacktrace.getframe.aspx)。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T21:05:42.223

行号已经在异常的堆栈跟踪中。我认为它甚至显示在一个简单的 ex.ToString 中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-09T16:07:13.860

只是想纠正 Noldorin 的回应，因为他/她使用了错误的 Stacktrace 构造函数：

```
Dim stackTrace = New System.Diagnostics.StackTrace(ex, True)
Dim stackFrame = stackTrace.GetFrame(stackTrace.FrameCount - 1)
Dim lineNumber = stackFrame.GetFileLineNumber() 
```

指定`True`构造函数的第二个参数告诉它在创建时捕获堆栈源信息。没有它将`stackFrame.GetFileLineNumber()`始终返回 0。

有关正确构造函数的说明，请参阅[http://msdn.microsoft.com/en-us/library/dsay49kt.aspx和](http://msdn.microsoft.com/en-us/library/dsay49kt.aspx)[http://msdn.microsoft.com/en-us/library/25h0kw08.aspx](http://msdn.microsoft.com/en-us/library/25h0kw08.aspx)以显示诺多林建议的构造函数。请注意备注部分，其中指出：

> StackTrace 是使用调用者的当前线程创建的，不包含文件名、行号或列信息。
> 
> 生成的堆栈跟踪描述了异常发生时的堆栈。

# c# - JOIN 与 LinqtoSql，只在连接表上选择 TOP(x)？

> ID：902498
> 
> 赞同：0
> 
> 时间：2009-05-23T21:09:25.117
> 
> 标签：c#, .net, linq, linq-to-sql

我在 StackOverlow 上环顾四周，但未能找到明确的答案。

下面我有一个我目前拥有的代码片段，我将解释我想要实现的目标。

```
Table<Gallery> galleries = pdc.GetTable<Gallery>();
Table<GalleryImage> images = pdc.GetTable<GalleryImage>();
Table<Comment> comments = pdc.GetTable<Comment>();

var query = from gallery in galleries
            join image in images on gallery.id equals image.galleryid into joinedimages
            join comment in comments on gallery.id equals comment.galleryid into joinedcomments
            select gallery;

gallst.DataSource = query;
gallst.DataBind(); 
```

从上面我有以下中继器：

```
<asp:Repeater ID="gallst" runat="server" EnableViewState="false">
    <HeaderTemplate>
        <div id="gallery">
    </HeaderTemplate>
    <ItemTemplate>
        <div class="item">
            <h2><%# DataBinder.Eval(Container.DataItem, "name") %> @ <%# DataBinder.Eval(Container.DataItem, "wheretaken") %></h2>
            <ul class="images">
            <asp:Repeater ID="galimgs" runat="server" EnableViewState="false" DataSource='<%# Eval("GalleryImages") %>'>
                <ItemTemplate>
                    <li><a href="<%# DataBinder.Eval(Container.DataItem, "image") %>.jpg" title="<%# DataBinder.Eval(((System.Web.UI.WebControls.RepeaterItem)Container.Parent.Parent).DataItem, "name") %>" rel="prettyPhoto[<%# DataBinder.Eval(Container.DataItem, "galleryid")%>]" class="thickbox"><img src="<%# DataBinder.Eval(Container.DataItem, "image") %>_thumb.jpg" /></a></li>
                </ItemTemplate>
            </asp:Repeater>
            </ul>
            <div class="comments">
            <asp:Repeater ID="galcomments" runat="server" EnableViewState="false" DataSource='<%# Eval("Comments") %>'>
                <HeaderTemplate>
                    <ul>
                </HeaderTemplate>
                <ItemTemplate>
                    <li><%# GetUserName(new Guid(Eval("userid").ToString())) %> said: <%#DataBinder.Eval(Container.DataItem, "comment1") %> (<%# DataBinder.Eval(Container.DataItem, "date", "{0:dddd  MM, yyyy hh:mm tt}") %>)</li>
                </ItemTemplate>
                <FooterTemplate>
                    </ul>
                </FooterTemplate>
            </asp:Repeater>
            <uc:makecomment ID="mcomment" runat="server" PhotoID='<%# DataBinder.Eval(Container.DataItem, "id") %>'></uc:makecomment>
        </div>
        </div>
    </ItemTemplate>
    <FooterTemplate>
        </div>
    </FooterTemplate>
</asp:Repeater> 
```

我想做的（理想情况下）是只为每个画廊获取前 3 条评论。

我尝试了以下 LINQ 查询，但没有成功：

```
var query = from gallery in galleries
            join image in images on gallery.id equals image.galleryid into joinedimages
            join comment in comments.Take(3) on gallery.id equals comment.galleryid into joinedcomments
            select gallery; 
```

有人对我如何实现这一目标有任何建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-23T21:19:23.723

这看起来可能是您需要的调整。它来自一个非常有用的[LINQ](http://msdn.microsoft.com/en-us/vcsharp/aa336746.aspx)示例站点。

此[示例](http://msdn.microsoft.com/en-us/vcsharp/aa336757.aspx#TakeNested)打印来自华盛顿客户的前三个订单的客户 ID、订单 ID 和订单日期。该示例使用 Take 将查询表达式生成的序列限制为前三个顺序。

```
public void Linq21() {
            List<Customer> customers = GetCustomerList();

        var first3WAOrders = (
            from c in customers
            from o in c.Orders
            where c.Region == "WA"
            select new {c.CustomerID, o.OrderID, o.OrderDate} )
            .Take(3);

        Console.WriteLine("First 3 orders in WA:");
        foreach (var order in first3WAOrders) {
            ObjectDumper.Write(order);
        }
    } 
```

结果

WA的前3个订单：

```
CustomerID=LAZYK OrderID=10482 OrderDate=3/21/1997

CustomerID=LAZYK OrderID=10545 OrderDate=5/22/1997

CustomerID=TRAIH OrderID=10574 OrderDate=6/19/1997 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T22:48:16.570

我设法让它工作：

```
 Table<Gallery> galleries = pdc.GetTable<Gallery>();
        Table<GalleryImage> images = pdc.GetTable<GalleryImage>();
        Table<Comment> comments = pdc.GetTable<Comment>();

        var query = from gallery in galleries
                    join image in images on gallery.id equals image.galleryid into joinedimages
                    join comment in comments on gallery.id equals comment.galleryid into joinedcomments
                    select new
                    {
                        name = gallery.name,
                        wheretaken = gallery.wheretaken,
                        id = gallery.id,
                        GalleryImages = joinedimages,
                        Comments = joinedcomments.Take(3)
                    };

        gallst.DataSource = query;
        gallst.DataBind(); 
```

随着发生在选择上。谢谢大家的帮助。任何关于如何写这个“更好”的建议将不胜感激。

# javascript - 调用方法 Location.toString 的权限被拒绝

> ID：902501
> 
> 赞同：3
> 
> 时间：2009-05-23T21:10:30.950
> 
> 标签：javascript, yui

我正在使用 YUI，

有时我会看到这个“Permission denied to call method Location.toString”错误，

在connection.js中报告，

我还没有找到任何线索为什么会发生此错误。

很奇怪

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-16T19:25:43.847

如果您通过跨域 iframe 处理任何 Flash，那么您很可能会在 Adob​​e 的 Flash Player 中看到与 FF2 和 FF3 一起出现的错误。

该错误位于 Adob​​e 的公共 JIRA 中：http: [//bugs.adobe.com/jira/browse/FP-561](http://bugs.adobe.com/jira/browse/FP-561)

不幸的是，似乎没有动力去修复它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-04-15T10:16:40.470

你好我已经回答了一个类似的问题

[为什么/在哪里出现错误“调用方法 Location.toString 的权限被拒绝”。](https://stackoverflow.com/questions/5649102/why-where-the-error-permission-denied-for-http-ad-yieldmanager-com-to-call-m/5650029#5650029)

这是由萤火虫在您的控制台中显示来自其他窗口的错误引起的。简而言之，这些错误可能与您的代码完全无关。

如果你想测试这个理论，你可以在 firebug 中关闭所有其他窗口，清除你的控制台并只测试你的站点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-23T21:35:48.853

如果脚本是从不同的域执行的，或者您试图访问不同域的框架/窗口/iframe 的内容，您将看到此错误。Safari 的行为有点不同，至少在 v1-2 时代 (iirc)，因此您可能也想在其中进行测试。

如果您通过不同的域包含脚本，则需要确保您的实际触发器/事件被绑定并从内联脚本执行，或者从与您的 html 相同的域加载的脚本文件中执行以获得最佳结果。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-25T21:43:39.453

你有没有机会在 Firebug 中看到这个？

在将 jQuery 添加到我的网站后，我在 Firefox 中时断时续地得到了同样的东西。我正在从另一个站点（完全不同的域）调用 jQuery js，我认为这与从 Google 的服务器调用它没有太大区别。

到目前为止，我根本没有使用 jQuery 的代码。而且，虽然 Firebug 将此报告为错误，但它并非一直如此。当我打开它时，我在 IE 中没有看到任何错误。

虽然涉及不同的库，但我的猜测是 Firebug 正在生成误报。

现在，如果您在看到此内容时没有使用 Firebug……您是否使用托管在您自己的服务器上的 YUI？你使用的是什么浏览器？等等。

~詹姆斯

# php - 在 PHP 中拆分 SMS 网关答案

> ID：902509
> 
> 赞同：-1
> 
> 时间：2009-05-23T21:15:46.740
> 
> 标签：php, string, split, sms, character

我想知道您会采取哪些其他方法在 PHP 中进行一些简单的字符串拆分。我收到来自 SMS 网关的响应，其中两个有趣的值是使用的代码和用户的文本消息。

代码可能类似于：（`Freetrip`小写、大写、混合大小写）

在最好的情况下，用户消息应该是例如：`Freetrip 12345`($code "space" XXXXX)。

每个 X 应该是 1 到 5 之间的数字。任何其他值/字符都应该返回错误。所以正则表达式将被简化为：chars=5 其中每个数字 >=1 和 <=5。

我最后需要存储的是 5 位数字中的每一个。

我最简单的方法是将整个消息字符串小写并从消息字符串中减去同样小写的代码（加上空格）。这将给我留下 5 个数字，然后我将其拆分为 5 个唯一变量以存储在数据库中。

现在棘手的部分是上述最佳情况可能难以实现。打字短信很繁琐，而且很容易出现打字错误。可能出现的一些错误如下：

*   数字太少或太多。
*   非数字字符。
*   XXXXX 组合后的更多字符。
*   可能还有一些其他情况。

其中任何一个都应该返回一个单独的错误消息，我可以将其返回给发件人。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-23T21:22:15.997

```
if (!preg_match('/^freetrip\s+([1-5]{5})$/i', $sms, $matches)) exit("error");
print_r($matches); 
```

我对 SMS 平台和 AFAIK 有一些经验，一个错误就足够了。我们试图检测类似的字符，如小 L 和大 I 等，或零和 O 字母。例如，在您的情况下，您可以编写如下内容：

```
preg_match('/^freetr[il1|]p\s+([1-5]{5})$/i', $sms, $matches); 
```

您可以在消息模式的任何地方执行相同的操作（如果您愿意）。

我做了这样的事情（不确定 - 那是 5 年前）：

```
if (!preg_match('/^(\w+)\s+(.*)/i', $sms, $matches)) exit('bad message format');
$value = $matches[2];

// some letters look like digits
$value = str_replace(array('o', 'O'), 0);
$value = str_replace(array('i', 'I', 'l'), 1);
if (!preg_match('/^[12345]{5}/')) exit("invalid code");
// do something here... message is OK. 
```

当然，在这种情况下，您可以检查“freetrip”与否，值是否为 [1-5]{5} 等，并尽可能多地响应您的错误 :)。祝你好运。

编辑：最后一个已更新，应该适合您的情况。更好，因为如果您需要它，在它的示例上创建另一个服务将非常简单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T21:31:33.060

你可以这样做：

```
$code = 'Freetrip';
if (strlen($input) <= strlen($code)) {
    // too short
} elseif (!preg_match('/^'.preg_quote($code, '/').'(.*)/i', $input, $match)) {
    // wrong code
} else {
    $x = (int)trim($match[0]);
    if ($x < 11111) {
        // too small
    } elseif ($x > 55555) {
        // too large
    } else {
        // valid
    }
} 
```

# google-app-engine - 在 Google App Engine 上，我如何在 GQL 中查找客户的最新订单？

> ID：902516
> 
> 赞同：4
> 
> 时间：2009-05-23T21:19:09.060
> 
> 标签：google-app-engine, join, gql

如果我有两张表，Customers 和 Orders，并且我想查找客户的最新订单，我将如何使用 GQL 在 Google App Engine 上执行此操作？

通常，我会通过订单表中存在的外键 customer_id 连接这两个表。

```
select orders.* from customers, orders 
where customers.customer_id = orders.customer_id
and orders.order_id = (select top 1 sub_orders.order_id from orders sub_orders 
                where sub_orders.customer_id = orders.customer_id 
                order by sub_orders.order_date desc) 
```

但是，由于 Google App Engine 上似乎无法加入，我不确定如何解决此限制。任何建议，将不胜感激。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-23T21:41:28.907

Google App Engine 中的 DataStore 与关系数据库确实有很大不同。有一些相似之处，但在设计数据模型时了解差异很重要。

通常定义这种关系的方式是使用引用属性：

```
class Customer(db.Model):
    name = db.StringProperty()

class Order(db.Model):
   customer = db.ReferenceProperty( Customer,
                                    collection_name = 'orders' ) 
```

Order 实体定义中的 ReferenceProperty 导致在 Customer 实体中创建一个名为“orders”的属性，因此如果“customer”是一个 Customer 实例，您可以通过引用“customer.orders”找到所有订单。

例如：

```
customer = Customer.gql("WHERE name = :1", "Bob")[0] # Returns the first customer named Bob
order1 = customer.orders[0]
order2 = customer.orders.order("date")[0] # Sorts the Orders by date and gets the first one 
```

参考属性记录[在这里。](http://code.google.com/appengine/docs/python/datastore/entitiesandmodels.html#References)

另一个需要理解的重要概念是实体组的概念。实体组中的实体存储在同一节点上，因此可以更有效地存储和检索它们。它们对于使用交易也很重要。

# python - 我的刽子手游戏有问题

> ID：902520
> 
> 赞同：0
> 
> 时间：2009-05-23T21:25:17.253
> 
> 标签：python, python-3.x

我正在尝试学习 python，我正在尝试一个刽子手游戏。但是当我尝试将用户的猜测与单词进行比较时，它不起作用。我错过了什么？

```
import sys
import codecs
import random

if __name__ == '__main__':
    try:
        wordlist = codecs.open("words.txt", "r")
    except Exception as ex:
        print (ex)
        print ("\n**Could not open file!**\n")
        sys.exit(0)

    rand = int(random.random()*5 + 1)
    i = 0

    for word in wordlist:
        i+=1
        if i == rand:
            print (word, end = '')
            break

    wordlist.close()

    guess = input("Guess a letter: ")
    print (guess) #for testing purposes

    for letters in word:
        if guess == letters:
            print ("Yessssh")

#guessing part and user interface here 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-23T21:31:59.360

在您的 " `for word in wordlist`" 循环中，每个单词都将以换行符结尾。尝试添加`word = word.strip()`为下一行。

顺便说一句，您的最后一个循环可以替换为：

```
if guess in word:
    print ("Yessssh") 
```

额外提示：添加“调试打印”时，使用 repr 通常是个好主意（尤其是在处理字符串时）。例如，您的行：

```
print (guess) #for testing purposes 
```

如果您写以下内容可能会更有用：

```
print (repr(guess)) #for testing purposes 
```

这样，如果 中有奇怪的字符`guess`，您将更容易在调试输出中看到它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-20T17:15:34.603

这就是我为我的刽子手游戏所做的：

```
 for x in range(0, len(secretword)):
           if letter == secretword[x]:
                for x in range(len(secretword)):
                    if secretword[x] in letter:
                         hiddenletter = hiddenletter[:x] + secretword[x] +hiddenletter[x+1:]

     for letter in hiddenletter:
          print(letter, end=' ') 
```

secretword 是用户试图猜测的隐藏词。hidden letter 包含单词中“_”的数量：即 hiddenletter = " _ " * len(secretword)

这会用正确猜到的字母替换空格，然后在正确的地方用字母显示下划线我尽力了......

# .net - 如何响应另一个应用程序中的声音？

> ID：902524
> 
> 赞同：0
> 
> 时间：2009-05-23T21:26:56.610
> 
> 标签：.net, audio

有人可以给我一些信息/背景信息，说明我如何编写一个“监听”计算机声卡或特定其他程序发出的声音的应用程序。

例如，如果我启动了一个长时间运行的 3rd 方应用程序，该应用程序没有给出何时完成的指示，除了响亮的“DING！” 声音。无论如何，我的应用程序是否可以“听”那个“叮！” 然后采取一些行动？

我意识到在大多数情况下可能有避免使用声音的方法，但我比其他任何事情都更好奇。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-23T22:18:37.020

完成后其他进程是否退出？您始终可以对其进行处理并将事件处理程序绑定到它的出口

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-24T03:36:41.143

我真的不能对此表示赞赏。但我在 CodeProject 上找到了答案：

[http://www.codeproject.com/KB/vista/CoreAudio.aspx](http://www.codeproject.com/KB/vista/CoreAudio.aspx)

确定当前“声级”的响度变得如此简单：

```
Dim curVol As Integer = CType(SndDevice.AudioMeterInformation.MasterPeakValue * 100, Integer) 
```

所以，只要你试图检测到声音的大幅增加（比如响亮的 DING！）；它实际上变得非常容易。

# sql - MySQL Query、Join 和我自己，或者我总是如何艰难地度过

> ID：902525
> 
> 赞同：0
> 
> 时间：2009-05-23T21:30:16.790
> 
> 标签：sql, mysql, outer-join

我正在创建一个小型论坛。

尝试运行`SElECT... JOIN...`查询也会获取有关各个帖子的信息，以及最后的回复（如果有）。作为我希望以艰难的方式完成所有事情的一部分，这涵盖了五个表格（仅说明了与此问题相关的列）

```
评论信息参考ID | 参考类型 | 作者ID | 创造
邮政编码 | 标题
postitInfo 参考PostitID | 创建 | 作者ID
用户名 | 用户名 | 允许
用户信息参考用户ID | 标题

```

因此，我运行此查询`SELECT... JOIN...`查询以获取最新的主题及其最后的回复。

```
SELECT DISTINCT
    t1.id, t1.title, t2.create, t2.lastEdit, t2.authorID, t3.username, 
    t4.title AS userTitle, t3.permission, t5.create AS commentCreate, 
    t5.authorID AS commentAuthor, t6.username AS commentUsername, 
    t6.permission AS commentPermission
FROM rantPostit AS t1
LEFT JOIN (rantPostitInfo AS t2) 
    ON ( t1.id = t2.referencePostitID)
LEFT OUTER JOIN (rantUser as t3, rantUserInfo as t4) 
    ON (t2.authorId = t3.id AND t4.referenceUserId = t2.authorId)
LEFT OUTER JOIN (rantCommentInfo as t5, rantUser as t6) 
    ON (t5.referenceType = 8 AND t5.referenceID = t1.id AND t6.id = t5.authorID)
ORDER BY t2.create DESC, t5.create DESC 
```

现在，这将返回主题帖子。假设我有两个，它返回它们都很好。假设我对第一个有 8 个回复，它将返回 9 个条目（主题 + 回复各一个，没有回复的单个条目）。所以，我想我的问题是这样的：我不知道该怎么做才能将最后`LEFT OUTER JOIN`条款中的退货数量限制为最近的，或者只是将最近的退货数量排除在窗口之外。

（是的，我意识到该`ORDER BY...`子句搞砸了，因为它会首先按帖子创建日期排序，然后按评论创建日期排序。是的，我意识到我可以通过在 postitInfo 中添加两个字段来简化所有问题，lastCommentCreate 和lastCommentCreateID，并在每次回复时更新它，但是......我喜欢这种艰难的方式。）

那么我做错了什么？

或者这是一个如此愚蠢的问题，我应该被带到木棚周围并用锤子敲打？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-23T22:07:08.293

`post`and`postInfo`和`user`and表之间的拆分`userInfo`似乎在这里除了混淆之外没有任何作用。为了更好地了解解决方案，让我们归结为它们的本质：一张表`Posts`（带有主键`id`、创建日期`date`和其他字段）和一张表`Comments`（带有主键`id`、外键`refId`引用`Posts`、唯一创建日期`date`等）字段）；我们希望查看所有帖子，如果有的话，每个帖子都有最新的评论（`id`检索到的表行的主键和其他字段，当然可以在上下文中使用`SELECT`获取并显示更多信息，但这不会改变核心结构，将事情简化到核心结构应该有助于说明解决方案）。我假设评论的创建日期是唯一的，否则“最新评论”可能会模棱两可（当然，这种模棱两可可以以其他方式任意截断，选择一组“最新评论”中的一项到给定的帖子）。

所以，这是一种方法：

```
SELECT Posts.id, Comments.id FROM Posts
LEFT OUTER JOIN Comments on (Posts.id = Comments.refId)
WHERE Comments.create IS NULL OR (
      Comments.create = (SELECT create FROM Comments
                         WHERE refID = Posts.id
                         ORDER BY create DESC
                         LIMIT 1)
) /* add ORDER BY &c to taste;-) */ 
```

想法：对于每个帖子，我们想要“一个空评论”（当没有评论时）或者在引用该帖子的人中创建日期最高的评论；在这里，内部`SELECT`负责查找“最高”创建日期。因此，本着同样的精神，内部选择可能`SELECT MAX(create) FROM Comments WHERE refID = Posts.id`更可取（更短、更直接，而且可能更快）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T21:42:39.620

看起来最后一个 LEFT JOIN 是唯一可以返回多行的。如果这是真的，您可以使用 LIMIT 5 来获取最后五个评论：

```
 ORDER BY t5.create DESC
 LIMIT 5 
```

如果没有，一个非常简单的解决方案是使用单独的查询检索评论：

```
SELECT *
FROM rantCommentInfo t5
    ON t5.referenceType = 8 
    AND t5.referenceid = t1.id
LEFT OUTER JOIN rantUser t6
    ON t6.id = t5.authorID
ORDER BY CommentCreate
WHERE t5.referenceid = YourT1Id
LIMIT 5 
```

想不出在一个查询中没有 ROW_NUMBER 的方法，这是 MySQL 不支持的。

# asp.net - 修复asp.net中的行列excel样式

> ID：902527
> 
> 赞同：0
> 
> 时间：2009-05-23T21:30:54.700
> 
> 标签：asp.net, html, excel

有没有办法修复列或行，所以当用户向下或向右滚动时，总是显示第一个？

我需要在 asp.net 中复制这个 excel 功能并使用 ListView 控件。

它至少在html中可行吗？我愿意接受任何建议来实现这一点

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-24T05:45:38.190

[本文](http://mattberseth.com/blog/2007/09/freezing_gridview_column_heade_1.html)解释了如何仅使用 Gridview 和 CSS 来实现，但它似乎与 Firefox 不兼容。

[本文](http://mattberseth.com/blog/2007/09/freezing_gridview_column_heade.html)解释了如何使用 GridView、控件适配器和 CSS 来实现。

[本文](http://weblogs.asp.net/dwahlin/archive/2007/07/31/freeze-asp-net-gridview-headers-by-creating-client-side-extenders.aspx)解释了如何通过扩展 GridView 控件来做到这一点。在我看来，这似乎是最好、最简单的方法。

[Telerik](http://www.telerik.com/products/aspnet-ajax/grid.aspx)在他们的控制工具包中也有一个 GridView 可以做到这一点。他们在[这里](http://demos.telerik.com/aspnet-ajax/grid/examples/client/scrolling/defaultcs.aspx)有一个演示。

# php - CakePHP 中的 MySQL 查询记录

> ID：902532
> 
> 赞同：4
> 
> 时间：2009-05-23T21:33:18.047
> 
> 标签：php, mysql, logging, cakephp

我想知道当我们在模型上使用 find 方法时是否有办法在 CakePHP 中记录正在执行的 mysql 查询，我知道 Rails 数据库查询，Cake 也这样做，如果是这样，我该如何启用或使用它？

希夫

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-23T23:34:02.907

[这个页面](http://bakery.cakephp.org/articles/view/how-to-debug-as-in-rails)有关于如何让 Cake 以与 rails 相同的方式记录查询的说明。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-01-13T07:31:55.103

一个非常简单的方法来记录所有正在执行的查询：

在你的**cake\libs\model\datasources\dbo\dbo_mysql.php**

找到**_execute**函数：

```
function _execute($sql) {
        return mysql_query($sql, $this->connection);
} 
```

在“ **return mysql_query($sql, $this->connection);** ”之前添加行“ **$this->log($sql)** ; ”

 **```
function _execute($sql) {
    $this->log($sql);
    return mysql_query($sql, $this->connection);
} 
```

就是这样！！！！！您的所有 SQL 查询都会被记录下来。确保日志文件配置正确并具有足够的权限。享受

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-23T22:19:39.483

假设您使用的是 nix 操作系统，最好的方法实际上是跟踪 mysql 日志本身。
你可能会从中学到一些有趣的东西。

从存储库安装时登录 Ubuntu

```
tail -f  /var/log/mysql/mysql.log 
```

如下所述，这是一个巨大的性能杀手（嗯，所有日志都有一些性能影响）。因此，请确保您仅在您的开发/QA 机器上使用它，并且仅在您的生产机器上短时间使用它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-04-01T14:03:56.890

CakePHP 1.3 使用该`sql_dump`元素。设置为 2
时可以直接使用该元素：`Configure::read('debug')`

```
echo $this->element('sql_dump'); 
```

或者，如果您需要对其执行其他操作（例如从 ShellTask​​ 中回显它），则直接获取它的代码

```
$sources = ConnectionManager::sourceList();

$logs = array();
foreach ($sources as $source):
    $db =& ConnectionManager::getDataSource($source);
    if (!$db->isInterfaceSupported('getLog')):
        continue;
    endif;
    $logs[$source] = $db->getLog();
endforeach; 
```

回声例如：

```
print_r($logs) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-05-06T09:30:12.717

这就是我使用的（将其放在元素文件夹中，然后包含在您的布局中）

```
<?php
    ob_start(); 
    echo $this->element('sql_dump');
    $out = ob_get_contents();
    ob_end_clean();
    CakeLog::write('mysql' , $out);
?> 
```

然后你会在 TMP.logs.DS.mysql.log 中找到 mysql.log 文件

# ruby - 什么是 SSH 转发？

> ID：902535
> 
> 赞同：4
> 
> 时间：2009-05-23T21:34:49.637
> 
> 标签：ruby, ssh

我读[了一个指南](http://giantrobots.thoughtbot.com/2009/3/30/2009-rubyist-guide-mac-os-x-development-environment)。它说运行以下行并忘记它。

```
/usr/bin/ssh-add -K 
```

我不确定应该在何时何地使用它。

**什么是 SSH 转发？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-23T21:38:33.170

如果您不知道为什么需要它，则无需添加它来设置您的 ruby​​ 环境。

其他人注意：这是一个与在人们要求关闭之前设置他的开发环境有关的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T21:41:30.823

[这是](http://www.ssh.com/support/documentation/online/ssh/adminguide/32/Port_Forwarding.html)一个解释。还有[一个](http://www.securityfocus.com/infocus/1816)。一个[“插图”。](http://unixwiz.net/techtips/ssh-agent-forwarding.html)

这些应该让您大致了解这里发生了什么。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-23T21:43:37.997

这似乎是 ssh-add 的 Mac OS X 特定选项。它将身份添加到您的 OS X 钥匙串中，以便以后的任何使用都可以方便地使用它们。

这与其他类型的转发不同。我的典型用途是在没有额外选项的情况下执行普通的 ssh-add，然后`ssh -A`转发代理。这意味着如果我通过第一个主机 ssh 到另一台主机，我的信用会自动传递。非常便利。

到目前为止，您最好的选择是阅读您看到使用的任何选项的手册页。SSH 附带了很棒的手册页。

# linux - pthreads的好级别？

> ID：902539
> 
> 赞同：14
> 
> 时间：2009-05-23T21:38:02.610
> 
> 标签：linux, pthreads

在嵌入式系统（使用 glibc 2.6.1 的 ARM 处理器上的 Linux 内核 2.6.28）上，我正在运行一个由多个线程组成的应用程序。我希望其中一个线程比其他线程获得更多的 CPU 时间。

设置优先级的一种选择似乎是将`pthread`\`_setschedparam`与`SCHED`\ `_RR`（或`SCHED`\ `_FIFO`）一起使用，但是这会给线程带来太多的 CPU（除非它休眠，否则它会从仍在使用的其他线程中吃掉所有 CPU `SCHED_OTHER`）。

另一种选择是设置线程的好级别。然而，虽然这正是我正在寻找的（线程只是获得更多的 CPU，但不能饿死其他线程），但我无法让它正常工作。根据手册页“线程不共享一个共同的好值”，我将其解释为我可以为同一进程中的不同线程设置单独的好值。

这是我的代码：

```
pid_t tid;
tid = syscall(SYS_gettid);

int ret = setpriority(PRIO_PROCESS, tid, priority); 
```

但是，所有线程中的 tid 似乎都是相同的。此外，在调用`getpriority`. 从性能来看，这是一致的（即用相同的任务运行线程 A 和线程 B，然后将 A 设置为 -19，将 B 设置为 19，两者将在大致相同的时间完成）。

然而，当运行线程 A 时，将其设置为 -19，然后运行 ​​B 并将其设置为 +19 将使 B 以全功率运行（完成方式领先于 A）。

所以看起来一个线程会在运行时使用漂亮的级别集，之后无法更改它。

我疯狂地在谷歌上搜索更多信息或任何形式的确认，但到目前为止我发现的都是相当模糊的。这里有人对Linux（2.6.28，glibc 2.6.1）上处理线程的良好级别有任何描述吗？我怎么可能改变已经运行的线程的好级别？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-23T21:56:21.607

Errm，一旦我发布了这个问题，我突然意识到我的错误——我通过从主线程调用函数来设置好的级别，所以它们当然都有相同的线程 ID（因为它是在主线程的上下文中执行的） . 啊！！！！

使用正确的 tid 一切正常。

现在如何删除这个问题？

# visual-studio - Visual Studio 中项目的最佳默认位置是什么？

> ID：902541
> 
> 赞同：0
> 
> 时间：2009-05-23T21:38:38.770
> 
> 标签：visual-studio, visual-studio-2008, standards

多年来，我一直在将我的项目/源文件夹放在从根目录删除一级目录（例如 D:\Projects）和将它们保留在 Visual Studio 的默认位置之间摇摆不定。

过去，我拒绝在 Win 95、Win 98 和 XP 建立的各种“我的文档”文件夹中存储任何内容。我终于切换到将它们存储在 Documents 文件夹中，因为 Vista 缩短了路径，并且我厌倦了更改我的开发工具的默认目录。但是，现在我发现自己倾向于再次在根目录下创建一个文件夹，因为我正在设置一台新机器。

当东西存储在文档文件夹中时，我厌倦了您必须导航到的长路径。此外，由于我使用 VCS 作为源代码，因此我不会像备份其他文档那样备份源代码和数据库文件。但是，您似乎总是在努力维护“非标准”源位置，因为每个开发工具通常都希望将内容存储在文档的子文件夹中。

我想听听其他人对这个问题的看法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-23T21:56:53.773

明显违反了我过去的 Unix，我使用 c:\dev （用于开发）或我用于开发的任何其他驱动器。注意：建议不要使用系统分区进行开发，因为软件开发确实会破坏磁盘。

我从来没有任何理由使用另一个目录——除了一些“公司标准”强迫每个人都在 C: 驱动器的根目录上拥有开发目录的项目。（真的！他们有硬编码到 c:\whatever 的路径）

在开发过程中，我有时会检查源代码的多个版本到不同的目录 - 如果只是为了发现提交到当天版本控制系统的版本确实已经签入了每个文件。（有时我会在开发目录中添加一个文件，但是忘记签入。）

所以我认为你的开发目录在哪里是无关紧要的，只要路径对你来说是可键入的（我更喜欢短路径）并且由于 Windows 上的常见原因不包含空格（如果你想做一些脚本）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-23T22:15:14.407

我认为这取决于您的使用...我更喜欢将我的开发项目放在单独的驱动器/分区上，因此通常会使用以下约定`D:\projects\{company-name}\({client-name}|internal)\{project-name}` 客户名称发挥作用的地方是工作由给定公司完成，但是为了另一个。我将我的项目保留在`D:\projects\personal\...` 这允许更好的结构下。

至于备份策略，恕我直言，这就是源代码控制的目的。我更喜欢颠覆，并且有一个svn服务器的备份策略。虽然我不太关心 ankh 1.x，但 2.x 版本以及 TortoiseSVN 对我来说效果很好。作为实践，我倾向于经常签入，并尝试仅签入处于可运行状态的代码（尽管新功能/代码可能不起作用）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-23T22:21:51.943

我更喜欢在另一个分区的位置。因为项目有很多很多的小文件，如果你使用 SVN 或其他版本控制系统，如果存储在 OS 分区，这些文件会有非常高的碎片和减慢系统。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-23T22:16:56.323

我自己没有尝试过，但我想您可以将项目放在“我的文档”中，并使用指向根文件夹中目录的符号链接。通过这样做，您可以通过两种方式访问​​您的文件并解决诸如更改工具目录之类的问题。[有关 Vista 中的符号链接的信息](http://www.mydigitallife.info/2007/05/22/create-symbolic-links-hard-links-and-directory-junctions-in-vista-with-mklink/)

如果您是唯一使用计算机的人，我真的不明白为什么要将代码放在配置文件目录中，无论如何都应该使用版本控制系统来完成备份。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-23T22:30:53.610

我将“活动”项目存储在从根目录开始一层的辅助驱动器上。快速进入该文件夹要容易得多（即使 VS2008 现在有这个不错的“在 Windows 资源管理器中打开文件夹”）。它还便于备份、格式化/重新安装等。“不太活跃”的项目存储在 NAS 上以供快速参考。所有还都存储在备份的远程 SVN 服务器上。（我还建议不要在 web 应用程序的文件夹中使用 # ，因为它（有时）会从开发 web 服务器创建奇怪的错误）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-23T22:31:28.070

我使用 SUBST（在启动时运行）将一些随机文件夹映射到高字母驱动器。然后我可以把我的东西放在任何地方，并移动它，但我总是可以通过`Y:`或`Q:`或其他方式来引用它。

这是据说可以解决所有问题的额外间接层之一。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-23T22:38:59.490

对于个人项目，我只是将它们放在桌面上（尽管我确实将桌面移动到 D:\Desktop）。当它们变为非活动状态时，它们会归档到我的文档中。

对于工作，我将所有项目都放在专用开发虚拟机内的 C:\Sourcecode 文件夹中。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-24T12:06:38.920

只是一个问题，您主要开发桌面应用程序还是 Web 应用程序？

如果您经常编写 Web 应用程序，那么这对我有用：

1.  创建一个文件夹：c:\dev 或 c:\sites（保持简单）
2.  将文件夹注册为 IIS 中的虚拟目录
3.  为每个项目创建一个不同的文件夹，并在 IIS 中为每个项目创建一个 Web 应用程序

此设置可能具有的一个优点是，您可以更轻松地在浏览器中浏览您的网站，即更少的输入，更容易记住，所有其他应用程序的标准化。

我的 2 美分。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-07-31T19:13:02.503

最好将您的项目保留在窗口以外的其他分区中，我认为就像我一样 d:\projects\"某些项目分组拥有您自己的选择"\projectname

例如 d:\projects\UNIversty\admission d:\projects\universry\examination d:\projects\planners\ipp

# ruby - 无法在 Bash/Zsh 中找到 Rubygem 的制表符补全

> ID：902542
> 
> 赞同：1
> 
> 时间：2009-05-23T21:38:56.413
> 
> 标签：ruby, rubygems, tab-completion

我没有在 Bash/Zsh 中找到 RubyGem 的制表符完成脚本。

**在哪里可以得到 Bahs/Zsh 中 RubyGem 的制表符完成脚本？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T14:57:40.237

可执行的 RubyGem 命令安装在 /usr/bin 或 /usr/local/bin 或任何 Ruby 所在的前缀中。命令的 Tab 补全应该就像 PATH 中的任何其他可执行文件一样工作。如果它不起作用，请验证 RubyGems 安装命令的目录是否在您的 PATH 中。

目前还没有官方方法可以为这些命令中的任何一个的参数执行制表符补全。如果您需要通过 RubyGems 安装的命令完成制表符，您需要自己编写和/或安装它。有关详细信息，请参阅[Bash 参考手册](http://www.gnu.org/software/bash/manual/bashref.html#Programmable-Completion-Builtins)。对于您感兴趣的特定命令，可能已经有一个完成系统，因此请务必使用 google 搜索，但是通过 RubyGems 安装的大多数命令都没有为它们编写任何自动完成功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-12-01T16:15:48.970

试试： http: [//github.com/oggy/ruby-bash-completion](http://github.com/oggy/ruby-bash-completion) 要安装它，只需将*gem*文件复制到 /etc/bash_completion.d/

尝试制表符时出现错误：

```
gem install 
```

因为我在 .gem 目录中没有一些缓存文件。所以我只是通过编辑*gem*文件来禁用它。我更改了 _gem_all_names 函数：

```
function _gem_all_names {
   echo ""
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-04-08T23:10:55.380

github 托管的 bash 完成现在是 Ubuntu Lucid Lynx 的一部分。甜的！如果你`apt-get install rubygems1.8`那么完成（命令和选项！）应该只是工作。

不幸的是，安装后，它只会在看到调用时完成`gem1.8`，而不是更方便`gem`。如果愿意，您可以手动修复该问题，方法是将最后一行扩展`/etc/bash_completion.d/gem1.8`为包含`gem`在`complete`名单中。我敢肯定有一种更清洁的方法，但这很有效。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-11-30T17:39:34.457

`gem`这已经晚了（几年），但是由于我对似乎在网上流传的各种完成脚本非常不满意，所以我决定（在某种程度上`git`）基于`git-sh`.

[https://github.com/pdkl95/rubygems-completion](https://github.com/pdkl95/rubygems-completion)

# c# - 比较手写的 ADO/Sprocs w/nHibernate

> ID：902549
> 
> 赞同：3
> 
> 时间：2009-05-23T21:42:04.457
> 
> 标签：c#, asp.net, nhibernate, ado.net

我在使用 nHibernate 和手写 ado.net/存储过程之间来回切换。

我目前使用 codesmith 和我编写的模板，这些模板生成映射我的数据库表的简单类，它为我的数据层包装了我的存储过程，以及一个只调用我的数据层并返回对象的薄业务逻辑层（1 个对象或收藏）。

这个应用程序是一个网络应用程序，用于在线社区（基本上是一个论坛）。

我现在正在看夏天的休眠视频。

使用 nHibernate 会让我的生活更轻松吗？更新数据库模式会更容易吗？会对性能产生什么影响？

设置 nhibernate 并确保它以最佳方式运行是一件令人头疼的事情吗？

我不想要一个复杂或深入的对象模型，我只想要映射我的表的类，以及一种从我的其他表中获取数据的方法，这些表具有外键。我不想要一个非常复杂的 OOP 模型。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-23T22:11:02.980

NHibernate 绝对可以让您的生活更轻松。更新你的数据库模式肯定会更容易，因为当你使用 ORM 时，你没有存储过程的 API 阻碍你重构数据库模式以满足业务模型的变化。

OR 映射器可以提供很多东西，但遗憾的是，大部分开发人员社区以及几乎所有 DBA 社区都误解了它们。

存储过程通常为 DBA 提供了更多调整数据库性能的选项，因为只要不更改其输出，他们就可以自由地重写存储过程。然而，根据我的经验，存储过程很少被重写，因为可能会出现其他问题（即，当执行新版本软件的部署时，现有 procs 的任何修改版本都将覆盖已更改的优化版本由 DBA ......因此否定了好处并产生了维护和意外的性能问题。）

另一个严重的误解（这主要来自 SQL Server 阵营......我对 Oracle 的经验很少）是存储过程是唯一可以编译和缓存执行计划的东西。就 SQL Server 而言，任何参数化查询都可以并且可能会被编译和缓存。

OR 映射器的一个好处是它们是自适应的……使用存储过程，您编写一个语句，无论执行该查询时上下文的细微差别如何，都将使用该语句。LINQ to SQL 具有惊人的能力来生成我所见过的最有效的查询，并且经常让 DBA 陷入严重的循环。我已经展示了由 L2S 生成的 DBA 查询，其中充满了子查询和非常规的东西，这些东西立即被嘲笑。然而，考虑到挑战，由 DBA 编写的查询的性能（即物理读取）被认为是优越的，但最终却明显逊色（有时 L2S 的物理读取为 30 次，而 DBA 的物理读取为 400 次。）

就 DBA 而言，另一个不利因素是，因为 ORM 生成动态 SQL，他们无法优化这些查询。相反（同样，这仅限于 SQL Server），SQL Server 提供了多种优化路径（水平和垂直表分区、为任何表或视图、索引跨磁盘分配物理文件等）之前需要修改一个查询是必须的。即使在需要修改查询的情况下，SQL Server 2005 及更高版本也提供了称为计划指南的东西，它允许您适度调整任何查询（存储过程、海峡 sql 等）。如果调整查询还不够，您可以将任何特定查询与完整的替换查询匹配，从而允许 DBA 尽可能多地调整查询（但作为最后的手段）。

使用 OR 映射器可以获得很多很多好处，NHibernate 是最好的免费之一（LLBLGen 也非常好，但不是免费的。）LINQ to Sql 和 Entity Framework 是 Microsoft 的一些新产品（L2S 很快就会被 .NET 4.0 框架中的 EF 4.0 所取代……至少可以与 NHibernate 相媲美。）采用 ORM 的最大障碍通常不是 ORM 产品本身，也不是它的功能或性能。最大的障碍通常是说服您的 DBA（如果您足够幸运/不幸......取决于您的经验......拥有一个）ORM 可以提高效率并降低维护成本，而无需为 DBA 优化路径。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-23T21:51:17.170

NHibernate 工作得很好，特别是对于一个简单的模型。它会让你的生活更轻松，学习起来也不会太难。看看“Fluent NHibernate”而不是使用 XML 映射，它要容易得多。

# xml - XML 和 ASP：检索和解析远程文件

> ID：902554
> 
> 赞同：5
> 
> 时间：2009-05-23T21:45:14.140
> 
> 标签：xml, asp-classic

我正在启用 ASP 的 Windows Server 上构建站点。我需要从另一台服务器检索 XML 文档并在该文档中返回一个值。xml 文件很小 - 只有一个带有文本值的节点。我只需要返回那个文本值。我以前从未使用过 ASP，谷歌搜索让我找到了一些代码示例，但到目前为止还没有任何效果。这是我所拥有的，它给了我 500：

```
<%
Dim URL, objXML
URL = "http://someserver.com/xml"
Set objXML = Server.CreateObject("MSXML2.DOMDocument.4.0")
objXML.setProperty "ServerHTTPRequest", True
objXML.async =  False
objXML.Load(URL)

If objXML.parseError.errorCode <> 0  Then
    Response.Write(objXML.parseError.reason)
    Response.Write(objXML.parseError.errorCode)
End If

Set oRoot = objXML.selectSingleNode("//xml/response")
var = oRoot.text

set objXML = nothing
%>

<%= var %> 
```

===========

更新：

是的，你对我的 XML 是完全正确的。只有一个具有值的节点。根据您的评论，我将我的 asp 代码编辑为：

```
<%

Dim URL, objXML, value
URL = "http://someserver.com/xml"
Set objXML = Server.CreateObject("MSXML2.DOMDocument.6.0")
objXML.setProperty "ServerHTTPRequest", True
objXML.async =  False
objXML.Load URL

Response.Write objXML.parseError.reason

value = objXML.documentElement.Text

set objXML = nothing

%>

<%= value %> 
```

仍然返回 500。我该如何调试 ASP？有没有办法打开详细的错误报告？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-03-14T15:31:39.390

我写了这个函数：

```
<%
   Option Explicit
   Response.Buffer = True
   Dim xml
   Set xml = Server.CreateObject("Microsoft.XMLDOM")
   xml.async = False
   xml.setProperty "ServerHTTPRequest", True
   xml.Load ("http://www.midominio.com/nombre.xml")
   Dim title, heading, paragraph, testHTML
   title = xml.documentElement.childNodes(0).text
   heading = xml.documentElement.childNodes(1).text
   paragraph = xml.documentElement.childNodes(2).text
   testHTML = xml.documentElement.childNodes(3).text
   Set xml = Nothing
%>
<html>
   <head>
   <title><%= title %></title>
   </head>
   <body>
   <h3 align="center"><%= heading %></h3>
   <p align="center"><% = paragraph %></p>
   <div align="center"><%= testHTML %></div>
   </body>
</html> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-24T08:06:05.897

假设您的 Xml 实际上是：-

```
<?xml version="1.0" ?>
<response>The value</response> 
```

尝试使用：-

```
Dim value
value = objXML.documentElement.Text 
```

顺便提一句，

当您调用不返回值的方法时，您不需要括号：-

```
objXML.Load Url

Response.Write objXML.parseError.reason 
```

此外，如果这是您的服务器，请安装 MSXML6 并使用 MSXML2.DOMDocument.6.0。如果这不是您的服务器，请使用 MSXML3.DOMDocument.3.0

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T22:05:12.060

正如皮特邓肯森所说，首先要尝试的是取消勾选“显示友好的错误消息”。

如果您仍然收到 500 个错误，它们可能来自 IIS（您可以通过查看它们来判断）。如果您需要，我[在此处提供了在 IIS7 上启用错误消息](http://beweb.pbworks.com/IIS7-ASP-Detailed-Errors)的指南。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-04T10:11:02.330

将原始代码段的第 4 行更改为

```
Set objXML = Server.CreateObject("MSXML2.DOMDocument.6.0") 
```

和第 14 行到

```
Set oRoot = objXML.selectSingleNode("//response") 
```

你应该没问题（假设你的 xml 就像 AnthonyWJones 描述的那样）。

您原来的 //xml/response 将从看起来像这样的文档中获取文本

```
<?xml version="1.0" ?>
<xml>
    <response>hello</response>
</xml> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-26T09:18:19.283

调试 ASP 并不像您习惯的那样愉快。这应该会有所帮助：

*   如果使用 IE，请确保您在选项中取消勾选“显示友好的错误消息”
*   使用 Response.Write's 来跟踪您在代码中的进度。

可能是您正在使用的服务器上有一个 500 错误处理程序页面（假设您没有在本地运行）。在这种情况下，如果可以的话，您将不得不修改 500 页面，以便它为您提供有关实际错误的更多详细信息（请参阅[http://www.w3schools.com/ASP/asp_ref_error.asp）](http://www.w3schools.com/ASP/asp_ref_error.asp)。如果您在本地开发，尽管您倾向于获得所有有趣的细节。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-28T05:01:29.107

经典的 ASP 调试是一个令人讨厌的话题，多年来已经牺牲了数百万原本很好的脑细胞。即使使用旨在[开发](http://classicasp.aspfaq.com/general/how-do-i-make-visual-interdev-s-debugging-features-work.html)和/或[支持](http://weblogs.asp.net/akjoshi/archive/2008/07/16/Debugging-classic-asp-application-with-Visual-Studio-2005.aspx)经典 ASP 的工具，启用调试也可能很[棘手](http://msdn.microsoft.com/en-us/library/ms525253.aspx)。

如果您的工作是相对较小的一次性事情，正如您的问题所暗示的那样，那么花费大量时间设置和配置高级 ASP/脚本调试环境可能没有意义。相反，根据[Pete Duncanson 的](https://stackoverflow.com/users/107691/pete-duncanson)回答，只需将一些 Response.Write 语句注入到您的脚本中，并找出它在旧式方法中失败的位置和原因。但是，Pete 没有指出的一件事是，您需要打开 VBScript 错误处理程序（实际上是错误吞咽器）以避免抛出未处理的异常，从而导致 IIS 为您提供 500。

我设置并运行了以下代码，它运行良好（即没有错误）。XML URL 指向本地计算机上与 ASP 页面相同的虚拟目录中的一个简单文件，它包含在[AnthonyWJones 的](https://stackoverflow.com/users/17516/anthonywjones)答案中找到的 XML。（顺便说一句，我不知道你是如何在原始问题中得到如此好的格式的 VBScript，所以我的副本看起来很糟糕。）

```
<%
On Error Resume Next  ' prevent tossing unhandled exception
Dim URL, objXML, value
URL = "http://someserver.com/xml"
Set objXML = Server.CreateObject("MSXML2.DOMDocument.6.0")
Response.Write "after CreateObject: " & Err.Description & "<br>"
objXML.setProperty "ServerHTTPRequest", True
Response.Write "after setProperty: " & Err.Description & "<br>"
objXML.async =  False
Response.Write "after async: " & Err.Description & "<br>"
objXML.Load URL
Response.Write "after Load: " & Err.Description & "<br>"

Response.Write objXML.parseError.reason
Response.Write "after write of parseError.reason: " & Err.Description & "<br>"

value = objXML.documentElement.Text
Response.Write "after setting value: " & Err.Description & "<br>"

set objXML = nothing

%>

<%= value %> 
```

在 IE 或 Firefox 中打开它，如果一切顺利，您应该会看到：

```
创建对象之后：
在 setProperty 之后：
异步后：
加载后：
在编写 parseError.reason 之后：
设置值后：
价值
```

当然，一切都不会顺利进行，否则您将不会在这里，在这种情况下，您应该会看到错误详细信息出现在某个 Response.Write 值之后的某个时间点。以下是有关 VBScript Err 对象的一些[附加信息。](http://msdn.microsoft.com/en-us/library/sbf5ze0e(VS.85).aspx)

祝你好运！

# c# - 使用 C# 提供的对象的编译器中的持续错误

> ID：902556
> 
> 赞同：1
> 
> 时间：2009-05-23T21:46:18.177
> 
> 标签：c#

我使用内置的 C# 方法来编写编译器，如下所示：

```
CodeDomProvider codeProvider = CodeDomProvider.CreateProvider("CSharp");
string Output = "Out.exe";
Button ButtonObject = (Button)sender;

this.RadTextBox1.Text = string.Empty;

System.CodeDom.Compiler.CompilerParameters parameters = new CompilerParameters();

//Make sure we generate an EXE, not a DLL
parameters.GenerateExecutable = true;
parameters.OutputAssembly = Output;

CompilerResults results = codeProvider.CompileAssemblyFromSource(parameters, RadTextBox1.Text);

if (results.Errors.Count > 0)
{
    RadTextBox2.ForeColor = Color.Red;
    foreach (CompilerError CompErr in results.Errors)
    {
        RadTextBox2.Text = RadTextBox2.Text +
                    "Line number " + CompErr.Line +
                    ", Error Number: " + CompErr.ErrorNumber +
                    ", '" + CompErr.ErrorText + ";" +
                    Environment.NewLine + Environment.NewLine;
    }
}

else
{
    //Successful Compile
    RadTextBox2.ForeColor = Color.Blue;

    Guid guid =            Guid.NewGuid();

    string PathToExe = Server.MapPath(Path.Combine(@"\Compiled" , Output));

    FileStream fs = System.IO.File.Create(PathToExe);

    using (StreamWriter sw = new StreamWriter(fs))
    {
        sw.Write(RadTextBox1.Text);
    }

    Response.WriteFile(PathToExe); 
```

当我运行此代码并编写 Main 方法时（例如[http://msdn.microsoft.com/en-us/library/ms228506(VS.80).aspx](http://msdn.microsoft.com/en-us/library/ms228506(VS.80).aspx)中的代码示例，我收到此错误：

行号 0，错误号：CS5001，'Program 'c:\Program Files\Microsoft Visual Studio 9.0\Common7\IDE\Out.exe' 不包含适合入口点的静态 'Main' 方法；

上面的代码用作我网站上编译器的基础（尚未上线）。因此，您输入代码并生成一个 .exe 程序集。但是，当我在文本框中输入代码以进行代码编写（Radtextbox1）时，即使使用 main 方法，我也会收到错误消息。

是什么赋予了？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-24T05:01:41.260

入口点函数很特殊：不能只在程序集中添加一个名为“main”的方法。相反，您必须将 CodeEntryPointMethod 类型的实例添加到您的类之一。

有关使用 CodeEntryPointMethod 的一些限制的更多信息，请参阅[http://blogs.msdn.com/bclteam/archive/2005/10/01/475768.aspx](http://blogs.msdn.com/bclteam/archive/2005/10/01/475768.aspx)。

# c#-3.0 - C#中'var'的邪恶？

> ID：902563
> 
> 赞同：10
> 
> 时间：2009-05-23T21:51:33.033
> 
> 标签：c#-3.0, anonymous-types

> **可能重复：**
> [C# 'var' 关键字与显式定义的变量](https://stackoverflow.com/questions/429446/c-var-keyword-versus-explicitly-defined-variables)

## 编辑：

对于那些还在看这个的人，我已经完全改变了我对 var 的看法。我认为这主要是由于我对这个话题的反应。我现在是一个狂热的“var”用户，我认为下面的支持者评论在几乎所有情况下都是绝对正确的。我认为我最喜欢 var 的一点是它确实减少了重复（符合 DRY），并使您的代码相当干净。它支持重构（当您需要更改某些东西的返回类型时，您需要处理的代码清理工作较少，而且不，不是每个人都有花哨的重构工具！），而且有趣的是，人们似乎并没有真正遇到问题预先不知道变量的具体类型（它很容易按需“发现”类型的功能，无论如何这通常是必需的，

所以这里是对*“var”关键字的***热烈掌声**！！

 ** * *

这是一个相对简单的问题……实际上更像是一个民意调查。我是 C# 的忠实拥护者，自从 .NET 首次发布之前，我已经使用它超过 8 年了。我喜欢对语言所做的所有改进，包括 lambda 表达式、扩展方法、LINQ 和匿名类型。但是，我觉得 C# 3.0 中的一项功能被严重滥用了……'var' 关键字。

自 C# 3.0 发布以来，在博客、论坛，是的，甚至 Stackoverflow 上，我已经看到 var 替换了几乎所有已编写的变量！对我来说，这是对该功能的严重滥用，并且由于不清楚变量实际上是什么类型而导致非常任意的代码可能包含许多混淆错误。

'var' 只有一个真正有效的用法（至少在我看来）。你问这个有效的用途是什么？唯一有效的用途是当您***无法***知道类型时，以及唯一可能发生这种情况的情况：

访问**匿名**类型时

匿名类型没有编译时标识，因此 var 是唯一的选择。这是添加 var 以支持匿名类型的唯一原因。

那么……你的意见是什么？鉴于 var 在博客、论坛上的大量使用，由 ReSharper 等工具建议/强制执行，许多新兴开发人员会将其视为完全有效的东西。

*   你认为 var 应该被大量使用吗？
*   你认为 var 应该用于匿名类型以外的任何东西吗？
*   是否可以在发布到博客的代码中使用以保持简洁……简洁？（我自己不确定这个答案……也许有免责声明）
*   作为一个社区，我们应该鼓励更好地使用强类型变量来提高代码清晰度，还是让 C# 变得更加模糊和更少描述性？

我想知道社区的意见。我看到 var 使用了很多，但我不知道为什么，也许有一个很好的理由（即简洁/简洁。）

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-05-23T21:54:23.950

我认为它应该用于在*同一语句的*其他地方明确指定类型的情况：

```
Dictionary<string, List<int>> myHashMap = new Dictionary<string, List<int>>(); 
```

读起来很痛苦。这可以用以下内容代替，而不会失去清晰度：

```
var myHashMap = new Dictionary<string, List<int>>(); 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-05-23T22:16:28.320

`var`是一个绝妙的想法，可以帮助实现良好编程的关键原则：**DRY**，即不要重复自己。

```
VeryComplicatedType x = new VeryComplicatedType(); 
```

是糟糕的编码，因为它重复`VeryComplicatedType`，并且效果都是负面的：更冗长和样板的代码，更少的可读性，对于代码的读者和编写者来说都是愚蠢的“制作”。因此，`var`与 Java 和以前的 C# 版本相比，我认为 C# 3 中的一个非常有用的增强功能。

当然，它可能会被轻微误用，通过使用类型不明确且不明显的表达式作为 RHS（例如，调用声明可能很远的方法）——这种误用可能会降低可读性（通过迫使读者寻找方法的声明或深入思考其他微妙表达式的类型）而不是增加它。但是，如果您坚持使用`var`以*避免重复*，您将处于最佳状态，并且不会误用。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-05-23T22:02:45.150

突击测验！

这是什么类型：

```
var Foo = new string[]{"abc","123","yoda"}; 
```

这个怎么样：

```
var Bar = {"abc","123","yoda"}; 
```

与类型的显式冗余规范相比，我大致不再需要确定它们是什么类型。作为一名程序员，让编译器找出对我来说显而易见的事情是没有问题的。你可能不同意。

干杯。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-05-23T21:55:29.017

永不说永不。我很确定有很多问题人们已经阐述了他们的观点`var`，但这里又是我的问题。

`var`是工具；在合适的地方使用它，在不合适的时候不要使用它。您是对的，唯一需要使用的`var`是在处理匿名类型时，在这种情况下您没有要使用的类型名称。就个人而言，我认为任何其他用途都必须从可读性和惰性方面考虑；特别是在避免使用繁琐的类型名称时。

```
var i = 5; 
```

（懒惰）

```
var list = new List<Customer>(); 
```

（方便）

```
var customers = GetCustomers(); 
```

（有问题；当且仅当 GetCustomers() 返回 IEnumerable 时，我才认为它可以接受）

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-23T21:56:42.417

阅读 Haskell。它是一种静态类型语言，您很少需要说明任何内容的类型。因此它使用与 var 相同的方法，作为标准的“惯用”编码风格。

如果编译器可以为您解决问题，为什么要写两次相同的东西？

我的一个同事一开始和你一样非常反对var，但现在已经开始习惯性地使用它。他担心这会减少程序的自我记录，但实际上这更多是由于方法过长造成的。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-23T22:03:08.207

```
var MyCustomers = from c in Customers 
                  where c.City="Madrid" 
                  select new { c.Company, c.Mail }; 
```

如果我只需要客户收集的公司和邮件。用我需要的成员定义新类型是胡说八道。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-23T22:02:01.437

如果您认为两次提供相同的信息可以减少错误（许多坚持您输入两次电子邮件地址的 Web 表单的设计者似乎也同意），那么您可能会讨厌 var。如果您编写了大量使用复杂类型规范的代码，那么这是天赐之物。

编辑：稍微扩展一下（以防听起来我不赞成 var）：

在英国（至少在我去的时候），让计算机科学专业的学生学习如何使用标准 ML 编程是标准做法。与其他函数式语言一样，它有一个类型系统，使 C++/Java 模式中的语言相形见绌。

无论如何，我当时注意到（并听到其他学生的类似评论）是让你的 SML 程序编译是一场噩梦，因为编译器对类型非常挑剔，但一旦编译，它们几乎总是运行没有错误。

SML（和其他函数式语言）的这一方面似乎被提问者视为“好事”——即任何有助于编译器在编译时捕获更多错误的东西都是好的。

现在这是 SML 的问题：它在分配时专门使用类型推断。所以我不认为类型推断本质上是坏的。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-23T22:07:03.113

我同意其他人的观点，即 var 消除了冗余。我决定使用 var 尽可能消除冗余。我认为一致性很重要。选择一种风格并通过项目坚持下去。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-23T22:00:09.820

正如 Earwicker 所指出的，有一些函数式语言，Haskell 是一种，F# 是另一种，其中这种类型推断的使用更为普遍——C# 的类比是将方法的返回类型和参数类型声明为“var”，然后让编译器为您推断静态类型。静态类型和显式类型是两个正交的问题。

事实上，说使用“var”是动态类型是否正确？据我了解，这就是 C# 4.0 中新的“动态”关键字的用途。“var”用于静态类型推断。如果我错了，请纠正我。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-23T22:21:55.580

我必须承认，当我第一次看到 var 关键字弹出时，我非常怀疑。

然而，这绝对是一种缩短新声明行数的简单方法，我一直为此使用它。

但是，当我更改底层方法的类型并使用 var 接受返回类型时。我确实偶尔会遇到运行时错误。大多数仍然由编译器拾取。

我遇到的第二个问题是当我不确定使用什么方法时（我只是在查看自动完成）。如果我选择了错误的类型并期望它是 FOO 类型并且它是 BAR 类型，那么需要一段时间才能弄清楚。

如果我在这两种情况下都按字面意思指定了变量类型，那将节省一些挫败感。

总体而言，收益大于问题。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-24T00:06:20.143

我不得不反对 var 以任何有意义的方式减少冗余的观点。在此处提出的情况下，类型推断可以而且应该来自 IDE，它可以在不损失可读性的情况下更自由地应用。

# c# - 将小时或分钟添加到当前时间

> ID：902565
> 
> 赞同：30
> 
> 时间：2009-05-23T21:53:25.510
> 
> 标签：c#, datetime

我想将时间增加到当前时间。

例如，我有问题的时间和完成它们的预期时间。我该如何添加它？

```
 (DateTime.Now.ToShortDateString() + ...) 
```

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2009-05-23T21:56:34.257

您可以使用其他变量：

```
DateTime otherDate = DateTime.Now.AddMinutes(25);
DateTime tomorrow = DateTime.Now.AddHours(25); 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-05-24T00:20:14.997

您可以在带有 TimeSpan 参数的 DateTime 上使用运算符`+`、`-`、`+=`和。`-=`

```
DateTime myDateTime = DateTime.Parse("24 May 2009 02:19:00");

myDateTime = myDateTime + new TimeSpan(1, 1, 1);
myDateTime = myDateTime - new TimeSpan(1, 1, 1);
myDateTime += new TimeSpan(1, 1, 1);
myDateTime -= new TimeSpan(1, 1, 1); 
```

此外，您可以使用一组“添加”方法

```
myDateTime = myDateTime.AddYears(1);                
myDateTime = myDateTime.AddMonths(1);              
myDateTime = myDateTime.AddDays(1);             
myDateTime = myDateTime.AddHours(1);               
myDateTime = myDateTime.AddMinutes(1);            
myDateTime = myDateTime.AddSeconds(1);           
myDateTime = myDateTime.AddMilliseconds(1);       
myDateTime = myDateTime.AddTicks(1);     
myDateTime = myDateTime.Add(new TimeSpan(1, 1, 1)); 
```

有关更多 DateTime 操作的详细概述，请参阅[THIS](http://www.blackwasp.co.uk/CSharpDateManipulation.aspx)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-23T22:17:39.923

您还可以将 TimeSpan 添加到 DateTime，如下所示：

```
date + TimeSpan.FromHours(8); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-03-01T07:58:01.947

请注意，您可以添加 -（减号）符号以向后查找分钟

```
DateTime begin = new DateTime();
begin = DateTime.ParseExact("21:00:00", "H:m:s", null);

if (DateTime.Now < begin.AddMinutes(-15))
{
    //if time is before 19:45:00 show message etc...
} 
```

和时间向前

```
DateTime end = new DateTime();
end = DateTime.ParseExact("22:00:00", "H:m:s", null);

if (DateTime.Now > end.AddMinutes(15))
{
    //if time is greater than 22:15:00 do whatever you want
} 
```

# asp.net - 如何通过 InsertDBRow 在 Infragistics UltraWebGrid 中插入数据

> ID：902566
> 
> 赞同：1
> 
> 时间：2009-05-23T21:53:56.790
> 
> 标签：asp.net, infragistics, ultrawebgrid

我想直接在网格上向 UltraWebGrid 添加行，该网格连接到 ObjectDataSource。根据文档，我应该使用 InsertDBRow 方法（还有 UpdateDBRow 和 DeleteDBRow）来处理数据库持久性。
有没有人有任何关于这些方法的假设用途的例子？（我已经尝试了帮助和 Infragistics 论坛，但没有成功）

我打算在网页上使用这个网格来快速输入数据。如果有人对此有任何提示，我将不胜感激。

我正在使用 Infragistics 2008 v1，ASP.Net。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-23T22:33:09.720

您应该能够创建[UltraGridRow](http://help.infragistics.com/Help/NetAdvantage/NET/2008.2/CLR2.0/html/Infragistics2.WebUI.UltraWebGrid.v8.2~Infragistics.WebUI.UltraWebGrid.UltraGridRow.html)类的新实例并将其传递给[UltraWebGrid](http://help.infragistics.com/Help/NetAdvantage/NET/2008.2/CLR2.0/html/Infragistics2.WebUI.UltraWebGrid.v8.2~Infragistics.WebUI.UltraWebGrid.UltraWebGrid_members.html)的[InsertDBRow](http://help.infragistics.com/Help/NetAdvantage/NET/2008.2/CLR2.0/html/Infragistics2.WebUI.UltraWebGrid.v8.2~Infragistics.WebUI.UltraWebGrid.UltraWebGrid~InsertDBRow.html)方法。

下面是使用 InsertDBRow 插入行的示例。

```
// Create new UltraGridRow (using the object[] constructor)
var newRow = new UltraGridRow( new[] { "My First Value" , "My Second Value" } );
UltraWebGrid1.InsertDBRow( newRow ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-25T22:11:07.963

您可以使用通用函数来处理网格的 CRUD 或每次直接调用 DBRow(InsertDBRow, UpdateDBRow & DeleteDBRow) 函数之一。您可以在下面找到示例：

```
protected void UltraWebGrid_UpdateRow(object sender, Infragistics.WebUI.UltraWebGrid.RowEventArgs e)
        {
           CRUDHelper(e, UltraWebGrid);
        }

private void CRUDHelper(Infragistics.WebUI.UltraWebGrid.RowEventArgs e, UltraWebGrid pUltraWebGrid)
        {
            switch (e.Row.DataChanged)
            {
                case Infragistics.WebUI.UltraWebGrid.DataChanged.Added:
                   pUltraWebGrid.InsertDBRow(e.Row);
                    break;

                case Infragistics.WebUI.UltraWebGrid.DataChanged.Modified:
                    pUltraWebGrid.UpdateDBRow(e.Row);
                    break;

                case Infragistics.WebUI.UltraWebGrid.DataChanged.Deleted:
                    pUltraWebGrid.DeleteDBRow(e.Row);
                    break;
            }
        } 
```

# c# - 面向 C# 开发人员的 Visual Basic.NET 资源

> ID：902588
> 
> 赞同：1
> 
> 时间：2009-05-23T22:02:49.563
> 
> 标签：c#, vb.net, programming-languages

我是 C# 开发人员，现在我参与了一些用 Visual Basic.NET 编写的大型、已经投入生产的项目。

我正在努力不使用 C# 编写并使用一些自动转换工具到 Visual Basic.NET。我希望能够在 Visual Basic.NET **QUICKLY**中流利地阅读和写作。我可以编写和阅读 VB.NET，但它不像编写和阅读 C# 那样容易。

如果处于相同情况的人可以分享那里的经验或指出一些好的资源，我将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-23T22:08:05.683

这里有一些快速链接。逻辑是一样的。它基本上只是语法。

[C Sharp 和 Visual Basic .NET 的比较](http://en.wikipedia.org/wiki/Comparison_of_C_sharp_and_Visual_Basic_.NET)

[C# 和 VB.NET 比较备忘单](http://aspalliance.com/625)

[VB.NET 和 C# 比较](http://www.harding.edu/fmccown/vbnet_csharp_comparison.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T22:07:51.100

[这](http://www.harding.edu/fmccown/vbnet_csharp_comparison.html)是我过去在这种情况下使用过的一个很好的页面。它不是最新的准确，但应该是一个很好的起点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-23T22:22:20.507

练习需要时间。

# wcf - 我可以使用独立的 WCF Web 服务更改错误页面 (404) 吗？

> ID：902590
> 
> 赞同：2
> 
> 时间：2009-05-23T22:04:54.490
> 
> 标签：wcf, error-handling, http-status-code-404

我有一个独立的（非 IIS）WCF 服务，除了服务之外，它还通过 WebServiceHost 提供了一些简单的 HTML 页面。

当我在浏览器中输入[http://localhost:1234/SomeRandomWords](http://localhost:1234/SomeRandomWords)作为 URL 时，我得到一个默认错误页面，上面写着

丁斯特

Es wurde kein Endpunkt gefunden

（翻译成英文：Service / Endpoint not found）

我可以覆盖此错误页面以提供更多信息吗？我想向用户提供一个列表，其中包含我的 HTML 端点以及通过我的服务可用的几个 Web 服务的端点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-26T19:10:17.593

您不能在 W32 服务主机中。您可以在 IIS 主机中。

您无法更改默认 WCF 端点错误消息，因为您的代码尚未执行。

对于您的 API 文档，您可以使用新的[WCF REST Starter Kit](http://aspnet.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=24644)，它提供了一个很酷的操作属性 WebHelpAttribute。该属性产生一些自动生成的操作描述（请求/响应有效载荷格式等）

检查示例以获取示例。

# linux - 如何在 Linux 上使用 mail 命令附加文件？

> ID：902591
> 
> 赞同：61
> 
> 时间：2009-05-23T22:05:43.070
> 
> 标签：linux, unix, shell, email

我在运行 Linux shell 的服务器上。我需要将一个简单的文件邮寄给收件人。如何做到这一点，最好只使用**邮件**命令？

**更新**：得到了一个很好的解决方案，使用 mutt 代替：

```
$ echo | mutt -a syslogs.tar.gz admin@domain.org 
```

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2009-05-23T22:09:40.113

使用 uuencode 的示例：

```
uuencode surfing.jpeg surfing.jpeg | mail sylvia@home.com 
```

和参考文章：

[http://www.shelldorado.com/articles/mailattachments.html](http://www.shelldorado.com/articles/mailattachments.html)

## 笔记：

你可能`apt install sharutils`有`uuencode`命令

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2014-05-29T15:46:02.000

`mail`在我尝试过的每个现代 Linux 版本上都可以做到。无需其他软件：

```
matiu@matiu-laptop:~$ mail -a doc.jpg someone@somewhere.com
Subject: testing

This is a test
EOT 
```

ctrl+d 输入完毕。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2009-05-23T22:49:26.117

```
$ echo | mutt -a syslogs.tar.gz admin@domain.org 
```

但它使用 mutt，而不是 mail（或 mailx）。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-05-23T22:24:24.247

[mailx](http://heirloom.sourceforge.net/mailx.html)也可能会有所帮助。从 mailx 手册页：

```
-a file
     Attach the given file to the message. 
```

很容易，对吧？

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2009-05-23T22:21:54.597

我的答案除了邮件还需要base64，但是一些uuencode版本也可以用-m做base64，或者你可以忘记mime并使用普通的uuencode输出......

```
 FROM=me@mydomain.com
   TO=someone@mydomain.com
   SUBJECT="Auto emailed"
   MIME="application/x-gzip"  # Adjust this to the proper mime-type of file
   FILE=somefile.tar.gz
   ENCODING=base64  
   boundary="---my-unlikely-text-for-mime-boundary---$$--" 

   (cat <<EOF
    From: $FROM
    To: $REPORT_DEST
    Subject: $SUBJECT
    Date: $(date +"%a, %b %e %Y %T %z")
    Mime-Version: 1.0
    Content-Type: multipart/mixed; boundary="$boundary"
    Content-Disposition: inline

    --$boundary
    Content-Type: text/plain; charset=us-ascii
    Content-Disposition: inline

    This email has attached the file

    --$boundary
    Content-Type: $MIME;name="$FILE"
    Content-Disposition: attachment;filename="$FILE"
    Content-Transfer-Encoding: $ENCODING

    EOF
    base64 $FILE
    echo ""
    echo "--$boundary" ) | mail 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2012-04-25T22:34:35.887

```
mailx -a /path/to/file email@address 
```

您可能会进入交互模式（它会提示您“主题：”，然后是一个空行），输入主题，然后输入正文并按`Ctrl`+ `D`(EOT) 完成。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2011-10-18T18:00:52.250

mpack -a -s“嘿：这可以作为你的报告吗？” -m 0 -c application/x-tar-gzsurvey_results.tar.gz hesco@example.net

mpack 和 munpack 与 metamail 一起使用以扩展 mailx 并使其适用于带有 html 标记和附件的现代电子邮件。

这四个包放在一起将允许您处理您可以在 gui 邮件客户端中处理的任何电子邮件。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-09-23T08:28:02.340

使用ubuntu 10.4，mutt解决方案是这样写的

`echo | mutt -a myfile.zip -- admin@domain.org`

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-03-14T20:40:26.673

这里有很多使用 mutt 或 mailx 的答案，或者人们说邮件不支持“-a”

首先，来自 mailutils 的 Ubuntu 14.0.4 邮件支持：

邮件 -A 文件名 -s “主题” email@example.com

其次，我发现通过使用“man mail”命令并搜索“attach”

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2018-01-31T18:00:13.210

以下是跨 Unix/Linux 安装的一个不错的解决方案，它不依赖于任何不寻常的程序功能。这支持多行消息正文、多个附件以及`mailx`.

不幸的是，它不适合单行。

```
#!/bin/ksh

# Get the date stamp for temporary files
DT_STAMP=`date +'%C%y%m%d%H%M%S'`

# Create a multi-line body
echo "here you put the message body
which can be split across multiple lines!
woohoo!
" > body-${DT_STAMP}.mail

# Add several attachments
uuencode File1.pdf File1.pdf >  attachments-${DT_STAMP}.mail
uuencode File2.pdf File2.pdf >> attachments-${DT_STAMP}.mail

# Put everything together and send it off!
cat body-${DT_STAMP}.mail attachments-${DT_STAMP}.mail > out-${DT_STAMP}.mail
mailx -s "here you put the message subject" nobody@test-address.com < out-${DT_STAMP}.mail

# Clean up temporary files
rm body-${DT_STAMP}.mail
rm attachments-${DT_STAMP}.mail
rm out-${DT_STAMP}.mail 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-08-05T22:47:19.563

使用 mailx，您可以：

```
mailx -s "My Subject"  -a ./mail_att.csv -S from=noreply@foo.com  recipient@bar.com < ./mail_body.txt 
```

这在我们的 GNU Linux 服务器上运行良好，但不幸的是，我的开发环境是 Mac OsX，它只有一个糟糕的旧 BSD 版本的 mailx。通常我使用 Coreutils 来获得比 Mac BSD 更好的 unix 命令版本，但 mailx 不在 Coreutils 中。

我在一个不相关的线程中找到了 notpeter 的解决方案（[https://serverfault.com/questions/196001/using-unix-mail-mailx-with-a-modern-mail-server-imap-instead-of-mbox-files](https://serverfault.com/questions/196001/using-unix-mail-mailx-with-a-modern-mail-server-imap-instead-of-mbox-files) ) 这是从[http://www.tramm.li/iWiki/HeirloomNotes.html](http://www.tramm.li/iWiki/HeirloomNotes.html)下载 Heirloom mailx OSX 二进制包。它有一个更有特色的 mailx 可以处理上述命令语法。

（为糟糕的交叉链接或归属道歉，我是该网站的新手。）

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-11-02T10:45:44.527

我建议在 Linux 上，

# FILE_TO_BE_ATTACHED=abc.gz

```
uuencode abc.gz abc.gz > abc.gz.enc # This is optional, but good to have
                                    # to prevent binary file corruption.
                                    # also it make sure to get original 
                                    # file on other system, w/o worry of endianness

# Sending Mail, multiple attachments, and multiple receivers.
echo "Body Part of Mail" | mailx -s "Subject Line" -a attachment1 -a abc.gz.enc "youremail@domain.com anotheremail@domain.com" 
```

收到邮件附件后，如果你使用过uuencode，你需要uudecode

```
uudecode abc.gz.enc 
```

# 这将生成原始文件，其名称与 uuencode 的第二个参数相同。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-08-23T09:28:46.203

我使用[mailutils](https://mailutils.org/)，但令人困惑的是，为了附加文件，您需要使用大写的 A 参数。下面是一个例子。

```
echo 'here you put the message body' | mail -A syslogs.tar.gz admin@domain.org 
```

如果您想知道您的邮件命令是否来自 mailutils，只需运行“mail -V”。

```
root@your-server:~$ mail -V
mail (GNU Mailutils) 2.99.98
Copyright (C) 2010 Free Software Foundation, inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law. 
```

# jquery - Jquery：检查 div 是否包含文本，然后执行操作

> ID：902597
> 
> 赞同：56
> 
> 时间：2009-05-23T22:08:13.703
> 
> 标签：jquery

如果 div 包含一些文本，我正在尝试检查 jQuery，如果包含，则添加一个类。

所以我写了这样的东西：

```
 if( $("#field > div.field-item").text().indexOf('someText') = 0) {
        $("#somediv").addClass("thisClass");
    } 
```

我没有让这个工作。

```
<div id="field"><div class="field-item">someText</div></div>

<div id="somediv"></div> 
```

这是不正确的吗？

* * *

## 回答 #1

> 赞同：104
> 
> 时间：2009-05-23T22:21:11.307

您的代码包含两个问题：

*   JavaScript 中的相等运算符是`==`，不是`=`。
*   `jQuery.text()`将匹配元素的所有文本节点连接成一个字符串。如果您有两个连续的元素，其中第一个 contains`'some'`和第二个 contains `'Text'`，那么您的代码将错误地认为存在一个包含 contains 的元素`'someText'`。

我建议改为：

```
if ($('#field > div.field-item:contains("someText")').length > 0) {
    $("#somediv").addClass("thisClass");
} 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2011-10-28T19:03:23.343

是的，我现在为我考虑。而且效果很好！！！

```
if($("div:contains('CONGRATULATIONS')").length)
                        {
                            $('#SignupForm').hide(500);
                        } 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-23T22:23:49.523

```
if( $("#field > div.field-item").text().indexOf('someText') >= 0) 
```

有些浏览器会包含空格，有些则不会。 `>=`这里合适。否则相等是双等`==`

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-23T22:24:39.723

Ayman 是对的，但是您也可以这样使用它：

```
if( $("#field > div.field-item").text().indexOf('someText') >= 0) {
        $("#somediv").addClass("thisClass");
    } 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2011-12-18T16:39:15.057

为什么不简单

```
var item = $('.field-item');
for (var i = 0; i <= item.length; i++) {
       if ($(item[i]).text() == 'someText') {
             $(item[i]).addClass('thisClass');
             //do some other stuff here
          }
     } 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2020-04-04T11:12:22.827

这是 2020 年的香草 Javascript 解决方案：

```
const fieldItem = document.querySelector('#field .field-item')
fieldItem.innerText === 'someText' ? fieldItem.classList.add('red') : ''; 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-23T22:21:32.333

您可能想尝试`contains`选择器：

```
if ($("#field > div.field-item:contains('someText')").length) {
    $("#somediv").addClass("thisClass");
} 
```

此外，正如其他提到的，您必须使用 == 或 === 而不是 =。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2021-05-28T08:18:59.023

这应该有效并且不区分大小写

```
function has_text(selector, text){
    text = text.toLowerCase();
    return selector.text().toLowerCase().indexOf(text) > -1
}

// for test
var exists = has_text($('#test_id'), 'hello');
console.log(exists) 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-07-12T07:27:10.733

HTML

```
<div id="field"><div class="field-item">someText</div></div>
<div id="somediv"></div> 
```

JS

```
 $( document ).ready(function() {
 if ($('div.field-item:contains("someText")').length > 0) {

$('div#somediv').append("<p>someText was there, so class 'thisClass' was added").addClass("thisClass")
.css("border","2px red");
  }
}); 
```

JSfiddle：

> [https://jsfiddle.net/Loqctuaf/](https://jsfiddle.net/Loqctuaf/)

# c# - AxWebbrowser 事件处理程序不再工作

> ID：902598
> 
> 赞同：1
> 
> 时间：2009-05-23T22:08:28.647
> 
> 标签：c#, event-handling, axwebbrowser

由于某种原因，我的程序上的事件处理程序不再工作。我之前运行过几次相同的代码。

```
object loc = "http://www.google.com/";
object null_obj_str = "";
System.Object null_obj = 0;

this.axWebBrowser1.Navigate2(ref loc , ref null_obj, ref null_obj, ref null_obj_str, ref null_obj_str);

this.axWebBrowser1.DocumentComplete += new AxSHDocVw.DWebBrowserEvents2_DocumentCompleteEventHandler(this.axWebBrowser1_DocumentComplete);

private void axWebBrowser1_DocumentComplete(object sender, AxSHDocVw.DWebBrowserEvents2_DocumentCompleteEvent e)
    {//Do some action} 
```

没有理由为什么这不应该起作用，但这正是正在发生的事情。我尝试制作其他事件，但它们也不起作用。任何投入将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-20T06:00:12.583

我从 WinXP SP2 转移到 WinXP 3，我的事件也停止了工作。在网上挖掘后，我发现我需要使用一个名为 AXIMP 的程序重新创建我的 InterOp DLL。

# c++ - C++ 在基于 Intel 的系统上使用的浮点数的二进制格式是什么？

> ID：902599
> 
> 赞同：1
> 
> 时间：2009-05-23T22:09:23.513
> 
> 标签：c++, binary, floating-point, intel

我有兴趣了解 C++ 在基于 Intel 的系统上使用的单类型或双类型的二进制格式。

在数据可能需要由另一个系统（即文件或网络）读取或写入的情况下，我避免使用浮点数。我确实意识到我可以使用定点数，并且定点更准确，但我有兴趣了解浮点格式。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-23T22:12:34.117

维基百科有一个合理的总结——见[http://en.wikipedia.org/wiki/IEEE_754](http://en.wikipedia.org/wiki/IEEE_754)。

Burt 如果你想在系统之间传输数字，你应该避免以二进制格式进行。要么使用 CORBA（只是开玩笑，伙计们）、Tibco 等中间件，要么使用旧的最喜欢的文本表示。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-23T22:21:34.893

这应该可以帮助您入门：[http](http://docs.sun.com/source/806-3568/ncg_goldberg.html) ://docs.sun.com/source/806-3568/ncg_goldberg.html 。（：

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-23T22:28:48.840

英特尔的表示符合 IEEE 754。您可以在[http://download.intel.com/technology/itj/q41999/pdf/ia64fpbf.pdf](http://eaton.math.rpi.edu/coursematerials/previoussemesters/fall01/ku4800/misc/ia64fpbf.pdf)找到详细信息。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-24T01:01:01.623

浮点格式由处理器决定，而不是语言或编译器。如今，几乎所有处理器（包括所有英特尔台式机）要么没有浮点单元，要么有一个符合 IEEE 754 的浮点单元。你会得到两种或三种不同的大小（带有 SSE 的英特尔提供 32、64 和 80 位），每个一个有符号位、指数和有效数。表示的数字通常由以下公式给出：

```
sign * (2**(E-k)) * (1 + S / (2**k')) 
```

其中 k' 是有效数字中的位数， k 是指数中间范围附近的常数。零（正负零）以及无穷大和其他“非数字”（NaN）值有特殊的表示。

有明确的怪癖；例如，分数 1/10 不能完全表示为二进制 IEEE 标准浮点数。出于这个原因，IEEE 标准也提供了十进制表示，但这主要用于手持计算器而不是通用计算机。

推荐阅读：David Golberg 的[What Every Computer Scientist Should Know About Floating-Point Arithmetic](http://docs.sun.com/source/806-3568/ncg_goldberg.html)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-24T01:23:37.367

正如其他海报所指出的，有大量关于每个现代处理器使用的 IEEE 格式的信息，但这不是您的问题会出现的地方。

您可以依赖任何使用 IEEE 格式的现代系统，但您需要注意字节顺序。在 Wikipedia（或其他地方）上查找“endianness”。英特尔系统是小端的，很多 RISC 处理器都是大端的。两者之间的交换是微不足道的，但你需要知道你有什么类型。

传统上，人们使用大端格式进行传输。有时人们会包含一个标头，指示他们正在使用的字节顺序。

如果您想要绝对的可移植性，最简单的方法是使用文本表示。但是，如果您想捕获完整的精度，这对于浮点数可能会变得非常冗长。0.1234567890123456e+123。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-24T00:43:52.593

请注意，十进制浮点常量可能会在不同系统上转换为不同的浮点二进制值（即使在同一系统上使用不同的编译器）。差异会很小——对于双倍来说可能只有 2^-54 大——但仍然是一个差异。

如果您想在任何平台上保证相同的浮点二进制值，请使用十六进制常量。

# c# - 谁能详细地向我解释如何使用 IOC 容器？

> ID：902602
> 
> 赞同：13
> 
> 时间：2009-05-23T22:10:22.873
> 
> 标签：c#, inversion-of-control

我通过参数和构造函数广泛使用依赖注入。我理解这个程度的原理并对此感到满意。在我的大型项目中，我最终注入了太多的依赖项（任何达到两位数的东西都感觉很大——我喜欢“通心粉代码”这个词）。

因此，我一直在考虑 IOC 容器。我已经阅读了几篇关于它们的文章，但到目前为止我还没有看到它的好处。我可以看到它如何帮助发送相关对象组或一遍又一遍地获取相同的类型。我不确定他们将如何在我的项目中帮助我，我可能有超过一百个实现相同接口的类，并且我以不同的顺序使用它们。

那么，任何人都可以指出一些好的文章，这些文章不仅描述了 IOC 容器的概念（最好不要特别炒作），而且还详细展示了它们在这类项目中如何使我受益，以及它们如何适应大型架构？

我希望看到一些非语言特定的东西，但如有必要，我的首选语言是 C#。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-24T06:34:59.793

控制反转主要是关于依赖管理和提供可测试的代码。从经典方法来看，如果一个类具有依赖关系，自然趋势是让具有依赖关系的类直接控制管理其依赖关系。这通常意味着具有依赖项的类将在构造函数中或在其方法中按需“新建”其依赖项。

控制反转就是......它反转创建依赖项的内容，将该过程外部化并将它们注入到具有依赖项的类中。通常，创建依赖项的实体就是我们所说的 IoC 容器，它不仅负责创建和注入依赖项，还负责管理它们的生命周期、确定它们的生活方式（稍后将详细介绍），并提供各种的其他能力。（这是基于 Castle MicroKernel/Windsor，这是我选择的 IoC 容器……它编写牢固、功能强大且可扩展。如果您有更简单的需求，还存在其他更简单的 IoC 容器，例如 Ninject、Microsoft Unity 和Spring.NET。）

假设您有一个可以在本地上下文或远程上下文中使用的内部应用程序。根据一些可检测的因素，您的应用程序可能需要加载服务的“本地”实现，而在其他情况下，它可能需要加载服务的“远程”实现。如果您遵循经典方法，并直接在具有这些依赖项的类中创建依赖项，那么该类将被迫打破关于软件开发的两个非常重要的规则：关注点分离和单一职责。您跨越了关注的边界，因为您的类现在既关注其内在目的，又关注确定它应该创建哪些依赖项以及如何创建依赖项。这个类现在也负责很多事情，而不是单一的事情，

通过反转您的依赖管理，您可以改进您的系统架构并维护 SoC 和 SR（或者，当您以前由于依赖关系而无法实现时，可能会实现它。）由于外部实体 IoC 容器现在控制您的依赖关系如何创建和注入，您还可以获得额外的功能。容器可以管理依赖项的生命周期，以更灵活的方式创建和销毁它们，从而提高效率。您还可以管理对象的生活方式。如果您有一种非常频繁地创建、使用和返回的依赖类型，但它的状态很少或没有（例如，工厂），您可以为它们提供一种共享生活方式，这将告诉容器自动创建该特定依赖类型的对象池。

更好的 IoC 容器，如 Castle Windsor，也提供了很多可扩展性。默认情况下，Windsor 允许您创建本地类型的实例。可以创建扩展 Windsor 类型创建功能的设施，以便在运行时动态创建 Web 服务代理和 WCF 服务主机，无需使用 svcutil 等工具手动或静态创建它们（这是我最近自己做的事情.) 存在许多工具来使 IoC 支持现有框架，如 NHibernate、ActiveRecord 等。

最后，IoC 强制执行一种编码风格，以确保代码可单元测试。使代码单元可测试的关键因素之一是外部化依赖管理。如果没有提供替代（模拟、存根等）依赖项的能力，孤立地测试单个“单元”代码是一项非常困难的任务，因此集成测试是自动化测试的唯一替代方式。由于 IoC 要求您的类通过注入（通过构造函数、属性或方法）接受依赖项，因此每个类通常（如果不总是）简化为一个具有适当分离关注点和完全可模拟依赖项的单一职责。

IoC = 更好的架构、更大的内聚力、改进的关注点分离、更容易简化为单一职责的类、易于配置和可互换的依赖关系（通常不需要重新编译代码）、灵活的依赖关系生活方式和生命周期管理，以及单元可测试代码。IoC 是一种生活方式……一种哲学，一种解决常见问题并满足 SoC 和 SR 等关键最佳实践的方法。

即使（或者更确切地说，特别是）单个接口有数百种不同的实现，IoC 也能提供很多东西。完全理解它可能需要一段时间，但是一旦你完全理解 IoC 是什么以及它可以为你做什么，你就永远不会想以任何其他方式做事（除了嵌入式系统开发...... )

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-24T00:33:44.097

如果你有超过一百个类实现一个通用接口，那么 IoC 不会有太大帮助，你需要一个工厂。这样，您可以执行以下操作：

```
public interface IMyInterface{
    //...
}

public class Factory{

    public static IMyInterface GetObject(string param){
        // param is a parameter that will help the Factory decide what object to return
        // (that is only an example, there may not be any parameter at all)
    }
}

//...
// You do not depend on a particular implementation here
IMyInterface obj = Factory.GetObject("some param"); 
```

在工厂内部，您可以根据需要使用 IoC 容器来检索对象，但您必须注册每个实现给定接口的类并将它们与某些键相关联（并将这些键用作 GetObject 中的参数（） 方法）。

当您必须检索实现不同接口的对象时，IoC 特别有用：

```
IMyInteface myObject = Container.GetObject<IMyInterface>();
IMyOtherInterface myOtherObject Container.GetObject<IMyOtherInterface>();
ISomeOtherInterface someOtherObject = Container.GetObject<ISomeOtherInterface>(); 
```

看？只有一个对象可以获取多个不同类型的对象并且没有键（接口本身就是键）。如果您需要一个对象来获取多个不同的对象，但都实现相同的接口，那么 IoC 对您的帮助不大。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-24T00:38:53.180

在过去的几周里，我从依赖注入跳到了 Castle 的全面控制反转，所以我明白你的问题来自哪里。

我不想使用 IOC 容器的一些原因：

1.  这是一个不会增长那么多的小项目。如果构造函数和对这些构造函数的调用之间存在 1:1 的关系，那么使用 IOC 容器不会减少我必须编写的代码量。在您发现自己第二次复制并粘贴完全相同的“var myObject = new MyClass(someInjectedDependency)”之前，您并没有违反“不要重复自己”。

2.  我可能必须调整现有代码以方便加载到 IOC 容器中。在你接触到一些更酷的面向切面的编程特性之前，这可能是没有必要的，但是如果你忘记了将方法设置为虚拟，请封闭该方法的类，并且它没有实现接口，并且你'由于现有的依赖关系而使这些更改感到不舒服，然后进行切换就没有那么吸引人了。

3.  它为我的项目和我的团队添加了额外的外部依赖项。我可以让团队的其他成员相信构建他们的代码以允许 DI 是非常棒的，但我目前是唯一一个知道如何使用 Castle 的人。在较小、不太复杂的项目中，这不会成为问题。对于较大的项目（具有讽刺意味的是，这将从 IOC 容器中获得最大收益），如果我不能很好地使用 IOC 容器进行宣传，那么在我的团队中特立独行对任何人都没有帮助。

我不想回到普通 DI 的一些原因：

1.  我可以在我的任意数量的类中添加或删除日志记录，而无需添加任何类型的跟踪或日志记录语句。让我的类在*不改变这些类*的情况下与附加功能交织在一起的能力非常强大。例如：

    日志记录： http: [//ayende.com/Blog/archive/2008/07/31/Logging--the-AOP-way.aspx](http://ayende.com/Blog/archive/2008/07/31/Logging--the-AOP-way.aspx)

    交易： http: [//www.codeproject.com/KB/architecture/introducingcastle.aspx](http://www.codeproject.com/KB/architecture/introducingcastle.aspx)（跳到交易部分）

2.  至少，在将类连接到依赖项时，Castle 非常有用，以至于返回会很痛苦。

例如，缺少 Castle 的依赖项：

> “无法创建组件‘MyClass’，因为它需要满足依赖项。服务正在等待以下依赖项：
> 
> 服务：- 未注册的 IMyService。”

缺少没有 Castle 的依赖项：

> 对象引用未设置为对象的实例

Dead Last：通过编辑 Xml 文件在运行时交换注入服务的能力。我的看法是，这是最紧张的功能，但我认为它只是锦上添花。我宁愿在代码中连接我所有的服务，但我敢肯定我将来会遇到头疼的问题，我的想法会改变。

我承认——作为 IOC 和 Castle 的新手——我可能只是触及表面，但到目前为止，我真的很喜欢我所看到的。我觉得我用它构建的最后几个项目真的能够对公司每天发生的不可预测的变化做出反应，这是我以前从未有过的感觉。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-24T01:26:36.423

Jeremy Frey 忽略了使用 IOC 容器的最大原因之一：它使您的代码更容易模拟和测试。

鼓励使用接口还有很多其他好处：更好的分层，更容易为声明性事务、面向方面的编程和远程处理等动态生成代理。

如果您认为 IOC 仅适用于替换对“新”的调用，那么您就不会明白。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-23T22:26:07.067

我没有链接，但可以为您提供一个示例：

您有一个需要调用具有数据访问层的服务的 Web 控制器。

现在，我将它放入您的代码中，您正在编译时自己构建这些对象。您正在使用一个不错的设计模式，但是如果您需要更改 dao 的实现，您必须进入您的代码并删除设置此依赖关系的代码，重新编译/测试/部署。但是，如果您要使用 IOC 容器，您只需更改配置中的类并重新启动应用程序。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-23T23:20:17.693

试试这些：

*   [http://www.martinfowler.com/articles/injection.html](http://www.martinfowler.com/articles/injection.html)
*   [http://msdn.microsoft.com/en-us/library/aa973811.aspx](http://msdn.microsoft.com/en-us/library/aa973811.aspx)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-24T07:30:53.610

IoC 容器通常执行依赖注入，这在某些项目中并不是什么大问题，但一些提供 IoC 容器的框架提供了其他服务，值得使用它们。例如，Castle 除了 IoC 容器之外还有完整的服务列表。动态代理、事务管理和 NHibernate 设施就是其中的一部分。那么我认为您应该将 IoC 容器视为应用程序框架的一部分。

这就是我使用 IoC 容器的原因： 1.编写单元测试会更容易。实际上你编写不同的配置来做不同的事情 2.为不同的场景添加不同的插件（例如为不同的客户） 3.拦截类以添加不同的方面我们的代码。4.由于我们使用NHibernate，Castle的事务管理和NHibernate设施对开发和维护我们的代码非常有帮助。就像我们应用程序的每个技术方面都是使用应用程序框架处理的，我们有时间思考客户真正想要什么。

# nhibernate - 使用 CTE 分页数据，nHibernate 将如何处理这个问题？

> ID：902608
> 
> 赞同：0
> 
> 时间：2009-05-23T22:13:54.127
> 
> 标签：nhibernate, ado.net, criteria, common-table-expression

我目前使用 CTE 处理数据分页，条件查询可以处理 CTE 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-24T10:00:52.887

IIRC，nhibernate 在 2005+ 分页时使用 CTE，因此分页的查询将导致 CTE 使用查询进行分页。这是合乎逻辑的，因为除非您想使用临时表，否则没有其他方法可以在 sqlserver 2005/2008 上进行分页。（不，行号技巧等并非在所有情况下都有效，o/r 映射器需要与始终有效的分页系统一起使用）

# c# - 如何在 C# 中创建 SysHeader32 控件？

> ID：902612
> 
> 赞同：0
> 
> 时间：2009-05-23T22:17:18.753
> 
> 标签：c#, header, controls

我正在为业务流程创建 C# 中的自定义控件。作为其中的一部分，我需要在列表视图上创建看起来像标题的内容。

我过去曾使用 Visual c++ (6.0:blush:) 完成此操作。我还没有找到在 C# (2.0) 中执行此操作的方法。有没有人有任何建议或链接？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-24T05:42:33.190

作为一个做过这件事的人，我觉得这并不容易。我的最终解决方案以及我在网上找到的解决方案是将 Win32 SysHeader32 窗口包装在 C# 中。（不容易。）熟悉 Win32 和 P/Invoke。[这](http://www.davidaferguson.com/HeaderControl.htm)是我在搜索中找到的网站之一。这是[另一个](http://www.codeguru.com/csharp/csharp/cs_controls/custom/article.php/c7475)。（Google 中的 SysHeader32 C# 控件等出现了一些结果。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-24T05:20:22.063

有很多用于创建自定义资源的资源：[http ://www.google.com/search?rlz=1C1CHMB_enUS318US318&sourceid=chrome&ie=UTF-8&q=C%23+custom+control](http://www.google.com/search?rlz=1C1CHMB_enUS318US318&sourceid=chrome&ie=UTF-8&q=C%23+custom+control)

我建议从 MSDN 开始，如果您需要更多示例，可以从那里扩展。

# linux - Linux 文件系统的历史视角

> ID：902618
> 
> 赞同：0
> 
> 时间：2009-05-23T22:19:16.100
> 
> 标签：linux, filesystems, history

Jonathan Leffler 在[“如何找到某些指定文件的大小？”问题中的评论](https://stackoverflow.com/questions/902233/how-can-i-find-the-size-of-some-specified-files) 是发人深省的。我将它分成几部分进行分析。

> 1.  -- 文件存储在页面上；
>     
>     
> 2.  您通常最终使用的空间比计算给出的更多，因为 1 字节文件（通常）占用一页（可能 512 字节）。
>     
>     
> 3.  确切的值各不相同 - 在第 7 版 Unix 文件系统的日子里它更容易（尽管即使在那时也不是微不足道的）
> 
> 4-5。如果您想考虑 inode 引用的间接块以及原始数据块）。

**关于零件的问题**

1.  “页面”的定义是什么？
2.  为什么事后思考的“一页（可能是 512 字节）”中的“可能”一词？
3.  为什么在“第 7 版 Unix 文件系统”中测量精确大小更容易？
4.  “间接阻塞”的定义是什么？
5.  你怎么能有两件事的引用：“inode”和“原始数据块”？

**出现的历史问题**

一、莱弗勒所说的历史背景是什么？

二、定义是否随着时间而改变？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-23T22:27:17.503

1.  我认为他的意思是块而不是页面，块是文件系统上的最小可寻址单元。

2.  块大小可以变化

3.  不知道为什么，但也许文件系统接口暴露了 api 允许更精确的测量。

4.  间接块是指针引用的块

5.  inode 占用空间（块），就像原始数据一样。这就是作者的意思。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-24T16:40:01.907

与 Wikipedia 页面一样，[Block（数据存储）](http://en.wikipedia.org/wiki/Block_%28data_storage%29)虽然过于热衷于链接所有关键字，但信息量很大。

> 在[计算](http://en.wikipedia.org/wiki/Computing)（特别是数据传输和[数据存储](http://en.wikipedia.org/wiki/Computer_storage)）中，块是一系列[字节](http://en.wikipedia.org/wiki/Byte)或[位](http://en.wikipedia.org/wiki/Bit)，具有标称长度（*块大小*）。据说这样结构化的数据被阻止了。将数据放入块的过程称为阻塞。阻塞用于促进接收数据的计算机程序对数据流的处理。阻塞的数据通常一次读取整个块。[在将数据存储到 9 磁道磁带、](http://en.wikipedia.org/wiki/Magnetic_tape)[软盘](http://en.wikipedia.org/wiki/Floppy_disk)、[硬盘](http://en.wikipedia.org/wiki/Hard_disk)、[光盘](http://en.wikipedia.org/wiki/Optical_disc)和 NAND[闪存](http://en.wikipedia.org/wiki/Flash_memory)等旋转介质时，几乎普遍采用阻塞。
> 
> 大多数[文件系统](http://en.wikipedia.org/wiki/File_system)都基于[块设备](http://en.wikipedia.org/wiki/Block_device)，这是负责存储和检索指定数据块的[硬件的](http://en.wikipedia.org/wiki/Hardware)[抽象级别，尽管文件系统中的块大小可能是物理块大小的倍数。](http://en.wikipedia.org/wiki/Abstraction)在经典文件系统中，单个块可能只包含单个[文件](http://en.wikipedia.org/wiki/Computer_file)的一部分。[由于内部碎片](http://en.wikipedia.org/wiki/Internal_fragmentation)，这会导致空间效率低下，因为文件长度通常不是块大小的倍数，因此最后一个文件块将保持部分空。这将创建[slack space](http://en.wikipedia.org/wiki/Slack_space)，平均每个文件半个块。一些较新的文件系统试图通过称为[块子分配](http://en.wikipedia.org/wiki/Block_suballocation)和[尾部合并](http://en.wikipedia.org/wiki/Tail_merging)。

对经典的[Unix File System](http://en.wikipedia.org/wiki/Unix_File_System)也有一个合理的概述。

传统上，硬盘几何结构（磁盘本身的块布局）一直是[CHS](http://en.wikipedia.org/wiki/Cylinder-head-sector)。

*   **磁头**：每个（一侧）盘片上的磁性读写器；可以进出以访问不同的气缸
*   **圆柱体**：盘片旋转时通过磁头下方的轨道
*   **扇区**：在圆柱体的一部分上连续存储的恒定大小的数据量；驱动器可以处理的最小数据单位

如今，CHS 的使用并不多，因为

*   硬盘不再使用每个柱面的固定扇区数。通过使用每个扇区的恒定弧长而不是恒定旋转角度，将更多数据压缩到盘片上，因此外圆柱上的扇区比内圆柱上的扇区多。
*   根据 ATA 规范，一个驱动器每个磁头最多可以有 2^(个 16)柱面、2^(个 4)磁头和 2 个⁸扇区。对于 512B 扇区，这是 128GB 的​​限制。通过 BIOS INT13，无论如何都不可能通过 CHS 访问超过 7.88GB 的​​任何内容。
*   为了向后兼容，更大的驱动器仍然声称具有 CHS 几何结构（否则 DOS 将无法启动），但获取任何更高的数据需要使用 LBA 寻址。
*   CHS 甚至在 RAID 或非旋转媒体上都没有意义。

但由于历史原因，这影响了块大小：因为扇区大小几乎总是 512B，所以文件系统块大小一直是 512B 的倍数。（目前正在推出[1kB](http://www.intel.com/standards/nvmhci/index.htm)和 4kB 扇区大小的驱动器，但兼容性看起来相当痛苦。）

一般来说，在存储许多小文件时，较小的文件系统块大小会减少浪费的空间（除非使用尾部合并等高级技术），而较大的块大小会减少外部碎片并在大磁盘上具有较低的开销。文件系统块大小通常是 2 的幂，低于块设备的扇区大小，通常高于操作系统的页面大小。

[页面大小](http://en.wikipedia.org/wiki/Page_%28computing%29)因操作系统和平台而异（对于 Linux，也可能因配置而异）。与块大小一样，较小的块大小会减少内部碎片，但需要更多的管理开销。32 位平台上 4kB 的页面大小很常见。

现在，开始描述间接块。在UFS设计中，

*   一个[inode](http://en.wikipedia.org/wiki/Inode_pointer_structure)描述一个文件。
*   在 UFS 设计中，一个 inode 可以保存的指向数据块的指针数量非常有限（少于 16 个）。具体数字在派生的实现中似乎有所不同。
*   对于小文件，指针可以直接指向组成文件的数据块。
*   对于较大的文件，必须有间接指针，它指向一个只包含更多指向块的指针的块。这些可能是指向属于文件的数据块的直接指针，或者如果文件非常大，它们甚至可能是间接指针。

因此，当使用间接指针时，文件所需的存储量可能不仅仅是包含其数据的块。

并非所有文件系统都使用这种方法来跟踪属于文件的数据块。 [FAT](http://en.wikipedia.org/wiki/File_Allocation_Table)只使用一个文件分配表，它实际上是一个巨大的链表系列，许多现代文件系统使用[extents](http://en.wikipedia.org/wiki/Extent_%28file_systems%29)。

# php - $_POST 中未出现 reCaptcha 值

> ID：902627
> 
> 赞同：4
> 
> 时间：2009-05-23T22:21:54.127
> 
> 标签：php, forms, dom, handler, recaptcha

我正在尝试在我的网站上使用 reCaptcha，recaptcha_challenge_field 和 recaptcha_response_field 没有被添加到后端的 $_POST 数组中 - 但我表单中的其余变量是。

有任何想法吗？我已经仔细检查了公钥/私钥。

这是生成的 HTML：

```
 <form action='myform.php' name='myform' id='myform' method='post' enctype='multipart/form-data'>
    <tr class='select'>
      <td class='label'>Name:</td>

      <td>
        <input type='text'  name='name'  id='name'  class='inputtext'  maxlength='25'  size='25' >
      </td>
    </tr>
    <tr class='select'>
      <td class='label'>Email:</td>
      <td>
        <input type='text'  name='email'  id='email'  class='inputtext'  maxlength='25'  size='25' >

      </td>
    </tr>
    <tr class='select'>
      <td class='label'>Message:</td>
      <td>
        <textarea class='inputtext' name='message'  rows='10' cols='45'></textarea>
      </td>
    </tr>

    <tr class='select'>
      <td class='label'>Are you human?</td>
      <td>
        <script type="text/javascript" src="http://api.recaptcha.net/challenge?k=MY_KEY"></script>

    <noscript>
        <iframe src="http://api.recaptcha.net/noscript?k=MY_KEY" height="300" width="500" frameborder="0"></iframe><br/>
        <textarea name="recaptcha_challenge_field" rows="3" cols="40"></textarea>
        <input type="hidden" name="recaptcha_response_field" value="manual_challenge"/>
    </noscript>
      </td>
    </tr>

    <tr>
      <td>
      &nbsp;
      </td>
      <td style='text-align: left;' colspan='2'>
        <input type='submit' class='button' value='Send message'>
      </td>
    </tr>
  </form> 
```

到目前为止，这是我的处理程序：

```
print_r($_POST);

require_once('inc/recaptchalib.php');
$privatekey = "MY_PRIVATE_KEY";
$resp = recaptcha_check_answer ($privatekey,
                                $_SERVER["REMOTE_ADDR"],
                                $_POST["recaptcha_challenge_field"],
                                $_POST["recaptcha_response_field"]);

print_r($resp);

if (!$resp->is_valid) {
  die ("The reCAPTCHA wasn't entered correctly. Go back and try it again." .
       "(reCAPTCHA said: " . $resp->error . ")");
} 
```

任何帮助将非常感激。谢谢，

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-24T02:26:35.257

可以想象，由于交错方式`<table>`和`<form>`. 尝试将您的`<form>`和`</form>`标签分别移到您的`<table>`和之外`</table>`。

# php - 未找到硒元素

> ID：902631
> 
> 赞同：3
> 
> 时间：2009-05-23T22:23:35.280
> 
> 标签：php, selenium

我正在用 PHP 编写 Selenium 测试，以检查 Firefox 中 Web 应用程序的性能。我想以此为基准来比较不同的性能增强（升级 JQuery、PHP 5.3 等）。Web 应用程序的 AJAX 非常密集，到目前为止我只遇到了一个问题。

我有一个将内容加载到现有 div 中的 AJAX 调用。为了测试调用是否完成，我使用以下代码行：

```
$selenium->waitForCondition('$(\'div[id="divId"]\').height() > 100', $timeout); 
```

这按我的预期工作，但是当我尝试输入加载到 div 中的任何输入时，selenium 会抛出错误“未找到元素输入 [@id="inputId"]”。

我已经验证了输入的 id 是正确的，并且我尝试过加载 div 内的其他输入元素，但它们都不起作用。我还尝试添加一个 sleep(30) 以便我确定元素在 DOM 和屏幕上，但同样没有区别。

我真的被困在这一点上，在我解决这个问题之前无法继续前进。任何帮助是极大的赞赏。

谢谢，詹姆斯·阿姆斯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-23T22:43:55.830

我会看几件事：

1.  在加载项目之前，确保您检查的条件不正确。例如，检查`height`似乎很可疑 - 测试 div 内是否存在任何孩子不是更好吗？

2.  根据您编写选择器的方式，Selenium 可能会认为这`input[@id='inputId']`是选择器的实际标识符（而不仅仅是`inputId`）。确保不是这种情况。尝试使用`inputId`，这应该足够了，因为它是一个标识符。

3.  硒可能很挑剔。尝试不同的浏览器，看看是否会得到不同的结果。如果是这样，它可能代表 Selenium 没有很好地覆盖的区域。虽然这些通常很少而且相距甚远，但这是可能的。但我们需要查看更多代码才能确定情况是否如此。

# python - 向现有 Google AppEngine 数据模型/实体添加新属性的问题

> ID：902633
> 
> 赞同：4
> 
> 时间：2009-05-23T22:24:15.947
> 
> 标签：python, google-app-engine, properties, bigtable

在 GAE 中，我有一个名为 Foo 的模型，其中包含现有实体，并尝试向 Foo 添加一个名为*memcached*的新属性，该属性在最后一次将该值设置为 memcache 时采用 datetime 值。如果我尝试对此属性进行查询和排序，甚至筛选没有*memcached*值的实体，则不会返回尚未为此属性设置值的实体。我在这里遗漏了什么，或者作为替代方案，是否有一种快速的方法可以为给定模型的每个实体上的*新属性设置值？*

我创建了以下模型的一堆实体，

```
class Foo(db.Model):
    name = db.StringProperty(required=True) 
```

然后给这个模型添加一个属性，

```
class Foo(db.Model):
    name = db.StringProperty(required=True)
    memcached = db.DateTimeProperty(required=True, auto_now=True, auto_now_add=True, default=datetime.min) 
```

当我对查询进行排序或过滤时，不考虑新属性的默认值。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-23T22:53:58.650

除了遍历每个现有实体并添加属性外，别无他法，[这里是引导您完成整个过程的官方文档](http://code.google.com/appengine/articles/update_schema.html)。

# php - 在php中格式化数据

> ID：902637
> 
> 赞同：0
> 
> 时间：2009-05-23T22:27:08.563
> 
> 标签：php, formatting, variables, string-formatting

我需要做的是在变量中格式化数据，如下所示：

```
format: xxx-xxx variable: 123456 output: 123-456 
```

问题是我需要能够更改格式，因此静态解决方案不起作用。我还希望能够更改变量大小，例如：

```
format: xxx-xxx variable: 1234 output: 1-234 
```

注意：所有变量都是数字

**编辑**我应该清楚它的格式并不总是3组，它可能有更多的“-”作为符号，组将是不稳定的1-22-333-4444它只会在分组中1-5 的

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-23T22:36:07.017

你最好的选择是[preg_replace](http://us3.php.net/preg_replace)。

正则表达式需要一些时间来适应，但这可能是你最好的选择......

*编辑：*

```
//initial parsing
$val = preg_replace(
    '/(\d*?)(\d{1,2}?)(\d{1,3}?)(\d{1,4})$/', 
    '${1}-${2}-$[3}-${4}', 
    $inputString
);

//nuke leading dashes
$val - preg_replace('^\-+', '', $val); 
```

关键是让每个集合，除了最右边的一个非贪婪的，允许面向右侧的模式匹配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T22:38:05.937

您可以实现[策略模式](http://en.wikipedia.org/wiki/Strategy_pattern)，并拥有在运行时可交换的新格式类。如果您以前没有见过它，它看起来很复杂，但它确实有助于可维护性，并允许您随时使用 setFormatter() 切换格式化程序。

```
class StyleOne_Formatter implements Formatter
{
    public function format($text)
    {
      return substr($text,0,3).'-'.substr($text,3);
    }
}

class StyleTwo_Formatter implements Formatter
{
    public function format($text)
    {
      return substr($text,0,1).'-'.substr($text,1);
    }
} 
```

然后你会有你的格式化类，就像这样：

```
class NumberFormatter implements Formatter
{

   protected $_formatter = null;

   public function setFormatter(Formatter $formatter)
   {
      $this->_formatter = $formatter;
   }

   public function format($text)
   {
     return $this->_formatter->format($text);
   }
} 
```

然后你可以像这样使用它：

```
 $text = "12345678910";
 $formatter = new NumberFormatter();

 $formatter->setFormatter(new StyleOne_Formatter());
 print $formatter->format($text);
 // Outputs 123-45678910

 $formatter->setFormatter(new StyleTwo_Formatter());
 print $formatter->format($text);
 // Outputs 1-2345678910 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-23T22:48:20.860

如果您要格式化的输入始终是整数，您可以尝试 number_format 并格式化为钱（千等）。这是一个解决方案，它采用任何字符串并将其转换为您想要的格式：

```
$split_position = 3;
$my_string      = '';
echo strrev(implode('-',(str_split(strrev($my_string),$split_position))));

input: 1234;     output: 1-234
input: abcdefab; output: ab-cde-fab
input: 1234567   output: 1-234-567 
```

# java - 有人用过 ServiceLoader 和 Guice 吗？

> ID：902639
> 
> 赞同：16
> 
> 时间：2009-05-23T22:27:47.890
> 
> 标签：java, dependency-injection, guice

我一直想用我们的应用程序 + 构建系统在更大范围内尝试这个，但更高的优先级一直把它推到次要位置。这似乎是加载 Guice 模块的好方法，并且避免了关于“硬编码配置”的常见抱怨。单个配置属性很少自行更改，但您几乎总是有一组配置文件，通常用于不同的环境（调试、生产等）。

ServiceLoader 允许您提取定义为给定类型的服务的所有实现的列表。把它和 Guice 放在一起，你最终得到：

```
import java.util.ServiceLoader;

import com.google.inject.AbstractModule;
import com.google.inject.Module;

public class ModuleLoader<M extends Module> extends AbstractModule {

    private final Class<M> type;

    public ModuleLoader(Class<M> type) {
        this.type = type;
    }

    public static <M extends Module> ModuleLoader<M> of(Class<M> type) {
        return new ModuleLoader<M>(type);
    }

    @Override
    protected void configure() {
        ServiceLoader<M> modules = ServiceLoader.load(type);
        for (Module module : modules) {
            install(module);
        }
    }
} 
```

使用示例（作为 guice-servlet 项目中的动态 servlet 加载器）：

```
import com.google.inject.servlet.ServletModule;

public class ServletLoader extends GuiceServletContextListener {
    @Override
    protected final Injector getInjector() {
       return Guice.createInjector(ModuleLoader.of(ServletModule.class);
    }
} 
```

服务（打包为模块）将打包在单独的 jar 文件中。在每一个中，您将在元数据中定义类：

```
Within servlets.jar: META-INF/services/com.google.inject.Module

com.example.webapps.MyServletModuleA
com.example.webapps.MyServletModuleB 
```

由于我们使用 Maven，我们认为这将是理想的，因为我们可以在运行时通过配置文件依赖项引入不同的实现。有人像这样使用Guice吗？

如果没有，请随意使用这个例子，看看它是如何为你工作的。（ServiceLoader 仅在 JDK6+ 中支持）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-08-08T03:15:31.517

我们在我的工作中几乎就是这样做的。由于一些内部限制，我们目前被困在 java 5 中，所以我们使用 Service Provider 做的有点不同（因为像你提到的那样在 java 6 之前无法访问 ServiceLocator），但它基本上是一样的。

我记得在某处读到，这是 Guice 开发人员推荐的首选方式之一，尽管他们希望保持这种开放的灵活性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-01-16T00:40:17.657

我已经考虑过这种方式，但我没有使用它，因为我害怕我必须保持我的模块非常小，因为不可能两次绑定相同的接口。我的问题是，如果我想使用另一个 jar 中的接口/类/枚举/任何内容，并且该 jar 定义了一个 services/* 文件，我就搞砸了，因为我不能在不加载它的情况下使用 jar 的内容作为模块。

我希望我的担忧是明确的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-01-27T19:49:21.237

“因为不可能两次绑定同一个接口。”

这确实是错误的！使用 Guice 的 Multibinder，有一种方法可以处理同一接口的不同实现，可能绑定在不同的模块中。

对于实际加载，我找到了一个与 Mark Renouf 略有不同的解决方案（他的 ModuleLoader 看起来确实更好），但我的博客文章可能会更多地展示这种方法适用的环境（插件）以及扩展点的样子：

[Guice 2.0 Multibinder + Java ServiceLoader = 插件机制](http://thedet.wordpress.com/2011/01/23/guice-2-0-multibinder-java-serviceloader-plugin-mechanism/)

# winapi - 如何随意隐藏任务栏气球？

> ID：902642
> 
> 赞同：3
> 
> 时间：2009-05-23T22:29:49.213
> 
> 标签：winapi, taskbar, tooltip, balloon

强制任务栏图标显示气球工具提示很容易：我需要做的就是在调用 Shell_NotifyIcon( NIM_MODIFY, ... ) 时设置 NIF_INFO 标志，然后气球就会出现，没问题。

现在，当我不再需要气球时，我也希望能够隐藏它，但我找不到这样做的方法。我尝试清除 NIF_INFO 标志并调用 Shell_NotifyIcon( NIM_MODIFY, ... )，但气球仍然存在。它确实会在几秒钟后自行消失，但这不是我想要的：当我的程序认为应该隐藏它时，我想立即隐藏它。

让气球消失的唯一方法似乎是破坏图标，然后再次将其添加到任务栏，但它很难看。

是否可以在不重新创建任务栏图标的情况下隐藏气球？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-24T00:53:37.783

要立即隐藏气球，请将 的`szInfo`成员设置`NOTIFYICONDATA`为空字符串，例如`nid.szInfo[0] = 0;`并调用`Shell_NotifyIcon( NIM_MODIFY, &nid )`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-23T23:12:40.110

我会提出，强行删除通知气球并不真正符合用户的最佳利益。有时用户不会立即查看通知，并且在几秒钟内发生的缓慢消失让他们有机会在气球消失之前查看。从可用性的角度来看，显示气球应该是应用程序的责任，但删除气球实际上应该是用户的责任。否则，您可能会隐藏他们真正感兴趣的信息，并且通过立即强行隐藏它，您可以完全消除用户在气球消失期间的“最后机会”。

# asp.net - 在 vb.net 中模拟活动目录用户

> ID：902645
> 
> 赞同：1
> 
> 时间：2009-05-23T22:32:42.267
> 
> 标签：asp.net, active-directory, impersonation

我从未对活动目录进行过编程，但我想做以下事情：

1.  在 asp.net 站点上，使用有效的活动目录用户名和密码登录。如果登录有效，则重定向到页面以执行某些操作。

2.  在相关任务中，但不是第 1 部分的一部分，解锁帐户或更改活动目录帐户的密码。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-23T22:52:43.550

1.) 您应该设置您的 web.config 以使用表单身份验证。成员资格提供程序应设置为 ActiveDirectoryMembershipProvider。您可以使用内置的登录控件。

2.) 您需要一个具有您要求的特定权限的 Active Directory 用户：解锁帐户、更改密码。当您为 AD 用户执行其中一项功能时，您需要将 ASP 执行的帐户模拟为具有特权（更改密码或解锁帐户）的 Active Directory 用户。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T17:30:33.380

您可以使用“advapi32.dll”在服务器端模拟不同的用户。

从页面底部获取示例代码。

我不想在这里复制他的代码。

[http://csharptuning.blogspot.com/2007/06/impersonation-in-c.html](http://csharptuning.blogspot.com/2007/06/impersonation-in-c.html)

但是，模拟的一个警告是，进行模拟的计算机需要与您模拟的用户位于同一域中

# visual-c++ - C::B 编译器配置问题

> ID：902649
> 
> 赞同：1
> 
> 时间：2009-05-23T22:36:53.677
> 
> 标签：visual-c++, mingw, codeblocks

我将 MinGW 配置为 Code::Blocks 正确。
我还检查了它是否可以使用命令行工作。
由于某种原因，我根本无法使用任何编译器进行编译。
甚至没有 VC++。
这是一个已知的问题？
有谁知道如何解决它？
这是我得到的错误：

> “静态库 - MinGW RELEASE”使用了无效的编译器。跳过……无事可做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-23T22:41:06.383

询问有关 Code::Blocks 问题的最佳地点是[http://forums.codeblocks.org上的 CB 支持论坛](http://forums.codeblocks.org)

话虽如此 - 试试这个：

*   开始 CB
*   转到设置菜单
*   选择“编译器和调试器”
*   将选项卡式对话框导航到“工具链可执行文件”
*   根据需要选择编译器/调试器目录和 exe

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-24T21:34:48.153

修正：
我必须更改编译器名称，因为我下载的 mingw 发行版保存了旧的 GCC 文件名而不是 mingw 的文件名。我想知道为什么 code::blocks 也没有检测到它们。

# c# - 使用托管代码提取 Exchange 邮件附件

> ID：902652
> 
> 赞同：0
> 
> 时间：2009-05-23T22:39:59.410
> 
> 标签：c#, email, exchange-server, managed, extraction

有没有人知道一种方法可以在邮件从 Exchange 2003 到达时将特定扩展名的邮件附件复制到使用托管代码的共享目录中？

我知道一种方法是使用 vbscript，使用交换暴露的接收器。但是我想知道是否有人看过托管代码中的示例，可能使用互操作？

非常感谢任何示例代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-23T22:52:16.313

有许多免费/开放源代码，更不用说商业 imap 和 pop3 库，它们可以公开您正在寻找的功能。就个人而言，我会设置一个传递规则，将所述电子邮件传送到给定文件夹，并使用 IMAP 作为客户端下载器。

[Codeplex 上的 IMAP](http://www.google.com/searchq=c%23+imap+site%3Acodeplex.com)

# c# - 如何在部分更新期间向用户发送状态更新

> ID：902656
> 
> 赞同：0
> 
> 时间：2009-05-23T22:41:57.597
> 
> 标签：c#, asp.net, asp.net-ajax

我有以下内容：

1.  母版页
2.  StatusDisplay - Ascx 用户控件，在从 beginRequest 到 endRequest 期间显示部分回发或更新发生的 MS AJAX 异常
3.  具有多级 .ascx Web 用户控件的页面，其中一些是动态加载的

目前，当更新面板中发生回发时，StatusDisplay 会显示“更新请求..”以及最后是否有异常。

我还想从 StatusDisplay 应该显示的不同位置发送特定的状态更新，例如“已添加客户”。目前，不知道其他控件中是否存在 StatusDisplay，我想保持这种状态。

这个怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-23T22:57:31.887

使用一种称为反向 ajax 的技术。反向 Ajax 允许服务器在内容可用时立即将内容推送到浏览器，这通常由 IFrame、响应刷新和处理回调的常用 JavaScript 函数的组合实现

[长请求的简单增量状态更新](http://encosia.com/2007/10/03/easy-incremental-status-updates-for-long-requests/)是一篇关于这个主题的好文章。

这里的示例实现依赖于其创建和刷新到客户端的 javascript 具有已附加到父窗口对象的 javascript 回调函数“UpdateProgress”的假装（因为调用是在 IFrame 中进行的）。由于任务长时间运行，代码执行刷新到客户端并执行执行任何操作的 javascript 函数。

```
protected void UpdateProgress(int PercentComplete, string Message)
{
  // Write out the parent script callback.
  Response.Write(String.Format(
    "<script>parent.UpdateProgress({0}, '{1}');</script>", 
    PercentComplete, Message));
  // To be sure the response isn't buffered on the server.
  Response.Flush();
} 
```

# c# - 尝试使用 Linq2Sql 从表中获取最大日期

> ID：902659
> 
> 赞同：0
> 
> 时间：2009-05-23T22:44:06.593
> 
> 标签：c#, linq-to-sql

下面的 linq2sql 代码让我很头疼，我希望有人能帮忙

```
 DateTime _maxRecordedDate = (from snapshot in _ctx.Usage_Snapshots
                                         where snapshot.server_id == server_id
                                         orderby snapshot.reported_on descending
                                         select snapshot.reported_on).First().Value; 
```

此代码在 LinqPad 中工作并且编译良好，但是当项目运行时出现“不支持指定的方法”。

如果我不使用 Value 或强制转换它，我会收到以下错误：

**

> 无法隐式转换类型“System.DateTime？” 到“系统。日期时间”。存在显式转换（您是否缺少演员表？）

**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-23T22:52:42.083

它不想要 First().Value 吗？也许只是 First()。

我在看[这个](http://msdn.microsoft.com/en-us/vcsharp/aa336750.aspx#FirstSimple)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T22:58:46.363

```
DateTime? _maxRecordedDate = _ctx.Usage_Snapshots.Where(s => s.server_id == server_id).Max(d => d.reported_on); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-23T23:01:48.617

Robert 提供了一种更好的方法，但是您的代码的问题是您正在调用 .Value 并且它将在 SQL Server 的上下文中运行，因此没有可以转换为 SQL 的 .Value 操作。您必须调用 .ToList().First().Value，或分配给 DateTime？由于您不能调用 .First().ToList() ... 因为 First() 返回单个 DateTime？那么你最好只分配给 DateTime?，因为你不想从 SQL 返回整个列表。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-23T23:34:40.487

经过大量搜索，我发现问题源于使用 ADO.NET 数据服务。显然他们使用了有限的 Linq 子集，目前无法使用 Max、First 等方法。Bummme

# java - 健康的垃圾收集指标？

> ID：902660
> 
> 赞同：3
> 
> 时间：2009-05-23T22:46:33.767
> 
> 标签：java, garbage-collection

我分析了一个 jdbc/hibernate 批处理导入器。它需要一个 csv 对其进行轻微转换并将其导入到位于 localhost 的数据库中。

令我惊讶的是，该操作不受 I/O 限制，而是受 CPU 限制。

根据 jmx/jconsole 以及 netbeans 分析器，看起来 60% 的 cpu 时间都花在了“老一代”垃圾收集器上，其余时间用于几何转换（这是合理的）和休眠会话管理。

根据 jconsole，其他应用程序使用了大约 5-10%，那么对于此类批量插入任务，cpu/young GC/old GC 的“典型”比率是多少？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-24T10:02:59.997

在再次查看 netbeans profiler/heap walker 之后，很明显有大量包含完整 sql 语句的 String 实例。这是由 log4jdbc 引起的。所以查理马丁斯的猜测是部分正确的。

log4jdbc 未配置为记录到任何附加程序，但其日志级别仍设置为 INFO。虽然日志文件没有包含任何sql信息，但它仍然在后台渲染。

没有 log4jdbc 带来的性能提升是巨大的。

数据库 cpu% 利用率从 1-2% 上升到 20-50%（一个核心充分利用）以前以批处理模式插入 5000 个条目，这需要大约 100 秒而不记录一次，现在大约 1 个 5000 个条目的块插入-2 秒。

GC 现在占用了大约 6-7% 的总 cpu 时间，这是理所当然的。

所以我的结论：

## GC 时间大于 20% 清楚地表明有问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-24T03:00:28.573

百分之六十真的很高。这通常表明有人使用了很多临时字符串或类似的东西。它发生在“老一代”中的事实表明它可能发生在数据库端，可能是在等待数据库事务发生时。但这只是马背上的猜测。

您可能想要制作更详细的运行配置文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-24T03:06:44.613

除了查理所说的之外，我认为可能导致这种情况的另一件事是，如果你有很多带有终结器的对象（有些库会调皮地做）——我记得，这实际上迫使它们绕过 VM 的对象快速路径解除分配。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T21:46:53.360

我同意 GC 时间通常最多 10% 就可以了。如果你有老一代的问题，尝试添加**-XX:NewSize** =300m 参数，在这里你可以增加年轻一代。这有助于避免旧区大量使用过的物品（垃圾）。尤其是当您只有很多本地对象并且您没有故意保留任何东西更长时间时。

# c++ - STL 容器分配和 const 指针

> ID：902667
> 
> 赞同：10
> 
> 时间：2009-05-23T22:51:16.440
> 
> 标签：c++, gcc, stl, constants

这编译：

```
int* p1;
const int* p2;
p2 = p1; 
```

这不会：

```
vector<int*> v1;
vector<const int*> v2;
v2 = v1;  // Error!
v2 = static_cast<vector<const int*> >(v1);  // Error! 
```

嵌套 const 指针的类型等价规则是什么？我认为转换是隐式的。此外，我宁愿不实现 STL 容器的逐点分配，除非我真的必须这样做。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-05-23T23:22:29.623

直接分配是不可能的。正如其他人所解释的，等价不是由指针类型建立的，而是由容器类型建立的。在这种情况下，vector 不想接受另一个具有不同但兼容元素类型的向量。

没有真正的问题，因为您可以使用`assign`成员函数：

```
v2.assign(v1.begin(), v1.end()); 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-05-23T22:58:51.090

从`int*`to的转换`const int*`是语言中内置的，但是这些向量没有从一个到另一个的自动转换。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-23T22:56:54.947

问题不是指针，而是两个向量的类型。在您的示例中，模板类型之间没有像 v1 和 v2 这样的标准转换。

这在下面的代码中可能更容易看到：

```
#include <vector>
using namespace std;

int main() {
    vector <char> cv;
    vector <int> iv;
    cv = iv;    // error
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-07-24T04:16:11.483

在 C++ 模板类中，模板的每个实例化都是一个完全不同的类 -`vector<int *>`和`vector<const int *>`之间的差异`vector<int *>`与和`vector<string>`或任何其他两个类之间的差异一样多。

正如[Earwicker](https://stackoverflow.com/questions/902667/stl-container-assignment-and-const-pointers/902707#902707)`vector`所建议的那样，委员会可能已经添加了一个转换运算符- 您可以继续提供您自己的此类功能的实现：`vector<U>`

```
template <class A, class T>
vector<T> convert_vector(const vector<A> &other)
{
    vector<T> newVector;
    newVector.assign(other.begin(), other.end());
    return newVector;
} 
```

并像这样使用它：

```
vector<int*> v1;
vector<const int*> v2;
v2 = convert_vector<const int*>(v1); 
```

不幸的是，在 C++0x 附带它的移动构造函数之前，这在性能方面将是非常糟糕的。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-23T23:25:04.080

完全有可能编写自己的版本来`vector`说明可能的情况。它将与标准类型相同，但具有模板化版本`operator=`，如下所示：

```
template <class A>
vector2<T> &operator=(const vector2<A> &other)
{
    assign(other.begin(), other.end());
    return *this;
} 
```

其中 T 是整个类的元素类型，而 A 是可分配给 T 的任何类型。

我不清楚为什么`std::vector`没有这个。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-07-28T16:10:42.837

危险的，除非你知道这些类型是绝对兼容的：

`v2 = reinterpret_cast<std::vector<const int *> & >(v1);`

大多数 STL 实现确实使用了一种特殊化，即所有指针向量共享相同的底层实现。这是因为 (void *) 通常与 (int *) 或任何其他指针类型的大小相同。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-10-23T12:37:47.230

前面的任何答案中都没有提到的重要一点是，模板专业化使得这不可能在语言范围的基础上实现。考虑：

```
template<class T>
class Test
{
    T t;
};

template<>
class Test<const int>
{
    char array[1000];
}; 
```

因此`Test<const int>`包含一个字符数组，而`Test<int>`包含一个 int。

```
#include <iostream>
using namespace std;

int main()
{
    Test<int> t1;
    Test<const int> t2;
    cout << sizeof(t1) << endl; // gives 4
    cout << sizeof(t2) << endl; // gives 1000
    return 0;
} 
```

实际上`vector<foo *>`，`vector<const foo *>`它们可能几乎没有什么不同——特别是它们可能具有相同的大小。然而，显式模板特化的可能性意味着它们可能会有很大的不同，因此编译器不愿意允许转换。

[（这个答案主要是从http://bytes.com/topic/c/answers/449611-cast-vector-foo-vector-const-foo#post1717570](http://bytes.com/topic/c/answers/449611-cast-vector-foo-vector-const-foo#post1717570)复制的）

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-07-28T14:05:37.907

[成员模板](http://en.wikibooks.org/wiki/More_C%2B%2B_Idioms/Coercion_by_Member_Template)成语强制是解决问题的一种可能方法。本质上，添加了一个成员模板复制分配运算符，它允许模板类参与相同的隐式类型转换（强制），否则只能在类模板的类型参数上进行。尽管该成语在其他地方的 STL 中使用，但在 std::vector 中不可用。

# mysql - 在 MySQL 中解析 XML 字符串

> ID：902678
> 
> 赞同：7
> 
> 时间：2009-05-23T22:58:14.443
> 
> 标签：mysql, xml, xpath

我的任务是在 MySQL 存储过程中解析一个简单的 XML 格式的字符串。XML 看起来像这样（仅用于测试目的）：

```
<parent>
    <child>Example 1</child>
    <child>Example 2</child>
</parent> 
```

我需要 MySQL 做的是为每个匹配生成一个结果集一行。我存储的过程代码如下所示：

```
DECLARE xmlDoc TEXT;
SET xmlDoc = '<parent><child>Example 1</child><child>Example 2</child></parent>';
SELECT ExtractValue(xmlDoc, '//child'); 
```

然而，它的作用是连接所有匹配项，产生“示例 1 示例 2”。顺便说一句，这是记录在案的，但非常无用的行为。

**我该怎么做才能使它成行返回匹配**项，而不必计算匹配项并逐个处理它们？MySQL甚至可以吗？

谢谢大家！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-24T00:04:53.047

这需要一个行集生成功能，并且`MySQL`缺少它。

您可以改用虚拟表或子查询：

```
SELECT  ExtractValue(@xml, '//mychild[$@r]'),
        @r := @r + 1
FROM    (
        SELECT  @r := 1
        UNION ALL
        SELECT  1
        ) vars 
```

请注意，对会话变量的支持`XPath`已中断`5.2`（但在 中工作正常`5.1`）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-24T00:04:37.820

```
DECLARE i INT DEFAULT 1;
DECLARE count DEFAULT ExtractValue(xml, 'count(//child)');

WHILE i <= count DO
    SELECT ExtractValue(xml, '//child[$i]');
    SET i = i+1;
END WHILE 
```

或者...

```
DECLARE v VARCHAR(500) DEFAULT '';
DECLARE i INT DEFAULT 1;

REPEAT
    SET v = ExtractValue(xml, '//child[$i]')
    SET i = i+1;
    IF v IS NOT NULL THEN
        -- do something with v
    END IF
UNTIL v IS NULL 
```

对不起，如果这里的语法有点摇摆不定，不是一个 mysql 大师......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-09-26T08:38:26.677

下面是一个使用 while 循环读取 xml 的存储过程示例

```
-- drop procedure testabk;
-- call testabk();
delimiter //
create procedure testabk()
begin

DECLARE k INT UNSIGNED DEFAULT 0;
DECLARE xpath TEXT;
declare doc varchar(1000);
DECLARE row_count1 INT UNSIGNED; 

set doc='<StaticAttributesBM><AttributeId id="11">Status</AttributeId><AttributeId id="2">Reason</AttributeId><AttributeId id="3">User Remarks</AttributeId></StaticAttributesBM>';
DROP TABLE IF EXISTS tempStaticKeywords;
CREATE TABLE tempStaticKeywords(id int, staticKeywords VARCHAR(500));
SET row_count1 := extractValue(doc,'count(/StaticAttributesBM/AttributeId)');
select row_count1;

-- iterate over books
WHILE k < row_count1 DO        
    SET k := k + 1;
    SET xpath := concat('/StaticAttributesBM/AttributeId[', k, ']');
    INSERT INTO tempStaticKeywords(id,staticKeywords) VALUES (
      extractValue(doc, concat(xpath,'/@id')),
      extractValue(doc, xpath)     
    );
END WHILE;

select * from tempStaticKeywords;

END
// 
```

**输出如下**

id 静态关键字

1 状态

2 原因

3 用户备注

# jquery - jQuery.Scrollable Plugin

> ID：902685
> 
> 赞同：2
> 
> 时间：2009-05-23T23:05:28.377
> 
> 标签：jquery, plugins

I am using the following plugin:

[http://flowplayer.org/tools/scrollable.html](http://flowplayer.org/tools/scrollable.html)

and under the sub-heading of "Scripting API" - there is a method as follows:

getItems() jQuery Returns the scrollable items as a jQuery object

My question is - how can I access this object to obtain its values, such as id and name of all the scrollable items that it currently has assigned to it?

Thanks. TT.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-23T23:14:23.163

i guess that you can...

```
$("div.scrollable").scrollable().getItems().each(function(i) {
     console.log(this.id);
     console.log($(this).attr('id'));
}); 
```

# c++ - glfwSleep() 如何导致段错误？

> ID：902687
> 
> 赞同：1
> 
> 时间：2009-05-23T23:08:10.807
> 
> 标签：c++, c, segmentation-fault, sleep, glfw

在我的多线程应用程序中，我使用了 sleep() 函数（来自 GLFW 库的函数）：

```
glfwSleep(..); 
```

它显然导致我的应用程序出现段错误，因为我的调用堆栈显示：

```
#0 76CFC2BC WaitForSingleObjectEx() (C:\Windows\system32\kernel32.dll:??)
#1 00000016 ??() (??:??)
#2 0000006C ??() (??:??)
#3 00000000 ??() (??:??) 
```

`glfwSleep()`用于线程内部。那很危险吗？为什么我的程序会因此而出现段错误？

### 编辑：

当 的参数`glfwSleep()`< 0.02 (secs) 时，它不会出现段错误！

### 编辑2：

来自 GLFW 的官方文档：

> 在您习惯之前编写线程应用程序可能会非常尴尬，但有一些非常容易遵循的关键规则：
> 
> *   始终确保对线程之间共享的数据的独占访问！
> *   确保线程正确同步！
> *   **从不忙等待！**

我想我得到了答案..现在必须找到替代方案..

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-23T23:22:20.557

来自[GLFW 维基](http://www.haskell.org/haskellwiki/GLFW)：

> GLFW 不适用于 GHC 线程、forkIO 或 threadDelay。因此，如果可以，请避免使用它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T23:28:22.823

段错误的线程是否与 glfwSleep() 的调用者线程相同？

似乎是调用 WaitForMultipleObjectsEx API 引起的崩溃。您是否指定并将正确的同步对象和数字传递给 WaitForMultipleObjectsEx？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-24T16:57:02.337

引用[*The Pragmatic Programmer 的*](http://www.pragprog.com/the-pragmatic-programmer)话，

> **``select'' 没有坏掉**
> 
> 在操作系统或编译器中，甚至在第三方产品或库中都很少发现错误。该错误最有可能在应用程序中。

为什么你的程序在调用`WaitForSingleObjectEx()`时`glfwSleep()`调用`Sleep()`？好吧，即使您没有 的源代码`Sleep()`，它也不完全是一个黑匣子。反汇编`Sleep()`，您可能会看到（取决于您拥有的 Windows 版本）`Sleep()`调用或 tail-calls `SleepEx()`。在 XP 上`SleepEx()`调用`NtDelayExecutionThread()`，而在 Vista 上调用`WaitForSingleObjectEx()`.

那么你的堆栈的其余部分发生了什么？00000016、0000006C 和 00000000 不是有效的返回地址。如果在您的代码中的某个地方，您将指向堆栈分配缓冲区的指针传递给另一个线程，并且当您的程序处于睡眠状态时，另一个线程破坏了第一个线程的堆栈，我不会感到惊讶。步入`Sleep()`，在返回地址上设置内存断点，或许就能抓到罪魁祸首。

# ruby-on-rails - 是否可以在 self.posts.find 中超越自我？

> ID：902705
> 
> 赞同：1
> 
> 时间：2009-05-23T23:23:45.983
> 
> 标签：ruby-on-rails, model, find, self

扩展下面的 recent_posts_on_self，**我想添加一个 all_recent_posts_on_self 方法**，但我不确定是否可以**使用语法 self.posts.find**。另一方面， all_recent_posts_on_class 似乎很简单。

```
class User < ActiveRecord::Base
  has_many :posts, :class_name => "Post" , :foreign_key => "author_id"
  has_many :comments, :class_name => "Comment", :foreign_key => "author_id"

  def recent_posts_on_class
    Post.find(  :all, :conditions => ['author_id = ?', self.id],
                :order => 'created_at asc', :limit => 5)
  end

  def recent_posts_on_self
    self.posts.find(:all, :order => 'created_at ASC', :limit => 5)
  end
end 
```

在上面的示例中，我有两种方法可以找到与用户关联的最近的博客文章。我可以调用 Post.find 并将 author_id 传递给它，或者我可以调用 self.posts.find 而我不需要传递作者 ID。我认为这是因为在后一种情况下，self.posts 已经根据用户对象的主键和与该用户关联的 has_many :posts 进行了限制。在这种情况下，这是一个优势，因为我不需要麻烦地将 author_id 作为参数传递。但是，如果我不需要按作者限制查询，是否可以创建一个 all_recent_posts_on_self 来执行此操作？

**我在说的是这种方法的等价物**（它省略了：条件）：

```
 def all_recent_posts_on_class
    Post.find(:all, :order => 'created_at asc', :limit => 5)
  end 
```

**但使用 self.posts.find 而不是 Post.find**：

```
 def all_recent_posts_on_self
    self.posts.find(...)
  end 
```

还：

**即使可以使用 self.posts.find 来做到这一点，使用 Post.find 是否“更好”？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-24T01:34:10.323

这并不完全是您所要求的，但我认为这有助于了解和遵循常见模式有助于避免复杂或令人困惑的实现。

执行此操作的“Rails 方式”是使用命名范围：

```
class Post < ActiveRecord::Base
  belongs_to :user
  named_scope :recent, :order => 'created_at desc', :limit => 5
end

class User < ActiveRecord::Base
  has_many :posts
end 
```

没有比这更具声明性和易于阅读的了：

```
user.posts.recent # 5 most recent posts by the user
Post.recent # 5 most recent posts globally 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T23:57:22.610

我不确定您为什么要使用 self.posts.find(..) 来查找其他作者的帖子。这个习惯用法专门用于查找与特定实例关联的对象的子集。

Post.find() 是当您不想限制特定用户模型时应该使用的。毕竟，User 对象上的 posts() 方法只是一种便利，它实际上与对 Post.find(:all, :conditions => ['author_id', self.id]) 的（缓存）调用相同。

# iphone - iphone cocoa“错误：请求成员____不是结构或联合”

> ID：902710
> 
> 赞同：1
> 
> 时间：2009-05-23T23:29:47.360
> 
> 标签：iphone, objective-c, cocoa, cocoa-touch, uiviewcontroller

这种方式有效：

```
type1ViewController *viewController = [[type1ViewController alloc] initWithNibName:@"Type1View" bundle:nil];
viewController.parentViewController = self;
self.type1ViewController = viewController;
[self.view insertSubview:viewController.view atIndex:0];
[viewController release]; 
```

但是这种方式给了我错误，“请求成员 parentViewController 不是结构或联合”：

```
type1ViewController *viewController = [[type1ViewController alloc] initWithNibName:@"Type1View" bundle:nil];
self.type1ViewController = viewController;
self.type1ViewController.parentViewController = self;
[self.view insertSubview:viewController.view atIndex:0];
[viewController release]; 
```

我不明白为什么它应该不同。编译器看到它不喜欢什么？提前感谢您的帮助

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-23T23:37:46.067

当您调用`self.type1ViewController.parentViewController`而不是`viewController.parentViewController`，它会给您一个错误，因为您已`self.type1ViewController`声明为某个超类，而不是 type1ViewController。当编译器查看这个声明时，它不会找到 parentViewController 属性，所以它会给你错误。

在第一个示例中，您的 viewController 仍被声明为 type1ViewController，因此可以正常工作。如果将它转换为 type1ViewController，它实际上仍然可以在第二个示例中工作，但当然最好只是更改声明。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-12-17T19:32:11.400

我还会检查您的 NIB 文件中的 Type1ViewController。我遇到了这个错误会在笔尖上的引用插座中抛出的问题，我正在寻找我创建的自定义视图控制器以外的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-11T19:33:26.597

如果 ParentViewController 的 type1ViewController 属性是用 Type1ViewController 类声明的，那么第一行应该是：

```
Type1ViewController *viewController = [[type1ViewController alloc] initWithNibName:@"Type1View" bundle:nil]; 
```

不是：

```
type1ViewController *viewController = [[type1ViewController alloc] initWithNibName:@"Type1View" bundle:nil]; 
```

注意大小写。我实际上有点惊讶这个编译没有错误或警告。

# vim - 在 Vim 中不打开折叠就无法编辑标题

> ID：902711
> 
> 赞同：1
> 
> 时间：2009-05-23T23:32:43.237
> 
> 标签：vim, fold

假设您有一个光标位于如图所示的闭合折叠处。

[替代文字 http://dl.getdropbox.com/u/175564/foldEdit.png](http://dl.getdropbox.com/u/175564/foldEdit.png)

**在 Vim 中，如何在不打开折叠的情况下编辑 SMALLAPPS 的标题？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-23T23:57:54.107

您要编辑折叠块的第一行，还是折叠关闭时出现的字符串？如果是前者，我认为您不打开折叠就无法做到。如果是后者，请查看[foldtext](http://www.vim.org/htmldoc/fold.html#fold-foldtext)选项。它可以是任何表达式。评估此表达式以创建此字符串。

从文档：

> 'foldtext' 是指定表达式的字符串选项。评估此表达式以获得为闭合折叠显示的文本。例子：
> 
> ```
> :set foldtext=v:folddashes.substitute(getline(v:foldstart),'/\\*\\\|\\*/\\\|{{{\\d\\=','','g') 
> ```
> 
> 这显示了折叠的第一行，删除了“/ *”、“* /”和“{{{”。注意使用反斜杠来避免某些字符被 ":set" 命令解释。定义一个函数并调用它更简单：
> 
> ```
> :set foldtext=MyFoldText()
> :function MyFoldText()
> :  let line = getline(v:foldstart)
> :  let sub = substitute(line, '/\*\|\*/\|{{{\d\=', '', 'g')
> :  return v:folddashes . sub
> :endfunction 
> ```

另一种方法是使用[标记](http://www.vim.org/htmldoc/fold.html#fold-methods)折叠方法。有了它，您可以在折叠标记之前输入任何字符串，它会在折叠关闭时出现。

从文档：

> 文本中的标记告诉折叠开始和结束的位置。这使您可以精确地指定折叠。这将允许删除和折叠，而不会有包含错误行的风险。'foldtext' 选项通常设置为使标记之前的文本显示在折叠行中。这使得为​​折叠命名成为可能。
> 
> 标记可以包含一个级别，或者可以使用匹配对。包含一个级别更容易，您不必添加结束标记并避免不匹配标记对的问题。例子：
> 
> ```
> /* global variables {{{1 */
> int varA, varB; 
> ```

# javascript - 如何以编程方式单击带有 javascript 的链接？

> ID：902713
> 
> 赞同：195
> 
> 时间：2009-05-23T23:33:25.373
> 
> 标签：javascript, hyperlink, click, anchor

有没有办法使用 JavaScript 点击我页面上的链接？

* * *

## 回答 #1

> 赞同：271
> 
> 时间：2010-09-17T20:03:34.620

```
document.getElementById('yourLinkID').click(); 
```

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2009-05-24T01:16:20.330

此功能至少在 Firefox 和 Internet Explorer 中有效。如果事件处理程序不取消默认操作，它将运行附加到链接的任何事件处理程序并加载链接的页面。

```
function clickLink(link) {
    var cancelled = false;

    if (document.createEvent) {
        var event = document.createEvent("MouseEvents");
        event.initMouseEvent("click", true, true, window,
            0, 0, 0, 0, 0,
            false, false, false, false,
            0, null);
        cancelled = !link.dispatchEvent(event);
    }
    else if (link.fireEvent) {
        cancelled = !link.fireEvent("onclick");
    }

    if (!cancelled) {
        window.location = link.href;
    }
} 
```

* * *

## 回答 #3

> 赞同：44
> 
> 时间：2009-05-23T23:44:35.817

如果您只想更改当前页面地址，只需在 Javascript 中执行此操作即可：

```
location.href = "http://www.example.com/test"; 
```

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2009-05-23T23:37:43.320

就像这样：

```
<a id="myLink" onclick="alert('link click');">LINK 1</a>
<a id="myLink2" onclick="document.getElementById('myLink').click()">Click link 1</a> 
```

或在页面加载时：

```
<body onload="document.getElementById('myLink').click()">
...
<a id="myLink" onclick="alert('link click');">LINK 1</a>
...
</body> 
```

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2015-09-24T10:24:59.453

单击链接的 jQuery 方法是

```
$('#LinkID').click(); 
```

对于 mailTo 链接，您必须编写以下代码

```
$('#LinkID')[0].click(); 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2017-02-07T12:49:39.717

对我来说，我设法让它这样工作。我在 5000 毫秒内部署了自动点击，然后在 1000 毫秒后关闭了循环。然后只有 1 次自动点击。

```
<script> var myVar = setInterval(function ({document.getElementById("test").click();}, 500)); setInterval(function () {clearInterval(myVar)}, 1000));</script> 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2017-05-03T17:27:34.257

上述许多方法已被弃用。现在建议使用[这里找到的构造函数](https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent/CustomEvent)

```
function clickAnchorTag() {
    var event = document.createEvent('MouseEvent');
    event = new CustomEvent('click');
    var a = document.getElementById('nameOfID');
    a.dispatchEvent(event);
} 
```

这将导致锚标记被单击，但它不会显示弹出窗口阻止程序是否处于活动状态，因此用户需要允许弹出窗口。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-24T01:04:09.853

您可以将它们重定向到另一个页面。实际上，让它从字面上点击一个链接并前往它似乎是不必要的，但我不知道整个故事。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-23T23:40:49.193

除了点击，您可以使用 Javascript 转发到点击将转到的 URL 吗？

也许你可以在身体 onLoad 中放一些东西去你想去的地方。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-08-17T22:10:41.747

对于那些想要单击具有特定文本内容的所有链接的人来说，这将起作用：

```
for (const a of document.querySelectorAll("a")) {
  if (a.textContent.includes("<your text to be searched here>")) {
    a.click();
  }
}
```

参考：[https ://stackoverflow.com/a/42907920/2361131](https://stackoverflow.com/a/42907920/2361131)

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2015-08-05T00:16:50.533

客户端 JS 功能可在...时自动单击链接

这是一个示例，您检查隐藏表单输入的值，该输入包含从服务器传递的错误..您的客户端 JS 然后检查它的值并在您指定的另一个位置填充错误..在此案例弹出登录模式。

```
var signUperror = document.getElementById('handleError')

if (signUperror) {
  if(signUperror.innerHTML != ""){
  var clicker = function(){
    document.getElementById('signup').click()
  }
  clicker()
  }
} 
```

* * *

## 回答 #12

> 赞同：-5
> 
> 时间：2009-05-23T23:35:10.953

你不能让用户的鼠标做任何事情。但是您可以完全控制事件触发时发生的情况。

你可以做的是点击身体负荷。W3Schools 这里有一个例子[。](http://www.w3schools.com/htmldom/met_button_click.asp)

# mysql - MySQL 替换数据库的每个表和列中的字符

> ID：902723
> 
> 赞同：0
> 
> 时间：2009-05-23T23:38:57.450
> 
> 标签：mysql, string, replace

我想替换特定数据库的每一列和每个表中的字符串。有没有办法做到这一点 ？

提前致谢 ：）

编辑：那是因为我在某些地方发现了 Gibberish，我需要几天时间才能一一修复

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-23T23:45:32.430

不是没有做一些编程。
最简单的方法是使用您喜欢的语言的 show/describe 命令并在结果集（列/表的名称）上运行，并从中创建要在您的数据库上运行的 UPDATE 查询列表。

你为什么不写它并开源它，你不是第一个寻找类似东西的人（或者谷歌它，可能有一个脚本准备好了）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-01-04T13:43:03.947

从另一个线程中找到了这个答案：

[http://www.anovasolutions.com/content/mysql-search-and-replace-stored-procedure](http://www.anovasolutions.com/content/mysql-search-and-replace-stored-procedure)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-16T22:21:01.480

当我们在 Wordpress 网站上更改域时，我自己也在寻找这个。没有一些编程就无法完成，所以这就是我所做的。

```
<?php  
  header("Content-Type: text/plain");

  $host = "localhost";
  $username = "root";
  $password = "";
  $database = "mydatabase";
  $string_to_replace  = 'old.example.com';
  $new_string = 'new.example.com';

  // Connect to database server
  mysql_connect($host, $username, $password);

  // Select database
  mysql_select_db($database);

  // List all tables in database
  $sql = "SHOW TABLES FROM ".$database;
  $tables_result = mysql_query($sql);

  if (!$tables_result) {
    echo "Database error, could not list tables\nMySQL error: " . mysql_error();
    exit;
  }

  echo "In these fields '$string_to_replace' have been replaced with '$new_string'\n\n";
  while ($table = mysql_fetch_row($tables_result)) {
    echo "Table: {$table[0]}\n";
    $fields_result = mysql_query("SHOW COLUMNS FROM ".$table[0]);
    if (!$fields_result) {
      echo 'Could not run query: ' . mysql_error();
      exit;
    }
    if (mysql_num_rows($fields_result) > 0) {
      while ($field = mysql_fetch_assoc($fields_result)) {
        if (stripos($field['Type'], "VARCHAR") !== false || stripos($field['Type'], "TEXT") !== false) {
          echo "  ".$field['Field']."\n";
          $sql = "UPDATE ".$table[0]." SET ".$field['Field']." = replace(".$field['Field'].", '$string_to_replace', '$new_string')";
          mysql_query($sql);
        }
      }
      echo "\n";
    }
  }

  mysql_free_result($tables_result);  
?> 
```

希望它对将来遇到这个问题的人有所帮助:)

# drupal - Drupal 搜索模块直接链接到评论

> ID：902726
> 
> 赞同：0
> 
> 时间：2009-05-23T23:39:35.377
> 
> 标签：drupal, drupal-comments, drupal-search

在我的 drupal 搜索结果页面上，除了帖子本身之外，还直接链接到帖子的评论。查看 search.module 文件，相关代码似乎是。

```
$output = ' <dt class="title"><a href="'. check_url($item['link']) .'">'. check_plain($item['title']) .'</a></dt>'; 
```

问题是我无法弄清楚 $item['link'] 究竟是从哪里来的，或者如何获取那里的评论的链接变量。你能提供的任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-31T05:02:29.380

除了直接链接到节点本身之外，您还想链接到评论吗？那不是那么难...

对于同一页面，您需要将输出更改为：

```
$output = ' <dt class="title"><a href="'. check_url($item['link']) .'">'. check_plain($item['title']) .'</a></dt><dd><a href="'. check_url($item['link']) .'#comments">'. check_plain($item['title']) .'</a></dd>; 
```

当然，您会想稍微弄乱主题。

# search - 没有搜索结果

> ID：902732
> 
> 赞同：0
> 
> 时间：2009-05-23T23:45:37.017
> 
> 标签：search, drupal, solr

我在 drupal 5 上安装了 apache solr，现在当我使用 Admin 执行搜索时，我得到了结果，但我没有从 Drupal 得到任何结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-07-11T09:29:38.187

您可能有权限问题。由于您可以从管理员访问搜索结果，因此搜索引擎和 -indexing 正在运行。Drupal 管理员搜索返回所有条目，无论其状态（已发布、未发布、草稿）或访问权限（存在多种内容访问模块）。

首先，验证节点是否在您的站点上作为“普通”用户实际可见：匿名或登录。如果是这样，则不存在访问问题并且节点已发布。其次，验证您没有访问模块，例如有机组或域运行：可能配置稍有错误，或以奇怪的方式使用，并在某些条件下禁用对内容的访问。第三，确认您没有运行任何与搜索相关的模块。也许您安装了一个“增强”或“覆盖”搜索的模块？这样的模块不会改变 admin-search 的行为，但会改变在搜索结果中看到的内容。

如果这些都不适用，请发布更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-13T13:32:05.853

我会仔细检查 Drupal 是否有权在数据库中创建临时表。如果没有，您在搜索时总是会得到“未找到结果”。

# windows - SVN 服务器在家庭网络中的 Windows Vista 上运行，从 Mac OS X 访问

> ID：902744
> 
> 赞同：0
> 
> 时间：2009-05-24T00:00:17.237
> 
> 标签：windows, svn, macos, networking

我在我的家庭网络上的主 Windows 开发框中运行了 SVN。根据我在做什么，我从各种开发笔记本电脑访问服务器。我也使用 Mac OS X 开发笔记本电脑执行此操作，但显然我必须使用 SVN 服务器的 IP 地址。

这会导致问题，因为 SVN 服务器的 IP 地址发生了变化。在我的 Windows 机器上，我可以通过服务器名称访问 SVN。

我可以从我的 Mac 上做这样的事情吗？或者也许是一些配置，所以我可以“配置”我的 mac 来命名一个 IP 地址？（也许是主机文件？）

谢谢你们！

问候，
弗兰克

**更新：我使用**[ZigVersion](http://zigversion.com/)在我的 Mac 上访问我的 SVN 存储库。我使用如下 URL：[http://Frank@192.168.1.7/svn/RepositoryName/](http://Frank@192.168.1.7/svn/RepositoryName/)

**更新 2**：虽然克里斯给出了一个很好的答案（我理解），但我希望有一些更优雅的东西。如果您认为这是最好的方法，请投票参与。我正在寻找其他想法，以及关于如何实现这一点的社区意见。

另外，如果可以在[ServerFault](https://serverfault.com/)上发布此内容，请告诉我如何操作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-24T03:08:34.690

我将路由器设置为为我的服务器提供相同的 IP，这样我就不会遇到这个问题。如果我是你，我会通过 Windows 或路由器设置一个静态 IP。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-24T00:04:07.277

听起来您的 Windows 机器正在使用特定于 Windows 的方法来广播其 NetBIOS 名称。OS X 系统正在尝试查找 DNS 名称。您的 DNS 系统应该被修复以允许 DHCP 服务器分配主机名。

# c++ - 何时使用 goto 而不是控制结构嵌套？

> ID：902747
> 
> 赞同：0
> 
> 时间：2009-05-24T00:01:23.180
> 
> 标签：c++, c

> **可能的重复：**
> [在 C 中有效地使用 goto 进行错误管理？](https://stackoverflow.com/questions/788903/valid-use-of-goto-for-error-management-in-c)
> [C 或 C++](https://stackoverflow.com/questions/245742/examples-of-good-gotos-in-c-or-c)
> [GOTO 中好的 goto 示例仍然被认为是有害的吗？](https://stackoverflow.com/questions/46586/goto-still-considered-harmful)
> [使用 GOTO 还是不使用？](https://stackoverflow.com/questions/379172/to-use-goto-or-not)

goto 语句使用起来似乎非常冒险。什么时候使用 goto 语句而不是嵌套控制语句是一个好的场景？它甚至是控制程序流的首选方式吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-24T00:11:35.997

GoTo 仅适用于 VB6 中的错误处理，当您在汇编程序或 Pic 中编程时。在高级编程中，这被认为是一种不好的做法，因为“破坏”了程序控制流并且还使代码更难阅读。

# python - 将 Numpy 数组保存为图像

> ID：902761
> 
> 赞同：358
> 
> 时间：2009-05-24T00:08:50.683
> 
> 标签：python, image, numpy

我有一个 Numpy 数组类型的矩阵。我如何将它作为图像写入磁盘？任何格式都有效（png、jpeg、bmp...）。一个重要的限制是不存在 PIL。

* * *

## 回答 #1

> 赞同：363
> 
> 时间：2011-12-16T18:21:39.423

使用[PIL](http://www.pythonware.com/products/pil/)的答案（以防万一它有用）。

给定一个 numpy 数组“A”：

```
from PIL import Image
im = Image.fromarray(A)
im.save("your_file.jpeg") 
```

您可以用几乎任何您想要的格式替换“jpeg”。有关格式的更多详细信息，请[点击此处](http://www.pythonware.com/library/pil/handbook/index.htm)

* * *

## 回答 #2

> 赞同：273
> 
> 时间：2009-11-11T04:53:29.880

这使用了 PIL，但也许有些人会觉得它很有用：

```
import scipy.misc
scipy.misc.imsave('outfile.jpg', image_array) 
```

**编辑**：当前`scipy`版本开始对所有图像进行规范化，以便 min(data) 变为黑色，max(data) 变为白色。如果数据应该是精确的灰度级或精确的 RGB 通道，则这是不需要的。解决方案：

```
import scipy.misc
scipy.misc.toimage(image_array, cmin=0.0, cmax=...).save('outfile.jpg') 
```

* * *

## 回答 #3

> 赞同：113
> 
> 时间：2014-04-02T21:51:28.380

与`matplotlib`：

```
import matplotlib

matplotlib.image.imsave('name.png', array) 
```

适用于 matplotlib 1.3.1，我不知道低版本。从文档字符串：

```
Arguments:
  *fname*:
    A string containing a path to a filename, or a Python file-like object.
    If *format* is *None* and *fname* is a string, the output
    format is deduced from the extension of the filename.
  *arr*:
    An MxN (luminance), MxNx3 (RGB) or MxNx4 (RGBA) array. 
```

[![在此处输入图像描述](https://i.stack.imgur.com/J1pnL.png)](https://i.stack.imgur.com/J1pnL.png)

* * *

## 回答 #4

> 赞同：78
> 
> 时间：2014-11-24T23:10:45.907

有`opencv`python（[文档here](https://docs.opencv.org/4.0.1/d4/da8/group__imgcodecs.html#gabbc7ef1aa2edfaa87772f1202d67e0ce)）。

```
import cv2
import numpy as np

img = ... # Your image as a numpy array 

cv2.imwrite("filename.png", img) 
```

如果您需要进行除保存以外的更多处理，这很有用。

* * *

## 回答 #5

> 赞同：71
> 
> 时间：2013-10-04T06:33:01.610

纯 Python (2 & 3)，一个没有 3rd 方依赖的片段。

此函数写入压缩的真彩色（每像素 4 个字节）`RGBA`PNG。

```
def write_png(buf, width, height):
    """ buf: must be bytes or a bytearray in Python3.x,
        a regular string in Python2.x.
    """
    import zlib, struct

    # reverse the vertical line order and add null bytes at the start
    width_byte_4 = width * 4
    raw_data = b''.join(
        b'\x00' + buf[span:span + width_byte_4]
        for span in range((height - 1) * width_byte_4, -1, - width_byte_4)
    )

    def png_pack(png_tag, data):
        chunk_head = png_tag + data
        return (struct.pack("!I", len(data)) +
                chunk_head +
                struct.pack("!I", 0xFFFFFFFF & zlib.crc32(chunk_head)))

    return b''.join([
        b'\x89PNG\r\n\x1a\n',
        png_pack(b'IHDR', struct.pack("!2I5B", width, height, 8, 6, 0, 0, 0)),
        png_pack(b'IDAT', zlib.compress(raw_data, 9)),
        png_pack(b'IEND', b'')]) 
```

...数据应直接写入以二进制形式打开的文件，如下所示：

```
data = write_png(buf, 64, 64)
with open("my_image.png", 'wb') as fh:
    fh.write(data) 
```

* * *

*   [原始来源](https://developer.blender.org/diffusion/B/browse/master/release/bin/blender-thumbnailer.py$155)
*   另请参阅：[此问题中的 Rust Port。](https://stackoverflow.com/a/38956995/432509)
*   感谢@Evgeni Sergeev 的示例用法：[https ://stackoverflow.com/a/21034111/432509](https://stackoverflow.com/a/21034111/432509)

* * *

## 回答 #6

> 赞同：65
> 
> 时间：2009-05-24T00:26:05.093

您可以使用[PyPNG](https://github.com/drj11/pypng/)。它是一个纯 Python（无依赖项）开源 PNG 编码器/解码器，它[支持](https://pypng.readthedocs.io/en/latest/ex.html#numpy)将 NumPy 数组编写为图像。

* * *

## 回答 #7

> 赞同：32
> 
> 时间：2009-06-10T17:29:37.580

如果你有 matplotlib，你可以这样做：

```
import matplotlib.pyplot as plt
plt.imshow(matrix) #Needs to be in row,col order
plt.savefig(filename) 
```

这将保存绘图（而不是图像本身）。 [![在此处输入图像描述](https://i.stack.imgur.com/khOOb.jpg)](https://i.stack.imgur.com/khOOb.jpg)

* * *

## 回答 #8

> 赞同：24
> 
> 时间：2020-06-14T04:17:36.280

要将 numpy 数组保存为图像，U 有几种选择：

1）最好的：OpenCV

> ```
>  import cv2   
>  cv2.imwrite('file name with extension(like .jpg)', numpy_array) 
> ```

2) Matplotlib

> ```
>  from matplotlib import pyplot as plt
>   plt.imsave('file name with extension(like .jpg)', numpy_array) 
> ```

3) 太平

> ```
>  from PIL import Image
>   image = Image.fromarray(numpy_array)
>   image.save('file name with extension(like .jpg)') 
> ```

4) ...

* * *

## 回答 #9

> 赞同：19
> 
> 时间：2018-08-25T09:38:46.030

`scipy.misc`给出关于函数的弃用警告`imsave`并建议使用 of `imageio`。

```
import imageio
imageio.imwrite('image_name.png', img) 
```

* * *

## 回答 #10

> 赞同：18
> 
> 时间：2018-03-11T14:02:48.347

您可以在 Python 中使用“skimage”库

例子：

```
from skimage.io import imsave
imsave('Path_to_your_folder/File_name.jpg',your_array) 
```

* * *

## 回答 #11

> 赞同：13
> 
> 时间：2014-01-10T00:33:20.280

@ideasman42 答案的附录：

```
def saveAsPNG(array, filename):
    import struct
    if any([len(row) != len(array[0]) for row in array]):
        raise ValueError, "Array should have elements of equal size"

                                #First row becomes top row of image.
    flat = []; map(flat.extend, reversed(array))
                                 #Big-endian, unsigned 32-byte integer.
    buf = b''.join([struct.pack('>I', ((0xffFFff & i32)<<8)|(i32>>24) )
                    for i32 in flat])   #Rotate from ARGB to RGBA.

    data = write_png(buf, len(array[0]), len(array))
    f = open(filename, 'wb')
    f.write(data)
    f.close() 
```

所以你可以这样做：

```
saveAsPNG([[0xffFF0000, 0xffFFFF00],
           [0xff00aa77, 0xff333333]], 'test_grid.png') 
```

生产`test_grid.png`：

![红色、黄色、深水蓝色、灰色的网格](https://i.stack.imgur.com/5eWSa.png)

（透明度也可以通过减少 . 的高字节来实现`0xff`。）

* * *

## 回答 #12

> 赞同：11
> 
> 时间：2018-12-27T03:27:14.087

对于那些寻找直接完整工作示例的人：

```
from PIL import Image
import numpy

w,h = 200,100
img = numpy.zeros((h,w,3),dtype=numpy.uint8) # has to be unsigned bytes

img[:] = (0,0,255) # fill blue

x,y = 40,20
img[y:y+30, x:x+50] = (255,0,0) # 50x30 red box

Image.fromarray(img).convert("RGB").save("art.png") # don't need to convert 
```

另外，如果您想要高质量的 jpeg
`.save(file, subsampling=0, quality=100)`

* * *

## 回答 #13

> 赞同：6
> 
> 时间：2009-06-10T21:43:06.447

matplotlib svn 有一个新功能，可以将图像保存为图像 - 没有轴等。如果您不想安装 svn（直接从 matplotlib svn 中的 image.py 复制，删除了为简洁起见的文档字符串）：

```
def imsave(fname, arr, vmin=None, vmax=None, cmap=None, format=None, origin=None):
    from matplotlib.backends.backend_agg import FigureCanvasAgg as FigureCanvas
    from matplotlib.figure import Figure

    fig = Figure(figsize=arr.shape[::-1], dpi=1, frameon=False)
    canvas = FigureCanvas(fig)
    fig.figimage(arr, cmap=cmap, vmin=vmin, vmax=vmax, origin=origin)
    fig.savefig(fname, dpi=1, format=format) 
```

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2019-01-12T09:32:34.977

[Imageio](https://imageio.github.io/)是一个 Python 库，它提供了一个简单的界面来读取和写入各种图像数据，包括动画图像、视频、体积数据和科学格式。它是跨平台的，在 Python 2.7 和 3.4+ 上运行，并且易于安装。

这是灰度图像的示例：

```
import numpy as np
import imageio

# data is numpy array with grayscale value for each pixel.
data = np.array([70,80,82,72,58,58,60,63,54,58,60,48,89,115,121,119])

# 16 pixels can be converted into square of 4x4 or 2x8 or 8x2
data = data.reshape((4, 4)).astype('uint8')

# save image
imageio.imwrite('pic.jpg', data) 
```

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2015-09-29T20:56:04.150

世界可能不需要另一个包来将 numpy 数组写入 PNG 文件，但对于那些无法获得足够的人，我最近`numpngw`在 github 上提出：

[https://github.com/WarrenWeckesser/numpngw](https://github.com/WarrenWeckesser/numpngw)

在 pypi 上：[https ://pypi.python.org/pypi/numpngw/](https://pypi.python.org/pypi/numpngw/)

唯一的外部依赖是 numpy。

`examples`这是存储库目录中的第一个示例。基本线很简单

```
write_png('example1.png', img) 
```

哪里`img`是一个 numpy 数组。该行之前的所有代码都是导入语句和要创建的代码`img`。

```
import numpy as np
from numpngw import write_png

# Example 1
#
# Create an 8-bit RGB image.

img = np.zeros((80, 128, 3), dtype=np.uint8)

grad = np.linspace(0, 255, img.shape[1])

img[:16, :, :] = 127
img[16:32, :, 0] = grad
img[32:48, :, 1] = grad[::-1]
img[48:64, :, 2] = grad
img[64:, :, :] = 127

write_png('example1.png', img) 
```

这是它创建的PNG文件：

[![例子1.png](https://i.stack.imgur.com/fykhB.png)](https://i.stack.imgur.com/fykhB.png)

另外，我曾经[在曼哈顿度量](https://stackoverflow.com/questions/67950324/voronoi-diagram-in-manhattan-metric/69650264#69650264)`numpngw.write_apng`的 Voronoi 图中创建动画。

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2017-05-02T08:05:05.113

假设您想要灰度图像：

```
im = Image.new('L', (width, height))
im.putdata(an_array.flatten().tolist())
im.save("image.tiff") 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2014-08-19T06:46:08.333

如果您碰巧已经使用 [Py]Qt，您可能会对[qimage2ndarray](http://hmeine.github.io/qimage2ndarray/)感兴趣。从 1.4 版（刚刚发布）开始，也支持 PySide，并且会有一个`imsave(filename, array)`类似于 scipy 的小功能，但使用 Qt 而不是 PIL。在 1.3 中，只需使用如下内容：

```
qImage = array2qimage(image, normalize = False) # create QImage from ndarray
success = qImage.save(filename) # use Qt's image IO functions for saving PNG/JPG/.. 
```

（1.4 的另一个优点是它是一个纯 python 解决方案，这使得它更加轻量级。）

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2018-07-02T07:05:54.073

如果您在 python 环境 Spyder 中工作，那么只需右键单击变量资源管理器中的数组，然后选择“显示图像”选项，再简单不过了。

[![在此处输入图像描述](https://i.stack.imgur.com/zxhdl.png)](https://i.stack.imgur.com/zxhdl.png)

这将要求您将图像保存到 dsik，主要是 PNG 格式。

在这种情况下将不需要 PIL 库。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2018-10-08T07:17:57.133

使用`cv2.imwrite`.

```
import cv2
assert mat.shape[2] == 1 or mat.shape[2] == 3, 'the third dim should be channel'
cv2.imwrite(path, mat) # note the form of data should be height - width - channel 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2020-10-28T08:50:30.390

使用 pygame

所以这应该像我测试的那样工作（如果你没有 pygame，你必须安装 pygame 使用 pip -> pip install pygame 安装它（有时不起作用，所以在这种情况下你将不得不下载轮子或某事但是你可以在谷歌上查找））：

```
import pygame

pygame.init()
win = pygame.display.set_mode((128, 128))
pygame.surfarray.blit_array(win, yourarray)
pygame.display.update()
pygame.image.save(win, 'yourfilename.png') 
```

只要记住根据您的数组更改显示宽度和高度

这是一个示例，运行以下代码：

```
import pygame
from numpy import zeros

pygame.init()
win = pygame.display.set_mode((128, 128))
striped = zeros((128, 128, 3))
striped[:] = (255, 0, 0)
striped[:, ::3] = (0, 255, 255)
pygame.surfarray.blit_array(win, striped)
pygame.display.update()
pygame.image.save(win, 'yourfilename.png') 
```

# c# - C# - 俄罗斯方块克隆 - 无法正确响应箭头组合键

> ID：902767
> 
> 赞同：5
> 
> 时间：2009-05-24T00:14:59.657
> 
> 标签：c#, keydown, arrow-keys

我正在用 Visual C# 2005 编写俄罗斯方块游戏。这是我设计的最广泛的程序。

我创建了一个形状类和一个块类来控制不同俄罗斯方块的位置、移动和显示。我对每个形状都有 moveDown()、moveLeft() 和 moveRight() 函数（以及相应的 canMoveDown()、canMoveLeft()、canMoveRight() 布尔函数来验证可以移动）。这一切都很好。

我想使用向下、向右和向左箭头键让用户移动块，除了使用计时器让形状每隔这么多毫秒自动下降一行。

我正在使用 KeyDown 事件处理程序来检查用户何时按下向下、向左和向右箭头键。这并不难。问题是我想允许对角线运动，并且我希望它尽可能顺利地工作。我尝试了很多不同的方法来解决这个问题，并取得了不同程度的成功。但我不能完全正确...

我最成功的方法是使用三个布尔变量来跟踪何时按下向下、向左和向右箭头键。我会在 KeyDown 事件中将布尔值设置为 true，在 KeyUp 事件中将布尔值设置为 false。在 KeyDown 事件中，我还会告诉块如何移动，使用布尔变量来检查当前正在按下哪个组合。它工作得非常好，除了一件事。

如果我按住其中一个箭头键并按住，然后按下第二个箭头键，然后释放第二个键，则块将完全停止移动，而不是继续朝尚未释放的第一个箭头键的方向移动然而。我认为这是因为第二个键触发了 KeyDown 事件，并且在其释放后 KeyUp 事件被触发，并且 KeyDown 事件完全停止触发，即使第一个键被触发。

我终其一生都无法为这个问题找到满意的解决方案。

任何帮助将不胜感激 =)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-24T02:45:37.467

大多数游戏不等待事件。他们在必要时轮询输入设备并采取相应措施。事实上，如果你看过 XNA，你会发现有一个 Keyboard.GetState() 方法（或 Gamepad.GetState()），你会在你的更新例程中调用它，并根据它更新你的游戏逻辑结果。使用 Windows.Forms 时，没有任何开箱即用的方法可以执行此操作，但是您可以 P/Invoke GetKeyBoardState() 函数来利用此功能。这样做的好处是，您可以一次轮询多个键，因此您可以一次对多个按键做出反应。这是我在网上找到的一个简单的类，可以帮助解决这个问题：

[http://sanity-free.org/17/obtaining_key_state_info_in_dotnet_csharp_getkeystate_implementation.html](http://sanity-free.org/17/obtaining_key_state_info_in_dotnet_csharp_getkeystate_implementation.html)

为了演示，我编写了一个简单的 Windows 应用程序，它基本上根据键盘输入移动一个球。它使用我链接到的类来轮询键盘的状态。您会注意到，如果一次按住两个键，它会沿对角线移动。

首先，Ball.cs：

```
 public class Ball
    {
        private Brush brush;

        public float X { get; set; }
        public float Y { get; set; }
        public float DX { get; set; }
        public float DY { get; set; }
        public Color Color { get; set; }
        public float Size { get; set; }

        public void Draw(Graphics g)
        {
            if (this.brush == null)
            {
                this.brush = new SolidBrush(this.Color);
            }
            g.FillEllipse(this.brush, X, Y, Size, Size);
        }

        public void MoveRight()
        {
            this.X += DX;
        }

        public void MoveLeft()
        {
            this.X -= this.DX;
        }

        public void MoveUp()
        {
            this.Y -= this.DY;
        }

        public void MoveDown()
        {
            this.Y += this.DY;
        }
    } 
```

真的没有什么花哨的......

然后是 Form1 代码：

```
 public partial class Form1 : Form
    {
        private Ball ball;
        private Timer timer;
        public Form1()
        {
            InitializeComponent();
            this.ball = new Ball
            {
                X = 10f,
                Y = 10f,
                DX = 2f,
                DY = 2f,
                Color = Color.Red,
                Size = 10f
            };
            this.timer = new Timer();
            timer.Interval = 20;
            timer.Tick += new EventHandler(timer_Tick);
            timer.Start();
        }

        void timer_Tick(object sender, EventArgs e)
        {
            var left = KeyboardInfo.GetKeyState(Keys.Left);
            var right = KeyboardInfo.GetKeyState(Keys.Right);
            var up = KeyboardInfo.GetKeyState(Keys.Up);
            var down = KeyboardInfo.GetKeyState(Keys.Down);

            if (left.IsPressed)
            {
                ball.MoveLeft();
                this.Invalidate();
            }

            if (right.IsPressed)
            {
                ball.MoveRight();
                this.Invalidate();
            }

            if (up.IsPressed)
            {
                ball.MoveUp();
                this.Invalidate();
            }

            if (down.IsPressed)
            {
                ball.MoveDown();
                this.Invalidate();
            }

        }

        protected override void OnPaint(PaintEventArgs e)
        {
            base.OnPaint(e);
            if (this.ball != null)
            {
                this.ball.Draw(e.Graphics);
            }
        }
    } 
```

简单的小应用程序。只需创建一个球和一个计时器。每 20 毫秒，它检查一次键盘状态，如果按下一个键，它会移动它并使其无效，以便它可以重新绘制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-24T02:44:21.353

如果您依靠按键重复来重复发送按键事件以使块移动，我认为这不是您想要的方式。该块应始终独立于键重复移动。因此，您不应该在关键事件期间移动块。您应该只在 keydown 和 keyup 事件期间跟踪键的状态，并在其他地方处理移动。实际的移动应该发生在某种计时器事件中（即使没有发生任何事情，计时器控件也会定期触发事件），或者您应该有一个主循环不断检查一切的状态并在适当的时候移动对象。如果您使用第二个选项，您将需要查看“DoEvents”，因为如果您的代码一直在运行而没有完成功能，程序不会处理任何其他事件，例如 keyup 和 keydown 事件。因此，您可能希望在每个循环中调用 DoEvents 来处理关键事件（以及移动窗口等其他事情）。如果您不需要如此频繁地处理事情，您可能还想调用 System.Threading.Thread.Sleep。如果您使用计时器控件，则不必担心这些。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-24T00:28:54.323

抱歉，没有具体的帮助……毕竟是星期六晚上……但是：

每个键都需要一个状态。当您收到 keydown 事件时，您可以判断哪个键已关闭，并修改您正在维护的 keystate。当钥匙再次出现时，通过查看事件，您可以分辨出它是哪一个。仅修改触发事件的键的状态：即不要使用 keyup 事件重置所有状态，否则您在内存中持有的键的状态将被破坏，如您所见。

# c# - 如何对硬件性能计数器进行编程

> ID：902769
> 
> 赞同：2
> 
> 时间：2009-05-24T00:16:54.410
> 
> 标签：c#, c++, wmi, performancecounter, server-hardware

我一直在为我的论文处理这个问题。目标是开发一个专门用于 Windows 2K8 服务器的 .net 服务器监控工具。到目前为止，我只能访问软件性能计数器。意思是那些通过 perfmon 和 WMI 类可用的。

但是还有一个问题是我需要能够监视诸如发生的 TLB 未命中的数量或当前的内存带宽之类的事情。这就是我被卡住的地方......由于没有标准的.net方法来获取这些计数器，我一直在阅读来自Oprofile等开源程序的一些代码。但是由于我不知道我到底在寻找什么，所以在这方面没有取得太大进展。

所以我谦虚地问这里是否有人，他对这种事情有任何经验，可以帮助我一点。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-24T00:56:19.993

用于读取性能计数器的最广泛使用的库是[性能 API (PAPI)](http://icl.cs.utk.edu/papi/)。PAPI 实际上是两个 API（[高级](http://icl.cs.utk.edu/projects/papi/files/documentation/PAPI_USER_GUIDE_23.htm#HIGH_LEVEL_API)和[低级](http://icl.cs.utk.edu/projects/papi/files/documentation/PAPI_USER_GUIDE_23.htm#LOW_LEVEL_API)）。我倾向于使用低级别的，因为我发现它更直观，但这可能只是我。

PAPI 中有两种类型的事件。 [预设事件](http://icl.cs.utk.edu/projects/papi/files/html_man3/papi_presets.html)应该与平台无关，尽管它们可能会根据内部计算方式的不同而略有不同。它们确实包括 TLB 未命中和内存停顿，所以也许你可以从那里开始。如果这不符合您的需要，您可能需要查看本地事件，这些事件特定于您的特定硬件，通常包括硬件可以计算的每个事件。用于`papi_native_aval`获取这些列表。

PAPI 支持 Windows，但我实际上从未尝试过。我在专门提到 Windows 2008 的文档/自述文件中找不到任何内容，但至少也许您可以查看源代码以了解如何访问所需的计数器，即使您无法直接访问它们。

如果您需要更多，那么不妨看看[perfmon2](http://perfmon2.sourceforge.net/)，如果有的话，新版本的 PAPI 在 Linux 上使用它。

# ruby-on-rails - 如何在 linux 中轻松接收邮件并将其提供给 Rails？

> ID：902771
> 
> 赞同：7
> 
> 时间：2009-05-24T00:17:53.333
> 
> 标签：ruby-on-rails, email, postfix-mta, mail-server

我整晚都在谷歌搜索 postfix howto，但我仍然不知道**如何在 linux-server 上接收电子邮件**（更具体 - Ubuntu）。

我所需要的只是一个包罗万象的邮箱，它可以获取所有电子邮件并将它们提供给 ruby​​ 脚本（当然，然后将其传递给 Rails）。不久前我能够设置用于发送电子邮件的后缀，我不得不说 - 这一点都不痛苦，除了实际安装它之外，我几乎什么也没做。

您能否提出一个好的方法、食谱或替代的易于设置的邮件服务器来解决这个问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-24T00:50:51.050

选择您希望接收转发到您的 Ruby 脚本的邮件的帐户。编辑该 `.forward`脚本主目录中的文件以读取

```
"|/path/to/my/ruby/script" 
```

当 postfix 向账户投递邮件时，它会以指定用户的权限运行脚本，并在标准输入上提供邮件。根据您对邮件所做的操作，您可能希望以某种方式对其进行身份验证，以便脚本知道它确实来自您。（例如，带有盐的标头和盐+密码的SHA1哈希。）

这是我自己的邮件系统中的一个真实示例：

```
"|/home/nr/bin/filtermail /home/nr/machine/x86-bsd/bin/luapipe /home/nr/machine/x86-bsd/bin/safe-slocal 2>>/home/nr/slocal.log 1>&2" 
```

这将转到一个 shell 脚本，然后调用 Lua 和 C 程序来正确处理邮件。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-24T01:21:36.603

这个答案有两个部分，Norman Ramsey 的答案涵盖了第二部分：将电子邮件交给要处理的脚本。第一部分是配置 Postfix 以接收电子邮件。既然你需要一个包罗万象的东西，你可以把这样的东西放在 /etc/postfix/aliases

```
@yourdomain.com localuser 
```

'localuser' 是您系统上的帐户名称，它有一个

/home/localuser/.forward

其中包含命令（参见诺曼的回应）。或者，您可以将其全部保存在 Postfix 中

/etc/postfix/别名：

@yourdomain.com |/path/to/your/script

这将发送所有发送到@yourdomain.com 的电子邮件并将其发送到您的脚本进行处理。请记住，脚本将以 postfix 用户身份执行，因此您需要确保您的环境设置正确（例如，您不依赖于普通用户帐户所具有的特定 $PATH）。postfix 用户可能有一个非常基本的环境（例如，他们的 $PATH 中甚至可能没有 /usr/local/bin）

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-12-11T22:47:53.570

另请查看 Jason Seifer 的文章了解更多详细信息。

[http://jasonseifer.com/2009/04/24/receving-email-with-rails](http://jasonseifer.com/2009/04/24/receving-email-with-rails)

# html - 更改表单按钮的外观

> ID：902777
> 
> 赞同：4
> 
> 时间：2009-05-24T00:28:36.337
> 
> 标签：html, ruby-on-rails, css

有了这点 CSS，我的表单按钮现在看起来是扁平的（2D），我非常喜欢这样的外观：

```
input {
  border: 1px solid #999;
} 
```

但是，对于文件字段（选择要上传的文件），按钮仍然是 3D。然后边框围绕该按钮及其旁边的文本。

我尝试通过将输入重命名为 .input 来解决此问题，然后仅将其应用于我的提交/取消按钮，但现在它们看起来像文件字段的外观。那么我该如何解决这个问题，让它们看起来都是扁平的/二维的呢？

另外，有没有办法将这些表单按钮创建为普通链接？我很喜欢他们的样子。我在 Rails 中编程，所以如果你可以发布辅助函数，如果它可用的话，那就太好了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-24T00:31:39.373

这篇[文章](http://www.quirksmode.org/dom/inputfile.html)解释了设置文件输入按钮样式的好技巧

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-24T01:33:15.740

[http://extjs.com/forum/showthread.php?t=29032](http://extjs.com/forum/showthread.php?t=29032)
这个线程使用 ExtJS 库来创建一个可以设置样式的输入按钮。我不一定会仅仅因为这个原因而使用 ExtJS，但是如果你真的想花哨地看一下他的文件按钮的代码。不是将文件按钮放置在图像顶部并对其进行调整，直到它运行良好，这段 Javascript 实际上将按钮置于鼠标所在的任何位置。允许您创建各种形状和大小的极其精美的按钮。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-05-24T00:34:07.573

要将提交按钮创建为普通文本链接，您可以使用 Javascript 将 onclick 事件附加到单个单词，而不是使用提交按钮。

# c++ - 有没有办法在标准 C++ 中直接从键盘读取输入？

> ID：902780
> 
> 赞同：2
> 
> 时间：2009-05-24T00:31:18.377
> 
> 标签：c++, input, console, keyboard

我知道有`std::cin`，但这需要用户输入一个字符串，然后按 ENTER。有没有一种方法可以简单地获取按下的下一个键而无需按 ENTER 确认

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-24T00:41:12.630

您要查找的内容与操作控制台有关，并且与操作系统相关。如果您使用的是基于 UNIX 的操作系统，请查看[curses 库](http://en.wikipedia.org/wiki/Curses_(programming_library))，在 Windows中`getch()`，有`kbhit()`.`<conio.h>`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-05-23T16:41:47.220

看起来[最受欢迎的答案](https://stackoverflow.com/a/902792/1413395)有点过时了。

[ncurses](https://en.wikipedia.org/wiki/Ncurses)库（基于上面提到的curses[库](https://en.wikipedia.org/wiki/Curses_(programming_library)#ncurses)）是一个可移植的实现，可用于基于 unix 和 linux 的操作系统、windows 和其他系统。

它支持多种终端接口。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-24T00:43:16.387

您可以使用

```
#include <conio.h> 
```

然后用这种情况捕获 char

```
char c;
if (_kbhit())
{
  c = getch();
  switch(c)
  {
  case ‘\0H’ :
  cout << "up arrow key!" << endl;
  break;
  }
} 
```

**当心**：我还没有尝试过......并且记得将整个事情放入“while（true）”中进行测试。

# asp.net-mvc - ASP.NET MVC：在表单提交时添加到查询字符串

> ID：902782
> 
> 赞同：1
> 
> 时间：2009-05-24T00:31:54.613
> 
> 标签：asp.net-mvc, asp.net-mvc-routing

我在 ASP.NET MVC 中构建一个网格，我有以下问题：

*   在网格上方，我有一个列选择器，可以让人们自定义显示的列。这是一个带有提交按钮的表单，因此人们可以一次添加/删除多个列，而无需经过多次回发。
*   在网格下方我有分页。这是通过动作链接（a href's）进行分页。

[替代文字 http://thomasstock.net/mvcget.jpg](http://thomasstock.net/mvcget.jpg)

当用户添加/删除列时会发生什么情况是表单被提交到[http://localhost:56156/?columnsToDisplay=EmployeeId](http://localhost:56156/?columnsToDisplay=EmployeeId)并且网格当然会跳回第 1 页。我想将网格保留在页面上用户当前处于开启状态。**所以我需要一种将当前查询字符串参数包含到表单的 action 属性中的方法。**

反过来也一样：我需要一种方法来对动作链接做同样的事情。但这不太必要，因为我总是可以用按钮替换 a href 并将它们放在一个表单中。但我宁愿不那样做。

**我正在寻找没有 javascript 的解决方案！**我可以自己用 javascript 来做，但我希望我的网格能在禁用 javascript 的浏览器上完美运行。

任何帮助表示赞赏。

编辑：哦，是的，为了让它更难一点，我也在寻找一个没有 cookie/会话变量的解决方案。:-)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-24T00:42:11.880

您需要将下面的行添加到列选择器表单中

```
<input type="hidden" name="page" value="<%=Request.QueryString["page"]%>" /> 
```

# c# - 如何获取一天的开始和结束时间

> ID：902789
> 
> 赞同：75
> 
> 时间：2009-05-24T00:39:24.897
> 
> 标签：c#, datetime

在我的 C# 应用程序中，我传递了一个格式为 yyyymmdd-yyyymmdd 的字符串变量，它表示从和到日期。我想分别获取这些日期的开始时间和结束时间。目前我有以下代码，但想知道是否有更多优雅的解决方案？

所以对于 pdr = 20090521-20090523 将得到“20090521 00:00:00”和“20090523 23:59:59”

```
private void ValidateDatePeriod(string pdr, out DateTime startDate, 
                                out DateTime endDate)
{
    string[] dates = pdr.Split('-');

    if (dates.Length != 2)
    {
        throw new Exception("Date period is of incorrect format");
    }

    if (dates[0].Length != 8 || dates[1].Length != 8)
    {
        throw new Exception("Split date periods are of incorrect format");
    }

    startDate = DateTime.ParseExact(dates[0] + " 00:00:00", 
        "yyyyMMdd HH:mm:ss", null);
    endDate = DateTime.ParseExact(dates[1] + "23:59:59", 
        "yyyyMMdd HH::mm:ss", null);
} 
```

* * *

## 回答 #1

> 赞同：227
> 
> 时间：2013-12-13T11:42:07.373

我很惊讶地看到一个[***不正确的答案***](https://stackoverflow.com/a/903365/437979)如何获得如此多的赞成票：

![错误的值](https://i.stack.imgur.com/8fzzp.png)

正确的版本如下：

```
public static DateTime StartOfDay(this DateTime theDate)
{
    return theDate.Date;
}

public static DateTime EndOfDay(this DateTime theDate)
{
    return theDate.Date.AddDays(1).AddTicks(-1);
} 
```

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2009-05-24T08:51:14.837

您可以在某处定义两个扩展方法，在一个实用程序类中，如下所示：

```
public static DateTime EndOfDay(this DateTime date)
{
    return new DateTime(date.Year, date.Month, date.Day, 23, 59, 59, 999);
}

public static DateTime StartOfDay(this DateTime date)
{
    return new DateTime(date.Year, date.Month, date.Day, 0, 0, 0, 0);
} 
```

然后在代码中使用它们，如下所示：

```
public DoSomething()
{
    DateTime endOfThisDay = DateTime.Now.EndOfDay();
} 
```

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2009-05-24T02:29:02.117

如果您只担心 .Net 精度...

```
startDate = DateTime.ParseExact(dates[0], "yyyyMMdd");
endDate = DateTime.ParseExact(dates[1], "yyyyMMdd").AddTicks(-1).AddDays(1); 
```

您真的不需要将额外的值连接到时间部分的字符串上。

* * *

作为附录，如果您将其用于针对例如数据库的查询...

```
startDate = DateTime.ParseExact(dates[0], "yyyyMMdd");
endDate = DateTime.ParseExact(dates[1], "yyyyMMdd").AddDays(1); 
```

询问...

```
WHERE "startDate" >= @startDate AND "endDate" < @endDate 
```

那么评论中提到的精度问题就无关紧要了。在这种情况下，**endDate**不是范围的一部分，而是外部边界。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2019-04-23T12:37:53.803

```
public static class DateTimeExtension {        
    public static DateTime StartOfTheDay(this DateTime d) => new DateTime(d.Year, d.Month, d.Day, 0, 0,0);
    public static DateTime EndOfTheDay(this DateTime d) => new DateTime(d.Year, d.Month, d.Day, 23, 59,59);
} 
```

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2009-05-24T00:55:51.743

该`DateTime`对象有一个名为的属性`Date`，它将只返回日期部分。（时间部分默认为上午 12:00）。

我建议作为一个更优雅的解决方案（恕我直言），如果您想在最后一天允许任何日期时间，那么您将 1 天添加到日期，并比较以允许大于或等于开始日期的时间，但严格小于比结束日期（加上 1 天）。

```
// Calling code.  beginDateTime and endDateTime are already set.
// beginDateTime and endDateTime are inclusive.
// targetDateTime is the date you want to check.
beginDateTime = beginDateTime.Date;
endDateTime = endDateTime.Date.AddDays(1);

if ( beginDateTime <= targetDateTime &&
     targetDateTime < endDateTime )
   // Do something. 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2015-03-04T19:41:04.617

我在 C# 中使用以下内容

```
public static DateTime GetStartOfDay(DateTime dateTime)
{
    return new DateTime(dateTime.Year, dateTime.Month, dateTime.Day, 0, 0, 0, 0);
}
public static DateTime GetEndOfDay(DateTime dateTime)
{
    return new DateTime(dateTime.Year, dateTime.Month, dateTime.Day, 23, 59, 59, 999);
} 
```

然后在 MS SQL 中，我执行以下操作：

```
if datepart(ms, @dateEnd) = 0
   set @dateEnd = dateadd(ms, -3, @dateEnd) 
```

这将导致 MS SQL 时间为 23:59:59.997，这是成为第二天之前的最长时间。

你可以简单地使用：

```
new DateTime(dateTime.Year, dateTime.Month, dateTime.Day, 23, 59, 59, 999); 
```

这将在 MS SQL 中工作，但这在 .Net 方面并不准确。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-05-24T02:18:24.227

这几乎就是我会做的，稍加调整（真的没什么大不了的，只是吹毛求疵）：

*   应该使用 / 方法返回而`TryParse()`不是抛出异常。`TryParseExact()``false`
*   `FormatException`比更具体`Exception`
*   无需检查 Length == 8，因为`ParseExact()`/`TryParseExact()`会这样做
*   `"00:00:00"`并且`"23:59:59"`不需要
*   return `true`/`false`你是否能够解析，而不是抛出异常（记得检查从这个方法返回的值！）

代码：

```
private bool ValidateDatePeriod(string pdr, out DateTime startDate, 
                        out DateTime endDate)
{
   string[] dates = pdr.Split('-');

   if (dates.Length != 2)
   {
       return false;
   }

   // no need to check for Length == 8 because the following will do it anyway
   // no need for "00:00:00" or "23:59:59" either, I prefer AddDays(1)

   if(!DateTime.TryParseExact(dates[0], "yyyyMMdd", null, DateTimeStyles.None, out startDate))
      return false;

   if(!DateTime.TryParseExact(dates[1], "yyyyMMdd", null, DateTimeStyles.None, out endDate))
      return false;

   endDate = endDate.AddDays(1);
   return true;
} 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2014-03-27T15:55:19.893

我认为我们做错了。没有一天结束这样的事情。`AddTick(-1)`仅在没有小于刻度的时间间隔的约定下有效。这取决于实现。诚然，这个问题带有一个参考实现，即 .Net Framework`DateTime`类，但我们仍然应该以此为线索，我们真正想要的功能不是`EndOfDay()`但`StartOfNextDay()`

```
public static DateTime StartOfNextDay(this DateTime date)
{
    return date.Date.AddDays(1);
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-01-27T05:40:29.233

对于 SQL Server（经过 2008 R2 版测试），此范围有效。

StarDate '2016-01-11 00:00:01.990' EndDate '2016-01-19 23:59:59.990'

似乎滴答声大于一天的最后一秒，并自动舍入到第二天。所以我测试并工作，我制作了一个带有两个日期的虚拟表，用于检查 sql server 捕获哪些值并将这些参数插入到存储过程中。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-10-26T07:25:32.360

在 Java 8 中，您可以使用 LocalDate 执行此操作，如下所示：

```
 LocalDate localDateStart = LocalDate.now();
    Date startDate = Date.from(localDateStart.atStartOfDay(ZoneId.systemDefault()).toInstant());

    LocalDate localDateEnd = localDateStart.plusDays(1);
    Date endDate = Date.from(localDateEnd.atStartOfDay(ZoneId.systemDefault()).toInstant()); 
```

# generics - Castle Windsor Ioc 解析 web.config 中的通用类

> ID：902791
> 
> 赞同：6
> 
> 时间：2009-05-24T00:40:19.183
> 
> 标签：generics, inversion-of-control, web-config, castle-windsor

我有一个接口声明为

```
IRetrievable<T, idT> 
```

其中 T 是检索到的类型，IdT 是传递的参数。

如何配置城堡温莎 IoC 容器以将其解决为特定的实现。比如一个类定义为

```
FooRetriever : IRetrievable<Foo, string> 
```

我找到了一个示例，该示例显示了如何解析单个参数泛型：

```
<component id="FooRetriever" service="Namespace.IRetrievable'1[[Namespace.Foo, Assembly]], Assembly" type="Namespace.FooRetriever, Assembly" /> 
```

但是我不知道如何接受 2 个通用参数 (T, idT) 而不是一个。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-24T01:09:01.763

```
<component id="FooRetriever" service="Namespace.IRetrievable`2[[Namespace.Foo, Assembly],[System.String]], Assembly" type="Namespace.FooRetriever, Assembly" /> 
```

# c# - 部署到 Windows Mobile 设备的更好方法

> ID：902800
> 
> 赞同：1
> 
> 时间：2009-05-24T00:49:44.000
> 
> 标签：c#, .net, windows-mobile

我已经在 Windows Mobile 应用程序上工作了一段时间（以前没有在移动设备上做过很多工作）而且我在部署到我的手机时遇到了问题，目前我只能运行一次应用程序然后如果我想要要再次运行它，我必须进行软重置。

也许我部署错了？（我很确定实际上，我几乎只是复制 .exe 文件并运行它。）

对我来说，部署我的应用程序以便每次重置可以运行多次的更好方法是什么？目前，当我尝试在我的手机上第二次运行它时，什么也没有发生（但使用 Windows Mobile 6.1 模拟器可以正常工作）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-24T00:53:49.407

CAB 文件是部署 Windows Mobile 应用程序的首选方式。查看这篇 MSDN 文章：

[用于交付 Windows Mobile 应用程序的 CAB 文件](http://msdn.microsoft.com/en-us/library/bb158712.aspx)

我在将 CAB 文件放在 Web 服务器上并简单地通过 http 访问它以下载和安装 CAB 方面取得了一些成功。

# javascript - 在函数内创建一个弹出窗口

> ID：902801
> 
> 赞同：0
> 
> 时间：2009-05-24T00:50:02.143
> 
> 标签：javascript

我的代码尝试做的是添加新组（如果尚未创建），嗯，现在工作正常但是我也想在创建组后立即打开一个新的弹出窗口，提示用户邀请其他人，但我似乎没有让我的工作正常工作，关于如何使它工作的任何想法？

谢谢

```
<html>
<head>
<script type="text/javascript">

function addGroup()
{
  x=document.getElementById("group").getElementsByTagName("p");
  groups=document.getElementById("groupName");
  var j=0,i=0;  

  if   (groups.value=="")
  {
      alert('must create one group');
  }

   for (i=0;i<x.length;i++)
   { 
     if (x[i].innerHTML == groups.value)
     {
         alert('the group name is already created');
         return false;
     }  
   }

   if (!j)
   {
      var newNode=document.createElement('p');
      var newString=document.createTextNode(groups.value); 
      newNode.appendChild(newString);
      x[0].parentNode.appendChild(newNode);
      newWindow();
   }
}

function newWindow()
{
    window.open('http://invite Others.html','invite  
                         others','width=400,height=200,toolbar=yes,                             
      location=yes,directories=yes,status=yes,menubar=yes,scrollbars=yes,copyhistory=yes,
                             resizable=yes');
      winObj.focus();
}
</script>

</head>
<body>

<div id="group">
<ul>
   <p>Group03</p>
   <p>Group02</p>
</ul>
</div>

<p><input type="text" id="groupName" size="84" maxlength="84" value=""/></p>
<p><input type="button" value="create" onclick="addGroup()" /></p>
<p><input type="button" value="remove" onclick="removeNo()"/> </p>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-24T01:09:07.923

您的问题似乎是 window.open()。[http://invite](http://invite) others.html 不是有效的网址，因此它返回错误。

当我单击创建时，Firebug 返回了这个。

```
uncaught exception: [Exception... "Component returned failure code: 0x80004005 (NS_ERROR_FAILURE) [nsIDOMJSWindow.open]" nsresult: "0x80004005 (NS_ERROR_FAILURE)" location: "JS frame :: http://localhost/ :: newWindow :: line 43" data: no] 
```

但是，如果您使用[http://localhost/invite](http://localhost/invite) Others.html 它可以正常工作。因此，只需在 htttp:// 之后添加您的主机名，您就可以开始使用了。

# database - 在这种情况下如何确定外键的放置位置？

> ID：902812
> 
> 赞同：0
> 
> 时间：2009-05-24T00:58:51.223
> 
> 标签：database, database-design, foreign-keys, entity-relationship, foreign-key-relationship

如果我有两个表 - 登录和用户，如下所示：

```
Logins
 LoginIdNo
 UserIdNo
 HashedPassword 

Users
 UserIdNo
 LoginIdNo
 Username 
```

每个登录“有一个用户”，每个用户“有一个登录”，但哪个“属于”哪个？

它只是一个判断调用还是有一个明确的公式来确定外键应该驻留在哪里？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-24T01:06:30.380

这是一对一的关系。在这些情况下，放置外键的位置可能由可选性决定。

您将其分为两个实体有什么特别的原因吗？我不是一对一映射的忠实拥护者，尤其是在 JPA 之类的 ORM 上，它们难以实现（如果您使用一个主键作为另一个映射的外键）。

在您的系统中，登录和用户之间的区别是什么？

如果每次用户登录时都会发生登录（即，它是用户活动的审计跟踪），那么您在用户和登录之间存在一对多的关系，并且登录应该使用 UserID 外键。

但是在这种情况下，用户名在一个表中，密码在另一个表中，并且两者之间存在一对一的关系，您必须询问他们为什么分开。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-24T01:05:55.497

由于登录永远不会与多个用户相关联（反之亦然），因此您可以随意决定如何定义关系（以及放置外键的位置）。除非您还要添加其他属性（Firleds）或使用角色，否则像这样简单地定义它可能更简单：

```
Users 
    UserIdNo 
    Username
    HashedPassword 
```

# ruby-on-rails - 在表单外插入表单按钮

> ID：902816
> 
> 赞同：0
> 
> 时间：2009-05-24T01:01:38.843
> 
> 标签：ruby-on-rails, forms, hyperlink

是否有允许您插入表单按钮并将它们用作超链接的 Rails 库？我想我以前在某个地方见过它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-24T01:11:46.470

是的，您可以使用`button_to`，但总的来说这不是一个*好*主意。

默认情况下`button_to`，帮助程序以表单 POST 的形式实现，这意味着对于非幂等的操作（即常规 GET 操作）来说，这是一个糟糕的选择。尽可能地坚持链接。

# delphi - 从 Firefox 复制图像时出现黑色背景

> ID：902817
> 
> 赞同：4
> 
> 时间：2009-05-24T01:01:55.583
> 
> 标签：delphi, firefox, jpeg, clipboard

图像从 Firefox 复制到剪贴板。我的程序从剪贴板中获取它并保存为 JPEG 图像。由于某种原因，图像以黑色背景保存。如果我在 IE 中打开相同的 URL 并将图像复制到剪贴板，则图像会被我的程序正确保存。我正在使用德尔福 7。

我还尝试将图像从 Firefox 复制到 Microsoft Paint 并再次复制黑色背景。有没有人有如何处理此类问题的提示。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-24T01:10:49.280

我假设原始图像是透明的？如果是这样，您应该知道 JPEG 无法处理透明度。尝试切换输出图像类型，看看你的程序是否神奇地消失了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-24T01:25:36.130

如果您在程序和 Paint 中获得相同的背景，那么这告诉我这与 Firefox 有关，因此不一定是您要解决的问题。

由于您担心背景颜色，我猜您正在复制的图像具有透明元素。所以告诉我：*应该*有什么颜色？JPEG 图像不能有透明部分，因此每个像素都必须有*某种*颜色。Firefox 显然选择将黑色放在那里；这怎么不是一个正确的选择而 Internet Explorer 的选择是正确的？

我想知道当您粘贴到比 Paint 功能更强大的图形程序（例如 Gimp 或 Photoshop）时，您会得到什么颜色的背景。我希望这些程序考虑多种[剪贴板格式](http://msdn.microsoft.com/en-us/library/ms649013.aspx)并选择最合适的格式，因此他们可能会选择一种在可用时适应透明度的格式。另一方面，您的程序和 Paint 可能只使用`cf_Bitmap`格式，当然不能有透明像素，因此它们会得到复制程序选择用来填充空白空间的任何内容。

顺便说一句，Firefox 和 Internet Explorer 都允许您将图像直接从浏览器拖到桌面或其他文件夹窗口以保存原始图像。也许这使您的程序变得不必要？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-01-18T20:11:10.103

我知道这是一个有点老的问题，但我刚刚在 Firefox v9 中遇到了同样的问题。

使用以下解决方法：将有问题的图像保存到您的计算机，然后将文件复制到资源管理器中并粘贴到您要使用的程序中（在我的情况下，我粘贴到 word 中）。

# windows-7 - 如何开始使用 Windows 7 小工具

> ID：902818
> 
> 赞同：112
> 
> 时间：2009-05-24T01:02:42.837
> 
> 标签：windows-7, windows-desktop-gadgets

我从未为 Vista 或 7 编写过小工具，但我想尝试制作一个。但是我从哪里开始呢？我试图在 google 和 msdn 上搜索，但我没有找到任何有用的东西。要么是非常非常古老的东西（Vista beta 的东西），要么已经制作了小工具，要么是 Vista 和 7 中的小工具之间的差异。但这对我没有帮助，因为我一开始不知道如何制作小工具......我什至没有设法找出它们是用什么写的......

那么，任何人都可以帮助我开始吗？

*   我从哪里开始？
*   我需要知道什么？
*   它们是用什么写的？
*   它们是如何“包装”的？

换句话说，我如何从使用 Visual Studio 的全新 Windows 7 安装到可以安装并放在我的 Windows 7 桌面上的工作小工具。

* * *

## 回答 #1

> 赞同：89
> 
> 时间：2009-09-02T04:27:41.180

*将所有当前答案组合并组织成一个答案，然后添加我自己的研究：*

**[微软小工具](http://en.wikipedia.org/wiki/Microsoft_Gadgets)开发小结：**

*它们是用什么写的？*Windows Vista/Seven 小工具是混合使用 XML、HTML、CSS 和一些 IE 脚本语言开发的。也可以将 C# 与最新版本的 Script# 一起使用。

*它们是如何打包/部署的？*实际的小工具存储在 *.gadget 文件中，这些文件只是上面列出的文本源文件，压缩成单个 zip 文件。

**小工具开发的有用参考：**

*我从哪里开始？*对 Windows Vista/Seven 小工具开发的良好介绍性参考：

*   [为 Windows 边栏开发小工具](http://www.odetocode.com/articles/463.aspx)
*   [I-Programmer 的Vista Gadgets](http://www.i-programmer.info/projects/38-windows/113-vista-gadgets-.html?showall=1)入门教程
*   [在 C# 中创作侧边栏小工具](http://www.nikhilk.net/SidebarGadgets.aspx)
*   [为 Windows 边栏开发小工具第 1 部分：基础知识](http://msdn.microsoft.com/en-us/library/bb456468(VS.85).aspx)官方 MSDN 教程。

如果你愿意使用离线资源，这本书似乎是一个很好的资源：

*   [创建 Vista 小工具：将 HTML、CSS 和 JavaScript 与 RSS、Ajax、ActiveX (COM) 和 Silverlight 中的示例一起使用](http://books.google.com/books?id=fRRQ1aTZtDYC&dq=0672329689&source=gbs_navlinks_s)
*   与书相关的博客：http: [//www.innovatewithgadgets.com/](http://www.innovatewithgadgets.com/)

*我需要知道什么？*其他一些有用的参考资料；不一定是教学

*   [Windows 边栏](http://msdn.microsoft.com/en-us/library/aa965850(VS.85).aspx)（官方 MSDN 文档）
*   相关 Stack Overflow 问题：[编写小工具的 C# 教程](https://stackoverflow.com/questions/1171588/c-tutorial-to-write-gadgets/1365692#1365692)

* * *

**更新：**嗯，这已被证明是一个流行的答案~ 分享我自己最近在 Windows 7 小工具开发方面的经验：

**开始 Windows 7 小工具开发的最简单方法可能是修改已开发的小工具。**我最近自己做了这个，因为我想要一个更大的时钟小工具。找不到任何东西，我修补了一个标准 Windows 时钟小工具的副本，直到它变大了两倍。我建议从时​​钟小工具开始，因为它相当小而且写得很好。这是我使用的过程：

1.  找到您要修改的小工具。它们分布在几个不同的地方。搜索名为 *.gadget 的文件夹。例子：`C:\Program Files\Windows Sidebar\Gadgets\Clock.Gadget\`
2.  制作此文件夹的副本（已安装的小工具未包装在 zip 文件中。）
3.  重命名一些关键部分：
    1.  文件夹名称
    2.  gadget.xml 文件中的名称。它看起来像：`<name>Clock</name>`这是将显示在“小工具库”窗口中的名称。
4.  压缩整个 *.gadget 目录。
5.  将文件扩展名从“zip”更改为“gadget”（可能只需要删除“.zip”扩展名。）
6.  通过双击新的 *.gadget 文件来安装新的小工具副本。您现在可以像添加任何其他小工具一样添加小工具（右键单击桌面->小工具）
7.  找到这个小工具的安装位置（可能是`%LOCALAPPDATA%\Microsoft\Windows Sidebar\`）
8.  修改此目录中的文件。该小工具与网页非常相似：HTML、CSS、JS 和图像文件。gadget.xml 文件指定打开哪个文件作为小工具的“索引”页面。
9.  保存更改后，通过安装小工具的新实例来查看结果。您还可以[调试 JavaScript](http://msdn.microsoft.com/en-us/magazine/cc163370.aspx#S11)（该文章的其余部分也提供了非常丰富的信息）。

* * *

## 回答 #2

> 赞同：61
> 
> 时间：2009-05-24T01:45:01.893

[这是有关Vista Gadgets](http://msdn.microsoft.com/en-us/library/bb456468(VS.85).aspx)的 MSDN 文章。关于 7 个小工具的一些初步文档[和更改](http://msdn.microsoft.com/en-us/library/dd370867(VS.85).aspx)。我认为唯一的主要变化是小工具不再驻留在侧边栏中，因此“停靠/取消停靠事件”现在是向后兼容的工具，确实不应该使用。

最好的入门方法可能是调整现有的小工具。上面的链接中有一个示例小工具，或者您可以自己选择一个不同的小工具。

小工具是用 HTML、CSS 和一些 IE 脚本语言（通常是 Javascript，但我相信 VBScript 也可以）编写的。对于真正花哨的东西，您可能需要创建一个 ActiveX 对象，因此了解 COM 的 C#/C++ 可能很有用。

小工具被打包为“.gadget”文件，这些文件只是重命名的 Zip 档案，在其顶层包含一个小工具清单 (gadget.xml)。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-24T01:49:32.743

这是 Scott Allen 的一篇优秀文章：[为 Windows 边栏开发小工具](http://www.odetocode.com/articles/463.aspx)

这个站点，[Windows 7/Vista Sidebar Gadgets](http://www.innovatewithgadgets.com/)，有很多小工具资源的链接。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2010-10-21T11:35:02.747

我已经开始为每个人编写有关此主题的教程，请参阅[为 Windows 7 制作小工具](http://digitalpbk.com/windows-gadgets/how-make-windows-gadget-windows-7)。

# php - PHP数组：提取一维

> ID：902824
> 
> 赞同：0
> 
> 时间：2009-05-24T01:06:57.697
> 
> 标签：php, arrays

我有一个看起来像这样的数组：

```
$fields = array(
  "f1" => array("test"),
  "f2" => array("other" => "values")
); 
```

我想在一个数组中检索这些信息：

```
$first_dimension = array("f1","f2"); 
```

PHP中是否有可以直接提取数组特定维度的函数？这有语法快捷方式吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-24T01:08:37.427

使用[array_keys()](http://au2.php.net/array_keys)。

```
$fields = array(
  'f1' => array('test'),
  'f2' => array('other' => 'values'),
);
$keys = array_keys($fields); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-24T04:17:12.417

$fields['f2'][其他']

直接访问它

# c# - ASP.NET / C# 如何使用 runat=server 访问无序列表的列表项？

> ID：902832
> 
> 赞同：1
> 
> 时间：2009-05-24T01:11:46.610
> 
> 标签：c#, asp.net, list

我有一个 ul 列表，其中包含许多列表项，例如：

```
<ul>
<li runat="server" id="liOne">one</li>
<li runat="server" id="liTwo">two</li>
<li runat="server" id="liThree">three</li>
</ul> 
```

在页面加载时，我需要将这些列表项设置为可见或不可见。

出于某种原因，我无法在后面的 C# 代码中访问这些。也不会为设计器文件生成列表项。有没有人有任何建议如何让它工作？

我收到此错误：

```
The name 'liOne' does not exist in the current context 
```

非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-24T01:18:04.740

它应该工作。尝试重建并重新启动 Visual Studio。

然后尝试删除设计器文件并右键单击页面并选择“转换为 Web 应用程序”——如果它确实已经是一个 Web 应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-24T16:35:18.387

您的代码可能包含一些不允许通过 ID 直接引用的服务器控件。如果是这样，您可以通过编写以下代码来访问此包装器的内部元素：

var li = wrapperElement.FindControl("liOne") as HtmlGenericControl;

希望这可以帮助。

# python - 编译 Python，curses.h 未找到

> ID：902833
> 
> 赞同：4
> 
> 时间：2009-05-24T01:12:18.980
> 
> 标签：python, configure, curses

我正在尝试在我的 Linux 系统上从源代码构建 Python 2.6.2。它在 /usr/local/ 上安装了 ncurses，并且 curses.h 在 /usr/local/include/ncurses 上。因此在包含路径上找不到 curses.h，并且这些包在 Python 构建中失败。

什么是正确的解决方案？Python 应该包含 <ncurses/curses.h> 吗？/usr/local/include/ncurses 是否应该在包含路径中？是否应该有从 ncurses 目录中的文件到 /usr/local/include 的链接？

还是有一些更简单的解决方案？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-24T01:35:02.833

使用许多开源软件包，您可以设置：

```
export CPPFLAGS="-I/usr/local/include" 
```

甚至：

```
export CPPFLAGS="-I/usr/local/include/ncurses" 
```

在运行配置脚本之前。我最近还没有编译 Python 以确保它可以工作，但它可能确实 - 我在 /usr/gnu 下安装了 ncurses（因为 /usr/local/ 是自动挂载的并且包含古董）而且我不记得必须使用任何特殊的东西来让它工作。

* * *

复核...

配置脚本仅包括`<curses.h>`. 我不得不使用：

```
export CPPFLAGS="-I/usr/gnu/include -I/usr/gnu/include/ncurses"
export LDFLAGS="-L/usr/gnu/lib"
./configure 
```

让 Python (2.5) 配置为接受诅咒。对于您的配置，您需要将 ' `gnu`'替换为 ' '。`local`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-16T14:58:59.100

我知道这是一个非常古老的问题，但是从源代码编译 python 3.6.0 时我仍然会遇到这个问题，所以我想它仍然是相关的。

最新版本的 ncurses 有几种风格：正常、广泛的字符支持、线程。为了让程序员保持和使用不同的风格，除了以不同的方式命名库（`ncursesw.so`,`ncursest.so`等）外，ncurses 配置脚本设置 makefile 以默认将头文件放在子目录中。这也允许在 ncurses 旁边有不同的 curses 实现，如[手册页](https://linux.die.net/man/3/ncurses)中所述。

然而，一些程序仍然假定`curses.h`. 与所有其他 ncurses 头一起放置在顶级包含搜索路径中，并且不会查看子目录。在许多 Linux 发行版中，ncurses 开发包中的问题通常有某种解决方法，但是如果你从源代码编译 ncurses，有两种可能的方法来解决这个问题：

1.  `CPPFLAGS`正如公认的答案所暗示的那样，使用或等效。它可以工作，但您必须每次都设置适当的编译标志。
2.  使用`--enable-overwrite`. 这将根据您的`--prefix`.

如果您不打算安装备用的 curses 库，将 ncurses 头文件放在顶级包含路径中是完全安全的，这是[Gentoo](https://gitweb.gentoo.org/repo/gentoo.git/tree/sys-libs/ncurses/ncurses-6.0-r1.ebuild)遵循的方法。

# jquery - 如何在jQuery中选择具有特定ID的所有元素？

> ID：902839
> 
> 赞同：78
> 
> 时间：2009-05-24T01:16:53.480
> 
> 标签：jquery, css-selectors

我试图`<div>`在 jQuery 中选择所有具有相同 ID 的 s。我该怎么做？

我试过了，但没有用

```
jQuery('#xx').each(function(ind,obj){
      //do stuff;
}); 
```

* * *

## 回答 #1

> 赞同：410
> 
> 时间：2011-07-19T09:02:18.990

虽然这里还有其他正确的答案（例如使用类），但从学术角度来看，当然可以有多个具有相同 ID 的 div，并且可以使用 jQuery 选择它们。

当你使用

```
jQuery("#elemid") 
```

它只选择具有给定 ID 的第一个元素。

但是，当您按属性选择时（例如，在您的情况下为*id*），它会返回所有匹配的元素，如下所示：

```
jQuery("[id=elemid]") 
```

这当然适用于任何属性的选择，您可以通过指定有问题的标签来进一步优化您的选择（例如*div*在您的情况下）

```
jQuery("div[id=elemid]") 
```

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2009-05-24T01:22:16.540

我会使用不同的 ID，但为每个 DIV 分配相同的类。

```
<div id="c-1" class="countdown"></div>
<div id="c-2" class="countdown"></div> 
```

这还有一个额外的好处，那就是能够根据 jQuery('.countdown').length 的返回来重建 ID

* * *

好的，如何为每个倒数计时器添加多个类。IE：

```
<div class="countdown c-1"></div>
<div class="countdown c-2"></div>
<div class="countdown c-1"></div> 
```

这样你就可以两全其美了。它甚至允许重复“IDS”

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2009-05-24T01:19:34.970

您的文档不应包含具有相同 id 的两个 div。这是[无效](http://www.w3.org/TR/REC-html40/struct/global.html#h-7.5.2)的 HTML，因此底层 DOM API 不支持它。

从[HTML 标准](http://www.w3.org/TR/REC-html40/struct/global.html#h-7.5.2)：

> id = name [CS] 此属性为元素分配名称。此名称在文档中必须是唯一的。

您可以为每个 div 分配不同的 id 并使用`$('#id1, #id2)`. 或者将相同的类分配给两个元素（`.cls`例如），并使用`$('.cls')`来选择它们。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-01-08T15:21:14.180

试试这个通过第一个 id 选择 div

```
$('div[id^="c-"]') 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-04-15T14:56:25.083

`$("div[id^=" + controlid + "]")`将返回具有相同名称的所有控件，但您需要确保文本不应出现在任何控件中

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-24T01:22:10.147

你可以为每个不同的计时器分配一个唯一的 CSS 类吗？这样你就可以使用 CSS 类的选择器，它可以很好地处理多个`div`元素。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-08-26T12:10:18.480

您也可以尝试将两个 div 包装在两个具有唯一 ID 的 div 中。然后选择 div`$("#div1","#wraper1")`和`$("#div1","#wraper2")`

干得好：

```
<div id="wraper1">
<div id="div1">
</div>
<div id="wraper2">
<div id="div1">
</div> 
```

# deployment - 为什么这么多程序都有 setup.exe 和 setup.msi？

> ID：902841
> 
> 赞同：52
> 
> 时间：2009-05-24T01:18:20.653
> 
> 标签：deployment, installation

我一直想知道这一点。许多应用程序设置都有一个您解压缩的 zip 文件，其中包含一堆文件，其中包括一个 exe 和一个 msi。有什么不同？它们通常甚至大小相同。我从来不确定要执行哪一个，有时我会执行 exe，有​​时会执行 msi，它通常适用于任何一个。但是他们中的一个会做另一个没有做的事情吗？如果不是，那么拥有两个做同样事情的文件是不是有点浪费？特别是在考虑下载大小等时...

*不确定这应该在这里还是在 ServerFault 上，或者两者都不是，但我认为由于开发人员通常是创建设置文件的人，那么开发人员可能知道为什么会这样 =)*

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-05-24T01:25:20.107

如果您同时拥有 exe 和 msi，则 exe 只是 msi 的加载程序。如果您的安装支持多种语言，则 exe 在安装前会在 msi 上应用语言转换 (mst)。

您可以将 exe 视为 msi 的包装器。msi 文件可能会也可能不会单独给出。人们也提供 msi 文件的原因是为了方便组策略安装（在 Windows Active Directory 基础架构中），因为您只能下推 msi 文件的安装，而不是 exes。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2010-12-30T16:30:08.603

这`setup.exe`是 MSI 的包装器，但它*不仅仅是*一个包装器。

*   可以`setup.exe`依赖a`setup.ini`来定义参数
*   检查 Windows 安装程序（`setup.exe`否则无法安装 MSI）
*   `setup.exe`可以检查框架，例如 .NET 框架。开发人员可以选择`C:\Program Files\Microsoft SDKs\Windows\v6.0A\Bootstrapper\Packages`（对于 Visual Studio 2008）中定义的那些之一。如果缺少，它会尝试从[http://www.microsoft.com/下载它](http://www.microsoft.com/)
*   `setup.exe`可以重新配置`msistuff.exe`

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2010-01-25T05:21:33.480

实际安装在 MSI 中完成。正如Prashast所说，exe只是一个包装器，但拥有exe的原因是exe总是可以运行的。如果用户没有在计算机上安装 MS Installer，或者他的 MS Installer 版本比您安装所需的版本旧，则无法运行 MSI 文件。

该 exe 在运行 MSI 文件之前提供了 MS Installer 的自动安装（包括用户是否想要这样做的一些问题）。在大多数情况下，Microsoft Installer 所需的安装包包含在 setup.exe 中，或者有时它只是先决条件检查，带有从 Microsoft 下载安装的链接。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-09-04T11:06:23.247

用非常基本的话说，

您可以只提供 .msi 文件，它会安装。但是没有 .msi .exe 将无法工作

# account-management - 您将如何使用 Google Apps 配置包罗万象的电子邮件系统？

> ID：902844
> 
> 赞同：1
> 
> 时间：2009-05-24T01:20:23.050
> 
> 标签：account-management

为您的域使用 Google Apps，是否可以设置一个包罗万象的地址来充当假设虚拟邮箱系统上的各种其他地址的代理，如果可以，您将如何进行设置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-24T01:22:56.417

设置 Google Apps，以便将所有发送到不存在地址的邮件发送到某个地址，通过 POP 登录该邮箱，下载所有发送到 x@your-service.com 的邮件

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-24T01:27:48.747

您可以尝试[http://groups.google.com/group/google-appengine/browse_thread/thread/7f48e15a7cedafa6](http://groups.google.com/group/google-appengine/browse_thread/thread/7f48e15a7cedafa6)中描述的免费服务；我相信应用引擎直接接收电子邮件的能力在谷歌的路线图上，但我不知道它计划什么时候出现，或者它是否会免费提供等等。

# php - PHP：获取数组类型

> ID：902857
> 
> 赞同：2
> 
> 时间：2009-05-24T01:28:26.920
> 
> 标签：php, arrays

除了明确检查数组键之外，是否有一个 php 函数可以用来自动检测数组是否为关联数组？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-07-24T16:02:02.643

我的简短回答：是的

更快更容易，如果您假设“非关联数组”从 0 开始索引：

```
if ($original_array == array_values($original_array)) 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-24T01:36:58.993

引用自官网：

> 索引和关联数组类型在 PHP 中是相同的类型，

所以我能想到的最好的解决方案是在所有键上运行，或者使用 array_keys,implode,is_numeric

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-07-24T15:43:21.427

```
函数 is_associative_array($array) {
    return (is_array($array) && !is_numeric(implode("", array_keys($array))));
}

```

测试密钥效果很好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-24T01:32:49.127

查看[is_array](http://in2.php.net/is_array "PHP: is_array")上的讨论。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-24T01:50:58.527

简短的回答：没有。

长答案：关联数组和索引数组在 PHP 中是相同的类型。索引数组是关联数组的子集，其中：

*   键只是整数；
*   它们的范围从 0 到 N-1，其中 N 是数组的大小。

如果需要，您可以尝试使用 array_keys() 进行检测并与 range() 结果进行比较。

# visual-studio-2010 - VS 2010 Beta1“未收集历史数据”

> ID：902858
> 
> 赞同：0
> 
> 时间：2009-05-24T01:29:41.503
> 
> 标签：visual-studio-2010, beta

我正在尝试 VS2010 Beta 1 中的历史调试器。

我在设置中打开了它（至少我认为我这样做了），但是当我尝试检查对象时，值是：

[未收集历史数据]

任何想法如何让这个显示实际价值？

这是有问题的代码：

```
 public partial class Form1 : Form

   {

       public Form1()

       {InitializeComponent();}

       private void button1_Click(object sender, EventArgs e)

       {

           int numer = Int32.Parse(txtNumerator.Text) ;

           int denom = Int32.Parse(txtDemoninator.Text);

           float answer = DivideValues(numer, denom);

           txtAnswer.Text = answer.ToString();

       }

       private static float DivideValues(int numer, int denom)

       {

           float answer = numer / denom;

           return answer;

       }

   } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-25T04:58:41.510

要使其正常工作，您需要使用调试历史记录窗口中的树形视图。排水沟中的导航箭头似乎更多的是分散注意力而不是帮助，因为它可以让您到达未记录的区域。

此外，不记录局部变量。这是设计使然。

# mysql - MySQL查询删除日期接近另一行的行

> ID：902859
> 
> 赞同：1
> 
> 时间：2009-05-24T01:29:43.187
> 
> 标签：mysql, database, date, delete-row

我有一个包含许多行的表。这些行保证已按名为 的列的顺序插入，该列`created_on`是一`datetime`列。如果给定行的`created_on`时间在现有行的 5 秒内，我想删除给定行。

我将如何编写查询来删除这些行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-24T01:45:52.360

```
SELECT *
FROM TABLE AS A
WHERE EXISTS (
    SELECT *
    FROM TABLE AS B
    WHERE DATE_SUB(A.created_on, INTERVAL 5 SECOND) <= B.created_on
        AND B.created_on < A.created_on
) 
```

你明白了，这基本上会删除 5 秒内的所有事件链，除了链中的第一个事件。

因为您不能在 DELETE 中为表设置别名，所以您必须执行以下操作：

```
DELETE
FROM   so902859
WHERE   created_on IN (
        SELECT  created_on
        FROM   so902859 AS A
        WHERE   EXISTS ( SELECT *
                         FROM  so902859 AS B
                         WHERE  DATE_SUB(A.created_on, INTERVAL 5 SECOND) <= B.created_on
                                AND B.created_on < A.created_on ) ) 
```

有上百万种方法可以使用 JOIN 或其他方法给这只猫剥皮。我认为这是最容易理解的，如果有点冗长的话。

# unit-testing - Google App Engine + GWT + Eclipse：您的单元测试在哪里进行？

> ID：902860
> 
> 赞同：3
> 
> 时间：2009-05-24T01:32:48.440
> 
> 标签：unit-testing, google-app-engine, gwt, google-eclipse-plugin

我刚刚开始使用一个结合了 GWT、Google App Engine 和 Google Eclipse 插件的项目。存放我的测试的最佳位置在哪里？我通常将我的代码组织成 Maven 风格，`src/main/java`使用`src/test/java`. 我从插件中获得的默认设置将我的源代码直接转储到`src`，我不太喜欢，但我不想与这些工具作斗争。在这样的项目中放置单元测试的“标准”位置是什么？

**解决方案**：

*   创建`src/main/java`，将现有代码移到那里
*   创建`src/test/java`，在此处添加您的测试
*   转到项目 -> 属性 -> Java 构建路径，将新位置添加为源文件夹。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-07T17:37:46.360

我在 GAE 测试中遇到了一种问题：有些测试需要一个 appengine-testing.jar 与项目的主要 appengine-api-xxx.jar 冲突。这样，我能够为 GAE 运行测试，但它与正常的运行/调试启动冲突。为了能够在我的本地机器上运行应用程序，我必须删除 appengine-testing.jar，然后，我的测试/类中出现了很多编译错误。

如果您需要建议，请将您的测试类设置在另一个项目中（您可以在其中使用 jar 而不会发生冲突）

否则，如果你让它工作，请告诉我你是怎么做的。

非常感谢。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-24T02:31:24.140

把它放在你最不痛的地方。

Google App Engine 上的 GWT 在这一点上是相当新的。你乐观地期待有一个“标准”的地方，特别是因为你已经发现工具的作用不一致。

既然你已经接受了从“src/”开始的源，为什么不把测试源放在“test/”呢？这在许多情况下当然是标准的。

# api - 多久运行一次 cron 来挖掘 Twitter 公共时间线？

> ID：902878
> 
> 赞同：4
> 
> 时间：2009-05-24T01:43:30.710
> 
> 标签：api, twitter, cron

依赖于 twitter 公开时间线的 webapps，他们多久收集一次数据？每分钟必须有数十万条消息，对吗？他们如何设法收集所有推文，而又不遗漏任何一条？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T03:06:04.233

公共时间线不再是挖掘数据的好地方。Twitter 现在使用它的[Streaming API](http://apiwiki.twitter.com/Streaming-API-Documentation)来疯狂地输出推文。与公共时间线最接近的比较是[spritzer](http://apiwiki.twitter.com/Streaming-API-Documentation#spritzer)方法，但这只包括一个小样本。如果您需要收集除 spritzer 方法之外的所有（或更多）推文，则需要签署书面协议才能访问其他 Streaming API（HTTP 推送）提要，例如返回所有公共推文的[firehose提要。](http://apiwiki.twitter.com/Streaming-API-Documentation#firehose)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-24T01:51:56.700

一些服务（Friendfeed 就是一个很好的例子）被授予访问[Twitter 流 API](http://apiwiki.twitter.com/Streaming-API-Documentation)的权限，也就是“firehose”。它需要批准和书面协议。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-24T22:13:45.050

到这里：

[http://twitter.com/help/request_whitelisting](http://twitter.com/help/request_whitelisting)

如果每小时 100 个请求还不够，则将您的帐户列入白名单（允许每小时 20,000 个）。

@ceejayoz 它不是 100 个 GET 请求，它的 100 个请求通常不包括一些请求，例如 verify_credentials 和 rate_limit_status。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-24T02:06:34.407

如前所述，twitter API 是速率受限的。公共时间线 (twitter.com/public_timeline) 在同一意义上没有速率限制，但它仅每 5 秒更新一次，因此大多数推文从未出现在那里。

我认为有三四家公司可以使用消防软管，因为 Twitter 的完整提要被称为。FriendFeed 就是其中之一。另一个是 Gnip。Gnip 将饲料转售给其他公司。这可能是获得完整 Twitter 提要的唯一可行方法。

# ruby-on-rails - 说如果我使用 Rails 2.3.2 开发一个 Ruby on Rails 应用程序，那通常会与我的托管公司的乘客兼容吗？

> ID：902890
> 
> 赞同：-1
> 
> 时间：2009-05-24T01:52:30.350
> 
> 标签：ruby-on-rails, ruby, passenger, mod-rails

说如果我使用 Rails 2.3.2 开发一个 Ruby on Rails 应用程序，那通常会与我的托管公司的乘客兼容吗？

如果我 SSH 到我的托管公司并输入 rails -v，我会得到 2.2.2...所以看起来他们可能正在使用 Rails 2.2.2。

因此，如果我在我的 Macbook 上开发 Rails 应用程序并 ftp 那里的所有文件，那么那里的乘客通常会与当前版本的 Rails 生成的代码一起正常工作吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-24T02:17:25.837

使用内置的 rake 任务将 rails 冻结到 vendor/rails 中。这样，无论您将其部署在何处，您的应用程序都将使用您想要的 Rails 版本。

```
rake rails:freeze:gems 
```

以及我所知道的执行特定版本的最简单方法。

```
rake rails:freeze:edge RELEASE=2.3.2.1 
```

现在，您的 rails 版本将与您一起发送到您的应用程序。

您可以将其他 gem 依赖项解压缩到您正在使用的任何 gem 的 vendor/gems 中，并希望确保它在您部署应用程序的任何地方都可用。

```
rake gems:unpack 
```

并确保他们的依赖项去：

```
rake gems:unpack:dependencies 
```

我还建议您验证他们正在运行最新版本的乘客。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-24T02:16:30.440

我会验证他们安装的乘客版本（或确认他们已经安装了它）。我还建议您冻结您的 Rails 版本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T07:10:32.697

只是为了 railsninja 的回答。

首先说，它不会立即起作用。

该主机是您的 vps 还是以某种方式具有 sudo 访问权限？

如果是，我建议您使用 rake gems:install 而不是 gems:unpack，因为某些 gems 依赖于操作系统，例如（Rcov、RedCloth...等）

我会询问托管公司他们的乘客配置，重要的问题是他们是否使用 RailsS​​pawnMethod：smart 或 smart-lv2（默认）。如果他们使用 smart 方法，那么最好冻结你的 gems 和 rails 否则将有兼容问题，因为您可以从乘客用户手册中找到有关 RailsS​​pawnMethod 的参考。

如果你冻结你的 gem，它将几乎 100% 兼容（所有的 gem 都需要在 environment.rb 中用 config.gem 正确声明，例如（config.gem 'will_paginate',:source=>" [http://gems .github.com](http://gems.github.com) ")) 和铁路！！！！！！

# c# - 如何在 Silverlight 中向控件添加状态？

> ID：902891
> 
> 赞同：2
> 
> 时间：2009-05-24T01:54:19.347
> 
> 标签：c#, .net, silverlight

我有自己的 TextBox2 类，它派生自 TextBox。我想添加一个名为 TextBlock 的状态，并且我希望 VisualStateManager 在 IsTextBlock 属性/依赖项属性为 true 时进入该状态。当这是真的时，我想将文本框的样式更改为只读并且看起来就像一个 TextBlock 但能够选择要复制的文本。这可能吗？有没有更好的办法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T23:37:47.053

像这样的东西：

```
[TemplateVisualState(Name = "TextBlock", GroupName = "ControlType")]
[TemplateVisualState(Name = "TextBox", GroupName = "ControlType")]
public class TextBox2 : TextBox
{
    public TextBox2()
    {
        DefaultStyleKey = typeof (TextBox2);
        Loaded += (s, e) => UpdateVisualState(false);
    }

    private bool isTextBlock;
    public bool IsTextBlock
    {
        get { return isTextBlock; }
        set
        {
            isTextBlock = value;
            UpdateVisualState(true);
        }
    }

    public override void OnApplyTemplate()
    {
        base.OnApplyTemplate();
        UpdateVisualState(false);
    }

    internal void UpdateVisualState(bool useTransitions)
    {
        if (IsTextBlock)
        {
            VisualStateManager.GoToState(this, "TextBlock" , useTransitions);
        }
        else
        {
            VisualStateManager.GoToState(this, "TextBox" , useTransitions);
        }
    }
} 
```

高温高压

# jquery - iphone键盘'go'不起作用jquery提交

> ID：902893
> 
> 赞同：0
> 
> 时间：2009-05-24T01:57:12.820
> 
> 标签：jquery, iphone, html

我在具有提交按钮的页面上有一个表单。如果我点击提交按钮，它会将 jquery POST 发布到另一个页面并登录用户。如果我使用页面上的提交按钮，效果很好。如果我在数字键盘上单击“开始”，它只会刷新页面。

我认为这是因为他的表格是这样的（使用 iWebkit）...

```
<span class="graytitle">Login</span>
<ul class="pageitem">
<form name="form" method="post" action="#">
<li class="form"><input placeholder="Username" type="text" id="login"/></li>
<li class="form"><input placeholder="Password" type="password" id="password"/></li></form>
<li class="form"><input type="submit"  onClick="SubmitForm('login')" ></submit></li>
</ul> 
```

您将看到提交在表单之外，这是因为在任何浏览器上页面都会重新加载。如果我使用按钮而不是提交，我会得到相同的响应。

在桌面 safari 上运行良好

有谁知道这是为什么？

我已经尝试过提交

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-11T05:58:49.053

我很确定提交按钮需要在表单内 - 为什么你需要它在外面？

否则，当用户点击 Go 时，他们正在提交表单，而不是触发您的 JS onClick 事件（类似于他们在完成输入文本字段后按 Return/Enter）。

您的 Javascript 永远不会被调用，除了表单提交到您在“操作”字段中定义的位置之外，什么也不会发生……在这种情况下，是“#”。

# python - win32com python.Interpreter 是如何工作的？

> ID：902895
> 
> 赞同：0
> 
> 时间：2009-05-24T01:58:11.303
> 
> 标签：python, com

好的，所以我正在尝试用谷歌搜索 win32com python 包和 python.Interpreter COM 服务器。不幸的是，python.Interpreter 最终成为“python 解释器”并且没有给我任何 COM 服务器结果。

我正在尝试制作一个可插入的程序，它有一个插件来允许 python 代码运行，看起来 python.Interpreter 是一个不错的方法。但我以前没有使用过它，我不确定如何通过 COM 使从它创建的对象可用。

任何有关文档/示例的建议或指针将不胜感激。

此外，用户是否需要安装 python 包才能使用 COM 服务器，或者解释器是否内置在服务器 dll 中？

谢谢布雷特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-24T02:31:21.737

见[http://books.google.com/books?id=ns1WMyLVnRMC&pg=PA232&lpg=PA232&dq=win32com+%22python.interpreter%22&source=bl&ots=NVpe-E8eGg&sig=imGi73WQyOmP4rJC6-jpz4stb9M&hl=en&ei=xrAYSsTHBZH0tAORqeCSDw&sa=X&oi=book_result&ct=result&resnum=6 #PPA232,M1](http://books.google.com/books?id=ns1WMyLVnRMC&pg=PA232&lpg=PA232&dq=win32com+%22python.interpreter%22&source=bl&ots=NVpe-E8eGg&sig=imGi73WQyOmP4rJC6-jpz4stb9M&hl=en&ei=xrAYSsTHBZH0tAORqeCSDw&sa=X&oi=book_result&ct=result&resnum=6#PPA232,M1)获取关于 python.interpreter 的优秀文档——至于你的第二个问题，通常 win32com 作为现有 Python 安装的附加组件安装，但当然你可以选择包含 win32 扩展的 Python 发行版，例如Activestate 在[http://www.activestate.com/activepython/](http://www.activestate.com/activepython/)。

# c - 无法理解 gcc 的汇编输出

> ID：902896
> 
> 赞同：1
> 
> 时间：2009-05-24T02:00:35.123
> 
> 标签：c, gcc, assembly

在编写一些 C 代码时，我决定将其编译为汇编并阅读它——我只是偶尔这样做——这是一种练习，让我每次编写代码时都在思考机器在做什么C 中的声明。

无论如何，我用 C 写了这两行

```
asm(";move old_string[i] to new_string[x]");
new_string[x] = old_string[i];
asm(";shift old_string[i+1] into new_string[x]");
new_string[x] |= old_string[i + 1] << 8; 
```

(`old_string`是 的数组`char`，并且`new_string`是 的数组`unsigned short`，因此给定两个字符，42 和 43，这会将 4342 放入`new_string[x]`)
产生以下输出：

```
#move old_string[i] to new_string[x]

movl    -20(%ebp), %esi         #put address of first char of old_string in esi
movsbw  (%edi,%esi),%dx         #put first char into dx
movw    %dx, (%ecx,%ebx,2)      #put first char into new_string

#shift old_string[i+1] into new_string[x]

movsbl  1(%esi,%edi),%eax       #put old_string[i+1] into eax
sall    $8, %eax                #shift it left by 8 bits
orl     %edx, %eax              #or edx into it
movw    %ax, (%ecx,%ebx,2)      #? 
```

（我自己评论它，所以我可以关注正在发生的事情）。我用 -O3 编译它，所以我也可以看到编译器如何优化某些结构。无论如何，我确信这可能很简单，但这是我没有得到的：

第一部分复制 a `char`out of `old_string[i]`，然后将 movw's it (from `dx`) 复制到`(%ecx,%ebx)`. 然后下一部分，复制`old_string[i+1]`、移动它、或对其进行排序，然后将其从 放置到同一个地方`ax`。它将两个 16 位值放在同一个地方？这不行吗？

此外，它转移`old_string[i+1]`到 的高位双字`eax`，然后将 ors `edx`( `new_string[x]`) 放入其中……然后放入`ax`内存！不会`ax`只包含已经存在的内容`new_string[x]`吗？所以它将同一件事保存到内存中的同一位置两次？

有什么我想念的吗？此外，我相当确定编译程序的其余部分与此代码段无关......我已经阅读了前后，以查找每个数组和不同变量的存储位置，以及寄存器的值将在到达该代码时——我认为这是对这些 C 行重要的程序集的唯一部分。

-- 哦，原来 GNU 程序集注释是以 # 开头的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-24T03:43:51.033

好的，毕竟这很简单。我用笔和纸算出来，写下每一步，它对每个寄存器做了什么，然后写下每个寄存器的内容，给定一个初始起始值......

让我感到惊讶的是，它使用 32 位和 16 位寄存器来存储 16 位和 8 位数据类型......这就是我认为正在发生的事情：

*   放入内存的第一个值，例如 0001（我在想 01）。
*   第二个值 (02) 加载到 32 位寄存器中（就像，00000002，我在想，0002）
*   第二个值左移 8 位（00000200，我在想，0200）
*   第一个值（0000001，我认为是 0001）异或到第二个值（00000201，我认为是 0201）
*   16位寄存器放入内存（0201，我在想，又是01）。

我不明白为什么它将它写入内存两次，或者为什么它使用 32 位寄存器（嗯，实际上，我的猜测是 32 位处理器在处理 32 位值时比使用 8 和16 位值，但这是一个完全没有根据的猜测），所以我尝试重写它：

```
movl -20(%ebp), %esi       #gets pointer to old_string
movsbw (%edi,%esi),%dx     #old_string[i] -> dx (0001)
movsbw 1(%edi,%esi),%ax    #old_string[i + 1] -> ax (0002)
salw $8, %ax               #shift ax left (0200)
orw %dx, %ax               #or dx into ax (0201)
movw %ax,(%ecx,%ebx,2)     #doesn't write to memory until end 
```

这完全一样。

我不知道这是否是一种优化（除了写出一个内存，这显然是），但如果是，我知道这并不值得，也没有给我任何好处。无论如何，我现在知道这段代码在做什么，感谢大家的帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-24T02:48:25.837

我不确定什么是不明白的，除非我错过了什么。

前 3 条指令将 old_string 中的一个字节加载到 dx 中，并将其存储到 new_string。

接下来的 3 条指令利用 dx 中已有的内容并将 old_string[i+1] 与其结合，并将其作为 16 位值 (ax) 存储到 new_string。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-24T02:50:14.413

> 此外，它将 old_string[i+1] 移动到 eax 的高位 dword，然后将 ors edx (new_string[x]) 移入其中……然后将 ax 放入内存！ax 不会只包含 new_string[x] 中已经存在的内容吗？所以它将同一件事保存到内存中的同一位置两次？

现在你明白为什么优化器是一件好事了。这种冗余代码经常出现在未优化的生成代码中，因为生成的代码或多或少来自不“知道”之前或之后发生了什么的模板。

# html - 覆盖样式表

> ID：902900
> 
> 赞同：1
> 
> 时间：2009-05-24T02:03:45.443
> 
> 标签：html, css

我有一个链接，我想在其中更改文本的颜色，使其远离我为超链接设置的颜色。我的代码是：

```
<span class="button"><%= link_to "Create new scenario", :action => "create" %></span> 
```

我的CSS是：

```
a:link { 
  color:rgb(50%, 15%, 5%);
  text-decoration:none; 
} 

.button {
  -moz-border-radius-bottomleft:6px;
  -moz-border-radius-bottomright:6px;
  -moz-border-radius-topleft:6px;
  -moz-border-radius-topright:6px;
  background-color:rgb(93%, 93%, 93%);
  border:1px solid black;
  color:black !important;
  line-height:1.9;
  margin:0 3px 3px 0;
  padding:4px 8px 4px 3px;
  text-decoration:none;
} 
```

由于某种原因，超链接文本仍然是棕色的，rgb(50%, 15%, 5%)。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-24T02:05:42.287

你可以制作一个 CSS 样式 .button a:link {color: black;}

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-24T02:09:59.080

更改您的 css 以使用 .button 类和具有 .button 父 css 类的锚点。如下所示：

```
.button,.button a:link {
  -moz-border-radius-bottomleft:6px;
  -moz-border-radius-bottomright:6px;
  -moz-border-radius-topleft:6px;
  -moz-border-radius-topright:6px;
  background-color:rgb(93%, 93%, 93%);
  border:1px solid black;
  color:black !important;
  line-height:1.9;
  margin:0 3px 3px 0;
  padding:4px 8px 4px 3px;
  text-decoration:none;
} 
```

**编辑：**请记住，这会导致边框重复并使超链接显示为没有下划线，因为 text-decoration:none。在这种情况下，最好的做法是有一个单独的 css 声明。

```
.button {....}
.button a:link {.....} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-24T02:11:01.013

我认为这是因为特殊性；`span`(.button) 与链接相比，对链接的特定性较低，因此`a:link`正在`a:link`应用样式（根据规范正确：[http://www.w3.org/TR/CSS2/cascade.html](http://www.w3.org/TR/CSS2/cascade.html)）。

如果你想覆盖`a:link`这个按钮的样式（或者......嗯，任何其他的以相同的方式）添加类到`<a>`标签而不是它的父元素。

尽管您可能会逃脱：

```
.button > a:link {/* styles */} 
```

这应该变得具体，因为这`<a>`是 class span 的后代`.button`。

### 编辑：

值得指出的是，“ `>`”选择器仅适用于直接后代，因此`a`类元素内部`.button`会受到影响，但类元素`a`内部的 div 内部`.button`不会受到影响。

IE也不支持这个选择器（当然低于版本7，我不知道版本7 - 或者，实际上，版本8）。相反，可以使用 ' `*`' 运算符：

```
.button * a:link {/* styles */} 
```

请记住，虽然至少在 5.x 版之后的 IE 中支持 - 我认为 - 它有点宽泛，因为它将针对`a`class 元素中的所有 s `.button`，而不管任何中间元素，并且仍然可能是比适用于`a:link`s 的任何规则都没有那么具体。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-24T02:37:35.623

“ `! important`”不是强求孩子的风格。用户可以覆盖网页作者指定的样式。在你的情况下它没有用。

正确的做法是：

```
.button {
  -moz-border-radius-bottomleft:6px;
  -moz-border-radius-bottomright:6px;
  -moz-border-radius-topleft:6px;
  -moz-border-radius-topright:6px;
  background-color:rgb(93%, 93%, 93%);
  border:1px solid black;
  color:black;
  line-height:1.9;
  margin:0 3px 3px 0;
  padding:4px 8px 4px 3px;
  text-decoration:none;
}

.button a {
  color:black;
} 
```

评论：

1.  " `.button > a`" 是个好主意，但它在 IE6 中不起作用。因此`.button a`这里应该使用“”是安全的。
2.  将 " `.button`" 和 " `.button a`" 放在一组样式中将使按钮边框重复。

# .net - 使用开发/测试/生产数据库流利的 NHibernate？

> ID：902902
> 
> 赞同：3
> 
> 时间：2009-05-24T02:05:17.530
> 
> 标签：.net, asp.net, nhibernate, fluent-nhibernate

我想知道是否有人根据应用程序的配置（类似于 Rails 的开发、测试和生产数据库）开发了一种将 NHibernate / Fluent NHibernate 与不同数据库一起使用的方法。我相信我可以通过使用具有条件属性的方法来获得一些工作，但我有兴趣了解其他方法的经验。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-24T02:22:08.497

您可以很容易地将 Fluent NHibernate 的配置与您的应用程序配置联系起来，而不是直接在代码中进行配置；这会让你根据你的环境替换你的配置文件。

```
Fluently.Configure()
  .Database(
    SQLiteConfig.Standard
      .ConnnectionString(c => c.FromAppSetting("your-key")))
  .Mappings(/* mappings */)
  .BuildSessionFactory(); 
```

# php - php静态函数

> ID：902909
> 
> 赞同：110
> 
> 时间：2009-05-24T02:11:17.627
> 
> 标签：php, class, static, member

我有一个关于 php 中的静态函数的问题。

假设我有一堂课

```
class test {
    public function sayHi() {
        echo 'hi';
    }
} 
```

如果我这样做`test::sayHi();`，它可以正常工作。

```
class test {
    public static function sayHi() {
        echo 'hi';
    }
} 
```

`test::sayHi();`也可以。

头等舱和二等舱有什么区别？

静态函数有什么特别之处？

* * *

## 回答 #1

> 赞同：157
> 
> 时间：2009-05-24T02:20:02.807

在第一个类中，`sayHi()`实际上是一个实例方法，您将其作为静态方法调用，并且您可以摆脱它，因为`sayHi()`从不引用`$this`.

静态函数与类相关联，而不是与类的实例相关联。因此，`$this`在静态上下文中不可用（`$this`不指向任何对象）。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2013-08-27T15:36:06.177

简单地说，静态函数的功能独立于它们所属的类。

$this 意味着，这是这个类的一个对象。它不适用于静态函数。

```
class test {
    public function sayHi($hi = "Hi") {
        $this->hi = $hi;
        return $this->hi;
    }
}
class test1 {
    public static function sayHi($hi) {
        $hi = "Hi";
        return $hi;
    }
}

//  Test
$mytest = new test();
print $mytest->sayHi('hello');  // returns 'hello'
print test1::sayHi('hello');    //  returns 'Hi' 
```

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2009-05-24T02:15:02.830

完全不同的是，您不会`$this`在静态函数内部获得供应。如果你尝试使用`$this`，你会得到一个`Fatal error: Using $this when not in object context`.

好吧，还有另一个区别：`E_STRICT`您的第一个示例会生成警告。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-09-02T18:40:32.567

静态调用非静态方法会生成 E_STRICT 级别的警告。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-24T02:17:28.380

简而言之，在第二种情况下，您没有 $this 对象，因为静态方法是类的函数/方法，而不是对象实例。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-12-30T07:52:02.610

在尝试了示例（PHP 5.3.5）之后，我发现在定义函数的两种情况下，您都不能使用`$this`运算符来处理类函数。所以我还找不到它们的区别。:(

# python - 数据存储以简化 Python 中的数据插值

> ID：902910
> 
> 赞同：6
> 
> 时间：2009-05-24T02:14:27.997
> 
> 标签：python, interpolation

我有 20 多个类似于表 1 的表。所有字母都代表实际值。

```
Table 1:
$ / cars |<1 | 2 | 3 | 4+
<10,000  | a | b | c | d
20,000   | e | f | g | h
30,000   | i | j | k | l
40,000+  | m | n | o | p 
```

例如，用户输入可以是 (2.4, 24594)，它是 f、g、j 和 k 之间的值。我的 Python 函数定义和计算这个双线性插值的伪代码如下。

```
def bilinear_interpolation( x_in, y_in, x_high, x_low, y_low, y_high ):
   # interpolate with respect to x
   # interpolate with respect to y
   # return result 
```

我应该如何存储表 1 中的数据（文件、字典、元组的元组或列表的字典），以便我可以最有效和正确地执行双线性插值？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-24T04:28:26.643

如果您想要我能想到的计算效率最高的解决方案并且不限于标准库，那么我会推荐 scipy/numpy。首先，将 a..p 数组存储为 2D numpy 数组，然后将 $4k-10k 和 1-4 数组存储为 1D numpy 数组。如果两个一维数组都是单调递增的，则使用 scipy 的 interpolate.interp1d ，如果不是，则使用 interpolate.bsplrep （双变量样条表示），并且您的示例数组与您的示例一样小。或者干脆自己写而不用 scipy。这里有些例子：

```
# this follows your pseudocode most closely, but it is *not*
# the most efficient since it creates the interpolation 
# functions on each call to bilinterp
from scipy import interpolate
import numpy
data = numpy.arange(0., 16.).reshape((4,4))  #2D array
prices = numpy.arange(10000., 50000., 10000.)
cars = numpy.arange(1., 5.)
def bilinterp(price,car):
    return interpolate.interp1d(cars, interpolate.interp1d(prices, a)(price))(car)
print bilinterp(22000,2) 
```

我最后一次检查（2007 年的 scipy 版本）只适用于 x 和 y 的单调递增数组）

对于像这个 4x4 数组这样的小数组，我想你想使用这个： [http](http://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.bisplrep.html#scipy.interpolate.bisplrep) ://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.bisplrep.html#scipy.interpolate.bisplrep 它将处理更有趣的形状表面和功能只需要创建一次。对于较大的数组，我认为您想要这个（不确定这是否与 interp1d 具有相同的限制）： [http://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.interp2d.html#scipy。 interpolate.interp2d](http://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.interp2d.html#scipy.interpolate.interp2d) 但它们都需要与上面示例中的三个数组不同且更详细的数据结构。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-24T02:25:32.390

我会保留第一列的排序列表，并使用`bisect`标准库中的模块来查找值——这是获得立即较低和立即较高索引的最佳方法。每隔一列可以保留为与该列平行的另一个列表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-24T02:23:35.730

双线性插值并没有什么特别之处，会让你的用例特别奇怪；您只需要进行两次查找（对于完整行/列的存储单元）或四次查找（对于数组类型的存储）。最有效的方法取决于您的访问模式和数据结构。

如果您的示例真正具有代表性，总共有 16 个条目，您可以根据需要存储它，它对于任何类型的正常加载都足够快。

# java - 微软商店中的 Java

> ID：902914
> 
> 赞同：0
> 
> 时间：2009-05-24T02:15:26.497
> 
> 标签：java, pdf-generation, xhtmlrenderer

我被介绍到了这个很棒的项目，[xhtmlrenderer；飞碟项目](http://code.google.com/p/flying-saucer//)。问题是，我工作的地方，严格来说是一家微软商店，自大学以来我没有做过任何 Java 开发，而且几年前还稍微接触过 WebSphere。

我想知道这些天做java开发需要什么？我设置了一个快速的概念验证，看看我是否可以用这个项目做我想做的事情，它工作得很好，但是，我使用了 jnbridge，它的许可证有点贵，但 Visual Studio 是我得心应手的，并且得到了一个小时的工作完成了。

我想知道这些天进行Java开发需要什么？servlet 仍然是常态吗？Apache 是我应该开始寻找启动并运行小型 Web 服务器的地方吗？Eclipse/Ganymede 是要使用的 IDE 吗？

基本上我想要做的是将一个 url 传递给服务并让它吐出一个 PDF。现在刚放假，一直在拨号上网，但不能停止思考这个问题。

我想我现在会发布这些想法，看看我是否可以开始下周的工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-24T02:21:38.963

Java 并没有*什么*不同，尽管泛型增加了一些刺激性。带有 iText 的 PDF 相当简单；IDE 世界和以往几乎一样。Eclipse 和 Netbeans 很常见，还有其他几种，真正的程序员仍然使用 EMACS。

Apache 非常通用，但考虑到 servlet，您可能会考虑 Tomcat。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-24T02:28:38.780

如果您想要一个足够小的 Web 服务器，您可以随时使用嵌入式[Jetty](http://www.mortbay.org/jetty/)。如果您需要 Tomcat 的完整服务，它也是可用的。对于 Java 开发，我使用[Eclipse](http://www.eclipse.org/)作为 IDE。它不仅免费，而且它对重构的支持领先于 Visual Studio。实际上，如果您使用过 WebSphere 开发环境，那么 Eclipse 会非常熟悉。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-24T02:38:27.667

Eclipse 无疑是没有预算的 IDE，NetBeans 也是免费的。我更喜欢 Intellij 的 IDEA，但对于听起来像是项目的一部分的东西，它可能不值得花钱。

就 servlet 等而言，它实际上取决于您正在寻找的架构/可扩展性。

如果您正在寻找需要作为小型 Web 界面运行的东西，那么像 Jetty 或带有基本 servlet 的 Tomcat 应该没问题。

您可能正在查看通过命令行调用的某些内容，尽管为每次转换启动 JVM 对于除了最琐碎的用途之外的所有用途来说都太繁重了，但是一个监视目录并从中提取内容以进行转换的小程序可能是你需要的。

如果您提供有关架构的更多详细信息以及您打算如何使用它，您可以获得一些更具体的建议。

总的来说，.NET 和 Java 开发非常相似（毕竟 .NET 开始与 Java 直接竞争），但真正的实际区别在于，很多 .NET 环境都是以银盘提供给您的。你需要一个 web 容器，你有 IIS，你需要一个数据库，你有 MS-SQL，你需要一个 IDE，你有 Visual Studio 等等等等。在 Java 开发中，这些都是要做出的选择，有对于很多事情来说，这并不是一个默认的明显好选择——有很多竞争对手。这可以为 Microsoft 商店创建比您预期的更大的曲线。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-24T10:08:32.247

考虑潜入 IKVM ( [http://www.ikvm.net/](http://www.ikvm.net/) )，因为它允许您在 .NET 环境中使用 Java 组件。

# java - 为什么 Java 中的“protected”修饰符允许访问同一包中的其他类？

> ID：902922
> 
> 赞同：47
> 
> 时间：2009-05-24T02:18:58.360
> 
> 标签：java, inheritance, protected

为什么在 Java 中，带有“protected”修饰符的成员不仅可以被同一个类和子类访问，而且可以被同一个包中的每个人访问？

我想知道语言设计的原因，而不是实际的应用程序（例如，测试）

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-05-24T02:22:30.147

这种设计基于包是适当的单元，由一个内部一致的团队维护和发布的想法；继承关系与谁维护和何时发布什么关系不大。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-05-24T03:18:04.030

修饰符[在 http://java.sun.com/docs/books/tutorial/java/javaOO/accesscontrol.html](http://java.sun.com/docs/books/tutorial/java/javaOO/accesscontrol.html)中有详细描述。从那里我们看到这个数字。

```
Modifier        Class     Package   Subclass  World
public          Y         Y         Y         Y
protected       Y         Y         Y         N
no modifier     Y         Y         N         N
private         Y         N         N         N 
```

由此可见，设计决策的原因是显而易见的：要有一个很好的对称矩阵。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-05-24T04:06:30.750

在 Java 1.0 中有第五个访问修饰符：`private protected`. 这是`protected`没有默认访问权限的。显然，它实际上从未真正正常工作，并在 1.1 中被删除。因此，似乎声称`protected`以总排序的方式定义似乎是虚假的。（**编辑：**似乎在 1.1 中删除了第五个访问修饰符的至少一个原因是缺少总排序干扰了重载选择规则。）`module`Java 7 中的访问修饰符在这方面有一些设计问题.

鉴于人们认为将成员的默认访问修饰符设置为“包私有”是一个好主意，因此`protected`至少应该具有这种访问级别似乎是合理的。为了我的钱，`protected`根本没有用语言支付。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-05-24T02:41:56.880

基本上它与将包视为 api 控制单元有关（因此建议使用您的域名启动包 - 保证全局唯一性），因此可见性从私有 -> 包私有 -> 受保护 -> 公有增长. 如果受保护的不是对包私有的增加，而是一种不同类型的可见性，那么在需要时必须有某种方法来组合这两种类型的可见性。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-24T02:44:19.557

考虑到访问级别，私有，包，受保护和公共的渐进级别，如果它受到保护然后包，这将是不必要的限制，因为这将迫使我允许子类访问以授予同一包的其他成员。然而，直观地说，同一个包中的其他类应该比“外面”的其他类更值得信赖。如此受保护的是在包和公共之间，因为它允许更广泛的访问权限。

我认为基本原因依赖于直觉，即同一个包中的类之间存在基本的“信任”水平。您可以合理地期望他们彼此做正确的事情 - 在大多数情况下，软件包将由单个工程师或团队负责，因此应该有一致的设计和谐。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-09-17T05:49:38.710

Java 本身确实遵循其设计原则。当您尝试减少/缩小子类中公共方法的范围时会发生什么？一个错误。Java 范围修饰符级别如下：private < (default) < protected < public

包中的所有类都应该是友好的，因为它们一起工作。为了使包中的成员可用，它在默认范围内定义。

子类可能驻留在包之外，再次遵循范围级别： private < (default) < protected < public - 我们不能缩小范围。受保护的范围比默认范围更广，因此**Java 不违背其自己的准则**。因此，受保护的成员将在默认范围内可用。另外：类<包<项目。

请不要将修饰符限制为仅可见性，但继承、结构也在同时工作，并将它们添加到图片中。如果这是真的：private < protected < (default) < public. 那么所有子类都必须驻留在同一个包中，那么为什么需要继承你可以访问所有内容，因为默认范围适用于包级别。默认范围将失去其价值，继承也是如此。

# c# - C# XML 序列化 double[] 到单个空格分隔的元素

> ID：902924
> 
> 赞同：3
> 
> 时间：2009-05-24T02:19:53.930
> 
> 标签：c#, xml-serialization

我正在用 C# 编写一个应用程序，以将双精度或浮点数的数组序列化为单个 XML 元素，该元素是数组中值的空格分隔列表。

```
double[] d = new double[4] { 1.0, 2.0, 3.0, 4.0 }; 
```

到 XML 元素：

```
<ArrayOfDouble type="double">1.0 2.0 3.0 4.0</ArrayOfDouble> 
```

我正在尝试使用 XmlSerializer 来执行序列化。任何有关如何简单地完成此操作的帮助将不胜感激。

蒂姆

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-24T02:26:30.983

您可以尝试以下方法。我的示例使用 LINQ。如果您使用的是 VS2005 或更早版本，请告诉我，我会更新答案。

```
class Example {
  [XmlIgnore]
  public double[] DoubleValue { get ... set ... }

  public string ArrayOfDouble {
    get { return DoubleValue.Select(x => x.ToString()).Aggregate( (x,y) => x + " " + y); }
    set { Doublevalue = value.Split(' ').Select(x => Double.Parse(x)).ToArray(); }
  }
} 
```

# networking - TCP校验和的错误率？

> ID：902938
> 
> 赞同：4
> 
> 时间：2009-05-24T02:30:31.210
> 
> 标签：networking, tcp, udp

TCP 和 UDP（有时）使用简单的校验和来确保内容正确。

我想知道的是任何经验数据或估计数据包损坏的频率，但对于具有标准计算机和互联网连接的人来说具有正确的校验和。

现在我知道这可能因 ISP 质量、硬件质量等而有很大差异，但我只想听听有关这方面的任何信息。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-24T02:37:05.220

你问一根绳子有多长。一般来说，除非出现问题，否则错误率应该小于 10 ^(-7)。另一方面，无线、3G 等可能具有显着更高的错误率。

[这个谷歌搜索](http://www.google.com/search?client=safari&rls=en-us&q=internet+data+error+rate+TCP+empirical&ie=UTF-8&oe=UTF-8)会告诉你有**很多**文献。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-01-24T13:36:01.260

来自微软研究院，

> 过去两年的互联网数据包跟踪表明，1,100 个数据包中的 1 个数据包和 32,000 个数据包中的 1 个数据包之间的 TCP 校验和失败，即使在链路级 CRC 应该捕获除 40 亿分之一之外的所有错误的链路上也是如此。在某些情况下，校验和失败率可能更高：在一小时的测试中，我们观察到 400 个数据包中有 1 个数据包的校验和失败。我们调查了为什么会观察到如此多的错误，而链路级 CRC 应该捕获几乎所有的他们。

[http://academic.research.microsoft.com/Paper/22436.aspx](http://academic.research.microsoft.com/Paper/22436.aspx)

基本上通过典型的 Internet 连接传输 100MB+，您很可能会看到无声故障。

# .net - 我的 ListView 回调检索子项有什么问题？

> ID：902941
> 
> 赞同：0
> 
> 时间：2009-05-24T02:33:10.157
> 
> 标签：.net, winforms, .net-3.5, listview, callback

我正在尝试从另一个线程中检索我的 ListView 中的 SubItem，但我一直在获取 Item 而不是 SubItem。我不确定如何正确编码。下面是我正在使用的代码：

```
Delegate Function lvExtractedCallback(ByVal x As Integer) As String

Private Function lvExtracted(ByVal x As Integer) As String
    Static Dim lvName As String

    If Me.OptionsList.InvokeRequired Then
        Dim lvEC As New lvExtractedCallback(AddressOf lvExtracted)
        Me.Invoke(lvEC, (New Object() {x}))
    Else
        lvName = OptionsList.Items.Item(x).SubItems.Item(0).Text
    End If
    Return lvName
End Function

Private Sub GetSubItem()
    Dim subItemText as String
    For i as Integer = 0 to 15
        subItemText = lvExtracted(x)
        Debug.Print subItemText
    Next
End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-24T03:32:21.943

该代码只会获取 ListViewItem 的主要文本，因为您每次都为第 X 个项目返回 SubItem.Item(0)。SubItem.Item(0) 是项目的文本字段。如果您只想获得第一个子项，请将 SubItem.Item(0) 更改为 SubItems.Item(1)。如果要获取任意子项，请参见下面的示例。

来自 MSDN：

```
The first subitem in the ListViewItem::ListViewSubItemCollection is always 
the item that owns the subitems. When performing operations on subitems in the
collection, be sure to reference index position 1 instead of 0 to make changes
to the first subitem. 
```

示例：

```
Delegate Function lvExtractedCallback(ByVal x As Integer, ByVal y As Integer) As String

Private Function lvExtracted(ByVal x As Integer, ByVal y As Integer) As String
    Static Dim lvName As String

    If Me.OptionsList.InvokeRequired Then
        Dim lvEC As New lvExtractedCallback(AddressOf lvExtracted)
        Me.Invoke(lvEC, (New Object() {x, y}))  '<-- This may need to be fixed, I'm rusty at VB.
    Else
        lvName = OptionsList.Items.Item(x).SubItems.Item(y).Text
    End If
    Return lvName
End Function 
```

# asp.net - 在 ASP.Net 中批量编辑 GridView

> ID：902943
> 
> 赞同：0
> 
> 时间：2009-05-24T02:35:35.177
> 
> 标签：asp.net, gridview, checkbox, editing

在 ASP.net 中实现网格视图批量编辑的最佳方法是什么？我不希望用户必须单击每一行上的编辑来更改它。如果他们可以进行所有更改然后一次性提交它们会更好。

我想要的是类似的东西

* * *

项目 1 xxxx

项目 2 xxxx

项目 3 xxxx

提交

* * *

其中 xa 复选框。

网格视图甚至是实现这一目标的好方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-11-19T17:39:48.297

这是一个支持批量编辑的 GridView：http: [//blogs.msdn.com/b/mattdotson/archive/2005/11/09/real-world-gridview-bulk-editing.aspx](http://blogs.msdn.com/b/mattdotson/archive/2005/11/09/real-world-gridview-bulk-editing.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-29T18:59:22.503

尝试这个：

在您的 gridview 中创建一个带有文本框的模板列，然后用数据绑定器填充所有内容，以便从数据库中获取默认数据。将您的页面放在底部，并在此底部创建一个 for 循环，以加载所有 gridview 行并搜索您创建的模板列。找到文本框并将其写入数据集。接下来，您可以使用我在此[线程](https://stackoverflow.com/questions/982135/dataset-questions/1051615#1051615)中发布的代码，用一行保存所有数据集。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-06-22T20:03:37.117

[RealWorldGrids](http://aspnetrealworldcontr.codeplex.com/)的 BulkEditGridview 可以满足您的需求。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-24T12:56:11.597

我想知道 Matt Berseth 关于批量插入的帖子（在列表视图中，但它可能对您有所帮助）是否有帮助，试试看：

[http://mattberseth.com/blog/2008/05/bulk_inserting_data_with_the_l.html](http://mattberseth.com/blog/2008/05/bulk_inserting_data_with_the_l.html)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-24T04:49:31.587

您应该能够在 RowDataBound 期间将[GridViewRow.RowState设置为 Edit。](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridviewrow.rowstate.aspx)只要确保 RowType 是 DataRow。

# bash - 关于.bash_profile，.bashrc，别名应该写在哪里？

> ID：902946
> 
> 赞同：142
> 
> 时间：2009-05-24T02:37:21.553
> 
> 标签：bash, shell, environment

> **可能重复：** [.bashrc、.bash_profile 和 .environment 之间有什么区别？](https://stackoverflow.com/questions/415403/whats-the-difference-between-bashrc-bash-profile-and-environment)

看来，如果我使用

```
alias ls='ls -F' 
```

在 Mac OS X 上的 .bashrc 中，那么新创建的 shell 将没有该别名。我需要`bash`再次输入，该别名将生效。

如果我在托管公司登录 Linux，该`.bashrc`文件有一个注释行，上面写着：

> 对于非登录外壳

该`.bash_profile`文件有一条评论说

> 用于登录外壳

那么别名应该写在哪里呢？我们如何将登录 shell 和非登录 shell 分开？

一些网页说使用`.bash_aliases`，但它似乎不适用于 Mac OS X。

* * *

## 回答 #1

> 赞同：182
> 
> 时间：2009-05-24T02:42:47.533

*将登录*shell和*非登录*shell分开的原因是，`.bashrc`每次启动 Bash 的新副本时都会重新加载该文件。`.profile`仅当您登录或使用适当的标志告诉 Bash 充当登录 shell 时才会加载该文件。

亲自，

*   我将我的`PATH`设置放入一个`.profile`文件中（因为我有时会使用其他 shell）；
*   我将我的 Bash 别名和函数放入我的`.bashrc`文件中；
*   我把这个

    ```
    #!/bin/bash
    #
    # CRM .bash_profile Time-stamp: "2008-12-07 19:42"
    #
    # echo "Loading ${HOME}/.bash_profile"
    source ~/.profile # get my PATH setup
    source ~/.bashrc  # get my Bash aliases 
    ```

    在我的`.bash_profile`档案中。

哦，您需要`bash`再次键入以获取新别名的原因是 Bash`.bashrc`在启动时会加载您的文件，但除非您告诉它，否则它不会重新加载它。您可以`.bashrc`通过键入重新加载文件（并且不需要第二个 shell）

```
source ~/.bashrc 
```

它会加载`.bashrc`文件，就像您直接向 Bash 键入命令一样。

* * *

## 回答 #2

> 赞同：138
> 
> 时间：2009-05-24T06:22:37.773

查看[http://mywiki.wooledge.org/DotFiles](http://mywiki.wooledge.org/DotFiles)除了`man bash`.

概括：

*   您只需登录一次，这就是读取和执行`~/.bash_profile`or的时间。`~/.profile`由于您从登录 shell 运行的所有内容都继承了登录 shell 的环境，因此您应该将所有**环境变量**放在那里。像`LESS`, `PATH`, `MANPATH`, `LC_*`, ... 例如，请参阅：[我的`.profile`](http://stuff.lhunath.com/.profile)
*   登录后，您可以再运行几个 shell。想象一下登录、运行 X，然后在 X 中使用 bash shell 启动一些终端。这意味着你的登录 shell 启动了 X，它继承了你的登录 shell 的环境变量，它启动了你的终端，它启动了你的非登录 bash shell。您的环境变量在整个链中传递，因此您的非登录 shell 不再需要加载它们。由于这个确切原因，非登录 shell 只执行`~/.bashrc`，不执行`/.profile`或`~/.bash_profile`，因此在其中定义**仅适用于 bash**的所有内容。那是函数、别名、**仅限 bash 的变量，例如 HISTSIZE（这不是环境变量，不要导出它！）**`set` 、带有and的shell 选项`shopt`等。例如，请参阅：[我的`.bashrc`](http://stuff.lhunath.com/.bashrc)
*   现在，作为 UNIX 特性的一部分，login-shell 不会执行`~/.bashrc`，而只会执行`~/.profile`or `~/.bash_profile`，因此您应该从后者手动获取它。你会看到我在我的`~/.profile`也是这样做的：`source ~/.bashrc`。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-05-24T02:46:23.080

从 bash 手册页：

> 当 bash 作为交互式登录 shell 或作为带有 `--login`选项的非交互式 shell 调用时，它首先从文件中读取并执行命令 `/etc/profile`（如果该文件存在）。读取该文件后，它会按顺序查找 `~/.bash_profile`、`~/.bash_login`和 `~/.profile`，并从第一个存在且可读的文件中读取并执行命令。`--noprofile`当 shell 启动时可以使用该 选项来禁止这种行为。
> 
> 当登录 shell 退出时，bash 会从文件`~/.bash_logout`中读取并执行命令（如果存在）。
> 
> 当一个不是登录 shell 的交互式 shell 启动时，bash 读取并执行来自 的命令`~/.bashrc`（如果该文件存在）。这可以通过使用该`--norc`选项来禁止。file 选项将`--rcfile`强制 bash 从 file 而不是 `~/.bashrc`.

因此，如果您想为登录 shell 和交互式非登录 shell 获得相同的行为，您应该将所有命令放在`.bashrc`or`.bash_profile`中，然后将另一个文件[源](http://www.gnu.org/software/bash/manual/bashref.html#index-source-144)放在第一个。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-24T02:42:07.783

`.bash_profile`为“登录外壳”加载。我不确定在 OS X 上会是什么，但在 X11 或虚拟终端的 Linux 上。

`.bashrc`每次运行 Bash 时都会加载。每当您打开一个新的 Terminal.app 窗口时，您都应该在此处放置要加载的内容。

我个人将所有内容都放入其中，`.bashrc`这样我就不必重新启动应用程序以使更改生效。

# iphone - iPhone：将日期字符串转换为相对时间戳

> ID：902950
> 
> 赞同：39
> 
> 时间：2009-05-24T02:39:55.060
> 
> 标签：iphone, objective-c, cocoa, datetime, time

我有一个时间戳作为字符串，如：

> 09 年 5 月 21 日星期四 19:10:09 -0700

我想将其转换为相对时间戳，例如“20 分钟前”或“3 天前”。

在 iPhone 上使用 Objective-C 的最佳方法是什么？

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2009-05-31T14:34:44.583

```
-(NSString *)dateDiff:(NSString *)origDate {
    NSDateFormatter *df = [[NSDateFormatter alloc] init];
    [df setFormatterBehavior:NSDateFormatterBehavior10_4];
    [df setDateFormat:@"EEE, dd MMM yy HH:mm:ss VVVV"];
    NSDate *convertedDate = [df dateFromString:origDate];
    [df release];
    NSDate *todayDate = [NSDate date];
    double ti = [convertedDate timeIntervalSinceDate:todayDate];
    ti = ti * -1;
    if(ti < 1) {
        return @"never";
    } else  if (ti < 60) {
        return @"less than a minute ago";
    } else if (ti < 3600) {
        int diff = round(ti / 60);
        return [NSString stringWithFormat:@"%d minutes ago", diff];
    } else if (ti < 86400) {
        int diff = round(ti / 60 / 60);
        return[NSString stringWithFormat:@"%d hours ago", diff];
    } else if (ti < 2629743) {
        int diff = round(ti / 60 / 60 / 24);
        return[NSString stringWithFormat:@"%d days ago", diff];
    } else {
        return @"never";
    }   
} 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-05-24T06:06:15.013

以下是来自 Cocoa 的方法，可帮助您获取相关信息（不确定它们是否都可用于 coca-touch）。

```
 NSDate * today = [NSDate date];
    NSLog(@"today: %@", today);

    NSString * str = @"Thu, 21 May 09 19:10:09 -0700";
    NSDate * past = [NSDate dateWithNaturalLanguageString:str
                            locale:[[NSUserDefaults 
                            standardUserDefaults] dictionaryRepresentation]];

    NSLog(@"str: %@", str);
    NSLog(@"past: %@", past);

    NSCalendar *gregorian = [[NSCalendar alloc]
                             initWithCalendarIdentifier:NSGregorianCalendar];
    unsigned int unitFlags = NSYearCalendarUnit | NSMonthCalendarUnit | 
                             NSDayCalendarUnit | 
                             NSHourCalendarUnit | NSMinuteCalendarUnit | 
                             NSSecondCalendarUnit;
    NSDateComponents *components = [gregorian components:unitFlags
                                                fromDate:past
                                                  toDate:today
                                                 options:0];

    NSLog(@"months: %d", [components month]);
    NSLog(@"days: %d", [components day]);
    NSLog(@"hours: %d", [components hour]);
    NSLog(@"seconds: %d", [components second]); 
```

NSDateComponents 对象似乎保留了相关单位的差异（如指定的那样）。如果您指定所有单位，则可以使用此方法：

```
void dump(NSDateComponents * t)
{
    if ([t year]) NSLog(@"%d years ago", [t year]);
    else if ([t month]) NSLog(@"%d months ago", [t month]);
    else if ([t day]) NSLog(@"%d days ago", [t day]);
    else if ([t minute]) NSLog(@"%d minutes ago", [t minute]);
    else if ([t second]) NSLog(@"%d seconds ago", [t second]);
} 
```

如果你想自己计算，你可以看看：

```
NSDate timeIntervalSinceDate 
```

然后在算法中使用秒。

**免责声明**：如果此界面已被弃用（我尚未检查），Apple 的首选方式 via `NSDateFormatters`，正如下面评论中所建议的那样，看起来也很整洁 - 由于历史原因，我会保留我的答案，它可能仍然是对某些人查看使用的逻辑很有用。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-08-04T04:21:34.440

我还不能编辑，但我采用了 Gilean 的代码并进行了一些调整，并将其设为 NSDateFormatter 的类别。

它接受格式字符串，因此可以使用任意字符串，并且我添加了 if 子句以使单数事件在语法上是正确的。

干杯，

卡尔厘米

```
@interface NSDateFormatter (Extras)
+ (NSString *)dateDifferenceStringFromString:(NSString *)dateString
                                  withFormat:(NSString *)dateFormat;

@end

@implementation NSDateFormatter (Extras)

+ (NSString *)dateDifferenceStringFromString:(NSString *)dateString
                                  withFormat:(NSString *)dateFormat
{
  NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];
  [dateFormatter setFormatterBehavior:NSDateFormatterBehavior10_4];
  [dateFormatter setDateFormat:dateFormat];
  NSDate *date = [dateFormatter dateFromString:dateString];
  [dateFormatter release];
  NSDate *now = [NSDate date];
  double time = [date timeIntervalSinceDate:now];
  time *= -1;
  if(time < 1) {
    return dateString;
  } else if (time < 60) {
    return @"less than a minute ago";
  } else if (time < 3600) {
    int diff = round(time / 60);
    if (diff == 1) 
      return [NSString stringWithFormat:@"1 minute ago", diff];
    return [NSString stringWithFormat:@"%d minutes ago", diff];
  } else if (time < 86400) {
    int diff = round(time / 60 / 60);
    if (diff == 1)
      return [NSString stringWithFormat:@"1 hour ago", diff];
    return [NSString stringWithFormat:@"%d hours ago", diff];
  } else if (time < 604800) {
    int diff = round(time / 60 / 60 / 24);
    if (diff == 1) 
      return [NSString stringWithFormat:@"yesterday", diff];
    if (diff == 7) 
      return [NSString stringWithFormat:@"last week", diff];
    return[NSString stringWithFormat:@"%d days ago", diff];
  } else {
    int diff = round(time / 60 / 60 / 24 / 7);
    if (diff == 1)
      return [NSString stringWithFormat:@"last week", diff];
    return [NSString stringWithFormat:@"%d weeks ago", diff];
  }   
}

@end 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2011-06-28T15:36:15.240

为了完整起见，根据@Gilean 的回答，这里是 NSDate 上一个简单类别的完整代码，它模仿了 rails 的漂亮日期助手。对于类别的复习，这些是您可以在 NSDate 对象上调用的实例方法。所以，如果我有一个代表昨天的 NSDate，[myDate distanceOfTimeInWordsToNow] => "1 day"。

希望它有用！

```
@interface NSDate (NSDate_Relativity)

-(NSString *)distanceOfTimeInWordsSinceDate:(NSDate *)aDate;
-(NSString *)distanceOfTimeInWordsToNow;

@end

@implementation NSDate (NSDate_Relativity)

-(NSString *)distanceOfTimeInWordsToNow {
    return [self distanceOfTimeInWordsSinceDate:[NSDate date]];

}

-(NSString *)distanceOfTimeInWordsSinceDate:(NSDate *)aDate {
    double interval = [self timeIntervalSinceDate:aDate];

    NSString *timeUnit;
    int timeValue;

    if (interval < 0) {
        interval = interval * -1;        
    }

    if (interval< 60) {
        return @"seconds";

    } else if (interval< 3600) { // minutes

        timeValue = round(interval / 60);

        if (timeValue == 1) {
            timeUnit = @"minute";

        } else {
            timeUnit = @"minutes";

        }

    } else if (interval< 86400) {
        timeValue = round(interval / 60 / 60);

        if (timeValue == 1) {
            timeUnit = @"hour";

        } else {
            timeUnit = @"hours";
        }

    } else if (interval< 2629743) {
        int days = round(interval / 60 / 60 / 24);

        if (days < 7) {

            timeValue = days;

            if (timeValue == 1) {
                timeUnit = @"day";
            } else {
                timeUnit = @"days";
            }

        } else if (days < 30) {
            int weeks = days / 7;

            timeValue = weeks;

            if (timeValue == 1) {
                timeUnit = @"week";
            } else {
                timeUnit = @"weeks";
            }

        } else if (days < 365) {

            int months = days / 30;
            timeValue = months;

            if (timeValue == 1) {
                timeUnit = @"month";
            } else {
                timeUnit = @"months";
            }

        } else if (days < 30000) { // this is roughly 82 years. After that, we'll say 'forever'
            int years = days / 365;
            timeValue = years;

            if (timeValue == 1) {
                timeUnit = @"year";
            } else {
                timeUnit = @"years";
            }

        } else {
            return @"forever ago";
        }
    }

    return [NSString stringWithFormat:@"%d %@", timeValue, timeUnit];

}

@end 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2013-09-12T19:58:55.297

已经有很多答案可以得出相同的解决方案，但有选择也无妨。这就是我想出的。

```
- (NSString *)stringForTimeIntervalSinceCreated:(NSDate *)dateTime
{
    NSDictionary *timeScale = @{@"second":@1,
                                @"minute":@60,
                                @"hour":@3600,
                                @"day":@86400,
                                @"week":@605800,
                                @"month":@2629743,
                                @"year":@31556926};
    NSString *scale;
    int timeAgo = 0-(int)[dateTime timeIntervalSinceNow];
    if (timeAgo < 60) {
        scale = @"second";
    } else if (timeAgo < 3600) {
        scale = @"minute";
    } else if (timeAgo < 86400) {
        scale = @"hour";
    } else if (timeAgo < 605800) {
        scale = @"day";
    } else if (timeAgo < 2629743) {
        scale = @"week";
    } else if (timeAgo < 31556926) {
        scale = @"month";
    } else {
        scale = @"year";
    }

    timeAgo = timeAgo/[[timeScale objectForKey:scale] integerValue];
    NSString *s = @"";
    if (timeAgo > 1) {
        s = @"s";
    } 
    return [NSString stringWithFormat:@"%d %@%@ ago", timeAgo, scale, s];
} 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2012-07-26T02:03:29.567

我采用了 Carl Coryell-Martin 的代码并制作了一个更简单的 NSDate 类别，它没有关于单数字符串格式的警告，并且还整理了一周前的单数：

```
@interface NSDate (Extras)
- (NSString *)differenceString;
@end

@implementation NSDate (Extras)

- (NSString *)differenceString{
    NSDate* date = self;
    NSDate *now = [NSDate date];
    double time = [date timeIntervalSinceDate:now];
    time *= -1;
    if (time < 60) {
        int diff = round(time);
        if (diff == 1)
            return @"1 second ago";
        return [NSString stringWithFormat:@"%d seconds ago", diff];
    } else if (time < 3600) {
        int diff = round(time / 60);
        if (diff == 1)
            return @"1 minute ago";
        return [NSString stringWithFormat:@"%d minutes ago", diff];
    } else if (time < 86400) {
        int diff = round(time / 60 / 60);
        if (diff == 1)
            return @"1 hour ago";
        return [NSString stringWithFormat:@"%d hours ago", diff];
    } else if (time < 604800) {
        int diff = round(time / 60 / 60 / 24);
        if (diff == 1)
            return @"yesterday";
        if (diff == 7)
            return @"a week ago";
        return[NSString stringWithFormat:@"%d days ago", diff];
    } else {
        int diff = round(time / 60 / 60 / 24 / 7);
        if (diff == 1)
            return @"a week ago";
        return [NSString stringWithFormat:@"%d weeks ago", diff];
    }   
}

@end 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2015-01-14T22:32:06.150

**在斯威夫特**

用法：

```
let time = NSDate(timeIntervalSince1970: timestamp).timeIntervalSinceNow
let relativeTimeString = NSDate.relativeTimeInString(time)
println(relativeTimeString) 
```

延期：

```
extension NSDate {
    class func relativeTimeInString(value: NSTimeInterval) -> String {
        func getTimeData(value: NSTimeInterval) -> (count: Int, suffix: String) {
            let count = Int(floor(value))
            let suffix = count != 1 ? "s" : ""
            return (count: count, suffix: suffix)
        }

        let value = -value
        switch value {
            case 0...15: return "just now"

            case 0..<60:
                let timeData = getTimeData(value)
                return "\(timeData.count) second\(timeData.suffix) ago"

            case 0..<3600:
                let timeData = getTimeData(value/60)
                return "\(timeData.count) minute\(timeData.suffix) ago"

            case 0..<86400:
                let timeData = getTimeData(value/3600)
                return "\(timeData.count) hour\(timeData.suffix) ago"

            case 0..<604800:
                let timeData = getTimeData(value/86400)
                return "\(timeData.count) day\(timeData.suffix) ago"

            default:
                let timeData = getTimeData(value/604800)
                return "\(timeData.count) week\(timeData.suffix) ago"
        }
    }
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-24T06:04:27.607

使用 NSDate 类：

```
timeIntervalSinceDate 
```

返回以秒为单位的间隔。

在objective-c中实现这一点的快速练习：

1.  “现在”获取时间 NSDate
2.  获取您想要比较的 NSDate
3.  使用 timeIntervalSinceDate 获取以秒为单位的间隔

然后实现这个伪代码：

```
if (x < 60) // x seconds ago

else if( x/60 < 60) // floor(x/60) minutes ago

else if (x/(60*60) < 24) // floor(x/(60*60) hours ago

else if (x/(24*60*60) < 7) // floor(x(24*60*60) days ago 
```

等等...

那么你需要决定一个月是 30,31 还是 28 天。保持简单 - 选择 30。

可能有更好的方法，但它是凌晨 2 点，这是我想到的第一件事......

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-07-19T20:09:43.853

我的解决方案：

```
- (NSString *) dateToName:(NSDate*)dt withSec:(BOOL)sec {

    NSLocale *locale = [NSLocale currentLocale];
    NSTimeInterval tI = [[NSDate date] timeIntervalSinceDate:dt];
    if (tI < 60) {
      if (sec == NO) {
           return NSLocalizedString(@"Just Now", @"");
       }
       return [NSString stringWithFormat:
                 NSLocalizedString(@"%d seconds ago", @""),(int)tI];
     }
     if (tI < 3600) {
       return [NSString stringWithFormat:
                 NSLocalizedString(@"%d minutes ago", @""),(int)(tI/60)];
     }
     if (tI < 86400) {
      return [NSString stringWithFormat:
                 NSLocalizedString(@"%d hours ago", @""),(int)tI/3600];
     }

     NSDateFormatter *relativeDateFormatter = [[NSDateFormatter alloc] init];
     [relativeDateFormatter setTimeStyle:NSDateFormatterNoStyle];
     [relativeDateFormatter setDateStyle:NSDateFormatterMediumStyle];
     [relativeDateFormatter setDoesRelativeDateFormatting:YES];
     [relativeDateFormatter setLocale:locale];

     NSString * relativeFormattedString = 
            [relativeDateFormatter stringForObjectValue:dt];
     return relativeFormattedString;
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-24T09:01:31.697

不知道为什么这不是可可触摸，我很好的标准方法会很棒。

设置一些类型来保存数据，如果你需要更多地本地化它会更容易。（如果您需要更多时间段，显然可以扩展）

```
typedef struct DayHours {
    int Days;
    double Hours;
} DayHours;

+ (DayHours) getHourBasedTimeInterval:(double) hourBased withHoursPerDay:(double) hpd
{
    int NumberOfDays = (int)(fabs(hourBased) / hpd);
    float hoursegment = fabs(hourBased) - (NumberOfDays * hpd);
    DayHours dh;
    dh.Days = NumberOfDays;
    dh.Hours = hoursegment;
    return dh;
} 
```

注意：我正在使用基于小时的计算，因为这就是我的数据所在。NSTimeInterval 是基于秒的。我还必须在两者之间进行转换。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-04-19T01:28:32.077

我在 Stack Overflow 上的代码片段中看到了好几次以前的函数，我想要一个真正给出最清晰的时间感的函数（因为发生了一些动作）。对我来说，这意味着短时间间隔（5 分钟前，2 小时前）的“时间前”样式和较长时间段的特定日期（2011 年 4 月 15 日而不是 2 年前）。基本上，我认为 Facebook 在这方面做得非常好，我想以他们的例子为例（因为我确信他们对此进行了很多思考，从消费者的角度来看，这很容易理解）。

经过长时间的谷歌搜索，我很惊讶地发现，据我所知，没有人实施过这个。决定我希望它足够糟糕以花时间写作并认为我会分享。

希望你喜欢 ：）

在此处获取代码：[https ://github.com/nikilster/NSDate-Time-Ago](https://github.com/nikilster/NSDate-Time-Ago)

# windows - 什么是 Windows 句柄？

> ID：902967
> 
> 赞同：169
> 
> 时间：2009-05-24T02:51:48.140
> 
> 标签：windows, handle

在 Windows 中讨论资源时，什么是“句柄”？它们是如何工作的？

* * *

## 回答 #1

> 赞同：195
> 
> 时间：2009-05-24T02:54:26.450

它是对资源的抽象引用值，通常是内存或打开的文件或管道。

*正确地*说，在 Windows 中（通常在计算中），句柄是一种抽象，它向 API 用户隐藏真实内存地址，允许系统对程序透明地重新组织物理内存。将句柄解析为指针会锁定内存，释放句柄会使指针无效。在这种情况下，可以将其视为指针表的索引……您将索引用于系统 API 调用，系统可以随意更改表中的指针。

或者，当 API 编写者希望 API 的用户与返回的地址指向的具体内容隔离开时，可以给出一个真正的指针作为句柄；在这种情况下，必须考虑句柄指向的内容可能随时更改（从 API 版本到版本，甚至从返回句柄的 API 的调用到调用） - 因此句柄应被视为简单的不透明值*仅对*API有意义。

我应该补充一点，在任何现代操作系统中，即使是所谓的“真实指针”仍然是进程虚拟内存空间的不透明句柄，这使得 O/S 能够管理和重新排列内存而不会使进程内的指针失效.

* * *

## 回答 #2

> 赞同：110
> 
> 时间：2009-05-24T03:09:16.637

A`HANDLE`是特定于上下文的唯一标识符。通过上下文特定，我的意思是从一个上下文获得的句柄不一定用于任何其他也适用于`HANDLE`s 的任意上下文。

例如，`GetModuleHandle`为当前加载的模块返回一个唯一标识符。返回的句柄可以在其他接受模块句柄的函数中使用。它不能提供给需要其他类型句柄的函数。例如，您不能给出一个从`GetModuleHandle`to返回的句柄`HeapDestroy`并期望它做一些明智的事情。

`HANDLE`本身只是一个整数类型。通常，但不一定，它是指向某个底层类型或内存位置的指针。例如，`HANDLE`返回的`GetModuleHandle`实际上是一个指向模块的基本虚拟内存地址的指针。但是没有规定句柄必须是指针。句柄也可以只是一个简单的整数（可能被某些 Win32 API 用作数组的索引）。

`HANDLE`s 是故意不透明的表示，提供对内部 Win32 资源的封装和抽象。这样，Win32 API 可能会更改 HANDLE 背后的底层类型，而不会以任何方式影响用户代码（至少是这样的想法）。

考虑一下我刚刚编写的 Win32 API 的这三个不同的内部实现，并假设它`Widget`是一个`struct`.

```
Widget * GetWidget (std::string name)
{
    Widget *w;

    w = findWidget(name);

    return w;
} 
```

```
void * GetWidget (std::string name)
{
    Widget *w;

    w = findWidget(name);

    return reinterpret_cast<void *>(w);
} 
```

```
typedef void * HANDLE;

HANDLE GetWidget (std::string name)
{
    Widget *w;

    w = findWidget(name);

    return reinterpret_cast<HANDLE>(w);
} 
```

第一个示例公开了有关 API 的内部细节：它允许用户代码知道`GetWidget`返回一个指向`struct Widget`. 这有几个后果：

*   用户代码必须有权访问定义`Widget`结构的头文件
*   用户代码可能会修改返回`Widget`结构的内部部分

这两种后果都可能是不可取的。

第二个示例通过仅返回`void *`. 用户代码不需要访问定义`Widget`结构的标头。

第三个示例与第二个示例完全相同，但我们只是将其称为`void *`a `HANDLE`。也许这会阻止用户代码试图找出确切的`void *`指向。

为什么要经历这个麻烦？考虑这个相同 API 的新版本的第四个示例：

```
typedef void * HANDLE;

HANDLE GetWidget (std::string name)
{
    NewImprovedWidget *w;

    w = findImprovedWidget(name);

    return reinterpret_cast<HANDLE>(w);
} 
```

请注意，该函数的接口与上面的第三个示例相同。这意味着用户代码可以继续使用这个新版本的 API，而无需进行任何更改，即使“幕后”实现已更改为使用`NewImprovedWidget`结构体。

这些示例中的句柄实际上只是一个新的、可能更友好的名称 for `void *`，这正是 Win32 API 中的 a （[在 MSDN](http://msdn.microsoft.com/en-us/library/aa383751(VS.85).aspx)`HANDLE`中查找）。它在用户代码和 Win32 库的内部表示之间提供了一道不透明的墙，从而增加了使用 Win32 API 的代码在 Windows 版本之间的可移植性。

* * *

## 回答 #3

> 赞同：41
> 
> 时间：2009-05-24T02:58:53.087

Win32 编程中的 HANDLE 是表示由 Windows 内核管理的资源的标记。句柄可以是窗口、文件等。

句柄只是一种识别要使用 Win32 API 处理的特定资源的方法。

因此，例如，如果您想创建一个 Window，并将其显示在屏幕上，您可以执行以下操作：

```
// Create the window
HWND hwnd = CreateWindow(...); 
if (!hwnd)
   return; // hwnd not created

// Show the window.
ShowWindow(hwnd, SW_SHOW); 
```

在上面的示例中，HWND 表示“窗口句柄”。

如果您习惯于面向对象的语言，您可以将 HANDLE 视为没有方法的类的实例，其状态只能由其他函数修改。在这种情况下，*ShowWindow*函数会修改 Window HANDLE 的状态。

有关详细信息，请参阅[句柄和数据类型](http://en.wikibooks.org/wiki/Windows_Programming/Handles_and_Data_Types#HANDLE)。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-05-25T04:26:45.287

句柄是由 Windows 管理的对象的唯一标识符。它*就像一个指针*，但*不是一个指针*，因为它不是一个可以被用户代码取消引用以访问某些数据的地址。相反，句柄将被传递给一组函数，这些函数可以对句柄标识的对象执行操作。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-05-24T21:59:49.227

所以在最基本的层面上，任何类型的 HANDLE 都是指向指针的指针或

```
#define HANDLE void ** 
```

现在关于你为什么要使用它

让我们进行设置：

```
class Object{
   int Value;
}

class LargeObj{

   char * val;
   LargeObj()
   {
      val = malloc(2048 * 1000);
   }

}

void foo(Object bar){
    LargeObj lo = new LargeObj();
    bar.Value++;
}

void main()
{
   Object obj = new Object();
   obj.val = 1;
   foo(obj);
   printf("%d", obj.val);
} 
```

所以因为 obj 是按值传递的（制作一个副本并将其提供给函数），所以 printf 将打印原始值 1。

现在，如果我们将 foo 更新为：

```
void foo(Object * bar)
{
    LargeObj lo = new LargeObj();
    bar->val++;
} 
```

printf 有可能会打印更新后的值 2。但也有可能 foo 会导致某种形式的内存损坏或异常。

原因是当您现在使用指针将 obj 传递给函数时，您还分配了 2 Megs 的内存，这可能导致操作系统在更新 obj 的位置时移动内存。由于您已按值传递指针，因此如果 obj 被移动，则操作系统会更新指​​针而不是函数中的副本，并可能导致问题。

对 foo 的最终更新：

```
void foo(Object **bar){
    LargeObj lo = LargeObj();
    Object * b = &bar;
    b->val++;
} 
```

这将始终打印更新的值。

看，当编译器为指针分配内存时，它会将它们标记为不可移动，因此由分配给函数的值的大对象引起的任何内存重新洗牌将指向正确的地址，以找出内存中的最终位置更新。

任何特定类型的 HANDLE（hWnd、FILE 等）都是特定于域的，并指向特定类型的结构以防止内存损坏。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2012-09-18T10:09:53.547

句柄就像数据库中记录的主键值。

编辑1：好吧，为什么downvote，主键唯一标识数据库记录，Windows系统中的句柄唯一标识窗口，打开的文件等，这就是我要说的。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-05-24T02:57:16.863

将 Windows 中的窗口视为描述它的结构。这个结构是 Windows 的一个内部部分，你不需要知道它的细节。相反，Windows 为该结构的结构指针提供了 typedef。那是你可以抓住窗户的“把手”。

# c# - Type.GetType(string) 使用“通用 “ 句法？

> ID：902968
> 
> 赞同：3
> 
> 时间：2009-05-24T02:53:50.537
> 
> 标签：c#, asp.net, generics, reflection

我正在构建一个通用 ASP.NET 服务器控件，该控件具有用于指定类型名称的属性。我正在使用控件生成器通过将属性值传递给`Type.GetType(string)`. 这很好用。但是，如果我要指定的类型是通用的，我必须使用如下语法：

```
<gwb:GenericControl runat="server" 
    TypeName="System.Collections.Generic.List`1[System.String]" /> 
```

我希望能够这样输入：

```
<gwb:GenericControl runat="server"
    TypeName="System.Collections.Generic.List<System.String>" /> 
```

我知道我可以手动解析尖括号的值并将它们转换为方括号，并添加适当的反引号数字前缀，但**我想知道是否有任何内置方法可以进行这种转换？**我假设`Generic<T>`语法特定于 C#（或至少在 VB.NET 中不同），所以我猜我还必须解析任何其他特定于语言的语法。

我注意到 ASP.NET MVC 在指令的`Inherits`属性中执行此操作`Page`，但我不确定如何。

```
<%@ Page Title="" Language="C#" MasterPageFile="~/Views/Shared/Site.Master"
    Inherits="System.Web.Mvc.ViewPage<MyModel>" %> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-24T04:02:03.603

不，没有内置的方法可以做到这一点。原因是类型名称`Generic<T>`确实是 C# 特有的。它们实际上在元数据中以不同的方式写出。

简短的版本是它将是类型名称，后跟一个`，然后是一个与泛型参数计数相对应的数字。 `Generic<T>`例如将被写出为 Generic`1`Generic<T1,T2>`并将被写出为 Generic`2。数组给语法增加了一点复杂性，但这是一般规则。

当您使用 Type.GetType 时，您实际上是在执行 MetaData 查询与 C# 查询。所以必须提供类型名称，因为它出现在 MetaData 中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-24T03:31:19.510

没有内置的方法可以做到这一点。你需要把它解析出来。这可能是 MVC 框架内部正在做的事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-24T06:00:19.097

您实际上将无法使用该特定语法。由于 xml 的性质，您的实际语法必须如下：

```
<gwb:GenericControl runat="server"
    TypeName="System.Collections.Generic.List&lt;System.String>" /> 
```

如果对应的 > 存在，则不能在属性值中使用 < 字符。您必须使用 < 对其进行编码，这违背了首先尝试使其像那样工作的意义。

第一种形式是标准的 IL 形式（即 Namespace.GenericClass`1[[System.String]]），任何精通 .NET 语言的用户都应该对它有点熟悉，并且普遍适用，而第二种形式仅适用于 C#。

# vb.net - asp.net 活动目录登录

> ID：902970
> 
> 赞同：0
> 
> 时间：2009-05-24T02:56:35.447
> 
> 标签：vb.net, active-directory, asp.net-membership

我希望能够使用有效的活动目录用户名和密码登录网页。

用户名和密码在文本框中输入。如果它们是正确的，那么我想重定向到另一个页面。

这怎么能编码。

在第二个任务中

执行一些代码后，使用代码以管理员身份登录并解锁帐户。

我听说这被称为模仿。

我该如何执行上述操作？

我正在使用visual web developer 2008和vb.net

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-24T06:00:46.507

您需要查看实现[ActiveDirectoryMembershipProvider](http://msdn.microsoft.com/en-us/library/system.web.security.activedirectorymembershipprovider.aspx)。这是关于如何实现它的一个很好的[演练。](http://msdn.microsoft.com/en-us/library/ms998347.aspx)

# c# - 有没有办法在 C# 中重载扩展方法？

> ID：902972
> 
> 赞同：6
> 
> 时间：2009-05-24T02:58:04.587
> 
> 标签：c#, extension-methods

我有以下模型模式：

```
public abstract class PARENTCLASS {...}
public class CHILD_A_CLASS : PARENTCLASS{...}
public static class EXTENSION{
  public static METHOD(this PARENTCLASS parent){...}
  public static METHOD(this CHILD_A_CLASS child) {...}
} 
```

像上面这样的东西，当然会有更多的子（和孙）类，但我只放了其中一个。问题是，当我调用如下扩展方法时：

```
PARENTCLASS cc = new CHILD_A_CLASS();
cc.METHOD(); 
```

它将执行 PARENT 扩展方法而不是我预期的 CHILD 扩展方法。任何人都知道如何实现这一点？（我不考虑将 METHOD 本身放入类中并让它进行继承，因为我想保持模型类干净并远离其他逻辑）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-24T03:54:12.437

当然可以**重载**扩展方法。您的代码是如何执行此操作的示例。

但是，您似乎想要的是能够以对象的运行时类型将确定扩展方法调用的方式**覆盖扩展方法。**很像在类上定义虚拟方法。没有针对此类功能的特定语言语法支持。

但是，如果这对您来说真的很重要，则可以手动实现该功能。它需要一点蛮力，但它会完成工作。例如 ...

```
public static class Extension {
  public static void Method(this ParentClass p) { 
    var c = p as ChildAClass;
    if ( c != null ) {
      Method(c);
    } else {
      // Do parentclass action
    }
  }
  public static void Method(this ChildAClass c) {
    ...
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-24T04:02:49.830

不幸的是，我认为你不能在这里得到你想要的。扩展方法是静态的，静态方法不能是虚拟的。

您可以使用 JaredPar 的解决方案来解决此问题。

如果您的目标是将模型与某些实现分开，我建议您研究**桥接模式**(GOF)。“从实现中分离抽象”这可能有助于分离您的关注点并保持您的模型类更清洁。

# ruby-on-rails - 按周/月/等和 ActiveRecord 分组？

> ID：902974
> 
> 赞同：42
> 
> 时间：2009-05-24T02:59:54.627
> 
> 标签：ruby-on-rails, activerecord, grouping

我正在我的产品中进行一些静态计算。用户执行了许多操作，比如说发布的评论。我希望能够向他们展示他们在过去一个月中每周发布了多少评论，或者在过去一年中每月发布了多少评论。

activerecord 有什么办法可以这样分组吗？我最好的办法是简单地手动执行此操作 - 根据我自己的标准迭代记录总和吗？

```
class User < ActiveRecord::Base
  has_many :comments
end

class Comments < ActiveRecord::Base
  belongs_to :user
end

@user.comments(:all).map {|c| ...do my calculations here...} 
```

还是有更好的方法？

谢谢！奥伦

* * *

## 回答 #1

> 赞同：91
> 
> 时间：2012-09-21T11:38:37.667

在 Postgres 中，您可以执行以下操作：

```
@user.comments.group("DATE_TRUNC('month', created_at)").count 
```

要得到：

```
{"2012-08-01 00:00:00"=>152, "2012-07-01 00:00:00"=>57, "2012-09-01 00:00:00"=>132} 
```

它接受从“微秒”到“千年”的值进行分组： [http ://www.postgresql.org/docs/8.1/static/functions-datetime.html#FUNCTIONS-DATETIME-TRUNC](http://www.postgresql.org/docs/8.1/static/functions-datetime.html#FUNCTIONS-DATETIME-TRUNC)

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2010-01-11T22:40:33.907

在这种情况下，对我来说最好的解决方案是直接使用 SQL，或者使用 Ruby group_by 函数：

```
@user.all.group_by{ |u| u.created_at.beginning_of_month } 
```

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2014-05-28T07:30:12.390

这是更精致的版本

```
@user.comments.group("year(created_at)").group("month(created_at)").count 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-05-24T04:17:42.713

我的猜测是这样的：

```
@user.comments.count(:group => "year(created_at),month(created_at)") 
```

干代码，ymmv

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2014-09-05T12:37:35.557

使用 group_by

```
@user.comments.group_by(&:week)

class User < ActiveRecord::Base
  def week
    some_attribute_like_date.strftime('%Y-%W')
  end
end 
```

这将为您提供 YYYY-WW 格式的分组列表

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-24T16:20:57.263

查看 has_activity 插件。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2015-02-04T21:02:22.370

查看团体约会宝石

[https://github.com/ankane/groupdate](https://github.com/ankane/groupdate)

它有最近的提交，与 postgresql 一起使用，与 chart kick 轻松集成以实现快速图表，并与时区一起使用！！

# c# - 通过 Internet 向开发人员发送应用程序错误和日志的最佳方式是什么？

> ID：902975
> 
> 赞同：8
> 
> 时间：2009-05-24T02:59:56.157
> 
> 标签：c#, web-services, error-reporting, error-logging

作为 C# 应用程序的作者，我发现如果我可以访问异常或调试日志，则对用户报告的问题进行故障排除会容易得多。

我已经包含了一个用户可以打开或关闭的本土日志记录机制。我希望用户能够通过互联网提交日志，以便我可以查看日志中的错误。

我曾想过使用**SMTPClient**或**Web 服务**来发送信息。SMTPClient 可能无法工作，因为防火墙可能会阻止传出 SMTP 访问。Web 服务是否会在发送大量数据（可能超过 1 MB）时出现问题？

作为让应用程序将错误报告直接发送给开发人员进行审查的最佳方式，您会推荐什么？

**编辑：**澄清：这是一个 Windows 应用程序，当发生错误时，我想弹出一个对话框，要求提交错误。我的问题是关于通过互联网将错误日志从应用程序传输给我（开发人员）的机制。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-24T03:01:52.097

某种方式让用户知道你的意思是这样做。向他们索要代理，向他们索要电子邮件服务器，诸如此类。

如果他们发现您正在打开一个套接字或类似的东西并在没有通知的情况下发送数据，那么具有安全意识的人会非常紧张。

没错。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-24T04:17:41.357

我建议**不要发送所有内容**（对您的应用程序的整个审核）。
但如果用户想要它（“反馈”按钮）或者如果应用程序中存在显式异常、致命错误、问题状态。

我们同时使用了 Web 服务和电子邮件 (SMTPClient)。我对这些的看法

**网络服务**
好

*   每个用户没有特殊配置
*   大小限制，超过 5Mb-8MB 的电子邮件是可能的

坏的

*   公开可见（黑客喜欢玩这些东西）
*   附加开发以使用 db 后端创建 Web 服务
*   稍后创建其他字段是不好的
*   Web 服务的更改并不好！

**SMTP客户端**
好

*   每个用户没有特殊配置
*   登录到公用文件夹使搜索/过滤变得容易（分组，...）
*   可以发送的所有数据、屏幕截图、堆栈跟踪、用户设置、...
    --> HTML
*   日志格式和信息的更改很容易，因为我们使用 HTML 电子邮件

坏的

*   每个用户的特殊配置（smtp 服务器，电子邮件用户，...）
*   电子邮件大小限制（5MB-8MB ??）
*   登录到电子邮件数据库需要大量开发

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-24T03:01:29.400

您可以自己编写，也可以使用**log4net**之类的东西，它会为您处理异常日志记录...

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-24T03:36:37.117

我们在我工作的地方使用 3 种方法

*   SMTP 到专用邮箱。这需要**大量**配置，并与“大公司”IT 部门合作，以确定他们的邮件服务器是什么，以及如何对其进行身份验证并通过它发送。还有像 Norton Internet Security 这样的程序可以阻止客户端机器上的出站 SMTP 流量，这会在工作中抛出额外的扳手。
*   提交到我们服务器上的 asmx。这是我们的首选方法，但有很多事情会妨碍您。它主要是代理，但诺顿也可以介入并击倒你。如果涉及代理，请逃跑:-)
*   HTTP POST 使用 HttpWebRequest 和多部分/表单编码的 mime 类型。它也有代理和防火墙问题，但有时可以在 asmx 提交失败的情况下工作。

祝你好运。你是对的，如果你有堆栈跟踪，甚至可能是可怜的老用户在做什么的屏幕截图，调试起来会容易**得多。**

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-24T03:13:05.070

我喜欢将此类内容作为电子邮件发送到专用邮箱。这样我就可以轻松地归档、搜索或忽略它。

在客户端/发送方方面，我认为发送日志的弹出窗口是个好主意。如果是 windows，您可以使用 MAPI 发送电子邮件。在 unix 系统上，“邮件”问题适用于大多数系统。

您可以在确认消息中提示用户输入电子邮件地址，并可能提供一些关于如何发送的选项（包括复制/粘贴到他们选择的邮件客户端）。

*您不*应该做的一件事是未经用户许可发送信息。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-19T08:27:43.117

如果您不希望在一天内发送这么多报告……您可以创建一个 gmail 帐户并使用它来发送电子邮件，以避免强制用户配置 SMTP 服务器。不确定 gmail 的条款和条件是什么。

这是我写的一个类，它使用 gmail 帐户发送电子邮件......

显然这里存在一些安全问题，例如有人可能会访问您的 gmail 帐户。所以，考虑到这一点。

该类中有同步或异步发送电子邮件的方法。

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Collections;
using System.Text;
using System.Net;
using System.Net.Mail;
using System.Net.Mime; 
//Mime is Not necerrary if you dont change the msgview and 
//if you dont add custom/extra headers 
using System.Threading;
using System.IO;
using System.Windows.Forms; // needed for MessageBox only.

namespace BR.Util
{
    public class Gmailer
    {

        SmtpClient client = new SmtpClient();
        static String mDefaultToAddress = "yourToAddress@yourdomain.com";
        static String mDefaultFromAddress = "anonymous@gmail.com";
        static String mDefaultFromDisplayName = "Anonymous";

        String mGmailLogin = "someaccount@gmail.com";
        String mGmailPassword = "yourpassword";

        public Gmailer()
        {
            client.Credentials = new System.Net.NetworkCredential(mGmailLogin, mGmailPassword);
            client.Port = 587;           
            client.Host = "smtp.gmail.com";
            client.EnableSsl = true;
            client.SendCompleted += new SendCompletedEventHandler(Gmailer_DefaultAsyncSendCompletedHandler);
        }

        public void setSendCompletedHandler(SendCompletedEventHandler pHandler)
        {
            client.SendCompleted -= Gmailer_DefaultAsyncSendCompletedHandler;
            client.SendCompleted += pHandler;
        }

        /// <summary>
        /// Static method which sends an email synchronously.
        /// It uses a hardcoded from email.
        /// </summary>
        /// <returns></returns>
        public static bool quickSend(String toEmailAddress, String subject, String body)
        {
            return Gmailer.quickSend(toEmailAddress, mDefaultFromAddress, mDefaultFromDisplayName, subject, body);
        }

        /// <summary>
        /// Static method which sends an email synchronously.
        /// It uses the hardcoded email address.
        /// </summary>
        /// <returns>true if successful, false if an error occurred.</returns>
        public static bool quickSend(String toEmailAddress, String fromEmailAddress,
                                     String fromDisplayName, String subject, String body)
        {
            try
            {
                Gmailer gmailer = new Gmailer();
                System.Net.Mail.MailMessage mailMsg = gmailer.createMailMessage(toEmailAddress, fromEmailAddress, fromDisplayName, subject, body);
                gmailer.send(mailMsg);
            }
            catch (Exception ex)
            {
                return false;
            }
            return true;
        }

        // <summary> creates a MailMessage object initialized with the default values.</summary>
        public System.Net.Mail.MailMessage createMailMessage()
        {
            return createMailMessage(mDefaultToAddress, mDefaultFromAddress, mDefaultFromDisplayName, mDefaultEmailSubject, mDefaultEmailBody);
        }

        public System.Net.Mail.MailMessage createMailMessage(String toEmailAddress, String fromEmailAddress, 
                                                             String fromDisplayName, String subject, String body)
        {
            //Build The MSG
            System.Net.Mail.MailMessage msg = new System.Net.Mail.MailMessage();
            msg.To.Add(toEmailAddress);
            msg.From = new MailAddress(fromEmailAddress, fromDisplayName, System.Text.Encoding.UTF8);
            msg.Subject = subject;
            msg.SubjectEncoding = System.Text.Encoding.UTF8;
            msg.Body = body;
            msg.BodyEncoding = System.Text.Encoding.UTF8;
            msg.IsBodyHtml = false;
            msg.Priority = MailPriority.High;
            return msg;
        }

        public System.Net.Mail.MailMessage addAttachmentToMailMessage(System.Net.Mail.MailMessage msg, String attachmentPath)
        {
            msg.Attachments.Add(new Attachment(attachmentPath));
            return msg;
        }

        // <summary> method which blocks until the MailMessage has been sent.  Throws
        // System.Net.Mail.SmtpException if error occurs.</summary>
        public void send(System.Net.Mail.MailMessage pMailMessage)
        {
            //try {
                client.Send(pMailMessage);
            //}
            //catch (System.Net.Mail.SmtpException ex)
            //{
            //    MessageBox.Show(ex.Message, "Send Mail Error");
            //}
        }

        // 
        public void sendAsync(System.Net.Mail.MailMessage pMailMessage)
        {
            object userState = pMailMessage;
            try
            {
                MailSent = false;
                client.SendAsync(pMailMessage, userState);
            }
            catch (System.Net.Mail.SmtpException ex)
            {
                MessageBox.Show(ex.Message, "Send Mail Error");
            }
        }

        // <summary> 
        // Provides a default SendComplete handler which is activated when an AsyncCompletedEvent 
        // is triggered by the private client variable.  This is useful for debugging etc.
        // Use the method setSendCompletedHandler to define your own application specific handler.
        // That method also turns this handler off.
        // </summary>
        public void Gmailer_DefaultAsyncSendCompletedHandler(object sender, AsyncCompletedEventArgs e)
        {
            MailMessage mail = (MailMessage)e.UserState;
            string subject = mail.Subject;

            if (e.Cancelled)
            {
                string cancelled = string.Format("[{0}] Send canceled.", subject);
                MessageBox.Show(cancelled);                
            }
            if (e.Error != null)
            {
                string error = String.Format("[{0}] {1}", subject, e.Error.ToString());
                MessageBox.Show(error);                
            }
            else
            {
                MessageBox.Show("Message sent.");
            }
            MailSent = true;
        }

        private bool _MailSent = false;
        /// <summary>
        /// Set to false when an async send operation is started and is set to true when finished.
        /// </summary>
        public bool MailSent
        {
            set
            {
                _MailSent = value;
            }
            get
            {
                return _MailSent;
            }
        }
    }
} 
```

# php - PHP 相当于 ASP.NET / SharePoint Webparts？

> ID：902978
> 
> 赞同：0
> 
> 时间：2009-05-24T03:01:38.633
> 
> 标签：php, sharepoint, web-parts

是否有与 Webparts 等效的 PHP？我正在寻找作为 SharePoint 一部分的用户可插入、可连接、可自定义的应用程序构建块的替代方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-24T03:28:40.763

phpNuke 中的模块很像 SharePoint webparts。

# language-agnostic - 您使用新技术或编程语言的标准

> ID：902984
> 
> 赞同：4
> 
> 时间：2009-05-24T03:07:51.960
> 
> 标签：language-agnostic

当您是编程语言或技术的早期采用者时，您考虑的标准或事项是什么？

我听到的两个最常见的解释是：

1.  它应该是“有趣的”（我从技术人员那里听到的）。
2.  它应该能够解决我们的问题（我从商界人士那里听到的）。

那么你的呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-24T05:28:13.020

在我跨越不同公司的职业生涯中，我已经多次做出这种改变，从 C 到 Java，再到 Ruby 到 Haskell，我的大部分软件开发工作。

在所有情况下，我一直在寻找更多的表达能力和更好的抽象。这总是由业务需求驱动的：我怎样才能更便宜地开发更好的软件？对我来说，这个问题的挑战是“有趣”，所以乐趣自然而然地随之而来。然而，向管理者证明商业价值的合理性可能很困难。他们通常不具备理解为什么一种编程语言比另一种更好的技术技能，并且担心转向他们了解的技术甚至比当前的语言还要少。（我也通过接管经理的工作解决了这个问题：我开了一家公司。）

很难说在新语言中究竟要寻找什么。您显然没有详细掌握该语言，或者您已经在使用它或知道为什么不使用它。丰富的经验会带来一种本能，使某些语言“闻起来”比其他语言更好，但是——这会使说服其他人看一种新语言变得特别困难——你不会确切地知道哪些特性会给你带来很大的优势。一个例子是模式匹配：它是在相对较少的语言中发现的一个特性，虽然我知道它，但当我开始使用 Haskell 时我不知道这将是提高生产力的关键因素。

虽然它是消极的（“避免这个”）建议而不是积极的（“做这个”）建议，但一个相当简单的规则是避免花费大量时间在与您已经熟悉的语言非常相似的语言上。如果您已经了解 Ruby，那么学习 Python 不太可能教给您很多新事物。C# 和 Java 将是另一个例子。（尽管 C# 开始获得一些 Java 所没有的有趣特性。）

看看学术界正在用一种语言做什么可能会有所帮助。如果它是学术研究的肥沃领域，那几乎肯定会有有趣的东西，而如果不是，那很可能那里没有什么有趣的东西可以学习。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-24T03:11:06.213

我的标准很简单：

*   哇因素
*   简单的
*   把事情做好
*   快的

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-24T03:11:41.530

我希望它能够轻松完成一些我习惯使用的工具很难做到的事情。所以我转向 Python，然后是 Ruby，而不是 Java，因为我可以逐步构建程序，轻松添加函数，并更简洁地表达程序（尤其是使用 Ruby，我可以在其中传递块/Procs 并拥有干净的闭包，再加上能力使用块和产量来定义好的 DSL。）

我选择了 Erlang，因为它很好地表达了基于 Actor 的并发；这使得网络程序更容易。

我选择 Haskell 是因为它适合我想尝试的许多形式化方法工具。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-24T03:49:51.373

1.  开源。
2.  活跃的开发者社区
3.  活跃的用户社区，带有友好的邮件列表或论坛。
4.  一些示例和文档，最好是教程
5.  理想的功能（解决问题）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-24T04:05:40.797

如果是为了我个人的乐趣，我不需要任何借口，因为我确实喜欢学习新事物，而最好的学习方式就是边做边学。如果是针对雇主、客户或客户，标准要高得多——我必须确信，*即使在考虑了加速效应和处于前沿的成本之后*，“新东西”也会在**为客户**（或客户或雇主）提供价值方面做得更好。这是专业态度的问题：我的工作是为客户提供最高价值——在这样做的同时获得乐趣是辅助的和次要的。因此，在实践中，我在专业环境中引入的“新”技术（包括语言）通常是我'

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-10T15:41:12.760

曾经有人说过一句话，大意是：

“如果学习一门编程语言不能改变你对编程的看法，那它就不值得学习。”

这是判断学习新语言（或其他技术）价值的一个指标（在众多指标中）。使用它，可能会建议学习以下语言：

*   C，因为它让你比任何其他语言都更好地理解冯诺依曼架构（它有点像随机访问图灵机，有点像......）。
*   LaTeX（作为一种编程语言，而不仅仅是一种排版系统），因为它让您了解将字符串重写系统作为一种计算模型。在这里，sed 是类似的；两者都学习，因为它们也是有用的工具:-)
*   Haskell，因为它教你函数式编程、lambda 演算（另一种计算模型）、惰性求值、类型推断、代数数据类型（轻松完成）、类型系统的可判定性（即学会害怕 C++）
*   Scheme `(or (another) ,Lisp) 因其宏系统，与动态类型和函数式编程做的有些不同。
*   SmallTalk，学习面向对象（所以我听说）
*   Java，了解赚钱的感觉：D
*   第四，因为`wisdom bestowed forth learned implies`。

...不过，这并不能解释我为什么要学习 python 或 shell 脚本。我认为你应该带着一粒盐和一铲实用主义来启蒙:)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-24T03:13:03.727

1.  应该有能力解决问题
2.  应该比其他替代方案更足以解决问题
3.  应该很有趣
4.  应该得到及时的支持，无论是来自社区还是推广它的公司

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-24T03:19:25.353

语言应该是：

1.  易于使用、学习和编码。
2.  持续的。许多语言都有 50 种传统的做事方式，这增加了学习曲线并且变得非常烦人。对我来说，C# 就是其中一种语言。
3.  它应该以最少的代码提供最有用的解决方案。另一方面，有时你确实需要一些表现力来确保你不会犯大错。
4.  适合工作的正确工具，也许适合任何工作的正确工具

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-24T03:33:58.430

我认为该语言应具备的标准：
1\. 新思想 - 如果该语言只是另一种 Scheme 变体，如果您知道一种，那么我觉得没有必要学习这个新的。如果我认为我会学到新的东西，我会学习它。
2\. 类似于另一种语言，但更好。例如，虽然 Java 和 C++ 有许多相同的想法，但 Java 的自动垃圾收集使其在许多情况下成为更好的选择。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-24T05:58:15.233

*   以最少的努力完成最多的工作
*   开箱即用，可与不同协议进行极好的互操作
*   快速地
*   为 99% 的 Web 开发人员所做的事情（PDF、电子邮件、报告等）内置了许多库

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-24T06:00:44.463

这取决于我为什么要学习新语言。如果我是为了好玩而学习它，那么它必须满足以下标准：

1.  我的平台是否支持它？仅在 Linux 上运行的东西对 Windows 程序员来说并不有趣。
2.  我会学到新东西吗？换句话说，它是否提出了一种新的做事方式？
3.  看起来有趣吗？我不想学习 Ada，即使它有新的做事方式。

如果我是为了工作而学习它，标准是不同的：

1.  成熟到什么程度？它是否被证明在现实世界中有效？
2.  社区有多大？
3.  它会让我的工作更轻松吗？即，与仅使用我已经知道的语言完成任务相比，是否值得投入时间。

# cocoa - 如何在 Cocoa 中实现浏览器工具栏？

> ID：902996
> 
> 赞同：0
> 
> 时间：2009-05-24T03:18:04.623
> 
> 标签：cocoa

似乎最好的方法是使用 NSToolbar。但是，对我来说，如何使 NSToolbar 中的 NSTextField 在宽度方面变得灵活并不明显。这可能吗？文本字段的默认行为是保持恒定宽度，即使工具栏已调整大小。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-24T03:52:44.447

确保在工具栏项上正确设置 maxSize 和 minSize，然后在文本字段本身上设置自动调整大小掩码。您可以控制工具栏中视图的大小，就像它在窗口中一样，如果您在那里创建它，请确保它的宽度在 IB 中是灵活的，或者如果您在代码中创建它，请指定 NSViewWidthSizable。

# freemarker - 允许用户编辑其模板时，freemarker 是否安全

> ID：902997
> 
> 赞同：0
> 
> 时间：2009-05-24T03:18:44.933
> 
> 标签：freemarker

我是freemarker的新手，我也需要知道这个问题是否选择，我会自己剥离XSS，但我不知道当站点允许用户编辑他们的模板时freemarker的其他功能是否安全？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-24T03:33:58.833

哦，天哪，不！这基本上相当于允许用户评估任意代码。事后删除 XSS 只会删除一个潜在的漏洞。他们仍然可以做很多其他的事情，比如操纵 POST 参数或执行页面重定向。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-04T21:12:37.390

约翰是对的。让用户自己实际编辑 freemarker 模板似乎很奇怪。如果您再次输出用户输入（例如在结果页面上显示搜索词），我建议使用内置的 ?html 字符串，它将使您免受最基本的 xss 攻击（例如“您搜索'${term?html}'")。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-06-08T15:48:57.243

所以正如其他人所说，这并不安全。但是，如果这些用户是您公司的员工或类似的人（即，如果他们很容易对恶意行为负责），那么这并非完全没有问题。有关更多详细信息，请参阅： http: [//freemarker.org/docs/app_faq.html#faq_template_uploading_security](http://freemarker.org/docs/app_faq.html#faq_template_uploading_security)*****