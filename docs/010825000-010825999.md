# StackOverflow 问答 10825000-10825999

# javascript - 返回 DOMWindow 的 JavaScript 回调

> ID：10825004
> 
> 赞同：0
> 
> 时间：2012-05-30T22:12:48.113
> 
> 标签：javascript, callback

在下面的代码中，当调用 func2b 时，'this' 是 DOMWindow，而不是对 obj2 的引用。为什么 func2b 失去了对 obj2 的引用作为“this”？

这是 jsFiddle 上的一个版本：http: [//jsfiddle.net/qqzKh/](http://jsfiddle.net/qqzKh/)

```
var obj1 = {
  init: function() {
    this.prefix = "Stop!";
    obj2.func2a(this.func1a);
  }
  ,func1a: function(message) {
    console.log(this.prefix + " " + message);
  }
};
var obj2 = {
  func2a: function(callback) {
    this.callback = callback;
    console.log(this.callback); // Correct reference to obj1.func1a
    obj3.func3a(this.func2b);
  }
  ,func2b: function(message) {
    console.log(this); // Unexpectedly returns DOMWindow
    this.callback(message);
  }
};
var obj3 = {
  func3a: function(callback) {
    callback("Hammer Time.");
  }
}
obj1.init(); 
```

**解决方案**

```
var obj1 = {
  init: function() {
    this.prefix = "Stop!";
    obj2.func2a(this, this.func1a);
  }
  ,func1a: function(message) {
    console.log(this.prefix + " " + message);
  }
};
var obj2 = {
  func2a: function(owner, callback) {
    this.owner = owner;
    this.callback = callback;
    obj3.func3a(this, this.func2b);
  }
  ,func2b: function(message) {
    this.callback.call(this.owner, message);
  }
};
var obj3 = {
  func3a: function(owner, callback) {
    callback.call(owner, "Hammer Time.");
  }
}
obj1.init(); 
```

​</p>

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T22:31:35.153

如果你这样做：

```
a.f() 
```

那么 a 在 f 的主体中被称为“this”。

如果你这样做：

```
f() 
```

那么窗口在 f 的主体中被称为“this”。

编辑：正如 Esailija 所说：

您正在使用 callback("Hammer Time.") 之类的 f() 在此答案中被调用。

# android - 如何使标签图像更大？

> ID：10825008
> 
> 赞同：0
> 
> 时间：2012-05-30T22:13:16.700
> 
> 标签：android

我在标签中获得了这张图片，但它太小了。我怎样才能放大它或让它填满标签

```
final TabHost tabHost = getTabHost(); //edit: added this line
tabHost.addTab(tabHost.newTabSpec("tab3").setIndicator("Discussion",
      getResources().getDrawable(R.drawable.forum))
                        .setContent(new Intent(this, MyActivity.class))); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T22:15:50.497

将 a 设置`LinearLayout`为 the 的子级`TabHost`并将您的图像添加到其中`LinearLayout`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T22:23:20.323

您将无法使用您正在使用的方法。可绘制对象不是一个小图标。如果你想要一些定制的东西，你必须使用它`setIndicator(View)`。我想你会创建一个`ImageView`集合来使用你想要的drawable并将它传递进去。如果你希望文本“讨论”仍然存在，你必须创建一个带有`ImageView`and的布局`TextView`并使用它。

# php - 如何填充使用 ENUM 值？我想使用 PHP 和 PHP 数据对象 (PDO) 使用 MySQL 数据库中的 ENUM 字段中的选项填充 HTML <select>。我怎样才能做到这一点？原版 PHP 实现：</select>

> ID：10825010
> 
> 赞同：7
> 
> 时间：2012-05-30T22:13:45.840
> 
> 标签：php, mysql, database, pdo

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-30T22:13:46.217

香草 PHP 实现：

```
<select>
<?
    $result = mysql_query('SHOW COLUMNS FROM '.$table_name.' WHERE field="'.$column_name.'"');
    while ($row = mysql_fetch_row($result)) {
            foreach(explode("','",substr($row[1],6,-2)) as $option) {
                print("<option>$option</option>");
            }
        }
?>
<select> 
```

PHP 数据对象实现

```
<select>
<?
    $sql = 'SHOW COLUMNS FROM '.$table_name.' WHERE field="'.$column_name.'"';
    $row = $db->query($sql)->fetch(PDO::FETCH_ASSOC);
    foreach(explode("','",substr($row['Type'],6,-2)) as $option) {
            print("<option>$option</option>");
        }
?>
</select> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-02-25T18:19:37.603

这是另一种解决方案，当您想将枚举值放入数组中以根据需要使用时，您可以将其用作辅助函数。

```
public static function getSQLEnumArray($table, $field, $db){
    $row = $db->query("SHOW COLUMNS FROM ".$table." LIKE ".$field)->fetch(PDO::FETCH_ASSOC);
    preg_match_all("/'(.*?)'/", $row['Type'], $categories);
    $fields = $categories[1];
    return $fields;
} 
```

# opengl - OpenGL - 将像素绘制到屏幕上？

> ID：10825011
> 
> 赞同：6
> 
> 时间：2012-05-30T22:13:45.977
> 
> 标签：opengl

我想使用 OpenGL 尽可能快地在屏幕上绘制像素数据（RGB / 灰度值）的二维数组。像素数据经常变化。

我曾希望我能找到一个简单的函数，让我可以将指针推入表示像素数据的数组，因为这可能是最快的方法。不幸的是，我没有发现这样的功能。

完成这项任务的最佳方法是什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-30T22:16:27.690

也许[glDrawPixels](http://www.opengl.org/sdk/docs/man2/xhtml/glDrawPixels.xml)是您正在寻找的功能？虽然如果数据是静态的，最好用它创建一个纹理，然后在每一帧中绘制它。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-31T08:57:38.937

我最近遇到了类似的问题，因为我正在尝试将视频渲染到屏幕上（即反复将像素数据上传到 VRAM），我的方法是：

*   使用 glTexImage2D 和 glTexSubImage2D 将数据上传到纹理（即在调用之前绑定纹理（和纹理单元，如果适用））

*   在我的情况下，由于视频帧速率（通常约为 24 fps）低于我的应用程序的帧速率（目标为 60 fps），为了避免再次上传相同的数据，我使用了帧缓冲区对象（查看 glGenFramebuffers/glBindFramebuffer/ glDeleteFramebuffers）并将我的纹理与帧缓冲区（glFramebufferTexture2D）链接起来。然后我上传该纹理一次，并多次绘制同一帧（只是使用 glBindTexture 进行普通纹理访问）

*   我不知道您使用的是哪个平台，但是当我针对 Mac 时，我使用了一些 Apple 扩展来确保通过 DMA 将数据传输到 VRAM（即让 glTexSubImage2D 立即返回以让 CPU 做其他工作） - 请感受如果您也在使用 Mac，请随时向我询问更多信息

*   同样由于您仅使用灰度，您可能需要考虑仅使用 GL_LUMINANCE 纹理（即每像素 1 个字节）而不是基于 RGB 的格式以加快上传速度（但这取决于纹理数据的大小，我正在流式传输高清 1920x1080 视频，所以我需要确保将其保持低调）

*   还要注意您的硬件使用的格式以避免不必要的数据转换（即通常使用 BGRA 数据似乎比仅使用 RGB 更好）

*   最后，在我的代码中，我用着色器替换了所有固定的管道功能（特别是将数据从灰度或 YUV 格式转换为 RGB），但这一切都取决于数据的大小和 CPU 的工作量或图形处理器

希望这会有所帮助，如果您需要更多信息，请随时给我发消息

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-30T22:27:30.897

我认为最快的方法是使用正交投影绘制屏幕大小的四边形，并使用像素着色器和[纹理缓冲区对象](http://www.opengl.org/registry/specs/EXT/texture_buffer_object.txt)直接绘制到像素着色器中的纹理。由于与 TBO 之间的传输延迟，您可能想看看双缓冲是否会有所帮助。

如果速度不是什么大问题（您只需要相当交互式的帧速率）glDrawPixels 很容易使用并且可以很好地用于许多目的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-11-27T19:11:34.300

我在 OpenGL 中将图像数据动态更改到屏幕的解决方案，

```
#define WIN32_LEAN_AND_MEAN

#include "wx/wx.h"
#include "wx/sizer.h"
#include "wx/glcanvas.h"
#include "BasicGLPane.h"

// include OpenGL
#ifdef __WXMAC__
#include "OpenGL/glu.h"
#include "OpenGL/gl.h"
#else
#include <GL/glu.h>
#include <GL/gl.h>
#endif
#include "ORIScanMainFrame.h"

BEGIN_EVENT_TABLE(BasicGLPane, wxGLCanvas)
EVT_MOTION(BasicGLPane::mouseMoved)
EVT_LEFT_DOWN(BasicGLPane::mouseDown)
EVT_LEFT_UP(BasicGLPane::mouseReleased)
EVT_RIGHT_DOWN(BasicGLPane::rightClick)
EVT_LEAVE_WINDOW(BasicGLPane::mouseLeftWindow)
EVT_SIZE(BasicGLPane::resized)
EVT_KEY_DOWN(BasicGLPane::keyPressed)
EVT_KEY_UP(BasicGLPane::keyReleased)
EVT_MOUSEWHEEL(BasicGLPane::mouseWheelMoved)
EVT_PAINT(BasicGLPane::render)
END_EVENT_TABLE()

// Test data for image generation.  floats range 0.0 to 1.0, in RGBRGBRGB... order.
// Array is 1024 * 3 long. Note that 32 * 32 is 1024 and is the largest image we can randomly generate.
float* randomFloatRGB;
float* randomFloatRGBGrey;

BasicGLPane::BasicGLPane(wxFrame* parent, int* args) :
    wxGLCanvas(parent, wxID_ANY, args, wxDefaultPosition, wxDefaultSize, wxFULL_REPAINT_ON_RESIZE)
{
    m_context = new wxGLContext(this);

    randomFloatRGB = new float[1024 * 3];
    randomFloatRGBGrey = new float[1024 * 3];
    // In GL images 0,0 is in the lower left corner so the draw routine does a vertical flip to get 'regular' images right side up.
    for (int i = 0; i < 1024; i++) {
        // Red
        randomFloatRGB[i * 3] = static_cast <float> (rand()) / static_cast <float> (RAND_MAX);
        // Green
        randomFloatRGB[i * 3 + 1] = static_cast <float> (rand()) / static_cast <float> (RAND_MAX);
        // Blue
        randomFloatRGB[i * 3 + 2] = static_cast <float> (rand()) / static_cast <float> (RAND_MAX);
        // Telltale 2 white pixels in 0,0 corner.
        if (i < 2) {
            randomFloatRGB[i * 3] = randomFloatRGB[i * 3 + 1] = randomFloatRGB[i * 3 + 2] = 1.0f;
        }

        randomFloatRGBGrey[i * 3] = randomFloatRGB[i * 3];
        randomFloatRGBGrey[i * 3 + 1] = randomFloatRGB[i * 3];
        randomFloatRGBGrey[i * 3 + 2] = randomFloatRGB[i * 3];
    }

    // To avoid flashing on MSW
    SetBackgroundStyle(wxBG_STYLE_CUSTOM);
}

BasicGLPane::~BasicGLPane()
{
    delete m_context;
}

void BasicGLPane::resized(wxSizeEvent& evt)
{
    //  wxGLCanvas::OnSize(evt);
    Refresh();
}

int BasicGLPane::getWidth()
{
    return GetSize().x;
}

int BasicGLPane::getHeight()
{
    return GetSize().y;
}

void BasicGLPane::render(wxPaintEvent& evt)
{
    assert(GetParent());
    assert(GetParent()->GetParent());
    ORIScanMainFrame* mf = dynamic_cast<ORIScanMainFrame*>(GetParent()->GetParent());
    assert(mf);

    switch (mf->currentMainView) {
    case ORIViewSelection::ViewCamera:
        renderCamera(evt);
        break;
    case ORIViewSelection::ViewDepth:
        renderDepth(evt);
        break;
    case ORIViewSelection::ViewPointCloud:
        renderPointCloud(evt);
        break;
    case ORIViewSelection::View3DModel:
        render3DModel(evt);
        break;
    default:
        renderNone(evt);
    }
}

void BasicGLPane::renderNone(wxPaintEvent& evt) {
    if (!IsShown())
        return;
    SetCurrent(*(m_context));
    glPushAttrib(GL_ALL_ATTRIB_BITS);
    glClearColor(0.08f, 0.11f, 0.15f, 1.0f);
    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
    glFlush();
    SwapBuffers();
    glPopAttrib();
}

GLuint makeOpenGlTextureFromDataLuninanceFloats(int width, int height, float* f) {
    GLuint textureID;

    glEnable(GL_TEXTURE_2D);
    glGenTextures(1, &textureID);

    // "Bind" the newly created texture : all future texture functions will modify this texture
    glBindTexture(GL_TEXTURE_2D, textureID);

    // Give the image to OpenGL
    glTexImage2D(GL_TEXTURE_2D, 0, GL_FLOAT, width, height, 0, GL_FLOAT, GL_LUMINANCE, f);

    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_NEAREST);
    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_NEAREST);

    return textureID;
}

GLuint makeOpenGlTextureFromRGBInts(int width, int height, unsigned int* f) {
    GLuint textureID;

    glEnable(GL_TEXTURE_2D);
    glGenTextures(1, &textureID);

    // "Bind" the newly created texture : all future texture functions will modify this texture
    glBindTexture(GL_TEXTURE_2D, textureID);

    // Give the image to OpenGL
    glTexImage2D(GL_TEXTURE_2D, 0, GL_RGBA, width, height, 0, GL_RGBA, GL_UNSIGNED_INT, f);

    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_NEAREST);
    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_NEAREST);

    return textureID;
}

/// <summary>
/// Range of each float is 0.0f to 1.0f
/// </summary>
/// <param name="width"></param>
/// <param name="height"></param>
/// <param name="floatRGB"></param>
/// <returns></returns>
GLuint makeOpenGlTextureFromRGBFloats(int width, int height, float* floatRGB) {
    GLuint textureID;

    // 4.6.0 NVIDIA 457.30  (R Keene machine, 11/25/2020)
    // auto sss = glGetString(GL_VERSION);

    glGenTextures(1, &textureID);

    // "Bind" the newly created texture : all future texture functions will modify this texture
    glBindTexture(GL_TEXTURE_2D, textureID);

    // Give the image to OpenGL
    glTexImage2D(GL_TEXTURE_2D, 0, GL_RGB, width, height, 0, GL_RGB, GL_FLOAT, floatRGB);

    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_NEAREST);
    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_NEAREST);

    return textureID;
}

void BasicGLPane::DrawTextureToScreenFloat(int w, int h, float* floatDataPtr, GLuint (*textureFactory)(int width, int height, float* floatRGB)) {
    if (w <= 0 || h <= 0 || floatDataPtr == NULL || w > 5000 || h > 5000) {
        assert(false);
        return;
    }

    SetCurrent(*(m_context));

    glPushAttrib(GL_ALL_ATTRIB_BITS);
    glPushMatrix();
    glPushClientAttrib(GL_CLIENT_ALL_ATTRIB_BITS);

    glClearColor(0.15f, 0.11f, 0.02f, 1.0f);
    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

    glEnable(GL_TEXTURE_2D);

    glLoadIdentity();
    glMatrixMode(GL_MODELVIEW);
    glLoadIdentity();
    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();

    // 4.6.0 NVIDIA 457.30  (R Keene machine, 11/25/2020)
    // auto sss = glGetString(GL_VERSION);

    float onePixelW = (float)getWidth() / (float)w;
    float onePixelH = (float)getHeight() / (float)h;
    float orthoW = w;
    float orthoH = h;
    if (onePixelH > onePixelW) {
        orthoH = h * onePixelH / onePixelW;
    }
    else {
        orthoW = w * onePixelW / onePixelH;
    }
    // We want the image at the top of the window, not the bottom if the window is too tall.
    int topOfScreen = (float)getHeight() / onePixelH;

    // If the winjdow resizes after creation you need to change the viewport.
    glViewport(0, 0, getWidth(), getHeight());
    gluOrtho2D(0.0, orthoW, (double)topOfScreen - (double)orthoH, topOfScreen);

    GLuint myTextureName = textureFactory(w, h, floatDataPtr);

    glBegin(GL_QUADS);
    {
        // This order of UV coords and verticies will do the vertical flip of the image to get the 'regular' image 0,0
        // in the top left corner.
        glTexCoord2f(0.0f, 1.0f); glVertex3f(0.0f, 0.0f, 0.0f);
        glTexCoord2f(1.0f, 1.0f); glVertex3f(0.0f + w, 0.0f, 0.0f);
        glTexCoord2f(1.0f, 0.0f); glVertex3f(0.0f + w, 0.0f + h, 0.0f);
        glTexCoord2f(0.0f, 0.0f); glVertex3f(0.0f, 0.0f + h, 0.0f);
    }
    glEnd();

    glDeleteTextures(1, &myTextureName);

    glFlush();
    SwapBuffers();

    glPopClientAttrib();
    glPopMatrix();
    glPopAttrib();
}

void BasicGLPane::DrawTextureToScreenMat(wxPaintEvent& evt, cv::Mat m, float brightness) {
    m.type();
    if (m.empty()) {
        renderNone(evt);
        return;
    }

    if (m.type() == CV_32FC1) { // Grey scale.
        DrawTextureToScreenFloat(m.cols, m.rows, (float*)m.data, makeOpenGlTextureFromDataLuninanceFloats);
    }
    if (m.type() == CV_32FC3) { // Color.
        DrawTextureToScreenFloat(m.cols, m.rows, (float*)m.data, makeOpenGlTextureFromRGBFloats);
    }
    else {
        renderNone(evt);
    }
}

void BasicGLPane::renderCamera(wxPaintEvent& evt) {
    if (!IsShown())
        return;
    DrawTextureToScreenMat(evt, ORITopControl::Instance->im_white);
}

void BasicGLPane::renderDepth(wxPaintEvent& evt) {
    if (!IsShown())
        return;
    DrawTextureToScreenMat(evt, ORITopControl::Instance->depth_map);
}

void BasicGLPane::render3DModel(wxPaintEvent& evt) {
    if (!IsShown())
        return;
    SetCurrent(*(m_context));
    glPushAttrib(GL_ALL_ATTRIB_BITS);
    glPushMatrix();

    glClearColor(0.08f, 0.11f, 0.15f, 1.0f);
    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

    glFlush();
    SwapBuffers();

    glPopMatrix();
    glPopAttrib();
}

void BasicGLPane::renderPointCloud(wxPaintEvent& evt) {
    if (!IsShown())
        return;
    boost::unique_lock<boost::mutex> lk(ORITopControl::Instance->pointCloudCacheMutex);

    SetCurrent(*(m_context));
    glPushAttrib(GL_ALL_ATTRIB_BITS);
    glPushMatrix();

    glLoadIdentity();
    glMatrixMode(GL_MODELVIEW);
    glLoadIdentity();
    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();

    glViewport(0, 0, getWidth(), getHeight());

    glClearColor(0.08f, 0.11f, 0.15f, 1.0f);
    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

    if (ORITopControl::Instance->pointCloudCache.size() > 0) {
        glMatrixMode(GL_PROJECTION);
        gluPerspective( /* field of view in degree */ 40.0,
            /* aspect ratio */ 1.0,
            /* Z near */ 1.0, /* Z far */ 500.0);
        glMatrixMode(GL_MODELVIEW);
        gluLookAt(100, 70, 200, // Eye
            25, 25, 25, // Look at pt
            0, 0, 1); // Up Vector

        glPointSize(2.0);
        glBegin(GL_POINTS);
        // Use explicit for loop because pointCloudFragments can grow asynchronously.
        for (int i = 0; i < ORITopControl::Instance->pointCloudCache.size(); i++) {
            auto frag = ORITopControl::Instance->pointCloudCache[i];
            auto current_point_cloud_ptr = frag->cloud;
            glPushMatrix();
            // glMultMatrixf(frag->xform.data());
            for (size_t n = 0; n < current_point_cloud_ptr->size(); n++) {
                glColor3ub(255, 255, 255);
                glVertex3d(current_point_cloud_ptr->points[n].x, current_point_cloud_ptr->points[n].y, current_point_cloud_ptr->points[n].z);
            }
            glPopMatrix();
        }
        glEnd();
    }

    glFlush();
    SwapBuffers();

    glPopMatrix();
    glPopAttrib();
} 
```

# python - unittest中奇怪的对象实例行为

> ID：10825015
> 
> 赞同：1
> 
> 时间：2012-05-30T22:14:17.380
> 
> 标签：python, unit-testing

我正在尝试使用 Python unittest 测试一个类，但测试套件似乎正在修改基类

这里有一些伪代码来演示这个问题：

班上

```
// module cards...
class deck():

    def __init__(self, cards):
        self.__cards = cards

    def __len__(self):
        return len(self.__cards)

    def draw(self, n = 1):
        '''
        remove and return n cards
        from internal card list

        n -- integer
        @return list removed
        '''
        removed      = self.__cards[0:n]
        remaining    = self.__cards[n:]
        self.__cards = remaining
        return removed

    def addOne(self, card):
        '''
        add single card to the deck
        '''
        self.__cards.append(card)

    def addMany(self, cards):
        '''
        add many cards to the deck
        '''
        self.__cards.extend(cards) 
```

填充实例的夹具，可能是文件或数据库查询的输出

```
//source
src = [
{
    'id'          : 1,
    'name'        : 'one',
    'description' : 'this is one'
},
{
    'id'          : 2,
    'name'        : 'two',
    'description' : 'this is two'
},
{
    'id'          : 3,
    'name'        : 'three',
    'description' : 'this is three'
},
{
    'id'          : 4,
    'name'        : 'four',
    'description' : 'this is four'
},
{
    'id'          : 5,
    'name'        : 'five',
    'description' : 'this is five'
}
] 
```

测试

```
from source import src
import cards 

def test_drawRemovesOne(self):
    deck = cards.deck(src)
    self.assertTrue(callable(deck.draw))

    # single card
    deckSize  = len(deck)
    drawnCard = deck.draw(1)
    self.assertEqual(drawnCard[0]['id'], 1)
    self.assertEqual(4, len(deck))
    self.assertEqual(len(drawnCard), 1)

def test_drawRemovesMany(self):
    deck = cards.deck(src)
    deckSize   = len(deck)
    drawnCards = deck.draw(3)
    self.assertEqual(drawnCards[0]['id'], 1)
    self.assertEqual(drawnCards[1]['id'], 2)
    self.assertEqual(drawnCards[2]['id'], 3)
    self.assertEqual(len(deck), 2)
    self.assertEqual(len(drawnCards), 3)

'''
INVALIDATES PREVIOUS TESTS...
def test_addOne(self):
    deck = cards.deck(src)
    card = {
        'id'          : 9,
        'name'        : 'nine',
        'description' : 'this is nine'
    }
    deckSize = len(deck)
    deck.addOne(card)
    newDeckSize = len(deck)
    self.assertTrue(newDeckSize == deckSize + 1)
''' 
```

编辑：发布真实片段

第一个测试通过，但随后在实施第二个测试时失败。尽管似乎是新实例，但似乎有一个对测试方法共享的类的引用。

我只在 Python 中做了一些名义上的工作，这是我不知道的某种语言特性的结果吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T22:48:19.970

看到这个代码

```
>>> class Deck:
...     def __init__(self, cards):
...         self.cards = cards
>>> l0 = [1, 2, 3]
>>> d1 = Deck(l0)
>>> d2 = Deck(l0)
>>> d1.cards
0: [1, 2, 3]
>>> d2.cards
1: [1, 2, 3]
>>> d1.cards.append(4)
>>> d2.cards
2: [1, 2, 3, 4]    # d1 and d2 share the same list for cards 
```

你开始你的测试，`deck = cards.deck(src)`但我不知道这`src`是从哪里来的。如果它不是在您的 setUp 方法中创建为新对象，那么它可能会在测试用例之间共享。

# java - 尝试在 Eclipse 中复制/SVN 提交多个文件，但复制/SVN 提交仅发生在 2 个文件中

> ID：10825017
> 
> 赞同：0
> 
> 时间：2012-05-30T22:14:27.980
> 
> 标签：java, eclipse, edit, copy-paste

在 Eclipse 中，如果我选择多个文件并尝试复制，则只有 2 个文件被复制。我选择的其他人在复制时被取消选择。SVN 提交也发生了同样的事情。

有人知道为什么会这样吗？

谢谢！

# lucene.net - Lucene.net DeleteDocuments 删除太多？

> ID：10825018
> 
> 赞同：1
> 
> 时间：2012-05-30T22:14:40.257
> 
> 标签：lucene.net, lucene, full-text-indexing

例如，我在索引中有两个文档......他们都有字段“Id”。

现在，我在 IndexWritter 上发出一个 DeleteDocuemnts 给它第一个项目的 Id。

所以创建索引：

```
var document = new global::Lucene.Net.Documents.Document();
    document.Add(new Field("Content", "content", Field.Store.YES, Field.Index.ANALYZED, Field.TermVector.WITH_POSITIONS_OFFSETS));
    document.Add(new Field("Id", "vladanstrigo", Field.Store.YES, Field.Index.NOT_ANALYZED));

var document2 = new global::Lucene.Net.Documents.Document();
    document2.Add(new Field("Content", "content second", Field.Store.YES, Field.Index.ANALYZED, Field.TermVector.WITH_POSITIONS_OFFSETS));
    document2.Add(new Field("Id", "ivanstrigo", Field.Store.YES, Field.Index.NOT_ANALYZED));

var directory = FSDirectory.Open("...directory...");
var analyzer = ...GetAnalyzer();

var indexWriter = ...GetWriter();

indexWriter.AddDocument(document);
indexWriter.AddDocument(document2); 
```

这很好用......我在索引中有两个文档，它们工作得很好。

但是当我这样做时：

```
indexWriter.DeleteDocuments(new Term("Id", "ivanstrigo")); 
```

IndexWriter 删除了索引中的所有文档……不仅是与该术语匹配的文档……我不知道如何停止。我只想删除这个！

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T09:37:37.070

找到了答案……在创建 IndexWriter 时，我在创建新索引时已经“真正”了……基本上总是重新创建一个新索引。

现在可以了。

# c# - RichTextBox 找到一个匹配时满足；我希望它继续搜索

> ID：10825033
> 
> 赞同：1
> 
> 时间：2012-05-30T22:16:39.273
> 
> 标签：c#, winforms, richtextbox, textchanged

我有这段代码，它将搜索的单词或短语变为红色：

```
private void rtb_TextChanged(object sender, EventArgs e) {
    String textToFind = textBoxWordOrPhraseToFind.Text;
    String richText = rtb.Text;
    if ((textToFind == "") || (richText == "") || (!(richText.Contains(textToFind)))) {
        return;
    }
    tOut.Select(richText.IndexOf(textToFind), textToFind.Length);
    tOut.SelectionColor = Color.Red;
} 
```

...但随后它停止了 - 它只会使第一个单词或短语变红。我希望它为 RichTextBox 的整个（匹配）内容提供 Sammy Hagar 处理。

我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T22:23:12.570

RichTextBox 不支持多选。
可以搜索相同文本的其他匹配项，但您不能保留多个选择。但是可以更改 SelectionBackColor 属性以模拟多选行为。

搜索可以通过这种方式完成

```
int pos = 0;
pos = richText.IndexOf(textToFind, 0);
while(pos != -1)
{
    tOut.Select(pos, textToFind.Length); 
    tOut.SelectionBackColor = Color.Red; 
    pos = richText.IndexOf(textToFind, pos + 1);
} 
```

# java - 加密令牌的 Java PKCS11 标准

> ID：10825036
> 
> 赞同：1
> 
> 时间：2012-05-30T22:16:49.743
> 
> 标签：java

您好，我正在尝试用 Java 制作一个读取智能卡（作为安全令牌）的小程序，但我根本无法处理它。我已经找到了这个：http://docs.oracle.com/javase/6/docs/technotes/guides/security/SunProviders.html#SunPKCS11Provider 这应该给我一些细节......但我从来没有在Java中添加过提供者...而且我也找不到提供者那里提到的任何类...

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T01:26:37.127

您不需要直接引用提供者。您向 API 询问特定算法，它会找到合适的提供者。不过，PKCS#11 很古怪。您必须非常仔细地阅读[详细的文档。](http://docs.oracle.com/javase/6/docs/technotes/guides/security/p11guide.html)我强烈建议先编写应用程序与软件提供商合作。例如，创建一个 Java Keystore，在其中创建一个密钥并对其进行签名，然后验证签名。一定要写正负测试用例。换句话说，表明篡改数据会使验证失败。接下来，通过更改您的程序以使用它来了解如何使用 PKCS#11 提供程序。使用 Java 加密 API 已经够难了，而且不会增加 PKCS#11 和您的特定智能卡的所有复杂性。

# java - 在窗口中请求焦点

> ID：10825043
> 
> 赞同：0
> 
> 时间：2012-05-30T22:17:27.683
> 
> 标签：java, swing, focus, jcomponent, jinternalframe

在处理 JTable 后，我有一个简单的（不是？）问题，即关注 JInternalFrame。

```
//I created a table, set it to visible, gave it focus.
list.dispose(); //I did what I wanted with the table and I dispose of it
screen.setVisible(true); //The screen is already visible. this isn't really needed
//After I closed table, I want the focus return to the screen (JInternalFrame)
screen.setFocusable(true); 
screen.requestFocus();
screen.requestFocusInWindow();
screen.requestFocus(true);
desktopPane.setSelectedFrame(screen); 
```

所以发生的事情是这样的：屏幕确实获得焦点，从某种意义上说，当我检查哪个组件有焦点时 - 它确实返回了我 - 屏幕。但是顶部的栏（不确定此处的正确术语）包含图标、标题、X thingy 的栏是灰色而不是蓝色。

知道如何使 JInternalFrame 看起来活跃，而不仅仅是表现活跃吗？

示例： http: [//nexrem.com/projects/FocusDemo.rar](http://nexrem.com/projects/FocusDemo.rar)我在 NetBeans 中快速完成了这个，你所做的是：

点击打开screen1。它打开并集中。单击以打开 JTable。它打开并具有焦点。Screen1 失去焦点。按 Esc 关闭 JInternalFrame。它关闭了，但 screen1 似乎没有焦点（至少在视觉上）。我怀疑它可能与焦点循环有关，因为它在 2 个 JInternalFrames 之间......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T06:10:23.067

您正在寻找[`screen.setSelected(true);`](http://docs.oracle.com/javase/7/docs/api/javax/swing/JInternalFrame.html#setSelected%28boolean%29)（我刚刚在您的代码上尝试过，现在可以使用）。

至于@HFOE 的建议，他的意思是做这样的事情：

```
SwingUtilities.invokeLater(new Runnable() {
    public void run() {
        screen.requestFocus();
        screen.requestFocusInWindow();
        screen.requestFocus(true);
    }
}); 
```

但我不确定这会改善你的情况。

# list - 检查列表列表是否具有相同大小的列表

> ID：10825051
> 
> 赞同：9
> 
> 时间：2012-05-30T22:18:33.800
> 
> 标签：list, python

我需要验证我的列表是否在 python 中具有相同大小的列表

```
myList1 = [ [1,1] , [1,1]] // This should pass. It has two lists.. both of length 2
myList2 = [ [1,1,1] , [1,1,1], [1,1,1]] // This should pass, It has three lists.. all of length 3
myList3 = [ [1,1] , [1,1], [1,1]] // This should pass, It has three lists.. all of length 2
myList4 = [ [1,1,] , [1,1,1], [1,1,1]] // This should FAIL. It has three list.. one of which is different that the other 
```

我可以编写一个循环来遍历列表并检查每个子列表的大小。有没有更pythonic的方式来实现结果。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-05-30T22:25:06.793

```
all(len(i) == len(myList[0]) for i in myList) 
```

为避免每个项目产生 len(myList[0]) 的开销，您可以将其存储在变量中

```
len_first = len(myList[0]) if myList else None
all(len(i) == len_first for i in myList) 
```

如果您还希望能够看到*为什么*它们不都是平等的

```
from itertools import groupby
groupby(sorted(myList, key=len), key=len) 
```

将按长度对列表进行分组，以便您可以轻松查看奇怪的列表

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-30T22:23:39.493

你可以试试：

```
test = lambda x: len(set(map(len, x))) == 1

test(myList1) # True
test(myList4) # False 
```

基本上，您获取每个列表的长度并从这些长度中创建一个集合，如果它包含单个元素，则每个列表具有相同的长度

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-30T22:34:24.377

```
def equalSizes(*args):
    """
    # This should pass. It has two lists.. both of length 2
    >>> equalSizes([1,1] , [1,1])
    True

    # This should pass, It has three lists.. all of length 3
    >>> equalSizes([1,1,1] , [1,1,1], [1,1,1])
    True

    # This should pass, It has three lists.. all of length 2
    >>> equalSizes([1,1] , [1,1], [1,1])
    True

    # This should FAIL. It has three list.. one of which is different that the other
    >>> equalSizes([1,1,] , [1,1,1], [1,1,1])
    False
    """
    len0 = len(args[0])
    return all(len(x) == len0 for x in args[1:]) 
```

要对其进行测试，请将其保存到文件`so.py`中并像这样运行它：

```
$ python -m doctest so.py -v
Trying:
    equalSizes([1,1] , [1,1])
Expecting:
    True
ok
Trying:
    equalSizes([1,1,1] , [1,1,1], [1,1,1])
Expecting:
    True
ok
Trying:
    equalSizes([1,1] , [1,1], [1,1])
Expecting:
    True
ok
Trying:
    equalSizes([1,1,] , [1,1,1], [1,1,1])
Expecting:
    False
ok 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-30T22:28:29.973

如果您想要在失败情况下获得更多数据，您可以执行以下操作：

```
myList1 = [ [1,1] , [1,1]]
lens = set(itertools.imap(len, myList1))
return len(lens) == 1
# if you have lists of varying length, at least you can get stats about what the different lengths are 
```

# javascript - :after working 应用于输入时是否应该工作？

> ID：10825052
> 
> 赞同：2
> 
> 时间：2012-05-30T22:18:48.253
> 
> 标签：javascript, firefox

":after" 选择器在应用于 FF 和 IE 的输入时不起作用

```
input:after {
    content: "title";        
}​ 
```

而它与 p、a 等一起工作。

它是一个错误吗？

[jsFiddle](http://jsfiddle.net/zkRgA/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T22:53:49.110

不，不是错误， :after/:before 不能在自闭合元素上始终如一地（并且正确地）工作，正如 David Thomas 所说。原因是与其他元素不同，您不能在输入或 imgs 中嵌套标签，这与 a 或 span 标签不同。

在“输入”元素之前或之后阅读[CSS 内容生成](https://stackoverflow.com/questions/4574912/css-content-generation-before-input-elements)。

# javascript - Javascript Object.prototype 和循环引用

> ID：10825054
> 
> 赞同：2
> 
> 时间：2012-05-30T22:18:59.907
> 
> 标签：javascript, prototype

我知道在 Javascript 中，变量总是通过引用分配，这意味着如果我写：

```
var a = {};
var b = a;
b.foo = 'string';
console.log(a.foo); // prints 'string' 
```

是的，所以编写以下代码会返回错误：

```
var a = function(){};
var b = function(){};

b.foo=a;
a.bar = b;

console.log(a); // prints { [Function] bar: { [Function] foo: [Circular] } } 
```

这没关系，因为 a.bar 指向 b，b.foo 指向 a，其 .bar 参数再次指向 b，依此类推。这是一个循环引用。

现在，我注意到以下事情：

```
var a = function(){};
var b = function(){};

b.foo=a;
a.prototype = b;

console.log(a); // prints [Function] 
```

我刚刚用 a.prototype 替换了 a.bar，现在，我没有循环引用错误。

我认为这意味着 Object.prototype 不能通过引用赋值。任何人都可以确认吗？这是规则的一个例外（至少如果它是真的有一个例外）？

谢谢 ！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T22:27:15.637

那不是错误。这只是一个印刷惯例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T22:24:25.347

不，这似乎只是您的控制台的异常情况。您在哪个浏览器中遇到这种情况？例如，Opera 的 Dragonfly 不会列出函数的任何属性。

此外，我还没有看到一个控制台抱怨记录对象中的循环引用......

然而，在您的第二个示例中也存在循环引用。试着打印`b.foo.prototype.foo.prototype.foo...`:-) 它只是不会这样显示，因为`prototype`函数的 " " 属性是不可枚举的（参见[规范 13.2，#18](http://es5.github.com/#x13.2)）。

# r - RStudio 可以自动为函数生成 roxygen 模板吗？

> ID：10825058
> 
> 赞同：42
> 
> 时间：2012-05-30T22:19:41.977
> 
> 标签：r, roxygen, rstudio, roxygen2

RStudio 是否支持任何自动 roxygen 模板创建？

在 Emacs-ESS 中，`C-x C-o`将为一个函数生成一个 roxygen 模板。例如，它会自动转换：

```
foo <- function(x,y) x+y 
```

进入这个：

```
##' .. content for \description{} (no empty lines) ..
##'
##' .. content for \details{} ..
##' @title 
##' @param x 
##' @param y 
##' @return 
##' @author David
foo <- function(x,y) x+y 
```

RStudio 中是否存在类似的功能？

*更新*

*   从[ESS 12.09-2 开始](http://ess.r-project.org/Manual/ess.html#Introduction)，命令已更改为`C-c C-o C-o`
*   此功能已在 Rstudio 中实现：CTRL+ALT+SHIFT+R

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2015-06-05T20:19:10.203

（将@Crops 评论转换为完整答案）

在 RStudio v0.99 中，文件的“代码”菜单下有一个新选项`.R`：“插入 Roxygen 骨架”。在[RStudio 关于 v0.99 preview 的博客文章](http://blog.rstudio.org/2015/05/06/rstudio-v0-99-preview-more-editor-enhancements/)中有一张它的图片。

![来自 RStudio 的 Roxygen 骨架菜单图像](../Images/8c5ad2a9d04412e9996d178e3069d812.png)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-07-12T21:24:33.377

你的问题之后的沉默应该告诉你一些事情......目前的答案是不，不是。我知道有几个人正是出于这个原因使用 EMACS，并且在完全支持 roxygen 之前不会考虑切换到 RStudio。也就是说，用户和 RStudio 的制造商之间已经对此进行了一些讨论。考虑到最近添加到 RStudio 中的所有很酷的东西，看到它发生我不会感到惊讶。事实上，我认为它很有可能会发生。但是不要屏住呼吸，这可能是一个漫长的等待......

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-02-27T08:27:21.950

或者，您可以使用 R 包[RoxygenReady](https://roxygenready.github.io/)创建 Roxygen 骨架/Roxygen 模板。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-01-05T04:54:35.770

我的解决方案是使用文本扩展器（在我的情况下为[PhraseExpress ）来执行此操作。](http://www.phraseexpress.com/)

# vb.net - 使用带有标量查询的语句

> ID：10825059
> 
> 赞同：0
> 
> 时间：2012-05-30T22:19:44.757
> 
> 标签：vb.net, using, using-statement, scalar, executescalar

你能展示一个带有标量查询的“Using”语句的编码示例吗？

我无法通过搜索找到任何示例编码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T22:45:58.457

以下是 MSDN 页面上有关 ExecuteScalar 方法的示例：

```
Public Function AddProductCategory(ByVal newName As String, ByVal connString As String) As Integer
    Dim newProdID As Int32 = 0
    Dim sql As String = _
     "INSERT INTO Production.ProductCategory (Name) VALUES (@Name); SELECT CAST(scope_identity() AS int);"

    Using conn As New SqlConnection(connString)
        Dim cmd As New SqlCommand(sql, conn)
        cmd.Parameters.Add("@Name", SqlDbType.VarChar)
        cmd.Parameters("@Name").Value = newName
        Try
            conn.Open()
            newProdID = Convert.ToInt32(cmd.ExecuteScalar())
        Catch ex As Exception
            Console.WriteLine(ex.Message)
        End Try
    End Using

    Return newProdID
End Function 
```

这是链接：

[http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.executescalar.aspx#Y374](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.executescalar.aspx#Y374)

# javascript - 如何替换“”之外的字符串的子字符串

> ID：10825060
> 
> 赞同：1
> 
> 时间：2012-05-30T22:19:56.613
> 
> 标签：javascript, regex

我有一个像这样的字符串：

```
'a, b, "c,d" e, f,' 
```

我想使用逗号字符作为分隔符拆分我的字符串，但在括号之外。我的结果对象集应包含以下元素：

```
a
b
"c,d" e
f 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T22:27:41.550

```
s = 'a, b, "c,d" e, f,';
console.log(s.match(/("[^"]+"|[^,])+/g)); 
```

yield `[ 'a', ' b', ' "c,d" e', ' f' ]`，它有额外的空格，但你可以修剪它们。

**编辑：**错过了`e`......现在已修复。

**解释：**

*   `(A|B)+`首选`A`（这是一个带引号的字符串）而不是 B，它是字符串的未引用部分。它匹配`"c,d"`，然后因为`+`它继续匹配`e`。
*   `"[^"]+"`匹配 a`"`后跟所有非`"`, 后跟单个`"`.
*   `[^,]`匹配任何非`"`
*   `/regex/g`使全局（匹配所有匹配项，而不仅仅是第一个匹配项）

# ruby-on-rails - 有效地检索给定时间段的 ice_cube 时间表

> ID：10825066
> 
> 赞同：6
> 
> 时间：2012-05-30T22:20:37.970
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ice-cube

我正在研究使用 Ice Cube [https://github.com/seejohnrun/ice_cube](https://github.com/seejohnrun/ice_cube)来处理重复事件。我的问题是，如果我需要在给定的时间段内（例如，一天或一周内）获取任何事件，有没有比像这样循环遍历它们更好的方法：

```
items = Records.find(:all)
items.each do |item|
  schedule = item.schedule
  if schedule.occurs_on?(Date.new)
      #if today is a recurrence, add to array
  end
end 
```

这似乎非常低效，但我不知道该怎么做。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-04T16:05:09.097

这是一种方法——但人们更常做的是最终将他们的日程表非规范化为一种便于查询的格式。

您可能有一个名为 ScheduleOccurrences 的集合 - 您每周构建/然后查询它。

不幸的是，它必须以这种方式工作，但坚持 iCal 管理时间表的方式导致 IceCube 需要以某些方式格式化其数据（特别是可以符合 iCal RFC 要求的方式）。

我最近一直在思考一个图书馆会是什么样子，它会摆脱一些限制，以获得更大的灵活性——但它肯定还是有点偏离。

希望这可以帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-06-01T16:21:46.920

我遇到了类似的问题，这是我的方法：

在 Event 表上创建一个列来存储下一次发生日期，并编写一个方法来存储该值 after_save。（通过 ice_cube 可用的方法。也许索引列也可以更快地查询。）

然后，您可以在数据库中查询您需要的时间范围内发生的事件。见下文：

`Event.where(next_occurrence: Date.today.all_day)`

将 EventOccurrences 存储在单独的表中。

更新查询返回给您的行的 next_occurrence 列。或类似的东西。这对我有用，因为我正在运行一项日常工作，因此更新 next_occurrence 将定期运行。但是你可能需要稍微调整一下。

# java - Java整数数学从0-4连续循环

> ID：10825067
> 
> 赞同：0
> 
> 时间：2012-05-30T22:20:40.510
> 
> 标签：java, math, loops, code-formatting

有没有更好的方法来计算我在下面做的计数？

我确信这必须通过模数或其他东西来实现。我正在寻找某种方式来操纵`i`而不是使用额外的变量`x`。（美化这一点）。

这是很长的路要走：

```
int MAX = 4;
int x = 0;
for (int i = 0; i < 50; i++) {
   System.out.print(x); 
   if(x++; == MAX)
      x = 0;
} 
```

预期结果：// 0 1 2 3 0 1 2 3 0 1 2 3 0 1 2 3 .. 等

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-30T22:24:45.263

```
for (int i = 0; i < 50; i++) {   System.out.print(i % MAX); } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-30T22:22:50.773

是的，你可以这样做`x = i % MAX;`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T22:28:35.857

你的代码很清楚。虽然模数 % 可能会为您节省一些击键次数，但这不是必需的。自然的人类表达通常是首选，特别是如果您在凌晨 4 点编码或 6 个月后返回您的代码。

# windows - 在 Windows 上将 shQuote 与 R 一起使用

> ID：10825069
> 
> 赞同：1
> 
> 时间：2012-05-30T22:20:58.640
> 
> 标签：windows, r

我正在测试 R (Windows) 中的 bio3d 包，遇到了一个相当普遍的问题：

bio3d 中的“seqaln”函数尝试发出以下系统命令：

```
#cmd = "muscle -in C:\\Users\\derek\\AppData\\Local\\Temp\\RtmpUSXJCb\\file756f52c9 -out c:/pdb/temp.fas  -seqtype protein"
system(shQuote(cmd)) 
```

据我所知，什么也没发生。但是，一旦我删除了“shQuote”，该函数 - seqaln - 就会按预期工作。shQuote 所做的一切都是在命令周围添加一对“”：

```
"\"C:/_utils/muscle.exe -in C:\\Users\\kfoo\\AppData\\Local\\Temp\\RtmpUSXJCb\\file756f52c9 -out c:/pdb/temp.fas  -seqtype protein\"" 
```

使用 shQuote 有什么问题吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T23:41:38.337

问题是您正在应用`shQuote()`一个包含命令及其参数的字符串。中的示例都`shQuote()`没有这样做，您也不应该这样做！

以下内容不起作用，原因与直接在 Windows命令行`\"echo HelloWorld\"`键入时失败的原因相同：`cmd`

```
system(shQuote("echo HelloWorld")) 
```

相反，您应该执行以下操作：

```
system("echo HelloWorld")
# HelloWorld 
```

或者，如果您的命令及其参数都可能包含空格，则可以`shQuote()`这样使用：

```
system(paste(shQuote("echo"), shQuote("HelloWorld")))
# HelloWorld 
```

# android - Facebook连接填写用户数据| 安卓

> ID：10825070
> 
> 赞同：0
> 
> 时间：2012-05-30T22:20:59.027
> 
> 标签：android, facebook

我在我的 android 应用程序中使用 facebook 连接。它基本上是一种形式。页面上有一个facebook登录按钮。我希望在用户使用 Facebook 登录时填写表单上的信息。

我正在尝试以下代码：

```
public void loginFB()  {
    facebook.authorize(this, new String[] { "email", "read_stream" }, new DialogListener() {                
        @Override
        public void onComplete(Bundle values) {}

        @Override
        public void onFacebookError(FacebookError error) {}

        @Override
        public void onError(DialogError e) {}

        @Override
        public void onCancel() {}
    });

    getlogininfo();
}                 

public void getlogininfo(){
    mAsyncRunner.request("me", new RequestListener(){
        @Override
        public void onComplete(String response, Object state) {
            try{
                Log.d("Profile", response.toString());
                JSONObject json = Util.parseJson(response);
                final String fname1 = json.getString("first_name");
                final String lname1 = json.getString("last_name");
                    final String email = json.getString("email");
                    MintPaymentsActivity.this.runOnUiThread(new Runnable(){
                        public void run() {
                            fname.setText(fname1);
                            lname.setText(lname1);
                            emailadd.setText(email);
                        }
                    });
                }
                catch(JSONException e){
                    Log.w("This", "eror");
                }
            }

            @Override
            public void onIOException(IOException e, Object state) {
                // TODO Auto-generated method stub
            }
            @Override
            public void onFileNotFoundException(FileNotFoundException e, Object state) {
                // TODO Auto-generated method stub
            }

            @Override
            public void onMalformedURLException(MalformedURLException e, Object state) {
                // TODO Auto-generated method stub
            }

            @Override
            public void onFacebookError(FacebookError e, Object state) {
                // TODO Auto-generated method stub
            }
        });
}

/*FB --- */
@Override
public void onActivityResult(int requestCode, int resultCode, Intent data) {
    super.onActivityResult(requestCode, resultCode, data);

    facebook.authorizeCallback(requestCode, resultCode, data);
} 
```

基本上，当用户单击按钮时，facebook 会要求登录，然后收集 JSON 数据以显示登录用户的姓名和电子邮件。

它给了我以下错误：

```
05-30 21:52:40.598: E/AndroidRuntime(665): FATAL EXCEPTION: Thread-13
05-30 21:52:40.598: E/AndroidRuntime(665): com.facebook.android.FacebookError: An active access token must be used to query information about the current user.
05-30 21:52:40.598: E/AndroidRuntime(665):  at com.facebook.android.Util.parseJson(Util.java:279)
05-30 21:52:40.598: E/AndroidRuntime(665):  at com.Myapp.Myapp$2.onComplete(Myapp.java:117)
05-30 21:52:40.598: E/AndroidRuntime(665):  at com.facebook.android.AsyncFacebookRunner$2.run(AsyncFacebookRunner.java:254) 
```

当我放置一个额外的按钮来填写详细信息时，以便在`getlogininfo()`单击按钮时实现（登录后）它工作正常。但我希望在用户单击 facebook 登录按钮后立即填写。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T23:38:50.197

它应该是：

```
public void loginFB() {
    facebook.authorize(this, new String[] { "email", "read_stream" }, new DialogListener() {                
        @Override
        public void onComplete(Bundle values) {
            this.getlogininfo();
        }

        @Override
        public void onFacebookError(FacebookError error) {}

        @Override
        public void onError(DialogError e) {}

        @Override
        public void onCancel() {}
    });
} 
```

您只想**在**`getLogininfo`身份验证完成后执行。 另外，我建议您也处理错误，至少将其记录下来，以便您在开发时知道。

# android - 如何让我的 SQL 数据库正常工作以便存储图像？

> ID：10825072
> 
> 赞同：-1
> 
> 时间：2012-05-30T22:21:12.947
> 
> 标签：android, sql

我的应用程序正在显示各种文本字段、日期和时间选择器，最重要的是，还有一个图像按钮。图片按钮有自己的 sql 数据库，而文本字段、日期和时间选择器存储在另一个 sql 数据库中。

当您单击图像按钮时，您可以选择前往画廊。我的问题是：为什么我的应用程序在单击图库中的一张图片后崩溃。onActivityResult 方法一定有问题，但我想不通。我的应用程序有什么问题，我怎样才能让它工作？

这是我的活动代码：

```
public class ReminderEditActivity extends Activity {

//
// Private instance variables
//
private Button mDateButton;
private Calendar mCalendar;
private Button mTimeButton;
private EditText mTitleText;
private EditText mBodyText;
private Button mConfirmButton;

private RemindersDbAdapter mDbHelper;
private ImageAdapter mImageHelper;

private Long mRowId;
private Long mImageRowId;

private ImageButton mImageButton;

private Uri mImageCaptureUri;

public String imageFilePath;

//
// Private constants
//
private static final int DATE_PICKER_DIALOG = 0;
private static final int TIME_PICKER_DIALOG = 1;
private static final String DATE_FORMAT = "dd-MM-yyyy";
private static final String TIME_FORMAT = "kk:mm";

public static final String DATE_TIME_FORMAT = "dd-MM-yyyy kk:mm:ss";

private static final int PICK_FROM_CAMERA = 1;
private static final int PICK_FROM_FILE = 2;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    // Instantiate mDbHelper and mImageHelper
    mDbHelper = new RemindersDbAdapter(this);
    mImageHelper = new ImageAdapter(this);

    setContentView(R.layout.reminder_edit);

    //
    // Instantiate instance variables
    //
    mTimeButton = (Button)findViewById(R.id.reminder_time);
    mCalendar = Calendar.getInstance();
    mDateButton = (Button)findViewById(R.id.reminder_date);
    mConfirmButton = (Button)findViewById(R.id.confirm);
    mTitleText = (EditText)findViewById(R.id.title);
    mBodyText = (EditText)findViewById(R.id.body);

    mImageButton =(ImageButton)findViewById(R.id.image);

    //Checks whether mRowId contains any values.
    mRowId = savedInstanceState != null ? savedInstanceState.getLong(RemindersDbAdapter.KEY_ROWID) : null;
    //mImageRowId = savedInstanceState != null ? savedInstanceState.getLong(ImageAdapter.KEY_ROWID) : null;

    registerButtonListenerandSetDefaultText();
}

//
// Sets the row id from the intent. If mRowId is null its content is null.
//
private void setRowIdFromIntent() {
    if(mRowId == null) {
        Bundle extras = getIntent().getExtras();
        mRowId = extras != null ? extras.getLong(RemindersDbAdapter.KEY_ROWID) : null;
    }
}

//
// Executed on pause.
//
@Override
protected void onPause() {
    super.onPause();
    mDbHelper.close();
    mImageHelper.close();
}

//
// Executed on resume
//
@Override
protected void onResume() {
    super.onResume();
    mDbHelper.open();
    mImageHelper.open();
    setRowIdFromIntent();
    populateFields();
    populateImageField();
}

//
// Register the Date, Time and Save Button and set the default text
//
private void registerButtonListenerandSetDefaultText() {

    mDateButton.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View v) {
            showDialog(DATE_PICKER_DIALOG); 
        }
    });

    mTimeButton.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View v) {
            showDialog(TIME_PICKER_DIALOG);
        }
    });

    mConfirmButton.setOnClickListener(new View.OnClickListener() {
        public void onClick(View view) {
            saveState();
            setResult(RESULT_OK);
            Toast.makeText(ReminderEditActivity.this, getString(R.string.task_saved_message), Toast.LENGTH_SHORT).show();
            finish();
        }
    }); 

    mImageButton.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View v) {
            showImageDialog();
        }
    });

    updateDateButtonText();
    updateTimeButtonText(); 
}

private void showImageDialog() {
    final String [] items = new String [] {"From Camera", "From SD Card"};
    ArrayAdapter<String> adapter = new ArrayAdapter<String> (this, android.R.layout.select_dialog_item,items);
    AlertDialog.Builder builder = new AlertDialog.Builder(this);

    builder.setTitle("Select Image");
    builder.setAdapter( adapter, new DialogInterface.OnClickListener() {
        public void onClick( DialogInterface dialog, int item ) {
            if (item == 0) {
                Intent intent = new Intent(MediaStore.ACTION_IMAGE_CAPTURE);
                File file = new File(Environment.getExternalStorageDirectory(),
                                    "tmp_avatar_" + String.valueOf(System.currentTimeMillis()) + ".jpg");
                mImageCaptureUri = Uri.fromFile(file);

                try {
                    intent.putExtra(android.provider.MediaStore.EXTRA_OUTPUT, mImageCaptureUri);
                    intent.putExtra("return-data", true);

                    startActivityForResult(intent, PICK_FROM_CAMERA);
                } catch (Exception e) {
                    e.printStackTrace();
                }

                dialog.cancel();
            } else {
                Intent intent = new Intent();

                intent.setType("image/*");
                intent.setAction(Intent.ACTION_GET_CONTENT);

                startActivityForResult(Intent.createChooser(intent, "Complete action using"), PICK_FROM_FILE);
            }
        }
    } );

    final AlertDialog dialog = builder.create();
    dialog.show();
}

@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
       if(requestCode == PICK_FROM_FILE && data != null && data.getData() != null) {
           Uri uri = data.getData();
           if(uri != null) {
              Cursor cursor = getContentResolver().query(uri, new String[] {   
                                       android.provider.MediaStore.Images.ImageColumns.DATA}, 
                                       null, null, null);
                    cursor.moveToFirst();
                    String imagePath = cursor.getString(0);             
                    cursor.close();

                    if(imagePath != null) {
                        // Save the image to the database
                        long id = mImageHelper.createImage(imagePath);
                        if (id > 0) {
                            mRowId = id;
                        } 
                        // Set the image and display it in the edit activity
                        Bitmap bitmap = BitmapFactory.decodeFile(imagePath);
                        mImageButton.setImageBitmap(bitmap);
                        }
           }
       }
    }

//
// If mRowId is not null (it contains value and we want to edit the task)
// this method is called.
//
private void populateFields() {
    if (mRowId != null) {
        Cursor reminder = mDbHelper.fetchReminder(mRowId);
        startManagingCursor(reminder);
        mTitleText.setText(reminder.getString(reminder.getColumnIndexOrThrow(RemindersDbAdapter.KEY_TITLE)));
        mBodyText.setText(reminder.getString(reminder.getColumnIndexOrThrow(RemindersDbAdapter.KEY_BODY)));

        SimpleDateFormat dateTimeFormat = new SimpleDateFormat(DATE_TIME_FORMAT);
        Date date = null;
        try {
            String dateString = reminder.getString(reminder.getColumnIndexOrThrow(RemindersDbAdapter.KEY_DATE_TIME));
            date = dateTimeFormat.parse(dateString);
            mCalendar.setTime(date);
        } catch (ParseException e) {
            Log.e("ReminderEditActivity", e.getMessage(), e);
        }
    } 

    updateDateButtonText();
    updateTimeButtonText();
}

private void populateImageField() {
    if (mImageRowId != null) {
        Cursor reminderImage = mImageHelper.fetchImage(mImageRowId);
        startManagingCursor(reminderImage);
        String imagePath = reminderImage.getString(reminderImage.getColumnIndexOrThrow(ImageAdapter.KEY_IMAGE));

        Bitmap bitmap = BitmapFactory.decodeFile(imagePath);
        mImageButton.setImageBitmap(bitmap);

    }
} 

//
// Saves the state so that it can be restored.
//
@Override
protected void onSaveInstanceState(Bundle outState) {

    outState.putLong(RemindersDbAdapter.KEY_ROWID, mRowId);
    super.onSaveInstanceState(outState);
}

//
// Saves the content by communicating with the RemindersDbAdapter.
//
private void saveState() {
    String title = mTitleText.getText().toString();
    String body = mBodyText.getText().toString();

    SimpleDateFormat dateTimeFormat = new SimpleDateFormat(DATE_TIME_FORMAT);
    String reminderDateTime = dateTimeFormat.format(mCalendar.getTime());

    // Creates a new reminder if the value is null.
    if (mRowId == null) {
        long id = mDbHelper.createReminder(title, body, reminderDateTime);
        if (id > 0) {
            mRowId = id;

        } 
    // Updates the reminder if the content is not null.     
    } else {
        mDbHelper.updateReminder(mRowId, title, body, reminderDateTime);
    }
}

//
// Opens up an alert dialog box and asks the user if he wants to discard his task.
//
@Override
public void onBackPressed() {
    AlertDialog.Builder builder = new AlertDialog.Builder(ReminderEditActivity.this);
    builder.setMessage("Are you sure you want to discard your task?");
            builder.setTitle("Are you sure?");
            builder.setCancelable(false);
            builder.setPositiveButton("Yes", new DialogInterface.OnClickListener() {

                @Override
                public void onClick(DialogInterface dialog, int id) {
                    Intent j = new Intent(((Dialog)dialog).getContext(), ReminderListActivity.class);
                    startActivity(j);
                    return;

                }
            });

            builder.setNegativeButton("No", new DialogInterface.OnClickListener() {

                @Override
                public void onClick(DialogInterface dialog, int id) {
                    dialog.cancel();

                }
            });
            builder.create().show();        
}

//
// When creating a dialog box, it either shows up a date or time picker.
//
@Override
protected Dialog onCreateDialog(int id) {
    switch (id) {
        case DATE_PICKER_DIALOG:
            return showDatePicker();
        case TIME_PICKER_DIALOG:
            return showTimePicker();
    }
    return super.onCreateDialog(id);
}

//
// Creates the date picker dialog box.
//
private DatePickerDialog showDatePicker() {
    DatePickerDialog datePicker = new DatePickerDialog(ReminderEditActivity.this, new DatePickerDialog.OnDateSetListener() {

        @Override
        public void onDateSet(DatePicker view, int year, int monthOfYear, int dayOfMonth) {
            mCalendar.set(Calendar.YEAR, year);
            mCalendar.set(Calendar.MONTH, monthOfYear);
            mCalendar.set(Calendar.DAY_OF_MONTH, dayOfMonth);
            updateDateButtonText();
        }
    }, mCalendar.get(Calendar.YEAR), mCalendar.get(Calendar.MONTH), mCalendar.get(Calendar.DAY_OF_MONTH));
    return datePicker;
}

//
// Creates the time picker dialog box.
//
private TimePickerDialog showTimePicker() {
    TimePickerDialog timePicker = new TimePickerDialog(ReminderEditActivity.this, new TimePickerDialog.OnTimeSetListener() {

        @Override
        public void onTimeSet(TimePicker view, int hourOfDay, int minute) {
            mCalendar.set(Calendar.HOUR_OF_DAY, hourOfDay);
            mCalendar.set(Calendar.MINUTE, minute);
            updateTimeButtonText();
        }
    }, mCalendar.get(Calendar.HOUR_OF_DAY), mCalendar.get(Calendar.MINUTE), true);
    return timePicker;
}

//
// Updates the Date Button text.
//
private void updateDateButtonText() {
    SimpleDateFormat dateFormat = new SimpleDateFormat(DATE_FORMAT);
    String dateForButton = dateFormat.format(mCalendar.getTime());
    mDateButton.setText(dateForButton);
}

//
// Updates the Time Button text.
//
private void updateTimeButtonText() {
    SimpleDateFormat timeFormat = new SimpleDateFormat(TIME_FORMAT);
    String timeForButton = timeFormat.format(mCalendar.getTime());
    mTimeButton.setText(timeForButton);
} 
```

}

这是我的图像数据库：

```
public class ImageAdapter {

//
// Database Related Constants
//
private static final String DATABASE_NAME = "dataImage";
private static final String DATABASE_TABLE = "remindersImage";
private static final int DATABASE_VERSION = 3;

public static final String KEY_IMAGE = "image";
public static final String KEY_ROWID = "_id";

private static final String TAG = "ImageAdapter";
private DatabaseHelper mImageHelper;
private SQLiteDatabase mImageDb;

/**
 * Database creation SQL statement
 */
private static final String DATABASE_CREATE =
        "create table " + DATABASE_TABLE + " ("
                + KEY_IMAGE + " integer primary key autoincrement);";

private final Context mImageCtx;

private static class DatabaseHelper extends SQLiteOpenHelper {

    DatabaseHelper(Context context) {
        super(context, DATABASE_NAME, null, DATABASE_VERSION);
    }

    @Override
    public void onCreate(SQLiteDatabase db) {

        db.execSQL(DATABASE_CREATE);
    }

    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
        Log.w(TAG, "Upgrading database from version " + oldVersion + " to "
                + newVersion + ", which will destroy all old data");
        db.execSQL("DROP TABLE IF EXISTS " + DATABASE_TABLE);
        onCreate(db);
    }
}

/**
 * Constructor - takes the context to allow the database to be
 * opened/created
 * 
 * @param ctx the Context within which to work
 */
public ImageAdapter(Context ctx) {
    this.mImageCtx = ctx;
}

/**
 * Open the database. If it cannot be opened, try to create a new
 * instance of the database. If it cannot be created, throw an exception to
 * signal the failure
 * 
 * @return this (self reference, allowing this to be chained in an
 *         initialization call)
 * @throws SQLException if the database could be neither opened or created
 */
public ImageAdapter open() throws SQLException {
    mImageHelper = new DatabaseHelper(mImageCtx);
    mImageDb = mImageHelper.getWritableDatabase();
    return this;
}

public void close() {
    mImageHelper.close();
}

// Create new image entry
public long createImage(String image) {
    ContentValues initialValues = new ContentValues();
    initialValues.put(KEY_IMAGE, image);

    return mImageDb.insert(DATABASE_TABLE, null, initialValues);
}

// Delete image.
public boolean deleteImage(long rowId) {

    return mImageDb.delete(DATABASE_TABLE, KEY_ROWID + "=" + rowId, null) > 0;
}

public Cursor fetchAllImages() {

    return mImageDb.query(DATABASE_TABLE, new String[] {KEY_ROWID, KEY_IMAGE}, null, null, null, null, null);
}

public Cursor fetchImage(long rowId) throws SQLException {

    Cursor mCursor =

            mImageDb.query(true, DATABASE_TABLE, new String[] {KEY_ROWID,
                    KEY_IMAGE}, KEY_ROWID + "=" + rowId, null,
                    null, null, null, null);
    if (mCursor != null) {
        mCursor.moveToFirst();
    }
    return mCursor;

}

public boolean updateImages(long rowId, String image) {
    ContentValues args = new ContentValues();
    args.put(KEY_IMAGE, image);

    return mImageDb.update(DATABASE_TABLE, args, KEY_ROWID + "=" + rowId, null) > 0;
}
} 
```

这是 LogCat：

```
05-31 00:16:14.372: E/ActivityThread(528): Activity com.android.internal.app.ChooserActivity has leaked IntentReceiver com.android.internal.app.ResolverActivity$1@4155fa60 that was originally registered here. Are you missing a call to unregisterReceiver()?
05-31 00:16:14.372: E/ActivityThread(528): android.app.IntentReceiverLeaked: Activity com.android.internal.app.ChooserActivity has leaked IntentReceiver com.android.internal.app.ResolverActivity$1@4155fa60 that was originally registered here. Are you missing a call to unregisterReceiver()?
05-31 00:16:14.372: E/ActivityThread(528):  at android.app.LoadedApk$ReceiverDispatcher.<init>(LoadedApk.java:763)
05-31 00:16:14.372: E/ActivityThread(528):  at android.app.LoadedApk.getReceiverDispatcher(LoadedApk.java:567)
05-31 00:16:14.372: E/ActivityThread(528):  at android.app.ContextImpl.registerReceiverInternal(ContextImpl.java:1043)
05-31 00:16:14.372: E/ActivityThread(528):  at android.app.ContextImpl.registerReceiver(ContextImpl.java:1030)
05-31 00:16:14.372: E/ActivityThread(528):  at android.app.ContextImpl.registerReceiver(ContextImpl.java:1024)
05-31 00:16:14.372: E/ActivityThread(528):  at android.content.ContextWrapper.registerReceiver(ContextWrapper.java:341)
05-31 00:16:14.372: E/ActivityThread(528):  at com.android.internal.content.PackageMonitor.register(PackageMonitor.java:65)
05-31 00:16:14.372: E/ActivityThread(528):  at com.android.internal.app.ResolverActivity.onCreate(ResolverActivity.java:99)
05-31 00:16:14.372: E/ActivityThread(528):  at com.android.internal.app.ChooserActivity.onCreate(ChooserActivity.java:53)
05-31 00:16:14.372: E/ActivityThread(528):  at android.app.Activity.performCreate(Activity.java:4465)
05-31 00:16:14.372: E/ActivityThread(528):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049)
05-31 00:16:14.372: E/ActivityThread(528):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1920)
05-31 00:16:14.372: E/ActivityThread(528):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1981)
05-31 00:16:14.372: E/ActivityThread(528):  at android.app.ActivityThread.access$600(ActivityThread.java:123)
05-31 00:16:14.372: E/ActivityThread(528):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1147)
05-31 00:16:14.372: E/ActivityThread(528):  at android.os.Handler.dispatchMessage(Handler.java:99)
05-31 00:16:14.372: E/ActivityThread(528):  at android.os.Looper.loop(Looper.java:137)
05-31 00:16:14.372: E/ActivityThread(528):  at android.app.ActivityThread.main(ActivityThread.java:4424)
05-31 00:16:14.372: E/ActivityThread(528):  at java.lang.reflect.Method.invokeNative(Native Method)
05-31 00:16:14.372: E/ActivityThread(528):  at java.lang.reflect.Method.invoke(Method.java:511)
05-31 00:16:14.372: E/ActivityThread(528):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
05-31 00:16:14.372: E/ActivityThread(528):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
05-31 00:16:14.372: E/ActivityThread(528):  at dalvik.system.NativeStart.main(Native Method)
05-31 00:16:17.051: D/AndroidRuntime(528): Shutting down VM
05-31 00:16:17.061: W/dalvikvm(528): threadid=1: thread exiting with uncaught exception (group=0x409c01f8)
05-31 00:16:17.102: E/AndroidRuntime(528): FATAL EXCEPTION: main
05-31 00:16:17.102: E/AndroidRuntime(528): java.lang.RuntimeException: Failure delivering result ResultInfo{who=null, request=2, result=-1, data=Intent { dat=content://media/external/images/media/22 }} to activity {com.ndroidstudios.android.taskreminder/com.ndroidstudios.android.taskreminder.ReminderEditActivity}: java.lang.NullPointerException
05-31 00:16:17.102: E/AndroidRuntime(528):  at android.app.ActivityThread.deliverResults(ActivityThread.java:2980)
05-31 00:16:17.102: E/AndroidRuntime(528):  at android.app.ActivityThread.handleSendResult(ActivityThread.java:3023)
05-31 00:16:17.102: E/AndroidRuntime(528):  at android.app.ActivityThread.access$1100(ActivityThread.java:123)
05-31 00:16:17.102: E/AndroidRuntime(528):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1177)
05-31 00:16:17.102: E/AndroidRuntime(528):  at android.os.Handler.dispatchMessage(Handler.java:99)
05-31 00:16:17.102: E/AndroidRuntime(528):  at android.os.Looper.loop(Looper.java:137)
05-31 00:16:17.102: E/AndroidRuntime(528):  at android.app.ActivityThread.main(ActivityThread.java:4424)
05-31 00:16:17.102: E/AndroidRuntime(528):  at java.lang.reflect.Method.invokeNative(Native Method)
05-31 00:16:17.102: E/AndroidRuntime(528):  at java.lang.reflect.Method.invoke(Method.java:511)
05-31 00:16:17.102: E/AndroidRuntime(528):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
05-31 00:16:17.102: E/AndroidRuntime(528):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
05-31 00:16:17.102: E/AndroidRuntime(528):  at dalvik.system.NativeStart.main(Native Method)
05-31 00:16:17.102: E/AndroidRuntime(528): Caused by: java.lang.NullPointerException
05-31 00:16:17.102: E/AndroidRuntime(528):  at android.database.sqlite.SQLiteStatement.releaseAndUnlock(SQLiteStatement.java:290)
05-31 00:16:17.102: E/AndroidRuntime(528):  at android.database.sqlite.SQLiteStatement.executeInsert(SQLiteStatement.java:115)
05-31 00:16:17.102: E/AndroidRuntime(528):  at android.database.sqlite.SQLiteDatabase.insertWithOnConflict(SQLiteDatabase.java:1718)
05-31 00:16:17.102: E/AndroidRuntime(528):  at android.database.sqlite.SQLiteDatabase.insert(SQLiteDatabase.java:1591)
05-31 00:16:17.102: E/AndroidRuntime(528):  at com.ndroidstudios.android.taskreminder.ImageAdapter.createImage(ImageAdapter.java:113)
05-31 00:16:17.102: E/AndroidRuntime(528):  at com.ndroidstudios.android.taskreminder.ReminderEditActivity.onActivityResult(ReminderEditActivity.java:232)
05-31 00:16:17.102: E/AndroidRuntime(528):  at android.app.Activity.dispatchActivityResult(Activity.java:4649)
05-31 00:16:17.102: E/AndroidRuntime(528):  at android.app.ActivityThread.deliverResults(ActivityThread.java:2976)
05-31 00:16:17.102: E/AndroidRuntime(528):  ... 11 more 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T22:49:37.440

我认为您的数据库创建语句是错误的......目前，您正试图将一个字符串存储在一个整数列中，并且该整数列甚至被标记为自动增量。

```
private static final String DATABASE_CREATE = "create table " + DATABASE_TABLE + " (" + KEY_IMAGE + " integer primary key autoincrement);"; 
```

KEY_ROWID 不包含在语句中，可能是您想要作为主键的列。如果要在其中存储字符串，则 KEY_IMAGE 必须是一列字符串。

像这样试试

```
private static final String DATABASE_CREATE = "CREATE TABLE IF NOT EXISTS " + DATABASE_TABLE +   " (" + KEY_ROWID + " integer primary key autoincrement, " + KEY_IMAGE + " text not null);"; 
```

记得在修改create语句后清除数据，或者升级数据库版本。

# javascript - 如何使用 Mootools 支持 IE 8-9 中的“占位符”属性？

> ID：10825075
> 
> 赞同：0
> 
> 时间：2012-05-30T22:21:36.097
> 
> 标签：javascript, html, internet-explorer, mootools, placeholder

其他人也问过这个问题，但答案都是针对 jQuery 的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-31T01:19:04.433

首先，您应该使用 Mootools 插件“OverText” [http://mootools.net/docs/more/Forms/OverText](http://mootools.net/docs/more/Forms/OverText)，它基本上模拟了这个功能。它实际上可以在任何浏览器中工作，因此，如果您愿意，您可以使用它并完全忘记占位符属性。但是，如果您想在可用时支持占位符但在旧版浏览器中使用 OverText，您可以这样做：

```
window.addEvent('domready', function() {
    // create a test element
    var test = new Element('input'); 
    // if it has 'placeholder' this browser supports it already so you can exit
    if(("placeholder" in test)) { return; } 
    // for older browsers, get all the inputs which you have assigned a 'placeholder' attribute to
    $$('input[placeholder]').each(function(el) { 
        // and create an overtext for them using the value of the placeholder attribute
        new OverText(el, { textOverride: el.get('placeholder') });
    });
}); 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-05-30T22:21:36.300

```
/**
 * IE doesn't support the placeholder attribute, but we can set the value attribute.
 */
if (Browser.Engines.trident()) {
  var elements = $$('input[placeholder]');
  elements.map(function(it) {
    if (!it.getAttribute('value')) {
      it.setAttribute('value', it.getAttribute('placeholder'));
      it.onfocus = function() {
        it.setAttribute('value', '');
        it.onfocus = null;
      }
    }
  });
} 
```

# java - 你知道任何 Java 字节码解释器吗？

> ID：10825079
> 
> 赞同：1
> 
> 时间：2012-05-30T22:21:38.500
> 
> 标签：java, interpreter, bytecode

我正在寻找 Java 解释器而不是 JVM（无 JIT）

到现在我已经检查过了

*   llvm vmkit
*   gij（来自 gcj）
*   jikesrvm (JVM)
*   卡夫 (JVM)

但是，由于我只需要一个解释器，我更愿意找到更简单、更小（在 LOC 中）的东西，最好用 C/C++ 编写

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T16:22:37.700

JamVM，如果您不介意最新版本中的简单代码复制 JIT。“代码复制”可能意味着一种避免 switch 语句的简单方法。

见[http://jamvm.sourceforge.net/](http://jamvm.sourceforge.net/)

# excel - 在 Visual Basic / Excel 中处理日期

> ID：10825081
> 
> 赞同：0
> 
> 时间：2012-05-30T22:21:42.073
> 
> 标签：excel, vba, date, time

使用 Visual Basic / Excel 非常新。我正在尝试编写一个快速脚本，在一个列中输入当前时间，并允许用户输入多少天/小时/分钟将通过直到新的时间，并在另一列中输出。

我确信这不是最好的方法，但到目前为止我所拥有的如下。我已经放弃了摆弄日期，而只是在处理时间：

```
Sub TimeModule()
Dim DaysLeft, HoursLeft, MinutesLeft As Double
DaysLeft = Val(InputBox("Days left"))
HoursLeft = Val(InputBox("Hours left"))
MinutesLeft = Val(InputBox("Minutes left"))

Dim CurrentTime As Date
CurrentTime = TimeValue(Now())

ActiveCell.Value = CurrentTime
ActiveCell.Offset(0, 1) = CurrentTime + Time(HoursLeft, MinutesLeft, 0)

End Sub 
```

当然，我遇到了一个错误。如果有人能阐明更好的方法来做到这一点，以及我滥用的功能，我将不胜感激！

编辑：我当然最终希望脚本也能处理好几天。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T22:54:57.797

如果我理解正确的话，我认为这仅在 Excel 中使用单元格函数是可能的。

例如，这就是你所看到的......

```
Time Now:           Days:   Hours:  Minutes:    New Time:
30/05/2012 23:34    15      6       23          15/06/2012 05:57 
```

...这就是每个单元格中的内容（假设左上角的单元格是 A1）...

```
Time Now:   Days:   Hours:  Minutes:   New Time:
=NOW()      15      6       23         =A2+B2+TIME(C2,D2,0) 
```

* * *

描述每个功能：

*   `NOW()`返回格式化为日期和时间的当前日期和时间。
*   `DATE(year,month,day)`返回代表 MS Excel 日期时间代码中的日期的数字。
*   `TIME(hours,minutes,seconds)`将以数字形式给出的小时、分钟和秒转换为 Excel 序列号，格式为时间格式。

剖析最后一个单元格中的方程：

*   `A2`是包含当前日期/时间的单元格（截至上次工作表计算）。
*   `B2`是用户输入的天数。
*   `TIME(C2,D2,0)``C2`是 TIME() 函数，分别从单元格中获取用户输入的小时和分钟值`D2`。

* * *

这是否像您预期的功能......？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T07:15:01.497

如果您想使用 VBA，您的代码的唯一问题是“时间”功能。您可以改用 CDate ：

```
Sub TimeModule()
  Dim DaysLeft, HoursLeft, MinutesLeft As Double
  DaysLeft = Val(InputBox("Days left"))
  HoursLeft = Val(InputBox("Hours left"))
  MinutesLeft = Val(InputBox("Minutes left"))

  Dim CurrentTime As Date
  CurrentTime = TimeValue(Now())

  ActiveCell.Value = Now()
  ActiveCell.Offset(0, 1) = ActiveCell.Value + DaysLeft + CDate(HoursLeft & ":" & MinutesLeft)
  'ActiveCell.Offset(0, 1) = CurrentTime + Time(HoursLeft, MinutesLeft, 0)

End Sub 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T18:51:40.907

当您以这种方式“调暗”时，您必须记录每个变量的数据类型。您拥有 MinutesLeft 的方式是 Double 并且所有内容（默认情况下）都是 Variant。

您正在寻找的时间函数是 TimeSerial。

日期存储为自某个日期以来的天数。要将日期添加到日期，您只需将数字相加即可。

```
Sub TimeModule()

    Dim lDaysLeft As Long
    Dim lHoursLeft As Long
    Dim lMinutesLeft As Double
    Dim dtCurrent As Date

    lDaysLeft = Val(InputBox("Days left"))
    lHoursLeft = Val(InputBox("Hours left"))
    lMinutesLeft = Val(InputBox("Minutes left"))

    dtCurrent = Now()

    ActiveCell.Value = dtCurrent
    ActiveCell.Offset(0, 1).Value = dtCurrent + lDaysLeft + TimeSerial(lHoursLeft, lMinutesLeft, 0)

End Sub 
```

# ruby-on-rails - Foreman gem 没有从 Procfile 加载我的服务，它们总是失败

> ID：10825084
> 
> 赞同：1
> 
> 时间：2012-05-30T22:21:47.717
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, foreman

在我的本地开发 OSX 上使用 Foreman GEM 我无法正确启动我的所有服务。我遇到了问题，所以我在每次重新启动时手动复制并粘贴 Procfile 中的行。非常令人沮丧

这是我的 **Procfile.rb：**

```
redis: redis-server
resque: bundle exec rake resque:start  &&> log/resque_worker_queue.log
privpub: bundle exec rackup private_pub.ru -s thin -E production & &> log/private_pub.log
sunspot: bundle exec rake sunspot:solr:run 
```

我总是必须通过复制粘贴终端工头启动中的命令来手动启动所有这些命令不起作用，我错过了什么？

**这是工头输出：**

```
 16:13:24 redis.1    | started with pid 11281
16:13:24 resque.1   | started with pid 11282
16:13:24 privpub.1  | started with pid 11283
16:13:24 sunspot.1  | started with pid 11284
16:13:24 redis.1    | [11281] 04 Jun 16:13:24 # Warning: no config file specified, using the default config. In order to specify a config file use 'redis-server /path/to/redis.conf'
16:13:24 redis.1    | [11281] 04 Jun 16:13:24 * Server started, Redis version 2.4.13
16:13:24 redis.1    | [11281] 04 Jun 16:13:24 * DB loaded from disk: 0 seconds
16:13:24 redis.1    | [11281] 04 Jun 16:13:24 * The server is now ready to accept connections on port 6379
16:13:25 redis.1    | [11281] 04 Jun 16:13:25 - DB 0: 21 keys (0 volatile) in 48 slots HT.
16:13:25 redis.1    | [11281] 04 Jun 16:13:25 - 0 clients connected (0 slaves), 955424 bytes in use
16:13:26 privpub.1  | /Users/jordan.rvm/gems/ruby-1.9.3-p194/gems/rack-1.4.1/lib/rack/builder.rb:43:in `require': cannot load such file -- /Users/jordan/rails/books/log/private_pub.log (LoadError)
16:13:26 privpub.1  |   from /Users/jordan/.rvm/gems/ruby-1.9.3-p194/gems/rack-1.4.1/lib/rack/builder.rb:43:in `parse_file'
16:13:26 privpub.1  |   from /Users/jordan/.rvm/gems/ruby-1.9.3-p194/gems/rack-1.4.1/lib/rack/server.rb:200:in `app'
16:13:26 privpub.1  |   from /Users/jordan/.rvm/gems/ruby-1.9.3-p194/gems/rack-1.4.1/lib/rack/server.rb:301:in `wrapped_app'
16:13:26 privpub.1  |   from /Users/jordan/.rvm/gems/ruby-1.9.3-p194/gems/rack-1.4.1/lib/rack/server.rb:252:in `start'
16:13:26 privpub.1  |   from /Users/jordan/.rvm/gems/ruby-1.9.3-p194/gems/rack-1.4.1/lib/rack/server.rb:137:in `start'
16:13:26 privpub.1  |   from /Users/jordan/.rvm/gems/ruby-1.9.3-p194/gems/rack-1.4.1/bin/rackup:4:in `<top (required)>'
16:13:26 privpub.1  |   from /Users/jordan/.rvm/gems/ruby-1.9.3-p194/bin/rackup:19:in `load'
16:13:26 privpub.1  |   from /Users/jordan/.rvm/gems/ruby-1.9.3-p194/bin/rackup:19:in `<main>'
16:13:26 privpub.1  | process terminated
16:13:26 system     | sending SIGTERM to all processes
16:13:26 system     | sending SIGTERM to pid 11281
16:13:26 redis.1    | [11281] 04 Jun 16:13:26 # Received SIGTERM, scheduling shutdown...
16:13:26 redis.1    | [11281] 04 Jun 16:13:26 # User requested shutdown...
16:13:26 redis.1    | [11281] 04 Jun 16:13:26 * Saving the final RDB snapshot before exiting.
16:13:26 redis.1    | [11281] 04 Jun 16:13:26 * DB saved on disk
16:13:26 redis.1    | [11281] 04 Jun 16:13:26 # Redis is now ready to exit, bye bye...
16:13:26 system     | sending SIGTERM to pid 11282
16:13:26 resque.1   | rake aborted!
16:13:26 resque.1   | SIGTERM
16:13:26 resque.1   | 
16:13:26 resque.1   | (See full trace by running task with --trace)
16:13:26 system     | sending SIGTERM to pid 11284
16:13:26 sunspot.1  | rake aborted!
16:13:26 sunspot.1  | SIGTERM
16:13:26 sunspot.1  | 
16:13:26 sunspot.1  | (See full trace by running task with --trace)
16:13:26 sunspot.1  | process terminated
16:13:26 resque.1   | process terminated
16:13:26 redis.1    | process terminated 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T21:56:44.947

尝试通过将第 2 行和第 3 行更改为：

```
resque: bundle exec rake resque:start
privpub: bundle exec rackup private_pub.ru -s thin -E production 
```

Foreman 可能在命令中遇到重定向问题：[https ://github.com/ddollar/foreman/issues/search?q=redirect](https://github.com/ddollar/foreman/issues/search?q=redirect)

# android - 基于接收广播意图启动网络通信的正确方法是什么？

> ID：10825087
> 
> 赞同：6
> 
> 时间：2012-05-30T22:21:59.010
> 
> 标签：android, multithreading, broadcastreceiver, android-c2dm, android-networking

我开始使用 Google 的 C2DM。此过程的一部分涉及在注册发生时接收广播意图。在[Google 的官方 C2DM 文档](https://developers.google.com/android/c2dm/)中，示例代码在 BrodcastReceiver 的 onReceive() 方法中显示了以下注释：

```
// Send the registration ID to the 3rd party site that is sending the messages.
// This should be done in a separate thread. 
```

但是，我读过的所有内容，包括[BroadcastReceiver 的文档](http://developer.android.com/reference/android/content/BroadcastReceiver.html)，都表明从 onReceive() 启动线程几乎肯定会导致问题，因为一旦 onReceive() 返回，该进程可能很快就会被终止。

有人可能只是犯了一个错误，我应该忽略关于使用单独线程的评论，但我猜他们这么说是有原因的，即使它具有误导性。

在返回之前是否有理由不能或不应该使用与 onReceive() 相同的线程中的网络？如果这样做有问题，那么处理必须是常见情况的正确方法是什么，即使在 C2DM 之外也是如此？启动服务？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T09:10:50.703

好的，在做了更多研究之后，我发现[了这个问题](https://stackoverflow.com/q/5674518/1427098)，并且[选择的答案](https://stackoverflow.com/a/5676888/1427098)状态`onReceive()`在 UI 线程上运行。我没有想到——因为这是一个清单声明的接收器，据我所知，*没有*UI 线程。

由于您无法在 Android 上的 UI 线程上进行联网，因此回答了我问题的第一部分：

*   你们都不应该也不*能从*`onReceive()`.

我们在 UI 线程上的事实使它看起来几乎像[ASyncTask](http://developer.android.com/reference/android/os/AsyncTask.html)是合适的，但这与手动启动另一个线程具有相同的问题。所以看起来 a`Service`是唯一的选择。

# asp.net - 在穷人的 ORM 中打开多个 SQLConnection 的性能影响

> ID：10825088
> 
> 赞同：0
> 
> 时间：2012-05-30T22:22:01.850
> 
> 标签：asp.net, sql-server, vb.net, performance

我正在实现一个穷人的 ORM 一个遗留应用程序（.NET 2.0 Web 应用程序，手工编码的 SQL 查询）。我有两个数据类：`Customer`和`Order`：

```
Public Class Customer
    Public Property CustomerId As Integer
    Public Property CustomerName As String
    Public Property Orders As List(Of Order)
End Class

Public Class Order
    Public Property OrderId As Integer
    Public Property OrderItem As String
End Class 
```

我正在使用 a`SqlDataReader`手动将 SQL 结果映射到`Customer`该类的实例：

```
Dim connection As New SqlConnection(connectionString)
Dim command As New SqlCommand(sql, connection)
Dim reader As SqlDataReader()

connection.Open()

reader = command.ExecuteReader()

Dim customer As New Customer()

While reader.Read
    With customer
        .CustomerId =   reader("CustomerId")
        .CustomerName = reader("CustomerName")
        .Orders =       getOrdersByCustomerId(reader("CustomerId"))   ' get orders
    End With
End While

connection.Close() 
```

为了填充`Customer.Orders`，我调用了一个返回 a 的函数`List(Of Order)`：

```
Private Function getOrdersByCustomerId(ByVal customerId As Integer) As List(Of Order)

    Dim connection As New SqlConnection(connectionString)
    Dim command As New SqlCommand(sql, connection)
    Dim reader As SqlDataReader()

    connection.Open()

    reader = command.ExecuteReader()

    Dim orders As New List(Of Order)

    While reader.Read
        Dim order As New Order
        With order
            .OrderId =   reader("OrderId")
            .OrderItem = reader("OrderItem")
        End With
        orders.Add(order)
    End While

    connection.Close()

    Return orders

End Function 
```

我担心这种方法的性能，即如果我要拉多个`Customer`'s. 对于每次`Customer`拉取，我必须再次访问数据库（打开另一个连接），并获取该给定客户的订单。如果我没记错的话，积累大量打开的连接不需要很多记录。

我的问题有两个：

1.  如何确定正在建立的新连接的数量以及是否会遇到任何连接池或其他此类 .NET 强加的限制？
2.  有没有更好的办法？（见下面的评论）

* * *

我的一个想法是将`SQLConnection`调用类中创建的对象传递给`getOrdersByCustomerId`函数，并让该函数使用（显然？）已经打开的连接。我没有测试它，因为我不知道如何确定它是否比我现有的方法更好。想法？

* * *

背景：

我正在创建一个搜索 Web 服务，它返回 JSON 以供客户端处理。该服务采用单个搜索参数，对不同的表执行多次查找，然后返回自定义 JSON 对象。例如，如果用户输入一个看似名称的内容，我会在`Customers`表中搜索前*n 个*客户的列表，并在`Orders`表中搜索具有该名称的客户的前*n 个*订单。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T22:35:28.650

首先是你错过了`Using Statement`，所以你的代码应该是这样的，而不是依赖于`Garbage Collector`自动处理它。

```
Using connection As New SqlConnection("connectionString")
    Using command As New SqlCommand("sql", connection)
        Using reader As SqlDataReader = Nothing

            connection.Open()

            reader = command.ExecuteReader()

            Dim customer As New Customer()

            While reader.Read
                If True Then
                    customer.CustomerId = reader("CustomerId")
                    customer.CustomerName = reader("CustomerName")
                    customer.Orders = getOrdersByCustomerId(reader("CustomerId"))
                End If
            End While
            connection.Close()
        End Using
    End Using
End Using 
```

* * *

**回到关于性能的原始查询**

我会`DataTable`在记录大量的情况下使用。请记住，`DataTable`对象在使用后以与上述类似的方式被使用语句处理。所以添加记录不需要进行迭代。

**再次访问数据库**

您是否可以考虑使用`ViewState`或`Session`，如果您发现数据有任何变化，您也可以使用`SQLDependency`.

**getOrdersByCustomerId(reader("CustomerId"))**

您是否可以将所有与客户相关的信息都带入表单加载中，并将其保存在其中`ViewState`？在数据阅读器中，不希望一遍又一遍地访问数据库。所以，最后访问`ViewState`DataReader Iteration 中的变量。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-30T22:30:29.333

打开和重新打开连接几乎是免费的。因此，最好打开连接并尽快处理它，最好是在 using 块中。

`Max Pool Size=1;`您可以通过添加到连接字符串来测试连接泄漏。这会将可用连接数限制为 1。如果泄漏连接，则会收到错误消息。确保不要在生产中使用此设置。

出于性能考虑，您通常会避免为大型集合中的每一行访问数据库。因此，您可以编写一个新的查询或过程来返回所有相关客户的所有订单。但是在实践中，这是一个不寻常的查询。您通常会显示客户列表，并且只有当最终用户放大该客户时，您才会检索订单列表。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-30T22:46:34.307

在这个问题的数据库方面工作。
您没有显示任何用于检索记录的 sql 命令

例如，当您通过 ID 加载客户时，尝试同时加载其订单。

```
SELECT CUSTOMERS.*, ORDERS.* 
FROM CUSTOMERS LEFT JOIN ORDERS 
     ON CUSTOMERS.ID = ORDERS.CUSTOMERID
WHERE CUSTOMERS.ID = @custID 
```

让这些数据在内存中创建客户及其订单，而无需两次访问数据库。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-30T22:47:16.473

除非您关闭了池，否则不要担心连接，如果您有，您就不会问这个问题。

如果你想让事情变得更清楚一点，虽然 using 块是个好主意。

```
Using connection = new SqlConnection(ConnectionString)
' Insert code here 
End Using 
```

连接将在最后使用时被释放，因为您处于默认行为，连接将返回到池中以在下次您的代码（实际上池由 appdomain 完成）需要一个时重用。如果在默认时间段（我似乎记得 2 分钟）内什么都不需要它，那么它会在那时完全处理掉。

PS对于任何实现 IDisposable 的方法本地的东西使用块是一个好主意。

为每个订单点击服务器，没有明确的答案。比如说一个订单页面，然后从中创建一个订单对象的集合会提高性能，只要你没有得到一堆你不太可能需要的东西。即只获取显示所需的数据，如果有更多负载，则使用某种延迟加载方案并在需要时获取数据，或者具有不同的类，例如 OrderSummary、OrderDetail。

# protobuf-net - VB.net 中的 ProtoBuf-Net 类继承

> ID：10825089
> 
> 赞同：1
> 
> 时间：2012-05-30T22:22:06.857
> 
> 标签：protobuf-net

我有两个类 A 和 B。类 B 继承类 A，如下所示。

```
<ProtoContract()>
Public Class A
    <ProtoMember(1)>
    Public Property ID As Integer
    <ProtoMember(2)>
    Public Property Name() As String = String.Empty
End Class

<ProtoContract()>
Public Class B
    Inherits A
    <ProtoMember(101)>
    Property Title As String = String.Empty
    <ProtoMember(102)>
    Property Status As String = String.Empty
    <ProtoMember(103)>
End Class 
```

当我使用 ProtoBuf 序列化和反序列化 B 类的实例时，A 类的属性值会丢失。在对此进行了一些搜索之后，我想我需要以某种方式在 B 类上使用 ProtoInclude() 标签，但我运气不佳。

示例代码：

```
 Dim stuff as New B
 With stuff
   .ID = 1
   .Name = "Bob"
   .Title = "Director"
   .Status = "Active"
 End With

 Dim buffer as Byte()
 Dim deserializedStuff as new B

 Using memStream As New IO.MemoryStream
     ProtoBuf.Serializer.Serialize(memStream, stuff)
     buffer = memStream.ToArray
 End Using

 Using memStream As New MemoryStream(buffer)
     memStream.Position = 0  
     deserializedStuff = ProtoBuf.Serializer.Deserialize(Of B)(memStream)
 End Using 
```

此时，“deserializedStuff”上的继承属性值将丢失。它们似乎只是设置为默认值。关于我做错了什么的任何想法？提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T22:53:29.000

在 A 的 ProtoAttributes 中，您需要指定它也可以包含 B。

```
<ProtoContract(), ProtoInclude(100, GetType(B))>
Public Class A
    <ProtoMember(1)>
    Public Property ID As Integer
    <ProtoMember(2)>
    Public Property Name() As String = String.Empty
End Class

<ProtoContract()>
Public Class B
    Inherits A
    <ProtoMember(1)>
    Property Title As String = String.Empty
    <ProtoMember(2)>
    Property Status As String = String.Empty
End Class 
```

这是我用来弄清楚你的测试课。

```
Public Class Test
    Public Sub New()
        Dim stuff As New B With {.ID = 1, .Name = "Bob", .Title = "Director", 
             .Status = "Active"}

        Dim buffer As Byte()
        Using memStream As New IO.MemoryStream
            ProtoBuf.Serializer.Serialize(memStream, stuff)
            buffer = memStream.ToArray
        End Using

        Dim deserializedStuff As B
        Using memStream As New MemoryStream(buffer)
            memStream.Position = 0
            deserializedStuff = ProtoBuf.Serializer.Deserialize(Of B)(memStream)
        End Using

        Debug.Print(deserializedStuff.ID.ToString & "--" & deserializedStuff.Status)
    End Sub
End Class 
```

# ipad - ARToolkit 移动图书馆教程/演示

> ID：10825096
> 
> 赞同：0
> 
> 时间：2012-05-30T22:22:44.440
> 
> 标签：ipad, augmented-reality

有谁知道 ARToolkit 移动库的任何好的教程或演示？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T12:10:39.207

ARToolkit Mobile 提供了 4 个使用 OpenGL、Wavefront、OSG 和视频格式的有据可查的示例。

其他选项是ARToolworks的支持[wiki或支持](http://www.artoolworks.com/support/library/Main_Page)[论坛](http://www.artoolworks.com/community/forum/)。

干杯，

标记

# qt - Qt 不会在 msvc2010 版本上创建目录

> ID：10825102
> 
> 赞同：0
> 
> 时间：2012-05-30T22:23:15.390
> 
> 标签：qt, release, visual-studio-2010

我正在使用 Qdir mkpath(dir) 和 QImage::save 来保存 .png 图像。但是在发布模式下，即使在调试时程序也不会创建文件夹也不会保存图像。

我正在使用 Qt 4.8.2 发布 qmain.lib、QtCore4.lib、QtGui4.lib 并在调试时使用 qmaind.lib、QtCored4.lib、QtGuid4.lib

你能帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T19:26:19.380

我发现出了什么问题。如果您使用的是断言，您应该从 Release - Preprocessor options 中删除 NDEBUG =)

# android - Android 调试不起作用 XSLT 错误

> ID：10825105
> 
> 赞同：0
> 
> 时间：2012-05-30T22:23:37.357
> 
> 标签：android, debugging, xslt, java

几分钟前我运行我的程序很好，现在当我添加更多功能时，它告诉我“JRE 实例默认 XSLT 处理器不支持调试_您想使用默认 Xalan 2.7.1 处理器进行调试吗？”

我确实重新启动了 Eclipse，也许这与它有关？：/

这是我第一次编写应用程序，所以如果我每次都必须在 eclipse 中设置一些东西，也许这就是为什么？如果是这样的话，那又是什么情况。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-31T00:07:02.207

我敢打赌，当你点击调试时，你在一个 XML 文件中。一直发生在我身上。由于某些烦人的原因，它会做一些完全不同的事情，当你这样做时我不明白。删除应该已经创建的 .out.xml，打开一个 .java 文件，然后再次尝试调试。另一种方法是只需右键单击您的项目并执行 Run As > Android Application。

# blackberry - 黑莓主屏幕过渡

> ID：10825106
> 
> 赞同：0
> 
> 时间：2012-05-30T22:23:39.090
> 
> 标签：blackberry

在使用 Java 编写我的第一个黑莓应用程序时，我对继承自`MainScreen`和`Screen`类感到困惑。

我最初的理解是应用程序中应该只有一个`MainScreen`派生类，因为我们只想定义一次屏幕标题和其他装饰。所有其余的屏幕（在 顶部调用`MainScreen`）都应派生自`Screen`.

但是，这似乎不是真的，因为我无法让屏幕完全覆盖前一个的非标题区域`MainScreen`。

在理解应如何在黑莓应用程序中创建多个屏幕时，我是否忽略了任何具体内容？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T05:41:11.213

也许你对类名`MainScreen`和`Screen`. 基本上`MainScreen`扩展`Screen`并添加了额外的功能，如`Menu`管理、标题字段、状态字段，并且已经`VerticalManager`在上面。如果您不需要此功能，例如您有自己更好的菜单功能，或者您需要自定义绘制逻辑或其他东西的所有区域。你有能力扩展`Screen`类，否则我建议你`MainScreen`在你的应用程序中使用每个屏幕。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-31T01:52:17.073

您[在 BlackBerry 的开发人员网站上阅读过此内容](http://docs.blackberry.com/en/developers/deliverables/11958/Screens_508096_11.jsp)吗？

[还有这个？](http://docs.blackberry.com/en/developers/deliverables/11958/Screen_transitions_detailed_overview_806391_11.jsp)

我的应用程序中经常只有一个`MainScreen`。其他屏幕可以派生自`Screen`或`FullScreen`。您是否**需要**每个屏幕都成为一个`MainScreen`取决于您的 UI 设计是否需要每个屏幕中[的页眉（标题）和页脚（状态）之类的东西](https://stackoverflow.com/a/4064437/119114)，这`MainScreen`提供了。

您是说您正在添加其他屏幕，而它们根本没有占用足够的空间？如果您希望其他屏幕占据整个屏幕，我会继承`FullScreen`. 而不仅仅是`Screen`.

而且，您正在`MainScreen`使用[UiApplication.pushScreen() 和 UiApplication.popScreen() 显示新屏幕（在初始屏幕之后）](http://www.blackberry.com/developers/docs/5.0.0api/net/rim/device/api/ui/UiApplication.html#pushScreen(net.rim.device.api.ui.Screen))？

# c# - 如何在 C# MVC 中选择文件夹目标？

> ID：10825109
> 
> 赞同：4
> 
> 时间：2012-05-30T22:23:58.090
> 
> 标签：c#, asp.net-mvc, model-view-controller, path, directory

我想知道如何在 MVC 中选择目标文件夹的目录，如文件夹浏览器对话框？

喜欢这张图片[http://www.codeguru.com/img/legacy/files/getFolder1.gif](http://www.codeguru.com/img/legacy/files/getFolder1.gif)

例如，如果我选择一个文件夹，我想获取 \Server\Folder1\Folder11 之类的路径

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T00:38:23.593

可能是这个？

你可以在那里找到一些聊天

[http://www.eggheadcafe.com/community/csharp/2/10116970/accessing-shared-folder-on-a-network-using-c-code.aspx](http://www.eggheadcafe.com/community/csharp/2/10116970/accessing-shared-folder-on-a-network-using-c-code.aspx)

**片段1：**

```
List<string> mappedDrives = new List<string>();
DriveInfo[] drives = DriveInfo.GetDrives();
foreach (DriveInfo drvInfo in drives)
{
          if (drvInfo.DriveType == DriveType.Network)
            mappedDrives.Add(drvInfo.Name);
} 
```

**片段 2：**

```
ManagementScope mgmtScope = new ManagementScope();
//query for drivetype = 4..for  network drive
ObjectQuery objQuery = new ObjectQuery("SELECT VolumeName FROM Win32_LogicalDisk   WHERE DriveType= 4");
ManagementObjectSearcher mgmgObjSearch = new ManagementObjectSearcher(mgmtScope,   objQuery);
ManagementObjectCollection mgmgObjColl = mgmgObjSearch.Get();
foreach (ManagementObject mgmgObj in mgmgObjColl)
{
    mappedDrives.Add(mgmgObj["VolumeName"].ToString());
} 
```

# java - 如何在不使用 Java 中的类字段的情况下编写递归

> ID：10825120
> 
> 赞同：1
> 
> 时间：2012-05-30T22:24:33.117
> 
> 标签：java, recursion, binary-tree

我有以下正确的 Java 代码来查找`k`二叉树中的有序元素。

```
private static int count = 0;
public static <T> T findkthInOrder(Node<T> root, int k) {
    count=0;
    return findkthInOrder(root, k, 0);
}
public static <T> T findkthInOrder(Node<T> root, int k,int a) {
    if (root == null)
        return null;
    T rt = findkthInOrder(root.left, k, 0);
    if (rt != null)
        return rt;
    count++;
    if (count == k) {
        return root.data;
    }
    return findkthInOrder(root.right, k, 0);
} 
```

但我真的想删除 的使用`count`，可能是通过使用一个额外的方法参数。我还想将其保留为递归，并要求该方法`findkthInOrder`返回`T`类型值。

谁能帮我解决这个问题？谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T22:28:25.363

将计数值封装在一个对象中（`Integer`没有用，因为它是不可变的）。

添加`add(int)`增加计数的方法；另一个获得当前值。

递归传递对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T22:48:18.800

这是矫枉过正，但在这里......我可以在Java中找到的唯一可变数字类是`java.util.concurrent.atomic.AtomicInteger`

```
public static <T> T findkthInOrder(Node<T> root, int k) {
    return findkthInOrder(root, k, new AtomicInteger(0));
}
public static <T> T findkthInOrder(Node<T> root, int k, AtomicInteger count) {
    if (root == null)
        return null;
    T rt = findkthInOrder(root.left, k, count);
    if (rt != null)
        return rt;
    if (count.incrementAndGet() == k) {
        return root.data;
    }
    return findkthInOrder(root.right, k, count);
} 
```

我进行了过早的优化，现在已修复。

这是替代解决方案：

```
public static <T> T findkthInOrder(Node<T> root, int k) {
    return findkthInOrder(root, k, new int[]{0});
}
public static <T> T findkthInOrder(Node<T> root, int k, int[] count) {
    if (root == null)
        return null;
    T rt = findkthInOrder(root.left, k, count);
    if (rt != null)
        return rt;
    count[0]++;
    if (count[0] == k) {
        return root.data;
    }
    return findkthInOrder(root.right, k, count);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T00:03:03.397

```
public class Node< T > {
    T tData;
    Node< T > ntLeft, ntRight;
    int iSubtreeCount;
    public Node( T tData, Node< T > ntLeft, Node< T > ntRight ) {
        this.tData = tData;
        this.ntLeft = ntLeft;
        this.ntRight = ntRight;
        this.iSubtreeCount = subCount( ntLeft ) + subCount( ntRight ) + 1;
    }
    public static int subCount( Node< T > nt ) {
        return null == nt ? 0 : nt.getSubtreeCount();
    }
    public int getSubtreeCount() { return iSubtreeCount; }
    public Node< T > getLeft() { return ntLeft; }
    public Node< T > getRight() { return ntRight; }
    public T getData() { return tData; }
} 
```

还有你的日常：

```
public static < T > T findKth( Node< T > ntInput, int k ) {
    if ( 0 == k || null == ntInput )
        return null;
    else if ( Node.subCount( ntInput.getLeft() ) > k - 1 )
        return findKth( ntInput.getLeft(), k );
    else if ( Node.subCount( ntInput.getLeft() ) == k - 1 )
        return ntInput.getData();
    else
        return findKth( ntInput.getRight(), k - 1 - Node.subCount( ntInput.getLeft() ) );
} 
```

# java - 锁和嵌套同步方法

> ID：10825124
> 
> 赞同：1
> 
> 时间：2012-05-30T22:24:49.460
> 
> 标签：java, methods, nested, synchronized, locks

假设我们有这样的东西，

```
class Class{    
//...
synchronized void m1(Class obj){ obj.m2(); }
synchronized void m2(){ /*...*/ }
} 
```

我的问题 - 对象 obj 的锁定何时释放？当它从方法 m2 或方法 m1 返回时？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T22:55:22.243

来自[JLS 第 17 节](http://docs.oracle.com/javase/specs/jls/se5.0/html/memory.html)

> 一个线程 t 可能会多次锁定一个特定的监视器；每次解锁都会反转一次锁定操作的效果。

但是，您的问题很复杂，因为它`m1()`可能`m2()`会锁定*不同的*对象。 `m1()`锁定你调用它的任何对象，你没有显示。所以事件的顺序是：

1.  您调用`x.m1(y)`where`x`并且`y`可能是`Class`.
2.  在进入之前`m1`，JVM 将监视器锁定为`x`.
3.  `m1`调用`m2`
4.  在进入`m2`JVM 之前将监视器锁定为`y`.
5.  `m2`退出时，释放`y`监视器
6.  `m1`退出时，释放`x`监视器

如果`x`和`y`是同一个对象，则在`m1`退出时释放锁。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T23:03:50.567

尝试翻译`synchronized`同步块中的方法：

```
m1(C obj) {
    synchronized(this) {
        obj.m2();
    }
}

m2() {
    synchronized(this) {
        // some stuff
    }
} 
```

因此，您的`obj`对象仅在`m2()`通话期间被锁定。这是因为这是唯一一次`this`转换为`obj`.

该`m1()`调用仅锁定当前对象，顺便说一下，它也可以是相同的`obj`；如果是这种情况（`this == obj`在第一次调用中），`obj`则被锁定直到两者都`m1()`完成`m2()`。

# solr - Solr：autoCommit 如果 Solr 在提交之前发生故障会发生什么

> ID：10825127
> 
> 赞同：1
> 
> 时间：2012-05-30T22:25:14.267
> 
> 标签：solr, sunspot, sunspot-rails, sunspot-solr

我们在 solrconfig.xml 中启用了 autoCommit。

```
<autoCommit> 
  <maxDocs>5000</maxDocs>
  <maxTime>5000</maxTime>
</autoCommit> 
```

现在想知道当 Solr 服务器在没有达到任何阈值并且有未提交的文档之前关闭时会发生什么。那些未提交的文档会在服务器重新启动时提交吗？

顺便说一句，我们启用了 autoCommit 来修复

```
exceeded limit of maxWarmingSearchers=2 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-30T23:01:32.083

我假设您的意思是 Solr 崩溃或被杀死？会发生什么取决于您使用的版本：

*   高达 3.6：文档丢失
*   主干（4.0）：由于[事务日志](https://issues.apache.org/jira/browse/SOLR-2700)，它们不会丢失

# python - wxPython - 如何强制 UI 刷新？

> ID：10825128
> 
> 赞同：1
> 
> 时间：2012-05-30T22:25:23.787
> 
> 标签：python, user-interface, wxpython

我已经将我的问题归结为这篇文章中显示的示例代码。请注意，我没有调用 app.MainLoop()，因为这不是交互式窗口；我希望它在开始时弹出，在工作发生时显示一些进度条，并在完成时消失。

我对 wxPython 和 wx.Yield() 的（有限）理解使我相信在一些 UI 工作之后调用 wx.Yield() 会将这些更改刷新到显示中。这没有发生——当我运行这个脚本时，“Hello World”应该是一个灰色的框。

我究竟做错了什么？

```
import wx

class MyFrame(wx.Frame):
    def __init__(self, parent, id):
        wx.Frame.__init__(self, parent, id, size=(400,400))
        self.panel = wx.Panel(self, -1)
        wx.StaticText(self.panel, -1, "Hello World", (20,20))
        wx.Yield()

class MyApp(wx.App):
    def OnInit(self):
        self.frame = MyFrame(None, -1)
        self.frame.Show(True)
        self.SetTopWindow(self.frame)
        return True

def run():
    app = MyApp(redirect=False)
    import time; time.sleep(5)

run() 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T17:24:00.503

您需要定期生成或更新，以便当您的操作系统/窗口管理器向您的应用程序发送重绘消息时，它可以处理它们。我不是 100% 确定 wxPython，因为我最近没有使用它，但我认为如果没有主循环来适当地处理消息，你就无法做你想做的事。

但是，您可能会在这里找到一些有用的关于线程化主循环的内容（以及解释为什么主循环很重要）：[http ://wiki.wxpython.org/MainLoopAsThread](http://wiki.wxpython.org/MainLoopAsThread)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T21:17:18.767

没有`MainLoop`no 事件将被触发，也`.Refresh`将无法工作。

我想`wxSplashscreen`可能是你正在寻找的。示例：[http ://wiki.wxpython.org/SplashScreen](http://wiki.wxpython.org/SplashScreen)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T23:28:37.403

而不是 wx.Yield()

只需调用 self.Update()

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-07-17T16:01:04.850

并不是说它会对原始海报有任何好处，但`wx.Yield()`会完成这项工作。它只需要在正确的位置，`self.Show()`
如下输出一个更新的进度条。

```
import wx
import time
class MyFrame(wx.Frame):
    def __init__(self, parent, id):
        wx.Frame.__init__(self, parent, id, size=(290,200))
        self.panel = wx.Panel(self, -1)
        wx.StaticText(self.panel, -1, "Hello World", (20,20))
        self.gauge = wx.Gauge(self.panel, -1, 50, pos=(20,50), size=(250, 20))
        self.Show()
        n = 0
        while n < 50:
            n = n+1
            self.gauge.SetValue(n)
            wx.Yield()
            time.sleep(1)

class MyApp(wx.App):
    def OnInit(self):
        self.frame = MyFrame(None, -1)
        self.SetTopWindow(self.frame)
        return True

def run():
    app = MyApp()

run() 
```

# c# - 如何在aspx中流式传输音乐

> ID：10825135
> 
> 赞同：0
> 
> 时间：2012-05-30T22:25:46.627
> 
> 标签：c#, jquery, asp.net

我想用 aspx 流式传输音乐，但我不知道如何开始！我的总体想法是用户可以拥有自己的播放列表并上传他们的音乐，但我不知道他们如何通过网站听到自己的音乐。第二个想法是投票最多的播放列表在线播放给想听的人！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T22:33:26.757

一旦用户上传了他们的音频文件，您就可以使用 HTML5[`<audio>`](http://www.htmlgoodies.com/primers/html/article.php/3920991/HTML5-Primer-How-To-Use-the-Audio-Tag.htm)标签。[AudioJS](http://kolber.github.com/audiojs/)是一个可以让你更轻松的库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T22:31:04.370

我认为这是出于教育目的？否则，有一些 IceCast / ShoutCast 产品已经具有一些此功能。

# backbone.js - 如何从一个获取请求中获取多个模型或集合

> ID：10825137
> 
> 赞同：2
> 
> 时间：2012-05-30T22:25:50.183
> 
> 标签：backbone.js, backbone-relational

我有一个获取请求，其响应如下所示。

```
response = {
   id: 1,
   title: 'text',
   followers: [{}, {}] // array of objects
} 
```

正如你所看到的，响应是一个对象，它有一个属性 follower，它是一个对象数组。

我想从这个响应中创建一个模型和一个集合，其中一个具有以下属性：

```
response = {
   id: 1,
   title: 'text'
} 
```

另一个是模型集合

```
followers: [{}, {}]; 
```

激活我的目标的适当方式是什么？
我可以使用 Backbone.Relation 吗？
如果是，有一些例子吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T08:44:44.923

我习惯使用与@lecstor 相同的方法，但我更`initialize()`喜欢这样做：

```
initialize: function(){
  this.followers = new Followers( this.get("followers") );
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T02:30:18.860

根据您的需求/观点/等，我可能会将该响应包装在模型中并为关注者创建模型集合......

```
MyModel = Backbone.Model.extend({
    urlRoot: '/url/to/get/response'
});

Follower = Backbone.Model.extend();

Followers = Backbone.Collection.extend({
    model: Follower
});

this.model = new MyModel({ id: 1 });
var that = this;
this.model.fetch({
    success: function(model, response){
        that.collection = new Followers( model.get('followers') )
    }
}); 
```

我认为你可以很容易地从集合中更新你的模型：

```
this.model.set('followers', this.collection.toJSON()) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T01:00:48.513

为什么没有包含集合和子模型的模型？

本质上是一个视图模型

# java - Java 线程和同步

> ID：10825138
> 
> 赞同：0
> 
> 时间：2012-05-30T22:25:51.477
> 
> 标签：java, multithreading

我有一个使用我编写的一些罐子的网络应用程序。我的挑战是我的代码中有一个关键（但速度很快）的部分。

1 - 我有一个给定类的对象，它有几个`static`字段。我们称这个类为A

`static`2 _ A 公开了一个访问字段的非静态方法。用于阅读和写作。让我们调用这个方法`doJob`。

3 - 每个请求都实例化一个类的对象`A`并调用`doJob`.
`A a = new A(); a.doJob();`

4 - 我假设每个请求都在创建一个新`Thread`的`doJob`执行位置。

5 - 如果我一次只定义一个`doJob`将执行该方法，其他人将继续等待。`public synchronized void doJob () {//Do the job}``Thread`

问题是：我说的都对吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T22:32:43.963

您是对的，但是 doJob 将在实例级别同步，因此 doJob 方法可以由两个或多个不同线程在类 A 的两个或多个实例上同时执行。如果您希望 doJob 仅由一个线程执行有一次（例如因为它更改静态字段），您应该将其声明为静态或使用静态字段作为锁定对象来同步整个方法体。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T22:32:26.640

鉴于您正在尝试使用非静态（即每个对象一个）监视器保护静态（即每个类一个）字段，我会说“一次只有一个线程将执行该方法，而其他线程将保持等待”的主张不成立。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T22:32:49.077

不。

将实例方法标记为`synchronized`与执行相同

```
public void myMethod() {
  synchronized(this) {
    ...
  }
} 
```

所以，你只能保证两个线程没有运行同*一个对象*的同一个方法。来自另一个对象的相同方法可以同时运行。

尝试与更“静态”的对象同步。我会使用类对象本身，或一些静态（和不可变）成员。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-30T22:45:26.043

是的，你的大纲是正确的。并且在其他线程等待访问时，它确实在技术上成为系统瓶颈。只要您避免在同步块中放置任何繁重的处理或 i/o，这是非常好的和正常的。

# jquery - history.js - IE 弹出错误

> ID：10825140
> 
> 赞同：2
> 
> 时间：2012-05-30T22:26:21.227
> 
> 标签：jquery, internet-explorer, history.js

我在这里有一个例子：http: [//www.salesmelbourne.com](http://www.salesmelbourne.com)

如果单击 page1、page2 等，您会看到 IE 错误。

关于这是什么以及如何解决它的任何建议？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T22:32:43.873

更改页面时，弹出窗口似乎来自这段代码：

```
History.log('statechange:', State.data, State.title, State.url); 
```

从快速浏览日志到支持的浏览器中的控制台，否则会发出警报（因此您会在 IE 中收到警报消息）。

* * *

您还会收到**两次包含 history.js**的警报。

```
scripts/bundled/html4+html5/jquery.history.js
scripts/uncompressed/history.adapter.jquery.js 
```

在插件中，它有以下代码要检查：

```
// Check Existence
if ( typeof History.Adapter !== 'undefined' ) {
    throw new Error('History.js Adapter has already been loaded...');
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-07T21:23:51.557

如果没有可用的控制台窗口，这实际上是一个后备

文件：jquery.history.js（未压缩）

```
 212 // No Textarea, No Console
        213 else if ( !consoleExists ) {
        214 alert(message);
        215 } 
```

我注释掉了第 214 行以避免弹出窗口！

如果您使用捆绑的压缩 html4+html5/jquery.history.js (vers.v1.7.1-r2.)，您可能会搜索单词“alert”并将 l=a.alert 部分替换为 l=a.function (){} 避免弹出

# android - 智能手机组件的能耗

> ID：10825162
> 
> 赞同：15
> 
> 时间：2012-05-30T22:28:44.130
> 
> 标签：android, smartphone, energy

我正在寻找最新智能手机上所有组件及其耗电量的列表。

*   加速度计、陀螺仪、磁力计等
*   展示
*   无线上网
*   蓝牙
*   全球定位系统
*   中央处理器
*   相机
*   麦克风
*   等等

最好以 mA 为单位，以便与电池容量（通常以 mAh 为单位）进行比较。

Sensor 的功能实际上可以通过 SDK 获得，并且对于[AndroidFragmentation](http://www.androidfragmentation.com)上的大多数设备也可以轻松计算出来。然而，我正在寻找的是其他硬件组件的*可比*数据，以考虑它们的效率。

奖励：减少传感器更新频率的请求是否会降低传感器的能耗，因为它只返回一个值`getPower()`？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-05-15T02:27:43.130

我可以找到一些详细的研究。

1.  2010 年 USENIX 会议的一项[研究](http://static.usenix.org/event/usenix10/tech/full_papers/Carroll.pdf)，研究智能手机的各种组件（相机除外）
2.  2013 年 Hotmobile 移动计算研讨会的另一项[研究，其中包含有关相机和显示器的更多信息。](http://www.hotmobile.org/2013/papers/full/17.pdf)

参考文献 1 似乎是一个很好的起点。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-03T12:49:28.350

> 我正在寻找最新智能手机上所有组件及其耗电量的列表。

这是不可能回答的。

首先，不同的设备将使用不同种类的这些组件，具有不同的功率特性。

其次，这些组件中的许多（如果不是大多数）将没有公布的功率统计数据，或者如果不完全拆解设备，特定组件本身可能不可知。

> 请求不太频繁地更新 Sensor 是否会降低 Sensor 的能耗，因为它只为 getPower() 返回一个值？

这将取决于传感器。某些传感器实际上总是“打开”（例如，环境光传感器），由操作系统提供，在这种情况下，您使用该传感器的唯一增量功耗将是将该传感器数据传递给您的过程。操作系统可能不会定期使用其他传感器，这意味着您对该传感器的事件请求可能会将其“打开”，除了为您提供该数据外，还会导致传感器本身耗电。

如果所有 Android 设备都以 Qualcomm MDP 的方式进行检测，那将是非常棒的，这样我们就可以为我们的应用程序及其各种组件的使用获得细粒度的电源细节。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-02T10:10:37.740

几年前有一个关于这个主题的谷歌 I/O 会议。[你可以在这里](https://www.youtube.com/watch?v=OUemfrKe65c)看到视频和幻灯片 pdf[在这里](https://dl.google.com/io/2009/pres/W_0300_CodingforLife-BatteryLifeThatIs.pdf)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-25T13:11:56.610

我知道插入自己的初创公司是违反规则的，但你所要求的听起来与我们正在做的完全一样。

有一个名为“ [Little Eye Labs](http://www.littleeye.co/index.php) ”的安卓性能监控工具。它显示了应用程序在手机上运行时的实时功耗。它目前仅支持 CPU、Display、GPS、Wifi 和 3G，但您将能够获得这些组件的瞬时功耗（以 mW 为单位）。

/插头结束

请注意，没有真正的方法可以直接从设备获取此信息，因此您能做的最好的事情就是为手机建模，收集设备资源消耗，并模拟电源使用情况。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-31T04:23:04.220

显示屏是智能手机最耗电的部分；占总电池寿命的 60%（可消耗高达 2W 的功率）。有一本书叫《绿色 IT 及其应用》；您可以在 Google 图书中在线阅读。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-02T21:43:29.547

有一个名为[PowerTutor](http://powertutor.org/)的应用程序，它会为每个手机组件和每个进程进行一些电池消耗测量。该[代码](https://github.com/msg555/PowerTutor)是开放的，因此您可以从那里获得一些想法。请注意，此应用针对 Google 的手机进行了优化，尤其是针对 Nexus One。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-06-02T10:08:13.297

在任何现代 Android 上，转到“设置”>“电池”（有时为“设置”>“关于”>“电池”）。您应该会看到随时间推移的功耗图表，以及哪个组件使用了多少电量。

尽管消耗量因使用模式而有很大差异，但根据我的经验，最大的消费者是显示器、收音机和 CPU。在没有错误的情况下，我还没有看到传感器在我的任何设备上的能耗排名都很高。Yusuf X 提供的链接将游戏传感器置于 CPU 之上。

有关在 Android 上优化电池使用的更多信息，请参阅[减少通过智能手机收音机下载内容的应用程序对电池的影响](https://stackoverflow.com/q/9950379/517561)和[优化电池寿命](http://developer.android.com/training/monitoring-device-state/index.html)。

# javascript - Array.prototype.sort.call() 是否应该返回窗口对象？

> ID：10825163
> 
> 赞同：3
> 
> 时间：2012-05-30T22:28:48.413
> 
> 标签：javascript, obfuscation

[根据这个问题](https://stackoverflow.com/questions/3910353/obfuscated-javascript-code-with-binary-values)和[这个自动生成器](http://discogscounter.getfreehosting.co.uk/js-noalnum.php)，我一直在用括号和其他符号来混淆 Javascript - 出于纯粹的教育原因，我可以说:)

例如，评估`(![]+[])[+!+[]]`给了我字母`"a"`。

但是，这些示例似乎依赖于`[].sort.call()`返回窗口对象。我的问题是，每当这似乎不适用于我安装的任何浏览器（Chrome 14、FF 9、IE 9）时：

```
//They told me this would return the window object
[].sort.call() 

//But I get an exception instead:
"TypeError: Array.prototype.sort called on null or undefined" 
```

**所以我问：**

*   是`[].sort.call()`在最近的浏览器上修复的还是它仍然返回窗口对象而只是我做错了什么？
*   如果是我不能再使用这种方法的情况，有没有其他方法可以只使用括号、括号、感叹号和 + 运算符来访问窗口对象？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T22:45:58.223

ECMAScript 5 对此进行了更改。从[15.3.4.4 开始](http://es5.github.com/#x15.3.4.4)：

> **注意thisArg 值作为****this**值不加修改地传递。这是对第 3 版的更改，其中**undefined**或**null** thisArg 被替换为**全局对象**，并且**ToObject**应用于所有其他值，并且该结果作为**this**值传递。

...并[`sort()`](http://es5.github.com/#x15.4.4.11)调用[`ToObject`](http://es5.github.com/#x9.9)该**值**，引发`TypeError`异常。

而且，由于添加了[严格模式](https://developer.mozilla.org/en/JavaScript/Strict_mode)，这[进一步减少了对全局对象的访问](https://developer.mozilla.org/en/JavaScript/Strict_mode#.22Securing.22_JavaScript)，您的选择可能很少。虽然，没有`"use strict"`，您可以尝试使用`this`.

# php - 如何使用 zen_mail 在 Zen-Cart 中发送多条消息？

> ID：10825165
> 
> 赞同：0
> 
> 时间：2012-05-30T22:28:58.990
> 
> 标签：php, zen-cart

我正在尝试调用 zen_mail 两次，以便我可以向自己（管理员）和我的客户发送电子邮件。我正在使用以下方法来调用它，但我似乎无法让它工作。当我调用它时，它会导致电子邮件无法发送出去。任何人都可以帮忙吗？

```
 zen_mail($customer['customers_firstname'] . " " . $customer['customers_lastname'],
       $admin,
       $subject,
       $text,
       TITLE,
       $admin['admin_email'],
       $block,
       $module_used
       ); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T10:42:05.057

您可以使用 zen_mail 将消息发送给多个收件人，但语法很麻烦。为什么不给 zen_mail 打两次电话——一次给客户，一次给管理员。这是用于

```
includes/classes/orders.php 
```

您可以在此文件中搜索 zen_mail 并找到调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T16:37:07.633

在 ZENCART 管理员中：

配置->电子邮件选项：将订单确认电子邮件副本发送至：

在这里您可以放置​​多个电子邮件地址：ME,Joe,Fred

这将向 ME、Joe 和 Fred 以及您的客户发送确认电子邮件。

# android - 如何通过 XML 布局显示 Android UI？

> ID：10825168
> 
> 赞同：1
> 
> 时间：2012-05-30T22:29:08.450
> 
> 标签：android, xml, layout, user-interface

目前我知道我可以创建一个 XML 布局并将其传递给 setContentView(...)，或者我可以将自定义视图传递给 setContentView(...)。

但是如果我想结合两者的元素呢？是否可以先使用布局，然后通过 java 代码以编程方式添加到 UI？

例如：如何创建一个使用资产背景图片并在顶部添加加载小部件的视图？

附加查询：现在，我认为 View 和 Layout 作为 setContentView 显示的两件事。但是视图可以在其中包含要显示的布局吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T23:30:18.997

是的，它可以使用 setContentView() 设置 XML 布局，并以编程方式向该布局添加更多视图/小部件。这是一个简短的例子。

主要的.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" 
    android:background="@drawable/background_image">

    <TextView 
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:text="Some text"/>

    <LinearLayout 
        android:id="@+id/custom_content_root"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
            android:orientation="vertical">

        <!-- This is where we will add views programmatically -->
    </LinearLayout>
</LinearLayout> 
```

测试活动.java

```
public class TestActivity extends Activity {
private LinearLayout mRoot;

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    // Set the layout
    setContentView(R.layout.main);

    // Get the Linearlayout we want to add new content to..
    mRoot = (LinearLayout) findViewById(R.id.custom_content_root);

    // Create a TextView for example
    TextView moreText = new TextView(this);

    // Set the layout parameters of the new textview.
    moreText.setLayoutParams(new LayoutParams(LayoutParams.FILL_PARENT,  LayoutParams.WRAP_CONTENT));

    moreText.setText("More text :)");

    // Add the new textview to our existing layout
    mRoot.addView(moreText);
}
} 
```

结果是一个以 background_image.png 作为背景的活动，以及两个带有文本的文本视图；）

您可以通过这种方式添加任何类型的视图（TextView、EditText、ImageView、Buttons 等）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T23:04:33.263

是的，可以在使用 setContentView() 之后添加小部件。也可以使用[LayoutInflater](http://developer.android.com/reference/android/view/LayoutInflater.html)自己扩展 XML 布局。

您可以将加载小部件添加到在 XML 中定义的布局中，方法是使用 findViewById 获取它，然后使用[ViewGroup](http://developer.android.com/reference/android/view/ViewGroup.html)中的方法。

# iphone - 使用设置包手动安装 iPhone 应用程序

> ID：10825170
> 
> 赞同：0
> 
> 时间：2012-05-30T22:29:25.183
> 
> 标签：iphone, installation, manual, settings.bundle

我有一个无法解决的问题，我有一个使用设置包的小应用程序，我没有苹果许可证开发人员，所以要在真正的 iphone 中测试应用程序，我必须手动安装（复制应用程序到应用程序文件夹并设置权限）。刷新 GUI 后，我可以正常运行应用程序，但设置未显示在设置中，并且我的应用程序无法读取它们...

如何将设置添加到 iphoen 的设置中？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T00:10:26.267

假设您在没有代码设计的情况下安装后在越狱的 iPhone 上进行开发...看看[这个](http://modmyi.com/forums/file-mods/22453-how-make-custom-menus-preferences-app-custom-preferences.html)，这是一个关于如何使用[PreferenceLoader](http://iphonedevwiki.net/index.php/PreferenceLoader)的教程。

# c# - ADOX 表列的“可空”属性？

> ID：10825173
> 
> 赞同：4
> 
> 时间：2012-05-30T22:29:41.330
> 
> 标签：c#, .net-4.0, oledb, jet, adox

我正在尝试使用 C# 创建一个 Access 文件 (.mdb)。我正在从 SQL 中为遗留进程导出数据。我让它工作了，我面临的唯一问题是将列设置为可为空。

这是我所拥有的（为简洁起见，删除了大多数列）：

```
private void CreateAndExportLegacyFile(DataTable data, string exportFilename)
{
    var connectionString = "Provider=Microsoft.Jet.OLEDB.4.0;";
    connectionString += "Data Source=" + exportFilename + ";Jet OLEDB:Engine Type=5";

    var catalog = new Catalog();
    catalog.Create(connectionString);

    var table = new Table { Name = "Main" };

    #region Column mapping
    table.Columns.Append("ID", DataTypeEnum.adVarWChar, 50);
    table.Columns.Append("FIRST", DataTypeEnum.adVarWChar, 50);
    table.Columns.Append("LAST", DataTypeEnum.adVarWChar, 50);
    #endregion

    foreach (Column column in table.Columns)
    {
        if (column.Name != "ID") column.Properties["Nullable"].Value = true;
    }

    catalog.Tables.Append(table);

    Marshal.FinalReleaseComObject(table);
    Marshal.FinalReleaseComObject(catalog.Tables);
    Marshal.FinalReleaseComObject(catalog.ActiveConnection);
    Marshal.FinalReleaseComObject(catalog);
} 
```

尝试设置“Nullable”属性时出现以下错误：“在与请求的名称或序号相对应的集合中找不到项目。”

我发现是否使用Required 或Nullable 的报告相互矛盾，但我都尝试过并得到相同的结果。

知道为什么我无法设置可为空的属性吗？在拉取数据时，我可能只是懒惰，默认空值是空格，但如果可能的话，我想避免这种情况。

**编辑**：正如汉斯在评论中提到的，我不得不改用 Attributes 属性：

```
if (column.Name != "ID") column.Attributes = ColumnAttributesEnum.adColNullable; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-03T14:57:53.400

Hans Passant 在评论中回答了这个问题，但从未将其添加为答案。现在这样做以将其标记为已回答。必须使用 Attributes 属性：

```
if (column.Name != "ID") column.Attributes = ColumnAttributesEnum.adColNullable; 
```

# java - 计算二维线性向量上的下一个点

> ID：10825174
> 
> 赞同：2
> 
> 时间：2012-05-30T22:29:42.047
> 
> 标签：java, math, vector, path, 2d

我很确定这可以通过一些基本的三角方程来解决，但不幸的是我无法弄清楚。

我需要的是：

![如何在线性矢量路径 2d 上找到下一个点](../Images/73642c4f67de88ca22713d5b8dbf3d62.png)

给定 2d 中两个点的 x,y 坐标，我需要找到向量上从一个点到另一个点的*下一个点。*基本上找到最近的线性路径。

例如：在上图中，我们给定了两个点，我们想从蓝点到红点沿着路径移动，因此我们需要每一步找到下一个（灰点）直到我们到达它。

任何帮助深表感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-30T22:33:36.180

看看[Bresenham 的线算法](http://en.wikipedia.org/wiki/Bresenham%27s_line_algorithm)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T00:02:08.130

谢谢大家的建议！我终于想通了。这是查找线性向量下一个点的方法的基本 Java 实现（假设我们每步移动 1 个点）

```
 public int[] getNextLinePoint(int x,int y,int x2, int y2) {
    int w = x2 - x;
    int h = y2 - y;
    int dx1 = 0, dy1 = 0, dx2 = 0, dy2 = 0;
    if (w<0) dx1 = -1; else if (w>0) dx1 = 1;
    if (h<0) dy1 = -1; else if (h>0) dy1 = 1;
    if (w<0) dx2 = -1; else if (w>0) dx2 = 1;
    int longest = Math.abs(w);
    int shortest = Math.abs(h);
    if (!(longest>shortest)) {
        longest = Math.abs(h);
        shortest = Math.abs(w);
        if (h<0) dy2 = -1; else if (h>0) dy2 = 1;
        dx2 = 0;            
    }
    int numerator = longest >> 1;
    numerator += shortest;
    if (!(numerator<longest)) {
        numerator -= longest;
        x += dx1;
        y += dy1;
    } else {
        x += dx2;
        y += dy2;
    }
    int[] res = {x, y};
    return res;
} 
```

此代码以 2 元素 int[] 数组的形式返回下一个 x,y 坐标。再次感谢大家！

# jquery - 确定单击按钮时调用的 jQuery 脚本

> ID：10825176
> 
> 赞同：2
> 
> 时间：2012-05-30T22:29:49.070
> 
> 标签：jquery

所有，我在我的网站上使用以下主题： [http ://revaxarts-themes.com/?t=whitelabel](http://revaxarts-themes.com/?t=whitelabel)

它在我的网站上的工作方式不同，因此我正在尝试确定导致问题的原因。例如，如果您单击演示中的面包屑链接并看到添加数字面包屑，您可以看到，当您单击事物时，它会将不同的类应用于以前的类。在我的网站上它没有这样做，所以我试图弄清楚何时单击这些值之一，调用的是什么 JS 文件。

另一个例子是，如果您单击表单，然后进入多选。当您单击加号图标时，它会转移选择，而在我的网站上它不会这样做。再一次，我想弄清楚调用了什么 JS 文件来做到这一点。

我正在研究 Firebug，如果您知道该文件，这很适合调试，但我不确定如何找出正在调用的文件。谁能指出我正确的方向或对此提供任何帮助？我将不胜感激！

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T23:13:48.093

首先，转到此 URL [http://revaxarts-themes.com/whitelabel/breadcrumb.html](http://revaxarts-themes.com/whitelabel/breadcrumb.html)（我花了一分钟才意识到它在 iframe 中......呃......）

然后在你的 JS 控制台中运行它：

```
clickEvents = $('ul.breadcrumb[data-allownextonly]').data("events").click;
jQuery.each(clickEvents, function(key, value) {
  console.log(value.handler);
}) 
```

这会将`click`事件的处理程序打印为函数。它被缩小了，所以我使用 jsbeautifier.org 为你[缩小了](http://jsbeautifier.org/)

```
function () {
    var a = c.data("wl_Breadcrumb") || a;
    if (a.disabled) return !1;
    var b = $(this);
    if (!a.allownextonly || 1 >= b.data("id") - c.find("a.active").data("id")) {
        $.fn.wl_Breadcrumb.methods.activate.call(c[0], b), a.onChange.call(c[0], b, b.data("id"));
        return !1
    }
} 
```

那你就自己从这里...

* * *

资料来源：[如何使用 FireBug（或类似工具）调试 Javascript/jQuery 事件绑定](https://stackoverflow.com/a/571087/628859)

# c# - 如何使分页从 1 而不是 0 开始

> ID：10825178
> 
> 赞同：0
> 
> 时间：2012-05-30T22:30:01.540
> 
> 标签：c#, asp.net-mvc

我使用了[Nerddinner](http://nerddinnerbook.s3.amazonaws.com/Part8.htm)教程的分页示例。但我也想添加页码，如下所示：

> <<< 1 2 3 4 5 6 >>>

如果我从 0 而不是从 1 开始分页，则下面的代码有效。我该如何解决这个问题？

这是我的代码：

**分页列表.cs**

```
public class PaginatedList<T> : List<T> {

    public int PageIndex  { get; private set; }
    public int PageSize   { get; private set; }
    public int TotalCount { get; private set; }
    public int TotalPages { get; private set; }

    public PaginatedList(IQueryable<T> source, int pageIndex, int pageSize) {
        PageIndex = pageIndex;
        PageSize = pageSize;
        TotalCount = source.Count();
        TotalPages = (int) Math.Ceiling(TotalCount / (double)PageSize);

        this.AddRange(source.Skip(PageIndex * PageSize).Take(PageSize));
    }

    public bool HasPreviousPage {
        get {
            return (PageIndex > 0);
        }
    }

    public bool HasNextPage {
        get {
            return (PageIndex+1 < TotalPages);
        }
    }
} 
```

**用户控制器.cs**

```
 public ActionResult List(int? page)
    {
        const int pageSize = 20;

        IUserRepository userRepository = new UserRepository();
        IQueryable<User> listUsers = userRepository.GetAll();
        PaginatedList<User> paginatedUsers = new PaginatedList<User>(listUsers, page ?? 0, pageSize);

        return View(paginatedUsers);
    } 
```

**列表.cshtml**

```
@if (Model.HasPreviousPage) 
{ 
    @Html.RouteLink(" Previous ", "PaginatedUsers", new { page = (Model.PageIndex - 1) }) 
}

@for (int i = 1; i <=  Model.TotalPages; i++)
{
    @Html.RouteLink(@i.ToString(), "PaginatedUsers", new { page = (@i ) })   
}

@if (Model.HasNextPage)
{
    @Html.RouteLink(" Next ", "PaginatedUsers", new { page = (Model.PageIndex + 1) })
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T22:33:01.297

分页列表.cs

```
.Skip((PageIndex -1) * PageSize).Take(PageSize) 
```

用户控制器.cs

```
public ActionResult List(int page = 1)
{ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T07:57:19.320

我做了这个改变：

**分页列表.cs**

```
public PaginatedList(IQueryable<T> source, int pageIndex, int pageSize) {
        .
        .
        .
        this.AddRange(source.Skip((PageIndex -1) * PageSize).Take(PageSize));
    }

public bool HasPreviousPage {
        get {
            return (PageIndex > 1);
        }
    }

    public bool HasNextPage {
        get {
            return (PageIndex < TotalPages);
        }
    } 
```

**用户控制器.cs**

```
 public ActionResult List(int? page)
    {
        const int pageSize = 20;

        page = (page < 1) ? 1 : page ?? 0;
        .
        .
        . 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T08:26:13.657

我建议使用库而不是编写自己的分页代码。[MvcPaging](http://nuget.org/packages/MvcPaging)是这些库之一。

在这里查看我的答案 -[使用哪些好的库来对自定义 html（不是基于表格）进行分页？](https://stackoverflow.com/questions/10432654/what-good-libraries-to-use-for-paging-on-custom-html-not-table-based/10468104#10468104)

# java - m2eclipse 不会下载任何依赖

> ID：10825182
> 
> 赞同：3
> 
> 时间：2012-05-30T22:30:14.330
> 
> 标签：java, eclipse, maven, dependencies

我希望有人能提供帮助。

在全新的 Windows 机器上。在下载和运行最新版本的 eclipse (indigo) 之前，我已经下载并安装了 java jdk。

从那里我从市场上安装了 maven 集成插件并创建了一个新的 maven 投影。

该项目有大量错误，主要与缺少依赖项或生命周期管理有关。

当我执行 maven-clean 时，我收到以下错误消息：

```
[ERROR] Plugin org.apache.maven.plugins:maven-clean-plugin:2.4.1 or one of its dependencies could not be resolved: Failed to read artifact descriptor for org.apache.maven.plugins:maven-clean-plugin:jar:2.4.1: Could not transfer artifact org.apache.maven.plugins:maven-clean-plugin:pom:2.4.1 from/to central (http://repo1.maven.org/maven2): Invalid argument: getsockname to http://repo1.maven.org/maven2/org/apache/maven/plugins/maven-clean-plugin/2.4.1/maven-clean-plugin-2.4.1.pom -> [Help 1] 
```

我不在防火墙后面，也不使用代理。我的 maven settings.xml 和我的 maven 项目一样是完全默认的。没有添加任何类，没有添加到 pom 中。

任何人都可以帮忙吗？

一切顺利。

ps这里是pom中显示的错误：

1：

```
CoreException: Could not calculate build plan: Plugin org.apache.maven.plugins:maven-compiler-plugin:2.3.2 or one of its dependencies could not be resolved: Failed to read artifact descriptor for org.apache.maven.plugins:maven-compiler-plugin:jar:2.3.2: ArtifactResolutionException: Failure to transfer org.apache.maven.plugins:maven-compiler-plugin:pom:2.3.2 from http://repo1.maven.org/maven2 was cached in the local repository, resolution will not be reattempted until the update interval of central has elapsed or updates are forced. Original error: Could not transfer artifact org.apache.maven.plugins:maven-compiler-plugin:pom:2.3.2 from/to central (http://repo1.maven.org/maven2): Invalid argument: getsockname to http://repo1.maven.org/maven2/org/apache/maven/plugins/maven-compiler-plugin/2.3.2/maven-compiler-plugin-2.3.2.pom 
```

2：

```
Plugin execution not covered by lifecycle configuration: org.apache.maven.plugins:maven-compiler-plugin:2.3.2:testCompile (execution: default-testCompile, phase: test-compile) 
```

3：

```
Plugin execution not covered by lifecycle configuration: org.apache.maven.plugins:maven-compiler-plugin:2.3.2:compile (execution: default-compile, phase: compile) 
```

4：

```
Failure to transfer org.apache.maven.plugins:maven-resources-plugin:pom:2.4.3 from http://repo1.maven.org/maven2 was cached in the local repository, resolution will not be reattempted until the update interval of central has elapsed or updates are forced. Original error: Could not transfer artifact org.apache.maven.plugins:maven-resources-plugin:pom:2.4.3 from/to central (http://repo1.maven.org/maven2): Invalid argument: getsockname to http://repo1.maven.org/maven2/org/apache/maven/plugins/maven-resources-plugin/2.4.3/maven-resources-plugin-2.4.3.pom 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T22:45:04.027

此外，我建议首先使用 Maven（Maven 3.0.X）的命令行客户端而不是在 Eclipse 中测试配置等。

1./4\. 表明您已尝试下载某些由于任何原因而失败的工件。简单的解决方案是删除本地存储库并重试构建。但我建议先在命令行上检查一切是否正常。

2./3\. 表明您尝试编译的项目不包含正确的[m2e 插件覆盖范围，可以在文档中阅读](http://wiki.eclipse.org/M2E_plugin_execution_not_covered)如何解决该问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-18T09:17:39.427

这是一个代理问题：

1.  在您的 setting.xml 中添加您的代理配置
2.  从主目录中删除 .m2 文件夹
3.  从命令行以交互模式运行任何 maven 命令，例如尝试创建一个项目 mvn 原型：`generate -DarchetypeGroupId=org.apache.maven.archetypes -DarchetypeArtifactId=maven-archetype-webapp -DgroupId=com.mycompany.app -DartifactId=my-webapp`
4.  就这样

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-11T11:33:37.183

显然这是代理问题。在setting.xml 中使用VPN 或编辑procy 设置。我搜索了很多关于这个错误的信息。最后，我使用 VPN（虚拟专用网络）禁用代理并能够使用 Maven 的中央存储库。

如果您不想使用 VPN，只需将 Settings.xml 主机地址更改为您公司的代理地址（在 IE->tools->connection->LAN settings->advanced->http 中可用。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-06-26T15:41:17.330

我有同样的问题。这是因为我在`settings.xml`我的 Maven 安装中配置了存储库。但是 Eclipse 没有使用它，因为它带有自己的 Maven 实现。您需要在配置文件 ( ) 的 settings.xml 中配置存储库（镜像部分`.m2/settings.xml`）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-07-31T02:10:12.227

添加依赖项无法通过 Eclipse IDE（JUNO 4.2）工作。通过在命令提示符下使用以下命令手动添加依赖项来修复该问题

1.  转到您的 pom.xml 所在的位置
2.  mvn 安装
3.  一旦您从现在开始看到状态 BUILD 成功，我们就可以继续使用 IDE。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-15T10:28:35.527

问题：
您的 Maven 存储库中缺少人工制品。

如何验证：
如果您将浏览您的存储库，您会发现 .m2/repository/org/apache/maven/plugins/maven-clean-plugin/2.4.1/ artefact 将具有 lastUpdated 后缀 - maven 尝试下载此人工制品但失败了。

如何解决：
只需将适当的人工制品添加到您的 Maven 存储库中即可：) 有几种方法可以做到这一点，但最简单的一种方法是删除缺少人工制品的文件夹。添加，因为您可以从 CMD 构建您的项目，只需将缺少的工件作为依赖项添加到您的项目中。从 CMD 构建项目。

# kml - gx：跟踪和动态更新 ExtendedData

> ID：10825184
> 
> 赞同：1
> 
> 时间：2012-05-30T22:30:27.883
> 
> 标签：kml, google-earth

我正在寻找将新坐标和相关数据点添加到Google 地球中的`<gx:Track>`a上。`<NetworkControlLink>`我已经看到了很多关于如何创建`<gx:Track>`s`<ExtendedData>`以及如何`<Update>`对通用`<Point>`对象执行 s 的示例，但我还没有看到很多讨论这两者的例子。我能找到的最接近的是这个链接，它几乎一针见血：[http ://groups.google.com/group/kml-support-advanced/browse_thread/thread/0d2cbefd087d576e?pli=1](http://groups.google.com/group/kml-support-advanced/browse_thread/thread/0d2cbefd087d576e?pli=1)

不幸的是，这个链接没有得到任何回应，原始发帖人也没有提供他的`orig_track.kml`文件，否则我可以对他所做的事情进行逆向工程，因为他声称他发现了一个解决方案。

现在我`<Placemark>`在一个文件中定义一个这样的`test.kml`：

```
<Placemark>
    <name>Target</name>
    <description>...</description>
    <gx:Track id="orig_track">
        <when>2012-05-29T22:45:00Z</when>
        <when>2012-05-29T22:45:10Z</when>
        <gx:coord>-84.396863 33.774566 285</gx:coord>
        <gx:coord>-84.396917 33.774474 285</gx:coord>
        <ExtendedData>
            <SchemaData schemaUrl="#schemaId" id="testID">
                <gx:SimpleArrayData name="sig_strength">
                    <gx:value>60</gx:value>
                    <gx:value>65</gx:value>
                </gx:SimpleArrayData>
                <gx:SimpleArrayData name="gps_lock">
                    <gx:value>true</gx:value>
                    <gx:value>true</gx:value>
                </gx:SimpleArrayData>
            </SchemaData>
        </ExtendedData>
    </gx:Track>
</Placemark> 
```

我试图通过拥有一个`<NetworkLinkControl>`看起来像这样的对象来更新它：

```
<NetworkLinkControl>
    <Update>
        <targetHref>test.kml<targetHref>
        <Create>
            <gx:Track targetId="orig_track_10003">
                <when>2012-05-29T22:45:20Z</when>
                <when>2012-05-29T22:45:30Z</when>
                <when>2012-05-29T22:45:40Z</when>
                <when>2012-05-29T22:45:50Z</when>
                <gx:coord>-84.396992 33.774443 285</gx:coord>
                <gx:coord>-84.397078 33.774421 285</gx:coord>
                <gx:coord>-84.397188 33.774363 286</gx:coord>
                <gx:coord>-84.397316 33.774298 287</gx:coord>
            </gx:Track>
            <SchemaData schemaUrl="test.kml#schemaId" targetId="testID">
                <gx:SimpleArrayData>
                    <gx:value>60</gx:value>
                    <gx:value>60</gx:value>
                    <gx:value>65</gx:value>
                    <gx:value>65</gx:value>
                </gx:SimpleArrayData>
                <gx:SimpleArrayData>
                    <gx:value>true</gx:value>
                    <gx:value>true</gx:value>
                    <gx:value>true</gx:value>
                    <gx:value>true</gx:value>
                </gx:SimpleArrayData>
            </SchemaData>
        </Create>
    </Update>
</NetworkLinkControl> 
```

我认为我的问题可能与如何`<SchemaData>`引用实例有关。如果我没记错的话，`<Schema>`定义了数组中应该包含哪些字段，当我定义`<Placemark>`上面的内容时，我用`<SchemaData>`. 我不确定如何获取我创建的数组的实例并使用`<Update>`and向其中添加元素`<Create>`。我的`<Schema>`样子是这样的：

```
<Schema name="schema" id="schemaId">
    <gx:SimpleArrayField name="sig_strength" type="int">
        <displayName>Signal Strength</displayName>
    </gx:SimpleArrayField>
    <gx:SimpleArrayField name="gps_lock" type="bool">
        <displayName>GPS Lock Status</displayName>
    </gx:SimpleArrayField>
</Schema> 
```

我希望这足够清楚，可以理解！提前感谢您提供的任何指导。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T21:59:11.140

我建议使用 MultiTrack 而不是轨道并更新它（添加新的 Track 子项以扩展 GPS 路径）。

但是，ExtendedData 是另一回事，我还没有测试更新这个。如果它没有按您的预期工作，请在此处对发生的情况和更新的代码（如果适用）发表评论。或者，您可以删除 ExtendedData，然后重新创建它。

您可能还对 Sean Askay 的博客文章感兴趣，网址为[http://www.unchartable.com/2011/05/google-io-high-performance-kml-for.html](http://www.unchartable.com/2011/05/google-io-high-performance-kml-for.html)（相关视频大约 17 分钟，并且该帖子有一个指向一些演示代码的链接，其中包含一个工作轨道更新示例）。

# c - 它在 llvm 中相当于 size_t

> ID：10825186
> 
> 赞同：8
> 
> 时间：2012-05-30T22:30:34.423
> 
> 标签：c, llvm, size-t

一些系统库，如 malloc strlen 想要或返回 size_t 作为参数。

*   LLVM IR 中与这些函数交互的正确选择是什么？
*   选择是编译器的任务吗？
*   LLVM IR 有 size_t 类型吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-30T22:53:04.657

在 LLVM 级别， size_t 不存在。它是一种为开发人员利益而设计的结构，它被定义为原生类型。本机类型对于目标体系结构具有固定大小，这就是编译器在 LLVM 位代码中表示它们的方式。因此，在 x86 上，size_t 可能被前端视为 unsigned long，然后它将其作为 i32 写入 LLVM（因为 LLVM 程序集没有无符号类型）。

* * *

## 回答 #2

> 赞同：-4
> 
> 时间：2012-05-30T22:37:03.907

您可以`size_t`在 llvm 中使用，它是正常使用的有效类型。

# python - 将 pycurl 与 gzip 流一起使用时出现错误“额外数据：第 2 行第 1 列”

> ID：10825189
> 
> 赞同：7
> 
> 时间：2012-05-30T22:30:42.710
> 
> 标签：python, json, pymongo, pycurl

谢谢阅读。

**背景：** 我正在尝试读取以`JSON`格式返回数据的流式 API 提要，然后将此数据存储到`pymongo collection`. 流式 API 需要一个`"Accept-Encoding" : "Gzip"`标头。

**发生了什么：** 代码失败 `json.loads` 并输出 - `Extra data: line 2 column 1 - line 4 column 1 (char 1891 - 5597)`（请参阅下面的错误日志）

这在解析每个 JSON 对象时不会发生 - 它是随机发生的。

我的猜测是，在每个“x”正确的 JSON 对象之后，我都会遇到一些奇怪的 JSON 对象。

如果请求的数据有时被压缩，有时不是，我确实参考[了如何使用 pycurl？](https://stackoverflow.com/questions/758243/how-to-use-pycurl-if-requested-data-is-sometimes-gzipped-sometimes-not)和[从 Google 反序列化 json 对象时出现编码错误，](https://stackoverflow.com/questions/4377260/encoding-error-while-deserializing-a-json-object-from-google)但迄今为止未能成功解决此错误。

有人可以帮我吗？

**错误日志：** *注意：*下面的 JSON 对象的原始转储基本上是使用`repr()`打印字符串的原始表示而不解析 CRLF/LF(s) 的方法。

```
 '{"id":"tag:search.twitter.com,2005:207958320747782146","objectType":"activity","actor":{"objectType":"person","id":"id:twitter.com:493653150","link":"http://www.twitter.com/Deathnews_7_24","displayName":"Death News 7/24","postedTime":"2012-02-16T01:30:12.000Z","image":"http://a0.twimg.com/profile_images/1834408513/deathnewstwittersquare_normal.jpg","summary":"Crashes, Murders, Suicides, Accidents, Crime and Naturals Death News From All Around World","links":[{"href":"http://www.facebook.com/DeathNews724","rel":"me"}],"friendsCount":56,"followersCount":14,"listedCount":1,"statusesCount":1029,"twitterTimeZone":null,"utcOffset":null,"preferredUsername":"Deathnews_7_24","languages":["tr"]},"verb":"post","postedTime":"2012-05-30T22:15:02.000Z","generator":{"displayName":"web","link":"http://twitter.com"},"provider":{"objectType":"service","displayName":"Twitter","link":"http://www.twitter.com"},"link":"http://twitter.com/Deathnews_7_24/statuses/207958320747782146","body":"Kathi Kamen Goldmark, Writers\xe2\x80\x99 Catalyst, Dies at 63 http://t.co/WBsNlNtA","object":{"objectType":"note","id":"object:search.twitter.com,2005:207958320747782146","summary":"Kathi Kamen Goldmark, Writers\xe2\x80\x99 Catalyst, Dies at 63 http://t.co/WBsNlNtA","link":"http://twitter.com/Deathnews_7_24/statuses/207958320747782146","postedTime":"2012-05-30T22:15:02.000Z"},"twitter_entities":{"urls":[{"display_url":"nytimes.com/2012/05/30/boo\xe2\x80\xa6","indices":[52,72],"expanded_url":"http://www.nytimes.com/2012/05/30/books/kathi-kamen-goldmark-writers-catalyst-dies-at-63.html","url":"http://t.co/WBsNlNtA"}],"hashtags":[],"user_mentions":[]},"gnip":{"language":{"value":"en"},"matching_rules":[{"value":"url_contains: nytimes.com","tag":null}],"klout_score":11,"urls":[{"url":"http://t.co/WBsNlNtA","expanded_url":"http://www.nytimes.com/2012/05/30/books/kathi-kamen-goldmark-writers-catalyst-dies-at-63.html?_r=1"}]}}\r\n{"id":"tag:search.twitter.com,2005:207958321003638785","objectType":"activity","actor":{"objectType":"person","id":"id:twitter.com:178760897","link":"http://www.twitter.com/Mobanu","displayName":"Donald Ochs","postedTime":"2010-08-15T16:33:56.000Z","image":"http://a0.twimg.com/profile_images/1493224811/small_mobany_Logo_normal.jpg","summary":"","links":[{"href":"http://www.mobanuweightloss.com","rel":"me"}],"friendsCount":10272,"followersCount":9698,"listedCount":30,"statusesCount":725,"twitterTimeZone":"Mountain Time (US & Canada)","utcOffset":"-25200","preferredUsername":"Mobanu","languages":["en"],"location":{"objectType":"place","displayName":"Crested Butte, Colorado"}},"verb":"post","postedTime":"2012-05-30T22:15:02.000Z","generator":{"displayName":"twitterfeed","link":"http://twitterfeed.com"},"provider":{"objectType":"service","displayName":"Twitter","link":"http://www.twitter.com"},"link":"http://twitter.com/Mobanu/statuses/207958321003638785","body":"Mobanu: Can Exercise Be Bad for You?: Researchers have found evidence that some people who exercise do worse on ... http://t.co/mTsQlNQO","object":{"objectType":"note","id":"object:search.twitter.com,2005:207958321003638785","summary":"Mobanu: Can Exercise Be Bad for You?: Researchers have found evidence that some people who exercise do worse on ... http://t.co/mTsQlNQO","link":"http://twitter.com/Mobanu/statuses/207958321003638785","postedTime":"2012-05-30T22:15:02.000Z"},"twitter_entities":{"urls":[{"display_url":"nyti.ms/KUmmMa","indices":[116,136],"expanded_url":"http://nyti.ms/KUmmMa","url":"http://t.co/mTsQlNQO"}],"hashtags":[],"user_mentions":[]},"gnip":{"language":{"value":"en"},"matching_rules":[{"value":"url_contains: nytimes.com","tag":null}],"klout_score":12,"urls":[{"url":"http://t.co/mTsQlNQO","expanded_url":"http://well.blogs.nytimes.com/2012/05/30/can-exercise-be-bad-for-you/?utm_medium=twitter&utm_source=twitterfeed"}]}}\r\n'
json exception: Extra data: line 2 column 1 - line 4 column 1 (char 1891 - 5597) 
```

**标题输出：**

```
 HTTP/1.1 200 OK

Content-Type: application/json; charset=UTF-8

Vary: Accept-Encoding

Date: Wed, 30 May 2012 22:14:48 UTC

Connection: close

Transfer-Encoding: chunked

Content-Encoding: gzip 
```

**get_stream.py：**

```
 #!/usr/bin/env python
import sys
import pycurl
import json
import pymongo

STREAM_URL = "https://stream.test.com:443/accounts/publishers/twitter/streams/track/Dev.json"
AUTH = "userid:passwd"

DB_HOST = "127.0.0.1"
DB_NAME = "stream_test"

class StreamReader:
    def __init__(self):
        try:
            self.count = 0
            self.buff = ""
            self.mongo = pymongo.Connection(DB_HOST)
            self.db = self.mongo[DB_NAME]
            self.raw_tweets = self.db["raw_tweets_gnip"]
            self.conn = pycurl.Curl()
            self.conn.setopt(pycurl.ENCODING, 'gzip')
            self.conn.setopt(pycurl.URL, STREAM_URL)
            self.conn.setopt(pycurl.USERPWD, AUTH)
            self.conn.setopt(pycurl.WRITEFUNCTION, self.on_receive)
            self.conn.setopt(pycurl.HEADERFUNCTION, self.header_rcvd)
            while True:
                self.conn.perform()
        except Exception as ex:
            print "error ocurred : %s" % str(ex)

    def header_rcvd(self, header_data):
        print header_data

    def on_receive(self, data):
        temp_data = data
        self.buff += data
        if data.endswith("\r\n") and self.buff.strip():
            try:
                tweet = json.loads(self.buff, encoding = 'UTF-8')
                self.buff = ""
                if tweet:
                    try:
                        self.raw_tweets.insert(tweet)
                    except Exception as insert_ex:
                        print "Error inserting tweet: %s" % str(insert_ex)
                    self.count += 1

                if self.count % 10 == 0:
                    print "inserted "+str(self.count)+" tweets"
            except Exception as json_ex:
                print "json exception: %s" % str(json_ex)
                print repr(temp_data)

stream = StreamReader() 
```

**固定代码：**

```
 def on_receive(self, data):
        self.buff += data
        if data.endswith("\r\n") and self.buff.strip():
           # NEW: Split the buff at \r\n to get a list of JSON objects and iterate over them
            json_obj = self.buff.split("\r\n")
            for obj in json_obj:
                if len(obj.strip()) > 0:
                    try:
                        tweet = json.loads(obj, encoding = 'UTF-8')
                    except Exception as json_ex:
                        print "JSON Exception occurred: %s" % str(json_ex)
                        continue 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-30T22:45:04.553

尝试将转储的字符串粘贴到[jsbeatuifier](http://jsbeautifier.org/)中。

你会看到它实际上是两个json对象，而不是一个，`json.loads`无法处理。

它们由 分隔`\r\n`，因此应该很容易拆分它们。

问题是`data`传递给的参数`on_receive`不一定以`\r\n`包含换行符的方式结束。正如这表明它也可以位于字符串中间的某个位置，因此仅查看数据块的末尾是不够的。

# java - ClassNotFoundException 在两个相同的服务器之一 (ObjectModelFactory)

> ID：10825191
> 
> 赞同：2
> 
> 时间：2012-05-30T22:30:49.083
> 
> 标签：java, jboss, centos

我们有一堆“相同”的 CentOS 6.2 服务器（在 Java 版本、操作系统版本、JBoss AS7 7.1、我们应用程序的 war 文件版本方面），其中大多数现在在创建 javax.xml.ws.Service 时都失败了。其中之一仍在工作，相同的 JBoss AS7 和 war 文件在我们的开发人员机器 (Mac) 上本地工作。该服务存在，其wsdl位置URL和服务名称在工作盒和非工作盒上是相同的。

我已经区分了整个 JBoss AS7 目录，其中包括所有 JBoss 库、脚本、配置以及我们在工作机器和非工作机器之间的战争。我看到的唯一差异与机器本身的 IP 地址有关。

这是我们看到的堆栈跟踪的原因，省略了几行：

```
...a lot of stuff omitted...
Caused by: java.lang.NoClassDefFoundError: org/jboss/xb/binding/ObjectModelFactory
    at org.jboss.ws.core.jaxws.spi.ServiceDelegateImpl.<init>(ServiceDelegateImpl.java:137) [jbossws-native-core-3.1.1.GA.jar:3.1.1.GA]
    at org.jboss.ws.core.jaxws.spi.ProviderImpl.createServiceDelegate(ProviderImpl.java:63) [jbossws-native-core-3.1.1.GA.jar:3.1.1.GA]
    at javax.xml.ws.Service.<init>(Service.java:57) [jboss-jaxws-api_2.2_spec-2.0.0.Final.jar:2.0.0.Final]
    at schemas.dynamics.microsoft.nav.system.SystemService.<init>(SystemService.java:41) [navisionws-1001.0-SNAPSHOT.jar:]
    ...our code omitted...
    ... 79 more
Caused by: java.lang.ClassNotFoundException: org.jboss.xb.binding.ObjectModelFactory from [Module "deployment.arinweb_public-1001.0-SNAPSHOT.war:main" from Service Module Loader]
    at org.jboss.modules.ModuleClassLoader.findClass(ModuleClassLoader.java:190)
    at org.jboss.modules.ConcurrentClassLoader.performLoadClassUnchecked(ConcurrentClassLoader.java:468)
    at org.jboss.modules.ConcurrentClassLoader.performLoadClassChecked(ConcurrentClassLoader.java:456)
    at org.jboss.modules.ConcurrentClassLoader.performLoadClassChecked(ConcurrentClassLoader.java:423)
    at org.jboss.modules.ConcurrentClassLoader.performLoadClass(ConcurrentClassLoader.java:398)
    at org.jboss.modules.ConcurrentClassLoader.loadClass(ConcurrentClassLoader.java:120)
    ... 86 more 
```

我们尝试了很多方法，包括：

1.  将整个 jboss 目录从非工作机器移动到它开始工作的工作机器。
2.  做与 #1 相反的事情，在一台机器上工作的 jboss 不再在非工作机器上工作。
3.  比较两台机器上的所有环境变量，它们匹配。

我想就下一步尝试找出问题所在提出建议。无论是那个还是解决方案都会很棒。

编辑 - JBoss 开始部署时的类加载问题：

在 JBoss 开始部署每个应用程序时，我们遇到了一些类加载问题。我已经比较了工作机器和非工作机器之间的这些警告，它们是相同的。这是一个示例（两台服务器上第一个警告类型有 37 个，第二个警告类型有 55 个）：

```
18:20:04,352 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-2) JBAS015893: Encountered invalid class name 'implementingClassName=org.jboss.shrinkwrap.impl.base.ConfigurableArchiveImpl' for service type 'org.jboss.shrinkwrap.spi.Configurable'
16:34:16,370 WARN  [org.jboss.as.server.deployment] (MSC service thread 1-40) Class Path entry shrinkwrap-resolver-impl-maven-1.0.0-beta-6.jar in "/content/snipped_war_name.war/WEB-INF/lib/snipped_jar_name.jar"  does not point to a valid jar for a Class-Path reference. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-19T13:10:40.230

谢谢大家的建议。经过大量调试后，我们发现了问题，我将在此处发布详细信息，以防万分之一的人遇到相同问题：

我们在战争中打包的这些罐子是罪魁祸首：

```
jbossws-native-core-3.1.1.GA.jar 
jbossws-native-jaxws-3.1.1.GA.jar 
jbossws-native-saaj-3.1.1.GA.jar
jbossws-native-jaxrpc-3.1.1.GA.jar 
jbossws-native-jaxws-ext-3.1.1.GA.jar 
```

JBoss AS 7 打包了它自己的版本，比我们打包的版本更新。一旦我们从战争中删除这些罐子并反弹服务器，问题似乎就消失了。

我们消除这些依赖关系的长期解决方案是将 JBoss Web 服务从 3.1.1.GA 升级到基于 CXF 的 4.0.1.GA。这涉及大量代码更改，但允许我们删除不良依赖项。

# java - MySql 存储过程编号增量器

> ID：10825192
> 
> 赞同：0
> 
> 时间：2012-05-30T22:30:53.420
> 
> 标签：java, mysql, stored-procedures

我正在尝试构建一个帐号生成器。我在想我可以通过构建一个存储过程来增加数据库表中的数字然后返回值来实现这一点。

我不是 dba，所以我不太了解设置这样的东西。有人可以指出我正确的方向以完成这项任务。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T15:30:46.847

是的，自动递增编号列将解决您的问题。如果您的帐号是字母数字，那么您可以在逻辑上将该递增编号与您的字符串部分连接起来。是的，程序也是一种替代方法，它会纯粹调用你的逻辑。

# php - htaccess mime 类型

> ID：10825200
> 
> 赞同：2
> 
> 时间：2012-05-30T22:31:35.270
> 
> 标签：php, file, .htaccess, mime, file-extension

目标是使用 .htaccess 为我的 *.php 测试脚本创建一个自定义的文件扩展名，我想自定义一个文件扩展名，以便当 Apache2 “看到”它时，Apache 会像 PHP 脚本一样执行它。吹是一个例子

测试网址是：

```
localhost/index.xyz 
```

.htaccess 位于目录 www 并且是一行：

```
AddType application/x-httpd-php5    xyz 
```

要运行的 php 文件“test.xyz”是：

```
<?php
echo "hello, I am a xyz file..."; 
```

我怎么能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T22:47:02.590

尝试

```
AddHandler application/x-httpd-php .xyz 
```

# node.js - 将 Node 与 Jade/Stylus 一起使用时的最佳“GUI”IDE

> ID：10825201
> 
> 赞同：4
> 
> 时间：2012-05-30T22:31:54.060
> 
> 标签：node.js, ide, express, pug, stylus

所以我来自终端窗口和 vi 的世界，我使用 Node.JS、Stylus 和 Jade 创建了一个站点。现在的问题是我的女朋友想帮忙，然而，她所拥有的只是用于 CSS 和 HTML 的 Dreamweaver 风格的“GUI”IDE。有没有我可以用来做这个的IDE？Cloud 9 已退出，因为该项目目前尚未公开。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-07T19:50:48.143

如果您在 Windows 上，您可以尝试[Microsoft WebMatrix 2](http://www.microsoft.com/web/webmatrix/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-19T21:35:33.920

[KomodoIDE](http://www.activestate.com/komodo-ide)对我来说是一个不错的选择。它在版本 7 中内置了 Node.js api，以及用于单步执行代码的出色交互式调试选项。ootb 有许多语法着色选项，您可以使用 UDL 创建自己的语法着色器 - [http://docs.activestate.com/komodo/7.0/udl.html](http://docs.activestate.com/komodo/7.0/udl.html)

不幸的是，没有手写笔或玉石支持，但是我发现一些内置的着色器对两者都很好用。还有一个用于 Haml 的 3rd 方插件 - 社区下载中提供 Jade 的前提 - [http://community.activestate.com/forum-topic/haml-syntax-highlighter-v](http://community.activestate.com/forum-topic/haml-syntax-highlighter-v)但我没有尝试过。考虑到 Less、SCSS 和 CoffeeScript 刚刚被添加，我敢打赌，jade & stylus 很可能会出现在他们的待办事项列表中。

我使用 Komodo 的主要原因是因为出色的 vim 键绑定支持 - 我自己是 ssh/vi 开发人员十年，现在这是我的首选编辑器。所以它也可能是你的一个选择：D

# iphone - 在 xCode 中对 Web 服务收费时出现重复的 MKAnnotations

> ID：10825202
> 
> 赞同：0
> 
> 时间：2012-05-30T22:32:06.860
> 
> 标签：iphone, objective-c, ios, xcode, ios5

我根据来自 Web 服务的响应 JSON 进行注释。

我可以在地图中加载图钉，但是当我移动中心的位置时，我必须重新加载一组新的注释并删除旧的注释。当我执行该方法时，它只会给引脚充电，如果我移动中心，它也会这样做并充电。

我已经尝试了很多这样的方法......

```
for (id<MKAnnotation> annotation in _mapView.annotations) {
    [_mapView removeAnnotation:annotation];
} 
```

但它只是这样做：我到达地图的中心，当我移动地图时，它会返回到起点，我无法缩放地图，因为它会重新加载和循环。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-04T10:22:22.023

要删除所有注释，只需在添加新注释之前运行它。

```
 NSMutableArray *toRemove = [NSMutableArray arrayWithCapacity:15];
for (id annotation in mapView.annotations){
    if (annotation != mapView.userLocation)
        [toRemove addObject:annotation];

    [mapView removeAnnotations:toRemove]; 
```

# ios - 为什么从uibutton而不是手势调用时方法失败？

> ID：10825203
> 
> 赞同：1
> 
> 时间：2012-05-30T22:32:12.840
> 
> 标签：ios, methods

我是 ios 编程的新手，我遇到了一个错误。我的应用程序用于杂志，我使用 UIScrollView 来查看文章。

在我的应用程序中，我有 2 种方式在 UIScrollView 中导航，使用手势和 2 个按钮，因为我根据页面更改滚动视图的内容并使用一种方法前进和一种后退，在它们内部我使用如果要评估它是第一页还是最后一页，并根据情况禁用按钮。

我第一次使用此方法访问视图时一切都很好，但在第二次访问时按钮失败但手势工作正常，从按钮或手势调用方法时有区别吗？

这是代码：

```
//Here is where I assign the method to the buttons and gesture
[articuloAnterior addTarget:self action:@selector(cambiarPaginaAnterior) forControlEvents:UIControlEventTouchUpInside];

[articuloSiguiente addTarget:self action:@selector(cambiarPaginaSiguiente) forControlEvents:UIControlEventTouchUpInside];

UISwipeGestureRecognizer *avanzarPagina = [[UISwipeGestureRecognizer alloc]initWithTarget:self action:@selector(cambiarPaginaSiguiente)];
avanzarPagina.direction = UISwipeGestureRecognizerDirectionLeft;

UISwipeGestureRecognizer *regresaPagina = [[UISwipeGestureRecognizer alloc]initWithTarget:self action:@selector(cambiarPaginaAnterior)];
regresaPagina.direction = UISwipeGestureRecognizerDirectionRight;

//Here are the functions
-(void)cambiarPaginaAnterior{
//This method checks if it is the first page, in case it isn't it go one page back
NSLog(@"Pagina actual %d de %d",paginaMostrada,[appDelegate.seccionActual.listadoArticulos count]-1);
if (0 != paginaActual) {
    paginaMostrada = paginaActual - 1;
    NSLog(@"Pagina actual %d de %d",paginaMostrada,[appDelegate.seccionActual.listadoArticulos count]-1);
    [self cambiarLimites];
  }
}

-(void)cambiarPaginaSiguiente{
//In this method I check the actual page (paginaActual) to see if it is the last one, if it isn't then it go forward
NSInteger limiteDePaginacion = [appDelegate.seccionActual.listadoArticulos count] - 1;
 NSLog(@"Pagina actual %d de %d",paginaMostrada,limiteDePaginacion);
if (limiteDePaginacion != paginaActual) {
    paginaMostrada = paginaActual + 1;
    NSLog(@"Pagina actual %d de %d",paginaMostrada,limiteDePaginacion);
    [self cambiarLimites];
  }
}

-(void)cambiarLimites{
//Here i save the point where the user was located and save it in an array
NSValue *posicionActualDeLaVista = [NSValue valueWithCGPoint:CGPointMake(0, contenedorGeneral.contentOffset.y)];
[posicionDeLaPagina removeObjectAtIndex:paginaActual];
[posicionDeLaPagina insertObject:posicionActualDeLaVista atIndex:paginaActual];

//Here I change the value of the actual page
paginaActual=paginaMostrada;

//Here I disable the buttons or make them able
if (paginaActual==([appDelegate.seccionActual.listadoArticulos count]-1)) {
    articuloSiguiente.enabled = NO;
}
else {
    articuloSiguiente.enabled = YES;
}
if (paginaActual==0) {
    articuloAnterior.enabled = NO;
}
else {
    articuloAnterior.enabled = YES;
}

//A log to check the state of the buttons
NSLog(@"Pagina actual %d estado del boton anterior %@, estado del boton siguiente %@",paginaActual,articuloAnterior.enabled?@"yes":@"no",articuloSiguiente.enabled?@"yes":@"no");

//Acces an array with the points the user where
CGPoint puntoDeVisualizacion = [[posicionDeLaPagina objectAtIndex:paginaActual]CGPointValue];

//Here I remove the content of the uiscrollview and put the new one
[vistaTemporale removeFromSuperview];
vistaTemporale = [vistasParaElScroll objectAtIndex:paginaActual];
vistaTemporale = [self ResizeDeLaVista:vistaTemporale laPagina:paginaActual];
[contenedorGeneral addSubview:vistaTemporale];
[contenedorGeneral setContentOffset:puntoDeVisualizacion animated:NO];

//Check the view height and change the UIScrollView content height
float limitanteDeAltura;
limitanteDeAltura = [[appDelegate.viewSizes objectAtIndex:paginaActual]floatValue];
[contenedorGeneral setContentSize:CGSizeMake(anchoDeVista, limitanteDeAltura)];
} 
```

我做了自己的手势，因为我需要取消对角滚动，所以我认为一次只显示一个视图是个好主意，但手势不是失败的，按钮没有被禁用，它们被声明为.h 文件并在第一次访问时工作正常，知道为什么会失败吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T18:58:41.103

Thanks for the help but the problem was that I was adding the buttons in the toolbar and because a memory management error the buttons still where there, so the new buttons where disabled but the old ones where visible and active, sorry for the problem

# android - 在 Android 上构建兼容性 PreferenceFragment

> ID：10825205
> 
> 赞同：14
> 
> 时间：2012-05-30T22:32:22.307
> 
> 标签：android, android-fragments, compatibility, preferenceactivity

我的 android 应用程序正在大量使用兼容性库（`Loaders`特别是）。我需要能够在任何地方使用兼容性组件，包括我的`PreferenceActivity`. 可悲的是，支持库不包括基于片段的`PreferenceActivity`，也不包括`PreferenceFragment`类。

我正在考虑制作自己的 PreferenceFragmentActivity 和 CompatPreferenceFragment （基本上是 Google 忽略的事情）。其他人，包括 StackOverflow 上的一些人，已经提到要完成这件事，所以我公开寻求任何形式的帮助——指导、提示、建议、代码示例（如果你愿意并且能够分享），或者你认为的任何其他东西与这个问题有关。

如果有人也可以将我引导到人们提交 Android 功能请求的网站，我想将我的名字添加到希望 Google 在未来版本的支持库中解决此问题的人的列表中。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-04T20:44:45.917

查看 Fr4gg0r在[http://forum.xda-developers.com/showthread.php?t=1363906](http://forum.xda-developers.com/showthread.php?t=1363906)`PreferenceFragment`上使用反射 的实现

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-31T13:44:01.753

请参阅 的[最新版本](http://developer.android.com/tools/support-library/features.html?utm_campaign=ADP-protip-827&utm_source=dac&utm_medium=plus&linkId=16598683#v7-preference)，`v7 support library`其中引入了[PreferenceFragmentCompat](http://developer.android.com/reference/android/support/v7/preference/PreferenceFragmentCompat.html?utm_campaign=ADP-protip-827&utm_source=dac&utm_medium=plus&linkId=16598687)。

# java - 什么是 Java 的“下一代插件”

> ID：10825212
> 
> 赞同：2
> 
> 时间：2012-05-30T22:32:52.860
> 
> 标签：java, applet, browser-plugin, next-generation-plugin

什么是 Java 的“下一代插件”，它与经典插件有何不同？

奇怪的是，Mac OS X 上只有一个通用插件，那么这种区别仅在 Windows 上，还是 linux 也有两个插件？

我还注意到 Firefox 只是告诉我更新经典插件，所以我想知道如果只有一个插件可以被攻破，这两个插件会有多么不同。否则 Firefox 犯了一个错误，它们都很容易受到攻击。

如果这种区别对任何 Applet 产生不利影响，我也很感兴趣。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T00:09:56.967

> 什么是 Java 的“下一代插件”，它与经典插件有何不同？

查看[小程序信息。page](https://stackoverflow.com/tags/applet/info)链接到描述它的页面。

# asp.net - WCF 数据服务查询 URL 中 DateTime 的 $filter 选项

> ID：10825214
> 
> 赞同：5
> 
> 时间：2012-05-30T22:32:57.787
> 
> 标签：asp.net, wcf, wcf-data-services

WCF 数据服务允许通过 URL 中的选项方便地查询和过滤数据。例如，假设我想要价格大于 20 的产品：

> [http://www.example.com/Service.svc/Products](http://www.example.com/Service.svc/Products) ?$filter=价格 gt 20

但是如何使用`$filter`带有 a 的选项`DateTime`？假设我想要本月已修改的所有产品。

> [http://www.example.com/Service.svc/Products](http://www.example.com/Service.svc/Products) ?$filter=ModifiedDate gt '2012-05-02'

这对我不起作用；它给出了错误信息

> 运算符“gt”与位置 13 处的操作数类型“System.DateTime”和“System.String”不兼容。

我对其他比较运算符（ge、lt、le、eq）也有同样的看法。到底是怎么回事？我该如何进行这项工作？我需要某种 DateTime 格式吗？我在上面尝试的内容似乎记录[在这里](http://blogs.msdn.com/b/marcelolr/archive/2008/01/10/filter-query-option-in-ado-net-data-services.aspx)。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-30T22:54:16.700

您好尝试使用以下语法

```
$filter=ModifiedDate gt datetime'2012-05-02T00:00:00' 
```

其他日期时间函数可以在此参考中找到 odata url 约定

URI 约定：

*   [5.0 之前](http://www.odata.org/documentation/odata-version-2-0/uri-conventions)（OData v2）
*   [5.0](http://www.odata.org/documentation/odata-version-3-0/url-conventions) (OData v3)

[http://msdn.microsoft.com/en-us/library/dd728283.aspx](http://msdn.microsoft.com/en-us/library/dd728283.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-30T22:56:11.097

对于 oData 提要中的 DateTime 过滤，使用 DateTime 前缀限定 datetime 变量。

```
 http://odata.netflix.com/v2/Catalog/Titles?$filter=DateModified eq DateTime'2012-01-31T09:45:16' 
```

上面的 url 显示了如何根据日期时间过滤 netflix odata 提要。

# java - SVN move 打破了我的构建路径？

> ID：10825215
> 
> 赞同：0
> 
> 时间：2012-05-30T22:32:59.973
> 
> 标签：java, eclipse, svn, compilation

我有一个非常令人费解的问题。我调整了我的 SVN 文件夹，创建了 trunk 和 tags 文件夹。然后，当我回到 Eclipse 中的项目时，现在我的测试类中有一个编译错误。它无法解析将正在测试的类导入测试类的导入语句。知道为什么会发生这种情况吗？

- 编辑回应评论：确切的编译错误是

```
The import <class name> cannot be resolved 
```

我在 SVN 中所做的确切更改是创建 2 个新文件夹，一个名为 trunk，一个名为 tags，然后我使用 eclipse/svn rename/move 命令将项目移动到 trunk 文件夹。然后我用eclipse/svn 切换到另一个分支/tag/revision，然后尝试Update to HEAD。我还尝试了一个 maven:clean 构建，看看是否有任何区别，但它没有。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T19:48:29.937

好吧，我仍然不明白发生了什么，但我运行了 Maven:Update Project Configuration，这解决了问题。

# python - 用python编辑jpg中的rgb值

> ID：10825217
> 
> 赞同：8
> 
> 时间：2012-05-30T22:33:05.697
> 
> 标签：python, image, image-processing, python-imaging-library, rgb

我正在尝试使用 Python Imaging Library 更改照片中的 RGB 值。我一直在使用函数 Image.point ，它做我想要的，除了我希望能够在 R、G 和 B 值上实现不同的函数。有谁知道我该怎么做？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-31T01:34:16.307

`numpy`除了 PIL 之外，您最好使用它来对图像的各个波段进行数学运算。

作为一个人为的例子，它*并不*意味着以任何方式看起来都很好：

```
import Image
import numpy as np

im = Image.open('snapshot.jpg')

# In this case, it's a 3-band (red, green, blue) image
# so we'll unpack the bands into 3 separate 2D arrays.
r, g, b = np.array(im).T

# Let's make an alpha (transparency) band based on where blue is < 100
a = np.zeros_like(b)
a[b < 100] = 255

# Random math... This isn't meant to look good...
# Keep in mind that these are unsigned 8-bit integers, and will overflow.
# You may want to convert to floats for some calculations.
r = (b + g) * 5

# Put things back together and save the result...
im = Image.fromarray(np.dstack([item.T for item in (r,g,b,a)]))

im.save('output.png') 
```

输入 ![在此处输入图像描述](../Images/fede102a0b4dac2a336a8063f8891ca6.png)

* * *

输出 ![在此处输入图像描述](../Images/b27c33b105f759c9ab0d9a3f544ee7be.png)

# c - 在C中从二进制转换为char

> ID：10825218
> 
> 赞同：11
> 
> 时间：2012-05-30T22:33:09.493
> 
> 标签：c, character-encoding, binary, char, type-conversion

我对如何将二进制值转换为 c 中的字符感到困惑。

例如，假设我有 01010110 并想从中打印相应的字母“V”。我该怎么做呢？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-05-30T22:38:53.713

```
#include <stdio.h>
#include <stdlib.h>
int main(void)
{
    char *data = "01010110";
    char c = strtol(data, 0, 2);
    printf("%s = %c = %d = 0x%.2X\n", data, c, c, c);
    return(0);
} 
```

输出：

```
01010110 = V = 86 = 0x56 
```

参考：

*   [`strtol()`](http://pubs.opengroup.org/onlinepubs/9699919799/functions/strtol.html)
*   [正确使用`strtol()`](https://stackoverflow.com/questions/14176123)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-30T22:42:44.063

您可以使用`strtol()`来解析字符串上的数字。最后一个参数（在本例中为 2）是转换的基数。

```
char c = strtol("01010110", (char **)NULL, 2); 
```

有关此功能和其他数字解析功能的更多信息，请[点击此处](http://h30097.www3.hp.com/docs/base_doc/DOCUMENTATION/V51B_HTML/MAN/MAN3/1938____.HTM)。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-05-30T23:09:47.120

做了一些稍微不同的事情：

从二进制文件中，我用数学方法计算了 int，然后简单地将 int 转换为 char。

```
int i;
char c = (char)i; 
```

# jquery - 为什么我看不到我的 jQuery UI 动画？

> ID：10825219
> 
> 赞同：3
> 
> 时间：2012-05-30T22:33:15.290
> 
> 标签：jquery, css, jquery-ui, z-index

我有一个要进入幻灯片的元素，当幻灯片进入时，该元素使用 jQuery UI 效果`explode`出现。

```
$e.show('explode', {}, 1000); 
```

当我第一次运行它时，我根本没有看到元素出现。所以我想“哦，它一定是 z-index”并将元素的 z-index 设置为 10 并确保它已`position`定义。（幻灯片的 z-index 为 5）

这使得图像在效果完成*后显示出来。*我把幻灯片藏起来测试，果然，动画是在幻灯片后面发生的，貌似有一个较低的`z-index`.

为什么在动画之后我才能看到元素？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-30T22:33:15.430

## 发生了什么

当某些元素使用 jQuery UI 进行动画处理时，根据效果，元素本身可能会被克隆。您正在操作的元素 ($e) 实际上是隐藏的，并且在动画时不是 DOM 的一部分，因此您的 CSS 规则在这里毫无用处。*一些*规则适用于 jQuery 克隆的元素，但是，z-index 不是其中之一。

## 用 CSS 动画修复它

我建议使用直接操作元素的[CSS 动画](http://www.w3schools.com/css3/css3_animations.asp)，而无需克隆元素。尽管这会使效果`explode`稍微复杂一些，但您不仅要维护 CSS 规则，而且 CSS 动画比 jQuery UI 动画具有巨大的性能提升。（jQuery UI 分别应用动画的每个“步骤”，这意味着许多[重绘](http://www.phpied.com/rendering-repaint-reflowrelayout-restyle/)）。然而，它的一个限制是跨浏览器兼容性，因为看起来 IE 仍然[无法与 this 相提并论](http://caniuse.com/css-animation)。

## 使用 z-index 修复它

如果您一心想使用 jQuery UI 制作动画，或者不能冒缺乏跨浏览器兼容性的风险，那么仍有希望。在我的测试中，“克隆”元素获得了一个临时添加到它的类`ui-effects-explode`。似乎大多数需要克隆原始元素的 jQuery UI 动画都应用了具有相似语法的类 ( `ui-effects-*`)。

为了避免对单个效果的挫败感，您的万能方法是制定如下 CSS 规则：

```
[class^=ui-effects] {
    z-index: 10;
} 
```

where`^=`的意思是“开始于”。这会将 z-index 应用于 jQuery UI 命名空间中的任何克隆元素，并且应该可以解决您的问题。

# osx-lion - Mac OSX Lion 和 libiconv

> ID：10825221
> 
> 赞同：1
> 
> 时间：2012-05-30T22:33:16.060
> 
> 标签：osx-lion, libiconv

我在 Mac OSX Lion 上运行 FreeSWITCH，费了很大劲才编译它。当我运行该应用程序时，我收到此错误：

```
Reason: Incompatible library version: mod_XXX.so requires version 8.0.0 or later, but libiconv.2.dylib provides version 7.0.0** 
```

我用谷歌搜索了一下，这似乎是一个普遍的问题。我去 gnu.org 下载了最新版本的 libiconv，并安装了它。在那之后，我的 Mac 出了问题。处理器一直在旋转，当我重新启动 OSX 时根本无法启动（留在灰色的 Apple 屏幕上永远旋转）。我把它带到苹果商店，他们建议重新安装操作系统。我这样做并站了起来。

现在我害怕重新升级 libiconv。谁能推荐一个兼容 OSX Lion 的版本？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-03T01:17:49.623

看在上帝的份上，不要把它放在 /usr/lib - 把它放在 /usr/local/lib 或 /opt/lib 中，然后把它们放在你的 LD_Library_Path 中。永远不要覆盖您的 /usr/lib 或 /Library/Framework。

要修复它，请使用恢复磁盘启动，然后从 Time Machine 备份中恢复 /usr/lib。

# f# - Fsharp - 类型编译错误

> ID：10825230
> 
> 赞同：0
> 
> 时间：2012-05-30T22:33:55.233
> 
> 标签：f#, filesystems, fsharpchart

我是 F# 的新手，我很想得到一些帮助 :)

我有 ？这段代码的编译错误，我无法弄清楚：

```
printfn "Please enter the path for the Jack file/s directory"
let dir = System.Console.ReadLine()
let jackFiles : List<String> = (new List<String>())
dir
|> Directory.GetFiles
|> Seq.iteri(fun file -> if ((Path.GetExtension(file)).Equals(".jack")) then JackFiles.Add(file)) 
```

编译器喊出这个错误：

> 这个表达式应该有类型`string->unit`，但这里有类型`unit`

关于`if ((Path.GetExtension(file)).Equals(".jack")) then JackFiles.Add(file))`部分...

为什么它是错误的，我该如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T22:44:43.400

的函数参数`Seq.iteri`需要两个参数并且应该具有类型`(int -> 'T -> unit)`。它的 file 参数被推断为具有 type `int`，因此您的`if`语句应该具有 type`string -> unit`但实际上具有 type `unit`，因此出现错误。

看起来您不需要该`int`参数，因此您可以使用该参数`Seq.iter`。

但是，看起来您尝试做的事情可以使用类似于以下内容来完成：

```
let jackFiles = Directory.GetFiles(dir, "*.jack") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T01:38:56.840

除了@Lee 的回答，我还有几点意见：

*   避免错误的一种方法是使用`for`循环而不是`Seq.iter(i)`. 我发现`for`循环更具可读性，而无需处理闭包。
*   `System.Collections.Generic.List<T>`存在于 F# 中的名称下`ResizeArray`。您甚至在 F# PowerPack 中拥有[ResizeArray 模块](http://research.microsoft.com/en-us/um/cambridge/projects/fsharp/manual/fsharp.powerpack/microsoft.fsharp.collections.resizearray.html)，其中包含所有必要的高阶函数。
*   一个应该你`=`而不是`obj.Equals`.

应用上述评论，您的解决方案如下所示：

```
let jackFiles = ResizeArray()
for file in Directory.GetFiles(dir) do
    if Path.GetExtension(file) = ".jack" then jackFiles.Add(file) 
```

# python - Django，动态 urlconfs，线程安全

> ID：10825231
> 
> 赞同：8
> 
> 时间：2012-05-30T22:33:59.970
> 
> 标签：python, django, urlconf

我需要以线程安全的方式根据会话中的数据动态生成 urlpatterns。

我通过一个自定义 URLResolver 实现了这一点，该 URLResolver 将 url 解析推迟到以后。我确实知道从中间件设置 request.urlconf ；但是我不能这样做是有原因的（Django缓存解析器，在我的情况下会导致无限的内存使用）。

我需要有人来看看实现，看看我是否正确处理了线程安全。

谢谢！

编码：

我的应用程序/urls.py：

```
urlpatterns = patterns('',
    # other urlconfs
    url(r'^/foo', include('foo.urls')),
) 
```

富/urls.py：

```
import threading
from django.core.urlresolvers import ResolverMatch

class MyResolver(RegexURLResolver):
    def __init__(self):
        self.resolver = threading.local()
        return super(MyResolver, self).__init__(r'', None)

    @property
    def urlconf_module(self):
        return self.resolver.value

    def resolve(self, path):
        def view(request):
            resolver = request.session.get('myresolver', 'default')
            resolver = getattr(import_module('foo.resolvers'), resolver)
            self.resolver.value = resolver()
            view, args, kwags = super(MyResolver, self).resolve(path)
            return view(request, *args, **kwargs)
         return ResolverMatch(view, (), {})

urlpatterns = [MyResolver()] 
```

foo/resolvers.py：

```
class default(object):
    @property
    def urlpatterns(self):
        return patterns('foo.views',
           url(r'', 'error'),
        )

 class test(object):
     @property
     def urlpatterns(self):
         return dynamically_generated_urlpatterns 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-17T20:16:45.693

我会说你实际上最好将它实现为中间件，因为它可能会更快并给你更多的控制权。

也许您可以更多地展示您计划提交给函数的数据和可能的输出。

关于用例的更多细节会很好。

# windows - 根据复选框答案有条件地添加注册表项

> ID：10825239
> 
> 赞同：2
> 
> 时间：2012-05-30T22:35:04.567
> 
> 标签：windows, installation, inno-setup

我正在为我的 Windows .NET 应用程序使用 Inno Setup。我在询问用户是否要使用以下代码在 Windows 上启动应用程序：

```
[Tasks]
Name: "TaskEntry"; Description: "Start with Windows?"; GroupDescription: "Startup";

[code]
function NextButtonClick(CurPageID: Integer): Boolean;
begin
  Result := True;
  if CurPageID = wpSelectTasks then                                          
  begin
    if WizardForm.TasksList.Checked[3] then
      MsgBox('Startup has been checked.', mbInformation, MB_OK)
    else
      MsgBox('Startup has not been checked.', mbInformation, MB_OK);
  end;
end;

procedure CurPageChanged(CurPageID: Integer);
begin
  if CurPageID = wpSelectTasks then
    WizardForm.TasksList.Checked[3] := False;
end; 
```

如何添加注册表项而不是消息框？

我知道我可以无条件地做到这一点：

```
[Registry]
Root: HKCU; Subkey: "Software\Microsoft\Windows\CurrentVersion\Run"; ValueType: string; \
    ValueName: "key"; ValueData: "{app}\{#MyAppExeName}"; Flags: uninsdeletevalue 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-30T23:09:40.907

您不需要任何代码。向您的注册表项添加一个[`Tasks`](http://www.jrsoftware.org/ishelp/index.php?topic=componentstasksparams)参数，并且仅当用户选择此任务时才会处理该参数：

```
[Registry]
Root: HKCU; Subkey: "Software\  [...] Flags: uninsdeletevalue; Tasks: TaskEntry 
```

# android - 使用来自在线数据库的 jsonobject 和 listview 进行 Sql 注入

> ID：10825241
> 
> 赞同：-3
> 
> 时间：2012-05-30T22:35:13.167
> 
> 标签：android, android-intent

我想要制作的应用程序的快速描述。
在线 mysql 数据库 --> 到带有 php 代码的 json 对象 --> 到 sqlite 数据库----> 到 listview
我是 android 开发新手，我正在尝试从在线示例和教程中学习。我将在这里发布所有项目和代码。
为了更容易找到问题，我告诉你，当我运行程序时，我会在 logcat 消息“JSON 和我的数据库的一些数据”中看到。所以php运行良好。问题是当我运行程序时，模拟器上出现黑屏。
我很乐意提供您需要的更多数据。我想要做的是从在线 mysql 数据库中获取数据，并在开始屏幕上使用这些数据创建一个列表视图。
我的 main.xml 仅包含一个带有名称列表的列表视图。我的自定义列表包含 3 个名为 dateview storeview eventview 的文本视图。
这是 Main.java

```
package gr.nickKladis.gridview;

import org.json.JSONException;
import org.json.JSONObject;

import gr.nickKladis.information.library.DatabaseHelper;
import gr.nickKladis.information.library.UserFunctions;
import android.app.Activity;
import android.app.ListActivity;
import android.database.Cursor;
import android.database.sqlite.SQLiteDatabase;
import android.os.Bundle;
import android.widget.EditText;
import android.widget.ListAdapter;
import android.widget.ListView;
import android.widget.SimpleCursorAdapter;
import android.widget.TextView;

public class Main extends Activity {
/** Called when the activity is first created. */
private static String KEY_SUCCESS = "success";
private static String KEY_ERROR = "error";
private static String KEY_ERROR_MSG = "error_msg";
private static String KEY_ID = "uid";
private static String KEY_DATE = "date";    
private static String KEY_HOURS = "hours";
private static String KEY_STORENAME = "store_name";
private static String KEY_EVENTINFORMATION = "event_information";
private static String KEY_EVENTTYPE = "event_type";
private static String KEY_PHONE = "phone";
private static String KEY_ADDRESS = "address";
private static String KEY_CREATED_AT = "created_at";
protected Cursor cursor;
protected ListView eventlist;
protected ListAdapter adapter;
protected SQLiteDatabase db;

@Override
public void onCreate(Bundle savedInstanceState)
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    eventlist = (ListView) findViewById (R.id.list); //declaration of the listview

    UserFunctions userFunction = new UserFunctions();
    JSONObject json = userFunction.showallevents();

    try {
        if (json.getString(KEY_SUCCESS) != null) 
        {

            String res = json.getString(KEY_SUCCESS); 
            if(Integer.parseInt(res) == 1)
            {

                DatabaseHelper db = new DatabaseHelper(getApplicationContext()); //casted

                JSONObject json_event = json.getJSONObject("event");

                db.addEvent(json_event.getString(KEY_DATE), json_event.getString(KEY_HOURS), json_event.getString(KEY_STORENAME), json_event.getString(KEY_EVENTINFORMATION),json_event.getString(KEY_EVENTTYPE), json_event.getString(KEY_PHONE),json_event.getString(KEY_ADDRESS), json_event.getString(KEY_CREATED_AT));

                cursor = db.getWritableDatabase().rawQuery("SELECT `events`.`store_name`,`events`.`date`,`events`.`event_type`FROM `events`", null);
                    adapter = new SimpleCursorAdapter(   //cursor adapter
                            this, 
                            R.layout.customlist, 
                            cursor, 
                            new String[] {"store_name", "event_type", "date"}, 
                            new int[] {R.id.storeview, R.id.eventview, R.id.dateview});
                    eventlist.setAdapter(adapter);

                }

        }

    } 
    catch (JSONException e) 
    {
        e.printStackTrace();
    }

    }

}; 
```

这是 DatabaseHelper.java

```
package gr.nickKladis.information.library;

import android.content.ContentValues;
import android.content.Context;
import android.database.sqlite.SQLiteDatabase;
import android.database.sqlite.SQLiteOpenHelper;

public class DatabaseHelper extends SQLiteOpenHelper {

public static final String DATABASE_NAME = "infodata";  //database name
private static final String TABLE_LOGIN = "events";
private static final String KEY_ID = "uid";
private static final String KEY_DATE = "date";    
private static final String KEY_HOURS = "hours";
private static final String KEY_STORENAME = "store_name";
private static final String KEY_EVENTINFORMATION = "event_information";
private static final String KEY_EVENTTYPE = "event_type";
private static final String KEY_PHONE = "phone";
private static final String KEY_ADDRESS = "address";
private static final String KEY_CREATED_AT = "created_at";

public DatabaseHelper(Context context) {
    super(context, DATABASE_NAME, null, 1);  //construction of database
}

@Override
public void onCreate(SQLiteDatabase db) {

    String sql = "CREATE TABLE " + TABLE_LOGIN + "("
            + KEY_ID + " INTEGER PRIMARY KEY,"
            + KEY_DATE + " DATE,"
            + KEY_HOURS + " TEXT,"
            + KEY_STORENAME + " TEXT,"
            + KEY_EVENTINFORMATION + " TEXT,"
            + KEY_EVENTTYPE + " TEXT,"
            + KEY_PHONE + " INTEGER,"
            + KEY_ADDRESS + " TEXT,"
            + KEY_CREATED_AT + " TEXT" + ")";
    db.execSQL(sql); //execution of the sql string

}

public void addEvent(String date , String hours, String storename, String eventinformation, String eventtype, String phone, String address, String created_at) {
    SQLiteDatabase db = this.getWritableDatabase();

    ContentValues values = new ContentValues();
    values.put(KEY_DATE, date); // Name
    values.put(KEY_HOURS, hours); // Hours
    values.put(KEY_STORENAME, storename); // store name
    values.put(KEY_EVENTINFORMATION, eventinformation); // event information
    values.put(KEY_EVENTTYPE, eventtype); // event type
    values.put(KEY_PHONE, phone); // phone
    values.put(KEY_ADDRESS, address); // address
    values.put(KEY_CREATED_AT, created_at); // Created At

    // Inserting Row
    db.insert(TABLE_LOGIN, null, values);

}

@Override
public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
    db.execSQL("DROP TABLE IF EXISTS events");  //upgrade?
    onCreate(db);
}

} 
```

这是 JSONParser.java

```
package gr.nickKladis.information.library;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.io.UnsupportedEncodingException;
import java.util.List;
import org.apache.http.HttpEntity;
import org.apache.http.HttpResponse;
import org.apache.http.NameValuePair;
import org.apache.http.client.ClientProtocolException;
import org.apache.http.client.entity.UrlEncodedFormEntity;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.impl.client.DefaultHttpClient;
import org.json.JSONException;
import org.json.JSONObject;

import android.util.Log;

public class JSONParser {

static InputStream is = null;
static JSONObject jObj = null;
static String json = "";

public JSONParser() {

}

public JSONObject getJSONFromUrl(String url, List<NameValuePair> params) {

    try {

        DefaultHttpClient httpClient = new DefaultHttpClient();
        HttpPost httpPost = new HttpPost(url);
        httpPost.setEntity(new UrlEncodedFormEntity(params));

        HttpResponse httpResponse = httpClient.execute(httpPost);
        HttpEntity httpEntity = httpResponse.getEntity();
        is = httpEntity.getContent();

    } catch (UnsupportedEncodingException e) {
        e.printStackTrace();
    } catch (ClientProtocolException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    }

    try {
        BufferedReader reader = new BufferedReader(new InputStreamReader(
                is, "iso-8859-1"), 8);
        StringBuilder sb = new StringBuilder();
        String line = null;
        while ((line = reader.readLine()) != null) {
            sb.append(line + "n");
        }
        is.close();
        json = sb.toString();
        Log.e("JSON", json);
    } catch (Exception e) {
        Log.e("Buffer Error", "Error converting result " + e.toString());
    }

    try {
        jObj = new JSONObject(json);
    } catch (JSONException e) {
        Log.e("JSON Parser", "Error parsing data " + e.toString());
    }

    // return JSON String
    return jObj;

}
} 
```

这是 UserFunctions.java

```
package gr.nickKladis.information.library;

import java.util.ArrayList;
import java.util.List;

import org.apache.http.NameValuePair;
import org.apache.http.message.BasicNameValuePair;
import org.json.JSONObject;

public class UserFunctions {

private JSONParser jsonParser;

private static String loginURL = "http://10.0.2.2/information/";

private static String login_tag = "showallevents";

public UserFunctions(){
    jsonParser = new JSONParser();
}

public JSONObject showallevents(){
    // Building Parameters
    List<NameValuePair> params = new ArrayList<NameValuePair>();
    params.add(new BasicNameValuePair("tag", login_tag));
    JSONObject json = jsonParser.getJSONFromUrl(loginURL, params);
    // return json
       return json;
}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T14:44:05.203

[http://grail.cba.csuohio.edu/~matos/notes/cis-493/lecture-notes/Android-Chapter10-WebKit.pdf](http://grail.cba.csuohio.edu/~matos/notes/cis-493/lecture-notes/Android-Chapter10-WebKit.pdf) 如果您将 URL 设置为页面依赖于 Javascript 的站点，您可能会看到一个空的，白屏。默认情况下，WebView 小部件中的 Javascript 是关闭的。如果要启用 Javascript，请调用：myWebView.setSettings().setJavaScriptEnabled(true); 在 WebView 实例上

# ruby - 使用弹性搜索和轮胎忽略重音

> ID：10825242
> 
> 赞同：5
> 
> 时间：2012-05-30T22:35:24.713
> 
> 标签：ruby, elasticsearch, tire

我正在继承一个通过轮胎进行弹性搜索的项目。

搜索正在工作，但通过它关闭了口音。例如，搜索“this”需要返回“thís”和“thiš”。

我已阅读此轮胎文档： http: [//karmi.github.com/tire/](http://karmi.github.com/tire/)

以及：[http ://railscasts.com/episodes/306-elasticsearch-part-1?view=asciicast](http://railscasts.com/episodes/306-elasticsearch-part-1?view=asciicast)

其中提到大多数弹性搜索的选项都可以在轮胎中使用。

关于忽略重音的搜索，asciifolding 不断出现，但弹性搜索只是这样说：

[http://www.elasticsearch.org/guide/reference/index-modules/analysis/asciifolding-tokenfilter.html](http://www.elasticsearch.org/guide/reference/index-modules/analysis/asciifolding-tokenfilter.html)

此外，我发现了一些关于过滤器/口音/等的东西，例如：

[https://github.com/elasticsearch/elasticsearch/issues/890](https://github.com/elasticsearch/elasticsearch/issues/890)
[https://gist.github.com/2142635](https://gist.github.com/2142635)

但他们都在使用裸弹性搜索选项。

当我尝试在我的 ruby​​ 代码中使用 asciifolding 过滤器时，我收到关于没有为“asciifolding”定义过滤器的错误。

这是在我的代码中完成的搜索的内容 - 我如何修改它以进行不区分重音的搜索。它是asciifolding吗，如果是这样，我该如何在这里声明它？

```
result = tire.search(:load => true,page: params[:page], per_page: params[:per_page] ) do
  query { string "#{params[:term]}", :default_operator => 'and' }  if params[:term].present?
  filter  :missing,   :field => 'original_media_id' #see above
  #asciifolding?
  sort { by :updated_at, :desc } if params[:term].present?
  facet 'files' do
    terms  'indexed_files.file.id'  
  end
end 
```

编辑：或者它应该在映射/索引中完成？然后重新运行索引器。这是映射，我尝试将 :filter => "asciifolding" 放入某些索引，但这似乎不起作用（也不会生成任何错误输出）：

```
tire.mapping do
    indexes :id, :index => :not_analyzed
    indexes :name, :filter => "asciifolding"
    indexes :description, :filter => "asciifolding"
    indexes :created_at, :type => 'date'
    indexes :updated_at, :type => 'date'
    indexes :file_type
    indexes :indexed_files, :type => 'object' do
        indexes :file, :type => 'object', 
            :properties => { 
            :title => {
            :type => "multi_field",
              :fields => {
                :raw => { :type => 'string', :index => 'not_analyzed'},
                :title => { :type => 'string', :filter => "asciifolding" }
              }
            },
            :description => { :type => "string", :filter => "asciifolding" }
           }
    end
end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-29T20:07:14.780

在这篇文章中有一个非常好的“asciifolding”示例（在索引文本时从标记中删除重音符号）：[**Autocomplete with Tire**](http://dev.af83.com/2012/01/19/autocomplete-with-tire.html)

# javascript - 滚动后从文档顶部停止 div 100px

> ID：10825246
> 
> 赞同：1
> 
> 时间：2012-05-30T22:36:00.640
> 
> 标签：javascript, jquery

我在窗口滚动时得到随机结果。我基本上点击一个框，打开它并展开。展开后，窗口应该滚动到它，在距离浏览器窗口顶部 100 像素处停止它，但它不会而且它有点随机，并非所有框都停止在与窗口相同的距离处。

这就是我的意思，我正在努力，展开盒子，看看：谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T22:37:18.487

```
$('html, body').animate({scrollTop:$(".opened").position().top - 100}, 2000); 
```

使用`position()`过`offset()`。

[http://api.jquery.com/position/](http://api.jquery.com/position/)

# mysql - SQL WHERE 列 = 一切

> ID：10825247
> 
> 赞同：50
> 
> 时间：2012-05-30T22:36:02.963
> 
> 标签：mysql, sql

SQL 是否能够按照以下方式做一些事情：`SELECT * FROM table WHERE column = everything`

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2018-09-18T15:54:56.277

对于出于任何原因（可能是动态 SQL）在查询中需要列名的任何人，一个不错的选择是`SELECT * FROM table WHERE column = column`

这与 非常相似`WHERE 1=1`，但是它包含列名，这是我的解决方案所需的，也许还有一些其他的也需要。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2012-05-30T22:39:16.600

```
SELECT * FROM table 
```

如果你动态生成 SQL，它是

```
SELECT * FROM table WHERE 1=1 
```

`1=1`占位符允许您返回所有记录，或者如果您要返回子集或需要其他条件语句，则可以替换实际条件 。

**另请参阅**
[为什么有人会在 SQL 子句中使用 WHERE 1=1 AND <conditions>？](https://stackoverflow.com/questions/242822/why-would-someone-use-where-1-1-and-conditions-in-a-sql-clause)

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2012-05-30T22:41:56.270

您的问题允许三种解释：

1.  您不关心该列：从 where 子句中删除它（或者如果这是唯一的子句，则将 where 子句一起删除）
2.  您希望设置列，有点您不在乎：使用`WHERE column IS NOT nULL`
3.  您需要一个搜索，它还可以显示来自简单 SQL 模板的所有记录：`SELECT * FROM table WHERE column LIKE '%$searchterm%'`

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2012-05-30T22:37:55.280

一切还是什么？

我猜你可以使用通配符。

```
SELECT * FROM table WHERE column LIKE "%" 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2020-01-02T07:49:52.307

您可以在查询中使用列名本身：

```
SELECT * FROM TABLE WHERE COLUMN = COLUMN 
```

例如：

```
SELECT * FROM Student WHERE YEAR = YEAR 
```

或使用辅助参数：

```
SELECT * FROM Student WHERE YEAR = (CASE WHEN @year IS NOT NULL THEN @year ELSE YEAR END) 
```

所以你可以坚持“=”字符

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2019-06-21T21:47:50.817

```
SELECT * FROM table WHERE column = IF (? = '', column, ?); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2015-10-17T16:25:18.200

这很晚，但可能对其他人有帮助

你可以试试这个。

```
where 
    isnull([column], '') = CASE WHEN @column IS NULL THEN isnull([column], '') ELSE @column END 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-05-30T22:38:11.093

您是否正在寻找 IN 标准运算符？

```
SELECT * from table where column in (1,2,3,4,5) or column in ('value', 'value2', 'value3'); 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2020-07-06T21:10:11.363

I've faced this problem while developing dynamically composing query. Here is my solution in short:

```
WHERE (column = ANY (SELECT distinct column) OR column IS NULL) 
```

This works with NULL values and practically it is identical to empty WHERE statement. I use brackets in order to keep the ability to add more WHERE options using AND operator.

It means that this:

```
select count("objectId"), "source"
from "SomeTable"
where "createdAt" > '2020-07-06'
    and ("source" = any (select distinct "source") or "source" is null)
    and ("country" = any (select distinct "country") or "country" is null)
    and "channel" is not null
group by "source" 
```

equals to this:

```
select count("objectId"), "source"
from "SomeTable"
where "createdAt" > '2020-07-06'
    and "channel" is not null
group by "source" 
```

So I can make a query template:

```
...
    WHERE (column = {{filter_value}} )
... 
```

and set `ANY (SELECT distinct column) OR column IS NULL)` as default value for {{filter_value}}

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2019-04-17T16:00:53.607

好吧，我也遇到了同样的问题，以下解决了我的问题：

```
... where column = case when @variable = 'all' then column else @variable end 
```

> **请记住，您必须始终发送默认值** ，我将默认值设置为“全部”。因此，如果我设置`@variable = 'all'`，mysql 将其读取为： `where column = column`这与`where 1=1`

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-07-15T13:10:03.757

把猫王操作员放到那个领域

```
" . ($variable == 'selected value' ? '' : "AND column='" . $variable . "' ") . " 
```

因此，如果您在 html 页面的选项中选择所有选项，此 ^^ 字段将不会运行，但是当您选择某些内容时，此代码将显示为 column='".$variable."'

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-01-29T15:31:10.510

如果这对任何人都有帮助...只是指出，如果您遇到诸如 SELECT * FROM something WHERE（可以是特定的或所有内容）之类的问题（例如过滤内容），则可以使用
`SELECT * FROM something as s WHERE (?1 = 0 OR ?1 = s.type = ?1)`
0 这里只是为所有人预定义的，所以感觉可以自由更改，我在使用 JPA 存储库和 hibernate 进行过滤时需要这个。由于准备好的陈述的安全性，您不能按照先前答案的建议在医学上执行此操作。其中 ?1 对应于：

```
 Page<Something> filterSometing(Long type,Pageable pageable); 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-10-04T12:32:22.580

您可以使用

```
WHERE 1 
```

1 就像在其他语言中总是正确的。所以你没有过滤器

# loops - 使用循环与在 try/except 中获取特定索引

> ID：10825248
> 
> 赞同：1
> 
> 时间：2012-05-30T22:36:05.150
> 
> 标签：loops, python

对于我正在处理的一个项目，我正在处理许多深度嵌套的 dict-and-list 数据结构。我经常发现自己在进行查找，希望返回一个包含单个成员的列表。查找可能完全失败，或者只是返回零结果，所以我可以编写如下代码：

```
try:
    value_I_need = lookup_results[0]
except IndexError:
    # handle lookup failure, keep going 
```

但最近我一直想知道编写一个循环是否更具前瞻性，最初假设它只发生零次或一次：

```
value_I_need = None
for value_I_need in lookup_results:
    break
if value_I_need is None:
    # handle lookup failure, keep going 
```

（我说“面向未来”是因为我可能想重写或概括此代码以处理具有多个结果的查找。）这两种方法中的任何一种是否存在固有的非pythonic、错误或速度慢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-30T23:07:03.123

[内置函数`next()`](http://docs.python.org/library/functions.html#next)正是这样做的：

```
a = ()
b = [1, 2, 3]
print next(iter(a), "empty") # prints "empty", as a doesn't give any values.
print next(iter(b), "empty") # prints 1, the 1st value of b 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T23:00:30.917

为什么`for`？可以更清楚地说：

```
if value_I_need not in lookup_results:
    print "I need it but it ain't there" 
```

换句话说，你不会得到一个序列

```
for x in y:
    break 
```

if`y`是序列类型，`x`将是第一个元素；对于 dict 类型，它将是第一个元素的（随机）键。`x`之前注定的，以后`for`就不会了。那是：

```
x = 5
for x in range(10):
     break 
```

将 0 绑定到`x`，并且它在第一行中的任何五位都对第二行没有影响。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T23:09:26.913

保持简单明了。

```
if len(lookup_results) == 1:
    result = lookup_results[0]
    # ...
else:
    # ... 
```

这里的任何性能差异 - 正面或负面 - 都将是微观的，它更清楚地传达了您的意图。

如果您以后需要重构，那么编写这些方式中的任何一种都不会对您花费的时间产生重大影响（当然，除非您不知道代码在做什么）。

# algorithm - 在无向图中的两个顶点之间的所有简单路径上查找所有 *vertices*

> ID：10825249
> 
> 赞同：15
> 
> 时间：2012-05-30T22:36:07.150
> 
> 标签：algorithm, language-agnostic, graph, depth-first-search, breadth-first-search

枚举任意图中两个顶点之间的所有简单路径通常需要指数时间，因为顶点之间可能存在指数数量的简单路径。但是，如果我们只对两个端点之间至少一条简单路径上的*顶点感兴趣呢？*

那就是：**给定一个无向图和两个不同的顶点，是否有一种多项式时间算法可以找到两个顶点之间至少一条简单路径上的每个顶点？**这与连接性不同；死胡同和死胡同被排除在外。但是，允许分支和连接路径。

我发现编写一个看起来可以解决这个问题的算法非常容易，但在某些情况下会失败，或者在病态情况下需要指数级的运行时间。

更一般地说：**给定图中的两组不相交的顶点，是否有一种多项式时间算法可以找到位于从一组顶点到另一组顶点的简单路径上的所有顶点？**

（如果有一个非常明显的解决方案，请原谅我。当然感觉应该有。）

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-05-31T05:55:40.063

**这是一个线性时间确定性解决方案。**在两个末端顶点之间插入一条边（我们称它们为 a 和 b），如果这样的边不存在，则将您的问题变成找到位于通过 a 和的任何简单循环的最大顶点集 v 的问题湾。您可以说服自己这样的集合对应于包含 a 和 b 的最大子图，不能通过删除其任何节点（也称为双连接组件）来断开连接。[本页](http://en.wikipedia.org/wiki/Biconnected_component)介绍了 Hopcroft 和 Tarjan 的概念和经典的线性时间（基于 DFS）算法，用于识别所有双连通分量（您只需要包含 a 和 b 的那个）。

关于两个集合之间的简单路径（我们称它们为 A 和 B）的第二个问题可以通过创建一个新顶点 a 与 A 中的所有顶点的边和一个顶点 b 与 B 中的所有顶点的边来简化为第一个问题，并且然后为 a 和 b 解决你的第一个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T01:32:50.657

你介意概率解决方案吗？也就是说，它不能保证找到所有的顶点，但它通常会首先尝试，并且极有可能在 2 或 3 次尝试之后？

如果您对此感到满意，请随机为每个边缘分配一个电阻，并求解每个节点的电压，如果您将源置于 1 电压，将接收器置于 0 电压。两个节点连接它的任何边缘在不同的电压下显然是在一条简单的路径上（路径很容易构建，只需从一端通过上升电压，从另一端下降）。连接它的两个节点处于相同电压的边缘极*不可能*位于简单路径上，尽管理论上可能会发生这种情况。

重复几组随机分配的阻力，你很可能已经找到了简单路径上的所有边。（你还没有证明这个答案，但错误的可能性非常小。）

当然，一旦您知道简单路径上的所有边，获取简单路径上的所有顶点就很简单了。

**更新**

我相信以下是真实的，但没有证据。假设我们采用一组电阻并计算出电压。对于简单路径中的每个边缘，都有另一个边缘（可能相同），因此仅改变该边缘的电阻将导致第一个边缘上的电压发生变化。如果是这样，则可以在多项式时间内识别简单路径中的每条边。

直觉上这对我来说是有道理的，但我不知道我将如何证明它。

# backbone.js - Backbone.js 视图的特殊选项有什么特别之处？

> ID：10825252
> 
> 赞同：0
> 
> 时间：2012-05-30T22:36:25.853
> 
> 标签：backbone.js, backbone-views

根据[backbone.js](http://documentcloud.github.com/backbone/#View-constructor)`View` doc ：

> 有几个特殊选项，如果通过，将直接附加到视图 ：`model`、`collection`、`el`、`id`、`className`和。`tagName``attributes`

我了解`el`, `id`&`className`用于包装任何内容`render()`，但是

一个物体有多 *特别*？_ View 方法是否使用它们？`model``collection``View`

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T23:10:32.043

不，查看方法不使用此选项。`model`并且`collection`只会成为 View 对象的属性。引用来源：

```
// List of view options to be merged as properties.
var viewOptions = ['model', 'collection', 'el', 'id', 'attributes', 'className', 'tagName'];

// Set up all inheritable **Backbone.View** properties and methods.
_.extend(View.prototype, Events, {

  ...
  // Performs the initial configuration of a View with a set of options.
  // Keys with special meaning *(model, collection, id, className)*, are
  // attached directly to the view.
  _configure: function(options) {
    if (this.options) options = _.extend({}, this.options, options);
    for (var i = 0, l = viewOptions.length; i < l; i++) {
      var attr = viewOptions[i];
      if (options[attr]) this[attr] = options[attr];
    }
    this.options = options;
  },
  ... 
```

};

# jsf - 如何创建自定义 JSF 组件

> ID：10825260
> 
> 赞同：0
> 
> 时间：2012-05-30T22:37:37.503
> 
> 标签：jsf, jsf-2

我对 JSF 有基本的了解。我想创建一个类似于 PrimeFaces 的自定义图形图表。我需要有关如何使用 Ajax 完成此操作的信息。我的想法是创建一个图形图表，它每 5 秒在视觉上更新一次。你能给我一些关于这方面的信息吗？

# javascript - 如何更改此代码，使其仅在没有鼠标移动时重定向

> ID：10825263
> 
> 赞同：2
> 
> 时间：2012-05-30T22:37:42.187
> 
> 标签：javascript, javascript-events

我有以下 java 脚本，它将用户重定向到另一个网站（在这种情况下是谷歌）。

```
 <script type="text/JavaScript">
window.setTimeout("location=('http://www.google.com');",5000);
</script> 
```

但是，虽然我希望网站重定向到另一个网站，但我不希望它无缘无故地重定向。我的目标是让网站在光标没有移动一段时间的情况下自动重定向。

这可能吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-30T22:40:57.040

像这样的东西应该可以工作，尽管在旧的 MSIE 上你需要使用它们的等价物`addEventListener()`

```
var timer = null;

function goAway() {
    clearTimeout(timer);
    timer = setTimeout(function() {
        window.location = 'http://www.google.com/';
    }, 5000);
}

window.addEventListener('mousemove', goAway, true);

goAway();  // start the first timer off 
```

它所做的只是确保每次移动鼠标时都会清除计时器，然后重新启动。

[http://jsfiddle.net/alnitak/sXwHY/](http://jsfiddle.net/alnitak/sXwHY/)上的演示，尽管跨框架安全阻止它在那里正常工作。

# c++ - 获取刚刚推入矢量 C++ 的元素的位置

> ID：10825264
> 
> 赞同：2
> 
> 时间：2012-05-30T22:37:45.023
> 
> 标签：c++, vector

我很好奇推回向量是如何工作的。我想要一种方法来推回一个元素，然后能够将它在向量中的位置添加到作为一种地图类型的双精度数组中。

像这样的东西：

```
// Create a bomb
Bomb b;
b.currentTime = SDL_GetTicks();
b.explodeTime = SDL_GetTicks() + 3000;
b.owner = player;
b.power = 2;    
b.x = x;
b.y = y;

bombVec.push_back(b);

bombs[y][x] = THIS_IS_WHAT_I_WANT; 
```

这样当我引爆炸弹时，我可以查看地图，然后在向量中有一个 ID 来处理。每个非炸弹方块都会有一个-1。另外，只是好奇。想象一下，我在一个向量中有 3 个元素。我删除第二个，然后添加另一个。新元素是否与被删除的元素位于同一位置？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-30T22:40:09.630

在你之后`push_back`，你可以使用`back`来获取元素。

```
Bomb b;
...
bombVec.push_back(b);
Bomb &bref = bombVec.back(); 
```

还是你想要索引？

**强制警告：**如果你推入另一个项目，并且容量不够大，向量将被调整大小。如果访问引用，这将使引用无效并导致程序错误。这不是问题（1）通过索引访问（2）如果指针存储在`vector`（3）如果你使用`list`而不是（4）如果你不调整`vector`.

**获取索引：**

```
size_t index = bombVec.size();
bombVec.push_back(b); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T23:18:15.863

让我们从头开始：

> 另外，只是好奇。想象一下，我在一个向量中有 3 个元素。我删除第二个，然后添加另一个。新元素是否与被删除的元素位于同一位置？

删除在语言中具有精确的含义，在这种情况下没有意义，所以我假设您的意思是从容器中*删除。*当你从一个向量中*擦除*一个元素时，所有索引大于被擦除元素的元素都会被*移动*（或复制）以填充被擦除元素留下的空白空间。如果你`push_back`一个新元素，那个元素会被添加到容器的*后面*，所以它不会占据相同的位置。

另一种选择不是*擦除*原始元素，而是将新元素写入旧元素所在的位置：`v[ idx ] = new_value;`. 这将我们带到问题的第一部分：

> 我想要一种方法来推回一个元素，然后能够将它在向量中的位置添加到作为一种地图类型的双精度数组

使用向量作为底层容器的问题是容器上的任何变异操作都会使迭代器和对存储元素的引用无效。例如，`erase`上述内容将使迭代器和指向具有更大索引的所有元素的指针无效（从技术上讲，它根据标准使*所有迭代器无效，但实际上......）。*向容器中添加元素可能会更糟，因为如果向量需要增长，它实际上会使*所有迭代器/引用无效。*

一个常见的建议替代方法是保持元素位置的索引。虽然如果容器增长，索引是稳定的，但如果从容器中*删除*，它们将引用错误的位置，因此您需要小心操作方式。如果您可以设法不从向量中删除元素（例如添加一个标记，将炸弹标记为已删除但实际上并未将其从容器中删除），那么问题就会变得简单得多。

# windows-runtime - WinRT 控件模板项面板

> ID：10825265
> 
> 赞同：0
> 
> 时间：2012-05-30T22:37:45.400
> 
> 标签：windows-runtime, controltemplate, itemspanel

我是 WinRT 的新手，正在尝试创建一个标准的网格视图，它有一个组标题，下面有许多图块。那一点很容易。我正在尝试修改它，以便在瓷砖网格下方我还可以使用容器样式添加页脚：

```
 <GridView
        x:Name="itemGridView"
        AutomationProperties.AutomationId="ItemGridView"
        AutomationProperties.Name="Grouped Items"
        Margin="116,0,40,46"
        ItemsSource="{Binding Source={StaticResource groupedItemsViewSource}}"
        ItemTemplate="{StaticResource Project200x200ItemTemplate}"                
        SelectionMode="None"
        IsItemClickEnabled="True"
        ItemClick="ItemView_ItemClick">

        <GridView.ItemsPanel>
            <ItemsPanelTemplate>
                <VirtualizingStackPanel Orientation="Horizontal"/>
            </ItemsPanelTemplate>
        </GridView.ItemsPanel>

        <GridView.GroupStyle>
            <GroupStyle>
                <GroupStyle.HeaderTemplate>
                    <DataTemplate>
                        <Grid Margin="1,0,0,6">
                            <Button
                                AutomationProperties.Name="Group Title"
                                Content="{Binding Name}"
                                Click="Header_Click"
                                Style="{StaticResource TextButtonStyle}" 
                                FontWeight="{Binding IsSelected, ConverterParameter=FontWeight, Converter={StaticResource BooleanToFontWeightConverter}}"
                               />
                        </Grid>
                    </DataTemplate>
                </GroupStyle.HeaderTemplate>
                <GroupStyle.Panel>                           
                    <ItemsPanelTemplate>
                        <VariableSizedWrapGrid Background="Red"  Orientation="Vertical" Margin="0,0,40,0" />
                    </ItemsPanelTemplate>
                </GroupStyle.Panel>

                <GroupStyle.ContainerStyle>
                    <Style TargetType="GroupItem">
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate>
                                    <StackPanel>
                                        <ContentPresenter/>
                                        <ItemsPresenter/>
                                        <TextBlock Text="*** End of group ***"/>
                                    </StackPanel>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </Style>
                </GroupStyle.ContainerStyle>

            </GroupStyle>
        </GridView.GroupStyle>               
    </GridView> 
```

这几乎可以工作，但在添加容器样式后，瓷砖网格不再显示......组标题和“组结束”文本块正在显示，但我失去了瓷砖网格。

谁能发现我做错了什么......？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T09:22:32.590

你在做什么错？将 VirtualizingStackPanel 替换为其对应的 StackPanel，一切都会正常工作或在 Windows7 上移动（问题出现在 Vista 上）。顺便提一句。虚拟化不适用于使用分组 (GroupStyle) 的分层对象，如 TreeView 或 DataGrid。看看[这个](http://social.msdn.microsoft.com/forums/en-US/wpf/thread/18ea7bb0-3cd8-40bd-9276-ace4358b47cb/)。

# bash - 使用awk识别多行记录和过滤

> ID：10825272
> 
> 赞同：5
> 
> 时间：2012-05-30T22:38:12.440
> 
> 标签：bash, shell, awk

我需要处理一个包含多行记录的大数据文件，示例输入：

```
1  Name      Dan
1  Title     Professor
1  Address   aaa street
1  City      xxx city
1  State     yyy
1  Phone     123-456-7890
2  Name      Luke
2  Title     Professor
2  Address   bbb street
2  City      xxx city
3  Name      Tom
3  Title     Associate Professor
3  Like      Golf
4  Name
4  Title     Trainer
4  Likes     Running 
```

请注意，第一个整数字段是唯一的，并且真正标识了整条记录。所以在上面的输入中我确实有 4 条记录，虽然我不知道每条记录可能有多少行属性。我需要： - 识别有效记录（必须有“名称”和“标题”字段） - 输出每个有效记录的可用属性，例如“名称”、“标题”、“地址”是需要的字段。

示例输出：

```
1  Name      Dan
1  Title     Professor
1  Address   aaa street
2  Name      Luke
2  Title     Professor
2  Address   bbb street
3  Name      Tom
3  Title     Associate Professor 
```

所以在输出文件中，记录 4 被删除，因为它没有“名称”字段。记录 3 没有地址字段，但仍被打印到输出，因为它是具有“名称”和“标题”的有效记录。

我可以用 awk 做到这一点吗？但是我如何使用每行上的第一个“id”字段来识别整个记录？

非常感谢 unix shell 脚本专家帮助我！:)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-30T23:35:21.727

这似乎有效。有很多方法可以做到这一点，即使在 awk 中也是如此。

为了便于阅读，我已将其隔开。

请注意，记录 3 未显示，因为它缺少您确定为必需的“地址”字段。

```
#!/usr/bin/awk -f

BEGIN {
        # Set your required fields here...
        required["Name"]=1;
        required["Title"]=1;
        required["Address"]=1;

        # Count the required fields
        for (i in required) enough++;
}

# Note that this will run on the first record, but only to initialize variables
$1 != last1 {
        if (hits >= enough) {
                printf("%s",output);
        }
        last1=$1; output=""; hits=0;
}

# This appends the current line to a buffer, followed by the record separator (RS)
{ output=output $0 RS }

# Count the required fields; used to determine whether to print the buffer
required[$2] { hits++ }

END {
        # Print the final buffer, since we only print on the next record
        if (hits >= enough) {
                printf("%s",output);
        }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-30T23:13:28.220

我不擅长 awk，但我会在 Perl 中解决这个问题。这是一个 Perl 解决方案：对于每条记录，它都会记住重要的行以及是否看到了名称和标题。在记录的末尾，如果满足所有条件，则打印该记录。

```
#!/usr/bin/perl
use warnings;
use strict;

my ($last, $has_name, $has_title, @record);
while (<DATA>) {
    my ($id, $key, $value) = split;
    if ($id != $last and @record) {
        print @record if $has_name and $has_title;
        undef @record;
        undef $has_name;
        undef $has_title;
    }
    $has_name  = 1 if $key eq 'Name';
    $has_title = 1 if $key eq 'Title';
    push @record, $_ if grep $key eq $_, qw/Name Address Title/;
    $last = $id;
}

__DATA__
1  Name      Dan
1  Title     Professor
1  Address   aaa street
1  City      xxx city
1  State     yyy
1  Phone     123-456-7890
2  Name      Luke
2  Title     Professor
2  Address   bbb street
2  City      xxx city
3  Name      Tom
3  Title     Associate Professor
3  Like      Golf
4  Name
4  Title     Trainer
4  Likes     Running 
```

# python - 使用有限的信息编辑嵌套字典

> ID：10825273
> 
> 赞同：1
> 
> 时间：2012-05-30T22:38:15.403
> 
> 标签：python, dictionary

如果我不知道“albert”是驴还是斑马，我该如何改变他的“空间”？

```
self.object_attr = {'donkey': {
                              'name': 'roger', 'zone': 'forrest', 'space': [0, 0]}{
                              'name': 'albert', 'zone': 'forrest', 'space': [1, 1]}
                    'zebra': {
                              'name': 'pain', 'zone': 'forrest', 'space': [0, 0]}{
                              'name': 'alesha', 'zone': 'forrest', 'space': [1, 1]}}

print self.object_attr
for species in data.values():
    for animal in species:
        if animal['name'] == 'albert':
            animal['space'] = [50, 50]

#output      this is what object_attr is
{'donkey': {'roger': {'zone': 'forrest', 'space': [0, 0]}, 'albert': {'zone': 'forrest', 'space': [0, 0]}}}

#the error occurs on the "if animal['name'] == 'albert':" line
TypeError: string indices must be integers, not str 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T22:46:39.203

首先，您的数据似乎缺少一些标点符号。我对丢失的东西做了最好的猜测。

```
data = {'donkey': [{ 'name': 'roger', 'zone': 'forrest', 'space': [0, 0]}, { 'name': 'albert', 'zone': 'forrest', 'space': [1, 1]}],
      'zebra':  [{ 'name': 'roger', 'zone': 'forrest', 'space': [0, 0]}, {'name': 'albert', 'zone': 'forrest', 'space': [1, 1]}]
}

for v in data.values():
    [item.update({'space':[50, 50]}) for item in v if item['name'] == 'albert']

print data 
```

**输出**

```
{'donkey': [{'name': 'roger', 'space': [0, 0], 'zone': 'forrest'},
        {'name': 'albert', 'space': [50, 50], 'zone': 'forrest'}],
 'zebra': [{'name': 'roger', 'space': [0, 0], 'zone': 'forrest'},
       {'name': 'albert', 'space': [50, 50], 'zone': 'forrest'}]} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-30T22:54:28.747

**编辑：**根据您提供的输出，以下应该有效：

```
data = {'donkey': {'roger': {'zone': 'forrest', 'space': [0, 0]}, 
                   'albert': {'zone': 'forrest', 'space': [0, 0]}}}

for species in data.values():
    if 'albert' in species:
        species['albert']['space'] = [50, 50] 
```

原答案如下：

* * *

这是一个非常简单的方法：

```
data = {'donkey': [{'name': 'roger', 'zone': 'forrest', 'space': [0, 0]}, 
                   {'name': 'albert', 'zone': 'forrest', 'space': [1, 1]}],
        'zebra': [{'name': 'roger', 'zone': 'forrest', 'space': [0, 0]},
                  {'name': 'albert', 'zone': 'forrest', 'space': [1, 1]}]}

for species in data.values():
    for animal in species:
        if animal['name'] == 'albert':
            animal['space'] = [50, 50] 
```

或者使用等效的生成器表达式（更短但不清晰）：

```
for albert in (a for s in data.values() for a in s if a['name'] == 'albert'):
    albert['space'] = [50, 50] 
```

结果：

```
>>> pprint.pprint(data)
{'donkey': [{'name': 'roger', 'space': [0, 0], 'zone': 'forrest'},
            {'name': 'albert', 'space': [50, 50], 'zone': 'forrest'}],
 'zebra': [{'name': 'roger', 'space': [0, 0], 'zone': 'forrest'},
           {'name': 'albert', 'space': [50, 50], 'zone': 'forrest'}]} 
```

# android - Android 应用程序中的自定义标题菜单（操作方法）

> ID：10825274
> 
> 赞同：0
> 
> 时间：2012-05-30T22:38:19.393
> 
> 标签：android

我正在尝试在我的 Android 应用程序中实现自定义标题菜单（如站点导航），我想知道创建标题菜单的标准或最佳实践是什么？我正在考虑类似于 facebook 应用程序，它显示一个徽标并具有一些操作项，例如触发搜索并可能返回到主要活动。*这些也出现在我的应用程序顶部的每个活动中，而用户无需单击设备上的按钮*。

选项卡布局似乎不是我想要的。

我在[这里](http://www.londatiga.net/it/how-to-create-custom-window-title-in-android/)找到了一个可能与我正在寻找但不确定的教程接近的教程。在每个 Activity 中实例化一个菜单似乎有点多余。似乎有一种方法可以将 Activity 与菜单分离，或者至少更松散地耦合它。

也许我需要用 Fragments 实现一些东西，但我有点新，所以我还不确定。期待您的建议或听到您如何实施这样的事情。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T23:56:28.243

听起来您正在寻找[ActionBar 模式](http://developer.android.com/design/patterns/actionbar.html)。请参阅[这个老问题](https://stackoverflow.com/questions/6031774/what-is-the-equivalent-of-actionbar-in-earlier-sdk-versions)并自己进行谷歌搜索以了解更多信息。

# asp.net-mvc-3 - 如何在 MVC 3 URL Route 中获取 City State Zip 而无需为每个州和每个城市的操作编写控制器

> ID：10825279
> 
> 赞同：1
> 
> 时间：2012-05-30T22:38:48.173
> 
> 标签：asp.net-mvc-3, routes, url-mapping

我需要让我的老板应用程序中的网址看起来像：

```
http://domain.com/Texas/Dallas/72701 
```

但是，我不想为每个州编写一个控制器，为每个城市编写一个动作。

```
routes.MapRoute(
"DrillDown", // Route name
"{controller}/{action}/{ZipId}", 
new { controller = "State", action = "City", ZipId = UrlParameter.Optional} // Parameter     defaults 
```

有人可以帮我为接受 State/City/Zip 的路线编写一个模式，而不会破坏我使用 controller/Action/Param 拥有常规路线的能力吗？

环顾四周，找不到任何方向。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T23:06:55.963

如果您能够在域路径中再添加一个路径段，则可以很容易地使其工作

```
routes.MapRoute(
"DrillDown", // Route name
"Location/{State}/{City}/{ZipId}", 
new { controller = "Location",
      action = "DrillDownAction", 
      State= UrlParameter.Optional, 
      City = UrlParameter.Optional,
      ZipId = UrlParameter.Optional
} 
```

这将为您提供以下形式的网址：http: [//www.domain.com/Location/](http://www.domain.com/Location/) {State}/{City}/{ZipId}

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T22:59:18.263

这可以通过为每个状态添加路由来实现：

```
routes.MapRoute( 
"TexasDrillDown", // Route name 
"Texas/{City}/{ZipId}",  
new { controller = "DrillDownController", action = "DrillDownAction", ZipId = UrlParameter.Optional}); 
```

但是，如果您的其他控制器比状态少，您可能更愿意将 DrillDown 设置为默认路由并手动映射其他控制器，如下所示：

```
routes.MapRoute( 
"Users", // Route name 
"Users/{action}/{id}",  
new { controller = "Users", id= UrlParameter.Optional});

routes.MapRoute( 
"DrillDown", // Route name 
"{State}/{City}/{ZipId}",  
new { controller = "DrillDownController", action = "DrillDownAction", ZipId = UrlParameter.Optional}); 
```

# ruby-on-rails - 使用带有回形针的 VCR 时测试失败

> ID：10825283
> 
> 赞同：0
> 
> 时间：2012-05-30T22:39:24.550
> 
> 标签：ruby-on-rails, rspec, paperclip, vcr

我有一个测试，第一次有效并通过，但第二次运行规范套件时失败：

```
 VCR.use_cassette("master_image_create_2", :match_requests_on => [:method, :uri]) do
      mi = Factory.build(:master_asset)
      img = File.new( File.join(Rails.root, "spec", "support", "fonzi.jpg") )
      mi.image = img
      mi.valid?
      mi.sha.should eql("f70393ee4d6e1f6a735df9526694e038371e5b3c")
      mi.url.to_s.include?("http://domain.com/test-brand/original-test-product_f_test-color-1_test-color-2_test-color-3.jpg").should be_true
    end 
```

该类`MasterAsset`使用回形针（要求）将正在处理的图像上传到 S3。

我回来的错误是：

```
AWS::Errors::Base:
 # (eval):3:in `head_object' 
```

这是回形针和 aws-s3 之间的接口错误。

我一直在排除故障，现在用谷歌搜索了几个小时。看起来这应该是一个非常普遍的情况，但我似乎无法让测试再次通过。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T06:15:30.647

这可能是 VCR 或 VCR 连接的底层库（例如 WebMock）中的一个错误。

你能[在 github 上提出问题](https://github.com/myronmarston/vcr/issues)吗？我很乐意看看。不过，我需要更多细节：

*   您的错误的完整回溯
*   VCR 配置的代码片段
*   一个小的、孤立的可执行示例演示该错误会很好。

# java - 有没有办法使用 EasyMock 部分模拟对象？

> ID：10825284
> 
> 赞同：14
> 
> 时间：2012-05-30T22:39:34.307
> 
> 标签：java, testing, mocking, easymock

例如，假设我有这个类：

```
public class Foo Implements Fooable {
  public void a() {
    // does some stuff
    bar = b();
    // moar coadz
  }
  public Bar b() {
    // blah
  }
  // ...
} 
```

我想测试一下`Foo.a`。我想模拟`Foo.b`，因为我正在单独测试该方法。我想象的是这样的：

```
public class FooTest extends TestCase {
  public void testA() {
    Fooable foo = createPartialMock(
      Fooable.class,  // like with createMock
      Foo  // class where non-mocked method implementations live
    );

    // Foo's implementation of b is not used.
    // Rather, it is replaced with a dummy implementation
    // that records calls that are supposed to be made;
    // and returns a hard coded value (i.e. new Bar()).
    expect(foo.b()).andReturn(new Bar());

    // The rest is the same as with createMock:
    //   1\. Stop recording expected calls.
    //   2\. Run code under test.
    //   3\. Verify that recorded calls were made.
    replay(foo);
    foo.a();
    verify(foo);
  }
} 
```

我知道我可以编写自己的`Foo`子类来为我做这种事情。但如果我不必这样做，我不想这样做，因为它很乏味，即应该自动化。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-05T08:24:45.773

在 EasyMock 3.0+ 中，您可以使用[mockbuilder创建 Partial mock](http://www.easymock.org/api/easymock/3.0/org/easymock/IMockBuilder.html "IMockBuilder 接口")

```
EasyMock.createMockBuilder(class).addMockedMethod("MethodName").createMock(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-30T22:46:46.413

我想你可以使用 EasyMock 扩展库来做到这一点。您可以在此[部分模拟中找到一个简单的示例](http://teja.tejakantamneni.com/2008/09/partial-mocking-of-objects-using.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-05T15:21:49.833

OP 似乎（？）暗示子类化比部分模拟更困难或更乏味。我建议值得重新考虑。

例如，在测试类中：

```
 Foo dummyFoo = new Foo() {
      @Override public Bar b() { return new Bar(); }
   }; 
```

与使用 EasyMock 相比，执行 OP 声明的操作，似乎更简单，并且不太容易出现其他问题（忘记重播/验证/等）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-31T02:15:58.320

我会找到一种升级到 JUnit 4 并使用类扩展的方法。（实际上，我会使用 Mockito 而不是 EasyMock，但我们不要重写你的整个测试套件。）如果你不能，那么你总是可以这样创建自己的间谍：

```
public class FooTest extends TestCase {
    public static class FooSpy extends Foo {
        private final Fooable mockFoo;

        FooSpy(Fooable mockFoo) {
            this.mockFoo = mockFoo;
        }

        public Bar b() {
            return mockFoo.b();
        }
    }

    public void testA() {
        Fooable mockFoo = createMock(Foo.class);
        Fooable fooSpy = new FooSpy(mockFoo);

        // Foo's implementation of b is not used.
        // Rather, it is replaced with a dummy implementation
        // that records calls that are supposed to be made;
        // and returns a hard coded value (i.e. new Bar()).
        expect(mockFoo.b()).andReturn(new Bar());

        // The rest is the same as with createMock:
        // 1\. Stop recording expected calls.
        // 2\. Run code under test.
        // 3\. Verify that recorded calls were made.
        replay(mockFoo);
        foo.a();
        verify(foo);
    }

} 
```

# javascript - 查找json元素的索引号

> ID：10825285
> 
> 赞同：1
> 
> 时间：2012-05-30T22:39:41.747
> 
> 标签：javascript, json

假设我被提供了一个看起来像这样的 json 对象：

```
{"someList": [{"id": "21154859" },{"id": "21154865" },{"id": "21154856" },{"id": "21154870" }]} 
```

我想找出我所在的当前“someList”项目的索引号。我有 someList 项目 ID，它由 varaid 表示，等于：21154856。

我创建了一个这样的函数：

```
$.getJSON( url, function( data ) {
var jsonLength = data.someList.length;
for ( i=1; i <= jsonLength; i++ ){
        chx = data.someList[i].id;
        if(chx === aid){
            var currentidno = Number(i) + 1;
            $('#page').html('').append(currentidno + ' of ' + jsonLength);
            break;
        }
        }
}); 
```

当我设置它时，它工作正常并给我这样的结果：3 of 4

但感觉效率低下，我想知道如果有数千种可能性它会如何执行。有人可以权衡这是否是实现我想要做的事情的最佳方式，并验证或否认这是完成任务的好方法的假设吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-04-14T16:28:31.333

你可以试试这个：

```
jQuery(someList).index({"id": "21154859" }); 
```

其中 someList 是 JSON 数组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T22:46:47.223

不，循环只是要走的路。但是，如果您需要经常在许多元素上进行搜索，那么构建索引可能会很有效（或者如果没有其他属性，则一次将 JSON 作为数字数组提供）：

```
var indexArray = data.someList.map(function(o){return o.id;});
var currentidno = indexArray.indexOf(aid) + 1; 
```

或者您可以通过对象属性而不是数组进行索引：

```
someValues = {"21154859":{index:0},"21154865":{index:1},"21154856":{index:2},"21154870":{index:3},... }; 
// no order needed!
var currentidno = someValues[aid].index + 1; 
```

# magento - Magento 全页缓存和设计异常

> ID：10825287
> 
> 赞同：0
> 
> 时间：2012-05-30T22:39:53.963
> 
> 标签：magento

我们有一个针对移动设备的设计例外，它加载了不同的 JS、布局、CSS 和图像文件。

关闭 FPC，它可以完美运行。但是，当它打开时，每个人都会获得常规站点（没有例外）。

我认为这是由于`head.phtml`被缓存。

从 FPC 中排除 head.phtml 是要走的路吗？还是有别的东西在起作用？

如果是先验，最好的方法是什么？创建一个自定义模块`cache.xml`，并从 ? 模仿 cache.xml `Enterprise/PageCache`？

这是 Magento EE 1.11。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T01:41:29.523

如果可以避免，请不要绕过任何块的缓存。它将改善您在日志运行中的用户体验。但是，有几种方法可以解决这个问题。

我在[这里](http://mikebywaters.wordpress.com/2011/12/14/disable-magento-full-page-cache-on-a-per-controller-basis/)写过关于基于每个控制器禁用缓存的博客。您目前可能会使用相同的方法，除非使用不同的“如果”条件。

我在哪里检查：

```
if ($action instanceof <controller_class_name>) { 
```

你可以很容易地使用：

```
if ($user_is_mobile == true) { 
```

这样做只会让您的移动用户同时工作。实际上，答案不是禁用或绕过缓存，而是使用相同的方法来监听页面请求并为移动和非移动请求分配不同的布局句柄。然后每个布局句柄将相应地缓存。

查看您如何在布局更新中使用句柄。从记忆中它是这样的：

```
Mage::app()->getLayout()->getUpdate()->addHandle("mobile"); 
```

然后在您的 page.xml 中，添加一个名为 mobile 的新节点，如下所示

```
<mobile>
    <reference name="root">
        <remove name="mainHead" />
        <block type="core/template" name="mobileHead" />
    </reference>
</mobile> 
```

或类似的规定。这是未经测试的疯狂，但我希望你明白这一点。

否则，您可以根据屏幕分辨率考虑使用响应式 css。

# python - 在 callgrind 中停止检测

> ID：10825288
> 
> 赞同：0
> 
> 时间：2012-05-30T22:39:54.060
> 
> 标签：python, linux, valgrind, instrumentation, callgrind

我正在生成多个进程并在每个进程中启动检测。当我试图在进程退出之前停止检测时，检测程序似乎挂在 shell 中，好像进程已经完成并且它没有停止检测的进程。这是代码：

```
from os import system,fork,getpid
from glob import glob
from sys import exit

for filename in glob("py/*.py"):
  f=fork()
  if f==0:
    system("callgrind_control --instr=on "+str(getpid()))
    execfile(filename,{})
    system("callgrind_control --instr=off "+str(getpid()))
    exit() 
```

如何解决悬挂问题？我真的需要停止仪器吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T06:09:01.277

我通过使用而不是, 和参数解决了`callgrind_control`悬挂问题`call``system``shell=True`

```
from os import system,fork,getpid
from glob import glob
from subprocess import call
from multiprocessing import Process

def caller(filename):
  pid=getpid()
  call(["callgrind_control","--instr=on",str(pid)],shell=True)
  execfile(filename,{})
  call(["callgrind_control","--instr=off",str(pid)],shell=True)

for filename in glob("py/*.py"):
  p=Process(target=caller,args=(filename,))
  p.start()
  p.join() 
```

# java - 在没有线程的情况下停止程序

> ID：10825289
> 
> 赞同：0
> 
> 时间：2012-05-30T22:39:56.640
> 
> 标签：java, for-loop, sleep, thread-sleep

我正在制作这个视频游戏，里面有一堆在屏幕上跑来跑去的怪物。问题是怪物有时会经过一个区域（超过 y 坐标）并且必须一直回到顶部。我收到了一项建议，让这种从底部到顶部的传输延迟随机时间（0、1、2 或 3 秒）。现在，它只是上升到顶部，没有任何中断。我的问题是实施这个休息。我尝试了各种方法，例如用循环停止，如下所示

```
 // if( monster is below 400 on y-axis
        if( sbgBackFootY[ i ] >= 400 ) {
            // random number that determines how long it will take to go to top
            int randCo = ( int ) ( Math.random() * 3 );

            if( randCo == 0 ) {
                //moves monster to top
                sbgHeadX[ i ] = 200;
                sbgHeadY[ i ] = 80;
                sbgMouthX[ i ] = 206;
                sbgMouthY[ i ] = 110;
                sbgBackX[ i ] = 190;
                sbgBackY[ i ] = 95;
                sbgBackFootX[ i ] = 190;
                sbgBackFootY[ i ] = 115;
                sbgFrontFootX[ i ] = 197;
                sbgFrontFootY[ i ] = 115;
                sbgLeftEyeX[ i ] = 205;
                sbgLeftEyeY[ i ] = 90;
                sbgRightEyeX[ i ] = 215;
                sbgRightEyeY[ i ] = 90;
                sbgLeftEyebrowStartX[ i ] = 203;
                sbgLeftEyebrowStartY[ i ] = 83;
                sbgLeftEyebrowEndX[ i ] = 210;
                sbgLeftEyebrowEndY[ i ] = 90;
                sbgRightEyebrowStartX[ i ] = 220;
                sbgRightEyebrowStartY[ i ] = 83;
                sbgRightEyebrowEndX[ i ] = 215;
                sbgRightEyebrowEndY[ i ] = 90;

            }

            if( randCo == 1 ) {
                //loop is supposed to stall program 
                for( int w = 0; w <= 1000000000; w++ ){
                    SBGco[ i ]++;
                }

                if( SBGco[ i ] == 1000000000 ) {
                    //moves monster to top
                    sbgHeadX[ i ] = 200;
                    sbgHeadY[ i ] = 80;
                    sbgMouthX[ i ] = 206;
                    sbgMouthY[ i ] = 110;
                    sbgBackX[ i ] = 190;
                    sbgBackY[ i ] = 95;
                    sbgBackFootX[ i ] = 190;
                    sbgBackFootY[ i ] = 115;
                    sbgFrontFootX[ i ] = 197;
                    sbgFrontFootY[ i ] = 115;
                    sbgLeftEyeX[ i ] = 205;
                    sbgLeftEyeY[ i ] = 90;
                    sbgRightEyeX[ i ] = 215;
                    sbgRightEyeY[ i ] = 90;
                    sbgLeftEyebrowStartX[ i ] = 203;
                    sbgLeftEyebrowStartY[ i ] = 83;
                    sbgLeftEyebrowEndX[ i ] = 210;
                    sbgLeftEyebrowEndY[ i ] = 90;
                    sbgRightEyebrowStartX[ i ] = 220;
                    sbgRightEyebrowStartY[ i ] = 83;
                    sbgRightEyebrowEndX[ i ] = 215;
                    sbgRightEyebrowEndY[ i ] = 90;

                }
            } 
```

但是计算机计算得太快了，所以 w 变量变得 1000000000 太快了。另一种方法是创建线程并使用 Thread.sleep(randCo) 或其他方法，但我试图不使用多线程。我还有其他方法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T22:43:34.563

我认为 Thread.sleep(..) 是你最好的选择。如果你有一个线程并且你让它进入睡眠状态并不意味着你有多线程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T22:46:27.133

您最好预先计算精灵的路径，然后为其分配速度。然后，在“绘制”步骤中，根据精灵的路径、速度和时间计算位置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T22:50:36.563

你为什么不记录他离开屏幕的时间，然后在他重新出现在屏幕上时将他放回去：

```
int initTime= 0;
int elapsedTimeOffScreen = 0

if( sbgBackFootY[ i ] >= 400 ) {
if(initTime!= 0)
   initTime= DateTime.Now;
elapsedTimeOfScreen  = DateTime.Now - initTime;

if(elapsedTimeOffscreen > 1000)
{
  initTime = 0
  elapsedTimeOffScreen = 0;
 //go back on screen
} 
```

每次角色都会重置 initTime 这将使用时间来检查角色离开屏幕的时间。它肯定比使用 cpu 周期可靠得多。

# jquery - Jquery Validation - 多次验证隐藏区域中的字段

> ID：10825290
> 
> 赞同：0
> 
> 时间：2012-05-30T22:40:01.140
> 
> 标签：jquery, jquery-validate

我正在尝试在表单上添加一些验证以添加联系人，但我似乎无法做到这一点。当您加载页面时，我的表单是隐藏的（使用 CSS），您必须单击“添加联系人”按钮才能使其显示。然后您会看到一个简单的表单，您可以在其中输入名字（必填）、姓氏和电子邮件地址（必填和电子邮件验证）。完成后，单击“添加”，Jquery 将对后端进行 Ajax 调用以在数据库中添加新联系人，并将刷新视图以显示新创建的联系人并隐藏表单。当您添加第一个联系人时，它可以正常工作，但是如果您在未验证名字后立即尝试添加其他联系人（如果您重新加载页面则有效）。我真的不明白为什么会这样，

这是我的javascript：

```
$(document).ready(function() {
  //get values //
  var service_name_value = $("#tbl-existing_emails tfoot tr td input[type='hidden']").val();

    /*****************  email management  ******************************/

        //add recipient function
        //triggered when user clicks on add recipient button
        //shows the form to enter the information for the new recipient+
        $('#btn-show_report_add').live("click" ,function(e) {

            if ($('#box-report').is(':visible')) {
                return false;
            }
            if (total_existing_emails < 3) {
                $('#box-report').show();
            }
            else {
                alert("You can have up to 3 extra emails");
            }
        });

        //hides the form to enter information for a new recipient
         $('#box-report button.cancel').click(function() {
             hideEmailForm();
        });

        //adds the email reicpient in DB
        $('#btn-report_add').click(function(e) {
            e.preventDefault();
            // Validate new email form
            $("#weeklyReportsForm").validate({
                debug : true,
                rules : {
                    fld_report_first_name : {
                        required: true
                    },
                    fld_report_email : {
                        required : true,
                        email : true
                    }
                }
            });

            if ($('#weeklyReportsForm').valid() ) { // New email data

                var new_recipient = {first  : $('#fld_report_first_name').val(),
                                 last : $('#fld_report_last_name').val(),
                                 email : $('#fld_report_email').val(),
                                 service_name : service_name_value
                };

                $.getJSON('/account/email-preferences/add-email', new_recipient, function(data) {
                    if(data.email == "fail"){
                        alert("It seems that the email you entered is incorrect.");
                    }
                    else if (data.status) {
                        addEmailRow(new_recipient.first, new_recipient.last, new_recipient.email, data.id);
                    }
                    else {
                        alert("Oops, we couldn't add this email.");
                    }
                });         
            }
        });

//////////// helper functions ////////////////
    function addEmailRow(first, last, email, id) {

        var new_row = '<tr data-id="'+id+'">';
        if (!id) {
            new_row += '<td>'+first+'<input type="hidden" name="recipients['+total_existing_emails+'][first]" value="'+name+'"/></td>';
            new_row += '<td>'+last+'<input type="hidden" name="recipients['+total_existing_emails+'][last]" value="'+last+'"/></td>';                       
            new_row += '<td>'+email+'<input type="hidden" name="recipients['+total_existing_emails+'][email]" value="'+email+'"/></td>';
        }
        else {
            new_row += '<td>'+first+'</td>';
            new_row += '<td>'+last+'</td>';
            new_row += '<td>'+email+'</td>';
        }
        new_row += '<td><button type="button" class="button cancel"><span class="icon"></span><span>Remove</span></button></td>';
        new_row += '</tr>';
        $('#tbl-existing_emails tbody').append(new_row);
        $('#row-nodata').remove();
        total_existing_emails++;
        hideEmailForm();
    } 
```

});

这是相关表格的 HTML：

```
<table id="tbl-existing_emails" style="width:680px;">
  <thead>
    <tr>
                                        <th>First Name</th>
                                        <th>Last Name</th>
                                        <th>Email</th>
                                        <th></th>
                                        </tr>
                                    </thead>
                                    <tfoot>
                                        <tr>
                                        <td colspan="4">
                                            <button type="button" class="button add" id="btn-show_report_add" name="btn-show_report_add"><span class="icon"></span><span>Add Recipient</span></button>

                                            <div id="box-report" class="toggle">

                                                    <div class="row required">
                                                        <label for="fld_report_first_name">First Name</label>
                                                        <input type="text" name="fld_report_first_name" id="fld_report_first_name" value="{$REPORTRECIPIENT.first_name}" title="Enter the first name of a new recipient for this email.<br/><br/><em>Required</em><br/>Max 255 characters" />
                                                    </div>

                                                    <div class="row">
                                                        <label for="fld_report_last_name">Last Name</label>
                                                        <input type="text" name="fld_report_last_name" id="fld_report_last_name" value="{$REPORTRECIPIENT.last_name}" title="Enter the last name of a new recipient for this email.<br/><br/><em>Recommended</em><br/>Max 255 characters" />
                                                    </div>

                                                    <div class="row required">
                                                        <label for="fld_report_email">Email</label>
                                                        <input type="text" name="fld_report_email" id="fld_report_email" value="{$REPORTRECIPIENT.email}" title="Enter the new email address where this new recipient should receives this email.<br/><br/><em>Required</em><br/>Must be a properly formatted email address (e.g. psmith@homebuilder.com)"/>
                                                    </div>

                                                    <input type="hidden" id="fld_report_service_name" name="fld_report_service_name" value="WeeklyReport"/>

                                                    <div class="clear"></div>

                                                    <button class="button add" id="btn-report_add" name="btn-report_add" type="button"><span class="icon"></span><span>Add</span></button>
                                                    <button type="button" class="button cancel" name="btn_cancel"><span class="icon"></span><span>Cancel</span></button>

                                            </div>

                                        </td>
                                        </tr>
                                    </tfoot>
                                    <tbody>
                                        {foreach from=$REPORTRECIPIENTS item="REPORTRECIPIENT"}
                                        <tr data-id="{$REPORTRECIPIENT.id}" class="row box-existing_agent">
                                          <td>{$REPORTRECIPIENT.first}</td>
                                          <td>
                                            {$REPORTRECIPIENT.last}
                                          </td>
                                          <td><a href="mailto:{$REPORTRECIPIENT.email}">{$REPORTRECIPIENT.email}</a></td>
                                          <td>
                                            <button type="button" class="button cancel" name="btn_enail_cancel"><span class="icon"></span><span>Remove</span></button>
                                          </td>
                                        </tr>
                                        {foreachelse}
                                          <tr id="row-nodata">
                                            <td colspan="4">No recipients are associated with this email.</td>
                                          </tr>
                                        {/foreach}
                                    </tbody>
                                </table> 
```

我真的不再去哪里看，任何帮助将不胜感激！

谢谢，

最大限度

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T23:04:17.040

它无法正常工作，因为您已将`.validate()`函数包装在`click`处理程序中。这意味着验证仅在单击后才初始化，此时它应该在加载页面时进行初始化。

```
$('#btn-report_add').click(function(e) {
        e.preventDefault();
        // Validate new email form
        $("#weeklyReportsForm").validate({ // <- this only initializes validation after the click
        ... 
```

相反，这更像是应该如何完成（参见[官方演示](http://jquery.bassistance.de/validate/demo/)的源代码）......

立即在表单上初始化验证插件：

```
 $("#weeklyReportsForm").validate({

     // validation rules and options

     submitHandler: function(form) {
         // optional- stuff to do upon form submission
     }
 ...

 }); 
```

将您的表单绑定`submit`到您的元素的点击：

```
 $('#btn-report_add').click(function(e) {

        e.preventDefault();

        // your other logic for click

        $("#weeklyReportsForm").submit();

 }); 
```

请参阅：[如何在提交表单后让我的 jQuery 验证器代码再次运行？](https://stackoverflow.com/questions/10609567/how-do-i-get-my-jquery-validator-code-to-run-a-second-time-after-a-form-has-alre/10609871#10609871)

# c# - Visual C# 2010 命令行参数到 csc

> ID：10825291
> 
> 赞同：2
> 
> 时间：2012-05-30T22:40:04.997
> 
> 标签：c#, visual-studio-2010, command-line, csc

在 Visual C++ 2010 中，我可以看到传递给 cl.exe 的参数：

![在此处输入图像描述](../Images/89d391be67a1ec98f47019e5fecc220a.png)

这非常有用，因为有时您忘记检查这个或那个选项，在这里和那里添加一些目录等等，并且一次查看所有命令使得这很容易发现。

我想知道 Visual C# 2010 是否有类似的东西。我在任何地方都看不到“命令行”选项卡。显然，早期版本在“输出”>“构建”选项卡中显示了“任务：csc”行，但我在 Visual C# 2010 SP1 生成的输出中没有找到类似的内容。

是否有可能获得我正在寻找的东西？

注意我知道我可以从 MSBuild 获取参数，但不幸的是，由于依赖项解析失败，MSBuild 无法构建我的一些解决方案。我正在寻找一个纯 Visual Studio IDE 解决方案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-30T22:46:40.907

单击**工具**并选择**选项**。展开**Project and Solutions**组并单击**Build and Run**。对于项目**MSBuild 项目输出详细程度**，至少选择**Normal**（默认为**Minimal**）。

现在在输出窗口中，您将看到 MSBuild 执行的（主要）步骤和`csc`进程的命令行。

# linq - ASP.Net MVC 从具有不同值的数据库中填充下拉列表

> ID：10825293
> 
> 赞同：1
> 
> 时间：2012-05-30T22:40:10.830
> 
> 标签：linq, entity-framework

我对这个 MVC 框架非常陌生，并试图找出一个非常简单的操作 - 从数据库中填充下拉列表。我设法从数据库中获取了一个值列表，但由于某种原因无法获得一个不同的列表。这是我的示例代码

```
public class HomeController : Controller
{
    private PlanContext _context = new PlanContext();
    public ActionResult Index()
    {
        var query = _context.Categories.Select(m => new { m.ID }).Distinct();
        ViewBag.CategoryID = new SelectList(query.AsEnumerable(), "ID", "ID");
        return View();
    }
}

<asp:Content ID="Content2" ContentPlaceHolderID="MainContent" runat="server">
<p>
    Select a Category:<%= Html.DropDownList("ID", (SelectList) ViewBag.CategoryID, "---Select One---") %>
</p>
</asp:Content>

public class PlanContext : DbContext
{
    public DbSet<Category> Categories { get; set; }
}

[Table("vCategory")]
public class Category : IEquatable<Category>
{
    [Column("CategoryID")]
    public int ID { get; set; }

    public bool Equals(Category other)
    {
        //Check whether the compared object is null.
        if (Object.ReferenceEquals(other, null)) return false;

        //Check whether the compared object references the same data.
        if (Object.ReferenceEquals(this, other)) return true;

        return ID == other.ID;
    }

    public override int GetHashCode()
    {
        return ID.GetHashCode();
    }
} 
```

我的下拉菜单总是有多个具有相同 ID 值的项目。该表确实有重复的值，但我试图用 Distinct 填充 DDL。

谢谢你的帮助。

贾维德

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T23:09:52.310

在代码中，您显示的实体框架通过命名约定假定`ID`为类的（主要）关键属性`Category`。因为键必须是唯一的，所以 EF 不会将`Distinct()`LINQ 中的 a 转换为`SELECT DISTINCT`SQL 中的 a，因为表中的所有键值都必须不同。申请`SELECT DISTINCT`将是多余的。

但是，如果您的`ID`列实际上不是唯一的，则它不能是主键，并且您的模型和数据库之间的映射不正确。您应该彻底检查映射。

如果表有另一列是主键，则应在模型中引入相应的属性并将此属性设为键属性（使用数据注释或 Fluent API）。

如果您要映射到“旧版”数据库，并且由于某种原因该表根本没有主键，那么我相信，您根本无法使用 EF 在表和模型类之间创建映射，因为每个映射的类都需要key 属性，对应于数据库表中的主键。您最好的解决方法可能是通过使用直接 SQL ( `SELECT DISTINCT`) 来查询此（未映射的）表来加载不同的类别 ID。

# rest - 移动远程数据加载：懒惰 vs 急切

> ID：10825296
> 
> 赞同：1
> 
> 时间：2012-05-30T22:40:17.097
> 
> 标签：rest, mobile, lazy-loading

我正在开发几个移动应用程序。这些应用程序很复杂，包含许多数据层次结构。

加载远程数据的最佳方式是什么？我应该从层次结构的顶部一直向下加载一组全面的数据吗？这将导致应用程序第一次加载需要很长时间，但在整个应用程序会话的其余部分中速度会快得多，因为在那之后数据会被缓存。

我应该延迟加载远程数据以仅在用户单击行或组件时加载我需要的内容吗？这会导致应用程序在每次点击时加载速度变慢，但会减少大量数据的初始加载。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T12:51:28.043

两个我都见过。我最近的尝试，yoga，在这个问题上是创建一个更灵活的服务器端，允许单个 URL 返回屏幕所需的确切信息。这是LinkedIn不久前所做的事情的起飞。目前，它纯粹是一个 Java 解决方案，但基础可以转移到其他平台：[https ://github.com/skyscreamer/yoga](https://github.com/skyscreamer/yoga)

# python - Python——Python路径

> ID：10825298
> 
> 赞同：1
> 
> 时间：2012-05-30T22:40:23.180
> 
> 标签：python, pythonpath, ubuntu-12.04

我在 ubuntu 12.04 的主目录中创建了一个文件夹，并将所有 python 文件存储在那里。我也将我的目录的路径添加到了 pythonpath 变量。但它不起作用。较早的文件在主目录中时被执行，但现在它们也没有被执行。

在 Ubuntu 终端 manish@manish-laptop:~$ echo $PYTHONPATH /home/manish/project:

```
manish@manish-laptop:~$ ls -l /home/manish/project
total 24
-rw-rw-r-- 1 manish manish  140 May 31 00:07 Connection.py
-rw-rw-r-- 1 manish manish  122 May 29 11:29 Connection.py~
-rw-rw-r-- 1 manish manish 7150 May 31 00:07 Host.py
-rw-rw-r-- 1 manish manish 7132 May 30 23:30 Host.py~ 
```

`

从终端执行：

```
>>> import sys
>>> sys.path
['', '/home/manish/project', '/home/manish', '/usr/lib/python2.7', '/usr/lib/python2.7/plat-linux2', '/usr/lib/python2.7/lib-tk', '/usr/lib/python2.7/lib-old', '/usr/lib/python2.7/lib-dynload', '/usr/local/lib/python2.7/dist-packages', '/usr/lib/python2.7/dist-packages', '/usr/lib/python2.7/dist-packages/PIL', '/usr/lib/python2.7/dist-packages/gst-0.10', '/usr/lib/python2.7/dist-packages/gtk-2.0', '/usr/lib/pymodules/python2.7', '/usr/lib/python2.7/dist-packages/ubuntu-sso-client', '/usr/lib/python2.7/dist-packages/ubuntuone-client', '/usr/lib/python2.7/dist-packages/ubuntuone-control-panel', '/usr/lib/python2.7/dist-packages/ubuntuone-couch', '/usr/lib/python2.7/dist-packages/ubuntuone-installer', '/usr/lib/python2.7/dist-packages/ubuntuone-storage-protocol', '/usr/lib/python2.7/dist-packages/wx-2.8-gtk2-unicode'] 
```

从 IDLE 执行：

```
>>> import sys
>>> sys.path
['/usr/bin', '/home/manish/project', '/home/manish', '/usr/lib/python2.7', '/usr/lib/python2.7/plat-linux2', '/usr/lib/python2.7/lib-tk', '/usr/lib/python2.7/lib-old', '/usr/lib/python2.7/lib-dynload', '/usr/local/lib/python2.7/dist-packages', '/usr/lib/python2.7/dist-packages', '/usr/lib/python2.7/dist-packages/PIL', '/usr/lib/python2.7/dist-packages/gst-0.10', '/usr/lib/python2.7/dist-packages/gtk-2.0', '/usr/lib/pymodules/python2.7', '/usr/lib/python2.7/dist-packages/ubuntu-sso-client', '/usr/lib/python2.7/dist-packages/ubuntuone-client', '/usr/lib/python2.7/dist-packages/ubuntuone-control-panel', '/usr/lib/python2.7/dist-packages/ubuntuone-couch', '/usr/lib/python2.7/dist-packages/ubuntuone-installer', '/usr/lib/python2.7/dist-packages/ubuntuone-storage-protocol', '/usr/lib/python2.7/dist-packages/wx-2.8-gtk2-unicode'] 
```

在 Ubuntu 终端中：

```
>>> import Host
>>> obj = Host()
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: 'module' object is not callable 
```

而Host是包含函数的python文件，我想运行host文件中的一些函数，这就是我试图创建一个对象的原因。它包含一个类，类名与文件名相同。

我还使用 chmod 命令授予对文件的执行权限。

如果我使用 cd 命令更改文件夹“项目”的路径，文件会执行。这就是我所做的

```
 manish@manish-laptop:~$ cd project
  manish@manish-laptop:~/project$ python
  Python 2.7.3 (default, Apr 20 2012, 22:44:07) 
  [GCC 4.6.3] on linux2
  Type "help", "copyright", "credits" or "license" for more information.
  >>> execfile('Host.py')
  >>> obj = Host()
  >>> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T05:16:00.163

由于`import Host`没有给出错误，因此可以很好地定位、识别和导入文件 -**您的 PYTHONPATH 没有任何问题**。问题是您错误地使用了导入的模块。

如果你这样做`import Host`，你没有导入到*全局命名空间*，你正在创建一个`Host`命名空间，其中包含来自 Host.py 文件的所有名称。因此，如果文件 Host.py 包含一个名为 的类`Host`，或一个名为 的函数`some_function`，或一个名为 的全局变量`SOME_GLOBAL`，那么您访问它们的方式是：

```
>>> import Host
>>> obj = Host.Host()
>>> result = Host.some_function(1)
>>> x = Host.SOME_GLOBAL 
```

那样有用吗？

您收到该`'module' object is not callable`错误的原因是在此导入样式中，`Host`是*模块*的名称，即与整个 Host.py 文件对应的对象 -*而不是*Host.py 文件中的`Host`类的名称。类的名称`Host`是`Host.Host`。请注意，这意味着您可以将多个类/函数/等放在一个文件中，并且可以将它们命名为您想要的任何名称，它们不必以任何方式与文件名匹配。

或者，如果您想`Host`引用类而不是模块，则可以仅将 Host.py 文件中的特定名称直接导入全局命名空间，如下所示：

```
>>> from Host import Host, some_function, SOME_GLOBAL
>>> obj = Host()
>>> result = some_function(1)
>>> x = SOME_GLOBAL 
```

或者，如果您想从全局命名空间中的 Host.py 中获取*所有*名称，您可以这样做——但这通常不是一个好主意，因为您可能不小心覆盖了一些现有变量：

```
>>> from Host import *
>>> obj = Host()
>>> # etc 
```

**有关导入样式之间差异的更多信息：**

正如我刚才所说，这种`from Host import *`风格通常被认为是不好的——你可能会在没有意识到的情况下覆盖一些现有的变量，特别是如果你从不同的文件中多次这样做。如果您只是在交互式 python 中玩耍，这可能是可以接受的（尽管通常不方便，请参阅下一点），但是在脚本中使用它会使维护非常烦人，因为没有快速的方法来检查特定的类/函数是否正在运行代码中使用的来自`Host`模块或其他地方。

另请注意，如果您使用该`import Host`格式，您可以更改 Host.py 文件并将它们加载到您的交互式 python shell 中而不退出，`reload(Host)`如果您使用其中一种`from Host`导入样式，您将无法执行此操作.

无论如何，真的没有必要使用`execfile`这种东西。

更多信息：
-[关于导入样式的不错的 SO 问题](https://stackoverflow.com/questions/710551/import-module-or-from-module-import)
- [python 文档`import`](http://docs.python.org/reference/simple_stmts.html#import)
-[更多可读信息`import`](http://effbot.org/zone/import-confusion.htm)

**答案的原始部分 - 只是询问更多信息：**

首先，在你用 python 做任何事情之前，做：

```
echo $PYTHONPATH 
```

在外壳中。它是否包含`/home/manish/project`您期望的目录？

接下来，发布的输出

```
ls -l /home/manish/project 
```

这样我们就可以确定它确实包含您认为它包含的文件。

如果到目前为止一切正常，请启动 python。不要乱用 execfile （你为什么要这样做？），只需直接导入其中的一个文件`/home/manish/project`，如下所示：

```
>>> import Host 
```

（没有“.py”扩展名）。

发生什么了？请*编辑您的问题*以包含所有这些的输出（并评论我的答案，以便我收到通知，如果您愿意）。

**更多信息请求：**

如果`import Host`没有错误，请尝试这些命令，然后再次将输出粘贴到问题中：

```
>>> import sys
>>> sys.modules[Host.__name__].__file__
>>> obj = Host.Host() 
```

的输出`sys.modules[Host.__name__].__file__`应该告诉你 python 正在读取什么文件`import Host`- 是你认为它应该读取的文件，还是其他文件？

# android - Android 错误从 LocationListener 类将位置数据写入 SQLite 数据库

> ID：10825299
> 
> 赞同：4
> 
> 时间：2012-05-30T22:40:42.873
> 
> 标签：android, sqlite, service, locationlistener, android-context

我有一个应用程序，其中我有一个实现 locationlistener 的服务类。我希望能够将在 onLocationChanged() 中收到的位置传递回我的主要活动。到目前为止，我一直在尝试通过写入 SQLite 数据库来实现这一点，但是在尝试打开数据库以使其可写时出现错误。我相信这与没有写上下文有关，但我无法弄清楚。但是，当我在 onCreate() 中写入数据库时​​，它可以正常工作。我最初只是尝试这样做：

```
@Override
    public void onLocationChanged(Location loc) {//Spits out single location for current disconnect
        System.out.println("location equals "+loc);
        latitude=Double.toString(loc.getLatitude());
        longitude=Double.toString(loc.getLongitude());
        writeToDb(MyLocListener.this,latitude,longitude);       
        man.removeUpdates(listener);//Stops location manager from listening for updates
        listener=null;
        man=null;
    }

public void writeToDb(Context context,String latitude,String longitude){
    db=new DbAdapter(context);
    db.openToWrite();
    db.deleteAll();
    db.insert(latitude);
    db.insert(longitude);
    db.close();
} 
```

但这没有用，每次都会在 db.openToWrite() 行上给我一个 nullPointerException 。getApplicationContext() 在这里也不起作用。

我现在已将其修改为在线程中写入数据库：

```
@Override
public void onLocationChanged(Location loc) {//Spits out single location for current disconnect
    System.out.println("location equals "+loc);
    latitude=Double.toString(loc.getLatitude());
    longitude=Double.toString(loc.getLongitude());
    Runnable runner=new SaveLocation(latitude,longitude);
    new Thread(runner).start();
    man.removeUpdates(listener);//Stops location manager from listening for updates
    listener=null;
    man=null;
}

public class SaveLocation implements Runnable{
        String latitude;
        String longitude;
    //  DbAdapter db;
        public SaveLocation(String latitude,String longitude){
            this.latitude=latitude;
            this.longitude=longitude;

        }
        @Override
        public void run() {
            db.openToWrite();
            db.deleteAll();
            db.insert(latitude);
            db.insert(longitude);
            db.close();     
        }
    } 
```

我在 onCreate() 方法中将数据库初始化为：

```
public class MyLocListener extends Service implements LocationListener{ 
    static LocationManager man;
    static LocationListener listener;
    static Location location;
    public DbAdapter db;

    @Override
    public void onCreate() {
        super.onCreate();   
        this.db=new DbAdapter(MyLocListener.this);
    } 
```

但是现在，这第二次尝试不断给我一个更简洁的错误，但它仍然在我尝试打开数据库以使其可写的那一行出现故障。MyLocListener.java:92 行是指 db.openToWrite();

错误是：

```
05-30 15:35:19.698: W/dalvikvm(4557): threadid=9: thread exiting with uncaught exception (group=0x4001d7e0)
05-30 15:35:19.706: E/AndroidRuntime(4557): FATAL EXCEPTION: Thread-10
05-30 15:35:19.706: E/AndroidRuntime(4557): java.lang.NullPointerException
05-30 15:35:19.706: E/AndroidRuntime(4557):     at com.phonehalo.proto.MyLocListener$SaveLocation.run(MyLocListener.java:92)
05-30 15:35:19.706: E/AndroidRuntime(4557):     at java.lang.Thread.run(Thread.java:1096) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-26T17:30:35.017

已解决---如果其他人遇到同样的问题，我已经找到了解决方案，我无法相信它是多么简单。由于 java 的垃圾收集，我失去了到我的 SqlDatabase 的链接。解决方案只是将其声明为静态。然后我可以在 onLocationChanged() 方法中使用 Sql 插入/写入方法。希望能帮助到你！

# android - 先调用 OnStart 还是 onWindowFocusChange？

> ID：10825304
> 
> 赞同：0
> 
> 时间：2012-05-30T22:41:25.273
> 
> 标签：android, android-layout

所以我有这个代码：

```
@Override
protected void onCreate(Bundle bundle) {
super.onCreate(bundle);
...
setContentView(R.layout.article_layout);
TextView titleView = (TextView)findViewById(R.id.article_title);
TextView content = (TextView)findViewById(R.id.article_content);
formatArticle(titleView, content);
....
}

@Override
public void onWindowFocusChanged(boolean hasFocus) {
super.onWindowFocusChanged(hasFocus);
....
code that deals with placing images in formatted article.
} 
```

在这段代码中，我创建了一对使用默认字体大小和边距的文本视图。然后我将它们传递给他们以`formatArticle()`根据用户存储的偏好调整字体和边距。在中，我通过调用textview 并相应地调整位图的大小将`onWindowsFocusChanged()`图像内联到文章中。`getWidth()`

但是，每当此代码运行时，位图只会将自身调整为默认的 textview 大小。`onWindowFocusChanged()`之前调用过`formatArticle()`，还是我有其他问题。如果`onWindowFocusChanged()`首先调用，有没有办法让它等待`formatArticle()`完成？

# c# - Fluent Nhibernate ManyToMany 关系 - 不保存关联

> ID：10825307
> 
> 赞同：2
> 
> 时间：2012-05-30T22:41:42.370
> 
> 标签：c#, sqlite, nhibernate, fluent-nhibernate

我无法理解为什么这不起作用..我有两个实体之间存在多对多关系。

```
 public class User : BaseEntity
    {
        public User()
        {
            Roles = new List<Role>();
        }

        [DisplayName("UserName")]
        [Required]
        [StringLength(20, MinimumLength = 5)]
        public virtual string UserName { get; set; }

        [DisplayName("Password")]
        [Required]
        [DataType(DataType.Password)]
        public virtual string Password { get; set; }

        [DisplayName("Email Address")]
        [Required]
        [DataType(DataType.EmailAddress)]
        public virtual string Email { get; set; }

        public virtual IList<Role> Roles { get; set; }
    }

  public class Role : BaseEntity  
    {
           public Role()
           {
               Users=new List<User>();
           }

        [Required]
        [DisplayName("Role Name")]
        public virtual string RoleName { get; set; }

        public virtual string Description { get; set; }

        public virtual IList<User> Users { get; set; }
    }

    public class UserMapping : ClassMap<User>
    {
        public UserMapping()
        {
            Id(x => x.Id);

            Map(x => x.UserName).Not.Nullable().Unique();
            Map(x => x.Password).Not.Nullable();
            Map(x => x.Email).Not.Nullable().Unique();
            Map(x => x.DateCreated);
            Map(x => x.DateModified);
            HasManyToMany<Role>(mi => mi.Roles)
    .Table("UsersRoles").ParentKeyColumn("UserId").ChildKeyColumn("RoleId")

    .Cascade.SaveUpdate().Inverse();

        }
    }

   public class RoleMapping : ClassMap<Role>
    {
        public RoleMapping()
        {
            Id(x => x.Id);
            Map(x => x.RoleName).Not.Nullable().Unique();

            Map(x => x.Description).Nullable();
            Map(x => x.DateCreated);
            Map(x => x.DateModified);

        }

    } 
```

当我尝试简单的保存关联时不会保存：

```
var role = _roleTask.GetItem(1);   // I am sure exist.
    var user = _userTask.GetItem(1); // I am sure exist.

    user.Roles.Add(role);
    userTask.UpdateItem(user); 
```

谁能告诉我映射它以使 NHibernate 实际存储关联的正确方法是什么？
我使用 SQLite

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-31T11:37:01.190

因为我发布的任务没有代码应该工作

```
// UserMap
HasManyToMany(x => x.Roles)
    .Table("sometable")
    .ParentKeyColumn("User_id")
    .ChildKeyColumn("Role_id"); 
```

和

```
// RoleMap
HasManyToMany(x => x.Users)
    .Table("sometable")
    .ParentKeyColumn("Role_id")
    .ChildKeyColumn("User_id")
    .Inverse();    // User handels the insert in the link table 
```

和

```
var user = session.Get<User>(1);
var role = session.Get<Role>(1);

user.Roles.Add(role);
role.Users.Add(user);   // not nessessary for NH because inverse is set but good to be consistent

// Flush all changes (in particular the collection changes) to db
session.Flush(); 
```

# javascript - 通过javascript从json字符串中提取值

> ID：10825309
> 
> 赞同：0
> 
> 时间：2012-05-30T22:42:26.393
> 
> 标签：javascript, json

我有一个以 JSON 格式返回结果的网络服务 在 Javascript 中我想循环浏览这些结果，以便将它们显示给用户。

我已经定义了以下类：

```
Public Class PointsOfInterest
    Public Property hotspots() As List(Of Hotspot)
        Get
            Return m_hotspots
        End Get
        Set(value As List(Of Hotspot))
            m_hotspots = value
        End Set
    End Property
    Private m_hotspots As List(Of Hotspot)
    Public Property errorString() As String
        Get
            Return m_errorString
        End Get
        Set(value As String)
            m_errorString = value
        End Set
    End Property
    Private m_errorString As String
    Public Property errorCode() As Integer
        Get
            Return m_errorCode
        End Get
        Set(value As Integer)
            m_errorCode = value
        End Set
    End Property
    Private m_errorCode As Integer
End Class

Public Class Hotspot
    Private m_id As String
    Public Property id() As String
        Get
            Return m_id
        End Get
        Set(value As String)
            m_id = value
        End Set
    End Property

    Public Property anchor() As anchor
        Get
            Return m_anchor
        End Get
        Set(value As anchor)
            m_anchor = value
        End Set
    End Property
    Private m_anchor As anchor

    Public Property text() As textprop
        Get
            Return _text
        End Get
        Set(value As textprop)
            _text = value
        End Set
    End Property
    Private _text As textprop

    Public Property imageURL() As String
        Get
            Return _imageURL
        End Get
        Set(value As String)
            _imageURL = value
        End Set
    End Property
    Private _imageURL As String

    Public Property actions() As List(Of action)
        Get
            Return _actions
        End Get
        Set(value As List(Of action))
            _actions = value
        End Set
    End Property
    Private _actions As List(Of action)

End Class

Public Class anchor
    Public Property geolocation() As geoloc
        Get
            Return _geoloc
        End Get
        Set(value As geoloc)
            _geoloc = value
        End Set
    End Property
    Private _geoloc As geoloc

End Class

Public Class textprop
    Public Property title() As String
        Get
            Return _title
        End Get
        Set(value As String)
            _title = value
        End Set
    End Property
    Private _title As String
    Public Property description() As String
        Get
            Return _description
        End Get
        Set(value As String)
            _description = value
        End Set
    End Property
    Private _description As String
    Public Property footnote() As String
        Get
            Return _footnote
        End Get
        Set(value As String)
            _footnote = value
        End Set
    End Property
    Private _footnote As String

End Class

Public Class geoloc
    Public Property lat() As String
        Get
            Return _lat
        End Get
        Set(value As String)
            _lat = value
        End Set
    End Property
    Private _lat As String
    Public Property lon() As String
        Get
            Return _lon
        End Get
        Set(value As String)
            _lon = value
        End Set
    End Property
    Private _lon As String
End Class

Public Class action
    Public Property uri() As String
        Get
            Return _uri
        End Get
        Set(value As String)
            _uri = value
        End Set
    End Property
    Private _uri As String

    Public Property label() As String
        Get
            Return _label
        End Get
        Set(value As String)
            _label = value
        End Set
    End Property
    Private _label As String
    Public Property contentType() As String
        Get
            Return _contentType
        End Get
        Set(value As String)
            _contentType = value
        End Set
    End Property
    Private _contentType As String
    Public Property method() As String
        Get
            Return _method
        End Get
        Set(value As String)
            _method = value
        End Set
    End Property
    Private _method As String
    Public Property activityType() As Integer
        Get
            Return _activityType
        End Get
        Set(value As Integer)
            _activityType = value
        End Set
    End Property
    Private _activityType As Integer
    Public Property showActivity() As Boolean
        Get
            Return _showActivity
        End Get
        Set(value As Boolean)
            _showActivity = value
        End Set
    End Property
    Private _showActivity As Boolean
    Public Property activityMessage() As String
        Get
            Return _activityMessage
        End Get
        Set(value As String)
            _activityMessage = value
        End Set
    End Property
    Private _activityMessage As String

End Class 
```

我通过 JSON 中的 Web 服务返回这些：[http ://www.wunderwedding.com/weddingservice.svc/api/?t=1&cid=1&pid=6&lat=52&lng=5&d=10000&city=nijmegen&field1=0&field2=0&field3=0&field4=0&hasphoto= 0&hasvideo=0&minrating=0&lang=nl](http://www.wunderwedding.com/weddingservice.svc/api/?t=1&cid=1&pid=6&lat=52&lng=5&d=10000&city=nijmegen&field1=0&field2=0&field3=0&field4=0&hasphoto=0&hasvideo=0&minrating=0&lang=nl)

现在，例如，如果我想读取第三个结果的 tel 属性（在本例中为 0348551532），我该怎么做？是不是类似于 XSLT，我可以在其中使用表达式进行选择？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T22:55:15.193

在 JavaScript 中，我假设您使用支持 AJAX 的 jQuery 或 ExtJS 之类的东西。在客户端获得 JSON 后，您将对 Web 服务结果进行解码（如果您在没有特殊工具包的情况下读取 JSON，则使用 E​​xt.decode 或 eval("")）。

一旦您对 JSON 进行解码，它就可以在 JavaScript 中轻松使用。

例子：

```
var json = [Function that decodes JSON text];
var uriInfo = json.hotspots[2].actions[1].uri; 
```

如果您使用的是 FireFox，您可以安装一个名为 FireBug 的插件。这将允许您完成这类事情。使用该工具，您可以调用 console.dir(json); 在 JavaScript 中查看整个结构，如 javascript 等。

# python - 无效的 URL 'GET'：在 Python 中调用 freebase api 时没有提供模式错误。

> ID：10825312
> 
> 赞同：2
> 
> 时间：2012-05-30T22:42:57.813
> 
> 标签：python

```
import os
import shelve
import urllib
import urlparse
import sys
import shelve
import oauth2 as oauth
import requests

api_key = 'xyz'
url = 'https://www.googleapis.com/freebase/v1/mqlread?query=hello&key=xyz'

resp, content = requests.request(url, "GET")
print resp 
```

我只是在测试freebase api。当我运行这个基本脚本时，我收到了这个错误：requests.exceptions.MissingSchema: Invalid URL 'GET': No schema provided 为什么有什么原因？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-30T22:59:07.203

我相信您正在寻找的是：

```
>>> import requests
>>> url = 'https://www.googleapis.com/freebase/v1/mqlread?query=hello&key=xyz'
>>> requests.get(url)
<Response [400]>
>>> 
```

从[请求](http://docs.python-requests.org/en/latest/api/#requests.request)文档

> requests.request（方法，网址，**kwargs）
> 
> 它返回 Response 对象的一个​​实例。

因此，您需要以正确的顺序给出参数。

```
>>> requests.request("GET",url)
<Response [400]>
>>> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T22:59:05.560

您必须以正确的顺序放置参数：错误消息清楚地表明`request()`认为`"GET"`是 URL。此外，此调用返回单个`Response`对象，而不是单独的响应和内容对象，因此您无法将其解压缩为两个变量。

```
resp = requests.request("GET", url) 
```

要不就：

```
resp = requests.get(url) 
```

然后：

```
content = resp.content 
```

您应该在[此处](http://docs.python-requests.org/en/latest/api/)`requests`查看该模块的文档。

# css - 我对这个 CSS 做错了什么？

> ID：10825314
> 
> 赞同：1
> 
> 时间：2012-05-30T22:43:29.423
> 
> 标签：css

我正在处理一个页面，并且我将内容放在样式表的包装器中。然而，包装器的背景并没有出现在内容的后面，我不知道为什么。

这是代码片段。

```
#wrapper {
  width: 850px;
  margin-top: -44px;
  padding: 15px;
  background-image: url('http://www.website.com/tumblr/images/contentbg_grey.png') repeat-y center;
  border: dashed thin blue;
  position: relative;
  text-align:center;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-30T22:44:58.817

```
background-image: url('http://www.website.com/tumblr/images/contentbg_grey.png') repeat-y center; 
```

应该：

```
background: url('http://www.website.com/tumblr/images/contentbg_grey.png') repeat-y center center; 
```

如果您使用速记，请删除“-image”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T23:05:29.993

此网址没有图片。检查您的图像。Css 代码似乎是正确的。只需将背景图像更改为背景。 [http://www.website.com/tumblr/images/contentbg_grey.png](http://www.website.com/tumblr/images/contentbg_grey.png)

去测试：

```
<html>
<head>
<style type="text/css">
div#wrapper {
                width: 850px;
                min-width: 850px;
                min-height: 400px;
                margin-top: -44px;
                padding:15px;
                background: url('http://www.website.com/img/logo.png') repeat-y center;
                border: dashed thin blue;
                position:         relative;
                text-align:center;
            }
</style>
</head>
<body>
<div id="wrapper"></div>
</body>
</html> 
```

# c# - 从两个 8 位值中找到 14 位值的函数的反面是什么？

> ID：10825316
> 
> 赞同：1
> 
> 时间：2012-05-30T22:43:49.240
> 
> 标签：c#, function, logic, bit-manipulation

下面取两个 8 位整数并将它们组合生成一个 14 位整数。

```
 public static int CombineBytes(int LSB, int MSB)
    {
        int _14bit;

        _14bit = MSB;
        _14bit <<= 7;
        _14bit |= LSB;

        return(_14bit);
    } 
```

这个函数的相反过程是什么？

例如，如果我提供了一个 14 位整数的函数，我会得到两个 8 位整数，分别是最高有效字节和最低有效字节？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-30T22:53:25.647

假设您的意思是两个 7 位整数，您可以通过将 7 向右移动来获得高 7 位，`high = combined >> 7`并通过使用二进制和 屏蔽来获得低 7 位`low = combined & 0x7F`。

# android - 带有两个 Android 设备的 Socket 服务器/客户端

> ID：10825317
> 
> 赞同：0
> 
> 时间：2012-05-30T22:44:02.130
> 
> 标签：android, sockets, client

所以我有一个平板电脑，我想基本上把它做成一个 TCP（或 UDP）套接字服务器，这样多部手机就可以向它发送数据。我还希望能够将回复发送回手机。到目前为止我所拥有的不起作用...

服务器：

```
Log.i("Server", "Starting server...");
                try {
                    ServerSocket ss = new ServerSocket(8080);
                    Log.i("Server", "Server status: " + ss.isBound());
                    while(true){
                        //Server is waiting for client here, if needed
                        Socket s = ss.accept();
                        Log.i("Server", "Server is accepting connections: " + s.isConnected());
                        BufferedReader input = new BufferedReader(new InputStreamReader(s.getInputStream()));
                        PrintWriter output = new PrintWriter(s.getOutputStream(),true); //Autoflush
                        Log.i("Server", "Initialized input and output");
                        String st = input.readLine();
                        Log.i("Server", "From client: "+st);
                        output.println("Good bye and thanks for all the fish :)");
                    }

                } catch (UnknownHostException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                } catch (IOException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                } 
```

和客户（电话）：

```
try {
                    Socket s = new Socket("192.168.0.106", 8080);

                    //outgoing stream redirect to socket
                    OutputStream out = s.getOutputStream();

                    PrintWriter output = new PrintWriter(out);
                    output.println("Hello Android!");
                    BufferedReader input = new BufferedReader(new InputStreamReader(s.getInputStream()));
                    //read line(s)
                    String st = input.readLine();
                    tv.setText(st);
                    //Close connection
                    s.close();

                } catch (UnknownHostException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                } catch (IOException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T04:28:49.740

您的客户可能没有刷新 println

尝试在构造函数中指定 autoflush

```
PrintWriter output = new PrintWriter(out, true); 
```

或在打印下方手动添加冲洗

```
output.println("Hello Android!");
output.flush(); 
```

# php - jpGraph 线图：x 轴时间值

> ID：10825318
> 
> 赞同：1
> 
> 时间：2012-05-30T22:44:08.050
> 
> 标签：php, jpgraph

我写了一个绘制 jpGraph 线图的代码。X 轴包含时间值，即小时 01:00、02:00 等。Y 轴包含频率数。问题是 X 轴从 01:00 开始，尽管我希望它从 00:00 开始。有谁知道为什么会发生这种情况以及如何避免这种转变？

```
<?php
ob_start();
    include_once ( "../jpgraph-3.5.0b1/src/jpgraph.php");
    include_once ("../jpgraph-3.5.0b1/src/jpgraph_bar.php");
    include_once ("../jpgraph-3.5.0b1/src/jpgraph_line.php");
    include_once ("../jpgraph-3.5.0b1/src/jpgraph_date.php");
    include_once "../jpgraph-3.5.0b1/src/jpgraph_canvas.php";

//...data array

        $totalSec = 0; $stepSec = 60;
        $ntimepoints = 1440;
        $datax = array(); 
        $datay = array();
        for( $i=0; $i < $ntimepoints; $i++ ) {
            $datax[$i] = $totalSec;
            $datay[$i] = numberOfFits($data,$totalSec);
            $totalSec = $totalSec + $stepSec;
        }

        // Create the new graph
        $graph = new Graph(1200,300,"auto");

        // Slightly larger than normal margins at the bottom to have room for
        // the x-axis labels
        $graph->SetMargin(60,30,30,40);

        // Fix the Y-scale and use date for the x-axis
        $graph->SetScale('datlin');

        // Set the angle for the labels to 90 degrees
        $graph->xaxis->SetLabelAngle(90);
        $graph->xaxis->SetColor("black","#274E7D");
        $graph->yaxis->SetColor("black","#274E7D");
        $graph->yaxis->SetTitleMargin(40);

        // Set up font for axis
        //$graph->xaxis->SetFont(FF_VERDANA,FS_NORMAL,8);
        $graph->yaxis->SetFont(FF_VERDANA,FS_NORMAL,10);
        $graph->yaxis->title->Set("Nr of resources");
        $graph->yaxis->title->SetColor("#274E7D");
        $graph->yaxis->title->SetFont(FF_VERDANA,FS_NORMAL,10);

        // Set up X-axis title (color &amp; font)
        //$graph->xaxis->title->Set("Time");
        $graph->xaxis->title->SetColor("#274E7D");
        $graph->xaxis->title->SetFont(FF_VERDANA,FS_NORMAL,10);

        $graph->xaxis->scale->SetTimeAlign(MINADJ_60);

        $graph->xaxis->scale->SetDateFormat('H:i');

        $line = new LinePlot($datay,$datax);

        $line->SetFillColor('#6899D3@0.5');
        //$line->SetStepStyle();

        $graph->Add($line);
        $graph->Stroke();
    } 
```

# asp.net - 虚拟专用服务器上的连接字符串不起作用

> ID：10825319
> 
> 赞同：1
> 
> 时间：2012-05-30T22:44:17.207
> 
> 标签：asp.net, sql-server-2008, connection-string, vds

我正在从共享主机迁移到虚拟专用服务器（都在 GoDaddy）。令人惊讶的是，到目前为止一切都很好。但是，现在我的 Web 应用程序似乎无法连接到数据库（我在服务器上创建的）。

我尝试了几个选项，包括为其提供服务器名称等，例如：

```
<add name="dbname" connectionString="Data Source=servername\SQLEXPRESS2008;Initial Catalog=theDB;User Id=servername\usernameAcceptedByMangmentStudio;Password=mypwd; Trusted_Connection=False;"/> 
```

还：

```
<add name="dbname" connectionString="Data Source=.\SQLEXPRESS2008;Initial Catalog=theDB;User Id=usernameAcceptedByMangmentStudio;Password=mypwd; Trusted_Connection=False;"/> 
```

还：

```
<add name="dbname" connectionString="Data Source=servername\SQLEXPRESS2008;Initial Catalog=theDB; Integrated Security=True;> 
```

（这就是它在我的本地机器上的工作方式）。

似乎没有任何效果。有任何想法吗？提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T00:49:26.027

您似乎不知道您是否有命名实例或默认实例。甚至两者之间的差异。

首先，我将解释确定您拥有哪些的最快方法，然后我将解释差异。

您需要连接到您的服务器（我假设您可以远程桌面或类似的东西），然后打开控制面板 > 管理工具 > 服务。在该列表中应该有一个名为 SQL Server 的项目，它看起来像这样：

> SQL 服务器 (MSSQLSERVER)

或这个：

> SQL Server (some_name)

前者是默认实例。如果这是您所看到的，那么连接字符串应该是：

```
"Data Source=localhost;..." 
```

后者是一个命名实例。如果这是您所看到的，您的连接字符串应该是：

```
"Data Source=localhost\some_name;..." 
```

如果您同时看到两者，那么您需要告诉我们您最初是如何连接到此实例以创建数据库的（并且您需要决定要使用哪一个，因为您可能不需要两者）。

如果这没有帮助，您需要比“不起作用”更具体。您无法连接到服务器或数据库吗？实际的错误信息是什么？创建数据库时，是否使用了 User Instances / AttachDbFileName 功能？您能否在 Management Studio 中显示成功的连接对话框的屏幕截图？您的应用程序是在服务器上还是在本地计算机上？您是否可以指定 IP 地址而不是各种本地引用？您是否就您的问题联系过 GoDaddy 支持？它们比编程问答网站更能帮助您，因为它们可以在 10 秒内连接到您的服务器，并准确告诉您应该如何引用 SQL Server 实例。

至于区别，当您需要安装 SQL Server 的多个单独实例时，通常使用命名实例。这通常不是生产机器的要求；在必须测试多个版本、模拟不同环境或临时迁移或并行升级期间的开发机器上更为常见。默认实例在端口 1433 上侦听开箱即用。命名实例在其他端口上运行，并且通常使用远程计算机的 SQL 浏览器服务来确定如何准确连接到它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T23:04:40.647

如果您的数据库有用户名和密码（SQL Server 身份验证），只需简单地使用这个：

```
<add name="dbname" connectionString="Data Source=yourServerName;Initial Catalog=YourDB;User ID=YouruserId;Password=YourPassWord" providerName="System.Data.SqlClient"/> 
```

仅供参考：确保您的数据库服务器身份验证是 SQL Server 和 WindowsAuthentication 模式

您还可以查看：[SQL Server 2008 的连接字符串以](http://connectionstrings.com/sql-server-2008)获取更多信息。

问候

# ios - 在 xcode 4.3 上运行测试

> ID：10825327
> 
> 赞同：3
> 
> 时间：2012-05-30T22:45:15.113
> 
> 标签：ios, xcode

我正在使用 Xcode 4.3，但我不知道如何运行测试，或者至少不知道如何查看测试结果，失败或通过。

我有一个有两个目标的项目，`foo`并且`fooTests`. 测试是默认实现；一个简单的 tearDown 和 setup 函数和一个 testExample 方法`STFail(@"not implemented")`

我应该在哪里看到这条消息？在方案下拉列表中，似乎只有`foo`. 我需要做什么来运行 fooTests 目标并查看输出？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-06-19T11:25:04.213

我通过单击“编辑方案”对话框中的“运行”复选框解决了这个问题。左侧有一个选项卡列表。选择“构建”。然后在右侧有一个操作列表（“分析”、“测试”、“运行”、“配置文件”等）。确保选中“运行”。

然后按“确定”，然后清理并构建您的项目。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-30T22:49:52.950

从菜单`Product`->`Test`或 Cmd+U (`⌘</kbd>+`U`) keyboard shortcut will run the test for `foo` target.`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T22:50:11.700

您需要创建一个新方案来运行不同的目标。单击方案栏的左侧（左上角），您应该会看到一个下拉菜单，其中“新方案”是一个选项——创建一个新方案并选择 fooTests 作为目标。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-31T01:29:07.117

Eimantas 的回答涵盖了运行测试。打开日志导航器以查看结果。以下文章提供了更多详细信息：

[在 Xcode 4 中设置 OCUnit 单元测试](http://meandmark.com/blog/2012/05/setting-up-ocunit-unit-testing-in-xcode-4/)

# css - 如何在选择输入中的选项之间添加填充？

> ID：10825332
> 
> 赞同：7
> 
> 时间：2012-05-30T22:46:07.473
> 
> 标签：css

如何为我的选择输入选项添加填充？这是我的 CSS，所有选项看起来都在彼此下方，没有任何间距（就选项的高度而言）我有一个 CSS 重置..除此之外，我怎样才能给选项一些高度以使其看起来不错？

```
.upload-input select {
    display: block;
    font-size: 14px;
    color: #888;
    width: 616px;
    background: #fff;
    border: 1px solid #ccc;
} 
```

**更新**

我应用了建议的CSS。它看起来不正确。

![在此处输入图像描述](../Images/86ed1a6afa69c1330d6cb8164f7d7fc8.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T22:49:24.960

尝试

```
.upload-input select option { padding: 6px;} 
```

不过，您可能不得不摆弄 .upload-input select css。

像：

```
.upload-input select {height: 35px;} 
```

# javascript - 将数组传递给 JavaScript 回调

> ID：10825334
> 
> 赞同：1
> 
> 时间：2012-05-30T22:46:13.730
> 
> 标签：javascript, oop, debugging, syntax

我对 jQuery 非常熟悉，但正如你们大多数人所知，jQuery 和 vanilla javascript 之间有很大的不同。我正在尝试更深入地了解 vanilla javascript，并且我有一些代码和一些问题。

在下面的代码中，我尝试从 Writeboard.com（已停用[http://37signals.com/writeboard-retired](http://37signals.com/writeboard-retired)）的导出功能生成 HTML。基本上，我正在尝试进行一些有用的练习并编写一个脚本来查找特定内容，例如`<li>//Title:...</li>`并将其推送到 JSON 数组中，然后我将其解析为 XML。最终目标是将所有这些都作为 XML 获取，以便它更便携（既远离传统的 Writeboard.com 板，也可以直接导入到我正在开发的 Web 应用程序中）。

所以，我还有很长的路要走，而且我不是在寻找任何人为我编写代码，但我正在努力思考以下几点：

*   尝试创建一个回调调用`TargetList`，允许用户按如下方式传递一个数组，以告诉脚本特殊的“键”（值），然后搜索该“键”（值）。父级`<li>`将提取其内容并将其保存到 JSON 数组中，以便`<li>`可以放弃包含元素，而 XML 属性（例如`<title>`）可以包装它。

*   我对在 JS 中设置数组的正确语法的理解是`var targetList = [];`创建一个空数组，然后我可以稍后在循环搜索、查找和保存脚本的各个方面时填充该数组。我想我设置错了，我不知道为什么。

    *   我也很困惑为什么我不能`convertToXML(['//Title:','//Prerequisite:','//Description:']);`稍后在脚本中调用该函数，我在这方面遇到了错误，不知道为什么。我得到的错误导致我假设我没有正确设置目标，所以我只是通过包装`document.ready`我意识到在脚本稍后调用早期函数时不需要的函数来创建一个，尽管我不知道为什么我遇到了困难。

我意识到其中一些与我仍在学习的 OOP 原则有关，对我温柔一点，我希望有人能向我解释为什么我会出错。我会非常感激的！

```
( function ($) { // wrap jQuery to prevent conflicts

    $(document).ready(function () {

        function convertToXML (targetList) {

            var targetList = [];

            var i = 0; 
            while (i<=targetList.length) {
                var target = targetList[i];
                targetList.push( target );              
                i++;
            };
        };

        $(document).ready(function() {
            convertToXML(['Title:','Prerequisite:','Cost:','Description:','Effect:','Categories:' ]);
        });     

    }); // end document.ready

} ) ( jQuery ); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T22:57:42.117

我可以回答你的第二个问题，但你需要详细说明你的第一个问题。

您不能`convertToXML`稍后在页面中调用的原因是您已将其包装在范围内。（事实上​​，它是一分为二的。）

```
function($) {
    // creates an anonymous function which takes one parameter (named $)
}

(function($) {
    // creates an anonymous function which takes one parameter,
    // and immediately calls it, passing the variable named jQuery to the parameter named $
})(jQuery); 
```

这是使用 jQuery 来克服其他库有时会接管特殊 $ 变量名的问题的常见模式。但重要的是要了解您在该匿名方法内部定义的任何内容都不能从该方法外部访问。因此，如果您想`convertToXML`从外部访问您的方法，则需要将它的定义移到该块之外。

此外：

```
$(document).ready(function () {
    // create an anonymous function, and pass it to jQuery's document.ready method,
    // jQuery will call your function when the DOM is loaded.
}); 
```

你已经这样做了两次......我很确定第二个不会被调用，因为它在第一个内部，它在加载 DOM 时被调用，并且 DOM 只加载一次。删除其中之一。

# php - jQuery AJAX 和 PHP

> ID：10825335
> 
> 赞同：0
> 
> 时间：2012-05-30T22:46:22.330
> 
> 标签：php, javascript, jquery, ajax

好吧，我有一个类似的问题，但想扩展它，看看我是否能得到更好的答案：

我正在尝试对在表中存储电子邮件地址的 PHP 文件进行 Jquery Ajax Post 调用。成功的 ajax 调用后，我正在尝试更改按钮 html。

这是我的全部 HTML/Javascript：

```
<!DOCTYPE html>
<html>
    <head>

        <!--Meta tags-->
        <meta charset="utf-8">

        <!--Title-->
        <title>Startup Winnipeg</title>

        <!--Stylesheets-->
        <link rel="stylesheet" href="css/master.css">

        <!--Script-->
        <script type="text/javascript">

            function empty() {
                document.getElementById("email").value="";
            }

            function determine() {
                if (document.getElementById("email").value.length==0){
                    document.getElementById("email").value="Email Address";
                }
            }

            function validate() {
                document.getElementById("registerform").submit();
            }

        </script>

    </head>
    <body>
        <div id="container"></div>
        <div id="topbar"></div>
        <div id="header"></div>
        <div id="register">
            <div id="formcontainer">
                <form action="" id="registerform" name="registerform" method="post" >
                    <input type="text" id="email" name="email" value="Email Address" onClick="empty()" onBlur="determine()" />
                    <button type="submit" id="join" name="join" onClick="validate()">Sign Up</button>
                </form>
            </div>
            <div id="info">
                <a href="http://www.facebook.com" target="_blank"><div id="fb"></div></a>
            </div>
            <div id="bar"></div>
        </div>

        <!--jQuery-->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>

        <script type="text/javascript">

            //listen for click
            $('form').on('submit', function(e) {
                $.post('register.php', $("#registerform").serialize(), function() {
                    $('#join').html("Success!")             
                });        
                //disable default action
                e.preventDefault();
            });
        </script>
    </body>
</html> 
```

这是将电子邮件地址写入表的 PHP 文件：

```
<?php include("database_connection.php");?>

<?php 

$email = $_POST['email'];
$email = mysql_real_escape_string($email);

mysql_select_db("suw",$con);

$sql="INSERT INTO emails (email) VALUES ('$email')";

mysql_query($sql,$con);

echo mysql_error();

 ?>

 <?php include ("close_database_connection.php");?> 
```

我有几个问题：

1.  如果我输入完整的电子邮件地址，它不会写入表格，但是，任何其他乱码都会写入表格

2.  将数据写入表时，按钮的 html 不会更改

让我知道我做错了什么 - 我有两本书并且已经搜索了 jquery api，但我无法弄清楚我做错了什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-30T23:05:16.420

不确定它是否会有所帮助，但首先要摆脱所有内联 JS，以及相同事件的多个函数等。

将 javascript 放在头部，并删除内联处理程序：

```
<head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script type="text/javascript">
      $(function() {
        $("#email").on({
            click: function() {
                this.value = "";
            },
            blur: function() {
                if (this.value.length===0) this.value = "Email Address";
            }
        });

        $("#join").on('click', function(e) {
            e.preventDefault();
            $.post('register.php', $("#registerform").serialize(), function(data) {
                $('#join').html(data)             
            });
        });
      });
    </script>
</head>
<body>
    <form action="" id="registerform" name="registerform" method="post" >
         <input type="text" id="email" name="email" value="Email Address" />
         <button type="submit" id="join" name="join">Sign Up</button>
    </form>
</body> 
```

在您的 PHP 中，包含可能在标签内，并且只返回成功或错误：

```
<?php 
    include("database_connection.php");

    mysql_select_db("suw",$con);
    $email = mysql_real_escape_string($_POST['email']);
    $sql="INSERT INTO emails (email) VALUES ('$email')";
    mysql_query($sql,$con);
    if (mysql_errno()) {
        echo mysql_error(); // or just "error"
    }else{
        echo "Success!";
    }

    include ("close_database_connection.php");
?> 
```

# database - 有没有支持iOS和Android远程数据管理的Java数据库框架

> ID：10825344
> 
> 赞同：0
> 
> 时间：2012-05-30T22:46:58.067
> 
> 标签：database, jdbc, orm, restlet

我目前正在使用 RESTlets 来处理 REST 请求和 JDBC 来将该数据输入 mysql 数据库。随着我的移动应用程序的增长，JDBC 变得难以管理。是否有一个 Java 数据库框架可以很好地管理来自 iOS 和 Android 设备的请求？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T17:34:45.997

带有 Hibernate 或 JDBC 的 RESTlet 似乎可以工作

# c - 检查文件更改

> ID：10825352
> 
> 赞同：0
> 
> 时间：2012-05-30T22:47:54.947
> 
> 标签：c, unix, operating-system, signals

我在 unix OS 中用 C 语言编程，但遇到了问题。我需要在用户选择的一些文件中进行操作并检查是否有一些*令牌字符串*，但只有在文件更改时检查文件才有意义。所以我想使用`SIGALARM`每秒检查文件的修改日期，但它似乎不是“好”。还有其他方法吗？操作系统有任何调整可以使用以变得更容易吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T23:14:23.727

在 Linux 上，有一个名为 inotify 的 API 可以满足您的需求。要获得更便携的解决方案，请查看 glib 的 gio 子库，特别是[此处](http://developer.gnome.org/gio/2.30/GFileMonitor.html)。它可能可以做你想做的事，但我不完全确定。

# hibernate - 使用 Hibernate/JPA 在 Oracle 中关闭连接时的部分提交

> ID：10825353
> 
> 赞同：0
> 
> 时间：2012-05-30T22:47:58.707
> 
> 标签：hibernate, jpa, oracle11g, c3p0

最近在使用数据库 Oracle RAC 11g 的应用程序 JPA/Hibernate 中出现以下错误。

当我们的存储已满并且 DBA 需要关闭连接、终止活动会话或类似“连接关闭”之类的情况时发生此错误（现在我可以知道发生了什么，他被解雇了......）

```
javax.persistence.RollbackException: Error while commiting the transaction
at org.hibernate.ejb.TransactionImpl.commit(TransactionImpl.java:71)
at com.cgmp.ValePedagioSite.comprarViagemPorPlaca(ValePedagioSite.java:473)
at sun.reflect.GeneratedMethodAccessor1719.invoke(Unknown Source)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
at java.lang.reflect.Method.invoke(Method.java:597)
        (...)
Caused by: org.hibernate.exception.JDBCConnectionException: could not insert: [com.cgmp.model.entity.PedagioPracaViagem]
at org.hibernate.exception.SQLStateConverter.convert(SQLStateConverter.java:97)
at org.hibernate.exception.JDBCExceptionHelper.convert(JDBCExceptionHelper.java:66)
at org.hibernate.persister.entity.AbstractEntityPersister.insert(AbstractEntityPersister.java:2295)
        (...)
Caused by: java.sql.SQLRecoverableException: Connection closed
at oracle.jdbc.driver.PhysicalConnection.prepareStatement(PhysicalConnection.java:3331)
at oracle.jdbc.driver.T2CConnection.prepareStatement(T2CConnection.java:47)
at oracle.jdbc.driver.PhysicalConnection.prepareStatement(PhysicalConnection.java:3232)
at oracle.jdbc.driver.T2CConnection.prepareStatement(T2CConnection.java:47)
at com.mchange.v2.c3p0.impl.NewProxyConnection.prepareStatement(NewProxyConnection.java:213)
        (...) 
```

其他实体插入没有问题...

--- 已编辑 ---

更多信息

配置 c3p0

```
<Resource auth="Container"
description=""
driverClass="oracle.jdbc.driver.OracleDriver"
acquireIncrement="1"
initialPoolSize="5"
maxPoolSize="300"
minPoolSize="5"
maxIdleTime="600"
maxIdleTimeExcessConnections="300"
unreturnedConnectionTimeout="900"
numHelperThreads="20"
name=""
user=""
password=" "
factory="org.apache.naming.factory.BeanFactory"
type="com.mchange.v2.c3p0.ComboPooledDataSource"
jdbcUrl="jdbc:oracle:oci:" /> 
```

与其他 DBA 交谈时，他说Oracle 的**一个**实例获得了完整的磁盘，并且此时创建了部分提交的寄存器，但他只是删除了跟踪文件，没有停止 db，也没有杀死任何会话。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T05:49:09.413

好吧，没有足够的信息可以肯定地说，但这听起来像是您所看到的未完成的事务处理。JDBC 规范在未完成事务的情况下应该发生什么问题上默默无闻。甲骨文是我所知道的唯一一家决定最好的行动方案是在这种情况下投入工作的供应商。

# c++ - 二维字符数组上的 memset

> ID：10825364
> 
> 赞同：1
> 
> 时间：2012-05-30T22:49:50.560
> 
> 标签：c++, arrays, memset

使用 2D 整数数组，一切都很好：

```
 int **p = new int*[8];
 for (int i = 0; i < 8; i++)
    p[i] = new int[8];
 memset(p, 0, 64 * sizeof(int)) 
```

但是使用二维字符数组，我得到一个运行时错误

```
 char **p = new char*[8];
 for (int i = 0; i < 8; i++)
     p[i] = new char[8];
 memset(p, 0, 64 * sizeof(char)); 
```

我的代码有什么问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-30T22:53:55.910

我认为两者都可能是错误的，只有第二个在运行时失败。每当您分配一个数组时，`new`它都会进入堆并返回一个指针。因此，在您的情况下，您有 8 个 X 类型的指针存储在`p`. 您*没有*8x8 连续的内存块，而是有 8 个指向 8 个内存块的指针，全部为 size `8*sizeof(X)`。

解决方案是调用`memset`每个元素`p`或分配一个内存块并使用索引数学来模拟多维访问或我可能缺少的其他技巧。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-12-02T16:22:46.003

如果您的数组没有被动态分配，这将起作用：

```
memset(p, 0, 8 * 8 * sizeof(char[0][0])); 
```

请注意，现在它正在将数组元素的大小传递给`sizeof`.

但在你的情况下，解决方案确实是为每个元素调用 memset `p`：

```
for (int i = 0; i < 8; i++) {
    memset(p[i], 0, sizeof(p[i][0]) * 8);
} 
```

如前所述，另一种解决方案是转换`p`为一维数组。

# ruby - 红宝石混淆中的正则表达式匹配

> ID：10825366
> 
> 赞同：1
> 
> 时间：2012-05-30T22:49:59.800
> 
> 标签：ruby, regex, string, string-matching

谁能给我解释一下？

```
str = "org-id:         N/A\n"

puts str[/org-id:\s+(.+)\n/]
=> "org-id:         N/A\n"
str =~ /org-id:\s+(.+)\n/
puts $1
=> "N/A" 
```

我只需要

```
str =~ /org-id:\s+(.+)\n/
puts $1 
```

在一行中。但是`str[/org-id:\s+(.+)\n/]`并`str.slice(/org-id:\s+(.+)\n/)`返回`"org-id: N/A\n"`和 str.scan(/org-id:\s+(.+)\n/).first 返回`["N/A"]`（和数组）。为什么所有这些匹配的行为不同？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T01:58:43.303

来自[精美手册](https://ruby-doc.org/core/String.html#method-i-5B-5D)：

> **str[regexp] → new_str 或 nil**
> **str[regexp, fixnum] → new_str 或 nil**
> 
> 如果提供了 a ，则返回*str*`Regexp`的匹配部分。如果数字或名称参数跟随正则表达式，则返回该组件。*`MatchData`*

 *因此，如果您这样做，`str[/org-id:\s+(.+)\n/]`那么您将获得整个匹配部分（AKA `$&`）；如果您想要第一个捕获组（AKA `$1`），那么您可以说：

```
puts str[/org-id:\s+(.+)\n/, 1]
# 'N/A' 
```

如果您的正则表达式中有第二个捕获组并且您想要它捕获的内容，您可以这样说`str[regex, 2]`。因此，您还可以使用命名的捕获组和符号：

```
puts str[/org-id:\s+(?<want>.+)\n/, :want] 
```

因此，使用正确的模式和参数，`String#[]`可以方便地从字符串中提取单个基于正则表达式的块。

如果您查看手册，您应该会注意到`String#[]`并且`String#splice`是一回事。

* * *

如果我们查看[`String#=~`](https://ruby-doc.org/core/String.html#method-i-3D-7E)，我们会看到：

> **str =~ obj → fixnum 或 nil**
> 
> 匹配—如果*obj*是 a `Regexp`，则将其用作匹配*str*的模式，并返回匹配开始的位置，或者`nil`如果没有匹配。

所以当你说：

```
str =~ /org-id:\s+(.+)\n/ 
```

你得到`'org-id: N/A'`in `$&`，`'N/A'`in `$1`，运算符的返回值是数字零；如果您的正则表达式中有另一个捕获组，您会在`$2`. “ `nil`or not `nil`”的返回值`=~`允许您说出以下内容：

```
make_pancakes_for($1) if(str =~ /some pattern that makes (us) happy/) 
```

所以`=~`很方便一次性结合解析和布尔测试。

* * *

[`String#scan`](https://ruby-doc.org/core/String.html#method-i-scan)方法：

> **扫描（模式）→数组**
> **扫描（模式）{|匹配，...| 块 } → str**
> 
> Both forms iterate through *str*, matching the pattern (which may be a `Regexp` or a `String`). For each match, a result is generated and either added to the result array or passed to the block. If the pattern contains no groups, each individual result consists of the matched string, `$&`. If the pattern contains groups, each individual result is itself an array containing one entry per group.

So `scan` gives you a simple list of matches or an AoA of matches if capture groups are involved and `scan` is meant to pull apart a string into all its component pieces in one go (sort of like a more complicated version of [`String#split`](https://ruby-doc.org/core/String.html#method-i-split)).

If you wanted to grab all of the `(.+)` matches from your string you'd use `scan` and [`map`](https://ruby-doc.org/core/Array.html#method-i-map):

```
array_of_ids = str.scan(/org-id:\s+(.+)\n/).map(&:first) 
```

but you'd only bother with that if you knew there would be several org-ids in `str`. Scan will also leave `$&`, `$1`, ... set to the values for the last match in the `scan`; but if you're using `scan` you'll be looking for several matches at once so those globals won't be terribly useful.

* * *

The three regex approaches (`[]`, `=~`, and `scan`) offer similar functionality but they fill different niches. You could do it all with `scan` but that would be pointlessly cumbersome unless you were an orthogonality bigot and then you certainly wouldn't be working in Ruby except under extreme duress so it wouldn't matter.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T23:15:28.590

这是匹配和捕获之间的区别。Str[regex] 返回与整个正则表达式匹配的整个片段。$1 仅代表第一个 () 子句捕获的匹配部分。*

# php - 数据库凭据的安全存储

> ID：10825367
> 
> 赞同：4
> 
> 时间：2012-05-30T22:50:00.203
> 
> 标签：php, database, security

最近有一个大问题，我的网络托管公司搞砸了，我的所有 php 文件都以纯文本显示。出于显而易见的原因，这对我来说是一个主要问题。主要是因为mysql数据库细节被暴露了。

我现在正试图改变我的 php 文件获取数据库登录信息的方式，这样即使托管公司让我失望，这种情况也不会再发生。

我当前的设置如下所示：

```
 include 'info.php';

    class Login {

var $host;
var $username;
var $password;
var $db;
var $url; 
```

info.php 里面是数据库的用户名、密码等。我想让它永远无法查看 info.php 文件，并且只有我的 .php 文件才能访问 info.php 以获取登录信息。

我该如何设置？这对我来说有点棘手，所以请不要苛刻，如果描述不好，请-1我..只要问，我会清除我描述中的任何空白。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-30T22:52:32.053

只需放置`info.php`在您的 webroot 之外。这样，您可以包含它，但如果您的网络托管 f*#$ 起来，其他人无法查看该文件，即使是纯文本。

然后你会像这样包含它：

`include('../info.php');`

这样，即使有人发现您有一个名为`info.php`存储您所有密码的文件，他们也无法将浏览器指向该文件。

以上将是理想和最防水的解决方案。但是，如果由于权限而无法做到这一点，则另一种选择是将所有敏感文件放在一个目录中，并阻止使用`.htaccess`文件直接访问该目录。

在要阻止访问的目录中，放置一个`.htaccess`包含以下内容的文件：

`deny from all`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T22:57:07.907

如果由于某种原因 xbonez 的答案不起作用（可以说一个人无权访问非 document_root 文件夹）..您可以通过使用 .htaccess 来实现相同的目的

```
<files info.php>
 order allow,deny
 deny from all
</files> 
```

这在理论上（未经测试）应该保护文件不被浏览器使用，但不阻止 php 包含所述文件。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-05-30T22:56:45.540

为示例“requests.php”创建重定向到文件的表单，并为所有请求打开它。如果您的数据正确重定向到特定页面，如果不这样做，则在开关结束时放置另一个重定向.这样用户就看不到那个页面了。不要把html或其他东西放在那里-只有逻辑。

# email - iOS应用程序在没有用户干预的情况下无法发送邮件是真的吗？

> ID：10825368
> 
> 赞同：0
> 
> 时间：2012-05-30T22:50:04.287
> 
> 标签：email, ios5

我想让我的应用程序发送一封电子邮件，但无需用户按下`send`按钮。这个想法是用户在他的手机上生成内容，并且内容会自动发送到他的邮箱（作为附件！） - 所以这不像我在做任何隐蔽或垃圾邮件。

[这个问题](https://stackoverflow.com/questions/9441639/send-mail-from-iphone-app-without-using-user-interaction-ios5)似乎是说没有办法绕过那个`send`按钮，或者有吗？那个`SKPSMTPMessage`功能呢？我可以为此提供我自己的 SMTP 信息，并实现我想要的无按钮电子邮件发送吗？支持附件吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T23:01:48.257

如果 iOS 不允许这样做，您可以创建一个 Web 服务来接受您的内容然后发送它。编辑：您仍然必须处理凭据 - 毕竟，您不想创建可以被垃圾邮件发送者使用的服务。

# .net - 如何检查数组上的扩展方法是否具有特定大小？

> ID：10825372
> 
> 赞同：1
> 
> 时间：2012-05-30T22:50:18.067
> 
> 标签：.net, vb.net

我正在使用基于数组的扩展方法，我想知道是否有一种简单的方法来检查数组是否有指定的大小，而不是我复制粘贴

```
 if array.count != 1000
      throw new exception "size of the array does not match" 
```

在大约 50 次扩展中

这是我使用的一小部分扩展，我得到了更多

```
<Extension()>
Public Function IsWhite(ByVal board() As bitPiece, ByVal pos As Integer) As Boolean
    Return (board(pos) And bitPiece.White) = bitPiece.White
End Function

<Extension()>
Public Function IsBlack(ByVal board() As bitPiece, ByVal pos As Integer) As Boolean
    Return (board(pos) And bitPiece.Black) = bitPiece.Black
End Function

<Extension()>
Public Function IsRook(ByVal board() As bitPiece, ByVal pos As Integer) As Boolean
    Return (board(pos) And bitPiece.Rook) = bitPiece.Rook
End Function

<Extension()>
Public Function IsBishop(ByVal board() As bitPiece, ByVal pos As Integer) As Boolean
    Return (board(pos) And bitPiece.Bishop) = bitPiece.Bishop
End Function

<Extension()>
Public Function IsKnight(ByVal board() As bitPiece, ByVal pos As Integer) As Boolean
    Return (board(pos) And bitPiece.knight) = bitPiece.knight
End Function

<Extension()>
Public Function IsQueen(ByVal board() As bitPiece, ByVal pos As Integer) As Boolean
    Return (board(pos) And bitPiece.Queen) = bitPiece.Queen
End Function

<Extension()>
Public Function IsKing(ByVal board() As bitPiece, ByVal pos As Integer) As Boolean
    Return (board(pos) And bitPiece.King) = bitPiece.King
End Function

<Extension()>
Public Function IsPawn(ByVal board() As bitPiece, ByVal pos As Integer) As Boolean
    Return (board(pos) And bitPiece.Pawn) = bitPiece.Pawn
End Function 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T23:11:06.200

由于您的数组并不是真正的数组，而是代表特定的数据结构（棋盘），您是否考虑过为其创建专用类型？

```
class Board
{
    private readonly bitPiece[] board;

    public Board()
    {
        board = new bitPiece[64];
    }

    Public Function IsBlack(ByVal pos As Integer) As Boolean
        Return (board(pos) And bitPiece.Black) = bitPiece.Black
    End Function
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T23:18:16.850

您正在寻找类似的东西：

```
public static void CheckArrLength(this double[] x, int length)
    {
        if (x.Length != length)
            throw new ArgumentException("Invalid Array Size."); 
    } 
```

每个方法都可以像这样调用它：

```
public static void Func(this double[] x)
    {
        x.CheckArrLength(1000);
        ...
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T23:00:41.410

看来您想要类似的东西：

```
public static void AssertLength<T>(this T[] arr, int expectedLength)
{
    if (arr == null || arr.Length != expectedLength)
    {
        throw new Exception("Size of the array does not match");
    }
} 
```

您可以使用

```
new[] { 1, 2, 3 }.AssertLength(5); 
```

# javascript - Javascript正则表达式删除双反斜杠

> ID：10825373
> 
> 赞同：1
> 
> 时间：2012-05-30T22:50:19.953
> 
> 标签：javascript, regex

反斜杠正则表达式遇到一些麻烦。我想删除对象的任何字符串属性上存在的所有双反斜杠（或 2 的任何倍数）。我不想删除单个反斜杠，也不想删除奇数个反斜杠中的最后一个反斜杠（例如，在一组五个连续的反斜杠 \\\\\ -> \ 中留下一个反斜杠）。

代码在这里：

[http://jsfiddle.net/59Zau/](http://jsfiddle.net/59Zau/)

```
//removes all dual backslahes on all string properties on an object
var removeDualBackslash = function (obj) {
    var ret = null;
    if (typeof(obj) == "string") {
        obj = obj.replace(/\\\\/g,"");
        return obj;
    } else if (typeof(obj) == "number") {
        return obj;
    } else if (typeof(obj) == "array") {
        ret = [];
    } else {
        ret = {};
    }
    for (var key in obj)
        ret[key] = removeDualBackslash(obj[key]);
    return ret;
};

var oJSON = {"t4m_data_in":{"no_data":"No data \\passed in."}};

oJSON = removeDualBackslash(oJSON);

console.log(oJSON.t4m_data_in.no_data);​ 
```

从 console.log 可以看出，其中一个反斜杠仍然存在。有谁知道我需要什么正则表达式来删除它们？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-30T22:57:12.817

问题出在您的 JSON 字符串中。`"\\"`已经有一个反斜杠。

```
>> console.log("No data \\passed in");
No data \passed in 
```

您确定不想只删除所有反斜杠吗？

```
obj = obj.replace(/\\/g,""); 
```

这样做会删除文字反斜杠，`"\\"`但仍会保留其他转义序列，`"\n"`因为在这些情况下，反斜杠只是在字符串文字中，而不是在实际字符串中。

# php - PHP 用一个 HTML Break 替换双行

> ID：10825380
> 
> 赞同：2
> 
> 时间：2012-05-30T22:51:10.063
> 
> 标签：php, replace, double, line, break

我正在尝试用`<BR>`标签替换我服务器上的所有 \n\n ，以便单个 \n 不会变成`<BR>`.

例子：

```
Hello,\n\nThis is an\nexample.\n\nThanks! 
```

去：

```
Hello,<BR>This is an\nexample,<BR>Thanks! 
```

（注意单个 \n 没有被替换）

当我在 PHP 中执行以下操作时，它不会用中断替换这两行：

```
$str = str_replace("\n\n", "<br />", $str); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-30T22:55:19.680

您`\n`实际上是`\r\n`（这意味着输入来自 Windows 操作系统），我建议您首先使用以下正则表达式将换行符标准化为 *nix 标准：

```
$str = preg_replace('~\r\n?~', "\n", $str); 
```

然后，您的原始代码段将起作用（[演示](http://codepad.org/NZOSUDCr)）：

```
$str = str_replace("\n\n", '<br />', $str); 
```

* * *

你也可以这样做：

```
$str = str_replace("\r\n\r\n", '<br />', $str); 
```

但如果输入来自 Linux 或旧的 Mac OS（仅使用`\r`），这将不起作用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-30T22:53:09.300

你需要双重转义你的角色：

尝试：

```
$str = str_replace("\\n\\n", "<br />", $str); 
```

# python - Dive into Python 3 中的示例代码

> ID：10825383
> 
> 赞同：2
> 
> 时间：2012-05-30T22:51:54.120
> 
> 标签：python

我正在阅读 Mark Pilgrim 的 Dive into Python 3。他给出了名词复数形式的“必杀技”代码。我的问题是：第 30 行和第 31 行的代码是否必要？没有它们，该程序似乎运行良好。添加它们有什么好处？谢谢

```
 import re
    def build_match_and_apply_functions(pattern, search, replace):
        def matches_rule(word):
            return re.search(pattern, word)
        def apply_rule(word):
            return re.sub(search, replace, word)
        return (matches_rule, apply_rule)

def plural(noun):
    for matches_rule, apply_rule in rules:
        if matches_rule(noun):
            return apply_rule(noun)
    raise ValueError('no matching rule for {0}'.format(noun))

class LazyRules:
    rules_filename = 'plural6-rules.txt'
    def __init__(self):
        self.pattern_file = open(self.rules_filename, encoding='utf-8')
        self.cache = []

    def __iter__(self):
        self.cache_index = 0
        return self

    def __next__(self):
        self.cache_index += 1
        if len(self.cache) >= self.cache_index:
            return self.cache[self.cache_index - 1]

##Line 30:        if self.pattern_file.closed:
##Line 31:            raise StopIteration

        line = self.pattern_file.readline()
        if not line:
            self.pattern_file.close()
            raise StopIteration

        pattern, search, replace = line.split(None, 3)
        funcs = build_match_and_apply_functions(pattern, search, replace)
        self.cache.append(funcs)
        return funcs

rules = LazyRules()
nouns=['fox', 'horse', 'cheetah','ad', 'quay', 'vacancy']
for noun in nouns:
    print (noun)
    print(plural(noun)+'\n')

## plural6-rules.txt:
##[sxz]$ $ es
##[^aeioudgkprt]h$ $ es
##[^aeiou]y$ y$ ies
##$   $   s 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T23:16:05.723

[是的，正如书中解释](http://docs.activestate.com/activepython/3.2/diveintopython3/html/iterators.html#autopre13)的那样，这些行是必要的（见注 2）。

在之前的迭代中，模式文件可能已经关闭。

通过 raise `StopIteration`，一个 for 循环将优雅地退出（见[注 5](http://docs.activestate.com/activepython/3.2/diveintopython3/html/iterators.html#autopre6)）

如果你不这样做`raise StopIteration`，下一行将尝试从一个关闭的文件中读取。

```
line = self.pattern_file.readline() 
```

这会导致`ValueError`.

要演示这些行何时运行，请尝试删除`plural6-rules.txt`文件的最后一行（匹配所有内容），然后键入以下内容。

```
>>> from plural6 import plural
>>> plural("fox") # matches the first rule
'foxes'
>>> plural("foo") # does not match any rules. file is closed.
>>> plural("foo") # We have removed the check, we will try to read from a closed file
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "plural6.py", line 50, in plural
    for matches_rule, apply_rule in rules:
  File "plural6.py", line 36, in __next__
    line = self.pattern_file.readline()
ValueError: I/O operation on closed file. 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-30T23:39:48.897

它们不是必需的，因为代码只向下几行（当`readline()`返回一个空字符串时关闭文件，表示文件结束）然后引发`StopIteration`。没有文件会从*先前*的迭代中关闭的情况。好吧，我想如果你`next()`在文件关闭后继续调用它，但你使用的代码并没有这样做。

一般来说，该代码很糟糕。这是那本书的典型吗？如果是这样，请将其扔掉并尝试另一个。

# c++ - C++ 使用来自不同文件的类

> ID：10825384
> 
> 赞同：6
> 
> 时间：2012-05-30T22:52:01.623
> 
> 标签：c++, class, inheritance, interface

我正在尝试编写一系列程序，它们使用相同的主（main.cpp）文件，但具有不同的辅助源文件（object1.cpp、object2.cpp 等）。所以我将基本上像这样编译它们：

```
g++ -o program1.exe main.cpp object1.cpp
g++ -o program2.exe main.cpp object2.cpp 
```

我想要做的是让 objectN.cpp 定义一个实现了某些方法的类，该类将从主文件中调用。源代码如下所示：

头文件 (object.hpp)

```
#ifndef INCLUDE_OBJECT_HPP
#define INCLUDE_OBJECT_HPP

class MyObjectInterface
{
public:
  MyObjectInterface();
  virtual ~MyObjectInterface() {};
  virtual void MethodA() = 0;
  virtual void MethodB() = 0;
};

#endif 
```

对象1.cpp

```
#include <iostream>
#include "object.hpp"

using namespace std;

class MyObject : public MyObjectInterface
{
private:
  int member;

public:
  MyObject(int a)  { member = a; }
  void MethodA() { cout << member << endl; }
  void MethodB() { cout << member*2 << endl; }
}; 
```

主文件

```
#include <iostream>
#include "object.hpp"

using namespace std;

MyObjectInterface *x;

int main()
{
  x = new MyObject(1);
  x->MethodA();
  x->MethodB();
  return 0;
} 
```

object2.cpp 将具有与 object1.cpp 类似的结构，但该类将具有不同的数据成员。

我无法让它工作，因为我需要在 main.cpp 中包含 MyObject 的类声明。但是每个 object*.cpp 文件都会用不同的成员声明 MyObject 类，所以我不能简单地创建一个单独的 object.hpp 标头并将其包含在 main 中，因为我需要不同的标头用于不同的对象。main 唯一需要知道的是方法。

我希望我已经清楚地解释了这个问题；如果不发表评论，我会尽力澄清。似乎应该有一种非常简单的方法来做这样的事情，但我想不通。

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-30T23:01:59.260

> 不能让它工作，因为我需要在 main.cpp 中包含 MyObject 的类声明

不，你没有。制作工厂方法

*。H：

```
MyObjectInterface* makeObject(); 
```

*.cpp：

```
MyObjectInterface* makeObject(){
    return new MyObject;
} 
```

但是，在不同文件中声明具有相同结构的同名类可能会在某些情况下混淆*某些编译器（很少见，但它可能会发生）。*

此外，更好的解决方案是重新考虑您的程序结构。因为您的派生类应该有不同的数据成员，这意味着您可能需要访问这些数据成员。因为您可能需要访问这些 memebrs，所以您需要了解有关该类的*一些*信息，因此您必须将其声明放入标题中。

另一个问题是类代表某种概念，因此选择唯一名称应该是相当简单的。如果您有许多具有相同名称的不同类，则可能存在设计问题 - 您的类不代表独特的概念，并且您不必要地创建了太多类。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-30T23:01:31.540

一种可能的解决方案是在以下位置声明此函数`object.hpp`：

```
MyObjectInterface * createInstance(); 
```

并在两个`.cpp`文件中像这样实现它：

```
MyObjectInterface * createInstance() {
    return new MyObject();
} 
```

并更换

```
x = new MyObject(1); 
```

经过

```
x = createInstance(); 
```

# objective-c - 好奇心：在同一方法内的另一个线程中执行代码？

> ID：10825385
> 
> 赞同：0
> 
> 时间：2012-05-30T22:52:08.270
> 
> 标签：objective-c, xcode, multithreading, macos, cocoa

我发布这个是因为我对某事感到好奇。例如，让我们看一下这个示例代码（仅作为示例）：

```
 -(void)doSomething{
         for (int i=0;i<10000000000;i++){
             nslog(@"%i", int);
         }
         nslog(@"i'm done!");
    } 
```

有什么方法可以`for loop`在同一个方法（`doSomething`）中但在另一个线程中执行而不需要执行类似`NSOperationQueue`（`@selector`）之类的操作？
并且 NSLog 必须在`for loop`完成后才能执行。
如果有什么东西，示例代码将不胜感激！
谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T22:54:03.933

是的，您可以将 GCD 与`dispatch_async`. 但是`i'm done`在所有迭代完成后，不会执行 NSLog。这没有意义，因为它必须在主（主）线程上等待后台（迭代）线程完成。

如果您不想阻止 UI 的主要方法，则必须在后台线程中执行整个方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T23:18:30.143

您正在编写的代码的性质是什么？你想加速昂贵的`for`循环吗？您是希望包含方法在循环完成之前一直阻塞，还是只想`NSLog()`在循环完成后执行？在不了解更多信息的情况下，以下是您的一些选择：

```
- (void)doSomething
{
  dispatch_apply(10000000000, dispatch_get_global_queue(), ^(size_t i) {
    NSLog(@"%d", i);
  });

  NSLog(@"I'm done!");
} 
```

或者

```
- (void)doSomething
{
  dispatch_queue_t calling_queue = dispatch_get_current_queue();
  dispatch_async(dispatch_get_global_queue(), ^{
    for (int i = 0; i < 10000000000; i++)
    {
      NSLog(@"%d", i);
    }

    dispatch_async(calling_queue, ^{
      NSLog(@"I'm done!");
    });
  });
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T01:49:50.503

我相信`dispatch_asyc`按顺序调用传递给它的每个块，所以理论上你可以运行：

```
for (int i=0;i<10000000;i++){
    dispatch_async(dispatch_get_global_queue(), ^{
        for (int x=i*1000;x<1000;x++){ NSLog(@"%i", x); }
    });
}
dispatch_async(dispatch_get_global_queue(), ^{
    NSLog(@"i'm done!");
} 
```

我还没有测试过，但是一次将这么多项目放在队列中可能会很长。

# svn - 致力于 svn 的第 3 方库：更好地签入多个文件或 zip？

> ID：10825386
> 
> 赞同：0
> 
> 时间：2012-05-30T22:52:11.827
> 
> 标签：svn

在将第三方库提交到源代码控制时，我经常将其作为存档，并将解压缩作为构建步骤。我想这个想法是可能涉及数千个文件，并且预计它们不会改变，因此将它们全部单独存储似乎有很多开销。

不幸的是，这种方法有时会让人头疼，包括在进行完整构建时，开发人员必须等待解压缩。有时依赖检查（以查看是否需要解压缩）无论出于何种原因都不能可靠地工作。

我在网上找不到任何关于向 Subversion 存储库添加大量（在我当前正在升级的一个库的情况下，数万个）文件是否存在缺点的信息。除了占用更多空间（超过 1 GB，而不是小于 250 MB）之外，还有什么理由让人们知道我应该犹豫将整个库作为单独的文件提交？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T23:11:48.150

这是Java还是C还是什么类型的开发？

无论哪种方式，您都可以使用[Artifactory](http://www.jfrog.com/products.php)来存储第三方库而不是源代码控制。如果是 Java，请使用 Maven 或 Ant 和 Ivy。如果是 C 或 C++，请使用 wget 或 curl 获取 Makefile 中的第三方库。要存储它们，您可以使用 Maven 的 deploy:deploy-file 将它们放入存储库。或者，如果您使用 Jenkins，您可以使用 Jenkins 的内置功能与 Maven 存储库对话来为您完成任务。

这有几个优点：

*   您可以更好地跟踪版本编号。当第三方库被检入存储库时，人们会忘记那是什么版本。例如，您`foo.so`将 1.2 版签入到您的存储库中。一年后，你不记得它是哪个版本了。其他人决定签入新版本的`foo.so`. 再一次，你开始失去你所拥有的。由于这是一个编译依赖项，因此您需要知道。
*   即使这些是自行生成的第三方依赖项，（您有一个构建`foo.so`用于其他项目的项目），最好将它们存储在像 Artifactory 这样的发布存储库中。同样，您跟踪版本控制。
*   删除过时的第三方依赖项很容易。在 Subversion 中，即使您`svn rm`对文件执行了操作，依赖项仍保留在存储库中。节省大量磁盘空间。
*   您不必担心在构建中保留过时的第三方文件的依赖膨胀，因为您不知道是否需要它们。由于您必须指定每个依赖项，因此开发人员更容易跟踪。

# java - ClassCastException 与 JDBM2

> ID：10825387
> 
> 赞同：1
> 
> 时间：2012-05-30T22:52:28.720
> 
> 标签：java, persistence

我有一个大地图，我想使用 JDBM2（JDBM2 的第一次用户）来保存它。

我对 JDBM2 演示程序进行了一些简单的编辑。但是，当我提取存储值时，我得到了 ClassCast Exceptions。

这是代码。任何帮助将不胜感激。

[另外，是否可以以这种方式使用JDBM2。这些示例不会构建、关闭、重新打开、使用。他们建造、使用、关闭]

```
public static void main(String[] args) throws IOException {

    /** open db */
    RecordManager recman = RecordManagerFactory.createRecordManager("hugedata");
    PrimaryTreeMap<String, double[][]> db = recman.treeMap("hugemap");

    /** insert some records */
    int aBigNumber = 1000;
    int aSmallerNumber = 100;
    for (long i = 0; i < aBigNumber; i++) {

        db.put(Long.toString(i), new double[9][9]);

        if (i % aSmallerNumber == 0) {
            /** Commit periodically, otherwise program would run out of memory */
            recman.commit();
            System.out.println(i);
        }
    }

    recman.commit();
    recman.close();

    //now that the database is built we need to load it from file...otherwise we are cheating

    //open the database to use it...
    recman = RecordManagerFactory.createRecordManager("hugedata");
    PrimaryTreeMap<String, double[][]> revivedDB = recman.treeMap("hugemap");

    //ClassCastException thrown here
    double[][] aStoredValue = revivedDB.get(Long.toString(10));

    recman.close();

    System.out.println("DONE");

} 
```

# ruby-on-rails - 可以使用 MongoDB map/reduce 迁移数据吗？

> ID：10825401
> 
> 赞同：0
> 
> 时间：2012-05-30T22:53:28.350
> 
> 标签：ruby-on-rails, mapreduce, mongoid

我有一个大型集合，我想通过填充一个字段来修改所有文档。

一个简单的例子可能是缓存每个帖子的评论计数：

```
class Post
  field :comment_count, type: Integer
  has_many :comments
end
class Comment
  belongs_to :post
end 
```

我可以通过以下方式串行运行它：

```
Post.all.each do |p|
  p.udpate_attribute :comment_count, p.comments.count
end 
```

但是运行需要 24 小时（大型集合）。我想知道 mongo 的 map/reduce 是否可以用于此？但我还没有看到一个很好的例子。

我想你会映射出评论集合，然后将减少的结果存储在帖子集合中。我在正确的轨道上吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-03T04:37:50.830

您可以使用 MongoDB map/reduce 来“帮助”迁移数据，遗憾的是您不能使用它来进行完全的服务器端迁移。你走在正确的轨道上，基本的想法是：

1.  将每个评论映射到 emit(post_id, {comment_count: 1}) ---> {_id: post_id, value: {comment_count: 1}}
2.  减少到值 {comment_count: N} N 是计数和 ---> {_id: post_id, value: {comment_count: N}}
3.  指定输出选项 {reduce: 'posts'} 以将 map/reduce comment_counts 的结果减少回帖子集合

经过一番广泛的调查，我发现你可以接近，但有一个问题阻止你完全进行服务器端迁移。reduce 的结果具有形状 {_id: KEY, value: MAP_REDUCE_VALUE}。我们现在被这个形状困住了，似乎没有办法绕过它。因此，您既不能获取此形状之外的完整原始文档作为 reduce 的输入（实际上，您将丢失此形状之外的数据），也不能更新此形状之外的文档作为 reduce 的结果。因此，您的帖子集合的“最终”更新必须通过客户端以编程方式完成。看起来修复这将是一个很好的修改请求。

下面找到一个工作示例，该示例演示了在 Ruby 中使用 MongoDB map/reduce 来计算所有 comment_counts。然后我以编程方式使用 map_reduce_results 集合来更新 posts 集合中的 comment_count。reduce 函数被从尝试中剥离出来： {reduce: 'posts'}

您可以通过一些实验来验证我的答案，或者如果您愿意，我可以根据要求发布完全不工作的服务器端尝试，并使用固定模型完成。希望这有助于理解 Ruby 中的 MongoDB map/reduce。

测试/单元/comment_test.rb

```
require 'test_helper'

class CommentTest < ActiveSupport::TestCase
  def setup
    @map_reduce_results_name = 'map_reduce_results'
    delete_all
  end

  def delete_all
    Post.delete_all
    Comment.delete_all
    Mongoid.database.drop_collection(@map_reduce_results_name)
  end

  def dump(title = nil)
    yield
    puts title
    Post.all.to_a.each do |post|
      puts "#{post.to_json} #{post.comments.collect(&:text).to_json}"
    end
  end

  def generate
    (2+rand(2)).times do |p|
      post = Post.create(text: 'post_' + p.to_s)
      comments = (2+rand(3)).times.collect do |c|
        Comment.create(text: "post_#{p} comment_#{c}")
      end
      post.comments = comments
    end
  end

  def generate_and_migrate(title = nil)
    dump(title + ' generate:') { generate }
    dump(title + ' migrate:') { yield }
  end

  test "map reduce migration" do
    generate_and_migrate('programmatic') do
      Post.all.each do |p|
        p.update_attribute :comment_count, p.comments.count
      end
    end
    delete_all
    generate_and_migrate('map/reduce') do
      map = "function() { emit( this.post_id, {comment_count: 1} ); }"
      reduce = <<-EOF
        function(key, values) {
          var result = {comment_count: 0};
          values.forEach(function(value) { result.comment_count += value.comment_count; });
          return result;
        }
      EOF
      out = @map_reduce_results_name #{reduce: 'posts'}
      result_coll = Comment.collection.map_reduce(map, reduce, out: out)
      puts "#{@map_reduce_results_name}:"
      result_coll.find.each do |doc|
        p doc
        Post.find(doc['_id']).update_attribute :comment_count, doc['value']['comment_count'].to_i
      end
    end
  end
end 
```

测试输出（抱歉混用 JSON 和 Ruby 检查）

```
Run options: --name=test_map_reduce_migration

# Running tests:

programmatic generate:
{"_id":"4fcae3bde4d30b21e2000001","comment_count":null,"text":"post_0"} ["post_0 comment_0","post_0 comment_1","post_0 comment_2"]
{"_id":"4fcae3bde4d30b21e2000005","comment_count":null,"text":"post_1"} ["post_1 comment_1","post_1 comment_0","post_1 comment_2","post_1 comment_3"]
{"_id":"4fcae3bde4d30b21e200000a","comment_count":null,"text":"post_2"} ["post_2 comment_1","post_2 comment_3","post_2 comment_0","post_2 comment_2"]
programmatic migrate:
{"_id":"4fcae3bde4d30b21e2000001","comment_count":3,"text":"post_0"} ["post_0 comment_0","post_0 comment_1","post_0 comment_2"]
{"_id":"4fcae3bde4d30b21e2000005","comment_count":4,"text":"post_1"} ["post_1 comment_1","post_1 comment_0","post_1 comment_2","post_1 comment_3"]
{"_id":"4fcae3bde4d30b21e200000a","comment_count":4,"text":"post_2"} ["post_2 comment_1","post_2 comment_3","post_2 comment_0","post_2 comment_2"]
map/reduce generate:
{"_id":"4fcae3bee4d30b21e200000f","comment_count":null,"text":"post_0"} ["post_0 comment_0","post_0 comment_1"]
{"_id":"4fcae3bee4d30b21e2000012","comment_count":null,"text":"post_1"} ["post_1 comment_2","post_1 comment_0","post_1 comment_1"]
{"_id":"4fcae3bee4d30b21e2000016","comment_count":null,"text":"post_2"} ["post_2 comment_0","post_2 comment_1","post_2 comment_2","post_2 comment_3"]
map_reduce_results:
{"_id"=>BSON::ObjectId('4fcae3bee4d30b21e200000f'), "value"=>{"comment_count"=>2.0}}
{"_id"=>BSON::ObjectId('4fcae3bee4d30b21e2000012'), "value"=>{"comment_count"=>3.0}}
{"_id"=>BSON::ObjectId('4fcae3bee4d30b21e2000016'), "value"=>{"comment_count"=>4.0}}
map/reduce migrate:
{"_id":"4fcae3bee4d30b21e200000f","comment_count":2,"text":"post_0"} ["post_0 comment_0","post_0 comment_1"]
{"_id":"4fcae3bee4d30b21e2000012","comment_count":3,"text":"post_1"} ["post_1 comment_2","post_1 comment_0","post_1 comment_1"]
{"_id":"4fcae3bee4d30b21e2000016","comment_count":4,"text":"post_2"} ["post_2 comment_0","post_2 comment_1","post_2 comment_2","post_2 comment_3"]
.

Finished tests in 0.072870s, 13.7231 tests/s, 0.0000 assertions/s.

1 tests, 0 assertions, 0 failures, 0 errors, 0 skips 
```

# powershell - 在 Powershell 中获取对象的内存大小

> ID：10825404
> 
> 赞同：6
> 
> 时间：2012-05-30T22:53:37.187
> 
> 标签：powershell, memory-leaks

我有一个正在尝试执行的（长时间运行的）脚本。不幸的是，当它运行时，powershell 的内存使用量开始攀升。脚本比较简单，看不出有什么明显的内存泄露。但是，我使用的 API 可能表现不佳。

有没有一种简单的方法可以从 powershell 中获取对象的内存大小，所以我可以看看我的怀疑是否正确？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-30T23:40:32.020

也许一个粗略的方法是这样的：

```
$memBefore = (Get-Process -id $pid).WS
# Create object here...
$memAfter = (Get-Process -id $pid).WS
($memAfter - $memBefore) / 1KB 
```

如果是内存泄漏，您可以通过以下方式缓解它：

```
[gc]::Collect() 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-31T05:32:39.670

另一种近似方式：

```
$before = [gc]::GetTotalMemory($true)
$s = "A new string object"
$after = [gc]::GetTotalMemory($true)

($after - $before)/1kb # return the delta in KBytes 
```

# java - 流式广播 mp3 java

> ID：10825405
> 
> 赞同：0
> 
> 时间：2012-05-30T22:53:38.610
> 
> 标签：java, streaming, mp3, radio, javasound

我正在尝试做一个简单的 mp3 播放器，一切都很完美，只是我有一个问题，我不能（播放）流媒体广播 mp3，我在按钮“播放”时收到此消息：

```
Unable to handle format: mpeglayer3, 44100.0 Hz, 16-bit, Stereo, LittleEndian, 
    Signed, 16000.0 frame rate, FrameSize=32768 bits
    Failed to realize: com.sun.media.PlaybackEngine@c88f97
    Error: Unable to realize com.sun.media.PlaybackEngine@c88f97 
```

这是我的代码：

```
private void jButton4ActionPerformed(java.awt.event.ActionEvent evt) {                                         
    String radiourl = direccionurl.getText();
    URL url;
    try {
        url = new URL(radiourl);

        openFile(url);
    } catch (MalformedURLException ex) {
        Logger.getLogger(VentanaInicio.class.getName()).log(Level.SEVERE, null, ex);
    }

   p.start();
}             

public  void openFile(URL url){

    try{
      p = Manager.createPlayer(url);
      p.start();
    }catch (Exception o){
      o.printStackTrace();
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T00:54:29.000

我最近还需要编写一个音频播放器，并在[http://onjava.com/pub/a/onjava/2004/08/11/javasound-mp3.html找到了一篇旧的但很好的文章，其中包含大量示例代码](http://onjava.com/pub/a/onjava/2004/08/11/javasound-mp3.html)

我根据那里的信息编写了一个相当简单的播放器。到目前为止，我只用它来播放文件，但我插入了你的 URL，做了一个 URL.openStream()，然后把它发送到播放器。工作得很好。

# css - Chrome DevTools 自动保存 0.3.2 - 不工作。为什么？

> ID：10825408
> 
> 赞同：1
> 
> 时间：2012-05-30T22:53:59.360
> 
> 标签：css, google-chrome, autosave

我不明白这个。

Going to`http://127.0.0.1:9104/`告诉我 DevTools Autosave 0.3.2 运行良好。

终端控制台记录：`30-05-2012 15:49:50: Saved a stylesheet to /Users/me/Desktop/boxes.css`

但是样式表没有随着我的更改而更新。

我查看了扩展插件控制台是否有任何错误。没有错误。

我已经卸载并重新安装了 Chrome，重新启动了我的计算机，安装了最新版本的 Chrome 等，没有任何变化。

# blackberry - 如何仅在带有物理键盘的小屏幕黑莓上增加字体大小？

> ID：10825412
> 
> 赞同：0
> 
> 时间：2012-05-30T22:54:25.537
> 
> 标签：blackberry, css

我制作了一个移动 web 应用程序，它在所有不同的智能手机（iphone、windows、黑莓和安卓）上看起来都很好，除了黑莓有一个小屏幕和一个物理键盘。在这个特定的黑莓上，字体太小了。仅在这些类型的黑莓上应用不同样式或使字体更大的好方法是什么？

**注意**我的应用在全屏和虚拟键盘的黑莓上看起来很棒。它在肖像和风景中看起来很棒。所以我用来针对小屏幕黑莓+物理键盘的任何解决方案都不能干扰全屏黑莓的操作/化妆品。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T23:11:34.993

解决问题的最佳方法是确定什么物理标准决定何时需要使用更大的字体，然后针对该特定标准进行测试。最好不要尝试检测托管页面的设备类型，而是检测设备的某些特征。

例如，您可以决定如果屏幕尺寸小于 axb，那么您需要更改字体大小。为此，您可以使用完全是 CSS 的媒体查询，当某些屏幕尺寸条件为真时，它会设置不同的字体大小。

我怀疑问题不在于设备具有键盘，而在于具有物理键盘导致的屏幕尺寸限制。因此，您不应该关注它是什么类型的设备或它是否有键盘，而应该关注导致您需要不同设计的屏幕尺寸。然后，键入您的 CSS/HTML 甚至 javascript 以检测该屏幕尺寸并相应地进行调整。

如果您认为 CSS 媒体查询可能是一种有用的方法，则必须确保您最希望此修复的目标设备支持您选择使用的特定 CSS 媒体查询。

以下是 CSS 媒体查询如何工作的一些示例：

[http://css-tricks.com/css-media-queries/](http://css-tricks.com/css-media-queries/)

这是另一篇关于优化黑莓显示和测试的 SO 帖子：

[黑莓媒体查询](https://stackoverflow.com/questions/6404617/blackberry-media-query)

# whitespace - 在 rdlc 文件中隐藏文本框时保留空格

> ID：10825415
> 
> 赞同：6
> 
> 时间：2012-05-30T22:54:43.903
> 
> 标签：whitespace, reportviewer, visibility, rdlc

我创建了一个报告，该报告的左侧有一个图像，该图像基于传入报告的参数有条件地可见。页面右侧还有另一个文本框。

我观察到，当图像的 Hidden 属性设置为“True”时，右侧的文本框会保持在正确的位置。当图像的 Hidden 属性设置为 =IFF(1 = 1, true, true) 时，右侧的文本框向左移动，报表看起来很丑。

我怎样才能让隐藏的对象仍然占用所有必要的空间，并用表达式将其设置为隐藏？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-02T21:50:17.780

为了防止您看到的行为，您可以将一些其他对象（如矩形或一条线）放在您的设计器上与您的图像相同的位置，并让它占用与左侧图像相同的水平空间。

当图像被隐藏时，该对象将保留在那里并防止右侧文本框移动。

我会在设计器中保持这个对象可见，并在运行时设置它的颜色以匹配你的背景颜色（例如，白色），这样你就看不到它了。

我还会给它一些描述性的名称，例如 LineWhichPreventsTextBoxFromMovingWhenImageIsHidden，这样报表的某些未来维护者就不会无意中删除它，从而导致重大更改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-02-26T07:31:57.187

在文本框的情况下，有条件地设置值使我免于像建议的答案那样放置占位符对象。示例代码 `=IIF(First(Fields!SlNo.Value) > 1 , "", First(Fields!MacType.Value))` 这可能对某人有所帮助。

# c - 宏存储在哪里？

> ID：10825421
> 
> 赞同：5
> 
> 时间：2012-05-30T22:55:28.763
> 
> 标签：c, macros, c-preprocessor

如果我在 C 代码中使用宏，例如

```
#define var 10 
```

那么内核分配给进程的空间究竟存储在哪里呢？在堆或 BSS 或全局数据中？或者它只是一个编译器传递中 var 的文本替换？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-30T22:56:57.390

是的。
最后一个

只是文本替换

它由预处理过程执行。一些好的细节可以在[这里找到](http://en.wikipedia.org/wiki/C_preprocessor)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-30T22:57:54.397

类似的预处理器指令`#define`在编译的预处理阶段被相应的文本替换，并且（几乎）从未在最终的可执行文件中表示。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-30T23:06:18.757

“宏”是“编译时的东西”。

它只是在编译之前“替换编译器看到的文本”。

结果（在编译后的代码中）可以是一组操作……一个数据声明……或者什么都没有。

但是“宏”本身就是在预处理器完成之后、编译实际开始之前的古代历史。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-31T04:25:40.587

宏只是文本替换。当被替换时，它们成为代码的一部分，因此存储在代码段中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-30T23:02:13.687

它是对编译器的指令，因此存储在编译器进程空间的表中，而不是您的代码空间。

# .net - 为什么我不能使用 String.Empty 作为默认参数值？

> ID：10825423
> 
> 赞同：10
> 
> 时间：2012-05-30T22:55:36.403
> 
> 标签：.net, string, default-parameters

今天我在构造函数中创建了一个默认参数值。

```
public SomeClass (String something = String.Empty)
{
   // ...
} 
```

编译器抱怨。

> “某物”的默认参数值必须是编译时常量。

我的印象是 String 类上的 Empty 是一个编译时常量。

```
.field public static initonly string Empty 
```

我是否误解了编译时常量的含义，还是我需要接受更多古怪？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-30T22:58:11.817

[这个](https://stackoverflow.com/questions/507923/why-isnt-string-empty-a-constant)SO 问题的公认答案*为什么 String.Empty 不是常量？*是：

使用 static readonly 而不是 const 的原因是与非托管代码一起使用，正如 Microsoft 在 Shared Source Common Language Infrastructure 2.0 Release 中所指出的那样。要查看的文件是 sscli20\clr\src\bcl\system\string.cs。

Empty 常量保存空字符串值。我们需要调用 String 构造函数，以便编译器不会将其标记为文字。

将其标记为文字意味着它不会显示为我们可以从本机访问的字段。

我从CodeProject的这篇方便的[文章中找到了这些信息。](http://www.codeproject.com/KB/dotnet/StringEmpty.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-30T22:57:15.877

`static readonly`字段不是编译时常量。它只是一个静态字段，在其完成初始化的类之后不应更改。

在当前的 .net 实现中，您甚至可以通过反射来更改它，这会导致非常奇怪的行为。

您可以改用`""`它，它作为字符串文字是编译时间常数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-30T22:58:41.913

字段是`readonly`运行时常量。`static`在初始化对象（或类，如果字段为 ）之前，它不会绑定到值。

编译时常量是文字（例如`""`- 本质上与 , 相同`String.Empty`）和任何标记`const`.

# cmd - 运行 sqlcmd 后的命令提示错误级别问题

> ID：10825426
> 
> 赞同：0
> 
> 时间：2012-05-30T22:55:53.740
> 
> 标签：cmd, command-prompt, sqlcmd, errorlevel

我的代码如下：

```
CALL:ECHOCOLOR "Executing on server:[S059D526\TCH] db:CS filename:[9990294_UPDATE_Concessions.sql]." Cyan
SET CURRENT_SCRIPT="9990294_UPDATE_Concessions.sql"
if not exist "9990294_UPDATE_Concessions.sql" (
  CALL:ECHOCOLOR "skipping execution of file [9990294_UPDATE_Concessions.sql].  Possibly it was renamed because it has already ran" Yellow
)
if exist "9990294_UPDATE_Concessions.sql" (
  CALL:ECHOCOLOR "executing script [9990294_UPDATE_Concessions.sql]" Cyan
  sqlcmd -V 1 -r1 -E -S S059D526\TCH -d "CS" -i "9990294_UPDATE_Concessions.sql" -o "9990294_UPDATE_Concessions.sql.run_20120508_12_19_36.log"
)
CALL:ECHORESULT "result [OK=0,ERR=any other]: %errorlevel%" %errorlevel%
if NOT ERRORLEVEL 0 GOTO FINAL_ERROR
if exist "9990294_UPDATE_Concessions.sql" rename "9990294_UPDATE_Concessions.sql" "9990294_UPDATE_Concessions.sql.ok" 
```

我面临的问题是`errorlevel`，因为在我运行数据库脚本后它总是返回 0。这是因为指令`CALL:ECHORESULT "result [OK=0,ERR=any other]: %errorlevel%" %errorlevel%`. 如果脚本运行时出错，它永远不会转到`FINAL_ERROR`. 当我遇到脚本错误时，我不知道如何进行验证以停止该过程。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T02:53:17.220

您的错误检查逻辑是错误的。

`IF ERRORLEVEL N`如果错误级别 >= N，则为真。所以`IF NOT ERRORLEVEL 0`永远不会是真的！（假设错误级别不是负数）。

你想要要么

```
if ERRORLEVEL 1 goto FINAL_ERROR 
```

或者

```
if %ERRORLEVEL% neq 0 goto FINAL_ERROR 
```

另一件事。您确实应该在您尝试测试的命令之后立即测试 ERRORLEVEL。我不知道`:ECHORESULT`例程是如何编码的，但它可能会改变当前的 ERRORLEVEL 值。

# clojure - Clojure：[软] 从 Repl 工作

> ID：10825434
> 
> 赞同：1
> 
> 时间：2012-05-30T22:57:21.510
> 
> 标签：clojure

## 语境

引用 ClojureScript 文档：

> 使用 ClojureScript 时，拥有良好的工作流程至关重要。关于工作流，首先要了解的是，您应该尽可能地使用 REPL。事实上，如果你没有把大部分时间花在 REPL 上，那你就错了。

现在，在我的大部分 Clojure 开发中——我在我的编辑器中工作——并在 REPL 中热重载我的代码。

## 问题：

(1) 有没有人在 repl 而不是在编辑器中对*Clojure进行编码的良好设置？*有什么优势？

(2) Clojure 与 ClojureScript 有什么不同，这使得 ClojureScript 适合直接在 repl 中工作？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T23:19:13.573

1：在你的编辑器中使用 repl 算作 repl ;) 如果你这样做了，那么你已经做对了。如果您的编辑和 yoru repl 未集成，那么我可以向您介绍[slime](https://github.com/technomancy/emacs-starter-kit)和[slimv](http://www.vim.org/scripts/script.php?script_id=2531)。编辑：听起来你已经掌握了这个，所以对于其他读者，特别是对于 vim 用户来说，slimv 确实让这个过程变得更加有趣，它添加了诸如“跳转到函数定义”之类的东西并让你编译一个表单就在您正在编辑它的缓冲区中。**我对使用 slimv**（以及 emacs 上的 slime）让生活变得多么美好充满热情。

2：clojurescript 的不同之处仅在于您的 repl 是在浏览器中运行的。你试过 ClojureScript 中包含的浏览器 repl 吗？

# html - nav 元素浮动不受约束

> ID：10825435
> 
> 赞同：0
> 
> 时间：2012-05-30T22:57:26.867
> 
> 标签：html, css, element, nav

我对新的 HTML5 元素很感兴趣，但是 nav 元素有一个特性，或者我想我不明白。为什么它不与其他元素落入阵容？我的意思是，我的 div 从左到右，从上到下排列。当我添加 nav 元素时，它只是漂浮在左上角的所有内容上。我不知道这是否与 nav 元素本质上相关，或者是否是我排列 div 元素的方式。使用语义导航元素似乎很愚蠢，只需要将它放在 div 中。

**HTML：**

```
<header>
    <div id="logo">
        <a href="redactedurl.com" accesskey="1" tabindex="1" title="Take me home."> 
            <img alt="Logo and link to home page." src="../img/logo.gif" width="200" height="200" />
        </a>
    </div>
    <div id="cobCabRec">
        <h1>RECORD LABEL</h1>
    </div>
    <nav id="menu">
        <div class="menuLink"><a href="bands.php" tabindex="2" accesskey="2">BANDS</a> </div>
        <div id="releases"></div>
        <div id="distro"></div>
        <div id="store"></div>
        <div id="shows"></div>
        <div id="wholesale"></div>
        <div id="links"></div>
    </nav>
</header> 
```

**CSS：**

```
#headWrap{
width:1024px;
height:200px;
background-image:url(../img/headGrating.png);
background-repeat:no-repeat;
background-position:center center;
}
#cobCabRec{
height:63px;
width:824px;
float:right;
}
h1{
font-family:"friz Quadrata TT";
font-size:53px;
margin:0 auto 0;
padding:0;
width:716px;
font-weight:bold;
}
#logo{
float:left;
}
#menu{
width:985px;
height:36px;
background-color:#000;
color:#fff;
padding-top:64px;
}
.menuLink{
font-family:oswald;
font-size:16px;
font-weight:bold;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T16:42:45.890

我需要清理我的花车！感谢 Diodeus 指出了显而易见的问题。

# django - Django heroku 静态目录

> ID：10825443
> 
> 赞同：17
> 
> 时间：2012-05-30T22:58:19.847
> 
> 标签：django, heroku

我是heroku的新手，我尝试了一个没有css的简单django应用程序。

但我只是在我的应用程序中添加了一个 css 文件，当我这样做时：

```
git push heroku master 
```

静态文件收集失败：

```
[...]
-----> Collecting static files
Traceback (most recent call last):
  File "manage.py", line 10, in <module>
    execute_from_command_line(sys.argv)
  File "/tmp/build_2unndirli15s7/.heroku/venv/lib/python2.7/site-packages/django/core/management/__init__.py", line 443, in execute_from_command_line
    utility.execute()
  File "/tmp/build_2unndirli15s7/.heroku/venv/lib/python2.7/site-packages/django/core/management/__init__.py", line 382, in execute
    self.fetch_command(subcommand).run_from_argv(self.argv)
  File "/tmp/build_2unndirli15s7/.heroku/venv/lib/python2.7/site-packages/django/core/management/base.py", line 196, in run_from_argv
    self.execute(*args, **options.__dict__)
  File "/tmp/build_2unndirli15s7/.heroku/venv/lib/python2.7/site-packages/django/core/management/base.py", line 232, in execute
    output = self.handle(*args, **options)
  File "/tmp/build_2unndirli15s7/.heroku/venv/lib/python2.7/site-packages/django/core/management/base.py", line 371, in handle
    return self.handle_noargs(**options)
  File "/tmp/build_2unndirli15s7/.heroku/venv/lib/python2.7/site-packages/django/contrib/staticfiles/management/commands/collectstatic.py", line 163, in handle_noargs
    collected = self.collect()
  File "/tmp/build_2unndirli15s7/.heroku/venv/lib/python2.7/site-packages/django/contrib/staticfiles/management/commands/collectstatic.py", line 104, in collect
    for path, storage in finder.list(self.ignore_patterns):
  File "/tmp/build_2unndirli15s7/.heroku/venv/lib/python2.7/site-packages/django/contrib/staticfiles/finders.py", line 105, in list
    for path in utils.get_files(storage, ignore_patterns):
  File "/tmp/build_2unndirli15s7/.heroku/venv/lib/python2.7/site-packages/django/contrib/staticfiles/utils.py", line 25, in get_files
    directories, files = storage.listdir(location)
  File "/tmp/build_2unndirli15s7/.heroku/venv/lib/python2.7/site-packages/django/core/files/storage.py", line 235, in listdir
    for entry in os.listdir(path):
OSError: [Errno 2] No such file or directory: '/home/kevin/web/django/appheroku/blogapp/static'
 !     Heroku push rejected, failed to compile Python/django app

To git@heroku.com:[...]
 ! [remote rejected] master -> master (pre-receive hook declined)
error: failed to push some refs to 'git@heroku.com:[...]' 
```

这是我的settings.py：

```
[...]
STATIC_ROOT = '/home/kevin/web/django/appheroku/staticfiles'

STATIC_URL = '/static/'

STATICFILES_DIRS = (
    '/home/kevin/web/django/appheroku/blogapp/static',
)
[...] 
```

urls.py：

```
 [...]
 if settings.DEBUG:
   urlpatterns += staticfiles_urlpatterns() 
```

档案：

```
web: python appheroku/manage.py collectstatic --noinput; bin/gunicorn_django --workers=4 --bind=0.0.0.0:$PORT appheroku/monblog/settings.py 
```

似乎甚至 '/home/kevin/web/django/appheroku/blogapp/static' 目录存在，它没有被检测到，我不知道为什么。:(

请帮帮我^^

编辑：

现在我的 settings.py 看起来像这样：

```
import os
PROJECT_ROOT = os.path.abspath(os.path.dirname(__file__))
PROJECT_DIR = os.path.join(PROJECT_ROOT,'../blogapp')
[...]
STATIC_ROOT = os.path.join(PROJECT_ROOT,'staticfiles/')
STATIC_URL = '/static/'
STATICFILES_DIRS = (
    os.path.join(PROJECT_DIR,'static/'),
)
[...] 
```

现在静态文件收集步骤似乎运行良好：

```
 -----> Collecting static files
        74 static files copied. 
```

还有另一个问题：在我的 procfile 中，没有找到 'appheroku/manage.py' 、 'bin/gunicorn_django' 和 'appheroku/monblog/settings.py' 。我修复了它，现在我的 procfile 看起来像这样：

```
web: python manage.py collectstatic --noinput; gunicorn_django --workers=4 --bind=0.0.0.0:$PORT monblog.settings 
```

该应用程序不再崩溃，但仍然没有 CSS。这是日志：

```
'2012-05-31T17:35:16+00:00 heroku[router]: GET xxxx-xxxx-number.herokuapp.com/ dyno=web.1 queue=0 wait=0ms service=85ms status=200 bytes=1054
2012-05-31T17:35:17+00:00 heroku[router]: GET xxxx-xxxx-number.herokuapp.com/static/css/style.css dyno=web.1 queue=0 wait=0ms service=5ms status=404 bytes=2088
2012-05-31T17:35:17+00:00 heroku[router]: GET xxxx-xxxx-number.herokuapp.com/static/js/jquery-1.7.2.min.js dyno=web.1 queue=0 wait=0ms service=5ms status=404 bytes=2115' 
```

编辑3：

是的 ！它有效^^问题出在我的urls.py中。我写 ：

```
[...]
if not settings.DEBUG:
   urlpatterns += staticfiles_urlpatterns() 
```

代替

```
 [...]
 if settings.DEBUG:
   urlpatterns += staticfiles_urlpatterns() 
```

错误不在我的信息中。是的，真的很难帮助我。(对不起)我觉得自己好笨^^'

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-31T01:20:26.783

`STATIC_ROOT`问题是在 Heroku 服务器中找不到您使用的绝对路径。

要解决它，请考虑以下方法。

在您的 settings.py 中：

```
PROJECT_ROOT = os.path.abspath(os.path.dirname(__file__))
STATIC_ROOT= os.path.join(PROJECT_DIR,'staticfiles/')
STATICFILES_DIRS = (
    os.path.join(PROJECT_ROOT,'static/'),
) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-31T00:06:24.580

你正在路上。发生的事情是 Heroku 正在尝试使用您的机器上本地存在但 Heroku 服务器上不存在的 STATICFILES_DIRS 设置 (/home/kevin/web/django/appheroku/blogapp/static)。

一个简单的解决方案是从 staticfiles_dir 变量中删除该行，以便您拥有：

```
STATICFILES_DIRS = () 
```

然后您的默认 STATICFILES_FINDERS 将启动，您应该可以在本地运行您的应用程序以及部署在 Heroku 上。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-06-22T16:39:18.533

对于像我这样进来的人：

就像@eliotk 暗示的那样，

```
PROJECT_ROOT = os.path.abspath(os.path.dirname(__file__))
STATIC_ROOT= os.path.join(PROJECT_DIR,'staticfiles/')
STATICFILES_DIRS = () 
```

这是您要避免`FileNotFoundError: [Errno 2] No such file or directory:`错误或`OSError: [Errno 30] Read-only file system:`错误的配置。

# postgresql - 使用参数而不是硬编码字符串时，Postgres 查询非常慢

> ID：10825444
> 
> 赞同：6
> 
> 时间：2012-05-30T22:58:21.237
> 
> 标签：postgresql, symfony, doctrine-orm, postgresql-9.1, sql-execution-plan

我遇到了这个 Postgres 问题，如果我使用参数而不是在查询字符串上硬编码其值，则执行相同的查询需要很长时间。列名是“media_type”，它是一个 VARCHAR(20)。我使用 Symfony2 和 Doctrine2 ORM 从 PHP 运行这些查询，并且有问题的表有大约 1.000.000 条记录。

我的查询有问题吗？会不会是 Postgres 配置问题？

**1 - media_type 的硬编码值**

```
duration: 5.365 ms  parse pdo_stmt_00000001: SELECT id,site_id FROM item where media_type = 'Collection' AND enabled = 'true' AND site_id = $1 AND user_id = $2 ORDER BY id DESC LIMIT $3 OFFSET $4
duration: 0.142 ms  bind pdo_stmt_00000001: SELECT id,site_id FROM item where media_type = 'Collection' AND enabled = 'true' AND site_id = $1 AND user_id = $2 ORDER BY id DESC LIMIT $3 OFFSET $4
parameters: $1 = '1', $2 = '1', $3 = '100', $4 = '0'
duration: 8.667 ms  execute pdo_stmt_00000001: SELECT id,site_id FROM item where media_type = 'Collection' AND enabled = 'true' AND site_id = $1 AND user_id = $2 ORDER BY id DESC LIMIT $3 OFFSET $4
parameters: $1 = '1', $2 = '1', $3 = '100', $4 = '0' 
```

执行计划：

```
duration: 8.640 ms  plan:
    Query Text: SELECT id,site_id FROM item where media_type = 'Collection' AND enabled = 'true' AND site_id = $1 AND user_id = $2 ORDER BY id DESC LIMIT $3 OFFSET $4
    Limit  (cost=8.38..8.38 rows=1 width=12) (actual time=8.516..8.595 rows=24 loops=1)
      Buffers: shared hit=10 read=15
        ->  Sort  (cost=8.38..8.38 rows=1 width=12) (actual time=8.505..8.530 rows=24 loops=1)
            Sort Key: id
            Sort Method: quicksort  Memory: 26kB
            Buffers: shared hit=10 read=15
            ->  Index Scan using item_media_type_index on item  (cost=0.00..8.37 rows=1 width=12) (actual time=7.955..8.397 rows=24 loops=1)
                    Index Cond: ((media_type)::text = 'Collection'::text)
                    Filter: (enabled AND (site_id = $1) AND (user_id = $2))
                    Buffers: shared hit=8 read=15 
```

**2 - 使用 media_type 的参数（SLOWER）**

```
duration: 5.557 ms  parse pdo_stmt_00000001: SELECT id,site_id FROM item where media_type = $1 AND enabled = 'true' AND site_id = $2 AND user_id = $3 ORDER BY id DESC LIMIT $4 OFFSET $5
duration: 1.322 ms  bind pdo_stmt_00000001: SELECT id,site_id FROM item where media_type = $1 AND enabled = 'true' AND site_id = $2 AND user_id = $3 ORDER BY id DESC LIMIT $4 OFFSET $5
parameters: $1 = 'Collection', $2 = '1', $3 = '1', $4 = '100', $5 = '0'
duration: 71564.998 ms  execute pdo_stmt_00000001: SELECT id,site_id FROM item where media_type = $1 AND enabled = 'true' AND site_id = $2 AND user_id = $3 ORDER BY id DESC LIMIT $4 OFFSET $5
parameters: $1 = 'Collection', $2 = '1', $3 = '1', $4 = '100', $5 = '0' 
```

执行计划：

```
duration: 71564.922 ms  plan:
    Query Text: SELECT id,site_id FROM item where media_type = $1 AND enabled = 'true' AND site_id = $2 AND user_id = $3 ORDER BY id DESC LIMIT $4 OFFSET $5
    Limit  (cost=90663.16..181326.31 rows=17184 width=12) (actual time=3.667..71564.864 rows=24 loops=1)
      Buffers: shared hit=183786 read=96585
        ->  Index Scan Backward using item_pkey on item  (cost=0.00..906610.46 rows=171836 width=12) (actual time=3.655..71564.798 rows=24 loops=1)
               Filter: (enabled AND ((media_type)::text = $1) AND (site_id = $2) AND (user_id = $3))
               Buffers: shared hit=183786 read=96585 
```

提前致谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-31T06:46:26.727

这是 PostgreSQL 中一个长期存在的缺陷，从历史上看，它需要一些有趣的规划器调整来解决。它在 PostgreSQL 9.2（现在是测试版）中得到了修复，不过像往常一样感谢 Tom Lane。

> E.1.3.1.3。优化器
> 
> 提高计划者选择参数化计划的能力 (Tom Lane)
> 
> 准备好的语句现在被解析、分析和重写，但不一定是计划好的。当使用参数执行准备好的计划时，计划器可能会为每个常量重新计划它，或者如果其成本接近于特定于常量的计划的成本，它可能会执行通用计划。

请参阅[9.2 beta 发行说明](http://www.postgresql.org/docs/devel/static/release-9-2.html)和[我在 lwn.net 上写的关于此的快速说明](http://lwn.net/Articles/497264/)。[在邮件列表中](http://www.postgresql.org/community/lists/)有很多关于处理准备好的/参数化的语句运行速度比正常语句慢的信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-30T23:56:16.353

当我绑定到一个 SMALLINT 字段并传入一个 Postgres 隐式从 INTEGER 转换为 SMALLINT 的值时，我遇到了一个非常类似的问题。我通过明确演员来修复它。由于 media_type 是 VARCHAR(20) 类型，Postgres 正在从 TEXT 类型进行隐式转换。尝试这个：

`where media_type = $1::VARCHAR(20)`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-31T00:29:41.870

在您的静态、更快的查询中，正在使用 item_media_type_index。在您绑定的较慢查询中，未使用 item_media_type_index。

“item”表中“media_type”列的选择性是什么？如果你做了：

```
SELECT media_type, COUNT(*)
  FROM item
  GROUP BY media_type
  ORDER BY 2 desc 
```

media_types 是否均匀平衡，或者与其他媒体类型相比，'Collection' media_types 是否相对较少？如果“Collection”项目相对较少，那么我会冒险猜测：使用静态查询，解析器知道您正在查询“Collection”，并且可以确定“Collection”的计数较低并且索引可能值得使用。但是在绑定变量的情况下，解析器不知道您使用的是哪个 media_type。其他一些 media_type 值可能占表中记录的很大比例（例如 20%）。在这种情况下，进行扫描甚至比使用索引还要麻烦。解析器需要做出决定，并且恰好决定不使用索引（对于您的情况是错误的，但对于其他 media_type 可能是正确的）。

在这种情况下，如果您知道选择性属性非常偏斜，则答案是硬编码，使用动态 sql 强制延迟解析，或者如果您认为正确，则强制使用索引。

# actionscript-3 - Flash赛车游戏物理

> ID：10825446
> 
> 赞同：2
> 
> 时间：2012-05-30T22:58:41.260
> 
> 标签：actionscript-3, flash, physics, racing

我想做AS3自上而下的赛车游戏。我写了核心代码，但现在我想让游戏更逼真。我需要一些物理知识（加速、转向、漂移等）。问题是我在物理和数学方面很烂。如果有的话，我需要一些材料。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T01:54:38.897

物理引擎适用于像你和我这样“数学很烂”的人。

正如评论中提到的，[Box2D](http://www.box2dflash.org/)可能是最知名且最容易找到的入门教程。

开始：

*   [用于 Flash 和 AS3 的 Box2D 简介](http://active.tutsplus.com/tutorials/games/introduction-to-box2d-for-flash-and-as3/)
*   [Todd 的 Box2D 教程！](http://www.kerp.net/box2d/)

# heroku - 具有 Heroku 和 www 重定向的二级域

> ID：10825449
> 
> 赞同：1
> 
> 时间：2012-05-30T22:58:49.137
> 
> 标签：heroku, dns, hosting, cloud, cname

我一直在阅读关于 DNS 的迷人主题，特别是与 Heroku 和其他云托管平台相关的区域顶点 CNAME 问题。由于 Heroku 强烈建议永远不要使用 A 记录，那么在我的 Heroku 应用程序中使用二级域的最佳方式是什么？

我发现某些付费 DNS 服务（如 DNSimple）提供“别名”记录类型（伪装成 CNAME 的记录），允许您以符合 RFC 的方式将您的二级域映射到 yourapp.herokuapp.com。不幸的是，我目前被注册商 DNS 困住了。

正如 Heroku 建议的那样，我也尝试过对 www 子域进行 CNAME，但似乎没有理想的方法来容纳没有 www 的用户键入的 url。我的注册商 (1and1) 提供的重定向服务有效，但不保留路径。例如，www.mydomain.com/about 重定向到 mydomain.com。

我对使用[http://www.arecord.net/](http://www.arecord.net/)之类的服务犹豫不决，因为它似乎只是另一件可能会破坏的事情。

有没有更好的方法来做到这一点我忽略了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T14:37:14.240

如果您的注册商/DNS 提供商在 DNS 级别不支持 ALIAS 记录或 URL 重定向，则可能值得使用根域上的 A 记录作为备份。在应用程序级别，您可以将用户重定向到`www`子域。

最大的风险是您在根域上指向的 IP 地址可能会中断，但是如果您主要将流量驱动到`www`子域，并且根域上的 A 记录仅用作备份，则它可能不是巨大的交易。即使偶尔中断或需要更新 A 记录，它仍然比仅仅拒绝根域流量更加用户友好。

# c++ - 将 QVariant 中的枚举转换为整数

> ID：10825453
> 
> 赞同：3
> 
> 时间：2012-05-30T22:59:08.897
> 
> 标签：c++, qt, types, enums, metaprogramming

我编写了一个使用 Qt 元类型系统的库。我的库的用户可以提供包装在 QVariant 中的自定义类型的值。稍后在库内部的一些代码中，我需要序列化这个 QVariant。我为几种类型实现了序列化程序，我真的不需要支持 Qt 元类型系统已知的每种类型。我序列化这些值，以便使用 JSON 通过网络发送它们。

但我想要实现的是支持自定义枚举类型，用户必须使用它来注册元类型系统`qtRegisterMetaType<MyEnum>("MyEnum");`。我想通过将它转换为整数类型来序列化这样的枚举。

我尝试过`QVariant::value<int>()`这样的枚举值，但它总是返回 0。`QVariant::canConvert<int>()`返回 false。

**是否有可能（可能使用一些肮脏的黑客攻击）获得包装枚举的整数值？**Qt 如何处理其元类型系统中的枚举值？*当我确定*这是我在这里拥有的枚举值时，也许我可以访问原始`void*`指针。

 *这就引出了下一个问题：**如何检查 Qt 元类型*是否*是用户枚举类型？**

请注意，由于我正在编写库的内部代码，因此我不能使用模板。我唯一的“东西”是 QVariant，没有编译时类型信息。

```
// code in the project using my library:
MyEnum foo;
libraryFunction(foo); 
```

```
// internal library code (note that compile-time type info isn't available):
QVariant foo = getValueAsVariant(...);
if (/* how to check if foo is an enum type? */)
    int enumValue = foo.value<int>(); // not working for enums! 
```

我知道 C++ 编译器可以选择在内部使用任何整数类型（不仅是 32 位的）来存储枚举值。这对我来说是个问题吗？（例如，如果我重新解释`void*`as `int*`。但请记住，`void*`数据是由 QVariant 本身分配的，因此它可能会为带有 . 的枚举分配超过 2 个字节`sizeof == 2`。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-31T01:22:06.723

一个肮脏的技巧是将 QVariant 序列化为 QDataStream，然后将最后 4 个字节反序列化为 int。这并没有回答如何检查枚举类型的问题。我将深入挖掘 moc 输出并更新它。

Leemes 发现它`QMetaObject::enumerator()`会为您提供类中定义的所有元枚举。这足以检查给定的类型名称是否为枚举，因为可以使用`QMetaType::type()`（但在类名和“::”之前）将枚举名称转换为类型 ID。为了从持有枚举的 QVariant 转换为 int，只需将其重新解释`QVariant::constData()`为 int 指针并读取它。有用。*

# ios - Xtify Payload - 服务器错误

> ID：10825456
> 
> 赞同：2
> 
> 时间：2012-05-30T22:59:29.323
> 
> 标签：ios, push, payload, xtify

我正在尝试使用 xtify 向 android 和 iOS 发送推送通知。我能够做到这一点，但是，有效负载信息似乎对我不起作用。如果我删除有效负载，请求会成功，但添加有效负载会导致服务器错误。谁能看看我发送的 json 并告诉我是否做错了什么？

```
{
   "apiKey":"...",
   "appKey":"...",
   "xids":[
      "..."
   ],
   "content":{
      "subject":"chat from billy bob",
      "message":"hey",
      "payload":{
         "UserId":"1",
         "DeviceId":"9"
      }
   }
} 
```

这是服务器返回的错误：HTTP/1.1 500 Internal Server Error Date: Wed, 30 May 2012 22:51:51 GMT Content-Type: text/html;charset=utf-8 Content-Length: 5839 Connection: close

JBoss Web/2.1.3.GA - 错误报告

# HTTP 状态 500 -

**类型**异常报告

**信息**

**描述**服务器遇到一个内部错误 () 阻止它完成这个请求。

**例外**

```
javax.servlet.ServletException: org.codehaus.jackson.map.JsonMappingException: 无法从 START_OBJECT 令牌中反序列化 java.lang.String 的实例
在 [来源：org.apache.catalina.connector.CoyoteInputStream@210c8d4e；行：1，列：199]（通过引用链：com.xtify.api.entities.PushRequest["content"]->com.xtify.api.entities.Content["payload"]）
       com.sun.jersey.spi.container.servlet.WebComponent.service(WebComponent.java:418)
       com.sun.jersey.spi.container.servlet.ServletContainer.service(ServletContainer.java:537)
       com.sun.jersey.spi.container.servlet.ServletContainer.service(ServletContainer.java:708)
       javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
       org.jboss.web.tomcat.filters.ReplyHeaderFilter.doFilter(ReplyHeaderFilter.java:96)

```

**根本原因**

```
org.codehaus.jackson.map.JsonMappingException：无法从 START_OBJECT 令牌中反序列化 java.lang.String 的实例
在 [来源：org.apache.catalina.connector.CoyoteInputStream@210c8d4e；行：1，列：199]（通过引用链：com.xtify.api.entities.PushRequest["content"]->com.xtify.api.entities.Content["payload"]）
       org.codehaus.jackson.map.JsonMappingException.from(JsonMappingException.java:163)
       org.codehaus.jackson.map.deser.StdDeserializationContext.mappingException（StdDeserializationContext.java:219）
       org.codehaus.jackson.map.deser.std.StringDeserializer.deserialize(StringDeserializer.java:44)
       org.codehaus.jackson.map.deser.std.StringDeserializer.deserialize(StringDeserializer.java:13)
       org.codehaus.jackson.map.deser.SettableBeanProperty.deserialize(SettableBeanProperty.java:299)
       org.codehaus.jackson.map.deser.SettableBeanProperty$MethodProperty.deserializeAndSet(SettableBeanProperty.java:414)
       org.codehaus.jackson.map.deser.BeanDeserializer.deserializeFromObject(BeanDeserializer.java:697)
       org.codehaus.jackson.map.deser.BeanDeserializer.deserialize(BeanDeserializer.java:580)
       org.codehaus.jackson.map.deser.SettableBeanProperty.deserialize(SettableBeanProperty.java:299)
       org.codehaus.jackson.map.deser.SettableBeanProperty$MethodProperty.deserializeAndSet(SettableBeanProperty.java:414)
       org.codehaus.jackson.map.deser.BeanDeserializer.deserializeFromObject(BeanDeserializer.java:697)
       org.codehaus.jackson.map.deser.BeanDeserializer.deserialize(BeanDeserializer.java:580)
       org.codehaus.jackson.map.ObjectMapper._readValue(ObjectMapper.java:2704)
       org.codehaus.jackson.map.ObjectMapper.readValue(ObjectMapper.java:1315)
       org.codehaus.jackson.jaxrs.JacksonJsonProvider.readFrom(JacksonJsonProvider.java:419)
       com.sun.jersey.json.impl.provider.entity.JacksonProviderProxy.readFrom(JacksonProviderProxy.java:139)
       com.sun.jersey.spi.container.ContainerRequest.getEntity(ContainerRequest.java:474)
       com.sun.jersey.server.impl.model.method.dispatch.EntityParamDispatchProvider$EntityInjectable.getValue(EntityParamDispatchProvider.java:123)
       com.sun.jersey.server.impl.inject.InjectableValuesProvider.getInjectableValues(InjectableValuesProvider.java:46)
       com.sun.jersey.server.impl.model.method.dispatch.Abs​​tractResourceMethodDispatchProvider$EntityParamInInvoker.getParams(AbstractResourceMethodDispatchProvider.java:153)
       com.sun.jersey.server.impl.model.method.dispatch.Abs​​tractResourceMethodDispatchProvider$ResponseOutInvoker._dispatch(AbstractResourceMethodDispatchProvider.java:203)
       com.sun.jersey.server.impl.model.method.dispatch.ResourceJavaMethodDispatcher.dispatch(ResourceJavaMethodDispatcher.java:75)
       com.sun.jersey.server.impl.uri.rules.HttpMethodRule.accept(HttpMethodRule.java:288)
       com.sun.jersey.server.impl.uri.rules.ResourceClassRule.accept(ResourceClassRule.java:108)
       com.sun.jersey.server.impl.uri.rules.RightHandPathRule.accept(RightHandPathRule.java:147)
       com.sun.jersey.server.impl.uri.rules.RootResourceClassesRule.accept(RootResourceClassesRule.java:84)
       com.sun.jersey.server.impl.application.WebApplicationImpl._handleRequest(WebApplicationImpl.java:1483)
       com.sun.jersey.server.impl.application.WebApplicationImpl._handleRequest(WebApplicationImpl.java:1414)
       com.sun.jersey.server.impl.application.WebApplicationImpl.handleRequest(WebApplicationImpl.java:1363)
       com.sun.jersey.server.impl.application.WebApplicationImpl.handleRequest(WebApplicationImpl.java:1353)
       com.sun.jersey.spi.container.servlet.WebComponent.service(WebComponent.java:414)
       com.sun.jersey.spi.container.servlet.ServletContainer.service(ServletContainer.java:537)
       com.sun.jersey.spi.container.servlet.ServletContainer.service(ServletContainer.java:708)
       javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
       org.jboss.web.tomcat.filters.ReplyHeaderFilter.doFilter(ReplyHeaderFilter.java:96)

```

**note**根本原因的完整堆栈跟踪可在 JBoss Web/2.1.3.GA 日志中找到。

### JBoss Web/2.1.3.GA

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T03:27:14.610

元素类型是 JSON 而不是数组。因此有效负载元素应如下所示：

“有效载荷”：“{'key1'：'value1'，'key2'：'value2'}”

试一试，让我知道结果如何。

迈克尔

# c++ - 如何从 cvNamedWindow 保存图像

> ID：10825459
> 
> 赞同：0
> 
> 时间：2012-05-30T22:59:58.460
> 
> 标签：c++, c, opencv

我需要保存已在 cvNamedWindow 中显示的图像。问题是源图像可能已经更改，所以我需要以某种方式从窗口中获取它。作为替代解决方案，当前显示的帧可以保存在 IplImage 对象中，但也许有人知道如何直接从 cvNamedWindow 获取 IplImage？提前致谢。PS。在 c++ 项目中使用 opencv。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T01:06:42.413

**如果你需要这样做，那你就错了。**

假设您正在使用一个多线程应用程序，该应用程序在第一个线程中捕获帧，并`cvNamedWindow()`在第二个线程中显示它们。在这种情况下，您需要防止这两个线程同时访问该帧：调查**mutexes**。

如果您的应用程序只有一个线程，您需要做的就是`cvWriteFrame()`在`cvNamedWindow()`调用之前执行以将帧保存到磁盘，或者使用以下命令将帧复制到另一个`IplImage`：

```
IplImage* copy_img = cvCreateImage(cvGetSize(orig_img), orig_img->depth, orig_img->nChannels);

cvCopy(orig_image, copy_img, NULL); 
```

完成后不要忘记释放图像以释放分配的资源。

# ruby-on-rails - :only 如何在这个 ruby 代码中工作？

> ID：10825460
> 
> 赞同：2
> 
> 时间：2012-05-30T23:00:02.787
> 
> 标签：ruby-on-rails, ruby

我今天刚开始学习 ruby​​，我对以下代码有疑问。我想知道 ":only =>:show" 究竟是如何影响这里的代码的。我假设如果我们没有“:only =>:show”，那么代码将直接处理身份验证。但是 ":only =>:show" 到底是做什么的呢？谢谢！

```
class PeopleController < ApplicationController

  before_filter :authenticate, :only =>:show

  def index
    @people = ["luke-skywalker", "darth-vader"]
  end

  def show
    @person = params[:id]
  end

  private

  def authenticate
    if params[:id] == "darth-vader"
      redirect_to people_url, :notice => "The page is restricted."
      #this is called the flash message
    end
  end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T23:04:50.363

它是该方法的[哈希](http://apidock.com/ruby/Hash)参数`before_filter`（请参阅[过滤器文档](http://guides.rubyonrails.org/action_controller_overview.html#filters)），表明过滤器方法应该只在“显示”方法之前运行。

`:only`是哈希键，`:show`是映射到`show`控制器方法的符号。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T23:05:05.967

在过滤器之前是一个回调，表示在处理您调用的实际操作之前调用此方法。:only => :show 告诉回调仅对 show 操作执行此操作。如果取出，则在所有操作之前调用该方法

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T23:42:36.117

程序将`Hash`第二个参数中的文字对象传递给方法`before_filter`。

当`Hash`文字是方法的最后一个参数时，Ruby 允许删除`{`and 。`}`

这在诗歌模式中特别有用，`{`否则看起来会开始一个块。逗号被解释为继续`Hash`文字而不是继续参数列表。

试试这个，看看：

```
def f x
  p x
end
f :a => :b, :c => :d
f({:a => :b, :c => :d}) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-30T23:05:35.760

在 ROR 中，过滤器是在操作之前评估的函数或过程。如果您没有另外说明，则过滤器会在每个操作之前进行评估。您可以通过 :only 和 :except 指定哪些操作可能会或可能不会被过滤。

# algorithm - 高效的数据结构搜索算法

> ID：10825461
> 
> 赞同：0
> 
> 时间：2012-05-30T23:00:21.617
> 
> 标签：algorithm, search, data-structures

我正在尝试构建如下所示的数据树，并且我需要一种可以执行以下操作的有效匹配算法。

您可以将此树视为参加课程的先决条件列表。例如，课程 1 有先决条件 3 和 4，课程 3 有先决条件 7 和 8。如果一个人想修读课程 1，他/她必须同时修读课程 3 和 4，或者课程 3 或课程 4 的所有先决条件（所以如果他/她选修了7,8,4，相当于取了3和4）。

现在一个孩子过来说他想参加课程 2，前提是他提前参加了课程 8,9 和 6。我怎样才能快速检查他是否符合条件？

我现在能想到的唯一方法是构建一个包含所有先决条件组合的查找表，并通过它进行检查以找到匹配项。然而，随着树变大（我正在尝试构建一个可能具有 >10,000 个节点的树），这种方法会炸毁我的计算机。

有人对此有什么建议吗？或者更好的是，是否已经有一个定义明确的搜索算法可以处理这种类型的任务？提前致谢。吉姆

![在此处输入图像描述](../Images/19bf4aa2d48949b03ca6f6c3f8fbe3da.png)

图：一些任意数据树

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T23:11:57.227

只需以简单的方式进行操作，性能可能会很好。如果学生想要2，首先检查他们是否满足`5`先决条件的要求，然后检查他们是否满足`6`先决条件的要求。您的需求检查功能将涉及递归调用或类似调用。

如果由于某种原因这不起作用（图中的循环？！），您可以按照您所描述的另一个方向进行：从学生所学的课程开始，然后填充以获取列表学生有资格参加的所有课程。检查目标是否在该列表中（或者更确切地说：如果在构建列表时遇到目标，请立即停止）。

由于您不只是跟随箭头，因此洪水填充有点复杂：我可以通过`1`四种不同的方式获得资格：`(3 or (7 and 8)) and (4 or 9)`。但是基本的想法是一样的：继续测试我的可达节点的父节点，看看我是否可以向我的集合添加任何东西，直到我不能再添加任何东西。

适用于两种方法：我不完全清楚规则是什么，这种“满足3而不是3的先决条件”是否具有传递性。鉴于：

```
 1
     / \
    2   3
   /
  4
 / \
5   6 
```

我知道有`(5,6)`资格我`2`，但`(5,6,3)`我有资格`1`吗？

如果是这样，那么我认为这个过程会更容易一些，因为作为一个简化的假设，我可以假装如果我参加了，`(5,6)`那么我也参加了`4`，并且问题“我有资格获得 2 吗？” 变成，“我拿了 2 吗？”。

在我看来，如果不这样做更明智，因为我不认为我真的可以参加一大堆初级课程，然后直接进入 10 级以上的研究生工作。然后，我参加的课程与我参加的先决条件课程之间存在功能差异。需要跟踪这种差异。在洪水填充的情况下，我认为这意味着每个节点需要考虑 2 个标志而不是 1 个。在需求检查功能的情况下，我认为这意味着您需要 2 次检查（直接和间接满足），并且不需要递归。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T23:11:17.927

> *“（所以如果他/她拿了7,8,4，就相当于拿了3和4）。”* ——原海报

这不太像先决条件。普通课程不会像这样运行。这是什么，是一个**可能的替换列表**。例如，您想要一个 2，但您也可以对 2 进行所有替换，即 5,6。您可以进一步用 9,10 代替 5，或 11 代替 6。

这是可替代性的递归定义。

在蟒蛇中：

```
def canMake(desired, withIngredients):
    if desired in withIngredients:
        return True
    else:
        return all(canMake(s,withIngredients) for s in desired.substitutions) 
```

* * *

边注：

您将需要能够在 O(1) 时间内查询节点的父节点是什么。如果您的类定义为：

```
2 requires 5,6
5 requires 9,10
... 
```

如果您像这样存储它，它将要求您添加反向引用：

```
5 allows 2
6 allows 2
9 allows 4,5 
```

我们假设第一种情况`course.prereqs`是所需课程的列表（在第二种情况下，您可以通过定义轻松构建此列表：`course.parents = []`为每门课程，然后`child.parents.push(child)`为每门课程的孩子添加）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T23:43:22.920

直观的做法是通过 BFS 或 DFS 遍历树。

每当您到达表示您已经学习过的课程的节点时，剪切该节点下的所有节点。

所以资格检查失败的情况只有两种：

1.  在您到达表示您已经学习过的课程的所有节点之后，还有其他节点需要遍历。
2.  您到达一个叶节点，该节点不是表示您已经学习过的课程的节点

# jquery - jquery tablesorter ajax table 只排序一个方向

> ID：10825462
> 
> 赞同：10
> 
> 时间：2012-05-30T23:00:23.907
> 
> 标签：jquery, ajax, sorting, tablesorter

我有一个通过 jQuery 加载命令加载的表。在加载函数的回调中，我启动了 tablesorter 插件。由于某种原因，该表仅按降序而不是升序排序。更奇怪的是，如果我按住 shift 它会在 asc 和 desc 之间正确切换？知道这里发生了什么吗？

表.php

```
<table id="xyz">
<thead>
    <tr>
        <th>hi</th>
    </tr>
</thead>
<tbody>
    <tr>
        <td>a</td>
    </tr>
    <tr>
        <td>b</td>
    </tr>
    <tr>
        <td>c</td>
    </tr>
</tbody>
</table> 
```

jQuery

```
$("#myDiv").load("table.php", function() {
    $("#xyz").tablesorter();
}); 
```

如果我不通过 ajax 加载表格，那么 tablesorter 会按预期运行。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-04T16:33:59.603

好吧，所以我像杰森想的那样双重绑定。

我实际上是在一个类上调用 jQuery 的加载函数，并且我的页面上有两个 div 与该类。所以它实际上是调用了两次回调函数？

我认为这是一种奇怪的行为，因为加载到两个 div 中的内容是相同的，但看起来 jQuery 为每个 div 做了一个单独的 ajax 调用。感谢您的意见！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-05-20T07:01:10.363

只是想我会在这里抛出另一个答案，以防其他人遇到这个问题。当我尝试`.tablesorter()`使用类选择器而不是 id 选择器调用表时，这发生在我身上。所以改变它从

`$('.tablesorter').tablesorter();`

到

`$('#tablesorter').tablesorter();`

（以及反映这一点的标记）为我解决了这个问题。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-12-05T16:41:16.000

再一次，看看这个问题是如何解决的，我想分享我的不同场景。

我的表体行是通过`.ajax`调用动态创建的，一旦用户添加/修改/删除一行，表体行就会通过`.removed()`相同的`.ajax`调用重新创建`function()`。这当然会双重绑定表排序器，因为表头仍然存在，这会导致奇怪的行为。

对我来说，解决方法是在初始化之前取消绑定 tablesorter，`$('#mytable').addClass('tablesorter').tablesorter();`如下所示：

```
$('#mytable')
    .unbind('appendCache applyWidgetId applyWidgets sorton update updateCell')
    .removeClass('tablesorter')
    .find('thead th')
    .unbind('click mousedown')
.removeClass('header headerSortDown headerSortUp'); 
```

另一个解决方法可能是在调用中创建整个表，`.ajax`而不仅仅是 body`<tr>`的。

希望这可以帮助

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-22T20:21:49.847

问题已经解决，但我会提到我遇到了同样的问题。原因是在旧版本的 jquery 中：我有 1.4.2，需要 1.4.4。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-02-14T00:15:27.020

我遇到了同样的问题，但设置不同，这个帖子中提到的答案并没有解决我的问题。为我的场景添加解决方案，以防其他人遇到与我相同的问题。

我的表格正文行是从页面加载时的 .ajax 调用动态创建的，并且一列被设置为默认的 sortList，以便在加载数据后进行排序。

根据提交的新日期范围重新填充 10 列中的 5 列。我不重建表体，而是将数据注入到适当的记录中，然后根据我的默认 sortList 进行处理。

我的问题是，在提交新的日期范围后，tablesorter 现在在标题中定义了两次，因此单击标题会排序两次，似乎只能以一种方式排序。

我的解决方案是防止 tablesorter 标头被初始化两次。在页面加载时，我让 tablesorter 对我在我设置的 sortList 属性中设置的一列进行排序，但是每个提交的新日期范围，我使用以下行在数据加载后对我的列进行排序：

```
$('#mytableBody').trigger("update");
var sorting = [[5, 1]];
setTimeout(function () {$('#mytableBody').trigger('sorton', [sorting]) }, 1); 
```

我使用 setTimeout 来确保数据在排序前完全加载。

希望这可以帮助。

# java - 在eclipse中浏览JAR文件

> ID：10825463
> 
> 赞同：0
> 
> 时间：2012-05-30T23:00:26.917
> 
> 标签：java, eclipse, jar

我对 Java 或 Eclipse 不是很有经验，但我正在尝试在 Eclipse 中浏览和反编译一些 jar 文件。我继续使用[JD-Eclipse](http://java.decompiler.free.fr/?q=jdeclipse)来打开 .class 文件，但我无法让 Eclipse 让我浏览 .jar 文件。我读到问题是因为 .jar 文件没有添加到构建路径中，但是当我尝试按照[本](http://www.wikihow.com/Add-JARs-to-Project-Build-Paths-in-Eclipse-%28Java%29)指南添加它们时，展开“构建路径”后我没有任何选项。我是否错误地设置了我的项目？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T23:09:03.267

1.  创建一个新的 Java 项目。
2.  选择项目，右键选择属性
3.  从左侧的列表中，单击 Java Build Path，然后单击“Add External JARs...”按钮。
4.  浏览并从文件系统中选择 jar。

# mysql - mysql主/从回退场景

> ID：10825464
> 
> 赞同：0
> 
> 时间：2012-05-30T23:00:29.070
> 
> 标签：mysql

假设我有一台运行 MySQL/Apache 的计算机 A，它直接处理来自 Web 的 HTTP 请求。

计算机 A 是写入数据的主机。

计算机 B 是复制的从属设备，仅用于读取。

假设计算机 A 发生故障（完全关闭） - 如何将所有公共 Web 请求重定向到计算机 B？这甚至可能吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T23:21:06.313

您需要某种负载平衡。我建议你看看[keepalived](http://www.keepalived.org/)

# sql - Informix：如何将单个参数中的多个值传递、使用和执行到存储过程

> ID：10825468
> 
> 赞同：2
> 
> 时间：2012-05-30T23:00:40.413
> 
> 标签：sql, informix

如何将单个参数中的多个值传递给**Informix**中的存储过程？

这是一个常见的问题，但我看到关于informix 的问题。

我找到了一个[帖子](http://www.mombu.com/programming/informix/t-pass-multiple-values-in-a-single-parameter-in-informix-stored-procedure-1512924.html)，但它对我不起作用，应该是数据库的版本还是我遗漏了什么？

我正在尝试执行此操作`WHERE X IN (SELECT Y FROM TABLE(PARAM))`

**编辑：**

这是我试图做的一个例子。

```
CREATE PROCEDURE test_hector
(
    C LIST( SET (CHAR(10) NOT NULL ) NOT NULL)
)
RETURNING CHAR(10) AS C, CHAR(10) AS CVE, CHAR(50) AS DESC;

DEFINE vColumna like tclaves.columna;
DEFINE vClave like tclaves.clave;
DEFINE vdescve like tclaves.descve;

FOREACH
select columna, clave, descve
INTO vColumna, vClave,vdescve
from tclaves
where columna in (SELECT * FROM TABLE(C))
RETURN vColumna, vClave,vdescve WITH RESUME;
END FOREACH
END PROCEDURE; 
```

我正在尝试执行它，但我认为我遇到了 sintax 问题

```
EXECUTE PROCEDURE test_hector( '{stspols,stsrepo}'); 
```

我收到错误消息 `[Informix][Informix ODBC Driver][Informix]Invalid collection literal value.`

我执行了这个函数`execute function se_release()`来获取informix 版本，这就是我得到的。

```
column1
Spatial DataBlade Release 8.21.FC4R1 (Build 238)                 Compiled on Thu Aug 26 19:42:55 CDT 2010 with:                      IBM Informix Dynamic Server Version 10.00.FC7                    glslib-4.00.UC10 
```

我`Aqua Data Studio 8.0.22`用来创建和执行程序。继续运行`Windows 7 Ultimate 32-Bits`

提前致谢。任何帮助

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-05T13:15:27.577

将参数类型定义为适当的集合类型：LIST、SET、MULTISET（这是我在交叉引用问题的答案中所说的）。

*   什么不适合你？
*   你尝试了什么？
*   您收到的错误信息是什么？
*   您使用的是哪个版本的 Informix 服务器？
*   您使用哪个工具或 API 创建存储过程？
*   您使用哪个工具或 API 来执行存储过程？
*   你在哪个平台上运行？
*   你是如何调用程序的？

* * *

感谢您放大问题。你说：

> ```
> EXECUTE PROCEDURE test_hector('{stspols,stsrepo}'); 
> ```
> 
> 我收到错误消息`[Informix][Informix ODBC Driver][Informix]Invalid collection literal value.`

这可能是一个比表面上更容易解决的问题。该过程的输入类型应该是一个集合——实际上是一个 SET 值的列表——其中每个值都是一个字符串。你可以这样写：

```
EXECUTE PROCEDURE test_hector(LIST{SET{'stspols','stsrepo'}}); 
```

我为自己创建了一个虚拟程序来测试这种语法：

```
CREATE PROCEDURE test_hector(c LIST(SET (CHAR(10) NOT NULL ) NOT NULL))
    RETURNING CHAR(10) AS C, CHAR(10) AS CVE, CHAR(50) AS DESC;
    return "abc", "def", "ghi";
END PROCEDURE; 
```

它的输出与预期的一样：

```
abc   def   ghi 
```

请注意，Informix 支持以`{`以下第一个开头和结尾的注释样式`}`。但是，当关键字之前的关键字`{`是 SET、MULTISET 或 LIST 之一时，该注释样式会被抑制（是的，这确实使它很难解析！）。在不改变其含义的情况下，您可以通过“在哪里可以`{}`在上面的 SQL 中添加”获得巨大（如果变态）的乐趣。`{}`API 可能识别 Informix注释但无法识别集合异常的外部机会。在这种情况下，您可能会得到一个语法错误（因为`}`如果您将第`{`一个解释为开始注释符号，则不需要第二个）。在这种情况下，请使用以下符号之一。

集合（SET、MULTISET、LIST）文字的表示法随着时间的推移而演变。这种替代符号也有效（并且与您最初尝试的内容更密切相关，并且是最初记录的内容）：

```
EXECUTE PROCEDURE test_hector('LIST{SET{''stspols'',''stsrepo''}}'); 
```

SET 中的字符串必须用引号括起来，但整个文字本身就是一个字符串，因此您需要将嵌入的引号加倍。您也可以“作弊”并使用双引号和单引号：

```
EXECUTE PROCEDURE test_hector('LIST{SET{"stspols","stsrepo"}}');
EXECUTE PROCEDURE test_hector("LIST{SET{'stspols','stsrepo'}}"); 
```

* * *

从下面的讨论以及替代答案中所述，现在问题似乎与嵌套集合有关。A`LIST{SET{"str1", "str2"}}`是一个有序列表（其中有一个条目）；该条目本身就是一组（不同的）字符串，没有特定的顺序。如果您需要能够重复字符串（但顺序并不重要），您将使用 MULTISET。您使用 LIST 是顺序很重要（列表中允许重复）。

听起来好像你真的只需要选择参数类型，这样它就更简单了。您应该能够有效地使用任何一种集合类型；我可能会提名 SET 以便您不必处理列表中的重复字符串，但 MULTISET 或 LIST 也是有效的选项。将程序重命名为`test_3()`：

```
CREATE PROCEDURE test_3(c SET(CHAR(10) NOT NULL))
    RETURNING CHAR(10) AS r;
    DEFINE r CHAR(10);
    FOREACH SELECT * INTO r FROM TABLE(c)
        RETURN r WITH RESUME;
    END FOREACH;
END PROCEDURE; 
```

我能够执行以下两个语句，结果显示：

```
+ EXECUTE PROCEDURE test_3(SET{'stspols','stsrepo'});
stspols
stsrepo
+ EXECUTE PROCEDURE test_3('SET{''stspols'',''stsrepo''}');
stspols
stsrepo 
```

这是使用 ESQL/C 接口。您应该能够获得第二个使用 ODBC；第一个可能会导致 -201 语法错误。

如果您更喜欢 LIST 而不是 SET，则在上面的代码中将 SET 更改为 LIST：

```
+ CREATE PROCEDURE test_3(c LIST(CHAR(10) NOT NULL))
    RETURNING CHAR(10) AS r;
    DEFINE r CHAR(10);
    FOREACH SELECT * INTO r FROM TABLE(c)
        RETURN r WITH RESUME;
    END FOREACH;
END PROCEDURE;
+ EXECUTE PROCEDURE test_3(LIST{'stspols','stsrepo'});
stspols
stsrepo
+ EXECUTE PROCEDURE test_3('LIST{''stspols'',''stsrepo''}');
stspols
stsrepo 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T18:42:18.710

我以不同的方式尝试了它并找到了解决方案。

我修改了过程以接受一个参数，就像 a `List`，而不是 a`List{SET...`

```
CREATE PROCEDURE test_hector
(
    C LIST( CHAR(10) NOT NULL )
)
RETURNING CHAR(10) AS C, CHAR(10) AS CVE, CHAR(50) AS DESC;

DEFINE vColumna like tclaves.columna;
DEFINE vClave like tclaves.clave;
DEFINE vdescve like tclaves.descve;

FOREACH
select columna, clave, descve
INTO vColumna, vClave,vdescve
from tclaves
where columna in (SELECT * FROM TABLE(C))
RETURN vColumna, vClave,vdescve WITH RESUME;
END FOREACH
END PROCEDURE; 
```

并以这种方式执行它。

```
EXECUTE PROCEDURE test_hector('LIST{''stspols'',''stsrepo''}'); 
```

或者这样

```
EXECUTE PROCEDURE test_hector3('LIST{"stspols","stsrepo"}'); 
```

它就像一个魅力。

# r - R google maps, ggmap - 渲染pdf文件很慢，有没有办法制作一个高效的pdf文件？

> ID：10825472
> 
> 赞同：1
> 
> 时间：2012-05-30T23:01:16.140
> 
> 标签：r, google-maps, ggplot2

我目前正在使用 ggmap 包中的 get_map 函数来获取谷歌地图，然后我使用 ggmap 和注释将点添加到绘图中。每次调用 annotate 都会添加大约 1000 个点，我调用 annotate 大约 100 次。将输出保存为 pdf 后，与 pdf 的渲染和后续交互非常缓慢。有没有一种从具有相同分辨率但渲染速度更快的石英或 X11 设备保存为 pdf 的好方法？和/或有没有办法使用 ggmap 来创建高效的地图？

# iphone - 硬件测试中未找到 Xib

> ID：10825473
> 
> 赞同：2
> 
> 时间：2012-05-30T23:01:18.070
> 
> 标签：iphone, ios, xib

（初学者问：）以前看过类似的帖子 - 在模拟器上一切正常，在 iPhone 上崩溃。这是错误：

> 'NSInternalInconsistencyException'，原因：'无法在包中加载 NIB：'NSBundle

我在这里读过其他帖子，但据我所知，这不是区分大小写的问题。

可能是线索的一件事是，当我选择 xib 进行编辑时，助手编辑器显示“无助手结果”而不是头文件。有人能告诉我这是什么意思吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T23:35:27.710

在您的 App-info.plist 中应该有 iPhone 和 iPad 的 NIB 条目。确保正确指定这些并且相应的 xib 文件正在工作。

# ffmpeg - FFmpeg 使 mpeg2 ts 无间断

> ID：10825476
> 
> 赞同：5
> 
> 时间：2012-05-30T23:01:31.580
> 
> 标签：ffmpeg, http-live-streaming

我有许多用 iPhone 录制的 MOV 文件，我想将它们转换为 mpeg2 TS。我想通过 HTTP Live Streaming 协议将它们用于实时视频流。

我将 iPhone 设置为不断将 MOV 文件发送到服务器。每个视频剪辑时长为 5 秒。我想用它们制作 mpeg2 TS 并将它们的网址添加到 m3u8 播放列表中。我设法做到了所有这些，但是当我尝试播放流时，VLC 播放器仅播放播放列表中的前两个文件，以及播放列表中的最后一个文件。我搜索了互联网，我认为这与不连续性有关。

有什么方法可以将多个 MOV 文件转换为多个 mpeg2 TS 段而不会中断？

或者也许我做错了什么？这是我的 ffmpeg 命令：

```
ffmpeg.exe -i input,MOV -f mpegts output.ts 
```

这是我的 m3u8 列表：

```
#EXTM3U
#EXT-X-PLAYLIST-TYPE:EVENT
#EXT-X-TARGETDURATION:10
#EXT-X-MEDIA-SEQUENCE:0
#EXT-X-MEDIA-SEQUENCE:0
#EXTINF:10,
fileSequence0.ts
#EXTINF:10,
fileSequence1.ts
#EXTINF:10,
fileSequence2.ts 
```

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T14:05:53.533

问题是您的系列电影不是流。当您创建单独的 mpeg2ts 段时，每次运行 ffmpeg 时时间戳都会重新设置为 0。您可以尝试使用 [setpts](http://ffmpeg.org/ffmpeg.html#setpts)过滤器来调整每个段的起始时间戳。但首先你需要知道上一段的最终分数。

# usb - 在 Linux 和 Windows 之间共享 SD 卡分区

> ID：10825480
> 
> 赞同：-2
> 
> 时间：2012-05-30T23:01:53.873
> 
> 标签：usb, sd-card, partitioning

我有一张格式化的 SD 卡（有多个分区），其中一个是 FAT32，它安装在 Linux 中。这个 FAT32 分区将在 Windows 中显示为 USB 驱动器，我必须在 Linux 中安装它才能看到它的内容。

虽然我能够在 Linux 和 Windows 中共享和查看此分区内容，但似乎在 Linux 中所做的任何更改（如创建新文件/对现有文件的修改）都会反映在 Windows 中，除非我卸载并再次挂载它。反过来也是如此。

我将不胜感激任何帮助解决这个问题..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T23:50:26.223

请记住，将在块级别访问 SD 卡或 USB 驱动器/记忆棒。该接口不提供主机操作系统正在使用的目录结构或 FAT 内容的知识。如果两个设备同时访问一个块级设备，则它们都假定它们可以完全控制设备和缓存结构以提高性能。因此，一个主机操作系统对存储介质的内容所做的任何更改都不为另一主机操作系统所知。

这就是较新的 Android 设备实施 MTP 协议而不是 USB MSC 以允许主机访问其媒体的原因。MTP 允许 Android 操作系统保持对文件系统结构的控制，同时将其内容暴露给主机。

# extjs - 外部堆积条形图标签

> ID：10825482
> 
> 赞同：2
> 
> 时间：2012-05-30T23:02:04.560
> 
> 标签：extjs, bar-chart

使用 Ext 4，如何使堆叠条形图的标签覆盖整个条形？我希望我的标签从栏的开头开始并延伸到所有部分，但目前，如果标签不适合栏的第一部分，它将自动从下一部分/最后一部分开始。

这与 Ext.chart.series.bar 中的示例中的代码相同，但进行了更改以使其堆叠。标有“2”的条不适合第一个绿色部分，因此它被推到蓝色部分。

![在此处输入图像描述](../Images/e6ab2f588069619c4d3df0dda0361ffd.png)});

```
var store = Ext.create('Ext.data.JsonStore', {
fields: ['name', 'data'],
data: [
    { 'name': 'metric one',   'data':10 },
    { 'name': 'metric two',   'data': 7 },
    { 'name': 'metric three', 'data': 5 },
    { 'name': 'metric four',  'data': 2 },
    { 'name': 'metric five',  'data':27 }
]
});

Ext.create('Ext.chart.Chart', {
renderTo: Ext.getBody(),
width: 500,
height: 300,
animate: true,
store: store,
axes: [{
    type: 'Numeric',
    position: 'bottom',
    fields: ['data'],
    label: {
        renderer: Ext.util.Format.numberRenderer('0,0')
    },
    title: 'Sample Values',
    grid: true,
    minimum: 0
}, {
    type: 'Category',
    position: 'left',
    fields: ['name'],
    title: 'Sample Metrics'
}],
series: [{
    type: 'bar',
    axis: 'bottom',
    highlight: true,
    tips: {
      trackMouse: true,
      width: 140,
      height: 28,
      renderer: function(storeItem, item) {
        this.setTitle(storeItem.get('name') + ': ' + storeItem.get('data') + ' views');
      }
    },
    label: {
      display: 'insideStart',
        field: 'data',
        renderer: Ext.util.Format.numberRenderer('0'),
        orientation: 'horizontal',
        color: '#333',
        'text-anchor': 'middle'
    },
    stacked: true,
    xField: 'name',
    yField: ['data', 'data']
}] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T12:44:46.193

您需要以某种形式的比率来表达您的数据点。更好的百分比。见下文

```
var store = Ext.create('Ext.data.JsonStore', {
            fields: ['name', 'data', 'data2'],
            data: [
                { 'name': 'metric one',   'data': 10/20,   'data2': 10/20 },
                { 'name': 'metric two',   'data': 7/17,   'data2': 10/17 },
                { 'name': 'metric three', 'data': 5/15,   'data2': 10/15 },
                { 'name': 'metric four',  'data': 2/12,   'data2': 10/12 },
                { 'name': 'metric five',  'data': 27/37,   'data2': 10/37 }
            ]
        });

        Ext.create('Ext.chart.Chart', {
            renderTo: Ext.getBody(),
            width: 500,
            height: 300,
            animate: true,
            store: store,
            axes: [{
                type: 'Numeric',
                position: 'bottom',
                fields: ['data', 'data2'],
                label: {
                    renderer: Ext.util.Format.numberRenderer('0,0')
                },
                title: 'Sample Values',
                grid: true,
                minimum: 0
            }, {
                type: 'Category',
                position: 'left',
                fields: ['name'],
                title: 'Sample Metrics'
            }],
            series: [{
                type: 'bar',
                axis: 'bottom',
                highlight: true,
                tips: {
                  trackMouse: true,
                  width: 140,
                  height: 28,
                  renderer: function(storeItem, item) {
                    this.setTitle(storeItem.get('name') + ': ' + storeItem.get('data') + ' views');
                  }
                },
                label: {
                  display: 'insideStart',
                    field: 'data',
                    renderer: Ext.util.Format.numberRenderer('0'),
                    orientation: 'horizontal',
                    color: '#333',
                    'text-anchor': 'middle'
                },
                stacked: true,
                xField: 'name',
                yField: ['data', 'data2']
            }]
        }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-23T21:46:24.990

尝试这个。

```
{
              display: 'insideEnd',
              'text-anchor': 'middle',
                field: ['data1','data2','data3'],
                renderer: Ext.util.Format.numberRenderer('0,0'),
                orientation: 'vertical',
                color: '#333'
            } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-12-09T09:35:01.687

仅当它是整数时才显示 y 轴值

```
yAxis: new Ext.chart.NumericAxis({

          displayName: 'Visits',
          labelRenderer: function(v) {
             // return a value only if it is an integer
             if(v.toString().indexOf(".") === -1){
                   return v;
             }
          }
    }) 
```

# asp.net-mvc - MVC 中的可编辑表

> ID：10825483
> 
> 赞同：1
> 
> 时间：2012-05-30T23:02:11.570
> 
> 标签：asp.net-mvc

我一直无法弄清楚如何在网页上编辑表格项目，并将它们发布回服务器。（实际上，在这种情况下，我只是希望用户选择复选框，就好像他们正在选择多个项目，但这只是暗示）。

问题是，当视图显示在网页上时，在 HttpPost 中，picSelections 为空。

这是我的视图的顶部：

```
@model IEnumerable<CarShow.lmit_pics>

@using (Html.BeginForm())
{    
<div style="width:100%; height:60px; ">
<input type="submit" value="Add Selected Photo(s) to Survey" />
</div>

    for (int i = 0; i < Model.Count(); i++)
    {
        var item = Model.ElementAt(i);
    <div style="width:296px; float:left">

            <div style="float:left; width:200px; margin-bottom:18px">

                @{string cropped = "../../../Content/Images/" + Html.DisplayFor(modelItem => item.picname).ToString() + "?" + Html.DisplayFor(modelItem => item.version).ToString();
                 }
                <img alt="picture" class="pic-size" src="@cropped" />
                <br />
                    @Html.EditorFor(modelItem => item.brand)
            </div>

</div>
        }    
}
</div> 
```

这是在控制器中：

```
public ActionResult AddSurveyPic(string id)
{
   var validPicSummaries = (IEnumerable)(from x in db.lmit_pics where x.enabled == 1 select x);
   return View((IEnumerable)validPicSummaries);
}

[HttpPost]
public ActionResult AddSurveyPic(IEnumerable<CarShow_MVC.lmit_pics> picSelections)
{
        // Save data here
} 
```

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T05:58:17.363

不要在视图中编写循环。我建议您使用编辑器模板：

```
@model IEnumerable<CarShow.lmit_pics>

@using (Html.BeginForm())
{    
    <div style="width:100%; height:60px; ">
        <input type="submit" value="Add Selected Photo(s) to Survey" />
    </div>
    @Html.EditorForModel()
} 
```

然后创建一个相应的编辑器模板，该模板将自动为模型的每个元素呈现：`~/Views/Shared/EditorTemplates/lmit_pics.cshtml`. 注意模板的名称和位置很重要：

```
@model CarShow.lmit_pics

<div style="width:296px; float:left">
    <div style="float:left; width:200px; margin-bottom:18px">
        @{string cropped = "../../../Content/Images/" + Html.DisplayFor(x => x.picname).ToString() + "?" + Html.DisplayFor(x => x.version).ToString(); }
        <img alt="picture" class="pic-size" src="@cropped" />
        <br />
        @Html.EditorFor(x => x.brand)
    </div>
</div> 
```

You might also want to read the [following article](http://www.hanselman.com/blog/ASPNETWireFormatForModelBindingToArraysListsCollectionsDictionaries.aspx) to better understand the naming conventions that the default model binder uses when binding collections and dictionaries.

# jquery - jQuery：如何将复选框附加到表中的每一行？

> ID：10825488
> 
> 赞同：4
> 
> 时间：2012-05-30T23:03:11.860
> 
> 标签：jquery, append, html-table

我有这个来自json的附加元素：

```
$.ajax({
                type: "POST",
                url: action,
                data: dataSearch,
                success: function (response) {

                    if (response[0].success == "success") {
                        $.each(response, function (index, record) {
                            var row = $("<tr />");
                            $("<td />").text(record.clavemat).appendTo(row);
                            $("<td />").text(record.tipomat).appendTo(row);
                            $("<td />").text(record.titulomat).appendTo(row);
                            $("<td />").text(record.autormat).appendTo(row);
                            $("<td />").text(record.editmat).appendTo(row);
                            $("<td />").text(record.edicmat).appendTo(row);
                            //Append checkbox to each row
                            row.addClass("alt");
                            row.appendTo(".resultsSearch");
                        });
                    } else {
                        alert("Data not found");
                    }

                }
            });
            return false; 
```

我想在最后一列的每一行附加复选框，我不知道谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-30T23:07:02.513

你有没有尝试过？：

```
$("<td />").html('<input type="checkbox"/>').appendTo(row); 
```

顺便说一句，如果您从服务器获取信息，您确定 POST 是最佳选择吗？或者您在执行请求时是否更改了服务器的状态？如果不是这种情况，请检查[何时使用 Post 或 Get](http://www.w3.org/2001/tag/doc/whenToUseGet.html)

# android - 简单视图不尊重 GridLayout 大小？

> ID：10825490
> 
> 赞同：2
> 
> 时间：2012-05-30T23:03:19.230
> 
> 标签：android, custom-controls, grid-layout

我必须创建一个非常自定义的界面，我希望将 GridLayout 类用​​于（来自兼容性库）。要了解有关 GridLayout 的更多信息，我在这里尝试了本教程：http: [//blog.stylingandroid.com/archives/686](http://blog.stylingandroid.com/archives/686)。

使用 TextView 时一切看起来都很好，但是如果您将其中任何一个替换为具有背景颜色的简单 View 实例（或创建扩展 View 类的自定义 View），则 View 的大小不正确并填充整个布局。所以我的猜测是我必须自己测量来调整自定义视图的大小。但这有其自身的挑战，因为您在 onMeasure 期间获得的 MeasureSpec 值属于 MeasureSpec.AT_MOST 模式，它给出了整个父布局的大小。

所以我的问题是，如何调整自定义视图的大小以使其表现得像 TextView 类的其他实例一样。

# zend-framework2 - ZF2，在视图中获取模块名称，如何？

> ID：10825494
> 
> 赞同：2
> 
> 时间：2012-05-30T23:03:52.520
> 
> 标签：zend-framework2

刚刚完成 Rob Allen 的教程：http: [//akrabat.com/wp-content/uploads/Getting-Started-with-Zend-Framework-2.pdf](http://akrabat.com/wp-content/uploads/Getting-Started-with-Zend-Framework-2.pdf)

然后我决定在视图中获取模块名称，在应用程序模块和相册模块之间制作菜单，正如我所见可以实现这一点，我能够获得模块名称。

请求任何模块时如何进入布局？（这个菜单是全局的）。

我对 ZF2 很陌生，我知道我误解了这个概念，但不明白在哪里:)

任何帮助都会很有用。提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T08:30:35.153

模块名称很棘手，因为调度程序中实际上没有模块的概念。

您必须自己将其放入布局中。最简单的方法是从控制器：

```
function indexAction()
{
    $this->layout()->module = __NAMESPACE__;

    // do stuff and return a view model
} 
```

理想情况下，您不需要知道这些信息并完全使用路由名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T07:41:51.617

对于菜单/导航，我建议使用 Zend Navigation。

# design-patterns - 关于桥接模式的问题

> ID：10825495
> 
> 赞同：1
> 
> 时间：2012-05-30T23:03:56.620
> 
> 标签：design-patterns

我正在研究桥接模式，我有一个问题。关于下面我的代码示例`LightSwitch`，`FanSwitch`应该是**实现**者还是`Slider/RadialImplementation`可以作为实现者？我的问题是要知道谁必须是实施者：这两种组合似乎都可以按任何顺序工作。我不知道我是否清楚。

```
class Main
{
    static function main()
    {
        new Main();
    }

    public function new()
    {
        var s:Switch;

        s = new LightSwitch();

        s.implementation = new SliderImplementation();
        s.on();
        s.off();

        s.implementation = new DialImplementation();
        s.on();
        s.off();

        s = new FanSwitch();

        s.implementation = new SliderImplementation();
        s.on();
        s.off();

        s.implementation = new DialImplementation();
        s.on();
        s.off();
    }
}

class Switch
{
    public var implementation:SwitchImplementation;
    public function new(){}
    public function on(){}
    public function off(){}
}

class LightSwitch extends Switch 
{
    public override function on()
    {
        trace("Light");
        implementation.on();
    }
    public override function off()
    {
        implementation.off();
    }
}

class FanSwitch extends Switch 
{
    public override function on()
    {
        trace("Fan");
        implementation.on();
    }
    public override function off()
    {
        implementation.off();
    }
}

class SwitchImplementation
{
    public function new(){}
    public function on(){}
    public function off(){}
}

class SliderImplementation extends SwitchImplementation
{
    public override function on()
    {
        trace("> Slider Switch [on]");
    }
    public override function off()
    {
        trace("> Slider Switch [off]");
    }
}

class DialImp lementation extends SwitchImplementation
{
    public override function on()
    {
        trace("> Dial Switch [on]");
    }
    public override function off()
    {
        trace("> Dial Switch [off]");
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T00:07:42.240

您示例中的实现*者*`Slider/RadialImplementation`是类。它们隐藏在通过类的*抽象*暴露的接口后面`Light/FanSwitch`。

# iis - IIS 7.5 如何添加动态 HTTP 过期标头

> ID：10825497
> 
> 赞同：0
> 
> 时间：2012-05-30T23:04:11.627
> 
> 标签：iis, web-config, http-headers, iis-7.5

在 IIS 7.5 中，您可以添加静态 HTTP 响应标头，但我想添加一个“过期”标头，该标头始终指定未来 7 天的日期。

我正在运行 php 5.4，所以我想要一个可以通过编辑 web.config 文件而不是一些 c# 代码解决方案来做到这一点的解决方案。

我知道如何使用 php 添加标头，但这对静态图像文件的 http 标头（jpg、gif、png 等）没有帮助。

标头应如下所示：

到期：2012 年 5 月 31 日星期四 10:59:25 GMT

如何使它动态地始终显示未来 7 天的日期和时间？

编辑：

请注意，我的 php 文件中有我想要的 expires 标头：

[http://web-sniffer.net/?url=http%3A%2F%2Fwww.bestds.com](http://web-sniffer.net/?url=http%3A%2F%2Fwww.bestds.com)

但是，我无法为 png 文件上的“Expires”键指定提前 7 天的日期（例如），我不得不在很远的将来使用静态日期：

[http://web-sniffer.net/?url=http%3A%2F%2Fwww.bestds.com%2Fimage%2Ftlogo.png](http://web-sniffer.net/?url=http%3A%2F%2Fwww.bestds.com%2Fimage%2Ftlogo.png)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-31T12:04:40.057

这是 IIS 的标准功能。HTTP 响应标头模块允许您设置此公共标头。这会产生以下 web.config：

```
<?xml version="1.0" encoding="UTF-8"?>
<configuration>
    <system.webServer>
        <staticContent>
            <clientCache cacheControlMode="UseMaxAge" cacheControlMaxAge="7.00:00:00" />
        </staticContent>
    </system.webServer>
</configuration> 
```

您应该只在您希望发送此标头的目录中执行此操作。通常只有具有静态内容的目录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-16T09:26:55.043

您只能使用程序代码添加动态过期标头。

来源： [Microsoft IIS 站点](http://www.iis.net/configreference/system.webserver/staticcontent/clientcache)

您应该改用 Cache-Control max-age ，就像其他答案中建议的那样。

# jquery-mobile - jQuery Mobile Clickhander 不适用于自定义对象的实例

> ID：10825499
> 
> 赞同：0
> 
> 时间：2012-05-30T23:04:19.957
> 
> 标签：jquery-mobile, event-handling, click, anchor

我正在通过引用锚标记内的处理程序函数来为 jQuery mobile 中的锚标记设置一个单击处理程序（我需要这样做，因为这样做很麻烦）。如果我使用字符串或整数作为函数参数，这种方法可以正常工作，但如果我尝试输入对象的实例（如下图所示），则它不起作用。任何关于我可能做错的建议将不胜感激。

```
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.1.0-rc.1/jquery.mobile-1.1.0-rc.1.min.css"
    />
    <script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
    <script src="http://code.jquery.com/mobile/1.1.0-rc.1/jquery.mobile-1.1.0-rc.1.min.js"></script>
</head>

<body>
    <script>
        $(document).ready(function () {

            function testObject() {
                this.param1;
            }

            function maketestObject(param1) {
                var result = new testObject();
                result.param1 = param1;
                return result;
            }

            var i = 0;
            var html;
            for (i = 0; i <= 5; i = i + 1) {
                var testInstance = maketestObject("test param");
                html += '<li><a href="#" data-theme="a" onclick="clickHandler(' + testInstance + '); return false;" rel="external" data-role="button">click test1</a></li>';
            }

            $("#testList").append(html);
            $("#testList").listview("refresh");

        });

        function clickHandler(e) {
            alert(e);
        }
    </script>
    <div data-role="page" class="type-interior">
        <div id="main" data-role="content">
            <ul id="testList" data-role="listview"></ul>
        </div>
    </div>
</body> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T05:38:37.490

当您将动态元素添加到没有事件的 dom 时，您是否尝试过使用 .live() 函数，所以我建议您

```
 for (i = 0; i <= 5; i = i + 1) {
                var testInstance = maketestObject("test param");
                var temp = "'" + testInstance + "'";
                html += '<li><a href="#" data-theme="a" class="new" return false;" rel="external" data-role="button">click test1</a></li>';
            }

/*** jQuery code ****/
        $(".new").live("click",function(){
    // your code here 
    aler("it working");
    }); 
```

当按钮对我不起作用时，我通常会这样做，希望对你有用！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T05:14:11.827

我认为它有效

```
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
<link rel="stylesheet" href="http://code.jquery.com/mobile/1.1.0-rc.1/jquery.mobile-1.1.0-rc.1.min.css"
/>
<script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
<script src="http://code.jquery.com/mobile/1.1.0-rc.1/jquery.mobile-1.1.0-rc.1.min.js"></script> 
```

$(文档).ready(函数() {

```
 function testObject() {
            this.param1;
        }

        function maketestObject(param1) {
            var result = new testObject();
            result.param1 = param1;
            return result;
        }

        var i = 0;
        var html;
        for (i = 0; i <= 5; i = i + 1) {
            var testInstance = maketestObject("test param");
//var temp = "'" + testInstance+ "'";

 /// Chaged into 

            var temp = "'" + testInstance.param1  + "'";

            html += '<li><a href="#" data-theme="a" onclick="clickHandler(' + temp + '); return false;" rel="external" data-role="button">click test1</a></li>';
        }

        $("#testList").append(html);
        $("#testList").listview("refresh");

    });

    function clickHandler(e) {
        alert(e);
    }
</script>
<div data-role="page" class="type-interior">
    <div id="main" data-role="content">
        <ul id="testList" data-role="listview"></ul>
    </div>
</div> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-02T13:53:16.547

我想你可以用这个来实现你的 oal ..

```
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
<link rel="stylesheet" href="http://code.jquery.com/mobile/1.1.0-rc.1/jquery.mobile-1.1.0-rc.1.min.css"
/>
<script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
<script src="http://code.jquery.com/mobile/1.1.0-rc.1/jquery.mobile-1.1.0-rc.1.min.js"></script>
</head>

<body>
    <script>
// Create global object array ..
        var testInstanc = [];
        $(document).ready(function() {

            function testObject() {
                this.param1;
            }

            function maketestObject(param1) {
                var result = new testObject();
                result.param1 = param1;
                return result;
            }

            var i = 0;
            var html;
            for (i = 0; i <= 5; i = i + 1) {

                // var temp = "'" + testInstance + "'";
// set array to object
                 testInstanc[i] = maketestObject("test param" + i);

pass clickhandler function to your array index
                 html += '<li><a href="#" data-theme="a" onclick="clickHandler(' + i + '); return false;" rel="external" data-role="button">click test1</a></li>';
            }

            $("#testList").append(html);
            $("#testList").listview("refresh");

        });
        function clickHandler(i) { 
```

// 使用 testInstance 数组访问对象属性 alert(testInstanc[i].param1);

```
 }

    </script>
    <div data-role="page" class="type-interior">
        <div id="main" data-role="content">
            <ul id="testList" data-role="listview"></ul>
        </div>
    </div>
</body>
</html> 
```

# sql - 错误，因为 ArrayLen 的参数可能为空

> ID：10825505
> 
> 赞同：0
> 
> 时间：2012-05-30T23:04:44.050
> 
> 标签：sql, web-applications, coldfusion

当使用为 null 的元素调用 ArrayLen 时，它会引发错误。你如何让它返回0？

```
The value '' cannot be converted to a number.

The error occurred in D:/Resource/WWW/DEV/ww1dev.cwtvacations.com/welcome_survey/welcome_survey_question_builder.cfm: line 12

10 :    <cfset curPage = SESSION.thisPage />
11 : 
12 :    <cfloop from="1" to="#ArrayLen(SESSION.WHSurveyStruct.pagesQuestions[curPage])#" index="curQuestion">
13 :        <cfif (SESSION.WHSurveyStruct.pagesQuestions[curPage][curQuestion].SectionID eq 4 AND SESSION.WHSurveyStruct.AirlineID neq 0)   <!--- Ask airline questions, if airline known  --->
14 :                OR (SESSION.WHSurveyStruct.pagesQuestions[curPage][curQuestion].SectionID neq 4 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T23:42:38.753

您可以做几件事。您可以使用三元运算符并将整个事物分配给变量：

`upperBound = isNull(SESSION.WHSurveyStruct.pagesQuestions[curPage]) ? 0 : ArrayLen(SESSION.WHSurveyStruct.pagesQuestions[curPage]);`

或者你可以事先检查一下。但是，您将数组的特定元素指定为数组似乎很奇怪。即包含数组还是数组`SESSION.WHSurveyStruct.pagesQuestions[curPage]`？`pagesQuestions[]`如果是数组，则删除`[curParge]`索引。

# android - Android - 短信环回

> ID：10825511
> 
> 赞同：0
> 
> 时间：2012-05-30T23:05:56.447
> 
> 标签：android, android-emulator, sms

我希望实现 SMS 环回，即从同一个应用程序发送和接收 SMS。为此，我创建了一个扩展类`BroadcastReciever`，实现了`onReceive()`方法，并声明了相关权限。

我通过使用 telnet 发送 SMS 来验证实现。我想自动化远程登录过程，即通过发送短信让应用程序自行测试。为此，我在主活动中调用了以下方法，但`BroadcastReceiver`从未调用过：

```
private final void sendSMS() {
    final TelephonyManager telMgr = (TelephonyManager)
            getSystemService(Context.TELEPHONY_SERVICE);
    final int len = telMgr.getLine1Number().length(); 
    final String phoneNum = telMgr.getLine1Number().substring(len - 4, len);
    final String msg = "msg"; 
    SmsManager.getDefault().sendTextMessage(phoneNum, null, msg, null, null);
} 
```

任何线索有什么问题...？

**更新：**请注意，上面的代码适用于模拟器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T23:52:53.323

不确定我是否理解您的问题，但您是否尝试从模拟器向自身发送短信？据我所知，这是不可能的。只需加载另一个模拟器，并在它们之间发送消息。

由于 telnet 命令有效，您的 BroadcastReceiver 可能已正确实现，但无论如何您都应该附上它的代码......很难对您看不到的代码进行故障排除:)

# javascript - 对象的默认值

> ID：10825513
> 
> 赞同：0
> 
> 时间：2012-05-30T23:06:21.940
> 
> 标签：javascript

我正在使用 Canvas 2d 上下文将文本写入屏幕..

为了实现这一点，我让它遍历我创建的一组文本对象，现在我拥有具有 3 个属性的文本对象：

```
text.text
text.x
text.y 
```

text.text 保存要写入的字符串，text.x 保存 x 位置的值，text.y 保存 y 位置的值

无论如何我可以跳过 text.text 属性吗？

例如，现在它看起来像这样：

```
var textStrings = [];

textStrings[0] = {};
textStrings[0].text = "hello";
textStrings[0].x = 0;
textStrings[0].y = 10;

textStrings[1] = {};
textStrings[1].text = "world";
textStrings[1].x = 10;
textStrings[1].y = 10; 
```

但是有什么办法可以代替我做这样的事情：

```
textStrings = [];
textStrings[0] = {};
textStrings[0] = "hello";
textStrings[0].x = "0";
textStrings[0].y = 10;

textStrings[1] = {};
textStrings[1] = "world";
textStrings[1].x = 10;
textStrings[1].y = 10; 
```

基本上是对象或其他东西的默认属性...

现在只要我做类似的事情

```
textStrings[0] = "hello"; 
```

它将 textStrings 更改为字符串而不是对象，然后我不能再向它添加属性，因为它是原始数据类型。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T23:17:42.717

您可以使用 String 对象而不是原始值：

```
var a = new String("hello");
a.x = "0";
a.y = 10;
var b = new String("world");
b.x = "10";
b.y = 10;

var textStrings = [a, b]; 
```

您还可以使用特殊对象。`toString`将对象转换为字符串时会自动使用该方法：

```
function Text(t, x, y) {
    this.text = t; this.x = x; this.y = y;
}
Text.prototype.toString = function() { return this.text; }
alert(new Text("hello", 0, 0)); // implicit string conversion
console.log(""+new Text("world", 10, 10)); // explicit string conversion 
```

我想无论如何你都会有这样一个构造函数，以简化`textStrings`数组的语法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T23:09:48.533

如果保证您的文本字符串是唯一的，则可以将它们用于索引：

```
var textStrings = {};
textStrings["world"].x = 10;
textStrings["world"].y = 10; 
```

然后您可以使用以下代码段获取“文本”字符串的列表（以便您可以索引对象）：

```
textkeys : function  (textStrings) {
   var accumulator = [];
   for (var propertyName in o) {
      arr.push(propertyName);
   }
   return accumulator;
} 
```

来自[snipplr](http://snipplr.com/view/2841/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T23:32:43.350

类似于@Bergi 的想法，但使用函数式方法来创建对象：

```
var textCreator = function (text, x, y) {
    var that = {};

    that.text = text;
    that.x = x;
    that.y = y;

    that.toString = function () {
        return text;
    }

    return that;
};

textStrings = [];
textStrings[0] = textCreator("hello", 0 ,10);

textStrings[1] = textCreator("world", 10, 10); 
```

并且只是为了完整性：您可以扩展`String`原型，但这是不可取的，实际上与 Bergi 提供的解决方案之一相同。

```
String.prototype.x = null;
String.prototype.y = null;

textStrings = [];
//textStrings[0] = "hello";
textStrings[0] = new String("hello");
textStrings[0].x = "0";
textStrings[0].y = 10;

//textStrings[1] = "world";
textStrings[1] = new String("world");
textStrings[1].x = 10;
textStrings[1].y = 10; 
```

# c# - 安装 Windows 服务时出错——服务没有及时响应启动或控制请求

> ID：10825514
> 
> 赞同：3
> 
> 时间：2012-05-30T23:06:50.067
> 
> 标签：c#, .net, windows-services

我有一个 Windows 服务应用程序，已安装在我的机器上，没有问题。我去另一台机器上安装它，我收到错误

> 错误 1001。在安装的提交阶段发生异常。此异常将被忽略，安装将继续。但是，安装完成后应用程序可能无法正常运行。无法在计算机“.”上启动服务 MyService。服务未及时响应启动或控制请求。

此错误立即弹出，没有任何挂起。通常我只希望在挂起后看到这个错误。

我正在使用安装在两台机器上的 .NET 4 框架。我尝试禁用可能会干扰服务启动的防病毒程序，但这会产生相同的错误。防火墙也被禁用。

还有其他可能导致此问题的原因吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T18:59:25.970

谢谢大家的帮助。我意识到问题是由于安装在两台不同机器上的 .NET Framework 造成的。我的机器有 .NET Framework 4 Client Profile 和 .NET Framework 4 Extended，而另一台机器只有 .NET Framework 4 Client Profile。显然，服务中的某些组件需要 .NET Framework 4 客户端配置文件中不存在的库。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-30T23:21:43.937

[当在 WinService 的OnStart 方法](http://msdn.microsoft.com/en-us/library/system.serviceprocess.servicebase.onstart.aspx)中引发异常并且未在[try-catch](http://msdn.microsoft.com/pt-br/library/0yd65esw.aspx)块中捕获时，通常会发生此行为。我相信您可以使用 EventViewer 查看异常消息和堆栈跟踪，如果没有，您可以使用[EventLog 类](http://msdn.microsoft.com/en-us/library/system.diagnostics.eventlog.aspx)轻松实现简单的日志记录功能。

有时会抛出异常，因为服务未在特权帐户下运行。要解决此问题，您必须配置安装程序的[ServiceProcessInstaller 对象](http://msdn.microsoft.com/en-us/library/76ykzf40%28v=vs.100%29)，如下所示：

```
myServiceInstaller.Account = ServiceAccount.User;
myServiceInstaller.Username = "Domain name\User name";
myServiceInstaller.Password = "qwerty"; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-30T23:26:25.020

由于您的服务在另一台计算机上运行，​​并且假设两者的代码相同，因此问题可能与权限有关。确保运行您的服务的帐户对其写入文件的任何文件夹具有足够的权限。如果您写入事件日志，请确保服务帐户具有必要的权限。

# wordpress - Magento Wordpress Nginx 配置

> ID：10825516
> 
> 赞同：2
> 
> 时间：2012-05-30T23:06:58.303
> 
> 标签：wordpress, magento, nginx

[我在http://example.com](http://example.com)有一个 Magento 商店，我想在 http://example.com/blog 保留一个 Wordpress[博客](http://example.com/blog)。我已经安装了博客，一切似乎都很好，但是当我登录到 Wp-Admin 时，css 和 js 文件出现 404，因为仪表板看起来很丑。我做错了吗？我正在附加我的 nginx 配置文件

```
##################################################################################
#
#                       example.com
#
##################################################################################
server {
    listen       80;
    server_name  example.com ;
    #charset koi8-r;

        #access_log  /var/log/nginx/access.log;
        error_log  /var/log/nginx/error.log;

    location / {
        root   /usr/share/nginx/html/mebozo-magento.mebozo.com;
        try_files $uri $uri/ @handler; ## If missing pass the URI to Magento's front handler
        index  index.php index.html index.htm;
    }
        location /blog {
        root   /usr/share/nginx/html/mebozo-magento.mebozo.com/blog;
        try_files $uri $uri/ /blog/index.php;
        index  index.php index.html index.htm;
        rewrite ^.*/files/(.*) /wp-includes/ms-files.php?file=$2;
        rewrite ^.*/wp-admin(.*) $1wp-admin/;

    }

    location ~* ^.+\.(html|jpg|jpeg|gif|png|ico|css|zip|tgz|gz|rar|bz2|doc|xls|exe|pdf|ppt|txt|tar|mid|midi|wav|bmp|rtf|js)$
        {
        root  /usr/share/nginx/html/mebozo-magento.mebozo.com/blog;
        rewrite ^/.*(/.*\.(html|jpg|jpeg|gif|png|ico|css|zip|tgz|gz|rar|bz2|doc|xls|exe|pdf|ppt|txt|tar|mid|midi|wav|bmp|rtf|js))$ $1 last;

        rewrite ^.*/files/(/.*(html|jpg|jpeg|gif|png|ico|css|zip|tgz|gz|rar|bz2|doc|xls|exe|pdf|ppt|txt|tar|mid|midi|wav|bmp|rtf|js))$/wp-includes/ms-files.php?file=$1 last;

        expires 30d;
        break;
        }

## These locations would be hidden by .htaccess normally

#location ~* \.(js|css|png|jpg|jpeg|gif|ico)$ {
#expires 1y;
#log_not_found off;
#}

        location ~ .php/ { 
        ## Forward paths like /js/index.php/x.js to relevant handler
        rewrite ^(.*.php)/ $1 last;
    }

################For Foomen Speedster###############
#rewrite ^/minify/([0-9]+)(/.*.(js|css))$ /lib/minify/m.php?f=$2&d=$1 last;
#    rewrite ^/skin/m/([0-9]+)(/.*.(js|css))$ /lib/minify/m.php?f=$2&d=$1 last;

#    location /lib/minify/ {
#        allow all;
#    }

error_page  404              /404.html;
    location = /404.html {
        root   /usr/share/nginx/html;
    }

#############gzip###########

        gzip on; # use gzip compression
        gzip_min_length 1100;
        gzip_buffers 4 8k; 
        gzip_proxied any; # enable proxy for the fcgi requests
        gzip_types text/plain text/css application/x-javascript text/javascript application/json; 

    # redirect server error pages to the static page /50x.html
    #
    error_page   500 502 503 504  /50x.html;
    location = /50x.html {
        root   /usr/share/nginx/html;
    }

    # proxy the PHP scripts to Apache listening on 127.0.0.1:80
    #
    #location ~ \.php$ {
    #    proxy_pass   http://127.0.0.1;
    #}
    location @handler { ## Magento uses a common front handler
        rewrite / /index.php;
    }

    # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000
    #

    location ~ \.php$ {
        #      if (!-e $request_filename) { rewrite / /index.php last; } ## Catch 404s that try_files miss
        root           /usr/share/nginx/html/mebozo-magento.mebozo.com;
        fastcgi_pass   127.0.0.1:9000;
        fastcgi_index  index.php;
        fastcgi_param  SCRIPT_FILENAME  /usr/share/nginx/html/mebozo-magento.mebozo.com$fastcgi_script_name;
        include        fastcgi_params;
    }

    # deny access to .htaccess files, if Apache's document root
    # concurs with nginx's one
    #
    location ~ /\.ht {
        deny  all;
    }    
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-07-21T05:45:17.157

我将尝试通过建议我们清理您的 nginx 配置文件来解决这个难题。您的 */files/ 重写对我来说似乎有问题。

在不知道你的 nginx.conf 文件是什么样子或者你的 http {block} 是什么样子的情况下，我会假设它非常干净并且你正在处理你的全局设置，比如 gzip 类型、ssl 协议和密码，以及额外的头文件等。 那里。我知道你在你的文件中包含了你的 gzip，但有时在服务器中复制它没有意识到它已经在上面设置了一个层......如果没有根据需要重新添加你的 gzip。综上所述，在完全阅读了您的 conf 文件后，我建议将其重写为以下内容：

（注意：新的 URI 级别位置和 @rewrites，以及删除了多余的根路径定义。）

```
server {
    listen 80;
    listen [::]:80;

    ## SSL CONFIGURATION (can be done here in same file)
    #listen 443 ssl http2;
    #listen [::]:443 ssl http2;
    #ssl_certificate     /etc/nginx/ssl/cert_chain.crt;
    #ssl_certificate_key     /etc/nginx/ssl/star_example.com.priv.key;

    # domain name
    server_name example.com www.example.com;

    # doc root
    root /usr/share/nginx/html/mebozo-magento.mebozo.com;

    ## Logs per vhost
    access_log      /var/log/nginx/example.com.access.log;
    error_log       /var/log/nginx/example.com.error.log warn;

    ## This can also be set in your http block and if it is, it's not needed here.
    index index.php index.html index.htm;

    # Adjust upload max file size settings
    # This value should match your PHP.ini config settings for upload_max_filesize
    client_max_body_size 50M; # allows file uploads up to 50 megabytes

    location = /favicon.ico {
        log_not_found off;
        access_log off;
    }
    location = /robots.txt {
        allow all;
        log_not_found off;
        access_log off;
    }

    ## Main Magento location
    location / {
        try_files $uri $uri/ @rewrite;
    }

    # Your blog location
    location /blog/ {
        try_files $uri $uri/ @rewrite_blog;
    }

    # redirect server error pages to the static page /50x.html
    error_page   500 502 503 504  /50x.html;
    location = /50x.html {
        root    /usr/share/nginx;
    }

    ## These locations are protected
    location ~ /(app|downloader|includes|pkginfo|var|errors/local.xml)/ {
        deny all;
    }

    ## Images
    location ~* \.(js|css|png|jpg|jpeg|gif|ico)$ {
        expires max;
        log_not_found off;
        access_log off;
        add_header ETag "";
    }

    location =/js/index.php/x.js {
        rewrite ^(.*\.php)/ $1 last;
    }

    # rewrites
    location @rewrite {
        rewrite / /index.php?$args;
    }

    location @rewrite_blog {
        rewrite /blog/ /blog/index.php?$args;
    }

    ## Execute PHP scripts
    location ~ \.php$ {
        try_files $uri =404;
        fastcgi_split_path_info ^(.+\.php)(/.+)$;
        fastcgi_pass   127.0.0.1:9000;
        fastcgi_index index.php;
        ## Store code with multi store/domain magento instance
        #fastcgi_param MAGE_RUN_CODE $mage_code;
        #fastcgi_param MAGE_RUN_TYPE $mage_type;
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
        include fastcgi_params;
    }

    # Banned locations (only reached if the earlier PHP entry point regexes don't match)
    location ~* (\.php$|\.sh$|\.txt$|\.htaccess$|\.git|\.sample$|mage$) {
        deny all;
    }
} 
```

# geolocation - Maps API - 城市街区分辨率？

> ID：10825521
> 
> 赞同：0
> 
> 时间：2012-05-30T23:07:31.210
> 
> 标签：geolocation, maps, latitude-longitude, openstreetmap

“城市街区”定义：由 4 条交叉街道包围的区域（通常是矩形）：http: [//gyazo.com/46e1e6f0bbe97db8dd7dd19b0f38d016](http://gyazo.com/46e1e6f0bbe97db8dd7dd19b0f38d016)

有没有一种方便的方法可以计算出最近的城市街区到很长的地方？

如果是这样，有没有办法获得“城市街区”的左下角和右上角点的经纬度？

我偏爱 Open Street Maps 中的解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T08:46:58.527

[OverpassAPI](http://wiki.openstreetmap.org/wiki/Overpass_API)有一个[环绕](http://wiki.openstreetmap.org/wiki/Overpass_API#Around)查询，允许您获取给定位置周围的特定对象（例如标记为[Highway=residential的方式）。](http://wiki.openstreetmap.org/wiki/Tag%3ahighway=residential)您仍然必须确定这些街道是否以及哪些街道定义了一个街区并计算它们的交叉口（每个交叉口都应该有一个节点），以便获得这些交叉口的 lan,lon。

你也可以在[OSM 帮助](http://help.openstreetmap.org/)网站上问这个问题。

# html - Rails 3，在控制器中进行提交调用特定功能

> ID：10825522
> 
> 赞同：0
> 
> 时间：2012-05-30T23:07:40.923
> 
> 标签：html, ruby-on-rails, submit

Web 开发新手，请点击此处。我有这样的表格：

```
<form name="myForm" id="myForm"  method="post" >

      <select id="id" name="foo">
        ...some stuff
      </select>

      <input type="submit"/>
</form> 
```

正如预期的那样，提交按钮调用我的控制器的“索引”方法。我想让它调用一些其他功能，例如“更新”，我该怎么做？我需要对@_params 哈希做一些事情，但我不想调用索引函数来做这件事。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T00:15:49.350

您没有包含视图逻辑，因此我将在黑暗中尝试一下，并猜测您正在为表单编写 HTML，而不是使用 RoR 帮助程序。

在 Rails 中，有一组帮助程序可以帮助您生成表单和表单项。

请检查[form_for的文档](http://api.rubyonrails.org/classes/ActionView/Helpers/FormHelper.html#method-i-form_for)

除非您修改 url 参数，否则使用 form_for 将遵循基本的 restful 路由。所以如果你在/new，你将被路由到/create，如果你在/edit，你将被路由到/update。更准确地说，如果对象是新的，您将提交创建，如果模型存在，您将提交更新。

如果您的表单不使用模型，您可以使用带有 url 参数的[form_tag](http://api.rubyonrails.org/classes/ActionView/Helpers/FormTagHelper.html#method-i-form_tag)助手，您可以传递一个字符串来指定要提交到的路径。

如果您只需要知道如何在纯 HTML 中执行此操作，请阅读[此](http://www.w3schools.com/html/html_forms.asp). 本质上，您需要在表单上包含一个 action 属性，该属性指定您要发布到的操作的路径。

# attr - 如何使用 QueryPath 按属性查找元素

> ID：10825525
> 
> 赞同：0
> 
> 时间：2012-05-30T23:08:41.857
> 
> 标签：attr, querypath

我需要找到所有表`width=230`

到目前为止，我有：

```
foreach($qp->top('table')->get() as $table) {
    $width = $table->attr('width');
} 
```

但我得到一个`"Call to undefined method DOMElement::attr()"`错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T20:12:11.517

尝试类似的东西

```
$table->find('[width="230"]'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-25T23:08:18.390

看来， $table 是一个[DOMElement](http://php.net/manual/en/domelement.getattribute.php)，所以可能你可以做

```
$width = $table->getAttribute('width); 
```

# php - 带有“ : ”的友好 URL

> ID：10825527
> 
> 赞同：2
> 
> 时间：2012-05-30T23:08:46.887
> 
> 标签：php, regex, friendly-url

我有以下代码，它`$_GET`通过控制器、动作和参数获取并进行划分

```
http://localhost/controller/action/param1/param2

$url = explode('/', $_GET['url']);
$urlSize = count($url);
$filter = $this->factory('Core\Security\Filter');

if($urlSize >= 1) {
    $controller = $filter->replace($url[0], 'friendly-url');

    if($urlSize >= 2) {
        $action = $filter->replace($url[1], 'friendly-url');

        if($urlSize >= 3) {
            unset($url[0], $url[1]);

            foreach($url as $index => $param) {
                $params[] = $filter->replace($param, 'friendly-url');
            }
        }
    }
} 
```

`Core\Security\Filter->replace()`我现在正在开发：

```
public function replace($data = null, $type = 'alphanumeric') {
    /*
        @TODO, implement regex by type

        numeric
                $regex = '/^[[:digit:]]$/';
        alphanumeric
                $regex = '/^[[:alnum:]]$/';
        friendly-url
                $regex = '/[^a-zA-Z0-9_-]+/';
                $replace = '-'
        username
                $regex = '/^[^a-zA-Z0-9_-.]{3,32}+';
        email
                $regex = '/^[[a-zA-Z0-9_-.]{1,96}]+@[a-zA-Z0-9-]{2,64}+(?:\.[a-zA-Z0-9-]+)*$/';
    */
} 
```

好的，我遇到的问题是：如何获取这种格式的网址：

```
http://localhost/controller/action/param1/param2:value2 
```

$参数数组：

```
Array(
    [0] => param1
    [1] => Array(
       [param2] => value2
    )
) 
```

**解决了这个问题：**

```
foreach($url as $index => $param) {
    if(strstr($param, ':')) {
        $subParam = explode(':', $param, 2);
        $this->_request['params'][][$subParam[0]] = $filter->replace($subParam[1], 'friendly-url-param');
    } else {
        $this->_request['params'][] = $filter->replace($param, 'friendly-url-param');
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T23:21:52.693

```
<?php

$url = 'http://localhost/controller/action/param1/param2:value2';

$parts = parse_url($url);
$path = $parts['path'];

list($controller, $action, $params) = explode('/', ltrim($path, '/'), 3);

function parse_params($params) {
    $parsed_params = array();
    $path_segments = explode('/', $params);
    foreach ($path_segments as $path_segment) {
        if (strstr($path_segment, ':')) {
            list($k, $v) = explode(':', $path_segment, 2);
            $parsed_params[] = array($k => $v);
        } else {
            $parsed_params[] = $path_segment;
        }
    }
    return $parsed_params;
}

$params = parse_params($params);

print_r($params); 
```

**输出**

```
Array
(
    [0] => param1
    [1] => Array
        (
            [param2] => value2
        )

) 
```

# jar - 安装 Winrar 后无法执行的自可执行 Jar 文件

> ID：10825530
> 
> 赞同：0
> 
> 时间：2012-05-30T23:09:07.057
> 
> 标签：jar, winrar

这是交易，我已经将一些类编译成一个 jar 文件，其中包含指向主类的清单。它在我的电脑上运行良好。

我将 jar 文件转移到另一台计算机上，明天我应该做一个演示，好吧，这就是事情走下坡路的地方。

Winrar 没有安装，所以我安装它是为了提取我的 jar 文件所在的文件夹。我在不知不觉中将 winrar 与 jar 相关联，我通过使用 jre7/bin/java.exe 更改默认打开程序来修复它。但是，jar 文件不会像以前那样自动执行。我在想注册表出了点问题。

Stackoverflow，你怎么看？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T23:23:12.820

我想一个简单的解决方案是重新安装 JRE。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-30T00:55:50.717

您需要重置“.jar”文件的文件关联，“jre7/bin/java.exe”不会执行 jar 文件。所以在选择默认程序到“jre7/bin/java.exe”之前你应该做的是简单地卸载 WinRAR 或从 WinRAR 设置中删除它的关联。所以现在，打开开始菜单，搜索并打开 regedit.exe 转到 HKEY_CLASSES_ROOT/.jar 并删除除“（默认）”之外的每个值，他们的值数据应该是“jarfile”。重新安装 jre 并重新启动 pc 。这就是您的解决方案。

# linq - 如何获取 LinqDataSource 使用的 IQueryable 对象？

> ID：10825533
> 
> 赞同：1
> 
> 时间：2012-05-30T23:09:17.650
> 
> 标签：linq, linqdatasource

有没有办法获取 LinqDataSource 用来检索数据的 IQueryable 对象？我认为这可能来自***所选***事件，但似乎并非如此。

我的表中的每一行都有一个类别字段，我想确定结果中每个类别有多少行。

我还应该注意，我使用的是 DataPager，因此并非所有行都被返回。这就是为什么我想获得 IQueryable，这样我就可以做类似的事情

```
int count = query.Where(i => i.Category == "Category1").Count(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T11:36:01.183

使用[QueryCreated 事件](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.queryabledatasource.querycreated.aspx)。`QueryCreatedEventArgs`有一个`Query`包含`IQueryable`.

该事件在创建原始 LINQ 查询后引发，并包含在将其发送到数据库之前的查询表达式，没有排序和分页参数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T23:32:15.767

IQueryable 中没有“选定”事件。此外，如果您在服务器上过滤数据，即使 API 公开了数据，您也无法访问它，但要回答部分问题，假设您有 category -> product 其中每个类别有很多产品，您想要每个类别中的产品数量。这将是一个简单的 LINQ 查询：

```
var query = GetListOfCategories();
var categoryCount = query.Select(c => c.Products).Count(); 
```

同样，根据 GetListOfCategories 返回的对象类型，您最终可能会获得所有条目的正确值，或者只是那些已加载并在内存中的条目，但这是 Linq-to-Objects（在内存中）和Linq 到其他数据源（延迟加载）。

# java - ColdFusion 和 Java（docx4j 库）

> ID：10825539
> 
> 赞同：2
> 
> 时间：2012-05-30T23:10:14.327
> 
> 标签：java, coldfusion, jar, docx, docx4j

我需要进行 docx 操作（查找/替换占位符和选中/取消选中复选框）。由于 ColdFusion 10 与 Java 很好地集成，我决定尝试使用 Java 库 docx4j，它基本上模仿了 OpenXML SDK（.net 平台）。

我在自定义文件夹中有 docx4j JAR，我通过 JavaSettings 在我的 Application.cfc 中设置了它（CF10 中的新功能，我用其他 JARS 进行了尝试，它可以工作）：

```
<cfcomponent output="false">

    <cfset this.javaSettings =
        {LoadPaths = ["/myJava/lib"], loadColdFusionClassPath = true, reloadOnChange= true, 
        watchInterval = 100, watchExtensions = "jar,class,xml"} />

</cfcomponent> 
```

现在，我正在尝试使用此示例：[https ://github.com/plutext/docx4j/blob/master/src/main/java/org/docx4j/samples/VariableReplace.java](https://github.com/plutext/docx4j/blob/master/src/main/java/org/docx4j/samples/VariableReplace.java)

但是尝试调用 WordprocessingMLPackage 失败，函数*CreateObject()*说特定类不存在：

```
<cfset docObj = createObject("java","org.docx4j.openpackaging.packages.WordprocessingMLPackage") /> 
```

有任何想法吗？我不是一个真正的 Java 人，但是对于 docx 操作没有太多选择。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T23:13:44.207

好吧。好像我让一切正常。我只需要弄清楚如何进行查找/替换，以及我想在 docx 文档中做的所有其他事情。到目前为止，这是我的代码，向你们展示它看起来正在工作（如果您使用的是 CF10，请确保您的 Application.cfc 看起来像原始帖子）：

```
<cfscript>

    docPackageObj = createObject("java","org.docx4j.openpackaging.packages.WordprocessingMLPackage").init();
    docObj = createObject("java","org.docx4j.openpackaging.parts.WordprocessingML.MainDocumentPart").init();
    xmlUtilObj = createObject("java","org.docx4j.XmlUtils").init();
    wmlDocObj = createObject("java","org.docx4j.wml.Document").init();
    saveToZipFile = createObject("java","org.docx4j.openpackaging.io.SaveToZipFile").init(docPackageObj);

    strFilePath = getDirectoryFromPath(getCurrentTemplatePath()) & "testDoc.docx";

    wordMLPackage = 
        docPackageObj.load(createObject("java","java.io.File").init(javaCast("string",strFilePath)));

    documentPart = wordMLPackage.getMainDocumentPart();

    // unmarshallFromTemplate requires string input     
    strXml = xmlUtilObj.marshaltoString(documentPart.getJaxbElement(),true);

    writeDump(var="#strXml#");

</cfscript> 
```

现在，有人知道如何将 ColdFusion 中的结构转换为哈希图（或一般的集合）吗？我认为CF中的结构实际上是util.Vector，而hashmaps是util.HashMap。我在 Docx4j 中看到的所有演示在占位符中查找/替换的示例都使用了这个：

```
HashMap<String, String> mappings = new HashMap<String, String>();
mappings.put("colour", "green");
mappings.put("icecream", "chocolate"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T11:55:44.560

您是否尝试过设置 loadColdFusionClassPath = false 而不是 true？可能与带有 CF 的某些 JAR 存在冲突。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T05:51:19.760

（并不是一个真正的新答案，但评论代码太多了..）

这是 docx4j [VariableReplace.java](https://github.com/plutext/docx4j/blob/master/src/main/java/org/docx4j/samples/VariableReplace.java)示例的完整代码

```
<cfscript>
    saveToDisk = true;
    inputFilePath = ExpandPath("./docx4j/sample-docs/word/unmarshallFromTemplateExample.docx");
    outputFilePath = ExpandPath("./OUT_VariableReplace.docx");

    inputFile = createObject("java", "java.io.File").init(inputFilePath);
    wordMLPackage = createObject("java","org.docx4j.openpackaging.packages.WordprocessingMLPackage").load(inputFile);
    documentPart = wordMLPackage.getMainDocumentPart();

    XmlUtils = createObject("java","org.docx4j.XmlUtils");
    xmlString  = XmlUtils.marshaltoString(documentPart.getJaxbElement(),true);

    mappings = createObject("java", "java.util.HashMap").init();
    mappings["colour"] = "green";
    mappings["icecream"] =  "chocolate";
    obj = XmlUtils.unmarshallFromTemplate(xmlString , mappings);
    documentPart.setJaxbElement(obj);

    if (saveToDisk) {
        saveToZipFile = createObject("java","org.docx4j.openpackaging.io.SaveToZipFile").init(wordMLPackage);
        SaveToZipFile.save( outputFilePath );
    } 
    else {
        WriteDump(XmlUtils.marshaltoString(documentPart.getJaxbElement(), true, true));
    }
</cfscript> 
```

# booksleeve - Booksleeve - 设置多个哈希值并一次检索它们

> ID：10825542
> 
> 赞同：1
> 
> 时间：2012-05-30T23:10:34.197
> 
> 标签：booksleeve

我正在尝试独立设置散列的多个字段并在以后一次全部检索它们。下面的代码应该工作还是在这里做错了什么？当我在从 Service Stack 站点下载的 Windows 上针对 redis-2.0.0-x64 在本地运行它时，task3 的结果将始终只包含 field2。

```
var con = RedisConnectionManager.Instance.GetConnection();
var key = "somekey1";

// set the field value and expiration
var task = con.Hashes.Set(1, key, "field1", token.ToByteArray())
    .ContinueWith((x)=> con.Keys.Expire(1, key, 7200));
task.Wait();

var task2 = con.Hashes.Set(1, key, "field2", "fooobar");
task2.Wait();

var task3 = con.Hashes.GetAll(1, key);
task3.Wait(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T05:40:49.317

无法在当前版本的 redis 上重现这一点 - 在这里看起来不错：

```
using (var con = Config.GetUnsecuredConnection())
{
    var key = "somekey1";

    // set the field value and expiration
    var task = con.Hashes.Set(1, key, "field1", Encoding.UTF8.GetBytes("hello world"))
        .ContinueWith((x) => con.Keys.Expire(1, key, 7200));
    task.Wait();

    var task2 = con.Hashes.Set(1, key, "field2", "fooobar");
    task2.Wait();

    var task3 = con.Hashes.GetAll(1, key);
    task3.Wait();

    Assert.AreEqual(2, task3.Result.Count);
    Assert.AreEqual("hello world", Encoding.UTF8.GetString(task3.Result["field1"]));
    Assert.AreEqual("fooobar", Encoding.UTF8.GetString(task3.Result["field2"]));
} 
```

或者，更有效（使用流水线，不等待）：

```
using (var con = Config.GetUnsecuredConnection())
{
    var key = "somekey1";

    // set the field value and expiration
    con.Hashes.Set(1, key, "field1", Encoding.UTF8.GetBytes("hello world"));
    con.Keys.Expire(1, key, 7200);
    con.Hashes.Set(1, key, "field2", "fooobar");
    var task = con.Hashes.GetAll(1, key);
    con.Wait(task);

    Assert.AreEqual(2, task.Result.Count);
    Assert.AreEqual("hello world", Encoding.UTF8.GetString(task.Result["field1"]));
    Assert.AreEqual("fooobar", Encoding.UTF8.GetString(task.Result["field2"]));
} 
```

所以是的：应该工作，并且似乎工作。注意我在本地使用 2.4.5；2.0现在已经*很*老了，并且有许多重要的错误。*完全有可能在服务器*上存在与 HSET plus EXPIRE 相关的错误- 在这种情况下，客户端库无法弥补。

我*强烈*建议使用比 2.0 更“当前”的 redis-server 版本。如果一个不可用，您可能想尝试[dmajkic](https://github.com/dmajkic/redis/downloads)二进制文件（转到 2.4.5）或 [MSOpenTech]*https://github.com/MSOpenTech/redis）源。然而！！！这仅用于本地调试。对于**当前的***生产*工作（即直到 MSOpenTech 代码快乐-快乐），我建议使用 linux 服务器来托管 redis。Ubuntu 服务器运行良好。

# time - 具有相关作业运行时条件的 Autosys R11 作业依赖性

> ID：10825544
> 
> 赞同：6
> 
> 时间：2012-05-30T23:10:49.240
> 
> 标签：time, dependencies, scheduling, autosys

在 Autosys R11 中，仅当 job_a 在过去 X 小时内成功时，我才需要运行 job_b。显然，[R11 允许您“将对 job_a 的回溯依赖项设置为仅当 job_c 在 X 小时内运行到 S 时才运行”。](https://stackoverflow.com/a/1837263/1112765)语法是什么？

```
s(job_a) 
```

例如，如果我希望我的作业仅在 job_a 在过去 12 小时内成功运行时运行，我会添加什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-05T15:06:36.130

应该

条件：成功（job_a，12.00）

状态（工作名称，hhhh.mm）

# python - Python：如何在列表中的 if [多个值] 中测试多个值：

> ID：10825548
> 
> 赞同：0
> 
> 时间：2012-05-30T23:11:10.803
> 
> 标签：python

我从 HTML 文档返回了一个 href 值列表。我想浏览此列表中的每个链接并测试它们是否包含我的`IMAGE_FORMAT`元组中的任何值。

```
IMAGE_FORMAT = (
    '.png',
    '.jpg',
    '.jpeg',
    '.gif',
) 
```

目前我只是在测试`'.jpg'`例如 `if '.jpg' in link.get('href'):`

我想将此代码扩展到以下内容`if [any value inside IMAGEFORMAT] in link.get('href'):`

什么是最有效或最干净的方式或这样做？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-30T23:19:57.800

如果你真的想要`in`，那么也许

```
href = link.get('href')
if any(end in href for end in IMAGE_FORMAT):
    # do something
    pass 
```

但如果你真的想要`ends with`，那么使用`.endswith`：

```
>>> IMAGE_FORMAT = ('.png','.gif','.jpg','.jpeg')
>>> 'fred.gif'.endswith(IMAGE_FORMAT)
True 
```

取决于您要如何处理“fred.gif.gz”等。另外请注意，如果您不关心大小写，您可能希望使用 href.lower()。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T23:19:06.533

尝试`any`反对列表理解。

```
any(e in href for e in IMAGE_FORMAT) 
```

或者，用英语，“我的 URI 中是否有我的图像格式中的任何项目？” 不过，请记住`in`字符串的功能。

# backbone.js - Backbone.js 试图在错误回调传递时保存？

> ID：10825554
> 
> 赞同：0
> 
> 时间：2012-05-30T23:11:56.427
> 
> 标签：backbone.js

我有一个集合：`conditions`。在一个视图中，在返回`HTTP 403`错误响应后，我显然不想创建模型：

```
var attributes = ...;
conditions.create(attributes, {
  error: function (model, response) {
    conditions.trigger('error');
    var response = JSON.parse(response.responseText);
    console.log(response);
  }
}); 
```

`error`回调被正确调用。响应已正确记录。但是骨干仍然将（损坏的）模型添加到集合中！当我查看 时`conditions.toJSON()`，有一个带有一些损坏属性的新模型。

我从服务器返回了一个错误，我如何坚持 Backbone 不将新模型添加到集合中？

我可以`conditions.remove(model)`在回调中做，但我必须这样做吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-31T00:31:00.477

您可以传递`{wait: true}`给该`create`方法。

> 一旦在服务器上成功创建模型，创建模型将导致在集合上触发即时`"add"`事件以及事件。如果您想在将新模型添加到集合之前等待服务器，请通过`"sync"`。`{wait: true}`

[http://documentcloud.github.com/backbone/#Collection-create](http://documentcloud.github.com/backbone/#Collection-create)

# php - 我什么时候应该在没有 die() 的情况下调用 header('Location')？

> ID：10825556
> 
> 赞同：2
> 
> 时间：2012-05-30T23:12:07.973
> 
> 标签：php, redirect, http-headers, location, die

`header('Location:')`没有在它之后调用是否`die()`有意义？

如果不是，为什么`die()`PHP 解释器不自动执行？如果是，什么时候？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-30T23:21:03.787

`header('Location: ')`将进行[HTTP 重定向](http://en.wikipedia.org/wiki/HTTP_redirect)，告诉浏览器转到新位置：

```
HTTP/1.1 301 Moved Permanently
Location: http://example.com/another_page.php
Connection: close 
```

它不需要任何 HTML 正文，因为浏览器不会显示它，只需遵循重定向即可。这就是我们调用`die()`或`exit()`之后的原因`header('Location:')`。如果您不终止脚本，HTTP 响应将如下所示。

```
HTTP/1.1 301 Moved Permanently
Location: http://example.com/another_page.php
Connection: close

<!doctype html>
<html>
<head>
  <title>This is a useless page, won't displayed by the browser</title>
</head>
<body>
  <!-- Why do I have to make SQL queries and other stuff 
       if the browser will discard this? -->
</body>
</html> 
```

**为什么 PHP 解释器不自动执行 die() ？**

该`header()`函数用于发送原始 HTTP 标头，不限于`header('Location:')`. 例如：

```
header('Content-Type: image/png');
header('Content-Disposition: attachment; filename="downloaded.pdf"');
// ...more code... 
```

在这种情况下，我们不会调用`die()`，因为我们需要生成 HTTP 响应正文。`die()`所以如果 PHP 自动调用after是没有意义的`header()`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-30T23:15:07.897

在我个人看来，您应该`die()`在不想再执行脚本时调用。如果您不希望脚本在您之后执行，您`header("Location: ...")`应该`die()`在它之后立即执行。

基本上，如果您不这样做，您的脚本可能会进行不必要的额外计算，因为服务器无论如何都会重定向他，因此对用户永远不会“可见”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-30T23:33:33.190

[这个 PHP 用户说明](http://www.php.net/manual/en/features.connection-handling.php#89177)中解释了一个很好的例子，复制到这里以供后代使用：

* * *

> 在告诉浏览器输出完成后继续处理的 arr1 建议的简单但有用的包装。
> 
> 当请求需要一些处理时，我总是重定向（所以我们不会在刷新时做两次），这让事情变得简单......

```
<?php 
 function redirect_and_continue($sURL) 
 { 
  header( "Location: ".$sURL ) ; 
  ob_end_clean(); //arr1s code 
  header("Connection: close"); 
  ignore_user_abort(); 
  ob_start(); 
  header("Content-Length: 0"); 
  ob_end_flush(); 
  flush(); // end arr1s code 
  session_write_close(); // as pointed out by Anonymous 
 } 
?> 
```

* * *

这对于需要很长时间的任务很有用，例如转换视频或缩放大图像。

# c++ - C ++查找数组中数字的平均值

> ID：10825557
> 
> 赞同：2
> 
> 时间：2012-05-30T23:12:16.460
> 
> 标签：c++, arrays, average

```
for( k = 0; k < n; k++ )
{
   total += total + temps[k];
}

avgTemp = total / n; 
```

`temps`是我包含`n`元素的数组。`avgTemp`将所有值的平均值存储在`temps`. k 只是使我的循环工作的一些整数。k、n 和 total 已经在上面某处适当地声明了。`total`跟踪数组中元素的总数。

我的锻炼事情告诉我这是错误的。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-30T23:14:53.800

这个

```
for( k = 0; k < n; k++ )
{
    /// here's the error.
    /// You assign the new value to total as (total = total + total + temps[k])
    total += total + temps[k];
}

avgTemp = total / n; 
```

应该

```
for( k = 0; k < n; k++ ) { total += temps[k]; }

avgTemp = total / n; 
```

或者

```
for( k = 0; k < n; k++ ) { total = total + temps[k]; }

avgTemp = total / n; 
```

使用迭代求和会更好。它可以避免舍入误差。

```
avgTemp = temps[0];

for(k = 1 ; k < n ; k++) { total = (temps[k] + (double)(k-1) * total)/ (double)k; } 
```

bames53 还在评论中提供了一个不错的基于 STL 的代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-30T23:14:47.017

第一的，`total += temps[k]`

+= 表示`total = total + temps[k]`已经

顺便说一下，total 是声明为浮点数还是双精度数？否则你正在做一个整数除法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-30T23:16:48.963

您的代码在每次迭代中都向自身添加“总计”，这不是您想要的。你需要改变：

```
total += total + temps[k]; 
```

至

```
total += temps[k]; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-30T23:15:53.477

当获得数字的总和时，您将总数添加到自身，然后添加下一个元素。

```
total += total + temps[k]; 
```

应该：

```
total += temps[k]; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-01-09T16:54:55.997

正如[bames53 的评论](https://stackoverflow.com/questions/10825557/c-finding-the-average-of-the-numbers-in-an-array#comment14092426_10825557) [`accumulate`](https://en.cppreference.com/w/cpp/algorithm/accumulate)中提到的那样，这确实是您解决此问题的最佳选择。给定`n`哪个是容器的大小，`it`哪个是指向容器第一个元素的指针或迭代器，您可以对数组、动态分配的数组或向量执行此操作：

```
const auto avgTemp = accumulate(it, next(it, n), typename iterator_traits<remove_const_t<decltype(foo)>>::value_type{}) / n; 
```

[`Live Example`](https://coliru.stacked-crooked.com/a/e27646641b3147c1)

# perl - Perl 魔法钻石的安全使用

> ID：10825558
> 
> 赞同：2
> 
> 时间：2012-05-30T23:12:17.417
> 
> 标签：perl

B::Lint 不喜欢`while (<>) {do stuff}`，文档显示令人讨厌的注入攻击，因为它在内部使用了 evil 2 参数 open。有没有一种简单的方法可以使这种使用更安全？我有很多使用它的小脚本。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-30T23:23:54.520

您可以使用[ARGV::readonly。](http://search.cpan.org/perldoc?ARGV::readonly)它将允许更安全地使用钻石运算符。

> ARGV::readonly - 使 <> 打开文件，而不考虑前导/尾随空格和/或控制字符，例如 |、>、amd <。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T23:35:58.643

魔法钻石是为了您的方便。Getc()、read()、readline() 和 sysread() 都可用，并且每个都提供了安全性与便利性的不同权衡。

# playframework - 源代码生成中的播放框架和布线

> ID：10825559
> 
> 赞同：0
> 
> 时间：2012-05-30T23:12:34.743
> 
> 标签：playframework, playframework-1.x

播放框架 1.2.4

如何从 xsd 或 google 的 protobuf 连接源代码生成，以便生成的源代码

1.  不在 app 目录中，因为我们不希望它在版本控制中
2.  运行 eclipsify 后在 play 的源路径和 eclipse 中

这甚至可能吗？（我有点希望他们使用 gradle 并且很遗憾他们选择了 sbt，因为 sbt 非常奇怪，规则非常奇怪，比如当我们使用它时需要在行之间有两个行间距）。

后来，迪恩

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T06:09:10.117

我相信尝试将源文件放在 app 目录下以外的其他地方会破坏 playframework 的基本范式之一，因此我认为这甚至是不可能的（不确定）。

但是我有两个提议：

1.  如果您的唯一意图是没有将生成的源代码放在版本控制中，您仍然可以将其放在 app 目录下，但将您的版本控制系统设置为忽略此类文件（所有主要版本控制系统都支持忽略列表）

2.  如果您不希望此代码位于主应用程序目录下，请考虑将该代码移动到单独的 playframework 模块中。这会带来一些分离，然后您可以决定模块的哪些部分将在版本控制中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T12:48:23.870

除了bwajtr，

您可以将项目源代码存储在您想要的位置，并将您的 /app 转换为符号链接 ( `ln -s`)。

您可以在 VCS 中对符号链接进行版本控制。

***更新 ：***

[您可以在此处](http://www.playframework.org/documentation/2.0/SBTSubProjects)查看 sbt 子项目的 Play 文档

# java - AndEngine - 检查与 Sprite 或物理体的重叠？

> ID：10825560
> 
> 赞同：1
> 
> 时间：2012-05-30T23:12:39.103
> 
> 标签：java, android, opengl-es-2.0, andengine

我正在努力做到这一点，所以当附加到物理主体的精灵与关卡上的另一个精灵重叠时，会发生一些事情。第二个精灵没有附加到物理体上。

更具体地说，当两个精灵重叠时，我希望游戏不断检查精灵中心之间的距离是否小于某个量。然后，如果距离足够小，就会发生一些事情。

我正在尝试使用碰撞检查作为优化游戏的一种方式，这样它就不必经常检查 A 和 B 类型的每个对象之间的距离，即使它们甚至不接近。它只会在它们足够接近以重叠时检查距离。

现在我想知道我该怎么做？作为 AndEngine 的一部分，有没有办法检查精灵之间的碰撞？或者将物理体附加到第二个对象然后只使用物理碰撞检测会更容易吗？但是，如果我这样做，我可以做到，这样碰撞就会被检测到，但它们实际上不会在物理上“碰撞”吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T11:40:30.333

是的，请参阅[CollisionDetectionExample.java](https://github.com/nicolasgramlich/AndEngineExamples/blob/GLES2/src/org/andengine/examples/CollisionDetectionExample.java)。我建议您下载整个示例包，它在没有任何 AndEngine 文档的情况下非常有用。请注意，碰撞检测不是像素完美的，因此它仍然会检测 Sprite 透明部分的碰撞。有[一个图书馆](https://github.com/m5/andengine-pixel-perfect)，但我担心它已经过时了。

# c# - 在 C# 中“将”浮点数“转换为双精度”

> ID：10825563
> 
> 赞同：0
> 
> 时间：2012-05-30T23:12:57.510
> 
> 标签：c#, floating-point, trigonometry

我有一个粒子生命周期的属性（我正在模拟粒子系统），它是一个浮点值，因为我也将它用于透明度（alpha 是浮点数）。我已经阅读了有关将 float 转换为 double 的问题，并意识到这是一个很大的问题，所以我可能无法将 float 转换为 double。问题是我想尝试从生命变量计算粒子的路径，例如：

```
particle.x += particle.xi;
particle.xi = Math.Sin(life); 
```

注意：生命值在开始时为 1.0f 并减少到 0（如果它 <0.0f 我重新初始化粒子并将生命设置为 1.0f）。
但是Sin想要双倍的价值……我们又回到了起点。因此，一种解决方案可以将 life 属性的类型更改为 double ，当我将其用于透明度时，我只会将此 double 转换为 float，这应该不是什么大问题（我猜）。
但我的问题是是否有任何其他方法可以做到这一点，导致双倍也消耗更多内存（我不知道在这种情况下更多意味着什么 - 我想更多倍，假设我将有 500 个粒子，每个粒子都会有这个属性）。**我只需要以某种方式从这个浮点属性计算 sin 值。**

那么有可能吗？我对记忆的担忧重要吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T23:18:16.627

这应该有效：

```
particle.x += particle.xi; 
particle.xi = (float) Math.Sin(life); 
```

它不会“使用更多内存”，它只是在重新计算时将值临时转换为双精度值，然后在存储值时将其转换回浮点数。

更详细一点：Math.Sin 需要一个 double，但是 float 可以转换为这个更高的精度而不会丢失，所以它只是“神奇地工作”（从 float 到 double的*隐式转换）。*但是，要将生成的双精度数转换回浮点数，您将降低数字的精度，因此编译器（它不知道您是否可以接受）不会这样做，除非您强制它（通过使用`(float)`which 是从 double 到 float的*显式转换）。*

# android - 异步任务的imageview绘制问题

> ID：10825565
> 
> 赞同：0
> 
> 时间：2012-05-30T23:13:15.943
> 
> 标签：android, android-asynctask

有以下我用来下载一些图像的异步任务。工作正常，除了第一个图像，它并不总是出现，除非我做一些事情，比如移动到下一个图像然后再回来。

```
public class DownloadImageTask extends AsyncTask<String, Void, Bitmap> {
    static ImageView _imageView=null;

    public DownloadImageTask(ImageView ctl){
        _imageView=ctl;
    }

    protected void onPostExecute(Bitmap result) {
        _imageView.setImageBitmap(result);
    }
    ...
} 
```

我认为这可能是在后台线程上更新 UI 的问题，所以我使用一个抽象类重新处理了这个问题，该类调用 UI 线程上调用 .setImageBitmap() 的方法，但我仍然得到相同的行为 - 对所有人都适用除了第一个图像，除非我移动到下一个图像并再次返回。

设置图像后，有没有办法在图像视图上强制重绘？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T04:37:08.067

我有一个类似的问题，我所做的`Activity.onCreate()`是这样的：

```
ListView listView = (ListView) findViewById(R.id.myListView);
adapter = new MyArrayAdapter(this, myArray, ...);
listView.setAdapter(adapter);
if (myArray.size() > 0)
{
    // Fake a click on the first item
    onItemClick(listView, myArray, 0, 0);
} 
```

然后，`onItemClick()`执行查找`ImageView`当前行所需的操作。当然，没有看到你的代码，上面只是一个疯狂的猜测......

# android - 方法 Media.getBitmap(ContentResolver, Uri) 对于 MediaStore.Audio.Media android 类型未定义

> ID：10825569
> 
> 赞同：1
> 
> 时间：2012-05-30T23:13:40.643
> 
> 标签：android, android-camera

我正在使用这段代码：

```
private static final int TAKE_PHOTO_CODE = 1;  

private void takePhoto(){  
  final Intent intent = new Intent(MediaStore.ACTION_IMAGE_CAPTURE);  
  intent.putExtra(MediaStore.EXTRA_OUTPUT, Uri.fromFile(getTempFile(this)) );   
  startActivityForResult(intent, TAKE_PHOTO_CODE);  
}  

private File getTempFile(Context context){  
  //it will return /sdcard/image.tmp  
  final File path = new File( Environment.getExternalStorageDirectory(), context.getPackageName() );  
  if(!path.exists()){  
    path.mkdir();  
  }  
  return new File(path, "image.tmp");  
}  

@Override  
protected void onActivityResult(int requestCode, int resultCode, Intent data) {  
  if (resultCode == RESULT_OK) {  
    switch(requestCode){  
      case TAKE_PHOTO_CODE:  
        final File file = getTempFile(this);  
        try {  
          Bitmap captureBmp = Media.getBitmap(getContentResolver(), Uri.fromFile(file) );  
          // do whatever you want with the bitmap (Resize, Rename, Add To Gallery, etc)  
        } catch (FileNotFoundException e) {  
          e.printStackTrace();  
        } catch (IOException e) {  
          e.printStackTrace();  
        }  
      break;  
    }  
  }  
} 
```

我收到了这个错误：

```
method Media.getBitmap(ContentResolver, Uri) is undefined for type MediaStore.Audio.Media 
```

如果这是问题，我的活动正在扩展 MapsActivity。

你能帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T11:08:03.660

检查您已导入的类。猜你已经进口了

```
import android.provider.MediaStore.Audio.Media; 
```

而是导入

```
import android.provider.MediaStore.Images.Media; 
```

# javascript - 为什么 Meteor 更新会覆盖我文档中的现有属性？

> ID：10825570
> 
> 赞同：2
> 
> 时间：2012-05-30T23:13:43.827
> 
> 标签：javascript, meteor

Meteor 更新对我不起作用。

如果我运行：

```
Countries.insert({name: 'China'}); 
```

我在我的国家收藏中获得了一份新文件，名称为“中国”——正如您所期望的那样。

但是当我然后运行时：

```
Countries.update({name: 'China'}, {population: '1 billion'}); 
```

该文档现在有一个 population 属性，但它失去了 name 属性。这绝对是同一个文档 - 相同的 ID。

我以为我正在遵循以下语法：

```
collection.update(selector, modifier, [options], [callback]) 
```

直接出自 Meteor Docs。

我还尝试在更新命令中使用文档的 id 字符串（而不是选择器）进行更新，但同样的事情发生了。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T23:57:58.040

这有帮助吗

```
Countries.update({ name: 'China' } , { $set : { population: '1 billion' }}); 
```

如果文档尚不存在键，则会添加键：值。我还成功地使用以下方法为多个文档添加了值。

```
Countries.update({ continent: 'Asia' } , { $set : { food: 'delicious' } } , { multi : true } ); 
```

这将为亚洲大陆的所有国家添加食物：美味。

# ios - UIToolbar 不显示 UIBarButtonItem

> ID：10825572
> 
> 赞同：26
> 
> 时间：2012-05-30T23:13:48.723
> 
> 标签：ios, ipad, uitoolbar

我正在使用情节提要，并且我有一个拆分视图，其中主视图是 UITableViewController。像 iPad Mail 应用程序一样，我想显示一个 UIToolbar。

我无法通过情节提要添加工具栏，但我设法以编程方式添加它。我还可以将 UILabel 添加到工具栏，但我找不到添加刷新按钮或任何类型的 UIBarButtonItem 的方法。

任何的想法？

```
- (void)viewDidLoad {
  [super viewDidLoad];

  [self.navigationController setToolbarHidden:NO];

  UILabel *label = [[UILabel alloc] initWithFrame:CGRectMake(50.0f, 0.0f, 80.0f, 40.0f)];
  label.text = @"last updated...";
  label.textAlignment = UITextAlignmentCenter;
  label.font = [UIFont systemFontOfSize:13.0];
  [self.navigationController.toolbar addSubview:label];

  UIBarButtonItem *item1 = [[UIBarButtonItem alloc] initWithTitle:@"Item" style:UIBarButtonItemStylePlain target:self action:@selector(action:)];
  UIBarButtonItem *item2 = [[UIBarButtonItem alloc] initWithTitle:@"Item1" style:UIBarButtonItemStyleBordered target:self action:@selector(action:)];

  NSArray *buttons = @[item1, item2, nil];
  [self.navigationController.toolbar setItems:buttons animated:NO]; 
```

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2012-05-31T11:36:49.010

感谢 Apple iOS 论坛，找到了答案！

当您使用导航控制器的工具栏时，您必须在**活动**视图控制器的`toolbarItems`属性上设置工具栏按钮，而不是在实际导航控制器的工具栏本身上。

从[`UINavigationController`文档](https://developer.apple.com/documentation/uikit/uinavigationcontroller#1654291)：

> **显示工具栏**
> 
> 导航控制器对象管理其视图层次结构中的可选工具栏。`toolbarItems`显示时，此工具栏从活动视图控制器的属性中获取其当前的项目集。当活动视图控制器发生变化时，导航控制器会更新工具栏项以匹配新的视图控制器，并在适当的时候将新项设置为动画。

例如：

```
[self setToolbarItems:buttons animated:NO]; 
```

# java - 如何在 android 上播放 soundcloud 流？

> ID：10825573
> 
> 赞同：1
> 
> 时间：2012-05-30T23:13:55.100
> 
> 标签：java, android, streaming, soundcloud

我正在使用 MediaPlayer 文档中的代码；

```
String url = "http://........"; // your URL here
MediaPlayer mediaPlayer = new MediaPlayer();
mediaPlayer.setAudioStreamType(AudioManager.STREAM_MUSIC);
mediaPlayer.setDataSource(url);
mediaPlayer.prepare(); // might take long! (for buffering, etc)
mediaPlayer.start(); 
```

soundcloud mp3 的路径是这样的；

```
https://api.soundcloud.com/tracks/41262720/stream?consumer_key=XXXXXX 
```

在准备线我有这个错误；

```
prepare failed. status=0x1 
```

我用不同的来源测试它，它工作正常；

```
http://www.colorado.edu/AmStudies/lewis/Design/blue.mp3 
```

soundcloud 源有什么问题？媒体播放器需要额外配置吗？

注意：我正在使用带有 2.2 SDK 的模拟器

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T11:00:38.490

媒体播放器（至少是旧版本）存在*https*网址问题。您需要手动解析 url（发出 GET 请求并检查重定向），然后将结果提供给 MediaPlayer。虽然 MediaPlayer 还有很多其他问题，但要让它工作并不简单。

# c# - C# 中的异步方法

> ID：10825574
> 
> 赞同：3
> 
> 时间：2012-05-30T23:13:58.530
> 
> 标签：c#

我有几个需要在 Windows 窗体应用程序的后台运行的进程，因为它们需要太多时间，而且我不想在它们完全完成之前冻结用户界面，我希望有一个指示器来显示进程每个操作，到目前为止，我都有一个表单来显示每个操作的进度，但我的操作是同步运行的。

所以我的问题是异步运行这些操作（访问数据库）的最简单方法是什么？

我忘记了应用程序需要的一项重要功能，用户可以随时选择取消任何操作。我认为这个要求使应用程序复杂化了很多，至少就我目前的技能而言，所以基本上我想强调我需要一个易于理解且易于实施的解决方案。我知道会有一些好的做法可以遵循，但在这一点上，我希望一些代码稍后可以工作，我有更多时间我会重构代码

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T23:23:04.487

.NET 4 添加了[Task Parallel Library](http://msdn.microsoft.com/en-us/library/dd460717.aspx)，它提供了一种非常简洁的机制来使同步操作异步。

它允许您将同步操作包装到*Task*中，然后您可以等待或使用延续（一些在任务完成时执行的代码）。

这通常看起来像：

```
Task processTask = Task.Factory.StartNew(() => YourProcess(foo, bar)); 
```

完成任务后，您有很多选择，包括阻止：

```
// Do other work, then:
processTask.Wait(); // This blocks until the task is completed 
```

或者，如果您想要继续（代码在完成后运行）：

```
processTask.ContinueWith( t => ProcessCompletionMethod()); 
```

您还可以使用它来组合多个异步操作，并在其中任何一个或全部完成时完成，等等。

请注意，以这种方式使用`Task`or`Task<T>`有另一个巨大的优势 - 如果您稍后迁移到 .NET 4.5，您的 API 将按原样工作，无需更改代码，C# 5 中提供了新的 async/await 语言功能。

> 我忘记了应用程序需要的一项重要功能，用户可以随时选择取消任何操作。

从一开始，TPL 也被设计为与 .NET 4的新[协作取消模型](http://msdn.microsoft.com/en-us/library/dd997364.aspx)很好地结合使用。这使您可以拥有一个`CancellationTokenSource`可用于取消任何或所有任务的模型。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-30T23:17:55.937

那么在 C# 中有几种方法可以实现这一点

我个人建议您尝试响应式扩展

[http://msdn.microsoft.com/en-us/data/gg577609.aspx](http://msdn.microsoft.com/en-us/data/gg577609.aspx)

您实际上可以执行以下操作：

[https://stackoverflow.com/a/10804404/1268570](https://stackoverflow.com/a/10804404/1268570)

我为你创建了这个，虽然它不是线程安全的，但这真的很容易，但这将是一个很好的起点

以一种形式

```
var a = Observable.Start(() => Thread.Sleep(8000)).StartAsync(CancellationToken.None);
var b = Observable.Start(() => Thread.Sleep(15000)).StartAsync(CancellationToken.None);
var c = Observable.Start(() => Thread.Sleep(3000)).StartAsync(CancellationToken.None);

Manager.Add("a", a.ObserveOn(this).Subscribe(x => MessageBox.Show("a done")));
Manager.Add("b", b.ObserveOn(this).Subscribe(x => MessageBox.Show("b done")));
Manager.Add("c", c.ObserveOn(this).Subscribe(x => MessageBox.Show("c done")));

private void button1_Click(object sender, EventArgs e)
{
    Manager.Cancel("b");
} 
```

管理器实用程序

```
public static class Manager
{
    private static IDictionary<string, IDisposable> runningOperations;

    static Manager()
    {
        runningOperations = new Dictionary<string, IDisposable>();
    }

    public static void Add(string key, IDisposable runningOperation)
    {
        if (runningOperations.ContainsKey(key))
        {
            throw new ArgumentOutOfRangeException("key");
        }

        runningOperations.Add(key, runningOperation);
    }

    public static void Cancel(string key)
    {
        IDisposable value = null;
        if (runningOperations.TryGetValue(key, out value))
        {
            value.Dispose();
            runningOperations.Remove(key);
        }
    } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-30T23:21:01.640

如果 ORM/数据库 API 本身没有异步方法，请查看[BackgroundWorker 类](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx)。它支持取消（[CancelAsync](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.cancelasync.aspx) / [CancellationPending](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.cancellationpending.aspx)）和进度报告（[ReportProgress](http://msdn.microsoft.com/en-us/library/ka89zff4.aspx) / [ProgressChanged](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.progresschanged.aspx)）。

# php - PHP/SQL 替代嵌套 while 循环中的 db 调用

> ID：10825578
> 
> 赞同：0
> 
> 时间：2012-05-30T23:14:11.550
> 
> 标签：php, sql-server, loops, while-loop

我的第一篇文章，试图尽可能彻底，如果我有什么问题，请提前道歉。我对 PHP/SQL 也很陌生，所以请耐心等待。我发现了一些关于循环内循环的类似问题，但我不确定这些解决方案是否适用于我的案例。

我有两个表，tws_workshopNames 和 tws_workshops。tws_workshopNames 中的主键用作 tws_workshops 中的外键来关联两个表。我把它分成两张表的原因是在很多情况下，在多个日期/时间提供相同的研讨会名称/价格/描述。

无法提交屏幕截图，但这是 SQL Server 中表设计的简化大纲：

```
tws_workshopNames:
workshopNameID (pri)
description
price
etc.

tws_workshops:
workshopID (pri)
workshopNameID (foreign)
date
time
etc. 
```

我想要发生的基本上是这样的：

1.  查询tws_workshopNames表，显示workshopName/price/description/etc。
2.  对于每个 WorkshopName，通过 tws_workshops 表并显示所有具有相同 WorkshopNameID 的记录

换句话说，通过 tws_workshopNames 显示第一个 WorkshopName，然后通过 tws_workshops 显示与该 WorkshopName 相关的所有记录，然后转到 tws_workshopNames 中的下一个 WorkshopName，显示与该 WorkshopName 相关的所有记录等。

我可以通过在 while 循环中使用 while 循环来实现所需的结果，其中外部循环调用 tws_workshopNames，嵌套循环调用 tws_workshops 表。但是，我已经阅读了很多关于此的内容，很明显这不是一个好方法，因为它会导致对数据库的大量调用，但我很难理解任何替代方案。

期望的输出：

```
Workshop 1
price
description
 date (of workshop 1)
 time (of workshop 1)
 ...

Workshop 2
price
description
 first date (of workshop 2)
 first time (of workshop 2)
 second date (of workshop 2)
 second time (of workshop 2)
 third date (of workshop 2)
 third time (of workshop 2)
 ...

Workshop 3
price
description
 date (of workshop 3)
 time (of workshop 3)
 ...

etc. 
```

以下是适用于嵌套 while 循环的当前代码：

```
<?php
// query workshopNames table, what types of workshops are available?
$query = mssql_init("tws_sp_workshopNames", $g_dbc);

// pull up result
$result = mssql_execute($query);
$numRows = mssql_num_rows($result);

while($row = mssql_fetch_array($result)) {

echo "<div style=\"...\">
<span class=\"sectionHeader\">" . $row['workshopName'] . "</span><br />
<span class=\"bodyText\"><strong>" . $row['price'] . "</strong></span><br />
<span class=\"bodyText\">" . $row['description'] . "</span>";

$workshopNameID = $row['workshopNameID'];

// query workshops table, what are the dates/times for each individual workshop?
$query2 = mssql_init("tws_sp_workshops", $g_dbc);
mssql_bind($query2, "@workshopNameID", $workshopNameID, SQLVARCHAR);

//pull up result
$result2 = mssql_execute($query2);
$numRows2 = mssql_num_rows($result2);

while($row2 = mssql_fetch_array($result2)) {

echo $row2[date] . "&nbsp;";
echo $row2[time] . "<br />";

};

echo "</div><br />";

};
?> 
```

存储过程非常简单：

```
tws_sp_workshopNames = "SELECT workshopNameID, workshopName, description, location, price FROM tws_workshopNames"
tws_sp_workshops = "SELECT date, time, maxTeachers, maxStudents, teachersEnrolled, studentsEnrolled FROM tws_workshops WHERE workshopNameID=@workshopNameID" 
```

希望这一切都相对清楚，我真正在寻找的是获得相同结果的更好方法，即不涉及循环内的 db 调用的解决方案。

在此先感谢您的帮助，几天来一直在撞我的头...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T23:43:35.030

我认为你做事的方式没有任何问题。我想您可以连接结果，然后使用一个查询在您的应用程序中操作输出。您的查询可能类似于

```
SELECT
    n.workshopNameId,
    n.price,
    n.description,
    GROUP_CONCAT(w.date) as dates,
    GROUP_CONCAT(w.time) as times
FROM tws_workshopNames n
INNER JOIN tws_workshops w USING(workshopNameID)
GROUP BY n.workshopNameID 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T00:37:54.653

在这种情况下避免使用循环查询是正确的（因为只需在一个查询中进行简单的 JOIN 即可实现所需的结果）。

我也会避免使用 GROUP_CONCAT() 因为有字符限制（默认情况下，您可以更改它），而且您必须解析它输出的数据，这有点痛苦。我会通过加入并获取每一行来获取您需要的所有数据。然后使用车间 ID 作为键将数据加载到数组中，但保持数组打开以将每个时间数据附加为新数组：

```
$workshops[$workshop_name][] = $timesArray; 
```

然后在你的输出上你可以循环，但你不必在每次调用时都访问数据库：

```
foreach ($workshops as $workshop_name => $times)
{
  echo $workshop_name;
  foreach ($times as $time)
  {
    echo $time;
  }
  echo "<br>";
} 
```

这不是确切的代码，正如您在问题中指出的那样，您希望保留/显示有关研讨会的其他一些信息 - 只需使用数组结构，直到您在层次结构中获得所需的所有数据。如果您正在尝试构建深层树结构，您可以使用类似[http://kevin.vanzonneveld.net/techblog/article/convert_anything_to_tree_structures_in_php/的东西，但我认为这对于这个例子来说太过分了。](http://kevin.vanzonneveld.net/techblog/article/convert_anything_to_tree_structures_in_php/)

由于这就是我所说的“中级”问题，我认为您应该尝试使用我的建议来解决它（这使您成为一名优秀的程序员，而不是复制/粘贴）。如果您遇到困难，请发表评论，我会进一步帮助您。

# javascript - 使用 onclick javascript 更改元素的类

> ID：10825582
> 
> 赞同：2
> 
> 时间：2012-05-30T23:15:04.430
> 
> 标签：javascript, html, css

我需要弄清楚当通过 javascript 触发 OnClick 时如何更改元素的类。

基本上，我有以下代码：

索引.html

```
<div class="bottom_section">
 <div class="tab_section">
  <div class="tabing">
   <ul>
    <li id="active_news"><a onclick="ContentSwitch('News');">
     <img src="includes/t_news.png" width="23" height="81" alt="t_news">
    </a></li>
    <li id="active_events"><a onclick="ContentSwitch('Events');">
     <img src="includes/t_events.png" width="20" height="121" alt="t_events">
    </a></li>
    <li id="active_updates"><a onclick="ContentSwitch('Updates');">
     <img src="includes/t_updates.png" width="19" height="141" alt="t_updates">
    </a></li>
   </ul>
  </div> 
```

此图像列表显示在切换框中显示的内容的框的左侧。

我的 CSS 中有一个类：

```
.bottom_section .tabing li.active{background: #1ca1e3 url(tab_li_active.gif) repeat-x 0 0;} 
```

这会将选项卡图像的背景更改为较暗的阴影，以表明它已被“点击”。所以，如果选项卡被“选中”，我基本上需要在 <li> 标签中添加一个 class="active"。

我有 javascript 代码，我在 Stack Overflow 上找到了它来尝试切换类，但它不起作用。

```
function ContentSwitch(id) {
 if (id == "News") {
  if (document.getElementById("news_content").style.display = "none") {
   document.getElementById("news_content").style.display = "block";
   document.getElementById("active_news").className = document.getElementById("active_news").className.replace( /(?:^|\s)active(?!\S)/ , '' )

   // Hide other content
   document.getElementById("events_content").style.display = "none";
   document.getElementById("updates_content").style.display = "none";
  }
 }
 if (id == "Events") {
  if (document.getElementById("events_content").style.display = "none") {
   document.getElementById("events_content").style.display = "block";
   document.getElementById("active_events").className = document.getElementById("active_events").className.replace( /(?:^|\s)active(?!\S)/ , '' )

   // Hide other content
   document.getElementById("news_content").style.display = "none";
   document.getElementById("updates_content").style.display = "none";
  }
 }
 if (id == "Updates") {
  if (document.getElementById("updates_content").style.display = "none") {
   document.getElementById("updates_content").style.display = "block";
   document.getElementById("active_updates").className = document.getElementById("active_updates").className.replace( /(?:^|\s)active(?!\S)/ , '' )

   // Hide other content
   document.getElementById("news_content").style.display = "none";
   document.getElementById("events_content").style.display = "none";
  }
 }
} 
```

所有 onclick 工作（内容切换成功），但标签图像不切换。如果我手动将 class="active" 添加到 < li > 标记，然后单击任何其他选项卡，则活动会消失并且不会回来，因此 javascript 正在执行某些操作。

我错过了什么？

感谢您的任何帮助，您可以提供。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-31T02:40:42.190

你的代码看起来很乱。无论如何试试这个：

```
document.getElementById("active_news").className = ''; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T02:43:43.197

您在它引用 news_content 和 events_content 的 javascript 中使用树 ID 来标识树选项卡、active_news、active_events、active_updates，是否应该引用 active_news、active_events ？

所以代码应该看起来像

```
 function ContentSwitch(id) {
 if (id == "News") {
  if (document.getElementById("active_news").style.display = "none") {
   document.getElementById("active_news").style.display = "block";
   document.getElementById("active_news").className = document.getElementById("active_news").className.replace( /(?:^|\s)active(?!\S)/ , '' )

   // Hide other content
   document.getElementById("active_events").style.display = "none";
   document.getElementById("active_updates").style.display = "none";
  }
 }
 if (id == "Events") {
  if (document.getElementById("active_events").style.display = "none") {
   document.getElementById("active_events").style.display = "block";
   document.getElementById("active_events").className = document.getElementById("active_events").className.replace( /(?:^|\s)active(?!\S)/ , '' )

   // Hide other content
   document.getElementById("active_updates").style.display = "none";
   document.getElementById("active_news").style.display = "none";
  }
 }
 if (id == "Updates") {
  if (document.getElementById("active_updates").style.display = "none") {
   document.getElementById("active_updates").style.display = "block";
   document.getElementById("active_updates").className = document.getElementById("active_updates").className.replace( /(?:^|\s)active(?!\S)/ , '' )

   // Hide other content
   document.getElementById("active_events").style.display = "none";
   document.getElementById("active_news").style.display = "none";
  }
 }
} 
```

# java - 正则表达式 - 否定一个类中的一个组

> ID：10825584
> 
> 赞同：0
> 
> 时间：2012-05-30T23:15:06.993
> 
> 标签：java, regex

我正在使用 Java 的匹配器使用以下正则表达式对字符串中的术语进行分组：

`Pattern.compile("(\\\\\"[^\\\\\"]*\\\\\"|[^\\s\\\\\"]+)");`

这是我遇到问题的部分：[^\s\\\"]

我希望它只匹配非空格和悬空转义引号，例如 \"。有没有办法在字符类中对 \\ 和 \" 进行分组，以便它们只匹配在一起？

我尝试使用lookahead/lookbehind，但发现将它包含在字符类中让我回到了第一格。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T23:20:29.207

字符类匹配*单个*字符。如果我理解正确，您只想匹配 string `\"`。为此，您根本不需要字符类——正则表达式`\\"`已经匹配了！（在 Java 字符串中，这看起来`\\\\\"`很荒谬，但你已经知道了。）

您可以使用括号将事物组合在一起：`(\\\\\")`. 您也可以在这样的组内交替使用`|`. 因此，要匹配非空格*或* `\"`，您可以这样做：`(\S|\\\\\")`. （注意`\S`与 相同`[^\s]`。）

~~编辑：我没有给予足够的关注。您可以匹配除`\"`空格以外的所有内容，如下所示：`(\\\\(?!")|[^\s\\])`，我认为。~~

这个怎么样：`([^\\s\\\\]|\\\\(?!"))`。这应该匹配除空格之外的任何内容`\` *或*a`\`后不跟 a `"`。

# c# - 在 Web 服务启动时将变量加载到 AppSettings

> ID：10825586
> 
> 赞同：1
> 
> 时间：2012-05-30T23:15:09.773
> 
> 标签：c#, .net, web-services

我有以下情况（.NET，C#）：

我的 Web 服务需要存储在数据库中的身份验证数据。身份验证用于对带有事务数据的 Web 服务进行的大量 POST。但是，每次有 POST 时都查询数据库太繁重了，因为我们每秒都在谈论很多事务。因此，我想将用于身份验证的变量保留在缓存中——我可以通过 AppSettings 来完成。如何在首次启动 Web 服务时将这些变量加载到 AppSettings 中，而无需我需要记住的一些手动过程？

谢谢，安德斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T09:08:39.223

将信息保存到 web.config 或 app.config 到 AppSettings 中并不容易。说真的，对我来说，当服务试图修改 web.config 时看起来很危险，因为一个微小的错误可能会导致所有服务宕机。

无论如何，当你需要它时，这里是 MSDN 文章的链接，使用 ConfigurationManager 类。这篇文章有一个完整的例子如何做到这一点：

[http://msdn.microsoft.com/en-us/library/system.configuration.configurationmanager.aspx](http://msdn.microsoft.com/en-us/library/system.configuration.configurationmanager.aspx)

但我建议你另一种方法。使用简单的[System.Runtime.Caching.MemoryCache](http://msdn.microsoft.com/en-us/library/system.runtime.caching.memorycache.aspx)（或评论之一所述的 System.Web.Caching.Cache ）或更高级和可扩展的场景使用 AppFabric 缓存（例如，已为您[在 stackoverflow 上找到了链接](https://stackoverflow.com/questions/4739548/appfabric-caching-examples-using-c-sharp)）

# javascript - jQuery Mobile - 过滤数据过滤文本和文本

> ID：10825587
> 
> 赞同：2
> 
> 时间：2012-05-30T23:15:12.503
> 
> 标签：javascript, jquery, mobile, jquery-mobile, filter

如果我在 data-filtertext 中有一个值，jQuery Mobile 会忽略该行的正常文本。有什么方法可以让搜索过滤数据过滤文本和普通文本，而不仅仅是数据过滤文本？

```
<li data-filtertext="value"><a href="#">content</a></li> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-10T21:12:56.287

据我所知，目前没有允许同时搜索*data-filtertext*和*li*内容的*data- * 选项。**只需在data-filtertext*字符串中将两者组合在一起即可。您的示例已修改：

 ***```
<li data-filtertext="value content"><a href="#">content</a></li> 
```

这在我的情况下效果很好，我列出了一个城市内的多个站点。城市名称是一个列表分隔符，而不是（通常）在站点名称中，但我希望它的子项目在输入时出现。示例：

```
<ul data-role='listview' data-filter='true'>
  <li data-role="list-divider">Tallahassee</li>
  <li data-filtertext="Tallahassee Dog Et Al">Dog Et Al</li>
  <li data-filtertext="Tallahassee Jim and Milts">Jim and Milts</li>
  <li data-role="list-divider">Atlanta</li>
  <li data-filtertext="Atlanta The Varsity">The Varsity</li>
</ul> 
```***

# lucene - 如何通过 REST 使用字段分组查询 neo4j lucene 索引？

> ID：10825588
> 
> 赞同：0
> 
> 时间：2012-05-30T23:15:22.527
> 
> 标签：lucene, neo4j

我们的图中有由 Lucene 索引的数据，需要使用 [字段分组查询它](http://lucene.apache.org/core/old_versioned_docs/versions/3_1_0/queryparsersyntax.html)

上面链接中的示例显示 Lucene 语法为：

```
title:(+return +"pink panther") 
```

我不知道如何通过 http 向 REST 接口发送这样的请求。具体来说，第二学期的空间给我带来了问题。

我们的数据实际上是一个列表，我需要匹配多个项目：

```
regions:(+asia +"north america") 
```

有人有想法么？

更新：作为记录，以下 url 编码字符串适用于此特定查询：

```
regions%3A%28%2Basia+%2B%22north+america%22%29 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T07:43:56.457

仅使用 java.net.URLEncoder 或其他东西对查询进行 URL 编码还不够吗？

# php - AJAX div 在没有警报调用的情况下不会更新并出现错误：b.data 未定义

> ID：10825594
> 
> 赞同：1
> 
> 时间：2012-05-30T23:15:56.343
> 
> 标签：php, javascript, ajax, javascript-events, ajax-request

首先，关于重写我的标题有什么建议吗？

问题：我有一个 AJAX 可更新 div，当我的错误检查`alert`调用进入时，一切正常。但是当我删除一个特定的，DIV 永远不会更新。我知道这听起来很混乱，但代码如下，然后我会进一步解释。

*AJAX 脚本*

```
var xmlhttp
    /*@cc_on @*/
    /*@if (@_jscript_version >= 5)
      try {
      xmlhttp=new ActiveXObject("Msxml2.XMLHTTP")
     } catch (e) {
      try {
        xmlhttp=new ActiveXObject("Microsoft.XMLHTTP")
      } catch (E) {
       xmlhttp=false
      }
     }
    @else
     xmlhttp=false
    @end @*/
    if (!xmlhttp && typeof XMLHttpRequest!='undefined') {
     try {
      xmlhttp = new XMLHttpRequest();
     } catch (e) {
      xmlhttp=false
     }
    }
    function myXMLHttpRequest() {
      var xmlhttplocal;
      try {
        xmlhttplocal= new ActiveXObject("Msxml2.XMLHTTP")
     } catch (e) {
      try {
        xmlhttplocal= new ActiveXObject("Microsoft.XMLHTTP")
      } catch (E) {
        xmlhttplocal=false;
      }
     }

    if (!xmlhttplocal && typeof XMLHttpRequest!='undefined') {
     try {
      var xmlhttplocal = new XMLHttpRequest();
     } catch (e) {
      var xmlhttplocal=false;
      alert('couldn\'t create xmlhttp object');
     }
    }
    return(xmlhttplocal);
}

function sndReq(page,key,includesDir,changeDiv,parameterString) {
    var divToChange = document.getElementById(changeDiv); // the Div that the data will be put into

    // Place loading image in container DIV
    divToChange.innerHTML = '<div class="loading">Loading</div>';

    if (includesDir == 1){
        //Find Current Working Directory.  Use to find path to call other files from
        var myloc = window.location.href;
        var locarray = myloc.split("/");
        delete locarray[(locarray.length-1)];
        var arraytext = locarray.join("/");

        xmlhttp.open("POST","AJAXCaller.php",true);
        xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
        xmlhttp.send(parameterString);

    } else {

    }

    xmlhttp.onreadystatechange = handleResponse(changeDiv);
    xmlhttp.send(null); 
}

function handleResponse(changeDiv) {
/* ======== If I remove the following line script halts ================*/
/* ======== If line stays here, script executes perfectly ==============*/
    alert('to changetext 1\n'+xmlhttp.responseText);
/* =========End of line removal issue =================================*/       
  if(xmlhttp.readyState == 4){

        if (xmlhttp.status == 200){

        var response = xmlhttp.responseText;

        var update = new Array();

            if(response.indexOf('|') != -1) {
                update = response.split('|');
                changeText(update[0], update[1]);
            } else {
                changeText(changeDiv, response);
            }

        } //End IF xmlhttp.status == 200

    }
}

function changeText( div2show, text ) {
    // Detect Browser
    var IE = (document.all) ? 1 : 0;
    var DOM = 0; 
    if (parseInt(navigator.appVersion) >=5) {DOM=1};

    // Grab the content from the requested "div" and show it in the "container"
    if (DOM) {
        var viewer = document.getElementById(div2show);
        viewer.innerHTML = text;
    }  else if(IE) {
        document.all[div2show].innerHTML = text;
    }
} 
```

当我检查我的 firefox 错误控制台时，仅当我删除代码中定义的警报时才会出现此错误：

```
Timestamp: 5/30/2012 5:07:55 PM
Error: b.data is undefined
Source File: http://cdn.sstatic.net/js/wmd.js?v=cfd2b283af83
Line: 92 
```

我是一名高级 PHP/mySQL 开发人员，但一直在努力掌握 AJAX/Javascript。疯狂地做教程。因此，请在评论/答案中进行描述，以便我可以将它们用作学习的参考...

为什么显示警告框会以任何方式改变代码执行（为了更好！）？

***新错误 - Google Chrome 和 Firefox 控制台（叹息...）***

```
Uncaught Error: INVALID_STATE_ERR: DOM Exception 11
sndReqAJAX.js:89
element.onclick 
```

第 89 行如下（由 Google Chrome 控制台验证）

```
xmlhttp.send(null); 
```

我在网上找到的所有内容都涉及关于不存在的 DOM 对象的极其复杂的问题……这不适用于这里，对吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T23:38:52.667

首先，问题。这是行：

```
xmlhttp.onreadystatechange = handleResponse(changeDiv); 
```

这是错误的原因是它`xmlhttp.onreadystatechange`应该是一个函数 - 你需要为属性分配一个函数，你正在做的是调用函数并将返回值分配给属性。这本身不是问题，只要你的函数返回一个函数。它没有。

如果您习惯于使用 PHP（尤其是如果您习惯于使用 PHP <5.3），您可能不习惯这个概念。Javascript 以某种方式支持闭包，任何不经常使用它们的人都会感到困惑。

该行需要如下所示：

```
xmlhttp.onreadystatechange = handleResponse; 
```

通过附加`(changeDiv)`，您正在*调用*该函数，而您需要做的只是传递它，就像您传递任何其他值一样。

现在，变得复杂的地方是您想要传递一个在调用函数范围内的本地参数。有很多方法可以处理这个问题，但是粗略地看一下你的代码告诉我它`handleResponse()`没有在其他任何地方使用，所以最好将它定义为一个闭包，而不是用一个命名的事件处理程序乱扔全局范围。这也克服了变量范围问题：

```
xmlhttp.onreadystatechange = function() {
  if (xmlhttp.readyState == 4) {
    if (xmlhttp.status == 200) {
      var response = xmlhttp.responseText;
      var update = []; // "new Array()" is baaaad
      if (response.indexOf('|') != -1) {
        update = response.split('|');
        changeText(update[0], update[1]);
      } else {
        changeText(changeDiv, response);
      }
    } //End IF xmlhttp.status == 200
  }
}; 
```

用该代码块替换上述有问题的行，并删除`handleResponse()`函数定义，这应该可以解决直接问题。现在，至于为什么`alert()`“修复”您的原始代码 - 这有点难以解释，但我会试一试......*给我一分钟来正确检查代码*

* * *

放弃了完整且易于理解的解释的尝试。如果有人想要一个，发表评论，我会在我睡一会后再做一次......

# python - 在wxpython中选择多个TextCtrls上的文本

> ID：10825597
> 
> 赞同：2
> 
> 时间：2012-05-30T23:16:42.117
> 
> 标签：python, wxpython, wx.textctrl

所以我目前有一个 ScrolledPanel，其中包含许多以编程方式放置在垂直 BoxSizer 中的 TextCtrl。我这样做而不是仅仅将行附加到一个大的滚动 TextCtrl 的原因是，我还可以在 TextCtrl 之间添加其他控件，例如图像或风格化的展开/收缩折叠的东西。

然而，这个特定的实现会导致一个问题——即用户不可能跨多个 TextCtrl 选择文本。有没有一种方法可以快速、干净、惯用并且不是特别笨拙？我最好的选择是编写一个指针位置文本选择算法，该算法本质上是为底层本机库的文本选择内容重新发明轮子，还是有一种更简单的方法可以将其他控件嵌入到多行可滚动 TextCtrl 中，甚至选择文本多个TextCtrls本机？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-16T16:43:20.117

如果可能的话，我会远离尝试重新实现文本选择控件，因为这势必会很快变得非常混乱。解决此问题的另一种方法是使用单个多行 textctrl 小部件，并在其上附加其他小部件。这也很混乱，但不那么混乱。

您可以将其他小部件放在 textctrl 上，只需将它们直接放在与 textctrl 相同的位置，只要其他小部件与 textctrl 具有相同的父级即可。只要您不与 vscrollbar 重叠（或者更好的是，使用 style=wx.TE_NO_VSCROLLBAR 将其完全删除），这应该可以工作。

您需要做的下一件事是预先填充和间隔您的 textctrl，以便用户仅在每个小部件的位置之后才能控制文本。您应该为每一行文本设置不同的间距设置，使用 wx.TextAttr 的间距选项进行设置（双间距的更通用版本等），您可以根据您为应用程序提供的特定小部件间距计算这些选项. 这对于强制用户仅在您希望他们输入的位置准确键入是必要的。

接下来，您需要设置与 textctrl 换行符的绑定，以重新计算每行所需的间距。一旦你弄清楚如何处理间距，这应该不会太难。

最后，在您选择文本后，只需将所有内容重置为相同的间距，或者其他任何适合您的方式，这样当您将其粘贴回其他地方时，您就不会遇到尴尬的换行符。

我知道这是一个复杂的答案，但这是你提出的一个复杂的问题。我相信，这是解决它的最有效方法，并且避免了完全检修 textctrl 可能出现的所有错误，但它确实涉及搞乱自动更正换行符和间距，一开始可能有点棘手.

# javascript - 如何在javascript中禁用多个选定的下拉值

> ID：10825601
> 
> 赞同：0
> 
> 时间：2012-05-30T23:17:15.847
> 
> 标签：javascript

如果我单击它，我有一个添加按钮，然后它会生成一个具有一个下拉列表的新行（允许多选），现在如果我在下次按下添加按钮时在下拉列表中选择了某个值，它将在一个下拉列表中生成相同的下拉列表新行，但我希望用户不应该能够在新创建的下拉菜单中选择以前选择的项目。即每个下拉菜单都应该选择唯一的值。

```
<select multiple="true" id="mySelect[0]">
  <option value="1" >Apple</option>
  <option value="2">Pear</option>
  <option value="3">Banana</option>
  <option value="4">Orange</option>
</select>
<select multiple="true" id="mySelect[1]">
  <option value="1" >Apple</option>
  <option value="2">Pear</option>
  <option value="3">Banana</option>
  <option value="4">Orange</option>
</select>
<select multiple="true" id="mySelect[2]">
  <option value="1" >Apple</option>
  <option value="2">Pear</option>
  <option value="3">Banana</option>
  <option value="4">Orange</option>
</select> 
```

如果在第一个下拉菜单中选择了苹果，梨，那么在接下来的两个下拉菜单中，苹果选项应该被禁用并用红色着色。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T23:51:40.573

这应该让您对如何开始有一个很好的了解：

```
//cancels given event
function cancelEvent(ev) {
    ev.preventDefault();
    ev.returnValue = false; 
    ev.cancelBubble = true;
    return false;
}

function checkSelection(e) {
var oSel = e.target
var oPrvSel;

    for(var i=0; i<e.target.index; i++) {
        oPrvSel = document.getElementById("mySelect[" + i + "]");
        for(var j=0; j<oPrvSel.options.length; j++) {
            if (oPrvSel.options[j].text == e.target.options[e.target.selectedIndex].text) return cancelEvent(e);
        }
    }

}

//at instanciation of new elements:
var oSel = document.getElementById("mySelect[" + i + "]");
oSel.index = i;
oSel.addEventListener("keydown", checkSelection, false); 
```

# amazon-ec2 - AWS：从 AmazonCloudWatch.GetMetricStatistics() 获取 400 Bad Request 错误

> ID：10825602
> 
> 赞同：1
> 
> 时间：2012-05-30T23:17:18.770
> 
> 标签：amazon-ec2, amazon-web-services, metrics, amazon-cloudwatch

我在使用 AmazonCloudWatch 获取 CPU 利用率时遇到了一点问题。当我尝试使用 AmazonCloudWatch.GetMetricStatistics() 时，我收到一条**异常消息**：

> 引发了“Amazon.CloudWatch.AmazonCloudWatchException”类型的异常。

这是一个**内部异常**：

> {“远程服务器返回错误：(400) 错误请求。”}

这是我用来拨打电话的代码：

```
public static String getCPUStats(String Endpoint, String InstanceID) 
    {
        try
        {
            AmazonCloudWatchConfig cloudConfig = new AmazonCloudWatchConfig();
            cloudConfig.ServiceURL = Endpoint;

            string AWSAccessKey = Sql.ToString(appConfig["AWSAccessKey"]);
            string AWSSecretKey = Sql.ToString(appConfig["AWSSecretKey"]);

            AmazonCloudWatch client = AWSClientFactory.CreateAmazonCloudWatchClient(AWSAccessKey, AWSSecretKey, cloudConfig);

            GetMetricStatisticsRequest request = new GetMetricStatisticsRequest();
            request.Dimensions.Add(new Dimension { Name = "InstanceId", Value = InstanceID });
            request.StartTime = DateTime.UtcNow.AddMinutes(-5);
            request.EndTime = DateTime.UtcNow;
            request.Namespace = "AWS/EC2";
            request.Statistics.Add("Maximum");
            request.Statistics.Add("Average");
            request.MetricName = "CPUUtilization";
            request.Period = 60;

            GetMetricStatisticsResponse r = client.GetMetricStatistics(request);

            if (r.GetMetricStatisticsResult.Datapoints.Count > 0)
            {
                Datapoint dataPoint = r.GetMetricStatisticsResult.Datapoints[0];
                return "CPU maximum load: " + dataPoint.Maximum;

            }

            return "No data available.";
        }
        catch (Exception ex)
        {
            return ex.Message;
        }
    } 
```

一些旁注 - 访问密钥、秘密访问密钥和端点可以很好地创建 AmazonEC2Client，所以我很确定问题不存在。

我已经做了很多谷歌搜索和研究文档，但没有成功解决这个问题。有任何想法吗？非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T19:41:59.507

不幸的是，我们无法弄清楚这一点 - 我们最终决定使用 Microsoft Azure 而不是 Amazon Web Services :(

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T09:33:37.600

我认为您一次只能请求一个统计信息。所以尝试删除`request.Statistics.Add("Maximum");`或`request.Statistics.Add("Average");`

# backup - 如何将 MSDE 数据库恢复到上次备份

> ID：10825607
> 
> 赞同：0
> 
> 时间：2012-05-30T23:18:00.133
> 
> 标签：backup, restore, msde

我们有一个巨大的 (17 gig) MSDE 备份文件，我们发现过去 4 年来它每晚都在附加。

我们昨晚发生了数据库故障，现在我们需要恢复数据库。我们尝试了标准还原，但它将数据库信息一直还原到 2008 年。这不能准确反映上次备份时的数据库状态。

我们如何恢复到最后一次备份（甚至是日期/时间），而不是一直回到 2008 年？

欢呼声

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T01:03:30.217

打开日志文件，找出你想要的备份日期然后使用脚本

从磁盘恢复数据库 [restoretest] = N'C:\folder\backfile.bak' WITH FILE = 1494 GO

欢呼一个有效的答案。

嗡嗡声

# jenkins - 如何向 Jenkins 添加用户名和密码？

> ID：10825614
> 
> 赞同：57
> 
> 时间：2012-05-30T23:18:20.057
> 
> 标签：jenkins

当我访问 mydomain.com:8080 时，默认情况下没有授权机制。我查看了配置区域，但找不到添加基本用户名和密码的地方

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2012-05-31T00:03:30.200

转到*管理 Jenkins > 配置全局安全*并选中*启用安全*复选框。

对于基本的用户名/密码身份验证，我建议为安全领域选择*Jenkins Own User Database*，然后为*Authorization选择**登录用户可以做任何事情*或基于矩阵的策略（如果您有多个具有不同权限的用户）。

 ** * *

## 回答 #2

> 赞同：7
> 
> 时间：2017-07-18T17:56:33.153

假设您已选中*Manage Jenkins > Configure Global Security > Enable Security*和*Jenkins Own User Database*，您将转到：

*   *管理 Jenkins > 管理用户 > 创建用户*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-04-02T07:28:26.033

*   尝试从位于以下路径的系统中删除 .jenkins 文件夹。C:\Users\"你的电脑名称".jenkins

*   现在从 jenkins 官网下载一个新的稳定版本的 .war 文件。例如。2.1并按照步骤安装。

    *   您将可以通过此方法进行

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-11-07T12:48:26.720

您需要在*配置全局安全页面上**启用安全*并设置安全领域（请参阅：[标准安全设置](https://wiki.jenkins.io/display/JENKINS/Standard+Security+Setup)）并选择适当的授权方法（*安全领域*）。

 **[![Jenkins Security Realm，Hudson 自己的用户数据库](../Images/31082018ee2ddfb2c033fb83777543e4.png)](https://i.stack.imgur.com/XEvgU.png)

根据您的选择，使用适当的方法创建用户。推荐的方法是选择*Jenkins 自己的用户数据库*并勾选*Allow users to sign up*，点击 Save 按钮，然后您应该可以从 Jenkins 界面创建用户。否则，如果您选择了外部数据库，则需要在那里创建用户（例如，如果它是 Unix 数据库，则使用现有 Linux/Unix 用户的凭据或使用 shell 接口创建标准用户）。

另请参阅：[通过 API 在 Jenkins 中创建用户](https://stackoverflow.com/q/17716242/55075)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-10-10T06:44:09.053

如果以管理员身份安装，请使用：-

```
uname - admin
pw - the passkey that was generated during installation 
```***

# iphone - iPhone上的颤抖文字

> ID：10825615
> 
> 赞同：6
> 
> 时间：2012-05-30T23:18:28.123
> 
> 标签：iphone, css, wordpress, text

这是一个奇怪的错误，它出现在 iPhone (4S) 而不是 iPad (3) 或任何桌面浏览器上。当我从该站点加载任何页面时，请说：

[http://www.courtniv.com/what-is-eco-fashion/](http://www.courtniv.com/what-is-eco-fashion/)

在我的 iPhone 上，面包屑（“Home » JustMeans » What is Eco Fashion?”）的文字看起来很精神分裂。它以大约每秒 3 次的速度来回快速改变大小，从正确的大小变为大几个点的大小。有时文章文本也很不稳定，有时从第二段开始。有时页脚版权文本也不稳定。

我尝试删除：

```
<?php get_template_part('includes/scripts'); ?> 
```

从页脚开始，起初它似乎可以工作，但后来刷新了几次，问题又回来了。当我从自定义样式表中删除字体大小声明时，情况相同。我在 iPhone 上禁用了 Javascript，但问题仍然存在。

奇怪的是，它不会每次在我的 iPhone 上加载页面时都这样做，但大多数时候都会这样做。通常，如果我更改代码中的某些内容，它将在下一次刷新时停止，但稍后会返回几次刷新。有时，如果我加载页面并等待一段时间，什么都不做，精神分裂症就会停止。有时文章文本会停止抖动，但面包屑会继续抖动。刷新页面几乎总能把它带回来。页面完成加载后它肯定会继续。现在已经持续了十分钟。在屏幕锁定、改变方向以及再次关闭和打开 Safari 之后，它会继续摆动。

在我 10 年的网页设计生涯中，我从未见过这样的事情。任何线索是什么导致了这个和/或如何解决它？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T20:25:23.227

我以前从未遇到过这种问题。但是，这里有两种解决方案。

## 解决方案#1

将以下内容添加到 css 应防止字体​​调整大小。

```
html {
  -webkit-text-size-adjust:none;
} 
```

由于这似乎只是 iPhone 上的一个问题，因此只针对具有媒体查询的终端是有意义的：

```
@media only screen and (max-device-width: 960px) { 
  html { 
    -webkit-text-size-adjust:none; 
  }
} 
```

`html`您可以将其添加到`#breadcrumb, .post-meta`具有相同大小调整问题的其他选择器中，而不是将其应用于您。

## 解决方案#2

该问题似乎也与以下规则集有关：

```
a,
.textwidget a img,
div.category a,
.sociable ul li {
  -webkit-transition: all .3s ease;
  -khtml-transition: all .3s ease;
  -moz-transition: all .3s ease;
  -ms-transition: all .3s ease;
  -o-transition: all .3s ease;
  transition: all .3s ease;
} 
```

将其更改为：

```
@media only screen and (max-device-width: 960px) { 
  a,
  .textwidget a img,
  div.category a,
  .sociable ul li {
    -webkit-transition: none;
    transition: none;
  }
} 
```

也会解决问题。

在您的情况下，我会选择解决方案 #2，因为解决方案 #1 会缩小目标元素的文本大小。

# mysql - mysql外键创建表

> ID：10825617
> 
> 赞同：0
> 
> 时间：2012-05-30T23:18:37.147
> 
> 标签：mysql, foreign-keys

```
String query = "CREATE TABLE IF NOT EXISTS platforms ( " +
                   "id INTEGER UNSIGNED NOT NULL AUTO_INCREMENT, " +
                   "sites_id INTEGER UNSIGNED NOT NULL, " +
                   "baseline BLOB NULL, " +
                   "platform BLOB NULL, " +
                   "siteinfo BLOB NULL, " +
                   "databases BLOB NULL, " +
                   "PRIMARY KEY(id), " +
                   "INDEX (sites_id), " +
                   "FOREIGN KEY (sites_id) " +
                     "REFERENCES sites (id) " +
                        "ON DELETE NO ACTION " +
                        "ON UPDATE NO ACTION " +
                   ")ENGINE=InnoDB;"; 
```

这是我正在尝试创建的 MySQL 数据库的 SQL 查询。但是，我不知道为什么，我收到以下错误：

> “您的 SQL 语法有错误；请查看与您的 MySQL 服务器版本相对应的手册，了解在 'databases BLOB NULL, PRIMARY KEY(id), INDEX (sites_id), FOREIGN KEY (sites_id) R' 附近使用的正确语法”在第 1 行"

有人可以指出是什么问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T23:21:51.790

`DATABASES`是一个[保留字](http://dev.mysql.com/doc/en/reserved-words.html)。使用反引号```字符引用它：

```
`databases` BLOB NULL 
```

# php - 使用 Active Record 进行 CodeIgniter 分页

> ID：10825619
> 
> 赞同：0
> 
> 时间：2012-05-30T23:18:49.727
> 
> 标签：php, mysql, codeigniter, activerecord, pagination

我认为每个人（主要是 CI 用户的初学者）都在使用活动记录进行分页时遇到困难。

在 CI 的官方文档中，没有明确的声明解释如何在活动记录中使用分页类对象。我的问题是；不能定义当前页面并将其设置为 SQL 语句。因此，当程序通过分页从 MySQL 中获取数据时，所有页面都首先导航 0 和`$config['per_page'];`. 我的意思是，如果我设置为`per_page=20`，所有页面链接都会获取 0,20 个 MySQL 行。

**我的 SQL 语句是：**

```
$this->db->query("SELECT b.*, a.adCampaignTitle FROM ads a, sms b WHERE b.`smsAd_ID`=a.ad_ID LIMIT " . $config['per_page'])->result(); 
```

**我的分页类属性：**

```
$this->load->database();
$config['base_url'] = 'http://localhost/index.php/admin/index/page/';
$config['total_rows'] = $this->db->count_all('sms');
$config['per_page'] = 2;
$this->pagination->initialize($config); 
```

如果有人帮助我如何初始化并将**当前页面**设置为 SQL 部分，我将非常高兴......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T23:45:24.827

查看您的 URL，第 4 段将包含偏移量。

因此，您可以使用：

```
$offset = $this->uri->segment(4, 0);

$this->db->query("SELECT ... LIMIT {$offset}, {$config['per_page']}"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T07:21:01.310

我们可以通过几种方式做到这一点..！

1.  您必须随身携带页码。就像每个电话一样，您只需移动到页码。

该参数可以称为`page_number`

所以你的网址看起来像`http://server.com/index.php/controller/function?page_number=2`

所以你只需要得到`($this->input->get('page_number') * $config['per_page'])`will become 作为一个 offset 然后 limit will be `$config['per_page']`。

1.  使用相同的计算，您可以在视图文件中执行并将其传递给`url`或`post parameter`喜欢`limit=1&offset=2`..！

我不会说这是最好的，但它是一个解决方案。

你选择你想要的..！

# maven - 使用 maven-release-plugin 部署额外的 jars 到 repo

> ID：10825622
> 
> 赞同：2
> 
> 时间：2012-05-30T23:19:08.297
> 
> 标签：maven, clojure, maven-release-plugin

我正在使用[zi](https://github.com/pallet/zi)和[maven-release-plugin](http://maven.apache.org/plugins/maven-release-plugin/)生成我试图提交给 maven 中央仓库的 jar 文件。包含在中央存储库中的要求之一是工件具有包含生成的 javadocs 的 -javadoc.jar 文件。如果这不可能，他们[要求](https://docs.sonatype.org/display/Repository/Central+Sync+Requirements)您有一个空的 -javadoc.jar 文件才能通过自动化测试。

我正在使用[exec-maven-plugin](http://mojo.codehaus.org/exec-maven-plugin/)生成空 jar 文件，并将其放置在正确的位置，但它被 maven-release-plugin 忽略了。结果，它没有被我的 GPG 密钥签名，也没有被部署到 repo。

是否可以使用 javadoc 插件生成一个空的 javadoc jar 文件？

如果 javadoc 插件不会生成空的 jar 文件，我如何让 maven-release-plugin 识别、签名和部署由我的 shell 脚本生成的 jar 文件？

还有其他一些我忽略的选择吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T01:16:18.553

您应该尝试通过[build-helper-maven-plugin](http://mojo.codehaus.org/build-helper-maven-plugin/attach-artifact-mojo.html)添加 jar 源，它可用于将工件附加到循环。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T01:11:38.170

您是使用 clojure 编写 maven 插件还是创建用 Clojure 编写的项目？

clojure-maven 是一个使用 clojure 编写 maven 插件的工具：

```
Maven 组件允许在编写 Maven 插件时使用 clojure。
```

如果您在 Clojure 中创建项目，那么专为创建与 Central 兼容的 clojure 项目而设计的[zi 插件](http://palletops.com/zi-the-maven-plugin-in-clojure/)可能就是您所追求的。它由同一作者（雨果邓肯）撰写。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-31T03:52:51.193

所以我想通了。您需要在编译阶段使用 exec-maven-plugin 插件创建目标/apidocs，而不是直接通过 shell 脚本创建空 jar 文件。

```
<plugin>
  <artifactId>exec-maven-plugin</artifactId>
  <groupId>org.codehaus.mojo</groupId>
  <executions>
    <execution>
      <id>Generate Empty Javadoc</id>
      <phase>compile</phase>
      <goals>
        <goal>exec</goal>
      </goals>
      <configuration>
        <executable>${basedir}/scripts/emtpy-apidocs.sh</executable>
        <arguments>
          <argument>${project.build.directory}/apidocs</argument>
        </arguments>
      </configuration>
    </execution>
  </executions>
</plugin> 
```

然后在打包阶段使用 javadoc 插件创建 jar。生成的 jar 现在将由发布插件获取。

```
<plugin>
  <groupId>org.apache.maven.plugins</groupId>
  <artifactId>maven-javadoc-plugin</artifactId>
  <version>2.8.1</version>
  <executions>
    <execution>
      <id>attach-javadocs</id>
      <goals>
        <goal>jar</goal>
      </goals>
    </execution>
  </executions>
</plugin> 
```

# linq-to-entities - linq 到实体选择不同的

> ID：10825628
> 
> 赞同：1
> 
> 时间：2012-05-30T23:20:02.113
> 
> 标签：linq-to-entities, distinct

在了解 LINQ to 实体命名法方面，我有点挣扎。并且非常感谢一些帮助解决如何有效和高效地使用 LINQ 命名法（即让数据库返回最少数量的记录，而不是在编程级别迭代更大的集合）。到目前为止，我经常依靠存储过程和视图来完成这项工作，但希望能在学习 LINQ 方式时得到一些帮助。

首先，有人会帮助“翻译” SQL 查询：

```
SELECT     InfusionDrugID, fullname
FROM         dbo.infusionDrugs
WHERE     (InfusionDrugID IN
                      (SELECT DISTINCT infusionDrugID
                        FROM dbo.fixedTimeDilutions)) 
```

我也会对如何选择不在另一个表中的记录感兴趣。

这有点复杂，因为 fixedTimeDilutions 使用每个具体类型继承的表，并从抽象类 infusionDilutions 继承，因此 linq 语句必须包含一行，例如。

```
from inf in PICUentities.infusionDilutions.OfType<fixedTimeDilutions>() 
```

感谢您的任何建议

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T09:01:07.593

如果你想使用 linq，你必须*考虑*linq。也就是说，尝试用 linq 和“忘记”SQL 的 C# 代码来表达你想要实现的任何东西。

但是，如果您这样做，您很快就会发现忘记 SQL 是不可能的，因为许多 linq 和其他 C# 代码的组合并不能转换为 SQL。所以它是给予和接受，想想 linq，但要了解 Entity Framework 做什么和不吞下什么。

在您的情况下，您希望`infusionDrugs`在`fixedTimeDilutions`. linq 的方式是：

```
c.infusionDrugs
    .Where(i => c.fixedTimeDilutions.OfType<fixedTimeDilutions>().Select(f => f.infusionDrugID).Distinct())
    .Contains(i.InfusionDrugID)) // Or i.InfusionDrugID.Value 
```

（`c`你的上下文在哪里）

或者

```
c.infusionDrugs
    .Where(i => c.fixedTimeDilutions.OfType<fixedTimeDilutions>()
        .Any(f => f.infusionDrugID == i.InfusionDrugID)) // Or i.InfusionDrugID.Value 
```

（如果我忘记了一些括号，请原谅我）

# python - 亚马逊产品广告 API（ItemSearch 和 ItemPage）

> ID：10825629
> 
> 赞同：1
> 
> 时间：2012-05-30T23:20:02.333
> 
> 标签：python, web-services, api, amazon-web-services, amazon

我写了以下代码：

```
from hashlib import sha256
from base64 import b64encode
import hmac
import urllib
from time import strftime, gmtime

url = 'http://ecs.amazonaws.com/onca/xml'
AWSAccessKeyId = amazon_settings.amazon_access_key_id
AssociateTag = amazon_settings.amazon_associate_tag
Keywords = urllib.quote_plus('Potter')
Operation = 'ItemSearch'
SearchIndex = 'Books'
Service = 'AWSECommerceService'
Timestamp = urllib.quote_plus(strftime("%Y-%m-%dT%H:%M:%S.000Z", gmtime()))
Version = '2011-08-01'

sign_to = 'GET\necs.amazonaws.com\n/onca/xml\nAWSAccessKeyId=%s&AssociateTag=%s&Keywords=%s&Operation=%s&SearchIndex=%s&Service=%s&Timestamp=%s&Version=%s' % (AWSAccessKeyId, AssociateTag, Keywords, Operation, SearchIndex, Service, Timestamp, Version)

Signature = urllib.quote_plus(b64encode(hmac.new(str(amazon_settings.amazon_secret_access_key), str(sign_to), sha256).digest()))

request = '%s?AWSAccessKeyId=%s&AssociateTag=%s&Keywords=%s&Operation=%s&SearchIndex=%s&Service=%s&Timestamp=%s&Version=%s&Signature=%s' % (url, AWSAccessKeyId, AssociateTag, Keywords, Operation, SearchIndex, Service, Timestamp, Version, Signature)

print request 
```

当我使用此代码时一切正常。但是，如果我尝试将 ItemPage 参数添加到 sign_to 变量并请求变量，我会收到错误 SignatureDoesNotMatch。

请帮帮我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T20:29:46.833

它实际上没有回答你的问题，但我建议你看看亚马逊产品广告 API 的优秀 python 包装器 - [python-amazon-product-api](https://bitbucket.org/basti/python-amazon-product-api/wiki/Home)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T03:41:14.713

在文档中很难找到，但您必须确保您的操作列表按字母顺序排列，否则会出现`SignatureDoesNotMatch`错误。

例如，`ItemPage`必须介于`AssociateTag`和之间`Keywords`才有效。

```
AWSAccessKeyId
AssociateTag
ItemPage
Keywords
Operation
ResponseGroup
SearchIndex
Service
SignatureVersion
Timestamp
Version 
```

# php - 在 php 文件中包含语句

> ID：10825632
> 
> 赞同：-1
> 
> 时间：2012-05-30T23:20:17.373
> 
> 标签：php, security, include

我有一个 php 文件（php1.php）。在该 php 文件中，我有以下行：

```
 include('php/PROTECT/login.php') 
```

但是，当我加载页面时，出现以下错误：

```
 Warning: include(php/login.php) [function.include]: failed to open stream: No such file or directory 
```

它只是完全忽略了 /PROTECT/ 部分？

有谁知道为什么会这样以及我如何解决这个问题？

我的文件结构如下：（php1.php 在 /php 内，login.php 在 /php/PROTECT

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T23:22:11.603

它应该看起来像：

```
include('php/PROTECT/login.php'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T23:53:51.790

确保这是引发错误的包含调用。确保没有其他代码在 php1.php 或它包含或需要的任何文件中尝试包含 php/login.php。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T23:56:43.557

如果`php1.php`在`/php/`（我理解为）内，那么您将需要使用以下内容：

```
include('PROTECT/login.php'); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-04-11T14:53:44.070

包含中的包含可能有点混乱，但如果与**DIR**连接起来会更容易。**DIR**始终是它自己的文件的路径，如果您使用**DIR**，您始终可以使用相对路径。像这样：

包括**DIR**。"/PROTECT/login.php";

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-05-30T23:59:37.840

正如您从错误消息中看到的那样：

```
Warning: include(php/login.php) 
```

" `PROTECT`" 被排除在路径之外，可能是因为全部大写。

将目录更改为全小写（“ `protect`”或类似的），看看是否遇到相同的错误。

# c++ - GDBM 顺序访问：错误？

> ID：10825639
> 
> 赞同：1
> 
> 时间：2012-05-30T23:21:17.503
> 
> 标签：c++, gdbm

我实现了以下 GBDM 示例：

```
#include <boost/lexical_cast.hpp>
#include <gdbm.h>
#include <iostream>
#include <string>
#include <string.h>

struct record
{
    int a;
    int b;
};

int main(int argc, char* argv[])
{
    GDBM_FILE db;

    db = gdbm_open("gdbm.db", 512, GDBM_WRCREAT | GDBM_NOLOCK | GDBM_SYNC, 0664, NULL);

    datum lekey;
    datum levalue;
    for (int i = 0; i < 10; ++i) {
        record r;
        r.a = i;
        r.b = i + 1;
        lekey.dptr = (char*) boost::lexical_cast<std::string>(i).c_str();
        lekey.dsize = strlen(lekey.dptr) + 1;
        levalue.dptr = (char*) &r;
        levalue.dsize = sizeof(record);
        gdbm_store(db, lekey, levalue, GDBM_INSERT);
    }
    gdbm_sync(db);

    for(lekey = gdbm_firstkey(db);
        lekey.dptr != NULL;
        lekey = gdbm_nextkey(db, lekey)) {
        levalue = gdbm_fetch(db, lekey);
        record* r = (record*) levalue.dptr;
        if (r) {
            std::cout << lekey.dptr << " " << r->a << " " << r->b << std::endl;
            free(levalue.dptr);
        }
    }

    gdbm_close(db);

    return 0;
} 
```

输出如下：

```
$ ./gdbm_example 
3 3 4
6 6 7
2 2 3
9 9 10
5 5 6
1 1 2
8 8 9
4 4 5 
```

为什么会`0 0 1`被`7 7 8`排除在外？这是一个错误还是我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T06:36:39.907

Joachim 是对的，在这里使用 boost::lexical_cast 是不合适的。使用以下代码重写您的示例：

```
std::string s;
std::stringstream str;
str << i;
s = str.str();
lekey.dptr = (char*) s.c_str(); 
```

它会按预期工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T05:58:39.807

问题可能是这一行：

```
lekey.dptr = (char*) boost::lexical_cast<std::string>(i).c_str(); 
```

这存储指向临时变量的指针，因此是未定义的行为。

键不必是字符串，也可以是数字，因此您可以使用例如：

```
lekey.dptr = &i;
lekey.dsize = sizeof(i); 
```

# ruby-on-rails - 在我的控制器中创建一个全新的动作会更好，还是应该在 Ruby on Rails 中创建一个新的控制器？

> ID：10825643
> 
> 赞同：0
> 
> 时间：2012-05-30T23:21:55.533
> 
> 标签：ruby-on-rails

基本上，我有一个现有的 CollegeClass 控制器，它具有默认的基本 RESTful 操作，例如显示用于显示该大学课程的网页、编辑用于编辑以及更新用于编辑页面本身的发布操作。我需要在此资源中添加一个额外**的**“关于班级”网页，该网页不会添加另一个模型。它只会在现有的 CollegeClass 表中添加另一个字段，用于显示新页面的 html。

我应该创建一个“关于班级”专有的控制器吗？或者我应该在 CollegeClass 控制器中添加新动作吗？还是我需要嵌套这个？

谢谢你的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T23:55:19.427

我会使用自定义操作并将其路由到大学路线内

```
resources :colleges do
  member do
    get 'about'
  end
end

CollegeController < ApplicationController
  def about
  end
end 
```

# javascript - addEventListener 在函数内部失败

> ID：10825647
> 
> 赞同：0
> 
> 时间：2012-05-30T23:23:21.293
> 
> 标签：javascript

我在添加事件侦听器时遇到问题。我基本上将所有与键盘相关的功能封装到一个 JavaScript 类中，如下所示：

```
function Keyboard()
{
    this.key = new Array();

    for(x=0;x<255;x++)
    {
        this.key[x] = false;
    }

    function keyDown(evt)
    {
        this.key[evt.keyCode] = true;
        console.log("Keydown bioch");
    }

    function keyUp(evt)
    {
        this.key[evt.keyCode] = false;
    }

    window.addEventListener('keydown', this.keyDown, true);
    window.addEventListener('keyup', this.keyUp, true);
} 
```

除了它根本不起作用。当我删除键盘功能并使所有内容成为全局（key[]、keyDown、keyUp 和 addEventListener 调用）时，一切正常。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-30T23:27:26.580

您在不合适的地方使用了[`this`关键字。](https://developer.mozilla.org/en/JavaScript/Reference/Operators/this)此外，您的对象没有`keyDown`/`keyUp`属性。

您将需要取消对数组的引用，因为`this`在侦听器中将指向事件接收 (dom) 元素 - 该元素没有`key`属性。要引用您的本地函数，只需使用它们的名称：

```
function Keyboard() {
    var arr = this.key = new Array();
    for(x=0;x<255;x++)
        arr[x] = false;

    function keyDown(evt) {
        arr[evt.keyCode] = true;
        console.log("Keydown bioch");
    }
    function keyUp(evt) {
        arr[evt.keyCode] = false;
    }

    window.addEventListener('keydown', keyDown, true);
    window.addEventListener('keyup', keyUp, true);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T23:31:09.430

回调函数中的“this”引用引用的是窗口对象，而不是您可能期望的函数范围。

看到这个答案。

[JavaScript 回调范围](https://stackoverflow.com/questions/183214/javascript-callback-scope)

# hadoop - 在 Pig 中 JOIN 后从别名生成所有字段

> ID：10825648
> 
> 赞同：8
> 
> 时间：2012-05-30T23:23:27.363
> 
> 标签：hadoop, apache-pig

我想在 Apache Pig中执行相当于“keep all `a`in `A`where `a.field == b.field`for some `b`in ”的操作。`B`我正在执行它，

```
AB_joined = JOIN A by field, B by field;
A2 = FOREACH AB_joined GENERATE A::field as field, A::field2 as field2, A::field3 as field3; 
```

枚举所有`A`的条目是很愚蠢的，我宁愿做类似的事情，

```
A2 = FOREACH AB_joined GENERATE flatten(A); 
```

但是，这似乎不起作用。有没有其他方法可以在不枚举`A`'s 字段的情况下做一些等效的事情？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-29T14:40:47.000

这应该有效：

```
A2 = FOREACH AB_joined GENERATE $0.. 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-09-15T11:48:19.053

您可以使用 COGROUP 将 A 的列与 B 的列分开。这在 A 的架构是动态的并且您不希望代码在 A 的架构更改时失败时特别有用。

```
AB = COGROUP A BY field, B BY field;

-- schema of AB will be:
-- {group, A:{all fields of A}, B:{all fields of B}}

A2 = FOREACH AB FLATTEN(A); 
```

希望这可以帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-07-21T11:15:32.240

从至少 pig 0.9.1 开始，您可以使用*星型表达式*或*项目范围表达式*从元组中选择多个字段。阅读[Pig Latin 0.15.0，表达式章节](http://pig.apache.org/docs/r0.15.0/basic.html#expressions)了解详细信息。

这是我的示例，只是为了让您理解。

```
-- A: {id: long, f1: int, f2: int, f3: int, f4: int}
-- B: {id: long, f5: int} 
```

让我们加入 A & B 并只选择 A 的字段

```
AB = FOREACH (JOIN A BY id, B by id) GENERATE $0..$4;
--AB: {A::id: long, A::f1: int, A::f2: int, A::f3: int, A::f4: int} 
```

或者

```
BA = FOREACH (JOIN B BY id, A by id) GENERATE $2..;
--BA: {A::id: long, A::f1: int, A::f2: int, A::f3: int, A::f4: int} 
```

使用星形表达式选择所有字段

```
AB = FOREACH (JOIN A BY id, B by id) GENERATE *;
--AB: {A::id: long, A::f1: int, A::f2: int, A::f3: int, A::f4: int, B::id: long, B::f5: int} 
```

使用 Project-range 表达式选择所有不同的字段（没有 B::id 字段）

```
AB = FOREACH (JOIN A BY id, B by id) GENERATE $0..$4, f5;
--AB: {A::id: long, A::f1: int, A::f2: int, A::f3: int, A::f4: int, B::f5: int} 
```

有时，当您在一个关系中有数十个字段而在另一个关系中只有几个字段时，它真的很有用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-03-09T17:21:07.737

对于 Pig 12 及更高版本，请使用 PluckTuple： [https](https://pig.apache.org/docs/r0.12.0/func.html#plucktuple) ://pig.apache.org/docs/r0.12.0/func.html#plucktuple 。

```
AB_joined = JOIN A by field, B by field;
DEFINE pluck PluckTuple('A::');
A2 = FOREACH AB_joined generate FLATTEN(pluck(*)); 
```

# java - 带有样式块的 JTextField

> ID：10825650
> 
> 赞同：2
> 
> 时间：2012-05-30T23:23:56.360
> 
> 标签：java, swing, jtextfield, styleddocument

我需要某种 JTextField，用样式块替换回车符，用另一种字体、样式或颜色显示文本 <New Line>。

例如，文本..

```
Dear Mr. Smith,\nblablabla...\nRegards... 
```

..将在一行 JTextField 中以这种方式显示给用户：

> **亲爱的史密斯先生，***<新线>* **blablabla...** *<新线>***问候...**

这些 <New Line> 应该是可以选择的块，就像它是单个字符一样，并且可以通过单个退格键删除。按回车键将在插入符号位置添加 <New Line>。

我认为可以通过覆盖来实现`PlainDocument`，但我陷入了难以理解的 Document 和 EditorKit API 中。我需要一些关于这个的指针......

我对使用 a 没有任何异议`JTextPane`，`JEditorPane`只要它的行为类似于 a `JTextField`（一行，没有滚动条）。

有什么建议么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-31T00:22:11.703

> 有什么建议么 ？

请改用`JTextArea`（多行组件）。

例如，请参阅[此答案](https://stackoverflow.com/questions/3244400/socket-using-in-a-swing-applet/3245805#3245805)：

[![](../Images/6d71899e32c561b40afffa33fe306414.png)](https://i.stack.imgur.com/HuIjT.png)

* * *

> 这会更简单，但这不是我必须做的......

很公平，我错过了陈述的部分：

> ..使用另一种字体、样式或颜色。

这将需要一个样式化的文档，例如`JEditorPane`or `JTextPane`。

# mysql - MySQL 中的 3000 万行

> ID：10825651
> 
> 赞同：6
> 
> 时间：2012-05-30T23:24:34.347
> 
> 标签：mysql, database-design, database-optimization

晚上，

我正在经历将数据从 15 岁的只读数据格式导入 MySQL 的漫长过程，以从中构建一些较小的统计表。

我之前构建的最大表（我认为）是 3200 万行，但我没想到它会变得那么大，而且真的让 MySQL 吃力。

该表将如下所示：

```
surname    name    year    rel    bco    bplace    rco    rplace
Jones      David   1812    head   Lond   Soho      Shop   Shewsbury 
```

所以，小整数和varchars。

任何人都可以提供有关如何使其尽快发挥作用的建议吗？任何列上的索引会有所帮助，还是它们只会减慢查询速度。

每列中的大部分数据将被重复多次。有些字段的可能值不超过 100 个。

我将查询表的主要列是：surname、name、rco、rplace。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-30T23:47:50.780

`INDEX`在一列上固定搜索。尝试`INDEX`在查询中更经常使用的列。正如您所提到的，您将使用 columns `surname, name, rco, rplace`。我建议你索引它们。

由于该表有 3200 万条记录，因此编制索引需要一些时间，但值得等待。

# css - Css 和自动完成

> ID：10825654
> 
> 赞同：0
> 
> 时间：2012-05-30T23:24:46.983
> 
> 标签：css, autocomplete

我在我的一个应用程序中使用自动完成插件，由自动完成插件创建的自动完成 div 具有属性`Position: Absolute;`。我的导航菜单中有一个下拉 div，其中有一个触发自动完成功能的输入字段。一切正常，除了当我将鼠标悬停在自动完成 div 上时。一旦我将鼠标悬停在自动完成 div 上，下拉 div 就会消失，因为它由以下 css 显示：

```
#nav li:hover > .subnav{
  display: block;
}

#nav .subnav {
  position:absolute;
  background:#fff;
  padding:10px;
  padding-right:15px;
  text-align:left;
  width:180px;
  border:1px solid #ccc;
  border-top:none;
  z-index:1200;
  -moz-box-shadow: 0px 1px 3px rgba(0, 0, 0, 0.3);
  -webkit-box-shadow: 0px 1px 3px rgba(0, 0, 0, 0.3);
  box-shadow: 0px 1px 3px rgba(0, 0, 0, 0.3);
  display:none;
  margin:6px -1px;
} 
```

这`#nav`是包含导航链接的 ul，`.subnav`是下拉 div。一旦用户将鼠标悬停在自动完成 div 上以选择条目，我不希望 .subnav div 消失。

# gwt - CheckboxCell、MultiSelectionModel 不小心重置了 DataGrid 的数据

> ID：10825657
> 
> 赞同：0
> 
> 时间：2012-05-30T23:25:01.370
> 
> 标签：gwt, datagrid, checkbox, selectionmodel

使用 GWT 2.4...

我正在构建一个复杂的复合双视图/编辑模式实现，该实现由 GWT 的 DataGrid 和 MultiSelectionModel 提供支持。我的目标是让用户能够单击他们想要发布更新的每一行中的复选框。

这是半功能界面的屏幕截图：

![能源供应输入屏幕示例](../Images/4a8c7328ad6ec826eb601cc1baf50225.png)

注意选定的（突出显示的）行。

现在的问题是，当我在任何单元格中输入内容时（例如，$/Mw 1 复合单元格标题下的第一行 $ 单元格），然后单击该行的复选框（或任何其他行的复选框）以选择或取消选择，第一次请求屏幕数据时，该值将重置为原始值。任何时候都不想要的行为！

让我们看一下我对网格的自定义实现。（请原谅长度）。

```
public abstract class ToggleableGrid<T extends Identifiable<?>> extends Composite {

private static final int CHKBOX_COLUMN_WIDTH = App.INSTANCE.checkboxColumnWidth();
private static final DisplayMode DEFAULT_MODE = DisplayMode.VIEW;

private ProvidesKey<T> keyProvider;

private DataGrid<T> grid;

private MultiSelectionModel<T> selectionModel;

private ListDataProvider<T> dataProvider;
private int tabIndex = 0;

public ToggleableGrid() {
    final DataGridConfiguration config = new DefaultDataGridConfiguration();
    initGrid(config);
}

public ToggleableGrid(DataGridConfiguration config) {
    initGrid(config);
}

private void initGrid(DataGridConfiguration config) {
    keyProvider = new ProvidesKey<T>() {
        @Override
        public Object getKey(T item) {
            return item == null ? null : item.getId();
        }
    };
    grid = new DataGrid<T>(config.getPageSize(), config.getResources(), keyProvider);
    // Set the message to display when the table is empty.
    grid.setEmptyTableWidget(new Label(UiMessages.INSTANCE.no_results()));
    initWidget(grid);
    setVisible(true);
}

public void setInput(List<T> content) {
    setInput(content, DEFAULT_MODE);
}

public void setInput(List<T> content, DisplayMode mode) {
    resetTableColumns();
    if (isInEditMode(mode)) {
        // Add a selection model so we can select cells
        selectionModel = new MultiSelectionModel<T>(keyProvider);
        grid.setSelectionModel(selectionModel, DefaultSelectionEventManager.<T> createCheckboxManager(0));
        addRowSelector();
    }
    dataProvider = new ListDataProvider<T>(content);
    final ListHandler<T> sortHandler = new ListHandler<T>(dataProvider.getList());
    grid.addColumnSortHandler(sortHandler);
    initializeStructure(constructMetadata(), sortHandler, mode);
    dataProvider.addDataDisplay(grid);
}

// see https://stackoverflow.com/questions/3772480/remove-all-columns-from-a-celltable
// concrete classes are forced to maintain a handle on all columns added
private void resetTableColumns() {
    for (final Column<T, ?> column: allColumns()) {
        grid.removeColumn(column);
    }
    allColumns().clear();
}

protected boolean isInEditMode(DisplayMode currentDisplayMode) {
    boolean result = false;
    if (currentDisplayMode.equals(DisplayMode.EDIT)) {
        result = true;
    }
    return result;
}

protected abstract Set<Column<T, ?>> allColumns();

protected abstract TableMetadata constructMetadata();

protected abstract void initializeStructure(TableMetadata metadata, ListHandler<T> sortHandler, DisplayMode mode);

protected void setColumnHorizontalAlignment(Column<T, ?> column, HorizontalAlignmentConstant alignment) {
    column.setHorizontalAlignment(alignment);
}

// TODO figure out how to add a checkbox to column header that provides select/de-select all capability

// see https://stackoverflow.com/questions/6174689/gwt-celltable-programmatically-select-checkboxcell
protected void addRowSelector() {
    final Column<T, Boolean> rowSelectColumn = new Column<T, Boolean>(new CheckboxCell(true, false)) {

        @Override
        public Boolean getValue(T value) {
            Boolean result;
            // check for null value and return null;
            if(value == null || value.getId() == null) {
                result = null;
            } else {  // get value from the selection model
                result = selectionModel.isSelected(value);
            }
            return result;
        }

    };

    addColumn(rowSelectColumn, UiMessages.INSTANCE.select());
    setColumnWidth(rowSelectColumn, CHKBOX_COLUMN_WIDTH, Unit.PX);
    setColumnHorizontalAlignment(rowSelectColumn, HasHorizontalAlignment.ALIGN_CENTER);
}

protected void setColumnWidth(Column<T, ?> column, int width, Unit unit) {
    grid.setColumnWidth(column, width, unit);
}

protected void addColumn(Column<T, ?> column, String columnHeaderName) {
    addColumn(column, columnHeaderName, HasHorizontalAlignment.ALIGN_RIGHT);
}

protected void addColumn(Column<T, ?> column, String columnHeaderName, HorizontalAlignmentConstant alignment) {
    final SafeHtmlBuilder sb = new SafeHtmlBuilder();
    final String divStart = "<div align=\""+ alignment.getTextAlignString() + "\" class=\"" +UiResources.INSTANCE.style().word_wrap() + "\">";
    sb.appendHtmlConstant(divStart).appendEscaped(columnHeaderName).appendHtmlConstant("</div>");
    final SafeHtml header = sb.toSafeHtml();
    grid.addColumn(column, header);
    allColumns().add(column);
}

protected CompositeCell<T> generateCompositeCell(final List<HasCell<T, ?>> hasCells) {
    final CompositeCell<T> compositeCell = new CompositeCell<T>(hasCells) {

        @Override
        public void render(Context context, T value, SafeHtmlBuilder sb) {
            sb.appendHtmlConstant("<table><tbody><tr>");
            super.render(context, value, sb);
            sb.appendHtmlConstant("</tr></tbody></table>");
        }

        @Override
        protected Element getContainerElement(Element parent) {
            // Return the first TR element in the table.
            return parent.getFirstChildElement().getFirstChildElement().getFirstChildElement();
        }

        @Override
        protected <X> void render(Context context, T value,
                SafeHtmlBuilder sb, HasCell<T, X> hasCell) {
            final Cell<X> cell = hasCell.getCell();
            sb.appendHtmlConstant("<td>");
            cell.render(context, hasCell.getValue(value), sb);
            sb.appendHtmlConstant("</td>");
        }
    };
    return compositeCell;
}

// FIXME not working quite the way we'd expect, index incremented within column for each row, not each row by column
protected int nextTabIndex() {
    tabIndex++;
    return tabIndex;
}

protected AbstractCellTable<T> getGrid() {
    return grid;
}

/**
 * Gets the selected (row(s) of) data from grid (used in edit mode)
 * @return the selected data (as per selection model)
 */
public List<T> getSelectedData() {
    final List<T> data = new ArrayList<T>();
    data.addAll(selectionModel.getSelectedSet());
    return data;
}

/**
 * Gets all (row(s) of) data in grid (used in edit mode)
 * @return all data as list
 */
public List<T> getAllData() {
    return dataProvider.getList();
}

/**
 * Clears the currently selected (row(s) of) data (used in edit mode)
 */
public void clearSelectedData() {
    selectionModel.clear();
    grid.redraw();
}

} 
```

所以，盯着上面的有趣方法（我认为）是**setInput**，**generateCompositeCell**和**addRowSelector**。

我们用 List 数据初始化网格，并在 setInput 中设置显示模式。在这里也初始化了选择模型。它使用 GWT 的 DefaultSelectionEventManager createCheckboxManager()。

我一直在尝试理解事件模型，但它让我望而却步。我已经在线访问了以下资源，但在解决此问题的途径上还不够。

-- [https://groups.google.com/forum/?fromgroups#!topic/google-web-toolkit/k5sfURxDaVg](https://groups.google.com/forum/?fromgroups#!topic/google-web-toolkit/k5sfURxDaVg) AbstractInputCell 的 getConsumedEventsImpl 增加了焦点、模糊和 keydown，所以这（我相信）不是我需要探索的轨道

-- [GWT CellTable 以编程方式选择 CheckBoxCell](https://stackoverflow.com/questions/6174689/gwt-celltable-programmatically-select-checkboxcell) 可以实例化 CheckBoxCell 的各种方法让我感到好奇，我尝试了许多构造函数参数排列，但我选择的一种（真，假）是（我相信）正确的一种

在这里和现在（在被谴责之前）同意我的实施中可能存在一些不必要的复杂性，但我仍在寻找指导。谢谢！

**更新**

如果它有帮助，这里是前面提到的 ToggleableGrid 的一个实现。如果有的话，它会为您提供有关每个 CompositeCell 内容的更多详细信息。有关 AbstractValidatableColumn 和 ValidatableInputCell 的详细信息，请参阅：[寻找 GWT 验证示例...你在哪里？](https://stackoverflow.com/questions/9122802/in-search-of-a-gwt-validation-example-where-art-thou).

```
public class EnergyOfferGrid extends ToggleableGrid<EnergyOfferDTO> {

public EnergyOfferGrid() {
    super();
}

public EnergyOfferGrid(DataGridConfiguration config) {
    super(config);
}

private static final int MAX_NUMBER_OF_MW_PRICE_POINTS = App.INSTANCE.maxNoOfMwPricePoints();

private Set<Column<EnergyOfferDTO, ?>> columns = new HashSet<Column<EnergyOfferDTO, ?>>();

@Override
protected Set<Column<EnergyOfferDTO, ?>> allColumns() {
    return columns;
}

@Override
protected TableMetadata constructMetadata() {
    final TableMetadata metadata = new TableMetadata();

    // TODO Consider a predefined set of ReferenceData to be held in a common package

    // Use Slope
    metadata.addColumnMetadata(UiMessages.INSTANCE.use_slope(), new String[] {UiMessages.INSTANCE.yes(), UiMessages.INSTANCE.no()}, new String[] {"true", "false"});

    return metadata;
}

@Override
protected void initializeStructure(TableMetadata metadata, ListHandler<EnergyOfferDTO> sortHandler, DisplayMode currentDisplayMode) {
    addHourColumn(sortHandler);
    addUseSlopeColumn(metadata, sortHandler, currentDisplayMode);
    for (int i = 0; i < MAX_NUMBER_OF_MW_PRICE_POINTS; i++) {  // zero-based indexing
        addPriceMwColumn(i, currentDisplayMode);
    }
}

protected void addHourColumn(ListHandler<EnergyOfferDTO> sortHandler) {
    final Column<EnergyOfferDTO, String> hourColumn = new Column<EnergyOfferDTO, String>(new TextCell()) {

        @Override
        public String getValue(EnergyOfferDTO energyOffer) {
            String result = "";
            if (energyOffer.getId() != null) {
                final String isoDateTime = energyOffer.getId().getOperatingHour();
                if (isoDateTime != null && !isoDateTime.isEmpty()) {
                    final Date dateTime = CSTimeUtil.isoToDate(isoDateTime);
                    if (dateTime != null) {
                        result = CSTimeUtil.dateToHour(dateTime);
                    }
                }
            }
            return result;
        }

    };
    hourColumn.setSortable(true);
    sortHandler.setComparator(hourColumn, new Comparator<EnergyOfferDTO>() {
        @Override
        public int compare(EnergyOfferDTO eo1, EnergyOfferDTO eo2) {
            final String date1 = eo1.getId() != null ? eo1.getId().getOperatingHour() : "";
            final String date2 = eo2.getId() != null ? eo2.getId().getOperatingHour() : "";
            return date1.compareTo(date2);
        }
    });

    // We know that the data is sorted by hour by default.
    getGrid(). getColumnSortList().push(hourColumn);

    addColumn(hourColumn, UiMessages.INSTANCE.hour());
    setColumnWidth(hourColumn, 45, Unit.PX);
    setColumnHorizontalAlignment(hourColumn, HasHorizontalAlignment.ALIGN_RIGHT);
}

protected void addUseSlopeColumn(TableMetadata metadata, ListHandler<EnergyOfferDTO> sortHandler, DisplayMode currentDisplayMode) {
    final ReferenceData refData = metadata.allColumnMetadata().get(UiMessages.INSTANCE.use_slope());
    Column<EnergyOfferDTO, String> useSlopeColumn;
    Cell<String> cell;
    if (isInEditMode(currentDisplayMode)) {
        cell = new ReferenceDataBackedSelectionCell(refData);
    } else {
        cell = new TextCell();
    }
    useSlopeColumn = new Column<EnergyOfferDTO, String>(cell) {

        @Override
        public String getValue(EnergyOfferDTO energyOffer) {
            return refData.getDisplayValueForSubmitValue(Boolean.toString(energyOffer.isSlopeUsed()));
        }

    };

    useSlopeColumn.setSortable(true);
    sortHandler.setComparator(useSlopeColumn, new Comparator<EnergyOfferDTO>() {
        @Override
        public int compare(EnergyOfferDTO eo1, EnergyOfferDTO eo2) {
            final String slopeUsed1 = String.valueOf(eo1.isSlopeUsed());
            final String slopeUsed2 = String.valueOf(eo1.isSlopeUsed());
            return slopeUsed1.compareTo(slopeUsed2);
        }
    });

    addColumn(useSlopeColumn, UiMessages.INSTANCE.use_slope());
    setColumnWidth(useSlopeColumn, 75, Unit.PX);
    setColumnHorizontalAlignment(useSlopeColumn, HasHorizontalAlignment.ALIGN_RIGHT);
}

protected void addPriceMwColumn(final int colIndex, DisplayMode currentDisplayMode) {

    // Construct a composite cell for energy offers that includes a pair of text inputs
    final List<HasCell<EnergyOfferDTO, ?>> columns = new ArrayList<
            HasCell<EnergyOfferDTO, ?>>();

    // this DTO is passed along so that price and mw values for new entries are kept together
    final OfferPriceMwPair newOfferPriceMwPair = new OfferPriceMwPair();

    // Price
    final Column<EnergyOfferDTO, String> priceColumn = generatePriceColumn(colIndex, newOfferPriceMwPair, currentDisplayMode);
    columns.add(priceColumn);

    // MW
    final Column<EnergyOfferDTO, String> mwColumn = generateMwColumn(colIndex, newOfferPriceMwPair, currentDisplayMode);
    columns.add(mwColumn);

    // Composite
    final CompositeCell<EnergyOfferDTO> priceMwColumnInnards = generateCompositeCell(columns);

    final IdentityColumn<EnergyOfferDTO> priceMwColumn = new IdentityColumn<EnergyOfferDTO>(priceMwColumnInnards);

    final StringBuilder colHeader = new StringBuilder();
    colHeader.append(UiMessages.INSTANCE.price_mw_header()).append(" ").append(String.valueOf(colIndex + 1));

    addColumn(priceMwColumn, colHeader.toString());
    setColumnWidth(priceMwColumn, 7, Unit.EM);
    setColumnHorizontalAlignment(priceMwColumn, HasHorizontalAlignment.ALIGN_RIGHT);
}

protected Column<EnergyOfferDTO, String> generatePriceColumn(final int colIndex, final OfferPriceMwPair newOfferPriceMwPair, DisplayMode currentDisplayMode) {
    Column<EnergyOfferDTO, String> priceColumn;

    if (isInEditMode(currentDisplayMode)) {
        priceColumn = new BigDecimalValidatableColumn<EnergyOfferDTO, OfferPriceMwPair>(nextTabIndex(), getGrid()) {

            @Override
            public String getValue(EnergyOfferDTO energyOffer) {
                return obtainPriceValue(colIndex, energyOffer, false);
            }

            @Override
            public void doUpdate(int index, EnergyOfferDTO energyOffer, String value) {
                if (value != null && !value.isEmpty()) {
                    // number format exceptions should be caught and handled by event bus's handle method
                    final double valueAsDouble = NumberFormat.getDecimalFormat().parse(value);

                    final BigDecimal price = BigDecimal.valueOf(valueAsDouble);
                    final List<OfferPriceMwPair> offerPriceCurve = energyOffer.getCurve();
                    final OfferPriceMwPair offerPriceMwPair = offerPriceCurve.get(colIndex);
                    if (offerPriceMwPair == null) {  // we have a new price value
                        newOfferPriceMwPair.setPrice(price);
                        offerPriceCurve.add(newOfferPriceMwPair);
                    } else {
                        offerPriceMwPair.setPrice(price);
                    }

                }
            }

            @Override
            protected String getPropertyName() {
                return "price";
            }

            @Override
            protected Class<OfferPriceMwPair> getPropertyOwner() {
                return OfferPriceMwPair.class;
            }

        };
    } else {
        priceColumn = new Column<EnergyOfferDTO, String>(new TextCell()) {

            @Override
            public String getValue(EnergyOfferDTO energyOffer) {
                final String result = obtainPriceValue(colIndex, energyOffer, true);
                return result;
            }
        };
    }
    return priceColumn;
}

private String obtainPriceValue(final int colIndex, EnergyOfferDTO energyOffer, boolean withCurrency) {
    String result = "";
    if (energyOffer != null) {
        final List<OfferPriceMwPair> offerPriceCurve = energyOffer.getCurve();
        final int numberOfPairs = offerPriceCurve.size();
        if (colIndex < numberOfPairs) {
            final OfferPriceMwPair offerPriceMwPair = offerPriceCurve.get(colIndex);
            if (offerPriceMwPair != null) {
                final BigDecimal price = offerPriceMwPair.getPrice();
                if (price != null) {
                    final double value = price.doubleValue();
                    if (withCurrency) {
                        result = NumberFormat.getCurrencyFormat().format(value);
                    } else {
                        result = NumberFormat.getDecimalFormat().format(value);
                    }
                }

            }
        }
    }
    return result;
}

protected Column<EnergyOfferDTO, String> generateMwColumn(final int colIndex, final OfferPriceMwPair newOfferPriceMwPair, DisplayMode currentDisplayMode) {
    Column<EnergyOfferDTO, String> mwColumn;

    if (isInEditMode(currentDisplayMode)) {
        mwColumn = new BigDecimalValidatableColumn<EnergyOfferDTO, PriceMwPair>(nextTabIndex(), getGrid()) {

            @Override
            public String getValue(EnergyOfferDTO energyOffer) {
                return obtainMwValue(colIndex, energyOffer);
            }

            @Override
            public void doUpdate(int index, EnergyOfferDTO energyOffer, String value) {
                if (value != null && !value.isEmpty()) {
                    // number format exceptions should be caught and handled by event bus's handle method
                    final double valueAsDouble = NumberFormat.getDecimalFormat().parse(value);

                    final BigDecimal mw = BigDecimal.valueOf(valueAsDouble);
                    final List<OfferPriceMwPair> offerPriceCurve = energyOffer.getCurve();
                    final OfferPriceMwPair offerPriceMwPair = offerPriceCurve.get(colIndex);
                    if (offerPriceMwPair == null) {  // we have a new price value
                        newOfferPriceMwPair.setMw(mw);
                        offerPriceCurve.add(newOfferPriceMwPair);
                    } else {
                        offerPriceMwPair.setMw(mw);
                    }

                }
            }

            @Override
            protected String getPropertyName() {
                return "mw";
            }

            @Override
            protected Class<PriceMwPair> getPropertyOwner() {
                return PriceMwPair.class;
            }

        };
    } else {
        mwColumn = new Column<EnergyOfferDTO, String>(new TextCell()) {

            @Override
            public String getValue(EnergyOfferDTO energyOffer) {
                final String result = obtainMwValue(colIndex, energyOffer);
                return result;
            }
        };
    }
    return mwColumn;
}

private String obtainMwValue(final int colIndex, EnergyOfferDTO energyOffer) {
    String result = "";
    if (energyOffer != null) {
        final List<OfferPriceMwPair> offerPriceCurve = energyOffer.getCurve();
        final int numberOfPairs = offerPriceCurve.size();
        if (colIndex < numberOfPairs) {
            final PriceMwPair offerPriceMwPair = offerPriceCurve.get(colIndex);
            if (offerPriceMwPair != null) {
                final BigDecimal mw = offerPriceMwPair.getMw();
                if (mw != null) {
                    result = NumberFormat.getDecimalFormat().format(mw);
                }
            }
        }
    }
    return result;
}

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T20:51:26.473

所有这些定制工作都是不必要的 `WrapperCell`。`CompositeValidatableColumn`

事实证明，有一种方法你**不应该**构造`CompositeCell`s。请参阅[http://code.google.com/p/google-web-toolkit/issues/detail?id=5714](http://code.google.com/p/google-web-toolkit/issues/detail?id=5714)。我`CompositeCell`的 s 没有收到事件。所以，我改变了构建它们的方式`ToggleableGrid`。

```
protected CompositeCell<T> generateCompositeCell(final List<HasCell<T, String>> hasCells) {
    final CompositeCell<T> compositeCell = new CompositeCell<T>(hasCells) {

        // to not run afoul of http://code.google.com/p/google-web-toolkit/issues/detail?id=5714
        @Override
        public void render(Context context, T value, SafeHtmlBuilder sb) {
            sb.appendHtmlConstant("<div style=\"display: inline\">");
            super.render(context, value, sb);
            sb.appendHtmlConstant("</div>");
        }

        @Override
        protected Element getContainerElement(Element parent) {
            // Return the first element in the DIV.
            return parent.getFirstChildElement();
        }

    };

    return compositeCell;
} 
```

在那次更改并合并了我的其他面向验证的类之后：`ValidatableFieldUpdater`, `AbstractValidatableColumn`（和派生类）`ValidatableInputField`和`ConversionResult`，生活再美好不过了！

# python - 如何使用每个像素的 RGB 值构建图像

> ID：10825664
> 
> 赞同：2
> 
> 时间：2012-05-30T23:27:00.087
> 
> 标签：python, image, image-processing, python-imaging-library, rgb

我正在使用 Python 和 PIL 库，并且我拥有图像的每个像素及其位置的 RGB 信息。有什么方法可以从这些信息中构建图像？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T00:58:34.447

当然。如果您的源数据是稀疏的（即您没有每个像素位置的值），您可能需要执行以下操作：

*   创建所需尺寸的空图像
*   确保您的颜色数据以光栅顺序存储（即按 y 排序，然后按 x 排序）
*   遍历数据并将像素值存储在每个位置

因此，假设您有一个元组数组，例如`(x, y, (r,g,b))`，您可以执行以下操作：

```
from pil import Image

WIDTH=640
HEIGHT=480

img = Image.new(WIDTH, HEIGHT, 'RGB')

# Define this based on your data
my_raster_sort(my_image_data)

img_data = img.load()
for x, y, color in my_image_data:
    img_data[x,y] = color 
```

如果您的源图像数据是完整的（即每个位置都有一个颜色值），那么将数据转换为使用所需内存布局格式化的缓冲区可能会更快，然后使用[`Image.frombuffer`](http://pillow.readthedocs.org/en/latest/reference/Image.html#PIL.Image.frombuffer).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T23:33:13.407

是的。这就是`Image.putpixel()`（并且可能`putdata()`取决于您拥有数据的方式）的用途。[在此处](http://www.pythonware.com/library/pil/handbook/image.htm)查找这些方法的文档。

由于您没有提供代码，甚至没有提供数据样本，因此很难进一步建议您。

# c# - 网页中的内联 C# 代码不会产生编译错误

> ID：10825667
> 
> 赞同：1
> 
> 时间：2012-05-30T23:27:30.107
> 
> 标签：c#, asp.net, .net, visual-studio-2010, aspnet-compiler

我有一个 aspx 网页，后面没有代码，还有一些内联 C# 方法（webmethods），用于一个主要是静态的页面。

如果将以下代码行放在页面后面的代码中（该方法没有返回任何内容），则以下代码行将返回编译时错误

```
 <script runat="server">
    [WebMethod]
    public static string SomeMethod()
    {
       string result = "hello";
    }
    </script> 
```

是否有编译器选项可以打开网页中内联 C# 代码块的编译时检查？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T23:38:02.233

对于常规的 asp.net：

[http://mikehadlow.blogspot.co.uk/2008/05/compiling-aspx-templates-using.html](http://mikehadlow.blogspot.co.uk/2008/05/compiling-aspx-templates-using.html)

对于 asp.net mvc

[在 ASP.NET MVC 中编译视图](https://stackoverflow.com/questions/383192/compile-views-in-asp-net-mvc)

# matlab - 在Matlab中，自己的函数可以循环从GUI动态加载/显示图像到Axes中吗？

> ID：10825668
> 
> 赞同：1
> 
> 时间：2012-05-30T23:27:46.813
> 
> 标签：matlab, user-interface, axes, handles

使用指南，我制作了一个 Matlab Gui，它有 10 个轴，我想在其中显示图像，在我按下按钮后一次显示所有图像。

我制作了一个单独的**.m**文件，其中包含从 Button Callback 调用的**函数** `Load_Write_Img_Results(img_index)`，该函数具有以下代码：

```
for i = 1 : 10
    handles_imgOut = findobj('Tag', ['imgOut' num2str(i)]);
    set(handles_imgOut, 'HandleVisibility', 'ON');
    axes(handles_imgOut);
    image(imgs_data{img_index(i)});
    ...
end 
```

每次我运行主 Gui 并**第**一次按下按钮时，图像都会显示在所有轴上，所以一切**正常**。

* * *

当我**第二次****按下**按钮时出现**问题**，我收到此错误：

 ****```
 Error using axes  
    Invalid object handle 
```

在这条线上：

```
 axes(handles_imgOut); 
```

调试时，我看到在`handles_imgOut = findobj('Tag', ['imgOut' num2str(i)]);`is `handles_imgOut`not get any value and is **empty**之后，很明显那个错误。

第二次按下按钮时我有没有机会获得轴的手柄？

另外，我想知道如何从 Matlab 解决这个警告：

```
Calling AXES(h) in a loop can be slow. Consider moving the call to AXES outside the loop. 
```

**在此先感谢**，欢迎任何建议！

* * *

[**解决方案**]：

```
for i = 1 : 10
    handles_imgOut = findobj('Tag', ['imgOut' num2str(i)]);
    set(handles_imgOut, 'HandleVisibility', 'ON');
    axes(handles_imgOut);
    image(imgs_data{img_index(i)});

    set(gca, 'Tag', ['imgOut' num2str(i)]); //! renew the tag
    ...
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T06:39:33.273

我对 GUIDE 还很陌生，我也遇到过类似的问题，图表没有多次更新/找不到轴。最后，我使用了以下方法，希望对您也有用：

```
 % I get my axes directly from the handles object, instead of using findObj:
        graph1 = handles.axes1;
        graph2 = handles.axes2;
    % clear axes
        cla(graph1);
        cla(graph2);
    % showTrial is my function that draws the graphs - 
    %notice that I used handles to store other variables as well (.data, .trials)
    showTrial(handles.data, handles.trials(1), graph1, graph2) 
```

把它们加起来：

*   不要使用 findObj，从*句柄*中获取坐标轴（它应该自动将它们包含为 imgOut1、imgOut2 等）

*   将轴传递给绘图函数或直接传递*句柄*变量，例如 Load_Write_Img_Results(img_index, handles)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T06:42:01.583

它在第一次按下按钮时起作用，但此后不起作用的事实暗示

```
image(imgs_data{img_index(i)}); 
```

打开新轴而不是绘制到现有轴中。由于新轴未使用您的标签进行初始化，`findobj`因此不会找到它们。任何一个

(1) 确保通过`hold on`在创建后立即放置命令来保持原始轴，

或者

`image`(2) 在命令后立即更新标签

```
set(gca, 'Tag', ['imgOut' num2str(i)]); 
```****

# google-apps-script - 复制文档的一页并替换每页上的文本

> ID：10825675
> 
> 赞同：4
> 
> 时间：2012-05-30T23:29:53.867
> 
> 标签：google-apps-script

我正在尝试创建一个脚本，该脚本将采用 Google Doc 模板文档，制作副本，用电子表格上一行中的信息替换某些文本，附加另一页，用电子表格下一行中的信息替换文本，追加另一页等

这是我到目前为止所拥有的：

```
// Global variables 
var templateDocID = ScriptProperties.getProperty("backRxRequestDocID");
var sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
var activeSheetName = sheet.getName();
var user = Session.getUser().getEmail();

function requestGen3() {
  var physName = ["doc john", "doc evan", "doc jane"];
  var physAddr1 = ["fake st.", "faker st.", "fakest st."];
  var physAddr2 = ["ste 100", "", "ste 209"];
          var physCity = ["SLC", "Provo", "Orem"];
  var physState = ["UT", "AZ", "NV"];
  var physZip = ["84049", "84044", "84601"];
          var physPhone = ["8015555555", "7206666666", "4803333333"];
  var ptName = ["ed", "sue", "izzy"];
  var ptDOB = ["12/10/1979", "1/1/2001", "45/94/4561"];
  // Get document template, copy it as a new temp doc, and save the Doc’s id
  var docID = DocsList.getFileById(templateDocID).makeCopy().getId();
  var doc = DocumentApp.openById(docID);
  var body = doc.getActiveSection();
  var pars = doc.getParagraphs();
  var bodyCopy = body;
  for (var i = 0; i < physName.length; ++i) {
    // Replace place holder keys,  
    body.replaceText('%PHYS_NAME%', physName[i]);
    body.replaceText('%PHYS_ADDR1%', physAddr1[i]);
    body.replaceText('%PHYS_ADDR2%', physAddr2[i]);
    body.replaceText('%PHYS_CITY%', physCity[i]);
    body.replaceText('%PHYS_STATE%', physState[i]);
    body.replaceText('%PHYS_ZIP%', physZip[i]);
    body.replaceText('%PHYS_PHONE%', physPhone[i]);
    body.replaceText('%PT_NAME%', ptName[i]);
    body.replaceText('%PT_DOB%', ptDOB[i]);    
    doc.appendPageBreak();
    for (var j = 0; j < pars.length; ++j) {
      doc.appendParagraph(pars[j].copy());
    }
  }

  // Save and close the document
  doc.saveAndClose();
} 
```

我完成了从电子表格中阅读的教程，但我似乎无法制作`getRowsData()`和`getObjects()`正常工作。我上面的脚本正在正确创建文档，但没有将第二组信息插入第二页，第三组插入第三页，等等。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T00:37:01.707

您必须仅在复制段落后替换文本，因为如果您在之后执行此操作，占位符将已被替换，并且不会出现在下一个副本中。你可以这样做：

```
//...
var pars = doc.getParagraphs();
for( var i in pars ) //loop to keep a copy of the original paragraphs
  pars[i] = pars[i].copy();

for( var i = 0; i < physName.length; ++i ) {
  body.replaceText('%PHYS_NAME%', physName[i]);
  //do all your replaces...
  if( i != physName.length-1 ) { //has next?
    doc.appendPageBreak();
    for( var j in pars )
      doc.appendParagraph(pars[j].copy());
  }
}
doc.saveAndClose(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-05T00:23:30.023

以下代码将读取您的电子表格并创建一个名为 data 的矩阵。

```
var sh = SpreadsheetApp.getActive().getActiveSheet();
var lastRow = sh.getLastRow();
var lastCol = sh.getLastColumn();
var data = sh.getRange(1, 1, lastRow, lastCol).getValues(); 
```

# javascript - perl javascript/jquery - 从 javascript/jquery 传递到 perl 的变量

> ID：10825681
> 
> 赞同：1
> 
> 时间：2012-05-30T23:30:32.963
> 
> 标签：javascript, jquery, perl, mason

```
<input type="checkbox" id = "has_sidebar" name="cb" value="" onclick="result=$(this).attr('value', this.checked ? 1 : 0); alert('my result : 'result.context.value);" > 
```

`RESULT.CONTEXT.VALUE`具有复选框 (`0`或`1`) 的值。

如何在 perl 变量中分配它？
这是代码。

```
<%class>
use JSON;
use URI::Escape;

has 'data';
has 'cb'        => ( isa => 'Array');
</%class>

<%init>
my $args = eval {
        return from_json(uri_unescape($.data), { ascii => 1});
};
$m->redirect('/login') unless $USER && $USER->{'logged_in'};
$args->{'authors'} = [] unless $args->{'authors'} && ref($args->{'authors'}) eq 'ARRAY';
</%init>

<li class="header">
        <p>
                Authors
                &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;
                &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;
                show sidebar
        </p>
</li>
%  my @author_box = ();

% foreach my $a (sort { $a->{'last_name'} cmp $b->{'last_name'} || $a->{'first_name'} cmp $b->{'first_name'} } @{$args->{'authors'}}) {
<li>
        <p>
                <a href="javascript:void(0)" onclick="remove_author(<% $a->{'id'} %>);" class="right icon-small icon-delete-small"></a>
                <% $a->{'last_name'} %>, <% $a->{'first_name'} %> (<% $a->{'initials'} %>)

                &emsp;&emsp;&emsp;&emsp;
                &emsp;&emsp;&emsp;&emsp;
                <input type="checkbox" id = "has_sidebar" name="cb" value="" onclick="result=$(this).attr('value', this.checked ? 1 : 0); alert('id : <% $a->{'id'} %> - checked: ' + result.context.value);" >

        </p>
</li>

% # put the value of the checkbox in array
<script type="text/javascript">
<% $.cb %> = result.context.value  //this is not the RIGHT WAY!!!
var hsb = [];
hsb.push({ <% $a->{'id'} %>: <% $.cb %> });
</script>

% }
<li>
        <p>
                <input type="submit" value="Add" class="right" onclick="add_author();"/>
                <input id="new_author" style="width:75%;" />
                <input type="hidden" id="new_author_data" />
        </p>
</li> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T14:22:16.737

据我理解你的问题是正确的：

您不能将值从 javascript 直接传递给 perl，因为 perl 在服务器端执行（它构建 html+javascript），然后 javascript 运行客户端。您可以从 perl->javascript 传递值，反之亦然。

您需要表单提交或 AJAX 调用，然后在服务器端进行处理。

工作流程：

1.  服务器端处理（在您运行 perl 的情况下） - 构建页面
2.  交付给客户
3.  客户端的东西 - 运行 javascript
4.  通过表单或 AJAX 请求将结果返回给服务器
5.  处理结果（再次运行一些 perl）

编辑：

关于表单处理和 AJAX 的一切都在互联网和 Stackoverflow 上写了数百次。

您需要阅读：Formprocessing 和 AJAX。

我还建议您查看 jquery 文档，因为 jquery 有一个非常强大的 ajax-suite，它可以为您节省大量工作。

[使用 Perl 处理表单](http://affy.blogspot.de/p5be/ch20.htm)

[另一个使用 Perl 进行表单处理的初学者指南](http://www.yourhtmlsource.com/cgi/processingforms.html)

[jQuery Ajax 部分](http://api.jquery.com/category/ajax/)

[jQuery Ajax 调用](http://api.jquery.com/jQuery.ajax/)

或者只是谷歌并阅读你喜欢的 tut。

# c# - ListView 中项目的动态 Id 属性

> ID：10825683
> 
> 赞同：3
> 
> 时间：2012-05-30T23:30:50.437
> 
> 标签：c#, asp.net, webforms

我正在 ASP.NET Web 表单中开发一个简单的留言板，并在 ListView 控制器中列出所有帖子。我的代码看起来像这样：

```
<ItemTemplate>
   <article class="post">
       <div class="postinfo">
           <div class="postauthor">
               Author: <strong><%# Eval("Author") %></strong>
           </div>
           <div class="postdate">
               Date: <strong><%# Eval("PostDate", "{0:D}") %></strong>
           </div>
           <div class="postvotes">
               <asp:Button class="postupvote" id='up<%# Eval("Id") %>' runat="server" />
               <asp:Label ID="postvotescount_<%# Eval("Id") %>" class="postvotescount" runat="server" Text="<%# Eval("Votes") %> votes"></asp:Label>
               <asp:Button class="postdownvote" id='down<%# Eval("Id") %>' runat="server" />
           </div>
       </div>
       <div class="postcontent"><%# Eval("Text") %></div>
   </article>
</ItemTemplate> 
```

我的问题是投票功能。我想拥有 css id 属性，其中包含帖子的唯一数据库 id。这样我就会知道帖子的ID，它被投票给了。那么这可能吗？如果没有，我该如何实现呢？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T23:46:56.940

您可以使用 ClientIdMode 并将其设置为可预测

[http://msdn.microsoft.com/en-us/library/system.web.ui.clientidmode.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.clientidmode.aspx)

```
<asp:ListView ID="ListView1" 
              ClientIDMode="Predictable" 
              ClientIDRowSuffix="ProductID"  
              DataSourceID="XmlDataSource1" runat="server" >
<ItemTemplate>
</ItemTemplate>
</asp:ListView> 
```

这假设您使用的是 .Net 4.0 或更高版本。

# text - 将英语单词分块成对应不同声音的字素

> ID：10825685
> 
> 赞同：0
> 
> 时间：2012-05-30T23:31:03.070
> 
> 标签：text, nlp, character

如何将英文输入单词转换为字素组合？是否有一个库或函数可以完成这项工作？

我正在寻找的是一种算法/实现，它将正字法单词分成映射到音素的片段。也就是说，一个单词中的字母序列应该在不同的声音之间分解。

在我看来，这将类似于以下内容：

```
physically --> ph-y-s-i-c-a-ll-y
psychology --> ps-y-ch-o-l-o-g-y
thrush -->     th-r-u-sh
bought --> b-ough-t
chew --> ch-ew
palm --> p-al-m 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T02:42:41.940

谷歌搜索`split english words into graphemes`，第一个结果似乎是一篇关于使用机器学习方法将英语正字法映射到音素表示的论文。[这篇论文](http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.105.7616&rep=rep1&type=%E2%80%8C%E2%80%8Bpdf)似乎正在做你正在寻找的那种事情。

# python - Python - Paramiko 获取错误“对象没有属性”get_fingerprint“

> ID：10825687
> 
> 赞同：5
> 
> 时间：2012-05-30T23:31:20.030
> 
> 标签：python, ssh, paramiko, public-key

决定第一次尝试 Python，如果答案很明显，请见谅。

我正在尝试使用 paramiko 创建一个 ssh 连接。我正在使用以下代码：

```
#!/home/bin/python2.7

import paramiko
ssh = paramiko.SSHClient()
ssh.set_missing_host_key_policy(paramiko.AutoAddPolicy())

ssh.connect("somehost.com", username="myName", pkey="/home/myName/.ssh/id_rsa.pub")
stdin, stdout, stderr = ssh.exec_command("ls -l")

print stdout.readlines()
ssh.close() 
```

很标准的东西，对吧？除了我收到此错误：

```
 ./test.py
Traceback (most recent call last):
File "./test.py", line 10, in <module>
ssh.connect("somehost", username="myName", pkey="/home/myName/.ssh/id_rsa.pub")
File "/home/lib/python2.7/site-packages/paramiko/client.py", line 327, in connect
self._auth(username, password, pkey, key_filenames, allow_agent, look_for_keys)
File "/home/lib/python2.7/site-packages/paramiko/client.py", line 418, in _auth
self._log(DEBUG, 'Trying SSH key %s' % hexlify(pkey.get_fingerprint()))
AttributeError: 'str' object has no attribute 'get_fingerprint' 
```

它指的是什么“str”对象？我以为我只需要将路径传递给 RSA 密钥，但它似乎需要一些对象。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-05-30T23:42:56.867

`pkey`参数应该是实际的私钥**，**而不是包含密钥的文件的名称。请注意，pkey 应该是 PKey 对象而不是字符串（例如`private_key = paramiko.RSAKey.from_private_key_file (private_key_filename)`）。您可以使用参数代替 pkey`key_filename`直接传递文件名。

请参阅. [_](http://www.lag.net/paramiko/docs/paramiko.SSHClient-class.html#connect)`connect`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-12-26T06:53:56.360

如果你有你的私钥作为字符串，你可以在 python 3+

```
from io import StringIO
ssh = paramiko.SSHClient()  

private_key = StringIO("you-private-key-here")
pk = paramiko.RSAKey.from_private_key(private_key)

ssh.connect('somehost.com', username='myName', pkey= pk) 
```

如果您的私钥存储在环境变量中，则特别有用。

# optimization - 有条件地在循环中为 int 变量赋值（优化）

> ID：10825689
> 
> 赞同：0
> 
> 时间：2012-05-30T23:32:20.763
> 
> 标签：optimization, variable-assignment

假设我们有**bool**的二维数组，它们代表简单游戏的地图。如果单元格被某个游戏对象占用（否则为**false**） ，则数组的每个单元格都可以设置为**true 。**

 **我们想在循环中更新关于对象行为的地图。假设（由于某些原因）我们不能只更新地图的某些区域，我们必须迭代数组中的每个单元格，如果对象改变了它的位置，则否定它的值。

我们知道，在每个数组的更新中，只有很少的变化，但数组很大。现在问题来了。什么更优化。

(1) 这个：

```
for (int i = 0; i < Rows; i++)
    for (int j = 0; j < Cols; j++)
    {
        bool newValue = update(i,j);
        arr[i,j] = arr[i,j] != newValue ? newValue : arr[i,j];
    } 
```

(2) 这个：

```
for (int i = 0; i < Rows; i++)
    for (int j = 0; j < Cols; j++)
    {
        bool newValue = update(i,j);
        if(newValue != arr[i,j])
            arr[i,j] = newValue;
    } 
```

(3) 或者可能是这样的：

```
for (int i = 0; i < Rows; i++)
    for (int j = 0; j < Cols; j++)
    {
        arr[i,j] = update(i,j);
    } 
```

我认为（1）是最糟糕的解决方案。所以（2）对（3）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T23:38:03.597

否 3\. 没有理由像 #2 中那样编写代码。您可以删除 if 没有任何问题。**

# java - 将文件写入客户端的文件系统

> ID：10825696
> 
> 赞同：0
> 
> 时间：2012-05-30T23:33:17.560
> 
> 标签：java, servlets

我是 Java Servlet 的新手，但想将位于我的服务器上的文件写入客户端的文件系统。例如，如果客户端说要写入“C:\Users\Dan\Desktop”，我如何将文件写入该目的地？我有一个扩展 HttpServlet 的类——如果有人能指出我正确的方向，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T23:44:50.297

它的完成方式通常是向客户端返回一个数据流，该数据流将提示浏览器保存文件。但是，服务器无法指定将保存到哪个位置文件。

要做到这一点包括

```
Content-Type: application/octet-stream
Content-Disposition: filename=[your server recommended file name]; 
```

servlet 响应中的标头。请注意，用户仍然可以在大多数浏览器中覆盖您推荐的文件名，并且位置将由浏览器确定（默认用户下载目录或用户在提示时选择的任何内容）。

# c - 指向字符数组的第一个字符的指针？

> ID：10825699
> 
> 赞同：0
> 
> 时间：2012-05-30T23:33:59.167
> 
> 标签：c, pointers

编辑：显然我必须在 pigLatin 方法的开头声明 char *first 并稍后在该方法中将其初始化为 &word[counter] 。有人知道这是为什么吗？我正在使用 Visual Studio 2010。

我无法弄清楚为什么这会给我一个编译时错误。有问题的代码：

```
#include <stdio.h>
#include <string.h>
#include <conio.h>

char *pigLatin(char *word)
{
   if (word[0] == 'a' || word[0] == 'e' || word[0] == 'i'
           || word[0] == 'o' || word[0] == 'u')
   {
       char yay[] = "yay";
       strcat(word, yay);
       return word;
   }
   else
   {
       int length = strlen(word);
       int counter = 0;
       char addOn[] = "";
       char remainder[] = "";
       char yay[] = "yay";
       printf("%s", yay);

       char *first = &word[counter]; 
       printf("%c", *first); // error is here, don't know why it doesn't print
       return word;
   }
}

int main()
{
   char hello[] = "hello";
   pigLatin(hello);
   printf("%s", hello);
   getch();
   return (0);
} 
```

1>----- 构建开始：项目：Program_One，配置：发布 Win32 ------

1>programone.c

1>programone.c(12): 警告 C4996: 'strcat': 这个函数或变量可能不安全。考虑改用 strcat_s。要禁用弃用，请使用 _CRT_SECURE_NO_WARNINGS。详细信息请参见在线帮助。

1>programone.c(24): 错误 C2143: 语法错误: 缺少';' 在“类型”之前

1>programone.c(25): 错误 C2065: 'first' : 未声明的标识符

1>programone.c(25): 错误 C2100: 非法间接

========== 构建：0 成功，1 失败，0 最新，0 跳过 ==========

我不明白为什么指向数组“hello”的第一个字符的指针没有正确打印。

提前致谢 ！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T23:40:25.077

您没有将指针变量分配为指向第一个字符的地址。您将字符本身的值分配给指针变量，这就是编译器错误的原因。

您需要更改此行：

```
char *first = word[counter]; 
```

对此：

```
char *first = &word[counter]; 
```

或者，只需这样做：

```
char *pigLatin(char *word)   
{   
    int counter = 0;   
    printf("%c", word[counter]);
    return word;   
} 
```

**更新：**即使代码确实编译了，也是危险的。编译器警告`strcat()`是有效的。`"yay"`如果输入单词以元音开头，则您没有分配足够的内存来附加到输入单词。要真正使这段代码更安全，您应该使用`std::string`类而不是原始指针：

```
#include <conio.h> 
#include <string> 

std::string pigLatin(const std::string &word) 
{ 
    switch( word[0] )
    {
        case 'a':
        case 'e':
        case 'i':
        case 'o':
        case 'u': 
            return word + "yay"; 
    }

    int length = word.length(); 
    int counter = 0; 
    //...

    printf("%c", word[counter]);
    return word; 
} 

int main() 
{ 
   std::string word = pigLatin("hello");
   printf("%s", hello.c_str()); 
   getch(); 
   return 0; 
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-30T23:40:45.917

这一行在这里：

```
char *first = word[counter]; 
```

应该是这个：

```
char *first = &word[counter]; 
```

由于您指向的是指针指向的值，而不是内存地址本身，因此要获得实际值，您需要在调用数组之前使用 & 符号。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-30T23:39:25.530

您当前正在告诉编译器指向`first`值，`word[counter]`这意味着它指向内存中某个奇怪的地方。你想指向数组的第一个元素，所以你需要替换：

```
char *first = word[counter]; 
```

和：

```
char *first = &word[counter]; 
```

或者：

```
char *first = word; 
```

**编辑**- 您在评论中提到的编译器错误与源代码的第 23 和 24 行有关。您在上面发布的示例中少于 23 行。因此，错误必须出现在您未在此处发布的一些额外代码中...

**Edit2** - 通过一些小的调整，您的代码看起来对我有用：[http ://codepad.org/73BKMSgv](http://codepad.org/73BKMSgv)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-01-19T19:19:29.037

字符 str[] = "测试";
字符* p;
p = str;
printf(p[0]);

输出：
吨

# c# - EF 4.1 出错

> ID：10825701
> 
> 赞同：0
> 
> 时间：2012-05-30T23:34:17.603
> 
> 标签：c#, sql, entity-framework, dbcontext

有没有人在使用 EF 4.1 代码之前遇到过这个错误？

`GetService`在类型为 的商店提供程序实例上调用该方法后返回 null `StackExchange.Profiling.Data.EFProfiledOdbcProviderFactory`。商店提供程序可能无法正常运行。

我检查了我的连接字符串，它很好，并且相同的连接字符串在差异应用程序中工作正常。我的数据库也很好。奇怪的是它发生在我的机器上。

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T00:24:15.537

这是由于 EF 4.1 更新 1 中的错误造成的。它在 EF 4.2 及更高版本中已修复。请使用 NuGet 更新到最新版本。

# php - 使用会话传递 http_referer php

> ID：10825708
> 
> 赞同：0
> 
> 时间：2012-05-30T23:35:45.417
> 
> 标签：php, session, http-referer

这是考验：

在**index.php上**

```
<?php
    session_start();
    $url = $_SERVER['HTTP_REFERER'];
    $_SESSION['abc'] ='$url';
?> 
```

我在页面上回显`$_SERVER['HTTP_REFERER'];`，我得到了我想要的

稍后在现场我有一个预订页面，我使用会话

```
<?php 
    session_start();

    if (isset($_SESSION['abc'])) {
        echo $_SESSION['abc'];
    } 
    else {
        echo 'error';
    }               
?> 
```

它回显了错误，我很困惑为什么数据没有通过..

任何想法都来自 php 大师，谢谢。只想让它打印`HTTP_REFERER`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T00:31:01.887

查看评论，您似乎同时使用 HTTP*和*HTTPS。

您需要将会话 ID 从 HTTP 传递到 HTTPS。

**索引.php**

```
<?php
    session_start();

    $_SESSION['abc'] = $_SERVER['HTTP_REFERER'];

    $session_id = session_id();
?> 
```

然后，您需要`$session_id`通过 GET 传递到您的预订页面：

**预订.php**

```
<?php
    session_start();

    session_id($_GET['session_id']);

    if (isset($_SESSION['abc']))
        echo $_SESSION['abc'];
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T00:50:05.263

不幸的是，默认情况下，会话不会在 HTTP 和 HTTPS 之间持续存在。我不会重新讨论解决方案，而是指出问题出现在哪里：

*   [PHP会话HTTP到HTTPS问题](https://stackoverflow.com/questions/5921545/php-session-http-to-https-problem)
*   [在 PHP 中从 HTTP 切换到 HTTPS 时会话丢失](https://stackoverflow.com/questions/441496/session-lost-when-switching-from-http-to-https-in-php)

# delphi - 如何正确检索电池序列号？

> ID：10825711
> 
> 赞同：7
> 
> 时间：2012-05-30T23:37:34.790
> 
> 标签：delphi, winapi, deviceiocontrol

在 Delphi 7 中，我正在开发一个库，该库实现一个对象，该对象封装有关连接到系统的电池的信息。除了检索电池的序列号外，它运行良好。

我用于此调用的代码如下：

```
function TBattery.GetSerialNumber(hbat: THandle): boolean;
var
  bqi:          TBatteryQueryInformation;
  Serial:       PWideChar;
  SerialSize,
  dwOut:        DWORD;
begin
  Result := False;

  if hbat <> INVALID_HANDLE_VALUE then
  begin
    ZeroMemory(@bqi, SizeOf(bqi));
    dwOut := 0;

    bqi.BatteryTag := FBatteryTag;
    bqi.InformationLevel := BatterySerialNumber;

    SerialSize := 2048;
    GetMem(Serial, SerialSize);
    try
      ZeroMemory(Serial, SerialSize);

      Result := DeviceIoControl(hbat, IOCTL_BATTERY_QUERY_INFORMATION, @bqi,
                                SizeOf(bqi), Serial, SerialSize, @dwOut, nil);

      if Result then
        FSerialNumber := Serial;
    finally
      FreeMem(Serial, SerialSize);
    end;
  end;
end; 
```

不幸的是，`DeviceIoControl()`总是返回`False`，如果我`GetLastError()`事后检查，它会返回错误 87，“参数不正确”。

这没有多大意义，因为如果我简单地将`InformationLevel`from更改`BatterySerialNumber`为`BatteryUniqueID`，则代码运行良好。另外，我之前`hbat`在代码中的其他调用中使用了电池句柄（`GetSerialNumber`

有任何想法吗？我真的很茫然。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-31T02:01:36.850

该问题似乎与`dwOut`作为@dwOut 传递的变量有关，该变量表示定义为的 var`lpBytesReturned`参数[`DeviceIoControl`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa363216%28v=vs.85%29.aspx)

```
function DeviceIoControl(hDevice: THandle; dwIoControlCode: DWORD; lpInBuffer: Pointer;
  nInBufferSize: DWORD; lpOutBuffer: Pointer; nOutBufferSize: DWORD;
  var lpBytesReturned: DWORD; lpOverlapped: POverlapped): BOOL; stdcall; 
```

因此，将您的代码替换为

```
 Result := DeviceIoControl(hbat, IOCTL_BATTERY_QUERY_INFORMATION, @bqi,
                            SizeOf(bqi), Serial, SerialSize, dwOut, nil); 
```

必须解决问题。

# WinAPI

还要检查从这个 msdn 条目翻译为 delphi 的代码，[`Enumerating Battery Devices`](http://msdn.microsoft.com/en-us/library/windows/desktop/bb204769%28v=vs.85%29.aspx)它可以帮助您检测代码的任何其他问题。

```
uses
  SetupApi,
  Windows,
  SysUtils;

type

  BATTERY_QUERY_INFORMATION_LEVEL = (
    BatteryInformation,
    BatteryGranularityInformation,
    BatteryTemperature,
    BatteryEstimatedTime,
    BatteryDeviceName,
    BatteryManufactureDate,
    BatteryManufactureName,
    BatteryUniqueID,
    BatterySerialNumber);
  TBatteryQueryInformationLevel = BATTERY_QUERY_INFORMATION_LEVEL;

  _BATTERY_QUERY_INFORMATION = record
    BatteryTag: ULONG;
    InformationLevel: BATTERY_QUERY_INFORMATION_LEVEL;
    AtRate: Longint;
  end;
  BATTERY_QUERY_INFORMATION = _BATTERY_QUERY_INFORMATION;
  PBATTERY_QUERY_INFORMATION = ^BATTERY_QUERY_INFORMATION;
  TBatteryQueryInformation = BATTERY_QUERY_INFORMATION;

const
  GUID_DEVCLASS_BATTERY:TGUID='{72631E54-78A4-11D0-BCF7-00AA00B7B32A}';
  //DEFINE_GUID( GUID_DEVCLASS_BATTERY, 0x72631E54, 0x78A4, 0x11D0, 0xBC, 0xF7, 0x00, 0xAA, 0x00, 0xB7, 0xB3, 0x2A );
  METHOD_BUFFERED     = 0;
  FILE_DEVICE_BATTERY = $00000029;
  FILE_READ_ACCESS    = $0001;    // for files and pipes

  IOCTL_BATTERY_QUERY_TAG =
    (FILE_DEVICE_BATTERY shl 16) or (FILE_READ_ACCESS shl 14) or ($10 shl 2) or (METHOD_BUFFERED);
  IOCTL_BATTERY_QUERY_INFORMATION =
    (FILE_DEVICE_BATTERY shl 16) or (FILE_READ_ACCESS shl 14) or ($11 shl 2) or (METHOD_BUFFERED);

function GetBatteryInfo(InformationLevel : BATTERY_QUERY_INFORMATION_LEVEL) : string;
var
   cbRequired : DWORD;
   hdev     : HDEVINFO;
   idev     : Integer;
   did      : TSPDeviceInterfaceData;
   pdidd    : PSPDeviceInterfaceDetailData;
   hBattery : THandle;
   bqi      : TBatteryQueryInformation;
   dwWait, dwOut : DWORD;
   lpOutBuffer: PWideChar;
begin
  // enumerate the batteries
  hdev :=  SetupDiGetClassDevs(@GUID_DEVCLASS_BATTERY, nil, 0,  DIGCF_PRESENT OR DIGCF_DEVICEINTERFACE);
  if ( INVALID_HANDLE_VALUE <>  THandle(hdev) ) then
  begin
      idev:=0;//first battery
      ZeroMemory(@did, SizeOf(did));
      did.cbSize := SizeOf(did);
      if (SetupDiEnumDeviceInterfaces(hdev, nil, GUID_DEVCLASS_BATTERY, idev, did)) then
      begin
        try
          cbRequired := 0;
          SetupDiGetDeviceInterfaceDetail(hdev, @did, nil, 0, cbRequired, nil);
         if (ERROR_INSUFFICIENT_BUFFER= GetLastError()) then
         begin
            pdidd:=AllocMem(cbRequired);
            try
              pdidd.cbSize := SizeOf(TSPDeviceInterfaceDetailData);
              if (SetupDiGetDeviceInterfaceDetail(hdev, @did, pdidd, cbRequired, cbRequired, nil)) then
              begin
                 hBattery :=CreateFile(pdidd.DevicePath, GENERIC_READ OR GENERIC_WRITE, FILE_SHARE_READ OR FILE_SHARE_WRITE, nil, OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL, 0);
                 if (INVALID_HANDLE_VALUE <> hBattery) then
                 begin
                  try
                    ZeroMemory(@bqi, SizeOf(bqi));
                     // With the tag, you can query the battery info.
                    dwWait := 0;
                      if (DeviceIoControl(hBattery, IOCTL_BATTERY_QUERY_TAG,  @dwWait, sizeof(dwWait), @bqi.BatteryTag, sizeof(bqi.BatteryTag), dwOut, nil)) then
                      begin
                        lpOutBuffer:=AllocMem(MAX_PATH);
                        try
                          ZeroMemory(lpOutBuffer,MAX_PATH);
                          bqi.InformationLevel:=InformationLevel;
                          if DeviceIoControl(hBattery, IOCTL_BATTERY_QUERY_INFORMATION, @bqi, SizeOf(BATTERY_QUERY_INFORMATION), lpOutBuffer, 255, dwOut,nil) then
                            Result:= WideCharToString(lpOutBuffer);
                        finally
                          FreeMem(lpOutBuffer);
                        end;
                      end;
                  finally
                    CloseHandle(hBattery)
                  end;
                 end;
              end;
            finally
              FreeMem(pdidd);
            end;
         end;
        finally
          SetupDiDestroyDeviceInfoList(hdev);
        end;
      end;
  end;
end;

begin
  try
    if not LoadsetupAPI then exit;
     Writeln(GetBatteryInfo(BatterySerialNumber));
  except
    on E: Exception do
      Writeln(E.ClassName, ': ', E.Message);
  end;
  readln;
end. 
```

# WMI

最后作为旁注，您可以使用 WMI 检索相同的信息，在这种情况下使用`BatteryStaticData`WMI 类

```
 {$APPTYPE CONSOLE}

    uses
      SysUtils,
      ActiveX,
      ComObj,
      Variants;

    // Battery Static Data

    procedure  GetBatteryStaticDataInfo;
    const
      WbemUser            ='';
      WbemPassword        ='';
      WbemComputer        ='localhost';
      wbemFlagForwardOnly = $00000020;
    var
      FSWbemLocator : OLEVariant;
      FWMIService   : OLEVariant;
      FWbemObjectSet: OLEVariant;
      FWbemObject   : OLEVariant;
      oEnum         : IEnumvariant;
      iValue        : LongWord;
    begin;
      FSWbemLocator := CreateOleObject('WbemScripting.SWbemLocator');
      FWMIService   := FSWbemLocator.ConnectServer(WbemComputer, 'root\WMI', WbemUser, WbemPassword);
      FWbemObjectSet:= FWMIService.ExecQuery('SELECT SerialNumber FROM BatteryStaticData','WQL',wbemFlagForwardOnly);
      oEnum         := IUnknown(FWbemObjectSet._NewEnum) as IEnumVariant;
      while oEnum.Next(1, FWbemObject, iValue) = 0 do
      begin
        Writeln(Format('SerialNumber    %s',[String(FWbemObject.SerialNumber)]));// String

        Writeln('');
        FWbemObject:=Unassigned;
      end;
    end;

    begin
     try
        CoInitialize(nil);
        try
          GetBatteryStaticDataInfo;
        finally
          CoUninitialize;
        end;
     except
        on E:EOleException do
            Writeln(Format('EOleException %s %x', [E.Message,E.ErrorCode])); 
        on E:Exception do
            Writeln(E.Classname, ':', E.Message);
     end;
     Writeln('Press Enter to exit');
     Readln;      
    end. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T21:24:29.663

总之，@RRUZ 和我发布的代码在 Windows 7 以及其他第三方应用程序下都可以正常工作。它们不适用于在 Windows XP 下检索序列号。我还在 WinXP 和 7 下进行了测试，在完全相同的硬件上安装了操作系统，结果相同（在 Windows 7 下成功，而不是在 Windows XP 下）。

似乎在 WinXP 下不支持 's member 的值`BatterySerialNumber`，`IOCTL_BATTERY_QUERY_INFORMATION`但这`InformationLevel`没有直接记录在 Windows SDK 文档中。据记载，无效条目应返回错误 1 ​​( `ERROR_INVALID_FUNCTION`) for `GetLastError()`，但在这种情况下返回 87（对于无效参数）。我认为这是因为枚举中的值无效，所以它使参数无效，但我不确定。

感谢所有人的帮助，尤其是@RRUZ 的超越！

（顺便说一句，似乎可以从电池的唯一 ID（`BatteryUniqueID`作为`InformationLevel`成员使用）中提取序列号，并从唯一 ID 中删除制造商名称和设备名称。这是一个可怕的黑客攻击，但它是一种半可行的解决方法对于 Windows XP。）

# ruby - 未命名的 *(splat) 运算符作为方法签名中的参数

> ID：10825712
> 
> 赞同：1
> 
> 时间：2012-05-30T23:37:39.463
> 
> 标签：ruby

> **可能重复：**
> [裸星号作为方法定义中的参数：def f(*)](https://stackoverflow.com/questions/5249537/naked-asterisk-as-parameter-in-method-definition-def-f)

我使用了 splat 运算符来声明接受动态参数计数的方法，即：

```
def foo(*args)
  # do something
  pp args.join(",")
end 
```

我在 rails 代码中遇到了这个[方法声明][1]。

```
def save!(*)
  create_or_update || raise(RecordNotSaved)
end 
```

未命名的 splat 运算符如何工作？如何处理传递给方法的参数？

# ios - iPad2 需要多少像素着色器周期

> ID：10825715
> 
> 赞同：2
> 
> 时间：2012-05-30T23:38:13.543
> 
> 标签：ios, glsl, opengl-es-2.0, ipad-2

使用 PVRUniScoEditor 来分析我们的像素着色器，我发现我们的片段着色器对于大多数多边形以大约 20 个周期进入，而对于粒子着色器则进入 6-8 个周期。就获得不错的性能而言，这似乎是我们的黄油区，但我现在想知道我是否通过使这些着色器尽可能简单来掩盖其他问题。我会很高兴这些家伙有更多的功能。我们正在渲染一个具有大约 120k 多边形的场景，并且使顶点着色器更重对性能几乎没有影响。

所以我想我想知道对于一个非常频繁使用的片段着色器来说有多少是太多了，对于 30fps 来说有多少是太多的多边形。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T01:40:58.740

没有一个正确的答案。虽然 PVRUniScoEditor 是用于相对估计着色器性能的好工具，但您不能只说消耗 X 个估计周期的片段着色器将导致给定设备上的 Y 帧速率。

特定着色器的重量可能只是拼图中的一部分。它会在屏幕上覆盖多少个片段？您在片段处理方面是否存在性能瓶颈（OpenGL ES Driver 工具中的渲染器利用率接近 100%）？是否启用混合？所有这些因素都会影响渲染一帧所需的时间。

iOS 上基于 tile 的延迟渲染器还具有一些有趣的性能特征，其中调整特定片段着色器的循环计数不会导致渲染时间的线性变化，即使对于填充率受限的应用程序也是如此。[你可以在我的这个问题中](https://stackoverflow.com/questions/6051237/how-can-i-improve-the-performance-of-my-custom-opengl-es-2-0-depth-texture-gener)看到一个例子，我遇到了突然的性能变化，片段着色器略有变化。在那种情况下，调整着色器并不是主要的解决方案，防止混合不必要的片段才是主要的解决方案。

除了分析器报告的直接循环计数之外，还有纹理带宽的限制，以及我发现缓存未命中可能在这些着色器中产生的严重影响。

我想说的是，了解应用程序中着色器性能的唯一真正方法是运行它们并查看。有一些一般性的提示可以用来调整不够快的东西，但是变量太多，每个解决方案都是特定于应用程序的。

# java - 扫描外部主机的端口

> ID：10825717
> 
> 赞同：0
> 
> 时间：2012-05-30T23:38:19.723
> 
> 标签：java, network-programming, port-scanning

我在 Java 中编写一个端口扫描器作为一个教育练习，我遇到了一个问题。当我扫描本地计算机上的端口时，我的程序运行良好，但是当我尝试扫描外国计算机上的端口时，进程就会冻结。这是我的扫描方法的代码：

```
public void scan(InetAddress ad, int start, int end){
    for(int i=start; i<=end; i++){
        try{
            socket = new Socket(ad, i);
            System.out.println("Port "+i+"is open");
        }catch(Exception e){
            System.out.println("Port "+i+"is not open");
        }
    } 
} 
```

到目前为止，当主机名是我的环回地址或只是“localhost”时它可以工作，它甚至可以与我的 IP 地址一起工作。但是，例如当我解析 www.google.com 的 IP 甚至给它在同一网络上的另一台计算机的 IP 地址时，程序将在扫描第一个端口后冻结。

我正在解析这样的IP地址：

```
inetAddressObject = InetAddress.getByName(hostNameString); 
```

谁能告诉我我是否遗漏了在本地计算机上扫描端口和在外部主机上扫描端口之间的巨大差异？还是我的代码有一些简单的问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T23:51:15.430

您调用 Socket 构造函数的方式将立即建立连接。问题是，如果连接超时，那么您将不得不等待一段时间（操作系统默认）。你应该这样做的方式如下：

```
Socket s = new Socket();
s.connect(new InetSocketAddress(ad, i), timeout); 
```

另一个原因是它超时的原因。这是因为您的机器可能位于某种防火墙之后，并且与您的代码示例无关。

# jquery - 选择所有下一个表格行

> ID：10825729
> 
> 赞同：1
> 
> 时间：2012-05-30T23:40:07.587
> 
> 标签：jquery

我正在尝试选择所有具有“.client_detail_level2”类的下一个表行，以在单击表行时显示。我需要单击显示的行正下方的行，并且没有其他具有同一类的行。这就是我到目前为止所拥有的。

```
$('tr.expandable td').click(function(){
        $(this).parent().next('.client_detail_level2').slideToggle();
        $(this).toggleClass('collapsed');
 }); 
```

这当前显示了下一个最接近的行，但没有其他行。

谢谢你的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T23:46:11.810

使用`nextAll()`而不是`next()`

# c++ - 将矩阵应用于图像，寻求性能改进

> ID：10825730
> 
> 赞同：2
> 
> 时间：2012-05-30T23:40:08.430
> 
> 标签：c++, c, performance, image-processing, matrix-multiplication

**编辑：**在 Windows 平台上工作。

**问题：**更少的问题，更多的建议。我目前对低级程序并不十分精通，但我正在尝试优化下面的代码，以提高我的整体代码的性能。此应用程序依赖于极高速的图像处理。

**当前性能：**在我的计算机上，当前计算 512x512 图像的时间约为 4-6 毫秒。如果可能的话，我正试图将其减半。

**限制：**由于这个项目规模庞大，很难对应用程序进行根本性的更改，因此移植到 DirectX 或其他 GPU 方法之类的事情并不是一个很好的选择。该项目目前有效，我只是想弄清楚如何让它更快地工作。

**关于我对此用途的具体信息：**进入此方法的图像总是完全是正方形的，并且增量为 128。**（很可能是 512 x 512）**并且它们总是会出现相同的大小。除此之外，没有什么其他的了。矩阵是在其他地方计算的，所以这只是将矩阵应用于我的图像。原始图像和新图像都在使用，因此需要复制图像。

**这是我当前的实现：**

```
void ReprojectRectangle( double *mpProjMatrix, unsigned char *pDstScan0, unsigned char *pSrcScan0, 
        int NewBitmapDataStride, int SrcBitmapDataStride, int YOffset, double InversedAspect, int RectX, int RectY, int RectW, int RectH)
        {
            int      i, j;
            double   Xnorm, Ynorm;
            double  Ynorm_X_ProjMatrix4, Ynorm_X_ProjMatrix5, Ynorm_X_ProjMatrix7;;         
            double   SrcX, SrcY, T;
            int      SrcXnt, SrcYnt;
            int      SrcXec, SrcYec, SrcYnvDec;
            unsigned char   *pNewPtr, *pSrcPtr1, *pSrcPtr2, *pSrcPtr3, *pSrcPtr4;
            int      RectX2, RectY2;

            /* Compensate (or re-center) the Y-coordinate regarding the aspect ratio */
            RectY -= YOffset;   

            /* Compute the second point of the rectangle for the loops */
            RectX2 = RectX + RectW;
            RectY2 = RectY + RectH;

            /* Clamp values (be careful with aspect ratio */
            if (RectY < 0) RectY = 0;
            if (RectY2 < 0) RectY2 = 0;
            if ((double)RectY > (InversedAspect * 512.0)) RectY = (int)(InversedAspect * 512.0);
            if ((double)RectY2 > (InversedAspect * 512.0)) RectY2 = (int)(InversedAspect * 512.0);

            /* Iterate through each pixel of the scaled re-Proj */
            for (i=RectY; i<RectY2; i++)
            {      
            /* Normalize Y-coordinate and take the ratio into account */
            Ynorm = InversedAspect - (double)i / 512.0;

            /* Pre-compute some matrix coefficients */
            Ynorm_X_ProjMatrix4 = Ynorm * mpProjMatrix[4] + mpProjMatrix[12];
            Ynorm_X_ProjMatrix5 = Ynorm * mpProjMatrix[5] + mpProjMatrix[13];
            Ynorm_X_ProjMatrix7 = Ynorm * mpProjMatrix[7] + mpProjMatrix[15];

            for (j=RectX; j<RectX2; j++)
            {
                 /* Get a pointer to the pixel on (i,j) */
                 pNewPtr = pDstScan0 + ((i+YOffset) * NewBitmapDataStride) + j;

                 /* Normalize X-coordinates */
                 Xnorm = (double)j / 512.0;                  

                 /* Compute the corresponding coordinates in the source image, before Proj and normalize source coordinates*/
                 T =    (Xnorm * mpProjMatrix[3] + Ynorm_X_ProjMatrix7);
                 SrcY = (Xnorm * mpProjMatrix[0] + Ynorm_X_ProjMatrix4)/T;
                 SrcX = (Xnorm * mpProjMatrix[1] + Ynorm_X_ProjMatrix5)/T;

                // Compute the integer and decimal values of the coordinates in the sources image                     
                SrcXnt = (int) SrcX;
                SrcYnt = (int) SrcY;
                SrcXec = 64 - (int) ((SrcX - (double) SrcXnt) * 64);
                SrcYec = 64 - (int) ((SrcY - (double) SrcYnt) * 64);

                // Get the values of the four pixels up down right left
                pSrcPtr1 = pSrcScan0 + (SrcXnt * SrcBitmapDataStride) + SrcYnt;
                pSrcPtr2 = pSrcPtr1 + 1;
                pSrcPtr3 = pSrcScan0 + ((SrcXnt+1) * SrcBitmapDataStride) + SrcYnt;
                pSrcPtr4 = pSrcPtr3 + 1;

                SrcYnvDec = (64-SrcYec);

                (*pNewPtr) = (unsigned char)(((SrcYec * (*pSrcPtr1) + SrcYnvDec * (*pSrcPtr2)) * SrcXec + 
                                         (SrcYec * (*pSrcPtr3) + SrcYnvDec * (*pSrcPtr4)) * (64 - SrcXec)) >> 12);
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T23:57:13.563

有两件事可以提供帮助：多处理和 SIMD。使用多处理，您可以将输出图像分解为小块，并让每个处理器处理下一个可用的小块。您可以使用[SIMD](http://en.wikipedia.org/wiki/SIMD)指令（如 SSE、AVX、AltiVec 等）同时计算多个事物，例如同时对多个坐标进行相同的矩阵数学运算。您甚至可以将两者结合起来——使用运行 SIMD 指令的多个处理器来完成尽可能多的工作。您没有提及您正在使用的平台。

# javascript - jQuery UI 选项卡事件后的 jQuery/JavaScript 绑定操作

> ID：10825731
> 
> 赞同：1
> 
> 时间：2012-05-30T23:40:19.253
> 
> 标签：javascript, jquery, jquery-ui, datatables, jquery-events

刚刚开始了一项新工作，使用 zend 框架，该项目基本上完成了所有的补丁工作并添加到现有的。但是我最近遇到了一个问题。最初开发这个项目的人似乎只是把一切都固定在一切之上。所以它很混乱，它本身的一项主要任务就是找到一些东西以某种方式改变它的形状或其他形状。

我目前的问题是，该项目正在使用数据表和 jQuery UI。在这种特殊情况下，我正在使用基于“选项卡”的页面。我在每个选项卡下的第一页上有多个数据表。问题是数据表必须在最初隐藏在页面加载时的选项卡上重新绘制，因为表不符合它们所在的元素。

那么原来的开发者把它放在这个系统的什么地方呢？我找不到..他们在哪里可以`$(#element).tabs({})`以每页为基础动态添加到页面上。就像我说的那样，他们建造这个东西的方式相当混乱和明显复杂。因此，考虑到这一点，我找不到最初在页面加载之前调用的特定选项卡函数，因此我可以更改它以在加载时重绘表格。

所以我想知道的是，有没有办法捕获一个选项卡事件，当它显示选项卡内容时，我可以触发该事件而无需更改原始调用`tabs()`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T23:44:49.190

我认为您要绑定的事件是：

```
$( ".selector" ).bind( "tabsselect", function(event, ui) {
 ...
    // Objects available in the function context:
    ui.tab     // anchor element of the selected (clicked) tab
    ui.panel   // element, that contains the selected/clicked tab contents
    ui.index   // zero-based index of the selected (clicked) tab
}); 
```

来自[JQuery UI](http://jqueryui.com/demos/tabs/#event-select)

# jquery - 如何在公共函数中访问插件的用户定义选项？

> ID：10825732
> 
> 赞同：2
> 
> 时间：2012-05-30T23:40:22.690
> 
> 标签：jquery, jquery-plugins

我有一个插件，其中有一个公共函数（$fn.myplugin.mypublicfunct）。我的意图是让 mypublicfunct 从 myplugin 之外的单独 .ajaxSuccess 调用。因此需要一个公共功能。

场景：myplugin 做它的事情...通过 Ajax 提交的表单是不同的插件...当该插件执行其 .ajaxSuccess 时，我想调用 mypublicfunct 但能够使用来自 myplugin 的用户选项/默认值。

那有意义吗？我是否以正确的方式提出了正确的问题？

我试着把

var opts = $.extend({}, $.fn.myplug.defaults, 选项);

在公共函数中，并得到未定义（或类似）选项的错误。我在谷歌搜索风暴寻找示例、解决方案等，但我仍然很疯狂。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T01:04:42.150

首先，我会说我是 jQuery 插件开发的新手。此外，这是我自己一直在努力的事情，所以这是一个好问题我的 +1。

我倾向于将我的选项对象存储在所选元素的数据属性上（名称与插件名称隔开）：

```
var data = {
    options: options,
    otherData: otherData
};

$(this).data('myPlugin', data); 
```

然后可以在公共函数中访问该对象，如下所示：

```
var options = $(this).data('myPlugin').options; 
```

感觉有点笨拙，但它可以完成工作。

# python - easy_install 是否正确处理相关链接？它生成的绝对链接与浏览器和其他工具不同

> ID：10825734
> 
> 赞同：0
> 
> 时间：2012-05-30T23:40:27.770
> 
> 标签：python, html, hyperlink, easy-install

所以我正在尝试`Aptus`安装`easy_install-2.5`

```
sente@oslo:~$ easy_install-2.5 --install-dir=code/lib/ aptus
Searching for aptus
Reading http://pypi.python.org/simple/aptus/
Reading http://nedbatchelder.com/code/aptus
Best match: Aptus 2.0
Downloading http://nedbatchelder.com/code/aptus/code/aptus/Aptus-2.0.tar.gz
error: Can't download http://nedbatchelder.com/code/aptus/code/aptus/Aptus-2.0.tar.gz: 404 Not Found 
```

[http://nedbatchelder.com/code/aptus](http://nedbatchelder.com/code/aptus)上的 HTML有：

`<a href="code/aptus/Aptus-2.0.tar.gz">Aptus-2.0.tar.gz</a>`

我最后知道的应该指向 `http://nedbatchelder.com/code/aptus/code/aptus/Aptus-2.0.tar.gz`...正确安装easy_install。

所有其他浏览器和命令行实用程序都将该链接转换为`http://nedbatchelder.com/code/aptus/Aptus-2.0.tar.gz`。

我很好奇为什么 easy_install 的行为与浏览器和命令行工具不同。

我知道 pip 比easy_intsall-2.5 更受欢迎，但它不在这个旧系统上，此时我对easy_install 更好奇。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T23:46:09.553

通常，您应该如何解释该 URL 是正确的。

但是，该页面有一个[`base`](https://developer.mozilla.org/en/HTML/Element/base)标签，它改变了用于将相对 URL 转换为绝对 URL 的基础：

```
<base href='http://nedbatchelder.com'> 
```

我假设 easy_install 只是不寻找`base`标签。

# arrays - MongoDB - 获取具有保存在另一个集合的文档中的列表中的属性的所有文档

> ID：10825740
> 
> 赞同：-1
> 
> 时间：2012-05-30T23:41:48.163
> 
> 标签：arrays, mongodb

我在一个集合中有文档，这些文档具有一组属性（1-400 个不同的数值）。

现在我想获取具有这些属性之一的另一个集合的所有文档（这些文档只有一个属性）。

我怎么能做到这一点，最好是一次通话？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T06:21:51.920

由于 MongoDB 不是关系 DBMS，因此仅通过一次调用是不可能实现的。
您需要做的是首先检索要用于搜索的文档。检索到它后，您将使用存储在文档中的该数组`$in`对其他集合的字段进行查询。所以对于 mongo shell，这可能是这样的：

```
var ar = db.coll1.findOne().numArray
db.coll2.find({b: { $in : ar }}) 
```

# c++ - C++ 布尔求值

> ID：10825743
> 
> 赞同：23
> 
> 时间：2012-05-30T23:42:35.307
> 
> 标签：c++, boolean, type-conversion, iostream

所以我很好奇为什么会发生这种情况。

```
int main()
{
   bool answer = true;
   while(answer)
   {
      cout << "\nInput?\n";
      cin >> answer;
   }
return 0;
} 
```

预期行为：0 - 退出程序，1 - 再次提示，除 1 之外的任何非零整数 - 再次提示

实际行为：0 - 符合预期，1 - 符合预期，除 1 之外的任何非零整数 - 无限循环

来自[http://www.learncpp.com/cpp-tutorial/26-boolean-values/](http://www.learncpp.com/cpp-tutorial/26-boolean-values/)

```
One additional note: when converting integers to booleans, 
the integer zero resolves to boolean false, 
whereas non-zero integers all resolve to true. 
```

为什么程序会进入无限循环？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-05-31T00:04:58.523

实际上，`operator>>`用于读取 a 的重载`bool`只允许`0`or`1`作为有效输入。运算符重载`num_get`遵循类模板，该模板从输入流中读取下一个数字，然后行为如下（C++11 §22.4.2.1/6）：

> *   如果要存储的值是`0`，则`false`存储。
>     
>     
> *   如果值是`1`则`true`存储。
>     
>     
> *   否则`true`存储并`ios_base::failbit`分配给`err`。

（`err`这里是您正在读取的流的错误状态；`cin`在这种情况下。请注意，还有其他语言指定了`boolalpha`使用操纵器时的行为，它允许使用它们的名称插入和提取布尔值，`true`并且`false`；我有为简洁起见，省略了这些其他细节。）

当您输入零或一以外的值时，会在流上设置失败状态，这会导致进一步的提取失败。 `answer`设置为`true`并`true`永远保持，导致无限循环。

您必须在每次提取后测试流的状态，以查看提取是否成功以及流是否仍处于良好状态。例如，您可以将循环重写为：

```
bool answer = true;
while (std::cin && answer)
{
    std::cout << "\nInput?\n";
    std::cin >> answer;
} 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-05-30T23:46:56.037

因为`operator>>`如果输入不是 0 或 1 就失败，失败时不消耗输入。所以循环包括读取数字然后重复读取它。

尝试像这样更改代码以查看它：

```
if (cin >> answer) {
  cout << answer << endl;
} else {
  cerr << "oops" << endl;
  break;
} 
```

# java - 创建从一个类扩展的对象以放入数组列表

> ID：10825747
> 
> 赞同：0
> 
> 时间：2012-05-30T23:42:55.980
> 
> 标签：java

我正在尝试编写一个工资单程序，它只接收输入，进行一些计算并显示每个员工的输出。

我有两种类型的员工，小时工和薪水。我为每种类型创建了一个类，该类扩展为一个抽象员工类：

```
public abstract class Employee{
  private String name;
  private String type;
  private  int hours;
  private double rate;
}

public class SalaryEmployee extends Employee{

  public SalaryEmployee(String type, String name, int hours, double rate){
   this.type = type;
    this.name = name;
    this.hours = hours;
    this.rate = rate;
  }

  public void print(){

  }
} 
```

在我的主要方法中，当我尝试使用以下代码创建对象时：

```
 Employee employee;
  if(type.equals("hourly"))
  {
    employee = new HourlyEmployee(type, name, hours, rate);
  }
  else
  {
    employee = new SalaryEmployee(type, name, hours, rate);
  } 
```

尝试编译时出现以下错误：

```
Lab3.java:53: not a statement
        SalaryEmployee employee = new SalaryEmployee(type, name, hours, rate);
         ^
Lab3.java:53: ';' expected
        SalaryEmployee employee = new SalaryEmployee(type, name, hours, rate);
                      ^
2 errors 
```

知道这里发生了什么吗？我四处寻找弄乱的分号或大括号，但还没有找到任何东西。

感谢您的关注。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T00:34:48.183

我能看到的唯一错误是您的`SalaryEmployee`类无法访问基类变量，因为它们是`private`. 你应该制作它们`protected`。

虽然，你得到的错误会有所不同。如果你在改变后仍然得到错误，你的错误可能在别处。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-30T23:50:37.757

在不使用大括号的 if 中声明变量是非法的。看起来你打算写的是这样的：

```
Employee employee;
if(type.equals("hourly"))
  employee = new HourlyEmployee(type, name, hours, rate);
else
  employee = new SalaryEmployee(type, name, hours, rate); 
```

大多数编码约定都支持在 if 或 else 之后始终使用大括号。

# ios - 容器视图控制器与 childViewControllers 的通信

> ID：10825753
> 
> 赞同：0
> 
> 时间：2012-05-30T23:44:04.887
> 
> 标签：ios, cocoa-touch, uiviewcontroller, delegates

我有一个带有 3 个子 UIViewController 子类的容器视图控制器（添加了 addChildViewController）。我希望我的一个子视图控制器在将某些东西从我的容器视图控制器放到它上面时做某事。我很难理解这种交流应该如何发生。如果我尝试创建一个委托，我会在我的子视图控制器中收到错误，因为我将两个子类相互导入。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-31T01:28:37.270

听起来你在*编译*你的应用程序时遇到了问题，因为相互之间有相互的 .h 文件`importing`，对吧？

> **编辑：**再次阅读您的问题后，我不是 100% 清楚哪个视图控制器需要调用另一个视图控制器。如果我在解决方案中混淆了父视图控制器和子视图控制器的角色，只需切换它们。下面的技术让您可以在任意两个视图控制器（父子、兄弟和兄弟等）之间进行通信。

有很多方法可以处理这个问题。如果您想保留一种`delegate`模式，您可以简单地重写标题以避免`#import`在 .h 文件之一中出现：

父视图控制器.h：

```
#import "ChildViewController.h"

@interface ParentViewController: UIViewController {
@private
   ChildViewController* childVc;
}

- (void) doSomething; 
```

ChildViewController.h

```
@class ParentViewController;   // NOT #import!

@interface ChildViewController: UIViewController {
@private
   ParentViewController* parentVc;
} 
```

ChildViewController.m

```
#import "ParentViewController.h" 
```

这应该避免使您的应用程序无法编译的循环依赖。

现在，尽管上述方法有效，但为了清洁起见，我可能会选择另一种解决方案。使用`protocol`. 父级可以实现协议，然后子级只需要一个实现协议的委托：

```
#import "MyProtocol.h"

@interface ParentViewController: UIViewController<MyProtocol> {

}

- (void) doSomething; 
```

在 MyProtocol.h 中：

```
@protocol MyProtocol
 - (void) doSomething;
@end 
```

然后在 ChildViewController.h

```
#import "MyProtocol.h"

@interface ChildViewController: UIViewController {
@private
   id<MyProtocol> delegate;
}

@property (nonatomic, assign) id<MyProtocol> delegate; 
```

在 ChildViewController.m 中：

```
 [delegate doSomething]; 
```

或者，您可以完全避免使用委托，并[使用 控制器在控制器之间进行通信`NSNotificationCenter`](http://agilewarrior.wordpress.com/2012/02/09/dead-simple-nsnotification-example-iphone/)，这将它们解耦，并避免编译器循环（双向依赖）。

[这是 NSNotificationCenter 上的 Apple 文档](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSNotificationCenter_Class/Reference/Reference.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-30T23:53:30.540

你就不能去吗：

```
MyChildViewController *myChildViewController = (MyChildViewController *)[self.childViewControllers objectAtIndex:0];
[myChildViewController doWhatever]; 
```

? 这应该让您在数组 childViewControllers 的第一个索引处向子视图控制器发送消息（这是 UIViewController 上的一个属性）。

# hadoop - 使用 Hadoop 处理来自多个数据源的数据

> ID：10825754
> 
> 赞同：1
> 
> 时间：2012-05-30T23:44:08.333
> 
> 标签：hadoop, hbase, apache-pig

mapreduce 和任何其他 hadoop 技术（HBase、Hive、pig 等）是否非常适合您有多个输入文件以及需要在不同数据源之间比较数据的情况。

过去，我使用 Hadoop 和 Pig 编写了一些 mapreduce 作业。然而，这些任务非常简单，因为它们只涉及处理单个数据集。我们现在的要求要求我们从多个来源读取数据，并对另一个数据源上的各种数据元素进行比较。然后我们报告差异。我们正在使用的数据集在 1000 万到 6000 万条记录范围内，到目前为止，我们还没有足够快地完成这些工作。

是否有使用 mapreduce 来解决此类问题的案例，或者我是否走错了路。

任何建议都非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T09:43:47.150

是的，您可以在一个 mapreduce 作业中加入多个数据集。我建议获取书籍/电子书 Hadoop In Action 的副本，该书解决了来自多个来源的数据连接问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T06:57:28.223

当您有多个输入文件时，您可以使用 MapReduce API FileInputFormat.addInputPaths() ，其中可以采用逗号分隔的多个文件列表，如下所示：

```
FileInputFormat.addInputPaths("dir1/file1,dir2/file2,dir3/file3"); 
```

您还可以使用分布式缓存将多个输入传递到 hadoop 中的 Mapper，此处描述了更多信息： [multiple input into a Mapper in hadoop](https://stackoverflow.com/questions/9148724/multiple-input-into-a-mapper-in-hadoop)

如果我没有误解，您正在尝试规范化记录中的结构化数据，来自多个输入然后处理它。基于此，我认为您确实需要查看过去对我有帮助的这篇文章。它包括**[如何使用 Hadoop/MapReduce 规范化数据](http://blog.data-miners.com/2010/01/hadoop-and-mapreduce-normalizing-data.html)**，如下所示：

*   步骤 1：从原始数据中提取列值对。
*   步骤 2：提取不在主 ID 文件中的列值对
*   步骤 3：计算主文件中每列的最大 ID
*   第 4 步：计算不匹配值的新 ID
*   第 5 步：将新 ID 与现有主 ID 合并
*   第 6 步：将原始数据中的值替换为 ID

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T09:28:38.623

我想我会将不同的数据集预处理为一种通用格式（确保包含一个“数据源”id 列，其中每一行来自同一数据集的单个唯一值）。然后将文件移动到同一目录中，加载整个目录并将其视为单个数据源，您可以在其中根据数据集 id 比较行的属性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-12-02T13:58:27.460

使用 MultipleInputs 我们可以做到这一点。

```
MutlipleInputs.addInputPath(job, Mapper1.class, TextInputFormat.class,path1);
MutlipleInputs.addInputPath(job, Mapper2.class, TextInputFormat.class,path2);
job.setReducerClass(Reducer1.class);
//FileOutputFormat.setOutputPath(); set output path here 
```

如果两个类有一个共同的键，那么它们可以加入reducer并做必要的逻辑

# ruby-on-rails - Rails STI 更改类型

> ID：10825755
> 
> 赞同：2
> 
> 时间：2012-05-30T23:44:18.740
> 
> 标签：ruby-on-rails, polymorphic-associations, sti

我目前正在从事一个项目，我正在使用 STI 模型并希望将一个记录转换为另一种类型而不创建新记录。有些观察者会在创建新模型时触发，但是我不希望这些观察者触发并希望保持相同的 ID。有没有一种简单的方法可以通过 ORM 将记录从一个模型转换为另一个模型？，而不使用 SQL？

干杯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T22:52:41.133

[`#becomes`](http://api.rubyonrails.org/classes/ActiveRecord/Persistence.html#method-i-becomes)可以做你想做的事：

```
class Foo < ActiveRecord::Base
end

class Bar < Foo
end

class Baz < Foo
end

baz = Baz.create({})
bar = baz.becomes(Bar) 
```

那时，您仍然会在表中保留`baz`记录。`foos`您必须确保保存`bar`不会导致问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-29T02:16:19.330

`becomes!`对我不起作用，详见[https://stackoverflow.com/a/26091638/1935918](https://stackoverflow.com/a/26091638/1935918)。相反，我建议使用`update_column`：

```
 def update
    @company = Company.find(params[:id])
    # This separate step is required to change Single Table Inheritance types
    new_type = params[:company][:type]
    if new_type != @company.type && Company::COMPANY_TYPES.include?(new_type)
      @company.update_column :type, new_type
    end

    @company.update(company_params)
    respond_with(@company)
  end 
```

# database - 如何在 Oracle 中获取模式并将其放在另一台计算机上？

> ID：10825756
> 
> 赞同：0
> 
> 时间：2012-05-30T23:44:30.967
> 
> 标签：database, oracle

我已经在我的桌面上处理我的 Java-Database 项目好几天了，现在是时候将它们放在我的笔记本电脑上，java 项目不会有问题，但是我的模式呢？我的数据库？我不想把它全部输入一遍，有没有办法把它从 Oracle 中取出来？然后把它放回oracle以及我的笔记本电脑上？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T23:54:00.260

见 [这里](http://docs.oracle.com/cd/B25329_01/doc/admin.102/b25107/impexp.htm#CHDDBGDF%27)。Oracle 有这两个工具，称为 exp 和 imp，用于导出数据库和导入数据库。它将有助于将数据库从您的桌面传输到您的笔记本电脑。

编辑：更多[信息](http://www.orafaq.com/wiki/Import_Export_FAQ#How_does_one_use_the_import.2Fexport_utilities.3F)

# css - 即 10 css 3d 变换的行为不同

> ID：10825758
> 
> 赞同：2
> 
> 时间：2012-05-30T23:44:41.127
> 
> 标签：css, transform, internet-explorer-10

我试图在 IE10 预览中实现“translateZ”转换功能，但遇到了一个问题。

所以它只有在转换节点的“直接”父节点具有“-ms-perspective”属性时才能正常工作，如果父节点的父节点设置了“-ms-perspective”属性，则它不起作用。

任何人都可以建议这是否是一个错误以及是否有解决方法。例如，如果在以下代码中我将“-ms-perspective”应用于“div1”并在 div3 上尝试 rotateZ，则它不起作用。

```
<div class="div1">
    <div class="div2">
        Parent
        <div class="div3">
            Child
        </div>
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-04T18:02:52.993

它在 Internet Explorer 10.0.8400.0 中对我来说似乎工作得很好：

```
<div class="div1">
    <div class="div2">
        Parent
        <div  class="div3">
            Child Rotated
        </div>
    </div>
</div> 
```

连同以下 CSS：

```
.div1 {
    margin: 25px 100px;
    background: #f1f1f1;
    -ms-perspective: 500px;
}

.div3 {
    width: 100px;
    height: 100px;
    background: orange;
    -ms-transform: rotateZ(30deg);
} 
```

产生以下效果：

![在此处输入图像描述](../Images/24125c90e3fa69af693132fca3733010.png)

小提琴：http: [//jsfiddle.net/jonathansampson/NKZw6/](http://jsfiddle.net/jonathansampson/NKZw6/)

# php - Facebook PHP SDK 和 Wordpress 错误

> ID：10825763
> 
> 赞同：1
> 
> 时间：2012-05-30T22:10:46.690
> 
> 标签：php, facebook, wordpress, session, sdk

我有一个带有 WAMP、Wordpress 和 PHPEdit IDE 的开发人员环境设置。我在侧边栏中使用 Facebook、Twitter 和 YouTube API。我正在使用 Facebook 的 PHP SDK 来显示信息（没有登录或管理功能）。由于 FB SDK 和 WP 使用 session_start() 我收到以下警告：

> 警告：session_start() [function.session-start]：无法发送会话缓存限制器 - 标头已发送（输出开始于 C:\wamp\www\dfi\wp-content\themes\DFI\header.php:12） C:\wamp\www\dfi\wp-content\themes\DFI\api\facebook.php 在第 36 行

我试图通过使用警告输出来解决这个问题，但它无助于考虑以下内容。`<?php ?>`我知道在任何 http 输出之前和之后清除空格和字符并将 session_start() 放置在之前。我使用没有 BOM 的 unix line enders 和 UTF8 编码。我的主机服务器没有为 output_buffering 设置。

header.php 第 11 到 13 行

```
11 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
12 <html xmlns="http://www.w3.org/1999/xhtml" <?php language_attributes();?>>
13 <head> 
```

看起来警告来自内联 php 代码。我不知道我能做些什么来修复这条线。

facebook.php 第 34 至 37 行

```
34    public function __construct($config) {
35    if (!session_id()) {
36      session_start();
37    } 
```

我认为我不能阻止 FB 或 WP 调用 session_start() 而不会破坏一切。如何让 Wordpress 和 Facebook 完美配合而不会出现此错误？

编辑：为了停止显示警告，我将@放在 session_start() 前面。

```
public function __construct($config) {
    if (!session_id()) {
      @session_start();
    } 
```

它只是一种解决方法，我仍然想找到问题的根源。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-02T01:25:05.603

正如您在评论中发现的那样，问题不在于包含 PHP 文件，而在于您定义类的位置。`wp`在钩子中可以安全地创建 Facebook 类的实例（据我所知，它对我有用） 。这将允许您在任何 HTML 输出之前定义类的实例，然后您可以在类中的任何位置使用该变量。

但是，您确实希望确保只包含一次该类，但您可以根据需要多次实例化该类。

这是一个让您入门的基本示例：

```
if( !class_exists( 'Facebook' ) ) {
    require_once 'facebook.php';
}

if( !class_exists( 'YourClass' ) ) {

    class YourClass {

        public $facebook = null;

        public function __construct() {

            add_action( 'wp', array( $this, 'define_facebook' ) );
            add_action( 'any_hook_after_wp', array( $this, 'example_usage' ) );

        }

        public function define_facebook() {
            global $post;

            // Assuming you are using post meta for the app ID and secret, you can use other methods though
            $app_id = get_post_meta( $post->ID, 'appId', true );
            $app_secret = get_post_meta( $post->ID, 'appSecret', true );

            $this->facebook = new Facebook( array( 'appId' => $app_id, 'secret' => $app_secret ) );

        }

        public function example_usage() {

            if( !is_null( $this->facebook ) ) {

                // Lets see what we have here..
                echo "<pre>";
                print_r( $this->facebook );
                echo "</pre>";
                exit;

            }

        }

    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-16T06:31:49.513

您可以使用 Hook Action init 来检查 session_id 是否存在。

```
 // add it into functions.php in theme folder
add_action('init', 'themename_wp_session_start');
function themename_wp_session_start(){
    if( !session_id() ){
        session_start();
    }
} 

```

# wordpress - 可湿性粉剂；寻找一种将内容动态添加到灯箱的方法

> ID：10825765
> 
> 赞同：2
> 
> 时间：2012-05-30T23:45:49.143
> 
> 标签：wordpress, lightbox

我不确定我需要什么样的脚本，希望这里有人知道。

在我正在构建的由 wordpress 驱动的博客的主页/存档页面上，我只有一个缩略图网格（特色图像）。而不是这些链接到实际的帖子/页面，我希望它们触发具有帖子/页面描述的灯箱类型的元素。

从那里，用户将能够继续（通过阅读更多）帖子或关闭它并继续搜索网格。

非常感谢任何见解！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T01:48:22.123

纯 CSS 解决方案：

```
<body>
<div id="featured-grid">
<?php
if(have_posts()) : while(have_posts()) : the_post();
$default = '<img src="'.get_bloginfo('stylesheet_directory').'/images/default_thumb.jpg">';
$thumb = has_post_thumbnail() ? get_the_post_thumbnail() : $default;
?>
<div class="post-block">
    <div class="post-thumb">
        <a class="hover-trigger" href="#"><?php echo $thumb; ?></a>
    </div>
    <div class="post-preview lightbox">
        <div class="preview-wrap">
            <a class="featured-image" href="<?php the_permalink(); ?>"><?php echo $thumb; ?></a>
            <?php the_excerpt(); ?>
        </div>
    </div>
</div>
<?php
endwhile;endif;
?>
</div>
</body>
<style type="text/css">
.post-block{width:300px;height:300px;}
.post-thumb{width:100%;height:100%;margin:10px;float:left;}
.post-thumb *{display:block;width:100%;height:100%;}
.lightbox{
    display:none;
    width:100%;
    height:100%;
    background:rgba(0,0,0,0.4);
    position:fixed;
    top:0;
    left:0;
}
.preview-wrap{width:960px;margin:0 auto;position:relative;top:40px;background:#FFF;}
.post-block:hover .lightbox{display:block;}
.post-block:hover .post-thumb{display:none;}
</style> 
```

这是非常初级的，并且在很大程度上未经测试。总体而言，这应该让您朝着正确的方向开始。希望这可以帮助！

# joomla - 在 Joomla 中访问管理员帐户

> ID：10825769
> 
> 赞同：0
> 
> 时间：2012-05-30T23:46:36.567
> 
> 标签：joomla

如果我没有管理员帐户的密码，有什么方法可以访问在 Joomla 中构建的网站的管理员帐户。我确实拥有服务器上的所有权限。请让我知道您的建议和意见。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T23:52:57.303

密码存储在 MySQL 数据库 jos_users 表密码字段中。（如果不同，请将其更改为您的表前缀）

使用 MySQL 实用程序（例如 phpMyAdmin 或 MySQL 查询浏览器）来编辑此字段。打开表格，找到您的管理员用户名，然后选择该行进行编辑。密码必须经过哈希处理 (MD5)，您不能简单地在此字段中输入文本。

将密码设置为已知值，例如：- admin = 21232f297a57a5a743894a0e4a801fc3

来源： http: [//forum.joomla.org/viewtopic.php?t=10985](http://forum.joomla.org/viewtopic.php?t=10985)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T08:03:18.077

您可以在 {DB_PREFIX}_users 中找到管理员密码，密码经过哈希处理（MD5）...

好吧，它比这复杂一点，哈希形成像 {hashedpassword}:{hashedsalt}，hashedpassword 由 md5(password.hashedsalt) 形成......

所以你可以制作一个小脚本来回显一个新密码......

```
<?php
   $psw = 'hashedpassword:hashedsalt';    // you copy the entry from the db here
   $newpassword = 'newpassword';   // your new password
   list($hashedpassword, $hashedsalt) = explode(":", $psw);
   $newpsw = md5($newpassword.$hashedsalt);
   $output = $newpsw.":".$hashedsalt;
   echo $output; // this is what you put in the db
?> 
```

# c - MSVS 2010 C：内存检测按预期工作

> ID：10825772
> 
> 赞同：1
> 
> 时间：2012-05-30T23:47:08.517
> 
> 标签：c, visual-studio, memory-leaks

我正在 MSVS 2010 中开发一个 C 项目（这意味着我使用的是 malloc、calloc 和 free，而不是 C++ new 和 delete 运算符）。我需要找到内存泄漏（s？），所以我按照[http://msdn.microsoft.com/en-us/library/x98tx3cf.aspx](http://msdn.microsoft.com/en-us/library/x98tx3cf.aspx)上的步骤让程序转储内存状态运行结束。

我包括这样的库：

```
#define _CRTDBG_MAP_ALLOC
#include <stdlib.h>
#include <crtdbg.h> 
```

我还指定每个出口都应显示调试信息，如下所示：

```
_CrtSetDbgFlag ( _CRTDBG_ALLOC_MEM_DF | _CRTDBG_LEAK_CHECK_DF ); 
```

但我的调试输出如下所示：

```
Detected memory leaks!
Dumping objects ->
{80181} normal block at 0x016B1D38, 12 bytes long.
 Data: <  7   7 8 7 > 0C D5 37 00 14 A9 37 00 38 99 37 00 
{80168} normal block at 0x016ACC20, 16 bytes long.
 Data: <  7 H 7 X 7 \ 7 > A8 FB 37 00 48 E9 37 00 58 C2 37 00 5C AC 37 00 
... 
```

根据文章，我应该得到文件名和行号输出，指示泄漏内存的分配位置。为什么这没有发生，我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T14:11:28.363

Adrian McCarthy 评论说我应该确保 _CRT_MAP_ALLOC 定义存在于每个编译单元中。虽然我不知道如何将其定义为编译器选项，但我确实创建了一个稀疏头文件，以确保包含每个编译文件。这使得调试功能按预期工作。

# ios - 附加到 MFMailComposer 时图像更小

> ID：10825782
> 
> 赞同：0
> 
> 时间：2012-05-30T23:48:43.557
> 
> 标签：ios, uiimage, mfmailcomposer

我有一个通过电子邮件发送一堆图像的应用程序。我注意到当我通过电子邮件将它们发送给自己时，（因为有很多）我的电子邮件很长，因为 mac 上的邮件会自动预览它们。有没有办法改变它，使电子邮件不长？有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T03:12:35.003

将它们归档为 .zip，然后通过电子邮件发送包含所有照片的归档文件。这给你留下了 1 个文件。

您可以在此处查看更多存档，[http://code.google.com/p/ziparchive/](http://code.google.com/p/ziparchive/)

# actionscript-3 - Flex 4.6 将通用对象转换为类实例

> ID：10825787
> 
> 赞同：1
> 
> 时间：2012-05-30T23:49:45.090
> 
> 标签：actionscript-3, apache-flex, flex4.6

嘿，当我有一个不属于任何其他类的“对象”实例时，如何将其转换为类实例？

**例子**

一个简单的用户类

```
public class User
{
    public var name:String;
} 
```

当我尝试投射

```
var obj:Object = new Object;
obj.name = "Alex";

var user:User = User(obj); 
```

Flex给了我这个错误：

> TypeError：错误 #1034：类型强制失败：无法将 Object@97a52b1 转换为 models.User。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T14:08:40.147

可能是不可能的，因为 User 不会（自动像在 Java 中一样）扩展 Object 类。

如果你想扩展它，那么 .name 属性将通过类型转换丢失。

因此，您必须创建一个新的 Object 对象并“手动”填充它。

```
 myObj = {};
   for (var key:String in myUser) 
             myObj[key] = myUser[key]; 
```

# c# - 在 WPF 的工具栏上显示用户控件

> ID：10825788
> 
> 赞同：0
> 
> 时间：2012-05-30T23:49:46.143
> 
> 标签：c#, wpf, xaml

我创建了一些简单的形状，例如矩形、圆形，并且能够将它们放在工具栏上，以便可以拖放到 Canvas 上。但是，我在显示由 4 个矩形和线条组成的 WPF 对象时遇到问题。为了更容易，我使用 blend 4 创建用户控件，现在有以下 XAML 标记作为用户控件。

问题：如何在现有工具栏上显示此形状（矩形和线条的组合）？

```
<UserControl
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
mc:Ignorable="d"
x:Class="test1.UserControl2"
x:Name="connector1"
d:DesignWidth="100" d:DesignHeight="90">

<Grid x:Name="LayoutRoot">
    <Rectangle Fill="#FF1B1BCE" Margin="41.334,9.833,42.666,14.167" Stroke="Black"/>
    <Rectangle Fill="#FF1B1BCE" HorizontalAlignment="Left" Margin="33.334,29,0,30.5" Stroke="Black" Width="8"/>
    <Rectangle Fill="#FF1B1BCE" HorizontalAlignment="Right" Height="8.833" Margin="0,9.833,36.499,0" Stroke="Black" VerticalAlignment="Top" Width="6.167"/>
    <Rectangle Fill="#FF1B1BCE" HorizontalAlignment="Right" Height="8.833" Margin="0,0,36.499,14.167" Stroke="Black" VerticalAlignment="Bottom" Width="6.167"/>
    <Path Data="M62.083333,37 L70.416667,37" Fill="#FFEFEFF8" HorizontalAlignment="Right" Height="1" Margin="0,29,24.749,0" Stretch="Fill" Stroke="Black" VerticalAlignment="Top" Width="17.917"/>
    <Path Data="M62.083333,37 L70.416667,37" Fill="#FFEFEFF8" HorizontalAlignment="Right" Height="1" Margin="0,34,24.749,0" Stretch="Fill" Stroke="Black" VerticalAlignment="Top" Width="17.917"/>
    <Path Data="M62.083333,37 L70.416667,37" Fill="#FFEFEFF8" HorizontalAlignment="Right" Height="1" Margin="0,39,24.749,0" Stretch="Fill" Stroke="Black" VerticalAlignment="Top" Width="17.917"/>
    <Path Data="M62.083333,37 L70.416667,37" Fill="#FFEFEFF8" HorizontalAlignment="Right" Height="1" Margin="0,44,24.749,0" Stretch="Fill" Stroke="Black" VerticalAlignment="Top" Width="17.917"/>
    <Path Data="M62.083333,37 L70.416667,37" Fill="#FFEFEFF8" HorizontalAlignment="Right" Height="1" Margin="0,0,24.749,40" Stretch="Fill" Stroke="Black" VerticalAlignment="Bottom" Width="17.917"/>
    <Path Data="M62.083333,37 L70.416667,37" Fill="#FFEFEFF8" HorizontalAlignment="Right" Height="1" Margin="0,0,24.749,35" Stretch="Fill" Stroke="Black" VerticalAlignment="Bottom" Width="17.917"/>
    <Path Data="M62.083333,37 L70.416667,37" Fill="#FFEFEFF8" HorizontalAlignment="Right" Height="1" Margin="0,0,24.749,30.5" Stretch="Fill" Stroke="Black" VerticalAlignment="Bottom" Width="17.917"/>
    <Path Data="M62.083333,37 L70.416667,37" Fill="#FFEFEFF8" HorizontalAlignment="Right" Height="1" Margin="0,0,24.749,25.5" Stretch="Fill" Stroke="Black" VerticalAlignment="Bottom" Width="17.917"/>
    <Path Data="M62.083333,37 L70.416667,37" Fill="#FFEFEFF8" HorizontalAlignment="Right" Height="1" Margin="0,24,24.749,0" Stretch="Fill" Stroke="Black" VerticalAlignment="Top" Width="17.917"/>
</Grid> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T05:28:30.457

下面是一个简单的示例，说明如何将 UserControl 添加到工具栏。基本上，您需要向声明控件的命名空间添加**xmlns**声明，然后可以将其作为嵌套元素添加到 ToolBar 中以使其成为子项。

```
<Window x:Class="test1.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:test1"
        Title="MainWindow" Height="350" Width="525">
    <DockPanel>
        <ToolBar DockPanel.Dock="Top">
            <local:UserControl2 />
        </ToolBar>
        <Grid>
            ...
        </Grid>
    </DockPanel>
</Window> 
```

要获得有意义的东西，您很可能希望添加边框或添加鼠标悬停触发器以提供一些视觉反馈。

另请记住，您必须自己在代码隐藏中编写拖放功能。

**编辑：**

以下是在 UserControl2 XAML 文件中制作 MouseOver 边框的方法：

```
<UserControl ...>
    <UserControl.Resources>
        <Style x:Key="mouseOverBorder" TargetType="{x:Type Border}">
            <Setter Property="BorderBrush" Value="Black" />
            <Setter Property="BorderThickness" Value="2" />
            <Setter Property="Background" Value="Transparent" />
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="False">
                    <Setter Property="BorderBrush" Value="Transparent" />
                </Trigger>
            </Style.Triggers>
        </Style>
    </UserControl.Resources>
    <Border Style="{StaticResource mouseOverBorder}">
        <Grid>
            ...
        </Grid>
    </Border>
</UserControl> 
```

# wpf - WPF 绑定 mvvm StackPanel

> ID：10825789
> 
> 赞同：0
> 
> 时间：2012-05-30T23:49:46.650
> 
> 标签：wpf, xaml, binding, stackpanel

我是 wpf 的初学者，我遇到了 stackpanel 绑定的问题。我必须动态生成标签，并将其添加到堆栈面板。我在 .cs 文件中有以下代码：

```
 public DataImport()
    {
        labels.Add(new StringObject { Value = "tes" });
        labels.Add(new StringObject { Value = "tes2" });
        labels.Add(new StringObject { Value = "tes3" });
    }
    private ObservableCollection<StringObject> labels = new ObservableCollection<StringObject>();

    public ObservableCollection<StringObject> Labels
    {
        get { return labels; }
        private set
        {
            if (value == labels) return;
            labels = value;
            OnPropertyChanged("Labels");
        }
    }
    public class StringObject
    {
        public string Value { get; set; }
    } 
```

接下来在 xaml 我有：

```
<ItemsControl ItemsSource="{Binding Path=Labels}">
    <ItemsControl.ItemTemplate>
        <DataTemplate>
            <StackPanel Grid.Row="1" Height="237" HorizontalAlignment="Center" VerticalAlignment="Top" Width="186" FlowDirection="LeftToRight">
                <Label Content="{Binding Path=Value}"/>
            </StackPanel>
        </DataTemplate>
    </ItemsControl.ItemTemplate>
</ItemsControl> 
```

真正的问题是，在 xaml 窗口中，我只看到标签对象中的第一个元素。你能告诉我我做错了什么吗？

PS：我的类DataImport当然继承了INotifyPropertyChanged

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T06:47:04.807

ItemTemplate 是每个项目。所以只需指定一个标签。

```
<ItemsControl ItemsSource="{Binding Path=Labels}">
    <ItemsControl.ItemTemplate>
        <DataTemplate>
            <Label Content="{Binding Path=Value}"/>
        </DataTemplate>
    </ItemsControl.ItemTemplate>
</ItemsControl> 
```

# asp.net - 如何在回发中停止 HtmlEditorExtender 编码 html？

> ID：10825791
> 
> 赞同：3
> 
> 时间：2012-05-30T23:50:06.160
> 
> 标签：asp.net, ajaxcontroltoolkit, html-editor, loadcontrol

我有一个用户控件，其中包含一个文本框、一个`HtmlEditorExtender`和一个按钮。用户控件使用`LoadControl()`. 每当我单击按钮发布表单时，文本框中的任何格式化文本都会被编码，这不是应该发生的。

* * *

例如，如果我加载文本控件

```
&lt;p&gt;test&lt;/p&gt; 
```

`.Text`在我点击按钮发布页面后，属性返回的文本是

```
&amp;lt;p&amp;gt;test&amp;lt;/p&amp;gt; 
```

如果我第二次发布，它会进一步编码为：

```
&amp;amp;lt;p&amp;amp;gt;test&amp;amp;lt;/p&amp;amp;gt; 
```

等等。

* * *

如果我在设计时将用户控件添加到页面，我确认该控件可以正常工作（不对 HTML 进行编码）。仅当我使用`LoadControl()`加载它时才会发生此问题。

我花了几天时间试图解决这个问题，但我无法判断我是否做错了什么，控件是否与此场景不兼容，或者是否有可靠的解决方法。

* * *

这是一个简单的例子：

用户控制：

```
<%@ Control Language="C#" AutoEventWireup="true" CodeBehind="TestDynamicRichTextControl.ascx.cs" Inherits="Sample.forms.TestDynamicRichTextControl" %> 
<asp:TextBox ID="txtBody" runat="server" Columns="80" Rows="15" TextMode="MultiLine"></asp:TextBox> 
<ajaxToolkit:HtmlEditorExtender ID="heeBody" runat="server" TargetControlID="txtBody"> 
    <Toolbar> 
        <ajaxToolkit:Bold /> 
        <ajaxToolkit:Italic /> 
        <ajaxToolkit:Underline /> 
    </Toolbar> 
</ajaxToolkit:HtmlEditorExtender> 
<br /> 
<asp:Button ID="btnTestPartialPostback" runat="server" Text="Test Partial Postback" onclick="btnTestPartialPostback_Click" /> 
<asp:Label ID="lblResult" runat="server"></asp:Label> 
```

用户控制代码（`BaseUserControl`扩展`System.Web.UI.UserControl`和声明`Initialize()`）：

```
public partial class TestDynamicRichTextControl : BaseUserControl 
{ 
    protected void Page_Load(object sender, EventArgs e) 
    { 
    } 

    public override void Initialize() 
    { 
        txtBody.Text = "<p>test</p>"; 
    } 

    protected void btnTestPartialPostback_Click(object sender, EventArgs e) 
    { 
        lblResult.Text = DateTime.Now.ToString(); 
    } 
} 
```

主页包含此占位符：

```
<asp:PlaceHolder ID="PlaceHolder1" runat="server"></asp:PlaceHolder> 
```

主页面代码：

```
public partial class TestDynamicControl : System.Web.UI.Page 
{ 
    protected void Page_Load(object sender, EventArgs e) 
    { 
        PlaceHolder1.Controls.Clear(); 
        BaseUserControl formUc = (BaseUserControl)this.LoadControl("forms/TestDynamicRichTextControl.ascx"); 
        PlaceHolder1.Controls.Add(formUc); 

        if (!IsPostBack) 
            formUc.Initialize(); 
    } 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T14:34:32.287

对[这个问题](https://stackoverflow.com/questions/10957048/how-to-set-htmleditorextenders-content-server-side)的回答似乎是一个不错的解决方法。当您从编辑器中获取文本时，使用`HtmlDecode`它来转换它：

```
 String fixedText = HttpUtility.HtmlDecode(txtBody.Text); 
```

我会继续在你的 codeplex 案例上发布这个。（我假设它是你的。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-03T19:26:08.080

我对 HTML 扩展器的理解是，HTML 标签是根据工具栏上使用的工具添加的。您是否尝试过加载 tb.text ：

> “这是一个测验”

与

> “<p>这是一个测试</p>”

至于为什么它会这样加倍你，如果扩展器在每次更新时添加标签，那么似乎它们会（应该）在每次迭代中继续添加。

...在标记中的文本框周围放置“p”标签

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-10T03:27:31.300

无论如何，我实际上有机会对此进行测试，并且重新创建了您的问题。看起来好像将“Load”事件中的主页代码放入“Init”事件中它工作得很好。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2014-06-17T20:52:34.877

我能够像这样解决这个问题：

```
 Literal lit = new Literal();
        lit.Mode = LiteralMode.PassThrough;
        lit.Text = HttpUtility.HtmlDecode(HTMLTExt);
        TextBox1.Text = lit.Text; // The text box which HTMLEditorExtender is attached to 
```

# asp.net - 多页 Facebook Canvas 应用程序的站点结构

> ID：10825795
> 
> 赞同：1
> 
> 时间：2012-05-30T23:50:42.617
> 
> 标签：asp.net, facebook-graph-api, facebook-c#-sdk, webforms, facebook-canvas

这似乎是一个明显的问题，但我在 facebook 开发者网站上查看了有关画布应用程序和[facebook csharp sdk](http://csharpsdk.org/)并没有找到我的问题的答案。

我正在使用 facebook-c#-sdk v5.4x 或类似的东西，.net 3.5 使用网络表单。

桌面版画布应用程序将有多个入口点。

`https://apps.facebook.com/my_canvas_app/Default.aspx`
`https://apps.facebook.com/my_canvas_app/Register.aspx?EventID=12345`
`https://apps.facebook.com/my_canvas_app/SomeOtherPage.aspx`

我的第一个问题是，从来自 facebook 的第一个请求开始，我收到了`signed_request`（由*facebook-c#-sdk*负责），我有 oauth 令牌，它的有效期约为 2 小时。在尝试发出 oauth 请求（查询图表等）之前，重新更新此 oauth 令牌并确保其有效的正确方法是什么？

现在我所有的链接（比如来自 Default.aspx）看起来像`<a href="https://apps.facebook.com/my_canvas_app/SomeOtherPage.aspx" target="_top">Go to Some Other Page</a>`，最终会往返于 facebook，得到一个新`signed_request`的 ，因此是一个更新的 oauth 令牌。

其次，当通过 asp.net 将常规表单回发到我自己的站点时，我确保`signed_request`表单上带有一个简单的`<input type="hidden" name="signed_request" value="<%=Request.Form["signed_request"]%>" />`，这似乎适用于应用程序。如果我省略了这个，那么回发没有 oauth 信息，导致事情失败。这是在画布应用程序中执行回发的正确方法吗？从查看 csharp-sdk 的源代码中可以看出，会话中没有存储任何内容来保留请求之间的 oauth 令牌，因此多个页面/回发需要隐藏输入和 target="_top" 链接，我我在这个推论中正确吗？

`https://apps.facebook.com/my_canvas_app/MobilePage.aspx`第三，在开发移动画布应用程序（没有 iframe）时，如果我的第一个假设是正确的，我页面上的所有链接是否仍然必须转到。

如果有人能对这些主题有所了解，我将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T11:58:12.380

> 现在我所有的链接（比如来自 Default.aspx）看起来像转到其他页面，最终会往返于 facebook，获得一个新的 signed_request，从而获得一个更新的 oauth 令牌。

我建议还将 JavaScript SDK 嵌入到您的页面中——然后调用 FB.getLoginStatus 也应该每次都为您提供有效的访问令牌。您可以做的另一件事是将您在用户登录时获得的短期访问令牌交换为长期访问令牌，请参阅[https://developers.facebook.com/roadmap/offline-access-removal/](https://developers.facebook.com/roadmap/offline-access-removal/)

如果您*不*将访问令牌保存到某种会话中，那么我想您将不得不通过回发将其从页面传输到页面，是的。

（也许你也应该看看[https://developers.facebook.com/docs/authentication/access-token-expiration/](https://developers.facebook.com/docs/authentication/access-token-expiration/)。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T14:36:23.823

我正在做的是`signed_request`在每页的基础上使用。桌面环境中的所有链接都`http://apps.facebook.com/myappnamespace/MyPageName.aspx`带有`target="_top"`，这样每次页面更改都会获得更新的 oauth 令牌。移动设备的操作方式不同，因为`signed_request`它不适用于移动体验。解决方案是改用服务器端身份验证。我不`http://apps.facebook.com/myappnamespace`用于移动环境，因为它不在 iframe 中。移动设备像任何其他常规网站一样运行。

# javascript - 具有多个图像的灯箱在 IE 中不起作用

> ID：10825803
> 
> 赞同：0
> 
> 时间：2012-05-30T23:51:44.823
> 
> 标签：javascript, html, internet-explorer-8, lightbox

我正在尝试使用标准灯箱。在我尝试将多个图像添加到一个“集合”之前，一切都很完美。

只使用没有模组的标准语法

```
<script src="js/jquery-1.7.2.min.js"></script>
<script src="js/lightbox.js"></script>
<link href="css/lightbox.css" rel="stylesheet" />

<a href="images/famroom.jpg" rel="lightbox[rooms]" title="Family Room"><img src="images/famroom.jpg" alt="Bedroom" width="250" height="188" class="fltrt"></a>Accommodation</h4>    
<a href="images/twinroom.jpg" rel="lightbox[rooms]" title="Twin Room"></a>
<a href="images/doubleroom.jpg" rel="lightbox[rooms]" title="Double Room"></a>
<a href="images/bathroom.jpg" rel="lightbox[rooms]" title="Bathroom"></a> 
```

以上不起作用。它显示为损坏的图像，当我单击时，我只看到一个纯白色的图像。

但是，这（例如）工作正常。

```
<a href="images/famroom.jpg" rel="lightbox" title="Family Room"><img src="images/famroom.jpg" alt="Wedding Table" width="250" height="188" class="fltlft"></a> 
```

它唯一的 IE8 我遇到了这个问题（没有尝试过 6、7 或 9），它在 FF 和 Chrome 中完美运行。页面上没有使用其他脚本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T00:09:21.830

我已经在 IE8 上进行了测试，我的示例似乎正在运行，也许与我的示例进行比较，看看您是否遗漏了什么？

[http://jsfiddle.net/n1ck/RcA3a/3/](http://jsfiddle.net/n1ck/RcA3a/3/)

我包括（取自他们的演示页面）：

```
 <link rel="stylesheet" href="http://lokeshdhakar.com/projects/lightbox2/css/lightbox.css"   type="text/css" media="screen">
 <script src="http://lokeshdhakar.com/projects/lightbox2/js/jquery-1.7.2.min.js"></script>
 <script src="http://lokeshdhakar.com/projects/lightbox2/js/lightbox.js"></script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T06:13:30.087

这有一个奇怪的决议。事实证明，这在本地不起作用。

当我将它上传到服务器时，它运行良好。

# ruby - Site Prism，Capybara：带变量的选择器

> ID：10825804
> 
> 赞同：2
> 
> 时间：2012-05-30T23:52:03.073
> 
> 标签：ruby, ruby-on-rails-3, capybara, pageobjects, site-prism

我正在使用[site_prism](https://github.com/natritmeyer/site_prism)在水豚中实现页面对象模型。它看起来很有趣。

如何指定选择器，例如“[data-id='x']”，其中 x 是整数？像这样的东西：

```
class Home < SitePrism::Page
  set_url "http://www.example.com"
  element :row, "[data-id='@id']"
end 
```

然后在我的测试中：

```
Then /^the home page should contain a row$/ do
  @home.should have_row 1234
end 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-12T22:49:24.503

因为 SitePrism 在定义元素时设置了元素定位器，所以您的建议不起作用。要实现您的要求，请查看以下内容：

```
class Home < SitePrism::Page
  elements :rows, "tr[data-id]"

  def row_ids
    rows.map {|row| row['data-id']}
  end
end 
```

它们不是映射单行，而是全部映射（使用`elements`而不是`element`）。一个名为的单独方法`row_ids`收集具有“data-id”值的所有行，将所有这些值映射到一个新数组中，然后返回该新数组。

然后测试将包含以下内容：

```
Then /^the home page should contain a row$/ do
  @home.row_ids.should include @id
end 
```

...这将检查是否存在 ID 匹配的行`@id`。

不那么漂亮，但它应该工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-11-02T11:59:24.843

或者，如果您更喜欢这种方式，您可以进一步了解 Nat 的建议，并将行元素定义为一个简单的方法，然后可以将 id 作为参数：

```
class Home < SitePrism::Page
    elements :rows, "tr[data-id]"

    def row_with_id(id)
         rows.find {|row| row['data-id'] == id.to_s}
    end
end 
```

然后在您的步骤定义中

```
Then /^the home page should contain a row$/ do
    @home.row_with_id(1234).should_not be_nil
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-29T16:12:22.920

我通过执行以下操作解决了它 - 它是一种 hack，并且绝不遵循页面对象模式。但我无法从上面找出答案。

## 我的特点：

```
 Then I click on book 3 from the list 
```

……

## 我的步骤如下所示：

```
 Then /^I click on book (.*) from the list$/ do |index|
   page.method_find(index)
 end 
```

## 在我的页面对象类中：

```
 def method_find(index)
    find(div > div > span.nth-child({index})).click
  end 
```

# java - HTTP 代理，内容长度未正确添加

> ID：10825805
> 
> 赞同：0
> 
> 时间：2012-05-30T23:52:28.530
> 
> 标签：java, http, sockets, proxy, http-headers

我正在尝试使用套接字在java中编写一个简单的HTTP代理，基本上只是接受一个请求，读取它并将其转发到服务器，读取响应并返回给浏览器。我遇到的问题是在响应中有一个我解析的 Content-Length 字段，我编写了一个循环来准确读取要发送回浏览器的字节数，但它在之前到达流的末尾读取正确的数量（读取返回 -1）。我将在下面添加我的代理的基本代码 - 主线程只是在建立连接时生成这些类之一。有没有人有任何想法？这将非常有帮助。

```
public class ProxyClient implements Runnable {

Socket clientSocket;
Socket netflixSocket;

InputStream isClient = null;
OutputStream osClient = null;
BufferedReader brClient = null;

InputStream isNetflix = null;
OutputStream osNetflix = null;
BufferedReader brNetflix = null;
boolean connectedNetflix = false;

String meta = "";   //header data

public ProxyClient(Socket connectionSocket){
    this.clientSocket = connectionSocket;

    try {
        isClient = clientSocket.getInputStream();
        osClient = clientSocket.getOutputStream();
        brClient = new BufferedReader(new InputStreamReader(isClient));
    } catch (IOException e1) {
        e1.printStackTrace();
    }

}

@Override
public void run() {

    String host = "";

    String temp;        // temp read line from buffer
    String getRequest;
    int contentLength;  //holder for reading bytes.
    int bytesRead;      // Total number of bytes read during consecutive reads
    int numRead;        // Number of bytes read in a single read.

    byte[] dataBuffer = new byte[2000000];

    while(true){

        try {

            // reading client HTTP request / connecting
            host = "";
            meta = "";
            contentLength = 0;
            getRequest = "";
            while((temp = brClient.readLine()).length() > 0){
                    meta += temp + "\r\n";

                    //connect to server
                    if(!connectedNetflix && temp.startsWith("Host")){

                        // extract the host to connect to
                        host = temp.substring(temp.indexOf(':') + 2);

                        //connect to the host
                        try {
                            netflixSocket = new Socket(host, 80);
                            osNetflix = netflixSocket.getOutputStream();
                            isNetflix = netflixSocket.getInputStream();
                            brNetflix = new BufferedReader(new InputStreamReader(isNetflix));
                        } catch (UnknownHostException e) {
                            e.printStackTrace();
                        } catch (IOException e) {
                            e.printStackTrace();
                        }

                        connectedNetflix = true;

                    }
                    else if (temp.startsWith("Content-Length:")) {
                        contentLength = Integer.parseInt(temp.substring(temp.indexOf(':') + 2));
                    }

            }
            meta += "\r\n"; // add blank line

            //read request content, if any
            if(contentLength > 0){
                numRead = 0;
                bytesRead = 0;
                while(bytesRead != contentLength){
                    numRead = isNetflix.read(dataBuffer, bytesRead, contentLength-bytesRead);
                    if(numRead >0){
                        bytesRead += numRead;
                    }
                }
            }

            //send to server
            osNetflix.write(meta.getBytes());
            if(contentLength > 0){
                osClient.write(dataBuffer, 0, contentLength);
            }
            osNetflix.flush();

            //Read response from server
            contentLength = 0;
            meta = "";
            while((temp = brNetflix.readLine()).length() > 0){
                meta += temp + "\r\n";

                if (temp.startsWith("Content-Length:")) {
                    contentLength = Integer.parseInt(temp.substring(temp.indexOf(':') + 2));
                }

            }               
            meta += "\r\n"; // add blank line

            //read Netflix content
            if(contentLength > 0){
                numRead = 0;
                bytesRead = 0;
                while(bytesRead != contentLength){
                    numRead = isNetflix.read(dataBuffer, bytesRead, contentLength-bytesRead);
                    if(numRead >0){
                        bytesRead += numRead;
                    }

                }

            }               

            // write back to browser/client
            osClient.write(meta.getBytes());
            if(contentLength > 0){
                osClient.write(dataBuffer, 0, contentLength);
            }
            osClient.flush();

        } catch (IOException e) {
            e.printStackTrace();
        }

    }

}
} 
```

这是一个示例响应标头：

```
HTTP/1.1 200 OK
Server: Apache
Accept-Ranges: bytes
Content-Type: text/plain
Content-Type: application/octet-stream
Access-Control-Allow-Origin: *
Content-Type: application/octet-stream
Last-Modified: Fri, 17 Jun 2011 07:52:37 GMT
ETag: "0d6a07a1c0e6772459e73f7c0c4fd899:1308297157"
Date: Thu, 31 May 2012 01:54:10 GMT
Content-Length: 294183
Connection: close
Cache-Control: no-store 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T00:16:32.283

`Content-Length`只是您的代理可以知道要读取多少字节的众多方法之一。在某些情况下，您必须**忽略**它`Content-Length`是否存在（在这些条件下它不应该存在，但有时无论如何都会存在）。有关如何正确读取响应数据的官方规则，请阅读[RFC 2616 第 4.4 节。](https://www.rfc-editor.org/rfc/rfc2616#section-4.4)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T00:19:20.310

这不是您编写 HTTP 代理的方式。您唯一需要解析的是初始 CONNECT 命令。之后的一切只是前后复制字节。传入的 HTTP 已经正确（或不正确）：不要乱用它。

# javascript - 无法通过 javascript 设置表单操作（错误：对象不支持此属性或方法）

> ID：10825806
> 
> 赞同：2
> 
> 时间：2012-05-30T23:52:42.260
> 
> 标签：javascript, forms, internet-explorer, action

这是代码。`patient`是表单名称。

```
function settarget(page) {
    document.getElementById('patient').action = page;
} 
```

来自 IE 的确切错误消息是：

```
SCRIPT438: Object doesn't support this property or method 
```

我也尝试过引用它`document.forms[0].action`- 同样的错误。

`patient`任何其他标签的名称都没有重复。

这适用于 Chrome 和 Firefox，但不适用于 XP 上的 IE8 或 Win7 上的 IE9。IE 中是否有阻止此操作的安全设置？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-30T23:58:23.207

DOM 元素（由 getElementById 返回）[没有属性`action`](https://developer.mozilla.org/en/DOM/element)。您需要在元素上[设置属性。](https://developer.mozilla.org/en/DOM/element.setAttribute)

```
document.getElementById('patient').setAttribute('action',page) 
```

# android - 来自android中相机意图问题的图像

> ID：10825810
> 
> 赞同：2
> 
> 时间：2012-05-30T23:53:01.607
> 
> 标签：android, facebook, android-camera

我正在将 facebook 与 android 集成，我想在拍照时将其保存到 sdcard，然后将其上传到 facebook。

这是我的代码：

```
photo_up=(Button)findViewById(R.id.camera_foto_button);
            photo_up.setOnClickListener(new View.OnClickListener() {
                   public void onClick(View v) {
                       final Intent intent = new Intent(MediaStore.ACTION_IMAGE_CAPTURE);  
                       intent.putExtra(MediaStore.EXTRA_OUTPUT, Uri.fromFile(getTempFile(PlaceScreen.this)) );   
                       startActivityForResult(intent,CAMERA_REQUEST); 
                   }
                });

 private File getTempFile(Context context){  
          //it will return /sdcard/image.tmp  
          final File path = new File( Environment.getExternalStorageDirectory(), context.getPackageName() );  
          if(!path.exists()){  
            path.mkdir();  
          }  
          return new File(path, "image.png");  
        } 
```

和 OnActivity 结果

```
protected void onActivityResult(int requestCode, int resultCode, Intent data) {  
    switch(requestCode){
                case CAMERA_REQUEST:{
                    final File file = getTempFile(this);  
                    try {  
                      bmp = MediaStore.Images.Media.getBitmap(this.getContentResolver(), Uri.fromFile(file) );  
                      // do whatever you want with the bitmap (Resize, Rename, Add To Gallery, etc)  
                    } catch (FileNotFoundException e) {  
                      e.printStackTrace();  
                    } catch (IOException e) {  
                      e.printStackTrace();  
                    }  

                    ByteArrayOutputStream stream = new ByteArrayOutputStream();        
                    bmp.compress(Bitmap.CompressFormat.PNG, 100, stream);         
                    byteArray = stream.toByteArray(); // convert camera photo to byte array  
                    Bundle params = new Bundle();       
                    params.putByteArray("picture", byteArray);      
                    params.putString("message", "Have fun");       
                    Utility.mAsyncRunner.request("me/photos", params,
                            "POST", new PhotoUploadListener(), null);
                    break;
                } 
```

所以会发生这样的事情：相机打开，图像被捕获并保存，但我强制关闭并且它没有上传到 fb。

我也在手机上查过。Logcat 在这里：

```
05-31 02:50:19.437: E/AndroidRuntime(2470): FATAL EXCEPTION: main
05-31 02:50:19.437: E/AndroidRuntime(2470): java.lang.RuntimeException: Unable to resume activity {com.myname.package/com.myname.package.PlaceScreen}: java.lang.RuntimeException: Failure delivering result ResultInfo{who=null, request=1888, result=-1, data=Intent { act=inline-data (has extras) }} to activity {com.myname.package/com.myname.package.PlaceScreen}: java.lang.NullPointerException
05-31 02:50:19.437: E/AndroidRuntime(2470):     at android.app.ActivityThread.performResumeActivity(ActivityThread.java:2124)
05-31 02:50:19.437: E/AndroidRuntime(2470):     at android.app.ActivityThread.handleResumeActivity(ActivityThread.java:2139)
05-31 02:50:19.437: E/AndroidRuntime(2470):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1672)
05-31 02:50:19.437: E/AndroidRuntime(2470):     at android.app.ActivityThread.handleRelaunchActivity(ActivityThread.java:2836)
05-31 02:50:19.437: E/AndroidRuntime(2470):     at android.app.ActivityThread.access$1600(ActivityThread.java:117)
05-31 02:50:19.437: E/AndroidRuntime(2470):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:939)
05-31 02:50:19.437: E/AndroidRuntime(2470):     at android.os.Handler.dispatchMessage(Handler.java:99)
05-31 02:50:19.437: E/AndroidRuntime(2470):     at android.os.Looper.loop(Looper.java:130)
05-31 02:50:19.437: E/AndroidRuntime(2470):     at android.app.ActivityThread.main(ActivityThread.java:3687)
05-31 02:50:19.437: E/AndroidRuntime(2470):     at java.lang.reflect.Method.invokeNative(Native Method)
05-31 02:50:19.437: E/AndroidRuntime(2470):     at java.lang.reflect.Method.invoke(Method.java:507)
05-31 02:50:19.437: E/AndroidRuntime(2470):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:867)
05-31 02:50:19.437: E/AndroidRuntime(2470):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:625)
05-31 02:50:19.437: E/AndroidRuntime(2470):     at dalvik.system.NativeStart.main(Native Method)
05-31 02:50:19.437: E/AndroidRuntime(2470): Caused by: java.lang.RuntimeException: Failure delivering result ResultInfo{who=null, request=1888, result=-1, data=Intent { act=inline-data (has extras) }} to activity {com.myname.package/com.myname.package.PlaceScreen}: java.lang.NullPointerException
05-31 02:50:19.437: E/AndroidRuntime(2470):     at android.app.ActivityThread.deliverResults(ActivityThread.java:2536)
05-31 02:50:19.437: E/AndroidRuntime(2470):     at android.app.ActivityThread.performResumeActivity(ActivityThread.java:2111)
05-31 02:50:19.437: E/AndroidRuntime(2470):     ... 13 more
05-31 02:50:19.437: E/AndroidRuntime(2470): Caused by: java.lang.NullPointerException
05-31 02:50:19.437: E/AndroidRuntime(2470):     at com.myname.package.PlaceScreen.onActivityResult(PlaceScreen.java:325)
05-31 02:50:19.437: E/AndroidRuntime(2470):     at android.app.Activity.dispatchActivityResult(Activity.java:3908)
05-31 02:50:19.437: E/AndroidRuntime(2470):     at android.app.ActivityThread.deliverResults(ActivityThread.java:2532)
05-31 02:50:19.437: E/AndroidRuntime(2470):     ... 14 more 
```

编辑：

好的，我的 bmp 哪里是空的。这是为什么？有什么错？

```
bmp = MediaStore.Images.Media.getBitmap(this.getContentResolver(), Uri.fromFile(file) );  
bmp.compress(Bitmap.CompressFormat.PNG, 100, stream); 
```

任何人都可以找出为什么我的 bmp 为空，而我可以在图库中看到图像。这意味着图像被正常拍摄，但由于 bmp=MediaStore.Images.Media 没有得到任何结果

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-08T06:21:21.247

在使用网络上可用的通用代码来调用相机并拍照并检索它时，我当时在 SAMSUNG 设备中遇到了一些问题，同样的错误发生`Failure delivering result ResultInfo`并且找不到任何解决方案，可能是因为任何 API 级别或设备依赖性.

但为了克服它，我用另一种方式编写代码来完成任务，代码在这里：

1）调用相机

```
 String _path = Environment.getExternalStorageDirectory()
        + File.separator + "TakenFromCamera.png";
        File file = new File(_path);
        Uri outputFileUri = Uri.fromFile(file);
        Intent intent = new Intent(
        android.provider.MediaStore.ACTION_IMAGE_CAPTURE);
        intent.putExtra(MediaStore.EXTRA_OUTPUT, outputFileUri);
        startActivityForResult(intent, 1212); 
```

2）在ActivityResult中获取Bitmap

```
 if (requestCode == 1212) {
                String _path = Environment.getExternalStorageDirectory()
                + File.separator + "TakenFromCamera.png";
                mBitmap = BitmapFactory.decodeFile(_path);
                if (mBitmap == null) {
                    // bitmap still null
                } else {
                    // set bitmap in imageview
                }
            } 
```

# doctrine-orm - 在一个教义2实体中获取列名

> ID：10825812
> 
> 赞同：26
> 
> 时间：2012-05-30T23:53:22.057
> 
> 标签：doctrine-orm

如何获取学说实体中所有列的名称？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2012-05-31T08:11:40.813

如[ClassMetadataInfo](http://www.doctrine-project.org/api/orm/2.5/class-Doctrine.ORM.Mapping.ClassMetadataInfo.html#_getColumnNames)文档中所述，您可以使用以下`getColumnNames`方法：

```
$em->getClassMetadata('Entities\MyEntity')->getColumnNames(); 
```

# sql - 在 SQL 中通过 OpenXML 更新消息列表

> ID：10825818
> 
> 赞同：0
> 
> 时间：2012-05-30T23:54:00.957
> 
> 标签：sql

我有一个 xml 格式的消息列表，我想使用 OpenXML 将消息 ID 发送到存储过程，将它们的状态更新为“A”状态。您可以在此处查看编码，如下所示：

XML 样本格式：

```
 <Message>
    <MessageID>17</MessageID>
    <MessageID>16</MessageID>
    <MessageID>15</MessageID>
 </Message> 
```

在存储过程中：

```
exec sp_xml_preparedocument @idoc OUTPUT, @XmlMessagesItems 
```

方式一：

```
UPDATE SECMSG_TO   
SET SECMSG_TO.Status='A'
FROM OPENXML (@idoc, '/Message',2) 
     with ( MessageID INT) ox  
WHERE  
    SECMSG_TO.MessageID = ox.MessageID 
```

或方式2：

```
 UPDATE SECMSG_TO   
  SET SECMSG_TO.Status = 'A'
  WHERE SECMSG_TO.MessageID IN (SELECT *  
                                FROM OPENXML  (@idoc, '/Message',2) 
                                WITH ( MessageID INT)        
                            ) 
```

但是通过这两种方式，我只能更新第一条消息，这意味着 17 号和其他没有影响。你能给我一个线索，我怎样才能完全更新所有列表。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T23:00:25.643

```
 XML Format
  <?xml version="1.0" encoding="utf-8" ?>
  <Messages>
    <Message MessageID='33' />
    <Message MessageID='34' />
    <Message MessageID='20' />   
  </Messages>

    in Stored Procedure
    SELECT @MessageID = MessageID      
    FROM OPENXML (@idoc, '/Messages/Message', 1)             
     WITH       
     (             
         MessageID   int 
     )        

     UPDATE TableName SET Status='A'     
         WHERE MessageID = @MessageID 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T22:53:41.367

```
First Way: XML Format
  <?xml version="1.0" encoding="utf-8" ?>
  <Messages>
    <Message MessageID='33' />
    <Message MessageID='34' />
    <Message MessageID='20' />   
  </Messages>

 in Stored Procedure
  @XmlMessagesItems text
  DECLARE @idoc INT
  EXEC sp_xml_preparedocument @idoc OUTPUT, @XmlMessagesItems  
  UPDATE TableName   SET Status='A'
              from OPENXML  (@idoc, '/Messages/Message',1) 
              with ( MessageID INT) ox  
              WHERE MessageID = ox.MessageID 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T22:57:06.187

```
 XML Format
  <?xml version="1.0" encoding="utf-8" ?>
  <Messages>
    <Message MessageID='33' />
    <Message MessageID='34' />
    <Message MessageID='20' />   
  </Messages>

 in Stored Procedure
  UPDATE TableName   SET Status='A'          
     WHERE MessageID IN
     (
           select *  from OPENXML  (@idoc, '/Messages/Message',1) with ( MessageID INT )        
              ) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-31T06:42:28.120

您正在检索`Message`需要节点列表的`MessageID`节点列表。

```
SELECT MessageID  
FROM OPENXML (@idoc, '/Message/MessageID',2) 
WITH (MessageID INT '.') 
```

# frame - 检查框架中是否存在元素时出现异常

> ID：10825819
> 
> 赞同：1
> 
> 时间：2012-05-30T23:54:08.590
> 
> 标签：frame, watir, watir-webdriver

当我尝试检查一个元素是否存在于框架中，但实际上它不存在时，`watir`会引发异常。

```
> main_frame.exist?
=> true
> main_frame.table(:id => "Table_1").exist?
=> true
> main_frame.table(:id => "Table_2").exist?
Selenium::WebDriver::Error::StaleElementReferenceError: Element belongs to a different frame than the current one - switch to its containing frame to use it
    from [remote server] resource://fxdriver/modules/web_element_cache.js:5634:in `unknown'
    from [remote server] file:///tmp/webdriver-profile20120531-5558-h7vd7r/extensions/fxdriver@googlecode.com/components/driver_component.js:5329:in `unknown'
    from [remote server] file:///tmp/webdriver-profile20120531-5558-h7vd7r/extensions/fxdriver@googlecode.com/components/driver_component.js:6623:in `unknown'
    from [remote server] file:///tmp/webdriver-profile20120531-5558-h7vd7r/extensions/fxdriver@googlecode.com/components/command_processor.js:9924:in `unknown'
    from [remote server] file:///tmp/webdriver-profile20120531-5558-h7vd7r/extensions/fxdriver@googlecode.com/components/command_processor.js:9929:in `unknown'
    from [remote server] file:///tmp/webdriver-profile20120531-5558-h7vd7r/extensions/fxdriver@googlecode.com/components/command_processor.js:9875:in `unknown'
    from /home/raincole/.rvm/gems/ruby-1.9.3-p125/gems/selenium-webdriver-2.22.0/lib/selenium/webdriver/remote/response.rb:52:in `assert_ok'
    from /home/raincole/.rvm/gems/ruby-1.9.3-p125/gems/selenium-webdriver-2.22.0/lib/selenium/webdriver/remote/response.rb:15:in `initialize'
    from /home/raincole/.rvm/gems/ruby-1.9.3-p125/gems/selenium-webdriver-2.22.0/lib/selenium/webdriver/remote/http/common.rb:59:in `new'
... 
```

但是……不应该回来`false`吗？为什么例外？

# java - 编码无符号整数

> ID：10825825
> 
> 赞同：1
> 
> 时间：2012-05-30T23:55:39.080
> 
> 标签：java, c++

我在 java 中有以下代码，我需要将其转换为 c++ 才能对 unsigned int 进行编码。

```
public static int enc_uint32be( int i, byte[] dst, int di ) {
        dst[di++] = (byte)((i >> 24) & 0xFF);
        dst[di++] = (byte)((i >> 16) & 0xFF);
        dst[di++] = (byte)((i >> 8) & 0xFF);
        dst[di] = (byte)(i & 0xFF);
        return 4;
} 
```

我是java的新手。我相信这个论坛上的几位专家都懂这两种语言——有人可以帮我翻译吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T00:00:38.663

这取决于您计划使用的数据类型，但如果您只是更改：

```
 byte[] dst 
```

至

```
unsigned char dst[] 
```

在函数声明中，它的行为应该相同（并且也将函数中的字节用法更改`unsigned char`为）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T00:03:46.833

实际上，Java 中的代码与 C++ 中的代码几乎相同，只是稍作修改：

*   byte 不是 C++ 中的有效类型，等价于 unsigned char
*   数组参数类型必须像提到的@MarkWilkins 一样重新设计。

# c# - c#中url参数值的正则表达式

> ID：10825832
> 
> 赞同：1
> 
> 时间：2012-05-30T23:56:47.280
> 
> 标签：c#, asp.net, regex

我想获取 url 的 cid 值，在这种情况下：

```
"http://www.google.com/products/catalog?hl=en&q=Dee+Zee+8170LB&um=1&ie=UTF-8&tbm=shop&cid=14199285063072465458" 
```

我可以为此使用正则表达式还是有一些更好的方法可以做到这一点，除了旧的 IndexOf 字符串修剪。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-30T23:59:27.327

您可以尝试使用[HttpUtility.ParseQueryString](http://msdn.microsoft.com/en-us/library/ms150046.aspx)。

# c++ - 为什么编译器在这里抱怨函数歧义？

> ID：10825837
> 
> 赞同：1
> 
> 时间：2012-05-30T23:57:02.820
> 
> 标签：c++, stl

我正在尝试运行“Accelerated C++”（A. Koenig，B. Moo）（§8.2.2）一书中的一些示例代码：

```
#include <iostream>
#include <vector>

using std::cout;
using std::endl;
using std::vector;

template <class In, class X>
In find(In begin, In end, const X &x)
{
    while (begin != end && *begin != x) {
        ++begin;
    }

    return begin;
}

int main()
{
    vector<int> v;

    v.push_back(5);
    v.push_back(32);
    v.push_back(42);
    v.push_back(7);

    cout << *find(v.begin(), v.end(), 42) << endl;

    return 0;
} 
```

该`find`函数在书中是这样出现的；`main`我自己写的函数。

clang++ 和 g++ 都不会编译这个。似乎他们在抱怨我的`find`函数与`std::find`. 但是，我从来`using namespace::std;`没有`using std::find;`在代码中使用过，所以如果包含它，编译器甚至不应该被允许使用`std::find`。这里发生了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-31T00:05:59.463

我认为你已经绊倒了“Koenig 查找”（是的，同一个 Koenig，所以你会认为他会发现问题），也就是“ADL”。

假设通过间接包含，`<algorithm>`已被拉入。

如果`std::vector<int>::iterator`（参数的类型）是 namespace 中的一个类`std`，那么`std::find`即使您从未“使用”它，它也与您的调用匹配，因此该调用是模棱两可的。

如果`std::vector<int>::iterator`是`int*`，则`std::find`不是候选者，并且该调用不模棱两可。

无论哪种方式都是 的有效实现`std::vector`，并且它也是实现定义的，无论`<iostream>`是否`<vector>`包含`<algorithm>`. 因此，您的代码不可移植，但实现几乎无法诊断可移植性问题，除非代码实际上在该实现上失败。

在更典型的 ADL 案例中，关联命名空间中的函数或函数模板比​​调用者居住或“使用”的命名空间中的函数或函数模板更好（更具体），因此避免了歧义。但是您的 global`find`与 基本相同`std::find`，因此不适用。

[http://ideone.com/Cskur](http://ideone.com/Cskur)：

```
#include <iostream>

namespace foo {
    struct Foo {};

    /* same as the one we'll define later */
    template <typename T>
    void func(T) {
        std::cout << "namespace function template\n";
    }
    /* this would be a better match
    void func(Foo) {
        std::cout << "namespace function\n";
    }
    */
}

template <typename T>
void func(T) {
    std::cout << "global function template\n";
}

int main() {
    foo::Foo f;
    func(f);
} 
```

结果：

```
prog.cpp:19: error: call of overloaded ‘func(foo::Foo&)’ is ambiguous 
```

结论：`std`即使在其他命名空间中，使用来自 的名称也有些危险。

或者，如果您愿意：`std`在其他命名空间中定义名称可能意味着调用者需要小心。区别主要在于发生错误时谁修复了错误。

# http-headers - IIS 7.5 仅为特定文件类型添加自定义 HTTP 响应标头

> ID：10825842
> 
> 赞同：15
> 
> 时间：2012-05-30T23:57:55.670
> 
> 标签：http-headers, iis-7.5

在 IIS 7.5 中，您可以添加自定义 http 标头，但是当您这样做时，它们将应用于所有文件类型。我希望仅在提供特定文件类型（png、jpg、gif）时才能够使用自定义 http 标头，而无需将相同的自定义 http 标头也应用于从 Web 服务器请求的所有其他文件类型。

我需要一个通过 web.config 文件实现这一点的解决方案，除非有一个与 php 5.4 Web 应用程序配合得很好的编码解决方案。

# asp.net-mvc-3 - MVC3 动作文件大小限制

> ID：10825849
> 
> 赞同：26
> 
> 时间：2012-05-30T23:59:08.900
> 
> 标签：asp.net-mvc-3

我正在实现一个基于 jquery 的文件上传插件[http://blueimp.github.com/jQuery-File-Upload/](http://blueimp.github.com/jQuery-File-Upload/)。有一个示例 MVC3 应用程序，您可以下载[https://github.com/maxpavlov/jQuery-File-Upload.MVC3](https://github.com/maxpavlov/jQuery-File-Upload.MVC3)。

样本作者在首页视图中有评论：

> @*为了将 MVC 操作用作 AJAX 调用的处理程序，请使用下面的表单声明。（注释掉的那个）不建议使用，因为当使用 MVC 控制器处理请求时，无法控制 POST 请求的 maxMessageLength，这会使上传大文件的功能毫无用处，除非您牺牲安全性并允许较大的 POST 消息大小站点范围。
> 
> 最好使用 HTTP 处理程序来处理上传请求，直到 MVC 框架提供在每个操作基础上设置 maxMessageLength 的方法 *@

现在还是这样吗？

我发现我可以`<httpRuntime maxRequestLength="x" />`在 web.config 中设置，但我的理解是这是一个安全漏洞。是不是也这样？

我宁愿在控制器中处理我的上传，而不是使用 HttpHandler，但不想受到文件大小的限制，也不想引入任何安全漏洞，如果我不需要的话。

**更新：**

根据这篇文章[文件上传 ASP.NET MVC 3.0](https://stackoverflow.com/questions/5193842/file-upload-asp-net-mvc3-0)，默认文件大小限制为 4mb。我已确认此限制[http://msdn.microsoft.com/en-us/library/e1f13641.aspx](http://msdn.microsoft.com/en-us/library/e1f13641.aspx)并了解该漏洞。

**这是通过超过 4mb 的控制器操作上传文件的唯一方法吗？**

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2012-05-31T13:14:02.477

[您可以使用location](http://msdn.microsoft.com/en-us/library/b6x6shw7(v=vs.100).aspx)元素在*web.config*中为具体的控制器操作设置上传大小限制：

```
<configuration>
    <location path="Home/UploadFiles">
        <system.web>
            <httpRuntime maxRequestLength="40960"/>
        </system.web>
    </location>
</configuration> 
```

其中*Home*是控制器名称，*UploadFiles*是操作名称。此处的大小限制为 40MB。

不过，如果您问我，使用 Http Handler 处理文件上传并不是一个糟糕的解决方案。

# matlab - 在 MATLAB 中控制 MSERRegions.plot() 使用的颜色？

> ID：10825850
> 
> 赞同：2
> 
> 时间：2012-05-30T23:59:13.393
> 
> 标签：matlab, plot, computer-vision, matlab-cvst, mser

我想通过以不同颜色绘制多个 MSER 区域来可视化它们的分区，但是`MSERRegions.plot()`计算机视觉工具箱中的方法不接受`'Color'`参数。使用也不会`hold all`导致后续绘图循环显示颜色。（所有区域椭圆始终以亮绿色绘制。）

这是一个示例图，以阐明我要做什么：

![在此处输入图像描述](../Images/bf374f795929cb1087c59d0da245ac3e.png)

我已将下面的区域划分为三个单独的组，并且我想用不同的颜色绘制每个组。有没有一种简单的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T17:15:31.170

一种简单但“hackish”的方法是获取`Children`an 的对象，`Axes`然后在这些对象上设置颜色。

```
childrenObjs = get(gca,'Children');
set(childrenObj, 'Color', desiredColor); 
```

首先，您需要确保子对象确实具有颜色属性，如果它们是用线绘制的，那么它们会。您可以通过调用来确定子对象的类型`handle(child)`。

最后，如果要为每个组设置特定颜色，只需在绘制第一组后设置颜色。让第二组查看哪些手柄是新的，并仅在新手柄上设置颜色。为第三组再做一次。

# iphone - 视图控制器的 NSMutableArray

> ID：10825853
> 
> 赞同：1
> 
> 时间：2012-05-30T23:59:47.327
> 
> 标签：iphone, ios, uiviewcontroller, nsmutablearray

我正在研究如何创建视图控制器的 NSMutableArray。

然后，一旦我有了那个数组，我怎么能在检测左右 UIgesture 滑动以动画进出视图的方法中使用它...

这是拾取我的手势的方法，它只是在两个视图之间制作动画，但是我想在视图控制器数组中的尽可能多的视图之间制作动画。

```
- (void)swipedScreen:(UISwipeGestureRecognizer*)gesture {
    //Left swipe
    if (gesture.direction == UISwipeGestureRecognizerDirectionLeft) {

        [UIView animateWithDuration:0.25 animations:^{
            [self.detailViewB.view setFrame:CGRectMake(0, 0, self.view.frame.size.width, self.view.frame.size.height)];
            [self.detailViewA.view setFrame:CGRectMake(-320, 0, self.view.frame.size.width, self.view.frame.size.height)];
    }];

    }
    //Right swipe
    else if (gesture.direction == UISwipeGestureRecognizerDirectionRight){

        [UIView animateWithDuration:0.25 animations:^{
            [self.detailViewA.view setFrame:CGRectMake(0, 0, self.view.frame.size.width, self.view.frame.size.height)];
            [self.detailViewB.view setFrame:CGRectMake(320, 0, self.view.frame.size.width, self.view.frame.size.height)];
        }];

    }
} 
```

作为一个方面，我有一个主视图控制器，我将这些视图控制器作为子视图加载...至少这是计划。我目前正在使用视图执行此操作...

[http://dl.dropbox.com/u/53813770/SMPrototypeB.zip](http://dl.dropbox.com/u/53813770/SMPrototypeB.zip)

更新：

这是一张图表，向你们展示了我想要达到的目标。

![在此处输入图像描述](../Images/563d81ab833af089c1c1ac8924f2f716.png)

这是让它从数组中加载视图的代码。谢天谢地，真是痛苦。

```
DetailViewController *DVCA = [[DetailViewController alloc] initWithNibName:@"DetailViewController" bundle:[NSBundle mainBundle]];
DetailViewControllerB *DVCB = [[DetailViewControllerB alloc] initWithNibName:@"DetailViewControllerB" bundle:[NSBundle mainBundle]];
DetailViewControllerC *DVCC = [[DetailViewControllerC alloc] initWithNibName:@"DetailViewControllerC" bundle:[NSBundle mainBundle]];

//Create Array of views
viewArray = [NSArray arrayWithObjects:DVCA, DVCB, DVCC, nil];

// set detail View as first view 
UIViewController *recordController = [viewArray objectAtIndex:0];
// This was the bit causing me so many issues.
[self.view addSubview:recordController.view]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T02:25:51.407

如何使用开箱即用的 UIScrollView 来获得相同的效果？它支持向多个方向滚动，可以节省开发新控件的所有开销，而且您不必担心违反任何 HIG 准则。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T00:04:15.187

> 我正在研究如何创建视图控制器的 NSMutableArray。

与创建任何其他对象数组的方式相同：

1.  创建对象。

2.  将它们放入数组中。

您当然可以在您的应用程序委托或根视图控制器中执行此操作——无论哪个对象负责所有其他视图控制器。我可能会选择让应用程序委托管理视图控制器。然后，您可以将第一响应者设置为滑动手势识别器的目标，并在应用程序委托（它是响应者链的一部分）中实现在视图控制器之间切换的操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T00:06:59.513

查看您的项目并看到您的根视图控制器实际上是一个导航控制器，我将重新发布作为答案。

如果您的初始视图控制器是导航控制器，那么操作系统会为您提供您正在寻找的数组，它是 UINavigationController 上的 viewControllers 属性。这是不可变的，但您可以制作它的可变副本。

# php - 无法通过 mySQL 中的 php 更新部件号字段

> ID：10825856
> 
> 赞同：1
> 
> 时间：2012-05-31T00:00:10.520
> 
> 标签：php, mysql

我正在使用脚本通过 mySQL 中的 php 更新我的记录。除了 $part_no 之外的所有字段都可以更新。

我不明白为什么“part_no”不会更新。

感谢任何帮助。

```
<?php session_start();

$type=$_POST['type'];
$part_no=$_POST['part_no'];
$description=$_POST['description'];
$artwork=$_POST['artwork'];
$min=$_POST['min'];
$max=$_POST['max'];

$db="naturan8_hero";

$link = mysql_connect("localhost", "XXXXXXX", "XXXXXX");
if (! $link)
die("Couldn't connect to MySQL");
mysql_select_db($db , $link)
or die("Couldn't open $db: ".mysql_error());
$query = mysql_query(" UPDATE cartons_current SET type='$type' , part_no='$part_no',     description='$description',artwork='$artwork', min='$min' , max='$max' WHERE part_no='$part_no' ");

if($query) {
header("location: inv_fc_edit_success.php?part_no=" . urlencode($part_no));
}else{
header("location: inv_fc_edit_fail.php");
}

?> 
```

以下是编辑表格：

```
<?php
$record = $_POST['part_no'];

mysql_connect("$host", "$username", "$password") or die("cannot connect");
mysql_select_db("$db_name")or die("cannot select DB");

$result=mysql_query(" SELECT * FROM cartons_current WHERE part_no='$record'");
$num=mysql_num_rows($result);
$i=0;
while ($i < $num) {

$type=mysql_result($result,$i,"type");
$part_no=mysql_result($result,$i,"part_no");
$description=mysql_result($result,$i,"description");
$artwork=mysql_result($result,$i,"artwork");
$min=mysql_result($result,$i,"min");
$max=mysql_result($result,$i,"max");
?>

<div id="fcICON">Hero</div>
<div id="titleWRAP">
<div id="newTITLE">Edit Part Number</div>
<div id="newINS">This area is designated for editing a part number. Please <b>be careful and alert </b>to your changes, because they are immediately posted.</div>
</div>
<div class="form_hero_new">
<form id="form_editX" method="POST" action="inv_fc_edit2.php"   onfocus="this.value=''">
  <input type="hidden" name="type" type="text" value="FC">
  <input type="hidden" name="part_no" value="<? echo "$record" ?>">
  <div style="width: 500px; height:63px;float:left;">
    <div style="width: 165px; height:65px;float:left;">
      <div id="heroLABEL" style="width:150px">Part Number</div>
      <div id="newPN">
        <textarea name="part_no"  maxlength="20" minlength="6" type="text" style="width: 130px;color:#FFFF00"><? echo "$part_no"?></textarea>
      </div> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-31T00:03:43.143

您正在设置`part_no`其现有值，这不会进行任何更改：

```
UPDATE cartons_current SET part_no='$part_no' WHERE part_no='$part_no' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T00:16:23.827

如果您有一个零件号，`PART001`并且您在表单中将其更改为`PART002`，您将`PART002`用实际数据覆盖任何现有`PART001`数据。

我会考虑添加一`id`列并在`WHERE`子句中使用它。

# c++ - 如何从 openMP (C++) 中的线程生成子线程

> ID：10825860
> 
> 赞同：1
> 
> 时间：2012-05-31T00:01:26.270
> 
> 标签：c++, multithreading, parallel-processing, openmp

我正在尝试构建一棵具有固定数量和固定深度的树。我并不完全理解 openMP 的底层机制。树构造在调用时开始`build(root_node, 0)`。现在让我们假设`maxDepth`给定一个任意数字并且`maxChildren`等于`n`。当`build(root_node, 0)`被调用时，`n`线程被启动。我的印象是这些`n`线程中的每一个都会创建`n`线程。然而，仔细观察`top`发现，从来没有超过`n`线程。`maxChildren`只有当等于或高于我拥有的核心数量时，我才能使我的核心饱和。看来`parallel`递归中后续级别中的块没有效果，将后续使用的可用线程数限制为初始调用`build`.

为什么它会这样？递归在这方面有什么作用吗？最重要的是，我能做些什么来解决这个问题？提前致谢。

```
void
build(Node* pNode, unsigned int depth)
{
    if (depth >= maxDepth)
        return;
    std::list<Node*> children;
    std::list<Node*>::iterator it;
    // This loop cannot be parallelized because each call to select_next_node
    // is dependent on the previous one
    for (unsigned i = 0; i < maxChildren; ++i)
    {
        Node* const p_candidate_node = select_next_node(...);
        if (is_valid(p_candidate_node))
            children.push_back(p_candidate_node);
    }

    #pragma omp parallel private(it)
    for (it = children.begin(); it != children.end(); ++it)
    #pragma omp single nowait
        build(*it, depth + 1);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T07:07:07.643

默认情况下，几乎所有 OpenMP 运行时都禁用嵌套并行。您应该通过以下两种方法之一显式启用它：

*   称呼`omp_set_nested(1);`
*   将环境变量设置`OMP_NESTED`为`TRUE`

在这种情况下，嵌套并行性可能不是您想要的。线程的数量可能会增长得非常快并消耗大量的系统资源。您应该使用 OpenMP 任务。所有符合 OpenMP 3.0 的编译器都应支持它们。

# asp.net - HttpHandler 实现

> ID：10825861
> 
> 赞同：0
> 
> 时间：2012-05-31T00:01:46.247
> 
> 标签：asp.net, web-config, httphandler

我已经为我的网站实现了一个自定义 HttpHandler，如果该页面在列表中，它将将该页面重定向到特定页面。到目前为止，重定向工作正常，但问题是最后一页的内容变为空白。

来自我的 PageHandler 的代码：

```
public class CustomPageHandler : IHttpHandler
{
    public bool IsReusable
    {
        get { return false; }
    }

    public void ProcessRequest(HttpContext context)
    {
        List<string> fileList = new List<string>();
        fileList.Add("Page1.aspx");
        fileList.Add("Page2.aspx");

        foreach (string fileName in fileList)
        {
            if (context.Request.RawUrl.ToLower().Contains(fileName.ToLower()))
            {
                context.Response.Redirect("BlockedPage.aspx");
            }
        }
    }
} 
```

我的 Web.Config 文件中的代码 [与 HttpHandler 相关]

```
<httpHandlers>
   .
   .
   .
   <add verb="*" path="*.aspx" type="CustomPageHandler, App_Code"/>
</httpHandlers> 
```

任何人都可以帮助我摆脱这种棘手的情况吗？提前致谢...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T00:53:44.633

这是预期的行为。HttpHandler 是实际处理请求的对象。如果请求不是对列表中某一页面的请求，您的代码将不执行任何操作。这就是为什么没有输出。

如果你想*修改*页面的处理而不是*替换*它，那么你需要一个 HttpModule。

# jquery - 使用 jQuery 将数据 ID 列表存储在 cookie 中

> ID：10825864
> 
> 赞同：1
> 
> 时间：2012-05-31T00:02:28.243
> 
> 标签：jquery, cookies

我正在尝试创建一个数据 ID 列表并将它们存储在一个 cookie 中，这样我就可以稍后循环它们并根据需要对其进行操作。这需要在客户端完成，所以我想使用 jQuery Cookies。

假设我有一个投资组合项目列表，其中每个项目都有一个唯一的 data-id 属性。当用户单击单个投资组合项目时，我需要将该特定数据 ID 存储到 jQuery cookie 中，以便稍后引用它。

解决这个问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T00:07:38.553

您可以 JSON Stringify 数组，然后将其存储在 cookie 中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T00:19:29.730

**已编辑**

因此，您想检查用户已经访问过哪些投资组合页面（注意：除了 cookie，您还可以考虑 HTML5 History API 或 localStorage）。

当用户访问页面时，您希望从某处检索投资组合 ID。这可能在 DOM 元素中，也可能在 URL 的查询字符串中。我假设是后者。

```
// Get the portfolio ID from the query string
var currentId = new RegExp("[\\?&]MYID=([^&#]*)").exec(location.search)[1]
// Replace MYID in the line above with the name of your querystring parameter 
```

好的，所以我们有我们的 ID。接下来，我们需要从 cookie 中读取任何现有的。如果 cookie 不存在，我们需要创建它。

```
function get_cookie ( cookie_name )
{
  var results = document.cookie.match ( '(^|;) ?' + cookie_name + '=([^;]*)(;|$)' );

  if ( results )
    return ( unescape ( results[2] ) );
  else
    return null;
}

if (get_cookie('readPortfolios') == null) {
  // Extremely simplified implementation
  document.cookie = 'readPortfolios=' + currentId;
}
else {
  // We have a cookie already. We'll read it
  var ck = get_cookie('readPortfolios');

  // We want to add this page's portfolio Id
  ck += ',' + currentId;

  // We then want to save the cookie back
  document.cookie = 'readPortfolios=' + ck;
} 
```

这就是我们每页的内容。接下来，我们要查看主页上的列表以查看已访问过的页面。

假设您有一个如下所示的列表：

```
<ul id="myPortfolioList">
  <li id="data-id-1">Text One</li>
  <li id="data-id-2">Text Two</li>
  <li id="data-id-3">Text Three</li>
</ul> 
```

首先我需要我的 cookie 值，然后我想将这些值与我的列表项的 Id 值进行比较。

```
var values = get_cookie('readPortfolios').split(',')

$('#myPortfolioList li').each(function(){
  if ($.inArray(this.id, values) > -1) {
    console.info('Portfolio Item ' + this.id + ' has been visited.');
  }
}); 
```

# jquery - 使用 use_ajax 和 jQueryForm 进行变形

> ID：10825869
> 
> 赞同：1
> 
> 时间：2012-05-31T00:03:01.983
> 
> 标签：jquery, python, pyramid, deform

提交表单后，我正在使用 Deform 对其进行验证。如果验证失败，我将返回带有验证警告的相同表单，它正在替换旧表单。这在 AJAX 上运行良好，**第一次**。第一次之后，似乎Deform表单的提交按钮不再绑定。

当页面首次加载时，`deform_loaded === true`deform.callbacks 数组为空。但是，表单通过 ajax 正确提交。在第二次循环之后，deform.callbacks 现在包含 1 个将 my from 映射到回调的数组。但是，当我现在提交时，不使用 ajax 并且页面会刷新。

如何让更新后的表单`submit`像原始表单一样绑定`submit`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-02T09:58:13.680

为了使 ajax 表单工作，我必须在渲染表单后添加对变形.processCallbacks 方法的调用。我的 mako-template 文件的内容是：

```
${form | n}
<script type="text/javascript">
    deform.processCallbacks();
</script> 
```

因此，它首先呈现表单（有或没有错误），然后调用以处理所有表单字段上的回调。回调处理启用了提交表单的按钮。至少在变形 0.9.5 中有效。

这确实是一个老帖子，但我自己在一段时间前就在变形/ajax 上苦苦挣扎。我希望这可以帮助别人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T06:59:30.643

它似乎在[http://deformdemo.repoze.org/ajaxform/](http://deformdemo.repoze.org/ajaxform/)（变形演示）上运行良好。

然而，这已经两个月大了，所以也许你让它工作了吗？

# css - 如何在纯 CSS 中定义可变高度的粘性页脚？

> ID：10825879
> 
> 赞同：47
> 
> 时间：2012-05-31T00:04:14.063
> 
> 标签：css

这里要注意的关键是页脚的高度不会固定，但会随其内容而变化。

当我说“粘性页脚”时，我使用它的通用定义是“永远不会高于视口底部的页脚，但如果有足够的内容，它将被隐藏，直到用户滚动下到足够远的地方才能看到它。”</p>

另请注意，我不需要支持旧版浏览器。如果 CSS`display: table`和相关属性在这里有所帮助，它们是公平的游戏。

* * *

## 回答 #1

> 赞同：101
> 
> 时间：2014-10-25T00:18:44.227

这里的所有其他解决方案都已过时，要么使用 JavaScript，要么使用`table`hack。

随着[CSS flex 模型](http://philipwalton.github.io/solved-by-flexbox/)的出现，解决可变高度粘性页脚问题变得非常非常容易：虽然 Flexbox 主要以水平方向布局内容而闻名，但实际上对于垂直布局问题也同样适用。您所要做的就是将垂直部分包裹在一个弹性容器中，然后选择要扩展的部分。它们会自动占用容器中的所有可用空间。

请注意标记和 CSS 是多么简单。没有桌子黑客或任何东西。

[当今使用的 96% 以上的浏览器都支持](http://caniuse.com/#search=flex)flex 模型。

```
html, body {
  height: 100%;
  margin: 0; padding: 0;  /* to avoid scrollbars */
}

#wrapper {
  display: flex;  /* use the flex model */
  min-height: 100%;
  flex-direction: column;  /* learn more: http://philipwalton.github.io/solved-by-flexbox/demos/sticky-footer/ */
}

#header {
  background: yellow;
  height: 100px;  /* can be variable as well */
}

#body {
  flex: 1;
  border: 1px solid red;
}

#footer{
  background: lime;
}
```

```
<div id="wrapper">
  <div id="header">Title</div>
  <div id="body">Body</div>
  <div id="footer">
    Footer<br/>
    of<br/>
    variable<br/>
    height<br/>
  </div>
</div>
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-09-04T01:21:19.877

你完全可以在纯 CSS 中做到这一点。 [点击链接。](http://pixelsvsbytes.com/blog/2011/09/sticky-css-footers-the-flexible-way/)

这个概念使用`display: table-cell`组织你的页面部分而不是正常的`display: block`.

**HTML**

```
<body class="Frame">
    <header class="Row"><h1>Catchy header</h1></header>
    <section class="Row Expand"><h2>Awesome content</h2></section>
    <footer class="Row"><h3>Sticky footer</h3></footer>
</body> 
```

**CSS**

```
.Frame {
    display: table;
    table-layout: fixed;
    height: 100%;
    width: 100%;
}
.Row {
    display: table-row;
    height: 1px;
}
.Row.Expand {
    height: auto;
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-31T00:10:32.297

您可以将页脚粘贴到视口的底部，只需：

```
position: fixed;
bottom: 0; 
```

但是，即使有内容，它也会显示出来。

为防止这种情况，您将需要一些 JavaScript：

```
(window.onscroll = function() {
    var foot = document.getElementById('footer');
    foot.style.position = "static";
    if( foot.offsetTop < document.documentElement.scrollTop + document.body.scrollTop + document.documentElement.offsetHeight - foot.offsetHeight)
        foot.style.position = "fixed";
})(); 
```

（`(...)();`包装器使 onscroll 函数在页面加载时被调用一次，因为这也是必需的）
（上面的函数未经测试，但应该可以工作 - 如果没有，请告诉我，我将制作一个实际的测试页面）

# android - 来自数组列表的 Android ListAdapter

> ID：10825886
> 
> 赞同：2
> 
> 时间：2012-05-31T00:05:10.910
> 
> 标签：android, listview, listadapter

我的公司有一支送货卡车车队，他们希望将其视为： 1）在 Android 屏幕上半部分的地图上钉住；并且，2) 在同一屏幕的下半部分包含卡车和司机详细信息的 ListView。我有一个 Web 服务，它为我提供卡车的“名称”、它的标语（我们司机的昵称）和存储在名为“TruckArray”的 ArrayList 中的地理位置。我在 FrameLayout 中创建了一个带有 mapview 和 listview 的 main.xml 布局，扩展了 MapView 类，获取了地理位置并创建了一个地图叠加层来显示每辆卡车的位置。我的屏幕正确显示了地图和卡车位置（如果我在下面注释掉对 ListAdapter 的调用）。

您可以为这个 Android 新手提供任何帮助将不胜感激！

我对初始化 ListView 的调用是：

```
public void initList() {

    listView = null;
    ListView listView = (ListView) findViewById(R.id.mylist);
    adapter = new TruckAdapter(this, R.id.mylist, TruckArray);
    listView.setAdapter(adapter);  // If I comment out this line, the map appears.  If I uncomment it, the whole app force closes before the map is drawn.
} 
```

我的卡车适配器是：

```
public class TruckAdapter extends ArrayAdapter<Truck> {

    private ArrayList<Truck> trucks;
    private Context context;

    public TruckAdapter(Context context, int textViewResourceId, ArrayList<Truck> objects){
        super(context, textViewResourceId, objects);
        this.trucks = objects;
    }

    public View getView(int position, View convertView, ViewGroup parent){
        View view = convertView;

        if (view == null) {
            LayoutInflater viewInflater = (LayoutInflater) context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
            view = viewInflater.inflate(R.layout.row, null);
        }

        Truck truck = trucks.get(position);

        if (truck != null) {
            TextView name = (TextView) view.findViewById(R.id.name);
            TextView slogan = (TextView) view.findViewById(R.id.slogan);

            if (name != null) {
                name.setText(truck.name);
            }

            if (slogan != null){
                slogan.setText(truck.slogan);
            }
        }
        return view;
    }
} 
```

我的 ROW.XML 文件是：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
  android:layout_width="match_parent"
  android:layout_height="wrap_content"
  android:orientation="horizontal"
  android:padding="4dip"
  >
  <LinearLayout
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:orientation="vertical"
    > 
    <TextView android:id="@+id/name"
      android:layout_width="match_parent"
      android:layout_height="wrap_content"
      android:layout_weight="1"
      android:gravity="center_vertical"
      android:textStyle="bold"
      android:maxLines="1"
      android:ellipsize="end"
    />
    <TextView android:id="@+id/slogan"
      android:layout_width="match_parent"
      android:layout_height="wrap_content"
      android:layout_weight="1"
      android:gravity="center_vertical"
      android:maxLines="1"
      android:ellipsize="end"
    />
      </LinearLayout>
    </LinearLayout> 
```

我的 MAIN.XML 文件是：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:orientation="vertical"
android:weightSum="2" >

    <FrameLayout    android:id="@+id/mapContainer"
                    android:layout_width="match_parent"
                    android:layout_height="0dp"
                    android:layout_weight="1" >

                    <com.google.android.maps.MapView
                            xmlns:android="http://schemas.android.com/apk/res/android"
                            android:id="@+id/map"
                            android:layout_width="wrap_content"
                            android:layout_height="wrap_content"
                            android:apiKey="my APIkey is here..."
                            android:clickable="true" />
    </FrameLayout>

    <FrameLayout    android:layout_width="match_parent"
            android:layout_height="0dp"
            xmlns:android="http://schemas.android.com/apk/res/android"
            android:layout_weight="1" >
    <ListView   android:id="@+id/mylist"
                android:layout_width="match_parent"
                android:layout_height="match_parent"
                android:background="#000000"
                android:gravity="center_horizontal" />
    </FrameLayout>

</LinearLayout> 
```

我的崩溃日志是：

```
05-30 20:17:49.754: W/CursorWrapperInner(30659): Cursor finalized without prior close()
05-30 20:17:49.965: D/dalvikvm(30659): GC_CONCURRENT freed 717K, 48% free 3783K/7175K, external 2357K/2773K, paused 2ms+3ms
05-30 20:17:50.035: D/dalvikvm(30659): GC_EXTERNAL_ALLOC freed 528K, 52% free 3447K/7175K, external 2757K/2773K, paused 34ms
05-30 20:17:50.105: D/AndroidRuntime(30659): Shutting down VM
05-30 20:17:50.105: W/dalvikvm(30659): threadid=1: thread exiting with uncaught exception (group=0x40018560)
05-30 20:17:50.105: E/AndroidRuntime(30659): FATAL EXCEPTION: main
05-30 20:17:50.105: E/AndroidRuntime(30659): java.lang.NullPointerException
05-30 20:17:50.105: E/AndroidRuntime(30659):    at com.deltruck.DlvrTruckMain$TruckAdapter.getView(DlvrTruckMain.java:273)
05-30 20:17:50.105: E/AndroidRuntime(30659):    at android.widget.AbsListView.obtainView(AbsListView.java:1456)
05-30 20:17:50.105: E/AndroidRuntime(30659):    at android.widget.ListView.makeAndAddView(ListView.java:1821)
05-30 20:17:50.105: E/AndroidRuntime(30659):    at android.widget.ListView.fillDown(ListView.java:686)
05-30 20:17:50.105: E/AndroidRuntime(30659):    at android.widget.ListView.fillFromTop(ListView.java:754)
05-30 20:17:50.105: E/AndroidRuntime(30659):    at android.widget.ListView.layoutChildren(ListView.java:1670)
05-30 20:17:50.105: E/AndroidRuntime(30659):    at android.widget.AbsListView.onLayout(AbsListView.java:1286)
05-30 20:17:50.105: E/AndroidRuntime(30659):    at android.view.View.layout(View.java:7184)
05-30 20:17:50.105: E/AndroidRuntime(30659):    at android.widget.FrameLayout.onLayout(FrameLayout.java:338)
05-30 20:17:50.105: E/AndroidRuntime(30659):    at android.view.View.layout(View.java:7184)
05-30 20:17:50.105: E/AndroidRuntime(30659):    at android.widget.LinearLayout.setChildFrame(LinearLayout.java:1254)
05-30 20:17:50.105: E/AndroidRuntime(30659):    at android.widget.LinearLayout.layoutVertical(LinearLayout.java:1130)
05-30 20:17:50.105: E/AndroidRuntime(30659):    at android.widget.LinearLayout.onLayout(LinearLayout.java:1047)
05-30 20:17:50.105: E/AndroidRuntime(30659):    at android.view.View.layout(View.java:7184)
05-30 20:17:50.105: E/AndroidRuntime(30659):    at android.widget.FrameLayout.onLayout(FrameLayout.java:338)
05-30 20:17:50.105: E/AndroidRuntime(30659):    at android.view.View.layout(View.java:7184)
05-30 20:17:50.105: E/AndroidRuntime(30659):    at android.widget.LinearLayout.setChildFrame(LinearLayout.java:1254)
05-30 20:17:50.105: E/AndroidRuntime(30659):    at android.widget.LinearLayout.layoutVertical(LinearLayout.java:1130)
05-30 20:17:50.105: E/AndroidRuntime(30659):    at android.widget.LinearLayout.onLayout(LinearLayout.java:1047)
05-30 20:17:50.105: E/AndroidRuntime(30659):    at android.view.View.layout(View.java:7184)
05-30 20:17:50.105: E/AndroidRuntime(30659):    at android.widget.FrameLayout.onLayout(FrameLayout.java:338)
05-30 20:17:50.105: E/AndroidRuntime(30659):    at android.view.View.layout(View.java:7184)
05-30 20:17:50.105: E/AndroidRuntime(30659):    at android.view.ViewRoot.performTraversals(ViewRoot.java:1140)
05-30 20:17:50.105: E/AndroidRuntime(30659):    at android.view.ViewRoot.handleMessage(ViewRoot.java:1859)
05-30 20:17:50.105: E/AndroidRuntime(30659):    at android.os.Handler.dispatchMessage(Handler.java:99)
05-30 20:17:50.105: E/AndroidRuntime(30659):    at android.os.Looper.loop(Looper.java:130)
05-30 20:17:50.105: E/AndroidRuntime(30659):    at android.app.ActivityThread.main(ActivityThread.java:3806)
05-30 20:17:50.105: E/AndroidRuntime(30659):    at java.lang.reflect.Method.invokeNative(Native Method)
05-30 20:17:50.105: E/AndroidRuntime(30659):    at java.lang.reflect.Method.invoke(Method.java:507)
05-30 20:17:50.105: E/AndroidRuntime(30659):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
05-30 20:17:50.105: E/AndroidRuntime(30659):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
05-30 20:17:50.105: E/AndroidRuntime(30659):    at dalvik.system.NativeStart.main(Native Method)
05-30 20:17:53.238: I/Process(30659): Sending signal. PID: 30659 SIG: 9 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-31T00:47:46.073

首先..我们可以从堆栈跟踪中看到问题出在适配器的第 273 行，在您的 getView() 方法中。但是我们不知道第 273 行是哪一行……如果您能告诉我们那一行是什么代码，那就太好了：)

现在，回到问题。

```
LayoutInflater viewInflater = (LayoutInflater) context.getSystemService(Context.LAYOUT_INFLATER_SERVICE); 
```

此上下文为空；）您将其作为成员变量，但从不初始化它。

**编辑：** 您不必将 ArrayList 存储为成员。对超级构造函数的调用会解决这个问题，您可以使用 getItem(int position) 从 ArrayList 中获取项目

# javascript - 不能在 jquery 中定义函数？... 不明确的

> ID：10825888
> 
> 赞同：0
> 
> 时间：2012-05-31T00:05:47.487
> 
> 标签：javascript, jquery

我正在尝试做一些我认为很简单的事情，但我需要一些帮助。

在 jquery 函数中，我想设置一个计时器并将其从另一个函数中清除....

```
(function($){

var mnuTimer;
var mnuDown;

$('.nav-menu .parent').hover(function(){
    clearTimeout(mnuTimer);//clear function
    $(this).children('.children').slideDown();
    $(this).css('background-color','#fff0c8');
},
function(){
    function mnuDown(){//set function for timer experation
      $(this).children('.children').slideUp('fast');
      $(this).css('background-color','transparent');
      }
    mnuTimer = setTimeout("mnuDown()",1000)//timer
});

})(jQuery); 
```

所以我唯一不能工作的部分是计时器。“mnuDown”函数出现未定义。我已经尝试了很多不同的方法来使它工作，除了在 jquery“（function（$）{”之外声明函数之外似乎没有什么是正确的。这不起作用，因为我使用 jquery 的全部原因是应用在 jquery 之外不可用的 slideUp 动画。AHHH 帮助，谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T00:08:12.257

> 只是重复[这个答案](https://stackoverflow.com/a/10809791/1048572)：

是的，不是函数的声明是问题，而是引用它的[变量]：你没有。相反，`setTimeout("mnuDown()",1000)`将在全局范围内评估该*代码字符串*`mnuDown`-在那里找不到。您需要将函数引用传递给[`setTimout()`](https://developer.mozilla.org/en/DOM/window.setTimeout)：

```
mnuTimer = setTimeout(mnuDown,1000); //timer 
```

# visual-studio-2010 - 为什么 Visual Studio 会在每个不同的用户会话中破坏 System.Net.Socket？

> ID：10825893
> 
> 赞同：1
> 
> 时间：2012-05-31T00:06:31.957
> 
> 标签：visual-studio-2010, visual-studio, sockets, system.net.sockets

我知道我没有正常的设置，但这里是：

我在计算机实验室工作，计算机使用 Deep Freeze 和

每次登录Windows 7，相信每次登录都会初始化；注销后不保留用户设置。

1.  我在 Visual Studio 2010 Professional 中创建了一个新的 C# 4.0 控制台应用程序项目。

2.  我粘贴以下代码：

    ```
    using System.Net.Sockets;

    namespace ConsoleApplication1
    {
        class Program
        {
            static void Main(string[] args)
            {
                Socket sock = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);
            }
        }
    } 
    ```

3.  Ctrl+Shift+S

4.  F5; 它运行并终止，没有任何错误。

5.  我注销 Windows 并再次登录。

6.  在 Visual Studio 2010 Professional 中打开项目。

7.  F5; 参数例外： http: [//pastebin.com/pSju1p76](http://pastebin.com/pSju1p76)

    ```
    System.Net.Sockets.SocketException was unhandled
      Message=An invalid argument was supplied
      Source=System
      ErrorCode=10022
      NativeErrorCode=10022 
    ```

这是怎么回事？

# java - DUKPT 使用 Java 实现过程以及如何将十六进制字符串转换为 DES 密钥（ByteArray）

> ID：10825894
> 
> 赞同：5
> 
> 时间：2012-05-31T00:06:45.000
> 
> 标签：java, encryption, tripledes

我正在尝试实现 VISA DUKPT 算法以从事务 KSN 生成每个事务的唯一密钥。我已逐步遵循 ANS X9.24-1:2009 提供的信息，但我得到的 IPEK 与示例中提供的不同。对于加密/解密/加密，我使用的是充气城堡 API。示例中提供的密钥 (BDK) 是 0123456789ABCDEFFEDCBA9876543210 我知道这是双重加密密钥长度，这意味着

*   key1（加密DES）= 0123456789ABCDEF
*   key2（解密 DES）= FEDCBA9876543210
*   key3（加密DES）=key1=0123456789ABCDEF

我知道在使用 DES 时，您只能使用 8 字节密钥，以便将 16 个十六进制字符串转换为 8 字节数组。（我怀疑我是否在这里做某事。我从教程中得到这部分代码）

```
public byte[] hexStringToByteArray(String hexstring) {
        int i = 0;
        if (hexstring == null || hexstring.length() <= 0) {
            return null;
        }
        String stringvector = "0123456789ABCDEF";
        byte[] bytevector = {0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
                             0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F};
        byte[] out = new byte[hexstring.length() / 2];
        while (i < hexstring.length() - 1) {
            byte ch = 0x00;
            //Convert high nibble charater to a hex byte
            ch = (byte) (ch | bytevector[stringvector.indexOf(hexstring.charAt(i))]);
            ch = (byte) (ch << 4); //move this to the high bit

            //Convert the low nibble to a hexbyte
            ch = (byte) (ch | bytevector[stringvector.indexOf(hexstring.charAt(i + 1))]); //next hex value
            out[i / 2] = ch;
            i++;
            i++;
        }
        return out;
    } 
```

这是我目前唯一有疑问的部分（如何将十六进制字符串转换为 Java 中的 DES 密钥（ByteArray））。对于 TripleDES 的实现，我正在使用充气城堡。

IPEK的计算过程描述如下：

从基本派生密钥 (BDK) 派生初始密钥 (IPEK)。

初始 PIN 输入设备密钥（最初加载到 PIN 输入设备中的密钥）由以下过程生成：

*   将整个密钥序列号，包括 21 位加密计数器，右对齐复制到 10 字节寄存器中。如果密钥序列号小于 10 个字节，则在左侧填充十六进制“FF”字节。
*   将此 10 字节寄存器的 21 个最低有效位设置为零。
*   取这个 10 字节寄存器的 8 个最高有效字节，并使用双长派生密钥对这 8 个字节进行加密/解密/加密。使用步骤 3 生成的密文作为 Initial Key 的左半部分。
*   从步骤 2 的 10 字节寄存器中取出 8 个最高有效字节，并使用与十六进制 C0C0 C0C0 0000 0000 C0C0 C0C0 0000 0000 异或的双长度派生密钥作为密钥对这 8 个字节进行加密/解密/加密。
*   使用第 5 步产生的密文作为 Initial Key 的右半部分。

我逐字逐句地按照前面的解释，我得到了钥匙的左半部分

67450505DF3A84FF

根据标准的期望值为

6AC292FAA1315B4D

提供的 KSN 为 9876543210E00000

在开始加密/解密/加密之前按照步骤 1-3 之后，要处理的文本是：FFFF9876543210E0

我的 TripleDES 实现是：

```
import java.io.UnsupportedEncodingException;
import java.security.*;
import javax.crypto.*;
import javax.crypto.spec.IvParameterSpec;
import javax.crypto.spec.SecretKeySpec;
import org.bouncycastle.jce.provider.BouncyCastleProvider;
import org.bouncycastle.util.encoders.Hex;

/**
 *
 * @author aealvarenga
 */
public class TripleDesCipherFromDES {

    public byte[] desEncryptionECBCipher(String key, String text) throws NoSuchAlgorithmException, NoSuchProviderException, NoSuchPaddingException, InvalidKeyException, UnsupportedEncodingException, IllegalBlockSizeException, BadPaddingException {
        Security.addProvider(new BouncyCastleProvider());        
        SecretKey keySpec = new SecretKeySpec(this.hexStringToByteArray(key), "DES");
        final Cipher encrypter = Cipher.getInstance("DES/ECB/ZeroBytePadding", "BC");
        encrypter.init(Cipher.ENCRYPT_MODE, keySpec);
        final byte[] plainTextBytes = text.getBytes("utf-8");
        final byte[] cipherText = encrypter.doFinal(plainTextBytes);
        return cipherText;
    }

    public String desDecriptionECBCipher(String key, byte[] cipherText) throws NoSuchAlgorithmException, NoSuchProviderException, NoSuchPaddingException, InvalidKeyException, IllegalBlockSizeException, UnsupportedEncodingException, BadPaddingException {
        Security.addProvider(new BouncyCastleProvider());
        SecretKey keySpec = new SecretKeySpec(this.hexStringToByteArray(key), "DES");
        final Cipher decrypter = Cipher.getInstance("DES/ECB/ZeroBytePadding", "BC");        
        decrypter.init(Cipher.DECRYPT_MODE, keySpec);
        final byte[] plainText = decrypter.doFinal(cipherText);
        return new String(plainText, "UTF-8");
    }

    public byte[] desEncryptionCBCCipher(String key, String text) throws NoSuchAlgorithmException, NoSuchProviderException, NoSuchPaddingException, InvalidKeyException, UnsupportedEncodingException, IllegalBlockSizeException, BadPaddingException, InvalidAlgorithmParameterException {
        Security.addProvider(new BouncyCastleProvider());
        byte[] iv = new byte[]{0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00};
        IvParameterSpec ivSpec = new IvParameterSpec(iv);

        SecretKey keySpec = new SecretKeySpec(this.hexStringToByteArray(key), "DES");
        final Cipher encrypter = Cipher.getInstance("DES/CBC/ZeroBytePadding", "BC");
        encrypter.init(Cipher.ENCRYPT_MODE, keySpec,ivSpec);
        final byte[] plainTextBytes = text.getBytes("utf-8");
        final byte[] cipherText = encrypter.doFinal(plainTextBytes);
        return cipherText;
    }    

    public String desDecriptionCBCCipher(String key, byte[] cipherText) throws NoSuchAlgorithmException, NoSuchProviderException, NoSuchPaddingException, InvalidKeyException, IllegalBlockSizeException, UnsupportedEncodingException, BadPaddingException, InvalidAlgorithmParameterException {
        Security.addProvider(new BouncyCastleProvider());
        byte[] iv = new byte[]{0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00};
        IvParameterSpec ivSpec = new IvParameterSpec(iv);        
        SecretKey keySpec = new SecretKeySpec(this.hexStringToByteArray(key), "DES");
        final Cipher decrypter = Cipher.getInstance("DES/CBC/ZeroBytePadding", "BC");        
        decrypter.init(Cipher.DECRYPT_MODE, keySpec,ivSpec);
        final byte[] plainText = decrypter.doFinal(cipherText);
        return new String(plainText, "UTF-8");
    }

    public String asciiToHex(String ascii) {
        StringBuilder hex = new StringBuilder();
        for (int i = 0; i < ascii.length(); i++) {
            hex.append(Integer.toHexString(ascii.charAt(i)));
        }
        return hex.toString();
    }

    public byte[] hexStringToByteArray(String hexstring) {
        int i = 0;
        if (hexstring == null || hexstring.length() <= 0) {
            return null;
        }
        String stringvector = "0123456789ABCDEF";
        byte[] bytevector = {0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F};
        byte[] out = new byte[hexstring.length() / 2];
        while (i < hexstring.length() - 1) {
            byte ch = 0x00;
            //Convert high nibble charater to a hex byte
            ch = (byte) (ch | bytevector[stringvector.indexOf(hexstring.charAt(i))]);
            ch = (byte) (ch << 4); //move this to the high bit

            //Convert the low nibble to a hexbyte
            ch = (byte) (ch | bytevector[stringvector.indexOf(hexstring.charAt(i + 1))]); //next hex value
            out[i / 2] = ch;
            i++;
            i++;
        }
        return out;
    }    

    public String tdesedeECBCipher(String text, String doubleLenghtKey) throws NoSuchAlgorithmException, NoSuchProviderException, NoSuchPaddingException, InvalidKeyException, UnsupportedEncodingException, IllegalBlockSizeException, BadPaddingException {
        //key definition
        String key1 = doubleLenghtKey.substring(0, 16);
        String key2 = doubleLenghtKey.substring(16, 32);
        String key3 = key1;

        byte[] codedText = new TripleDesCipherFromDES().desEncryptionECBCipher(key1, text);
        String decodedText = new TripleDesCipherFromDES().desDecriptionECBCipher(key2, codedText);
        byte[] codedTextFinal = new TripleDesCipherFromDES().desEncryptionECBCipher(key3, decodedText);

      return new String(Hex.encode(codedTextFinal));
    }

    public String tdesedeCBCCipher(String text, String doubleLenghtKey) throws NoSuchAlgorithmException, NoSuchProviderException, NoSuchPaddingException, InvalidKeyException, UnsupportedEncodingException, IllegalBlockSizeException, BadPaddingException, InvalidAlgorithmParameterException {
        //key definition
        String key1 = doubleLenghtKey.substring(0, 16);
        String key2 = doubleLenghtKey.substring(16, 32);
        String key3 = key1;

        byte[] codedText = new TripleDesCipherFromDES().desEncryptionCBCCipher(key1, text);
        String decodedText = new TripleDesCipherFromDES().desDecriptionCBCCipher(key2, codedText);
        byte[] codedTextFinal = new TripleDesCipherFromDES().desEncryptionCBCCipher(key3, decodedText);

       return new String(Hex.encode(codedTextFinal));
    }    

    public static void main(String[] args) throws Exception {
        String text = "FFFF9876543210E0";        
        String key =  "0123456789ABCDEFFEDCBA9876543210";

        System.out.println(new TripleDesCipherFromDES().tdesedeECBCipher(text,key));
        System.out.println(new TripleDesCipherFromDES().tdesedeCBCCipher(text,key));
    }
} 
```

如您所见，我尝试使用 ECB 模式作为标准推荐以及 CBC 模式，IV 为 00000000，但这两种方法似乎都不起作用。

请我需要一个建议。

# java - 谷歌天气 api，读取 xml 的问题

> ID：10825899
> 
> 赞同：0
> 
> 时间：2012-05-31T00:07:20.120
> 
> 标签：java, xml, scala, urlconnection

我正在使用 scala 从谷歌的天气 api 读取 xml：

```
val response = new URL("http://www.google.com/ig/api?weather=MyCity").openStream()
var respXML = response.read()
println(respXML) 
```

但是当我运行它时会`println`打印一个数字：`60`而不是实际的 xml，我已经使用该`curl`实用程序尝试过它并且它工作正常，请原谅我的无知，但我是 java 的网络类的新手，据我从教程中知道这应该可以工作.

这是所有相关代码，仅此而已。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T02:52:52.363

如果你使用 Scala，scala.io.Source 是你的好朋友。

```
import scala.io.Source
import scala.xml.XML
import java.net.URL

val source = Source.fromURL(new URL("http://www.google.com/ig/api?weather=MyCity"))
val xmlString = source.mkString  // Raw XML String
val xml = XML.loadString(xmlString)  // Scala XML object 
```

# javascript - 使用 jQuery 更改元素 ID 后，谷歌地图无法加载

> ID：10825906
> 
> 赞同：0
> 
> 时间：2012-05-31T00:08:15.330
> 
> 标签：javascript, jquery, google-maps

我正在尝试将谷歌地图加载到 div 中。因为我有不确定数量的这些 DIV，每个 DIV 都必须加载一个独立的地图，所以我想对 DIV 类进行 jQuery 搜索，然后更改找到的元素的 ID 以使其唯一。这工作正常。但是，当我尝试将地图加载到每个 DIV 中时，它无法加载。这是我的代码：

```
function gmapEditor(mapobj) {

    var mapdivid = jQuery(mapobj).attr("id");
    var mapopts = {
        center: new google.maps.LatLng(51.520707, -0.006866),
        zoom: 9,
        mapTypeId: google.maps.MapTypeId.ROADMAP,
        mapTypeControl: false,
        zoomControl: false,
        panControl: false,
        streetViewControl: false,
        labels: true
    };

    initmap();

    console.log(mapdivid); // -> 'ell-gmap-kml-mapdiv-11740'
    console.log(mapobj);

    function initmap() {
        //jQuery(mapdivid)[0]
        gmap = new google.maps.Map(document.getElementById(mapdivid), mapopts);
        //gmap = new google.maps.Map(mapobj[0], mapopts);
        mapcenter = gmap.getCenter();
    }
}
jQuery(document).ready(function () {

    // Create array to hold map editor instances
    var maps = new Array();

    jQuery(".ell-gmap-kml-mapdiv").each(function (i) {
        // Add prefix to map div ID
        var newid = jQuery(this).attr("id") + '-' + jQuery(this).data("post_id");
        jQuery(this).attr("id", newid);

        // Instantiate new map editor object and add to array
        maps[i] = new gmapEditor(jQuery(this));
    });
}); 
```

（不知道为什么代码格式搞砸了）。如您所见，我正在为每个 DIV 创建一个独立的“gmapEditor”对象实例，该 DIV 具有 jQuery 找到的“ell-gmap-kml-mapdiv”类。

如果我注释掉更改地图 DIV 的 ID 的代码，地图就会加载。问题是，由于每个 DIV 不再有唯一的 ID，所有地图都将具有相同的设置。

我添加了几个控制台转储。重新启用 ID 更改代码后，我得到了“mapdivid”的预期值。有趣的是，我还从日志中看到，已将大量子元素添加到 mapobj DIV 中，因此某处正在工作。Maps API 并非完全无法获取地图 DIV 的句柄，但它也无法在那里显示任何内容。如果我在 Safari 中执行“检查元素”，我什至可以看到这些额外的元素，但在实际页面上，地图是不可见的。

任何人都知道可能出了什么问题，如果可能的话，我该如何解决？也许我完全走错了路……

顺便说一句，我在 Mac 上的 Safari、FireFox 和 Chrome 中尝试过这个，每次都得到相同的结果。

非常感谢任何建议。

编辑：

工作中。我不知道为什么它以前不起作用，但这是工作代码：

```
function gmapEditor(mapobj) {

var mapdivid = jQuery(mapobj).attr("id");   
var mapopts = {
        center: new google.maps.LatLng(51.520707, -0.006866),
        zoom: 9,
        mapTypeId: google.maps.MapTypeId.ROADMAP,
        mapTypeControl: false,
        zoomControl: false,
        panControl: false,
        streetViewControl: false,
        labels: true
};

initmap();

console.log(mapdivid);
console.log(mapobj);

function initmap() {
    gmap = new google.maps.Map(mapobj[0], mapopts); 
    mapcenter = gmap.getCenter();
}   
}

jQuery(document).ready(function() {

// Create array to hold map editor instances
var maps = new Array();

jQuery(".ell-gmap-kml-mapdiv").each(function(i) {
    // Add suffix to map div ID
    //var postid = jQuery(this).data("post_id");
    //var newid = jQuery(this).attr("id") + '-' + jQuery(this).data("post_id");
    var newid = jQuery(this).attr("id") + '-' + i;
    jQuery(this).attr("id", newid);

    // Instantiate new map editor object and add to array
    maps[i] = new gmapEditor(jQuery(this));
});
}); 
```

我决定简单地在 ID 上添加一个索引，而不是像以前那样使用元素的数据属性，但我也能够让它以这种方式工作。

# jquery - 构建 jQuery 无法缩小并出现错误“/bin/sh: line 0: test: /usr/bin/node: binary operator expected”，但 NodeJS 安装在 /usr/bin/node

> ID：10825907
> 
> 赞同：0
> 
> 时间：2012-05-31T00:08:16.623
> 
> 标签：jquery, node.js, makefile

我正在尝试[从 source 构建 jQuery](https://github.com/jquery/jquery/blob/master/README.md#how-to-build-your-own-jquery)，但遇到了一个奇怪的问题。

我可以构建未缩小的版本，但是当它尝试缩小 js 文件时，出现以下错误：

```
> 制作
...
构建 ./dist/jquery.js
/bin/sh：第 0 行：测试：/usr/bin/node：预期二进制运算符
您必须安装 NodeJS 才能缩小 jQuery。
/bin/sh：第 0 行：测试：/usr/bin/node：预期二进制运算符
您必须安装 NodeJS 才能针对 JSHint 测试 jQuery。
/bin/sh：第 0 行：测试：/usr/bin/node：预期二进制运算符
您必须安装 NodeJS 才能调整 jQuery 的大小。

```

不过，奇怪的是 NodeJS**安装**在`/usr/bin/node`. 这里发生了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T00:08:16.937

检查产生错误的行之一：

```
@@if test ! -z ${JS_ENGINE}; then \ 
```

这`${JS_ENGINE}`是在顶部定义的位置`Makefile`：

```
JS_ENGINE ?= `which node nodejs 2>/dev/null` 
```

如果我在我的系统上运行该命令，这就是我得到的：

```
> 哪个节点 nodejs 2>/dev/null
/usr/bin/节点
/usr/bin/nodejs

```

请注意，输出包含 2 行，而不是 1！

`${JS_ENGINE}`要解决此问题，请在调用时覆盖该属性，`make`如下所示：

```
make JS_ENGINE=`哪个节点nodejs 2>/dev/null | 头-n 1`

```

# c# - 在 Rails ActionController 类中找到的类似 around_filter 的 C# 等价物是什么？

> ID：10825909
> 
> 赞同：2
> 
> 时间：2012-05-31T00:08:38.310
> 
> 标签：c#, ruby-on-rails, filter

我继承了一些遗留代码，其中每个方法都带有：

```
Method()
{
   Log("Entering");
   ...
   Log("Exiting");
} 
```

那类的东西。这很丑陋，确实重复了大约一千次。有没有办法像 Rails 中的那样添加一个全局“around_filter”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T01:11:40.987

另一种选择是设置一个 Logger 类。就像是：

```
public static class Logger
{
    public static void Invoke(Delegate del, params object[] args)
    {
        Console.WriteLine("Entering");
        del.DynamicInvoke(args);
        Console.WriteLine("Exiting");
    }

    public static T Invoke<T>(Delegate del, params object[] args)
    {
        Console.WriteLine("Entering");
        T rv = (T)del.DynamicInvoke(args);
        Console.WriteLine("Exiting");
        return rv;
    }
} 
```

然后你可以像这样使用它：

```
static void Main(string[] args)
{
    Logger.Invoke(new Action<int>(CountTo), 10);
    Console.WriteLine("5 * 2 = {0}", Logger.Invoke<int>(new Func<int, int>(TwiceAsBig), 5));
}

static void CountTo(int num)
{
    for (int i = 1; i <= num; ++i)
        Console.WriteLine(i);
}

static int TwiceAsBig(int num)
{
    return num * 2;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T00:22:04.960

这可以通过[面向方面的编程通过诸如](http://en.wikipedia.org/wiki/Aspect-oriented_programming)[PostSharp](http://www.sharpcrafters.com/)之类的方面编织工具来完成。对于 PostSharp，[OnMethodBoundaryAspect](http://www.sharpcrafters.com/postsharp/features)提供了这种类型的功能。

# xml - 使用 flex 4 列表和多选进行 2 路数据绑定

> ID：10825911
> 
> 赞同：0
> 
> 时间：2012-05-31T00:08:58.527
> 
> 标签：xml, actionscript-3, flex4

如果我有一些 xml，例如如下所示的语言列表：

```
<otherLanguages>
<language code="fr" localName="Français" englishName="French" lastModified="5/30/2012 2:42:18 PM" whenCreated="5/30/2012 2:42:18 PM" baseId="2809988" included="false"/>
<language baseId="2809989" lastModified="5/30/2012 2:44:57 PM" whenCreated="5/30/2012 2:44:57 PM" englishName="Spanish" localName="Español" code="es" included="false"/>
</otherLanguages> 
```

我想将它绑定到一个火花多选列表，我怎样才能使项目选择值绑定到 xml 元素的包含属性？此外，如果它被取消选择，它如何自动将此值从 true 切换为 false？

感谢您的任何提示！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T11:14:48.783

将 xml 作为 XMLListCollection 提供给列表。然后单击处理 selectedItems。请阅读下面给出的代码片段，它可能会有所帮助

```
<mx:Application xmlns:mx=”http://www.adobe.com/2006/mxml”
layout=”absolute”
creationComplete=”init()”&gt;
<mx:Script>
<![CDATA[
import mx.collections.ArrayCollection;

[Bindable]
var selectedArr : ArrayCollection;

public function init() : void
{
selectedArr = new ArrayCollection();

list.selectedItems = selectedArr.toArray();
}

public function selected(event:Event) : void
{
var selected : String = arr.getItemAt(event.currentTarget.selectedIndex).toString();
if(!selectedArr.contains(selected))
{
selectedArr.addItem(selected);
}
else
{
selectedArr.removeItemAt(selectedArr.getItemIndex(selected));
}
list.selectedItems = selectedArr.toArray();
}
]]>
</mx:Script>
<mx:List     id=”list”
x=”251?
y=”77?
dataProvider=”{arr}”
width=”356?
click=”selected(event)”
allowMultipleSelection=”true”&gt;</mx:List>
</mx:Application> 
```

# delphi - TMS AdvSmoothMenu1 项目点击

> ID：10825912
> 
> 赞同：0
> 
> 时间：2012-05-31T00:09:01.150
> 
> 标签：delphi, delphi-xe2, delphi-xe

似乎 AdvSmoothMenu1 没有 itemindex 属性。我正在尝试做：

```
case AdvSmoothMenu1.ItemIndex of 
0: begin 
```

...但似乎没有这样的选择。那么我如何告诉我的应用程序在不同的项目 click 上做什么呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T00:33:40.467

使用`TAdvSmoothMenu.OnItemClick`事件：

```
procedure TForm1.AdvSmoothMenu1ItemClick(Sender: TObject; 
  ItemIndex: Integer);
begin
  case ItemIndex of
    0: HandleItemZeroClick;
    1: HandleItemOneClick;
  end;
end; 
```

# hex - 这些十六进制值是如何变成这样的？

> ID：10825913
> 
> 赞同：0
> 
> 时间：2012-05-31T00:09:20.300
> 
> 标签：hex

我对成为这些值的一些十六进制值感到非常困惑。我一直在玩弄这些值，但我无法弄清楚。也许这里有人可以给我一个线索，说明这些值如何显示为十六进制或反之亦然。当我得到这些值时，它们是十六进制的倒序。我从左到右对它们进行排序以使事情变得更简单（我 99% 确信这些值应该是相反的顺序，因为我得到的其他值是相反的顺序）。

*   6C C4 F0 00 应成为日期/时间格式的 1/1/2000。
*   6C C4 F0 38 也应该是 2000 年 1 月 1 日，但我不确定这是怎么回事。
*   FF FF FE 38 应该是-2。
*   00 FF FF FF 应为 0。
*   FF 00 00 00 应该是-1。

如果有人可以帮助我解决这个问题，我将不胜感激！谢谢！

原始数据：

00F0C46C38F0C46C38FEFFFFFFFDFFFF

原始数据以 4 个字节为一组以十六进制倒序排列。

*   00F0C46C，应该是 2000 年 1 月 1 日的日期/时间格式
*   38F0C46C，应为 2000 年 1 月 1 日的日期/时间格式
*   38FEFFFF，应该是-2
*   FFFDFFFF，应该是-3

我知道结构是正确的，因为程序正在工作并正确创建表，每列中只有一些值的处理方式不同。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-31T02:11:25.427

您的字节顺序错误。第一个字节似乎是死空间或以其他方式被占用，我打赌你离开`FF`了你向我们展示的内容。

拆分成单词：

```
00  F0C46C38 F0C46C38 FEFFFFFF FDFFFF 
```

现在，颠倒前两个字的字节顺序，你会得到：

```
0x386CC4F0 = 946652400 
```

哪个是

```
$ date -ur 946652400
Fri Dec 31 15:00:00 UTC 1999 
```

[所以UTC+9 时区](http://en.wikipedia.org/wiki/UTC+9)的 2000 年 1 月 1 日午夜。太接近了，不可能是巧合，我猜你或者你从哪里获得数据的地方都在那个时区。

现在，以正确的字节顺序排列接下来的两个字：

```
FFFFFFFE
FFFFFFFD 
```

你猜怎么着？[-2 和 -3的二进制补码](http://en.wikipedia.org/wiki/Two%27s_complement)表示。

# c# - 为什么找不到或打开我的文件？

> ID：10825915
> 
> 赞同：0
> 
> 时间：2012-05-31T00:09:47.060
> 
> 标签：c#, winforms, file-io, nullreferenceexception

我在 \bin\Debug 文件夹中添加了一个 .txt 文件，并尝试像这样打开它并从中读取：

```
using (StreamReader reader = File.OpenText("Credentials.txt")) {
    string line = null;
    do {
        line = reader.ReadLine();
        if (line.Contains("host=")) {
    . . . 
```

但是，尽管文件在那里，但当我到达“ReadLine()”行时，它会停止在其轨道上，并显示：

*System.NullReferenceException 未处理 Message=Object 引用未设置为对象的实例。*

## 更新

我不得不把它从“ `do...while (line != null);`”改成“ `while (! reader.EndOfStream)`”

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-31T00:14:53.677

那没有意义。我不知道任何`File.OpenText`成功返回且返回值为`null`. 如果`File.OpenText`找不到文件，它会抛出一个`FileNotFoundException`.

您确定您声明的那一行实际上是引发异常的那一行吗？请仔细检查堆栈跟踪。

请注意，您的循环顺序错误。您正在调用`StreamReader.ReadLine`然后检查该行是否包含“host=”。但可能是您已到达流的末尾，在这种情况下`line`将为 null 并且您将抛出。重写循环的一种方法是说

```
while ((line = reader.ReadLine()) != null) {
    if (line.Contains("host=")) {
    }
} 
```

我并不是说这是最好的方法（我认为不是），但它是 C# 中的一个常见习语。

如果你坚持你是正确的，请打印输出

```
Console.WriteLine(reader == null); 
```

您将立即放置在

```
line = reader.ReadLine(); 
```

线。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T00:13:51.287

尝试使用文件的完整路径：

```
 using (StreamReader sr = new StreamReader("c:\\Users\\fullpath\\file.txt")) 
```

# php - PHP 附加到 ClientDataSet CDS 文件

> ID：10825916
> 
> 赞同：4
> 
> 时间：2012-05-31T00:09:54.793
> 
> 标签：php, database, arrays, delphi, tclientdataset

我有一个空的 Delphi ClientDataSet CDS 文件设置，其中包含我需要的所有列/标题/数据类型。我想使用 PHP 将关联数组附加到 CDS 行中。这可能吗？

该数组可以简单地是：

```
{
    1: {Name:Captain, Phone:18001234567}
    2: {Name:Jack, Phone:18009876543}
    3: {Name:Sparrow, Phone:18887892345}
} 
```

我选择 PHP 是因为我精通该语言，而且我的 Web 服务器是一个共享 Linux 主机。基本上我不能在这里运行Delphi。我对可以在这种环境下工作的其他选项持开放态度。谢谢！

编辑：

有关我的解决方案，请参阅此帖子的评论。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T02:11:01.483

我建议您不要直接写入 cds 文件。

相反，您可以为两个应用程序（PHP 和 Delphi）使用一个通用的 xml，在 delphi 端，您可以使用带有[TXmlTransformProvider](http://docwiki.embarcadero.com/Libraries/en/Xmlxform.TXMLTransformProvider)的 XML 转换来加载和保存它，而在 PHP 端，您只需像往常一样将其写入 XML。

[在此处](http://docwiki.embarcadero.com/RADStudio/en/Using_an_XML_Document_as_the_Source_for_a_Provider)查看如何在 delphi 上进行设置。

- 更新

如果您真的需要直接更改 cds 文件（使用 xml 格式），您可以考虑 cds 格式是 xml 像这样在 cds 文件中添加一个新的：

```
<?xml version="1.0" standalone="yes"?>  
<DATAPACKET Version="2.0">
    <METADATA>
        <FIELDS>
            <FIELD attrname="Name" fieldtype="string" WIDTH="24"/>
            <FIELD attrname="Capital" fieldtype="string" WIDTH="24"/>            
        </FIELDS>
        <PARAMS DEFAULT_ORDER="1" PRIMARY_KEY="1" LCID="2057"/>
    </METADATA>
    <ROWDATA>
        <ROW Name="Argentina" Capital="Buenos Aires"/>
        <ROW Name="Bolivia" Capital="La Paz"/>
        <ROW Name="Brazil" Capital="Brasilia"/>
        <ROW Name="Canada" Capital="Ottawa"/>        
        <ROW Name="United States of America" Capital="Washington"/> 
        //Add your new ROW tag here with your data       
    </ROWDATA>
</DATAPACKET> 
```

# ruby-on-rails - Rspec：实例类上的 should_receive

> ID：10825918
> 
> 赞同：0
> 
> 时间：2012-05-31T00:10:06.250
> 
> 标签：ruby-on-rails, ruby, rspec, rspec-rails, rr

这是我正在尝试做的事情：

```
before(:each) do
    @user = Factory.build(:user)
    @user.stub!(:must_not_be_in_somewhere).and_return(true)
 end

it "should send a email if we are 2 weeks from last email" do
    User.any_instance.should_receive(:deliver_promo_code).exactly(111).times

    post :create, :user => @user.attributes, :format => :json
 end 
```

代码有效，但测试并没有失败……任何人都知道该代码有什么问题吗？

# java - 是否有替代 StringUtils.isNumeric 的方法来实现我的意思？

> ID：10825920
> 
> 赞同：17
> 
> 时间：2012-05-31T00:10:19.723
> 
> 标签：java, apache-commons

StringUtils.isNumeric 对于“”返回 true，对于 7.8 返回 false。这当然是记录在案的行为，但对我来说确实不是最方便的。还有其他东西（理想情况下在 commons.lang 中）提供 isActuallyNumeric 吗？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-05-31T00:12:46.400

尝试[`isNumber(String)`](http://commons.apache.org/proper/commons-lang/javadocs/api-release/org/apache/commons/lang3/math/NumberUtils.html#isNumber%28java.lang.String%29)从`org.apache.commons.lang.math.NumberUtils`.

> 检查 String [is] 是否是有效的 Java 编号。
> 
> 有效数字包括用 0x 限定符标记的十六进制数、科学计数法和用类型限定符标记的数字（例如 123L）。
> 
> `Null`并且空字符串将返回`false`。

**更新 -**

`isNumber(String)`现在已弃用。改为使用[`isCreatable(String)`](http://commons.apache.org/proper/commons-lang/javadocs/api-release/org/apache/commons/lang3/math/NumberUtils.html#isCreatable-java.lang.String-)。

谢谢你[指出](https://stackoverflow.com/users/557335/eav)它。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2017-08-08T18:30:49.753

[NumberUtils.isNumber](http://commons.apache.org/proper/commons-lang/javadocs/api-release/org/apache/commons/lang3/math/NumberUtils.html#isNumber-java.lang.String-)已弃用。

你应该使用

```
NumberUtils.isCreatable 
```

或者

```
NumberUtils.isParsable 
```

它们都支持小数点值：

*   [NumberUtils.isCreatable](https://commons.apache.org/proper/commons-lang/apidocs/org/apache/commons/lang3/math/NumberUtils.html#isCreatable-java.lang.String-)支持**十六进制、八进制数字、科学记数法和标有类型限定符的数字**（例如 123L）。将返回无效的八进制值`false`（例如 09）。如果你想获得它的价值，你应该使用[NumberUtils.createNumber](https://commons.apache.org/proper/commons-lang/apidocs/org/apache/commons/lang3/math/NumberUtils.html#createNumber-java.lang.String-)。
*   [NumberUtils.isParsable](https://commons.apache.org/proper/commons-lang/apidocs/org/apache/commons/lang3/math/NumberUtils.html#isParsable-java.lang.String-)只支持`0~9`和小数点（`.`），任何其他字符（例如空格或其他任何东西）都会返回`false`。

顺便说一下，`StringUtils.isNumeric`commons-lang 和 commons-lang3 的实现方式有些不同。在 commons-lang 中，[StringUtils.isNumeric("")](https://commons.apache.org/proper/commons-lang/javadocs/api-2.6/org/apache/commons/lang/StringUtils.html#isNumeric(java.lang.String))是`true`. 但在 commons-lang3 中，[StringUtils.isNumeric("")](https://commons.apache.org/proper/commons-lang/apidocs/org/apache/commons/lang3/StringUtils.html#isNumeric-java.lang.CharSequence-)是`false`. 您可以通过文档获取更多信息。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-31T00:48:50.530

这不完全在 中`commons.lang`，但它会起作用。

```
try {
    double d = Double.parseDouble(string);
    // string is a number
} catch (NumberFormatException e) {
    // string is not a number
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-31T00:14:16.680

或者，您可以检查是否有任何字符与这样的非数字匹配..

`if(myStr.replaceAll("^$"," ").matches("[^\\d\\.]"))`那么你就知道里面有些东西不是 0-9 和/或 .

这是等效的javascript（修改字符串以进行实验）...

[http://jsfiddle.net/LzZE6/](http://jsfiddle.net/LzZE6/)

# qt - 如何在 QFileSystemModel 上隐藏文件扩展名

> ID：10825921
> 
> 赞同：1
> 
> 时间：2012-05-31T00:10:21.257
> 
> 标签：qt, view, model, qtreeview, qfilesystemmodel

我已将 QFileSystemModel 绑定到 QTreeView。QFileSystemModel 已将 readOnly 设置为 false，因此用户可以重命名文件...但是我不希望用户意外重命名文件并忘记其扩展名，因为这将导致其从 QTreeView 中排除，因为我正在过滤文件类型...

如何隐藏保持重命名功能的文件扩展名？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T09:47:23.377

尝试重新实现`data()`和`setData()`角色`Qt::EditRole`：

```
virtual QVariant data ( const QModelIndex & index, int role = Qt::DisplayRole ) const
{
if (role == Qt::EditRole)
   {
   return QVariant(fileName(index));
   }
else
   return QFileSystemModel::data(index, role);
}

virtual bool setData ( const QModelIndex & idx, const QVariant & value, int role = Qt::EditRole )
{
if (role == Qt::EditRole)
   {
   return QFileSystemModel::setData( idx, QVariant(value.toString() + fileInfo(idx).completeSuffix()), role);
   }
else
   return QFileSystemModel::setData(idx, value, role);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-12-26T04:06:16.853

该解决方案对我有用，并且对用户完全隐藏了扩展。

覆盖`data`并`setData`在`QFileSystemModel`课堂上。

```
def data(self, index, role):
    if role == Qt.EditRole:
        return self.fileName(index)
    else:
        return super(ContentFileSystemModel, self).data(index, role)

def setData(self, index: QModelIndex, value, role: int=...) -> bool:
    print("setData")
    if role == Qt.EditRole:
        if self.isDir(index):
            d = ""
        else:
            d = "."
        return super(ContentFileSystemModel, self).setData(index, str(value) + d + self.fileInfo(index).completeSuffix(), role)
    return super(ContentFileSystemModel, self).setData(index, value, role) 
```

创建一个`QStyledItemDelegate`：

```
class NameDelegate(QStyledItemDelegate):

    def initStyleOption(self, option, index):
        super().initStyleOption(option, index)
        if isinstance(index.model(), QFileSystemModel):
            if not index.model().isDir(index):
                option.text = index.model().fileInfo(index).baseName()

    def setEditorData(self, editor, index):
        if isinstance(index.model(), QFileSystemModel):
            if not index.model().isDir(index):
                editor.setText(index.model().fileInfo(index).baseName())
            else:
                super().setEditorData(editor, index) 
```

并将其设置在您的视图中：

```
delegate = NameDelegate(self.lv_file_manager)
view.setItemDelegate(delegate) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T06:26:22.283

您必须针对您的情况创建一个项目委托，并将其与您的视图相关联。

如文档[here中所述](http://qt-project.org/doc/qt-4.8/qabstractitemview.html#setItemDelegate)

> `void QAbstractItemView::setItemDelegate(QAbstractItemDelegate * delegate)`
> 
> *将此视图及其模型的项目委托设置为委托。如果您想完全控制项目的编辑和显示，这很有用。*

该委托将负责显示不带扩展名的文件名，并允许编辑文件名。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-11-04T06:37:52.287

如果您使用上面建议的委托使用 QFileSystemModel 可能是最简单的选择。以下委托允许您隐藏文件扩展名。请注意，您不仅可以删除扩展名，还可以更改文件名。

```
class MyItemDelegate : public QStyledItemDelegate
{
    Q_OBJECT
protected:
    void paint(QPainter* painter, const QStyleOptionViewItem& option, const QModelIndex& index) const
    {
        QStyleOptionViewItem opt = option;
        initStyleOption(&opt, index);
        QFileInfo fileinfo(opt.text);
        opt.text = fileinfo.completeBaseName();
        QStyle* style = opt.widget ? opt.widget->style() : QApplication::style();
        style->drawControl(QStyle::CE_ItemViewItem, &opt, painter, opt.widget);
    }

    QSize sizeHint(const QStyleOptionViewItem& option, const QModelIndex& index) const
    {
        QSize result = QStyledItemDelegate::sizeHint(option, index);
        return result;
    }
}; 
```

然后您可以将此委托应用于 QTreeView 或 QListView 例如：

```
MyItemDelegate* itemDelegate = new MyItemDelegate;
myListView_->setItemDelegate(itemDelegate); 
```

# node.js - 如何使用node.js expressjs缩进index.jade中的div？

> ID：10825922
> 
> 赞同：0
> 
> 时间：2012-05-31T00:10:24.537
> 
> 标签：node.js, html, express, pug

我有一个 index.jade，它有一个没有任何内容的 div，这个 div 称为 div_one，它假设是动态 div，所以我用一个按钮更改内容，所以我在 .jade 中准备了 4 个 div 来替换 div_one 的内容

当我按下按钮时，我想在那个 div 上放一些 div

```
#div_one
    //nothing 
```

当我按下按钮时 div_one 改变

```
#div_one
    #div_in_1
        t some text
    #div_in_2
        t other text data 
```

谢谢你！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T00:23:26.990

我不确定这与缩进有什么关系，但这样的工作（我在这里使用 jQuery）......

```
script
    $('#btn').click(function() {
        $('#div_one').html('<div id="div_in_1">t some text</div><div id="div_in_2">t other text data</div>');
    });

#div_one
    | empty

button#btn Click me 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T08:59:45.923

我认为您可能希望为此使用单独的请求，即 AJAX。服务器端代码将是：

```
app.get('/div_in_1', function(req, res) {
    res.render('div_in_1.jade');
}

// For every div 
```

前端代码将是：

```
$('#btn1').on('click', function() {
    $.ajax({
        url: "/div_in_1",
    }).done(function(msg) { 
        $('#div_one').html(msg);
    });
} 
```

# python - Python 3.x 舍入行为

> ID：10825926
> 
> 赞同：216
> 
> 时间：2012-05-31T00:11:09.400
> 
> 标签：python, python-3.x, rounding

我只是在重新阅读[Python 3.0 中的新增功能](http://docs.python.org/py3k/whatsnew/3.0.html)，它指出：

> round() 函数舍入策略和返回类型已更改。精确的中途情况现在四舍五入到最接近的偶数结果，而不是远离零。（例如，round(2.5) 现在返回 2 而不是 3。）

和[round](http://docs.python.org/release/3.1.5/library/functions.html#round)的文档：

> 对于支持 round() 的内置类型，值被四舍五入到最接近的 10 的负 n 次方倍数；如果两个倍数同样接近，则朝偶数选择舍入

所以，在**v2.7.3**下：

```
In [85]: round(2.5)
Out[85]: 3.0

In [86]: round(3.5)
Out[86]: 4.0 
```

正如我所预料的那样。但是，现在在**v3.2.3**下：

```
In [32]: round(2.5)
Out[32]: 2

In [33]: round(3.5)
Out[33]: 4 
```

这似乎违反直觉，与我对四舍五入的理解相反（并且必然会绊倒人们）。英语不是我的母语，但在我读到这篇文章之前，我以为我知道四舍五入是什么意思：-/我确信在引入 v3 时一定有对此进行过一些讨论，但我无法找到一个很好的理由我的搜索。

1.  有谁知道为什么会变成这个？
2.  是否有任何其他主流编程语言（例如，*C、C++、Java、Perl、* ..）可以进行这种（对我而言不一致的）舍入？

我在这里想念什么？

更新：@Li-aungYip 对“银行家的四舍五入”的评论给了我正确的搜索词/关键字来搜索，我发现了这个问题：[为什么 .NET 使用银行家的四舍五入作为默认值？](https://stackoverflow.com/questions/311696/why-does-net-use-bankers-rounding-as-default)，所以我会仔细阅读。

* * *

## 回答 #1

> 赞同：195
> 
> 时间：2012-05-31T00:24:15.787

Python 3 的方式（称为“[四舍五入](https://en.wikipedia.org/wiki/Rounding#Round_half_to_even)”或“银行家的四舍五入”）如今被认为是标准的四舍五入方法，尽管一些语言实现还没有出现。

简单的“[总是向上取整 0.5](https://en.wikipedia.org/wiki/Rounding#Round_half_away_from_zero) ”技术会导致稍微偏向较大的数字。通过大量计算，这可能很重要。Python 3.0 方法消除了这个问题。

常用的舍入方法不止一种。IEEE 754 是浮点数学的国际标准，定义了[五种不同的舍入方法](https://en.wikipedia.org/wiki/IEEE_754#Rounding_rules)（Python 3.0 使用的一种是默认方法）。还有[其他人](https://en.wikipedia.org/wiki/Rounding#Rounding_to_integer)。

这种行为并不像应有的那样广为人知。如果我没记错的话，AppleScript 是这种舍入方法的早期采用者。[`round`AppleScript 中](https://developer.apple.com/library/archive/documentation/AppleScript/Conceptual/AppleScriptLangGuide/reference/ASLR_cmds.html#//apple_ref/doc/uid/TP40000983-CH216-SW43)的命令提供了几个选项，但与 IEEE 754 中一样，舍入到偶数是默认设置。显然，实现该`round`命令的工程师已经厌倦了“让它像我在学校学到的那样工作”的所有请求他实现了这一点：`round 2.5 rounding as taught in school`是一个有效的 AppleScript 命令。:-)

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2012-05-31T01:59:12.920

[您可以使用Decimal 模块](http://docs.python.org/library/decimal.html#decimal-faq)控制在 Py3000 中获得的舍入：

```
>>> decimal.Decimal('3.5').quantize(decimal.Decimal('1'), 
    rounding=decimal.ROUND_HALF_UP)
>>> Decimal('4')

>>> decimal.Decimal('2.5').quantize(decimal.Decimal('1'),    
    rounding=decimal.ROUND_HALF_EVEN)
>>> Decimal('2')

>>> decimal.Decimal('3.5').quantize(decimal.Decimal('1'), 
    rounding=decimal.ROUND_HALF_DOWN)
>>> Decimal('3') 
```

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2014-07-02T14:54:47.203

只是在此处添加文档中的重要说明：

[https://docs.python.org/dev/library/functions.html#round](https://docs.python.org/dev/library/functions.html#round)

> 笔记
> 
> 浮点数的 round() 行为可能令人惊讶：例如，round(2.675, 2) 给出 2.67 而不是预期的 2.68。这不是错误：这是因为大多数小数部分不能完全表示为浮点数。有关详细信息，请参阅浮点算术：问题和限制。

因此，在 Python 3.2 中得到以下结果不要感到惊讶：

```
>>> round(0.25,1), round(0.35,1), round(0.45,1), round(0.55,1)
(0.2, 0.3, 0.5, 0.6)

>>> round(0.025,2), round(0.035,2), round(0.045,2), round(0.055,2)
(0.03, 0.04, 0.04, 0.06) 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2018-10-02T11:29:25.617

Python 3.x 将 0.5 值舍入为偶数的邻居

```
assert round(0.5) == 0
assert round(1.5) == 2
assert round(2.5) == 2

import decimal

assert decimal.Decimal('0.5').to_integral_value() == 0
assert decimal.Decimal('1.5').to_integral_value() == 2
assert decimal.Decimal('2.5').to_integral_value() == 2 
```

但是，如果需要，可以将小数舍入“向后”更改为始终向上舍入 0.5：

```
decimal.getcontext().rounding = decimal.ROUND_HALF_UP

assert decimal.Decimal('0.5').to_integral_value() == 1
assert decimal.Decimal('1.5').to_integral_value() == 2
assert decimal.Decimal('2.5').to_integral_value() == 3

i = int(decimal.Decimal('2.5').to_integral_value()) # to get an int
assert i == 3
assert type(i) is int 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2012-12-20T00:31:32.473

我最近也遇到了这个问题。因此，我开发了一个 python 3 模块，它有 2 个函数 trueround() 和 trueround_precision() 来解决这个问题并给出与小学相同的舍入行为（不是银行家的舍入）。这是模块。只需保存代码并将其复制或导入即可。注意：trueround_precision 模块可以根据需要根据小数模块中的 ROUND_CEILING、ROUND_DOWN、ROUND_FLOOR、ROUND_HALF_DOWN、ROUND_HALF_EVEN、ROUND_HALF_UP、ROUND_UP 和 ROUND_05UP 标志更改舍入行为（有关更多信息，请参阅该模块文档）。对于下面的函数，请参阅文档字符串或使用 help(trueround) 和 help(trueround_precision) 如果复制到解释器中以获取更多文档。

```
#! /usr/bin/env python3
# -*- coding: utf-8 -*-

def trueround(number, places=0):
    '''
    trueround(number, places)

    example:

        >>> trueround(2.55, 1) == 2.6
        True

    uses standard functions with no import to give "normal" behavior to 
    rounding so that trueround(2.5) == 3, trueround(3.5) == 4, 
    trueround(4.5) == 5, etc. Use with caution, however. This still has 
    the same problem with floating point math. The return object will 
    be type int if places=0 or a float if places=>1.

    number is the floating point number needed rounding

    places is the number of decimal places to round to with '0' as the
        default which will actually return our interger. Otherwise, a
        floating point will be returned to the given decimal place.

    Note:   Use trueround_precision() if true precision with
            floats is needed

    GPL 2.0
    copywrite by Narnie Harshoe <signupnarnie@gmail.com>
    '''
    place = 10**(places)
    rounded = (int(number*place + 0.5if number>=0 else -0.5))/place
    if rounded == int(rounded):
        rounded = int(rounded)
    return rounded

def trueround_precision(number, places=0, rounding=None):
    '''
    trueround_precision(number, places, rounding=ROUND_HALF_UP)

    Uses true precision for floating numbers using the 'decimal' module in
    python and assumes the module has already been imported before calling
    this function. The return object is of type Decimal.

    All rounding options are available from the decimal module including 
    ROUND_CEILING, ROUND_DOWN, ROUND_FLOOR, ROUND_HALF_DOWN, ROUND_HALF_EVEN, 
    ROUND_HALF_UP, ROUND_UP, and ROUND_05UP.

    examples:

        >>> trueround(2.5, 0) == Decimal('3')
        True
        >>> trueround(2.5, 0, ROUND_DOWN) == Decimal('2')
        True

    number is a floating point number or a string type containing a number on 
        on which to be acted.

    places is the number of decimal places to round to with '0' as the default.

    Note:   if type float is passed as the first argument to the function, it
            will first be converted to a str type for correct rounding.

    GPL 2.0
    copywrite by Narnie Harshoe <signupnarnie@gmail.com>
    '''
    from decimal import Decimal as dec
    from decimal import ROUND_HALF_UP
    from decimal import ROUND_CEILING
    from decimal import ROUND_DOWN
    from decimal import ROUND_FLOOR
    from decimal import ROUND_HALF_DOWN
    from decimal import ROUND_HALF_EVEN
    from decimal import ROUND_UP
    from decimal import ROUND_05UP

    if type(number) == type(float()):
        number = str(number)
    if rounding == None:
        rounding = ROUND_HALF_UP
    place = '1.'
    for i in range(places):
        place = ''.join([place, '0'])
    return dec(number).quantize(dec(place), rounding=rounding) 
```

希望这可以帮助，

纳尼

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2017-07-03T14:55:40.747

python 3 中的 Python 2 舍入行为。

在小数点后 15 位加 1。精度高达 15 位。

```
round2=lambda x,y=None: round(x+1e-15,y) 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2018-11-07T08:30:49.100

一些案例：

```
in: Decimal(75.29 / 2).quantize(Decimal('0.01'), rounding=ROUND_HALF_UP)
in: round(75.29 / 2, 2)
out: 37.65 GOOD

in: Decimal(85.55 / 2).quantize(Decimal('0.01'), rounding=ROUND_HALF_UP)
in: round(85.55 / 2, 2)
out: 42.77 BAD 
```

对于修复：

```
in: round(75.29 / 2 + 0.00001, 2)
out: 37.65 GOOD
in: round(85.55 / 2 + 0.00001, 2)
out: 42.78 GOOD 
```

如果您想要更多小数，例如 4，您应该添加 (+ 0.0000001)。

为我工作。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-01-14T22:34:55.573

样品复制：

```
['{} => {}'.format(x+0.5, round(x+0.5)) for x in range(10)]

['0.5 => 0', '1.5 => 2', '2.5 => 2', '3.5 => 4', '4.5 => 4', '5.5 => 6', '6.5 => 6', '7.5 => 8', '8.5 => 8', '9.5 => 10'] 
```

API：[https ://docs.python.org/3/library/functions.html#round](https://docs.python.org/3/library/functions.html#round)

状态：

> 返回小数点后四舍五入到 ndigits 精度的数字。如果 ndigits 被省略或为 None，则返回最接近其输入的整数。
> 
> 对于支持 round() 的内置类型，值被四舍五入到最接近 10 的幂减去 ndigits 的倍数；如果两个倍数相等，则向偶数选择进行舍入（例如，round(0.5) 和 round(-0.5) 均为 0，round(1.5) 为 2）。任何整数值都对 ndigits 有效（正数、零或负数）。如果省略 ndigits 或 None，则返回值为整数。否则返回值的类型与数字相同。
> 
> 对于一般的 Python 对象编号，将委托四舍五入到编号。**圆形**。
> 
> 注意 浮点数的 round() 行为可能令人惊讶：例如，round(2.675, 2) 给出 2.67 而不是预期的 2.68。这不是错误：这是因为大多数小数部分不能完全表示为浮点数。有关详细信息，请参阅浮点算术：问题和限制。

鉴于这种见解，您可以使用一些数学来解决它

```
import math
def my_round(i):
  f = math.floor(i)
  return f if i - f < 0.5 else f+1 
```

现在您可以使用 my_round 而不是 round 来运行相同的测试。

```
['{} => {}'.format(x + 0.5, my_round(x+0.5)) for x in range(10)]
['0.5 => 1', '1.5 => 2', '2.5 => 3', '3.5 => 4', '4.5 => 5', '5.5 => 6', '6.5 => 7', '7.5 => 8', '8.5 => 9', '9.5 => 10'] 
```

* * *

## 回答 #9

> 赞同：-3
> 
> 时间：2020-01-05T09:43:55.950

The easiest way to round in Python 3.x as taught in school is using an auxiliary variable:

```
n = 0.1 
round(2.5 + n) 
```

And these will be the results of the series 2.0 to 3.0 (in 0.1 steps):

```
>>> round(2 + n)
>>> 2

>>> round(2.1 + n)
>>> 2

>>> round(2.2 + n)
>>> 2

>>> round(2.3 + n)
>>> 2

>>> round(2.4 + n)
>>> 2

>>> round(2.5 + n)
>>> 3

>>> round(2.6 + n)
>>> 3

>>> round(2.7 + n)
>>> 3

>>> round(2.8 + n)
>>> 3

>>> round(2.9 + n)
>>> 3

>>> round(3 + n)
>>> 3 
```

* * *

## 回答 #10

> 赞同：-4
> 
> 时间：2020-01-02T17:03:54.607

试试这个代码：

```
def roundup(input):   
   demo = input  if str(input)[-1] != "5" else str(input).replace("5","6")
   place = len(demo.split(".")[1])-1
   return(round(float(demo),place)) 
```

结果将是：

```
>>> x = roundup(2.5)
>>> x
3.0  
>>> x = roundup(2.05)
>>> x
2.1 
>>> x = roundup(2.005)
>>> x
2.01 
```

您可以在此处查看输出： [https ://i.stack.imgur.com/QQUkS.png](https://i.stack.imgur.com/QQUkS.png)

* * *

## 回答 #11

> 赞同：-6
> 
> 时间：2020-02-14T15:44:48.710

您可以使用 math.ceil 模块控制舍入：

```
import math
print(math.ceil(2.5))
> 3 
```

# java - 对具有枚举 (EnumType.STRING) 的实体使用 LIKE 运算符执行 JPA 查询

> ID：10825928
> 
> 赞同：2
> 
> 时间：2012-05-31T00:11:52.130
> 
> 标签：java, jpa

我能够存储、检索和查询具有枚举类型的实体（使用 JPA/Hibernate）。枚举字段使用@Enumerated(EnumType.STRING) 进行注释。

有可能做类似的事情`"SELECT a FROM MyEntity a WHERE a.myEnum LIKE :param"`吗？

这个想法是让它匹配枚举值字符串（在 DB 中）与“SYSTEM_%”或“BUSINESS_%”等模式匹配的任何实体。

感谢您的帮助。

- - 更新：

当我试图用这个查询时：

```
`@Query("SELECT e FROM MyEntity e WHERE e.myEnum LIKE :value")` 
```

使用值（表示匹配任何内容......）：

`%%`

我得到这个例外：

```
 Caused by: java.lang.IllegalArgumentException: Parameter value [%%] did not match expected type [mypackage.MyEntity$MyEnum]
        at org.hibernate.ejb.AbstractQueryImpl.validateParameterBinding(AbstractQueryImpl.java:370)
        at org.hibernate.ejb.AbstractQueryImpl.registerParameterBinding(AbstractQueryImpl.java:343)
        at org.hibernate.ejb.QueryImpl.setParameter(QueryImpl.java:374)
        at org.hibernate.ejb.QueryImpl.setParameter(QueryImpl.java:71) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T00:17:13.623

绝对地。只需使用`query.setString("param", "BUSINESS_%");`. 请注意，当 Hibernate 尝试将其强制转换为枚举时，使用`setParameter()`而不是抛出 ClassCastException，但它完全符合您的要求。`setString()``setString()`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-02T10:50:02.300

据说 org.springframework.orm.hibernate3.HibernateTemplate 中有一个快捷方式：

```
protected void applyNamedParameterToQuery(Query queryObject, String paramName, Object value)
        throws HibernateException {

    if (value instanceof Collection) {
        queryObject.setParameterList(paramName, (Collection) value);
    }
    else if (value instanceof Object[]) {
        queryObject.setParameterList(paramName, (Object[]) value);
    }
    else {
        queryObject.setParameter(paramName, value);
    }
} 
```

如果有额外的 else if (value instanceoff String) ...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-18T08:37:44.737

作为一种解决方法，您可以通过将模式连接到查询来构建查询。

```
em.createQuery("SELECT e FROM MyEntity e WHERE e.myEnum LIKE '" + pattern +"'") 
```

它适用于 Hibernate 和 Eclipselink。

但是不要尝试使用`pattern`用户输入，因为以这种方式构造查询容易受到 sql 注入攻击。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-03-21T11:59:22.343

我遇到了同样的问题，我做了以下事情：

*   定义到同一 db 列的第二个属性映射
*   该属性的类型是 String
*   它既不可更新也不可插入
*   适配枚举属性的set方法
*   使 String 属性成为只读属性

```
 @Column(name = "status")
    @Enumerated(EnumType.STRING)
    private StatusEnum status;

    public void setStatus(StatusEnum status) {
        this.status = status;
        this.statusString = status.toString();
    }

    @Column(name ="status", updatable = false, insertable = false)
    private String statusString; 
```

现在您可以使用 'like' 对 statusString 进行查询：

```
TypedQuery<MyEntity> query = 
    em.createQuery("select e from MyEntity e where e.statusString like 'CLOSED%', MyEntity.class); 
```

# haskell - 计算 fx = (x,x) 所做的功

> ID：10825933
> 
> 赞同：15
> 
> 时间：2012-05-31T00:12:49.227
> 
> 标签：haskell, functional-programming, asymptotic-complexity

假设我有这个功能：（Haskell 语法）

```
f x = (x,x) 
```

该函数执行的工作（计算量）是多少？

起初我以为它显然是恒定的，但如果类型`x`不是有限的，意思是 x 可以占用任意数量的内存呢？人们还必须考虑通过复制完成的工作`x`，对吗？

这使我相信该函数所做的工作实际上与输入的大小呈线性关系。

这本身不是家庭作业，而是在我必须定义该函数完成的工作时提出的：

```
f x = [x] 
```

我相信这也有类似的问题。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-05-31T00:20:46.057

非常非正式地，所做的工作取决于您的语言的操作语义。Haskell，嗯，它很懒，所以你只需支付恒定的因素：

*   将指针压入`x`堆栈
*   为`(,)`
*   适用`(,)`于其论点
*   返回指向堆单元的指针

完毕。*O(1)*工作，当调用者查看`f`.

现在，如果您查看内部，您将触发进一步的评估`(,)`-- 并且该工作依赖于评估`x`自身的工作。由于在 Haskell 中对的引用`x`是共享的，因此您只需对其进行一次评估。

因此，如果您完全评估结果，Haskell 中的工作是*O(work of x) 。*您的函数`f`仅添加常数因子。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T04:17:01.730

Chris Okasaki has a wonderful method of determining the work charged to function call when some (or total) laziness is introduced. I believe it is in his paper on Purely Functional Data Structures. I know it is in the book version -- I read that part of the book last month. Basically you charge a constant factor for the promise/thunk created, charge nothing for evaluating any passed in promises/thunks (assume they've already been forced / are in normal form [not just WHNF]). That's an underestimate. If you want an overestimate charge also the cost of forcing / converting to normal form each promise / thunk created by the function. At least, that's how I remember it in my extremely tired state.

Look it up in Okasaki: [http://www.westpoint.edu/eecs/SitePages/Chris%20Okasaki.aspx#thesis](http://www.westpoint.edu/eecs/SitePages/Chris%20Okasaki.aspx#thesis) -- I swear the thesis used be be downloadable.

# database - 在类似 RDF 的数据上快速走图：三重存储还是图数据库？

> ID：10825936
> 
> 赞同：8
> 
> 时间：2012-05-31T00:13:24.500
> 
> 标签：database, graph, store, rdf, connectivity

我有一个类似 RDF 的图形数据结构，即由通过不同类型的边（属性、关系）连接的节点（实体）组成。用户将在该图中选择一个节点（数百万个节点，数亿条边），我正在寻找一种快速的方法来显示所选节点的“接近度”（即其中一个或两个级别的节点）是通过一组可能指定的关系到最初选择的节点的路径）。

我做了一些研究，发现了专门用于 RDF 的三元存储和更通用的图形数据库，例如 neo4j 和 allegro。然后还有jena、sesame等中间件产品。

你会推荐三重存储或图形数据库来提高查询附近连接节点的效率吗？中间件在这里发挥作用吗？我知道在每种情况下，将完整的图表保存在内存中可能是有利的。

亚历山大

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-31T06:38:33.000

我会推荐其中一家 RDF 商店（Jena、Sesame、4store、Virtuoso、OWLim、Oracle 等）。然后，您可以为您的解决方案学习 SPARQL 查询，并在各种系统中尝试它，而无需为不同的 API 编写代码。

您可以采取几种方法，最简单的可能是具有不同路径的 UNION 查询，您可以使用边缘 URI 的变量并添加 FILTER 以将其限制为您感兴趣的那些。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-31T06:40:22.853

为了澄清，我不会将 Jena 和/或 Sesame 归类为中间件。它们都有本机存储和索引。

Jena 有使用 B+Tree 索引的[TDB 。](http://jena.apache.org/documentation/tdb/)特别是对于默认图，您有三个索引：SPO、POS 和 OSP。

在您的情况下，SPO 索引将用于为您提供给定主题的所有三元组。如果您想要两个级别的深度，您将需要多次触摸索引：一个用于初始主题，另一个用于纠正您的主题的每个对象。

TDB 使用内存映射文件来缓存您的索引，因此如果您有足够的 RAM，这应该不是问题。

您想要做的非常接近 RDF 社区中人们过去所说的[简洁有界描述](http://www.w3.org/Submission/CBD/)(CBD)，但是如果您想要两个或更多级别的深度，则需要自己实现。SPARQL 查询语言为您提供了可以使用的 DESCRIBE（但它只有一层）。

最后但同样重要的是，您说您有一个类似 RDF 的图形数据结构，但它不是 RDF。出于这个原因，您应该在 RDF 中转换您的数据，或者放弃使用三重存储的想法，因为它们旨在加载和管理 RDF 数据。即使您实际上可以只使用存储和索引层的一部分来构建和使用您自己的自定义索引。

对您来说最好的事情是对您的数据进行实验，并比较不同的解决方案如何与您的用例一起工作。

# php - $.ajax 只运行一次脚本

> ID：10825938
> 
> 赞同：0
> 
> 时间：2012-05-31T00:14:05.373
> 
> 标签：php, jquery, ajax

当我使用 ajax 打开链接时，我想更改 wibyia 工具栏以将 facebook like 按钮刷新到当前网页，所以我每次都重新加载 wibyia 脚本，但它只加载一次......帮助

```
 $(document).ready(function(){
    $("[href^='?id=']").click(function(){
    var linkid=$(this).attr("href");
    $(".col-1").html("<div style='text-align:center;margin-top:10px'><img  src='images/loading.gif' /> </div>");
    window.history.pushState("object or string", "index", "http://localhost:10358/"+linkid);

    $.ajaxSetup ({
    // Disable caching of AJAX responses
    cache: false
     });
    $.get("/catdata/news.php"+linkid,function(result){
    $(".col-1").html(result);
    });
    $.getScript("http://cdn.wibiya.com/Toolbars/dir_1185/Toolbar_1185788/Loader_1185788.js");

    return false;

});
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T08:27:12.030

您单击的链接是否在元素“.col-1”中？如果是这样，则它不起作用，因为单击事件侦听器仅附加一次，而不是在每个 ajax 发布之后。

使用 .on() (jQuery 版本 >= 1.7) 或 delegate() 或在每次 ajax 调用后分配 click 事件处理程序。

# iphone - 仅在特定频率以上的 iPhone 应用程序音频录制

> ID：10825941
> 
> 赞同：2
> 
> 时间：2012-05-31T00:14:19.697
> 
> 标签：iphone, ios, audio, voice, frequency

我目前正在从事基于 iPhone 和 iPad 的录音应用程序。在这里，我自己完成了基本的音频录制功能，但我不知道如何录制高于特定频率的音频，比如高于 17,000 Hz。那么，任何人都可以帮助我实现这一目标吗？这真的对我的职业生涯有很大帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T01:11:21.737

我认为您需要使用加速框架，里面有一个可以进行 FFT（快速傅里叶变换）的 vDSP API。它将数据从时域转换为频域。根据 bin 大小信息，您可以提取特定 bin 大小后的幅度/幅度。

我认为这可以解决您的问题。

对于 vDSP，您可以参考 Apple 网站上的[aurioTouch 2](http://developer.apple.com/library/ios/#samplecode/aurioTouch2/Listings/Classes_aurioTouchAppDelegate_mm.html#//apple_ref/doc/uid/DTS40011369-Classes_aurioTouchAppDelegate_mm-DontLinkElementID_6)。

关于 FFT 如何在那里工作，您可以参考这个问题 -[了解 aurioTouch2 中的 FFT](https://stackoverflow.com/q/8845542/1388536)

我希望这会有所帮助。

**PS** AurioTouch 或 AurioTouch 1 未使用 vDSP API。我记得在 iOS 4 之前有一个 FFT 函数可以做类似的事情但速度较慢。所以你可能认为vDSP只有iOS4.0以后才有

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T05:03:33.020

我在互联网上研究我发现这两种墨水..

查找频率的库[https://github.com/jkells/sc_listener](https://github.com/jkells/sc_listener)

使用上述库的示例[https://github.com/jkells/sc_listener_sample](https://github.com/jkells/sc_listener_sample)

我希望通过获取频率数字并设置条件，您可以实现这一目标..希望这会有所帮助......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-15T17:09:08.080

与简单的滤波器解决方案相比，使用 FFT 的计算成本高且过于复杂。除非你真的需要在频域工作，否则你应该避免它。

相反，通过高通滤波器运行您的 PCM。相关的维基百科页面将帮助您选择合适的过滤器。如果您的最小频率限制是一个常数，[此页面](http://www-users.cs.york.ac.uk/~fisher/mkfilter/trad.html)将为您的滤波器生成常数。否则，动态生成这些常量并不难。或者您可以[将源代码](http://www-users.cs.york.ac.uk/~fisher/software/mkfilter/)用于所述滤波器系数生成页面

# java - 安卓 SDK 3.2。Class.forName() 问题

> ID：10825943
> 
> 赞同：0
> 
> 时间：2012-05-31T00:14:32.143
> 
> 标签：java, android

我只是想从一个窗口切换到下一个窗口，但我不断收到错误消息。我搜索了谷歌，但无法弄清楚我哪里出错了。我希望有人能告诉我发生了什么事。这是错误日志。我得到了一个 classnotfound 但不明白为什么。它在我的清单中。

```
05-30 23:52:51.129: W/System.err(593): java.lang.ClassNotFoundException: com.jmedia.hvacanalizer.NEWCUSTOMER
05-30 23:52:51.149: W/System.err(593):  at java.lang.Class.classForName(Native >Method)
05-30 23:52:51.149: W/System.err(593):  at java.lang.Class.forName(Class.java:227)
05-30 23:52:51.149: W/System.err(593):  at java.lang.Class.forName(Class.java:174)
05-30 23:52:51.149: W/System.err(593):  at com.jmedia.hvacanalizer.HVACAnalizerActivity$1.onClick(HVACAnalizerActivity.java:30)
05-30 23:52:51.169: W/System.err(593):  at android.view.View.performClick(View.java:3110)
05-30 23:52:51.169: W/System.err(593):  at android.view.View$PerformClick.run(View.java:11934)
05-30 23:52:51.169: W/System.err(593):  at android.os.Handler.handleCallback(Handler.java:587)
05-30 23:52:51.179: W/System.err(593):  at android.os.Handler.dispatchMessage(Handler.java:92)
05-30 23:52:51.179: W/System.err(593):  at android.os.Looper.loop(Looper.java:132)
05-30 23:52:51.190: W/System.err(593):  at android.app.ActivityThread.main(ActivityThread.java:4123)
05-30 23:52:51.190: W/System.err(593):  at java.lang.reflect.Method.invokeNative(Native Method)
05-30 23:52:51.190: W/System.err(593):  at java.lang.reflect.Method.invoke(Method.java:491)
05-30 23:52:51.190: W/System.err(593):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:841)
05-30 23:52:51.199: W/System.err(593):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:599)
05-30 23:52:51.199: W/System.err(593):  at dalvik.system.NativeStart.main(Native Method)
05-30 23:52:51.199: W/System.err(593): Caused by: java.lang.NoClassDefFoundError: com.jmedia.hvacanalizer.NEWCUSTOMER
05-30 23:52:51.212: W/System.err(593):  ... 15 more
05-30 23:52:51.219: W/System.err(593): Caused by: java.lang.ClassNotFoundException: com.jmedia.hvacanalizer.NEWCUSTOMER in loader dalvik.system.PathClassLoader[/data/app/com.jmedia.hvacanalizer-2.apk]

05-30 23:52:51.234: W/System.err(593):  at dalvik.system.PathClassLoader.findClass(PathClassLoader.java:251)
05-30 23:52:51.234: W/System.err(593):  at java.lang.ClassLoader.loadClass(ClassLoader.java:540)
05-30 23:52:51.239: W/System.err(593):  at java.lang.ClassLoader.loadClass(ClassLoader.java:500)
05-30 23:52:51.239: W/System.err(593):  ... 15 more 
```

这是我清单中的代码...

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.jmedia.hvacanalizer"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk android:minSdkVersion="13" />

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name" >
        <activity
            android:name=".HVACAnalizerActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
        <activity
            android:name=".newcustomer"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="com.jmedia.hvacanalizer.NEWCUSTOMER" />

                <category android:name="android.intent.category.DEFAULT" />
            </intent-filter>
        </activity>
    </application>

</manifest> 
```

这是我班上的代码...

```
public class HVACAnalizerActivity extends Activity {

    Button bNew, bLookUp;

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        initialize();
    }

    public void initialize() {
        bNew = (Button) findViewById(R.id.bNewCustomer);
        bLookUp = (Button) findViewById(R.id.bLUCustomer);
        bNew.setOnClickListener(new View.OnClickListener() {

            //@Override
            public void onClick(View arg0) {
                // TODO Auto-generated method stub
                try {
                    Class<?> newCustomerClass = Class.forName("com.jmedia.hvacanalizer.NEWCUSTOMER");
                    Intent newCustomerIntent = new Intent(
                            HVACAnalizerActivity.this, newCustomerClass);
                    startActivity(newCustomerIntent);

                } catch (ClassNotFoundException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }
            }
        });
        bLookUp.setOnClickListener(new View.OnClickListener() {

            //@Override
            public void onClick(View arg0) {
                // TODO Auto-generated method stub
                // Class newCustomerClass = null;

            }
        });
    } 
```

如果有人可以在这里帮助我，那就太好了。这是我第一次尝试为 android 编写代码，我已经快要拔掉头发了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-02T12:28:14.697

只是作为其他人的参考，我想发布答案。我找错地方了。问题是 newcustomer 类中的初始化方法中的编码错误。我认为这是我错误地引用了我的 hvacanalizeractivity 类中的同一个按钮的地方。希望这可以帮助像我这样的其他初学者。

# c# - 如何控制模型绑定？

> ID：10825951
> 
> 赞同：10
> 
> 时间：2012-05-31T00:15:20.860
> 
> 标签：c#, asp.net-mvc-3, model-binding

我最近开始使用 MVC，但我有点失望。该框架没有帮助我，而是妨碍了我。

我正在尝试编写这样的控制器操作（伪代码）

```
ActionResult Save(long id, string whichForm)
{
    if (whichForm == "A")
    {
        var vm = CreateModel(Request.Form);
        if (!TryValidate(vm))
            return View(vm);
        else
            return RedirectToRoute("Success");
    }
    else ....
} 
```

基本上我想控制我的视图模型何时构建以及何时验证。这可能吗？如何实现 CreateModel 方法？考虑一下我可能想在这个控制器动作中创建几个不同的视图模型。

*咆哮：我真的不明白为什么视图模型绑定和验证在 DefaultModelBinder 中混合在一起。看起来像代码气味。特别是当很难覆盖这种行为时。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-05-31T00:21:57.430

您可以自行决定创建并绑定到现有模型：

```
public ActionResult Save(long id, string whichForm)
{
    if (whichForm == "A")
    {
        var vm = new FormAViewModel();

        if (!TryUpdateModel(vm))
            return View(vm);
        else
            return RedirectToRoute("Success");
    }
    // else ....
} 
```

[`IModelBinder`](http://buildstarted.com/2010/09/12/custom-model-binders-in-mvc-3-with-imodelbinder/)如果您想完全控制绑定过程，[您还可以选择创建自己的。](http://buildstarted.com/2010/09/12/custom-model-binders-in-mvc-3-with-imodelbinder/)您可以替换默认模型绑定器，也可以`IModelBinder`为特定类型注册特定实现。但是，我建议除非您的绑定逻辑很简单，否则您可能希望从中派生自定义模型绑定器`DefaultModelBinder`并覆盖您不喜欢的部分。

我讨厌留下一个 troll-ish 的评论，但是 10 次中有 9 次有人觉得框架妨碍他们的原因是因为他们还不了解如何正确使用它。[这是一篇关于模型绑定的一般提示的文章](http://odetocode.com/blogs/scott/archive/2009/04/27/6-tips-for-asp-net-mvc-model-binding.aspx)。

至于您的咆哮：验证和绑定是分开的，但是，默认模型绑定器会触发验证。这样做的原因是允许您的应用程序优雅地处理绑定到缺失/无效/不完整值的问题，而不是允许绑定静默失败或抛出异常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T00:24:36.897

您可以利用 IModelBinder 接口并编写一个完整的自定义模型绑定器。这里解释得很好。本质上，此接口公开了一个方法“BindModel”，您可以在其中控制模型绑定行为以及验证。

[http://www.dotnetcurry.com/ShowArticle.aspx?ID=584](http://www.dotnetcurry.com/ShowArticle.aspx?ID=584)

但是，这可能会使问题复杂化，并且您可能会遇到意大利面条式代码。如果适合您，我会建议一个简单的“每个模型的操作”。所以你可以写这样的东西：

```
ActionResult SaveA(long id, AViewModel)
{
      //.... Action to be conducted in case it is form A.
}
ActionResult SaveB(...., BViewModel)
{
       //... Action to be conducted in case it is form B.
}

// Your view models can be structured for code reuse as well.
class AViewModel {  ...  }
class BViewModel : AViewModel {  ...  } 
```

# imagemagick - 计算图像中某个区域的平均颜色

> ID：10825952
> 
> 赞同：10
> 
> 时间：2012-05-31T00:15:27.413
> 
> 标签：imagemagick

目标是在图像顶部放置标题，并将文本颜色设置为与其所在的背景形成对比的颜色。为此，我希望计算下图中红色矩形内区域的平均颜色：

![在此处输入图像描述](../Images/227a95c6b30fae4e85dbe9b649390661.png)

![在此处输入图像描述](../Images/e1ba62e944e1670d2cb3043f1b9b33b4.png)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-02T03:48:56.583

扩展[Bonzo 的答案](/a/10831158)。这是一个示例命令

```
convert Y82IirS.jpg -resize 1x1 txt: 
```

结果

```
# ImageMagick pixel enumeration: 1,1,255,srgb
0,0: (220,176, 44)  #DCB02C  srgb(220,176,44) 
```

[图像的平均颜色](http://wizards-toolkit.org/discourse-server/viewtopic.php?t=8782)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-31T09:45:59.063

我会裁剪到您感兴趣的区域，然后将其调整为 1 像素。然后获取该像素的值。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-01-26T01:06:03.247

这是一个处理裁剪和颜色检测的命令，并且还以一致的 R、G、B 格式生成输出：

```
 convert image.gif -crop 6x7+8+9 -resize 1x1\! -format "%[fx:int(255*r+.5)],%[fx:int(255*g+.5)],%[fx:int(255*b+.5)]" info:- 
```

其中，在`6x7+8+9`：

```
 6: image width (pixels)
 7: image height (pixels)
 8: x-coordinate of top left corner
 9: y-coordinate of top left corner 
```

退货

```
 176,191,67 
```

改编自[https://stackoverflow.com/a/25488429/3124680](https://stackoverflow.com/a/25488429/3124680)

# java - Java FileNotFoundException 文件存在 (Android)

> ID：10825954
> 
> 赞同：-1
> 
> 时间：2012-05-31T00:16:03.307
> 
> 标签：java, android, filenotfoundexception

我正在尝试引用存储在我的工作目录中的文件，以便可以使用开源例程“opencsv”读取和解析它。

以下行给出了 FileNotFoundException 错误：

```
CSVReader reader = new CSVReader(new FileReader("file.csv"), '\t'); 
```

我已经使用以下内容检查了工作目录：

```
String curDir = System.getProperty("user.dir"); 
```

这将返回值“\”，因此我已将文件“file.csv”放在项目的根目录中。我正在使用 Eclipse。有问题的文件不是只读的，设置为“存档”并且未标记为“派生”。

很明显，我是 Java 新手。在 Google 上搜索此问题表明我需要更改文件权限，但我想知道我是否遗漏了其他内容。我知道解决方案可能非常明显：S

这是完整的代码：

```
package mjd.listview.test;

import java.io.FileReader;
import java.util.List;

import android.app.ListActivity;
import android.os.Bundle;
import android.view.View;
import android.widget.AdapterView;
import android.widget.AdapterView.OnItemClickListener;
import android.widget.ArrayAdapter;
import android.widget.ListView;
import android.widget.TextView;
import android.widget.Toast;
import au.com.bytecode.opencsv.CSVReader;

public class ListProjectActivity extends ListActivity {
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
      super.onCreate(savedInstanceState);

      CSVReader reader = new CSVReader(new FileReader("file.csv"), '\t');
        List<String[]> myEntries = reader.readAll();

      String[] terms = getResources().getStringArray(R.array.terms_array);
      setListAdapter(new ArrayAdapter<String>(this, R.layout.list_item, terms));

      ListView lv = getListView();
      lv.setTextFilterEnabled(true);

      lv.setOnItemClickListener(new OnItemClickListener() {
        public void onItemClick(AdapterView<?> parent, View view,
            int position, long id) {

          // When clicked, show a toast with the TextView text
          Toast.makeText(getApplicationContext(), ((TextView) view).getText(),
              Toast.LENGTH_SHORT).show();
        }
      });
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T00:51:15.133

要查找工作目录，请不要使用`System.getProperty("user.directory")`. 使用`new File(".").getCanonicalPath()`. 这将打印当前工作目录的规范（绝对和唯一）路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T00:21:04.730

不要假设你的项目的根目录等同于`\`. 如果是的话，我会感到惊讶。中报告的实际路径是`FileNotFoundException`什么？这会告诉你 Java 在哪里寻找文件。

我使用 IntelliJ 而不是 Eclipse，但在 IntelliJ 中有一个运行配置屏幕，您可以在其中设置 JVM 参数、命令行参数和工作目录。我假设 Eclipse 有类似的东西。看看它是怎么设置的。然后将其更改为您实际拥有文件的位置或将文件移动到设置的位置。

# coldfusion - cfcontent 强制下载不向浏览器报告文件大小

> ID：10825959
> 
> 赞同：3
> 
> 时间：2012-05-31T00:17:04.950
> 
> 标签：coldfusion, download

我创建了一个页面以允许我们的客户下载文件。问题是，浏览器不知道文件有多大，也不显示下载进度...

我如何让 ColdFusion 至少报告文件大小？而且，充其量，我如何让浏览器下载栏检测文件大小和下载进度？

这是我的代码。

```
<cfparam name="delete_file" default="no">
<cfparam name="URL.d" default="n">
<cfparam name="content_type" default="image/jpeg">
<cfparam name="FileDownload" default="default.jpg">
<cfparam name="URL.file" default="default.jpg">
<cfparam name="folder" default="downloads">
<cfparam name="URL.folder" default="downloads">
<cfset folder = #URL.folder#>
<cfset FileDownload = #URL.file#>
<cfif URL.d IS "y">
    <cfset delete_file = "yes">
<cfelse>
    <cfset delete_file = "no">
</cfif>
<cfset exten = ListLast(FileDownload, ".")>

<cfswitch expression="#exten#">
<cfcase value="zip"><cfset content_type = "application/zip, application/x-zip, application/x-zip-compressed, application/octet-stream, application/x-compress, application/x-compressed, multipart/x-zip"></cfcase>
<cfcase value="ai"><cfset content_type = "application/illustrator"></cfcase>
<cfcase value="eps"><cfset content_type = "application/illustrator, application/octect-stream"></cfcase>
<cfcase value="pdf"><cfset content_type = "application/pdf, application/x-pdf, application/acrobat, applications/vnd.pdf, text/pdf, text/x-pdf"></cfcase>
<cfcase value="psd"><cfset content_type = "image/photoshop, image/x-photoshop, image/psd, application/photoshop"></cfcase>
<cfcase value="jpg"><cfset content_type = "image/jpeg"></cfcase>
<cfcase value="png"><cfset content_type = "image/png"></cfcase>
<cfcase value="tif"><cfset content_type = "image/tiff"></cfcase>
<cfdefaultcase><cfset content_type = "image/jpeg"></cfdefaultcase>
</cfswitch>

<cfoutput><cfheader name="content-disposition" value="attachment;filename=#FileDownload#">
<cfcontent type="#content_type#" file="#ExpandPath("./#folder#")#/#FileDownload#" deletefile="#delete_file#"></cfoutput> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T01:25:49.717

```
<cfset fileToGetSizeOf = expandPath("./#folder#/#FileDownload#") />
<cfheader name="content-length" value="#getFileInfo(fileToGetSizeOf ).size#" /> 
```

应该这样做

# r - 可用的 CRAN 小插曲

> ID：10825963
> 
> 赞同：5
> 
> 时间：2012-05-31T00:17:32.563
> 
> 标签：r, data.table, cran, vignette

有`available.packages()`列出 CRAN 上所有可用软件包的功能。是否有类似的功能来查找所有可用的小插图？如果不是，我将如何获得所有小插曲及其相关包的列表？

作为一个角落案例，请记住该`data.table`包有 3 个与之相关的小插曲。

**编辑：根据安德烈的回应，我意识到我并不清楚。我知道用于查找所有可用本地小插图的小插图功能，我正在寻找一种方法来获取 CRAN 上所有包的所有小插图。**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-01T10:18:16.237

我似乎记得在回答一些 SO 问题（现在找不到）时看到这个并决定，因为信息不包含在 的输出中，也不包含在应用到`available.packages()`的结果中（来自 Jeroen Ooms 的技巧） ，我想不出一种非刮擦的方式来做到这一点......`readRDS``@CRAN/web/packages/packages.rds`

这是我的刮刀，应用于前 100 个包裹（导致 44 个小插图）

```
pkgs <- unname(available.packages()[, 1])[1:100]
vindex_urls <- paste0(getOption("repos"),"/web/packages/", pkgs, 
    "/vignettes/index.rds", sep = "")
getf <- function(x) {
      ## I think there should be a way to do this directly
      ## with readRDS(url(...)) but I can't get it to work
    suppressWarnings(
              download.file(x,"tmp.rds",quiet=TRUE))
    readRDS("tmp.rds")
}
library(plyr)
vv <- ldply(vindex_urls,
            .progress="text",
            function(x) {
                if (inherits(z <- try(getf(x),silent=TRUE),
                    "try-error")) NULL else z
            })
tmpf <- function(x,n) { if (is.null(x)) NULL else
                            data.frame(pkg=n,x) }
vframe <- do.call(rbind,mapply(tmpf,vv,pkgs))
rownames(vframe) <- NULL
head(vframe[,c("pkg","Title")]) 
```

可能有办法清理它/使它更紧凑，但它似乎工作正常。您的刮一次/偶尔更新策略似乎是合理的。或者，如果您愿意，您可以每天（或每周或任何看起来合理的方式）抓取并将结果保存/发布到可公开访问的地方，然后在包中包含一个带有硬编码该 URL 的函数……甚至创建一个格式良好的 HTML 表，带有链接，全世界都可以使用（然后将伟哥广告添加到页面上，然后 $$PROFIT$$ ...）

**编辑**：将下载和 readRDS 都包装在一个函数中，这样我就可以将整个内容包装在`try`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-31T05:09:07.827

功能`vignette()`并`browseVignettes()`列出您机器上安装的软件包的所有小插曲。

```
vignette(package="data.table")

Vignettes in package ‘data.table’:

datatable-faq                         Frequently asked questions (source, pdf)
datatable-intro                       Quick introduction (source, pdf)
datatable-timings                     Timings of common tasks (source, pdf) 
```

`browseVignettes()`特别有用，因为它创建了一个带有超链接的网页：

```
browseVignettes(package="data.table")

Vignettes found by browseVignettes(package = "data.table")

Vignettes in package data.table

Frequently asked questions - PDF  R  LaTeX/noweb 
Quick introduction - PDF  R  LaTeX/noweb 
Timings of common tasks - PDF  R  LaTeX/noweb 
```

# c#-4.0 - .net 中的 10 位数字

> ID：10825964
> 
> 赞同：1
> 
> 时间：2012-05-31T00:17:34.807
> 
> 标签：c#-4.0

我想在 C# 中表示一个 10 位无符号整数。我需要将其读取并写入`BinaryStream`并使用 ++ 一元运算符。我应该`int`用作内部表示还是有更好的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T00:23:59.423

我会`unsigned short`用作我的基本类型。无论如何，写入二进制流都会很有趣，因为您需要打包其中的四个数字才能将整数字节数放入流中（假设您想要打包）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T00:24:56.070

根据您想要做什么，使用上限为 10 位的 UInt16 是一个很好的解决方案。您将需要重载一些运算符，但应该就是这样。

另一种选择是使用 BitArray 并重新定义 ++ 一元运算符。

# ms-access - 按日期汇总 MS Access 中的小计

> ID：10825965
> 
> 赞同：0
> 
> 时间：2012-05-31T00:17:42.627
> 
> 标签：ms-access, report

我正在使用 MS Access 2010

我的查询有字段，日期，市场价格，实际价格

我需要在查询中按日期实际价格/市场价格分开，以达到我可以平均的百分比*（仅限当天，一次一天）*

每天将有 10-50 件物品。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T14:27:54.560

您将要使用标准查询，但要对查询进行总计。在主页选项卡上的记录组中，单击总计。

显示该字段后，您可以为市场价格和实际价格输入总和（在总计字段中）；然后确保将 Date 字段设置为 GroupBy。

然后你应该得到按日期分组的价格字段的总计。

顺便说一句，我会将该日期字段标记为日期以外的其他内容（例如，DateSold、PurchaseDate 等），以避免混淆和可能与 Date 类型发生冲突。

# java - 高效的java数据结构删除和检索信息？

> ID：10825966
> 
> 赞同：1
> 
> 时间：2012-05-31T00:18:01.987
> 
> 标签：java, data-structures

我有一种情况，我需要一个可以添加字符串的数据结构。这个数据结构很大。

我需要它的具体品质是：

1.  获取（索引）
2.  删除超出限制时最初添加的一定数量的条目。（LIFO）

我尝试过使用 ArrayList，但删除操作是 o(n)，而对于linkedList，遍历或 get() 操作将是 o(n)。

我还有什么其他选择？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-31T00:25:21.857

[循环缓冲区](http://en.wikipedia.org/wiki/Circular_buffer)- 一个在引擎盖下使用数组实现的缓冲区。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T00:25:26.830

LinkedHashSet 可能很有趣。它实际上是一个 HashSet，但它还维护一个 LinkedList 以允许可预测的迭代顺序 - 因此也可以用作 FIFO 队列，它的好处是它不能包含重复的条目。

因为它也是一个 HashSet，所以搜索（而不是扫描）可以是 O(1)，如果它们可以匹配`equals()`

你可以看看[这个](https://stackoverflow.com/questions/658364/java-what-is-the-best-way-to-find-elements-in-a-sorted-list)问题和[这个](https://stackoverflow.com/questions/5452891/java-search-collection-of-strings-providing-the-first-few-characters)。

# event-driven-design - 如何在原生文本编辑应用程序中实现语法高亮？

> ID：10825967
> 
> 赞同：1
> 
> 时间：2012-05-31T00:18:03.920
> 
> 标签：event-driven-design

我的背景是作为一名自学成才的 Web 开发人员。我习惯了请求/响应周期。但是，我越来越多地参与事件驱动编程（JavaScript、本机应用程序等）。我有一个想法，我想编写一个带有语法突出显示的本机文本编辑器（作为一种学习经验），但我意识到我对如何实现语法突出显示感到困惑。我习惯于使用一个常用的语法高亮库，在其中你给库一些文本，返回一个带有语法高亮的 HTML 版本。这不是普通文本编辑器/IDE 的工作方式。当您键入时，当编辑器意识到您正在尝试键入的内容时，字符会相应地突出显示。因此，从高级概述来看，如何实现语法突出显示。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T00:27:37.737

在开始之前阅读此内容：http: [//codemirror.net/1/story.html](http://codemirror.net/1/story.html)

# nested-loops - “获取像素”循环错过了它应该找到的像素。（在小型基础中）

> ID：10825969
> 
> 赞同：0
> 
> 时间：2012-05-31T00:19:10.263
> 
> 标签：nested-loops, smallbasic

这是 Small Basic 中的代码：

```
GraphicsWindow.CanResize = 0
GraphicsWindow.Width = 201
GraphicsWindow.Height = 300
X = 0
circumstance = 0

'Initialization
GraphicsWindow.SetPixel(100,0,"Black")
code = "01111111"

'Start
For i=1 To GraphicsWindow.Height
For X=0 To GraphicsWindow.Width
Program.Delay(1)

If X>0 Then
  If GraphicsWindow.GetPixel(X-1,i-1) = "Black" Then
    circumstance = circumstance + 1
  EndIf
EndIf  

If GraphicsWindow.GetPixel(X,i-1) = "Black" Then
  circumstance = circumstance + 10
EndIf

If X<GraphicsWindow.Width Then
  If GraphicsWindow.GetPixel(X+1,i-1) = "Black" Then
    circumstance = circumstance + 100
  EndIf
EndIf  

TextWindow.WriteLine(circumstance)
  EndFor
EndFor 
```

它的作用是逐个像素地查看图形窗口。变量“情况”是它发现的。如果目标像素的左上角有黑色像素，则第一位为 1。如果目标像素的左上角有黑色像素，则第二位为 1。如果有黑色像素到目标像素的右上角，第三位数字为1。但无论我尝试什么情况总是输出000。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-30T14:03:59.143

GetPixel 一直为我工作。你用的是什么sb版本？顺便说一句，图形窗口需要用某种颜色绘制，虽然默认情况下它是白色的，但它不会返回白色，因为就像没有颜色一样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-29T13:13:35.397

1.  GetPixel 返回“#rrggbb”而不是颜色名称。
2.  GraphicsWindow 开头用“#000000”填充。但是颜色是透明的，所以你可以看到背景颜色。

# ruby-on-rails - 动作控制器：语法错误，缺少括号

> ID：10825974
> 
> 赞同：-1
> 
> 时间：2012-05-31T00:19:40.987
> 
> 标签：ruby-on-rails, ruby-on-rails-3, twitter-bootstrap, erb, scaffolding

在我的 rails 应用程序中，仅使用脚手架生成的视图以及引导程序，我收到了一个动作控制器错误：

```
SyntaxError in Orders#index

Showing /Users/Michael/Documents/Morning_Coffee/app/views/orders/index.html.erb where line #39 raised:

/Users/Michael/Documents/Morning_Coffee/app/views/orders/index.html.erb:39: syntax error, unexpected keyword_ensure, expecting ')'
/Users/Michael/Documents/Morning_Coffee/app/views/orders/index.html.erb:41: syntax error, unexpected keyword_end, expecting ')'
Extracted source (around line #39):

36: 
37: <%= link_to t('.new', :default => t("helpers.links.new")), new_order_path, :class =>       'btn btn-primary' %>
Trace of template inclusion: app/views/orders/index.html.erb

Rails.root: /Users/Michael/Documents/Morning_Coffee

Application Trace | Framework Trace | Full Trace
app/controllers/orders_controller.rb:7:in `index' 
```

这是 index.html：

```
<%- model_class = Order.new.class -%>
    <h1><%=t '.title', :default => model_class.model_name.human.pluralize %></h1>
    <table class="table table-striped">
      <thead>
        <tr>
          <th><%= model_class.human_attribute_name(:id) %></th>
          <th><%= model_class.human_attribute_name(:drink %></th>
          <th><%= model_class.human_attribute_name(:time) %></th>
          <th><%= model_class.human_attribute_name(:price) %></th>
          <th><%= model_class.human_attribute_name(:created_at) %></th>
          <th><%=t '.actions', :default => t("helpers.actions") %></th>
        </tr>
      </thead>
      <tbody>
        <% @orders.each do |order| %>
          <tr>
            <td><%= link_to order.id, order_path(order) %></td>
            <td><%= order.drink %></td>
            <td><%= order.time %></td>
            <td><%= order.price %></td>
            <td><%= order.created_at %></td>
            <td>
          <%= link_to t('.edit', :default => t("helpers.links.edit")),
                      edit_order_path(order), :class => 'btn btn-mini' %>
          <%= link_to t('.destroy', :default => t("helpers.links.destroy")),
                      order_path(order),
                      :method => :delete,
                      :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?')),
                      :class => 'btn btn-mini btn-danger' %>

        </td>
      </tr>
    <% end %>
  </tbody>
</table>

<%= link_to t('.new', :default => t("helpers.links.new")), new_order_path, :class => 'btn btn-primary' %> 
```

并且，控制器中的索引函数：

```
def index
  @orders = Order.all

  respond_to do |format|
    format.html # index.html.erb
    format.json { render json: @orders }
  end
end 
```

我找不到两个缺少的括号。我错过了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T00:23:15.020

这里缺少一个：

```
<th><%= model_class.human_attribute_name(:drink %></th> 
```

这有帮助吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T00:22:11.900

在这种情况下，最好的办法是寻找它告诉你的错误

```
<th><%= model_class.human_attribute_name(:drink %></th> 
```

应该

```
<th><%= model_class.human_attribute_name(:drink) %></th> 
```

# php - 如何可靠地获取 PHP 中的当前 URL？

> ID：10825975
> 
> 赞同：-2
> 
> 时间：2012-05-31T00:19:48.970
> 
> 标签：php

> **可能重复：**
> [如何在 PHP 中获取当前页面的完整 URL](https://stackoverflow.com/questions/189113/how-do-i-get-current-page-full-url-in-php)

我想做这样的事情：

```
if (current url is 'site.com/dir1')
    do something;
else if (current url is 'site.com')
    do something else; 
```

有什么可靠的方法可以找到这个？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T00:24:29.483

您可以将其与以下内容合成：

```
'http' . (443 == $_SERVER['SERVER_PORT'] ? 's' : '') . '://' . $_SERVER['HTTP_HOST'] . $_SERVER['REQUEST_URI']; 
```

对于 IIS，您不会得到`REQUEST_URI`：

```
if (!isset($_SERVER['REQUEST_URI'])) {
    $_SERVER['REQUEST_URI'] = substr($_SERVER['PHP_SELF'], 1);
    if (isset($_SERVER['QUERY_STRING'])) {
        $_SERVER['REQUEST_URI'] .= '?' . $_SERVER['QUERY_STRING'];
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T00:22:33.153

使用`$_SERVER['REQUEST_URI']`. 这应该为您提供访问者正在使用的 URL。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-31T00:22:37.533

```
if($_SERVER['REQUEST_URI']=="url"){} 
```

应该做的伎俩。

# javascript - 防止 Javascript 在遇到错误时停止

> ID：10825992
> 
> 赞同：20
> 
> 时间：2012-05-31T00:23:01.667
> 
> 标签：javascript, jquery

我们的产品将脚本插入客户的网站，有点像实时聊天框。

通常，客户的网站有错误的 javascript 也会停止我们的代码（遇到错误时浏览器会停止执行）。即使控制台中出现关于未定义方法或变量之类的错误，有什么方法可以让我们的代码仍然执行？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-05-31T00:48:03.787

简短的回答是你真的不能。

**“解决方案”#1：**您可以坚持让您的第 3 方代码在其他人的代码之前运行。在大多数情况下，这是不可能的，甚至是不可取的。

**“解决方案”#2：**您可以坚持让第一方工程师将所有第三方代码包装在`try/catch`块中。但是，这个解决方案真的不能给你任何保证，因为第 3 方库经常`<script>`会在页面上附加额外的标签 - 这些不属于`try/catch`包含创建这个/这些标签的代码的范围的“管辖权” .

**“解决方案”#3：**您可以完全在 . 范围内构建您的应用程序`<iframe>`，从而完全避免该问题。不幸的是，即使您非常聪明，您也会很快遇到跨域违规、第 3 方 cookie 限制等问题。这很可能对您不起作用。

**“解决方案”#4：**您可以向您的客户解释该问题，并让他们要求其他第 3 方代码干净地运行。我说这是一个“解决方案”，因为坦率地说，如果您的问题是*如何避免完全这样做*，这不是您问题的“解决方案” 。

不幸的是，选项#4 是您最好的选择。如果您观察到其他 3rd 方库以同样的方式“破坏”可能会有所帮助：您可以告诉您的客户“嘿，不仅仅是我 - X、Y 和 Z 也都因为 <name of other 3rd”而被“破坏”党图书馆>。” 这可能会导致他们对有问题的代码施加压力，从而使网络成为所有相关人员更快乐的地方。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-05-31T01:01:02.837

正如其他人所说，在错误后继续可能不是最好的做法，但您可以试试这个：

```
function ignoreerror()
{
   return true
}
window.onerror=ignoreerror(); 
```

更多细节[在这里](http://www.javascriptkit.com/javatutors/error.shtml)

> 每当发生 JavaScript 错误时都会触发 onerror 事件（取决于您的浏览器配置，您可能会看到一个错误对话框弹出）。onerror 事件附加到 window 对象，这是一个相当不寻常的避难所，但有充分的理由。它以这种方式附加，因此它可以监视页面上的所有 JavaScript 错误，甚至是页面部分中的错误。

Opera 有一个包含[更多详细信息的页面](http://dev.opera.com/articles/view/better-error-handling-with-window-onerror/)

```
Browsers supporting window.onerror
Chrome 13+
Firefox 6.0+
Internet Explorer 5.5+
Opera 11.60+
Safari 5.1+ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T00:42:18.523

您可以让他们在他们的页面中插入一个，`iframe`而不是尝试使用`script`这样的标签注入代码：http: [//jsfiddle.net/EzMGD/](http://jsfiddle.net/EzMGD/)请注意脚本如何引发错误，但我们仍然可以在 iframe 中看到内容。如果适用，iframe 应该有助于使用其他变量。

```
<script>
    MeaningOfLife();
</script>

<iframe src="http://bing.com"></iframe>​ 
```

或者注入代码，使其成为第一个或最后一个`script`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-31T00:25:35.720

您不能从您的代码中获取 - 他们需要使用`try`/`catch`来处理有问题的脚本。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-10-24T17:25:29.170

好吧，对我来说效果很好：

```
element = document.querySelector('.that-pretty-element');
if (element != null) {
    element.onclick = function () {
        alert(" I'm working beibi ;) ");
    }
} 
```

`querySelector()`返回`false`，所以，我们可以用`if's`