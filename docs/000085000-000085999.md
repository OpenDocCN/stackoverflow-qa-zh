# StackOverflow 问答 000085000-000085999

# oracle - PL/SQL 中的 Oracle ORDImage 处理：获取 IMG-00710 和 ORA-01031

> ID：85006
> 
> 赞同：0
> 
> 时间：2008-09-17T16:25:36.930
> 
> 标签：oracle, plsql

我已将图像加载到一个新的、已初始化的 Oracle ORDImage 对象中，并正在通过 PL/SQL 处理它。我可以读取它的属性，但不能使用 process() 方法处理它。

```
vLocalImage ORDImage := ORDImage.init();
...
vLocalImage.source.localdata := PORTAL.wwdoc_admin.get_document_blob_content(pFile);
vLocalImage.setProperties();
...
if vLocalImage.width > lMaxWidth
then
vLocalImage.process('maxScale 534 401');
end if; 
```

这应该缩小图像，保持纵横比，使其宽度不超过 534 像素，高度不超过 401 像素。

但是，我收到以下错误堆栈：

```
Internal error: ORA-29400: data cartridge error
IMG-00710: unable to write to destination image
ORA-01031: insufficient privileges 
```

尝试其他操作（如“旋转 90”）会产生相同的错误。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-31T10:41:50.013

尽管文档说明应该可以“就地”编辑 ORDImage，但我无法使其工作。

相反，我创建了一个新的 ORDImage 对象并使用了 processCopy：

```
 vNewImage ORDImage;
...
    vLocalImage.processCopy('maxScale 534 401', vNewImage); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T11:58:51.837

您能否显示用于获取 l_ordimage 的 select 语句？此错误的主要原因似乎是您的 select 语句中没有“for update”，但我目前无法让 intermedia 进行测试。

# oop - 面向对象的更新方法

> ID：85010
> 
> 赞同：0
> 
> 时间：2008-09-17T16:26:08.537
> 
> 标签：oop, version, updates

我的任务是维护最初用 VB6 编写的应用程序。它已经被导入到 VB .Net 中，至少可以说代码不是面向对象的。代码中充斥着仅包含公共共享属性（变量）和方法（函数）的类，其结果限制了应用程序一次打开多个项目。

一个项目由一个 XML 文件组成，该文件包含一般项目设置，以及包含其他项目相关数据的 Access 数据库的位置。多年来，XML 文件的格式已被修改，并采用了更新和版本控制策略。每当遇到旧版本时，所选策略会在打开时执行更新。到目前为止，更新仅包括重新排列 XML 文件中的数据或更改数据库模式以及将数据从 XML 文件移动到数据库。

对 OOP 有相当多的背景知识，我很容易看出一个项目应该是一个自包含的对象，其他对象与之交互。但是，我看不到如何在 OOP 中应用所选的更新策略。

在 OOP 中实施所选更新策略的问题使我至今无法使用 OOP。如果有人有此类任务的经验，或有关如何进行的建议，我将不胜感激您能提供的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-17T16:36:17.527

构建一个读取 XML 文件的类，并根据该文件中的数据提供属性/方法/等。当该类将 XML 文件写回时，以新版本所需的方式对其进行格式化。

因此，基本上，该类将能够读取当前版本以及所有旧版本，但它总是会写出新版本。

数据将保存在类的内部变量中，而不必每次需要时都扫描 XML 文件。

在这种情况下，将 VERSION 节点添加到您的 XML 文件中也会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T16:47:53.287

当您使用“策略”一词（即策略设计模式）时，您可能已经回答了自己的问题。

可能你可以：

*   创建一个对转换一无所知但接受策略对象的项目类。
*   创建类层次结构以对每个可能的转换策略进行建模。
*   使用工厂方法以正确的策略构建您的项目对象

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T16:53:40.810

我不明白为什么这是一个令人不安的问题。它可以通过多种方式解决。

如果您想做一个完整的面向对象的企业类型的事情，您可以采用以下解决方案的任何子集：

*   创建一个描述其他对象如何与项目交互的接口 IProject。
*   创建实现 IProject 并且可以读取和写入当前版本的 Project 的当前实现。
*   为每个过去的版本扩展项目，覆盖 xml 和数据库读取方法，并在实例化这些类时让构造函数调用 write
*   对于额外的企业性，创建一个 ProjectFactory，它检测文件的版本并实例化正确的版本。
*   如果需要更多版本，请重写当前项目以执行与过去项目相同的操作，使用所有读取访问新版本的 Project，然后调用 write。

此解决方案的优点是您可以继续使用不同的版本，每个新版本只需要从以前的版本更新到的能力，所有以前的版本都可以级联到倒数第二个版本。

# html - 如何让网页向打印机发送与浏览器窗口中不同的内容？

> ID：85019
> 
> 赞同：11
> 
> 时间：2008-09-17T16:27:12.417
> 
> 标签：html, css, browser, printing

谷歌地图过去常常这样做，当您点击“打印”链接时，发送到打印机的内容并不完全是您在屏幕上看到的内容，而是大部分相同信息的不同格式版本。

似乎他们在很大程度上已经远离了这个概念（我猜人们不理解它）并且大多数网站都有文章等内容的“印刷版”。

但是，如果您想制作一个网页，以便将页面的“打印机友好”版本发送到打印机，而无需为其制作单独的页面，您将如何做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-17T16:31:15.467

您可以通过创建一个直接针对打印的 CSS 样式表和另一个直接针对屏幕的 CSS 样式表来实现此效果。

使用链接标签：

```
<link rel="stylesheet" type="text/css" href="print.css" media="print, handheld" />
<link rel="stylesheet" type="text/css" href="screen.css" media="screen" /> 
```

将您的样式表嵌入到您的文档中。

隐藏很容易，只需将您的块样式设置为隐藏在您想要的任何样式表中，它就不会显示。例如：

```
.newStyle1 {
    display: none;
} 
```

然后任何设置为样式的内容`newStyle1`都不会显示。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-17T16:36:13.613

CSS 中的`@media`规则可用于定义打印的替代规则。这通常用于隐藏导航和更改样式以更好地适应打印：

```
@media print {
  .sidebar { display: none; }
} 
```

您还可以链接单独的样式表进行打印：

```
<link rel="stylesheet" href="print.css" type="text/css" media="print" /> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-17T16:28:20.557

当您将媒体指定为打印时，您可以使用 css 执行此操作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T16:29:20.027

使用[打印样式表](http://alistapart.com/stories/goingtoprint/)。

**编辑：**关于后续操作，一般来说，您不能使用 CSS 将内容添加到页面中。

一种选择是在页面中包含您的仅打印内容，并为屏幕样式表隐藏它。你应该确保页面在没有 CSS 的情况下仍然有意义。

另一种选择是使用生成的内容，但这不受 Internet Explorer 7 及更低版本的支持，并且可能非常有限。

如果仅打印内容是图像，您可以使用一种流行的图像替换技术将其交换出来。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-17T16:30:26.433

如果需要，另一种方法是让页面上的“打印”按钮以您决定的某种方式更改页面，然后执行 javascript 'window.print();' 调出浏览器的打印对话框。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-17T16:31:47.740

有几个选项可供您使用：

*   您可以打开一个新窗口，其中要打印的数据略有不同。
*   还有一些 CSS 样式可用于更改页面布局。
*   最后，您可以为屏幕、印刷媒体、盲文阅读器等指定完全不同的样式表。

例如`<link href="css/print.css" type="text/css" rel="stylesheet" media="print" />`

另请参阅[CSS2 打印参考](http://www.w3schools.com/css/css_ref_print.asp)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-17T16:30:43.843

最简单的方法是使用 CSS 媒体类型。对于您包含的每个 CSS 文件，您可以指定应该在哪里使用它：屏幕上、打印时、手持设备、屏幕阅读器或这些的各种组合。

示例：*<link rel="stylesheet" type="text/css" media="print,held" href="foo.css">*

这是自 CSS2 以来的标准，现在大多数浏览器都支持它。更多信息可在此处获得：[http ://www.w3.org/TR/CSS2/media.html](http://www.w3.org/TR/CSS2/media.html)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-17T16:33:07.193

CSS 允许您为特定类型的媒体创建样式表，这意味着您可以拥有一个仅在打印页面时应用的样式表，从而允许您对其进行不同的格式设置。

只需在该样式表的样式表链接上包含一个 media="print" 属性。

这篇[A List Apart 文章](http://alistapart.com/stories/goingtoprint/)在这个主题上似乎相当不错。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-17T16:33:45.413

我尝试根据媒体使用不同的样式表，但在获取所需的所有选项时遇到了麻烦。从那时起，我通常会重定向到我们 (Fusebox) 框架的不同入口（即 print.php 而不是 index.php ) 本质上是同一个文件，只是它设置了一个额外的标志/常量。

然后，在与页面关联的 XSL 文件中，我根据该标志/常量进行额外的工作，例如省略菜单、表格的列等。

即（页面显示用户必须单击才能在屏幕上显示密码的链接。打印版本已打印密码。）

```
if (!BOOL_PRINT)
  echo "<TD class=\"tbl_teams_scroll_item\"><SPAN class=\"span_password_hidden\" id=\"span_password_{\$team_id}\" onClick=\"RevealPassword('{\$team_id}','{\$password}');\"><xsl:value-of select=\"/PAGE/TEXTS/HIDDEN\" /></SPAN></TD>\n";
else
  echo "TD class=\"tbl_teams_scroll_item\"><xsl:value-of select=\"PASSWORD\" /></TD>\n"; 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-17T16:36:28.493

您可以定义特定于媒体类型的 css 规则。下面是一个 css 示例（从[http://www.w3.org/TR/CSS2/media.html](http://www.w3.org/TR/CSS2/media.html)中复制，第 7.2.1 节），它指定了不同的字体大小在网页上显示的内容和打印的内容。

```
 @media print {
    BODY { font-size: 10pt }
  }
  @media screen {
    BODY { font-size: 12pt }
  }
  @media screen, print {
    BODY { line-height: 1.2 }
  } 
```

或者，您可以指定将样式表包含在页面中时应应用于哪些媒体：

```
 <link href="webstyles.css" type="text/css" rel="stylesheet" media="screen"/>
 <link href="printstyles.css" type="text/css" rel="stylesheet" media="print"/>
 <link href="commonstyles.css" type="text/css" rel="stylesheet" media="screen,print"/> 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-17T16:37:39.413

另一种选择是拥有一个隐藏的 IFRAME，您可以在其上调用 iframe.contentWindow.print()。这将允许您创建一个完全按照您想要的方式打印的不可见布局。

当然，更好的解决方案是将文件导出为 PDF 并让用户以这种方式打印出来。PDF 产生最高质量的输出。但是，用户要跳越多，所以经验法则是：

*   打印布局重要时的 PDF
*   纯文本比布局更重要时的 HTML

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-17T20:09:45.330

[nsayer](https://stackoverflow.com/questions/85019/how-can-you-make-a-web-page-send-to-the-printer-something-different-than-whats/85052#85052)提到有一个打印按钮可以改变你的屏幕布局，然后启动一个`window.print()`

这是一个可能会被很多人忽视的解决方案，当您认为您的用户想要更多的所见即所得时应该考虑这种解决方案。它可能应该是一个“打印机友好”的链接，尽管它会改变您的工作表的媒体类型，而不是“打印这个”。

使用 jquery，您可以执行以下操作（未选中）：

```
$(document).ready(function(){
    $("#printFriendly").click(function(){
       $(link[rel=link][media=screen]).remove();
       $(link[rel=link][media=print]).attr("media","screen");
    });
}); 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-25T17:48:35.327

你可以用 CSS 做的任何事情都可以在打印样式表中做。这意味着您可以隐藏屏幕版本中显示的打印版本中的内容，或者隐藏您希望在打印时显示的屏幕版本中的内容。您只需将 display:none 应用于相应样式表中的相应部分。

此外，为打印版本调整文本大小也是一个好主意（这对于屏幕版本来说是个*坏*主意 - 在这里坚持像素、ems 或百分比）。由于像素到点的映射会因不同的分辨率设备而异，所以对于打印点大小的位置存在普遍共识。

# .net - 在 C++/CLI 中将 std::vector<>::iterator 转换为 .NET 接口

> ID：85033
> 
> 赞同：5
> 
> 时间：2008-09-17T16:28:44.537
> 
> 标签：.net, arrays, vector, c++-cli, marshalling

我正在包装一个本机 C++ 类，它具有以下方法：

```
class Native
{
    public:
    class Local
    {
        std::string m_Str;
        int m_Int;
    };

    typedef std::vector<Local> LocalVec;
    typedef LocalVec::iterator LocalIter;

    LocalIter BeginLocals();
    LocalIter EndLocals();

    private:
        LocalVec m_Locals;
}; 
```

1) 表示这种接口的“.NET 方式”是什么？返回数组<>的单个方法？array<> 泛型是否有迭代器，以便我可以实现 BeginLocals() 和 EndLocals()？

2) Local 是否应该在 .NET 包装器中声明为**值结构？**

我真的很想用 .NET 风格来表示包装类，但我对托管世界很陌生——这种类型的信息让谷歌感到沮丧......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-17T17:03:41.627

迭代器不能完全转换为“.net 方式”，但它们大致被 IEnumerable < T > 和 IEnumerator < T > 取代。

而不是

```
 vector<int> a_vector;
  vector<int>::iterator a_iterator;
  for(int i= 0; i < 100; i++)
  {
    a_vector.push_back(i);
  }

  int total = 0;
  a_iterator = a_vector.begin();
  while( a_iterator != a_vector.end() ) {
    total += *a_iterator;
    a_iterator++;
  } 
```

你会看到（在 C# 中）

```
List<int> a_list = new List<int>();
for(int i=0; i < 100; i++)
{
  a_list.Add(i);
}
int total = 0;
foreach( int item in a_list)
{
  total += item;
} 
```

或者更明确地（不将 IEnumerator 隐藏在 foreach 语法糖后面）：

```
List<int> a_list = new List<int>();
for (int i = 0; i < 100; i++)
{
    a_list.Add(i);
}
int total = 0;
IEnumerator<int> a_enumerator = a_list.GetEnumerator();
while (a_enumerator.MoveNext())
{
    total += a_enumerator.Current;
} 
```

如您所见，foreach 只是为您隐藏了 .net 枚举器。

所以说真的，“.net 方式”只是允许人们为自己创建 List<Local> 项目。如果您确实想控制迭代或使集合更加自定义，请让您的集合也实现 IEnumerable< T > 和/或 ICollection< T > 接口。

几乎直接翻译为 c# 几乎就是您所假设的：

```
public class Native
{
  public class Local
  { 
     public string m_str;
     public int m_int;
  }

  private List<Local> m_Locals = new List<Local>();

  public List<Local> Locals
  {
    get{ return m_Locals;}
  }
} 
```

然后用户将能够

```
foreach( Local item in someNative.Locals)  
{
 ... 
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T19:45:20.380

@Phillip - 谢谢，你的回答真的让我朝着正确的方向开始。

**在看到您的代码并在 Nish 的书C++/CLI in Action**中进行更多阅读后，我认为使用一个索引属性返回一个 const 跟踪句柄到托管堆上的 Local 实例可能是最好的方法。我最终实现了类似于以下内容：

```
public ref class Managed
{
    public:
    ref class Local
    {
        String^ m_Str;
        int m_Int;
    };

    property const Local^ Locals[int]
    {
        const Local^ get(int Index)
        {
            // error checking here...
            return m_Locals[Index];
        }
    };

    private:
        List<Local^> m_Locals;
}; 
```

# mysql - SqlServer 使用 MySql 创建表，如 auto_increment 主键

> ID：85034
> 
> 赞同：11
> 
> 时间：2008-09-17T16:28:49.137
> 
> 标签：mysql, sql-server, auto-increment

我想在 SqlServer 中创建一个表，该表将在插入时添加一个自动递增的主键。这应该是一个类似于 MySql auto_increment 功能的自动增量 id。（以下）

```
create table foo  
(  
user_id int not null auto_increment,  
name varchar(50)  
) 
```

有没有办法在不创建插入触发器的情况下做到这一点？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-09-17T16:29:30.743

像这样

```
create table foo  
(  
user_id int not null identity,  
name varchar(50)  
) 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-09-17T18:22:30.050

OP 请求了一个自动递增的主键。IDENTITY 关键字本身并不使列成为主键。

```
CREATE TABLE user
(
  TheKey int IDENTITY(1,1) PRIMARY KEY,
  Name varchar(50)
) 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-10-28T19:56:53.887

他们已经回答了您的问题，但我想为刚开始使用身份列的人添加一点建议。有时您必须返回刚刚插入的标识的值，以便您可以插入到相关表中。许多来源会告诉您使用@@identity 来获取此值。如果您想保持数据完整性，在任何情况下都不应使用@@identity。如果将其中一个添加到另一个表中，它将给出在触发器中创建的标识。由于您不能保证@@identity 的值始终正确，因此最好不要使用@@identity。改为使用 scope_identity() 来获取此值。我知道这有点离题，但它对您了解如何在 SQL Server 中使用身份很重要。相信我，您不想解决相关记录输入错误的身份值的问题。在被发现之前，这可能会在几个月内悄悄地出错，之后几乎不可能修复数据。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-17T19:18:45.047

正如其他人所提到的：将 IDENTITY 属性添加到列中，并使其成为主键。

但是，MSSQL 的 IDENTITY 和 MySQL 的 AUTO_INCREMENT 之间存在差异：

*   MySQL 要求为 AUTO_INCREMENT 列定义唯一约束（通常以主键的形式）。
    MSSQL 没有这样的要求。
*   MySQL 允许您手动将值插入到 AUTO_INCREMENT 列中。
    MSSQL 阻止您手动将值插入 IDENTITY 列；如果需要，您可以通过在插入之前发出“SET IDENTITY_INSERT tablename ON”命令来覆盖它。
*   MySQL 允许您更新 AUTO_INCREMENT 列中的值。
    MSSQL 拒绝更新 IDENTITY 列中的值。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-17T16:29:17.980

只需将该字段设置为[身份字段](http://msdn.microsoft.com/en-us/library/aa933196.aspx)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-17T16:29:32.723

将字段声明为身份

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-17T17:55:57.103

如上所述，使用 IDENTITY 字段。

```
CREATE TABLE foo
(
user_id int IDENTITY(1,1) NOT NULL,
name varchar(50)
) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-17T17:52:17.597

正如其他人所说，只需设置 Identity 选项。

# sql-server - 如何快速识别 SQL Server 中最近修改的存储过程

> ID：85036
> 
> 赞同：29
> 
> 时间：2008-09-17T16:29:01.180
> 
> 标签：sql-server, stored-procedures, migration

我需要手动将修改后的存储过程从 DEV SQL Server 2005 数据库实例迁移到 TEST 实例。除了我要迁移的更改之外，数据库具有相同的架构。如何快速识别 DEV 数据库中哪些存储过程已被修改以迁移到 TEST 实例？

我假设我可以针对某些系统表编写查询以查看存储过程类型的数据库对象，按某种最后修改或编译的数据进行排序，但我不确定。也许有人可以指出某种免费实用程序。

提前致谢，

鲍勃

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2008-09-17T16:44:35.387

而不是使用不再推荐的 sysobjects 使用 sys.procedures

```
select name,create_date,modify_date
from sys.procedures
order by modify_date desc 
```

您可以自己执行 where 子句，但这将按修改日期降序排列

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-09-17T16:34:52.447

您可以执行此查询以查找在过去 x 天中修改的所有存储过程：

```
SELECT name
FROM sys.objects
WHERE type = 'P'
    AND DATEDIFF(D,modify_date, GETDATE()) < X 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2013-09-04T14:04:45.067

Bob OMalley 可能很久以前就解决了他的问题，但希望新读者会发现这很有用。

在某些特殊情况下，脚本可能无法提供最佳结果。

一种是在开发环境中删除存储过程或其他对象——你不会使用系统视图捕捉到这一点，因为对象将不再存在。

另外，我不确定这种方法是否可以用于权限等更改。

在这种情况下，最好使用一些第三方工具来仔细检查是否有遗漏。

我过去曾成功地将[ApexSQL Diff](http://www.apexsql.com/sql_tools_diff.aspx)用于类似的任务，它在具有 1000 多个对象的大型数据库上工作得非常好，但使用这里已经提到的 SQL 比较或基本上市场上存在的任何其他工具都不会出错。

免责声明：我不隶属于我在这里提到的任何供应商，但我确实在我工作的公司中使用了这两种工具（Apex 和 RG）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-17T16:32:17.570

[虽然不是免费的，但我在使用 Red-Gates SQL 比较工具](http://www.red-gate.com/products/SQL_Compare/index.htm)方面有很好的经验。过去它对我有用。他们提供免费试用版，可能足以解决您当前的问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-17T16:36:31.397

您还可以使用以下代码片段

```
USE AdventureWorks2008;

GO

SELECT SprocName=name, create_date, modify_date

FROM sys.objects

WHERE type = 'P' 

AND name = 'uspUpdateEmployeeHireInfo'

GO 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T16:33:34.210

您可以使用以下类型的查询来查找修改后的存储过程，您可以根据需要使用任何数字然后 7

```
SELECT name
    FROM sys.objects
    WHERE type = 'P'
        AND DATEDIFF(D,modify_date, GETDATE()) < 7 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-17T16:40:38.237

有几种数据库比较工具。我一直喜欢的一个是[Red Gate](http://www.red-gate.com)的 SQLCompare 。

您也可以尝试使用：

```
SELECT name
FROM sys.objects
WHERE modify_date > @cutoffdate 
```

在 SQL 2000 中，这并不总是有效，因为使用 ALTER 没有正确更新日期，但在 2005 年，我相信这个问题已经解决。

我自己使用 SQL 比较工具，所以我不能 100% 保证该方法

# java - 可编辑的 JTable 教程

> ID：85046
> 
> 赞同：11
> 
> 时间：2008-09-17T16:29:39.540
> 
> 标签：java, swing, jtable

有没有好书或网站可以创建一个`JTable`? 我想让一列可编辑。我想实际上将一个继承的`JCheckBox`组件（我们在此处创建）放入其中一个表列中，而不是仅仅`JCheckBox`基于它是一个可编辑`boolean`字段而将表放入其中。

我有[JFC Swing 教程第二版](https://rads.stackoverflow.com/amzn/click/com/0201914670)书，但我只是想知道是否有其他示例可以查看并学习如何更好地处理表格。这本书似乎只是将java'trail'放在网上并将其放入书中。

不过，我正在重新阅读这些东西，只是好奇是否有人发现了一些可能会有所帮助的东西。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-09-19T20:35:33.527

要使列可编辑，您必须覆盖`isCellEditable`. `TableModel`如果您继承，则创建 a`TableModel`相当容易`AbstractTableModel`，除了最简单`JTable`的 s 之外，我会推荐它。

但是，调整`TableModel`只是您需要做的一部分。要在 中实际获取自定义组件`JTable`，您需要设置自定义单元格渲染器。要使用交互式自定义组件，您需要设置自定义单元格编辑器。在某些情况下，为此使用默认类的略微修改版本就足够了。

**编辑**

如果您已经有了一个自定义组件，可以使用委托轻松完成：创建一个新的实现类`TableCellEditor`，并在方法中返回该组件的一个**新**实例`getCellEditorComponent`。此方法的参数包括当前值以及单元格坐标、返回表格的链接以及是否选择了单元格。

`TableCellEditor`也有一个方法，当用户提交对单元格内容的更改（您可以在其中验证用户输入和调整模型）或取消编辑时调用该方法。如果您曾经以编程方式中止编辑，请务必`stopEditing()`在您的编辑器上调用该方法，否则编辑器组件将保留在屏幕上——这曾经花了我大约 2 个小时来调试。

请注意，在`JTable`编辑器中，**只有**编辑器才能接收事件！可以使用渲染器来显示按钮。但是要获得功能正常的按钮，您需要实现一个正确`EventListeners`注册的编辑器。在渲染器上注册一个监听器什么都不做。

**渲染器**

对于您在问题中描述的内容，实施渲染器并不是绝对必要的，但您通常最终还是会这样做，即使只是进行小的修改。与编辑器不同，渲染器对速度至关重要。*为表格中的`getTableCellRendererComponent`每个单元格调用一次渲染器！*渲染器返回的组件仅用于绘制单元格，不用于交互，因此可以“重用”下一个单元格。换句话说，您应该在渲染器中调整组件（例如，使用`setText(...)`或者`setFont(...)`如果它是 a ），您*不*应该实例化一个新组件——这是一种削弱性能的简单方法。`TextComponent`

 ***注意事项**

请注意，要使渲染器和编辑器正常工作，您需要告知`JTable`何时使用某个渲染器/编辑器。基本上有两种方法可以做到这一点。您可以使用相应的方法**为特定类型**设置默认单元格渲染器/编辑器。`JTable`为了使这种方式起作用，您`TableModel`需要在`getColumnClass(...)`方法中准确地返回这种类型！默认表模型**不会**为您执行此操作，它总是返回`Object.class`. 我敢肯定，它难倒了很多人。

设置编辑器/渲染器的另一种方法是在列本身上显式设置它，即`TableColumn`通过. 这要复杂得多，但是，它也是为单个类拥有两个不同的渲染器/编辑器的唯一方法。例如，您的模型可能有两列 String 类，它们以完全不同的方式呈现，可能一次使用 a ，另一列使用 a来访问更精细的编辑器。`getTableColumn(...)``JTable``JLabel/DefaultRenderer``JButton`

`JTable`它的自定义渲染器和编辑器*非常*通用，但它也有很多需要考虑的地方，而且有很多事情要做错。祝你好运！

任何自定义 JTables 的人都必须阅读[如何使用](http://java.sun.com/docs/books/tutorial/uiswing/components/table.html)[Swing 教程](http://java.sun.com/docs/books/tutorial/uiswing/index.html)中的表格。特别是，阅读和重新阅读[概念：编辑器和渲染器，](http://java.sun.com/docs/books/tutorial/uiswing/components/table.html#editrender)因为它通常需要一段时间才能“点击”。自定义渲染器和编辑器的示例也非常值得。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T16:41:49.870

您想要研究扩展以创建自己的行为的类是 DefaultTableModel。这将允许您定义自己的行为。[在 sun 的网站上](http://java.sun.com/docs/books/tutorial/uiswing/components/table.html#data)可以找到一个不错的教程。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T16:55:17.233

这个来自[java 大厅](http://www.javalobby.org/articles/jtable/)的教程很容易理解。[您引用的 JTable](http://java.sun.com/docs/books/tutorial/uiswing/components/table.html)的在线Swing 跟踪表明它已更新。您是否浏览了整个事情以获得可能更好（不是更新总是更好）的信息？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-22T19:36:40.897

如果您尝试使用`JTable`具有 1 列可编辑的简单并且您知道列位置，您可以始终使用默认表模型并重载`isCellEditable`调用。

像这样的东西：

```
myTable.setModel(new DefaultTableModel(){
@Override
public boolean isCellEditable(int row, int column) {
    if (column == x) {
        return true;
    } else
        return false;
}
}); 
```

并为复选框创建一个渲染器类

```
MyCheckBoxRenderer extends JCheckBox implements TableCellRenderer 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-19T19:56:15.993

一些有用的类是：

`Package javax.swing.table`：

`TableModel`- 一个接口`tablemodel` `AbstractTableModel`- 很好的类来扩展以使用自定义数据结构创建您自己的表 `DefaultTableModel`- 可以处理`arrays[]`和处理的默认表模型`Vectors`

要禁用对任何单元格的编辑，您需要覆盖该`isCellEditable(int row, int col)`方法

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-09-05T10:09:47.803

在您的表模型中，您应该覆盖“isCellEditable”和“setValueAt”函数，如下所示。
第 4 列是可编辑单元格的列。
然后，当您双击单元格并键入内容时，
将调用 setValueAt() 并将值保存到 tableModel 的 DO，字段 col4。

```
public ArrayList<XXXDO> tbmData = new ArrayList<XXXDO>(); //arraylist for data in table

@Override
public boolean isCellEditable(int row, int col) {
    if (col == 4) {
        return true;
    } else {
        return false;
    }
}

@Override
public void setValueAt(Object value, int row, int col) {
    if ((row >= 0) && (row < this.tbmData.size()) && (col >= 0) && (col < this.colNm.length)) {
        if (col == 4) {
            tbmData.get(row).col4= (String) value;
        }
        fireTableCellUpdated(row, col);
    } else {
    }
} 
```

# git - Git 优于电子邮件？

> ID：85051
> 
> 赞同：14
> 
> 时间：2008-09-17T16:30:20.023
> 
> 标签：git, version-control

假设网络访问是零星的，没有中央服务器，使用 git 保持三个或更多分支同步的最佳方法是什么？有没有办法只提取我的增量，通过电子邮件发送它们，然后在另一端合并它们？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-09-20T09:39:05.157

虽然“git format-patch”和“git am”是管理来自非 git 源的补丁的好方法，但对于 git 存储库，您应该研究“git bundle”。

“git bundle”和子命令“create”和“unbundle”可用于创建和使用增量提交的二进制blob，可用于通过替代文件传输机制（例如电子邮件）跨“弱”链接传输分支历史记录，蜗牛邮件等）。

git bundle 将保留提交 ID，而 format-patch/am 不会导致目标提交不相同（不同的 SHA1）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-17T16:32:58.800

[`git-format-patch`](http://www.kernel.org/pub/software/scm/git/docs/git-format-patch.html)请参阅和的主页[`git-am`](http://www.kernel.org/pub/software/scm/git/docs/git-am.html)。这是系统最初设计使用的方式之一。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-17T16:33:47.393

git 中有一些工具可用于邮寄补丁或导入邮寄的补丁：**git-am**（从邮箱应用补丁）、**git-format-patch**（准备邮件以进行邮寄）、**git-send-email**（发送一组通过邮件打补丁）等等。 man 1 git 有一个完整的列表。

# jvm - 为什么我们需要其他 JVM 语言

> ID：85058
> 
> 赞同：24
> 
> 时间：2008-09-17T16:30:50.770
> 
> 标签：jvm, compatibility

我[在这里](http://www.is-research.de/info/vmlanguages/index.html)看到除了 Java 之外还有很多在 JVM 上运行的语言。我对在 JVM 中运行的其他语言的整个概念有点困惑。所以：

为 JVM 提供其他语言有什么好处？

为 JVM 编写语言/编译器需要什么（高级术语）？

您如何在 JVM 中以一种语言（Java 除外）编写/编译/运行代码？

* * *

**编辑：**在接受的答案中回答了 3 个后续问题（最初是评论）。为了便于阅读，它们在这里重印：

使用 JPython 编写的应用程序如何与 Java 应用程序交互？

此外，该 JPython 应用程序可以使用任何 JDK 函数/对象吗？

如果它是 Jaskell 代码，它是一种函数式语言这一事实​​是否不会使其与 JDK 不兼容？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2008-09-17T18:35:31.453

分别解决您的三个问题：

> 为 JVM 提供其他语言有什么好处？

这里有两个因素。(1) 为什么 JVM 有 Java 以外的语言，以及 (2) 为什么在 JVM 上运行另一种语言，而不是不同的运行时？

1.  其他语言可以满足其他需求。[例如，Java 没有对闭包](http://en.wikipedia.org/wiki/Closure_(computer_science))的内置支持，这个特性通常非常有用。
2.  在 JVM 上运行的语言是与在 JVM 上运行的任何其他语言兼容的字节码，这意味着用一种语言编写的代码可以与用另一种语言编写的库进行交互。

> 为 JVM 编写语言/编译器需要什么（高级术语）？

JVM 读取字节码 (.class) 文件以获取它需要执行的指令。因此，任何要在 JVM 上运行的语言都需要编译为符合[Sun 规范](http://java.sun.com/docs/books/jvms/second_edition/html/ClassFile.doc.html)的字节码。此过程类似于编译为本机代码，不同之处在于不是编译为 CPU 可以理解的指令，而是将代码编译为 JVM 解释的指令。

> 您如何在 JVM 中以一种语言（Java 除外）编写/编译/运行代码？

与您在 Java 中编写/编译/运行代码的方式非常相似。为了让您的脚湿透，我建议您查看[Scala](http://www.scala-lang.org/)，它可以在 JVM 上完美运行。

回答您的后续问题：

> 使用 JPython 编写的应用程序如何与 Java 应用程序交互？

这取决于实现选择弥合语言差距。在您的示例中，[Jython 项目](http://www.jython.org/Project/)有一种直接的方法来执行此操作（[请参见此处](http://wiki.python.org/jython/UserGuide#accessing-java-from-jython)）：

```
from java.net import URL
u = URL('http://jython.org') 
```

> 此外，该 JPython 应用程序可以使用任何 JDK 函数/对象吗？

是的，见上文。

> 如果它是 Jaskell 代码，它是一种函数式语言这一事实​​是否不会使其与 JDK 不兼容？

不。例如，Scala（上面的链接）实现了功能特性，同时保持与 Java 的兼容性。例如：

```
object Timer {
  def oncePerSecond(callback: () => unit) {
    while (true) { callback(); Thread sleep 1000 }
  }
  def timeFlies() {
    println("time flies like an arrow...")
  }
  def main(args: Array[String]) {
    oncePerSecond(timeFlies)
  }
} 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-09-17T16:37:16.573

您在 JVM 上需要其他语言的原因与您通常需要多种编程语言的原因相同：不同的语言更适合解决不同的问题……静态类型与动态类型、严格与惰性……声明式、命令式、面向对象... ETC。

一般来说，为另一种语言编写一个“编译器”以在 JVM（或 .Net CLR）上运行，本质上是将这种语言编译成 java 字节码（或者在 .Net 的情况下，IL）而不是汇编/机器语言。

也就是说，为 JVM 编写的许多额外语言不是编译的，而是解释性脚本语言......

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-09-17T17:44:35.117

反过来，考虑一下您想要设计一种新语言，并且希望它在带有 JIT 和 GC 的托管运行时中运行。然后考虑你可以：

(a) 编写自己的托管运行时 (VM) 并解决各种技术难题，这些问题无疑会导致许多错误、性能不佳、线程不当和大量可移植性工作

或者

(b) 将你的语言编译成可以在 Java VM 上运行的字节码，Java VM 已经非常成熟、快速并且在许多平台上都受支持（有时有不止一种供应商实现选择）。

鉴于 JavaVM 字节码与 Java 语言的联系并不紧密，以至于过度限制了您可以实现的语言类型，因此它一直是希望在 VM 中运行的语言的流行目标环境。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-17T16:38:27.803

Java 是一种相当冗长的编程语言，随着过去 5 年出现的所有新奇语言/框架，它很快就过时了。为了支持人们在语言中想要的所有花哨的语法并保持向后兼容性，向运行时添加更多语言更有意义。

另一个好处是它允许您在一个可能已经在许多公司生产的经过验证的托管平台上运行一些用 Ruby ala JRuby（又名 Rails）或 Grails（本质上是 Groovy on Railys）等编写的 Web 框架，而不必使用它几乎不像经过试验和测试的 Ruby 托管环境。

要编译其他语言，您只需将其转换为 Java 字节码。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-17T16:35:18.390

我会回答，“因为[Java 很烂](http://www.google.com/search?&q=java%20sucks)”，但话又说回来，也许这[太明显了](http://en.wikipedia.org/wiki/Criticism_of_Java)…… ;-)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-17T16:39:47.490

为 JVM 使用其他语言的优势与为计算机使用其他语言的优势大致相同：虽然所有图灵完备的语言在技术上都可以完成相同的任务，但某些语言使某些任务比其他语言更容易，而其他语言使其他任务更轻松。由于 JVM 是我们已经能够在所有（嗯，几乎所有）计算机上运行的东西，而且实际上已经有很多计算机，我们可以获得“一次编写，随处运行”的好处，但不需要那个使用Java。

为 JVM 编写语言/编译器与为真机编写语言/编译器并没有什么不同。真正的区别在于您必须编译为 JVM 的字节码而不是机器的可执行代码，但这在总体方案中确实是一个很小的区别。

在 JVM 中为 Java 以外的语言编写代码实际上与编写 Java 没有什么不同，当然，您将使用不同的语言。您将使用某人为其编写的编译器进行编译（同样，从根本上说，与 C 编译器没有太大区别，与 Java 编译器几乎没有什么不同），您最终将能够运行它就像您编译 Java 代码一样，因为一旦它在字节码中，JVM 就无法分辨它来自什么语言。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-17T16:41:21.540

不同的语言适用于不同的任务。虽然某些问题域非常适合 Java 语言，但有些问题域更容易用替代语言表达。此外，对于习惯使用 Ruby、Python 等的用户来说，生成 Java 字节码并利用 JDK 类和 JIT 编译器的能力具有明显的优势。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-17T16:54:47.560

只回答你的第二个问题：

JVM 只是一个抽象的机器和执行模型。因此，使用编译器定位它与编译器可能定位的任何其他机器和执行模型相同，无论是在硬件（x86、CELL 等）还是软件（parrot、.NET）中实现。JVM 相当简单，因此它实际上是编译器相当容易的目标。此外，实现往往具有非常好的 JIT 编译器（处理 javac 生成的糟糕代码），因此您可以获得良好的性能而不必担心很多优化。

有几点需要注意。首先，JVM 直接体现了 java 的模块和继承系统，因此尝试做任何其他事情（多重继承、多重分派）可能会很棘手，并且需要复杂的代码。其次，JVM 被优化以处理 javac 生成的那种字节码。生成与此完全不同的字节码可能会进入 JIT 编译器/JVM 的奇怪角落，这可能充其量是低效的（在最坏的情况下，它们可能会使 JVM 崩溃或至少给出虚假的 VirtualMachineError 异常）。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-17T16:34:50.370

JVM 可以做什么是由 JVM 的字节码（您在 .class 文件中找到的）而不是源语言定义的。因此，更改高级源代码语言不会对可用功能产生重大影响。

至于为 JVM 编写编译器需要什么，您真正需要做的就是生成正确的字节码 / .class 文件。如何使用替代编译器编写/编译代码取决于所讨论的编译器，但是一旦编译器输出 .class 文件，运行它们与运行 javac 生成的 .class 文件没有什么不同。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-17T16:41:05.207

这些其他语言的优势在于它们可以相对轻松地访问大量 java 库。

Java 人员的优势因语言而异——每个人都有一个故事告诉 Java 编码人员他们做得更好。有些人会强调如何使用它们将动态脚本添加到基于 JVM 的应用程序中，其他人只会谈论他们的语言如何更易于使用、具有更好的语法等等。

编写任何其他语言编译器所需的是相同的东西：解析为 AST，然后将其转换为目标架构的指令（字节码）并将其存储为正确的格式（.class 文件）。

从用户的角度来看，您只需编写代码并运行编译器二进制文件，就会生成 .class 文件，您可以将这些文件与您的 java 编译器生成的文件混合在一起。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-17T16:49:03.097

.NET 语言更多的是为了展示而不是实际用处。每种语言都被如此屠杀，以至于它们都是带有新面孔的 C#。

为 Java VM 提供替代语言的原因有很多：

*   JVM 是多平台的。任何移植到 JVM 的语言都可以免费获得它。
*   那里有相当多的遗留代码。ColdFusion 等过时的引擎性能更好，同时为客户提供了将他们的应用程序从传统解决方案缓慢过渡到现代解决方案的能力。
*   某些形式的脚本更适合快速开发。例如，JavaFX 的设计考虑了快速图形开发。通过这种方式，它可以与 DarkBasic 等引擎竞争。（处理是这个领域的另一个参与者。）
*   脚本环境可以提供控制。例如，应用程序可能希望向用户公开类似 VBA 的环境，而不公开底层 Java API。使用 Rhino 之类的引擎可以提供一个环境，在精心控制的沙箱中支持快速和肮脏的编码。
*   解释脚本意味着不需要重新编译任何东西。无需重新编译转换为更动态的环境。例如，尽管 OpenOffice 将 Java 用作“脚本语言”，但 Java 在这种用途上很糟糕。用户必须经历各种重新编译/重新加载，这在 Javascript 等动态脚本环境中是不必要的。
*   这让我想到了另一点。脚本引擎可以更容易地停止和重新加载，而无需停止和重新加载整个 JVM。这增加了脚本语言的实用性，因为可以随时重置环境。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-09-17T17:38:45.770

编译器编写者生成 JVM 或 CLR 字节码要容易得多。与任何机器语言相比，它们是一种更清晰、更高级别的抽象。正因为如此，尝试创建新语言比以往任何时候都更加可行，因为您所要做的就是针对其中一个 VM 架构，并且您将拥有一组已经可用于您的语言的工具和库。它们让语言设计者更多地关注语言而不是所有必要的支持基础设施。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-01-09T13:32:42.350

因为JSR进程正在渲染Java越来越死： http: [//www.infoq.com/news/2009/01/java7-updated](http://www.infoq.com/news/2009/01/java7-updated)

遗憾的是，即使是像闭包这样重要且众所周知的添加，也只是因为成员无法就实现达成一致而没有添加。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2010-07-02T08:18:23.070

Java 在七个主要版本（从 1.0 到 1.6）上积累了庞大的用户群。它的发展能力受到为生产中运行的数百万行 Java 代码保持向后兼容性的需要的限制。

这是一个问题，因为 Java 需要发展到：

*   与从 Java 的成功和失败中学到的更新的编程语言竞争。
*   结合编程语言设计的新进展。
*   允许用户充分利用硬件的进步——例如多核处理器。
*   修复一些引入意外问题的尖端想法（例如检查异常、泛型）。

向后兼容的要求是保持竞争力的障碍。

如果将 Java 与 C# 进行比较，Java 在成熟的、生产就绪的库和框架方面具有优势，而在语言特性和市场份额增长速度方面则处于劣势。这就是比较两种相隔一代的成功语言所期望的结果。

任何一种新语言都与 C# 相比 Java 在极端程度上具有相同的优势和劣势。在语言特性方面最大化优势并在成熟库和框架方面最小化劣势的一种方法是为现有虚拟机构建语言并使其与为该虚拟机编写的代码互操作。这就是 Groovy 和 Clojure 取得适度成功的原因。以及围绕 Scala 的兴奋。如果没有 JVM，这些语言只能在非常专业的细分市场中占据很小的一席之地，而有了 JVM，它们在主流中占据了重要的利基。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-09-17T16:32:02.483

他们这样做是为了跟上 .Net 的步伐。.Net 允许 C#、VB、J#（以前）、F#、Python、Ruby（即将推出）和 c++。我可能错过了一些。对于脚本编写人员来说，其中最重要的可能是 Python。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-09-17T16:45:08.537

在某种程度上，它可能是针对 .NET CLR 的“军备竞赛”。

但我认为将新语言引入 JVM 也有真正的原因，特别是当它们将“并行”运行时，您可以使用正确的语言来完成正确的工作，像 Groovy 这样的脚本语言可能正是您所需要的您的页面展示，而常规的旧 Java 更适合您的业务逻辑。

我将让更有资格的人来讨论编写新语言/编译器所需的内容。

至于怎么写代码，你照常在notepad/vi里写！（或者，如果您想以简单的方式进行，则使用支持该语言的开发工具。）编译将需要该语言的特殊编译器，该编译器将其解释并编译成字节码。

由于 java 在技术上也生成字节码，因此您无需执行任何特殊操作即可运行它。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-01-09T13:57:29.413

原因是JVM平台提供了很多优势。

*   数量庞大的图书馆
*   更广泛的平台实施
*   成熟的框架
*   已成为基础架构一部分的遗留代码

Sun 试图通过其脚本规范支持的语言（例如 Python、Ruby）正在兴起，主要是由于它们感知到的生产力增强。从理论上讲，运行 Jython 可以让您更有效率，并利用*Python*的功能来解决更适合 Python 的问题，但仍然能够在运行时级别上与您现有的代码库集成。*Python*和*Ruby*的经典实现对**C**库具有相同的功能。

此外，用动态语言表达某些东西通常比用 Java 更容易。如果是这种情况，你可以走另一条路；使用来自*Java的**Python/Ruby*库。

 *性能会受到影响，但许多人愿意接受这一点，以换取更简洁、更清晰的代码库。

# artificial-intelligence - 如何实现 A* 寻路算法，每种编程语言都有移动成本？

> ID：85065
> 
> 赞同：29
> 
> 时间：2008-09-17T16:31:36.010
> 
> 标签：artificial-intelligence, path-finding, a-star

**我们能否让人们以每种语言发布 A* 寻路算法的简单优化实现代码？**

这主要是为了好玩和玩 stackoverflow 本身的能力......虽然我实际上有兴趣获得一个 ActionScript 3 版本。

但想法是，即使创建了不同的编程语言，这个“问题”也将在未来不断更新！

我不知道在网上还有其他地方可以看到伪代码“翻译”成许多（更不用说每种）不同的语言。似乎它是一个有价值的资源，虽然不一定是这个网站的设计目的，但尝试一下并看看它是否是一个可以使用 stackoverflow 的有价值的东西并没有什么坏处！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-03T20:47:14.117

这是一个[JavaScript 实现](http://www.briangrinstead.com/blog/astar-search-algorithm-in-javascript/)，以及[源代码](http://www.briangrinstead.com/blog/astar-search-algorithm-in-javascript/)和我作为爱好/研究项目所做 的[在线演示。](https://github.com/bgrins/javascript-astar)

这非常简单，但您可以更改一些参数（网格大小、墙数、调试信息开/关）。它将显示计算出的每个被检查节点的 f(x)、g(x) 和 h(x) 值。

演示页面实现使用 jQuery。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-27T01:58:34.623

这是一个 C++ 实现。到目前为止，它经过了很好的测试，并用于商业视频游戏和各种 AI 项目。

[http://code.google.com/p/a-star-algorithm-implementation/](http://code.google.com/p/a-star-algorithm-implementation/)

还有一个教程，实际上是我先写的：

[http://www.heyes-jones.com/astar.html](http://www.heyes-jones.com/astar.html)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-17T16:33:56.347

这是由构建该语言的人之一完成的[C# 实现。](http://blogs.msdn.com/ericlippert/archive/tags/AStar/default.aspx)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-12-31T04:59:41.580

Source codes and demos in different programming languages:

List of demo's for each language:

```
C++: 1
Java: 3
Processing: 1
Actionscript 3 (Flash): 4
Flex (Flash): 1
Javascript: 6
C#: 1
Ruby: 1
Prolog: 1
Unity: 1
Lua: 1 
```

[Pathfinding Demo in different languages](http://theory.stanford.edu/~amitp/GameProgramming/ImplementationNotes.html#source-code-and-demos)

Enjoy :)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-01-13T15:50:38.797

AS 3 示例... [http://www.dauntless.be/astar/](http://www.dauntless.be/astar/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-10-27T05:18:34.580

我在 C 中实现了 A* 作为学习 C 的一种方式，所以我不能保证它很漂亮，但它确实有效！我用它来解决 Project Euler #83，它适用于两个测试用例。

[https://github.com/PeterMitrano/A-star-Pathfinding/blob/master/problem_83.c](https://github.com/PeterMitrano/A-star-Pathfinding/blob/master/problem_83.c)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-06-05T08:07:24.783

[Clojure](http://www.fatvat.co.uk/2009/07/searching-graphs.html)实现，很大程度上基于[PAIP](http://norvig.com/paip.html)中给出的示例。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-04-16T23:50:35.137

不是实现，但我发现[http://theory.stanford.edu/~amitp/GameProgramming/AStarComparison.html](http://theory.stanford.edu/~amitp/GameProgramming/AStarComparison.html)是对该算法的特别清晰的解释。具有使其非常易于实现的伪代码，以及对可用于实现开放集和封闭集的各种数据结构的扩展回顾，讨论适用于不同情况的不同启发式，修改启发式以获得特定行为（例如，在仅支持有限运动角度的系统中获得直线的近似值）、常见的陷阱（例如，使用与实际运动成本不同的启发式算法）和一些优化（例如，使用统一成本的区域而不是网格）。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-06-29T01:10:13.613

[Python 和 C++ 源代码](http://www.redblobgames.com/pathfinding/a-star/implementation.html)以及[交互式教程](http://www.redblobgames.com/pathfinding/a-star/introduction.html)。该代码通常用于处理图形，而不是特定于网格（您会在网络上的许多 A* 示例中找到）。它使用二进制堆作为优先级队列（Python 和 C++ 在其标准库中都有二进制堆）。我在该页面上有广度优先搜索、Dijkstra 算法和 A*。该代码相当短（比我发现的大多数 A* 示例代码短）。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-08-10T10:47:51.923

GraphHopper 中提供了优化的[Java 实现。](https://github.com/graphhopper/graphhopper/blob/master/core/src/main/java/com/graphhopper/routing/AStar.java)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-17T16:56:05.360

VB6 实现。

[http://www.gandraxa.com/pathfinding_with_a_star.xml](http://www.gandraxa.com/pathfinding_with_a_star.xml)

这特别有用，因为您可以逐步完成该过程并很好地了解算法的工作原理。在将算法转换为另一种语言时，这可能非常有价值。

# c# - .NET Remoting Server 只处理一个请求

> ID：85083
> 
> 赞同：0
> 
> 时间：2008-09-17T16:33:18.470
> 
> 标签：c#, .net, remoting

我正在使用 .NET 远程处理。我的服务器/主机是 Windows 服务。它有时会正常工作，有时它会处理一个请求，然后不再处理（直到我重新启动它）。它作为 Windows 服务运行这是来自 Windows 服务的代码：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Diagnostics;
using System.Linq;
using System.Runtime.Remoting;
using System.Runtime.Remoting.Channels;
using System.Runtime.Remoting.Channels.Tcp;
using System.ServiceProcess;
using System.Text;
using Remoting;

namespace CreateReview
{
    public partial class Service1 : ServiceBase
    {
        public Service1()
        {
            InitializeComponent();
        }

        readonly TcpChannel channel = new TcpChannel(8180);

        protected override void OnStart(string[] args)
        {
            // Create an instance of a channel
            ChannelServices.RegisterChannel(channel, false);

            // Register as an available service with the name HelloWorld
            RemotingConfiguration.RegisterWellKnownServiceType(
                typeof(SampleObject),
                "SetupReview",
                WellKnownObjectMode.SingleCall);
        }

        protected override void OnStop()
        {

        }
    }
} 
```

感谢您提供的任何帮助。

瓦卡诺

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-17T16:42:45.813

作为 SingleCall 类型，您的 SampleObject 将为客户端进行的每次调用创建。这向我表明您的对象有问题，并且您没有显示它的作用。您需要查看它对共享资源或锁的任何依赖关系。尝试在 SampleObject 的构造函数中编写一些调试程序，以查看远程调用能走多远。

# java - ArrayList 的 RMI 中不返回引用传递

> ID：85085
> 
> 赞同：0
> 
> 时间：2008-09-17T16:33:37.660
> 
> 标签：java, arraylist, rmi

我有一个 RMI 调用定义为：

```
public void remoteGetCustomerNameNumbers(ArrayList<String> customerNumberList, ArrayList<String> customerNameList) throws java.rmi.RemoteException; 
```

该函数执行数据库查找并填充两个 ArrayList。调用函数一无所获。我相信这适用于 Vector 类型。

我是否需要使用 Vector，或者有没有办法在不打两个电话的情况下让它工作。我还有一些可能会使用的其他想法，比如返回一个键/值对，但我想知道我是否可以让它工作。

更新：
如果可以的话，我会接受到目前为止给出的所有答案。我不知道网络成本，因此重新编写函数以返回 LinkedHashMap 而不是两个 ArrayList 是有意义的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T16:45:01.627

RMI 中的参数调用序列化。服务器上的反序列化创建列表的副本。如果列表保留在客户端，那么网络调用的数量会非常高。您可以传递远程对象，但要注意性能影响。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T16:37:55.637

当您拨打远程电话时，您会丢失您的参考资料。您需要返回列表，而不是期望它们被远程调用填充。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T18:47:26.777

正如汤姆所提到的，您可以传递远程对象。您必须创建一个类来保存实现 Remote 的列表。每当您将实现 Remote 的东西作为参数传递时，只要接收方使用它，它就会转身并对调用者进行远程调用*以*使用该对象。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T19:43:04.693

正如其他人已经提到的，当将对象作为参数传递给 RMI 方法时，对象将被序列化，然后在包含 RMI 方法的目标对象内的另一端反序列化。这会破坏传入的原始对象的引用，因为您现在有两个不同的对象：一个在调用该方法的客户端代码中，一个在远程端。

在这个特定示例中，更好的方法是分解您的方法调用（因为您似乎在一个方法中做两件事：获取客户姓名和获取客户编号），而是将结果返回给调用者而不是传入一个集合......像这样：

```
public ArrayList<String> getCustomerNames() throws java.rmi.RemoteException;

public ArrayList<String> getCustomerNumbers() throws java.rmi.RemoteException; 
```

由于 ArrayList 和 String 都实现了 Serializable，因此集合中的结果将被序列化并通过线路发送到调用该方法的客户端代码，此时您可以根据需要处理数据。相反，如果您需要在集合中使用自定义对象，只要您的类实现 java.io.Serializable 接口，并遵循该接口的规范，您应该没有问题。

这将导致通过线路进行两次单独的调用，但交互更加清晰和简单，并且避免了原始示例中的引用中断问题。

# asp.net - 错误 BC30002 - 类型 XXX 未定义

> ID：85091
> 
> 赞同：13
> 
> 时间：2008-09-17T16:33:58.440
> 
> 标签：asp.net, vb.net, compiler-errors

好吧，这开始让我发疯了。我有一个 asp.net webapp。非常简单，大部分代码在 .aspx.vb 中，少数类在 App_Code 中。

这个问题直到今天才开始出现（尽管大部分代码已经编写好了），有时我会收到以下错误消息：

> 错误 BC30002：未定义类型“XXX”

每次我修改 App_Code 文件夹中的文件时都会发生错误。编辑：好的，如果我暂时不触摸任何东西然后刷新页面，也会发生这种情况。我仍在试图弄清楚如何触发此错误。

我只需要稍等片刻，不碰任何东西，然后刷新页面就可以了，但这很烦人。

所以我搜索了一下，但除了导入丢失之外什么都没有出现。任何的想法 ？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2018-02-07T19:47:55.743

在我将新项目添加到旧解决方案后，这发生在我身上。我降低了目标框架以匹配其他“旧”项目的框架，错误就消失了。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-01T10:01:10.243

我想我找到了问题所在。

我的代码是这样的：

```
Imports CMS

Sub Whatever()
    Dim a as new Arbo.MyObject() ' Arbo is a namespace inside CMS
    Dim b as new Util.MyOtherObject() ' Util is a namespace inside Util
End Sub 
```

我不确定我为什么要这样写，但事实证明我在调用类时既没有调用它们的整个命名空间也没有导入它们的整个命名空间会触发错误。

我像这样重写它：

```
Imports CMS.Arbo
Imports CMS.Util 

Sub Whatever()
    Dim a as new MyObject()
    Dim b as new MyOtherObject()
End Sub 
```

现在它起作用了......

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-17T16:57:41.237

听起来像是一个预编译问题，特别是因为您提到您收到错误然后等待它消失。ASP.NET 可能仍在动态编译您的应用程序的过程中，或者它已将类型编译到不同的程序集中。

使用动态编译，不能保证将不同的代码隐藏文件编译到同一个程序集中。因此，您引用的类型可能无法在其预编译程序集中解析。

尝试使用“@Reference”指令向运行时指示您的页面和包含您的类型的文件应该编译到同一个程序集中。

[@参考 - MSDN](https://msdn.microsoft.com/en-us/library/w70c655a(v=vs.100).aspx)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2021-03-10T16:31:26.150

检查编译器警告（Visual Studio 的输出窗口）“警告：以下程序集依赖于高于目标的 .NET Framework 版本，并且在运行时可能无法正确加载导致失败”。当您的其中一个 dll 使用较新版本的 dotnet 编译时，就会发生这种情况。如果您当前的项目设置为使用较低版本的 dotnet，则依赖链会阻止加载 dll（具有较高的 dotnet 版本）。它在 Visual Studio 中给出了编译错误，但仍然可以在 IIS 中运行。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T17:07:46.470

听起来每次网站启动时都会发生这种情况（每次您触摸 app_code 时应用程序都会被回收，并且您可能已将 IIS 配置为在 X 分钟不活动后关闭网站）。

我敢打赌，这与 asp.net 工作进程在服务器上没有正确的访问权限有关。所以它试图加载一个程序集并被拒绝。

[检查此链接](http://msdn.microsoft.com/en-us/library/aa302435.aspx)和表 19.3 以获取工作进程帐户必须有权访问才能正常工作的所有文件夹的列表。并且不要忘记授予它对虚拟目录中所有文件和文件夹的权限！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-02-14T09:21:10.523

如果引用相等，请从备份中替换您的 vbproj 和 vbproj.user 文件

# agile - 您如何构建开发冲刺？

> ID：85114
> 
> 赞同：6
> 
> 时间：2008-09-17T16:36:57.043
> 
> 标签：agile

所以我有一个积压的功能，我们即将开始一个相当大的项目。我正在努力定义我们 sprint 的结构，我对社区的反馈很感兴趣。

我在想的是：

*   一日冲刺计划
    *   填写待办事项并弄清楚每个开发人员在这个 sprint 之后会做什么
*   三周的开发
    *   去！去！去！
*   每日站立会议
    *   检查是否有人需要帮助或感觉偏离轨道
*   两天的冲刺评审
    *   代码审查在这里进行，利益相关者演示
*   一日冲刺回顾
    *   我们在上一个 sprint 中完成了什么？下次我们怎样才能做得更好？

冲刺应该总是在周二结束（以避免周末压力过大）。

还要别的吗？敏捷显然不止于此。我想为团队提供一个简单的大纲，说明我们在启动这个项目时将如何运作。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-17T17:21:29.667

我会考虑尝试短于一个月的冲刺。

就我个人而言，我发现一两周的迭代更有效地快速获得有效的反馈。它还可以防止任何可能导致迭代级别出现问题的问题上升到难以管理的级别。

即使是 30 天的 sprint——对于 sprint 评审来说，两天听起来要花上一天的时间……而对于回顾来说，一天听起来要长 0.5 天。我发现，如果您需要的远不止这些，那么在迭代过程中就会出现沟通问题——所以您可能希望将需要长评论视为一个可能的危险信号。

当然，这只是我的经验——主要是与小型 (4-12) 人团队一起开发 Web 应用程序。你的经验可能会有所不同。

也就是说 - 我肯定会尝试更短的冲刺。就像集成构建一样 - 如果您更频繁地执行它们，很多事情会变得更容易。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-17T16:41:55.313

在核心代码时间关闭电子邮件、手机和即时消息应用程序。上午 10 点到下午 1 点，下午 2 点到 5 点可能是很好的选择。

当他们在“区域”时为团队订购食物，饮料。

取消计划会议之前和之后以及审查日的所有其他会议。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-17T17:26:07.190

*   确保“站立”仍然是站立。很容易陷入越来越长的会议。
*   一天的冲刺计划和最后的三天可能太多了。只安排您需要的时间。
*   +1 对更短迭代的想法。就个人而言，一个 sprint 中的四个为期一周的迭代运行良好。人们擅长估计近期任务；过去，它变得越来越猜测。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T08:24:56.797

看起来是个不错的方法。我赞同 adrianh 和 jedidja 所说的可能更短的迭代。我自己喜欢1周。除了更好的估计之外，它还使“工作软件”的概念保持在更短的周期内。

几个问题：

为什么代码审查要留到最后？要么结对编程，要么边做边做评论。

3 周的开发是否意味着“开发、测试、文档、安装程序等”？即你需要真正完成的一切？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-19T13:43:27.543

我们的 sprint 结构与您的大纲非常相似，除了我们的 sprint 审查是 sprint 的最后一天，通常持续大约一个小时。冲刺审查是您向客户和任何其他相关方展示您的工作的时间，而不是进行代码审查的时间。如果您选择进行代码审查，则应在整个 sprint 中定期进行。我们过去每周有一个小时的时间来审查开发人员提名的代码，这意味着我们不会浪费时间审查每个编写的 LOC。

我们还在周二结束我们的冲刺，并在周四离开周三开始，以结束未完成的任务并解决冲刺期间产生的技术债务。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-23T12:39:10.347

我不建议将代码审查推迟到冲刺之后，它们应该是开发过程中不可或缺的一部分。换句话说，除非代码已经过审查（和测试、记录和......），否则任务不会完成。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-09-20T02:22:29.337

为了管理而远离管理很重要。SCRUM 每天只需要 1 次会议，而且时间很短。此外，在每个 sprint 期间，唯一的其他会议是 Spring 回顾和 sprint 计划。这使我们能够实施 ROWE，或以结果为导向的工作环境。让您的开发人员决定他们将如何、在何处、何时进行开发。使用您的每日站立会议来跟踪他们正在做的工作。除此之外，退后一步，对他们的生产力感到惊讶。

“在编码过程中关闭手机、关闭 IM 应用程序等”之类的想法都是糟糕的想法。当你雇佣你的团队时，你是在自信地雇佣他们，因为他们知道如何正确地完成他们的工作。如果您以这种理解雇用他们，为什么要限制他们以他们所知的最佳方式完成工作的能力？如果您使用 SCRUM，那么每个开发人员都会选择他们认为自己能够完成的工作，您作为 Scrum-Master 的工作是消除障碍，而不是创造障碍。

代码审查：绝对必要。代码的同行评审对于参加会议的初级开发人员以及对他们的代码进行评审的人来说是一个很好的教学工具。

设计文档：我个人觉得详细的设计文档涵盖了开发者的意图是非常重要的，我也觉得它们是开发过程的重要组成部分。现在，这并不特别符合敏捷开发，但我个人经常回顾多年前创建的设计文档，以了解原始开发人员在编写模块时的想法。

# javascript - 以用户的语言环境格式和时间偏移显示日期/时间

> ID：85116
> 
> 赞同：184
> 
> 时间：2008-09-17T16:37:12.113
> 
> 标签：javascript, datetime, timezone

我希望服务器始终在 HTML 中以 UTC 格式提供日期，并让客户端站点上的 JavaScript 将其转换为用户的本地时区。

如果我可以以用户的语言环境日期格式输出，则可以加分。

* * *

## 回答 #1

> 赞同：188
> 
> 时间：2008-09-17T19:12:54.720

* * *

## 回答 #2

> 赞同：65
> 
> 时间：2014-05-26T14:58:26.150

## You can do it with [moment.js](http://momentjs.com/) (deprecated in 2021)

It's best to [parse](http://momentjs.com/docs/#/parsing/) your date string from UTC as follows (create an [ISO-8601](http://en.wikipedia.org/wiki/ISO_8601) compatible string on the server to get consistent results across all browsers):

```
var m = moment("2013-02-08T09:30:26Z"); 
```

Now just use `m` in your application, moment.js defaults to the local timezone for display operations. There are [many ways to format the date and time values](http://momentjs.com/docs/#/displaying/) or extract portions of it.

You can even format a moment object in the users locale like this:

```
m.format('LLL') // Returns "February 8 2013 8:30 AM" on en-us 
```

To transform a moment.js object into a different timezone (i.e. neither the local one nor UTC), you'll need the [moment.js timezone extension](http://momentjs.com/timezone/). That page has also some examples, it's pretty simple to use.

Note: Moment JS recommends more modern alternatives, so it is probably not a good choice for new projects.

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2008-09-17T16:49:24.347

您可以使用`new Date().getTimezoneOffset()/60`时区。还有`toLocaleString()`一种使用用户区域设置显示日期的方法。

这是整个列表：[使用日期](http://www.elated.com/articles/working-with-dates/)

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2017-05-09T06:52:57.133

In JS there are no simple and cross platform ways to format local date time, outside of converting each property as mentioned above.

Here is a quick hack I use to get the local YYYY-MM-DD. Note that this is a hack, as the final date will not have the correct timezone anymore (so you have to ignore timezone). If I need anything else more, I use moment.js.

```
var d = new Date();    
d = new Date(d.getTime() - d.getTimezoneOffset() * 60000)
var yyyymmdd = t.toISOString().slice(0, 10); 
// 2017-05-09T08:24:26.581Z (but this is not UTC) 
```

The d.getTimezoneOffset() returns the time zone offset in minutes, and the d.getTime() is in ms, hence the x 60,000.

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2010-05-13T21:35:21.613

Once you have your date object constructed, here's a snippet for the conversion:

The function takes a UTC formatted Date object and format string.
You will need a `Date.strftime` prototype.

```
function UTCToLocalTimeString(d, format) {
    if (timeOffsetInHours == null) {
        timeOffsetInHours = (new Date().getTimezoneOffset()/60) * (-1);
    }
    d.setHours(d.getHours() + timeOffsetInHours);

    return d.strftime(format);
} 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2019-02-21T18:29:47.973

```
// new Date(year, monthIndex [, day [, hours [, minutes [, seconds [, milliseconds]]]]])
var serverDate = new Date(2018, 5, 30, 19, 13, 15); // just any date that comes from server
var serverDateStr = serverDate.toLocaleString("en-US", {
  year: 'numeric',
  month: 'numeric',
  day: 'numeric',
  hour: 'numeric',
  minute: 'numeric',
  second: 'numeric'
})
var userDate = new Date(serverDateStr + " UTC");
var locale = window.navigator.userLanguage || window.navigator.language;

var clientDateStr = userDate.toLocaleString(locale, {
  year: 'numeric',
  month: 'numeric',
  day: 'numeric'
});

var clientDateTimeStr = userDate.toLocaleString(locale, {
  year: 'numeric',
  month: 'numeric',
  day: 'numeric',
  hour: 'numeric',
  minute: 'numeric',
  second: 'numeric'
});

console.log("Server UTC date: " + serverDateStr);
console.log("User's local date: " + clientDateStr);
console.log("User's local date&time: " + clientDateTimeStr);
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2008-09-17T16:59:54.977

这是我在过去的项目中使用的：

```
var myDate = new Date();
var tzo = (myDate.getTimezoneOffset()/60)*(-1);
//get server date value here, the parseInvariant is from MS Ajax, you would need to do something similar on your own
myDate = new Date.parseInvariant('<%=DataCurrentDate%>', 'yyyyMMdd hh:mm:ss');
myDate.setHours(myDate.getHours() + tzo);
//here you would have to get a handle to your span / div to set.  again, I'm using MS Ajax's $get
var dateSpn = $get('dataDate');
dateSpn.innerHTML = myDate.localeFormat('F'); 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2021-04-21T18:44:35.707

**2021 - you can use the browser native** [Intl.DateTimeFormat](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Intl/DateTimeFormat)

```
const utcDate = new Date(Date.UTC(2020, 11, 20, 3, 23, 16, 738));
console.log(new Intl.DateTimeFormat().format(utcDate));
// expected output: "21/04/2021", my locale is Switzerland 
```

Below is straight from the documentation:

```
const date = new Date(Date.UTC(2020, 11, 20, 3, 23, 16, 738));
// Results below assume UTC timezone - your results may vary

// Specify default date formatting for language (locale)
console.log(new Intl.DateTimeFormat('en-US').format(date));
// expected output: "12/20/2020"

// Specify default date formatting for language with a fallback language (in this case Indonesian)
console.log(new Intl.DateTimeFormat(['ban', 'id']).format(date));
// expected output: "20/12/2020"

// Specify date and time format using "style" options (i.e. full, long, medium, short)
console.log(new Intl.DateTimeFormat('en-GB', { dateStyle: 'full', timeStyle: 'long' }).format(date));
// Expected output "Sunday, 20 December 2020 at 14:23:16 GMT+11" 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-09-17T17:48:55.247

该`.getTimezoneOffset()`方法以分钟为单位报告时区偏移，从 GMT/UTC 时区“向西”计数，导致偏移值与通常习惯的值相反。（例如，纽约时间将被报告为 +240 分钟或 +4 小时）

要获得以小时为单位的正常时区偏移量，您需要使用：

```
var timeOffsetInHours = -(new Date()).getTimezoneOffset()/60 
```

**重要细节：**
请注意，夏令时会被计入结果中 - 所以这个方法给你的实际上是**时间**偏移 - 而不是实际的地理**时区**偏移。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2015-09-25T11:39:46.273

With date from PHP code I used something like this..

```
function getLocalDate(php_date) {
  var dt = new Date(php_date);
  var minutes = dt.getTimezoneOffset();
  dt = new Date(dt.getTime() + minutes*60000);
  return dt;
} 
```

We can call it like this

```
var localdateObj = getLocalDate('2015-09-25T02:57:46'); 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2016-12-06T16:50:39.573

I mix the answers so far and add to it, because I had to read all of them and investigate additionally for a while to display a date time string from db in a user's local timezone format.

The datetime string comes from a python/django db in the format: 2016-12-05T15:12:24.215Z

Reliable detection of the browser language in JavaScript doesn't seem to work in all browsers (see [JavaScript for detecting browser language preference](https://stackoverflow.com/questions/1043339/javascript-for-detecting-browser-language-preference)), so I get the browser language from the server.

Python/Django: send request browser language as context parameter:

```
language = request.META.get('HTTP_ACCEPT_LANGUAGE')
return render(request, 'cssexy/index.html', { "language": language }) 
```

HTML: write it in a hidden input:

```
<input type="hidden" id="browserlanguage" value={{ language }}/> 
```

JavaScript: get value of hidden input e.g. en-GB,en-US;q=0.8,en;q=0.6/ and then take the first language in the list only via replace and regular expression

```
const browserlanguage = document.getElementById("browserlanguage").value;
var defaultlang = browserlanguage.replace(/(\w{2}\-\w{2}),.*/, "$1"); 
```

JavaScript: convert to datetime and format it:

```
var options = { hour: "2-digit", minute: "2-digit" };
var dt = (new Date(str)).toLocaleDateString(defaultlang, options); 
```

See: [https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/Date/toLocaleDateString](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/Date/toLocaleDateString)

The result is (browser language is en-gb): 05/12/2016, 14:58

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-09-17T16:47:43.553

您可以使用以下内容，以分钟为单位报告与 GMT 的时区偏移：

```
new Date().getTimezoneOffset(); 
```

注意： - 此函数返回一个负数。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2013-09-17T14:40:41.213

The best solution I've come across is to create [time display="llll" datetime="UTC TIME" /] Tags, and use javascript (jquery) to parse and display it relative to the user's time.

[http://momentjs.com/](http://momentjs.com/) Moment.js

will display the time nicely.

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-09-17T16:56:18.353

getTimeZoneOffset() 和 toLocaleString 对于基本的日期工作很有用，但是如果您需要实时时区支持，请查看[mde 的 TimeZone.js](https://github.com/mde/timezone-js)。

[在这个问题](https://stackoverflow.com/questions/15141762/how-to-initialize-javascript-date-to-a-particular-timezone/15171030#15171030)的答案中讨论了更多选项

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2018-07-10T07:31:51.587

To convert date to local date use toLocaleDateString() method.

```
var date = (new Date(str)).toLocaleDateString(defaultlang, options); 
```

To convert time to local time use toLocaleTimeString() method.

```
var time = (new Date(str)).toLocaleTimeString(defaultlang, options); 
```

* * *

## 回答 #16

> 赞同：-14
> 
> 时间：2008-09-17T16:41:44.067

不知道如何进行语言环境，但 javascript 是一种客户端技术。

```
usersLocalTime = new Date(); 
```

将在其中包含客户的时间和日期（由他们的浏览器报告，并通过扩展他们所在的计算机报告）。在响应中包含服务器的时间并做一些简单的数学来猜测时间偏移应该是微不足道的。

# python - 从单个 Python Web 框架运行多个站点

> ID：85119
> 
> 赞同：5
> 
> 时间：2008-09-17T16:37:23.720
> 
> 标签：python, frameworks

我知道您可以根据域或路径进行重定向以重写 URI 以指向特定于站点的位置，并且我还看到了针对每个站点的一些粗鲁`if`和`elif`声明，如下面的代码所示，我想避免.

```
if site == 'site1':
    ...
elif site == 'site2:
    ... 
```

从一个通用的 Python Web 框架（即 Pylons、TurboGears 等）运行多个站点有哪些好的和聪明的方法？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-17T16:39:06.960

Django 内置了这个。请参阅[站点框架](http://docs.djangoproject.com/en/dev/ref/contrib/sites/#ref-contrib-sites)。

作为一种通用技术，在附加到您希望特定于主机的数据的数据库模式中包含一个“主机”列，然后`Host`在检索数据时在查询中包含 HTTP 标头。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-17T19:29:30.590

在带有 mod_python 的 apache 上使用 Django，我只需使用以下 apache 配置托管多个（不相关的）django 站点：

```
<VirtualHost 1.2.3.4>
        DocumentRoot /www/site1
        ServerName site1.com
        <Location />
                SetHandler python-program
                SetEnv DJANGO_SETTINGS_MODULE site1.settings
                PythonPath "['/www'] + sys.path"
                PythonDebug On
                PythonInterpreter site1
        </Location>
</VirtualHost>

<VirtualHost 1.2.3.4>
        DocumentRoot /www/site2
        ServerName site2.com
        <Location />
                SetHandler python-program
                SetEnv DJANGO_SETTINGS_MODULE site2.settings
                PythonPath "['/www'] + sys.path"
                PythonDebug On
                PythonInterpreter site2
        </Location>
</VirtualHost> 
```

不需要多个 apache 实例或代理服务器。为每个站点使用不同的 PythonInterpreter 指令（您输入的名称是任意的）使命名空间保持独立。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-17T16:52:59.517

我使用 CherryPy 作为我的 Web 服务器（它与 Turbogears 捆绑在一起），我只是在绑定到 localhost 的不同端口上运行 CherryPy Web 服务器的多个实例。然后我使用 mod_proxy 和 mod_rewrite 配置 Apache，以根据 HTTP 请求将请求透明地转发到正确的端口。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-17T18:10:57.317

在本地端口上使用多个服务器实例是个好主意，但您不需要功能齐全的 Web 服务器来重定向 HTTP 请求。

我会使用[磅](http://www.apsis.ch/pound/)作为反向代理来完成这项工作。它体积小、速度快、简单，完全符合我们的需要。

> 什么是英镑：
> 
> 1.  **反向代理：它将请求从客户端浏览器传递到一个或多个后端服务器。**
> 2.  负载均衡器：它将来自客户端浏览器的请求分发到多个后端服务器，同时保留会话信息。
> 3.  SSL 包装器：Pound 将解密来自客户端浏览器的 HTTPS 请求，并将它们作为纯 HTTP 传递给后端服务器。
> 4.  HTTP/HTTPS sanitizer：Pound 将验证请求的正确性并只接受格式正确的请求。
> 5.  故障转移服务器：如果后端服务器发生故障，Pound 会注意到这一事实并停止向其传递请求，直到它恢复为止。
> 6.  **请求重定向器：可以根据请求的 URL 在服务器之间分发请求。**

# c++ - 如何在 Windows 上使线程睡眠时间少于一毫秒

> ID：85122
> 
> 赞同：61
> 
> 时间：2008-09-17T16:37:39.710
> 
> 标签：c++, windows, winapi, sleep

在 Windows 上，我有一个在 Unix 上从未遇到过的问题。这就是如何让线程休眠不到一毫秒。在 Unix 上，您通常有多种选择（sleep、usleep 和 nanosleep）来满足您的需求。然而，在 Windows 上，只有毫秒粒度的*睡眠。*

在 Unix 上，我可以使用`select`系统调用来创建微秒睡眠，这非常简单：

```
int usleep(long usec)
{
    struct timeval tv;
    tv.tv_sec = usec/1000000L;
    tv.tv_usec = usec%1000000L;
    return select(0, 0, 0, 0, &tv);
} 
```

我怎样才能在 Windows 上达到同样的效果？

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2008-09-17T16:40:21.543

这表明对睡眠功能的误解。您传递的参数是睡眠的*最短*时间。不能保证线程会在指定的时间后唤醒。事实上，线程根本不会“唤醒”，而是由 OS 调度程序选择执行。调度程序可能会选择等待比请求的睡眠持续时间更长的时间来激活线程，尤其是当另一个线程此时仍处于活动状态时。

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2008-09-17T16:45:57.973

正如 Joel 所说，您不能在如此短的时间内有意义地“睡眠”（即放弃您预定的 CPU）。如果您想延迟一小段时间，那么您需要旋转，反复检查适当的高分辨率计时器（例如“性能计时器”），并希望高优先级的东西无论如何都不会抢占您。

如果您真的关心如此短时间的准确延迟，那么您不应该使用 Windows。

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2008-09-17T16:46:01.593

使用 winmm.lib 中提供的高分辨率多媒体计时器。请参阅[此](http://www.codeguru.com/cpp/w-p/system/timers/article.php/c5759/)示例。

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2015-07-14T15:57:51.650

```
#include <Windows.h>

static NTSTATUS(__stdcall *NtDelayExecution)(BOOL Alertable, PLARGE_INTEGER DelayInterval) = (NTSTATUS(__stdcall*)(BOOL, PLARGE_INTEGER)) GetProcAddress(GetModuleHandle("ntdll.dll"), "NtDelayExecution");
static NTSTATUS(__stdcall *ZwSetTimerResolution)(IN ULONG RequestedResolution, IN BOOLEAN Set, OUT PULONG ActualResolution) = (NTSTATUS(__stdcall*)(ULONG, BOOLEAN, PULONG)) GetProcAddress(GetModuleHandle("ntdll.dll"), "ZwSetTimerResolution");

static void SleepShort(float milliseconds) {
    static bool once = true;
    if (once) {
        ULONG actualResolution;
        ZwSetTimerResolution(1, true, &actualResolution);
        once = false;
    }

    LARGE_INTEGER interval;
    interval.QuadPart = -1 * (int)(milliseconds * 10000.0f);
    NtDelayExecution(false, &interval);
} 
```

非常适合在极短的时间内睡觉。请记住，在某一点上，实际延迟永远不会是一致的，因为系统无法在如此短的时间内保持一致的延迟。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2008-09-17T16:49:19.743

是的，您需要了解操作系统的时间量。在 Windows 上，除非您将时间片更改为 1 毫秒，否则您甚至不会获得 1 毫秒的分辨率时间。（例如使用 timeBeginPeriod()/timeEndPeriod()）这仍然不能保证任何事情。即使是一点点负载或一个蹩脚的设备驱动程序也会让一切崩溃。

SetThreadPriority() 有帮助，但非常危险。糟糕的设备驱动程序仍然会毁了你。

你需要一个超可控的计算环境才能让这些丑陋的东西完全发挥作用。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2012-07-12T16:12:46.743

通常睡眠至少会持续到下一个系统中断发生。但是，这取决于多媒体定时器资源的设置。它可能设置为接近 1 ms，某些硬件甚至允许以 0.9765625 的中断周期运行（由提供的*ActualResolution*`NtQueryTimerResolution`将显示 0.9766 但这实际上是错误的。他们只是无法将正确的数字放入*ActualResolution*格式中。它是 0.9765625毫秒，每秒 1024 次中断）。

有一个例外可以让我们摆脱这样一个事实，即在中断期间内可能无法入睡：它是著名的`Sleep(0)`. 这是一个非常强大的工具，它没有像应有的那样经常使用！它放弃了线程时间片的提醒。这样线程将停止，直到调度程序强制线程再次获得 cpu 服务。`Sleep(0)`是一个异步服务，调用将强制调度程序独立于中断作出反应。

第二种方法是使用`waitable object`. 像这样的等待函数`WaitForSingleObject()`可以等待一个事件。为了让线程在任何时候都处于休眠状态，也是微秒级的时间，线程需要设置一些服务线程，该线程将在所需的延迟时生成事件。“睡眠”线程将设置此线程，然后在等待函数处暂停，直到服务线程将设置事件信号。

这样任何线程都可以“休眠”或等待任何时间。服务线程可能非常复杂，它可以提供系统范围的服务，例如微秒级的定时事件。但是，微秒分辨率可能会迫使服务线程在一个高分辨率时间服务上旋转最多一个中断周期（~1ms）。如果小心，它可以很好地运行，特别是在多处理器或多核系统上。当调用线程和服务线程的关联掩码得到仔细处理时，一毫秒的自旋在多核系统上不会造成太大的伤害。

可以在[Windows 时间戳项目中访问代码、描述和测试](http://www.windowstimestamp.com)

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2008-09-17T18:03:10.953

正如一些人所指出的，睡眠和其他相关功能默认依赖于“系统滴答”。这是操作系统任务之间的最小时间单位；例如，调度程序不会运行得比这更快。即使使用实时操作系统，系统滴答时间通常也不小于 1 毫秒。虽然它是可调的，但这会对整个系统产生影响，而不仅仅是您的睡眠功能，因为您的调度程序将更频繁地运行，并且可能会增加您的操作系统的开销（调度程序运行的时间量与任务可以运行的时间）。

解决方案是使用外部高速时钟设备。大多数 Unix 系统允许你指定你的计时器和这样一个不同的时钟来使用，而不是默认的系统时钟。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2008-09-17T16:47:49.450

您还在等什么，需要如此精确？一般来说，如果您**需要**指定该级别的精度（例如，由于对某些外部硬件的依赖），您就在错误的平台上，应该查看实时操作系统。

否则，您应该考虑是否有可以同步的事件，或者在更糟糕的情况下只是忙于等待 CPU 并使用高性能计数器 API 来测量经过的时间。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2008-09-17T18:03:35.290

如果您想要如此多的粒度，那么您来错地方了（在用户空间中）。

请记住，如果您在用户空间中，您的时间并不总是准确的。

调度程序可以启动您的线程（或应用程序）并对其进行调度，因此您依赖于操作系统调度程序。

如果您正在寻找精确的东西，您必须去：1）在内核空间（如驱动程序）中 2）选择一个 RTOS。

无论如何，如果您正在寻找一些粒度（但请记住用户空间的问题），请查看 MSDN 中的 QueryPerformanceCounter 函数和 QueryPerformanceFrequency 函数。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-09-19T16:34:33.450

实际上使用这个 usleep 函数会导致很大的内存/资源泄漏。（取决于调用频率）

使用这个更正的版本（抱歉不能编辑？）

```
bool usleep(unsigned long usec)
{
    struct timeval tv;
    fd_set dummy;
    SOCKET s = socket(PF_INET, SOCK_STREAM, IPPROTO_TCP);
    FD_ZERO(&dummy);
    FD_SET(s, &dummy);
    tv.tv_sec = usec / 1000000ul;
    tv.tv_usec = usec % 1000000ul;
    bool success = (0 == select(0, 0, 0, &dummy, &tv));
    closesocket(s);
    return success;
} 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-05-13T20:02:20.400

我有同样的问题，似乎没有什么比一毫秒更快，甚至是睡眠（0）。我的问题是客户端和服务器应用程序之间的通信，我使用 _InterlockedExchange 函数来测试和设置一点，然后我休眠（0）。

我确实需要以这种方式每秒执行数千次操作，但它的工作速度不如我计划的那么快。

由于我有一个与用户打交道的瘦客户端，它反过来调用一个代理，然后与一个线程对话，我将很快将线程与代理合并，这样就不需要事件接口。

只是为了让你们知道这个 Sleep 有多慢，我运行了一个 10 秒的测试，执行一个空循环（得到大约 18,000,000 个循环），而在事件发生后我只有 180,000 个循环。也就是说，慢了 100 倍！

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2015-07-03T06:49:20.647

尝试使用[SetWaitableTimer](https://msdn.microsoft.com/en-us/library/windows/desktop/ms686289(v=vs.85).aspx) ...

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2012-05-11T15:50:02.383

就像大家提到的那样，睡眠时间确实无法保证。但没有人愿意承认，有时在空闲系统上，usleep 命令可能非常精确。特别是使用无滴答内核。Windows Vista 拥有它，Linux 从 2.6.16 开始拥有它。

Tickless 内核的存在有助于提高笔记本电脑的电池寿命：参见英特尔的 powertop 实用程序。

在那种情况下，我碰巧测量了 Linux usleep 命令，它非常接近请求的睡眠时间，低至半打微秒。

所以，也许 OP 想要一些在空闲系统上大部分时间都能大致工作的东西，并且能够要求微秒调度！我实际上也希望在 Windows 上使用它。

另外，Sleep(0) 听起来像 boost::thread::yield()，术语更清楚。

我想知道[Boost](http://en.wikipedia.org/wiki/Boost_%28C%2B%2B_libraries%29)定时锁是否有更好的精度。因为那时你可以锁定一个没有人释放的互斥锁，当达到超时时，继续...超时设置为 boost::system_time + boost::milliseconds & cie（不推荐使用 xtime）。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2017-04-22T21:18:41.500

如果您的目标是*“等待很短的时间”*，因为您正在执行*spinwait*，那么您可以执行的等待级别会越来越高。

```
void SpinOnce(ref Int32 spin)
{
   /*
      SpinOnce is called each time we need to wait. 
      But the action it takes depends on how many times we've been spinning:

      1..12 spins: spin 2..4096 cycles
      12..32: call SwitchToThread (allow another thread ready to go on time core to execute)
      over 32 spins: Sleep(0) (give up the remainder of our timeslice to any other thread ready to run, also allows APC and I/O callbacks)
   */
   spin += 1;

   if (spin > 32)
      Sleep(0); //give up the remainder of our timeslice
   else if (spin > 12)
      SwitchTothread(); //allow another thread on our CPU to have the remainder of our timeslice
   else
   {
      int loops = (1 << spin); //1..12 ==> 2..4096
      while (loops > 0)
         loops -= 1;
   }
} 
```

因此，如果您的目标实际上*只是等待一点点*，您可以使用类似的东西：

```
int spin = 0;
while (!TryAcquireLock()) 
{ 
   SpinOne(ref spin);
} 
```

这里的优点是我们每次都等待更长的时间，最终完全进入睡眠状态。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-09-17T17:00:44.410

尝试 boost::xtime 和 timed_wait()

具有纳秒精度。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-09-18T08:59:28.600

只需使用睡眠（0）。0 显然小于一毫秒。现在，这听起来很有趣，但我是认真的。Sleep(0) 告诉 Windows 您现在没有任何事情可做，但您确实希望在调度程序再次运行时重新考虑。而且由于显然无法在调度程序本身运行之前调度线程运行，因此这是可能的最短延迟。

请注意，您可以将微秒数传递给您的睡眠，但 void usleep(__int64 t) { Sleep(t/1000); } - 不能保证那段时间真的睡着了。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2015-10-31T05:33:02.700

**不到一毫秒的睡眠功能-也许**

我发现 sleep(0) 对我有用。在任务管理器中 cpu 负载接近 0% 的系统上，我编写了一个简单的控制台程序，并且 sleep(0) 函数的睡眠时间一致为 1-3 微秒，不到一毫秒。

但是从这个线程的上述答案中，我知道 sleep(0) 睡眠量在 CPU 负载较大的系统上的变化可能比这大得多。

但据我了解，睡眠功能不应该用作计时器。它应该用于使程序使用尽可能少的 cpu 百分比并尽可能频繁地执行。就我的目的而言，例如在视频游戏中以比每毫秒一个像素快得多的速度在屏幕上移动弹丸，我认为 sleep(0) 有效。

您只需确保睡眠间隔小于最大睡眠时间。您不将睡眠用作计时器，而只是为了使游戏使用尽可能少的 cpu 百分比。您将使用一个与睡眠无关的单独功能，以了解何时过去了特定的时间，然后在屏幕上移动一个像素——例如 1/10 毫秒或 100 微秒.

伪代码会是这样的。

```
while (timer1 < 100 microseconds) {
sleep(0);
}

if (timer2 >=100 microseconds) {
move projectile one pixel
}

//Rest of code in iteration here 
```

我知道答案可能不适用于高级问题或程序，但可能适用于某些或许多程序。

* * *

## 回答 #18

> 赞同：-4
> 
> 时间：2008-09-17T16:39:51.980

在 Windows 上，使用`select`强制您包含[Winsock](https://msdn.microsoft.com/en-us/library/windows/desktop/ms740673(v=vs.85).aspx)库，该库必须像这样在您的应用程序中初始化：

```
WORD wVersionRequested = MAKEWORD(1,0);
WSADATA wsaData;
WSAStartup(wVersionRequested, &wsaData); 
```

然后 select 不允许你在没有任何套接字的情况下被调用，所以你必须做更多的事情来创建一个 microsleep 方法：

```
int usleep(long usec)
{
    struct timeval tv;
    fd_set dummy;
    SOCKET s = socket(PF_INET, SOCK_STREAM, IPPROTO_TCP);
    FD_ZERO(&dummy);
    FD_SET(s, &dummy);
    tv.tv_sec = usec/1000000L;
    tv.tv_usec = usec%1000000L;
    return select(0, 0, 0, &dummy, &tv);
} 
```

所有这些创建的 usleep 方法在成功时返回零，在错误时返回非零。

# .net - 为 IIS 5.1 开发盒和 IIS6 服务器设置 CruiseControl 的最佳方式

> ID：85129
> 
> 赞同：0
> 
> 时间：2008-09-17T16:38:15.963
> 
> 标签：.net, svn, iis, cruisecontrol.net

谁能指出我正确的方向。通过阅读 Cruisecontrol 的常见问题解答，您似乎应该在与生产相同的环境中进行开发。

但我的开发机器上有 Windows XP（只运行 IIS 5.1），服务器是 2003。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-17T16:57:30.143

我们有一个类似的设置，我们已经成功使用了一年多。我们的 CC.Net 服务器在 Windows 2003 服务器上，所有开发都在 Windows XP/Vista 机器上进行。签入 SVN 的代码被下拉到 Windows 2003 服务器上，构建并推送到我们的主机箱上。

# c# - 如何将事件添加到班级

> ID：85137
> 
> 赞同：46
> 
> 时间：2008-09-17T16:39:25.320
> 
> 标签：c#, class, events

假设我有一个名为 Frog 的类，它看起来像：

```
public class Frog
{
     public int Location { get; set; }
     public int JumpCount { get; set; }

     public void OnJump()
     {
         JumpCount++;
     }

} 
```

我需要两件事的帮助：

1.  我想在类定义中创建一个名为 Jump 的事件。
2.  我想创建一个 Frog 类的实例，然后创建另一个 Frog 跳跃时将调用的方法。

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2008-09-17T16:44:28.727

```
public event EventHandler Jump;
public void OnJump()
{
    EventHandler handler = Jump;
    if (null != handler) handler(this, EventArgs.Empty);
} 
```

然后

```
Frog frog = new Frog();
frog.Jump += new EventHandler(yourMethod);

private void yourMethod(object s, EventArgs e)
{
     Console.WriteLine("Frog has Jumped!");
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2019-01-17T19:17:50.090

这是一个如何使用普通 EventHandler 或自定义委托的示例。请注意，`?.`用于代替`.`确保如果事件为空，它将完全失败（返回空）

```
public delegate void MyAwesomeEventHandler(int rawr);
public event MyAwesomeEventHandler AwesomeJump;

public event EventHandler Jump;

public void OnJump()
{
    AwesomeJump?.Invoke(42);
    Jump?.Invoke(this, EventArgs.Empty);
} 
```

请注意，只有在没有订阅者的情况下，事件本身才为 null，并且一旦被调用，该事件就是线程安全的。因此，您还可以分配一个默认的空处理程序以确保事件不为空。请注意，这在技术上很容易被其他人清除所有事件（使用 GetInvocationList），因此请谨慎使用。

```
public event EventHandler Jump = delegate { };

public void OnJump()
{
    Jump(this, EventArgs.Empty);
} 
```

# c# - 适用于 Linux 和/或 MonoDevelop 的 C# 代码格式化程序

> ID：85139
> 
> 赞同：3
> 
> 时间：2008-09-17T16:39:35.897
> 
> 标签：c#, formatting, mono

MonoDevelop 1.0 似乎没有像 Eclipse 为 Java 提供的代码格式化程序。是否有您发现运行良好的首选 shell 脚本（或 MonoDevelop 插件？）？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-17T17:51:17.130

目前，MonoDevelop 中的源代码格式化被标记为未来的增强功能： [https ://bugzilla.novell.com/show_bug.cgi?id=321946](https://bugzilla.novell.com/show_bug.cgi?id=321946)

同时，您可能想查看 C# 格式的艺术风格：http: [//astyle.sourceforge.net/](http://astyle.sourceforge.net/)

我打算看看如何将它作为 MonoDevelop 中的外部工具连接起来。如果我做到了，我将用这些信息编辑我的答案。**更新：我没有足够的声誉来发表评论，所以我会在这里做一个：干得好，达斯汀，还有 MonoDevelop 的补丁 :-) 我想知道 Ubuntu 中包含的版本有多新......不管怎样，我很高兴你找到了适合你的东西。**

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T20:57:11.417

谢谢，布兰登。我向 MonoDevelop 提交了一个补丁。MonoDevelop 插件的问题是存在一个无法正确处理匿名委托的单编译器错误。（错误报告：[https](https://bugzilla.novell.com/show_bug.cgi?id=394347) ://bugzilla.novell.com/show_bug.cgi?id=394347 ）

补丁/解决方法是将匿名委托转换为正确的委托类型。（错误报告和补丁：[https](https://bugzilla.novell.com/show_bug.cgi?id=369538) ://bugzilla.novell.com/show_bug.cgi?id=369538 ）

我现在正在使用修补版本运行，并且能够通过简单地使用以下设置创建一个新的外部工具设置来在当前编辑的文档上执行 AStyle：

TITLE：A_Style（输入下划线`_`以启用热键）
命令：astyle
ARGUMENTS：${ItemPath}

然后，只需使用 Tools->AStyle （或`ALT`- `T`, `S`）执行它

2008 年 9 月 25 日编辑——我刚刚发布了一篇关于如何修补 MonoDevelop 1.0 并使其与 AStyle 一起工作的博客文章：http: [//dustinbreese.blogspot.com/2008/09/auto-formatting-code-in- monodevelop-10.html](http://dustinbreese.blogspot.com/2008/09/auto-formatting-code-in-monodevelop-10.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-19T08:07:28.093

编写自己的格式化程序是一个很好的编程练习。我为 C++ 写了一个，这是一个很好的挑战。你可以通过写它学到很多东西:)

# asp.net - FormsAuthentication 对 url 有选择性

> ID：85142
> 
> 赞同：0
> 
> 时间：2008-09-17T16:39:49.720
> 
> 标签：asp.net, forms-authentication

有没有办法实现表单身份验证，但仅限于特定的 URL。例如，如果 web.config 意外移动到生产站点，我希望 formsAuthentication 保护 staging.mydomain.com 上的站点，但不妨碍对 www.mydomain.com 的访问。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-13T07:03:32.940

这可以实现，但您必须为它实现自己的 IHttpModule。唉 FormsAuthenticationModule 是密封的，这意味着您必须从头开始，但[Reflector](http://www.red-gate.com/products/reflector/)可以提供很大的帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-05T20:00:45.867

我们过去使用过一个简单的解决方法。

我们将默认登录页面设置为匿名用户可以访问的简单页面，我们称之为 checkDomain.aspx

在该页面中，我们对域进行快速检查，并基于此将用户重定向到登台站点中的 login.aspx 页面，或生产站点中的原始请求 url。这并不漂亮，但是当我们担心会发生类似的事情时，它在短时间内实现起来又快又容易。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T17:01:41.057

Forms auth 在网站实例上实现。它不会那样工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T17:20:58.107

您可以在 web.config 中管理 FormsAuthentication 的功能。所以，答案就在你的问题中，@Andrew 是对的。

但是，您也许可以在 global.asax 中做一些事情来识别站点正在运行的服务器或域并禁用 FormsAuthentication。如果域是 www.mydomain.com，也许创建一个可以访问所有内容的用户并在会话开始时手动为该用户设置 FormsAuthenticationTicket。

这有点骇人听闻，我建议想出一种带外方式来控制您的 web.config。

# c# - 学习 .NET 泛型的最佳资源？

> ID：85147
> 
> 赞同：13
> 
> 时间：2008-09-17T16:40:04.507
> 
> 标签：c#, .net, generics

我从未在工作中使用过任何 .NET 泛型，但我知道它们相当流行。有没有人有任何好的链接或书籍建议来学习它们？作为奖励；我只是模糊地了解.NET 泛型集合是什么以及它们的作用......有没有人有任何实际的例子来说明它们如何比.NET 中的普通集合获得更大的优势？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-17T16:41:17.203

显而易见的选择..

[MSDN C# 泛型](http://msdn.microsoft.com/en-us/library/ms379564(VS.80).aspx)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-17T16:56:57.307

*   [http://www.informit.com/articles/article.aspx?p=605369](http://www.informit.com/articles/article.aspx?p=605369)
*   [http://www.codeproject.com/KB/cs/genericcache.aspx](http://www.codeproject.com/KB/cs/genericcache.aspx)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-17T16:44:17.353

Jeffrey Richter 通过 C# 编写的 CLR 深入探讨了泛型，是每个 .NET 开发人员都应该拥有和阅读的无价资源之一。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T16:44:22.890

如果您曾经使用过 C++ 模板，那么 .Net 泛型几乎是一回事。他们甚至使用类似的 <T> 语法。

即使你不懂任何 C++，你也可能比你需要的更难，尤其是在集合方面。它们就像任何其他集合一样，但是当您创建它们时，您在 <<> 中提供了一个类型名称，以便编译器知道它们持有什么样的项目。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T16:50:33.670

C# 3.0 in a Nutshell 是一本很棒的参考书，其中的示例足够大，足以掌握概念而不会感到臃肿。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T17:02:10.210

我发现 WROX 的 Professional .NET 2.0 Generics 非常有用，因为它包含许多真实世界的示例。泛型可能会让初学者感到困惑，但在经验丰富的开发人员手中，它们可能是一个非常有用/强大/节省时间的工具。就个人而言，我发现 .NET 泛型在简化集合的定义和使用方面最有用。此外，使用泛型可以提高代码效率，因为它可以最大限度地减少通常与装箱/拆箱类型转换相关的性能损失。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-17T18:43:53.400

最好遵循一些有关该主题的 Microsoft 培训。如果您正在寻找书籍，以下将是理想的：

[http://www.microsoft.com/MSPress/books/9469.aspx](http://www.microsoft.com/MSPress/books/9469.aspx)

* * *

## 回答 #8

> 赞同：-4
> 
> 时间：2008-09-17T16:50:38.943

我的投票是-大多数情况下你可以避免它们:)

泛型的主要优点是节省转换，如果您最终在内部进行没有任何意义的转换。如果您尝试研究这个问题，您会发现大多数泛型的候选对象实际上是那些可以在内部创建本机存储以获得这种好处的集合/集合。另一方面，与接口继承实现相比，大多数其他组件几乎没有/没有性能，并且显着降低了灵活性。

如果投射让你非常恼火，也许是时候考虑像 IronPython 这样的动态语言了 :)

而且-如果您真的遇到您认为通用的情况，请将其作为另一个问题发布，这里的大脑可以一起查看并逐案解决:)

更新：是的，编译器检查很好，但是查看 Castle Project 的源代码，您会看到很多情况下泛型类型会妨碍您，因为您无法进行强制转换——使 IBusinessObject 之类的东西比 BusinessObject 灵活得多——因为你可以'不要将继承自 BusinessObject 的东西转换回 BusinessObject 并期望访问继承的函数。通常我看到代码最终是 BusinessObjectBase -> BusinessObject ->Your actual class。这就是为什么我觉得使用泛型并不总是有益的原因——我是那些滥用这种实现并最终拥有大量有趣的泛型类型函数的人之一，一点也不好。

更新＃2：装箱/拆箱仅意味着当您使用抽象类型（如对象）来存储值并使用强类型值再次将其存储回来（这需要强制转换）时，需要强制转换对象，我可以没有太大区别除了我所说的收集情况外，请参阅。像这样的 AND 代码仍然可以装箱：

```
public T GetValue<T>() {
  return (T) ...;
} 
```

那是我最常看到的一般性滥用。人们认为他们在这里处理的是原生类型，实际上他们不是。相反，他们只是将转换转换为通用语法。真正有意义的是：

```
public class MyList<T>
{
  private List<T> _list;
...
public T GetValue(int index)
{
  return _list[index];
} 
```

然后那又回到我们的收藏库。这就是为什么我在收集存储之后说我没有看到很多机会通用帮助。本教程参考： [http ://en.csharp-online.net/Understanding_Generics—Revisiting_Boxing_and_Unboxing](http://en.csharp-online.net/Understanding_Generics%E2%80%94Revisiting_Boxing_and_Unboxing)

# javascript - 基于 jQuery 的 WYSIWYG 编辑器示例演示 OOP javascript

> ID：85155
> 
> 赞同：4
> 
> 时间：2008-09-17T16:41:06.940
> 
> 标签：javascript, jquery, wysiwyg, rtf, fckeditor

想以一个所见即所得的 jQuery 编辑器为例来说明如何使用 jQuery 来构建 OOP javascript 组件。

PS 太好了，stackoverflow 可以使用 markdown ......如果用户也喜欢这样的东西，那将是天堂

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-07-22T03:10:54.210

[jHtmlArea - 用于 jQuery 的所见即所得 HTML 编辑器](http://jhtmlarea.codeplex.com)

一个基于 jQuery 构建的简单、轻量级、可扩展的所见即所得 HTML 编辑器。该组件允许您轻松地显示 WYSIWYG HTML 编辑器来代替页面上的任何 TextArea DOM 元素。单独的缩小脚本是 7kb，加上 css 和图像文件总共有 15kb。

该项目还包括 Visual Studio JavaScript Intellisense 支持。

[替代文本 http://i3.codeplex.com/Project/Download/FileDownload.aspx?ProjectName=jhtmlarea&DownloadId=76574](http://i3.codeplex.com/Project/Download/FileDownload.aspx?ProjectName=jhtmlarea&DownloadId=76574)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-19T19:12:19.903

[http://projects.bundleweb.com.ar/jWYSIWYG/](http://projects.bundleweb.com.ar/jWYSIWYG/)看起来已经过时了，最好试试这个[jwysiwyg的链接](http://code.google.com/p/jwysiwyg/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-08-16T10:48:51.170

检查 CleEditor [http://premiumsoftware.net/cleditor/](http://premiumsoftware.net/cleditor/)

CLEditor 在 mac 和 pc 上都支持以下浏览器：IE 6.0+、FF 1.5+、Safari 4+、Chrome 5+ 和 Opera 10+。所有测试均使用 jQuery 1.4.2 完成。

CLEditor 提供了丰富的插件开发环境，允许您自定义其用户界面和功能以满足您的需求。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-31T09:19:58.950

jwysiwyg 看起来不错，但根本没有有用的文档！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-10-22T16:34:10.850

[http://wmd-editor.com/features#compatibility](http://wmd-editor.com/features#compatibility)

或者，如果您有时间为自己的解析编写/修改（我会这样做），请使用：

[http://markitup.jaysalvat.com](http://markitup.jaysalvat.com)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-01-17T21:48:53.027

WYSIWYG 可以接受从 Microsoft Word 复制的格式化文本，是...

*   CL编辑器
*   jHTML 区域
*   网卡编辑
*   新哈
*   所见即所得

我选择了 CLEdit，因为代码很干净，它允许我决定如何对齐图像，并且它没有像 NicEdit 这样的错误。在 NicEdit 上，当 HTML 代码从其他站点复制到编辑器时，它会产生双换行符。

# apache-flex - Flex 中的时间解析

> ID：85159
> 
> 赞同：3
> 
> 时间：2008-09-17T16:41:39.760
> 
> 标签：apache-flex, parsing, time, date

有没有办法使用标准库将 HH:MM 格式的字符串解析为 Date （或其他）对象？

我知道我可以使用将“9/17/2008 10:30”之类的内容解析为 Date 对象

```
var date:Date = new Date(Date.parse("9/17/2008 10:30"); 
```

但我只想自己解析 10:30。以下代码将不起作用。

```
var date:Date = new Date(Date.parse("10:30"); 
```

我知道我可以使用自定义 RegEx 相当容易地做到这一点，但使用现有的 Flex API 似乎应该可以做到这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-17T20:12:48.553

如果您必须使用您指定的确切格式，那么您需要自己解析它。

这是一个简单的例子（未测试）：

```
var str:String = "9/17/2008 10:30"

var items:Array = str.split(" ");
var dateElements:Array = items[0].split("/");
var timeElements:Array = items[1].split(":");

var n:Date = new Date(dateElements[2],
                        dateElements[0],
                        dateElements[1].
                        timeElements[0],
                        timeElements[1]); 
```

如果时间不是以 24 时钟表示的，则无法检查 AM 或 PM（代码将假定为 AM）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-19T09:18:56.690

作为一个简单且免费的解决方案，您可以使用 DateField 的一些静态方法：

*   DateField.stringToDate(valueString:String, inputFormat:String):Date
*   DateField.dateToString(value:Date, outputFattern:String):String

但不幸的是，它们不支持小时/分钟/秒（只是日期）。

在您的特定情况下：Date 对象始终还包含“日期”信息。如果它不重要，您不能在解析之前简单地连接标准日期字符串吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T16:43:29.507

您是否考虑过将“01/01/2000”添加到时间字符串然后应用日期？

或者，可能有一个分词器将接受输入并将其拆分为 : 为您提供一个可以转换为整数的字符串数组。分词器也不难写，如果 flex 中不存在分词器，它会很有趣。

-亚当

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T11:33:11.897

要回答您的具体问题：不，没有库函数可以做您想做的事情，但是没有库函数可以解析 ISO 格式、德语格式、瑞典语格式、年份所在的日期的日期罗马数字等

为什么不使用正则表达式？这就是他们的目的。

# sql-server - 修复 SQL Server 2005 Mgmt Studio 自定义键盘加速器快捷方式中的参数处理？

> ID：85179
> 
> 赞同：0
> 
> 时间：2008-09-17T16:43:50.147
> 
> 标签：sql-server, customization

[如本文](http://blogs.msdn.com/irenak/archive/2006/10/27/sysk-228-get-table-columns-or-rows-with-single-key-press.aspx)所述，我一直是存储过程键盘加速器的粉丝。但是，当我们从 SQL 2000 迁移到 2005 并从 Query Analyzer 迁移到 Management Studio 时，参数的处理方式发生了变化。在 QA 中，逗号分隔的参数被自动读取为两个单独的参数。在 SSMS 中——至少对我而言——它被当作一个论点来解读，其中包含逗号。同样，如果我传入一个带有单引号的参数，我会收到语法错误，*除非我转义引号*('->'')。在上面链接的文章中，作者暗示 SSMS 不应该是这种情况，但即使有她的确切示例，逗号分隔的参数仍然被解释为我尝试过的每个 SSMS 安装的一个参数（3 个它们），针对我尝试过的每个 SQL Server 安装（其中 4 个）运行。

例如，在 SSMS 中输入以下内容，

```
Person,4 
```

然后选择它并运行快捷方式，我收到错误消息“无效的对象名称'Person，4'。

有人知道如何解决这个问题吗？有人甚至使用这些快捷方式吗？在过去的两年里，我多次在谷歌上搜索过这个问题，但都没有运气。

编辑：可能是特定版本的 SSMS 的问题。我在下面有一个后续帖子。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-17T18:08:44.780

在阅读您的问题然后阅读您引用的文章之前，我从未尝试过此操作，因此请谨慎对待。

也就是说，我可以使用 SSMS 让该过程在我的计算机上运行，​​并且我还可以复制您描述的错误。

为了让它按预期工作，我在主数据库中创建了存储过程，分配了键盘快捷键并重新启动了 SSMS。然后我在单引号中键入了 databasename.schema_name.table_name，后跟一个逗号，然后是一个整数值（我测试的存储过程是文章中的 GetRows 示例）。我仍然连接到主数据库。

这很顺利。

为了获得您提到的相同错误，我删除了对架构名称或数据库名称的引用，并收到了与您相同的错误。

也许您需要在表名之前添加数据库名称和模式名称？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T19:25:43.267

Tim 的建议并没有解决我在开发 PC 上的问题，但它确实说服了我从另一台 PC 上再试一次。当使用不同 PC 的 SSMS 登录到开发 PC 的数据库并尝试完全按照 Tim 描述的内容时，我的行为与 Tim 描述的相同。

我还能够在我过去尝试过的其他 PC 上重新复制参数解析问题。我希望 Tim 可以让我知道他的 SSMS 安装的版本和内部版本号是什么，因为我目前的理论是问题只是来自我和我的同事在我们的开发 PC 上的特定版本 - 版本字符串是“Microsoft SQL Server 管理工作室 9.00.1399.00”。我们对该版本的所有安装都发生在一年前，所以我不知道我可以追溯到它来自哪个磁盘。

没有问题的实际上是我们的开发服务器，它安装了“Microsoft SQL Server Management Studio 9.00.3042.00”。我不知道这是否可以通过修补或其他方式消除，但目前看起来 1399 将整个选择作为单个参数读取，而 3042 进行了一些预解析。我最近还发现，当我在 3042 中传入一个包含“--”（注释标记）的字符串时，“--”之后的所有内容都会被忽略，而在 1399 中，它都包含在第一个参数中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T13:22:39.577

我也在使用 SSMS 版本 9.00.3042.00，这可能解释了为什么它可以在我的机器上运行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-18T11:26:49.893

同意蒂姆。我刚刚升级到 SQL Server 05 sp2，并确认此错误已得到修复。

# sql - 我跟踪了一个存储过程，如 SQL Server 2005 Profiler 中所示。它没有找到但有效。为什么？

> ID：85181
> 
> 赞同：2
> 
> 时间：2008-09-17T16:44:10.427
> 
> 标签：sql, sql-server, sql-server-2005, stored-procedures

这很奇怪。

我打开了我的 Profiler，它显然表明调用了一个存储过程。我打开数据库和 SP 列表，但 SP 不存在。但是，还有另一个名称相同的 SP，只是它的前缀为“x”

SQL Server 2005 是否出于安全目的将 SP 名称映射到不同的名称？

编辑：我发现它是同义词，不管它是什么。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-17T16:58:23.497

通常，如果您知道某个对象存在是因为它已在查询中使用，但您无法在 Management Studio 的对象树中找到它，则可以执行此操作来查找它。

```
select *
from sys.objects
where name = 'THE_NAME_YOU_WANT' 
```

我刚刚检查过，它适用于同义词。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T16:50:28.400

可能是愚蠢的问题，但以防万一……你刷新了 SP 列表了吗？您是否检查过不同所有者下的该名称的存储过程？如果您在未指定所有者的情况下创建了存储过程，那么它可能位于您拥有的列表中（或者，如果列表被过滤为仅“dbo”，则根本不存在）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T16:50:48.087

您可能无权查看数据库中的所有对象

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T16:52:17.850

除了前面的答案，它也可能在“系统存储过程”下，如果存储过程的名称以“sp_”开头，它也可能在主数据库中。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-07-06T15:25:51.303

存储过程将位于您在创建存储过程时选择的数据库中。因此，在从中提取数据的数据库中搜索，否则它将在主数据库中。如果您仍然无法找到，那么第一个数字解决方案是最好的。IE

```
select * from sys.objects where name = 'name of stored procedure' 
```

# .net - Windsor Container：如何强制处置对象？

> ID：85183
> 
> 赞同：11
> 
> 时间：2008-09-17T16:44:14.717
> 
> 标签：.net, inversion-of-control, castle-windsor

我有一个实现 IDisposable 的对象，该对象在 Windsor Container 中注册，我想处理它，因此调用它的 Dispose 方法，下次调用 Resolve 时它会获取一个新实例。

做

```
container.Release(obj); 
```

立即自动调用 Dispose()？还是我需要做

```
obj.Dispose();
container.Release(obj); 
```

在文档中找不到任何关于 Release 究竟是做什么的

**编辑：** 有关我运行的测试结果，请参阅下面的答案。现在问题变成了，如何强制容器释放具有单例生命周期的组件实例？这只需要在一个地方完成，编写自定义生命周期似乎太重了，没有内置的方法吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-03T11:55:47.120

这是我认为人们在使用 Windsor 容器时并没有真正意识到这一点——尤其是在内核的生命周期内，容器会***一直***持有一次性瞬态组件直到它被丢弃，除非你自己释放它们——尽管如此它被记录在案 - 看看[这里](https://github.com/castleproject/Windsor/blob/master/docs/release-policy.md)- 但要快速引用：

> MicroKernel 有一个可插拔的发布策略，可以连接并实现一些路由来处理组件。MicroKernel 带有三个 IReleasePolicy 实现：
> 
> *   AllComponentsReleasePolicy：跟踪所有组件以在 MicroKernel 实例处置时强制正确处置
> *   LifecycledComponentsReleasePolicy：仅跟踪关联了退役生命周期的组件
> *   NoTrackingReleasePolicy：不执行任何跟踪
> 
> 您还可以使用接口 IReleasePolicy 实现您自己的发布策略。

您可能会发现更容易将策略更改为**NoTrackingReleasePolicy**，然后自己处理处置 - 这也有潜在风险，但如果您的生活方式在很大程度上是短暂的（或者当您的容器被处置时，您的应用程序无论如何都将关闭）这可能没什么大不了的。但是请记住，任何已经注入单例的组件都将持有一个引用，因此您最终可能会在尝试“刷新”您的单例时导致问题 - 这似乎是一种不好的做法，我想知道您是否可以避免不得不首先通过改进应用程序的组合方式来做到这一点。

其他方法是使用自己的退役实现来构建自定义生命周期（因此释放单例实际上会处置组件，就像瞬态生命周期一样）。

或者，另一种方法是使用单例生活方式在容器中注册您的服务的装饰器，但您在容器中注册的实际底层服务具有瞬态生活方式 - 然后当您需要刷新组件时，只需处置持有的瞬态底层组件由装饰器替换它并用一个新解决的实例替换它（使用 components 键而不是服务来解决它，以避免获取装饰器） - 这避免了与其他单例服务（未被“刷新”）持有的问题到过时的服务上，这些服务已经被处理使它们无法使用，但确实需要一些强制转换等才能使其工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-17T17:15:08.683

这取决于您在将组件添加到容器时指定的组件的生活方式。

如果生活方式是池化的，您将使用 Release()。这会将组件放回池中以进行下一次检索（对象未销毁，因此处置会很糟糕）

如果生活方式是短暂的，则在获取组件时会创建一个新对象。在这种情况下，处置由您决定，您无需调用 Release

如果生活方式是线程，则每个线程使用相同的组件，而不是销毁。

如果生活方式是单例，则只创建一个组件而不会销毁。

最有可能的是，您正在使用瞬态组件？（如果您担心及时处理它们）在这种情况下，只需用 using 包装它就可以了（或在某个地方自己调用 dispose）

```
using(ISomeService service = container.Resolve<ISomeService>())
{
 // Do stuff here
 // service.Dispose is automatically called 
} 
```

**编辑**- 是的，为了“刷新”或处置并重新创建您的单例，您需要销毁容器或编写自定义生命周期。执行自定义生命周期实际上并没有那么困难，并且将执行此操作的逻辑保留在一个地方。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T17:51:40.890

好吧，所以我一直在运行测试，似乎只有在生活方式是瞬态的情况下才会`Container.Release()`隐含地导致 IDisposable 的方法执行（这可能不完全正确，但关键是如果生活方式是单身，它就不会做一件该死的事`Dispose()`）。

现在如果你调用`Container.Dispose()`它，也会调用一次性方法，但不幸的是它会处理整个内核，你必须重新添加所有组件：

```
var container = new WindsorContainer();
container.AddComponentWithLifestyle<MyDisposable>(Castle.Core.LifestyleType.Singleton);
var obj = container.Resolve<MyDisposable>();  // Create a new instance of MyDisposable
obj.DoSomething();
var obj2 = container.Resolve<MyDisposable>();  // Returns the same instance as obj
obj2.DoSomething();
container.Dispose();  // Will call the Disposable method of obj
// Now the components need to be added back in   
 container.AddComponentWithLifestyle<MyDisposable>(Castle.Core.LifestyleType.Singleton);
var obj3 = container.Resolve<MyDisposable>();  // Create a new instance of MyDisposable 
```

幸运的是，在我的情况下，我可以只删除所有组件，并且可以相当轻松地恢复它们。然而，这是次优的。

# sql-server - SQL Server 的 mysqldump 等效项

> ID：85186
> 
> 赞同：20
> 
> 时间：2008-09-17T16:44:22.907
> 
> 标签：sql-server, windows, data-migration

SQL Server 是否有与带有 mysqldump 的 MySQL 等效的架构和数据导出/转储工具。试图重新定位一个遗留的 ASP 站点，我对在 Windows 服务器上工作感到不满意。

注意：DTS 导出实用程序自己的似乎导出数据，没有表定义。使用企业管理器和导出数据库更接近导出模式和数据......但仍然错过存储过程。

基本上是在寻找一个可以一次性满足我所有需求的解决方案。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-07-15T18:28:21.700

## 要使用 SQL Server 2008 Management Studio 轻松完成此操作：

1.) 右键单击​​数据库（不是表）并选择任务 -> 生成脚本

![工具的位置](https://i.stack.imgur.com/9MnoI.jpg)

2.) 在第一页点击下一步

3.) 如果要复制整个数据库，只需单击下一步。如果要复制特定表，请单击“选择特定数据库对象”，选择所需的表，然后单击下一步。

4.) 应选择“保存到文件”。**重要提示**：单击“保存到文件”旁边的“高级”按钮，找到“要脚本的数据类型”，然后将“仅模式”更改为“模式和数据”（如果要创建表）或“仅数据”（如果您要将数据复制到现有表中）。

![将数据添加到脚本](https://i.stack.imgur.com/nFnug.jpg)

5.) 点击其余部分，您就完成了！它将保存为 .sql 文件。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-09-17T17:26:32.197

最简单的方法是 sql server 数据库发布向导。

*   开源
*   自由
*   做你想要的
*   由微软开发

它没有 mysqldump 的所有功能，但足够接近。

[http://www.codeplex.com/sqlhost/wiki/view.aspx?title=database%20publishing%20wizard](http://www.codeplex.com/sqlhost/wiki/view.aspx?title=database%20publishing%20wizard)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-09-17T16:51:56.897

移动数据库的最简单方法是使用 SQL Server Management Studio 将数据库导出到另一台服务器，或者如果这不起作用，请按照其他人的建议进行备份并在其他地方恢复。

如果您正在寻找一种将表结构转储到 SQL 以及为数据创建插入脚本的方法，一个不错的免费选择是使用来自[http://www.asql.biz/en/Download2005.aspx](http://www.asql.biz/en/Download2005.aspx)的 amScript 和 amInsert .

如果您想要一个好的付费版本，我会查看 Red-Gate SQL Compare 和 Red-Gate SQL-Data Compare。但是，如果您不打算大量使用它们，这些工具可能有点矫枉过正，而且可能有点贵。我认为它将主要归入 DBA。您可以在[http://www.red-gate.com/](http://www.red-gate.com/)查看 Red-Gate 工具。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2011-09-21T14:35:49.950

没有找到合适的工具，我决定创建自己的：一个 sqlserverdump 命令行实用程序。[在github](https://github.com/daniel-jann/sqlserverdump/)上查看。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-01-05T15:50:46.920

更简单的是使用 SMO API。它可以让你做的和 mysqldump 完全一样，甚至更好。这是一个代码示例：

[http://samyem.blogspot.com/2010/01/automate-sql-dumps-for-sqlserver.html](http://samyem.blogspot.com/2010/01/automate-sql-dumps-for-sqlserver.html)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-17T16:45:53.603

嗯，Mysqldump 就是一系列的 SQL 语句。您可以使用 DTS 做到这一点，但为什么不直接在新机器上创建备份并恢复它呢？

如果您想通过 SQL 执行此操作：http: [//msdn.microsoft.com/en-us/library/aa225964 (SQL.80).aspx](http://msdn.microsoft.com/en-us/library/aa225964(SQL.80).aspx)

或者只需右键单击数据库并点击任务-> 备份 ( [http://msdn.microsoft.com/en-us/library/ms187510.aspx](http://msdn.microsoft.com/en-us/library/ms187510.aspx) )

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-17T16:46:34.587

最简单的是备份和恢复或分离和附加

或编写所有表的脚本并 BCP 输出数据，然后 BCP 在新服务器上的数据中

或使用 DTS/SSIS 来执行此操作

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-17T16:48:35.767

SQL Enterprise manager 或 SQL Server Management studio 具有基于向导的方法，后者将生成脚本，以便您了解它是如何完成的。

您还可以使用 BACKUP 和 RESTORE 命令。更多细节在这里：http: [//msdn.microsoft.com/en-us/library/ms189826.aspx](http://msdn.microsoft.com/en-us/library/ms189826.aspx)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-17T16:48:54.067

如果您可以让 DTS 或集成服务连接到两台服务器，则可以使用向导将对象从一台服务器“复制”到另一台服务器。“复制数据库”要求两台服务器可以相互验证，这通常意味着在同一个域中，并且服务在域登录下运行。

否则，您可以为架构生成脚本，并且可以使用 Integration Services/DTS 包将数据导出到文件，然后在另一个文件中导入。

我们现在一般使用[SQL Compare](http://www.red-gate.com/products/SQL_Compare/index.htm)和[SQL Data Compare](http://www.red-gate.com/products/SQL_Data_Compare/index.htm)。Red Gate 的[SQL Packager](http://www.red-gate.com/products/SQL_Packager/index.htm)也可能是一个选项。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-08-05T17:07:55.380

备份/恢复不会做的两件事：

1.  从 Microsoft 服务器下车，这是原始问题的一部分
2.  当其中一个运行缓慢时，帮助快速找到应该具有相同结构的两个 DB 之间的结构差异。Unix diff 或 sdiff，忽略空格，但需要一种方法来制作输入文件。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-04-30T21:31:21.657

如果您需要 CREATE TABLE... & INSERT INTO... 等等效 SQL 语句，那么我建议您尝试 HeidiSQL。这是一个很棒的免费实用程序，可以访问 Microsoft SQL Server、MySQL 和 PostgreSQL。它使您能够浏览和编辑数据、创建和编辑表、视图、过程、触发器和预定事件。此外，您可以将结构和数据导出到 SQL 文件。 [http://www.heidisql.com](http://www.heidisql.com)

转到工具/将数据库导出为 SQL 并选择架构。选中该框以创建表格和“插入”数据。就是这样。

我更喜欢 HeidiSQL 到“Microsoft SQL Server Management Studio”或 phpMyAdmin... 等。

# java - Java 'for each' 循环是如何工作的？

> ID：85190
> 
> 赞同：1633
> 
> 时间：2008-09-17T16:44:32.360
> 
> 标签：java, foreach, syntactic-sugar

考虑：

```
List<String> someList = new ArrayList<String>();
// add "monkey", "donkey", "skeleton key" to someList 
```

```
for (String item : someList) {
    System.out.println(item);
} 
```

*如果不使用for each*语法，等效`for`循环会是什么样子？

 ** * *

## 回答 #1

> 赞同：1262
> 
> 时间：2008-09-17T16:46:28.283

```
for (Iterator<String> i = someIterable.iterator(); i.hasNext();) {
    String item = i.next();
    System.out.println(item);
} 
```

请注意，如果您需要`i.remove();`在循环中使用，或以某种方式访问​​实际的迭代器，则不能使用该`for ( : )`惯用语，因为实际的迭代器只是推断出来的。

正如 Denis Bueno 所指出的，此代码适用于任何实现[`Iterable`interface](http://docs.oracle.com/javase/8/docs/api/java/lang/Iterable.html)的对象。

`for (:)`此外，如果习语的右侧是 an`array`而不是`Iterable`object，则内部代码使用 int 索引计数器并进行检查`array.length`。请参阅[Java 语言规范](http://docs.oracle.com/javase/specs/jls/se8/html/jls-14.html#jls-14.14.2)。

* * *

## 回答 #2

> 赞同：539
> 
> 时间：2008-09-17T17:06:39.157

*each*的构造也适用于数组。例如

```
String[] fruits = new String[] { "Orange", "Apple", "Pear", "Strawberry" };

for (String fruit : fruits) {
    // fruit is an element of the `fruits` array.
} 
```

这基本上相当于

```
for (int i = 0; i < fruits.length; i++) {
    String fruit = fruits[i];
    // fruit is an element of the `fruits` array.
} 
```

所以，总体总结：
[[nsayer]](https://stackoverflow.com/questions/85190/how-does-the-java-for-each-loop-work/85206#85206)以下是正在发生的事情的较长形式：

> ```
> for(Iterator<String> i = someList.iterator(); i.hasNext(); ) {
>   String item = i.next();
>   System.out.println(item);
> } 
> ```
> 
> 请注意，如果您需要使用 i.remove(); 在您的循环中，或以某种方式访问​​实际的迭代器，您不能使用 for( : ) 习惯用法，因为实际的迭代器只是推断出来的。

[[丹尼斯布埃诺]](https://stackoverflow.com/questions/85190/how-does-the-java-for-each-loop-work/85242#85242)

> nsayer 的回答暗示了这一点，但值得注意的是，当“someList”是实现 java.lang.Iterable 的任何东西时，OP 的 for(..) 语法将起作用——它不必是列表或来自java.util. 因此，即使您自己的类型也可以使用这种语法。

* * *

## 回答 #3

> 赞同：180
> 
> 时间：2014-03-01T12:47:20.413

[Java 5](http://docs.oracle.com/javase/1.5.0/docs/guide/language/index.html)中添加的[for-each 循环](http://docs.oracle.com/javase/1.5.0/docs/guide/language/foreach.html)（也称为“增强的 for 循环”）相当于使用--it 的语法糖来处理同一件事。因此，在逐个按顺序读取每个元素时，应始终选择 for-each 而不是迭代器，因为它更方便和简洁。[`java.util.Iterator`](http://docs.oracle.com/javase/7/docs/api/java/util/Iterator.html)

### 对于每个

```
for (int i : intList) {
   System.out.println("An element in the list: " + i);
} 
```

### 迭代器

```
Iterator<Integer> intItr = intList.iterator();
while (intItr.hasNext()) {
   System.out.println("An element in the list: " + intItr.next());
} 
```

在某些情况下，您必须`Iterator`直接使用 an。例如，在使用 for-each 时尝试删除元素可以（会？）导致`ConcurrentModificationException`.

## For-each vs. for-loop：基本区别

for-loop 和 for-each 之间唯一实际的区别是，在可索引对象的情况下，您无权访问索引。需要基本 for 循环的示例：

```
for (int i = 0; i < array.length; i++) {
   if(i < 5) {
      // Do something special
   }  else {
      // Do other stuff
   }
} 
```

尽管您可以使用 for-each 手动创建一个单独的索引 int 变量，

```
int idx = -1;
for (int i : intArray) {
   idx++;
   ...
} 
```

...不建议这样做，因为[变量范围](http://www.java-made-easy.com/variable-scope.html)并不理想，并且基本`for`循环只是此用例的标准和预期格式。

## For-each vs. for-loop：性能

访问集合时，for-each比基本循环的数组访问[要快得多。](https://stackoverflow.com/questions/1879255/traditional-for-loop-vs-iterator-in-java)`for`然而，当访问数组时——至少使用原始数组和包装数组——通过索引进行访问的速度要快得多。

### 计算原始 int 数组的迭代器和索引访问之间的差异

访问数组时，索引比迭代器快 23-40% *。*这是本文底部测试类的输出，它对 100 元素的原始整数数组中的数字求和（A 是迭代器，B 是索引）：`int``Integer`

```
[C:\java_code\]java TimeIteratorVsIndexIntArray 1000000
Test A: 358,597,622 nanoseconds
Test B: 269,167,681 nanoseconds
B faster by 89,429,941 nanoseconds (24.438799231635727% faster)

[C:\java_code\]java TimeIteratorVsIndexIntArray 1000000
Test A: 377,461,823 nanoseconds
Test B: 278,694,271 nanoseconds
B faster by 98,767,552 nanoseconds (25.666236154695838% faster)

[C:\java_code\]java TimeIteratorVsIndexIntArray 1000000
Test A: 288,953,495 nanoseconds
Test B: 207,050,523 nanoseconds
B faster by 81,902,972 nanoseconds (27.844689860906513% faster)

[C:\java_code\]java TimeIteratorVsIndexIntArray 1000000
Test A: 375,373,765 nanoseconds
Test B: 283,813,875 nanoseconds
B faster by 91,559,890 nanoseconds (23.891659337194227% faster)

[C:\java_code\]java TimeIteratorVsIndexIntArray 1000000
Test A: 375,790,818 nanoseconds
Test B: 220,770,915 nanoseconds
B faster by 155,019,903 nanoseconds (40.75164734599769% faster)

[C:\java_code\]java TimeIteratorVsIndexIntArray 1000000
Test A: 326,373,762 nanoseconds
Test B: 202,555,566 nanoseconds
B faster by 123,818,196 nanoseconds (37.437545972215744% faster) 
```

我还为一个`Integer`数组运行了这个，索引仍然是明显的赢家，但只快了 18% 到 25%。

### 对于集合，迭代器比索引快

然而，对于 a `List`of `Integers`，迭代器显然是赢家。只需将测试类中的 int-array 更改为：

```
List<Integer> intList = Arrays.asList(new Integer[] {1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100}); 
```

并对测试功能进行必要的更改（`int[]`to `List<Integer>`、`length`to`size()`等）：

```
[C:\java_code\]java TimeIteratorVsIndexIntegerList 1000000
Test A: 3,429,929,976 nanoseconds
Test B: 5,262,782,488 nanoseconds
A faster by 1,832,852,512 nanoseconds (34.326681820485675% faster)

[C:\java_code\]java TimeIteratorVsIndexIntegerList 1000000
Test A: 2,907,391,427 nanoseconds
Test B: 3,957,718,459 nanoseconds
A faster by 1,050,327,032 nanoseconds (26.038700083921256% faster)

[C:\java_code\]java TimeIteratorVsIndexIntegerList 1000000
Test A: 2,566,004,688 nanoseconds
Test B: 4,221,746,521 nanoseconds
A faster by 1,655,741,833 nanoseconds (38.71935684115413% faster)

[C:\java_code\]java TimeIteratorVsIndexIntegerList 1000000
Test A: 2,770,945,276 nanoseconds
Test B: 3,829,077,158 nanoseconds
A faster by 1,058,131,882 nanoseconds (27.134122749113843% faster)

[C:\java_code\]java TimeIteratorVsIndexIntegerList 1000000
Test A: 3,467,474,055 nanoseconds
Test B: 5,183,149,104 nanoseconds
A faster by 1,715,675,049 nanoseconds (32.60101667104192% faster)

[C:\java_code\]java TimeIteratorVsIndexIntList 1000000
Test A: 3,439,983,933 nanoseconds
Test B: 3,509,530,312 nanoseconds
A faster by 69,546,379 nanoseconds (1.4816434912159906% faster)

[C:\java_code\]java TimeIteratorVsIndexIntList 1000000
Test A: 3,451,101,466 nanoseconds
Test B: 5,057,979,210 nanoseconds
A faster by 1,606,877,744 nanoseconds (31.269164666060377% faster) 
```

在一项测试中，它们几乎是等价的，但是对于集合，迭代器获胜。

*这篇文章基于我在 Stack Overflow 上写的两个答案：

*   *[Java 中 for-each 循环的用法和语法](https://stackoverflow.com/questions/22110482/uses-and-syntax-for-for-each-loop-in-java/22110517#22110517)*

*   *[我应该使用 Iterator 还是 forloop 进行迭代？](https://stackoverflow.com/questions/22540025/should-i-use-an-iterator-or-a-forloop-to-iterate/22540191#22540191)*

更多信息：*[哪个更有效，for-each 循环还是迭代器？](https://stackoverflow.com/questions/2113216/which-is-more-efficient-a-for-each-loop-or-an-iterator)*

### 完整的测试类

在阅读Stack Overflow 上的[这个问题](https://stackoverflow.com/questions/180158/how-do-i-time-a-methods-execution-in-java)后，我创建了这个 compare-the-time-it-takes-to-do-any-two-things 类：

```
import  java.text.NumberFormat;
import  java.util.Locale;

/**
   &lt;P&gt;{@code java TimeIteratorVsIndexIntArray 1000000}&lt;/P&gt;

   @see  &lt;CODE&gt;&lt;A HREF=&quot;https://stackoverflow.com/questions/180158/how-do-i-time-a-methods-execution-in-java&quot;&gt;https://stackoverflow.com/questions/180158/how-do-i-time-a-methods-execution-in-java&lt;/A&gt;&lt;/CODE&gt;
 **/
public class TimeIteratorVsIndexIntArray {

    public static final NumberFormat nf = NumberFormat.getNumberInstance(Locale.US);

    public static final void main(String[] tryCount_inParamIdx0) {
        int testCount;

        // Get try-count from a command-line parameter
        try {
           testCount = Integer.parseInt(tryCount_inParamIdx0[0]);
        }
        catch(ArrayIndexOutOfBoundsException | NumberFormatException x) {
           throw  new IllegalArgumentException("Missing or invalid command line parameter: The number of testCount for each test. " + x);
        }

        //Test proper...START
        int[] intArray = new int[] {1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100};

        long lStart = System.nanoTime();
        for(int i = 0; i < testCount; i++) {
           testIterator(intArray);
        }

        long lADuration = outputGetNanoDuration("A", lStart);

        lStart = System.nanoTime();
        for(int i = 0; i < testCount; i++) {
           testFor(intArray);
        }

        long lBDuration = outputGetNanoDuration("B", lStart);

        outputGetABTestNanoDifference(lADuration, lBDuration, "A", "B");
    }

    private static final void testIterator(int[] int_array) {
       int total = 0;
       for(int i = 0; i < int_array.length; i++) {
          total += int_array[i];
       }
    }

    private static final void testFor(int[] int_array) {
       int total = 0;
       for(int i : int_array) {
          total += i;
       }
    }
    //Test proper...END

    //Timer testing utilities...START
    public static final long outputGetNanoDuration(String s_testName, long l_nanoStart) {
        long lDuration = System.nanoTime() - l_nanoStart;
        System.out.println("Test " + s_testName + ": " + nf.format(lDuration) + " nanoseconds");
        return  lDuration;
    }

    public static final long outputGetABTestNanoDifference(long l_aDuration, long l_bDuration, String s_aTestName, String s_bTestName) {
        long lDiff = -1;
        double dPct = -1.0;
        String sFaster = null;
        if(l_aDuration > l_bDuration) {
            lDiff = l_aDuration - l_bDuration;
            dPct = 100.00 - (l_bDuration * 100.0 / l_aDuration + 0.5);
            sFaster = "B";
        }
        else {
            lDiff = l_bDuration - l_aDuration;
            dPct = 100.00 - (l_aDuration * 100.0 / l_bDuration + 0.5);
            sFaster = "A";
        }
        System.out.println(sFaster + " faster by " + nf.format(lDiff) + " nanoseconds (" + dPct + "% faster)");
        return  lDiff;
   }

   //Timer testing utilities...END

} 
```

* * *

## 回答 #4

> 赞同：134
> 
> 时间：2011-10-31T16:35:57.580

这是一个不假设 Java 迭代器知识的答案。它不太精确，但对教育很有用。

在编程时，我们经常编写如下代码：

```
char[] grades = ....
for(int i = 0; i < grades.length; i++) {   // for i goes from 0 to grades.length
    System.out.print(grades[i]);           // Print grades[i]
} 
```

foreach 语法允许以更自然和更少语法噪音的方式编写这种通用模式。

```
for(char grade : grades) {   // foreach grade in grades
    System.out.print(grade); // print that grade
} 
```

此外，此语法对于不支持数组索引但实现 Java Iterable 接口的对象（例如 Lists 或 Sets）有效。

* * *

## 回答 #5

> 赞同：44
> 
> 时间：2008-09-17T16:46:53.913

Java 中的 for-each 循环使用底层的迭代器机制。所以它与以下内容相同：

```
Iterator<String> iterator = someList.iterator();

while (iterator.hasNext()) {
  String item = iterator.next();
  System.out.println(item);
} 
```

* * *

## 回答 #6

> 赞同：41
> 
> 时间：2015-10-20T09:12:52.210

正如[JLS](http://docs.oracle.com/javase/specs/jls/se8/html/jls-14.html#jls-14.14.2)中定义的那样， for-each 循环可以有两种形式：

1.  如果 Expression 的类型是的子类型，`Iterable`则翻译为：

    ```
    List<String> someList = new ArrayList<String>();
    someList.add("Apple");
    someList.add("Ball");
    for (String item : someList) {
        System.out.println(item);
    }

    // IS TRANSLATED TO:

    for(Iterator<String> stringIterator = someList.iterator(); stringIterator.hasNext(); ) {
        String item = stringIterator.next();
        System.out.println(item);
    } 
    ```

2.  如果 Expression 必须具有数组类型`T[]`，则：

    ```
    String[] someArray = new String[2];
    someArray[0] = "Apple";
    someArray[1] = "Ball";

    for(String item2 : someArray) {
        System.out.println(item2);
    }

    // IS TRANSLATED TO:
    for (int i = 0; i < someArray.length; i++) {
        String item2 = someArray[i];
        System.out.println(item2);
    } 
    ```

Java 8 引入了流，这些流通常在下降大小的数据集上表现更好。我们可以将它们用作：

```
someList.stream().forEach(System.out::println);
Arrays.stream(someArray).forEach(System.out::println); 
```

* * *

## 回答 #7

> 赞同：26
> 
> 时间：2008-09-17T16:50:02.847

nsayer 的回答暗示了这一点，但值得注意的是，当“someList”是实现 java.lang.Iterable 的*任何东西*时，OP 的 for(..) 语法将起作用——它不必是列表或来自java.util. 因此，即使您自己的类型也可以使用这种语法。

* * *

## 回答 #8

> 赞同：24
> 
> 时间：2013-11-07T05:35:25.547

foreach 循环语法是：

```
for (type obj:array) {...} 
```

例子：

```
String[] s = {"Java", "Coffe", "Is", "Cool"};
for (String str:s /*s is the array*/) {
    System.out.println(str);
} 
```

输出：

```
Java
Coffe
Is
Cool 
```

警告：您可以使用 foreach 循环访问数组元素，但不能初始化它们。为此使用原始`for`循环。

警告：您必须将数组的类型与其他对象匹配。

```
for (double b:s) // Invalid-double is not String 
```

如果要编辑元素，请使用原始`for`循环，如下所示：

```
for (int i = 0; i < s.length-1 /*-1 because of the 0 index */; i++) {
    if (i==1) //1 because once again I say the 0 index
        s[i]="2 is cool";
    else
        s[i] = "hello";
} 
```

现在，如果我们将 s 转储到控制台，我们会得到：

```
hello
2 is cool
hello
hello 
```

* * *

## 回答 #9

> 赞同：23
> 
> 时间：2014-04-19T15:22:03.023

在 Java 8 功能中，您可以使用：

```
List<String> messages = Arrays.asList("First", "Second", "Third");

void forTest(){
    messages.forEach(System.out::println);
} 
```

### 输出

```
First
Second
Third 
```

* * *

## 回答 #10

> 赞同：22
> 
> 时间：2008-09-17T18:04:18.410

Java“for-each”循环结构将允许对两种类型的对象进行迭代：

*   `T[]` *（任何类型的数组）*
*   `java.lang.Iterable<T>`

该`Iterable<T>`接口只有一种方法：`Iterator<T> iterator()`. 这适用于类型`Collection<T>`的对象，因为`Collection<T>`接口扩展`Iterable<T>`。

* * *

## 回答 #11

> 赞同：18
> 
> 时间：2012-10-04T07:47:43.353

Wikipedia 中提到的 foreach 循环的概念在下面突出显示：

> 然而，与其他 for 循环结构不同，foreach 循环通常不维护**明确的计数器**：它们本质上说“对这个集合中的所有内容执行此操作”，而不是“执行此操作 x 次”。这避免了潜在**的错误**，并使代码更易于阅读。

因此，foreach 循环的概念描述了该循环不使用任何显式计数器，这意味着无需使用索引来遍历列表，从而使用户免于出错。为了描述这种非一错误的一般概念，让我们举一个使用索引遍历列表的循环示例。

```
// In this loop it is assumed that the list starts with index 0
for(int i=0; i<list.length; i++){

} 
```

但是假设如果列表从索引 1 开始，那么这个循环将抛出一个异常，因为它不会在索引 0 处找到任何元素，并且这个错误称为非一错误。因此，为了避免这种非同一个错误，使用了 foreach 循环的概念。可能还有其他优点，但我认为这是使用 foreach 循环的主要概念和优点。

* * *

## 回答 #12

> 赞同：17
> 
> 时间：2018-08-30T13:23:15.420

在 Java 8 中，他们引入了 forEach。使用它 List，可以循环 Maps。

**使用 for each 循环一个列表**

```
List<String> someList = new ArrayList<String>();
someList.add("A");
someList.add("B");
someList.add("C");

someList.forEach(listItem -> System.out.println(listItem)) 
```

或者

```
someList.forEach(listItem-> {
     System.out.println(listItem); 
}); 
```

**循环使用每个地图**

```
Map<String, String> mapList = new HashMap<>();
    mapList.put("Key1", "Value1");
    mapList.put("Key2", "Value2");
    mapList.put("Key3", "Value3");

mapList.forEach((key,value)->System.out.println("Key: " + key + " Value : " + value)); 
```

或者

```
mapList.forEach((key,value)->{
    System.out.println("Key : " + key + " Value : " + value);
}); 
```

* * *

## 回答 #13

> 赞同：13
> 
> 时间：2008-09-17T16:48:10.027

这是一个等价的表达式。

```
for(Iterator<String> sit = someList.iterator(); sit.hasNext(); ) {
    System.out.println(sit.next());
} 
```

* * *

## 回答 #14

> 赞同：13
> 
> 时间：2008-09-17T16:49:03.783

```
for (Iterator<String> itr = someList.iterator(); itr.hasNext(); ) {
   String item = itr.next();
   System.out.println(item);
} 
```

* * *

## 回答 #15

> 赞同：13
> 
> 时间：2018-06-21T11:05:15.907

使用较旧的 Java 版本，包括`Java 7`您可以`foreach`按如下方式使用循环。

```
List<String> items = new ArrayList<>();
        items.add("A");
        items.add("B");
        items.add("C");
        items.add("D");
        items.add("E");

        for(String item : items){
            System.out.println(item);
        } 
```

以下是使用`foreach`循环的最新方法`Java 8`

`forEach`（使用+ lambda 表达式或方法引用循环列表）

```
//lambda
    //Output : A,B,C,D,E
    items.forEach(item->System.out.println(item));

//method reference
    //Output : A,B,C,D,E
    items.forEach(System.out::println); 
```

有关更多信息，请参阅此链接。

[https://www.mkyong.com/java8/java-8-foreach-examples/](https://www.mkyong.com/java8/java-8-foreach-examples/)

* * *

## 回答 #16

> 赞同：11
> 
> 时间：2008-09-17T16:53:52.913

另请注意，在原始问题中使用“foreach”方法确实有一些限制，例如在迭代期间无法从列表中删除项目。

新的 for 循环更易于阅读，并且无需单独的迭代器，但仅在只读迭代过程中真正可用。

* * *

## 回答 #17

> 赞同：10
> 
> 时间：2017-05-17T07:14:08.323

forEach 的替代方案，以避免您的“for each”：

```
List<String> someList = new ArrayList<String>(); 
```

变体 1（普通）：

```
someList.stream().forEach(listItem -> {
    System.out.println(listItem);
}); 
```

变体 2（并行执行（更快））：

```
someList.parallelStream().forEach(listItem -> {
    System.out.println(listItem);
}); 
```

* * *

## 回答 #18

> 赞同：9
> 
> 时间：2015-09-30T04:44:49.500

它通过消除所有基本的循环杂乱来为您的代码增添美感。它使您的代码看起来很干净，如下所示。

**正常`for`循环：**

```
void cancelAll(Collection<TimerTask> list) {
    for (Iterator<TimerTask> i = list.iterator(); i.hasNext();)
         i.next().cancel();
} 
```

**使用每个：**

```
void cancelAll(Collection<TimerTask> list) {
    for (TimerTask t : list)
        t.cancel();
} 
```

**for-each是对实现****Iterator**的集合的构造。请记住，您的集合应该实现**Iterator**；否则你不能将它与 for-each 一起使用。

以下行读作“*对于列表中的每个 TimerTask t。* ”

```
for (TimerTask t : list) 
```

在 for-each 的情况下出错的可能性较小。您不必担心初始化迭代器或初始化循环计数器并终止它（存在错误的地方）。

* * *

## 回答 #19

> 赞同：9
> 
> 时间：2018-02-27T18:11:50.007

在 Java 8 之前，您需要使用以下内容：

```
Iterator<String> iterator = someList.iterator();

while (iterator.hasNext()) {
    String item = iterator.next();
    System.out.println(item);
} 
```

但是，随着 Java 8 中 Streams 的引入，您可以用更少的语法来做同样的事情。例如，对于您，`someList`您可以执行以下操作：

```
someList.stream().forEach(System.out::println); 
```

[您可以在此处](https://docs.oracle.com/javase/8/docs/api/java/util/stream/package-summary.html)找到有关流的更多信息。

* * *

## 回答 #20

> 赞同：8
> 
> 时间：2008-09-17T16:48:15.847

它看起来像这样。很邋遢。

```
for (Iterator<String> i = someList.iterator(); i.hasNext(); )
        System.out.println(i.next()); 
```

[Sun 文档](http://java.sun.com/j2se/1.5.0/docs/guide/language/foreach.html)中的*每*一个都有很好的说明。

* * *

## 回答 #21

> 赞同：7
> 
> 时间：2016-11-29T03:20:27.020

正如许多好的答案所说，一个对象必须实现`Iterable interface`if 它想要使用`for-each`循环。

我将发布一个简单的示例，并尝试以不同的方式解释`for-each`循环​​是如何工作的。

`for-each`循环示例：

```
public class ForEachTest {

    public static void main(String[] args) {

        List<String> list = new ArrayList<String>();
        list.add("111");
        list.add("222");

        for (String str : list) {
            System.out.println(str);
        }
    }
} 
```

然后，如果我们使用`javap`反编译这个类，我们会得到这个字节码样本：

```
public static void main(java.lang.String[]);
    flags: ACC_PUBLIC, ACC_STATIC
    Code:
      stack=2, locals=4, args_size=1
         0: new           #16                 // class java/util/ArrayList
         3: dup
         4: invokespecial #18                 // Method java/util/ArrayList."<init>":()V
         7: astore_1
         8: aload_1
         9: ldc           #19                 // String 111
        11: invokeinterface #21,  2           // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
        16: pop
        17: aload_1
        18: ldc           #27                 // String 222
        20: invokeinterface #21,  2           // InterfaceMethod java/util/List.add:(Ljava/lang/Object;)Z
        25: pop
        26: aload_1
        27: invokeinterface #29,  1           // InterfaceMethod java/util/List.iterator:()Ljava/util/Iterator; 
```

从示例的最后一行可以看出，编译器会自动将`for-each`关键字的使用转换`Iterator`为编译时的使用。这可以解释为什么没有实现 的对象在尝试使用循环时`Iterable interface`会抛出一个。`Exception``for-each`

* * *

## 回答 #22

> 赞同：7
> 
> 时间：2018-05-02T13:11:27.817

[每个循环](https://funnelgarden.com/java-for-loop/#Enhanced_For_Loop)的Java （又名增强的 for 循环）是 for 循环的简化版本。优点是需要编写的代码更少，需要管理的变量也更少。缺点是您无法控制步长值，也无法访问循环体内的循环索引。

当步长值是 1 的简单增量并且您只需要访问当前循环元素时，最好使用它们。例如，如果您需要遍历数组或 Collection 中的每个元素，而不是在当前元素的前面或后面窥视。

没有循环初始化，没有布尔条件，步长值是隐式的，是一个简单的增量。这就是为什么它们被认为比常规 for 循环简单得多的原因。

增强的 for 循环遵循以下执行顺序：

1) 循环体

2) 从步骤 1 开始重复，直到遍历整个数组或集合

**示例 – 整数数组**

```
int [] intArray = {1, 3, 5, 7, 9};
for(int currentValue : intArray) {
  System.out.println(currentValue);
} 
```

currentValue 变量保存在 intArray 数组中循环的当前值。请注意，没有明确的步长值——它总是以 1 为增量。

冒号可以被认为是“in”的意思。因此增强的 for 循环声明状态：循环 intArray 并将当前数组 int 值存储**在**currentValue 变量中。

输出：

```
1
3
5
7
9 
```

**示例 – 字符串数组**

我们可以使用 for-each 循环遍历字符串数组。循环声明状态：循环 myStrings String 数组并将当前 String 值存储**在**currentString 变量中。

```
String [] myStrings  = {
  "alpha",
  "beta",
  "gamma",
  "delta"
};

for(String currentString : myStrings) {
  System.out.println(currentString);
} 
```

输出：

```
alpha
beta
gamma
delta 
```

**示例 – 列表**

增强的 for 循环也可用于迭代 java.util.List，如下所示：

```
List<String> myList = new ArrayList<String>();
myList.add("alpha");
myList.add("beta");
myList.add("gamma");
myList.add("delta");

for(String currentItem : myList) {
  System.out.println(currentItem);
} 
```

循环声明状态：循环 myList 字符串列表并将当前列表值存储**在**currentItem 变量中。

输出：

```
alpha
beta
gamma
delta 
```

**示例 – 设置**

增强的 for 循环也可用于迭代 java.util.Set，如下所示：

```
Set<String> mySet = new HashSet<String>();
mySet.add("alpha");
mySet.add("alpha");
mySet.add("beta");
mySet.add("gamma");
mySet.add("gamma");
mySet.add("delta");

for(String currentItem : mySet) {
  System.out.println(currentItem);
} 
```

循环声明状态：循环 mySet 字符串集并将当前 Set 值存储**在**currentItem 变量中。请注意，由于这是一个 Set，因此不会存储重复的 String 值。

输出：

```
alpha
delta
beta
gamma 
```

资料来源：[Java 中的循环 – 终极指南](https://funnelgarden.com/java-for-loop/)

* * *

## 回答 #23

> 赞同：6
> 
> 时间：2020-01-09T16:05:37.020

正如许多其他答案正确指出的那样，这`for` `each` `loop`只是相同旧`for` `loop`的语法糖，编译器将其转换为相同的旧 for 循环。

***javac (open jdk) 有一个 switch `-XD-printflat`，它生成一个删除所有语法糖的 java 文件。***完整的命令如下所示

```
javac -XD-printflat -d src/ MyFile.java

//-d is used to specify the directory for output java file 
```

### ***所以让我们去掉语法糖***

为了回答这个问题，我创建了一个文件并编写了两个版本的`for` `each`，一个`array`带有`list`. 我的`java`文件看起来像这样。

```
import java.util.*;
public class Temp{

    private static void forEachArray(){
        int[] arr = new int[]{1,2,3,4,5};
        for(int i: arr){
            System.out.print(i);
        }
    }

    private static void forEachList(){
        List<Integer> list = Arrays.asList(1,2,3,4,5);
        for(Integer i: list){
            System.out.print(i);
        }
    }
} 
```

当我`compiled`使用上面的开关这个文件时，我得到了以下输出。

```
import java.util.*;

public class Temp {

    public Temp() {
        super();
    }

    private static void forEachArray() {
        int[] arr = new int[]{1, 2, 3, 4, 5};
        for (/*synthetic*/ int[] arr$ = arr, len$ = arr$.length, i$ = 0; i$ < len$; ++i$) {
            int i = arr$[i$];
            {
                System.out.print(i);
            }
        }
    }

    private static void forEachList() {
        List list = Arrays.asList(new Integer[]{Integer.valueOf(1), Integer.valueOf(2), Integer.valueOf(3), Integer.valueOf(4), Integer.valueOf(5)});
        for (/*synthetic*/ Iterator i$ = list.iterator(); i$.hasNext(); ) {
            Integer i = (Integer)i$.next();
            {
                System.out.print(i);
            }
        }
    }
} 
```

您可以看到，每个循环的其他语法糖（自动装箱）都已更改为简单循环。

* * *

## 回答 #24

> 赞同：5
> 
> 时间：2016-10-27T11:31:20.837

```
public static Boolean Add_Tag(int totalsize)
{ List<String> fullst = new ArrayList<String>();
            for(int k=0;k<totalsize;k++)
            {
              fullst.addAll();
            }
} 
```

* * *

## 回答 #25

> 赞同：4
> 
> 时间：2015-06-08T01:28:58.803

Java for-each 习惯用法只能应用于***Iterable**类型的数组或对象。这个成语是***隐含***的，因为它真正由迭代器支持。Iterator 由程序员编写，通常使用整数索引或节点（取决于数据结构）来跟踪其位置。在纸面上，它比常规的 for 循环慢，至少对于像数组和列表这样的“线性”结构来说是这样，但它提供了更大的抽象。

* * *

## 回答 #26

> 赞同：2
> 
> 时间：2018-01-29T08:38:51.093

这看起来很疯狂，但它有效

```
List<String> someList = new ArrayList<>(); //has content
someList.forEach(System.out::println); 
```

这行得通。***魔法***

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2021-01-26T18:09:05.793

我认为这会起作用：

```
for (Iterator<String> i = someList.iterator(); i.hasNext(); ) {
   String x = i.next();
   System.out.println(x);
} 
```

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2021-03-26T10:29:29.117

该准则将是：

```
import java.util.ArrayList;
import java.util.List;

public class ForLoopDemo {

  public static void main(String[] args) {

    List<String> someList = new ArrayList<String>();

    someList.add("monkey");
    someList.add("donkey");
    someList.add("skeleton key");

    //Iteration using For Each loop
    System.out.println("Iteration using For Each loop:");
    for (String item : someList) {
      System.out.println(item);
    }

    //Iteration using normal For loop
    System.out.println("\nIteration using normal For loop:");
    for (int index = 0; index < someList.size(); index++) {
      System.out.println(someList.get(index));
    }
  }
} 
```

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2022-02-20T13:42:27.950

对于每个：

```
 int[] numbers = {1,2,3,4,5};

Arrays.stream(numbers).forEach(System.out::println); 
```

回复：

```
1
2
3
4
5

Process finished with exit code 0 
```

ps：你需要一个数组（int[] numbers），然后导入java.util.Arrays；

# sql - 版本控制 T-SQL 的最佳方法？

> ID：85195
> 
> 赞同：13
> 
> 时间：2008-09-17T16:45:26.820
> 
> 标签：sql, version-control

> **可能重复：**
> [源代码控制中的存储过程/数据库模式](https://stackoverflow.com/questions/77172/stored-procedures-db-schema-in-source-control)

对我的表、视图、存储过程等进行版本控制的最佳方式是什么？最好是自动化的或至少半自动化的:)

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-17T16:49:51.677

我昨天问了这个，得到了一些很好的回答：

[源代码控制中的存储过程/数据库模式](https://stackoverflow.com/questions/77172/stored-proceduresdb-schema-in-source-control)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-17T17:57:21.937

K Scott Allen 的文章说明了一切： http: [//odetocode.com/Blogs/scott/archive/2008/01/31/11710.aspx](http://odetocode.com/Blogs/scott/archive/2008/01/31/11710.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T16:49:39.040

为所有数据库更改编写迁移脚本并将它们保存在存储库中。强制执行仅通过运行脚本对数据库进行所有更改的策略；这样就可以记录所做的事情，以及恢复它的方法。调查是否有可用于您最喜欢的语言/数据库组合的迁移框架。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T16:51:21.300

我使用 Visual Studio 2008 Pro 创建数据库项目（其他项目类型 -> 数据库）。我们已经将 SVN 用作代码存储库，因此具有一堆代表存储过程的 .sql 文件的项目只是放入存储库中的另一件事 - 您可以查看差异/历史记录等。这与 VSS 或任何其他文件相同您使用的存储库。

数据库项目的好处是您的项目会记住您的连接字符串，您所要做的就是右键单击 .sql 文件（或一次选择所有文件！）并选择运行以在数据库中更新它。这使得从存储库更新您的 .sql 文件并运行它们以更新所有存储过程变得容易，验证您的数据库在几秒钟内更新。

您还可以选择创建一个 LINQ 项目（Visual C# -> 数据库）并将所有 LINQ 代码存储在您的存储库中。

希望有帮助！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T18:09:14.543

如果您超级懒惰，您可以使用 SMO（SQL Server 管理对象），或者如果使用 2005 年之前的 SQL Server，则使用 DMO（分布式管理对象）每天编写所有表/视图/存储过程的脚本，然后将脚本与脚本进行比较在源代码控制中，如果有任何更改，请检查新版本。您不一定能够拥有漂亮的脚本，就好像您刚刚在脚本中创建了所有数据库更改一样，但至少您可以重新创建所有表/存储程序/意见。例如，在我的表格创建脚本中，经常有注释。

这是一篇让您开始编写脚本的文章：[http](http://www.sqlteam.com/article/scripting-database-objects-using-smo-updated) ://www.sqlteam.com/article/scripting-database-objects-using-smo-updated 。

再说一次，这主要是因为你懒得去管版本控制，如果你在一天内改变了两次，那也无济于事。此外，仍然必须保存并签入任何数据迁移脚本，因为这不会获取临时 SQL，只会获取数据库对象。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-30T15:32:32.157

我正在使用 Visual Studio Database 版本，它可以将架构从 SQL Server 导出到 Visual Studio 项目中。然后将其存储在源代码管理中，并且可以在任何需要的地方进行部署。VS 数据库项目只是一堆脚本，它是一种笨拙的工作方式。

一种更强大的方法是使用数据库迁移框架，如果您正在使用 .Net，请查看此博客文章以获得良好的描述[http://flux88.com/NETDatabaseMigrationToolRoundup.aspx](http://flux88.com/NETDatabaseMigrationToolRoundup.aspx)。

## 更新

如评论中所述，此页面已不复存在。所以这是来自 Wayback 机器的最后一个已知快照[http://web.archive.org/web/20080828232742/http://flux88.com/NETDatabaseMigrationToolRoundup.aspx](http://web.archive.org/web/20080828232742/http://flux88.com/NETDatabaseMigrationToolRoundup.aspx)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-04-14T15:05:45.737

试试[Randolph](http://nobhillsoft.com/Randolph.aspx)，我知道的最好的 SQL 版本控制工具之一。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-08-11T09:27:44.983

我编写了一个 DDL 触发器，它记录对 SQL 对象（触发器、表、SP、视图等）定义所做的所有更改。我可以很好地从触发器中调用扩展 SP 并将详细信息存储在另一个数据库中并将其用作存储库。但是，如果您的团队真的很有纪律，那么任何源代码控制都应该可以解决问题。触发器用作审计机制，非常适合地理位置分散的团队。

# .net - 链接 .Net 程序集

> ID：85222
> 
> 赞同：5
> 
> 时间：2008-09-17T16:48:19.153
> 
> 标签：.net, visual-studio, assemblies, linker, al.exe

这都是假设的，所以请多多包涵。

假设我正在用 C# 编写一个名为 Foo 的工具。输出是 foo.exe。我发现了一些我喜欢使用的非常棒的库，叫做 Bar，我可以在我的项目中将其作为 bar.dll 引用。当我构建我的项目时，我的输出目录中有 foo.exe 和 bar.dll。目前很好。

我想做的是链接 foo.exe 和 bar.dll，所以它们是一个程序集 foo.exe。我希望能够在 VS2008 中做到这一点，但如果我不得不求助于像 al.exe 这样的命令行工具，我并不介意。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-17T16:50:21.910

有ILMerge。[关联](http://research.microsoft.com/~mbarnett/ILMerge.aspx)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-17T17:00:26.707

在项目属性下设置构建后事件：

ilmerge /out:$(TargetDir)foo.exe $(TargetPath) $(TargetDir)bar.dll

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-17T16:52:49.580

查看[此处](http://research.microsoft.com/~mbarnett/ILMerge.aspx)的 ILMerge 工具。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T18:09:37.257

感谢所有回答的人！

我最终得到了[NuGenUnify](http://www.genetibase.com/cforce/nugenunify.php)，它为 ilmerge 提供了一个 GUI 包装器。

# parsing - 如何从字符串中手动解析浮点数

> ID：85223
> 
> 赞同：35
> 
> 时间：2008-09-17T16:48:24.287
> 
> 标签：parsing, floating-point, precision

当然大多数语言都有这方面的库函数，但假设我想自己做。

假设像在 C 或 Java 程序中一样给出浮点数（'f' 或 'd' 后缀除外），例如“ `4.2e1`”、“ `.42e2`”或简单的“ `42`”。一般来说，我们有小数点前的“整数部分”、小数点后的“小数部分”和“指数”。这三个都是整数。

**查找和处理单个数字很容易，但是如何将它们组合成类型值`float`或`double`不丢失精度？**

我正在考虑将整数部分乘以 10^ *n*，其中*n*是小数部分中的位数，然后将小数部分添加到整数部分并从指数中减去*n 。*例如，这实际上变成`4.2e1`了`42e0`。然后我可以使用该`pow`函数计算 10^*指数*并将结果与​​新的整数部分相乘。问题是，这种方法是否能保证整个过程的最大精度？

对此有什么想法吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-09-17T17:17:32.110

所有其他答案都忽略了正确执行此操作的**难度。**您可以在此采用第一种方法，这在一定程度上是准确的，但在您考虑 IEEE 舍入模式（等）之前，您永远不会得到*正确*的答案。我之前写过一些幼稚的实现，但有相当多的错误。

如果您不害怕数学，我强烈建议您阅读 David Goldberg 的以下文章，[每位计算机科学家都应该了解浮点运算](http://docs.sun.com/source/806-3568/ncg_goldberg.html)。您将更好地了解幕后发生的事情，以及这些位为何如此布局。

我最好的建议是从一个有效的 atoi 实施开始，然后从那里搬出去。您会很快发现自己遗漏了一些东西，但只要看看[strtod](http://www.google.com/codesearch?hl=en&q=show:qyAX3b_YIHU:-X-DUWQksEI:cVQ5cOMoWI4&sa=N&ct=rd&cs_p=http%3A//ftp.gnu.org/gnu/glibc/glibc-2.2.2.tar.gz&cs_f=glibc-2.2.2/stdlib/strtod.c)的源代码，您就会走上正确的道路（这是一条漫长而漫长的道路）。最终你会称赞*insertdiety 这里*有标准库。

```
/* use this to start your atof implementation */

/* atoi - christopher.watford@gmail.com */
/* PUBLIC DOMAIN */
long atoi(const char *value) {
  unsigned long ival = 0, c, n = 1, i = 0, oval;
  for( ; c = value[i]; ++i) /* chomp leading spaces */
    if(!isspace(c)) break;
  if(c == '-' || c == '+') { /* chomp sign */
    n = (c != '-' ? n : -1);
    i++;
  }
  while(c = value[i++]) { /* parse number */
    if(!isdigit(c)) return 0;
    ival = (ival * 10) + (c - '0'); /* mult/accum */
    if((n > 0 && ival > LONG_MAX)
    || (n < 0 && ival > (LONG_MAX + 1UL))) {
      /* report overflow/underflow */
      errno = ERANGE;
      return (n > 0 ? LONG_MAX : LONG_MIN);
    }
  }
  return (n>0 ? (long)ival : -(long)ival);
} 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2008-09-29T22:21:21.510

将十进制数转换为最佳浮点近似值的“标准”算法是 William Clinger 的[如何准确读取浮点数](http://doi.acm.org/10.1145/93542.93557)，可从[此处](ftp://ftp.ccs.neu.edu/pub/people/will/howtoread.ps)下载。请注意，正确执行此操作需要多精度整数，至少在一定百分比的时间内，才能处理极端情况。

[在 Burger 和 Dybvig 的“快速准确地打印浮点数”](http://doi.acm.org/10.1145/231379.231397)中可以找到另一种方法，即从浮点数中打印最佳十进制数，可[在此处](http://www.cs.indiana.edu/~dyb/pubs/FP-Printing-PLDI96.pdf)下载。这也需要多精度整数运算

另请参阅 David M Gay 的[正确舍入二进制-十进制和十进制-二进制转换](http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.44.601)，了解双向算法。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-09-17T17:05:11.780

我会使用它的二进制表示直接组装浮点数。

一个接一个地读入第一个字符，首先找到所有数字。在整数算术中做到这一点。还要跟踪小数点和指数。这个稍后会很重要。

现在你可以组装你的浮点数了。首先要做的是扫描数字的整数表示以查找第一个设置的一位（从最高到最低）。

第一个位之后的位是尾数。

获得指数也不难。您可以从科学记数法中知道第一位的位置、小数点的位置和可选的指数。结合它们并添加浮点指数偏差（我认为是 127，但请查看一些参考资料）。

这个指数应该在 0 到 255 的范围内。如果它更大或更小，你有一个正或负的无限数（特殊情况）。

将指数存储到浮点数的 24 到 30 位。

最重要的位只是符号。一表示负，零表示正。

它比实际更难描述，尝试分解一个浮点数并查看指数和尾数，你会发现它真的很容易。

顺便说一句 - 在浮点本身中进行算术是一个坏主意，因为你总是会强制你的尾数被截断为 23 个有效位。这样你不会得到准确的表示。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-17T17:05:47.380

解析时可以忽略小数点（位置除外）。假设输入是：156.7834e10... 这可以很容易地解析为整数 1567834，后跟 e10，然后您可以将其修改为 e6，因为小数是浮点数“数字”部分末尾的 4 位数字.

精度是个问题。您需要检查您使用的语言的 IEEE 规范。如果尾数（或分数）中的位数大于 Integer 类型中的位数，那么当有人键入以下数字时，您可能会丢失精度：

5123.123123e0 - 在我们的方法中转换为 5123123123，它不适合整数，但 5.123123123 的位可能适合浮点规范的尾数。

当然，您可以使用一种方法，将每个数字放在小数点前，将当前总数（以浮点数）乘以 10，然后添加新数字。对于小数点后的数字，在添加到当前总数之前，将该数字乘以 10 的增长幂。但是，此方法似乎引出了您为什么要这样做的问题，因为它需要使用浮点原语而不使用现成的解析库。

无论如何，祝你好运！

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-07-28T23:58:42.467

**是的，****只要**这些操作是**EXACT** ，您就可以将构造分解为浮点操作，并且您可以负担一个**最终的不​​精确**操作。

不幸的是，浮点运算**很快就会**变得不精确，当你超过尾数的精度时，结果会被四舍五入。一旦引入了舍入“错误”，它将在进一步的操作中累积......
所以，一般来说，**不**，你不能使用这种幼稚的算法来转换任意小数，这可能会导致不正确的舍入数字，相差几个正确的 ulp，就像其他人已经告诉你的那样。

**但让我们看看我们能走多远：**

如果您像这样仔细重建浮点数：

```
if(biasedExponent >= 0)
    return integerMantissa * (10^biasedExponent);
else
    return integerMantissa / (10^(-biasedExponent)); 
```

在累积整数尾数（如果它有很多位）以及将 10 提高到biasedExponent 的幂时，都存在超过精度的风险......

幸运的是，如果前两个运算是精确的，那么您可以承受最终的不精确运算 * 或 /，这要归功于 IEEE 属性，结果将被正确舍入。

让我们将其应用于精度为 24 位的单精度浮点数。

```
10^8 > 2^24 > 10^7 
```

注意 2 的倍数只会增加指数而尾数保持不变，我们只需要处理 5 的幂即可获得 10 的幂：

```
5^11 > 2^24 > 5^10 
```

不过，您可以在 integerMantissa 中提供 7 位精度和 -10 到 10 之间的 biasedExponent。

双精度，53 位，

```
10^16 > 2^53 > 10^15
5^23 > 2^53 > 5^22 
```

所以你可以负担得起 15 个十进制数字，以及 -22 和 22 之间的有偏指数。

看你的数字是否总是在正确的范围内由你决定......（如果你真的很棘手，你可以通过插入/删除尾随零来安排尾数和指数的平衡）。

否则，您将不得不使用一些扩展精度。
如果您的语言提供任意精度整数，那么要正确处理它有点棘手，但并不难，我在 Smalltalk 中做了这个，并在[http://smallissimo.blogspot.fr/2011/09/clarifying-and -optimizing.html](http://smallissimo.blogspot.fr/2011/09/clarifying-and-optimizing.html)和[http://smallissimo.blogspot.fr/2011/09/reviewing-fraction-asfloat.html](http://smallissimo.blogspot.fr/2011/09/reviewing-fraction-asfloat.html)

请注意，这些都是简单而幼稚的实现。幸运的是，libc 更加优化。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-28T22:38:30.050

我的第一个想法是仅使用尾数的前 18 位将字符串解析为`int64`尾数和`int`十进制指数。例如，1.2345e-5 将被解析为 12345 和 -9。然后我会继续将尾数乘以 10 并递减指数，直到尾数长 18 位（>56 位精度）。然后我会在表格中查找十进制指数以找到一个因子和二进制指数，可用于将数字从十进制 n*10^m 转换为二进制 p*2^q 形式。这个因素是另一个因素，`int64`所以我将尾数乘以它，这样我就得到了结果 128 位数字的前 64 位。该`int64`尾数可以转换为仅损失必要精度的浮点数，并且可以使用乘法应用 2^q 指数而不会损失精度。

我希望这是非常准确且非常快速的，但您可能还想处理特殊数字 NaN、-infinity、-0.0 和无穷大。我没有考虑过非规范化数字或舍入模式。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-17T17:00:03.057

为此，您必须了解标准 IEEE 754 才能获得正确的二进制表示。之后，您可以使用**Float.intBitsToFloat**或**Double.longBitsToDouble**。

[http://en.wikipedia.org/wiki/IEEE_754](http://en.wikipedia.org/wiki/IEEE_754)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-17T17:03:25.920

如果您想要最精确的结果，您应该使用更高的内部工作精度，然后将结果下转换为所需的精度。如果您不介意一些 ULP 错误，那么您可以根据需要以所需的精度重复乘以 10。我会避免使用 pow() 函数，因为它会为大指数产生不精确的结果。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-17T17:09:57.790

在不损失精度的情况下，不可能将任何表示数字的任意字符串转换为双精度或浮点数。有许多小数可以精确地用十进制表示（例如“0.1”），只能用二进制浮点数或双精度数来近似。这类似于分数 1/3 不能用十进制精确表示，你只能写 0.333333...

如果您不想直接使用库函数，为什么不查看这些库函数的源代码呢？你提到了Java；大多数 JDK 附带类库的源代码，因此您可以查看 java.lang.Double.parseDouble(String) 方法的工作原理。当然，像 BigDecimal 这样的东西更适合控制精度和舍入模式，但你说它需要是浮点数或双精度数。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2008-09-17T16:51:20.423

使用状态机。这很容易做到，即使数据流被中断也可以工作（您只需要保留状态和部分结果）。您还可以使用解析器生成器（如果您正在做更复杂的事情）。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2009-08-07T23:28:05.420

我同意终点站。状态机是完成这项任务的最佳方式，因为有许多愚蠢的方式可以破坏解析器。我现在正在研究一个，我认为它已经完成了，我认为它有 13 个州。

问题不是微不足道的。

我是一名对设计浮点硬件感兴趣的硬件工程师。我正在进行第二次实施。

我今天发现了这个[http://speleotrove.com/decimal/decarith.pdf](http://speleotrove.com/decimal/decarith.pdf)

第 18 页给出了一些有趣的测试用例。

是的，我读过 Clinger 的文章，但作为一个头脑简单的硬件工程师，我无法理解所提供的代码。Knuth 的文章中提到的 Steele 算法对我很有帮助。输入和输出都有问题。

上述对各种文章的所有引用都非常出色。

我还没有在这里注册，但是当我这样做时，假设没有登录，那就是兄弟。（兄弟点）。

克莱德

# c - 哪种语言可用于为有效的 C 程序创建报告

> ID：85230
> 
> 赞同：2
> 
> 时间：2008-09-17T16:48:59.433
> 
> 标签：c, report, parsing

任何人都可以向我推荐一种有用的编程语言，它可以用来创建一个工具来分析给定的 C 程序并生成包含给定程序信息（函数列表、变量列表等）的 txt 报告或 html 报告。我打算构建的程序类似于 doxygen，但我希望它供我个人使用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-17T16:52:42.887

[ctags](http://ctags.sourceforge.net/)，也许？

> Ctags 生成在源文件中找到的语言对象的索引（或标记）文件，允许文本编辑器或其他实用程序快速轻松地找到这些项目。标记表示可以使用索引条目的语言对象（或者，为该对象创建的索引条目）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-17T16:57:59.863

Python 和 Perl 都具有出色的字符串处理能力。

我建议使用 ctags 之类的东西来解析程序，然后创建一个脚本来读取 ctags 文件并在 txt/html 中输出。

ctags 使用的文件格式是明确定义的，以便其他程序可以读取它。有关ctags 本身及其使用的文件的更多信息，请参阅[http://ctags.sourceforge.net 。](http://ctags.sourceforge.net)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-17T16:55:56.170

您正在打开一大罐蠕虫，这不是有效利用您的时间，等等等等。

继续回答，如果您谈论的内容超出了琐碎的分析并且需要准确性，则需要解析 C 源代码。你可以用任何语言做到这一点，但你几乎肯定会想要从高级语法生成你的解析器。有很多工具可以做到这一点。一个现代且特别强大的解析器生成器是[ANTLR](http://www.antlr.org/ "ANTLR")；C 有许多 ANTLR 语法，包括更易于使用的子集。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T16:52:41.810

研究脚本语言。我会推荐 Python 或 Perl。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-17T16:55:21.727

Haskell 有一个相对较新的语言-c 项目[http://www.sivity.net/projects/language.c](http://www.sivity.net/projects/language.c)，它允许分析 C 代码。

如果您熟悉 Haskell，那么它可能值得一看。即使您不是，尝试一下也可能很有趣。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T16:54:58.933

如果它是您想要的编程语言，那么我会说一些以字符串处理能力而闻名的东西，所以这意味着 perl。

但是，您需要的任务可能相当复杂，因为您需要“了解”该语言，因此您需要遵循编译器所做的相同步骤，对语言进行词法和语法分析（想想 flex，想想 yacc），以便真正“知道”这些字符串的含义。

也许最好的起点是看一下 doxygen 并尝试尽可能多地重用那里完成的工作

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-17T16:56:35.403

Lex/yacc 适用于构建解析器。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-12-11T07:36:37.607

[pycparser](http://code.google.com/p/pycparser/)是一个用纯 Python 编写的完整的 ANSI C89/C90 解析器。它被广泛用于分析 C 源代码以满足各种需求。它带有一些示例代码，例如列出文件中的所有函数定义等。

# jconsole - JConsole 配置

> ID：85254
> 
> 赞同：1
> 
> 时间：2008-09-17T16:51:14.887
> 
> 标签：jconsole

在 JBoss'`run.bat`中，添加：

```
set JAVA_OPTS=%JAVA_OPTS% -Dcom.sun.management.jmxremote - 
Dcom.sun.management.jmxremote.port=9987 - 
Dcom.sun.management.jmxremote.ssl=false - 
Dcom.sun.management.jmxremote.authenticate=false 
```

要启动 jconsole：

```
JDK/bin>jconsole localhost:9987 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-17T16:54:19.700

是的，这应该有效。如果没有，则使用“ps”（或您平台的等效项）来检查这些参数是否在 JVM 的命令行中生成。

是这个问题吗？

# design-patterns - 你怎么知道什么时候使用设计模式？

> ID：85272
> 
> 赞同：67
> 
> 时间：2008-09-17T16:53:05.070
> 
> 标签：design-patterns, oop

任何人都可以阅读 GoF 书籍来了解什么是设计模式以及如何使用它们，但是确定设计模式何时解决问题的过程是什么？模式知识是否推动了设计，或者有没有办法弄清楚如何使用模式来改变设计？

换句话说，模式有模式吗？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2008-09-17T16:53:59.153

我强烈推荐阅读O'Reilly 的[Head First Design Patterns](https://i.stack.imgur.com/FipsJ.jpg)。这解释了如何在现实世界中使用这些模式。

![头部优先设计模式](https://i.stack.imgur.com/FipsJ.jpg)

我还要补充一点，不要在设计时考虑太多模式。此外，寻找模式可能有助于解决的“代码异味”。

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2008-09-17T16:57:54.713

设计模式应该提供一种可以解决问题的结构*。*在解决实际问题时，您必须考虑对该问题的解决方案的*许多*微小变化，以查看是否符合设计模式。特别是，您可能需要概括您的问题或其解决方案，以使设计模式适合。

答案是，这是一门艺术。 *了解*设计模式无疑是重要的一步。习惯这种事情的一种方法是研究设计模式的*应用*，而不仅仅是模式。随着时间的推移，了解一种模式的许多不同应用程序可以帮助您更好地将任务映射到模式上。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2010-02-27T08:08:47.500

大多数人不理解的模式背后有一个核心概念。不要将它们视为数据结构或算法。

相反，请将您的代码视为人们相互发送消息，例如传递笔记​​或发送信件。每个对象都是一个“人”。

您组织“人员”的方式以及他们用来相互发送消息的模式就是模式。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2008-11-11T02:19:40.050

把问题翻过来：你应该制作的模式是“什么模式适合我的问题”。考虑一个非常简单的模式，在数组中查找元素。在 C 中，它类似于

```
TYPE_t ary[SIZE] = // ... gets initialized somehow
size_t ix ;        // Your index variable

for(ix=0; ix < SIZE; ix++){
    if (ary[ix] == item) {
       return ix ;
    }
} 
```

您不会查看代码并思考“我可以在哪里使用它”，而是查看问题并说“我知道如何在数组中查找元素吗？”

使用更广泛的模式确实以相同的方式工作。您需要拥有许多不经常更改的数据结构的副本 --- 这让您认为是“享元”。你想要一些存在于网络边界两侧的东西，你认为是代理。

当你研究模式，尤其是 GoF 时，问问自己“什么情况下需要这种模式？我以前见过这种模式吗？我在以前的工作中可以用它做什么？在我自己的生活中哪里可以找到这样的例子？ "

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-10-29T19:23:58.837

设计模式？你沉浸在它们之中！

设计模式没有什么特别之处，它们只是设计模式。所有的开发都使用设计模式。面向对象编程中有一组设计模式被普遍认为是可取的，并已成为规范的设计模式。但也有许多不受欢迎或无关紧要的设计模式（例如[设计反模式](http://en.wikipedia.org/wiki/Anti-pattern#Software_design_anti-patterns)）以及未发现和/或未记录的模式。

编程时无法避免使用模式。但是您可以更加了解您正在使用的模式，以及某些模式何时有用，何时无用。[学习GoF 书中](https://rads.stackoverflow.com/amzn/click/com/0201633612)的规范设计模式会有所帮助，学习[代码异味和重构](https://rads.stackoverflow.com/amzn/click/com/0201485672)也会有所帮助。对于何时应该使用特定设计或设计模式，没有一个正确的答案，您需要积累使用和实施它们的经验，以便知道何时何地使用哪种模式。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-09-17T16:55:20.337

经验。了解它们的使用模式和实际示例。每次你要做出设计决定时，想想你知道的模式是否适用于它。随着时间的推移，你会变得更好，你会发现将模式应用于更广泛的问题的新方法。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2008-09-17T16:55:35.360

我发现的另一本好书是：

重构为模式

通过展示何时、何地以及如何将现有代码更改为模式，它让我更好地理解了这些概念，并能够确定它们可以在哪里使用。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-09-17T16:56:11.460

您是如何学会何时使用 if 语句的？

我把它比作是因为它是一个更大的结构，你需要了解它的来龙去脉，然后才能有效地使用它。if 语句解决了一类需要分支的问题。桥接模式解决了一类问题。我真的没有任何不同的看法。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2008-09-17T17:20:34.567

如果您知道这些模式，那么它们就会成为您工具箱中的工具。当您查看一项任务时，您可以从您的工具中进行选择。此时，您应该非常清楚哪种工具最适合给定问题。这是公式停止工作的地方，您实际上是在做工程工作。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2012-10-02T05:24:58.690

Rian van der Merwe 在 2012 年 6 月为 Smashing Magazine 写了一篇关于此的[优秀文章](http://uxdesign.smashingmagazine.com/2012/06/06/design-patterns-when-breaking-rules-ok/)。这里有一些要点。

设计模式之所以有用有两个原因：

1.  模式可以节省时间，因为我们不必解决已经解决的问题。
2.  模式使 Web 更易于使用，因为随着设计师采用的增加，用户习惯了事物的工作方式，这反过来又减少了他们在遇到常见设计元素时的认知负担。

van der Merwe 建议我们在以下情况下考虑打破模式：

1.  新方法凭经验提高可用性，或
2.  既定的方式变得过时了。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2011-05-08T06:47:57.590

与软件工程中的许多实践一样，设计模式的概念取自结构工程。如果您考虑构建一个结构，则需要就如何构建该结构以实现设定的目标做出决定。在做出这些决定时，您将有一组工作要求。它可能很简单，例如桥梁必须能够一次支撑 X 吨，或者具有特定的抗拉强度以允许在风中进行足够的运动等。建筑师将使用其他构建的先验知识来做出这些设计选择。他/她不太可能尝试从头开始解决问题。

软件工程和设计模式完全相同。它们只是常见问题的常见解决方案。如果您知道设计模式，那么当您完成设计时，系统的特定部分需要符合您拥有的设计模式的东西，然后使用它。不要试图让系统适应设计模式，让设计模式适应你的系统（它们适合的地方）。试着将它们视为一组解决方案，以减少您需要做的设计工作量，并小心过度设计您的解决方案以尽可能多地填充设计模式。这只会使您的解决方案无法维护并且可能非常有问题。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-09-17T17:30:59.363

我同意仅仅学习模式是不够的。大多数书籍的问题在于它们没有提供真实世界的例子。我听说 Head First Design Patterns，正如前面一些人所建议的那样，是一个很好的模式。

另一件事是，大多数书籍故意**不是特定语言的**，这对您来说可能是好事也可能是坏事。总体上理解一个模式**无论多么重要，知道如何很好地实现它也同样重要**。我遇到过一本名为[C# 3.0 Design Patterns](http://oreilly.com/catalog/9780596527730/)的书，它在这两个不可分割的方面投入了几乎相同的墨水。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-09-17T17:42:10.600

当我第一次遇到设计模式时，我也有同样的问题。我很欣赏这些概念，但不知道何时或如何应用它们。我最初的方法是在设计阶段寻找适用性。一旦你有一个框图和每个块的半明确职责，承担职责并用一本像样的参考书交叉引用它们并不难。这里提到了几个不错的，但 GoF 应该在您的列表中。下一步是根据您在模式中看到的内容来寻找设计改进。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2017-10-09T20:10:27.047

设计模式是关于如何解决***常见问题的******通用描述***。有2点我们需要注意：

 *首先，它是一个***通用描述***；它不是具体的解决方案，也不是完整的配方，它只是描述解决方案的外观，以解决常见问题。

其次，问题是问题是一个***常见问题：***，这意味着这个问题以前已经遇到过很多次，并且随着时间的推移，人们对如何将理想的解决方案应用于这个经常重复的问题进行了描述。

因此，如果您遇到一个不常见的新问题，请尽量不要使用设计模式来解决它，或者至少不要将设计模式作为解决您面临的任何类型问题的工具。

# geometry - 鉴于其点集及其 Delaunay 三角剖分，我如何推导出 Voronoi 图？

> ID：85275
> 
> 赞同：30
> 
> 时间：2008-09-17T16:53:40.637
> 
> 标签：geometry, computational-geometry, voronoi, delaunay

我正在开发一个游戏，我创建了一张随机的省份地图（风险或外交）。为了创建该地图，我首先生成一系列半随机点，然后计算这些点的 Delaunay 三角剖分。

完成后，我现在正在寻找创建点的 Voronoi 图，作为省边界的起点。我此时的数据（不是双关语）由原始的一系列点和 Delaunay 三角形的集合组成。

我在网上看到了很多方法来做到这一点，但其中大多数都与 Delaunay 的派生方式有关。我很想找到一些不需要集成到 Delaunay，但可以仅根据数据工作的东西。如果做不到这一点，我正在寻找相对几何新手可以理解的东西，而不是最佳速度。谢谢！

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-09-17T16:59:59.000

Voronoi 图只是 Delaunay 三角剖分的对偶图。

*   因此，Voronoi 图的边缘沿着 Delaunay 三角剖分边缘的垂直平分线，因此计算这些线。
*   然后，通过查找相邻边的交点来计算 Voronoi 图的顶点。
*   最后，边是您计算的位于相应顶点之间的线的子集。

请注意，确切的代码取决于您用于这两个图表的内部表示。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-09-17T17:13:42.150

如果不考虑最佳速度，则以下伪代码将生成 Voronoi 图：

```
for yloop = 0 to height-1
  for xloop = 0 to width-1

    // Generate maximal value
    closest_distance = width * height

    for point = 0 to number_of_points-1
      // calls function to calc distance
      point_distance = distance(point, xloop, yloop)

      if point_distance < closest_distance
        closest_point = point
      end if
    next

  // place result in array of point types
  points[xloop, yloop] = point

  next
next 
```

假设您有一个“点”类或结构，如果您为它们分配随机颜色，那么您将在显示输出时看到熟悉的 voronoi 模式。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-02T14:58:15.200

在尝试使用该线程作为我自己类似问题的答案的来源之后，我发现 Fortune 的算法——可能是因为它是最流行的并且因此记录最多的——是最容易理解的。

[关于 Fortune 算法的 Wikipedia 文章](https://en.wikipedia.org/wiki/Fortune%27s_algorithm)保留了指向 C、C# 和 Javascript 源代码的新链接。他们都是一流的，并带有漂亮的例子。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T17:14:04.707

每个 Delaunay 三角形都包含 Voronoi 图的一个点。

您可以通过找到每个三角形的三个[垂直平分线](http://www.mathopenref.com/bisectorperpendicular.html)的交点来计算该点。

您的 Voronoi 图将连接这组点，每个点都有最近的三个邻居。（每个邻居共享 Delaunay 三角形的一条边）

你打算如何处理边缘情况？

# macos - 如何在 Terminal.app 中启用超过 8 位颜色？

> ID：85277
> 
> 赞同：1
> 
> 时间：2008-09-17T16:53:43.757
> 
> 标签：macos

在 Vim 和 Emacs 终端应用程序中，配色方案看起来很糟糕。如何使颜色与 GUI 版本一样鲜艳（或超过 8 种颜色）？

我应该放弃，转而使用他们各自的 GUI 应用程序吗？如果是这样，哪个？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-17T17:07:54.580

终端中不能有**更多**颜色，因为只有 8 种颜色的 ANSI 代码（如果计算粗体/浅色，则为 16 种）。如果要自定义颜色，可以使用[http://ciaranwal.sh/2007/11/01/customising-colours-in-leopard-terminal中的 TerminalColours 插件](http://ciaranwal.sh/2007/11/01/customising-colours-in-leopard-terminal)

就个人而言，我更喜欢在我的 Mac 上使用所谓的 Carbon Emacs。有几个版本可用；谷歌是你的朋友。我从[http://www.porkrind.org/emacs/得到我的](http://www.porkrind.org/emacs/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T17:08:14.113

您可能会因为您在兼容 VT100/WhateverItsCalled 的终端中运行而受到限制，它只是没有*超过*16 种前景色和 16 种背景色。如果确实如此，那么可爱的图书馆“CaCa”（ColourAsciiColourArt）会比它更令人赏心悦目。

如果你想要更多的颜色，你只需要使用更现代的技术，这通常意味着使用 X（除非你喜欢痛苦并且想要使用 directfb/framebuffer/svgalib）。

对于 vim，有 GVim ( GTK+Vim )。然而，Emacs GUI 版本让我很不高兴，但我不是 emacs 用户。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T18:22:31.203

[Aquamacs](http://aquamacs.org/)和[MacVim](http://code.google.com/p/macvim/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-26T20:20:46.863

听起来你想要[MacVim](http://code.google.com/p/macvim/)

# c# - C# 中匿名未附加块的值是什么？

> ID：85282
> 
> 赞同：10
> 
> 时间：2008-09-17T16:54:04.723
> 
> 标签：c#

在 C# 中，您可以在未附加到任何其他语句的方法内部创建一个块。

```
 public void TestMethod()
    {
        {
            string x = "test";
            string y = x;

            {
                int z = 42;
                int zz = z;
            }
        }
    } 
```

这段代码编译并运行，就好像 main 方法中的大括号不存在一样。还要注意块内的块。

有没有一种有价值的情况？我还没有找到任何东西，但很想知道其他人的发现。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-17T16:56:48.400

范围和垃圾收集：当您离开未附加的块时，其中声明的任何变量都会超出范围。这让垃圾收集器可以清理这些对象。

[Ray Hayes](https://stackoverflow.com/users/7093/ray-hayes)指出 .NET 垃圾收集器不会立即收集超出范围的对象，因此作用域是主要的好处。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-17T18:45:08.590

一个例子是如果你想重用一个变量名，通常你不能重用变量名这是无效的

```
 int a = 10;
        Console.WriteLine(a);

        int a = 20;
        Console.WriteLine(a); 
```

但这是：

```
 {
        int a = 10;
        Console.WriteLine(a);
    }
    {
        int a = 20;
        Console.WriteLine(a);
    } 
```

我现在唯一能想到的，比如如果你在处理一个大对象，你从中提取了一些信息，然后你要执行一堆操作，你可以把大对象处理在一个块中，使其超出范围，然后继续其他操作

```
 {
        //Process a large object and extract some data
    }
    //large object is out of scope here and will be garbage collected, 
    //you can now perform other operations with the extracted data that can take a long time, 
    //without holding the large object in memory

    //do processing with extracted data 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-17T16:57:16.260

这是解析器规则的副产品，即语句是简单语句或块。即可以在单个语句可以使用的任何地方使用块。

例如

```
if (someCondition)
 SimpleStatement();

if (SomeCondition)
{
   BlockOfStatements();
} 
```

其他人指出，变量声明在包含块结束之前都在范围内。临时变量的范围很短是件好事，但我从来不需要单独使用块来限制变量的范围。有时您会为此使用“使用”语句下方的块。

所以一般来说不值钱。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T16:56:16.293

据我所知，它只从组织的角度有用。我真的无法想象这样做有什么合乎逻辑的价值。也许有人会有一个合适的例子。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-17T18:53:08.150

这允许您在任何地方创建范围块。它本身并没有那么有用，但可以使逻辑更简单：

```
switch( value )
{
    case const1: 
        int i = GetValueSomeHow();
        //do something
        return i.ToString();

    case const2:
        int i = GetADifferentValue();
        //this will throw an exception - i is already declared
 ... 
```

在 C# 中，我们可以使用范围块，以便在每种情况下声明的项目仅在这种情况下处于范围内：

```
switch( value )
{
    case const1: 
    {
        int i = GetValueSomeHow();
        //do something
        return i.ToString();
    }

    case const2:
    {
        int i = GetADifferentValue();
        //no exception now
        return SomeFunctionOfInt( i );
    }
 ... 
```

这也适用于 goto 和标签，而不是您经常在 C# 中使用它们。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-12-13T16:32:26.587

它存在的一个实际原因是，如果您想限制某个变量的范围，而无需为该块引入任何其他原因。在实际实践中，这几乎没有用处。

就我个人而言，我的猜测是，从语言/编译器的角度来看，更容易说你可以在任何需要声明的地方放置一个块，而且他们根本没有竭尽全力阻止你在没有 if 的情况下使用它/for/方法声明/等

考虑一下Eric Lippert[最近发布的这篇博客文章](http://ericlippert.com/2012/12/04/why-are-braces-required/)的开头。一个`if`语句后面不是单个语句或用花括号括起来的多个语句，它只是跟在单个语句之后。任何时候将 0 到 N 语句括在花括号中，您就可以使该部分代码等效（从语言解析器的角度来看）一个语句。同样的做法也适用于所有循环结构，尽管正如博文的主要观点所解释的那样，它不适用于 try/catch/finally 块。

当从这个角度处理块时，问题就变成了，“是否有令人信服的理由阻止在任何可以使用单个语句的地方使用块？” 答案是“不”。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-17T16:57:07.493

这样做的一个原因是变量“z”和“zz”不能用于该内部块末尾以下的代码。当您在 Java 中执行此操作时，JVM 会为内部代码推送一个堆栈帧，这些值可以存在于堆栈中。当代码退出块时，堆栈帧被弹出并且这些值消失。根据所涉及的类型，这可以使您不必使用堆和/或垃圾收集。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-17T16:59:35.537

在 C# 中——如 c/c++/java——大括号表示一个范围。这决定了变量的生命周期。当到达右大括号时，该变量立即可用于垃圾回收。在 c++ 中，如果 var 表示一个实例，它将导致调用类的析构函数。

至于用法，唯一可能的用途是释放一个大对象，但tbh，将其设置为 null 将具有相同的效果。我怀疑前一种用法可能只是为了让 c++ 程序员在某种程度上在熟悉和舒适的领域转向托管代码。如果真的想在 c# 中调用“析构函数”，通常会实现 IDisposable 接口并使用“using (var) {...}”模式。

奥辛

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-17T17:00:12.417

即使出于任何原因它实际上是有用的（例如变量范围控制），从良好的旧代码可读性的角度来看，我会劝阻你不要使用这种结构。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-17T17:07:49.777

除了语义以及范围和垃圾收集之外，这没有任何价值，在这个有限的示例中，这些都不重要。如果您认为它使代码更清晰，对您自己和/或其他人来说，那么您当然可以使用它。然而，代码中更被接受的语义澄清约定通常只使用带有选项内联注释的换行符：

```
public void TestMethod()
{
    //do something with some strings
    string x = "test";
    string y = x;

    //do something else with some ints
    int z = 42;
    int zz = z;
} 
```

# c# - 如何避免实时 .NET 应用程序中的垃圾收集？

> ID：85283
> 
> 赞同：13
> 
> 时间：2008-09-17T16:54:11.387
> 
> 标签：c#, .net, garbage-collection, real-time, finance

我正在编写一个金融 C# 应用程序，它从网络接收消息，根据消息类型将它们转换为不同的对象，最后在它们上应用应用程序业务逻辑。

关键是在应用了业务逻辑之后，我很确定我再也不需要这个实例了。我不想等待垃圾收集器释放它们，而是明确地“删除”它们。

在 C# 中是否有更好的方法可以做到这一点，我应该使用对象池来重用相同的实例集还是有更好的策略。

目标是避免垃圾收集在时间关键的过程中使用任何 CPU。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-09-17T16:57:07.213

不要立即删除它们。为每个对象调用垃圾收集器是个坏主意。通常你*真的*不想和垃圾收集器混在一起，即使是时间关键的进程也只是等待发生的竞争条件，如果它们那么敏感的话。

但是，如果您知道您的应用程序将有繁忙和轻负载时段，您可以在达到轻负载时段时尝试更通用的 GC.Collect() 以鼓励在下一个繁忙时段之前进行清理。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-09-17T16:59:23.603

看这里：http: [//msdn.microsoft.com/en-us/library/bb384202.aspx](http://msdn.microsoft.com/en-us/library/bb384202.aspx)

你可以告诉垃圾收集器你现在正在做一些关键的事情，它会尽量对你好。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-09-17T17:35:14.110

你自己打——使用对象池并重用这些对象。对这些对象的调用的语义需要隐藏在工厂外观后面。您需要以某种预定义的方式扩展池。每次达到极限时，大小可能会翻倍——高水位算法或固定百分比。我真的强烈建议你不要调用 GC.Collect()。

当池上的负载变得足够低时，您可以缩小池并最终触发垃圾收集——让 CLR 担心它。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-09-17T17:30:52.873

尝试事后猜测垃圾收集器通常是一个非常糟糕的主意。在 Windows 上，垃圾收集器是[一个世代](http://en.wikipedia.org/wiki/Garbage_collection_(computer_science)#Generational_GC_.28aka_Ephemeral_GC.29)收集器，可以依靠它非常有效。这个一般规则有一些值得注意的例外 - 最常见的是发生一次性事件，您知道事实将导致大量旧对象死亡 - 一旦对象被提升到 Gen2（寿命最长）他们倾向于闲逛。

在您提到的情况下，您听起来好像正在生成许多短期对象 - 这些将导致 Gen0 集合。无论如何，这些都相对经常发生，并且是最有效的。如果您愿意，您可以通过拥有可重用的对象池来避免它们，但最好在采取此类操作之前确定 GC 是否是性能问题 - CLR 分析器是执行此操作的工具。

应该注意的是，垃圾收集器在不同的 .NET 框架上是不同的——在紧凑的框架上（在 Xbox 360 和移动平台上运行）它是一个非分代 GC，因此你必须更加小心什么你的程序产生的垃圾。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-09-17T17:02:12.350

强制 GC.Collect() 通常是一个坏主意，让 GC 去做它最擅长的事情。听起来最好的解决方案是使用一个可以在必要时增长的对象池——我已经成功地使用了这种模式。

这样，您不仅可以避免垃圾收集，还可以避免常规分配成本。

最后，您确定 GC 给您带来了问题吗？在实施任何节省性能的解决方案之前，您可能应该测量并证明这一点 - 您可能会给自己造成不必要的工作！

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-02-09T17:09:24.577

*“目标是避免垃圾收集在时间关键的过程中使用任何 CPU”*

**问：**如果时间紧迫，你的意思是你正在听一些深奥的硬件，你不能错过中断？

**答：**如果是这样，那么 C# 不是要使用的语言，您需要 Assembler、C 或 C++。

**问：**如果按时间临界，您的意思是当管道中有很多消息时，您不想让垃圾收集器减慢速度？

**答：**如果是这样，您就不必担心了。从事物的声音来看，您的对象寿命很短，这意味着垃圾收集器将非常有效地回收它们，而不会出现任何明显的性能滞后。

但是，唯一可以确定的方法是对其进行测试，将其设置为在夜间运行以处理持续不断的测试消息流，如果您的性能统计数据可以在 GC 启动时发现（即使您可以发现它，如果它真的很重要，我会更加惊讶）。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-09-17T17:10:23.967

对垃圾收集器的行为有一个很好的理解和感受，你就会明白为什么不推荐你在这里的想法。除非你真的很喜欢 CLR 花时间重新排列内存中的*对象*。

*   [http://msdn.microsoft.com/en-us/magazine/bb985010.aspx](http://msdn.microsoft.com/en-us/magazine/bb985010.aspx)
*   [http://msdn.microsoft.com/en-us/magazine/bb985011.aspx](http://msdn.microsoft.com/en-us/magazine/bb985011.aspx)

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-10-18T03:25:31.933

应用程序的密集程度如何？我编写了一个应用程序，它以 8KB 块捕获 3 个声卡（托管 DirectX，44.1KHz，立体声，16 位），并通过 TCP/IP 将 3 个流中的 2 个发送到另一台计算机。UI 为 3 个通道中的每一个呈现音频电平表和（平滑）滚动标题/艺术家。这在具有 XP、1.8GHz、512MB 等的 PC 上运行。该应用程序使用大约 5% 的 CPU。

我没有手动调用 GC 方法。但我确实不得不调整一些浪费的东西。我使用 RedGate 的 Ant profiler 来磨练浪费的部分。一个很棒的工具！

我想使用预先分配的字节数组池，但托管的 DX 程序集在内部分配字节缓冲区，然后将其返回给应用程序。事实证明我没有必要。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-09-17T17:07:23.617

如果绝对时间紧迫，那么您应该使用像 C/C++ 这样的确定性平台。即使调用 GC.Collect() 也会产生 CPU 周期。

您的问题始于您想要节省内存但摆脱对象的建议。这是一个空间关键优化。你需要决定你真正想要什么，因为 GC 比人类更擅长优化这种情况。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-09-17T21:43:02.550

从它的声音来看，您似乎在谈论 C# 中不存在的确定性终结（C++ 中的析构函数）。您会在 C# 中找到最接近的东西是 Disposable 模式。基本上你实现了**IDisposable**接口。

基本模式是这样的：

```
public class MyClass: IDisposable
{
    private bool _disposed;

    public void Dispose()
    {
        Dispose( true );
        GC.SuppressFinalize( this );
    }

    protected virtual void Dispose( bool disposing )
    {
        if( _disposed )    
            return;

        if( disposing )
        {
            // Dispose managed resources here
        }

        _disposed = true;
    }
} 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-17T17:02:00.587

您可以在池中拥有有限数量的每种类型的实例，并重用已经完成的实例。池的大小取决于您要处理的消息量。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-09-17T17:15:49.243

与其每次收到消息都创建一个对象的新实例，不如重用已经使用过的对象？这样你就不会与垃圾收集器作斗争，你的堆内存也不会碎片化。**

对于每种消息类型，您可以创建一个池来保存未使用的实例。每当您收到网络消息时，您都会查看消息类型，从适当的池中拉出等待实例并应用您的业务逻辑。之后，您将该消息对象的实例放回它的池中。

您很可能希望使用实例“延迟加载”您的池，以便您的代码轻松扩展。因此，您的池类需要检测空实例何时被拉出并在分发之前将其填满。然后，当调用代码将其放回池中时，它就是一个真实的实例。

** “对象池是一种使用模式，它允许重用对象而不是分配和释放对象，这有助于防止堆碎片以及代价高昂的 GC 压缩。”

[http://geekswithblogs.net/robp/archive/2008/08/07/speedy-c-part-2-optimizing-memory-allocations---pooling-and.aspx](http://geekswithblogs.net/robp/archive/2008/08/07/speedy-c-part-2-optimizing-memory-allocations---pooling-and.aspx)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-17T17:06:10.420

理论上，如果您的 CPU 负载过重或除非确实需要，GC 不应该运行。但是，如果必须，您可能只想将所有对象保存在内存中，也许是一个单例实例，除非您准备好，否则永远不要清理它们。这可能是保证 GC 何时运行的唯一方法。

# c# - 处理和存储经过时间

> ID：85307
> 
> 赞同：7
> 
> 时间：2008-09-17T16:56:08.573
> 
> 标签：c#, database, datetime, timespan

我在决定什么是处理和存储时间测量的最佳方法时遇到问题。

我有一个应用程序，它有一个文本框，允许用户以 hh:mm:ss 或 mm:ss 格式输入时间。

所以我计划解析这个字符串，在冒号上标记它并为我的业务逻辑创建 TimeSpan（或使用 TimeSpan.Parse() 并在 mm:ss 案例中添加一个“00:”）。好的？

我如何将其存储在数据库中？字段类型是什么？DateTime 似乎是错误的。我不希望将 00:54:12 的时间存储为 1901-01-01 00:54:12 这似乎有点差？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-17T17:01:48.043

TimeSpan 有一个您可以存储的 Int64 [Ticks](https://docs.microsoft.com/en-us/dotnet/api/system.timespan.ticks)属性，以及一个采用 Ticks 值的[构造函数。](https://docs.microsoft.com/en-us/dotnet/api/system.timespan.-ctor#System_TimeSpan__ctor_System_Int64_)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-17T16:59:47.940

我认为最简单的方法是将用户输入转换为整数秒。所以 54:12 == 3252 秒，所以将 3252 存储在您的数据库或任何地方。然后，当您需要将其显示给用户时，您可以再次将其转换回来。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-17T17:01:00.463

对于少于一天的时间，只需像其他人所说的那样使用秒。

对于更长的时间，这取决于您的数据库引擎。如果 SQL Server，在 2008 版之前，您需要一个日期时间。没关系 - 您可以忽略他们都拥有的默认 1/1/1900 日期。如果您有幸拥有 sql server 2008，那么您可以使用单独的日期和时间数据类型。使用真实日期时间/时间类型的优点是使用 DateDiff 函数来比较持续时间。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T17:01:19.573

大多数数据库都有某种时间间隔类型。答案取决于您正在谈论的数据库。对于 Oracle，它只是一个浮点数 NUMBER，表示天数（包括小数天数）。您可以在任何 DATE 类型中添加/减去它，然后您会得到正确的答案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T17:01:25.860

作为秒的整数计数（或适当的毫秒）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T17:02:11.880

您是否同时收集开始时间和停止时间？如果是这样，如果您的 DBMS 支持，您可以使用“时间戳”数据类型。如果不是，则仅作为日期/时间类型。现在，您已经说过您不希望存储日期部分 - 但考虑时间段跨越午夜的情况 - 例如，您从 23:55:01 开始并在 00:05:14 结束 - 除非你也有日期。有标准的内置函数可以返回两个日期时间值之间的经过时间（以秒为单位）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-17T17:02:27.497

用整数表示秒或分钟。秒可能更好。你永远不会因为选择过于精确的东西而自责。此外，对于您的 UI，请考虑使用多个文本输入，您不必担心用户实际输入“：”是否正确。添加其他约束也更容易，例如包含 0-59 的分钟和秒值。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-17T17:02:44.953

int 类型应该这样做，将其存储为秒并来回解析

[http://msdn.microsoft.com/en-us/library/ms187745.aspx](http://msdn.microsoft.com/en-us/library/ms187745.aspx)

# sharepoint - 在 Sharepoint Services 3.0 Wiki 中自定义搜索结果显示

> ID：85336
> 
> 赞同：1
> 
> 时间：2008-09-17T16:57:52.203
> 
> 标签：sharepoint, search, metadata, wiki

我正在考虑使用 Windows SharePoint Services 3.0 wiki 作为元数据存储库。我们基本上想要一个社区驱动的字典，出于各种原因，我们使用 Sharepoint 而不是 MediaWiki。

**我可以做些什么来自定义或完全替换 searchresults.aspx？**

如果我知道如何添加，我会添加的功能：

1.  如果与搜索词 100% 匹配，则自动加载 #1 命中
2.  将每个结果的前几行显示为预览，这样用户就不必点击进入不良结果
3.  在没有 100% 匹配的情况下添加“页面不存在，单击此处创建”链接

我已经安装了 Sharepoint Designer，看起来我可以使用它来上传我创建的任何自定义 .aspx 文件，但我看不到它可以让我访问 searchresults.aspx。

注意：由于我计划通过 URL 参数从外部站点访问此搜索工具，因此保留现有 searchresults.aspx 并仅加载此解决方案作为补充搜索选项应该没问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T17:02:28.447

是的，一切皆有可能，但您需要稍微定制一下。

我建议您构建一个自定义 Web 部件来显示您的结果。这是一篇不错的文章：http: [//msdn.microsoft.com/en-us/library/ms584220.aspx](http://msdn.microsoft.com/en-us/library/ms584220.aspx)

# svn - 最好的通用 SVN 忽略模式？

> ID：85353
> 
> 赞同：177
> 
> 时间：2008-09-17T16:59:23.947
> 
> 标签：svn, language-agnostic, version-control, development-environment, environment

什么是最好的（或尽可能好的）通用 SVN 忽略模式？

有许多不同的 IDE、编辑器、编译器、插件、平台等特定文件和一些“重叠”的文件类型（即，某些类型的项目需要，而其他类型的项目不需要）。

**但是，无论您的开发环境的具体情况如何，您都不想将大量文件类型自动包含在源代码管理中。**

这个问题的答案可以作为任何项目的一个很好的起点——只需要他们添加他们需要的几个特定于环境的项目。它也可以适用于其他版本控制系统 (VCS)。

* * *

## 回答 #1

> 赞同：195
> 
> 时间：2008-09-17T17:01:30.870

我会在这个问题上加上我自己的两分钱：

我将以下 SVN 忽略模式与 TortoiseSVN 和 Subversion CLI 一起用于 Windows 和 Linux 平台上的本机 C++、C#/VB.NET 和 PERL 项目。这对我来说很有效！

格式化为复制和粘贴：

```
*.o *.lo *.la #*# .*.rej *.rej .*~ *~ .#* .DS_Store thumbs.db Thumbs.db *.bak *.class *.exe *.dll *.mine *.obj *.ncb *.lib *.log *.idb *.pdb *.ilk *.msi* .res *.pch *.suo *.exp *.*~ *.~* ~*.* cvs CVS .CVS .cvs release Release debug Debug ignore Ignore bin Bin obj Obj *.csproj.user *.user *.generated.cs

```

为便于阅读而格式化：

```
*.o *.lo *.la #*# .*.rej *.rej
.*~ *~ .#* .DS_Store thumbs.db
Thumbs.db *.bak *.class *.exe *.dll
*.mine *.obj *.ncb *.lib *.log
*.idb *.pdb *.ilk *.msi* .res *.pch *.suo
*.exp *.*~ *.~* ~*.* cvs CVS .CVS .cvs  
发布发布调试调试
忽略 忽略 bin Bin obj Obj
*.csproj.user *.user
*.generated.cs

```

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2009-05-09T12:06:53.213

基于 Burly 的忽略模式，我已将 ReSharper 添加到忽略列表

格式化为复制和粘贴：

```
*.o *.lo .la ## .*.rej .rej .~ ~ .# .DS_Store thumbs.db Thumbs.db *.bak *.class *.exe *.dll *.mine *.obj *.ncb *.lib *.log *.idb *.pdb *.ilk .msi .res *.pch *.suo *.exp ~. cvs CVS .CVS .cvs release Release debug Debug ignore Ignore bin Bin obj Obj *.csproj.user *.user _ReSharper.* *.resharper.user 
```

为便于阅读而格式化：

```
*.o *.lo .la ## .*.rej .rej .~ ~ .# .DS_Store thumbs.db Thumbs.db *.bak
*.class *.exe *.dll *.mine *.obj *.ncb *.lib *.log *.idb *.pdb *.ilk .msi .res *.pch *.suo *.exp ~. cvs
CVS .CVS .cvs release Release debug
Debug ignore Ignore bin Bin obj Obj
*.csproj.user *.user _ReSharper.* *.resharper.user 
```

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2009-11-29T13:00:54.610

我对 Visual Studio 的忽略模式：

```
*/bin */obj */Release */Debug *.suo *.err *.log *.obj *.bin *.dll *.exe *.LOG *.user *.pdb [tT]emp [tT]empPE Ankh.Load thumbs.db *.resharper *.vspscc *.vsssccc *.scc */_ReSharper* */_ReSharper.* bin obj *.resharperoptions *.db *.bak *_ReSharper* *.snk 日志输出 TestResults *.crunchsolution .* *.crunchproject.*

```

为可读性而格式化

```
*/bin */obj */Release */Debug *.suo *.err *.log *.obj *.bin *.dll *.exe
*.LOG *.user *.pdb [tT]emp [tT]empPE Ankh.Load thumbs.db *.resharper
*.vspscc *.vsssccc *.scc */_ReSharper* */_ReSharper.* bin obj
*.resharperoptions *.db *.bak *_ReSharper* *.snk 日志输出 TestResults
*.crunchsolution.* *.crunchproject.*

```

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2008-09-17T17:05:49.797

每次我在存储库中遇到我通常不想要的文件时，我都会更新模式。我相信没有“最好”的模式——它总是**取决于**你开发的语言和环境。

此外，您不太可能想到所有可能的“可忽略”文件类型 - 您总是会遇到您忘记包含的文件类型。这就是为什么随时更新模式效果最好的原因。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2008-09-17T17:02:20.103

Windows 用户可能想要添加 desktop.ini 和 thumbs.db。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-09-17T17:01:13.693

用于我的 Visual Studio 项目

```
*/bin */obj *.user *.suo 
```

您可以从那里扩展更多文件类型。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-09-17T17:04:18.817

Visual Studio (VC++) 用户肯定需要排除**.ncb**文件

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-17T17:06:17.393

Mac 用户可能想要加入 .DS_Store。另外，如果有开发者使用 Emacs 或 Vim，你可能需要添加*~~ 和*##。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-17T17:08:25.797

对于 Eclipse，我使用：

```
bin
.* 
```

.* 获取所有项目配置。您几乎从不想签入“隐藏”目录或文件，但如果出现，您仍然可以 svn 添加它。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-09T09:20:08.537

由于您可能将第三方库和 dll 用作项目的一部分，因此我看不到从存储库中阻止 *.lib 和 *.dll 的智慧。这些是要存储在存储库中的东西。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2011-08-01T17:54:01.260

Visual Studio 2010 用户应添加`ipch`（包含 C++ 预编译头文件的文件夹）和`*.sdf`（intellisense 用于任何类型项目的巨大文件）。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-17T17:07:35.317

该模式取决于您使用的操作系统。

在 Linux 上，您首先需要阻止 **.o*、**.so*、**.a* 和 **.la*。您可能还想阻止 **~*（编辑备份文件）和 #*#（崩溃时的 emacs 备份）。

在 Windows 上，您至少需要 **.obj*、**.lib* 和 **.dll*。

您需要阻止的任何其他文件取决于您的 IDE、编辑器和编译器。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2010-06-21T05:42:44.760

如果您使用 Resharper，则必须添加 Resharper。

另一个需要注意的是 Ankh*.*

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2011-10-14T08:15:20.773

不要忘记[NCrunch](http://www.ncrunch.net)临时文件：

```
*.crunchsolution.* *.crunchproject.* 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2013-07-16T09:14:14.360

和核心转储（cygwin，linux）

```
*.stackdump core.* 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2016-09-13T08:59:39.283

[gitignore.io](https://www.gitignore.io/)为 git 提供了可配置的模式。它们提供了一个可读的列表，您需要为 SVN 重新格式化。

例如，[请求 MicrosoftOffice 和 Windows](https://www.gitignore.io/api/microsoftoffice%2Cwindows)返回

```
# Created by https://www.gitignore.io/api/microsoftoffice,windows

### MicrosoftOffice ###
*.tmp

# Word temporary
~$*.doc*

# Excel temporary
~$*.xls*

# Excel Backup File
*.xlk

# PowerPoint temporary
~$*.ppt*

# Visio autosave temporary files
*.~vsdx

### Windows ###
# Windows image file caches
Thumbs.db
ehthumbs.db

# Folder config file
Desktop.ini

# Recycle Bin used on file shares
$RECYCLE.BIN/

# Windows Installer files
*.cab
*.msi
*.msm
*.msp

# Windows shortcuts
*.lnk 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2016-09-13T09:07:00.000

[gitignore.io](https://www.gitignore.io/)为 git 提供了可配置的模式。它们提供了一个可读的列表，您需要为 SVN 重新格式化。

例如，[请求 MicrosoftOffice 和 Windows](https://www.gitignore.io/api/microsoftoffice%2Cwindows)返回

```
# Created by https://www.gitignore.io/api/microsoftoffice,windows

### MicrosoftOffice ###
*.tmp

# Word temporary
~$*.doc*

# Excel temporary
~$*.xls*

# Excel Backup File
*.xlk

# PowerPoint temporary
~$*.ppt*

# Visio autosave temporary files
*.~vsdx

### Windows ###
# Windows image file caches
Thumbs.db
ehthumbs.db

# Folder config file
Desktop.ini

# Recycle Bin used on file shares
$RECYCLE.BIN/

# Windows Installer files
*.cab
*.msi
*.msm
*.msp

# Windows shortcuts
*.lnk 
```

好像可以直接当`svn:global-ignore`

# java - 处理 XML 时“java.lang.NullPointerException”的最常见原因是什么？

> ID：85370
> 
> 赞同：-2
> 
> 时间：2008-09-17T17:01:08.170
> 
> 标签：java, xml, dom, parsing, dtd

我最强的领导是处理传入 XML 的代码实际上正在接收无效/不完整的文件，因此无法解析 DOM。有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-17T17:03:30.910

不完整的文件绝对是开始寻找的地方。我会在您解析文件之前打印出文件，以查看发送到解析器的内容。如果它不完整，那将是显而易见的。如果它无效，您将需要进行一些搜索。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-17T17:09:00.273

我的第一个猜测是，使用 DOM 的代码将 DTD 中标记为可选的元素视为强制元素。

编辑添加：我的意思是，除非您针对 DTD 进行验证，否则您不能期望类似以下的内容（使用 dom4j 的示例）返回除 null 之外的任何内容。

```
doc.selectSingleNode("//some/element/in/a/structure"); 
```

如果您将元素导航调用串在一起，或者通常在使用它们之前不检查返回值，那么当然也是如此。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T17:07:41.040

您应该有一个堆栈跟踪指向您抛出 NPE 的位置。这应该会缩小可以为空的变量的数量。我建议不要让调试器或 printf 出来，而是添加适当的检查并在可以检测到错误时立即抛出异常。养成以后避免神秘问题的好习惯。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T17:08:15.017

理想情况下，您应该在调试器中运行您的 java 应用程序，因此当抛出未捕获的异常时，您可以检查调用堆栈、变量等，并查看导致崩溃的确切行，以及可能使用了哪些数据为 null。

如果您出于某种原因无法使用调试器，则使用调试支持编译您的应用程序，并为此特定错误添加异常处理程序，并打印出堆栈跟踪。同样，这将准确显示导致崩溃的文件中的哪一行。

# sql-server - 在 SQL Server 中设置日期

> ID：85373
> 
> 赞同：75
> 
> 时间：2008-09-17T17:01:25.423
> 
> 标签：sql-server, tsql

在 SQL Server 中，如何将 DATETIME 设置为秒/分钟/小时/天/年？

假设我有一个日期**2008-09-17 12:56:53.430**，那么 floor 的输出应该是：

*   年份：2008-01-01 00:00:00.000
*   月份：2008-09-01 00:00:00.000
*   日期：2008-09-17 00:00:00.000
*   时间：2008-09-17 12:00:00.000
*   分钟：2008-09-17 12:56:00.000
*   第二：2008-09-17 12:56:53.000

* * *

## 回答 #1

> 赞同：109
> 
> 时间：2008-09-17T17:01:36.500

关键是使用[DATEADD](http://msdn.microsoft.com/en-us/library/ms186819.aspx)和[DATEDIFF](http://msdn.microsoft.com/en-us/library/ms189794.aspx)以及适当的 SQL 时间跨度枚举。

```
declare @datetime datetime;
set @datetime = getdate();
select @datetime;
select dateadd(year,datediff(year,0,@datetime),0);
select dateadd(month,datediff(month,0,@datetime),0);
select dateadd(day,datediff(day,0,@datetime),0);
select dateadd(hour,datediff(hour,0,@datetime),0);
select dateadd(minute,datediff(minute,0,@datetime),0);
select dateadd(second,datediff(second,'2000-01-01',@datetime),'2000-01-01');
select dateadd(week,datediff(week,0,@datetime),-1); --Beginning of week is Sunday
select dateadd(week,datediff(week,0,@datetime),0); --Beginning of week is Monday 
```

请注意，当您按秒计算时，如果使用 0，通常会出现算术溢出。因此，请选择一个已知值，该值保证低于您尝试计算的日期时间。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2008-09-17T19:08:32.403

在 SQL Server 中，有一个小技巧可以做到这一点：

```
SELECT CAST(FLOOR(CAST(CURRENT_TIMESTAMP AS float)) AS DATETIME) 
```

您将 DateTime 转换为浮点数，它将 Date 表示为整数部分，将 Time 表示为一天中过去的分数。去掉那个小数部分，然后把它转换回一个 DateTime，你就在那天开始时得到了午夜。

这可能比所有 DATEADD 和 DATEDIFF 的东西更有效。打字当然更容易。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2012-04-18T15:20:00.317

扩展 Convert/Cast 解决方案，在 Microsoft SQL Server 2008 中，您可以执行以下操作：

```
cast(cast(getdate() as date) as datetime) 
```

只需替换`getdate()`为日期时间的任何列。

此转换不涉及字符串。

这对于临时查询或更新是可以的，但对于键连接或大量使用的处理，最好在处理中处理转换或重新定义表以具有适当的键和数据。

在 2005 年，您可以使用 messier 地板：`cast(floor(cast(getdate() as float)) as datetime)`

我不认为这也使用字符串转换，但我不能说比较实际效率与扶手椅估计。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-07-25T14:22:45.573

多年来，我多次使用[@Portman 的答案作为铺地日期的参考，并将其工作转移到您可能会发现有用的功能中。](https://stackoverflow.com/a/85379/31532)

我不声称它的性能，只是将它作为用户的工具提供。

**我问，如果你决定支持这个答案，也请支持@Portman[的答案](https://stackoverflow.com/a/85379/31532)，因为我的代码是他的衍生代码。**

```
IF OBJECT_ID('fn_FloorDate') IS NOT NULL DROP FUNCTION fn_FloorDate
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE FUNCTION [dbo].[fn_FloorDate] (
  @Date DATETIME = NULL,
  @DatePart VARCHAR(6) = 'day'
)
RETURNS DATETIME
AS
BEGIN
  IF (@Date IS NULL)
    SET @Date = GETDATE();

  RETURN
  CASE
    WHEN LOWER(@DatePart) = 'year' THEN DATEADD(YEAR, DATEDIFF(YEAR, 0, @Date), 0)
    WHEN LOWER(@DatePart) = 'month' THEN DATEADD(MONTH, DATEDIFF(MONTH, 0, @Date), 0)
    WHEN LOWER(@DatePart) = 'day' THEN DATEADD(DAY, DATEDIFF(DAY, 0, @Date), 0)
    WHEN LOWER(@DatePart) = 'hour' THEN DATEADD(HOUR, DATEDIFF(HOUR, 0, @Date), 0)
    WHEN LOWER(@DatePart) = 'minute' THEN DATEADD(MINUTE, DATEDIFF(MINUTE, 0, @Date), 0)
    WHEN LOWER(@DatePart) = 'second' THEN DATEADD(SECOND, DATEDIFF(SECOND, '2000-01-01', @Date), '2000-01-01')
    ELSE DATEADD(DAY, DATEDIFF(DAY, 0, @Date), 0)
  END;
END 
```

**用法：**

```
DECLARE @date DATETIME;
SET @date = '2008-09-17 12:56:53.430';

SELECT
  @date AS [Now],--2008-09-17 12:56:53.430
  dbo.fn_FloorDate(@date, 'year') AS [Year],--2008-01-01 00:00:00.000
  dbo.fn_FloorDate(default, default) AS [NoParams],--2013-11-05 00:00:00.000
  dbo.fn_FloorDate(@date, default) AS [ShouldBeDay],--2008-09-17 00:00:00.000
  dbo.fn_FloorDate(@date, 'month') AS [Month],--2008-09-01 00:00:00.000
  dbo.fn_FloorDate(@date, 'day') AS [Day],--2008-09-17 00:00:00.000
  dbo.fn_FloorDate(@date, 'hour') AS [Hour],--2008-09-17 12:00:00.000
  dbo.fn_FloorDate(@date, 'minute') AS [Minute],--2008-09-17 12:56:00.000
  dbo.fn_FloorDate(@date, 'second') AS [Second];--2008-09-17 12:56:53.000 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-17T17:04:00.003

[CONVERT()](http://msdn.microsoft.com/en-us/library/ms187928.aspx)函数也可以执行此操作，具体取决于您使用的样式。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-17T17:27:37.530

太糟糕了，它不是 Oracle，否则你可以使用 trunc() 或 to_char()。

但是我在 SQL Server 上遇到了类似的问题，并使用了 CONVERT() 和 DateDiff() 方法，如此处所[引用](http://www.sqlteam.com/forums/topic.asp?TOPIC_ID=54594)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-10-02T17:27:12.570

有几种方法可以给这只猫剥皮 =)

```
select convert(datetime,convert(varchar,CURRENT_TIMESTAMP,101)) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-05-05T20:19:22.040

DateAdd 和 DateDiff 可以帮助完成许多不同的任务。例如，您可以找到任何一个月的最后一天，也可以找到上个月或下个月的最后一天。

```
----Last Day of Previous Month
SELECT DATEADD(s,-1,DATEADD(mm, DATEDIFF(m,0,GETDATE()),0))
LastDay_PreviousMonth
----Last Day of Current Month
SELECT DATEADD(s,-1,DATEADD(mm, DATEDIFF(m,0,GETDATE())+1,0))
LastDay_CurrentMonth
----Last Day of Next Month
SELECT DATEADD(s,-1,DATEADD(mm, DATEDIFF(m,0,GETDATE())+2,0))
LastDay_NextMonth 
```

[来源](http://blog.sqlauthority.com/2007/08/18/sql-server-find-last-day-of-any-month-current-previous-next/)

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-02-18T15:46:30.357

由于 PostgreSQL 也是一个“SQL Server”，我会提到

```
date_trunc() 
```

这正是您优雅地要求的。

例如：

```
选择 date_trunc('hour',current_timestamp);
       日期截断
----------------------
 2009-02-18 07:00:00-08
(1 行)

```

# history - 世界上第一个计算机编程_语言_？

> ID：85374
> 
> 赞同：9
> 
> 时间：2008-09-17T17:01:25.627
> 
> 标签：history

好的——一个未定义的问题（Eniac 插件板中的插件模式是一种语言吗？？）但竞争者包括：

*   Konrad Zuse 的 PlanKalkül（1940 年代） - 从未实施（普遍接受为第一个）。
*   无论 Ada Lovelace（1840 年代）用什么程序（不是 Ada）——如果她是第一个程序员，正如大家所说，她一定使用过第一种编程语言，不是吗？同样可能从未实现过——但巴贝奇有什么可以称为语言的东西吗？
*   图灵对他的图灵机的描述（1936 年论文）。在论文中，他实际上编写了程序并以数学方式模拟了它们的执行——这使得它与我书中的 PlanKalkül 一样好（并且比它更早）。
*   Macchester Mark 1 计算机的自动编码（1952 年）- 编译，高级，击败 Fortan（？）。图灵先生再次（！）。

*   Fortran（1950 年代初期）- 击败 Lisp 几年，无疑通过了嗅探测试。但它是否早于 Mark 1 自动编码？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-09-17T17:05:02.827

PBS 系列 Connections 提出的论点是，在瓷砖上打孔以控制织布机上创建的图案（大约 1700 年代？？）是第一种编程“语言”。

紧随其后的是演奏者钢琴卷轴：纸上的代码，由机器读取并控制机器的操作。那是一种编程语言，不是吗？

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-09-17T17:23:41.003

**[DNA——](http://en.wikipedia.org/wiki/DNA_replication)**或者它是否必须涉及硅计算机？;-)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-09-17T17:07:02.273

由于[Ada Lovelace](http://en.wikipedia.org/wiki/Ada_Lovelace)被广泛认为是第一位程序员，我将调查她所使用的符号集。

**更新**：您可以阅读 Lovelace 在她的笔记中使用的符号，该注释由 LF MENABREA[的 Charles Babbage 发明的分析引擎草图。](http://www.fourmilab.ch/babbage/sketch.html)Lovelace 是翻译，但她描述分析引擎编程的笔记最终比原始出版物长了大约四倍。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-17T17:03:35.700

我认为我们需要就“编程语言”的定义达成一致，才能以任何有用的方式回答这个问题。直接操作机器代码是一种编程语言吗？

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-17T17:10:33.063

> Konrad Zuse 的 PlanKalkül (1940s) - 从未实施

实际上，Rojas*等人发布了该语言的实现。*大约在 2000 年左右。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-17T17:51:41.340

> DNA——或者它是否必须涉及硅计算机？;-)

好吧，如果你沿着这条路走，那么正确的答案必须是在 DNA 之前存在的**RNA 。**但是，我们有一个盲人程序员吗？;-)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-08-04T13:09:10.063

一开始有 Ada Lovelace，然后 Bill 说“要有 C#”，然后就有了光！

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-03T17:31:04.250

假设将“编程语言”定义为“用于描述/控制数字计算机预期行为的文本符号”，我认为只有一个可能的答案：原始（数字）机器代码。

许多其他答案（例如烹饪食谱）很聪明，但不是关于*编程本身*，而是关于不同上下文或更一般意义上的描述/控制。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-17T17:03:15.857

我会说实际*使用*的第一种编程语言是第一台存储程序计算机的机器语言，我相信它是 Baby： http: [//www.computer50.org/](http://www.computer50.org/)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-17T17:36:41.533

分析引擎将使用的语言是它自己的机器代码，通过打孔卡输入，指示要执行的操作和执行它的列（有效地注册）。有关详细信息，请参阅[这些说明](http://www.fourmilab.ch/babbage/sketch.html)。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-17T17:44:22.577

至少在声明性意义上，编程归结为顺序、交替和重复的组合。人们可能会将配方作者视为程序员，因此是非常早期的人。考虑一个食谱：它包含顺序（切片，然后切碎，然后加热某某……），交替（如果你想要它湿润，然后烤 40 分钟，否则如果你想要它“蛋糕”烤 55分钟）和重复（当面团不僵硬时，重复搅拌直到面糊光滑）。食谱可以追溯到几千年前。

# c# - SharePoint - 如何使用列表 Web 服务插入新项目？

> ID：85392
> 
> 赞同：6
> 
> 时间：2008-09-17T17:02:25.470
> 
> 标签：c#, xml, sharepoint, service

我有一个包含 2 个文本字段和一个选择字段的列表。如何使用 Lists.asmx Web 服务插入新项目？我可以对 lists.asmx 服务进行 Web 引用，因此您可以假设这是已知的。

我想要一个完整的示例，包括 CAML 查询的代码和 XML。理想情况下，示例将使用 C#。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-09-17T18:53:06.810

使用 Lists Web 服务将项目插入 SharePoint 列表确实很棘手。由于此方法的形式为：XML 输入，XML 输出，因此很难获得正确的参数。

首先，您应该看一下列表定义。可以通过GetList()方法获取，如下图：

```
XmlNode listXml = sharePointLists.GetList(listName);
File.WriteAllText("listdefinition.xml", listXml.OuterXml); 
```

这里重要的是字段的名称及其数据类型。字段名称永远不会与您在 SharePoint GUI 中看到的名称相同。一个很好的例子是标题字段，它用于列表的第一个字段。

现在您知道了，您可以创建查询以转到 SharePoint。一个例子：

```
<Batch OnError="Continue">
    <Method ID="1" Cmd="New">
        <Field Name="Title">Abcdef</Field>
        <Field Name="Project_x0020_code">999050</Field>
        <Field Name="Status">Open</Field>    
    </Method>
</Batch> 
```

Batch 元素是 XML 的根元素。在里面你可以放不同的方法。这些应该有一个唯一的 ID（用于向您报告错误）和一个命令，例如可以是“新建”或“更新”。在方法内部，您放置了指定每个字段值的字段元素。例如，标题字段的值是“Abcdef”。请注意使用 GetList() 返回的确切名称。

要在 SharePoint 上执行查询，请使用 UpdateListItems() 方法：

```
XmlNode result = sharePointLists.UpdateListItems(listDefinition.Name, updates); 
```

返回值是一个包含每次更新状态的 XML 片段。例如：

```
<Results xmlns="http://schemas.microsoft.com/sharepoint/soap/">
    <Result ID="1,New">
    <ErrorCode>0x00000000</ErrorCode>
    <z:row ows_ContentTypeId="0x010036F3F587127F1A44B8BA3FEFED4733C6" 
         ows_Title="Abcdef" 
         ows_Project_x0020_code="999050" 
         ows_Status="Open" 
         ows_LinkTitleNoMenu="Abcdef" 
         ows_LinkTitle="Abcdef" 
         ows_ID="1005"            
         ... 
         xmlns:z="#RowsetSchema" />
    </Result>
</Results> 
```

您可以解析它并查看 ErrorCode 以查看哪些方法失败了。

在实践中，我创建了一个包装类，为我处理所有脏细节。不幸的是，它归我的雇主所有，所以我无法与您分享。

此包装类是用于从我们的项目数据库中检索信息并将其发布到 SharePoint 的内部实用程序的一部分。由于它是在公司时间开发的，我不允许在这里发布它。

# lotus-notes - 如何更改电子邮件莲花笔记中的默认删除日期？

> ID：85403
> 
> 赞同：1
> 
> 时间：2008-09-17T17:03:59.193
> 
> 标签：lotus-notes

我使用 Lotus Notes 作为我的电子邮件客户端，以及如何将默认电子邮件删除日期更改为新的日期，以便我的旧电子邮件不会在预定义日期后被删除？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T17:04:20.097

转到 TOOLS -> Change Delete Date ，您可以放置​​任意天数来更改所选电子邮件的默认删除日期。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-25T14:04:03.993

Lotus Notes 电子邮件不会自动删除电子邮件 - 没有“默认删除日期”。

它确实有一个设置，可以在指定的小时后自动从您的垃圾箱文件夹中删除电子邮件（但如果您删除它，邮件只会被放入垃圾箱）。您可以通过单击更多 >> 首选项...“在 __ 小时后删除我的废纸篓文件夹中的文档”找到此设置

# c# - 基于 Microsoft Word 模板生成 PDF 文档

> ID：85404
> 
> 赞同：8
> 
> 时间：2008-09-17T17:03:59.210
> 
> 标签：c#, .net, asp.net, pdf, pdf-generation

我需要一个 Word 文档，它是一种模板……收集用户输入以填充该模板中的特定字段……然后生成一个 PDF 文件，其中包括完整的模板以及其他一些文档类型。有人对实现这一目标的组件有很好的建议吗？最好是不需要在 Web 服务器上安装 Microsoft Office 的软件。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-08T22:15:45.523

试试 Aspose Words for .net。来自他们的网站：“Aspose.Words 使 .NET 和 Java 应用程序能够在不使用 Microsoft Word 的情况下读取、修改和编写 Word® 文档。” 在 Aspose PDF 中使用 Aspose Words 可以让您输出为 PDF。

您不想做的一件事是在您的生产服务器上安装 MS Word。加载这些对象是缓慢的并且会吃掉内存。除非您还在服务器上安装了 MS Word，否则您将无法使用 CutePDF Writer。哎呀。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-12T23:34:16.643

尝试使用 Apache POI API 填充字段。它可以进入 Word 文档并访问它们的元素。

至于 Word -> PDF 步骤，我还建议评估 Aspose 解决方案。它甚至可以执行这两个步骤。然而，它不是免费的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T17:08:52.973

有使用 Word 的理由吗？如果您从带有表单字段的 PDF 开始，您可以允许用户填写字段，或者使用 iTextSharp 的 PDF 压模以编程方式完成。

如果您需要以编程方式使用 MSOffice 2000/2003 组件，您可以尝试使用 Office Web Components。它们确实需要安装在服务器上，但可以被 .NET 和 Com 应用程序用于与 office 文件类型进行交互。更多信息在这里... [http://en.wikipedia.org/wiki/Office_Web_Components](http://en.wikipedia.org/wiki/Office_Web_Components)

如果您在办公室 CD 上进行挖掘，您应该会找到适合您的版本的 OWC 安装程序。我没有使用 2007，但我认为有类似的东西可用。

iTextSharp 和 OWC 是免费的，请查看许可以获取更多详细信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-22T20:16:52.313

我对“doc 模板”+ 合并到 pdf 解决方案的第一个想法是从开放式办公格式开始。- odt 文件（打开文档模板）是基于 xml 的 - 所以你甚至可以使用 perl 来进行合并，然后调用 writer 的 doc 2 pdf（我不知道他们是否有 API，但可以在更少的时间内找到超过一天 - 即使必须检查来源。）

并将您的“单词”点转换为写入器 odt 文件只是 OoWriter 中的“文件另存为”操作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T17:10:38.350

嗯...您也许可以创造性地使用 CutePDF 打印机来解决这个问题。从本质上讲，它需要*任何*可以通过标准打印驱动程序输入的东西，并从中制作 PDF。免费。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-04-19T09:03:38.603

看看[Muhimbi PDF Converter Web 服务](http://www.muhimbi.com/Products/PDF-Converter-Services/summary.aspx)。它作为服务在 Windows 上运行，但可以从任何非 Windows 支持 Web 服务的环境访问，包括 Java 和 .NET。

尽管此解决方案需要将 MS-Office 安装在服务器上（不一定与您的应用程序在同一台服务器上），但它非常健壮并提供完美的转换保真度。

要生成或修改 MS-Word 文件，我建议使用免费的[Open XML SDK for Microsoft Office](http://www.microsoft.com/downloads/details.aspx?FamilyId=C6E744E5-36E9-45F5-8D8C-331DF206E0D0&displaylang=en)。Eric White 维护了一个[非常好的博客](http://blogs.msdn.com/ericwhite/archive/2010/04/16/office-2010-reaches-rtm.aspx)。

免责声明，我在这个产品上工作。话虽如此，它工作得很好。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-12-21T21:43:06.773

如果您使用 Aspose.Words，那么您的输入文档/模板可以是多种支持的格式之一，包括 DOC、DOCX。

然后，您可以通过多种方式将数据插入到文档中。您可以在文档中使用书签并设置其文本。或者更好的是使用我们提供的报告引擎。它允许使用标准的 MS Word MERGEFIELD 字段，并添加了重复区域甚至嵌套的功能。例如，您可以在 MS Word 中设计一个发票（带有父/子数据）模板，然后在一行代码中从 .NET 数据集填充。

此外，您只需要 Aspose.Words 即可生成 PDF（一年前您需要 Aspose.Words 和 Aspose.Pdf）。您还可以轻松地将外观完全相同的文档保存为 DOC、DOC、DOCX 和其他一些格式。

我在 Aspose.Words 开发团队。

# vmware - 如何将虚拟机从 VMWare 移植到 VirtualBox？

> ID：85414
> 
> 赞同：3
> 
> 时间：2008-09-17T17:05:16.163
> 
> 标签：vmware, virtualbox

我使用 VMWare 已经有一段时间了，对它非常满意，但我想将它与 VirtualBox 进行比较。显然磁盘映像是兼容的，并且我已经成功启动了由 VMWare 在 VirtualBox 中创建的基于 Fedora 的 VM……但是网络完全不可用。如何将虚拟机从 VMWare 移植到 VirtualBox 并保持所有功能完好无损？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-17T17:07:58.777

您是否尝试过进入虚拟框中的选项并将网络适配器更改为 VB 的？VB 的虚拟适配器有点不同，您可能必须创建一个连接到 nic 的新适配器，然后将其指定为主 nic。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T17:12:11.530

如果网络不可用，您可能需要检查 VirtualBox 配置并确保配置了网卡。如果你这样做了，那么下一站将是在虚拟机中运行的操作系统。一些操作系统的一个不幸的事实是它们并不总是喜欢硬件变化。如果操作系统没有自动检测到网卡的更改，您可能需要重新配置它以支持新网卡。

另一种可能性是您使用的是固定 IP 地址。VirtualBox 使用了一些与 VMWare 略有不同的网络方案。您可能需要更改 VM 内的 IP 以匹配预期的子网。

在虚拟机之外，如果您想访问您的虚拟机，您需要使用桥接网络设备或通过 NAT 系统配置端口[虚拟端口。](https://blogs.oracle.com/manoj/entry/netowkring_with_virtualbox)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T17:48:35.217

您确定该网络完全不可用吗？众所周知，VirtualBox 在 ICMP 支持方面存在[问题](http://www.virtualbox.org/ticket/181)，因此您将无法从来宾操作系统 ping 任何主机。我昨天遇到了同样的问题，网络实际上正在工作。

# windows - 原始 Win32 中的富编辑控件

> ID：85427
> 
> 赞同：5
> 
> 时间：2008-09-17T17:07:02.417
> 
> 标签：windows, winapi, richedit

Rich Edit Controls 的文档是否真的像看起来那样糟糕（错误？）？现在我手动调用 LoadLibrary("riched20.dll") 以显示富编辑控件。Rich Edit 的文档在使用 Rich Edit 控件的第一个代码示例中未能很好地说明这一点。

它谈到调用 InitCommonControlsEx() 来添加视觉样式，但没有提到要传入哪些标志。

有没有更好的方法来加载 Rich Edit 控件？

[http://msdn.microsoft.com/en-us/library/bb787877(VS.85).aspx](http://msdn.microsoft.com/en-us/library/bb787877(VS.85).aspx)

这是我可以编写使其工作的唯一代码：

```
#include "Richedit.h"
#include "commctrl.h"

INITCOMMONCONTROLSEX icex;
icex.dwSize = sizeof(INITCOMMONCONTROLSEX);
icex.dwICC = ICC_USEREX_CLASSES;  //Could be 0xFFFFFFFF and it still wouldn't work
InitCommonControlsEx(&icex);  //Does nothing for Rich Edit controls

LoadLibrary("riched20.dll");  //Manually?  For real?
hWndRichEdit = CreateWindowEx(
    ES_SUNKEN,
    RICHEDIT_CLASS,
    "",
    WS_BORDER | WS_VISIBLE | WS_CHILD,
    2, 2, 100, 24,
    hWnd, (HMENU) ID_RICH_EDIT, hInst, NULL); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T17:15:38.883

使用 MFC，RichEdit 控件可以正常工作。

使用 InitCommonControlsEx() 加载 - ICC_USEREX_CLASSES 不加载 RichEdit AFAIK，您不需要它，因为它只加载不包括richedit 的“标准”通用控件。显然你只需要调用它来启用 Windows 中的“视觉样式”，而不是让 RichEdits 工作。

如果您使用的是 2008，则需要包含 Msftedit.dll 并改用 MSFTEDIT_CLASS（MS 有时为了向后兼容是垃圾）。

[文档](http://msdn.microsoft.com/en-us/library/bb787877(VS.85).aspx#creating_re_control)确实建议您正确地进行 Win32 编程。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-17T17:35:21.520

多年前，我遇到了同样的问题，是的，答案是手动加载 .dll。据我所知，原因是 RichEdit 窗口类注册在riched20.dll 的 DllMain 中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T17:15:02.567

没有可以链接到的导入库（可能是riched20.lib）。这样您就不必在运行时“手动”加载它。这就是所有标准控件的工作方式。创建项目时，VS 会自动添加对 user32.lib 的引用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T17:15:26.687

我认为您必须在创建任何常用控件之前调用 CoInitializeEx。

不需要 LoadLibrary。如果您链接到正确的 .lib 文件，exe-loader 将为您处理这些详细信息。

# visual-studio - 代码大纲、经典 ASP 和 Visual Studio 2005

> ID：85434
> 
> 赞同：1
> 
> 时间：2008-09-17T17:07:53.053
> 
> 标签：visual-studio, asp-classic

有没有办法在 Visual Studio 2005 中启用经典 ASP 的代码大纲？它很好地勾勒了 HTML 代码，我在 <% 和 %> 之间得到了一个大轮廓，但代码本身没有。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-09-17T17:11:54.853

Visual Studio 2008 SP1 重新添加了对经典 ASP 的支持，但我认为这两个版本都不支持您正在寻找的大纲类型。

# sharepoint - Sharepoint 项目级别访问和性能

> ID：85444
> 
> 赞同：0
> 
> 时间：2008-09-17T17:08:47.327
> 
> 标签：sharepoint, permissions, list, data-access

我创建了一个工作流活动，它确实为特定列表的项目创建者提供了对项目的完全控制权，并将其他所有人设置为只读访问（权限）

有人告诉我这样做（如果我有很多用户）性能会急剧下降

那是对的吗 ？！！

如果是，那么创建列表的最佳解决方案是什么

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-19T21:25:33.517

接受的答案实际上并没有正确回答问题......

您不应该使用工作流来执行此操作，如果您希望人们能够编辑他们创建的项目并且只阅读他们没有的项目，请使用“列表->设置->高级设置->项目级权限”，并且这个**可**用于文档库（因为它们从 SPLIST 继承）它只是没有显示在 UI 的“高级设置”中。您可以在 Document Library 上将 ReadSecurity 属性设置为 1，将 WriteSecurity 属性设置为 2。

[http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.splist.writesecurity.aspx](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.splist.writesecurity.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-17T20:44:40.643

当您对每个列表项使用大型 ACL 时，性能会下降。只要确保项目级权限基本上具有最少条目即可。例如：

*   有权编辑该项目的用户
*   一个安全组，包含所有仅具有 Reader 权限的用户。

那么，Sharepoint 可以提供这些默认权限 OOB 吗？不是我知道的。我能想到的唯一选择是使用在上传文档时动态设置这些权限的工作流。

如果您想避免性能下降，只需确保在细粒度权限列表中显示（或使用对象模型迭代）超过 2000 个这些项目。这肯定会导致重大的性能问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T17:21:48.043

是的，您可以通过工作流解决这个问题，但这可能有点笨拙，并且可能会减慢您的服务器。

更好的选择是使用列表设置 > 高级设置 > 项目级权限。

此功能不适用于文档和表单库。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T09:33:00.300

确实，包含大量应用了自定义权限的项目的列表会降低您的服务器速度。这是 Microsoft 官方文件[计划软件边界](http://technet.microsoft.com/en-us/library/cc262787.aspx)中的文档。

推荐的/神奇的数字是 2000。更进一步不会破坏任何东西，但**可能**会遇到性能问题。

# sql-server - SQL Server 2005 链接服务器到 DB2 性能问题

> ID：85450
> 
> 赞同：1
> 
> 时间：2008-09-17T17:09:11.223
> 
> 标签：sql-server, db2

我有一台 SQL Server 2005 机器，其中 JDE DB2 设置为链接服务器。

由于某种原因，从这个盒子到 db2 盒子的任何查询的性能都很糟糕。

例如。以下需要 7 分钟从 Management Studio 运行

```
SELECT     *
FROM       F42119 
WHERE     SDUPMJ >= 107256 
```

而在 iSeries Navigator 中运行需要几秒钟

有什么想法吗？我假设一些配置问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-28T23:03:06.727

在某些搜索中，SQL Server 将决定将整个表拉到其自身，并对 SQL Server 中的数据进行排序和搜索，而不是将查询发送到远程服务器。这通常是排序规则设置的问题。

确保提供程序设置了以下选项：数据访问、排序兼容、使用远程排序

然后使用提供程序创建一个新的链接服务器并选择以下提供程序选项动态参数、嵌套查询、允许处理中

设置选项后稍微更改查询以获得新的查询计划。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T20:36:21.047

It might be a memory issue on your SQL Server machine. I recently learned that linked server queries use memory allocation by the OS. Whereas native SQL Server queries use memory pre-allocated by SQL Server. If your SQL Server machine is configured to use 90% or more of the server's memory, I would scale that back a bit. Maybe 60% is the right place to be.

Another thing to check is the SQL Server processor priority. Make sure "Boost SQL Server priority" is not enabled.

I assume you are going through ODBC for access. Remember that you are not writing native db2 queries here, but instead ODBC sql queries. If you only need read-only data, you may want to try configuring your ODBC datasource to read-only mode (if that is an option).

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-28T23:13:58.623

在一个与 DB2 集成的项目中，我通过调用 OPENQUERY 函数的存储过程直接选择或查看替换了每个查询。

我的解释是 SqlServer 在应用 WHERE 条件之前获取整个表，而 OPENQUERY 将 SQL 语句直接传递给 db 驱动程序。

无论如何，修改后的性能是可以接受的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T20:46:20.477

我在将 DB2 作为链接服务器时遇到了几个问题。我不知道它是否会解决您的问题，但这是解决我的问题：

1) 在 ODBC 设置中的 EXECUTE 期间启用延迟关闭支持和预取 2) 在所有选择上添加“FOR FETCH ONLY” 3) 使用 SELECT * FROM OPENROWSET(LinkedServerName, 'SQL Command') 方法进行查询

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T21:51:21.750

我首先想到的是司机。几年前，我不得不将 DB2 链接到 SQL Server 2000，并且很难找到正确的驱动程序和设置参数的组合可以工作......

所以也许我因此而有偏见，但我会尝试升级或降级驱动程序或更改设置，以便 DB2 驱动程序可以运行 INPROC（如果它还没有这样做的话）。

# python - Python 的 time.clock() 与 time.time() 的准确性？

> ID：85451
> 
> 赞同：449
> 
> 时间：2008-09-17T17:09:13.330
> 
> 标签：python, time

在 Python 中哪个更适合用于计时？time.clock() 还是 time.time()？哪一个提供更高的准确性？

例如：

```
start = time.clock()
... do something
elapsed = (time.clock() - start) 
```

对比

```
start = time.time()
... do something
elapsed = (time.time() - start) 
```

* * *

## 回答 #1

> 赞同：177
> 
> 时间：2008-09-17T17:18:27.427

从 3.3 开始，[*time.clock()*已弃用](https://docs.python.org/3/library/time.html#time.clock)，建议使用time.process_time( **[)](https://docs.python.org/3/library/time.html#time.process_time)**或**[time.perf_counter()](https://docs.python.org/3/library/time.html#time.perf_counter)**代替。

根据**[时间模块文档](https://docs.python.org/2.7/library/time.html#time.clock)**，以前在 2.7 中：

> **时间.时钟（）**
> 
> 在 Unix 上，以浮点数形式返回当前处理器时间，以秒为单位。精度，实际上是“处理器时间”含义的定义，取决于同名 C 函数的精度，但无论如何，**这是用于对 Python 或计时算法进行基准测试的函数。**
> 
> 在 Windows 上，此函数根据 Win32 函数 QueryPerformanceCounter() 以浮点数形式返回自第一次调用此函数以来经过的挂钟秒数。分辨率通常优于一微秒。

此外，还有用于对代码片段进行基准测试的[timeit](https://docs.python.org/2/library/timeit.html)模块。

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2008-09-17T17:16:00.600

简短的回答是：大多数时候`time.clock()`会更好。但是，如果您正在计时某些硬件（例如您放入 GPU 中的某些算法），那么`time.clock()`将摆脱这个时间并且`time.time()`是唯一剩下的解决方案。

注意：无论使用什么方法，时间都将取决于您无法控制的因素（进程何时切换，多久切换一次，...），这更糟糕，`time.time()`但也存在于`time.clock()`，所以你不应该只运行一个时间测试，但总是进行一系列测试并查看时间的均值/方差。

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2008-09-17T17:18:56.613

[其他人](https://stackoverflow.com/questions/85451#85511)已经回答了：`time.time()`vs `time.clock()`.。

但是，如果您正在计时执行代码块以进行基准测试/分析，您应该查看[`timeit`模块](https://docs.python.org/library/timeit.html)。

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2008-09-17T17:14:08.030

`clock()`-> 浮点数

返回自进程开始或自第一次调用以来的 CPU 时间或实时时间`clock()`。这与系统记录的精度一样高。

`time()`-> 浮点数

返回自 Epoch 以来的当前时间（以秒为单位）。如果系统时钟提供它们，则可能存在几分之一秒。

通常`time()`更精确，因为操作系统不会以它们存储系统时间（即实际时间）的精度存储进程运行时间

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2010-02-11T17:21:26.510

要记住的一件事：更改系统时间会影响`time.time()`但不会影响`time.clock()`.

我需要控制一些自动测试执行。如果测试用例的一个步骤花费了超过给定的时间，则该 TC 将被中止以继续下一个步骤。

但有时需要一个步骤来改变系统时间（检查被测应用的调度器模块），所以在将系统时间设置为未来几个小时后，TC超时到期，测试用例中止。我必须从 to 切换`time.time()`到`time.clock()`正确处理这个问题。

* * *

## 回答 #6

> 赞同：17
> 
> 时间：2008-09-17T17:12:29.377

取决于你关心什么。如果您指的是 WALL TIME（如墙上时钟上的时间）， time.clock() 不会提供任何准确性，因为它可能会管理 CPU 时间。

* * *

## 回答 #7

> 赞同：15
> 
> 时间：2014-01-17T05:21:01.537

`time()``clock()`比在 Linux 上具有更好的精度。`clock()`仅具有小于 10 ms 的精度。虽然`time()`给出了完美的精度。我的测试是在 CentOS 6.4， python 2.6

```
using time():

1 requests, response time: 14.1749382019 ms
2 requests, response time: 8.01301002502 ms
3 requests, response time: 8.01491737366 ms
4 requests, response time: 8.41021537781 ms
5 requests, response time: 8.38804244995 ms 
```

`using clock():`

```
1 requests, response time: 10.0 ms
2 requests, response time: 0.0 ms 
3 requests, response time: 0.0 ms
4 requests, response time: 10.0 ms
5 requests, response time: 0.0 ms 
6 requests, response time: 0.0 ms
7 requests, response time: 0.0 ms 
8 requests, response time: 0.0 ms 
```

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2018-04-05T08:22:38.453

正如其他人所指出`time.clock()`的，不推荐使用 `time.perf_counter()`or `time.process_time()`，但 Python 3.7 引入了纳秒级分辨率计时，带有[`time.perf_counter_ns()`](https://docs.python.org/3.7/library/time.html#time.perf_counter_ns)、[`time.process_time_ns()`](https://docs.python.org/3.7/library/time.html#time.process_time_ns)和[`time.time_ns()`](https://docs.python.org/3.7/library/time.html#time.time_ns)，以及 3 个其他函数。

这 6 个新的纳秒分辨率函数在[PEP 564](https://www.python.org/dev/peps/pep-0564/)中有详细说明：

> `time.clock_gettime_ns(clock_id)`
> 
> `time.clock_settime_ns(clock_id, time:int)`
> 
> `time.monotonic_ns()`
> 
> `time.perf_counter_ns()`
> 
> `time.process_time_ns()`
> 
> `time.time_ns()`
> 
> 这些函数类似于没有 _ns 后缀的版本，但以 Python int 形式返回纳秒数。

正如其他人也指出的那样，使用该[`timeit`模块](https://docs.python.org/3.7/library/timeit.html)对函数和小代码片段进行计时。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2008-09-17T17:32:27.253

差异是非常特定于平台的。

例如，clock() 在 Windows 上与在 Linux 上非常不同。

对于您描述的那种示例，您可能需要“timeit”模块。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2016-03-11T00:15:17.457

我使用此代码比较 2 种方法。我的操作系统是 windows 8，处理器核心 i5，RAM 4GB

```
import time

def t_time():
    start=time.time()
    time.sleep(0.1)
    return (time.time()-start)

def t_clock():
    start=time.clock()
    time.sleep(0.1)
    return (time.clock()-start)

counter_time=0
counter_clock=0

for i in range(1,100):
    counter_time += t_time()

    for i in range(1,100):
        counter_clock += t_clock()

print "time() =",counter_time/100
print "clock() =",counter_clock/100 
```

输出：

```
time() = 0.0993799996376

clock() = 0.0993572257367 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2008-09-17T17:24:37.927

在 Unix 上 time.clock() 测量当前进程已使用的 CPU 时间量，因此它不适用于测量过去某个时间点的经过时间。在 Windows 上，它将测量自第一次调用该函数以来经过的挂钟秒数。在任一系统上 time.time() 将返回自纪元以来经过的秒数。

如果您正在编写仅适用于 Windows 的代码，那么任何一个都可以工作（尽管您会以不同的方式使用这两者 - time.clock() 不需要减法）。如果这要在 Unix 系统上运行，或者您想要保证可移植的代码，您将需要使用 time.time()。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-09-17T20:03:49.370

据我所知， time.clock() 的精度与您的系统允许的一样高。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-09-17T17:17:57.880

简短的回答：在 Python 中使用**time.clock()**进行计时。

在 *nix 系统上，clock() 以浮点数的形式返回处理器时间，以秒为单位。在 Windows 上，它返回自第一次调用此函数以来经过的秒数，作为浮点数。

time() 以浮点数形式返回纪元以来的秒数，以 UTC 表示。无法保证您将获得比 1 秒更好的精度（即使 time() 返回一个浮点数）。另请注意，如果系统时钟在两次调用此函数之间已调回，则第二次函数调用将返回较低的值。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2020-05-31T11:41:32.343

`time.clock()`在 Python 3.8 中被删除，因为它具有[平台相关行为](https://docs.python.org/3.7/library/time.html?highlight=time%20clock#time.clock)：

*   在**Unix**上，以浮点数形式返回当前处理器时间，以秒为单位。
*   在**Windows**上，此函数返回自第一次调用此函数以来经过的挂钟秒数，作为浮点数

    ```
    print(time.clock()); time.sleep(10); print(time.clock())
    # Linux  :  0.0382  0.0384   # see Processor Time
    # Windows: 26.1224 36.1566   # see Wall-Clock Time 
    ```

那么选择哪个功能呢？

*   **处理器时间**：这是该特定进程在 CPU 上主动执行所花费的时间。睡眠、等待 Web 请求或仅执行其他进程的时间不会对此产生影响。

    *   利用`time.process_time()`
*   **挂钟时间**：这是指“挂在墙上的时钟”已经过去了多少时间，即在实时之外。

    *   利用`time.perf_counter()`

        *   `time.time()`也测量挂钟时间，但可以重置，所以你可以回到过去
        *   `time.monotonic()`无法重置（单调 = 仅向前）但精度低于`time.perf_counter()`

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2016-11-18T12:27:06.263

正确答案：**它们都是相同长度的分数。**

`subject`但是 if哪个更快`time`？

**一个小测试用例**：

```
import timeit
import time

clock_list = []
time_list = []

test1 = """
def test(v=time.clock()):
    s = time.clock() - v
"""

test2 = """
def test(v=time.time()):
    s = time.time() - v
"""
def test_it(Range) :
    for i in range(Range) :
        clk = timeit.timeit(test1, number=10000)
        clock_list.append(clk)
        tml = timeit.timeit(test2, number=10000)
        time_list.append(tml)

test_it(100)

print "Clock Min: %f Max: %f Average: %f" %(min(clock_list), max(clock_list), sum(clock_list)/float(len(clock_list)))
print "Time  Min: %f Max: %f Average: %f" %(min(time_list), max(time_list), sum(time_list)/float(len(time_list))) 
```

我不是在瑞士实验室工作，但我已经测试过..

**基于这个问题：`time.clock()`优于`time.time()`**

编辑：`time.clock()`是内部计数器，因此不能在外部使用，有限制`max 32BIT FLOAT`，如果不存储第一个/最后一个值，则无法继续计数。无法合并另一个计数器...

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2014-01-27T06:13:18.820

比较 Ubuntu Linux 和 Windows 7 的测试结果。

**在 Ubuntu 上**

```
>>> start = time.time(); time.sleep(0.5); (time.time() - start)
0.5005500316619873 
```

**在 Windows 7 上**

```
>>> start = time.time(); time.sleep(0.5); (time.time() - start)
0.5 
```

# linq-to-sql - System.Data.Linq.Table 的限制结果

> ID：85457
> 
> 赞同：3
> 
> 时间：2008-09-17T17:09:57.090
> 
> 标签：linq-to-sql

我正在尝试从 LinqToSQL 中生成的数据上下文继承 - 像这样

```
public class myContext : dbDataContext {
 public System.Data.Linq.Table<User>() Users {
  return (from x in base.Users() where x.DeletedOn.HasValue == false select x);
 }
} 
```

但是我的 Linq 语句返回的 IQueryable 不能转换为 Table - 有没有人知道限制 Linq.Table 内容的方法 - 我试图确定在任何地方访问我的 Users 表时，它不会返回那些标记为已删除的。也许我对这一切都错了 - 任何建议将不胜感激。

哈尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T18:09:58.770

另一种方法是使用视图..

```
CREATE VIEW ActiveUsers as SELECT * FROM Users WHERE IsDeleted = 0 
```

就 linq to sql 而言，这与表相同。对于您需要 DeletedOn 过滤的任何表，只需创建一个使用过滤器的视图，并在数据上下文中使用它来代替表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T17:15:49.570

您可以在表上使用鉴别器列继承，即。一个 DeletedUsers 表和 ActiveUsers 表，其中鉴别器列说明哪个去哪个。然后在您的代码中，只需引用 Users.OfType ActiveUsers，它永远不会包含任何已删除的内容。

作为旁注，你到底是如何使用降价来做到这一点的？

```
Users.OfType<ActiveUsers> 
```

我可以在代码中得到它，但不能内联

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T01:17:46.340

封装您的 DataContext 以便开发人员不会在他们的查询中使用 Table。我的存储库中有一个“全部”属性，可以根据您的需要进行类似的过滤。那么查询就像：

```
from item in All
where ...
select item 
```

一切都可能是：

```
public IQueryable<T> All
{
    get { return MyDataContext.GetTable<T>.Where(entity => !entity.DeletedOn.HasValue); }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T17:19:20.623

您可以使用存储过程返回表中所有未标记为已删除的记录的所有映射列，然后将 LINQ to SQL 类映射到存储过程的结果。我认为您只需将服务器资源管理器中的存储过程拖放到 LINQ to SQL 设计器中的类上。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T17:26:22.773

在这种情况下我所做的是我创建了一个传递回 IQueryable 的存储库类，但基本上只是

> 从 _db.Table 中的
> t 选择 t；

这通常由 tableRepository.GetAllXXX() 引用；但你可以有一个 tableRepository.GetAllNonDeletedXXX(); 这放入了初步的 where 子句以取出已删除的行。这将允许您使用不同的方法取回已删除的、未删除的和所有行。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T17:49:27.710

也许我对凯文谢菲尔德的回应的评论可能会对我想要完成的事情有所帮助：

> 我的大部分数据访问都有一个类似的存储库，但我试图能够遍历我的关系并维护 DeletedOn 逻辑，而无需实际调用任何其他方法。对象由不能调用方法（只是道具/字段）的 StringTemplate 处理器询问（拼写固定）。

我最终将需要对我的应用程序中的所有表进行此 DeletedOn 过滤。来自 Scott Nichols 的继承类解决方案应该可以工作（尽管我需要为大约 30 个表派生一个类和关系 - 哎呀），尽管我需要弄清楚如何在我的派生类鉴别器值属性中检查空值。

我最终可能只是扩展了我的所有类，专门用于 StringTemplate 处理，明确地为我需要的关系添加属性，我只是希望能够将 StringTemplate 抛出一个 [user] 并让它遍历所有内容。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-17T23:15:32.857

我们在关联中使用了几个视图，它们仍然像任何其他关系一样出现。我们确实需要手动添加关联。我唯一能想到的建议是查看为这些类和关联生成的属性和修饰属性。

添加几个具有相同关系的表，并将它们与未显示的视图进行比较。

此外，有时服务器资源管理器连接上的刷新似乎无法正常工作并且最初没有正确创建实体，除非我们从设计器中删除它们，关闭项目，然后重新打开项目并从服务器再次添加它们探险家。这是假设您使用带有 linq to sql .dbml 设计器的 Visual Studio 2008。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-18T13:50:38.243

我发现了视图中未显示的关系/关联的问题。似乎您必须遍历 dbml 中的每个类并为视图设置主键，因为它无法从模式中提取该信息。我现在正在设置主键，并计划走查看路线以仅隔离未删除的项目。

谢谢，我稍后会更新更多。

# ruby - 是否可以使用 Ruby 将一系列 PDF 合并为一个？

> ID：85459
> 
> 赞同：10
> 
> 时间：2008-09-17T17:10:02.110
> 
> 标签：ruby, pdf

我有一系列按顺序命名的 PDF，如下所示：

*   01_foo.pdf
*   02_bar.pdf
*   03_baz.pdf
*   等等

使用 Ruby，是否可以将它们组合成一个大 PDF，同时保持它们的顺序？我不介意安装任何必要的宝石来完成这项工作。

如果这在 Ruby 中是不可能的，那么另一种语言呢？如果可能，不要使用商业组件。

* * *

**更新：** [Jason Navarrete 的建议](https://stackoverflow.com/questions/85459/is-it-possible-to-combine-a-series-of-pdfs-into-one-using-ruby#85618)带来了完美的解决方案：

将需要合并的 PDF 文件与[pdftk](http://www.accesspdf.com/pdftk/)一起放在一个目录中（或确保 pdftk 在您的 PATH 中），然后运行以下脚本：

```
pdfs = Dir["[0-9][0-9]_*"].sort.join(" ")
`pdftk #{pdfs} output combined.pdf` 
```

或者我什至可以从命令行以单行方式执行此操作：

```
ruby -e '`pdftk #{Dir["[0-9][0-9]_*"].sort.join(" ")} output combined.pdf`' 
```

很好的建议杰森，完美的解决方案，谢谢。**给他一个支持的人**。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-09-17T17:28:59.197

一篇[Ruby-Talk](http://www.ruby-forum.com/topic/120008#new)帖子建议使用**[pdftk](http://www.accesspdf.com/pdftk/)**工具包来合并 PDF。

*将pdftk*作为外部进程 调用并让它处理合并应该相对简单。*PDF::Writer*可能有点矫枉过正，因为您想要完成的只是一个简单的追加。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-17T17:23:16.120

您可以通过转换为 PostScript 并返回来做到这一点。PostScript 文件可以简单地连接起来。例如，这是一个使用 Ghostscript 工具 ps2pdf 和 pdf2ps 的 Bash 脚本：

```
#!/bin/bash
用于 01_foo.pdf 02_bar.pdf 03_baz.pdf 中的文件；做
    pdf2ps $file - >> temp.ps
完毕

ps2pdf temp.ps output.pdf
rm温度.ps

```

我不熟悉 Ruby，但几乎可以肯定有一些函数（可能被调用`system()`（只是猜测））会调用给定的命令行。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-14T20:22:29.137

如果您的平台上有 ghostscript，请退出并执行以下命令：

gs -dBATCH -dNOPAUSE -q -sDEVICE=pdfwrite -sOutputFile=finished.pdf <您的源 pdf 文件>

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-09-17T03:11:35.193

我尝试了 pdftk 解决方案，但在 SnowLeopard 和 Tiger 上都有问题。在 Tiger 上安装实际上对我的系统造成了严重破坏，让我无法运行脚本/服务器，幸运的是它是一台从 Web 开发中退役的机器。

随后又找到了另一种选择：-joinPDF。绝对是无痛且快速的安装，并且运行良好。

还尝试了 GhostScript，但它失败了（无法读取字体，我最终得到了只有图像的 PDF）。

但是，如果您正在寻找解决此问题的方法，您可能想尝试 joinPDF。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T17:14:34.253

我不认为 Ruby 有这方面的工具。您可以查看 ImageMagick 和 Cairo。ImageMagick 可用于将多个图片/文档绑定在一起，但我不确定 PDF 案例。

再说一次，肯定有 Windows 工具（商业）来做这种事情。

我自己使用 Cairo 来*生成*PDF。如果 PDF 来自您，也许这将是一个解决方案（它确实支持多个页面）。祝你好运！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T17:28:13.317

我建议查看使用 GhostScript（GNU 许可证）的 PDFCreator 的代码（VB，如果我没记错的话，但这没关系，因为您只是用另一种语言实现类似的代码）。或者直接深入研究 GhostScript 本身；还有一个名为 GhostPDF 的外观层，它可以做你想做的事。

如果你可以用 VB 控制 GhostScript，那么你可以用 C 来控制，这意味着你可以用 Ruby 来控制。

Ruby 还具有 IO.popen，它允许您调用可以执行此操作的外部程序。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-09-18T07:40:55.763

在实际应用程序中执行此操作的任何 Ruby 代码都可能会非常缓慢。我会尝试寻找 unix 工具来完成这项工作。这是使用 Mac OS X 的优点之一，它内置了非常快速的 PDF 功能。下一个最好的东西可能是一个 unix 工具。

实际上，我在 rtex 方面取得了一些成功。如果你看[这里](http://weblog.rubyonrails.org/2006/3/19/quick-pdf-generation-with-rtex)，你会发现一些关于它的信息。它比我用过的任何 Ruby 库都快得多，而且我很确定 Latex 具有从其他来源引入 PDF 数据的功能。

# c# - MVC C# 自定义 MvcRouteHandler - 如何？

> ID：85470
> 
> 赞同：4
> 
> 时间：2008-09-17T17:11:28.443
> 
> 标签：c#, asp.net-mvc, mvcroutehandler

有没有人有提供自定义 MvcRouteHandler 的经验？在我的应用程序中，我想实现一个像*http://mydomain/en/about*或*http://mydomain/de/about*这样的全球化模式。

至于持久性，我希望在请求到达后立即读取 cookie，如果此 cookie 中有语言设置，请应用它（因此到达*http://mydomain/*的用户将被转移到*http:// /mydomain/en/*例如）。如果没有 cookie，我想获得浏览器支持的第一种语言，应用这个并将其存储在这个 cookie 中。

我想这不能用 mvc 在它的初始项目模板中提供的标准路由机制来完成。在新闻组中，我得到了查看 MvcRouteHandler 并实现我自己的提示。但是很难找到如何做到这一点的样本。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T17:55:42.143

我不相信您正在做的事情需要自定义路由处理程序。

对于您的“全球化”URI，一个常规的 MVC 路由，具有“locale”参数必须等于“en”、“de”等的约束，就可以了。该约束将阻止非全球化 URI 匹配路由。

对于“非全球化”URI，创建一个“包罗万象”的路由，它只会重定向到默认或 cookie 设置的区域设置 URI。

将“全球化”路由放在 Global.asax 中的“catch-all”路由之上，这样“已经全球化”的 URI 就不会被重定向。

如果您希望某个 URI 模式触发不是控制器上的操作的东西，则需要创建一个新的路由处理程序。但我不认为这就是你要处理的，在这里。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T17:49:04.793

您应该可以使用 ASP.NET MVC 的默认模板来做到这一点，我正在做类似的事情。只需将您的路线构建为 {language}/{controller}/{action}/{id}

只需设置一个默认路由，该路由将转到检查语言 cookie 的控制器，并根据该 cookie 重定向用户。

# c# - C# 不安全/固定代码

> ID：85479
> 
> 赞同：33
> 
> 时间：2008-09-17T17:12:25.553
> 
> 标签：c#, .net, unsafe, fixed

有人可以举例说明在 C# 代码中实际使用“不安全”和“固定”的好时机吗？我以前玩过它，但从未真正找到它的好用处。

考虑这段代码...

```
fixed (byte* pSrc = src, pDst = dst) {
    //Code that copies the bytes in a loop
} 
```

与简单地使用...

```
Array.Copy(source, target, source.Length); 
```

第二个是在 .NET Framework 中找到的代码，第一部分是从 Microsoft 网站[http://msdn.microsoft.com/en-us/library/28k1s2k6(VS.80).aspx](http://msdn.microsoft.com/en-us/library/28k1s2k6(VS.80).aspx)复制的代码。

内置的 Array.Copy() 比使用 Unsafe 代码快得多。这可能只是因为第二个写得更好，第一个只是一个例子，但是你真的需要在什么情况下使用不安全/固定代码？还是这个可怜的 Web 开发人员在搞乱他头上的东西？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-09-17T17:22:49.087

它对于与非托管代码的互操作很有用。任何传递给非托管函数的指针都需要修复（又名固定），以防止垃圾收集器重新定位底层内存。

如果您使用 P/Invoke，则默认编组器将为您固定对象。有时需要执行自定义编组，有时需要固定对象的时间超过单个 P/Invoke 调用的持续时间。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2008-09-17T17:46:57.373

我使用不安全块来操作位图数据。原始指针访问比 SetPixel/GetPixel 快得多。

```
unsafe
{
    BitmapData bmData = bm.LockBits(...)
    byte *bits = (byte*)pixels.ToPointer();
    // Do stuff with bits
} 
```

“固定”和“不安全”通常在进行互操作或需要额外性能时使用。IE。String.CopyTo() 在其实现中使用不安全和固定的。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-28T16:05:27.393

reinterpret_cast 风格行为

如果您有点操纵，那么这将非常有用

许多高性能哈希码实现使用 UInt32 作为哈希值（这使得转换更简单）。由于 .Net 需要 Int32 用于您想要快速将 uint 转换为 int 的方法。由于实际值是什么并不重要，因此只需保留值中的所有位，就需要重新解释强制转换。

```
public static unsafe int UInt32ToInt32Bits(uint x)
{
    return *((int*)(void*)&x);
} 
```

请注意，命名是基于[BitConverter.DoubleToInt64Bits](http://msdn.microsoft.com/en-us/library/system.bitconverter.doubletoint64bits.aspx)

继续散列，将基于堆栈的结构转换为 byte* 可以轻松使用每字节散列函数：

```
// from the Jenkins one at a time hash function
private static unsafe void Hash(byte* data, int len, ref uint hash)
{
    for (int i = 0; i < len; i++)
    {
        hash += data[i];
        hash += (hash << 10);
        hash ^= (hash >> 6);
    }
}

public unsafe static void HashCombine(ref uint sofar, long data)
{
    byte* dataBytes = (byte*)(void*)&data;
    AddToHash(dataBytes, sizeof(long), ref sofar);
} 
```

unsafe 也（从 2.0 开始）允许您使用 stackalloc。这在需要一些小的可变长度数组（如临时空间）的高性能情况下非常有用。

所有这些用途都将坚定地处于“仅当您的应用程序确实需要性能时”，因此在一般用途中是不合适的，但有时您确实需要它。

当您希望与采用 c 样式数组或字符串的一些有用的非托管函数（有很多）进行互操作时，fixed 是必需的。因此，这不仅是出于性能原因，也是出于互操作场景中的正确性原因。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-17T17:22:20.303

Unsafe 对于（例如）使用 LockBits 快速从图像中获取像素数据很有用。使用托管 API 执行此操作的性能提高了几个数量级。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-17T17:20:06.190

当地址被传递给旧版 C DLL 时，我们必须使用固定值。由于 DLL 在函数调用之间维护了一个内部指针，如果 GC 压缩堆并移动东西，所有地狱都会崩溃。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-17T17:17:32.843

如果您想访问 .NET 运行时之外的内容，我相信会使用不安全的代码，即。它不是托管代码（没有垃圾收集等）。这包括对 Windows API 和所有爵士乐的原始调用。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-17T17:20:47.123

这告诉我，.NET 框架的设计者在解决问题方面做得很好——确保“托管代码”环境可以完成传统（例如 C++）方法可以通过其不安全的代码/指针完成的所有事情。万一它不能，如果你需要它们，不安全/固定的功能就在那里。我敢肯定有人有一个需要不安全代码的例子，但在实践中似乎很少见——这才是重点，不是吗？:)

# sql - 如何将 XML 字段的内容作为记录集返回？

> ID：85481
> 
> 赞同：2
> 
> 时间：2008-09-17T17:12:46.677
> 
> 标签：sql, xml

假设我有这张表（SQL Server 2005）：

```
Id => integer  
MyField => XML 
```

**我的字段**

```
1   < Object>< Type>AAA< /Type>< Value>10< /Value>< /Object>< Object>< Type>BBB< /Type><Value>20< /Value>< /Object>  
2   < Object>< Type>AAA< /Type>< Value>15< /Value>< /Object>  
3   < Object>< Type>AAA< /Type>< Value>20< /Value>< /Object>< Object>< Type>BBB< /Type>< Value>30< /Value>< /Object> 
```

我需要一个 TSQL 查询，它会返回如下内容：

```
Id  AAA     BBB  
1   10      20  
2   15      NULL  
3   20      30 
```

请注意，我不知道 xml 字符串中是否会提前多少个`'Type'`（例如 AAA、BBB、CCC、DDD 等）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-17T17:18:37.147

您将需要使用[sql server 中的 XML 查询](http://msdn.microsoft.com/en-us/library/ms345122.aspx#sql2k5_xqueryintro_topic8)来执行此操作。

像

```
select id, MyField.query('/Object/Type[.="AAA"]/Value') as AAA, MyField.query('/Object/Type[.="BBB"]/Value) AS BBB 
```

不确定这是否是 100% 正确的 xquery 语法，但它会是这样的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-05T00:38:48.373

一种可能的选择是使用[XMLDataDocument](http://msdn.microsoft.com/en-us/library/system.xml.xmldatadocument.aspx)。使用此类，您可以在 XML 将数据加载到 XmlDataDocument 时检索数据，然后使用 Dataset 属性访问它，就像它是标准数据集一样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-08T13:35:30.333

您将需要使用`CROSS APPLY`. 这是根据您的要求的示例：

```
declare @y table (rowid int, xmlblock xml)
insert into @y values(1,'<Object><Type>AAA</Type><Value>10</Value></Object><Object><Type>BBB</Type><Value>20</Value></Object>')
insert into @y values(2,'<Object><Type>AAA</Type><Value>15</Value></Object>')
insert into @y values(3,'<Object><Type>AAA</Type><Value>20</Value></Object><Object><Type>BBB</Type><Value>30</Value></Object>')

select y.rowid, t.b.value('Type[1]', 'nvarchar(5)'), t.b.value('Value[1]', 'int')
from @y y  CROSS APPLY  XmlBlock.nodes('//Object') t(b) 
```

哦，您的示例 XML 无效，第一行`Value`缺少`Type BBB`.

# eclipse - 在 Eclipse 中添加 SVN 存储库

> ID：85486
> 
> 赞同：29
> 
> 时间：2008-09-17T17:13:55.160
> 
> 标签：eclipse, svn, subclipse

我正在尝试将 SVN 存储库添加到 Eclipse。

我已经安装了[Subclipse](http://subclipse.tigris.org/)，它似乎工作正常。但是，当我尝试“添加新的 SVN 存储库”时，我输入了这个，例如：

*[http://svn.python.org/projects/peps/trunk](http://svn.python.org/projects/peps/trunk)*

我明白了：

> 验证位置时出错：“org.tigris.subversion.javahl.ClientException：RA 层请求失败 svn：‘ [http](http://svn.python.org/projects/peps/trunk) ://svn.python.org/projects/peps/trunk’的选项：无法连接到服务器（[http:// /svn.python.org](http://svn.python.org) ) " 仍然保留位置吗？

我知道我的 Eclipse 可以连接到 Internet，因为我之前下载了 Subclipse（我不得不更改我的代理设置）。

对于我尝试添加的其他 SVN 位置，我收到了类似的消息。

解决办法是什么？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-08-15T02:58:10.043

它对我有用，在 Eclipse 中：Window > Preference > Team > SVN：选择**SVNKit (Pure Java)**而不是**JavaHL(JNI)**

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2010-06-08T18:45:59.787

这是一个死话题，但解决方案是安装客户端适配器和 Subclipse。

看看[这个](http://subclipse.tigris.org/wiki/PluginFAQ#head-da671f9d3dd97d874248445af428545727a8271a)，安装 SVN Client Adapter、SVNKit Adapter 和 SVNKit Library。

然后在 Window -> Preference -> Team -> SVN 下检查并确保有一个 SVN Interface 条目。

并且为了以后参考，如果可以通过命令行连接到仓库，那么一定是IDE有问题。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-12-29T13:42:55.080

在我的日常工作中，我坐在公司防火墙后面，保护和缓存网络流量（除其他外）。在大多数情况下，它不会碍事。但有时它会抬起丑陋的脑袋，坚定地站在我想要做的事情的道路上。

本周早些时候，我试图研究一个很酷的新的 ColdFusion 通用验证系统，称为 Validat，由 Alagad 的伟人推出。他们还没有在 RIAForge 网站上下载，但可以通过 SVN 获得这些文件。我将 subclipse 插件加载到我的 Eclipse 中，重新启动并开始添加 Validat SVN 存储库。我开始收到有关“RA 层请求失败”和“svn：PROPFIND 请求在 /Validat/trunk 上失败”的错误，然后是有关无法连接到 SVN 服务器的错误。

我已经使用代理设置进行了 Eclipse 设置，所以我认为我做错了什么，或者 Alagad 实际上并没有启动和可用的 subversion 存储库。那天晚上回家后，我在家里试了一下，哇，它奏效了。愚蠢的代理服务器！所以 subclipse 插件不会使用 Eclipse 代理设置。（可以解决请！）。在挖掘了 subclipse 帮助站点并被重定向到 collab.net 帮助之后，然后徒劳地在 eclipse 工作区、插件和配置文件夹中搜索设置文件，我终于能够弄清楚如何设置 subclipse 以使用代理服务器。

在我的 Windows 开发环境中，我在我最喜欢的文本编辑器中打开了以下文件：C:\Documents and Settings\MyUserId\Application Data\Subversion\servers。该文件底部附近是一个 [global] 部分，其中包含 http-proxy-host 和 http-proxy-port 设置。我取消了这两行的注释，为我的公司代理服务器修改了它们，回到 Eclipse 中的 SVN 存储库视图，刷新了 Validat 存储库和 Boom！有效！

来自[http://www.mkville.com/blog/index.cfm/2007/11/8/Using-Subclipse-Behind-a-Proxy-Server](http://www.mkville.com/blog/index.cfm/2007/11/8/Using-Subclipse-Behind-a-Proxy-Server)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-18T12:28:22.157

我怀疑 Subclipse 然后 SVN 可以使用您的 Eclipse 代理设置。您可能需要为您的 SVN 程序本身设置代理。尝试从命令行使用 SVN 检查文件应该会告诉您这是否有效。

如果 SVN 也无法连接，则将代理设置放在 Subversion 设置文件夹（在您的主文件夹中）的服务器文件中。

如果即使设置了代理设置也无法做到这一点，那么您的防火墙可能阻止了 Subversion 下载文件所需的方法和协议。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-17T17:29:03.470

尝试使用命令行 SVN 连接到存储库，看看是否会收到类似的错误。

```
$ svn checkout http://svn.python.org/projects/peps/trunk 
```

如果您不断收到错误消息，则可能是您的代理服务器存在问题。我发现我无法在工作中查看基于 Internet 的 SVN 项目，因为防火墙会阻止大多数 HTTP 命令。它只允许 GET、POST 和其他浏览所需的内容。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-02-10T13:51:55.747

当尝试从 Eclipse 连接到 Collabnet 颠覆时，我也遇到了与他原始帖子中描述的“彼得希尔顿”相同的错误。我在 windows->Preferences->General->Network Connections 中将 Active Provided 的设置从“Native”更改为“manual”。这对我有用。我认为这是一个代理问题，但我的旧设置 eclipse 连接到我从那里下载颠覆插件的互联网。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-17T19:09:26.210

它可能对您没有什么帮助，但是我将该 URL 输入到 Subclipse 中，并且存储库添加得很好，我可以在其上浏览和显示历史记录。

您可能需要配置代理吗？您必须在 Subversion 运行时配置区域中进行配置，因为 Subclipse 使用 Subversion 库连接到服务器。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-17T17:55:09.087

在这个 Eclipse 实例中你有任何工作存储库吗？

我过去在 Windows 上使用默认的 Subclipse subversion 客户端时遇到过问题，如果你想使用默认的，你需要确保本地 subversion 客户端已安装并正确配置（我过去有 TortoiseSVN 可以工作）客户端适配器。

在最近的一次安装中，我尝试了“测试版”驱动程序（我有 Eclipse Ganymede 和“SVNKit (Pure Java) SVNKit v1.2.0.4502”），您可以选择使用 Subclipse 安装它们，它们开箱即用，虽然一位同事发现他必须经历一些困难才能确保 Eclipse 正确安装了它们（及其依赖项）。

以下是出现在“帮助”->“软件更新”->“已安装软件”中的软件包：

```
Subclipse                  1.4.0
Subversion Client Adapter  1.5.0.1
SVNKit Client Adapter      1.5.0.1
SVNKit Library             1.2.0.4502 
```

这些现在可能有点过时了，最新版本可能会更好，但这是我现在可以看到的。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-04-18T13:34:13.273

我有同样的问题。McAFee 阻止了日食。在管理器 McAFee > 防火墙 > progamas 互联网连接中解决它 > 找到 eclipse 并允许完全访问。

问候

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-12-19T17:06:10.647

我遇到了这个问题，正如前面提到的，我更改了“C:\Users\userid\AppData\Roaming\Subversion”中 Subversion 文件夹下的“servers”文件。在那里，在文件的底部，有一个 [global] 部分。我删除了评论

http-proxy-host
http-proxy-port
http-proxy-username
http-proxy-password

我设置了那些人，它奏效了！:-)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2011-08-22T04:43:50.017

我在更改我的 SVN 密码时发现了这个问题。

如何解决首先，删除 {Documents and Settings}{user login}\Application Data\Subversion 中的 Subversion 文件夹 -> 它不起作用

之后，将我当前的用户登录配置文件从 {Documents and Settings}{user login} 重命名为 {Documents and Settings}{user login}_bakup 并登录 agian -> 它工作...

我假设 -> SVN 或 JavaHL 将授权用户与 {user login} 绑定或将其保存在窗口的用户配置文件中。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-05-07T05:46:13.730

您可能想检查 VPN 客户端的网络安全是否存在问题。我卸载了它，它工作正常..在这里找到解决方案 [https://superuser.com/questions/471089/svn-connection-not-successful](https://superuser.com/questions/471089/svn-connection-not-successful)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2011-12-02T13:51:36.580

Necropost，但很有帮助：我遇到了一个 RA 请求失败的问题，因为文件“已经存在于服务器上”但不会与我的存储库同步。我转到磁盘上的源代码，在那里删除，刷新了我的 Eclipse 视图，并更新了源代码。错误消失了。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2013-03-08T02:16:11.643

在我的情况下是访问问题。我需要将协议更改为 svn+ssh 而不是 http。

例如，而不是 [http://svn.python.org/projects/peps/trunk](http://svn.python.org/projects/peps/trunk)

试试 svn+ssh://svn.python.org/projects/peps/trunk

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2011-10-14T22:18:40.813

我看到了同样的错误，并通过关闭 TortoiseSVN 中的代理设置来解决，我通常需要提交到公司服务器。我安装了 Subclipse 以将我自己的非黄金时间的东西备份到本地存储库（使用 VisualSVN）。我使用 Eclipse Galileo 3.3 和 Subclipse 1.6.12。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2019-01-17T09:57:14.023

在我的情况下，我在尝试从 SVN repo 签出项目时遇到类似的异常，它提示输入用户名和密码，并且我每次都输入错误的用户名，当我提供**正确的用户名和密码**时，它开始正常工作.. ......这样一个简单而难以停止的信息......

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2017-05-04T15:26:16.997

我和你有完全相同的问题。我在我的 Windows 上安装了 TortoiseSVN，我也安装了 eclipse，在 eclipse 中，我安装了 subclipse 1.4。

这是我有代理设置的问题，我可以通过网络浏览器打开 repo，由于某种原因，我无法通过 svn 打开 repo。我尝试按照下面的链接更改代理[Eclipse Kepler not connected to internet via proxy](https://stackoverflow.com/questions/17338212/eclipse-kepler-not-connecting-to-internet-via-proxy)。它不起作用。

最后我找到了解决方案

您必须更改 TortoiseSVN 中的代理设置。在我启用与我的浏览器相同的代理设置后。问题消失了。

这是如何在 TortoiseSVN 中启用代理设置的链接 [https://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-dug-settings.html](https://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-dug-settings.html) 在上面的页面上搜索“网络设置”

# perl - perl中的反向DNS查找

> ID：85487
> 
> 赞同：12
> 
> 时间：2008-09-17T17:14:01.120
> 
> 标签：perl, ip, lookup, nslookup, reverse-dns

如何执行反向 DNS 查找，即如何在 Perl 中将 IP 地址解析为其 DNS 主机名？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-09-17T17:32:13.853

如果您需要更详细的 DNS 信息，请使用[Net::DNS](http://search.cpan.org/~olaf/Net-DNS-0.63/lib/Net/DNS.pm)模块，这是一个示例：

```
use Net::DNS;
my $res = Net::DNS::Resolver->new;

# create the reverse lookup DNS name (note that the octets in the IP address need to be reversed).
my $IP = "209.85.173.103";
my $target_IP = join('.', reverse split(/\./, $IP)).".in-addr.arpa";

my $query = $res->query("$target_IP", "PTR");

if ($query) {
  foreach my $rr ($query->answer) {
    next unless $rr->type eq "PTR";
    print $rr->rdatastr, "\n";
  }
} else {
  warn "query failed: ", $res->errorstring, "\n";
} 
```

原始来源[EliteHackers.info](https://www.elitehackers.info/forums/archive/index.php/t-824.html)，还有更多细节。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2008-09-17T17:15:58.370

gethostbyaddr 和类似的调用。看[http://perldoc.perl.org/functions/gethostbyaddr.html](http://perldoc.perl.org/functions/gethostbyaddr.html)

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-09-17T17:22:49.897

```
use Socket;
$iaddr = inet_aton("127.0.0.1"); # or whatever address
$name  = gethostbyaddr($iaddr, AF_INET); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-10-09T23:51:39.830

```
perl -MSocket -E 'say scalar gethostbyaddr(inet_aton("69.89.27.250"), AF_INET)' 
```

返回：**在 -e 第 1 行的 EOF 之前的任何地方都找不到字符串终止符“'”。**

```
perl -MSocket -E "say scalar gethostbyaddr(inet_aton(\"69.89.27.250\"), AF_INET)" 
```

返回：**box250.bluehost.com**

我必须更改行以使用双引号，然后转义 IP 地址周围的引号

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-09-03T13:29:46.180

单线：

```
perl -MSocket -E 'say scalar gethostbyaddr(inet_aton("79.81.152.79"), AF_INET)' 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-17T17:17:12.470

可能有更简单的方法，但是对于 IPv4，如果您可以执行普通的 DNS 查找，您总是可以自己构造反向查询。对于 IPv4 地址 ABCD，请在 DCBAin-addr.arpa 中查找任何 PTR 记录。对于 IPv6，您获取 128 个十六进制半字节并将它们翻转并附加 ipv6.arpa。并做同样的事情。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-17T17:22:03.377

如果 gethostbyaddr 不能满足您的需求，[Net::DNS](http://search.cpan.org/perldoc?Net::DNS)会更灵活。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-18T22:25:35.323

这可能有用...

```
$ip = "XXX.XXX.XXX.XXX" # IPV4 address.
my @numbers = split (/\./, $ip);
if (scalar(@numbers) != 4)
{
    print "$ip is not a valid IP address.\n";
    next;
}
my $ip_addr = pack("C4", @numbers);
# First element of the array returned by gethostbyaddr is host name.
my ($name) = (gethostbyaddr($ip_addr, 2))[0]; 
```

# asp.net-ajax - AJAX - 如何将值传递回服务器

> ID：85500
> 
> 赞同：5
> 
> 时间：2008-09-17T17:15:26.497
> 
> 标签：asp.net-ajax, asynchronous

第一次在 .NET 中使用 UpdatePanels。

我有一个带有指向 FormView 控件上的事件的触发器的更新面板。UpdatePanel 拥有一个 ListView，其中包含来自单独数据库的相关数据。

当 UpdatePanel 刷新时，它需要来自 FormView 控件的值，以便在服务器上它可以使用它们来查询数据库。

对于我的生活，我无法弄清楚如何获得这些价值观。我触发的事件有它们，但我希望更新面板异步刷新。如何将值传递给面板上的加载事件？

谷歌搜索了这个令人作呕的广告，似乎无法在这里找到答案。链接或解释将非常有帮助..

杰夫

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-17T19:10:57.687

创建一个 javascript 函数来收集表单数据，然后将该数据发送到 ASHX 处理程序。ASHX 处理程序将做一些工作，并可以回复一个响应。

这是我制作的一个示例，它调用数据库以使用 AJAX 调用填充网格。有更好的 AJAX 库（原型、ExtJS 等），但这是原始交易。（我***知道***这可以重构得更干净，但你可以很好地理解这个想法）

像这样工作...

*   用户在搜索框中输入文本，
*   用户点击搜索按钮，
*   JavaScript 获取表单数据，
*   javascript 对 ASHX 进行 ajax 调用，
*   ASHX 收到请求，
*   ASHX 查询数据库，
*   ASHX 将响应解析为 JSON/Javascript 数组，
*   ASHX 发送响应，
*   Javascript 收到响应，
*   javascript Eval() 对对象的响应，
*   javascript迭代对象属性并填充网格

html 将如下所示...

```
<html xmlns="http://www.w3.org/1999/xhtml" >
<head runat="server">
    <title>Untitled Page</title>
    <script type="text/javascript" src="AjaxHelper.js"></script>
</head>
<body>
    <form id="form1" runat="server">
    <div>
        <asp:TextBox ID="txtSearchValue" runat="server"></asp:TextBox>
        <input id="btnSearch" type="button" value="Search by partial full name" onclick="doSearch()"/>

        <igtbl:ultrawebgrid id="uwgUsers" runat="server" 
//infragistics grid crap
            </igtbl:ultrawebgrid>--%>
    </div>
    </form>
</body>
</html> 
```

单击时触发的脚本将如下所示...

```
//this is tied to the button click. It takes care of input cleanup and calling the AJAX method
function doSearch(){
    var eleVal; 
    var eleBtn;
    eleVal = document.getElementById('txtSearchValue').value;
    eleBtn = document.getElementById('btnSearch');
    eleVal = trim(eleVal);
    if (eleVal.length > 0) {
        eleBtn.value = 'Searching...';
        eleBtn.disabled = true;
        refreshGridData(eleVal);
    }
    else {
        alert("Please enter a value to search with. Unabated searches are not permitted.");
    }
}

//This is the function that will go out and get the data and call load the Grid on AJAX call 
//return.
function refreshGridData(searchString){

    if (searchString =='undefined'){
        searchString = "";
    }

    var xhr; 
    var gridData;
    var url;

    url = "DefaultHandler.ashx?partialUserFullName=" + escape(searchString);
    xhr = GetXMLHttpRequestObject();

    xhr.onreadystatechange = function() {
        if (xhr.readystate==4) {
            gridData = eval(xhr.responseText);
            if (gridData.length > 0) {
                //clear and fill the grid
                clearAndPopulateGrid(gridData);
            }
            else {
                //display appropriate message
            }
        } //if (xhr.readystate==4) {
    } //xhr.onreadystatechange = function() {

    xhr.open("GET", url, true);
    xhr.send(null);
}

//this does the grid clearing and population, and enables the search button when complete.
function clearAndPopulateGrid(jsonObject) {

    var grid = igtbl_getGridById('uwgUsers');
    var eleBtn;
    eleBtn = document.getElementById('btnSearch');

    //clear the rows
    for (x = grid.Rows.length; x >= 0; x--) {
        grid.Rows.remove(x, false);
    }

    //add the new ones
    for (x = 0; x < jsonObject.length; x++) {
        var newRow = igtbl_addNew(grid.Id, 0, false, false);
        //the cells should not be referenced by index value, so a name lookup should be implemented
        newRow.getCell(0).setValue(jsonObject[x][1]); 
        newRow.getCell(1).setValue(jsonObject[x][2]);
        newRow.getCell(2).setValue(jsonObject[x][3]);
    }

    grid = null;

    eleBtn.disabled = false;
    eleBtn.value = "Search by partial full name";
}

// this function will return the XMLHttpRequest Object for the current browser
function GetXMLHttpRequestObject() {

    var XHR; //the object to return
    var ua = navigator.userAgent.toLowerCase(); //gets the useragent text
    try
    {
        //determine the browser type
        if (!window.ActiveXObject)
        { //Non IE Browsers
            XHR = new XMLHttpRequest(); 
        }
        else 
        {
            if (ua.indexOf('msie 5') == -1)
            { //IE 5.x
                XHR = new ActiveXObject("Msxml2.XMLHTTP");
            }
            else
            { //IE 6.x and up  
                XHR = new ActiveXObject("Microsoft.XMLHTTP");   
            }
        } //end if (!window.ActiveXObject)

        if (XHR == null)
        {
            throw "Unable to instantiate the XMLHTTPRequest object.";
        }
    }
    catch (e)
    {
        alert("This browser does not appear to support AJAX functionality. error: " + e.name
              + " description: " + e.message);
    }
    return XHR;
} //end function GetXMLHttpRequestObject()

function trim(stringToTrim){
    return stringToTrim.replace(/^\s\s*/, '').replace(/\s\s*$/, '');
} 
```

ashx 处理程序看起来像这样....

```
Imports System.Web
Imports System.Web.Services
Imports System.Data
Imports System.Data.SqlClient

Public Class DefaultHandler
    Implements System.Web.IHttpHandler

    Private Const CONN_STRING As String = "Data Source=;Initial Catalog=;User ID=;Password=;"

    Sub ProcessRequest(ByVal context As HttpContext) Implements IHttpHandler.ProcessRequest

        context.Response.ContentType = "text/plain"
        context.Response.Expires = -1

        Dim strPartialUserName As String
        Dim strReturnValue As String = String.Empty

        If context.Request.QueryString("partialUserFullName") Is Nothing = False Then
            strPartialUserName = context.Request.QueryString("partialUserFullName").ToString()

            If String.IsNullOrEmpty(strPartialUserName) = False Then
                strReturnValue = SearchAndReturnJSResult(strPartialUserName)
            End If
        End If

        context.Response.Write(strReturnValue)

    End Sub

    Private Function SearchAndReturnJSResult(ByVal partialUserName As String) As String

        Dim strReturnValue As New StringBuilder()
        Dim conn As SqlConnection
        Dim strSQL As New StringBuilder()
        Dim objParam As SqlParameter
        Dim da As SqlDataAdapter
        Dim ds As New DataSet()
        Dim dr As DataRow

        'define sql
        strSQL.Append(" SELECT ")
        strSQL.Append("     [id] ")
        strSQL.Append("     ,([first_name] + ' ' + [last_name]) ")
        strSQL.Append("     ,[email] ")
        strSQL.Append(" FROM [person] (NOLOCK) ")
        strSQL.Append(" WHERE [last_name] LIKE @lastName")

        'clean up the partial user name for use in a like search
        If partialUserName.EndsWith("%", StringComparison.InvariantCultureIgnoreCase) = False Then
            partialUserName = partialUserName & "%"
        End If

        If partialUserName.StartsWith("%", StringComparison.InvariantCultureIgnoreCase) = False Then
            partialUserName = partialUserName.Insert(0, "%")
        End If

        'create the oledb parameter... parameterized queries perform far better on repeatable
        'operations
        objParam = New SqlParameter("@lastName", SqlDbType.VarChar, 100)
        objParam.Value = partialUserName

        conn = New SqlConnection(CONN_STRING)
        da = New SqlDataAdapter(strSQL.ToString(), conn)
        da.SelectCommand.Parameters.Add(objParam)

        Try 'to get a dataset. 
            da.Fill(ds)
        Catch sqlex As SqlException
            'Throw an appropriate exception if you can add details that will help understand the problem.
            Throw New DataException("Unable to retrieve the results from the user search.", sqlex)
        Finally
            If conn.State = ConnectionState.Open Then
                conn.Close()
            End If
            conn.Dispose()
            da.Dispose()
        End Try

        'make sure we have a return value
        If ds Is Nothing OrElse ds.Tables(0) Is Nothing OrElse ds.Tables(0).Rows.Count <= 0 Then
            Return String.Empty
        End If

        'This converts the table into JS array. 
        strReturnValue.Append("[")

        For Each dr In ds.Tables(0).Rows
            strReturnValue.Append("['" & CStr(dr("username")) & "','" & CStr(dr("userfullname")) & "','" & CStr(dr("useremail")) & "'],")
        Next

        strReturnValue.Remove(strReturnValue.Length - 1, 1)
        strReturnValue.Append("]")

        'de-allocate what can be deallocated. Setting to Nothing for smaller types may
        'incur performance hit because of a forced allocation to nothing before they are deallocated
        'by garbage collection.
        ds.Dispose()
        strSQL.Length = 0

        Return strReturnValue.ToString()

    End Function

    ReadOnly Property IsReusable() As Boolean Implements IHttpHandler.IsReusable
        Get
            Return False
        End Get
    End Property

End Class 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T17:20:54.393

尝试

*   ...查看请求和响应。
*   ...在 Load() 方法上设置断点并在监视或即时窗口中查询 Me 或 this 以查看您想要的值是否可能不在您期望的位置？
*   ...在 Me/This.Controls 中放置一个（For Each ctl as Control in Me/This.Controls）并检查每个迭代的控件，看看您是否获得了您期望的控件。
*   ...它不在 Sender 或 EventArgs 中？

尽量不要使用更新面板....它们通常会造成比其价值更多的麻烦。使用常规的 AJAX 来完成它可能会更快、更容易。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T17:49:10.160

如果您正在使用 UpdatePanel，只需确保两个控件都在面板内，并且它将按需要工作。

# c# - 如果我在 Visual Studio 中选择“转换为 Web 应用程序”选项有什么作用？

> ID：85513
> 
> 赞同：23
> 
> 时间：2008-09-17T17:16:02.317
> 
> 标签：c#, asp.net, visual-studio

如果我在 Visual Studio 中选择“转换为 Web 应用程序”选项有什么作用？如果我确实将我的网站转换为 Web 应用程序，有什么优势？我可以回去吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-17T17:26:17.283

好吧，它将您的网站转换为 Web 应用程序项目。至于优点，这里有一些进一步的阅读：

MSDN 比较 --[比较网站项目和 Web 应用程序项目](http://msdn.microsoft.com/en-us/library/aa730880(VS.80).aspx#wapp_topic5)

ASP.NET 上的网络广播[——Visual Studio 2008 中的 Web 应用程序项目与网站项目](http://www.asp.net/LEARN/webcasts/webcast-236.aspx)

*“在此网络广播中，应要求，我们检查了 Microsoft Visual Studio 2008 中的 Web 应用程序项目和网站项目之间的差异。我们特别关注您选择其中一个项目的原因，并解释如何在创建 Web 时做出明智的决定解决方案*“

Web 应用程序项目和网站之间的主要区别（对我来说）是编译的方式。在网站中，每个页面都将其代码隐藏编译到一个单独的库中，而在 Web 应用程序中，所有代码隐藏都编译到一个库中。

两者都有优点和缺点，这真的取决于。这也常常是见仁见智的[问题](http://blog.madskristensen.dk/post/Web-Application-Projects-vs-Web-Site-Projects.aspx)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-17T17:36:29.753

[还回答了这里](https://stackoverflow.com/questions/43019/what-does-vs-2008s-convert-to-website-mean)所以去投票那个答案，不是这个。**不要给我信用**

> ASP.NET 中有两种类型的 Web 应用程序：网站和 Web 应用程序项目。两者的区别在这里讨论：
> 
> [Visual Studio 2005 中网站和 Web 应用程序之间的区别](http://www.dotnetspider.com/resources/1520-Difference-between-web-site-web-application.aspx)
> 
> 转换为网站允许您将 Web 应用程序项目转换为网站。
> 
> Visual Studio 2003 使用 Web 应用程序项目样式，但最初 VS2005 仅支持网站。VS2005 SP1 带回了 Web 应用程序。
> 
> 如果您不想将项目转换为网站，如果您使用的是 VS2005，请应用 SP1。VS2008 都可以支持。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-09-06T03:42:15.397

即使您的项目是作为项目（不是网站）启动的，Visual Studio 2010 也会显示此选项。这可能是 VS 2010 的错误。

# silverlight - 用于 Silverlight 2 的 TileBrush？

> ID：85517
> 
> 赞同：4
> 
> 时间：2008-09-17T17:16:16.777
> 
> 标签：silverlight

您可能知道，Silverlight 没有 WPF 中的 TileBrush。是否有解决方法来进行平铺？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-18T06:08:38.320

根据[Silverlight 论坛的贡献者](http://silverlight.net/forums/t/84987.aspx)

> Silverlight（2 和 3）中的 TileBrush 只是一个占位符类，可用于未来扩展和 WPF 兼容性

现在提出了一个 PixelShader 解决方法，您可以在[此处找到该描述](http://www.silverlightplayground.org/post/2009/03/22/Silverlight-30-Tile-Effect-with-a-Pixel-Shader.aspx)

有人请编辑我的帖子！:-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T11:54:07.870

好吧，Silverlight 似乎确实支持 TileBrush，如 MSDN 中所引用： [System.Windows.Media.TileBrush](http://msdn.microsoft.com/en-us/library/system.windows.media.tilebrush(VS.95).aspx)。它首次出现在 Silverlight 2.0 Beta 2 中。

# php - PHP DOMDocument 剥离 HTML 标签

> ID：85520
> 
> 赞同：5
> 
> 时间：2008-09-17T17:16:45.030
> 
> 标签：php

我正在开发一个小型模板引擎，并且正在使用 DOMDocument 来解析页面。到目前为止，我的测试页面如下所示：

```
<block name="content">

   <?php echo 'this is some rendered PHP! <br />' ?>

   <p>Main column of <span>content</span></p>

</block> 
```

我的部分课程如下所示：

```
private function parse($tag, $attr = 'name')
{
    $strict = 0;
    /*** the array to return ***/
    $out = array();
    if($this->totalBlocks() > 0)
    {
        /*** a new dom object ***/
        $dom = new domDocument;
        /*** discard white space ***/
        $dom->preserveWhiteSpace = false;

        /*** load the html into the object ***/
        if($strict==1)
        {
            $dom->loadXML($this->file_contents);
        }
        else
        {
            $dom->loadHTML($this->file_contents);
        }

        /*** the tag by its tag name ***/
        $content = $dom->getElementsByTagname($tag);

        $i = 0;
        foreach ($content as $item)
        {
            /*** add node value to the out array ***/
            $out[$i]['name'] = $item->getAttribute($attr);
            $out[$i]['value'] = $item->nodeValue;
            $i++;
        }
    }

    return $out;
} 
```

我让它按照我想要的方式工作，因为它抓取页面上的每个 <block> 并将其内容注入我的模板中，但是，它正在剥离 <block> 中的 HTML 标签，因此返回没有 <p> 的以下内容或 <span> 标签：

```
this is some rendered PHP! Main column of content 
```

我在这里做错了什么？：） 谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-17T17:21:54.127

什么都没有：nodeValue 是树的值部分的串联，永远不会有标签。

在 $node 下制作树的 HTML 片段我会做的是：

```
 $doc = new DOMDocument();
foreach($node->childNodes as $child) {
    $doc->appendChild($doc->importNode($child, true));
}
return $doc->saveHTML(); 
```

HTML“片段”实际上比你一开始想的更成问题，因为它们往往缺少诸如文档类型和字符集之类的东西，这使得很难确定地在 DOM 树的部分和 HTML 片段之间来回切换。

# sql - 从 MySQL 迁移到任意符合标准的 SQL2003 服务器

> ID：85522
> 
> 赞同：2
> 
> 时间：2008-09-17T17:16:51.813
> 
> 标签：sql, mysql, mysqldump

是否有 mysqldump 或类似工具的咒语会产生一段 SQL2003 代码来在任意符合 SQL2003 的 RDBMS 中创建和填充相同的数据库？

（我现在正在尝试的是 MonetDB）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-18T09:10:26.547

DDL 语句本质上是特定于数据库供应商的。尽管它们具有相同的基本结构，但每个供应商对如何定义类型、索引、约束等都有自己的看法。

另一方面，DML 语句是相当可移植的。因此我建议：

*   转储没有任何数据的数据库（mysqldump --no-data）以获取架构
*   进行必要的更改以将架构加载到另一个数据库上 - 这些需要手动完成（但可能会进行一些搜索/替换）
*   转储数据并关闭扩展插入且不创建表 (--extended-insert=0 --no-create-info)
*   针对另一个数据库运行生成的脚本。

这应该做你想要的。

但是，当将应用程序移植到不同的数据库供应商时，还需要做许多其他事情；移动架构和数据很容易。检查引入的错误，不同的行为和性能测试是困难的。

至少测试应用程序中的每个查询在新数据库上的有效性。理想情况下做更多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T17:58:08.797

这个有点难。除非你有一个非常简单的带有普通类型（varchar、整数等）的数据库结构，否则你可能会在编写迁移工具时获得最好的结果。在像 Perl 这样的语言中（通过 DBI），这非常简单。该程序基本上是一个回显循环，它从一个数据库读取并插入另一个数据库。Google 知道有一些此类代码的示例。

除了移动数据的明显问题之外，还有一些数据类型如何表示的更微妙的问题。例如，MS SQL 的日期时间字段与 MySQL 的格式不同。其他数据类型（如 BLOB）在一个 RDBM 中的容量可能与另一种不同。您应该确保在移植之前非常了解目标数据库系统的数据类型定义。

当然，最后一个问题是让应用程序级别的 SQL 语句在新系统上运行。在我的工作中，这是迄今为止最困难的部分。日期数学似乎特别针对 DB，而诸如引用规则之类的烦人的事情一直是令人烦恼的根源。

祝你的项目好运。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T17:46:03.023

在 SQL Server 2000 或 2005 中，您可以让它为您的对象生成脚本，但我不确定它们将如何传输到其他 RDBMS。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T17:50:49.283

生成脚本选项可能是最简单的方法。不过，您无疑必须对一些数据类型进行一些搜索/替换。

# configuration - Faces Servlet 抛出异常 java.lang.StackOverflowError

> ID：85532
> 
> 赞同：7
> 
> 时间：2008-09-17T17:18:13.607
> 
> 标签：configuration, jboss, seam, web-applications

好的，自从加入这个网站以来，我遇到了我的第一个 StackOverflowError，我认为这是必须发布的 :-)。我的环境是 Seam 2.0.1.GA，JBoss 4.2.2.GA，我正在使用 JSF。我正在从 facelets 视图转换为 JSP，以利用我们现有站点上使用的一些现有 JSP 标记。我更改了 faces-config.xml 和 web.xml 配置文件，并在尝试呈现 jsp 页面时开始收到以下错误。有人有什么想法吗？

> 2008-09-17 09:45:17,537 调试 [org.jboss.seam.contexts.FacesLifecycle] 开始 JSF 请求 /form_home.jsp 2008-09-17 09:45:17,587 错误 [org.apache.catalina.core. ContainerBase.[jboss.web].[localhost].[/].[Faces Servlet]] Servlet.service() for servlet Faces Servlet 在 org.apache.catalina.core.ApplicationHttpRequest.getAttribute( ApplicationHttpRequest.java:210) 在 org.apache.catalina.core.ApplicationHttpRequest.getAttribute(ApplicationHttpRequest.java:222) 在 org.apache.catalina.core.ApplicationHttpRequest.getAttribute(ApplicationHttpRequest.java:222) 在 org.apache.catalina .core.ApplicationHttpRequest.getAttribute(ApplicationHttpRequest.java:222) ...

我的 faces-config.xml 文件现在是空的，没有 FaceletsViewHandler：

```
<?xml version="1.0" encoding="UTF-8"?>
<faces-config version="1.2" xmlns="http://java.sun.com/xml/ns/javaee"
 xmlns:xi="http://www.w3.org/2001/XInclude"
 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
 xsi:schemaLocation="http://java.sun.com/xml/ns/javaee  
   http://java.sun.com/xml/ns/javaee/web-facesconfig_1_2.xsd">

</faces-config> 
```

还有我的 Web.xml 文件：

```
<?xml version="1.0"?>
<web-app version="2.5" xmlns="http://java.sun.com/xml/ns/javaee"
 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
 xsi:schemaLocation="http://java.sun.com/xml/ns/javaee 
  http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd">
 <!-- Ajax4jsf -->
 <context-param>
  <param-name>org.richfaces.SKIN</param-name>
  <param-value>blueSky</param-value>
 </context-param>
  <!-- Seam -->
 <listener>
  <listener-class>org.jboss.seam.servlet.SeamListener</listener-class>
 </listener>

 <filter>
  <filter-name>Seam Filter</filter-name>
  <filter-class>org.jboss.seam.servlet.SeamFilter</filter-class>
 </filter>

 <filter-mapping>
  <filter-name>Seam Filter</filter-name>
  <url-pattern>*.jsp</url-pattern>
 </filter-mapping>

 <servlet>
    <servlet-name>Seam Resource Servlet</servlet-name>
     <servlet-class>org.jboss.seam.servlet.SeamResourceServlet
     </servlet-class>
 </servlet>
 <servlet-mapping>
   <servlet-name>Seam Resource Servlet</servlet-name>
   <url-pattern>/seam/resource/*</url-pattern>
 </servlet-mapping>
 <!-- Seam end --> 

 <!-- JSF -->
 <context-param>
        <param-name>javax.faces.DEFAULT_SUFFIX</param-name>
        <param-value>.jsp</param-value>
 </context-param>

 <servlet>
    <servlet-name>Faces Servlet</servlet-name>
    <servlet-class>javax.faces.webapp.FacesServlet</servlet-class>
    <load-on-startup>1</load-on-startup>
 </servlet>
 <servlet-mapping>
    <servlet-name>Faces Servlet</servlet-name>
    <url-pattern>*.jsp</url-pattern> 
 </servlet-mapping> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-23T16:37:29.760

我能够弄清楚这个问题。显然，您不能将 web.xml 配置为具有与 Faces Servlet url-pattern (*.jsp) 相同的 Javax.faces.DEFAULT_SUFFIX 的 .jsp 参数值。如果您将 url-pattern 更改为*.jspx 或 /whateverdirnameyouwant/*，则应用程序启动时不会出现堆栈溢出错误。（注意：关键是 DEFAULT_SUFFIX 和 Faces Servlet url-pattern 不能相同，无论它们是什么。）希望这有助于其他遇到此特定问题的人。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T05:12:55.697

java中的堆栈溢出几乎总是由无限递归/方法调用引起的。在您给出堆栈跟踪的情况下，似乎'getAttribute（）'被重复调用直到崩溃。虽然我对您使用的特定环境并不十分熟悉，但我建议您检查您的 .jsp 代码中是否存在任何此类行为（例如两个相互调用的方法）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-10-23T16:32:38.790

所以，我有一个类似的错误。对我来说，这是因为我有一个 JSF 项目并且我在搞乱文件扩展名。首先，我拥有所有扩展名为 .jsp 的 Web 文件。这是可行的，但后来我希望它们都是 .jsf，然后我全力以赴使用 .xhtml。在此过程中，我的 web.xml 文件更改为容纳 xhtml 和 jsf。更改 web.xml 文件很好。StackOverflowError 是什么让我得到了我的 index.xhtml 和一个指向 header.jsf 的 ui.include 标记。所以我有一个指向 jsf 文件的 xhtml 文件。我原以为 web.xml 能够处理这个问题，但它没有，我得到了 StackOverflowError。所以，为了解决这个问题，现在我所有的 JSF 文件都有扩展名 .xhtml，并且嵌套的 ui:include 标记指向 .xhtml 文件。

但另一方面，浏览器 url 可以很好地处理 index.jsp、index.jsf、index.xhtml。所以 web.xml（带有 jsp、jsf 和 xhtml 的 servlet 映射）可以很好地处理浏览器 url，但不能解决我上面突出显示的问题。

# java - 如何使用“ensureIndexIsVisible”使 Swing 滚动？

> ID：85548
> 
> 赞同：1
> 
> 时间：2008-09-17T17:20:16.173
> 
> 标签：java, swing

当我运行此代码时，所选项目不可见。我已经尝试在没有运气的单独线程中运行它。

```
import javax.swing.JFrame;
import java.awt.Container;
import javax.swing.JList;
import javax.swing.ListSelectionModel;
import javax.swing.JScrollPane;
import java.awt.Dimension;

public class ScrollList extends JFrame {
    int defaultValue;

    ScrollList() {
        Container cp = getContentPane();
        JList list = createList();
        defaultValue = 20;

        cp.add(createScrollPane(list));
        pack();
        setVisible(true);
        list.ensureIndexIsVisible(defaultValue);
    }

    JList createList() {
        Integer[] model = new Integer[73];
        JList list = new JList(model);

        for (int i = 1; i < model.length; i++)
            model[i] = i;
        list.setSelectedIndex(defaultValue);

        return list;
    }

    JScrollPane createScrollPane(JList list) {
        JScrollPane s = new JScrollPane(createList());

        s.setVerticalScrollBarPolicy(JScrollPane.VERTICAL_SCROLLBAR_ALWAYS);
        s.setPreferredSize(new Dimension(100, 200));

        return s;
    }

    public static void main(String[] args) {
        new ScrollList();
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-17T17:25:01.733

我想到了！！

这是代码：

```
import javax.swing.JFrame;
import java.awt.Container;
import javax.swing.JList;
import javax.swing.ListSelectionModel;
import javax.swing.JScrollPane;
import java.awt.Dimension;

public class ScrollList extends JFrame {
    final int defaultValue = 20;

    ScrollList() {
        setDefaultCloseOperation(DISPOSE_ON_CLOSE);
        Container cp = getContentPane();
        JList list = createList();

        cp.add(createScrollPane(list));
        pack();
        list.ensureIndexIsVisible(list.getSelectedIndex());

        setVisible(true);
    }

    JList createList() {
        Integer[] model = new Integer[73];
        JList list = new JList(model);

        for (int i = 1; i < model.length; i++)
            model[i] = i;
        list.setSelectedIndex(defaultValue);
        return list;
    }

    JScrollPane createScrollPane(JList list) {
        JScrollPane s = new JScrollPane(list); // MAJOR FIX HERE!
        s.setVerticalScrollBarPolicy(JScrollPane.VERTICAL_SCROLLBAR_ALWAYS);
        s.setPreferredSize(new Dimension(100, 200));
        return s;
    }

    public static void main(String[] args) {
        new ScrollList();
    }
} 
```

您无需使用传递给 createScrollPane() 方法的列表，而是创建一个新列表。

# .net - 我什么时候应该使用结构而不是类？

> ID：85553
> 
> 赞同：327
> 
> 时间：2008-09-17T17:20:49.293
> 
> 标签：.net, oop

MSDN 说，当您需要轻量级对象时，您应该使用结构。当结构比类更可取时，还有其他情况吗？

有些人可能忘记了：

1.  *结构*可以有方法。
2.  *结构*不能被继承。

**我了解结构和类之间的技术差异，我只是对何时**使用结构没有很好的感觉。

* * *

## 回答 #1

> 赞同：309
> 
> 时间：2008-09-17T17:34:03.567

MSDN 有答案： [在类和结构之间选择](http://msdn.microsoft.com/en-us/library/ms229017.aspx)。

基本上，该页面为您提供了一个包含 4 项的清单，并说除非您的类型满足所有标准，否则使用一个类。

> 除非类型具有以下所有特征，否则不要定义结构：
> 
> *   它在逻辑上表示单个值，类似于原始类型（整数、双精度等）。
> *   它的实例大小小于 16 字节。
> *   它是不可变的。
> *   它不必经常装箱。

* * *

## 回答 #2

> 赞同：56
> 
> 时间：2009-01-22T19:08:06.210

我很惊讶我没有读过之前的任何答案，我认为这是最关键的方面：

当我想要一个没有标识的类型时，我使用结构。例如 3D 点：

```
public struct ThreeDimensionalPoint
{
    public readonly int X, Y, Z;
    public ThreeDimensionalPoint(int x, int y, int z)
    {
        this.X = x;
        this.Y = y;
        this.Z = z;
    }

    public override string ToString()
    {
        return "(X=" + this.X + ", Y=" + this.Y + ", Z=" + this.Z + ")";
    }

    public override int GetHashCode()
    {
        return (this.X + 2) ^ (this.Y + 2) ^ (this.Z + 2);
    }

    public override bool Equals(object obj)
    {
        if (!(obj is ThreeDimensionalPoint))
            return false;
        ThreeDimensionalPoint other = (ThreeDimensionalPoint)obj;
        return this == other;
    }

    public static bool operator ==(ThreeDimensionalPoint p1, ThreeDimensionalPoint p2)
    {
        return p1.X == p2.X && p1.Y == p2.Y && p1.Z == p2.Z;
    }

    public static bool operator !=(ThreeDimensionalPoint p1, ThreeDimensionalPoint p2)
    {
        return !(p1 == p2);
    }
} 
```

如果你有这个结构的两个实例，你不在乎它们是内存中的单个数据还是两个。你只关心他们持有的价值。

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2011-06-14T12:50:39.480

Bill Wagner 在他的“有效 c#”一书中有一章关于此问题 ( [http://www.amazon.com/Effective-Specific-Ways-Improve-Your/dp/0321245660](https://rads.stackoverflow.com/amzn/click/com/0321245660) )。他通过使用以下原则得出结论：

> 1.  是类型数据存储的主要职责吗？
> 2.  它的公共接口是否完全由访问或修改其数据成员的属性定义？
> 3.  你确定你的类型永远不会有子类吗？
> 4.  你确定你的类型永远不会被多态处理吗？
> 
> 如果您对所有 4 个问题都回答“是”：使用结构。否则，使用一个类。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2008-09-17T17:22:00.507

当您需要值类型语义而不是引用类型时，请使用结构。结构是按值复制的，所以要小心！

另请参阅以前的问题，例如

[.NET 中的结构和类有什么区别？](https://stackoverflow.com/questions/13049/whats-the-difference-between-struct-and-class-in-net)

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2015-12-16T05:21:30.193

***在以下情况下使用类：***

*   它的身份很重要。当通过值传递给方法时，结构会被隐式复制。
*   它将占用大量内存。
*   它的字段需要初始化器。
*   您需要从基类继承。
*   你需要多态行为；

***在以下情况下使用结构：***

*   它将像原始类型（int、long、byte 等）一样工作。
*   它必须具有较小的内存占用。
*   您正在调用需要按值传递结构的 P/Invoke 方法。
*   您需要减少垃圾收集对应用程序性能的影响。
*   它的字段只需要初始化为其默认值。该值对于数值类型为零，对于布尔类型为 false，对于引用类型为 null。
    *   请注意，在 C# 6.0 中，结构可以有一个默认构造函数，可用于将结构的字段初始化为非默认值。
*   您不需要从基类继承（除了 ValueType，所有结构都从该基类继承）。
*   您不需要多态行为。

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2008-09-17T17:33:58.263

我会在以下情况下使用结构：

1.  一个对象应该是只读的（每次传递/分配一个结构时，它都会被复制）。当涉及到多线程处理时，只读对象非常棒，因为它们在大多数情况下不需要锁定。

2.  一个物体是小而短暂的。在这种情况下，对象很有可能会被分配到堆栈上，这比将其放在托管堆上要高效得多。更重要的是，对象分配的内存一旦超出其范围就会被释放。换句话说，垃圾收集器的工作量更少，内存使用效率更高。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2020-03-01T12:51:58.363

这是一个老话题，但想提供一个简单的基准测试。

我创建了两个 .cs 文件：

```
public class TestClass
{
    public long ID { get; set; }
    public string FirstName { get; set; }
    public string LastName { get; set; }
} 
```

和

```
public struct TestStruct
{
    public long ID { get; set; }
    public string FirstName { get; set; }
    public string LastName { get; set; }
} 
```

运行基准：

*   创建 1 个测试类
*   创建 1 个测试结构
*   创建 100 个测试类
*   创建 100 个测试结构
*   创建 10000 个测试类
*   创建 10000 个 TestStruct

结果：

```
BenchmarkDotNet=v0.12.0, OS=Windows 10.0.18362
Intel Core i5-8250U CPU 1.60GHz (Kaby Lake R), 1 CPU, 8 logical and 4 physical cores
.NET Core SDK=3.1.101
[Host]     : .NET Core 3.1.1 (CoreCLR 4.700.19.60701, CoreFX 4.700.19.60801), X64 RyuJIT  [AttachedDebugger]
DefaultJob : .NET Core 3.1.1 (CoreCLR 4.700.19.60701, CoreFX 4.700.19.60801), X64 RyuJIT

|         Method |           Mean |         Error |        StdDev |     Ratio | RatioSD | Rank |    Gen 0 | Gen 1 | Gen 2 | Allocated |
|--------------- |---------------:|--------------:|--------------:|----------:|--------:|-----:|---------:|------:|------:|----------:|

|      UseStruct |      0.0000 ns |     0.0000 ns |     0.0000 ns |     0.000 |    0.00 |    1 |        - |     - |     - |         - |
|       UseClass |      8.1425 ns |     0.1873 ns |     0.1839 ns |     1.000 |    0.00 |    2 |   0.0127 |     - |     - |      40 B |
|   Use100Struct |     36.9359 ns |     0.4026 ns |     0.3569 ns |     4.548 |    0.12 |    3 |        - |     - |     - |         - |
|    Use100Class |    759.3495 ns |    14.8029 ns |    17.0471 ns |    93.144 |    3.24 |    4 |   1.2751 |     - |     - |    4000 B |
| Use10000Struct |  3,002.1976 ns |    25.4853 ns |    22.5920 ns |   369.664 |    8.91 |    5 |        - |     - |     - |         - |
|  Use10000Class | 76,529.2751 ns | 1,570.9425 ns | 2,667.5795 ns | 9,440.182 |  346.76 |    6 | 127.4414 |     - |     - |  400000 B | 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2008-09-17T18:57:12.573

当我想将一些值组合在一起以从方法调用中传回内容时，我总是使用结构体，但在阅读了这些值之后，我不需要将它用于任何事情。就像保持清洁的一种方式。我倾向于将结构中的事物视为“一次性”，而将类中的事物视为更有用和“功能性”

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2011-11-18T19:26:31.953

如果一个实体将是不可变的，那么是使用结构还是类的问题通常是性能问题而不是语义问题。在 32/64 位系统上，类引用需要 4/8 个字节来存储，而不管类中的信息量如何；复制一个类引用需要复制 4/8 个字节。另一方面，每一个*不同的*除了它持有的信息和对它的引用的内存成本之外，类实例还将有 8/16 字节的开销。假设需要一个包含 500 个实体的数组，每个实体包含四个 32 位整数。如果实体是结构类型，则该数组将需要 8,000 个字节，无论所有 500 个实体是否全都相同、全不同或介于两者之间。如果实体是类类型，则包含 500 个引用的数组将占用 4,000 个字节。如果这些引用都指向不同的对象，则每个对象将需要额外的 24 个字节（所有 500 个对象需要 12,000 个字节），总共 16,000 个字节——是结构类型存储成本的两倍。另一方面，在代码中创建了一个对象实例，然后复制了对所有 500 个数组槽的引用，该实例的总成本为 24 个字节和 4 个，000 表示数组——总共 4,024 个字节。一大笔节省。很少有情况会像最后一种情况一样有效，但在某些情况下，可以将一些引用复制到足够的数组槽以使这种共享变得有价值。

如果实体应该是可变的，那么使用类还是结构的问题在某些方面更容易。假设“Thing”是一个结构或类，它具有一个名为 x 的整数字段，并且执行以下代码：

```
  事物 t1,t2;
  ...
  t2 = t1；
  t2.x = 5;

```

是否希望后一种陈述影响 t1.x？

如果 Thing 是类类型，则 t1 和 t2 将是等价的，这意味着 t1.x 和 t2.x 也将是等价的。因此，第二条语句将影响 t1.x。如果 Thing 是结构体类型，则 t1 和 t2 将是不同的实例，这意味着 t1.x 和 t2.x 将引用不同的整数。因此，第二条语句不会影响 t1.x。

可变结构和可变类具有根本不同的行为，尽管 .net 在处理结构突变时有一些怪癖。如果需要值类型的行为（意味着“t2=t1”会将数据从 t1 复制到 t2，同时将 t1 和 t2 作为不同的实例），并且如果可以忍受 .net 处理值类型的怪癖，请使用一个结构。如果一个人想要值类型语义，但 .net 的怪癖会导致应用程序中的值类型语义被破坏，请使用一个类并喃喃自语。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2013-08-28T07:58:39.073

除了上面的优秀答案：

结构是值类型。

它们永远不能设置为**Nothing**。

设置结构 = Nothing ，会将其所有值类型设置为其默认值。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-09-17T17:22:02.690

当您并不真正需要行为，但您需要比简单数组或字典更多的结构时。

**跟进** 这就是我对结构的总体看法。我知道他们可以有方法，但我喜欢保持这种整体的心理区别。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-09-17T17:23:57.303

正如@Simon 所说，结构提供“值类型”语义，因此如果您需要与内置数据类型类似的行为，请使用结构。由于结构是通过副本传递的，因此您要确保它们的大小很小，大约 16 个字节。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-09-17T19:06:52.597

唔...

我不会使用垃圾收集作为支持/反对使用结构与类的论据。托管堆的工作方式很像堆栈——创建一个对象只是将它放在堆的顶部，这几乎与在堆栈上分配一样快。此外，如果一个对象是短暂的并且无法在 GC 循环中存活，则释放是免费的，因为 GC 仅适用于仍可访问的内存。（搜索 MSDN，有一系列关于 .NET 内存管理的文章，我只是懒得去挖掘它们）。

大多数情况下，我使用结构体时都会为此自责，因为后来我发现拥有引用语义会使事情变得更简单一些。

无论如何，上面发布的 MSDN 文章中的这四点似乎是一个很好的指导方针。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2014-08-18T17:33:45.570

结构在堆栈上而不是堆上，因此它们是线程安全的，应该在实现传输对象模式时使用，你永远不想在堆上使用对象它们是易变的，在这种情况下你希望使用调用堆栈，这是使用结构的基本案例，我对这里的所有答案感到惊讶，

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2021-03-16T05:31:18.780

✔️ 如果类型的实例很小且通常短暂存在或通常嵌入在其他对象中，请考虑定义结构而不是类。

* * *

## 回答 #16

> 赞同：-3
> 
> 时间：2017-03-05T16:51:17.290

我认为最好的答案就是当你需要的是属性集合时使用 struct ，当它是属性和行为的集合时使用 class 。

# vb.net - VB.NET 2005 设计器无法处理代码行的问题

> ID：85559
> 
> 赞同：0
> 
> 时间：2008-09-17T17:21:27.607
> 
> 标签：vb.net, visual-studio-2005, crystal-reports, designer

我的项目中存在 .designer 的问题，众所周知，它是自动生成的，我根本没有改变。有一天我工作得很好，我做了备份，第二天就繁荣了！该项目突然停止工作并发送一条消息说设计师无法处理代码行......因此我得到了更多错误（在我的情况下为2个），我什至从它工作的那天开始备份并且没用我也遇到了同样的错误，我在笔记本电脑上试过了，同样的问题也来了。如何删除“FitTrack”？令人难以置信的是，当我在笔记本电脑上尝试时，桌面上的错误在我眼前消失了，一秒钟后另一个错误消失了（但仍然有设计师的警告并且看不到表格），我关闭并一次又一次地打开它我有错误......

错误是：

```
Warning 1   The designer cannot process the code at line 27: 

Me.CrystalReportViewer1.ReportSource = Me.CrystalReport11

The code within the method 'InitializeComponent' is generated by the designer and should not be manually modified.  Please remove any changes and try opening the designer again.   C:\Documents and Settings\Alan Cardero\Desktop\Reportes Liquidacion\Reportes Liquidacion\Reportes Liquidacion\Form1.Designer.vb 28  0 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-17T17:26:39.997

我会将设计器中的静态分配取出到资源 CrystalReport11，然后将负载处理程序添加到您的表单中，然后在将 ReportSource 设置回 CrystalReport11 之前进行检查

```
If(Not DesignMode) Then Me.CrystalReportViewer1.ReportSource = Me.CrystalReport11 
```

这是一个样机..

```
Public Sub New()
    InitializeComponent()

    AddHandler Me.Load, New EventHandler(AddressOf Form1_Load)
End Sub

Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs)
    If (Not DesignMode) Then Me.CrystalReportViewer1.ReportSource = Me.CrystalReport11
End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T17:28:17.467

我会备份与它关联的designer.cs文件（比如将其复制到桌面），然后编辑designer.cs文件并删除有问题的行（跟踪他们做了什么），然后我会尝试重做那些线通过该形式的设计模式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T17:44:02.543

您应该能够进行备份，清除有问题的行，然后当您重新打开它时，设计器将修复代码。

关键是你想让设计者重新生成，然后验证所有需要的行都在那里。

这通常对我有用，但你只需要确保删除它不喜欢的所有行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-16T03:04:24.143

我做一个简单的方法；右键单击报告，然后选择运行自定义工具。

它会自动修复所有问题并为我工作，我解决了 52 个水晶 ReportViewer 错误。

# c# - OpenCV的.Net（dotNet）包装器？

> ID：85569
> 
> 赞同：73
> 
> 时间：2008-09-17T17:22:15.750
> 
> 标签：c#, .net, opencv, mono, cross-platform

我见过有几个。 [opencvdotnet](http://code.google.com/p/opencvdotnet/)，[SharperCV](http://www.cs.ru.ac.za/research/groups/SharperCV/)，[EmguCV](http://sourceforge.net/projects/emgucv)，[一个代码项目](http://www.codeproject.com/KB/cs/Intel_OpenCV.aspx#install)。

有没有人有任何这些经验？我在 Code Project 上玩了一会儿，但是当我尝试做任何复杂的事情时，我得到了一些令人讨厌的无法捕获的异常（即 Msgbox 异常）。跨平台（支持 Mono）将是最好的。

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2008-10-05T15:10:53.993

我从 opencvdotnet 开始，但它并没有真正积极开发。此外，对我需要的功能（面部检测）的支持不完整。我现在正在使用[EmguCV](http://www.emgu.com/wiki/index.php/Main_Page)：它封装了 API 的大部分，并且它背后的人对建议和请求非常敏感。该代码令人赏心悦目，并且可以在 Mono 上运行。

我在我的博客上写了一个快速[入门指南。](http://friism.com/webcam-face-detection-in-c-using-emgu-cv)

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2010-10-20T02:30:31.233

我们使用[OpenCVSharp](http://code.google.com/p/opencvsharp/)，谷歌代码网站是日文的，但它使用最新的 OpenCV 构建并始终暗示 IDisposable。它似乎比我们迄今为止看到的任何其他产品都提供了更多的功能，并且仍然很活跃。它也有相当广泛的示例程序。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2012-11-25T18:48:43.780

我认为重要的是要注意最初的问题是在**2008**年提出的，而 OpenCV 2.0 是在**2009**年发布的。2.0 版本引入了一个 C++ 包装器，它比 OP 所面临的旧 C 接口更容易使用。对于我的 .NET 项目，我将所有图形操作留在本机 C++ 中。

**试试这个：**创建一个链接到 OpenCV 库的 C++/CLR DLL 项目。OpenCV 手册描述了如何为 Windows C++ EXE 执行此操作，相同的步骤也适用于 C++/CLR DLL。然后当然 DLL 导出可从 .NET EXE 调用的方法。

要对其进行测试，您应该能够通过一些调整将任何 OpenCV 样本合并到您的 DLL 中。（将 .CPP 文件添加到您的项目中，将 main() 函数转换为类成员，等等 - 您知道演习...）一个好的测试候选可能是“mat_mask_operations”示例。

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2014-10-08T16:46:53.037

[NuGetMustHaves](https://nugetmusthaves.com/Tag/opencv)对 NuGet 上的软件包及其构建日期和 OpenCV 版本进行了很好的总结。

截至 2022 年 1 月 11 日：

*   [EmguCV](http://www.emgu.com)于 2021 年 1 月 19 日更新为 OpenCV v 4.5.5.4823
*   [OpenCvSharp](https://github.com/shimat/opencvsharp)于 2021 年 1 月 24 日针对 OpenCV v 4.5.5.2021123 更新

EmguCV 和 OpenCvSharp 是最近构建的 2 个软件包，似乎是未来更好的选择。

请注意，EmguCV 使用双重 GPL3/商业许可证[（源）](http://www.emgu.com/forum/viewtopic.php?t=5162)，而 OpenCVSharp 使用 BSD 3-Clause 许可证。换句话说，OpenCVSharp 可以免费用于商业用途，但 EmguCV 不是。不过，EmguCV 拥有出色的文档/示例/支持和更大的开发团队，这使得许可证在许多情况下都是值得的。

值得考虑您未来的用例是什么。如果您只是想使用托管语言快速运行，那么包装器很好。我就是这样开始的。但是当我进入更严肃的应用程序时，我发现构建一个 python/C++ 应用程序具有更好的性能和更多跨平台重用代码的潜力。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-05-24T05:35:35.850

我认为最好的包装是 opencvsharp [http://code.google.com/p/opencvsharp/](http://code.google.com/p/opencvsharp/)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-09-20T12:58:52.780

我创建了一个 NuGet 包，以便使用 EmguCV 在 C# 中轻松开始使用 OpenCv。

看看这个！在 Visual Studio 中搜索并添加**myEmguCV.Net** NuGet 包。

[https://www.nuget.org/packages/myEmguCV.Net](https://www.nuget.org/packages/myEmguCV.Net)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-18T10:56:35.683

SharperCV 是我们选择的工具，它并没有让我们失望，对于我们的[机器人项目](http://palcom.bmfnik.hu/content/hu/2006/PALCOM-RAAD2006-eng.pdf)。尽管它目前被标记为废弃，但代码的状态非常好，只需稍作调整即可根据您的需要对其进行自定义。没有 msgboxes，实际上非常理智的异常处理。

但是，由于互操作性层，它不是跨平台的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-10-02T17:15:02.477

我知道这个问题已经回答了很长时间，但我想补充一点，这里有一个非常好的包装[器](http://www.iib-chemnitz.de/cvwrapper/)。这是您在[代码项目](http://www.codeproject.com/Articles/28465/Easy-to-use-Wrapper-DLL-for-Intel-s-OpenCV-Library)上尝试过的新版本的 openCV 包装器。我已经尝试了几天，一切都很完美。另外，我在几分钟内就让它工作了。

我不知道与单声道的兼容性，但在 Visual Studio 2010 下，它就像一个魅力，为我节省了大量的时间和金钱（我的项目是商业的，大多数库都是开源的，具有不允许商业的许可证除非发布代码）

# python - 使用 Python 搜索具有 MAC 地址的主机

> ID：85577
> 
> 赞同：9
> 
> 时间：2008-09-17T17:23:23.030
> 
> 标签：python, network-programming

我想在我的网络上搜索给定的 MAC 地址，所有这些都来自 Python 脚本。我已经有了网络中所有活动 IP 地址的映射，但我不知道如何收集 MAC 地址。有任何想法吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-17T17:28:21.520

你需要[ARP](http://en.wikipedia.org/wiki/Address_Resolution_Protocol)。Python 的标准库不包含任何代码，因此您要么需要调用外部程序（您的操作系统可能有一个“arp”实用程序），要么您需要自己构建数据包（可能使用像[Scapy](http://www.secdev.org/projects/scapy/)这样的工具。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T17:27:49.760

我认为没有内置的方法可以从 Python 本身获取它。

我的问题是，您如何从网络中获取 IP 信息？

要从本地计算机获取它，您可以轻松解析 ifconfig (unix) 或 ipconfig (windows)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T17:30:54.277

如果你想要一个纯 Python 解决方案，你可以看看[Scapy](http://www.secdev.org/projects/scapy/)来制作数据包（你需要发送 ARP 请求，并检查回复）。或者，如果您不介意调用外部程序，您可以使用`arping`（在 Un*x 系统上，我不知道 Windows 等效程序）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T17:31:18.223

似乎没有使用 Python 执行此操作的本地方法。最好的办法是在 Windows 上解析“ipconfig /all”的输出，或者在 Linux 上解析“ifconfig”的输出。考虑将 os.popen() 与一些正则表达式一起使用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T17:29:29.913

取决于你的平台。如果您使用 *nix，您可以使用“arp”命令查找给定 IP（假设为 IPv4）地址的 mac 地址。如果这不起作用，您可以 ping 地址然后查看，或者如果您可以访问原始网络（使用 BPF 或其他机制），您可以发送自己的 ARP 数据包（但这可能是矫枉过正）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T17:32:21.917

您可能想要解析“arp”的输出，但内核 ARP 缓存将仅包含那些 IP 地址（如果这些主机已与运行 Python 脚本的主机通信）。

ifconfig 可用于显示本地接口的 MAC 地址，但不能显示 LAN 上的 MAC 地址。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-17T17:38:25.007

Mark Pilgrim 描述了如何在 Windows 上使用 Netbios 模块在 Windows 上执行此[操作](http://groups.google.com/group/comp.lang.python/msg/fd2e7437d72c1c21)。您可以从 python.org 获取 Netbios 模块作为 Win32 包的一部分。不幸的是，目前我找不到模块上的文档。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-09-17T19:13:45.543

由于 python 并不意味着处理特定于操作系统的问题（它应该被解释和跨平台），我会执行一个外部命令来这样做：

在 unix 中，命令是`ifconfig`

如果您将其作为管道执行，您将获得所需的结果：

```
import os
myPipe = os.popen2("/sbin/ifconfig","a")
print(myPipe[1].read()) 
```

# c# - FindControl() 方法抛出 ArithmeticException？

> ID：85588
> 
> 赞同：0
> 
> 时间：2008-09-17T17:24:49.410
> 
> 标签：c#, asp.net

我的 ASP.NET 代码中有一行 C#，如下所示：

```
DropDownList ddlStates = (DropDownList)fvAccountSummary.FindControl("ddlStates"); 
```

DropDownList 控件是在页面上的标记中显式声明的，而不是动态创建的。它位于 FormView 控件内。当我的代码到达这一行时，我收到一个 ArithmeticException 消息“对于 Int32，值太大或太小”。此代码以前有效，现在正在生产中。我启动了 VS2008 以对站点进行一些更改，但在我更改任何内容之前，我从页面中得到了这个异常。有人见过这个吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-17T20:02:08.127

如果那是堆栈跟踪，它来自数据绑定，而不是来自您发布的行。您是否有可能拥有一些非常大的数据集？我见过一个 6000 页的 GridView 溢出了一个 Int16，虽然看起来你实际上不太可能溢出一个 Int32...

例如，检查以确保您将正确的数据传递到数据源的 startpageIndex 或 pageSize 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T17:40:50.463

您是否 100% 确定这是引发异常的代码行？我很确定 FindControl 方法不能抛出 ArithmeticException。当然，我以前就知道是错的...... :)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T18:21:35.963

我之前在 C#/.NET 中看到过 ArithmeticException 被抛出在奇怪的地方，那是当我使用 p/invoke 来处理与 USB 设备通信的非托管 .dll 时。

崩溃是一致的，而且总是在同一个地方。当然，这个地方与崩溃完全无关（我认为这是一个基本的赋值，比如 int i = 4 或类似的傻事）

我想告诉你一个幸福的结局，但我从未设法完全找到问题所在。我坚信原因在于非托管代码，并且它以某种方式破坏了内存，甚至可能释放了托管内存。（删除对非托管代码的调用使问题消失）

我要发送的消息是：您是否正在调用非托管代码？如果是这样，我的建议是您将调试技能集中在那里:)

# windows - 从 Windows CLI 刷新磁盘写入缓存

> ID：85595
> 
> 赞同：14
> 
> 时间：2008-09-17T17:26:01.573
> 
> 标签：windows, caching, command-line-interface, disk, flush

有谁知道如何从 Windows 命令行从当前目录（或任何给定文件或目录）的缓存管理器刷新磁盘写入缓存数据？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2014-04-24T10:37:11.637

我发现 SysInternals [Sync](http://technet.microsoft.com/en-us/sysinternals/bb897438.aspx)对我来说效果很好 - 尽管它会刷新所有缓存，而不仅仅是特定文件夹。

使用示例：

```
IF EXIST Output RD /S /Q Output && Sync && MD Output 
```

默认情况下，它会刷新所有驱动器的所有缓存数据 - 您可以指定命令行选项来限制哪些驱动器，但不能将其限制为仅特定文件夹。

没有它，我经常会`Access denied`出错，因为在`MD`系统仍在删除旧文件夹的过程中尝试创建新文件夹。

# macos - 如何在 OS X Leopard 的默认 Apache 2 下安装 modperl？

> ID：85614
> 
> 赞同：1
> 
> 时间：2008-09-17T17:28:32.100
> 
> 标签：macos, apache2, installation, osx-leopard, mod-perl

我在默认的 vanilla Leopard Apache 2 下安装 modperl 的尝试失败了，我在网上能找到的只是[这](http://www.nabble.com/Building-mod_perl2-on-Leopard-td13682685.html)方面的变体：

如果可能的话，我希望不依赖 MacPorts 或 Fink，但如果可以使它们与默认的 Apache 2 安装一起使用，那可能没问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T17:55:58.850

[Macports](http://www.macports.org/)有它（想想 apt-get 和 Linux 上的类似，但在 OS X 上）

[（你可以在这里](http://trac.macports.org/browser/trunk/dports/www/mod_perl2/Portfile)看到它）

虽然我自己没有安装......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-19T01:38:04.237

为什么**不**放弃并构建/安装您自己的或移植版本的 perl、apache2 和 mod_perl2？可能比与之战斗更容易。（为我工作。）

* * *

（根据评论）
嗯！抱歉，我并不打算这样刻薄或暗示这不是一个有效的问题。我想我会删除它（如果可以的话）。编辑问题以添加您不单独安装的理由是否有用？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-15T17:52:10.733

获取最新的 mod_perl 并设置以下 var：

> 出口 ARCHFLAGS="-arch x86_64"

像往常一样编译/安装。

摘自[这篇文章“在 Leopard 上构建 mod_perl2”](http://www.nabble.com/Building-mod_perl2-on-Leopard-td13682685.html)，其中还链接到有关如何使 Apache2::Request (libapreq) 也正常工作的更多详细信息。

-

（并不是说我已经能够测试它，因为我个人回到了运行 Apache 1.3 的 Tiger 上！）

（让我们看看stackoverflow是否设法将这个答案提升到顶部，因为它是唯一的“正确”答案）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-23T04:32:02.763

几天前我问了一个非常相似的问题并得到了一些很好的答案： [“我如何使用带有自编译 Perl 和 mod_perl 的供应商 Apache？”](https://stackoverflow.com/questions/79493/how-do-i-use-a-vendor-apache-with-a-self-compiled-perl-and-modperl)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-27T16:38:21.370

mod_perl 的 mc ports install 会尝试安装 apache 1.3，即使您只指定了 mod perl，所以这不是一个好的选择。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-04T18:33:50.177

试试这个： [http ://www.unibia.com/unibianet/node/32](http://www.unibia.com/unibianet/node/32)

# visual-studio-2008 - 如何为 Visual C++ 2008 (Express edition) 编译 Cairo

> ID：85622
> 
> 赞同：11
> 
> 时间：2008-09-17T17:29:46.573
> 
> 标签：visual-studio-2008, visual-c++, open-source, graphics

大多数预编译的 Windows 二进制文件都是使用 MSYS+gcc 工具链制作的。它使用与 Visual C++ 2005/2008 不兼容的 MSVCRT 运行时。

那么，如何仅为 Visual C++ 编译 Cairo 1.6.4（或更高版本）。包括依赖项（png、zlib、pixman）。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-09-19T08:58:22.120

以下是使用 Visual C++ 构建 Cairo/Cairomm 的说明。

必需的：

*   Visual C++ 2008 Express SP1（现在包括 SDK）
*   MSYS 1.0

要使用 VC++ 命令行工具，需要运行批处理文件“vcvars32.bat”。

```
    C:\Program Files\Microsoft Visual Studio 9.0\Common7\Tools\vcvars32.bat

```

## ZLib

[从http://www.zlib.net/](http://www.zlib.net/)下载（并解压）zlib123.zip

```
    光盘zlib123
    nmake /f win32/Makefile.msc

    目录
        # zlib.lib 是静态库
        #
        # zdll.lib 是 zlib1.dll 的导入库
        # zlib1.dll 是共享库

```

## 库

[从http://www.libpng.org/pub/png/libpng.html](http://www.libpng.org/pub/png/libpng.html)下载（并提取）lpng1231.zip

VC++ 9.0 编译器会给出大量“这可能不安全”的警告。别理他们; 这是 MS 安全恐慌（代码很好）。

```
    cd lpng1231\lpng1231 # 出于某种原因，这是两层深

    nmake /f ../../lpng1231.nmake ZLIB_PATH=../zlib123

    目录
        # libpng.lib 是静态库
        #
        # dll 没有被创建

```

## 皮克斯曼

Pixman 是 Cairo 的一部分，但需要单独下载。

[从http://www.cairographics.org/releases/](http://www.cairographics.org/releases/)下载（并提取）pixman-0.12.0.tar.gz

使用 MSYS 通过 'tar -xvzf pixman*.tar.gz' 解压

Pixman 和 Cairo 都有用于 Visual C++ 命令行编译器 (cl) 的 Makefile，但它们使用 Gnu makefile 和类 Unix 工具（sed 等）。这意味着我们必须在 MSYS 中运行 make。

在启用 VC++ 命令行工具的情况下打开命令提示符（尝试 'cl /?'）。通过“C:\MSYS\1.0\MSYS.BAT”将该命令提示符转换为 MSYS 提示符。

不要使用 MSYS 图标，因为这样您的提示现在将知道 VC++。您不能从 MSYS 运行 .bat 文件。

尝试 VC++ 工具从这里工作：'cl -?'

试试 Gnu make 也可以工作：'make -v'。

凉爽的。

```
    cd（使用 /d/... 而不是 D:)
    cd pixman-0.12.0/pixman
    make -f Makefile.win32

```

这默认为 MMX 和 SSE2 优化，这需要新的 x86 处理器（奔腾 4 或奔腾 M 或更高版本：http: [//fi.wikipedia.org/wiki/SSE2](http://fi.wikipedia.org/wiki/SSE2)）

有很多警告，但它似乎成功了。

```
    释放
        # pixman-1.lib（开罗需要的静态库）

```

留在 VC++ 加香料的 MSYS 提示符下，也可以在 Cairo 进行编译。

## 开罗

[从http://www.cairographics.org/releases/](http://www.cairographics.org/releases/)下载（并提取）cairo-1.6.4.tar.gz

```
    光盘
    cd cairo-1.6.4

```

这里的 Makefile.win32 几乎不错，但是硬连线了 Pixman 路径。

使用修改后的“Makefile-cairo.win32”：

```
    make -f ../Makefile-cairo.win32 CFG=release \
            PIXMAN_PATH=../../pixman-0.12.0 \
            LIBPNG_PATH=../../lpng1231 \
            ZLIB_PATH=../../zlib123

```

（将所有内容写在一行上，忽略反斜杠）

它说“没有规则制作'src/cairo-features.h'。使用手动准备的（在Cairo > 1.6.4中可能有一个'src/cairo-features-win32.h'，您可以简单地重命名） ：

```
    cp ../cairo-features.h src/

```

重试 make 命令（向上箭头记住它）。

```
    ls src/发布
        #
        # cairo-static.lib

```

## cairomm (C++ API)

[从http://www.cairographics.org/releases/](http://www.cairographics.org/releases/)下载（并提取）cairomm-1.6.4.tar.gz

有一个 Visual C++ 2005 项目，我们可以在 2008 年使用（通过开放和升级）。

```
    cairomm-1.6.4\MSCV_Net2005\cairomm\cairomm.vcproj

```

需要做的改变：

*   将活动配置更改为“发布”

*   Cairomm-1.0 属性（带有右键菜单）

```
        C++/General/Additional 包含目录：
            ..\..\..\cairo-1.6.4\src（附加到现有的）

        链接器/常规/其他库目录：
            ..\..\..\cairo-1.6.4\src\release
            ..\..\..\lpng1231\lpng1231
            ..\..\..\zlib123

        链接器/输入/附加依赖项：   
            cairo-static.lib libpng.lib zlib.lib msimg32.lib

```

*   优化：快速 FPU 代码

```
            C++/代码生成/浮点模型
                快速地

```

右键单击“cairomm-1.0”和“构建”。有一些警告。

```
    目录 cairomm-1.6.4\MSVC_Net2005\cairomm\Release
        #
        # cairomm-1.0.lib
        # cairomm-1.0.dll
        # cairomm.def

```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-11-15T09:37:56.153

这些步骤可以在 2015-11-15 为 Visual Studio 2015 社区构建最新的 cairo。调试版本是 DLL，链接到 CRT 的 DLL 版本。发布版本是静态库，链接到 CRT 的静态链接版本并且不需要 DLL。

# 安装 GnuWin

构建脚本需要 GNU 命令行工具。以下步骤使用[Chocolatey 的 GnuWin](https://chocolatey.org/packages/GnuWin)进行了测试。MSYS 也可能工作。

# 下载

[zlib128.zip](http://www.zlib.net/) , [lpng1619.zip](http://www.libpng.org/pub/png/libpng.html) , [cairo-1.14.4.tar.xz](http://www.cairographics.org/releases/) , [pixman-0.32.8.tar.gz](http://www.cairographics.org/releases/)

# 提炼

提取这些档案并重命名目录：

```
. (my_cairo_build_root)
├─cairo
├─libpng
├─pixman
└─zlib 
```

# zlib

不要建造。构建脚本使用与 Visual Studio 2015 冲突的 MSVCRT。使用从 libpng 构建生成的库。

# 库

编辑`libpng\projects\vstudio\zlib.props`：

*   在`<ZLibSrcDir>`删除版本号：`..\..\..\..\zlib`
*   `<WindowsSDKDesktopARMSupport>`改为_ `true`_`false`

`libpng\projects\vstudio\vstudio.sln`在 Visual Studio 中打开并确认升级。使用默认`Debug`配置，右击项目`libpng`进行构建。切换到`Release Library`配置并右键单击项目`libpng`进行构建。

# 像素人

编辑`pixman\Makefile.win32.common`：

*   替换`CFG_CFLAGS = -MD -O2`为`CFG_CFLAGS = -MT -O2`（链接到发布版本中 CRT 的静态链接版本）
*   替换`@mkdir`为`@"mkdir"`（有`cmd`'s builtin`mkdir`和 GnuWin's `mkdir`，引号强制使用后者）

从开始菜单运行 Visual Studio x86 本机命令提示符：

```
cd /d my_cairo_build_root
cd pixman\pixman
make -f Makefile.win32
make -f Makefile.win32 CFG=debug 
```

# 开罗

编辑`cairo\build\Makefile.win32.common`：

*   替换`CFG_CFLAGS = -MD -O2`为`CFG_CFLAGS = -MT -O2`
*   替换`CAIRO_LIBS += $(LIBPNG_PATH)/libpng.lib`为`CAIRO_LIBS += $(LIBPNG_PATH)/lib/$(CFG)/libpng16.lib`。现在，将目录复制`libpng\projects\vstudio\Debug`到 (created)`libpng\lib\`中并将其重命名为`debug`. 将目录复制`libpng\projects\vstudio\Release Library`到`libpng\lib\`并重命名为`release`.
*   替换`CAIRO_LIBS += $(ZLIB_PATH)/zdll.lib`为`CAIRO_LIBS += $(LIBPNG_PATH)/lib/$(CFG)/zlib.lib`
*   有两条`@mkdir -p $(CFG)/`dirname $<``线。将它们都替换为：

    ```
    @"mkdir" -p $(CFG)/$<
    @"rmdir" $(CFG)/$< 
    ```

编辑`cairo\build\Makefile.win32.features-h`：

*   全部替换`@echo`为`@"echo"`

`link.exe`GnuWin 中有一个无法使用的问题。重命名`C:\GnuWin\bin\link.exe`以`link_.exe`避免冲突。

从开始菜单运行 Visual Studio x86 本机命令提示符：

```
cd /d my_cairo_build_root
cd cairo
make -f Makefile.win32 CFG=debug
make -f Makefile.win32 CFG=release 
```

最后两个命令将显示`"Built successfully!"`但返回错误。别理他们。

重命名回来`C:\GnuWin\bin\link.exe`。

# 配置 Visual Studio

创建一个目录`include`并将以下标题复制到：

*   `cairo\cairo-version.h`（不是`cairo\src\cairo-version.h`）
*   `cairo\src\*.h`, 不包括`cairo\src\cairo-version.h`

添加该目录以在 Visual Studio 中包含路径。

添加`cairo\src\$(Configuration)`和`libpng\lib\$(Configuration)`到库路径。`$(Configuration)`将自动扩展到`Debug`或`Release`构建时。

将`cairo\src\debug\cairo.dll`和放到`libpng\lib\debug\libpng16.dll`Windows 之一`PATH`。

之前`#include <cairo.h>`，设置链接选项：

```
#ifndef NDEBUG
#   pragma comment(lib, "cairo")
#else
#define CAIRO_WIN32_STATIC_BUILD
#   pragma comment(lib, "cairo-static")
#   pragma comment(lib, "libpng16")
#   pragma comment(lib, "zlib")
#endif 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-03-09T22:31:53.087

这些说明似乎不适用于当前版本的 imlib，我想知道是否值得重新提出这个问题？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-18T09:55:52.037

您是否在这里查看过：http: [//cairographics.org/visualstudio/](http://cairographics.org/visualstudio/)？'它使用与 Visual C++ 2005/2008 不兼容的 MSCVRT 运行时'是什么意思？您遇到的具体问题是什么？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-07-15T08:02:56.983

在 Windows 上构建时遇到了两个问题（Visual Studio 2008，GNU Make 3.81）：

1.  src/Makefile.sources 中的“if”结构无效。修复了使用

    ```
    sed "s/^if \([A-Z_]*\)$/ifeq ($(\1), 1)/" src\Makefile.sources 
    ```

2.  `_lround`在 Windows/MSVC 上不可用。使用

    ```
    sed "s/#define _cairo_lround lround/static inline long cairo_const
    _cairo_lround(double r) { return (long)floor(r + .5); }/"` 
    ```

    （这可能是一个糟糕的修复）

除了这些问题，一切都很好（对于 x86 和 x86_64 架构）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-18T19:41:43.050

MSYS+gcc 工具链使用旧的 MSVCRT 运行时库（现在内置于 Windows）和 Visual C++ 2005/2008 自带。众所周知，代码不应依赖于多个运行时[。](http://lua-users.org/lists/lua-l/2008-09/msg00077.html)传递文件句柄、内存指针等会受到影响，并且在这种情况下会导致明显的随机崩溃。

我没有被这个咬过。再说一次，我也不再以 Windows 为目标。但我被告知甚至不要尝试解决方案。

本来可行的是将所有依赖项静态链接到库中（例如，Cairomm）。静态库没有绑定到它们的运行时，是吗？但我没有尝试这个。我实际上让所有成分的 VC++ 构建工作，但花了几天时间。

我没有找到你提供的网址。本身就很奇怪；我“到处”看了看。再说一次，它是针对 Visual Studio 2003.NET 的，所以已经落后了两代。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-18T19:44:00.983

我已经这样做了，但是我没有任何现成的说明。我的构建也相当少，因为我不需要支持例如。PNG 和 SVG 文件，我只是用它来将生成的矢量图形渲染到内存缓冲区。

但我所做的是通读`config.h`UNIX/GNU 构建系统的文件和其他文件，并编写适合 MSVC 的自己的文件，然后使用适当的源文件创建项目。最多可能需要几个小时才能做到这一点，但是当你完成后它就可以工作了；）

编辑：请查看此页面，它有一个用于构建 cairo 的 MSVC 2003 (7.1) 项目：http: [//slinavlee.googlepages.com/](http://slinavlee.googlepages.com/)

# pdf - 用于查看和注释 PDF 文档的组件

> ID：85624
> 
> 赞同：5
> 
> 时间：2008-09-17T17:29:53.123
> 
> 标签：pdf, annotations, components, markup

谁能推荐一个好的 Windows 表单组件来显示 PDF 文档并允许用户添加*真正的*注释（我的意思是与 Adob​​e Reader 创建的相同）。

更新：我尝试了 Abobe 与 Reader 一起安装的 AxAcroPDF 组件，但这不支持注释。我基本上希望 AxAcroPDF 与 Reader 的“评论和标记工具栏”相结合。[Foxit SDK ActiveX](http://www.foxitsoftware.com/pdf/sdk/activex/)似乎支持这个，所以我要试试。我只是认为会有更多的选择可供选择。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-27T16:18:15.573

还有[http://a.nnotate.com](http://a.nnotate.com/ "在线注释 PDF 文档")，您可以将其用作 Web 应用程序中的 PDF / Word 注释组件 - 只需使用 AJAX / JS / HTML 并在浏览器中正确显示 pdf，无需 adobe 阅读器。（有关工作演示，请参阅[http://a.nnotate.com/embed-guide.html ）](http://a.nnotate.com/embed-guide.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T17:35:32.080

为了编辑我使用过[SyncFusions](http://www.syncfusion.com) Essential PDF 的文档，它工作得很好

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T18:10:50.687

免费版的[福昕阅读器](http://www.foxitsoftware.com/pdf/rd_intro.php)就是这样做的，你可以做工具->注释工具->注释，然后点击PDF页面的任意位置，放置一个小注释图标，里面有文字。然后只需保存 PDF。稍后，如果有人在 Acrobat 或 Foxit 中查看 PDF，只需将鼠标悬停在页面上或单击页面上的小笔记图标即可查看评论。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-27T13:11:45.560

如果有人感兴趣，看起来我们最终会使用来自[Qoppa Software](http://www.qoppa.com)的 jPDFNotes 。

从网站引用：

> jPDFNotes 是一个 Java™ bean，它集成到您​​的应用程序中以显示 PDF 文档和表单，并允许您的用户注释文档和填写表单。编辑文档后，库可以将它们保存到本地文件，或者主机应用程序可以覆盖保存功能以将文件保存到本地或网络上的任何位置。
> 
> jPDFNotes 建立在 Qoppa 的专有 PDF 技术之上，因此您的用户无需安装 Acrobat Reader 或任何其他第三方软件或驱动程序。jPDFNotes 是 100% Java，因此它完全独立于平台，因此可以在 Windows、Linux、Unix、Mac OSX 和任何其他支持 Java 运行时环境的平台上运行。

这不是我们开始寻找的东西，但它似乎正是我们所需要的。他们似乎也是一群很好的人。

# c - 使用 Win32 API 安全删除 USB 驱动器？

> ID：85649
> 
> 赞同：31
> 
> 时间：2008-09-17T17:33:07.500
> 
> 标签：c, windows, winapi, usb

如何使用 Win32 API 移除 USB 驱动器？我在嵌入式系统上做了很多工作，其中一个我必须将我的程序复制到 U 盘上并将其插入目标硬件。

由于我主要在控制台上工作，我不喜欢每天使用鼠标点击任务栏小图标一百次。

我很想写一个小程序来做这件事，这样我就可以把它放到我的makefile中，但是我还没有找到任何做同样事情的API调用。

有任何想法吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-09-17T17:37:15.633

您可以使用 CM_Request_Device_Eject() 函数以及其他一些可能性。请参阅以下项目和文章：

DevEject：直截了当。 [http://www.withopf.com/tools/deveject/](http://www.withopf.com/tools/deveject/)

一篇有用的 CodeProject 文章： http: [//www.codeproject.com/KB/system/RemoveDriveByLetter.aspx](http://www.codeproject.com/KB/system/RemoveDriveByLetter.aspx)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-17T17:36:00.630

看起来[Sync](http://technet.microsoft.com/en-us/sysinternals/bb897438.aspx)允许您指定 -e 来弹出可移动驱动器。虽然不是 win32 API，但您可能只是`sync -e [drive_letter]`从您的 makefile 中调用。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-17T17:40:28.903

这是一篇关于可移动存储介质的[technet 文章。](http://technet.microsoft.com/en-us/library/cc757632.aspx)寻找`DismountNtmsMedia`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-26T15:27:49.900

这是 Delphi 中的一个解决方案，我已经对其进行了修改并投入到一项服务中，以供在一个非常大的企业中使用。转到：[链接文本](http://jedi-apilib.sourceforge.net/)

查找“scapi (Setup & Config Manager API)”，然后下载。将有一个名为 USBView 的演示程序可以帮助您上路。如果您有 Delphi，这还包括一个 TUSBDeviceTree 组件，您可以使用它来收集有关 USB 设备的信息。

问候

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-10-16T01:45:45.640

```
#include<SetupAPI.h>
#include <windows.h>  
#include<initguid.h>
#include <newdev.h>
#include <Cfgmgr32.h>

#pragma comment(lib, "Cfgmgr32.lib")
#pragma comment(lib, "Setupapi.lib")
#pragma comment(lib, "Newdev.lib")

int RemoveDevice(const GUID *guid, const wchar_t *hwID) {
    HDEVINFO m_hDevInfo;
    SP_DEVICE_INTERFACE_DATA         spdid;
    SP_DEVINFO_DATA                  spdd;
    DWORD                            dwSize;
    BYTE Buf[1024];
    PSP_DEVICE_INTERFACE_DETAIL_DATA pspdidd =
        (PSP_DEVICE_INTERFACE_DETAIL_DATA)Buf;

    printf("try to remove device::%ws\n", hwID);

    m_hDevInfo = SetupDiGetClassDevs(guid, NULL, NULL, DIGCF_PRESENT| DIGCF_DEVICEINTERFACE);
    if (m_hDevInfo == INVALID_HANDLE_VALUE)
    {
        printf("GetClassDevs Failed!\n");
        return 0;
    }
    spdid.cbSize = sizeof(spdid);
    for (int i = 0; SetupDiEnumDeviceInterfaces(m_hDevInfo, NULL, guid, i, &spdid); i++) {
        dwSize = 0;
        SetupDiGetDeviceInterfaceDetail(m_hDevInfo,
            &spdid, NULL, 0, &dwSize, NULL);
        if (dwSize != 0 && dwSize <= sizeof(Buf)) {
            pspdidd->cbSize = sizeof(*pspdidd); // 5 Bytes!

            ZeroMemory((PVOID)&spdd, sizeof(spdd));
            spdd.cbSize = sizeof(spdd);

            long res =
                SetupDiGetDeviceInterfaceDetail(m_hDevInfo, &
                    spdid, pspdidd,
                    dwSize, &dwSize,
                    &spdd);
            if (res) {
                OLECHAR* guidString;
                OLECHAR* guidString2;
                StringFromCLSID(&spdd.ClassGuid, &guidString);
                StringFromCLSID(&spdid.InterfaceClassGuid, &guidString2);
                printf("%d, %ws, %ws, %ws\n", spdd.DevInst, pspdidd->DevicePath, guidString, guidString2);
                CoTaskMemFree(guidString);
                CoTaskMemFree(guidString2);
                if (!memcmp(pspdidd->DevicePath, hwID, 2 * lstrlenW(hwID))) {
                    DEVINST DevInstParent = 0;
                    res = CM_Get_Parent(&DevInstParent, spdd.DevInst, 0);
                    for (long tries = 0; tries < 10; tries++) {
                        // sometimes we need some tries...
                        WCHAR VetoNameW[MAX_PATH];
                        PNP_VETO_TYPE VetoType = PNP_VetoTypeUnknown;
                        VetoNameW[0] = 0;

                        res = CM_Request_Device_EjectW(DevInstParent,
                            &VetoType, VetoNameW, MAX_PATH, 0);
                        if ((res == CR_SUCCESS &&
                            VetoType == PNP_VetoTypeUnknown)) {
                            printf("remove %ws success!\n", pspdidd->DevicePath);
                            SetupDiDestroyDeviceInfoList(m_hDevInfo);
                            return 1;
                        }
                        Sleep(500); // required to give the next tries a chance!
                    }
                    break;
                }
            }
        }
    }
    printf("Remove Device Failed!\n");
    SetupDiDestroyDeviceInfoList(m_hDevInfo);
    return 0;
}

int main(){
    GUID GUID_DEVINTERFACE_USB_HUB;
    CLSIDFromString(L"F18A0E88-C30C-11D0-8815-00A0C906BED8", &GUID_DEVINTERFACE_USB_HUB);

    RemoveDevice(&GUID_DEVINTERFACE_USB_HUB, L"\\\\?\\usb#root_hub30");
    return 0;
} 
```

参考：

[如何准备 USB 驱动器以安全移除](https://www.codeproject.com/Articles/13839/How-to-Prepare-a-USB-Drive-for-Safe-Removal)

[GUID_DEVINTERFACE](https://www.pinvoke.net/default.aspx/Constants/GUID_DEVINTERFACE.html)

# sql - 如何比较 Oracle 中的两个 CLOB 值

> ID：85675
> 
> 赞同：8
> 
> 时间：2008-09-17T17:35:42.423
> 
> 标签：sql, oracle

我有两张表我想比较。其中一列是 CLOB 类型。我想做这样的事情：

```
select key, clob_value source_table
minus
select key, clob_value target_table 
```

不幸的是，Oracle 不能对 clob 执行减法运算。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-09-17T17:41:29.180

格式是这样的：

```
dbms_lob.compare(  
lob_1    IN BLOB,  
lob_2    IN BLOB,  
amount   IN INTEGER := 18446744073709551615,  
offset_1 IN INTEGER := 1,  
offset_2 IN INTEGER := 1)  
RETURN INTEGER; 
```

* * *

如果 dbms_lob.compare(lob1, lob2) = 0，它们是相同的。

这是基于您的示例的示例查询：

```
Select key, glob_value  
From source_table Left Join target_table  
  On source_table.key = target_table.key  
Where target_table.glob_value is Null  
  Or dbms_lob.compare(source_table.glob_value, target_table.glob_value) <> 0 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-17T17:39:09.093

您可以通过内置包访问数据吗？如果是这样，那么也许您可以编写一个返回数据的字符串表示形式的函数（例如，数据上的某种散列），那么您可以这样做

```
select key, to_hash_str_val(glob_value) from source_table
minus
select key, to_hash_str_val(glob_value) from target_table 
```

# ruby - 在日历应用程序中模拟重复事件的最佳方法是什么？

> ID：85699
> 
> 赞同：241
> 
> 时间：2008-09-17T17:37:44.417
> 
> 标签：ruby, algorithm, calendar, data-modeling, recurrence

我正在构建一个需要支持重复事件的组日历应用程序，但是我想出的处理这些事件的所有解决方案似乎都是一个 hack。我可以限制一个人可以看多远，然后一次生成所有事件。或者，我可以将事件存储为重复事件并在日历上向前看时动态显示它们，但如果有人想要更改事件的特定实例的详细信息，我必须将它们转换为正常事件。

我确信有更好的方法可以做到这一点，但我还没有找到。对重复事件建模的最佳方法是什么，您可以在其中更改或删除特定事件实例的详细信息？

（我正在使用 Ruby，但请不要让这限制了你的答案。如果有特定于 Ruby 的库或其他东西，那么很高兴知道。）

* * *

## 回答 #1

> 赞同：104
> 
> 时间：2008-09-17T17:45:23.977

我会为所有未来的重复事件使用“链接”概念。它们在日历中动态显示并链接回单个参考对象。当事件发生时，链接断开，事件变为独立实例。如果您尝试编辑重复事件，则提示更改所有未来项目（即更改单个链接引用）或仅更改该实例（在这种情况下将其转换为独立实例，然后进行更改）。后一种情况略有问题，因为您需要在循环列表中跟踪所有已转换为单个实例的未来事件。但是，这是完全可行的。

因此，从本质上讲，有 2 类事件 - 单个实例和重复事件。

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2016-07-13T18:25:42.907

我开发了多个基于日历的应用程序，还编写了一组支持循环的可重用 JavaScript 日历组件。[我写了一篇关于如何设计重复出现](https://github.com/bmoeskau/Extensible/blob/master/recurrence-overview.md)的概述，这可能对某人有帮助。虽然有一些特定于我编写的库的部分，但提供的绝大多数建议对于任何日历实现都是通用的。

一些关键点：

*   使用[iCal RRULE 格式](http://www.kanzaki.com/docs/ical/rrule.html)存储重复- 这是你真的不想重新发明的一个轮子
*   不要将单个重复事件**实例**存储为数据库中的行！始终存储重复模式。
*   There are many ways to design your event/exception schema, but a basic starting point example is provided
*   All date/time values should be stored in UTC and converted to local for display
*   The end date stored for a recurring event should always be the *end date of the recurrence range* (or your platform's "max date" if recurring "forever") and the event duration should be stored separately. This is to ensure a sane way of querying for events later. Read the linked article for more details about this.
*   Some discussion around generating event instances and recurrence editing strategies is included

It's a really complicated topic with many, many valid approaches to implementing it. I will say that I've actually implemented recurrence several times successfully, and I would be wary of taking advice on this subject from anyone who hasn't actually done it.

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2009-05-19T11:38:01.057

重复事件可能存在很多问题，让我强调一些我知道的。

## 解决方案 1 - 没有实例

存储原始约会+重复数据，不存储所有实例。

问题：

*   您必须在需要时计算日期窗口中的所有实例，成本很高
*   无法处理异常（即您删除一个实例，或移动它，或者更确切地说，您不能使用此解决方案执行此操作）

## 解决方案 2 - 存储实例

存储从 1 开始的所有内容，以及链接回原始约会的所有实例。

问题：

*   占用很多空间（但空间很便宜，所以很小）
*   必须优雅地处理异常，特别是如果您在异常后返回并编辑原始约会。例如，如果您将第三个实例向前移动一天，如果您返回并编辑原始约会的时间，在原始日期重新插入另一个并离开移动的那个怎么办？取消链接移动的？尝试适当地更改移动的那个？

当然，如果您不打算做例外，那么任何一种解决方案都应该没问题，并且您基本上可以从时间/空间权衡方案中进行选择。

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2008-09-17T17:40:52.880

您可能想查看 iCalendar 软件实现或标准本身 ( ~~RFC 2445~~ [RFC 5545](https://www.rfc-editor.org/rfc/rfc5545) )。很快就会想到的是 Mozilla 项目[http://www.mozilla.org/projects/calendar/](http://www.mozilla.org/projects/calendar/) 快速搜索也会发现[http://icalendar.rubyforge.org/](http://icalendar.rubyforge.org/)。

根据您将如何存储事件，可以考虑其他选项。您是否正在构建自己的数据库架构？使用基于 iCalendar 的东西等？

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2010-10-23T00:19:24.833

我正在使用以下内容：

*   [http://github.com/elevation/event_calendar](http://github.com/elevation/event_calendar) - 日历的模型和助手
*   [http://github.com/seejohnrun/ice_cube](http://github.com/seejohnrun/ice_cube) - 很棒的经常性宝石
*   [http://github.com/justinfrench/formtastic](http://github.com/justinfrench/formtastic) - 简单的表格

还有一个正在进行中的 gem，它使用输入类型 :recurring ( `form.schedule :as => :recurring`) 扩展了 formtastic，它呈现了一个类似 iCal 的界面和一个`before_filter`将视图再次序列化为一个`IceCube`对象，ghetto-ly。

我的想法是让向模型添加重复属性并在视图中轻松连接变得难以置信。全部在几行。

* * *

那么这给了我什么？索引，可编辑，重复属性。

`events`存储一个单日实例，并在日历视图/助手中使用，例如`task.schedule`存储 yaml'd`IceCube`对象，因此您可以执行类似 : 的调用`task.schedule.next_suggestion`。

回顾：我使用两种模型，一种用于日历显示，另一种用于功能。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-11-09T03:07:33.283

我正在使用如下所述的数据库模式来存储重复参数

[http://github.com/bakineggs/recurring_events_for](http://github.com/bakineggs/recurring_events_for)

然后我使用 runt 来动态计算日期。

[https://github.com/mlipper/runt](https://github.com/mlipper/runt)

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-09-17T17:50:15.040

1.  跟踪重复规则（可能基于 iCalendar，每 @ [Kris K.](https://stackoverflow.com/questions/85699/whats-the-best-way-to-model-recurring-events-in-a-calendar-application#85728)）。这将包括一个模式和一个范围（每第三个星期二，出现 10 次）。
2.  当您想要编辑/删除特定事件时，请跟踪上述重复规则的例外日期（规则指定的事件*未发生的日期）。*
3.  如果您删除，这就是您所需要的，如果您编辑，创建另一个事件，并给它一个父 ID 设置为主事件。您可以选择是否在此记录中包含所有主要事件的信息，或者它是否只保存更改并继承所有未更改的内容。

请注意，如果您允许不结束的重复规则，您必须考虑如何显示您现在无限量的信息。

希望有帮助！

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-09-17T18:01:01.583

我建议使用日期库的强大功能和 ruby​​ 范围模块的语义。重复事件实际上是一个时间、一个日期范围（开始和结束），通常是一周中的一天。使用日期和范围，您可以回答任何问题：

```
#!/usr/bin/ruby
require 'date'

start_date = Date.parse('2008-01-01')
end_date   = Date.parse('2008-04-01')
wday = 5 # friday

(start_date..end_date).select{|d| d.wday == wday}.map{|d| d.to_s}.inspect 
```

产生事件的所有日子，*包括*闰年！

```
# =>"[\"2008-01-04\", \"2008-01-11\", \"2008-01-18\", \"2008-01-25\", \"2008-02-01\", \"2008-02-08\", \"2008-02-15\", \"2008-02-22\", \"2008-02-29\", \"2008-03-07\", \"2008-03-14\", \"2008-03-21\", \"2008-03-28\"]" 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-09-17T18:04:56.597

从这些答案中，我筛选出了一个解决方案。我真的很喜欢链接概念的想法。重复事件可以是一个链表，尾部知道它的重复规则。更改一个事件会很容易，因为链接保持不变，删除一个事件也很容易 - 您只需取消链接一个事件，删除它，然后重新链接它之前和之后的事件。每次有人在日历上查看以前从未查看过的新时间段时，您仍然必须查询重复事件，否则这很干净。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-09-17T17:44:16.897

您可以将事件存储为重复，如果编辑了特定实例，则创建一个具有相同事件 ID 的新事件。然后在查找事件时，搜索具有相同事件ID的所有事件以获取所有信息。我不确定您是否推出了自己的事件库，或者您是否正在使用现有的事件库，所以这可能是不可能的。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2011-02-11T10:31:33.077

查看下面的文章，了解三个好的 ruby​​ 日期/时间库。对于重复规则和事件日历所需的其他内容，ice_cube 尤其是一个可靠的选择。 [http://www.rubyinside.com/3-new-date-and-time-libraries-for-rubyists-3238.html](http://www.rubyinside.com/3-new-date-and-time-libraries-for-rubyists-3238.html)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2014-11-23T10:18:26.843

在 JavaScript 中：

处理重复计划： [http ://bunkat.github.io/later/](http://bunkat.github.io/later/)

处理这些时间表之间的复杂事件和依赖关系：http: [//bunkat.github.io/schedule/](http://bunkat.github.io/schedule/)

基本上，您创建规则，然后要求库计算下一个 N 重复事件（指定或不指定日期范围）。可以解析/序列化规则以将它们保存到您的模型中。

**如果您有一个重复事件并且只想修改一个重复事件，您可以使用*except()*函数取消特定的一天，然后为该条目添加一个新的修改事件。**

该库支持非常复杂的模式、时区甚至 croning 事件。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-17T17:47:11.350

将事件存储为重复并动态显示它们，但是允许重复事件包含特定事件的列表，这些事件可以覆盖特定日期的默认信息。

当您查询重复事件时，它可以检查当天的特定覆盖。

如果用户进行了更改，那么您可以询问他是要更新所有实例（默认详细信息）还是只更新当天（创建新的特定事件并将其添加到列表中）。

如果用户要求删除此事件的所有重复，您还可以获取详细信息列表，并且可以轻松删除它们。

唯一有问题的情况是用户想要更新此事件和所有未来事件。在这种情况下，您必须将重复事件一分为二。此时，您可能需要考虑以某种方式链接重复事件，以便将它们全部删除。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-05-19T11:28:11.700

对于准备支付一些许可费用的 .NET 程序员，您可能会发现[Aspose.Network](http://www.aspose.com/categories/file-format-components/aspose.network-for-.net/default.aspx)很有用……它包括一个与 iCalendar 兼容的库，用于定期约会。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2012-03-14T01:38:51.467

您可以直接以 iCalendar 格式存储事件，这允许开放式重复、时区本地化等。

您可以将这些存储在 CalDAV 服务器中，然后当您想要显示事件时，您可以使用 CalDAV 中定义的报告选项来要求服务器在查看的时间段内扩展重复事件。

或者您可以自己将它们存储在数据库中并使用某种 iCalendar 解析库来进行扩展，而无需 PUT/GET/REPORT 与后端 CalDAV 服务器通信。这可能需要更多的工作——我确信 CalDAV 服务器在某处隐藏了复杂性。

从长远来看，拥有 iCalendar 格式的事件可能会使事情变得更简单，因为人们总是希望将它们导出以放入其他软件中。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2014-11-06T02:31:12.657

我已经简单地实现了这个功能！逻辑如下，首先需要两张表。RuleTable 存储一般或回收父事件。ItemTable 是存储循环事件。例如，当您创建一个循环事件时，开始时间为 2015 年 11 月 6 日，结束时间为 12 月 6 日（或永远），循环为一周。您将数据插入到 RuleTable 中，字段如下：

```
TableID: 1 Name: cycleA  
StartTime: 6 November 2014 (I kept thenumber of milliseconds),  
EndTime: 6 November 2015 (if it is repeated forever, and you can keep the value -1) 
Cycletype: WeekLy. 
```

现在要查询 11 月 20 日到 12 月 20 日的数据。可以写一个函数RecurringEventBE(long start, long end)，根据起止时间，WeekLy，可以计算出你想要的集合，<cycleA11.20, cycleA 11.27, cycleA 12.4 ......>。除了 11 月 6 日，其余的我都称他为虚拟事件。当用户在之后更改虚拟事件的名称时（例如 cycleA11.27），您将数据插入到 ItemTable 中。字段如下：

```
TableID: 1 
Name, cycleB  
StartTime, 27 November 2014  
EndTime,November 6 2015  
Cycletype, WeekLy
Foreignkey, 1 (pointingto the table recycle paternal events). 
```

在函数 RecurringEventBE (long start, long end) 中，您使用此数据覆盖虚拟事件 (cycleB11.27) 对不起我的英语，我试过了。

这是我的 RecurringEventBE：</p>

```
public static List<Map<String, Object>> recurringData(Context context,
        long start, long end) { // 重复事件的模板处理，生成虚拟事件(根据日期段)
     long a = System.currentTimeMillis();
    List<Map<String, Object>> finalDataList = new ArrayList<Map<String, Object>>();

    List<Map<String, Object>> tDataList = BillsDao.selectTemplateBillRuleByBE(context); //RuleTable，just select recurringEvent
    for (Map<String, Object> iMap : tDataList) {

        int _id = (Integer) iMap.get("_id");
        long bk_billDuedate = (Long) iMap.get("ep_billDueDate"); // 相当于事件的开始日期 Start
        long bk_billEndDate = (Long) iMap.get("ep_billEndDate"); // 重复事件的截止日期 End
        int bk_billRepeatType = (Integer) iMap.get("ep_recurringType"); // recurring Type 

        long startDate = 0; // 进一步精确判断日记起止点，保证了该段时间断获取的数据不未空，减少不必要的处理
        long endDate = 0;

        if (bk_billEndDate == -1) { // 永远重复事件的处理

            if (end >= bk_billDuedate) {
                endDate = end;
                startDate = (bk_billDuedate <= start) ? start : bk_billDuedate; // 进一步判断日记起止点，这样就保证了该段时间断获取的数据不未空
            }

        } else {

            if (start <= bk_billEndDate && end >= bk_billDuedate) { // 首先判断起止时间是否落在重复区间，表示该段时间有重复事件
                endDate = (bk_billEndDate >= end) ? end : bk_billEndDate;
                startDate = (bk_billDuedate <= start) ? start : bk_billDuedate; // 进一步判断日记起止点，这样就保证了该段时间断获取的数据不未空
            }
        }

        Calendar calendar = Calendar.getInstance();
        calendar.setTimeInMillis(bk_billDuedate); // 设置重复的开始日期

        long virtualLong = bk_billDuedate; // 虚拟时间，后面根据规则累加计算
        List<Map<String, Object>> virtualDataList = new ArrayList<Map<String, Object>>();// 虚拟事件

        if (virtualLong == startDate) { // 所要求的时间,小于等于父本时间，说明这个是父事件数据，即第一条父本数据

            Map<String, Object> bMap = new HashMap<String, Object>();
            bMap.putAll(iMap);
            bMap.put("indexflag", 1); // 1表示父本事件
            virtualDataList.add(bMap);
        }

        long before_times = 0; // 计算从要求时间start到重复开始时间的次数,用于定位第一次发生在请求时间段落的时间点
        long remainder = -1;
        if (bk_billRepeatType == 1) {

            before_times = (startDate - bk_billDuedate) / (7 * DAYMILLIS);
            remainder = (startDate - bk_billDuedate) % (7 * DAYMILLIS);

        } else if (bk_billRepeatType == 2) {

            before_times = (startDate - bk_billDuedate) / (14 * DAYMILLIS);
            remainder = (startDate - bk_billDuedate) % (14 * DAYMILLIS);

        } else if (bk_billRepeatType == 3) {

            before_times = (startDate - bk_billDuedate) / (28 * DAYMILLIS);
            remainder = (startDate - bk_billDuedate) % (28 * DAYMILLIS);

        } else if (bk_billRepeatType == 4) {

            before_times = (startDate - bk_billDuedate) / (15 * DAYMILLIS);
            remainder = (startDate - bk_billDuedate) % (15 * DAYMILLIS);

        } else if (bk_billRepeatType == 5) {

            do { // 该段代码根据日历处理每天重复事件，当事件比较多的时候效率比较低

                Calendar calendarCloneCalendar = (Calendar) calendar
                        .clone();
                int currentMonthDay = calendarCloneCalendar
                        .get(Calendar.DAY_OF_MONTH);
                calendarCloneCalendar.add(Calendar.MONTH, 1);
                int nextMonthDay = calendarCloneCalendar
                        .get(Calendar.DAY_OF_MONTH);

                if (currentMonthDay > nextMonthDay) {
                    calendar.add(Calendar.MONTH, 1 + 1);
                    virtualLong = calendar.getTimeInMillis();
                } else {
                    calendar.add(Calendar.MONTH, 1);
                    virtualLong = calendar.getTimeInMillis();
                }

            } while (virtualLong < startDate);

        } else if (bk_billRepeatType == 6) {

            do { // 该段代码根据日历处理每天重复事件，当事件比较多的时候效率比较低

                Calendar calendarCloneCalendar = (Calendar) calendar
                        .clone();
                int currentMonthDay = calendarCloneCalendar
                        .get(Calendar.DAY_OF_MONTH);
                calendarCloneCalendar.add(Calendar.MONTH, 2);
                int nextMonthDay = calendarCloneCalendar
                        .get(Calendar.DAY_OF_MONTH);

                if (currentMonthDay > nextMonthDay) {
                    calendar.add(Calendar.MONTH, 2 + 2);
                    virtualLong = calendar.getTimeInMillis();
                } else {
                    calendar.add(Calendar.MONTH, 2);
                    virtualLong = calendar.getTimeInMillis();
                }

            } while (virtualLong < startDate);

        } else if (bk_billRepeatType == 7) {

            do { // 该段代码根据日历处理每天重复事件，当事件比较多的时候效率比较低

                Calendar calendarCloneCalendar = (Calendar) calendar
                        .clone();
                int currentMonthDay = calendarCloneCalendar
                        .get(Calendar.DAY_OF_MONTH);
                calendarCloneCalendar.add(Calendar.MONTH, 3);
                int nextMonthDay = calendarCloneCalendar
                        .get(Calendar.DAY_OF_MONTH);

                if (currentMonthDay > nextMonthDay) {
                    calendar.add(Calendar.MONTH, 3 + 3);
                    virtualLong = calendar.getTimeInMillis();
                } else {
                    calendar.add(Calendar.MONTH, 3);
                    virtualLong = calendar.getTimeInMillis();
                }

            } while (virtualLong < startDate);

        } else if (bk_billRepeatType == 8) {

            do {
                calendar.add(Calendar.YEAR, 1);
                virtualLong = calendar.getTimeInMillis();
            } while (virtualLong < startDate);

        }

        if (remainder == 0 && virtualLong != startDate) { // 当整除的时候，说明当月的第一天也是虚拟事件，判断排除为父本，然后添加。不处理,一个月第一天事件会丢失
            before_times = before_times - 1;
        }

        if (bk_billRepeatType == 1) { // 单独处理天事件，计算出第一次出现在时间段的事件时间

            virtualLong = bk_billDuedate + (before_times + 1) * 7
                    * (DAYMILLIS);
            calendar.setTimeInMillis(virtualLong);

        } else if (bk_billRepeatType == 2) {

            virtualLong = bk_billDuedate + (before_times + 1) * (2 * 7)
                    * DAYMILLIS;
            calendar.setTimeInMillis(virtualLong);
        } else if (bk_billRepeatType == 3) {

            virtualLong = bk_billDuedate + (before_times + 1) * (4 * 7)
                    * DAYMILLIS;
            calendar.setTimeInMillis(virtualLong);
        } else if (bk_billRepeatType == 4) {

            virtualLong = bk_billDuedate + (before_times + 1) * (15)
                    * DAYMILLIS;
            calendar.setTimeInMillis(virtualLong);
        }

        while (startDate <= virtualLong && virtualLong <= endDate) { // 插入虚拟事件
            Map<String, Object> bMap = new HashMap<String, Object>();
            bMap.putAll(iMap);
            bMap.put("ep_billDueDate", virtualLong);
            bMap.put("indexflag", 2); // 2表示虚拟事件
            virtualDataList.add(bMap);

            if (bk_billRepeatType == 1) {

                calendar.add(Calendar.DAY_OF_MONTH, 7);

            } else if (bk_billRepeatType == 2) {

                calendar.add(Calendar.DAY_OF_MONTH, 2 * 7);

            } else if (bk_billRepeatType == 3) {

                calendar.add(Calendar.DAY_OF_MONTH, 4 * 7);

            } else if (bk_billRepeatType == 4) {

                calendar.add(Calendar.DAY_OF_MONTH, 15);

            } else if (bk_billRepeatType == 5) {

                Calendar calendarCloneCalendar = (Calendar) calendar
                        .clone();
                int currentMonthDay = calendarCloneCalendar
                        .get(Calendar.DAY_OF_MONTH);
                calendarCloneCalendar.add(Calendar.MONTH,
                        1);
                int nextMonthDay = calendarCloneCalendar
                        .get(Calendar.DAY_OF_MONTH);

                if (currentMonthDay > nextMonthDay) {
                    calendar.add(Calendar.MONTH, 1
                            + 1);
                } else {
                    calendar.add(Calendar.MONTH, 1);
                }

            }else if (bk_billRepeatType == 6) {

                Calendar calendarCloneCalendar = (Calendar) calendar
                        .clone();
                int currentMonthDay = calendarCloneCalendar
                        .get(Calendar.DAY_OF_MONTH);
                calendarCloneCalendar.add(Calendar.MONTH,
                        2);
                int nextMonthDay = calendarCloneCalendar
                        .get(Calendar.DAY_OF_MONTH);

                if (currentMonthDay > nextMonthDay) {
                    calendar.add(Calendar.MONTH, 2
                            + 2);
                } else {
                    calendar.add(Calendar.MONTH, 2);
                }

            }else if (bk_billRepeatType == 7) {

                Calendar calendarCloneCalendar = (Calendar) calendar
                        .clone();
                int currentMonthDay = calendarCloneCalendar
                        .get(Calendar.DAY_OF_MONTH);
                calendarCloneCalendar.add(Calendar.MONTH,
                        3);
                int nextMonthDay = calendarCloneCalendar
                        .get(Calendar.DAY_OF_MONTH);

                if (currentMonthDay > nextMonthDay) {
                    calendar.add(Calendar.MONTH, 3
                            + 3);
                } else {
                    calendar.add(Calendar.MONTH, 3);
                }

            } else if (bk_billRepeatType == 8) {

                calendar.add(Calendar.YEAR, 1);

            }
            virtualLong = calendar.getTimeInMillis();

        }

        finalDataList.addAll(virtualDataList);

    }// 遍历模板结束，产生结果为一个父本加若干虚事件的list

    /*
     * 开始处理重复特例事件特例事件，并且来时合并
     */
    List<Map<String, Object>>oDataList = BillsDao.selectBillItemByBE(context, start, end);
    Log.v("mtest", "特例结果大小" +oDataList );

    List<Map<String, Object>> delectDataListf = new ArrayList<Map<String, Object>>(); // finalDataList要删除的结果
    List<Map<String, Object>> delectDataListO = new ArrayList<Map<String, Object>>(); // oDataList要删除的结果

    for (Map<String, Object> fMap : finalDataList) { // 遍历虚拟事件

        int pbill_id = (Integer) fMap.get("_id");
        long pdue_date = (Long) fMap.get("ep_billDueDate");

        for (Map<String, Object> oMap : oDataList) {

            int cbill_id = (Integer) oMap.get("billItemHasBillRule");
            long cdue_date = (Long) oMap.get("ep_billDueDate");
            int bk_billsDelete = (Integer) oMap.get("ep_billisDelete");

            if (cbill_id == pbill_id) {

                if (bk_billsDelete == 2) {// 改变了duedate的特殊事件
                    long old_due = (Long) oMap.get("ep_billItemDueDateNew");

                    if (old_due == pdue_date) {

                        delectDataListf.add(fMap);//该改变事件在时间范围内，保留oMap

                    }

                } else if (bk_billsDelete == 1) {

                    if (cdue_date == pdue_date) {

                        delectDataListf.add(fMap);
                        delectDataListO.add(oMap);

                    }

                } else {

                    if (cdue_date == pdue_date) {
                        delectDataListf.add(fMap);
                    }

                }

            }
        }// 遍历特例事件结束

    }// 遍历虚拟事件结束
    // Log.v("mtest", "delectDataListf的大小"+delectDataListf.size());
    // Log.v("mtest", "delectDataListO的大小"+delectDataListO.size());
    finalDataList.removeAll(delectDataListf);
    oDataList.removeAll(delectDataListO);
    finalDataList.addAll(oDataList);
    List<Map<String, Object>> mOrdinaryList = BillsDao.selectOrdinaryBillRuleByBE(context, start, end);
    finalDataList.addAll(mOrdinaryList);
    // Log.v("mtest", "finalDataList的大小"+finalDataList.size());
    long b = System.currentTimeMillis();
    Log.v("mtest", "算法耗时"+(b-a));

    return finalDataList;
} 
```

* * *

## 回答 #17

> 赞同：-5
> 
> 时间：2010-02-01T14:12:37.647

> 如果您有一个没有结束日期的定期约会怎么办？尽管空间很便宜，但你没有无限的空间，所以解决方案 2 在那里是行不通的......

请问可以将“无结束日期”解决为世纪末的结束日期。即使对于日常活动，空间量仍然很便宜。

# java - 从字符串中提取 TimeZone 对象的最佳方法？

> ID：85701
> 
> 赞同：9
> 
> 时间：2008-09-17T17:37:47.020
> 
> 标签：java, timezone

我有一个包含原始日期字段（存储为字符数据）的数据库字段，例如

> 东部夏令时间 2008 年 9 月 26 日星期五晚上 8:30

我可以使用 SimpleDateFormat 轻松地将其解析为日期

```
DateFormat dbFormatter = new SimpleDateFormat("EEEE, MMMM dd, yyyy hh:mm aa zzzz");
Date scheduledDate = dbFormatter.parse(rawDate); 
```

我想做的是从这个字符串中提取一个 TimeZone 对象。此应用程序运行的 JVM 中的默认时区是 GMT，所以我不能`.getTimezoneOffset()`从`Date`上面的解析中使用（因为它会返回默认时区）。

除了标记原始字符串并找到 Timezone 字符串的起始位置（因为我知道格式将始终是`EEEE, MMMM dd, yyyy hh:mm aa zzzz`）之外，还有一种方法可以使用 DateFormat/SimpleDateFormat/Date/Calendar API 来提取 TimeZone 对象 - 这将具有相同的 TimeZone作为我解析的字符串`DateFormat.parse()`？

在 Java API 中让我对`Date`vs感到困扰的一件事是，它应该在所有地方都被替换......但后来他们决定，哦，嘿，让我们仍然在类中使用's 。`Calendar``Calendar``Date``Date``DateFormat`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T18:32:42.240

我发现以下内容：

```
 DateFormat dbFormatter = new SimpleDateFormat("EEEE, MMMM dd, yyyy hh:mm aa zzzz");
        dbFormatter.setTimeZone(TimeZone.getTimeZone("America/Chicago"));
        Date scheduledDate = dbFormatter.parse("Friday, September 26, 2008 8:30 PM Eastern Daylight Time");
        System.out.println(scheduledDate);
        System.out.println(dbFormatter.format(scheduledDate));
        TimeZone tz = dbFormatter.getTimeZone();
        System.out.println(tz.getDisplayName());
        dbFormatter.setTimeZone(TimeZone.getTimeZone("America/Chicago"));
        System.out.println(dbFormatter.format(scheduledDate)); 
```

产生以下内容：

```
Fri Sep 26 20:30:00 CDT 2008
Friday, September 26, 2008 08:30 PM Eastern Standard Time
Eastern Standard Time
Friday, September 26, 2008 08:30 PM Central Daylight Time 
```

我实际上发现这有点令人惊讶。但是，我想这表明您的问题的答案是在解析后简单地在格式化程序上调用 getTimeZone 。

编辑：以上是使用 Sun 的 JDK 1.6 运行的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T19:09:38.970

我建议查看**Joda Time 日期和时间 API**。我最近开始相信它，因为它往往比 Java 中对日期和时间的内置支持要好得多。特别是，您应该查看**DateTimeZone**类。希望这可以帮助。

[http://joda-time.sourceforge.net/](http://joda-time.sourceforge.net/)

[http://joda-time.sourceforge.net/api-release/index.html](http://joda-time.sourceforge.net/api-release/index.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T18:47:38.727

@埃德托马斯：

我尝试了与您的示例非常相似的方法，但得到了截然不同的结果：

```
String testString = "Friday, September 26, 2008 8:30 PM Pacific Standard Time";
DateFormat df = new SimpleDateFormat("EEEE, MMMM dd, yyyy hh:mm aa zzzz");

System.out.println("The default TimeZone is: " + TimeZone.getDefault().getDisplayName());

System.out.println("DateFormat timezone before parse: " + df.getTimeZone().getDisplayName());

Date date = df.parse(testString);

System.out.println("Parsed [" + testString + "] to Date: " + date);

System.out.println("DateFormat timezone after parse: " + df.getTimeZone().getDisplayName()); 
```

输出：

> 默认时区为：东部标准时间
> 
> 解析前的 DateFormat 时区：东部标准时间
> 
> 已解析 [太平洋标准时间 2008 年 9 月 26 日星期五晚上 8:30] 至今：2008 年 9 月 27 日星期六 00:30:00 EDT
> 
> 解析后的 DateFormat 时区：东部标准时间

似乎`DateFormat.getTimeZone()`在 ... 之前和之后返回相同的 TimeZone ，`parse()`即使我`setTimeZone()`在调用`parse()`.

查看 DateFormat 和 SimpleDateFormat 的来源，似乎`getTimeZone()`只是返回底层日历的 TimeZone ......除非您指定要使用的某个日历，否则它将默认为默认 Locale/TimeZone 的日历。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-10-26T05:12:02.723

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T17:55:59.507

作为部分解决方案，您可以使用 RegEx 匹配来获取时区，因为您将始终拥有相同的文本。上午或下午。

我对 Java 时区知之甚少，无法让您了解它的最后一部分。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T18:38:38.140

Date 和 Calendar 之间的主要区别在于，Date 只是一个值对象，没有修改它的方法。所以它被设计用于在某处存储日期/时间信息。如果您使用日历对象，则可以在将其设置为使用日期/时间信息执行某些业务逻辑的持久实体后对其进行修改。这是非常危险的，因为实体无法识别这种变化。Calendar 类是为日期/时间的操作而设计的，比如添加天数或类似的东西。

玩弄你的例子，我得到以下信息：

```
import java.text.DateFormat;
import java.text.ParseException;
import java.text.SimpleDateFormat;

public class TimeZoneExtracter {

    public static final void main(String[] args) throws ParseException {
        DateFormat dbFormatter = new SimpleDateFormat("EEEE, MMMM dd, yyyy hh:mm aa zzzz");
        System.out.println(dbFormatter.getTimeZone());
        dbFormatter.parse("Fr, September 26, 2008 8:30 PM Eastern Daylight Time");
        System.out.println(dbFormatter.getTimeZone());
    }

} 
```

输出：

> sun.util.calendar.ZoneInfo[id="Europe/Berlin"... sun.util.calendar.ZoneInfo[id="Africa/Addis_Ababa"...

这是你想要的结果吗？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-17T18:58:55.610

埃德说得对。您希望在解析时间后 DateFormat 对象上的 timeZone 。

```
 String rawDate = "Friday, September 26, 2008 8:30 PM Eastern Daylight Time";
 DateFormat dbFormatter = new SimpleDateFormat("EEEE, MMMM dd, yyyy hh:mm aa zzzz");
 Date scheduledDate = dbFormatter.parse(rawDate);

 System.out.println(rawDate); 
 System.out.println(scheduledDate); 
 System.out.println(dbFormatter.getTimeZone().getDisplayName()); 
```

生产

```
Friday, September 26, 2008 8:30 PM Eastern Daylight Time
Fri Sep 26 20:30:00 CDT 2008
Eastern Standard Time 
```

# c# - 如何使 ComboBox 在 .NET 中不可编辑？

> ID：85702
> 
> 赞同：218
> 
> 时间：2008-09-17T17:37:52.200
> 
> 标签：c#, .net, winforms, combobox

我想要一个“仅选择” `ComboBox`，它提供一个项目列表供用户选择。应在`ComboBox`控件的文本部分禁用键入。

我最初的谷歌搜索发现了一个过于复杂、误导性的建议来捕捉`KeyPress`事件。

* * *

## 回答 #1

> 赞同：407
> 
> 时间：2008-09-17T17:38:14.650

要使 ComboBox 的文本部分不可编辑，请将 DropDownStyle 属性设置为“DropDownList”。现在，ComboBox 对用户来说基本上是只选择的。您可以在 Visual Studio 设计器中执行此操作，也可以在 C# 中执行此操作，如下所示：

```
stateComboBox.DropDownStyle = ComboBoxStyle.DropDownList; 
```

链接到MSDN 上[ComboBox DropDownStyle 属性的文档。](http://msdn.microsoft.com/en-us/library/system.windows.forms.combobox.dropdownstyle.aspx)

* * *

## 回答 #2

> 赞同：72
> 
> 时间：2014-09-23T21:44:09.270

要添加 Visual Studio GUI 引用，您可以`DropDownStyle`在所选组合框的属性下找到选项：

![在此处输入图像描述](https://i.stack.imgur.com/2K5dT.png)

这将自动将第一个答案中提到的行添加到 Form.Designer.cs `InitializeComponent()`，如下所示：

```
this.comboBoxBatch.DropDownStyle = System.Windows.Forms.ComboBoxStyle.DropDownList; 
```

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2012-09-05T16:29:10.907

留在您的 ComboBox 并从属性窗口中搜索 DropDropStyle 属性，然后选择*DropDownList*。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-03-03T08:33:32.273

```
COMBOBOXID.DropDownStyle = ComboBoxStyle.DropDownList; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-01-16T13:58:07.970

要在选择后继续在输入中显示数据，请执行以下操作：

```
VB.NET
Private Sub ComboBox1_KeyPress(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyPressEventArgs) Handles ComboBox1.KeyPress
    e.Handled = True
End Sub

C#
Private void ComboBox1_KeyPress(object sender, KeyPressEventArgs e)
{
    e.Handled = true;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-01-13T09:11:11.670

对于 winforms .NET 将 DropDownStyle 从 Combobox 属性更改为 DropDownList

# c# - 更有效地监控 Active Directory 中的组成员身份 (C# .NET)

> ID：85724
> 
> 赞同：4
> 
> 时间：2008-09-17T17:40:44.597
> 
> 标签：c#, .net, active-directory

我有一个 Active Directory 同步工具 (.NET 2.0 / C#)，它是作为 Windows 服务编写的，我已经研究了一段时间，最近的任务是添加基于组成员身份更改来驱动事件的能力。基本场景是用户与安全数据库同步，并且当组成员更改时，用户需要更改其访问权限（即，如果我现在是“IT 员工”的成员，那么我应该自动获得对服务器机房，如果我从该组中删除，那么我应该自动失去对服务器机房的访问权限）。

问题是，在对组执行 DirectorySynchronization 时，您会收到已添加/删除成员的组，并且当您获取成员列表时，您会从那里获取该组中所有成员的列表，而不仅仅是那些已添加或删除。这给我带来了一个相当大的效率问题——为了知道用户是否被添加或删除，我必须在本地保留每个组和所有成员的列表，并将其与当前列表进行比较以查看谁被添加了添加（不在本地列表中），以及谁已被删除（在本地列表中，不在当前成员列表中）。

我正在讨论是否将组成员身份详细信息存储在内存中的 DataSet 中，并在每次处理新的成员身份更改时写入磁盘。这样，如果服务停止/崩溃或机器重新启动，我仍然可以通过将磁盘上的最后信息与当前组成员列表中的信息进行比较来了解安全数据库中 Active Directory 的当前状态。然而，这似乎非常低效 - 遍历组中的每个成员以与数据集中的内容进行比较，然后每次列表发生更改时将更改写入磁盘。

有没有人处理过这种情况？有没有我没有找到只检索组成员增量的方法？在这种情况下，您会怎么做才能确保在尽可能减少性能损失的同时不会错过任何更改？

**编辑：** AD 可能包含 500 个用户，它可能包含 200,000 个用户 - 这取决于客户，最重要的是平均用户是多少个组的成员

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T18:26:27.107

您可以在组策略编辑器中设置帐户修改成功的审核

然后，您可以监控条目的安全日志并处理帐户修改的日志条目。

例如

```
 EventLog myLog = new EventLog("Security");

        // set event handler
        myLog.EntryWritten += new EntryWrittenEventHandler(OnEntryWritten);
        myLog.EnableRaisingEvents = true; 
```

确保您有权访问安全事件日志 [http://support.microsoft.com/kb/323076](http://support.microsoft.com/kb/323076)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T18:06:13.740

我想说这取决于您需要跟踪多少活动目录对象。如果它是一个小数字（少于 1000 个用户），您可能可以将您的状态数据序列化到磁盘，而不会对性能造成明显影响。如果您正在处理大量对象，那么在 SQL Express 之类的东西中创建一个简单的持久性模式并使用它可能会更有效。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-16T11:36:23.957

您知道有些产品可以帮助您进行目录同步和用户配置（谷歌这些术语）吗？不是在这里发明的，你可能必须证明在当前环境下的投资是合理的，但是开发和维护已经有商业解决方案的代码并不是，让我们说，从长远来看，始终是最具成本效益的方式跑。

并非所有的支持事件/配置，但它们确实支持跟踪更改和分发它们：在这些功能之上创建事件解决方案并不是什么大问题。

Microsoft 拥有[Identity Integration Server](http://www.developer.com/net/net/article.php/3522101) (MISS)，它被重新打包为[Identity Lifecycle Manager](http://www.microsoft.com/windowsserver/ilm2007/default.mspx)的一部分。它最初是建立在一个更通用的元/主数据管理产品上的，但它是可行的。IBM 有[Tivoli Directory Integrator](http://www.redbooks.ibm.com/abstracts/sg246164.html?Open)（但您需要跟上两年一次的名称更改！）。Oracle 有一个[Oracle 身份管理器](http://www.oracle.com/technology/products/id_mgmt/oxp/index.html)，而 Sun 有一个[身份管理器](http://www.sun.com/software/products/identity_mgr/index.xml)。其中大部分是主要参与者购买的领先产品，以填补​​其投资组合的空白。

当然，这些是企业级产品，意味着大而昂贵，但通常非常安全且可扩展。如果您不需要他们的全部力量（还没有！），您需要考虑为自己存储一份副本。[在这种情况下，您是否考虑过使用AD LDS](http://www.oracle.com/technology/products/id_mgmt/oxp/index.html)（以前称为 AD/AM）存储您的最后一个已知 AD 树的副本？它不是比较差异的最佳格式，但目录数据库可以很好地扩展，即使是轻量级的。

# c++ - 将浮点异常转换为 C++ 异常

> ID：85726
> 
> 赞同：7
> 
> 时间：2008-09-17T17:40:49.183
> 
> 标签：c++, exception, floating-point, signals

是否可以在 x86 Linux 上将浮点异常（信号）转换为 C++ 异常？

这是出于调试目的，因此不可移植性和缺陷是可以的（例如，如果不能 100% 保证调用所有析构函数）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-18T00:08:18.283

如果你的 C++ 标准库实现支持 TR1 函数 `fetestexcept`，`feraiseexcept`并且`feclearexcept`（我的还没有，所以我无法测试）你可以检测到五种浮点错误，然后你可以抛出任何你想要的异常。

有关这些功能的说明，请参见[此处](http://en.cppreference.com/w/cpp/numeric/fenv)。

*我还推荐 Pete Becker 所著的 The C++ Standard Library Extensions: A Tutorial and Reference*一书的第 12.3 节“管理浮点环境” ，ISBN-13: 9780321412997，通过示例代码对这些函数进行了出色的描述。

![替代文字](https://i.stack.imgur.com/WdOi2.gif)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-17T20:58:20.860

gcc 选项*-fnon-call-exceptions*可能对您有用。虽然找不到任何文档，但您的里程可能会有所不同。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-17T17:43:23.030

由于信号和异常的工作方式，当信号被抛出时，您不能立即执行此操作 - 异常依赖于堆栈的某些方面，而在调用信号处理程序时这些方面是不正确的。

您可以在信号处理程序中设置一个全局变量，然后在程序中的关键点进行检查，如果设置了则抛出异常。但是，这并没有为您提供有关引发异常的确切信息。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T17:46:22.803

我没有现成的解决方案，但您可以查看的一件事是[信号](http://en.wikipedia.org/wiki/Signal_(computing))（不确定您是否可以安全地从它们抛出 C++ 异常，但无论如何它应该有助于调试。）

您可以为 SIGFPE 安装信号处理程序，并将其用于调试目的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T17:49:21.237

基本思想是为您安装适当的信号处理程序以处理浮点异常。在您的信号处理程序中，您可以抛出异常（或将用户定义的信号发送到将引发异常的另一个进程，或将消息发送到另一个线程以获取类似的东西，等等等等）。有很多方法可以实际抛出异常——主要是处理信号。

# xml - 如何在 XQuery 中打开字符串？

> ID：85761
> 
> 赞同：13
> 
> 时间：2008-09-17T17:45:31.293
> 
> 标签：xml, switch-statement, xquery, case

我有一个以字符串形式出现的外部变量，我想对其进行开关/大小写。我如何在 xquery 中做到这一点？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2010-05-04T16:19:41.650

从 XQuery 1.1 开始，使用 switch：

[http://www.w3.org/TR/xquery-11/#id-switch](http://www.w3.org/TR/xquery-11/#id-switch)

```
switch ($animal) 
   case "Cow" return "Moo"
   case "Cat" return "Meow"
   case "Duck" return "Quack"
   default return "What's that odd noise?" 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-05T11:30:59.460

只需使用一系列 if 表达式：

```
if ($room eq "bathroom") then "loo"
else if ($room eq "kitchen")  then "scullery"
else "just a room" 
```

使用类型开关隐藏了你真正在做什么。

哪种方法最有效将取决于您使用的 XQuery 处理器。在理想情况下，这应该只是一个品味问题，因为应该由优化器来选择合适的方法，但如果性能很重要，那么值得对两个版本进行基准测试。如果处理器从您的示例中优化了节点结构，并且没有将我的示例优化为专用开关，我会感到非常惊讶。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-17T17:47:44.767

XQuery 没有打开元素以外的任何东西的功能。

您要做的第一件事是将字符串转换为元素。

```
let $str := "kitchen"
let $room := element {$str} {} 
```

然后只需使用 typeswitch 进行正常切换：

```
return typeswitch($room)
  case element(bathroom) return "loo"
  case element(kitchen) return "scullery"
  default return "just a room" 
```

***请注意，这可能是 MarkLogic 唯一的解决方案。***

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-02-14T18:02:41.237

如果您的处理器支持 XQuery 1.1，那么您可以简单地执行以下操作：

```
switch ($room) 
  case "bathroom" return "loo"
  case "kitchen" return "scullery"
  default return "just a room" 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-01-18T02:42:28.273

对于撒克逊人，您可以使用以下内容：

```
declare function a:fn($i) {
typeswitch ($i)
 case element(a:elemen1, xs:untyped) return 'a' 
 case element(a:elemen2, xs:untyped) return 'b' 
 default return "error;"
}; 
```

[https://rrusin.blogspot.com/2010/01/xquery4j-in-action.html](https://rrusin.blogspot.com/2010/01/xquery4j-in-action.html)

# php - 如何按升序键对数组进行排序？

> ID：85770
> 
> 赞同：1
> 
> 时间：2008-09-17T17:46:33.147
> 
> 标签：php, arrays, sorting, query-string

这是我从我的闪存文件中获得的输入

process.php?Q2=898&Aa=Grade1&Tim=0%3A0%3A12&Q1=908&Bb=lkj&Q4=jhj&Q3=08&Cc=North%20America&Q0=1

在 php 中我使用这个代码 foreach ($_GET as $field => $label) { $datarray[]=$_GET[$field];

```
echo  "$field :";
echo $_GET[$field];;
echo "<br>"; 
```

我把这个拿出来

Q2 :898 Aa :Grade1 Tim :0:0:12 Q1 :908 Bb :lkj Q4 :jhj Q3 :08 Cc :北美 Q0 :1

现在我的问题是如何按字母顺序对其进行排序，使其看起来像这样 Aa :Grade1 Bb :lkj Cc :North America Q0 :1 Q1 :908

等等....在我可以将它插入数据库之前

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-17T17:48:40.397

```
ksort($_GET); 
```

这应该通过它的键对数组进行[排序。](http://php.net/manual/en/function.ksort.php)[krsort](http://php.net/manual/en/function.krsort.php)用于逆序。`$_GET`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T17:50:15.480

您正在寻找的是[ksort](http://php.net/manual/en/function.ksort.php)。挖掘 PHP 手册！;)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T17:54:07.310

要按键进行自然排序：

```
function knatsort(&$karr){
    $kkeyarr = array_keys($karr);
    natsort($kkeyarr);
    $ksortedarr = array();
    foreach($kkeyarr as $kcurrkey){
        $ksortedarr[$kcurrkey] = $karr[$kcurrkey];
    }
    $karr = $ksortedarr;
    return true;
} 
```

*谢谢，PHP 手册！*

```
foreach ($_GET as $key => $value) {
 echo $key.' - '.$value.'<br/>';
} 
```

# c# - 我应该如何为不同版本的 .NET 编写具有独特部分的代码

> ID：85773
> 
> 赞同：1
> 
> 时间：2008-09-17T17:46:54.177
> 
> 标签：c#, .net, c-preprocessor

我的源代码需要同时支持 .NET 版本 1.1 和 2.0 ...我如何测试不同版本以及处理这种情况的最佳方法是什么。

我想知道我是否应该在不同的类、方法等中内联两段代码。你怎么看？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T17:57:04.247

这里有很多不同的选择。在我工作的地方，我们使用#if pragmas，但也可以使用不同版本的单独程序集来完成。

理想情况下，您至少会将版本相关代码保存在单独的部分类文件中，并在编译时提供正确的版本。如果我能回到过去，我会强制执行，我们的代码库现在有很多#if pragma，有时很难管理。整个#if pragma 最糟糕的部分是Visual Studio 只是忽略了任何不能用当前定义编译的东西，因此很容易检查重大更改。

[NUnit](http://www.nunit.org/index.php)支持 1.1 和 2.0，因此是测试框架的不错选择。[使用NAnt](http://nant.sourceforge.net/)之类的东西来制作单独的 1.1 和 2.0 构建，然后自动运行 NUnit 测试并不难。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T18:00:11.367

如果你想做这样的事情，你需要使用预处理器命令和条件编译符号。

我会使用清楚地表明您所针对的 .NET 版本的符号（例如 NET11 和 NET20），然后像这样包装相关代码：

```
#if NET11
// .NET 1.1 code
#elif NET20
// .NET 2.0 code
#endif 
```

这样做的原因而不是简单的 if/else 是为了防止有人忘记定义符号的额外保护层。

话虽如此，您应该真正深入了解您想要/需要这样做的原因的核心。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T17:52:36.283

我会问为什么你必须维护两个代码库的问题，如果有任何机会，我会选择一个并使用它。

尝试使两个代码库与更改数量和更改类型保持同步将非常复杂，并且为任一版本构建的构建过程将非常复杂。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T17:57:59.173

我们遇到了这个问题，最终得到了一个“兼容性层”，我们在其中为 .NET v1.1 和 v2.0 实现了一组接口和实用程序代码。

然后我们的安装程序为正确的版本制定了正确的代码。我们使用了[NSIS](http://nsis.sourceforge.net/)（免费！），它们具有您可以调用以确定 .NET 版本的函数。

# oracle - 从 Oracle 10g 数据库模式中删除连接的用户

> ID：85804
> 
> 赞同：70
> 
> 时间：2008-09-17T17:49:32.890
> 
> 标签：oracle

有没有比重新启动 Oracle 数据库服务更好的方法来强制断开所有用户与 Oracle 10g 数据库模式的连接？

我们有几个开发人员使用 SQL Developer 连接到单个 Oracle 10g 服务器上的相同模式。问题是当我们想要删除模式以重建它时，不可避免地有人仍然连接，我们不能在有人仍然连接时删除数据库模式或用户。

出于同样的原因，我们不希望删除与其他模式的所有连接，因为其他人可能仍然连接并使用这些模式进行测试。

有谁知道快速解决这个问题的方法？

* * *

## 回答 #1

> 赞同：116
> 
> 时间：2008-09-17T19:33:17.913

要查找会话，作为 DBA 使用

> `select sid,serial# from v$session where username = '<your_schema>'`

如果您想确保只获取使用 SQL Developer 的会话，您可以添加`and program = 'SQL Developer'`. 如果您只想终止属于特定开发人员的会话，您可以添加限制`os_user`

然后用

> `alter system kill session '<sid>,<serial#>'`
> 
> （例如`alter system kill session '39,1232'`）

产生现成的终止语句的查询可以是

> `select 'alter system kill session ''' || sid || ',' || serial# || ''';' from v$session where username = '<your_schema>'`

这将为该用户在每个会话中返回一个 kill 语句 - 例如：

`alter system kill session '375,64855';`

`alter system kill session '346,53146';`

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2013-05-20T06:34:32.700

使用此查询查找与 DB 的现有会话：

```
SELECT s.inst_id,
       s.sid,
       s.serial#,
       p.spid,
       s.username,
       s.program
FROM   gv$session s
       JOIN gv$process p ON p.addr = s.paddr AND p.inst_id = s.inst_id
WHERE  s.type != 'BACKGROUND'; 
```

你会看到类似下面的内容。 ![甲骨文会议](https://i.stack.imgur.com/MVSnY.jpg)

然后，使用从上述结果中提取的值运行下面的查询。

```
ALTER SYSTEM KILL SESSION '<put above s.sid here>,<put above s.serial# here>'; 
```

例如： *ALTER SYSTEM KILL SESSION '93,943'；*

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-12-10T13:29:42.563

我的建议是这个简单的匿名块：

```
DECLARE
   lc_username   VARCHAR2 (32) := 'user-name-to-kill-here';
BEGIN
   FOR ln_cur IN (SELECT sid, serial# FROM v$session WHERE username = lc_username)
   LOOP
      EXECUTE IMMEDIATE ('ALTER SYSTEM KILL SESSION ''' || ln_cur.sid || ',' || ln_cur.serial# || ''' IMMEDIATE');
   END LOOP;
END;
/ 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-23T19:04:05.430

确保在杀死它们之前更改系统并启用受限会话，否则它们会在您完成工作之前快速登录回数据库。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T17:56:55.557

您是否尝试过 ALTER SYSTEM KILL SESSION？从 V$SESSION 获取给定模式中每个会话的 SID 和 SERIAL#，然后执行

ALTER SCHEMA KILL SESSION *sid* , *serial#* ;

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-19T15:50:53.943

只是我的两分钱：最好的方法（但在短期内可能不是最快的）可能是每个开发人员在他自己的数据库实例上工作（参见[数据库工作规则#1](http://odetocode.com/Blogs/scott/archive/2008/01/30/11702.aspx)）。

[自Oracle 数据库 10g 快捷版](http://www.oracle.com/technology/products/database/xe/index.html)以来，在开发人员站上安装 Oracle 已成为一件轻而易举的事。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-02-23T16:37:34.457

只需使用 SQL：

```
disconnect; 

conn tiger/scott as sysdba; 
```

# internet-explorer - 通过 ASP.NET 向用户发送 Excel

> ID：85807
> 
> 赞同：0
> 
> 时间：2008-09-17T17:50:06.617
> 
> 标签：internet-explorer, excel, vba

我有一个 Web 应用程序，它能够打开一个 Excel 模板，将数据推送到工作表中并将文件发送给用户。打开文件时，VBA 宏将根据推送到模板中的数据刷新数据透视表。

用户收到标准的文件打开/保存对话框。

在 Internet Explorer（版本 6）中，如果用户选择保存文件，则在打开文件时 VBA 代码会按预期运行，但是如果用户选择“打开”，则 VBA 将失败并显示：

运行时错误 1004：无法打开数据透视表源文件。

在所有其他浏览器中，都按预期打开和保存工作。

我无权升级到更新版本的 IE（企业官僚机构）；我可以做些什么来让用户在不先保存的情况下打开？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-17T18:07:38.433

较新版本的 Excel 真的不喜欢自动运行宏。如果您真的想生成 Excel 文件并将其发送给您的用户，请使用 Excel 的 COM 接口或一些可以读取/写入 XLS 文件的库在服务器上构建完整文件，然后发送完成的文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T18:15:06.870

如果我不得不猜测，我会说它与文件当前所在的区域有关。当您单击“打开”时，它可能仍被视为“互联网区域”。VBA 不应在该区域内运行。

让用户将服务器网站标记为安全（控制面板 -> Internet 选项 -> 安全 -> 受信任的站点 -> 站点），看看是否有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T18:04:35.693

打开或保存的选项是浏览器选择项，据我所知，无法覆盖此行为。

# javascript - 如何判断 JavaScript 函数是否已定义

> ID：85815
> 
> 赞同：329
> 
> 时间：2008-09-17T17:50:53.073
> 
> 标签：javascript, reflection

如何判断 JavaScript 中的函数是否已定义？

我想做这样的事情

```
function something_cool(text, callback) {
    alert(text);
    if( callback != null ) callback();
} 
```

但它让我

> 回调不是函数

未定义回调时出错。

* * *

## 回答 #1

> 赞同：525
> 
> 时间：2008-09-17T17:51:50.217

```
typeof callback === "function" 
```

* * *

## 回答 #2

> 赞同：247
> 
> 时间：2008-09-17T18:08:34.467

当前的所有答案都使用文字字符串，如果可能的话，我宁愿在我的代码中不使用该字符串 - 这不会（并提供有价值的语义含义，以便启动）：

```
function isFunction(possibleFunction) {
  return typeof(possibleFunction) === typeof(Function);
} 
```

就个人而言，我尝试减少代码中挂起的字符串数量......

* * *

此外，虽然我知道它`typeof`是一个运算符而不是一个函数，但使用使其显示为后者的语法几乎没有什么害处。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2008-09-17T18:05:36.220

```
if (callback && typeof(callback) == "function") 
```

请注意，回调（单独）计算`false`结果是否为`undefined`、`null`、`0`或`false`。比较`null`过于具体。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2010-09-21T16:52:52.827

如果未定义变量，那些判断函数是否实现的方法也会失败，因此我们使用了更强大的支持接收字符串的方法：

```
function isFunctionDefined(functionName) {
    if(eval("typeof(" + functionName + ") == typeof(Function)")) {
        return true;
    }
}

if (isFunctionDefined('myFunction')) {
    myFunction(foo);
} 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-09-17T17:52:13.837

尝试：

```
if (typeof(callback) == 'function') 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2014-04-29T16:47:26.557

JavaScript 新手我不确定行为是否发生了变化，但如果未定义可能的函数，Jason Bunting（6 年前）给出的解决方案将不起作用。

```
function isFunction(possibleFunction) {
  return (typeof(possibleFunction) == typeof(Function));
} 
```

`ReferenceError: possibleFunction is not defined`当引擎尝试解析符号 possibleFunction 时，这将引发错误（如 Jason 回答的评论中所述）

为避免这种行为，您只能传递要检查它是否存在的函数的名称。所以

```
var possibleFunction = possibleFunction || {};
if (!isFunction(possibleFunction)) return false; 
```

这会将变量设置为您要检查的函数或未定义的空对象，从而避免上述问题。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2015-01-23T23:53:48.610

我可能会

```
try{
    callback();
}catch(e){}; 
```

我知道有一个公认的答案，但没有人建议这个。我不确定这是否符合惯用语的描述，但它适用于所有情况。

在较新的 JavaScript 引擎中，`finally`可以使用 a 代替。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2008-09-17T17:53:46.797

```
typeof(callback) == "function" 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2008-09-17T17:59:42.477

```
function something_cool(text, callback){
    alert(text);
    if(typeof(callback)=='function'){ 
        callback(); 
    };
} 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2008-09-17T22:50:31.887

```
if ('function' === typeof callback) ... 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2008-09-17T17:54:40.320

尝试：

```
if (!(typeof(callback)=='undefined')) {...} 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2012-05-09T22:02:38.890

试试这个：

```
callback instanceof Function 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2016-04-16T21:15:38.797

如果您查看@Venkat Sudheer Reddy Aedama 提到的库的[来源，underscorejs，您可以看到：](http://underscorejs.org/docs/underscore.html)

```
_.isFunction = function(obj) {
  return typeof obj == 'function' || false;
}; 
```

这只是我的提示，提示答案：>

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2015-01-28T21:01:46.950

如果你使用[http://underscorejs.org](http://underscorejs.org)，你有： [http://underscorejs.org/#isFunction](http://underscorejs.org/#isFunction)

```
_.isFunction(callback); 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2015-06-04T14:51:51.957

我一直在寻找如何检查是否定义了 jQuery 函数，但我并不容易找到它。

也许可能需要它；）

```
if(typeof jQuery.fn.datepicker !== "undefined") 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2017-10-14T09:56:29.923

如果`callback()`您不仅在函数中调用一次，则可以初始化参数以供重用：

```
callback = (typeof callback === "function") ? callback : function(){}; 
```

例如：

```
function something_cool(text, callback) {
    // Initialize arguments
    callback = (typeof callback === "function") ? callback : function(){};

    alert(text);

    if (text==='waitAnotherAJAX') {
        anotherAJAX(callback);
    } else {
        callback();
    }
} 
```

限制是它总是会执行回调参数，尽管它是未定义的。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2017-10-14T10:26:35.160

对于全局函数，您可以使用此函数而不是`eval`答案之一中建议的函数。

```
var global = (function (){
    return this;
})();

if (typeof(global.f) != "function")
    global.f = function f1_shim (){
        // commonly used by polyfill libs
    }; 
```

你也可以使用`global.f instanceof Function`，但是 afaik。的值`Function`在不同的框架中会有所不同，因此它只能在单个框架应用程序中正常工作。这就是我们通常使用的原因`typeof`。请注意，在某些环境中也可能存在异常`typeof f`，例如，在 MSIE 6-8 中，某些功能`alert`具有“对象”类型。

通过本地函数，您可以使用已接受答案中的函数。您也可以测试该函数是本地的还是全局的。

```
if (typeof(f) == "function")
    if (global.f === f)
        console.log("f is a global function");
    else
        console.log("f is a local function"); 
```

为了回答这个问题，示例代码在最新的浏览器中对我有用，没有错误，所以我不确定它有什么问题：

```
function something_cool(text, callback) {
    alert(text);
    if( callback != null ) callback();
} 
```

注意：我会使用`callback !== undefined`而不是`callback != null`，但它们的作用几乎相同。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2018-01-20T06:46:08.407

大多数（如果不是全部）以前的答案都有副作用来调用该函数

这里是最佳实践

你有功能

```
function myFunction() {
        var x=1;
    }
```

直接测试它的方法

```
//direct way
        if( (typeof window.myFunction)=='function')
            alert('myFunction is function')
        else
            alert('myFunction is not defined');
```

使用字符串，因此您只能在一个地方定义函数名

```
//byString
        var strFunctionName='myFunction'
        if( (typeof window[strFunctionName])=='function')
            alert(s+' is function');
        else
            alert(s+' is not defined');
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2019-07-30T14:48:39.833

如果你想重新定义函数，最好使用函数变量，这些变量是按照它们出现的顺序定义的，因为函数是全局定义的，不管它们出现在哪里。

创建一个调用前一个同名函数的新函数的示例：

```
A=function() {...} // first definition
...
if (typeof A==='function')
   oldA=A;
A=function() {...oldA()...} // new definition 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2019-09-10T18:24:12.067

这对我有用

```
if( cb && typeof( eval( cb ) ) === "function" ){
    eval( cb + "()" );
} 
```

* * *

## 回答 #21

> 赞同：-1
> 
> 时间：2021-08-18T08:53:44.360

我宁愿建议以下功能：

```
function isFunction(name) {
    return eval(`typeof ${name} === typeof Function`);
} 
```

* * *

## 回答 #22

> 赞同：-2
> 
> 时间：2016-01-18T20:08:50.943

一站式解决方案：

```
function something_cool(text, callback){
    callback && callback();
} 
```

# php - 如何强制用户通过 HTTPS 而不是 HTTP 访问我的页面？

> ID：85816
> 
> 赞同：142
> 
> 时间：2008-09-17T17:51:06.397
> 
> 标签：php, apache, ssl, https

我只有一个页面，我想强制作为 HTTPS 页面（Apache 上的 PHP）访问。如何在不使整个目录需要 HTTPS 的情况下做到这一点？或者，如果您将表单从 HTTP 页面提交到 HTTPS 页面，它是通过 HTTPS 而不是 HTTP 发送的吗？

这是我的例子：

```
http://www.example.com/some-page.php 
```

我希望它只能通过以下方式访问：

```
https://www.example.com/some-page.php 
```

当然，我可以将指向该页面的所有链接都指向 HTTPS 版本，但这并不能阻止某些傻瓜故意通过 HTTP 访问它……

我想到的一件事是在 PHP 文件的标头中放置一个重定向，以确保他们正在访问 HTTPS 版本：

```
if($_SERVER["SCRIPT_URI"] == "http://www.example.com/some-page.php"){
  header('Location: https://www.example.com/some-page.php');
} 
```

但这不可能是正确的方法，不是吗？

* * *

## 回答 #1

> 赞同：181
> 
> 时间：2008-09-17T17:56:15.730

我之前做的方式基本上和你写的一样，但是没有任何硬编码的值：

```
if($_SERVER["HTTPS"] != "on")
{
    header("位置：https://" . $_SERVER["HTTP_HOST"] . $_SERVER["REQUEST_URI"]);
    出口（）;
}
```

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2008-09-17T17:53:37.530

您可以在 Apache 上使用指令和 mod_rewrite 来做到这一点：

```
<Location /buyCrap.php>
RewriteEngine On
RewriteCond %{HTTPS} off
RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI}
</Location> 
```

[如果需要，您可以使用正则表达式](http://en.wikipedia.org/wiki/Regular_expression)使位置变得更智能。

* * *

## 回答 #3

> 赞同：43
> 
> 时间：2012-08-27T15:53:12.610

您应该强制*客户端始终使用*[HTTP 严格传输安全](https://en.wikipedia.org/wiki/HTTP_Strict_Transport_Security)(HSTS) 标头请求 HTTPS ：

```
// Use HTTP Strict Transport Security to force client to use secure connections only
$use_sts = true;

// iis sets HTTPS to 'off' for non-SSL requests
if ($use_sts && isset($_SERVER['HTTPS']) && $_SERVER['HTTPS'] != 'off') {
    header('Strict-Transport-Security: max-age=31536000');
} elseif ($use_sts) {
    header('Location: https://'.$_SERVER['HTTP_HOST'].$_SERVER['REQUEST_URI'], true, 301);
    // we are in cleartext at the moment, prevent further execution and output
    die();
} 
```

请注意，大多数现代浏览器都支持 HSTS，但不是通用的。因此，如果用户最终使用 HTTP，上述逻辑会手动重定向用户，而不考虑是否支持，然后设置 HSTS 标头，以便进一步的客户端请求应该由浏览器重定向（如果可能）。

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2015-06-23T10:37:31.957

我刚刚创建了一个 .htaccess 文件并添加了：

```
RewriteEngine On
RewriteCond %{HTTPS} off
RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI} 
```

简单的 ！

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2018-10-26T22:50:03.253

PHP方式：

```
$is_https=false;
if (isset($_SERVER['HTTPS'])) $is_https=$_SERVER['HTTPS'];
if ($is_https !== "on")
{
    header("Location: https://".$_SERVER['HTTP_HOST'].$_SERVER['REQUEST_URI']);
    exit(1);
} 
```

Apache mod_rewrite 方式：

```
RewriteCond %{HTTPS} !=on
RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301] 
```

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2010-12-23T15:47:01.897

```
// Force HTTPS for security
if($_SERVER["HTTPS"] != "on") {
    $pageURL = "Location: https://";
    if ($_SERVER["SERVER_PORT"] != "80") {
        $pageURL .= $_SERVER["SERVER_NAME"] . ":" . $_SERVER["SERVER_PORT"] . $_SERVER["REQUEST_URI"];
    } else {
        $pageURL .= $_SERVER["SERVER_NAME"] . $_SERVER["REQUEST_URI"];
    }
    header($pageURL);
} 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2014-12-18T21:56:42.747

在负载均衡器后面运行时必须做这样的事情。帽子提示[https://stackoverflow.com/a/16076965/766172](https://stackoverflow.com/a/16076965/766172)

```
function isSecure() {
    return (
        (!empty($_SERVER['HTTPS']) && $_SERVER['HTTPS'] !== 'off')
     || $_SERVER['SERVER_PORT'] == 443
     || (
            (!empty($_SERVER['HTTP_X_FORWARDED_PROTO']) && $_SERVER['HTTP_X_FORWARDED_PROTO'] == 'https')
         || (!empty($_SERVER['HTTP_X_FORWARDED_SSL'])   && $_SERVER['HTTP_X_FORWARDED_SSL'] == 'on')
        )
    );
}

function requireHTTPS() {
    if (!isSecure()) {
        header('Location: https://' . $_SERVER['HTTP_HOST'] . $_SERVER['REQUEST_URI'], TRUE, 301);
        exit;
    }
} 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2012-12-28T15:46:31.103

[http://www.besthostratings.com/articles/force-ssl-htaccess.html](http://www.besthostratings.com/articles/force-ssl-htaccess.html)

有时您可能需要确保用户正在通过安全连接浏览您的网站。可以使用包含以下行的 .htaccess 文件来实现始终将用户重定向到安全连接 (https://) 的简单方法：

```
RewriteEngine On 
RewriteCond %{SERVER_PORT} 80 
RewriteRule ^(.*)$ https://www.example.com/$1 [R,L] 
```

请注意，.htaccess 应位于网站主文件夹中。

如果您希望对特定文件夹强制使用 HTTPS，您可以使用：

```
RewriteEngine On 
RewriteCond %{SERVER_PORT} 80 
RewriteCond %{REQUEST_URI} somefolder 
RewriteRule ^(.*)$ https://www.domain.com/somefolder/$1 [R,L] 
```

.htaccess 文件应该放在需要强制 HTTPS 的文件夹中。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2015-06-04T22:19:51.053

好的.. 现在有很多关于此的内容，但没有人真正完成“安全”问题。对我来说，使用不安全的东西是荒谬的。

除非你把它当作诱饵。

$_SERVER 传播可以根据知道如何更改的人的意愿进行更改。

同样正如 Sazzad Tushar Khan 和 thebigjc 所说，您也可以使用 httaccess 来执行此操作，这里有很多包含它的答案。

只需添加：

```
RewriteEngine On
RewriteCond %{SERVER_PORT} 80
RewriteRule ^(.*)$ https://example.com/$1 [R,L] 
```

到您的 .httaccess 中的内容结束，仅此而已。

使用这两种工具，我们仍然没有尽可能安全。

剩下的很简单。如果缺少属性，即...

```
if(empty($_SERVER["HTTPS"])){ // SOMETHING IS FISHY
}

if(strstr($_SERVER['HTTP_HOST'],"mywebsite.com") === FALSE){// Something is FISHY
} 
```

还说您已更新您的 httaccess 文件并检查：

```
if($_SERVER["HTTPS"] !== "on"){// Something is fishy
} 
```

您可以检查更多变量，即..

`HOST_URI` *（如果有关于它的静态属性要检查）*

`HTTP_USER_AGENT` *（相同的会话不同的值）*

所以我要说的是，当答案在于组合时，不要只满足于其中一个。

有关更多 httaccess 重写信息，请参阅 docs-> [http://httpd.apache.org/docs/2.0/misc/rewriteguide.html](http://httpd.apache.org/docs/2.0/misc/rewriteguide.html)

Some Stacks here -> [Force SSL/https using .htaccess and mod_rewrite](https://stackoverflow.com/questions/4398951/force-ssl-https-using-htaccess-and-mod-rewrite)
and
[Getting the full URL of the当前页面（PHP）](https://stackoverflow.com/questions/2236873/getting-the-full-url-of-the-current-page-php)
举几个例子。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-09-17T17:54:29.710

用于`$_SERVER['HTTPS']`判断它是否是[SSL](http://en.wikipedia.org/wiki/Transport_Layer_Security)，如果不是则重定向到正确的位置。

请记住，显示表单的页面不需要通过 HTTPS 提供，它是最需要它的回发 URL。

*编辑*：是的，正如下面所指出的，最好在 HTTPS 中进行整个过程。这更让人放心——我指出帖子是最关键的部分。此外，您需要注意将任何 cookie 设置为安全的，因此它们只会通过 SSL 发送。mod_rewrite 解决方案也很漂亮，我用它来保护我自己网站上的许多应用程序。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2020-07-01T15:25:09.387

如果您想使用 PHP 来执行此操作，那么这种方式对我来说非常有效：

```
 <?php

if(!isset($_SERVER["HTTPS"]) || $_SERVER["HTTPS"] != "on") {
    header("Location: https://" . $_SERVER["HTTP_HOST"] . $_SERVER["REQUEST_URI"], true, 301);
    //Prevent the rest of the script from executing.
    exit;
}
?> 
```

它检查 $_SERVER 超全局数组中的 HTTPS 变量，看它是否等于“on”。如果变量不等于on。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-09-17T17:57:36.850

不要在同一页面上混合使用 HTTP 和 HTTPS。如果您有一个通过 HTTP 提供的表单页面，我会对提交数据感到紧张——如果不查看源代码并寻找它，我看不到提交是通过 HTTPS 还是 HTTP。

通过 HTTPS 提供表单以及提交链接并没有太大的优势。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2017-04-06T09:27:02.347

对于那些使用 IIS 的人来说，在 web.config 中添加这一行会有所帮助：

```
<httpProtocol>
    <customHeaders>
        <add name="Strict-Transport-Security" value="max-age=31536000"/>
    </customHeaders>
</httpProtocol>
<rewrite>
    <rules>
        <rule name="HTTP to HTTPS redirect" stopProcessing="true">
              <match url="(.*)" />
              <conditions>
                 <add input="{HTTPS}" pattern="off" ignoreCase="true" />
              </conditions>
              <action type="Redirect" redirectType="Found" url="https://{HTTP_HOST}/{R:1}" />
         </rule>
    </rules>
</rewrite> 
```

完整的示例文件

```
<?xml version="1.0" encoding="UTF-8"?>
<configuration>
    <system.webServer>
        <httpProtocol>
            <customHeaders>
                <add name="Strict-Transport-Security" value="max-age=31536000"/>
             </customHeaders>
        </httpProtocol>
        <rewrite>
            <rules>
                <rule name="HTTP to HTTPS redirect" stopProcessing="true">
                      <match url="(.*)" />
                      <conditions>
                         <add input="{HTTPS}" pattern="off" ignoreCase="true" />
                      </conditions>
                      <action type="Redirect" redirectType="Found" url="https://{HTTP_HOST}/{R:1}" />
                 </rule>
            </rules>
       </rewrite>
   </system.webServer>
</configuration> 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2016-08-17T12:47:12.793

使用它是不够的：

```
if($_SERVER["HTTPS"] != "on")
{
    header("Location: https://" . $_SERVER["HTTP_HOST"] . $_SERVER["REQUEST_URI"]);
    exit();
} 
```

如果您有任何 http 内容（如外部 http 图像源），浏览器将检测到可能的威胁。因此，请确保代码中的所有 ref 和 src 都是 https

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2021-06-27T11:07:17.810

```
if(location.protocol!=='https:'){location.replace(`https:${location.href.substring(location.protocol.length)}`);} 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2016-08-03T10:29:09.233

如果您使用 Apache 或支持 .htaccess 文件的 LiteSpeed 之类的软件，您可以执行以下操作。如果您还没有 .htaccess 文件，您应该在根目录（通常是 index.php 所在的位置）中创建一个新的 .htaccess 文件。现在将这些行添加为 .htaccess 中的第一个重写规则：

```
RewriteEngine On
RewriteCond %{HTTPS} off
RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301] 
```

对于所有重写规则，您只需要在 .htaccess 中使用一次“RewriteEngine On”指令，因此如果您已经拥有它，只需复制第二行和第三行。

我希望这有帮助。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2016-08-31T00:26:00.907

我已经通过许多解决方案检查*$_SERVER[HTTPS]*的状态， 但似乎它不可靠，因为有时它没有设置或设置为开、关等，导致脚本内部循环重定向。

**如果您的服务器支持$_SERVER[SCRIPT_URI]**，这是最可靠的解决方案

 **```
if (stripos(substr($_SERVER[SCRIPT_URI], 0, 5), "https") === false) {
    header("location:https://$_SERVER[HTTP_HOST]$_SERVER[REQUEST_URI]");
    echo "<meta http-equiv='refresh' content='0; url=https://$_SERVER[HTTP_HOST]$_SERVER[REQUEST_URI]'>";
    exit;
} 
```

请注意，根据您的安装，您的服务器可能不支持 $_SERVER[SCRIPT_URI] 但如果支持，这是更好的脚本。

你可以在这里查看：[为什么有些 PHP 安装有 $_SERVER['SCRIPT_URI'] 而其他没有](https://stackoverflow.com/questions/8398391/why-do-some-php-installations-have-serverscript-uri-and-others-not)

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-09-17T17:58:15.600

出于安全原因，您不应该这样做。特别是如果饼干在这里发挥作用。它让您对基于 cookie 的重放攻击敞开大门。

无论哪种方式，您都应该使用 Apache 控制规则来调整它。

然后，您可以测试是否启用了 HTTPS，并根据需要在需要时重定向。

您应该只使用 FORM POST（不获取）重定向到付费页面，并且在没有 POST 的情况下访问该页面应该被重定向回其他页面。（这会抓住人们只是热跳。）

[http://joseph.randomnetworks.com/archives/2004/07/22/redirect-to-ssl-using-apaches-htaccess/](http://joseph.randomnetworks.com/archives/2004/07/22/redirect-to-ssl-using-apaches-htaccess/)

是一个很好的起点，很抱歉没有提供更多。但是你真的*应该*通过 SSL 推动一切。

这是过度保护，但至少你有更少的担忧。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2021-01-04T15:07:22.350

作为替代方案，您可以使用`X-Forwarded-Proto`标头强制重定向到 HTTPS。

在 .htaccess 文件中添加这些行

```
### Force HTTPS
RewriteCond %{HTTP:X-Forwarded-Proto} !https
RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301] 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2018-04-17T09:48:12.607

也许这个可以帮助你，这就是我为我的网站所做的，它就像一个魅力：

```
$protocol = $_SERVER["HTTP_CF_VISITOR"];

if (!strstr($protocol, 'https')){
    header("Location: https://" . $_SERVER["HTTP_HOST"] . $_SERVER["REQUEST_URI"]);
    exit();
} 
```

* * *

## 回答 #21

> 赞同：-1
> 
> 时间：2016-07-26T00:11:31.283

我已经使用了这个脚本，它在网站上运行良好。

```
if(empty($_SERVER['HTTPS']) || $_SERVER['HTTPS'] == "off"){
    $redirect = 'https://' . $_SERVER['HTTP_HOST'] . $_SERVER['REQUEST_URI'];
    enter code hereheader('HTTP/1.1 301 Moved Permanently');
    header('Location: ' . $redirect);
    exit();
} 
```

* * *

## 回答 #22

> 赞同：-2
> 
> 时间：2014-09-29T00:23:02.167

```
<?php 
// Require https
if ($_SERVER['HTTPS'] != "on") {
    $url = "https://". $_SERVER['SERVER_NAME'] . $_SERVER['REQUEST_URI'];
    header("Location: $url");
    exit;
}
?> 
```

就这么简单。

# rest - 学习服务器 RESTful 代码的最佳方式是什么？

> ID：85856
> 
> 赞同：3
> 
> 时间：2008-09-17T17:55:35.327
> 
> 标签：rest, https, opensocial

我是一位经验丰富的客户端应用程序开发人员 (C++/C#)，但需要快速加快编写服务器端代码以执行 RESTful 交互的速度。具体来说，我需要学习如何通过 RESTful API 与 OpenSocial 容器交换数据。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-17T18:15:11.597

RESTWiki[是](http://rest.blueoxen.net/cgi-bin/wiki.pl)一个非常好的资源，然后是经典的[“我如何向我的妻子解释 REST”](http://tomayko.com/writings/rest-to-my-wife)。

但是，不要忘记直接从[源代码](http://www.ics.uci.edu/%7Efielding/pubs/dissertation/top.htm)中阅读它，它并不像最初看起来那样难读。

我假设您将通过 HTTP 进行 REST，所以[这](https://www.rfc-editor.org/rfc/rfc2616)将非常方便。

最后，考虑到 OpenSocial 支持 Atom 发布协议，[这](http://ietfreport.isoc.org/idref/draft-ietf-atompub-protocol/)将很有用。

享受。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-17T18:09:49.707

[RESTful Web 服务](http://www.crummy.com/writing/RESTful-Web-Services/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T18:04:26.240

我发现这[是](http://www.xfront.com/REST-Web-Services.html)对 RESTful Web 应用程序的一个很好的介绍，尽管它不涉及 OpenSocial 容器。

# c# - 更新源代码时 C# 组件不刷新

> ID：85866
> 
> 赞同：1
> 
> 时间：2008-09-17T17:56:14.543
> 
> 标签：c#, .net, custom-component

我有很多项目的解决方案。一个项目包含很少的自定义组件。这些组件之一用于在图像上显示标题。我们可以改变背景的颜色和许多其他的东西。

问题是如果我决定更改组件背景的默认颜色或更改文本的位置，这些更改不会反映在使用该组件的解决方案的所有其他项目中。我已经编译了组件的项目，所有其他项目都通过项目引用了该组件。

目前，我要做的就是将另一个项目中的组件一个接一个地取下来，然后将其添加回来，那么一切都很好。你有快速的方法吗？

**更新** 我在该组件中添加了一个 CheckBox ，似乎该复选框无处不在！美好的！但是，当一个属性有一些标签可以让组件更改时（例如背景颜色），它不会更改“默认”值，而是将旧值作为更改后的值放入属性中。所以，如果我没有在“属性”面板中手动添加更改颜色，我会看到旧值设置...

**更新 2** [替代文字 http://img517.imageshack.us/img517/9112/oldonenewoneei0.png](http://img517.imageshack.us/img517/9112/oldonenewoneei0.png)

**更新 3：**

这个问题仍然存在。只是为了让人们知道我仍然很想找到一种方法。

我已经尝试了一些你的建议。

1.  如果我清理所有解决方案并仅构建具有自定义控件的项目，那么我将构建解决方案。没有任何变化（为了测试它，我将组件的颜色更改为黄色。没有任何变化：**失败**。
2.  如果我删除引用并将其添加回项目，然后重建解决方案。我可以看到设计师的旧颜色：**失败**。

对于那些想要帮助我的人，我已经用更多信息和图片（上图）更新了这个问题。

如您所见，组件的旧“编译”显示黄色背景，但是当我插入一个新组件（从 Visual Studio 的左侧工具栏）时，我可以让新组件具有假定的白色背景......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-17T18:01:38.290

这很可能是由于**[引用](http://msdn.microsoft.com/en-us/library/z6609kte.aspx)**。

您的其他项目可能会**[复制](http://msdn.microsoft.com/en-us/library/ms169644.aspx)**对您的组件项目的引用。您必须重建这些其他项目，以便它们在引用的组件项目中重新复制（如果它已更改）。它仅在构建时更新。

您可以通过让它们成为同一解决方案的一部分来解决这个问题。在这种情况下，您可以正确设置**[项目依赖](http://msdn.microsoft.com/en-us/library/cb8t5a6t.aspx)**项，它应该会自动为您处理事情。但是，将所有内容都放在同一个解决方案中并不总是正确的做法。

如果您已经将它们作为同一解决方案的一部分，或者它不是引用问题，则可能是由于**[组件序列化](http://msdn.microsoft.com/en-us/library/system.componentmodel.designerserializationvisibility.aspx)**。在进行自定义控件开发时，我们经常遇到这种怪癖。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T18:00:00.837

我的猜测是设计者很聪明，并且会记住设计器中的组件设置，因此将其视为默认设置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T18:00:32.693

这听起来不寻常。右键单击解决方案并点击“清洁解决方案”可能会有所帮助（它将从每个项目的 bin 目录中删除所有 dll 和可执行文件，这会强制进行新的构建）

您可能还想检查您的构建顺序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T18:02:33.437

我在一个有类似问题的项目上工作，我发现如果您触摸 .NET 配置文件或程序集信息文件（取决于您的项目类型）。然后其他项目将反映组件更改...

我不确定为什么会发生这种情况，但这就是我克服它的方法......

最近我已经切换到通过 Nant 构建所有东西，这完全解决了这个问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T18:04:21.077

有时，可视化设计器会序列化代码隐藏中的所有属性，即使它们具有默认值。

如果您的组件的默认背景色为红色，并且您将默认背景色更改为蓝色，则使用您的组件的组件会将其更改回红色。

# visual-c++ - 将 HTMLHelp.lib 与 x64 链接

> ID：85872
> 
> 赞同：1
> 
> 时间：2008-09-17T17:56:58.863
> 
> 标签：visual-c++, 64-bit, chm

我有一个使用 HtmlHelp 的 VS05 C++ (MFC) 项目（函数 HTMLHelpA，从 HmleHelp.lib 链接，来自 HTML HElp Workshop v1.4）。32 位版本编译和链接很好。

64 位版本可以正常编译，但在链接时在 HTMLHelpA 上出现“未解决的外部”错误。

所以，我的问题很简单：有没有办法在 x64 中使用 HTMLHelp？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T18:16:36.803

如果您下载最新的 Windows SDK (6.0A)，它包含此库的 x86 和 x64 版本。

# bash - 判断bash中是否存在函数

> ID：85880
> 
> 赞同：218
> 
> 时间：2008-09-17T17:57:38.300
> 
> 标签：bash, function, testing, scripting

目前我正在做一些从 bash 执行的单元测试。单元测试在 bash 脚本中初始化、执行和清理。该脚本通常包含一个 init()、execute() 和 cleanup() 函数。但它们不是强制性的。我想测试它们是否已定义。

我以前通过 greping 和 seding 源来做到这一点，但这似乎是错误的。有没有更优雅的方法来做到这一点？

编辑：以下片段就像一个魅力：

```
fn_exists()
{
    LC_ALL=C type $1 | grep -q 'shell function'
} 
```

* * *

## 回答 #1

> 赞同：229
> 
> 时间：2008-09-17T18:00:15.283

像这样：`[[ $(type -t foo) == function ]] && echo "Foo exists"`

内置`type`命令将告诉您某物是函数、内置函数、外部命令还是未定义。

其他示例：

```
$ LC_ALL=C type foo
bash: type: foo: not found

$ LC_ALL=C type ls
ls is aliased to `ls --color=auto'

$ which type

$ LC_ALL=C type type
type is a shell builtin

$ LC_ALL=C type -t rvm
function

$ if [ -n "$(LC_ALL=C type -t rvm)" ] && [ "$(LC_ALL=C type -t rvm)" = function ]; then echo rvm is a function; else echo rvm is NOT a function; fi
rvm is a function 
```

* * *

## 回答 #2

> 赞同：100
> 
> 时间：2008-09-17T18:04:14.213

内置 bash 命令`declare`具有`-F`显示所有已定义函数名称的选项。如果给定名称参数，它将显示存在哪些函数，如果都存在，它将相应地设置状态：

```
$ fn_exists() { declare -F "$1" > /dev/null; }

$ unset f
$ fn_exists f && echo yes || echo no
no

$ f() { return; }
$ fn_exist f && echo yes || echo no
yes 
```

* * *

## 回答 #3

> 赞同：45
> 
> 时间：2012-03-02T08:08:47.280

如果 declare 比 test 快 10 倍，这似乎是显而易见的答案。

编辑：下面，这个`-f`选项对于 BASH 来说是多余的，请随意将其省略。就个人而言，我很难记住哪个选项做什么，所以我只使用两者。 ***-f**显示函数，**-F**显示函数名。*

```
#!/bin/sh

function_exists() {
    declare -f -F $1 > /dev/null
    return $?
}

function_exists function_name && echo Exists || echo No such function 
```

声明的“-F”选项导致它只返回找到的函数的名称，而不是整个内容。

使用 /dev/null 不应该有任何可衡量的性能损失，如果它让您非常担心：

```
fname=`declare -f -F $1`
[ -n "$fname" ]    && echo Declare -f says $fname exists || echo Declare -f says $1 does not exist 
```

或者将两者结合起来，为你自己毫无意义的享受。他们都工作。

```
fname=`declare -f -F $1`
errorlevel=$?
(( ! errorlevel )) && echo Errorlevel says $1 exists     || echo Errorlevel says $1 does not exist
[ -n "$fname" ]    && echo Declare -f says $fname exists || echo Declare -f says $1 does not exist 
```

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2012-01-25T11:34:09.403

借鉴其他解决方案和评论，我想出了这个：

```
fn_exists() {
  # appended double quote is an ugly trick to make sure we do get a string -- if $1 is not a known command, type does not output anything
  [ `type -t $1`"" == 'function' ]
} 
```

用作...

```
if ! fn_exists $FN; then
    echo "Hey, $FN does not exist ! Duh."
    exit 2
fi 
```

它检查给定的参数是否是一个函数，并避免重定向和其他 grepping。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2010-02-12T15:57:48.127

挖掘一个旧帖子......但我最近使用了这个并测试了描述的两种替代方案：

```
test_declare () {
    a () { echo 'a' ;}

    declare -f a > /dev/null
}

test_type () {
    a () { echo 'a' ;}
    type a | grep -q 'is a function'
}

echo 'declare'
time for i in $(seq 1 1000); do test_declare; done
echo 'type'
time for i in $(seq 1 100); do test_type; done 
```

这产生了：

```
real    0m0.064s
user    0m0.040s
sys     0m0.020s
type

real    0m2.769s
user    0m1.620s
sys     0m1.130s 
```

声明速度更快！

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2012-05-28T18:09:26.923

它归结为使用“声明”来检查输出或退出代码。

输出风格：

```
isFunction() { [[ "$(declare -Ff "$1")" ]]; } 
```

用法：

```
isFunction some_name && echo yes || echo no 
```

但是，如果没有记忆，重定向到 null 比输出替换更快（说到，糟糕且过时的 `cmd` 方法应该被摒弃，而使用 $(cmd)。）并且由于如果找到，则声明返回 true/false/未找到，并且函数返回函数中最后一个命令的退出代码，因此通常不需要显式返回，并且由于检查错误代码比检查字符串值（甚至是空字符串）更快：

退出状态样式：

```
isFunction() { declare -Ff "$1" >/dev/null; } 
```

这可能是你能得到的最简洁和温和的。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2016-11-19T13:03:01.177

测试不同的解决方案：

```
#!/bin/bash

test_declare () {
    declare -f f > /dev/null
}

test_declare2 () {
    declare -F f > /dev/null
}

test_type () {
    type -t f | grep -q 'function'
}

test_type2 () {
     [[ $(type -t f) = function ]]
}

funcs=(test_declare test_declare2 test_type test_type2)

test () {
    for i in $(seq 1 1000); do $1; done
}

f () {
echo 'This is a test function.'
echo 'This has more than one command.'
return 0
}
post='(f is function)'

for j in 1 2 3; do

    for func in ${funcs[@]}; do
        echo $func $post
        time test $func
        echo exit code $?; echo
    done

    case $j in
    1)  unset -f f
        post='(f unset)'
        ;;
    2)  f='string'
        post='(f is string)'
        ;;
    esac
done 
```

输出例如：

> test_declare (f 是函数)
> 
> 真实 0m0,055s 用户 0m0,041s 系统 0m0,004s 退出代码 0
> 
> test_declare2 (f 是函数)
> 
> 真实 0m0,042s 用户 0m0,022s 系统 0m0,017s 退出代码 0
> 
> test_type (f 是函数)
> 
> 真正的 0m2,200s 用户 0m1,619s 系统 0m1,008s 退出代码 0
> 
> test_type2 (f 是函数)
> 
> 真正的 0m0,746s 用户 0m0,534s 系统 0m0,237s 退出代码 0
> 
> test_declare (f 未设置)
> 
> 真正的 0m0,040s 用户 0m0,029s 系统 0m0,010s 退出代码 1
> 
> test_declare2 (f 未设置)
> 
> 真正的 0m0,038s 用户 0m0,038s 系统 0m0,000s 退出代码 1
> 
> test_type (f 未设置)
> 
> 真正的 0m2,438s 用户 0m1,678s 系统 0m1,045s 退出代码 1
> 
> test_type2 (f 未设置)
> 
> 真正的 0m0,805s 用户 0m0,541s 系统 0m0,274s 退出代码 1
> 
> test_declare (f 是字符串)
> 
> 真正的 0m0,043s 用户 0m0,034s 系统 0m0,007s 退出代码 1
> 
> test_declare2 (f 是字符串)
> 
> 真正的 0m0,039s 用户 0m0,035s 系统 0m0,003s 退出代码 1
> 
> test_type (f 是字符串)
> 
> 真正的 0m2,394s 用户 0m1,679s 系统 0m1,035s 退出代码 1
> 
> test_type2 (f 是字符串)
> 
> 真正的 0m0,851s 用户 0m0,554s 系统 0m0,294s 退出代码 1

所以`declare -F f`似乎是最好的解决方案。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2017-10-11T14:34:54.550

从我对另一个答案的评论（当我回到这个页面时我一直错过）

```
$ fn_exists() { test x$(type -t $1) = xfunction; }
$ fn_exists func1 && echo yes || echo no
no
$ func1() { echo hi from func1; }
$ func1
hi from func1
$ fn_exists func1 && echo yes || echo no
yes 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-10-08T22:46:38.930

这告诉你它是否存在，但不是它是一个函数

```
fn_exists()
{
  type $1 >/dev/null 2>&1;
} 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2016-01-31T17:50:44.513

```
fn_exists()
{
   [[ $(type -t $1) == function ]] && return 0
} 
```

*更新*

```
isFunc () 
{ 
    [[ $(type -t $1) == function ]]
}

$ isFunc isFunc
$ echo $?
0
$ isFunc dfgjhgljhk
$ echo $?
1
$ isFunc psgrep && echo yay
yay
$ 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2021-02-09T00:01:35.397

### 如果定义了函数的调用。

**已知函数名**。假设名称是`my_function`，然后使用

```
[[ "$(type -t my_function)" == 'function' ]] && my_function;
# or
[[ "$(declare -fF my_function)" ]] && my_function; 
```

**函数的名称存储在一个变量**中。如果我们声明`func=my_function`，那么我们可以使用

```
[[ "$(type -t $func)" == 'function' ]] && $func;
# or
[[ "$(declare -fF $func)" ]] && $func; 
```

**`||`使用而不是相同的结果`&&`**
（这种逻辑反转在编码期间可能很有用）

```
[[ "$(type -t my_function)" != 'function' ]] || my_function;
[[ ! "$(declare -fF my_function)" ]] || my_function;

func=my_function
[[ "$(type -t $func)" != 'function' ]] || $func;
[[ ! "$(declare -fF $func)" ]] || $func; 
```

**严格模式和前置条件检查**
我们有`set -e`严格模式。
我们`|| return`在函数中使用前提条件。
这会强制终止我们的 shell 进程。

```
# Set a strict mode for script execution. The essence here is "-e"
set -euf +x -o pipefail

function run_if_exists(){
    my_function=$1

    [[ "$(type -t $my_function)" == 'function' ]] || return;

    $my_function
}

run_if_exists  non_existing_function
echo "you will never reach this code" 
```

以上等价于

```
set -e
function run_if_exists(){
    return 1;
}
run_if_exists 
```

这会杀死你的进程。
在先决条件中使用`|| { true; return; }`代替`|| return;`来解决此问题。

```
 [[ "$(type -t my_function)" == 'function' ]] || { true; return; } 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-10-08T22:18:08.660

我会将其改进为：

```
fn_exists()
{
    type $1 2>/dev/null | grep -q 'is a function'
} 
```

并像这样使用它：

```
fn_exists test_function
if [ $? -eq 0 ]; then
    echo 'Function exists!'
else
    echo 'Function does not exist...'
fi 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2012-02-27T14:29:31.820

我特别喜欢[Grégory Joseph的解决方案](https://stackoverflow.com/a/9002012/216172)

但我对其进行了一些修改以克服“双引号丑陋的把戏”：

```
function is_executable()
{
    typeset TYPE_RESULT="`type -t $1`"

    if [ "$TYPE_RESULT" == 'function' ]; then
        return 0
    else
        return 1
    fi
} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2010-06-25T21:09:36.483

可以在没有任何外部命令的情况下使用 'type'，但你必须调用它两次，所以它的速度仍然是 'declare' 版本的两倍：

```
test_function () {
        ! type -f $1 >/dev/null 2>&1 && type -t $1 >/dev/null 2>&1
} 
```

另外，这在 POSIX sh 中不起作用，因此除了琐事之外，它完全没有价值！

# javascript - 如何在 Prototype 中重新实现外部弹出 jQuery 代码？

> ID：85887
> 
> 赞同：1
> 
> 时间：2008-09-17T17:58:15.163
> 
> 标签：javascript, jquery, popup, prototypejs

我在 jQuery 中有这段代码，我想用原型库重新实现。

```
// make external links open in popups
// this will apply a window.open() behaviour to all anchor links
// the not() functions filter iteratively filter out http://www.foo.com 
// and http://foo.com so they don't trigger off the pop-ups

jQuery("a[href='http://']").
      not("a[href^='http://www.foo.com']").
      not("a[href^='http://foo.com']").
      addClass('external');

jQuery("a.external").
      not('a[rel="lightbox"]').click( function() {
      window.open( jQuery(this).attr('href') );
      return false;
}); 
```

如何使用等效于 jQuery 中列出的 not() 运算符来迭代地过滤元素集合？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-17T18:05:22.353

过滤可以使用拒绝方法来完成，如下所示：

```
$$('a').reject(function(element) { return element.getAttribute("href").match(/http:\/\/(www.|)foo.com/); }).invoke("addClassName", "external"); 
```

# vb.net - Visual Basic 2008 中的集合初始化语法？

> ID：85892
> 
> 赞同：23
> 
> 时间：2008-09-17T17:58:36.130
> 
> 标签：vb.net, visual-studio-2008, collections, initialization

我正在尝试确定 Visual Basic 2008（如果重要的话，Express 版）中是否有办法进行内联集合初始化，例如 JavaScript 或 Python：

```
Dim oMapping As Dictionary(Of Integer, String) = {{1,"First"}, {2, "Second"}} 
```

我知道 Visual Basic 2008 支持这样的数组初始化，但我似乎无法让它为集合工作......我的语法错误，还是只是没有实现？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-09-17T18:01:26.637

[Visual Basic 9.0](http://en.wikipedia.org/wiki/Visual_Basic_.NET#Visual_Basic_2008_.28VB_9.0.29)还不支持这一点。但是，[Visual Basic 10.0](http://en.wikipedia.org/wiki/Visual_Basic_.NET#Visual_Basic_2010_.28VB_10.0.29) [将](http://msdn.microsoft.com/en-us/library/dd293617.aspx).

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-03-16T13:47:39.820

下面是使用**From**关键字的[VB 集合初始化器。](https://msdn.microsoft.com/en-us/library/dd293617.aspx)（从 Visual Studio 2010 开始）

 ****列表：**

```
Dim list As New List(Of String) From {"First", "Second"} 
```

**字典：**

```
Dim oMapping As New Dictionary(Of Integer, String) From {{1, "First"}, {2, "Second"}} 
```

# ruby - 是否有教程教授经验丰富的程序员使用的常见 Ruby 编程习语，但对新手可能不明显？

> ID：85916
> 
> 赞同：30
> 
> 时间：2008-09-17T18:01:42.860
> 
> 标签：ruby, idioms

我正在寻找 Ruby 的等价物[Code Like a Pythonista：Idiomatic Python](http://python.net/~goodger/projects/pycon/2007/idiomatic/handout.html)

理想的功能：

*   易于阅读
*   涵盖所有主题的单一文档：提示、技巧、指南、警告和陷阱
*   尺寸小于一本书
*   成语应该为标准分布开箱即用 ( `% sudo apt-get install ruby irb rdoc`)

如果可能，请为每个答案提供一个教程，并附上教程中的示例代码及其含义。

更新：

这些是我遇到的最接近上述描述的资源：

*   [红宝石成语](http://blog.angelbob.com/posts/244)
*   [Ruby 用户指南](http://www.rubyist.net/~slagell/ruby/index.html)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-28T03:21:49.197

[Ruby Idioms（最初来自 RubyGarden）](http://blog.angelbob.com/posts/244)是我常用的成语参考。它组织清晰且相当完整。正如作者所说，这些来自 RubyGarden，它[曾经](http://web.archive.org/web/20071016094753/www.rubygarden.org/Ruby/page/show/HomePage)非常酷（感谢[Wayback Machine](http://www.archive.org/)）。不过现在好像[下线](http://rubygarden.org/)了。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-09-17T18:35:41.500

这是一个幻灯片： [Idiomatic Ruby](http://cbcg.net/talks/rubyidioms/)。

摘抄：

' `until`' 像 ' `while not`'

```
 x = x * 2 until x > 100 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-28T03:52:19.043

我会推荐常年经典：**[Why's Poignant guide](http://poignantguide.net/ruby/)**

它既是对 Ruby 的介绍，也是对 Ruby 方式的调查。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-03T15:17:13.177

查看[The Ruby Way](https://rads.stackoverflow.com/amzn/click/com/0672328844)和[The Rails Way](https://rads.stackoverflow.com/amzn/click/com/0321445619)，它们不是教程，但我认为它们会涵盖您正在寻找的内容。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-17T18:09:18.600

虽然不是直接的教程，但这里有一个关于主题的博客

[http://its.arubything.com/](http://its.arubything.com/)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-28T03:21:30.133

[Neigborly 先生的谦逊小红宝石书](http://www.humblelittlerubybook.com/book/)怎么样

摘抄：

```
IO.foreach("textfile.txt") {|line| puts line } 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-31T00:44:24.733

理解 Ruby 闭包的可执行指南，[closures-in-ruby.rb](http://innig.net/software/ruby/closures-in-ruby.rb)。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-07-21T23:09:35.550

我最近发现了这个博客。还没有真正进入它，我读过的几篇文章有点面向初学者。YMMV

[http://blog.rubybestpractices.com/](http://blog.rubybestpractices.com/)

# xml - XML Notepad 2007 中断 MS Access 2007 帮助

> ID：85923
> 
> 赞同：0
> 
> 时间：2008-09-17T18:02:48.023
> 
> 标签：xml, ms-office

我尝试在网上搜索有关此问题的帮助，但是那里有太多通用词，以至于我找不到很多相关的东西。

我在 Vista 上安装了 MS Office 2007，后来又安装了 XML Notepad 2007（也是 Microsoft 产品）。似乎 MS Access 帮助系统正在使用 XML Notepad 控制的某种 XML 格式。现在，每当我在 Access 中打开帮助时，都会打开小帮助窗口，而不是显示内容，而是尝试使用 XML 记事本下载内容。咕噜……

有解决办法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-18T17:57:54.670

好的，我找到了答案，对此我有点尴尬。事实上，我的问题非常离题。

首先，XML Notepad 2007 与这个问题无关。它没有劫持文件扩展名或创建注册表项或其他类似的东西。如果您只想打开并检查 XML 文件，这是一个很棒的小程序。我使用它的方式与将记事本用于文本文件的方式相同。我只是想快速浏览一下，我现在不需要称重或等待一个完整的想法。

导致帮助应用程序尝试下载名为 browse0.access.xml 的文件的原因是处于脱机模式。如果您打开目录，则所有内容都可用，除了主页需要互联网连接。

要更正此问题，请单击应用程序右下角的“离线”字样，然后选择“显示 Office Online 中的内容”。这应该让它恢复到正常状态。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T18:18:05.800

对您的 Office 安装进行修复。那，或删除 XMl 记事本（恕我直言，这不是很好）。

# c# - 多种形式和一次更新，它会工作吗？

> ID：85925
> 
> 赞同：0
> 
> 时间：2008-09-17T18:02:56.727
> 
> 标签：c#, .net, compact-framework

我需要在 .NET CF 中创建一个具有不同/单个表单的应用程序，每个表单上有很多绘图/动画。我希望有一个更新[我自己的状态管理等]功能，以便我可以管理不同的状态，这样我的 [J2ME 游戏代码] 就可以在没有太大变化的情况下工作。我已经遇到了一些可能的情况。哪一个会是完美的？

1.  拥有一个表单并手动添加/删除控件，然后使用任何游戏循环技巧。
2.  使用控件创建不同的表单并在主线程中调用 update 和 application.doEvents()。[ while(isAppRunning){ UPDATE() Application.DoEvents() }
3.  根据需要在每个表单上创建一个更新 - 绘制循环。
4.  任何其他想法。

请给我关于这个的建议

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-17T18:46:27.310

如果它是一个游戏，那么我会放弃大部分表单并使用基本要素，如果可能的话处理位图并通过覆盖主表单的绘制方法或驻留在其中的控件（可能是面板）来呈现它。这会给你更好的表现。

主要问题是紧凑的框架并不是真正为很多 UI 乐趣而设计的，你不会像在完整框架中那样免费获得双缓冲，适当的透明度对于 WinForm 控件来说是个婊子，如果你坚持UI 线程的时间太长，您会遇到严重的渲染故障。如果你在后台线程上做太多事情，你甚至可能会得到这些！:O

您永远不会通过显式调用 Application.DoEvents 获得最佳性能，我的经验法则是仅在故障排除或在 UI 中编写小技巧时使用它。

可能值得将游戏放在后台线程上，然后在控件上调用 .Invoke 以编组回主 UI 线程以更新您的显示，从而在处理用户输入的同时使 UI 有足够的时间进行响应。用户输入是我避免使用普通 winform 控件的另一个原因，因为移动设备通常没有很多键，因此能够重新映射它们非常有用，因此我通常避免使用具有预设键事件/响应的 TextBoxes 之类的东西。

我还避免使用不同的表单，因为显示新表单可能会产生微妙的停顿，我通常将控件换成主表单以避免在编写业务软件时出现此问题。

归根结底，可能值得尝试各种技术，看看哪种方法效果最好。也看看你是否能从在 CF 上开发游戏的人那里得到任何提示，因为我通常只做商业软件。

！

# visual-studio - 如何在 Visual Studio 中自动生成多个 getter/setter 或访问器

> ID：85928
> 
> 赞同：5
> 
> 时间：2008-09-17T18:03:18.567
> 
> 标签：visual-studio, visual-studio-2008, ide, code-generation

在开始之前，我知道有这篇文章，但它没有回答我的问题：[如何在 Visual Studio 中生成 getter 和 setter？](https://stackoverflow.com/questions/3017/how-to-generate-getters-and-setters-in-visual-studio)

在 Visual Studio 2008 中，可以通过右键单击私有变量 -> 重构 -> 封装字段来自动生成 getter 和 setter（访问器）...

这对于有 2 或 3 种方法的类来说非常棒，但是来 MS 吧！你什么时候用过一个有几个访问器的类？

我正在寻找一种只需单击几下即可生成 ALL 的方法（那里的 Eclipse 人员会知道我在说什么——您可以右键单击一个类并选择“生成访问器”。完成。）。我真的不喜欢在一节课上花 20 分钟点击向导。我曾经有一些会生成类的 .NET 1.0 代码，但它早已不复存在，这个特性应该是 IDE 的标准。

更新：我可能会提到我发现 Linq to Entities 和 SQLMetal 是非常酷的想法，远远超出了我在上一段中的简单要求。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-17T18:08:15.497

抱歉，您确实需要安装[Resharper](http://www.jetbrains.com/resharper/download/)才能获得与您在 Eclipse 中所使用的大致相同数量的重构支持。

但是，Resharper 为您提供了一个非常类似于您在 Eclipse 中使用的对话框： [![截屏](https://i.stack.imgur.com/wDE9j.png)](https://i.stack.imgur.com/wDE9j.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-17T18:06:40.650

我有一个“信息类生成器”应用程序，您可以使用 Excel 工作表，它会生成私有成员和公共 get/set 方法。

你可以从我的[网站](http://iowacomputergurus.com/free-products/info-class-generator.aspx)免费下载。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-17T18:10:06.930

在 2008 年，我不再为封装字段而烦恼。我对属性使用新语法：

```
public string SomeString { get; set; } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T18:08:01.490

可能是一个宏。还有一些插件（比如 ReSharper，它很棒但很商业化）能够快速做到这一点。

# ms-word - 如何从 Microsoft Word 2003 .dot 文件中导出样式？

> ID：85935
> 
> 赞同：7
> 
> 时间：2008-09-17T18:04:24.773
> 
> 标签：ms-word

我有一个旧的 .dot 文件，里面有几十种样式。
我需要将它们放入我收到的**另一个 .dot 文件中。**有没有比手动重新创建每种样式更好的方法来获取它们？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-17T18:08:02.597

Word 中有一个“样式管理器”工具，如果它们同时打开，您可以将样式从一个文档复制到另一个文档。

在 Word 2007 中：

*   打开样式对话框（主页选项卡 -> 样式 -> 右下按钮）。
*   单击“管理样式”按钮。
*   单击“导入/导出...”

我不记得 Word 2003 中的选项是什么。我认为它是 Tools -> Style Organizer 或类似的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-01-02T02:39:15.283

将样式从当前文档转移到另一个文档的快速 MSO 2003 提示。管理器 UI 左侧显示当前打开的文档，右侧显示 Normal.dot。除了 Normal.dot 之外，点击右侧的下拉菜单不会给你任何东西。魁??

点击右侧的关闭文件按钮。这将被一个 Open File ... 命令按钮替换。从那里选择您想要的任何文件。注意文件类型。MSO 默认为 .dot。

干杯

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T18:14:10.180

使用“Organizer”中的“Styles”选项卡（菜单“Tools”->“Templates and Add-Ins”->“Organizer”）复制样式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-05-30T19:42:34.583

这是在两个文档之间传输样式和格式的方法：

1.  `Go to Tools > Templates & Add-Ins...`
2.  `Click Organizer button...`

干杯

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-03-23T03:00:49.093

Laura 的回答帮助我在 MS Word 2003 中找到它。我点击了工具、模板和加载项、管理器，然后是样式。我只是从两边突出显示了我想要的内容，然后单击“复制”。

谢谢劳拉。我可以投票给你。

# c# - 为什么在 TeeChart ActiveX 5 组件中绘图时出现“画布不允许绘图”？

> ID：85936
> 
> 赞同：0
> 
> 时间：2008-09-17T18:04:26.053
> 
> 标签：c#, .net, system.drawing, teechart

我将 Steema 的 TeeChart ActiveX 5 组件用于 .NET C# 中的应用程序。

我使用这些方法做一些绘图`Line()`，`Rectangle()`并`Circle()`通过`Canvas`组件的“”属性。

我的绘图代码在组件的每个事件`OnBeforeDrawSeries()`和`OnAfterDraw()`事件上都被调用。

当只有几张图纸时，它工作正常。但是当绘制量增加并且在一定数量的重绘之后，我得到`MessageBox`一个错误“**画布不允许绘图**”并且**应用程序退出**。

我相信这在某种程度上是由于绘图调用“重载”了组件。

**我是否以错误的方式使用此功能，或者我可以认为这是组件中的 BUG？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T01:59:33.663

我会认为这是一个错误，因为我在这个组件和它管理内存的方式上有一个类似的问题（不是 Canvas）。

在一些具有少量 RAM 的机器上，当我们创建大量图形并显示它们时，我们将收到一个消息框，其中包含此消息“没有足够的存储空间来处理此命令”。一旦出现此框，就无法关闭此框，因为如果单击“确定”，则会一次又一次地显示该消息框。所以，你需要杀死应用程序才能驾驭它。我认为该错误与绘制过程有关，因为当我们关闭消息框时，组件会尝试重新绘制显示消息框的区域并且再次发生错误。

首先，您知道 TeeChart ActiveX 现在是第 8 版。也许这个版本可以解决这个问题。

我还建议尝试 .NET 版本的 TeeChart。根据我自己的经验，TeeChart .NET 没有任何内存问题，因为内存是由 .NET 框架管理的。

# asp.net - ASPNET 用户没有对 ASP.NET 临时文件的写入权限

> ID：85941
> 
> 赞同：8
> 
> 时间：2008-09-17T18:04:56.427
> 
> 标签：asp.net, visual-studio-2008, iis-5

在我的 XP Professional 机器上运行我的 Visual Studio 2008 ASP.NET 项目（在没有调试的情况下启动）时出现以下错误：

```
System.Web.HttpException: The current identity (machinename\ASPNET) does not have write access to 'C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files'. 
```

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-09-17T18:06:34.177

您是否尝试过框架文件夹中的 aspnet_regiis exe？

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-08-29T20:07:45.453

我有同样的问题。这就是我所做的：

1.  转到 c:\windows\microsoft.net\framework\v2.0.50727
2.  右键单击“临时 ASP.NET 文件”
3.  安全选项卡
4.  从组中选择“用户（xxxxxx\Users）
5.  勾选“写”
6.  好的

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-17T18:08:53.827

要么授予该用户对该目录的访问级别，要么更改应用程序的应用程序池运行的标识 - 在 IIS 管理器中，确定用于运行应用程序的应用程序池，然后在 IIS 管理器的应用程序池部分中，查看在该池的属性中-我认为您想要的选项卡是“身份”（这不在我的脑海中）。

您可以将其设置为另一个用户帐户 - 例如，Crystal Reports .Net 需要对 C:\Temp 的更新和删除访问权限 - 因此我们有一个具有管理员访问权限的“网站管理员”用户，并将该身份用于这些应用程序。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-10-07T08:15:50.613

您可以右键单击 Visual Studio 并选择以管理员身份运行。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T18:09:35.730

您可以尝试使用 c:\windows\microsoft.net\framework\v2.0.50727 中提供的自动 regiis 实用程序 aspnet_regiis.ext 来修复它

否则，只需按照错误中的说明手动添加所需的文件权限。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-11-27T10:42:29.080

我在尝试构建 Web 部署项目 (*.wdploy) 时遇到了这个问题。只需在框架路径上创建文件夹即可解决该错误。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-01-12T12:44:01.080

仅仅因为最近的答案是 5 年，所以在我们的环境中必须做的是删除应用程序、应用程序池并重新创建它们。

随着最近的变化，我们显然在引擎盖下有一些安全性。

这样做会在 Temporary ASP Net Files 中重新创建一个具有所有正确权限的文件夹。为什么我碰巧从源代码控制、重建等获得的一个站点以这种方式失败，不知道。其他 2 人最近设置了下载、重建等获取最新版本的位置。他们刚刚工作。

但是删除应用程序、应用程序池并使用与其他 2 个已知工作站点相同的 IIS 权限重新创建它们重新创建了所有需要的对象，现在一切正常。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-09-17T18:08:00.320

确保 ASPNET 用户有权写入该文件夹。右键单击文件夹，属性，安全选项卡。

# apache-flex - 如何根据多列对 flex 数据网格进行排序？

> ID：85974
> 
> 赞同：8
> 
> 时间：2008-09-17T18:08:42.203
> 
> 标签：apache-flex, actionscript-3, datagrid

我有一个数据网格，填充如下所示。当用户单击列标题时，我想使用字典排序对行进行排序，其中首先使用选定的列，然后以从左到右的顺序使用剩余的列以打破任何关系。我该如何编码？

（我有一个答案，我将在下面发布，但它有一个问题——如果有人能提供更好的答案，我会很高兴！）

这是布局：

```
<?xml version="1.0" encoding="utf-8"?>

<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" 
    layout="absolute" creationComplete="onCreationComplete()">

    <mx:Script source="GridCode.as" />

    <mx:DataGrid id="theGrid" x="61" y="55" width="466" height="317">
        <mx:columns>
            <mx:DataGridColumn dataField="A"/>
            <mx:DataGridColumn dataField="B"/>
            <mx:DataGridColumn dataField="C"/>
        </mx:columns>
    </mx:DataGrid>

</mx:Application> 
```

这是支持代码：

```
import mx.collections.ArrayCollection;
import mx.collections.Sort;
import mx.collections.SortField;
import mx.controls.dataGridClasses.DataGridColumn;
import mx.events.DataGridEvent;

public function onCreationComplete():void
{
    var ar:ArrayCollection = new ArrayCollection();
    var ob:Object;
    for( var i:int=0; i<20; i++ )
    {
        ob = new Object();
        ob["A"] = i;
        ob["B"] = i%3;
        ob["C"] = i%5;
        ar.addItem(ob);
    }
    this.theGrid.dataProvider = ar;
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-17T18:11:21.997

到目前为止，我发现的最佳答案是在用户单击时捕获 headerRelease 事件：

```
<mx:DataGrid id="theGrid" x="61" y="55" width="466" height="317"
        headerRelease="onHeaderRelease(event)"> 
```

然后事件处理程序可以对数据应用排序顺序：

```
private var lastIndex:int = -1;
private var desc:Boolean = false;

public function onHeaderRelease(evt:DataGridEvent):void
{
    evt.preventDefault();

    var srt:Sort = new Sort();
    var fields:Array = new Array();

    if( evt.columnIndex == lastIndex )
    {
        desc = !desc;
    }
    else
    {
        desc = false;
        lastIndex = evt.columnIndex;
    }

    fields.push( new SortField( evt.dataField, false, desc ) );
    if( evt.dataField != "A" )
        fields.push( new SortField("A", false, desc) );
    if( evt.dataField != "B" )
        fields.push( new SortField("B", false, desc) );
    if( evt.dataField != "C" )
        fields.push( new SortField("C", false, desc) );
    srt.fields = fields;

    var ar:ArrayCollection = this.theGrid.dataProvider as ArrayCollection;
    ar.sort = srt;
    ar.refresh();
} 
```

但是这种方法有一个众所周知的问题，即列标题不再显示小箭头来显示排序方向。这是调用 evt.preventDefault() 的副作用，但是您必须进行该调用，否则将不会应用您的自定义排序。

# sql - 查询表的外键关系

> ID：85978
> 
> 赞同：23
> 
> 时间：2008-09-17T18:09:05.497
> 
> 标签：sql, database, oracle, oracle10g

对于给定的表“foo”，我需要一个查询来生成一组具有指向 foo 的外键的表。我正在使用 Oracle 10G。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2008-09-17T18:21:55.323

这应该有效（或接近的东西）：

```
select table_name
from all_constraints
where constraint_type='R'
and r_constraint_name in 
  (select constraint_name
  from all_constraints
  where constraint_type in ('P','U')
  and table_name='<your table here>'); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-18T10:12:31.903

下面的语句应该给孩子们和他们所有的后代。我已经在 Oracle 10 数据库上对其进行了测试。

```
SELECT  level, main.table_name  parent,
    link.table_name child
FROM    user_constraints main, user_constraints link    
WHERE   main.constraint_type    IN ('P', 'U')
AND link.r_constraint_name  = main.constraint_name
START WITH main.table_name  LIKE UPPER('&&table_name')
CONNECT BY main.table_name = PRIOR link.table_name
ORDER BY level, main.table_name, link.table_name 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-05-28T15:14:46.750

以下是如何进一步执行 Mike 的查询以从约束名称中获取**列名称：**

```
select * from user_cons_columns
where constraint_name in (
  select constraint_name 
  from all_constraints
  where constraint_type='R'
  and r_constraint_name in 
    (select constraint_name
    from all_constraints
    where constraint_type in ('P','U')
    and table_name='<your table name here>')); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T19:22:36.053

链接到[Oracle 数据库在线文档](http://www.oracle.com/pls/db102/homepage)

您可能想要探索[数据字典视图](http://download.oracle.com/docs/cd/B19306_01/server.102/b14220/datadict.htm#sthref1164)。他们有前缀：

*   用户
*   全部
*   数据库管理员

样本：

```
select * from dictionary where table_name like 'ALL%' 
```

* * *

继续 Mike 的示例，您可能希望生成脚本来启用/禁用约束。我只修改了第一行中的“选择”。

```
select  'alter table ' || TABLE_NAME || ' disable constraint ' || CONSTRAINT_NAME || ';'
from all_constraints
where constraint_type='R'
and r_constraint_name in 
  (select constraint_name
  from all_constraints
  where constraint_type in ('P','U')
  and table_name='<your table here>'); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-01-21T09:05:33.760

我知道现在回答有点晚了，但还是让我回答吧。上面的一些答案非常复杂，因此这里是一个更简单的方法。

```
SELECT a.table_name child_table, a.column_name child_column, a.constraint_name, 
b.table_name parent_table, b.column_name parent_column
FROM all_cons_columns a
JOIN all_constraints c ON a.owner = c.owner AND a.constraint_name = c.constraint_name
join all_cons_columns b on c.owner = b.owner and c.r_constraint_name = b.constraint_name
WHERE c.constraint_type = 'R'
AND a.table_name = 'your table name' 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T18:24:58.030

下载 10G 的 Oracle 参考指南，其中解释了数据字典表。

上面的答案很好，但请查看可能与约束相关的其他表。

```
SELECT * FROM DICT WHERE TABLE_NAME LIKE '%CONS%'; 
```

最后，获得一个像 Toad 或 SQL Developer 这样的工具，它可以让你在 UI 中浏览这些东西，你需要学习使用表格，但你也应该使用 UI。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-12-01T11:57:00.667

```
select distinct table_name, constraint_name, column_name, r_table_name, position, constraint_type 
from (
    SELECT uc.table_name, 
    uc.constraint_name, 
    cols.column_name, 
    (select table_name from user_constraints where constraint_name = uc.r_constraint_name) 
        r_table_name,
    (select column_name from user_cons_columns where constraint_name = uc.r_constraint_name and position = cols.position) 
        r_column_name,
    cols.position,
    uc.constraint_type
    FROM user_constraints uc
    inner join user_cons_columns cols on uc.constraint_name = cols.constraint_name 
    where constraint_type != 'C'
) 
start with table_name = '&&tableName' and column_name = '&&columnName'  
connect by nocycle 
prior table_name = r_table_name 
and prior column_name = r_column_name; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-07-25T01:58:51.167

```
select      acc.table_name, acc.constraint_name 
from        all_cons_columns acc
inner join all_constraints ac
    on acc.constraint_name = ac.constraint_name
where       ac.r_constraint_name in (
    select  constraint_name
    from    all_constraints
    where   table_name='yourTable'
    ); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-01-10T08:48:32.707

一张表的所有约束

```
select 

    uc.OWNER,
    uc.constraint_name as TableConstraint1,
    uc.r_constraint_name as TableConstraint2,
    uc.constraint_type as constrainttype1,
    us.constraint_type as constrainttype2,
    uc.table_name as Table1,us.table_name as Table2,
    ucc.column_name as TableColumn1, 
    uccs.column_name as TableColumn2
from user_constraints uc
    left outer join user_constraints us on uc.r_constraint_name = us.constraint_name
    left outer join USER_CONS_COLUMNS ucc on ucc.constraint_name = uc.constraint_name
    left outer join USER_CONS_COLUMNS uccs on uccs.constraint_name = us.constraint_name
where uc.OWNER ='xxxx' and uc.table_name='xxxx' 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-03-22T11:28:16.407

在这里加上我的两分钱。

此查询将返回具有子列和父列的所有外键，即使在多个列上有外键时也能完美匹配：

```
SELECT a.table_name child_table, a.column_name child_column, a.constraint_name, 
b.table_name parent_table, b.column_name parent_column
FROM all_cons_columns a
JOIN all_constraints c ON a.owner = c.owner AND a.constraint_name = c.constraint_name
JOIN all_cons_columns b ON c.owner = b.owner AND c.r_constraint_name = b.constraint_name AND b.position = a.position
WHERE c.constraint_type = 'R' 
```

*（灵感来自@arvinq aswer）*

# python - 如何最好地实现简单的崩溃/错误报告？

> ID：85985
> 
> 赞同：8
> 
> 时间：2008-09-17T18:09:32.937
> 
> 标签：python, cross-platform, qa, error-reporting

实现简单的崩溃/错误报告机制的最佳方法是什么？

详细信息：我的应用程序是**跨平台的（mac/windows/linux）并用 Python 编写**，所以我只需要一些可以向我发送少量文本的东西，例如只是一个时间戳和一个回溯（我已经生成并显示在我的错误对话框）。

如果它可以简单地通过电子邮件发送它会很好，但我想不出一种方法来做到这一点，而不在应用程序中包含 smtp 服务器的用户名和密码......我是否应该在服务器端实现一个简单的 Web 服务并让我的应用程序向它发送带有信息的 HTTP 请求？有更好的想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-17T18:16:02.343

Web 服务是最好的方法，但有一些注意事项：

1.  您应该始终询问用户是否可以发送错误反馈信息。
2.  如果出现网络错误，您应该准备好优雅地失败。不要让未能报告崩溃阻碍恢复！
3.  除非用户知道（参见 #1），否则您应该避免包含用户识别信息或敏感信息，并且您应该使用 SSL 或以其他方式保护它。某些司法管辖区给您带来了您可能不想处理的负担，因此最好不要保存此类信息。
4.  像任何网络服务一样，确保您的服务不会被不法分子利用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-17T18:30:25.320

> 如果不在应用程序中包含 smtp 服务器的用户名和密码，我想不出办法来做到这一点......

您只需要用户名和密码即可向智能主机验证您自己的身份。您不需要它直接发送邮件，您需要它通过中继发送邮件，例如您的 ISP 的邮件服务器。完全有可能在没有身份验证的情况下发送电子邮件 - 这就是垃圾邮件如此难以阻止的原因。

话虽如此，一些 ISP 会阻止端口 25 上的出站流量，因此最强大的替代方案是 HTTP POST，它不太可能被任何东西阻止。请务必选择一个您以后不会感到受限制的 URL，或者更好的是，让应用程序定期检查更新，因此如果您决定更改域或其他内容，您可以提前推送更新。

安全并不是真正的问题。您可以相当容易地丢弃垃圾数据，因此您真正关心的是是否有人会不厌其烦地构建虚假的回溯来干扰您，这是一种非常不可能的情况。

至于有效载荷，[PyCrash](http://pycrash.sourceforge.net/)可以帮助您。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T18:11:53.150

网络热门是要走的路，但请确保您选择了一个好的 URL - 您的应用程序将在未来几年内点击它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T18:12:08.920

[PyCrash](http://pycrash.sourceforge.net/)？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T18:13:09.807

无论您使用 SMTP 还是 HTTP 发送数据，您都需要在应用程序中设置用户名/密码，以防止任何人向您发送随机数据。

考虑到这一点，我怀疑使用 SMTP 而不是 HTTP 来发送数据会更容易。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T18:17:52.870

某种简单的网络服务就足够了。您必须考虑安全性，因此不仅仅是任何人都可以向您的服务提出请求..

在更大的范围内，我们考虑了 JMS 消息传递系统。将包含回溯/错误消息的数据序列化对象放入队列中，每 x 分钟使用一次，从该数据生成报告/警报。

# javascript - 如何枚举 JavaScript 对象的属性？

> ID：85992
> 
> 赞同：708
> 
> 时间：2008-09-17T18:10:18.380
> 
> 标签：javascript, properties

如何枚举 JavaScript 对象的属性？

我实际上想列出所有定义的变量及其值，但我了解到定义变量实际上会创建窗口对象的属性。

* * *

## 回答 #1

> 赞同：877
> 
> 时间：2008-09-17T18:12:21.650

很简单：

```
for(var propertyName in myObject) {
   // propertyName is what you want
   // you can get the value like this: myObject[propertyName]
} 
```

现在，您不会以这种方式获取私有变量，因为它们不可用。

* * *

编辑：[@bitwiseplatypus](https://stackoverflow.com/questions/85992/how-do-i-enumerate-the-properties-of-a-javascript-object#86306)是正确的，除非您使用该`hasOwnProperty()`方法，否则您将获得继承的属性 - 但是，我不知道为什么熟悉面向对象编程的人会期望更少！通常，提出这个问题的人已经受到道格拉斯·克罗克福德的警告，这仍然让我有点困惑。同样，继承是 OO 语言的正常部分，因此是 JavaScript 的一部分，尽管它是原型的。

现在，也就是说，`hasOwnProperty()` *对于*过滤很有用，但我们不需要发出警告，好像在获取继承属性时存在危险。

编辑 2：[@bitwiseplatypus](https://stackoverflow.com/questions/85992/how-do-i-enumerate-the-properties-of-a-javascript-object#86306)提出了如果有人在您最初​​编写对象（通过其原型）之后的某个时间点向您的对象添加属性/方法时会发生的情况 - 虽然这确实可能导致意外行为，我个人并不完全认为这是我的问题。只是见仁见智。此外，如果我以这样一种方式设计事物，即在我的对象的构造过程中使用原型，但有代码迭代对象的属性并且我想要所有继承的属性，该怎么办？我不会使用`hasOwnProperty()`. 然后，假设有人稍后添加了新属性。如果事情在那个时候表现不好，那是我的错吗？我不这么认为。我认为这就是为什么 jQuery，例如，指定了扩展其工作方式的方法（通过`jQuery.extend`和`jQuery.fn.extend`）。

* * *

## 回答 #2

> 赞同：232
> 
> 时间：2008-09-17T18:47:55.043

使用`for..in`循环枚举对象的属性，但要小心。枚举不仅会返回被枚举对象的属性，还会从任何父对象的原型返回属性。

```
var myObject = {foo: 'bar'};

for (var name in myObject) {
  alert(name);
}

// results in a single alert of 'foo'

Object.prototype.baz = 'quux';

for (var name in myObject) {
  alert(name);
}

// results in two alerts, one for 'foo' and one for 'baz' 
```

为避免在枚举中包含继承属性，请检查`hasOwnProperty()`：

```
for (var name in myObject) {
  if (myObject.hasOwnProperty(name)) {
    alert(name);
  }
} 
```

**编辑：**我不同意 JasonBunting 的说法，即我们不需要担心枚举继承的属性。枚举你不期望的继承属性是有危险的，因为它可以改变你的代码的*行为*。

这个问题在其他语言中是否存在并不重要；事实上它是存在的，而且 JavaScript 特别容易受到攻击，因为对对象原型的修改会影响子对象，即使修改发生在实例化之后。

这就是 JavaScript 提供 的原因`hasOwnProperty()`，也是您应该使用它以确保第三方代码（或任何其他可能修改原型的代码）不会破坏您的代码的原因。除了添加一些额外的代码字节外，使用`hasOwnProperty()`.

* * *

## 回答 #3

> 赞同：51
> 
> 时间：2010-01-19T18:47:07.867

已经多次提出的标准方法是：

```
for (var name in myObject) {
  alert(name);
} 
```

但是 Internet Explorer 6、7 和 8 在 JavaScript 解释器中有一个错误，这会导致某些键没有被枚举。如果您运行此代码：

```
var obj = { toString: 12};
for (var name in obj) {
  alert(name);
} 
```

如果将在除 IE 之外的所有浏览器中显示“12”。IE 将简单地忽略此键。受影响的键值是：

*   `isPrototypeOf`
*   `hasOwnProperty`
*   `toLocaleString`
*   `toString`
*   `valueOf`

为了在 IE 中真正安全，您必须使用以下内容：

```
for (var key in myObject) {
  alert(key);
}

var shadowedKeys = [
  "isPrototypeOf",
  "hasOwnProperty",
  "toLocaleString",
  "toString",
  "valueOf"
];
for (var i=0, a=shadowedKeys, l=a.length; i<l; i++) {
  if map.hasOwnProperty(a[i])) {
    alert(a[i]);
  }
} 
```

好消息是 EcmaScript 5 定义了该`Object.keys(myObject)`函数，它将对象的键作为数组返回，并且一些浏览器（例如 Safari 4）已经实现了它。

* * *

## 回答 #4

> 赞同：50
> 
> 时间：2013-11-07T11:54:39.270

在现代浏览器（ECMAScript 5）中，要获取所有可枚举的属性，您可以执行以下操作：

[Object.keys(obj)](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/keys) （检查链接以获取在旧浏览器上向后兼容的片段）

或者要获得不可枚举的属性：

[Object.getOwnPropertyNames(obj)](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/getOwnPropertyNames)

[检查 ECMAScript 5 兼容性表](http://kangax.github.io/es5-compat-table/)

附加信息： [什么是可枚举属性？](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperty#Enumerable_attribute)

* * *

## 回答 #5

> 赞同：26
> 
> 时间：2009-04-08T21:13:48.617

我认为一个让我感到意外的案例是相关的：

```
var myObject = { name: "Cody", status: "Surprised" };
for (var propertyName in myObject) {
  document.writeln( propertyName + " : " + myObject[propertyName] );
} 
```

但令我惊讶的是，输出是

```
name : Cody
status : Surprised
forEach : function (obj, callback) {
    for (prop in obj) {
        if (obj.hasOwnProperty(prop) && typeof obj[prop] !== "function") {
            callback(prop);
        }
    }
} 
```

为什么？页面上的另一个脚本扩展了 Object 原型：

```
Object.prototype.forEach = function (obj, callback) {
  for ( prop in obj ) {
    if ( obj.hasOwnProperty( prop ) && typeof obj[prop] !== "function" ) {
      callback( prop );
    }
  }
}; 
```

* * *

## 回答 #6

> 赞同：17
> 
> 时间：2008-09-17T22:51:50.637

```
for (prop in obj) {
    alert(prop + ' = ' + obj[prop]);
} 
```

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2012-07-04T13:41:13.343

简单的 JavaScript 代码：

```
for(var propertyName in myObject) {
   // propertyName is what you want.
   // You can get the value like this: myObject[propertyName]
} 
```

jQuery：

```
jQuery.each(obj, function(key, value) {
   // key is what you want.
   // The value is in: value
}); 
```

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2013-07-11T10:28:53.673

以下是枚举对象属性的方法：

```
var params = { name: 'myname', age: 'myage' }

for (var key in params) {
  alert(key + "=" + params[key]);
} 
```

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2008-09-17T18:13:01.447

我发现它...`for (property in object) { // do stuff }`将列出所有属性，因此窗口对象上的所有全局声明变量..

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2013-04-20T13:14:27.057

如果您使用的是[Underscore.js](https://en.wikipedia.org/wiki/Underscore.js)库，则可以使用功能[键](http://underscorejs.org/#keys "钥匙")：

```
_.keys({one : 1, two : 2, three : 3});
=> ["one", "two", "three"] 
```

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2016-04-07T08:59:29.293

您可以使用`for`of 循环。

如果你想要一个数组使用：

`Object.keys(object1)`

参考。[对象.keys()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/keys)

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2013-11-13T14:52:36.483

Python 的 dict 有 'keys' 方法，这真的很有用。我认为在 JavaScript 中我们可以有这样的东西：

```
function keys(){
    var k = [];
    for(var p in this) {
        if(this.hasOwnProperty(p))
            k.push(p);
    }
    return k;
}
Object.defineProperty(Object.prototype, "keys", { value : keys, enumerable:false }); 
```

编辑：但@carlos-ruana 的答案非常有效。我测试了 Object.keys(window)，结果符合我的预期。

5 年后编辑： 扩展 不是一个好主意`Object`，因为它可能与可能想要`keys`在其对象上使用的其他库发生冲突，并且会导致您的项目出现不可预测的行为。@carlos-ruana 答案是获取对象键的正确方法。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-09-17T19:45:42.457

如果您尝试枚举属性以针对对象编写新代码，我建议您使用像 Firebug 这样的调试器来直观地查看它们。

另一种方便的技术是使用 Prototype 的 Object.toJSON() 将对象序列化为 JSON，这将显示属性名称和值。

```
var data = {name: 'Violet', occupation: 'character', age: 25, pets: ['frog', 'rabbit']};
Object.toJSON(data);
//-> '{"name": "Violet", "occupation": "character", "age": 25, "pets": ["frog","rabbit"]}' 
```

[http://www.prototypejs.org/api/object/tojson](http://www.prototypejs.org/api/object/tojson)

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2016-04-28T18:22:05.640

我仍然是 JavaScript 的初学者，但我编写了一个小函数来递归打印对象及其子对象的所有属性：

```
getDescription(object, tabs) {
  var str = "{\n";
  for (var x in object) {
      str += Array(tabs + 2).join("\t") + x + ": ";
      if (typeof object[x] === 'object' && object[x]) {
        str += this.getDescription(object[x], tabs + 1);
      } else {
        str += object[x];
      }
      str += "\n";
  }
  str += Array(tabs + 1).join("\t") + "}";
  return str;
} 
```

# graphics - 我需要一种算法来渲染软画笔笔触

> ID：85993
> 
> 赞同：2
> 
> 时间：2008-09-17T18:10:22.090
> 
> 标签：graphics, vector-graphics

我有一组鼠标点、一个笔画宽度和一个柔软度。我可以画出柔和的圆圈和柔和的线条。我应该使用哪种算法来绘制我的点数组？我希望交叉线看起来像端点一样漂亮。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-17T19:25:04.550

我肯定会为此目的选择贝塞尔曲线，特别是我将实现分段三次贝塞尔曲线——它确实很容易实现和掌握，并且被 3D Studio max 和 Photoshop 广泛使用。

这是一个很好的来源： [http ://local.wasp.uwa.edu.au/~pbourke/surfaces_curves/bezier/cubicbezier.html](http://local.wasp.uwa.edu.au/~pbourke/surfaces_curves/bezier/cubicbezier.html)

假设您在点之间有一个顺序，为了设置四个控制点，您应该执行以下操作：

我定义点 P[i] 和点 P[i+1] 之间的切线

*   T1 = (P[i+1] - P[i-1])
*   T2 = (P[i+2] - P[i])

为了在两点之间创建分段，我执行以下操作：

*   控制点 Q1：P[i]
*   控制点 Q2：沿 Q1 切线的点 => Q1 + 0.3T1
*   控制点 Q3：沿 Q4 切线的点 => Q4 - 0.3T2
*   控制点 Q4：P[i+1]

我选择 0.3T 的原因是随意的，以便给它足够的“强度”但又不过分，您可以使用更精细的方法来处理加速（C2 连续性）。

享受

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-13T03:47:49.440

从 Gooch & Gooch 的[Non-Photorealistic Rendering](http://www.cs.utah.edu/npr/)开始，您可能会发现 Pham 的工作很有用 - 请参阅[PDF](http://nis-lab.is.s.u-tokyo.ac.jp/nis/cdrom/brush.pdf)解释算法。

Tateosian有一篇很好的[概述文章](http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.6.686)，它用漂亮的图片详细解释了其他技术。单独绘制贝塞尔曲线不会产生您想要的效果（取决于您想要获得的效果）。但是，我肯定会从 Paul 的作品开始，看看用你的软笔画是否足够好。

请注意，这个领域有很多[专利](http://www.patentstorm.us/patents/5844565.html)，叹息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T19:09:58.063

我想也许你正在寻找样条算法。

这是一个样条教程，您可能会发现它有帮助：

[ [http://www.doc.ic.ac.uk/~dfg/AndysSplineTutorial/index.html]](http://www.doc.ic.ac.uk/~dfg/AndysSplineTutorial/index.html])

大多数有关图形编程的书籍也涵盖了该主题。

干杯。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-23T19:57:44.863

我想通了 - 使用一个非常柔和的渐变圆，反复绘制以制作笔触，使用乘法混合。

# project-management - 您如何使个人 wiki (TiddlyWiki) 保持最新并在多个位置保持同步？

> ID：85994
> 
> 赞同：20
> 
> 时间：2008-09-17T18:10:23.980
> 
> 标签：project-management, development-environment, wiki, tiddlywiki

如果要将 TiddlyWiki 用作笔记和代码片段的个人数据库，您将如何使其在多台机器之间保持同步。svn/cvs 等会起作用吗？你将如何处理合并？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-09-17T18:14:26.917

一种选择是后起之秀[DropBox](http://getdropbox.com)。一项免费的文件共享服务，可为您提供 2GB 的免费空间，并且对您共享的计算机数量没有限制。

定义一个共享文件夹，将您的 tiddlywiki 文件放在那里，然后将本地编辑指向共享驱动器。任何更改都会自动反映。

注意：我与 DropBox 没有任何联系，除了我已经阅读了很多关于它的内容，并且正在试用它以供我个人使用。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-09-17T18:13:15.300

使用[TiddlySpot](http://www.tiddlyspot.com)，它始终在线且私密

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2010-03-20T13:38:37.860

Tiddlywiki 非常适合版本控制（因为它是单个文本文件）。

只需将其放在可从 Web 访问的个人 SVN 或 Git 存储库中，您就可以使其与许多地方（办公室、家庭、笔记本电脑等）保持同步。

我用这个方法，效果很好。您甚至可以拥有多个版本的笔记并使用差异工具解决冲突。显然，通过修订控制，您可以“离线”工作并稍后同步。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-09-17T18:15:36.650

我刚刚在 TiddlySpot 创建了一个新的[Tiddlywiki](http://tiddlyspot.com/)。它允许您保留 Tiddlywiki 的本地副本并将其与服务器同步。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-17T18:14:22.720

这些选项都很好，但我只想把它放在 USB 密钥上。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-17T18:52:45.127

如果您有自己的 Web 服务器（并且不想使用 TiddlySpot），请尝试使用[此代码](http://tiddlywiki.bidix.info/#HowToUpload)来启用保存到您自己的服务器。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-02T15:08:49.110

我在[http://TiddlySpot.com上有一个](http://TiddlySpot.com)[MonkeyGTD](http://monkeygtd.tiddlyspot.com/ "猴子GTD") wiki 。我在我的工作 PC 上有它的本地副本，白天在上面做我的工作，并在白天和一天结束时定期上传到 TiddlSpot。如果我需要在下班后访问或更新它，我将对在线版本进行更改，然后第二天早上我会重新**导入**到我的本地文件中。

 **确实，如果我忘记进行更新或以错误的顺序进行更新，我会丢失信息，但这已经“足够好”了。

可能有一种方法可以使用**同步**功能来防止这种情况，但我还没有研究过这个选项。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2010-12-31T11:04:19.470

如果您可能想同时在多台计算机上编辑您的 wiki，您肯定需要一个基于服务器的解决方案，该解决方案的同步级别比文件更精细。Giewiki (http://giewiki.appspot.com) 是基于 Google 的 App Engine 的基于服务器的 TiddlyWiki 解决方案，它就是这样做的。与我所知道的任何其他托管的 TiddlyWiki 不同，您可以在任何层次结构中创建多个页面并通过自动生成的站点地图导航它们。您可以通过在 giewiki.appspot.com 创建一个子域站点来试用它，或者您可以下载源代码并将其安装到您自己的免费 apppot 站点中。您可以根据自己的喜好将其设为个人或公开。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-17T18:13:17.513

尝试[FolderShare](https://foldershare.com/)。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-18T17:38:17.073

我将 TiddlyWiki 文件存储在随身携带的 USB 闪存驱动器上，无论我使用什么计算机。无需费心在其他计算机之间进行同步。当我在我的主工作站上备份闪存驱动器本身时，它会定期备份。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-17T22:59:58.320

还有一个选择：使用另一个名为 Luminotes 的[个人 wiki](http://luminotes.com)，您可以从不同的计算机在线访问它，也可以下载并在您自己的计算机上运行（是的，甚至是 USB 驱动器）。Luminotes 肯定与 TiddlyWiki 有一些相似之处，但在许多方面它更易于学习和使用。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-12-29T14:50:13.090

您提到了 SVN，但如果您不介意使用 git，Github 的[Gollum](https://github.com/github/gollum)是一个很好的解决方案。在本地或从 github 远程仓库编辑。

* * *

## 回答 #13

> 赞同：-8
> 
> 时间：2009-01-02T15:12:42.097

为什么不在网络服务器上设置 DokuWiki 之类的东西呢？你有自己的网络服务器，对吧？这些天，您可以获得 19 美元/月的虚拟托管解决方案。

# vb.net - VB中不存在的文件夹如何创建？

> ID：85996
> 
> 赞同：61
> 
> 时间：2008-09-17T18:10:25.570
> 
> 标签：vb.net, installation, directory

我为自己编写了一个小的下载应用程序，这样我就可以轻松地从我的服务器中获取一组文件，并将它们全部放到一个全新安装了 Windows 的新电脑上，而无需真正上网。不幸的是，我在创建要放入它们的文件夹时遇到问题，并且不确定如何去做。

我希望我的程序将应用程序下载到`program files\any name here\`

所以基本上我需要一个函数来检查文件夹是否存在，如果不存在则创建它。

* * *

## 回答 #1

> 赞同：179
> 
> 时间：2008-09-17T18:12:41.243

```
If Not System.IO.Directory.Exists(YourPath) Then
    System.IO.Directory.CreateDirectory(YourPath)
End If 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2008-09-17T18:13:23.347

在 System.IO 下，有一个名为 Directory 的类。请执行下列操作：

```
If Not Directory.Exists(path) Then
    Directory.CreateDirectory(path)
End If 
```

它将确保目录在那里。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-09-17T18:12:59.963

试试[System.IO.DirectoryInfo](http://msdn.microsoft.com/en-us/library/system.io.directoryinfo.aspx)类。

来自 MSDN 的示例：

```
Imports System
Imports System.IO

Public Class Test
    Public Shared Sub Main()
        ' Specify the directories you want to manipulate.
        Dim di As DirectoryInfo = New DirectoryInfo("c:\MyDir")
        Try
            ' Determine whether the directory exists.
            If di.Exists Then
                ' Indicate that it already exists.
                Console.WriteLine("That path exists already.")
                Return
            End If

            ' Try to create the directory.
            di.Create()
            Console.WriteLine("The directory was created successfully.")

            ' Delete the directory.
            di.Delete()
            Console.WriteLine("The directory was deleted successfully.")

        Catch e As Exception
            Console.WriteLine("The process failed: {0}", e.ToString())
        End Try
    End Sub
End Class 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2008-09-17T18:36:31.687

由于问题没有指定 .NET，这应该适用于 VBScript 或 VB6。

```
Dim objFSO, strFolder
strFolder = "C:\Temp"
Set objFSO = CreateObject("Scripting.FileSystemObject")
If Not objFSO.FolderExists(strFolder) Then
   objFSO.CreateFolder(strFolder)
End If 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-09-17T18:11:57.877

试试这个：`Directory.Exists(TheFolderName)`和`Directory.CreateDirectory(TheFolderName)`

（您可能需要`Imports System.IO`：）

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-09-17T18:12:35.830

VB.NET？System.IO.Directory.Exists（字符串路径）

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-09-17T18:15:26.680

Directory.CreateDirectory() 应该这样做。 [http://msdn.microsoft.com/en-us/library/system.io.directory.createdirectory(VS.71).aspx](http://msdn.microsoft.com/en-us/library/system.io.directory.createdirectory(VS.71).aspx)

此外，在 Vista 中，您可能无法直接写入 C:，除非您以管理员身份运行它，因此您可能只想绕过它并在 C: 的子目录中创建所需的目录：（我想说的是无论如何都要遵循一个好的做法。 - 令人难以置信的是有多少人只是将垃圾扔到C上：

希望有帮助。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-09-17T18:16:13.840

（导入 System.IO）

```
如果不是 Directory.Exists(Path) 则
  Directory.CreateDirectory（路径）
万一
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-08-07T17:02:26.090

```
If Not Directory.Exists(somePath) then
    Directory.CreateDirectory(somePath)
End If 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-17T18:13:58.730

您应该尝试使用文件系统对象或 FSO。该对象有许多方法可以检查文件夹是否存在以及创建新文件夹。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-24T02:12:56.490

我知道这将如何工作，创建一个对话框的过程是什么，该对话框允许用户命名文件夹并将其放置在您想要的位置。

干杯

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-10-16T17:30:38.683

只需这样做：

```
 Dim sPath As String = "Folder path here"
    If (My.Computer.FileSystem.DirectoryExists(sPath) = False) Then
        My.Computer.FileSystem.CreateDirectory(sPath + "/<Folder name>")
    Else
        'Something else happens, because the folder exists
    End If 
```

我将文件夹路径声明为字符串（sPath），这样如果您多次使用它，它可以轻松更改，但也可以通过程序本身进行更改。

希望能帮助到你！

-nfell2009**********