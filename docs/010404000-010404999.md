# StackOverflow 问答 10404000-10404999

# java - 找不到主类：程序将退出

> ID：10404001
> 
> 赞同：2
> 
> 时间：2012-05-01T20:37:43.517
> 
> 标签：java, compiler-errors

当尝试在 Eclipse SDK 中编译和运行我的程序时，会弹出此错误。我以前从未遇到过此错误消息，其他帖子也不是很有帮助。什么可能导致这种情况？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-20T21:17:18.377

如果您有一个 main() 方法并且仍然收到此方法，并且如果您还收到 noclassdeffound 错误，则该错误也可能作为线程错误的一部分出现。如果这是您之前成功使用的现有程序的新问题，则可能是因为发生了编译错误。删除编译好的jar文件，重新编译。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-02-27T14:38:50.113

我是 Java 新手。在我对项目进行了一些更改以使用不同的 jdk 后，同样的事情发生在我身上。我已将项目更改为引用 jdk 1.6 而不是 1.7。然后我开始收到这个错误。当我转到项目属性-> Java 编译器时，我注意到它在所有下拉列表中都有 1.7。我将工作区设置更改为使用 1.6，一切都开始工作了。正是 Igor 的帖子让我做出了这个决定。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-02T13:08:18.820

该错误没有说明“主要”方法。它说它找不到主要课程...

所以，我用谷歌搜索了一下，有很多原因：从错误版本的 ANT（基于 ant 的项目）开始，包括用 JRE7 编译并用 JRE6 运行的 java 类......

您能否向我们提供更多有关您的环境的信息？Eclipse SDK 是什么意思？它是 Eclipse IDE 吗？您正在创建什么样的项目？源代码？

谷歌一下，有很多点击，一个可能会帮助你。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-12-18T10:38:35.380

在项目资源管理器中右键单击您的项目名称，选择*属性*，选择*Java 编译器，在**编译器合规级别*选择您安装在系统上的 JRE 版本（如 1.6），然后单击确定并运行程序！完毕！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-01T20:53:27.167

当你运行一个java程序时，它必须知道从哪里开始。在 java 中，约定是 main 方法，具有以下签名：

```
public static void main(string[] arguments) 
```

当你运行 java 程序时，它会寻找一个 main 方法来运行。然后，该 main 方法可以调用您的任何其他代码，但它需要一个起点。

如果你的程序有一个不同方法的列表，它怎么知道你想运行哪一个？您是否希望它只运行一次找到的所有方法？那会很糟糕。

所以你需要类似的东西

```
public static void main(string[] arguments){
    System.out.println("here");
    //Call your methods
    //myFunction();
    //doThing();
    return;
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-05-01T20:42:14.237

您正在尝试运行一个没有 main 方法的 java 类。添加一个主要方法并让它调用您的“启动器”方法。

```
public static void main(String[] args){
    MyClass mc = new MyClass();
    mc.myStarterMethod();
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-10-06T22:01:49.940

我突然遇到了这个问题，当我尝试运行可以完美运行的类并且是的它们有 main() 方法时，我突然得到了上述错误。我尝试清理和重建项目，但无济于事，相当令人沮丧。

我查看了“问题”选项卡，说我缺少一些库 jar 文件，我查看了我的工作区，我的 .java 文件在那里，但在 /bin 下的同一个地方没有 .class 文件，这就是它找不到课程的原因。

我所做的是移动了包含库 jar 文件的目录，因此将这些库文件移回，重新启动 eclipse 将其整理出来。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-12-31T07:26:38.133

如果您使用的是 package 语句，则可以得到此信息，但您的源代码不在 package 语句中引用的路径中。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-11-04T11:36:07.643

断电后我遇到了同样的问题，Eclipse 没有编译和启动我的项目。做了一个项目清理项目 - >清理它解决了我的问题。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-03-07T18:24:06.133

我对 Eclipse IDE 也有类似的问题。

1.  去运行菜单
2.  去运行配置
3.  查看标题栏上的错误（屏幕顶部）
4.  这些错误是由于兼容性 jre 1.6 或 jre 1.7 引起的
5.  相应地选择执行路径
6.  运行你的程序

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-02-19T04:24:16.347

我过去也遇到过同样的问题。问题是类路径不包括当前目录。只需将程序所在的文件夹添加到 CLASSPATH 环境变量中。如果这不起作用，请告诉我。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-03-02T17:38:00.150

此错误显示为 jdk 编译器版本。请使用正确的编译器（如 jre1.6 或 1.7）。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-01-16T22:09:45.677

路径中的 Eclipse 也有类似的问题。

我发现调试此问题的最佳方法是转到“运行配置”对话框，然后单击“通用”子选项卡并将启动配置作为“共享文件”保存到项目目录中。

然后你可以查看启动文件，看看有没有什么明显的。

例如，Eclipse 没有启动我的主类的最新原因是我一直在尝试使用 maven m2eclipse 插件，并且已经破坏了启动配置，因此添加了 m2eclipse 类路径声明。

这告诉我我需要从项目中删除 maven 项目类型，然后从启动文件中清除 maven/m2eclipse 残差（自动），然后我的课程可以正常运行。只是此错误可能出现的许多有趣方式之一。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2017-04-13T06:55:01.340

清理并重建项目解决了我的问题。

# html - Firefox 不会使用 HTML5 播放 .WAV 文件 标签？

> ID：10404005
> 
> 赞同：8
> 
> 时间：2012-05-01T20:38:24.293
> 
> 标签：html, firefox, audio, html5-audio

我正在构建一个允许用户上传 MP3 文件的页面。该 MP3 文件在后端使用 LAME 转换为 .WAV 文件。

蹩脚的执行脚本在这里：

```
LAME --resample 44.1 -decode myDirectoryPath/Master.mp3 myDirectoryPath/Master.wav 
```

但是，当我在 Firefox 中使用 HTML5 音频标签为该音频文件创建播放器时，它不起作用。

```
<!DOCTYPE HTML>
<html>

<head>
    <meta charset="UTF-8">
    <title>Test</title>
</head>

<body>
    <audio controls>
        <source src="myDirectoryPath/Master.mp3">
        <source src="myDirectoryPath/Master.wav">
    </audio>
</body>
</html> 
```

我读过的所有内容都说 Firefox 支持 .wav 文件......我找不到一个简单的 .mp3 到 .ogg 命令行工具可以将 master.mp3 转换为 .ogg 格式。有人可以就下一步尝试什么提供一些建议吗？

我在这里发布了适用于 Safari 和 Chrome 的代码： [http ://www.wgbh.org/byers/Audio/index.html](http://www.wgbh.org/byers/Audio/index.html)

无论出于何种原因，FF 都不喜欢它。

**更新** （附带 facepalm）问题在于我的 LAME 解码。正确的语法是 --decode 用两个破折号而不是一个破折号。系统实际上将其从 mp3 编码为 mp3，将其命名为 wav，Mac 上的 Safari / Chrome 假定文件类型。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-05-02T00:38:33.330

您的 WAV 文件的位深度是多少？Firefox 支持 8 位和 16 位 PCM，但不支持其他位深度（12、20、24、32）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-01T21:20:32.667

Firefox 期望以下[编解码器之一作为 MIME 类型返回](https://developer.mozilla.org/En/Media_formats_supported_by_the_audio_and_video_elements)：

*   音频/波形（首选）
*   音频/wav
*   音频/x-wav
*   音频/x-pn-wav

确保您的服务器为 wav 文件返回其中一种 MIME 类型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-08T23:53:14.547

除了位深度问题之外，Firefox HTML5 音频显然也不播放 6 通道音频。对于我的应用程序，我需要重新翻录以更改位深度和通道数（例如 sox *inFile* **-b 16 -c 2** *outFile* *otherParams*）。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2015-02-23T19:41:17.647

这是 Firefox 中的错误 - 您需要将 MP3 格式源列出到最后，它会起作用。

# html - 在链接标签后面设置背景图片

> ID：10404007
> 
> 赞同：0
> 
> 时间：2012-05-01T20:38:31.833
> 
> 标签：html, css, image

我目前有： ![在此处输入图像描述](../Images/a0107eeb70225cd0f8a55fb46b17015f.png)

我正在寻找带有图像链接的 div 的背景。此外，我只希望不透明度仅应用于图像，而不是链接。这就是我所拥有的：

```
#homelinks
{
    border: 1px solid black;
    height: 80px;
    width: auto;
    font-size: 20pt;
    padding-left: 5px;
    padding-right: 5px;
    text-align: center;
    overflow: auto;
    padding-top: 75px;
}

#homeimage
{
    opacity: 0.3;
    background-image:url("http://www.imagegoeshere.jpg");
    background-repeat:no-repeat;
    background-attachment: fixed;
    background-position: 100% 100%;            
} 
```

HTML：

```
<h1>
    My Surfing Shop
</h1>
<div id="homeimage">
    <div id="homelinks">
        <a href="http://www.111.html">Home</a> 
        <a href="http://www.222.html">Products</a>
        <a href="http://www.333.html">Surf Reports</a> 
        <a href="http://www.444.html">Surf lessons</a>
        <a href="http://www.555.html">Message Board</a> 
        <a href="http://www.666.html">Directions</a>
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T20:42:41.533

修复 homeimage div 的 CSS。您在 CSS 中将其作为类 (.) 而不是 ID (#)。此外，您的图片链接无效（我猜是出于某种原因故意）。并检查可能需要为 0 0 的背景位置。我还将删除固定的背景附件规则。

```
#homeimage
{
    opacity: 0.3;
    background-image:url("http://www.imagegoeshere.jpg");
    background-repeat:no-repeat;
    background-position: 100% 100%;           
}​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T20:42:51.610

这是因为您的 CSS 引用类 homeimage 而**不是**ID（这就是它在您的标记中的内容）。

```
#homeimage
{
    opacity: 0.3;
    background-image:url("http://www.imagegoeshere.jpg");
    background-repeat:no-repeat;
    background-attachment: fixed;
    background-position: 100% 100%;            
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T20:43:37.833

在CSS中使用#homeimage，句号是指homeimage的一个类。

# javascript - 使用 Crafty.js 游戏引擎的水平碰撞检测

> ID：10404008
> 
> 赞同：1
> 
> 时间：2012-05-01T20:38:32.553
> 
> 标签：javascript, collision-detection, craftyjs

我正在尝试构建一种具有连续垂直玩家移动和仅水平输入的突破式游戏。我需要检测砖块是否击中侧面或顶部/底部。在没有检测到这一点的情况下，我无法阻止玩家的移动与未被破坏的砖块重叠。我尝试使用它来检测玩家实体击中的多边形的哪个边缘（在检测到碰撞时调用第一个函数，当`justHit`设置为 false 时调用第二个函数）：

```
.onHit("brick", function() { 
    if (data[0]['normal']['y']==0) { 
        reverseDirection(); 
    } 
    else { 
        this._hspeed = 0; 
    } 
}, function() { 
    this._hspeed = 3; 
}) 
```

但是我遇到了两个问题：当玩家实体到达砖块的角落时，'y' datahit 值会发生变化，并且由于某种原因，如果有 2 个砖块并排，砖块组件几乎会被忽略。

*   [我在jsFiddle](http://jsfiddle.net/XurrR/)上发布了一些精简的代码
*   [您可以在此处查看](http://marcripley.com/diamonds/)带有命中数据条件的当前检测示例
*   [以及在砖块边缘碰撞时没有运动限制](http://marcripley.com/diamonds/coll_bug.html)的原始碰撞错误示例

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-22T19:58:02.830

您可以在实体上绘制多个碰撞框，然后根据触发碰撞的框执行您的特定操作。

# java - 在 TreeSet 中搜索特定元素

> ID：10404015
> 
> 赞同：2
> 
> 时间：2012-05-01T20:39:15.050
> 
> 标签：java

我正在尝试在 TreeSet 中搜索具有特定 regNumber 的成员。然而， regNumber 与 TreeSet 中元素的顺序没有任何关系，这些元素按姓/名排序。

我现在尝试这样做的方式是遍历 TreeSet 中的所有元素并返回与我正在寻找的 regNumber 匹配的元素。这是好的做法还是效率太低？

```
public class Members implements Comperable <Members> {

private String firstName;
private String lastName;
private int regNumber;

} 
```

PS TreeSet 中的元素必须保持按姓/名排序

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-01T20:48:02.917

您按名称索引然后按搜索的事实`regNumber`意味着从您的角度来看，`regNumber`您有一个无序的项目集合。因此，您不能比对所有项目进行线性搜索更好。

如果您想要更好的东西，您可以将`regNumber`用作哈希表（`HashMap`或其他）中的键，并将原始`Member`对象的引用作为值。这样，您可以以使用更多空间为代价更有效地搜索。

# oracle - SQL Developer：上传日期格式

> ID：10404016
> 
> 赞同：0
> 
> 时间：2012-05-01T20:39:17.533
> 
> 标签：oracle, plsql

我正在使用 Oracle SQL Developer 3.0.03。我正在尝试将 Excel 文件上传到 Oracle 数据表。我收到日期错误。数据库中的列是时间戳，我不知道将什么放入“数据加载向导”的日期格式中。如果我使用以下格式，我会得到“第 1 行 GDK-05016 插入失败：发现重复月份。

dd-mom-yy hh.mm.ss

知道正确的格式应该是什么吗？

在数据库中，日期列如下所示：01-MAY-12 01.16.50.000000000PM

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T20:59:39.937

分钟的代码`mi`不是`mm`

（我认为`mom`这只是一个错字，实际上是在阅读`mon`）

有关所有支持的格式模型的完整列表，请参阅手册：
[http ://docs.oracle.com/cd/E11882_01/server.112/e26088/sql_elements004.htm#CDEHIFJA](http://docs.oracle.com/cd/E11882_01/server.112/e26088/sql_elements004.htm#CDEHIFJA)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T17:21:29.947

Excel“零”日期是 1900 年 1 月 0 日（是的，零）。由于 Oracle 无法处理一个月中的“零”日，因此您需要从 Excel 值中减去 1；因此，以下内容应该让您接近您想要的：

```
SELECT CAST(TO_DATE('01-JAN-1900 00:00:00', 'DD-MON-YYYY HH24:MI:SS') AS TIMESTAMP) +
           NUMTODSINTERVAL(41017.6361109954 - 1, 'DAY')
  FROM DUAL 
```

就“如何导入它”而言，我知道没有 Oracle 日期格式可以做到这一点。最简单的方法是将值导入 NUMBER 列，然后运行脚本进行日期转换。

分享和享受。

# java - java.lang.NoClassDefFoundError: org.apache.commons.lang3.ArrayUtils

> ID：10404022
> 
> 赞同：3
> 
> 时间：2012-05-01T20:39:28.357
> 
> 标签：java, android

我有一个运行良好的 Android 应用程序。该应用程序有两个 Java 库。我在另一台计算机上安装了最新版本的 Eclipse 和 Android SDK 包，并从服务器导入了相同的应用程序，但是当我运行它时，程序找不到 java 库。我试图从“构建路径属性”中删除它们并再次添加它们，但它仍然给我这个错误：

```
 java.lang.NoClassDefFoundError: org.apache.commons.lang3.ArrayUtils 
```

你知道如何解决这个问题吗？

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T20:43:49.653

我对其他一些 3rd 方库也有同样的问题，这个解决方案对我有帮助

[http://android.foxykeep.com/dev/how-to-fix-the-classdefnotfounderror-with-adt-17](http://android.foxykeep.com/dev/how-to-fix-the-classdefnotfounderror-with-adt-17)

# c++ - 无法从谷歌协议缓冲区编译示例

> ID：10404027
> 
> 赞同：12
> 
> 时间：2012-05-01T20:40:13.823
> 
> 标签：c++, linux, compiler-errors, g++, protocol-buffers

我 grep 其他主题，但他们没有帮助我 =(。在我的工作服务器上，我没有 sudo 特权，所以我安装 PB

> ./configure --prefix=/home/username/local

然后我使用“person”示例创建源文件并使用 protoc 成功编译它。

我没有 pkg​​-info =(。我尝试用

> g++ -I /home/username/local/include -L /home/username/local/lib -lprotobuf -lpthread main.cpp person.pb.cc

然后有十亿个模拟错误，即

> person.pb.cc:(.text+0x4cf): 未定义对 `google::protobuf::internal::kEmptyString' 的引用

我认为，这是链接的问题，但如何解决呢？

> echo $LD_LIBRARY_PATH /home/username/local/lib

在 main.cpp 中：

```
#include "person.pb.h"
... 
```

谢谢。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-05-01T20:57:27.967

将库放在最后：

> g++ -I /home/username/local/include -L /home/username/local/lib main.cpp person.pb.cc -lprotobuf -pthread

从[GCC 链接选项](http://gcc.gnu.org/onlinedocs/gcc/Link-Options.html)：

```
-图书馆
-l 库
    链接时搜索名为 library 的库。
    （将库作为单独参数的第二种选择
    仅用于 POSIX 合规性，不推荐使用。）

    在命令中编写此选项的位置有所不同；
    链接器在
    它们被指定的顺序。
    因此，`foo.o -lz bar.o' 在文件 foo.o 之后搜索库 `z' 但是
    bar.o 之前 如果 bar.o 引用 `z' 中的函数，那些函数
    可能无法加载。

```

此外，使用`-pthread`而不是`-lpthread`as`-pthread`可以为预处理器和链接器设置标志。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T20:57:37.910

库链接标志位于编译器参数的末尾：

> g++ -I /home/username/local/include -L /home/username/local/lib main.cpp person.pb.cc -lprotobuf -lpthread

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-12-07T15:48:41.987

还有一个非常普遍的问题，不仅适用于链接 protobuf，也适用于其他库。既然这是我的问题，我会把解决方案放在这里，也许有人觉得它有用。

确保您尝试链接到具有相同 ABI 的库。C++ ABI 在 GCC 4.7.0 中发生了变化。因此，您不能将使用 GCC<4.7.0 编译的库（如果您从包存储库中获取包，就像我的情况一样，它可能是 protobuf）与使用 GCC>4.7.0 编译的库链接。

这个问题可以通过植物链接抱怨 std::basic_string 和 std::list 来识别，因为这是 C++ 中最突出的 ABI 更改。我的链接器尖叫看起来像这样：

```
 /bincrafters/stable/package/c0c1ef10e3d0ded44179e28b669d6aed0277ca6a/lib  -L/home/adam/.conan/data/libpcap/1.8.1/bincrafters/stable/package/0a813c597d519ec14c71192b99d7de0a92bbc1c3/lib  -L/home/adam/.conan/data/zmq/4.2.2/bincrafters/stable/package/0144a3b0aceb8edb5e63295c432a8de8020ab1b7/lib  -L/home/adam/.conan/data/libsodium/1.0.16/bincrafters/stable/package/db2ca884c9793e0b0fb54ec3f846326d1addacc8/lib -Wl,-rpath,/hoar, std::char_traits<char>, std::allocator<char> > const&, google::protobuf::io::CodedOutputStream*)'
CMakeFiles/NetworkMonitor.dir/addressbook.pb.cc.o: In function `tutorial::Person_PhoneNumber::InternalSerializeWithCachedSizesToArray(unsigned char*) const':
/home/adam/.conan/data/protobuf/3.9.1/bincrafters/stable/package/053ea29eb0edc6b1695c893b738a971110c756fd/include/google/protobuf/wire_format_lite.h:1673: undefined reference to `google::protobuf::io::CodedOutputStream::WriteStringWithSizeToArray(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, unsigned char*)'
/home/adam/.conan/data/protobuf/3.9.1/bincrafters/stable/package/053ea29eb0edc6b1695c893b738a971110c756fd/include/google/protobuf/wire_format_lite.h:1673: undefined reference to `google::protobuf::io::CodedOutputStream::WriteStringWithSizeToArray(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, unsigned char*)'
CMakeFiles/NetworkMonitor.dir/addressbook.pb.cc.o: In function `google::protobuf::internal::GetEmptyStringAlreadyInited[abi:cxx11]()':
/home/adam/.conan/data/protobuf/3.9.1/bincrafters/stable/package/053ea29eb0edc6b1695c893b738a971110c756fd/include/google/protobuf/message_lite.h:153: undefined reference to `google::protobuf::internal::fixed_address_empty_string[abi:cxx11]'
CMakeFiles/NetworkMonitor.dir/addressbook.pb.cc.o: In function `google::protobuf::internal::WireFormatLite::ReadString(google::protobuf::io::CodedInputStream*, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >*)':
/home/adam/.conan/data/protobuf/3.9.1/bincrafters/stable/package/053ea29eb0edc6b1695c893b738a971110c756fd/include/google/protobuf/wire_format_lite.h:880: undefined reference to `google::protobuf::internal::WireFormatLite::ReadBytes(google::protobuf::io::CodedInputStream*, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >*)'
CMakeFiles/NetworkMonitor.dir/addressbook.pb.cc.o:(.data.rel.ro._ZTVN8tutorial11AddressBookE[_ZTVN8tutorial11AddressBookE]+0x20): undefined reference to `google::protobuf::Message::GetTypeName[abi:cxx11]() const'
CMakeFiles/NetworkMonitor.dir/addressbook.pb.cc.o:(.data.rel.ro._ZTVN8tutorial11AddressBookE[_ZTVN8tutorial11AddressBookE]+0x58): undefined reference to `google::protobuf::Message::InitializationErrorString[abi:cxx11]() const'
CMakeFiles/NetworkMonitor.dir/addressbook.pb.cc.o:(.data.rel.ro._ZTVN8tutorial6PersonE[_ZTVN8tutorial6PersonE]+0x20): undefined reference to `google::protobuf::Message::GetTypeName[abi:cxx11]() const'
CMakeFiles/NetworkMonitor.dir/addressbook.pb.cc.o:(.data.rel.ro._ZTVN8tutorial6PersonE[_ZTVN8tutorial6PersonE]+0x58): undefined reference to `google::protobuf::Message::InitializationErrorString[abi:cxx11]() const'
CMakeFiles/NetworkMonitor.dir/addressbook.pb.cc.o:(.data.rel.ro._ZTVN8tutorial18Person_PhoneNumberE[_ZTVN8tutorial18Person_PhoneNumberE]+0x20): undefined reference to `google::protobuf::Message::GetTypeName[abi:cxx11]() const'
make[2]: *** [bin/N 
```

在我为柯南定义配置文件并链接到使用相同版本的 C++ ABI 编译的库后，问题就消失了。

# php - 在 Symfony2 中将资源动态导入到 Config.yml

> ID：10404030
> 
> 赞同：3
> 
> 时间：2012-05-01T20:40:37.500
> 
> 标签：php, frameworks, dependency-injection, symfony

下面是`config.yml`Symfony2 中的一个非常标准的代码块。我想`parameter.ini`根据外部参数动态加载不同的参数（在我的例子中，我是从服务器环境变量中获取的`SYMFONY__SERVER__VARIABLE`）。我唯一的问题似乎是 Sf2 不会接受参数..

例如，这有效。但下面没有。

```
imports:
    - { resource: parameters.ini }
    - { resource: security.yml }
framework:
    router:          { resource: "%kernel.root_dir%/config/routing.yml" } 
```

下面的例子没有。对我来说，这两个示例似乎会产生相同的结果，因为`routing.yml`它们`parameters.ini`位于同一目录中。

```
imports:
    - { resource: "%kernel.root_dir%/config/parameters.ini" }
    - { resource: security.yml }
framework:
    router:          { resource: "%kernel.root_dir%/config/routing.yml" } 
```

我查看上面示例的原因是因为我知道`%kernel.root_dir%`在`config.yml`. 它告诉我除了我正在做的事情之外的其他事情，所以这段代码不起作用。

最终，这就是我想做的。

```
imports:
        - { resource: "%server.variable%-parameters.ini" } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T23:05:12.603

我认为你正在尝试做我正在做的事情。虽然我没有直接回答您的问题（如何在导入指令中使用参数），但我认为它解决了您的问题（加载特定于服务器的配置）

[Symfony 2 - 多服务器配置](https://stackoverflow.com/questions/10014327/symfony-2-multiple-server-configuration)

# jquery - 如何获得在 JSON 中搜索谷歌图像的结果？

> ID：10404033
> 
> 赞同：3
> 
> 时间：2012-05-01T20:40:56.517
> 
> 标签：jquery, json

我想获取搜索谷歌图像的 JSON。我正在使用 Jquery。[https://developers.google.com/image-search/v1/jsondevguide](https://developers.google.com/image-search/v1/jsondevguide)我正在尝试在本指南的帮助下。这是我到目前为止所做的。

```
$.getJSON("https://ajax.googleapis.com/ajax/services/search/images?callback=?",{q:input,v:'1.0'},function(data){
  $("#r").html("Picture: ");
 $("#r").append('<img src="'+data.responseData.results[0].url+'">');

 }) 
```

但它不执行回调函数。我应该怎么办？什么是必要的参数？

# c++ - 错误：指向算术中使用的函数的指针

> ID：10404036
> 
> 赞同：-4
> 
> 时间：2012-05-01T20:41:43.720
> 
> 标签：c++

我正在尝试编写 Prim 的算法。但是，当我编译时，出现以下错误：57,59,60,62,63,65

显然这与我的数组有关......我只是不知道究竟是什么。我觉得这与我试图弄清楚但失败的指针有关。

int map[][7] 是我用来跟踪我的初始图形的全局数组。

**编辑**-这里要求的是所有代码

```
#include <iostream>

using namespace std;

void performPrims(int);
void print(int *);

// Global Variables
int nodes = 7;
int cur   = 0;
int cost  = 0;

int map[][7] =  
   {{0,3,6,0,0,0,0},
    {3,0,7,0,0,12,0},
    {6,7,0,10,13,8,0},
    {0,0,10,0,0,0,5},
    {0,0,13,0,0,9,4},
    {0,12,8,0,9,0,11},
    {0,0,0,5,4,11,0}};

int main()
{
// Initializations

srand(time(NULL)); 
int S = rand() % 7; // Create an arbitrary starting point

// Perform Prim's Algorithm starting with S

performPrims(S);

return 0;
}

void performPrims(int S)
{
int low = 100;

// open[] is used to keep track of what vertices are available
int open [] = {1,2,3,4,5,6,7};

// closed [] is used to keep track of what vertices have been reached and in what order
int closed [] = {0,0,0,0,0,0,0};

open [S] = 0;       // Make our starting node unavailable
closed [cur] = S+1; // Record our starting node in the path
cur++;

while (cur < 7)
{
    int i=0;
    while (i<nodes)
    {
        int k=0;
        while (k<nodes)
        {
            if (*map[*close[i]-1][k] > 0 && *map[*close[i]-1][k] < low)
            {
                low = map[close[i]-1][k];
                close [cur] = k+1;
            }
            map[close[cur-1]-1][close[cur]-1] = 0;
            map[close[cur]-1][close[cur-1]-1] = 0;
            cost += low; low = 100;
            open[close[cur]-1] = 0;
            k++;
        }
        i++;
    }
    cur++;
}
print(closed);
}

void print(int *closed)
{
cout<<"The path taken was ";
for (int i=0; i<nodes; i++)
    cout<<closed[i]<<" "<<endl;
cout<<"\nThe cost is "<<cost<<endl;
} 
```

**错误**

有几个不同的：

错误：指向算术（多行）中使用的函数的指针错误：数组下标（多行）的无效类型'int [7] [7] [int（*）（int）]'错误：分配只读位置（第 60 行）错误：无法在赋值中将“int”转换为“int ()(int)”（第 60 行）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T20:53:52.867

你拼错了`closed`。你输入`close`了。

`close`用替换所有实例`closed`。

另外，添加`#include <cstdlib>`到文件的顶部。

# javascript - 通过单击 Firefox 中的后退按钮访问时重新加载页面

> ID：10404038
> 
> 赞同：5
> 
> 时间：2012-05-01T20:41:51.500
> 
> 标签：javascript, jquery, html, firefox

我有一个页面，它可以将整个身体从观众的屏幕上作为过渡进行动画处理。它工作正常，但是当用户单击浏览器中的后退按钮时，Firefox 会从没有正文的历史记录中调出缓存页面。

因此，通过后退按钮访问时，我可以很简单地重新加载页面。

我已尝试使用以下代码重新加载页面，以避免重复重新加载。

```
<script type="text/javascript">
  window.onload=function(){
    var e=document.getElementById("refreshed");
    if(e.value=="no")e.value="yes";
    else{e.value="no";location.reload();}
  }
</script>
<input type="hidden" id="refreshed" value="no"> 
```

**它没有解决问题，因为甚至没有调用匿名函数。**

所以我尝试设置标题，以便浏览器不会缓存页面。

```
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="0"> 
```

**它也没有解决问题。**

该页面在 Chrome 中运行良好。

我使用的 Firefox 版本是 12.0

如何使用 Javascript、JQuery 或任何其他客户端脚本重新加载页面？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-02T00:35:43.537

导航回内存缓存页面时不会触发 onload 事件。

我认为您有三个主要选择：

1.  使用 onpageshow 事件（导航到缓存页面时*会触发）。*
2.  通过添加卸载事件侦听器（可以只是一个空函数）来防止页面的内存缓存。
3.  不要做烦人的卸载动画。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T23:28:25.347

我没有尝试过，但 setTimeout 可能会有所帮助。

```
<script>
setTimeout(function() {
var e=document.getElementById("refreshed");
    if(e.value=="no")e.value="yes";
    else{e.value="no";location.reload();}
}, 1000);
</script> 
```

# c# - LEFT JOIN DataTables - 我如何让它工作？

> ID：10404039
> 
> 赞同：0
> 
> 时间：2012-05-01T20:41:55.347
> 
> 标签：c#, linq, join, datatable

> **可能重复：**
> [LEFT OUTER JOIN 2 数据表](https://stackoverflow.com/questions/10403006/left-outer-join-2-datatables)

假设这是我的确切代码：

```
 DataTable table1 = new DataTable();
        DataTable table2 = new DataTable();
        DataTable joinedtable = new DataTable();

        table1.Columns.Add("ID");
        table1.Columns.Add("ColA");
        table1.Rows.Add(1, "A");

        table2.Columns.Add("ID");
        table2.Columns.Add("ColB");
        table2.Rows.Add(1, "B"); 
```

我的查询会是什么，无论是否使用 LINQ，但将表 1 和表 2 连接在一起并将其放入 joinTable 中？当我尝试搜索示例时，我一直在寻找这样开头的示例：

```
 var result = from x in table1
            join y in table2 on x.ID equals y.ID 
```

但是，我在 DataTable1 上收到一个错误，我发现建议改为执行“table1.AsEnumerable()”，但后来我没有 x.ID。.ID 未定义。我只有普通 DataRow 拥有的 x 的东西。我在这里做错了什么？我似乎无法弄清楚这一点。

感谢大家的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T20:45:29.490

不幸的是，`DataTables`它变得有点棘手（如果您出于任何原因不想使用 a `LINQ`），因为您需要定义[DataRelation](http://msdn.microsoft.com/en-us/library/system.data.datarelation.aspx)对象，该对象*实际上*定义了这两者之间的关系定义`DataTables`。

欲了解更多信息，可以看看这个解释：

[如何使用 C# 连接两个数据表](http://social.msdn.microsoft.com/Forums/en-US/adodotnetdataproviders/thread/f122d7f4-3b7d-4d93-bd0f-8bb57cd990a4)

# c - 如何重放多线程应用程序？

> ID：10404042
> 
> 赞同：7
> 
> 时间：2012-05-01T20:42:03.677
> 
> 标签：c, linux, gcc, x86-64, glibc

我想记录同步操作，例如多线程应用程序的锁、信号量、屏障，以便我以后可以重放记录的应用程序，以用于调试。

方法是提供您自己的锁、信号量、条件变量等。这些函数也可以进行日志记录，但我认为这是一种矫枉过正的做法，因为它们必须使用一些常见的同步操作。

所以我的问题是我应该记录哪些同步操作，以便我需要对我的程序进行最少的修改。换句话说，glibc 和系统调用中的哪些函数或宏是构建所有这些同步操作的基础？所以我只修改那些用于记录和重播。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T20:49:40.917

在您的情况下，在 Linux 上“记录”系统调用的一种有效方法可能是使用[LD_PRELOAD](https://stackoverflow.com/questions/426230/what-is-the-ld-preload-trick)技巧，并用您自己的调用版本覆盖实际的系统调用，这些调用将记录调用的使用，然后转发到实际的系统调用。

[Linux Journal](http://www.linuxjournal.com/article/7795)中给出了更广泛的示例。

正如您在这些链接中看到的那样，“技巧”的基本要点是您可以让系统在任何其他系统库（例如 pthread 等）之前加载您自己的动态库，然后屏蔽对这些库函数的调用通过将您自己的这些功能版本作为先例。然后，您可以在覆盖函数中记录原始函数的使用，并将参数传递给您尝试记录的实际调用。

这个方法的好处是它几乎可以捕捉到你可以进行的任何调用，包括一个完全保留在用户空间中的函数，以及一个将进行内核调用的函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T20:53:32.637

我能想到的最好的方法是在“记录”模式下使用 gdb 进行调试：

*   [gdb进程记录/回放执行日志](https://stackoverflow.com/questions/5515216/gdb-process-record-replay-execution-log/5515275#5515275)

根据此页面：[GDB Process Record](http://sourceware.org/gdb/wiki/ProcessRecord)线程支持正在进行中，但可能尚未完成。

* * *

不太严格地回答你的问题，我可以建议吗

*   [赫尔格林德](http://valgrind.org/docs/manual/hg-manual.html)
*   [DRD](http://valgrind.org/docs/manual/drd-manual.html)

在其他平台上，存在其他几个线程检查器，但我对它们没有太多经验。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-12-05T16:45:29.643

所以GDB记录模式不支持多线程，但是RR记录/回放系统绝对支持：[https](https://rr-project.org/) ://rr-project.org/ 。

对于技术限制较少的商业解决方案，还有 UDB：[https](https://undo.io/solutions/) ://undo.io/solutions/ 。

我已经在调试器上工作了几年，从我所看到的情况来看，GDB 记录+重放的东西实际上还没有为黄金时段做好准备，因为这个和其他原因（例如，速度慢和巨大的内存需求）。

如果您可以让它在您的开发环境中工作，那么记录+重播/可逆调试可能会极大地改变您的工作流程；我希望你能找到一种利用它的方法。

# php - 使用EOF的缺点？

> ID：10404044
> 
> 赞同：2
> 
> 时间：2012-05-01T20:42:08.900
> 
> 标签：php, html

我已经看到嵌套在 PHP 页面中的 HTML 以多种方式编写...其中一些在此页面中进行了演示：http: [//austingulati.com/2010/01/many-ways-to-integrate-html-into -php/](http://austingulati.com/2010/01/many-ways-to-integrate-html-into-php/)

但是...我很少看到 HTML 和 PHP 统一编写如下：

```
echo <<<EOF
<h1>Welcome</h1>
<p>Hello</p>
<p>{$somePHPVariable}</p>
EOF; 
```

# 问题：

使用 EOF 方法是否存在我应该注意的基本问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-01T20:44:23.600

这称为[heredoc 语法](http://www.php.net/manual/en/language.types.string.php#language.types.string.syntax.heredoc)（“EOF”可以是任何标识符，而不仅仅是“EOF”）。它比其他字符串语法更挑剔一些，对于以前没有遇到过它的人来说可能会有点困惑。不过，使用起来非常好。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-01T20:51:38.547

如果您正在构建 HTML 并需要嵌入变量，Heredocs 非常棒。

它们尊重您嵌入其中的换行符/间距（即使浏览器不显示），因此构建格式良好的 HTML 会容易得多，并且还可以让您在构建字符串时无需转义引号：

例如比较

```
print("<div class=\"this\">\n\tblah blah\n\t\t<span class=\"that\">blah</span>\n</div>"); 
```

对比

```
echo <<<EOL
<div class="this">
    blah blah
        <span class="that"</span>
</div>
EOL; 
```

它们也可以用于连接操作，例如。

```
$x = "hello";
$x .= <<<EOL
  there, how 
EOL
$x .= <<<EOL
  are you?
EOL; 
```

最终会给 $x 价值`hello there, how are you?`。基本上认为 heredoc 语法是双引号字符串的非常花哨的版本，没有任何缺点。唯一的限制是heredoc 的标记值必须单独在一行，所以没有办法制作“单行”heredoc。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-01T20:48:14.503

Heredoc语法实际上很棒！这对于您有大量单引号和双引号的数据的情况非常有用。

在此之前，我已经介绍了它的一些细节： [引用引号](https://stackoverflow.com/questions/8994777/quoting-quotation-marks)

我发现它的缺点之一是它确实倾向于禁用编辑器中的语法突出显示，因为编辑器将其视为一个大字符串，因此不会正确突出显示内部的 html。

另一个缺点是无法从 heredoc 语法中直接调用函数。有一些变通方法，这里提到了其中的一些：[在 HEREDOC 字符串中调用 PHP 函数](https://stackoverflow.com/questions/104516/calling-php-functions-within-heredoc-strings)

# python - Scipy：将 RGB TIFF 转换为灰度 TIFF 并在 Matplotlib 上输出

> ID：10404050
> 
> 赞同：3
> 
> 时间：2012-05-01T20:42:27.560
> 
> 标签：python, matplotlib, rgb, grayscale

我想在 TIFF 文件中操作**RGB**波段并在 matplotlib 上输出**灰度图。**到目前为止，我有这段代码，但我无法在灰度上得到它：

```
import scipy as N
import gdal
import sys
import matplotlib.pyplot as pyplot

tif = gdal.Open('filename.tif')

band1 = tif.GetRasterBand(1)
band2 = tif.GetRasterBand(2)
band3 = tif.GetRasterBand(3)

red = band1.ReadAsArray()
green = band2.ReadAsArray()
blue = band3.ReadAsArray()

gray = (0.299*red + 0.587*green + 0.114*blue)

pyplot.figure()
pyplot.imshow(gray)
pylab.show() 
```

这些是数组：

```
[[255 255 255 ..., 237 237 251]
 [255 255 255 ..., 237 237 251]
 [255 255 255 ..., 237 237 251]
 ..., 
 [237 237 237 ..., 237 237 251]
 [237 237 237 ..., 237 237 251]
 [242 242 242 ..., 242 242 252]]

[[255 255 255 ..., 239 239 251]
 [255 255 255 ..., 239 239 251]
 [255 255 255 ..., 239 239 251]
 ..., 
 [239 239 239 ..., 239 239 251]
 [239 239 239 ..., 239 239 251]
 [243 243 243 ..., 243 243 252]]

[[255 255 255 ..., 234 234 250]
 [255 255 255 ..., 234 234 250]
 [255 255 255 ..., 234 234 250]
 ..., 
 [234 234 234 ..., 234 234 250]
 [234 234 234 ..., 234 234 250]
 [239 239 239 ..., 239 239 251]] 
```

知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-01T21:57:05.240

我没有安装 gdal，但是使用 PIL 的类似方法如下所示：

```
import numpy as np
import Image
import matplotlib.pyplot as pyplot

img = Image.open("/Users/travis/Desktop/new_zealand.tif")

img.getdata()
r, g, b = img.split()

ra = np.array(r)
ga = np.array(g)
ba = np.array(b)

gray = (0.299*ra + 0.587*ga + 0.114*ba)

pyplot.figure()
pyplot.imshow(img)
pyplot.figure()
pyplot.imshow(gray)
pyplot.figure()
pyplot.imshow(gray, cmap="gray") 
```

将颜色图设置为默认值（“jet”）之外的其他值可能很简单，以获得您想要的东西，但我不确定您看到的是什么。

这是生成的图像（不要问我为什么原件是颠倒的——不知道是什么原因造成的）：

![第一个图](../Images/5c81d977608ab80b3efec360f3563ea1.png)

![第二个图](../Images/307a26ecd5ffac0b021f7f24bb1bfcd5.png)

![第三个数字](../Images/3bd95e0da0eb4fc20cae1d50323774f0.png)

# backbone.js - 服务器错误的主干视图的默认信息

> ID：10404056
> 
> 赞同：0
> 
> 时间：2012-05-01T20:42:51.457
> 
> 标签：backbone.js

我们有一个代表用户帐户的主干模型。此模型的数据通过对我们后端的 API 调用传入。

如果用户**已**登录，服务器会返回帐户数据，一切正常。如果用户未登录，则后端返回 401。我希望主干以某种方式处理此问题，并使用硬编码的“匿名”数据。我怎样才能做到这一点？

修改后端以返回虚拟数据而不是返回 401 会是更好的方法吗？

编辑：“句柄”是指我需要能够运行此代码：

```
$.when(Account.fetch()).then(function() {alert("needs to be called");} 
```

目前， 401 导致该`then`子句不被调用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T20:44:29.907

骨干模型具有[默认属性](http://documentcloud.github.com/backbone/#Model-defaults)。它对你有用吗？

# c# - Skeleton 有 143 个骨骼，但支持的最大骨骼数为 72

> ID：10404060
> 
> 赞同：1
> 
> 时间：2012-05-01T20:42:54.127
> 
> 标签：c#, animation, xna, 3d

我正在使用带有很多骨骼的大型模型，SkinnedEffect 说最大支持的骨骼数量是 72，而我有 143，有什么可以解决的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T23:25:52.297

我假设您使用的是 .X 模型，因为我也遇到了这个问题。我改用 FBX，它似乎没有这个问题。

如果您使用的是 .fbx，请忽略我！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-19T16:29:19.740

它与位于 SkinningData.cs 中的 if 语句有关：在该文件中搜索

```
if (bones.Count > SkinnedEffect.MaxBones)
{
                throw new InvalidContentException(string.Format(
                    "Skeleton has {0} bones, but the maximum supported is {1}.",
                    bones.Count, SkinnedEffect.MaxBones));
 } 
```

并将其注释掉，并重建 skinnedmodelpipeline.dll

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T21:03:45.233

快速谷歌产生：

[http://en.wikibooks.org/wiki/Creating_a_Simple_3D_Game_with_XNA](http://en.wikibooks.org/wiki/Creating_a_Simple_3D_Game_with_XNA)

本教程包括搅拌机方面，但应涵盖您需要的内容

[http://en.wikibooks.org/wiki/Creating_a_Simple_3D_Game_with_XNA/Rendering_Your_Model](http://en.wikibooks.org/wiki/Creating_a_Simple_3D_Game_with_XNA/Rendering_Your_Model)

这就是您可能要查找的确切页面。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-02T07:07:15.603

我认为你有两个选择：

1.  划分网格......（明显更简单）

2.  以其他方式将骨骼变换传递给着色器。也许使用纹理......也许效率不高......我不知道......应该进行测试。

# ajax - MVC3 应用程序中的多个 AJAX 请求

> ID：10404061
> 
> 赞同：1
> 
> 时间：2012-05-01T20:42:57.617
> 
> 标签：ajax, asp.net-mvc, json

在这种情况下，我在同一页面上向控制器发出多个 ajax/json 请求，该控制器返回 JsonResult。

我知道这是会话状态的问题，我在控制器类上添加了 [SessionState(SessionStateBehavior.Disabled)] 属性，但似乎没有任何效果，我的第二个 ajax 请求不会得到返回数据。

控制器：

```
[SessionState(SessionStateBehavior.Disabled)]
public class IndexController : Controller
{} 
```

两个json方法：

```
[AcceptVerbs(HttpVerbs.Get)]
    public JsonResult GetLatestListJSON()
    {
        Thread.Sleep(5000);
        ArticleRepository repo = new ArticleRepository();
        IList<ArticleModel> list = repo.GetLatestContent(10);

        return Json(list, JsonRequestBehavior.AllowGet);
    }

    [AcceptVerbs(HttpVerbs.Get)]
    public JsonResult GetCustomerJSON()
    {
        Thread.Sleep(5000);
       CustomerRepository Repo = new CustomerRepository();
        IList<Customer> cust= Repo.GetCustomer();

        return Json(cust, JsonRequestBehavior.AllowGet);
    } 
```

第二**个**ajax调用，另一个非常相似，**我从来没有看到“成功”警报。**

```
<script type="text/javascript">
        $(document).ready(function () {
            alert('before');            

            $.getJSON("/Index/GetCustomerJSON", null, function (data) {
                alert('succes');
                $("#loadingGifVideo").hide();
                $.each(data, function (index, mod) {                        

                });
            });
        }); 
```

多谢你们 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T20:47:06.787

如果您在 GetCustomerJSON 方法中放置一个断点并在 Visual Studio 中运行它，该方法是否会被调用？*它确实*

**编辑**

尝试从 getJSON 切换到 ajax 方法，以便捕获任何错误。像这样：

```
$.ajax({
  url: "/Index/GetCustomerJSON",
  dataType: 'json',
  data: null,
  success: function (data) { alert('success'); }
  error: function (data) { alert('error'); }
}); 
```

您是否收到“错误”警报？

# python - OpenCV点目标检测未找到所有目标，并且找到的圆圈偏移

> ID：10404062
> 
> 赞同：8
> 
> 时间：2012-05-01T20:43:02.163
> 
> 标签：python, c, opencv, image-processing, computer-vision

我正在尝试检测黑/白点目标的中心，就像这张照片一样。我尝试使用 cv2.HoughCircles 方法，但 1，只能检测 2 到 3 个目标，以及 2，当我将找到的圆圈重新绘制到图像上时，它们总是略微偏移。

我使用了错误的方法吗？我应该使用 findContours 还是完全不同的东西？

![](../Images/6114110f0cf28f427ec0355c0e1a5582.png)

这是我的代码：

```
import cv2
from cv2 import cv
import os
import numpy as np

def showme(pic):
    cv2.imshow('window',pic)
    cv2.waitKey()
    cv2.destroyAllWindows()

im=cv2.imread('small_test.jpg')

gray=cv2.cvtColor(im,cv2.COLOR_BGR2GRAY)

#I've tried blur,bw,tr...  all give me poor results.

blur = cv2.GaussianBlur(gray,(3,3),0)
n,bw = cv2.threshold(blur,120,255,cv2.THRESH_BINARY)
tr=cv2.adaptiveThreshold(blur,255,0,1,11,2)

circles = cv2.HoughCircles(gray, cv.CV_HOUGH_GRADIENT, 3, 100, None, 200, 100, 5, 16)

try:
    n = np.shape(circles)
    circles=np.reshape(circles,(n[1],n[2]))
    print circles
    for circle in circles:
        cv2.circle(im,(circle[0],circle[1]),circle[2],(0,0,255))
    showme(im)
except:
    print "no cicles found" 
```

这是我当前的输出：

![](../Images/38d20c04dccf86bca564b0d1dfc63be7.png)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-02T15:04:23.777

播放我在[另一篇文章](https://stackoverflow.com/a/6416361/176769)中编写的代码，我能够获得稍微好一点的结果：

![](../Images/79cbe36fe17a007b3eae54442b6d9677.png)

**这都是关于参数的。**它总是如此。

该程序中调用了 3 个重要的函数，您应该试验一下：`cvSmooth()`、`cvCanny()`和`cvHoughCircles()`。他们每个人都有可能彻底改变结果。

这是C代码：

```
IplImage* img = NULL;
if ((img = cvLoadImage(argv[1]))== 0)
{
    printf("cvLoadImage failed\n");
}

IplImage* gray = cvCreateImage(cvGetSize(img), IPL_DEPTH_8U, 1);
CvMemStorage* storage = cvCreateMemStorage(0);

cvCvtColor(img, gray, CV_BGR2GRAY);

// This is done so as to prevent a lot of false circles from being detected
cvSmooth(gray, gray, CV_GAUSSIAN, 7, 9);

IplImage* canny = cvCreateImage(cvGetSize(img),IPL_DEPTH_8U,1);
IplImage* rgbcanny = cvCreateImage(cvGetSize(img),IPL_DEPTH_8U,3);
cvCanny(gray, canny, 40, 240, 3);

CvSeq* circles = cvHoughCircles(gray, storage, CV_HOUGH_GRADIENT, 2, gray->height/8, 120, 10, 2, 25);
cvCvtColor(canny, rgbcanny, CV_GRAY2BGR);

for (size_t i = 0; i < circles->total; i++)
{
     // round the floats to an int
     float* p = (float*)cvGetSeqElem(circles, i);
     cv::Point center(cvRound(p[0]), cvRound(p[1]));
     int radius = cvRound(p[2]);

     // draw the circle center
     cvCircle(rgbcanny, center, 3, CV_RGB(0,255,0), -1, 8, 0 );

     // draw the circle outline
     cvCircle(rgbcanny, center, radius+1, CV_RGB(0,0,255), 2, 8, 0 );

     printf("x: %d y: %d r: %d\n",center.x,center.y, radius);
}

cvNamedWindow("circles", 1);
cvShowImage("circles", rgbcanny);

cvSaveImage("out.png", rgbcanny);
cvWaitKey(0); 
```

我相信你有能力将它移植到 Python。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T12:30:09.227

由于该圆形图案是固定的并且与对象很好区分，简单的模板匹配应该可以很好地工作，请查看`cvMatchTemplate`。对于更复杂的条件（由于对象形状或视图几何形状而导致的翘曲），您可以尝试更强大的功能，如 SIFT 或 SURF ( `cvExtractSURF`)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-04-09T14:57:40.390

大多数使用 Python 代码检测圆圈

```
import cv2
import numpy as np

img = cv2.imread('coin.jpg')
gray = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)
blur = cv2.GaussianBlur(gray,(7,9),6)
cimg = cv2.cvtColor(blur,cv2.COLOR_GRAY2BGR)
circles = cv2.HoughCircles(blur,cv2.HOUGH_GRADIENT,1,50,
                            param1=120,param2=10,minRadius=2,maxRadius=30)

circles = np.uint16(np.around(circles))
for i in circles[0,:]:
    # draw the outer circle
    cv2.circle(cimg,(i[0],i[1]),i[2],(0,255,0),2)
    # draw the center of the circle
    cv2.circle(cimg,(i[0],i[1]),2,(0,0,255),3)

cv2.imshow('detected circles',cimg)
cv2.waitKey(0)
cv2.destroyAllWindows() 
```

# playn - 如何在渲染之前使用 HTML5 获取图像的宽度？

> ID：10404066
> 
> 赞同：0
> 
> 时间：2012-05-01T20:43:27.637
> 
> 标签：playn

在纯 Java 版本中，在 Image 或 ImageLayer 上调用 width() 或 height() 有效。但是对于 HTML5 后端，如果我调用它太早，我会得到零。

```
Image image = assets().getImage("images/myimage.png"); 
ImageLayer layer = graphics().createImageLayer(image);
float w1 = image.width(); 
float w2 = layer.width(); 
```

我在游戏初始化代码中的 getImage() 之后以及从 paint() 方法中尝试过，第一次调用 paint()。但我总是使用 HTML5 后端（Chrome、MacOs）得到零。但是，如果我在第二次调用 paint() 方法后调用 width()，我会得到正确的宽度。因此，HTML5 后端的语义似乎有所不同：width() 方法在第一次渲染后返回图像/图层的正确宽度。

我的解释是否正确以及如何在渲染前获得尺寸？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T18:16:34.717

资产观察器运行良好。或者，您可以向图像添加回调。加载图像时会调用“完成”函数。

取自[pea.java](http://code.google.com/r/jameslwilliams-playnsamples-gradle/source/browse/hello/html/src/main/java/playn/sample/hello/core/Pea.java)：

```
// Add a callback for when the image loads.
// This is necessary because we can't use the width/height (to center the
// image) until after the image has been loaded
image.addCallback(new ResourceCallback<Image>() {
  @Override
  public void done(Image image) {
    layer.setOrigin(image.width() / 2f, image.height() / 2f);
    layer.setTranslation(x, y);
    peaLayer.add(layer);
  }

  @Override
  public void error(Throwable err) {
    log().error("Error loading image!", err);
  }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T21:51:20.137

您是否尝试过使用[AssetWatcher](http://docs.playn.googlecode.com/git/javadoc/index.html)？看起来那些第一次`width`调用超出了文档加载图像的能力。

下面是一个简单的例子`AssetWatcher`：

*   [http://playn-2011.appspot.com/slides/index.html#37](http://playn-2011.appspot.com/slides/index.html#37)

下面是 PlayN Showcase 示例的实现`AssetWatcher`：

*   [http://code.google.com/p/playn-samples/source/browse/showcase/core/src/main/java/playn/showcase/core/sprites/SpriteLoader.java?#99](http://code.google.com/p/playn-samples/source/browse/showcase/core/src/main/java/playn/showcase/core/sprites/SpriteLoader.java?#99)

# ios - 如何限制 UITextField 中的小数点数？

> ID：10404067
> 
> 赞同：31
> 
> 时间：2012-05-01T20:43:32.327
> 
> 标签：ios, uitextfield, decimal-point

我有一个 UITextField，单击它会在左下角显示一个带小数点的数字键盘。我正在尝试限制该字段，以便用户只能放置 1 个小数点

例如
2.5 OK
2..5 NOT OK

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-05-01T23:42:01.197

像这样实现 shouldChangeCharactersInRange 方法：

```
// Only allow one decimal point
// Example assumes ARC - Implement proper memory management if not using.
- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string 
{
    NSString *newString = [textField.text stringByReplacingCharactersInRange:range withString:string];
    NSArray  *arrayOfString = [newString componentsSeparatedByString:@"."];

    if ([arrayOfString count] > 2 ) 
        return NO;

    return YES;
} 
```

这将创建一个由小数点分割的字符串数组，因此如果有多个小数点，我们将在数组中至少有 3 个元素。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2014-01-14T02:56:17.697

这是一个带有正则表达式的示例，该示例仅限于一个小数点和 2 个小数点。您可以对其进行调整以满足您的需求。

```
- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string {
    NSString *newString = [textField.text stringByReplacingCharactersInRange:range withString:string];
    NSString *expression = @"^[0-9]*((\\.|,)[0-9]{0,2})?$";
    NSError *error = nil;
    NSRegularExpression *regex = [NSRegularExpression regularExpressionWithPattern:expression options:NSRegularExpressionCaseInsensitive error:&error];
    NSUInteger numberOfMatches = [regex numberOfMatchesInString:newString options:0 range:NSMakeRange(0, [newString length])];
    return numberOfMatches != 0;
} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2017-06-21T15:22:31.240

**Swift 3**实现此 UITextFieldDelegate 方法以防止用户输入无效数字：

```
func textField(_ textField: UITextField, shouldChangeCharactersIn range: NSRange, replacementString string: String) -> Bool {
    let text = (textField.text ?? "") as NSString
    let newText = text.replacingCharacters(in: range, with: string)
    if let regex = try? NSRegularExpression(pattern: "^[0-9]*((\\.|,)[0-9]*)?$", options: .caseInsensitive) {
        return regex.numberOfMatches(in: newText, options: .reportProgress, range: NSRange(location: 0, length: (newText as NSString).length)) > 0
    }
    return false
} 
```

它使用逗号或点作为小数分隔符。您还可以使用此模式限制小数位数：（`"^[0-9]*((\\.|,)[0-9]{0,2})?$"`在本例中为 2）。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2018-08-16T08:59:36.963

# 斯威夫特 4

```
func textField(_ textField: UITextField, shouldChangeCharactersIn range: NSRange, replacementString string: String) -> Bool {

    // Allow to remove character (Backspace)
    if string == "" {
        return true
    }

   // Block multiple dot
    if (textField.text?.contains("."))! && string == "." {
        return false
    }

    // Check here decimal places
    if (textField.text?.contains("."))! {
        let limitDecimalPlace = 2
        let decimalPlace = textField.text?.components(separatedBy: ".").last
        if (decimalPlace?.count)! < limitDecimalPlace {
            return true
        }
        else {
            return false
        }
    }
    return true
} 
```

# Objective-C

```
//Create this variable in .h file or .m file
float _numberOfDecimal;

//assign value in viewDidLoad method
numberOfDecimal = 2;

#pragma mark - TextFieldDelegate
- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string {

    // Allow to remove character (Backspace)
    if ([string isEqualToString:@""]) {
        return true;
    }

    // Block multiple dot
    if ([textField.text containsString:@"."] && [string isEqualToString:@"."]) {
        return false;
    }

    // Check here decimal places
    if ([textField.text containsString:@"."]) {
        NSString *strDecimalPlace = [[textField.text componentsSeparatedByString:@"."] lastObject];

        if (strDecimalPlace.length < _numberOfDecimal) {
            return true;
        }
        else {
            return false;
        }
    }
    return true;
} 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2017-02-04T07:06:24.327

**对于 Swift 2.3 以防止用户在两个位置后输入十进制数字 -**

```
func textField(textField: UITextField, shouldChangeCharactersInRange range: NSRange, replacementString string: String) -> Bool
{
    let decimalPlacesLimit = 2
    let rangeDot = txtPrice.text!.rangeOfString(".", options: .CaseInsensitiveSearch)

    if rangeDot?.count > 0
    {
        if (string == ".")
        {
            print("textField already contains a separator")
            return false
        }
        else {

            var explodedString = txtPrice.text!.componentsSeparatedByString(".")
            let decimalPart = explodedString[1]
            if decimalPart.characters.count >= decimalPlacesLimit && !(string == "")
            {
                print("textField already contains \(decimalPlacesLimit) decimal places")
                return false
            }
        }
    }
} 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2014-05-27T19:19:44.160

基于公认的答案，以下方法验证了在处理货币格式时有用的三个案例：

1.  数额特别大
2.  小数点后2个以上字符
3.  多于 1 位小数

确保您的文本字段的委托设置正确，您的类符合`UITextField`协议，并添加以下委托方法。

```
- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string
{
  // Check for deletion of the $ sign
  if (range.location == 0 && [textField.text hasPrefix:@"$"])
    return NO;

  NSString *updatedText = [textField.text stringByReplacingCharactersInRange:range withString:string];
  NSArray *stringsArray = [updatedText componentsSeparatedByString:@"."];

  // Check for an absurdly large amount
  if (stringsArray.count > 0)
  {
    NSString *dollarAmount = stringsArray[0];
    if (dollarAmount.length > 6)
      return NO;
  }

  // Check for more than 2 chars after the decimal point
  if (stringsArray.count > 1)
  {
    NSString *centAmount = stringsArray[1];
    if (centAmount.length > 2)
      return NO;
  }

  // Check for a second decimal point
  if (stringsArray.count > 2)
    return NO;

  return YES;
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-09-13T05:20:40.307

```
-(BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string 
{
    if(textField == min_textfield )
    {
        if([textField.text rangeOfString:@"."].location == NSNotFound)
        {
            if([string isEqualToString:@"."] )
            {
                flag_for_text = 1;
            }
            else 
            {
                textField.text = [NSMutableString stringWithFormat:@"%@",textField.text];
            }
        }
        else 
        {
            if([string isEqualToString:@"."])
            {
                return NO;
            }
            else 
            {
                textField.text = [NSMutableString stringWithFormat:@"%@",textField.text];
            }
        }
    }
} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2016-08-17T05:29:46.807

尝试这个 ：-

```
public func textView(textView: UITextView, shouldChangeTextInRange range: NSRange, replacementText text: String) -> Bool {

    if(text == "," || text == "." ){
        let countdots = textView.text!.componentsSeparatedByString(".").count - 1

        if countdots > 0 && (text == "." || text == "," )
        {
            return false
        }
    }

    return true
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2018-10-19T12:02:22.750

斯威夫特 4

整数的最大数量为 4 即 9999，最大小数位数限制为 2。因此，最大数量可以是 9999.99

```
func textField(_ textField: UITextField, shouldChangeCharactersIn range: NSRange, replacementString string: String) -> Bool {

    // 100 is the tag value of our textfield
    /*or you may use "if textfield == myTextField{" if you have an IBOutlet to that textfield */
    if textField.tag == 100 {

        //max length limit of text is 8
        if textField.text!.count > 8 && string != "" {
            return false
        }

        let maxLength = 8
        let currentString: NSString = textField.text! as NSString 
```

// 使用下面的代码 如果您在该文本字段中输入价格并希望在用户开始在该文本字段中输入时自动插入 $，或者您可以在开头放置一些其他字符而不是 $。否则注释以下 3 行 if 条件代码

```
 if currentString.length == 0 {
            priceTextField.text = "$"
        } 
```

//插入新输入的字符后的新字符串

```
 let newString: NSString =
            currentString.replacingCharacters(in: range, with: string) as NSString

        if newString.length > maxLength{
            return false
        }

        if (textField.text!.range(of: ".") != nil) {
            let numStr = newString.components(separatedBy: ".")
            if numStr.count>1{
                let decStr = numStr[1]
                if decStr.length > 2{
                    return false
                }
            }
        }

        var priceStr: String = newString as String

        if (textField.text!.range(of: "$") != nil) {
            priceStr = priceStr.replacingOccurrences(of: "$", with: "")
        }

        let price: Double = Double(priceStr) ?? 0

        if price > 9999.99{
            return false
        }

        switch string {
        case "0","1","2","3","4","5","6","7","8","9":
            return true
        case ".":
            let array = Array(textField.text!)
            var decimalCount = 0
            for character in array {
                if character == "." {
                    decimalCount = decimalCount + 1
                }
            }

            if decimalCount == 1 {
                return false
            } else {
                return true
            }
        default:

            let array = Array(string)
            if array.count == 0 {
                return true
            }
            return false
        }
    }
    return true
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2017-03-27T07:55:13.047

**斯威夫特 3**

无需创建数组和检查计数。限制用户只能像这样放置 1 个小数点。

```
func textField(_ textField: UITextField, shouldChangeCharactersIn range: NSRange, replacementString string: String) -> Bool {
    if (textField.text?.contains("."))! && string.contains(".")
    {
        return false
    }
    else
    {
        return true
    }
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-05-30T06:55:45.080

我提出了解决方案，它可以让您控制小数位数，因此用户只能输入一个小数分隔符，您还可以控制小数位数。

只需正确设置**decimalPlacesLimit**值。

见方法：

```
- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string
{
    NSLog(@"text on the way: %@", string);
    NSUInteger decimalPlacesLimit = 2;

    NSRange rangeDot = [textField.text rangeOfString:@"." options:NSCaseInsensitiveSearch];
    NSRange rangeComma = [textField.text rangeOfString:@"," options:NSCaseInsensitiveSearch];
    if (rangeDot.length > 0 || rangeComma.length > 0){
        if([string isEqualToString:@"."]) {
            NSLog(@"textField already contains a separator");
            return NO;
        } else {
            NSArray *explodedString = [textField.text componentsSeparatedByString:@"."];
            NSString *decimalPart = explodedString[1];
            if (decimalPart.length >= decimalPlacesLimit && ![string isEqualToString:@""]) {
                NSLog(@"textField already contains %d decimal places", decimalPlacesLimit);
                return NO;
            }
        }
    }

    return YES;
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-05-01T20:51:02.900

在您将 UITextField 的委托设置为的任何对象中，添加一个响应[" `[- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string]`"](https://stackoverflow.com/questions/2412491/realtime-formatting-with-nsnumberformatter-in-a-uitextfield)的方法。

然后，您可以使用`NSNumberFormatter`对象，也可以对已经存在的小数点进行暴力检查（`NO`如果小数点已经存在，则返回）。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-06-17T21:10:25.243

简而言之，数字格式如下`[NSString stringWithFormat:@"%9.5f", x];`其中 5 是“，”之后的小数。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2019-03-07T10:39:15.230

```
-(BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string {
    if([string isEqualToString:@"."]) {
        BOOL containsDecimal = [textField.text containsString:@"."];
        return !containsDecimal;
    }
    return YES;
} 
```

如果文本字段文本已包含“。” 然后返回 NO 否则返回 YES。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2018-05-22T09:34:32.667

**Swift 4**

The efficient and easy way to avoid multiple decimal points (. or ,) in UITextField:

```
 func textField(_ textField: UITextField, shouldChangeCharactersIn range: NSRange, replacementString string: String) -> Bool {
    if(string == "," || string == "." ){

        if ((textField.text?.contains(","))! || (textField.text?.contains("."))!){
            return false
        }
    }
    return true
} 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2020-12-15T01:24:00.923

## **斯威夫特 5**

**改进**

信息：不允许：

*   开头的分隔符
*   零加另一个数字，除非您在后面添加分隔符

**1：设置键盘类型为：Decimal Pad**

[![在此处输入图像描述](../Images/37b9b517d1368d45a8a439150d5e1ddc.png)](https://i.stack.imgur.com/zcErx.png)

**2：复制过去**

```
func textField(_ textField: UITextField, shouldChangeCharactersIn range: NSRange, replacementString string: String) -> Bool {
    //!\ set the keyboard type to : Decimal Pad /!\\
    // CUSTOM SETUP
    let c = NSLocale.current.decimalSeparator ?? "."
    let limitBeforeSeparator = 2
    let limitAfterSeparator = 2
    // ---------

    var validatorUserInput:Bool = false

    let text = (textField.text ?? "") as NSString
    let newText = text.replacingCharacters(in: range, with: string)

    // Validator
    let pattern = "(?!0[0-9])\\d*(?!\\\(c))^[0-9]{0,\(limitBeforeSeparator)}((\\\(c))[0-9]{0,\(limitAfterSeparator)})?$"
    if let regex = try? NSRegularExpression(pattern: pattern, options: .caseInsensitive) {
        validatorUserInput = regex.numberOfMatches(in: newText, options: .reportProgress, range: NSRange(location: 0, length: (newText as NSString).length)) > 0
    }

    if validatorUserInput {
        // setting data or something eles before the return
        if let char = string.cString(using: String.Encoding.utf8) {
            let isBackSpace = strcmp(char, "\\b")
            if (isBackSpace == -92 && textField.text?.count == 1) {
                print("Backspace was pressed")
                print(newText)
                // do something...

            } else {
                print("Number Added")
                print(newText)
                // do something...

            }
        }
        return validatorUserInput
    } else {
        return validatorUserInput
    }
} 
```

**3：方法中设置，如果要x分隔符前后最大位数**

```
 let limitBeforeSeparator = 2 
 let limitAfterSeparator = 2 
```

# c# - Aspnet mvc4 webapi导致工作进程崩溃

> ID：10404070
> 
> 赞同：0
> 
> 时间：2012-05-01T20:43:47.163
> 
> 标签：c#, asp.net-mvc-4, asp.net-web-api

我在 asp.net mvc4 站点上的 WebAPI 有问题，错误消息是：

在使用本地名称“__type”编写属性之后，您必须编写一个属性“type”=“object”。

堆栈是：

```
at System.Web.Http.WebHost.HttpControllerHandler.EndProcessRequest(IAsyncResult result)
at System.Web.Http.WebHost.HttpControllerHandler.System.Web.IHttpAsyncHandler.EndProcessRequest(IAsyncResult result)
at System.Web.HttpApplication.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute()
at System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) 
```

我的方法返回一个对象列表 IEnumerable ，产品是 datacontract 可序列化没有任何问题

我通过全局错误处理程序恢复了这个错误，当它发生时应用程序被回收。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T18:48:42.520

您是否尝试过[这里](http://forums.asp.net/t/1773173.aspx/1)的任何建议？它们似乎都与序列化有关（不使用`virtual`关键字，指定已知类型等）。

实际上，我建议不要做帖子中人们所描述的事情，即直接从他们的数据库上下文中使用实体，而不是将它们变成某种响应模型，原因如下：

*   如果您的实体发生变化，您可能**违反了**与您的 WebAPI 的任何消费者的合同
*   如果您想在来自上下文后转换任何值，则必须在控制器中进行，这很糟糕，因为 i* *t 为控制器提供了映射和转换的额外责任**（[AutoMapper](http://automapper.codeplex.com/)最适合这个）
*   作为前两点的一种组合，您将持久性模型关注点与“视图”（或在本例中为合同）关注点耦合在一起（即，您不能随意更改实体而不担心合同，反之亦然）

不确定您是否在没有看到更多代码的情况下做任何这些事情，但它可能有助于使您尝试在 ApiController 中使用的模型尽可能为[POCO](http://msdn.microsoft.com/en-us/library/cc681329.aspx) -y。

# jquery - 为什么这个 Jquery If 语句不起作用？

> ID：10404073
> 
> 赞同：1
> 
> 时间：2012-05-01T20:43:58.587
> 
> 标签：jquery

我有这样的声明：

我已经仔细检查了相关 html 元素的 id。如果我删除 if 语句，一切正常。你知道为什么它不起作用吗？

```
 <script type="text/javascript">
        $(document).ready(function() {
            $("#ok").click(function() {

                $('#ok').attr('disabled', 'disabled');

                //global vars                     
                var ad = $("#ad").val().length;  

                    If (ad < 6) {
                    alert("you must enter a higher value");
                    }

                });
            });

    </script> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T20:46:16.707

我猜你应该小写你的“如果”。这个问题显然不是类型相关的问题。

并通过对问题的评论和下面的答案来澄清：

```
If (ad < 6) { 
```

应该

```
if (ad < 6) { 
```

之所以如此，是因为 Javascript 区分大小写。我非常感谢所有参与此事的人，我希望不会再对与此问题相关的任何事情感到困惑。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T20:51:40.950

JavaScript 是区分大小写的，所以你的 if 必须全部小写，试试这个

```
 if (ad < 6) {
     alert("you must enter a higher value");
 } 
```

# php - 表格不显示

> ID：10404075
> 
> 赞同：0
> 
> 时间：2012-05-01T20:44:07.587
> 
> 标签：php, forms

有人能告诉我为什么这不显示表格吗？如果我转到托管它的地址，页面只会显示“您的消息已发送。谢谢，.” 它似乎只是执行并显示最后一个功能。

```
 <?php

    function validateInput($data, $fieldName) {
        global $errorCount;
        if (empty($data)) {
            echo "\"$fieldName\" is a required field.<br />\n";
            ++$errorCount;
            $retval = "";
        } else { // only clean up the input if it isn't empty
            $retval = trim($data);
            $retval = stripsplashes($retval);
        }
        return($retval);
    }

    function validateEmail($data, $fieldName) {
        global $errorCount;
        if (empty($data)) {
            echo "\"$fieldName\" is a required field.<br />\n";
            ++$errorCount;
            $retval = "";
        } else { // only clean up the input if it isn't empty
            $retval = trim($data);
            $retval = stripsplashes($retval);
            $pattern = "/^[\w-]+(\.[\w-]+)*@" . "[\w-]+(\.[\w-]+)*" . "(\.[[a-z]]{2,})$/i";
            if (preg_match($pattern, $retval) == 0) {
                echo "\"$fieldName\" is not a valid e-mail address.<br />\n";
                ++$errorCount;
            }
        }
        return($retval);
    }

    function displayForm($Sender, $Email, $Subject, $Message) {
        ?>
        <h2 style = "text-align:center">Contact Me</h2>
        <form name="contact" action="ContactForm.php" method="post">
            <p>Your name: <input type="text" name="Sender" value="<?php echo $Sender; ?>" /></p>
            <p>Your E-mail: <input type="text" name="Email" value="<?php echo $Sender; ?>" /></p>
            <p>Subject: <input type="text" name="Subject" value="<?php echo $Subject; ?>" /></p>
            <p>Message:<br />
                <textarea name="Message"><?php echo $Message; ?></textarea></p>
            <p><input type="reset" value="Clear Form" />&nbsp; &nbsp;<input type="submit" name="Submit" value="Send Form" /></p>
        </form>
        <?php
    }

    $ShowForm = TRUE;
    $errorCount = 0;
    $Sender = "";
    $Email = "";
    $Subject = "";
    $Message = "";

    if (isset($_POST['Submit'])) {
        $Sender = validateInput($_POST['Sender'],"Your Name");
        $Email = validateInput($_POST['Email'],"Your E-mail");
        $Subject = validateInput($_POST['Subject'],"Subject");
        $Message = validateInput($_POST['Message'],"Message");
        if ($errorCount == 0)
            $ShowForm = FALSE;
        else
            $ShowForm = TRUE;
    }

    if ($ShowForm == TRUE)
        if ($errorCount>0) {// if there were errors
            echo "<p>Please re-enter the form information below.</p>\n";
            displayForm($Sender, $Email, $Subject, $Message);
        } else {
            $SenderAddress = "$Sender <$Email>";
            $Headers = "From: $SenderAddress\nCC: $SenderAddress\n";
            // Substitute your own e-mail address for recipient@example.com
            $result = mail("recipient@example.com", $Subject, $Message, $Headers);
            if ($result)
                echo "<p>Your message has been sent. Thank you, " . $Sender . ".</p>\n";
            else
                echo "<p>There was an error sending your message, " . $Sender . ".</p>\n";
        }
    ?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T20:49:55.180

你有：

```
$showForm = TRUE; 
```

其中，当表单尚未提交时，将导致条件语句始终为真`$errorCount == 0`。你不会`displayForm()`在那个条件的 else 情况下调用。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T20:46:05.313

好的，错误是因为大括号应该在 if ($ShowForm == TRUE) 而不是 if ($errorCount>0) 之后。

# java - 将时区存储为 ID 字符串或从 UTC 偏移？

> ID：10404080
> 
> 赞同：1
> 
> 时间：2012-05-01T20:44:24.837
> 
> 标签：java, datetime, date, timezone, jodatime

在存储给定日期的时区时，通过保存时区的 ID 字符串（例如 Joda's `DateTimeZone.getId()`）与保存与 UTC 的本地时间偏移量（例如 Joda's ）相比，是否有特别的优势`DateTimeZone.getOffset()`？

尽管 Joda 的 DateTimeZone 和 JDK 的 TimeZone 似乎共享 ID 字符串，但似乎保存偏移量与语言无关。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T20:50:16.083

答案取决于您的用例。偏移量与语言无关，但可能需要解释回 ID 以供用户选择。大多数用户不知道他们的偏移量是什么。另一方面，如果可以合理地期望您的用户知道他们的偏移量，那么您就不需要解释。这更像是一个设计决策，然后是一个最佳实践问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T20:50:48.417

仅使用偏移量存储您将不知道夏令时等。文档中的示例：“使用此系统，America/Los_Angeles 在夏季表示为 UTC-08:00 或 UTC-07:00”

# c# - 分层应用程序中的验证

> ID：10404081
> 
> 赞同：8
> 
> 时间：2012-05-01T20:44:26.453
> 
> 标签：c#, model-view-controller, validation, repository, domain-driven-design

我想知道在 ASP.NET MVC 应用程序中验证数据库约束（例如 UNIQUE）的最佳方法是什么，在构建时考虑到 DDD，其中底层是应用程序层（应用程序服务）、域层（域模型）和基础设施层（持久性逻辑、日志记录等）。

我一直在查看很多 DDD 示例，但其中许多没有提到如何在存储库中进行验证（我想这就是这种验证适合的地方）。如果您知道这样做的任何示例，请分享它们，我们将不胜感激。

更具体地说，我有两个问题。**您将如何执行实际验证？**您会通过查询数据库明确检查客户名称是否已经存在，还是尝试将其直接插入数据库并捕获错误（如果有）（看起来很乱）？我更喜欢第一个，如果选择这个，应该在存储库中完成，还是应该是应用程序服务的工作？

当检测到错误时，**如何将其传递给 ASP.NET MVC，以便用户可以很好地了解错误？**最好使用，`ModelStateDictionary`以便在表单上轻松突出显示错误。

在 Microsoft Spain 的 N-Lyered 应用程序中，他们使用`IValidatableObject`接口并将最简单的属性验证放在实体本身上，例如：

```
public IEnumerable<ValidationResult> Validate(ValidationContext validationContext)
{
    var validationResults = new List<ValidationResult>();

    if (String.IsNullOrWhiteSpace(this.FirstName))
        validationResults.Add(new ValidationResult(Messages.validation_CustomerFirstNameCannotBeNull, new string[] { "FirstName" }));

    return validationResults;
} 
```

在实体被持久化之前，会调用 Validate 消息来确保属性有效：

```
void SaveCustomer(Customer customer)
{
    var validator = EntityValidatorFactory.CreateValidator();

    if (validator.IsValid(customer)) //if customer is valid
    {
        _customerRepository.Add(customer);
        _customerRepository.UnitOfWork.Commit();
    }
    else
        throw new ApplicationValidationErrorsException(validator.GetInvalidMessages<Customer>(customer));
} 
```

然后可以在 MVC 应用程序中捕获 ApplicationValidationErrorsException，并且可以解析验证错误消息并将其插入到`ModelStateDictionary`.

我可以将所有验证逻辑添加到 SaveCustomer 方法中，例如使用给定列（唯一列）查询数据库检查客户是否已经存在。也许这没关系，但我宁愿`validator.IsValid`（或类似的东西）为我做这件事，或者在基础设施层再次执行验证（如果它属于这里，我不确定）。

你怎么看？你怎么做呢？我对深入了解分层应用程序中的不同验证技术非常感兴趣。

* * *

## 可能的解决方案#1

如果验证逻辑无法在表示层中完成（如 Iulian Margarintescu 建议的那样）并且需要在服务层中完成，您将如何将验证错误传递给表示层？

Microsoft 在[这里](http://www.asp.net/mvc/tutorials/older-versions/models-%28data%29/validating-with-a-service-layer-cs)有一个建议（参见清单 5）。您如何看待这种方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T02:59:19.993

您提到了 DDD，但 DDD 不仅仅是实体和存储库。我假设您熟悉 Eric Evans 先生的《领域驱动设计》一书，我强烈建议您重新阅读有关战略设计和有界上下文的章节。此外，Evans 先生有一个非常精彩的演讲，名为“自从这本书以来我对 DDD 的了解”，您可以在[此处](http://domaindrivendesign.org/library/evans_2009_1)找到。Greg Young 或 Udi Dahan 关于 SOA、CQRS 和事件溯源的讨论也包含很多关于 DDD 和应用 DDD 的信息。我必须警告您，您可能会发现一些事情会改变您对应用 DDD 的看法。

现在对于您关于验证的问题 - 一种方法可能是在用户在“名称”字段中键入内容后立即查询数据库（使用定向到应用程序服务的 Ajax 调用）并尝试建议替代名称，如果他输入的一个已经存在。当用户提交表单时，尝试在数据库中插入记录并处理任何重复键异常（在存储库或应用服务级别）。由于您已经提前检查重复项，因此出现异常的情况应该很少见，因此任何体面的“我们很抱歉，请重试”消息都应该这样做，除非您有很多用户，否则他们可能永远不会看到它.

[Udi Dahan的这篇文章](http://www.udidahan.com/2009/12/09/clarified-cqrs/)也有一些关于接近验证的信息。请记住，这可能是您对企业施加的约束，而不是企业对您施加的约束——也许它为企业提供了更多价值，允许同名客户注册，而不是拒绝他们。

还要记住，DDD 更多的是关于业务而不是技术。您可以执行 DDD 并将您的应用程序部署为单个程序集。以“好”设计的名义，多次滥用位于数据库之上的实体之上的服务之上的客户端代码层，而没有任何理由说明它为什么是一个好的设计。

我不确定这会回答你的问题，但我希望它能指导你自己找到答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T08:26:06.380

> 我想知道验证数据库约束的最佳方法是什么（例如 UNIQUE）
> 
> 如果选择这个，应该在存储库中完成，还是应该是应用程序服务的工作？

这取决于您要验证的内容。

如果它是您尝试验证的聚合根创建 - 那么没有什么比应用程序本身“持有”它更全球化了。在这种情况下，我直接在存储库中应用验证。

如果它是一个实体，它就存在于聚合根上下文中。在这种情况下，我将针对此特定聚合根中的所有其他实体验证聚合根本身中的实体唯一性。实体/根中的值对象也是如此。

ps 存储库是一项服务。不要将服务视为通用存储，以获取必要但难以正确命名的代码。命名很重要。“Helpers”、“Managers”、“Common”、“Utilities”等名称也是如此——它们几乎毫无意义。

此外 - 您不需要使用模式名称污染您的代码库：AllProducts > ProductRepository；订单注册器 > 订单服务；order.isCompleted > IsOrderCompletedSpecification.IsSatisfiedBy。

> 更具体地说，我有两个问题。您将如何执行实际验证？您会通过查询数据库明确检查客户名称是否已经存在，还是尝试将其直接插入数据库并捕获错误（如果有）（看起来很乱）？

我会查询数据库。虽然，如果高性能是一个问题并且客户名称可用性是数据库应该强制执行的唯一事情 - 我会依赖数据库（减少往返次数）。

> 当检测到错误时，如何将其传递给 ASP.NET MVC，以便用户可以很好地了解错误？最好使用 ModelStateDictionary，以便在表单上轻松突出显示错误。

通常使用异常来控制应用程序流不是一个好主意，但是，由于我想强制 UI 只显示可以完成的可用事情，所以我只是在验证失败时抛出异常。在 UI 层中，有一个处理程序可以巧妙地将其拾取并以 html 形式输出。

此外 - 了解什么是命令的范围很重要（例如，产品订购命令可能会检查两件事 - 如果客户不是债务人以及产品是否在商店中）。如果命令有多个关联的验证，这些应该耦合在一起，以便 UI 可以同时接收它们。否则会导致烦人的用户体验（在尝试一遍又一遍地订购该死的产品时经历多个错误）。

# nhibernate - Nhibernate 拦截器没有获取基类的属性

> ID：10404083
> 
> 赞同：0
> 
> 时间：2012-05-01T20:44:35.107
> 
> 标签：nhibernate, nhibernate-mapping

我正在从 Fluent 转换为 Loquacious，并且遇到了一个问题，即我的拦截器没有像我认为的那样获取所有字段。如果我查看 OnSave 功能

```
public override Boolean OnSave(Object entity, Object id, Object[] state,
        String[] propertyNames, IType[] types) 
```

并查看 propertyNames，其中唯一的项目是在映射文件中显式映射的项目（在示例中，这只是 ID、Start 和 End）。

就我而言，虽然我有一个根本没有映射的基类。相反，它只包含由拦截器填写的属性。这曾经在 Fluent Nhibernate 中工作，但现在我已经迁移到 Nhibernate 3.3，我无法再让它工作了。

我的类/映射看起来像这样

```
public class BaseAuditEntity
{
  public virtual int ModifiedByUserID { get; set; }
  public virtual DateTime LastModifiedTime { get; set; }
}

public class Foo : BaseAuditEntity
{
  public virtual int ID { get; protected internal set; }
  public virtual DateTime Start { get; protected internal set; }
  public virtual DateTime End { get; protected internal set; }
}

public class FooMap: ClassMapping<Foo>
{
  Id(x => x.ID, m => m.column("fooID"));
  Property(x => x.Start, m => m.column("start"));
  Property(x => x.End, m => m.column("end"));
} 
```

关于如何完成这项工作的任何想法？我不想在每个班级都映射这个，而且我认为我不需要映射 BaseAuditEntity，至少在 Fluent 中不需要它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T06:53:47.100

you could make a base mapping class

```
public class BaseAuditEntityMapping<T> : ClassMapping<T> where T: BaseAuditEntity
{
    ManyToOne(x => x.ModifiedByUser);
    Property(x => x.LastModifiedTime);
}

public class FooMap: BaseAuditEntityMapping<Foo> 
```

# c# - 不同用户帐户的 Windows 服务安装程序（本地系统除外）

> ID：10404085
> 
> 赞同：0
> 
> 时间：2012-05-01T20:44:41.807
> 
> 标签：c#, .net, vb.net, windows-installer, installshield

```
Set objService = objWMIService.Get("Win32_BaseService") 

objService.Create("usb2",  "usb test",  "c:\usb2.exe", 
 OWN_PROCESS,  NORMAL_ERROR_CONTROL,  "Automatic",  NOT_INTERACTIVE,  null 
```

这总是会创建指向的 Windows 服务安装

> 本地系统

用户（由于为空），我想指向本地系统以外的其他内容，不同的用户帐户和密码。当我为 Windows 服务创建安装程序时，如何指向不同的用户帐户？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T20:51:22.083

我假设您正在根据您的标签使用 InstallShield 创作 MSI。您不必编写任何代码。您可以使用 ServiceInstall 表定义您的服务。使用您的 EXE 作为密钥文件创建一个组件，然后进入高级，服务并右键单击以添加新服务。填写所有属性，您应该一切顺利。

# sql - 我应该有单独的表格还是整合数据？

> ID：10404092
> 
> 赞同：2
> 
> 时间：2012-05-01T20:45:23.650
> 
> 标签：sql, oracle10g, foreign-keys

我正在设计一个 SQL 数据库，它有 2 个需要“manager_id”的表。“员工”表和“设施”表。因为经理被认为是员工，所以我不确定是否应该有一个单独的“经理”表，或者只是将其整合到“员工”表中。我是 SQL 新手，不确定这样的情况。这是我到目前为止的代码：

```
CREATE TABLE Employees (
emp_id NUMBER(5) NOT NULL,
emp_name VARCHAR2(20) NOT NULL,
emp_add1 VARCHAR2(30) NOT NULL,
emp_add2 VARCHAR2(30) NOT NULL,
emp_add3 VARCHAR2(30),
emp_town VARCHAR2(30),
emp_county NUMBER(2) NOT NULL,
emp_telno NUMBER(10),
emp_position NUMBER(3) NOT NULL,
emp_manager NUMBER(4),
CONSTRAINT pk_empid PRIMARY KEY (emp_id),
CONSTRAINT fk_empcounty FOREIGN KEY (emp_county) REFERENCES County(county_id),
CONSTRAINT fk_empposition FOREIGN KEY (emp_position) REFERENCES Positions(position_id),
CONSTRAINT fk_empmanager FOREIGN KEY (emp_manager) REFERENCES Manager(manager_id)
);

CREATE TABLE Facilities (
facility_id NUMBER(2) NOT NULL,
facility_name VARCHAR(15) NOT NULL,
facility_manager NUMBER(4) NOT NULL,
CONSTRAINT pk_facilityid PRIMARY KEY (facility_id);
CONSTRAINT fk_facilitymanager FOREIGN KEY (facility_manager) REFERENCES Manager(manager_id)
); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T21:01:13.707

这是关于[关系规范化](http://en.wikipedia.org/wiki/Database_normalization)（关系数据库中的数据组织）的问题。

那么如何组织：

好吧，尽管规范化有许多步骤，目的是产生最有效的结构。在您的情况下，您应该首先尝试将公共位放在同一个表中的方法，而非公共位应该放在另一个表中。

因此，由于经理是员工（可以说具有员工头衔、姓名、部门的属性），所以它应该在员工表中。但是假设经理有非经理没有的剪贴板（例如属性颜色和大小）。在这种情况下，您将添加一个 Manager 表来处理这些。

```
-- employeee table
id  Name      Title      Dept
1   adohertyd Coder      IT
2   Preet     Ninja      SillyWalks
3   Skeety    Secretary  Cleaning

-- manager table 
manager_id  employee_id  clipboard_size  clipboard_colour
1           2            Big             Black 
```

你会找到这样的经理

```
select Name, Dept, clipboard_size  
from employee e 
inner join manager m on e.id = m.employee_id 
```

随着您走得更远，您可能会发现将其中一些属性带入员工表并具有“Is_manager”列更有效。这本质上是非规范化，在需要之前应该避免。

# php - API 获取价值 Tumblr

> ID：10404094
> 
> 赞同：0
> 
> 时间：2012-05-01T20:45:35.277
> 
> 标签：php, api, tumblr

我正在尝试使用 Tumblrs API，当我访问 API 的 URL 时，我在下面得到这个

```
{
    "meta": {
        "status": 200
        "msg": "OK",
    },
    "response": {
        "blog": {
            "title": "Ex-Sample",
            "posts": 20,
            "name": "example",
            "url": "http://example.tumblr.com/",
            "updated": 1327794725,
            "description": "A sample document used to provide examples of the various [and <i>varying</i>] HTML tags Tumblr puts out. Quote, specifically, has a lot of variants.",
            "ask": false
        }
    }
} 
```

网址是[http://api.tumblr.com/v2/blog/example.tumblr.com/info?api_key=(APIKEY](http://api.tumblr.com/v2/blog/example.tumblr.com/info?api_key=(APIKEY) )

我正在尝试使用上面的 URL 获取“帖子”编号。我将如何在 PHP 中执行此操作并仅将数字回显出来？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T20:46:46.813

这看起来像一个 JSON 字符串，所以...

```
$msg = '{"meta" etc.....';
$data = json_decode($msg);
echo $data['meta']['response']['blog']['posts']; 
```

您可以使用

```
var_dump($data); 
```

以格式良好的树结构转储整个响应。

# javascript - 停止动画 div 的 settimeout 增量

> ID：10404096
> 
> 赞同：0
> 
> 时间：2012-05-01T20:45:52.297
> 
> 标签：javascript, animation, settimeout

我有一个函数可以增加 div 层位置的 css 质量，并且需要它在它达到一定数量的百分比时停止，无论是向右还是向左（取决于层）。我尝试使用大于运算符执行 if 语句，但似乎不起作用。这是完整的代码：

```
<html>
<head>
<title>Stelucir</title>
<style>
body {
  background-color: white;
}
#bg-right {
  background-color: black;
  position: fixed;
  top: 0;
  bottom: 0;
  left: 50%;
  right: 0;
  z-index: -1;
}
</style>
<script type="text/javascript">

var header = null; // object
var about = null; // object
var blog = null; // object
var forum = null; // object
var chat = null; // object
var home = null; // object

function doMove() {
  header.style.right = parseInt(header.style.right)+1+'%';
  about.style.left = parseInt(about.style.left)+1+'%';
  blog.style.right = parseInt(blog.style.right)+1+'%';
  forum.style.left = parseInt(forum.style.left)+1+'%';
  chat.style.right = parseInt(chat.style.right)+1+'%';
  home.style.left = parseInt(home.style.left)+1+'%';
  setTimeout(doMove,30); // call doMove in 20msec
}

function init() {
  header = document.getElementById('header');
  about = document.getElementById('about');
  blog = document.getElementById('blog');
  forum = document.getElementById('forum');
  chat = document.getElementById('chat');
  home = document.getElementById('home'); 
  doMove(); // start animating
}

window.onload = init;

</script>
</head>
<body>
<div id="bg-right"></div>
<div id="header" style = "position:absolute;right:25%;font-size:80px;">Stelucir</div>
<div id="about" style = "position:absolute;left:40%;font-  size:40px;top:90px;color:white;">About</div>
<div id="blog" style = "position:absolute;right:40%;font-size:40px;top:130px;">Blog</div>
<div id="forum" style = "position:absolute;left:40%;font-size:40px;top:170px;color:white;">Forum</div>
<div id="chat" style = "position:absolute;right:40%;font-size:40px;top:210px;">Chat</div>
<div id="home" style = "position:absolute;left:40%;font-size:40px;top:250px;color:white;">Home</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T20:57:37.763

我更建议使用间隔而不是多个 setTimeout 调用。setInterval 和 setTimeout 都返回一个引用，可以使用 clearInterval(ref) 或 clearTimeout(ref) 来阻止它们；

这是一个小小提琴，它使一个盒子向右移动并在它在那里时停止。

[http://jsfiddle.net/JV35w/1/](http://jsfiddle.net/JV35w/1/)

```
var elem = document.getElementById('foo'),
    startX = 0,
    endX = 400,
    move = function() {
        elem.style.left = startX + 'px';
        startX += 10;
        if (endX === startX) {
            startX = 0;
            clearInterval(t);
        };
    },
    doMove = function() {
        t = setInterval(move);
    },
    t;

doMove();​ 
```

[https://developer.mozilla.org/en/DOM/window.setTimeout](https://developer.mozilla.org/en/DOM/window.setTimeout)

[https://developer.mozilla.org/en/DOM/window.setInterval](https://developer.mozilla.org/en/DOM/window.setInterval)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T20:47:45.210

使用全局布尔值。从 true 开始，当它达到你想要的任何点时，将其设置为 false。在 doMove 中检查是否为真，如果为假，则返回。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T20:50:38.330

`setTimeout()`返回计时器的句柄。然后，您可以调用`clearTimeout()`此句柄来停止计时器。

创建一个全局变量来存储它

```
var timer = null;
...
function doMove() {
    ...
    timer = setTimeout(...);
}
//somewhere else
clearTimeout(timer); 
```

# rss - 如何归档 RSS 提要？

> ID：10404098
> 
> 赞同：4
> 
> 时间：2012-05-01T20:46:11.180
> 
> 标签：rss

我需要获取一些 RSS 提要，并将添加到其中的所有项目存档。我以前从未使用或创建过 RSS，但我知道 xml，所以格式看起来很直观。

我知道如何解析提要：[如何开始制作 C# RSS 阅读器？](https://stackoverflow.com/questions/576267/c-sharp-rss-reader)

我知道我不能依靠 feed 服务器来提供完整的历史记录：[Is it possible to get RSS archive](https://stackoverflow.com/questions/2123918/is-it-possible-to-get-rss-archive)

我知道我必须有一些关于重复的自定义逻辑：[如何检查 rss 提要中帖子的唯一性（非重复）](https://stackoverflow.com/questions/3656107/how-to-check-uniqueness-non-duplication-of-a-post-in-an-rss-feed)

我的问题是，我怎样才能确保我不会错过任何物品？我最初的计划是编写一个解析器，其中对于提要中的每个项目：1）检查它是否已经在存档数据库中 2）如果没有，将其添加到数据库中如果我安排它每天运行一次，可以我有信心不会遗漏任何物品吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T20:50:09.940

这取决于提要，一些网站非常频繁地发布文章，并且可能将其 RSS 提要配置为仅显示 10 篇最新文章。有些网站会做相反的事情。

理想情况下，您的应用程序应该从站点“学习”频率，并根据学习到的频率调整自身以 ping 这些站点。（例如：如果您每次 ping 都看到新的独特文章，则需要更频繁地 ping，另一方面，如果您多次尝试看到同一组文章，您可能会在下次退出）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-03-30T18:13:24.913

如果您愿意为此依赖服务...我建立了自己的 RSS 存档服务 ( [https://app.pub.center](https://app.pub.center) )。您可以通过我们的 API 访问 RSS 提要的数据。

大西洋的第 1 页 [https://pub.center/feed/02702624d8a4c825dde21af94e9169773454e0c3/articles?limit=10&page=1](https://pub.center/feed/02702624d8a4c825dde21af94e9169773454e0c3/articles?limit=10&page=1)

大西洋的第 2 页 [https://pub.center/feed/02702624d8a4c825dde21af94e9169773454e0c3/articles?limit=10&page=2](https://pub.center/feed/02702624d8a4c825dde21af94e9169773454e0c3/articles?limit=10&page=2)

REST API 是免费的。我们有推送通知的定价计划（电子邮件、短信、您的自定义 API 端点）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-10-06T17:31:12.920

根据饲料和存储限制使用一系列决策。例如：

```
    连接到 Web 站点，并下载提要的 XML 源。提要下载引擎仅通过 HTTP 或安全超文本传输​​协议 (HTTPS) 协议下载提要和附件。

    将提要源转换为 Windows RSS 平台本机格式，该格式基于 RSS 2.0 和附加的命名空间扩展。（本机格式本质上是所有受支持格式的超集。）为此，Windows RSS 平台需要 Microsoft XML (MSXML) 3.0 SP5 或更高版本。

    将新的提要项目与提要商店中的现有提要项目合并。
    当接收到预定的最大数量的项目时，从源存储中清除旧项目。

    或者，使用后台智能传输服务 (BITS) 安排附件的下载。

```

充分利用 HTTP 以最大程度地减少浪费的带宽：

> 为了限制其对服务器的影响，Feed 下载引擎在 HTTP (RFC3229) 万维网链接中实现了 HTTP 条件 GET 与 Delta 编码相结合。此实现允许服务器传输更改的最小描述，而不是传输缓存在客户端上的全新资源实例。该引擎还支持使用 Microsoft Win32 Internet (WinInet) 的 HTTP gzip 支持进行压缩。
> 
> 成功同步意味着提要已成功下载、验证、转换为原生格式并合并到商店中。响应 HTTP 条件 GET（If-Modified-Since、If-None-Match、ETag 等）的 HTTP 304 Not Modified 服务器响应也构成成功。

并定义移除标准：

```
以下属性直接影响同步操作后剩余的项目数。

    PubDate——用于确定项目的“年龄”。如果未设置 PubDate，则使用 LastDownloadTime。如果提要是列表，则项目的顺序是预先确定的，并且忽略 PubDate（如果存在）。

    MaxItemCount - 限制归档项目数量的每个提要设置。提要的 ItemCount 永远不会超过最大值，即使可以从提要中下载更多项目也是如此。

    ItemCountLimit — 任何一个 Feed 的项目上限，通常定义为 2500。MaxItemCount 的值不得超过此限制。将 MaxItemCount 设置为 ItemCountLimit 以保留尽可能多的项目。

```

**参考**

*   [了解 Feed 下载引擎](https://msdn.microsoft.com/en-us/library/ms686420)

# postgis - PostGIS OSM 查询

> ID：10404101
> 
> 赞同：1
> 
> 时间：2012-05-01T20:46:33.603
> 
> 标签：postgis, openstreetmap

我是地理问题的新手，需要询问有关使用 PostGIS 的问题。我通过 osmosis 将 OpenStreetMap 数据导入 PgSQL，我需要查询这些数据。

本质上，我有来自 GPS 的位置，我只需要获取节点、路径和区域的所有标签，这些标签至少在距离我一定距离内（比如说 100 米）。

我真的不知道从哪里开始。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T19:07:46.567

如果您有纬度和经度，您可以尝试以下操作：

```
select * from nodes_with_tags 
where st_distance(geography(geom), 
 geography(st_geomfromewkt('SRID=4326;POINT(' || lng || ' ' || lat || ')'))) 
  <= 100; 
```

使用“地理”功能进行转换会减慢速度，但会给出以米为单位的距离，而不是难以理解的度数。

您还可以对“ways”表执行相同的查询，将“geom”列替换为ways.linestring 列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T23:11:34.423

检查此链接：[LINK](http://unserializableone.blogspot.com/2007/02/using-postgis-to-find-points-of.html)

它适用于邮政编码，但如果您熟悉 SQL，则可以轻松更改它。注意：如果你使用大数据库，你也应该使用边界框（参见 Box3D 函数）......它有助于减少查询时间。

# textmate - 在 TextMate 中，您可以让命令转到文件中的一行吗？（或者：它可以对特定字符串进行查找吗？）

> ID：10404107
> 
> 赞同：1
> 
> 时间：2012-05-01T20:46:58.230
> 
> 标签：textmate

我经常想`print`在我的（Python）文件中找到未注释的语句。我有一个简单的正则表达式`^\s*print`来完成这项工作。有没有办法将它分配给键盘快捷键，以便它可以找到下一个未注释的打印，而无需输入正则表达式？

我的第一个想法是创建一个可以找到它的命令，但是一旦找到它，我就无法将光标移动到该行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-17T00:07:08.370

您可以在 TextMate中使用[宏功能：](http://manual.macromates.com/en/macros)

1.  转到捆绑包 > 宏 > `Start Recording`(⌥⌘M)
2.  使用您的正则表达式执行单个查找命令
3.  转到捆绑包 > 宏 > `Stop Recording`(⌥⌘M)
4.  转到捆绑包 > 宏 > `Save Last Recording`(⌃⌘M)
5.  使用合适的名称和键盘快捷键将您的宏保存到您喜欢的任何捆绑包中。一个好主意是将它保存到默认的 Python 包中，以便键盘快捷键仅在您打开 Python 文件时可用。

# ruby-on-rails-3 - 如何将图像添加到 RailsAdmin 中的 belongs_to 下拉列表

> ID：10404108
> 
> 赞同：0
> 
> 时间：2012-05-01T20:46:59.690
> 
> 标签：ruby-on-rails-3, rails-admin

我有一个类属于：primary_image，：class_name => 'Image'。在 RailsAdmin 中，这被呈现为一个下拉小部件，向我显示数据库中的所有图像。但是，它们都是“图像#”，其中# 是它们的 ID。为了让管理员智能地选择图像，我希望他们改为查看图像的缩略图。有没有办法让添加到下拉列表中的信息成为图像标签，其来源是来自 Image 实例的 url？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T22:16:00.927

用于`object_label`设置您希望用作所有实例的显示名称的列/函数。

```
config.model Image do
  object_label :url
end 
```

* * *

我不确定你应该在那里使用 HTML，但它看起来像：

```
config.model Image do
  object_label :image_tag
end

# in image.rb
def image_tag
  %{<img src="#{self.url}">}.html_safe
end 
```

# javascript - 将变量传递到主干模板时，如何在模板中引用它？

> ID：10404112
> 
> 赞同：16
> 
> 时间：2012-05-01T20:47:17.430
> 
> 标签：javascript, jquery, templates, backbone.js, underscore.js

模板看起来像这样。

```
<div>
    <H5>Status for your request</H5>
    <table>
    <tbody>
    <tr>
        <th>RequestId</th>
        <th><%=id%></th>
    </tr>
    <tr>
        <th>Email</th>
        <th><%=emailId%></th>
    </tr>       
    <tr>
        <th>Status</th>
        <th><%=status%></th>
    </tr>       
     </tbody>
     </table>
</div> 
```

这是呈现页面的 View Javascript。

```
window.StatusView = Backbone.View.extend({

initialize:function () {
    console.log('Initializing Status View');
    this.template = _.template(tpl.get('status'));
},

render:function (eventName) {

    $(this.el).html(this.template());
    return this;
},

events: { "click button#status-form-submit" : "getStatus" },

getStatus:function(){

    var requestId = $('input[name=requestId]').val();
    requestId= $.trim( requestId );

    var request  = requests.get( requestId );

    var statusTemplate = _.template(tpl.get('status-display'));
    var statusHtml = statusTemplate( request );
    $('#results-span').html( statusHtml );
}

}); 
```

当点击输入时，会读取 requestId 并将状态附加在 id 为“results-span”的 html 元素中。

将 html-template 中的值替换为变量值时会发生故障。

```
var statusTemplate = _.template(tpl.get('status-display'));
var statusHtml = statusTemplate( request ); 
```

渲染失败并出现以下错误。

```
Uncaught ReferenceError: emailId is not defined
(anonymous function)
_.templateunderscore-1.3.1.js:931
window.StatusView.Backbone.View.extend.getStatusstatus.js:34
jQuery.event.dispatchjquery.js:3242
jQuery.event.add.elemData.handle.eventHandle 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-05-01T21:04:06.147

下划线[`_.template`](http://underscorejs.org/#template)：

> 将 JavaScript 模板编译为可评估以进行渲染的函数。
> [...]
> 
> ```
> var compiled = _.template("hello: <%= name %>");
> compiled({name : 'moe'});
> => "hello: moe" 
> ```

因此，基本上，您将模板函数交给一个对象，然后模板在该对象内部查找您在模板中使用的值；如果你有这个：

```
<%= property %> 
```

在您的模板中，您将模板函数称为`t(data)`，然后模板函数将查找`data.property`.

通常您将视图的模型转换为 JSON 并将该对象交给模板：

```
render: function (eventName) {
    $(this.el).html(this.template(this.model.toJSON()));
    return this;
} 
```

我不知道你`eventName`是什么或你打算用它做什么，但你需要得到一个具有这种结构的对象：

```
data = { id: '...', emailId: '...', status: '...' } 
```

从某处并将其交给模板函数：

```
var html = this.template(data) 
```

获取一些 HTML 放在页面上。

演示（带有用于说明目的的假模型）：http: [//jsfiddle.net/ambiguous/hpSpf/](http://jsfiddle.net/ambiguous/hpSpf/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-02-08T04:36:01.803

```
OptionalExtrasView = Backbone.View.extend({
    initialize: function() {
        this.render();
    },
    render: function() {
        // Get the product id
        //var productid = $( this ).attr( "productid" );
        var data = {name : 'moe'};

        var tmpl = _.template($('#pddorder_optionalextras').html() );
        this.$el.html(tmpl(data));
    }
});

   var search_view = new OptionalExtrasView({ el :     $('.pddorder_optionalextras_div')}); 
```

就在body标签之前：

```
 <script type="text/template" id="pddorder_optionalextras">
   <%= name %>
    </script> 
```

# iphone - UITableView 无限滚动

> ID：10404116
> 
> 赞同：43
> 
> 时间：2012-05-01T20:47:55.910
> 
> 标签：iphone, objective-c, ios, ipad

如何在 a 中进行无限滚动`UITableView`？我知道如何使用 a 来做到这一点`UIScrollView`，苹果在其中一个 WWDC 的视频中进行了演示。我尝试执行以下操作`tableView:cellForRowAtIndexPath:`：

```
if (indexPath.row == [self.newsFeedData_ count] - 1)
{
    [self.newsFeedData_ addObjectsFromArray:self.newsFeedData_];
    [self.tableView reloadData];
} 
```

但这失败了。还有什么想法吗？

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2012-05-01T21:15:45.430

如果你需要知道什么时候触到了 UITableView 的底部，就成为它的委托（因为它是 UIScrollView 的子类），并使用 -scrollViewDidScroll: 委托方法来比较表格的内容高度和它的实际滚动位置。

编辑（像这样）：

```
- (void)scrollViewDidScroll:(UIScrollView *)scrollView_ 
{   
    CGFloat actualPosition = scrollView_.contentOffset.y;
    CGFloat contentHeight = scrollView_.contentSize.height - (someArbitraryNumber);
    if (actualPosition >= contentHeight) {
        [self.newsFeedData_ addObjectsFromArray:self.newsFeedData_];
        [self.tableView reloadData];
     }
} 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2013-03-09T01:02:27.977

您可以使用以下方法支持无限滚动，通过拉动在顶部刷新和/或在底部使用微调器连续滚动：

[https://github.com/samvermette/SVPullToRefresh](https://github.com/samvermette/SVPullToRefresh)

`SVPullToRefresh``UITableView`到达底部时处理逻辑。自动显示微调器并触发回调块。您将业务逻辑添加到回调块中。

这是一个例子：

```
#import "UIScrollView+SVInfiniteScrolling.h"

// ...

[tableView addInfiniteScrollingWithActionHandler:^{
    // append data to data source, insert new cells at the end of table view
    // call [tableView.infiniteScrollingView stopAnimating] when done
}]; 
```

该项目可以使用[CocoaPods](http://cocoapods.org/)添加到您的项目中，也可以直接编译到您的项目中。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2013-02-22T16:03:35.163

这是我放在一起的无限滚动 UITableView 的一个非常快速和完整的演示......

```
@interface InfiniteScrollViewController ()

@property (nonatomic) NSMutableArray *tableViewData;
@property (nonatomic) BOOL loadingMoreTableViewData;

@end

@implementation InfiniteScrollViewController

- (void)viewDidLoad {
    self.tableViewData = [[NSMutableArray alloc] init];
    [self addSomeMoreEntriesToTableView];
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {
    return self.tableViewData.count + 1;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    static NSString *CellIdentifier = @"Cell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    }

    if (indexPath.row < self.tableViewData.count) {
        cell.textLabel.text = [self.tableViewData objectAtIndex:indexPath.row];
    } else {
        cell.textLabel.text = @"Loading more data...";

        // User has scrolled to the bottom of the list of available data so simulate loading some more if we aren't already
        if (!self.loadingMoreTableViewData) {
            self.loadingMoreTableViewData = YES;
            [self performSelector:@selector(addSomeMoreEntriesToTableView) withObject:nil afterDelay:5.0f];
        }
    }

    return cell;
}

- (void)addSomeMoreEntriesToTableView {
    int loopTill = self.tableViewData.count + 20;
    while (self.tableViewData.count < loopTill) {
        [self.tableViewData addObject:[NSString stringWithFormat:@"%i", self.tableViewData.count]];
    };
    self.loadingMoreTableViewData = NO;
    [self.tableView reloadData];
}

@end 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2012-07-12T04:54:39.453

'UITableView' 与 'scrollViewDidScroll' 方法中的 'UIScrollView' 相同。

因此，它很容易模拟无限滚动。

1.  将数组加倍，以便将头部和尾部连接在一起以模拟圆桌

2.  当用户倾向于到达表格的开头或结尾时，使用我的以下代码使用户在双倍表的第一部分和双倍表的第二部分之间切换。

：

```
/* To emulate infinite scrolling...

The table data was doubled to join the head and tail: (suppose table had 1,2,3,4)
1 2 3 4|1 2 3 4 (actual data doubled)
---------------
1 2 3 4 5 6 7 8 (visualising joined table in eight parts)

When the user scrolls backwards to 1/8th of the joined table, user is actually at the 1/4th of actual data, so we scroll instantly (we take user) to the 5/8th of the joined table where the cells are exactly the same.

Similarly, when user scrolls to 6/8th of the table, we will scroll back to 2/8th where the cells are same. (I'm using 6/8th when 7/8th sound more logical because 6/8th is good for small tables.)

In simple words, when user reaches 1/4th of the first half of table, we scroll to 1/4th of the second half, when he reaches 2/4th of the second half of table, we scroll to the 2/4 of first half. This is done simply by subtracting OR adding half the length of the new/joined table.
*/

-(void)scrollViewDidScroll:(UIScrollView *)scrollView_ 
{  

    CGFloat currentOffsetX = scrollView_.contentOffset.x;
    CGFloat currentOffSetY = scrollView_.contentOffset.y;
    CGFloat contentHeight = scrollView_.contentSize.height;

    if (currentOffSetY < (contentHeight / 8.0)) {
    scrollView_.contentOffset = CGPointMake(currentOffsetX,(currentOffSetY + (contentHeight/2)));
    }
   if (currentOffSetY > ((contentHeight * 6)/ 8.0)) {
       scrollView_.contentOffset = CGPointMake(currentOffsetX,(currentOffSetY - (contentHeight/2)));
    }

} 
```

PS - 我在我的一个名为 NT Time Table (Lite) 的应用程序中使用了此代码。如果您想要预览，您可以查看应用程序：[https ://itunes.apple.com/au/app/nt-time-table-lite/id528213278?mt=8](https://itunes.apple.com/au/app/nt-time-table-lite/id528213278?mt=8)

如果您的表有时可能太短，则可以在上述方法的开头添加一个 if 逻辑以在数据计数例如小于 9 时退出该方法。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2015-08-24T22:53:09.330

对我来说，**scrollViewDidEndDragging:**比**scrollViewDidScroll:**效果更好。

第二种方法将在滚动期间向您发送每个位置，并且导致，如果您正在获取远程资源，您将多次访问您的端点，这并不好。

基于*@codafi*解决方案的完整示例以及来自*@danielgomezrico*关于如何计算*contentHeight*的评论：

```
- (void)scrollViewDidEndDragging:(UIScrollView *)scrollView
                  willDecelerate:(BOOL)decelerate {
    CGFloat actualPosition = scrollView.contentOffset.y;
    CGFloat contentHeight = scrollView.contentSize.height - (self.tableView.frame.size.height);
    if (actualPosition >= contentHeight) {
        // fetch resources
        [self.tableView reloadData];
    }
} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2015-07-16T12:40:42.520

通常我会覆盖`scrollViewDidEndDecelerating`并在其中放入我的代码以请求更多数据。
例子：

```
- (void)scrollViewDidEndDecelerating:(UIScrollView *)scrollView{

    float endScrolling = scrollView.contentOffset.y + scrollView.frame.size.height;

    if (endScrolling >= scrollView.contentSize.height){
        //put here your code

    }
} 
```

最近我在 GitHub 上上传了一个 UITableView 的子类，它实现了无限滚动。
你可以在这里下载：
[https ://github.com/alchimya/iOS-LazyTableView](https://github.com/alchimya/iOS-LazyTableView)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-11-19T16:56:44.460

我们可以在 layoutSubviews 中优化而不是覆盖。这是我如何实现它的。[您可以在此处](http://shardulprabhu.blogspot.in/2012/11/infinite-scrolling-with-reusable-views.html)了解有关实施的更多信息

```
- (void)layoutSubviews{
[super layoutSubviews];

if(self.delegateForViews){

    CGPoint contentOffset = self.contentOffset;

    if([self.delegateForViews noOfViews]>numOfReusableViews){
        NSUInteger centerIndex=visibleViews.count/2;
        NSUInteger noOfViews=[self.delegateForViews noOfViews];
        UIView *centerView=[visibleViews objectAtIndex:centerIndex];

        CGPoint centerViewOrigin=centerView.frame.origin;
        CGSize centerViewSize=centerView.frame.size;
        CGFloat offsetDifference=contentOffset.x-centerViewOrigin.x;
        CGFloat offsetDifferenceAbs=fabs(contentOffset.x-centerViewOrigin.x);

        if(offsetDifferenceAbs>=centerViewSize.width){

            if(offsetDifference<0){
                currentPosition--;
            }else{
                currentPosition++;
            }

            self.contentOffset=centerViewOrigin;

            currentPosition=[self getPosition:currentPosition noOfViews:noOfViews];

            [self.delegateForViews clearView:centerView];
            [self.delegateForViews setupView:centerView forPosition:currentPosition];

            for (int i=centerIndex-1; i>=0; i--) {
                UIView* prevView=[visibleViews objectAtIndex:i];
                [self.delegateForViews clearView:prevView];
                [self.delegateForViews setupView:prevView forPosition:
                        [self getPosition:currentPosition-1 noOfViews:noOfViews]];
            }

            for (int i=centerIndex+1; i<visibleViews.count; i++) {
                UIView* nextView=[visibleViews objectAtIndex:i];
                [self.delegateForViews clearView:nextView];
                [self.delegateForViews setupView:nextView forPosition:
                        [self getPosition:currentPosition+1 noOfViews:noOfViews]];
            }

        }
    }

}

} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-01-21T12:20:12.863

一个简单的并且为我提供了我需要的一切是这个类：

[https://github.com/jakemarsh/JMStatefulTableViewController](https://github.com/jakemarsh/JMStatefulTableViewController)

您只需要将 JMStatefulTableViewController 子类化，它有 3 个需要覆盖的方法：

*   在 init 上调用的一个，用于获取初始数据
    *   statefulTableViewControllerWillBeginInitialLoading
*   用户拉动刷新时的一个
    *   statefulTableViewControllerWillBeginLoadingFromPullToRefresh
*   一次调用无限滚动（下一页）
    *   statefulTableViewControllerWillBeginLoadingNextPage

这也可以从[Cocoapods](http://cocoapods.org/)中使用。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-04-16T04:59:57.267

当您在 tableview 中移动时，scrollviewDidScroll 将调用

```
func scrollViewDidScroll(_ scrollView: UIScrollView) {
    //check for the visible rows
    let indexpath = self.tableView.indexPathsForVisibleRows?.last
    //check if the visible row last is equal to the total number of counts
    if(indexpath?.last == self.listCount){
      //code for adding data to the tableview and reload the table view.
    }
} 
```

查看链接以获取有关 indexPathForVisibleRows 的更多详细信息 [https://developer.apple.com/documentation/uikit/uitableview/1614885-indexpathsforvisiblerows](https://developer.apple.com/documentation/uikit/uitableview/1614885-indexpathsforvisiblerows)

# emacs - Mac OS Lion 终端中的 Emacs - 将右命令键映射到元

> ID：10404117
> 
> 赞同：3
> 
> 时间：2012-05-01T20:47:59.043
> 
> 标签：emacs, osx-lion

我刚开始在我的 Mac OS X Lion 上使用 GNU Emacs，我正试图通过各种键绑定来减轻我的手部运动。具体来说，我希望能够对 meta 使用正确的命令键。我的 .emacs 文件中的以下代码可用于独立应用程序 (Emacs.app)

```
;;; cmd key for meta
(setq mac-option-key-is-meta nil
mac-command-key-is-meta t
mac-command-modifier 'meta
mac-option-modifier 'none) 
```

（摘自此超级用户[答案](https://superuser.com/a/297452)的​​片段）

但不适用于在终端模式下运行的 emacs。元数据仍然是我从 Terminal.app 首选项中设置的 alt/option 键。当我禁用此选项键时，我将失去元键功能。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T23:47:26.867

我不知道终端为您提供处理左/右命令键映射的能力。iterm2 提供了完成您在那里寻找的东西的方法。尽管在 iterm2 的全球基础上。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T14:40:06.733

如果您必须在终端中使用 emacs，似乎有[keyremap4macbook可以为您节省一些时间。](http://pqrs.org/macosx/keyremap4macbook/index.html)我不能对此表示赞赏，但这[个人](https://stackoverflow.com/a/3399254/156561)可以

# silverlight - Windows Phone TextBox 在清除后保留自动更正建议

> ID：10404118
> 
> 赞同：1
> 
> 时间：2012-05-01T20:48:00.907
> 
> 标签：silverlight, textbox, windows-phone, autocorrect

我在应用程序中有一个文本框：

```
<TextBox AcceptsReturn="True" Name="MessageText" InputScope="Text" /> 
```

以下代码连接到一个按钮：

```
private void SendButton_Click(object sender, EventArgs e) {
    // lots of code...
    MessageText.Text = "";
} 
```

按下按钮时，文本框被正确清除，但软键盘的自动更正建议没有，就好像在清除之前输入文本框的最后一个单词仍然存在。

如果键盘关闭然后再次打开，建议工作正常。

解决此问题的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-19T19:08:55.897

您可以将焦点移出文本框（将焦点设置到页面），然后将焦点移回文本框。它可以工作并且不会闪烁或其他东西（至少在我的测试中）。

```
private void ApplicationBarIconButton_Click(object sender, EventArgs e)
{
    textBox1.Text = "";
    Focus();
    textBox1.Focus();
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-01T20:53:21.607

自动更正建议由系统处理，不能从应用程序中重置。清除这些建议的唯一方法是转到键盘设置。

# asp.net-mvc-3 - 将 Sublime Text 2 与 ASP.NET MVC 3 一起使用

> ID：10404123
> 
> 赞同：6
> 
> 时间：2012-05-01T20:48:21.727
> 
> 标签：asp.net-mvc-3, sublimetext2

我最近开始了一项新工作，我们通过 Visual Studio 2010 使用 ASP.NET MVC 3，但我严重错过了我的 Sublime Text 2！我主要是 Mac/Linux 开发人员，所以我对此类应用程序的构建系统不是很熟悉，但我想知道是否有人可以指出一些资源的方向，以设置 Sublime 以使用我的 MVC3 项目.

谢谢！任何帮助将不胜感激

# ruby-on-rails - 关于如何将格式良好的输出添加到自定义 Rails 生成器的指南

> ID：10404124
> 
> 赞同：2
> 
> 时间：2012-05-01T20:48:34.850
> 
> 标签：ruby-on-rails, generator

就像标题所说 - 我想将我的自定义输出添加到 rails 生成器 - 就像你看到`identical - xxx`或`force - xxx`

我想为我的自定义生成器添加特殊的、格式良好的警告——只是我没有看到任何指导，除了使用`puts`

例如，我想看看：

```
 Warining: Missing Related Data File 
```

警告一词将用红色书写。与您在典型的 rails 生成器命令中看到的非常相似...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T09:01:19.483

Rails 的生成器基于[Thor](https://github.com/wycats/thor/wiki)。当您提高 a 时`Thor::Error`，输出将自动变为红色。例如：

```
raise Error, "Warning: Missing related data file" 
```

这会将整个消息染成红色（并抑制回溯以获得更清晰的输出）。

此外，您可以在生成器中使用任何 Thor 的[操作](http://rdoc.info/github/wycats/thor/master/Thor/Shell/Basic)，以及几个，例如`say`and `yes?`，支持第二个`color`参数，允许您执行以下操作：

```
say_status "OK", "Blue is my favorite color", :blue 
```

[此处显示了](https://github.com/wycats/thor/blob/master/lib/thor/shell/color.rb#L53)可用的颜色。

最后，您可以[`set_color`](http://rdoc.info/github/wycats/thor/master/Thor/Shell/Color#set_color-instance_method)直接调用格式的细粒度控制，例如：

```
say set_color( "STOP ",    :red ) +
    set_color( "CAUTION ", :yellow ) +
    set_color( "GO!",      :green, true ) 
```

（如果第三个参数为真，则输出为粗体。）

我希望这会有所帮助——但请负责任地使用它！

# json - 从 NSDictionaries 的 NSDictionary 中获取值

> ID：10404127
> 
> 赞同：0
> 
> 时间：2012-05-01T20:48:50.733
> 
> 标签：json, macos, ios5, nsdictionary

我正在做一个原生 objC 应用程序。ios5 我想解析本地包中的 JSON 文件。并单独阅读每个项目。接下来是我的 JSON 文件的示例，然后是我正在工作的代码。我还解释了我认为正在发生的事情，以及我需要获得帮助的示例代码。也欢迎您纠正我的解释。

==================================================== ========================

{"a":[ {"b":{"Q01":"A01","Q02":"B01","Q03":"C01","Q04":"D01","Q05":"E01 ","Q06":"X","C1":"NR","CABG":"NR","PCI":"NR"}}, {"b":{"Q01":"A01", "Q02":"B01","Q03":"C01","Q04":"D01","Q05":"E02","Q06":"X","C1":"I","C1IND ":"20","C1SCORE":"3","CABG":"NR","PCI":"NR"}}, {"b":{"Q01":"A01","Q02": "B01","Q03":"C01","Q04":"D01","Q05":"E03","Q06":"X","C1":"NR","CABG":"NR","PCI":"NR"}}, {"b":{"Q01":"A01" ,"Q02":"B01","Q03":"C01","Q04":"D01","Q05":"E04","Q06":"X","C1":"NR"," CABG":"NR","PCI":"NR"}}, {"b":{"Q01":"A01","Q02":"B01","Q03":"C01","Q04" :"D01","Q05":"E05","Q06":"X","C1":"NR","CABG":"NR","PCI":"NR"}}NR"}}, {"b":{"Q01":"A01","Q02":"B01","Q03":"C01","Q04":"D01","Q05":"E04" ,"Q06":"X","C1":"NR","CABG":"NR","PCI":"NR"}}, {"b":{"Q01":"A01"," Q02":"B01","Q03":"C01","Q04":"D01","Q05":"E05","Q06":"X","C1":"NR","CABG" :"NR","PCI":"NR"}}NR"}}, {"b":{"Q01":"A01","Q02":"B01","Q03":"C01","Q04":"D01","Q05":"E04" ,"Q06":"X","C1":"NR","CABG":"NR","PCI":"NR"}}, {"b":{"Q01":"A01"," Q02":"B01","Q03":"C01","Q04":"D01","Q05":"E05","Q06":"X","C1":"NR","CABG" :"NR","PCI":"NR"}}"CABG":"NR","PCI":"NR"}}, {"b":{"Q01":"A01","Q02":"B01","Q03":"C01","Q04 ":"D01","Q05":"E05","Q06":"X","C1":"NR","CABG":"NR","PCI":"NR"}}"CABG":"NR","PCI":"NR"}}, {"b":{"Q01":"A01","Q02":"B01","Q03":"C01","Q04 ":"D01","Q05":"E05","Q06":"X","C1":"NR","CABG":"NR","PCI":"NR"}}

# ]}

# 我的代码如下所示：

```
NSString* filePath = [[NSBundle mainBundle] pathForResource:@"nonacs" ofType:@"json"];    

NSError* error = nil;
NSData *jsonData = [NSData dataWithContentsOfFile:filePath options:NSDataReadingMappedIfSafe error:&error];

if (jsonData) {

    id jsonObjects = [NSJSONSerialization JSONObjectWithData:jsonData options:NSJSONReadingMutableContainers error:&error];

    if (error) {
        NSLog(@"error is %@", [error localizedDescription]);
        // Handle Error and return
      return;
    }

    //NSArray *keys = [jsonObjects allKeys];    
    // not necessary becuase I know the Root key is a single "a"

    NSString* jsonString = [NSString stringWithFormat:@"%@",[jsonObjects objectForKey:@"a"]];

    tLabel01.text = [NSString stringWithFormat:@"jsonData Length is = %d",  [jsonData length]]; 

    NSDictionary* dict01 = [[NSDictionary alloc] initWithDictionary:jsonObjects];

    l2.text = [NSString stringWithFormat:@"dict01 length = %d", dict01.count];

    NSDictionary* dict02 =[[NSDictionary alloc] initWithDictionary:dict01];
    l3.text = [NSString stringWithFormat:@"dict2.length = %d", dict02.count];

    //NSArray* array01 = [[NSArray alloc] initWithObjects:dict01, nil];

    //NSArray *allvalues = [jsonObjects allValues];      
    //NSArray *allvalues = [[jsonObjects initWithContentsOf ] allValues];

    //l3.text = [NSString stringWithFormat:@"allvalues.count = %d", allvalues.count];        

    //NSDictionary   *dictB = [dict01 objectForKey:@"b"]; 

    //l3.text = [NSString stringWithFormat:@"dictB.count = %d", dictB.count];

    l3.text = [NSString stringWithFormat:@"jsonObject count = %d", [[jsonObjects objectForKey:@"a"] count]];
    //  this works really well...  except it returned 1700, and there should only be 1550

    //l4.text = @"nada";
    //[[jsonObjects objectForKey:@"a"] count]]        

    NSArray *array = [jsonObjects objectForKey:@"a"];
    NSArray *arrayVariable = [array objectAtIndex:0];

    //l4.text = [NSString stringWithFormat:@"Q01 = %@", [arrayVariable  objectForKey: @"Q01"]];        

    //l4.text =[NSString stringWithFormat:@"arrayVariable count = %d", arrayVariable.count];

    NSArray *arrayb = [jsonObjects objectForKey:@"b"];        
    l4.text = [NSString stringWithFormat:@"arrayb count = %d", arrayb.count];

    bTV01.text = jsonString; 

    }; 
```

==================================================== ============================

根对象是具有单个键“a”的 NSDictionary。与该值对应的值是一个 NSArray。该数组包含具有单个键“b”的 NSDictionaries。B NSDictionaries 包含另一个 NSDictionary。

有人可以告诉我代码来显示“Q02”的第三个 B NSDictionary 值吗

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T20:52:04.250

[[[root objectForKey:@"a"] valueForKey:@"b"] objectAtIndex:2]

# algorithm - 图像处理中的反滤镜？

> ID：10404132
> 
> 赞同：2
> 
> 时间：2012-05-01T20:49:10.260
> 
> 标签：algorithm, matlab, image-processing

图像处理中是否有类似反滤镜的东西？

例如，我正在使用以下 13 抽头对称过滤器过滤图像：

{0, 0, 5, -6, -10, 37, 76, 37, -10, -6, 5, 0, 0} / 128

这个过滤过程改变了每个像素。我的问题是我们能否通过对过滤后的图像进行一些数学运算来取回原始图像。

显然，对于平凡的过滤器存在这样的数学运算，例如：

{1, 1} / 2

我们可以将其推广到像我一开始提到的那样复杂的过滤器吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T04:31:20.903

这是指向一种反卷积方法的指针-考虑到在您的情况下我猜您由于舍入错误而产生的噪声-http: [//en.wikipedia.org/wiki/Wiener_deconvolution](http://en.wikipedia.org/wiki/Wiener_deconvolution)

# selenium-rc - 在 Internet Explorer 中运行 selenium 脚本

> ID：10404133
> 
> 赞同：0
> 
> 时间：2012-05-01T20:49:10.683
> 
> 标签：selenium-rc

我目前正在使用 Selenium RC 在 Windows 中的 FF 中运行我的脚本。你能告诉我如何在 IE 中运行脚本吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T11:12:44.423

您的问题不是很清楚，但假设您的意思是使用 Selenium IDE Firefox 插件来创建测试，您会发现[这篇博文很有帮助](http://www.jadeliquid.com/blogs/2011/running-selenium-tests-from-the-command-line.php)。

*   你需要安装java。
*   如果您在 Windows 上，您可能需要以管理员身份运行该命令。

然后以管理员身份运行以下命令

```
java -jar selenium-server-standalone-2.0b3.jar -htmlSuite "*iexplore" 
   "http://www.google.com" "TestSuite.html" 
   "results.html" -port 4445 
```

其中参数`"*iexplore"`指定使用 InternetExplorer。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T06:07:02.450

而不是 `*firefox or *chrome`在你的脚本中使用，使用`*iexplore or *iexploreproxy`

# objective-c - 如何将手动创建的 ViewControllers 链接到 TabBar 应用程序

> ID：10404136
> 
> 赞同：0
> 
> 时间：2012-05-01T20:49:24.267
> 
> 标签：objective-c, ios, xcode, ios5, ios5.1

我用 ARC 创建了一个 tabBar 应用程序。所以默认设置会自动提供 2 个 viewController；

1) FirstViewController.h,FirstViewController.m;FirstViewController_iPhone.xib, FirstViewController_iPad.xib

2) SecondViewController.h、SecondViewController.m、SecondViewController_iPhone.xib、SecondViewController_iPad.xib

我想创建一个新的视图控制器“ViewController3”，但在文件创建过程中，我只能选择为 iPad 或 iPhone 创建（复选框“针对 iPad”）。我需要 iPhone 和 iPad xib，就像为我创建的 FirstViewController 和 SecondViewControllers 一样。所以我决定手动创建 xib 并继续在没有 xibs 的情况下创建文件。

所以很自然地在那之后我继续手动创建 2 个新闻 xib；ThirdViewController_iPhone.xib 和 ThirdViewController_iPad.xib

我将此行添加到原始 AppDelegeate 文件中：

```
UIViewController *viewController1, *viewController2, *viewController3;
if ([[UIDevice currentDevice] userInterfaceIdiom] == UIUserInterfaceIdiomPhone) {
    viewController1 = [[FirstViewController alloc] initWithNibName:@"FirstViewController_iPhone" bundle:nil];
    viewController2 = [[SecondViewController alloc] initWithNibName:@"SecondViewController_iPhone" bundle:nil];
    viewController3 = [[ThirdViewController alloc] initWithNibName:@"ThirdViewController_iPhone" bundle:nil]; 
} else {
    viewController1 = [[FirstViewController alloc] initWithNibName:@"FirstViewController_iPad" bundle:nil];
    viewController2 = [[SecondViewController alloc] initWithNibName:@"SecondViewController_iPad" bundle:nil];
    viewController3 = [[ThirdViewController alloc] initWithNibName:@"ThirdViewController_iPad" bundle:nil];
}
self.tabBarController = [[UITabBarController alloc] init];
self.tabBarController.viewControllers = [NSArray arrayWithObjects:viewController1, viewController2, viewController3, nil]; 
```

然后我运行该项目并得到以下信息：由于未捕获的异常“NSInternalInconsistencyException”而终止应用程序，原因：“-[UIViewController _loadViewFromNibNamed:bundle:] 加载了“ThirdViewController_iPhone”笔尖，但未设置视图出口。

如何设置插座？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-31T09:13:34.990

For your ThirdViewController_iPhone.xib, follow the instruction [here](https://stackoverflow.com/questions/11665113/loaded-the-nib-file-but-the-view-outlet-was-not-set). I think you need to do this step:

> *   You should see "outlets" with "view" under it. Drag the circle next to it over to the "view" icon on the left bar

# dart - 如何在 Dart 中将 UTF-8 字符串转换为字节数组？

> ID：10404147
> 
> 赞同：24
> 
> 时间：2012-05-01T20:49:48.053
> 
> 标签：dart

我正在创建一个 Redis 客户端，并希望创建一个字节数组以发送到 Redis 服务器。要向服务器发出命令，我需要将 Dart 的 UTF-8 字符串转换为可以写入套接字的字节。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2014-01-13T21:15:07.227

对于 Dart >1.0，现在使用转换库完成。

```
import 'dart:convert';
List<int> bytes = utf8.encode("Some data");
print(bytes) //[115, 111, 109, 101, 32, 100, 97, 116, 97] 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-01T22:50:33.797

您需要导入[dart:utf](http://api.dartlang.org/utf.html)并使用其[encodeUtf8](http://api.dartlang.org/utf.html#encodeUtf8)函数。实际上，[这里](https://github.com/financeCoding/redis-dart)有一个现有的 Dart redis 客户端，它利用了这些功能。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2020-12-04T16:09:39.537

对于图像，它们可能是 base64 编码的，请参阅此

[https://stackoverflow.com/a/65146858/4412553](https://stackoverflow.com/a/65146858/4412553)

```
Image.memory(base64.decode('base64EncodedImageString')), 
```

# windows - 为什么 g++ 找不到/链接到 qjpeg4.dll？

> ID：10404148
> 
> 赞同：3
> 
> 时间：2012-05-01T20:49:52.587
> 
> 标签：windows, qt, gcc, linker, mingw

使用 Qt Creator 2.4.1 (Windows/mingw)，我试图编译我的项目，动态链接一些 Qt 图像插件（即 中的插件`C:\QtSDK\Desktop\Qt\4.8.1\mingw\plugins\imageformats\`）。在 .pro 文件中：

`QTPLUGIN += qjpeg qgif qico qtiff`

这是错误：

`g++ -Wl,-s -mthreads -Wl,-subsystem,windows -o release\myproject.exe object_script.myproject.Release -L"c:\QtSDK\Desktop\Qt\4.8.1\mingw\lib" -lmingw32 -lqtmain release\myproject_res.o -L. -lswscale-2 -lavcodec-54 -lavdevice-53 -lavfilter-2 -lavformat-54 -lavutil-51 -lusb -lPsapi -lasa047 -lsphinxbase -lpocketsphinx -LC:\QtSDK\Desktop\Qt\4.8.1\mingw\plugins/imageformats -lqjpeg -lqgif -lqico -lqtiff -lQtMultimedia4 -lQtGui4 -lQtNetwork4 -lQtCore4`

`c:/qtsdk/mingw/bin/../lib/gcc/mingw32/4.4.0/../../../../mingw32/bin/ld.exe: cannot find -lqjpeg`

在上面你可以看到`-LC:\QtSDK\Desktop\Qt\4.8.1\mingw\plugins/imageformats`之前指定的`-lqjpeg`和`C:\QtSDK\Desktop\Qt\4.8.1\mingw\plugins\imageformats\qjpeg4.dll`存在的......那么给出了什么？

附加信息：我可以在 .pro 文件中注释掉该`QTPLUGIN`行并改为：

`LIBS += -LC:\\QtSDK\\Desktop\\Qt\\4.8.1\\mingw\\plugins\\imageformats -l:qjpeg4.dll`

此链接成功，但我更感兴趣的是为什么`QTPLUGIN`在 Windows mingw 下出现开箱即用。我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T18:44:44.010

似乎是 qmake 的一个已知（未解决）错误：[https ://bugreports.qt.io/browse/QTBUG-24177?focusedCommentId=179693#comment-179693](https://bugreports.qt.io/browse/QTBUG-24177?focusedCommentId=179693#comment-179693)

# ruby - 使用 File.open 从 ruby 目录中打开文件

> ID：10404149
> 
> 赞同：5
> 
> 时间：2012-05-01T20:49:53.477
> 
> 标签：ruby, file-io, directory, cgi

我对 Ruby 比较陌生，我正在尝试以如下方式打开文件：

```
#! /usr/bin/env ruby
data_file = '~/path/to/file.txt'
file = File.open(data_file, 'r') 
```

但是我得到“没有这样的文件或目录”（该文件确实存在于该目录中）。如果我将该文件的路径作为命令行参数，它可以工作，例如：

```
#! /usr/bin/env ruby
file = File.open(ARGV[0], 'r') 
```

然后从命令行运行，如：ruby script.cgi ~/path/to/file.txt

任何想法如何让它以第一种方式工作？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-01T20:53:52.417

路径没有扩展，但是当您通过命令行运行它时会扩展。我相信在 unix 系统中，在运行调用之前会扩展路径，这意味着：

```
ruby file.rb ~/path/to/file 
```

实际上扩展为

```
ruby file.rb /home/user/path/to/file 
```

您可以通过在终端中运行以下命令来验证这一点（或创建一个 ruby​​ 文件`p ARGV[0]`并运行它）：

```
echo "p ARGV[0]" | ruby "" ~/path/to/file #/home/user/path/to/file 
```

您可以使用[File.expand_path](http://ruby-doc.org/core-1.9.3/File.html#method-c-expand_path)更改`~`为`/home/user`

```
data_file = '~/path/to/file.txt'
file = File.open(File.expand_path(data_file), 'r') 
```

# xml - 使用 XML::LibXML 解析 XML 的 Perl 脚本；

> ID：10404152
> 
> 赞同：8
> 
> 时间：2012-05-01T20:50:04.330
> 
> 标签：xml, perl, libxml2

我认为这是一个非常简单的问题，但是尽管进行了多次搜索，我还是无法弄清楚。

我正在尝试解析以下 XML 以打印类似于 TAG=VALUE 的内容，以便可以将其写入 CSV 文件。问题是每个样本的标签并不总是相同的。我似乎无法弄清楚如何获得实际的标签名称。任何帮助表示赞赏！

XML 文件 -

```
<Statistics>
  <Stats>
    <Sample>
        <Name>System1</Name>
        <Type>IBM</Type>
        <Memory>2GB</Memory>
        <StartTime>2012-04-26T14:30:01Z</StartTime>
        <EndTime>2012-04-26T14:45:01Z</EndTime>
    </Sample>

    <Sample>
        <Name>System2</Name>
        <Type>Intel</Type>
        <Disks>2</Disks>
        <StartTime>2012-04-26T15:30:01Z</StartTime>
        <EndTime>2012-04-26T15:45:01Z</EndTime>
        <Video>1</Video>
    </Sample>
  </Stats>
</Statistics> 
```

脚本 -

```
#!/usr/bin/perl
use XML::LibXML;

$filename = "data.xml";

my $parser = XML::LibXML->new();
my $xmldoc = $parser->parse_file($filename);

for my $sample ($xmldoc->findnodes('/Statistics/Stats/Sample')) {

print $sample->nodeName(), ": ", $sample->textContent(), "\n";

} 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-01T21:21:59.083

您有获取标签名称的正确方法，您只需要一个额外的循环来遍历每个标签中的标签`<sample>`：

```
#!/usr/bin/perl

use strict;
use warnings;

use XML::LibXML;

my $filename = "data.xml";

my $parser = XML::LibXML->new();
my $xmldoc = $parser->parse_file($filename);

for my $sample ($xmldoc->findnodes('/Statistics/Stats/Sample')) {
    for my $property ($sample->findnodes('./*')) {
        print $property->nodeName(), ": ", $property->textContent(), "\n";
    }
    print "\n";
} 
```

**编辑**：我现在创建了一个名为[Perl XML::LibXML by Example](http://grantm.github.io/perl-libxml-by-example/)的教程站点，它准确地回答了这类问题。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-01T21:25:21.153

您需要遍历示例节点的子节点，

```
for my $sample ( $xmldoc->findnodes('/Statistics/Stats/Sample') ) {
    print $sample->nodeName(), "\n";
    foreach my $child ( $sample->getChildnodes ) {
        if ( $child->nodeType() == XML_ELEMENT_NODE ) {
            print "\t", $child->nodeName(), ":", $child->textContent(), "\n";
        }
    }
} 
```

将会呈现，

```
Sample
        Name:System1
        Type:IBM
        Memory:2GB
        StartTime:2012-04-26T14:30:01Z
        EndTime:2012-04-26T14:45:01Z
Sample
        Name:System2
        Type:Intel
        Disks:2
        StartTime:2012-04-26T15:30:01Z
        EndTime:2012-04-26T15:45:01Z
        Video:1 
```

# qt - qt 中使用 Gstreamer 或 Phonon 或 VLC 播放器的视频播放器

> ID：10404154
> 
> 赞同：0
> 
> 时间：2012-05-01T20:50:10.733
> 
> 标签：qt, opencv, gstreamer, vlc, phonon

现在我无处可去 :( 我想开发一个视频播放器，使用已经在 Visual Studio 平台上运行的检测算法检测人类。我的播放器应该简单地在视频播放器中显示检测。我想使用 QT 框架为此。但问题是我不确定我应该选择哪一个。可以选择使用 Phonon、GStreamer 和 vlc 播放器来达到我的目的，但有人有类似这种东西的真实经验吗？ ?

提前致谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T01:11:01.493

**GStreamer**是一个很棒的跨平台多媒体框架，我用过很多次，包括一些涉及 Qt 的项目。了解 GStreamer 无疑会为您的武器库增加一项出色的技能，但需要一些额外的时间来了解它的设计及其工作原理。

我从来没有使用过**VLC Player**，**Phonon**应该是你最后的选择[，因为](http://en.wikipedia.org/wiki/Phonon_%28KDE%29) [它正在死去](http://colin.guthr.ie/2010/05/qt-multimediamobility-vs-phonon-fight/)。

您可能会考虑的另一个选择是[QtMultimediaKit](http://doc.qt.nokia.com/qtmobility-1.2.0/multimedia.html#video)，它是 Qt Mobility 的一部分。它一直是 Qt，并且可能更容易过渡到您当前的技能集。

# asp.net - 将元标记添加到 ASPX 页面中的标题

> ID：10404158
> 
> 赞同：0
> 
> 时间：2012-05-01T20:50:26.123
> 
> 标签：asp.net, header, meta-tags, literals

```
 protected override void OnLoad(EventArgs e) {
    base.OnLoad(e);
    Literal lTags = new Literal();
    lTags.Text = "<meta name=\"MetaTagsDemo\" content=\"Meta demo tag\" />";
        this.Header.Controls.Add(lTags);
} 
```

我的 default.aspx.cs 中有上述代码。加载 Default.aspx 页面时，我确实看到控件被添加到部分中，但在页面顶部（页面中的第一行），html 显示为“”。

我在这里做错了什么？

我有另一个名为 Browse.aspx 的页面，其中我具有相同的功能，但此页面不显示 html 输出。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T20:55:15.673

您的控件 lTags 是 a `Literal`，但它应该是 a `HtmlMeta`。

如果要使用 a `Literal`，则需要在 Text 属性中包含整个元标记 -

```
lTags.Text = "<meta name=\"MetaTagsDemo\" content=\"Meta demo tag\" />". 
```

否则，使用`HtmlMeta`：

```
HtmlMeta lTags = new HtmlMeta();
lTags.Name = "MetaTagsDemo";
lTags.Content = "Meta demo tags"; 
```

# java - 何时在 Selenium Webdriver 中使用显式等待与隐式等待？

> ID：10404160
> 
> 赞同：58
> 
> 时间：2012-05-01T20:50:33.900
> 
> 标签：java, selenium, selenium-webdriver

我在用：

```
driver.manage().timeouts().implicitlyWait(180, TimeUnit.SECONDS); 
```

但是对于以下元素，它仍然连续失败

```
 driver.findElement(By.id("name")).clear();
    driver.findElement(By.id("name")).sendKeys("Create_title_01"); 
```

我添加了等待代码：

```
for (int second = 0;; second++) {
        if (second >= 120) fail("timeout");
        try { if (isElementPresent(By.id("name"))) break; } catch (Exception e) {}
        Thread.sleep(1000);
    } 
```

隐式等待不应该照顾等待直到找到一个元素吗？如果我使用显式等待而不是我添加的代码会更好`Thread.sleep()`吗？

* * *

## 回答 #1

> 赞同：116
> 
> 时间：2015-01-21T12:40:27.477

TL;DR：始终使用显式等待。忘记存在隐式等待。

* * *

以下是显式等待和隐式等待之间差异的简要说明：

显式等待：

*   记录和定义的行为。
*   在 selenium 的本地部分运行（以您的代码语言）。
*   适用于您能想到的任何条件。
*   返回成功或超时错误。
*   可以将不存在元素定义为成功条件。
*   可以自定义重试和要忽略的异常之间的延迟。

隐式等待：

*   未记录和实际上未定义的行为。
*   在 selenium 的远程部分（控制浏览器的部分）中运行。
*   仅适用于查找元素方法。
*   返回找到的元素或（超时后）未找到的元素。
*   如果检查是否存在元素必须始终等到超时。
*   除全局超时外，无法自定义。

* * *

带有解释的代码示例。第一个隐式等待：

```
WebDriver driver = new FirefoxDriver();
driver.manage().timeouts().implicitlyWait(10, TimeUnit.SECONDS);
driver.get("http://somedomain/url_that_delays_loading");
WebElement myDynamicElement = driver.findElement(By.id("myDynamicElement")); 
```

现在显式等待：

```
WebDriver driver = new FirefoxDriver();
driver.get("http://somedomain/url_that_delays_loading");
WebDriverWait wait = new WebDriverWait(driver, 10);
WebElement myDynamicElement = wait.until(
  ExpectedConditions.presenceOfElementLocated(By.id("myDynamicElement"))); 
```

两个代码示例都做同样的事情。找到某个元素，如果 10 秒后没有找到则放弃。隐式等待只能做到这一点。它只能尝试找到一个超时的元素。显式等待的优势在于它可以等待各种条件。还可以自定义超时并忽略某些异常。

可能条件示例`elementToBeClickable`：`numberOfElementsToBeMoreThan`或`invisibilityOf`。以下是内置预期条件的列表：[https ://seleniumhq.github.io/selenium/docs/api/java/org/openqa/selenium/support/ui/ExpectedConditions.html](https://seleniumhq.github.io/selenium/docs/api/java/org/openqa/selenium/support/ui/ExpectedConditions.html)

更多解释：

隐式等待超时仅对`findElement*`方法有效。如果设置，那么`findElement*`在声明无法找到元素之前，所有人都将“等待”设置的时间。

`findElement*`未定义将如何等待。它取决于浏览器或操作系统或硒的版本。可能的实现是：

*   反复尝试查找元素，直到超时。找到元素后立即返回。
*   尝试找到元素。等到超时。再试一次。
*   等到超时。尝试找到元素。

该列表是从观察和阅读错误报告以及粗略阅读 selenium 源代码中收集的。

* * *

我的结论：隐式等待是不好的。能力是有限的。该行为是未记录的并且依赖于实现。

显式等待可以做所有隐式等待可以做的事情，甚至更多。显式等待的唯一缺点是代码更冗长。但是这种冗长使代码变得明确。显式优于隐式。正确的？

* * *

进一步阅读：

*   [官方文档](http://docs.seleniumhq.org/docs/04_webdriver_advanced.jsp#explicit-and-implicit-waits)（并没有真正解释混合隐式和显式等待的警告之外的问题）。
*   [回答 Jim Evans 的相关问题](https://stackoverflow.com/a/15174978/360899)。Jim Evans 是 selenium 的维护者。总结：不要混合隐式和显式等待。
*   两篇博文详细解释了隐式和显式等待：
    *   [http://vnrtech.blogspot.de/2013/04/selenium-implicit-wait.html](http://vnrtech.blogspot.de/2013/04/selenium-implicit-wait.html)
    *   [http://vnrtech.blogspot.de/2013/04/selenium-explicit-wait.html](http://vnrtech.blogspot.de/2013/04/selenium-explicit-wait.html)
*   [关于 selenium 中隐式和显式等待的](http://code.google.com/p/selenium/issues/list?can=1&q=implicit+explicit+wait)选定错误：
    *   [http://code.google.com/p/selenium/issues/detail?id=2934](http://code.google.com/p/selenium/issues/detail?id=2934)
    *   [http://code.google.com/p/selenium/issues/detail?id=4471](http://code.google.com/p/selenium/issues/detail?id=4471)
    *   [http://code.google.com/p/selenium/issues/detail?id=7972](http://code.google.com/p/selenium/issues/detail?id=7972)
*   代码
    *   [显式等待](https://github.com/SeleniumHQ/selenium/blob/3a221e37eba72ce87d67b039d957038e0154b53f/java/client/src/org/openqa/selenium/support/ui/FluentWait.java#L205)
    *   [隐式等待](https://github.com/SeleniumHQ/selenium/blob/96fec3ca49a1462c7881fcd0c06194cb565bdd2d/java/client/src/org/openqa/selenium/remote/RemoteWebDriver.java#L825)
*   [当我们混合隐式等待和显式等待时会发生什么](http://makeseleniumeasy.com/2017/07/02/part-6-waits-in-selenium-what-happens-when-we-mix-implicit-wait-and-explicit-wait/)
*   [如何在 Selenium 中创建自定义预期条件](https://seleniumjava.com/2017/01/06/how-to-create-custom-expected-conditions-in-selenium/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-12T16:54:55.920

**隐式等待**- 这是适用于所有元素的**全局设置**`NoSuchElementException`，如果元素出现在指定时间之前，则脚本将开始执行，否则脚本将抛出。在设置方法中使用的最佳方式。只会影响`By.findelement()`。

`Thread.sleep()`- 它会为脚本休眠，**不是在脚本中使用的好方法**，因为它是无条件休眠的。如果 5% 的情况下 2 秒不够怎么办？

**显式等待**：等待指定包含/属性更改。当应用程序向系统提供**AJAX**调用并获取动态数据并在 UI 上呈现时，使用更多。在这种情况下`WebDriverWait`是合适的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-03T13:24:21.340

你试过fluentWait吗？一个 Wait 接口的实现，可以动态配置它的超时和轮询间隔。每个 FluentWait 实例定义等待条件的最长时间，以及检查条件的频率。此外，用户可以将等待配置为在等待时忽略特定类型的异常，例如在页面上搜索元素时的 NoSuchElementExceptions。

看到这个链接[流利的等待描述](https://selenium.dev/selenium/docs/api/java/org/openqa/selenium/support/ui/FluentWait.html)

特别是我以这种方式使用了流利的等待：

```
public WebElement fluentWait(final By locator) {
    Wait<WebDriver> wait = new FluentWait<WebDriver>(driver)
        .withTimeout(30, TimeUnit.SECONDS)
        .pollingEvery(5, TimeUnit.SECONDS)
        .ignoring(NoSuchElementException.class);

    WebElement foo = wait.until(
        new Function<WebDriver, WebElement>() {
            public WebElement apply(WebDriver driver) {
                return driver.findElement(locator);
            }
        }
    );

    return foo;          
}; 
```

正如您所注意到的，流畅的等待返回找到的 web 元素。因此，您只需使用 By 类型传递定位器，然后您就可以对找到的 Web 元素执行任何操作。

```
fluentWait(By.id("name")).clear(); 
```

希望这对你有帮助）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-01T21:56:15.077

您是否尝试过使用“ *WebDriverWait* ”？我想你想要的是这样的：

```
WebDriverWait _wait = new WebDriverWait(driver, new TimeSpan(0, 0, 2)); //waits 2 secs max
_wait.Until(d => d.FindElement(By.Id("name")));
//do your business on the element here :) 
```

据我了解，这几乎可以执行您当前的代码。它将不断尝试该方法（同时忽略未找到的异常），直到达到传入的时间跨度的超时，并且可以输入第三个参数以指定以毫秒为单位的睡眠。抱歉，这也是implicitlyWait 所做的！

编辑：我今天做了一些阅读，更好地理解了你的问题，并意识到这正是你的隐式等待设置应该做的。将它留在这里以防万一代码本身可以帮助其他人。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-05-16T18:15:35.537

**隐式等待：**

```
 1\. Static Wait 
    2\. UnConditional Wait (No conditions are given)
    3\. Applicable throughout the program 
```

> 在 java - selenium 中声明隐式等待：

```
driver.manage().timeout().implicitWait(20, TimeUnit.Seconds()); 
```

**何时使用隐式等待？**

不建议在自动化套件中的任何地方使用隐式等待，因为这是静态的，我们不知道 Web 元素何时会在网站中弹出。

IE。假设您设置了 5 秒的隐式等待，并且驱动程序能够在 2 秒内识别 Web 元素，因为我们应用了隐式等待驱动程序将再等待 3 秒（直到 5 秒）。这将减慢自动化进程。

**显式等待：**

1.  动态等待
2.  有条件的等待。
3.  不适用于整个计划

> 在 Java Selenium 中声明显式等待。

```
WebDriverWait wait=new WebDriverWait(driver, 20); wait.until(somecondition); 
```

**何时使用显式等待？**

我们应该始终使用显式等待，因为它本质上是动态的。

IE。假设您设置了 5 秒的显式等待，并且驱动程序能够在 2 秒内识别 Web 元素，因为我们应用了显式等待驱动程序不会再等待 3 秒（直到 5 秒）。驱动程序将在 2 秒后继续。这将加快自动化过程。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-08-18T11:17:26.680

**隐式等待：**

1.  适用于所有 driver.findelement 命令
2.  只关心元素的存在。如果元素是不可见的或不可交互的，那么它不会关心这一点。

**显式等待**

1.  您可以检查存在性、可见性、可交互性和许多其他事情 - 动态等待这些

    WebDriverWait 等待 = new WebDriverWait(driver,Duration.ofSeconds(20)); wait.until(ExpectedConditions.presenceOfElementLocatedBy(By.id("xcxcxc"));

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-03-18T19:44:06.613

在查看了这里的所有答案和评论之后，我用一些代码对它们进行了总结，以测试同时使用隐式和显式等待。

*   仅当您（通常）不需要检查是否缺少元素时才使用隐式等待，例如在一次性网络抓取项目中。

*   切勿将隐式等待和显式等待混合在一起。请参阅[link1](https://stackoverflow.com/a/28067495/6648326)和[link2](http://makeseleniumeasy.com/2017/07/02/part-6-waits-in-selenium-what-happens-when-we-mix-implicit-wait-and-explicit-wait/)。如果您测试是否缺少元素，则等待时间变得不可预测。在下面的代码中，只有有时等待时间 = 隐式等待。您可以通过简单地使用无效定位器来测试是否缺席。

我已经在[link2](http://makeseleniumeasy.com/2017/07/02/part-6-waits-in-selenium-what-happens-when-we-mix-implicit-wait-and-explicit-wait/)中获取了代码并对其进行了重构，使其简短并提供了摘要。该代码显示了同时使用隐式和显式等待时的实际等待时间。

下面的代码转到一个网站并尝试查找有效元素和无效元素。它同时使用隐式和显式等待。在无效元素搜索的情况下，它会尝试隐式/IW 和显式/EW 等待时间的不同组合 - IW = EW、IW > EW 和 IW < EW。

**首先，输出：**

```
WHEN ELEMENT IS FOUND WITHOUT ANY DELAY :
>>> WITH implicit = 30, explicit = 20  :::::  Wait time = 0

WHEN ELEMENT IS NOT FOUND :
a. When implicit wait = explicit wait.
>>> WITH implicit = 10, explicit = 10  :::::  Wait time = 10\. ***WITH EXCEPTION*** : NoSuchElementException

b. When implicit wait > explicit wait.
>>> WITH implicit = 30, explicit = 10  :::::  Wait time = 30\. ***WITH EXCEPTION*** : NoSuchElementException

c. When implicit wait < explicit wait.
>>> WITH implicit = 10, explicit = 30  :::::  Wait time = 10\. ***WITH EXCEPTION*** : NoSuchElementException 
```

**编码：**

```
import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.chrome.ChromeDriver;
import org.openqa.selenium.support.ui.ExpectedConditions;
import org.openqa.selenium.support.ui.WebDriverWait;

import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.TimeZone;
import java.util.concurrent.TimeUnit;

/*
 * Facing this chromedriver error after opening browser - [SEVERE]: Timed out receiving message
 * from renderer: 0.100.
 * */
public class TimeTest {
    static final SimpleDateFormat dateFormat = new SimpleDateFormat("dd-M-yyyy hh:mm:ss a");
    static final String URL = "https://www.redbus.in/";
    static final String TIME_ZONE_NAME = "Europe/Madrid";
    static final By validLoc = By.id("src");
    static final By inValidLoc = By.id("invalid locator");
    static WebDriver driver;

        public static void main(String[] args) {
            dateFormat.setTimeZone(TimeZone.getTimeZone(TIME_ZONE_NAME));

            //>>> Open chrome browser
            System.setProperty("webdriver.chrome.driver", "C:/drivers/chromedriver.exe");
            TimeTest.driver= new ChromeDriver();
            driver.manage().window().maximize();

            //>>> Test waiting logic.

            System.out.println("\n\nWHEN ELEMENT IS FOUND WITHOUT ANY DELAY : ");
            //mixing of implicit wait and explicit wait will not impact on webdriver behavior.
            testWait(30, 20, validLoc, "");

            System.out.println("\n\nWHEN ELEMENT IS NOT FOUND : ");
            //Run the method multiple times. Wait time generally = 10 seconds, but sometimes = 20 seconds.
            testWait(10, 10, inValidLoc, "a. When implicit wait = explicit wait.");

            //Wait time always = implicit wait. Generally ?
            testWait(30, 10, inValidLoc, "b. When implicit wait > explicit wait.");

            //Wait time always = implicit wait. Generally ?
            testWait(10, 30, inValidLoc, "c. When implicit wait < explicit wait.");

            //>>> Close the browser.
            driver.quit();
        }

        public static void testWait(int implicitWait, int explicitWait, By locator, String comment){
            // setting implicit time
            driver.manage().timeouts().implicitlyWait(implicitWait, TimeUnit.SECONDS);

            // Loading a URL
            driver.get(URL);

            // defining explicit wait
            WebDriverWait wait= new WebDriverWait(driver, explicitWait);
            // Locating and typing in From text box.

            Date start = new Date();
            String waitStats = comment + "\n>>> WITH implicit = " + implicitWait + ", explicit = " + explicitWait +
                    "  :::::  " ;//+ "Wait start = " + dateFormat.format(start)

            String exceptionMsg = "";

            try {
                WebElement fromTextBox = wait.until(ExpectedConditions.visibilityOf(driver.findElement(locator)));
            }catch (Exception ex){
                exceptionMsg = ". ***WITH EXCEPTION*** : " + ex.getClass().getSimpleName();
            }

            Date end = new Date();
            //waitStats += ", Wait end = " + dateFormat.format(end)
            waitStats += "Wait time = " +
                    TimeUnit.SECONDS.convert(end.getTime() - start.getTime(), TimeUnit.MILLISECONDS)
                    + exceptionMsg + "\n";

            System.out.println(waitStats);

        }

} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-08-08T06:13:44.417

**隐式等待**用于在整个测试脚本或程序的每个连续测试步骤之间提供等待时间（例如 30 秒）。仅在执行上一步后的 30 秒（或给定的任何时间）后执行下一步

**句法：**

```
WebDriver driver = new FirefoxDriver();
driver.manage().timeouts().implicitlyWait(20, TimeUnit.SECONDS); 
```

**显式等待**用于停止执行，直到满足特定条件或定义的最大时间已经过去。隐式等待已应用于整个测试脚本或程序的每个连续测试步骤之间，而显式等待仅应用于特定实例。

**句法：**

```
WebDriver driver = new FirefoxDriver();
WebDriverWait wait = new WebDriverWait(driver,30); 
```

# php - Joomla 可以处理 jos_users 表中数百万用户的查询吗？

> ID：10404161
> 
> 赞同：0
> 
> 时间：2012-05-01T20:50:37.597
> 
> 标签：php, mysql, joomla

我几乎完成了一个大型网站的开发。

唯一的问题是我总是让 MySQL 消失错误......

[我在stackoverflow](https://stackoverflow.com/questions/10387706/how-resolve-this-error-loading-modulesmysql-server-has-gone-away-for-large-jooml)上发布了另一个问题，但没有得到我的答案

所以我的问题是 Joomla 是否适合大型用户（500 万用户）的 CMS 解决方案？

我花了将近 5 个月的时间来开发这个......现在虽然我在一个 Quad 专用服务器（2 GB 内存）上，但我觉得 Joomla 可能不是这个大型数据库网站的正确解决方案......

编辑：我只是想澄清一下，我不是在谈论交通......它的全新网站。我说的是某些表中的行数

请指教

MySQL 服务器信息：

```
MySQL error log: /var/lib/mysql/eta.etalenthunt.com.err

root@eta [~]# cat /etc/my.cnf
[mysqld]
safe-show-database
open_files_limit = 5000
tmp_table_size = 32M
max_heap_table_size = 32M
query_cache_limit=1M
query_cache_size=100M ## 32MB for every 1GB of RAM
query_cache_type=1
max_connections=100
collation_server=utf8_unicode_ci
character_set_server=utf8
delayed_insert_timeout=40
interactive_timeout=30
wait_timeout=60
connect_timeout=60
thread_cache_size=64
key_buffer=32M ## 32MB for every 1GB of RAM
join_buffer=1M
max_connect_errors=20
max_allowed_packet=16M
table_cache=2048
record_buffer=1M
sort_buffer_size=3M ## 1MB for every 1GB of RAM
read_buffer_size=3M ## 1MB for every 1GB of RAM
read_rnd_buffer_size=3M ## 1MB for every 1GB of RAM
thread_concurrency=8 ## Number of CPUs x 2
myisam_sort_buffer_size=16M
innodb_file_per_table=1
innodb_buffer_pool_size=18M ## (>= 18M) 
```

我正在运行 dedi 服务器 XEON QUAD 2 GB

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-13T13:33:59.780

好的！没问题。您必须意识到这是 Joomla 和 Wordpress 的常见问题（正如我在我对您的另一个问题的其他回答中向您解释的那样：[Joomla 2.5 比 Joomla 1.5 Querywise 快得多](https://stackoverflow.com/questions/10474648/is-joomla-2-5-much-faster-than-joomla-1-5-querywise/10489776#10489776)）

### 由于您在过去的 6 个月里一直在研究它，并且您已经知道它在这个网站背后有一个巨大的数据库，所以我所说的正是可以在 Joomla CMS 的有限范围内为您提供帮助的东西。

我看到这是您在任何 Joomla CMS 中都无法轻松处理的问题！但是有一些方法（在我看来）可以在这里和那里减少一点负载。

您可以按照这两个步骤进行操作，可能还有更多步骤，但让我们先尝试这两个步骤：

**解决方案 #1：将数据库拆分为 2 个或更多数据库**（我将解释如何做到这一点）
**解决方案 #2：Hack Joomla 核心，它会访问用户表和会话表**
**解决方案 #3：将 jos_users 表拆分为相等数量的记录**
**解决方案 #4：写入清理会话表的 cronjob**

### 解决方案＃1：

第 1 步：将您的 jos_users 和 jos_session 表放入两个新的独立数据库中。称它们为 db_jos_user 和 db_jos_session。

第 2 步：从主数据库中删除 jos_users 和 jos_session 表。

第 3 步：为每个视图创建具有各自名称的视图，并使用该数据库名称指向表。

```
CREATE VIEW jos_users AS SELECT * from db_jos_user.jos_users;
CREATE VIEW jos_session AS SELECT * from db_jos_session.jos_session; 
```

这实际上会减少您的数据库大小，并且实际上也会减少数据库的负载。Joomla 不会感到惊讶，它不知道是视图还是它后面的桌子。

### 解决方案＃2：

破解用户身份验证插件并通过创建数据库的新实例（您在以下解决方案中拆分）来验证来自不同数据库的用户。您可以开发一个逻辑来确定要为哪些用户点击哪个表。这样您就可以减少数据库的负载。您可能还必须实现一个逻辑来将用户插入/更新到他们各自的数据库中。这是您必须在核心用户组件和用户登录模块中工作的地方。

### 解决方案＃3：

您可以将表拆分为更多数据库。在您的自定义身份验证模块中，尝试使用“联合”或一个一个地在单个查询中一个一个地访问所有数据库（这样您可能会保存一些数据库命中）。您可以按用户名对它们进行排序，这样当他们登录时，您就会知道要访问哪个数据库。这将大大减少您的点击次数。

### 解决方案＃4：

编写一个 cron 作业，该作业在清理会话表的设定时间间隔内运行。会话表包含属于来宾或用户的所有信息。因此，您必须记住定期清洁它。如果用户会话最多 20 分钟处于非活动状态，您也可以执行此操作，或者您可以删除任何您想要的内容。您可能需要在您的网站上发布通知，告知用户会话是否会自动删除超过 20 分钟的活动或更方便用户使用的内容。

### 结论：

尽管将数据库和一个表特别是分成许多部分时看起来很愚蠢，但实际上这是您这样做的理想时机。它不会花费您太多时间，也不会损害您的 Joomla/数据库。虽然很容易逆转！

我希望所有这些都对你有用。我认为将所有这些一起做没有任何问题，除了它会给您带来工作开销，但实际上当您的数据库中有超过 500 万条记录时它是可以接受的。

我真的很希望这会对你一起做所有这些事情有很大帮助。

# android - 如何在地图上为Android中的源和目的地添加两个标记

> ID：10404172
> 
> 赞同：0
> 
> 时间：2012-05-01T20:51:24.250
> 
> 标签：android, maps, markers

我是 android 编程的新手，我想做的是从两个 EditText 源和目标获取位置并将它们标记在下面的地图上，我可以通过单击按钮从 EditText 在地图上标记一个标记：

这是我的 XML：

```
 <?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

            <LinearLayout
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:orientation="horizontal"
        android:weightSum="100" >

        <EditText
            android:id="@+id/location" 
            android:layout_width="fill_parent"  
            android:layout_height="wrap_content" 
            android:hint="Type Your Address here"
            android:layout_weight="20"
             >
        </EditText>

        <Button
            android:id="@+id/geocodeBtn" 
            android:layout_width="fill_parent"  
            android:layout_height="wrap_content" 
            android:text="Search"
            android:layout_weight="80"
               />
    </LinearLayout>

        <TextView 
            android:id="@+id/position" 
            android:layout_width="fill_parent"  
            android:layout_height="wrap_content" 
            android:text="Latitude/Longitude..." /> 

                <com.google.android.maps.MapView  
        android:id="@+id/geoMap" android:layout_width="fill_parent"  
        android:layout_height="fill_parent" android:clickable="true"  
        android:apiKey="0I0jOn_3OgbSahP7YkXmjc3d6fn2Rwrdepi0noQ" />

        </LinearLayout> 
```

这是类代码：

```
package bijoy.happy;

import java.util.List;

import com.google.android.maps.GeoPoint;
import com.google.android.maps.MapActivity;
import com.google.android.maps.MapView;
import com.google.android.maps.Overlay;

//import android.app.Activity;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.graphics.Canvas;
import android.graphics.Point;
import android.location.Address;
import android.location.Geocoder;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.EditText;
import android.widget.TextView;

public class SearchByAddressActivity extends MapActivity {
    MapView mapView;
    Geocoder geocoder;
    GeoPoint p,qt,pt;

    class MapOverlay extends com.google.android.maps.Overlay
{
    @Override
    public boolean draw(Canvas canvas, MapView mapView, 
    boolean shadow, long when) 
    {
        super.draw(canvas, mapView, shadow);                   

        //---translate the GeoPoint to screen pixels---
        Point screenPts = new Point();
        mapView.getProjection().toPixels(p, screenPts);

        //---add the marker---
        Bitmap bmp = BitmapFactory.decodeResource(
            getResources(), R.drawable.pin);            
        canvas.drawBitmap(bmp, screenPts.x, screenPts.y-50, null);         
        return true;
    }
}//end of class

    @Override 
/** Called when the activity is first created. */
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    mapView = (MapView) findViewById(R.id.geoMap);   
    mapView.setBuiltInZoomControls(true);   
    mapView.setClickable(true);   

    // map starting point   
    int lat = (int) (51.678383 * 1000000);   
    int lng = (int) (19.334822 * 1000000);   
    pt = new GeoPoint(lat, lng); 

    mapView.getController().setZoom(8);   

    mapView.getController().setCenter(pt);  

    Button geoBtn = (Button) findViewById(R.id.geocodeBtn);   

    geocoder = new Geocoder(this);     

    geoBtn.setOnClickListener(new OnClickListener() {   

        public void onClick(View v) {   
            try {   
                EditText locale = (EditText) findViewById(R.id.location);   
                String locationName = locale.getText().toString();   

                List<Address> addressList = geocoder.getFromLocationName(   
                        locationName, 5);   
                if (addressList != null && addressList.size() > 0) {   
                    int lat = (int) (addressList.get(0).getLatitude() * 1e6);   
                    int lng = (int) (addressList.get(0).getLongitude() * 1e6);   

                    TextView pozycja = (TextView) findViewById(R.id.position);   
                    pozycja.setText("lat: "  
                            + addressList.get(0).getLatitude() + " lng: "  
                            + addressList.get(0).getLongitude());   

                    p = new GeoPoint(lat, lng);   
                    mapView.getController().setZoom(18);   
                    mapView.getController().setCenter(p);   

                    //---Add a location marker---
                    MapOverlay mapOverlay = new MapOverlay();
                    List<Overlay> listOfOverlays = mapView.getOverlays();
                    listOfOverlays.clear();
                    listOfOverlays.add(mapOverlay); 

                    mapView.invalidate();

                }   
            } catch (Exception e) {   
                e.printStackTrace();   
            }   
        }   
    });   

}

    @Override
    protected boolean isRouteDisplayed() {
        // TODO Auto-generated method stub
        return false;
    }
} 
```

XML 代码将有 1 个 EditText 和一个用于搜索的按钮。请帮忙。！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T20:54:48.300

以下[链接](http://developer.android.com/resources/tutorials/views/hello-mapview.html)可能对您有所帮助：

# couchdb - 如何删除 CouchDB 中的多个文档？

> ID：10404178
> 
> 赞同：24
> 
> 时间：2012-05-01T20:52:05.630
> 
> 标签：couchdb

我想删除所有`foo`等于*x*的文档。似乎是一个非常基本的操作，但我就是想不通。

我知道如何删除单个文档，但这还不够好——我可能必须一次删除几千个。

如何批量删除 CouchDB 中的文档？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-01T20:58:06.537

我不知道这是否是正确的方法，但创建一个公开该`foo`字段的视图，在视图中查询`doc._id`您要删除的所有文档的 s，并对所有文档进行批量更新。所以两个（理想情况下）打电话到沙发上。

[http://comments.gmane.org/gmane.comp.db.couchdb.user/11222](http://comments.gmane.org/gmane.comp.db.couchdb.user/11222)

有类似的方法。

[按照批量删除文档](http://web.archive.org/web/20111030013313/http://lenaherrmann.net/2009/12/22/bulk-deletion-of-documents-in-couchdb)`doc._deleted=true`中的示例对要删除的所有文档进行批量更新和更新

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-04-03T15:04:12.743

批量删除很容易：[https](https://wiki.apache.org/couchdb/HTTP_Bulk_Document_API) : //wiki.apache.org/couchdb/HTTP_Bulk_Document_API 只需向 _all_docs 发布一个 JSON 列表，如下所示：

```
{"_id": "0", "_rev": "1-62657917", "_deleted": true} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-11-26T16:32:22.073

我还需要一些东西来处理这个问题，因为当时什么都没有，所以我决定自己实现。

你可以在[这里找到它。](https://bitbucket.org/reyalpsirc/couchdbmanager)

# 更新

因为它对我非常有帮助，并且为了保护自己免受错误，我在这个工具中添加了一个备份/恢复功能，现在可以在 0.2 版上找到

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-06-22T08:30:07.423

我尝试了一种有点长的方法来删除文档。我首先创建了一个名为 map_fun 的视图，它调用了我想要删除的文档。然后我遍历视图并存储所有文档的键并使用 del db['_id'] 删除它们

```
map_fun = function(doc){
    if (doc.doc_type == 'classic'){
    emit(doc._id, doc)
    }}

deldoclist = []
for row in db.query(map_fun):
    deldoclist.append(row.key)

for item in deldoclist:
    del db[item] 
```

# iphone - iPhone - 创建像 Xcode 一样的动画

> ID：10404179
> 
> 赞同：0
> 
> 时间：2012-05-01T20:52:16.473
> 
> 标签：iphone, xcode, animation

我想在 iPhone 应用程序中创建一个动画，
这个动画在验证应用程序时看起来像 Xcode 的动画。

你知道怎么做吗？

![验证申请](../Images/2decc3641d1c54ec9d2fd73aec7b6e1d.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T23:19:26.643

这可能是您正在寻找的： [YLProgressBar](https://github.com/YannickL/YLProgressBar)

# python - 在Django中为具有同一个类的两个外键的类构造过滤器

> ID：10404182
> 
> 赞同：1
> 
> 时间：2012-05-01T20:52:34.197
> 
> 标签：python, django, django-models, django-filters

我有一个 Django 模型，同一模型有两个不同的外键。我为每个字段定义了唯一的相关名称。

当我尝试根据这些字段过滤类时会出现问题。

这是我正在研究的模型：

```
class Foo(models.Model):
    f_key1 = models.ForeignKey(Bar, related_name='key_1')
    f_key2 = models.ForeignKey(Bar, related_name='key_2')
    someNumber = models.IntegerField() 
```

这就是我构建过滤器的方式：

```
list = Foo.objects.filter(Q(f_key1=bar1) | Q(f_key2=bar1)).order_by('-someNumber')[:3] 
```

这是我收到的错误消息：

```
int() argument must be a string or a number, not 'ReverseSingleRelatedObjectDescriptor' 
```

我在这里做错了什么？

# c# - 如何确定 Linq 语句中哪个 WHERE 子句为真

> ID：10404185
> 
> 赞同：1
> 
> 时间：2012-05-01T20:52:41.697
> 
> 标签：c#, linq

LINQ 中有没有办法判断哪个 WHERE 子句命中？我有一个名为 Company 的对象，它又可以有多个 BillTo 对象，每个 BillTo 对象可以有多个 Generator 对象。

```
Company
|
+-- BillTo1 - named First
|    |
|    |-- Generator1 - named Alpha
|    |
|    +-- Generator2 - named Beta
|
+-- BillTo2 - named Second
     |
     +-- Generator3 - name Gamma 
```

这是 linq 语句（去掉了其他 where 语句的额外内容）：

```
bool HaveCompany = !string.IsNullOrWhiteSpace(Company);
var AllData = (from co in db.Companies
             join bt in db.Billtoes on co.ID equals bt.CompanyID into bts
             from b in bts.DefaultIfEmpty()
             join gn in db.Generators on b.ID equals gn.BillToID into gns
             from g in gns.DefaultIfEmpty()
             where co.Active == true
             && (
                co.Name.Contains(HaveCompany ? Company : co.Name) ||
                b.Name.Contains(HaveCompany ? Company : b.Name) ||
                g.Name.Contains(HaveCompany ? Company : g.Name)
             )
             select new {
                 CompanyID = co.ID,
                 BillTo = b,
                 Generator = g,
                 Name = co.Name,
             }).ToList(); 
```

问题是，它正确地找到了一切。如果我在 BillTo 上找到“名称”匹配，我真的不需要做“Generator = g”，反之亦然，如果我在 Generator 上找到它，我不需要做“BillTo = b”。

因此，如果有一种方法可以知道命中了哪个 WHERE 子句，那么我会将适当的 b 或 g 添加到结果中。我知道我可以在得到结果并重新检查我实际上作为 WHERE 子句发送的 7 个字段中的每一个之后重申，但这似乎是太多额外的代码。也许我的 LINQ 的调整是为了？是否有我可以通过反射或其他方法提取的值来找出被击中的内容？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T20:57:03.553

你必须决定 - 你想要三个选择分支（实际上`?:`我应该认为它是两个嵌套语句）？还是您想选择一个拥有所有潜在成员的对象？就个人而言，为了避免在您的`select`声明中使用具体类型，或者使用`dynamic`我只是扩展您的匿名类型：

您可以使用只`let`进行`Contains`一次检查，然后在您的`where`子句和匿名类型成员的分配中使用它们：

```
 /* .... */
 let coContains = co.Name.Contains(HaveCompany ? Company : co.Name)
 let bContains = b.Name.Contains(HaveCompany ? Company : b.Name)
 let gContains = g.Name.Contains(HaveCompany ? Company : g.Name)
 where co.Active == true
 && ( coContains || bContains || gContains )
 select new {
   /* sticking the booleans on there as well - might not want to do that */
   CoContains = coContains,
   BContains = bContains,
   GContains = gContains,
   /* other properties as per your code example */
   CompanyID = co.ID,
   BillTo = !gContains && bContains ? b : (BillTo)null,
   Generator = gContains && !bContains ? g : (Generator)null,
   Name = co.Name
 }).ToList(); 
```

所以你仍然返回相同的数据（正如评论所说，你可能实际上并不想要那些额外的布尔值，我只是把它们放在那里，因为它可能会简化你之后运行的任何控制流逻辑）但你只是分配如果布尔值匹配（我认为是）您的标准，则它们。如果不应该读取`BillTo`and`Generator`属性，则它们将是（我在这里假设了类型名称）。`null`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T14:20:34.350

如果您正在辨别满足哪些条件，您可能正在对数据进行分区而不是过滤它。分区是 GroupBy 的工作。然后您可以根据键进行条件组投影。

```
.GroupBy(x =>  x.co.Name.Contains(HaveCompany ? Company : co.Name)  ? 1 :
  x.b.Name.Contains(HaveCompany ? Company : b.Name) ? 2 :
  x.gen.Name.Contains(HaveCompany ? Company : gen.Name) ? 3 :
  0
)
.SelectMany(g =>
g.Key == 1 ? g.Select(x => new {
  CompanyID = x.co.ID,
  BillTo = x.b,
  Generator = x.gen,
  Name = co.Name
} :
g.Key == 2 ? g.Select(x => new {
  CompanyID = co.ID,
  BillTo = b,
  Generator = (Generator) null,
  Name = co.Name
} :
g.Key == 3 ? g.Select(x => new {
  CompanyID = co.ID,
  BillTo = (BillTo) null,
  Generator = gen,
  Name = co.Name
} :
g.Where(x => false)
) 
```

# php - PHP Mail、setlocale 和重音字符

> ID：10404186
> 
> 赞同：2
> 
> 时间：2012-05-01T20:52:45.623
> 
> 标签：php

我在发送保留重音字符的邮件时遇到问题。通过阅读一些页面和以前提出的问题的答案，我能够找到一个可行的解决方案（部分）。

我对以下代码没有问题，它可以正常工作（即我在我使用的电子邮件客户端中看到了重音字符）。它使用 PEAR php 库。但是，此代码仅适用于英语，稍后我将解释。

```
...
$headers['From'] = "info@website.it";
$headers['Subject'] = 'Request';
$headers['Reply-To'] = $sanitized_email; 
$headers["Content-Type"] = 'text/html; charset=UTF-8';
$headers["Content-Transfer-Encoding"]= "8bit";

$host= _CMS_MAIL_SERVER;
$username = "info@website.it";
$password = "pass";

$crlf = "\n";
$mime = new Mail_mime(array('eol' => $crlf));

$html_body = ...;
// read $html_body from file
// substitute some %tags% in $html_body
$mime->setHTMLBody($html_body); 

$mimeparams['text_encoding']="8bit"; 
$mimeparams['text_charset']="UTF-8"; 
$mimeparams['html_charset']="UTF-8"; 
$mimeparams['head_charset']="UTF-8"; 

$mimebody = $mime->get($mimeparams);
$hdrs = $mime->headers($headers);

$smtp = Mail::factory('smtp', array ('host' => $host, 'auth' => true, 'username' =>     $username, 'password' => $password));

$mail_res = $smtp->send($recipients, $hdrs, $mimebody);
... 
```

在 $html_body 中，我有一些需要用时间和日期值替换的标签，由 date 或 strftime(..) 返回。由于默认语言环境是英语，为了获得意大利语日期和时间，我需要在调用 strftime(...) 之前设置语言环境。

如果我添加这一行：

```
setlocale(LC_TIME, "it_IT"); 
```

邮件客户端无法正确显示重音字符。更多细节：strftime 返回的重音字符正确显示（例如lunedì），而通过表单字段提交的重音字符则不正确。

我进行了一些研究以了解如何纠正该错误，但我没有找到任何解决方案。此外，我不清楚 LC_TIME 上的 setlocale 和重音字符之间的关系是什么。

有谁能帮助我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T14:03:37.180

我解决了这个问题。

setlocale(...) 切换字符编码，即使它不需要。

在这种情况下 setlocale(LC_TIME, "it_IT") 从 UTF-8 切换到 ISO-8859-1 并且接收页面使用 UTF-8。

使用 UTF-8 时，设置区域设置的正确方法是：setlocale(LC_TIME, "it_IT.UTF-8")。

很明显，问题与字符编码有关，但是如果使用的编码对于该语言来说是可以的（或者应该吗？），setlocale 不应该更改语言环境。

# iphone - UIButtons 不启用其他按钮

> ID：10404189
> 
> 赞同：2
> 
> 时间：2012-05-01T20:53:01.840
> 
> 标签：iphone, objective-c, xcode, ios5

通过这个板上人们的出色帮助，我几乎为我的学生完成了我的应用程序！我能够在具有上一个和下一个按钮的键盘上显示一个工具栏。然后我让按钮在三个输入字段之间移动。

如果用户从第一个字段开始，他们可以在所有字段之间来回切换，就像我认为如果他们使用 prev/next 按钮一样。但是，如果用户在文本字段 3 上然后单击第一个字段，则按钮将保持原样，然后无法正常工作。

```
-(void)keyboardWillShow:(id)sender{
    if ([inputA isFirstResponder]) {
        [nextButton setEnabled:YES];
        [previousButton setEnabled:NO];
    } else if ([inputB isFirstResponder]) {
        [nextButton setEnabled:YES];
        [previousButton setEnabled:YES];
    } else if ([inputC isFirstResponder]) {
        [nextButton setEnabled:NO];
        [previousButton setEnabled:YES];
    }
} 
```

...循环浏览下一个文本字段

```
-(void)nextField:(id)sender{
    if ([inputA isFirstResponder]) {
        [inputB becomeFirstResponder];
        [previousButton setEnabled:YES];
        [nextButton setEnabled:YES];
    } else if ([inputB isFirstResponder]) {
        [inputC becomeFirstResponder];
        [previousButton setEnabled:YES];
        [nextButton setEnabled:NO];
    } else if ([inputC isFirstResponder]) {
        [inputB becomeFirstResponder];
        [previousButton setEnabled:YES];
        [nextButton setEnabled:YES];
    }
} 
```

...循环浏览以前的文本字段

```
-(void)previousField:(id)sender{
    if ([inputC isFirstResponder]) {
        [inputB becomeFirstResponder];
        [nextButton setEnabled:YES];
        [previousButton setEnabled:YES];
    } else if ([inputB isFirstResponder]) {
        [inputA becomeFirstResponder];
        [nextButton setEnabled:YES];
        [previousButton setEnabled:NO];
    } else if ([inputA isFirstResponder]) {
        [inputB becomeFirstResponder];
        [nextButton setEnabled:YES];
        [previousButton setEnabled:YES];
    }
} 
```

在我的键盘代码中，上一个按钮调用previousField，下一个按钮调用nextField。我想当我做keyboardWillShow时，我将不同的输入设置为第一响应者，但这只是在第一次运行时。

有没有办法让用户点击该字段时成为第一响应者？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T22:44:46.740

至于触发更新，`UITextField`有一个委托方法`-textFieldDidBeginEditing:`，您可以`-setPrevNextButtons`按照@mackworth 的建议使用它来调用。还有其他几种方法可以做类似的事情——有关更多信息，请参阅[相关的委托协议](http://developer.apple.com/library/ios/#DOCUMENTATION/UIKit/Reference/UITextFieldDelegate_Protocol/UITextFieldDelegate/UITextFieldDelegate.html#//apple_ref/occ/intf/UITextFieldDelegate)。

例如，在文本字段的委托中尝试以下控制代码：

```
- (void)textFieldDidBeginEditing:(UITextField *)textField {
    if (textField == inputA || textField == inputB || textField == inputC)
        [self setPrevNextButtons];
} 
```

不用说，您必须为文本字段设置委托才能使其正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T22:29:13.877

我可以建议两件事：首先，干得好：“不要重复自己”。每当您一遍又一遍地看到相同的代码时，请将其移至方法中。其次，您没有指定谁调用keyboardWillShow。检查您的 nib 是否在 EditingDidBegin 时被每个 inputX 调用。所以较短的代码将是：

```
-(void) setPrevNextButtons {  //ensures that Prev/Next buttons are correct for current firstResponder
    if ([inputA isFirstResponder]) {
        [nextButton setEnabled:YES];
        [previousButton setEnabled:NO];
    } else if ([inputB isFirstResponder]) {
        [nextButton setEnabled:YES];
        [previousButton setEnabled:YES];
    } else if ([inputC isFirstResponder]) {
        [nextButton setEnabled:NO];
        [previousButton setEnabled:YES];
    }
}

-(void)keyboardWillShow:(id)sender{
    [self setPrevNextButtons];
}

//goes through the different text fields
-(void)nextField:(id)sender{

    if ([inputA isFirstResponder]) {
        [inputB becomeFirstResponder];
    }else if ([inputB isFirstResponder]) {
        [inputC becomeFirstResponder];
    }    
    [self setPrevNextButtons];
}

-(void)previousField:(id)sender{
    if ([inputC isFirstResponder]) {
        [inputB becomeFirstResponder];
    } else if ([inputB isFirstResponder]) {
        [inputA becomeFirstResponder];
    }
    [self setPrevNextButtons];

} 
```

如果你觉得很棘手，你也可以这样做：

```
-(void) setPrevNextButtons {
    [previousButton setEnabled: [inputB isFirstResponder] || 
                                [inputC isFirstResponder]  ];
    [nextButton setEnabled: [inputA isFirstResponder] || 
                            [inputB isFirstResponder]  ];
} 
```

# php - 我可以只选择 MYSQL 中的一列而不是全部，以使其更快吗？

> ID：10404194
> 
> 赞同：10
> 
> 时间：2012-05-01T20:53:28.547
> 
> 标签：php, mysql

我想做这样的事情：

```
$query=mysql_query("SELECT userid FROM users WHERE username='$username'");
$the_user_id= ..... 
```

因为我想要的只是与用户名对应的用户 ID。

通常的方法是：

```
$query=mysql_query("SELECT * FROM users WHERE username='$username'");
while ($row = mysql_fetch_assoc($query))
    $the_user_id= $row['userid']; 
```

但是有什么比这更有效的吗？非常感谢，问候

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-01T20:55:09.607

你一针见血：你想做的是`SELECT userid FROM users WHERE username='$username'`。试试看 - 它会工作:)

`SELECT *`几乎总是一个坏主意；最好指定您希望 MySQL 返回的列的名称。当然，您仍然需要使用`mysql_fetch_assoc`或类似的东西才能将数据实际放入 PHP 变量中，但至少这可以节省 MySQL 发送所有这些您将不会使用的列的开销。

顺便说一句，您可能想改用更新的 mysqli 库或 PDO。这些也比不推荐使用的旧 mysql 库更有效。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-01T20:56:13.723

不仅可以，而且应该。不幸的是，太多的年轻开发人员养成了选择太多数据的习惯。运行查询后，您无需执行 while 循环，因为您只有一条记录返回。相反，只需使用以下内容：

```
$sql = sprintf( "SELECT userid FROM users WHERE username = '%s'", $username );
$result = mysql_query( $sql ) or die( mysql_error() );
$data = mysql_result( $result, 0 );

if ( $data ) echo $data; // first userid returned 
```

的第二个参数[`mysql_result()`](http://php.net/manual/en/function.mysql-result.php)是您要检索的行索引。0 是第一个。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-01T20:55:27.690

“通常”的方法是**只**选择您需要的列。

任何属于 select 且不需要的列都会减慢检索速度。部分原因是网络流量，部分原因是如果仅选择某些列，数据库引擎可以应用某些优化。

并且`select *`通常在生产代码中不受欢迎。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-05-01T20:55:42.403

您的查询是正确的：

```
$query = mysql_query("SELECT userid FROM users WHERE username='$username'"); 
```

*如果操作正确*，这将起作用。请注意，`$username`必须使用 正确转义`mysql_real_escape_string`。我建议查看参数化查询以降低引入 SQL 注入无懈可击的风险。

您可以更改的另一件事是使用[`mysql_result`](http://php.net/manual/en/function.mysql-result.php)而不是循环：

```
$the_user_id = mysql_result($result, 0); 
```

这假设知道你只会得到一排。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-01T21:12:02.150

是的，这是一个很好的优化实践！

此外，如果您想更进一步并使其超级优化，请尝试添加一个 LIMIT，如下所示：`$query=mysql_query("SELECT userid FROM users WHERE username='$username' LIMIT 1");`

当然，这假设您希望只返回一个用户 ID，并且一旦找到它就会使数据库引擎停止。

但是，最重要的是：**始终转义/清理您的输入数据**！（不能很好地强调这一点）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-05-23T09:16:23.807

你可以用一行代码做到这一点

```
echo array_values(mysqli_fetch_array($mysqli->query("SELECT name FROM user WHERE id='$userid'")))[0]; 
```

在使用此之前，您必须如下所示连接到数据库

```
 $mysqli = new mysqli('HOST', 'USERNAME', 'PASSWORD', 'DATABASE'); 
```

感谢[@samuel t thomas](https://stackoverflow.com/questions/1769337/select-and-echo-a-single-field-from-mysql-db-using-php)

# javascript - 使用 Jasmine 测试夹具的 window.resize

> ID：10404199
> 
> 赞同：1
> 
> 时间：2012-05-01T20:53:44.703
> 
> 标签：javascript, jquery, jasmine, jasmine-jquery

我对单元测试和 Jasmine 相当陌生。我要测试的是查看窗口是否已调整大小，但我不知道该怎么做。

我有使用 jQuery 调整大小的表格，但脚本仅在浏览器调整到一定数量以下时才开始工作。我想对茉莉花做的是检查浏览器窗口的大小是否减小。

我尝试做 $(window).resizeTo(1000,1000) 但这似乎不适用于最新的浏览器？我尝试使用弹出窗口，但这导致了很多问题。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T20:15:32.637

您不能可靠地用于`resizeTo`实际调整窗口大小。

如果您有处理程序，`window.onresize`那么您应该手动调用处理程序来监听测试中的窗口调整大小并使用 jquery-jasmine 来查看您是否满足您的 UI 期望。

作为替代方案，如果您使用modernizr 或简单地测量窗口大小，请使用`spyOn`with`andCallFake`来模拟它们以提供您的自定义大小。

# objective-c - Objective-C：接收“EXC_BAD_ACCESS”信号

> ID：10404203
> 
> 赞同：-1
> 
> 时间：2012-05-01T20:53:56.877
> 
> 标签：objective-c, exc-bad-access

> **可能重复：**
> [尝试获取 iPhone 屏幕尺寸时的 EXC_BAD_ACCESS](https://stackoverflow.com/questions/7710903/exc-bad-access-when-trying-to-get-iphone-screen-dimensions)

我在 Objective-c 中有以下代码片段，它会自动将一些变量设置为多个预设值。但是，在标记的行上，我收到“程序接收信号：EXC_BAD_ACCESS”异常。

让我感到困惑的是，上面的行是相同的，只是值不同。如果第 1 行没有抛出异常，为什么第 2 行应该抛出异常？我能做些什么呢？

提前致谢！

斯特伦

```
- (IBAction)presetPressed:(id)sender {
    if(self.userEnteringNumber) [self enterPressed];

    double xVal;
    double aVal;
    double bVal;
    NSString *preset = [sender currentTitle];
    if ([preset isEqualToString:@"1"]) {
        xVal = 1;
        aVal = 2;
        bVal = 3;
    } else if ([preset isEqualToString:@"2"]) {
        xVal = 1.5;
        aVal = 2.9;
        bVal = 3.0;
    } else if ([preset isEqualToString:@"3"]) {
        xVal = -1;
        aVal = -2;
        bVal = -3;
    }
    [self.variables setValue:[NSNumber numberWithDouble:xVal] forKey:@"x"];
    [self.variables setValue:[NSNumber numberWithDouble:aVal] forKey:@"a"];
    [self.variables setValue:[NSNumber numberWithDouble:bVal] forKey:@"b"];

    self.xVar.text = [NSString stringWithFormat:@"= %@", xVal];
    self.aVar.text = [NSString stringWithFormat:@"= %@", aVal]; //EXC_BAD_ACCESS here
    self.bVar.text = [NSString stringWithFormat:@"= %@", bVal];

    [self calculateResult];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T21:01:32.550

将您的格式字符串替换`@"= %@"`为`@"= %g"`.

您的格式化字符串假设给定的参数值将是一个对象实例 ( `%@`)，但您提供了一个标量双精度值，它不是对象实例而是原始类型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T21:02:00.053

`xVal`, `aVal`,`bVal`都是原始双精度数，但是您的字符串格式正在通过`%@`.

尝试替换`%@`为`%f`（或者`%g`如果您更喜欢科学记数法）：

```
 self.xVar.text = [NSString stringWithFormat:@"= %f", xVal];
    self.aVar.text = [NSString stringWithFormat:@"= %f", aVal];
    self.bVar.text = [NSString stringWithFormat:@"= %f", bVal]; 
```

# ruby-on-rails - gmaps4rails1.5.0-路由

> ID：10404205
> 
> 赞同：1
> 
> 时间：2012-05-01T20:54:08.080
> 
> 标签：ruby-on-rails, ruby-on-rails-3, google-maps, gmaps4rails

无法让 gmaps4rails1.5.0 渲染地图。gmaps4rails1.4.8 昨天运行良好。在 deveopment.rb 中注释掉 config.action_view.debug_rjs=true。需要改变什么才能将地图恢复为渲染？

错误

```
Started GET "/gmaps4rails/gmaps4rails.googlemaps.js" for 127.0.0.1 at 2012-05-01 16:42:10 -0400

ActionController::RoutingError (No route matches "/gmaps4rails/gmaps4rails.googlemaps.js"):

Rendered c:/Ruby192/lib/ruby/gems/1.9.1/gems/actionpack-3.0.10/lib/action_dispatch/middleware/templa
/rescues/routing_error.erb within rescues/layout (1.0ms) 
```

# -------------------------------------------------- -------------------------

```
Started GET "/gmaps4rails/gmaps4rails.base.js" for 127.0.0.1 at 2012-05-01 16:42:10 -0400

ActionController::RoutingError (No route matches "/gmaps4rails/gmaps4rails.base.js"):

Rendered c:/Ruby192/lib/ruby/gems/1.9.1/gems/actionpack-3.0.10/lib/action_dispatch/middleware/templa
/rescues/routing_error.erb within rescues/layout (1.0ms) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T22:59:50.920

v1.5.1 刚刚发布，应该可以修复这个错误。抱歉，感谢您的报告

# ruby - 带有 rvm 的 ubuntu 12.04 上的 ruby 缺少一些 readline 库

> ID：10404206
> 
> 赞同：1
> 
> 时间：2012-05-01T20:54:08.263
> 
> 标签：ruby, ubuntu, rvm, readline

我们正在 ubuntu 12.04 上为 ruby​​ 1.9.3 安装 readline。运行 extconf 时缺少一些文件：

```
$ ruby extconf.rb -- --with-readline-dir="$HOME/.rvm/usr"
checking for tgetnum() in -lncurses... yes
checking for readline/readline.h... yes
checking for readline/history.h... yes
checking for readline() in -lreadline... no
checking for readline() in -ledit... no
checking for editline/readline.h... no 
```

我们如何安装在运行 make install 之前丢失的最后 3 个文件？非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T22:47:50.913

尝试`libreadline5-dev`为您的架构下载包，例如，从[这里](http://packages.ubuntu.com/natty/libreadline5-dev)下载并手动安装。

```
sudo dpkg -i downloaded_package.deb 
```

它应该可以帮助你。

# operating-system - PIC单片机操作系统

> ID：10404208
> 
> 赞同：4
> 
> 时间：2012-05-01T20:54:31.050
> 
> 标签：operating-system, kernel, pic, bootloader, rtos

我听说可以使用内置的引导加载程序和您编写的内核为 PIC 微控制器编写操作系统。我还听说它必须是 RTOS。

1.  这是真的？你真的可以为 PIC 制作一个操作系统内核（使用 C/C++）吗？
2.  如果是 1，有没有这方面的例子？
3.  如果是 1，您是否需要任何类型的软件来创建内核？
4.  Microchip 是唯一一家生产 PIC 微控制器的公司吗？
5.  PIC单片机可以在mac上编程吗？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-02T01:07:45.537

1.  是的，您可以编写自己的内核（我自己编写了 2 个）。是的，您可以用 C 语言为 PIC 编写它。如果你想要先发制人的调度，那么在编写上下文切换时你将很难完全避免组装。另一方面，您可以*很容易地*纯粹用 C 编写一个协作内核（我自己已经这样做了）。（请注意，创建操作系统不是一项简单的任务......我会先用纯 C 语言让你的脚湿透，然后使用一两个操作系统，然后尝试创建一个。）

2.  FreeRTOS 就是一个很好的例子。它具有用于 PIC24F、PIC33F 和 PIC32MX 的预先存在的端口（即在 Explorer16 演示板上无需任何修改即可运行的 MPLAB 项目）（以及用于其他供应商设备的 20 多个其他官方端口）。支持PIC18F，但它并不漂亮......

3.  您只需要 MPLAB 来创建内核（来自 Microchip）。它可以与 C 和汇编互换使用。根据处理器的不同，有免费版本的 C30 和 C32 编译器可与 MPLAB 一起使用。

4.  PIC 是一种微控制器，是 Microchip 的商标。许多其他公司制造微控制器并将其称为其他名称（例如 AVR、LPC、STM32）。

5.  是的，新版本的 MPLAB X 在 Mac、Linux 和 Windows 上受支持。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-01T20:56:42.070

我建议您查看[FreeRTOS](http://www.freertos.org/)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-02T12:29:58.423

我支持 FreeRTOS 的投票；我们一直在 PIC24 设计中使用它。该端口运行良好，并且不使用大量内存。

[Microchip 支持许多第三方 RTOS。](http://www.microchip.com/stellent/idcplg?IdcService=SS_GET_PAGE&nodeId=1406&dDocName=en531543&page=wwwRTOS)

大多数都有免费的演示项目，您可以下载这些项目，在 MPLAB 中构建，并非常轻松地在 Explorer16 板上编程。然后，您可以随心所欲地进行试验。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-08T20:42:57.097

PIC 不是单一架构。PIC10 与 PIC24 有很大不同，尽管它们和它们之间的每个 PIC 都有一些共同点。另一方面，基于 MIPS 的 PIC32 是一个完全不同的架构。所以你必须清楚你指的是什么PIC。

PIC 上的操作系统不一定*是*RTOS，但它非常适合使用设备的应用程序域，因此任何不具备实时能力的东西都会不太有用。

PIC 已经有许多[RTOS 端口。](http://en.wikipedia.org/wiki/Compiler_optimization#Factors_affecting_optimization)

就开发方法而言，内核调度程序没有什么特别之处，C 语言和大多数情况下只需要一个小汇编程序 - 没有特殊工具。如果您愿意，您可以使用 100% 的汇编程序，这可能是获得最小/最快的代码所必需的，但前提是您的汇编程序知识比编译器的知识更好。

PIC 是 Microchip 特有的，尽管[Parallax SX](http://en.wikipedia.org/wiki/Parallax_SX)或多或少是一个克隆。例如，与 ARM 不同，Microchip 不会将该架构授权给第三方芯片制造商或 IP 提供商。在任何情况下，IMO 都不会想要它；有更好的架构。ARM Cortex-M 特别适合 RTOS 内核实现，而 AVR 的指令专为从 C 源代码高效转换而设计。即使是古老的 8051 也非常适合 RTOS 实施；它的八个寄存器组使上下文切换非常快（最多八个线程），并且与 ARM 一样，8051 架构设备可从多个制造商处获得。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-04-22T05:09:20.003

PIC 18F CPU 的硬件栈只有 31 个字节长。其他 RAM 存储器不能用作堆栈。即使是 8051 IRAM 内存也有 128 字节的堆栈。我做过8051、ARM和PIC 18F的RTOS，感觉PIC 18F不太好。如果 PIC32 的 RAM（16K 到 64K）可以作为堆栈使用，如果堆栈指针为 16 位长，将比 PIC18F 类型好得多。有人知道吗？

# javascript - jQuery：每个循环暂停直到完成

> ID：10404209
> 
> 赞同：1
> 
> 时间：2012-05-01T20:54:32.383
> 
> 标签：javascript, jquery, foreach

我有以下 jQuery 循环，但在每个循环动作中我都有用户交互，代码应该等到用户交互完成。是否有可能暂停循环，或者是否有其他可能实现它？

```
jQuery.each([345, 897, 345 /* ... */], function(index, value) {
    // User interaction, need to wait the user finishing/answer

    // Here is a jQuery UI dialog with an input field in it
    // After the user entered their value and hit the submit button
    // which fires an own callback which could also continue the loop somehow?
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T20:59:34.680

您将需要放弃`each`并自己处理。一种选择是这样的：

```
var curIndex = 0;
var ids = [345, 897, 345 /* ... */];

function doNext(){

  // check curIndex here to make sure you haven't completed the list, etc.

  var id = ids[curIndex++];

  // do stuff with this id
}

// THIS IS SOME SORT OF CODE EXECUTED WHEN THE "USER INTERACTION" FINISHES
function interactionDone(){
   doNext();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T21:03:00.047

由于 javascript 是单线程的，因此您可以在每个循环中放置的唯一用户操作是 an`alert`或`confirm`. 如果这些不能满足您的要求，您需要自己处理每个循环。例如：

```
//assume foo = [345, 897, 345 /* ... */]
var i = 0;
function handleNextFoo() {
    i++;
    if(i < foo.length) {
        //Do something with foo[i]
        //now we wait for use action to call the callbackFromUserAction()
    }
}
function callbackFromUserAction() {
    //Handle user action
    handleNextFoo();
} 
```

免责声明：应为您的产品处理命名约定以限定变量并使它们更可用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T21:15:19.020

只需为自己构建一个快速迭代器对象，这样您就可以轻松处理数组。

```
var iterator = function(array) {
    this.array = array;
    this.len = array.length;
    this.index = 0;
    return this;
};

iterator.prototype.next = function(callback) {
    callback.call(null, this.array[this.index]);
    this.index++;
    if (this.index == this.len) this.onend.call(null, this.array);
    return this;
};

iterator.prototype.onend = function() {
    alert('done');
};

var iterate = new iterator(arr);

iterate.next(function(val) {
    console.log(val);
}); 
```

这是一个演示[http://jsfiddle.net/KfrVN/1/](http://jsfiddle.net/KfrVN/1/)

但除此之外，就像 DMoses 指出的那样，只有警报/确认可以停止循环，因为它们是 javascript 用户操作，所以迭代你自己的方式是唯一的方法。

# python - 创建 Twisted TCP 套接字并发送测试值

> ID：10404211
> 
> 赞同：1
> 
> 时间：2012-05-01T20:54:39.453
> 
> 标签：python, twisted, twisted.internet

我正在使用 TCP/IP 协议设置套接字，并且由于我的接收器正在处理`int8u_t`我想知道这种方法是否正确。

在连接时，服务器必须向接收者发送一个值，该值`mode=int(42)`在`def connectionMade(self)`. 但我知道会有一些冲突，因为 python 中的普通 int 是 32 位的，而我的接收器只有 8 位，我可以以某种方式转换它或在 int8u 中创建它吗？

```
from twisted.internet.protocol import Protocol, Factory
from twisted.internet import reactor

class TestSocket(Protocol):
        def connectionMade(self):
                mode=int(42)
                self.factory.clients.append(self)
                self.transport.write(mode)
                print "clients are ", self.factory.clients

        def connectionLost(self, reason):
            self.factory.clients.remove(self)

        def dataReceived(self, data):
                #print "data is ", data
                #a = data.split(':')
                print data
                print "-------------------"

        def message(self, message):
                self.transport.write(message + '\n')

factory = Factory()
factory.protocol = TestSocket()
factory.clients = []

reactor.listenTCP(30002, factory)
print "TestSocket server started"
reactor.run() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T21:02:18.243

您可以使用`numpy`：

```
import numpy
mode = numpy.int8(42)  # int8   Byte (-128 to 127) 
```

`numpy` [您可以在此处](http://docs.scipy.org/doc/numpy/user/basics.types.html)找到有关类型和类型之间转换的更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T21:05:18.087

使用结构

```
from struct import *
mode = pack("h", 42) # 'h' == short 
```

编辑：显然你想要`pack("I", 42)`

# python - 如何保存分层的pyCairo pyGTK图像

> ID：10404216
> 
> 赞同：0
> 
> 时间：2012-05-01T20:55:08.673
> 
> 标签：python, pygtk, pycairo

这是对先前问题的重复，但已澄清。由于我之前没有得到答案，我认为最好在一个新的、更简洁的问题中重新提问。

我成功生成了一个透明窗口。我成功地在窗口内生成了一个红色圆圈的半透明叠加图像。我成功地生成了红色圆圈内的小黑色方块的不透明叠加图像。如何将我在窗口中看到的内容保存到 PNG 文件中。我已经搜索了 stackoverflow、nullege 和 google，但没有成功。

下面代码的最后两行显示了我的失败保存。我可以用什么代码替换它以查看包含我在屏幕上看到的内容的 PNG。

```
import pygtk
pygtk.require('2.0')
import gtk, cairo
from math import pi

# Window setup
window = gtk.Window(gtk.WINDOW_TOPLEVEL)
window.set_decorated(True)
window.set_app_paintable(True)
window.set_colormap(window.get_screen().get_rgba_colormap())
window.realize()
window.show()
window.set_flags(gtk.HAS_FOCUS | gtk.CAN_FOCUS)
window.grab_focus()

# Cairo transparent setup
cr = widget.window.cairo_create()
cr.set_operator(cairo.OPERATOR_CLEAR)
surface = cairo.ImageSurface(cairo.FORMAT_ARGB32, 201, 201)
cr.rectangle(0, 0, 201, 201)
cr.fill()

# Cairo semi-transparent setup
cr.set_operator(cairo.OPERATOR_OVER)
cr.set_source_rgba(0.5, 0.0, 0.0, 0.5)
cr.arc(100, 100, 100, 0, pi*2)
cr.fill()

# Cairo opaque setup
cr.set_operator(cairo.OPERATOR_OVER)
width = 3
r, g, b, a = (0.0,0.0,0.0,1.0)
cr.set_source_rgba(r,g,b,a)
cr.rectangle(-1, -1, 3, 3)
cr.fill()

# Restore default Cairo conditions
cr.set_operator(cairo.OPERATOR_OVER)

# Save layered image to a png image file
with open('layered.png', 'w+') as png:
    surface.write_to_png(png) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T21:21:48.033

看起来您正在渲染图像表面，其中没有任何内容。相反，您应该渲染窗口上下文的表面，这是您进行绘图的地方。试试这个：

```
surface = cr.get_group_target() # get the surface being drawn to the window via your context
surface.write_to_png(png) # write the surface to a file 
```

# silverlight - 我的数据合同有什么问题？

> ID：10404220
> 
> 赞同：2
> 
> 时间：2012-05-01T20:55:19.960
> 
> 标签：silverlight, wcf-ria-services

好的，这是我的 RIA 服务数据合同：

```
public class ZipLocationDC
{
    [Key]
    public String ZipCode { get; set; }

    [Editable(false)]
    public double Latitude { get; set; }

    [Editable(false)]
    public double Longitude { get; set; }
} 
```

我有数百个与此非常相似的其他实体（即，仅具有基本类型属性的简单类）。由于某种原因，有了这个，我得到以下异常：

> 名为“GetZipLocation”的操作不符合所需的签名。返回类型必须是实体或复杂类型、实体或复杂类型的集合或预定义的可序列化类型之一。

我究竟做错了什么？我不知道你为什么需要它，但这是我的服务操作：

```
 [Invoke]
    public ZipLocationDC GetZipLocation(String a_strZipCode)
    {
        var zipCodes = from zipCode in ObjectContext.ZipCodes
                       where zipCode.Code == a_strZipCode
                       select zipCode;

        if (!zipCodes.Any())
            return null;

        var dLatitude = zipCodes.Average(i => i.Latitude);
        var dLongitude = zipCodes.Average(i => i.Longitude);

        return new ZipLocationDC
            {
                ZipCode = a_strZipCode,
                Latitude = dLatitude,
                Longitude = dLongitude
            };
    } 
```

我对 RIA 服务感到非常厌倦。我也直接使用 WCF，但是使用 RIA，我总是遇到类似这样的奇怪问题。它几乎不值得使用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T14:34:13.100

这太愚蠢了，为什么我要尽快切换到 WCF。`ZipLocationDC`作为查询操作的结果，我必须包含我的数据协定 ( )。我只是返回null。我将此代码添加到我的服务定义中。

```
 /// <summary>
    /// This method does nothing but expose ZipLocationDC as an read-only entity.
    /// </summary>
    /// <returns>Null.</returns>
    [Query]
    public IQueryable<ZipLocationDC> GetZipLocations()
    {
        return null;
    } 
```

RIA 服务的限制是如此痛苦。我知道它对你有用，但它更多的是一个问题而不是一个帮手。

# json - 在 conf 文件中从 JSON 配置对象实例

> ID：10404223
> 
> 赞同：0
> 
> 时间：2012-05-01T20:55:31.847
> 
> 标签：json, akka, play2-mini

所以我希望能够基本上从 conf 文件中的 JSON 定义中创建一个类的实例。在查看文档时，我发现有一些方法可以引用 JSON 结构中定义的东西，但我想知道如何最好地从这些定义中实例化对象。例如，假设我有一个名为 RemoteRepository 的类，它有 4 或 5 个属性。我想在 JSON 文件中创建一堆条目，然后在启动时读入并取回 RemoteRepository 对象的集合。当然，我可以用一个数据库来做这个，包括一个图表，但如果可能的话，我想只做 JSON。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T04:01:50.100

假设代表 JSON 结构的静态类定义是可以接受的，你可以试试[JSON C# Class Generator](http://jsonclassgenerator.codeplex.com/)

生成类后，您可以通过将 json 传递给此工具在生成的类上创建的构造函数来简单地创建一个新实例或实例数组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T11:34:45.443

所以我可以创建实例，但是像往常一样，一旦我需要一堆实例，就该创建数据库了。在这种情况下，我最终做了一些简单的 XML 文件来触发这些实例。尽管 XML 很混乱，但对于这样的事情，它确实工作得最好。即：

*   实例信息的一些嵌套
*   不是到目标类的精确映射，例如字段映射是我配置的一部分。我将从配置文件中加载一些字段，然后创建不同类的实例，因此从 JSON 获得的立即转换为 java 类没有意义

我在这样做时发现的另一件事是，在 Java 中处理 XML 仍然是一团糟。不过，在这种情况下，这是正确的方法。

# r - 如何从 data.frame 中删除一行而不丢失属性

> ID：10404224
> 
> 赞同：21
> 
> 时间：2012-05-01T20:55:32.417
> 
> 标签：r, statistics

对于初学者：我现在在这个问题上搜索了几个小时 - 所以如果答案应该是微不足道的，请原谅我......

我想要做的是从 data.frame 中删除一行（第 101 号）。它包含测试数据，不应出现在我的分析中。我的问题是：每当我从 data.frame 中提取子集时，属性（尤其是评论）都会丢失。

```
str(x)
# x has comments for each variable
x <- x[1:100,]
str(x)
# now x has lost all comments 
```

有据可查的是，子集将删除所有属性-到目前为止，这非常清楚。该手册（例如[http://stat.ethz.ch/R-manual/R-devel/library/base/html/Extract.data.frame.html](http://stat.ethz.ch/R-manual/R-devel/library/base/html/Extract.data.frame.html)）甚至提出了一种保留属性的方法：

```
## keeping special attributes: use a class with a
## "as.data.frame" and "[" method:

as.data.frame.avector <- as.data.frame.vector

`[.avector` <- function(x,i,...) {
  r <- NextMethod("[")
  mostattributes(r) <- attributes(x)
  r
}

d <- data.frame(i= 0:7, f= gl(2,4),
                u= structure(11:18, unit = "kg", class="avector"))
str(d[2:4, -1]) # 'u' keeps its "unit" 
```

我还没有深入了解 R 以了解这里到底发生了什么。但是，简单地运行这些行（最后三行除外）不会改变我的子集的行为。使用带有适当向量的命令子集（）（100 次 TRUE + 1 FALSE）给了我相同的结果。并且简单地将属性存储到一个变量并在子集之后恢复它，也不起作用。

```
# Does not work...
tmp <- attributes(x)
x <- x[1:100,]
attributes(x) <- tmp 
```

当然，我可以将所有评论写入向量（var=>comment）、子集并使用循环将它们写回——但这似乎不是一个有根据的解决方案。而且我很确定我会在未来的分析中遇到具有其他相关属性的数据集。

所以这就是我在stackoverflow、谷歌和脑力方面的努力陷入困境的地方。如果有人可以帮助我提示，我将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-01T21:29:13.067

如果我理解正确，您在 data.frame 中有一些数据，并且 data.frame 的列有与之关联的注释。也许像下面这样？

```
set.seed(1)

mydf<-data.frame(aa=rpois(100,4),bb=sample(LETTERS[1:5],
  100,replace=TRUE))

comment(mydf$aa)<-"Don't drop me!"
comment(mydf$bb)<-"Me either!" 
```

所以这会给你类似的东西

```
> str(mydf)
'data.frame':   100 obs. of  2 variables:
 $ aa: atomic  3 3 4 7 2 7 7 5 5 1 ...
  ..- attr(*, "comment")= chr "Don't drop me!"
 $ bb: Factor w/ 5 levels "A","B","C","D",..: 4 2 2 5 4 2 1 3 5 3 ...
  ..- attr(*, "comment")= chr "Me either!" 
```

当您对此进行子集化时，评论将被删除：

```
> str(mydf[1:2,]) # comment dropped.
'data.frame':   2 obs. of  2 variables:
 $ aa: num  3 3
 $ bb: Factor w/ 5 levels "A","B","C","D",..: 4 2 
```

要保留注释，请定义函数`[.avector`，就像您在上面所做的那样（从文档中），然后将适当的类属性添加到 data.frame 中的每个列（**编辑**：要保持因子级别`bb`，添加`"factor"`到`bb`. ):

```
mydf$aa<-structure(mydf$aa, class="avector")
mydf$bb<-structure(mydf$bb, class=c("avector","factor")) 
```

以便保留评论：

```
> str(mydf[1:2,])
'data.frame':   2 obs. of  2 variables:
 $ aa:Class 'avector'  atomic [1:2] 3 3
  .. ..- attr(*, "comment")= chr "Don't drop me!"
 $ bb: Factor w/ 5 levels "A","B","C","D",..: 4 2
  ..- attr(*, "comment")= chr "Me either!" 
```

**编辑：**

如果您的 data.frame 中有许多列具有您要保留的属性，您可以使用`lapply`（**EDITED**以包含原始列类）：

```
mydf2 <- data.frame( lapply( mydf, function(x) {
  structure( x, class = c("avector", class(x) ) )
} ) ) 
```

但是，这会删除与 data.frame 本身相关的注释（例如`comment(mydf)<-"I'm a data.frame"`），因此如果有的话，请将它们分配给新的 data.frame：

```
comment(mydf2)<-comment(mydf) 
```

然后你有

```
> str(mydf2[1:2,])
'data.frame':   2 obs. of  2 variables:
 $ aa:Classes 'avector', 'numeric'  atomic [1:2] 3 3
  .. ..- attr(*, "comment")= chr "Don't drop me!"
 $ bb: Factor w/ 5 levels "A","B","C","D",..: 4 2
  ..- attr(*, "comment")= chr "Me either!"
 - attr(*, "comment")= chr "I'm a data.frame" 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-02T19:02:36.437

对于那些根据 BenBarnes 的解释寻找“全押”解决方案的人：就是这样。

（如果这对您有用，请将您的“up”交给 BenBarnes 的帖子）

```
# Define the avector-subselection method (from the manual)
as.data.frame.avector <- as.data.frame.vector
`[.avector` <- function(x,i,...) {
  r <- NextMethod("[")
  mostattributes(r) <- attributes(x)
  r
}

# Assign each column in the data.frame the (additional) class avector
# Note that this will "lose" the data.frame's attributes, therefore write to a copy
df2 <- data.frame(
  lapply(df, function(x) {
    structure( x, class = c("avector", class(x) ) )
  } )
)

# Finally copy the attribute for the original data.frame if necessary
mostattributes(df2) <- attributes(df)

# Now subselects work without losing attributes :)
df2 <- df2[1:100,]
str(df2) 
```

好消息：当将类附加到所有 data.frame 的元素一次时，子选择不再打扰属性。

好的 - 有时我很惊讶在 R 中执行最简单的操作是多么复杂。但如果我只是在 SPSS 中标记并删除了案例，我肯定没有了解“类”功能；）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-10-19T13:47:47.173

这是通过`sticky`包解决的。（完全披露：我是包作者。）将`sticky()`应用于您的向量，并通过子集操作保留属性。例如：

```
> df <- data.frame( 
+   sticky   = sticky( structure(1:5, comment="sticky attribute") ),
+   nonstick = structure( letters[1:5], comment="non-sticky attribute" )
+ )
> 
> comment(df[1:3, "nonstick"])
NULL
> comment(df[1:3, "sticky"])
[1] "sticky attribute" 
```

这适用于任何属性，而不仅仅是`comment`.

详情见`sticky`包装：

*   [在 Github 上](https://github.com/decisionpatterns/sticky)
*   [在 CRAN 上](https://CRAN.R-project.org/package=sticky)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-04-20T21:11:53.027

我花了几个小时试图弄清楚如何在子集数据框（删除列）时保留属性数据（特别是变量标签）。答案太简单了，我简直不敢相信。只需使用 Hmisc 包中的函数 spss.get ，然后无论您如何子集，变量标签都会保留。

# maven - 如何解释依赖路径？

> ID：10404226
> 
> 赞同：2
> 
> 时间：2012-05-01T20:55:48.107
> 
> 标签：maven, jar, dependency-management

我收到以下错误。“依赖路径”指的是什么，为什么有 3 个位置？

我几乎没有 Maven 经验。

```
Missing:
----------
1) com.sun.jmx:jmxri:jar:1.2.1

  Try downloading the file manually from the project website.

  Then, install it using the command:
      mvn install:install-file -DgroupId=com.sun.jmx -DartifactId=jmxri -Dversion=1.2.1 -Dpackaging=jar -Dfile=/path/to/file

  Alternatively, if you host your own repository you can deploy the file there:
      mvn deploy:deploy-file -DgroupId=com.sun.jmx -DartifactId=jmxri -Dversion=1.2.1 -Dpackaging=jar -Dfile=/path/to/file -Durl=[url] -DrepositoryId=[id]

  Path to dependency:
        1) com.services:Common:jar:1.0.0.0
        2) log4j:log4j:jar:1.2.15
        3) com.sun.jmx:jmxri:jar:1.2.1 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T21:02:27.520

常见需要 Log4J。Log4J 需要 JMX。存在三个“位置”，因为这就是依赖路径的长度。依赖是路径（或多或少）“是什么让我想要这个库？”

（但它没有；升级或降级您的 Log4J 依赖项——IIRC 这已在 1.2.16 中修复，并且在 1.2.mumble 之前不存在。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T21:05:48.293

这个依赖路径类似于异常的堆栈跟踪。它说明了哪些依赖项的传递导致错误。实际上，Log4j 案例在某种程度上是特定的。他们在 1.2.15 版本中搞砸了它的依赖关系，实际上需要的比它真正需要的要多得多。老实说，您能做的最好的事情就是使用 1.2.16 版本，该版本可传递地依赖于确实需要的库。

`jmxri`起源于 Sun 的 Java 时代的工件存在许可问题。这就是为什么到目前为止这些东西在公共 Maven 存储库中不可用的原因。

# php - IE7 中的 Twitter 共享弹出窗口未正确编码智能引号

> ID：10404227
> 
> 赞同：2
> 
> 时间：2012-05-01T20:55:56.777
> 
> 标签：php, wordpress, internet-explorer, encoding, smart-quotes

我正在构建一个 Wordpress 主题，其中每个帖子旁边都有一个 twitter 分享链接

```
<a class="tw-share-link" href="http://twitter.com/home?status=Currently reading <?php             the_article_title() ?>" Target="_blank">Tweet</a> 
```

如果文章标题包含智能引号，则在 IE8 及以下版本中，引号将替换为 '?'。

我尝试将智能引号转换为常规引号，将使用字符串替换的函数挂钩到保存或更新帖子的操作。这并没有解决问题。

```
?php
function convert_smart_quotes($string) {
    //converts smart quotes to normal quotes.
    $search = array(chr(145), chr(146), chr(147), chr(148), chr(151));
    $replace = array("'", "'", '"', '"', '-');
    return str_replace($search, $replace, $string);
}
?> 
```

我需要解决此问题的指导： + 我是否需要在我的代码中添加某种字符集声明，以便 IE8 及以下版本可以处理智能引号？+ 或者在 php 中是否有一种方法可以对 twitter 链接进行编码，以便将智能引号替换为常规引号？提前致谢。

**更新：** 我找到了解决办法。删除 wptexturize 过滤器可以解决问题： http: [//www.malcolmcoles.co.uk/blog/wordpress-smart-quotes/](http://www.malcolmcoles.co.uk/blog/wordpress-smart-quotes/)

# facebook - 流表上的 FQL 查询使用 created_time 返回空

> ID：10404229
> 
> 赞同：2
> 
> 时间：2012-05-01T20:56:07.467
> 
> 标签：facebook, facebook-graph-api, facebook-fql

我对流表有一个 FQL 查询，如下所示

```
SELECT post_id FROM stream WHERE filter_key ='nf' AND created_time < 1335500000 
```

`filter_key`抓取新闻提要的地方。此查询不返回任何数据（对于我的帐户）

其中，此查询（使用 2012 年 4 月 30 日设置的 unix）

```
SELECT post_id FROM stream WHERE filter_key ='nf' AND created_time < 1335758400 
```

返回数据。

我可以继续将 unix 时间推回到某个点，直到它停止显示数据，但那里有数据来自通过 Facebook UI 手动浏览我的新闻提要。

文档[`stream`](https://developers.facebook.com/docs/reference/fql/stream/)状态

> 流表的每次查询仅限于前 30 天或 50 个帖子，以较大者为准，但是您可以使用特定于时间的字段，例如`created_time`与 FQL 运算符（例如 < 或 >）一起检索更大范围的帖子.

所以对我来说，这意味着我可以使用 created_time 和 limit 进行“分页”。

事实并非如此。

即使使用替代方法[`/me/home`](https://developers.facebook.com/docs/reference/api/user/#home)返回第一组但是当我使用分页链接时没有返回数据。

我在这里想念什么吗？或许可以解释一下为什么 FQL 和 Graph API 调用之前的数据都是空的？

# jquery - ImageMapster：如何同步两个图像映射？

> ID：10404231
> 
> 赞同：2
> 
> 时间：2012-05-01T20:56:17.883
> 
> 标签：jquery, imagemap, synchronize, imagemapster

我在页面上有两个相同图像映射的副本。它们有不同的 ID，使用相同的图像文件和地图信息。

现在只有第二张地图可以正常工作，如果我突出显示\单击第一张地图 - 更改仅适用于第二张地图，而不适用于它们。

**我需要两个图像地图同步工作：因此，当您移动鼠标\单击其中一个地图时，突出显示和选择将同时在它们两个上工作。**

我怎样才能做到这一点？

我页面顶部的代码：

```
<script src="jquery-1.6.2.min.js" type="text/javascript"></script>
<script src="jquery.imagemapster.min.js" type="text/javascript"></script>

<script type="text/javascript">
$(document).ready(function() {

    function state_change(data) {   }

    $("#map_mini,#map_full").mapster({
        singleSelect: true,
        isDeselectable: false,

        fill: true,
        fillColor: 'ff0000',
        fillOpacity: 0.5,       

    //  onStateChange: state_change,
    });
});
</script> 
```

我的页面正文中的代码：

```
<map name="map">
  <area shape="rect" group="rect" alt="" coords="25,38,102,104" href="#" /-->
  <area shape="circle" group="circle" alt="" coords="185,160,30" href="#" /-->
  <area shape="poly" group="poly" alt="" coords="230,62,237,25,276,20,291,55,264,80,230,62" href="#" /-->
</map> 

<h1>MAP1</h1>
<img src='map.png' width='320' height='240' id='map_full' usemap="#map">
<h1>MAP2</h1>
<img src='map.png' width='320' height='240' id='map_mini' usemap="#map"> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T11:48:54.887

这并不难，但有几点需要注意。工作示例在这里：

[http://jsfiddle.net/gCTcF/](http://jsfiddle.net/gCTcF/)

**更新：**原始示例仅适用于一种方式，此示例适用于两种方式，最后讨论。

[http://jsfiddle.net/UrNsH/](http://jsfiddle.net/UrNsH/)

1）您不能将两个图像绑定到同一个图像映射，因为 ImageMapster 将区域视为唯一标识符。所以只需制作一个副本并将第二个图像绑定到副本：

```
var map = $('map[name="map"]'),
    clone = map.clone().attr('name', 'map2'),
    image2 = $('#map_mini');

map.after(clone);
image2.attr('usemap', '#map2'); 
```

2) 你的方向是对的，你需要用来`stateChange`同步地图。从该事件发送的数据并不能完全转换为您需要在另一个地图上调用的代码，因此请使用一些逻辑来根据事件进行正确的调用：

```
function state_change(data) {
    if (data.state=='highlight')
    {   
        // add or remove a highlight to the alternate image. the syntax to add vs.
        // remove a highlight is a little different (you don't need to specify where
        // you're removing - there can be only one highlight) so easiest to use two
        // different statements for add vs. remove.

        if (data.selected) {
            image2.mapster('highlight',data.key,true);
        } else {
            image2.mapster('highlight',false);
        }

    } else if (data.state=='select') {

         // add or remove the "selected" state to the alternate image.
         // the syntax is the same to add and remove (unlike highlight) so you
         // just need one statement.

         image2.mapster('set', 
                   data.selected,
                       data.key);
    }
} 
```

3) 创建两个地图将共享的选项的变量，并使用`stateChange`控制另一个地图的事件扩展它。这将进行单向同步。如果您希望它以两种方式同步，则需要复制 stateChange 函数，或者添加一个参数，以便它知道应该对哪个映射进行操作。（如果您只是将两个映射绑定到同一个事件，则在从它所针对的同一个映射执行操作时会导致无限循环）。

```
var options = {
    singleSelect: true,
    isDeselectable: false,

    fill: true,
    fillColor: 'ff0000',
    fillOpacity: 0.5
};
$('#map_mini').mapster(options);
$("#map_full").mapster(
$.extend({}, options, {
    onStateChange: state_change
})); 
```

希望有帮助。

**更新：**

为了让它像您发现的那样双向工作，您必须防止递归。

更新示例：http: [//jsfiddle.net/UrNsH/](http://jsfiddle.net/UrNsH/)

首先，在开头创建对两个图像的引用：

```
var image1 = $('#map_full'),image2 = $('#map_mini'); 
```

在`state_change`函数中，使用一个标志来表示代码当前处于改变状态的过程中。这样，当`state_change`由于它自己的动作而再次触发时，它将知道不会启动另一个事件。这非常简单：在函数*外部*创建一个变量以用作标志。您要做的第一件事是检查您当前是否正在“改变”，如果是，请退出。如果不是，请在开始对第二张图像执行操作之前将“更改”标记为真。

现在发生的另一件事是您需要弄清楚要对哪个图像采取行动。*这个逻辑很简单：它不是*鼠标事件的来源。您只需要检查`this`哪个是图像本身并选择不是的图像`this`。

你会注意到我在`this`比较`image1[0]`. 这是 jQuery 经常出现的问题。`this`是一个实际的 DOM 元素，而`image1`和`image2`是 jQuery 对象。jQuery 对象是类[数组的](https://stackoverflow.com/questions/6599071/array-like-objects-in-javascript)。因此，要访问作为选择器一部分的实际 DOM 元素，您必须使用索引。`image1[0]`是 的第一个（也是唯一的）成员，并且当第一张图像是事件源时`image1`将匹配。`this`

```
var changing = false;

function state_change(data) {

    // prevent recursion: exit if already inside this function  

    if (changing) return;

    // set the flag that work is in progress so if something calls this while 
    // we're busy syncing, it won't try to start again (creating endless recursion)

    changing = true;

    // switch the image that's not this one.

    var target = this===image1[0] ? 
                     image2 : 
                     image1;

    // this part is the same as before

    if (data.state=='highlight'){
        if (data.selected) {
            target.mapster('highlight',data.key,true);
        } else {
            target.mapster('highlight',false);
        }
    } else if (data.state=='select') {
         target.mapster('set', data.selected, data.key);
    }

    changing=false;
} 
```

应该这样做！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-04T22:35:44.360

（这里是关于双向同步问题的通知。这个通知没有更多的理由，jamietre更新他的unswer后，所以我删除了它）

# objective-c - 在有限的输入因子下从黑色变为绿色

> ID：10404238
> 
> 赞同：1
> 
> 时间：2012-05-01T20:57:04.050
> 
> 标签：objective-c, algorithm, math, colors

如何制作一种从 0-50 接收浮点数并发出强度均匀的绿色的方法？

因此，如果输入值为 0，则颜色为黑色：

```
[UIColor colorWithRed:0 green:0 blue:0]; 
```

如果输入值为 50，则颜色为最大绿色：

```
[UIColor colorWithRed:0 green:255.0/255.0 blue:0]; 
```

所以如果输入因子在中间的某个地方，那么颜色应该在中间的某个地方。所以从 0 到 50，它应该从最深的绿色变为最浅的绿色。应该很简单，但我不确定我错过了什么：

```
//factor is a float from 0-50
UIColor *greenColor = [UIColor colorWithRed:0 green:factor/255.0 blue:0 alpha:1.0]; 
```

此代码生成绿色，但波动不大，因此您只能看到大约一种绿色。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T21:04:05.997

您需要根据自己的最大值 (50) 缩放 RGB 最大值 (255)。你所需要的只是相当简单的数学：

```
colorVal = 255 * x / 50 
```

哪里`x`是从 0 到 50 范围内的强度。所以：

```
255 * 0  / 50 = 0 
255 * 50 / 50 = 255
255 * 25 / 50 = 128 (rounded up from 127.5) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T21:05:16.620

你的范围只是从`0.0/255.0 -> 50.0/255.0`，你希望它是`0.0 to 1.0`；为此，您可以尝试`factor/50.0`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T21:09:16.063

一方面，你让数学变得太难了。看起来`[UIColor ... green: ...]`值应该在 0.0 到 1.0 的范围内，所以值计算可以简单地是：

```
CGFLoat value = factor / 50.0;
UIColor *greenColor = [UIColor colorWithRed:0 green:(value) blue:0 alpha:1] 
```

这将给出 0.0 when`factor = 0`和 1.0 when的值`factor = 50`。

不过，除此之外，我不确定——也许这幅画实际上做了一些量化或使用有限的调色板？

# build - 如何告诉 premake 生成使用 clang 的 Makefile？

> ID：10404239
> 
> 赞同：6
> 
> 时间：2012-05-01T20:57:07.890
> 
> 标签：build, makefile, premake

我想在生成 Makefile（gmake 工具链）时使用 clang 构建我的应用程序。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-11-19T03:41:35.580

这是我使用的，它对我有用：

```
--  ugly hack to use clang
premake.gcc.cc  = 'clang'
premake.gcc.cxx = 'clang++' 
```

似乎没有其他任何工作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-12-13T13:07:30.117

在 premake5 上，使用

```
#!/bin/bash
premake-5.0.0-alpha11-linux --file=PA7.lua --cc=clang --verbose gmake 
```

`--cc=clang`类似于 premake4 中的 --platform 选项。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-25T12:06:32.810

我最终做了@Burton Samograd 所做的事情：分配 CC 环境变量。然而，深埋在 premake4 留言板中，他们确实有办法[定义一个新平台](http://industriousone.com/topic/newplatform)。

使用 premake4 时，只需调用：

```
premake4 --platform=clang gmake 
```

我发现的唯一问题是它没有按我的预期工作。我将投票给伯顿，但如果你想要的话，信息就在这里。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-01T21:30:17.157

看起来您可以只设置 CC 变量：

```
CC ?= /usr/bin/clang 
```

在你的预制文件中。?= 仅在您尚未在环境中设置时才设置它。

# ruby - 如何在哈希值上使用 Time 类？

> ID：10404241
> 
> 赞同：0
> 
> 时间：2012-05-01T20:57:13.457
> 
> 标签：ruby, hash

我正在阅读 Chris Pine 的 Ruby 书，我有点困惑为什么我的代码不能正常工作。

我有一个名为的文件`birthdays.txt`，其中包含大约 10 行文本，类似于：

```
Andy Rogers, 1987, 02, 03 
```

等等

我的代码如下：

```
hash = {}

File.open('birthdays.txt', "r+").each_line do |line|
  name, date = line.chomp.split( /, */, 2 )
  hash[name] = date
end

puts 'whose birthday would you like to know?'

name = gets.chomp
puts hash[name]                                    
puts Time.local(hash[name]) 
```

我的问题是，为什么最后一行代码`Time.local(hash[name])`会产生这个输出？：

```
1987-01-01 00:00:00 +0000 
```

代替：

```
1987-02-03 00:00:00 +0000 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T21:17:17.660

如果您查看[Time.local](http://www.ruby-doc.org/core-1.9.3/Time.html#method-c-local)的文档，

Time.local 不解析字符串。它希望您为年、月和日期传递一个单独的参数。当您传递像“1987,02,03”这样的字符串时，它会将其作为单个参数，即年份。然后它尝试将该字符串强制转换为整数 - 在本例中为 1982。

所以，基本上，你想把那个字符串分成年、月和日。有多种方法可以做到这一点。这是一个（可以缩短，但这是最清晰的方法）

```
year, month, date = date.split(/, */).map {|x| x.to_i}
Time.local(year, month, date) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-05T13:33:40.317

```
hash = {}

File.open('birthdays.txt').each_line do |line|
  line = line.chomp
  name, date = line.split(',',2)
  year, month, day = date.split(/, */).map {|x| x.to_i}
  hash[name] = Time.local(year, month, day)
end

puts 'Whose birthday and age do you want to find out?'
name = gets.chomp

    if hash[name] == nil
       puts ' Ummmmmmmm, dont know that one'
    else
       age_secs = Time.new - hash[name]
       age_in_years = (age_secs/60/60/24/365 + 1)

  t = hash[name]
  t.strftime("%m/%d/%y")
  puts "#{name}, will be, #{age_in_years.to_i} on #{t.strftime("%m/%d/")}"
end 
```

不得不在程序中更早地移动 Time.local 调用，然后宾果游戏，干杯！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T21:30:04.833

```
line = "Andy Rogers, 1987, 02, 03\n"
name, date = line.chomp.split( /, */, 2 ) #split (', ', 2) is less complex.
#(Skipping the hash stuff; it's fine)
p date #=>          "1987, 02, 03"
# Time class can't handle one string, it wants: "1987", "02", "03"
# so: 
year, month, day = date.split(', ')
p Time.local(year, month, day)
# or do it all at once (google "ruby splat operator"):
p Time.local(*date.split(', ')) 
```

# json - 带有 .json 文件扩展名的 Azure 部署

> ID：10404242
> 
> 赞同：4
> 
> 时间：2012-05-01T20:57:18.357
> 
> 标签：json, azure

我们正在部署一个 azure 包，其中有一个静态 .json 文件。我们通过天蓝色模拟器和本地工作。但是当我们在 azure 中运行它时，我们的应用程序只会旋转。我们在 app.json 文件中得到 404。我们已经使用适当的处理程序将 mime 类型添加到我们的本地 iis，下面是我们在 web.config 中的内容。我们已经设置了 application/x-javascript 的 mime 类型，但这也不起作用。

```
<system.webServer>
    <staticContent>
        <mimeMap fileExtension=".json" 
                 mimeType="text/html" />
    </staticContent>
    <handlers>
        <add name="JSON" 
             path="*.json" 
             verb="*" 
             modules="IsapiModule" 
             scriptProcessor="%path%\asp.dll" 
             resourceType="Unspecified" 
             preCondition="bitness64" />
    </handlers>
</system.webServer> 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-01T22:34:10.770

添加

```
<configuration>
    <system.webServer>
      <staticContent>
        <mimeMap fileExtension=".json" mimeType="text/html" />
      </staticContent>
    </system.webServer>
</configuration> 
```

我在 Azure 实例中的 web.config 工作得很好。很可能，您部署的 web.config 配置不正确。要查看它，请启用 RDP，连接到您的 Azure 实例并浏览到您的 web.config。然后你可以摆弄你的 web.config 直到你让事情正常工作。

因为您提供的是静态 .json 文件，所以不需要添加 .json HTTP 处理程序。此外，.json 的官方 mime 类型是[application/json](http://en.wikipedia.org/wiki/JSON)。

# facebook - 为什么我的 Facebook 应用的大小不会达到 760 像素？

> ID：10404245
> 
> 赞同：0
> 
> 时间：2012-05-01T20:57:34.990
> 
> 标签：facebook

我有一个我创建的 Facebook 应用程序。我希望它是 760 像素。宽但是它似乎停留在 520 像素。当我查看 Facebook 生成的源代码时，我看到了这一点。

```
<-- <iframe name="app_runner_fb_https4fa04becb1d045950954937" id="app_runner_fb_https4fa04becb1d045950954937" style="width:520px;height:800px;" frameborder="0" src="https://s-static.ak.facebook.com/platform/page_proxy.php?v=4#app_runner_fb_https4fa04becb1d045950954937"></iframe> --> 
```

这似乎表明它正在使用 520。然而，高级开发人员面板中的设置似乎是正确的。

![画布高级设置选项](../Images/3b99fbbf61d2c2db865ed830cd37bd85.png)

使用谷歌，我看到了很多年前报告的 760 像素问题；但是，该选项仍在设置中。这个选项有效吗？最近 Facebook 将页面移动到时间线，从而释放了左侧导航栏。如果没有占用空间，我的应用程序看起来很愚蠢。它位于页面的中心，每侧有 100 多个白色像素。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T21:05:24.743

该屏幕截图是您的画布应用程序（apps.facebook.com/something）的宽度设置，选项固定为 760 或流体宽度（当然，这也取决于您自己的 CSS）

但是，在您的帖子中，您提到了时间轴和页面，这意味着您的应用程序是一个页面选项卡应用程序，作为 Facebook 页面上的选项卡访问。

如果是这种情况，则应用的宽度设置不存在，它在应用设置首页的页面选项卡下，可以设置为 520 像素或 810 像素

![配置界面](../Images/12e20e1bd654753a027832744159ccb3.png)

# c++ - 尝试放入 .a 时出现 C++ 链接错误处理

> ID：10404252
> 
> 赞同：0
> 
> 时间：2012-05-01T20:57:48.737
> 
> 标签：c++, ios4

已经使用一些 c / c++ 代码很长一段时间了，它在项目中运行良好。现在尝试从代码中创建一个 .a ，除了一个项目之外一切都很好。

有交流套路，叫它吧

```
void init(sometype *) 
```

这在 XCODE 中被标记为 c++ 文件，并且它有一个 .h 文件

在那里我们有

```
#if defined(__cplusplus)
extern "C"
{
#endif

void init(sometype *);

#if defined(__cplusplus)
}
#endif 
```

在将所有链接作为一个应用程序链接时，从目标 C 调用时会找到所有这些链接

当此代码包含在 .a 中，然后尝试从一个单独的项目链接时，我们得到....

```
Undefined symbols for architecture armv6:
  "__Znam", referenced from:
      _init in libMy.a(Objectfile.o)
ld: symbol(s) not found for architecture armv6
clang: error: linker command failed with exit code 1 (use -v to see invocation) 
```

看起来我们正在获得一些 C++ 初始化例程？链接 find 时的 .o 看起来与我们为 .a 编译时相同（__Znam 在那里）。

那么缺少什么库？？？

将进行更多挖掘以尝试找出幕后未包含的内容。

- - - - - 新的信息 - - - - - -

看起来问题是“new”关键字在这个例程中不起作用，这可能是例程没有正确链接。

所以像这样的一行...

```
var->output = new Int32*[10]; 
```

不能正常工作。......

# javascript - 将 XForm 实例序列化为 SOAPAttach 附件

> ID：10404253
> 
> 赞同：4
> 
> 时间：2012-05-01T20:57:50.947
> 
> 标签：javascript, dom, soap, xforms

我希望将 XForms 实例作为[SOAPAttach](http://www.w3.org/TR/2000/NOTE-SOAP-attachments-20001211)附件提交给 Web 服务。但是，根据 XForms 1.1 规范：

*   [11.11.3 SOAP HTTP 绑定](http://www.w3.org/TR/xforms/#SOAP-HTTP-Binding)

    > 的`method`属性`submission` [必须](http://www.w3.org/TR/xforms/#intro-reading)设置为`get`or`post`才能访问 SOAP HTTP 绑定。

    我理解这意味着该`multipart-post`方法（SOAPAttach 所需）不能与 SOAP HTTP 绑定一起使用？

*   [11.9.6 序列化为多部分/相关](http://www.w3.org/TR/xforms/#serialize-multipart)

    > *   后续零件要求
    >     
    >     
    >     *   每个节点的一个部分，其数据类型为`xsd:anyURI`通过上传填充：

    由于它明确声明“通过上传填充”，我认为这意味着 XML 实例数据或其他生成的内容只能出现在第一个正文部分（与 SOAPAttach 的要求相反）。

我是否正确理解这些限制中的每一个都使得无法（本机）提交一个 XForms 实例作为这样的附件？因此，必须自己生成这样的序列化（例如通过处理`xforms-submit-serialize`事件）？有没有标准的方法，或者可以提供帮助的库？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T05:54:04.090

我不是 SOAP 专家，但我认为您是对的。

Orbeon Forms 通过检查`xforms:upload`控件是否绑定到要提交的实例的节点来处理“由上传填充”的要求，所以现在是的，我认为 XForms 1.1 不幸地与上传相关联。

另一方面，XForms 实现似乎距离能够以本机方式执行此操作并不遥远，`multipart/related`因为正如您所指出的，它们应该已经支持上传文件作为附件。

做自己的序列化似乎需要做很多工作。

# php - 动态生成网页的问题

> ID：10404257
> 
> 赞同：1
> 
> 时间：2012-05-01T20:58:09.370
> 
> 标签：php, mysql, get

我的脚本需要你的帮助。我将旧新闻文章的链接放在侧边栏中并使其可点击。它来自的页面 (header.php) 在 URL 中有 GET id，因此接收它的页面也会检查 GET 的值。当我单击侧边栏中的旧新闻文章时，它显示良好。

我遇到的问题是，每当我想在 About.php 页面上查看当前文章时，我都会得到**Undefined Index id**

请问我该如何解决这个问题，以便我的脚本可以很好地显示旧文章以及当前的新闻文章。

谢谢

**关于.php**

```
<?php

$id = $_GET['id'];
$past = mysql_query( "SELECT * FROM about WHERE about_id = '".$id."'") or die(mysql_error()); 
$row = mysql_fetch_array($past);

echo "<h2>";
echo $row1['about_head'];
echo "</h2>";
echo "<p>";
echo $row1['about_content'];
echo "</p>";

?> 
```

**标题**

```
<?php

$past = mysql_query("SELECT * FROM about") or die(mysql_error());                    
while($row = mysql_fetch_array($past))
    echo "<a href=\"http://127.0.0.1/church/About.php?id=$row[about_id]\"> $row[about_head].</a><br/>";

?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T21:03:45.297

当您拥有此代码时：

```
 $id = $_GET['id']; 
```

您正在从名为 $_GET 的数组（包含所有 GET 参数）中检索一个名为“id”的项目。但是，当此参数“id”不存在时，PHP 会发出警告。要摆脱它，请将行替换为：

```
$id = "";
if (isset($_GET["id"])) $id = $_GET["id"]; 
```

或很快：

```
$id = isset($_GET["id"]) ? $_GET["id"] : ""; 
```

它首先询问参数是否存在，如果不存在，则给出一个空字符串。如果您希望`$id`变量是整数，您可能希望使用零而不是空字符串：

```
$id = isset($_GET["id"]) ? (int)$_GET["id"] : 0; 
```

这也将传递的参数转换为“int”，因此您可以保证它不是字符串（可能包含恶意数据）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T21:01:53.897

像这样的东西应该工作：

```
if( array_key_exists( 'id', $_GET ) )
{
  //do your code in here
}
else
{
  //fallback to scenario in which $_GET['id'] isn't set in the url
} 
```

# android - PackageManager.queryIntentActivities() 返回不完整的列表？

> ID：10404259
> 
> 赞同：3
> 
> 时间：2012-05-01T20:58:23.183
> 
> 标签：android, android-package-managers

我正在用 Android 编写一个启动器，这是我一直试图解决一段时间但没有运气的问题。

我有下面的代码来查询在我的启动器一开始运行的所有活动，比如说`onResume()`。

```
final Intent mainIntent = new Intent(Intent.ACTION_MAIN, null);
mainIntent.addCategory(Intent.CATEGORY_LAUNCHER);
final List<ResolveInfo> infos = packageManager.queryIntentActivities(mainIntent, 0);
for (final ResolveInfo info : infos) {
    // create my own recrord for each activity      
} 
```

问题是，如果我将启动器设置为默认值和`reboot`设备，每次我只能通过上面的代码获得完整列表的一部分。似乎总是缺少一些大胖子活动（例如发条骑士）。但是第二次运行上述代码将返回完整列表。有谁知道为什么？我的猜测是 PackageManager 需要一些时间来解析胖活动，如果`queryIntentActivities()`调用得太早，它只会返回一个部分列表，是真的吗？

但是为什么默认启动器没有这个问题呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-09T11:20:13.207

较大的活动更有可能安装在外部存储分区上，这通常需要一段时间才能安装。我的三星 Galaxy W 手机上的启动器就是这样做的，它会显示一个占位符图标，直到安装 SD 卡并且应用程序可以使用。

应该有来自 PackageManager 的广播，告诉您何时有新的应用程序可用，但我一目了然找不到。您可能必须听[ACTION_MEDIA_MOUNTED](http://developer.android.com/reference/android/content/Intent.html#ACTION_MEDIA_MOUNTED)并希望 PackageManager 已先到达那里。

# java - 无法在 Postgres / JDBC 中跨层隔离事务

> ID：10404262
> 
> 赞同：1
> 
> 时间：2012-05-01T20:58:31.087
> 
> 标签：java, sql, postgresql, jdbc

我正在开发一个使用**JDBC并入****PostgresSQL 9.0**数据库层的 Java 项目。SQL 封装在函数中，在**Java**中执行，就像使用 JDBC 的存储过程一样。

 ****数据库需要一个*header-detail*方案，详细记录需要 header 的外键 ID。因此，首先写入标题行，然后写入几千条详细记录。 *在详细信息完成写入之前，我需要阻止用户访问标题。*

您可能会建议包装整个事务，以便在详细记录完成写入之前无法提交标头记录。但是，您可以在下面看到我已将事务隔离到 Java 中的调用：写入标头，然后循环通过详细信息（同时写入详细信息行）。由于数据的庞大，将详细数据传递给函数以执行一项事务是不可行的。

**我的问题是：如何在 JDBC 级别包装事务，以便在详细记录完成写入之前不提交标头？**

最好的解决方案比喻是 SQL Server 的命名事务，其中事务可以在数据访问层代码（在其他事务之外）启动，并在以后的数据库调用中完成。

以下（简化）代码执行没有错误，但不能解决隔离问题：

```
DatabaseManager mgr = DatabaseManager.getInstance();
Connection conn = mgr.getConnection();
CallableStatement proc = null;

conn.setAutoCommit(false);
proc = conn.prepareCall("BEGIN TRANSACTION");
proc.execute();

//Write header details
writeHeader(....);
for(Fault fault : faultList) {
    writeFault(fault, buno, rsmTime, dnld, faultType, verbose);
}
proc = conn.prepareCall("COMMIT TRANSACTION");
proc.execute(); 
```

您的精彩回答将不胜感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T21:26:20.687

您是否对 writeHeader 和 writeFault 使用相同的连接？

```
conn.setAutoCommit(false);

headerProc = conn.prepareCall("headerProc...");
headerProc.setString(...);
headerProc.execute();

detailProc = conn.prepareCall("detailProc...");

for(Fault fault : faultList) {
    detailProc.setString(...);
    detailProc.execute();
    detailProc.clearParameters();
}

conn.commit(); 
```

然后你真的应该看看那个细节循环的“addBatch”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-02T01:35:39.833

虽然您似乎已经解决了眼前的问题，但如果您在 Java EE 容器中运行，您可能需要研究 JTA。根据我的经验，JTA 与 EJB3.1* 的结合让您可以进行声明式事务控制并大大简化事务管理。

*别担心，EJB3.1 比以前的 EJB 规范更简单、更干净、更不可怕。****

# c - 在 MS VS 2008 中使用 __declspec(dllimport)

> ID：10404270
> 
> 赞同：0
> 
> 时间：2012-05-01T20:59:29.407
> 
> 标签：c, visual-c++

假设我们有：MS VS 2008 中的 mysolution.sln，假设我们有 2 个项目：

1) project1.vcproj - 这里有 project1_file1.cpp，我们在其中定义了函数：

```
 doSomething(){
  ...
  } 
```

2) project2.vcproj - 比如说，这里有 project2_file1.h 和 project2_file1.c。我在 project2_file1.c 中尝试实现的目标是这样的，其中：

```
myJumpTable_t myJumpTable = {
   doSomething
}; 
```

我知道我们必须在某处定义一个结构：

```
 typedef struct _myJumpTable_t {
       void (*doSomething)();
}myJumpTable_t; 
```

但我不确定，必须在哪里声明？我也知道我们必须使用 __declspec(dllimport)，但我不知道如何使用它。请帮我解决一下这个。我被这个问题困扰了很多天。

非常感谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T21:23:35.660

首先，默认情况下，不会从 DLL 导出任何函数。您必须使用 .map 文件或 .map 文件手动导出它们`__declspec(dllexport)`。

从 DLL 导入的任何内容都必须以或多或少与程序的普通部分相同的方式定义，除了声明必须以`__declspec(dllimport)`. 这通常在作为 DLL 项目文件一部分的头文件中完成，并且会`__declspec(dllexport)`在编译 DLL（除非您使用 .map 文件）和`__declspec(dllimport)`编译 EXE 时选择

为了保持简单，我不会坚持这个建议。

### project1_file1.cpp

```
//This is exporting the function from the DLL so that it can be found
__declspec(dllexport) void doSomething() {
    ...
} 
```

### project2_file1.h

```
//This is where we declare the function so our code knows what it is
__declspec(dllimport) void doSomething(); 

typedef struct _myJumpTable_t {
    void (*doSomething)();
}myJumpTable_t; 
```

### project2_file1.c

```
myJumpTable_t myJumpTable = {
    &doSomething //& symbol here is optional, but good practice
}; 
```

这遵循您的原始代码，但请注意，`doSomething`一旦声明，您可以直接在 EXE 中调用。不需要该表，除非您的其他代码使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T20:44:55.843

您是在构建将使用此 DLL 的 DLL 和应用程序，还是两个项目都只是可执行模块并且您正在尝试重用代码？

# php - 如何在 LEFT JOIN 中返回多行

> ID：10404276
> 
> 赞同：2
> 
> 时间：2012-05-01T20:59:53.643
> 
> 标签：php, mysql, amfphp

我有一种情况，可以说我正在尝试获取有关某些食物的信息。然后我需要显示所有信息以及该食物中的所有成分。

通过我的查询，我得到了一个数组中的所有信息，但只有第一个成分......

```
 myFoodsArr = 
        [0]
          foodDescription = "the description text will be here"
          ratingAverage = 0
          foodId = 4
          ingredient = 1
          ingAmount = 2
          foodName = "Awesome Food name"
          typeOfFood = 6
          votes = 0 
```

我想拿回这样的东西......

```
 myFoodsArr = 
            [0]
              foodDescription = "the description text will be here"
              ratingAverage = 0
              foodId = 4
              ingArr = {ingredient: 1, ingAmount: 4}, {ingredient: 3, ingAmount: 2}, {ingredient: 5, ingAmount: 1}
              foodName = "Awesome Food name"
              typeOfFood = 6
              votes = 0 
```

这是我现在正在使用的查询。我如何调整它以返回食物 ID 4，然后还获得该食物的所有成分？一直在做其他事情，比如获得食物的平均评分？

谢谢！

```
 SELECT a.foodId, a.foodName, a.foodDescription, a.typeOfFood, c.ingredient, c.ingAmount, AVG(b.foodRating) AS ratingAverage, COUNT(b.foodId) as tvotes 
FROM `foods` a 
LEFT JOIN `foods_ratings` b 
   ON a.foodId = b.foodId 
LEFT JOIN `foods_ing` c 
   ON a.foodId=c.foodId 
WHERE a.foodId=4 
```

**编辑：**

Catcall 引入了我从未听说过的“子查询”的概念，因此我正在尝试进行这项工作，看看我是否可以轻松地在 1 个查询中做到这一点。但我只是不断收到错误的回报。这就是我没有运气的尝试..

```
//I changed some of the column names to help them be more distinct in this example

SELECT a.foodId, a.foodName, a.foodDescription, a.typeOfFood, AVG(b.foodRating) AS ratingAverage, COUNT(b.foodId) as tvotes 
FROM foods a 
LEFT JOIN foods_ratings b ON a.foodId = b.foodId 
LEFT JOIN (SELECT fId, ingredientId, ingAmount 
                 FROM foods_ing 
                 WHERE fId = 4 
                 GROUP BY fId) c ON a.foodId = c.fId 
           WHERE a.foodId = 4"; 
```

**编辑与 ROLANDS GROUP_CONCAT/JSON 想法相关的另外 1 件事作为解决方案 4 这个**

我正在尝试确保我发送回我的 Flash 项目的 JSON 字符串已准备好被正确解析`Invalid JSON parse input.`不断弹出..

所以我想我需要在正确的地方正确地使用所有的双引号。

但是在我的 MySQL 查询字符串中，我试图转义双引号，但是它使我的 mySQL 变量不起作用，例如......

如果我这样做..

```
GROUP_CONCAT('{\"ingredient\":', \"c.ingredient\", ',\"ingAmount\":', \"c.ingAmount\", '}')` 
```

我明白这个...

`{"ingredient":c.ingredient,"ingAmount":c.ingAmount},{"ingredient":c.ingredient,"ingAmount":c.ingAmount},{"ingredient":c.ingredient,"ingAmount":c.ingAmount}`

如何使用所有双引号使 JSON 正确形成而不破坏 mysql？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T06:54:24.517

这应该可以解决问题：

```
SELECT    food_ingredients.foodId
,         food_ingredients.foodName
,         food_ingredients.foodDescription
,         food_ingredients.typeOfFood
,         food_ingredients.ingredients
,         AVG(food_ratings.food_rating) food_rating
,         COUNT(food_ratings.foodId)    number_of_votes 
FROM      (
           SELECT    a.foodId
           ,         a.foodName
           ,         a.foodDescription
           ,         a.typeOfFood
           ,         GROUP_CONCAT(
                         '{ingredient:', c.ingredient,
                     ,   ',ingAmount:', c.ingAmount, '}'
                     ) ingredients
           FROM      foods a 
           LEFT JOIN foods_ing c 
           ON        a.foodsId = c.foodsId 
           WHERE     a.foodsId=4
           GROUP BY  a.foodId
          ) food_ingredients
LEFT JOIN food_ratings
ON        food_ingredients.foodId = food_ratings.foodId
GROUP BY  food_ingredients.foodId 
```

请注意，您想要执行的查询类型在任何基于 SQL 的数据库中都不是微不足道的。

主要问题是你有一个主（食物）和两个细节（成分和评级）。因为这些细节彼此不相关（除了与主人），它们彼此形成笛卡尔积（仅受它们与主人的关系约束）。

上面的查询分两步解决了这个问题：首先，加入第一个细节（成分）并聚合细节（使用 group_concat 将所有相关成分行组成一行），然后将该结果加入第二个细节（评级）并再次汇总。

在上面的示例中，成分以结构化字符串的形式返回，与您的示例中出现的完全一样。如果您想访问 PHP 中的数据，您可能会考虑添加更多语法以使其成为有效的 JSON 字符串，以便您可以使用 php 函数将其解码为数组`json_decode()`：[http ://www.php.net/manual/ en/function.json-decode.php](http://www.php.net/manual/en/function.json-decode.php)

为此，只需将行更改为：

```
CONCAT(
    '['
,   GROUP_CONCAT(
        '{"ingredient":', c.ingredient
    ,   ',"ingAmount":', c.ingAmount, '}'
    )
,   ']'
) 
```

（这假定`ingredient`并且`ingAmount`是数字；如果它们是字符串，则应将它们双引号，并转义出现在字符串值中的任何双引号）

如果您保留服务器变量的默认设置，则成分的串联`GROUP_CONCAT`可能会导致问题。`group_concat_max_len`缓解该问题的一种简单方法是将其设置为任何结果的最大理论大小：

```
SET group_concat_max_len = @@max_allowed_packet; 
```

您可以在打开与 mysql 的连接后执行一次，然后它将在该会话期间有效。或者，如果您有超级权限，您可以更改整个 MySQL 实例的值：

```
SET GLOBAL group_concat_max_len = @@max_allowed_packet; 
```

您还可以在 my.cnf 或 my.ini 中添加一行，以将 group_concat_max_lenght 设置为任意足够大的静态值。见[http://dev.mysql.com/doc/refman/5.5/en/server-system-variables.html#sysvar_group_concat_max_len](http://dev.mysql.com/doc/refman/5.5/en/server-system-variables.html#sysvar_group_concat_max_len)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T21:11:07.757

一个明显的解决方案是实际执行两个查询：

1) 得到食物

```
SELECT a.foodId, a.foodName, a.foodDescription, a.typeOfFood
FROM `foods` a
WHERE a.foodsId=4 
```

2）得到它的所有成分

```
SELECT c.ingredient, c.ingAmount
FROM `foods_ing` c
WHERE c.foodsId=4 
```

这种方法的优点是您不会将“食物”表中的数据复制到结果中。缺点是您必须执行两个查询。实际上，您必须为每个“食物”执行一个额外的查询，因此如果您想要列出包含所有成分的食物，则必须对每个食物记录进行查询。

其他解决方案通常有很多缺点，其中之一是使用[GROUP_CONCAT](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html#function_group-concat)函数，但它对返回字符串的长度有严格的限制。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-02T00:42:33.600

当您将 MySQL 的聚合函数和 GROUP BY 行为与 SQL 标准进行比较时，您必须得出结论，它们只是被破坏了。您可以在单个查询中执行您想要的操作，但不是直接加入评级表，而是需要加入一个返回聚合函数结果的查询。这些方面的东西应该起作用。

```
select a.foodId, a.foodName, a.foodDescription, a.typeOfFood, 
       c.ingredient, c.ingAmount,
       b.numRatings, b.avgRating
from foods a
left join (select foodId, count(foodId) numRatings, avg(foodRating) avgRating
           from foods_ratings
           group by foodId) b on a.foodId = b.foodId
left join foods_ing c on a.foodId = c.foodId
order by a.foodId 
```

# javascript - json 到一个变量中，然后传递它

> ID：10404277
> 
> 赞同：0
> 
> 时间：2012-05-01T21:00:00.063
> 
> 标签：javascript, jquery, json, highcharts, highstock

如果我们有这样的代码

```
 yAxis : {
            title : {
                text : 'Exchange rate'
            },
            plotLines : [{
                value : 0.6738,
                color : 'green',
                dashStyle : 'shortdash',
                width : 2,
                label : {
                    text : 'Last quarter minimum'
                }
            }, {
                value : 0.7419,
                color : 'red',
                dashStyle : 'shortdash',
                width : 2,
                label : {
                    text : 'Last quarter maximum'
                }
            }]
        }, 
```

我如何获取 plotlines json 字符串并将其分配给一个变量并将此变量传递给 plotline 对象？我试过这样的东西

```
 var jsonObj = [];
 jsonObj.push({ "value": 1256211571000, "color": '#D2691E', "width": 1, "label": {   "text": 'rinse'} });
        var myLines = JSON.stringify(jsonObj); 
```

然后将 mylines 传递给 plotlines 但它并没有真正起作用

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T21:05:20.363

假设此对象位于名为 的变量中`data`，只需执行以下操作：

```
data.yAxis.plotLines.push({
    "value": 1256211571000,
    "color": '#D2691E',
    "width": 1,
    "label": {
        "text": 'rinse'
    }
}); 
```

这只是一个 JavaScript 对象，而不是 JSON。JSON 是对象（或数组）的*字符串表示形式。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T09:48:34.217

这是一个例子，如果它适合你'

$(文档).ready(函数() {

```
 $.getJSON('yourpage.php?getdata=y&compid=<?php echo $comp_details[0]['id']; ?>', function(data) {

            // split the data set into ohlc and volume
            var ohlc = [],
            volume = [],
            dataLength = data.length;

            for (i = 0; i < dataLength; i++) {
                //console.log(data[i][2]);
                ohlc.push([
                    data[i][0], // the date
                    data[i][1], // open
                    data[i][2], // high
                    data[i][3], // low
                    data[i][4] // close
                ]);

                volume.push([
                    data[i][0], // the date
                    data[i][5] // the volume
                ])
            }

            // set the allowed units for data grouping
            var groupingUnits = [[
                    'week',                         // unit name
                    [1]                             // allowed multiples
                ], [
                    'month',
                    [1, 2, 3, 4, 6]
                ]];

            // create the chart
              chart = new Highcharts.StockChart({
                chart: {
                    renderTo: 'container',
                    alignTicks: false,
                    zoomType: 'x'
                },

                rangeSelector: {
                    selected: 0
                },

                title: {
                    text:  '<?php echo strtoupper($_GET['CompanySymbol']); ?>'+' Historical'
                },

                yAxis: [{
                        title: {
                            text: 'OHLC'
                        },
                        height: 200,
                        lineWidth: 2,
                        min:0
                    }, {
                        title: {
                            text: 'Volume'
                        },
                        top: 300,
                        height: 100,
                        offset: 0,
                        lineWidth: 2

                    },
                    {

                        height: 200,
                        min: 0,
                        lineWidth: 2,
                        opposite: true

                    }],
                tooltip: {
                    crosshairs: [true,true],
                    shared: true
                },  

                series: [{
                        type: 'ohlc',
                        name: '<?php echo strtoupper($_GET['CompanySymbol']); ?>',
                        data: ohlc,
                        dataGrouping: {
                            units: groupingUnits
                        }
                    },
                    {
                        type: 'line',
                        name:'Fuerte',
                        yAxis: 2,
                        data:[<?php echo $newdata; ?>]
                    },
                    {
                        type: 'line',
                        name:'Debil',
                        yAxis: 2,
                        data:[<?php echo $newdata1; ?>]
                    },
                    {
                        type: 'column',
                        name: 'Volume',
                        data: volume,
                        yAxis: 1,
                        dataGrouping: {
                            units: groupingUnits
                        }
                    }]
            });
                chart.yAxis[2].setExtremes(10,90);
        });
    });' 
```

# c# - 异常导致的错误消息处理

> ID：10404278
> 
> 赞同：0
> 
> 时间：2012-05-01T21:00:04.607
> 
> 标签：c#, winforms, try-catch

我有一个代码可以在发生其他功能的事件中重新启动服务。

对于事件中的所有内容，我都有一个尝试，如下所示：

```
private void btnApply_Click(object sender, EventArgs e)
    {
        try
        {               
            applyChangesAndCheckRestartService();
        }
        catch (Exception ex)
        {
            MessageBox.Show("Error loading page.", "Error", MessageBoxButtons.OK, MessageBoxIcon.Error);
        }
    }

private void applyChangesAndCheckRestartService()
    {
        string svrPortNo = CommonCodeClass.getTagValue(CommonCodeClass.xml_SvrPortNoTag, CommonCodeClass.configLocation + CommonCodeClass.configXML);               

        if (!ApplyChangesForSettings())
        {                
            return;
        }

        if (svrPortNo != tbSvrPortNo.Text)
        {               
            CommonCodeClass.CheckToRestartService();
        }
    } 
```

现在，如果在 ApplyChangesForSettings() 期间出现错误，我将收到一个错误弹出窗口“错误加载页面”。

如果 CheckToRestartService() 中出现错误，我将因为 try catch 而得到相同的错误。

有没有更好的方法来处理这个问题。

就像我不介意 ApplyChangesForSettings() 的错误加载页面，但对于 CheckToRestartService() 我希望看到“无法重新启动服务”之类的错误。

任何建议表示赞赏。谢谢

```
internal static void CheckToRestartService()
    {
        DialogResult result = MessageBox.Show(CommonCodeClass.resartServiceMessage, "Warning", MessageBoxButtons.YesNo, MessageBoxIcon.Warning);
        if (result == DialogResult.Yes)
        {
            CommonCodeClass.RestartService(CommonCodeClass.serviceName, 60000);
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T21:04:32.380

处理这种情况的最快方法是当您的内部方法中的某个人失败并在 btnApply_Click 中捕获消息时抛出异常。

```
MessageBox.Show(ex.Message, "Error",  .....); 
```

最正确的方法是创建自己的异常类型并在方法内部，如果有失败条件抛出您自己的异常。例如创建一个这样的类

```
public class RestartServiceException : Exception
{
    public RestartServiceException(string message)
        : base(message)
    {
    }
    // You could also write other constructors with different parameters and use internal logic
    // to process your error message
} 
```

然后，当在 CheckToRestartService 方法中出现失败条件时，使用该类的实例

```
 if(fail == true)
       throw new RestartServiceException("The service could not be started because ....."); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T21:05:38.910

你要么需要

*   捕获异常`applyChangesAndCheckRestartService`
*   `enum`或者你可以通过一个[`ref`](http://msdn.microsoft.com/en-us/library/14akc2c7.aspx)名为`RestartStatus`

    ```
    enum RestartStatus{success, unableToRestart, unableToApplySettings};

    RestartStatus status = RestartStatus.success;
    applyChangesAndCheckRestartService(status);
    if(status != RestartStatus.success) //....

    private void applyChangesAndCheckRestartService(out RestartStatus status)
    {
        // set the status variable accordingly
    } 
    ```

第三种方法是使用可以单独捕获的[自定义异常。](http://msdn.microsoft.com/en-us/library/ms229064.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T21:06:27.900

好吧，也许您只需要用单独的 try/catch 块包装不同的函数：

```
 try {
        if (!ApplyChangesForSettings())
           return;
    }
    catch (Exception ex) {
        MessageBox.Show("Error loading page.", "Error", MessageBoxButtons.OK, MessageBoxIcon.Error);
    }

    if (svrPortNo != tbSvrPortNo.Text) {      
        try {         
            CommonCodeClass.CheckToRestartService();
        }
        catch (Exception ex) {
            MessageBox.Show("Unable to restart services.", "Error", MessageBoxButtons.OK, MessageBoxIcon.Error);
        }
    } 
```

或者，如果它们抛出不同的类型，您可以考虑捕获不同类型的异常：

```
string errmsg = string.empty;
try { 
    DoSomething();
}
catch (FooException) {
   errmsg = "There was a Foo error";
}
catch (WidgetException) {
   errmsg = "There was a problem with a Widget";
}
catch (Exception ex) {
   errmsg = "General problem: " + ex.Message;
}

if (!string.IsNullOrEmpty(errmsg))
   MessageBox.Show(errmsg); 
```

也可以看看：

*   [异常处理](http://msdn.microsoft.com/en-us/library/ms173162.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-01T21:07:27.147

他们会抛出不同的异常吗？如果他们这样做，您可以使用异常过滤：

```
private void btnApply_Click(object sender, EventArgs e)
{
    try
    {               
        applyChangesAndCheckRestartService();
    }

    // catch service start exceptions
    catch (InvalidOperationException ioex)
    {
        // display message that couldn't start service
    }

    // catch rest
    catch (Exception ex)
    {
        MessageBox.Show("Error loading page.", "Error", MessageBoxButtons.OK, MessageBoxIcon.Error);
    }
} 
```

**更新**这是假设您正在调用类似`ServiceController.Start()`which throws `InvalidOperationException`on failure 的东西，您可以自己轻松地将其抛出在您自己的错误条件下或创建您自己的自定义异常。

```
if (/* service didn't start */)
{
    throw new InvalidOperationException("Could not start service.");
} 
```

# php - 转义后的正确语法？

> ID：10404282
> 
> 赞同：0
> 
> 时间：2012-05-01T21:00:20.667
> 
> 标签：php, sql, syntax

转义后写的正确语法是什么？

```
("SELECT torrent_download
FROM " . DB_PREFIX . "auctions WHERE
                auction_id='" . $item_details['auction_id'] . ); 
```

我得到的错误是意外的'）'

我尝试了各种 " 和 ' 但似乎没有一个工作

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-01T21:02:27.297

看起来您在 final 之前缺少一个结束语`'`，它会用双引号括起来`$item_details['auction_id']``)``"'");`

```
("SELECT torrent_download
  FROM " . DB_PREFIX . "auctions WHERE
            auction_id='" . $item_details['auction_id'] . "'"); 
```

为了在双引号字符串中节省一点麻烦，我建议使用`{}`附件而不是连接所有引号。但是，您不能将常量 括起来`DB_PREFIX`。

```
("SELECT torrent_download
  FROM " . DB_PREFIX . "auctions WHERE
        auction_id='{$item_details['auction_id']}'"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T21:03:13.797

```
("SELECT torrent_download
 FROM " . DB_PREFIX . "auctions WHERE
            auction_id='" . $item_details['auction_id'] . "'"); 
```

你试过吗？又是“后跟”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T21:02:50.697

```
("SELECT torrent_download
FROM " . DB_PREFIX . "auctions WHERE
            auction_id='" . $item_details['auction_id'] ."'" ); 
```

# javascript - d3.js - 变换和过渡，多行

> ID：10404283
> 
> 赞同：6
> 
> 时间：2012-05-01T21:00:24.440
> 
> 标签：javascript, d3.js, graph, set

我已按照以下说明操作：[http](http://bost.ocks.org/mike/path/) : //bost.ocks.org/mike/path/ 使用单线创建和动画化单个图形。

并且，弄清楚了如何在图中创建多条线：[在 D3.js 中绘制多条线](https://stackoverflow.com/questions/8689498/drawing-multiple-lines-in-d3-js)

**主要问题：**在将新数据转移并推入我的数据数组后，我很难转换多行。

我创建了***N***行：（时间：纪元时间，向前走）

```
var seriesData = [[{time:1335972631000, value:23}, {time:1335972631500, value:42},...],
                  [{time:1335972631000, value:45}, {time:1335972631500, value:13},...],
                  [{time:1335972631000, value:33}, {time:1335972631500, value:23},...}],
                  [...],[...],...
                  ];

var seriesColors = ['red', 'green', 'blue',...];

line = d3.svg.line()
        .interpolate(interpolation)
        .x(function(d) { return x(d.time); })
        .y(function(d) { return y(d.value); });

graphGroup.selectAll(".line")
        .data(seriesData)
            .enter().append("path")
            .attr("class", "line")
            .attr("d", line)
            .style('stroke', function(d, i) { return seriesColors[i]; })
            .style('stroke-width', 1)
            .style('fill', 'none'); 
```

我正在尝试使用 Javascript setInterval(...) 调用以下方法来更新***N***行：

```
graph.selectAll("path")
    .data(seriesData)
    .attr("transform", "translate(" + x(1) + ")")
    .attr("d", line)
      .transition()
    .ease("linear")
    .duration(transitionDelay)
    .attr("transform", "translate(" + x(0) + ")"); 
```

它可以完美地绘制初始集，但是一旦我更新数据数组，线条就会消失。

* * *

***更新 01***

我意识到我在 x 中使用纪元时间值（xAxis 显示日期：时间），因为如果我使用上面的说明性 seriesData，我的示例可能会起作用。

问题是使用 x(1) 的“转换”、“翻译”，x(0) 返回的数字很大，比我需要转换的图表*大得多。*

我修改了*更新* ***N***行方法（上图）以使用手动方法：

**新问题：** 现在图形正确地向左移动，但线/图形*弹*回右侧，每次 setInterval 更新都会执行。

它正确地推/移了 seriesData 数组，但它不会一直向左滚动以显示实际正在绘制的新数据。

```
graph.selectAll("path")
        .data(seriesData)
        .attr("d", line)
        .attr("transform", null)
          .transition()
        .ease("linear")
        .duration(2000)
        .attr("transform", "translate(-200)"); 
```

我使用的另一个参考是： http: [//bl.ocks.org/1148374](http://bl.ocks.org/1148374)

有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T22:06:31.390

一件事让我觉得有可能出错是使用的数据调用，最初是

```
.data(seriesData) 
```

更新使用

```
.data([seriesData]) 
```

这可能会导致问题，但是如果不看到正在发生的其他事情就很难说出来，你可以把它放在 jsfiddle 上吗？

# c++ - 变体类型令牌的内存分配

> ID：10404284
> 
> 赞同：0
> 
> 时间：2012-05-01T21:00:30.147
> 
> 标签：c++, memory-management, data-structures, variant

我正在为自定义编程语言（连接，软类型）制作解释器，为此我有一个中心数据类型`Token`。令牌可以是许多不同类型中的一种，可以是标量类型，也可以是向量类型。为了最小化内存量，我使用了`union`第一个，但后来我只能在联合中使用普通的旧数据结构，所以我使用了`struct`所有字段（`long asInteger;`、、`boost::shared_ptr<std::string> asString`...）的 a。从内存消耗的角度来看，这当然是一个坏主意，但它完成了工作。

由于`Token`数据类型的长度几乎为 100 字节（例如，使 1,000,000 个整数的数组接近 100 兆字节），原始公式显示出严重不足。今天我改进了实现，使用复制语义为每个元素动态分配所需的内存，这样我就得到了类似于`union`如果我可以将它与类一起使用的东西。

这是新的类定义：

```
class Token {
protected:
    TokenType tokenType_;

    template<class T>
    inline void copyToken(void * src, void * dst)
    {
      *static_cast<T*>(dst) = 
          *static_cast<T*>(src);
    };

    template<class T>
    inline void deleteValue()
    {
      delete static_cast<T*>(data);
    };

    void deleteData()
    {
        switch (tokenType_)
        {
            case T_INTEGER:   deleteValue<long>(); break; 
            case T_BOOL:      deleteValue<bool>(); break; 
            case T_FLOAT:     deleteValue<double>(); break;
            case T_STRING:    deleteValue<boost::shared_ptr<std::string>>(); break;  
            case T_ARRAY:     deleteValue<boost::shared_ptr<std::vector<Token>>>(); break;
            case T_HANDLE:    deleteValue<HandleData>(); break;
            default: ;
        }
    }

    void allocate(const TokenType tokenType)
    {       
        switch (tokenType)
        {
            case T_INTEGER:   data = new long; break; 
            case T_BOOL:      data = new bool;  break; 
            case T_FLOAT:     data = new double; break;
            case T_STRING:    data = new boost::shared_ptr<std::string>; break;  
            case T_ARRAY:     data = new boost::shared_ptr<std::vector<Token>>; break;
            case T_HANDLE:    data = new HandleData; break;
            default: data = NULL;
        }     
    };

    void * data;

public:

    void set_type(const TokenType tokenType)
    {
        deleteData();
        tokenType_ = tokenType;
        allocate(tokenType);
    };

    Token() : tokenType_ (T_EMPTY) { data = NULL; }; 

    Token(const TokenType tokenType) : tokenType_ (tokenType)  
    {
        allocate(tokenType);
    };

    Token(const Token& old_token)  
    {
        tokenType_ = old_token.tokenType_;
        allocate(old_token.tokenType_);
        switch (old_token.tokenType_)
        {
            case T_INTEGER:   copyToken<long>(old_token.data, data); break; 
            case T_BOOL:      copyToken<bool>(old_token.data, data); break; 
            case T_FLOAT:     copyToken<double>(old_token.data, data); break;
            case T_STRING:    copyToken<boost::shared_ptr<std::string>>(old_token.data, data); break; 
            case T_ARRAY:     copyToken<boost::shared_ptr<std::vector<Token>>>(old_token.data, data); break;
            case T_HANDLE:    copyToken<HandleData>(old_token.data, data); break;
            default: ;
        }       
    };

    template<class T>
    T& retreive()
    {
        return *static_cast<T*>(data);
    };

    template<class T>
    const T& retreive() const
    {
        return *static_cast<T*>(data);
    };

    void operator=(const Token &rhs) 
    {
        fileName = rhs.fileName;
        lineNum  = rhs.lineNum;
        set_type(rhs.tokenType_);
        switch (rhs.tokenType_)
        {
            case T_INTEGER:   copyToken<long>(rhs.data, data); break; 
            case T_BOOL:      copyToken<bool>(rhs.data, data); break; 
            case T_FLOAT:     copyToken<double>(rhs.data, data); break;
            case T_STRING:    copyToken<boost::shared_ptr<std::string>>(rhs.data, data); break; 
            case T_ARRAY:     copyToken<boost::shared_ptr<std::vector<Token>>>(rhs.data, data); break;
            case T_HANDLE:    copyToken<HandleData>(rhs.data, data); break;
            default: ;
        }       
    };

    ~Token()
    {
       deleteData();
    };
}; 
```

然后我会创建一个令牌

```
Token newToken(T_INTEGER);
newToken.retreive<long>() = 42; 
```

现在上面的代码**可以工作**了，但是速度非常慢（比之前的 union 实现慢 200%）。分析器显示几乎一半的执行时间花在`new`和上`free()`。我尝试在 a 上使用放置新语法，`char data[50]`以便`Token`在适用时在堆栈上分配对象的空间，并且在所有情况下仅分配一次，这可以大大加快速度，但仍不如原始语法快（慢约 20%）。

我的问题是：**我将如何让这种频繁分配的小对象变得更精简和更快？**

如果这通常以完全不同的方式完成，请告诉我该怎么做。我通常需要一种健壮且快速但不是“智能”（自动转换，...​​）的变体类型，因为我有自己的框架。一般来说，我想最小化内存分配成本，同时也最小化所需的内存。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-11-19T22:22:22.827

我知道这已经有好几年了，看来你找到了答案，但你从未发布过，所以如果有人偶然发现这篇文章（就像我一样），我会解释一些解决方案。

# **联盟**

是的，可以使用您最终避免使用的相同数据结构。这将大大减少数据量。假设您有这四种类型：`bool`、`int`、`float`和 a `double`。联合体的大小总是最大的，这不是最好的，但它比*所有*元素的大小要好。现在，您说“ *......我只能在联合中使用普通的旧数据结构......* ”这是真的，但它可以使用指向非泛型类型的指针。这可以解决您的大部分内存问题，但如果您使用指针，您将不得不使用`new`，`delete`因此您仍然会因为这些问题而运行得更慢。使用联合的另一个缺点是您必须跟踪正在使用的类型。

## 提升::变体

如果您可以访问 boost 库，那么我肯定会选择这个。我认为它节省的内存不如联合多，但它比保存所有值节省的内存要多得多。这也允许非泛型类型。此外，您不必跟踪正在使用的类型。您只需要跟踪编写类型的顺序即可。

我会说使用**Boost::variant**但可以使用联合。

# java - 为消费者生产者使用 ExecutorService 和 PipedReader/PipedWriter（或 PipedInputStream/PipedOutputStream）的 Java 示例

> ID：10404288
> 
> 赞同：0
> 
> 时间：2012-05-01T21:01:05.480
> 
> 标签：java, producer-consumer, executorservice, java.util.concurrent

我正在寻找一个简单的生产者 - Java 中的消费者实现，并且不想重新发明轮子

我找不到同时使用新并发包和管道类的示例

是否有同时使用[PipedInputStream](http://docs.oracle.com/javase/6/docs/api/java/io/PipedInputStream.html)和新的 Java 并发包的示例？

有没有更好的方法不使用管道类来完成这样的任务？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-02T15:17:59.027

对于您的任务，仅使用单个线程并在`BufferedOutputStream`从数据库读取时使用 a 写入文件可能就足够了。

如果您想更好地控制缓冲区大小和写入文件的块大小，您可以执行以下操作：

```
class Producer implements Runnable {

    private final OutputStream out;
    private final SomeDBClass db;

    public Producer( OutputStream out, SomeDBClass db ){
        this.out = out;
        this.db = db;
    }

    public void run(){
        // If you're writing to a text file you might want to wrap
        // out in a Writer instead of using `write` directly.
        while( db has more data ){
            out.write( the data );
        }
        out.flush();
        out.close();
    }
}

class Consumer implements Runnable {

    private final InputStream in;
    private final OutputStream out;
    public static final int CHUNKSIZE=512;

    public Consumer( InputStream in, OutputStream out ){
        this.out = out;
        this.in = in;
    }

    public void run(){
        byte[] chunk = new byte[CHUNKSIZE];

        for( int bytesRead; -1 != (bytesRead = in.read(chunk,0,CHUNKSIZE) );;){
            out.write(chunk, 0, bytesRead);
        }
        out.close();
    }
} 
```

在调用代码中：

```
FileOutputStream toFile = // Open the stream to a file
SomeDBClass db = // Set up the db connection
PipedInputStream pi = new PipedInputStream(); // Optionally specify a size
PipedOutputStream po = new PipedOutputStream( pi );

ExecutorService exec = Executors.newFixedThreadPool(2);
exec.submit( new Producer( po, db ) );
exec.submit( new Consumer( pi, toFile ) );
exec.shutdown(); 
```

*   还要捕获可能引发的任何异常。

请注意，如果这就是您所做的一切，那么使用`ExecutorService`. 当您有很多任务（太多而无法同时在线程中启动所有任务）时，执行程序很有用。这里你只有两个线程必须同时运行，所以`Thread#start`直接调用会减少开销。

# wordpress - Wordpress Multisite（样式表和图像未显示在 wp-content 主题文件夹下）

> ID：10404291
> 
> 赞同：1
> 
> 时间：2012-05-01T21:01:14.713
> 
> 标签：wordpress, permalinks

我创建了一个多站点 wordpress 环境并在其下创建了站点...

我将现有的主题复制到了多站点 wp-content/theme 文件夹中，以便将其用于所有站点。

我的问题是路径没有正确显示。一个例子是： [http ://sitename.com/images/aim_informatics_logo.png](http://sitename.com/images/aim_informatics_logo.png)

图片的位置： [http ://sitename.com/wp-content/themes/blankrightsidebar/images/aim_informatics_logo.png](http://sitename.com/wp-content/themes/blankrightsidebar/images/aim_informatics_logo.png)

多站点设置如下： 主站点（多站点） 博客 新闻 事件 文档

由于某种原因，header.php 文件没有正确链接路径。我的主题被设置为独立的 WP 博客/页面，它链接在一个目录下......示例

www.sitename.com/blog

博客是我保存的 WP 内容。

如果有人能帮我解决这个问题，我将不胜感激......我不认为将每个 url 路径更改为：“sitename.com/wp-content/themes/blankrightsidebar/”将是一个很好的答案。

提前致谢。

更新：代码是：

```
<div id="header">
<div id="navContainer" class="container_12"><div class="headerpush"></div><!-- end headerpush -->

<h1 class="grid_3 logo"><a href="../index.php"><img src="../images/logo.png" /></a></h1>
<!-- end mainLogo --> 
```

样式表代码：

```
<link rel="stylesheet" type="text/css" media="all" href="<?php bloginfo( 'stylesheet_url' ); ?>" /> 
```

基本上，我的站点的结构（多站点设置）是：站点名（根）-wordpress 文件（wp-content、admin、includes 等）-在 wp-content/theme/blankrightsidebar 内部是我存储主题文件的地方例如样式表、header.php 等。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T14:32:59.043

您的样式表链接对我来说似乎没问题。但是图片链接不对。你可以试试这段代码：

```
 <div id="header">
        <div id="navContainer" class="container_12"><div class="headerpush"></div><!-- end headerpush -->

        <h1 class="grid_3 logo"><a href="<?php echo home_url( ); ?>"><img src="<?php bloginfo('template_directory'); ?>/images/logo.jpg" /></a></h1>
        <!-- end mainLogo --> 
```

# java - 这是装饰器设计模式的一个很好的例子吗？

> ID：10404292
> 
> 赞同：2
> 
> 时间：2012-05-01T21:01:14.823
> 
> 标签：java, design-patterns, decorator

所以我今天参加了计算机科学入门课程的考试。其中一个问题是关于装饰器设计模式的，它给我带来了一些麻烦。我的问题不是关于正确答案是什么，而是这是否是一个使用装饰器模式的好例子。为什么要装饰人员层次结构，因为它同样容易并且需要更少的类来让 Population 类直接计算人员的 BMI？既然 BMI 是 Person 对象状态的派生属性，那么装饰器是否真的会在这种情况下添加功能？

问题：

```
interface Person(){
    double getWeightInKG();
    double getHeightInMeters();
} 
```

鉴于上面的人员接口，使用装饰器模式来实现下面定义的 Population 类。BMI 的计算公式为 BMI = 体重（公斤）/身高（米）^2。您可能必须设计和实现其他类和接口来实现这一点。假设您使用了 java.util.ArrayList。

```
+ Population: 
    - public void addPerson(Person p);
    - public void removePerson(Person p);
    - public double getAverageBMI();
    - public Person[ ] getPeopleInBMIRange(double bmi_min, bmi_max);
    - public int populationSize(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T21:09:09.780

我不会使用装饰器模式来装饰人。我会创建一个单独的类来计算看起来像这样的 BMI：

```
class BMICalculator {
    double getBMI(Person person) {}
} 
```

然后我会在 Population 类中使用 BMICalculator

```
class Population {
     private final BMICalculator calc;
     public double getAverageBMI() {
         double total = 0;
         for ( Person p : people ) {
            total += calc.getBMI(p);
         }
         return total/people.size();
     } 
} 
```

我认为装饰器不适合这里。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T21:09:20.957

这个想法是定义一个接口，例如`BmiPerson extends Person { double bmi(); }` ，然后在`Population`. 所以即使`BmiPerson`extends `Person`，它仍然可以被实现以便在其中包含另一个`Person`- 装饰器。至少这是我能做到的最好的。它仍然没有多大意义，因为`Population`接受`Person`并且不知道`BmiPerson`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-01T06:13:03.470

这个问题是垃圾，（至少）有两个原因。

**1.**不能将装饰器模式应用于接口。该模式的目标是将新行为绑定到某些基本功能上。接口没有基本功能。

**2.**该模式的另一点是您可以逐个对象应用新功能。你永远不会有一个 `Person`你不想计算的BMI。

# hadoop - 表达式语言在 oozie 同步数据集定义中获取格式化的日期戳

> ID：10404294
> 
> 赞同：0
> 
> 时间：2012-05-01T21:01:26.803
> 
> 标签：hadoop, el

在我的数据处理场景中，我有一些具有“YY”年份格式的源数据路径：

/user/${user.name}/${YEAR}/${MONTH}/${DAY}/一些数据集名称_YY

我知道在路径中已经存在 YEAR 的情况下最后使用“YY”是一个糟糕的设计，但它是我们当前系统中的内容，我们暂时无法更改它。

```
<datasets>
    <dataset name="hourlyds" frequency="${ds_frequency}"
        initial-instance="${ds_initial_instance}" timezone="${ds_timezone}">

        <uri-template>${baseFsURI}/${YEAR}/${MONTH}/${DAY}/alpha_${coord:formatTime(coord:actualTime(),'yy')}</uri-template>
        OR (tried one at a time)
        <uri-template>${baseFsURI}/${YEAR}/${MONTH}/${DAY}/alpha_${coord:formatTime(coord:nominalTime(),'yy')}</uri-template>

        <done-flag>${doneFlag}</done-flag>
    </dataset>
</datasets> 
```

2 个 EL 都没有工作。即使是一个没有任何数据名称前缀的非嵌套 EL 表达式也失败了：

```
<uri-template>${baseFsURI}/${YEAR}/${MONTH}/${DAY}/${coord:nominalTime()}</uri-template> 
```

每次它抛出以下错误：

```
Error: E1004: Expression language evaluation error [Unable to evaluate :${baseFsURI}/${YEAR}/${MONTH}/${DAY}/${coord:nominalTime()}: ], java.lang.Exception: Unable to evaluate :${baseFsURI}/${YEAR}/${MONTH}/${DAY}/${coord:nominalTime()}: 
```

如何在数据集中获得这种“YY”格式？除了 EL 有什么方法可以到达那里吗？

提前致谢，

拉胡尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T10:25:54.363

您不能将坐标放在数据集元素中，而是它们存在于输入事件或输出事件中，以在使用模板 url 格式化 URL 时描述与当前时间戳的关系

路径`/user/${user.name}/${YEAR}/${MONTH}/${DAY}/some dataset name_YY`是文件还是包含文件的目录？

如果是文件本身，则修改您的数据集以删除`some dataset name_YY`- Hadoop 会将 ${DAY} 文件夹输入解释为目录并将其中的所有文件用作您的输入

如果它们是目录并且您一次只处理 ${DAY} 文件夹**并且**${DAY} 文件夹仅包含一个目录（某些数据集 YY），那么您可以在操作中使用通配符：

```
 <action>
    <workflow>
      <app-path>${wf_app_path}</app-path>
      <configuration>
          <property>
          <name>wfInput</name>
          <value>${coord:dataIn('input')}/*</value>
        </property>
        <property>
          <name>wfOutput</name>
          <value>${coord:dataOut('output')}</value>
        </property>
      </configuration>
    </workflow>
  </action> 
```

# vb.net - 如何重写此 Visual Basic.net 循环以使其工作？

> ID：10404299
> 
> 赞同：0
> 
> 时间：2012-05-01T21:01:54.527
> 
> 标签：vb.net, loops

我有一个用 Visual Basic 编写的 For Each 循环，它试图修改它正在迭代的表。这导致“”集合被修改；枚举操作可能无法执行”异常。

令人沮丧的是，我试图复制我正在使用的所有对象，并且只从副本中删除，但异常仍然发生。

我知道这是由于我使用了 For Each 循环而不是 For 或 While 循环，但我无法重写我的代码并使其工作（我更熟悉 C#）。这就是我决定在这里寻求帮助的原因。

这是我的代码。我如何重写才能删除我希望删除的行？任何帮助和代码将不胜感激！

```
Dim drAcademicRecord, drSchool As DataRow
For Each drSchool In dsR.Tables("School").Rows
    If drSchool("OrganizationName") = "NA" Then
        For Each drAcademicRecord In dsR.Tables("AcademicRecord").Rows
            If drAcademicRecord("AcademicRecord_Id") = drSchool("AcademicRecord_Id") Then
                dsR.Tables("AcademicRecord").Rows.Remove(drAcademicRecord)  '<-- This is the line causing my exception
            End If
        Next
    End If
Next 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T21:16:17.993

```
For i as integer = dsR.Tables("AcademicRecord").Rows.Count - 1 to 0 Step -1
    If dsR.Tables("AcademicRecord").Rows(i)("AcademicRecord_Id") = drSchool("AcademicRecord_Id") Then
        dsR.Tables("AcademicRecord").Rows.RemoveAt(i)
    End If
Next 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T00:09:55.863

你不需要使用

```
dsR.Tables("AcademicRecord").Rows.Remove(drAcademicRecord) 
```

因为你已经有了 drAcademicRecord，所以你可以直接删除那一行

```
drAcademicRecord.Delete 
```

例如

```
For Each drSchool As DataRow In dsR.Tables("School").Select("OrganizationName='NA'")
    For Each drAcademicRecord As DataRow In dsR.Tables("AcademicRecord").Select("AcademicRecord_Id=" & drSchool("AcademicRecord_Id"))
        drAcademicRecord.Delete
    Next
Next 
```

# jqgrid - 在 jqgrid 中设计此表单的解决方案

> ID：10404303
> 
> 赞同：0
> 
> 时间：2012-05-01T21:02:09.913
> 
> 标签：jqgrid, jqgrid-asp.net, jqgrid-formatter

我在使用jqGrid时遇到问题，在讨论解释表的问题之前。
我有 4 个表 CostType,CurrencyUnit , Request,RequestCost 。
CostType 表结构

```
CostId       CostName 
-------      ----------
  1           permit
  2           Warehouse receipt
  3           Warehousing 
```

和请求结构

```
RequestId         RequestNo     WaybillNo
------------------------------------------
1                    100          120Ac30
2                    101           400CA852 
```

和 CurrencyUnit 表结构：

```
UnitId    UnitName
------------------
1           Dollar
2           Pound
3           Rial 
```

和 CostRequest 表结构

```
requestId   CostId  Amount    CurrencyUnitId     Remark
--------------------------------------------------------
1             2        200      3
1             1        400      1 
```

我想在填充页面加载网格如下：

![在此处输入图像描述](../Images/b2fa7a3412811e3e9653f2b33f335b06.png) 然后用户可以在顶部文本框中输入请求编号，然后单击按钮搜索如下： ![在此处输入图像描述](../Images/4c5306872301556bbf19104eebf59590.png) 用户可以更改或输入此请求的一些成本金额如下： ![在此处输入图像描述](../Images/a3dd08cf3cc8fcd6935c0f408c7445d3.png) 并单击保存按钮以保存到数据库中。注意：我是 jqGrid 的初学者，我可以先填充网格，其他两步我无法实现。请帮我 。谢谢大家

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T10:37:17.970

如果不为您编写代码，就很难回答您的问题。

“RequestNo”（例如，具有 id="requestNo"）和“搜索”按钮的输入字段可以是`<fieldset>`网格中的简单控件。`click`“搜索”按钮的处理程序可以调用`$("#grid").trigger("reloadGrid", [{page:1}])`. 在网格定义内部，您可以使用`postData`类似

```
var $grid = $("#grid"),
    editingRowId,
    myEditParam = {
        keys: true,
        oneditfunc: function (id) { editingRowId = id; },
        afterrestorefunc: function (id) { editingRowId = undefined; },
        aftersavefunc: function (id) { editingRowId = undefined; }
    }; 

$grid.jqGrid({
    ...
    postData: {
        // add requestNo parameter to the request
        requestNo: function () { return $("#requestNo").val(); }
    },
    beforeRequest: function () {
        // stop request to the server for empty requestNo
        return $("#requestNo").val() !== "" ? true : false;
    },
    onSelectRow: function (id) {
        if (id !== editingRowId) {
            if (typeof editingRowId !== "undefined") {
                // save previously editing row
                $(this).jqGrid("saveRow", editingRowId, myEditParam);
            }
            // start inline editing. The user should save the row by pressing ENTER
            $(this).jqGrid("editRow", id, myEditParam);
        }
    }
    ...
}); 
```

您可以另外添加“保存”按钮，如果不是，它将调用`$("#grid").jqGrid("saveRow", editingRowId);`以保存最后一个编辑行。`editingRowId``undefined`

添加`editable: true`到您希望在编辑模式下查看的所有列非常重要。如果您想在网格中拥有所有编辑列，您可以使用`cmTemplate: {editable: true}`jqGrid 选项。它更改了在 中定义的列定义的默认值`colModel`。

要在“CurrencyUnit”列中有下拉列表，您应该在列定义中包含其他属性：

```
edittype: "select", editoptions: { value: "Dollar:Dollar; Pound:Pound; Rial:Rial" } 
```

# c++ - std::count 错误

> ID：10404305
> 
> 赞同：2
> 
> 时间：2012-05-01T21:02:21.360
> 
> 标签：c++, stl

```
 temp_holder.clear();
  temp_holder << n;
  n_str = temp_holder.str();
  int f = count(n_str.begin(), n_str.end(), a); 
```

这是我的代码，这是 g++ 输出：

```
In file included from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/algorithm:63:0,
                 from trintatres.cpp:5:
/usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/stl_algo.h: In instantiation of ‘typename std::iterator_traits<_InputIterator>::difference_type std::count(_IIter, _IIter, const _Tp&) [with _IIter = __gnu_cxx::__normal_iterator<char*, std::basic_string<char> >; _Tp = std::basic_string<char>; typename std::iterator_traits<_InputIterator>::difference_type = long int]’:
trintatres.cpp:44:50:   required from here
/usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/stl_algo.h:4656:2: error: no match for ‘operator==’ in ‘__first.__gnu_cxx::__normal_iterator<_Iterator, _Container>::operator*<char*, std::basic_string<char> >() == __value’
/usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/stl_algo.h:4656:2: note: candidates are:
In file included from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/iosfwd:42:0,
                 from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/ios:39,
                 from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/ostream:40,
                 from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/iostream:40,
                 from trintatres.cpp:1:
/usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/postypes.h:218:5: note: template<class _StateT> bool std::operator==(const std::fpos<_StateT>&, const std::fpos<_StateT>&)
/usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/postypes.h:218:5: note:   template argument deduction/substitution failed:
In file included from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/algorithm:63:0,
                 from trintatres.cpp:5:
/usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/stl_algo.h:4656:2: note:   mismatched types ‘const std::fpos<_StateT>’ and ‘char’
In file included from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/stl_algobase.h:65:0,
                 from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/char_traits.h:41,
                 from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/ios:41,
                 from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/ostream:40,
                 from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/iostream:40,
                 from trintatres.cpp:1:
/usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/stl_pair.h:212:5: note: template<class _T1, class _T2> bool std::operator==(const std::pair<_T1, _T2>&, const std::pair<_T1, _T2>&)
/usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/stl_pair.h:212:5: note:   template argument deduction/substitution failed:
In file included from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/algorithm:63:0,
                 from trintatres.cpp:5:
/usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/stl_algo.h:4656:2: note:   mismatched types ‘const std::pair<_T1, _T2>’ and ‘char’
In file included from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/stl_algobase.h:68:0,
                 from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/char_traits.h:41,
                 from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/ios:41,
                 from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/ostream:40,
                 from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/iostream:40,
                 from trintatres.cpp:1:
/usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/stl_iterator.h:293:5: note: template<class _Iterator> bool std::operator==(const std::reverse_iterator<_Iterator>&, const std::reverse_iterator<_Iterator>&)
/usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/stl_iterator.h:293:5: note:   template argument deduction/substitution failed:
In file included from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/algorithm:63:0,
                 from trintatres.cpp:5:
/usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/stl_algo.h:4656:2: note:   mismatched types ‘const std::reverse_iterator<_Iterator>’ and ‘char’
In file included from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/stl_algobase.h:68:0,
                 from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/char_traits.h:41,
                 from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/ios:41,
                 from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/ostream:40,
                 from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/iostream:40,
                 from trintatres.cpp:1:
/usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/stl_iterator.h:343:5: note: template<class _IteratorL, class _IteratorR> bool std::operator==(const std::reverse_iterator<_IteratorL>&, const std::reverse_iterator<_IteratorR>&)
/usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/stl_iterator.h:343:5: note:   template argument deduction/substitution failed:
In file included from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/algorithm:63:0,
                 from trintatres.cpp:5:
/usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/stl_algo.h:4656:2: note:   mismatched types ‘const std::reverse_iterator<_IteratorL>’ and ‘char’
In file included from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/string:43:0,
                 from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/locale_classes.h:42,
                 from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/ios_base.h:43,
                 from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/ios:43,
                 from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/ostream:40,
                 from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/iostream:40,
                 from trintatres.cpp:1:
/usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/allocator.h:119:5: note: template<class _T1, class _T2> bool std::operator==(const std::allocator<_T1>&, const std::allocator<_T2>&)
/usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/allocator.h:119:5: note:   template argument deduction/substitution failed:
In file included from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/algorithm:63:0,
                 from trintatres.cpp:5:
/usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/stl_algo.h:4656:2: note:   mismatched types ‘const std::allocator<_T1>’ and ‘char’
In file included from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/string:43:0,
                 from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/locale_classes.h:42,
                 from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/ios_base.h:43,
                 from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/ios:43,
                 from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/ostream:40,
                 from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/iostream:40,
                 from trintatres.cpp:1:
/usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/allocator.h:124:5: note: template<class _Tp> bool std::operator==(const std::allocator<_Tp1>&, const std::allocator<_Tp1>&)
/usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/allocator.h:124:5: note:   template argument deduction/substitution failed:
In file included from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/algorithm:63:0,
                 from trintatres.cpp:5:
/usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/stl_algo.h:4656:2: note:   mismatched types ‘const std::allocator<_Tp1>’ and ‘char’
In file included from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/string:54:0,
                 from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/locale_classes.h:42,
                 from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/ios_base.h:43,
                 from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/ios:43,
                 from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/ostream:40,
                 from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/iostream:40,
                 from trintatres.cpp:1:
/usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/basic_string.h:2483:5: note: template<class _CharT, class _Traits, class _Alloc> bool std::operator==(const std::basic_string<_CharT, _Traits, _Alloc>&, const std::basic_string<_CharT, _Traits, _Alloc>&)
/usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/basic_string.h:2483:5: note:   template argument deduction/substitution failed:
In file included from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/algorithm:63:0,
                 from trintatres.cpp:5:
/usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/stl_algo.h:4656:2: note:   mismatched types ‘const std::basic_string<_CharT, _Traits, _Alloc>’ and ‘char’
In file included from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/string:54:0,
                 from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/locale_classes.h:42,
                 from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/ios_base.h:43,
                 from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/ios:43,
                 from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/ostream:40,
                 from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/iostream:40,
                 from trintatres.cpp:1:
/usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/basic_string.h:2490:5: note: template<class _CharT> typename __gnu_cxx::__enable_if<std::__is_char<_Tp>::__value, bool>::__type std::operator==(const std::basic_string<_CharT>&, const std::basic_string<_CharT>&)
/usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/basic_string.h:2490:5: note:   template argument deduction/substitution failed:
In file included from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/algorithm:63:0,
                 from trintatres.cpp:5:
/usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/stl_algo.h:4656:2: note:   mismatched types ‘const std::basic_string<_CharT>’ and ‘char’
In file included from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/string:54:0,
                 from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/locale_classes.h:42,
                 from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/ios_base.h:43,
                 from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/ios:43,
                 from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/ostream:40,
                 from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/iostream:40,
                 from trintatres.cpp:1:
/usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/basic_string.h:2504:5: note: template<class _CharT, class _Traits, class _Alloc> bool std::operator==(const _CharT*, const std::basic_string<_CharT, _Traits, _Alloc>&)
/usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/basic_string.h:2504:5: note:   template argument deduction/substitution failed:
In file included from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/algorithm:63:0,
                 from trintatres.cpp:5:
/usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/stl_algo.h:4656:2: note:   mismatched types ‘const _CharT*’ and ‘char’
In file included from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/string:54:0,
                 from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/locale_classes.h:42,
                 from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/ios_base.h:43,
                 from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/ios:43,
                 from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/ostream:40,
                 from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/iostream:40,
                 from trintatres.cpp:1:
/usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/basic_string.h:2516:5: note: template<class _CharT, class _Traits, class _Alloc> bool std::operator==(const std::basic_string<_CharT, _Traits, _Alloc>&, const _CharT*)
/usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/basic_string.h:2516:5: note:   template argument deduction/substitution failed:
In file included from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/algorithm:63:0,
                 from trintatres.cpp:5:
/usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/stl_algo.h:4656:2: note:   mismatched types ‘const std::basic_string<_CharT, _Traits, _Alloc>’ and ‘char’
In file included from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/locale_facets.h:50:0,
                 from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/basic_ios.h:39,
                 from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/ios:45,
                 from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/ostream:40,
                 from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/iostream:40,
                 from trintatres.cpp:1:
/usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/streambuf_iterator.h:206:5: note: template<class _CharT, class _Traits> bool std::operator==(const std::istreambuf_iterator<_CharT, _Traits>&, const std::istreambuf_iterator<_CharT, _Traits>&)
/usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/streambuf_iterator.h:206:5: note:   template argument deduction/substitution failed:
In file included from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/algorithm:63:0,
                 from trintatres.cpp:5:
/usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/stl_algo.h:4656:2: note:   mismatched types ‘const std::istreambuf_iterator<_CharT, _Traits>’ and ‘char’
In file included from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/x86_64-unknown-linux-gnu/bits/c++allocator.h:34:0,
                 from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/allocator.h:48,
                 from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/string:43,
                 from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/locale_classes.h:42,
                 from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/ios_base.h:43,
                 from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/ios:43,
                 from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/ostream:40,
                 from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/iostream:40,
                 from trintatres.cpp:1:
/usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/ext/new_allocator.h:129:5: note: template<class _Tp> bool __gnu_cxx::operator==(const __gnu_cxx::new_allocator<_Tp>&, const __gnu_cxx::new_allocator<_Tp>&)
/usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/ext/new_allocator.h:129:5: note:   template argument deduction/substitution failed:
In file included from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/algorithm:63:0,
                 from trintatres.cpp:5:
/usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/stl_algo.h:4656:2: note:   mismatched types ‘const __gnu_cxx::new_allocator<_Tp>’ and ‘char’
In file included from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/stl_algobase.h:68:0,
                 from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/char_traits.h:41,
                 from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/ios:41,
                 from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/ostream:40,
                 from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/iostream:40,
                 from trintatres.cpp:1:
/usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/stl_iterator.h:813:5: note: template<class _Iterator, class _Container> bool __gnu_cxx::operator==(const __gnu_cxx::__normal_iterator<_Iterator, _Container>&, const __gnu_cxx::__normal_iterator<_Iterator, _Container>&)
/usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/stl_iterator.h:813:5: note:   template argument deduction/substitution failed:
In file included from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/algorithm:63:0,
                 from trintatres.cpp:5:
/usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/stl_algo.h:4656:2: note:   mismatched types ‘const __gnu_cxx::__normal_iterator<_Iterator, _Container>’ and ‘char’
In file included from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/stl_algobase.h:68:0,
                 from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/char_traits.h:41,
                 from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/ios:41,
                 from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/ostream:40,
                 from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/iostream:40,
                 from trintatres.cpp:1:
/usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/stl_iterator.h:807:5: note: template<class _IteratorL, class _IteratorR, class _Container> bool __gnu_cxx::operator==(const __gnu_cxx::__normal_iterator<_IteratorL, _Container>&, const __gnu_cxx::__normal_iterator<_IteratorR, _Container>&)
/usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/stl_iterator.h:807:5: note:   template argument deduction/substitution failed:
In file included from /usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/algorithm:63:0,
                 from trintatres.cpp:5:
/usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.0/../../../../include/c++/4.7.0/bits/stl_algo.h:4656:2: note:   mismatched types ‘const __gnu_cxx::__normal_iterator<_IteratorL, _Container>’ and ‘char’ 
```

根据 cplusplus.com 的说法，老实说，我认为我使用的 std::count 是正确的。

知道我做错了什么吗？

**编辑** 完整代码：

```
#include <iostream>
#include <string>
#include <sstream>
#include <climits>
#include <algorithm>

using namespace std;

int max(int a, int b) {
  return (a > b) ? a : b;
}

int main() {
  string a;
  cin >> a;

  int c;
  cin >> c;

  int q;
  cin >> q;

  string cases[q];
  int max_case = INT_MIN;
  int temp;
  for (int i = 0; i < q; i++) {
    cin >> temp;
    max_case = max(temp, max_case);
    stringstream current_case_holder;
    current_case_holder << temp;
    cases[i] = current_case_holder.str();
  }

  int sequence[max_case];
  int n;
  stringstream temp_holder;
  string n_str;
  for (int i = 0; i < max_case; i++) {
    n = 1;
    while (true) {
      temp_holder.clear();
      temp_holder << n;
      n_str = temp_holder.str();
      int f = count(n_str.begin(), n_str.end(), a);

      //}

      n++;
    }
  }

  return 0;
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-01T21:11:51.627

第一个错误告诉你所有你需要知道的：

> 在 '<code>typename std::iterator_traits<_InputIterator>::difference_type std::count(_IIter, _IIter, const _Tp&)
> [with `_IIter`= `__gnu_cxx::__normal_iterator<char*, std::basic_string<char> >`;
>         `_Tp`= `std::basic_string<char>`;
>         `typename std::iterator_traits<_InputIterator>::difference_type`= `long int`]'</p>

这表明您将`std::string`第三个参数的对象传递给`std::count`，这是错误的；您需要传递一个`char`对象，因为您实际上是在迭代 a`std::string`和`std::string::value_type`is `char`。

# javascript - 我应该使用什么方法进行客户端过滤？

> ID：10404306
> 
> 赞同：1
> 
> 时间：2012-05-01T21:02:21.943
> 
> 标签：javascript, jquery, filtering

我正在制作一个 asp.net mvc3 web 应用程序的前端。控制器操作将数据库驱动的列表发送到视图模型，然后填充一系列 div。我在 div 列表上方有一个过滤部分。我不确定采用哪种方法来实现过滤器。我考虑过使用 jQuery 的 .filter() 或寻找一些 JavaScript 功能来使用自己的方法（我总是将此选项保留在桌面上）。

使用 JavaScript（或 js 派生库）过滤客户端的标准方法是什么？

*编辑*

对于 gdoron 缺乏上下文：

js

```
var gdoronArray = [];
for(var i = 0; i < 10000; i++){
 gdoronArray.push("text" + i + " " + (i*10));
} 
```

是否有一个标准库来仅提取 gdoronArray 中包含“ext5”的项目，或者这只是您自己的情况？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T21:19:33.260

```
gdoronArray.filter( function(v){
    return !!~v.indexOf("ext5");
}); 
```

[https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/filter](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/filter)

# c# - DateTime.TryParseExact 并解析多种日期格式

> ID：10404307
> 
> 赞同：0
> 
> 时间：2012-05-01T21:02:25.957
> 
> 标签：c#, datetime, tryparse

我正在尝试查看字符串是否为有效日期。由于日期采用“2011–7–17 23:18:52”格式，因此我遇到了麻烦。我正在这样测试：

```
String lstrTime = "2011–7–17 23:18:52";
DateTime datevalue; 
CultureInfo enUS = new CultureInfo("en-US");
if (DateTime.TryParseExact(lstrTime, "yyyy-MM-dd hh:mm:ss", enUS,
                     DateTimeStyles.None, out datevalue))
                        {
                            rtxtOutput.Text += "Valid datetime: " + lstrTime;
                        } 
```

我认为我遇到麻烦的原因是因为日期只能有 1 M 值或 2 MM 几个月。我有大量数据要处理，将 M 更改为 MM 不会发生。

编辑：我已经尝试了所有建议的链接，也许它可能是文化信息无法识别 24 小时时钟（问号）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T21:20:48.850

您需要使用 24 小时制，即大写 H，“yyyy-MM-dd HH:mm:ss”。

# marklogic - 消耗了多少内存映射？

> ID：10404308
> 
> 赞同：2
> 
> 时间：2012-05-01T21:02:27.173
> 
> 标签：marklogic

我有一个用于生成报告的 xquery，它有时会在地图中保存大约 500K uris，并检查它们在数据库中是否存在（`cts:search`with `cts:document-query`）并返回差异。但是，如果我们用并发请求访问同一个 E 节点，响应时间会变慢。

内存大小映射可以消耗是否有上限？在任何情况下都可以将地图交换到磁盘吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T06:09:04.940

您可以将地图作为 xml 存储在数据库本身中，但您仍然需要将其加载到内存中才能使用它。您也可以将它们存储为服务器字段，但仍需要将其加载到内存中。不过，如果使用 500k 条目构建地图需要相当长的时间，那么这样做可能是值得的。另一方面，您将如何跟踪地图是最新的？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T14:26:23.040

您可以通过管理服务器查看每个林使用的内存量。转到森林，单击状态选项卡，然后向下滚动到底部。“内存大小”是映射文件大小的总和。您还可以使用`xdmp:forest-status`XQuery 程序收集这些信息。

内存消耗受操作系统地址空间及其虚拟内存限制（可用交换空间）的限制。如果服务器内存消耗超过可用物理内存，操作系统会将页面交换到磁盘。这会对性能产生严重影响。因此，请监控操作系统交换利用率，看看这是否可能是导致速度变慢的原因。

# javascript - 文本区域内的 HTML5 富文本

> ID：10404312
> 
> 赞同：16
> 
> 时间：2012-05-01T21:02:36.537
> 
> 标签：javascript, html, textarea, syntax-highlighting, rich-text-editor

我听说新的 HTML5 将为 textareas 添加富文本功能（这将使它们更加灵活），因此您可以在没有非常讨厌的 javascript 的情况下执行代码语法高亮编辑器之类的操作（例如创建 iframe 和其他内容）。

这是真的？是否有支持它的浏览器？我在哪里可以找到一些 API？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2016-06-10T23:46:11.380

## 没有 jQuery

如果您像我们一样在哪里寻找 NO-jquery 工具（纯 HTML/CSS + 基本 JS），那么找到的一些最佳选择（早在 2016 年）是：

1.  [wysihtml5](http://xing.github.io/wysihtml5/)
2.  [乡绅](http://neilj.github.io/Squire/)
3.  [ckeditor](http://ckeditor.com)
4.  [widg编辑器](http://www.themaninblue.com/experiment/widgEditor/)

**尽管如此**，上面列表中的所有元素（textarea）都将元素（textarea）转换为iframe，所以它们并不完全是我们要搜索的内容，最后我们找到了这个**尊重原始元素**（divs左右，但如果你使用textarea它确实创建了一个额外的 div），允许完全直接的 JS 应用程序开发：

1.  **[好编辑](http://nicedit.com)**

我们希望这对您也有帮助！

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-01T21:15:22.477

您在寻找[Aloha 编辑器](http://aloha-editor.org/)吗？

它使用新`contenteditable`属性将所见即所得编辑器添加到您选择的任何 div 中。

看[演示](https://rawgit.com/alohaeditor/Aloha-Editor/hotfix/src/demo/boilerplate/)。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-05-01T21:11:14.683

我相信您指的是新的 contentEditable 属性。这不是文本区域，而是元素属性。这有利于允许更改内容。

试试[http://html5demos.com/contenteditable](http://html5demos.com/contenteditable)

请注意，您的浏览器可能不会为您提供带有粗体、斜体等的工具栏。但 chrome 将允许您选择文本并使用 CTR-B、CTR-I 等。事情仍在解决中。

基本上，这是一项正在进行的工作，对于浏览器兼容性，您最好的选择是使用像 tinymce 等人这样的所见即所得编辑器。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-05-01T21:10:43.733

你在哪里听说的？看着[W3Schools > HTML5 > textarea](http://www.w3schools.com/html5/tag_textarea.asp)我看不到任何暗示这是真的。

**编辑**：由于不喜欢 w3schools 的人的评论添加了更多链接

即使在这一点上本质上是一样的，这里是 w3.org 的[wiki](http://www.w3.org/wiki/HTML/Elements/textarea) textarea 的链接，以及 textarea 的[规范](http://www.whatwg.org/specs/web-apps/current-work/multipage/the-button-element.html#htmltextareaelement)。此外，这是截至 2012 年 3 月 29 日的 html 4 和 5[差异](http://www.w3.org/TR/html5-diff/)的文档

# c# - 控制不同的DataContext

> ID：10404313
> 
> 赞同：3
> 
> 时间：2012-05-01T21:02:37.653
> 
> 标签：c#, xaml, mvvm, mvvm-light

# 在 WPF 中控制不同的 DataContext

因为我可以在不同的选项卡中部署多个 DataContext 并控制哪个是当前 DataContext

![在此处输入图像描述](../Images/d6df38bdc8085ad2e380ddeff8f2f145.png)

我正在使用**Mvvm Light WPF4**我有不同的 ViewModel，View 但我不知道如何处理多个 DataContext 并控制当前 DataContext 以在选项卡开关上进行更改

## 编辑：

我有一个解决方案的方法如下：

1.  为 MainView 创建一个 ViewModel
2.  tabcontrol 源是 ObservableCollection
3.  每个 TabItem 都有自己的 DataContext
4.  菜单的 DataContext 如下所示：`DataContext="{Binding Path=CurrentTab.DataContext}"`where CurrentTab change when add new TabItem in ViewModel

我有以下问题：

1.  更改选项卡时如何从 TabControl 连接 ViewModel？

**解决方案**：问题是 Mvvm Light 使用 ViewModelLocator 以静态方式绑定 ViewModel，这是当我在 C# 中添加选项卡时 ViewModelLocator 不起作用的问题，否则我需要手动加载每个选项卡的 ViewModel，如下所示：

```
// in MainModelView.cs

public RelayCommand MyCommand { get; set; }

private void RegisterCommand()
{
  MyCommand = new RelayCommand(() =>
  {
    AddTab("Tab Header", new TabViewModel(), new TabContentControl());
  });
}

private void AddTab(string header, object context, ContentControl content)
{
  TabItem = null;

  foreach(TabItem tab in TabItemList)
  {
    if(tab.Header.Equals(header);
    {
      tabItem = tab;
    }
  }

    if(null == tabItem)
    {
      tabItem = new TabItem();
      tabItem.Header = header;
      tabItem.Content = content;
      tabItem.DataContext = context;
      TabItemList.Add(tabItem);
    }

    CurrentTabIndex = TabItemList.IndexOf(tabItem);    
} 
```

2.菜单中的DataContext没有更新，我的代码错了吗？

**解决方案**：上一点也解决了这个问题，只有解决了以下代码：

```
// in RegisterCommands()
ChangeTabCommand = new RelayCommand<TabItem>(tab =>
{
  if (null == tab) return;
  CurrentTabContext = tab.DataContext;
} 
```

在 MainWindow.xml 中：

```
 <!-- MainWindow.xaml -->

  <Button Content="NewTab" Command="{Binding Path=MyCommand }" />

  <TabControl
      Margin="5 5 5 0"
      Grid.Row="1"
      ItemsSource="{Binding Path=TabItemList}"
      SelectedIndex="{Binding Path=CurrentTabItemIndex}"
      x:Name="Workspace">
      <i:Interaction.Triggers>
          <i:EventTrigger EventName="SelectionChanged">
              <cmd:EventToCommand
              Command="{Binding ChangeTabCommand }"
              CommandParameter="{Binding SelectedItem, ElementName=Workspace}"/>
          </i:EventTrigger>
      </i:Interaction.Triggers>
  </TabControl> 
```

## 编辑2：

4.  如何避免修改 ViewModel 中的视图并从同一个视图（ContenControl、Header、Context）发送必要的参数

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T08:10:38.067

我会创建一个 ViewModelContainer，它对您的每个视图模型（例如 MainViewModel、Tab1ViewModel、Tab2ViewModel）都有一个属性。您可以将 ViewModelContainer 绑定为 Window 的 DataContext，并以这种方式将每个 TabItem DataContext 绑定到正确的 VM 对象 DataContext="{Binding Tab1ViewModel}"

没有对问题 2 的建议。

**更新**

您的代码没有 100% 遵循 MVVM。您的命令编辑视图和视图模型。如果您想费力，该命令必须仅与 viewmodel 交互。然后，视图模型将发出信号（通过 ObservableCollection 或 INotifyPropertyChanged 接口）将通过添加新 tabItem 来回复的视图。我想 View 部分可以使用 XAML 100% 管理，使用 ItemTemplate 来定义面板的显示方式。

# sql-server-2008 - 为什么我让数据提供者或其他服务返回 E_FAIL 状态？SQL 本机客户端

> ID：10404315
> 
> 赞同：3
> 
> 时间：2012-05-01T21:02:49.190
> 
> 标签：sql-server-2008, asp-classic, vbscript, ado

我将我们的 ASP 代码切换为使用 SQL Native Client，以便我们可以连接到具有故障转移伙伴的镜像数据库，因为您只能在 SQL Native Client 中提供故障转移伙伴参数。当我运行一个返回带有 Driver={SQL Server} 的 nvarchar(max) 列的过程时，一切正常。当我使用 Driver={SQL Server Native Client 10.0} 运行返回小列的 procs 时，它工作正常。只有当我尝试运行一个在使用 Driver={SQL Server Native Client 10.0} 时返回 nvarchar(max) 列的 proc 时；我得到了错误。一旦我们点击，错误就会发生

```
rs.Open cmdTemplate 
```

所以我什至没有提到专栏。像这样设置 conn 字符串：

```
if bUseSQLNative then
        connString = "Driver={SQL Server Native Client 10.0}; Network=DBMSSOCN; server=" & rs("SERVER_NAME") & "," & rs("PORT_NUM") & ";database=" & rs("DATABASE_NAME")
        connString = connString & ";uid=" & rs("USER_NAME") & ";pwd=" & UnProtectValueEx(ConnSaltForDBPwd(), rs("CONNECTION_NAME"), rs("PASSWORD"))
    else
        connString = "Driver={SQL Server}; Network=DBMSSOCN; server=" & rs("SERVER_NAME") & "," & rs("PORT_NUM") & ";database=" & rs("DATABASE_NAME")
        connString = connString & ";uid=" & rs("USER_NAME") & ";password=" & UnProtectValueEx(ConnSaltForDBPwd(), rs("CONNECTION_NAME"), rs("PASSWORD"))
    end if 
    connString = connString & ";" 
```

并像这样打开：

```
set rs = server.CreateObject("ADODB.RecordSet")
rs.CursorLocation = 3
rs.CursorType = 3
rs.CacheSize = 50

on error resume next
    rs.Open cmdTemplate 
```

错误是：Microsoft 光标引擎 (0x800A0001) 数据提供程序或其他服务返回 E_FAIL 状态。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T23:37:44.230

就我而言，要保存的数据（字符串）大于指定的 nvarchr()。增加字段大小解决了这个问题

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T16:19:58.573

我找到了。我不得不使用

```
connString = "Provider=SQLNCLI10; DataTypeCompatibility=80;... 
```

DataTypeCompatibility 使 nvarchar max 等映射回 ado 可以处理的格式。并且由于某种原因，该参数对 Driver={SQL Server Native Client 10.0}; 不起作用，仅对 Provider=SQLNCLI10 生效

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-27T09:59:30.767

使用参考 MSADO 6.1 库，然后构建数据环境连接到数据库并建立要使用的记录集，如下所示：

```
 mydata = is a data environment with the connection to the database
 getItemRec = is the query or command inside the mydata
 myRecSet = is a Recordset Variable. 
```

像这样执行代码：

```
 myData.Commands("getItemRec").CommandText = "Select * from myTable"
 myData.getItemRec

 Set myRecSet = myData.rsgetItemRec

 With myRecSet       
      If .RecordCount <> 0 Then .MoveNext
      Do While .EOF = False
            ....
            ....
          .movenext
      Loop
 end With 
```

希望这会有所帮助。

# linux - 作业：如何使用 bash shell 记录用于审计的进程？

> ID：10404318
> 
> 赞同：6
> 
> 时间：2012-05-01T21:02:56.180
> 
> 标签：linux, bash

我对 linux 很陌生，对新手的问题感到抱歉。我有一个家庭作业额外学分问题，我试图做但没有得到它。

> Q. 编写一个安全 shell 脚本，记录每个进程的以下信息：用户 ID、开始时间、结束时间（如果进程仍在运行，则为 0）、进程是否尝试访问安全文件（存储为 yes 或 no ) 创建的日志称为 process_security_log，其中上述每条信息都存储在单独的行中，并且每个条目都紧随其后（即没有空行）。编写一个 shell 脚本来检查这个日志并输出任何仍在运行并试图访问安全文件的进程的用户 ID。

我首先尝试捕获用户并回显它，但失败了。

```
output=`ps -ef | grep [*]`
set -- $output
User=$1
echo $User 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T02:45:48.767

的输出`ps`既不充分，也无法产生该问题所需的数据。

您需要像 auditd、SELinux 或直接内核 hack（即 fork.c）之类的东西来远程执行安全日志记录领域的任何事情。

**更新**

其他人提出了使用 shell 命令日志记录`ps`和朋友（proc 或 sysfs）的建议。它们可能很有用，并且确实有它们的位置（显然）。我认为*不应*为此目的而依赖它们，尤其是在教育背景下。

> ...进程是否尝试访问安全文件（存储为是或否）

似乎是其他答案忽略的那个。我坚持我最初的答案，但正如丹尼尔指出的那样，还有其他有趣的方法可以装饰这些数据。

*   [系统点击](http://sourceware.org/systemtap/wiki)
*   [首选项](https://perf.wiki.kernel.org/index.php/Main_Page)
*   [LTng](http://lttng.org/)

对于教育练习，这些工具将有助于提供更完整的答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-04T05:42:54.547

看看[/proc 伪文件系统](http://www.kernel.org/doc/man-pages/online/pages/man5/proc.5.html)。

在此内部，每个当前正在运行的进程都有一个子目录 - 进程 [pid] 在 /proc/[pid]/ 中提供其信息。在该目录中，您可以使用 /prod/[pid]/stat/ 或 /proc/[pid]/status 来获取有关哪个用户启动进程以及何时启动的信息。

我不确定“安全文件”的分配是什么意思，但是如果您有某种方法可以确定哪些文件是安全的，您可以通过 /prod/[pid]/fd 获得有关打开文件（包括它们的名称）的信息/ 和 /prod/[pid]/fdinfo。

/proc 是否足以用于真正的安全日志记录？不，但是 /proc 足以获取有关系统上当前正在运行哪些进程的信息，这可能是您完成有关 shell 脚本的家庭作业所需要的。此外，在这个类之外，您可能会发现 /proc 稍后可用于其他目的，例如查看进程的映射页面。如果您正在编写堆栈跟踪实用程序或想知道它们是如何工作的，或者您正在调试使用内存映射文件的代码，这可能会派上用场。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-04T05:32:14.573

由于这是家庭作业，我假设该场景不是真实世界的场景，而只是一个学习练习。shell 并不是真正适合进行安全审计或[进程记帐](http://www.gnu.org/software/acct/)的地方。但是，这里有一些提示可以帮助您了解在 shell 提示符下*可以执行的操作。*

1.  您可以设置 bash PROMPT_COMMAND 来记录您的进程。
2.  您可以`tail`或`grep`您的命令历史记录用于日志记录。
3.  您可以使用`/usr/bin/script`（通常在 bsdutils 包中找到）来创建会话的打字稿。
4.  您可以`ps`使用子shell 或实用程序循环运行`watch`，以查看当前正在运行的进程。
5.  您可以更轻松地使用`pidof`或查找进程。`pgrep`
6.  您可以修改您的 .bashrc 或其他 shell 启动文件来设置您的环境或启动您的日志记录工具。

作为一个起点，你可能会从一些像这样微不足道的事情开始：

```
$ export PROMPT_COMMAND='history | tail -n1'
 56 export PROMPT_COMMAND='history | tail -n1'
$ ls /etc/passwd
/etc/passwd
 57 ls /etc/passwd 
```

并构建您认为必要的任何其他日志记录数据或过程信息。希望这能让你指出正确的方向！

# ios - iOS - 同时运行多个异步请求

> ID：10404319
> 
> 赞同：2
> 
> 时间：2012-05-01T21:02:58.520
> 
> 标签：ios, asynchronous, nsmutableurlrequest

我是一名初级 iOS 开发人员，在我的第一个应用程序中，我想为我的视图控制器加载数据，但问题是数据来自三个不同的 Web 服务。我`NSMutableRequest`试图实现这个功能。

我想要做的是同时发出三个加载数据的请求，当最后一个完成时，删除活动指示器。

我尝试使用 NSOperationQueue，但使用 async 它不执行`didReceiveData`or`didFailWithError`方法。如果您需要更多详细信息或解释，请发表评论（我的英语不是很好）。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T21:10:36.100

我会查看 GCD，并创建 1 个同步请求，其中包含对 Web 服务的 3 个异步请求。这样，您就可以让 GCD 完成等待每个异步操作完成的工作。WWDC（Apple 的开发者大会）上有一些关于 iTunes 的非常好的视频，它们对 GCD 提供了令人难以置信的信息。

# sql - 获取 SQL 中字符串中范围和逗号分隔项的计数

> ID：10404328
> 
> 赞同：0
> 
> 时间：2012-05-01T21:03:38.677
> 
> 标签：sql, string, count, sql-server-2008-r2

在 SQL SERVER 2008 R2 中，我需要获取包含在字符串中的项目计数，该字符串可以具有以下任何特征（由用户而不是系统控制）：

*   每个项目用逗号分隔
*   由短划线分隔的第一个和最后一个项目汇总的顺序项目
*   仅附加到破折号分隔范围中的第一项的非增量字符
*   表示指定的非增量部分的多个字符
*   以上结合

以下所有情况都是可能的：

*   R1,R2,R3,R4
*   R1-R4
*   R1-4
*   CP10-CP12
*   R1,R15-R19,RN5

如果它们都是逗号分隔的，我可以数逗号 +1，但这实际上不如其他选项常见。

计算最后一个选项的方法应该适用于所有选项。结果应该是 7

我预期的方法是：

1.  没有破折号但用逗号分隔的项目=>获取计数
2.  隔离破折号分隔的项目并删除非增量字符
3.  从较大的数字中减去较小的数字并加1
4.  将该数字添加到第一个数字以获得总计数

我完全坚持甚至从哪里开始。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T21:42:02.593

您可以使用一个技巧来计算逗号分隔列表中的逗号数：

```
select len(str) - len(replace(str, ',', '') 
```

对于完整的解决方案，您需要做一些更复杂的事情。很久以前，我下载了一个名为 split 的函数，它接受一个分隔字符串并返回组件，就好像它是一个表一样。事实上，看起来我是从这里捡来的。. . [T-SQL：与字符串连接相反 - 如何将字符串拆分为多条记录](https://stackoverflow.com/questions/314824/t-sql-opposite-to-string-concatenation-how-to-split-string-into-multiple-reco)。

因此，想法是拆分字符串，然后解析要计数的组件。如果没有连字符，则数“1”。如果有连字符，则需要解析字符串以获取计数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T22:13:07.010

这可以清理/优化，并且故意冗长，但应该让你开始。值得注意的是，最后一个 IF 内部的逻辑几乎与 WHILE 的逻辑相同，并且获取左/右元素数值的块重复了四次。

```
declare @input varchar(max)
set @input = 'R1,R15-R19,RN5-RN6'

select @input

declare @elements table
(
    Element varchar(10),
    [Count] int
)

declare @element varchar(10)
declare @index int
declare @count int
declare @left varchar(10)
declare @right varchar(10)
declare @position int

while (len(@input) > 0 and charindex(',', @input) > 0)
begin
    set @element = substring(@input, 0, charindex(',', @input))
    if (charindex('-', @element) > 0)
    begin
        set @index = charindex('-', @element)
        set @left = left(@element, @index - 1)
        set @right = substring(@element, @index + 1, len(@element) - len(@left))

        set @position = 0
        while (isnumeric(substring(@left, @position, 1)) = 0)
        begin
            set @position = @position + 1
        end
        set @left = substring(@left, @position, len(@left))

        set @position = 0
        while (isnumeric(substring(@right, @position, 1)) = 0)
        begin
            set @position = @position + 1
        end
        set @right = substring(@right, @position, len(@right))

        set @count = cast(@right as int) - cast(@left as int) + 1
    end
    else
    begin
        set @count = 1
    end
    insert into @elements select @element, @count
    set @input = replace(@input, @element + ',', '')
end

if (len(@input) > 0)
begin
    set @element = @input
    if (charindex('-', @element) > 0)
    begin
        set @index = charindex('-', @element)
        set @left = left(@element, @index - 1)
        set @right = substring(@element, @index + 1, len(@element) - len(@left))

        set @position = 0
        while (isnumeric(substring(@left, @position, 1)) = 0)
        begin
            set @position = @position + 1
        end
        set @left = substring(@left, @position, len(@left))

        set @position = 0
        while (isnumeric(substring(@right, @position, 1)) = 0)
        begin
            set @position = @position + 1
        end
        set @right = substring(@right, @position, len(@right))

        set @count = cast(@right as int) - cast(@left as int) + 1
    end
    else
    begin
        set @count = 1
    end
    insert into @elements select @element, @count
end

select * from @elements
select sum([Count]) from @elements 
```

输出以下结果：

```
R1,R15-R19,RN5-RN6

R1      1
R15-R19 5
RN5-RN6 2

8 
```

# asp.net - 带有 ContentTemplate 的 Telerik RadButton 不显示单选按钮

> ID：10404336
> 
> 赞同：0
> 
> 时间：2012-05-01T21:04:13.013
> 
> 标签：asp.net, telerik

我使用以下代码创建了两个单选按钮：

```
<telerik:RadButton ID="rbOption1" runat="server" Text="option 1" ToggleType="Radio"
    GroupName="group1" ButtonType="ToggleButton" />
<br />
<telerik:RadButton ID="rbOption2" runat="server" ToggleType="Radio"
    GroupName="group1" ButtonType="ToggleButton">
    <ContentTemplate>
        <asp:Label ID="lblChoose" runat="server" Text="choose" />
        <asp:DropDownList ID="ddlChoose" runat="server" />
    </ContentTemplate>
</telerik:RadButton> 
```

我希望第二个 radbutton 与第一个 radbutton 的单选按钮一起呈现。但相反，内容模板的全部内容被呈现为 html 锚点，并且没有显示第二个 radbutton 的单选按钮。有没有办法使用 Telerik radbutton 看起来像这个模型？

![在此处输入图像描述](../Images/38522ff8fff2b6272184b79c920346c9.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T08:34:04.813

**当通过ContentTemplate**内部属性指定 RadButton 的内容时，按钮控件将自动配置为**LinkBut** ​​ton模式。

所需的功能可以通过两个 RadButton 来实现，配置为单选按钮 (ToggleType="Radio" ButtonType="ToggleButton") 和一个 DropDownList 控件，只有在选中其中一个单选按钮时才能启用：

页

```
<telerik:RadButton ID="rbOption1" runat="server" Text="option 1" ToggleType="Radio"
    GroupName="group1" ButtonType="ToggleButton" />
<br />
<telerik:RadButton ID="rbOption2" runat="server" Text="choose" ToggleType="Radio"
    GroupName="group1" ButtonType="ToggleButton" />
<asp:DropDownList ID="ddlChoose" runat="server" Enabled="false">
    <asp:ListItem Text="Text" Value="Value"></asp:ListItem>
    <asp:ListItem Text="Text" Value="Value"></asp:ListItem>
</asp:DropDownList>
<br /> 
```

代码隐藏

```
protected void Page_Load(object sender, EventArgs e)
{
    ddlChoose.Enabled = rbOption2.Checked;
} 
```

# wpf - RichTextBox 删除未知标签

> ID：10404337
> 
> 赞同：1
> 
> 时间：2012-05-01T21:04:18.430
> 
> 标签：wpf, .net-3.5, richtextbox, rtf

我正在使用 Richtextbox 显示使用 MS Word 创建的 rtf 文档我需要显示文档的内容，例如 MS Word 中的“文档架构”，它通过使用样式标签“\s [样式数]”创建架构我有一个问题，当我在富文本框中加载我的文件时发生。尝试获取 RTF 文本仅返回已知标签，忽略所有未知标签。我使用以下代码加载文件

```
MemoryStream stream = new MemoryStream(Encoding.Default.GetBytes(file));
rtbViewer.Selection.Load(stream,DataFormats.Rtf);
stream.Close(); 
```

我已经设法通过输入字符串文件的正则表达式搜索来制作内容。我获取源文件并在字符串中获取其文本（它将包含所有 rtf 标签），然后搜索样式标签并获取有关级别和文本的信息。只要用户不更改文本然后尝试保存它，一切都很好。问题是当我在richtextbox 中加载文件时，我错过了有关内容的所有信息。当我尝试保存更改的文档时，我从richtextbox 获取 Rtf 文本，但它不包含样式标签。

```
MemoryStream ms = new MemoryStream();
rtbViewer.Selection.Save(ms, DataFormats.Rtf); 
```

如何从源文件中获取所有标签？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-10-18T23:22:15.007

这对我有用。

```
<RichTextBox Height="100" HorizontalAlignment="Left" Margin="306,30,0,0" Name="rtfMain"        VerticalAlignment="Top" Width="200" />

rtfMain.Selection.Load(new FileStream(@"C:\temp\document.rtf", FileMode.Open), DataFormats.Rtf); 
```

# nfs - 强制关闭其他人打开的 NFS 上的文件

> ID：10404339
> 
> 赞同：1
> 
> 时间：2012-05-01T21:04:30.313
> 
> 标签：nfs

任何方式都可以在您不必成为管理员的 Linux 或 Windows 上完成？也许如果您是文件的所有者，您应该能够在文件被其他人打开时强制关闭它？

编辑：我不是在寻找一种在两者上都做到这一点的方法，总体而言，最好的方法就是我所追求的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T20:01:06.443

我相信没有办法强迫客户关闭文件。NFS v2 和 v3 甚至没有像 OPEN 和 CLOSE 这样的操作。使用 v4.1 服务器可能会从客户端调用文件布局，但没有管理命令可以触发它。IOW，你不能这样做。

# c - 复制结构时没有得到正确的值

> ID：10404342
> 
> 赞同：1
> 
> 时间：2012-05-01T21:04:45.663
> 
> 标签：c, pointers, struct, binary

保存二进制数据块的缓冲区应该被复制到结构数组（每个结构代表一个块），缓冲区中的每个块是 20 个字节，前 4 个字节保存哈希值，然后 8 个字节用于偏移信息，然后是 8 的大小：

这就是结构定义：

```
typedef struct{
  khint_t hash; // 4                                                                                                                                                               
  long int offset_start; // 8                                                                                                                                                      
  size_t size; // 8                                                                                                                                                                
} header_offset, *offset_p; 
```

以下是应该执行上述操作的代码：

```
 offset_p *offsets;
  size_t s= HEADER_OFFSET_SIZE;

  header_offset t_offsets[n_files];                                                                                       

  for (i=0; i< n_files; i++){
    memcpy(&t_offsets[i].hash, buff, sizeof(khint_t));
    buff+= sizeof(khint_t);
    memcpy(&t_offsets[i].offset_start, buff, sizeof(long int));
    buff+= sizeof(long int);
    memcpy(&t_offsets[i].size, buff, sizeof(size_t));
    buff+= sizeof(size_t);

    printf("hash read: %p\n", t_offsets[i].hash);
    printf("offset start read: %p\n", t_offsets[i].offset_start);
    printf("offset size read: %p\n", t_offsets[i].size);
  }

  memmove(offsets, t_offsets, sizeof(header_offset)*n_files);

  buff-= s*n_files;
  free(buff);                                                                                                                                                                  

  return offsets; 
```

我正在努力将块直接复制到 header_p* 所以我决定有一个从缓冲区复制的临时结构数组，然后被复制到 header_p*，如果你能给我提供一种方法，我会更加感激在不使用临时结构数组的情况下执行此操作。

printfs 打印正确的数据，尽管在调用此函数时，返回的指针数组不包含正确的数据，或循环中打印的相同数据。

我想知道，没有进一步的代码，我使用指针的方式是否会导致 offset_p 的数组不保持正确的值。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T21:08:45.433

没有为分配内存`offsets`，`memmove()`不为您分配内存：

~~header_offset* 偏移量 = malloc(sizeof(header_offset)*n_files);~~

鉴于您正在分配要返回的内存，`t_offsets`因此不需要使用：只需`offsets`直接填充即可。

编辑：

要返回 a`header_offset*[]`评论的[alk](https://stackoverflow.com/users/694576/alk)：

```
header_offset** offsets = malloc(sizeof(header_offset*) * n_files);
for (i=0; i< n_files; i++){
    *(offsets + i) = malloc(sizeof(header_offset));
    ...
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-01T21:16:08.413

`offsets`*应该是指针*数组，而不是结构。

memcopy 可能会覆盖分配给它的内存末尾之后的一大块内存`offsets`（尽管我们看不到为它分配了多少内存）。

我建议：

```
offset_p *offsets = (offset_p*)malloc(sizeof(offset_p)*n_files); 
```

然后是一个循环

```
for (i=0; i< n_files; i++){
    offsets[i] = malloc(sizeof(header_offset));
    memcpy(&(*offsets[i]).hash, buff, sizeof(khint_t));
    buff+= sizeof(khint_t);

    memcpy(&(*offsets[i]).offset_start, buff, sizeof(long int));
    buff+= sizeof(long int);

    memcpy(&(*offsets[i]).size, buff, sizeof(size_t));
    buff+= sizeof(size_t);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T21:21:24.607

要返回指向`header_offset`数组本身的指针数组，需要分配（然后由 引用`offset_p *offsets;` ）以及保存临时结构当前保存的数据的内存。然后后者将被 . 持有的指针引用`offsets`。

# php - 创建 WP 博客存档 - date rage .htaccess

> ID：10404345
> 
> 赞同：1
> 
> 时间：2012-05-01T21:04:53.853
> 
> 标签：php, regex, wordpress, .htaccess

根据下面的重定向，我怎样才能让它从 2007-2010 重定向？

```
 RedirectMatch 301 ^/2010/([0-9]+)/(.*)$ http://archive.website.com/2010/$1/$2 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T05:37:07.337

你可以试试：

```
 RedirectMatch 301 ^/(200[7-9]|2010)/([0-9]+)/(.*)$ http://archive.website.com/$1/$2/$3 
```

# php - ImageJpeg() - 需要资源，给定字符串

> ID：10404347
> 
> 赞同：0
> 
> 时间：2012-05-01T21:05:07.490
> 
> 标签：php, gd, nsdata

如何将 NSData（从 iOS 设备接收）写入 PHP 中的文件路径？

我尝试了以下方法，但收到有关格式的警告

> imagejpeg() 期望参数 1 是资源，给定字符串

请你能告诉我哪里出错了吗？

```
function store_question_image($blob) {
    $blob = 'ffd8ffe000104a46494600010201004800480000f....'; //9975 chars
    $filepath = "localhost/citw/img/questions/{$qid}/attachment.png";
    return imagejpeg($blob, $filepath);

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T21:09:06.587

imagejpeg() 获取一个 GD 资源句柄（又名 GD 图像的内存表示）并将其写为 jpeg。你有某种看起来像base64数据（？）的东西。

您可以使用`imagecreatefromstring($blob)`将该文本转换为 GD 句柄，但首先您必须将该文本转换为图像数据的实际原始二进制字节，而不是 GD 不知道如何处理的这种编码格式。

# sql - SQL Server 动态 PIVOT 查询？

> ID：10404348
> 
> 赞同：233
> 
> 时间：2012-05-01T21:05:07.637
> 
> 标签：sql, sql-server, tsql, pivot

我的任务是想出一种翻译以下数据的方法：

```
date        category        amount
1/1/2012    ABC             1000.00
2/1/2012    DEF             500.00
2/1/2012    GHI             800.00
2/10/2012   DEF             700.00
3/1/2012    ABC             1100.00 
```

进入以下：

```
date        ABC             DEF             GHI
1/1/2012    1000.00
2/1/2012                    500.00
2/1/2012                                    800.00
2/10/2012                   700.00
3/1/2012    1100.00 
```

空白点可以是 NULL 或空白，两者都可以，并且类别需要是动态的。另一个可能的警告是，我们将以有限的容量运行查询，这意味着临时表已用完。我已经尝试过研究并且已经登陆，`PIVOT`但是因为我从来没有使用过它，所以我真的不明白它，尽管我尽了最大的努力来弄清楚它。谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：292
> 
> 时间：2012-05-01T21:13:29.113

动态 SQL PIVOT：

```
create table temp
(
    date datetime,
    category varchar(3),
    amount money
)

insert into temp values ('1/1/2012', 'ABC', 1000.00)
insert into temp values ('2/1/2012', 'DEF', 500.00)
insert into temp values ('2/1/2012', 'GHI', 800.00)
insert into temp values ('2/10/2012', 'DEF', 700.00)
insert into temp values ('3/1/2012', 'ABC', 1100.00)

DECLARE @cols AS NVARCHAR(MAX),
    @query  AS NVARCHAR(MAX);

SET @cols = STUFF((SELECT distinct ',' + QUOTENAME(c.category) 
            FROM temp c
            FOR XML PATH(''), TYPE
            ).value('.', 'NVARCHAR(MAX)') 
        ,1,1,'')

set @query = 'SELECT date, ' + @cols + ' from 
            (
                select date
                    , amount
                    , category
                from temp
           ) x
            pivot 
            (
                 max(amount)
                for category in (' + @cols + ')
            ) p '

execute(@query)

drop table temp 
```

结果：

```
Date                        ABC         DEF    GHI
2012-01-01 00:00:00.000     1000.00     NULL    NULL
2012-02-01 00:00:00.000     NULL        500.00  800.00
2012-02-10 00:00:00.000     NULL        700.00  NULL
2012-03-01 00:00:00.000     1100.00     NULL    NULL 
```

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2016-07-21T13:18:07.310

## 动态 SQL PIVOT

创建列字符串的不同方法

```
create table #temp
(
    date datetime,
    category varchar(3),
    amount money
)

insert into #temp values ('1/1/2012', 'ABC', 1000.00)
insert into #temp values ('2/1/2012', 'DEF', 500.00)
insert into #temp values ('2/1/2012', 'GHI', 800.00)
insert into #temp values ('2/10/2012', 'DEF', 700.00)
insert into #temp values ('3/1/2012', 'ABC', 1100.00)

DECLARE @cols  AS NVARCHAR(MAX)='';
DECLARE @query AS NVARCHAR(MAX)='';

SELECT @cols = @cols + QUOTENAME(category) + ',' FROM (select distinct category from #temp ) as tmp
select @cols = substring(@cols, 0, len(@cols)) --trim "," at end

set @query = 
'SELECT * from 
(
    select date, amount, category from #temp
) src
pivot 
(
    max(amount) for category in (' + @cols + ')
) piv'

execute(@query)
drop table #temp 
```

结果

```
date                    ABC     DEF     GHI
2012-01-01 00:00:00.000 1000.00 NULL    NULL
2012-02-01 00:00:00.000 NULL    500.00  800.00
2012-02-10 00:00:00.000 NULL    700.00  NULL
2012-03-01 00:00:00.000 1100.00 NULL    NULL 
```

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2017-07-12T18:58:22.660

我知道这个问题比较老，但我一直在寻找答案，并认为我可以扩展问题的“动态”部分并可能帮助某人。

首先，我构建这个解决方案是为了解决几个同事遇到的一个问题，即需要快速转换的不稳定和大型数据集。

这个解决方案需要创建一个存储过程，所以如果这对您的需要来说是不可能的，请立即停止阅读。

此过程将采用数据透视语句的关键变量，为不同的表、列名和聚合动态创建数据透视语句。静态列用作枢轴的分组依据/身份列（如果不需要，可以从代码中删除，但在枢轴语句中很常见并且是解决原始问题所必需的），枢轴列是最终结果列名将从中生成，值列是聚合将应用于的内容。Table 参数是包含模式 (schema.tablename) 的表的名称，这部分代码可以使用一些爱，因为它不像我希望的那样干净。它对我有用，因为我的使用不是公开的，而且 sql 注入不是问题。

让我们从创建存储过程的代码开始。此代码应该适用于所有版本的 SSMS 2005 及更高版本，但我没有在 2005 或 2016 年对其进行测试，但我不明白为什么它不起作用。

```
create PROCEDURE [dbo].[USP_DYNAMIC_PIVOT]
    (
        @STATIC_COLUMN VARCHAR(255),
        @PIVOT_COLUMN VARCHAR(255),
        @VALUE_COLUMN VARCHAR(255),
        @TABLE VARCHAR(255),
        @AGGREGATE VARCHAR(20) = null
    )

AS

BEGIN

SET NOCOUNT ON;
declare @AVAIABLE_TO_PIVOT NVARCHAR(MAX),
        @SQLSTRING NVARCHAR(MAX),
        @PIVOT_SQL_STRING NVARCHAR(MAX),
        @TEMPVARCOLUMNS NVARCHAR(MAX),
        @TABLESQL NVARCHAR(MAX)

if isnull(@AGGREGATE,'') = '' 
    begin
        SET @AGGREGATE = 'MAX'
    end

 SET @PIVOT_SQL_STRING =    'SELECT top 1 STUFF((SELECT distinct '', '' + CAST(''[''+CONVERT(VARCHAR,'+ @PIVOT_COLUMN+')+'']''  AS VARCHAR(50)) [text()]
                            FROM '+@TABLE+'
                            WHERE ISNULL('+@PIVOT_COLUMN+','''') <> ''''
                            FOR XML PATH(''''), TYPE)
                            .value(''.'',''NVARCHAR(MAX)''),1,2,'' '') as PIVOT_VALUES
                            from '+@TABLE+' ma
                            ORDER BY ' + @PIVOT_COLUMN + ''

declare @TAB AS TABLE(COL NVARCHAR(MAX) )

INSERT INTO @TAB EXEC SP_EXECUTESQL  @PIVOT_SQL_STRING, @AVAIABLE_TO_PIVOT 

SET @AVAIABLE_TO_PIVOT = (SELECT * FROM @TAB)

SET @TEMPVARCOLUMNS = (SELECT replace(@AVAIABLE_TO_PIVOT,',',' nvarchar(255) null,') + ' nvarchar(255) null')

SET @SQLSTRING = 'DECLARE @RETURN_TABLE TABLE ('+@STATIC_COLUMN+' NVARCHAR(255) NULL,'+@TEMPVARCOLUMNS+')  
                    INSERT INTO @RETURN_TABLE('+@STATIC_COLUMN+','+@AVAIABLE_TO_PIVOT+')

                    select * from (
                    SELECT ' + @STATIC_COLUMN + ' , ' + @PIVOT_COLUMN + ', ' + @VALUE_COLUMN + ' FROM '+@TABLE+' ) a

                    PIVOT
                    (
                    '+@AGGREGATE+'('+@VALUE_COLUMN+')
                    FOR '+@PIVOT_COLUMN+' IN ('+@AVAIABLE_TO_PIVOT+')
                    ) piv

                    SELECT * FROM @RETURN_TABLE'

EXEC SP_EXECUTESQL @SQLSTRING

END 
```

接下来，我们将为示例准备好数据。我从已接受的答案中获取了数据示例，并添加了几个数据元素以在此概念证明中使用，以显示聚合更改的各种输出。

```
create table temp
(
    date datetime,
    category varchar(3),
    amount money
)

insert into temp values ('1/1/2012', 'ABC', 1000.00)
insert into temp values ('1/1/2012', 'ABC', 2000.00) -- added
insert into temp values ('2/1/2012', 'DEF', 500.00)
insert into temp values ('2/1/2012', 'DEF', 1500.00) -- added
insert into temp values ('2/1/2012', 'GHI', 800.00)
insert into temp values ('2/10/2012', 'DEF', 700.00)
insert into temp values ('2/10/2012', 'DEF', 800.00) -- addded
insert into temp values ('3/1/2012', 'ABC', 1100.00) 
```

以下示例显示了不同的执行语句，将不同的聚合显示为一个简单的示例。我没有选择更改静态、数据透视和值列以保持示例简单。您应该能够复制并粘贴代码以自己开始弄乱它

```
exec [dbo].[USP_DYNAMIC_PIVOT] 'date','category','amount','dbo.temp','sum'
exec [dbo].[USP_DYNAMIC_PIVOT] 'date','category','amount','dbo.temp','max'
exec [dbo].[USP_DYNAMIC_PIVOT] 'date','category','amount','dbo.temp','avg'
exec [dbo].[USP_DYNAMIC_PIVOT] 'date','category','amount','dbo.temp','min' 
```

此执行分别返回以下数据集。

[![在此处输入图像描述](../Images/ba155add460a779bf4cdf514d7cf4f5a.png)](https://i.stack.imgur.com/jY0zh.png)

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2019-01-24T16:22:29.040

使用 STRING_AGG 函数构造数据透视列列表的 SQL Server 2017 更新版本：

```
create table temp
(
    date datetime,
    category varchar(3),
    amount money
);

insert into temp values ('20120101', 'ABC', 1000.00);
insert into temp values ('20120201', 'DEF', 500.00);
insert into temp values ('20120201', 'GHI', 800.00);
insert into temp values ('20120210', 'DEF', 700.00);
insert into temp values ('20120301', 'ABC', 1100.00);

DECLARE @cols AS NVARCHAR(MAX),
    @query  AS NVARCHAR(MAX);

SET @cols = (SELECT STRING_AGG(category,',') FROM (SELECT DISTINCT category FROM temp WHERE category IS NOT NULL)t);

set @query = 'SELECT date, ' + @cols + ' from 
            (
                select date
                    , amount
                    , category
                from temp
           ) x
            pivot 
            (
                 max(amount)
                for category in (' + @cols + ')
            ) p ';

execute(@query);

drop table temp; 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-05-01T21:11:07.267

您可以使用动态 TSQL 实现此目的（请记住使用 QUOTENAME 以避免 SQL 注入攻击）：

[SQL Server 2005 中具有动态列的数据透视](http://www.simple-talk.com/community/blogs/andras/archive/2007/09/14/37265.aspx)

[SQL Server - 动态数据透视表 - SQL 注入](https://stackoverflow.com/questions/1439403/sql-server-dynamic-pivot-table-sql-injection)

必须参考[动态 SQL 的诅咒和祝福](http://www.sommarskog.se/dynamic_sql.html)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2015-12-21T15:09:37.530

我的解决方案是清理不必要的空值

```
DECLARE @cols AS NVARCHAR(MAX),
@maxcols AS NVARCHAR(MAX),
@query  AS NVARCHAR(MAX)

select @cols = STUFF((SELECT ',' + QUOTENAME(CodigoFormaPago) 
                from PO_FormasPago
                order by CodigoFormaPago
        FOR XML PATH(''), TYPE
        ).value('.', 'NVARCHAR(MAX)') 
    ,1,1,'')

select @maxcols = STUFF((SELECT ',MAX(' + QUOTENAME(CodigoFormaPago) + ') as ' + QUOTENAME(CodigoFormaPago)
                from PO_FormasPago
                order by CodigoFormaPago
        FOR XML PATH(''), TYPE
        ).value('.', 'NVARCHAR(MAX)')
    ,1,1,'')

set @query = 'SELECT CodigoProducto, DenominacionProducto, ' + @maxcols + '
            FROM
            (
                SELECT 
                CodigoProducto, DenominacionProducto,
                ' + @cols + ' from 
                 (
                    SELECT 
                        p.CodigoProducto as CodigoProducto,
                        p.DenominacionProducto as DenominacionProducto,
                        fpp.CantidadCuotas as CantidadCuotas,
                        fpp.IdFormaPago as IdFormaPago,
                        fp.CodigoFormaPago as CodigoFormaPago
                    FROM
                        PR_Producto p
                        LEFT JOIN PR_FormasPagoProducto fpp
                            ON fpp.IdProducto = p.IdProducto
                        LEFT JOIN PO_FormasPago fp
                            ON fpp.IdFormaPago = fp.IdFormaPago
                ) xp
                pivot 
                (
                    MAX(CantidadCuotas)
                    for CodigoFormaPago in (' + @cols + ')
                ) p 
            )  xx 
            GROUP BY CodigoProducto, DenominacionProducto'

t @query;

execute(@query); 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2017-02-27T15:29:17.387

下面的代码提供了在输出中将 NULL 替换为零**的****结果**。

**表创建和数据插入：**

```
create table test_table
 (
 date nvarchar(10),
 category char(3),
 amount money
 )

 insert into test_table values ('1/1/2012','ABC',1000.00)
 insert into test_table values ('2/1/2012','DEF',500.00)
 insert into test_table values ('2/1/2012','GHI',800.00)
 insert into test_table values ('2/10/2012','DEF',700.00)
 insert into test_table values ('3/1/2012','ABC',1100.00) 
```

查询以生成确切的结果，该结果也将 NULL 替换为零：

```
DECLARE @DynamicPivotQuery AS NVARCHAR(MAX),
@PivotColumnNames AS NVARCHAR(MAX),
@PivotSelectColumnNames AS NVARCHAR(MAX)

--Get distinct values of the PIVOT Column
SELECT @PivotColumnNames= ISNULL(@PivotColumnNames + ',','')
+ QUOTENAME(category)
FROM (SELECT DISTINCT category FROM test_table) AS cat

--Get distinct values of the PIVOT Column with isnull
SELECT @PivotSelectColumnNames 
= ISNULL(@PivotSelectColumnNames + ',','')
+ 'ISNULL(' + QUOTENAME(category) + ', 0) AS '
+ QUOTENAME(category)
FROM (SELECT DISTINCT category FROM test_table) AS cat

--Prepare the PIVOT query using the dynamic 
SET @DynamicPivotQuery = 
N'SELECT date, ' + @PivotSelectColumnNames + '
FROM test_table
pivot(sum(amount) for category in (' + @PivotColumnNames + ')) as pvt';

--Execute the Dynamic Pivot Query
EXEC sp_executesql @DynamicPivotQuery 
```

**输出 ：**

[![在此处输入图像描述](../Images/89eea070d2ded285238740c76bfa0588.png)](https://i.stack.imgur.com/EVrKN.jpg)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-10-27T11:16:30.357

```
CREATE TABLE #PivotExample(
   [ID]      [nvarchar](50)   NULL,       
   [Description]   [nvarchar](50)   NULL,
   [ClientId]   [smallint] NOT NULL,
)
GO

INSERT   #PivotExample  ([ID],[Description],   [ClientId])   VALUES ('ACI1','ACI1Desc1',1008)
INSERT   #PivotExample  ([ID],[Description],   [ClientId])   VALUES ('ACI1','ACI1Desc2',2000)
INSERT   #PivotExample  ([ID],[Description],   [ClientId])   VALUES ('ACI1','ACI1Desc3',3000)
INSERT   #PivotExample  ([ID],[Description],   [ClientId])   VALUES ('ACI1','ACI1Desc4',4000)
INSERT   #PivotExample  ([ID],[Description],   [ClientId])   VALUES ('ACI2','ACI2Desc1',5000)
INSERT   #PivotExample  ([ID],[Description],   [ClientId])   VALUES ('ACI2','ACI2Desc2',6000)
INSERT   #PivotExample  ([ID],[Description],   [ClientId])   VALUES ('ACI2','ACI2Desc3', 7000)

SELECT * FROM #PivotExample

--Declare necessary variables
DECLARE   @SQLQuery AS NVARCHAR(MAX)
DECLARE   @PivotColumns AS NVARCHAR(MAX)

--Get unique values of pivot column  
SELECT   @PivotColumns= COALESCE(@PivotColumns + ',','') + QUOTENAME([Description])
FROM (SELECT DISTINCT [Description] FROM [dbo].#PivotExample) AS PivotExample

--SELECT   @PivotColumns

--Create the dynamic query with all the values for 
--pivot column at runtime
SET   @SQLQuery = 
    N' -- Your pivoted result comes here
    SELECT ID, ' + @PivotColumns + '
    FROM 
    (
        -- Source table should in a inner query
        SELECT ID,[Description],[ClientId]
        FROM #PivotExample
    )AS P
    PIVOT
    (     
          -- Select the values from derived table P
          SUM(ClientId) 
          FOR [Description] IN (' + @PivotColumns + ') 
    )AS PVTTable'

--SELECT   @SQLQuery
--Execute dynamic query
EXEC sp_executesql @SQLQuery

Drop table #PivotExample 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2022-02-15T06:56:42.990

可以在非传统 MS SQL 环境（例如 Azure Synapse Analytics 无服务器 SQL 池）中工作的完全通用方式 - 它在 SPROC 中，但不需要像这样使用......

```
-- DROP PROCEDURE IF EXISTS
if object_id('dbo.usp_generic_pivot') is not null 
     DROP PROCEDURE dbo.usp_generic_pivot
GO;

CREATE PROCEDURE dbo.usp_generic_pivot (
    @source NVARCHAR (100), -- table or view object name
   @pivotCol NVARCHAR (100), -- the column to pivot
   @pivotAggCol NVARCHAR (100), -- the column with the values for the pivot
   @pivotAggFunc NVARCHAR (20), -- the aggregate function to apply to those values
   @leadCols NVARCHAR (100) -- comma seprated list of other columns to keep and order by
)
AS
BEGIN
   DECLARE @pivotedColumns NVARCHAR(MAX)
   DECLARE @tsql NVARCHAR(MAX)

   SET @tsql = CONCAT('SELECT @pivotedColumns = STRING_AGG(qname, '','') FROM (SELECT DISTINCT QUOTENAME(', @pivotCol,') AS qname FROM ',@source, ') AS qnames')
   EXEC sp_executesql @tsql, N'@pivotedColumns nvarchar(max) out', @pivotedColumns out

   SET @tsql = CONCAT ( 'SELECT ', @leadCols,   ',', @pivotedColumns,' FROM ',' ( SELECT ',@leadCols,',',
         @pivotAggCol,',',   @pivotCol,   ' FROM ',   @source,   ') as t ',
         ' PIVOT (', @pivotAggFunc,   '(', @pivotAggCol,   ')',' FOR ',   @pivotCol,
         '   IN (', @pivotedColumns,')) as pvt ',' ORDER BY ',   @leadCols)

   EXEC (@tsql)

END
GO;

-- TEST EXAMPLE
EXEC dbo.usp_generic_pivot  
    @source  = '[your_db].[dbo].[form_answers]',
   @pivotCol  = 'question', 
   @pivotAggCol   = 'answer',
   @pivotAggFunc  = 'MAX', 
   @leadCols    = 'candidate_id, candidate_name' 
GO; 
```

# events - MATLAB：用drawow刷新事件队列

> ID：10404349
> 
> 赞同：0
> 
> 时间：2012-05-01T21:05:12.317
> 
> 标签：events, matlab

功能[`drawnow`](http://www.mathworks.com/help/techdoc/ref/drawnow.html)

> 导致图形窗口及其子窗口更新，并刷新系统事件队列。`drawnow`由传入事件（例如，鼠标或键事件）生成的任何回调在返回之前被调度。

我有以下脚本：

```
clear all;
clc;

t = timer;
set(t, 'Period', 1);
set(t, 'ExecutionMode', 'fixedSpacing');
set(t, 'TimerFcn', @(event, data) disp('Timer rollover!'));

start(t);

while(1)
    %# do something interesting
    drawnow;
end 
```

`drawnow`就位后，定时器事件将每秒发生一次。没有它，不会发生回调函数，因为`while`循环是“阻塞”的。

我的问题：

1）有没有办法在不更新图形窗口的情况下刷新队列？

2）当我们说“刷新事件队列”时，我们的意思是“执行事件队列中的所有内容”，“执行队列中的下一个并将其他所有内容从队列中删除”，还是完全其他的意思？

我的程序后台发生了来自多个单独计时器的多个回调函数。不执行这些回调之一对我来说不是一个选择。我只是想澄清并确保我做的是正确的事情。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T21:45:04.043

1）据我所知，至少，我相信刷新队列的唯一方法是调用`drawnow`. 根据您所说的“更新图形窗口”的含义，您可能能够防止drawow 产生不良影响（例如，在调用drawow 之前删除数据源）。

2）我现在无法测试这个，但根据我之前的使用方式，以及你上面给出的描述，我很确定它是“执行队列中的所有内容”。

我不确定的另一件事是您是否需要`while 1; drawnow`- 如果您只是在之后结束脚本，事件不会像您期望的那样工作`start(t)`吗？我认为`drawnow`只有在你正在做一些其他事情时才有必要，例如在 while 循环中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T03:48:59.430

如果您还在循环中放置一个小暂停，这也会为计时器腾出一些时间。例如`pause(0.001)`. 一些例子：

```
start(t); while(1);  end;              %No timer events occur
start(t); while(1); pause(0.001); end  %Timer events occur
start(t); while(1); drawnow; end       %Timer events occur (your original example)
start(t); while(1); pause(0); end      %No timer events (just thought I'd check) 
```

# html - 仅在 Firefox 中显示滚动条

> ID：10404350
> 
> 赞同：0
> 
> 时间：2012-05-01T21:05:14.237
> 
> 标签：html, css, firefox, webkit

我想在 div 的底部有一个滚动条，但这个 CSS 仅适用于 Firefox，而不适用于 Safari 或 Chrome 等 Webkit 浏览器。

```
div.hoge {
    width: 500px;
    overflow: auto;
} 
```

我用谷歌搜索，发现一些页面提到你应该使用`overflow-x`，或者`-webkit-overflow-scrolling`它们也没有工作。需要使用一些 JS 吗？有什么猜测吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T04:27:08.760

*   如果您需要滚动条始终出现，您可以使用`overflow: scroll`
*   如果您需要垂直滚动条，`overflow-y: scroll`
*   如果您只需要水平滚动条，`overflow-x: scroll`

***根据问题标题：***您可以像这样编写 Mozilla 特定样式

```
@-moz-document url-prefix() {

    div.hoge {
        width: 500px;
        overflow: auto;
    }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T04:21:52.740

这是一个在 x 上滚动的 div 的[示例小提琴](http://jsfiddle.net/burhans/vcA5b/)。如果不包含`white-space: nowrap`，则文本仅包含在 div 中，并且只有垂直（y 方向）滚动条实际滚动。

小提琴显示了两个 div 元素；一个有`nowrap`一个没有。此外，我在 div 上设置了边框以使其更易于查看。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T04:13:22.863

溢出：自动；不做滚动 DIV，使用溢出：滚动；如果你想要它在任何特定的轴上，然后使用溢出-x：滚动；或溢出-y：滚动；

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-01T21:18:55.960

你试过`overflow-x:scroll;`吗？

还要确保 div.hoge 有足够的高度在底部显示滚动条。

# java - 码头上的检票口：无法保存带有 id 的页面

> ID：10404358
> 
> 赞同：1
> 
> 时间：2012-05-01T21:05:33.997
> 
> 标签：java, jetty, wicket, wicket-1.5

我在 Jetty 服务器上部署了我的 Apache Wicket 应用程序，每次打开 Wicket 页面时，我都会在我的码头日志中看到以下错误：

```
WARN  - DiskDataStore              - Cannot save page with id '2' because the data file    cannot be opened.
ERROR - DiskDataStore              - /tmp/jetty-0.0.0.0-80-tourney.war-_tourney-any- /wicket.Tourneys-filestore/2gs9iqj4zdjtkerejipyu0co/data (No such file or directory)
java.io.FileNotFoundException: /tmp/jetty-0.0.0.0-80-tourney.war-_tourney-any-/wicket.Tourneys-filestore/2gs9iqj4zdjtkerejipyu0co/data (No such file or directory)
at java.io.RandomAccessFile.open(Native Method)
at java.io.RandomAccessFile.<init>(RandomAccessFile.java:233)
at org.apache.wicket.pageStore.DiskDataStore$SessionEntry.getFileChannel(DiskDataStore.java:410)
at org.apache.wicket.pageStore.DiskDataStore$SessionEntry.savePage(DiskDataStore.java:328)
at org.apache.wicket.pageStore.DiskDataStore.storeData(DiskDataStore.java:176)
at org.apache.wicket.pageStore.AsynchronousDataStore$PageSavingRunnable.run(AsynchronousDataStore.java:348)
at java.lang.Thread.run(Thread.java:636) 
```

知道出了什么问题吗？Unix 权限设置正确。我什至尝试过 777 但没有成功:(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-28T07:39:31.230

当您在 Jetty 运行时删除数据存储目录时，也会发生这种情况。即使允许 Jetty 创建一个新的，它仍然会抱怨。

对我来说，解决这个问题的方法是重新启动 Jetty。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-31T00:07:45.030

我想我会详细说明 Martin 的答案，因为对我来说如何访问 IStoreSettings 并不是很明显。您可以使用 Wicket 的 API 更新数据存储目录，如下所示：

```
public class MyApplication extends WebApplication {
    protected void init() {
        super.init();

        getStoreSettings().setFileStoreFolder(new File("/path/to/directory/"));
    }
} 
```

虽然，我不认为这是一个很好的主意。由于听起来 Wicket 的默认值为`javax.servlet.context.tempdir`，因此设置该属性要比在 Java 中硬编码一个值要好得多**。**这样，Windows 开发人员可以设置自己的值`C:\Users\lazydaemon\temp`，Linux 开发人员可以设置值`/home/lazydaemon/tmp/`，服务器管理员可以选择类似的值，`/var/cache/tomcat-VERSION/Catalina/whatever`而无需更改代码或脆弱的`if(configuration==RuntimeConfigurationType.DEVELOPMENT)`逻辑。

因此，您可以将该属性设置为服务器启动时间的参数：

```
-Djavax.servlet.context.tempdir=/path/to/directory/ 
```

或者，如果您在未在您的 war 文件中打包和部署的代码中启动 Jetty 服务器，您可以在配置和启动 Jetty 的代码中设置属性：

```
System.setProperty("javax.servlet.context.tempdir", "/path/to/directory/"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-09T07:02:21.070

要更改 DiskDataStore 目录，您可以使用 ServletContextListener：

```
public class InitListener implements ServletContextListener {
  @Override
  public void contextInitialized(ServletContextEvent sce) {
    final String workDir = sce.getServletContext().getInitParameter("workDirectory"); // Context param with the temp dir path
    sce.getServletContext().setAttribute("javax.servlet.context.tempdir", file); // sets the temp dir (Wicket will read it from here)
  }

  @Override
  public void contextDestroyed(ServletContextEvent sce) {}
} 
```

这是必要的 web.xml 条目：

```
<context-param>
  <param-name>workDirectory</param-name>
  <param-value>E:\wicket</param-value>
</context-param>
<listener>
  <listener-class>es.cyum.cruekti.wicket.InitListener</listener-class>
</listener> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-13T17:51:50.023

这是 Wicket API 方式：org.apache.wicket.settings.IStoreSettings#setFileStoreFolder()

# c# - 投射从 Ajax 返回的对象

> ID：10404361
> 
> 赞同：1
> 
> 时间：2012-05-01T21:05:47.927
> 
> 标签：c#, asp.net, .net, ajax.net

我正在使用 AJAX.NET 和 C# ASP.NET

我的 Soldier 类是 Person 类的一种。

```
 [WebMethod, ScriptMethod]
 public static Person getPerson(int personId)
 {
    return (Person)personService.getSoldier(personId);
 } 
```

这工作得很好。在 Ajax 方面，我可以获取和设置 Soldier 属性。但是，当我将此对象发回时，我无法将其转换回 Soldier 对象。

```
[WebMethod, ScriptMethod]
public static Person savePerson(Person person)
{
   Soldier soldier = (Soldier)person;
} 
```

这失败了。它说它不能将对象 Person 转换为 Soldier。有没有办法解决这个问题，因为我不想为每种类型创建十几个保存方法？您的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T21:09:56.650

“*我的士兵类是人类的一种*”

那就是你的问题。与`Person`基类一样，它不能转换为子类`Soldier`。

您需要在`Person`类中编写一个以 a`Soldier`作为参数并单独设置属性的 Convert 函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T21:09:06.513

你能做的就是这样。

```
Soldier soldier = new Soldier(){soldier.Prop1 = Person.CorrespondingProp;//for all the propertiese}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T21:13:31.557

我猜你`Soldier`从课堂上创建了`Person`课堂。您的方法返回类型是`Person`作为基类的类。***基类不会具有 Child 类的所有属性。但是子类将具有其父类的所有属性。***

理想情况下，我要返回一个`Soldier`对象，我会将我的方法返回类型设为 Soldier

```
 public static Soldier getPerson(int personId)
 {
    return personService.getSoldier(personId);
 } 
```

# spring - Spring + Ehcache - 可以使用@Cacheable 来缓存jsp视图的输出

> ID：10404365
> 
> 赞同：2
> 
> 时间：2012-05-01T21:05:56.180
> 
> 标签：spring, ehcache

基本上，是否可以这样做：

```
@Cacheable(cacheName="default")
@RequestMapping("getContent/{name}")
public String getContentByNameHandler(@PathVariable String name, Model model) {

    ContentService contentService = domainService.getContentService();

    model.addAttribute("model",contentService.getContentByName(name));

    return RESOURCE_FOLDER + "content";
} 
```

当我尝试这个时，视图被缓存，但是从缓存中返回的只是jsp的纯内容，而不是简单的jsp视图渲染逻辑完成后的jsp视图。我在 spring 3.0.7，所以仍然使用 ehcache-spring-annotations (http://code.google.com/p/ehcache-spring-annotations)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T22:06:46.587

`@Cacheable`通过简单地基于所有输入参数形成一个键并将返回值放在该键下来工作。

所以它不会存储已处理的视图 - 它只会存储视图名称。

通常，您会为此使用浏览器缓存而不是服务器端缓存。而且由于渲染视图应该比生成内容消耗更少，因此您将`@Cacheable`使用 service 方法。

# wcf - 数据中带有字符 < 的 XSLT 数据映射

> ID：10404368
> 
> 赞同：1
> 
> 时间：2012-05-01T21:06:19.127
> 
> 标签：wcf, xslt, biztalk

我正在编写从一个 XML 模式到另一个 XML 模式的 XSLT 数据映射。目标模式有一个字符串字段，其中包含原始 XML 的副本。我知道我必须将 XML 中的控制字符转换为`&lt;`和`&gt;`. 我已经做到了。我遇到的问题是 XML 中的数据也有`&lt;`，也有`&gt;`。这会导致问题，因为我将 XML 发送到 WCF-SQL 适配器，并且当它`&lt;`在我的数据中命中时，它会尝试将其转换为`<`导致 XML 验证失败。

这是我的 XSLT 的一个片段：

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:xs="http://www.w3.org/2001/XMLSchema" exclude-result-prefixes="xs">
  <xsl:output method="xml" encoding="UTF-8" indent="yes"/>

  <xsl:template match="*" mode="serialize">
    <xsl:text>&lt;</xsl:text>
    <xsl:value-of select="name()"/>
    <xsl:text>&gt;</xsl:text>
    <xsl:apply-templates mode="serialize"/>
    <xsl:text>&lt;/</xsl:text>
    <xsl:value-of select="name()"/>
    <xsl:text>&gt;</xsl:text>
  </xsl:template>
  <xsl:template match="/">
    <proc_Insert xmlns="http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo">
      <StagingXML>
        <xsl:variable name="nodestring">
          <xsl:apply-templates select="*" mode="serialize"/>
        </xsl:variable>
        <xsl:value-of select="$nodestring"/>
      </StagingXML>
    </proc_Insert>
  </xsl:template>
</xsl:stylesheet> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T22:16:24.230

您需要引用内容，一段真正古老的代码（我认为早于 xslt 1.0 :-) 可以找到它

[http://www.openmath.org/cdfiles2/xsl/verb.xsl](http://www.openmath.org/cdfiles2/xsl/verb.xsl)

虽然周围也有更新的版本/

# image - Haskell 数据类型错误 PBMfile

> ID：10404373
> 
> 赞同：0
> 
> 时间：2012-05-01T21:06:43.403
> 
> 标签：image, haskell, rgb, ppm

我正在做作业并且有错误

我必须做一个关于现在描述的数据类型的函数

```
data RGBdata= RGB Int Int Int
data PBMfile= PBM Int Int [[RGBdata]] 
```

而他的表演功能

```
instance Show RGBdata where
 show (RGB r g b) = (show r)++" "++(show g)++" "++(show b)

instance Show PBMfile where
 show (PBM width height l) = "P3\n"++(show width)++" "++(show height)++"\n255\n"++(foldr (++) "" (map myshow l))

myshow [] = "\n"
myshow (h:t) = (show h)++" "++(myshow t) 
```

以及他的加载和应用功能

```
cargarPBM name = readFile name >>= return . rLines . lines
rLines (_:x:_:xs)= (\[a,b]->(PBM (read a) (read b) (rLines' (read a) (concat $map words xs)))) $ words x 
rLines' _ []= []
rLines' a x= (rLine (take (a*3) x): rLines' a (drop (a*3) x))
rLine []= []
rLine (r:g:b:xs)= ((RGB (read r) (read g) (read b)):rLine xs)

aplicar funcion origen destino= cargarPBM origen >>= writeFile destino . show . funcion 
```

例如，当我尝试执行一项功能时

```
negative :: PBMfile -> [Int] 
negative PBM x y z = [1,2,3] 
```

拥抱错误

```
ERROR file:.\haha.hs:32 - Constructor "PBM" must have exactly 3 arguments in pattern 
```

但是 PBM xyz 不是 3 个参数吗？我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T21:27:56.667

您的函数定义`negative PBM x y z`试图对 4 个参数进行模式匹配，其中第一个是`PBM`数据构造函数。要实际模式匹配数据构造函数及其参数，您应该对它们进行分组，即`negative (PBM x y z) = ...`. 您问题中的`show`定义是正确执行此操作的示例。

如需进一步阅读，请尝试[http://en.wikibooks.org/wiki/Haskell/Pattern_matching#The_connection_with_constructors](http://en.wikibooks.org/wiki/Haskell/Pattern_matching#The_connection_with_constructors)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T21:20:09.333

你需要括号，

```
negative :: PBMfile -> [Int] 
negative (PBM x y z) = [1,2,3] 
```

否则它被解析为`negative`.

# ruby-on-rails - 链轮 2 带导轨 2.3

> ID：10404380
> 
> 赞同：1
> 
> 时间：2012-05-01T21:07:19.843
> 
> 标签：ruby-on-rails, sprockets

尝试在 Rails 2.3 应用程序中运行 Sprockets 2...

[根据Pivotal](https://content.pivotal.io/blog/giving-rails-2-the-asset-pipeline)的本指南安装 gem 并在 config.ru 中实现它之后

```
require 'config/environment' if !defined?(Rails) || !Rails.initialized?
require 'sprockets'

unless Rails.env.production?
map '/assets' do
  sprockets = Sprockets::Environment.new
  sprockets.append_path 'app/assets/images'
  sprockets.append_path 'app/assets/javascripts'
  sprockets.append_path 'app/assets/stylesheets'

  Sprockets::Helpers.configure do |config|
    config.environment = sprockets
    config.prefix      = "/assets"
    config.digest      = false
  end

  run sprockets
  end
end

map '/' do
  use Rails::Rack::LogTailer unless Rails.env.test?
  use Rails::Rack::Debugger unless Rails.env.test?
  use Rails::Rack::Static
  run ActionController::Dispatcher.new
end 
```

然后我创建了 app/assets 并将 javascripts、images 和 stylesheets 目录从公共目录移到了 app/assets 中。在 app/assets/javascripts/application.js 我有：

```
//= require_tree . 
```

在 app/assets/stylesheets/application.css 我有：

```
/* ...
*= require_self
*= require_tree .
*/ 
```

当然在布局中我有：

```
<%= stylesheet_link_tag "assets/application" %>
<%= javascript_include_tag "assets/application" %> 
```

我的配置中缺少某些东西，我的任何资产都不会显示。有小费吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-16T22:37:42.750

所以我有同样的问题。我用我的解决方案写了一篇文章：http: [//jaredonline.github.com/blog/2012/05/16/sprockets-2-with-rails-2-dot-3/](http://jaredonline.github.com/blog/2012/05/16/sprockets-2-with-rails-2-dot-3/)

# java - 如何使用 Sun/Oracle CodeModel 库进行类型转换？

> ID：10404384
> 
> 赞同：2
> 
> 时间：2012-05-01T21:07:47.020
> 
> 标签：java, code-generation, sun-codemodel

我正在尝试使用 Java [CodeModel 库](http://codemodel.java.net/)来生成一些代码。在我生成的代码中，我需要执行类型转换。我想要这样的东西...

```
foo.setBar( ((TypeCastToThis)someVariable).getBar() ); 
```

我在库中找到的唯一支持是使用[JCast JExpr.cast(JType type, JExpression expr)](http://codemodel.java.net/nonav/apidocs/com/sun/codemodel/JExpr.html#cast%28com.sun.codemodel.JType,%20com.sun.codemodel.JExpression%29)。然而，根据 Eclipse，返回类型 JCast 不是公开的。确切的错误是：“com.sun.codemodel.JCast 类型不可见”。

这是我正在做的一个简单示例。

```
import java.io.File;

import com.sun.codemodel.JBlock;
import com.sun.codemodel.JCast;  //<-- Eclipse flags this as an error
import com.sun.codemodel.JClass;
import com.sun.codemodel.JClassAlreadyExistsException;
import com.sun.codemodel.JCodeModel;
import com.sun.codemodel.JDefinedClass;
import com.sun.codemodel.JExpr;
import com.sun.codemodel.JMethod;
import com.sun.codemodel.JMod;
import com.sun.codemodel.JVar;

public class CastTest
{

    public static void main(String[] args) throws JClassAlreadyExistsException
    {
        // TODO Auto-generated method stub

        JCodeModel codeModel = new JCodeModel();
        JDefinedClass testClass = codeModel._class("MyTestClass");

        JMethod testMeth = testClass.method(JMod.PUBLIC, codeModel.VOID, "TypeCastTestMethod");

        JBlock testMethBody = testMeth.body();

        JVar castMeVar = testMethBody.decl(codeModel.INT, "castMe", JExpr.lit(42));

        JClass typeCastToThisClass = codeModel.directClass("TypeCastToThis");

        JCast castResult = JExpr.cast(typeCastToThisClass, castMeVar);

        testMethBody.decl(typeCastToThisClass, "theTypeCastedObject", castResult);

        codeModel.build(new File("/path/to/output/directory"));
    }

    /*

    The generated code should look like this.

    public void TypeCastTestMethod()
    {
        int castMe = 42;
        TypeCastToThis theTypeCastedObject = (TypeCastToThis)castMe;
    }

    */
} 
```

我是否错误地使用了该库和/或是否有其他方法可以实现我的目标？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-07T19:00:02.403

万一其他人以后有这个问题，可以通过在 JExpr.cast(....) 的返回值上使用从 JCast 到 JExpression 的隐式向上转换来绕过它。JCast 是 JExpression 的子类型。

从....

```
JCast castResult = JExpr.cast(typeCastToThisClass, castMeVar); 
```

到.....

```
JExpression castResult = JExpr.cast(typeCastToThisClass, castMeVar); 
```

# c# - 动态 UI，循环无法正常工作

> ID：10404386
> 
> 赞同：0
> 
> 时间：2012-05-01T21:07:56.453
> 
> 标签：c#, loops, dynamic, user-interface

这是我正在使用的代码它应该为用户输入的每个模块名称以及该模块下的所有评估名称创建标签。应该与任意数量的模块和评估一起工作。问题是它只显示最后一个模块的评估。

dat.Modules 和 dat.Assessments 是数组列表，它们每个都包含 4 个元素，其中包含有关模块或评估的信息，这就是我将计数除以 4 的原因。

私人无效测试Button_Click（对象发送者，EventArgs e）{

```
 int pos1 = 50;
        int pos2 = 150;

        int modLength = dat.Modules.Count;
        modLength = modLength / 4;
        int assessLength = 0;
        int arrayData = 0;
        int displayCount = 0;

        for (int i = 0; i < modLength; i++)
        {

            this.moduleLabels.Add(new Label());
            System.Drawing.Point pLabel1 = new System.Drawing.Point(50, pos1);
            (moduleLabels[i] as Label).Location = pLabel1;
            (moduleLabels[i] as Label).Size = new System.Drawing.Size(100, 13);
            (moduleLabels[i] as Label).Text = dat.Modules[arrayData].ToString();
            tabPage5.Controls.Add((moduleLabels[i] as Label));
            String asd = dat.Modules[arrayData + 2].ToString();
            Console.WriteLine(asd);
            assessLength = int.Parse(asd);
            pos2 = pos1 + 25;
            for (int y = 0; y < assessLength; y++)
            {
                this.assessLabels.Add(new Label());
                System.Drawing.Point pLabel2 = new System.Drawing.Point(70, pos2);
                (assessLabels[y] as Label).Location = pLabel2;
                (assessLabels[y] as Label).Size = new System.Drawing.Size(250, 13);
                (assessLabels[y] as Label).Text = dat.Assessments[displayCount + 1].ToString() + " weights " + dat.Assessments[displayCount+2].ToString() +"%, Enter your mark:";

                textboxComputer.Add(new TextBox());
                System.Drawing.Point pText1 = new System.Drawing.Point(400, pos2);
                (textboxComputer[y] as TextBox).Location = pText1;
                (textboxComputer[y] as TextBox).Size = new System.Drawing.Size(20, 20);

                tabPage5.Controls.Add(assessLabels[y] as Label);
                tabPage5.Controls.Add(textboxComputer[y] as TextBox);
                pos2 = pos2 + 25;
                displayCount = displayCount + 4;
            }

            pos1 = pos2+25;
            arrayData = arrayData + 4;

        }
    } 
```

这是它显示的示例

[http://dc540.4shared.com/download/YI8IENYI/tsid20120501-211723-cbc785f9/asd.jpg](http://dc540.4shared.com/download/YI8IENYI/tsid20120501-211723-cbc785f9/asd.jpg)

前两个模块应列出其评估。第一个不显示任何内容。对于 Java，它只显示最后一个，共 3 个模块。对于最后一个模块“另一个模块”，它会显示所有评估。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T22:10:30.807

对于 的每个增量`i`，`y`从 0 开始。然后您将新标签添加到`assessLabels`，但尝试访问您添加`assessLabels[y]`的标签，这通常会产生为 的前一个值创建的标签`i`。这会导致为第一个模块创建的标签被下一个模块重用，依此类推。

一个快速的解决方案是不使用`assessLabels[y]`but `assessLabels[assessLabels.Count - 1]`。

更好的解决方案是为标签创建一个局部变量，设置它们的属性，*然后*将它们添加到列表中：

```
for (int y = 0; y < assessLength; y++)
{
    Label assessLabel = new Label();
    assessLabel.Location = ...;
    // etc.
    tabPage5.Controls.Add(assessLabel);
    assessLabels.Add(assessLabel);
} 
```

这也将消除连续转换 ArrayList 成员和对列表的不必要访问的需要。

PS。如果`assessLabels`只包含 type 的对象`Labels`，请考虑使用 a`List<Label>`代替。

# facebook - iOS 5 Facebook 集成

> ID：10404387
> 
> 赞同：0
> 
> 时间：2012-05-01T21:08:02.653
> 
> 标签：facebook, ios5, uistoryboard

我正在编写一个应用程序，并且第一次想集成一些 Facebook SDK 功能。我想让用户登录到他们的 Facebook 帐户，然后能够选择他们的一位朋友在应用程序中“竞争”。

我正在按照 iOS 版 Facebook 开发人员网站上的说明进行操作，但我似乎不知道如何在应用程序启动时呈现“使用 Facebook 登录”视图，然后在 Facebook SSO 获得授权或除非用户退出应用程序。

我将为此使用的示例类似于 DrawSomething 应用程序的身份验证工作流程。

关于如何做到这一点的任何想法？教程或示例会很棒！如果这有所作为，我正在使用带有故事板的 iOS 5。

谢谢！

-布赖恩

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-09T19:22:12.797

首先验证： [Facebook API/SDK 集成](https://developers.facebook.com/docs/tutorials/ios-sdk-tutorial/authenticate/)

# iphone - UIWebview 没有得到 cookie

> ID：10404388
> 
> 赞同：0
> 
> 时间：2012-05-01T21:08:04.967
> 
> 标签：iphone, ios, cookies, uiwebview, xamarin.ios

我的 UIWebview 根本没有保存 cookie。它卡在无 cookie 模式，因此网页将 cookie 信息放在 url 中。

这就是我正在做的事情。我的 UIWebview 有一个单例，底部有 4 个 UITabBar 按钮。每个标签栏按钮将用户带到网站上的不同页面。现在，当用户通过 webview 本身浏览站点时，一切都很好，会话仍然存在。但是，当用户单击选项卡按钮时，会话会被重置。

我什至将 NSHttpCookieStorage 设置为始终接受 cookie。还是不行。

这是我的 UIWebview 和 NSMutableUrlRequest 的单例代码

```
 public static UIWebView instance;
    public static NSMutableUrlRequest urlRequest;
    public static NSUrlConnection connection;
    public static NSHttpCookieStorage cookie;
    static bool TokenSent = false;
    public UIWebViewSingleton () {}

    public static UIWebView Instance
    {
        get
        {
            if (instance == null)
            {   
                Debugger.Debug ("new uiwebview created");
                cookie = NSHttpCookieStorage.SharedStorage;
                cookie.AcceptPolicy = NSHttpCookieAcceptPolicy.Always;
                connection = new NSUrlConnection(); 
                instance = new UIWebView(new RectangleF(0f, 0f, 320f, 416f));
                instance.ScalesPageToFit = true;
                instance.LoadStarted += delegate {
                    UIApplication.SharedApplication.NetworkActivityIndicatorVisible = true;
                };
                instance.LoadFinished += delegate {
                    UIApplication.SharedApplication.NetworkActivityIndicatorVisible = false;
                    AcquireUserId();
                };
                instance.MultipleTouchEnabled = false;
            }
            return instance;
        }
    }

    public static NSMutableUrlRequest UrlRequest
    {
        get
        {
            if (urlRequest == null)
            {
                urlRequest = new NSMutableUrlRequest();
            }
            return urlRequest;
        }
    } 
```

这就是我根据按下的按钮切换到页面的方式。后退按钮工作正常。

```
 case BTN_BACK:
            btn_ret.TouchUpInside += delegate(object sender, EventArgs e) {
                UIWebViewSingleton.Instance.GoBack();       
            };
            break;

        case BTN_GUIDE:
            btn_ret.TouchUpInside += delegate(object sender, EventArgs e) {
                UIWebViewSingleton.UrlRequest.Url = new NSUrl(StaticFileNames.GuideUrl);
                UIWebViewSingleton.Instance.LoadRequest (UIWebViewSingleton.UrlRequest);        
            };
            break;

        case BTN_HOME:
            btn_ret.TouchUpInside += delegate(object sender, EventArgs e) {
                UIWebViewSingleton.UrlRequest.Url = new NSUrl(StaticFileNames.BaseUrl);
                UIWebViewSingleton.Instance.LoadRequest (UIWebViewSingleton.UrlRequest);        
            };
            break; 
```

有没有人知道为什么我的 UIWebView 不接受 cookie？我仍然对 NSHttpCookieStorage 以及我是否正确使用它感到困惑。

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T18:39:48.587

我采用了足够的解决方法。

由于 cookie 在 url 中，我只是将其解析出来并以编程方式将其放入 tabbar 按钮指向的 url 中。问题解决了。

# python - 无法为 PyDev 解释器设置使用自动配置

> ID：10404391
> 
> 赞同：2
> 
> 时间：2012-05-01T21:08:22.567
> 
> 标签：python, pydev

在使用我的 Python 解释器设置 PyDev 时，我选择“自动配置”以显示目录列表。然后按确定，并收到一条错误消息：

```
Error: Python stdlib not found or stdlib found without .py files. 
```

显然，它正在寻找诸如 threading.py 和 traceback.py 之类的文件（不仅仅是它们的可执行文件）。

然而，我能够在`/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7`

“自动配置”文件夹列表中的一个文件夹正是该文件夹，所以我真的不知道问题出在哪里。我正在使用来自 python.org 的 Mac OS X 10.7.3 和 Python 2.7.3。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T18:41:19.120

我遇到了同样的问题，我也有和你一样的设置。

打开你的终端，（在聚光灯下，只需输入“终端”）并输入“哪个python”。获取它打印出来的路径，进入您的配置，而不是“自动配置”，单击“新建...”并将路径粘贴到解释器字段中。

它会提取与 Auto Config 相同的库，但我认为问题在于 autoconfig 指向 /usr/lib/... 路径而不是解释器的新路径。

希望这会有所帮助，快乐的编码！

# java - Java 使用 jar 中的类

> ID：10404393
> 
> 赞同：0
> 
> 时间：2012-05-01T21:08:36.857
> 
> 标签：java, jar, classpath, conio

这一定是一个超级被问到的问题。虽然这里有：

我有一个用于测试 (hworld.java) 的 java 文件，并且正在尝试导入 conio.jar，这是一个 JAR，它是 Conio 的包装器。JAR 只包含一个类文件 (conio.class) 和 META-INF。试图做`import conio.*`或`import conio.conio`向我展示这个：

```
C:\Documents and Settings\Nick\Desktop>javac -cp *.jar; hworld.java
hworld.java:3: error: package conio does not exist
import conio.*;
^
1 error 
```

并且在编译时编译它`javac -cp conio.jar hworld.java`仍然会出错。我什至提取了 jar 并将 conio.class 放在与 hworld.java 相同的目录中，但无济于事。JAR 也与 hworld.java 位于同一目录中。

任何人都知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T21:11:42.370

这实际上是不可能的。如果要导入其他类，则需要将其放入包中。

[在 Java 的默认包中导入类的语法是什么？](https://stackoverflow.com/questions/2030148/whats-the-syntax-to-import-a-class-in-a-default-package-in-java)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T21:42:01.963

您没有提到 conio.class 是否在包 conio 中定义。如果不是，那么只需使用该类而不导入它。删除导入。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T21:57:56.243

找出 Conio 所在的包 - 一个简单的方法是将 jar 作为 zip 文件打开，该包将与存档的文件夹结构相对应。例如，如果 Conio 在 x/y/z 中，则导入 xyzConio 并在同学上使用 conio.jar 编译/运行。

# installation - Inno IDE 在复制期间重命名目录

> ID：10404395
> 
> 赞同：0
> 
> 时间：2012-05-01T21:08:52.407
> 
> 标签：installation, windows-installer, inno-setup

**我有一个 Inno 设置脚本，在[files]**部分中有以下行：

```
Source: Release\bin\glassfish-3.1.2; DestDir: {sd}\MyApp; Flags: ignoreversion recursesubdirs createallsubdirs external; 
```

我希望将 glassfish 目录重命名，以便在复制时为 C:\MyApp。我尝试了几种变体，但没有解决。必须是一个简单的添加选项。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T22:59:05.307

如果您只想要 glassfish-3.1.2 下的文件和目录，则需要将源代码更改为以下内容：

```
Source: Release\bin\glassfish-3.1.2\*; DestDir: {sd}\MyApp; Flags: ignoreversion recursesubdirs createallsubdirs external; 
```

# facebook - 为什么 publish_action 这么不稳定？

> ID：10404400
> 
> 赞同：0
> 
> 时间：2012-05-01T21:09:15.197
> 
> 标签：facebook, action, facebook-opengraph

您可以在下面找到我使用的代码，您可以看到它是从示例代码中复制而来的。但是结果非常不稳定，经常返回“意外错误，请稍后再试”，开发应用程序也有一些问题。它随机清除应用程序名称空间，而我没有删除它。事实上，应用程序命名空间仍然处于活动状态，所以如果我重新输入我的应用程序命名空间，它会说它已经存在。

这让我忙了 12 个小时。我想知道其他人是否遇到同样的问题，这可能是 Facebook 部分的错误。

```
<html xmlns:fb="http://ogp.me/ns/fb#"
    xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-US"
      xmlns:fb="https://www.facebook.com/2008/fbml"> 
<head prefix="og: http://ogp.me/ns# mycookieapp: 
                  http://ogp.me/ns/apps/mycookieapp#">
  <title>OG Tutorial App</title>
  <meta property="fb:app_id" content="115973895205576" /> 
  <meta property="og:type" content="mycookieapp:recipe" /> 
  <meta property="og:title" content="Stuffed Cookies" /> 
  <meta property="og:image" content="http://fbwerks.com:8000/zhen/cookie.jpg" /> 
  <meta property="og:description" content="The Turducken of Cookies" /> 
  <meta property="og:url" content="http://www.crystalminds.nl/facebook/index.html">

  <script type="text/javascript">
  function postCook()
  {
      FB.api(
        '/me/mycookieapp:cook?recipe=http://www.crystalminds.nl/facebook/index.html',
        'post',
        function(response) {
           if (!response || response.error) {
              alert('Error occured: ' + response.error.message);
           } else {
              alert('Cook was successful! Action ID: ' + response.id);
           }
        });
  }
  </script>
</head>
<body>
    <div id="fb-root"></div>
    <script>
        window.fbAsyncInit = function() {
          FB.init({
            appId      : '115973895205576', // App ID
            status     : true, // check login status
            cookie     : true, // enable cookies to allow the server to access the session
            xfbml      : true  // parse XFBML
          });
        };

        (function(d, s, id) {
          var js, fjs = d.getElementsByTagName(s)[0];
          if (d.getElementById(id)) return;
          js = d.createElement(s); js.id = id;
          js.src = "//connect.facebook.net/nl_NL/all.js#xfbml=1&appId=115973895205576";
          fjs.parentNode.insertBefore(js, fjs);
        }(document, 'script', 'facebook-jssdk'));
    </script>

  <h3>Stuffed Cookiess</h3>
  <p>
    <img title="Stuffed Cookies" 
         src="http://fbwerks.com:8000/zhen/cookie.jpg" 
         width="550"/>
  </p>

  <br>
  <form>
    <input type="button" value="Cook" onclick="postCook()" />
  </form>
</body>
</html> 
```

# java - 当子类尝试使用对象时，对象具有空值。为什么？

> ID：10404404
> 
> 赞同：2
> 
> 时间：2012-05-01T21:09:25.350
> 
> 标签：java, class, client, superclass

我是一个Java新手，所以我可能完全错误地做这整件事。我必须为软件工程课做这个巨大的项目。代码长约 2,000 行，所以这是骨架代码

```
public class BookRental extends JFrame{
   public Client currentClient = new Client(); // creating client object
   //rest of declared variables.

   public class Client{                        //Client class containing all get/set methods for each variable
   private username;
   private void setUsername(String u){
      username = u;
   }
   public String getUsername(){
      return username;
   }

   public class LoginPanel extends JPanel{}    //Panel to show and receive login info.
   public class RegisterPanel extends JPanel{} //Panel to register.
   public class MenuPanel extends JPanel{      //Panel showing main menu.
      //At this point currentClient will contain values
      public ClientInfoPanel(){
         initComponents();
      }
      private void initComponents(){
         infoPanelUserName = new JLabel();
         infoPanelFullName.setText("Currently logged in as: " + currentClient.getUsername());
      }
      private JLabel infoPanelUserName;
    }
   public class ClientInfoPanel extends JPanel{} //Panel to print currentClient info to screen using JLabel objects

   private void ViewClientInfoButtonActionPerformed(event){  // Using button in Menu Panel to setVisibility of clientInfoPanel to (true)
      //At this point there will be a value for currentClient
      clientInfoPanel = new ClientInfoPanel();
      this.add(clientInfoPanel);
      menuPanel.setVisible(false);
      clientInfoPanel.setVisible(true);
   }
   public BookRental(){initComponents();} //Constructor
   private void initComponents(){}             // Creates all panels and sets visibility off, besides login

   public static void main(String args[]){
       new BookRental().setVisible(true);
   } 
```

}

我已经很确定我这样做完全错了，但是我的问题是为什么我不能在 ClientInfoPanel 中访问 c​​urrentClient？说这个 JLabel：

```
infoPanelUserName.setText("Currently logged in as: " + currentClient.getUsername()); 
```

ClientInfoPanel 识别 currentClient 存在并且 getUsername() 方法存在，但是它打印：

> “当前登录为：”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T22:05:05.807

您显示的代码看起来不错，所以问题出在其他地方，或者此代码不能代表您所拥有的。此外，您正在成功访问 currentClient，除非您收到 NullPointerException 或在某处捕获它，否则 .getUsername() 调用正在解析。所以问题实际上出在 .getUsername() 上，当您调用 .getUsername() 时，不知何故用户名未初始化；

作为测试，您可以在调用 .getUsername() 之前在 currentClient 上调用 .setUsername() 吗？这应该有助于我们缩小问题范围，将其隔离到类访问或正在初始化的变量。

另外，您知道如何使用断点进行调试吗？你提到你是新人，所以你可能不知道这是可能的。如果您使用的是 Eclipse（或其他好的 IDE），您可以设置断点并在 DEBUG 构建中运行程序，然后程序将在遇到您设置断点的行时冻结，并且您可以观察程序移动行行，并查看程序更新的变量。谷歌java调试教程。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T22:10:57.743

我同意（不确定我是否应该添加，因为其他人已经回答了，礼仪是什么？）。我运行得很好，它向我显示了一个面板，其中用户以我的身份登录，如 BookRental 构造函数中设置的那样：

```
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;

public class BookRental extends JFrame{
   public Client currentClient = new Client(); // creating client object
   //rest of declared variables.

   public class Client{                        //Client class containing all get/set methods for each variable
     private String username;
     private void setUsername(String u){
      username = u;
     }
     public String getUsername(){
      return username;
     }
   }

   public class ClientInfoPanel extends JPanel{      //Panel showing main menu.
      //At this point currentClient will contain values
      public ClientInfoPanel(){
         initComponents();
      }
      private void initComponents(){
         infoPanelUserName = new JLabel();
         infoPanelUserName.setText("Currently logged in as: " + currentClient.getUsername());
         this.add(infoPanelUserName);
      }
      private JLabel infoPanelUserName;
    }
   public ClientInfoPanel clientInfoPanel;

   //Constructor
   public BookRental(){
       currentClient.setUsername("Me");
       initComponents();
   } 
   private void initComponents(){
       clientInfoPanel = new ClientInfoPanel();
          this.add(clientInfoPanel);
          clientInfoPanel.setVisible(true);
   }

   public static void main(String args[]){

       new BookRental().setVisible(true);
   }
 } 
```

# objective-c - UITableView 滑动返回动画

> ID：10404406
> 
> 赞同：0
> 
> 时间：2012-05-01T21:09:34.890
> 
> 标签：objective-c, xcode, uitableview, swipe

我有一张桌子，我注意到当我执行“滑动删除”时，红色按钮只有第一次动画，返回（如果我再次滑动）消失而没有动画。这些是我用于此步骤的方法：

```
- (UITableViewCellEditingStyle)tableView:(UITableView *)tableView 
       editingStyleForRowAtIndexPath:(NSIndexPath *)indexPath {

return UITableViewCellEditingStyleDelete;

}

- (void)tableView:(UITableView *)tableView 
commitEditingStyle:(UITableViewCellEditingStyle)editingStyle
forRowAtIndexPath:(NSIndexPath *)indexPath {

...

}
- (void)tableView:(UITableView *)tableView 
didEndEditingRowAtIndexPath:(NSIndexPath *)indexPath {

[tableView reloadData];

} 
```

我忘记了一些动画回报？

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T21:58:31.423

是的，省略`[tableView reloadData];`. 您只需要在 中重新加载表格`-tableView:commitEditingStyle:etc:`，甚至可以说不需要 - 最好使用 UITableView 方法`-deleteRowsAtIndexPaths:withRowAnimation:`。重新加载它是不必要的，这就是为什么您的删除按钮消失而不是动画出来的原因。

# java - 服务层应该抛出异常吗？

> ID：10404407
> 
> 赞同：3
> 
> 时间：2012-05-01T21:09:39.130
> 
> 标签：java, spring, spring-mvc, soa

由于某种原因，我不喜欢抛出异常，也许是因为我不知道性能受到影响，想知道我是否应该重新考虑这个问题。

我的服务层（使用 Dao 的 + 业务逻辑等）是否应该抛出异常？

```
public ModelAndView createProduct(@Valid ProductForm productForm, ..) {
  ModelAndView mav = new ModelAndView(...);

  if(bindingResult.hasErrors()) {
     return mav;
  }

  // throw exception if user doesn't have permissions??
  productService.create(product, userPermissions);

} 
```

所以我在 ProductService 的 create 方法中的选项：

1.  如果用户没有权限，则抛出异常
2.  返回某种类型的 Response 对象，如果成功，该对象将具有新的产品 ID，以及成功/失败标志和错误集合。

要记住的事情：

**我可以在非 Web 应用程序中重用这个服务层，也可以在一个安静的 Web 服务中。**

什么被认为是最佳实践？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-01T21:17:55.430

取决于您所说的服务和异常的含义，但在您所拥有的上下文中，我将假设来自 HTTP 端点的 java 异常。

答案是不。服务应该以一般的方式暴露错误。在 Restful 服务的情况下，错误应该作为带有错误代码的 HTTP 状态传播。服务不应该将实现细节泄露给消费者。这是一个自然的边界。

消费者应该处理这些错误情况并决定最合适的沟通方式。它很可能会选择生成异常。但是这些异常与导致服务返回错误代码的原始问题/接收不相交。

更进一步，我会说@yahir 他所说的也是正确的。HTTP 服务会暴露 HTTP 错误，它很可能只是在下面使用另一个服务返回另一种错误，但它的工作是适当地处理或映射它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T21:11:34.063

问问自己还有哪些其他选择，有时例外是必要的。您唯一可以做的另一件事是返回失败或成功状态并进行适当处理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T21:25:50.203

我想说服务层的行为应该与暴露给客户端代码的任何其他方法一样。毕竟，事情就是这样。

将通过 RPC 使用它的客户端将完全期望这种行为。

其他客户端，例如 REST，无论如何都应该通过其他一些包装层（例如`Controller`层）访问服务层。包装层的职责之一是将响应转换为客户端可使用的。

# c# - 将 MS Access (.mdb) 数据库连接到 MVC3 Web 应用程序

> ID：10404416
> 
> 赞同：1
> 
> 时间：2012-05-01T21:10:26.900
> 
> 标签：c#, asp.net-mvc-3, ms-access

是的，我的任务是在 MVC3 中开发一个新的应用程序，不幸的是它必须与经典的 asp 网站进行非常轻微的集成。这不会是永远的，因为旧网站会在某个时候获得更新，但还没有。但与此同时，新的 MVC3 应用程序将需要对旧站点的数据库进行一些访问，这是一个旧的 MS Access .mdb，而新应用程序将使用 sql server 2008。

如果有人能给我一些关于如何连接到访问数据库以及如何执行 sql 查询的示例，我将不胜感激（我很好地编写了 sql，只是不知道如何从我的 mvc3 应用程序对数据库执行）。

提前致谢

编辑：我对旧站点没有太多经验，但如果有帮助，它似乎使用 JET 适配器！;-)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T21:28:56.830

您的问题需要一个过于广泛的答案，无法详细给出
我会给您一份清单，列出要研究的事物和课程

*   定义用于访问数据库的连接字符串[[参见此处]](http://www.connectionstrings.com)
*   创建并打开[OleDbConnection](http://msdn.microsoft.com/en-us/library/system.data.oledb.oledbconnection.aspx)
*   定义您的[OleDbCommand](http://msdn.microsoft.com/en-us/library/system.data.oledb.oledbcommand%28v=VS.71%29.aspx)和要执行的命令文本
*   创建并使用[OleDbDataReader](http://msdn.microsoft.com/en-us/library/system.data.oledb.oledbdatareader%28v=VS.71%29.aspx)逐行读取数据
*   创建并使用[OleDbDataAdapter](http://msdn.microsoft.com/en-us/library/system.data.oledb.oledbdataadapter%28v=VS.71%29.aspx)读取数据并加载 DataSet 或 DataTable

现在不要忘记关闭连接并使用参数化查询

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T21:49:29.203

```
string connectionString = Provider=Microsoft.Jet.OLEDB.4.0;Data Source=C:\mydatabase.mdb;Jet OLEDB:Database Password=MyDbPassword;
public void InsertRow(string connectionString, string insertSQL)
{
    using (OleDbConnection connection = new OleDbConnection(connectionString))
    {
        // The insertSQL string contains a SQL statement that
        // inserts a new row in the source table.
        OleDbCommand command = new OleDbCommand(insertSQL);

        // Set the Connection to the new OleDbConnection.
        command.Connection = connection;

        // Open the connection and execute the insert command.
        try
        {
            connection.Open();
            command.ExecuteNonQuery();
        }
        catch (Exception ex)
        {
            Console.WriteLine(ex.Message);
        }
        // The connection is automatically closed when the
        // code exits the using block.
    }
} 
```

# jquery - 参数化ajax回调

> ID：10404421
> 
> 赞同：-2
> 
> 时间：2012-05-01T21:10:49.420
> 
> 标签：jquery, ajax, callback

我在我的网站上使用单个 ajax 方法，我需要参数化所有参数和选项，还有回调方法（成功、发送前、错误等）

现在我写道：

```
function ajax(_type,_url,_data,_dataType,_starter,_callback_success,_callback_error, etc ..){
    $.ajax({
        type:_type,
        data:_data,
        dataType:_dataType,
        url:'http://localhost:9292/'+_url,
        success: _callback_success,
        error: _callback_error,
        // etc ...
    });
} 
```

之后我想以这种方式使用这种方法，例如：

```
ajax(
   'GET',
   users,
   {},
   'json',
   false,
   function(){
       alert(json);
   }); 
```

我不知道如何参数化状态（成功、错误、BeforeSend）？我正在尝试使用简单的变量 _callback_error 或 _callback_success 但我不清楚如何在状态中传递回调

希望很清楚我的问题

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T21:23:40.043

Jquery 在调用它们时会将它们传递给回调。

```
function ajax(_type,_url,_data,_dataType,_callback_success, _callback_error){

   $.ajax({
        type:_type,
        data:_data,
        dataType:_dataType,
        url:'http://localhost:9292/'+_url,
        success: _callback_success,
        error: _callback_error
    });
} 
```

这是您的函数的示例用法。

```
ajax('POST', '/test.php', {}, 'json', function(data, textStatus, jqXHR){ 
        // if request succeeds this callback will be invoked
    }, function (jqXHR, textStatus, errorThrown){ 
       // if request fails this callback will be invoked
    }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T21:26:04.430

将函数名称传递给成功和错误：

[http://jsfiddle.net/SJ8Xm/](http://jsfiddle.net/SJ8Xm/)

```
function mySuccess(data) {
  document.write(JSON.stringify(data));
}

function myError(err) {
  alert(err);   
}

ajax("jsonp", "https://ajax.googleapis.com/ajax/services/search/images?callback=?", { q: "cats", v:"1.0" }, "jsonp", "", mySuccess);

function ajax(_type,_url,_data,_dataType,_starter,_callback_success,_callback_error){
    $.ajax({
        type:_type,
        data:_data,
        dataType:_dataType,
        url:_url,
        success: _callback_success,
        error: _callback_error
    });
}​ 
```

# ruby-on-rails - Rails 3 Active Record 基于范围获取关联模型

> ID：10404424
> 
> 赞同：2
> 
> 时间：2012-05-01T21:10:57.057
> 
> 标签：ruby-on-rails, activerecord

我已经为此苦苦挣扎了一整天。

这就是我所拥有的。一个`User`模型和一个`Address`模型。`User` `has_many :addresses`和`Adddress` `belongs_to :user`。

现在我想搜索其电子邮件包含给定术语的用户，或者其中一个用户的地址包含该术语。所以可以说这个词是'jap'，应该返回任何地址城市或地址行`User`的任何用户或任何用户。`email like '%jap%'``like '%jap%'`

我可以像这样通过简单的加入来获得用户

```
users = User.joins('LEFT OUTER JOIN addresses ON users.id=addresses.user_id').where('users.email like '%jap%' OR addresses.city like '%jap%' OR addresses.address_line like '%jap%') 
```

这给了我想要的用户。我想要的是对于返回的用户，我还想要那些符合条件的地址。

如果在上述之后我做

```
users.first.addresses 
```

它会给我所有该用户的地址。我知道我可以像这样对该用户的地址进行另一个查询

```
users.first.addresses.where( addresses.city like '%jap%' OR addresses.address_line like '%jap%') 
```

但这不是它应该如何工作的。我已经尝试过包含并在谷歌上搜索过，但还没有找到解决方案。有没有人遇到过这个？？？

**编辑#1**：有很多类似的解决方案有 2 个查询，我追求的是一个单一的查询解决方案，因为对我来说，两次对地址应用相同的条件是没有意义的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T21:16:16.490

您可以在地址模型上使用类似于以下内容的命名范围吗？

```
named_scope :city_or_line_like, lambda { |str| {
    :conditions => ['conditions here']
}} 
```

那样你能行`users.first.addresses.city_or_line_like('arg')`吗？

# swing - 在 NetBeansIDE 中编辑自定义 GUI

> ID：10404426
> 
> 赞同：0
> 
> 时间：2012-05-01T21:11:07.503
> 
> 标签：swing, netbeans

我有一个我在 JCreator LE 中编写的程序，其中包含我自己创建的一些 GUI 元素，我想知道是否有办法在 NetBeansIDE 中打开它并使用它来编辑我已经创建的 GUI。我正在运行 GUI，但我不擅长设置布局，我想使用 NetBeansIDE 来设置它。我愿意使用不同的程序进行 GUI 编辑，但是如果有人知道更好的话。

# android - 如何将 OnClickListener 附加到自定义首选项布局中的按钮？

> ID：10404429
> 
> 赞同：4
> 
> 时间：2012-05-01T21:11:15.833
> 
> 标签：android, layout, preferences

我有一个首选项屏幕，其中填充了数据库中的项目。我通过创建自己的`PreferenceActivity`. 在活动中，我创建`DialogPreference`项目并将它们添加到我的`PreferenceCategory`To 样式到屏幕上的首选项我使用自定义布局并使用它应用它`setLayoutResource(R.layout.custom_pref_row)`

这基本上`ImageButton`向与布局右侧对齐的视图添加了一个。这一切都很好，我的偏好屏幕显示了带有按钮的自定义视图。我的问题是如何将点击侦听器附加到自定义视图中的按钮？我无法找到`View`从`PreferenceActivity`. 如果我的项目不是动态创建的，我也许可以从 XML 中完成这一切，然后引用 id 或按钮，但我可以这样做，因为我正在动态创建列表。

关于如何处理`ImageButton`每个项目的任何建议？最后，我想配置按钮以启动删除确认对话框。

R.layout.custom_pref_row：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="wrap_content"
android:minHeight="?android:attr/listPreferredItemHeight"
android:gravity="center_vertical"
android:paddingRight="?android:attr/scrollbarSize">

<RelativeLayout
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_marginLeft="15dip"
    android:layout_marginRight="6dip"
    android:layout_marginTop="6dip"
    android:layout_marginBottom="6dip"
    android:layout_weight="1">

    <TextView android:id="@+android:id/title"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:singleLine="true"
        android:textAppearance="?android:attr/textAppearanceLarge"
        android:ellipsize="marquee"
        android:fadingEdge="horizontal" />

    <TextView android:id="@+android:id/summary"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_below="@android:id/title"
        android:layout_alignLeft="@android:id/title"
        android:textAppearance="?android:attr/textAppearanceSmall"
        android:maxLines="2" />

    <ImageButton android:id="@+id/pref_delete_station" android:layout_width="wrap_content" android:layout_height="wrap_content" android:src="@drawable/ic_trash_can" android:layout_alignParentRight="true" android:background="@null"></ImageButton>

</RelativeLayout>

<!-- Preference should place its actual preference widget here. -->
<LinearLayout android:id="@+android:id/widget_frame"
    android:layout_width="wrap_content"
    android:layout_height="fill_parent"
    android:gravity="center_vertical"
    android:orientation="vertical" />

</LinearLayout> 
```

我的 PreferenceActivity 的相关部分：

```
DialogPreference diaPref;
for (Station mStation : sList) {
        diaPref = new StationEditor(this.getPreferenceScreen().getContext(), null, this, mStation);
        diaPref.setLayoutResource(R.layout.custom_pref_row);
        diaPref.setTitle(mStation.getName());
        diaPref.setKey(STATION_PREFIX + mStation.getId());

        // add new preference
        stationTypesCategory.addPreference(diaPref);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T07:15:44.577

好吧，肖邦让我想到了一个不同的方向。我没有意识到该`Preference`对象还负责其选择器在首选项屏幕中的显示方式。

setLayoutResouce() 函数为 Dialog 本身设置资源，而不是在 Preference 屏幕中看到的行。这很令人困惑，我错误地尝试在首选项屏幕中使用它来调整那里的选择器布局。

解决方案是在那里覆盖`onCreateView`并返回自定义布局。对我来说，这是违反直觉的，因为在大多数其他情况下，该方法通常控制最终视图。

我已经将我的子类化了`Preference (DialogPreference)`，所以我所要做的就是添加以下内容......

```
@Override
protected View onCreateView (ViewGroup parent) {
    LayoutInflater inflater = (LayoutInflater)   getContext().getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    View customRow = inflater.inflate(R.layout.preferences_station_list_row, null);
    ((ImageButton) customRow.findViewById(R.id.pref_delete_station)).setOnClickListener(new OnClickListener() {      
        @Override
        public void onClick(View v) {
           Log.i("c","clicked");
        }
    });

    customRow.setOnClickListener(new OnClickListener() {
        @Override
        public void onClick(View v) {
            showDialog(null);
        }
    });
    customRow.setClickable(true);
    return customRow;
} 
```

我遇到的一个问题是，起初行本身不再可点击，但按钮是。我必须在整个视图上添加一个侦听器并手动调用`ShowDialog().` 现在唯一缺少的是，当从“首选项”屏幕单击时，该项目不再显示突出显示。知道我应该应用什么样式，以便列表像往常一样显示突出显示吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T21:35:28.790

您可以扩展`DialogPreference`和覆盖`onBindDialogView(View view)`. 在此方法中，您可以执行以下操作：

```
@Override
protected void onBindDialogView(View view) {

    ((ImageButton) view.findViewById(R.id.pref_delete_station)).setOnClickListener(new OnClickListener() {      
        @Override
        public void onClick(View v) {
            // TODO Auto-generated method stub

        }
    });

    super.onBindDialogView(view);
} 
```

您的子类`DialogPreference`可以保存与其所代表的项目相关的任何状态/值。

看看[这个](https://stackoverflow.com/questions/4505845/concise-way-of-writing-new-dialogpreference-classes)关于扩展的一般准则的问题`DialogPreference`。

希望这可以帮助！

# java - 使用 Java XML 数字签名 API 的 xml 签名的摘要值错误

> ID：10404434
> 
> 赞同：26
> 
> 时间：2012-05-01T21:11:42.577
> 
> 标签：java, xml, digital-signature, xmlsec

我需要将签名的 XML 文件发送给巴西的政府机构。问题是我的 Java 代码计算的摘要（使用[Java XML 数字签名 API ）与使用](http://java.sun.com/developer/technicalArticles/xml/dig_signature_api/)[XMLSEC](http://www.aleksey.com/xmlsec/)等其他工具生成的摘要不同。

这是我用来为某些 XML 节点生成 XML 签名的代码：

```
private synchronized void sign(XmlObject obj) throws Exception {
        initKeystore();
        XMLSignatureFactory fac = XMLSignatureFactory.getInstance("DOM");
        List<Transform> transformList = new ArrayList<Transform>();
        Transform envelopedTransform = fac.newTransform(Transform.ENVELOPED, (TransformParameterSpec) null);
        Transform c14NTransform = fac.newTransform("http://www.w3.org/TR/2001/REC-xml-c14n-20010315",
                (TransformParameterSpec) null);
        transformList.add(envelopedTransform);
        transformList.add(c14NTransform);
        Reference ref = fac.newReference("", fac.newDigestMethod(DigestMethod.SHA1, null),
                Collections.singletonList(fac.newTransform(Transform.ENVELOPED, (TransformParameterSpec) null)), null,
                null);
        SignedInfo si = fac.newSignedInfo(
                fac.newCanonicalizationMethod(CanonicalizationMethod.INCLUSIVE, (C14NMethodParameterSpec) null),
                fac.newSignatureMethod(SignatureMethod.RSA_SHA1, null), Collections.singletonList(ref));
        KeyStore ks = KeyStore.getInstance("PKCS12");
        ks.load(new FileInputStream(System.getProperty("javax.net.ssl.keyStore")),
                System.getProperty("javax.net.ssl.keyStorePassword").toCharArray());
        KeyStore.PrivateKeyEntry keyEntry = (KeyStore.PrivateKeyEntry) ks.getEntry("entry",
                new KeyStore.PasswordProtection(System.getProperty("javax.net.ssl.keyStorePassword").toCharArray()));

        X509Certificate cert = (X509Certificate) keyEntry.getCertificate();

        // Create the KeyInfo containing the X509Data.
        KeyInfoFactory kif = fac.getKeyInfoFactory();
        X509Data xd = kif.newX509Data(Collections.singletonList(cert));
        KeyInfo ki = kif.newKeyInfo(Collections.singletonList(xd));
        // Instantiate the document to be signed.

        Element el = (Element) obj.getDomNode().getFirstChild();
        String id = el.getAttribute("Id");

        DOMSignContext dsc = new DOMSignContext(keyEntry.getPrivateKey(), el);
        // Create the XMLSignature, but don't sign it yet.
        XMLSignature signature = fac.newXMLSignature(si, ki);
        // Marshal, generate, and sign the enveloped signature.
        signature.sign(dsc);

    } 
```

如果我尝试使用 xmlsec 验证生成的 XML，则会收到以下错误：

```
$ xmlsec1 --verify consulta.xml 
func=xmlSecOpenSSLEvpDigestVerify:file=digests.c:line=229:obj=sha1:subj=unknown:error=12:invalid data:data and digest do not match
FAIL 
```

但是，如果我尝试使用 xmlsec（使用相同的私钥）签署同一个文件（consult.xml），该错误就会消失：

```
xmlsec1 --sign --output doc-signed.xml --privkey-pem cert.pem consulta.xml 
```

Consult.xml 和 doc-signed.xml（由 xmlsec 生成）之间的区别在于 SignatureValue 和 DigestValue 标记的内容：

咨询.xml：

```
<DigestValue>Ajn+tfX7JQc0HPNJ8KbTy7Q2f8I=</DigestValue>
...
<SignatureValue>Q1Ys0Rtj8yL2SA2NaQWQPtmNuHKK8q2anPiyLWlH7mOIjwOs0GEcD0WLUM/BZU0Q
T0kSbDTuJeTR2Ec9wu+hqXXbJ76FpX9/IyHrdyx2hLg0VhB5RRCdyBEuGlmnsFDf
XCyBotP+ZyEzolbTCN9TjCUnXNDWtFP1YapMxAIA0sth0lTpYgGJd8CSvFlHdFj+
ourf8ZGiDmSTkVkKnqDsj8O0ZLmbZfJpH2CBKicX+Ct7MUz2sqVli4XAHs6WXX+E
HJpbOKthS3WCcpG3Kw4K50yIYGTkTbWCYFxOVsMfiVy4W/Qz15Vxb8chD8LM58Ep
m/szmvnTAESxv/piDr7hyw==</SignatureValue> 
```

文档签名.xml：

```
<DigestValue>w6xElXJrZw3G86OsNkWav+pcKJo=</DigestValue>
...
<SignatureValue>YmUsnlnAY9uLhlfVBLhB8K8ArxMOkOKZJoQ6zgz55ggU6vJCO9+HWJCKQJp6Rvn/w5PCAFY0KJRb
r6/WhHML0Z+Q6TSuIL8OTvJ3iPoROAK6uy07YAflKOUklqk4uxgfMkR+hWMCyfITJVCVZo/MXmPy
g7YwmztoSlGH+p6+ND5n2u47Y2k6SpIvw3CUxwAVQkD0Hsj3G58cbUbrFCoyPVGOe4zJ9c1HPsMW
KzBEFe3QETzPJ8I1B7EEVi5oDvzXE2rMTH4K7zvNGnXpBNGwnSjEOticlqKVP5wyUD7CPwgF1Wgy
Z0njvlaW3K8YmAY8fc70v/+wSO6Fu+0zj18Xeg==</SignatureValue> 
```

我不会发布任何一个文件的其余部分，因为它们是相等的，并且会使这篇文章更加冗长。

据我所知，接收此 XML 文件的 Web 应用程序是一个 .NET 应用程序，它计算的签名摘要与我的 Java 代码不同（很像 xmlsec 所做的）。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-06T18:54:42.427

如果现在回答还不算太晚：

您在代码中创建了 2 个变换（envelopeTransform 和 c14NTransform），但不要使用它们。

您使用一个新的 Transform.ENVELOPED 创建引用。 [http://www.w3.org/TR/2001/REC-xml-c14n-20010315](http://www.w3.org/TR/2001/REC-xml-c14n-20010315) (C14N) 转换未应用。

现在，我不确定 XML 安全标准所说的这种情况下的行为应该是什么。也许其他工具也会自动应用 C14N 变换。

我确定如果您不指定任何转换，JDK 将至少应用 C14N 转换。

基本上改变fac.newReference（“”，...）并将transformList而不是Collections.singletonList（）传递给它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-18T09:58:53.693

理想情况下，DigestValue 元素包含 Java XML 签名 API 中实际的 base64 编码摘要值。您能否验证您从 XMLSec 创建的摘要值也是 base64 编码的。

# c - 用于演示矩阵的简单 C 图形库

> ID：10404436
> 
> 赞同：1
> 
> 时间：2012-05-01T21:11:46.557
> 
> 标签：c, graphics, matrix

我被要求显示一个相当大的矩阵，比如 200*300。当我将其输出到控制台时，这有点难看..

矩阵在迭代过程中会发生变化，我也必须展示这一点。我想知道是否有一个简单的工具可以用来显示这个矩阵？希望我可以在我的 C 程序中调用它。

我没有任何图形编程经验。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T21:14:12.127

您可以使用 SDL (libsdl.org) 创建一个显示窗口并将每个字符作为窗口上的一个像素输出。

这是一个测试应用程序，您可以看看它是如何工作的：http: [//friedspace.com/SDLTest.c](http://friedspace.com/SDLTest.c)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T21:14:39.393

我真的不认为您想为此进入图形库。相反，我建议将数据转储到输出文件，然后从那里处理。

一方面，您可以将其格式化为固定宽度的字段，然后使用文本编辑器查看文本文件：

```
000  001  002
099  098  097
... 
```

或者，您可以考虑将其转储为[CSV](http://en.wikipedia.org/wiki/Comma-separated_values)，然后将其导入 Excel 之类的文件中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T21:16:53.640

试试 GNUPlot：

OSX 安装： http: [//www.miscdebris.net/blog/2009/09/16/install-gnuplot-on-mac-os-x/](http://www.miscdebris.net/blog/2009/09/16/install-gnuplot-on-mac-os-x/)

项目主页： [http ://www.gnuplot.info/download.html](http://www.gnuplot.info/download.html)

我在许多项目中都使用过它。生成图非常容易。在您的情况下，您可以创建一个散点图，并通过几个简单的步骤将其导出为 JPEG。

如果您不想构建并将其集成到您的应用程序中，您可以通过“系统”功能将命令发送到预构建的 GNUPlot 应用程序。

[http://www.cplusplus.com/reference/clibrary/cstdlib/system/](http://www.cplusplus.com/reference/clibrary/cstdlib/system/)

# java - Cloudera Hadoop VM 没有日食

> ID：10404441
> 
> 赞同：1
> 
> 时间：2012-05-01T21:12:04.433
> 
> 标签：java, hadoop, mapreduce, cloudera

我刚刚为 VirtualBox 和 VMWarePlayer 下载了最新的 Cloudera VM 并启动了它们。 [https://ccp.cloudera.com/display/SUPPORT/Cloudera%27s+Hadoop+Demo+VM](https://ccp.cloudera.com/display/SUPPORT/Cloudera%27s+Hadoop+Demo+VM)

但是，除了安装 hadoop 之外，它们不再包含任何东西（如 eclipse 等）。我清楚地记得我在某个时候尝试过 cloudera VM，附带了整个安装预配置的示例、示例数据、eclipse 等。我在这里验证了这一点：[http ://www.philippeadjiman.com/blog/2009/12/07/hadoop -tutorial-part-1-setting-up-your-mapreduce-learning-playground/](http://www.philippeadjiman.com/blog/2009/12/07/hadoop-tutorial-part-1-setting-up-your-mapreduce-learning-playground/)

难道我做错了什么？？

有没有地方可以找到旧的虚拟机？SJ

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T17:49:55.163

这也许是一个有意义的改变……他们怎么知道你想要什么？

我相信图像是centos 5，所以只要`yum search eclipse`找到你想要的包（`yum install package_name`）

# installation - Inno IDE 安装后消除视图复选框

> ID：10404445
> 
> 赞同：1
> 
> 时间：2012-05-01T21:12:45.120
> 
> 标签：installation, windows-installer, inno-setup

安装完成后，安装程序会为用户提供一个标记为“查看”的复选框选项，让用户可以选择在安装完成后打开安装文件夹。如何禁用此功能？

安装完成后，我不希望用户可以选择“查看”任何内容。只需关闭安装程序。

**更新：**这是脚本：

```
; Script generated by the Inno Setup Script Wizard.
; SEE THE DOCUMENTATION FOR DETAILS ON CREATING INNO SETUP SCRIPT FILES!

#define MyAppName "My App"
#define MyAppVersion "1.0"
#define MyAppPublisher "Blah, LLC"
#define MyAppURL "http://www.blah.com/"

[Setup]
; NOTE: The value of AppId uniquely identifies this application.
; Do not use the same AppId value in installers for other applications.
; (To generate a new GUID, click Tools | Generate GUID inside the IDE.)
AppID={{f47ac10b-58cc-4372-a567-0e02b2c3d479}
AppName={#MyAppName}
AppVersion={#MyAppVersion}
;AppVerName={#MyAppName} {#MyAppVersion}
AppPublisher={#MyAppPublisher}
AppPublisherURL={#MyAppURL}
AppSupportURL={#MyAppURL}
AppUpdatesURL={#MyAppURL}
CreateAppDir=false
LicenseFile=Release\EULA.rtf
SetupIconFile=Release\bin\logo.ico
Compression=lzma/Max
SolidCompression=true
AppCopyright=Blah, LLC
AppVerName={#MyAppName}
DisableFinishedPage=yes
VersionInfoVersion=1.0
VersionInfoCompany=Blah, LLC
VersionInfoDescription=My description here.
VersionInfoCopyright=2012
VersionInfoProductName=My App
VersionInfoProductVersion=1.0

[Languages]
Name: "english"; MessagesFile: "compiler:Default.isl"

[Files]
Source: Release\bin\glassfish-3.1.2; DestDir: {sd}\MyApp; Flags: ignoreversion recursesubdirs createallsubdirs external; 
; NOTE: Don't use "Flags: ignoreversion" on any shared system files
Source: {src}\README.txt; DestDir: {tmp}; Attribs: ReadOnly; Flags: isreadme external dontcopy;

[Types]
Name: full; Description: "Full Installation";
Name: custom; Description: "Custom Installation"; Flags: IsCustom;

[Components]
Name: webserver; Description: "GlassFish 3.1.2 Application Server"; Types: full custom; ExtraDiskSpaceRequired: 100851712; 
Name: sqlserver; Description: "SQL Server Express 2008 R2"; ExtraDiskSpaceRequired: 745537536; Types: full custom;
Name: sqlserver\sqlserver_x64; Description: "Microsoft SQL Server Express (x64)"; Flags: exclusive; Types: full custom; 
Name: sqlserver\sqlserver_x86; Description: "Microsoft SQL Server Express (x86)"; Flags: exclusive; Types: full custom;

[Tasks]
Components: webserver; Name: glassfishservice; Description: "Register the web server as a Windows Service."; GroupDescription: "Web Server Options";

[Run]
Tasks: glassfishservice; Components: webserver; Filename: asadmin; Parameters: "create-service MyApp"; WorkingDir: "{sd}\MyApp\bin"; StatusMsg: "Creating GlassFish service."; 
Tasks: glassfishservice; Components: webserver; Filename: net; Parameters: "start ""MyApp GlassFish Server"""; StatusMsg: "Starting Windows service."; 
; https://blogs.oracle.com/foo/entry/automatic_starting_of_servers_in  AND   https://blogs.oracle.com/foo/entry/how_to_make_v3_platform
Filename: SQLEXPRWT_x86_ENU.exe; WorkingDir: {src}\bin; Description: "Installs SQL Server 32-bit edition."; StatusMsg: "Installing SQL Server Express 2008..."; Components: sqlserver\sqlserver_x86; Flags: HideWizard 32bit; 
Filename: SQLEXPRWT_x64_ENU.exe; WorkingDir: {src}\bin; Description: "Installs SQL Server 64-bit edition."; StatusMsg: "Installing SQL Server Express 2008..."; Components: sqlserver\sqlserver_x64; Flags: HideWizard 64bit; 
Components: "sqlserver sqlserver\sqlserver_x64 sqlserver\sqlserver_x86"; Filename: sqlcmd; Parameters: "-S COMPUTER\SQLEXPRESS -i {sd}\bin\script.sql"; Description: "Creating database."; 

[InnoIDE_PostCompile]
Name: "C:\Program Files\PowerISO\piso.exe"; Parameters: "create -o """"{#MyAppName} - v{#MyAppVersion}.iso"""" -add Release /"; Flags: CmdPrompt; 

[UninstallRun]
Tasks: glassfishservice; Components: webserver; Filename: net; Parameters: "stop ""MyApp GlassFish Server"""; StatusMsg: "Stopping Windows service."; 
Tasks: glassfishservice; Components: webserver; Filename: asadmin; Parameters: "_delete-service MyApp"; WorkingDir: "{sd}\MyApp\bin"; StatusMsg: "Destroying GlassFish service.";

[Dirs] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T22:52:25.217

如果这是 InnoSetup 安装，请检查您的`[Run]`部分以获取`postinstall`条目并将其删除。在[文档](http://www.jrsoftware.org/ishelp/index.php?topic=runsection)`postinstall`中定义为：

> 安装后
> 
> ```
> Valid only in a [Run] section. Instructs Setup to create a checkbox on the Setup Completed wizard page. The user can uncheck or 
> ```
> 
> 选中此复选框，从而选择是否应处理此条目。以前这个标志被称为 showcheckbox。

完成页面上复选框的另一个原因是`isreadme`标志。从[文档](http://www.jrsoftware.org/ishelp/index.php?topic=runsection)：

> 是自述文件
> 
> 文件是“README”文件。安装中只有一个文件可以具有此标志。当一个文件有这个标志时，用户会询问他/她是否想在安装完成后查看 README 文件。如果选择“是”，安装程序将使用该文件类型的默认程序打开该文件。因此，README 文件应始终以 .txt、.wri 或 .doc 之类的扩展名结尾。
> 
> 请注意，如果安装程序必须重新启动用户的计算机（由于安装带有标志 restartreplace 的文件，或者如果 AlwaysRestart [Setup] 部分指令为 yes），则不会为用户提供查看 README 文件的选项

# c - getopt.h：在 Windows 中编译 Linux C 代码

> ID：10404448
> 
> 赞同：40
> 
> 时间：2012-05-01T21:12:58.033
> 
> 标签：c, visual-studio, build, command-line-arguments, getopt

我正在尝试获取一组九个 *.c 文件（和九个相关的 *.h 文件）以在 Windows 下编译。

该代码最初是在 Linux 中设计的，使用标准 GNU-Linux/C 库“getopt.h”获取命令行参数。而且该库不适用于在 Windows 中构建 C 代码。

我想忽略我的代码现在所做的事情并提出以下问题。对于那些熟悉这个 C 库“getopt.h”的人：如果它依赖于 POSIX 样式的命令行参数，是否可以在 Windows 中构建和运行我的代码？或者我是否必须重新编写代码才能在 Windows 上工作，以不同的方式传递输入文件（并放弃“getopt.h”依赖项）？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2013-06-19T15:46:40.897

`getopt()`实际上是一个非常简单的功能。我为它做了一个[github gist ，](https://gist.github.com/superwills/5815344)[这里](http://www.raspberryginger.com/jbailey/minix/html/lib_2posix_2getopt_8c-source.html)的代码也在下面

```
#include <string.h>
#include <stdio.h>

int     opterr = 1,             /* if error message should be printed */
  optind = 1,             /* index into parent argv vector */
  optopt,                 /* character checked for validity */
  optreset;               /* reset getopt */
char    *optarg;                /* argument associated with option */

#define BADCH   (int)'?'
#define BADARG  (int)':'
#define EMSG    ""

/*
* getopt --
*      Parse argc/argv argument vector.
*/
int
  getopt(int nargc, char * const nargv[], const char *ostr)
{
  static char *place = EMSG;              /* option letter processing */
  const char *oli;                        /* option letter list index */

  if (optreset || !*place) {              /* update scanning pointer */
    optreset = 0;
    if (optind >= nargc || *(place = nargv[optind]) != '-') {
      place = EMSG;
      return (-1);
    }
    if (place[1] && *++place == '-') {      /* found "--" */
      ++optind;
      place = EMSG;
      return (-1);
    }
  }                                       /* option letter okay? */
  if ((optopt = (int)*place++) == (int)':' ||
    !(oli = strchr(ostr, optopt))) {
      /*
      * if the user didn't specify '-' as an option,
      * assume it means -1.
      */
      if (optopt == (int)'-')
        return (-1);
      if (!*place)
        ++optind;
      if (opterr && *ostr != ':')
        (void)printf("illegal option -- %c\n", optopt);
      return (BADCH);
  }
  if (*++oli != ':') {                    /* don't need argument */
    optarg = NULL;
    if (!*place)
      ++optind;
  }
  else {                                  /* need an argument */
    if (*place)                     /* no white space */
      optarg = place;
    else if (nargc <= ++optind) {   /* no arg */
      place = EMSG;
      if (*ostr == ':')
        return (BADARG);
      if (opterr)
        (void)printf("option requires an argument -- %c\n", optopt);
      return (BADCH);
    }
    else                            /* white space */
      optarg = nargv[optind];
    place = EMSG;
    ++optind;
  }
  return (optopt);                        /* dump back option letter */
} 
```

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2012-05-01T21:20:16.310

你是对的。`getopt()`是 POSIX，而不是 Windows，您通常必须重新编写所有命令行参数解析代码。

幸运的是，有一个项目 Xgetopt，它适用于 Windows/MFC 类。

[http://www.codeproject.com/Articles/1940/XGetopt-A-Unix-compatible-getopt-for-MFC-and-Win32](http://www.codeproject.com/Articles/1940/XGetopt-A-Unix-compatible-getopt-for-MFC-and-Win32)

如果您可以在您的项目中使用它，它应该会为您节省相当多的编码，并防止您不得不重新进行所有解析。

此外，它还带有一个不错的支持 GUI 的演示应用程序，您应该会发现它很有帮助。

祝你好运！

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-06-10T09:38:02.070

可以使用 MinGW 运行时中的代码（由 Todd C. Miller 编写）：

[http://sourceforge.net/apps/trac/mingw-w64/browser/trunk/mingw-w64-crt/misc](http://sourceforge.net/apps/trac/mingw-w64/browser/trunk/mingw-w64-crt/misc)

我用这些文件和 CMake 脚本创建了一个小库（可以生成一个 VS 项目）：

[https://github.com/alex85k/wingetopt](https://github.com/alex85k/wingetopt)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-05-01T21:34:14.940

我*确实*`getopt`在windows下编译了代码。

我这样做是因为我想在 Windows（命令行）应用程序中**明确**使用其命令行解析功能。

我成功地使用`VC2010`.

据我记得，我这样做没有遇到任何重大问题。

[getopt.c](http://svn.savannah.gnu.org/svn/acct/trunk/lib/getopt.c) [获取optl.c](http://svn.savannah.gnu.org/svn/acct/trunk/lib/getopt1.c)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-09-09T08:33:51.780

如果您只想在 Visual c++ 中使用 getopt 而没有其他依赖项，我已经从最新的 gnu libc 2.12 移植了 getopt.c，具有所有新功能。唯一的区别是您必须使用 TCHAR 而不是 char，但这非常常见于windows。

只需下载源代码，制作，将 libgetopt.lib 和 getopt.h getopt_int.h 复制到您的项目中。

您也可以使用根目录中的 CMakeList.txt 来制作它。

[从 github 下载源代码](https://github.com/bugparty/getopt_vc)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-01-15T19:49:30.583

您可以尝试将 glib-2.0 作为替代方案。只需要一个选项解析器就有点大了。好的一面是可以使用油嘴滑舌中的所有其他精彩玩具。

老实说，我还没有尝试过让它工作（我主要坚持使用 Linux），所以 YMMV。

让 glib 在 Windows 中工作：[HowTo](http://www.etechplanet.com/blog/visual-studio-2008-configuration-for-gtk2b-gui-development.aspx)

哦，您可能会探索将 mingw 用于构建环境，并将 Visual Studio 用于您的 IDE。

Win32 的 Glib：[操作方法](http://mathieu.carbou.free.fr/wiki/index.php?title=Glib_for_Win32)

任何人，希望这会有所帮助。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-04-27T12:18:53.817

根据我对文档的阅读，头文件 getopt.h 特定于与 Linux（和 Hurd）一起使用的 GNU C 库。getopt 函数本身已由 POSIX 标准化，它表示应该在 unistd.h 中声明它以及 optind optarg 等

我自己无法在 Visual Studio 上尝试此操作，但值得检查 unistd.h 是否存在并声明此函数，因为 Visual Studio 确实提供了一些其他 POSIX 函数。

如果没有，那么我肯定会获取 getopt 的实现，而不是重写参数解析以在没有它的情况下工作。编写 Getopt 是为了让程序员更轻松，并为使用命令行参数的程序用户提供更一致的操作。不过，请检查许可证。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-05-01T21:22:17.367

据我记得`getopt.h`，它所做的只是提供了一个方便的解析器来处理来自你的 main 函数的 argv：

```
int main(int argc, char * argv[])
{
} 
```

Windows 控制台程序仍然有一个 main 方法，因此您可以简单地循环遍历您的 argv 数组并自己解析参数。例如

```
for ( int i = 1; i < argc; i++ )
{
  if (!strcmp(argv[i], "-f"))
    filename = argv[++i];
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-09-13T16:53:42.470

getopt.h 存在于 git 中，我已经下载了它，它对我有用：

[https://gist.github.com/ashlyy/7776712](https://gist.github.com/ashelly/7776712)

# dojo - 网站不显示将 Dojo 从 1.5 升级到 1.7 的 dojo 主题或小部件？

> ID：10404449
> 
> 赞同：0
> 
> 时间：2012-05-01T21:12:58.890
> 
> 标签：dojo

在我使用 dojo 1.5 实现一个小型 Web 界面之前，仅引用本地文件夹（dojo、dijit、dojox）的路径并使用 dojo.require 加载我想要的模块，它运行良好。现在我升级到 1.7，突然之间即使使用 url 引用它也不起作用。我正在引用其中一个演示项目 [http://download.dojotoolkit.org/release-1.7.1/dojo-release-1.7.1/dijit/themes/themeTester.html](http://download.dojotoolkit.org/release-1.7.1/dojo-release-1.7.1/dijit/themes/themeTester.html) 并希望通过一些更改来重新创建页面. 我把它分解成最简单的形式，只有主菜单，它并没有这样显示，而只是彼此下方的文本术语。

```
 <meta http-equiv="Content-type" content="text/html; charset=utf-8">

<title>Theme Previewer</title>

<script type="text/javascript" dojoConfig="parseOnLoad:false, 
      async:true"  
     src="http://ajax.googleapis.com/ajax/libs/dojo/1.7.2/dojo/dojo.js" > </script>
<link rel="stylesheet" href="http://ajax.googleapis.com/ajax/libs/dojo/1.7.2/dijit/themes/claro/document.css"/>
<link rel="stylesheet" href="http://ajax.googleapis.com/ajax/libs/dojo/1.7.2/dijit/themes/claro/claro.css"/>
<link rel="stylesheet" href="Styles/demo.css"/>

     <script type="text/javascript">
    var dojoConfig = {
        baseUrl: "//ajax.googleapis.com/ajax/libs",
        tlmSiblingOfDojo: false,
        packages: [
        { name: "dojo", location: "//ajax.googleapis.com/ajax/libs/dojo/1.7.1/" },
        { name: "dijit", location: "//ajax.googleapis.com/ajax/libs/dojo/1.7.1/" },
        { name: "dojox", location: "//ajax.googleapis.com/ajax/libs/dojo/1.7.1/" }
        ]
    };
</script>
  <!--script type="text/javascript" src="Scripts/src.js"></script-->

  </head>
  <body class="claro">
<div id="main" data-dojo-type="dijit.layout.BorderContainer" data-dojo-props="design:'sidebar', gutters:=false">

    <div id="header" data-dojo-type="dijit.MenuBar" data-dojo-props="region:'top'">
        <div data-dojo-type="dijit.PopupMenuBarItem" id="edit">
            <span>Edit</span>
            <div data-dojo-type="dijit.Menu" id="editMenu">
                <div data-dojo-type="dijit.MenuItem" id="cut" data-dojo-props="
                    iconClass:'dijitIconCut'
                ">Cut</div>
                <div data-dojo-type="dijit.MenuItem" id="copy" data-dojo-props="
                    iconClass:'dijitIconCopy'
                ">Copy</div>
                <div data-dojo-type="dijit.MenuItem" id="paste" data-dojo-props="iconClass:'dijitIconPaste'">Paste</div>
                <div data-dojo-type="dijit.MenuSeparator" id="separator"></div>
                <div data-dojo-type="dijit.MenuItem" id="undo" data-dojo-props="iconClass:'dijitIconUndo'">Undo</div>
            </div>
        </div>
        <div data-dojo-type="dijit.PopupMenuBarItem" id="view">
            <span>View</span>
            <div data-dojo-type="dijit.Menu" id="viewMenu">
                <div data-dojo-type="dijit.MenuItem">Normal</div>
                <div data-dojo-type="dijit.MenuItem">Outline</div>
                <div data-dojo-type="dijit.PopupMenuItem">
                    <span>Zoom</span>
                    <div data-dojo-type="dijit.Menu" id="zoomMenu">
                        <div data-dojo-type="dijit.MenuItem">50%</div>
                        <div data-dojo-type="dijit.MenuItem">75%</div>
                        <div data-dojo-type="dijit.MenuItem">100%</div>
                        <div data-dojo-type="dijit.MenuItem">150%</div>
                        <div data-dojo-type="dijit.MenuItem">200%</div>
                    </div>
                </div>
            </div>
        </div>
        <div data-dojo-type="dijit.PopupMenuBarItem" id="themes">
            <span>Themes</span>
            <div data-dojo-type="dijit.Menu" id="themeMenu"></div>
        </div>
        <div data-dojo-type="dijit.PopupMenuBarItem" id="dialogs">
            <span>Dialogs</span>
            <div data-dojo-type="dijit.Menu" id="dialogMenu">
                <div data-dojo-type="dijit.MenuItem" data-dojo-props="onClick: showDialog">slow loading</div>
                <div data-dojo-type="dijit.MenuItem" data-dojo-props="onClick: showDialogAb">action bar</div>
            </div>
        </div>
        <div data-dojo-type="dijit.PopupMenuBarItem" id="inputPadding">
            <span>TextBox Padding</span>
            <div data-dojo-type="dijit.Menu" id="inputPaddingMenu">
                <div data-dojo-type="dijit.CheckedMenuItem" data-dojo-props="onClick:setTextBoxPadding, checked:true">theme default</div>
                <div data-dojo-type="dijit.CheckedMenuItem" data-dojo-props="onClick:setTextBoxPadding">0px</div>
                <div data-dojo-type="dijit.CheckedMenuItem" data-dojo-props="onClick:setTextBoxPadding">1px</div>
                <div data-dojo-type="dijit.CheckedMenuItem" data-dojo-props="onClick:setTextBoxPadding">2px</div>
                <div data-dojo-type="dijit.CheckedMenuItem" data-dojo-props="onClick:setTextBoxPadding">3px</div>
                <div data-dojo-type="dijit.CheckedMenuItem" data-dojo-props="onClick:setTextBoxPadding">4px</div>
                <div data-dojo-type="dijit.CheckedMenuItem" data-dojo-props="onClick:setTextBoxPadding">5px</div>
            </div>
        </div>
        <div data-dojo-type="dijit.PopupMenuBarItem" id="help">
            <span>Help</span>
            <div data-dojo-type="dijit.Menu" id="helpMenu">
                <div data-dojo-type="dijit.MenuItem">Help Topics</div>
                <div data-dojo-type="dijit.MenuItem">About Dijit</div>
            </div>
        </div>
        <div data-dojo-type="dijit.PopupMenuBarItem" data-dojo-props="disabled:true">
            <span>Disabled</span>
            <div data-dojo-type="dijit.Menu">
                <div data-dojo-type="dijit.MenuItem">You should not see this</div>
            </div>
        </div>
    </div>

    </div> 
```

我有一个单独的文件，其中引用了要包含的项目：

```
define([
"dojo/_base/array",
"dojo_base/config",
"dojo/dom",
"dojo/dom-class",
"dojo/dom-construct",
"dojo/_base/kernel",
"dojo/query",
"dojo/ready",
"dojo/_base/window",
"dojo/_base/fx",
"dijit/registry",
"dijit/MenuItem",
"dojo/date/locale",
"dojo/parser",
"dojo/data/ItemFileReadStore",
"dijit/tree/ForestStoreModel",
"dojo/number", //// dojo/number/format
"dojo/dnd/Source",// // dojo/dnd/Source
"dojo/_base/json", //// dojo/toJson
  "dojox/grid/DataGrid",
    "dojo/data/ItemFileReadStore",
    "dojo/parser",
    "dijit/form/DateTextBox",
    "dojox/widget/AnalogGauge",
    "dijit/layout/ContentPane",
    "dijit/layout/TabContainer",
    "dijit/layout/BorderContainer",
    "dijit/layout/AccordionContainer",
    "dijit/form/Button",
    "dojox/widget/AnalogGauge",
    "dojox/widget/gauge/AnalogArcIndicator",
    "dojox/widget/gauge/AnalogNeedleIndicator",
    "dojox/widget/gauge/AnalogArrowIndicator",
    "dijit/MenuBar",
    "dijit/PopupMenuBarItem",
    "dijit/Menu",
    "dijit/MenuItem",
    "dijit/Tree",
    "dijit/MenuSeparator",
    "dijit/Calendar",
    "dijit/ColorPalette",
"dijit/dijit-all" // dijit.*
["dojo/dom", "dojo/domReady!"], function(dom){
var greeting = dom.byId("greeting");
greeting.innerHTML += " from Dojo!";
}]); 
```

希望这能澄清一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T10:51:44.413

您粘贴的 HTML 在拉入 Dojo 时会指定“parseOnLoad: false”。除非您显式调用 parser.parse()，否则 Dojo 将无法实际解析您的任何 data-dojo-type。如果将其更改为“parseOnLoad：true”，这有帮助吗？（这不再是推荐的方法，但尝试仍然有用。）

您似乎在 HTML 中混合了 Dojo 1.7.2 和 1.7.1 引用，这有点奇怪。你需要那个dojoConfig吗？Dojo 应该能够找到 dijit + dojox 作为 dojo 目录的兄弟，即使在 CDN 上也是如此。

但是了解“不起作用”的实际含义肯定会有所帮助：您是否收到错误，没有内容出现？

后来补充回答：

1.  确保您从 Web 服务器运行文件，而不是本地文件，否则 XHR 请求将失败
2.  摆脱你的 dojoConfig 对象：它没有帮助
3.  您的单独文件看起来很狡猾：您正在进行一些奇怪的数组包围
4.  您顶部 div 上的 data-dojo-props 有点损坏。写“排水沟：'假'”，而不是“排水沟：=假”

将此添加到您的 HTML 中。它将加载正确的模块并手动启动解析器。

```
<script>
require(["dojo/parser", "dijit/dijit-all", "dojo/domReady!"], function(parser) {
  parser.parse();
});
</script> 
```

这将使您的菜单项显示，尽管在您添加 onClick 处理程序函数之前它不会完全工作。

最后，确保在浏览器控制台中查看错误和警告：这将提供大量输出，帮助人们诊断未来的问题。如果您在加载模块时遇到问题，请尝试关闭异步，因为异步有时会使诊断变得更加困难。

# c# - 打印或直观地表示加密数据

> ID：10404459
> 
> 赞同：0
> 
> 时间：2012-05-01T21:13:39.177
> 
> 标签：c#, .net, printing, visualization, barcode

我有一个场景需要我生成一个带有加密数据的打印页面，以后可以将其扫描到我们的应用程序中。很像条形码，但已加密。

要加密的文本量将在 1KB 到 10KB 之间，但将来可能会增加。很可能不超过 1MB。

我开发文档处理系统，因此我了解打印的注意事项。扫描通常会为打印页面添加属性，例如倾斜、旋转、伪影等。

所以问题是：

*   直观地表示这些数据量的最佳格式是什么？不是我假设的条形码。
*   无论格式如何，空间都是至关重要的，因为我们希望将数据压缩到单个 A4 页面中。我在想带有代码表压缩的 Base64 编码可能是一个候选者？有什么想法吗。

**编辑**：似乎条形码是唯一可行的解​​决方案。数据本质上是一系列数字，因此我可以使用以 10 为底的数字，然后在加密之前将它们压缩到代码/索引表中。或者在这里使用更高的基数会更明智？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T21:19:15.510

申请是否在线？如果是这样，您是否考虑过将数据安全地存储在服务器中（如果您真的需要加密），并在您的页面上以[QR 码](http://en.wikipedia.org/wiki/QR_code)的形式打印访问令牌（或简单的网络参考） ？扫描令牌后，您的应用程序可以从服务器检索实际数据。

**编辑**
虽然上述内容将为您提供更高的可靠性和可扩展性，但您仍然可以将数据直接存储在页面上的二维码中。您只需要加密到字母数字空间（[使用 Base64 编码](https://stackoverflow.com/a/7269464/55487)）并将其存储为一系列 QR 码；[每个可以存储大约 3KB](https://stackoverflow.com/a/3964312/55487)，因此您会在页面上获得大量数据（只要页面没有损坏）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T22:31:54.890

我的建议是制作一个 C# 程序来获取您的数据，对其进行加密，然后通过 Base64 编码器运行它。然后我将获取 Base64 数据并从数据中创建 QR 码位图。然后我会缩小位图，这样你就可以在页面上放很多东西，然后我会打印这些二维码的页面。稍后您可以扫描它们，放大每个代码，然后读入数据。最后，你必须对它进行 Base64 解码，然后再解密！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T23:43:05.457

[大容量彩色条码](http://en.wikipedia.org/wiki/High_Capacity_Color_Barcode)是二维矩阵码，它使用彩色“条”（通常是三角形）对打印页面上的数据进行编码。维基百科的文章说他们每平方英寸可以存储 3kB。

显然，这些需要彩色打印和扫描硬件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-02T08:48:40.387

除非您需要能够从任何 Internet 或网络访问完全脱机运行，否则我建议对文本进行加密，对加密进行散列并将散列存储在 QR 码中。获取 2d 条或 QR 码来存储 64 或 128 位散列应该足够容易，并且足够可靠以进行扫描（因为这就是它们的设计目的）。可以使用商业 QR 扫描仪或软件使扫描变得容易。

如果您无法在打印和扫描之间访问公共服务器，那么二维条码是您唯一真正的选择，并且不会具有您想要的信息密度。您将有更好的机会将其存储在 RFID 或迷你 CD 上。

# sql-server - 为 SQL Server 2005 后端编写访问客户端应用程序

> ID：10404463
> 
> 赞同：1
> 
> 时间：2012-05-01T21:13:59.630
> 
> 标签：sql-server, forms, ms-access, windows-server-2008, database-connection

我正在编写一个库存/工资单系统，并将所有记录存储在 Windows Server 2008 R2 上运行 SQL Server 2005 的远程服务器上。我想知道如何开始在 MS-ACCESS 2010 中编写表单（非常基本）以将内容上传到数据库。我只是想测试一下，以确保一旦我实现了整个数据库，一切都会顺利进行并且不会出错。我想弄清楚如何制作一个将连接到数据库的表单，现在表单只是一个带有提交按钮的简单文本输入，它将上传条形码（字符串而不是图像）。

如果我需要澄清任何事情，请尽管问。

提前感谢您的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T23:28:27.380

1.  确保您在将使用 MS Access 的工作站上安装了 SQL 客户端驱动程序。您可以[在此处](http://www.microsoft.com/en-us/download/details.aspx?id=17943)下载（查找 sqlcnli）。
2.  最简单的入门方法是构建 ODBC DSN。然后，Access 可以使用该 DSN 链接到您的 SQL Server 表。[如何创建 DSN](https://www.google.com/?q=how+to+dsn+sql+server)
3.  在 Access 中，转到“外部数据”选项并选择 ODBC。找到您的 DSN，然后选择您希望 Access 链接到的表。
4.  在您的链接表显示在表列表中后，单击其中一个表，转到“创建”选项卡（2007，不确定 2010）并选择“表单”。这应该会使用您在单击“表单”按钮时选择的表格自动为您创建一个表单。无需为此表单编写代码或添加按钮。只要您在创建 DSN 时使用的用户名已授予所有 CRUD 的权限，默认表单就可以执行所有 CRUD 操作。

一些开发人员更喜欢使用 ADO（仅代码，没有链接表或表单向导）或传递查询从 Access 访问 SQL Server。我无法真正告诉您应该使用什么，因为它取决于许多不同的因素，包括（但不限于）项目规模、记录数量、技能水平、个人喜好等。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T23:31:35.647

Microsoft 有大量有用的“入门”文章。

这个解释了如何连接到 SQL Server： http: [//office.microsoft.com/en-us/access-help/import-or-link-access-to-sql-server-data-HA010341762.aspx](http://office.microsoft.com/en-us/access-help/import-or-link-access-to-sql-server-data-HA010341762.aspx)

这涵盖了各种形式： http: [//office.microsoft.com/en-us/access-help/CH010369205.aspx](http://office.microsoft.com/en-us/access-help/CH010369205.aspx)

去那里，你会发现很多东西可以帮助你做任何事情。

# c# - 在不参考当前页面的情况下解析相对（“~”）路径？

> ID：10404467
> 
> 赞同：3
> 
> 时间：2012-05-01T21:14:39.740
> 
> 标签：c#, asp.net

我正在编写一个通用库供我所有的网络项目使用。其中一项功能是永久重定向，如下所示：

```
public static void PermanentRedirect(string url, HttpResponse response, bool endResponse)
{
    url = //resolve url here. how?

    response.Status = "301 Moved Permanently";
    response.AddHeader("Location", url);

    if (endResponse) response.End();
} 
```

如何在不通过当前页面访问的情况下解析 URL `Page.ResolveUrl`？请注意，我*可以*更改方法签名，但我不希望这样做，因为我认为这会使 API 负担过重。

我有几个重载，所以我想要的用法是：

```
WebUtility.PermanentRedirect("~/somewhere/somepage.aspx") 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T21:36:55.627

我相信您可以使用[HttpRuntime.AppDomainAppVirtualPath](http://HttpRuntime.AppDomainAppVirtualPath)作为波浪号的直接替代品。

您也可以使用[VirtualPathUtility.ToAbsolute](http://msdn.microsoft.com/en-us/library/ms150163.aspx)，但它不喜欢查询字符串 - 因此您必须将它们解析出来（或者，最好使用 UriBuilder）。

哦 - 和题外话，但恕我直言，HttpResponse 的扩展方法会使语法更容易一些。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T21:31:33.453

[这种方法应该有效](http://msdn.microsoft.com/en-us/library/ms150160.aspx)：

```
url = VirtualPathUtiliy.ToAbsolute(url); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T21:18:41.270

您可以通过以下方式获取当前页面实例[`HttpContext.Handler`](http://msdn.microsoft.com/en-us/library/system.web.httpcontext.handler.aspx)：

```
var page = HttpContext.Current.Handler as Page;
if (page != null)
{
     // Use page instance, f.e. page.Request.Url;
} 
```

顺便说一句，你不需要通过`HttpResponse`：

```
HttpResponse response = HttpContext.Current.Response; 
```

[http://msdn.microsoft.com/en-us/library/system.web.httpcontext.response.aspx](http://msdn.microsoft.com/en-us/library/system.web.httpcontext.response.aspx)

# performance - Lighttpd 下载缓慢

> ID：10404468
> 
> 赞同：0
> 
> 时间：2012-05-01T21:14:55.087
> 
> 标签：performance, download, lighttpd

我有一个 1GB/s 专用、4GB 内存和 4cpus 的专用服务器。我有静态文件可供下载（从 300mb 到 900mb）。我正在测试 Apache、Nginx 和 Lighttpd。

Apache 制造了太多的威胁，在 200 次连接后它变得非常高，所以 apache 是不行的......

Nginx 在 100 次连接后变得非常高，所以它也是不行的。

到目前为止，Lighttpd 和单线程服务器一样非常好。有 500 个并发连接时，负载保持在 0.90 - 1.10（非常好），但我面临下载速度问题，即使我有 1GBps 专用端口，它也会变慢，我看到 iptraf 并且有 500 个并发连接它不会超过250000 KB/秒。使用 apache 和 nginx 有时它会在服务器的上游达到 700000 KB/s。我在配置中的 sendfile 和 writev 之间切换，结果相同。

我没有使用任何 php 或 fast-cgi，只是直接下载到文件，例如：[http](http://www.myserver.com/file.zip) ://www.myserver.com/file.zip并下载文件。

我将在此处附上一些信息，以帮助我弄清楚。

内核 2.6

lighttpd.conf

```
# lighttpd configuration file
#
# use it as a base for lighttpd 1.0.0 and above
#
# $Id: lighttpd.conf,v 1.7 2004/11/03 22:26:05 weigon Exp $

############ Options you really have to take care of ####################

## modules to load
# at least mod_access and mod_accesslog should be loaded
# all other module should only be loaded if really neccesary
# - saves some time
# - saves memory
server.modules              = (
#                               "mod_rewrite",
#                               "mod_redirect",
#                               "mod_alias",
                                "mod_access",
#                               "mod_cml",
#                               "mod_trigger_b4_dl",
#                               "mod_auth",
#                               "mod_status",
#                               "mod_setenv",
#                               "mod_proxy_core",
#                               "mod_proxy_backend_http",
#                               "mod_proxy_backend_fastcgi",
#                               "mod_proxy_backend_scgi",
#                               "mod_proxy_backend_ajp13",
#                               "mod_simple_vhost",
#                               "mod_evhost",
#                               "mod_userdir",
#                               "mod_cgi",
#                               "mod_compress",
#                               "mod_ssi",
#                               "mod_usertrack",
#                               "mod_expire",
#                               "mod_secdownload",
#                               "mod_rrdtool",
                                "mod_accesslog" )

## a static document-root, for virtual-hosting take look at the
## server.virtual-* options
server.document-root        = "/usr/share/nginx/html/"

## where to send error-messages to
server.errorlog             = "/www/logs/lighttpd.error.log"

# files to check for if .../ is requested
index-file.names            = ( "index.php", "index.html",
                                "index.htm", "default.htm" )

## set the event-handler (read the performance section in the manual)
# server.event-handler = "freebsd-kqueue" # needed on OS X

server.event-handler = "linux-sysepoll"
#server.network-backend = "linux-sendfile"
server.network-backend = "writev"

# mimetype mapping
mimetype.assign             = (
  ".pdf"          =>      "application/pdf",
  ".sig"          =>      "application/pgp-signature",
  ".spl"          =>      "application/futuresplash",
  ".class"        =>      "application/octet-stream",
  ".ps"           =>      "application/postscript",
  ".torrent"      =>      "application/x-bittorrent",
  ".dvi"          =>      "application/x-dvi",
  ".gz"           =>      "application/x-gzip",
  ".pac"          =>      "application/x-ns-proxy-autoconfig",
  ".swf"          =>      "application/x-shockwave-flash",
  ".tar.gz"       =>      "application/x-tgz",
  ".tgz"          =>      "application/x-tgz",
  ".tar"          =>      "application/x-tar",
  ".zip"          =>      "application/zip",
  ".mp3"          =>      "audio/mpeg",
  ".m3u"          =>      "audio/x-mpegurl",
  ".wma"          =>      "audio/x-ms-wma",
  ".wax"          =>      "audio/x-ms-wax",
  ".ogg"          =>      "application/ogg",
  ".wav"          =>      "audio/x-wav",
  ".gif"          =>      "image/gif",
  ".jpg"          =>      "image/jpeg",
  ".jpeg"         =>      "image/jpeg",
  ".png"          =>      "image/png",
  ".xbm"          =>      "image/x-xbitmap",
  ".xpm"          =>      "image/x-xpixmap",
  ".xwd"          =>      "image/x-xwindowdump",
  ".css"          =>      "text/css",
  ".html"         =>      "text/html",
  ".htm"          =>      "text/html",
  ".js"           =>      "text/javascript",
  ".asc"          =>      "text/plain",
  ".c"            =>      "text/plain",
  ".cpp"          =>      "text/plain",
  ".log"          =>      "text/plain",
  ".conf"         =>      "text/plain",
  ".text"         =>      "text/plain",
  ".txt"          =>      "text/plain",
  ".dtd"          =>      "text/xml",
  ".xml"          =>      "text/xml",
  ".mpeg"         =>      "video/mpeg",
  ".mpg"          =>      "video/mpeg",
  ".mov"          =>      "video/quicktime",
  ".qt"           =>      "video/quicktime",
  ".avi"          =>      "video/x-msvideo",
  ".asf"          =>      "video/x-ms-asf",
  ".asx"          =>      "video/x-ms-asf",
  ".wmv"          =>      "video/x-ms-wmv",
  ".bz2"          =>      "application/x-bzip",
  ".tbz"          =>      "application/x-bzip-compressed-tar",
  ".tar.bz2"      =>      "application/x-bzip-compressed-tar"
 )

# Use the "Content-Type" extended attribute to obtain mime type if possible
#mimetype.use-xattr        = "enable"

## send a different Server: header
## be nice and keep it at lighttpd
# server.tag                 = "lighttpd"

#### accesslog module
accesslog.filename          = "/www/logs/access.log"

## deny access the file-extensions
#
# ~    is for backupfiles from vi, emacs, joe, ...
# .inc is often used for code includes which should in general not be part
#      of the document-root
url.access-deny             = ( "~", ".inc" )

$HTTP["url"] =~ "\.pdf$" {
  server.range-requests = "disable"
}

##
# which extensions should not be handle via static-file transfer
#
# .php, .pl, .fcgi are most often handled by mod_fastcgi or mod_cgi
static-file.exclude-extensions = ( ".php", ".pl", ".fcgi" )

######### Options that are good to be but not neccesary to be changed #######

## bind to port (default: 80)
#server.port                = 81

## bind to localhost (default: all interfaces)
#server.bind                = "grisu.home.kneschke.de"

## error-handler for status 404
#server.error-handler-404   = "/error-handler.html"
#server.error-handler-404   = "/error-handler.php"

## to help the rc.scripts
#server.pid-file            = "/var/run/lighttpd.pid"

###### virtual hosts
##
##  If you want name-based virtual hosting add the next three settings and load
##  mod_simple_vhost
##
## document-root =
##   virtual-server-root + virtual-server-default-host + virtual-server-docroot
## or
##   virtual-server-root + http-host + virtual-server-docroot
##
#simple-vhost.server-root   = "/home/weigon/wwwroot/servers/"
#simple-vhost.default-host  = "grisu.home.kneschke.de"
#simple-vhost.document-root = "/pages/"

##
## Format: <errorfile-prefix><status-code>.html
## -> ..../status-404.html for 'File not found'
#server.errorfile-prefix    = "/home/weigon/projects/lighttpd/doc/status-"

## virtual directory listings
#dir-listing.activate       = "enable"

## enable debugging
#debug.log-request-header     = "enable"
#debug.log-response-header    = "enable"
#debug.log-request-handling   = "enable"
#debug.log-file-not-found     = "enable"
#debug.log-condition-handling = "enable"

### only root can use these options
#
# chroot() to directory (default: no chroot() )
#server.chroot              = "/"

## change uid to <uid> (default: don't care)
#server.username            = "wwwrun"

## change uid to <uid> (default: don't care)
#server.groupname           = "wwwrun"

#### compress module
#compress.cache-dir         = "/tmp/lighttpd/cache/compress/"
#compress.filetype          = ("text/plain", "text/html")

#### proxy module
## read proxy.txt for more info
#$HTTP["url"] =~ "\.php$" {
#   proxy-core.balancer = "round-robin"
#   proxy-core.allow-x-sendfile = "enable"
#   proxy-core.protocol = "http"
#   proxy-core.backends = ( "192.168.0.101:80" )
#   proxy-core.max-pool-size = 16
#}

#### fastcgi module
## read fastcgi.txt for more info
## for PHP don't forget to set cgi.fix_pathinfo = 1 in the php.ini
#$HTTP["url"] =~ "\.php$" {
#   proxy-core.balancer = "round-robin"
#   proxy-core.allow-x-sendfile = "enable"
#   proxy-core.check-local = "enable"
#   proxy-core.protocol = "fastcgi"
#   proxy-core.backends = ( "unix:/tmp/php-fastcgi.sock" )
#   proxy-core.max-pool-size = 16
#}

#### CGI module
#cgi.assign                 = ( ".pl"  => "/usr/bin/perl",
#                               ".cgi" => "/usr/bin/perl" )
#

#### SSL engine
#ssl.engine                 = "enable"
#ssl.pemfile                = "server.pem"

#### status module
#status.status-url          = "/server-status"
#status.config-url          = "/server-config"

#### auth module
## read authentication.txt for more info
#auth.backend               = "plain"
#auth.backend.plain.userfile = "lighttpd.user"
#auth.backend.plain.groupfile = "lighttpd.group"

#auth.backend.ldap.hostname = "localhost"
#auth.backend.ldap.base-dn  = "dc=my-domain,dc=com"
#auth.backend.ldap.filter   = "(uid=$)"

#auth.require               = ( "/server-status" =>
#                               (
#                                 "method"  => "digest",
#                                 "realm"   => "download archiv",
#                                 "require" => "user=jan"
#                               ),
#                               "/server-config" =>
#                               (
#                                 "method"  => "digest",
#                                 "realm"   => "download archiv",
#                                 "require" => "valid-user"
#                               )
#                             )

#### url handling modules (rewrite, redirect, access)
#url.rewrite                = ( "^/$"             => "/server-status" )
#url.redirect               = ( "^/wishlist/(.+)" => "http://www.123.org/$1" )
#### both rewrite/redirect support back reference to regex conditional using %n
#$HTTP["host"] =~ "^www\.(.*)" {
#  url.redirect            = ( "^/(.*)" => "http://%1/$1" )
#}

#
# define a pattern for the host url finding
# %% => % sign
# %0 => domain name + tld
# %1 => tld
# %2 => domain name without tld
# %3 => subdomain 1 name
# %4 => subdomain 2 name
#
#evhost.path-pattern        = "/home/storage/dev/www/%3/htdocs/"

#### expire module
#expire.url                 = ( "/buggy/" => "access 2 hours", "/asdhas/" => "access plus 1 seconds 2 minutes")

#### ssi
#ssi.extension              = ( ".shtml" )

#### rrdtool
#rrdtool.binary             = "/usr/bin/rrdtool"
#rrdtool.db-name            = "/var/www/lighttpd.rrd"

#### setenv
#setenv.add-request-header  = ( "TRAV_ENV" => "mysql://user@host/db" )
#setenv.add-response-header = ( "X-Secret-Message" => "42" )

## for mod_trigger_b4_dl
# trigger-before-download.gdbm-filename = "/home/weigon/testbase/trigger.db"
# trigger-before-download.memcache-hosts = ( "127.0.0.1:11211" )
# trigger-before-download.trigger-url = "^/trigger/"
# trigger-before-download.download-url = "^/download/"
# trigger-before-download.deny-url = "http://127.0.0.1/index.html"
# trigger-before-download.trigger-timeout = 10

## for mod_cml
## don't forget to add index.cml to server.indexfiles
# cml.extension               = ".cml"
# cml.memcache-hosts          = ( "127.0.0.1:11211" )

#### variable usage:
## variable name without "." is auto prefixed by "var." and becomes "var.bar"
#bar = 1
#var.mystring = "foo"

## integer add
#bar += 1
## string concat, with integer cast as string, result: "www.foo1.com"
#server.name = "www." + mystring + var.bar + ".com"
## array merge
#index-file.names = (foo + ".php") + index-file.names
#index-file.names += (foo + ".php")

#### include
#include /etc/lighttpd/lighttpd-inc.conf
## same as above if you run: "lighttpd -f /etc/lighttpd/lighttpd.conf"
#include "lighttpd-inc.conf"

#### include_shell
#include_shell "echo var.a=1"
## the above is same as:
#var.a=1 
```

sysctl.conf

```
# Kernel sysctl configuration file for Red Hat Linux
#
# For binary values, 0 is disabled, 1 is enabled.  See sysctl(8) and
# sysctl.conf(5) for more details.

# Controls IP packet forwarding
net.ipv4.ip_forward = 0

# Controls source route verification
net.ipv4.conf.default.rp_filter = 1

# Do not accept source routing
net.ipv4.conf.default.accept_source_route = 0

# Controls the System Request debugging functionality of the kernel
kernel.sysrq = 0

# Controls whether core dumps will append the PID to the core filename
# Useful for debugging multi-threaded applications
kernel.core_uses_pid = 1

# Controls the use of TCP syncookies
net.ipv4.tcp_syncookies = 1

# Controls the maximum size of a message, in bytes
kernel.msgmnb = 65536

# Controls the default maxmimum size of a mesage queue
kernel.msgmax = 65536

# Controls the maximum shared segment size, in bytes
kernel.shmmax = 68719476736

# Controls the maximum number of shared memory segments, in pages
kernel.shmall = 4294967296

# These ensure that TIME_WAIT ports either get reused or closed fast.
net.ipv4.tcp_fin_timeout = 1
net.ipv4.tcp_tw_recycle = 1

# TCP memory
net.core.rmem_max = 16777216
net.core.rmem_default = 16777216
net.core.netdev_max_backlog = 262144
net.core.somaxconn = 262144

net.ipv4.tcp_syncookies = 1
net.ipv4.tcp_max_orphans = 262144
net.ipv4.tcp_max_syn_backlog = 262144
net.ipv4.tcp_synack_retries = 2
net.ipv4.tcp_syn_retries = 2

# For Large File Hosting Servers
net.core.wmem_max = 1048576
#net.ipv4.tcp_wmem = 4096 87380 524288
net.ipv4.tcp_wmem = 4096 524288 16777216 
```

实际顶部命令

```
top - 16:15:57 up 6 days, 19:30,  2 users,  load average: 1.05, 0.85, 0.83
Tasks: 143 total,   1 running, 142 sleeping,   0 stopped,   0 zombie
Cpu(s):  0.6%us,  2.8%sy,  0.0%ni, 64.7%id, 30.8%wa,  0.0%hi,  1.1%si,  0.0%st
Mem:   3914664k total,  3729404k used,   185260k free,     1676k buffers
Swap:  8388600k total,     9984k used,  8378616k free,  3340832k cached

  PID USER      PR  NI  VIRT  RES  SHR S %CPU %MEM    TIME+  COMMAND
28590 root      20   0  518m  75m  71m D 13.1  2.0   1:12.24 lighttpd
28660 root      20   0 15016 1104  812 R  1.9  0.0   0:00.02 top
    1 root      20   0 19328  620  396 S  0.0  0.0   0:03.74 init
    2 root      20   0     0    0    0 S  0.0  0.0   0:00.02 kthreadd
    3 root      RT   0     0    0    0 S  0.0  0.0   0:00.14 migration/0
    4 root      20   0     0    0    0 S  0.0  0.0   0:00.12 ksoftirqd/0
    5 root      RT   0     0    0    0 S  0.0  0.0   0:00.00 migration/0
    6 root      RT   0     0    0    0 S  0.0  0.0   0:00.00 watchdog/0
    7 root      RT   0     0    0    0 S  0.0  0.0   0:00.32 migration/1
    8 root      RT   0     0    0    0 S  0.0  0.0   0:00.00 migration/1
    9 root      20   0     0    0    0 S  0.0  0.0   0:01.96 ksoftirqd/1
   10 root      RT   0     0    0    0 S  0.0  0.0   0:00.19 watchdog/1
   11 root      RT   0     0    0    0 S  0.0  0.0   0:01.00 migration/2
   12 root      RT   0     0    0    0 S  0.0  0.0   0:00.00 migration/2
   13 root      20   0     0    0    0 S  0.0  0.0   5:04.44 ksoftirqd/2
   14 root      RT   0     0    0    0 S  0.0  0.0   0:00.23 watchdog/2
   15 root      RT   0     0    0    0 S  0.0  0.0   0:00.50 migration/3
   16 root      RT   0     0    0    0 S  0.0  0.0   0:00.00 migration/3
   17 root      20   0     0    0    0 S  0.0  0.0   0:01.84 ksoftirqd/3
   18 root      RT   0     0    0    0 S  0.0  0.0   0:00.00 watchdog/3 
```

iostat

```
Linux 2.6.32-220.7.1.el6.x86_64 (zlin)  05/01/2012      _x86_64_        (4 CPU)

avg-cpu:  %user   %nice %system %iowait  %steal   %idle
           0.57    0.00    3.95   30.76    0.00   64.72

Device:            tps   Blk_read/s   Blk_wrtn/s   Blk_read   Blk_wrtn
sda             109.58     38551.74       149.33 22695425748   87908220 
```

netstat -an |grep :80 |wc -l

```
259 
```

iptraf

```
247270.0 kbits/sec 
```

我应该改变什么来让客户端下载速度更快，他们说有时下载速度低于 10 KB/s

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-16T20:20:53.067

因此，看起来磁盘 I/O 是您查看`top`and的问题`iostat`。您已经用完了所有磁盘缓存，系统正在等待从磁盘读取数据，然后才能将其发送到 NIC。

我会尝试的第一件事是更改为：

```
server.network-backend = "linux-sendfile" 
```

因为这将改善缓冲区的使用（有点，不是应该的那么多）。

您可以对缓存典型工作负载需要多少内存进行粗略计算（简单地说，只需将最常用的 100 个文件的大小相加即可）。我猜它会比你拥有的 4GB 内存要多得多，所以接下来要做的就是获得更快的磁盘驱动器或更多的内存。

这就是人们使用内容交付网络 (CDN) 来交付大量带宽（通常以大文件的形式出现）的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-05T03:09:19.157

这里的问题不在于您的 Web 服务器，而在于 HTTP 并没有真正设计为文件下载协议。它是超文本传输​​协议，许多围绕 HTTP 的决定都集中在超链接文本方面——文件大小预计会很小，低于几十 Kb，当然低于 1 Mb。Web 基础设施在许多数据缓存等方法中利用了这一事实。我建议不要将 HTTP 用于它真正不是为它设计的东西，而是考虑使用不同的传输机制。

**FTP**：文件传输协议。FTP 专为传输任意大小的文件而设计，与 HTTP 软件的假设不同。如果您所做的只是静态下载，您的网页 HTML 可以使用 ftp:// 链接链接到静态文件，并且配置 FTP 服务器以允许匿名下载通常很简单。查看您的 FTP 服务器的文档以获取详细信息。自 IE6/FF2 以来的浏览器本身就支持基本的 FTP——普通用户的工作流程与平常没有什么不同。*这可能不是最好的方法*，因为 FTP 早在 HTTP 之前就设计好了，而且正如 Perry 提到的，早在我们有半个 gig 文件之前。

**CDN**：使用像 Amazon 的 S3 这样的内容交付网络在技术上并不能绕过 HTTP，但它让您不必担心您的用户会像您看到的那样使您的服务器过载。

**BitTorrent**：如果您的用户更精通技术，请考虑将您的服务器设置为无限期地播种静态文件，然后在您的网站上发布磁力链接。在最坏的情况下，单个用户将体验从您的服务器直接下载，使用实际上知道如何处理大文件的协议。在最好的情况下，您的数百名用户将互相吸食和播种，从而大大减少您的服务器负载。是的，这要求您的用户知道如何运行和配置 bittorrent，这可能并非如此，但它仍然是一个有趣的文件下载范例。

# ruby-on-rails - 设计管理员注销错误

> ID：10404469
> 
> 赞同：3
> 
> 时间：2012-05-01T21:15:01.733
> 
> 标签：ruby-on-rails, devise

我的设计有问题。每当我尝试使用 devise 以管理员身份注销时，都会出现以下错误

```
No route matches [GET] "/admins/sign_out" 
```

做 rake 路线，我看到它有

```
destroy_admin_session DELETE /admins/sign_out(.:format) devise/sessions#destroy 
```

在我看来，我称之为...

```
<%= link_to  "sign out as admin", destroy_admin_session_path %> 
```

我应该覆盖管理员控制器进行设计吗？我可以去... /admins/sign_in 对我来说似乎很奇怪。但是，去 /admins/sign_out 不起作用。

我使用管理员模型格式创建了管理员。

[https://github.com/plataformatec/devise/wiki/How-To:-Add-an-Admin-role](https://github.com/plataformatec/devise/wiki/How-To:-Add-an-Admin-role)

作为设计中的管理员，还有其他人遇到过这个问题吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T01:48:58.960

看起来退出 URL 需要`DELETE`HTTP 方法。

```
<%= link_to  "sign out as admin", destroy_admin_session_path, method: :delete %> 
```

会工作。

# spring - SpringMVC 中的可重用组件

> ID：10404470
> 
> 赞同：0
> 
> 时间：2012-05-01T21:15:01.907
> 
> 标签：spring, spring-mvc, reusability

我是从 PHP 世界来到 SpringMVC 的，正是我在 Symfony 工作了几年。

供您参考，在 Symfony 中，有其他开发人员创建的插件和包，以便您可以在项目中使用它们。当我来到 Spring 时，我没有找到这些概念，或者我可能错过了什么！？。

例如，我正在寻找一个完成注册和登录表单的组件，我认为这已经完成了很多次，而且我当然不想重新发明轮子。

所以，我的问题是，我想知道在 Spring 中是否有可能拥有以及如何使用可重用组件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T21:30:45.440

Java EE 规范直接支持身份验证。您甚至不需要任何特定的框架。每个 Web 容器都支持开箱即用。如果你想要一些额外的功能（比如记住我等），请在[spring-security](http://static.springsource.org/spring-security/site/)中掠夺。

# php - 将变量动态更新到现有文件中？

> ID：10404471
> 
> 赞同：1
> 
> 时间：2012-05-01T21:15:07.093
> 
> 标签：php, codeigniter

我正在尝试使用 CodeIgniter 构建一个小型 CMS，并且我需要能够动态更新 application/config.php 中的一些变量

到目前为止，我做了：

```
private function update_file ($file, $var, $var_name) {
    $start_tag = "<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed');\n";
    if (file_exists($file)) {
        require_once ($file);
        $updated_array = array_merge($$var_name, $var);         
        $data = $start_tag."\$".$var_name." = ".var_export($updated_array, true).";";
        file_put_contents($file, $data);
    } else {
        return false;
    }
} 
```

一切正常！config.php 文件中的结果将是：

```
<?php ...;
$config = array (
'base_url' => '',
...
...
); 
```

但是，如果我想使用注释、空格和
分隔声明的 $config['key'] = 'value' ... 来维护原始 config.php 文件格式怎么办？

那可能吗 ？

* * *

编辑：

谢谢你的回答，非常珍贵。我找到了一个稍微不同的解决方案来满足我的需求，在 file_get_contents() 返回时执行 preg_replace，然后在文件上写回新的结果字符串。文件保持准确的原始干净格式。

```
private function update_file ($file, $var, $var_name) {
    if (file_exists($file)) {
        require_once ($file);

        $contents = file_get_contents($file);
        $updated_array = array_merge($$var_name, $var);
        $search = array();
        $replace = array();

        foreach($$var_name as $key => $val) {
            $pattern = '/\$'.$var_name.'\[\\\''.$key.'\\\'\]\s+=\s+[^\;]+/';
            $replace_string = "\$".$var_name."['".$key."'] = ".var_export($updated_array[$key], true);      
            array_push($search, $pattern);
            array_push($replace, $replace_string);
        }

        $new_contents = preg_replace($search, $replace, $contents);
        write_file($file, $new_contents);
} 
```

也许它需要一些轻微的性能改进。但这是我的基本想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T21:53:55.743

创建具有空值的键

```
$config['base_url'] = ''; 
```

然后将它们设置在您的任何控制器中。如果您将值存储在 db 中，并在 MY_Controller 中对其进行初始化，则此方法效果最佳。

```
$this->config->set_item('base_url', 'value'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T21:31:59.417

有可能的。我找不到代码，但是一旦我写了类似的东西。整个想法是基于标记模板文件和替换数组中的值，保留模板中的键顺序、行号和注释。

[+] 找到了。它的目的是从看起来像这样的模板中填充值（当然它要大得多）：

```
<?php

$_CFG = array(

    // DB section
    'db_host' => 'localhost',
    'db_user' => 'root',
    'db_pass' => '',
    'db_name' => 'test',

    // Site specific
    'lang' => array('pl','en'),
    'admin' => 'admin@example.com',
); 
```

以及发挥所有魔力的代码：

```
$tokens = token_get_all(file_get_contents('tpl/config.php'));

$level = -1;
$buffer = '';
$last_key = 0;
$iteration = 0;

foreach($tokens as $t){
    if($t === ')'){
        $iteration = 0;
        $last_key = 0;
        $level--;
    }

    if(is_array($t)){
        if($t[0] == T_ARRAY && strtolower($t[1]) === 'array')
            $level++;

        if($t[0] == T_CONSTANT_ENCAPSED_STRING){
            if($last_key){
                if($level){
                    if(isset($new_config[$last_key][$iteration])){
                        $buffer .= var_export($new_config[$last_key][$iteration], TRUE);
                    }
                    else
                        $buffer .= 'null';

                    $iteration++;
                }
                else{
                    if(isset($new_config[$last_key]))
                        $buffer .= var_export($new_config[$last_key], TRUE);
                    else
                        $buffer .= 'null';

                    $last_key = 0;
                }
            }
            else{
                $buffer .= $t[1];
                $last_key = trim($t[1],"'");
            }
        }
        else
            $buffer .= $t[1];
    }
    else
        $buffer .= $t;
}

file_put_contents('config.php',$buffer); 
```

# extjs - ExtJs 找不到映射字符串集合的属性

> ID：10404472
> 
> 赞同：0
> 
> 时间：2012-05-01T21:15:08.133
> 
> 标签：extjs, combobox, mapping, jsonreader

我返回序列化的组合框的字符串列表，如下所示：

```
data:{"option1", "option2", "option3"...} 
```

JsonReader 有一个字段列表，假设我们要映射到一个 OPT 字段：

```
reader: new Ext.data.JsonReader({...
   fields: [ {name: 'OPT', mapping: '???'} ]
}) 
```

我知道映射应该指向属性名称......但字符串没有值/内容属性。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T21:23:36.900

您提供的不是有效的 JSON。

它要么需要（使用数组阅读器）

```
data: ["option 1", "option 2", "option 3"] 
```

或（映射将是“名称”）

```
"data": [{
    "name": "option 1"
}, {
    "name": "option 2"
}] 
```

# android - 无法从 Windows 访问我的 android sqlite DB

> ID：10404478
> 
> 赞同：0
> 
> 时间：2012-05-01T21:15:55.737
> 
> 标签：android, windows, sqlite

我一直在为 android 平台开发的应用程序中使用 SQLite 数据库。我想从我的 PC 中探索数据并查看表格和实体。当我从 Eclipse 上的 DDMS 文件资源管理器尝试时，我认为我没有适当的安全性来访问它。我无法打开数据文件夹，当我将其复制到桌面时，它是空的。有谁知道如何将我的移动 android SQLite 数据库转储到我的 PC 上？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T21:25:38.040

您可以使用 cellObject sqlite 浏览器直接从 DDMS 浏览下面是 eclipse 插件的链接：[http ://www.cellobject.net/Tools/CellObjectSQLiteXMLBrowser.aspx](http://www.cellobject.net/Tools/CellObjectSQLiteXMLBrowser.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T21:48:17.023

无需root您的手机，您可以通过在模拟器上运行应用程序来获取数据库的副本，然后使用DDMS从那里拉取它。就像你把它从手机上取下来一样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-08T14:00:31.187

您可以获取数据库文件您的应用程序。即使您的设备没有植根。

您必须添加调试操作：从 \databases\database.db 复制到 sdcard。[通过getDatabasePath](http://developer.android.com/reference/android/content/Context.html#getDatabasePath%28java.lang.String%29)获取数据库路径。从 sdcard 您可以通过 adb pull 或文件资源管理器获取文件。

您也可以处理返回操作：从 sdcard 复制到应用程序。当然，您在设备上的应用程序不会启动。Иut 我没有任何问题，即使应用程序正在运行，但无法访问基础。

# ios - 删除 keyValue 观察者时崩溃（使用 Apple SquareCam 示例代码）

> ID：10404479
> 
> 赞同：1
> 
> 时间：2012-05-01T21:16:01.607
> 
> 标签：ios, ios5, key-value-observing

我正在使用 Apple 的 SquareCam 演示中的 viewController 类。除了创建一个 UIView 之外，我没有更改代码，该示例在示例中是通过情节提要/IB 设置的。还要在构建设置中指定从 ARC 中排除。

该代码使用 KVO 做一些动画，我在`removeObserver`下面的行中遇到了崩溃。

我可以轻松解决这个问题而不使用 KVO，但我想了解这个问题 - 并且更好地了解 KVO。有时代码示例中的 KVO 很难遵循。例如：在下面的代码片段中，`keyPaths`调用`addObserver/removeObserver`的 是不同的（在 Apple 的代码中）。他们不应该是一样的吗？

无论如何...如果有人有 X 光视力

```
- (void)teardownAVCapture
{
[videoDataOutput release];
if (videoDataOutputQueue)
    dispatch_release(videoDataOutputQueue);

    // CRASH HERE
[stillImageOutput removeObserver:self forKeyPath:@"isCapturingStillImage"];

[stillImageOutput release];
[previewLayer removeFromSuperlayer];
[previewLayer release];
} 
```

// 这里设置了观察者：

```
 stillImageOutput = [AVCaptureStillImageOutput new];
[stillImageOutput addObserver:self forKeyPath:@"capturingStillImage" options:NSKeyValueObservingOptionNew context:AVCaptureStillImageIsCapturingStillImageContext]; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-30T09:00:56.737

我在尝试重新拍照时也遇到了这个问题，我的临时解决方案是 rem that code

```
[stillImageOutput removeObserver:self forKeyPath:@"isCapturingStillImage"]; 
```

并尝试打电话

```
[session stopRunning] 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-06-04T12:00:42.003

我将其视为 SquareCam 中的一个错字并使用：

```
[stillImageOutput removeObserver:self forKeyPath:@"capturingStillImage"]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T22:50:12.373

如果我没记错的话

`isCapturingStillImage`和`capturingStillImage`值应该匹配。

如果应用程序找不到匹配的观察者，那么它就会崩溃..

希望这可以帮助..

# javascript - jquery表单验证需要一组输入中的一个并且要求输入是一个整数

> ID：10404481
> 
> 赞同：3
> 
> 时间：2012-05-01T21:16:07.313
> 
> 标签：javascript, jquery, validation, input

我正在制作一个需要填写至少一个字段并且所有输入必须是整数或小数的表格。我正在使用 jquery 的验证插件进行验证。我已经修改了我在[这里](https://stackoverflow.com/questions/6061515/jquery-validation-require-at-least-one-input-of-the-same-name)找到的东西，这似乎部分起到了作用。现在我有：

```
<SCRIPT>   
jQuery.validator.addMethod("require_from_group", function(value, element, options) {
    var numberRequired = options[0];
    var selector = options[1];
    var validOrNot = $(selector, element.form).filter(function() {
         // Each field is kept if it has a value
         return $(this).val();
         // Set to true if there are enough, else to false
      }).length >= numberRequired;
    if(!$(element).data('being_validated')) {
         var fields = $(selector, element.form);
         fields.data('being_validated', true);
         fields.valid();
         fields.data('being_validated', false);
    }
    return validOrNot;
    // {0} below is the 0th item in the options field
    }, jQuery.format("Please fill out at least {0} of these fields."));

$(document).ready(function(){
    var container = $('#errorContainer');
    $("#FORMMM").validate(  {
        rules: {
            groceries: {digits: true,require_from_group: [1,".at_least_one"]},
            gas: {digits: true,require_from_group: [1,".at_least_one"]},
            hotels: {digits: true,require_from_group: [1,".at_least_one"]}

        },
        success: function(label) {  
                label.html(" ").addClass("checked"); 
        },
        errorContainer: container,
            errorLabelContainer: $("ol", container),
            wrapper: 'li',
            meta: "validate"
    });
});
</SCRIPT> 
```

HTML 在下面，在我的实际表单中，有 15 个输入字段，我只是在这里压缩它：

```
<form action="results.php" target="_blank" id="FORMMM">

    <div style="clear:both">
    <label for="groceries">Groceries</label>
    <div style="float:right">
            $<input name="groceries" type="text" class="at_least_one idleField"></div>
    </div>
    <div style="clear:both">
        <label for="gas">Gas</label>
        <div style="float:right">
            $<input name="gas" type="text" class="at_least_one idleField">
        </div>
    </div>
    <div style="clear:both">
        <label for="hotels">Hotels</label>
        <div style="float:right">
            $<input name="hotels" type="text" class="at_least_one idleField">
        </div>
    </div>
    <div id="button">
        <input name="" type="submit" value="Calculate" class="calc_button" style="cursor:hand">
    </div>
    </form>
<div id="errorContainer">
    <h4>errors</h4>
    <ol>
    </ol>
</div> 
```

现在验证有两个问题。如果所有字段都留空，当我只需要一个时，我会收到 3 条错误消息！

另外，如果我在其中一个输入中输入一个字母，我会得到一秒钟的“仅限数字”错误消息，但无论如何表单仍然提交，因为至少有 1 个字段被填写的第二次测试弥补了没有位数。

我这样做是完全错误的吗？我在这里或 jquery 论坛上找不到的示例似乎都不完全适合。我应该去什么方向来解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-04T18:38:38.767

看来我找到了解决方案。请参阅代码中的注释。[现场演示](http://jsfiddle.net/riateche/VTQ74/1/)。

```
jQuery.validator.addMethod(
    "require_from_group", function(value, element, options) {
  var numberRequired = options[0];
  var selector = options[1];
  var fields = $(selector, element.form);
  var filled_fields = fields.filter(function() {
    // it's more clear to compare with empty string
    return $(this).val() != ""; 
  });
  var empty_fields = fields.not(filled_fields);
  // we will mark only first empty field as invalid
  if (filled_fields.length < numberRequired && empty_fields[0] == element) {
    return false;
  }
  return true;
// {0} below is the 0th item in the options field
}, jQuery.format("Please fill out at least {0} of these fields."));

$(document).ready(function(){
  var container = $('#errorContainer');
  $("#FORMMM").validate(  {

    // We must to force validation of entire form because
    // when we remove value from 2-nd field 
    // the 1-st field becomes invalid.
    onfocusout: function() { $("#FORMMM").valid() },
    onkeyup: function() { $("#FORMMM").valid() },

    rules: {
      // note: you can use variable to avoid repeating 
      // of the same code
      groceries: { 
        number: true,
        require_from_group: [1, ".at_least_one"]
      },
      gas: {
        number: true,
        require_from_group: [1,".at_least_one"]
      },
      hotels: {
        number: true,
        require_from_group: [1,".at_least_one"]
      }
    },
    success: function(label) {  
      label.html(" ").addClass("checked"); 
    },
    errorContainer: container,
    errorLabelContainer: $("ol", container),
    wrapper: 'li',
    meta: "validate"
  });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-04T19:00:39.117

你有两个问题：

1.  未通过数字检查不会阻止表单提交 - 您会看到消息，但随后会提交。
2.  如果三个字段都不存在，您将收到三次错误消息。

你可以在这里看到开始状态：http: [//jsfiddle.net/jclark/NR29t/1/](http://jsfiddle.net/jclark/NR29t/1/)；我唯一改变的是表单现在在提交而不是提交表单时会触发警报。

一次拿这些，我将从＃1开始。我注意到如果非数字条目在表单的最后一个字段上，数字检查**将**阻止表单提交。否则，它将继续。原来问题出在你的`require_from_group`方法上。正如它所写，重新验证整个表单：

```
if(!$(element).data('being_validated')) {
     var fields = $(selector, element.form);
     fields.data('being_validated', true);
     fields.valid();
     fields.data('being_validated', false);
} 
```

阅读您链接的帖子以及那里链接的帖子，这似乎会导致错误消息在第一个必需的输入失去焦点时立即出现，而不是仅在提交时出现。对您的使用有要求吗？因为这似乎是第一个问题的原因。“being_validated”逻辑阻止了无限链（其中元素一重新验证元素二，它重新验证元素一，无限期），但是，这仍然意味着当每个字段被检查时，它将重新验证组表单中的所有字段。看起来这种重新验证导致了问题。我认为正在发生的事情是，如果第一个字段不是数字，则会记录该错误，但是当验证最后一个字段时，它会重新验证整个表单，但是 skip-inifite-loop 检查会导致其他字段被跳过；

我有 98% 的把握我做对了。但是，我确实知道删除该块可以解决问题。看到这个版本：

[http://jsfiddle.net/jclark/NR29t/2/](http://jsfiddle.net/jclark/NR29t/2/)

现在来说第二个问题。在字段上显示所有错误的行为是设计使然，并且通常是有意义的——只是不是一组字段像这样相互关联。幸运的是，Validator 提供了一个`groups`选项，表示一组应该只报告发现的第一个错误的字段。看到这个版本：

[http://jsfiddle.net/jclark/NR29t/3/](http://jsfiddle.net/jclark/NR29t/3/)

提交时未填写任何字段，您只会看到一条消息。但是，有一个新问题：“请仅输入数字”消息仅在您留下无效输入或该字段获得焦点后立即显示。我认为这是一个验证器错误；看到这个堆栈溢出问题： [jquery validate-groups and their labels](https://stackoverflow.com/questions/6357694/jquery-validate-groups-and-their-labels)。具体来说，如果输入 3 被填充但不是数字，那么输入 1 和 2 是有效的（不包含非数字，并且填充了其他一些字段），所以我认为这是清除组的错误。

不幸的是，我目前不解决这个问题。上面链接的 SO 问题提出了一个有点脆弱的解决方法，即编写一个专门用于一次检查所有字段的验证方法，因此它们都失败了并且消息仍然存在。这是一个演示：

[http://jsfiddle.net/jclark/NR29t/4/](http://jsfiddle.net/jclark/NR29t/4/)

这是自定义验证器：

```
jQuery.validator.addMethod("digits_for_group", function(value, element, selector) {
    var validOrNot = $(selector, element.form).filter(function() {
         // Each field is kept if it has a value
         return $(this).val().search(/[^0-9]/) != -1;
         // Set to true if there are enough, else to false
      }).length == $(selector, element.form).length;
    return validOrNot;

}, jQuery.format("Please enter only digits")); 
```

它有效，但我不喜欢它；它需要重新实现数字检查；如果你有其他验证检查，你需要做同样的事情。

希望这可以帮助。

# python - 使用 setuptools 在 RPM 中包含非 python 文件

> ID：10404485
> 
> 赞同：4
> 
> 时间：2012-05-01T21:16:22.227
> 
> 标签：python, rpm, setuptools

我有一些包含 xml 文件的夹具目录，我希望在使用`bdist_rpm`. 我认为我可以通过让 MANIFEST.in 执行此操作`recursive-include * *`，但是，它不包含除 *.py 文件之外的任何内容。无论如何让 bdist_rpm 在包中包含非 python 文件或特别包含 *.xml 文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T01:33:44.900

你想在哪里安装它们？如果你把它们放在一个包目录中，像这样......

```
myproject/
  mypackage/
    __init__.py
    resources/
      file1.xml
      file2.xml 
```

...您可以`package_data`在文件中使用该选项`setup.py`，如下所示：

```
from setuptools import setup, find_packages

setup(
        name='myproject',
        version='0.1',
        description='A description.',
        packages=find_packages(),
        include_package_data=True,
        package_data = { '': [ '*.xml' ] },
        install_requires=[],
        ) 
```

这将递归地包含任何`*.xml`包内的任何文件。它们将与您的其他软件包一起安装在 Python 库路径内的某个位置。您可以使用如下所示的 a 执行相同的操作`MANIFEST.in`：

```
recursive-include * *.xml 
```

如果您尝试将它们安装到 Python 库之外的特定文件系统位置，我不确定您是否可以通过`setup.py`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-09T16:22:35.517

您可以使用`data_files`设置参数来做您需要的事情。像这样的东西：

```
setup(
    ...
    package_data = { '/usr/share/yourapp/xmls': [ 'xmls/1.xml', 'xmls/2.xml' ] },
    ...
) 
```

这将安装以下文件：

```
/usr/share/yourapp/xmls/1.xml
/usr/share/yourapp/xmls/2.xml 
```

我通常在这样的函数中创建文件列表：

```
def get_xmls():
    xmlfiles = []
    for filename in os.listdir('xmls/'):
        if filename.endswith('.xml'):
            xmlfiles.append('xmls/%s' % filename)
    return xmlfiles 
```

# image - 网站图像文件是否应该包含在 GIT 存储库中？

> ID：10404491
> 
> 赞同：6
> 
> 时间：2012-05-01T21:17:06.823
> 
> 标签：image, git, gitignore

我有一个网站文件/文件夹结构模板可以开始使用`git`. `.gitignore`它在文件夹中包含一个空文件`images`，这使我想到了我的两部分问题：

**1.) 这个空`.gitignore`文件会忽略文件夹*内*的所有图像`images`，还是放置在那里以允许在将任何图像放入存储库*之前将空文件夹添加到存储库？***

**2.) 网站图像是否应该包含在`git`存储库中？**对我来说，图像文件的编辑和更改与其他文件一样，并且随着时间的推移跟踪所述更改将是有益的。

什么被认为是最佳实践？你做什么，为什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-01T21:58:50.703

1.  在您的情况下， .gitignore 允许 git “查看”目录。它可以是任何其他文件。Git 不存储空文件夹。您必须将此行放入 .gitignore 以告知忽略所有其他文件：`!.gitignore`
2.  没有绝对的回应，但我建议您将图像与其他文件一起保存在存储库中。将您的 git 存储库视为您的版本化网站，包括图像。如果您想自动化部署，它会让您轻松。它也会使您的网站历史记录保持一致。GIT 像处理任何其他文件一样处理图像。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T22:11:43.267

查看[“使用二进制文件设置”](https://stackoverflow.com/q/5956675/1286639)，特别是“git media”和“git附件”。但是，将 GIT 直接与图像文件一起使用是完全可以的——如果你尝试“git rebase”，比较两个大图像时可能会崩溃。

# asp.net - 你能用 Javascript 禁用表单提交吗

> ID：10404500
> 
> 赞同：0
> 
> 时间：2012-05-01T21:18:28.877
> 
> 标签：asp.net, forms, form-submit, javascript

如果用户在其客户端浏览器中禁用了 Javascript，并且他们尝试在网页上使用表单，则会导致回发。我的理解是表单会创建一个 Javascript 函数`__doPostBack`来处理表单提交，但是禁用 Javascript 会发生正常的回发。检查回传到服务器的内容时​​，表单为空。表单可以在禁用 Javascript 的情况下工作吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T22:01:23.460

一个表单绝对可以在没有 Javascript 的情况下工作。

只需将您的表单消费代码放在[按钮单击事件](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.button.click.aspx)中即可。

像这样的东西

```
void btnSubmit_Click(Object sender,
                       EventArgs e)
{
    // When the button is clicked,
    // send the values of the input fields to the database.

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T22:20:07.073

该表单将在没有 javascript 的情况下提交。

任何客户端验证都不会运行，因此您可能有无效数据。这就是为什么您总是、总是对表单执行服务器端验证的原因。

现在，您声明您的表单为空。如果您依赖 javascript、jquery 或其他一些客户端编程来设置字段中的值，那么您可能会看到空值。我不确定您在哪里检查，但是如果您查看 page_load 中的请求对象，您应该会在那里看到您的数据。

# fortran - Fortran 读取多行记录

> ID：10404501
> 
> 赞同：0
> 
> 时间：2012-05-01T21:18:29.603
> 
> 标签：fortran, gfortran, intel-fortran

我有一个旧的 Fortran 程序，用于从文本文件中读取记录。记录格式如下：

```
record_type field1 field2 ... fieldN ; 
```

这些记录可能分布在几行，字符 ; 表示记录已经结束。旧代码是：

```
2 read(data,"(a130)",end=3)line
  shift=adrec(nbrec)-1
  read(line,*,end=1)typrec(nbrec),(field(shift+i),i=1,65)
1 do
    do j=shift+1,shift+i-1
      k=index(field(j),';')
      if(k .ne. 0)then
        if(k .eq. 1)then
          adrec(nbrec+1)=j
        else
          field(j)(k:)=''
          adrec(nbrec+1)=j+1
        endif
          go to 2
      endif
    endo
    read(data,"(a130)")line
    read(line,*,end=1)(field(shift+i),i=1,65)
  enddo
3 continue 
```

此代码可与英特尔编译器 (ifort) 一起使用。使用 gfortran 它失败了！第一个问题是第三行的隐式读取，使用 ifort，使 i 等于实际读取的字段数，而在 gfortran 中它总是给出 65。第二个问题是在相同的隐式读取中，使用 ifort ， 性格 ; 被读取为普通字段，但 gfortran 被跳过。

谁能帮我解决这两个问题？也欢迎任何其他将代码全部替换的想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T05:01:11.357

这行得通吗？除了`do while`（和`exit`控制结构......）之外，这是符合 f77 的（我认为）。如果需要，do while 可以相对容易地被 goto/continue 替换。我不知道你最终希望字符串是什么类型，所以我返回字符串（并假设一个字段不能超过 24 个字符）......我还假设一个“行”不能超过 1024人物。很抱歉缺少评论，但我认为函数名称的描述性已经足够了。一般来说，我认为在编程时使用函数/子例程是个好主意，因为这会使代码更具可读性......

```
 program main
  character*1024 line
  integer stat,stat2,i,nf
  character*24 fld
  character*16 fmt

  open(unit=21,file='test.dat',status='old')
  stat=0
  do while(stat.eq.0)
     call readline(21,line,stat)
     stat2=0
     i=1
     do while(.true.)
        call getfield(line,fld,stat2)
        if(stat2.ne.0) exit
        i=i+1
        write(*,*) i,stat2,fld
     enddo
     write(*,*) " "
  enddo

  end

  subroutine getfield(line,field,stat)
  integer l,i,stat
  character*(*) line,field
  !Get first field and shift the line
  l=1
  if(line.eq.' ')then
     stat=1
  else
     stat=0
  endif
  do while (line(l:l).eq.' ')
     l=l+1
  enddo
  i=l
  do while (line(i:i).ne.' ')
     i=i+1
  enddo

  if((line(l:l).eq.'"').or.(line(l:l).eq."'"))then
     do while(line(i:i).ne.line(l:l))
        i=i+1
     enddo
  endif

  field=line(l:i)
  line=line(i+1:)
  return
  end

  subroutine readline(unit,line,stat)
  integer unit
  character*(*) line
  integer stat,i
  !read one "line"  Lines are sequences seperated by ';' (can have newlines in there) 

  stat=0
  i=1
  do while (.true.)
     read(unit,'(A)',end=100) line(i:)
     i=index(line,';')
     if(i.eq.0)then
        i=len_trim(line)+2
     else
        line(i:)=' ' !remove the trailing semicolon.
        exit
     endif
  enddo

  return
 100  continue
  stat=1
  return
  end 
```

# facebook - 从 FB 自己的 CDN 加载 FB logo

> ID：10404502
> 
> 赞同：6
> 
> 时间：2012-05-01T21:18:34.653
> 
> 标签：facebook, image, cdn, css-sprites

是否有一个我们可以为 FB 徽标提供 src 的 url，它与 FB.init 完成后生成的 src 相同？

我怀疑我是否可以对下面的 FB CDN 链接进行硬编码，并期望它适用于所有用户并保持最新状态。

[https://s-static.ak.fbcdn.net/rsrc.php/v1/yL/r/FGFbc80dUKj.png](https://s-static.ak.fbcdn.net/rsrc.php/v1/yL/r/FGFbc80dUKj.png)

我基本上想减少对已经加载了我网站上的任何其他社交插件的 FB 徽标精灵的另一个图像请求。

[![FB精灵](../Images/2525b4de625c9bd8f7d40211853284af.png)](https://i.stack.imgur.com/i9grO.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-06-09T10:25:30.600

尝试使用 font-awesome 的图标。 [fa-facebook-official：字体真棒图标](http://fontawesome.io/icon/facebook-official/)

并在 css (#3B5999) 中应用 facebook 徽标的官方颜色。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-10-05T16:16:48.840

鉴于 URL 仍然（5 个月后）正确解析为图像，我会说您可能可以使用您拥有的链接。

但是，作为后备方案，您可能需要考虑使用 ajax 调用点击链接，并将您对该 URL 的使用更改为本地缓存副本，以防万一链接失效。它的工作量*稍大*一些，但它是一种使用第 3 方图像的功能性方式，如果他们的图像消失了，它仍然会退回到您自己的版本。

# r - 记忆和矢量化自定义函数

> ID：10404505
> 
> 赞同：4
> 
> 时间：2012-05-01T21:18:43.580
> 
> 标签：r, vectorization, memoization

我想知道如何在 R 中对自定义函数进行矢量化和记忆。看来我的思维方式与 R 的操作方式不一致。所以，我很高兴欢迎任何指向优秀阅读材料的链接。例如，R inferno 是一个很好的资源，但它并没有帮助弄清楚 R 中的记忆。

更一般地说，您能否提供`memoise` or`R.cache`包的相关使用示例？

我还没有找到关于这个主题的任何其他讨论。在 r-bloggers.com 上搜索“memoise”或“memoize”返回零结果。[在http://r-project.markmail.org/](http://r-project.markmail.org/)搜索这些关键字不会返回有用的讨论。我通过电子邮件发送了邮件列表，但没有收到完整的答复。

我不仅对记忆 GC 功能感兴趣，而且我知道 Bioconductor 和那里可用的各种软件包。

这是我的数据：

```
seqs <- c("","G","C","CCC","T","","TTCCT","","C","CTC") 
```

缺少一些序列，因此它们是空白的`""`。

我有一个计算 GC 内容的函数：

```
> GC <- function(s) {
    if (!is.character(s)) return(NA)
    n <- nchar(s)
    if (n == 0) return(NA)
    m <- gregexpr('[GCSgcs]', s)[[1]]
    if (m[1] < 1) return(0)
    return(100.0 * length(m) / n)
} 
```

有用：

```
> GC('')
[1] NA
> GC('G')
[1] 100
> GC('GAG')
[1] 66.66667
> sapply(seqs, GC)
                  G         C       CCC         T               TTCCT           
       NA 100.00000 100.00000 100.00000   0.00000        NA  40.00000        NA 
        C       CTC 
100.00000  66.66667 
```

我想记住它。然后，我想对其进行矢量化。

显然，我必须对使用`memoise`or `R.cache`R 包有错误的心态：

```
> system.time(dummy <- sapply(rep(seqs,100), GC))
   user  system elapsed
  0.044   0.000   0.054
>
> library(memoise)
> GCm1 <- memoise(GC)
> system.time(dummy <- sapply(rep(seqs,100), GCm1))
   user  system elapsed
  0.164   0.000   0.173
>
> library(R.cache)
> GCm2 <- addMemoization(GC)
> system.time(dummy <- sapply(rep(seqs,100), GCm2))
   user  system elapsed
 10.601   0.252  10.926 
```

请注意，记忆函数要慢几个数量级。

我尝试了这个`hash`包，但事情似乎在幕后发生，我不明白输出。该序列`C`的值应为`100`，而不是`NULL`。

请注意，使用`has.key(s, cache)`而不是`exists(s, cache)`导致相同的输出。此外，使用`cache[s] <<- result`而不是 `cache[[s]] <<- result`导致相同的输出。

```
> cache <- hash()
> GCc <- function(s) {
    if (!is.character(s) || nchar(s) == 0) {
        return(NA)
    }
    if(exists(s, cache)) {
        return(cache[[s]])
    }
    result <- GC(s)
    cache[[s]] <<- result
    return(result)
}
> sapply(seqs,GCc)
[[1]]
[1] NA

$G
[1] 100

$C
NULL

$CCC
[1] 100

$T
NULL

[[6]]
[1] NA

$TTCCT
[1] 40

[[8]]
[1] NA

$C
NULL

$CTC
[1] 66.66667 
```

至少我想出了如何矢量化：

```
> GCv <- Vectorize(GC)
> GCv(seqs)
                  G         C       CCC         T               TTCCT           
       NA 100.00000 100.00000 100.00000   0.00000        NA  40.00000        NA 
        C       CTC 
100.00000  66.66667 
```

**相关的stackoverflow帖子：**

*   [R中的缓存/记忆/散列选项](https://stackoverflow.com/questions/7262485/options-for-caching-memoization-hashing-in-r)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T22:55:51.563

虽然这不会让您在通话中记忆，但如果有相当多的重复，您可以使用因素来更快地进行单个通话。例如使用 Joshua 的 GC2 （虽然我必须删除 fixed=T 才能让它工作）：

```
GC2 <- function(s) {
  if(!is.character(s)) stop("'s' must be character")
  n <- nchar(s)
  m <- gregexpr('[GCSgcs]', s)
  len <- sapply(m, length)
  neg <- sapply(m, "[[", 1)
  len <- len*(neg > 0)
  100.0 * len/n
} 
```

可以轻松定义一个包装器，例如：

```
GC3 <- function(s) {
  x <- factor(s)
  GC2(levels(x))[x]
}

system.time(GC2(rep(seqs, 50000)))
# user  system elapsed 
# 8.97    0.00    8.99 
system.time(GC3(rep(seqs, 50000)))
# user  system elapsed 
# 0.06    0.00    0.06 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T22:12:21.503

这并没有明确回答您的问题，但此功能比您的快约 4 倍。

```
GC2 <- function(s) {
  if(!is.character(s)) stop("'s' must be character")
  n <- nchar(s)
  m <- gregexpr('[GCSgcs]', s)
  len <- sapply(m, length)
  neg <- sapply(m, "[[", 1)
  len <- len*(neg > 0)
  len/n
} 
```

# php - phpDocumentor - 无法打开输入文件：phpdoc.php

> ID：10404506
> 
> 赞同：18
> 
> 时间：2012-05-01T21:18:43.997
> 
> 标签：php, phpdoc, sublimetext2

我正在尝试使用 phpDocumentor（第一次，我不知道自己在做什么）。实际上，我只想将它与 SublimeText 2 和[这个](https://github.com/benmatselby/sublime-phpdocumentor)插件一起使用。您能逐步指导我该怎么做才能使其正常工作吗？这是我现在所做的：（我使用的是 Windows 7）从[这里](https://github.com/phpDocumentor/phpDocumentor2)下载 phpDocumentor并将其放置在某处。我已经创建了系统路径`phpdoc/bin`（因此 phpdoc.bat 可以由 sublime 插件执行），然后还添加了系统路径`php`（来自 WAMPserver 安装）

当我尝试使用我的插件（或`phpdoc`在控制台窗口内执行）时，我收到此错误：

`Could not open input file: \phpdoc.php`

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-03-01T16:06:22.257

Run:

```
pear 
```

it will set `%PHP_PEAR_PHP_BIN%` for you.

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-09-01T04:00:31.003

您需要将“PHP_PEAR_BIN_DIR”的环境路径设置为“phpdoc.php”所在的目录。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-12-14T10:55:36.380

我已更改 phpdoc.bat 文件以指向 phpdoc.php 的确切位置

```
@echo off
if "%PHPBIN%" == "" set PHPBIN=php.exe
if not exist "%PHPBIN%" if "%PHP_PEAR_PHP_BIN%" neq "" goto USE_PEAR_PATH
GOTO RUN
:USE_PEAR_PATH
set PHPBIN=%PHP_PEAR_PHP_BIN%
:RUN
"%PHPBIN%" "C:\wamp\bin\php\php5.3.10\phpdoc.php" %* 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-07-21T07:21:18.483

在我的 Windows 7 系统上，我在 wamp 中设置了 phpDocumentor **（版本 2.6.1）**，我的路径如下：

```
D:\Projects\wamp\www\phpDocumentor
D:\Projects\wamp\www\phpDocumentor\bin 
```

现在我所做的是我编辑了`phpdoc.bat`位于路径的文件：

```
D:\Projects\wamp\www\phpDocumentor\bin\phpdoc.bat 
```

它包含如下所示的代码：

```
@echo off
if "%PHPBIN%" == "" set PHPBIN=php.exe
if not exist "%PHPBIN%" if "%PHP_PEAR_PHP_BIN%" neq "" goto USE_PEAR_PATH
GOTO RUN
:USE_PEAR_PATH
set PHPBIN=%PHP_PEAR_PHP_BIN%
:RUN
"%PHPBIN%" "D:\Projects\wamp\www\phpDocumentor\bin\phpdoc" %* 
```

`"%PHPBIN%" "%PHP_PEAR_BIN_DIR%\phpdoc" %*`所以，我用新代码编辑了最后一行`"%PHPBIN%" "phpdoc" %*`。之后`phpdoc.bat`看起来像：

```
@echo off
if "%PHPBIN%" == "" set PHPBIN=php.exe
if not exist "%PHPBIN%" if "%PHP_PEAR_PHP_BIN%" neq "" goto USE_PEAR_PATH
GOTO RUN
:USE_PEAR_PATH
set PHPBIN=%PHP_PEAR_PHP_BIN%
:RUN
"%PHPBIN%" "phpdoc" %* 
```

此后，我再次运行以下命令`cmd`：

```
D:\Projects\wamp\www\phpDocumentor\bin>phpdoc 
```

输出是这样的：

```
D:\Projects\wamp\www\phpDocumentor\bin>phpdoc

Collecting files .. OK
Initializing parser .. OK
Parsing files

  [Exception]
  No parsable files were found, did you specify any using the -f or -d parame
  ter?

project:run [-t|--target[="..."]] [-f|--filename[="..."]] [-d|--directory[="..."
]] [--encoding[="..."]] [-e|--extensions[="..."]] [-i|--ignore[="..."]] [--ignor
e-tags[="..."]] [--hidden] [--ignore-symlinks] [-m|--markers[="..."]] [--title[=
"..."]] [--force] [--validate] [--visibility[="..."]] [--defaultpackagename[="..
."]] [--sourcecode] [-p|--progressbar] [--template[="..."]] [--parseprivate] [--
log[="..."]]

D:\Projects\wamp\www\phpDocumentor\bin> 
```

所以，输出表明它成功了！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-07T18:11:48.767

PHP 的 include_path 将需要包含该 phpdoc.php 文件的目录的路径。否则，使用具有相对路径的 require/include 语句的 phpDocumentor 代码将无法找到任何内容。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-15T08:57:33.190

我刚刚在通过 PEAR 安装 phpDocumentor2 的 Windows 7 上遇到了这个问题。我发现正在运行：

```
phpdoc -d . -t docs 
```

在**提升**的命令提示符中成功了 - 我怀疑我的机器上仍然存在一些 PATH 问题，但是已经完成了 PEAR 和 phpDocumentor 的所有默认安装步骤，它证明了我发现的最快的解决方法。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-02-12T14:03:24.927

我得到了同样的错误信息，已经做出的答案让我走上了正确的道路。

由于我不使用 wamp/xampp 或任何这些程序，我想：为什么不直接用 PHP 运行它呢？

我已经通过 WebPI 全局安装了[PHP7.0.x。](https://www.microsoft.com/web/downloads/platform.aspx?lang=)

只`php`需要在命令前加上前缀，一切正常：

`php .\phpDocumentor\bin\phpdoc -d .\src\ -t .\dst\`

# sql-server-2008 - Anjlab sql profiler，将数据限制为只有tsql和sql，语句和存储过程？

> ID：10404508
> 
> 赞同：2
> 
> 时间：2012-05-01T21:18:59.070
> 
> 标签：sql-server-2008, sql-server-profiler

使用 anjlab sql profiler，如何将捕获的数据限制为仅 tsql 和 sql、语句和存储过程？

我假设它类似于使用 SQL Server 2008 探查器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-01T00:16:19.103

当您打开“新跟踪”时，您会找到“事件”选项卡。大多数时候我会检查以下事件。他们保持数据最小化。

*   SQLStmt 已完成
*   SPstmt 已完成
*   SqlfulltextQuery。

[![Anjlab 活动](../Images/c50f2656cb4c218f2c9c90647102431f.png)](https://i.stack.imgur.com/rj4Qx.jpg)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-15T03:47:55.177

我只是展示`SQLBatchCompleted`事件

# dart - 如何比较 Dart 中的列表是否相等？

> ID：10404516
> 
> 赞同：115
> 
> 时间：2012-05-01T21:19:45.137
> 
> 标签：dart

我正在像这样比较 Dart 中的两个列表：

```
main() {
    if ([1,2,3] == [1,2,3]) {
        print("Equal");
    } else {
        print("Not equal");
    }   
} 
```

但他们从来都不是平等的。Dart API 中似乎没有用于比较列表或集合的 equal() 方法。有没有合适的方法来做到这一点？

* * *

## 回答 #1

> 赞同：184
> 
> 时间：2014-03-11T18:07:18.377

要完成 Gunter 的回答：比较列表是否相等（而不是身份）的推荐方法是使用以下包中的 Equality 类

```
import 'package:collection/collection.dart'; 
```

**编辑**：在 1.13 之前，它是~~导入'包：collection/equality.dart'；~~

例如：

```
Function eq = const ListEquality().equals;
print(eq([1,'two',3], [1,'two',3])); // => true 
```

上面的打印`true`是因为对应的列表元素是`identical()`. 如果您想（深入）比较可能包含其他集合的列表，请改用：

```
Function deepEq = const DeepCollectionEquality().equals;
List list1 = [1, ['a',[]], 3];
List list2 = [1, ['a',[]], 3];
print(    eq(list1, list2)); // => false
print(deepEq(list1, list2)); // => true 
```

还有其他 Equality 类可以通过多种方式组合，包括`Map`s 的相等性。您甚至可以对集合进行**无序**（深度）比较：

```
Function unOrdDeepEq = const DeepCollectionEquality.unordered().equals;
List list3 = [3, [[],'a'], 1];
print(unOrdDeepEq(list2, list3)); // => true 
```

有关详细信息，请参阅[包 API 文档](http://pub.dartlang.org/packages/collection)。像往常一样，要使用这样的包，你必须在你的`pubspec.yaml`：

```
dependencies:
  collection: any 
```

* * *

## 回答 #2

> 赞同：132
> 
> 时间：2019-05-03T16:48:03.493

对于那些使用 Flutter 的人来说，它具有原生函数[`listEquals`](https://docs.flutter.io/flutter/foundation/listEquals.html)，用于比较深度相等。

```
import 'package:flutter/foundation.dart';

var list1 = <int>[1, 2, 3];
var list2 = <int>[1, 2, 3];

assert(listEquals(list1, list2) == true); 
```

```
import 'package:flutter/foundation.dart';

var list1 = <int>[1, 2, 3];
var list2 = <int>[3, 2, 1];

assert(listEquals(list1, list2) == false); 
```

请注意，[根据文档](https://api.flutter.dev/flutter/foundation/listEquals.html)：

> 上面的术语“深度”指的是第一级相等：如果元素是映射、列表、集合或其他集合/复合对象，那么这些元素的值不会逐个元素进行比较，除非它们的相等运算符 ( `Object.operator==`)所以。

因此，如果您正在寻找无限级别的平等，请查看[Patrice Chalin](https://stackoverflow.com/a/22333042/6696558)[`DeepCollectionEquality`](https://api.flutter.dev/flutter/package-collection_collection/DeepCollectionEquality-class.html)的建议。

此外，如果您需要针对不同收藏的[`setEquals`](https://api.flutter.dev/flutter/foundation/setEquals.html)此类[`mapEquals`](https://api.flutter.dev/flutter/foundation/mapEquals.html)功能。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2012-05-01T23:09:25.357

Dart 中的集合没有内在的相等性。两个集合不相等，即使它们包含与元素完全相同的对象。

[集合库](http://pub.dartlang.org/packages/collection)提供了定义这种相等性的方法。在这种情况下，例如

```
IterableEquality().equals([1,2,3],[1,2,3]) 
```

是一个相等性，如果两个列表包含相同的元素，则认为它们完全相等。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2014-02-19T18:38:32.800

我只是偶然发现了这个

```
import 'package:collection/equality.dart';

void main(List<String> args) {
  if (const IterableEquality().equals([1,2,3],[1,2,3])) {
  // if (const SetEquality().equals([1,2,3].toSet(),[1,2,3].toSet())) {
      print("Equal");
  } else {
      print("Not equal");
  }
} 
```

更多信息[https://github.com/dart-lang/bleeding_edge/tree/master/dart/pkg/collection](https://github.com/dart-lang/bleeding_edge/tree/master/dart/pkg/collection)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-06-05T02:19:43.757

虽然这个问题已经相当老了，但该功能还没有在 Dart 中原生实现。我需要深度相等比较 ( `List<List>`)，所以我现在通过递归调用从上面借用：

```
bool _listsAreEqual(list1, list2) {
 var i=-1;
 return list1.every((val) {
   i++;
   if(val is List && list2[i] is List) return _listsAreEqual(val,list2[i]);
   else return list2[i] == val;
 });
} 
```

注意：混合集合类型（即`List<Map>`）时这仍然会失败 - 它只是覆盖`List<List<List>>`等等。

最新的飞镖问题似乎是[https://code.google.com/p/dart/issues/detail?id=2217](https://code.google.com/p/dart/issues/detail?id=2217)（最后更新于 2013 年 5 月）。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2015-05-18T06:53:20.043

Built Collections 库为 Dart 提供了不可变的集合，包括相等、散列和其他好东西。

如果您正在做一些需要平等的事情，那么您也有可能在不变性方面做得更好。

[http://www.dartdocs.org/documentation/built_collection/0.3.1/index.html#built_collection/built_collection](http://www.dartdocs.org/documentation/built_collection/0.3.1/index.html#built_collection/built_collection)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2021-05-01T13:10:47.607

最方便的选择是在类上创建一个[扩展方法](https://dart.dev/guides/language/extension-methods)`List`。

```
extension on List {
  bool equals(List list) {
    if(this.length!=list.length) return false;
    return this.every((item) => list.contains(item));
  }
} 
```

上面的代码所做的是检查第一个列表 ( ) 中的每个单曲`item`是否`this`包含在第二个列表 ( `list`) 中。但是，这仅适用于两个列表长度相同的情况。**当然，您可以替换为其他解决方案之一或修改此解决方案，我只是为了方便起见。**无论如何，要使用此扩展程序，请执行以下操作：

```
List list1, list2
list1.equals(list2); 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2019-04-06T23:36:24.753

有时想要比较的不是列表本身，而是包含列表的一些对象（类实例）

让你有一个带有列表字段的类，比如

```
class A {
  final String name;
  final List<int> list;

  A(this.name, this.list);
} 
```

并想比较它的实例，你可以使用[equatable 包](https://pub.dartlang.org/packages/equatable)

```
class A extends Equatable {
  final String name;
  final List<int> list;

  A(this.name, this.list);

  @override
  List<Object> get props => [name, list];
} 
```

然后简单地使用比较对象`==`

```
final x = A('foo', [1,2,3]);
final y = A('foo', [1,2,3]);
print(x == y); // true 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2021-01-29T18:34:48.633

在 Dart 中比较两个 int 列表是否相等的简单解决方案是使用 Sets（不检查列表中元素的顺序）：

```
void main() {
  var a = [1,2,3];
  var b = [1,3,2];

  var condition1 = a.toSet().difference(b.toSet()).isEmpty;
  var condition2 = a.length == b.length;
  var isEqual = condition1 && condition2;
  isEqual ? print(true) : print(false); // Will print true
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-05-07T01:48:11.130

像这样的东西对你有用吗？

```
try {
  Expect.listEquals(list1, list2);
} catch (var e) {
  print("lists aren't equal: $e");
} 
```

例子：

```
main() {
  List<int> list1 = [1, 2, 3, 4, 5];
  List<int> list2 = new List.from(list1);
  try {
    Expect.listEquals(list1, list2);
  } catch (var e) {
    print("lists aren't equal: $e");
  }
  list1.removeLast();
  try {
    Expect.listEquals(list1, list2);
  } catch (var e) {
    print("Lists aren't equal: $e");
  }
} 
```

第二次尝试打印：

```
Lists aren't equal: Expect.listEquals(list length, expected: <4>, actual: <5>) fails 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2012-07-27T19:40:43.610

在一切正常之前，你可以使用这个：

```
 /**
   * Returns true if the two given lists are equal.
   */
  bool _listsAreEqual(List one, List two) {
    var i = -1;
    return one.every((element) {
      i++;

      return two[i] == element;
    });
  } 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2020-11-17T22:47:42.577

**在 Dart 中比较两个 int 列表是否相等的**简单解决方案是使用 join() 将其作为 String 进行比较：

```
var a = [1,2,3,0];
var b = [1,2,3,4];

a.join('') == b.join('') ? return true: return false; 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2021-11-03T00:20:01.340

```
bool areListsEqual(var list1, var list2) {
    // check if both are lists
    if(!(list1 is List && list2 is List)
        // check if both have same length
        || list1.length!=list2.length) {
        return false;
    }

    // check if elements are equal
    for(int i=0;i<list1.length;i++) {
        if(list1[i]!=list2[i]) {
            return false;
        }
    }

    return true;
} 
```

# html - 如何将图像翻转与链接翻转连接起来？

> ID：10404517
> 
> 赞同：1
> 
> 时间：2012-05-01T21:19:52.260
> 
> 标签：html, css

您如何设置链接/图像，以便当您悬停图像时，页面上的链接会变为悬停状态，反之亦然？

与本网站类似：http: [//www.adrianlawrence.co.nz/](http://www.adrianlawrence.co.nz/)

任何帮助都会很棒！

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T22:15:45.293

纯 CSS 和 HTML 绝对可以用来创建类似于您链接到的网站的效果。

看看[这个小提琴](http://jsfiddle.net/trExc/)。

1.  将链接文本和图像放在一个`a`元素中。
2.  给你的每张图片一个独特的`ID`.
3.  使用 CSS 将您的图像绝对（或相对，您的呼叫）定位在所需位置。

的HTML：

```
<a href="www.google.com">
    Hello there.
    <img id="img1" src="[SOURCE]" alt="Be Happy!" />
</a>​ 
```

CSS：

```
/* The Important Stuff */

#img1 {
    position:absolute;
    bottom:20px;
    right:45px;
}

a:hover {
    text-decoration:none;
}

a:hover img {
    opacity:.8;
}

/* The Unimportant Stuff */

body {
    background-color:black;
}

a {
    color:white;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T21:23:33.087

您可以将事件侦听器附加到一个（图像或链接）以侦听鼠标悬停。让它触发一个函数，该函数将找到匹配 ID 的元素（图像和链接匹配，即图像 id =“image1”，链接 id =“link1”）并更改 CSS。

# api - 停止后重新启动可滚动的 Jquery 工具 - 使用 API

> ID：10404521
> 
> 赞同：1
> 
> 时间：2012-05-01T21:19:59.363
> 
> 标签：api, jquery-tools, scrollable

我正在使用[像this example这样](http://jquerytools.org/demos/scrollable/plugins-chain.htm)的Jquery Tools Scrollable插件，我想要自定义按钮来让它开始和停止。我可以让它停止自动滚动，但我不能让它从我停止的地方恢复自动滚动。

这是我初始化它的方式：

```
$(document).ready(function() {
// heeeeeeeeeeere we go.
var root = $("#chained").scrollable({circular: true, mousewheel: true, 
easing:'easeInOutQuint', speed: 1200}).navigator().autoscroll({
interval: 3000
});

// provide scrollable API for the action buttons
window.api = root.data("scrollable");

}); 
```

从[这个线程](https://stackoverflow.com/questions/7896764/jquery-scrollable-cant-stop-autoplay-when-nav-is-clicked)，我可以让它“停止”。我也知道我也可以让它“开始” - 转到第一张幻灯片 - 通过使用这些：

```
<a href='javascript:void(0);' onclick="api.begin();">Start</a>
<a href='javascript:void(0);' onclick="api.stop();">Stop</a> 
```

尽管它确实转到了第一个窗格/幻灯片，但它不再自动滚动。有没有办法让它在我“停止”它的位置恢复自动滚动？另外，该`window.api=root.data("scrollable");`方法是否已弃用？我应该以不同的方式处理吗？

TIA 的任何建议。

# actionscript-3 - 关于删除对象和内存/垃圾收集的 AS3 问题

> ID：10404527
> 
> 赞同：0
> 
> 时间：2012-05-01T21:20:28.213
> 
> 标签：actionscript-3, memory, memory-management, memory-leaks, garbage-collection

我有一个例程，它反复构建和重建一个充满按钮的大型动态影片剪辑，称为“bigList”。当它重建时，它首先尝试丢弃 bigList，以便它不会重复地将它的实例添加到舞台（它已经做了一段时间）。

我想出了这个似乎可以解决问题的代码：

```
if (bigList.stage)
{
trace("...bigList exists, better trash it");
bigList.parent.removeChild(bigList);
bigList = null;
bigList = new MovieClip();
trace("...done trashing.");
} 
```

它似乎工作......我关心的是垃圾收集和内存泄漏等。通过执行上述操作，我是否正确地摆脱了旧的 bigList 并重新替换它，或者内存中是否会有我必须处理的数据？

除此之外，每次构建 bigList 时，它都会添加几十个动态生成的 mc，每个 mc 都有一个事件侦听器来检查点击。当我每次都丢弃 bigList 时，所有这些实例和侦听器是否也都在附近？

我是否需要遍历 bigList 的所有孩子并将它们以及它们的听众也丢弃？有没有一种有效的方法来做到这一点，丢弃一个顶级对象及其所有子对象和侦听器，还是我已经用我的代码得到了它？

非常感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T21:37:04.193

垃圾收集的伟大之处在于它为您完成了大部分工作。您所要做的就是保证没有对对象的引用，如果这是真的，那么 GC 将以自己的速度从内存中删除对象*（您不能在您自己选择的时间强制它清空）*。

从您上面的代码示例中，您做得很好，我建议只做一个小改动：

```
if (bigList.stage)
{
    trace("...bigList exists, better trash it");
    this.removeChild(bigList); // "bgList.parent" is the same as using "this"
    bigList = new MovieClip();
    trace("...done trashing.");
} 
```

您不需要将变量设置为，`null`因为将新`MovieClip`对象放入变量中意味着旧对象没有引用。

`bgList.parent`此外，由于您已经在父类中，因此不需要使用。您甚至可以删除`this.`以简化可读性并减少混乱，但最好将其保留。

因此，除了那些小的建议之外，您做得很好，并且根据您的示例，您不应该有任何由该代码段引起的内存泄漏。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T22:59:24.897

添加到 xLite 的答案中，您可以*在调试*时使用强制垃圾收集过程并检查您是否已正确删除引用 - 通常通过在之后立即检查总 RAM 使用情况。[`System.gc()`](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/system/System.html#gc%28%29) *[`System.totalMemoryNumber`](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/system/System.html#totalMemoryNumber)*

# xmpp - 将现有聊天数据库迁移到 XMPP (jabber) db

> ID：10404529
> 
> 赞同：1
> 
> 时间：2012-05-01T21:20:31.130
> 
> 标签：xmpp, openfire, strophe

我有一个现有的聊天和个人资料网站，有 25 万活跃用户。用户有个人资料等等。目前，我自己使用 ajax 进行了聊天，但我正在转向 XMPP 协议。

为此，我安装了 Openfire 并使其与 js 客户端框架 strophejs 一起工作，我制作了一个简单的测试客户端，一切正常。

例如，我不知道如何向 openfire 用户添加图片或个人资料。当我从服务器获得“存在”更新时，我只会获得用户名/电子邮件。我想使用我自己的数据库中的配置文件来扩展用户，或者将我现有的数据库迁移到 openfire 的数据库，但是我将配置文件数据放在哪里？

有人可以在这里给我一些指示吗？

谢谢，

埃尔格

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T14:18:40.677

只需使用 vCard 存储配置文件信息和图片 (XEP-0054) [http://xmpp.org/extensions/xep-0054.html](http://xmpp.org/extensions/xep-0054.html)。您可以在本书（第 4 章）中找到更多信息：http: [//shop.oreilly.com/product/9780596521271.do](http://shop.oreilly.com/product/9780596521271.do)。

# php - sql查询后的if else语句

> ID：10404531
> 
> 赞同：0
> 
> 时间：2012-05-01T21:20:43.467
> 
> 标签：php, mysql, sql

所以我有这个搜索 torrent_download 的查询，torrent_download 只能是 1 或 0；

```
$sql_istorrenthere = $this->query("SELECT torrent_download
FROM " . DB_PREFIX . "auctions WHERE
                auction_id='" . $item_details['auction_id'] . "'"); 
if (empty($sql_istorrenthere))
{

        $display_output = GMSG_NOTORRENT;}
        else
        $display_output = GMSG_TORRENT;
} 
```

我想要做的是`if (empty($sql_istorrenthere))`用类似的东西替换部分`if $sql_istorrenthere == 1 then $display_output = GMSG_NOTORRENT; else $display_output = GMSG_TORRENT;`

这个怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T21:41:54.070

您首先必须获取结果行，很难说如何因为您没有告诉我们您正在使用的框架/数据库抽象层。检查文档，您希望将结果作为数组或对象获取。

对于数组：

尝试使用 显示结果`var_dump`，如果成功，您将看到一个数组，其中键为`torrent_download`键。然后简单地与`$res['torrent_download']`比较`1`。

# jquery - 简单的 JSON 问题？

> ID：10404532
> 
> 赞同：0
> 
> 时间：2012-05-01T21:20:44.697
> 
> 标签：jquery, json, object, post

老实说，我认为我有一个大脑打嗝或什么的，但我已经被抓住了整整半个小时。我正在使用 jQuery 的 .post() 发布，响应是一个 JSON 对象，例如：

```
{
    "meta": {
        "status": 201,
        "msg": "Created"
    },
    "response": {
        "id": 1111111
    }
} 
```

但是，我不知道为什么我不能在这个 JSON 中定位任何东西。这是我正在处理的问题：

```
$.post('post.php',function(d){
    alert(d) // Returns the JSON string above
    alert(d.meta.status) // Returns 'undefined' (expecting 201)
}) 
```

帮助！谢谢 ：）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T21:22:07.573

您可以[将](http://api.jquery.com/jQuery.post/) *json*作为`dataType`：

```
$.post('post.php',function(d){
    alert(d.meta.status)
}, "json"); 
```

**编辑：**否则，正如@IliaG 在评论中所述，`post.php`可以通过以下方式传递内容类型：

```
header("Content-Type: application/json"); 
```

# python - os.path.getsize 返回不正确的值？

> ID：10404534
> 
> 赞同：11
> 
> 时间：2012-05-01T21:20:58.930
> 
> 标签：python, file, directory, size

```
def size_of_dir(dirname):
    print("Size of directory: ")
    print(os.path.getsize(dirname)) 
```

是有问题的代码。dirname 是一个包含**130 个**文件的目录，每个文件大约**1kb**。当我调用这个函数时，它返回**4624**，这**不是**目录的大小......这是为什么呢？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-01T21:28:52.040

此值 (4624B) 表示描述该目录的文件*的*大小*。*目录被描述为 inode ( [http://en.wikipedia.org/wiki/Inode](http://en.wikipedia.org/wiki/Inode) )，其中包含有关其包含的文件和目录的信息。

 *要获取该路径中的文件/子目录的数量，请使用：

```
len(os.listdir(dirname)) 
```

要获取数据总量，您可以使用[此问题中](https://stackoverflow.com/questions/1392413/calculating-a-directory-size-using-python)的代码，即（如@linker 发布的那样）

```
 sum([os.path.getsize(f) for f in os.listdir('.') if os.path.isfile(f)]). 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-01T21:25:42.060

使用`os.path.getsize()`只会让你知道目录的大小，而**不是**它的内容。因此，如果您调用`getsize()`任何目录，您将始终获得相同的大小，因为它们都以相同的方式表示。相反，如果您在文件上调用它，它将返回实际文件大小。

如果您想要内容，则需要递归执行，如下所示：

```
sum([os.path.getsize(f) for f in os.listdir('.') if os.path.isfile(f)]) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2021-03-22T14:13:47.283

第一个答案给我带来了这个：

```
>>> sum([os.path.getsize(f) for f in os.listdir('.') if os.path.isfile(f)])
1708 
```

这对我来说也不正确:(（我确实检查了我的 cwd）

下面的代码给我带来了更接近的结果

```
total_size = 0
for folders, subfolders, files in os.walk(dirname):
    for file in files:
        total_size += os.path.getsize(os.path.join(folders, file))
print(total_size) 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2020-04-11T09:25:58.253

```
import os

def create_python_script(filename):
    comments = "# Start of a new Python Program"
    #filesize = 0
    with open(filename, 'w') as new_file:
        new_file.write(comments)
        cwd=os.getcwd()
        fpath = os.path.abspath(filename)
        filesize=os.path.getsize(fpath)
    return(filesize)

print(create_python_script('newprogram.py')) 
```

它应该是 31 个字节，但结果是“0”*

# android - android的子字符串检查帮助

> ID：10404536
> 
> 赞同：0
> 
> 时间：2012-05-01T21:21:18.393
> 
> 标签：android, substring

有人可以帮我一些代码吗？我应该检查传递的字符串是否为 2 个字符串和 3 个整数，可以正常工作，但如果 1 个整数为零，则它不起作用

所以如果它是 CM044 它将无法工作，CM450 将工作可以请有人帮忙。

```
public boolean checkModule(String Module) {

    if(Module.length() == 5){
      boolean hasString = false;
      boolean hasInt = false;
      String letters = Module.substring(0, 2);
      Pattern p = Pattern.compile("^[a-zA-Z]+$");
      Matcher m = p.matcher(letters);
      if (m.matches()) {
        hasString = true;
      }
      String numbers=Module.substring(2,5);
      try {
        int num = Integer.parseInt(numbers);
        String n = num + "";
        if (num >0 && n.length() == 3)
            hasInt = true;
      } catch (Exception e) {
      }
      if (hasInt && hasString) {
        return true;
      }
     }else{
      return false;
     }

    return false;
} 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T21:38:37.990

如果你打算使用正则表达式，你一定要坚持使用它们，不要进进出出。

```
包 com.examples；

导入 java.util.regex.Matcher；
导入 java.util.regex.Pattern；

公共类主要{

    /**
     * @param 参数
     */
    公共静态无效主要（字符串[]参数）{
        新的主要（）；
    }

    公共主要（）{
        String[] testInputs = new String[] {"CM045", "CM450"};

        for（字符串输入：testInputs）{
            System.out.println("模块 " + input + " 为 " + (checkModule(input) ? "valid" : "invalid"));
        }
    }

    公共布尔检查模块（字符串模块）{
        模式 p = Pattern.compile("[AZ]{2}[0-9]{3}");
        匹配器 m = p.matcher(Module.toUpperCase());
        返回 m.matches();
    }

}

```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T21:25:26.833

如果 String 为“045”，则 Integer 值为 45，因此 num 的长度不能为 3

用这个

```
if(num>=0) {
  hasInt = true;
} 
```

它必须工作

# javascript - ExtJS 4 组合框在表单绑定上显示 valueField 而不是 displayField

> ID：10404537
> 
> 赞同：4
> 
> 时间：2012-05-01T21:21:23.923
> 
> 标签：javascript, extjs, combobox, extjs4

我在绑定到模型的表单中有一个 extjs 4 组合框。我正在使用 form.loadRecord(record) 将数据从网格绑定到组合。组合框显示来自分配给表单的模型的 valueField，而不是 displayField。组合框的存储是预加载的。如何实现组合框显示 displayValue 在表单中加载记录？

```
 {xtype:'combobox',
        fieldLabel: 'category',
        name: 'categorySelId',
        store: 'Categories',
        queryMode: 'local',
        displayField: 'label',
        valueField: 'id',
        anchor:'96%',
        loadMask: true,
        typeAhead: true,
        forceselection: true,
        valueNotFoundText: 'Nothing found'} 
```

商店已经在网格中用于显示列类别

```
 { header: 'Category', dataIndex: 'categorySelectedId', flex:5,
            renderer: function(value,metaData,record) {
                if(value) {
                    var Categories = Ext.getStore('Categories');
                    var catRecord = Categories.findRecord('id', value);
                    return catRecord ? catRecord.get('label'): record.get('categorySelected');
                } else return "";
            }
        }, 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-03T01:47:21.237

问题是我没有在模型中配置正确的类型。在模型中设置正确的类型解决了这个问题。谢谢你帮忙！

# jquery-selectors - jquery 多个上下文的相同选择器

> ID：10404539
> 
> 赞同：0
> 
> 时间：2012-05-01T21:21:37.040
> 
> 标签：jquery-selectors

我想编写一个优雅的解决方案，通过在不同上下文列表中搜索来选择相同的标签

```
//i have this not editable code
var c1$ = $('#context1'),
    c2$ = $('#context2'),
    c3$ = $('#context3');

//I want to improve the code and 'only from here on
var selector = 'a.select';
c1$.find(selector).css('color','red');
c3$.find(selector).css('color','red'); 
```

我正在寻找任意数量的上下文的解决方案

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-01T21:35:13.347

您可以使用`$.add()`来构建您的上下文，然后将其用作选择器的上下文参数中的单个 jQuery 对象：

```
var $foo = $("#foo"),
    $bar = $("#bar");

var $context = $foo.add($bar);

$("a.select", $context).css("color", "red"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T23:15:56.657

为什么不加载上下文列表，然后执行 foreach 以在每个上下文中找到“a.select”？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T23:43:12.953

我绝望的不优雅的解决方案

```
var contexts = [$('#context1'),$('#context2'),$('#context3')];
//list of contexts in single variable(arbitrary number!)

var selector = 'a.select';
//same selector for all variable contexts

var cons$ = $([]);
//empty temporary selector

for(i in contexts)
    cons$ = cons$.add(contexts[i]);

var allmatches$ = cons$.find(selector);

//here processing allmatches$

allmatches$.css("color", "red"); 
//now apply css in one step 
```

# matlab - 计算矩阵行列式的问题

> ID：10404543
> 
> 赞同：5
> 
> 时间：2012-05-01T21:22:03.883
> 
> 标签：matlab, linear-algebra, matrix-inverse

我正在尝试计算矩阵逆的行列式。矩阵的逆存在。但是，当我尝试计算逆的行列式时，它在 matlab 中给了我 Inf 值。这背后的原因是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T14:40:33.887

简答：给定`A = inv(B)`，那么`det(A)==Inf`可能有两种解释：

1.  在行列式的数值计算期间发生溢出，
2.  中的一个或多个无限元素`A`。

在第一种情况下，您的矩阵缩放严重，因此`det(B)`可能下溢和`det(A)`溢出。请记住，`det(a*B) == a^N * det(B)`where`a`是标量并且`B`是`N`时间`N`矩阵。

在第二种情况下（即`nnz(A==inf)>0`），矩阵`B`可能是“工作精度的奇异”。

PS：

如果矩阵的条件数很大，则它几乎是奇异的。（小行列式与奇点无关，因为行列式本身的大小受缩放影响。）。

如果矩阵在高斯消元中具有零枢轴，则矩阵对于工作精度来说是奇异的：在计算逆时，matlab 必须计算`1/0`哪个返回`Inf`。

事实上，在 Matlab 中溢出和零除异常不会被捕获，因此，根据 IEEE 754，`Inf`会传播一个值。

# objective-c - UrlByAppendingPathComponent 与 UrlByAppendingPathExtension

> ID：10404550
> 
> 赞同：10
> 
> 时间：2012-05-01T21:22:23.717
> 
> 标签：objective-c, ios, ios5

我已经阅读了文档，看起来一些边缘情况可能会有所不同（斜杠等），但我不清楚这两种方法之间的主要区别是什么。组件和扩展这两个术语在我以外的人理解的 URL 世界中是否具有特殊含义？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-05-01T21:36:00.293

路径扩展用于添加诸如`.html`URL 之类的东西，路径组件用于添加诸如`/news/local`. 路径扩展的文档：

> 如果原始 URL 以一个或多个正斜杠结尾，则这些正斜杠将从返回的 URL 中删除。在新 URL 的两个部分之间插入一个句点。

所以`http://hello.com/news/`会变成`http://hello.com/news.html`

路径组件的文档：

> 如果原始 URL 不以正斜杠结尾且 pathComponent 不以正斜杠开头，则在返回的 URL 的两部分之间插入正斜杠，除非原始 URL 是空字符串。

所以`http://hello.com/news/`会变成`http://hello.com/news/html`

这是一个快速测试：

```
NSURL *originalURL = [NSURL URLWithString:@"http://hello.com/news"];
NSLog(@"%@", [originalURL URLByAppendingPathComponent:@"local"]);
NSLog(@"%@", [originalURL URLByAppendingPathExtension:@"local"]); 
```

输出：

```
http://hello.com/news/local
http://hello.com/news.local 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-01T21:47:51.947

每当我对这样的事情有疑问，并且文档没有帮助时，我只是在逻辑测试中对其进行测试。

```
NSURL *baseURL = [NSURL URLWithString:@"http://foo.com/bar/baz"];
NSURL *appendExtension = [baseURL URLByAppendingPathExtension:@"qux"];
NSURL *appendComponent = [baseURL URLByAppendingPathComponent:@"qux"];

STAssertEqualObjects([appendExtension absoluteString], @"http://foo.com/bar/baz.qux", nil);
STAssertEqualObjects([appendComponent absoluteString], @"http://foo.com/bar/baz/qux", nil); 
```

就是这样，扩展名是.（文件类型），组件是/（目录）。

# android - Android SQLite 数据库：创建数据库后添加列

> ID：10404552
> 
> 赞同：1
> 
> 时间：2012-05-01T21:22:46.057
> 
> 标签：android, sqlite

创建 SQLite 数据库后，我对更新它们有点不熟悉。添加新列和更新行中的值相对容易吗？就像将电子邮件或 Twitter 名称列添加到联系人列表应用程序一样。或者我是否可以设置名称为“Col1、Col2 等”的列以备后用，然后当我想使用这些列时，将它们添加到我的应用程序的查询/游标中，使 KEY_EMAIL 为“Col15”或其他。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T21:26:49.203

Sqlite 支持 ALTER TABLE 命令的有限子集。您可以重命名表或添加新列。因此，在创建表后，您不能重命名或删除列或删除约束（至少不能使用 sql 命令）。

因此，无需添加“备用”列。事实上，既然你不能删除列，那是个坏主意。

[SQLite 理解的 SQL](http://www.sqlite.org/lang_altertable.html)

# c++ - 是什么导致了这个张量外积中的无限模板递归？

> ID：10404553
> 
> 赞同：2
> 
> 时间：2012-05-01T21:22:48.583
> 
> 标签：c++, templates, math, template-meta-programming

我正在使用张量的模板表示来实现外部产品。

张量的基本原型如下所示：

```
template <int N>
struct Tensor
{
    Tensor<N - 1> x;
    Tensor<N - 1> y;
    Tensor<N - 1> z;
}; 
```

专门用于`Tensor<1>`降级为简单向量。我的`Outer`功能定义为：

```
template <int N, int M>
Tensor<N + M> Outer(const Tensor<N> &lhs, const Tensor<M> &rhs)
{
    Tensor<N + M> result;

    result.x = Outer(lhs.x, rhs);
    result.y = Outer(lhs.y, rhs);
    result.z = Outer(lhs.z, rhs);

    return result;
}

template <int N>
Tensor<N + 1> Outer(const Tensor<N> &lhs, const Tensor<1> &rhs)
{
    Tensor<N + 1> result;

    result.x = Outer(lhs.x, rhs);
    result.y = Outer(lhs.y, rhs);
    result.z = Outer(lhs.z, rhs);

    return result;
}

template <>
Tensor<2> Outer(const Tensor<1> &lhs, const Tensor<1> &rhs)
{
    Tensor<2> result;

    result.x.x = lhs.x * rhs.x;
    result.x.y = lhs.x * rhs.y;
    result.x.z = lhs.x * rhs.z;

    // and so on

    return result;
} 
```

阶张量`A`和阶`N`张量`B`的`M`外积只是每个元素`A`与`B`张量的外积。`N`任何阶张量与阶张量的外积的`1`定义类似。

基本情况只是两个阶`1`张量（向量）的外积。除了，如上所述，我`C1202`在 MSVC 中遇到错误：

> 错误 C1202：递归类型或函数依赖上下文太复杂

我对外部产品的定义做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T21:43:08.087

这对我来说很干净：

```
template<int N>
struct Tensor
{
    Tensor<N - 1> x;
    Tensor<N - 1> y;
    Tensor<N - 1> z;

    Tensor() { }

    Tensor(const Tensor<N-1>& X, const Tensor<N-1>& Y, const Tensor<N-1>& Z)
      : x(X), y(Y), z(Z)
    { }
};

template<>
struct Tensor<1>
{
    double x;
    double y;
    double z;

    Tensor() : x(), y(), z() { }
    Tensor(double x, double y, double z) : x(x), y(y), z(z)
    { }
};

template<int N, int M>
Tensor<N + M> Outer(const Tensor<N>& lhs, const Tensor<M>& rhs)
{
    Tensor<N + M> result;

    result.x = Outer(lhs.x, rhs);
    result.y = Outer(lhs.y, rhs);
    result.z = Outer(lhs.z, rhs);

    return result;
}

template<int N>
Tensor<N + 1> Outer(const Tensor<N>& lhs, const Tensor<1>& rhs)
{
    Tensor<N + 1> result;

    result.x = Outer(lhs.x, rhs);
    result.y = Outer(lhs.y, rhs);
    result.z = Outer(lhs.z, rhs);

    return result;
}

template<int N>
Tensor<N + 1> Outer(const Tensor<1>& lhs, const Tensor<N>& rhs)
{
    return Outer(rhs, lhs);
}

Tensor<2> Outer(const Tensor<1>& lhs, const Tensor<1>& rhs)
{
    Tensor<2> result;

    result.x.x = lhs.x * rhs.x;
    result.x.y = lhs.x * rhs.y;
    result.x.z = lhs.x * rhs.z;
    result.y.x = lhs.y * rhs.x;
    result.y.y = lhs.y * rhs.y;
    result.y.z = lhs.y * rhs.z;
    result.z.x = lhs.z * rhs.x;
    result.z.y = lhs.z * rhs.y;
    result.z.z = lhs.z * rhs.z;

    return result;
}

int main()
{
    Tensor<4> a;
    Tensor<4> b;
    Outer(a, b);
} 
```

显着的变化是：

1.  `Tensor<1>`需要在任何`Outer`重载之前定义特化。
2.  特`Tensor<1>`化必须是可默认构造的，因为`Tensor<2>`将尝试默认构造其`x`、`y`和`z`数据成员。
3.  `template<int N> Tensor<N + 1> Outer(const Tensor<1> &lhs, const Tensor<N> &rhs)`与 对称需要`template<int N> Tensor<N + 1> Outer(const Tensor<N> &lhs, const Tensor<1> &rhs)`重载，或者您需要添加采用`double`for的重载`lhs`。
4.  `template<>`从重载中移除`Tensor<2> Outer(const Tensor<1> &lhs, const Tensor<1> &rhs)`——我们在这里*重载*，而不是专门化。

# javascript - Facebook API：检查用户是否在连接时登录

> ID：10404557
> 
> 赞同：3
> 
> 时间：2012-05-01T21:22:50.913
> 
> 标签：javascript, facebook, api, pageload

我一直在尝试让我的网站检查用户是否在页面加载时登录，但尽管遵循了 API 说明，但我无法让它工作，这是一个示例：

```
<!DOCTYPE html>
    <html>
        <head>
             <title>My Facebook Login Page</title>
        </head>
        <body>
            <div id="fb-root"></div>
            <script>
                alert('hello');
                window.fbAsyncInit = function() {
                    FB.init({
                        appId  : 'APP_ID',
                        status : true, 
                        cookie : true,
                        xfbml  : true,
                        oauth  : true
                    });

                    FB.getLoginStatus(function( response ) {
                       console.log(response);
                       alert('hello2');  
                    });

                    FB.Event.subscribe('auth.statusChange', function(response) {
                       alert('hello2');
                    });

                    FB.Event.unsubscribe('auth.statusChange');
               };
               (function(d){
                   var js, id = 'facebook-jssdk'; if (d.getElementById(id)) {return;}
                   js = d.createElement('script'); js.id = id; js.async = true;
                   js.src = "//connect.facebook.net/en_US/all.js";
                   d.getElementsByTagName('head')[0].appendChild(js);
               }(document));
           </script>
       </body>
    </html> 
```

除非用户登录，否则甚至不会触发警报，如果他已注销，则此警报或该代码块内的任何内容都不会触发。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T21:41:29.243

在上面的示例中，删除尾随逗号 (oauth: true,) // 这可能只是来自复制/粘贴但想要消除任何陷阱

对于调试，控制台日志记录是我的首选方法，但由于您甚至没有看到警报，因此您的情况有点棘手。

```
FB.Event.subscribe("auth.statusChange", function(response) {
  console.log(response);
});

FB.Event.unsubscribe("auth.statusChange");
// If you were to get subscribe to work, think about unsubscribing at some point to, since most likely that's only for an initial check 
```

或者，尝试使用 getLoginStatus 而不是事件订阅。

```
FB.getLoginStatus(function( response ) {
    console.log(response);  
}); 
```

响应应该给你一个对象，你可以检查`response.status`它的可能值是：connected、not_authorized 或 unknown `response.authResponse`将包括如下属性：accessToken、expiresIn 等。

# magento - Magento 1.6.2 - 覆盖联系人控制器的问题

> ID：10404558
> 
> 赞同：2
> 
> 时间：2012-05-01T21:23:01.693
> 
> 标签：magento

好的，所以我设置了一个新模块来覆盖联系人控制器，以便我可以向它添加新闻通讯注册选项。我的设置如下：

/app/code/local/MyNamespace/ContactsPlus/controllers/Contacts/IndexController.php：

```
<?php
# Controllers are not autoloaded so we will have to do it manually:
require_once 'Mage/Contacts/controllers/IndexController.php';
class MyNameSpace_ContactsPlus_Contacts_IndexController extends Mage_Contacts_IndexController
{
    # Overloaded indexAction
    public function indexAction() {
        # Just to make sure
        error_log('Yes, I did it!');
        parent::indexAction();
    }
} 
```

/app/code/local/MyNamespace/ContactsPlus/etc/config.xml：

```
<?xml version="1.0"?>
<config>
    <modules>
        <mynamespace_ContactsPlus>
            <version>0.1.0</version>
        </mynamespace_ContactsPlus>
    </modules>
    <global>
        <rewrite>
            <mynamespace_contactsplus_contacts_index>
                <from><![CDATA[#^/contacts/index/#]]></from>
                <to>/contactsplus/contacts_index/</to>
            </mynamespace_contactsplus_contacts_index>
            <mynamespace_contactsplus_contacts_index>
                <from><![CDATA[#^/contacts/#]]></from>
                <to>/contactsplus/contacts_index/</to>
            </mynamespace_contactsplus_contacts_index>            
        </rewrite>
    </global>
    <frontend>
        <routers>
            <mynamespace_contactsplus>
                <use>standard</use>
                <args>
                    <module>mynamespace_ContactsPlus</module>
                    <frontName>contactsplus</frontName>
                </args>
            </mynamespace_contactsplus>
        </routers>
    </frontend>    
</config> 
```

/app/etc/modules/MyNamespace_All.xml：

```
<?xml version="1.0"?>
<config>
<modules>
    <MyNameSpace_ContactsPlus>
        <active>true</active>
        <codePool>local</codePool>
    </MyNamespace_ContactsPlus>
</modules>
</config> 
```

该模块出现在管理模块列表中，它在我的 /contacts/ 页面上产生了以下错误：

```
Fatal error: Call to a member function setFormAction() on a non-object in /srv/www/foo.com/app/code/core/Mage/Contacts/controllers/IndexController.php on line 54 
```

就是这一行：

```
 $this->getLayout()->getBlock('contactForm')->setFormAction( Mage::getUrl('*/*/post') ); 
```

不过，我不确定从哪里开始，猜测是它无法对从 Mage::getUrl(' */* /post') 返回的任何内容设置表单操作，但我正在抓紧稻草。

任何建议的帮助将不胜感激！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-03T15:11:58.600

好的，经过大量研究、帮助和普遍的挫败感，这就是我如何让它工作的：

首先，我的模块目录设置如下（注意目录上的大写）：

/app/code/local/MyNamespace/ContactsPlus/etc/

*   配置文件

/app/code/local/MyNamespace/ContactsPlus/controllers/

*   索引控制器.php

/app/code/local/MyNamespace/ContactsPlus/Helper/

*   数据.php

现在对于配置文件：

/app/code/local/MyNamespace/ContactsPlus/etc/config.xml：

```
<?xml version="1.0"?>
<config>
    <modules>
        <MyNameSpace_ContactsPlus>
            <version>0.1.0</version>
        </MyNameSpace_ContactsPlus>
    </modules>
    <frontend>
        <routers>

        <!-- Creates route to my module via /contactsplus/ - I used this for testing -->
            <contactsplus>
                <use>standard</use>
                <args>
                    <module>MyNameSpace_ContactsPlus</module>
                    <frontName>contactsplus</frontName>
                </args>
            </contactsplus>

        <!-- Sets Mage_Contacts route to MyNameSpace_ContactsPlus -->              
            <contacts>
                <args>
                    <modules>
                        <MyNameSpace_ContactsPlus before="Mage_Contacts">MyNameSpace_ContactsPlus</MyNameSpace_ContactsPlus>
                    </modules>
                </args>
            </contacts> 
        </routers>
    <!-- Sets layout config file (essential for this to work) -->   
        <layout>
            <updates>
                <contactsplus>
                    <file>contactsplus.xml</file>
                </contactsplus>
            </updates>
        </layout>        
    </frontend>
    <global>
    <!-- Sets a helper class for the module, when overriding contacts this is also essential. -->   
        <helpers>
            <contactsplus>
                <class>MyNameSpace_ContactsPlus_Helper</class>
            </contactsplus>
        </helpers>        
    </global>
</config> 
```

/app/code/local/MyNamespace/ContactsPlus/controllers/Contacts/IndexController.php：

```
<?php
# Controllers are not autoloaded so we will have to do it manually:
require_once 'Mage/Contacts/controllers/IndexController.php';
class MyNameSpace_ContactsPlus_IndexController extends Mage_Contacts_IndexController
{
    # Overloaded indexAction
    public function indexAction() {
        # Just to make sure
        //die('Yes, I did it!');
        parent::indexAction();
    }
} 
```

/app/code/local/MyNamespace/ContactsPlus/Helper/Data.php：

```
<?php
class MyNameSpace_ContactsPlus_Helper_Data extends Mage_Core_Helper_Abstract
{

} 
```

/app/etc/modules/MyNamespace_ContactsPlus.xml：

```
<?xml version="1.0"?>
<config>
    <modules>
        <MyNameSpace_ContactsPlus>
            <active>true</active>
            <codePool>local</codePool>
        </MyNameSpace_ContactsPlus>
    </modules>
</config> 
```

/app/design/frontend/mythemepackage/mytheme/layout/contacts.xml：

```
<?xml version="1.0"?>
<layout version="0.1.0">
    <default>
        <reference name="footer_links">
            <!-- <action method="addLink" translate="label title" module="contacts" ifconfig="contacts/contacts/enabled"><label>Contact Us</label><url>contacts</url><title>Contact Us</title><prepare>true</prepare></action>
         --></reference>
    </default>
    <contacts_index_index translate="label">
    <!-- had to comment this out in order to prevent a duplicate form issue, if anyone has a better method for this then I'd love to here it :) 
        <label>Contact Us Form</label>
        <reference name="head">
            <action method="setTitle" translate="title" module="contacts"><title>Contact Us</title></action>
        </reference>
        <reference name="root">
            <action method="setTemplate"><template>page/2columns-right.phtml</template></action>
            <action method="setHeaderTitle" translate="title" module="contacts"><title>Contact Us</title></action>
        </reference>
        <reference name="content">
            <block type="core/template" name="contactForm" template="contacts/form.phtml"/>
        </reference>
    -->
    </contacts_index_index>

    <!-- added this to rewrite contacts handle to the new modules handle -->
    <contacts_index_index>
        <update handle="contactsplus_index_index"/>
    </contacts_index_index>
</layout> 
```

/app/design/frontend/mythemepackage/mytheme/layout/contactsplus.xml：

```
<?xml version="1.0"?>
<layout version="0.1.0">
    <default>
        <reference name="footer_links">
            <!-- <action method="addLink" translate="label title" module="contacts" ifconfig="contacts/contacts/enabled"><label>Contact Us</label><url>contacts</url><title>Contact Us</title><prepare>true</prepare></action>
         --></reference>
    </default>
    <contactsplus_index_index translate="label">
        <label>Contact Us Form</label>
        <reference name="head">
            <action method="setTitle" translate="title" module="contactsplus"><title>Contact Us</title></action>
        </reference>
        <reference name="root">
            <action method="setTemplate"><template>page/2columns-right.phtml</template></action>
            <action method="setHeaderTitle" translate="title" module="contactsplus"><title>Contact Us</title></action>
        </reference>
        <reference name="content">
            <block type="core/template" name="contactForm" template="contactsplus/custom_form.phtml"/>
        </reference>
    </contactsplus_index_index>

</layout> 
```

I also made a copy of /app/design/frontend/mythemepackage/mytheme/template/contacts/form.phtml and placed it in /app/design/frontend/mythemepackage/mytheme/template/contactsplus/ and then modified it to suit my requirements.

Resources I found particularly useful during this process were google, IRC #magento and

[http://www.magentocommerce.com/wiki/5_-_modules_and_development/0_-_module_development_in_magento/custom_module_with_custom_database_table](http://www.magentocommerce.com/wiki/5_-_modules_and_development/0_-_module_development_in_magento/custom_module_with_custom_database_table)

[http://alanstorm.com](http://alanstorm.com)

Hope this helps someone else at some point.

Now it's onto adding a newsletter sign up option to my new form!

# c# - 这个功能有什么问题。无法返回字符串值

> ID：10404559
> 
> 赞同：0
> 
> 时间：2012-05-01T21:23:05.593
> 
> 标签：c#, function, return-value, sharepoint-api, elevated-privileges

```
public static string GetContentFromSPList(string cValueToFind)
{   
    string cValueFound = "";
    try
    {
        SPSecurity.RunWithElevatedPrivileges(delegate()
        {
            using (SPSite site = new SPSite("http://mysite"))
            {
                site.AllowUnsafeUpdates = true;
                using (SPWeb web = site.OpenWeb())
                {
                    web.AllowUnsafeUpdates = true;

                    SPList oListAbout = web.Lists["About"];
                    SPQuery oQuery = new SPQuery();

                    oQuery.Query = "<OrderBy><FieldRef Name='myField' /></OrderBy><Where><Eq><FieldRef Name='myField' /><Value Type='Choice'>" + cValueToFind + "</Value></Eq></Where>";

                    SPListItemCollection collListItems = oListAbout.GetItems(oQuery);

                    foreach (SPListItem oListItem in collListItems)
                    {
                        cValueFound = (oListItem["FieldContents"] != null ? oListItem["FieldContents"].ToString() : "");
                    }
                }
            }
            return cValueFound;
        });
        //return cValueFound;
    }
    catch (Exception ex)
    {
    }
    finally
    {
        //return cValueFound;
    }
} 
```

上面是一段代码。

问题是不允许返回字符串。它不断给出编译错误。我确定我做错了什么！

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T21:31:03.273

我**想**它是这样的：

“并非所有代码都返回值”。

如果是这样，只需添加

```
public static string GetContentFromSPList(string cValueToFind)
{   
       string cValueFound = "";
        try
        {
           //code
        }
        catch (Exception ex)
        {
        }
        finally
        {
           //some cleanup
        }

        return cValueFound ;
 } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T21:30:16.017

将其放在方法的底部，因为如果捕获到异常，您不会返回。

```
 catch (Exception ex)
    {
        return cValueFound;
    }
    finally
    {
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T21:32:04.163

您不能从`finally`,
(`control cannot leave the body from finally clause`或其他东西)返回

在 finally 之后或从 catch 移动返回

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-01T21:43:32.977

只需在 finally 块下方添加您的 return 语句。

不要返回尝试 blck。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-01T21:48:53.743

我已经看到开发人员错过了很多次。发生这种情况的原因是因为一旦定义了函数的返回类型，那么函数应该在所有退出点都有一个 return 语句。在这种情况下，函数应该有一个返回语句，一个在 try 块的末尾，一个在 catch 块内，或者就像 Tigran 定义的那样，在底部的右边。如果您不打算从 catch 块中返回任何内容，则只需返回 null；

```
public static string GetContentFromSPList(string cValueToFind)
{   
       string value= "";
        try
        {
           //code
return value;
        }
        catch (Exception ex)
        {
return null;
        }
        finally
        {
           //some cleanup
        }

 } 
```

# xcode - 升级到 4.3.2 后 xCode 长时间冻结

> ID：10404560
> 
> 赞同：1
> 
> 时间：2012-05-01T21:23:06.653
> 
> 标签：xcode, freeze

我发现问题仅出在“构建设置”选项卡上。所以我正在重写这篇文章......

如果我在项目导航器中选择项目，然后单击构建设置 xCode 与针轮挂起几分钟。在我最终进入构建设置之后，只要我选择了项目，鼠标的任何移动或单击都会使其再次挂起。我必须退出构建设置才能让事情恢复正常。

我曾尝试清理项目并最终卸载/重新安装 xCode。

我不知道这是否相关，但是自从升级到这个版本的 xCode 后，我已经有无数次漫长的等待时间来尝试构建或构建和运行这个应用程序。它表示它正在暂停索引。这不会一直发生，只会偶尔发生，通常是在第一次启动 xCode 时发生。

有什么建议么？

谢谢，

约翰

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T12:52:34.617

检查你的钥匙串。

我有完全相同的问题。我什至从我的系统中删除了 Xcode 并重新安装，但似乎没有任何帮助。不过，其他用户帐户没有问题。

我终于检查了我的钥匙串，并为我的 MobileMe 帐户找到了大量的钥匙。我最好的猜测是 iPhoto、Aperture 或其他应用程序无法连接到 MobileMe 服务器，并且每次尝试都存储了一个密钥。Endresult 是一个 12.1 MB 的 login.keychain 文件。我可以想象 Xcode 被这个大钥匙链窒息了。

删除了所有这些重复的密钥，我的 login.keychain 大约为 600KB（甚至可以放在一张软盘上 ;-)

我在构建设置上减慢 Xcode 4.3.3 的所有问题都消失了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T21:48:35.150

卸载，重新安装。这是我见过的最适合 Xcode 偶尔爆发的解决方案。

# google-app-engine - 查询没有父级的实体

> ID：10404561
> 
> 赞同：0
> 
> 时间：2012-05-01T21:23:11.813
> 
> 标签：google-app-engine, google-cloud-datastore, app-engine-ndb

我正在努力将应用程序从 db 转换为 ndb，并且正在努力提高我的查询效率。随着数据量的增加，应用程序变得有点慢，导致我们意识到查询效率很低。

**背景：**

我们的精简数据模型与此类似（请随意批评）：

```
class ServiceRequest(ndb.Model):
  technician = ndb.UserProperty()
  application = ndb.KeyProperty()  # ServiceRequestApplication kind

class ServiceRequestApplication(ndb.Model):
  applicant = ndb.UserProperty() 
```

管理员可以“批准” ServiceRequest 的 ServiceRequestApplication。ServiceRequestApplications 使用父 ServiceRequest 实例化。如果 ServiceRequestApplication 被批准，则应用程序的密钥存储在请求的应用程序属性中。

棘手的部分：

1 个实际服务预约（每位技术人员 1 个）可以有多个 ServiceRequest 实体。我们有一个 ServiceRequest，如果需要多种技术，我们会创建额外的 ServiceRequest，以主 ServiceRequest 作为父级。我们最初以这种方式解决问题是因为祖先查询非常容易，包括与查询/表示此数据的方式有关的其他一些原因。

谁能想到一种方法来查询*没有*子 ServiceRequest 的 ServiceRequest 实体？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T00:44:49.063

在主题中，您询问查询没有父母的实体；在正文中，您询问有关查询没有孩子的实体的问题。不过，无论哪种情况，答案都是相同的：标准 App Engine 索引无法做到这一点。前者需要搜索键中*不*存在的东西（这不可能是索引的结构方式），而后者需要连接，因为它根据其他实体的属性（或存在）选择实体。

相反，您需要进行非规范化：向 ServiceRequest 添加一个属性，以指示它是否是根实体，或者它是否有子实体，视情况而定。

# java - JAVA 中的网络爬虫。java.out.lang.outofmemory 无法创建本机线程

> ID：10404562
> 
> 赞同：0
> 
> 时间：2012-05-01T21:23:15.927
> 
> 标签：java, multithreading, web-crawler

我目前正在构建这个网络爬虫来获取起始网址的所有链接，并从这些链接中抓取所有链接等。我正在使用线程，所以每次进程完成时，都会调用一个新线程，我正在加载大约 1000 个线程，我使用了 thread.interrupt 函数，但它仍然没有删除线程并创建一个线程。我试图每次只使用一个线程或最多两个。我还注意到，一旦我运行了我的爬虫，我的互联网开始崩溃，这意味着网站在我打开我的网络爬虫之前不会加载。我想我发送了太多的 http 请求。如果有人知道如何限制线程或修复以下错误：

java.lang.outOfMemory : 无法创建本机线程

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T21:27:51.520

改用线程池并以这种方式限制它。也内置于 java 中。创建一个并将您的爬虫作业添加到其中以执行。

```
ExecutorService executor = Executors.newFixedThreadPool(100); 
```

然后： executor.execute(new LinkCrawler(...)); //在此处添加您的链接爬虫。

请参阅：[http](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/ExecutorService.html) ://docs.oracle.com/javase/6/docs/api/java/util/concurrent/ExecutorService.html 甚至包含与网络相关的示例。

# delphi - 尝试在标准用户上写入 HKLM 时如何不触发异常？

> ID：10404564
> 
> 赞同：5
> 
> 时间：2012-05-01T21:23:29.570
> 
> 标签：delphi, security, registry, uac

我正在*尝试*`TRegistry`使用Delphi中的组件将值写入 HKLM 注册表。

由于我作为标准用户在 Windows 2000 上运行（或作为标准用户的 XP，或作为标准用户的 Windows Vista，或带有标准用户的 Windows 7），我完全希望我将无法写入该`HKEY_LOCAL_MACHINE`部分注册表：

```
reg := TRegistry.Create(KEY_WRITE);
try
   reg.Access := KEY_WRITE; //sure, set it again, why not
   reg.RootKey := HKEY_LOCAL_MACHINE;
   if not reg.OpenKey('\Software\Microsoft\SQMClient', True) then
      Exit;

   reg.WriteString('MachineId', s);
finally
   reg.Free;
end; 
```

不幸的是，`WriteString`抛出一个`ERegistryException`：

```
Failed to set data for 'MachineId` 
```

这是完全可以预料的，这就是我试图避免异常的原因。我没有看到任何`CanWriteString`或`TryWriteString`在`TRegistry`.

尝试写入 HKLM 时如何*不触发异常？*

* * *

不言自明的注意事项：

*   如果用户实际上是管理员，那么写入应该能够成功
*   将调用包装`WriteString`在 try-except 中：

    ```
    reg := TRegistry.Create(KEY_WRITE);
    try
      reg.RootKey := HKEY_LOCAL_MACHINE;
      if not reg.OpenKey('\Software\Microsoft\SQMClient', True) then
         Exit;

      try
         reg.WriteString('MachineId', s);
      except
         on E:ERegistryException do
            {nothing};
      end;
    finally
      reg.Free;
    end; 
    ```

    不会阻止首先抛出异常。

**更新**：来自 RTL 来源：

```
KEY_WRITE          = (STANDARD_RIGHTS_WRITE or
                        KEY_SET_VALUE or
                        KEY_CREATE_SUB_KEY) and not
                        SYNCHRONIZE; 
```

来自[MSDN](http://msdn.microsoft.com/en-us/library/windows/desktop/ms724878%28v=vs.85%29.aspx)：

> ```
> KEY_WRITE (0x20006) 
> ```
> 
> 结合了 STANDARD_RIGHTS_WRITE、KEY_SET_VALUE 和 KEY_CREATE_SUB_KEY 访问权限。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T22:13:01.050

你无法`TRegistry`按照你想要的方式行事。没有`TryXXX`方法，也没有禁用异常的参数。您可以确定确实如此，因为这些`TRegistry`方法不提供任何错误或状态代码。

您必须围绕 Win32 注册表 API 编写自己的包装器。

顺便说一句，我同意您在评论中表达的观点，即`TRegistry`这里缺乏功能。我们预计注册表操作会失败，因此我们不必捕获异常来处理它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T22:51:26.433

在打开密钥时使用`KEY_SET_VALUE`而不是，因为其中包含其他权限。成功的事实意味着您的标准用户帐户具有其中一些权限，因此允许打开密钥，但在您执行此操作之前，密钥不知道您将如何使用它，因此它实际上无法验证如果您不使用它们，请预先设置所有权限。如果您只是使用（这是您的示例中真正需要的），如果您的用户帐户没有任何权限将数据写入密钥，则更有可能立即失败。在访问安全资源时，始终只请求您实际需要的最低权限。`KEY_WRITE``KEY_WRITE``OpenKey()``KEY_SET_VALUE``OpenKey()`

# c++ - 如何复制文件并继承 Windows EFS？

> ID：10404572
> 
> 赞同：3
> 
> 时间：2012-05-01T21:23:43.940
> 
> 标签：c++, c, windows, permissions, encrypting-file-system

我有一个程序，我在 %USERPROFILE%\AppData\Local\Temp 中创建了一个临时文件，然后我调用 rename.c 的 _wrename() 函数来有效地将该文件移动到使用 Windows 的 EFS 加密的目录中。问题是该文件没有继承该目录的加密设置。有什么办法可以克服这个问题（顺便说一句，我不想​​加密 Temp 文件夹）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T21:30:19.933

我相信您想使用 Win32 函数而不是 C 函数。我不确定是否`MoveFileEx`会做你想做的事。 `CopyFileEx`可用于执行此操作，然后可以删除原始文件。 `CopyFileEx`如果在目的地无法加密，甚至有允许它失败/不失败的标志。

# c# - 实时多用户交互

> ID：10404573
> 
> 赞同：0
> 
> 时间：2012-05-01T21:23:46.567
> 
> 标签：c#, networking, p2p

我正在制作的程序需要通过互联网使用实时跨计算机交互。

我遇到的问题是，虽然我希望客户端连接到主机客户端而不是使用客户端服务器模型，但在让主机客户端能够实际托管方面存在很多问题（接受传入的连接等）

我正在尝试使托管会话的过程尽可能简单，以便没有网络知识的用户可以接受传入连接，而无需配置他们的路由器或任何其他类似的东西。我想知道我怎么能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T22:58:17.037

听起来您想以编程方式更新防火墙规则，考虑到网络设置的变化，不可能有一种万能的方法。我认为您有三个选择，最后一个可能更好：

1) [http://en.wikipedia.org/wiki/Internet_Gateway_Device_Protocol](http://en.wikipedia.org/wiki/Internet_Gateway_Device_Protocol)
2) [http://en.wikipedia.org/wiki/Tunneling_protocol](http://en.wikipedia.org/wiki/Tunneling_protocol)
3) 用户配置路由器的说明（需要作为用户的备份前两个失败的是谁）

# dynamics-crm-2011 - 使用选项集类型的字段创建新实体

> ID：10404574
> 
> 赞同：2
> 
> 时间：2012-05-01T21:23:50.870
> 
> 标签：dynamics-crm-2011

我有一个 html 表单，它发布到一个使用 SOAP Web 服务连接到 CRM 的 aspx 页面。页面背后的代码在 CRM 中创建了一个实体。我在后面的代码中使用 IOrganizationService。

代码看起来像

```
IOrganizationService service = (IOrganizationService)serviceProxy;                       
Entity lead = new Entity("lead");
string fieldValue = string.Empty;

foreach (string key in Request.Form.AllKeys)
{
    if (key.Equals(SubmitKey, StringComparison.InvariantCultureIgnoreCase) == false &&
        key.Equals(CRMHostKey, StringComparison.InvariantCultureIgnoreCase) == false &&
        key.Equals(redirectErrorURLKey, StringComparison.InvariantCultureIgnoreCase) == false && 
        key.Equals(redirectSuccessURLKey, StringComparison.InvariantCultureIgnoreCase) == false)
    {
        if (!string.IsNullOrEmpty(Request.Form[key]))
        {
            fieldValue = Request.Form[key].Trim();
        }
        else
        {
            fieldValue = string.Empty;
        }

        if (key.Equals("new_contacttypechoices", StringComparison.InvariantCultureIgnoreCase))
        {
            lead[key] = new KeyValuePair<string, int>("Email", 100000000);
            //OptionMetadata objOM = GetOptionMetadata("lead", "new_contacttypechoices", fieldValue, service);
            //lead[key] = objOM;
            //lead[key] = 100000000; //Incorrect attribute value type System.Int32
            //lead[key] = fieldValue; //Incorrect attribute value type System.String
        }
        else
        {
            lead[key] = fieldValue;
        }
    }
    newLeadID = service.Create(lead);
} 
```

字段截图![在此处输入图像描述](../Images/74377d29d7a7daa6face167d0dd927c2.png)

我尝试时遇到错误

```
lead[key] = fieldValue 
```

我尝试时遇到错误

```
lead[key] = 100000000 
```

我尝试时遇到错误

```
lead[key] = new KeyValuePair<string, int>("Email", 100000000); 
```

获取 OptionMetaData 并将其设置为实体时出现错误。关于如何使用选项集创建实体的任何想法？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T22:53:11.750

取决于您遇到的错误，但如果 lead 是 type `Microsoft.Xrm.Sdk.Entity`，则可能是您需要替换现有值或添加新值。

```
if (lead.Attributes.Contains(key))
{
    lead[key] = new OptionSetValue(100000000);        
}
else 
{
    lead.Attributes.Add(key, new OptionSetValue(100000000));        
} 
```

重读我注意到您已经（大概）在评论中放置了错误。在这种情况下，我建议问题是您需要分配一个类型的值`[OptionSetValue](http://msdn.microsoft.com/en-us/library/microsoft.xrm.sdk.optionsetvalue_members.aspx)`

# mysql - 从表中选择（关键字）

> ID：10404576
> 
> 赞同：2
> 
> 时间：2012-05-01T21:23:55.410
> 
> 标签：mysql, select

我有一张表，其中包含有关钓鱼地点的信息。我有一个专栏叫物种。其内容可能类似于：

```
Brown & Rainbow Trout, Pike 
```

我如何编写一份声明来显示所有在物种栏中有“梭子鱼”的渔业？就像是：

```
SELECT species from table WHERE species='Pike' 
```

当然，这种说法是行不通的，因为该物种列包含的不仅仅是“派克”

有什么建议么？无需为每个物种创建列。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-01T21:26:26.833

尝试使用`LIKE`. (`%`表示匹配 0 个或多个字符，`_`表示匹配一个字符。)

```
SELECT species from table WHERE species LIKE '%Pike%' 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-01T21:26:19.737

```
SELECT species from table WHERE species like '%pike%' 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-01T21:27:09.773

在下面的子句中使用`LIKE`而不是允许您匹配所有包含“派克”的值。这是一个通配符搜索。`=``WHERE``species`

```
SELECT species
FROM yourTable
WHERE species LIKE '%Pike%' 
```

# php - php 中的分页 $_GET['page']

> ID：10404577
> 
> 赞同：0
> 
> 时间：2012-05-01T21:23:56.513
> 
> 标签：php

我有一个分页问题。当我在浏览器中加载此页面并单击类别链接以显示我的产品时，第一页显示的产品有限，并且分页链接已到位，但它不断将我发送到第一页，对于任何分页链接都是零我点击。但奇怪的是当我改变

```
$offset=($pageNum - 1) * $perPage; 
```

至

```
$offset=($pageNum)= $perPage; 
```

如果在单击类别后显示我要显示的其余产品。所以问题可能出在页面或附近的某个地方。

这是我的代码。

```
<?php
$productUlList="";
error_reporting (E_ALL ^ E_NOTICE);
include_once "convenientglobal2localhost.php";
$result = mysql_query("SELECT * FROM category WHERE 1")or die(mysql_error());

while($rowp=mysql_fetch_array($result)){
    $categoryId=$rowp['catId'];
    $categoryName=$rowp['catName'];
 $productUlList.='
    <ul id="ul" >
        <li id="lists"> <a href="'.$_SERVER['PHP_SELF'].'?category='.$categoryName.'"> '.$categoryName.'   </a> </li> 
    </ul>';
}
?>
<?php
$msg_to_user3='';

$productList.='';
$categoryList='';
include_once "convenientglobal2localhost.php";
 $perPage= 3;
if(isset($_GET['category']))

$categoryNames=$_GET['category'];
$pageNum=(isset($_GET['page']))? (int)$_GET['page']: 1;
$pages_query= mysql_query("SELECT * FROM products INNER JOIN category ON categoryName=catName WHERE categoryName='$categoryNames'");
$numrows= mysql_num_rows($pages_query);
 $maxpages=ceil($numrows / $perPage);
 $offset=($pageNum-1) * $perPage;
if ($offset < 0)
 {
 $offset = 0 ;
 }

include_once "convenientglobal2localhost.php";
$results = mysql_query("SELECT * FROM products WHERE categoryName='$categoryNames' LIMIT $offset, $perPage")or die(mysql_error());
$num=mysql_num_rows($results);

if($num > 0){

while($row=mysql_fetch_array($results)){

 $productId=$row['productId'];
 $productName=$row['name'];
 $productDescription=$row['description'];
 $productPrice=$row['price'];
 $productDiscountedPrice=$row['discountedPrice'];
 $productStock=$row['stock'];
 $productCategory=$row['categoryName'];
 $categoryId=$row['catId'];
 $catName=$row['catName'];

 $categoryList='<table><th id="toptable"></th></table>
 <table id="categorytable">
 <th><img src="inventory_category_images/' . $categoryId . '.jpg" width="498px"; height="125px";/></th> 
</table>';
 $productList.='<table id="productoutputtable">
 <tr>
 <td rowspan="7" valign="top"><img style="border-style=solid; border-color:#767475; padding=; "src="inventory_images/' . $productId . '.jpg" width="150" height="135"/>
    </td> 
    </tr>
    <tr> 
    <td id="tablecolor" ><strong>Product</strong></td> 
    <td colspan="2">' . $productName . ' </td> 
    <td id="tablecolor"><strong>Category</strong></td> 
    <td>' . $productCategory . ' </td> 
    </tr>
     <tr> 
    <td id="tablecolor"><strong>Description:</strong></td> 
     <td colspan="3">' . $productDescription . ' </td> 
    </tr> 
    <tr> 
    <td id="tablecolor" ><strong>Price:</strong></td> 
     <td>$' . $productPrice . ' </td>
     </tr><tr>
     <td id="tablecolor"colspan="1"><strong>Sale Price:</strong></td> 
    <td>$' . $productDiscountedPrice . ' </td> 
    <td id="tablecolor"colspan="2"><strong>In Stock </strong></td> 
    <td>' . $productStock . ' </td> 
    </tr>
    </table>';

}   

$self= $_SERVER['PHP_SELF'];
 for($page=1; $page<=$maxpages; $page++){
    if($page == $pageNum){
        $nav= "$page";
    }
    else{
        $nav= "<a href=\"$self?page=$page\">$page</a>";
    }
 }

 if($page > 1)
 {
    $page=$pageNum-1;
    $prev ="<a href=\"$self?page=$page\">[Prev]</a>";
    $first="<a href=\"$self?page=1\">[First Page]</a>";
 }
 else
 {
    $prev= "&nbsp";
    $first="&nbsp";
 }
 if($pageNum < $maxPages)
 {
    $page=$pageNum+1;
    $next ="<a href=\"$self?page=$page\">[Next]</a>";
    $last="<a href=\"$self?page=$maxPages\">[Last Page]</a>";
 }
 else
 {
    $next= "&nbsp";
    $last="&nbsp";
 }
$pageList.= $first. $prev. $nav. $next. $last;

 } 
else{
    $msg_to_user3="You have no products listed.";

}
//$pageList.=""; 
//for($i = 0 ; $i <= $maxpages ; $i++) { 
//if($i == $page) { 
//$pageList.= "<B>$i</B>"; 
//}else{ 
//$pageList.= '<A HREF="?page='.$i.'">'.$i.'</A>';
//
//} 
//}
?> 
```

谢谢大家的帮助！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T21:53:52.443

我会忽略效率低下的地方（请参阅对您问题的评论）。问题不在于你的抵消代码——它工作得很好。您的链接已损坏。

将编号链接生成到`$nav`中时，您需要附加，而不是覆盖。使用`.=`，不使用`=`。另外，注意大小写。`$maxpages`不是`$maxPages`。

这是更新的代码。[证明这行得通](http://designbynikhil.com/pagination.php)。除非您的数据库查询构造错误（我无法测试，抱歉！），否则您应该很高兴。

```
$self= $_SERVER['PHP_SELF'];
 for($page=1; $page<=$maxpages; $page++){
    if($page == $pageNum){
        $nav.= "$page";
    }
    else{
        $nav.= "<a href=\"$self?page=$page\">$page</a>";
    }
 }

 if($page > 1)
 {
    $page=$pageNum-1;
    $prev ="<a href=\"$self?page=$page\">[Prev]</a>";
    $first="<a href=\"$self?page=1\">[First Page]</a>";
 }
 else
 {
    $prev= "&nbsp";
    $first="&nbsp";
 }
 if($pageNum < $maxpages)
 {
    $page=$pageNum+1;
    $next ="<a href=\"$self?page=$page\">[Next]</a>";
    $last="<a href=\"$self?page=$maxpages\">[Last Page]</a>";
 }
 else
 {
    $next= "&nbsp";
    $last="&nbsp";
 }
$pageList.= $first. $prev. $nav. $next. $last; 
```

# visual-studio-2010 - Visual Studio 无法打开 mdf 文件

> ID：10404579
> 
> 赞同：1
> 
> 时间：2012-05-01T21:24:09.437
> 
> 标签：visual-studio-2010, sql-server-2008

我遇到的问题是我无法在 Visual Studio 2010 中打开我的 mdf 文件。我之前安装了 VS2010，但几天前才安装了 SQL Server 2008 R2。我在 VS2010 中创建了文件，然后将其附加到 Management Studio 中的 SQL 服务器以运行我必须创建所有表等的脚本。然后我在 Management Studio 中分离它并尝试在 VS2010 中查看它并得到一个错误，告诉我我无法打开数据库版本 661。我只能达到 655。我知道这是因为 VS2010 使用的是 SQL Server 2008，但是Management Studio 是 SQL Server 2008 R2。

如何使 VS2010 与 SQL Server 2008 R2 兼容？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T20:42:54.803

我也有这个问题，但是当我这样做时我的问题得到了解决：

当您打开 SQL Server Managemnt Studio 时，在连接到服务器窗口中，在服务器名称（您的服务器名称\SQLEXPRESS）之后键入“\SQLEXPRESS”，然后附加您的数据库。当你分离它时，它与 VS2010 兼容。我希望这可以帮助你。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T21:40:23.063

您只需将本地版本 2008 Express 升级到 R2。之后你就可以打开你的文件了。

# ios - Core Data后台线程不更新记录

> ID：10404581
> 
> 赞同：1
> 
> 时间：2012-05-01T21:24:15.290
> 
> 标签：ios, core-data, grand-central-dispatch

我在后台 GCD 线程中遇到核心数据问题...我想更新一条记录，但在获取它并设置值之后，它似乎并没有真正保存更新的记录。

`isUpdate`是我设置的 BOOL，它告诉我是否正在运行第一次解析/保存，或者它是否是我需要更新的记录。就我而言，当我更新一条记录时，它实际上似乎并没有在我的商店中更新。

我正在使用 MagicalRecord 助手。这是我的代码：

```
// Create background context
NSManagedObjectContext *backgroundContext = [[NSManagedObjectContext alloc] init];
[backgroundContext setPersistentStoreCoordinator:[NSPersistentStoreCoordinator defaultStoreCoordinator]];
// Save the background context and handle the save notification
[[NSNotificationCenter defaultCenter] addObserver:self
                                         selector:@selector(backgroundContextDidSave:)
                                             name:NSManagedObjectContextDidSaveNotification
                                           object:backgroundContext];

// Parsing data...
//..

Record *record;
if (!isUpdate) {
    record = [NSEntityDescription insertNewObjectForEntityForName:@"Record" inManagedObjectContext:backgroundContext];
} else {
    NSPredicate *recordPredicate = [NSPredicate predicateWithFormat:@"SELF.tag == %@", [[node attributeForName:@"tag"] stringValue]];
    record = [Record findFirstWithPredicate:recordPredicate];
}
[record setTitle:[[recordNode attributeForName:@"title"] stringValue]];

// Parsing other data...
//..

NSError *error = nil;
// save the context
[backgroundContext save:&error];
if (error) {
    NSLog(@"An error occurred: %@", error);
} 
```

这是通知：

```
- (void)backgroundContextDidSave:(NSNotification *)notification {
    // Make sure we're on the main thread when updating the main context
    if (![NSThread isMainThread]) {
        [self performSelectorOnMainThread:@selector(backgroundContextDidSave:)
                           withObject:notification
                        waitUntilDone:NO];
        return;
    }
    // merge in the changes to the main context on the main thread
    [[NSManagedObjectContext defaultContext] mergeChangesFromContextDidSaveNotification:notification];
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T22:36:54.990

你的代码对我来说听起来很奇怪。

为什么要`NSManagedObjectContextDidSaveNotification`在后台线程中注册通知？也许我错了，但您需要在应用程序的不同位置注册该通知。

如果你想让它工作，你可以在主线程中注册该通知。例如，您可以在`AppDelegate`.

例如在`didFinishLaunchingWithOptions:`你可以做的方法中

```
[[NSNotificationCenter defaultCenter] addObserver:self
                                         selector:@selector(backgroundContextDidSave:)
                                             name:NSManagedObjectContextDidSaveNotification
                                           object:backgroundContext]; 
```

然后，始终在 中`AppDelegate`，您可以将更改与您编写的方法合并：

```
- (void)backgroundContextDidSave:(NSNotification *)notification {
    // Make sure we're on the main thread when updating the main context
    if (![NSThread isMainThread]) {
        [self performSelectorOnMainThread:@selector(backgroundContextDidSave:)
                           withObject:notification
                        waitUntilDone:YES];
        return;
    }
    // merge in the changes to the main context on the main thread
    [[NSManagedObjectContext defaultContext] mergeChangesFromContextDidSaveNotification:notification];
} 
```

代码执行以下步骤：

1.  首先检查您是否在主线程中运行。
2.  由于您注册的通知可能来自与主线程不同的线程，因此您需要在主线程上执行选择器。
3.  最后与包含您在后台所做的更改的通知执行合并。

完成后，您可以看到主上下文已更新为在另一个上下文中所做的更改。

**编辑**

也许您也可以尝试将其更改`waitUntilDone`为 YES。

希望能帮助到你。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T14:06:07.640

您正在混合两种情况。这段代码可能很糟糕：

```
 record = [Record findFirstWithPredicate:recordPredicate]; 
```

我假设这会在不同的上下文而不是你的背景上下文中找到记录。你应该把它改成这样：

```
 record = [Record findFirstWithPredicate:recordPredicate inManagedObjectContext:backgroundContext]; 
```

# php - PHP 错误导致空白页（错误报告工作正常）

> ID：10404583
> 
> 赞同：0
> 
> 时间：2012-05-01T21:24:33.727
> 
> 标签：php, adodb, suphp, server-migration

**这个问题已经回答（见下面的问题）**

**原始问题：** 我建立了一个可以正常工作且没有问题的网站。然后我们开始从基于 VPS 的服务器迁移到真正的专用服务器。在这样做的同时，我们的托管公司将我们从 CentOS 4 升级到 CentOS 6，从 PHP 5.2.9 升级到 PHP 5.3，并将我们从 DSO 切换到 SuPHP。现在新服务器导致了我们以前没有的错误。我们的一个页面显示为空白，我已将其缩小到一行代码（第 26 行）。

```
1\.  class directoryByLetterReverse{
2\.      private $da=0;
3\.      public $category;
4\.      public $letter;
5\.      public $listing;
6\.      function __construct($letter,$category,$conn){
7\.          $this->letter=$letter;
8\.          $this->category=$category;
9\.          $recordSet=&$conn->Execute('SELECT members.Member_ID AS MemberID, companies.CompanyName AS CompanyName, members.IPAddress AS IPAddress, directory_table.dir_id, members.BusinessType_ID, members.MemberType FROM members Inner Join companies ON companies.Company_ID = members.Company_ID Left Join directory_table ON directory_table.member_id = members.Member_ID WHERE companies.CompanyName LIKE "'.$this->letter.'%" AND members.BusinessType_ID LIKE "'.$this->category.'" AND members.published="1" ORDER BY directory_table.dir_id DESC, members.Member_ID DESC;');
10\.         if(!$recordSet){
11\.             print $conn->ErrorMsg();
12\.         } else {
13\.             $this->listing[0]['memberid']=''.$recordSet->fields[0].'';
14\.             $this->listing[0]['companyname']=''.$recordSet->fields[1].'';
15\.             $this->listing[0]['ipaddress']=''.$recordSet->fields[2].'';
16\.             $this->listing[0]['dirid']=''.$recordSet->fields[3].'';
17\.             $this->listing[0]['typeid']=''.$recordSet->fields[4].'';
18\.             $this->listing[0]['memtype']=''.$recordSet->fields[5].'';
19\.             while($array=$recordSet->FetchRow()){
20\.                 $this->da++;
21\.                 $this->listing[$this->da]['memberid']=''.$recordSet->fields[0].'';
22\.                 $this->listing[$this->da]['companyname']=''.$recordSet->fields[1].'';
23\.                 $this->listing[$this->da]['ipaddress']=''.$recordSet->fields[2].'';
24\.                 $this->listing[$this->da]['dirid']=''.$recordSet->fields[3].'';
25\.                 $this->listing[$this->da]['typeid']=''.$recordSet->fields[4].'';
26\.                 $this->listing[$this->da]['memtype']=''.$recordSet->fields[5].'';   < - - - - this line right here is what is causing the problem
27\.             };
28\.         };
29\.     }
30\.     function returnSingle($j){
31\.         return $this->listing[$j]['memberid'].' '.$this->listing[$j]['companyname'].' '.$this->listing[$j]['ipaddress'].' '.$this->listing[$j]['dirid'];
32\.     }
33\. } 
```

在我的一生中，我找不到第 26 行有任何问题，但如果我把它留在那里，我会得到一个空白页，如果我将其注释掉，一切正常（直到你转到引用它但我期望的页面被打破）。

另外，请注意，我正在使用 ADOdb 数据库抽象库 (http://adodb.sourceforge.net/) 进行 MySQL 交互。

**事实证明，代码没有任何问题，测试服务器只是性能有限，无法处理未缓存页面加载的负载。感谢您的评论，因为它们让我朝着正确的方向思考以找到我需要的东西。**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T21:28:57.650

并且没有“;” 第 27 和 28 行的，仍然不起作用？

# javascript - 弹出编码以避免浏览器阻塞

> ID：10404584
> 
> 赞同：0
> 
> 时间：2012-05-01T21:24:44.590
> 
> 标签：javascript, jquery, popup

我需要使用大量弹出窗口来为用户感兴趣的项目提供更多详细信息。

问题是浏览器阻止这些弹出窗口的时间百分比。

我需要找到一种方法来做两件事中的一个或两个：

1.  找到一种方法来显示像灯箱一样不会被浏览器阻止而不会大大阻碍页面加载时间的弹出窗口
2.  提供 JavaScript / JQuery 警报，可以检测弹出窗口何时被浏览器阻止，并通过警报以及我编写的自定义消息通知用户

任何熟悉一些 JavaScript 编码的人都可以做到这一点，或者灯箱是否是一种实用的解决方案，不会影响页面加载时间。给定页面上可能有 10-30 个不同的弹出窗口。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T21:27:43.240

如今，许多想要显示“弹出”信息的网站选择只在同一浏览器窗口中显示覆盖 div，而不打开单独的窗口。在同一窗口中使用覆盖可以完全避免弹出窗口阻止程序，因为没有打开新窗口，因此您的内容永远不会被阻止。

由于现在几乎所有的浏览器都配置了某种默认的弹出窗口阻止功能，因此您无法很好地检测弹出窗口阻止并告诉用户一些事情。那时，您的网站无法使用用户浏览器的默认配置，尝试让他们更改浏览器的配置也不是正确的做法。相反，您需要更改站点的工作方式以兼容弹出窗口阻止（可能通过不使用弹出窗口）。

# delphi - 尝试将 TBitmaps 写入 AVI 文件并仅获取黑帧（全零数据）

> ID：10404586
> 
> 赞同：2
> 
> 时间：2012-05-01T21:25:07.797
> 
> 标签：delphi, bitmap, getdibits, tbitmap, createdibsection

我有一个 Delphi 应用程序，它从文件中读取 JPEG 帧并将它们写入 AVI 文件。每个 JPEG 帧都被解码为一个 TBitmap 对象，然后使用由用于 AVI 操作的 Windows API DLL (AVIFIL32.DLL) 提供的服务，通过 Delphi 6 VFW.PAS 单元写入一个输出 AVI 文件。

问题是我最终在输出文件中出现了所有黑框。我知道在调用 AVIStreamWrite() 之前用作源的 TBitmaps 具有有效数据，因为我已使用 TBitmap.SaveToFile() 方法将它们写入磁盘并且源图像看起来很好。但我仍然以黑框结束。我从 TBitmap 获取位的方式有问题，因为如果我检查它指向的内存区域，GetDIBBits() 返回的指针显示所有零。

下面是我的代码。我究竟做错了什么？此外，如果我尝试释放 CreateDIBSection() 返回的第一个 pBits，我会遇到访问冲突。这是正常的还是有一些适当的方法可以释放它？

```
// aryBytes contains a JPEG frame as a Byte array.

/*
    Gets the next JPEG frame from a video input file and writes it to
    the output AVI file (stream).

    If the HRESULT from the desired operation is a failure code a
    formatted Exception will be raised.
*/
procedure makeAviCallWithJPEGFrame(
                fullVideoInFilename: string;
                const aryBytes: TDynamicByteArray;
                theAviMaker: TAviWriterWithCompression);
var
    hr: HRESULT;
    bmi: TBitmapInfo;
    pImg: PJpegDecode;
    jpegDecodeErr: TJpegDecodeError;
    hbm: HBITMAP;
    pBits, pBits2: Pointer;
    theBitmap: Graphics.TBitmap;
    iNumScanLinesCopied: integer;
    numBytesInBitmap: Integer;
begin
    if not Assigned(theAviMaker) then
        raise Exception.Create('(makeAviCallWithJPEGFrame) The AVI maker is unassigned.');

    pImg        := nil;
    pBits       := nil;
    pBits2      := nil;
    hbm         := 0;
    theBitmap   := nil;

    try
        jpegDecodeErr := JpegDecode(@aryBytes[0], Length(aryBytes), pImg);

        if jpegDecodeErr <> JPEG_SUCCESS then
            raise Exception.Create('(makeAviCallWithJPEGFrame) The bitmap failed to decode with error code: ' + IntToStr(Ord(jpegDecodeErr)));

        // Get the DIB bits.
        // theBitmap.SaveToFile('c:\temp\robomoviemaker.bmp');

        if not Assigned(pImg) then
            raise Exception.Create('(makeAviCallWithJPEGFrame) The bitmap decoded from the first JPEG frame in the video file is unassigned: ' + fullVideoInFilename);

        pImg^.ToBMI(bmi);

        theBitmap := pImg.ToBitmap;
//  This always shows a valid image so I know the bitmap contains image data.
// theBitmap.SaveToFile('c:\temp\test-bitmap.bmp');
        // Now create a DIB section.
        hbm := CreateDIBSection(theBitmap.Handle, bmi, DIB_RGB_COLORS, pBits, 0, 0);

        if hbm = ERROR_INVALID_PARAMETER then
            raise Exception.Create('(makeAviCallWithJPEGFrame) One of the parameters passed to CreateDIBSection is invalid.');

        if hbm = 0 then
            raise Exception.Create('(makeAviCallWithJPEGFrame) The call to CreateDIBSection failed.');

        // Height may be negative to indicate orientation so we
        //  take the absolute value of it.

        // Allocate memory to receive the bits.
        numBytesInBitmap :=
            Abs(bmi.bmiHeader.biHeight)
            * Abs(bmi.bmiHeader.biWidth)
            * bmi.bmiHeader.biBitCount;

        numBytesInBitmap := numBytesInBitmap div 8;

        pBits2 := AllocMem(numBytesInBitmap);

        if not Assigned(pBits2) then
            hr := LongInt(AVIERR_MEMORY)
        else
        begin
            // Get the DIB bits first.
            iNumScanLinesCopied :=
            // hr :=
                GetDIBits(
                    theBitmap.Canvas.Handle,
                    theBitmap.Handle,
                    0,
                    Abs(bmi.bmiHeader.biHeight),
                    pBits2,
                    bmi, // @pVidInfoHdr.bmiHeader^,
                    DIB_RGB_COLORS);

            if iNumScanLinesCopied <= 0 then
                // Flag it as internal error.
                hr := LongInt(AVIERR_INTERNAL)
            else
                // Add the bitmap to the output AVI file.
                hr := theAviMaker.addVideoFrame(hbm);
        end; // if not Assigned(pBits2) then

        checkAviResult('TfrmMain_moviemaker_.cmdTestClick', hr, 'Error during add video frame call');
    finally
        if Assigned(pBits2) then
            FreeMem(pBits2);

        if Assigned(pImg) then
        begin
            pImg^.Free;
            pImg := nil;
        end;

        if Assigned(theBitmap) then
            FreeAndNil(theBitmap);

        if hbm > 0 then
            DeleteObject(hbm);
    end; // try (2)
end;

// --------------------------------------------------------------- 
```

# optimization - 如何使用 ocamllex 和 ocamlyacc 编写三地址代码？

> ID：10404588
> 
> 赞同：0
> 
> 时间：2012-05-01T21:25:18.687
> 
> 标签：optimization, compiler-construction, ocaml, ocamlyacc, ocamllex

我想知道如何使用 ocamllex 和 ocamlyacc 编写三地址代码？我用谷歌搜索了很多关于这个，但我找不到任何使用 ocamlyacc 的东西。我的解析器和词法分析器都在工作（当然都使用 ocamlyacc 和 ocamllex），但现在我必须使用它们编写一个三地址代码生成器。例如，假设我有这个解析器（计算器）：

三地址码应该怎么写？

解析器：

```
input: /* empty */ { }
    | input line { }
;

line: NEWLINE { }
    | exp NEWLINE { }

;

exp: NUM { }
    | exp PLUS exp  { }
    | exp MINUS exp { }
    | exp MULTIPLY exp { }
    | exp DIVIDE exp { }
    | MINUS exp %prec NEG { }

    | exp CARET exp { }

    | LPAREN exp RPAREN { }
; 
```

例子：

输入：

5+(5*7)

三地址码输出：

t1 = 5*7

t2 = 5+t1

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T13:15:13.490

这是一个解决方案：

您首先必须将其添加到您的 mly 文件的标题中：

```
%{  
  let count = ref 0

  let tn () = "t" ^ (string_of_int !count)

  let print_operation op x1 x2 =
    incr count;
    print_endline ((tn ()) ^ " = "^ x1 ^ op ^ x2)
%} 
```

然后，您的规则将如下所示（我删除了第二条规则和一元减号以简化）：

```
input: EOF {}
    | exp NEWLINE input { }
;

exp: NUM { $1 }
    | exp PLUS exp  { print_operation " + "$1 $3; tn () }
    | exp MINUS exp { print_operation " - " $1 $3; tn () }
    | exp MULTIPLY exp { print_operation " * " $1 $3; tn () }
    | exp DIVIDE exp { print_operation " / " $1 $3; tn () }
    | exp CARET exp { print_operation " ^ " $1 $3; tn () }
    | LPAREN exp RPAREN { $2 }
; 
```

# ruby-on-rails - 将黄瓜翻译成 rspec

> ID：10404594
> 
> 赞同：1
> 
> 时间：2012-05-01T21:25:41.427
> 
> 标签：ruby-on-rails, testing, rspec, cucumber

如何在 rspec 中编写以下功能？

> 特点：登录；为了以用户身份使用该网站，我希望能够登录
> 
> ```
>  Scenario: Signing in via confirmation
>     Given there are the following users:
>       |email            |password|
>       |user@example.com |password|
>     And "user@example.com" opens the mail with subject
>       "Confirmation instructions"
>     And they click the first link in the email
>     Then I should see "Your account was successfully confirmed"
>     And I should see "Signed in as user@example.com" 
> ```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T12:49:06.977

*这看起来像是Rails 3 in Action*第一版中的功能，我目前正在将其重新编写到第二版中。第二版的特点是这样的：

```
feature 'Signing in' do
  before do
    Factory(:user, :email => "ticketee@example.com")
  end

  scenario 'Signing in via confirmation' do
    open_email "ticketee@example.com", :with_subject => /Confirmation/
    click_first_link_in_email
    page.should have_content("Your account was successfully confirmed")
    page.should have_content("Signed in as ticketee@example.com")
  end
end 
```

这是使用 Capybara 的新功能语法，其所有意图和目的都与 RSpec 的`context`块相同。通过使用`before`，您可以设置一个可以在此功能中使用的用户。在场景中，您使用该`open_email`方法（由 email_spec gem 提供）打开电子邮件，并且该`click_first_link_in_email`gem 提供的方法也执行这两个步骤。

然后将您带到一个页面，您应该能够根据需要查看这两条消息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T22:24:53.963

试试[萝卜](https://github.com/jnicklas/turnip)宝石。

> Turnip 是 RSpec 的 Gherkin 扩展。它允许您在 Gherkin 中编写测试并在您的 RSpec 环境中运行它们。基本上你可以在 RSpec 中编写黄瓜特性。

# ftp - Unable to make FTP connection

> ID：10404599
> 
> 赞同：0
> 
> 时间：2012-05-01T21:25:49.803
> 
> 标签：ftp, connection

I'm trying to make an FTP connection to 3 web sites on the same server via a PHP script. It works fine for 2 of the sites, but the 3rd I get the following error (and it doesn't appear to be temporary):

"Warning: ftp_connect() [function.ftp-connect]: php_network_getaddresses: getaddrinfo failed: This is usually a temporary error during hostname resolution and means that the local server did not receive a response from an authoritative server"

This code snippet is where it fails:

```
$server = 'ftp.'.$ftp_server;
$conn_id = ftp_connect($server) OR die("<br>unable to establish an FTP connection"); 
```

I'm hoping someone can point me in the right direction.

Regards to all

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-01T21:28:21.303

That means the DNS lookup for the ftp server's name (e.g. `example.com`) failed to resolve and the IP address could not be determined.

This could either be from your remote site's DNS servers being down, or the domain itself is misconfigured and is pointing at non-existing/unreachable DNS servers.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T21:31:01.430

Perhaps the DNS servers for that specific host are down; check `whois` records for the domain to discover which DNS servers are authoritative, then check each one of them in turn with `host` to make sure they all resolve.

For example, `whois stackoverflow.com`:

```
Name Servers:
ns1.serverfault.com
ns2.serverfault.com
ns3.serverfault.com 
```

Then:

```
$ host www.stackoverflow.com ns1.serverfault.com
Using domain server:
Name: ns1.serverfault.com
Address: 64.34.119.33#53
Aliases: 

www.stackoverflow.com is an alias for stackoverflow.com.
stackoverflow.com has address 64.34.119.12
stackoverflow.com mail is handled by 10 STACKOVERFLOW.COM.S9A1.PSMTP.com.
stackoverflow.com mail is handled by 20 STACKOVERFLOW.COM.S9A2.PSMTP.com.
stackoverflow.com mail is handled by 30 STACKOVERFLOW.COM.S9B1.PSMTP.com.
stackoverflow.com mail is handled by 40 STACKOVERFLOW.COM.S9B2.PSMTP.com.
$ host www.stackoverflow.com ns2.serverfault.com
Using domain server:
Name: ns2.serverfault.com
Address: 64.34.119.34#53
Aliases: 

www.stackoverflow.com is an alias for stackoverflow.com.
stackoverflow.com has address 64.34.119.12
stackoverflow.com mail is handled by 30 STACKOVERFLOW.COM.S9B1.PSMTP.com.
stackoverflow.com mail is handled by 40 STACKOVERFLOW.COM.S9B2.PSMTP.com.
stackoverflow.com mail is handled by 10 STACKOVERFLOW.COM.S9A1.PSMTP.com.
stackoverflow.com mail is handled by 20 STACKOVERFLOW.COM.S9A2.PSMTP.com.
$ host www.stackoverflow.com ns3.serverfault.com
Using domain server:
Name: ns3.serverfault.com
Address: 69.59.196.217#53
Aliases: 

www.stackoverflow.com is an alias for stackoverflow.com.
stackoverflow.com has address 64.34.119.12
stackoverflow.com mail is handled by 30 STACKOVERFLOW.COM.S9B1.PSMTP.com.
stackoverflow.com mail is handled by 40 STACKOVERFLOW.COM.S9B2.PSMTP.com.
stackoverflow.com mail is handled by 10 STACKOVERFLOW.COM.S9A1.PSMTP.com.
stackoverflow.com mail is handled by 20 STACKOVERFLOW.COM.S9A2.PSMTP.com.
$ 
```

All three servers responded to requests for `www.stackoverflow.com`, so all three servers are functional.

# android - 设置 TimePickerDialog 的 AM/PM

> ID：10404609
> 
> 赞同：1
> 
> 时间：2012-05-01T21:26:32.450
> 
> 标签：android, datetime, dialog

除了第一次运行之外，使用`TimePickerDialog`一切似乎都正常工作时，它假定当前的 AM/PM 是 AM，即使它不是。

```
@Override
protected Dialog onCreateDialog(int id)
{
    switch (id)
    {
        case TIME_DIALOG:
            return new TimePickerDialog(this, timeSetter, hour, minute, false);
    }
    return null;
}

private TimePickerDialog.OnTimeSetListener timeSetter =  new TimePickerDialog.OnTimeSetListener()
{
    public void onTimeSet(TimePicker view, int cHour, int cMinute)
    {
        hour = cHour;
        minute = cMinute;
    }
}; 
```

一旦选择了时间，AM/PM 设置在连续运行时是正确的，但我不知道如何将其设置为正确的 AM/PM。帮助？

# facebook - 有没有办法将 Facebook Graph 数据与其他数据源（Freebase、DBPedia）链接起来？

> ID：10404611
> 
> 赞同：3
> 
> 时间：2012-05-01T21:26:56.123
> 
> 标签：facebook, semantic-web, freebase, mql

我有一组来自 Facebook 的兴趣和喜欢数据，我有兴趣使用来自其他来源（即 Freebase）的数据来丰富这些数据。有什么方法可以识别 Freebase 中的哪个条目与 Facebook Graph 中的给定条目对应？

首先，Facebook Graph 不提供任何指向外部资源的链接，因此似乎需要在外部资源中找到任何类型的关系。我发现，至少对于某些条目，Freebase 提供了一个“Facebook URL”，因此您可以通过一种迂回的方式将两者联系起来。例如，对于乐队“Taking Back Sunday”，这里是 Facebook Graph URL：

[https://graph.facebook.com/23854511408](https://graph.facebook.com/23854511408)

... 或者可以使用虚 URL：

[https://graph.facebook.com/TakingBackSunday](https://graph.facebook.com/TakingBackSunday)

现在在 Freebase 中，如果我查看 RDF 格式 (http://rdf.freebase.com/rdf/en.taking_back_sunday) 或 JSON 格式的 Take Back Sunday 条目，我可以看到 Facebook 虚荣 URL 的链接。假设 MQL 可以查询此属性，则可以通过此方法将 Freebase 链接到 Facebook Graph。然而问题是 Freebase 中的许多条目没有到 Facebook 的链接。

关于是否有一致的方法来发现这些联系有什么想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T23:52:44.710

如果您可以将 Facebook 图形数据转换为 RDF 格式，并且如果您对跨数据集连接特定类型的实体（例如波段）感兴趣，那么您可以使用[Silk 之](http://www4.wiwiss.fu-berlin.de/bizer/silk/)类的链接发现工具。您编写一个映射，告诉 Silk 如何比较名称、流派、家乡等，然后 Silk 将计算连接。不过，这需要相当多的努力。

另一种选择可能是使用[Google Refine](http://code.google.com/p/google-refine/)，它具有“协调”功能，可以发现与您的数据匹配的 Freebase 实体。挑战又是如何将 Facebook 数据输入 Google Refine。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-02T02:24:59.463

1.  从您的兴趣和喜欢列表中创建一个电子表格，其中包含名称和 FB 图 URI 列。
2.  将电子表格加载到[Google Refine](http://code.google.com/p/google-refine/wiki/Downloads)中。
3.  将名称列与 Freebase 协调一致[。](http://code.google.com/p/google-refine/wiki/Reconciliation)
4.  使用以下 GREL 代码根据您的协调名称列为 Freebase URI[创建一个新列：](http://code.google.com/p/google-refine/wiki/ColumnEditing#Adding_Columns)

    "http://rdf.freebase.com/ns/" + cell.recon.match.id[1,-1].replace("/", ".")

5.  将您的增强数据[导出到新的电子表格。](http://code.google.com/p/google-refine/wiki/Exporters)

# html - 如何让 Drupal 中的 FCKEditor 停止重新转义我的 HTML？

> ID：10404616
> 
> 赞同：0
> 
> 时间：2012-05-01T21:27:29.790
> 
> 标签：html, drupal, fckeditor, html-entities

我正在创建一个块并使用 FCKEditor 富文本输入框。我切换到 Source 模式并输入以下 HTML：

```
<img src="http://test.com/image.png" alt="an image" /> 
```

我检查以确认输入格式设置为“完整 HTML”，然后按保存。加载我的网站后，我发现 FCKEditor 的源视图中的 HTML 现在是：

```
<p><img alt="\&quot;an image" src="\&quot;http://test.com/image.png\&quot;" /></p> 
```

显然，这会阻止图像正确呈现，因为浏览器将图像的路径视为：

```
"http://test.com/image.png" 
```

有人知道如何提供帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T21:40:45.480

快速的解决方法可能是不使用引号，因为无论如何它似乎都在添加它们。例子：

```
<img src=http://site.com/image alt=alt text> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T23:13:46.587

您是否更改或选择了合适的文本格式？

如果您转到`admin/config/content/formats`，您可以更新甚至创建新的文本格式。

选择您当前正在使用的导致此问题的过滤器，并检查其中一个过滤器是否造成此问题。有些可能会影响或产生您遇到的问题。

*   “*纠正错误和截断的 HTML* ”过滤器
*   “*将 URL 转换为链接*”过滤器
*   “*限制允许的 HTML 标签*”过滤器

此外，检查 FCKEditor 的配置页面是否激活了任何自动更正过滤器。

无论如何，如果问题在于插入图像，我认为您最好使用专用模块，例如**IMCE** (http://drupal.org/project/imce)。

希望能帮助到你。

# mysql - MySQL 和时区

> ID：10404618
> 
> 赞同：1
> 
> 时间：2012-05-01T21:27:42.207
> 
> 标签：mysql, sql

假设下表：

```
CREATE TABLE IF NOT EXISTS `test` (
  `stamp` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP
) ENGINE=InnoDB DEFAULT CHARSET=latin1; 
```

当我运行以下 SQL 时：

```
SET time_zone = '+00:00';
INSERT INTO `test` (`stamp`) VALUES (CURRENT_TIMESTAMP); 
```

中的值`test`是我机器的本地时间而不是 UTC。

根据 MySQL[网站](http://dev.mysql.com/doc/refman/5.1/en/time-zone-support.html)

> TIMESTAMP 列的值从当前时区转换为 UTC 进行存储，从 UTC 转换为当前时区进行检索。

我究竟做错了什么？我想用 UTC 日期/时间戳存储我的记录，并在用户的本地时区检索它们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T21:46:45.997

根据 MySQL 5.5 文档，使用 TIMESTAMP 数据类型将默认使用服务器的时区，除非您从客户端更改变量。

来自：[http ://dev.mysql.com/doc/refman/5.5/en/time-zone-support.html](http://dev.mysql.com/doc/refman/5.5/en/time-zone-support.html)

> 每个连接时区。每个连接的客户端都有自己的时区设置，由会话 time_zone 变量给出。最初，会话变量从全局 time_zone 变量中获取其值，但客户端可以使用以下语句更改自己的时区：
> 
> mysql> SET time_zone = 时区；

# r - 如何将 data.frame 转换为（平面）矩阵？

> ID：10404621
> 
> 赞同：1
> 
> 时间：2012-05-01T21:27:45.583
> 
> 标签：r

如何将下面的 data.frame 转换为给定的矩阵？data.frame 的前两列包含行变量，其他列的所有组合（包含值的列除外）确定列。理想情况下，我正在寻找一种不需要更多软件包的解决方案（所以*没有* `reshape2`解决方案）。同样，没有`ftable`解决办法。

```
(df <- data.frame(c1=rep(c(1, 2), each=8), c2=rep(c(1, 2, 1, 2), each=4),
                  gr=rep(c(1, 2), 8), subgr=rep(c(1,2), 4, each=2), val=1:16) )

c1 c2 gr1.subgr1 gr1.subgr2 gr2.subgr1 gr2.subgr2
1  1   1          3          2          4
1  2   5          7          6          8
2  1   9         11         10         12
2  2  13         15         14         16 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-02T02:29:50.737

使用交互变量来构造组：

```
newdf <- reshape(df, idvar=1:2, direction="wide", 
            timevar=interaction(df$gr,df$subgr) , 
            v.names="val", 
            drop=c("gr","subgr") ) 
names(newdf)[3:6] <- c("gr1.subgr1", "gr1.subgr2", "gr2.subgr1",  "gr2.subgr2")
 newdf
   c1 c2 gr1.subgr1 gr1.subgr2 gr2.subgr1 gr2.subgr2
1   1  1          1          2          3          4
5   1  2          5          6          7          8
9   2  1          9         10         11         12
13  2  2         13         14         15         16 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T22:05:45.017

好吧 - 这看起来主要是你想要的。通过阅读帮助文件，这似乎应该做你想做的事：

```
reshape(df, idvar = c("c1", "c2"), timevar = c("gr", "subgr")
        , direction = "wide")
   c1 c2 val.c(1, 2, 1, 2) val.c(1, 1, 2, 2)
1   1  1                NA                NA
5   1  2                NA                NA
9   2  1                NA                NA
13  2  2                NA                NA 
```

我无法完全解释为什么它会显示 NA 值。但是，也许帮助页面中的这一点解释了：

```
timevar 
the variable in long format that differentiates multiple records from the same 
group or individual. If more than one record matches, the first will be taken. 
```

我最初认为这意味着如果您给它的列名有歧义，R 将使用它的部分匹配功能，但也许不是？接下来，我尝试将`gr`and组合`subgr`成一个列：

```
df$newcol <- with(df, paste("gr.", gr, "subgr.", subgr, sep = "")) 
```

让我们再试一次：

```
reshape(df, idvar = c("c1", "c2"), timevar = "newcol"
        , direction = "wide", drop= c("gr","subgr"))

   c1 c2 val.gr.1subgr.1 val.gr.2subgr.1 val.gr.1subgr.2 val.gr.2subgr.2
1   1  1               1               2               3               4
5   1  2               5               6               7               8
9   2  1               9              10              11              12
13  2  2              13              14              15              16 
```

快！我无法解释或弄清楚如何使它不附加`val.`到列名，但我会让你自己弄清楚。我确定它在某处的帮助页面上。它还将组的顺序与您要求的顺序不同，但数据似乎是正确的。

FWIW，这是一个解决方案`reshape2`

```
> dcast(c1 + c2 ~ gr + subgr, data = df, value.var = "val")
  c1 c2 1_1 1_2 2_1 2_2
1  1  1   1   3   2   4
2  1  2   5   7   6   8
3  2  1   9  11  10  12
4  2  2  13  15  14  16 
```

尽管您仍然必须清理列名。

# ruby-on-rails-3 - 如何在 Factory Girl 中正确设置关联？

> ID：10404623
> 
> 赞同：0
> 
> 时间：2012-05-01T21:27:54.193
> 
> 标签：ruby-on-rails-3, factory-bot

我是 FactoryGirl 的新手。我来自固定装置世界。

我有以下两个模型：

```
class LevelOneSubject < ActiveRecord::Base
  has_many :level_two_subjects, :inverse_of => :level_one_subject
  validates :name, :presence => true
end

class LevelTwoSubject < ActiveRecord::Base
  belongs_to :level_one_subject, :inverse_of => :level_two_subjects
  validates :name, :presence => true
end 
```

我想在工厂做以下事情：

```
FactoryGirl.define do
  factory :level_one_subject, class: LevelOneSubject do
    factory :social_sciences do
      name "Social Sciences"
    end
  end

  factory :level_two_subject do
    factory :anthropology, class: LevelTwoSubject do
      name "Anthropology"
      association :level_one_subject, factory: social_sciences
    end

    factory :archaelogy, class: LevelTwoSubject do
      name "Archaelogy"
      association :level_one_subject, factory: social_sciences
    end
  end
end 
```

然后当我在这样的规范中使用工厂时：

```
it 'some factory test' do
  anthropology = create(:anthropology)
end 
```

我得到错误：

```
NoMethodError: undefined method `name' for :anthropology:Symbol 
```

有人可以帮忙吗？

如果我没有在工厂设置关联，那么我不会收到此错误，但我会收到`level_one_subject_id`必须存在的错误，并且只有以下测试代码有效：

```
it 'some factory test' do
  social_sciences = create(:social_sciences)
  anthropology = create(:anthropology, :level_one_subject_id => social_sciences.id)
end 
```

但是我真的很想知道为什么与协会的工厂不起作用。有了 Fixtures，我什么都没有了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T07:57:59.840

我认为您正在尝试按“类工厂”对工厂进行分组，这不是 FactoryGirl 的工作方式。如果命名得当，它将从工厂名称本身推导出 ActiveRecord 类。如果您的工厂名称与类名不同，我们需要使用类命名参数显式指定类名。这应该有效：

```
FactoryGirl.define do
    factory :level_one_subject do # automatically deduces the class-name to be LevelOneSubject
        name "Social Sciences"
    end

    factory :anthropology, class: LevelTwoSubject do
        name "Anthropology"
        level_one_subject # associates object created by factory level_one_subject
    end

    factory :archaelogy, class: LevelTwoSubject do
        name "Archaelogy"
        level_one_subject # associates object created by factory level_one_subject
    end
end 
```

# javascript - 限制连接的可排序选项

> ID：10404628
> 
> 赞同：1
> 
> 时间：2012-05-01T21:28:01.467
> 
> 标签：javascript, jquery, html, drag, jquery-ui-sortable

我有一个选项卡式可排序列表系统。但是，我无法限制可以拖入哪个选项卡的内容。

我现在的 javascript 是这样的

```
<script>
    $(function() {
        $( "#sortable1, #sortable2, #sortable_end" ).sortable().disableSelection();

        var $tabs = $( "#tabs" ).tabs();

        var $tab_items = $( "ul:first li", $tabs ).droppable({
            accept: ".connectedSortable li",
            hoverClass: "ui-state-hover",
            drop: function( event, ui ) {
                var $item = $( this );
                var $list = $( $item.find( "a" ).attr( "href" ) )
                    .find( ".connectedSortable" );

                ui.draggable.hide( "slow", function() {
                    $tabs.tabs( "select", $tab_items.index( $item ) );
                    $( this ).appendTo( $list ).show( "slow" );
                });
            }
        });
    });
    </script> 
```

和我的html

```
<div id="tabs">
    <ul>
        <li><a href="#Models">Make</a></li>
        <li><a href="#Minutes">Minutes</a></li>
        <li><a href="#Final">Final</a></li>
    </ul>
</div>

    <div id="Models">
            <ul id="sortable1" class="connectedSortable ui-helper-reset">
            <li id="item_=1"><div>nokia lumia 800</div></li><li id="item_=2"><div>Apple iPhone 4s</div></li><li id="item_=3"><div>Samsung Galaxy S2</div></li><li id="item_=4"><div>Blackberry Bold 9900</div></li><li id="item_=5"><div>HTC Sensation XE</div></li><li id="item_=6"><div>Sony Ericsson Xperia Arc S</div></li>     </ul>
        </div>

        <div id="Minutes">
            <ul id="sortable2" class="connectedSortable ui-helper-reset">

  <li id="item_=13"><div>100</div></li><li id="item_=14"><div>200</div></li><li id="item_=15"><div>500</div></li><li id="item_=16"><div>700</div></li><li id="item_=17"><div>1000</div></li><li id="item_=18"><div>2000</div></li><li id="item_=19"><div>3000</div></li><li id="item_=27"><div>Unlimited</div></li>     </ul>
        </div>

        <div id="Final">
            <ul id="sortable_end" class="connectedSortable ui-helper-reset">            
        </div> 
```

我可以将模型中的东西拖到几分钟内，我想限制它，所以只有东西可以拖到 final 中。并且最好只有两个选项卡中的一项。

多谢你们

# php - MySQL SELECT 返回旧值

> ID：10404632
> 
> 赞同：2
> 
> 时间：2012-05-01T21:28:32.493
> 
> 标签：php, mysql, caching

我有一个应用程序不幸地使用带有 MyISAM 表的遗留 mysql_* 函数（bleagh ...），所以我不能使用事务。我有获取当前余额的代码，检查此余额是否正常，如果是，它将减去一个数量并保存新余额。

问题是，我最近看到一个实例，其中两个查询获取相同的起始余额，减去一个数量，然后记录一个新的余额。由于他们都获得了相同的起始余额，因此两次更新后的期末余额都是错误的。

```
100 - 10 = 90
100 - 15 = 85 
```

什么时候应该...

```
100 - 10 = 90
90 - 15 = 75 
```

这些请求相隔几分钟执行，所以我不认为差异是由于竞争条件造成的。我最初的想法是 MySQL 缓存正在存储相同的初始查询的结果，以获得平衡。但是，我读到如果修改了任何相关表，则会删除这种类型的缓存。

我很可能会通过将所有内容放入一个查询来解决，但我仍然想弄清楚这一点。它让我感到迷惑。如果在修改表时删除了缓存，那么发生的事情不应该发生。有没有人听说过这样的事情，或者对为什么会发生有任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T21:31:07.700

它不太可能是查询缓存——如果底层数据集已被另一个查询修改，MySQL 足够聪明，可以使缓存条目无效。如果查询缓存在过期后仍然保留旧的陈旧值，那么 MySQL 将完全没用。

您是否可能有未完成的未提交事务导致此问题？如果没有对相关记录进行适当的锁定，您的第二个查询可能很容易抓取过时的数据。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T22:16:58.470

您的应用程序很可能有过时的数据。这很好，这取决于有多少数据库应用程序在工作，但是当您执行更新时，而不是执行以下操作：

```
UPDATE account
SET balance = :current_balance - 10
WHERE account_id = 1 
```

你需要做更多这样的事情：

```
UPDATE account
SET balance = balance - 10
WHERE account_id = 1 
```

这样，即使有人同时更改了它，您也可以使用数据库中的当前余额，而不是依赖陈旧的应用程序数据。

如果您只想在没有其他人修改它的情况下更改该值，那么您可以执行以下操作：

```
UPDATE account
SET balance = balance - 10
WHERE account_id = 1
  AND balance = :current_balance 
```

如果受影响的行数为 1，那么您成功了，该记录没有被其他人更改。但是，如果受影响的行数为 0，则其他人更改了记录。然后，您可以从那里决定要做什么。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T21:33:03.503

我认为锁定表格是解决您的问题的方法:)

# python - 在python中迭代mongo文档

> ID：10404633
> 
> 赞同：0
> 
> 时间：2012-05-01T21:28:46.843
> 
> 标签：python, mongodb, pymongo, mongodb-query

请看下面的代码：

```
collection = db_name.get_db().collection_name
print collection
# prints .. Collection(Database(Connection('localhost', 27017), u'db_name'), u'colelction_name')

for key in some_dict.keys():
        query = {"p_id":key}
        document = collection.find(query)
        print document
        # gives <pymongo.cursor.Cursor object at 0x7f13f3049b10> 
```

现在我想检索这个文档.. 并获取数据。但如果我这样做：

```
 for d in document:
            print d 
```

我收到以下错误

```
 File "/usr/local/lib/python2.7/dist-packages/pymongo/cursor.py", line 703, in next
   if len(self.__data) or self._refresh():
 File "/usr/local/lib/python2.7/dist-packages/pymongo/cursor.py", line 666, in _refresh
self.__uuid_subtype))
  File "/usr/local/lib/python2.7/dist-packages/pymongo/cursor.py", line 628, in __send_message
self.__tz_aware)
  File "/usr/local/lib/python2.7/dist-packages/pymongo/helpers.py", line 101, in _unpack_response
error_object["$err"]) 
```

我究竟做错了什么？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T04:10:05.330

您想检索“此文档” - 然后使用*官方方法*获取*一个*符合您的条件的文档：find_one()：

[http://api.mongodb.org/python/2.2/api/pymongo/collection.html](http://api.mongodb.org/python/2.2/api/pymongo/collection.html)

阅读基本 API 文档是您的朋友。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T21:55:04.427

Also, note that pymongo has several constructor options availble to a cursor :

[https://github.com/mongodb/mongo-python-driver/blob/master/pymongo/cursor.py](https://github.com/mongodb/mongo-python-driver/blob/master/pymongo/cursor.py)

Some of these options (await_data, exhaust, for example) will make a big difference in terms of speeding cursor iteration.

Depending on the length and complexity of your query, you can also process data in a separate thread, so that you run through the cursor as fast as possible, firing of asynchronous tasks along the way.

I've found that running a single thread for exhausting a mongo cursor, with separate threads for processing data from it can increase cursor throughput drastically, regardless of the amount of data the cursor brings down with it.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T04:23:34.797

当 API 和 mongo 提供适合此的查询时，我不明白您为什么要尝试使用这种方法获取一批文档？

如果 some_dict.keys() 返回一个 id 列表，并且您想检索与这些 id 匹配的文档，为什么不使用正确的“in”查询？

```
docs = collection.find({'p_id': {'$in':some_dict.keys()}})
print docs
# <pymongo.cursor.Cursor object at 0x10112dfd0>
print [d for d in docs]
# [{DOC1}, {DOC2}, {...}] 
```

As @ich recommended, the pymongo api docs explain everything, as well as reading the mongodb query language.

If this is not what you were looking for, then your intent was not clear in your question. It does simply look like you want to get a batch of documents matching a list of id's

# javascript - 仪表板小部件：从 Info.plist 获取版本号

> ID：10404637
> 
> 赞同：1
> 
> 时间：2012-05-01T21:28:59.573
> 
> 标签：javascript, macos, widget, dashboard, dashcode

我正在用 Dashcode 编写一个仪表板小部件，在背面，我有一个积分字符串。我想在该字符串中包含小部件的版本号，但如果可能，我想以编程方式从 Info.plist 中的`CFBundleVersion`or`CFBundleShortVersionString`键中获取它，以避免在更新小部件时必须在多个位置更改数字。

迄今为止，对 Apple 的[开发人员文档](http://developer.apple.com/library/mac/#documentation/AppleApplications/Conceptual/Dashboard_ProgTopics/Introduction/Introduction.html)、Google 和各种论坛的搜索都证明是徒劳的。我想知道的是是否有一种内置的方法可以做到这一点，Apple 包括但忘了提及（喜欢`var version = widget.version();`或其他东西），或者我的脚本是否必须在拔出之前拉入并解析整个 plist我真正想要的价值。

感谢您的任何帮助，您可以提供！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T07:35:24.220

我似乎找到了答案：使用 Dashcode 的“数据源”工具来读取 Info.plist 作为 XML 数据源。从那里，[这篇博](http://daringpuppet.blogspot.ca/2010/03/apple-dashcode-data-sources.html)文向我展示了如何遍历 plist 的结构并获取正确的字符串（在这种情况下，`<string>`文件中的第五个元素，对应于`CFBundleShortVersionString`.

我最终得到的功能：

```
function getWidgetVersion() {
    var dataSource = dashcode.getDataSource("infoPlist");
    var version = dataSource.selection().valueForKey("dict").valueForKey("string")[4]; // This line and the previous could probably be combined for the sake of brevity
    if (typeof(version) == 'string') {
        document.getElementById("creditsLabel").innerHTML += version; //I'll change this to just pass the number on
    }
} 
```

由于`creditsLabel`div 的文本已经从本地化字符串开始，我得到一个漂亮的小标签，上面写着“1.0 版”。

# javascript - 在使用 getter 转换后，在猫鼬中抑制转换为 Date

> ID：10404638
> 
> 赞同：1
> 
> 时间：2012-05-01T21:29:12.667
> 
> 标签：javascript, node.js, mongoose

我的 Mongoose 模式中有一个 Date 字段，我想将其转换为常规日期以进行显示。这样做的明显地方是在 getter 中，以避免到处调用`prettifyDate`函数。这不起作用，因为似乎 mongoose 正在获取我的 post-getter 字符串并将其提供给`Date`构造函数：

```
...
, date: {type: Date, get: function() { return 'foo'; }} 
... 
```

在我的架构中给了我：

```
Cast to date failed for value "foo" 
```

当我取文件时。

是否有可能将这个演员压制到`Date`? 有没有更好的方法让我想念？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T09:40:35.500

接受的答案是好的，但我认为你应该为此使用虚拟。它们是专门为这样的东西制作的。

```
schema.virtual('formatted_date').get(function () {
  // Code for prettifying where you refer to this.date
  return prettifiedDate;
}); 
```

这样您就不会在架构中放置额外的字段（仅用作虚拟字段）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-12T20:16:16.933

在当前版本的 Mongoose (3.8) 中，它工作正常：

```
date: {type: Date, get: function(v) { return 'foo'; }}   // yields 'foo' without errors 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-05-01T22:42:11.730

我一直在做同样的事情，并想出了一个解决方法：

```
, date: {type: Date}
, formatted_date: {type : String, get : prettifyDate} 
```

然后在 prettifyDate 函数中参考：this.date

这不太可能是最好的方法，但它确实有效。请记住使用 .toISOString() 转换日期以使用函数中的原始 ISO 日期。

# communication - 使用 rf 链接的 2 个 arduino 之间的距离

> ID：10404640
> 
> 赞同：2
> 
> 时间：2012-05-01T21:29:14.833
> 
> 标签：communication, arduino, wireless

我目前有一个设置，我使用 434MHz 的 Tx 和一个 Uno 向带有 Rx 的 Mega 发送一个字符。Mega 会计算它收到 char 的次数，然后如果它低于某个数字，它就会触发警报。这是在室内测量两个微控制器之间距离的可行方法还是有更好的方法。

**发射器（兆）**

```
#include <SoftwareSerial.h>

int rxPin=2; //Goes to the Receiver Pin
int txPin=5; //Make sure it is set to pin 5 going to input of receiver

SoftwareSerial txSerial = SoftwareSerial(rxPin, txPin);
SoftwareSerial rxSerial = SoftwareSerial(txPin, rxPin);
char sendChar ='H';

void setup() {
  pinMode(rxPin, INPUT);
  pinMode(txPin,OUTPUT);
  txSerial.begin(2400);
  rxSerial.begin(2400);
}

void loop() {
  txSerial.println(sendChar);
  Serial.print(sendChar);
} 
```

**接收者**

```
#include <SoftwareSerial.h>

//Make sure it is set to pin 5 going to the data input of the transmitter
int rxPin=5; 
int txPin=3; //Don't need to make connections
int LED=13;
int BUZZ=9;
int t=0;

char incomingChar = 0;
int counter = 0;

SoftwareSerial rxSerial = SoftwareSerial(rxPin, txPin);

void setup() {
  pinMode(rxPin, INPUT); //initilize rxpin as input
  pinMode(BUZZ, OUTPUT); //initilize buzz for output
  pinMode(LED, OUTPUT); //initilize led for output
  rxSerial.begin(2400); //set baud rate for transmission
  Serial.begin(2400); //see above
}

void loop() {
  for(int i=0; i<200; i++) {
    incomingChar = rxSerial.read(); //read incoming msg from tx

    if (incomingChar =='H') {
      counter++; //if we get bit "h" count it  
    }
    delay(5); //delay of 10 secs
  }
  Serial.println(incomingChar);
  Serial.println(counter); //prints the the bits we recieved

  if(counter<55) {
    //if we receive less than 100 bits than print out of range triggers alarm
    Serial.println("out of range"); 
    tone(BUZZ,5000,500);digitalWrite(LED,HIGH);
  }
  else {
    noTone(BUZZ);digitalWrite(LED, LOW);
    //if we get more than 100 bits than we are within range turn off alarm
    Serial.println("in range"); 
  }

  counter = 0;
  incomingChar=0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T23:21:20.880

从理论上讲，您可以通过使 uno 发送一条消息，让 mega 回显来实现距离测量。这将为 uno 在 arduino 之间的消息传播提供往返时间。您将不得不估计处理延迟。之后是基础物理。这与雷达的工作原理基本相同。实际的延迟类似于

t[往返]= t [uno 发送]+ 2*t[传播]+ t[兆接收]+ t[兆发送]+ t [uno 接收]

我猜你想要达到的距离是米的数量级。所需的分辨率将成为一个问题，因为`s = vt => t = s/v`，你的 arduino 和无线电波`s`之间的距离在哪里。`v = c`由于传输延迟应保持不变，因此您基本上必须能够以`1/c`秒间隔的顺序测量差异。我对arduinos不是很熟悉，所以我不知道他们是否能够进行这种测量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T12:28:33.457

我建议你使用像 Sparkfun 出售的[Maxbotix HRLV-EZ4](http://www.sparkfun.com/products/11309)这样的超声波测距仪。它在您的价格范围内，它应该能够以 1mm 的分辨率测量高达 5m/195 英寸的距离。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-03-10T02:02:47.243

实际上是可以做到的，我已经看到其他微控制器也可以做到。因此，使用 arduino 你将不得不解方程，适应 arduino 语言并进行大量测量以评估通信本身的差异。不要忘记大气衰减，这需要知道并适合方程。湿度可能会偏离电磁波。

# ruby-on-rails - 我可以在 4 列上有一个索引并在 Rails 应用程序 postgresql 数据库中将其设置为唯一吗？

> ID：10404642
> 
> 赞同：0
> 
> 时间：2012-05-01T21:29:19.510
> 
> 标签：ruby-on-rails, database, indexing

我想根据我的数据库中的 4 列设置一个索引，以确保快速查找并确保在所有 4 列中没有两行具有相同的条目。从而确保基于 4 列的唯一性。我知道这可以在其他语言和框架中完成，但是可以在 Rails 中完成吗？

我已经看到以下命令在 Rails 中设置索引：

```
add_index "users", ["email"], :name => "index_users_on_email", :unique => true 
```

但是，可以对超过 1 列进行类似的操作吗？

此外，如果这不能超过 1 列，那么人们如何处理基于 rails 中的多列的唯一性呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T21:48:47.557

是的，您可以在 Rails 中的多个列上创建索引。

```
add_index users, [email, col1, col2, col3], :name => "my_name", :unique => true 
```

应该管用。只要您指定名称，您就应该很好。

PostgreSQL（不确定 MySQL）对约束名称有字符限制，因此当`add_index`用于多个列时，请确保您提供自定义名称，或者您的列名称足够短以适应限制，否则自动生成 `index_users_on_col1_and_col2_and_col3`可能会为您搞砸。

# regex - 1 个或多个的正则表达式

> ID：10404643
> 
> 赞同：-6
> 
> 时间：2012-05-01T21:29:33.320
> 
> 标签：regex

什么是只允许从 1 到 99 的整数的正则表达式？（包括1和99）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-01T21:31:26.987

试试这个：

```
^[1-9][0-9]?$ 
```

这`?`意味着前一个令牌是可选的。

`^`和`$`分别是字符串开始和结束的[锚点](http://www.regular-expressions.info/anchors.html)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-01T21:32:30.327

你肯定是说

```
 [1-9][0-9]? 
```

# angularjs - 在生产环境中选择 Angularjs 中的依赖项

> ID：10404646
> 
> 赞同：2
> 
> 时间：2012-05-01T21:30:11.210
> 
> 标签：angularjs

Angular 中的所有 DI 文档似乎都基于这样的想法：当代码在生产中时，您希望服务的系统实现，当您运行自动化测试时，您希望在几个模拟实现中进行选择。

不，我有几个依赖项的工作实现，我想选择一个（通常基于 URL）。我怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-03T22:50:41.667

1.  将您的依赖项放入单独的模块中。例如 serviceA.impl1 和 serviceA.impl2
2.  创建应用程序级模块，但基于 URL 添加依赖项

```
angular.module('impl1', [])....
angular.module('impl2', [])....

var deps = [];
如果（位置。匹配（...）{
  deps.push('impl1')
} 别的 {
  deps.push('impl2')
}

angular.module('myApp', deps);

```

然后在你的 index.html 中做

```
  <html ng-app="myApp">

```

# html - CSS 表 TH 元素在 Firefox 中不是粗体（但在 IE 中可以）

> ID：10404652
> 
> 赞同：1
> 
> 时间：2012-05-01T21:30:26.763
> 
> 标签：html, css, html-table

嗨，我有一个表格，我想以粗体显示左侧的标题，并以粗体显示顶部的标题。

标题在 IE 中是粗体，但在 Firefox 中不是。网站在这里：[演示链接](http://www.unifiedmicrosystems.com/products-and-services/hosted-applications/web-hosting/)

代码如下。

我做错了什么，如何使 FF 中的元素加粗？

谢谢，

克里斯

**HTML**

```
<h2>Compare plans</h2>

<table class="compare-products">
<colgroup>
    <col class="col1"/>
    <col class="col2" />
    <col class="col3" />
    <col class="col4" />
    <col class="col5" />
</colgroup>

    <tr class="plan-headers">
        <th></th>
        <th>Starter</th>
        <th>Business</th>
        <th>Advanced</th>
        <th>Dedicated</th>
     </tr>
    <tr class="recommended-for">
        <td></td>
        <td>Ideal start for static websites</td>
        <td>Fast hosting for dynamic CMS websites</td>
        <td>Custom configurations and high traffic sites</td>
        <td>Dedicated resources for intensive work loads</td>
    </tr>
    <tr class="feature" title="">
        <th scope="row">Web space</th>
        <td>50MB</td>
        <td>1GB</td>
        <td>15GB</td>
        <td>250GB</td>
    </tr>
    <tr class="feature" title="">
        <th scope="row">Bandwidth</th>
        <td>1GB</td>
        <td>30GB</td>
        <td>1TB</td>
        <td>10TB</td>
    </tr>
    <tr class="feature" title="">
        <th scope="row">Websites</th>
        <td>1</td>
        <td>2</td>
        <td>Unlimited</td>
        <td>Unlimited</td>
    </tr>
    <tr class="feature" title="">
      <th scope="row">CPU</th>
      <td>Shared</td>
      <td>Shared</td>
      <td>1.2GHz</td>
      <td>2.4GHz</td>
    </tr>
    <tr id="captchaFeature" class="feature" title="">
      <th scope="row">Memory</th>
      <td>Shared</td>
      <td>Shared</td>
      <td>1GB</td>
      <td>4GB</td>
    </tr>
    <tr class="feature" title="">
      <th scope="row">IP Addresses</th>
      <td>Shared</td>
      <td>Shared</td>
      <td>2</td>
      <td>8</td>
    </tr>
    <tr class="feature" title="">
      <th scope="row">Zend Framework</th>
      <td><div class="yes">Yes</div></td>
      <td><div class="yes">Yes</div></td>
      <td><div class="yes">Yes</div></td>
      <td><div class="yes">Yes</div></td>
    </tr>
    <tr class="feature" title="">
      <th scope="row">cPanel/WHM</th>
      <td><div class="yes">Yes</div></td>
      <td><div class="yes">Yes</div></td>
      <td><div class="yes">Yes</div></td>
      <td><div class="yes">Yes</div></td>
    </tr>
    <tr class="feature" title="">
      <th scope="row">PHP/Python/Ruby</th>
      <td><div class="yes">Yes</div></td>
      <td><div class="yes">Yes</div></td>
      <td><div class="yes">Yes</div></td>
      <td><div class="yes">Yes</div></td>
    </tr>
    <tr class="feature" title="">
      <th scope="row">RAID Storage</th>
      <td><div class="yes">Yes</div></td>
      <td><div class="yes">Yes</div></td>
      <td><div class="yes">Yes</div></td>
      <td><div class="yes">Yes</div></td>
    </tr>
    <tr class="feature" title="">
      <th scope="row">DELL Hardware</th>
      <td><div class="yes">Yes</div></td>
      <td><div class="yes">Yes</div></td>
      <td><div class="yes">Yes</div></td>
      <td><div class="yes">Yes</div></td>
    </tr>
    <tr class="feature" title="">
      <th scope="row">99.9% Uptime</th>
      <td><div class="yes">Yes</div></td>
      <td><div class="yes">Yes</div></td>
      <td><div class="yes">Yes</div></td>
      <td><div class="yes">Yes</div></td>
    </tr>
    <tr class="feature" title="">
      <th scope="row">24/7 Support</th>
      <td><div class="yes">Yes</div></td>
      <td><div class="yes">Yes</div></td>
      <td><div class="yes">Yes</div></td>
      <td><div class="yes">Yes</div></td>
    </tr>
    <tr class="feature" title="">
        <th scope="row">IMAP/POP3 Accounts</th>
        <td>5</td>
        <td>25</td>
        <td>Unlimited</td>
        <td>Unlimited</td>
    </tr>
    <tr id="manageFeature2" class="feature" title="">
      <th scope="row">FTP Accounts</th>
      <td>1</td>
      <td>5</td>
      <td>Unlimited</td>
      <td>Unlimited</td>
    </tr>
    <tr class="feature" title="">
      <th scope="row">Offsite Backup</th>
      <td>-</td>
      <td>1GB Weekly</td>
      <td>10GB Daily</td>
      <td>100GB Daily</td>
    </tr>
    <tr class="feature" title="">
      <th scope="row">MySQL Databases</th>
      <td>-</td>
      <td>2</td>
      <td>Unlimited</td>
      <td>Unlimited</td>
    </tr>
    <tr class="feature" title="">
      <th scope="row">Subdomains</th>
      <td>-</td>
      <td>2</td>
      <td>Unlimited</td>
      <td>Unlimited</td>
    </tr>

    <tr id="dedicatedFeature" class="feature" title="">
        <th scope="row">SSL Certificate</th>
        <td>-</td>
        <td>-</td>
        <td>Optional</td>
        <td>Optional</td>
    </tr>
    <tr class="feature" title="">
      <th scope="row">ASP &amp; MSQL</th>
      <td>-</td>
      <td>-</td>
      <td>Optional</td>
      <td>Optional</td>
    </tr>

    <tr class="signup">
        <th scope="row"></th>           
            <td>Sign Up</td>
            <td>Sign Up</td>
            <td>Sign Up</td>
        <td>Sign Up</td>
    </tr>
    <tr class="faq-links">
        <th scope="row">Learn more</th>
        <td>Starter Plan FAQ</td>
        <td>Business FAQ</td>
        <td>Advanced FAQ</td>
        <td>Dedicated FAQ</td>
    </tr>
</table> 
```

**CSS**

```
compare-products .col1
{
width: 20%;
}

.compare-products .col2
{
width: 20%;
}

.compare-products .col3
{
width: 20%;
}

.compare-products .col4
{
width: 20%;
}

.compare-products .col5
{
width: 20%;
}

.compare-products  tr td
{
text-align: center;
}

.compare-products tr th[scope=row]
{
text-align: right;
border-bottom: 1px dotted #dddddd;
font-weight: bold;
}

.compare-products tr td
{
border-bottom: 1px dotted #dddddd;
padding: 5px 10px 5px 10px;
}

.compare-products tr.plan-headers th
{
font-size: 20px;
font-weight: bold;
border: none;
padding: 5px 5px 5px 5px;
text-align: center;
}

.compare-products tr.feature th
{
font-weight: bold;
}

.compare-products tr.recommended-for td
{
border: none;
padding: 5px 10px 10px 5px;
text-align: center;
}

.compare-products tr td div.yes, .compare-products tr td div.no, .compare-products tr td div.partial {
height: 16px;
text-indent: -9999px;
}

.compare-products div.yes {
background: url(images/yes.png) no-repeat center center;
}

.compare-products div.no {
background: url(images/no.png) no-repeat center center;
}

.compare-products div.partial {
background: url(images/partial.png) no-repeat center center;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T21:39:53.547

我还没有足够的声誉来发表评论，所以我会把它们放在这里。

我使用的是 FF 10，左侧的行标题（Web 空间、带宽等）显示为粗体。字体没有列标题上的那么大，但绝对是粗体。

# android - 任何操作系统平台的游戏开发

> ID：10404654
> 
> 赞同：0
> 
> 时间：2012-05-01T21:30:37.440
> 
> 标签：android, windows, lua, game-engine

谢谢问题已解决，我知道答案！..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T21:36:33.450

[Unity](http://unity3d.com/)是一种解决方案。

有很多竞争对手/游戏引擎可能会起作用。说实话，这在很大程度上取决于您想要开发的游戏类型。我想我会做一些谷歌搜索并查看 unity3d。另请查看[UDK](http://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&ved=0CDEQFjAA&url=http://udk.com/&ei=B1igT-nzOaba0QGsvYC4Ag&usg=AFQjCNELLQiSO3K2-R6lSjxvOWj8nDSIig)。

免费游戏引擎的另一个[资源](http://freegamedev.net/wiki/index.php/Free,_cross-platform_game_engines)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T21:33:26.217

答案是Java。它独立于平台。

# javascript - 在 UIWebView 中保存突出显示的文本

> ID：10404660
> 
> 赞同：1
> 
> 时间：2012-05-01T21:31:11.947
> 
> 标签：javascript, objective-c, ios

我已经搜索了很多天来做以下事情：

1.  突出显示 UIWebView 中的文本并将突出显示保存在 iOS（核心数据，...）中以突出显示用户第二次使用该应用程序。我怎么能，请这样做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T22:04:38.640

您可以使用 Javascript 搜索和突出显示文本，[检查这个答案。](https://stackoverflow.com/questions/1004094/how-can-i-search-in-an-uiwebview)

我已经使用了该代码并且运行良好。

如果您想“保存”突出显示的文本，您可以保存单词或短语以在 plist 文件或 Core Data 中突出显示。因此，当您需要恢复突出显示时，您只需将单词或短语传递给 Javascript 函数。

您可能需要稍微修改一下代码，因为它会在您每次想要突出显示新单词时清除突出显示。

希望能帮助到你。

# android - 从另一个活动刷新列表

> ID：10404669
> 
> 赞同：3
> 
> 时间：2012-05-01T21:31:56.967
> 
> 标签：android, listview, arraylist, jakarta-mail

我有 3 项活动和 1 节课；

**MobilEpostaActivity**（主活动）将来自 Gmail 服务器意图的数据提供给**ListeleActivity**（填充并显示 ListView），ListeleActivity 将这些数据填充到 ListView，当项目 onClick ListView 时，项目的点击数据意图传递给**GoruntuleActivity**（显示onclick 项目的信息）。而且我还有一个类“ **Baglantı** ”（表示连接），它具有每个所需的所有其他方法。

我的问题在这里：当用户单击“删除”按钮时。我想刷新列表视图并向用户显示下一封邮件。当用户单击删除按钮时，我可以向用户显示下一封邮件并在该位置添加 1 并显示它。但它不能正常工作，因为它的附件很复杂。

现在从 MobilEpostaActivity 开始；我从用户那里获取用户名和密码，并将它们传递给 Baglantı 类以连接到服务器。然后我得到了结果体，来自数组列表中的主题。然后，我有意地传递这些主体，并受制于 ListeleActivity。

```
public void epostaListeleme() throws MessagingException, IOException 
    {
        final Intent intent = new Intent(this, ListeleActivity.class);
        intent.putStringArrayListExtra(bodylistesi ,(ArrayList<String>) getBodyList());
        intent.putStringArrayListExtra(konulistesi ,(ArrayList<String>) getKonuList());
        intent.putStringArrayListExtra(kimdenlistesi ,(ArrayList<String>) getKimdenList());
        startActivity(intent);
        } 
```

在 ListeleActivity() 中：

使用 Bundle 从 MobilEpostaActivity 获取数据。用“来自”数据填充列表视图。并等待 listItemOnClick。如果发生 Onclick 操作，则将数据传递给 GoruntuleActivity。**

在 GoruntuleActivity() 中：

使用 Bundle 从 ListeleActivity 获取数据。并且（这里是重要部分）等待删除按钮 OnClick。如果首先发生 Onclick 操作）从 ListView 中删除该位置。

```
arrayAdapter.remove(arrayAdapter.getItem(position));
listBaglanti.RefreshedPositions(position);
arrayAdapter.notifyDataSetChanged(); 
```

SECOND) 从 bodylist 、 fromlist 和 subjectlist 中删除职位数据：

```
public void RefreshedPositions(int position) 
{
    list.remove(list.get(position));
    kimdenlist.remove(kimdenlist.get(position));
    konulist.remove(konulist.get(position));
} 
```

第三）将这些“更改”列表保存在数组列表中：

```
bodylistRefresh = baglan.list;
kimdenlisteRefresh = baglan.kimdenlist;
konulisteRefresh = baglan.konulist; 
```

第四）将这些“更改”列表设置为 MobilEpostaActivity 的意图（ListeleAcitivity 的意图之一）：

```
MobilEpostaActivity mobilObject = new MobilEpostaActivity();
mobilObject.setKonuList(konulisteRefresh);
mobilObject.setKimdenList(kimdenlisteRefresh);
mobilObject.setBodyList(bodylistRefresh); 
```

正如您认为的那样，该过程应该重新开始。但它并没有开始，因为第四步，我不认为我对 ListView 进行了刷新。

也许我走了一条很难的路。但我希望，你告诉我刷新列表视图并显示下一封邮件的正确方法。还有我的截图；

当我第一次打开应用程序时：有 3 封来自 Merve 的邮件。职位：0,1,2*

![在此处输入图像描述](../Images/823504065c16c94d5d086be3d66dfa01.png)

单击删除按钮后：刷新 ListView 并删除 position=1 的项目。但它不会在 GoruntuleActivity 的屏幕上被删除。

![在此处输入图像描述](../Images/ecf6f01c71a8dc1b3ef90fe78400bb12.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T01:13:51.407

看起来您涉及的列表太多。我认为您应该能够像这样从主列表中删除该项目：

```
arrayAdapter.remove(position);
listBaglanti.RefreshedPositions(position);
arrayAdapter.notifyDataSetChanged();

public void RefreshedPositions(int position) 
{
    list.remove(position);
    kimdenlist.remove(position);
    konulist.remove(position);
} 
```

只需将位置作为 int 值传递，而不是检索然后删除对象。

# ruby-on-rails - 我何时/为什么要在方法上引发异常？

> ID：10404674
> 
> 赞同：2
> 
> 时间：2012-05-01T21:32:18.823
> 
> 标签：ruby-on-rails, ruby

我注意到 Rails 中的某些方法使用`!`运算符在无效时引发异常。例如，`User.create!`

为什么以及何时要使用这样的东西？

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-01T21:43:44.823

我可能出于各种原因想要例外

*   我可能想确保该方法成功，但我不想在这里进行任何实际的错误处理。但是如果某些事情失败了，我可能会接受请求爆炸（例如产生 HTTP 500）
*   我可能希望在其他地方进行一些错误处理，例如在调用链中的某个方式。通常，将一些错误状态拉到错误处理的道路上会更加冗长和讨厌。结构化的错误处理，即，`begin ... rescue ... end`使其更清晰。
*   异常可以附加附加数据（例如错误消息）
*   如果您有不同的错误类型，通常更清楚地表示那些具有不同异常类而不是一些神奇的 id 值（在 C 中很常见）

当错误状态数量很少并且在调用后直接完全处理时，有充分的理由不使用异常而是状态标志。但每一种技术都有它的位置和时间。

顺便说一句，该`save`方法在内部调用`save!`，处理潜在的异常并返回 false（如果有）。请参阅[实现代码](https://github.com/rails/rails/blob/v3.2.3/activerecord/lib/active_record/persistence.rb#L68-88)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-01T21:37:13.033

[如果在事务处于活动状态时抛出异常，ActiveRecord 将回滚事务](http://api.rubyonrails.org/classes/ActiveRecord/Rollback.html)。

因此，抛出异常的方法可以很好地确保数据库在发生异常情况时不会提交事务。当您可以自己“处理”问题时——或者，如果它实际上不是问题——那么您可以使用不带 的变体`!`，检查返回值是否存在错误条件，然后自己处理它们。

对于特定的东西，例如`User.create`：

*   您可以使用该`User.create`方法来确定是否尚未选择用户提供的用户名，并提示用户选择另一个名称（如果已在使用中）。
*   您可以`User.create!`在最终提交请求时使用该方法，以便您的完整性检查可以使创建和回滚事务失败，以防用户试图绕过您的友好名称检查。

# c# - Hysteresis Round to solve "flickering" values due to noise

> ID：10404676
> 
> 赞同：4
> 
> 时间：2012-05-01T21:32:28.600
> 
> 标签：c#, math, rounding

**Background:** We have an embedded system that converts linear positions (0 mm - 40 mm) from a potentiometer voltage to its digital value using a 10-bit analog to digital converter.

```
 ------------------------
0mm |                      | 40 mm
    ------------------------ 
```

We show the user the linear position at 1 mm increments. Ex. 1mm, 2mm, 3mm, etc.

**The problem:** Our system can be used in electromagnetically noisy environments which can cause the linear position to "flicker" due to noise entering the ADC. For example, we will see values like: 39,40,39,40,39,38,40 etc. when the potentiometer is at 39 mm.

Since we are rounding to every 1 mm, we will see flicker between 1 and 2 if the value toggles between 1.4 and 1.6 mm for example.

**Proposed software solution:** Assuming we can not change the hardware, I would like to add some hysteresis to the rounding of values to avoid this flicker. Such that:

If the value is currently at 1mm, it can only go to 2mm iff the raw value is 1.8 or higher. Likewise, if the current value is 1mm it can only go to 0mm iff the raw value is 0.2 or lower.

I wrote the following simple app to test my solution. Please let me know if I am on the right track, or if you have any advice.

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace PDFSHysteresis
{
    class Program
    {
        static void Main(string[] args)
        {
            double test = 0;
            int curr = 0;
            Random random = new Random();

            for (double i = 0; i < 100; i++)
            {
                test = test + random.Next(-1, 2) + Math.Round((random.NextDouble()), 3);
                curr = HystRound(test, curr, 0.2);

                Console.WriteLine("{0:00.000} - {1}", test, curr);
            }

            Console.ReadLine();
        }

        static int HystRound(double test, int curr, double margin)
        {

            if (test > curr + 1 - margin && test < curr + 2 - margin)
            {
                return curr + 1;
            }
            else if (test < curr - 1 + margin && test > curr - 2 + margin)
            {
                return curr - 1;
            }
            else if (test >= curr - 1 + margin && test <= curr + 1 - margin)
            {
                return curr;
            }
            else
            {
                return HystRound(test, (int)Math.Floor(test), margin);
            }
        }
    }
} 
```

Sample output:

```
Raw      HystRound
======   =========
00.847   1
00.406   1
01.865   2
01.521   2
02.802   3
02.909   3
02.720   3
04.505   4
06.373   6
06.672   6
08.444   8
09.129   9
10.870   11
10.539   11
12.125   12
13.622   13
13.598   13
14.141   14
16.023   16
16.613   16 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T21:38:06.397

How about using the average of readings for the last N seconds, where N could be fairly small / sub-second depending on your sample rate?

You can use a simple linear average, or something more complex, depending on your needs. Several moving average algorithms are detailed on Wikipedia:

[http://en.wikipedia.org/wiki/Moving_average](http://en.wikipedia.org/wiki/Moving_average)

Depending on your sensitivity / responsiveness needs, you could reset the average if a new reading exceeds the running average by X%.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T21:50:05.240

I had to deal with something similar sometime ago where I had to read voltage output from a circuit and display a graph on a computer screen. The bottom line is, this really depends on your system requirements. If the requirement is "1mm" accuracy then there is nothing you could really do. Otherwise, as mentioned above, you could go with several methods that can help you out lessen the flickering. You can:

*   Calculate the average of these values over a certain period of time the user can configure.
*   Allow the user to set a "Sensitivity threshold". This threshold can be used to decide on weather to consider the new value as valid or not. In your example, the threshold can be set to 2mm in which case values such as `39, 40, 39, 38` would read as `39mm`
*   Also, have you thought about putting an external stabilizer between your application and the hardware itself?

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-08T08:27:55.657

I think Gareth Rees gave an excellent answer to a very similar question: [how to prevent series of integers to have the same value to often](https://stackoverflow.com/questions/13990583/how-to-prevent-series-of-integers-to-have-the-same-value-to-often)

# java - 如何使用 HTML 解析器获取 div 标签或 Java 中的另一个标签中的内容

> ID：10404678
> 
> 赞同：0
> 
> 时间：2012-05-01T21:32:41.413
> 
> 标签：java, html, html-parsing

我想在标签中获取文本，即

```
<div id="title">    MotoGP  </div> 
```

我想从这里提取“MotoGP”。我正在使用`org.htmlparser`.

我试过了

```
NodeList nodes = parser.extractAllNodesThatMatch(new AndFilter(new TagNameFilter("div"),
     new HasAttributeFilter("id", "title")));

    SimpleNodeIterator nodeIterator = nodes.elements();
    while (nodeIterator.hasMoreNodes()) {

             HeadingTag tag = (HeadingTag)node;
             System.out.println(tag.getStringText()); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T21:49:32.620

# c# - 在WPF DataGrid中按Enter键时将焦点移动到下一个单元格？

> ID：10404681
> 
> 赞同：15
> 
> 时间：2012-05-01T21:33:25.063
> 
> 标签：c#, wpf, mvvm, wpfdatagrid

我想要一个自定义 DataGrid，它可以，

1.  按下键时移动到下一个单元格，`Enter`如果它处于编辑模式。
2.  当到达当前行的最后一列时，焦点应移动到下一行的第一个单元格。
3.  到达下一个单元格时，如果该单元格是可编辑的，它应该自动变为可编辑的。
4.  如果单元格包含`ComboBox`非组合框列，则组合框应 DropDownOpen。

请帮助我。从过去的几天开始，我一直在尝试通过创建自定义 DataGrid 并在

```
protected override void OnPreviewKeyDown(System.Windows.Input.KeyEventArgs e) 
```

但我失败了。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2014-03-11T17:20:00.563

一个更简单的实现。这个想法是捕获 keydown 事件，如果键是“Enter”，则移动到下一个选项卡，即网格的下一个单元格。

```
/// <summary>
/// On Enter Key, it tabs to into next cell.
/// </summary>
/// <param name="sender"></param>
/// <param name="e"></param>
private void DataGrid_OnPreviewKeyDown(object sender, KeyEventArgs e)
{
    var uiElement = e.OriginalSource as UIElement;
    if (e.Key == Key.Enter && uiElement != null)
    {
        e.Handled = true;
        uiElement.MoveFocus(new TraversalRequest(FocusNavigationDirection.Next));
    }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-04T04:40:18.787

```
private void dg_PreviewKeyDown(object sender, KeyEventArgs e)
{
    try
    {
        if (e.Key == Key.Enter)
        {
            e.Handled = true;
            var cell = GetCell(dgIssuance, dgIssuance.Items.Count - 1, 2);
            if (cell != null)
            {
                cell.IsSelected = true;
                cell.Focus();
                dg.BeginEdit();
            }
        }
    }
    catch (Exception ex)
    {
        MessageBox(ex.Message, "Error", MessageType.Error);
    }
}  

public static DataGridCell GetCell(DataGrid dg, int row, int column)
{
    var rowContainer = GetRow(dg, row);

    if (rowContainer != null)
    {
        var presenter = GetVisualChild<DataGridCellsPresenter>(rowContainer);
        if (presenter != null)
        {
            // try to get the cell but it may possibly be virtualized
            var cell = (DataGridCell)presenter.ItemContainerGenerator.ContainerFromIndex(column);
            if (cell == null)
            {
                // now try to bring into view and retreive the cell
                dg.ScrollIntoView(rowContainer, dg.Columns[column]);
                cell = (DataGridCell)presenter.ItemContainerGenerator.ContainerFromIndex(column);
            }
            return cell;
        }
    }
    return null;
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2019-06-14T01:11:44.433

这个解决方案怎么样？`Enter`通过设置取消键的动作，`Handled=true`按`Tab`键。

```
public Constructor()
{
  InitializeComponent(); 
  this.SampleDataGrid.PreviewKeyDown += MoveCellOnEnterKey;
}

private void MoveCellOnEnterKey(object sender, KeyEventArgs e)
{
  if(e.Key == Key.Enter)
  {
    // Cancel [Enter] key event.
    e.Handled = true;
    // Press [Tab] key programatically.
    var tabKeyEvent = new KeyEventArgs(
      e.KeyboardDevice, e.InputSource, e.Timestamp, Key.Tab);
    tabKeyEvent.RoutedEvent = Keyboard.KeyDownEvent;
    InputManager.Current.ProcessInput(tabKeyEvent);
  }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-11T05:56:41.840

```
public class DataGrid : System.Windows.Controls.DataGrid
{
    private void PressKey(Key key)
    {
        KeyEventArgs args = new KeyEventArgs(Keyboard.PrimaryDevice, Keyboard.PrimaryDevice.ActiveSource, 0, key);
        args.RoutedEvent = Keyboard.KeyDownEvent;
        InputManager.Current.ProcessInput(args);
    }
    protected override void OnCurrentCellChanged(EventArgs e)
    {
        if (this.CurrentCell.Column != null)                
            if (this.CurrentCell.Column.DisplayIndex == 2)
            {

                if (this.CurrentCell.Item.ToString() == "--End Of List--")
                {
                    this.MoveFocus(new TraversalRequest(FocusNavigationDirection.Down));
                }
            }
            else if (this.CurrentCell.Column != null && this.CurrentCell.Column.DisplayIndex == this.Columns.Count() - 1)
            {
                PressKey(Key.Return);
                DataGridCell cell = DataGridHelper.GetCell(this.CurrentCell);
                int index = DataGridHelper.GetRowIndex(cell);
                DataGridRow dgrow = (DataGridRow)this.ItemContainerGenerator.ContainerFromItem(this.Items[index]);
                dgrow.MoveFocus(new TraversalRequest(FocusNavigationDirection.First));
            }
    }
    protected override void OnKeyDown(KeyEventArgs e)
    {
        if (e.Key == Key.Enter)
        {
            DataGridRow rowContainer = (DataGridRow)this.ItemContainerGenerator.ContainerFromItem(this.CurrentItem);
            if (rowContainer != null)
            {
                int columnIndex = this.Columns.IndexOf(this.CurrentColumn);
                DataGridCellsPresenter presenter = UIHelper.GetVisualChild<DataGridCellsPresenter>(rowContainer);
                if (columnIndex == 0)
                {
                    DataGridCell cell = (DataGridCell)presenter.ItemContainerGenerator.ContainerFromIndex(columnIndex);
                    TraversalRequest request = new TraversalRequest(FocusNavigationDirection.Next);
                    request.Wrapped = true;
                    cell.MoveFocus(request);
                    BeginEdit();
                    PressKey(Key.Down);
                }
                else
                {
                    CommitEdit();
                    DataGridCell cell = (DataGridCell)presenter.ItemContainerGenerator.ContainerFromIndex(columnIndex);
                    TraversalRequest request = new TraversalRequest(FocusNavigationDirection.Next);
                    request.Wrapped = true;
                    cell.MoveFocus(request);
                }
                this.SelectedItem = this.CurrentItem;
                e.Handled = true;
                this.UpdateLayout();
            }
        }
    }
} 
```

暂时，我已经写了这个并且它为我工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-08-29T08:09:55.163

```
 Public Sub SendKey(ByVal key As Key)
     Dim args As New KeyEventArgs(Keyboard.PrimaryDevice, Keyboard.PrimaryDevice.ActiveSource, 0, key)
        args.RoutedEvent = Keyboard.KeyDownEvent
        InputManager.Current.ProcessInput(args)
    End Sub
Private Sub dataGrid_PreviewKeyDown(sender As Object, e As KeyEventArgs) Handles dataGrid.PreviewKeyDown
        Dim i As UIElement = e.OriginalSource
        Dim DG As DataGrid = sender
        If (e.Key = Key.Enter Or e.Key = Key.Return) AndAlso i IsNot Nothing Then
            MyBase.OnKeyDown(e)
            DG.CommitEdit()
            SendKey(Key.Tab)
            e.Handled = True
        End If
    End Sub 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2022-03-02T13:14:48.010

关键方法是“dataGrid.SetKeyboardFocusToCell”。所以我们可以附加 KeyDown 事件：

```
 private void dataGrid_PreviewKeyDown(object sender, KeyEventArgs e)
    {
        DataGridTemplateColumn col = (DataGridTemplateColumn)dataGrid.CurrentColumn;
        if (col != null)
        {
            switch (col.SortMemberPath)
            {
                case "From":
                    if (e.Key == Key.Enter && Keyboard.Modifiers == ModifierKeys.None) // Pure Enter
                    {
                        e.Handled = true;
                        int columnIndex = dataGrid.GetColumnIndex(colTo);
                        DataGridRow currentRow = dataGrid.GetRow(dataGrid.CurrentItem);

                        dataGrid.SetKeyboardFocusToCell(dataGrid.CurrentItem, columnIndex);
                        Dispatcher.Invoke(() =>
                        {
                            GridTimeSpanBox timeSpanBox = VisualTree.FindChild<GridTimeSpanBox>(currentRow, tsb => tsb.Name == "tsbTo", true);
                            timeSpanBox.SelectAll();
                        }, System.Windows.Threading.DispatcherPriority.ContextIdle);
                    }
                    break;
            }
        } // col != null
    }

    /// <summary>
    /// Get the row container that holds the 'item'
    /// </summary>
    public DataGridRow GetRow(object item)
    {
        return (DataGridRow)ItemContainerGenerator.ContainerFromItem(item);
    }

    /// <summary>
    /// Gets the index of a 'DataGridColum' or 'DataGridTemplateColumn' in the 'Columns' list. This doesn't change if the user
    /// reorders the columns.
    /// </summary>
    public int GetColumnIndex(DataGridColumn column)
    {
        return this.Columns.IndexOf(column);
    } 
```

在此示例中，也选择了以下框中的文本。对于大部分时间通过键入新内容来替换内容的字段可能很有用。

需要注意的是，通常必须通过调度程序发送“dataGrid.SetKeyboardFocusToCell()”之后的操作以允许 UI 完成更新。否则会发生奇怪的事情。

例如，使用这种方案，您甚至可以在当前行后面插入一行。

# ruby - HAML -> 主干模板，非转义 HTML 参数

> ID：10404686
> 
> 赞同：3
> 
> 时间：2012-05-01T21:33:41.213
> 
> 标签：ruby, backbone.js, haml

我正在使用 HAML 为 Backbone.js 应用程序生成模板。我需要能够`<%= blah %>`作为 html 属性插入：

```
%a{:href => "myresources/<% id %>"} My Resource 
```

并让它输出

```
<a href='myresources/<%= id %>' >My Resource</a> 
```

在 html 模板中。不幸的是，HAML 转义了 html 参数，让我留下了

```
<a href='#myresources/&lt;%= id %&gt;'>My Resource</a> 
```

根据[HAML Reference](http://haml-lang.com/docs/yardoc/file.HAML_REFERENCE.html#unescaping_html)的“！” 运算符可用于对字符串进行转义，但不能在 HTML 属性中使用。

此外，我会使用纯文本来呈现锚标记，但由于锚标记是此特定视图的根，我失去了使用 HAML 的所有好处。

有什么帮助吗？

**更新** 我没有提到，但我使用 LiveReload 来实际监视我的文件系统并运行 haml 编译器，并且 LiveReload 中有一个设置可以禁用标签属性中的 HTML 转义。<head slap> 如果其他人在 LiveReload 之外遇到此问题，您还可以`:escape_attrs`在配置 HAML 设置时将该选项设置为 false。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T04:33:52.393

`escape_attrs`您可以使用HAML 配置中的选项将 HAML 配置为不转义标签属性。请参阅[HAML 选项](http://haml-lang.com/docs/yardoc/file.HAML_REFERENCE.html#options)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-17T11:12:14.933

您可以尝试使用 html_safe ，它是 String 对象的一种方法。这将转义变量语句中的 html 字符（例如 < ），并保留完整的下划线以在运行时进行评估：

```
%a{:href => "myresources/<% id %>".html_safe} My Resource 
```

[在使用 Underscore.js 对 html 属性内插值](https://stackoverflow.com/questions/8332389/interpolate-inside-html-attributes-with-underscore-js)的回答中找到

# vba - 在word中保存为文件名

> ID：10404689
> 
> 赞同：6
> 
> 时间：2012-05-01T21:34:02.657
> 
> 标签：vba, ms-word, save

在下面的代码中，文件名是硬编码的，但我希望用户能够选择它。

我正在阅读`GetSaveAsFilename`但使用它时出现错误：“找不到方法或成员”。

```
fileSaveName = Application.GetSaveAsFilename _
    (fileFilter:="Excel Files (*.txt), *.txt") 
```

这是为 Word 2010 编写的。我是否认为`GetSaveAsFilename`Word VBA 中可用？

```
 Sub Macro3()
'
' Macro3 Macro
'
'
    ActiveDocument.SaveAs2 FileName:="Questionnaire01-05-20122.txt", _
        FileFormat:=wdFormatText, LockComments:=False, Password:="", _
        AddToRecentFiles:=True, WritePassword:="", ReadOnlyRecommended:=False, _
        EmbedTrueTypeFonts:=False, SaveNativePictureFormat:=False, SaveFormsData _
        :=True, SaveAsAOCELetter:=False, Encoding:=1252, InsertLineBreaks:=False, _
         AllowSubstitutions:=False, LineEnding:=wdCRLF, CompatibilityMode:=0
End Sub 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-02T01:24:02.130

我没有意识到 Word 没有 GetSaveAsFileName 或 GetOpenFileName 方法（Excel 有）。但事实并非如此。相反，您可以尝试 SaveAs FileDialog ( [2003](http://msdn.microsoft.com/en-us/library/aa213120%28v=office.11%29.aspx) , [2007](http://msdn.microsoft.com/en-us/library/bb208503%28v=office.12%29.aspx) , [2010](http://msdn.microsoft.com/en-us/library/ff196794.aspx) )：

```
Sub ShowSaveAsDialog()
Dim dlgSaveAs As FileDialog
Set dlgSaveAs = Application.FileDialog(FileDialogType:=msoFileDialogSaveAs)
dlgSaveAs.Show
End Sub 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-02T07:04:29.807

您可以为对话框提供包括文件名在内的默认路径，即

```
Sub SaveName()
    Dim strFileName As String
    Dim StrPath As String
    'provide default filename
    StrPath = "c:\temp\test.docx"
    With Dialogs(wdDialogFileSaveAs)
        .Name = StrPath
        If .Display <> 0 Then
            strFileName = .Name
        Else
            strFileName = "User Cancelled"
        End If
    End With
    MsgBox strFileName
End Sub 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-28T19:43:12.423

```
Dim strFilePath, strFileName
strFilePath = "C:\Users\Public\Documents\"
strFileName = "put-filename-here.docx"

With Dialogs(wdDialogFileSaveAs)
    .Name = strFilePath & strFileName
    .Show
End With 
```

# c++ - QProcess 在 win32 系统上不起作用？

> ID：10404693
> 
> 赞同：0
> 
> 时间：2012-05-01T21:34:28.323
> 
> 标签：c++, qt

如果我在 windows XP 和 windows 32 位系统中以编程方式传递用户主目录，则处理方法不起作用

下面的代码工作正常：

```
 QProcess process;
 process.execute("C:/DOCUME~1/pjo/myprok/tmp/APP.exe"); 
```

不工作代码：

在这里，我使用 QDir::homePath 获取 APP.exe 的路径

```
 process.execute("C:/Documents and Settings/pjo/myprok/tmp/APP.exe"); 
```

错误字符串返回“未知错误”

我也尝试了 start 方法，但它永远不会起作用：

B 不工作代码：

```
 process.start("C:/Documents and Settings/pjo/myprok/tmp/APP.exe"); 
```

错误：找不到路径

```
 process.start("C:/DOCUME~1/pjo/myprok/tmp/APP.exe"); 
```

错误：未知错误

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T05:16:02.557

execute() 是一个静态函数，所以应该这样调用它：

```
QProcess::execute("C:/Documents and Settings/pjo/myprok/tmp/APP.exe"); 
```

您是说您以编程方式获取主目录，但您显示的代码并没有这样做。也许您正在创建这样的路径：

```
QProcess::execute(QDir::homePath() + "APP.exe"); 
```

然后路径将错过目录和文件名之间的 / ，如下所示：

```
"C:/Documents and Settings/pjo/myprok/tmpAPP.exe" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T15:18:09.053

您的问题可能是由于路径中的空格引起的引用问题（C:\Documents and Settings...）。注意 start() 有两个重载：

```
void    start ( const QString & program, OpenMode mode = ReadWrite )
void    start ( const QString & program, const QStringList & arguments, OpenMode mode = ReadWrite ) 
```

您正在使用第一个，它将可执行路径和所有参数放在一个字符串中，并希望它被正确引用。不加引号，“c:\documents”被解释为可执行文件，“and”“Settings...”等被解释为参数。

第二个版本分别采用参数，并将正确解释可执行路径，无需任何引用。因此，最简单的方法是使用

```
process.start("C:/Documents and Settings/pjo/myprok/tmp/APP.exe", QStringList()); 
```

这样可以确保使用第二个版本，并且可以避免所有引用问题。我建议始终使用该重载。

这同样适用于execute()，如前所述，它是一个静态方法，因此不会设置QProcess 对象的错误代码。

# objective-c - 在控制器的 .h 文件中定义的 IBOutlets 在 Inspector 中不可见

> ID：10404694
> 
> 赞同：0
> 
> 时间：2012-05-01T21:34:33.050
> 
> 标签：objective-c, xcode4

我正在使用 XCode4 和 Storyboard 创建一个 iPad 应用程序。我在 iPhone 上有完全相同的应用程序，效果很好。我将控制器的所有 .h 和 .m 文件复制到新的 iPad 应用程序中。没有构建错误。我在几个 UITableViews 中使用自定义单元格，带有原型单元格。

我在 .h 文件中定义了 4 个 IBOutlets，该文件包含在 UIView 控制器的 .h 文件中。我正在尝试将 IBOutlets 连接到原型单元格中的对象，但是当我单击控制器时，这些对象不会出现在检查器中。

知道为什么吗？

更新：这是 SiteListingCell.h 的代码。

```
#import <UIKit/UIKit.h>

@interface SiteListingsCell : UITableViewCell  {

}

@property (nonatomic, strong) IBOutlet UILabel *staLabel;
@property (nonatomic, strong) IBOutlet UILabel *descLabel;
@property (nonatomic, strong) IBOutlet UILabel *dateLabel;

@end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T22:47:21.517

确保您尝试连接的对象的类在 IB 中设置正确： ![在此处输入图像描述](../Images/e9281a5bf2b46cf8d50c9f41c5a1e10d.png)

# string - Win32 UTF-16 字符索引

> ID：10404695
> 
> 赞同：1
> 
> 时间：2012-05-01T21:34:35.873
> 
> 标签：string, winapi, unicode, utf-16

我刚开始使用 Win32 unicode 字符串 (UTF-16)。有什么方法可以快速获取字符串中任何特定字符的字节索引，因为某些字符可能使用四个字节（从我阅读 MSDN 收集的内容）？还是应该将它们都视为每个字符两个字节？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T21:46:55.677

CharNext [()](http://msdn.microsoft.com/en-us/library/windows/desktop/ms647469%28v=vs.85%29.aspx)和[CharPrev()](http://msdn.microsoft.com/en-us/library/windows/desktop/ms647471%28v=vs.85%29.aspx) API 可用于在 Windows 上安全地遍历 UNICODE 字符串。

要获取 UNICODE 字符串的第 n 个字符，请在循环中调用 CharNext()。

# asp.net - 如何使用 mvc 为 asp.net 成员构建 UI

> ID：10404696
> 
> 赞同：0
> 
> 时间：2012-05-01T21:34:37.340
> 
> 标签：asp.net, asp.net-mvc, membership-provider

我正在使用开箱即用的 asp.net 会员提供程序来管理我在我的网站上的登录。我想在我的应用程序中构建一个用户界面，以便我可以管理用户的权限/其他。最好是建立自己的会员提供商还是继续使用它？他们有什么“好的”参考资料让我开始吗？谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T21:51:52.193

Troy Goode 创建了一个不错的 NuGet 包，可以帮助您入门：

“入门工具包提供了管理用户和角色所需的 Asp.Net MVC 控制器、模型和视图。这个包包含 MvcMembership.Mvc 包所需的类，为 ASP.Net 的 MembershipProvider 和 RoleProvider 功能提供可测试的接口。”

[http://nuget.org/packages/MvcMembership](http://nuget.org/packages/MvcMembership)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T21:38:25.320

打我的鼓，但是：[http](http://websitemanager.codeplex.com/) ://websitemanager.codeplex.com/ :)

HTH。

# java - 将阵列保存到硬盘

> ID：10404698
> 
> 赞同：0
> 
> 时间：2012-05-01T21:34:41.460
> 
> 标签：java, arrays

我编写了一个使用 200 万个整数值数组的程序。但是，它一次只使用 200 个数组。我有 200 辆智能汽车在 10 000 个街区的地形上行驶（根据 GPS 值划分）。每个块都有一个包含整数值的 129x28 数组。当任何汽车移动到一个新块时，它必须检索与该块相关的数组，然后使用该数组中的值。然后它根据该值做出决定，然后继续前进，依此类推。所以整个系统有 200 辆汽车和 10000 个区块，而每辆汽车都有自己的数组不同值，数组的总数是 200 万。我需要在一个时间段简单地检索每辆车的 1 个数组 = 一次 200 个数组

数组将由应用程序创建并在开始时用零填充，然后应用程序将开始填充这些数组，最后它只会使用它们。所以我写了一个代码来在程序中创建这些数组。

我不能将数组存储在高清文件中并在需要时检索它们吗？

# 更新

由于我有 200 万个数组，并且无法在 1-1.9 秒内存储和检索 200 个数组，因此我将研究降级为使用较少的环境特征，最终使用了 200 万个大小为 7 x 28 的数组。其中使用了 7 * 28 * 10 000 * 4（整数）* 200（汽车）字节，如果 RAM 仅消耗 1.6 GB。如果你有类似的问题，祝你好运，如果你有类似的情况，请 PM，我希望我能提供帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T00:57:33.993

一种相当简单的解决方案是使用 ObjectOutputStream 和 ObjectInputStream 类来写入和读取您的数组。

下面是一些将数组写入磁盘的示例代码：

```
 int [][] array = new int [129] [28];
    // fill in your array here
    ObjectOutputStream out = new ObjectOutputStream(new FileOutputStream(fileName));
    out.writeObject(array);
    out.close(); 
```

下面是一些示例代码，用于从磁盘读取先前保存的数组：

```
 ObjectInputStream in = new ObjectInputStream(new FileInputStream(fileName));
    int [] [] inArray = (int [] []) in.readObject();
    in.close(); 
```

# javascript - Facebook是如何实现无限滚动的？

> ID：10404699
> 
> 赞同：9
> 
> 时间：2012-05-01T21:34:44.457
> 
> 标签：javascript, facebook, scroll, infinite-scroll

我的第一个问题是他们如何获得这个滚动条？

[http://dl.dropbox.com/u/12337149/scrollbar.png](http://dl.dropbox.com/u/12337149/scrollbar.png)

我在几个地方看过它，所以我想它可能在公共图书馆里？我的第二个问题与无限滚动本身有关。我又一次在几个网站上看到过它，所以它是一种相对常见并且在某处描述过的技术吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-01T21:58:33.187

你的意思是像 Twitter 上的“延迟加载”效果（当你滚动时，当你到达底部时它会加载更多）？他们使用[AJAX（异步 JavaScript 和 XML）](http://en.wikipedia.org/wiki/Ajax_%28programming%29)并测量何时到达底部并加载更多数据。但是他们使用 JSON，因为它对大多数人来说比 XML 更容易（但它仍然被称为 AJAX）。

有一个名为[Infinite Scroll](http://www.infinite-scroll.com/infinite-scroll-jquery-plugin/)的 jQuery 插件。

同样对于滚动条，它们就像 Mac OS X Lion 的滚动条（这很可能是他们得到这个想法的地方），这是关于它的另一篇[Stack Overflow 帖子](https://stackoverflow.com/questions/6863748/lion-like-scrollbar-with-jquery)。

我希望这有助于为您提供有关此内容的一些信息。

顺便说一句，如果你不知道 jQuery 是什么，它是一个很棒的 JavaScript 库，它可以让 JavaScript 中的一切变得更快。如果您从未使用过/听说过它，您应该在[jQuery.com上查看它。](http://jquery.com)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T21:45:12.370

AJAX（通常使用 XmlHttpRequest 原语实现；实际上使用 JSON 格式而不是 Xml）是在 javascript 中发出服务器请求而不重新加载页面并注册回调以处理响应的行为。当响应到达时，会使用数据调用回调，就像页面获取一样，但不会重新加载页面。

# javascript - 在同一页面上需要多个相同的 jQuery 效果

> ID：10404700
> 
> 赞同：0
> 
> 时间：2012-05-01T21:34:47.523
> 
> 标签：javascript, jquery, scroll

所以我正在使用这个 jquery 背景滚动器，基本上我想在同一页面上获得两个以上（以不同的速度进行），但我不知道该怎么做。

[http://www.devirtuoso.com/2009/07/how-to-build-an-animated-header-in-jquery/](http://www.devirtuoso.com/2009/07/how-to-build-an-animated-header-in-jquery/)

```
var scrollSpeed = 70;       // Speed in milliseconds
var step = 1;               // How many pixels to move per step
var current = 0;            // The current pixel row
var imageHeight = 4300;     // Background image height
var headerHeight = 300;     // How tall the header is.

//The pixel row where to start a new loop
var restartPosition = -(imageHeight - headerHeight);

function scrollBg(){

    //Go to next pixel row.
    current -= step;

    //If at the end of the image, then go to the top.
    if (current == restartPosition){
        current = 0;
    }

    //Set the CSS of the header.
    $('#header').css("background-position","0 "+current+"px");

}

//Calls the scrolling function repeatedly
var init = setInterval("scrollBg()", scrollSpeed); 
```

我可以将其他 css 添加到脚本中，但我希望其他 div 具有不同的速度。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T00:27:31.997

@andy，这是 Tom Th 的想法；即一个 js 构造函数，您可以从中实例化多个实例：

```
function bgScroller(options) {
    var settings = {
        containerID: '', //id of the scroller's containing element
        scrollSpeed: 50, //Speed in milliseconds
        step: 1, //How many pixels to move per step
        imageHeight: 0, //Background image height
        headerHeight: 0, //How tall the header is.
        autoStart: true
    };
    if(options) {
        jQuery.extend(settings, options);
    }
    var current = 0, // The current pixel row
        restartPosition = -(settings.imageHeight - settings.headerHeight), //The pixel row where to start a new loop 
        interval = null,
        $container = jQuery('#' + settings.containerID),
        that = {};
    if(!$container.length || !settings.imageHeight || !settings.headerHeight) {
        return false; //nothing will work without these settings so let's not even try
    }
    function setBg() {
        $container.css("background-position", "0 " + current + "px");
    }
    function scrollBg(){
        current -= settings.step;//Go to next pixel row.
        //If at the end of the image, then go to the top.
        if (current <= restartPosition){
            current = 0;
        }
        setBg();
    }
    that.reset = function() {
        that.stop();
        current = 0;
        setBg();
    }
    that.start = function() {
        interval = setInterval(scrollBg, settings.scrollSpeed);
    };
    that.stop = function(){
        clearInterval(interval);
    };
    that.reset();
    if(settings.autoStart) {
        that.start();
    }
    return that;
} 
```

参数作为对象文字“map”的属性传递，覆盖构造函数中的硬编码默认值。对于未包含的任何参数，将使用默认值。这里有几个例子：

```
var headerScroller = new bgScroller({
    containerID: "header",
    scrollSpeed: 70, //Speed in milliseconds
    imageHeight: 4300, //Background image height
    headerHeight: 300, //How tall the header is.
});
var otherScroller = new bgScroller({
    containerID: "myOtherDiv",
    scrollSpeed: 30, //Speed in milliseconds
    imageHeight: 2800, //Background image height
    headerHeight: 200, //How tall the header is.
}); 
```

我已经包含了三个公共方法；`.reset()`,`.start()`和`.stop()`, 在实例化后提供对滚动条的有限控制。使用如下：

*   `headerScroller.stop();`
*   `headerScroller.reset();`
*   `headerScroller.start();`

笔记：

*   工作演示[在这里](http://jsfiddle.net/VfMkt/3/)。
*   依赖：jQuery 1.0 或更高版本
*   `.reset()`自动调用`.stop()`，因此无需`.stop()`事先调用。
*   没有规定在实例化后更改设置，但稍加考虑就可以做到这一点。
*   jQuery 插件将是类似的，但会花费更多时间来开发（几乎没有优势）。

# vim - vim: gp 在段落上

> ID：10404702
> 
> 赞同：2
> 
> 时间：2012-05-01T21:34:51.977
> 
> 标签：vim, paragraph

在我使用的 vim

```
Vj..jgp 
```

或者

```
Vk..kgp 
```

为选定的段落和格式。
如何更快地选择和格式化段落？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T21:38:49.853

尝试

```
gqq 
```

或者

```
{gq} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T21:38:59.127

正如 El Isra 在评论中所建议的那样，您可以做`gqap`而不是`vapgq`避免不必要地进入视觉模式。其他一些有用的变体`ap`包括`aw`(select a word) `as`(select a sentence)、`ab`(select a `()`block) 和`aB`(select a `{}`block)。有许多插件也为 HTML 标签扩展了此功能，因此您可能有兴趣搜索这些。

**编辑：**更改`V`为`v`.

**编辑 2：**更改`vgaqp`为`gqap`.

# ios - 发送 iOS GameKit 消息所需的时间

> ID：10404703
> 
> 赞同：0
> 
> 时间：2012-05-01T21:34:53.800
> 
> 标签：ios, gamekit, core-bluetooth

所以我正在尝试编写一个简单的应用程序，它将连接到另一部 iPhone 并通过蓝牙发送消息，似乎最好的方法是使用 GameKit。如果我错了，请在阅读整个问题之前指出我正确的方向，哈哈。

## 两个要求是：

1.  iPhone 到 iPhone，相同的应用程序（简单）
2.  我可以获得发送不可靠消息所需的时间（不容易）

根据我所做的（少量）研究，我将假设在 GameKit 上这是不可能的，而且我还没有找到关于 CoreBluetooth 框架的好的指南。再一次，如果你能指出我正确的方向，那将不胜感激。

TL;DR：有没有办法使用 GameKit 来计算发送不可靠的小消息需要多长时间？如果没有，我可以用 CoreBluetooth 做到这一点吗？

-杰克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T21:44:06.877

这感觉像是一个奇怪的问题，你想知道，两部手机之间发送消息需要多长时间？

这样做的方法是在客户端和服务器之间建立一个 ping，服务器会 ping 客户端，然后客户端立即将响应发送回服务器，服务器将总时间除以 2。

# c# - 将数据集转换为 ListItem

> ID：10404704
> 
> 赞同：0
> 
> 时间：2012-05-01T21:34:54.740
> 
> 标签：c#, .net

如何使用 C#.NET 将 DATASET 转换为 LISTETEM，或者有什么方法可以使用 xmltextreader 读取 xmlfile 并将该数据上传到列表项中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T22:25:57.497

由于您的问题相对模糊，因此实际实施会有所不同。

您可以简单地遍历 DataSet 中的 DataRows：

```
foreach(DataRow row in ds.Tables[0].Rows) 
```

您可以使用 XMLDocument 并使用 Linq-to-Xml 来做同样的事情。如果您遇到问题，请发布代码。

# core-data - 如何在 XCode 4 中删除获取请求

> ID：10404705
> 
> 赞同：1
> 
> 时间：2012-05-01T21:34:57.820
> 
> 标签：core-data, xcode4

我是 XCode 4 中数据模型编辑器的新用户。如何删除我不想要的获取请求？很难弄清楚如何添加一个（单击并按住“创建实体”按钮！）。但是现在我已经创建了一个，我无法为我的生活弄清楚如何摆脱它。

我也很欣赏关于构建谓词的好教程的指针。例如，回答您如何测试日期属性中的年份 == 某些东西和类似问题的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T22:22:30.507

1.  选择获取请求。
2.  点击删除或退格。

享受。

*PS：~~您也可以从编辑菜单中选择删除，~~而不是 2 。
值得注意的是，这个命令从 1984 年就已经存在了。;-)*

至于您的其他问题：查看 Apple 的[Predicate Programming Guide](http://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/Predicates/predicates.html#//apple_ref/doc/uid/TP40001789)。要在日期中搜索一年，您可以执行以下操作

```
[NSPredicate predicateWithFormat:
   @"date > %@ AND date < %@", janFirstYear1, janFirstYear2]; 
```

# iphone - iPhone - MessageUI 框架中的泄漏？

> ID：10404706
> 
> 赞同：3
> 
> 时间：2012-05-01T21:34:59.510
> 
> 标签：iphone, email, messageui

我使用**MFMailComposeViewController**在我的应用程序中发送电子邮件。
当我使用**Instruments**运行我的应用程序时，
我在点击发送电子邮件后看到了泄漏。

```
Leaked Object   #   Address Size    Responsible Library Responsible Frame

MutableMessageHeaders,1 0x6be950    32 Bytes    MessageUI   +[MFComposeTypeFactory headersFromDelegate:]

_MFOutgoingMessageBody,1    0x1190ed0   32 Bytes    Message -[MessageWriter createMessageWithPlainTextDocumentsAndAttachments:headers:] 
```

你知道如何修复它，
这是 MessageUI 框架中的泄漏吗？

```
- (void)showMailComposer
{
        MFMailComposeViewController *picker = [[MFMailComposeViewController alloc] init];
        picker.mailComposeDelegate = self;
        [picker setSubject:@"Subject"];
        NSString *emailBody = @"Email body";
        [picker setMessageBody:emailBody isHTML:NO];
        [self presentModalViewController:picker animated:YES];
        [picker release];
}

#pragma mark -
#pragma mark Dismiss Mail/SMS view controller

    // Dismisses the email composition interface when users tap Cancel or Send. Proceeds to update the 
    // message field with the result of the operation.
    - (void)mailComposeController:(MFMailComposeViewController*)controller 
              didFinishWithResult:(MFMailComposeResult)result error:(NSError*)error 
{
            [self dismissModalViewControllerAnimated:YES];
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T21:53:33.737

是的，看起来像。但是，每发送一封电子邮件总共有 64 个字节，这不是您应该担心的。

# java - JTable以不希望的顺序排序int

> ID：10404713
> 
> 赞同：1
> 
> 时间：2012-05-01T21:35:40.493
> 
> 标签：java, swing, jtable

我正在尝试创建一个`JTable`与`DefaultTableModel`. 我的问题是，当我单击对其进行排序（带有价格的行）时，它的排序不正确。

假设我们有行：

```
2
6
3
112
42
1 
```

我想要的是：

```
1
2
3
6
42
112 
```

我得到什么：

```
1
112
2
3
42
6 
```

有什么建议或解决方案吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-01T21:41:04.620

我的一个项目代码库中的一个示例。这属于您的 TableModel

```
 @Override
    public Class<?> getColumnClass(int col) {
            switch (col) {
                case 0:
                    return Integer.class;
                case 1:
                    return String.class;
                case 2:
                    return String.class;
                case 3:
                    return Integer.class;
            }
    } 
```

# algorithm - graph - 添加新边后更新最小生成树的实现

> ID：10404714
> 
> 赞同：1
> 
> 时间：2012-05-01T21:35:46.670
> 
> 标签：algorithm, data-structures, graph, minimum-spanning-tree

这是消费税

> 假设给定图 G 的最小生成树 T（具有 n 个顶点和 m 个边）和一条权重为 w 的新边 e = (u, v)，我们将添加到 G。给出一个有效的算法来找到图 G + e 的最小生成树。**你的算法应该在 O(n) 时间内运行以获得完整的信用。**

我有这个想法：

`In the MST, just find out the path between u and v. Then find the edge (along the path) with maximum weight; if the maximum weight is bigger than w, then remove that edge from the MST and add the new edge to the MST.`

* * *

棘手的部分是如何在 O(n) 时间内做到这一点，而且我也被卡住了。

问题是如何存储 MST。在普通 Prim 算法中，MST 被存储为父数组，即每个元素都是相应顶点的父元素。

所以假设消费税给了我一个指示 MST 的父数组，我怎样才能在 O(n) 中释放上述算法？

首先，如何从父数组中识别 u 和 v 之间的路径？我可以为 u 和 v 设置两个祖先数组，然后检查共同的祖先，然后我可以获得路径，尽管是向后的。我认为对于这部分，要找到共同的祖先，至少我必须在 O(n^2) 内完成，对吧？

然后，我们有了路径。但是我们仍然需要找到沿路径的每条边的权重。由于我认为该图将使用 Prim 算法的邻接列表，因此我们必须执行 O(m)（m 是边数）来定位边的每个权重。

...

所以我认为不可能在 O(n) 中执行该算法。我错了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T22:12:11.440

你的想法是对的。请注意，找到 和 之间的`u`路径`v`是`O(n)`。我假设你有一个`parent array`识别 MST。跟踪从`u`to`v`或`u`to的路径（对于最大边缘）`root vertex`应该只需要`O(n)`. 如果您到达`root vertex`，只需跟踪从`v`到`u`或的路径`root vertex`。

现在您有了来自 的路径`u -> u1 ... -> max_path_vert1 -> max_path_vert2 -> ... -> v`，删除边缘`max_path_vert1->max_path_vert2`（假设这大于添加的边缘）并反转父级`u->...->max_path_vert1`并标记`parent[u] = v`。

编辑：为了清楚起见，更多解释

请注意，在 MST 中，任何一对顶点之间都只有一条路径。因此，如果您可以从`u->y`和追踪，那么您最多`v->y`只能追踪到`n`顶点。如果您跟踪了多个`n`顶点，则意味着您访问了两次顶点，这在 MST 中不会发生。好的，现在希望您确信从`u->y`和跟踪它是 O(n) `v->y`。一旦你有了这些路径，你就建立了一个从`u->v`. 你怎么看？我假设这是一个无向图，因为为有向图查找 MST 本身就是一个不同的概念。对于无向图，当您有一条来自 的路径时，您就有一条来自`x->y`的路径`y-x`。所以，`u->y->v`存在。您甚至不需要从 追溯`y->v`，因为 for 的权重`v->y`与 的相同`y->v`. `u->y`当您从和跟踪时，只需找到具有最大权重的边`v->y`。

现在在 O(1) 中寻找边权重；您如何存储当前的重量？邻接表还是邻接矩阵？对于 O(1) 访问，以存储父顶点数组的方式存储它。所以，`weight[v] = weight(v, parent[v])`。因此，您将拥有 O(1) 访问权限。希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T22:15:49.350

好吧-您的解决方案是正确的。

但是关于实现，我不明白为什么要使用 G 而不是 T 来查找 u 和 v 之间的路径。使用 T 中的任何搜索遍历来查找 u 和 v 之间的路径，将为您提供 O(n)。- 也就是说，您可以假设 v 是根并执行深度优先搜索算法[在这种情况下，您必须假设 v 的所有邻居都是孩子] - 一旦找到 u，就停止 DFS - 然后，堆栈中的节点对应于 u 和 v 之间的路径。

之后很容易找到路径中每条边的成本 (O(n))，删除/添加边也很容易。总共 O(n)。

这有什么帮助吗？

或者，也许你得到 O(n^2) - 根据我的理解 - 因为你在 O(n) 中访问 T 中的顶点 v 的子级 - 在这里，你必须将你的数据结构呈现为映射数组，以便成本降低到 O(1)。[例如，{a,b,c,u,w}（顶点）-> {0,1,2,3,4}（顶点索引）。

# sql - 修改具有 IDENTITY 属性的列中的数据条目

> ID：10404716
> 
> 赞同：1
> 
> 时间：2012-05-01T21:35:58.333
> 
> 标签：sql, sql-server, sql-server-2008, stored-procedures

我需要创建一个名为“PROCESS”的表，它的主键由两列（IdOffice，IdProcess）组成，问题是我需要“IdProcess”包含IDENTITY属性并一一增加但取决于字段的值“IdOffice”如下：

如果“IdOffice”相同，则“IdProcess”必须逐个增加，所以我放一张图更清楚：

![在此处输入链接描述](../Images/dc39a8f1c6d1f1c05d0eff03831b6ee6.png)

我该怎么做？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T21:39:37.307

你不能用 IDENTITY 做到这一点。您需要有一个单独的列。问题是这可能很难维护。如果你有这样的数据：

```
IdOffice  IdProcess
--------- ----------
1         1
1         2
1         3
2         1 
2         2 
```

删除第二行时会发生什么？是否需要为 IdOffice = 1 的所有值重新计算 IdProcess？

假设您有其他一些列要排序，您总是可以在查询时生成这个数字，而不是支付存储它的成本并在表更改时处理维护。

```
SELECT IdOffice, IdProcess = ROW_NUMBER() OVER 
  (PARTITION BY IdOffice ORDER BY DateCreated)
 FROM  dbo.YourTable
 ORDER BY IdOffice, IdProcess; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T21:45:41.200

我还建议您为此表设置一个作为身份的主键。然后将 IdOffice 和 IdProcess 视为行中的数据。如果您这样做，那么 Aaron 在查询时计算 IdProcess 的建议就更有意义了。

# php - 使用 MySQL 和 PHP 的 JQuery 轮询。如何？

> ID：10404721
> 
> 赞同：0
> 
> 时间：2012-05-01T21:36:15.993
> 
> 标签：php, jquery, mysql

我已经找到了各种方法来在网站上轮询 MySQL，无论好坏，而且大多是 2 岁。

我想看一个如何正确轮询服务器的示例。

我有一个 MySQL 表，其中插入了注释。我想在 JQuery 中看到一个关于如何轮询此服务器并附加到 DIV 的示例，只有自上次轮询检查以来插入表中的新评论，而不是每 5 秒显示最后 10 个条目。

一个非 setInterval 示例将是理想的，因为我读过 setInterval 不关心在发出另一个请求之前请求是否成功。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T21:51:00.083

您必须向服务器端脚本发送 AJAX 请求，该脚本将检查数据库中的新评论并将其返回 JSON 编码。

要仅获取最新评论，请在客户端代码上维护最后一次评论获取的时间戳。下次您请求评论时，请传递此时间戳。您的服务器端脚本只会返回时间戳大于传入参数的注释。

`setInterval`您可以在成功处理程序中重新提交 AJAX 请求，而不是使用。

```
function ajaxRequest(timestamp) {
    $.ajax({
        url : 'url_to_post?timestamp=' + timestamp,
        success : function(response){
            //handle the new comments here
            //call this function again
            //sleep for 3 seconds first
            setTimeout(function(){
                timestamp += 3000;
                ajaxRequest(timestamp);
            },3000);

        }

    });
} 
```

# jquery - Yii中的jquery冲突

> ID：10404722
> 
> 赞同：0
> 
> 时间：2012-05-01T21:36:26.950
> 
> 标签：jquery, yii

我有一个问题，当我尝试使用使用 jquery 的外部脚本时，比如我拥有的一些 caruslle 脚本。我有一个布局，我想把它转换成 yii，它有一些使用 jquery 的脚本，比如 carousels 等等。

现在 yii 会自动嵌入 jquery。问题是如果我手动嵌入 jquery，脚本可以工作，但 yii 脚本不能。如果我不嵌入 jquery，yii 脚本可以工作（如 ajax 验证）而我的脚本不能。就像这样：我的作品

```
<link rel="stylesheet" type="text/css" href="/kav4/assets/8ff498f/css/redmond/jquery-ui.css" />
<script type="text/javascript" src="/kav4/assets/91eebf0f/jquery.js"></script>
<script type="text/javascript" src="/kav4/assets/91eebf0f/jquery.yiiactiveform.js"></script>
<script type="text/javascript" src="/kav4/assets/8ff498f/js/jquery-ui.min.js"></script>
<script type="text/javascript" src="js/jquery.min.js"></script>
<script type="text/javascript" src="js/jquery-ui.min.js"></script> 
```

像这样：yii 工作

```
<link rel="stylesheet" type="text/css" href="/kav4/assets/8ff498f/css/redmond/jquery-ui.css" />
<script type="text/javascript" src="/kav4/assets/91eebf0f/jquery.js"></script>
<script type="text/javascript" src="/kav4/assets/91eebf0f/jquery.yiiactiveform.js"></script>
<script type="text/javascript" src="/kav4/assets/8ff498f/js/jquery-ui.min.js"></script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T21:42:30.643

您可以在此处查看我的答案[如果您在页面中包含 2 个版本的 jQuery，您如何将插件限制为其中一个？](https://stackoverflow.com/questions/5071717/if-you-include-2-version-of-jquery-in-a-page-how-do-you-restrict-a-plugin-to-jus/5071837#5071837)

它显示了如何在同一页面中包含两个不同版本的 jquery

# php - Curl PHP http_code 说 404 但浏览器说是 200

> ID：10404727
> 
> 赞同：3
> 
> 时间：2012-05-01T21:36:46.497
> 
> 标签：php, http, curl

**我发现了为什么会这样，检查我的答案**

这是发生这种情况的唯一域，我在一堆 URL 上运行 curl_multi，这个返回 404 http_code [http://www.breaknews.com](http://www.breakingnews.com)

但是当我在浏览器中访问它时，它是 200OK（需要一段时间才能加载）并且看起来甚至不像重定向。

有谁知道怎么回事？这是个常见的问题吗

这是一个 var_dump：

```
 ["info"]=> array(22) { ["url"]=> string(27) "http://www.breakingnews.com" ["content_type"]=> string(24) "text/html; charset=utf-8" ["http_code"]=> int(404) ["header_size"]=> int(337) ["request_size"]=> int(128) ["filetime"]=> int(-1) ["ssl_verify_result"]=> int(0) ["redirect_count"]=> int(0) ["total_time"]=> float(1.152229) ["namelookup_time"]=> float(0.001261) ["connect_time"]=> float(0.020121) ["pretransfer_time"]=> float(0.020179) ["size_upload"]=> float(0) ["size_download"]=> float(9755) ["speed_download"]=> float(8466) ["speed_upload"]=> float(0) ["download_content_length"]=> float(-1) ["upload_content_length"]=> float(0) ["starttransfer_time"]=> float(1.133522) ["redirect_time"]=> float(0) ["certinfo"]=> array(0) { } ["redirect_url"]=> string(0) "" } ["error"]=> string(0) "" 
```

~~更新：这实际上看起来像 curl_setopt($ch, CURLOPT_NOBODY, true); 的 php 错误 [https://bugs.php.net/bug.php?id=39611](https://bugs.php.net/bug.php?id=39611)~~

编辑：这不是错误。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-09T02:26:10.800

**我在这里的评论中找到了答案[http://w-shadow.com/blog/2007/08/02/how-to-check-if-page-exists-with-curl/comment-page-1/#comment -12186](http://w-shadow.com/blog/2007/08/02/how-to-check-if-page-exists-with-curl/comment-page-1/#comment-12186) 通过将 CURLOPT_NOBODY 设置为 true，CURL 将使用 HEAD 来处理某些服务器不喜欢的请求（例如，福布斯），并将返回“Emply reply from server”。要修复，您还需要设置 CURLOPT_HTTPGET 以重置回 GET 请求。**

```
/* don’t download the page, just the header (much faster in this case) */
curl_setopt($ch, CURLOPT_NOBODY, true);
curl_setopt($ch, CURLOPT_HEADER, true);
curl_setopt($ch, CURLOPT_HTTPGET, true); //this is needed to fix the issue 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T22:34:22.330

我不确定你的代码是什么样的，但这很好用

```
$url = "http://www.breakingnews.com";
$ch = curl_init ( $url );
curl_setopt ( $ch, CURLOPT_USERAGENT, "Mozilla/5.0 (Windows; U; Windows NT 5.1; pl; rv:1.9) Gecko/2008052906 Firefox/3.0" );
curl_setopt ( $ch, CURLOPT_AUTOREFERER, true );
curl_setopt ( $ch, CURLOPT_FOLLOWLOCATION, true );
curl_setopt ( $ch, CURLOPT_RETURNTRANSFER, 1 );

curl_exec ( $ch );
var_dump ( curl_getinfo ( $ch ) );
if (curl_errno ( $ch )) {
    print curl_error ( $ch );
} else {
    curl_close ( $ch );
} 
```

输出

```
array
  'url' => string 'http://www.breakingnews.com' (length=27)
  'content_type' => string 'text/html; charset=utf-8' (length=24)
  'http_code' => int 200
  'header_size' => int 330
  'request_size' => int 154
  'filetime' => int -1
  'ssl_verify_result' => int 0
  'redirect_count' => int 0
  'total_time' => float 4.243
  'namelookup_time' => float 0.171
  'connect_time' => float 0.374
  'pretransfer_time' => float 0.374
  'size_upload' => float 0
  'size_download' => float 68638
  'speed_download' => float 16176
  'speed_upload' => float 0
  'download_content_length' => float -1
  'upload_content_length' => float 0
  'starttransfer_time' => float 3.681
  'redirect_time' => float 0
  'certinfo' => 
    array
      empty
  'redirect_url' => string '' (length=0) 
```

# java - Java变形器将复数转换为单数形式

> ID：10404731
> 
> 赞同：1
> 
> 时间：2012-05-01T21:37:07.950
> 
> 标签：java, inflector

我正在使用[Java Inflector 库](http://www.jarvana.com/jarvana/browse/net/java/dev/inflector/inflector/0.7.0/)将单数形式转换为复数形式，例如：2boat => 2boats。但是，当输入已经是复数时，它会失败。1 船 => 船，蝴蝶 => 蝴蝶

是否有任何其他 Java 实用程序 - 1\. 必要时将复数转换为单数，例如：1boat =>boat 2\. 如果需要复数形式，则保留复数形式。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T21:49:17.957

你知道的，你可以做一个模拟，首先避免转换已经是复数的动词，如何？取动词并将其转换为单数，然后将其转换为复数并检查结果字符串是否与输入中的字符串相同，如果不是，那没关系，知道你知道那不是复数。

# android - 获取WIFI中所有已连接设备的信息-连接

> ID：10404734
> 
> 赞同：0
> 
> 时间：2012-05-01T21:37:19.350
> 
> 标签：android, device, network-scan

我将创建一个分析当前连接的 wifi 网络的应用程序。取而代之的是，我希望获得许多连接在该网络中的所有设备，这些设备也与我的 android 手机连接。

一种可能性是在我的网络中对所有可能的 ips 进行 ping 操作，但如果我在“a”类网络中，我必须检查超过 17 mio 的 ips，这将花费很多时间......

即信息：在路由器 192.168.2.1 的文本框中连接了 20 个设备

# javascript - 上传 S3 knox 节点 js（签名不匹配）

> ID：10404737
> 
> 赞同：1
> 
> 时间：2012-05-01T21:37:30.350
> 
> 标签：javascript, node.js, amazon-s3, knox-amazon-s3-client

我已经尝试了很多天，使用[knox](https://github.com/LearnBoost/knox)和 node js 将文件（message.txt）上传到 aws s3。

我一直有签名不匹配错误。

我在节点 js 中的代码（上传不起作用，所以我只是想获取）：

```
var client = knox.createClient({
    key: 'myAWSkey'
  , secret: 'mySecretKey'
  , bucket: 'mybucket'
  , endpoint: 'mybucket.s3-eu-west-1.amazonaws.com'
});
client.get('/').on('response', function(res){
  console.log(res.statusCode);
  console.log(res.headers);
  res.setEncoding('utf8');
  res.on('data', function(chunk){
    console.log(chunk);
  });
}).end(); 
```

我还尝试了亚马逊将[测试签名](http://aws.amazon.com/code/199)与许多不同的方法进行比较，例如：[html 和 python 版本](http://aws.amazon.com/articles/1434)

没有什么对我有用，我可能在这个过程中有点迷失......如果有人能给我一些大行来指导我和/或一个脚本来正确地在 javascript/node js 中生成签名，我将非常感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-07T07:07:23.647

您可能想尝试 AwsSum 库。它得到了积极的维护，还附带了大量示例和另一个具有更全功能脚本的 repo。

*   [https://github.com/appsattic/node-awssum/](https://github.com/appsattic/node-awssum/)

根据您的需要，脚本存储库（单独的 GitHub 项目）中有一个示例上传脚本：

*   [https://github.com/appsattic/node-awssum-scripts/blob/master/bin/amazon-s3-upload.js](https://github.com/appsattic/node-awssum-scripts/blob/master/bin/amazon-s3-upload.js)

让我知道您是否需要任何帮助或者您是否顺利。免责声明：我是 AwsSum 的作者。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-05T03:00:25.647

我只是在这个问题上挣扎了几天。假设您使用的是 Windows，这似乎是 Knox 的问题。显然问题已经解决了，但是解决方案还没有拉入主项目。

看到这个线程：[https ://github.com/LearnBoost/knox/issues/56](https://github.com/LearnBoost/knox/issues/56)

我的解决方法是删除 knox 库并将此存储库克隆到我的 node_modules 文件夹中：[https ://github.com/domenic/knox.git](https://github.com/domenic/knox.git)

希望有帮助！

# linux - 查找具有特定属性的文件

> ID：10404743
> 
> 赞同：2
> 
> 时间：2012-05-01T21:37:54.623
> 
> 标签：linux, shell, command-line, find

我想使用以下属性递归地查找当前目录中的所有文件：

*   在过去 10 天内创建
*   是htm还是html文件
*   里面有以下文字：
    *   var iw=文档；iw['写']

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T21:46:40.910

这应该很接近：

```
 find . -ctime -10 -and \
        \( -iname '*.html' -or -iname '*.htm' \) -print0 | \
    xargs -0 egrep -l "var iw=document;iw\[.*write" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T21:44:28.317

听起来好像你想要这样的东西：

```
find . -mtime 10 -and \( -iname '*.html' -or -iname '*.htm' \) -print0 | xargs -0 egrep -H "var iw=document;iw\[.*write" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T13:49:37.080

`xargs`有点多余。

```
find . -ctime -10 -and \
    ( -iname '*.html' -or -iname '*.htm' \) \
     -exec fgrep -l "var iw=document;iw['write']" {} + 
```

# c - 在配置脚本中处理 CFLAGS 的最佳实践？

> ID：10404746
> 
> 赞同：18
> 
> 时间：2012-05-01T21:38:12.190
> 
> 标签：c, build, makefile, configure, autoconf

我不是 autoconf 的粉丝，但为了最不意外的原则，我试图让我的（非 autoconf）配置脚本的行为尽可能接近用户对基于 autoconf 的构建系统的期望。GNU 编码标准在这个主题上实际上是相当合理的，并明确提到不使用 autoconf/automake 而是以另一种方式提供兼容接口的可能性：

[https://www.gnu.org/prep/standards/standards.html#Configuration](https://www.gnu.org/prep/standards/standards.html#Configuration)

然而，我找不到任何好的描述的一个问题是如何最好地处理 CFLAGS。我很清楚，任何与用户无关的*基本*标志（如`-I$(srcdir)/inc`）都不属于配置脚本或 makefile 中的 CFLAGS，因为覆盖它们会完全破坏构建。所以这些我要么在makefile中硬编码，要么（如果它们需要一些检测）将检测逻辑放在configure中，但是通过一个单独的make变量而不是CFLAGS传递它们，这样它们就不会被覆盖。

不过，我仍然不清楚如何最好地处理是可选的东西，比如优化级别/选项、警告标志、调试等。标志应该由诸如此类的东西启用，`--enable-debug`或者`--enable-warnings`添加到`CFLAGS`或传递到其他一些 make 变量中吗？如果它们与 user-provided 中已经存在的标志冲突`CFLAGS`怎么办？

我可以看到很多项目的答案可能应该是“根本不要弄乱它，让用户选择他们的`CFLAGS`”，但我的一些用例是用户群通常有兴趣的项目开箱即用的优化和调试配置。

**编辑：**我忘记的另一个问题：在检测和自动使用某些非必需但首选的 CFLAGS 时，是否应该仅在用户`CFLAGS`在环境中留空时才这样做，还是总是？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-02T13:14:28.707

如果你想处理像 --enable-warnings 这样的参数，你有很多工作要做。如果你想保持简单，你可以让那个参数添加类似

```
CFLAGS="$CFLAGS -Wall -Wextra"; CPPFLAGS="$CPPFLAGS -DWARNINGS" 
```

在您的配置脚本中，但这实际上会打开一大堆蠕虫。这些选项是否被所有编译器识别，或者您是否假设您的用户使用的编译器可以识别这些选项并且他们可以按照您的意愿进行操作？可能您需要将该分配包装在另一个检查中，以检查您知道的一组编译器。或者您需要检查用户使用的编译器在传递这些标志时至少不会出错（也许用户已经在 CFLAGS 中设置了 -Wsome，并且编译器将使用冲突的参数出错 -墙。）同样的问题也适用于 --enable-debug。通过将 -DEBUG 附加到 CPPFLAGS 来响应 --enable-debug 似乎是完全合理的，因此用户不需要检查您的源来确定是否通过 -DEBUG 而不是 -DDEBUG 启用了调试，*不要*做这样的事情。

如果您希望您的用户拥有“开箱即用的优化和调试配置”，那么项目的配置脚本是*错误*的地方。保持配置简单，让用户使用像 pkgsrc 这样的包管理系统来处理这些事情。如果您希望您的分发 tarball 具有某些功能，请为为用户和从而提供所需的功能。但是请保持配置脚本本身的基本内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T17:07:30.640

让用户期望在提供自定义标志时不得不与事情搏斗是足够理智的。`CFLAGS`可以*附加*，`CPPFLAGS`可以*附加*（标题搜索路径选项查看第*一个*路径，而编译器优化和指令查看*最后一个*选项（或者更确切地说，它们覆盖先前的选项））

`--enable-debug`也许提供给配置脚本的其他命令行指令不仅需要更改编译器选项，而且还可能更改源代码中的内容（例如，将内联宏重新定义为实际函数），因此它们的用途有些不同。

总之，有用户指定的`CPPFLAGS`前置，用户指定的`CFLAGS`附加；根据上下文，任何配置脚本选项都可以附加或附加。

# mongodb - MongoDB Map/Reduce

> ID：10404748
> 
> 赞同：1
> 
> 时间：2012-05-01T21:38:25.440
> 
> 标签：mongodb, mapreduce, mongodb-query, nosql

我正在尝试在 mongoDB 中找出这个 map/reduce 系统。我的收藏中有以下基本架构/布局。

```
{
    _id: 1,
    name: n1,
    website: w1,
    tags: [
        myTag1,
        myTag3
    ]
}

{
    _id: 2,
    name: n2,
    website: w2,
    tags: [
        myTag2,
        myTag3
    ]
}

{
    _id: 3,
    name: n3,
    website: w3,
    tags: [
        myTag2,
        myTag4
    ]
} 
```

如何检索一组唯一标签？我希望将其退还给我以供进一步使用。

```
{
    tags: [
        myTag1,
        myTag2,
        myTag3,
        myTag4
    ]
} 
```

顺便说一句，这就是我想出的，但它只返回每个项目的 _id 和标签，而不是将标签组合成一个对象。

```
var map = function() {emit( this._id,{tags: this.tags});};

var reduce = function(key, values) {
    var t = [];

    values.forEach(function(doc) {
        var tags = doc.tags;
        tags.forEach(function(tag) {
            if (!(tag in t)) {
                t.push(tag);
            }
        });
    });

    return {tags: t};
};

var op = db.businesses.mapReduce(map, reduce, {out: "mr_results"});

db[op.result].find(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T21:48:16.893

在您的情况下，无需使用 map-reduce。只需使用以下`distinct`功能：

```
db.businesses.distinct('tags') 
```

您可以在 mongo shell 中尝试：

```
> use test
switched to db test
> db.businesses.insert({tags: ['tag1', 'tag2']})
> db.businesses.insert({tags: ['tag3', 'tag4']})
> db.businesses.find()
{ "_id" : ObjectId("4fa05b2b036495bf4ac9c0cc"), "tags" : [ "tag1", "tag2" ] }
{ "_id" : ObjectId("4fa05b33036495bf4ac9c0cd"), "tags" : [ "tag3", "tag4" ] }

> db.businesses.distinct('tags')
[ "tag1", "tag2", "tag3", "tag4" ] 
```

另外，您应该记住，MongoDB 中的 map/reduce 不适合实时查询。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T22:36:07.743

使用[MongoDB MapReduce](http://www.mongodb.org/display/DOCS/MapReduce)你可以这样做：

```
function m() {
  this.tags.forEach(function(x) { emit('tag', x); });
}
function r(k, v) {
  var res = {};
  v.forEach(function(x) { res[x] = true; });
  return res;
}
db.businesses.mapReduce(m, r, {out:'out'});
// Now the 'out' collection has a record whose "value" property
// has a key for each of the tags in the source collection.
function getTags(coll) {
  var tags=[], o=db[coll].find()[0].value;
  for (var i in o) { tags.push(i) }
  return tags; // Same as Object.keys(db[coll].find()[0].value)
}
listTags('out'); // => ['myTag1', 'myTag2', 'myTag3', 'myTag4'] 
```

# javascript - 如何将变量值用作正则表达式模式

> ID：10404749
> 
> 赞同：0
> 
> 时间：2012-05-01T21:38:31.790
> 
> 标签：javascript, regex, replace

我很绝望——我看不出我做错了什么。我尝试替换所有出现的 '8969' 但我总是得到原始字符串（无论 tmp 是字符串还是 int）。也许已经太晚了，也许我是瞎子，...

```
var tmp = "8969";
alert("8969_8969".replace(/tmp/g, "99")); 
```

有人可以帮我吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-01T21:40:42.260

在这种`/`情况下，字符是正则表达式的容器。因此，'tmp' 不用作变量，而是用作文字字符串。

```
var tmp = /8969/g;
alert("8969_8969".replace(tmp, "99")); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-01T21:39:40.240

```
alert("8969_8969".replace(/8969/g, "99")); 
```

或者

```
var tmp = "8969"
alert("8969_8969".replace(new RegExp(tmp,"g"), "99")); 
```

[**现场演示**](http://jsfiddle.net/Z3EGn/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-01T21:41:15.007

处理正则表达式的动态方式：

```
var nRegExp = new RegExp("8969", 'g');
alert("8969_8969".replace(nRegExp, "99")); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-01T21:41:22.313

`/tmp/g`. 这是一个寻找短语的正则表达式`"tmp"`。您需要使用`new RegExp`来制作动态正则表达式。

```
alert("8969_8969".replace(new RegExp(tmp,'g'), "99")); 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-05-01T21:41:57.820

Javascript 不支持tmp**的**使用，它会尝试按字面意思使用 'tmp' 作为正则表达式模式。

```
"8969_8969".replace(new RegExp(tmp,'g'), "99") 
```

# php - 从 URL 正则表达式模式获取 YouTube ID

> ID：10404752
> 
> 赞同：0
> 
> 时间：2012-05-01T21:38:47.380
> 
> 标签：php, regex, youtube

我在网站上看到了几个不同的示例，但它并没有从所有 youtube 选项中获取 id ......例如，以下链接不适用于下面的正则表达式模式。任何帮助都会很棒。提前致谢：

如果用户访问 youtube 主页并单击其中一个他们提供此 url 的视频，它似乎就是这个： [http ://www.youtube.com/watch?v=hLSoU53DXK8&feature=g-vrec](http://www.youtube.com/watch?v=hLSoU53DXK8&feature=g-vrec)

我的正则表达式将其放入数据库中：hLSoU53DXK8-vrec，我需要它而不需要-vrec。

```
// YOUTUBE
$youtube = $_POST['youtube'];

 function getYoutubeId($youtube) {
    $url = parse_url($youtube);
    if($url['host'] !== 'youtube.com' &&
             $url['host'] !== 'www.youtube.com'&&
             $url['host'] !== 'youtu.be'&&
             $url['host'] !== 'www.youtu.be')
        return false;
    $youtube = preg_replace('~
        # Match non-linked youtube URL in the wild. (Rev:20111012)
        https?://         # Required scheme. Either http or https.
        (?:[0-9A-Z-]+\.)? # Optional subdomain.
        (?:               # Group host alternatives.
          youtu\.be/      # Either youtu.be,
        | youtube\.com    # or youtube.com followed by
          \S*             # Allow anything up to VIDEO_ID,
          [^\w\-\s]       # but char before ID is non-ID char.
        )                 # End host alternatives.
        ([\w\-]{11})      # $1: VIDEO_ID is exactly 11 chars.
        (?=[^\w\-]|$)     # Assert next char is non-ID or EOS.
        (?!               # Assert URL is not pre-linked.
          [?=&+%\w]*      # Allow URL (query) remainder.
          (?:             # Group pre-linked alternatives.
            [\'"][^<>]*>  # Either inside a start tag,
          | </a>          # or inside <a> element text contents.
          )               # End recognized pre-linked alts.
        )                 # End negative lookahead assertion.
        [?=&+%\w]*        # Consume any URL (query) remainder.
        ~ix', 
        '$1',
        $youtube);
    return $youtube;
}

$youtube_id = getYoutubeId($youtube); 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-01T21:44:06.010

```
$url = "http://www.youtube.com/watch?v=hLSoU53DXK8&feature=g-vrec";
$query_string = array();

parse_str(parse_url($url, PHP_URL_QUERY), $query_string);

$id = $query_string["v"]; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-06-07T11:23:23.770

不幸的是，上述解决方案没有检索短网址“ [http://youtu.be](http://youtu.be) ”的 Youtube ID。所以基于上面的解决方案我写了这个函数：

```
function get_youtube_id( $youtube_url ) {
    $url = parse_url($youtube_url);

    if( $url['host'] !== 'youtube.com' &&
        $url['host'] !== 'www.youtube.com'&&
        $url['host'] !== 'youtu.be'&&
        $url['host'] !== 'www.youtu.be')
    return '';

    if( $url['host'] === 'youtube.com' || $url['host'] === 'www.youtube.com' ) :
        parse_str(parse_url($youtube_url, PHP_URL_QUERY), $query_string);
        return $query_string["v"];
    endif;

    $youtube_id = substr( $url['path'], 1 );
    if( strpos( $youtube_id, '/' ) )
        $youtube_id = substr( $youtube_id, 0, strpos( $youtube_id, '/' ) );

    return $youtube_id; 
```

}

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-02T23:06:23.597

```
$youtube = "theURL";
$query_string = array();

parse_str(parse_url($youtube, PHP_URL_QUERY), $query_string);

$youtube_id = $query_string["v"]; 
```

# ios - 来自 UITableViewController 表格视图单元的多个/可选序列

> ID：10404754
> 
> 赞同：3
> 
> 时间：2012-05-01T21:38:57.140
> 
> 标签：ios, uitableview

我在这里看到了这个主题，但没有一个解决方案点击或对我有用。我有一个***UITableViewController***，（称之为**myUITableViewController ）并且要求是这样的，如果用户从****myUITableViewController**选择前三行之一，他们将被带到**theFirstViewController**，但如果他们选择了任何三行*以上，*他们将被带到到**第二视图控制器**。我使用的情节提要似乎不允许从单个 tableview 单元格中进行多个 segues。但是，我可以直接从**myUITableViewController**添加多个 segue，但是我正在努力使用正确的 segue 代码并且没有找到合适的解决方案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T22:40:04.453

最好的方法是不要直接从 IB 使用 segue，而是`tableview:didSelectRowAtIndexPath:`在他们选择表中的一行时使用并手动从代码中调用它们。

您应该设置从 tableview 本身到目的地的 segues，而不是表中的特定元素。

像这样的东西：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {  
    NSString *identifierOfSegueToCall;
    if (indexPath.row < 3) {
        identifierOfSegueToCall = @"theFirstViewControllerSegueIdentifier";
    } else {
        identifierOfSegueToCall = @"theSecondViewControllerSegueIdentifier";
    }

    [self performSegueWithIdentifier:identifierOfSegueToCall sender:self];
} 
```

# python - matplotlib 设置 yaxis 标签大小

> ID：10404759
> 
> 赞同：88
> 
> 时间：2012-05-01T21:39:26.620
> 
> 标签：python, matplotlib, label, graphing

如何仅更改 yaxis 标签的大小？现在，我使用更改所有标签的大小

```
pylab.rc('font', family='serif', size=40) 
```

但就我而言，我想让 y 轴标签大于 x 轴。但是，我想单独留下刻度标签。

我试过了，例如：

```
pylab.gca().get_ylabel().set_fontsize(60) 
```

但我只得到：

```
AttributeError: 'str' object has no attribute 'set_fontsize' 
```

所以，显然这行不通。我已经看到了很多关于刻度大小的东西，但没有看到轴标签本身。

* * *

## 回答 #1

> 赞同：148
> 
> 时间：2012-05-01T21:51:14.363

如果您使用 'pylab' 进行交互式绘图，您可以在创建时使用`pylab.ylabel('Example', fontsize=40)`.

如果您以`pyplot`编程方式使用，您可以在创建时`ax.set_ylabel('Example', fontsize=40)`或之后使用`ax.yaxis.label.set_size(40)`.

# actionscript-3 - 制作一个按钮，加载到加载的 swf 文件中并在单击时卸载 swf

> ID：10404765
> 
> 赞同：0
> 
> 时间：2012-05-01T21:40:24.753
> 
> 标签：actionscript-3, flash

我正在做一个投资组合类型的项目，并且无法创建出现在我加载的 swf 文件中的按钮。我对闪光灯很陌生。该投资组合有 2 个项目在单击时被加载。我还需要在单击它们时出现一个按钮。

现在我将它设置为再次单击时卸载，但这不起作用，因为其中一个项目是交互式的。到目前为止我的代码是

```
var myLoader:Loader=new Loader ();
project2.addEventListener(MouseEvent.CLICK, project2content); 
function project2content(myevent:MouseEvent):void {
    var myURL:URLRequest=new URLRequest("Project2.swf"); 
    myLoader.load(myURL); 
    addChild(myLoader);
}

project3.addEventListener(MouseEvent.CLICK, project3content); 
function project3content(myevent:MouseEvent):void {
    var myURL:URLRequest=new URLRequest("Project3.swf"); 
    myLoader.load(myURL); 
    addChild(myLoader);
}

myLoader.addEventListener(MouseEvent.CLICK, unloadcontent); 
function unloadcontent(myevent:MouseEvent):void {
    removeChild(myLoader);
    project2.gotoAndPlay(1); 
    project3.gotoAndPlay(1); 
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T23:21:49.633

如果我对您的理解正确，您希望能够向您的一个或两个项目 SWF 添加一个关闭按钮，并让您的父电影获得对这些按钮的点击。

如果是这样，请尝试在您的项目 SWF 中创建一个按钮并包含以下代码：

```
closeButton.addEventListener(MouseEvent.CLICK, closeHandler);
function closeHandler(event:MouseEvent):void
{
    dispatchEvent(new Event("close"));
} 
```

并将 myLoader 上与 click 事件相关的代码替换为以下代码：

```
myLoader.content.addEventListener("close", closeHandler);
function closeHandler(event:MouseEvent):void {
    removeChild(myLoader);
    project2.gotoAndPlay(1); 
    project3.gotoAndPlay(1); 
} 
```

# jquery - 当 AJAX 查询请求数据时，如何停止用户输入操作？

> ID：10404768
> 
> 赞同：0
> 
> 时间：2012-05-01T21:40:41.847
> 
> 标签：jquery, ajax

我有一个通过页面`JQUERY`使用的功能，当 AJAX 运行时，我会为用户显示 loading.gif。当返回请求的 json 数据时，一切都很好。我想做的是在发生这种情况时使任何用户输入为空。`AJAX``PHP``AJAX`

解决此问题的最佳方法是什么？

编辑：

我最终使用...

```
$('#loadingDiv')
    .hide()  // hide it initially
    .ajaxStart(function() {
        $(this).show();
    })
    .ajaxStop(function() {
        $(this).hide();
    })
; 
```

来自帖子[如何在 jQuery 中显示加载微调器？](https://stackoverflow.com/questions/68485/how-to-show-loading-spinner-in-jquery)

感谢您的建议！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T21:59:53.313

就像一个有趣的想法。

这有点肮脏，但您可以在 Ajax 请求期间禁用网站内的任何键盘输入，方法是将此事件添加到`$(document).ready`：

```
​$(document).on("keydown", function(e) {
    return $.active == 0;
});​​​​​​​​​​​​​​ 
```

它的工作原理是这样的：`$.active`返回活动 Ajax 请求的数量。如果是，`0`那么任何*keydown*都将返回为`false`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T21:50:19.873

你可以：

*   使用微调器使屏幕变灰，直到请求成功（loading.gif）
*   通过设置禁用输入字段`disabled=disabled`

看到这个问题：[如何在 jQuery 中显示加载微调器？](https://stackoverflow.com/questions/68485/how-to-show-loading-spinner-in-jquery)和[jQuery .ajaxStart()](http://api.jquery.com/ajaxStart/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T21:45:36.800

只需禁用 xbonez 所说的字段即可。确保向您的用户提供有关阻止他们输入数据的原因的反馈。否则他们会认为您的应用程序刚刚冻结。

# algorithm - 如何生成种子字符串的所有唯一 4 个字符排列？

> ID：10404771
> 
> 赞同：-1
> 
> 时间：2012-05-01T21:40:52.680
> 
> 标签：algorithm, set, combinations

> **可能重复：从 n**[生成不同组合 PHP](https://stackoverflow.com/questions/9137880/generate-distinct-combinations-php)
> [返回 k 元素的所有组合的算法](https://stackoverflow.com/questions/127704/algorithm-to-return-all-combinations-of-k-elements-from-n)

我有一个包含许多字符/字母的数组，例如：

```
$seed = array('a','b','c','d','e','f',.....,'z','1','2','3',...'9'); 
```

我想从种子中获取所有可能的唯一 4 个字符组合/排列，例如：

```
abcd, azxy, ag12, aaaa, etc 
```

实现这一目标的最佳方法是什么？

我曾考虑将种子数组分成 4 个字母组，然后遍历每个组并生成该组的所有可能组合，但这会遗漏很多组合（即它将处理 abcd 和 wxyz，但不处理 abyz 和 wxcd）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T21:43:09.760

对于数组中的每个字符，写入该字符后跟从其后面的字符（如果您实际上是指组合）或所有字符（这就是我认为您的意思）中的每个唯一的 3 个字符串。

> 如何生成种子字符串的所有唯一 3 个字符排列？

看到[这个非常相似的问题](https://stackoverflow.com/questions/10404771/how-to-generate-all-unique-4-character-combinations-of-a-seed-string)。

您可能还想了解[递归](http://en.wikipedia.org/wiki/Recursion_(computer_science))。

**Python代码**

```
>>> def product(chars, n):
        if n == 0:
            yield ''
        else:
            for c in chars:
                for result in product(x, n - 1):  # Recursive call
                    yield c + result

>>> list(product(['a', 'b', 'c'], 2))
['aa', 'ab', 'ac', 'ba', 'bb', 'bc', 'ca', 'cb', 'cc'] 
```

（注意：在真正的 Python 代码中，您应该使用`itertools.product`而不是自己编写。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T22:25:34.013

生成排列就像对数字求和。[这在免费提供的书籍Higher Order Perl](http://hop.perl.plover.com/)中得到了很好的解释，第 128 页

# sap-ase - 触发器中的错误似乎回滚了整个事务

> ID：10404777
> 
> 赞同：1
> 
> 时间：2012-05-01T21:41:18.703
> 
> 标签：sap-ase

我在表 A 上有一个从表 B 中删除的删除触发器。我正在测试触发器失败时会发生什么，为此我重命名了表 B，因此触发器找不到它。

这些是我的正常步骤：

```
begin transaction
delete from C
delete from A -- this errors for reason mentioned
-- At this point the transaction is automatically rolled-back. 
```

但是，如果我执行以下步骤：

```
begin transaction
delete from C
delete from B -- this errors for reason mentioned
-- At this point transaction is not rolled back, and I can still commit it. 
```

在第一种情况下，事务如何回滚？难道不应该由应用程序调用回滚或提交吗？

整个区别在于触发器失败与语句失败的原因相同，我希望行为是相同的。

**编辑以添加示例：**

```
create table A (a int primary key)
create table B (a int primary key)
create table C (a int primary key)

create trigger Atrig on A for delete as delete B from B, deleted where  B.a=deleted.a

insert into A values(1)
insert into A values(2)
insert into B values(2)
insert into B values(3)

insert into C values(1)
insert into C values(2)
insert into C values(3) 
```

现在将表 B 重命名为 B2（我使用 UI 重命名它，所以没有 sql 命令这样做）

```
begin transaction
delete C where a=3
delete A where a = 2 
```

以上返回此错误，并回滚事务：

```
System.Data.OleDb.OleDbException (0x80040E37): [42000]
[Message Class: 16]
[Message State: 1]
[Transaction State: 0]
[Server Name: sybase_15_5_devrs1]
[Procedure Name: Atrig]
[Line Number: 1]
[Native Code: 208]
[ASEOLEDB]B not found. Specify owner.objectname or use sp_help to check whether the object exists (sp_help may produce lots of output). 
```

但是，如果我这样做：

```
begin transaction
delete C where a=3
delete B where a = 2 
```

上面返回错误，但事务没有回滚，我可以发出'提交事务'：

```
System.Data.OleDb.OleDbException (0x80040E37): [42000]
[Message Class: 16]
[Message State: 1]
[Transaction State: 0]
[Server Name: sybase_15_5_devrs1]
[Native Code: 208]
[ASEOLEDB]B not found. Specify owner.objectname or use sp_help to check whether the object exists (sp_help may produce lots of output). 
```

我认为该行为与[此主题有关](http://manuals.sybase.com/onlinebooks/group-as/asg1250e/sqlug/@Generic__BookTextView/54812;hf=0) 在“数据修改错误导致的回滚”表中，它说：

```
Context: Transaction only
Behavior: Current command is aborted. Previous commands are not rolled back, and subsequent commands are executed. 

Context: Trigger in a transaction
Behavior: Trigger completes, but trigger effects are rolled back.
All data modifications since the start of the transaction are rolled back. If a transaction spans multiple batches, the rollback affects all of those batches.
Any remaining commands in the batch are not executed. Processing resumes at the next batch. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T13:57:26.003

**上下文：仅事务**
行为：当前命令被中止。之前的命令不回滚，执行后续的命令。

**上下文：事务中的**
触发器行为：触发器完成，但触发器效果回滚。自事务开始以来的所有数据修改都将回滚。如果事务跨越多个批次，则回滚会影响所有这些批次。批处理中的任何剩余命令都不会执行。处理在下一批继续。

* * *

在阅读了您今天早上在答案中指定的同一手册后，我已经在我的 sybase 环境中进行了测试，结果就是这样。

# mysql - MySQL 查询 - 'CAST' ' CONCAT' - 如何将几行数据乘以一定数量并在新列中显示它们各自的总数？

> ID：10404780
> 
> 赞同：0
> 
> 时间：2012-05-01T21:41:26.650
> 
> 标签：mysql, sql

查询总价的最佳方法是什么？

我想将几行数据乘以一定数量，并在我的数据库中£'s 的新列中显示它们各自的总数？

我需要什么语法？

**编辑：**

我有很多客户。有的只有一个订单，有的有多个订单。我想开始向他们收取每笔订单 1.50 英镑的费用，因此，我需要 x（乘以）1.50 英镑的订单金额，并将其显示在一个新的列中，以英镑为单位。例如，有 4 个订单的客户需要 x 1.50 英镑，这将在第 3 列中显示 6.00 英镑，依此类推... 1.st 列是名称，第二列是订单金额。第三列需要是总价。希望这是有道理的

**来自评论** 的更新：它计算了订单，但是它`BLOB`在第三列中返回值，我想在其中显示 £ 值以进行 * 订单计算：

```
 SELECT   CONCAT_WS(" "
              , c.customer_title
              , c.customer_fname
              , c.customer_sname
           ) AS Customer
          , COUNT(O.order_name) AS Ordertotal
          , concat('£' * 1.5) TotalPrice 
 FROM   Order O, Friend F, Customer C, FriendOrder 
 WHERE C.customer_id = F.Customer_id 
 AND   F.Friend_id = FriendOrder.friend_id 
 AND   O.order_id = FriendOrder.order_id 
 GROUP BY Customer 
 ORDER BY C.customer_sname, C.customer_fname 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T17:18:37.850

您不应该将答案添加到原始问题中，因为这会使找出问题变得混乱。

看起来除了 blob 部分之外的所有内容都得到了回答——这是最终结果：

```
SELECT
    CONCAT_WS(
        " ",
        c.customer_title,
        c.customer_fname,
        c.customer_sname
    ) AS Customer,
    COUNT(*) AS Ordertotal,
    CONCAT('£', cast(count(*) * 1.5 as char)) AS TotalPrice 
FROM Order O
INNER JOIN FriendOrder fo
ON O.order_id = fo.order_id
INNER JOIN Friend F
ON fo.friend_id = F.Friend_id
INNER JOIN Customer C
ON F.Customer_id = C.customer_id
GROUP BY Customer 
ORDER BY C.customer_sname, C.customer_fname 
```

为避免出现“blob”，请转换为 char，因为您正在创建显示字符串。以下是查询的片段：

```
cast(count(*) * 1.5 as char) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T21:52:51.593

最好的做法是将任务分开，将计算留给 SQL 编程，并将呈现给您用于前端的任何编程语言。

所以你的 SQL 应该使用它的原生 * 运算符。您的查询可能如下所示：

```
SELECT `column_1` * `column_2` as `product`; 
```

这将返回名为“产品”的列中两列的乘积。

£ 符号正在格式化。您应该将其留给您为呈现信息而编写的任何架构。（例如 PHP 或 java）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T21:56:16.207

由于缺乏对数据和字段的描述，应用了很多想象力，这应该可以解决问题：

```
select c.name, count(*) orderAmount, concat('£', count(*) * 1.5) totalPrice
from customers c
join orders o on c.customerId = o.customerId
group by c.customerId, c.name 
```

# php - 使 php 句柄获取 URI 就像 symfony

> ID：10404782
> 
> 赞同：0
> 
> 时间：2012-05-01T21:41:41.313
> 
> 标签：php

我正在启动一个太小而无法使用框架的项目，但我想让 uri 看起来像 symfony 拥有它们的方式。

例如

example.net/directory/var/value/

代替

example.net/directory?var=value

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T21:45:43.710

你要找的关键词是：**url rewrite**

这是一个简单的示例，将一个名为 .htaccess 的文件放入您的根目录

```
Options +FollowSymlinks
RewriteEngine on
RewriteRule ^directory/([^/]+)/([^/]+) /directory.php?var=$1&value=$2 [NC] 
```

这会发生：

```
 http://domain.com/directory/AAA/123  => /directory.php?var=AAA&value=123 
```

更多在这里：[http ://corz.org/serv/tricks/htaccess2.php](http://corz.org/serv/tricks/htaccess2.php)

# ruby - Watir-webdriver：如何强制点击方法等待页面完全加载

> ID：10404789
> 
> 赞同：3
> 
> 时间：2012-05-01T21:42:32.157
> 
> 标签：ruby, watir, watir-webdriver, webautomation

在之前使用 Watir 之后，我最近开始使用 Watir-Webdriver，因为我需要一些 webdriver 中存在但 Watir 中没有的功能。我在 watir-webdriver 中遇到了一个我在 Watir 中从未遇到过的问题。

每当在 Watir 的按钮上使用 click 方法时，它都会隐式等待新页面完全加载。我在 Watir-webdriver 文档上读到了等待，并且在这个[问题](https://stackoverflow.com/questions/3504322/watir-webdriver-wait-for-page-load)中，watir-webdriver 中的等待已更改，以适应 AJAX 对网页所做的动态更改。现在，我正在自动化的页面没有任何 AJAX 元素，它只包含静态元素。

但是当我在 watir-webdriver 中使用 click 方法时，它不会等待下一个页面隐式加载并立即执行调用中的下一行。我可以使用 wait_until_present 但是在等待页面加载点击似乎是标准行为时，对很多页面执行此操作对我来说似乎有点过头了。

我是否缺少一些需要切换的选项，以便在 watir-webdriver 中模拟 Watir 的单击方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T17:35:30.830

如果您在浏览器指示页面已加载时遇到问题，但客户端仍在发生问题（可能是 javascript 代码执行或 css 逻辑等），那么我建议在您的操作前使用[“when_present”装饰器](http://rdoc.info/github/watir/watir-webdriver/Watir/EventuallyPresent#when_present-instance_method).

这比必须放入单独的等待步骤要干净一些，并且比固定的睡眠时间等要好得多。

```
browser.button(:how => 'what').when_present.click 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-08T16:02:53.993

如果您希望内容加载但不单击，您也可以等待 div 加载。

```
browser.div(:how => 'what').wait_until_present 
```

# vb.net - VB.net 游戏内截图

> ID：10404793
> 
> 赞同：0
> 
> 时间：2012-05-01T21:42:52.407
> 
> 标签：vb.net, directx, screenshot, fullscreen

我正在开发一个程序，该程序将允许用户截取全屏游戏的屏幕截图，例如使命召唤、战地 3 等。

但是，我的代码有两个问题。

首先，我必须按两次快捷方式，而不是像其他快捷方式那样按一次。这只发生在下面的代码实际上在处理子中时。如果我在按下快捷方式时只显示一个消息框，那么它每次都有效。

其次，每当我截取屏幕截图时，它要么完全变黑，要么截取我的桌面，即使前台正在运行游戏。

我环顾四周，似乎 printscreen 是通过 vb.net 获取游戏截图的唯一方法。

我的代码如下。任何帮助表示赞赏。

```
 Private Sub game_Press(ByVal s As Object, ByVal e As Shortcut.HotKeyEventArgs) Handles gamewindow.press
    Dim gamewin As RECT
    If GetWindowRect(GetForegroundWindow, gamewin) Then
        Dim bmp As Bitmap
        Dim gfx As Graphics
        SendKeys.Send("%{PRTSC}")
        Dim getscrn As IDataObject = Clipboard.GetDataObject()
        Dim bmpsize As New Size(gamewin._Right - gamewin._Left, gamewin._Bottom - gamewin._Top)
        bmp = New Bitmap(CType(getscrn.GetData(GetType(System.Drawing.Bitmap)), Bitmap))

        gfx = Graphics.FromImage(bmp)
        gfx.CopyFromScreen(gamewin._Left, gamewin._Top, 0, 0, New Size(bmpsize.Width, bmpsize.Height), CopyPixelOperation.SourceCopy)
        Dim sr As New System.Threading.Thread(AddressOf uploadimage)
        sr.IsBackground = True
        sr.SetApartmentState(Threading.ApartmentState.STA)
        sr.Start(bmp)
        gfx.Dispose()
    End If
End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T21:47:11.110

PrintScreen 由 Win32 环境处理，该环境处理窗口的正常绘制。因此，如果 PrintScreen 键进入 Win32 （没有被游戏吞噬），它可能会截取当前正在绘制的内容，就像你说的那样，它要么是你的桌面，要么什么都没有（黑色的）。

您可以尝试使用[GDI](http://msdn.microsoft.com/en-us/library/dd145203%28v=vs.85%29.aspx)到[BitBlt](http://msdn.microsoft.com/en-us/library/dd183370%28v=vs.85%29.aspx)从[屏幕](http://msdn.microsoft.com/en-us/library/dd183490%28v=vs.85%29.aspx) [DC](http://msdn.microsoft.com/en-us/library/dd183553%28v=vs.85%29.aspx)到[内存 DC](http://msdn.microsoft.com/en-us/library/dd183489%28v=vs.85%29.aspx)（就像大多数屏幕捕获程序所做的那样），但这不能保证有效。这是一个大问题。在游戏中按 Print Screen，然后粘贴到 MS 绘图中真的有效吗？如果不是，那么您可能不走运，没有深入研究 directX 方面的内容。

[Paul-Jan](https://stackoverflow.com/users/16725/paul-jan)指出了这个密切相关的 SO 问题：[Take screenshot of DirectX full-screen application](https://stackoverflow.com/questions/1962142/take-screenshot-of-directx-full-screen-application)建议使用 Microsoft 的[Detours](http://research.microsoft.com/en-us/projects/detours/)来挂钩/检测执行帧捕获所需的 DirectX 调用。

# haskell - 使用过滤器添加到列表中的元组

> ID：10404801
> 
> 赞同：-2
> 
> 时间：2012-05-01T21:43:36.380
> 
> 标签：haskell

```
Authors = [(String, Int)]
File Filename DateTime Authors 
```

例子：

```
File "DSC023.jpg" "01/05/2012 22:40" [("Test1",1),("Test2",2)] 
```

我将如何搜索 DSC023.jpg 并将另一位作者添加到列表中？

```
findFile n = find (\(File x _ _ _) -> x == n) fileDatabase 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T21:50:41.080

你需要几个函数：

```
addAuthor author File x y as = File x y (author:as)

fileName File n _ _ _ = n

findFile name = find (\x -> (fileName x) == name) 
```

这应该为您提供构建所需功能的一切。

# web-config - 跨站点拆分身份验证

> ID：10404803
> 
> 赞同：0
> 
> 时间：2012-05-01T21:43:44.710
> 
> 标签：web-config, wif, adfs2.0

想象一个公司内部有许多部门的 Intranet，例如：

\家

….\A区

….\B 区

….\C 区

….\D 区

…</p>

....\第 XXX 分部

有很多部门——大约 50 个。本质上，每个部门本质上都是一个单独的网站。

目前使用的是WIA。

现在该公司（以 Microsoft 为中心）希望与其他组织建立 SSO，因此他们决定安装 ADFS v2。

然而，一些部门不喜欢这个想法。

如果我们 FBUtil 基础级别的 web.config，那么整个站点都将受到保护。

为了保护某些部门而不是其他部门，我想我们可以为那些需要 ADFS 的部门级别的 web.config 进行 FBUtil 配置，但这很快就会成为维护的噩梦，因为它们太多了。

有没有更好的方法来允许 ADFS 跨某些部门，但让一些部门仍然像现在一样进行身份验证。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T04:36:19.113

您应该只能更新 root `web.config`，并使用[`<location>`标签](http://msdn.microsoft.com/en-us/library/b6x6shw7.aspx)（例如`<location path="DivisionC"><microsoft.identityModel>...</microsoft.identityModel></location>`）为实际使用 WIF 的部门/站点指定 WIF 相关信息。

但是，这仍然会导致该 root 中的重复`web.config`；我不知道如何解决这个问题，那将是一个不同的问题。:-)

# c++ - C++：XCode EXC_BAD_ACCESS 问题

> ID：10404807
> 
> 赞同：3
> 
> 时间：2012-05-01T21:44:10.547
> 
> 标签：c++, xcode, memory-management, error-handling

我是在 Xcode 中将 C++ 编码为我的框架的新手，所以我想问一个我认为仅与**内存管理有关的问题**

我想要实现的是我尝试创建一个大小为**10000 x 10000**的矩阵，但是即使我进行了正确的编码（至少这是我所相信的）我只是无法让它工作，只是指出**EXC_BAD_ACCESS**错误.

你可以在下面找到我的代码。这是一个面向 XCode 的错误还是我做了一个明显的编码错误？

```
#include <iostream>
using namespace std;

    int main(int argc, const char * argv[])
    {

        // insert code here...
        int matrix[10000][10000];
        for(int i=0;i<10000;i++)
            for(int j=0;j<10000;j++)
                matrix[i][j]=24;
        cout<<"Done"<<endl;
        return 0;
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-01T21:52:52.277

如果 Jesse Good 发表他的评论“`int matrix[10000][10000];`在我看来就像堆栈溢出。”作为答案，我将删除它。

您应该在堆上而不是在堆栈上创建此大小的分配。

这是细分：

```
400,000,000 bytes = 10000*10000*sizeof(int) 
```

通过在堆上创建分配来克服此问题的一种常见方法是：

```
#include <iostream>
#include <vector>

int main(int argc, const char* argv[]) {
    std::vector<std::vector<int> > matrix(10000, std::vector<int>(10000, 24));
    cout<<"Done"<<endl;
    return 0;
} 
```

堆栈大小由操作系统、硬件和其他因素决定。您可以使用的内存可能少于 1 MB，但通常不会超过几个。因此，应该避免大的堆栈分配。

# input - CSS：使用输入按钮图像实现 CSS Sprites

> ID：10404808
> 
> 赞同：1
> 
> 时间：2012-05-01T21:44:10.933
> 
> 标签：input, css-sprites

这个按钮在 CSS Sprites 之前

```
<input type="image" src="/images/search-button.png" value="" id="search-button"> 
```

我正在尝试使用我的一种搜索表单来实现 CSS Sprites，问题是如果我使用

```
<input id="search-button" class="sprites1" type="submit" value=""> 
```

它看起来像这样。

![在此处输入图像描述](../Images/9657320c9199e941b955f3d77b78ca56.png)

如您所见，右侧的图像看起来不正确，但它是可点击的。

然后我尝试了

```
<span id="search-button" class="sprites1"></span> 
```

![在此处输入图像描述](../Images/0bbd490e35e82156ac0d8858a11a592e.png)

然后它看起来正确！但！！我不能点击它。

所以这是我的 CSS sprites 代码。

我必须实施什么才能让它看起来像我想要的那样，我可以点击它？

```
 .sprites1 {
        background: url('result.png');
    }
#search-button {background-position: -0px -462px; 

                width:16px; height:16px; float:right; } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T21:47:36.930

这里的问题是浏览器在元素上使用的默认 css。您应该尝试重置该css。我经常使用以下代码段：

```
/*  reset css of buttons */
.cssresetbutton {
    border-width: 0px;
    border-style: none;
    background: inherit;
    font: inherit;
    color: blue;
    padding: 0px; }

.cssresetbutton:active {
    border-width: 0px;
    border-style: none;
    background: inherit;
    outline: 0;
    box-shadow: none; } 
```

尝试将*cssresetbutton*类添加到您的输入元素，看看它是否有效。

**编辑：** 您也可以尝试不使用 input[type=submit] 元素。例如：

```
<span id="search-button" class="sprites1" onClick="document.getElementById('formid').submit()"></span> 
```

单击时它将提交 form#formid 元素。

# c# - 比较数据表中的值

> ID：10404812
> 
> 赞同：0
> 
> 时间：2012-05-01T21:44:19.123
> 
> 标签：c#, asp.net, datatable

我正在尝试处理数据表以将新值与现有数据表进行比较，如果可用，数量将加起来，但如果没有，它将在数据表中添加一行。

```
if (HttpContext.Current.Session["Cart"] != null)
{
    DataTable shoppingcart = (DataTable)HttpContext.Current.Session["Cart"];
    for (int i = 0; i < shoppingcart.Rows.Count; i++)
    {
        String checktitle = shoppingcart.Rows[i]["Title"].ToString();
            if (title == checktitle)
            {
                //do something
            }
            else
            {

                ShoppingCart.DataSource = cart.cartrow(shoppingcart);
                ShoppingCart.DataBind();
            }
        }

    }

    else
    {
        HttpContext.Current.Session["Cart"] = cart.shoppingCart();
        ShoppingCart.DataSource = cart.shoppingCart();
        ShoppingCart.DataBind();
    }

} 
```

但不知何故。我无法添加它的数量。它每次都在创建一个新行。感谢您的建议。这是我用来添加行或添加表的类

```
String title { get; set; }
decimal price { get; set; }
int quantity { get; set; }
DataTable CartTable;
DataRow tableRow;
public cart(String _title, decimal _price)
{
    title = _title;
    price = _price;
}
public DataTable shoppingCart()
{
    CartTable = new DataTable("cart");

    CartTable.Columns.Add("ID", typeof(Int32));
    CartTable.Columns["ID"].AutoIncrement = true;
    CartTable.Columns["ID"].AutoIncrementSeed = 1;

    CartTable.Columns.Add("Title");
    CartTable.Columns.Add("Price");
    CartTable.Columns.Add("quantity");

    tableRow = CartTable.NewRow();
    tableRow["Title"] = title;
    tableRow["Price"] = price;
    tableRow["quantity"] = quantity;
    CartTable.Rows.Add(tableRow);
    return CartTable;
}

public DataTable cartrow(DataTable _cart)
{

    tableRow = _cart.NewRow();
    tableRow["Title"] = title;
    tableRow["Price"] = price;
    tableRow["quantity"] = quantity;
    _cart.Rows.Add(tableRow);
    return _cart;

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T02:50:06.347

也许你可以使用 foreach：

```
if (HttpContext.Current.Session["Cart"] != null)
{
    DataTable shoppingcart = (DataTable)HttpContext.Current.Session["Cart"];

    foreach (DataRow row in shoppingcart.Rows)
    {
            String checktitle = row["Title"].ToString();
            int price = row["price"].ToString();
            int quantity = row["quantity"].ToString();

            if (title == checktitle)
            {
                //do something
            }
            else
            {

                Session["Cart"] = cart.cartrow(shoppingcart,checktitle,price,quantity);
                ShoppingCart.DataSource = Session["Cart"]  as DataTable();
                ShoppingCart.DataBind();
            }
     }

 } 
```

您的购物车行

```
public DataTable cartrow(DataTable _cart,string title,int price,int quantity)
{

    tableRow = _cart.NewRow();
    tableRow["Title"] = title;
    tableRow["Price"] = price;
    tableRow["quantity"] = quantity;
    _cart.Rows.Add(tableRow);
    return _cart;

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T21:54:13.920

你运行这段代码：

```
ShoppingCart.DataSource = cart.cartrow(shoppingcart);
ShoppingCart.DataBind(); 
```

每次您的条件为假时：title == checktitle

我不确定这是不是错误，但是您应该构建一些不同的东西，如下所示：

```
if (HttpContext.Current.Session["Cart"] != null)
{
    DataTable shoppingcart = (DataTable)HttpContext.Current.Session["Cart"];
    //put here each row you need to bind
    DataTable toBind = new DataTable();  //do more to init the columns, rows, etc

    for (int i = 0; i < shoppingcart.Rows.Count; i++)
    {
        String checktitle = shoppingcart.Rows[i]["Title"].ToString();
            if (title == checktitle)
            {
                //do something
            }
            else
            {
                toBind.add(cart.cartrow(shoppingcart));  //the sintax here is incorect, I code directly here
                //ShoppingCart.DataSource = cart.cartrow(shoppingcart);
                //ShoppingCart.DataBind();
            }
        }
        //bind outside the for cicle
        ShoppingCart.DataSource = toBind ;
        ShoppingCart.DataBind();
    }

    else
    {
        HttpContext.Current.Session["Cart"] = cart.shoppingCart();
        ShoppingCart.DataSource = cart.shoppingCart();
        ShoppingCart.DataBind();
    }

} 
```

我希望这能给你一个纠正代码的方向。我将它直接编码到浏览器中，我不记得初始化 DataTable 或向其中添加一行的确切语法。

# mysql - Mysql2 响应不适用于 Ruby 中的方法 collect

> ID：10404814
> 
> 赞同：0
> 
> 时间：2012-05-01T21:44:30.823
> 
> 标签：mysql, ruby, unit-testing, collect

我在我的 ruby​​ 脚本中使用 mysql2。使用它来测试对 mysql 数据库的 API 响应

这是我的脚本的一个片段

```
test_job_by_id_5
 id = $data["jobs"]["id"][i] # example 5
 job = JobServices.job_by_id(id)
 response = @@con.query("select * from jobs where id = #{id}") #select * from jobs where id =5
 rs=response.collect #this fails
 assert_match(job[0]['title'],rs[0]['title'],"The title values are equal for #{$data["jobs"]["id"][i]}")
end 
```

所以当我使用它时，`ruby 1.8.7 (2011-06-30 patchlevel 352) [i686-darwin10]`它就像一个魅力

但是当我使用`ruby 1.9.2p290 (2011-07-09 revision 32553) [x86_64-linux]`它时它不起作用我得到这个错误

```
NoMethodError: undefined method '[]' for 
#<Enumerator: #<Mysql2::Result:0x00000012d19f18>:collect> 
```

有人可以帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T22:52:54.973

当您调用`collect`（`Enumerable`即[`Mysql2::Result`](http://rubydoc.info/github/brianmario/mysql2/Mysql2/Result)）时，您会[`Enumerator`](https://ruby-doc.org/core/Enumerator.html)返回一个实例。`Enumerator`s 没有实现数组访问操作符，所以你不能说`enumerator[0]`和得到任何有用的事情发生；但是，`Enumerator`确实包括`Enumerable`所以他们会回应[`first`](https://ruby-doc.org/core/Enumerable.html#method-i-first)所以你可能想要这样做：

```
rs  = response.collect
row = rs.first
assert_match(job[0]['title'], row['title'], "The title values are equal for #{$data["jobs"]["id"][i]}") 
```

或者完全跳过并`Enumerator`调用`first`：`response`

```
row = response.first
assert_match(job[0]['title'], row['title'], "The title values are equal for #{$data["jobs"]["id"][i]}") 
```

甚至这个：

```
row = @@con.query("select * from jobs where id = #{id}").first
assert_match(job[0]['title'], row['title'], "The title values are equal for #{$data["jobs"]["id"][i]}") 
```

请记住，`row.nil?`如果您的查询没有找到任何内容，那将是正确的，因此如果您不想要异常，您可能需要考虑这一点。

# php - Smarty：从数据库返回数据

> ID：10404815
> 
> 赞同：1
> 
> 时间：2012-05-01T21:44:44.237
> 
> 标签：php, database, smarty

通常我从这样的数据库中检索和返回数据：

```
$sql = "SELECT * FROM users";
$res = mysql_query($sql);
while ($row = mysql_fetch_assoc($res)) {
    echo  $row['id'];
    echo  $row['name'];
} 
```

但是如何使用 Smarty 返回数据呢？
我想，我必须分配`$row`：

```
$smarty->assign('row', $row);
$smarty->display('search.tpl'); 
```

但我不确定如何实际显示它。这不起作用：

```
{foreach from=$row item=item}
     {$item}
{/foreach} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T21:48:17.140

你应该在你的模板中使用`{$row.id}`and （没有 foreach）。`{$row.name}`

更新。如果要获取所有行：

```
$rows = array();
while ($rows[] = mysql_fetch_assoc($result)) {}
$smarty->assign('rows', $rows); 
```

在模板中：

```
{foreach from=$rows item=row}
     {$row.name}
{/foreach} 
```

# android - 通过 Google Play 和 .apk 文件直接分发 android 应用程序

> ID：10404819
> 
> 赞同：3
> 
> 时间：2012-05-01T21:45:05.370
> 
> 标签：android

我已经构建了一个应用程序，我们将通过 Google Play 商店向客户销售。

我们也有内部人员将支持外部客户，并在内部使用它。他们需要让应用程序在自己的设备上运行。如果我通过 .apk 文件将其分发给他们，他们可以通过 Google Play 接收更新吗？还是他们必须通过 Google Play 购买才能接收更新？

第二个问题：是否有更好的解决方案来分发给内部用户？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T22:21:18.573

出于好奇并且没有这方面的官方信息，我只是做了一个测试：

在 Google Play 上，我有一个 1.3.2 版的应用程序

*   我已经通过 ADB 在我的设备上安装了 1.3.0 版本。
*   打开 Google Play > 我的应用程序。
*   版本 1.3.2 的更新可用。
*   有没有更新

一切似乎都正常工作。

所以我对此的看法是：是的，他们会收到更新（当然，该应用程序必须具有相同的签名）。如果这不违反任何规则，也许您可​​能只是看一下服务条款。

关于第二个问题，“更好”的解决方案可能会基于我们不知道的公司基础设施而谨慎。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T22:51:02.967

如果 Google Play 上的版本与您分发的版本相同，使用相同的签名进行签名，并且可以作为免费应用程序使用，则可以使用 Google Play 更新在 Google Play 之外分发的版本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T20:59:28.273

我在一封来自 Google Play 团队成员的电子邮件中收到了以下内容：

“您的内部用户使用的侧载应用程序将不会收到来自 Google Play 的更新。您需要向他们提供新的 APK 以便他们访问新的特性/功能。这是按预期工作的，以确保只有购买了付费应用程序的用户将收到通知和更新。”

因此：如果付费应用是“侧载”（安装在 Google Play 之外），则无法通过 Google Play 更新它们。

# perforce - 如何在某些条件下限制 Perforce 更改列表？

> ID：10404829
> 
> 赞同：0
> 
> 时间：2012-05-01T21:46:01.280
> 
> 标签：perforce

如果其中的任何文件与特定模式匹配，是否有办法限制更改列表？我想用它来保护私人内部项目免受外部承包商的侵害。

我知道如果承包商在保护中没有访问权限，他们将无法看到这些文件，但我宁愿不必依赖每个人来清理他们的签入评论。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-02T05:07:52.477

自从我这样做已经有一段时间了，但我记得诀窍是设置一个非常简单的触发器，强制限制*所有*更改列表。假设您已经在使用保护，那么您的用户将只能看到他们可以看到其文件的更改列表；所有其他更改列表（及其描述）将对它们隐藏。

# matlab - 半正定矩阵的行列式

> ID：10404830
> 
> 赞同：5
> 
> 时间：2012-05-01T21:46:05.230
> 
> 标签：matlab, matrix, linear-algebra

半正定矩阵的行列式是否有可能等于 0。在我的情况下它会变为零。我有一个对角线矩阵，对角线元素非零。当我尝试计算该矩阵的行列式时，结果为 0。为什么会这样？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-02T17:46:50.877

这就是为什么计算行列式从来都不是一个好主意的原因。是的，我知道。你的书、你的老师或你的老板告诉你这样做。他们可能错了。为什么？决定因素是规模很差的野兽。即使您有效地计算行列式（许多算法甚至无法做到这一点），大多数时候您也并不真正想要行列式。

考虑这个简单的正定矩阵。

```
A = eye(1000); 
```

决定因素是什么？我什至不需要打扰。是1。但是，如果你坚持...

```
det(A)
ans =
     1 
```

好的，这样就可以了。如果我们简单地将整个矩阵乘以一个小常数，例如 0.1，怎么样。决定因素是什么？您可能会说没有理由打扰，因为我们已经知道行列式。它必须只是 det(A)*0.1^1000，所以 1e-1000。

```
det(A*0.1)
ans =
     0 
```

我们在这里做错了什么？失败的地方是我们忘记了我们在做浮点运算。由于 MATLAB 中双精度的动态范围仅下降到本质上

```
realmin
ans =
      2.2250738585072e-308 
```

然后较小的数字变成零 - 它们下溢。无论如何，大多数时候当我们计算行列式时，无论如何我们都是出于错误的原因这样做的。如果他们想让你测试一个矩阵是否是奇异的，那么使用 rank 或 cond，而不是 det。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-01T22:05:09.653

根据定义，半正定矩阵的特征值可能为零，因此其行列式因此可以为零

现在，我看不出你对这句话的意思，

> 我有一个对角线矩阵，对角线元素非零。当我尝试计算...

如果矩阵是对角矩阵，并且对角线上的所有元素都不为零，则行列式应该是非零的。如果您在计算机中计算它，请注意下溢。您可以考虑对数之和而不是对角元素的乘积

# python - 与 Excel 相比，在 VB .Net 中使用 Python

> ID：10404833
> 
> 赞同：3
> 
> 时间：2012-05-01T21:46:32.433
> 
> 标签：python, vb.net, vba

我遇到了一个有趣的问题，我可以在 excel 实例中轻松地从 VB 访问 python 代码，如下所述：[Calling python script from excel/vba](https://stackoverflow.com/questions/3567365/calling-python-script-from-excel-vba)

但是，当我在 Visual Studio 中以一种形式模仿完全相同的代码结构时， pyscript.language = "python" 行会失败。有谁知道是否可以在 VB .Net 中使用 MSScriptControl.ScriptControl 来控制 python，就像在 excel 中一样？这比为我的 python 脚本设置一个 com 对象要容易得多。

示例代码（需要添加microsoft script control 1.0和excel对象库）：

```
Imports Microsoft.Office.Interop

Public Class Form1
    Dim WithEvents PyScript As MSScriptControl.ScriptControl
    Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click
        Dim xlApp As New Excel.Application
        xlApp.Visible = True
        Dim xlwbook As Excel.Workbook = xlApp.Workbooks.Add(Excel.XlWBATemplate.xlWBATWorksheet)
        Dim xlSheet As Excel.Worksheet = CType(xlwbook.Worksheets(1), Excel.Worksheet)

        If PyScript Is Nothing Then
            PyScript = New MSScriptControl.ScriptControl
            PyScript.Language = "python"
            PyScript.AddObject("Sheet", xlSheet)
            PyScript.AllowUI = True
        End If
        PyScript.ExecuteStatement("Sheet.cells(1,1).value='Hello'")

    End Sub
End Class 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T12:44:47.767

根据这个[http://msdn.microsoft.com/en-us/library/aa227633(v=vs.60)，scriptcontrol](http://msdn.microsoft.com/en-us/library/aa227633(v=vs.60)是一个 VS6 项目，这意味着它可能与更高版本不完全兼容。还有一个上下文问题，因为这两种环境（Windows 窗体和 Excel）在基本方面是不同的，所以在一个环境中可能的东西在另一个环境中并不总是可能的。

同样值得仔细检查给定示例中的前四个步骤，并确保您可以从 Excel 中执行此操作。

# google-chrome-extension - 尝试在 onBeforeRequest 上设置侦听器时出现“错误：需要参数 1”

> ID：10404838
> 
> 赞同：3
> 
> 时间：2012-05-01T21:47:03.123
> 
> 标签：google-chrome-extension, webrequest

背景.js：

```
chrome.extension.onRequest.addListener(
    function(request, sender, sendResponse)
    {
        console.log(request.filter)
        chrome.webRequest.onBeforeRequest.addListener(request.func, request.filter, ["blocking"]);
    }
); 
```

内容脚本：

```
chrome.extension.sendRequest(
    {
        func: requestInterceptor,
        filter: requestFilter
    }
); 
```

该行`chrome.webRequest.onBeforeRequest.addListener(request.func, request.filter, ["blocking"]);`正在触发以下错误：

```
Error in event handler for 'undefined': Error: Parameter 1 is required. 
```

我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T12:12:14.333

在消息传递时，请求是 JSON 序列化的。
函数不可序列化，因此不会发送。

```
chrome.extension.sendRequest( {
    func: requestInterceptor,    // Function
    filter: requestFilter        // Array of strings
}); 
```

被接收为

```
{
    filter: requestFilter
} 
```

将功能逻辑移至后台页面。
如果[`webRequest`](http://code.google.com/chrome/extensions/webRequest.html)要从内容脚本添加事件侦听器，请使用[`chrome.extension.sendRequest`](http://code.google.com/chrome/extensions/extension.html#method-sendRequest). 接收者（背景）也有一个[`MessageSender`](http://code.google.com/chrome/extensions/extension.html#type-MessageSender)类型，可以用来读取[`tab`](http://code.google.com/chrome/extensions/tabs.html#type-Tab)来源（它提供所有必要的信息，包括 tabId）。

# android - AES加密和解密速度之间的奇怪差异

> ID：10404842
> 
> 赞同：1
> 
> 时间：2012-05-01T21:47:16.980
> 
> 标签：android, performance, aes

我正在编写需要加密和解密文件的应用程序。我的问题是解密比加密慢大约 5 倍。我已经剥离了所有文件读/写操作，并且只对加密进程进行了基准测试。结果非常令人惊讶：

加密 1.5 MB 字节数组`encryptionCipher.doFinal()`（这是 javax.crypto.Cipher 的实例）

`~1600 ms`

解密 1.5 MB 字节数组`decryptionCipher.doFinal()`（这是 javax.crypto.Cipher 的实例）

`~5800 ms`

我很惊讶，因为我知道AES解密和加密是对称过程，加密和解密速度应该没有区别。

我正在使用`AES/CBC/PKCS7Padding`带有 256 位密钥的密码。

什么会导致这种情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T05:03:13.283

在android中加解密可能需要时间（因为代码转换和可用资源少）。JNI 是此类任务的首选。使用 openssl 例程加密和解密，并通过 JNI 接口在您的 java 代码中调用它们。

# hibernate - hibernate+jpa+postgresql：没有方言映射

> ID：10404845
> 
> 赞同：0
> 
> 时间：2012-05-01T21:47:25.990
> 
> 标签：hibernate, postgresql, jpa

我使用本机查询来调用我的 postgresql 数据库中的函数，代码是这样的：

```
String query = "select details,rec_xml[1] from f_get_reccomendations(\'/ma:recommendations/ma:recommendation/name/text()\') ORDER BY id DESC LIMIT 1;";
Query q = em.createNativeQuery(query); 
return q.getResultList(); 
```

函数定义为：

```
CREATE OR REPLACE FUNCTION f_get_reccomendations (
  IN  xpath    varchar(128),
  OUT id       int,
  OUT recs_num int,
  OUT details  varchar(25),
  OUT d_stamp  timestamp,
  OUT rec_xml  xml[]
) RETURNS SETOF RECORD AS
$$
select id, recs_num, details, d_stamp, xpath($1, recs,
          array [
                  array['xs','http://www.w3.org/2001/XMLSchema'],
                  array['ma','http://schemas.medio.com/analytics/1.0']
                ]
          ) from recommendations;
$$
LANGUAGE SQL; 
```

当从 psql 运行时，它可以工作，但是当我在代码中运行时，它给我带来了错误：没有 JDBC 类型的方言映射：2009

我的猜测是 rec_xml 被定义为休眠无法理解的 xml[] 类型？我该如何解决？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T01:24:42.180

第一：你确定这是 XML 数组，而不是 xml 类型本身，这是问题所在吗？我发现 Hibernate 对 Pg 的 XML 类型的支持介于贫乏和不存在之间。

如果它被证明是数组：尝试将 xml 数组扩展为一个集合，以便返回“recs”的交叉连接和其余结果。这将需要在客户端进行过滤以消除重复结果。

或者，您可以在 Hibernate 中为 xml[] 编写方言类型映射，或者将 xml 转换为文本以便返回 text[]。

# eclipse - Eclipse - 新项目

> ID：10404846
> 
> 赞同：0
> 
> 时间：2012-05-01T21:47:32.883
> 
> 标签：eclipse, eclipse-plugin

我需要在eclipse中修改项目创建。我想添加我自己的项目创建。例如，当开发人员选择 File->New->Project 时，我希望我的选项（即 XYZ Java Project）可用。这可能吗 ？如果是，我正在寻找一些开始的方向？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T13:54:47.563

1.  首先，您需要贡献自己的 Eclipse 插件。从此[位置](http://www.eclipse.org/downloads/download.php?file=/technology/epp/downloads/release/europa/winter/eclipse-rcp-europa-winter-win32.zip)下载 Eclipse 插件开发人员 IDE 。

2.  您可以通过扩展贡献自定义项目向导。

3.  定义您的项目性质

作为参考，您可以查看此示例[Create a Custom Project in Eclipse – New Project Wizard: the Behavior](http://cvalcarcel.wordpress.com/2009/07/26/writing-an-eclipse-plug-in-part-4-create-a-custom-project-in-eclipse-new-project-wizard-the-behavior/)

希望这可以帮助 ！！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T22:37:39.437

如果你使用 Maven，你可以看看[archetypes](http://maven.apache.org/guides/introduction/introduction-to-archetypes.html)。Maven 还具有创建 Eclipse 项目的能力。有了这个，您应该拥有自动化所需的任何项目布局所需的所有工具。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T22:40:28.297

是的你可以。一种可靠的方法是制作一个 eclipse 插件，以便将其添加到菜单中。几天前我自己也在研究这个，这就是我发现的。

以下是一些链接：

[奥莱利](http://onjava.com/pub/a/onjava/2004/08/18/eclipseplugins.html)

更好的是，让我告诉你一个答案：[https ://stackoverflow.com/a/299316/879485](https://stackoverflow.com/a/299316/879485)

# xml - 为什么我的 Phing build.xml 中出现无效 XML 错误？

> ID：10404849
> 
> 赞同：0
> 
> 时间：2012-05-01T21:47:39.153
> 
> 标签：xml, continuous-integration, jenkins, phing

当我突出显示 unzip 标记时，它说 XML 格式不正确。完整文件位于：[https](https://github.com/reload/phing-drupal-template/blob/master/build.xml) ://github.com/reload/phing-drupal-template/blob/master/build.xml （第 255 行）

我究竟做错了什么？

```
<httpget url="${jslint4java.url}"
             dir="${jslint4java.dir}"
             proxy="${phing.httpget.proxy}/>
    <unzip file="${jslint4java.dir}/${jslint4java.zipfile}"
           todir="${jslint4java.dir}" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T21:53:13.233

您似乎在`proxy="${phing.httpget.proxy}/>`. 它应该是`proxy="${phing.httpget.proxy}"/>`

**编辑**

还有一些其他问题，但我不知道正确的格式。违规行是：

```
698  <isset property="drupal.uri">
743  <echo msg="You must set the drupal.uri property to get simpletests working.">
973  <isset property="drupal.make.rewritebase">
1209 <httpget url="${patch.url}"
         dir="${project.toolsdir}"
         proxy="${phing.httpget.proxy}/> 
```

前三个可以通过`/`在结束前添加 a 来修复`>`。最后一个与第一个相同（缺少`"`）。但是，虽然这应该使文件成为有效的 XML，但它可能不是正确的语法。

# silverlight - 如何将 xaml 内容（带有内容的堆栈面板）定义为应用程序资源？

> ID：10404850
> 
> 赞同：1
> 
> 时间：2012-05-01T21:47:40.970
> 
> 标签：silverlight, windows-phone-7, controls, app.xaml, application-resource

我确信这个问题是对 Silverlight 的基本了解，之前可能已经被问过好几次了，但是我很难找到我正在寻找的搜索词。

在几个视图中，我必须实现一些视觉效果来警告用户没有连接。我想要做的是定义一个包含内容的堆栈面板或网格，我可以在多个视图中使用它。我希望有一个中心位置来定义它在我所有视图中的显示方式。所以如果我想添加一个插图，我只需要在一个地方做。

```
<StackPanel>
   <Image />
   <TextBlock Text="No WIFI etc. etc." />
</StackPanel> 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T22:01:39.187

您应该将这些东西放入 a 中`UserControl`，然后`UserControl`在需要内容时引用

# jquery - Jquery - 选择 大约

> ID：10404852
> 
> 赞同：4
> 
> 时间：2012-05-01T21:47:52.930
> 
> 标签：jquery, jquery-selectors, selector

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-01T21:49:23.387

很简单：

```
$('a[href="specific-url"]').parent('li'); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-01T21:49:45.410

干得好：

```
$('li:has(a[href="specific-url"])') 
```

[**现场演示**](http://jsfiddle.net/Qf6Bp/)

另一种方法是：

```
$('li > a[href="specific-url"]').parent() 
```

[**现场演示**](http://jsfiddle.net/Qf6Bp/1)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T21:49:41.760

```
$("a[href='specific-url']").parent("li"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-01T21:49:42.030

匹配`a`then 调用`.parent()`。

**编辑**哎呀，花 30 秒检查你的答案，*三*个人在你前面进入那里......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-01T21:50:09.027

```
$('a[href="specifi_url"]').parent('li'); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-01T21:51:09.377

```
$("li a[href='specific-url']").parent(); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-01T21:52:06.287

```
$("li > a[href='specific_url']").parent() 
```

# android - Actionbarsherlock 布局参数（在底部对齐 NAVIGATION_MODE_TABS）

> ID：10404857
> 
> 赞同：3
> 
> 时间：2012-05-01T21:48:18.830
> 
> 标签：android, actionbarsherlock

我想使用 Actionbarsherlock 使选项卡在布局底部对齐。片段视图在其上方而不是下方加载的位置。

这将如何完成？目前在`onCreate`我正在做

```
getSupportActionBar().setNavigationMode(ActionBar.NAVIGATION_MODE_TABS);
getSupportActionBar().setDisplayShowHomeEnabled(false);
getSupportActionBar().setDisplayShowTitleEnabled(false);` 
```

并且看不到`getSupportActionBar()`有利于其在屏幕上的位置的明显功能。

洞察力赞赏

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-01T22:22:29.900

这是无法做到的。选项卡内置于始终位于屏幕顶部的操作栏。操作栏行为本身由 Android 内置的本机操作栏决定。ActionBarSherlock 仅在 ICS 之前模仿其行为。

如果本机操作栏不支持某个功能，那么 ActionBarSherlock 也将无法支持它。

一个更简单的方法是`TabWidget`在布局的底部放置 a 并将它们主题化为看起来像 ICS 样式的选项卡。

# java - Java中的多态、继承和数组排序练习

> ID：10404860
> 
> 赞同：0
> 
> 时间：2012-05-01T21:48:42.290
> 
> 标签：java, arrays, sorting, polymorphism

我正在为一个类项目工作，我被要求获取一个 .txt 文件，将数据聚合到不同的对象中，然后根据共享特征对该列表进行排序。我的指示是使程序能够导入多达 200 行文本。

我已经成功实现了导入 .txt 文件的程序，给定了一个定义的数组大小（如果 .txt 文件有 6 行，则为 6 个元素的数组），但我需要能够定义最多 200 个元素。当超出实际元素的数量（例如 6 个）时，它会引发 NullPointerException。当我的代码出现时，我似乎无法找到可能发生这种情况的地方，至少在视觉上，以处理可能发生的任何实例。这是发生问题的地方：

```
public Solid[] solids;
public int length;
public Measurer m;
public int h;

public SolidList(int size) {
    length = 0;
    solids = new Solid[size];
}

public void addSorted(Solid foo, Measurer m) {
    int k = 0;
    if (length != 0) {
        while ((k < length) && foo.greaterThan(solids[k], m))
            ++k;
        for (int j = length; j > k; --j)
            solids[j] = solids[j - 1];
    }
    solids[k] = foo;
    ++length;
} 
```

具体来说，Eclipse 在`addSorted(...)`. 只有当数组确实有空元素时才会发生这种情况，但我想我无法弄清楚如何阻止该方法尝试访问空元素。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-01T21:56:25.320

```
if (length != 0) {
    while ((k < length) && solids[k] != null && foo.greaterThan(solids[k], m))
        ++k;
    if(solids[k] == null) {
        return;
    }
    for (int j = length; j > k; --j)
        solids[j] = solids[j - 1];
} 
```

或许能解决问题。但是您应该真正考虑使用集合（查看 ArrayList）来处理动态输入长度的集合/数组。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-01T21:54:07.283

> 我不知道如何阻止该方法尝试访问空元素。

`null`在执行任何将其用作值的操作之前检查数组的特定索引是否等于。

# ruby-on-rails-3 - Rails 3 视图 - 向上取整

> ID：10404864
> 
> 赞同：0
> 
> 时间：2012-05-01T21:48:53.460
> 
> 标签：ruby-on-rails-3

我有一个 Rails 视图来按 PERIOD 和 GENERAL LEDGER 显示一个网格，我想显示一个累计总数。然而，在下面的例子中，我在“TOTAL”列中的@cumulative_total 正在四舍五入到最接近的美元，因此没有显示美分，即使它们在 general_ledger 列中正确显示。任何想法我做错了什么？

```
<% @cumulative_total = 0 %>
<div id="gl_crosstab">
  <table>
    <tr>
      <th>Period</th>
      <% @general_ledgers.each do |g| %>
        <th><%= g.general_ledger_number %></th>
      <% end %>
      <th>Total</th>
      <th>% Expended</th>
    </tr>
    <% @expected_billings.group_by(&:period_id).each do |eb| %>
      <tr>
        <td><%= eb[1].first.period.pe_number %></td>
        <% eb[1].each do|p| %>
          <td><%= number_to_currency(p.expected_amount) %></td>
        <% end %>
        <td>
          <% @cumulative_total = @cumulative_total + eb[1].inject(0){|sum,billing| sum+billing.expected_amount.to_i} %>
          <%=  number_to_currency( @cumulative_total ) %> </td>
        <td><%= number_to_currency((@cumulative_total/@sla.project_total)*100) %> % </td>
      </tr>
    <% end %>
    <tr>
      <td><b>Total Budget</td>
      <% @total_expected_billings.each do |teb| %>
        <td><b><%= number_to_currency(teb[1].inject(0){|sum,billing| sum+billing.expected_amount.to_i}) %></td>
      <% end %>
      <td><b><%= number_to_currency(@expected_billings.inject(0){|sum,billing| sum+billing.expected_amount.to_i}) %> </td>
      <td><b><%= number_to_currency((@expected_billings.inject(0){|sum,billing| sum+billing.expected_amount.to_i}/@sla.project_total)*100) %> % </b></td>
    </tr>
  </table>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T06:53:49.623

我认为这是因为您在显示时将计费金额转换为“整数”：

```
@expected_billings.inject(0){|sum,billing| sum+billing.expected_amount.to_i 
```

如果你改变

```
billing.expected_amount.to_i 
```

到

```
billing.expected_amount.to_f 
```

它应该工作。

# ios - ios 推特包装器

> ID：10404867
> 
> 赞同：1
> 
> 时间：2012-05-01T21:49:06.127
> 
> 标签：ios, twitter, wrapper

我需要包装器才能在 iOS 中使用 twitter api。

现在我已经使用了一些教程，但是我有更多的错误并且与 iOS 的版本不兼容。

任何人都知道 twitter 包装器与 iOS 的 facebook api 相同。

我尝试使用 MGTwitterEngine，但 iOS 5.0 出现问题

对于 iCodeOuth 项目，iOS 5.0 也有问题（授权用户返回 null）

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T22:00:45.050

如果您使用的是 iOS 5.0 或更高版本，您应该查看[Apple 的 Twitter 框架](http://developer.apple.com/library/ios/#documentation/Twitter/Reference/TwitterFrameworkReference/_index.html)

# javascript - elasticsearch可以对数字字段进行统计吗？

> ID：10404876
> 
> 赞同：0
> 
> 时间：2012-05-01T21:49:44.503
> 
> 标签：javascript, elasticsearch

如果我有一个像

```
 "histogram": {
    "key_field": "timestamp",
    "value_field": "amount",
    "time_interval": "1d"
  } 
```

我得到了一个结果集

```
{
  key: 1222732800000
  count: 642
  min: -985
  max: 483.25
  total: 1544.4000024795532
  total_count: 642
  mean: 2.4056074804977463
} 
```

有没有一种方法可以让我获得最高点和最低点？换句话说，如果金额是一个数字系列，如：

```
-4, -8, 10, -3, 30, -20 
```

我需要的是一种方法来确定计数的峰值低为 -12，其峰值高为 25。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T23:23:10.170

不，elasticsearch 不支持此操作。

# java - 多态性和构造函数

> ID：10404879
> 
> 赞同：19
> 
> 时间：2012-05-01T21:49:50.433
> 
> 标签：java, polymorphism

我是一名 AP Java 学生，我正在准备考试。我遇到了这个问题，但我不明白答案：

考虑以下类：

```
public class A
{
  public A() { methodOne(); }

  public void methodOne() { System.out.print("A"); }
}

public class B extends A
{
  public B() { System.out.print("*"); }

  public void methodOne() { System.out.print("B"); }
} 
```

执行以下代码时的输出是什么：

```
A obj = new B(); 
```

正确答案是 B*。有人可以向我解释方法调用的顺序吗？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-05-01T21:55:40.897

调用 B 构造函数。B构造函数的第一个隐式指令是`super()`（调用超类的默认构造函数）。所以A的构造函数被调用。A 的构造函数调用`super()`，它调用 java.lang.Object 构造函数，它不打印任何内容。然后`methodOne()`被调用。`methodOne`由于对象属于 B 类型，因此调用并`B`打印B 的版本。然后 B 构造函数继续执行，并被`*`打印出来。

必须注意的是，从构造函数调用可覆盖的方法（就像 A 的构造函数一样）是非常糟糕的做法：它调用尚未构造的对象上的方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T21:53:23.760

基类必须在派生类之前构造。

首先`A()`是调用 which 调用`methodOne()`which prints `B`。

接下来，`B()`称为 which prints `*`。

# android - Android 媒体播放器在姜饼中花费了很多时间

> ID：10404885
> 
> 赞同：0
> 
> 时间：2012-05-01T21:50:29.597
> 
> 标签：android, android-mediaplayer

我在播放音频流时遇到问题。该应用程序已使用不同的 API 进行了测试。姜饼（API 10）中的媒体播放器在准备状态上大约需要 30-40 秒，但在 API 7 上，准备状态只需要大约 5-10 秒。谁知道怎么修它？

我查看了不同的论坛，但没有得到答案。

先谢谢了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T22:47:19.220

问题与 Gingerbread 中的缓冲是基于固定字节的事实有关，而不是与播放流所需的时间有关。如果流是低保真度的，则缓冲需要很长时间。除了编写自己的流媒体播放器外，没有其他解决方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T09:45:10.950

Thanks. Find enclosed an example. ¿Could be ok to improve the performance?

[http://blog.infidian.com/2009/12/27/android-streaming-mediaplayer-tutorial-updated-to-v1-5-cupcake/](http://blog.infidian.com/2009/12/27/android-streaming-mediaplayer-tutorial-updated-to-v1-5-cupcake/)

# javascript - 使用 Jquery 剥离 HTML 标签

> ID：10404888
> 
> 赞同：0
> 
> 时间：2012-05-01T21:50:43.120
> 
> 标签：javascript, jquery, html

示例：http: [//jsfiddle.net/axfsD/1/](http://jsfiddle.net/axfsD/1/)

我正在尝试在我的页面中去除 HTML 标签。我在下面还粘贴了两个示例。通过使用**替换**命令，我无法删除第一个按钮的标签，但我无法删除第二个按钮的标签。可能是什么问题？

```
< script >
    $('button').replace(/<.*?>/g, "");
< /script>​

<button class="btn btn-info" rel="popover" data-content="hic   
aslinda sen de olabilir " data-original-title="Gemlik Bursa">
<small><span title="">mihan tosun</span></small></button>

<button class="btn btn-info" rel="popover" 
data-content="Benim olan benimdir Baskasinda gorduysen bil ki vazgecmisimdir   " 
data-original-title=""> <small><span title="">
Senin TAMER</span></small></button>​​​ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T21:53:00.467

你为什么要这样做？也许`$.text()`[ [Link to doc](http://api.jquery.com/text/ "文档") ] 可以满足您的需要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T21:56:20.000

您的问题是因为 replace() 是本机 JS 函数，而不是 jQuery 函数。所以它不会在所有按钮上重复。这是另一种更强大的方法。

```
$('button').each(function(){
    var buttonText = $(this).text();
    $(this).empty().text(buttonText);
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T21:55:04.063

不要在 HTML 中使用正则表达式。说真的，[只是不要](https://stackoverflow.com/a/1732454/851498)。

如果您只想要文本，请使用该`text()`方法。据我了解，这就是你想要的：

```
$( 'button' ).each( function( index, value ) {
    $( this ).html = $( this ).text()
} ) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-01T21:56:38.407

我不会在按钮内使用 html 标签。如果需要更改按钮文本的外观，可以使用 css。然后您可以使用 .html() jquery 函数获取按钮的值。

# c++ - gcc：缺乏关于构造函数中初始化顺序的警告

> ID：10404889
> 
> 赞同：2
> 
> 时间：2012-05-01T21:50:47.270
> 
> 标签：c++, gcc, initialization, initializer-list

gcc 是否应该警告成员变量`a`和`b`C 类中的初始化顺序？基本上，对象 b 已初始化，并且在对象 A 之前调用它的构造函数。这意味着`b`使用未初始化的`a`.

```
#include <iostream>

using namespace std;

class A
{
    private:
        int x;
    public:
        A() : x(10) { cout << __func__ << endl; }
        friend class B;
};

class B
{
    public:
        B(const A& a) { cout << "B: a.x = " << a.x << endl; }
};

class C
{
    private:
        //Note that because b is declared before a it is initialized before a
        //which means b's constructor is executed before a.
        B b;
        A a;

    public:
        C() : b(a) { cout << __func__ << endl; }
};

int main(int argc, char* argv[])
{
    C c;
} 
```

来自 gcc 的输出：

```
$ g++ -Wall -c ConsInit.cpp 
$ 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-01T22:10:14.780

为了使这成为初始化问题的顺序，您实际上需要尝试以错误的顺序初始化子对象：

```
public:
    C() : a(), b(a) { cout << __func__ << endl; } 
          ^^^ this is attempted initialization out of order 
```

如所写，唯一的违规行为是在对象 ( ) 的生命周期开始之前将引用（ 的参数`B::B(const A&)`）绑定到对象 ( )，这是一个非常值得怀疑的违规行为，因为在 $3.8[basic.life]/ 下`C::a`获取指向实际上是合法的`a`5（并且在a的初始化之前取消引用它是UB）

# c# - 删除客户记录时删除 ASP.NET 用户帐户？

> ID：10404890
> 
> 赞同：1
> 
> 时间：2012-05-01T21:50:55.527
> 
> 标签：c#, asp.net-mvc-3

当客户删除其用户配置文件时，您如何删除 ASP.NET 用户帐户；关于如何解决这个问题的任何建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T22:07:06.090

如果您的客户帐户中仍有与之关联的记录，您可能不想删除该用户以保持数据完整性。删除实际的 aspnet 成员记录实际上应该是一项管理工作。

在我看来，您应该`.IsApproved`将用户对象上的标志设置为 false 并拥有一个允许

1.  确保可以在不影响记录（孤立数据）的情况下删除帐户的手动方法或

2.  创建一个可以在`IsApproved == false`.

我的投票完全反对删除，以免您的数据库处于不一致的状态

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T22:11:59.117

您应该将 MembershipUser.IsApproved 设置为 false 并调用[Membership.UpdateUser()](http://msdn.microsoft.com/en-us/library/system.web.security.membership.updateuser.aspx)来保存更新。

```
MembershipUser membershipUser = Membership.GetUser("MyUserName");
if (membershipUser!= null){
    membershipUser.IsApproved = false;
    Membership.UpdateUser(membershipUser);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T22:06:15.547

调用 API 删除账号？听起来微不足道。将其放入您的工作流程中。

# .htaccess - .htaccess 不能满足我对 CakePHP 的期望

> ID：10404892
> 
> 赞同：2
> 
> 时间：2012-05-01T21:50:59.063
> 
> 标签：.htaccess, cakephp, routing

Web 服务器上有 /localhost/domains/localhost/myCakephpApp。我不能对文件夹结构做任何事情，但我可以在 /localhost/ 中编辑 .htaccess，现在简化如下：

```
RewriteRule (.*) /domains/localhost/$1 [L] 
```

我在 localhost/domains/localhost/myCakephpApp 中的网站有标准的 cake .htaccess 文件：

```
RewriteRule    ^$ app/webroot/    [L]
RewriteRule    (.*) app/webroot/$1 [L] 
```

[http://localhost/whatever/](http://localhost/whatever/)很好，但是 cakephp 中的所有链接（使用 html 助手完成）都指向[http://localhost/domains/localhost/whatever/](http://localhost/domains/localhost/whatever/)并且可以访问。

我应该怎么做才能使网站仅在[http://localhost/](http://localhost/)而不是[http://localhost/domains/localhost/](http://localhost/domains/localhost/)上运行？

编辑：

好的，我已经修改了根目录下的 .htaccess（http://localhost/）：

```
RewriteRule ^$ /domains/localhost/app/webroot/ [L]
RewriteRule (.*) /domains/localhost/app/webroot/$1 [L] 
```

[并在http://localhost/domains/localhost/](http://localhost/domains/localhost/)中删除了一个，这意味着只能从[http://localhost](http://localhost)访问网络，但链接仍然指向[http://localhost/domains/localhost/whatever](http://localhost/domains/localhost/whatever) (e404)

蛋糕的路由中是否有诸如“基本网址”之类的东西？我搜索了很多，但没有任何效果。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T20:55:46.883

问题是 CakePHP 使用来自服务器的原始 uri 来解析动作，而不是重写的！

在 bootstrap.php 中试试这个“hack”：

```
Configure::write('App.base', '/');
$_SERVER['REQUEST_URI'] = preg_replace('|/domains/localhost|', '', $_SERVER['REQUEST_URI']); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-02T18:33:17.357

您可以添加重定向路由：

```
Router::redirect('/domains/myDomainName.com/*', '/'); 
```

如果要完全禁用路由，可以重定向到 404 页面。像这样的东西应该工作：

```
Router::redirect('/domains/myDomainName.com/*', array('controller'=>'pages', 'action'=>'error-404'), array('status' => '404')); 
```

加上在 /View/Pages/error-404.ctp 中添加 404 页。

# javascript - 离开未保存的表单：按钮提交事件将重置“Changed_Form”状态

> ID：10404897
> 
> 赞同：0
> 
> 时间：2012-05-01T21:51:36.767
> 
> 标签：javascript, jquery, asp.net, forms, postback

请参阅以下代码示例。

HTML：

```
<asp:TextBox ID="TextBox1" runat="server"></asp:TextBox>
<asp:FileUpload ID="FileUpload1" runat="server" />

<!--  upload button and Save button -->
<asp:Button ID="Upload" runat="server" Text="Upload" />
<asp:Button ID="Save" runat="server" Text="Save" />
<a href="otherpage.aspx">Cancel</a> 
```

JavaScript: //form 默认不改变 var form_Change = 0;

```
window.onbeforeunload = function(e) {
if (form_Change==1){
    // if the form is changed, show a confirm box
    return 'Are you sure you want to navigate away from this page?';
}
}

$('input[type=text]').live('keyup',function(){
form_Change =1;
}); 
```

一般，

用户在文本框中键入但未保存。然后他正试图重定向到其他页面或重新加载页面，Bowser 给他带来了一个确认框。

但，

我首先在文本框中输入，然后单击用于上传文件但不保存（不影响更改）表单的“上传按钮”（并将未保存的文本保留在文本框中）回发）。Bowser 给我带来了**不需要的**确认框。

我尝试修复它并添加类似的东西，

```
var button_inside_form =0;
$('Upload').live('click',function(){
    button_inside_form =1;
});

//and update form change logic in onbeforeunload 
```

但是，页面回帖后。它重新加载 JavaScript，`form_Change`重置为 0。因此系统不知道表单是否已更改。

那么如何检查点击“上传”后表单是否更改，并且点击“上传”时不带回确认框。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T13:05:37.133

自己回答。

我用饼干。这就是`var form_change`JavaScript 中的 cookie。

然后在服务器代码中，不是 IsPostBack，我添加它来重置 cookie。

```
ClientScript.RegisterClientScriptBlock(Me.GetType, "IsPostBack", "var isPostBack = true;", True) 
```

去检查

```
if (typeof isPostBack != 'undefined') {
    resetFormChange();} 
```

使用它来防止提交按钮上的确认框

```
$('form').submit(function() {
    window.onbeforeunload = null;
}); 
```

多思考。如果表单提交将保留在同一页面中，则需要 cookie。form.submit 可以正常工作，但需要确保需要在“取消”按钮上设置“UseSubmitBehaviors”。或者如果导致页面停留，最好将它们放在更新面板中。

# asp.net-mvc - 使用最新的 Uploadifive 通过 Asp.Net MVC 获取 HttpPostedFileBase 的 Null 值

> ID：10404898
> 
> 赞同：2
> 
> 时间：2012-05-01T21:51:51.857
> 
> 标签：asp.net-mvc, uploadify

所以我试图用 Asp.NET MVC 实现 Uploadifive 1.0。使用调试器模式，我知道上传动作成功传递给Controller，Server变量也传递了。但是，HttpPostedFileBase 变量 fileData 始终为空。我在谷歌上到处找，找不到答案。我发现该变量必须称为 fileData。但这无济于事。

这是视图的一部分：

```
<form action="<%: Url.Action("SaveFiles", "File") %>" enctype="multipart/form-data">
    <input type="file" name="file_upload" id="file_upload" />
</form>

<script type="text/javascript">
    (function ($) {
        $(document).ready(function () {
             $('#file_upload').uploadifive({
                 'method': 'post',
                 'uploadScript': 'SaveFiles',
                 'formData': {'path' : 'documents'}
             });
        });
    })(jQuery);
</script> 
```

这是控制器动作：

```
[HttpPost]
public ActionResult SaveFiles(HttpPostedFileBase fileData)
{
    string uploadFolder = Request.ServerVariables.Get("HTTP_X_PATH");
    if(string.IsNullOrWhiteSpace(uploadFolder))
        return Json(JsonMessageManager.GetFailureMessage("No upload folder was selected"));

    if (fileData != null && fileData.ContentLength > 0)
    {
        var fileName = Path.GetFileName(fileData.FileName);
        var path = Path.Combine(Server.MapPath("~/Content/" + uploadFolder), fileName);
        fileData.SaveAs(path);
        return Json(true);
    }
    return Json(false);            
} 
```

任何指针或帮助将不胜感激。我感到失落。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T02:58:49.223

我在 Uploadifive 上遇到了完全相同的问题，所以我在 Uploadify 论坛上的一个现有线程（可能是你的）上发帖。此后，作者发布了我下载的 Uploadifive 插件的更新，现在这对我来说很好用。事实上，它的工作方式与 Uploadify 过去在“Request.Forms”中包含可用的附加表单数据完全一样，并且它不再将“X_”添加到附加表单数据中。我建议您尝试新版本，看看您的情况如何。

请参阅此处的讨论：[http ://www.uploadify.com/forum/#/discussion/8223/no-files-attached-to-request](http://www.uploadify.com/forum/#/discussion/8223/no-files-attached-to-request)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-31T18:46:39.290

关键不是命名您的变量“fileData”，而是确保您的控制器和 UploadiFive 都认为它具有相同的名称。例如：

Javascript：

```
$(document).ready(function () { 
  $('#fileUploadDiv').uploadifive({
      'uploadScript': '/File/Upload',
      'fileObjName' : 'file'
  });
}); 
```

C#控制器：

```
 [HttpPost]
    public PartialViewResult Upload(HttpPostedFileBase file)
    {
        var name = file.FileName;
        var stream = file.InputStream;
        // etc...
    } 
```

只要与`fileObjName`C# 控制器中的参数名称相同，就可以了。我用各种名称对其进行了测试，如果名称不匹配，则参数为 null，当它们匹配时，它就像一个魅力。

如果参数仍然不起作用，您应该能够使用`this.Request.Files`控制器内部访问数据。看起来无论参数名称如何，数据都会通过。

# jquery - 在 jQuery 中使用 id 检查元素是否在上面的单元格中

> ID：10404902
> 
> 赞同：0
> 
> 时间：2012-05-01T21:52:16.007
> 
> 标签：jquery, html-table, jquery-selectors, children

我在尝试确定是否在带有`id=#blankElement`.

事件处理程序可以很好地单击指定元素右侧或左侧的单元格，但如果单击任何其他单元格，我会收到“单元格在上方”警报。

```
$(function () {
    var $tbl = $('<table border="1">').attr('id', 'grid');
    var $tbody = $('<tbody>').attr('id', 'tableBody');

    for (var i = 0; i < $("#numOfPieces").val(); i++) {

        var trow = $("<tr>"); // New row

        for (var j = 0; j < $("#numOfPieces").val(); j++) {
            $("<td>")
                    .text('Row : ' + i + ', Col: ' + j)
                    .appendTo(trow);
        }

        trow.appendTo($tbody);
    }

    $tbl.append($tbody);
    $('table').remove();
    $('body').append($tbl);
    $('#grid tr:first td:last').prev().text("");
    $('#grid tr:first td:last').prev().attr('id', 'blankElement');
});

// Event handler for clicking table cells
$('body').on('click', '#grid td', function(e) {

    if ($(this).closest('td').next("#blankElement").length){
        alert('Cell to the right');

    }else if ($(this).closest('td').prev("#blankElement").length){
        alert('Cell to the left');

    }else if ($(this).parent().next().children().eq($(this).index())){
        alert('Cell is above');
    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T22:18:48.973

好了，伙计们，小提琴：http: [//jsfiddle.net/yQk28/23/](http://jsfiddle.net/yQk28/23/)

您的代码有很多问题：

1.  eq() 就像一个选择器，将返回元素数组。当什么都不匹配时，它将返回 []，它的计算结果仍然为 true。

2.  您正在选择所有子元素，而不仅仅是您要查找的元素（children() 充当 $() - 您可以传递其他选择器，它会为您过滤子元素）

看看小提琴它很简单

代码：

```
$('body').on('click', '#grid td', function(e) {

    if ($(this).closest('td').next("#blankElement").length) {
        alert('Cell to the right');

    } else if ($(this).closest('td').prev("#blankElement").length) {
        alert('Cell to the left');

    } else if ($(this).parent().next().children("#blankElement").index() == $(this).index()) {
        alert('Cell is above');
    }
});​ 
```

# asp.net-mvc-3 - linq select加入razor页面显示

> ID：10404907
> 
> 赞同：1
> 
> 时间：2012-05-01T21:52:44.513
> 
> 标签：asp.net-mvc-3, linq, anonymous-types

这是控制器：

```
public ActionResult Index()
{

   var result = from u in myContext.Users
             join g in myContext.Groups
             on u.gid equals g.id
             select new {
                 u.username,
                 g.name
             };

   return View(result );
} 
```

这是视图

```
@model IEnumerable<eTravel1.Models.User>
...
@Html.DisplayNameFor(model => model.username)
@Html.DisplayNameFor(model => model.name)
.. 
```

返回的匿名数据在 View 中不兼容。如果有人可以提供一些建议，我真的很感激。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T21:56:00.647

您应该像这样创建一个 ViewModel 类：

```
public class UserViewModel{

    //class constructor
    public UserViewModel(String userName_p, String name_p){
         this.UserName = userName_p;
         this.Name = name_p;
    }

    //class attributes
    String UserName {get; set;}
    String Name {get; set;}
} 
```

创建该类的对象：

```
var result = from u in myContext.Users
                 join g in myContext.Groups
                 on u.gid equals g.id
                 select new UserViewModel(
                     u.username,
                     g.name
                 ); 
```

最后，以同样的方式将此对象传递给您的视图：

```
//returning an IEnumerable<UserViewModel> data type
return View(result.AsEnumerable()); 
```

在您的视图中，您应该期望这种完全相同的数据类型：

```
//change the UserViewModel to your complete namespace!
@model IEnumerable<UserViewModel> 
```

我强烈建议您阅读有关**“ViewModel 最佳实践”的**[这个](https://stackoverflow.com/questions/664205/viewmodel-best-practices)stackoverflow 问题。

 **希望能帮助到你！**

# php - 如何在不使用全局 php 的情况下在函数之外获取 $var？

> ID：10404908
> 
> 赞同：0
> 
> 时间：2012-05-01T21:52:45.230
> 
> 标签：php, function, global-variables

在这里需要一点帮助。正在阅读在函数中添加全局变量并在外部调用它是多么糟糕，但是在外部获取变量时遇到了小问题。全球帮助，但我也想安全，因为我在这里处理一些文件

我的循环是这个

```
<?php 
require_once('functions.php'); 
?>

<?php 
foreach( $files as $key=> $file ){  

global $download_link;
get_file_info($key,$file);
?>

<span><a href="<?php echo $download_link ?>"><?php echo $file->name ?></a></span>

<?php } ?> 
```

**我的function.php** / 的一部分大约有 150 行，但这是主要片段

```
function  get_file_info($key,$file){

global $download_link;
$access     = explode(",",$file->access);
$permission = in_array(1,$access);

if($permission){

$download_link = 'ok to download';
}else{
$download_link = 'canot download';
}

} 
```

除了链接 var 我还有一些其他的东西，比如 date 、 counter 等，但它们都受某些条件的约束。

我试着做

返回$链接；在函数结束时使用全局但出现未定义变量错误；

这里的基本问题是，如何在不使用全局的情况下获取函数外部的 download_link var？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T21:58:01.810

通过修改 File 类，您可以更轻松地做到这一点

```
class File {

    # ...

    function get_url() {
        return in_array(1, explode(',', $this->access))
            ? $this->url  # return the file's url
            : "/path/to/subscribe" # return a default path for non-access
        ;
    }
} 
```

您的 HTML 将按如下方式使用它

```
<?php

foreach ($files as $file) {
    echo '<a href="'.$file->get_url().'">Download this '.$file->name.'</a>';
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T21:58:25.410

既然你只是`get_file_info`用来 set `$download_link`，为什么不直接在函数外返回`$permission`和定义呢？`$download_link`

```
<?php 
function  get_file_info($key,$file){
    $access     = explode(",",$file->access);
    $permission = in_array(1,$access);
    return $permission;
}

foreach( $files as $key=> $file ){  
    $download_link = 'canot download';
    if(get_file_info($key,$file)) {
        download_link = 'ok to download';
    }
    echo '<span><a href="$download_link ">'. $file->name . '</a></span>';
} 
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T22:07:28.693

您可以像这样更改循环：

```
 <?php 
require_once('functions.php'); 
?>

<?php 
foreach( $files as $key=> $file ){  

   $download_link = get_file_info($key,$file);

?>

<span><a href="<?php echo $download_link ?>"><?php echo $file->name ?></a></span>

<?php } ?> 
```

你的功能代码：

```
 function  get_file_info($key,$file){
 $access     = explode(",",$file->access);
 $permission = in_array(1,$access);

  if($permission){

return  'ok to download';
  }
  else {
return 'canot download';
  }
 } 
```

# logging - 无需重启服务器即可新建日志文件

> ID：10404913
> 
> 赞同：1
> 
> 时间：2012-05-01T21:53:07.133
> 
> 标签：logging, websphere-6.1, logfiles

在此链接中，他们解释了如何在不重新启动 sql server 的情况下生成新的日志文件：http: [//blog.sqlauthority.com/2010/11/09/sql-server-recycle-error-log-create-new-log-没有服务器重启的文件/](http://blog.sqlauthority.com/2010/11/09/sql-server-recycle-error-log-create-new-log-file-without-server-restart/)

有没有办法在不重新启动 WebSphere 应用程序服务器的情况下生成新的 SystemOut.log 文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T14:45:41.630

您可以配置“最大大小”和“最大历史日志文件数”。请参阅信息中心中的[Java 虚拟机 (JVM) 日志设置](http://publib.boulder.ibm.com/infocenter/wasinfo/v6r1/topic/com.ibm.websphere.nd.multiplatform.doc/info/ae/ae/utrb_jvmlogs.html)文章。

[此外，您可以使用TraceService](http://publib.boulder.ibm.com/infocenter/wasinfo/v6r1/topic/com.ibm.websphere.javadoc.wsfep.doc/web/mbeanDocs/TraceService.html) MBean的`rolloverLogFileImmediate`操作强制立即翻转日志。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T07:34:19.193

这是我通常在 Unix 的开发环境中所做的事情。

每当我需要新文件时，我只需执行 echo > SystemOut.log，这对于大多数开发目的都非常有效。

显然，您不能在其他环境中执行此操作。

# sql - 强制 sql 查询返回结果

> ID：10404916
> 
> 赞同：0
> 
> 时间：2012-05-01T21:53:27.720
> 
> 标签：sql, tsql

这是我的 SQL：

```
-- Order information
SELECT ISNULL(p.PaymentAmt, 0) AS PaymentAmt, o.TaxAmt, o.PostAmount, o.OrderDate, o.PublicNotes, u.userid, PostAmount + TaxAmt AS Total, PostAmount - PaymentAmt AS Due
FROM Orders o 
INNER JOIN Payment p ON p.OrderID = o.OrderID
INNER JOIN Users u  ON o.EnteredBy = u.UserKey
Where o.OrderID = 5267 
```

现在对于这个特定的 OrderID，它只返回 0 行只是列标题。有没有办法强制它为值返回 0 并为其余部分返回空字符串？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-01T22:01:37.640

我认为它应该给你想要的结果：

```
WITH CTE1 AS (SELECT ISNULL(p.PaymentAmt, 0) AS PaymentAmt, o.TaxAmt, o.PostAmount,  
   o.OrderDate, o.PublicNotes, u.userid, PostAmount + TaxAmt AS Total, PostAmount -    
    PaymentAmt AS Due 
    FROM Orders o  
    INNER JOIN Payment p ON p.OrderID = o.OrderID 
    INNER JOIN Users u  ON o.EnteredBy = u.UserKey 
    Where o.OrderID = 5267 
    AND o.EnteredBy = u.UserKey )
SELECT CTE1.*
FROM CTE1
UNION ALL
SELECT 0,0, NULL,NULL,NULL,NULL,NULL
WHERE NOT EXISTS (SELECT 1 FROM CTE1) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T22:14:26.560

其他方式：

```
SELECT ISNULL(p.PaymentAmt, 0) AS PaymentAmt, o.TaxAmt, o.PostAmount, 
       o.OrderDate, o.PublicNotes, u.userid, 
       PostAmount + TaxAmt AS Total, PostAmount - PaymentAmt AS Due
FROM Orders o 
  INNER JOIN Payment p ON  p.OrderID = o.OrderID
                       AND o.OrderID = 5267        --- condition moved here
  INNER JOIN Users u  ON o.EnteredBy = u.UserKey
  RIGHT JOIN (SELECT 1 dummy) trick ON 1=1         --- this line was added

---  AND o.EnteredBy = u.UserKey                   --- this is redundant 
```

# ruby-on-rails-3 - rails -v 使用 rvm 时显示错误的版本

> ID：10404917
> 
> 赞同：1
> 
> 时间：2012-05-01T21:53:31.247
> 
> 标签：ruby-on-rails-3, rvm

我刚刚尝试使用带有以下命令的 RVM 更新到 Rails 3.1.3：

> rvm 安装 ruby​​-1.9.3-p0
> 
> rvm --默认使用 ruby​​-1.9.3-p0

如果我查询当前版本或 ruby​​：

> 红宝石-v

我得到了正确的版本：ruby 1.9.3p0（2011-10-30 修订版 33570）[x86_64-darwin10.8.0]

然后更新宝石：

> 宝石更新--系统

这给了我版本 1.8.24

然后我创建我的 gemset 并将其设置为我的默认值：

> rvm ruby​​-1.9.3-p0@rails313 --create --default

最后安装 Rails gem：

> 宝石安装导轨

当我查询 rails 的版本时：

> 导轨-v

我得到 Rails 3.0.11 ...我的旧版本 Rails

如果我尝试启动我的 Rails 服务器

> 导轨

我得到一个巨大的错误：

> .rvm/gems/ruby-1.9.3-p0@rails313/gems/activesupport-3.0.11/lib/active_support dependencies.rb:239:in `require': dlopen(/Users/lss_dev/.rvm/gems/ruby -1.9.3-p0@rails313/gems/ruby-debug-base19-0.11.25/lib/ruby_debug.bundle，9）：找不到符号：_ruby_current_thread（LoadError）

有很多关于依赖关系的抱怨。

我的 gemfile.lock 确实包含以下块：

> 导轨 (3.0.11)
> 
> ```
>  actionmailer (= 3.0.11)
> 
>   actionpack (= 3.0.11)
> 
>   activerecord (= 3.0.11)
> 
>   activeresource (= 3.0.11)
> 
>   activesupport (= 3.0.11)
> 
>   bundler (~> 1.0)
> 
>   railties (= 3.0.11) 
> ```

这是否与它有关，或者我什至应该触摸 gemfile.lock 文件？

我正在使用 rvm 版本 1.10.0，任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-04T10:23:51.417

回答我自己的（扩展的）问题......

破坏 gemfile.lock 文件让我可以运行

> 捆绑安装

确保我将我的 Rails gem 设置为正确的版本（3.1.3），它有效。我当时遇到的问题是当我启动我的 Rails 服务器时，出现以下浏览器错误

**ActionController::Base:Class 的未定义方法“consider_all_requests_local”**

最初我认为这是由于 Rails 3.1 中的一些路由更改造成的。* 正如我的 application_controller.rb 文件中所证明的那样，我正在处理 404 错误并具有以下块：

```
unless ActionController::Base.consider_all_requests_local
   rescue_from Exception, :with => :render_404
end 
```

> ActionController::Base.consider_all_requests_local

现在已弃用并替换为：

> Rails.application.config.consider_all_requests_local

成功了。

感谢您的帮助，我希望这对未来的人有所帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T01:27:48.240

您可能必须交换 rvm / ruby​​ 的版本，然后再安装。这可能有用：[https ://rvm.io/gemsets/basics/](https://rvm.io/gemsets/basics/)

# java - 如何在 RBDMS 或 NOSQL 数据存储或其他消息传递系统（例如，rabbitmq）之上实现分布式队列类事物？

> ID：10404921
> 
> 赞同：7
> 
> 时间：2012-05-01T21:53:47.903
> 
> 标签：java, python, nosql, message-queue, rabbitmq

从不会很酷的问题类别中......

我所说的“类似队列的东西”是指支持以下操作：

*   append(entry:Entry) - 将条目添加到队列尾部
*   take(): Entry - 从队列头部删除条目并返回它
*   提升（entry_id） - 将条目移动到靠近头部的位置；当前占据该位置的条目被移动到旧位置
*   demote(entry_id) - 与promote(entry_id) 相反

可选操作类似于：

*   提升(entry_id, amount) - 与提升(entry_id) 类似，但您指定职位数
*   降级(entry_id, amount) - 与promote(entry_id, amount) 相反
*   当然，如果我们允许 amount 为正数或负数，我们可以将提升/降级方法与单个 move(entry_id, amount) 方法合并

如果可以以分布式方式在队列上执行以下操作（多个客户端与队列交互），那将是理想的：

```
queue = ...

queue.append( a )
queue.append( b )
queue.append( c )

print queue
"a b c"

queue.promote( b.id )
print queue
"b a c"

queue.demote( a.id )
"b c a"

x = queue.take()
print x
"b"
print queue
"c a" 
```

有没有特别适合这个用例的数据存储？即使多个用户同时修改队列，队列也应始终处于一致状态。

如果不是因为升级/降级/移动要求，就不会有太大问题。

编辑：如果有 Java 和/或 Python 库来完成上述任务，则加分。

解决方案应该非常好地扩展。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-04T01:24:45.360

Redis 支持列表和有序集：[http ://redis.io/topics/data-types#lists](http://redis.io/topics/data-types#lists)

它还支持事务和发布/订阅消息。所以，是的，我想说这可以在 redis 上轻松完成。

更新：事实上，大约 80% 已经做了很多次了：[http ://www.google.co.uk/search?q=python+redis+queue](http://www.google.co.uk/search?q=python+redis+queue)

其中一些点击可以升级以添加您想要的内容。您必须使用事务来实现提升/降级操作。

可以在服务器端使用 lua 来创建该功能，而不是在客户端代码中使用它。或者，您可以在服务器上围绕 redis 创建一个瘦包装器，它只实现您想要的操作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-12T03:00:36.820

# Python：“包括电池”

与其寻找像 RabbitMQ、Redis 或 RDBMS 这样的数据存储，我认为 python 和几个库足以解决这个问题。有些人可能会抱怨这种自己动手的方法是在重新发明轮子，但我更喜欢运行 100 行 Python 代码而不是管理另一个数据存储。

## 实现优先队列

您定义的操作：追加、获取、提升和降级，描述了一个优先级队列。不幸的是，python 没有内置的优先级队列数据类型。但它确实有一个名为 heapq 的堆库，优先级队列通常以堆的形式实现。这是我实现的满足您要求的优先级队列：

```
class PQueue:
    """
    Implements a priority queue with append, take, promote, and demote
    operations.
    """
    def __init__(self):
        """
        Initialize empty priority queue.
        self.toll is max(priority) and max(rowid) in the queue
        self.heap is the heap maintained for take command
        self.rows is a mapping from rowid to items
        self.pris is a mapping from priority to items
        """
        self.toll = 0
        self.heap = list()
        self.rows = dict()
        self.pris = dict()

    def append(self, value):
        """
        Append value to our priority queue.
        The new value is added with lowest priority as an item. Items are
        threeple lists consisting of [priority, rowid, value]. The rowid
        is used by the promote/demote commands.
        Returns the new rowid corresponding to the new item.
        """
        self.toll += 1
        item = [self.toll, self.toll, value]
        self.heap.append(item)
        self.rows[self.toll] = item
        self.pris[self.toll] = item
        return self.toll

    def take(self):
        """
        Take the highest priority item out of the queue.
        Returns the value of the item.
        """
        item = heapq.heappop(self.heap)
        del self.pris[item[0]]
        del self.rows[item[1]]
        return item[2]

    def promote(self, rowid):
        """
        Promote an item in the queue.
        The promoted item swaps position with the next highest item.
        Returns the number of affected rows.
        """
        if rowid not in self.rows: return 0
        item = self.rows[rowid]
        item_pri, item_row, item_val = item
        next = item_pri - 1
        if next in self.pris:
            iota = self.pris[next]
            iota_pri, iota_row, iota_val = iota
            iota[1], iota[2] = item_row, item_val
            item[1], item[2] = iota_row, iota_val
            self.rows[item_row] = iota
            self.rows[iota_row] = item
            return 2
        return 0 
```

降级命令与提升命令几乎相同，因此为简洁起见，我将省略它。请注意，这仅取决于 python 的列表、字典和 heapq 库。

## 服务于我们的优先队列

现在使用 PQueue 数据类型，我们希望允许与实例进行分布式交互。一个很棒的库是[gevent](http://gevent.org/)。尽管 gevent 相对较新且仍处于测试阶段，但它的速度非常快且经过良好测试。使用 gevent，我们可以很容易地设置一个监听 localhost:4040 的套接字服务器。这是我的服务器代码：

```
pqueue = PQueue()

def pqueue_server(sock, addr):
    text = sock.recv(1024)
    cmds = text.split(' ')
    if cmds[0] == 'append':
        result = pqueue.append(cmds[1])
    elif cmds[0] == 'take':
        result = pqueue.take()
    elif cmds[0] == 'promote':
        result = pqueue.promote(int(cmds[1]))
    elif cmds[0] == 'demote':
        result = pqueue.demote(int(cmds[1]))
    else:
        result = ''
    sock.sendall(str(result))
    print 'Request:', text, '; Response:', str(result)

if args.listen:
    server = StreamServer(('127.0.0.1', 4040), pqueue_server)
    print 'Starting pqueue server on port 4040...'
    server.serve_forever() 
```

在生产中运行之前，您当然希望做一些更好的错误/缓冲区处理。但它适用于快速原型制作。请注意，这不需要围绕 pqueue 对象进行任何锁定。Gevent 实际上并没有并行运行代码，它只是给人一种印象。缺点是更多的内核无济于事，但好处是无锁代码。

别误会，gevent SocketServer 会同时处理多个请求。但它通过协作多任务处理在响应请求之间切换。这意味着您必须让出协程的时间片。虽然 gevents 套接字 I/O 函数旨在让出，但我们的 pqueue 实现却不是。幸运的是，pqueue 非常快地完成了它的任务。

## 也是一个客户

在进行原型设计时，我发现拥有一个客户也很有用。编写客户端需要一些谷歌搜索，所以我也会分享该代码：

```
if args.client:
    while True:
        msg = raw_input('> ')
        sock = gsocket.socket(gsocket.AF_INET, gsocket.SOCK_STREAM)
        sock.connect(('127.0.0.1', 4040))
        sock.sendall(msg)
        text = sock.recv(1024)
        sock.close()
        print text 
```

要使用新的数据存储，首先启动服务器，然后启动客户端。在客户提示下，您应该能够：

```
> append one
1
> append two
2
> append three
3
> promote 2
2
> promote 2
0
> take
two 
```

# 扩展性非常好

考虑到您对数据存储的考虑，您似乎真的很关心吞吐量和持久性。但是“规模非常好”并不能量化您的需求。所以我决定用一个测试功能对上面的内容进行基准测试。这是测试功能：

```
def test():
    import time
    import urllib2
    import subprocess

    import random
    random = random.Random(0)

    from progressbar import ProgressBar, Percentage, Bar, ETA
    widgets = [Percentage(), Bar(), ETA()]

    def make_name():
        alphabet = 'abcdefghijklmnopqrstuvwxyz'
        return ''.join(random.choice(alphabet)
                       for rpt in xrange(random.randrange(3, 20)))

    def make_request(cmds):
        sock = gsocket.socket(gsocket.AF_INET, gsocket.SOCK_STREAM)
        sock.connect(('127.0.0.1', 4040))
        sock.sendall(cmds)
        text = sock.recv(1024)
        sock.close()

    print 'Starting server and waiting 3 seconds.'
    subprocess.call('start cmd.exe /c python.exe queue_thing_gevent.py -l',
                    shell=True)
    time.sleep(3)

    tests = []
    def wrap_test(name, limit=10000):
        def wrap(func):
            def wrapped():
                progress = ProgressBar(widgets=widgets)
                for rpt in progress(xrange(limit)):
                    func()
                secs = progress.seconds_elapsed
                print '{0} {1} records in {2:.3f} s at {3:.3f} r/s'.format(
                    name, limit, secs, limit / secs)
            tests.append(wrapped)
            return wrapped
        return wrap

    def direct_append():
        name = make_name()
        pqueue.append(name)

    count = 1000000
    @wrap_test('Loaded', count)
    def direct_append_test(): direct_append()

    def append():
        name = make_name()
        make_request('append ' + name)

    @wrap_test('Appended')
    def append_test(): append()

    ...

    print 'Running speed tests.'
    for tst in tests: tst() 
```

## 基准测试结果

我对笔记本电脑上运行的服务器进行了 6 次测试。我认为结果非常好。这是输出：

```
Starting server and waiting 3 seconds.
Running speed tests.
100%|############################################################|Time: 0:00:21
Loaded 1000000 records in 21.770 s at 45934.773 r/s
100%|############################################################|Time: 0:00:06
Appended 10000 records in 6.825 s at 1465.201 r/s
100%|############################################################|Time: 0:00:06
Promoted 10000 records in 6.270 s at 1594.896 r/s
100%|############################################################|Time: 0:00:05
Demoted 10000 records in 5.686 s at 1758.706 r/s
100%|############################################################|Time: 0:00:05
Took 10000 records in 5.950 s at 1680.672 r/s
100%|############################################################|Time: 0:00:07
Mixed load processed 10000 records in 7.410 s at 1349.528 r/s 
```

## 最终边界：耐用性

最后，耐用性是我没有完全原型化的唯一问题。但我也不认为这有那么难。在我们的优先级队列中，项目的堆（列表）包含我们需要将数据类型保存到磁盘的所有信息。由于使用 gevent，我们还可以以多处理方式生成函数，我想象使用这样的函数：

```
def save_heap(heap, toll):
    name = 'heap-{0}.txt'.format(toll)
    with open(name, 'w') as temp:
        for val in heap:
            temp.write(str(val))
            gevent.sleep(0) 
```

并向我们​​的优先级队列添加保存功能：

```
def save(self):
    heap_copy = tuple(self.heap)
    toll = self.toll
    gevent.spawn(save_heap, heap_copy, toll) 
```

您现在可以复制 Redis 的分叉模型，并每隔几分钟将数据存储写入磁盘。如果您需要更高的耐用性，请将上述内容与将命令记录到磁盘的系统相结合。这些是 Redis 使用的 AFP 和 RDB 持久化方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-07T08:16:08.917

RabbitMQ 有什么问题？这听起来完全符合您的需要。

我们在生产环境中也广泛使用 Redis，但它没有队列通常具有的一些功能，例如将任务设置为完成，或者在某些 TTL 未完成时重新发送任务。另一方面，它确实具有队列所没有的其他功能，例如它是一个通用存储，而且速度非常快。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-04T01:43:13.747

Websphere MQ*几乎*可以完成所有这些工作。

提升/降级几乎是可能的，方法是从队列中删除消息并以更高/更低的优先级将其放回，或者使用“CORRELID”作为序列号。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-08-05T14:11:52.257

使用[Redisson它以](http://redisson.org)[Redis](http://redis.io)提供的分布式方法实现熟悉`List`的`Queue`、、、、 java 接口。示例：`BlockingQueue``Deque``Deque`

```
Redisson redisson = Redisson.create();

RDeque<SomeObject> queue = redisson.getDeque("anyDeque");
queue.addFirst(new SomeObject());
queue.addLast(new SomeObject());
SomeObject obj = queue.removeFirst();
SomeObject someObj = queue.removeLast();

redisson.shutdown(); 
```

其他样品：

[https://github.com/mrniko/redisson/wiki/7.-distributed-collections/#77-list](https://github.com/mrniko/redisson/wiki/7.-distributed-collections/#77-list)
[https://github.com/mrniko/redisson/wiki/7.-distributed-collections/#78-queue](https://github.com/mrniko/redisson/wiki/7.-distributed-collections/#78-queue) [https://github.com/mrniko/redisson/wiki/7.-distributed-collections/#710-blocking-queue](https://github.com/mrniko/redisson/wiki/7.-distributed-collections/#710-blocking-queue)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-10T07:21:29.537

如果您出于某种原因决定使用 SQL 数据库作为后端，我不会使用 MySQL，因为它需要轮询（当然也不会因为许多其他原因而使用它），但是 PostgreSQL 支持[LISTEN/NOTIFY](http://www.postgresql.org/docs/9.1/static/sql-notify.html)用于向其他客户端发出信号，以便他们不必轮询更改。但是，它会同时向所有侦听客户端发出信号，因此您仍然需要一种机制来选择获胜的侦听器。

作为旁注，我不确定提升/降级机制是否有用；最好在插入时适当安排作业......

# java - 在 Eclipse 中运行主类时出现 java.lang.VerifyError

> ID：10404929
> 
> 赞同：0
> 
> 时间：2012-05-01T21:54:11.997
> 
> 标签：java, compiler-errors, aspectj

我正在使用 AspectJ 并且或多或少被迫安装 Eclipse（因为我通常使用 NetBeans）。已经安装了 AspectJ 插件并创建了一个 AspectJ 项目，但现在我尝试运行该程序，我收到此错误：

```
Exception in thread "main" java.lang.VerifyError: Expecting a stackmap frame at branch target 140 in method Notepad.<init>()V at offset 131
    at java.lang.Class.getDeclaredMethods0(Native Method)
    at java.lang.Class.privateGetDeclaredMethods(Unknown Source)
    at java.lang.Class.getMethod0(Unknown Source)
    at java.lang.Class.getMethod(Unknown Source)
    at sun.launcher.LauncherHelper.getMainMethod(Unknown Source)
    at sun.launcher.LauncherHelper.checkAndLoadMain(Unknown Source) 
```

我完全不知道我必须做什么。我有一个记事本类，它具有 main 方法，然后是一个附加的 aspectj 类。出于某种原因，我之前可以运行该程序，但后来我必须更改与环境或源等有关的内容。该程序是可运行的，直到我对 .aj 方面进行了一些更改并保存它。

任何有关如何解决此问题的提示将不胜感激，因为我对尝试使用 AspectJ 和 Eclipse 时不断出现的所有问题感到越来越沮丧。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T22:13:18.260

不看你写的程序很难知道发生了什么，但我可以建议一些事情：

1.  您是否使用 Java 7 来运行或编译您的 Java 代码？Java 7 之上的 AspectJ 相对较新，需要 AspectJ 的快照构建。
2.  你能让你的应用程序在命令行上编译和运行吗？
3.  这可能是编译器中的真正错误。在这种情况下，您可以在 AspectJ 邮件列表上发帖或在 eclipse.org 上提出错误。两者都受到密切监视。

您看到验证错误的事实使我相信这是＃1。但是，需要一个项目 zip 才能给您任何明确的答案。

# iphone - 将密钥和证书复制到另一台 Mac 以进行 iPhone 开发

> ID：10404931
> 
> 赞同：38
> 
> 时间：2012-05-01T21:54:25.313
> 
> 标签：iphone, xcode, macos, xcode4

我们购买了一台新 Mac，并希望将证书和私钥从旧机器迁移到新机器。旧机器包含六个 iPhone 应用程序的密钥和证书。

我们遵循了这篇[SO 帖子](https://stackoverflow.com/questions/4406241/ios-distribution-migrating-private-key-certs-to-new-machine)中概述的说明，这在有关该主题的其他 SO 帖子中也得到了回应。

似乎一切正常，我们可以将新的二进制文件上传到 App Store。

但是当我们查看 Keychain Access 时，只会出现一个应用程序的密钥/证书配对。

我们需要担心这个吗？或者是否有一种方便的方法可以批量导出/导入私钥和证书（而不是一个一个）？

我们在 Xcode 4.2 上。

谢谢！

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2013-10-04T15:09:04.387

导入/导出在 Xcode 5+ 中的工作方式不同。[这份 Apple 开发人员指南](https://help.apple.com/xcode/mac/current/#/dev8a2822e0b)向您展示了如何操作。

您的帐户显示在**Xcode** → **Preferences** → **Accounts**下，可以通过单击![](../Images/b96c5bc3c76c8f2ce3c686e4b7ebca68.png)左下角的齿轮图标 ( ) 导出。

[![导入/导出 Apple ID 和代码签名资产](../Images/235c98558f2887093f7575ad5bddf7e2.png)](https://i.stack.imgur.com/dPOn4.png)

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2012-05-01T22:03:48.533

您应该能够通过一次导出导出所有包含所有密钥（公共和私有）的配置文件

在设备选项卡下的管理器中，您需要选择开发人员身份并将其导出到文件并为其提供密码。将该文件移动到新系统并将其导入 Xcode，您的完整身份将被设置

![在此处输入图像描述](../Images/5ebd4d0292562ad6daf6ee9e4da6c5a2.png)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-11-30T10:28:32.650

通过从密钥选项卡中选择私钥进行导入。这会提示输入密码，密码后它会以`.p12`格式保存，您可以在所有系统中安装。

# javascript - 带有 HTML 表格的 jQuery 同位素库

> ID：10404933
> 
> 赞同：2
> 
> 时间：2012-05-01T21:54:55.743
> 
> 标签：javascript, css, html-table, jquery-isotope

在处理需要简单排序/过滤系统的大量表格数据列表时，我发现了 Isotope 库，它似乎完全符合我的要求，并提供了许多漂亮的视觉效果和功能。我希望能够使用 Isotope 对表行进行排序和过滤，并且我想出了一个似乎可以工作的基本演示。但是，存在一些错误：

*   我将 <thead> 部分用于过滤器和行标题，因此我将同位素选择器应用于 <tbody>。但是，当使用 tbody 作为容器初始化 Isotope 时，每行中的表格单元格将失去表格格式指定的宽度。这没什么大不了的，因为如果需要，我可以手动设置列宽，但在当前上下文中它相当烦人。
*   这些行被放置在表格之外，在表格容器元素的左上角。tbody 元素上的相对定位似乎不会像普通 div 那样影响行的绝对位置样式规则（由 Isotope 自动应用）。通常，如果容器使用绝对定位或相对定位定位，则绝对定位将相对于其容器元素，但这里的情况似乎并非如此。

表格行被正确过滤，同位素库正在正确应用动画和样式，但有这些例外。如果可能的话，我想继续使用表格，因为维护此页面的人员将通过 CMS 进行操作，并且对 HTML 或 CMS 用于始终生成任何 HTML 的 WYSIWYG 编辑器了解不足一个相当基本的表格之外的结构。有人对解决这两个问题有什么建议吗？谢谢！

**编辑：**作为附录，我已经解决了我最初遇到的问题。事实证明， tbody 元素不接受 position: relative 或 position: absolute 属性，因此表格行没有正确放置。将整个表格设置为 position: relative 解决了主要的放置问题，尽管这些行随后被移动到表格的左上角。我通过用Javascript中thead元素的高度偏移表格行顶部属性解决了这个问题，因为没有Javascript显示是正常的。

这在 Firefox、Chrome、Opera 和 Safari 中运行良好。但是，IE 7、8 和 9 都有渲染问题——更糟糕的是，它们都是不同的渲染问题。IE9 拒绝以正确的偏移量放置表格单元格，IE8 根本不显示行，而 IE7 似乎将整个情况解释为“爆炸！”。至少我遇到的主要问题解决了！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T05:16:30.490

我已经整合了 Wesley 的风格建议来实现 Isortope——一个使用 Isotope 进行表格排序的 jQuery 插件。

它通过自动将表格生成的列宽转换为内联样式来解决列宽问题。这样一来，决赛桌的显示就与最初的桌桌一样。

简单的[演示在这里](http://www.kurtpreston.com/isortope)。

[在这里下载](https://github.com/KurtPreston/isortope)。

# entity-framework - 实体框架 - 用 SaveChanges(SaveOptions) 替换 SaveChanges(bool) 的事务

> ID：10404934
> 
> 赞同：9
> 
> 时间：2012-05-01T21:54:59.297
> 
> 标签：entity-framework, transactions

[这是使用事务或 SaveChanges(false) 和 AcceptAllChanges()](https://stackoverflow.com/q/815586/37759)的后续问题？

特别是关于这条线`context2.SaveChanges(false);`

现在 SaveChanges(bool) 已被弃用。我们应该使用 SaveChanges(SaveOptions) 代替。

SaveOptions[有](http://msdn.microsoft.com/en-us/library/system.data.objects.saveoptions.aspx)以下选项：

*   没有任何
*   AcceptAllChangesAfterSave
*   DetectChangesBeforeSave

其中哪些映射到 SaveChanges(false)？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-02T08:14:25.463

`SaveChanges(SaveOptions.DetectChangesBeforeSave)`相当于`SaveChanges(false)`

# objective-c - 从 MKPolygon 获取最小数量的 MKMapRects

> ID：10404937
> 
> 赞同：1
> 
> 时间：2012-05-01T21:55:12.920
> 
> 标签：objective-c, ios, mapkit

所以我有一个函数需要两个 MKMapRect，第二个与第一个相交。因此该函数创建了一个 MKPolygon，它是第一个没有相交部分的矩形：

```
 -(void) polygons:(MKMapRect)fullRect exclude:(MKMapRect)excludeArea{
        NSLog(@"Y is: %f height: %f",excludeArea.origin.y,excludeArea.size.height);
        double top = excludeArea.origin.y - fullRect.origin.y; 
        double lft = excludeArea.origin.x - fullRect.origin.x; 
        double btm = (fullRect.origin.y + fullRect.size.height) - (excludeArea.origin.y + excludeArea.size.height); 
        double rgt = (fullRect.origin.x + fullRect.size.width) - (excludeArea.origin.x + excludeArea.size.width);
        double ot = fullRect.origin.y, it = (ot + top);
        double ol = fullRect.origin.x, il = (ol + lft);
        double ob = (fullRect.origin.y + fullRect.size.height), ib = (ob - btm);
        double or = (fullRect.origin.x + fullRect.size.width), ir = (or - rgt);
        MKMapPoint points[11] =  {{ol,it}, {ol,ot}, {or,ot}, {or,ob}, {ol,ob}, {ol,it}, {il,it}, {ir,it}, {ir,ib}, {il,ib}, {il,it}};
        MKPolygon *polygon = [MKPolygon polygonWithPoints:points count:11];
     } 
```

我现在的问题是如何从这个 MKPolygon 中获得最小数量的 MKMapRects？我做了一些谷歌搜索以及浏览论坛，但没有找到任何东西。

编辑：所以目标如下：我有一个 MKMapRect rect1，然后我有一个矩形列表 rectList，它是与 rect1 相交的 MKMapRects，我想要做的是创建一个 rect1 的直线 MKPolygon，删除所有的表面从 rect1 的 rectList 中创建 MKMapRects，然后从创建的直线 MKPolygon 中创建最小数量的 MKMaprects。

现在的问题如下：从 rect1 中删除一个 MKMapRect 时，我能够创建一个多边形，但我不知道如何从 rect1 中删除以下 maprect，我不知道如何从创建的多边形中提取最小的 MkMapRect 集。

最好的问候窥视

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T22:50:22.830

我不确定这是否是您要查找的内容，或者我是否完全理解该问题，但是如果您只需要知道通过从另一个矩形中减去一个矩形而创建的多边形中矩形的最小数量，您应该能够通过检查第一个矩形中包含的第二个矩形中的角点数来做到这一点。在伪代码中：

```
int minNumRects(MKRect r1, MKRect r2) {
    int numPointsContained = 0;
    for (Point p in r2) {
        if (MKMapRectContainsPoint(r1, p)) {
            numPointsContained++;
        }
    }
    if (numPointsContained == 1) {
        return 2;
    } else if (numPointsContained == 2) {
        return 3;
    } else if (numPointsContained == 4) {
        return 4;
    } else {
        return 0;
    }
} 
```

PS - 这假设矩形是轴对齐的，但据我所知，MKRects 就是这种情况

# c# - 以编程方式构建 WHERE 子句，然后将其作为参数传递给 SQL

> ID：10404939
> 
> 赞同：0
> 
> 时间：2012-05-01T21:55:22.280
> 
> 标签：c#, sql, where, parameterized, clause

在我的 asp.net 项目中，C# 中的服务器端过滤器函数正在构建 SQL`WHERE`子句，然后将其传递到 SQL 存储过程中，例如，

过滤器生成一个字符串变量，其值类似于“<code>WHERE Qty < 5 AND Price > 10”。

存储过程的相关部分如下：

```
Exec (‘
    Select Name, Location
    From Users
    + ‘@passedInWhereClause’
‘) 
```

如您所见，我们必须对`EXEC`使用传入变量构建的字符串执行命令，该变量包含`where`由服务器端的 C# 代码生成的子句。我真的想要一种消除`EXEC`.sql 代码并使 SQL 代码看起来更专业的方法，而不是用`EXEC`. 有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T22:00:24.957

您应该考虑可选参数，例如

```
WHERE (@Type = NULL OR @Type = '' OR @Type = Type) 
```

这允许您将 NULL 或空白传递给 SP 以忽略 where 子句，或者您传递一个值以应用 where 子句。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T22:02:01.217

**不**，没有更好的方法来执行此操作，因为您正在构建要执行的动态 SQL。

如果您想做得更好，请不要运行动态 SQL。

[动态 SQL 的祸与福](http://www.sommarskog.se/dynamic_sql.html)

# magento - Magento 1.7 - 2 个不同域的商店共享一个购物车？

> ID：10404941
> 
> 赞同：0
> 
> 时间：2012-05-01T21:55:25.977
> 
> 标签：magento, session-cookies, sessionid

我已经使用 Magento 1.7 成功设置了 2 个具有 2 个不同域的商店。我无法让他们分享 1 辆购物车，有什么诀窍可以让它工作吗？我无法找到有关当前版本的 magento 的任何信息。

谢谢，

*   丹麦人

* * *

编辑：

感谢您的回复，magento 的优势之一是能够拥有多个“商店”，同时共享相同的管理部分、产品、客户等。（我已经设置好了）。我只是不能让商店“共享”购物车。就我而言，我有 2 家不共享产品但需要共享购物车的商店，因此您可以在一个商店中将产品添加到购物车中，然后在该产品仍在您的购物车中时跳到另一家商店。gap.com 是子域发生这种情况的一个很好的例子。我知道这个功能是可能的，因为旧版本的 Magento 的所有讨论/解决方案都在那里。我只是找不到新版本的解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T00:00:17.077

Magento 购物车（报价）链接到一个商店。这是由数据库表中的`store_id`列存储的。`sales_flat_quote`默认情况下，您不能在商店之间共享购物车。

您能否更清楚地描述您的网站、商店和商店视图的配置方式？此信息可以在“系统 > 管理商店”下的管理员中找到。

# mysql - mysql 使用单元格 A 和 B 的更新划分来更新单元格 C

> ID：10404944
> 
> 赞同：0
> 
> 时间：2012-05-01T21:55:58.677
> 
> 标签：mysql

我的表格中有一个名为 platform_rating 的单元格，它应该是其他两个单元格 (platform_likes / total_votes)*100 划分的百分比值。每当有人点击赞按钮时，“platform_likes”、“total_votes”都会更新，但“platform_rating”不会。这是数组中的行：

```
<?php

'platform_rating' => ($row['total_votes'] != 0) ?  ($row['platform_likes'] / 
$row['total_votes'])*100 : 0,

?> 
```

这是更新的功能：

```
<?php

function add_like($platform_id)
{
$platform_id = (int)$platform_id;
mysql_query("UPDATE `flights` SET `platform_likes` = `platform_likes` + 1,
`total_votes` = `total_votes` + 1, **`platform_rating` =  
`platform_rating`((platform_likes / total_votes)*100)** WHERE platform_id = 
$platform_id");
}
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T07:25:14.880

由于UPDATE 查询`platform_rating`中存在杂散，您将百分比乘以。`platform_rating`它应该是 platform_rating = ((platform_likes / total_votes)*100)

# javascript - 在 jquery drop 事件中获取 div 类的值

> ID：10404946
> 
> 赞同：0
> 
> 时间：2012-05-01T21:56:12.673
> 
> 标签：javascript, jquery

使用 jQuery，我试图在 div 类被“删除”时捕获并显示它的值。例如，我想在删除此特定元素时显示“01:20”。div class='routineTime'>01:20 /div>

另外，我想汇总并显示这些删除元素的运行总数。

我在 jsfiddle 中有一个示例，但它仅显示删除的第一个元素的“routineTime”。我需要为删除的每个元素求和并显示“routineTime”。

[http://jsfiddle.net/n2learning/QfFQ9/9/](http://jsfiddle.net/n2learning/QfFQ9/9/)

感谢任何帮助！

丹麦

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T22:05:48.417

在您的放置事件处理程序中，您只需要迭代目标框架中所有元素的集合，而不是使用模糊选择器。

```
var routineTime;

$('#dropTargetframe .routineTime').each(function() {

    //Example used here, use your own time library.
    routineTime += Foo.GetTimeValue($(this).html()); 

});

$('#calcTime').text(routineTime); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T22:06:03.190

您需要为可放置部分内的所有已放置元素实现一个迭代器。

```
 drop: function(event, ui) {
        $('#info').find("h1").remove();

        var tmp, routineTime = [0, 0];
        $('.routineTime', $(this)).each (function () {
            tmp = $(this).text().split(':');

            if ($.trim(tmp[0]) == '') tmp[0] = 0;

            routineTime [0] += parseInt(tmp[0], 10);
            routineTime [1] += parseInt(tmp[1], 10);               
        });

        routineTime [0] += parseInt(routineTime [1]/60);
        routineTime [1] = routineTime[1]%60;

        $('#calcTime').html(routineTime [0] + ':' + routineTime [1]);

    } 
```

[**演示**](http://jsfiddle.net/QfFQ9/12/)

~~addTime 逻辑有其自身的复杂性......您需要在`$.each`~~

**编辑：**添加了 addTime 逻辑。让我知道它是怎么回事。

# php - 如何从完整的 ebay 项目 url 获取 ebay 项目 ID？

> ID：10404953
> 
> 赞同：1
> 
> 时间：2012-05-01T21:56:56.553
> 
> 标签：php, url-parsing

这些天我正在研究 ebay api，但我仍然无法弄清楚如何使用完整的项目 url 获取 ebay 项目 ID `(http://www.ebay.com/ctg/TomTom-XXL-550M-US-including-Puerto-Rico-Canada-Mexico-Automotive-GPS-Receiver-/86127922?)`？

我尝试了很多方法，但请帮助我！有没有使用 API？或任何其他方式我只需要 ebay 项目编号..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T22:02:01.703

这没有经过测试，只是很快就写出来了。它至少应该给你一个大致的想法。它假定 id 将始终是最后一个 url 之后的段`/`。如果不是这样，这个答案将毫无用处。

```
$ebayUrl = "http://www.ebay.com/ctg/TomTom-XXL-550M-US-including-Puerto-Rico-Canada-Mexico-Automotive-GPS-Receiver-/86127922?";
$pos     = strrpos($ebayUrl, '/') + 1;
$id      = substr($ebayUrl, $pos);

//if you want to remove the question mark left at the end
$id      = str_replace("?", "", $id);

echo $id; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T22:39:56.560

其他选择可能是：

```
$parts = explode('/', 'http://www.ebay.com/ctg/TomTom-XXL-550M-US-including-Puerto-Rico-Canada-Mexico-Automotive-GPS-Receiver-/86127922?');
$id = trim(end($parts), '?');
echo $id; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-06-14T06:15:28.337

根据您需要执行此操作的位置，您可以使用`ebayItemID`

例如（javascript）`var itemid = ebayItemID;`

我使用这种方法在产品描述中添加了“立即购买”按钮。

# html - 标签定位不正确？

> ID：10404954
> 
> 赞同：0
> 
> 时间：2012-05-01T21:56:59.000
> 
> 标签：html, css

我制作了一个“我正在制作的警报框”的 div。我无法将文本定位在标题部分的中心。我尝试添加填充和边距，但它们不起作用。[http://jsfiddle.net/Hunter4854/9EPES/](http://jsfiddle.net/Hunter4854/9EPES/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T22:04:06.373

将图像移开`position: absolute`，然后简单地使用`text-align: center`将文本居中：http: [//jsfiddle.net/9EPES/1/](http://jsfiddle.net/9EPES/1/)

# list - 如何在 Prolog 中断言给定列表中的所有对？

> ID：10404956
> 
> 赞同：0
> 
> 时间：2012-05-01T21:57:03.347
> 
> 标签：list, prolog, combinations

当给定一个列表时，我想计算列表中所有可能的对组合。

例如 2) 输入是一个列表 (a,b,c) 我想获得对 (a,b) (a,c) (b,c)

例如1）输入是一个列表（a，b，c，d）我想获得对（a，b）（a，c）（a，d）（b，c）（b，d）和（c ,d)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T23:06:26.053

~~使用`select/3`两次（或`select/3`一次`member/2`又一次）将使您在这里实现您想要的。我会让你弄清楚细节，如果仍然麻烦，我会寻求帮助。~~

顺便说一句，列表的 Prolog 语法不是`(a, b, c)`但是`[a, b, c]`（好吧，它是语法糖，但我会留在那里）。

**编辑**：正如@WillNess 指出的那样，您不是在寻找任何对`(X, Y)`，而只是在寻找列表`X`中之前`Y`的对。

DCG 非常适合：正如@false 所描述的，它们可以产生一个[图形吸引人的解决方案](https://stackoverflow.com/questions/8462039/prolog-list-homework/8466102#8466102)：

```
... --> [] | [_], ... .

pair(L, X-Y) :-
    phrase((..., [X], ..., [Y], ...), L). 
```

或者，如果您使用 SWI-Prolog，也可以调用 to`append/2`以类似的方式来解决问题，但效率低于 DCG：

```
pair2(L, X-Y) :-
    append([_, [X], _, [Y], _], L). 
```

正如@WillNess 在他的评论中所建议的那样，您可以通过基本递归来做到这一点。如果需要，我将把这部分留给他详细说明！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T10:32:26.083

好的，所以翻译 Haskell 定义

```
pairs (x:xs) = [ (x,y) | y <- xs ]
                ++ pairs xs 
pairs []     = [] 
```

*（这意味着，列表中带有 head`x`和 tail的对是 in`xs`的所有对`(x,y)`，`y`也是 in`xs`的对`xs`；并且在空列表中没有对）*

作为*回溯Prolog 谓词，在每次**重做*时一一生成对，这是对上述内容的直接一对一重写，

```
pair( [X|XS], X-Y) :- member( ... , XS)    % fill in 
                      ; pair( XS, ... ).   %    the blanks 
%% pair( [], _) :- false. 
```

要获得*所有*可能的对，请使用`findall`：

```
pairs( L, PS) :- findall( P, pair( L, P), PS). 
```

`bagof`如果您的列表中可以包含逻辑变量，请考虑使用。不过，控制`bagof`的回溯可能是一个复杂的问题。

`pairs`也可以写成（几乎）确定性、非回溯、递归定义，通过累加器参数构造其输出列表，就像函数式编程语言一样——这里是自上而下的方式，这就是 Prolog 擅长的地方：

```
pairs( [X|T], PS) :- T = [_|_], pairs( X, T, T, PS, []). 
pairs( [_], []).
pairs( [], []).

pairs( _, [], [], Z, Z).
pairs( _, [], [X|T], PS, Z) :- pairs( X, T, T, PS, Z).
pairs( X, [Y|T], R, [X-Y|PS], Z) :- pairs( X, T, R, PS, Z). 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-05-25T16:01:50.960

您可以使用`append/`来遍历列表：

```
?- append(_,[X|R],[a,b,c,d]).
X = a,
R = [b, c, d] ;
X = b,
R = [c, d] ;
X = c,
R = [d] ;
X = d,
R = [] ;
false. 
```

接下来，用于`member/2`形成一对`X-Y`，对于每个`Y`in `R`：

```
?- append(_,[X|R],[a,b,c,d]), member(Y,R), Pair=(X-Y).
X = a,
R = [b, c, d],
Y = b,
Pair = a-b ;
X = a,
R = [b, c, d],
Y = c,
Pair = a-c ;
X = a,
R = [b, c, d],
Y = d,
Pair = a-d ;
X = b,
R = [c, d],
Y = c,
Pair = b-c ;
X = b,
R = [c, d],
Y = d,
Pair = b-d ;
X = c,
R = [d],
Y = d,
Pair = c-d ;
false. 
```

然后，用于`findall/3`收集列表中的所有对：

```
?- findall(X-Y, (append(_,[X|R],[a,b,c,d]), member(Y,R)), Pairs).
Pairs = [a-b, a-c, a-d, b-c, b-d, c-d]. 
```

因此，您的最终解决方案可以表示为：

```
pairs(List, Pairs) :-
    findall(X-Y, (append(_,[X|R],List), member(Y,R)), Pairs). 
```

一个使用示例是：

```
?- pairs([a,b,c,d], Pairs).
Pairs = [a-b, a-c, a-d, b-c, b-d, c-d]. 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-05-24T18:35:46.023

这是解决此问题的一种可能方法。

如果第三个参数对应于包含对的列表，则以下谓词`combine/3`为真，其中每对的第一个元素等于 的第一个参数`combine/3`。每对的第二个元素将对应于 predicate 的第二个参数中的列表项`combine/3`。一些`combine/3`应该如何工作的例子：

```
?- combine(a,[b],X).
X = [pair(a,b)]

?- combine(a,[b,c,d],X).
X = [pair(a,b), pair(a,c), pair(a,d)] 
```

可能的定义方式`combine/3`：

```
combine(A,[B],[pair(A,B)]) :- !.

combine(A,[B|T],C) :-
  combine(A,T,C2),          % Create pairs for remaining elements in T.
  append([pair(A,B)],C2,C). % Append current pair and remaining pairs C2.
                            % The result of append is C. 
```

现在`combine/3`可以用来定义`pair/2`：

```
pairs([],[]).      % Empty list will correspond to empty list of pairs.
pairs([H|T],P) :-  % In case there is at least one element.
  nonvar([H|T]),   % In this case it expected that [H|T] is instantiated.
  pairs(H,T,P).

pairs(A,[B],[pair(A,B)]) % If remaining list contains exactly one element,
  :- !.                  % then there will be only one pair(A,B).
pairs(A,[B|T],P) :-      % In case there are at least two elements.
  combine(A,[B|T],P2),   % For each element in [B|T] compute pairs
                         % where first element of each pair will be A.
  pairs(B,T,P3),         % Compute all pairs without A recursively.
  append(P2,P3,P).       % Append results P2 and P3 together. 
```

示例用法：

```
?- pairs([a,b,c],X).
X = [pair(a, b), pair(a, c), pair(b, c)].

?- pairs([a,b,c,d],X).
X = [pair(a, b), pair(a, c), pair(a, d), pair(b, c), pair(b, d), pair(c, d)]. 
```

# mysql - mysql MAX查询不返回最新的加入记录

> ID：10404958
> 
> 赞同：0
> 
> 时间：2012-05-01T21:57:13.887
> 
> 标签：mysql, sql

我有一个返回正确数据的查询，除了左连接没有返回最新记录（按 dateuploaded 列排序） 感谢您的帮助。

```
select a.*,p.thumbnailphotopath as Picture from album_access ac 
inner join albums a on a.ID = ac.AlbumID 
left join (select albumid, thumbnailphotopath,max(DateUploaded) from photos where IsProcessed = 1 and IsPrivate = 0 GROUP BY albumID) p on a.ID = p.AlbumID #photos record not latest
where ac.AccessUserID = ? and ac.Ispending = 0 and ac.FullControl = 1 and a.Private = 1 order by a.DateCreated desc limit ?,?;

List of dates that return desc (its returning 2012-05-01 09:45:43 and thats not the latest)
2012-05-01 09:46:17 
2012-05-01 09:46:06
2012-05-01 09:45:43 --Returning this record 
2012-05-01 09:45:30
2012-05-01 09:39:49 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T23:41:47.253

您需要一个预查询来获取每个专辑上传的最大日期，然后可以根据匹配的专辑和日期限定符获取正确的专辑条目......

```
select 
      a.*,
      pFinal.thumbnailphotopath as Picture 
   from 
      album_access ac 
         inner join albums a
            on ac.AlbumID = a.ID
           AND a.Private = 1
         left join ( select
                           p.albumid,
                           max( p.dateUploaded ) as MaxDate
                        from
                           photos p
                        where
                               p.IsProcessed = 1
                           AND p.IsPrivate = 0
                        group by 
                           p.AlbumID ) pMax
            on ac.AlbumID = pMax.AlbumID 
               left join photos pFinal
                  on pMax.AlbumID = pFinal.AlbumID
                 AND pMax.MaxDate = pFinal.DateUpladed
   where 
          ac.AccessUserID = ? 
      and ac.Ispending = 0 
      and ac.FullControl = 1 
   order by 
      a.DateCreated desc 
   limit ?,?; 
```

# c++ - 如何将值应用于结构内的字符串变量？

> ID：10404959
> 
> 赞同：0
> 
> 时间：2012-05-01T21:57:30.507
> 
> 标签：c++, struct, null

我的结构如下：

```
struct Candidate { 
    float pertotal, voteper; 
    string name; 
    int voten, votem, votese, votesw, total;
}; 
```

我需要为名称分配一个空值。我努力了：

```
struct Candidate { 
    float pertotal, voteper; 
    string name = 0; 
    int voten, votem, votese, votesw, total;
}; 
```

和

```
struct Candidate { 
    float pertotal, voteper; 
    string name = ""; 
    int voten, votem, votese, votesw, total;
}; 
```

但它似乎不喜欢它.. 想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T21:58:52.487

`Candidate`是一个*类型*，而不是一个*实例*。

但是，您可以这样做：

```
Candidate cand;

cand.name = ""; 
```

或者，您可以编写一个构造函数：

```
struct Candidate {
    Candidate() : name("") {}

    ...
}; 
```

但是，在这种情况下，您不需要执行其中任何一项，因为默认构造函数的`std::string`结果是一个空字符串。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-01T21:58:39.077

`std::string`默认构造为空，因此您无需执行任何操作。

但是，如果您需要在其中放入其他内容（创建该类的对象时），则需要一个构造函数。

如果您已经创建了一个实例：

```
Candidate c; 
```

并且您想将字符串设置回空字符串，只需分配给它：

```
c.name = ""; 
```

# mstest - 失败的 Coded UI 测试屏幕截图中红色轮廓的含义是什么？

> ID：10404960
> 
> 赞同：0
> 
> 时间：2012-05-01T21:57:37.283
> 
> 标签：mstest, coded-ui-tests

我正在尝试调试 VS2010 Coded UI 测试，该测试应该在 WinTable 中查找并选择特定行。测试在我的本地机器上通过，但在我们的夜间测试运行（在远程 VM 上执行）失败。MSTest 框架包括失败时的 UI 屏幕截图和失败报告，它清楚地表明选择了错误的 WinTable 行。但是，在屏幕截图中，CORRECT 控件用粗红色边框勾勒出来，这绝对不是我们常规 UI 的一部分。

我尝试搜索 MSDN（当然还有这个论坛），但找不到任何关于红线含义的解释。我希望答案能帮助我了解我的失败测试，​​因为它始终概述了我认为应该选择的控件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T02:11:09.993

据我所知，脚本正确地找到了表格控件，但没有找到相关的行/列来正确选择记录。原因可能是

*   如果代码使用行索引进行搜索，则记录可能在同一索引上不可用
*   表格必须可见，但窗口尚未空闲，因为它可能不允许脚本与表格正确交互
*   当脚本尝试与之交互时，表必须仍在呈现
*   窗口可能已在恢复模式下打开，并且由于脚本正在查找的行/列可能不在屏幕上

我建议在选择行之前实现等待逻辑。等待循环应该一直持续到窗口空闲并且表格的渲染完成。

希望能帮助到你！

# templates - 如何为我的电梯项目添加新模板（包括 url 设置）？

> ID：10404961
> 
> 赞同：0
> 
> 时间：2012-05-01T21:57:42.400
> 
> 标签：templates, scala, url, lift

我刚刚在书中使用 maven 命令创建了一个 hello-world 项目：

```
mvn archetype:generate -U \ 
-DarchetypeGroupId=net.liftweb \ 
-DarchetypeArtifactId=lift-archetype-blank \ 
-DarchetypeVersion=1.0 \ 
-DgroupId=demo.helloworld \ 
-DartifactId=helloworld \ 
-Dversion=1.0-SNAPSHOT 
```

按照指示，我从以下内容开始：

```
mvn jetty:run 
```

一切正常，直到我想添加另一个模板：

```
my-project/src/main/webapp/index.html 
```

例如，我将定价页面 (pricing.html) 放在**index.html**旁边的“ **my-project/src/main/webapp/pricing.html** ”中。但以下网址似乎对我不起作用：**http://localhost:8080/pricing**

我在这里错过了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T22:10:35.563

您需要将其添加到 Boot.scala： [http ://simply.liftweb.net/index-3.2.html](http://simply.liftweb.net/index-3.2.html)

# facebook-like - 我博客的每个元素上的 facebook like 按钮

> ID：10404962
> 
> 赞同：0
> 
> 时间：2012-05-01T21:57:48.510
> 
> 标签：facebook-like, blogs

我一直想知道如果我喜欢我博客的任何文章，我如何在我的 facebook 页面上获取 url(of particluar article):title(of particluar article)。exp: prosoundnetwork: AV Meets the iPad by Christopher Maione

这里 prosoundnetwork: 是我的网站名称和 AV Meets the iPad by Christopher Maione: 是我的文章标题

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T22:05:10.330

[https://developers.facebook.com/docs/reference/plugins/like/](https://developers.facebook.com/docs/reference/plugins/like/)步骤 2 的生成器将生成适当的元标记以包含在博客文章中，以获取您想要的描述等出现

# php - ZF2 高级路由：如何拥有用户目录？

> ID：10404967
> 
> 赞同：0
> 
> 时间：2012-05-01T21:58:16.023
> 
> 标签：php, zend-framework2

使用 Zend Framework Routing (Zend\Mvc\Router\RouteStack)，我如何添加一个模块来支持用户配置文件页面。

但我也想让它支持根目录中的其他页面/模块，如`/rss`or `/search/asdf`。这是我第一次没有运气的猜测......

```
'Zend\Mvc\Router\RouteStack' => array(
    'parameters' => array(
        'routes' => array(
            'default' => array(
                'type'    => 'Zend\Mvc\Router\Http\Segment',
                'options' => array(
                    'route'    => '/[:username[/:action]]',
                    'constraints' => array(
                        'username' => '[a-zA-Z][a-zA-Z0-9_-]*',
                        'action'     => '[a-zA-Z][a-zA-Z0-9_-]*',
                    ),
                    'defaults' => array(
                        'controller' => 'Application\Controller\UserController',
                        'action'     => 'index',
                    ),
                ),
            ), 
```

网址示例...

*   [https://github.com/weierophinney](https://github.com/weierophinney)
*   [https://github.com/weierophinney/following](https://github.com/weierophinney/following)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T20:41:25.383

弄清楚了。在路由树的最末端使用 Zend\Mvc\Router\Http\Regex 匹配...

```
 'user' => array(
                        'type' => 'Zend\Mvc\Router\Http\Regex',
                        'options' => array(
                            'regex' => '/(?<id>[a-zA-Z0-9_-]+)',
                            'defaults' => array(
                                'controller' => 'Application\Controller\IndexController',
                                'action'     => 'user',
                            ),
                            'spec' => '/%id%',
                        ),
                    ),
                    'user-schedule' => array(
                        'type' => 'Zend\Mvc\Router\Http\Regex',
                        'options' => array(
                            'regex' => '/(?<id>[a-zA-Z0-9_-]+)/schedule',
                            'defaults' => array(
                                'controller' => 'Application\Controller\IndexController',
                                'action'     => 'schedule',
                            ),
                            'spec' => '/%id%/schedule',
                        ),
                    ), 
```

# java - java - 如何删除存储在JAVA中Set的Arraylist中的某个集合中的元素？

> ID：10404968
> 
> 赞同：0
> 
> 时间：2012-05-01T21:58:23.890
> 
> 标签：java, arraylist, set

我在删除某个集合中的元素时遇到问题，该元素存储在 JAVA 中的 Set 的 Arraylist 中。

我的代码是这样的：

```
public class Classroom {

    private ArrayList<Set<Integer>> arrSetSlot;
    private Set<Integer> SetSlot;

    public Classrom(){
        arrSetSlot = new ArrayList();
    }

    public ArrayList<Set<Integer>> getHimpWaktu_tersedia() {
        return arrSetSlot;
    }

    public void addSlotWaktu(int kromosom, int Slot){
        arrSetSlot.get(kromosom).add(Slot);
    }    

    public void addSlotWaktu(Set<Integer> SetSlot){
        arrSetSlot.add(SetSlot);
    }
}

public class Inisialisasi {
    ArrayList<Classrom> arrClassroom;
    Set<Integer> SetSlot;
    Database d;

    public Inisialisasi(){
        arrClassroom=new ArrayList();
        SetSlot=new HashSet();
        d = new Database();
        loadDatabase();
        validasiData();
    }

    private void loadDatabase(){
        for (int i=1;i<41;i++){
            SetSlot.add(i);
        }

        rs=d.getData("select* from kelas");
        try {
            while(rs.next()){
                Classroom kelas = new Classroom();
                kelas.setIdKelas(rs.getString("id_kelas"));
                kelas.setKodeKelas(rs.getString("kode_kelas"));
                for(int i=0;i<3;i++){
                    kelas.addSlotWaktu(SetSlot);
                }
                arrKelas.add(kelas);
            }
        } catch (SQLException ex) {
            Logger.getLogger(Inisialisasi.class.getName()).log(Level.SEVERE, null, ex);
        }

    }

    private void validasiData(){
        //the problematic remove
        arrKelas.get(2).getHimpWaktu_tersedia().get(2).remove(1);
        for (int i=0;i<arrKelas.get(1).getHimpWaktu_tersedia().size();i++){
            System.out.println(arrKelas.get(1).getHimpWaktu_tersedia().get(i).size());
        }
    }
} 
```

当我尝试使用此函数从数组中的某个集合中删除元素时：classic.getArrSetSlot.get(1).remove(1);

它不仅从第一个集合中删除了元素“1”，而且还从 arraylist 中的所有集合中删除了元素“1”。

这个问题有什么解决办法吗？？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T22:52:18.773

出色地，

```
public void addSlotWaktu(Set<Integer> SetSlot){
    arrSetSlot.add(SetSlot);
} 
```

应该是

```
public void addSlotWaktu(Set<Integer> SetSlot){
    arrSetSlot.add(new HashSet<Integer>(SetSlot));
} 
```

假设您想要插槽中该集合的新独立副本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T22:01:57.287

尝试这个：

```
arrSetSlot = new ArrayList<Set<Integer>>(); 
```

# php - 限制PHP中显示的文本长度（来自DB）？

> ID：10404973
> 
> 赞同：-1
> 
> 时间：2012-05-01T21:58:43.437
> 
> 标签：php, html, sql

我可以将数据库中的数据加载到我的网页中。但是，在某些情况下，我想限制放置在一行上的字符数。

例如，“DESCRIPTION”是一个 varchar(200)，我只想在这个特定页面上显示前 30 个字符。

```
<td><?php print $row->DESCRIPTION; ?></td> 
```

这样做的最佳方法是什么？

谢谢。

最终使用这个，

```
<td><?php print substr($row->DESCRIPTION,0,20); ?></td> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T21:59:54.597

我会在 php 端使用`substr`.

```
<?php echo substr($row->DESCRIPTION, 30); ?> 
```

当然，这并没有考虑到单词和什么，所以如果这很重要，您可能需要通过编写自定义函数来变得更复杂。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T22:48:52.293

您还可以调整 mysql 查询

```
SELECT SUBSTR(DESCRIPTION,1,5)
FROM Table
WHERE value = 'Denver'; 
```

# ruby-on-rails-3.1 - Rails 3.1 资产管道预编译失败，asset_path 参数错误

> ID：10404977
> 
> 赞同：4
> 
> 时间：2012-05-01T21:59:00.183
> 
> 标签：ruby-on-rails-3.1, twitter-bootstrap, asset-pipeline

处理 Rails 3.1 资产管道的第一天，失败了！

这是 assets:precompile 在生产机器上抛出的一长串错误中的最新一个：

`wrong number of arguments (1 for 2) for 'asset_path'`

这发生在 application.css 文件上（我认为这是它尝试的第一个文件）。

这是我的 application.css 的内容

```
/*
 * This is a manifest file that'll automatically include all the stylesheets available in this directory
 * and any sub-directories. You're free to add application-wide styles to this file and they'll appear at
 * the top of the compiled file, but it's generally better to create a new file per style scope.
 *= require_self
 *= require_tree . 
*/

.account-badge
{
    background-color: #B94A48 !important
}

.centered {
    float: none;
    margin-left: auto;
    margin-right: auto;
}

.container[role="main"] {
    padding-bottom: 300px;
}

.page-footer {
    border-top: 1px solid #EEEEEE;
    padding-top: 17px;
} 
```

可能很重要的一点是，我在一个全新的应用程序中使用了[twitter-bootstrap-rails （不是升级）](https://github.com/seyhunak/twitter-bootstrap-rails)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-02T00:10:07.007

查看您的`bootstrap_and_overrides.css.less`文件，该文件包含在文件的链轮 ( `*= require_tree`) 中`application.css`。

我猜错误是通过包含`@iconSpritePath`或 来定位的`@iconWhiteSpritePath`。

编辑：该方法需要两个参数：

```
asset-url("rails.png", image)  # becomes url(/assets/rails.png)
asset-path("rails.png", image) # becomes "/assets/rails.png" 
```

希望有帮助

# php - 在 PHP 中获取唯一的 worker/thread/process/request ID

> ID：10404979
> 
> 赞同：15
> 
> 时间：2012-05-01T21:59:08.903
> 
> 标签：php, multithreading, logging, webrequest

在多线程环境（如大多数 Web 平台）中，我经常在我的应用程序日志中包含某种线程 ID。当同时有多个请求同时写入同一个日志时，这使我能够准确地知道哪个日志条目来自哪个请求/线程。

在 .NET/C# 中，这可以通过 log4net 的格式化程序来完成，默认情况下包括当前线程的`ManagedThreadId`（数字）或`Name`（给定名称）。这些属性唯一地标识一个线程（参见例如：[如何使用 log4net 使用 Threadpool 线程记录正确的上下文？](https://stackoverflow.com/questions/2882306/how-to-log-correct-context-with-threadpool-threads-using-log4net)

在 PHP 中，我没有找到任何类似的东西（我问过 Google、PHP 文档和 SO）。它存在吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2014-03-19T14:16:33.693

直到最近，我还在使用 apache_getenv("UNIQUE_ID")，它与 ​​crc32 或其他哈希函数完美配合。

现在我只是使用以下内容，以消除对 Apache 和这个 mod 的依赖。

`$uniqueid = sprintf("%08x", abs(crc32($_SERVER['REMOTE_ADDR'] . $_SERVER['REQUEST_TIME'] . $_SERVER['REMOTE_PORT'])));`

它的独特性足以了解哪些日志属于哪个请求。如果您需要更高的精度，可以使用其他哈希函数。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-01T22:08:44.093

[`zend_thread_id()`](http://php.net/manual/en/function.zend-thread-id.php)：

> ```
> int zend_thread_id ( void ) 
> ```
> 
> 此函数返回当前线程的唯一标识符。

虽然：

> 此功能仅在 PHP 已使用 ZTS（Zend 线程安全）支持和调试模式（--enable-debug）构建时可用。

* * *

[`mysql_thread_id()`](http://www.php.net/manual/en/function.mysql-thread-id.php)当您使用该 API 进行数据库访问（或[`mysqli::$thread_id`](http://www.php.net/manual/en/mysqli.thread-id.php)使用 mysqli 时）时，您也可以尝试 yo call 。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-01-09T20:28:54.550

PHP 似乎没有可用的函数，但您的 Web 服务器可能能够通过环境变量传递标识符。例如，有一个名为“mod_unique_id”[1] 的 Apache 模块，它为每个请求生成一个唯一标识符并将其存储为环境变量。如果变量存在，它应该通过 $_SERVER['unique_id'] [2] 可见

“纯 PHP”解决方案可能是编写一个生成合适随机标识符的脚本，通过 define("unique_id", val) 将其存储，然后使用 php.ini 中的 auto_prepend_file [3] 选项将其包含在每个执行的脚本中。这样，在请求开始处理时将创建唯一 ID，并且在处理请求期间可用。

*   [1] [http://httpd.apache.org/docs/current/mod/mod_unique_id.html](http://httpd.apache.org/docs/current/mod/mod_unique_id.html)
*   [2] [http://forums.devshed.com/php-development-5/server-unique-id-questions-163269.html](http://forums.devshed.com/php-development-5/server-unique-id-questions-163269.html)
*   [3] [http://www.php.net/manual/en/ini.core.php#ini.auto-prepend-file](http://www.php.net/manual/en/ini.core.php#ini.auto-prepend-file)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-06-09T01:49:02.433

我见过[getmypid()](https://secure.php.net/manual/en/function.getmypid.php)用于此目的，但它似乎在不同的系统上表现不同。在某些情况下，每个请求的 ID 都是唯一的，但在其他情况下，它是共享的。

因此，您最好选择其他答案之一来确保可移植性。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-06-13T12:35:24.443

分配一个 ID 以识别服务请求的记录数据可能就像创建 UUID 版本 4（随机）并将其写入日志的每一行一样简单。

甚至还有软件可以帮助解决这个问题：[ramsey/uuid](https://packagist.org/packages/ramsey/uuid)、[php-middleware/request-id](https://packagist.org/packages/php-middleware/request-id)

使用[log4php](https://packagist.org/packages/apache/log4php)通过将 UUID 放入 LoggerMDC 数据并使用适当的 LogFormatter 将其添加到每一行日志记录很容易。使用 PSR-3 记录器，它可能会更复杂一些，YMMV。

随机创建的 UUID 将适用于识别单个请求，并且通过在子请求的 HTTP 标头和响应中使用该 UUID，甚至可以跨服务器场内的多个系统和平台跟踪一个请求。但是，将它作为标题不是我提到的任何包的任务。

# oracle - 尝试在 Tomcat 6 中创建数据源时出现“ORA-01017：用户名/密码无效；登录被拒绝”

> ID：10404981
> 
> 赞同：2
> 
> 时间：2012-05-01T21:59:35.863
> 
> 标签：oracle, tomcat, servlets, datasource, ora-01017

一直在努力在 Tomcat 中为应用程序设置数据源。我采取的步骤是

1.  使用以下内容创建 META-INF/context.xml

    ```
    <Context>
     <Resource name="jdbc/mydb"
      auth="Container"
      type="javax.sql.DataSource"
      driverClassName="oracle.jdbc.OracleDriver"
      url="jdbc:oracle:thin:@gpqa6.myserver.com:1526:gpqa6"
      username="foo"
      password="foobar"
      maxActive="20"
      maxIdle="30"
      maxWait="-1" />           
    </Context> 
    ```

2.  在 WEB-INF/web.xml 中输入以下文本

    ```
    <resource-ref>
        <description>Datasource</description>
        <res-ref-name>jdbc/mydb</res-ref-name>
        <res-type>javax.sql.DataSource</res-type>
        <res-auth>Container</res-auth>
    </resource-ref> 
    ```

3.  在代码中使用它

    ```
    public class MyServlet extends HttpServlet {

      private DataSource ds;             

      public void init() {

        try {
        Context ctx = new InitialContext();
        ds = (DataSource) ctx.lookup("java:comp/env/jdbc/mydb");

        } catch (NamingException e) {           
            e.printStackTrace();
        }
     }

      protected void doGet(HttpServletRequest request, HttpServletResponse response) 
      throws ServletException, IOException {
        //this is where the exception is thrown
        Connection conn = ds.getConnection(); 

        //...do stuff with the connection
    } 
    ```

但是继续出现以下错误

“映射期间遇到异常。错误：无法创建 PoolableConnectionFactory（ORA-01017：无效的用户名/密码；登录被拒绝） org.apache.tomcat.dbcp.dbcp.SQLNestedException：无法创建 PoolableConnectionFactory（ORA-01017：无效的用户名/密码；登录拒绝”

我知道用户名和密码是正确的。因为下面的代码有效

```
 Class.forName("oracle.jdbc.OracleDriver").newInstance(); 
    conn = DriverManager.getConnection(
    "jdbc:oracle:thin:@gpqa6.myserver.com:1526:gpqa6", "foo", "foobar"); 
```

我什至尝试输入无效的网址，但仍然出现相同的错误。这是怎么回事？？？

此外，Tomcat 是否有某种类似于 WebLogic 或 Glassfish 的数据源测试方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-02T14:14:04.987

现在它正在工作。好像在我与以下代码建立连接之后

```
 Class.forName("oracle.jdbc.OracleDriver").newInstance(); 
    conn = DriverManager.getConnection(
    "jdbc:oracle:thin:@gpqa6.myserver.com:1526:gpqa6", "foo", "foobar"); 
```

然后切换回使用数据源，就可以了。也许这是一个缓存问题？

--更新-- 这是一个缓存问题。我只需要删除 \conf\Catalina 文件夹。

这个链接真的很有帮助。 [http://pwu-developer.blogspot.com/2010/02/why-isnt-my-datasource-configuration.html](http://pwu-developer.blogspot.com/2010/02/why-isnt-my-datasource-configuration.html)

# rest - 为@InjectParam 生成 WADL 请求参数

> ID：10404985
> 
> 赞同：0
> 
> 时间：2012-05-01T21:59:44.247
> 
> 标签：rest, jersey, jax-rs, wadl

我正在使用[@InjectParam](http://jersey.java.net/nonav/apidocs/1.12/jersey/com/sun/jersey/api/core/InjectParam.html)将查询参数注入到 JAX-RS 资源中，该资源包含 Jersey 1.12 实现上的 @QueryParam 注释字段。

在资源上：

```
@Path("query")
@GET
@Produces(MediaType.APPLICATION_XML)
public Query queryParam(@InjectParam Query query) {
    return query;
} 
```

在接收注入参数的 pojo 中，我有一些 JAXB 和 JAX-RS 注释。

```
 @XmlRootElement
 public class Query {
    @QueryParam("value1")
    String value1;
 } 
```

来自 REST 客户端的简单测试：

> [http://localhost:8888/sandbox/query?value1=hello3](http://localhost:8888/sandbox/query?value1=hello3)

产生正确的结果：

```
<query>
  <value1>hello3</value1>
</query> 
```

这很好，但我也使用[wadl-maven-plugin](http://wadl.java.net/wadl2java.html)生成客户端，该客户端使用 WADL 文件生成客户端代码。如果 @QueryParam 注释包含在资源方法参数中，则WADL 文件不包含必要的[请求参数。](http://www.w3.org/Submission/wadl/#x3-190002.9.1)随后，我的客户被生产为不接受任何参数：

```
SandboxApi.sandbox().query().getAsQuery() 
```

而不是接受填充生成的客户端 pojo。

```
Query queryClient = new Query();
queryClient.setValue1("hello3");
SandboxApi.sandbox().query().getAsQuery(queryClient); 
```

任何人都知道我可以在 Jersey Resource 上放置一个魔术注释，该注释将生成一个带有正确信息的 WADL，以便 Wadl2Java 可以生成一个接受 POJO 并随后发送适当字段作为查询参数的客户端？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T18:03:24.773

一些在泽西岛工作的优秀人士提供的回复（通过私人谈话）：

```
@Path("query")
@GET
@Produces(MediaType.APPLICATION_XML)
public Query queryParam(@QueryParam("value1") String value1, 
                        @InjectParam Query query) {
   return query; 
} 
```

查询参数“value1”应该出现在生成的 WADL 中。

内置的 WADL 生成器不支持这些情况，我不确定它是否会很快得到支持。

# device-driver - 处理 KMDF 过滤器中的关闭

> ID：10404986
> 
> 赞同：1
> 
> 时间：2012-05-01T21:59:46.400
> 
> 标签：device-driver, kmdf

我正在研究 kmdf 卷过滤器驱动程序并想处理关机。WDF 书中的文章[WDM IRPs and KMDF Event Callback](http://msdn.microsoft.com/en-us/library/windows/hardware/gg583867%28v=vs.85%29.aspx)和评论似乎表明 WDF 仅支持控制（非 PNP）设备的 IRP_MJ_SHUTDOWN。所以我`WdfControlDeviceInitSetShutdownNotification(WdfDeviceShutdown)`为我的控制对象添加了调用，这允许我在关机时将文件保存到相同的卷。`WdfDeviceShutdown`但是，我没有看到在刷新之前调用的文档 sys 。我已经使用 EvtDeviceWdmIrpPreprocess(IRP_MJ_FLUSH) 回调了刷新。查看 Dbg 打印，我总是在回调之前看到刷新`WdfDeviceShutdown`回调。

我想知道我是否遗漏了什么。对此行为的任何评论都将帮助我更好地理解这一点。我之前看到过刷新，因为控制设备处于低于文件系统的卷过滤器级别，因此执行程序在关闭/通知我的设备之前会刷新文件系统缓冲区。

注意：如果我使用)尝试写入文件时`WdfControlDeviceInitSetShutdownNotification(WdfDeviceLastChanceShutdown`会出错。`0xc0000189 (STATUS_TOO_LATE)`

# python - python sqlite3 for循环更新

> ID：10404988
> 
> 赞同：4
> 
> 时间：2012-05-01T21:59:51.867
> 
> 标签：python

```
import sqlite3    
conn = sqlite3.connect('sample.db')    
cursor = conn.cursor()    
data = cursor.execute('''SELECT * From Table''')

for i in data:    
    title = i[0]        
    status = i[1]    
    cursor.execute('''UPDATED Table SET status=? WHERE title=?''', (status, title))

cursor.close()    
conn.commit() 
```

我正在尝试通过多次迭代进行更新。但是，一旦数据库进行第一次更新，脚本就会跳出循环。如何解决这个问题？谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-01T22:02:12.423

`data = data.fetchall()`在循环之前使用。否则，当您尝试遍历该结果集时，您最终会在循环内回收游标（重置其结果集）。

Using`.fetchall()`返回一个结果列表，以便您在重新使用游标之前将它们存储在本地。

或者，如果您不想在本地缓存第一个查询的结果，请创建一个单独的游标用于更新语句。

# django - 在我的 Django 站点中使用 HTTPS

> ID：10404994
> 
> 赞同：0
> 
> 时间：2012-05-01T22:00:34.497
> 
> 标签：django, deployment, https

我使用 Django 创建了一个网站，其中一个要求是它必须使用 HTTPS 协议。

我已经使用 Apache 将它部署在 VPS 中，没有任何问题。

**您建议我使用哪些文档/提示/片段来实现这一目标？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T22:46:17.933

如前所述，你不需要为 Django 做任何特别的事情来使用 SSL。如果你想强制执行 SSL，你可以通过检查`request.is_secure()`方法来验证对给定视图的传入请求是否通过 SSL（我过去曾使用它来制作一个简单的`require_ssl`装饰器）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-01T22:45:03.870

正如 Anurag 所说，这是与 apache 相关的，您可以在 httpd.conf 或类似配置文件中尝试类似的操作（需要 mod_rewrite 以及正确安装的证书）：

```
RewriteEngine on
RewriteCond %{HTTPS} !=on
RewriteRule .* https://%{SERVER_NAME}%{REQUEST_URI} [R,L] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-01T22:04:36.087

HTTPS/SSL 与 django 无关，您必须使用 mod_ssl 正确设置 apache 配置参见

[http://httpd.apache.org/docs/2.2/mod/mod_ssl.html](http://httpd.apache.org/docs/2.2/mod/mod_ssl.html)

并浏览此类文章

[http://www.thegeekstuff.com/2011/03/install-apache2-ssl/](http://www.thegeekstuff.com/2011/03/install-apache2-ssl/)

# python - 需要帮助修改 python 脚本以返回以度为单位的风向

> ID：10404996
> 
> 赞同：0
> 
> 时间：2012-05-01T22:00:41.593
> 
> 标签：python

我是脚本新手，只专门研究过 arcpy 模块。我目前正在使用脚本从“http://weather.noaa.gov/pub/data/observations/metar/stations”获取风的详细信息。我需要在 Web 应用程序中集成风向，并且需要帮助修改脚本以仅以度数返回风向，这是我从“http://pypi.python.org/pypi/”下载脚本的链接metar/" 我尝试通过添加一个仅返回方向的函数来对 Metar.py 进行更改

```
 def windDirection(self):
      """
      Return a textual description of the wind conditions.

      Units may be specified as "MPS", "KT", "KMH", or "MPH".
      """
      if self.wind_speed == None:
          return "missing"
      elif self.wind_speed.value() == 0.0:
          text = "calm"
      else:
          wind_speed = self.wind_speed.string(units)
          text = "%s"(self.wind_dir.directVal)
      return text 
```

还在 Datatypes.py 中添加了一个函数”

```
def directVal( self ):
    if not self._compass:
      degrees = 22.5 * round(self._degrees/22.5)
      if degrees == 360.0:
        self._directVal = "N"
      else:
        for name, d in direction.compass_dirs.iteritems():
          if d == degrees:
            self._directVal = name
            break
    return self._directVal 
```

我不确定如何将此值作为报告以外的单独文本返回。请协助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-11-26T01:33:11.407

METAR 数据的另一种方法（如果您在美国）是连接到该站的 NOAA 观测 XML 数据。虽然这有点冗长，但您可以使用我的 PARFAIT API 得到一个简单的答案。要返回 LAX 机场的当前风速，您可以使用 Current Weather API：[http ://parfait.snarkybox.com/current.php?icao=klax&datum=current_observation,wind_mph](http://parfait.snarkybox.com/current.php?icao=klax&datum=current_observation,wind_mph)

API 网站上提供了完整的说明：parfait dot snarkybox dot com。

# algorithm - 关于算法的一点提示

> ID：10404999
> 
> 赞同：0
> 
> 时间：2012-05-01T22:00:53.243
> 
> 标签：algorithm, lua, artificial-intelligence, path-finding

我需要一种算法，从 point_a 到 point_b 花费给定的 n 个像素（或者我可以将正方形 [面积大于像素] 视为一个像素）。例如：如果在笛卡尔计划中，point_a = (0,0) 和 point_b = (100, 150)，并且 n = 350，我希望算法以这种方式运行：如果 point_a + point_b 等于 n，那么它会执行直奔终点（即 x = 100, y = 150），但如果上述条件为假，它会继续围绕计划走，直到上述条件变为真，当它满足时，它就直奔主题。

我正在考虑我上面引用的算法。我的问题是该算法的花费不能多于或少于 n，它必须是精确的 n。

我目前正在使用 Lua，但这没关系，因为我在这里想要的实际上是改进我的想法，而不是让另一个准备好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T23:35:58.767

关于路径应该是什么样子的任何偏好？让算法先走直线，然后在最后一个方格来回走，直到所有步骤都用完，怎么样？或者稍微好看一点的算法看起来像这样：

假设 pointA 是 (0,0)，pointB 是 (0,p)，现在找到 pointC (x,0) 使得路径 A->C->B 的长度为 n。你可以很容易地得到 x = sqrt(n^2 - p^2)。如果 n==p, c=0 这意味着走直线。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T23:36:59.937

我不确定您使用的是什么距离测量值。如果从 (0,0) 开始，想走到 (3,4)，那么是 5 步（欧几里得距离）还是 7 步（曼哈顿距离）？如果您使用欧几里得距离，您如何处理无理距离？

我假设您使用的是曼哈顿距离，并且我提出了一个概率解决方案。

让我们假设您距离目的地有 m 步，并且您需要在 n 步中执行此操作（n>=m）。让我们将当前状态定义为 (m,n)。如果您向目标迈出一步，问题状态为 (m-1,n-1)，离目的地更远，则状态为 (m+1,n-1)。

*在每个点使用当前*状态 p = 3*m/(3*m + (nm) )计算前往目的地的概率。生成一个介于 0 和 1 之间的随机数，如果它低于 p 则前往目的地，否则远离目的地。

```
def nextmove(m,n):
    p = 3.0*m/(3*m + (n-m) )
    if random.random() <=p:
        return m-1,n-1,'towards'
    else:
        return m+1,n-1,'farther' 
```