# StackOverflow 问答 000436000-000436999

# python - 确保联系表格电子邮件不会丢失（python）

> ID：436003
> 
> 赞同：2
> 
> 时间：2009-01-12T16:33:03.047
> 
> 标签：python, email, race-condition, data-formats

我有一个带有联系表格的网站。用户提交姓名、电子邮件和消息，网站通过电子邮件将详细信息发送给我。

偶尔我的服务器的电子邮件系统出现问题，因此用户收到错误并且这些联系方式丢失。（不要说：获得更好的服务器，任何服务器都会时不时地出现电子邮件关闭，我们确实会收到很多提交）。

如果邮件发送函数返回错误代码，我想实现一个可以存储用户详细信息的系统。然后在每次进一步提交时，检查任何存储的提交并尝试将它们发送给我。

但是如何存储数据？

我正在使用python，所以我考虑使用[搁置](http://docs.python.org/library/shelve.html)（单文件半数据库）。或者也许有人可以建议更好的数据格式？（我确实认为一个完整的数据库解决方案会有点矫枉过正。）

我看到的单个文件方法的问题是*竞争条件*：同时发送两封或多封失败的电子邮件会导致对数据文件进行两次编辑，从而导致数据损坏。

那么该怎么办？多文件解决方案，文件锁定还是其他？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-12T16:40:21.457

当我们在我们的环境中实现电子邮件发送功能时，我们以一种解耦的方式进行。因此，例如，用户将提交他们的数据，这些数据将存储在数据库中。然后，我们有一个单独的服务来运行、查询数据库并发送电子邮件。这样，如果有任何电子邮件服务器问题，该服务将稍后重试，数据和用户信心永远不会丢失。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-12T16:35:29.000

尝试[sqlite](http://www.sqlite.org/)。它在标准库中具有默认的[python 绑定](http://docs.python.org/library/sqlite3.html)，并且应该适用于有用的负载水平（或者我被告知）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-12T16:57:17.507

按照建议，您可以为此使用 sqlite。主要问题是：“大量提交”是多少？我低于每秒几个，这将起作用。否则数据库文件将一直被锁定，您将遇到另一个问题。

但你也可以让它保持简单、愚蠢和简单：将文件写入磁盘。对于每个提交，一个文件都会写入一个临时目录（如果邮件服务器已关闭）。然后在读取目录并发送邮件的邮件服务器启动脚本中添加几行代码。没有数据库，没有锁定问题，如果您使用设置了配额的目录（或具有固定大小的 ramdisk），您应该不会遇到任何问题。

# mysql - DBI 和 MySQL 出现奇怪的 ruby 分段错误

> ID：436004
> 
> 赞同：1
> 
> 时间：2009-01-12T16:33:12.810
> 
> 标签：mysql, ruby, segmentation-fault, dbi

以下代码在最后一行给出了分段错误

```
require 'rubygems'
gem 'mysql'
gem 'dbi'
require 'dbi'
require 'mysql'

dsn = "DBI:Mysql:DATABASE:www.HOST.net" # redacted
dbh = DBI.connect(dsn, "USERNAME", "PASSWORD") # redacted

sth = dbh.execute("select  * from TABLE where numeric_value is not null limit 10;") # redacted 
```

这绝对是导致问题的最后一行——下一行的打印语句永远不会被执行。

有谁知道为什么这么简单的尝试会失败？

我在 Windows 上运行它，以防万一。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-12T17:08:37.497

这可以是任意数量的东西，从 DBI 版本、Mysql gem、mysql 版本和 ruby​​ 版本。

不幸的是，ruby 不是 Windows 上的一等公民，也不是所有配置都在它上面进行了广泛的测试。

首先在您的 VM 上启用调试以重现此问题，并提供有关发生段错误的位置和原因的更多信息。将 -d 选项传递给 VM。希望从那里您可以获得更多信息来寻找解决方案。

我建议，检查你的虚拟机的补丁级别

```
ruby --version 
```

我还要检查 DBI 和 Mysql 的级别

```
 # if you are using gems
  gem list --local 
```

您还可以切换访问 Mysql 的方式，ActiveRecord 使用它自己的代码连接到经过更广泛测试的 mysql。可能不是最好的解决方案，但不应排除它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-12T16:54:01.177

我不知道你为什么在这段代码中遇到段错误。

例如，如果您超出了数组的边界，那么在您尝试运行代码或访问您覆盖的内存之前，您实际上可能不会出现段错误。因此，如果它只在内存中写入进程在它不经常访问的区域中拥有的区域，那么您可以拥有一个运行数天的系统，然后再出现段错误。

# sql-server-2008 - 无法将域用户添加到 Reporting Services 2008

> ID：436010
> 
> 赞同：1
> 
> 时间：2009-01-12T16:35:51.980
> 
> 标签：sql-server-2008, reporting-services, dns, ssrs-2008

我已经`SSRS 2008`在数据库服务器上进行了设置。
服务器是域的一部分。
Reporting Services 在`NetworkService`.
当我尝试使用 Web 界面 ( `Site Settings`--> `Security`--> `New Role Assignment`) 添加域用户时，页面会发回，但用户不在列表中。
服务器的日志文件包含以下未处理的异常：

> ui!ReportManager_0-1!954!01/12/2009-10:14:52:: 未处理的异常：System.Security.Principal.IdentityNotMappedException：无法翻译部分或全部身份引用。在 System.Security.Principal.SecurityIdentifier.Translate(IdentityReferenceCollection sourceSids, Type targetType, Boolean forceSuccess) 在 System.Security.Principal.SecurityIdentifier.Translate(Type targetType) 在 System.Security.Principal.WindowsIdentity.GetName() 在 System.Security .Principal.WindowsIdentity.get_Name() 在 System.Web.Security.WindowsAuthenticationModule.OnEnter(Object source, EventArgs eventArgs) 在 System.Web.HttpApplication.SyncEventExecutionStep.System.Web.HttpApplication 的 ReportingServicesHttpRuntime.RsWorkerRequest.GetServerVariable(String name)。 System.Web.HttpApplication 中的 IExecutionStep.Execute()。

任何人都知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-05-29T09:05:17.187

回到家然后在属性上，然后添加具有角色的用户，无论您想提供什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-01T04:56:52.647

允许用户列表中是否还有其他域用户？也许“NetworkService”没有从 AD 读取的权限，尽管我希望它可以。我一直将 SSRS 作为域代理用户（Domain\SSRS_Proxy 或其他）运行，并且我之前能够添加“域用户”。

# c++ - 有什么方法可以检查迭代器是否有效？

> ID：436013
> 
> 赞同：3
> 
> 时间：2009-01-12T16:36:55.613
> 
> 标签：c++, performance, stl, iterator

例如，对于操作容器映射的两个线程，测试迭代器是否仍然有效（出于性能原因）的正确方法是什么？
或者只能通过间接的方式来做到这一点。示例代码：

```
#define _SECURE_SCL 1
//http://msdn2.microsoft.com/en-us/library/aa985973.aspx
#define _SECURE_SCL_THROWS 1

#include "map"
#include "string"
#include "exception"
#include "iostream"

using namespace std;

void main(void)
{
    map<string, string> map_test;
    map<string, string>::iterator iter_map_test;

    map_test [ "AAAAA" ] = "11111";
    map_test [ "BBBBB" ] = "22222";
    map_test [ "CCCCC" ] = "33333";

    iter_map_test = map_test.find ("BBBBB");

    map_test.erase ("BBBBB");

    try
    {
        string value = (*iter_map_test).second;
    }
    catch ( exception & e )
    {
            cout << e.what() << endl;
    }
    catch ( ... )
    {
            cout << "generic exception." << endl;
    }
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-12T16:39:36.370

`std::map`s 根本不是线程安全的。如果您一次有多个线程修改同一个映射，您最终会遇到比无效迭代器更糟糕的问题。我什至不认为您可以保证可以在地图被另一个线程修改时从地图中读取任何内容。

关于 STL 和线程的一些页面：

*   [MSDN](http://msdn.microsoft.com/en-us/library/c9ceah3b.aspx)
*   [SGI](http://www.sgi.com/tech/stl/thread_safety.html)
*   [海合会](http://gcc.gnu.org/onlinedocs/libstdc++/manual/bk01pt01ch03s05.html#manual.intro.using.concurrency.thread_safety)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-12T18:53:35.447

如果您的 STL 不提供线程安全`std::map`，[英特尔的 TBB 提供线程安全`concurrent_hash_map`](http://softwarecommunity.intel.com/isn/downloads/softwareproducts/pdfs/301114.pdf)（第 60 和 68 页）。

将线程安全问题放在一边，`std::map` *确实*保证删​​除不会使迭代器无效，而不是被删除的迭代器。不幸的是，没有一种`is_iterator_valid()`方法可以验证您持有的迭代器。

有可能实现类似[hazard pointers](http://en.wikipedia.org/wiki/Hazard_pointer)的东西，TBB 也有一些解决该问题的方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-12T16:39:57.743

如果您知道其中一个线程只会读取映射而另一个可能正在操作它，最简单的解决方案是让只读线程克隆映射并遍历克隆。

（警告：我比 STL 更了解 Java 的集合类，但这就是我在 Java 中的做法。）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-12T16:46:19.120

如果您实现了读取器/写入器解决方案，那么您可以让写入器设置一个标志，使读取器的所有迭代器无效。

[http://en.wikipedia.org/wiki/Readers-writer_lock](http://en.wikipedia.org/wiki/Readers-writer_lock)

正如 Josh 和 Paul Tomblin 所提到的，我不会尝试在没有同步的情况下写入地图。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-17T15:17:40.550

即使您能够判断指针是否有效，它也无法解决您的问题。您正在共享一个没有排他性保证的资源。这就是它失败的原因。

它会在这个线程序列中失败：

线程0.......................线程1

获取迭代器->it0

检查 it0 是否有效

.............................获取迭代器->it1

................................................检查 it1 是否有效.

擦除 (it0)

.............................擦除 (it1)

您可以添加信号量来访问共享资源。

# php - 为什么我应该在 PHP 中使用模板系统？

> ID：436014
> 
> 赞同：61
> 
> 时间：2009-01-12T16:37:12.680
> 
> 标签：php, smarty, template-engine

为什么我应该在 PHP 中使用模板系统？

我的问题背后的原因是：PHP 本身是功能丰富的模板系统，我为什么要安装另一个模板引擎？

到目前为止，我发现的唯一两个优点是：

1.  更简洁的语法（有时）
2.  模板引擎通常不足以实现业务逻辑，因此它迫使您分离关注点。使用 PHP 进行模板可以诱使您绕过模板原则并重新开始编写代码汤。

...与缺点相比，两者都可以忽略不计。

小例子：

**PHP**

```
<h1><?=$title?></h1>
<ul>
  <? foreach ($items as $item) {?>
  <li><?=$item?></li>
  <? } ?>
</ul> 
```

**聪明的**

```
<h1>{$title}</h1>
<ul>
  {foreach item=item from=$items}
  <li>{$item}</li>
  {/foreach}
</ul> 
```

我真的完全看不出有什么区别。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-01-12T16:46:51.893

是的，正如您所说，如果您不强迫自己在 PHP（模板引擎）中使用模板引擎，那么很容易滑倒并停止分离关注点。

**然而**，在分离关注点时遇到问题的人最终会生成 HTML 并将其提供给 smarty，或者在 Smarty 中执行 PHP 代码，因此 Smarty 几乎无法解决您的关注点分离问题。

也可以看看：

*   [PHP 作为模板语言或其他一些模板脚本](https://stackoverflow.com/questions/62605/php-as-a-template-language-or-some-other-php-templating-script)
*   [通过 PHP 插入 HTML 的最佳方法是什么](https://stackoverflow.com/questions/261338/what-is-the-best-way-to-insert-html-via-php)

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-01-12T16:54:26.043

人们使用模板系统的主要原因是将逻辑与表示分离。这有几个好处。

首先，您可以将模板交给网页设计师，他们可以随意移动内容，而不必担心保持代码的流畅性。他们不需要了解 PHP，只需要知道不要理会特殊标签。他们可能需要为一些标签学习一些简单的语义，但这比学习整个语言要简单得多。

此外，通过将页面拆分为单独的文件，程序员和设计人员可以同时在同一个“页面”上工作，根据需要签入源代码控制，而不会发生冲突。设计师可以针对稳定版本的代码测试他们的模板视觉效果，同时程序员针对他们自己的副本进行其他可能破坏性的更改。但是，如果这些人都在编辑同一个文件并且必须合并不同的更改，那么您可能会遇到问题。

它还强制执行良好的编程实践，使业务逻辑远离表示逻辑。如果您将业务逻辑与演示文稿混合在一起，那么如果您以后需要以不同的方式演示它，那么您将很难提取它。如今，Web 应用程序中的不同呈现模式越来越流行：RSS/ATOM 提要、JSON 或 AJAX 响应、用于手持设备的 WML 等。使用模板系统，这些通常可以完全使用模板完成，而无需或很少更改任何内容别的。

然而，并不是每个人都需要或欣赏这些好处。PHP 相对于 Java/Python/Ruby/etc 的优势在于您可以快速破解包含一些逻辑的网页，这一切都很好。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-01-13T13:32:00.510

以分离逻辑为借口使用非 PHP 模板是无稽之谈。如果开发人员不了解业务视图逻辑分离是什么以及应该如何完成，那么必须适当地解决问题。否则，您最终会在业务逻辑中使用 HTML 或在模板中使用业务逻辑——没有模板引擎可以拯救您。您必须向开发人员教授基础知识。

如果开发人员*确实*理解这一点，那么模板系统只是一个限制。它不会为开发过程增加*任何价值*，只会增加学习新语法、保持另一个库最新以及执行速度变慢的开销。虽然后者可以通过缓存等方式解决，但这只能解决一个原本不存在的问题。因此，模板系统没有任何价值，也没有任何优势。

但是，有一个例外，我认为使用非 PHP 模板系统是合理的：当视图逻辑程序员必须对模板具有有限的访问权限时。例如，如果您是博客托管系统的提供商，并且您希望允许您的用户对他们的模板进行个性化和编码，而不允许他们执行任意代码。然而，这个论点*不适*用于设计师愿意学习一些代码来帮助编程 UI 的情况。如果他能学Smarty，他*肯定*能学PHP。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-01-20T00:34:33.620

使用模板系统仍然有充分的理由，但不是 Smarty，而是[PHPTAL](http://phptal.org/)。PHPTAL 模板是有效的 XML（因此也是 XHTML）文件。您可以进一步在 PHPTAL 中使用虚拟内容，从而获得具有最终外观的有效 XHTML 文件，可以使用标准工具对其进行处理和测试。这是一个小例子：

```
<table>
  <thead>
    <tr>
      <th>First Name</th>
      <th>Last Name</th>
      <th>Age</th>
    </tr>
  </thead>
  <tbody>
    <tr tal:repeat="users user">
      <td tal:content="user/first_name">Max</td>
      <td tal:content="user/last_name">Mustermann</td>
      <td tal:content="user/age">29</td>
    </tr>
  </tbody>
</table> 
```

PHPTAL 模板引擎将自动插入用户数组中的所有值并替换我们的虚拟值。尽管如此，该表已经是可以在您选择的浏览器中显示的有效 XHTML。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-01-12T17:53:02.323

PHP几乎是一个模板系统*。*关键是强迫自己将逻辑与表示分开。使用 Smarty 或类似的东西只会使混合逻辑和表示变得稍微不方便。如果您不能自己将它们分开，那么使用模板系统将无济于事。它所要做的就是消耗额外的处理能力。

关键是不要更改演示代码中的任何值。为此，如果您使用 if/endif 语法，我认为 PHP 本身与 Smarty 一样有效：

```
<?php if($some_test): ?>
   <em>Some text!</em>
<?php endif; ?> 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-01-19T23:32:12.497

对我来说，模板引擎的一大特点是缓存层对你来说是透明的。我很久以前就一直在使用 smarty，缓存的东西让生活更轻松。聪明的设计也让你可以使用自己的缓存功能。在我的情况下，我选择对于某些页面是否应该使用 memcache 或磁盘来存储模板输出。

另一方面，如果您的网站流量很大，并且您不知道如何管理和调整它，那么任何模板引擎都可能成为网站杀手。但即使不使用 smarty，您的网站也会死掉。

flickr 目前正在使用 smarty。它应该不会太糟糕，不是吗？

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-01-12T16:44:53.600

大多数情况下，我认为要避免在模板中应用任何“不安全”的后端逻辑。由于大多数时候模板是交给设计师的，我们只想给他们一套他们可以做的封闭的事情。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-01-12T16:56:16.557

我喜欢从任何 PHP 文件中轻松显示任何模板的能力（并在彼​​此内部包含模板片段，用于导航栏等常见元素）。例如，假设您有一个页面，如果您已登录，则该页面通常会打印一些信息，如果您没有登录，则会显示错误。使用 PHP，您可以编写如下内容：

```
if (loggedIn)
{
    // print lots of HTML here
}
else
{
    // print error message
} 
```

在 Smarty 中，它可能是这样的（请原谅我可能错误的语法，已经有一段时间了）：

```
if (loggedIn)
{
    $smarty->bind("info", someObject);
    $smarty->display("info.template");
}
else
    $smarty->display("error.template"); 
```

如果你真的很聪明，你甚至可以显示登录页面模板而不是错误模板，还可以选择显示一条消息来解释用户为什么会出现在此处。如果您采用我编写的技术，然后决定切换到显示登录框，那么只需更改一行！对我来说，这不仅仅是关于保持视图和逻辑的分离，而是关于从许多地方重用视图的公共元素的能力。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-01-12T17:06:45.177

我很高兴使用像代码点火器这样的 MVC 框架。我发现在“视图”中，我倾向于坚持只与值的显示方式相关的 php 代码。我有一个可以在视图中使用的格式化函数库。代码点火器的前提之一是避免使用模板语言，因为它会限制您并导致速度变慢。

我发现对于设计师来说学习一些 PHP 更好，这样他们就可以实现他们需要做的事情，例如。交替类名。从长远来看，这也将使它们更加有用，并且从一种语法到另一种语法并不是一个巨大的飞跃。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-01-18T19:27:15.457

你忘记了`htmlspecialchars()`两次。这就是为什么你需要模板系统。

聪明的很可怜。不要以此来判断模板系统。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-01-12T16:48:26.573

你的分析是有道理的。我想：

*   模板设计师和后端程序员可能不是一回事，所以它促进了分离。
*   它在某种程度上保护您免受自己的伤害，因为您不能在模板中真正做“太多”的 PHP。
*   在某些情况下优化/预编译模板可能更容易？（这是推测）

就个人而言，我认为它们比它们的价值更麻烦。特别是如果您想将模板交给“设计师”，它们就不起作用，因为所见即所得工具不知道如何处理它们。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-01-12T17:08:33.520

我认为您不应该使用模板引擎。相反，您应该使用[Zend_View](http://framework.zend.com/manual/en/zend.view.html)之类的东西，它鼓励您将逻辑与表示分离，但允许您在 PHP 中构建表示层。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-01-12T17:39:52.053

我没有看到的一个模板引擎优势是动态 html 元素的可能性——比如 asp.net 控件。例如，使用 PEAR 的 HTML 模板 Flexy，您可以拥有自动维护状态的动态表单元素。可以填充常规的 html 选择元素，并在后面的代码中设置所选项目，而模板中没有循环或条件。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-01-12T17:51:55.710

我认为更简洁的语法是一个很大的胜利。虽然它可能看起来只有几个字符，但是当你每天都这样做时，每个字符就开始计数了。

恕我`{$myvar|escape}`直言，比`<?php echo htmlspecialchars($myvar); ?>`. （请记住，`<?=$foo?>`语法只有在 PHP conf 中特别启用时才可用。）

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-01-12T20:30:06.313

*   您想使用带有 PHP 代码的文件作为模板吗？美好的。
*   您想在所述模板中使用您的变量吗？美好的。

只需记住将逻辑和最终输出（表示）分开。使用模板框架可以更好地实现这一点。但是您不必学习 Smarty 之类的东西。

*   如果你使用 Zend_View 或类似的，你可以一直使用 PHP 代码。

这里的很多人都有正确的答案。Smarty 不在 PHP 中进行模板化。离得很远。Smarty 主要适用于那些必须使用设计人员（即非程序员）来编辑和设置页面显示的人。如果要更改页面布局的每个人都可以编程，那么您可以使用更面向 PHP 代码的模板系统。但是您确实应该准备好所有输出数据并将其发送到模板。如果您让每个页面获取、处理和显示内容，您将不得不早晚重构它。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-01-12T20:34:44.307

当你为别人写代码时。例如，我曾经参与创建一个应该为我们的客户定制的刚性 Web 应用程序框架。一个重要的要求是客户可以聘请设计师来修改模板*，而无需*编程。更重要的是，他可能无权*更改*代码。

例如，Smarty 允许对模板的功能实施非常严格的限制。基本上，我们的应用程序禁用了除了最基本的代码结构和一组选定的修饰函数之外的所有内容。所以我们有两个目标可以通过模板引擎很好地实现：**简单性**和**安全性**。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-01-19T23:44:22.770

让我们不要忘记未来。网站几乎在发布的那一刻就已经过时了。您将需要在某个时候更新外观。如果你经常保持分离，一个设计师一个人就可以在后端使用相同的编程完成一个全新的网站。这允许更快、更便宜的重新设计，允许您仅在需要新功能时才让程序员参与。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2013-11-27T09:10:26.857

有些人可能会争辩说 Smarty 做了 PHP 已经可以做的事情：将表示与业务逻辑分开。PHP 编程语言非常适合代码开发，但是当与 HTML 混合使用时，PHP 语句的语法可能会变得一团糟。Smarty 通过使用更简单的基于标记的语法将 PHP 与演示文稿隔离开来弥补了这一点。标签显示应用程序内容，强制与 PHP（应用程序）代码完全分离。管理 Smarty 模板不需要 PHP 知识。

这种分离的重要性是视情况而定的。对于网页设计师来说，它通常比对 PHP 开发人员更重要。因此，当开发人员和设计人员的角色分开时，Smarty 通常是一个很好的选择。没有正确或错误的答案：每个开发团队对管理代码和模板都有自己的偏好。除了干净的基于标签的语法之外，Smarty 还提供了多种工具来管理演示：粒度数据缓存、模板继承和功能沙箱等等。业务需求和与 Smarty 一起使用的 PHP 代码将在确定 Smarty 是否合适时发挥重要作用。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-01-12T17:12:53.887

我敢打赌，如果 PHP 模板语言如此强制以迫使您使用它，那么您根本不会使用它。在遇到麻烦时“跳出”并按照自己的方式做事的能力是 PHP 的吸引力之一。

我不是说这是一件好事，也不是说代码可以维护，只是在最初的考虑中，我不会选择完全阻止我的模板语言。

否则，我同意模板系统可以帮助您在编码和设计之间划分工作，并可能让设计师设计和编码给我们。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2010-07-15T22:38:04.540

我个人总是在 php、python 等中使用模板引擎。

其他人已经提到的第一个明显原因：

> 它迫使您不要在模板中使用任何业务逻辑。

是的，当然，当你拥有纪律时，纪律会做得很好。

但这**只是您使用模板引擎的一个小方面**。它们中的大多数不仅仅是一个引擎，而且可以被认为是模板框架，不管你喜欢与否。

例如，Smarty 还具有部分缓存等高级缓存功能。真正有用的东西，当你只使用 php 作为模板语言时，你必须自己做的事情。

并且请不要忘记所有那些真正有用的帮助函数，只需在文档中快速搜索即可。它们中的大多数还提供了一种简单的方法来插入您自己的功能和/或工具包。

所以，是的，这是一个选择问题。当需要真正简单的模板时，请考虑展示一些纪律，将您的逻辑排除在模板之外。但是当您期望您的应用程序增长时，您最终将需要模板框架的功能。到那时，你希望不会通过自己编码来重新发明轮子。

最后但并非最不重要的一点是，对我来说，一些模板框架中提供了一个杀手级功能。

> **模板继承**

我是从[Django](http://docs.djangoproject.com/en/1.2/topics/templates/#id1)了解它的，现在我在最新的[Smarty 3](http://www.smarty.net/forums/viewtopic.php?t=15162&sid=c7b3ba46e5f552e409b39a7f7b3946ab)中使用它。Symphony 框架的人也有[Twig](http://www.twig-project.org/)，您可以考虑使用 Django 语法将其移植。

乍一看有点奇怪，但是非常强大。您构建您的骨架并定义各种块。您可以扩展此类骨架并使用您的内容填充（覆盖）块。

对我来说，这是一个守门员！

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2013-01-04T05:36:32.353

模板管理系统，我们可以单独管理模板文件。系统执行时间会比普通 PHP 项目快。所以这里PHP文件和模板文件是分开维护的。

运行文件后，代码将保存在 template_c 中。所以它没有编译很多次。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2013-04-06T19:40:38.950

我多次使用[tinybutstrong](http://www.tinybutstrong.com/)，它的语法非常简洁。html 模板中没有循环或伪代码。

从他们的主页：

> TinyButStrong 是一个库，它使您能够基于文本源动态创建 XML/HTML 页面和任何其他文件。它是 PHP 语言的模板引擎。它使您能够轻松地显示数据库中的信息，而且还可以认真协调和简化您的 PHP 编程。
> 
> TinyButStrong 是面向 HTML 的，但不是专门针对 Html 的。这意味着它可以与文本文件、XML、RSS、RTF、WML、Excel (xml) 以及... OpenTBS 插件使您能够合并 OpenOffice 和 Ms Office 文档。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2014-03-17T16:47:17.733

会大量使用 OOP 概念的开发人员，如 JAVA/ [Spring](http://spring.io/) /Oracle PL-SQL 人，他们说 PHP 语言本身用于企业级项目中的表示/视图/显示逻辑。在这些 BIG 项目中，后端是 Oracle，数据库使用 pl-slq/java 获取，演示文稿是 php。最好的例子是 facebook。[http://en.wikipedia.org/wiki/Facebook](http://en.wikipedia.org/wiki/Facebook) facebook 使用 php 进行演示，java/c++ 作为后端接口。

将 php 用作演示文稿的唯一原因是它与 HTML 紧密配合，但 java/c++ 更多基于 OOP，不能直接与 HTML 配合使用。告诉我一个使用 Smarty 的 CMS（joomla/drupal/wordpress）或框架（zend/symfony/Yii）？那么为什么smarty是必要的呢？

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2015-08-12T00:48:34.800

我喜欢使用模板有几个原因：

1）它清理了PHP代码的可读性。当到处都有带有 HTML 块的 print("") 语句时，我的 PHP 文件变得臃肿且不美观。此外，还会出现一些问题，例如如何将变量传递到 HTML 文本中？你到处使用标签吗？您是否使用 print("") 并转义您的 HTML 引号并连接您的变量？您是否使用 print("") 并在 HTML 中使用单引号，违反标准，并直接插入变量？

2) 它清理了 HTML 代码的显示。如果生成的 HTML 在多个文件中被剪切和破解，就很难保持其良好的外观。例如，您的缩进可能会消失。

3）它允许您创建多个模板，然后登录用户可以选择在浏览您的网站时要显示的模板/皮肤，如果您愿意，您还可以快速轻松地将默认模板更改为其他模板倾斜。

总的来说，这只是组织一切的更好方式。在必须学习和键入模板类命令、打开多个文件等方面有一些权衡。但在我看来，我认为这是值得的，因为代码的可读性和组织性都提高了。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2020-01-04T13:30:56.893

总结一下，我补充一些我的想法。如果有可能，我们应该使用模板系统：

1.  缓存和代码压缩
2.  提供一些安全层（如何显示变量）
3.  模板继承和代码html的重新制作（允许避免重复代码）
4.  编写自己的插件/模块以改进写作视图的能力
5.  “照顾”翻译问题并将这个麻烦转移到视图层*（在 Smarty 中没有内置模块，但有很好的社区解决方案）*

# delphi - Windows 7 Beta 和无效的 MCI 设备 ID。采用

> ID：436018
> 
> 赞同：0
> 
> 时间：2009-01-12T16:38:21.133
> 
> 标签：delphi, windows-7

由于 Windows 7 及其 beta 版本的新颖性，不确定这是否会得到很大的响应，但这里有……

一些警告；

1）。我还没有撕掉我的代码

2）。该应用程序在 Vista 及以下版本中运行良好

3）。使用 MMSystem 播放 mp3 和 cds。

我有一个可以播放音乐 CD (cda) 和 mp3 的应用程序，在 Windows Vista 及更低版本、XP、2000 等中运行良好。

在 Windows 7 Beta 上运行时，我得到... 无效的 MCI 设备 ID。使用初始化播放器时操作 MCI 设备时返回的 ID。

这是 Windows 7 Beta 及其媒体播放器中的错​​误的一部分还是我问题的主要焦点，在我撕毁我的代码之前，是否/有其他人经历过这个并找到了一个简单的解决方案？

谢谢！

约翰

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-12T17:34:35.277

好吧，在不了解您的确切项目的情况下，我会说，是的，Windows 7 的媒体播放器存在错误。

Microsoft 建议您在安装完 Windows 7 Beta 1 后立即安装此补丁。

[http://support.microsoft.com/default.aspx/kb/961367](http://support.microsoft.com/default.aspx/kb/961367)

# delphi - EDBEngineError-网络初始化失败

> ID：436021
> 
> 赞同：1
> 
> 时间：2009-01-12T16:38:37.263
> 
> 标签：delphi, bde, paradox

我正在尝试将 Dephi 2006 项目转换为 Delphi 2009（Delphi 2006 在 Drive C 上 Delphi 2009 在 Drive D 上）。

在主窗体上有一个`DataSource1: TDataSource;`和一个`Table1: TTable;`

在`OnFormShow`表中文件名设置为：

```
TableFilename := IncludeTrailingPathDelimiter( MyProfileFolder ) + 'Delphi 2009\Projects\Adirondack Lake Maps\' + 'TITLES.DB';
Table1.Active := False;
Table1.TableName := TableFilename;
Table1.Active := True; 
```

运行应用程序时，我得到：

```
EDBEngineError-网络初始化失败
没有权限
文件 C:\PDOXUSERS.NET
目录：c:\

```

问题：

1.  如何设置 PDOXUSERS.NET 的正确路径？
2.  这是一个简单的应用程序，它将扫描的湖泊地图存储在数据库中，并在几个字段中显示有关湖泊的信息。
3.  过去我曾经使用 BDE。用于替换 BDE 的最简单的数据库访问组件是什么？我在哪里可以了解更多信息？现在有很多用于 Delphi 2009 的数据库引擎我不知道从哪里开始。

* * *

更多信息 我在 Vista 上运行 Delphi 2009。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-12T16:52:55.207

将`TSession`组件添加到您的项目中。将其`NetFileDir`属性设置为普通用户可写的位置，例如公共 appdir 文件夹。pdoxusers.net文件将存储在那里*。*有关更多信息，请参阅[comp.lang.pascal.delphi.misc 上的新闻组帖子](http://groups.google.com/group/comp.lang.pascal.delphi.misc/browse_thread/thread/3b19e01b83875f8e)。

这与 Delphi 2009 无关，与 Windows Vista 及其更严格的用户权限有关。

如果您正在寻找 BDE 的替代品，请从[BDE 替代品指南](http://kylecordes.com/bag/index.html)开始。（它说它有一个新家，但它没有。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-10T10:08:43.193

`.net`如果您进入**BDE 管理员**（在控制面板中）并进入`Configuration -> Drivers -> Native -> Paradox`并将路径更改为**可写**的位置（例如 D:\） ，则可以更改文件的默认位置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-12T20:31:32.517

如果您进入 BDE Administrator（在控制面板中）并进入 Configuration -> Drivers -> Native -> Paradox 并将路径更改为可写的位置（My Documents for例子）。您可能需要以管理员身份运行 BDE 管理员，您可以通过右键单击 c:\program files\common files\Borland Shared\BDE\BDEAdmin.exe 并选择以管理员身份运行来直接运行它。

然而，事情变得更加混乱，因为 BDE 不是 Vista 应用程序，Vista 可能会使用虚拟存储来保存配置文件，您可能必须删除这些文件。我不记得虚拟商店在我脑海中的位置，但是因为我主要使用 XP。

# sql - SQL INSERT，强制截断字段

> ID：436023
> 
> 赞同：10
> 
> 时间：2009-01-12T16:38:40.540
> 
> 标签：sql, sql-server

我输入的数据包含一些比相应数据库字段长的“流氓”字段。这会导致我的导入脚本，它使用 SQL INSERT 语句失败并出现警告：

```
Msg 8152, Level 16, State 13, Line 2
String or binary data would be truncated. 
```

如何强制截断这些字段并让我的脚本完成？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-12T16:49:25.557

当您插入时，请执行以下操作：

```
INSERT INTO Table1('Column1') VALUES(LEFT(RTRIM(InputField), MaxLength)) 
```

您只会将左 N 个字符存储到数据库中。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-05-20T15:39:46.337

使用 Ansi 警告？[http://msdn.microsoft.com/en-GB/library/ms190368(v=sql.110).aspx](http://msdn.microsoft.com/en-GB/library/ms190368(v=sql.110).aspx)

```
DECLARE @TABLE TABLE
(
    Data VARCHAR(3)
)

SET ANSI_WARNINGS OFF

INSERT INTO @TABLE 
VALUES('Hello World')

SELECT * FROM @TABLE

SET ANSI_WARNINGS ON

INSERT INTO @TABLE 
VALUES('Goodbye World')

SELECT * FROM @TABLE 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-12T21:31:06.440

就我个人而言，我希望他们失败，然后查看数据。我认为您不应该考虑自动截断数据。您可能实际上需要使您的字段定义更大。除非您目视检查会失败的行，否则您不会知道。

示例：我们存储语音标题。假设您有两个标题：
如何阅读一本书：
如何在浴缸中阅读一本书而不弄湿它

现在，如果您的字段有 10 个字符，那么两者都会被截断为相同的内容。此外，他们被截断的内容甚至没有意义。两者都会说“如何阅读”现在您在两个非常不同的标题之间没有区别，而且您所拥有的内容也不正确。调整字段以存储更多的字符显然是正确的做法。这个例子很傻，但是垃圾进，垃圾出。如果你截断人名或其他关键数据，你最终会遇到问题，因为你有垃圾数据。我已经看到我们的演讲标题、姓氏、地址、电话号码和许多其他数据都会发生这种情况。如果您必须截断数据，则很可能无论如何您都在为该记录存储无用的数据。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-12T16:50:51.170

我不知道有比追踪它们并使用`LEFT()`. 不过，我很想知道是否有。

显然，使用像`INFORMATION_SCHEMA.COLUMNS`您这样的元数据可以自动确定这一点并编写脚本以执行`LEFT()`适当的长度。

# .net - 改进数据访问层选择方法 Pattern

> ID：436026
> 
> 赞同：8
> 
> 时间：2009-01-12T16:39:26.560
> 
> 标签：.net, .net-2.0, data-access-layer

最近我发现自己正在编写数据访问层选择方法，其中代码都采用这种一般形式：

```
public static DataTable GetSomeData( ... arguments)
{
    string sql = " ... sql string here:  often it's just a stored procedure name ... ";

    DataTable result = new DataTable();

    // GetOpenConnection() is a private method in the class: 
    // it manages the connection string and returns an open and ready connection
    using (SqlConnection cn = GetOpenConnection())
    using (SqlCommand cmd = new SqlCommand(sql, cn))
    {
        // could be any number of parameters, each with a different type
        cmd.Parameters.Add("@Param1", SqlDbType.VarChar, 50).Value = param1; //argument passed to function

        using (SqlDataReader rdr = cmd.ExecuteReader())
        {
            result.Load(rdr);
        }
    }

    return result;
} 
```

或者像这样：

```
public static DataRow GetSomeSingleRecord( ... arguments)
{
    string sql = " ... sql string here:  often it's just a stored procedure name ... ";

    DataTable dt = new DataTable();

    // GetOpenConnection() is a private method in the class: 
    // it manages the connection string and returns an open and ready connection
    using (SqlConnection cn = GetOpenConnection())
    using (SqlCommand cmd = new SqlCommand(sql, cn))
    {
        // could be any number of parameters, each with a different type
        cmd.Parameters.Add("@Param1", SqlDbType.VarChar, 50).Value = param1; //argument passed to function

        using (SqlDataReader rdr = cmd.ExecuteReader(CommandBehavior.SingleRow))
        {
            dt.Load(rdr);
        }
    }

    if (dt.Rows.Count > 0)
         return dt.Rows[0];
    return null;
} 
```

这些方法将由业务层代码调用，然后将基本 DataTable 或 DataRecord 转换为表示层可以使用的强类型业务对象。

由于我反复使用类似的代码，我想确保这个代码是最好的。那么如何改进呢？而且，是否值得尝试将通用代码从这里移到它自己的方法中。如果是这样，该方法会是什么样子（特别是关于传入 SqlParameter 集合）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-12T18:15:51.957

必须添加我自己的：
[在 Using 语句中从 DataLayer 返回 DataReader](https://stackoverflow.com/questions/850065/return-datareader-from-datalayer-in-using-statement)

新模式使我一次只能在内存中拥有一条记录，但仍将连接包含在一个不错的“使用”语句中：

```
public IEnumerable<T> GetSomeData(string filter, Func<IDataRecord, T> factory)
{
    string sql = "SELECT * FROM [SomeTable] WHERE SomeColumn= @Filter";

    using (SqlConnection cn = new SqlConnection(GetConnectionString()))
    using (SqlCommand cmd = new SqlCommand(sql, cn))
    {
        cmd.Parameters.Add("@Filter", SqlDbType.NVarChar, 255).Value = filter;
        cn.Open();

        using (IDataReader rdr = cmd.ExecuteReader())
        {
            while (rdr.Read())
            {
                yield return factory(rdr);
            }
            rdr.Close();
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-12T16:52:41.993

就客户端代码而言，我喜欢的一种模式如下所示：

```
 DataTable data = null;
        using (StoredProcedure proc = new StoredProcedure("MyProcName","[Connection]"))
        {
            proc.AddParameter("@LoginName", loginName);
            data = proc.ExecuteDataTable();
        } 
```

我通常将连接设为可选，并且我会以某种方式进行编码，以便从 ConnectionStrings 配置部分中提取它或将其视为实际的连接字符串。这让我可以在一个场景中重用 dal，并且在某种程度上是 COM+ 时代的习惯，当时我使用对象构造属性存储连接字符串。

我喜欢这个，因为它易于阅读并且对我隐藏了所有 ADO 代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-14T08:12:52.317

类似于我在[这里发布的内容](https://stackoverflow.com/a/14869748/661933)

```
public IEnumerable<S> Get<S>(string query, Action<IDbCommand> parameterizer, 
                             Func<IDataRecord, S> selector)
{
    using (var conn = new T()) //your connection object
    {
        using (var cmd = conn.CreateCommand())
        {
            if (parameterizer != null)
                parameterizer(cmd);
            cmd.CommandText = query;
            cmd.Connection.ConnectionString = _connectionString;
            cmd.Connection.Open();
            using (var r = cmd.ExecuteReader())
                while (r.Read())
                    yield return selector(r);
        }
    }
} 
```

我有这些简单的扩展方法来帮助调用：

```
public static void Parameterize(this IDbCommand command, string name, object value)
{
    var parameter = command.CreateParameter();
    parameter.ParameterName = name;
    parameter.Value = value;
    command.Parameters.Add(parameter);
}

public static T To<T>(this IDataRecord dr, int index, T defaultValue = default(T),
                      Func<object, T> converter = null)
{
    return dr[index].To<T>(defaultValue, converter);
}

static T To<T>(this object obj, T defaultValue, Func<object, T> converter)
{
    if (obj.IsNull())
        return defaultValue;

    return converter == null ? (T)obj : converter(obj);
}

public static bool IsNull<T>(this T obj) where T : class
{
    return (object)obj == null || obj == DBNull.Value;
} 
```

所以现在我可以打电话了：

```
var query = Get(sql, cmd =>
{
    cmd.Parameterize("saved", 1);
    cmd.Parameterize("name", "abel");
}, r => new User(r.To<int>(0), r.To<string>(1), r.To<DateTime?>(2), r.To<bool>(3)));
foreach (var user in query)
{

} 
```

这是完全通用的，适合任何符合 ado.net 接口的模型。[连接对象和阅读器仅在集合被枚举一次后才被释放。](https://stackoverflow.com/q/1405877/661933)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-12T16:52:19.013

唯一不同的是我从自己的内部数据库帮助器方法切换到实际的数据访问应用程序块[http://msdn.microsoft.com/en-us/library/cc309504.aspx](http://msdn.microsoft.com/en-us/library/cc309504.aspx)

让其他了解企业库的开发人员在代码上更加标准化/统一。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-12T17:13:55.210

有很多方法可以实现 DBAL，在我看来，您走在正确的道路上。在您的实施中需要考虑的事项：

*   您正在使用类似工厂的方法来创建 SqlConnection，这是一个小问题，但您可以对 SqlCommand 执行相同的操作。
*   参数长度是可选的，因此您实际上可以将其排除在 Parameter.Add 调用之外。
*   创建添加参数的方法，代码示例如下。

使用添加参数`DbUtil.AddParameter(cmd, "@Id", SqlDbType.UniqueIdentifier, Id);`

```
internal class DbUtil {

internal static SqlParameter CreateSqlParameter(
    string parameterName,
    SqlDbType dbType,
    ParameterDirection direction,
    object value
) {
    SqlParameter parameter = new SqlParameter(parameterName, dbType);

    if (value == null) {
        value = DBNull.Value;
    }

    parameter.Value = value;

    parameter.Direction = direction;
    return parameter;
}

internal static SqlParameter AddParameter(
    SqlCommand sqlCommand,
    string parameterName,
    SqlDbType dbType
) {
    return AddParameter(sqlCommand, parameterName, dbType, null);
}

internal static SqlParameter AddParameter(
    SqlCommand sqlCommand,
    string parameterName,
    SqlDbType dbType,
    object value
) {
    return AddParameter(sqlCommand, parameterName, dbType, ParameterDirection.Input, value);
}

internal static SqlParameter AddParameter(
    SqlCommand sqlCommand,
    string parameterName,
    SqlDbType dbType,
    ParameterDirection direction,
    object value
) {
    SqlParameter parameter = CreateSqlParameter(parameterName, dbType, direction, value);
    sqlCommand.Parameters.Add(parameter);
    return parameter;
    }
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-14T22:45:19.003

首先，我认为您已经考虑过使用 ORM 与自己滚动。我不会进入这个。

我对滚动自己的数据访问代码的想法：

*   随着时间的推移，我发现不使用单独的 DAL/BL 对象更容易，而是将它们合并为一个对象（在得出这个结论后的一段时间后，我发现这是一个众所周知的模式 - 即 ActiveRecord）。拥有单独的 DAL 程序集可能看起来不错且解耦，但维护成本的开销会增加。每次添加新功能时，您都必须创建更多代码/修改更多类。根据我的经验，维护应用程序的团队通常比构建它的原始开发团队少得多，而且他们会讨厌所需的额外工作。
*   对于大型团队来说，将 DAL 分开可能是有意义的（让一个小组在其他人的时候处理它。但这对代码膨胀来说是一个很好的激励。
*   归结为您的具体示例：您如何使用生成的 DataTable？迭代行、创建类型对象并从行中获取数据？如果答案是肯定的，请考虑为在 DAL 和 BL 之间移动数据而创建的额外 DataTable。为什么不直接从 DataReader 中获取呢？
*   另外关于示例：如果您返回一个无类型的 DataTable，那么我想您必须在调用代码中使用列名（SP 调用返回的结果集）。这意味着如果我必须更改数据库中的某些内容，它可能会影响两个层。

我的建议（我尝试了这两种方法 - 该建议是我提出的最新工作方法 - 它随着时间的推移而演变）。

*   为您的类型化业务对象创建一个基类。
*   在基类中保持对象状态（新的、修改的等）
*   把主要的数据访问方法放在这个类中，作为静态方法。稍加努力（提示：泛型方法 + Activator.CreateInstance），您可以为读取器中返回的每一行创建一个业务对象。
*   在业务对象中创建一个抽象方法来解析行数据（直接来自 DataReader！）并填充对象。
*   在派生业务对象中创建静态方法，这些方法准备存储的过程参数（取决于各种过滤条件）并从基类调用通用数据访问方法。

目的是最终得到以下用途：

```
List<MyObject> objects = MyObject.FindMyObject(string someParam); 
```

对我的好处是我只需要更改一个文件即可应对数据库列名、类型等的更改（通常是小的更改）。使用一些经过深思熟虑的区域，您可以组织代码，以便它们在同一个对象中成为单独的“层”:)。另一个好处是基类确实可以从一个项目重用到另一个项目。而且代码膨胀很小（好吧，与好处相比。您还可以填充数据集并将它们绑定到 UI 控件：D

限制 - 每个域对象（通常每个主数据库表）都有一个类。而且您不能在现有事务中加载对象（尽管您可以考虑传递事务，如果有的话）。

如果您对更多细节感兴趣，请告诉我 - 我可以稍微扩展一下答案。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2017-09-10T06:21:15.830

**最简单的解决方案：**

```
var dt=new DataTable();
dt.Load(myDataReader);
list<DataRow> dr=dt.AsEnumerable().ToList(); 
```

# linq-to-sql - linq to sql 案例查询

> ID：436028
> 
> 赞同：1
> 
> 时间：2009-01-12T16:39:34.873
> 
> 标签：linq-to-sql, expression, case

我在 C# 中使用 linq to sql 数据查询表达式构建查询时遇到问题。

我最终要做的就是基于这个伪代码表达式。

```
public IQueryable<CTest> searchRecords(string category, string searchString, DateTime startDate, DateTime endDate, int searchType, int searchType2)
        {
            //-Search All Records
            //-From the information table
            //-By the category column containing a specific search
            //-Also by
            //  ~if both a startDate and endDate are entered (not (0000,00,00) OR null) then get records
            //  by this expression
            //  ~else then don't worry about this statement
            //-Also by
            //  ~if a searchType is equal zero(0) then search for records from the 
            //  search_type table equal to zero(0)
            //  ~if a searchType is equal one(1) then search for records from the 
            //  search_type table equal to one(1)
            //  ~else then don't worry about this statement
            //-Also by
            //  ~if a searchType2 is equal zero(0) then search for records from the 
            //  search_type table equal to zero(0)
            //  ~if a searchType2 is equal one(1) then search for records from the 
            //  search_type table equal to one(1)
            //  ~else then don't worry about this statement

            //Here is my attempt at it
            /*  
                var table = db.table1;

                switch (category)
                {
                case "_category1":
                    var records =
                        from c in table
                        where c.column1.ToString().Contains(searchString)
                        select new CTest
                        {
                            test_id = c.id,
                            test_name = c.name,
                            test_number = c.number,
                            date = ((startDate != null) && (endDate != null)) ? ((c.test_date >= startDate) && (c.test_date <= endDate)) :
                                         c.test_date),
                            test_type = (searchType == 0 ? (c.searchType = 0) :
                                        searchType == 1 ? (c.searchType = 1) :
                                        c.searchType),
                            test_type2 = (searchType2 == 0 ? (c.searchType2 = 0) :
                                        searchType2 == 1 ? (c.searchType2 = 1) :
                                        c.searchType2)
                        };
                    break;
                default:
                    break;
                }
             */
        } 
```

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-12T16:52:57.233

使用扩展方法比使用 LINQ 语法更容易做到这一点：

```
 var records = context.Table
                      .Where( c => c.column1.Contains( searchString ) );
 if (startDate != null && endDate != null)
 {
     records = records.Where( c => c.test_date >= startDate
                                    && c.test_date <= endDate );
 }

 ... 
```

这将在您进行时构建 LINQ 表达式。评估会延迟，直到您实际调用需要执行选择的扩展，如 Count() 或 ToList()，或枚举结果的元素。

# php - PHP：无法发送会话 cookie 错误

> ID：436034
> 
> 赞同：4
> 
> 时间：2009-01-12T16:40:36.977
> 
> 标签：php, session

我试图建立一个会话并且我得到一个标题错误，尽管我可以告诉我在发送标题之前告诉它开始会话。这里的任何帮助都会很有用。

```
<?php
ob_start();
session_start();
$_SESSION['active'] = 1;
ob_end_flush();
?>
<html>
<body>
2009c Christ Redeemer Catholic Church 
</body>
</html> 
```

警告：session_start() [function.session-start]：无法发送会话 cookie - 标头已由（输出开始于 /home/content/k/u/r/kuriomister/html/temp/church/index.php:1 ) 在第 3 行的 /home/content/k/u/r/kuriomister/html/temp/church/index.php

警告：session_start() [function.session-start]：无法发送会话缓存限制器 - 标头已发送（输出开始于 /home/content/k/u/r/kuriomister/html/temp/church/index.php:1 ) 在第 3 行的 /home/content/k/u/r/kuriomister/html/temp/church/index.php

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-12T16:47:47.743

如果您使用 UTF-8，请务必保存不带[BOM](http://en.wikipedia.org/wiki/Byte-order_mark)的文件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-12T16:47:17.603

查看输出：`Cannot send session cookie - headers already sent by (output started at /home/content/k/u/r/kuriomister/html/temp/church/index.php:1)`. 您似乎在文件的开头有一些空格（空格、制表符、换行符......）。

# java - Java 是否具有与 C# 类似的对事件的本机支持？

> ID：436050
> 
> 赞同：10
> 
> 时间：2009-01-12T16:46:08.043
> 
> 标签：java, events

我听说 Java 不做事件有点困惑。

但我知道它会执行 GUI 事件。

我错过了什么吗？java有事件处理机制吗？

我知道我可以实现发布者订阅者模式，但我正在寻找 Java 中的本机支持。

我似乎记得一些关于 Java 在 Java 5 或 6 中添加事件的信息，但我不记得我在哪里听到的，我可能正在编造它。

基本上，我将设备包装在设备引发事件的 java 类中，并且我正在寻找最合乎逻辑的方式来公开它。我主要来自 .Net 背景，我正在寻找类似 .Net (C#) 中的事件

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-12T16:49:42.420

正如你已经说过的，你可以用发布者-订阅者/观察者模式做同样的事情。它只是需要更多的跑腿。

不，Java 没有对事件的本机支持，就像 C# 对委托一样。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-12T18:56:50.383

这里别人提出的订阅/发布机制可以让你实现**同步**事件。对于异步事件循环（即发即弃），您可能需要查看“参与者”。An`Actor<A>`由 A 类型的消息（事件）的处理程序以及用于执行处理程序的线程策略组成。这使您可以进行并发、异步事件处理，如下所示：

```
public class EventExample {
  public static void main(String[] args) {
    while ((char c = System.in.read()) >= 0) {
      eventHandler.act(c);
    }
  }

  public static Actor<Character> eventHandler =
    Actor.actor(Strategy.simpleThreadStrategy(), new Effect<Character>() {
      public void e(Character c) {
        // Do something with c here.
      }
    });
} 
```

[在这里获取演员库。](http://functionaljava.org) [请参阅此处的 Javadoc。](http://functionaljava.googlecode.com/svn/artifacts/2.17/javadoc/fj/control/parallel/package-summary.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-12T16:50:09.923

根据我对 Java 的记忆（超过 6 个月没有使用它），我认为没有 .NET 事件。您最好的选择可能是使用发布者/订阅者模式。它很容易实现并且非常可靠。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-07-28T21:34:49.967

这是[一篇](http://www.enterpriseintegrationpatterns.com/ramblings/14_edainjvm.html)关于该主题的文章，另请参阅[Java 的哪个 Actor 模型库/框架？](https://stackoverflow.com/questions/3357332/which-actor-model-library-framework-for-java/3357726#3357726)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-12T16:50:31.187

Swing 或 AWT，它们是 Java UI 工具包，都处理事件 - 查看[官方 Swing 事件教程](http://java.sun.com/docs/books/tutorial/uiswing/events/index.html)以获取示例。当然，您需要在 Swing 中编写 UI 才能为这些事件注册侦听器。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-12T17:15:20.637

我不了解 C#，但不是 UI 组件的 Java Beans 当然可以使用事件通知侦听器状态更改：

[http://java.sun.com/developer/onlineTraining/Beans/beans02/](http://java.sun.com/developer/onlineTraining/Beans/beans02/)

自 Java Beans 规范首次出现以来，这一直是它的一部分。请注意教程上的日期：它是 2000 年的年份。

源和侦听器必须在同一个 JVM 中运行。您必须使用代理与在另一个 JVM 中运行的东西进行通信，但这是可以做到的。

我在 Google 上搜索了 C# 事件教程并找到[了这个](http://msdn.microsoft.com/en-us/library/aa645739(VS.71).aspx). Java 的侦听器注册和属性更改事件的触发让人想起我在浏览 C# 教程时看到的内容。我错过了什么重要的事情吗？（我承认我没有深入阅读 - 现在没有时间。）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-12T17:19:14.717

Java 没有原生支持——你必须实现[观察者模式](http://en.wikipedia.org/wiki/Observer_pattern#Java)（又名订阅/发布）。它非常简单 - 不超过十几行代码。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-12T23:08:28.333

您可能还想查看开源[EventBus](https://eventbus.dev.java.net/)库，与标准发布者/订阅者模式相反，它使用中介类（事件总线）来减少发布者/订阅者模式（订阅者必须了解所有发布者才能向他们注册，这并不总是可行的，而且通常很麻烦）。

我在 GUI 应用程序中使用过它，但它可以处理任何类型的事件。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-08-02T16:45:42.713

java.util. **可观察**的@since JDK1.0

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-01-12T16:50:07.490

你需要线程。java中的GUI有事件，因为有一个专门的线程来调度UI事件。还有一些叫做“Observer”和“Observable”的东西（这是来自GUI东西的事件监听器的口味中性版本）但只是设计模式......

# java - 根据访问者类型提供不同用户体验的好方法是什么？

> ID：436059
> 
> 赞同：1
> 
> 时间：2009-01-12T16:47:34.357
> 
> 标签：java

我正在寻找一种方法来允许 Web 应用程序根据访问者的类型提供不同的用户体验。例如，同一组数据应该以不同的方式呈现给儿童和成人。这适用于 Java Web 应用程序。

只是想提供更多说明。我希望的是处理所有方面的任何最佳实践，以便为不同类型的访问者提供不同的用户体验（检测访问者的类型、不同的视图呈现、不同的导航）。我的数据是分层的，并且遍历该数据对于不同类型的访问者很可能是不同的。我有能力提出一个本土解决方案，但我会对任何使其更易于实施和维护的样板解决方案或框架感兴趣。有问题的应用程序是一个使用 Struts/Tiles 1.x 的 Java 应用程序。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-12T16:53:10.727

对于儿童和成人，您可以只使用不同的颜色主题（更多的亮色和粉彩、更厚实的纽扣等）。

您还可以更改布局。

这些更改都可以通过 CSS 完成，并根据您接收的访问者类型切换项目的 CSS 类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T16:56:17.647

这在很大程度上取决于您拥有多少关于用户的信息。

如果他们没有登录到某种帐户，那么你真的没有明确的线索。

如果他们有一个帐户，并且您有一个字段，那么有几个选项。

一种是让页面检查用户类型，并针对不同的用户类型重定向到相应的页面。

另一种方法是让页面上的各个组件在呈现之前检查用户类型，并基于此进行不同的呈现。这真的取决于体验应该有多么不同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-12T16:58:16.553

首先，您需要某种方法来识别访问者的类型 - 大概您会通过让他们在某个阶段填写表格、勾选框等来做到这一点，然后您设置一个可以回读的持久 cookie在以后的请求中检测用户所在的段。

然后，您可以使用一些在页面加载时运行的 javascript 从 cookie 中读回访问者类型，并适当地设置 CSS。如果你给你的 <style> 标签一个 id 属性，运行一些 javascript 来做类似的事情：

```
document.getElementById('cssElemId').href = 'childMain.css'; 
```

会做你想做的。您当然可以在同一个条件下更改多个 CSS 标记，并修饰从 cookie 值到 CSS 文件的映射，但这是核心功能。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-12T16:59:40.637

儿童和成人对信息的看法不同。如果您可以在图像和文本中显示您的信息，则儿童将被吸引到图像而不是文本，而成年人将同时阅读文本和图像。

我会为更多颜色的儿童推荐更多图片（如前所述）。

成人应该有更多的文字，字体要易于阅读。

# javascript - 动态更新 RSS 提要 URL

> ID：436064
> 
> 赞同：0
> 
> 时间：2009-01-12T16:47:52.330
> 
> 标签：javascript, html, rss

是否可以通过 JavaScript 动态地在页面标题中实例化提要的 URL？

例如，是否可以在以下代码段中更新 rss 提要的 URL：

```
<html>
  <head>
    <link rel="alternate" title="Feed" href="/rss.feed" type="application/rss+xml">
  </head>
  <body>
    ...
  </body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-12T16:52:06.253

我想你可以这样做：

```
<script type="text/javascript">
linkCol = document.getElementsByTagName("link");
for(i = 0; i < linkCol.length; i++) {
    if(linkCol[i].title == "Feed") {
        linkCol[i].href = "NEW HREF";
    }
}
</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T16:52:41.477

尝试以下操作：

```
document.getElementsByTagName("link")[0].href = "http://example.com/"; 
```

如果它不是第一个也是唯一的`link`元素，则必须先查找它，例如：

```
var linkElems = document.getElementsByTagName("link");
for (var i in linkElems) {
    if (linkElems[i].href === "/rss.feed") {
        linkElems[i].href = "http://example.com/";
        break;
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-12T17:31:15.003

我很确定大多数浏览器不会看到这种变化。但我很想被证明是错误的。

# c# - 谷歌分析和母版页/用户控制交换

> ID：436072
> 
> 赞同：3
> 
> 时间：2009-01-12T16:50:00.483
> 
> 标签：c#, asp.net, master-pages, google-analytics

我在我的网站上使用 GA，需要向多个页面添加跟踪。这些页面通过母版页与 Telerik 选项卡控件一起呈现。选择选项卡时，代码会评估单击了哪个选项卡，并为该页面插入适当的用户控件并重新呈现它。根据浏览器，它始终是 default.aspx，但其中的 ascx 不同。

我如何使用这种设置跟踪不同的页面？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T13:59:32.190

你可以试试这样的...

1.  确保在完全呈现页面的末尾触发谷歌分析跟踪
2.  让 ASCX 设置一个全局“page_name”变量（我想这应该在您的主视图中的某处初始化），并使用一些唯一名称让您知道 ascx 是什么
3.  使用允许您提供页面名称的谷歌分析跟踪重载之一（我没有方便的示例，但您应该能够轻松找到一个）。使用全局“page_name”变量作为页面名称

这不是最干净最合适的解决方案，但 WebForms 通常可以规定不太漂亮的解决方案……这将是我能想到的最简单、最容易实现的更改。

# c# - 作为一个新手，在学习C#之前有什么需要注意的吗？

> ID：436079
> 
> 赞同：6
> 
> 时间：2009-01-12T16:51:48.827
> 
> 标签：c#

我有两个专业的程序员朋友要教我，他们都喜欢这门语言（C#）。我知道他们的特殊技能和热情超过了语言的任何缺点，但他们看起来像这样的粉丝，我不知道有什么问题。

我只有 XHTML 和 CSS 的经验，所以接受我的头脑以了解面向对象将是一个挑战，例如。我隐约知道某些语言（python？）允许您单独测试小部分，这对初学者特别有用。我担心我会在直奔 C# 之前尝试跑步。

很抱歉，这是一个有点漫无边际的问题，但我们将不胜感激。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-12T16:58:37.130

在你接触面向对象的概念之前，你会学到很多东西。如果您只知道 HTML 和 CSS，那么您将在接触对象之前学习所有基础知识。出于这个原因，C# 是一个不错的选择，因为它有一个很棒的 IDE，而且 IMO 对初学者来说非常容易。至于测试小代码片段，这在 Visual Studio 中同样简单，您将编写很多很多控制台应用程序，您可以在这些应用程序中测试非常小的代码片段，甚至可以在进行任何 WinForms 开发之前进行测试。我说不错的选择。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-12T16:56:44.480

你必须从某个地方开始，我会去的。不过，我也会为初学者买一本 C# 书。有经验的开发人员通常会“忘记”开始时的感觉，并可能会“冲”到你没有做好准备的事情上。

如果他们不是经验丰富的开发人员，那么**真的**买书，没有书就是盲人带盲人的案例，他们会教你坏习惯。

所以 。. .

*   买一本书
*   围绕本书构建你的学习
*   *在您阅读本书的过程中，*接受您的朋友提供的所有帮助和建议。

自从我还是初学者以来，已经有一段时间了，有人对初学者的 C# 书有任何建议吗？

PS我有没有提到我认为你应该买一本书？

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-12T16:54:40.740

锻炼你的右手小指，让它更灵巧。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-01-12T16:59:23.570

问题是，就技能水平而言，您将需要在学习中级语言的同时学习 OOP。对于初学者来说，OOP 比任何语言都更重要，也更难掌握（也就是说，如果你正在学习一种 OOP 语言…….NET 是……）

老实说，C# 本身并不是一门难学的语言。这可能需要一些时间，但请记住，了解该语言不会使您成为程序员。您将需要知道如何编程才能到达那里，这就是您所指的问题。希望你的朋友也会教你面向对象的基础知识。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-12T17:24:14.330

我认为 C# 最大的收获是 .Net 和大量现有库（不确定这是否会转化为 Mono）。你几乎肯定会自己实现框架中已经存在的东西。

我建议同时运行 FxCop 以确保您以“推荐”的方式做事。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-12T18:30:32.233

您应该注意，您可能不仅在学习 C#，而且还在学习 .NET 框架（非常庞大），因此请记住这一点。

我也同意你应该买一本书。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-12T16:54:12.940

一切都是[对象](http://msdn.microsoft.com/en-us/library/system.object.aspx)......

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-12T16:57:47.020

[C#](http://en.wikipedia.org/wiki/C_Sharp_%28programming_language%29)正在快速发展。越早开始，掌握的越多。建议您具备一些[OOP](http://en.wikipedia.org/wiki/Object-oriented_programming)背景，但实践会引导您实现目标。

只是一个警告：一旦你开始，你可能永远不想停止。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-01-12T17:00:02.553

C# 是一种现代的高级语言；我会说这是一个很好的起点。您将在 C 或 C++ 中处理的许多较低级别的东西在 C# 和 .NET 中被抽象出来，因此学习面向对象编程或设计模式之类的东西不会那么难。这些东西是当今编程中的重要概念，因此在您学习循环、控制结构等基础知识时，最好能接触到它们。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-01-12T17:16:11.023

C# 不是我通常推荐的初学者语言，但你可以做得更糟，如果你手头有热心的助手，我说去吧。

我认为您不必为 OO 担心太多。一个完整的初学者比那些“熟读”非 OO 概念几年的人更有可能快速“获得”OO。

如果/当您以后尝试学习其他范式时，您更有可能遇到困难-但这是我们最终都必须跨越的桥梁。

我建议您尽早接受单元测试。也许您的朋友可以帮助您设置 NUnit。它不仅是一个好习惯（有经验的程序员难以养成的习惯），而且它是最接近探索性编程的东西（“单独测试小部分”），你会在像 C# 这样的语言中获得。

你绝对应该得到一本好书。一旦你读完这本书，完成了一些项目并感觉自己变得舒服，也强迫自己学习另一种语言：也许是脚本语言。这将帮助您了解您所知道的哪些部分是通用编程技能，哪些是 C# 独有的。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-01-12T17:18:29.350

我可以给你的一个建议是你应该学习哪个版本的 C#。

有 1.0、1.1、2.0、3.0 和未来的 4.0 版本。你想学的版本肯定是C# 2.0。它添加了真正必要的功能，并修复了 1.1 的一些您甚至不想知道的问题。

你不想从 3.0 开始，因为它添加了很多东西，很酷，但只会让你感到困惑。

从 2.0 开始，然后逐步升级到 3.0。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-01-12T20:02:25.540

> 只有 XHTML 和 CSS 的经验，所以接受我的头脑中的面向对象将是一个挑战

请注意，CSS 和 XHTML 甚至都不是“真正的”编程。

有很多你从未听说过的概念。从本质上讲，您是一个完全 100% 的编程初学者。

我认为 C# 是一种很好的学习语言。在你学会它之后，如果你想真正挑战自己并理解较低级别的编程，我建议你学习（折磨自己）C/C++。在那里，您将了解更多关于幕后发生的事情。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-01-12T16:57:34.243

您想知道它不直接与操作系统交互，并且它需要 .Net 框架才能运行。因此，如果有人想使用您的应用程序，他们将不得不安装 .Net 框架。这并没有听起来那么大的缺点，而且我也是一个 C# 粉丝。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-01-12T17:16:28.217

我推荐 Head First 系列：[Amazon.com](https://rads.stackoverflow.com/amzn/click/com/0596514824)上提供的[Head First C#](http://headfirstlabs.com/books/hfcsharp/)。他们在解释面向对象 (OO) 原则方面做得很好，但您也可能想查看专门的 (OO) 书籍。Head First 还制作了一本不错的 OO 设计书籍：Amazon.com 上[的 Head First Object-Oriented Analysis and](http://www.headfirstlabs.com/books/hfooad/) [Design](https://rads.stackoverflow.com/amzn/click/com/0596008678)。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-01-12T16:56:00.020

你想在你能走路之前跑。如果您来自另一种语言，例如 Java 或 Rails，那么很容易指出两者之间的细微差别，例如“Java 允许 ??? 而 C# 不允许”。由于您不这样做，C# 是一个很好的起点，并且似乎有一个很有前途的社区围绕它。它正在发展成为一流的语言。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-01-12T18:33:13.833

获取一本“循序渐进”风格的书，并在 IDE 中遵循它。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-01-13T17:29:23.260

老实说，我认为您最好还是玩一会儿 Javascript（几周）。只是为了获得流控制、分配等的基础知识，它不那么麻烦（不需要 IDE）、宽容并且可以很容易地与你已经拥有的技能联系起来。

不过，C# 是一门很棒的语言，所以一旦你接近 OOP 之类的东西，就可以转移过来。

# wcf - .net 项目可以发现和使用 WCF 服务吗？

> ID：436083
> 
> 赞同：2
> 
> 时间：2009-01-12T16:52:32.897
> 
> 标签：wcf, .net-2.0, wcf-binding

我在 IIS 中创建了一个基本的 WCF 服务。我知道这应该在 .net 3.0 和 .net 3.5 中开发。我的问题是这个。运行 .net 2.0 的客户端可以访问和使用 WCF 服务吗？

干杯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-12T20:31:23.797

[是的，如果服务使用basicHttpBinding](http://basicHttpBinding)公开 endoint 。虽然有一些[*问题*](http://blogs.msdn.com/eugeneos/archive/2007/02/05/solving-the-disappearing-data-issue-when-using-add-web-reference-or-wsdl-exe-with-wcf-services.aspx)你应该注意。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T15:38:55.090

正如darin所说，只有当您的wcf使用basicHttpBinding公开时，您才能从2.0访问该服务。此绑定将公开与旧 ASMX 服务相同的**WS-BasicProfile 1.1**兼容的 SOAP 。

# javascript - 从原型定义的函数访问私有成员变量

> ID：436120
> 
> 赞同：194
> 
> 时间：2009-01-12T16:59:59.043
> 
> 标签：javascript, private-members

有没有办法让原型定义的方法可以使用“私有”变量（在构造函数中定义的变量）？

```
TestClass = function(){
    var privateField = "hello";
    this.nonProtoHello = function(){alert(privateField)};
};
TestClass.prototype.prototypeHello = function(){alert(privateField)}; 
```

这有效：

```
t.nonProtoHello() 
```

但这不会：

```
t.prototypeHello() 
```

我习惯于在构造函数中定义我的方法，但由于几个原因而不再使用它。

* * *

## 回答 #1

> 赞同：200
> 
> 时间：2009-01-12T17:08:30.230

不，没有办法做到这一点。这基本上是相反的范围界定。

在构造函数中定义的方法可以访问私有变量，因为所有函数都可以访问定义它们的范围。

在原型上定义的方法未定义在构造函数的范围内，并且无法访问构造函数的局部变量。

您仍然可以拥有私有变量，但如果您希望原型上定义的方法可以访问它们，您应该在`this`对象上定义 getter 和 setter，原型方法（以及其他所有内容）*都*可以访问它们。例如：

```
function Person(name, secret) {
    // public
    this.name = name;

    // private
    var secret = secret;

    // public methods have access to private members
    this.setSecret = function(s) {
        secret = s;
    }

    this.getSecret = function() {
        return secret;
    }
}

// Must use getters/setters 
Person.prototype.spillSecret = function() { alert(this.getSecret()); }; 
```

* * *

## 回答 #2

> 赞同：65
> 
> 时间：2014-02-03T08:34:19.033

# 更新：使用 ES6，有一个更好的方法：

长话短说，您可以使用 new`Symbol`创建私有字段。
这是一个很好的描述：[https ://curiosity-driven.org/private-properties-in-javascript](https://curiosity-driven.org/private-properties-in-javascript)

例子：

```
var Person = (function() {
    // Only Person can access nameSymbol
    var nameSymbol = Symbol('name');

    function Person(name) {
        this[nameSymbol] = name;
    }

    Person.prototype.getName = function() {
        return this[nameSymbol];
    };

    return Person;
}()); 
```

# 对于所有使用 ES5 的现代浏览器：

### 你可以只使用闭包

构造对象的最简单方法是完全避免原型继承。只需在闭包中定义私有变量和公共函数，所有公共方法都可以私有访问这些变量。

### 或者你可以只使用原型

在 JavaScript 中，原型继承主要是*一种优化*。它允许多个实例共享原型方法，而不是每个实例都有自己的方法。
缺点是每次调用原型函数时唯一不同的`this`是**。**
因此，任何私有字段都必须可以通过 访问`this`，这意味着它们将是公开的。所以我们只坚持`_private`字段的命名约定。

### 不要费心将闭包与原型混为一谈

我认为您**不应该**将闭包变量与原型方法混合使用。您应该使用其中一种。

当您使用闭包访问私有变量时，原型方法无法访问该变量。因此，您必须将闭包公开到 上`this`，这意味着您以一种或另一种方式公开公开它。这种方法几乎没有什么好处。

### 我选择哪个？

对于非常简单的对象，只需使用带有闭包的普通对象。

如果您需要原型继承——用于继承、性能等——然后坚持使用“_private”命名约定，不要为闭包而烦恼。

我不明白为什么 JS 开发人员如此努力地使字段真正私有。

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2012-12-13T09:31:04.837

当我读到这篇文章时，这听起来像是一个艰巨的挑战，所以我决定想办法。我想出的是**CRAAAAZY**，但它完全有效。

首先，我尝试在即时函数中定义类，这样您就可以访问该函数的一些私有属性。这很有效，并且允许您获取一些私有数据，但是，如果您尝试设置私有数据，您很快就会发现所有对象都将共享相同的值。

```
var SharedPrivateClass = (function() { // use immediate function
    // our private data
    var private = "Default";

    // create the constructor
    function SharedPrivateClass() {}

    // add to the prototype
    SharedPrivateClass.prototype.getPrivate = function() {
        // It has access to private vars from the immediate function!
        return private;
    };

    SharedPrivateClass.prototype.setPrivate = function(value) {
        private = value;
    };

    return SharedPrivateClass;
})();

var a = new SharedPrivateClass();
console.log("a:", a.getPrivate()); // "a: Default"

var b = new SharedPrivateClass();
console.log("b:", b.getPrivate()); // "b: Default"

a.setPrivate("foo"); // a Sets private to "foo"
console.log("a:", a.getPrivate()); // "a: foo"
console.log("b:", b.getPrivate()); // oh no, b.getPrivate() is "foo"!

console.log(a.hasOwnProperty("getPrivate")); // false. belongs to the prototype
console.log(a.private); // undefined

// getPrivate() is only created once and instanceof still works
console.log(a.getPrivate === b.getPrivate);
console.log(a instanceof SharedPrivateClass);
console.log(b instanceof SharedPrivateClass);
```

在很多情况下，如果您想要在实例之间共享事件名称等常量值，这将是足够的。但本质上，它们就像私有静态变量一样。

如果您绝对需要从原型上定义的方法中访问私有命名空间中的变量，您可以尝试这种模式。

```
var PrivateNamespaceClass = (function() { // immediate function
    var instance = 0, // counts the number of instances
        defaultName = "Default Name",  
        p = []; // an array of private objects

    // create the constructor
    function PrivateNamespaceClass() {
        // Increment the instance count and save it to the instance. 
        // This will become your key to your private space.
        this.i = instance++; 

        // Create a new object in the private space.
        p[this.i] = {};
        // Define properties or methods in the private space.
        p[this.i].name = defaultName;

        console.log("New instance " + this.i);        
    }

    PrivateNamespaceClass.prototype.getPrivateName = function() {
        // It has access to the private space and it's children!
        return p[this.i].name;
    };
    PrivateNamespaceClass.prototype.setPrivateName = function(value) {
        // Because you use the instance number assigned to the object (this.i)
        // as a key, the values set will not change in other instances.
        p[this.i].name = value;
        return "Set " + p[this.i].name;
    };

    return PrivateNamespaceClass;
})();

var a = new PrivateNamespaceClass();
console.log(a.getPrivateName()); // Default Name

var b = new PrivateNamespaceClass();
console.log(b.getPrivateName()); // Default Name

console.log(a.setPrivateName("A"));
console.log(b.setPrivateName("B"));
console.log(a.getPrivateName()); // A
console.log(b.getPrivateName()); // B

// private objects are not accessible outside the PrivateNamespaceClass function
console.log(a.p);

// the prototype functions are not re-created for each instance
// and instanceof still works
console.log(a.getPrivateName === b.getPrivateName);
console.log(a instanceof PrivateNamespaceClass);
console.log(b instanceof PrivateNamespaceClass);
```

我希望任何看到这种方式有错误的人提供一些反馈。

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2009-01-12T17:08:52.910

请参阅[Doug Crockford 的页面](http://www.crockford.com/javascript/private.html)。您必须使用可以访问私有变量范围的东西间接地做到这一点。

另一个例子：

```
Incrementer = function(init) {
  var counter = init || 0;  // "counter" is a private variable
  this._increment = function() { return counter++; }
  this._set = function(x) { counter = x; }
}
Incrementer.prototype.increment = function() { return this._increment(); }
Incrementer.prototype.set = function(x) { return this._set(x); } 
```

用例：

```
js>i = new Incrementer(100);
[object Object]
js>i.increment()
100
js>i.increment()
101
js>i.increment()
102
js>i.increment()
103
js>i.set(-44)
js>i.increment()
-44
js>i.increment()
-43
js>i.increment()
-42 
```

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2010-11-26T12:12:39.660

我建议将“在构造函数中分配原型”描述为 Javascript 反模式可能是一个好主意。想想看。这太冒险了。

在创建第二个对象（即 b）时，您实际上在做的是为使用该原型的所有对象重新定义该原型函数。这将有效地重置您示例中对象 a 的值。如果您想要一个共享变量并且碰巧预先创建了所有对象实例，它会起作用，但感觉太冒险了。

我在最近正在研究的一些 Javascript 中发现了一个错误，这是由于这种确切的反模式造成的。它试图在正在创建的特定对象上设置拖放处理程序，而是为所有实例执行此操作。不好。

Doug Crockford 的解决方案是最好的。

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2012-02-24T08:00:39.813

@凯

那是行不通的。如果你这样做

```
var t2 = new TestClass(); 
```

然后`t2.prototypeHello`将访问 t 的私人部分。

@AnglesCrimes

示例代码工作正常，但它实际上创建了一个由所有实例共享的“静态”私有成员。它可能不是 morgancodes 寻找的解决方案。

到目前为止，我还没有找到一种简单而干净的方法来做到这一点，而无需引入私有散列和额外的清理功能。可以在一定程度上模拟私有成员函数：

```
(function() {
    function Foo() { ... }
    Foo.prototype.bar = function() {
       privateFoo.call(this, blah);
    };
    function privateFoo(blah) { 
        // scoped to the instance by passing this to call 
    }

    window.Foo = Foo;
}()); 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2013-11-19T20:49:08.637

是的，这是可能的。PPF 设计模式正好解决了这个问题。

PPF 代表私有原型函数。基本 PPF 解决了这些问题：

1.  原型函数可以访问私有实例数据。
2.  原型函数可以私有化。

首先，只需：

1.  将您希望从原型函数访问的所有私有实例变量放在单独的数据容器中，并且
2.  将对数据容器的引用作为参数传递给所有原型函数。

就是这么简单。例如：

```
// Helper class to store private data.
function Data() {};

// Object constructor
function Point(x, y)
{
  // container for private vars: all private vars go here
  // we want x, y be changeable via methods only
  var data = new Data;
  data.x = x;
  data.y = y;

  ...
}

// Prototype functions now have access to private instance data
Point.prototype.getX = function(data)
{
  return data.x;
}

Point.prototype.getY = function(data)
{
  return data.y;
} 
```

...

在此处阅读完整的故事：

[PPF 设计模式](http://articles.edwardsoft.com/private-prototype-functions)

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2013-02-07T19:52:06.883

您实际上可以通过使用**访问器验证**来实现这一点：

```
(function(key, global) {
  // Creates a private data accessor function.
  function _(pData) {
    return function(aKey) {
      return aKey === key && pData;
    };
  }

  // Private data accessor verifier.  Verifies by making sure that the string
  // version of the function looks normal and that the toString function hasn't
  // been modified.  NOTE:  Verification can be duped if the rogue code replaces
  // Function.prototype.toString before this closure executes.
  function $(me) {
    if(me._ + '' == _asString && me._.toString === _toString) {
      return me._(key);
    }
  }
  var _asString = _({}) + '', _toString = _.toString;

  // Creates a Person class.
  var PersonPrototype = (global.Person = function(firstName, lastName) {
    this._ = _({
      firstName : firstName,
      lastName : lastName
    });
  }).prototype;
  PersonPrototype.getName = function() {
    var pData = $(this);
    return pData.firstName + ' ' + pData.lastName;
  };
  PersonPrototype.setFirstName = function(firstName) {
    var pData = $(this);
    pData.firstName = firstName;
    return this;
  };
  PersonPrototype.setLastName = function(lastName) {
    var pData = $(this);
    pData.lastName = lastName;
    return this;
  };
})({}, this);

var chris = new Person('Chris', 'West');
alert(chris.setFirstName('Christopher').setLastName('Webber').getName()); 
```

这个例子来自我关于[原型函数和私有数据](http://gotochriswest.com/blog/2013/04/01/javascript-prototypal-functions-and-private-data/)的帖子，在那里有更详细的解释。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2014-02-16T09:42:48.030

在当前的 JavaScript 中，我相当肯定*只有一种**方法*可以拥有**私有 state**，可以从**原型**函数访问，而无需添加任何**public**到. 答案是使用“弱地图”模式。*******`this`*******

 *******总结一下：`Person`该类有一个弱映射，其中键是 Person 的实例，值是用于私有存储的普通对象。

这是一个功能齐全的示例：（在[http://jsfiddle.net/ScottRippey/BLNVr/](http://jsfiddle.net/ScottRippey/BLNVr/)播放）

```
var Person = (function() {
    var _ = weakMap();
    // Now, _(this) returns an object, used for private storage.
    var Person = function(first, last) {
        // Assign private storage:
        _(this).firstName = first;
        _(this).lastName = last;
    }
    Person.prototype = {
        fullName: function() {
            // Retrieve private storage:
            return _(this).firstName + _(this).lastName;
        },
        firstName: function() {
            return _(this).firstName;
        },
        destroy: function() {
            // Free up the private storage:
            _(this, true);
        }
    };
    return Person;
})();

function weakMap() {
    var instances=[], values=[];
    return function(instance, destroy) {
        var index = instances.indexOf(instance);
        if (destroy) {
            // Delete the private state:
            instances.splice(index, 1);
            return values.splice(index, 1)[0];
        } else if (index === -1) {
            // Create the private state:
            instances.push(instance);
            values.push({});
            return values[values.length - 1];
        } else {
            // Return the private state:
            return values[index];
        }
    };
} 
```

就像我说的，这确实是实现所有 3 个部分的唯一方法。

但是，有两个警告。首先，这会降低性能——每次访问私有数据时，都是一次`O(n)`操作，`n`实例的数量在哪里。因此，如果您有大量实例，您将不希望这样做。其次，当你完成一个实例时，你必须调用`destroy`; 否则，实例和数据将不会被垃圾收集，最终会导致内存泄漏。

这就是为什么我最初的回答**“你不应该”**是我想要坚持的原因。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2015-02-20T12:18:21.523

通过利用`bind`和方法，有一种更简单的`call`方法。

通过将私有变量设置为对象，您可以利用该对象的范围。

## 例子

```
function TestClass (value) {
    // The private value(s)
    var _private = {
        value: value
    };

    // `bind` creates a copy of `getValue` when the object is instantiated
    this.getValue = TestClass.prototype.getValue.bind(_private);

    // Use `call` in another function if the prototype method will possibly change
    this.getValueDynamic = function() {
        return TestClass.prototype.getValue.call(_private);
    };
};

TestClass.prototype.getValue = function() {
    return this.value;
}; 
```

* * *

这种方法并非没有缺点。由于范围上下文被有效地覆盖，因此您无法访问`_private`对象之外。但是，仍然可以访问实例对象的范围并非不可能。您可以将对象的上下文 ( `this`) 作为第二个参数传递给`bind`或`call`仍然可以访问原型函数中的公共值。

## 访问公共价值观

```
function TestClass (value) {
    var _private = {
        value: value
    };

    this.message = "Hello, ";

    this.getMessage = TestClass.prototype.getMessage.bind(_private, this);

}

TestClass.prototype.getMessage = function(_public) {

    // Can still access passed in arguments
    // e.g. – test.getValues('foo'), 'foo' is the 2nd argument to the method
    console.log([].slice.call(arguments, 1));
    return _public.message + this.value;
};

var test = new TestClass("World");
test.getMessage(1, 2, 3); // [1, 2, 3]         (console.log)
                          // => "Hello, World" (return value)

test.message = "Greetings, ";
test.getMessage(); // []                    (console.log)
                   // => "Greetings, World" (return value) 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2015-02-26T17:52:24.333

尝试一下！

```
 function Potatoe(size) {
    var _image = new Image();
    _image.src = 'potatoe_'+size+'.png';
    function getImage() {
        if (getImage.caller == null || getImage.caller.owner != Potatoe.prototype)
            throw new Error('This is a private property.');
        return _image;
    }
    Object.defineProperty(this,'image',{
        configurable: false,
        enumerable: false,
        get : getImage          
    });
    Object.defineProperty(this,'size',{
        writable: false,
        configurable: false,
        enumerable: true,
        value : size            
    });
}
Potatoe.prototype.draw = function(ctx,x,y) {
    //ctx.drawImage(this.image,x,y);
    console.log(this.image);
}
Potatoe.prototype.draw.owner = Potatoe.prototype;

var pot = new Potatoe(32);
console.log('Potatoe size: '+pot.size);
try {
    console.log('Potatoe image: '+pot.image);
} catch(e) {
    console.log('Oops: '+e);
}
pot.draw(); 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2015-08-21T12:40:16.193

这就是我想出的。

```
(function () {
    var staticVar = 0;
    var yrObj = function () {
        var private = {"a":1,"b":2};
        var MyObj = function () {
            private.a += staticVar;
            staticVar++;
        };
        MyObj.prototype = {
            "test" : function () {
                console.log(private.a);
            }
        };

        return new MyObj;
    };
    window.YrObj = yrObj;
}());

var obj1 = new YrObj;
var obj2 = new YrObj;
obj1.test(); // 1
obj2.test(); // 2 
```

这个实现的主要问题是它重新定义了每个实例的原型。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2016-03-05T14:49:28.733

有一个非常简单的方法可以做到这一点

```
function SharedPrivate(){
  var private = "secret";
  this.constructor.prototype.getP = function(){return private}
  this.constructor.prototype.setP = function(v){ private = v;}
}

var o1 = new SharedPrivate();
var o2 = new SharedPrivate();

console.log(o1.getP()); // secret
console.log(o2.getP()); // secret
o1.setP("Pentax Full Frame K1 is on sale..!");
console.log(o1.getP()); // Pentax Full Frame K1 is on sale..!
console.log(o2.getP()); // Pentax Full Frame K1 is on sale..!
o2.setP("And it's only for $1,795._");
console.log(o1.getP()); // And it's only for $1,795._ 
```

JavaScript 原型是黄金。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2017-04-10T00:46:58.350

我参加聚会迟到了，但我想我可以做出贡献。在这里，检查一下：

```
// 1\. Create closure
var SomeClass = function() {
  // 2\. Create `key` inside a closure
  var key = {};
  // Function to create private storage
  var private = function() {
    var obj = {};
    // return Function to access private storage using `key`
    return function(testkey) {
      if(key === testkey) return obj;
      // If `key` is wrong, then storage cannot be accessed
      console.error('Cannot access private properties');
      return undefined;
    };
  };
  var SomeClass = function() {
    // 3\. Create private storage
    this._ = private();
    // 4\. Access private storage using the `key`
    this._(key).priv_prop = 200;
  };
  SomeClass.prototype.test = function() {
    console.log(this._(key).priv_prop); // Using property from prototype
  };
  return SomeClass;
}();

// Can access private property from within prototype
var instance = new SomeClass();
instance.test(); // `200` logged

// Cannot access private property from outside of the closure
var wrong_key = {};
instance._(wrong_key); // undefined; error logged
```

我将此方法称为**访问器模式**。基本思想是我们有一个*闭包*，闭包内有一个*键*，并且我们创建了一个*私有对象*（在构造函数中），只有当你有*键*时才能访问它。

如果您有兴趣，可以在[我的文章](https://medium.com/@weberino/you-can-create-truly-private-properties-in-js-without-es6-7d770f55fbc3)中阅读更多相关信息。使用此方法，您可以创建在闭包之外无法访问的每个对象属性。因此，您可以在构造函数或原型中使用它们，但不能在其他任何地方使用它们。我还没有看到这种方法在任何地方使用过，但我认为它真的很强大。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2014-11-21T23:22:27.990

你不能把变量放在更高的范围内吗？

```
(function () {
    var privateVariable = true;

    var MyClass = function () {
        if (privateVariable) console.log('readable from private scope!');
    };

    MyClass.prototype.publicMethod = function () {
        if (privateVariable) console.log('readable from public scope!');
    };
}))(); 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2015-01-27T06:09:51.037

您也可以尝试不直接在原型上添加方法，而是在构造函数上添加方法，如下所示：

```
var MyArray = function() {
    var array = [];

    this.add = MyArray.add.bind(null, array);
    this.getAll = MyArray.getAll.bind(null, array);
}

MyArray.add = function(array, item) {
    array.push(item);
}
MyArray.getAll = function(array) {
    return array;
}

var myArray1 = new MyArray();
myArray1.add("some item 1");
console.log(myArray1.getAll()); // ['some item 1']
var myArray2 = new MyArray();
myArray2.add("some item 2");
console.log(myArray2.getAll()); // ['some item 2']
console.log(myArray1.getAll()); // ['some item 2'] - FINE! 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2016-02-18T12:52:14.257

这是我在尝试为这个问题找到最简单的解决方案时想出的东西，也许它对某人有用。我是 javascript 新手，所以代码很可能存在一些问题。

```
// pseudo-class definition scope
(function () {

    // this is used to identify 'friend' functions defined within this scope,
    // while not being able to forge valid parameter for GetContext() 
    // to gain 'private' access from outside
    var _scope = new (function () { })();
    // -----------------------------------------------------------------

    // pseudo-class definition
    this.Something = function (x) {

        // 'private' members are wrapped into context object,
        // it can be also created with a function
        var _ctx = Object.seal({

            // actual private members
            Name: null,
            Number: null,

            Somefunc: function () {
                console.log('Something(' + this.Name + ').Somefunc(): number = ' + this.Number);
            }
        });
        // -----------------------------------------------------------------

        // function below needs to be defined in every class
        // to allow limited access from prototype
        this.GetContext = function (scope) {

            if (scope !== _scope) throw 'access';
            return _ctx;
        }
        // -----------------------------------------------------------------

        {
            // initialization code, if any
            _ctx.Name = (x !== 'undefined') ? x : 'default';
            _ctx.Number = 0;

            Object.freeze(this);
        }
    }
    // -----------------------------------------------------------------

    // prototype is defined only once
    this.Something.prototype = Object.freeze({

        // public accessors for 'private' field
        get Number() { return this.GetContext(_scope).Number; },
        set Number(v) { this.GetContext(_scope).Number = v; },

        // public function making use of some private fields
        Test: function () {

            var _ctx = this.GetContext(_scope);
            // access 'private' field
            console.log('Something(' + _ctx.Name + ').Test(): ' + _ctx.Number);
            // call 'private' func
            _ctx.Somefunc();
        }
    });
    // -----------------------------------------------------------------

    // wrap is used to hide _scope value and group definitions
}).call(this);

function _A(cond) { if (cond !== true) throw new Error('assert failed'); }
// -----------------------------------------------------------------

function test_smth() {

    console.clear();

    var smth1 = new Something('first'),
      smth2 = new Something('second');

    //_A(false);
    _A(smth1.Test === smth2.Test);

    smth1.Number = 3;
    smth2.Number = 5;
    console.log('smth1.Number: ' + smth1.Number + ', smth2.Number: ' + smth2.Number);

    smth1.Number = 2;
    smth2.Number = 6;

    smth1.Test();
    smth2.Test();

    try {
        var ctx = smth1.GetContext();
    } catch (err) {
        console.log('error: ' + err);
    }
}

test_smth(); 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2016-06-06T01:50:34.947

我今天遇到了完全相同的问题，在详细说明 Scott Rippey 的一流响应之后，我想出了一个非常简单的解决方案（恕我直言），它既兼容 ES5 又高效，而且名称冲突安全（使用 _private 似乎不安全） .

```
/*jslint white: true, plusplus: true */

 /*global console */

var a, TestClass = (function(){
    "use strict";
    function PrefixedCounter (prefix) {
        var counter = 0;
        this.count = function () {
            return prefix + (++counter);
        };
    }
    var TestClass = (function(){
        var cls, pc = new PrefixedCounter("_TestClass_priv_")
        , privateField = pc.count()
        ;
        cls = function(){
            this[privateField] = "hello";
            this.nonProtoHello = function(){
                console.log(this[privateField]);
            };
        };
        cls.prototype.prototypeHello = function(){
            console.log(this[privateField]);
        };
        return cls;
    }());
    return TestClass;
}());

a = new TestClass();
a.nonProtoHello();
a.prototypeHello(); 
```

用 ringojs 和 nodejs 测试。我渴望阅读您的意见。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2017-06-08T16:18:50.473

```
var getParams = function(_func) {
  res = _func.toString().split('function (')[1].split(')')[0].split(',')
  return res
}

function TestClass(){

  var private = {hidden: 'secret'}
  //clever magic accessor thing goes here
  if ( !(this instanceof arguments.callee) ) {
    for (var key in arguments) {
      if (typeof arguments[key] == 'function') {
        var keys = getParams(arguments[key])
        var params = []
        for (var i = 0; i <= keys.length; i++) {
          if (private[keys[i]] != undefined) {
            params.push(private[keys[i]])
          }
        }
        arguments[key].apply(null,params)
      }
    }
  }
}

TestClass.prototype.test = function(){
  var _hidden; //variable I want to get
  TestClass(function(hidden) {_hidden = hidden}) //invoke magic to get
};

new TestClass().test() 
```

这个怎么样？使用私有访问器。仅允许您获取变量而不设置它们，具体取决于用例。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2017-06-21T11:51:15.180

我有一个解决方案，但我不确定它是否没有缺陷。

要使其工作，您必须使用以下结构：

1.  使用 1 个包含所有私有变量的私有对象。
2.  使用 1 个实例函数。
3.  对构造函数和所有原型函数应用闭包。
4.  创建的任何实例都是在定义的闭包之外完成的。

这是代码：

```
var TestClass = 
(function () {
    // difficult to be guessed.
    var hash = Math.round(Math.random() * Math.pow(10, 13) + + new Date());
    var TestClass = function () {
        var privateFields = {
            field1: 1,
            field2: 2
        };
        this.getPrivateFields = function (hashed) {
            if(hashed !== hash) {
                throw "Cannot access private fields outside of object.";
                // or return null;
            }
            return privateFields;
        };
    };

    TestClass.prototype.prototypeHello = function () {
        var privateFields = this.getPrivateFields(hash);
        privateFields.field1 = Math.round(Math.random() * 100);
        privateFields.field2 = Math.round(Math.random() * 100);
    };

    TestClass.prototype.logField1 = function () {
        var privateFields = this.getPrivateFields(hash);
        console.log(privateFields.field1);
    };

    TestClass.prototype.logField2 = function () {
        var privateFields = this.getPrivateFields(hash);
        console.log(privateFields.field2);
    };

    return TestClass;
})(); 
```

它的工作原理是它提供了一个实例函数“this.getPrivateFields”来访问“privateFields”私有变量对象，但是这个函数只会返回定义的主闭包内的“privateFields”对象（也是使用“this.getPrivateFields”的原型函数" 需要在这个闭包中定义）。

运行时产生且难以猜测的哈希用作参数，以确保即使在闭包范围之外调用“getPrivateFields”也不会返回“privateFields”对象。

缺点是我们不能在闭包之外用更多的原型函数来扩展 TestClass。

这是一些测试代码：

```
var t1 = new TestClass();
console.log('Initial t1 field1 is: ');
t1.logField1();
console.log('Initial t1 field2 is: ');
t1.logField2();
t1.prototypeHello();
console.log('t1 field1 is now: ');
t1.logField1();
console.log('t1 field2 is now: ');
t1.logField2();
var t2 = new TestClass();
console.log('Initial t2 field1 is: ');
t2.logField1();
console.log('Initial t2 field2 is: ');
t2.logField2();
t2.prototypeHello();
console.log('t2 field1 is now: ');
t2.logField1();
console.log('t2 field2 is now: ');
t2.logField2();

console.log('t1 field1 stays: ');
t1.logField1();
console.log('t1 field2 stays: ');
t1.logField2();

t1.getPrivateFields(11233); 
```

编辑：使用这种方法，也可以“定义”私有函数。

```
TestClass.prototype.privateFunction = function (hashed) {
    if(hashed !== hash) {
        throw "Cannot access private function.";
    }
};

TestClass.prototype.prototypeHello = function () {
    this.privateFunction(hash);
}; 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2017-09-10T12:34:57.873

今天正在玩这个，这是我在不使用符号的情况下能找到的唯一解决方案。最好的一点是它实际上可以完全保密。

该解决方案基于一个本土模块加载器，它基本上成为私有存储缓存的中介（使用弱映射）。

```
 const loader = (function() {
        function ModuleLoader() {}

    //Static, accessible only if truly needed through obj.constructor.modules
    //Can also be made completely private by removing the ModuleLoader prefix.
    ModuleLoader.modulesLoaded = 0;
    ModuleLoader.modules = {}

    ModuleLoader.prototype.define = function(moduleName, dModule) {
        if (moduleName in ModuleLoader.modules) throw new Error('Error, duplicate module');

        const module = ModuleLoader.modules[moduleName] = {}

        module.context = {
            __moduleName: moduleName,
            exports: {}
        }

        //Weak map with instance as the key, when the created instance is garbage collected or goes out of scope this will be cleaned up.
        module._private = {
            private_sections: new WeakMap(),
            instances: []
        };

        function private(action, instance) {
            switch (action) {
                case "create":
                    if (module._private.private_sections.has(instance)) throw new Error('Cannot create private store twice on the same instance! check calls to create.')
                    module._private.instances.push(instance);
                    module._private.private_sections.set(instance, {});
                    break;
                case "delete":
                    const index = module._private.instances.indexOf(instance);
                    if (index == -1) throw new Error('Invalid state');
                    module._private.instances.slice(index, 1);
                    return module._private.private_sections.delete(instance);
                    break;
                case "get":
                    return module._private.private_sections.get(instance);
                    break;
                default:
                    throw new Error('Invalid action');
                    break;
            }
        }

        dModule.call(module.context, private);
        ModuleLoader.modulesLoaded++;
    }

    ModuleLoader.prototype.remove = function(moduleName) {
        if (!moduleName in (ModuleLoader.modules)) return;

        /*
            Clean up as best we can.
        */
        const module = ModuleLoader.modules[moduleName];
        module.context.__moduleName = null;
        module.context.exports = null;
        module.cotext = null;
        module._private.instances.forEach(function(instance) { module._private.private_sections.delete(instance) });
        for (let i = 0; i < module._private.instances.length; i++) {
            module._private.instances[i] = undefined;
        }
        module._private.instances = undefined;
        module._private = null;
        delete ModuleLoader.modules[moduleName];
        ModuleLoader.modulesLoaded -= 1;
    }

    ModuleLoader.prototype.require = function(moduleName) {
        if (!(moduleName in ModuleLoader.modules)) throw new Error('Module does not exist');

        return ModuleLoader.modules[moduleName].context.exports;
    }

     return new ModuleLoader();
    })();

    loader.define('MyModule', function(private_store) {
        function MyClass() {
            //Creates the private storage facility. Called once in constructor.
            private_store("create", this);

            //Retrieve the private storage object from the storage facility.
            private_store("get", this).no = 1;
        }

        MyClass.prototype.incrementPrivateVar = function() {
            private_store("get", this).no += 1;
        }

        MyClass.prototype.getPrivateVar = function() {
            return private_store("get", this).no;
        }

        this.exports = MyClass;
    })

    //Get whatever is exported from MyModule
    const MyClass = loader.require('MyModule');

    //Create a new instance of `MyClass`
    const myClass = new MyClass();

    //Create another instance of `MyClass`
    const myClass2 = new MyClass();

    //print out current private vars
    console.log('pVar = ' + myClass.getPrivateVar())
    console.log('pVar2 = ' + myClass2.getPrivateVar())

    //Increment it
    myClass.incrementPrivateVar()

    //Print out to see if one affected the other or shared
    console.log('pVar after increment = ' + myClass.getPrivateVar())
    console.log('pVar after increment on other class = ' + myClass2.getPrivateVar())

    //Clean up.
    loader.remove('MyModule') 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2019-01-31T05:21:25.310

我知道自从被问到这个问题已经超过 10 年了，但我只是在我的程序员生命中第 n 次思考这个问题，并找到了一个我不知道我是否完全喜欢的可能解决方案. 我以前没有见过这种方法的文档，所以我将其命名为“私人/公共美元模式”或***_$ / $ 模式***。

```
var ownFunctionResult = this.$("functionName"[, arg1[, arg2 ...]]);
var ownFieldValue = this._$("fieldName"[, newValue]);

var objectFunctionResult = objectX.$("functionName"[, arg1[, arg2 ...]]);

//Throws an exception. objectX._$ is not defined
var objectFieldValue = objectX._$("fieldName"[, newValue]); 
```

该概念使用返回*接口*对象的*构造*函数的*ClassDefinition*函数。该接口的唯一方法是接收参数以调用构造函数对象中的相应函数，之后传递的任何附加参数都将在调用中传递。**`$``name``name`**

 **全局定义的辅助函数根据需要`ClassValues`将所有字段存储在*对象*中。它定义了`_$`访问它们的函数`name`。这遵循一个简短的 get/set 模式，因此如果`value`通过，它将用作新的变量值。

```
var ClassValues = function (values) {
  return {
    _$: function _$(name, value) {
      if (arguments.length > 1) {
        values[name] = value;
      }

      return values[name];
    }
  };
}; 
```

全局定义的函数`Interface`采用一个对象和一个`Values`对象返回一个`_interface`带有单个函数的函数`$`，该函数检查`obj`以查找以参数命名的函数`name`并将其`values`作为*作用域*对象调用。传递给的附加参数`$`将在函数调用时传递。

```
var Interface = function (obj, values, className) {
  var _interface = {
    $: function $(name) {
      if (typeof(obj[name]) === "function") {
        return obj[name].apply(values, Array.prototype.splice.call(arguments, 1));
      }

      throw className + "." + name + " is not a function.";
    }
  };

  //Give values access to the interface.
  values.$ = _interface.$;

  return _interface;
}; 
```

在下面的示例中，`ClassX`分配给 的结果`ClassDefinition`，即`Constructor`函数。`Constructor`可以接收任意数量的参数。`Interface`是调用构造函数后外部代码得到的。

```
var ClassX = (function ClassDefinition () {
  var Constructor = function Constructor (valA) {
    return Interface(this, ClassValues({ valA: valA }), "ClassX");
  };

  Constructor.prototype.getValA = function getValA() {
    //private value access pattern to get current value.
    return this._$("valA");
  };

  Constructor.prototype.setValA = function setValA(valA) {
    //private value access pattern to set new value.
    this._$("valA", valA);
  };

  Constructor.prototype.isValAValid = function isValAValid(validMessage, invalidMessage) {
    //interface access pattern to call object function.
    var valA = this.$("getValA");

    //timesAccessed was not defined in constructor but can be added later...
    var timesAccessed = this._$("timesAccessed");

    if (timesAccessed) {
      timesAccessed = timesAccessed + 1;
    } else {
      timesAccessed = 1;
    }

    this._$("timesAccessed", timesAccessed);

    if (valA) {
      return "valA is " + validMessage + ".";
    }

    return "valA is " + invalidMessage + ".";
  };

  return Constructor;
}()); 
```

`Constructor`尽管您可以在构造函数体中定义它们，但在 中包含非原型函数是没有意义的。所有函数都以*公共美元模式* `this.$("functionName"[, param1[, param2 ...]])`调用。*使用私有美元模式* 访问私有值`this._$("valueName"[, replacingValue]);`。由于`Interface`没有 的定义`_$`，因此外部对象无法访问这些值。由于每个原型函数体`this`都设置为 function 中的`values`对象`$`，因此如果直接调用 Constructor 兄弟函数，则会出现异常；***_$ / $ 模式***也需要在原型函数体中遵循。下面的示例用法。

```
var classX1 = new ClassX();
console.log("classX1." + classX1.$("isValAValid", "valid", "invalid"));
console.log("classX1.valA: " + classX1.$("getValA"));
classX1.$("setValA", "v1");
console.log("classX1." + classX1.$("isValAValid", "valid", "invalid"));
var classX2 = new ClassX("v2");
console.log("classX1.valA: " + classX1.$("getValA"));
console.log("classX2.valA: " + classX2.$("getValA"));
//This will throw an exception
//classX1._$("valA"); 
```

和控制台输出。

```
classX1.valA is invalid.
classX1.valA: undefined
classX1.valA is valid.
classX1.valA: v1
classX2.valA: v2 
```

_ ***$ / $ 模式***允许在完全原型化的类中完全保密值。我不知道我是否会使用它，也不知道它是否有缺陷，但是，嘿，这是一个很好的拼图！

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2019-06-24T10:56:28.627

# ES6 弱映射

通过使用基于**ES6 WeakMaps**的简单模式，可以获得**可以从原型函数访问的私有成员变量**。

> 注意：WeakMaps 的使用通过让垃圾收集器识别和丢弃未使用的实例来保证**内存泄漏的安全性。**

```
// Create a private scope using an Immediately 
// Invoked Function Expression...
let Person = (function() {

    // Create the WeakMap that will hold each  
    // Instance collection's of private data
    let privateData = new WeakMap();

    // Declare the Constructor :
    function Person(name) {
        // Insert the private data in the WeakMap,
        // using 'this' as a unique acces Key
        privateData.set(this, { name: name });
    }

    // Declare a prototype method 
    Person.prototype.getName = function() {
        // Because 'privateData' is in the same 
        // scope, it's contents can be retrieved...
        // by using  again 'this' , as  the acces key 
        return privateData.get(this).name;
    };

    // return the Constructor
    return Person;
}());
```

可以在[此处找到有关此模式的更详细说明](https://humanwhocodes.com/blog/2014/01/21/private-instance-members-with-weakmaps-in-javascript/)

* * *

## 回答 #24

> 赞同：-1
> 
> 时间：2017-12-29T02:12:52.317

您需要在代码中更改 3 件事：

1.  替换`var privateField = "hello"`为`this.privateField = "hello"`。
2.  在原型中替换`privateField`为`this.privateField`.
3.  在非原型中也替换`privateField`为`this.privateField`.

最终代码如下：

```
TestClass = function(){
    this.privateField = "hello";
    this.nonProtoHello = function(){alert(this.privateField)};
}

TestClass.prototype.prototypeHello = function(){alert(this.privateField)};

var t = new TestClass();

t.prototypeHello() 
```

* * *

## 回答 #25

> 赞同：-2
> 
> 时间：2009-11-24T13:48:55.853

您可以在构造函数定义中使用原型赋值。

该变量将对原型添加的方法可见，但函数的所有实例都将访问相同的 SHARED 变量。

```
function A()
{
  var sharedVar = 0;
  this.local = "";

  A.prototype.increment = function(lval)
  {    
    if (lval) this.local = lval;    
    alert((++sharedVar) + " while this.p is still " + this.local);
  }
}

var a = new A();
var b = new A();    
a.increment("I belong to a");
b.increment("I belong to b");
a.increment();
b.increment(); 
```

我希望这会很有用。

# git - 一个目录中有两个 git 存储库？

> ID：436125
> 
> 赞同：101
> 
> 时间：2009-01-12T17:01:23.770
> 
> 标签：git, git-submodules, git-subrepo

是否可以在一个目录中有 2 个 git 存储库？我不认为，但我想我会问。基本上，我想检查我的主目录配置文件（例如 .emacs），这些文件应该在我工作的所有机器上都是通用的，但是有一个本地文件（例如 .emacs.local）的第二个存储库，其中包含机器特定的配置。我能想到的唯一方法是将本地配置放在子目录中，并从主 git 存储库中忽略该子目录。还有其他想法吗？

* * *

## 回答 #1

> 赞同：191
> 
> 时间：2013-06-26T06:50:40.073

本文相对较好地涵盖了这一点：

[https://github.com/rrrene/gitscm-next/blob/master/app/views/blog/progit/2010-04-11-environment.markdown](https://github.com/rrrene/gitscm-next/blob/master/app/views/blog/progit/2010-04-11-environment.markdown)

基本上，如果您从命令行工作，这比您想象的要简单。假设你想要 2 个 git repos：

```
.gitone
.gittwo 
```

你可以像这样设置它们：

```
git init .
mv .git .gitone
git init .
mv .git .gittwo 
```

您可以添加一个文件并将其提交给一个像这样的文件：

```
git --git-dir=.gitone add test.txt
git --git-dir=.gitone commit -m "Test" 
```

所以 git 的选项首先出现，然后是命令，然后是 git 命令的选项。您可以轻松地为 git 命令起别名，例如：

```
#!/bin/sh
alias gitone='git --git-dir=.gitone'
alias gittwo='git --git-dir=.gittwo' 
```

因此，您可以使用更少的输入来承诺其中一个，例如`gitone commit -m "blah"`.

似乎变得更棘手的是忽略。由于 .gitignore 通常位于项目根目录中，因此您需要找到一种方法来切换它而不切换整个根目录。或者，您可以使用 .git/info/exclude，但您执行的所有忽略操作都不会被提交或推送 - 这可能会搞砸其他用户。使用这两个 repo 的其他人可能会推送 .gitignore，这可能会导致冲突。我不清楚解决这些问题的最佳方法。

如果你更喜欢 TortoiseGit 之类的 GUI 工具，你也会遇到一些挑战。您可以编写一个小脚本，将 .gitone 或 .gittwo 临时重命名为 .git，以便满足这些工具的假设。

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2009-01-13T04:24:06.357

如果我了解您在做什么，您可以在一个存储库中处理所有内容，为每台机器使用单独的分支，以及包含您的公共主目录配置文件的分支。

初始化 repo 并将公共文件提交给它，也许将 MASTER 分支重命名为 Common。然后从那里为您使用的每台机器创建一个单独的分支，并将特定于机器的文件提交到该分支中。每当您更改公用文件时，将公用分支合并到每个机器分支并推送到您的其他机器（如果有很多，请为此编写脚本）。

然后在每台机器上，检出该机器的分支，其中也将包含通用配置文件。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-01-12T17:05:39.937

看看[git submodule](http://git-scm.com/docs/git-submodule)。

> 子模块允许将外部存储库嵌入到源树的专用子目录中，始终指向特定的提交。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2010-08-23T14:06:03.483

可以使用该变量`GIT_DIR`，但如果您不知道自己在做什么，则有很多警告。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-03-15T16:16:54.450

RichiH 编写了一个名为[vcsh](https://github.com/RichiH/vcsh)的工具，该工具使用 git 的假裸 repos 来管理 dotfiles，将多个工作目录放入 $HOME。与 csh AFAIK 无关。

但是，如果您确实有多个目录，则 git-submodules 的替代方案（在最好的情况下会很痛苦，并且此示例的用法不是最好的情况）是[gitslave](http://gitslave.sf.net)，它使从属存储库在尖端签出始终分支，并且不需要三步过程来对子仓库进行更改（签出到正确的分支，进行并提交更改，然后进入超级项目并提交新的子模块提交）。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-01-12T18:30:02.000

是的，子模块可能是你想要的。另一种选择是将您的工作副本放在子目录中，然后将符号链接从您的主目录指向感兴趣的文件。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2014-03-21T18:44:50.590

我首选的方法是在子目录中使用 repo，并使用递归符号链接：

```
git clone repo1
cd somerepo
git clone repo2
cd repo2
./build 
```

' **repo/** build'-文件看起来像：

```
#!/bin/bash 
SELF_PATH="$(dirname "$(readlink -f "$0")" )"  # get current dir 
cd .. && git stash && git clean -f -d ''       # remove previous symlinks
cp -sR "$SELF_PATH"/* ../.                     # create recursive symlinks in root 
```

**注意**：不要使用“git add”。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-12-04T03:22:41.957

另一种选择是将它们放在单独的文件夹中，并创建从一个文件夹到另一个文件夹的符号硬链接。

例如，如果有存储库：

1.  Repo1/文件夹A
2.  回购1/文件夹B

和：

1.  Repo2/文件夹C

您可以将文件夹`FolderA`和`FolderB`从 Repo1 符号链接到 Repo2。对于 Windows，在 Repo1 上运行的命令是：

```
User@Repo1$ mklink /J FullPath/Repo2/FolderA FullPath/Repo1/FolderA
User@Repo1$ mklink /J FullPath/Repo2/FolderB FullPath/Repo1/FolderB
User@Repo1$ printf "/FolderA/*\n/FolderB/*\n" >> .gitignore 
```

对于主存储库上的文件，您需要对它们中的每一个进行符号链接，并将它们添加到存储库`.gitignore`以避免噪音，除非您愿意。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2021-12-11T18:15:28.057

是的，可以在一个目录中有两个 git 存储库。

我假设一个远程存储库在 GitHub 中，另一个在 GitLab 中。我还使用两个不同的 SSH 密钥连接到这些远程存储库。

您可以在 GitHub / GitLab 之一中拥有两个远程存储库（并使用单个 SSH 密钥） - 不会有太大变化。

**先决条件**：

*   公共 SSH 密钥（`id_ecdsa.pub`/ `id_rsa.pub`/`id_ed25519.pub`等）存在于您的 GitHub 和 GitLab 配置文件中

*   私人 SSH 密钥（`id_ecdsa`/ `id_rsa`/`id_ed25519`等）被添加并保留在您的操作系统的钥匙串中

*   SSH 配置文件具有为 GitHub 和 GitLab 指定的密钥：

    ```
    Host github.com
      Hostname github.com
      AddKeysToAgent yes
      UseKeychain yes
      IdentityFile ~/.ssh/id_ecdsa

    Host gitlab.com
      Hostname gitlab.com
      AddKeysToAgent yes
      UseKeychain yes
      IdentityFile ~/.ssh/id_rsa 
    ```

**[这是克里斯](https://stackoverflow.com/a/17313342/13055097)模拟工作流程的答案的细分**：

*   在目录中初始化 git：

    `git init`

*   将 git 连接到一个远程存储库（位于 GitHub 中）

    `git remote add origin git@github.com:your-username/your-repo.git`

*   重命名`.git`为`.github`

    `mv .git .github`

*   再次初始化 git

    `git init`

*   将 git 连接到另一个远程存储库（位于 GitLab 中）

    `git remote add origin git@gitlab.com:your-username/your-repo.git`

*   重命名`.git`为`.gitlab`

    `mv .git .gitlab`

*   验证当前目录是否连接到两个不同的远程存储库

    `git --git-dir=.github remote -v`

    `git --git-dir=.gitlab remote -v`

*   拉取远程（GitHub 和 GitLab）存储库

    ```
    git --git-dir=.github pull origin main
    git --git-dir=.gitlab pull origin main 
    ```

*   将文件添加到两个存储库

    ```
    git --git-dir=.github add README.md
    git --git-dir=.gitlab add README.md 
    ```

*   写提交信息

    ```
    git --git-dir=.github commit -m "operational overview"
    git --git-dir=.gitlab commit -m "operational overview" 
    ```

*   推送到远程

    ```
    git --git-dir=.github push -u origin main
    git --git-dir=.gitlab push -u origin main 
    ```

我们在这里做的唯一额外的事情是使用`--git-dir`标志。

如果您打算经常这样做，您可以在您的 shell 配置文件中添加一个别名（如`.zprofile`、`bashrc`等）：

```
export github="git --git-dir=.github"
export gitlab="git --git-dir=.gitlab" 
```

`pull`像, `push`, `add`,这样的未来操作`commit`可以像 - `github pull origin main`, `gitlab pull origin main`, 等一样执行。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-12-07T00:09:26.837

免责声明：这不是广告。我是提供的库的开发人员。

我创建了一个 git 扩展来处理您想要将多个存储库混合到一个文件夹中的情况。lib 的优点是跟踪存储库和文件冲突。你可以在[github](https://github.com/git-melt/melt)上找到它。还有 2 个示例存储库可供试用。

# eclipse - Eclipse：分离包资源管理器，大纲面板？

> ID：436134
> 
> 赞同：2
> 
> 时间：2009-01-12T17:03:40.223
> 
> 标签：eclipse

我一直在与 Eclipse 进行斗争，以释放更多的屏幕空间用于代码而不是装饰。我可以通过双击来最大化代码窗口，摆脱包资源管理器、大纲和其他面板，但我有时会使用其他面板，尤其是用于 SVN 集成的包资源管理器。

有没有办法分离各种面板并根据热键弹出它们？我想象着代码窗口一直最大化，在需要时使用热键将包资源管理器作为单独的弹出窗口提出，当我单击时弹出窗口作为普通窗口进入后台代码窗口返回编辑。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-12T22:42:03.130

这是我最接近你想要的东西：

在 Window->Preferences->General->Perspectives 下，将第二个设置“Open a new view”更改为“As a fast view”。然后，关闭 Package Explorer 视图。下次它出现时，它（以及任何其他新打开的视图）将是一个快速视图：它会在失去焦点时消失。

正如另一位回答者提到的，PE 有一个键盘快捷键。我发现它的默认值有点不友好，所以我建议在 Window->Preferences->General->Keys 下更改它。包资源管理器命令位于“显示视图（视图：包资源管理器）”下。Ctrl+Shift+P 似乎是一个不错的选择。然后，您可以按 Ctrl+Shift+P，在 PE 中执行某些操作，然后在代码窗口中单击返回，然后观看 PE 消失。注意：如果我先更改“作为快速视图”设置，我的新键盘快捷键会偶尔停止工作。重新输入键盘快捷键似乎可以解决此问题。

您可以通过拖动重新定位快速视图以将其更改为正常类型的视图。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T17:34:32.580

最小化包资源管理器，然后使用：`Alt-Shift-Q then P`.

这将“显示视图（包资源管理器）”作为快速视图。

发现`Shift-Ctl-L`用于显示键盘快捷方式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-12T22:47:34.273

好吧，我只是在 J2EE Perspective 上编写代码，所有东西都消失了。当我想做其他事情时，我会换个角度

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-24T09:15:48.247

通过点击 ++ then`Alt`激活`Shift`包资源管理器。通过单击包资源管理器上的减号按钮将其最小化为快速视图（您可以在部分中为命令分配快捷键）。按+最大化编辑器。您可以如上所述再次激活包资源管理器。使用包资源管理器后按到活动编辑器。`Q``P`![在此处输入图像描述](https://i.stack.imgur.com/TGcA0.jpg)`Minimizes the active view or editor``Windows > Preferences > Keys``Ctrl``M``F12`

所有这些都可以通过热键 NO MOUSE CLICKS 完成。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-12T23:17:12.573

您可以通过 Ctrl-3 访问它（几乎与 Eclipse 中的其他任何东西一样），然后用转义键关闭它。当您再次按 Ctrl-3 时，它将是首选。

# mysql - 使用 MacPorts 或 Mac OS X 二进制包安装 MySQL？

> ID：436149
> 
> 赞同：4
> 
> 时间：2009-01-12T17:08:33.537
> 
> 标签：mysql, macos, macports

使用其中一个有什么优势吗？我应该使用[供应商提供](http://dev.mysql.com/doc/refman/5.1/en/mac-os-x-installation.html)的PKG 文件还是使用 Darwin Ports 版本？是否有决定如何安装软件包的一般经验法则？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-12T17:12:31.203

我会因为支持而使用供应商提供的软件包。我发现当我遇到 darwinports 的问题时，与基于 PKG 的安装相比，找到支持要困难得多。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-12T17:20:45.553

使用 macports（darwinports 重命名）。

您将获得 /opt/local 中的库存安装。

用它构建的工具链与您通常在 linux 中获得的经典 /usr/local 工具链非常相似。您确切地知道它是如何安装的，并且它会自动引入依赖关系，更重要的是，使用任何现代 mac 从源代码构建东西会很快，当完成后，您需要在任何东西上构建它，因为你有源。

端口同步 && 端口 -d 安装 mysql5 +server

如果这是第一次使用 macports，请在晚上运行它，然后在早上它会完成。下次你不需要建造这么多。系统奖励持续使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-12T18:14:55.273

我使用供应商提供的软件包在 OS X 上安装 MySQL。它既快速又简单。对于一般用途的 MySQL 使用，我不明白为什么有人会以其他方式这样做。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-12T18:17:48.107

我通常更喜欢使用 MacPorts 来安装软件，*但*对于 MySQL，我发现使用供应商提供的安装程序要容易得多。更少的编译时间（显然），并且它包括使配置更容易的工具。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-12T17:33:12.083

我通常更喜欢使用包管理器中的包（尽管我使用[fink](http://www.finkproject.org/) ...）。我发现集成/依赖问题比我的错误修复问题更常见、更严重。

但是，很大程度上取决于包维护者，所以 YMMV。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-12T18:23:21.793

我不会将 MacPorts 或 Fink 用于任何关键应用程序。特别是如果您使用 Leopard。

也许只有我一个人，但我使用 MacPorts 和 Fink 安装应用程序的成功率约为 50-50。

# javascript - 为什么在 Firefox 中调用这个 jQuery 函数会失败？

> ID：436154
> 
> 赞同：7
> 
> 时间：2009-01-12T17:09:54.127
> 
> 标签：javascript, jquery, firefox

我的网页链接中有以下代码行：

```
<a href="javascript:$('#comment_form').toggle('normal')" title="Comment on this post"> 
```

这会产生一个链接，该链接应该弹出一个隐藏的表单。它适用于 Safari，但在 Firefox 中，我只是得到一个几乎是空的页面，只有以下文本：

```
[object Object] 
```

我确定这与 jQuery 函数返回的值有关，但我不确定如何修复对 JavaScript 函数的调用，因此它也适用于 Firefox。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-01-12T17:16:12.100

为了爱...

```
<script type='text/javascript'>
jQuery(function($){   # Document ready, access $ as jQuery in this scope
    $("a#comment").click(function(){  # bind a click event on the A like with ID='comment'
         $('#comment_form').toggleClass('normal');  # Toggle the class on the ID comment form
         return false;  # stop the href from being followed. 
    }); 
});
</script>
....
<a id="comment" href="/you_need_javascript_sorry.html" title="Comment on this post">
   [Comment]
</a> 
```

请不要像在 HTML 中那样嵌入 JavaScript。

如果你像这样在 HTML 中嵌入 JavaScript，你：

1.  制作凌乱的代码。
2.  遇到奇怪的问题，就像您刚刚使用黑客解决它一样
3.  尝试中键单击链接的用户将无处可去。
4.  维护散布在页面链接中的代码的可执行部分将以失败告终。
5.  当用户没有 javascript 时不要优雅地降级
6.  当您开始需要做超过 2 层的商店报价等事情时，就会出现问题。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-12T17:11:41.300

尝试：

```
<a href="javascript:void($('#comment_form').toggle('normal'))" title="Comment on this post"> 
```

在 a 中包含脚本`void()`将禁止浏览器显示执行结果。

* * *

**更新**

我直接回答了最初的问题，并给出了最省力的解决方案。正如这里的其他一些答案中提到的那样，我个人会将我的标记和 JavaScript 分开，并动态添加一个`onclick`处理程序，而不是将脚本嵌入`href`属性中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-12T17:12:13.420

尝试将href中的内容移动到onclick。通常，您应该避免在 href 属性中使用 JavaScript 代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-12T17:13:53.213

采用：

```
<a href="http://full-url-to-directory/page#comment_form"
   onclick="$('#comment_form').toggle('normal');return false;"
   title="Comment on this post"> 
```

尽管您需要在服务器上做一些事情，以便当您通过请求获得对 comment_form 元素的引用时，默认情况下它是可见的。这将允许您的页面（这部分）在没有启用 JavaScript 的情况下工作。

# hibernate - 如何使用 CurrentSessionContext/SpringSessionContext 和 HibernateDaoSupport 来拦截对 getCurrentSession() 的调用

> ID：436156
> 
> 赞同：0
> 
> 时间：2009-01-12T17:10:40.147
> 
> 标签：hibernate, spring, aop

我在 Spring 中使用 HibernateDaoSupport 进行 Spring-Hibernate 集成。我需要拦截所有 getCurrentSession 调用并启用过滤器并设置过滤器参数值。

Hibernate 支持 CurrentSessionContext 实现来拦截 getCurrentSession 调用。Spring 提供了一个名为 SpringSessionContext 的实现。但是当使用 HibernateDaoSupport 时，Spring 有自己的 SessionHolder 机制，并且 getCurrentSession() 永远不会被调用，并且拦截永远不会起作用。有解决方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-12T17:22:23.023

听起来您宁愿基于普通的 Hibernate 3 API 实现 Spring DAO：

[http://static.springframework.org/spring/docs/2.5.x/reference/orm.html#orm-hibernate-straight](http://static.springframework.org/spring/docs/2.5.x/reference/orm.html#orm-hibernate-straight)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-13T14:50:06.093

如果您使用的是 AnnotationSessionFactoryBean 或 LocalSessionFactoryBean 那么您还需要设置此属性：

```
<property name="exposeTransactionAwareSessionFactory" value="false" /> 
```

默认为true，当为true时，hibernate.current_session_context_class属性被忽略。

# css - CSS 浮动页脚

> ID：436165
> 
> 赞同：8
> 
> 时间：2009-01-12T17:13:04.930
> 
> 标签：css, footer

我想制作一个保持在可视窗口底部的页脚，除非在您将窗口缩小时它与内容对接。

我试过......底部：0; 位置：绝对；...但是当窗口较小时，页脚会妨碍您。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-12T17:16:26.813

我相信这会满足您的要求：[CSS 布局：100% 高度，带有页眉和页脚](http://www.xs4all.nl/~peterned/examples/csslayout1.html)。我在一个网站上使用过它，根据现有布局的复杂性，实施起来可能会很棘手。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T23:01:06.850

我使用 The Man In Blue 所描述的名为[footerStickAlt](http://www.themaninblue.com/writing/perspective/2005/08/29/)的方法- 很有魅力，但 CSS 不会验证您是否包含 IE6 hack。

# authentication - IIS7：像在 IIS6 中一样设置集成 Windows 身份验证

> ID：436169
> 
> 赞同：52
> 
> 时间：2009-01-12T17:15:11.680
> 
> 标签：authentication, iis-7, windows-authentication

这适用于不属于 AD 域的 Windows Server 2008 上的 IIS 7。我想用密码保护一个网站，人们必须输入用户名/密码（例如 Windows 帐户）才能查看该网站。然后，网站将使用自己的身份验证方法（表单）来处理用户帐户并决定是否显示会员特定页面等。

使用 IIS6，我们只是禁用了匿名访问并启用了集成的 Windows 身份验证。IIS7 的行为不同，当我输入 Windows 用户名/密码来查看该站点时，该站点正常运行，但重定向到登录页面。一旦我登录，该网站就会自然而然地运行。我需要能够在不使用网站凭据登录的情况下浏览网站。

我认为启用匿名访问在这里没有意义，因为我希望对网站的访问受到密码保护（当您第一次导航到 url 时弹出用户名/密码对话框）。

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2010-06-07T06:39:21.637

要在 Windows 7 机器上启用 IIS7 上的 Windows 身份验证：

*   转到控制面板

*   单击程序>>程序和功能

*   从左侧选择“打开或关闭 Windows 功能”。

*   展开 Internet 信息服务 >> 万维网服务 >> 安全

*   选择 Windows 身份验证并单击确定。

*   重置 IIS 并立即签入 IIS 以进行 Windows 身份验证。

享受

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-13T02:13:30.130

IIS7 集成模式不支持两阶段身份验证。身份验证现在是模块化的，因此不是 IIS 执行身份验证，然后 asp.net 执行身份验证，而是同时发生。

您可以：

1.  将应用程序域更改为 IIS6 经典模式...
2.  按照[这个示例](http://mvolo.com/iis-70-twolevel-authentication-with-forms-authentication-and-windows-authentication/)（[旧链接](http://mvolo.com/blogs/serverside/archive/2008/02/11/IIS-7.0-Two_2D00_Level-Authentication-with-Forms-Authentication-and-Windows-Authentication.aspx)），了解如何使用 IIS7 集成模式伪造两阶段身份验证。
3.  使用[Helicon Ape](http://www.helicontech.com/ape/)和[mod_auth 提供基本身份验证](http://www.helicontech.com/articles/site-authentication-not-using-windows-users/)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-07-15T06:26:18.983

在 Windows Server 2008 中为 Windows 身份验证配置 IIS7

请参阅此链接：

[http://www.iis.net/ConfigReference/system.webServer/security/authentication/windowsAuthentication](http://www.iis.net/ConfigReference/system.webServer/security/authentication/windowsAuthentication)

享受这篇文章:-)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-12T19:29:52.410

那么您希望他们获得 IE 密码挑战框，还是应该将他们引导至您的登录页面并在那里输入他们的信息？如果是第二个选项，那么您至少应该启用匿名访问您的登录页面，因为该站点尚不知道他们是谁。

如果您想要第一个选项，那么他们被转发到的登录页面将需要读取当前登录的用户并基于此采取行动，因为他们必须正确地进行身份验证才能达到这一点。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2011-01-19T23:10:50.390

Stack 上其他地方有另一个主题类似的主题，我遇到的最佳解决方案是使用[Helicon Ape的免费版本](http://www.helicontech.com/ape/)

安装完成后，按照标题为“HTTP 身份验证和授权”页面上的步骤操作

# web-applications - 可以集成到 Web 应用程序中的 Wiki

> ID：436171
> 
> 赞同：3
> 
> 时间：2009-01-12T17:15:21.073
> 
> 标签：web-applications, licensing, integration, wiki, mediawiki-api

我一直在考虑将 wiki 集成到我的网络应用程序中。目前我正在测试 MediaWiki API（网络服务接口），但我的预期用途很可能与 GPL 许可证冲突。我的网络应用程序的某些部分是闭源的。

是否有人对具有 Web 服务界面的 Wiki（具有 BSD 许可证或类似许可证）有良好的经验或建议，该界面将允许我检索/创建文章（格式化和原始文本）并支持用户权限管理。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-22T08:49:45.790

你也可以看看[XWiki](http://www.xwiki.com/xwiki/bin/view/Home/?language=en)，因为我知道它是一个非常好的和不断发展的 wiki 应用程序。我不确定 Web 服务链接，但有相当完整[的文档供开发人员](http://platform.xwiki.org/xwiki/bin/view/DevGuide/)使用和与 XWiki 交流。

编辑：我忘了说 XWiki 是在 LGPL 开源许可下。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T18:41:18.700

它是商业的，但是Atlassian 的[Confluence](http://www.atlassian.com/software/confluence/)有一个[很好的 API](http://confluence.atlassian.com/display/DOC/Remote+API+Specification)。

# c# - 使用 C# 进行套接字编程

> ID：436186
> 
> 赞同：2
> 
> 时间：2009-01-12T17:21:09.907
> 
> 标签：c#, sockets

我正在构建一个客户端/服务器应用程序来定期备份某些文件。基本上，客户端将监视某些文件的更改，并将它们上传到服务器。然后服务器将接收它们并使用递增的后缀保存它们。（即“ `filename_v1`”、“ `filename_v2`”等）。现在，我设法完成了大部分工作，但出现了一些问题，我找不到与它们相关的任何东西。

在我开始之前，请注意：

*   我尽力自己寻找解决方案。
*   我遵循（并完成了）几个套接字编程教程。
*   我不认识任何具有 c# 和/或套接字编程经验的人。

这是逻辑：

1.  服务器启动，开始监听。(开始接受)
2.  当客户端连接时，会创建一个“worker”套接字。
3.  工作套接字开始接收。(BeginReceive) / 客户端发送文件 (SendFile)
4.  接收到数据后，保存文件。（也检查早期版本，但在这里无关紧要。）
5.  goto 3.（我们需要从同一个客户端接收更多文件。）

步骤 1-4 工作得很好。

这就是问题所在：在第 5 步中，即使服务器没有收到任何内容，也会调用 onDataReceive(回调方法)，并且服务器发现自己处于无限循环中。我试图关闭（或断开）工作套接字，但没有机会。我开始怀疑我的算法可能有点草率。

无论如何，非常感谢任何意见、建议或帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-12T17:53:12.727

您的回调是否实现了 EndReceive？

你在传递一个状态对象吗？如果是这样，请将属性之一作为传递给 BeginReceive 的缓冲区，然后在回调中检查状态缓冲区以查看是否接收到任何数据。如果没有，请不要继续循环。

```
struct SocketStateObject
{
  public byte[] Buffer;
  public Socket Socket;
}

Socket mySocket = new Socket(...);
SocketStateObject state;
state.Buffer = new byte[1024];
state.Socket = mySocket;

socket.BeginReceive(state.Buffer, 0, state.Buffer.Length, 0, callback, state);

//don't remember the signature
public void callback(IAsyncResult a)
{
  if (((SocketStateObject)a.State).Buffer.Length = 0)
    //don't call socket.beginreceive again.
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T17:46:29.730

在过去一年左右的时间里，我在一个用于在 .NET 中传输医学图像的套接字库上做了一些工作。早期，我们很难检测套接字何时关闭，但最终找到了一个稳定的解决方案。

我们的应用程序正在使用 NetworkStream 对套接字进行读/写。我们有一个与您类似的线程，它在新连接到达时创建，用于向网络读取和写入数据。当数据到达或连接关闭时，我们调用下面的方法进行轮询。如果您不想轮询，可以调整该方法以使用更长的超时时间。当我们知道数据可用时，我们从 NetworkStream 对象中读取数据。

下面的关键点是套接字上的零字节发送，这似乎检测套接字何时关闭，如评论中所述。OnNetworkError 方法只是被调用来启动正在关闭的线程。

史蒂夫

```
 protected override bool NetworkHasData() 
{
    if (_socket == null)
        return false;

    // Tells the state of the connection as of the last activity on the socket
    if (!_socket.Connected)
    {
        OnNetworkError(null, true);
        return false;
    }

    // This is the recommended way to determine if a socket is still active, make a
    // zero byte send call, and see if an exception is thrown.  See the Socket.Connected
    // MSDN documentation.  Only do the check when we know there's no data available
    try
    {
        List readSockets = new List();
        readSockets.Add(_socket);
        Socket.Select(readSockets, null, null, 100000);
        if (readSockets.Count == 1)
        {
            if (_socket.Available > 0)
                return true;
            OnNetworkError(null, true);
            return false;
        }

        _socket.Send(new byte[1], 0, 0);
    }
    catch (SocketException e)
    {
        // 10035 == WSAEWOULDBLOCK
        if (!e.NativeErrorCode.Equals(10035))
            OnNetworkError(e, true);
    }

    return false;
} 

```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-12T17:47:02.040

我认为你应该看看WCF。当您可以使用可以轻松地通过网络传输字节数组的消息传递应用程序时，为什么要重新发明套接字编程的轮子呢？

WCF 将处理您的安全性、数据传输和当前尝试执行的所有管道。当然，要传输文件，您将被迫将消息大小设置为高于默认值......但我会认真考虑在重新编码轮子之前使用 WCF 制作原型。

我建议以下资源：

*   [WCF 中的流式处理示例](http://msdn.microsoft.com/en-us/library/ms751463.aspx)
*   [CodePlex 上的 WCF 文件传输](http://www.codeplex.com/WCFFileTransfer/)
*   [使用 WCF 传输大文件](http://garfoot.com/blog/computing/development/transferring-large-files-using-wcf/)

# perl - 如何按排序顺序读取目录中的文件？

> ID：436189
> 
> 赞同：8
> 
> 时间：2009-01-12T17:22:18.563
> 
> 标签：perl, directory, readdir, getdirectories

当我在 Perl 中使用`opendir`、`readdir`和读取目录时`closedir`，该`readdir`函数似乎没有以任何特定顺序读取文件（我可以说）。

我正在阅读一个目录，其中包含以纪元时间戳命名的子目录：

```
1224161460
1228324260
1229698140 
```

我想按数字顺序读取这些目录，这会将最旧的目录放在第一位。

当我使用`readdir`时，它读取的第一个是 1228324260，它是中间的。我知道我可以将目录内容放在一个数组中并对数组进行排序，但是我可以传递一个选项来`readdir`按排序顺序读取吗？或者也许比将所有内容推入数组并对数组进行排序更优雅的方式来实现这一点？可能也有模块可以做到这一点，但是很难在我们的环境中安装模块，所以除非它是一个内置模块，否则我宁愿不使用模块......

谢谢！

**编辑** 按要求，我发布了我正在使用的代码：

```
opendir( my $data_dh, $data_dir ) or die "Cannot open $data_dir\n";
while ( my $name = readdir($data_dh) ) {
    next if ( $name eq '.' or $name eq '..' );
    my $full_path = "${data_dir}/${name}";
    next unless ( -d $full_path );
    process_dir($full_path);
}
closedir($data_dh); 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-12T17:42:40.020

**readdir**可以在数组上下文中调用，所以只需这样做：

```
opendir( my $data_dh, $data_dir) or die "Cannot open $data_dir\n";
my @files = sort { $a <=> $b } readdir($data_dh);
while ( my $name = shift @files ) {
... 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-12T18:00:38.080

你可以用一点 Glob 魔法来尝试一下，glob 似乎以一种排序的方式运行，所以这个：

```
#  Glob in scalar context iterates the result set internally
while( defined( my $dir = glob($dir . '/*' ) ) ){ 
     print $dir, "\n";
    # $dir is fed ordered and with full names. 
} 
```

或者

```
# Glob in list context returns all results. 
for( glob($dir.'/*' ) ){ 
  print $dir , "\n";
  # also ordered. 
} 
```

应该管用。小心 glob，因为：

```
 for(0..20){ 
   printf "%30s|%30s\n", glob($dir.'/*' ), glob($dir.'/*' );
 } 
```

做了一些半神奇的事情，并在每行上打印 dir 内容两次。IE：

```
/foo/bar/a  |  /foo/bar/a
/foo/bar/b  |  /foo/bar/b
/foo/bar/c  |  /foo/bar/c
/foo/bar/d  |  /foo/bar/d 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-12T19:10:15.287

只需`sort`在要重新排序的任何列表运算符前面加上一个。您也不需要将结果存储在数组中。您可以使用`foreach`：

```
opendir my($dh), $dirname or die "Could not open directory [$dirname]: $!";

foreach my $file ( sort { $a <=> $b } readdir $dh )
    {
    ...
    } 
```

# python - Python 3 中 execfile 的替代方法是什么？

> ID：436198
> 
> 赞同：413
> 
> 时间：2009-01-12T17:23:36.283
> 
> 标签：python, python-3.x

似乎他们在 Python 3 中取消了通过删除快速加载脚本的所有简单方法`execfile()`

有没有我想念的明显替代方案？

* * *

## 回答 #1

> 赞同：462
> 
> 时间：2013-05-16T01:03:00.203

[根据文档](https://docs.python.org/3.3/whatsnew/3.0.html?highlight=execfile#builtins)，而不是

```
execfile("./filename") 
```

采用

```
exec(open("./filename").read()) 
```

看：

*   [Python 3.0 的新特性](http://docs.python.org/3.3/whatsnew/3.0.html?highlight=execfile#builtins)

* * *

## 回答 #2

> 赞同：235
> 
> 时间：2009-01-13T03:20:59.960

您应该自己阅读文件并执行代码。2to3 电流替换

```
execfile("somefile.py", global_vars, local_vars) 
```

作为

```
with open("somefile.py") as f:
    code = compile(f.read(), "somefile.py", 'exec')
    exec(code, global_vars, local_vars) 
```

（编译调用不是严格需要的，但它将文件名与代码对象相关联，使调试​​更容易一些。）

看：

*   [http://docs.python.org/release/2.7.3/library/functions.html#execfile](http://docs.python.org/release/2.7.3/library/functions.html#execfile)
*   [http://docs.python.org/release/3.2.3/library/functions.html#compile](http://docs.python.org/release/3.2.3/library/functions.html#compile)
*   [http://docs.python.org/release/3.2.3/library/functions.html#exec](http://docs.python.org/release/3.2.3/library/functions.html#exec)

* * *

## 回答 #3

> 赞同：83
> 
> 时间：2017-01-15T06:08:36.907

虽然`exec(open("filename").read())`通常作为 的替代品`execfile("filename")`，但它错过了`execfile`支持的重要细节。

Python3.x 的以下函数与直接执行文件的行为一样接近。那匹配运行`python /path/to/somefile.py`。

```
def execfile(filepath, globals=None, locals=None):
    if globals is None:
        globals = {}
    globals.update({
        "__file__": filepath,
        "__name__": "__main__",
    })
    with open(filepath, 'rb') as file:
        exec(compile(file.read(), filepath, 'exec'), globals, locals)

# execute the file
execfile("/path/to/somefile.py") 
```

**笔记：**

*   使用二进制读取来避免编码问题

*   保证关闭文件*（Python3.x 对此发出警告）*

*   定义`__main__`，一些脚本依赖于此来检查它们是否作为模块加载，例如。`if __name__ == "__main__"`

*   设置`__file__`对于异常消息更好，一些脚本用于`__file__`获取其他文件相对于它们的路径。

*   采用可选的全局变量和局部变量参数，就地修改它们`execfile`- 因此您可以访问通过在运行后读回变量定义的任何变量。

*   与 Python2 不同，默认情况下`execfile`它**不会**修改当前命名空间。为此，您必须明确传入`globals()`& `locals()`。

* * *

## 回答 #4

> 赞同：75
> 
> 时间：2014-06-17T10:06:15.690

正如最近[在 python-dev](https://mail.python.org/pipermail/python-dev/2014-June/134992.html)邮件列表中所建议的那样，[runpy](https://docs.python.org/3/library/runpy.html)模块可能是一个可行的替代方案。引用该消息：

> [https://docs.python.org/3/library/runpy.html#runpy.run_path](https://docs.python.org/3/library/runpy.html#runpy.run_path)
> 
> ```
> import runpy
> file_globals = runpy.run_path("file.py") 
> ```

有细微的差别`execfile`：

*   `run_path`总是创建一个新的命名空间。它将代码作为模块执行，因此全局变量和局部变量之间没有区别（这就是为什么只有一个`init_globals`参数）。全局变量被返回。

    `execfile`在当前命名空间或给定命名空间中执行。和的语义`locals`，`globals`如果给定的话，类似于类定义中的局部变量和全局变量。

*   `run_path`不仅可以执行文件，还可以执行egg和目录（详见其文档）。

* * *

## 回答 #5

> 赞同：22
> 
> 时间：2010-05-17T12:43:26.833

这个更好，因为它从调用者那里获取全局变量和本地变量：

```
import sys
def execfile(filename, globals=None, locals=None):
    if globals is None:
        globals = sys._getframe(1).f_globals
    if locals is None:
        locals = sys._getframe(1).f_locals
    with open(filename, "r") as fh:
        exec(fh.read()+"\n", globals, locals) 
```

* * *

## 回答 #6

> 赞同：16
> 
> 时间：2009-01-12T17:38:43.523

您可以编写自己的函数：

```
def xfile(afile, globalz=None, localz=None):
    with open(afile, "r") as fh:
        exec(fh.read(), globalz, localz) 
```

如果你真的需要...

* * *

## 回答 #7

> 赞同：14
> 
> 时间：2009-01-12T17:28:15.367

如果您要加载的脚本与您运行的脚本位于同一目录中，那么“导入”可能会完成这项工作吗？

如果需要动态导入代码，内置函数[__import__](http://docs.python.org/library/functions.html#__import__)和模块[imp](http://docs.python.org/library/imp.html)值得一看。

```
>>> import sys
>>> sys.path = ['/path/to/script'] + sys.path
>>> __import__('test')
<module 'test' from '/path/to/script/test.pyc'>
>>> __import__('test').run()
'Hello world!' 
```

测试.py：

```
def run():
        return "Hello world!" 
```

如果您使用的是 Python 3.1 或更高版本，您还应该查看[importlib](http://docs.python.org/release/3.1/library/importlib.html)。

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2014-10-07T13:39:03.413

这是我所拥有的（`file`在两个示例中都已分配给带有源代码的文件的路径）：

```
execfile(file) 
```

这是我替换它的内容：

```
exec(compile(open(file).read(), file, 'exec')) 
```

我最喜欢的部分：第二个版本在 Python 2 和 3 中都可以正常工作，这意味着不需要添加依赖于版本的逻辑。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2020-01-27T19:18:46.370

`exec()`如果可以，请避免。对于大多数应用程序，使用 Python 的导入系统会更干净。

此函数使用 built-in[`importlib`](https://docs.python.org/3/library/importlib.html)将文件作为实际模块执行：

```
from importlib import util

def load_file_as_module(name, location):
    spec = util.spec_from_file_location(name, location)
    module = util.module_from_spec(spec)
    spec.loader.exec_module(module)
    return module 
```

## 使用示例

让我们有一个文件`foo.py`：

```
def hello():
    return 'hi from module!'
print('imported from', __file__, 'as', __name__) 
```

并将其作为常规模块导入：

```
>>> mod = load_file_as_module('mymodule', './foo.py')
imported from /tmp/foo.py as mymodule
>>> mod.hello()
hi from module!
>>> type(mod)
<class 'module'> 
```

## 好处

这种方法不会污染名称空间或弄乱您的 while`$PATH`直接`exec()`在当前函数的上下文中运行代码，从而可能导致名称冲突。此外，模块属性如`__file__`和`__name__`将被正确设置，并保留代码位置。因此，如果您附加了调试器或模块引发异常，您将获得可用的回溯。

请注意，与静态导入的一个细微差别是，每次运行时都会导入（执行）模块`load_file_as_module()`，而不是像`import`关键字那样只导入一次。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2011-04-13T00:43:54.057

请注意，如果您使用不是 ascii 或 utf-8 的 PEP-263 编码声明，上述模式将失败。您需要找到数据的编码，并在将其交给 exec() 之前对其进行正确编码。

```
class python3Execfile(object):
    def _get_file_encoding(self, filename):
        with open(filename, 'rb') as fp:
            try:
                return tokenize.detect_encoding(fp.readline)[0]
            except SyntaxError:
                return "utf-8"

    def my_execfile(filename):
        globals['__file__'] = filename
        with open(filename, 'r', encoding=self._get_file_encoding(filename)) as fp:
            contents = fp.read()
        if not contents.endswith("\n"):
            # http://bugs.python.org/issue10204
            contents += "\n"
        exec(contents, globals, globals) 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2017-01-15T06:10:24.520

此外，虽然不是纯 Python 解决方案，但如果您使用的是 IPython（无论如何您可能应该这样做），您可以执行以下操作：

```
%run /path/to/filename.py 
```

这同样容易。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2017-02-11T23:23:28.423

我只是这里的新手，所以如果我发现这个可能是纯粹的运气：

尝试使用命令从解释器提示符 >>> 运行脚本后

```
 execfile('filename.py') 
```

为此我得到一个“NameError：名称'execfile'未定义”我尝试了一个非常基本的

```
 import filename 
```

它运作良好:-)

我希望这会有所帮助，并感谢大家的精彩提示、示例和所有那些对新手来说是一个很大的灵感的大师级注释代码片段！

我使用 Ubuntu 16.014 LTS x64。 *Linux 上的 Python 3.5.2（默认，2016 年 11 月 17 日，17:05:23）[GCC 5.4.0 20160609]*

# jquery - jQuery.dialog 不生成主题滚轮类？

> ID：436199
> 
> 赞同：0
> 
> 时间：2009-01-12T17:24:07.733
> 
> 标签：jquery, css, dialog

[JSBin 示例](http://jsbin.com/edeve)

使用 Firebug，您会注意到有关生成对话框的类的一些信息 - ui-widget 和/或 ui-state 完全不存在，但这些是 ThemeRoller 用来为 UI 元素着色的类！

是否有某种符合 ThemeRoller 的对话框生成器，甚至是在事后将正确的显示类破解到对话框中的脚本？

或者，因为我不打算让我的用户编辑他们自己的主题，我是否只需要做一些 jQuery 人员显然[为他们的演示](http://docs.jquery.com/UI/Dialog)所做的 CSS黑客操作，将颜色信息放入 ui.dialog.css 中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-13T13:52:48.297

查看另一个问题的[答案。](https://stackoverflow.com/questions/45600/a-problem-with-the-jquery-dialog-when-using-the-themeroller-css#177894)看起来灯丝组制作了他们自己的标准 jQuery 对话框版本，专门用于 jQuery UI 以与 themeroller 一起使用，而“标准”jQuery.dialog 将不起作用。

# netbeans - Netbeans 6.5 创建 GUI 时生成 lib 文件夹

> ID：436203
> 
> 赞同：0
> 
> 时间：2009-01-12T17:24:57.403
> 
> 标签：netbeans, jar, netbeans6.5

如何创建一个包含 lib 文件夹的 jar，以便我可以通过电子邮件发送单个 jar。因为如果我不包含 lib 文件夹和 jar 文件夹，jar 将无法工作。

我想将 lib 文件夹添加到主 jar 中，所以我只需要向某人发送一个 jar。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-13T14:34:28.540

我发现[这篇](http://blog.taragana.com/index.php/archive/apache-ant-how-to-include-multiple-jar-files-in-a-single-jar-file/)关于使用 Ant [jar 任务](http://ant.apache.org/manual/Tasks/jar.html)在 jar 中包含其他文件的文章：

> Ant Jar 任务实际上允许您包含多个**zipfileset**作为子元素。您可以使用 zipfileset 在您的（大）jar 文件中包含其他 jar（和 zip 文件）的内容。

如果这不起作用，您也可以使用[zip 任务](http://ant.apache.org/manual/Tasks/zip.html)来压缩文件夹和 jar。

# c++ - 如何修复 Webkit 错误？

> ID：436206
> 
> 赞同：5
> 
> 时间：2009-01-12T17:25:41.287
> 
> 标签：c++, open-source, webkit

Webkit 有一些错误会阻止我们的软件在此浏览器（和 Safari/Chrome/等）中运行。我们没有足够的 C++ 知识来自己修复错误，但我们当然愿意资助开发并对补丁进行广泛的测试。最好的方法是什么？

我正在考虑在 RentACoder 或[类似](http://www.geekpoint.net/internet-marketing/5886-70-alternatives-rentacoder.html)站点之一中提交每个错误的项目。哪个网站最适合这项特定工作？

大多数错误都与标准合规性有关，因此我希望 Safari 和 Chrome 会在 webkit 接受补丁后复制补丁。我能做些什么来加速这个过程吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-12T18:10:22.257

我认为贡献不需要 C++ 专业知识。

写一份详细的错误报告。创建一组全面的测试用例，并带有某种参考渲染。将所有这些放在网页上，然后在 WebKit 错误跟踪器上创建错误报告（或对现有报告进行评论）。

阅读更多关于[测试](http://webkit.org/quality/testwriting.html)的信息（等等，还有[更多](http://webkit.org/quality/reduction.html)），或者更多关于[报告错误](http://webkit.org/quality/reporting.html)的信息。

# c# - .NET 中的一切都是对象吗？

> ID：436211
> 
> 赞同：56
> 
> 时间：2009-01-12T17:27:18.677
> 
> 标签：c#, object

请帮助我们解决*“几乎”一切都是对象*的争议（[对 Stack Overflow 问题的回答*作为新手，在学习 C# 之前有什么需要注意的吗？*](https://stackoverflow.com/questions/436079/as-a-novice-is-there-anything-i-should-beware-of-before-learning-c#436092)）。我认为情况就是这样，因为 Visual Studio 中的所有内容至少都以结构的形式出现。请张贴参考，以免它变成“现代蠢货”（[This American Life](http://en.wikipedia.org/wiki/This_American_Life)）。

请注意，这个问题指的是 C#，不一定是 .NET，以及它如何处理后台数据（显然都是 1 和 0）。

以下是对“一切都是对象”的评论：

*   呃，不，不是。– 二元忧虑者
*   我想要一个例子... – scotty2012
*   不是所有东西都派生自基本类型 Object 吗？– 细雨
*   大多数东西都是对象...... – Omar Kooheji
*   值类型、整数、双精度、对象引用（不是它们本身的对象）等都不是对象。它们可以“装箱”以看起来像对象（egiToString()），但实际上它们是原始类型。将条目更改为“几乎所有事物都是对象”，我将删除反对票 – Binary Worrier
*   我很欣赏澄清。我认为您可以在 C# 中与之交互的最低级别（例如 int）是作为结构，而不是对象？- [http://msdn.microsoft.com/en-us/library/ms173109.aspx](http://msdn.microsoft.com/en-us/library/ms173109.aspx) – rizzle
*   Int32 不是继承自 Object 的 ValueType 吗？如果是这样，尽管有这种行为，但 int 是一个对象。——克里斯·法默
*   不，int 的装箱类型继承自 ValueType，ValueType 继承自 Object。它们不是传统意义上的对象，因为 a) int 不是对 int 的引用，它是 int。b）整数不是垃圾收集的。如果您声明一个 Int32，那么该 int 在堆栈上是 4 个字节，故事结束 – Binary Worrier

对象的定义：“对象”作为类 System.Object 的继承者，“对象”作为类型的实例，“对象”作为引用类型。

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2009-01-12T17:29:53.773

这里的问题是这实际上是两个问题——一个是关于继承的问题，在这种情况下答案是“几乎所有”，另一个是关于引用类型与值类型/内存/装箱的问题，在这种情况下答案是“否” ”。

**遗产：**

在 C# 中，以下是正确的：

*   所有值类型，包括枚举和可为空的类型，都派生自`System.Object`.
*   所有类、数组和委托类型都派生自`System.Object`.
*   接口类型不是从`System.Object`. 它们都可以转换为`System.Object`，但接口只派生自其他接口类型，而`System.Object`不是接口类型。
*   没有指针类型派生自`System.Object`，也不能直接转换为`System.Object`。
*   “开放”类型参数类型也不是从`System.Object`. 类型参数类型不是从任何东西派生的；类型参数被限制为从有效的基类派生，但它们本身不是从任何东西“派生”的。

从[System.Object 的 MSDN 条目](http://msdn.microsoft.com/en-us/library/system.object.aspx)：

> 支持 .NET Framework 类层次结构中的所有类，并为派生类提供低级服务。这是 .NET Framework 中所有类的终极基类；它是类型层次结构的根。
> 
> 语言通常不需要类来声明从 Object 的继承，因为继承是隐式的。
> 
> 因为 .NET Framework 中的所有类都派生自 Object，所以 Object 类中定义的每个方法在系统中的所有对象中都可用。派生类可以并且确实会覆盖其中一些方法。

因此，并非 C# 中的每种类型都派生自`System.Object`. 即使对于那些类型，您仍然需要注意[引用类型](http://msdn.microsoft.com/en-us/library/490f96s2.aspx)和[值类型](http://msdn.microsoft.com/en-us/library/s1ax56ch.aspx)之间的区别，因为它们的处理方式非常不同。

**拳击：**

虽然值类型确实*继承*自`System.Object`，但它们在内存中的处理方式与引用类型不同，并且它们如何通过代码中的方法传递的语义也不同。实际上，值类型不会被视为对象（引用类型），除非您通过将其装箱为引用类型来明确指示您的应用程序这样做。在此处查看[有关 C# 中的装箱的更多信息](http://msdn.microsoft.com/en-us/library/yz2be5wk.aspx)。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2009-08-13T11:51:57.413

聚会有点晚了，但我在 SO 的搜索结果中发现了这一点，并认为下面的链接会对后代有所帮助：

Eric Lippert[非常彻底地讨论了这一点](http://blogs.msdn.com/ericlippert/archive/2009/08/06/not-everything-derives-from-object.aspx)，并给出了一个更好（合格）的声明：

> 纠正这个神话的方法是简单地将“派生自”替换为“可转换为”，并忽略指针类型：C# 中的每个非指针类型都可以转换为对象。

如果您讨厌从编写编程语言的人那里阅读详细说明的解释，那么它的要点是（除了指针），接口或泛型参数类型声明（“T”）之类的东西不是对象，但保证是在运行时可被视为对象，因为它们有一个明确的实例，这将是一个对象。其他类型（类型、枚举、委托、类等）都是对象。包括值类型，正如其他答案所讨论的那样，可以将其装箱为对象。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-01-12T18:05:47.367

这里有些人对面向对象编程中的“对象”有一个奇怪的概念。为了使某物成为对象，它不必*是*引用类型，或者更一般地说，遵循任何正式的实现。

这意味着您可以在面向对象的世界中作为一等公民对其进行操作。由于您*可以*在 C# 中对值执行此操作（多亏了自动装箱），所以一切都确实是一个对象。在某种程度上，这甚至适用于函数（但可以说不适用于类）。

这在实践中是否相关是另一个问题，但这是我再次注意到的 OOP 的普遍问题。没有人对 OOP 的定义很清楚（是的，大多数人都同意它与多态性、继承和封装有关，有些人为了更好地衡量了“抽象”）。

从使用的角度来看，C# 中的每个值都像对象一样处理。也就是说，我喜欢当前接受的答案。它提供了两个技术上重要的方面。

请注意，在其他上下文中，例如 C++，强调其他方面，因为 C++ 不一定是面向对象的，而且更侧重于低级方面。因此，对象、POD 和内置原语之间的区别有时是有意义的（但有时又不是）。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-01-12T17:32:34.173

您将对象与值或引用混淆了。基本上，一切都是对象。Int 是一个对象，但它也是一个值类型。类实例是一个对象，但它也是一个引用类型。

方法不是对象，属性也不是。只是对对象进行操作。是的，几乎所有东西都继承自对象类。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-01-12T17:41:24.093

在 C#（以及一般的 OOP 中）中，我们有类型（类 - 引用、结构 - 值等）。这些是定义。而“对象”是给定类型的具体实例。

所以，如果我们从字面上理解这个问题，是的，当实例化时，一切都是对象。

混乱很可能始于对所有事物的基类名称的错误选择。在[.NET](http://en.wikipedia.org/wiki/.NET_Framework)中，这是 Object 类。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-01-12T17:40:45.407

它们都*被视为*对象，但它们并非都是对象。混淆来自自动装箱。

有关更多信息，请参见：[http ://en.wikipedia.org/wiki/Object_type](http://en.wikipedia.org/wiki/Object_type)

抽象显然使人们感到困惑。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-01-12T17:34:42.610

我认为值类型不是对象。它们通过 CLR 以不同的方式存储在内存中 - 值类型存储在堆栈中，而对象存储在堆中。您可以将值类型强制转换为引用类型以使它们像对象一样工作，但 CLR 从堆栈中取出值，将其包装在对象中，然后将其存储在堆中。这就是当你“装箱”一个变量时发生的事情。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-01-12T18:09:58.437

来自：[值类型（C# 参考）- MSDN 3.5](http://msdn.microsoft.com/en-us/library/s1ax56ch.aspx)

> 所有值类型都是从 System.ValueType 隐式派生的。

来自：[值类型类 - MSDN 3.5](http://msdn.microsoft.com/en-us/library/system.valuetype.aspx)

> ValueType 使用更合适的值类型实现覆盖来自 Object 的虚拟方法。

来自：[枚举类 - MSDN 3.5](http://msdn.microsoft.com/en-us/library/system.enum.aspx)

> 这个类继承自 ValueType

继承层次结构如下：

*   系统对象
    *   System.ValueType
        *   系统枚举

结论：**一切都是对象**

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-01-12T17:31:02.290

根据我读过的所有书籍，C# 中的一切都是对象。

有些是参考，有些是值类型。值类型对象继承自[ValueType](http://msdn.microsoft.com/en-us/library/system.valuetype.aspx)类。他们有不同的行为，但本质上是……对象。

这就是为什么您可以将 Int32 以及您可以在 .NET 中创建的所有内容存储在对象变量中的原因。

有关更多详细信息...请查看以下内容：http: [//msdn.microsoft.com/en-us/library/s1ax56ch (VS.71).aspx](http://msdn.microsoft.com/en-us/library/s1ax56ch(VS.71).aspx)

> 所有值类型都是从 Object 类隐式派生的。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-01-13T17:05:32.683

虽然每个人似乎都在关注值类型与引用类型的争论，但我们忘记了 C# 中的一种类型，它既不是引用也不是值，它不是从对象派生的，也不能强制转换为对象：**指针。**

与值和引用类型不同，指针不能转换为对象。

根据[关于 C# 指针类型的 MSDN 文档](http://msdn.microsoft.com/en-us/library/y31yhkeb(VS.80).aspx)，

> 指针类型不继承自对象，并且指针类型和对象之间不存在转换。此外，装箱和拆箱不支持指针。但是，您可以在不同的指针类型之间以及指针类型和整数类型之间进行转换。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-01-13T16:52:19.700

简短的回答：**不**。

答案取决于“对象”的定义。不同的语言对“对象”的含义有不同的定义，但 C# 的权威定义是官方的[C# 语言规范](https://github.com/dotnet/csharplang/blob/main/spec/types.md#types)：

> C# 语言的类型主要分为两大类：**引用类型**和**值类型**。(...) 值类型与引用类型的不同之处在于，值类型的变量直接包含它们的数据，而引用类型的变量存储对其数据的**引用**，后者被称为**对象**。

因此，根据 C#，对象是引用类型的实例。因此，值类型值不是对象。因此，在 C# 中一切都是对象是不正确的。

然而：

> C# 的类型系统是统一的，因此任何类型的值都可以被视为对象。(...) 值类型的值通过执行装箱和拆箱操作（第 9.3.12 节）被视为对象。

因此，可以通过装箱将值类型*视为*对象（有效地变成引用类型）。但是一个未装箱的值类型本身并不是一个对象。

[CLR 规范](https://www.ecma-international.org/publications/files/ECMA-ST/ECMA-335.pdf)[PDF] 使用与 C# 非常相似的定义：

> **object**：引用类型的实例。一个对象比价值更重要。一个对象是自键入的；它的类型显式地存储在它的表示中。它具有将其与所有其他对象区分开来的标识，并且它具有存储其他实体（可以是对象或值）的插槽。虽然可以更改其插槽的内容，但对象的身份永远不会改变。

因此，在 CLR 术语中，值类型值也不是对象。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-04-24T13:36:24.733

解决语义，当我们已经有一个非常好的、明确的术语时，为什么要重载“对象”这个词，使它意味着“引用类型”->“引用类型”，以及何时，通过重载“对象”这个词这样我们就造成了这个线程演示的混乱......即，所有类型（包括值类型）都继承了“System.Object”类型中定义的实现这一事实之间的不匹配。显然，这充其量是不必要的，最坏的情况是极其混乱。即使 MS 文档有时在这个问题上令人困惑这一事实也不能成为传播混乱的借口。

更简单、更清晰的是，只定义和使用术语“对象”来表示任何类型、值或引用的实例，并使用短语“引用类型”来描述使用指针变量并存储其状态的类型堆...

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-12T17:31:31.260

数字 2 不是一个对象。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-04-24T13:06:43.667

这是对两个世界的讨论：语言和记忆。

对我来说，语言就像一个抽象层，而术语对象属于这个抽象层。我认为在内存组织方面谈论对象没有意义，如果在谈论内存时确实使用“对象”术语，那么实际上是从不同的抽象层借用了这个术语。因此，您不应该忘记它的来源。

如果我们谈论的是 C#，我不明白为什么有人会使用内存组织作为论据。当然，如果我要向某人回答这个问题，我会说“是的，在 C# 中，一切都是对象，但你也应该知道，在引擎盖下，它可能会根据......而不同地工作。”

这可能会引发一个有趣的论点，但也可能会引起一些人的注意：在类似的讨论中，人们可能会说实际上没有面向对象的编程，只有过程编程。你的 CPU 理解对象吗？更好的是，实际上没有软件，只有不同的硬件状态:)

我的观点是，某些术语不会转化为其他抽象层，您应该将讨论集中在它所属的位置（在这种情况下是一种语言，而不是记忆）。

甚至这个问题的作者也说：“请注意，这个问题涉及 C# 不一定是 .NET 以及它如何处理后台数据（显然它都是 1 和 0。）”

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2009-01-12T17:31:16.453

值类型不是对象，它们遵循不同的复制语义、不同的传递语义，并且必须包装在一个类（对象）中才能被这样对待。

编辑：我认为这个论点有些模糊，因为你必须限定你所说的“对象”的意思。对象只是继承自 Object 的东西，还是遵循 Object 的使用语义的东西？还是我们在谈论对象的最一般定义，它是指可以包含数据和对该数据进行操作的任何东西？

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2009-01-13T12:46:47.650

考虑到问题是指 OOP 意义上的 Object，答案是：

从**技术**角度来看，答案是：**否**

从**教条**的角度来看，答案是：**是的**

解释：

从技术上讲，值类型（原语或结构）不是对象，除非是“装箱”形式，但是因为 .Net 通过装箱/拆箱（创建一个保存值的类实例和派生自 Object），这意味着值类型可以被视为对象和简单值。

所以值类型本质上是双重的，它们表现为**值**和**对象**。.Net 中的值在需要时是对象，而在其他情况下它们不是对象。

考虑到技术方面的正确答案是“.Net 中的一切都好**像它是**一个对象”。

教条的答案是“一切都是对象”。

* * *

## 回答 #17

> 赞同：-3
> 
> 时间：2020-08-08T20:55:35.760

有这么多不同答案的原因之一是这个问题非常不精确。“一切”是什么意思？它真的意味着每个 C# 语言元素吗？那么答案显然是“否”：运算符不是对象，“using”关键字不是对象，注释不是对象，等等。

但如果这不是本意，那又是什么意思呢？也许“除了那些显然不是类的东西之外的所有东西”？这显然没有帮助，因为不同的人对什么是“显而易见的”有不同的看法。尽管如此，大多数答案似乎都遵循这种自以为是的解释。

另一个混淆的来源是“对象”一词。什么是对象？这个术语没有唯一的通用定义，不同的人似乎以不同的方式使用它。C# 语言中唯一的正式定义是 System.Object 类型的定义，以及哪些其他类型派生自它，哪些不是。该文档很容易获得，并且不能说更多。

# documentation - 接手一个项目——我应该问以前的程序员什么？

> ID：436212
> 
> 赞同：56
> 
> 时间：2009-01-12T17:27:34.950
> 
> 标签：documentation, project

我正在接管一个商业网站的开发。该站点由另一位程序员开发了两年多。这主要是一项单人工作（维护和扩展站点）。当其他程序员向我展示系统时，我将有 2-3 天的过渡期。但据我所知，文档很少。一切都在代码中（有文档记录）。到目前为止，这是我打算问的问题：

*   解释系统中最复杂的元素
*   整体架构描述
*   支持工具的描述（IDE设置、单元测试、部署机制）
*   他用来影响系统架构的任何书籍、网站、播客

还有其他我想念的吗？

[编辑] 谢谢大家。失去好的建议。我希望我能接受多个答案！此外，我还要补充：

*   你具体做了什么来提高系统的性能，现在的瓶颈在哪里？
*   与此相关，您在系统安全方面做了哪些工作？（你做了什么，现在的安全漏洞在哪里）

最后一件事：开发人员说，如果我需要，他稍后会回答我的问题。毕竟是他的“宝贝”。但我真的认为，在 6 个月内他会继续前进，他的可用性会大大减少！

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2009-01-12T17:49:25.590

在看代码之前：

清除 objs 和 exes，让他/她重建东西。注意任何手动交互（它是通过“make”单独构建还是涉及一些摆弄）。

更好的是：给他/她一台裸机（刚买的），让他/她演示结帐并重建。然后看看应用程序是如何启动和出现的（输入的任何秘密选项？）。

然后：在结对编程会话中，向系统添加一个或两个功能，并查看这些功能在何处以及如何实现。

上面的内容可能听起来很愚蠢，但我看到过单独构建是一场噩梦的项目，很多知识只存在于开发人员的大脑中。没有可信的构建环境并且必须弄清楚如何重建是一个噩梦。

* * *

## 回答 #2

> 赞同：68
> 
> 时间：2009-01-12T17:37:11.950

请务必询问**Web 服务器、域注册商、数据库服务器、电子邮件服务器以及您能想到的任何其他内容的所有登录信息**。这听起来很疯狂，但开发人员通常会将自己注册为管理和技术联系人的域名。然后，如果无法联系到原始程序员，公司将不得不与注册商进行各种沟通，以收回域名。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-01-12T17:34:14.013

“如果你可以回去重新开发这个系统，你会做些什么不同”

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-01-12T17:31:44.707

问：a) 关于这个系统，你不想让我问你什么？b) 当你不再从事这个项目时，你最高兴的是什么？c) 系统的哪些部分过于复杂而无法记录？

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2009-01-12T17:32:05.143

他的电话。

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2009-01-12T23:32:38.877

谁是您的专家用户——我应该寻求或信任谁的意见？

谁是你的危险非专家用户——我应该听谁的，然后主动忽略？

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2009-01-12T17:31:53.613

*   已知^(1 个)问题
*   已知¹个改进领域
*   现有代码覆盖率数据、测试通过率等用作基线
*   故障排除提示（了解日志文件、调试崩溃、常见问题）
*   配置参数说明

¹只有他或她知道

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2009-01-12T17:36:14.197

系统要求的周期性“手工工作”是什么？

你知道，那些经常出现但尚未自动化的小工作。您如何修复它以及如何识别它。

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2009-01-12T17:36:21.747

询问*真正的*要求是什么。大多数项目要么没有书面要求，要么没有过时的书面要求。真正的文档通常是口头对话。找出与谁交谈。如果您有来自不同用户的相互冲突的要求，请找出最重要的让您开心的人。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2009-01-12T17:36:26.273

在接管一个项目时，我通常会问的第一个问题是如何让它脱离源代码控制（基本上，“它在哪里？”）。除此之外，我认为你已经达到了所有的高点。

> IDE设置、单元测试、部署机制

可能是您可以询问的最重要的事情。

在询问哪些网站影响了您接管的网站时，请确保您获得了链接列表。我发现很多开发人员都会为他们采样的网站保留书签。确保你得到那些。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2009-01-12T18:34:19.947

确保您可以构建和发布它。

缺少信息的问题太多了。

你需要知道所有辅助的东西。

获得一台新机器并确保您可以复制构建和发布。

编辑：在那之后它将是：“你一直想要修复但没有得到并且没有记录在任何地方的所有事情是什么”？

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-01-12T17:36:09.907

不要问。把他锁在一个房间里——告诉他在他从头开始之前不会得到食物或水，并告诉你他所知道的关于这个系统的一切。然后在相关问题出现时提出相关问题。在此之后 - 花几天时间查看代码。然后重复这个过程。这样做直到您对系统感到满意为止。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-01-12T17:40:56.293

*   如何在全新的服务器上安装站点。
*   该网站的功能和用途。
*   使用什么数据库以及它们在哪里。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-01-12T17:44:37.893

确保获得应用程序的所有“陷阱”。它们通常是太小或太古怪而无法拥有正式文档的数据或业务项目，但如果您不知道发生了什么，最终会产生重大影响或大量调试时间。

例如，在我目前维护的一个应用程序中，我们与具有“Web 查看器”类型客户端的第三方系统交互。与此有关的“问题”是 Web 查看器无法正确维护用户的会话状态（在更新到最新版本以修复其他关键问题时损坏）。因此，我不得不时不时提醒用户，把浏览器窗口最小化，这样超时自然会发生，否则他们会被锁定很长一段时间，直到周围的运维人员安装更新版本.

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2009-01-12T18:31:40.530

该网站遇到的最大问题是什么以及如何解决？尝试修复一些根本没有意义的东西太容易了，只是发现看似荒谬的东西实际上是一些微妙但令人讨厌的错误的唯一修复。

浏览代码并查看所有看起来难以理解的内容，然后问“这是做什么的，为什么要添加它？”

**确保你写下他们的回复**——甚至可以在代码中评论他们，以便他们在你需要的时候出现。*没有什么比“我知道*有人告诉我这件事……”的感觉更令人讨厌了。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2009-01-12T19:26:06.690

以及技术性的东西（这很容易弄清楚:)）了解业务规则！这些很少被正确记录（根据我的经验），并且您通常只会在出现问题时才发现困难的方法。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2009-01-12T23:10:58.233

2 到 3 天的交接时间听起来很短，所以不要害怕要求更多。

首先获得一个可以在本地运行的源代码控制、ide、构建和发布步骤的工作本地环境。

然后尝试通过简要了解代码质量来获得印象。如果它看起来很糟糕，那么您可能不会从您的前任那里获得太多关于实施的有用信息。

但是，应检查有关部署、数据库服务器、备份策略、注册等的所有内容。还有库等的所有许可证以及最常见错误的列表（如果他们有错误跟踪工具，这可能很有用）

此外，您还需要了解您的前任有多大帮助，因为我已经看到了几种移交形式，其中移交的人很友好，但会误导他们以问卷的形式对他们提出的问题做出讽刺性的回答（虽然有趣但不专业）只是不感兴趣。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2009-01-12T17:35:06.523

看代码 5 分钟是最好的开始，如果代码的组织和注释真的很好，可能根本没有任何理由和他交谈。

如果代码很丑陋，那么不要指望他有什么聪明的理由为什么他一起破解了一些东西，充其量你可以用他作为一些肮脏代码的参考并询问目的是什么。

无论哪种方式，与过去的开发人员交谈都是最没用的事情，因为无论哪种方式，你现在都被它困住了。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2009-01-12T18:45:05.370

仔细审查申请并尝试首先弄清楚。**然后带着问题**进入你的会议，最重要的是，**上下文**。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2009-01-13T14:52:56.820

你一直在同一家公司工作吗？
如果不是，这与项目没有直接关系，但我会问他为什么要离开。它可能会让您对所涉及的政治有所了解，或者是否有任何事情困扰他与它或与客户一起工作。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2009-01-12T19:41:47.923

询问原始开发人员遇到的任何障碍或解决方法。

同时了解您的客户。他们挑剔吗？他们期待什么？

# python - 如何确定文本的编码？

> ID：436220
> 
> 赞同：270
> 
> 时间：2009-01-12T17:30:27.063
> 
> 标签：python, encoding, text-files

我收到了一些经过编码的文本，但我不知道使用了什么字符集。有没有办法使用 Python 确定文本文件的编码？[如何检测](https://stackoverflow.com/questions/90838/how-can-i-detect-the-encoding-codepage-of-a-text-file)处理 C# 的文本文件的编码/代码页。

* * *

## 回答 #1

> 赞同：255
> 
> 时间：2009-01-12T17:45:32.150

编辑：chardet 似乎无人管理，但大多数答案都适用。检查[https://pypi.org/project/charset-normalizer/](https://pypi.org/project/charset-normalizer/)以获取替代方案

始终正确检测编码是**不可能**的。

（来自chardet常见问题解答：）

> 但是，某些编码针对特定语言进行了优化，并且语言不是随机的。一些字符序列一直弹出，而其他序列则毫无意义。一个英语流利的人打开报纸发现“txzqJv 2!dasd0a QqdKjvz”会立即认出那不是英语（即使它完全由英文字母组成）。通过研究大量“典型”文本，计算机算法可以模拟这种流利程度，并对文本的语言做出有根据的猜测。

有使用该研究来尝试检测编码的[chardet库。](http://pypi.python.org/pypi/chardet)chardet 是 Mozilla 中自动检测代码的一个端口。

您也可以使用[UnicodeDammit](https://www.crummy.com/software/BeautifulSoup/bs4/doc/#unicode-dammit)。它将尝试以下方法：

*   在文档本身中发现的编码：例如，在 XML 声明或（对于 HTML 文档）http-equiv META 标记中。如果 Beautiful Soup 在文档中发现这种编码，它会重新从头开始解析文档并尝试新的编码。唯一的例外是，如果您明确指定了编码，并且该编码确实有效：那么它将忽略它在文档中找到的任何编码。
*   通过查看文件的前几个字节来嗅探的编码。如果在此阶段检测到编码，它将是 UTF-* 编码、EBCDIC 或 ASCII 之一。
*   [chardet](http://pypi.python.org/pypi/chardet)库嗅探到的编码，如果您安装了它。
*   UTF-8
*   Windows-1252

* * *

## 回答 #2

> 赞同：86
> 
> 时间：2013-04-24T23:10:05.357

计算编码的另一个选择是使用 [libmagic （这是](http://linux.die.net/man/3/libmagic)[file](http://linux.die.net/man/1/file)命令背后的代码 ）。有大量可用的 python 绑定。

文件源树中的 python 绑定可作为 [python-magic](http://packages.debian.org/search?keywords=python-magic&searchon=names&suite=all&section=all)（或[python3-magic](http://packages.debian.org/search?keywords=python3-magic&searchon=names&suite=all&section=all)） debian 包使用。它可以通过执行以下操作来确定文件的编码：

```
import magic

blob = open('unknown-file', 'rb').read()
m = magic.open(magic.MAGIC_MIME_ENCODING)
m.load()
encoding = m.buffer(blob)  # "utf-8" "us-ascii" etc 
```

pypi 上有一个同名但不兼容的[python-magic](https://pypi.python.org/pypi/python-magic) pip 包，它也使用`libmagic`. 它还可以通过以下方式获取编码：

```
import magic

blob = open('unknown-file', 'rb').read()
m = magic.Magic(mime_encoding=True)
encoding = m.from_buffer(blob) 
```

* * *

## 回答 #3

> 赞同：38
> 
> 时间：2013-02-06T16:32:05.440

一些编码策略，请取消注释以品尝：

```
#!/bin/bash
#
tmpfile=$1
echo '-- info about file file ........'
file -i $tmpfile
enca -g $tmpfile
echo 'recoding ........'
#iconv -f iso-8859-2 -t utf-8 back_test.xml > $tmpfile
#enca -x utf-8 $tmpfile
#enca -g $tmpfile
recode CP1250..UTF-8 $tmpfile 
```

您可能希望通过以循环的形式打开和读取文件来检查编码......但您可能需要先检查文件大小：

```
# PYTHON
encodings = ['utf-8', 'windows-1250', 'windows-1252'] # add more
for e in encodings:
    try:
        fh = codecs.open('file.txt', 'r', encoding=e)
        fh.readlines()
        fh.seek(0)
    except UnicodeDecodeError:
        print('got unicode error with %s , trying different encoding' % e)
    else:
        print('opening the file with encoding:  %s ' % e)
        break 
```

* * *

## 回答 #4

> 赞同：32
> 
> 时间：2017-07-18T13:01:49.330

这是一个读取和获取`chardet`编码预测的示例，`n_lines`如果文件很大，则从文件中读取。

`chardet`还为您提供`confidence`了它的编码预测概率（即`chardet.predict()`

```
def predict_encoding(file_path, n_lines=20):
    '''Predict a file's encoding using chardet'''
    import chardet

    # Open the file as binary data
    with open(file_path, 'rb') as f:
        # Join binary lines for specified number of lines
        rawdata = b''.join([f.readline() for _ in range(n_lines)])

    return chardet.detect(rawdata)['encoding'] 
```

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2020-03-25T23:40:20.323

这可能会有所帮助

```
from bs4 import UnicodeDammit
with open('automate_data/billboard.csv', 'rb') as file:
   content = file.read()

suggestion = UnicodeDammit(content)
suggestion.original_encoding
#'iso-8859-1' 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2017-05-31T22:22:56.600

```
# Function: OpenRead(file)

# A text file can be encoded using:
#   (1) The default operating system code page, Or
#   (2) utf8 with a BOM header
#
#  If a text file is encoded with utf8, and does not have a BOM header,
#  the user can manually add a BOM header to the text file
#  using a text editor such as notepad++, and rerun the python script,
#  otherwise the file is read as a codepage file with the 
#  invalid codepage characters removed

import sys
if int(sys.version[0]) != 3:
    print('Aborted: Python 3.x required')
    sys.exit(1)

def bomType(file):
    """
    returns file encoding string for open() function

    EXAMPLE:
        bom = bomtype(file)
        open(file, encoding=bom, errors='ignore')
    """

    f = open(file, 'rb')
    b = f.read(4)
    f.close()

    if (b[0:3] == b'\xef\xbb\xbf'):
        return "utf8"

    # Python automatically detects endianess if utf-16 bom is present
    # write endianess generally determined by endianess of CPU
    if ((b[0:2] == b'\xfe\xff') or (b[0:2] == b'\xff\xfe')):
        return "utf16"

    if ((b[0:5] == b'\xfe\xff\x00\x00') 
              or (b[0:5] == b'\x00\x00\xff\xfe')):
        return "utf32"

    # If BOM is not provided, then assume its the codepage
    #     used by your operating system
    return "cp1252"
    # For the United States its: cp1252

def OpenRead(file):
    bom = bomType(file)
    return open(file, 'r', encoding=bom, errors='ignore')

#######################
# Testing it
#######################
fout = open("myfile1.txt", "w", encoding="cp1252")
fout.write("* hi there (cp1252)")
fout.close()

fout = open("myfile2.txt", "w", encoding="utf8")
fout.write("\u2022 hi there (utf8)")
fout.close()

# this case is still treated like codepage cp1252
#   (User responsible for making sure that all utf8 files
#   have a BOM header)
fout = open("badboy.txt", "wb")
fout.write(b"hi there.  barf(\x81\x8D\x90\x9D)")
fout.close()

# Read Example file with Bom Detection
fin = OpenRead("myfile1.txt")
L = fin.readline()
print(L)
fin.close()

# Read Example file with Bom Detection
fin = OpenRead("myfile2.txt")
L =fin.readline() 
print(L) #requires QtConsole to view, Cmd.exe is cp1252
fin.close()

# Read CP1252 with a few undefined chars without barfing
fin = OpenRead("badboy.txt")
L =fin.readline() 
print(L)
fin.close()

# Check that bad characters are still in badboy codepage file
fin = open("badboy.txt", "rb")
fin.read(20)
fin.close() 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-12T17:32:27.840

在一般情况下，原则上不可能确定文本文件的编码。所以不，没有标准的 Python 库可以为您做到这一点。

如果您对文本文件有更具体的了解（例如，它是 XML），则可能有库函数。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2017-06-22T16:39:12.773

根据您的平台，我只选择使用 linux shell`file`命令。这对我有用，因为我在一个专门在我们的一台 linux 机器上运行的脚本中使用它。

显然这不是一个理想的解决方案或答案，但可以对其进行修改以满足您的需求。就我而言，我只需要确定文件是否为 UTF-8。

```
import subprocess
file_cmd = ['file', 'test.txt']
p = subprocess.Popen(file_cmd, stdout=subprocess.PIPE)
cmd_output = p.stdout.readlines()
# x will begin with the file type output as is observed using 'file' command
x = cmd_output[0].split(": ")[1]
return x.startswith('UTF-8') 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2021-08-08T13:36:36.617

如果您对自动工具不满意，您可以尝试所有编解码器并手动查看哪个编解码器是正确的。

```
all_codecs = ['ascii', 'big5', 'big5hkscs', 'cp037', 'cp273', 'cp424', 'cp437', 
'cp500', 'cp720', 'cp737', 'cp775', 'cp850', 'cp852', 'cp855', 'cp856', 'cp857', 
'cp858', 'cp860', 'cp861', 'cp862', 'cp863', 'cp864', 'cp865', 'cp866', 'cp869', 
'cp874', 'cp875', 'cp932', 'cp949', 'cp950', 'cp1006', 'cp1026', 'cp1125', 
'cp1140', 'cp1250', 'cp1251', 'cp1252', 'cp1253', 'cp1254', 'cp1255', 'cp1256', 
'cp1257', 'cp1258', 'euc_jp', 'euc_jis_2004', 'euc_jisx0213', 'euc_kr', 
'gb2312', 'gbk', 'gb18030', 'hz', 'iso2022_jp', 'iso2022_jp_1', 'iso2022_jp_2', 
'iso2022_jp_2004', 'iso2022_jp_3', 'iso2022_jp_ext', 'iso2022_kr', 'latin_1', 
'iso8859_2', 'iso8859_3', 'iso8859_4', 'iso8859_5', 'iso8859_6', 'iso8859_7', 
'iso8859_8', 'iso8859_9', 'iso8859_10', 'iso8859_11', 'iso8859_13', 
'iso8859_14', 'iso8859_15', 'iso8859_16', 'johab', 'koi8_r', 'koi8_t', 'koi8_u', 
'kz1048', 'mac_cyrillic', 'mac_greek', 'mac_iceland', 'mac_latin2', 'mac_roman', 
'mac_turkish', 'ptcp154', 'shift_jis', 'shift_jis_2004', 'shift_jisx0213', 
'utf_32', 'utf_32_be', 'utf_32_le', 'utf_16', 'utf_16_be', 'utf_16_le', 'utf_7', 
'utf_8', 'utf_8_sig']

def find_codec(text):
    for i in all_codecs:
        for j in all_codecs:
            try:
                print(i, "to", j, text.encode(i).decode(j))
            except:
                pass

find_codec("The example string which includes ö, ü, or ÄŸ, Ã¶") 
```

此脚本至少创建 9409 行输出。因此，如果输出不适合终端屏幕，请尝试将输出写入文本文件。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-12T17:36:42.043

如果您知道文件的某些内容，您可以尝试使用多种编码对其进行解码，然后查看丢失的内容。一般来说，没有办法，因为文本文件是文本文件，而且这些文件很愚蠢；）

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2019-04-12T14:10:16.597

该站点有用于识别 ascii、使用 bom 编码和 utf8 无 bom 的 python 代码： [https](https://unicodebook.readthedocs.io/guess_encoding.html) ://unicodebook.readthedocs.io/guess_encoding.html 。将文件读入字节数组（数据）： http: [//www.codecodex.com/wiki/Read_a_file_into_a_byte_array](http://www.codecodex.com/wiki/Read_a_file_into_a_byte_array)。这是一个例子。我在osx。

```
#!/usr/bin/python                                                                                                  

import sys

def isUTF8(data):
    try:
        decoded = data.decode('UTF-8')
    except UnicodeDecodeError:
        return False
    else:
        for ch in decoded:
            if 0xD800 <= ord(ch) <= 0xDFFF:
                return False
        return True

def get_bytes_from_file(filename):
    return open(filename, "rb").read()

filename = sys.argv[1]
data = get_bytes_from_file(filename)
result = isUTF8(data)
print(result)

PS /Users/js> ./isutf8.py hi.txt                                                                                     
True 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-05-06T14:59:27.183

使用 linux`file -i` 命令

```
import subprocess

file = "path/to/file/file.txt"

encoding =  subprocess.Popen("file -bi "+file, shell=True, stdout=subprocess.PIPE).stdout

encoding = re.sub(r"(\\n)[^a-z0-9\-]", "", str(encoding.read()).split("=")[1], flags=re.IGNORECASE)

print(encoding) 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-05-27T10:30:32.063

您可以使用不将整个文件加载到内存的`python-magic 包：

```
import magic

def detect(
    file_path,
):
    return magic.Magic(
        mime_encoding=True,
    ).from_file(file_path) 
```

输出是编码名称，例如：

*   iso-8859-1
*   美国ASCII码
*   UTF-8

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-06-28T08:53:29.923

您可以使用 chardet 模块

```
import chardet

with open (filepath , "rb") as f:
    data= f.read()
    encode=chardet.UniversalDetector()
    encode.close()
    print(encode.result) 
```

或者您可以在 linux 中使用 chardet3 命令，但这需要一些时间：

```
chardet3 fileName 
```

例子 ：

```
chardet3 donnee/dir/donnee.csv
donnee/dir/donnee.csv: ISO-8859-1 with confidence 0.73 
```

# javascript - 面向对象的javascript中成员变量的最佳方法？

> ID：436234
> 
> 赞同：14
> 
> 时间：2009-01-12T17:32:39.713
> 
> 标签：javascript

这是我刚刚发布的一个问题的后续。我想知道你们在使用 MyClass.prototype 定义方法时如何处理 javascript 类中的成员变量。

如果在构造函数中定义所有方法：

```
function MyClass(){
 this.myMethod = function(){}
} 
```

您可以很好地声明成员变量并从您的方法内部访问它们：

```
function MyClass(){
 var myVar = "hello";
 this.myMethod = function(){
  alert(myVar);
 }
} 
```

使用 Object.prototype 技术时，您会失去这种精细，并且必须这样做；

```
function MyClass(){}
MyClass.prototype.myVar = "hello";
MyClass.prototype.myMethod = function(){alert(this.hello)}; 
```

我对每次访问成员变量时都必须写“this”并不感到疯狂。出于内存和灵活性的原因，我想使用 Object.prototype 方法，但它在语法方面似乎更笨拙。你们一般都是这样工作的吗？

谢谢，

-摩根

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-01-12T17:39:53.083

您应该克服对使用`this`指针访问成员变量的反感。

在构造函数中赋值成员变量，你可以通过原型方法访问它们：

```
function Cat(){
    this.legs = 4;
    this.temperament = 'Apathetic';
    this.sound = 'Meow';
}

Cat.prototype.speak = function(){alert(this.sound)}

var cat = new Cat();
cat.speak(); 
```

是的，这些对象属性是公开的，但正如 Guido 所说，我们在这里都是成年人。毕竟，Javascript 是一种纯文本、松散类型的解释语言。在这种环境中，“私有”变量的好处充其量是不稳定的。

我说的是应该如何访问你的对象的明确和明显的，违反者将自担风险偏离它。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-01-12T18:35:41.817

对象属性的可见性因您声明它们的方式而异

```
function Cat( name ) {

    //private variable unique to each instance of Cat
    var privateName = 'Cat_'+Math.floor( Math.random() * 100 );

    //public variable unique to each instance of Cat
    this.givenName = name;

    //this method has access to private variables
    this.sayPrivateName = function() {
        alert( privateName );
    }
}

//this variable is shared by all cats
Cat.prototype.generalName = 'tiddles';

//this method is shared by all cats and has no access to private vars
Cat.prototype.sayname = function( type ) {
    alert( this[type+'Name'] || 'private!' );
}

var vic = new Cat('Victor');
var ellers = new Cat('Elmore');

vic.sayname('general');    //tiddles
vic.sayname('given');      //Victor
vic.sayname('private');    //private - no access
vic.sayPrivateName();      //cat will say its name

ellers.sayname('general');    //tiddles
ellers.sayname('given');      //Elmore
ellers.sayname('private');    //private - no access
ellers.sayPrivateName();      //cat will say its name 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-12T17:35:22.997

您应该使用原型来存储方法，因为当您发现自己有 100 个方法时，它们不会在实例之间复制，而是使用相同的原型。我使用这些方面的东西：

```
var myClass = function(){};
myClass.prototype = {
    method1: function(){}
    ,method2: function(){}   
}; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-13T10:27:08.447

将方法分配给原型时，对“私有”变量的一个（不是那么）小评论：

确实，您不能使用构造函数对其变量创建闭包，但您当然可以用匿名函数包围原型方法，并在对象实例之间共享私有变量：

```
function Foo() {}

(function() {
    var sharedPrivateVar;
    Foo.prototype.methodWithAccessToSharedPrivateVar = function() {};
})(); 
```

通过一些进一步的操作，您可以实现自己的保护机制，例如只能读取的变量，不能通过以下方式写入：

```
function Foo() {
    this.registerInstance({ bar : 'baz' });
    this.registerInstance = undefined;
}

(function() {
    var store = {}, guid = 0;

    Foo.prototype.registerInstance = function(protectedProperties) {
        this.__guid = ++guid;
        store[this.__guid] = protectedProperties;
    };

    Foo.prototype.getProtectedProperty = function(name) {
        return store[this.__guid][name];
    };

})(); 
```

这种方法不会受到大量函数对象和闭包创建的影响，但会少量增加查找时间。

**编辑：**您还应该提供一个功能

```
Foo.prototype.unregisterInstance = function() {
    delete store[this.__guid];
}; 
```

否则，这是引入内存泄漏的好方法......

**Edit2：**您还可以`registerInstance()`通过以下模式解决对函数的需求：

```
Foo = (function() {
    var store = {}, guid = 0;

    function Foo() {
        this.__guid = ++guid;
        store[guid] = { bar : 'baz' };
    }

    Foo.prototype.getBar = function() {
        var privates = store[this.__guid];
        return privates.bar;
    };

    Foo.prototype.destroy = function() {
        delete store[this.__guid];
    };

    return Foo;
})(); 
```

# sharepoint - Microsoft Office Web Components IE 安全问题

> ID：436235
> 
> 赞同：0
> 
> 时间：2009-01-12T17:32:52.050
> 
> 标签：sharepoint, internet-explorer, ms-office, components, web-parts

我在我的 Sharepoint 站点上显示 Microsoft Office Web 组件（Microsoft 数据访问控制）。客户端需要在 IE 中启用“跨域访问数据源”才能查看页面。不幸的是，客户端无法修改其 IE 设置。无论如何我可以让这些组件显示吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-12T18:54:28.300

**通常，使用 IE 将 SharePoint 站点注册为受信任站点**（或**本地 Intranet**站点）就足够了。

您可能需要说服客户端管理员添加相应的域策略。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T19:03:22.027

不是这些组件，您可以尝试使用其他方式显示数据，而不是使用 Web 组件。但是，您可以查看用户计算机是否可以通过将更改 IE 设置的组策略进行更新。在下面的文章中显示可以启用它（有提示）： [http://support.microsoft.com/kb/833633](http://support.microsoft.com/kb/833633) - 如何加强 Internet Explorer 中本地计算机区域的安全设置

# c# - 通过附加属性获取列表框项索引

> ID：436236
> 
> 赞同：1
> 
> 时间：2009-01-12T17:33:02.863
> 
> 标签：c#, wpf

使用[此帖子](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/fbe80312-67aa-42ca-bd99-89b6d79e06ae/)作为参考，我试图通过实现附加属性来显示列表框项的索引。我将是第一个承认我并不完全了解附加属性将如何解决此问题的人，但我希望在成功实施解决方案后它会变得清晰。在这个问题上花费了无数个小时之后，无论是否通过附属财产，我都在寻求一点帮助。此时，它使用默认字符串（“Default”），但似乎并未评估其他函数。这是我到目前为止所拥有的：

在 WPF 中：

```
<TextBlock Text="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type ListBoxItem}},
                                                Mode=OneWay, 
                                                Path=(Silhouette_Controls_ThumbnailListbox:ListBoxItemIndex.ItemIndex)}"
                                       TextAlignment="Center"
                                       VerticalAlignment="Bottom" 
                                       HorizontalAlignment="Center" /> 
```

C# 中的依赖属性类

```
public class ListBoxItemIndex : DependencyObject
    {
        public static readonly DependencyProperty ItemIndexProperty = 
            DependencyProperty.RegisterAttached(
                "ItemIndex",
                typeof(string),
                typeof(ListBoxItemIndex),
                new PropertyMetadata("Default", new PropertyChangedCallback(OnItemIndexChanged)));

        public static string GetItemIndex(DependencyObject element)
        {
            return (string)element.GetValue(ItemIndexProperty);
        }

        public static void SetItemIndex(DependencyObject element, string value)
        {
            element.SetValue(ItemIndexProperty, value);
        }

        private static void OnItemIndexChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
        {
            ListBoxItem item = d as ListBoxItem;

            ListBox view = ItemsControl.ItemsControlFromItemContainer(item) as ListBox;

            int index = view.ItemContainerGenerator.IndexFromContainer(item);
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-13T19:59:08.277

在这种情况下，我认为附加财产不会对您有所帮助。您的附加属性将始终具有“默认”值，因为我认为您没有将属性设置为其他值。只有在通过绑定或直接在 XAML 或代码中修改了 ItemIndex 属性时，才会调用 OnItemIndexChanged。

我会以与您在上面发布的链接相同的方式使用值转换器。

MSDN 有一个关于创建值转换器的示例：http: [//msdn.microsoft.com/en-us/library/system.windows.data.ivalueconverter.aspx](http://msdn.microsoft.com/en-us/library/system.windows.data.ivalueconverter.aspx)

# sql-server - SQL Server 2k5 - 没有日志文件的数据库备份

> ID：436243
> 
> 赞同：0
> 
> 时间：2009-01-12T17:34:22.733
> 
> 标签：sql-server, log-files

日志文件通常很大而且很笨重。有没有办法“备份”没有任何日志文件（或空日志文件）的 SQL Server 数据库？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-30T16:32:37.287

部分日志实际上包含在备份中。这是您在还原时获得一致性的方式。从日志（或记录的更改）中获取备份运行时更改的页面，然后在还原过程结束时应用这些页面。

您无法解决这个问题，但您可以限制 SQL Server 的日志记录量。您可以通过将数据库置于简单模式来执行此操作，但如果您这样做，请了解您无法恢复到有人在

```
delete myTable 
```

并忘记了 WHERE 子句。您只能从完整备份中恢复。

您要做的是定期备份数据库（使用 BACKUP DATABASE 命令），并且更频繁地运行 BACKUP LOG 命令。通常人们每晚对小型数据库进行一次完整备份，然后每小时进行一次日志备份。假设您保留所有这些备份文件，这允许您恢复到一天中的任何时间点。

它还管理日志文件大小，因为 BACKUP LOG 命令释放日志文件中的空间以供重用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-12T19:24:38.283

就在您进行完整数据库备份之前，执行：

```
BACKUP LOG databasename WITH TRUNCATE_ONLY 
```

之前这样做的原因是将来的日志备份仍将保持时间点一致性。这样，您将始终拥有一个有效的链（无论如何，从这个完整备份开始 - TRUNCATE 将阻止您进行时间点恢复，因为无论何时您上次的日志备份是，尽管您所有的仅数据备份都会仍然有效）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-12T20:32:39.817

对不起，但你的问题没有意义。

当您备份数据库时，您从数据文件（MDF 和 NDF）而*不是文件中备份数据**页*。然后，引擎会附加备份期间发生的任何更改（来自日志*条目）。*

 **使用 BACKUP LOG 备份日志条目（*不是文件）。*如果数据库具有简单恢复模型，则不需要这样做。

当您恢复数据库时，它会在磁盘上重新创建文件。你是这个意思吗？

日志文件本身对于所有 RDBMS 的工作方式是绝对必要的。

这里唯一的问题是如何在 BCP/DR 策略的上下文中备份/恢复它们。

# webserver - 卡西尼源代码下载链接？

> ID：436250
> 
> 赞同：4
> 
> 时间：2009-01-12T17:35:28.397
> 
> 标签：webserver, cassini

有谁知道从哪里可以下载卡西尼的源代码。我尝试了链接[http://www.asp.net/Projects/Cassini/Download](http://www.asp.net/Projects/Cassini/Download)但该页面现在不存在。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-12T17:44:26.397

[您可以在此处](http://blogs.msdn.com/dmitryr/archive/2008/10/03/cassini-for-framework-3-5.aspx)下载它，例如，网站上也有 2.0 框架的旧版本。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-08-02T18:41:44.000

发布了更新版本：[Cassini 3.5.0.2：支持友好 URL/路由](http://blogs.msdn.com/dmitryr/archive/2009/04/23/cassini-support-for-friendly-urls-routing.aspx)

# mysql - MySQL 性能瓶颈

> ID：436251
> 
> 赞同：0
> 
> 时间：2009-01-12T17:35:42.233
> 
> 标签：mysql, performance

我有一个相当简单的查询

```
SELECT col1 FROM table1 
```

此命令每秒输出大约 300K+ 个条目，这听起来很合理，但其他用于对保存的数据进行大规模解码的方法（例如阵列反序列化）在硬盘驱动器启用的限制下工作，即 40-50 MB/s，而 2-使用 MySQL 时为 3 MB/秒。

我看到我的 MySQL 机器受 CPU 限制，我认为必须有一个更简单的解决方案来继续使用 MySQL 并享受双位数的速度吞吐量（当然对于相同数量级的复杂查询）而不在硬件上花费一大笔钱

任何想法如何摆弄服务器来实现这一点？

编辑：我使用 MyISAM 引擎

编辑：服务器已经是一台不错的机器，所以我不想在这里捏我的便士......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-12T17:46:33.850

您是否使用正确的工具来解决您的问题？MySQL 是一个关系型数据库。它擅长涉及列之间关系的查询。您描述的查询类型没有利用数据库的优点，并且仍然支付它的开销。MySQL 不保证速度——它以合理的速度启用具有复杂查询能力的持久存储。也许您需要不同的数据架构。或者，如果您描述的查询不具有代表性，这里有[一本关于 mysql 性能的书](https://rads.stackoverflow.com/amzn/click/com/0596101716)，以及[相应的博客](http://www.mysqlperformanceblog.com/)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-12T17:38:49.980

将数据库存储在内存中。让它真的很快！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-12T17:57:41.970

数据库更经常使机器 I/O 受限。

如果您的机器受 CPU 限制，那么我认为数据库不是您的瓶颈。

# drupal - 好的 Drupal 下载管理器？

> ID：436263
> 
> 赞同：3
> 
> 时间：2009-01-12T17:37:16.800
> 
> 标签：drupal, download-manager

我正在寻找 Drupal 的下载管理器模块。理想情况下，它会提供与 Sourceforge 管理器或 Drupal 主题下载管理器相同的功能。那是：

*   多个下载对象，带有描述
*   每种类型都有多个版本可用
*   在页面上很好地分隔
*   Unstable、Supported 和 Unsupported 标记会很好，但不是必需的。

易于管理会很好，但如果可以的话，我可以处理一个神秘的上传系统。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-12T17:59:19.580

Drupal 的[项目](https://www.drupal.org/project/project)模块（它还有一些其他的模块附加组件）很可能是您正在寻找的东西。关于它的一些细节（来自它的项目页面）：

> 通常假定项目代表具有源代码、版本等的软件。项目模块提供主要的“项目”内容类型以及分类和浏览项目的能力。包含的项目发布子模块可以管理项目所代表的不同版本软件的下载。这些模块为 Drupal.org 提供项目和发布管理工具。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-12T22:17:37.077

项目对我有用，因为我可以使用 Drupal 5。

# sql-server - 继承的 SQL Server 数据库问题

> ID：436264
> 
> 赞同：1
> 
> 时间：2009-01-12T17:37:59.077
> 
> 标签：sql-server, database

我继承了一个 SQL Server 数据库，出于某种奇怪的原因，开发人员没有使用 Identity 来自动增加主键。（也许它曾经是 Oracle 的，谁知道呢）。

现在，......由于无数客户访问数据库，我认为“下一个 ID”必须存储在数据库中的某个地方，这样它们就不会相互冲突。如果我尝试手动添加记录，它会起作用，但是当客户端创建记录时，它会失败，说密钥已在使用中。

我如何确定将其存储在哪个表中，或者您能否建议可以存储 ID 的其他地方？

我知道要生成的下一个 ID 可能会有所帮助。因为可能有一种方法可以在任何表的任何记录中查找值。（如果没有，应该有:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-12T17:41:16.997

检查`information_schema.constraint_column_usage`所有其他人使用外键引用的表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T17:43:58.627

如果它使用存储过程进行插入，那么它可能就在那里。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-12T17:42:06.010

它可能存储在代码中，或者更糟糕的是，每次都在代码中确定。例如，在插入之前，它们会获取当前的最高 ID，然后加 1 并插入。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-12T17:43:44.183

我见过几个这样的系统。

*   一个人有一张带有自动编号的桌子，用于在每张桌子上设置身份。这用于确保每个对象具有不同的 id。

*   另一个项目是由类似的东西给出的：从表中选择 max(id)+1。不要问我为什么；）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-12T17:58:44.090

在您解决问题并再次工作后，切换到 Uniqueidentifier (GUID)。它们不仅可以在独立的时间和空间中生成，消除竞争条件，而且您可以将它们用作 ROWGUIDCOL 用于复制目的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-12T20:59:31.400

找到它的最佳选择是查看插入记录的代码（存储的过程或从 GUI 动态执行的代码）。以这种方式“设计”的系统经常不能正常工作，并且不能考虑同时请求信息的多个用户。可能客户端级别的失败正是因为它们遇到了竞争条件。

如果您确实将其更改为使用 Identity（坦率地说，如果这可行，我宁愿这样做而不是使用 GUIDS）并且您需要取回该值以插入子表，然后确保使用 scope_identity() 返回您刚刚插入的身份值，而不是@@identity。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-12T21:12:53.933

如果您运行 SQL Server Profiler 会话（假设您使用的是 SQL Server 2005+）会怎样？此工具将显示应用程序正在执行的查询。如果下一个 ID 确实存储在数据库中的表中，您应该会在启动时或在插入记录之前看到一个查询访问它。您还应该看到插入后更新的下一个 ID。如果你没有看到任何这些，也许你仍然会得到一些有价值的线索。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2017-05-04T12:19:36.523

运行跟踪并查找插入以查看 ID 是否从客户端显式传入。如果没有，并且没有存储过程，请检查该表上是否存在触发器。

# c++ - 清空 C++ 对象

> ID：436265
> 
> 赞同：4
> 
> 时间：2009-01-12T17:38:20.433
> 
> 标签：c++, construction

`Empty`我经常使用类似于以下的代码向我的 C++ 对象添加一个方法来清除内部状态。

```
class Foo
{
private:
    int n_;
    std::string str_;
public:
    Foo() : n_(1234), str_("Hello, world!")
    {
    }

    void Empty()
    {
        *this = Foo();
    }
}; 
```

这似乎比在构造函数中复制代码要好，但我想知道`*this = Foo()`在想要清除对象时是否是一种常用方法？这个等着咬我有什么问题吗？还有其他更好的方法来实现这种事情吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-12T17:42:06.993

我会让构造函数调用我的函数：

```
class Foo
{
private:
    int n_;
    std::string str_;
public:
    Foo()
    {
        Reset();
    }

    void Reset()
    {
        n_ = 1234;
        str_ = "Hello, world!";
    }
}; 
```

是的，您首先不必要地将字符串初始化为空字符串，然后进行赋值，但这要清楚得多。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-12T18:02:29.637

潜在问题？你怎么知道 *this 真的是 Foo？

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-12T18:30:26.600

您使用此 Empty 方法所做的工作本质上与手动将新构造的对象分配给变量（Empty 函数所做的事情）相同。

就个人而言，我会删除 Empty 方法，并将该方法的所有用法替换为：

```
// let's say, that you have variables foo and pfoo - they are properly initialized.
Foo foo, *pfoo;

// replace line "foo.Empty()" with:
foo = Foo();

// replace line "pfoo->Empty()" with:
delete pfoo;
pfoo = new Foo();
// or
*pfoo = Foo(); 
```

我真的认为使用这种 Empty 方法没有任何优势。它隐藏了它被称为女巫的对象的真实情况，这个名字也不是最好的选择。

如果调用者真的想要一个干净的对象 - 他自己构造对象将没有问题。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-12T17:56:33.987

此外，考虑使对象不可变，*即*，在构造时，它们不能更改。在很多情况下，这可以使您免受意料之外的副作用。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-12T18:24:03.273

有一些比你建议的更常见的东西。使用交换。

基本上你做这样的事情：

```
T().swap(*this); 
```

由于许多标准容器（所有 STL 容器？）都有一个恒定时间交换方法，这是一种清除容器并确保释放其存储空间的好方法。

同样，它也是“缩小以适应”容器的好方法，但使用复制构造函数而不是默认构造函数。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-12T17:56:55.263

考虑使用放置`new`：

```
void Empty() {
    this->~Foo();
    new (this) Foo();
} 
```

您的代码调用`operator =`可能会导致各种副作用。

**编辑**以回应评论。– 该代码绝对是*明确*定义的，标准明确允许它。如果我有时间，我将在稍后发布该段落。关于`delete`——当然。我的意思是`~Foo()`，这是一个疏忽。是的，Rob 也是对的。破坏对象实际上是调用字符串的析构函数的必要条件。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-12T23:39:12.890

如果您在构造函数中有动态分配的内存，这可能是内存泄漏的潜在来源。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-13T13:58:00.533

这是我的做法：

```
class Foo {
private:
    int n_;
    std::string str_;
public:
    Foo() : n_(1234), str_("Hello, world!")
    {
    }

    void Empty()
    {
        Foo f;
        swap(f);
    }

    void swap(Foo & other) {
        std::swap(n_, other.n_);
        swap(str_, other.str_);
    }
};

void swap(Foo & one, Foo & other) {
    one.swap(other);
} 
```

将交换函数放入与 Foo 类相同的命名空间中。当用户调用 swap 以交换两个 Foo 时，依赖于参数的查找会找到它。您也可以`operator=`使用您的交换功能来实现。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-12T19:52:26.577

> 这似乎比在构造函数中复制代码要好，但我想知道 *this = Foo() 是否是想要清除对象时的常用方法？

清除一个对象并不常见：更常见的是，一个对象（甚至可能是一个不可变对象）被实例化并包含真实数据，或者它没有被实例化。

最常见的重置类型**是**容器……但是，您现在不会编写自己的容器类，对吧。

> 这个等着咬我有什么问题吗？

是的：

*   如果这不是真的 a`Foo`而是 a`DerivedFoo`
*   如果`Foo`的赋值运算符不存在，或者它有问题（例如，如果它没有定义并且默认运算符不好，例如因为数据成员是裸指针）。

> 还有其他更好的方法来实现这种事情吗？

是的，也许免费功能会更好（可以避免上述两个问题）：

```
template<class T> void reconstruct(T* p)
{
    p->~T();
    new (p) T();
} 
```

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2009-01-12T17:57:58.007

是的，这在性能方面效率不高（创建另一个 foo 对象而不是在原地工作），如果你在构造函数中分配内存并导致严重的内存泄漏，它会咬你一口。

使其在内存方面更安全将调用 this->delete 和 this = new foo() - 但它会很慢。

如果您想超快，请创建一个静态空对象字段并在 Reset 中对其进行 memcpy。

如果您只想快速地一一分配属性。

如果您想保持合理的风格而不重复，请按照 Ates Goral 的建议从 Ctor 调用 Reset，但是使用默认参数您将失去更快的构造。

# php - 使用 PHP 的时间戳电子邮件

> ID：436266
> 
> 赞同：0
> 
> 时间：2009-01-12T17:38:42.727
> 
> 标签：php

我正在构建一个电子邮件，它将通过网络表单将数据传输到邮箱。我希望使用 ISO 8601 格式为电子邮件的 XML 部分加上时间戳。我需要获取发送电子邮件的时间，然后使用 PHP 将其全部转换。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-12T19:03:48.843

[php手册 - 日期](http://us3.php.net/date)

```
date('c') 
```

将以 iso8601 输出当前*服务器*时间。如果您要读取日期，可以像这样将时间戳传递给函数

```
date('c',strtotime('January 4th 2001 4:30pm')) 
```

[strtotime](http://us3.php.net/strtotime)的参数几乎是日期的任何英文可读文本表示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-12T19:22:03.220

您使用哪个 php 版本？

```
date('c'); 
```

已在 php5 中添加。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-12T19:41:10.123

格式`Y-m-d\TH:i:sO`与`c`. 自 PHP 5.1.1 以来，有一个`DATE_ISO8601`保持这个值的常量。

# xml - 使用 Log4j XML 配置文件配置 Hibernate 日志记录？

> ID：436276
> 
> 赞同：89
> 
> 时间：2009-01-12T17:40:33.690
> 
> 标签：xml, hibernate, logging, configuration, log4j

我找不到任何关于如何使用 Log4j 的 XML 样式配置文件配置 Hibernate 日志记录的文档。

这甚至可能还是我使用属性样式配置文件来控制 Hibernate 的日志记录？

如果有人有任何信息或文档链接，将不胜感激。

**编辑：**
为了澄清，我正在寻找一个实际的 XML 语法示例来控制 Hibernate。

**EDIT2：**
这是我的 XML 配置文件中的内容。

```
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE log4j:configuration SYSTEM "log4j.dtd">

<log4j:configuration xmlns:log4j="http://jakarta.apache.org/log4j/">
    <appender name="console" class="org.apache.log4j.ConsoleAppender">
        <param name="Threshold" value="info"/>
        <param name="Target" value="System.out"/>
        <layout class="org.apache.log4j.PatternLayout">
            <param name="ConversionPattern" value="%d{ABSOLUTE} [%t] %-5p %c{1} - %m%n"/>
        </layout>
    </appender>
    <appender name="rolling-file" class="org.apache.log4j.RollingFileAppender">
        <param name="file" value="Program-Name.log"/>
        <param name="MaxFileSize" value="1000KB"/>
    <!-- Keep one backup file -->
        <param name="MaxBackupIndex" value="4"/>
        <layout class="org.apache.log4j.PatternLayout">
            <param name="ConversionPattern" value="%d [%t] %-5p %l - %m%n"/>
        </layout>
    </appender>

    <root>
        <priority value ="debug" />
        <appender-ref ref="console" />
        <appender-ref ref="rolling-file" />
    </root>
</log4j:configuration> 
```

日志记录工作正常，但我正在寻找一种方法来降低和控制休眠日志记录，这种方式与我的应用程序级日志记录不同，因为它目前正在淹没我的日志。我找到了使用首选项文件执行此操作的示例，我只是想知道如何在 XML 文件中执行此操作。

* * *

## 回答 #1

> 赞同：164
> 
> 时间：2009-01-12T19:32:28.270

来自[http://docs.jboss.org/hibernate/core/3.3/reference/en/html/session-configuration.html#configuration-logging](http://docs.jboss.org/hibernate/core/3.3/reference/en/html/session-configuration.html#configuration-logging)

这是记录器类别的列表：

```
Category                    Function

org.hibernate.SQL           Log all SQL DML statements as they are executed
org.hibernate.type          Log all JDBC parameters
org.hibernate.tool.hbm2ddl  Log all SQL DDL statements as they are executed
org.hibernate.pretty        Log the state of all entities (max 20 entities) associated with the session at flush time
org.hibernate.cache         Log all second-level cache activity
org.hibernate.transaction   Log transaction related activity
org.hibernate.jdbc          Log all JDBC resource acquisition
org.hibernate.hql.ast.AST   Log HQL and SQL ASTs during query parsing
org.hibernate.secure        Log all JAAS authorization requests
org.hibernate               Log everything (a lot of information, but very useful for troubleshooting) 
```

格式化为粘贴到 log4j XML 配置文件中：

```
<!-- Log all SQL DML statements as they are executed -->
<Logger name="org.hibernate.SQL" level="debug" />
<!-- Log all JDBC parameters -->
<Logger name="org.hibernate.type" level="debug" />
<!-- Log all SQL DDL statements as they are executed -->
<Logger name="org.hibernate.tool.hbm2ddl" level="debug" />
<!-- Log the state of all entities (max 20 entities) associated with the session at flush time -->
<Logger name="org.hibernate.pretty" level="debug" />
<!-- Log all second-level cache activity -->
<Logger name="org.hibernate.cache" level="debug" />
<!-- Log transaction related activity -->
<Logger name="org.hibernate.transaction" level="debug" />
<!-- Log all JDBC resource acquisition -->
<Logger name="org.hibernate.jdbc" level="debug" />
<!-- Log HQL and SQL ASTs during query parsing -->
<Logger name="org.hibernate.hql.ast.AST" level="debug" />
<!-- Log all JAAS authorization requests -->
<Logger name="org.hibernate.secure" level="debug" />
<!-- Log everything (a lot of information, but very useful for troubleshooting) -->
<Logger name="org.hibernate" level="debug" /> 
```

注意：大多数记录器使用 DEBUG 级别，但是 org.hibernate.type 使用 TRACE。在以前的 Hibernate 版本中，org.hibernate.type 也使用 DEBUG，但从 Hibernate 3 开始，您必须将级别设置为 TRACE（或 ALL）才能查看 JDBC 参数绑定日志记录。

并且指定了一个类别：

```
<logger name="org.hibernate">
    <level value="ALL" />
    <appender-ref ref="FILE"/>
</logger> 
```

它必须放在根元素之前。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2010-02-25T17:06:58.770

[Loki](https://stackoverflow.com/users/39057/loki)的[回答](https://stackoverflow.com/questions/436276/configuring-hibernate-logging-using-log4j-xml-config-file/436687#436687)指向 Hibernate 3 文档并提供了很好的信息，但我仍然没有得到我预期的结果。

大量的鞭打，挥动手臂和一般死老鼠的奔跑终于让我的奶酪落到了我的身上。

因为 Hibernate 3 正在使用[Simple Logging Facade for Java](http://www.slf4j.org/) (SLF4J)（根据文档），**如果**您依赖 Log4j 1.2，如果您想要**完全**配置 Hibernate 日志记录，则**还**需要**slf4j-log4j12-1.5.10.jar** log4j 配置文件。希望这对下一个人有所帮助。

 *** * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-06T15:56:45.230

回应 homaxto 的评论，这就是我现在所拥有的。

```
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE log4j:configuration SYSTEM "log4j.dtd">

<log4j:configuration xmlns:log4j="http://jakarta.apache.org/log4j/">
    <appender name="console" class="org.apache.log4j.ConsoleAppender">
        <param name="Threshold" value="debug"/>
        <param name="Target" value="System.out"/>
        <layout class="org.apache.log4j.PatternLayout">
            <param name="ConversionPattern" value="%d{ABSOLUTE} [%t] %-5p %c{1} - %m%n"/>
        </layout>
    </appender>
    <appender name="rolling-file" class="org.apache.log4j.RollingFileAppender">
        <param name="file" value="Program-Name.log"/>
        <param name="MaxFileSize" value="500KB"/>
        <param name="MaxBackupIndex" value="4"/>
        <layout class="org.apache.log4j.PatternLayout">
            <param name="ConversionPattern" value="%d [%t] %-5p %l - %m%n"/>
        </layout>
    </appender>

    <logger name="org.hibernate">
        <level value="info" />
    </logger>

    <root>
        <priority value ="debug" />
        <appender-ref ref="console" />
        <appender-ref ref="rolling-file" />
    </root>
</log4j:configuration> 
```

关键部分是

```
<logger name="org.hibernate">
    <level value="info" />
</logger> 
```

希望这可以帮助。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-12T16:19:58.977

这是我使用的：

```
<logger name="org.hibernate">
    <level value="warn"/>
</logger>

<logger name="org.hibernate.SQL">
    <level value="warn"/>
</logger>

<logger name="org.hibernate.type">
    <level value="warn"/>
</logger>

<root>
    <priority value="info"/>
    <appender-ref ref="C1"/>
</root> 
```

显然，我不喜欢看到 Hibernate 消息；）——将级别设置为“调试”以获取输出。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-07-25T18:58:31.153

答案很有用。更改后，我得到了重复的 SQL 语句日志记录，一个在 log4j 日志文件中，一个在标准控制台上。我将 persistence.xml 文件更改为将 show_sql 设置为 false 以摆脱标准控制台的日志记录。保持 format_sql 为真也会影响 log4j 日志文件，所以我保持不变。

```
<persistence xmlns="http://java.sun.com/xml/ns/persistence"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd"
        version="2.0">
    <persistence-unit name="myUnit" transaction-type="RESOURCE_LOCAL">
        <provider>org.hibernate.ejb.HibernatePersistence</provider>
        <properties>
            <property name="javax.persistence.jdbc.driver" value="org.hsqldb.jdbcDriver"/>
            <property name="javax.persistence.jdbc.url" value="jdbc:hsqldb:file:d:\temp\database\cap1000;shutdown=true"></property>
            <property name="dialect" value="org.hibernate.dialect.HSQLDialect"/>
            <property name="hibernate.show_sql" value="false"/>
            <property name="hibernate.format_sql" value="true"/>
            <property name="hibernate.connection.username" value="sa"/>
            <property name="hibernate.hbm2ddl.auto" value="create-drop"/>
        </properties>
    </persistence-unit>
</persistence> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-10-08T14:07:44.513

您可以`log4j`像这样使用类别标签配置文件（例如，使用控制台附加程序）：

```
<appender name="console" class="org.apache.log4j.ConsoleAppender">
    <layout class="org.apache.log4j.PatternLayout">
        <param name="ConversionPattern" value="%d{yy-MM-dd HH:mm:ss} %p %c - %m%n" />
    </layout>
</appender>
<category name="org.hibernate">
    <priority value="WARN" />
</category>
<root>
    <priority value="INFO" />
    <appender-ref ref="console" />
</root> 
```

因此，将显示来自休眠的每个警告、错误或致命消息，仅此而已。此外，您的代码和库代码将处于信息级别（因此信息、警告、错误和致命）

要更改库的日志级别，只需添加一个类别，例如，停用弹簧信息日志：

```
<category name="org.springframework">
    <priority value="WARN" />
</category> 
```

或者用另一个 appender，打破可加性（additivity 默认值为 true）

```
<category name="org.springframework" additivity="false">
    <priority value="WARN" />
    <appender-ref ref="anotherAppender" />
</category> 
```

如果您不想让 hibernate 记录每个查询，请将 hibernate 属性设置`show_sql`为`false`.

# c# - 在 C# 中运行异步操作。- 基本的。

> ID：436294
> 
> 赞同：0
> 
> 时间：2009-01-12T17:44:33.697
> 
> 标签：c#, timer

考虑以下代码段：

```
if(form1.isLoggedIn) 
{             
    //Create a wait handle for the UI thread.
    //the "false" specifies that it is non-signalled
    //therefore a blocking on the waitone method.
    AutoResetEvent hold = new AutoResetEvent(false);

    filename = Path.Combine(Environment.GetFolderPath(System.Environment.SpecialFolder.CommonApplicationData), DateTime.Now.ToString("ddMMyyhhmm") + "-" + form1.username);       

    Flow palm = new Flow(new FlowArguments(form1.username, filename), hold);

    System.Windows.Forms.NotifyIcon notifyIcon = new System.Windows.Forms.NotifyIcon();
    System.Windows.Forms.ContextMenuStrip notificationIconContext = new System.Windows.Forms.ContextMenuStrip();
    //Create a context menu strip
    ToolStripMenuItem contextAbout = new ToolStripMenuItem("About");
    ToolStripMenuItem contextExit = new ToolStripMenuItem("Exit");

    //properties of notifyicon that SO dosnt care for including a event handler for the mouse click events.

    //wait for the background thread to finish.                
    hold.WaitOne(Timeout.Infinite);

    MessageBox.Show("Thankyou, exiting...");
    form1.Dispose();                
} 
```

如您所见**，FLOW 类非常简单。它只有一个正在运行的 Threading.Timer。因此，在 UI 线程上，我必须调用 WaitHandle.WaitOne() 方法，否则 UI 线程完成并因此结束应用程序..**

我的目标：由于没有 GUI，我想创建一个通知图标。它可以工作，一切正常，除了我无法点击它并且它没有响应，这是因为它是在 UI 线程上创建的。我不能把它放在流类中，因为流类也在 UI 线程上（流类中的计时器在后台线程中）。

那么如何在 Flow 类中运行计时器时让我的 notifyicon 保持响应？我认为 waithandle 是我的解决方案，但由于它是一种阻塞方法，所以它不起作用。

还有其他想法/解决方案吗？

编辑：对 Rich 的回答的回应： Flow 类在后台线程上，一切都按照它应该的方式运行。但是，如果我不在 UI 线程中添加等待句柄，则 main() 在 UI 线程上完成，因此终止整个程序。（即使在后台线程上启用了计时器）。是否有另一种解决方案来等待处理？因为我必须把它留给 Flow 类来做它的事情。如果我把它拿出来，程序就会结束，如果我把它留在里面会阻塞 UI 线程，因此我的 notifyicon 不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-12T17:52:09.080

我不知道你的 Flow 对象是什么或它做了什么，但为什么它不能在另一个线程中工作而不阻塞 UI 线程？我认为通知图标是 UI 的一部分，因此需要在 UI 线程上，使其成为在另一个线程上运行的错误候选者。相比之下，您的 Flow 对象似乎正在执行您的应用程序的逻辑，这在另一个线程上产生更有意义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-12T18:01:43.647

**未**标记为后台线程的活动线程将阻止程序退出。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-14T18:03:45.560

我在字里行间读了一点，但我认为 Rich 是对的 - 您需要将后台处理移出 UI 线程：

*   从上面的函数中删除 form1.dispose 调用 - 我想这是你唯一的表单，这就是为什么一旦你处理它，应用程序就会退出。
*   异步调用流类-最简单的方法是在调用该函数的委托上调用 ThreadPool.QueueUserWorkItem() （尽管您实际上不应该使用线程池线程进行长时间运行的操作，但我怀疑它会在这种情况下受伤）
*   一旦 flow 方法完成，回调 UI 线程让它知道。您可以通过使用合适的委托调用 form1.Invoke 来做到这一点
*   在随后调用的函数中（即在 UI 线程上）关闭表单并退出您的应用程序

所以最终结果看起来像 3 个函数：

*   上面的函数，它在后台开始处理，然后不等待就返回
*   后台处理函数，在单独的线程上执行
*   处理完成时在 UI 线程上调用的函数，用于关闭应用程序

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-28T20:38:58.277

正如ermau 所提到的，前台线程将阻止进程终止。

因此，一种解决方案是更改您的 Flow 类，使其使用前台线程。由于 Threading.Timer[在系统提供的 ThreadPool 线程上执行，](http://msdn.microsoft.com/en-us/library/system.threading.timer.aspx)您将不得不使用其他东西。

如果您不想修改 Flow 类，另一种解决方案是创建一个等待句柄的前台线程（除了您的 UI 线程）。

```
Thread t = new Thread((ThreadStart)delegate { hold.WaitOne(); });
t.Start(); 
```

这将创建一个线程，该线程将阻塞，直到您的工作线程发出您的句柄“hold”信号，但不会阻塞您的 UI 线程。

# c - 常量 C 表达式是在编译时还是在运行时计算的？

> ID：436300
> 
> 赞同：33
> 
> 时间：2009-01-12T17:46:09.403
> 
> 标签：c, optimization, compiler-construction, standards, c-preprocessor

如果我编写一个使用其他预处理器常量执行操作的*#define*，每次宏在运行时出现时都会计算最终值吗？这是否取决于编译器中的优化，或者它是否包含在标准中？

例子：

```
#define EXTERNAL_CLOCK_FREQUENCY    32768
#define TIMER_1_S                   EXTERNAL_CLOCK_FREQUENCY
#define TIMER_100_MS                TIMERB_1_S / 10 
```

每次我使用 TIMER_100_MS 宏时，运行时会发生*32768 / 10*操作吗？

我想避免以下情况：

```
#define EXTERNAL_CLOCK_FREQUENCY    32768
#define TIMER_1_S                   EXTERNAL_CLOCK_FREQUENCY
#define TIMER_100_MS                3276 
```

* * *

### 概括

编译器需要能够评估常量整数表达式，因为它们对于在编译时计算诸如数组大小之类的东西是必需的。然而，标准只说他们“可以”——而不是“必须”——这样做。因此，只有脑死亡的编译器不会在编译时评估常量整数表达式，但对非常规编译器的汇编输出进行简单检查将验证每种情况。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-01-12T17:57:55.900

宏只是文本替换，因此在您的示例`TIMER_100_MS`中，在程序中编写是一种奇特的编写方式`32768 / 10`。

因此，问题是编译器何时评估`32768 / 10`，这是一个常量整数表达式。我认为该标准在这里不需要任何特定行为（因为运行时和编译时评估实际上无法区分），但是任何中途体面的编译器都会在编译时对其进行评估。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-01-12T21:07:33.397

这里的大多数答案都集中在宏替换的影响上。但我想他想知道是否

```
32768 / 10 
```

在编译时进行评估。首先，这是一个算术常量表达式，另外还有一个整数常量表达式（因为它只有整数类型的文字）。实现可以在运行时自由计算它，但它也必须能够在编译时计算它，因为

1.  如果常量表达式不能以其表达式具有的类型表示，它必须给出诊断消息
2.  此类表达式在需要转换时值的上下文中是允许的，例如，如果用作数组维度的大小。

如果编译器主要可以在编译时计算结果，它应该使用该值，而不是在运行时重新计算它我认为。但也许还有一些理由这样做。我不会知道的。

**编辑**：对不起，我回答的问题好像是关于 C++ 的。注意到今天您询问了 C。表达式中的溢出被视为 C 中的未定义行为，无论它是否发生在常量表达式中。当然，第二点在 C 中也是如此。

**编辑**：作为评论说明，如果宏被替换为表达式`3 * TIMER_100_MS`，那么这将评估`(3 * 32768) / 10`。因此，简单直接的答案是*“不，它不会每次都在运行时发生，因为由于优先级和关联性规则，划分可能根本不会发生”*。我上面的回答假设宏总是被替换，以便实际发生除法。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-01-12T17:57:09.443

我不知道有任何标准可以保证它会被优化。预处理器将用 32768/10 替换 TIMER_100_MS，您可以通过运行 gcc -c 来查看。要查看编​​译器是否进一步优化，请运行 gcc -S 并检查汇编程序。使用 gcc 4.1，即使没有任何优化标志，它也会在编译期间减少为常量：

```
#include <stdlib.h>
#include <stdio.h>

#define EXTERNAL_CLOCK_FREQUENCY    32768
#define TIMER_1_S                   EXTERNAL_CLOCK_FREQUENCY
#define TIMER_100_MS                TIMER_1_S / 10

int main(int argc, char **argv)
{
  printf("%d\n", TIMER_100_MS);

  return(0);
}

gcc -S test.c
cat test.s

...
    popl    %ebx
    movl    $3276, 4(%esp)
    leal    LC0-"L00000000001$pb"(%ebx), %eax
    movl    %eax, (%esp)
    call    L_printf$stub
... 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-01-12T19:30:35.807

编译器应该优化那个表达式。我不认为这是标准所要求的，但我从未见过不会执行该任务的编译器。

但是，你不应该写：

```
#define TIMER_100_MS      TIMERB_1_S / 10 
```

...因为这是一个等待发生的错误。您应该始终为涉及表达式的#defines 加上括号。

```
#define TIMER_100_MS      (TIMERB_1_S / 10) 
```

考虑 ：

```
i = 10 * TIMER_100_MS; 
```

第一种情况将给出 32768 ((10 * TIMERB_1_S) / 10) ，第二种情况将给出 32760 (10 * (TIMERB_1_S / 10))。这里不是一个关键的区别，但你必须意识到它！

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2009-01-12T19:30:12.440

来自[WG14/N1124 委员会草案 — 2005 年 5 月 6 日 ISO/IEC 9899:TC2](http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1124.pdf)：

> ## 6.6 常量表达式
> 
> ### 句法
> 
> 常量表达式：
>     条件表达式
> 
> ### 描述
> 
> 常量表达式可以在翻译期间而不是运行时进行评估，因此可以在常量可能存在的任何地方使用。
> 
> ### 约束
> 
> 常量表达式不应包含赋值、递增、递减、函数调用或逗号运算符，除非它们包含在未计算的子表达式中。96)
> 
> 每个常量表达式都应计算为一个常量，该常量在其类型的可表示值范围内。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2009-01-12T17:56:30.303

> 每次我使用*TIMERB_100_MS*宏时，运行时会发生 32768 / 10 操作吗？

代码中你使用的每个地方`TIMERB_100_MS`，它都会被预处理器替换`32768 / 10`。

该表达式是否得到进一步优化（它的计算结果为常量）取决于您的编译器。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2009-01-13T06:23:05.197

伙计们，这种转换称为“常量折叠”，甚至大多数学生编译器都会这样做。只要您有一个不是您或您的大学室友的人构建的编译器，并且您正在编译一种静态类型的语言，即使没有打开优化，您也可以依靠它。如果您正在处理一些允许更改`/`.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-06-24T09:54:48.500

这是不正确的，编译器无法在编译时操作浮点数。如果您在编译时对 3276 值感到满意，那么您就可以开始了，但是编译器无法在编译时以浮点精度对此进行评估。浮点数对于编译器来说太难优化了，因为优化浮点数会导致数学表达式中出现意想不到的结果，所以一个像样的编译器（任何 gcc 版本、任何 clang 版本、任何 msvc 版本、任何 icc 版本）都不会将其简化为3276.8，故事结束。

而你问题的另一部分，你问是否会为每个宏扩展进行评估。同样，如果您对 3276 值没问题，那么答案是否定的，这取决于编译器、优化级别和背景，它可以放在常量表中，也可以内联在代码中。永远不会在运行时为每个宏扩展计算相同的表达式。同样，如果您希望浮点精度获得 3276.8，则该表达式将在运行时针对每个宏扩展进行评估。

在这里查看更多编译和优化方面： [http ://www.agner.org/optimize/#manuals](http://www.agner.org/optimize/#manuals)

* * *

## 回答 #9

> 赞同：-4
> 
> 时间：2009-01-12T17:55:44.797

在编译时。这是一个语言标准（并且一直是）并且独立于编译器。

**编辑**

一位评论者要求提供参考 - 引用“C 编程语言”第 2 版附录 A12.3（第 229 页）：

> 窗体的控制线
> 
> ```
> #define identifier token-sequence 
> ```
> 
> 使预处理器用给定的标记序列替换标识符的后续实例；roken 序列周围的前导和尾随空格被丢弃

**编辑结束**

# c# - 从服务器执行一个简单的 window.open 脚本

> ID：436301
> 
> 赞同：0
> 
> 时间：2009-01-12T17:46:15.723
> 
> 标签：c#, asp.net, javascript

我有一个动态创建的菜单，其中绑定了一个 menuItemClick 事件。在此事件中，我想执行一个简单的 window.open 脚本，该脚本使用单击的项目的 url。我需要这样做的原因是我需要设置窗口打开的参数（即没有滚动条，没有工具栏等......）。

我的问题是，有没有办法简单地创建要执行的脚本字符串然后实际执行它？

到目前为止，我有：

```
string script = "window.open('" + e.Item.NavigateUrl + "' ,'_MAIN_WINDOW','width='+ screen.width + '-60,height=' + screen.height + '-500,left=' + screen.left + '-30,top=' + screen.top + '-30,screenx=0,screeny=0,toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=yes,copyhistory=no, resizable=yes')"; 
```

但我不知道如何执行这个脚本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-14T15:11:53.130

您可以将 window.open (...) 代码放在一个名为 onButtonClick (item) 的 javascript 函数中，并按照 bdukes 的建议使用 RegisterStartupScript () 发出它，然后在页面的 aspx 代码中添加一个 eventHandler 之类的

```
<a id="bla" onclick="javascript:onButtonClick(this);" >Dummy item</a> 
```

然后当您单击该项目时，将调用 onButtonClick 并将单击的项目作为参数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-14T15:05:53.330

覆盖页面的 OnPreRender 事件。

在里面你做：

```
protected override void OnPreRender(EventArgs e)
{
  base.OnPreRender(e);  

  foreach (MenuItem item in m1.Items)  // m1 is the menu in my case :)
  {
    item.Target = string.Format("window.open('{0}');", item.NavigateUrl);
  }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-12T17:52:16.287

您需要使用[Page.ClientScript.RegisterStartupScript](http://msdn.microsoft.com/en-us/library/system.web.ui.clientscriptmanager.registerstartupscript.aspx)（或[ScriptManager.RegisterStartupScript](http://msdn.microsoft.com/en-us/library/system.web.ui.scriptmanager.registerstartupscript.aspx)，如果您需要在部分回发后运行它）。

# testing - 有人可以帮我解释一下适合测试吗？

> ID：436302
> 
> 赞同：6
> 
> 时间：2009-01-12T17:46:27.033
> 
> 标签：testing, agile, fitnesse

所以这件事在我的脑海里已经有一段时间了。我已经看到了它的提及，我已经阅读了[健身网页](http://fitnesse.org/FitNesse.TwoMinuteExample)，但我仍然不太了解它。Fitnesse 似乎是另一个测试框架，如 NUnit 或 MbUnit 或任何其他框架，因为您定义了您想要查看的输入和输出，但它似乎旨在测试整个应用程序而不是单元。

如果是这样，它是如何运行的？您是否必须使用钩子设计您的应用程序以进行适合性测试？它实际上属于测试范围的哪个位置？有人可以给我一个很好的例子，说明可以在哪里以及如何使用拟合测试，以及有哪些优点/缺点？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-12T18:15:18.737

NUnit/MbUnit 和 FitNesse 之间的区别在于 NUnit/MbUnit 旨在用于单元测试，而 FitNesse 用于验收测试。

单元测试测试单个小代码单元，例如方法，以确保它按照程序员的预期执行。例如，您可以使用单元测试来确保阶乘计算方法为一组数字返回正确的结果，包括一些边缘情况。

验收测试旨在测试是否满足高级设计要求。例如，如果您正在编写一个 Pac-Man 克隆，并且其中一个要求是“当前一个级别的最后一个点被吃掉时，一个新级别开始”，验收测试将测试该要求是否作为一个整体由代码满足——而不是使用点、检查结束条件和加载新级别的特定代码片段（尽管该代码将在运行验收测试的过程中执行）。验收测试通常是在不考虑需求的具体实现的情况下编写的。

许多 QA 部门手动执行一长串验收测试，这可能非常耗时。Fit 和 FitNesse 是帮助自动化验收测试的工具，可以节省大量时间。

[Ward Cunningham 的 wiki](http://c2.com/cgi/wiki?AcceptanceTest)上有很多关于验收测试的好信息。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-12T18:26:29.790

我合作的最后一家公司使用 FitNesse 取得了一定程度的成功。它的使用方式与 NUnit 不同，后者的测试程度非常精细。FitNesse 更多地用于“验收测试”，涉及粒度较小的“大规模”测试。为了比较两者，假设我们正在编写一个用于在银行处理支票的应用程序：

*   如果我们使用 NUnit 编写单元测试，我们将测试 Check 对象、Transaction 对象、TransactionProcessor 工厂的每个单独方法，测试数据访问层的每个方法等。您的测试非常接近源代码.

*   如果我们正在编写验收测试，我们可能会设置一天的交易，提示应用程序处理交易，并确保代码生成正确的发票报表和报告。您的水平比单元测试高得多，通常处于可以同时测试所有应用程序业务规则的有利位置。

单元测试告诉程序员代码是否包含任何缺陷，验收测试告诉业务分析师应用程序满足用户期望。

FitNesse 测试用例旨在由没有技术知识的人编写。您仍然需要程序员编写 DLL 以向 FitNesse 公开应用程序的内部结构，否则用例应该由对源代码一无所知的非技术人员编写（即业务分析师和 QA） .

我的公司使用 FitNesse 测试我们的一个“核心”应用程序，该应用程序恰好是在 20 年的时间里使用一种死掉的类似 COBOL 的语言编写的。核心应用没有单元测试，用原始语言创建单元测试框架几乎是不可能的。幸运的是，该语言具有 COM 绑定，它向 .NET 和 Java 公开了一些公共方法，使我们能够为该应用程序编写自动化测试用例，这是 20 年来的第一次。它不漂亮，但商界人士喜欢它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-01-03T07:18:15.457

`FitNesse`基本上是一个`wiki`存储所有测试用例的。最有可能用于验收测试。在测试优先开发中，测试用例应仅在需求收集阶段编写，即客户也将参与编写测试，这往往会编写有关验收测试的测试......

所以优点是如果应用程序满足所有用户要求，则不需要单独的验收测试。

缺点是当需求发生变化时，测试用例也会发生变化，但这当然不是什么大问题。

也`fitnesse`将适用于中小型项目。在大型项目的情况下，它可能很笨拙，因为`Fitnesse`无法导出 PDF 文件，它只能导出 Excel 或 worddoc 等电子表格。所以它的缺点是不能用于大型项目。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-12T18:10:36.327

从我的角度来看：它几乎不依赖于要测试的应用程序的挂钩。如果这不能开发出好的 API，那它几乎是没用的。并且不要尝试将其用于 GUI 测试。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-20T21:26:23.623

它可用于运行您的回归测试套件。可用于查看发布后的数据库发布情况。它可用于测试存储过程。它可以用来比较不同的环境。

# vb.net - 在 vb.net 中使用私有方法实现接口

> ID：436305
> 
> 赞同：11
> 
> 时间：2009-01-12T17:46:48.187
> 
> 标签：vb.net, interface

我对此感到有些震惊。有人可以解释为什么这有效吗？何时使用它的一个很好的例子也很好。

```
Public Interface IFoo
  Sub DoIt()
End Interface

Public Class Bar
  Implements IFoo

  Private DoIt() implements IFoo.DoIt
End Class

...

Dim b as new Bar()
b.DoIt() 'error
CType(b, IFoo).DoIt() 'no error 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-12T17:58:40.750

拥有一个私有接口实现基本上只允许您实现一个接口，而不必弄乱您的类的 API。您可以实现`IFoo`，但只有那些将您视为`IFoo`需要知道的 API。

[MSDN](http://msdn.microsoft.com/en-us/library/4b3c4by9.aspx)说

> 您可以使用私有成员来实现接口成员。当私有成员实现接口的成员时，该成员通过接口变得可用，即使它不能直接在类的对象变量上可用。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-12T17:51:17.320

> 我对此感到有些震惊。有人可以解释为什么这有效吗？何时使用它的一个很好的例子也很好。

这个概念非常类似于 C# 的显式接口实现。同样，如果将类型显式转换为该接口，则只能访问该接口的成员。

不过，我无法评论*为什么*.NET 框架团队认为这个功能真的很有必要。它有时可能会加强封装，但我不确定这一点。在任何情况下，使用组合而不是（接口）继承总是可以实现极其相似的事情。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-12T14:04:37.353

问题的第一部分在其他帖子中有所介绍，但我没有看到示例。在实现泛型接口及其非泛型接口时，我通常使用它。例如，如果我想创建一个通用的 ObservableList，我想实现两个 IList 接口。

```
Public Class ObservableList(Of T)
    Implements INotifyCollectionChanged, 
               IList, 
               IList(Of T)
End Class 
```

当两个 IList 都实现时，我们最终会得到很多重复的函数。有些共享相同的签名，并且可以实现两个 IList 函数，如 Clear。但是一些非泛型函数处理对象而不是泛型。所以对于 Add 函数，我会让两个实现都工作，但是将非泛型版本设置为私有以使使用该类更容易。

```
Public Sub Add(item As T) Implements System.Collections.Generic.ICollection(Of T).Add
    'Add item to collection
End Sub

Private Function Add1(item As Object) As Integer Implements System.Collections.IList.Add
    'Add item to collection
End Function 
```

这样，该类可以作为 IList 传递和使用，但编码人员可以将其用作 IList(Of T) 而不会出现潜在的过载混乱。

# ios - 给定指针从位图中访问图像数据

> ID：436316
> 
> 赞同：1
> 
> 时间：2009-01-12T17:51:58.893
> 
> 标签：ios, iphone, image, pointers, bitmap

我的问题是一旦我有了指针就可以正确读取像素数据。

所以我有一个占据整个 iPhone 屏幕并且没有 alpha 通道的图像（每像素 24 位，每个组件 8 位，每行 960 字节），我想找出特定像素的颜色。

我有指向数据的指针

```
UInt8 *data = CFDataGetBytePtr(bitmapData); 
```

但现在我不确定如何在给定坐标的情况下正确索引数据？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-12T21:59:12.763

```
UInt8 *data = CFDataGetBytePtr(bitmapData);

unsigned long row_stride = image_width * no_of_channels; // 960 bytes in this case
unsigned long x_offset = x * no_of_channels;

/* assuming RGB byte order (as opposed to BGR) */
UInt8 r = *(data + row_stride * y + x_offset );
UInt8 g = *(data + row_stride * y + x_offset + 1);
UInt8 b = *(data + row_stride * y + x_offset + 2);

/* less portable but if you want to access it in as a packed UInt32, you could do */
UInt32 color = *(data + row_stride * y + x) & 0x00FFFF;  /* little endian byte ordering */ 
```

# css - CSS 菜单链接保持突出显示

> ID：436319
> 
> 赞同：1
> 
> 时间：2009-01-12T17:52:42.730
> 
> 标签：css, menu

因此，我正在尝试使用 css 菜单，但我遇到了一个无法修复的简单错误，并且没有找到任何帮助来搜索它。问题是当我将鼠标悬停在下拉菜单上时，父链接保持突出显示，并且文本恢复为原始颜色。希望这可以解释。这是css代码，我确定这是添加一些东西或修复一行代码的问题。您可以在[此处](http://www.pacycling.org)查看问题，一切正常，直到您访问子菜单（如在 BAR 或 Info 中）。

```
#nav, #nav ul {
    text-align: center;
    text-size:16px;
    float: left;
    width: 750px;
    height: 20px;
    list-style: none;
    line-height: 1;
    background: white;
    padding: 0;
    border: solid #000;
    border-width: 0px;
    border-bottom-width: 1px;
    margin: 0;
    background-image: url('/images/bg.gif');
}

#nav a {
    display: block;
    width: 75px;
    height: 20px;
    color: #0000FF;
    text-decoration: none;
}

#nav a:hover {
    display: block;
    width: 75px;
    height: 20px;
    color: #FFF;
}

#nav li {
    float: left;
    padding: 0;
    width: 75px;
}

#nav li ul { /*sub menu */
    position: absolute;
    left: -999em;
    height: auto;
    width: 75px;
    border: solid #000;
    border-width: 0px;
    border-bottom-width: 1px;
    border-top-width: 1px;
    background-image: url('/images/submenu_bg.png');
}

#nav li li {
    width: 75px;
}

#nav li ul a {
    width: 75px;
}

#nav li ul ul {
    margin: -1.75em 0 0 14em;
}

#nav li:hover ul ul, #nav li:hover ul ul ul, #nav li.sfhover ul ul, #nav li.sfhover ul ul ul {
    left: -999em;
}

#nav li:hover ul, #nav li li:hover ul, #nav li li li:hover ul, #nav li.sfhover ul, #nav li li.sfhover ul, #nav li li li.sfhover ul {
    left: auto;
}

#nav li:hover, #nav li.sfhover {
    height: 20px;
    background: #0000FF;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-12T18:00:02.217

您可以尝试在 的悬停上设置链接的颜色`li`，如下所示：

```
#nav li:hover a {
    color: #fff;
}

#nav li:hover li a
{
    color: #0000FF;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T18:41:43.083

您将文本颜色设置为`#nav a:hover`，但背景颜色设置为`#nav li:hover`。因为您的子菜单包含在 中`li`，所以即使光标在子菜单中，它仍然算作悬停。子菜单*不*包含在链接中，因此它们不会保持突出显示并恢复为正常颜色。如果您希望菜单项停止突出显示，请将`background`属性移至`#nav a:hover`。

前：

```
#nav a:hover {
    display: block;
    width: 75px;
    height: 20px;
    color: #FFF;
}

#nav li:hover, #nav li.sfhover {
    height: 20px;
    background: #0000FF;
} 
```

后：

```
#nav a:hover, #nav li.sfhover a {
    display: block;
    width: 75px;
    height: 20px;
    color: #FFF;
    background: #0000FF;
} 
```

或者，如果您希望菜单在悬停在子菜单（看起来更好，IMO）上时*保持*`color`突出显示，请移至`li:hover`. 我知道这有点冗长，但它确实有效。:-)

前：

```
#nav a:hover {
    display: block;
    width: 75px;
    height: 20px;
    color: #FFF;
}

#nav li:hover, #nav li.sfhover {
    height: 20px;
    background: #0000FF;
} 
```

后：

```
#nav a:hover {
    display: block;
    width: 75px;
    height: 20px;
}

#nav li:hover a, #nav li.sfhover a {
    color:white;
}

#nav li:hover li a, #nav li.sfhover li a {
    color:blue;
}

#nav li:hover li a:hover, #nav li.sfhover li a:hover {
    color:white;
}

#nav li:hover, #nav li.sfhover {
    color: #FFF;
    height: 20px;
    background: #0000FF;
} 
```

# asp.net - 如何避免 SubSonic 的 n+1 问题？

> ID：436322
> 
> 赞同：1
> 
> 时间：2009-01-12T17:54:20.307
> 
> 标签：asp.net, orm, subsonic

Ayende 有一篇[博](http://ayende.com/Blog/archive/2006/05/02/CombatingTheSelectN1ProblemInNHibernate.aspx)文详细介绍了如何解决 nHibernate 中的“n+1”问题。本质上，问题是这样的：

假设您有两个表，“BlogPosts”和“Comments”，它们之间存在一对多关系（即每个 BlogPost 可以有多个 Comments）。现在，假设您要执行以下嵌套 for 循环：

```
foreach (BlogPost post in blogposts)
{
    foreach (Comment comment in post.Comments)
    {
        // Do something
    }
} 
```

据我了解，默认情况下，SubSonic 生成的类是延迟加载的（我不想完全关闭它，因为它在大多数情况下都很有用，而不是这个）。这意味着每次执行内部循环时（即访问 post.Comments 时），必须向数据库发送单独的查询以检索评论。

因此，如果您有 80 篇博文，则需要 1 次查询来获取博文列表，然后是 80 次查询来获取每篇博文的评论。但是，如果评论是预先加载的，则这将减少为 1 个查询。

目前有什么方法可以解决 SubSonic 中的这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-12T17:59:31.747

除非您创建一个查询以根据帖子 ID 从评论中进行选择，否则我认为没有办法解决它。这会让你减少到两个。一个查询用于选择您想要的帖子 ID，然后另一个查询用于获取该帖子 ID 列表的所有评论。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-16T07:00:21.360

我认为您应该做的是创建一个部分类方法来获取所有评论。不是很干净，但应该可以。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-04T10:39:14.243

我也使用部分类并像这样加载相关的表类：

```
Partial Public Class Book

    Private _Author as Database.Author 
    Property Author() as Database.Author
      Get
         If _Author is nothing then
           ' Load the author class here.
         End if
         return _Author
      End get
      Set
         '....
      End Set
    End Property

End Class 
```

# windows-7 - 我应该多久开始为 Windows 7 准备我的程序？

> ID：436328
> 
> 赞同：1
> 
> 时间：2009-01-12T17:56:08.493
> 
> 标签：windows-7, compatibility, msdn

Microsoft 已经在其 MSDN 站点上提供了一个[Windows 7 Beta 客户预览计划](http://msdn.microsoft.com/en-ca/dd353271.aspx)，他们鼓励我们：“评估并启动您在 Windows 7 Beta 上的开发工作”。

你觉得现在花时间重新安装 Windows 7 是否值得，或者我应该等待几个版本，甚至等到 Windows 7 发布之后？

这么早开始有什么好处和坏处？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-12T18:46:07.443

正如保罗所说，绝对没有理由不从现在开始。您现在修复的东西以后要修复的东西更少 - 而且您还可以从一个可部署在操作系统上的应用程序中受益，预计在接下来的几周内将有超过 250 万人下载和安装。

当然，您可能会冒着在实施错误修复或推出新功能时不得不对程序进行细微调整的风险，但是您现在所做的仍然可以节省您的时间——即使它只是节省了您当来自潜在客户、客户等的压力将大大增加时，必须进一步熟悉任何特定于平台的限制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T18:10:03.100

我已经下载了 Windows 7 测试版，并将很快将其安装到 VM 中。

现在真的没有理由不检查你的东西。最好在用户之前找到并解决任何问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-12T18:42:45.640

我已经在两台计算机上安装了 Windows 7。到目前为止，只有一个小问题（软件没有找到 USB 设备）。我运行了兼容性向导，现在它工作正常。

它们使最终用户很容易照顾。

它基本上是Vista 6.2。很多好的改进，但不是新的操作系统。所以不急于测试，

# asp.net-mvc - ASP.NET MVC - 它适用于小型网络设备吗？

> ID：436329
> 
> 赞同：11
> 
> 时间：2009-01-12T17:56:23.393
> 
> 标签：asp.net-mvc

我为一家小型网站公司工作（几个程序员，几个设计师）。目前我们使用 ASP.NET 网站项目 - 这使我可以轻松地在本地机器上整理编程，而设计人员直接在开发服务器上工作，并且“即时”编译允许他们查看任何更改无需编译和部署网站（并且全部与 SVN 绑定）。

我想开始使用 ASP.NET MVC，几乎所有的原因使它与 Webforms 不同（逻辑 url、没有视图状态、对 html 的更多控制、单元测试等），但不想让开发过程过于复杂，所以：

*   有什么理由不能将 MVC 网站设置为网站项目而不是应用程序，这样它们就不必在整个开发过程中显式编译？（无论如何，我们的“实时”网站都使用网络编译项目）。
*   这仍然允许单元测试吗？
*   有没有其他方法可以让设计人员以与他们目前相同的方式开发 MVC 站点？注意：他们使用 Dreamweaver，所以没有 Cassini 开发服务器。

任何人都可以提供上述任何建议（即使只是告诉我我的开发过程没有意义.. :)

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-12T18:18:16.797

我曾经是一名 ASP.NET 开发人员。最近我开始使用 Django 进行开发，并通过 SVN 与另一位开发人员进行远程开发。我发现 MVC 框架使小型项目变得更加容易，而大型项目比老式 ASP.NET 所带来的痛苦要少得多。

模板比 ASP.NET 中的 Web 控件更容易控制和设置样式。逻辑分离（超越代码隐藏方法）使多人同时在网站的不同部分工作变得更容易。在必须处理足够长的 ASP.NET 页面生命周期问题之后，以操作为中心的 RESTful 设计开始变得更有意义。此外，URL 驱动的路由和进行反向查找的能力意味着代码中的硬编码链接更少，更容易将新部分添加到您的站点等。

要回答您的一些问题：

*   我不确定实时编译，但它很容易编写一些简单的部署工具来自动化这个过程。
*   由于控制器中的操作更好地划分了逻辑，因此在 MVC 框架上进行单元测试通常更容易。
*   ASP.NET MVC 允许您使用 webforms 作为默认模板语言，但我建议您使用更简洁的模板语言，例如 NVelocity。任何以 HTML 为中心的模板系统都将比 Web 表单更好，因为即使是 Web 控件的简单方面也很难驯服和设置样式。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-12T18:38:17.583

无论是什么类型的项目，ASP.NET MVC 都是一个很棒的平台。如果您已经了解 HTTP 的基础知识以及网站的实际工作方式，那么 ASP.NET MVC 就像您生活中缺少的东西一样。如果您习惯于 ASP.NET WebForms 的回发模型，一开始可能有点难以掌握，但很容易低估它。它基本上是一个无状态模型。你的控制器有一些参数，它写回一些 HTML ......故事结束，直到下一个请求。

*   我不这么认为，我认为这样做的原因是允许 bin-deployable ASP.NET MVC 项目。您可以直接从 Visual Studio 2008 发布 ASP.NET MVC 应用程序，而无需终端服务器甚至不必了解 ASP.NET MVC，只要它具有 ASP.NET 3.5（我认为是 SP1）
*   ASP.NET MVC 完全是关于单元测试的，它在这方面非常灵活，甚至 ASP.NET MVC 背后的一些设计决策都是基于允许用户对其代码进行单元测试。Scott Guthrie 在最新版本的 ASP.NET MVC (beta) [http://weblogs.asp.net/scottgu/archive/2008/10/16/asp-net-mvc-beta-released.aspx#六](http://weblogs.asp.net/scottgu/archive/2008/10/16/asp-net-mvc-beta-released.aspx#six)
*   只要不依赖回发，任何与 ASP.NET WebForms 一起使用的控件都可以与 ASP.NET MVC 一起使用。如果确实如此，则您不能使用该控件/代码。

MVC 是一种经过验证的网站设计模式，甚至您发布问题的那个模式也是基于 ASP.NET MVC 的，并且仅由少数人构建，现在由 1（一）人（即将成为 2 人）维护。我目前正在将它用于 3 个私人项目，我喜欢它。我已经看到了光明，我永远不会回到 WebForms。

资源：

*   [斯科特·格思里的博客](http://weblogs.asp.net/scottgu)
*   [菲尔·哈克的博客](http://www.haacked.com/)
*   [Rob Conery 的博客](http://blog.wekeroad.com/)他创建了超过 25 个视频的 MVC Storefront 演示。
*   [斯科特·汉塞尔曼的博客](http://www.hanselman.com/blog/)
*   [斯蒂芬·瓦尔特的博客](http://stephenwalther.com/blog/)
*   [PDC08 ASP.NET MVC Session](http://channel9.msdn.com/pdc2008/PC21/) Session 由 Phil Haack 和 Jeff Atwood（本网站的创建者）主持。

！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-12T18:21:11.953

本站使用 MVC。我认为 StackOverflow 背后的团队有资格作为一家小商店。不过他们有很多经验。尽管如此，考虑到参与的人数（几个）和服务器的数量，是的，它很小。在我看来，它运行得非常好。

# wpf - WPF 绑定到元素属性的 XPath 可达值

> ID：436333
> 
> 赞同：3
> 
> 时间：2009-01-12T17:56:39.320
> 
> 标签：wpf, xaml, .net-3.5, xpath, binding

我想从元素的属性绑定到只能通过 XPath 访问的值。

该元素是由一些 XML 填充的 ComboBox，其属性是 SelectedItem。SelectedItem 指向一个 XML 元素，我想绑定到其中的一个子元素的值，这可以通过 XPath 访问。

到目前为止，XAML 看起来像这样：

```
 <StackPanel Orientation="Vertical" Margin="10,10">
        <StackPanel Orientation="Horizontal">
          <Label>Partner</Label>
          <ComboBox Name="Partner" Margin="10,0" 
                    ItemsSource="{Binding XPath=/Root/Tables/Partners/row}" 
                    ItemTemplate="{StaticResource Partner}"/>
        </StackPanel>
        <Button Margin="25,15" Name="Submit" Width="100" Height="30" IsDefault="True"
                CommandParameter="{Binding ElementName=Partner, Path=SelectedItem}">
                Okay
        </Button>
      </StackPanel> 
```

源 XML 如下所示：

```
<Root>
  <Tables>
    <Partners>
      <row>
        <PartnerID>1</PartnerID>
        <Name>FooBar.Com</Name>
      </row>
      <row>
      .
      .
      .
      </row>
    </Partners>
  </Tables>
</Root> 
```

我的问题是 Button 的 CommandParameter 绑定到其中包含太多信息的 XmlElement。我想让 CommandParameter 引用一个子元素，就像我可以使用“XPath=PartnerID”指定一个额外的向下钻取来返回我真正感兴趣的整数值。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-12T19:54:11.347

最终自己弄清楚了。解决方案是将按钮的 DataContext 设置为组合框的 SelectedItem，然后将 CommandParameter 设置为 XPath 绑定，如下所示：

```
<Button DataContext="{Binding ElementName=Partner, Path=SelectedItem}" 
        Margin="25,15" Name="Submit" Width="100" Height="30" IsDefault="True"
        CommandParameter="{Binding XPath=PartnerID/text()}">Okay</Button> 
```

# sql - 何时或为什么要使用右外连接而不是左连接？

> ID：436345
> 
> 赞同：73
> 
> 时间：2009-01-12T17:59:25.197
> 
> 标签：sql, database, right-join

[维基百科](http://en.wikipedia.org/wiki/Join_(SQL)#)指出：

“在实践中，很少使用显式右外连接，因为它们总是可以用左外连接替换，并且不提供额外的功能。”

谁能提供他们更喜欢使用 RIGHT 表示法的情况，为什么？我想不出使用它的理由。对我来说，它永远不会让事情变得更清楚。

编辑：我是一名 Oracle 资深人士，我制定了新年决议，让自己摆脱 (+) 语法。我想做对

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-01-12T18:08:04.163

我能想到使用 RIGHT OUTER JOIN 的唯一原因是尝试使您的 SQL 更具自我记录性。

您可能希望对在一对多关系的从属（多）侧具有空行的查询使用左连接，对在独立侧生成空行的那些查询使用右连接。

这也可能发生在生成的代码中，或者如果商店的编码要求在 FROM 子句中指定了表的声明顺序。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-01-12T18:25:29.980

B RIGHT JOIN A 与 A LEFT JOIN B 相同

B RIGHT JOIN A 读作：B ON RIGHT, THEN JOINS A. 表示 A 在数据集的左侧。和 A LEFT JOIN B 一样

如果您将 LEFT JOIN 重新排列为 RIGHT，则无法获得任何性能。

我能想到为什么要使用 RIGHT JOIN 的唯一原因是，如果您是那种喜欢从内而外思考的人（从详细信息右连接标题中选择 *）。就像其他人喜欢little-endian，其他人喜欢big-endian，其他人喜欢自上而下设计，其他人喜欢自下而上设计。

另一种情况是，如果您已经有一个庞大的查询，您想在其中添加另一个表，而重新排列查询很麻烦，那么只需使用 RIGHT JOIN 将表插入现有查询。

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2015-02-20T14:26:50.837

我以前从未使用`right join`过，也从未想过我真的需要它，而且看起来有点不自然。但是在我考虑之后，它在这种情况下真的很有用，当你需要外连接一个表和许多表的交集时，你有这样的表：

![在此处输入图像描述](https://i.stack.imgur.com/jhkPn.png)

并希望得到这样的结果：

![在此处输入图像描述](https://i.stack.imgur.com/lxLHS.png)

或者，在 SQL (MS SQL Server) 中：

```
declare @temp_a table (id int)
declare @temp_b table (id int)
declare @temp_c table (id int)
declare @temp_d table (id int)

insert into @temp_a
select 1 union all
select 2 union all
select 3 union all
select 4

insert into @temp_b
select 2 union all
select 3 union all
select 5

insert into @temp_c
select 1 union all
select 2 union all
select 4

insert into @temp_d
select id from @temp_a
union
select id from @temp_b
union
select id from @temp_c

select *
from @temp_a as a
    inner join @temp_b as b on b.id = a.id
    inner join @temp_c as c on c.id = a.id
    right outer join @temp_d as d on d.id = a.id

id          id          id          id
----------- ----------- ----------- -----------
NULL        NULL        NULL        1
2           2           2           2
NULL        NULL        NULL        3
NULL        NULL        NULL        4
NULL        NULL        NULL        5 
```

因此，如果您切换到`left join`，结果将不一样。

```
select *
from @temp_d as d
    left outer join @temp_a as a on a.id = d.id
    left outer join @temp_b as b on b.id = d.id
    left outer join @temp_c as c on c.id = d.id

id          id          id          id
----------- ----------- ----------- -----------
1           1           NULL        1
2           2           2           2
3           3           3           NULL
4           4           NULL        4
5           NULL        5           NULL 
```

没有正确连接的唯一方法是使用公用表表达式或子查询

```
select *
from @temp_d as d
    left outer join (
        select *
        from @temp_a as a
            inner join @temp_b as b on b.id = a.id
            inner join @temp_c as c on c.id = a.id
    ) as q on ... 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-01-12T18:09:20.497

唯一一次我会想到右外连接是在修复全连接时，碰巧我需要结果包含右侧表中的所有记录。不过，即使我很懒惰，我也可能会非常恼火，以至于我会重新排列它以使用左连接。

这个来自[维基百科](http://en.wikipedia.org/wiki/Join_(SQL))的例子说明了我的意思：

```
SELECT *  
FROM   employee 
   FULL OUTER JOIN department 
      ON employee.DepartmentID = department.DepartmentID 
```

如果您只是将单词替换为`FULL`您`RIGHT`有一个新查询，则无需交换`ON`子句的顺序。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-12T18:25:39.120

```
SELECT * FROM table1 [BLANK] OUTER JOIN table2 ON table1.col = table2.col 
```

将 [空白] 替换为：

LEFT - 如果您想要 table1 中的所有记录，即使它们没有与 table2 匹配的 col（也包括与 table2 匹配的记录）

右 - 如果您想要 table2 中的所有记录，即使它们没有与 table1 匹配的 col（也包括匹配的 table1 记录）

FULL - 如果您想要 table1 和 table2 中的所有记录

*每个人都在谈论什么？他们是一样的吗？我不这么认为。*

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-10-07T15:10:06.653

```
SELECT * FROM table_a
INNER JOIN table_b ON ....
RIGHT JOIN table_c ON .... 
```

在确保始终选择 table_c 中的所有行的同时，您还能如何快速/轻松地内部连接前 2 个表并与 table_c 连接？

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2016-12-10T13:16:45.220

我真的不必对正确的连接考虑太多，但我想我在近 20 年的编写 SQL 查询中还没有遇到过使用它的合理理由。我当然已经看到了很多我猜想来自开发人员使用内置查询构建器的地方。

每当我遇到一个，我都会重写查询以消除它 - 我发现如果你有一段时间没有访问过查询并且它没有访问，他们只是需要太多额外的精神能量来学习或重新学习查询的意图丢失或返回不正确的结果并不常见——通常正是这种不正确导致我要求检查查询为什么不起作用。

在考虑它时，一旦你引入了右连接，你现在就有了我认为需要在中间相遇的竞争逻辑分支。如果引入了额外的要求/条件，这两个分支可能会进一步扩展，您现在需要处理更多复杂性，以确保一个分支不会导致不正确的结果。

此外，一旦您引入了右连接，稍后处理查询的其他经验不足的开发人员可能会简单地将附加表添加到查询的右连接部分，这样做会扩展仍然需要满足的竞争逻辑流中间; 或者在我见过的某些情况下，开始嵌套视图是因为他们不想触及原始逻辑，这可能部分是因为他们可能不理解驱动逻辑的查询或业务规则。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-12T18:12:31.643

SQL 语句除了正确之外，还应尽可能易于阅读和表达简洁（因为它们代表单个原子操作，您需要完全理解它们以避免意外后果。）有时表达式更清楚地表述为右外连接。

但是一个总是可以转换成另一个，优化器对一个和另一个一样好。

在相当长的一段时间里，至少有一个主要的 rdbms 产品只支持 LEFT OUTER JOIN。（我相信是 MySQL。）

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-01-12T21:18:25.530

我使用右连接的唯一一次是当我想查看两组数据并且我已经从先前编写的查询中获得了左连接或内连接的特定顺序的连接。在这种情况下，假设您希望将未包含在表 a 中但包含在表 b 中的记录视为一组数据，而在另一组数据中将记录不在表 b 中但在表 a 中。即使这样，我也倾向于这样做只是为了节省研究时间，但如果它是多次运行的代码，我会改变它。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2017-01-17T15:12:53.590

在某些 SQL 数据库中，有优化器提示告诉优化器按照它们在`FROM`子句中出现的顺序连接表 - 例如[`/*+ORDERED */`](https://docs.oracle.com/cd/B12037_01/server.101/b10752/hintsref.htm#5555)在 Oracle 中。在一些简单的实现中，这甚至可能是唯一可用的执行计划。

`FROM`在这种情况下，子句中表的顺序很重要，因此`RIGHT JOIN`可能很有用。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-09-27T06:52:20.293

我认为如果您在这种情况下没有正确的加入，这很困难。前与甲骨文。

```
with a as(
     select 1 id, 'a' name from dual union all
     select 2 id, 'b' name from dual union all
     select 3 id, 'c' name from dual union all
     select 4 id, 'd' name from dual union all
     select 5 id, 'e' name from dual union all
     select 6 id, 'f' name from dual 
), bx as(
   select 1 id, 'fa' f from dual union all
   select 3 id, 'fb' f from dual union all
   select 6 id, 'f' f from dual union all
   select 6 id, 'fc' f from dual 
)
select a.*, b.f, x.f
from a left join bx b on a.id = b.id
right join bx x on a.id = x.id
order by a.id 
```

# sql-server - 在数据库中的任何位置查找值

> ID：436351
> 
> 赞同：285
> 
> 时间：2009-01-12T18:00:53.070
> 
> 标签：sql-server, tsql

给定一个数字，我如何发现它可以在哪个表和列中找到？

我不在乎它是否很快，它只需要工作。

* * *

## 回答 #1

> 赞同：319
> 
> 时间：2009-01-12T18:10:24.473

[这可能会帮助你](http://vyaskn.tripod.com/search_all_columns_in_all_tables.htm)。- 来自纳拉亚纳维亚斯。它搜索给定数据库中所有表的所有列。我以前用过它，它可以工作。

这是来自上述链接的存储过程 - 我所做的唯一更改是将临时表替换为表变量，这样您就不必记住每次都删除它。

```
CREATE PROC SearchAllTables
(
    @SearchStr nvarchar(100)
)
AS
BEGIN

-- Copyright © 2002 Narayana Vyas Kondreddi. All rights reserved.
-- Purpose: To search all columns of all tables for a given search string
-- Written by: Narayana Vyas Kondreddi
-- Site: http://vyaskn.tripod.com
-- Tested on: SQL Server 7.0 and SQL Server 2000
-- Date modified: 28th July 2002 22:50 GMT

DECLARE @Results TABLE(ColumnName nvarchar(370), ColumnValue nvarchar(3630))

SET NOCOUNT ON

DECLARE @TableName nvarchar(256), @ColumnName nvarchar(128), @SearchStr2 nvarchar(110)
SET  @TableName = ''
SET @SearchStr2 = QUOTENAME('%' + @SearchStr + '%','''')

WHILE @TableName IS NOT NULL
BEGIN
    SET @ColumnName = ''
    SET @TableName = 
    (
        SELECT MIN(QUOTENAME(TABLE_SCHEMA) + '.' + QUOTENAME(TABLE_NAME))
        FROM    INFORMATION_SCHEMA.TABLES
        WHERE       TABLE_TYPE = 'BASE TABLE'
            AND QUOTENAME(TABLE_SCHEMA) + '.' + QUOTENAME(TABLE_NAME) > @TableName
            AND OBJECTPROPERTY(
                    OBJECT_ID(
                        QUOTENAME(TABLE_SCHEMA) + '.' + QUOTENAME(TABLE_NAME)
                         ), 'IsMSShipped'
                           ) = 0
    )

    WHILE (@TableName IS NOT NULL) AND (@ColumnName IS NOT NULL)
    BEGIN
        SET @ColumnName =
        (
            SELECT MIN(QUOTENAME(COLUMN_NAME))
            FROM    INFORMATION_SCHEMA.COLUMNS
            WHERE       TABLE_SCHEMA    = PARSENAME(@TableName, 2)
                AND TABLE_NAME  = PARSENAME(@TableName, 1)
                AND DATA_TYPE IN ('char', 'varchar', 'nchar', 'nvarchar')
                AND QUOTENAME(COLUMN_NAME) > @ColumnName
        )

        IF @ColumnName IS NOT NULL
        BEGIN
            INSERT INTO @Results
            EXEC
            (
                'SELECT ''' + @TableName + '.' + @ColumnName + ''', LEFT(' + @ColumnName + ', 3630) 
                FROM ' + @TableName + 
                ' WHERE ' + @ColumnName + ' LIKE ' + @SearchStr2
            )
        END
    END 
END

SELECT ColumnName, ColumnValue FROM @Results
END 
```

要执行存储过程：

```
 EXEC SearchAllTables 'YourStringHere' 
```

* * *

## 回答 #2

> 赞同：80
> 
> 时间：2013-03-21T10:35:06.527

如果您只需要运行一次此类搜索，那么您可能可以使用其他答案中已经显示的任何脚本。但除此之外，我建议为此使用[ApexSQL Search](http://www.apexsql.com/sql_tools_search.aspx)。这是一个免费的 SSMS 插件，它真的为我节省了很多时间。

在运行任何脚本之前，您应该根据要搜索的数据类型对其进行自定义。如果您知道要搜索 datetime 列，则无需搜索 nvarchar 列。这将加快上述所有查询。

* * *

## 回答 #3

> 赞同：78
> 
> 时间：2009-01-12T19:29:54.890

根据 bnkdev 的回答，我修改了[Narayana 的代码](http://vyaskn.tripod.com/search_all_columns_in_all_tables.htm)以搜索所有列，甚至是数字列。

它会运行得更慢，但这个版本实际上会找到所有匹配项，而不仅仅是在文本列中找到的匹配项。

我不能感谢这个人。节省了我手动搜索的时间！

```
CREATE PROC SearchAllTables 
(
@SearchStr nvarchar(100)
)
AS
BEGIN

-- Copyright © 2002 Narayana Vyas Kondreddi. All rights reserved.
-- Purpose: To search all columns of all tables for a given search string
-- Written by: Narayana Vyas Kondreddi
-- Site: http://vyaskn.tripod.com
-- Tested on: SQL Server 7.0 and SQL Server 2000
-- Date modified: 28th July 2002 22:50 GMT

CREATE TABLE #Results (ColumnName nvarchar(370), ColumnValue nvarchar(3630))

SET NOCOUNT ON

DECLARE @TableName nvarchar(256), @ColumnName nvarchar(128), @SearchStr2 nvarchar(110)
SET  @TableName = ''
SET @SearchStr2 = QUOTENAME('%' + @SearchStr + '%','''')

WHILE @TableName IS NOT NULL
BEGIN
    SET @ColumnName = ''
    SET @TableName = 
    (
        SELECT MIN(QUOTENAME(TABLE_SCHEMA) + '.' + QUOTENAME(TABLE_NAME))
        FROM    INFORMATION_SCHEMA.TABLES
        WHERE       TABLE_TYPE = 'BASE TABLE'
            AND QUOTENAME(TABLE_SCHEMA) + '.' + QUOTENAME(TABLE_NAME) > @TableName
            AND OBJECTPROPERTY(
                    OBJECT_ID(
                        QUOTENAME(TABLE_SCHEMA) + '.' + QUOTENAME(TABLE_NAME)
                         ), 'IsMSShipped'
                           ) = 0
    )

    WHILE (@TableName IS NOT NULL) AND (@ColumnName IS NOT NULL)
    BEGIN
        SET @ColumnName =
        (
            SELECT MIN(QUOTENAME(COLUMN_NAME))
            FROM    INFORMATION_SCHEMA.COLUMNS
            WHERE       TABLE_SCHEMA    = PARSENAME(@TableName, 2)
                AND TABLE_NAME  = PARSENAME(@TableName, 1)                  
                AND QUOTENAME(COLUMN_NAME) > @ColumnName
        )

        IF @ColumnName IS NOT NULL
        BEGIN
            INSERT INTO #Results
            EXEC
            (
                'SELECT ''' + @TableName + '.' + @ColumnName + ''', LEFT(CONVERT(varchar(max), ' + @ColumnName + '), 3630) 
                FROM ' + @TableName + ' (NOLOCK) ' +
                ' WHERE CONVERT(varchar(max), ' + @ColumnName + ') LIKE ' + @SearchStr2
            )
        END
    END 
END

SELECT ColumnName, ColumnValue FROM #Results
END 
```

* * *

## 回答 #4

> 赞同：40
> 
> 时间：2012-09-06T18:55:22.933

这是我对这个问题的独立看法，我将其用于我自己的工作。它适用于 SQL2000 及更高版本，允许通配符、列过滤，并且将搜索大多数普通数据类型。

伪代码描述可能是`select * from * where any like 'foo'`

```
--------------------------------------------------------------------------------
-- Search all columns in all tables in a database for a string.
-- Does not search: image, sql_variant or user-defined types.
-- Exact search always for money and smallmoney; no wildcards for matching these.
--------------------------------------------------------------------------------
declare @SearchTerm nvarchar(4000) -- Can be max for SQL2005+
declare @ColumnName sysname

--------------------------------------------------------------------------------
-- SET THESE!
--------------------------------------------------------------------------------
set @SearchTerm = N'foo' -- Term to be searched for, wildcards okay
set @ColumnName = N'' -- Use to restrict the search to certain columns, wildcards okay, null or empty string for all cols
--------------------------------------------------------------------------------
-- END SET
--------------------------------------------------------------------------------

set nocount on

declare @TabCols table (
      id int not null primary key identity
    , table_schema sysname not null
    , table_name sysname not null
    , column_name sysname not null
    , data_type sysname not null
)
insert into @TabCols (table_schema, table_name, column_name, data_type)
    select t.TABLE_SCHEMA, c.TABLE_NAME, c.COLUMN_NAME, c.DATA_TYPE
    from INFORMATION_SCHEMA.TABLES t
        join INFORMATION_SCHEMA.COLUMNS c on t.TABLE_SCHEMA = c.TABLE_SCHEMA
            and t.TABLE_NAME = c.TABLE_NAME
    where 1 = 1
        and t.TABLE_TYPE = 'base table'
        and c.DATA_TYPE not in ('image', 'sql_variant')
        and c.COLUMN_NAME like case when len(@ColumnName) > 0 then @ColumnName else '%' end
    order by c.TABLE_NAME, c.ORDINAL_POSITION

declare
      @table_schema sysname
    , @table_name sysname
    , @column_name sysname
    , @data_type sysname
    , @exists nvarchar(4000) -- Can be max for SQL2005+
    , @sql nvarchar(4000) -- Can be max for SQL2005+
    , @where nvarchar(4000) -- Can be max for SQL2005+
    , @run nvarchar(4000) -- Can be max for SQL2005+

while exists (select null from @TabCols) begin

    select top 1
          @table_schema = table_schema
        , @table_name = table_name
        , @exists = 'select null from [' + table_schema + '].[' + table_name + '] where 1 = 0'
        , @sql = 'select ''' + '[' + table_schema + '].[' + table_name + ']' + ''' as TABLE_NAME, * from [' + table_schema + '].[' + table_name + '] where 1 = 0'
        , @where = ''
    from @TabCols
    order by id

    while exists (select null from @TabCols where table_schema = @table_schema and table_name = @table_name) begin

        select top 1
              @column_name = column_name
            , @data_type = data_type
        from @TabCols
        where table_schema = @table_schema
            and table_name = @table_name
        order by id

        -- Special case for money
        if @data_type in ('money', 'smallmoney') begin
            if isnumeric(@SearchTerm) = 1 begin
                set @where = @where + ' or [' + @column_name + '] = cast(''' + @SearchTerm + ''' as ' + @data_type + ')' -- could also cast the column as varchar for wildcards
            end
        end
        -- Special case for xml
        else if @data_type = 'xml' begin
            set @where = @where + ' or cast([' + @column_name + '] as nvarchar(max)) like ''' + @SearchTerm + ''''
        end
        -- Special case for date
        else if @data_type in ('date', 'datetime', 'datetime2', 'datetimeoffset', 'smalldatetime', 'time') begin
            set @where = @where + ' or convert(nvarchar(50), [' + @column_name + '], 121) like ''' + @SearchTerm + ''''
        end
        -- Search all other types
        else begin
            set @where = @where + ' or [' + @column_name + '] like ''' + @SearchTerm + ''''
        end

        delete from @TabCols where table_schema = @table_schema and table_name = @table_name and column_name = @column_name

    end

    set @run = 'if exists(' + @exists + @where + ') begin ' + @sql + @where + ' print ''' + @table_name + ''' end'
    print @run
    exec sp_executesql @run

end

set nocount off 
```

我不把它放在 proc 形式中，因为我不想在数百个数据库中维护它，而且它真的是为了临时工作。请随时对错误修复发表评论。

* * *

## 回答 #5

> 赞同：21
> 
> 时间：2015-01-21T22:29:16.477

我优化了 Alllain Lalonde 的答案（[https://stackoverflow.com/a/436676/412368](https://stackoverflow.com/a/436676/412368)）。仍然支持数值。应该快大约 4-5 倍（1:03 对 4:30），在具有 7GB 数据库的桌面上进行测试。[http://developer.azurewebsites.net/2015/01/mssql-searchalltables/](http://developer.azurewebsites.net/2015/01/mssql-searchalltables/)

```
IF OBJECT_ID ('dbo.SearchAllTables', 'P') IS NOT NULL 
    DROP PROCEDURE dbo.SearchAllTables;
GO

CREATE PROC SearchAllTables 
(
    @SearchStr nvarchar(100)
)
AS
BEGIN

-- Copyright © 2002 Narayana Vyas Kondreddi. All rights reserved.
-- Purpose: To search all columns of all tables for a given search string
-- Written by: Narayana Vyas Kondreddi
-- Site: http://vyaskn.tripod.com
-- Customized and modified: 2014-01-21
-- Tested on: SQL Server 2008 R2

DECLARE @Results TABLE(ColumnName nvarchar(370), ColumnValue nvarchar(3630))

SET NOCOUNT ON

DECLARE @TableName nvarchar(256)
DECLARE @ColumnName nvarchar(128)
DECLARE @DataType nvarchar(128)

DECLARE @SearchStr2 nvarchar(110)
DECLARE @SearchDecimal decimal(38,19)
DECLARE @Query nvarchar(4000)
SET @SearchStr2 = QUOTENAME('%' + @SearchStr + '%', '''')
SET @SearchDecimal = CASE WHEN ISNUMERIC(@SearchStr) = 1 THEN CONVERT(decimal(38,19), @SearchStr) ELSE NULL END
PRINT '@SearchStr2: ' + @SearchStr2
PRINT '@SearchDecimal: ' + CAST(@SearchDecimal AS nvarchar)

SET @TableName = ''
WHILE @TableName IS NOT NULL
BEGIN
    SET @ColumnName = ''
    SET @TableName = 
    (
        SELECT MIN(QUOTENAME(TABLE_SCHEMA) + '.' + QUOTENAME(TABLE_NAME))
        FROM    INFORMATION_SCHEMA.TABLES
        WHERE       TABLE_TYPE = 'BASE TABLE'
            AND QUOTENAME(TABLE_SCHEMA) + '.' + QUOTENAME(TABLE_NAME) > @TableName
            AND OBJECTPROPERTY(
                    OBJECT_ID(
                        QUOTENAME(TABLE_SCHEMA) + '.' + QUOTENAME(TABLE_NAME)
                         ), 'IsMSShipped'
                           ) = 0
    )

    WHILE (@TableName IS NOT NULL) AND (@ColumnName IS NOT NULL)
    BEGIN
        SET @ColumnName =
        (
            SELECT MIN(QUOTENAME(COLUMN_NAME))
                    DATA_TYPE
            FROM    INFORMATION_SCHEMA.COLUMNS
            WHERE       TABLE_SCHEMA    = PARSENAME(@TableName, 2)
                AND TABLE_NAME  = PARSENAME(@TableName, 1)
                AND DATA_TYPE IN ('char', 'varchar', 'nchar', 'nvarchar',
                                  'int', 'bigint', 'tinyint', 'numeric', 'decimal')
                AND QUOTENAME(COLUMN_NAME) > @ColumnName
        )
        SET @DataType =
        (
            SELECT DATA_TYPE
            FROM    INFORMATION_SCHEMA.COLUMNS
            WHERE       TABLE_SCHEMA    = PARSENAME(@TableName, 2)
                AND TABLE_NAME  = PARSENAME(@TableName, 1)
                AND QUOTENAME(COLUMN_NAME) = @ColumnName
        )
        PRINT @TableName + '.' + @ColumnName + ' (' + @DataType + ')'

        IF @ColumnName IS NOT NULL
        BEGIN
            IF @DataType IN ('int', 'bigint', 'tinyint', 'numeric', 'decimal')
            BEGIN
                IF @SearchDecimal IS NOT NULL
                BEGIN
                    SET @Query = 'SELECT ''' + @TableName + '.' + @ColumnName + ''', LEFT(CAST(' + @ColumnName + ' AS nvarchar(110)), 3630) ' +
                                 'FROM ' + @TableName + ' (NOLOCK) ' +
                                 ' WHERE ' + @ColumnName + ' = ' + CAST(@SearchDecimal AS nvarchar)
                    PRINT '    ' + @Query
                    INSERT INTO @Results
                    EXEC (@Query)
                END
            END
            ELSE
            BEGIN
                SET @Query = 'SELECT ''' + @TableName + '.' + @ColumnName + ''', LEFT(' + @ColumnName + ', 3630) ' +
                             'FROM ' + @TableName + ' (NOLOCK) ' +
                             ' WHERE ' + @ColumnName + ' LIKE ' + @SearchStr2
                PRINT '    ' + @Query
                INSERT INTO @Results
                EXEC (@Query)
            END
        END
    END 
END

SELECT ColumnName, ColumnValue FROM @Results
END 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2014-08-18T23:51:09.493

不久前我有一个解决方案，我一直在改进。如果被告知，还会在 XML 列中搜索，或者如果提供仅整数字符串，则搜索整数值。

```
/* Reto Egeter, fullparam.wordpress.com */

DECLARE @SearchStrTableName nvarchar(255), @SearchStrColumnName nvarchar(255), @SearchStrColumnValue nvarchar(255), @SearchStrInXML bit, @FullRowResult bit, @FullRowResultRows int
SET @SearchStrColumnValue = '%searchthis%' /* use LIKE syntax */
SET @FullRowResult = 1
SET @FullRowResultRows = 3
SET @SearchStrTableName = NULL /* NULL for all tables, uses LIKE syntax */
SET @SearchStrColumnName = NULL /* NULL for all columns, uses LIKE syntax */
SET @SearchStrInXML = 0 /* Searching XML data may be slow */

IF OBJECT_ID('tempdb..#Results') IS NOT NULL DROP TABLE #Results
CREATE TABLE #Results (TableName nvarchar(128), ColumnName nvarchar(128), ColumnValue nvarchar(max),ColumnType nvarchar(20))

SET NOCOUNT ON

DECLARE @TableName nvarchar(256) = '',@ColumnName nvarchar(128),@ColumnType nvarchar(20), @QuotedSearchStrColumnValue nvarchar(110), @QuotedSearchStrColumnName nvarchar(110)
SET @QuotedSearchStrColumnValue = QUOTENAME(@SearchStrColumnValue,'''')
DECLARE @ColumnNameTable TABLE (COLUMN_NAME nvarchar(128),DATA_TYPE nvarchar(20))

WHILE @TableName IS NOT NULL
BEGIN
SET @TableName =
(
SELECT MIN(QUOTENAME(TABLE_SCHEMA) + '.' + QUOTENAME(TABLE_NAME))
FROM INFORMATION_SCHEMA.TABLES
WHERE TABLE_TYPE = 'BASE TABLE'
AND TABLE_NAME LIKE COALESCE(@SearchStrTableName,TABLE_NAME)
AND QUOTENAME(TABLE_SCHEMA) + '.' + QUOTENAME(TABLE_NAME) > @TableName
AND OBJECTPROPERTY(OBJECT_ID(QUOTENAME(TABLE_SCHEMA) + '.' + QUOTENAME(TABLE_NAME)), 'IsMSShipped') = 0
)
IF @TableName IS NOT NULL
BEGIN
DECLARE @sql VARCHAR(MAX)
SET @sql = 'SELECT QUOTENAME(COLUMN_NAME),DATA_TYPE
FROM INFORMATION_SCHEMA.COLUMNS
WHERE TABLE_SCHEMA = PARSENAME(''' + @TableName + ''', 2)
AND TABLE_NAME = PARSENAME(''' + @TableName + ''', 1)
AND DATA_TYPE IN (' + CASE WHEN ISNUMERIC(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(@SearchStrColumnValue,'%',''),'_',''),'[',''),']',''),'-','')) = 1 THEN '''tinyint'',''int'',''smallint'',''bigint'',''numeric'',''decimal'',''smallmoney'',''money'',' ELSE '' END + '''char'',''varchar'',''nchar'',''nvarchar'',''timestamp'',''uniqueidentifier''' + CASE @SearchStrInXML WHEN 1 THEN ',''xml''' ELSE '' END + ')
AND COLUMN_NAME LIKE COALESCE(' + CASE WHEN @SearchStrColumnName IS NULL THEN 'NULL' ELSE '''' + @SearchStrColumnName + '''' END + ',COLUMN_NAME)'
INSERT INTO @ColumnNameTable
EXEC (@sql)
WHILE EXISTS (SELECT TOP 1 COLUMN_NAME FROM @ColumnNameTable)
BEGIN
PRINT @ColumnName
SELECT TOP 1 @ColumnName = COLUMN_NAME,@ColumnType = DATA_TYPE FROM @ColumnNameTable
SET @sql = 'SELECT ''' + @TableName + ''',''' + @ColumnName + ''',' + CASE @ColumnType WHEN 'xml' THEN 'LEFT(CAST(' + @ColumnName + ' AS nvarchar(MAX)), 4096),'''
WHEN 'timestamp' THEN 'master.dbo.fn_varbintohexstr('+ @ColumnName + '),'''
ELSE 'LEFT(' + @ColumnName + ', 4096),''' END + @ColumnType + '''
FROM ' + @TableName + ' (NOLOCK) ' +
' WHERE ' + CASE @ColumnType WHEN 'xml' THEN 'CAST(' + @ColumnName + ' AS nvarchar(MAX))'
WHEN 'timestamp' THEN 'master.dbo.fn_varbintohexstr('+ @ColumnName + ')'
ELSE @ColumnName END + ' LIKE ' + @QuotedSearchStrColumnValue
INSERT INTO #Results
EXEC(@sql)
IF @@ROWCOUNT > 0 IF @FullRowResult = 1
BEGIN
SET @sql = 'SELECT TOP ' + CAST(@FullRowResultRows AS VARCHAR(3)) + ' ''' + @TableName + ''' AS [TableFound],''' + @ColumnName + ''' AS [ColumnFound],''FullRow>'' AS [FullRow>],*' +
' FROM ' + @TableName + ' (NOLOCK) ' +
' WHERE ' + CASE @ColumnType WHEN 'xml' THEN 'CAST(' + @ColumnName + ' AS nvarchar(MAX))'
WHEN 'timestamp' THEN 'master.dbo.fn_varbintohexstr('+ @ColumnName + ')'
ELSE @ColumnName END + ' LIKE ' + @QuotedSearchStrColumnValue
EXEC(@sql)
END
DELETE FROM @ColumnNameTable WHERE COLUMN_NAME = @ColumnName
END 
END
END
SET NOCOUNT OFF

SELECT TableName, ColumnName, ColumnValue, ColumnType, COUNT(*) AS Count FROM #Results
GROUP BY TableName, ColumnName, ColumnValue, ColumnType 
```

资料来源： http: [//fullparam.wordpress.com/2012/09/07/fck-it-i-am-going-to-search-all-tables-all-collumns/](http://fullparam.wordpress.com/2012/09/07/fck-it-i-am-going-to-search-all-tables-all-collumns/)

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2013-02-20T17:17:20.707

这是我解决这个问题的方法。在 SQLServer2008R2 上测试

```
CREATE PROC SearchAllTables
@SearchStr nvarchar(100)
AS
BEGIN
DECLARE @dml nvarchar(max) = N''        
IF OBJECT_ID('tempdb.dbo.#Results') IS NOT NULL DROP TABLE dbo.#Results
CREATE TABLE dbo.#Results
 ([tablename] nvarchar(100), 
  [ColumnName] nvarchar(100), 
  [Value] nvarchar(max))  
SELECT @dml += ' SELECT ''' + s.name + '.' + t.name + ''' AS [tablename], ''' + 
                c.name + ''' AS [ColumnName], CAST(' + QUOTENAME(c.name) + 
               ' AS nvarchar(max)) AS [Value] FROM ' + QUOTENAME(s.name) + '.' + QUOTENAME(t.name) +
               ' (NOLOCK) WHERE CAST(' + QUOTENAME(c.name) + ' AS nvarchar(max)) LIKE ' + '''%' + @SearchStr + '%'''
FROM sys.schemas s JOIN sys.tables t ON s.schema_id = t.schema_id
                   JOIN sys.columns c ON t.object_id = c.object_id
                   JOIN sys.types ty ON c.system_type_id = ty.system_type_id AND c .user_type_id = ty .user_type_id
WHERE t.is_ms_shipped = 0 AND ty.name NOT IN ('timestamp', 'image', 'sql_variant')

INSERT dbo.#Results
EXEC sp_executesql @dml

SELECT *
FROM dbo.#Results
END 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2011-06-16T10:35:22.627

感谢您提供真正有用的脚本。

如果您的表具有不可转换的字段，您可能需要在代码中添加以下修改：

```
SET @ColumnName =
    (
        SELECT MIN(QUOTENAME(COLUMN_NAME))
        FROM    INFORMATION_SCHEMA.COLUMNS
        WHERE       TABLE_SCHEMA    = PARSENAME(@TableName, 2)
            AND TABLE_NAME  = PARSENAME(@TableName, 1)
            AND DATA_TYPE NOT IN ('text', 'image', 'ntext')                 
            AND QUOTENAME(COLUMN_NAME) > @ColumnName
    ) 
```

克里斯

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2014-09-29T07:30:30.763

在这里，非常甜蜜和小解决方案：

```
1) create a store procedure:

create procedure get_table
@find_str varchar(50)
as 
begin
  declare @col_name varchar(500), @tab_name varchar(500);
  declare @find_tab TABLE(table_name varchar(100), column_name varchar(100));

  DECLARE tab_col cursor for 
  select C.name as 'col_name', T.name as tab_name
  from sys.tables as T
  left outer join sys.columns as C on  C.object_id=T.object_id
  left outer join sys.types as TP on  C.system_type_id=TP.system_type_id
  where type='U' 
  and TP.name in('text','ntext','varchar','char','nvarchar','nchar');

  open tab_col
  fetch next from tab_col into @col_name, @tab_name

  while @@FETCH_STATUS = 0
  begin        
    insert into @find_tab 
    exec('select ''' +  @tab_name + ''',''' + @col_name + ''' from ' + @tab_name + 
    ' where ' + @col_name + '=''' + @find_str + ''' group by ' + 
    @col_name + ' having count(*)>0');

    fetch next from tab_col into @col_name, @tab_name;
  end
  CLOSE tab_col;  
  DEALLOCATE tab_col; 
  select table_name, column_name from @find_tab;

end 
```

===========================

```
2) call procedure by calling store procedure:
exec get_table 'serach_string'; 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2015-10-02T13:39:12.483

我曾经为自己写过一个工具来做那件事：

[a7 SqlTools](http://sqltools.a7.plus "a7 SqlTools")

它是免费和开源的：

[github链接](https://github.com/alekkowalczyk/a7SqlTools)

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2013-10-30T19:45:00.793

使用 JOIN 和 CURSOR 的另一种方法：

```
USE My_Database;

-- Store results in a local temp table so that.  I'm using a
-- local temp table so that I can access it in SP_EXECUTESQL.
create table #tmp (
    tbl nvarchar(max),
    col nvarchar(max),
    val nvarchar(max)   
);

declare @tbl nvarchar(max);
declare @col nvarchar(max);
declare @q nvarchar(max);
declare @search nvarchar(max) = 'my search key';

-- Create a cursor on all columns in the database
declare c cursor for
SELECT tbls.TABLE_NAME, cols.COLUMN_NAME  FROM INFORMATION_SCHEMA.TABLES AS tbls
JOIN INFORMATION_SCHEMA.COLUMNS AS cols
ON tbls.TABLE_NAME = cols.TABLE_NAME

-- For each table and column pair, see if the search value exists.
open c
fetch next from c into @tbl, @col
while @@FETCH_STATUS = 0
begin
    -- Look for the search key in current table column and if found add it to the results.
    SET @q = 'INSERT INTO #tmp SELECT ''' + @tbl + ''', ''' + @col + ''', ' + @col + ' FROM ' + @tbl + ' WHERE ' + @col + ' LIKE ''%' + @search + '%'''
    EXEC SP_EXECUTESQL @q
    fetch next from c into @tbl, @col
end
close c
deallocate c

-- Get results
select * from #tmp

-- Remove local temp table.
drop table #tmp 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2019-12-23T07:27:03.733

如果您安装了**phpMyAdmin** ，请使用其*搜索*功能。

选择您的数据库。

确保您确实选择了数据库，而不是表，否则您将获得完全不同的搜索对话框。

1.  单击*搜索*选项卡
2.  列表项 选择您想要的搜索词
3.  选择要搜索的表

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2015-06-24T09:06:03.880

```
-- exec pSearchAllTables 'M54*'

ALTER PROC pSearchAllTables (@SearchStr NVARCHAR(100))
AS
BEGIN
    -- A procedure to search all tables in a database for a value
    -- Note: Use * or % for wildcard

    DECLARE 
        @Results TABLE([Schema.Table.ColumnName] NVARCHAR(370), ColumnValue NVARCHAR(3630))

    SET NOCOUNT ON

    DECLARE 
        @TableName NVARCHAR(256) = ''
        , @ColumnName NVARCHAR(128)     
        , @SearchStr2 NVARCHAR(110) = QUOTENAME(REPLACE(@SearchStr, '*', '%'), '''')

    WHILE @TableName IS NOT NULL
        BEGIN
            SET @ColumnName = ''
            SET @TableName = 
            (
                SELECT MIN(QUOTENAME(TABLE_SCHEMA) + '.' + QUOTENAME(TABLE_NAME))
                FROM INFORMATION_SCHEMA.TABLES
                WHERE TABLE_TYPE = 'BASE TABLE'
                AND QUOTENAME(TABLE_SCHEMA) + '.' + QUOTENAME(TABLE_NAME) > @TableName
                AND OBJECTPROPERTY(OBJECT_ID(QUOTENAME(TABLE_SCHEMA) + '.' + QUOTENAME(TABLE_NAME)), 'IsMSShipped') = 0
            )

            WHILE (@TableName IS NOT NULL) AND (@ColumnName IS NOT NULL)
                BEGIN
                    SET @ColumnName =
                    (
                        SELECT MIN(QUOTENAME(COLUMN_NAME))
                        FROM INFORMATION_SCHEMA.COLUMNS
                        WHERE TABLE_SCHEMA    = PARSENAME(@TableName, 2)
                        AND TABLE_NAME  = PARSENAME(@TableName, 1)
                        AND DATA_TYPE IN ('char', 'varchar', 'nchar', 'nvarchar')
                        AND QUOTENAME(COLUMN_NAME) > @ColumnName
                    )

                    IF @ColumnName IS NOT NULL
                        BEGIN
                            INSERT INTO @Results 
                            EXEC ('SELECT ''' + @TableName + '.' + @ColumnName + ''', LEFT(' + @ColumnName + ', 3630) FROM ' + @TableName + ' (NOLOCK) WHERE ' + @ColumnName + ' LIKE ' + @SearchStr2)

                        END

                END 

        END

    SELECT 
        [Schema.Table.ColumnName]
        , ColumnValue 
    FROM @Results
    GROUP BY 
        [Schema.Table.ColumnName]
        , ColumnValue 

END 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2016-12-21T04:05:47.450

您可能需要为您的数据库建立一个[倒排索引](https://en.wikipedia.org/wiki/Inverted_index)。可以保证非常快。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2019-01-24T13:07:17.597

出于开发目的，您只需将所需的表数据导出到单个 HTML 中并对其进行直接搜索。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2019-02-05T03:21:39.327

假设如果要获取数据库中所有名称为列名包含**登录**时间的表**MyDatabase**下面是代码示例

```
 use MyDatabase

    SELECT t.name AS table_name,
    SCHEMA_NAME(schema_id) AS schema_name,
    c.name AS column_name
    FROM sys.tables AS t
    INNER JOIN sys.columns c ON t.OBJECT_ID = c.OBJECT_ID
    WHERE c.name LIKE '%logintime%'
    ORDER BY schema_name, table_name; 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2020-04-01T12:12:04.950

数据库客户端工具（如[DBeaver](https://dbeaver.io/)或[phpMyAdmin](https://www.phpmyadmin.net/)）通常支持通过整个数据库进行全文搜索的方式。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2020-09-04T21:01:52.293

我正在寻找一个数字值 = 6.84 - 使用此处的其他答案，我能够将搜索限制在此范围内

```
Declare @sourceTable Table(id INT NOT NULL IDENTITY PRIMARY KEY, table_name varchar(1000), column_name varchar(1000))
Declare @resultsTable Table(id INT NOT NULL IDENTITY PRIMARY KEY, table_name varchar(1000))

Insert into @sourceTable(table_name, column_name)
select schema_name(t.schema_id) + '.' + t.name as[table], c.name as column_name
from sys.columns c
join sys.tables t
on t.object_id = c.object_id
where type_name(user_type_id) in ('decimal', 'numeric', 'smallmoney', 'money', 'float', 'real')
order by[table], c.column_id;

DECLARE db_cursor CURSOR FOR
Select table_name, column_name from @sourceTable
DECLARE @mytablename VARCHAR(1000);
DECLARE @mycolumnname VARCHAR(1000);

OPEN db_cursor;
FETCH NEXT FROM db_cursor INTO @mytablename, @mycolumnname

WHILE @ @FETCH_STATUS = 0
BEGIN
    Insert into @ResultsTable(table_name)
    EXEC('SELECT ''' + @mytablename + '.' + @mycolumnname + '''  FROM ' + @mytablename + ' (NOLOCK) ' +
    ' WHERE ' + @mycolumnname + '=6.84')
    FETCH NEXT FROM db_cursor INTO @mytablename, @mycolumnname  
END;
CLOSE db_cursor;
DEALLOCATE db_cursor;
Select Distinct(table_name) from @ResultsTable 
```

# git - 如何区分提交与其父级

> ID：436362
> 
> 赞同：493
> 
> 时间：2009-01-12T18:03:57.387
> 
> 标签：git, git-diff

除了编写别名或脚本之外，是否有更短的命令来获取特定提交的差异？

```
git diff 15dc8^..15dc8 
```

如果您只提供单个提交 id `git diff 15dc8`，它会将提交与 HEAD 进行比较。

* * *

## 回答 #1

> 赞同：674
> 
> 时间：2009-01-12T18:06:26.960

使用`git show $COMMIT`. 它将向您显示提交的日志消息，以及该特定提交的差异。

* * *

## 回答 #2

> 赞同：468
> 
> 时间：2009-01-16T00:43:23.973

采用：

```
git diff 15dc8^! 
```

如以下[git-rev-parse(1)](http://www.kernel.org/pub/software/scm/git/docs/git-rev-parse.html)手册页片段（或现代 Git [gitrevisions(7)](http://www.kernel.org/pub/software/scm/git/docs/gitrevisions.html)手册页）所述：

> 存在另外两种用于命名由提交及其父提交形成的集合的简写。r1^@ 表示法表示 r1 的所有父代。r1^！包括提交 r1 但不包括其所有父项。

这意味着您可以在 Git 中任何需要修订的地方使用`15dc8^!`速记。`15dc8^..15dc8`对于*diff*命令，`git diff 15dc8^..15dc8`理解为，表示commit( )`git diff 15dc8^ 15dc8`的parent和commit()的区别。`15dc8^``15dc8`

^(**注意**：`git-rev-parse(1)`手册页中的描述讨论了修订***范围***，它也需要为合并提交工作，具有多个父级。然后`r1^!`是“ `r1 --not r1^@`”即“ `r1 ^r1^1 ^r1^2 ...`”)

* * *

此外，您可以使用`git show COMMIT`获取提交描述和提交的差异。如果你只想要差异，你可以使用`git diff-tree -p COMMIT`.

* * *

## 回答 #3

> 赞同：58
> 
> 时间：2009-01-12T19:34:29.653

如果您知道多远，您可以尝试以下操作：

```
# Current branch vs. parent
git diff HEAD^ HEAD

# Current branch, diff between commits 2 and 3 times back
git diff HEAD~3 HEAD~2 
```

之前的提交工作是这样的：

```
# Parent of HEAD
git show HEAD^1

# Grandparent
git show HEAD^2 
```

有很多方法可以指定提交：

```
# Great grandparent
git show HEAD~3 
```

有关详细信息，请参阅[此页面](http://www.kernel.org/pub/software/scm/git/docs/git-rev-parse.html)。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2012-03-14T09:16:05.753

正如[mipadi 指出的那样](https://stackoverflow.com/questions/436362/how-to-diff-a-commit-with-its-parent/436368#436368)，您可以使用`git show $COMMIT`，但这也显示了一些标题和提交消息。如果您想要直接差异，请使用`git show --pretty=format:%b $COMMIT`.

这显然不是一个很短的手，所以我在我的 .gitconfig 中保留了这个别名

```
 [alias]
      sd = show --pretty=format:%b 
```

这使我能够使用`git sd $COMMIT`来*显示 diff*。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2014-08-20T02:05:14.703

[如果您使用的是Z shell](https://en.wikipedia.org/wiki/Z_shell)并设置了选项，则许多提到的示例（例如`git diff 15dc8^!`，或`git diff 15dc8^..15dc8`）都不起作用。您可以通过以下三种方式之一修复它：`extendedglob`

1.  `unsetopt extendedglob`（和/或从 .zshrc 中删除它）

2.  `setopt NO_NOMATCH`（和/或将其设置在 .zshrc 中）

3.  每次都用反斜杠逃避插入符号和砰砰声，例如，`git diff 15dc8\^\!`

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-11-26T15:40:51.450

```
git diff 15dc8 15dce~1 
```

~1 表示“父母”，~2 表示“祖父母”等。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2013-12-06T12:08:44.813

[Paul 的解决方案](https://stackoverflow.com/questions/436362/how-to-diff-a-commit-with-its-parent/436696#436696)达到了我的预期。

```
$ git diff HEAD^1 
```

[此外，添加诸如提到的滚刀](https://stackoverflow.com/questions/436362/how-to-diff-a-commit-with-its-parent/10408756#10408756)之类的别名也很有用。*如果您将以下内容放在~/.gitconfig*文件的 [alias] 部分，那么您可以使用速记来查看 head 和 previous 之间的差异。

```
[alias]
    diff-last = diff HEAD^1 
```

然后运行**​​$ git diff-last**会得到你的结果。请注意，这还将*包括*您尚未提交的任何更改以及提交之间的差异。如果您想*忽略*尚未提交的更改，则可以使用 diff 直接将 HEAD 与其父级进行比较：

```
$ git diff HEAD^1 HEAD 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-05-02T06:28:45.773

这使用别名，所以它不能准确回答你的问题，但我发现这些对于做你想做的事情很有用......

```
alias gitdiff-1="git log --reverse|grep commit|cut -d ' ' -f2|tail -n 2|head -n 2|xargs echo|sed -e 's/\s/../'|xargs -n 1 git diff"
alias gitdiff-2="git log --reverse|grep commit|cut -d ' ' -f2|tail -n 3|head -n 2|xargs echo|sed -e 's/\s/../'|xargs -n 1 git diff"
alias gitdiff-3="git log --reverse|grep commit|cut -d ' ' -f2|tail -n 4|head -n 2|xargs echo|sed -e 's/\s/../'|xargs -n 1 git diff"

alias gitlog-1="git log --reverse|grep commit|cut -d ' ' -f2|tail -n 2|head -n 2|xargs echo|sed -e 's/\s/../'|xargs -n 1 git log --summary"
alias gitlog-2="git log --reverse|grep commit|cut -d ' ' -f2|tail -n 3|head -n 2|xargs echo|sed -e 's/\s/../'|xargs -n 1 git log --summary"
alias gitlog-3="git log --reverse|grep commit|cut -d ' ' -f2|tail -n 4|head -n 2|xargs echo|sed -e 's/\s/../'|xargs -n 1 git log --summary" 
```

# .net - 对值类型调用方法会导致 .NET 中的装箱吗？

> ID：436363
> 
> 赞同：25
> 
> 时间：2009-01-12T18:04:14.187
> 
> 标签：.net, boxing, value-type

我刚刚参加 Stack Overflow 问题*[.NET 中的所有内容都是对象吗？](https://stackoverflow.com/questions/436211/is-everything-in-c-an-object)*.

一位发帖人（在接受答案的评论中）似乎认为对值类型执行方法调用会导致装箱。他向我指出了*[Boxing and Unboxing (C# Programming Guide)](http://msdn.microsoft.com/en-us/library/yz2be5wk(VS.80).aspx)*，它并没有准确地指定我们正在描述的用例。

我不是一个相信单一来源的人，所以我只是想获得关于这个问题的进一步反馈。我的直觉是没有拳击，但我的直觉确实很糟糕。:D

进一步阐述：

我使用的示例是：

```
int x = 5;
string s = x.ToString(); // Boxing?? 
```

如果所讨论的结构覆盖从对象继承的方法，则*不会*发生装箱，因为此处接受的答案表明。

但是，如果结构没有覆盖该方法，则会在 callvirt 之前执行“约束” [CIL命令。](http://en.wikipedia.org/wiki/Common_Intermediate_Language)根据文档*[OpCodes.Constrained Field](http://msdn.microsoft.com/en-us/library/system.reflection.emit.opcodes.constrained.aspx)*，**这会导致装箱**：

> 如果 thisType 是一个值类型并且 thisType 没有实现方法，则 ptr 被取消引用，装箱，并作为“this”指针传递给 callvirt 方法指令。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-12T18:14:58.427

这是您的代码的 IL：

```
L_0001: ldc.i4.5      // get a 5 on the stack
L_0002: stloc.0       // store into x
L_0003: ldloca.s x    // get the address of x on the stack
L_0005: call instance string [mscorlib]System.Int32::ToString()  // ToString
L_000a: stloc.1       // store in s 
```

因此，在这种情况下，答案是否定的。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-01-12T18:30:41.483

正如 plinth 指出的那样，如果您给出的答案是否定的。

但是，如果您通过接口指针调用方法，它会。

考虑代码：

```
interface IZot
{
    int F();
}

struct Zot : IZot
{
    public int F()
    {
        return 123;
    }
} 
```

然后

```
Zot z = new Zot();
z.F(); 
```

不会导致拳击**：**

```
.locals init (
    [0] valuetype ConsoleApplication1.Zot z)
L_0000: nop 
L_0001: ldloca.s z
L_0003: initobj ConsoleApplication1.Zot
L_0009: ldloca.s z
L_000b: call instance int32 ConsoleApplication1.Zot::F()
L_0010: pop 
L_0011: ret 
```

但是，这样做：

```
IZot z = new Zot();
z.F();

   .locals init (
        [0] class ConsoleApplication1.IZot z,
        [1] valuetype ConsoleApplication1.Zot CS$0$0000)
    L_0000: nop 
    L_0001: ldloca.s CS$0$0000
    L_0003: initobj ConsoleApplication1.Zot
    L_0009: ldloc.1 
    L_000a: box ConsoleApplication1.Zot
    L_000f: stloc.0 
    L_0010: ldloc.0 
    L_0011: callvirt instance int32 ConsoleApplication1.IZot::F()
    L_0016: pop 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-13T11:30:05.700

@ [ggf31316](https://stackoverflow.com/users/38561/ggf31416)

> “我相信如果结构不覆盖方法，调用 ToString、Equals 和 Gethashcode 会导致装箱。”

我已经为你检查了 ToString。Int32 确实覆盖了 ToString，所以我创建了一个没有覆盖的结构。我使用[.NET Reflector](http://en.wikipedia.org/wiki/.NET_Reflector)来确保该结构不会以某种方式神奇地覆盖 ToString()，但事实并非如此。

所以代码是这样的：

```
using System;

namespace ConsoleApplication29
{
    class Program
    {
        static void Main(string[] args)
        {
            MyStruct ms = new MyStruct(5);
            string s = ms.ToString();
            Console.WriteLine(s);
        }
    }

    struct MyStruct
    {
        private int m_SomeInt;

        public MyStruct(int someInt)
        {
            m_SomeInt = someInt;
        }

        public int SomeInt
        {
            get
            {
                return m_SomeInt;
            }
        }
    }
} 
```

Main 方法的 MSIL（通过[ILDASM](http://en.wikipedia.org/wiki/Common_Intermediate_Language#Generation)）是这样的：

```
 IL_0000:  ldloca.s   ms
  IL_0002:  ldc.i4.5
  IL_0003:  call       instance void ConsoleApplication29.MyStruct::.ctor(int32)
  IL_0008:  ldloca.s   ms
  IL_000a:  constrained. ConsoleApplication29.MyStruct
  IL_0010:  callvirt   instance string [mscorlib]System.Object::ToString()
  IL_0015:  stloc.1
  IL_0016:  ldloc.1
  IL_0017:  call       void [mscorlib]System.Console::WriteLine(string)
  IL_001c:  ret 
```

现在，尽管没有发生拳击呼叫，但如果您查看[有关 constrained + a call virt 的文档](http://msdn.microsoft.com/en-us/library/system.reflection.emit.opcodes.constrained.aspx)，您会发现它声明确实发生了拳击。哦哦

引用：

> 如果 thisType 是一个值类型并且 thisType 没有实现方法，则 ptr 被取消引用，装箱，并作为“this”指针传递给 callvirt 方法指令。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-13T00:26:58.720

我相信如果结构不覆盖方法，调用 ToString、Equals 和 Gethashcode 会导致装箱。

# c++ - 安全地将 printf 打印到字符串的最佳方法？

> ID：436367
> 
> 赞同：18
> 
> 时间：2009-01-12T18:06:13.093
> 
> 标签：c++, stl

有谁知道将 printf 样式函数的输出重定向到字符串的安全方法？显而易见的方式会导致缓冲区溢出。

就像是：

```
string s;
output.beginRedirect( s );  // redirect output to s

... output.print( "%s%d", foo, bar );

output.endRedirect(); 
```

我认为这个问题与问“打印会产生多少个字符？”是一样的。想法？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-01-12T18:11:15.157

您可以使用：

[`std::snprintf`](http://en.cppreference.com/w/cpp/io/c/fprintf)如果您正在使用 char*

[`std::stringstream`](http://en.cppreference.com/w/cpp/io/basic_stringstream)如果您想使用字符串（与 printf 不同，但可以让您使用普通的流函数轻松操作字符串）。

[`boost::format`](http://www.boost.org/doc/libs/1_37_0/libs/format/doc/format.html)如果你想要一个类似于 printf 的函数来处理流。（根据评论中的jalf）

[`fmt::format`](https://github.com/fmtlib/fmt)自 c++20 以来已标准化[`std::format`](https://en.cppreference.com/w/cpp/utility/format/format)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-01-12T18:09:54.160

该`snprintf()`函数打印到一个字符串，但只打印给它的长度。

可能是你要找的...

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2014-08-19T19:22:35.733

[fmt 库](https://github.com/cppformat/cppformat)提供`fmt::sprintf`了执行 printf 兼容格式（包括根据[POSIX 规范](http://pubs.opengroup.org/onlinepubs/9699919799/functions/printf.html)的位置参数）的函数，并将结果返回为`std::string`：

```
std::string s = fmt::sprintf( "%s%d", foo, bar ); 
```

**免责声明**：我是这个库的作者。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-12T18:12:48.103

由于您已将其标记为 C++（而不仅仅是 C），我将指出在 C++ 中执行此类操作的典型方法是使用[stringstream](http://www.cplusplus.com/reference/iostream/stringstream/)，而不是 printf 系列。无需担心字符串流的缓冲区溢出。

如果您喜欢 printf 样式的格式字符串但想要更安全的东西，也可以使用Boost[格式库。](http://www.boost.org/doc/libs/1_37_0/libs/format/index.html)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-01-12T18:20:52.937

snprintf() 返回写入整个字符串所需的字节数。所以，作为一个小例子：

```
#include <strings.h>
#include <stdio.h>
#include <stdlib.h>

int main(int argc, char** argv) 
{
    char* buf = 0;
    size_t bufsize = 0;
    size_t sz;

    const char* format="%s and %s.";
    const char* str_1 ="string 1";
    const char* str_2 ="string 2";

    sz = snprintf(buf, bufsize, format, str_1, str_2);
    printf("The buffer needs to be %d bytes.\n", sz);

    buf=malloc(sz+1);
    if(!buf) {
        printf("Can't allocate buffer!\n");
        return 1;
    }
    bufsize = sz+1;
    buf[bufsize-1] = '\0';
    sz = snprintf(buf, bufsize, format, str_1, str_2);
    printf("Filled buffer with %d bytes.\n", sz);
    printf("The buffer contains:\n'%s'\n", buf);
    return 0;
} 
```

输出：

```
The buffer needs to be 22 bytes.
Filled buffer with 22 bytes.
The buffer contains:
'string 1 and string 2.' 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-01-12T18:12:42.533

老套：

```
snprintf() 
```

允许您限制写入的数量，并返回实际写入的大小，并且

```
asprintf() 
```

分配（与`malloc()`）足够的缓冲区，然后成为您的问题`free()`。`asprintf 是一个 GNU libc 函数，现在在 BSD libc 中重新实现。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-01-12T18:55:00.013

[这个 StackOverflow 问题](https://stackoverflow.com/questions/69738/c-how-to-get-fprintf-results-as-a-stdstring-w-o-sprintf#69911)也有类似的讨论。同样在那个问题中，我提出了我最喜欢的解决方案，一个“格式”函数，它接受与 printf 相同的参数并返回一个 std::string。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-12T18:11:48.620

在 C99 中，您有 snprintf 函数，它将缓冲区的大小作为参数。GNU C 库有 asprintf 为你分配一个缓冲区。但是，对于 c++，您可能会更好地使用 iostream。

[维基百科](http://en.wikipedia.org/wiki/Printf#Buffer_safety_and_sprintf)有更多信息。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-12T20:53:49.807

我发现 printf 格式比流更有用且更易于使用。另一方面，我也很喜欢 std::string 。解决方案是使用 sprintf，但它不能处理任意缓冲区大小。

我发现我需要在没有开销的情况下处理常见情况（例如，缓冲区限制为 256 个字符），但还要安全地处理大缓冲区。为此，我有一个 256 个字符的缓冲区作为成员分配在我的班级中，我使用 snprinf，传递该缓冲区及其大小。如果 snprintf 成功，我可以立即返回格式化字符串。如果失败，我分配缓冲区并再次调用 snprinf。缓冲区在类的析构函数中被释放。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-12T19:17:41.013

在 Windows 上：

```
StringCchPrintf
StringCbPrintf 
```

从`strsafe.h/lib`.

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2009-01-12T18:09:33.803

微软为此引入了“[安全](http://msdn.microsoft.com/en-us/library/239ffwa0(VS.80).aspx)”crt 功能。

你可以使用[printf_s](http://msdn.microsoft.com/en-us/library/239ffwa0(VS.80).aspx) ()

# c# - 如何在 C# 中全局定义一个常量（如 DEBUG）

> ID：436369
> 
> 赞同：16
> 
> 时间：2009-01-12T18:07:29.970
> 
> 标签：c#, .net

我想根据#define定义的常量以不同的方式编译项目，如下所示：

```
#define USE_COMPONENT_X

#if USE_COMPONENT_X
...

#endif 
```

我可以在 C# 中做到这一点。但是当我转到同一个项目中的另一个文件时，这个常量是没有定义的。我可以以某种方式为所有项目定义一个常量，比如 DEBUG 是这样定义的吗？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-01-12T18:10:56.623

您可以添加 /define 编译器开关。

1.  打开项目的属性页对话框。
2.  单击配置属性文件夹。
3.  单击构建属性页面。
4.  修改条件编译常量属性。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-12T19:14:26.043

您可能想要更进一步，创建不同的项目配置作为标准调试和发布项目配置的变体。构建菜单下的配置管理器将让您完成此操作。然后，当您在项目属性的“构建”选项卡中时，您可以选择各种配置并设置适合每个配置的条件编译常量。当您想要在条件编译代码的各种排列之间来回交换时，这将为您节省大量时间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-12T18:13:01.597

希望我不会偏离主题，而不是“常量”，可能为常量类型定义一个接口，然后使用众多依赖注入框架之一来管理“常量”的定义、注入和生命周期。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-12T18:11:33.767

在您的 IDE 中设置它或使用编译器命令行开关，即Mono 的[-define](http://go-mono.org/docs/index.aspx?tlink=8@man%3amcs(1))。

# xml - 如何将外部数据添加到 XML？

> ID：436370
> 
> 赞同：1
> 
> 时间：2009-01-12T18:07:55.583
> 
> 标签：xml, xml-serialization, xsd

我有一个 XML 模式和一个对该模式有效的 XML 实例。

此 XML 实例包含一些数据。

我想用更多数据（我自己的 XML 实例中每个 XML 元素的元数据）扩展 XML 实例，同时保持它对提供的模式有效。

真正的用例是我有自己的控件，它通过 XML 获取其数据，我想生成一个新的 XML，以某种方式保留与控件序列化相关的其他元数据。

我的几个解决方案是保留另一个文档，其中包含我在加载 XML 后的第二遍中加载的“XPath、Mode、Color”列表。

另一种解决方案是将 id 添加到 XML 节点，并以这种方式引用另一个文档中的节点（而不是使用 XPath）。

另一个想法是以某种方式将属性（在我的每个元素的命名空间中）添加到数据 XML 实例，但问题是我稍后在尝试再次加载它时可能无法使用新属性验证 XML。（因为我添加到 XML 的属性没有在他的架构中定义）

你对这个问题有更好的解决方案吗？您会投票支持哪些解决方案？（请解释。）

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-12T19:40:36.490

从您的问题中不清楚额外的元数据是生成一次，还是需要在后续加载中存储和使用。

您可以考虑使用 XSLT 生成带有元数据的新 XML。如果新数据直接失败并从原始 XML 推导出来，您可以使用 XSLT 轻松生成每个节点的元数据。如果它是可预测且一致的，那么您可以在加载数据并获得相同的新 XML 时重复该过程。如果它是不可预测的，例如，如果您需要动态创建 XSLT，您可能仍然能够在生成 XSL 后存储它，然后随着时间的推移使用它从原始 XML 重新生成相同的新 XML。

根据您建议的解决方案：

1.  由 XPATH 引用：如果原始 XML 没有更改并且您可以构建明确的 XPATH，则很好。
2.  按节点 id 引用：很好，但如果您还没有，则需要将 id 添加到原始 XML，如果原始更改，您将需要更新 id（因此您可能需要一个 id 计数器来分配 ID ，或以其他方式使用生成的 GUID 作为 id）。
3.  如果您想将元数据添加到原始 XML，您可以更新模式或为“更新的文档”创建一个新模式（并更改 XML 文档中的模式引用）。

问候， 因巴尔

# javascript - 如何在javascript中将日期时间微格式转换为本地时间？

> ID：436374
> 
> 赞同：1
> 
> 时间：2009-01-12T18:09:35.083
> 
> 标签：javascript, timezone, timestamp, microformats

我有一个页面当前正在使用[datetime 微格式](http://microformats.org/wiki/datetime-design-pattern)来显示时间戳，但我只显示了我自己时区的人类可读时间：

```
<abbr class="published" title="2009-01-09T09:16:00-05:00">
Friday, January 9, 2009 at 9:16 am (EST)</abbr> 
```

我想做的是将 abbr 标记的 innerHTML 重写为相同的格式，但在用户的本地时区中。因此，对于西雅图的读者来说，以上内容应转换为：

```
<abbr class="published" title="2009-01-09T09:16:00-05:00">
Friday, January 9, 2009 at 6:16 am (PST)</abbr> 
```

我查看了[Javascript Date 对象](http://www.w3schools.com/jsref/jsref_obj_date.asp)，它允许我获取本地时区偏移量。但我有几个问题：

1.  我看不到从[ISO-8601](http://microformats.org/wiki/iso-8601)时间戳创建新 Date 对象的简单方法。（我想如果没有更快的方法，我可以用子字符串或正则表达式解析。）

2.  我看不到获得时区命名缩写的方法。例如，对于西雅图的读者，我希望时间在末尾附加“（PST）”，否则该用户不清楚时间戳已被转换（特别是如果他是常客并且已经习惯了我的时代是在美国东部标准时间的事实）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-12T18:59:41.457

这是我的解析 ISO 时间戳的代码：

```
function isoDateStringToDate (datestr) {
  if (! this.re) {
    // The date in YYYY-MM-DD or YYYYMMDD format
    var datere = "(\\d{4})-?(\\d{2})-?(\\d{2})";
    // The time in HH:MM:SS[.uuuu] or HHMMSS[.uuuu] format
    var timere = "(\\d{2}):?(\\d{2}):?(\\d{2}(?:\\.\\d+)?)";
    // The timezone as Z or in +HH[:MM] or -HH[:MM] format
    var tzre = "(Z|(?:\\+|-)\\d{2}(?:\\:\\d{2})?)?";
    this.re = new RegExp("^" + datere + "[ T]" + timere + tzre + "$");
  }

  var matches = this.re.exec(datestr);
  if (! matches)
    return null;

  var year = matches[1];
  var month = matches[2] - 1;
  var day = matches[3];
  var hour = matches[4];
  var minute = matches[5];
  var second = Math.floor(matches[6]);
  var ms = matches[6] - second;
  var tz = matches[7];
  var ms = 0;
  var offset = 0;

  if (tz && tz != "Z") {
    var tzmatches = tz.match(/^(\+|-)(\d{2})(\:(\d{2}))$/);
    if (tzmatches) {
      offset = Number(tzmatches[2]) * 60 + Number(tzmatches[4]);
      if (tzmatches[1] == "-")
        offset = -offset;
    }
  }

  offset *= 60 * 1000;
  var dateval = Date.UTC(year, month, day, hour, minute, second, ms) - offset;

  return new Date(dateval);
} 
```

不幸的是，它也不处理时区缩写。您必须修改“tzre”表达式以接受字母，而我所知道的在 Javascript 中处理时区缩写的唯一解决方案是有一个查找表，您可以在更改区域时手动更新该表夏令时。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-04-13T21:04:47.480

EcmaScript 正式添加了一个 ISO-8601 样式字符串作为 JavaScript 日期的输入。由于大多数 JS 实现不支持这一点，我为 Date 对象创建了一个包装器，它具有此功能。如果将标题标签设置为以 UTC/GMT/Z/Zulu 偏移量输出，则可以将我的[EcmaScript 5 扩展用于 JS 的 Date object](http://frugalcoder.us/post/2010/01/07/EcmaScript-5s-Date-Extensions.aspx)。

对于要在客户端脚本中使用的 DateTime 值，我通常尝试始终执行以下操作。将日期+时间存储在 UTC 区域中（甚至在数据库中）。在 UTC 区域中传输日期时间。从客户端到服务器，您可以使用上述链接中的 .toISOString() 方法。从服务器到客户端，这相对容易。

通过 jQuery（带扩展名）：

```
$('.published').each(function(){
  var dtm = new Date(this.title);
  if (!isNaN(dtm)) {
    this.text(dtm.toString());
  }
});
```

我不记得我是否在输入中添加了对非 UTC 日期时间的支持，但考虑它们并不太难。

# .net - 当继承类使用默认构造函数实例化时，它是否也调用基类构造函数？

> ID：436375
> 
> 赞同：3
> 
> 时间：2009-01-12T18:09:47.937
> 
> 标签：.net

有谁知道 C# 的行为是什么？所有 .NET 语言都一样吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-12T18:13:26.727

是的，它会自动调用基类的默认构造函数。默认构造函数没有参数。

如果没有默认构造函数，则必须使用以下语法手动调用基类构造函数：

```
public MyClass() : base(parameters, ...) 
```

来源：[使用构造函数（C#）](http://msdn.microsoft.com/en-us/library/ms173115(VS.80).aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-12T18:16:14.257

是的 -如果您没有显式调用基类构造函数，派生类中的*任何构造函数都会发生这种情况。*

```
class Base
{
  Base(){}
  Base(int i){}
}

class Derived : Base
{
  Derived(bool x) {} // calls Base.Base()
}

class Derived2 : Base
{
  Derived2() : base(10) {} // calls Base.Base(int)
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-12T18:15:49.483

是的，它确实。这就是为什么您不能创建不调用基类的派生类的原因。

```
public class A
{
    public A(string s)
    {}
}

public class B : A
{
    public B()
    {}
} 
```

导致编译器错误。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-12T18:16:04.507

它肯定适用于 C# - 我不能说其他语言，但我无法想象他们的编译器会生成不同的 IL。

举个例子：

```
class Parent { }
class Child : Parent { } 
```

如果我们查看在`Child`'s 构造函数中生成的 IL，我们会看到这一重要行：

```
L_0001: call instance void Parent::.ctor() 
```

这清楚地表明我们正在调用该类的默认构造函数`Parent`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-12T18:21:30.377

只是为了添加其他答案，为了使 OO 正常工作，它必须为每个类调用一个构造函数。如果不是，您无法保证您的班级处于已知的良好状态。

即使您正在做一些奇怪的事情（例如序列化），它们也需要默认构造函数，因为必须再次调用构造函数。

# python - 如何在 Python 中将电子邮件地址/密码字符串一分为二？

> ID：436394
> 
> 赞同：2
> 
> 时间：2009-01-12T18:12:29.833
> 
> 标签：python, parsing, split

假设我们有这个字符串：`[18] email@email.com:pwd:`

`email@email.com`是电子邮件，`pwd`是密码。

另外，假设我们有一个带有值的变量

```
f = "[18] email@email.com:pwd:" 
```

我想知道是否有办法将另外两个变量命名为`var1`和`var2`，其中该`var1`变量将从变量中获取确切的电子邮件信息，`f`并`var2`从 中获取确切的密码信息`var2`。

运行应用程序后的结果应该是这样的：

```
var1 = "email@email.com" 
```

和

```
var2 = "pwd" 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-12T18:15:58.470

```
>>> var1, var2, _ = "[18] email@email.com:pwd:"[5:].split(":")
>>> var1, var2
('email@email.com', 'pwd') 
```

或者如果“[18]”不是固定前缀：

```
>>> var1, var2, _ = "[18] email@email.com:pwd:".split("] ")[1].split(":")
>>> var1, var2
('email@email.com', 'pwd') 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-12T18:16:08.203

```
import re
var1, var2 = re.findall(r'\s(.*?):(.*):', f)[0] 
```

如果 findall()[0] 感觉像是前进两步，后退一步：

```
var1, var2 = re.search(r'\s(.*?):(.*):', f).groups() 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-12T18:25:37.997

```
var1, var2 = re.split(r'[ :]', f)[1:3] 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-14T13:30:00.903

要拆分第一个冒号“：”，您可以执行以下操作：

```
# keep all after last space
f1= f.rpartition(" ")[2]
var1, _, var2= f1.partition(":") 
```

# c++ - Linux C++ 调试器

> ID：436400
> 
> 赞同：14
> 
> 时间：2009-01-12T18:13:13.547
> 
> 标签：c++, linux, gdb, debugging

我正在寻找完美的 Linux C++ 调试器。我不期望成功，但搜索应该是信息丰富的。

我是一个非常有能力的 gdb 用户，但 STL 和 Boost 很容易粉碎我的调试技能。并不是我无法深入了解数据结构的内部结构，而是我通常会花费很长时间才能找到另一种方法（“如有疑问，请打印出来”）。

gdb 的宏语言很奇怪，适应性也不是很好。只需查看 stanford gdb utils 打印出 stl 结构的代码即可。

简而言之，我对自己所拥有的不满意。

我最近偶然发现了[零错误](http://zero-bugs.com)。它看起来像一颗银弹。现在的零漏洞用户怎么看？

有没有人找到其他解决 Linux C++ 调试器问题的好方法？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-12T18:51:43.407

gdb 的一个开发分支（gdb 的[Project Archer](http://sourceware.org/gdb/wiki/ProjectArcher)的一部分）为 gdb 添加了 Python 支持（以替换 gdb 的宏）。[从这里开始](http://tromey.com/blog/?p=494)有一系列博客文章，其中广泛涵盖了启用 Python 的 gdb 入门，并提供了一些关于使用 Python 定义新 gdb 命令和漂亮打印 C++ 数据结构的教程。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-22T12:17:39.730

如果您不介意为此付费，UndoDB 就很棒。可逆能力比 GDB 快得多。 [http://www.undo-software.com/](http://www.undo-software.com/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-12-24T22:51:54.843

有一些简单的脚本可以让您从 GDB 中转储 STL 结构。

看看[这里](http://www.yolinux.com/TUTORIALS/GDB-Commands.html#STLDEREF)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-13T12:46:01.210

您可以试试 NetBeans IDE 6.5 和 gdb 6.8，它非常强大！ [http://www.netbeans.org/downloads/index.html](http://www.netbeans.org/downloads/index.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-19T16:06:32.867

ddd（数据显示调试器）相当不错.....它基本上是一个可视化的gdb....

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-02-10T21:38:26.573

我使用以下环境：

[http://ec-lang.org/](http://ec-lang.org/)

它是一个完整的eC语言开发环境。

但是，您可以拥有一个仅包含 c 或 c++ 文件而没有任何 eC 特定文件的项目，并使用 IDE 构建和调试它们。

这是您在 linux 下最接近类似“Borland C”的体验。

它可以使用以下命令安装在 Ubuntu/Debian 上：

**sudo apt-get install ecere-sdk**

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-02-10T21:48:03.570

最近的`gdb` （例如 8.1 版）和`g++`（例如 2018 年 2 月的 GCC 7）能够通过 Python 脚本调试标准 C++ 容器。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-12T18:18:22.177

[我已经有一段时间没有在 Linux 中进行 C++ 开发了，但是当我使用KDevelop](http://www.kdevelop.org/)的调试器时，我很幸运。没有什么革命性的东西，但它可以让您快速探索您正在寻找的对象属性。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-12T18:39:39.857

尝试[ddd](http://www.gnu.org/software/ddd/)。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-12T19:23:42.233

如果您正在寻找 IDE 类型的调试器而不是命令行调试器，则可以使用[Eclipse逐步执行 C 和 C++ 代码。](http://www.eclipse.org/downloads/)它并不完美，但我发现它适用于已经熟悉 IDE 调试工具的人。

我也偏爱[Valgrind](http://valgrind.org/)检测内存错误。

# rest - 使用 LINQ to Entities 添加和更新

> ID：436406
> 
> 赞同：0
> 
> 时间：2009-01-12T18:14:58.050
> 
> 标签：rest, linq-to-entities, savechanges

我们在我们的项目中使用 L2E 和 REST，虽然我能够毫无问题地从数据库中检索数据，但我仍然无法更新或向数据库添加新记录。我想这是一个语法问题（我们对 linq 还很陌生），但我无法弄清楚。我们最初在 dataservicecontext 中加载数据，并在进行更新时将它们存储在`CurrencyManager.Current`绑定源中。但是，当我调用时`SaveChanges`，数据库中没有任何内容被修改，我不知道为什么。

例如，

加载数据：

```
 var customerQuery = Program.Proxy.Customers.Where(p => p.ContactId == g); 
```

保存数据：

```
 Program.Proxy.SaveChanges(); 
```

我已经确认正在跟踪内存中实体的更新副本，所以我不需要调用`AddObject`，但我收到一个错误（“*关闭的类型 Lynxphere.WindowsClient.LynxphereDataServices.Customers 没有对应的客户可设置属性。* ”）如果我尝试调用`AddLink`. 而且我什至不确定这一步是否必要。帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-17T09:42:04.847

使用 Save() 函数查看我的存储库模式，该函数发布在下面的项目中。实现了一个 EntityProductRepository。这可能会帮助您正确执行更新和插入。

[openticket.codeplex.com](http://openticket.codeplex.com)

> ID：436411
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

# cocoa-touch - 旋转时隐藏导航栏

> ID：436413
> 
> 赞同：6
> 
> 时间：2009-01-12T18:16:00.327
> 
> 标签：cocoa-touch

我有一个带有导航栏的 UIView。当用户将 iPhone 置于横向时，如何隐藏导航栏并让它在纵向视图中再次显示？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2010-02-27T13:15:08.587

```
- (void)willRotateToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation duration:(NSTimeInterval)duration {
    [[self navigationController] setNavigationBarHidden:UIInterfaceOrientationIsLandscape(toInterfaceOrientation) animated:YES];
    [[UIApplication sharedApplication] setStatusBarHidden:UIInterfaceOrientationIsLandscape(toInterfaceOrientation) animated:YES];
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-12T19:10:42.713

这在文档中很容易找到。在 UINavigationController 文档中，要隐藏导航栏，您可以使用：

```
- (void)setNavigationBarHidden:(BOOL)hidden animated:(BOOL)animated 
```

如果您想在设备旋转时执行此操作，您需要在视图控制器方法中执行此操作（在 UIViewController 文档中提到）：

```
- (void)willRotateToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation duration:(NSTimeInterval)duration 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-01-13T21:17:23.923

恕我直言，更好的方法是使用 CGAffineTransform，并将导航栏留在原处 - 就像 iPhone 的照片库视图一样。请参阅 Jeff Lamarche 的精彩介绍[Demystifying CGAffineTransform](http://iphonedevelopment.blogspot.com/2008/10/demystifying-cgaffinetransform.html)。对我帮助很大。

# ruby - Erlang 中的 Ruby

> ID：436418
> 
> 赞同：2
> 
> 时间：2009-01-12T18:16:41.527
> 
> 标签：ruby, erlang

是否可以将 Ruby 嵌入到 Erlang 中？Yecc 会是正确的工具吗？如果可能的话，大概需要多少工时？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-12T20:21:03.943

Erlectricity 将 Ruby 暴露给 Erlang，反之亦然：

[http://github.com/mojombo/erlectricity](http://github.com/mojombo/erlectricity)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-03-29T14:12:07.943

[Jose Valim 网址http://elixir-lang.org/](http://elixir-lang.org/)有一个名为 Elixir 的东西，它可以让您编写类似于 ruby​​ 的代码并在 erlang VM 上运行它。

所以代码在很多地方看起来都很相似，比如：

```
iex> name = "world"
iex> "hello #{name}"
"hello world" 
```

在许多情况下，更多的是 Erlang'y：

```
# function
iex> x = fn(a, b) -> a + b end
#Fun<erl_eval.12.111823515>
iex> x.(1, 2)
3 
```

和模块=）：

```
iex> defmodule Math do
...>   def sum(a, b) do
...>     a + b
...>   end
...> end    
iex> Math.sum(1, 2)
3 
```

它以任何方式帮助您。我知道 Jose 在停止专注于 Rails 之后，最近又开始了大规模的工作。可能他会得到 Riak 集成和某种 Web 框架。那可能很有趣！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-12T19:42:23.100

你需要更详细地解释你想要做什么。在这种情况下，“嵌入”是一个相当模糊的词。

如果您打算在 Erlang 中实现 Ruby 解析器/解释器，那么 Yecc 将是合适的，但我猜这不是您想要做的。

如果你想从 Erlang 调用 Ruby 代码，这可以通过类似于 Erlang 的[jinterface](http://erlang.org/doc/apps/jinterface/index.html)应用程序用于与 Java 对话的方式来完成。（你也可以在这个主题上[谷歌](http://www.google.se/search?q=erlang+jinterface)。）

如果不花一两个星期的工作，弄清楚应该做什么以及如何做，你就不能期望得到任何现实的估计。否则，您最终会得到“从 2 个月到两年的任何时间”，这可能不是很有帮助。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-13T23:17:06.850

根据您的任务是什么，您可以做一些简单的事情，例如生成一个 ruby​​ 进程以通过 STDIN/OUT 与之对话。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-19T09:27:07.227

如果你想在 Erlang 中评估一些 ruby​​ 代码，你应该准备花大约一年的时间来发布简单的代码。

Ruby 语法非常复杂，而 erlang 有一个非常不同的虚拟机。

# testing - 在虚拟机中测试程序的选择是什么？

> ID：436421
> 
> 赞同：2
> 
> 时间：2009-01-12T18:18:03.130
> 
> 标签：testing, deployment, virtualization, virtual-machine

在几个不同的系统（98-XP-Vista-Seven-Linux-etc）上测试我们的软件时，我认为最好的选择是使用虚拟化系统。

您的选择是什么：VMware、Virtual Box 或 MS Virtual PC/Server？为什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-12T18:21:56.697

我们在这里工作时使用 VMWare。实际上，任何支持快照（或某种保存机器状态的方式）的 VM 软件都可以正常工作。快照使测试安装和回滚变得更加容易。如果您编写程序并修改文件以返回到已知良好状态，它也会有所帮助。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-12T18:31:26.067

虚拟盒子是要走的路。它具有快照并且独立于平台（适合想要在其他操作系统上测试的 Mac 用户）。它是免费的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-12T18:22:16.647

微软的VirtualPC。它免费且简单。

一个不错的功能是差异化的 VHDD，它可以轻松（和空间明智的吱吱声）继续备份/恢复图像

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-12T18:45:28.567

去 VMware。我的理由很简单：在 VMware 发布 VMWare 播放器和 VMware 服务器（以前称为 VMware GSX 的虚拟化平台）之前，VM 主机市场是有限且昂贵的。

当 VMware 免费发布这些产品时，所有其他制造商（是的，我在这里看的是微软）都不得不效仿，所以如果不是 VMware 的好意，我们仍然会考虑购买我们的虚拟机主机软件。

所以，支持 VMware 成为好人。

哦，他们的企业产品就是业务，它们与 Linux 配合得很好，有一些出色[的内存节省技巧](http://blogs.vmware.com/virtualreality/2008/03/cheap-hyperviso.html)（这里是[技术细节](http://www.vmware.com/resources/techresources/605)），多个快照和基础映像的快照，并具有诸如 VMotion（负载分散）之类的功能，其他产品几乎不支持（如果有的话）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-12T18:45:35.167

如果可用， Windows Server 2008 上的[Hyper-V](http://www.microsoft.com/windowsserver2008/en/us/hyperv.aspx)是一个功能强大且功能齐全的条目，包括快照树和您期望的高质量 UI 的所有细节。

如果您计划在本地开发机器上使用 VM，以便可以（例如）将其带回家在笔记本电脑上工作，那么更面向客户端的虚拟化软件可能是您的最佳选择。

如果您计划在主要专业环境中使用虚拟化，那么您可以远程访问计算机实验室中的许多 Hyper V 机器是我们在我办公室使用了几个月的强大范例。

我自己的偏好是使用本地 VM（虚拟 PC 对我来说是最简单的）作为我的开发环境，因为我可以将我的工作笔记本电脑带回家并在那里使用 VM（我不使用 VPN 进入办公室）。然后，我使用实验室的 Hyper-V 机器进行测试、部署等，因为它们在拍摄和恢复快照方面有更好的故事。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-12T18:22:30.813

VMWare，这就是我们在这里使用的。我们拥有用于虚拟服务器的成熟 ESX 和用于开发/测试的 VMWare 工作站。ESX 资源管理非常好，而且易于配置。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-12T18:37:35.883

我使用过 VMWare（当公司愿意付费时）、VMWare Server（当公司不会付费时）、VirtualBox（因为它是免费的、体面的，并且支持快照）、Mac 上的 Parallels（我买的）和 Xen .

一切正常。

我目前的主力是 VirtualBox，主要是因为它是免费的，支持快照，并且可以在我必须使用的各种主机平台上运行。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-12T18:25:28.793

VMWare 工作得很好，但对于高 cpu 服务器应用程序，我们发现 Microsoft 的 Hyper-V 工作得更好，因为它具有更好的 cpu 预留能力。

关键是系统有快照，因此您可以轻松地回滚到多个状态（大多数都可以），我们发现 VMWare 和 Hyper-V 都具有出色的 API，允许我们在新构建完成时启动自动化测试。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-12T18:34:29.867

用于 Microsoft 操作系统的 Microsoft Virtual PC，用于 *nix 的 Virtual Box。Virtual PC 似乎稍微快一点，也更稳定一些，但它不支持 linux。

如果 VMWare 是免费的，我们可能会使用它，但我们公司不会花钱。

虚拟盒子很棒。如果您在 Mac OS X 中运行它，它确实存在一些稳定性问题。如果您需要一个解决方案来运行多个操作系统，这将是一个解决方案。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-13T12:23:24.610

Linux/OpenSolaris 在 Linux 之上的 Virtual Box 之上。

# c# - 如何从当前的 .NET 表单/应用程序发送密钥 F12

> ID：436430
> 
> 赞同：2
> 
> 时间：2009-01-12T18:20:42.937
> 
> 标签：c#, .net, sendkeys

我很确定以下按钮激活的表单代码应该在我的 C# 应用程序中引发 Control-F12：

SendKeys("^{F12}");

但它似乎没有继续到 Windows shell 并激活另一个正在监听它的程序。我的键盘工作正常。似乎 sendkeys 在某处被截获，而不是以实际模拟击键的方式发送。有什么帮助吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-12T19:03:25.567

SendKeys 无法在活动应用程序之外发送密钥。

要真正模拟系统范围内的击键，您需要 P/Invoke`keybd_event`或`SendInput`从`user32.dll`. （根据 MSDN`SendInput`是“正确”的方式，但`keybd_event`有效且 P/Invoke 更简单。）

示例（我*认为*这些键码是对的……每对中的第一个是`VK_`代码，第二个是成败键盘扫描码……“2”是`KEYEVENTF_KEYUP`）

```
[DllImport("user32.dll")]
private static extern void keybd_event(byte bVk, byte bScan,
    int dwFlags, int dwExtraInfo);

...

keybd_event(0xa2, 0x1d, 0, 0); // Press Left CTRL
keybd_event(0x7b, 0x58, 0, 0); // Press F12
keybd_event(0x7b, 0xd8, 2, 0); // Release F12
keybd_event(0xa2, 0x9d, 2, 0); // Release Left CTRL 
```

另一种方法是在使用 SendKeys 之前激活您要发送到的应用程序。为此，您需要再次使用 P/Invoke 来查找应用程序的窗口并将其聚焦。

# ajax - Ajax 更新程序在 Internet Explorer 中不起作用

> ID：436432
> 
> 赞同：2
> 
> 时间：2009-01-12T18:21:06.930
> 
> 标签：ajax, internet-explorer

我有一个无法解决的 ajax 更新程序问题。我有这个代码 Servicii

它在 Firefox 中完美运行，但在 Internet Explorer 中它什么也不做。另外，如果我从我的硬盘驱动器打开该网站，它可以工作，但它只适用于链接一次，然后我必须重新加载整个页面......

有人对如何解决这个问题有想法吗？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-12T18:39:45.600

我有这个确切的问题。我假设您有一个函数，该函数定期向服务器发出请求以获取数据，然后如果自上次发出请求以来该数据已更改，则更新页面。

Internet Explorer 将缓存对同一资源的 Ajax 调用结果，即使您在 HTTP 标头中告诉它不要这样做。因此，如果您`get_data?id=whatever`一遍又一遍地发出请求，IE 将发出一次请求，然后在以后停止发出请求，并简单地返回第一次请求的结果。

解决方案是在请求字符串中添加一个虚拟参数。所以首先你请求`get_data?id=whatever&ie_hack=0`然后`get_data?id=whatever&ie_hack=1`等等。这将阻止 IE 缓存结果并强制它每次都发出请求，因为它会为每个请求看到不同的查询字符串。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-12T18:42:03.847

我也遇到了这样的问题，不是缓存而是竞争条件。IE 在返回任何数据之前执行了函数的渲染部分。这是问题和解决方案：

[返回的 AJAX html 中断 IE 点击事件](https://stackoverflow.com/questions/424886/returned-ajax-html-breaks-ie-click-events)

# javascript - Javascript 中的财务计算器运行速度比 Excel 慢得多

> ID：436445
> 
> 赞同：0
> 
> 时间：2009-01-12T18:24:32.883
> 
> 标签：javascript, excel, performance

我已将 Excel 退休计算器移植到 Javascript 中。原始 Excel 中有 35 个工作表，其中包含许多递归计算，我已将所有这些都转换为 Javascript。Javascript 运行速度较慢（与 Excel 的瞬时速度相比为 1-2 秒）。

我已经缓存了递归计算以加快速度并防止浏览器中的堆栈溢出。

尝试使 Javascript 更快是否现实？Excel是如何做到如此高效的？

我在某处读到 Excel 仅在修改单元格的先例时重新计算。尽管如此，在我看来，无论有多少数据需要重新计算，Excel 几乎都是即时的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-12T18:30:54.743

Excel 更快，因为它离 CPU 更近几层——在操作系统中运行编译的字节码，而不是在运行解释型 JavaScript 的浏览器中。

我会将性能与具有新一代 JavaScript 引擎的 Google Chrome 或 FF3 进行比较，看看情况如何改进。请参阅 John Resig 的帖子：[http](http://ejohn.org/blog/javascript-performance-rundown/) ://ejohn.org/blog/javascript-performance-rundown/ 。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-12T18:32:10.077

JavaScript 比现有的任何编译语言都慢，这就是 Excel 快得多的原因。我会使用[Firebug](http://getfirebug.com/)的分析器来找出你的代码大部分时间都花在了哪里，并专注于改进它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-12T18:39:08.423

如果您已将 Excel 公式移植到 JavaScript，同时保持算法不变，那么您最终得到的 JavaScript 代码可能不是最适合 JavaScript 的代码。您是否考虑过重构事物以利用 JavaScript 强大的语言特性？

此外，您在进行计算时是否在渲染内容（更新表格单元格等）？请记住，某些 DHTML 更新可能会给浏览器带来很大的负担（嘿，您是在浏览器中运行它，对吗？）也许将计算和渲染分开可能会有所帮助。你会先忙着做所有的计算，然后做演示作为最后一步。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-12T18:39:24.150

正如其他人所说，JavaScript 远没有编译语言那么快。目前，Chrome、Firefox 和 Webkit 的 JavaScript 解释器之间存在某种程度的军备竞赛，这确实提高了 JavaScript 的速度状况。但是，它仍然很慢，而且如果您使用的是 IE7（或者更糟糕的 IE6），性能可能会非常糟糕。

您可能想查看一些现有的 JavaScript 库（就我个人而言，我更喜欢[jQuery](http://jquery.com/)），看看其中一些是否具有您可以利用的实用功能。一些使用较多的 JavaScript 库可能已经优化了您正在尝试做的一些工作。它当然不会使 JavaScript 像 Excel 一样快，但是如果您可以用许多不同人优化的实用程序替换您的许多功能，您可能会看到速度有所提高。

# c - 用 C 语言规划和组织应用程序开发的最佳方式是什么？

> ID：436446
> 
> 赞同：3
> 
> 时间：2009-01-12T18:24:35.207
> 
> 标签：c

我只需要用 C 语言编写过几次代码，而且似乎每次我这样做时，它都会变成一些难以驾驭的野兽。

我的大部分编程都是在 C# 和 .Net 中完成的，所以我非常习惯于类风格的架构，但我似乎无法掌握 C 应用程序中的组织。我应该将相关的函数放在某个文件中，将函数定义放在一个文件中，然后在另一个文件中处理，等等。关于这个主题有什么好的资源吗？

另请参阅：[与来自面向对象领域的 C 作斗争？](https://stackoverflow.com/questions/674722/struggling-with-c-coming-from-object-oriented-land)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-12T18:38:58.440

这是一个可能对您有所帮助的类比：

类是某种数据结构和一组用于访问和操作该数据的函数。该`c`语言不提供任何语法糖来为您组织这种关系，但您仍然可以围绕这个想法构建您的代码。所以，就去做吧：围绕一堆“类”设计你的项目。

代码组织通常采用以下两种形式之一：

*   每个函数都有一个带有扩展名的头（接口）文件和一个带有扩展`.h`名的实现文件`.c`
*   每个“类”（即一组相关函数）都有一个头文件和一个实现文件。

所以，你已经知道如何做到这一点......

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-12T18:37:16.960

[David Hanson 的C 接口和实现](http://www.cs.princeton.edu/software/cii/)在第一章中解释了一个很好的可用组织方案（如果我没记错的话），并在其余的开发大量库的章节中展示了它的使用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-12T18:37:41.437

对 C 程序进行编码的旧“[结构化编程](http://en.wikipedia.org/wiki/Structured_programming)”方式是将它们模块化为文件。不要在对象中包含代码，而是确保将所有相关代码放入单独的文件中。

如果您将文件视为穷人的对象，那么您将主要在那里组织您的 C 应用程序，就像您处理 C# 应用程序一样。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-12T22:18:54.643

由于有 C# 方面的经验，您可能会对我的 SO 问题的回答感兴趣：“ [C 中的面向对象](https://stackoverflow.com/questions/415452/object-orientation-in-c "C中的面向对象")”。如果他们对您感兴趣，看看对相关问题的回答可能会很有用：“[你能用 c 编写面向对象的代码吗？](https://stackoverflow.com/questions/351733/can-you-write-object-oriented-code-in-c "你能用c写面向对象的代码吗？") ”。如果您打算使用上述问题的回复中提到的任何一种方案，请记住，最重要的是您的设计，**而不是**可能/可能不会使它看起来漂亮的语法糖。

# linux - 重定向输出时 cd 不起作用？

> ID：436452
> 
> 赞同：4
> 
> 时间：2009-01-12T18:25:49.760
> 
> 标签：linux, bash, macos, cd, built-in

这是一个谜：谁能解释为什么`cd`当输出被重定向到管道时失败？

例如：

```
james@machine:~$ cd /tmp                          # fine, no problem
james@machine:~$ cd /tmp | grep 'foo'             # doesn't work
james@machine:~$ cd /tmp | tee -a output.log      # doesn't work
james@machine:~$ cd /tmp >out.log                 # does work 
```

在 OSX、Ubuntu 和 RHEL 上验证。

有任何想法吗？

**编辑**：我正在输出的管道似乎很奇怪`cd`？原因是它来自一个函数，该函数用日志条目包装任意 shell 命令并处理输出。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-12T18:29:35.870

当您重定向输出时，它会生成一个子 shell 进程，更改子进程中的目录，然后退出。当您不重定向输出时，它不会产生任何新进程，因为它是一个内置的 shell 命令。

# c# - 文件管理

> ID：436456
> 
> 赞同：1
> 
> 时间：2009-01-12T18:27:59.820
> 
> 标签：c#, sql-server, database, dms

我正在为我的工作编写一个简单的文档管理系统。我只是一个业余爱好者，但现在已经编程了一段时间。我的问题是这个。当我通过我的应用程序删除一些文档时，我需要删除相关的数据库记录。如果抛出异常，最好的方法是什么，而不是以没有数据库记录的文件或指向不存在的文件的记录结束？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-12T19:19:13.757

将文件存储在数据库中。然后，您可以在不增加应用程序复杂性（MSMQ 等）的情况下拥有参照完整性。是的，这会增加你的数据库的大小。但是这些文件已经在您的服务器上，所以它只是在不同的地方相同的位。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-12T18:32:03.773

这是一种“分布式事务”系统。您可能想编写一个合并例程并偶尔运行一次，但有时您*会*遇到不一致的情况。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-12T19:10:26.660

你说“通过我的应用程序”。这是否意味着他们只能通过应用程序界面删除文件？如果是这样，请将删除包含在自定义事务中以删除文件并删除 db 记录。如果一侧失败，则回滚另一侧。

如果您想让他们从文件目录中删除文件，然后自动删除 db 记录，您可以做很多事情，包括定期清理和/或监视目录中活动的文件目录观察程序 Windows 服务和然后开始清理。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-12T20:53:04.237

感谢您的回复。我已经在考虑走 BLOB 路线，但不确定我的老板是否会这样做。他喜欢好的目录结构，你知道吗？至于分布式事务，我对它们一无所知，但它们似乎是最专业的处理方式。但我是一个业余爱好者，而且这一切似乎都太投入了，所以我将在 BLOB 方面赢得我的老板回合。干杯。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-12T18:35:55.467

您应该使用包含数据库和 MS 消息队列 (MSMQ) 的分布式事务。使用 Microsoft 分布式事务协调器 (DTC) 检查您的数据库是否可以注册到分布式事务中。

使用 MSMQ 对所有文件操作进行编程。

此[链接](http://www.codeproject.com/KB/dotnet/msmqpart2.aspx)可能对您有所帮助

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-12T19:15:47.303

我的一些应用程序中有类似的功能。

我所做的是首先通过 ap 删除文件，然后删除具有指向该文件的链接/指针的数据库记录。当用户请求一个文档时（这意味着该文件的链接仍然存在于数据库中），应用程序首先检查该文件，如果由于某种原因它不像预期的那样存在，它会清理数据库记录此时并优雅地通知用户“错误”。

无论如何，“孤立”文档不会发生太多，但使用此方法可确保数据库作为运行应用程序的正常部分不断被清理。

还有很多其他的方法来处理这个，但这个对我有用。

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2009-01-12T18:33:07.920

先删除数据库记录，偶尔审计一下存储库。通过审核存储库，我的意思是查找没有数据库记录的文件。如果您首先删除数据库记录，您的代码将不会查找实际不存在的文档。

您打算存储多少个文档以及什么类型的文档？

# html - 表单提交要求保存 exe，希望它改为运行

> ID：436458
> 
> 赞同：1
> 
> 时间：2009-01-12T18:29:14.980
> 
> 标签：html, forms, cgi

当我从 html 文件提交我的基本表单时，它让我可以选择保存
我只想运行 exe 的 exe。（重新填充模板 html 文件）
提交表单后，我需要做什么才能运行 exe？

```
<form action="Lib.exe" method=POST ID="Form1">
Enter Index to DELETE<br>
<input type=text name="user" ID="Text1">
<input type=submit value="DELETE">
</form> 
```

我正在运行一个网络服务器。html 文件和 .exe 位于运行 Web 文件的目录中。

任何帮助表示赞赏。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-12T18:41:52.740

我假设 lib.exe 在服务器上更新其模板，这意味着您需要配置您的 Web 服务器以运行 exe 文件，而不是向用户提供它们。您没有指定您运行的服务器（不知何故，我假设您运行 IIS...），但在 Apache 中，您将使用`<FilesMatch>`in`httpd.conf`为 exe 添加处理程序，如下所示：

```
<FilesMatch \.cgi$>
    SetHandler cgi-script
</FilesMatch> 
```

但适应了前任。请参阅此处的[mod_mime 文档](http://httpd.apache.org/docs/2.2/mod/mod_mime.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T18:47:40.107

1.  请澄清你的问题。什么是操作系统和网络服务器，网络服务器是否以受限权限运行？
2.  您能否将 Lib.exe 移植到您的网站使用的语言（PHP 或 ASP 或其他）？
3.  将服务器端脚本作为 CGI 执行小任务可能会降低系统速度，因为操作系统需要启动新进程、为新进程分配资源等……编译后的 C++ 可能比加载模块解释的 PHP 慢。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-12T20:51:39.827

弄清楚了。我在 CGI 应用程序中没有内容类型。
" Content-type: text/html"
没有这个，Web 服务器将不会执行它。新手错误。多谢你们。

现在我的 html 文件在 web 服务器上运行，表单调用 cgi-bin 目录中的 exe 并执行删除，由用户指定。

我的下一个挑战是弄清楚如何不实际显示或转到浏览器中的 Lib.exe。我希望它按原样运行，但请留在我的 html 页面，因为它现在已更新。我不想手动返回我的 html 页面。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-05-03T06:42:46.013

您可以使用 AJAX 代替表单提交并获得相同的结果。

# .net - 具有通用 DLookup 功能的公式解析/评估例程或库

> ID：436466
> 
> 赞同：0
> 
> 时间：2009-01-12T18:30:43.167
> 
> 标签：.net, sql, sql-server, visual-studio

我正在编写一个 .Net 应用程序，其中我必须支持可以执行基本数学的用户定义公式，以及从数据库中的任意表访问数据。

我有数学部分工作，使用 JScript Eval()。

我还没有决定什么是进行通用表查找的好方法。例如，我可能有一个**类似**的公式：
列：BonusAmount 公式：{CurrentSalary} * 1.5 * {[SystemSettings][Value][SettingName=CorpBonus AND Year={Year}]}

因此，在此示例中，我将用当前表中 xxx 列的值替换 {xxx} 和 {Year}，并将第二部分替换为 (select Value from SystemSettings WHERE SettingName='CorpBonus' AND Year =2008)

所以，基本上，我正在寻找非常类似于 MS Access DLookup 函数的东西：
DLookup (expression, domain, [criteria] )
DLookup("[UnitPrice]", "Order Details", "OrderID = 10248")

但是，我还需要整体解析例程，它可以判断是只在当前行中查找，还是查看另一个表。支持聚合函数（即：DAvg、DMax 等）以及处理所有奇怪的边缘情况也会很好。

所以我想知道是否有人知道任何类型的现有库，或者有一个很好的例程可以处理这个公式解析*和*数据库查找/聚合函数解析要求。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-25T11:15:23.337

您可以在 JScript 中实现自己的 DLookup 函数，并且“eval”表达式可以访问它。“eval”的缺点是用户可以调用任何其他 JScript 函数，这会使整个系统不安全。你能提供更多关于你的问题的细节吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-05-19T03:06:19.167

解决这个问题的最正确方法是使用解析器，例如 ANTLR [http://www.antlr.org/](http://www.antlr.org/)，而不是在公园里散步。

# sql - MySQL：将查询从 v4 迁移到 v5

> ID：436468
> 
> 赞同：1
> 
> 时间：2009-01-12T18:30:54.820
> 
> 标签：sql, mysql, migration, mysql5, mysql4

将项目从 MySQL 4 迁移到 MySQL 5 时，为了确保查询保持兼容，我需要解决哪些主要问题？

一般来说，事情应该没问题，但我知道一些在 MySQL 4 查询中隐式工作的事情必须在 MySQL 5 中明确定义（但我一生都记不清究竟是什么）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-12T20:43:52.417

有关可能影响您的差异列表，请参阅[http://dev.mysql.com/doc/refman/5.0/en/upgrading-from-4-1.html](http://dev.mysql.com/doc/refman/5.0/en/upgrading-from-4-1.html)。

我观察到的唯一一种情况是，当您有一个同时使用逗号样式 (SQL-89) 和`JOIN`-style 语法的查询时。必须重写一些 MySQL 4.x 查询以符合现在更符合标准的连接语义。请参阅[http://dev.mysql.com/doc/refman/5.0/en/join.html页面上的“MySQL 5.0.12 中的加入处理更改”](http://dev.mysql.com/doc/refman/5.0/en/join.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-13T01:21:20.950

除了比尔所说的之外，了解升级时需要做什么的最佳方法是在新数据库上离线试用您的应用程序。针对新数据库加载应用程序，看看有什么问题。

# visual-studio - VS2005：组装' ' 被错误地指定为文件。

> ID：436471
> 
> 赞同：58
> 
> 时间：2009-01-12T18:31:26.207
> 
> 标签：visual-studio, visual-studio-2005, build, assemblies, log4net

我在我的项目中添加了对 log4net 程序集 dll 的引用。

当我构建时，我收到一条警告：

> 警告程序集“Lib\log4net.dll”被错误地指定为文件。

我[在 MSDN 上查找此错误的帮助](http://msdn.microsoft.com/en-us/library/ms228157(VS.80).aspx)，它说：

> *当构建过程检测到文件引用实际上是（托管或本机）程序集*时，会在应用程序清单生成期间生成此警告。

这正是我正在做的；文件引用*是*一个程序集。我在这里被告知什么？

如何添加对程序集 dll 的引用，而不添加对程序集 dll 的引用？

* * *

## 回答 #1

> 赞同：105
> 
> 时间：2009-05-28T08:58:30.997

尝试将源 DLL 的 Build Action 属性设置为 None。它为我们解决了这个问题。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-04T18:28:00.603

我自己也遇到了这个问题。

这对我有用：

我添加了一个程序集作为参考和“现有资源”。从解决方案资源管理器中删除文件，关闭，然后重新打开项目有效。

# python - 用于 IndirectObject 提取的 pyPdf

> ID：436474
> 
> 赞同：12
> 
> 时间：2009-01-12T18:31:52.917
> 
> 标签：python, pdf, stream, pypdf

按照这个例子，我可以将所有元素列出到一个 pdf 文件中

```
import pyPdf
pdf = pyPdf.PdfFileReader(open("pdffile.pdf"))
list(pdf.pages) # Process all the objects.
print pdf.resolvedObjects 
```

现在，我需要从 pdf 文件中提取一个非标准对象。

我的对象是名为 MYOBJECT 的对象，它是一个字符串。

与我有关的python脚本打印的部分是：

```
{'/MYOBJECT': IndirectObject(584, 0)} 
```

pdf文件是这样的：

```
558 0 obj
<</Contents 583 0 R/CropBox[0 0 595.22 842]/MediaBox[0 0 595.22 842]/Parent 29 0 R/Resources
  <</ColorSpace <</CS0 563 0 R>>
    /ExtGState <</GS0 568 0 R>>
    /Font<</TT0 559 0 R/TT1 560 0 R/TT2 561 0 R/TT3 562 0 R>>
    /ProcSet[/PDF/Text/ImageC]
    /Properties<</MC0<</MYOBJECT 584 0 R>>/MC1<</SubKey 582 0 R>> >>
    /XObject<</Im0 578 0 R>>>>
  /Rotate 0/StructParents 0/Type/Page>>
endobj
...
...
...
584 0 obj
<</Length 8>>stream

1_22_4_1     --->>>>  this is the string I need to extract from the object

endstream
endobj 
```

我如何按照`584`值来引用我的字符串（当然是在 pyPdf 下）？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-14T02:46:14.337

每个元素`pdf.pages`都是一个字典，所以假设它在第 1 页，`pdf.pages[0]['/MYOBJECT']`应该是你想要的元素。

您可以尝试单独打印或在 python 提示符中戳它`help`以`dir`获取有关如何获取所需字符串的更多信息

编辑：

在收到 pdf 的副本后，我找到了对象，`pdf.resolvedObjects[0][558]['/Resources']['/Properties']['/MC0']['/MYOBJECT']`并且可以通过 getData() 检索该值

下面的函数提供了一种更通用的方法来通过递归查找有问题的键来解决这个问题

```
import types
import pyPdf
pdf = pyPdf.PdfFileReader(open('file.pdf'))
pages = list(pdf.pages)

def findInDict(needle,haystack):
    for key in haystack.keys():
        try:
            value = haystack[key]
        except:
            continue
        if key == needle:
            return value
        if type(value) == types.DictType or isinstance(value,pyPdf.generic.DictionaryObject):  
            x = findInDict(needle,value)
            if x is not None:
                return x

answer = findInDict('/MYOBJECT',pdf.resolvedObjects).getData() 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-14T09:32:55.327

IndirectObject 指的是一个实际的对象（它就像一个链接或别名，因此当相同的内容出现在多个位置时，可以减小 PDF 的总大小）。getObject 方法将为您提供实际对象。

如果对象是文本对象，那么只需对对象执行 str() 或 unicode() 即可获取其中的数据。

或者，pyPdf 将对象存储在 resolvedObjects 属性中。例如，包含此对象的 PDF：

```
13 0 obj
<< /Type /Catalog /Pages 3 0 R >>
endobj 
```

可以这样阅读：

```
>>> import pyPdf
>>> pdf = pyPdf.PdfFileReader(open("pdffile.pdf"))
>>> pages = list(pdf.pages)
>>> pdf.resolvedObjects
{0: {2: {'/Parent': IndirectObject(3, 0), '/Contents': IndirectObject(4, 0), '/Type': '/Page', '/Resources': IndirectObject(6, 0), '/MediaBox': [0, 0, 595.2756, 841.8898]}, 3: {'/Kids': [IndirectObject(2, 0)], '/Count': 1, '/Type': '/Pages', '/MediaBox': [0, 0, 595.2756, 841.8898]}, 4: {'/Filter': '/FlateDecode'}, 5: 147, 6: {'/ColorSpace': {'/Cs1': IndirectObject(7, 0)}, '/ExtGState': {'/Gs2': IndirectObject(9, 0), '/Gs1': IndirectObject(10, 0)}, '/ProcSet': ['/PDF', '/Text'], '/Font': {'/F1.0': IndirectObject(8, 0)}}, 13: {'/Type': '/Catalog', '/Pages': IndirectObject(3, 0)}}}
>>> pdf.resolvedObjects[0][13]
{'/Type': '/Catalog', '/Pages': IndirectObject(3, 0)} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-15T00:25:07.880

如果到处寻找对象，耶希亚的方法很好。我的猜测（查看 PDF）是它总是在同一个地方（第一页，在 'MC0' 属性中），因此查找字符串的更简单的方法是：

```
import pyPdf
pdf = pyPdf.PdfFileReader(open("file.pdf"))
pdf.getPage(0)['/Resources']['/Properties']['/MC0']['/MYOBJECT'].getData() 
```

# java - Facelets custom component doesn't set attribute after submit

> ID：436488
> 
> 赞同：0
> 
> 时间：2009-01-12T18:36:31.267
> 
> 标签：java, jsf, facelets

I am having a problem with custom components in facelets. The first time that the page is rendered, the attributes are set properly on the component class. When a form is submitted however, the attributes are not set.

Here is the class that I am using to test this.

```
public class TestEcho extends UIData
{
    /** Logger. */
    private static Log log = LogFactory.getLog(TestEcho.class);

    private String msg;

    public TestEcho()
    {
        log.debug("Constructor.");
    }

    public void encodeEnd(FacesContext context) throws IOException
    {
        ResponseWriter writer = context.getResponseWriter();
        writer.startElement("div", this);
        writer.writeText("The value of msg is '" + msg + "'.", null);
        writer.endElement("div");
    }

    public void setMsg(String msg)
    {
        log.debug("Setting msg to '" + msg + "'.");
        this.msg = msg;
    }
} 
```

The component is used in the .xhtml page like this.

```
<h:form>
    <v:testEcho msg="hello" />
    <h:commandButton action="#{PictureManager.trigger}" value="Click" />
</h:form> 
```

When the page renders for the first time, the component renders the following html code.

```
<div>The value of msg is 'hello'.</div> 
```

When the button is clicked, it renders this.

```
<div>The value of msg is 'null'.</div> 
```

From the log, you can see that the component is constructed again, but the attribute is not set.

```
13:23:42,955 DEBUG [TestEcho] Constructor.
13:23:42,955 DEBUG [TestEcho] Setting msg to 'hello'.
----- Button was pressed here -----
13:25:48,988 DEBUG [TestEcho] Constructor.
13:25:49,144 DEBUG [PictureManager] Button pressed. 
```

From what I understand, facelets does all the wiring of attributes to components so I don't need a tag class, but I don't understand why the attribute would be set correctly the first time, but not the second time.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-13T11:21:02.363

You must save your state by overriding the [saveState](http://java.sun.com/javaee/javaserverfaces/1.2/docs/api/javax/faces/component/UIData.html#saveState(javax.faces.context.FacesContext)) and [restoreState](http://java.sun.com/javaee/javaserverfaces/1.2/docs/api/javax/faces/component/UIData.html#restoreState(javax.faces.context.FacesContext,%20java.lang.Object)) methods.

So, *saveState* must return a [Serializable](http://java.sun.com/javase/6/docs/api/java/io/Serializable.html) object (e.g. a JavaBean or Object[] array) containing the value in *msg* and whatever is returned by *super.saveState*. This object will be provided to *restoreState* where the method must restore *msg* from the object and pass the parent state to *super.restoreState*.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-13T15:08:32.780

McDowell's answer did it. Just for completeness, here's the two methods I added.

```
public Object saveState(FacesContext context)
{
    Object[] rtrn = new Object[2];
    rtrn[0] = super.saveState(context);
    rtrn[1] = msg;
    return rtrn;
}

public void restoreState(FacesContext context, Object state)
{
    Object[] values = (Object[]) state;
    super.restoreState(context, values[0]);
    msg = (String) values[1];
} 
```

# python - Python：导入包含的包

> ID：436497
> 
> 赞同：62
> 
> 时间：2009-01-12T18:38:15.180
> 
> 标签：python, module, package, python-import

在位于包内的模块中，我需要使用`__init__.py`该包中定义的函数。如何在包中的模块中导入包，以便我可以使用该功能？

在模块内部导入`__init__`不会导入包，而是导入名为 的模块`__init__`，导致两个不同名称的事物副本......

有没有一种pythonic方法可以做到这一点？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-01-12T19:52:19.120

此外，从 Python 2.5 开始，可以进行相对导入。例如：

```
from . import foo 
```

引用[http://docs.python.org/tutorial/modules.html#intra-package-references](http://docs.python.org/tutorial/modules.html#intra-package-references)：

* * *

从 Python 2.5 开始，除了上面描述的隐式相对导入之外，您还可以使用 import 语句的 from module import name 形式编写显式相对导入。这些显式的相对导入使用前导点来指示相对导入中涉及的当前包和父包。例如，从周围的模块中，您可以使用：

```
from . import echo
from .. import formats
from ..filters import equalizer 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-01-12T18:40:53.740

这并不能完全回答您的问题，但我建议您将函数移到`__init__.py`文件之外，并移到该包内的另一个模块中。然后，您可以轻松地将该功能导入您的其他模块。如果需要，您可以在`__init__.py`文件中包含一个导入语句，该语句也将导入该函数（导入包时）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-12T19:13:51.613

如果包被命名`testmod`并且您的初始化文件因此而被命名并且您`testmod/__init__.py`的包中的模块`submod.py`则来自`submod.py`文件中，那么您应该能够说出`import testmod`和使用在 testmod 中定义的任何您想要的东西。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-02T02:30:46.717

在 Django 中，文件 manage.py 有`from django.core.management import execute_manager`，但`execute_manager`不是模块。它是目录`__init__.py`模块中的一个函数`management`。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-12T19:26:02.213

我不完全确定情况如何，但这可能会解决您的“不同名称”问题：

```
import __init__ as top
top.some_function() 
```

或者可能？：

```
from __init__ import some_function
some_function() 
```

# c++ - 字符！=（有符号字符），字符！=（无符号字符）

> ID：436513
> 
> 赞同：45
> 
> 时间：2009-01-12T18:41:08.420
> 
> 标签：c++, char

下面的代码可以编译，但 char 类型的行为与 int 类型的行为不同。

尤其

```
 cout << getIsTrue< isX<int8>::ikIsX  >() << endl;
   cout << getIsTrue< isX<uint8>::ikIsX  >() << endl;
   cout << getIsTrue< isX<char>::ikIsX  >() << endl; 
```

为三种类型生成 3 个模板实例：int8、uint8 和 char。是什么赋予了？

对于 int 而言，情况并非如此： int 和 uint32 导致相同的模板实例化，并签署了 int 另一个。

原因似乎是 C++ 将 char、signed char 和 unsigned char 视为三种不同的类型。而 int 与带符号的 int 相同。这是对的还是我错过了什么？

```
#include <iostream>

using namespace std;

typedef   signed char       int8;
typedef unsigned char      uint8;
typedef   signed short      int16;
typedef unsigned short     uint16;
typedef   signed int        int32;
typedef unsigned int       uint32;
typedef   signed long long  int64;
typedef unsigned long long uint64;

struct TrueType {};
struct FalseType {};

template <typename T>
struct isX
{
   typedef typename T::ikIsX ikIsX;
};

// This  int==int32 is ambiguous
//template <>            struct isX<int  >    { typedef FalseType ikIsX; };  // Fails
template <>            struct isX<int32  >  { typedef FalseType ikIsX; };
template <>            struct isX<uint32 >  { typedef FalseType ikIsX; };

// Whay isn't this ambiguous? char==int8
template <>            struct isX<char  >  { typedef FalseType ikIsX; };
template <>            struct isX<int8  >  { typedef FalseType ikIsX; };
template <>            struct isX<uint8 >  { typedef FalseType ikIsX; };

template <typename T> bool getIsTrue();
template <>           bool getIsTrue<TrueType>() { return true; }
template <>           bool getIsTrue<FalseType>() { return false; }

int main(int, char **t )
{
   cout << sizeof(int8) << endl;  // 1
   cout << sizeof(uint8) << endl; // 1
   cout << sizeof(char) << endl;  // 1

   cout << getIsTrue< isX<int8>::ikIsX  >() << endl;
   cout << getIsTrue< isX<uint8>::ikIsX  >() << endl;
   cout << getIsTrue< isX<char>::ikIsX  >() << endl;

   cout << getIsTrue< isX<int32>::ikIsX  >() << endl;
   cout << getIsTrue< isX<uint32>::ikIsX  >() << endl;
   cout << getIsTrue< isX<int>::ikIsX  >() << endl;

} 
```

我正在使用 g++ 4.something

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2009-01-12T18:58:48.243

这是您从标准中得到的答案：

> 3.9.1 基本类型[basic.fundamental]
> 
> 声明为字符 ( `char`) 的对象应足够大以存储实现的基本字符集的任何成员。如果该集合中的字符存储在字符对象中，则该字符对象的整数值等于该字符的单个字符文字形式的值。`char`对象是否可以保存负值是实现定义的。字符可以显式声明`unsigned`或`signed`. ***Plain `char`、`signed char`和`unsigned char`是三种不同的类型。*** A `char`、 a`signed char`和 an`unsigned char` 占用相同的存储量并具有相同的对齐要求（*basic.types*); 也就是说，它们具有相同的对象表示。对于字符类型，对象表示的所有位都参与值表示。对于无符号字符类型，值表示的所有可能的位模式都表示数字。这些要求不适用于其他类型。在任何特定的实现中，普通对象可以采用与 a或 an`char`相同的值；哪一个是实现定义的。`signed char``unsigned char`

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2009-01-12T19:18:29.420

虽然大多数整数类型（例如`short`并且`int`默认为be ）在 C++`signed`中`char`没有默认标志。

它既不是 type`signed char`也不是`unsigned char`，所以实现可以决定它是否被签名。

这是 C++ 程序员在使用`char`8 位整数类型时遇到的常见错误。

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2009-01-12T20:01:42.470

对于诸如此类的问题，我喜欢查看 C 的基本原理文档，该文档通常也提供 C++ 奥秘的答案，这些奥秘有时会在我阅读标准时出现。它有这样的说法：

> 指定了三种类型的 char：signed、plain 和 unsigned。一个普通的 char 可以表示为有符号或无符号，这取决于实现，如在先前的实践中一样。引入有符号字符类型是为了在那些将普通字符实现为无符号的系统上提供单字节有符号整数类型。出于对称的原因，关键字signed 被允许作为其他整数类型的类型名称的一部分。

[C 的基本原理](http://www.lysator.liu.se/c/rat/title.html)

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2009-01-12T18:51:10.567

这是正确的, `char`,`unsigned char`并且`signed char`是单独的类型。`char`如果只是同义词`signed char`或`unsigned char`取决于您的编译器实现，那可能会很好，但标准说它们是单独的类型。

# c# - Uri.AbsolutePath 用空格弄乱了路径

> ID：436520
> 
> 赞同：14
> 
> 时间：2009-01-12T18:42:44.657
> 
> 标签：c#, .net-2.0, system.net, winapp

在 WinApp 中，我只是想从 Uri 对象中获取绝对路径：

```
Uri myUri = new Uri(myPath); //myPath is a string
//somewhere else in the code
string path = myUri.AbsolutePath; 
```

如果我的原始路径中没有空格，这可以正常工作。如果那里有空格，则字符串会被破坏；例如“文档和设置”变为“文档%20and%20Setting”等。

任何帮助，将不胜感激！

**编辑：** LocalPath 而不是 AbsolutePath 成功了！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-12T18:52:30.783

这是它应该的方式。这称为 URL 编码。它适用，因为 URL 中不允许有空格。

如果您希望返回包含空格的路径，则必须调用如下内容：

```
string path = Server.URLDecode(myUri.AbsolutePath); 
```

您不应该被要求导入任何东西来在 Web 应用程序中使用它。如果出现错误，请尝试导入 System.Web.HttpServerUtility。或者，您可以这样称呼它：

```
string path = HttpContext.Current.Server.URLDecode(myUri.AbsolutePath); 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-01-12T18:50:50.180

它正在按应有的方式对其进行编码，您可能可以对其进行 UrlDecode 以将其带回空格，但它并没有“损坏”，它只是正确编码。

我不确定您在写什么，但是要将其转换回 asp.net，它是 Server.UrlDecode(path)。如果它是 Windows 应用程序，您也可以使用 LocalPath，而不是 AbsolutePath。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-07-24T16:17:59.900

只需使用 uri.LocalPath 代替

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-11-08T06:57:37.810

Uri 还有几个静态方法 - [EscapeDataString](http://msdn.microsoft.com/en-us/library/system.uri.escapedatastring.aspx)和 EscapeUriString。

`Uri.EscapeDataString(uri.AbsolutePath)`也有效

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-10-15T13:53:50.667

使用 HttpUtility：

```
 HttpUtility.UrlDecode(uri.AbsolutePath) 
```

# c# - 这是表达此 XDocument 查询的最有效方式吗？

> ID：436522
> 
> 赞同：5
> 
> 时间：2009-01-12T18:42:45.763
> 
> 标签：c#, xml, .net-3.5, linq-to-xml

我们使用了一个返回 XML 的第三方 Web 服务，它看起来像（为了简洁而删减）：

```
<Response>
  <block name="availability">
    <block name="cqual">
      <a name="result-code" format="text">L</a>
    </block>
    <block name="exchange">
      <a name="code" format="text">MRDEN</a>
    </block>
    <block name="mqual">
      <a name="rate-adaptive" format="text">G</a>
    </block>
  </block>
  <block name="products">
    <block>
      <a name="product-id" format="counting">1235</a>
      <block name="realms">
        <block>
          <a name="realm" format="text">-u@surfuk1</a>
        </block>
      </block>
    </block>
    <block>
      <a name="product-id" format="counting">1236</a>
      <block name="realms">
        <block>
          <a name="realm" format="text">-u@surfuk2</a>
        </block>
      </block>
    </block>
    <block>
      <a name="product-id" format="counting">1237</a>
      <block name="realms">
        <block>
          <a name="realm" format="text">-u@surfuk3</a>
        </block>
      </block>
    </block>
  </block>
  <status no="0" />
</Response> 
```

对于特定的产品代码，我需要获取`realm`名称，即内部文本：

`<a name="realm" format="text">`**-u@surfuk2**`</a>`

因为每个元素名称要么是要么`<block>`用`<a>`linq 解析为 xml 或查询表达式有点麻烦。

以下是获取特定产品的领域名称（例如 1235）的最有效/最有效/最具表现力的方式：

```
List<XElement> products = response
    .Element("Response")
    .Elements("block")
    .Where(x => x.Attribute("name").Value == "products")
    .Elements("block").ToList();
//
// I broke down the query to aid readability
//
string realm = products.Elements("a")
    .Where(x => x.Attribute("name").Value == "product-id")
    .Where(y => y.Value == "1235") // hardcoded for example use
    .Ancestors()
    .First()
    .Elements("block")
    .Where(z => z.Attribute("name").Value == "realms")
    .Elements("block")
    .Elements("a")
    .First().Value; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-12T20:08:53.187

**as provided的定义`realm`等同于更简单的**：

```
string realm = (string) products.XPathEvaluate(
   "string(
      /*/blocks[@name='products']
                 /*/a[@name='product-id' and . = '1236']
                              /following-sibling::block[1]
          )
   "
                                     ) 
```

**`realm`实际上，这比原始问题中提供的定义**更具可读性和紧凑性。****

 ****就效率而言**，很可能评估单个 XPath 表达式也可能更有效，但是要确定这是否正确，我们需要编写一个应用程序来比较两种方法的时间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-12T19:05:25.593

看起来是这样，但为什么你需要所有的`ToList()`电话？我看到其中三个调用，我认为它们不是必需的，因此它们只会减慢您的代码速度。但是话又说回来，我没有使用太多的 Linq-to-XMl。

# api - 在集合中实现“默认”项目的最佳设计

> ID：436523
> 
> 赞同：1
> 
> 时间：2009-01-12T18:43:42.017
> 
> 标签：api, collections, class-design

在我的示例中，我有一个 Person 类，其中有任意数量的关联地址与之关联。所以会有一个 Addresses 集合作为 Person 类的成员。

在许多使用 Person 类的应用程序中，我们只想检索“默认”地址对象。关于实现有几个设计问题：

1.  在数据库中的每个地址记录上，我可以有一个标志来设置它是否是集合的默认值。或者，我可以有不同类型的地址（家庭、账单、送货等），并设置规则来说明如果某人有家庭地址记录，则将其用作默认值。如果没有，则使用运输等...
2.  至于用于检索默认地址的接口，我们有很多方法可以做到这一点，我想知道一些 SO 人感觉最好的方法。

    ```
    Address a1 = myPerson.DefaultAddress;
    Address a1 = myPerson.Addresses["Default"];
    Address a1 = myPerson.Addresses.Default; 
    ```

说“这取决于您的应用程序”可能是个好建议。让我先说我们正在为我们所有的新开发构建一些基础课程。所以我不一定只看我们正在构建的第一个应用程序作为类设计的最终决定。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-12T18:51:43.703

如果您为数据库中的每条记录设置标志，您将拥有最广泛的功能。硬编码显示默认地址的规则将限制您的设计。

对于数字 2，第三种实现听起来像是最面向对象的。

# multithreading - 在长时间任务期间保持应用程序响应

> ID：436524
> 
> 赞同：4
> 
> 时间：2009-01-12T18:45:01.157
> 
> 标签：multithreading, delphi, callback

我们应用程序中的某个表单显示模型的图形视图。用户可以在大量其他内容中启动模型转换，这可能需要相当长的时间。这种转换有时会在没有任何用户交互的情况下进行，有时则需要频繁的用户输入。除非需要用户输入，否则应禁用 UI（仅显示进度对话框）。

可能的方法：

1.  忽略这个问题，只需将转换代码放在一个过程中并调用它。不好，因为在转换需要一些时间但不需要用户输入的情况下，应用程序似乎挂起。
2.  在代码中添加回调：这很突兀——你必须在转换代码中放置**很多**这样的调用——而且是不可预测的——你永远无法确定你找到了正确的位置。
3.  用 Application.ProcessMessages 撒上代码：与回调相同的问题。此外，您还会遇到 ProcessMessages 的所有问题。
4.  使用线程：这使我们摆脱了 2\. 和 3 的“突兀和不可预测”部分。但是，由于用户输入需要“编组”，因此需要做很多工作 - 调用 Synchronize，将任何需要的参数放入量身定制的记录等。调试也是一场噩梦，而且容易出错。

//编辑：我们当前的解决方案是线程。然而，由于用户输入，a** 很痛苦。在很多例程中可能会有很多输入代码。这让我感觉线程**不是**正确的解决方案。

我要让自己难堪，并发布我生成的 GUI 和工作代码的邪恶组合的大纲：

```
type
  // Helper type to get the parameters into the Synchronize'd routine:
  PGetSomeUserInputInfo = ^TGetSomeUserInputInfo;
  TGetSomeUserInputInfo = record
    FMyModelForm: TMyModelForm;
    FModel: TMyModel;
    // lots of in- and output parameters
    FResult: Boolean;
  end;

{ TMyThread }

function TMyThread.GetSomeUserInput(AMyModelForm: TMyModelForm;
  AModel: TMyModel; (* the same parameters as in TGetSomeUserInputInfo *)): Boolean;
var
  GSUII: TGetSomeUserInputInfo;
begin
  GSUII.FMyModelForm := AMyModelForm;
  GSUII.FModel := AModel;
  // Set the input parameters in GSUII

  FpCallbackParams := @GSUII; // FpCallbackParams is a Pointer field in TMyThread
  Synchronize(DelegateGetSomeUserInput);
  // Read the output parameters from GSUII
  Result := GSUII.FResult;
end;

procedure TMyThread.DelegateGetSomeUserInput;
begin
  with PGetSomeUserInputInfo(FpCallbackParams)^ do
    FResult := FMyModelForm.DoGetSomeUserInput(FModel, (* the params go here *));
end;

{ TMyModelForm }

function TMyModelForm.DoGetSomeUserInput(Sender: TMyModel; (* and here *)): Boolean;
begin
  // Show the dialog
end;

function TMyModelForm.GetSomeUserInput(Sender: TMyModel; (* the params again *)): Boolean;
begin
  // The input can be necessary in different situations - some within a thread, some not.
  if Assigned(FMyThread) then
    Result := FMyThread.GetSomeUserInput(Self, Sender, (* the params *))
  else
    Result := DoGetSomeUserInput(Sender, (* the params *));
end; 
```

你有什么意见吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-12T19:46:40.003

我认为只要您的长期转换需要用户交互，您就不会对得到的任何答案感到真正满意。因此，让我们回顾一下：为什么需要通过请求更多信息来中断转换？这些真的是您在开始转型之前无法预料的问题吗？当然，用户对中断也不太满意，对吧？他们不能只是开始转型，然后去喝杯咖啡；他们需要坐下来观看进度条，以防出现问题。啊。

也许转型遇到的问题是可以“保存”到最后的东西。转型是否*需要*立即知道答案，或者它是否可以完成其他所有事情，然后再做一些“修复”？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-12T18:51:50.863

绝对选择线程选项（***即使***在您编辑之后，说您觉得它很复杂）。 [在我看来， duffymo 建议的解决方案](https://stackoverflow.com/questions/436524/keep-app-responsive-during-long-task#436533)是非常糟糕的 UI 设计（尽管它没有明确地与外观有关，但它与用户与应用程序的交互方式有关）。这样做的程序很烦人，因为您不知道任务将花费多长时间，何时完成等。可以使这种方法变得更好的唯一方法是用生成日期/时间标记结果，但即使那么您需要用户记住他们何时开始该过程。

花点时间/精力，使应用程序对您的最终用户有用、信息丰富且不那么令人沮丧。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-12T19:31:22.483

为了获得最佳解决方案，无论如何您都必须分析您的代码，并找到所有地方来检查用户是否想要取消长时间运行的操作。对于简单的过程和线程化的解决方案都是如此——您希望操作在十分之几秒后完成，以使您的程序看起来对用户有响应。

现在我首先要做的是使用以下方法创建一个接口（或抽象基类）：

```
IModelTransformationGUIAdapter = interface
  function isCanceled: boolean;
  procedure setProgress(AStep: integer; AProgress, AProgressMax: integer);
  procedure getUserInput1(...);
  ....
end; 
```

并将过程更改为具有此接口或类的参数：

```
procedure MyTransformation(AGuiAdapter: IModelTransformationGUIAdapter); 
```

现在您准备在后台线程或直接在主 GUI 线程中实现事物，一旦您添加了更新进度和检查取消请求的代码，转换代码本身就不需要更改。您只能以不同的方式实现接口。

我肯定会不使用工作线程，特别是如果您无论如何都想禁用 GUI。要利用多个处理器内核，您始终可以找到相对分离的转换过程部分，并在它们自己的工作线程中处理它们。这将为您提供比单个工作线程更好的吞吐量，并且使用[AsyncCalls](http://andy.jgknet.de/blog/?page_id=100)很容易完成。只要你有处理器内核就可以并行启动它们。

**编辑：**

IMO Rob Kennedy 的[这个答案](https://stackoverflow.com/questions/436524/keep-app-responsive-during-long-task#436746)是迄今为止最有见地的，因为它不关注实施的细节，而是关注用户的最佳体验。这肯定是你的程序应该优化的地方。

如果真的无法在转换开始之前获取所有信息，或者稍后运行它并修补一些东西，那么您仍然有机会让计算机做更多的工作，以便用户获得更好的体验。我从您的各种评论中看到，转换过程有很多点，执行分支取决于用户输入。想到的一个例子是用户必须在两个备选方案（如水平或垂直方向）之间进行选择 - 您可以简单地使用 AsyncCalls 来启动这两个转换，并且用户选择他的备选方案的那一刻有可能结果已经计算出来，因此您可以简单地显示下一个输入对话框。这将更好地利用多核机器。也许是一个跟进的想法。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-12T18:52:53.840

TThread 完美且易于使用。

开发和调试你的慢函数。

如果准备好了，将调用放入 tthread 执行方法。使用 onThreadTerminate 事件找出函数的结束。

对于用户反馈，请使用 syncronize！

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-13T08:40:24.700

我认为你的愚蠢是将转型视为一项单一任务。如果需要用户输入作为计算的一部分，并且要求的输入取决于到目前为止的计算，那么我会将单个任务重构为多个任务。

然后，您可以运行任务、请求用户输入、运行下一个任务、请求更多输入、运行下一个任务等。

如果您将流程建模为工作流，则应该清楚需要哪些任务、决策和用户输入。

我会在后台线程中运行每个任务以保持用户界面的交互性，但不会出现所有编组问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-12T18:47:25.753

通过向队列发送消息并让侦听器进行处理来进行异步处理。控制器向用户发送一条 ACK 消息，上面写着“我们已收到您的处理请求。请稍后再回来查看结果。” 给用户一个邮箱或链接，以查看事情的进展情况。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-12T21:37:45.847

虽然我不完全理解您要做什么，但我可以提供的是我对可能解决方案的看法。我的理解是，您有一系列 n 事情要做，并且在此过程中对一件事情的决定可能会导致一个或多个不同的事情被添加到“转换”中。如果是这种情况，那么我会尝试（尽可能地）将 GUI 和决策与需要完成的实际工作分开。当用户启动“转换”时，我会（还没有在线程中）循环遍历每个必要的决策，但不执行任何工作......只是询问完成工作所需的问题，然后将步骤与参数到列表中。

完成最后一个问题后，生成您的线程，将要运行的步骤列表与参数一起传递给它。这种方法的优点是您可以显示 n 个项目中的 1 个的进度条，让用户了解他们在喝完咖啡后回来可能需要多长时间。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-13T09:24:46.903

我当然会选择线程。弄清楚线程如何与用户交互通常很困难，但对我来说效果很好的解决方案是不让线程与用户交互，而是让用户端 GUI 与线程交互。这解决了使用同步更新 GUI 的问题，并为用户提供更多响应活动。

因此，为此，我使用线程中的各种变量（由使用临界区的 Get/Set 例程访问）来包含状态信息。对于初学者，我有一个 GUI 的“已取消”属性来设置请求线程停止。然后是一个“状态”属性，指示线程是在等待、忙碌还是完成。您可能有一个“人类可读”状态来指示正在发生的事情，或者完成百分比。

要阅读所有这些信息，只需在表单上使用计时器并进行更新。我也倾向于有一个“statusChanged”属性，如果其他项目之一需要刷新，则设置该属性，这会阻止过多的阅读。

这在各种应用程序中对我来说效果很好，包括一个在带有进度条的列表框中显示多达 8 个线程的状态的应用程序。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-13T21:45:43.070

如果您决定使用 Threads，我也发现它们在 Delphi 中实现的方式有些复杂，我会推荐 Primož Gabrijelčič 或 Gabr 的[OmniThreadLibrary](http://otl.17slon.com/)，[因为](https://stackoverflow.com/users/4997/gabr)他在 Stack Overflow 上是众所周知的。

这是我所知道的最简单的使用线程库。Gabr 写了很棒的东西。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-12T23:34:11.853

如果您可以将转换代码分成小块，那么您可以在处理器空闲时运行该代码。只需创建一个事件处理程序，将其连接到 Application.OnIdle 事件。只要您确保每个代码块都相当短（您希望应用程序无响应的时间量......比如说 1/2 秒。重要的是在最后将 done 标志设置为 false你的处理程序：

```
procedure TMyForm .IdleEventHandler(Sender: TObject;
  var Done: Boolean);
begin
  {Do a small bit of work here}
  Done := false;
end; 
```

因此，例如，如果您有一个循环，而不是使用 for 循环，而是使用 while 循环，请确保循环变量的范围在表单级别。在设置 onIdle 事件之前将其设置为零，然后例如每次 onidle 命中执行 10 次循环，直到您到达循环的末尾。

```
Count := 0;
Application.OnIdle := IdleEventHandler;

...
...

procedure TMyForm .IdleEventHandler(Sender: TObject;
  var Done: Boolean);
var
  LocalCount : Integer;
begin
  LocalCount := 0;

  while (Count < MaxCount) and (Count < 10) do
  begin
    {Do a small bit of work here}
    Inc(Count);
    Inc(LocalCount);
  end;
  Done := false;
end; 
```

# jquery - JS/JQuery 图像过渡效果——百叶窗？

> ID：436539
> 
> 赞同：1
> 
> 时间：2009-01-12T18:51:41.970
> 
> 标签：jquery, flash, image, jquery-plugins, transition

我想要两个或更多图像之间的过渡效果。我知道在 JQuery 中可以轻松完成简单的转换，尤其是使用[Cycle](http://malsup.com/jquery/cycle/)插件，但我想要更复杂的东西。 [像这样](http://www.pixel2life.com/publish/tutorials/631/how_to_create_a_diagonal_opening_blinds_transition_effect_for_images_in_flash_2/)，虽然这是一个糟糕的例子。一种“百叶窗”风格的效果，您可以在其中看到一个图像随着另一个图像的变化而变化。我希望我很清楚。

如果可能的话，我真的很想避免使用 Flash。

* * *

我已经用过`animate`几次了。我想要的是一种实现我链接到的过渡风格的方法，无论是现成的还是有一点帮助的。我的问题是图像本质上是分裂的，而不仅仅是移动。也许有一种使用口罩的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-12T22:07:04.917

仅使用 javascript 几乎不可能实现对角线百叶窗。我可以想出一些方法来处理图像文件，但这将是一个神圣的黑客，动画不太可能是流畅的。可能有办法用画布来做，但这也会让人头疼，因为你必须使用 canvas->vml 才能让它与 IE 一起工作。

如果您对水平/垂直百叶窗没问题，只需附加一堆 div 并为宽度/高度设置动画。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-08-27T12:14:01.460

如果你对垂直百叶窗选项没问题，现在有一个非常漂亮的 jQuery 插件可以达到你想要的效果：http: [//nivo.dev7studios.com](http://nivo.dev7studios.com/)

# vbscript - 使用 VBScript 和“;”将文本文件排列成数组 分隔符

> ID：436559
> 
> 赞同：0
> 
> 时间：2009-01-12T18:58:05.453
> 
> 标签：vbscript, csv

我有一个相当大的数据列表，每个元素包含 5 个属性。元素用“;”分隔。我想将元素读入 VBScript 中的数组。似乎很简单，可以在大 G 上搜索这个，但所有明确的例子都假设你想逐行阅读，然后在“;”上的一行上拆分内容 特点。我不在乎在“;”之前有多少行 我只希望每个元素的所有信息（在本例中为 5 个属性字段）都在一个数组元素中。

源文件如下所示：

```
元素 1 属性 1 = 等等
元素 1 属性 2 = 等等
元素 1 属性 3 = 等等
元素 1 属性 4 = 等等
元素 1 属性 5 = 等等
;element2 属性 1 = 废话
元素 2 属性 2 = 等等
元素 2 属性 3 = 废话
element2 property4 = 废话
element2 property5 = 废话
;element3 属性 1 = 废话
element3 property2 = 废话
element3 property3 = 废话
element3 property4 = 废话
element3 property5 = 废话

```

我想要发生的是我的 VBScript array(0) 是

```
“元素 1 属性 1 = 废话
元素 1 属性 2 = 等等
元素 1 属性 3 = 等等
元素 1 属性 4 = 等等
element1 property5 = blah"
```

关于如何做到这一点的任何想法。我在 SPLIT 函数上做了几次尝试，使用类似的东西

```
array = Split(objTextFile.Readline , ";") 
```

但无济于事。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-12T19:01:09.953

```
array = Split(objTextFile.ReadAll(), ";") 
```

# c# - 在 DataGridView 中获取 ComboBox 的 DropDown 事件的最佳方法是什么

> ID：436560
> 
> 赞同：0
> 
> 时间：2009-01-12T18:58:22.003
> 
> 标签：c#, events, datagridview

假设我有一个 DataGridView，我在其中动态构建一个 ComboBox 列并向其添加值。当用户单击下拉按钮以显示下拉列表时，最好的陷印方法是什么。如果我只是在 DataGridView 上使用 CellClick，即使用户实际上没有单击下拉按钮，我也会收到该事件。

到目前为止，我所做的基本上是继承自 DataGridViewComboBoxCell 并覆盖了 DropDownWidthProperty。在 getter 中，我触发了 DropDown 事件。这有效，但感觉非常“hacky”。还有其他建议吗？

```
 using System;
    using System.Windows.Forms;

public class DataGridViewEventComboBoxCell : DataGridViewComboBoxCell
{
    private bool dropDownShown = false;
    public event EventHandler BeforeDropDownShown;

    private void OnBeforeDropDownShown()
    {
        if (this.BeforeDropDownShown != null)
        {
            this.BeforeDropDownShown(this, new EventArgs());
        }
    }

    public override int DropDownWidth
    {
        get
        {
            if (!dropDownShown) //this boolean is here because I only need to trap it the very first time
            {
                this.OnBeforeDropDownShown();
                dropDownShown = true;
            }
            return base.DropDownWidth;
        }
        set
        {
            base.DropDownWidth = value;
        }
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-12T19:06:28.150

试试 EditingControlShowing

# javascript - 如何在 Javascript 中连接 Excel 事件

> ID：436563
> 
> 赞同：7
> 
> 时间：2009-01-12T19:00:16.260
> 
> 标签：javascript, html, excel, activex

在客户端 Web 应用程序中，我想：

1.  打开 Excel 电子表格，
2.  将一些应用程序数据导出到 Excel，
3.  允许用户使用它，并且
4.  完成后，将（可能更改的）数据读回我的应用程序。

我希望用户拥有流畅的体验，并通过连接到 BeforeClose 事件来检测他们何时使用 excel 完成，但我发现我无法连接到 javascript/HTML 中的 Excel 事件。

```
function BeforeCloseEventHandler(cancel) {
    // TODO: read values from spreadsheet
    alert("Closing...");
}

function openExcel() {
    var excel = new ActiveXObject("Excel.Application");
    var workbook = excel.Workbooks.Add();
    var worksheet = workbook.Worksheets(1);
    worksheet.Cells(1, 1).Value = "First Cell";
    worksheet.Cells(1, 2).Value = "Second Cell";
    workbook.BeforeClose = BeforeCloseEventHandler;  // THIS DOESN'T WORK
    excel.Visible = true;
    excel.UserControl = true;
} 
```

有没有人有什么建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-13T21:04:21.670

`new ActiveXObject`在做了一些研究之后，我发现我无法在 javascript 中将事件连接到动态 ActiveX 对象（即由构造函数创建的对象）。

一个想法是，我创建了一个包装 Windows 窗体用户控件，该控件将托管在`<object>`Web 应用程序的标记内。用户控件将调用 Excel 并接收事件，并将事件返回到 javascript，我可以使用该`<script for="..." event="...">`机制来连接。不确定这是否可行，但我会尝试。

即使它确实有效，我对这个解决方案也不是特别满意。有太多层——javascript 是从 silverlight 控件调用的，这意味着我的数据必须跨越 3 个边界并返回：*Silverlight -> Javascript -> Hosted Winform User Control -> Excel*。

消除其中一些界限会很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-13T22:18:19.493

我认为您使用 IE 中托管的 Windows From 控件的第二种方法也行不通。

IE 作为脚本主机的行为有所不同。正如 Eric Lippert 的一篇博文中提到的那样，存在某些限制：

[实现事件处理，第二部分](http://blogs.msdn.com/ericlippert/archive/2005/09/21/472465.aspx)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-01-13T08:04:58.983

我不相信这是可能的。原因是，当您调用以下代码时：

```
var excel = new ActiveXObject("Excel.Application"); 
```

您实际上是在打开 Excel。因此，使用以下行：

```
workbook.BeforeClose = BeforeCloseEventHandler; 
```

就像您在告诉 Excel 应用程序运行 Javascript，这是不可能的。我尝试过研究替代方案，例如创建一个事件对象，定义其背后的代码，然后将其分配给 workbook.BeforeClose，但我会遇到同样的问题：javascript 无法检测到 Excel 事件。主要是因为它作为一个单独的进程运行。

因此，您可以考虑以下一些替代方案：

1.  将 Excel 数据保存在用户的计算机上，然后当用户丢失 Excel 时，让他们单击调用您的第一个方法的某个位置，该方法读取该文件并显示它。
2.  从excel文件中读取数据，然后显示。
3.  不要关闭您的 excel 对象（这可能会使 excel 在您的计算机上作为一个进程打开），并在 javascript 中有一个计时器事件。每 5 秒检查一次 Excel 是否仍然打开，如果没有打开，则读取文件并显示它。

抱歉，我无法再提供帮助了，我也不确定这些替代方案是否可行，但祝你好运！

# mysql - 由于 schema_migrations 的唯一约束，Rails 单元测试失败

> ID：436576
> 
> 赞同：0
> 
> 时间：2009-01-12T19:05:43.783
> 
> 标签：mysql, ruby-on-rails, ruby, testing, migration

我正在尝试跑步`rake test:units`，但我不断得到这个：

```
Mysql::Error: Duplicate entry '2147483647' for key 1: INSERT INTO `ts_schema_migrations` (version) VALUES ('20081008010000') 
```

“ `ts_`”在那里是因为我已经`ActiveRecord::Base.table_name_prefix`设置了。我很困惑，因为表中已经没有值“20081008010000”，并且没有值“2147483647”的迁移（尽管该值确实出现在表中）。

在 Rails 中`schema_statments.rb`，有以下内容：

```
def initialize_schema_migrations_table
  sm_table = ActiveRecord::Migrator.schema_migrations_table_name

    unless tables.detect { |t| t == sm_table }
      create_table(sm_table, :id => false) do |schema_migrations_table|
        schema_migrations_table.column :version, :string, :null => false
      end
      ... 
```

在我的开发数据库中，`ts_schema_migrations.version`是一个`VARCHAR`. 在测试中，虽然它是一个`INTEGER`. 我已经删除了表格并重新运行了迁移（和/或 a `rake db:schema:load RAILS_ENV=test`）几次。没有变化。

我的 MySQL 适配器有问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-12T20:31:55.637

看起来你的测试模式好像是 Rails 1.x，而开发是 Rails 2。也许你可以设置 RAILS_ENV 来测试和运行`rake db:reset`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-13T01:36:58.407

从 Rails 1.x 升级到 2.0 时，您似乎跳过了一些步骤。

浏览并阅读升级说明：

[http://www.slashdotdash.net/2007/12/03/rails-2-upgrade-notes/](http://www.slashdotdash.net/2007/12/03/rails-2-upgrade-notes/)

和发行说明：

[http://weblog.rubyonrails.org/2007/12/7/rails-2-0-it-s-done](http://weblog.rubyonrails.org/2007/12/7/rails-2-0-it-s-done)

他们会告诉您需要遵循的所有步骤。特别是重新生成所有脚本并将数据库迁移到新的数据库迁移系统，通过时间戳而不是递增迁移 id。

# jquery - jquery.data() 应该在 Greasemonkey 脚本中工作吗？

> ID：436577
> 
> 赞同：0
> 
> 时间：2009-01-12T19:05:46.670
> 
> 标签：jquery, greasemonkey

我在greasemonkey 用户脚本中使用jquery。我正在尝试将一堆选项添加到基于数组的选择中，并将相应的对象粘贴到带有 jquery.data 的元素中，如下所示：

```
$.each(some_array, function(item){
  // These next 2 statements seem awkward to me and I was also hoping 
  // a jquery master could show me a slicker way to perhaps 
  // combine them into something simpler
  $('select').append('<option>dummy</option>');
  $('select option:last-child').data('obj', item);
}); 
```

然后我想在选择时恢复对象：

```
$('select').change(function(){
   var theObj = $('option:selected', this).data('obj');
}); 
```

但是在我的greasemonkey 用户脚本中，theObj 是未定义的。我知道包装器，unsafeWindow 等有一些猴子生意。我只是希望有人可能知道究竟是什么让这不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-12T21:54:36.250

除非选择了页面上第一个选择框的最后一个选项，否则 theObj 应该是未定义的，因为数据仅添加到任何选择框上的所有最后一个选项，但会为页面上的第一个选择选项检索。

就像样式指南一样，您应该考虑更多地使用“this”。例如

```
$('select').change(function(){
   var theObj = $('select option:selected').data('obj');
}); 
```

应该：

```
$('select').change(function(){
   var theObj = $('option:selected',this).data('obj');
}); 
```

或者

```
$('select').change(function(){
   var theObj = $(this).find('option:selected').data('obj');
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T03:23:09.300

我发现让它工作所需的只是：

```
$.each(some_array, function(item){
 $('select').append('<option>dummy</option>');
 $('select option:last-child').each(function(index, elem){
    $(elem.wrappedJSObject).data('obj', item);
 });
});

$('select').change(function(){
  var theObj = $('option:selected', this.wrappedJSObject).data('obj');
}); 
```

这一切都与[XPCNativeWrappers 有关](http://wiki.greasespot.net/XPCNativeWrapper)。我不确定它在 jquery 代码中的哪个位置使用了不适用于这些包装器的代码（我看起来有点但不太难）。不过，这肯定会带来一个很大的安全问题，所以我不会把它放在任何重要的事情上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-13T18:56:12.303

我可能不太了解这个问题，但我会试一试。

您可以遍历一个数组，并在这样做时使用该对象。这是一个例子

```
var array_items = [0,1,2,3,4,5];
$.each(array_items, function(item) {
  $('select').append('<option>dummy</option>');
  $('select option:last-child').data('obj', item);
}); 
```

很难确切知道您的问题中的“列表”是什么。

# asp-classic - Request.Form 有时会返回复选框的值，有时则不会

> ID：436580
> 
> 赞同：3
> 
> 时间：2009-01-12T19:06:05.233
> 
> 标签：asp-classic

有人知道这有什么问题吗？我有一些经典的 ASP 代码来检查复选框的值，如下所示：

```
<!-- HTML page: page1.asp --->
<input id="useBilling" name="useBilling" value="Y" type="checkbox" /> 
```

在我的代码页中（我们称之为 page2.asp）：

```
' code

useBilling = Request.Form("useBilling")

' useBilling should be "Y" here

If useBilling = "Y" Then
    ' using billing info
Else
    ' not using billing info
End If 
```

问题是有时，即使我选中复选框，它也会将一个空字符串传递给 Request.Form 并且正在执行错误的代码。我已经放置了一些 Response.Write 调用来跟踪它（这是 VBScript，记住），有时它说值是“Y”，但后来当我检查条件中的值时，它是空的。

一直在绞尽脑汁想弄清楚为什么这不起作用，因为一切似乎都是正确的，只是 Request.Form 有时会获取值，有时不会，即使它已被检查。地狱，有时我会通过注释掉执行代码来测试它，它会说值为“Y”，然后当我取消注释执行代码时，它又神秘地空了。

**编辑：** 奇怪的是，如果我在条件中包含一个 Response.End 标记，它将按我的预期运行，但是当我删除 Response.End 它不再找到复选框的值（返回空），即使一分钟前（与Response.End 未注释）它输出一条测试消息，上面写着“好的，复选框已选中”。随着 Response.End 注释掉，它说“未选中复选框”。

我什至尝试输出复选框的值（如果选中它应该是“Y”，如果没有选中则什么都没有）。而且，如果条件包含 Response.End，它肯定会输出“Y”，如果我删除 Response.End，它是空的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-12T21:18:23.813

> 一直在绞尽脑汁想弄清楚为什么这不起作用，因为一切似乎都是正确的，只是 Request.Form 有时会获取值，有时不会，即使它已被检查。

不是直接的答案，但要完全清楚：如果未选中复选框，Request.Form("useBilling") 将*始终*返回空值。从您的“即使我选中复选框”的措辞中，我也不确定您是否期望在未选中该值时出现值。从你的代码，我想你明白了。

至于这个问题，尽管我使用 ASP 已有 10 多年了，但我从未见过这种情况（请杀了我。）这并不意味着你产生了幻觉，只是我没有看到它。有趣的！

我想知道您的 HTML（尤其是表单标签）是否格式错误。您是否有重叠标签或缺少结束表单标签或任何东西？

当事情行为不端时，我也非常好奇地看到 Request.Form 的输出，即：

```
If useBilling = "Y" Then
  Response.Write "Cool, it works!"
Else
  Response.Write "Something's weird. " & Request.Form
End If 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-01-12T21:20:01.843

这应该是正确的，如果您提交表单并且未选中复选框，则它的值应该是空字符串的值 - 如果选中它应该具有“on”的值

# jquery - jQuery UI 选项卡 - 自动高度

> ID：436587
> 
> 赞同：18
> 
> 时间：2009-01-12T19:08:30.160
> 
> 标签：jquery, jquery-ui, tabs, jquery-ui-tabs

在以前的版本中，`jQuery tabs`有一个选项可以自动将选项卡的高度设置为组中最高选项卡的高度，使用：

```
$('#container').tabs({ fxAutoHeight: true }); 
```

但是，这似乎不适用于`jQuery UI 1.5.3`.

这个选项被删除了吗？如果是这样，还有其他方法可以获得相同的功能吗？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-03-04T23:19:38.293

您所要做的就是设置一个最小高度。（我花了很长时间才找到答案......我希望它有所帮助！）。

这是我真正有效的代码：

```
$("#tabs").tabs().css({
   'min-height': '400px',
   'overflow': 'auto'
}); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-14T03:25:48.333

在 jQuery 1.9 中，使用`heightStyle`属性（[此处的文档](http://api.jqueryui.com/tabs/#option-heightStyle)）

```
$( ".selector" ).tabs({ heightStyle: "auto" }); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-12T20:05:41.667

阅读[文档](http://docs.jquery.com/UI/Tabs/tabs#options)后，该选项似乎不再可用。但是，复制此功能非常容易。

假设您的选项卡水平排列：

```
$("ul.tabs a").css('height', $("ul.tabs").height()); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-12T20:19:38.533

看起来它不再存在了，查看这个插件以获得相同的功能

[等高插件](http://www.cssnewbie.com/equalheights-jquery-plugin/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-09-22T22:19:29.347

gabriel 的例子给了我正确的线索，但我无法让它完全像那样工作。查看 jQuery 文档的[源代码示例](http://docs.jquery.com/UI/API/1.8/Tabs#source)时，您会看到 HTML 代码应该如下所示：

```
<div id="tabs">
   <ul>
       <li><a href="#fragment-1"><span>One</span></a></li>
       <li><a href="#fragment-2"><span>Two</span></a></li>
       <li><a href="#fragment-3"><span>Three</span></a></li>
   </ul>
   <div id="fragment-1">
       <p>First tab is active by default:</p>
       <pre><code>$('#example').tabs();</code></pre>
   </div>
   ...
</div> 
```

因为我有 3 个选项卡的内容相当静态，所以对我来说，将所有选项卡的高度设置为最高选项卡的高度就足够了，在我的例子中是 #fragment-1。

这是执行此操作的代码：

```
$("#tabs div.ui-tabs-panel").css('height', $("#fragment-1").height()); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-10-05T07:42:52.847

Giannis 的答案对于获得选项卡中的最高高度是正确的，但缺少实际应用该解决方案的代码。您需要添加一种方法来重新显示第一个选项卡（它将被代码消失）和一种设置每个内容区域高度的方法。

```
var height = 0;
//Get the highest height.
$("#tables .ui-widget-content").each(function(){
    $(this).removeClass('ui-tabs-hide');
    var oheight = height; //used to identify tab 0
    if(height < $(this).height())
    {
        height = $(this).height();
    }
    if(oheight != 0)
    {
        $(this).addClass('ui-tabs-hide');
    }
});
//Apply it to each one...
$("#tables .ui-widget-content").height(height); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-11-03T13:25:04.530

```
var biggestHeight = 0;
jQuery.each($(this).find(".ui-tabs-panel"),
            function (index, element) {      
                var needAppend = false;
                if ($(element).hasClass('ui-tabs-hide')) {
                    $(element).removeClass('ui-tabs-hide');
                    needAppend = true;
                }

                if ($(element).height() > biggestHeight)
                    biggestHeight = $(element).height();

                if (needAppend)
                    $(element).addClass('ui-tabs-hide');
            }); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-11-26T07:27:09.987

**将选项卡最小高度和调整大小属性设置为无...**

例子：

```
$("#tab").tabs().css({'resize':'none','min-height':'300px'}); 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-05-03T16:05:47.870

我只是在寻找这个解决方案，只有在您知道最小高度应该提前多高的情况下，设置最小高度才是好的。

相反，我进入 css 并更改 ui-tabs 类以添加“overflow:auto;” 如下

```
.ui-tabs { overflow: auto; position: relative; padding: .2em; zoom: 1; } 
```

这在 FF12 中对我有用……我还没有在其他人身上尝试过。如果这可行，您可能希望创建一个单独的类来保留库存功能和主题互换性等

顺便说一句-您可能需要动态调整大小的原因是，如果您从 Ajax 加载，但不使用选项卡加载器方法，而是使用另一个函数（他们的方法假设您的内容全部来自一个 url 资源，这可能还不够，具体取决于你的动态人口有多先进）。

高温高压

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-05-11T08:07:04.033

```
var height = 0;

$("#tabs .ui-widget-content").each(function(){
    $(this).removeClass('ui-tabs-hide');
        if(height < $(this).height())
            height = $(this).height();
    $(this).addClass('ui-tabs-hide');
}); 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-01-16T19:58:10.613

检查网址：

[http://api.jqueryui.com/tabs/#option-heightStyle](http://api.jqueryui.com/tabs/#option-heightStyle)

```
$("#tabs").tabs({ heightStyle: "fill" }); 
```

# java - JSF 多部分验证方案

> ID：436590
> 
> 赞同：1
> 
> 时间：2009-01-12T19:09:37.160
> 
> 标签：java, validation, forms, jsf, partial

在 JSF 中，是否可以使用 JSF 的验证框架（又名验证器、即时、必需等）来解决以下验证/更新场景？

```
+-- Form ----------------------------------------------------+
|                                                            |
| Field A: |____________|v|                                  |
| Field B: |____________|v|                                  |
| Field C: |____________|v| Button: [Update C using A and B] |
| Field D: |____________|v| Button: [Update D using B and C] |
|                                                            |
| More Fields: ...                                           |
|                                                            |
| Button : [Submit All]                                      |
+------------------------------------------------------------+ 
```

如果所有字段都是下拉菜单，并且按下 [Update C] 按钮只会使 A、B 和 C 生效，而不会验证其余字段，则按下 [Update D] 按钮只会使字段 B、C 和 D 生效并按下[全部提交] 按钮将导致所有字段验证。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-13T11:10:17.207

从技术上讲，是的，可以使用验证器/立即执行此操作。但是，它不会特别简单。

如果您添加验证器，*[使用 A 和 B 更新 C]*中的逻辑将仅在所有验证器都通过或其立即属性设置为 true 时运行。如果它的 immediate 属性已设置为 true，则按钮逻辑无法使用[getValue](http://java.sun.com/javaee/javaserverfaces/1.2/docs/api/javax/faces/component/ValueHolder.html#getValue())或组件绑定到的任何对象读取提交的组件值；它必须使用[getSubmittedValue](http://java.sun.com/javaee/javaserverfaces/1.2/docs/api/javax/faces/component/EditableValueHolder.html#getSubmittedValue())（一个坏主意）。

更好的方法是在所有控件都绑定到的托管 bean 中执行验证逻辑。您可以将验证逻辑放在按钮绑定的任何方法中。使用*[Submit All]*按钮将您的验证数据保存在您的数据库/持久性存储/其他中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-13T13:46:41.727

我通常使用 Ajax 做类似的事情，我会将我感兴趣的部分提交到服务器，在那里验证/处理，并将结果返回到页面。另一方面，它完全绕过了 JSF 和它的验证机制，所以我想这并不是最聪明/最佳的解决方案......

# objective-c - 在 obj-c 中是否可以获取属性的父实例？

> ID：436592
> 
> 赞同：0
> 
> 时间：2009-01-12T19:09:39.407
> 
> 标签：objective-c, runtime

我想知道在 obj-c 中是否可以从属性访问父实例，例如：

```
@interface AObject : NSObject {
}

-(void) sample{
 NSLog("%@", [[self parentInstance] Id]);
}

@interface DbObject : NSObject {
    NSInteger Id;
    AObject* ob;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-12T20:34:44.447

不是我知道的。您必须让 AObject 知道它的父级。如果您摆弄运行时，可能还有其他方法可以做到这一点，但让 AObject 需要父级更容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-12T20:18:35.617

我不完全确定你在问什么。您在寻找`super`关键字吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-12T20:38:53.657

不，超级是为了上课。

我要问的是如何获取父对象（例如在树中）。

但我认为这是不可能的......并且有必要将孩子与父母联系起来。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-12T20:51:22.807

您必须`AObject`了解`DbObject`，但您还应该访问`DbObject`使用选择器的属性。

```
@interface AObject : NSObject
{
    id father;
}
- (id) initWithFather:(id) theFather;
- (void) sample;
@end

@implementation AObject
- (id) initWithFather:(id) theFather
{
    father = theFather;
    return self;
}    

- (void) sample
{
    NSLog (@"%d", [father Id]);
}
@end

@interface DbObject : NSObject
{
    NSInteger Id;
}
- (id) initWithId:(NSInteger) anId;
- (NSInteger) Id;
@end

@implementation DbObject
- (id) initWithId:(NSInteger) anId;
{
    Id = anId;
    return self;
}

- (NSInteger) Id
{
    return Id;
}
@end

int main (int argc, char *argv[])
{
    DbObject *myDbObject = [[DbObject alloc] initWithId:5];
    AObject *myAObject = [[AObject alloc] initWithFather:myDbObject];

    [AObject sample];

    return 0;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-18T04:59:52.827

如果你真的想这样做，你可以重写 AObject 中的“retain”方法来查看当前堆栈并查找调用类的 ID。对不起，你必须调查如何做到这一点，我只知道你可以从其他研究中获得。

如果您真正想做的是有某种调试语句来告诉您谁拥有特定对象 - 您可以覆盖保留并设置断点或将有用的数据转储放在那里。

# jasper-reports - 如何设置页脚部分的可见性取决于它是主报表还是子报表

> ID：436597
> 
> 赞同：0
> 
> 时间：2009-01-12T19:10:27.457
> 
> 标签：jasper-reports, hide, footer, subreport

*当JasperReport*是子报表时，如何隐藏页脚部分？当它是主要报告时，它应该只显示页脚部分。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-12T19:47:26.633

Jasper Reports 使用他们所谓的 Print When 表达式（如果我没记错的话）。我已经有一段时间没有使用它了，但是报告的每个部分都有一个 print when 表达式，您可以放置​​一个语句来返回 true 或 false。所以它可以检查一个条件，然后决定显示或隐藏一个部分。每个子报表也有一个 print when 表达式。

当表达式通常采用以下格式时，我的打印输出：

```
( <THE CONDITION TO CHECK> ? Boolean.TRUE : Boolean.FALSE ) 
```

条件可以使用报表中列中的参数或值。它非常灵活。

有几个与 Jasper Reports 中的 PrintWhen Expressions 相关的非常相似的问题，它们也可能对您有所帮助：

[如何在 JasperReports 中使用 printWhenExpression](https://stackoverflow.com/questions/294989/how-to-use-print-when-expression-in-jasper)

[子报表的包含和排除 (iReport-JasperReports)](https://stackoverflow.com/questions/370454/inclusion-and-exclusion-of-subreports-ireport-jasper)

# python - Python拆分字符串

> ID：436599
> 
> 赞同：13
> 
> 时间：2009-01-12T19:10:57.253
> 
> 标签：python, regex, parsing, split

假设我们有`Zaptoit:685158:zaptoit@hotmail.com`

你怎么分裂所以它只剩下`685158:zaptoit@hotmail.com`

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-12T19:15:09.770

```
>>> s = 'Zaptoit:685158:zaptoit@hotmail.com'
>>> s.split( ':', 1 )[1]
'685158:zaptoit@hotmail.com' 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-12T19:15:09.380

另一种解决方案：

```
s = 'Zaptoit:685158:zaptoit@hotmail.com'
s.split(':', 1)[1] 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-12T19:59:47.277

另一种方法，不使用拆分：

```
s = 'Zaptoit:685158:zaptoit@hotmail.com'
s[s.find(':')+1:] 
```

前任：

```
>>> s = 'Zaptoit:685158:zaptoit@hotmail.com'
>>> s[s.find(':')+1:]
'685158:zaptoit@hotmail.com' 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-01-09T18:07:31.543

从 Python 2.5 开始，有一个更直接的解决方案。如果找不到分隔符，它会很好地降级：

```
>>> s = 'Zaptoit:685158:zaptoit@hotmail.com'
>>> s.partition(':')
('Zaptoit', ':', '685158:zaptoit@hotmail.com')

>>> s.partition(':')[2]
'685158:zaptoit@hotmail.com'

>>> s.partition(';')
('Zaptoit:685158:zaptoit@hotmail.com', '', '') 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-12-14T15:58:26.447

以下拆分字符串，忽略第一个元素并重新加入其余元素：

```
":".join(x.split(":")[1:]) 
```

输出：

```
'685158:zaptoit@hotmail.com' 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-12T19:58:45.407

```
s = re.sub('^.*?:', '', s) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-01-10T12:41:59.460

使用方法 str.split()，maxsplit 参数的值为 1。

```
mailID = 'Zaptoit:685158:zaptoit@hotmail.com' 
mailID.split(':', 1)[1] 
```

希望它有所帮助。

# vb.net - VB.NET：如何引用 VB.NET 模块？

> ID：436605
> 
> 赞同：20
> 
> 时间：2009-01-12T19:13:35.203
> 
> 标签：vb.net

我有一个实用程序模块，因为[VB.NET](http://en.wikipedia.org/wiki/Visual_Basic_.NET)没有像 C# 这样的静态类，而 Module 是 VB.NET 中的静态类。我使用模块的原因是因为我使用的是扩展方法，它只能在模块中使用。

我不能引用这个模块，但是如果我把我的代码放在一个类中。我可以毫无问题地参考它。可能是什么原因？我错过了 C#。

编辑：该模块位于类库调用实用程序中。

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2009-01-12T19:45:54.840

您需要将该模块标记为公共模块。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-12T19:18:56.813

> 我不能引用这个模块，但如果我把我的代码放在一个类中。我可以毫无问题地参考它。有谁知道为什么？

因为 VB 中的模块不是类，不能用于实例化对象。相反，它们类似于命名空间，不同之处在于命名空间不能直接包含函数。因此，模块的原因是提供一种对不属于类的函数进行逻辑分组的方法。

当您考虑到并非所有东西在逻辑上都属于一个类时，这很有意义。考虑`System.Math`。除了奇怪的 OOP 纯粹主义之外，绝对没有理由将它作为一个类。

顺便说一句，你也不能在 C# 中引用静态类，至少如果我正确理解你所说的“引用”是什么意思的话。也许你可以澄清这一点。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-13T07:12:52.893

.NET 编译器可以采用任何类型的语言语法并将其转换为 .NET 等效项。有时有一对一的对应关系，有时则没有。

通过使用[.NET Reflector](http://en.wikipedia.org/wiki/.NET_Reflector)，您可以看到编译器真正在做什么。

在[VB.NET](http://en.wikipedia.org/wiki/Visual_Basic_.NET)中，该模块的存在是因为继承自 Visual BASIC 和部分来自 Microsoft BASIC 的传统。

VB.NET 编译器将采用这个

```
Public Module CoreModule
    Dim R As New System.Random(CInt(Microsoft.VisualBasic.Timer))
    Public Function D(ByVal Roll As Integer) As Integer
        Return R.Next(0, Roll) + 1
    End Function

    Public Function _1D6() As Integer
        Return D(6)
    End Function

    Public Function _2D6() As Integer
        Return D(6) + D(6)
    End Function

    Public Function _3D6() As Integer
        Return D(6) + D(6) + D(6)
    End Function

    Public Function _4D6() As Integer
        Return D(6) + D(6) + D(6) + D(6)
    End Function

    Public Function CRLF() As String
        Return Microsoft.VisualBasic.ControlChars.CrLf
    End Function
End Module 
```

并把它变成这个（为简洁起见省略代码）

```
Public NotInheritable Class CoreModule
    ' Methods
    Shared Sub New()
    Public Shared Function _1D6() As Integer
    Public Shared Function _2D6() As Integer
    Public Shared Function _3D6() As Integer
    Public Shared Function _4D6() As Integer
    Public Shared Function CRLF() As String
    Public Shared Function D(ByVal Roll As Integer) As Integer

    ' Fields
    Private Shared R As Random
End Class 
```

在 C# 中，等价于这个

```
public sealed class CoreModule
{
    // Fields
    private static Random R;

    // Methods
    static CoreModule();
    public static int _1D6();
    public static int _2D6();
    public static int _3D6();
    public static int _4D6();
    public static string CRLF();
    public static int D(int Roll);
} 
```

重要的是发出的[CIL](http://en.wikipedia.org/wiki/Common_Intermediate_Language)正确地完成了工作。

这种能力是为什么这么多老的 Visual BASIC 6 程序员对 MS 对语言的更改感到非常恼火的主要原因。例如关键字 Integer 发出 Int32 而不是 Int16。

只要模块被声明为公共，模块就会暴露给引用原始程序集的其他程序集。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-12T19:19:14.163

也许方法/子不是公开的？我曾经遇到过这个问题，它允许访问您班级中的本地代码，但如果它在您的班级之外并标记为“私人”，则不允许。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-12T19:35:15.830

```
Imports System.Web
Imports System.Web.UI

Module ResponseHelper

    <System.Runtime.CompilerServices.Extension()> _
    Public Sub Redirect(ByVal response As Net.HttpWebResponse, _
                        ByVal url As String, ByVal target As String, _
                        ByVal windowFeatures As String)

        If String.IsNullOrEmpty(target) Or _
           target.Equals("_self", StringComparison.OrdinalIgnoreCase) And _
           String.IsNullOrEmpty(windowFeatures) Then
            response.Redirect(url, target, windowFeatures)
        Else
            Dim page As Page = CType(HttpContext.Current.Handler, Page)
            If page Is Nothing Then
                Throw New InvalidOperationException("Cannot redirect to new window outside Page context.")
            End If
            url = page.ResolveClientUrl(url)
            Dim script As String
            If String.IsNullOrEmpty(windowFeatures) Then
                script = "window.open(""{0}"", ""{1}"", ""{2}"";"
            Else
                script = "window.open(""{0}"", ""{1}"");"
            End If
            script = String.Format(script, url, target, windowFeatures)
            ScriptManager.RegisterStartupScript(page, GetType(Page), "Redirect", script, True)

        End If
    End Sub

End Module 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-01-12T19:33:24.540

我不明白你在问什么。

VB.NET*确实*有静态类，就像在 C# 中一样，因为在 VB.NET 中`Module` ***a***是`static class`. 他们是一样的。你可以用一个静态类做的任何事情，你都可以用一个模块来做。也许您没有正确标记您的公共/私人/受保护的访问权限？

# javascript - 你能等待javascript回调吗？

> ID：436608
> 
> 赞同：22
> 
> 时间：2009-01-12T19:13:55.000
> 
> 标签：javascript, jquery, dialog, callback, confirm

我正在尝试使用来自[http://abeautifulsite.net/notebook/87](http://abeautifulsite.net/notebook/87)的 jQuery 警报对话框库，而不是默认警报（在我看来这看起来很糟糕）。这似乎是一个很棒的库，但是没有关于如何使用 jConfirm 库的示例。

我需要做这样的事情：

```
function confirm() {
        var result = false;
        var response = false;
        jConfirm('are you sure?', 'Confirmation Dialog',
          function(r) {
            result = r;
            response = true;
            return r;
        });
        if (response == true) {
            alert(result);
            return result;
        }
        else {
            //wait for response
            alert('hi');
        }
    } 
```

和我的 .net 按钮呼叫：

我已经在插件的网站上发表了评论（就在今天早上），谷歌搜索了 javascript 并等待回调完成但没有结果。

在其余的javascript执行之前，关于如何正确使用回调来获得结果的任何想法？

谢谢。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-01-12T22:10:30.103

您刚刚在 JavaScript 中遇到了一个很大的限制。一旦您的代码进入异步世界，就无法回到经典的过程执行流程。

在您的示例中，解决方案是循环等待响应被填充。问题是 JavaScript 没有提供任何指令，可以让你在不占用 100% 处理能力的情况下无限循环。因此，您最终会阻止浏览器，有时甚至会导致用户无法回答实际问题。

这里唯一的解决方案是坚持异步模型并保持它。我的建议是你应该为任何必须做一些异步工作的函数添加一个回调，这样调用者就可以在你的函数结束时执行一些东西。

```
function confirm(fnCallback) 
{
    jConfirm('are you sure?', 'Confirmation Dialog', function(r) 
    {
        // Do something with r 

        fnCallback && fnCallback(r); // call the callback if provided
    });
}

// in the caller

alert('begin');

confirm(function(r)
{
    alert(r);

    alert('end');
}) 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-01-12T21:41:30.177

```
jConfirm('are you sure?', 'Confirmation Dialog',
    function(r) {
        result = r;
        response = true;
        return r;
    }
);
if (response == true) { 
```

这暴露了对使用异步代码发生的事件顺序的误解。仅仅因为您已经将它内联并不意味着它将严格自上而下地执行。

1.  jConfirm 被调用，接收一个函数作为它的参数之一，它记住了。
2.  jConfirm 在页面上显示其 UI 并立即返回。
3.  'if (response==true)' 行执行。真的这应该只是读'if（response）'，布尔比较是多余的。但无论如何，响应当然是错误的。您的函数放弃并退出，将控制权交还给浏览器。
4.  用户单击 jConfirm 的 UI。
5.  jConfirm 只是现在才开始行动并回调你给它的函数，它之前记得。
6.  您的嵌套函数将响应设置为 true，对于 'if (response==true)' 条件来说已经太迟了，无法对其进行任何操作。

您已经编写了“//wait for response”作为替代方案，但是没有您可以编写的 JavaScript 代码可以真正做到这一点。您的函数必须返回以将控制权交还给浏览器，然后浏览器才能在 jConfirm UI 上触发使处理继续进行的单击事件。

存在使异步代码在同步上下文中工作（反之亦然）的方法 - 特别是线程和协程（以及它们有限的关系生成器）。但是 JavaScript 没有这些特性，因此您必须编写代码以适应您的库正在使用的同步或异步模型。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-12T19:36:57.450

由于回调是异步的（至少在等待用户做某事的意义上），在回调中处理您需要的内容可能更容易：

```
function confirm() {
    jConfirm('are you sure?', 'Confirmation Dialog', function(r) {
        if (r) doSomething();
    });
} 
```

* * *

@klogan [评论]

我假设你从[这里](http://abeautifulsite.net/notebook/87)得到这些？

该页面为您提供答案：（在**Usage**下查看）

> *这些方法不返回与confirm() 和prompt() 相同的值。您必须使用回调函数访问结果值。（有关更多详细信息，请参阅演示。）*

* * *

@klogan

我想说的是，没有一种简单的方法可以实现你想要的。您正在尝试关联**过程**和**事件驱动的**编程——JavaScript 无法帮助您做到这一点。

~~*最简单（尽管***有风险***）的解决方案是使用伪无限循环。但是，如果`callback`永远不会被调用，那么您现在就有了一个实际的无限循环。而且，根据 JavaScript 引擎，您可能会终止浏览器的等待。*~~

要点：***您最好的选择是避免*** ~~这种~~ ***尝试将事件驱动强制转换为程序。***

```
function confirm() {
    var result = false;
    var response = false;

    jConfirm('are you sure?', 'Confirmation Dialog',
      function(r) {
        result = r;
        response = true;
    });

    while(!response) continue; // wait
    return result;
} 
```

 ** * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-12T19:50:07.470

从技术上讲，**是**的，但我不会在网站上这样做。

看看[Narrative JavaScript](http://neilmix.com/narrativejs/doc/index.html)，它基于[Narcissus](http://en.wikipedia.org/wiki/Narcissus_(JavaScript_engine))。

> Narrative JavaScript 是 JavaScript 语言的一个小扩展，它支持异步事件回调的阻塞功能。这使得异步代码具有令人耳目一新的可读性和可理解性。

[Selenium](http://seleniumhq.org/)使用这种技术。

* * *

## 更新

查看[JavaScript 链](http://web.archive.org/web/20090408072615/http://www.xucia.com/strands-doc/index.html)：

> JavaScript Strands 为 JavaScript 语言添加了协程和协作线程支持，以启用异步事件回调的阻塞功能。这使得使用异步操作的代码更加线性、可读和可管理。Strands 是基于 Neil Mix 编写的 Narrative JavaScript 构建的，并且大部分 Narrative JavaScript 都保留在 Strands 中，包括本文档的大部分内容。
> 
> 在 JavaScript 中，您的代码不能简单地等到事件触发 - 事件必须始终由单独的异步事件处理程序处理。有时这很好，但它经常迫使应该是一个简单的语句序列变成粗糙的扭曲。它还破坏了封装功能的能力，因为调用函数必须知道提供回调处理程序。Strands 提供了暂停和恢复执行线程的能力。执行可以在事件完成时暂停恢复。这允许您以封装实现的简单、线性、可读的代码编写难以阅读的异步事件处理。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-12T19:19:31.680

我会假设你必须抓住这样的回应。我认为你不需要回调。

```
function confirm() {
        var response = jConfirm('are you sure?', 'Confirmation Dialog');
        if (response) {
            alert(result);
        }
        else {
            //wait for response
            alert('hi');
        }
    } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-14T05:48:51.240

我想我已经想出了解决这个问题的可能方法。我正在阅读这篇文章： [http ://treasure4developer.wordpress.com/2008/06/23/calling-postback-event-from-javascript/](http://treasure4developer.wordpress.com/2008/06/23/calling-postback-event-from-javascript/)

基本上这个想法是你从javascript强制回发，起初我发现回发可以工作但不会调用我的按钮事件，但在阅读文章后我发现我可以检测它是否是javascript回发并调用处理方法

问候 DotnetShadow

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-10-11T18:15:51.387

大佬们怎么说的，没办法！但是......我们在我的国家（巴西）怎么说，le gambi：

我们可以做类似的事情：

```
<h:commandLink styleClass="linkValor xExcluir" value="x"  
                     onclick="if(confirmar('Confirmar excluir.','Deseja realmente excluir este registro?', this)) return true; else return false;"
                     action="#{mBeanPesquisarLinhas.excluir}"/> 
```

和javascript：

```
function confirmar(titulo, msg, elemento) { 

    if ($(elemento).attr('sim')) {      
        $(elemento).removeAttr('sim');      
        return true;
    } else if ($(elemento).attr('nao')) {       
        $(elemento).removeAttr('nao');      
        return false;
    } else {
        $("#dialog-confirm").html('<p>' + msg + '</p>').dialog({
            resizable : false,
            height : 200,
            modal : true,
            title : titulo,
            buttons : {
                "Sim" : function() {
                    $(this).dialog("close");
                    $(elemento).attr('sim', 'sim');
                    $(elemento).click();
                },
                "Não" : function() {
                    $(this).dialog("close");
                    $(elemento).attr('nao', 'nao');
                    $(elemento).click();
                }
            }
        });
    }

    return false;
} 
```

这是同样的问题，但使用 jquery-ui。

再见，我希望这可以帮助某人。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-01-10T10:11:12.337

这东西行得通。需要 jQuery。

```
function myconfirm(kyssa, elm, e){ // neG
    if(jQuery('#confirmquestion').data('result')){
        var V = jQuery('#confirmquestion').data('result');
        jQuery('#confirmquestion').remove(); 
        return V == 'Y' ? true : false;         
    }else if(!jQuery('#confirmquestion').length){
        jQuery('body').append('<div id="confirmquestion">'+
        '<h4>Kinnitus</h4>'+
        '<div id="kyssa">'+kyssa+'</div>'+
        '<center>'+
        '<button onclick="jQuery(\'#confirmquestion\').data(\'result\', \'Y\');">Jah</button>&nbsp;'+
        '<button onclick="jQuery(\'#confirmquestion\').data(\'result\', \'N\');">Ei</button></div>'+
        '</center>');
        jQuery('#confirmquestion button').click(function(){
            jQuery(elm).trigger(e.type);
        })
    }       
    return false;
}

onChange="if(myconfirm(\'Saada kiri: \'+jQuery(this).find(\'option:selected\').html()+\' ?\', this, event)) { ... }" 
```

CSS

```
#confirmquestion{
    border:1px solid #999;
    background:white;
    padding-bottom: 30px;
    position:fixed;
    width:300px;
    font-size:12px;
    top:45%;
    left:50%;
    margin-left:-150px;
}

#confirmquestion h4 {
    background:blue;
    color:white;
    margin:0;
    padding: 2px 5px;
    border-bottom:#777; 
    text-align:center;
}

#confirmquestion #kyssa {
    padding: 30px 25px;
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-03-08T04:11:49.857

将回调视为发送消息，它将在您的代码中产生更好的结构。

# html - 什么时候应该使用 HTML 实体？

> ID：436615
> 
> 赞同：128
> 
> 时间：2009-01-12T19:15:19.303
> 
> 标签：html, xhtml, html-entities

这让我困惑了一段时间。随着 UTF-8 作为 Web 开发中事实上的标准的出现，我不确定在哪些情况下我应该使用 HTML 实体，哪些情况下我应该只使用 UTF-8 字符。例如，

*   破折号 (–, `&emdash;`)
*   与号 (&, `&amp;`)
*   3/4 分数 (¾, `&frac34;`)

请务必阐明这个问题。将不胜感激。

* * *

## 回答 #1

> 赞同：123
> 
> 时间：2009-01-12T19:19:28.623

* * *

## 回答 #2

> 赞同：87
> 
> 时间：2009-01-12T19:47:43.933

You don't generally need to use HTML character entities if your editor supports Unicode. Entities can be useful when:

*   Your keyboard does not support the character you need to type. For example, many keyboards do not have em-dash or the copyright symbol.
*   Your editor does not support Unicode (very common some years ago, but probably not today).
*   You want to make it explicit in the source what is happening. For example, the `&nbsp;` code is clearer than the corresponding white space character.
*   You need to escape HTML special characters like `<`, `&`, or `"`.

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-12T19:24:25.587

Entities may buy you some compatibility with brain-dead clients that don't understand encodings correctly. I don't believe that includes any current browsers, but you never know what other kinds of programs might be hitting you up.

More useful, though, is that HTML entities protect you from your own errors: if you misconfigure something on the server and you end up serving a page with an HTTP header that says it's `ISO-8859-1` and a `META` tag that says it's `UTF-8`, at least your &mdash;es will always work.

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-12T20:12:13.493

I would not use UTF-8 for characters that are easily confused visually. For example, it is difficult to distinguish an emdash from a minus, or especially a non-breaking space from a space. For these characters, definitely use entities.

For characters that are easily understood visually (such as the chinese examples above), go ahead and use UTF-8 if you like.

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-02-01T17:41:39.843

Personally I do everything in utf-8 since a long time, however, in an html page, you always need to convert ampersands (&), greater than (>) and lesser then (<) characters to their equivalent entities, &amp;, &gt; and &lt;

Also, if you intend on doing some programming using utf-8 text, there are a few thing to watch for.

*   XML needs some extra lines to validate when using entities.
*   Some libraries do not play along nice with utf-8\. For instance, PHP in some Linux distributions dropped full support for utf-8 in their regular expression libraries.
*   It is harder to limit the number of characters in a text that uses html entities, because a single entity uses many characters. Also there's always the risk of cutting the entity in half.

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-01-12T20:23:52.533

HTML entities are useful when you want to generate content that is going to be included (dynamically) into pages with (several) different encodings. For example, we have white label content that is included both into ISO-8859-1 and UTF-8 encoded web pages...

If character set conversion from/to UTF-8 wasn't such a big unreliable mess (you always stumble over some characters and some tools that don't convert properly), standardizing on UTF-8 would be the way to go.

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-12T19:19:57.593

If your pages are correctly encoded in utf-8 you should have no need for html entities, just use the characters you want directly.

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-12T20:17:42.623

All of the previous answers make sense to me.

In addition: It mostly depends on the editor you intent to use and the document language. As a minimum requirement for the editor is that it supports the document language. That means, that if your text is in japanese, beware of using an editor which does not show them (i.e. no entities for the document itself). If its english, you can even use an old vim-like editor and use entities only for the relative seldom &copy; and friends. Of course: &gt; for > and other HTML-specials still need escapes. But even with the other latin-1 languages (german, french etc.) writing ä is a pain in you know where...

In addition, I personally write entities for invisible characters and those which are looking similar to standard-ascii and are therefore easily confused. For example, there is u1173 (looking like a dash in some charsets) or u1175, which looks like the vertical bar. I'd use entities for those in any case.

# c++ - 快速而肮脏的操作员！=

> ID：436622
> 
> 赞同：6
> 
> 时间：2009-01-12T19:16:16.943
> 
> 标签：c++, operator-overloading

在我的课堂上，我经常`operator!=`通过返回来快速写一篇文章`!(*this == rhs)`，例如：

```
class Foo
{
private:
    int n_;
    std::string str_;
public:
    ...
    bool operator==(const Foo& rhs) const
    {
        return n_ == rhs.n_ && str_ == rhs.str_;
    }

    bool operator!=(const Foo& rhs) const
    {
        return !(*this == rhs);
    }
}; 
```

我看不出这样做有任何明显的问题，但我想我会问是否有人知道。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-12T19:20:35.517

我相信这是实现的首选方法，`operator!=`这样您就不会重复自己，并且您与`operator==`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-12T20:03:36.880

定义`operator!=`为`!operator==`就好了

为了轻松定义这些琐碎的等效运算符，我总是使用[Boost.Operators](http://www.boost.org/doc/libs/1_37_0/libs/utility/operators.htm)。
仅使用`operator==`and的情况`operator!=`（即使用[equal_comparable<>](http://www.boost.org/doc/libs/1_37_0/libs/utility/operators.htm#equality_comparable2)）并没有太大的收获。

但是当你需要小于和大于，或者一些组合等时`operator+`，`operator*`这变得非常方便。

你的案例的一个例子是

```
class Foo : private boost::equality_comparable< Foo >
{
   private:
     int n_;
     std::string str_;
   public:
     ...
   bool operator==(const Foo& rhs) const
   {
      return n_ == rhs.n_ && str_ == rhs.str_;
   }

}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-12T19:20:05.737

不，那绝对没问题——我也是这么做的。

# winforms - 线程列表框 C# SharpDevelop

> ID：436627
> 
> 赞同：1
> 
> 时间：2009-01-12T19:18:19.017
> 
> 标签：winforms, multithreading, listbox

我正在尝试在简单的 winform 中使用线程。我有一个 ListBox，我想在表单的加载方法中填充数字。我不想等到它被填满。我正在使用这样的东西：

```
void fillList()
        {

            Invoke(new MethodInvoker(
                delegate
                {
                    while(true)
                    {
                        i++;
                        listBox1.Items.Add(i);
                        if(i == 4000)
                        break;

                    }       
                }));

        } 
```

然后在 Load 方法中我这样做：

```
Thread tr = new Thread(fillList());
tr.Start(); 
```

为什么它不起作用？

我收到此错误：预期方法名称（CS0149）

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-12T19:28:12.927

如果您从表单加载中调用它，Invoke 只会在 UI 线程上运行上述内容，因此在填充列表时您的 UI 仍将被暂停。

在上面的示例中，您可能不需要新线程，只需创建一个数组，填充它，然后执行 AddRange 而不是 Add。

Add 每次都会导致刷新，这就是减慢负载的原因。使用 AddRange，刷新只会发生一次。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-12T19:20:24.347

```
 Thread tr = new Thread(fillList); 
```

# javascript - 如何删除：悬停？

> ID：436629
> 
> 赞同：28
> 
> 时间：2009-01-12T19:18:46.550
> 
> 标签：javascript, jquery

我的脚本有一个小问题。
我想为`:hover`禁用 Javascript 的客户端设置一个默认操作，但对于启用了 Javascript 的客户端，我想要另一个操作（实际上......相同的操作，但我想添加一个小的过渡效果）。

所以......我该怎么做？我正在使用 jQuery。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-01-12T19:23:31.220

将两个类应用于相关元素。一个包含悬停行为，一个包含所有其他样式。

然后你可以使用jquery

```
$(element).removeClass('hover'); 
```

方法来删除具有悬停行为的类，然后应用您想要使用的任何内容

```
$(element).bind('mouseover', function () { doSomething(); });
$(element).bind('mouseout', function () { doSomething(); }); 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-01-13T12:44:03.693

如何将`:hover`回退放在仅在禁用 javascript 时才加载的样式表中？

```
<noscript>
  <link href="noscript.css" rel="stylesheet" type="text/css" />
</noscript> 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2010-07-18T15:52:12.100

这是一个没有 hack 类的解决方案：

CSS：

```
a {color: blue;}
a:hover {color: red;} 
```

jQuery（使用[jQueryUI](http://jqueryui.com/)动画颜色）：

```
$('a').hover( 
  function() {
    $(this)
      .css('color','blue')
      .animate({'color': 'red'}, 400);
  },
  function() {
    $(this)
      .animate({'color': 'blue'}, 400);
  }
); 
```

[演示](http://jsbin.com/udahe3/2/edit)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-12T19:23:48.817

我认为最好的方法是将`:hover`行为作为非 javascript 用户的后备，然后使用 JQuery 创建 mouseover 和 mouseout 事件处理程序，为启用 javascript 的用户创建不同的效果。

[JQuery Javascript 库 - 事件/鼠标悬停](http://docs.jquery.com/Events/mouseover)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-05-22T12:41:36.380

这是一个非常古老的问题，但我很想告诉 Modernizr 提供了一种非常好的方法来实现这些回退。

只需在头部包含modernizr，您就可以执行以下操作：

```
.no-js a:hover {
   set background color and stuff like that
   for cases when no javascript is present
} 
```

另一方面，如果您想以另一种方式执行此操作，并且仅在存在 js 时设置 css

```
.js a:hover {
   set background color to default
   and the text decoration
} 
```

它或多或少与向标记添加悬停标签的解决方案相同，但更健壮一些。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-02-18T06:12:20.687

**我找到了你的解决方案**

基本上，您首先要重新定义您对 CSS 悬停所做​​的操作。（当然，您可以通过从样式中动态提取信息来做到这一点）然后在 jquery 中使用 mouseover/mouseout 事件做任何您想做的事情

这允许您将 :hover 事件保留在您的 css 中，因为 jquery 将您的原始样式绑定到元素。本质上禁用 :hover 事件。

**如果你的 CSS 是：**

```
a.class {
  background-color: #000000;
  background-position: 0 0;
  }
a.class:hover {
  background-color: #ffffff;
  background-position: 100% -50px;
  } 
```

**你的 jquery 会是这样的：**

```
jQuery("a.class").each(function () {

  var oldBackgroundColor = jQuery(this).css("backgroundColor");
  var oldBackgroundPosition = jQuery(this).css("backgroundPosition");

  jQuery(".class").css({
        'backgroundColor':oldBackgroundColor,
        'backgroundPosition':oldBackgroundPosition
  });

})
.bind("mouseover", function() {

  doSomething();

})
.bind("mouseout", function() {

  doSomething();

}) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-02-18T08:39:34.963

您可以使用单个 css 规则全局启用整个文档的行为，然后在安装新事件处理程序时在 javascript 的一个语句中禁用该规则。

将一个类添加到您的 html 正文标记中：

```
<html>
  <body class="use-hover">
  ... 
```

您的 CSS 中的默认行为，让我们说悬停时的粗体链接：

```
body.use-hover a:hover
  font-weight: bold 
```

在您的 js 中，运行时将删除默认行为并执行其他操作：

```
$(function() {
  $('body').removeClass('use-hover');
  $('a').live('mouseover', function() {
    // Do something when hovered
  }).live('mouseout', function() {
    // Do something after hover is lost
  });
}); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-11-05T10:52:26.923

您可以从 document.styleSheets 中删除所有 :hover 样式规则。

只需使用 JavaScript 浏览所有 CSS 样式并删除所有在其选择器中包含 ":hover" 的规则。当我需要从引导程序 2 中删除 :hover 样式时，我使用此方法。

```
_.each(document.styleSheets, function (sheet) { 
    var rulesToLoose = []; 
    _.each(sheet.cssRules, function (rule, index) { 
        if (rule.selectorText && rule.selectorText.indexOf(':hover') > 0) { 
            rulesToLoose.push(index);
        }
    });

    _.each(rulesToLoose.reverse(), function (index) {
        if (sheet.deleteRule) {
            sheet.deleteRule(index);
        } else if (sheet.removeRule) {
            sheet.removeRule(index);
        }
    });
}); 
```

我确实使用下划线来迭代数组，但也可以用纯 js 循环编写那些：

```
for (var i = 0; i < document.styleSheets.length; i++) {} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-12-28T08:03:02.833

```
You can redraw element after click
function redraw(element) {
if (!element) { return; }

let n = document.createTextNode(' ');
let disp = element.style.display;  // don't worry about previous display style

element.appendChild(n);
element.style.display = 'none';

setTimeout(function(){
    element.style.display = disp;
    n.parentNode.removeChild(n);
}, 100); // you can play with this timeout to make it as short as possible 
```

}

# multithreading - Delphi IDE 在调试线程时挂起

> ID：436648
> 
> 赞同：3
> 
> 时间：2009-01-12T19:21:28.290
> 
> 标签：multithreading, delphi, debugging

[这是对此](https://stackoverflow.com/questions/436524/keep-app-responsive-during-long-task)的后续问题。当我在 Delphi（BDS 2006 更新 2）中调试线程时，我的 IDE 经常挂起，例如当执行运行到我在应用程序启动**后**设置的断点时。

你有类似的经历吗？你怎么办？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-12T20:08:13.377

已经有关于 D2009 之前版本的报告 = 我记得 BCB2006 遭受过这种情况。

解决方法 - IIRC - 是删除“局部变量”调试窗口。

> 报告编号：30653（RAID：239655）
> 状态：关闭调试器导致 IDE 锁定
> 
> [http://qc.codegear.com/wc/qcmain.aspx?d=30653](http://qc.codegear.com/wc/qcmain.aspx?d=30653)
> 
> qcwin:DEFECT_NO=30653

# c# - 在 XP 上使用多播的 C# SocketException

> ID：436659
> 
> 赞同：5
> 
> 时间：2009-01-12T19:25:09.017
> 
> 标签：c#, sockets, multicast

以下 C# 代码在 Vista 上正常工作，但在 XP 上失败：

SocketException：提供了无效的参数。

错误代码为 10022。

XP 上的防火墙已被禁用。

```
using System;
using System.Net;
using System.Net.Sockets;

public class SocketTest
{
    [STAThread]
    public static void Main()
    {
        MySocket s = new MySocket();

        Console.WriteLine("done");
        Console.ReadLine();
    }

    public class MySocket : Socket
    {
        public const ushort SocketTtl = 4;
        public const string Address = "239.255.255.250";

        public IPAddress IPAddress = IPAddress.Parse(Address);

        public MySocket()
            : base(AddressFamily.InterNetwork, SocketType.Dgram, ProtocolType.Udp)
        {
            SetSocketOption(SocketOptionLevel.Socket, SocketOptionName.Broadcast, true);
            SetSocketOption(SocketOptionLevel.IP, SocketOptionName.MulticastTimeToLive, SocketTtl);

            // This line throws SocketException: An invalid argument was supplied
            // SocketException.ErrorCode: 10022
            SetSocketOption(SocketOptionLevel.IP, SocketOptionName.AddMembership, new MulticastOption(IPAddress));
        }
    }
} 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-12T20:48:16.633

在设置 SocketOptionName.AddMembership 选项之前，您需要将套接字绑定到接口。

编辑：刚刚在 MSDN 文档中验证了这一点（尽管它只说最高 NT4）：

> Windows 98、Windows NT 4.0 平台 注意：在使用 AddMembership 作为 optionName 参数之前，您必须调用 Bind 方法。

# css - CSS 列在所有地方重叠，但 IE 和 Firefox 3

> ID：436661
> 
> 赞同：2
> 
> 时间：2009-01-12T19:25:58.767
> 
> 标签：css, cross-browser

我的网站及其在某些浏览器中的显示方式存在问题：

> [http://www.karentiede.com](http://www.karentiede.com)

在 Firefox 2.0 和许多其他浏览器中，“内容”列向左溢出并出现在装饰边框的顶部，使某些内容无法阅读。

这里的一个问答表明，使所有页面都`HTML 4.01 Strict DOCTYPE`可以帮助使所有浏览器工作相同，但这个问题在 Firefox 中是相反的，在 IE 中不起作用。我应该尝试另一个/不同的修复吗？

来自CSS：

```
.column2 {
    float: right;
width: 80%;
} 
```

从任何起作用的页面：

```
<body id="schedule_toc">
<div id="col1_schedule_toc">
<div class="column2"> 
```

[当我在http://www.browsershots.org](http://www.browsershots.org)查看该站点时，在许多浏览器中的初始显示看起来很糟糕。我有一个或三个（可能是 Firefox）读者告诉我他们看不到文本，我怀疑他们可能是比我是 CSS 编写者更老练的用户。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-12T19:54:52.967

我看了一下页面，只有在重新调整页面大小时才会出现问题。

问题是你的右 div 是 80%，所以当屏幕变小并且比率发生变化时，80% 就会重叠到你的左背景中。

查看[http://www.dynamicdrive.com/style/layouts/item/css-liquid-layout-21-fixed-fluid/](http://www.dynamicdrive.com/style/layouts/item/css-liquid-layout-21-fixed-fluid/)了解如何设置“静态流体”布局。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-12T20:39:33.033

发生这种情况的原因似乎是因为图像（向左浮动）不是整个页面的高度。因此，当页面的宽度不足以容纳相邻的图像和文本时，文本会中断到下一个可用的空白处。

**尝试将两个**元素都向左浮动，并将与“装饰”列的宽度相等的左边距应用于 column2，如下所示：

```
.column1 { float: left; width: 125px; }
.column2 { float: left; margin-left: 125px; }
.clear { clear: both; } 
```

您需要在两个元素下方都有一个清除 div：

```
<div class="column1">...</div>
<div class="column2">...</div>
<div class="clear"></div> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-12T20:37:10.277

*正如savageguy*所指出的，问题肯定是比率。如果您想要的是一个固定宽度的左列和一个可变宽度的右（主）列，那么您可以使用它（未经测试，但应该可以）：

```
#col1_schedule_toc {
    width: 175px;
    float: left;
}

.column2 {
    float: right;
    width: 100%;
} 
```

编辑：顺便说一句，我注意到（至少在我查看的页面上）您在打开右侧之前也没有关闭左侧列，因此从技术上讲，右侧列在左侧内部，这将导致我建议的修复出现问题. 因此，您还需要移动 col 1 的关闭*div*，使其位于 col 2 的打开*div*上方。

*编辑 2：另外，正如Plan B*所指出的，您还需要在两个元素下方都有一个清除 div 以防止父（容器）div 折叠：

```
div.clear {
    clear: both;
    font-size: 1px;
    line-height: 1px;
    overflow: hidden;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-12T20:40:23.560

除了 savageguy 的正确建议之外，您在左侧页面（您的图片等）中的图像是固定宽度。这就是为什么当浏览器重新调整大小时，80% 突然变得太宽了。

在 column2 上，设置图像宽度的左边距 + 您想要的分隔量（例如，160 应该可以，但您可以使用它），然后将 column2 的宽度设为 100%（剩余宽度的) 应该防止你的重叠。

[编辑：B计划也提供了一个非常强大的解决方案。）

# javascript - Low Pro Prototype DOM Builder 可以在 IE 中使用吗？

> ID：436666
> 
> 赞同：2
> 
> 时间：2009-01-12T19:27:15.113
> 
> 标签：javascript, internet-explorer, prototypejs, unobtrusive-javascript

Dan Webb 对 Prototype 的[Low Pro](http://www.danwebb.net/2006/9/3/low-pro-unobtrusive-scripting-for-prototype) UJS 扩展提供了以下优雅的 DOM Builder：

```
var listItem = $li({ id : 'item-1' }, 
                 $strong("Some text")
               ); 
// returns a node equivalent to: <li id="item-1"><strong>Some text</strong></li>

$('a_list').appendChild(listItem); 
```

虽然这在 Firefox 和 Safari 中对我们来说就像做梦一样，但在 IE 6 和 IE7 中却令人欣喜若狂，并出现错误“对象不支持此属性或方法”

了解 Dan Webb 的 DOM Builder 可能会做什么来包装与 IE 不兼容的 Element.new 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T18:03:10.327

我想“对象不支持此属性或方法”错误来自对 Prototype 的扩展元素方法之一的调用（在 IE 中不会自动应用）。但是，您正在处理的所有元素都来自 LowPro 或 $() 函数，它们*应该*为您扩展元素。

你可以试试这个，看看它是否能解决问题：

```
var listItem = Element.extend($li({id: 'item-1'}, 
    Element.extend($strong("Some text"))
));

$('a_list').appendChild(listItem); 
```

如果这样可以解决问题，那么 LowPro 不会扩展元素，这很奇怪。如果没有，那么肯定有其他问题，您可以在某处发布演示页面吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-12T19:45:42.253

从 v1.6 开始，[Prototype](http://www.prototypejs.org/api/element)有一个内置的元素构造函数。语法与 Low Pro 略有不同。

```
$('a_list').insert(new Element("li", {id: 'item-1'})).update('some text').wrap('strong') 
```

# structuremap - Rhino.Commons 与 StructureMap

> ID：436667
> 
> 赞同：1
> 
> 时间：2009-01-12T19:28:04.783
> 
> 标签：structuremap, rhino-commons

有没有人尝试将 StructureMap 用于 IoC 和 Rhino.Commons？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-15T17:18:37.590

Windsor 深深植根于 Rhino Commons，在源代码中搜索“Windsor”会返回 45 个文件。例如，宾索是**温**莎特有的。**但是，重构 Rhino.Commons 的某些部分**以使用 CommonServiceLocator[代替](http://www.codeplex.com/CommonServiceLocator)Windsor应该不是很困难，有效地使其独立于容器提供程序。

您不太可能想要**所有**Rhino.Commons，所以我的问题是：您需要 Rhino.Commons 的哪些部分？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-14T19:44:31.533

查看源代码，我看不出它是怎么可能的。IoC.Initialize() 方法接受一个 IWindsorContainer。

# eclipse - 使用多台机器和版本控制进行开发的最佳实践

> ID：436669
> 
> 赞同：3
> 
> 时间：2009-01-12T19:28:14.610
> 
> 标签：eclipse, svn, version-control, development-environment

我刚刚开始练习版本控制（我想使用 Eclipse 和 SVN），我不确定我的场景的最佳设置。

我目前是一名孤独的开发人员，我有两台计算机（一台工作台式机和一台家庭办公室笔记本电脑），我喜欢用于开发（主要是基于 Web 的东西）。我可以访问基于 Linux 和基于 Windows 的远程服务器，而且根据我进行工作的位置，我似乎总是将文件分散在两台机器之间。

是否有任何关于如何设置开发环境的说明或最佳实践，以便当我坐在任何一台机器上时，我都可以使用相同的文件并能够利用版本控制？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-12T19:35:57.187

我在笔记本电脑/工作站/服务器之间使用过的一些东西。

*   如果暴露了路径，则创建一个本地 svn 存储库，然后使用从第二台机器到存储库的网络路径。如果您不想运行服务器而只想使用本地文件，则效果很好。我的笔记本电脑和工作站具有相同的凭据，因此通过隐藏路径 '\machine\c$\etc' 非常有效

*   我也喜欢使用 Unison 来管理我的笔记本电脑和工作站之间的文件。它不是版本控制，并且带有日期时间提示，它在“更新”方面做得相当好。此外，如果您是唯一一个同时使用两者的人，那么冲突非常低。我用它来管理我的“我的文件” [http://www.cis.upenn.edu/~bcpierce/unison/](http://www.cis.upenn.edu/~bcpierce/unison/)

*   当然，您可以创建一个 SVN 服务器，我发现 Visual SVN 使这几乎太容易了。在需要“启动”到服务器后，我开始将它用于我的个人项目。在远程服务器上安装 svn 服务器在启动和在家工作时有一些好处。（或邀请其他开发者） [http://visualsvn.com/server/](http://visualsvn.com/server/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T19:41:35.457

只需在您的一台计算机上安装 SVN（最好在 Linux 服务器上）。我猜管理员会为您安装 SVN 并创建所需的存储库。

通过插件将 SVN 与 Eclipse 集成非常容易。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-12T19:49:28.220

如果您不熟悉源代码控制（或者即使您不是），阅读[Eric Sink 的 Source Code HOWTO](http://www.ericsink.com/scm/source_control.html)将会很好地介绍并让您了解一些最佳实践。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-12T20:39:57.477

我会考虑分布式版本控制系统以及 Subversion。即使你最终选择了 Subversion，了解所有可用的选项也是很好的。就个人而言，我是一名开发人员，在多个地点工作，并且发现 DVCS 概念比 SVN 工作得更好。

Git、Mercurial 和 Bazaar 是三个选项。这是 Linux Torvalds 的[一个很好的视频](http://www.youtube.com/watch?v=4XpnKHJAok8)，它解释了一些概念上的差异。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-12T20:28:09.000

我正在实施 Bazaar 作为我的源代码控制解决方案来处理这种情况。我使用 Subversion 多年，但它根本不适合这种分布式使用场景。集市有。

# jquery - 本地 html 文件 AJAX 调用和 jQuery Woes

> ID：436670
> 
> 赞同：11
> 
> 时间：2009-01-12T19:28:24.360
> 
> 标签：jquery, xml, ajax, internet-explorer, offline

我正在使用 jQuery 和一些 xml 文件开发网站的离线版本。当我对 xml 文件执行 $.ajax 调用时，我在 jQuery 中遇到了一个问题，jQuery 会引发错误。

当我查看错误时，我可以告诉它正在加载 XML 文件，因为它在错误的 responseText 属性中。它在 Firefox 中似乎可以正常工作。

这就是我的电话的样子

```
$.ajax({
    type: "GET",
    url: "Modules/" + ModuleID + "/ModuleContent.xml",
    dataType: "xml",
    success: function(x) { xml = x; ProcessXML(); },
    error: function(x) { alert(x.responceText); }
}); 
```

当我在 Web 服务器上运行它时，它工作得很好。只有当我遇到这个问题时，我才从文件中运行它。

关于如何在 IE 中进行这项工作的任何想法？

编辑：我找到了我的问题的答案。[这里](http://docs.jquery.com/Specifying_the_Data_Type_for_AJAX_Requests)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-24T17:01:34.203

从OP 发布的带有答案的[链接中：](http://docs.jquery.com/Specifying_the_Data_Type_for_AJAX_Requests)

> 在本地加载 XML 文件时，例如 CD-ROM 等，Internet Explorer 接收到的数据是纯文本，而不是 text/xml。在这种情况下，使用 dataType 参数将 xml 文件加载为文本，并在 succes 函数内解析返回的数据

```
 $.ajax({
   url: "data.xml",
   dataType: ($.browser.msie) ? "text" : "xml",
   success: function(data){
     var xml;
     if (typeof data == "string") {
       xml = new ActiveXObject("Microsoft.XMLDOM");
       xml.async = false;
       xml.loadXML(data);
     } else {
       xml = data;
     }
     // Returned data available in object "xml"
   }
 }); 
```

这也对我有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-12T19:43:18.450

只是一个想法：我记得 IE 的一些 GET 请求失败。您是否尝试过发布它？

# c++ - 如何保证在 Visual Studio 2005 下的 C++ 中捕获 EXCEPTION_STACK_OVERFLOW 结构化异常？

> ID：436671
> 
> 赞同：6
> 
> 时间：2009-01-12T19:28:28.340
> 
> 标签：c++, debugging, exception-handling, stack-overflow, structured-exception

### 背景

*   我有一个带有*Poof-Crash* [ *1* ] 的应用程序。我相当肯定这是由于堆栈爆炸造成的。
*   该应用程序是多线程的。
*   我正在用“ `Enable C++ Exceptions: Yes With SEH Exceptions (/EHa)`”编译。
*   我写了一个 SE Translator 函数并`_set_se_translator()`用它调用。
*   我已经为 和 setup`set_terminate()`和`set_unexpected()`.
*   要获得 Stack Overflow，我必须在重负载下以发布模式运行几天。在调试器下运行不是一种选择，因为应用程序的执行速度不够快，无法达到查看问题所需的运行时间。
*   我可以通过在执行其中一个函数时添加无限递归来模拟问题，从而测试`EXCEPTION_STACK_OVERFLOW`异常的捕获。
*   我将 WinDBG 设置为故障转储程序，并获得有关所有其他崩溃问题的好信息，但**不是这个**。故障转储将仅包含一个线程，即“Sleep()”。所有其他线程都已退出。

### 问题

我尝试过的所有事情都没有导致出现`EXCEPTION_STACK_OVERFLOW`异常。

有谁知道如何保证在发布模式下运行时有机会遇到这个异常？

### 定义

1.  *Poof-Crash*：应用程序因“噗”而崩溃并消失得无影无踪。

*（考虑到这个网站的名称，我有点惊讶这个问题还没有出现在这里！）*

### 笔记

1.  简要发布了一个关于调整堆栈大小以可能更快地强制问题并允许使用调试器捕获它的答案。这是一个聪明的想法，但不幸的是，我不相信它会有所帮助。该问题可能是由导致无限递归的极端情况引起的。缩短堆栈不会很快暴露问题，并且可能会导致有效深度代码中的无关崩溃。好主意，感谢您发布它，即使您确实删除了它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-13T12:57:55.553

windows xp 之前的所有东西都不会（或者更难）通常能够捕获堆栈溢出。随着 xp 的出现，您可以设置[向量异常处理程序](http://msdn.microsoft.com/en-us/library/ms679274(VS.85).aspx)，该处理程序在任何基于堆栈（结构化异常）处理程序之前有机会发生堆栈溢出（这就是原因 - 结构化异常处理程序是基于堆栈的）。

但是，即使您能够捕获这样的异常，您也确实无能为力。

在[他的博客](http://blogs.msdn.com/cbrumme/)中，cbrumme（对不起，没有他/她的真名）讨论了一个与保护页面（产生堆栈溢出的页面）相邻的堆栈页面，该页面可能被用于回退。如果您可以压缩退出代码以仅使用一个堆栈页面 - 您可以尽可能多地释放您的逻辑。否则，应用程序在遇到堆栈溢出时几乎死机。捕获它后，唯一合理的做法是编写转储文件以供以后调试。

希望能帮助到你。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-14T00:03:34.617

我不相信您在将其诊断为堆栈溢出方面是正确的。

但无论如何，你得到一个*便便的事实！*，加上您在 WinDbg 中看到的内容

> 故障转储将仅包含一个线程，即“Sleep()”。所有其他线程都已退出。

向我建议有人调用了 C RTL exit() 函数，或者可能直接调用了 Windows API TerminateProcess()。这可能与您的中断处理程序有关。也许异常处理逻辑中的某些内容具有重新进入检查，并且在重新进入时任意决定 exit() 。

我的建议是修补您的可执行文件，以便在退出（）的入口点放置一个 INT 3 调试，如果它是静态链接的，或者如果它是动态链接的，则修补导入并修补 kernel32::TerminateProcess 的任何导入到改为抛出 DebugBreak() 。

当然，exit() 和/或 TerminateProcess() 也可以在正常关闭时调用，因此您必须过滤掉误报，但如果您可以获得调用堆栈以应对即将发生的情况去证明，你应该有你需要的。

编辑添加：只需编写自己的 exit() 版本并将其链接而不是 CRTL 版本就可以了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-12T20:27:10.203

我记得以前工作场所的代码听起来相似，对堆栈指针进行显式边界检查并手动抛出异常。

不过，自从我接触 C++ 以来已经有一段时间了，即使我接触了它，我也不知道自己在做什么，所以请注意实施者关于上述建议的可移植性/可靠性。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-12T23:30:05.683

您是否考虑过 Windows 调试工具中的[ADPlus ？](http://support.microsoft.com/kb/286350)

ADPlus 将 CDB 调试器附加到处于“崩溃”模式的进程，并将为进程生成的大多数异常生成崩溃转储。基本上，您运行“ADPlus -crash -p yourPIDhere”，它会执行侵入式附加并开始记录。

鉴于您上面关于在调试器下运行的评论，我只想补充一点，CDB 在体面的（双核，2GB RAM）机器上在 -crash 模式下增加了几乎为零的开销，所以不要让它阻碍你尝试它.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-12T20:34:22.480

您可以在不禁用优化的情况下生成调试符号。事实上，无论如何你都应该这样做。它只会使调试变得更加困难。

并且文档`_set_se_translator`说每个线程都有自己的 SE 翻译器。您是否为每个线程设置一个？

`set_unexpected`至少根据 VS 2005 文档，可能是无操作的。每个线程也有自己的`terminate`处理程序，因此您也应该为每个线程安装它。

我也强烈建议**不要**使用 SE 翻译。它需要您不应该忽略的**硬件**异常（即，您应该真正记录错误并终止）并将它们变成您可以忽略的东西（C++ 异常）。如果您想捕获此类错误，请使用`__try/__except`处理程序。

# sql-server - “轮询发现异常，重新启动轮询”是什么意思？错误是什么意思？

> ID：436673
> 
> 赞同：0
> 
> 时间：2009-01-12T19:28:55.810
> 
> 标签：sql-server, performance, exception

我们最近在我们的日志中发现了以下错误，该错误发生在我们的 Reporting Services 关闭之前。我们的服务器最近一直很慢，想知道这是否是问题的一部分。

错误消息：“轮询捕获异常，重新开始轮询。错误消息 System.Data.SqlClient.SqlException：超时已过期。”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-12T20:35:15.257

轮询用于检测计划的报告和订阅。

SQL 代理运行作业（由订阅页面创建）填充由 Rpt Svcs 每 10 秒轮询一次的表（在 .config 文件中定义，默认值为 10 IIRC）。

无论如何，这意味着 RS 框无法查询 RS 数据库以查看是否发生了任何事情。

# asp.net - 来自自定义验证器的问题呈现错误文本

> ID：436674
> 
> 赞同：0
> 
> 时间：2009-01-12T19:29:33.737
> 
> 标签：asp.net, validation

我有一个试图登录用户的页面。在页面顶部，我有一个 ValidationSummary 控件。我没有在页面中显式声明控件，并且正在调用静态方法以在出现错误时将验证器添加到页面。（见下文）

提交页面时，会出现 ValidationSummary，但是，ValidationSummary 控件中不会显示任何错误消息。这几乎就像控件不知道要向控件写入什么错误文本一样。

我是否必须重写 BaseValidator 中的方法才能显示验证器的错误文本？

以下是将验证器添加到页面的方式：

```
Private Sub btnWindowsLogin_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles btnWindowsLogin.Click
    Dim username As String = txtNetworkID.Text.Trim
    Dim password As String = txtPassword.Text

    If username.IsEmpty Then
        ErrorSummary.AddError("Please enter your NT Login", "WindowsLogin", Page)
    End If
    If password.IsEmpty Then
        ErrorSummary.AddError("Please enter your password", "WindowsLogin", Page)
    End If
    If Page.IsValid Then
        If Not AuthenticationService.ValidateActiveDirectoryLogin(username, password) Then
            ErrorSummary.AddError("The username or password you entered is incorrect", Page)
        ElseIf Not UserService.WindowsLoginExists(username) Then
            ErrorSummary.AddError("The NT Login entered is not associated with an account in the application", Page)
        Else
            'Get the user and validate the role, if the user is active, etc...

        End If
    End If
End Sub 
```

这是 ErrorSummary 类：

```
Public Class ErrorSummary
    Inherits BaseValidator

    Public Sub New(ByVal message As String, ByVal validationGroup As String)
        MyBase.Text = message
        MyBase.ValidationGroup = validationGroup
        MyBase.IsValid = False
    End Sub

    Public Sub New(ByVal message As String)
        Me.New(message, String.Empty)
    End Sub

    Public Shared Sub AddError(ByVal message As String, ByVal page As Page)
        AddError(message, String.Empty, page)
    End Sub

    Public Shared Sub AddError(ByVal message As String, ByVal validationgroup As String, ByVal page As Page)
        Dim objError As New ErrorSummary(message, validationgroup)
        page.Validators.Add(objError)
    End Sub

    Protected Overrides Function EvaluateIsValid() As Boolean
        Return False
    End Function

End Class 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-12T19:36:08.527

我想你想设置[ErrorMessage](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.basevalidator.errormessage.aspx)属性，而不是[Text](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.basevalidator.text.aspx)属性。

# php - 和之间的区别

> ID：436688
> 
> 赞同：6
> 
> 时间：2009-01-12T19:33:17.877
> 
> 标签：php

有什么特别的理由使用其中一个吗？我个人倾向于使用后者，因为它似乎对我来说更好。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-12T19:36:13.130

他们做同样的事情，<?= 只是被称为短标签，是 <?php echo 的简写。您必须确保启用短标签才能使用 <?= 表示法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-12T19:36:26.560

据我所知，它们在功能上是等效的，除了第二个可以在配置中禁用，因此不那么便携。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-12T19:45:58.693

> `short_open_tag`布尔值
> 
> 指示是否应允许 PHP 的 open 标记的缩写形式 ( )。如果您想将 PHP 与 XML 结合使用，您可以禁用此选项以使用内联。否则，您可以使用 PHP 打印它，例如： . 此外，如果禁用，您必须使用 PHP 开放标记 ( ) 的长格式。
> 
> 注意：该指令也会影响速记

[来源](http://ca.php.net/manual/en/ini.core.php#ini.short-open-tag)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-12T20:14:17.013

简写更清晰。它用尽可能少的词说：

> “在这里，一个表情被回响，没有其他事情发生。”

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-12T21:57:20.567

在大量 php 安装中禁用短标签，所以我从不使用

```
<?=$my_var?> // Bad Portability

<?php echo $my_var; ?> // Good Portability! 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-10T17:10:44.963

我认为这`<?php= $session_id; ?>`可以正常工作，并且不存在可移植性问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-03-19T10:43:34.263

只是一个附加问题。几年前我读过由于安全问题不推荐使用`<?`和不推荐使用。`?>`它是否正确？

# seo - 在大量内容中自动创建上下文链接的工具或方法？

> ID：436689
> 
> 赞同：0
> 
> 时间：2009-01-12T19:33:20.607
> 
> 标签：seo, nlp

这是基本场景 - 我有一个包含 100,000 篇类似报纸的文章的语料库。至少，它们都将具有明确定义的标题和一定数量的正文内容。

我想做的是在文章中找到应该链接到其他文章的文本运行。

因此，如果文章 Foo 有一系列文本，例如“鼓励 8 年级的学生阅读约翰-保罗·萨特的作品”，而文章栏的标题（以及关于）“约翰-保罗·萨特的重要著作”，我'我想在 Foo 的文本中自动创建从 Foo 到 Bar 的 HTML 链接。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-12T20:27:39.577

在添加链接之前，您应该问自己一些问题。您希望通过这样做为用户带来什么好处？您可能希望提高网站的可导航性。也许最好创建一种更简单的方法，以用于提交新文章的形式添加指向旧文章的链接。也许可以添加“一键搜索选定文本”功能。也许您可以添加一个类似于 wiki 的功能，让用户为选定的文本提出链接。您可能希望在文章下方添加相关文章的链接（通过标记系统或文本挖掘生成）。

全自动链接添加器的一些潜在问题：您可能需要实现一个好的词义消歧算法，以避免通过使用正则表达式（或简单的子字符串匹配）放置错误的自动链接来混淆甚至激怒用户。

由于文章数量很大，您不想为每个请求生成额外链接的 html，而是缓存它。

您需要对重复的标题或包含其他标题作为子字符串的标题做出决定（采用最长的标题或链接到最近的文章或更喜欢同一类别的文章）。

TLDR 版本：找到为用户提供所需功能的替代解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T20:13:49.077

您正在寻找的是文本挖掘工具。[您可以在http://en.wikipedia.org/wiki/Text_mining](http://en.wikipedia.org/wiki/Text_mining)找到更多信息和链接。您可能还想在[http://lucene.apache.org](http://lucene.apache.org)查看 Lucene 及其端口。使用这些工具，基本思想是根据相关文章（或标题）找到一组相似的文章。您可以搜索文章的各种属性，包括标题和内容或两者兼而有之。La Delicious（或 Stackoverflow）的标记系统也可能会有所帮助。您无需预先创建文章之间的链接，而是在一个界面中显示相关文章，该界面非常类似于此页面右侧的相关问题界面。

如果您想在每篇文章中查找并链接特定文本，我认为您需要进行一些预处理以选择相关的短语作为关键字。即便如此，我认为很难不因为标点符号/拼写错误而错过一些东西，或者出于同样的原因不包含不相关的链接。

# sharepoint - 我们如何通过 SharePoint 列表中的 id 验证元素是否存在？

> ID：436692
> 
> 赞同：1
> 
> 时间：2009-01-12T19:33:49.123
> 
> 标签：sharepoint, list, object

我想从列表中获取一个项目而不加载列表的所有项目。我知道我可以通过调用来做到这一点`SPList.getElementbyId(myID)`，但是如果我不知道这个 myID 是否存在于列表中，我该如何验证呢？是的，我可以使用

```
SPListItem myItem = myList.Items[myID];
if (myItem == null)
{
   // log that we don't have this item
} 
```

但是，这样，当我调用时`myList.Items`，列表的所有项目都加载到 in`myList`对象中（如果我有 40,000 个项目，这确实是一个性能问题），所以我宁愿使用：

```
SPListitem myItem = myList.getElementById(myID); 
```

这样我就不会调用该`Items`属性，我们也不需要加载这些项目。现在的问题是，`getElementById`如果列表中不存在该 ID，该方法将引发异常。把它放在一个`try/catch`声明中并不是一个解决方案，因为我们可能想要验证数百个 ID，并且处理所有的抛出将再次导致性能问题。任何其他想法来检查具有给定 id 的项目是否存在？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-12T20:07:12.113

您可以使用您的检查运行的所有 id 构建一个查询，并将返回的列表与您检查的 id 进行比较，并确定哪些是有效的或无效的。

通过这种方式，您只能检索您需要的内容，同时仍能找到丢失的内容。

# c# - 可以在运行时切换 app.config 吗？

> ID：436700
> 
> 赞同：9
> 
> 时间：2009-01-12T19:35:35.393
> 
> 标签：c#, runtime, app-config

有没有办法在运行时切换应用程序 app.config（current.config 到 new.config，文件对文件）。我有一个备份/恢复过程，需要替换它自己的 application.exe.config 文件。我看过这篇[文章](https://stackoverflow.com/questions/242568/is-it-possible-to-switch-application-configuration-file-at-runtime-for-net-appli)，但它没有回答如何在运行时执行此操作。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-12T21:06:17.660

结果我可以将 .config 文件换成新的，并为每个部分执行 ConfigurationManager.RefreshSection(...) 。它将从新的 .config 文件更新。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-12T23:56:20.297

Microsoft .NET`app.config`不是为您的方案以及许多其他方案而设计的。我经常遇到类似的需求，所以我花了很多精力设计一个解决方案。

1.  重新设计以`app.config`仅用作配置引导程序：指定在哪里可以找到其余的真实配置数据。此信息几乎永远不会改变，因此无需处理文件监视或应用程序重新启动。

2.  为真实的配置数据选择一个备用位置：一个文件、一个数据库，甚至可能是一个 Web 服务。大多数时候我更喜欢数据库，所以我创建了一个结构简单的配置表，允许我存储我的数据。

3.  实现一个简单的库来包装您的配置访问，以便您为应用程序的其余部分提供一个简单的 API（通过依赖注入）。隐藏使用`app.config`以及您的真实配置存储位置。由于 .NET 是强类型的，因此进行配置设置 - 将检索到的每个字符串转换为最具体的可用类型（URL、Int32、FileInfo 等）。

4.  确定哪些配置设置可以在运行时安全地更改，哪些不能。通常，某些设置需要与其他设置一起更改，或者根本没有任何意义允许它们更改。如果您的所有配置数据都可以在运行时安全地更改，那么这会使事情变得容易，但我非常怀疑这种情况。尽可能隐藏配置设置的可变性和相互依赖性。

5.  设计对真实配置数据不可用的响应。我更愿意将缺少任何配置设置视为中止应用程序的致命错误，除非我可以确定可用的默认值。同样，我在没有配置存储容器（文件、数据库表等）的情况下中止。

享受，并祝愿。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-12T19:40:23.090

当您检测到需要切换文件时，您是否能够重新启动应用程序？如果是这样，只需切换文件并重新启动即可。现在，棘手的一点是，*如果*.NET 在程序运行时保持 app.config 文件处于打开状态。我怀疑它没有，但如果最明显的方法失败了，我建议你有第二个应用程序（cfgswitcher.exe）等待在命令行中指定 PID 的进程终止，然后切换配置文件并重新启动原流程。然后您的应用程序只需要启动 cfgswitcher.exe（将其自己的 PID 作为命令行参数传递）并终止。

正如我所说，首先尝试更明显的方法是值得的。

编辑：如果您无法重新启动应用程序（甚至无法在新的 AppDomain 中重新启动应用程序的一部分），则无法更改 app.config 的各个方面（程序集绑定等）。如果您只对更改*自己的*配置部分感兴趣，那么我建议您将它们存储在单独的配置文件中，并在需要时重新加载它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-12T19:55:51.030

查看 ApplicationSettingsBase 类上可用的事件。有 PropertyChanged 和 SettingChanging 可能会给你你需要的东西。

您还可以查看文件，如果它已更改，请调用 reload 方法以获取新设置。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-12T19:55:52.887

我认为根本不可能在不重启的情况下在运行时切换配置，所以如果你不能应用 Jon 的方法，你应该尝试想出另一种方法。

无论如何，也许只是我对你的场景没有足够的信息，但这种感觉很可疑。

**您确定**交换配置文件是实现您需要满足的任何要求的最佳方式吗？我的意思是，这是一件非常罕见的事情。如果我是你，我会尝试想出一些其他的方法。

# css - 子选择器的替代品是什么？

> ID：436702
> 
> 赞同：9
> 
> 时间：2009-01-12T19:36:07.280
> 
> 标签：css, internet-explorer-6, css-selectors

由于 IE6 不支持子选择器（请参阅[http://kimblim.dk/csstest/#ex1](http://kimblim.dk/csstest/#ex1)），处理此浏览器时有什么替代方法？

我不想修改标记，而且我更喜欢纯 CSS 的解决方案......

是的，这是我希望针对的直接孩子。

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-12T21:14:45.597

我遇到了一些黑客攻击： http: [//meyerweb.com/eric/thoughts/2005/05/31/universal-child-replacement/](http://meyerweb.com/eric/thoughts/2005/05/31/universal-child-replacement/)结合使用 IE（6 及以下） 的“ [star html](http://www.positioniseverything.net/articles/poll/star-html.php "明星html") ”黑客攻击这样我就可以选择直接孩子。假设我们想对 E 的直接子 F 应用 10px 的 padding-top：

```
* html body E F
{
    /* apply style here for IE 6 */
    padding-top: 10px;
    /* This applies the style to every F inside of E */
}
* html body E * F
{
    /* undo style here */
    padding-top: 0px;
    /* This will undo the style set above for every F that has something in between itself and E, that is, every F besides the direct children of E */
} 
```

到目前为止，我非常感谢您的回答，但尽管我讨厌接受自己的回答，但这是我最终确定的解决方案。多谢你们！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-12T19:38:41.313

您可以使用 jQuery，这不是一个很好的解决方案，但它是我过去使用的一个选项：

```
$("parent > child").each(function() {
    $(this).addClass("child-styles");
} 
```

您显然希望将其包装在一些专门的 IE6 仅检查中。并且可能需要一个包含在 IE6 IF 语句中的样式表来添加这些专门的样式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-20T08:48:19.740

这是我在一本书中找到的一个很好的解决方案：“The Anthology of Javascript”

像这样的东西：

```
/* for all but IE */
#nav ul li.currentpage > a:hover {
  background-color: #eff;
} 
```

以及迎合 IE 的代码：

```
/* for IE */
* html #nav ul li.currentpage a:hover {
  background-color: expression(/currentpage/.test(this.parentNode.className)? "#eff" : "#ef0");
} 
```

IE 的 hack 是只有 IE 认为在 html 上有一个包装器，并且 IE 确实支持 expression() 的东西。

该表达式使用正则表达式 (/currentpage/)，并针对父节点的类对其进行测试，因此元素 li.currentpage 的直接子节点将设置为 #eff，其他后代将设置为 #ef0。

请注意，使用的颜色是假的，请不要评论它们;-)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-05-19T18:17:31.380

这篇文章讨论了在 IE6 中模拟 CSS 子选择器的所有不同选项，包括最后使用嵌套结构的一个小技巧：http: [//craftycode.wordpress.com/2010/05/19/emulating-css-child -ie6中的选择器/](http://craftycode.wordpress.com/2010/05/19/emulating-css-child-selectors-in-ie6/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-12T19:38:43.780

需要直子吗？IE6 支持后代选择器，例如

```
div span { ... } 
```

也许你可以利用它来定位你想要的东西。也许您可以发布一些代码，以便我们可以给您更具体的答案？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-12T19:39:03.560

在元素上放置一个自定义类。

```
<ul>
<li class="first">Blah<li>
<li>Blah<li>
<li>Blah<li>
</ul> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-02-11T01:38:50.390

用这个

```
div * { padding-left:20px; }
div * * { padding-left:0; } 
```

首先，您以所有子代为目标，然后通过以所有孙代为目标来重置 css 声明。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-06-08T19:56:56.783

我使用的跨浏览器解决方案如下。它不使用 IE6 hack 并正确显示嵌入列表（例如，您需要以不同的方式设置 OL 和 UL 嵌套项的样式）。

```
ul, ol {
    /* Set margins, padding, and other generic styles */
}
ul li, ul ul li, ol ul li {
    list-style-type: disc; /* unordered lists */
}
ol li, ul ol li, ol ol li {
    list-style-type: decimal; /* ordered lists */
}
```

就像 yodeling CSS 一样简单！

# javascript - IE 中的 Element.appendChild() 阻塞

> ID：436710
> 
> 赞同：4
> 
> 时间：2009-01-12T19:37:52.907
> 
> 标签：javascript, internet-explorer

我有以下 javascript：

```
 css = document.createElement('style');
  css.setAttribute('type', 'text/css');
  css_data = document.createTextNode('');
  css.appendChild(css_data);
  document.getElementsByTagName("head")[0].appendChild(css); 
```

出于某种原因，仅在 IE 中，它会阻塞“css.appendChild(css_data);” 给出错误：“意外调用方法或属性访问”

这是怎么回事？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-12T19:48:58.890

请尝试：

```
var css = document.createElement('style');
css.setAttribute('type', 'text/css');

var cssText = '';
if(css.styleSheet) { // IE does it this way
    css.styleSheet.cssText = cssText
} else { // everyone else does it this way
    css.appendChild(document.createTextNode(cssText));
}

document.getElementsByTagName("head")[0].appendChild(css); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-12T19:51:33.067

这对于“样式”元素来说是特别的，IE 不允许在其上使用 appendChild() 方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-12T19:55:44.510

IE中的**HTMLStyleElement**不允许 appendChild()

[看看这个](http://msdn.microsoft.com/en-us/library/dd347118(VS.85).aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-13T00:15:22.927

[@新月新鲜](https://stackoverflow.com/questions/436710/element-appendchild-chokes-in-ie#436750)

我尝试了您的建议，样式块的内容根本不会被填充。在 IE6 和 IE7 中尝试过......它似乎没有做*任何事情*

这是我修改后的代码：

```
function load_content()
{
  var d = new Date();

  css = document.createElement('style');
  css.setAttribute('type', 'text/css');
  if(css.styleSheet) { css.styleSheet.cssText = 'testing'} //Because IE is evil
  else { css_data = document.createTextNode(''); css.appendChild(css_data); } //And everyone else is cool
  document.getElementsByTagName("head")[0].appendChild(css);

  new Ajax.PeriodicalUpdater('content', '/%doc_path%?'+d.getTime(),
  {
    method: 'post',
    frequency: 5,
    onSuccess: function(transport) {
          new Ajax.Request('/%css_path%?'+d.getTime(), {
              method: 'get',
              onSuccess: function(transport) {

                if(css.styleSheet) { css.styleSheet.cssText = transport.responseTex}
                else { 
                    var new_css_data = document.createTextNode(transport.responseText);
                    css.replaceChild(new_css_data, css_data); 
                    css_data = new_css_data;
                } 
              }
          });
    }
  });
} 
```

有任何想法吗？

# sql-server - NV32ts 及其 SQL 注入攻击试图做什么？

> ID：436715
> 
> 赞同：5
> 
> 时间：2009-01-12T19:39:19.457
> 
> 标签：sql-server, security, sql-injection

最近我的网站受到了一些攻击，使用的是 NV32ts 的用户代理。

它们都是以下针对查询字符串变量的注入攻击的一些变体（其中 99999 表示有效的查询字符串值，攻击附加到该值）：

（为方便起见，我对以下攻击进行了 urldecode）

```
999999 And char(124)+(Select Cast(Count(1) as varchar(8000))+char(124) From [sysobjects] Where 1=1)>0 
```

或者

```
999999' And char(124)+(Select Cast(Count(1) as varchar(8000))+char(124) From [sysobjects] Where 1=1)>0 and ''=' 
```

或者

```
999999' And char(124)+(Select Cast(Count(1) as varchar(8000))+char(124) From [sysobjects] Where 1=1)>0 and ''=' 
```

我相信 sysobjects 与 Sql Server 主数据库有关，但我无法弄清楚他们想要完成什么。

**编辑：** 我现在已经用两个不同的用户代理看到了这些相同的东西：

*   NV32ts
*   Mozilla/4.0（兼容；MSIE 7.0；Windows NT 5.1；InfoPath.1；.NET CLR 1.1.4322；.NET CLR 2.0.50727；.NET CLR 3.0.04506.30；.NET CLR 3.0.04506.648；.NET CLR 3.5。 21022; **WWTClient2** )

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-12T19:52:30.490

我以两种方式阅读了这一篇，但我不确定 100% 是哪一种：

1.  在这一点上，他们只是在钓鱼。该脚本正在寻找具有开放注入漏洞和访问 sql server 中 sysobjects 表的网站。该表将提供数据库中所有表和列（及其类型）的列表。如果页面实际返回结果而不是抛出错误，脚本将记录该结果以备将来进行更详细的攻击。您最终会在整个数据库中每个表的每一行的每个文本（varchar、nvarchar、char、nchar、text）列中附加恶意 javascript 代码。我认为这是更有可能的选择。
2.  它创建了一个始终返回 true 的表达式，可能允许它们绕过您的身份验证系统。这似乎不太可能，因为 sysobjects 引用使其变得不必要地复杂。另外：他们使用`And`而不是`Or`.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-12T21:01:02.693

我相信他们在这里试图弄清楚的是你的应用程序是否容易受到 SQL 注入的攻击。

Char(124) 转换为 | 强制将整个查询结果视为附加了两个管道的查询结果的字符。因此，您最终会得到数据库中连接了两个管道的表数（例如 |1428|）。与 > 0 中的 0 相比会导致错误，因为 |1428| 不是整数。

因此，如果您的应用程序对 SQL 注入开放，他们现在就知道了（因为有效的参数值导致应用程序出错）。如果他们的 SQL 数据库错误浮出水面，他们也可能知道您的错误处理很糟糕。如果您确实有错误的错误处理，他们也知道您有多少表（不确定它们有什么好处，但信息越多越好）。

很多 SQL 注入尝试实际上是为了让你的应用程序失败，以便知道你是易受攻击的。如果您确实很好地处理了错误，他们可能会尝试盲目地注入 SQL。

查看[此](http://www.unixwiz.net/techtips/sql-injection.html)内容以详细了解。

我希望你不是脆弱的，如果你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-31T06:38:11.567

HP 有一个免费工具，您可以运行它来检查您的站点（或任何站点）是否存在名为 sdrawlr 的 SQL 注入漏洞。你可以[在这里](http://www.softpedia.com/progDownload/Scrawlr-Download-102782.html)下载：

# c# - 如何使用 lambda 表达式作为参数通过反射调用方法？

> ID：436716
> 
> 赞同：6
> 
> 时间：2009-01-12T19:40:05.820
> 
> 标签：c#, generics, reflection, lambda

我想做这个：

```
MethodInfo m = myList.GetType().GetMethod("ConvertAll", System.Reflection.BindingFlags.InvokeMethod).MakeGenericMethod(typeof(object));
List<object> myConvertedList = (List<object>)m.Invoke(myList, new object[]{ (t => (object)t)}); 
```

myList 是特定类型的通用列表（应用程序未知），我想将其转换为对象列表以执行某些操作。

但是，此错误会失败：“无法将 lambda 表达式转换为类型 'object'，因为它不是委托类型”

你能帮我找出问题所在吗？我是否正在尝试做一些不可能的事情？

有没有其他方法可以达到同样的目的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-12T19:45:31.770

lambda 表达式可以转换为委托类型或具有正确签名的表达式树 - 但您需要指定它是哪种委托类型。

我认为如果您将其设为通用方法，您的代码会简单*得多：*

```
public static List<object> ConvertToListOfObjects<T>(List<T> list)
{
    return list.ConvertAll<object>(t => t);
} 
```

然后，您只需要一般地查找并调用*该*方法：

```
MethodInfo method = typeof(Foo).GetMethod("ConvertToListOfObjects",
    BindingFlags.Static | BindingFlags.Public);
Type listType = list.GetType().GetGenericArguments()[0];
MethodInfo concrete = method.MakeGenericMethod(new [] { listType });
List<object> objectList = (List<object>) concrete.Invoke(null, 
                                                   new object[]{list}); 
```

完整示例：

```
using System;
using System.Reflection;
using System.Collections.Generic;

class Test
{
    public static List<object> ConvertToListOfObjects<T>(List<T> list)
    {
        return list.ConvertAll<object>(t => t);
    }

    static void Main()
    {
        object list = new List<int> { 1, 2, 3, 4 };

        MethodInfo method = typeof(Test).GetMethod("ConvertToListOfObjects",
            BindingFlags.Static | BindingFlags.Public);
        Type listType = list.GetType().GetGenericArguments()[0];
        MethodInfo concrete = method.MakeGenericMethod(new [] { listType });
        List<object> objectList = (List<object>) concrete.Invoke(null,
                                                    new object[] {list});

        foreach (object o in objectList)
        {
            Console.WriteLine(o);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-12T19:44:31.910

一个 lambda 形成一个方法*组*（基本上这是一个仅由名称（和范围）标识的方法。由于可以重载具有相同名称的方法，因此一个方法组包含几个不同的成员）。这不能总是隐式转换为委托，因为委托实际上绑定到方法组内的单个方法。这与重载有关。

不幸的是，这同样适用于您的情况。补救措施是明确委托：

```
List<object> myConvertedList = (List<object>)m.Invoke(myList, new object[]{ new Func<YourType, object>(t => (object)t)}); 
```

# assembly - 模拟ARM汇编环境？

> ID：436728
> 
> 赞同：9
> 
> 时间：2009-01-12T19:43:01.557
> 
> 标签：assembly, embedded, arm

我希望我的儿子学习 ARM 汇编程序，我正在考虑给他买一个他可以编程的嵌入式系统，这样他就可以制作 LED 闪烁和其他我小时候喜欢的很酷的东西。是否有任何模拟或虚拟“工作台”在不使用实际硬件的情况下在 PC 上提供这种类型的编程环境？我很想让他开始使用 ARM，因为这些芯片似乎出现在所有新设备中，例如手机等。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-12T21:11:24.777

试试 QEMU！

它是免费的，您可以在模拟的 ARM 内核上安装 Ubuntu 或 Debian linux。运行裸代码也是可能的（也少了很多乐趣）。

据我所知，它支持 ARMv5、ARMv6 和 Cortex-A8，因此您可以从廉价到高端的 ARM 处理器中进行选择。

最好的：一旦您的代码在模拟环境中运行，您就可以将整个 firesystem 移动到真实硬件系统上的闪存或 SD 卡中。内核将处理大约 90% 的硬件差异。当然，这只有在您决定在 ARM 上运行 linux 时才有效。

强烈推荐。

您可能还对模块化系统上易于使用且价格低廉的 ARM 系统感兴趣。恕我直言，没有什么比使用真正的硬件更好的了。一块裸板，您可以将电缆插入并让真正的 LED 闪烁。在这种情况下，我建议您看一下 beagleboard。

进入嵌入式编程从未如此便宜。(www.beagleboard.org)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-29T16:39:03.037

vba，gameboy 高级模拟器。学习 arm 和 thumb，从 ram 中学习 rom，一些有趣的视频内容，键盘输入等。然后购买像 supercard sd 和真正的 gameboy 之类的东西来运行相同的程序。一旦你在某种程度上学习了 gba，nds 就会非常相似，你可以专注于双处理器的事情并让二进制文件正常工作。nds 也有模拟器，因此如果您不想购买硬件，您实际上不必购买硬件。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-12T19:55:49.470

嗯，这并没有回答你的问题，但仍然：HP50g 计算器有一个 ARM 处理器，你可以使用 hpgcc 为 ARM 编写 C（因此，ASM）程序。更不用说 HP 50g 是一款非常强大且实用的硬件。谁知道它甚至可能让您的儿子对数学感兴趣 :) hpgcc 提供的 C 库具有用于屏幕绘图和产生声音的例程，因此也可以做一些“有趣”的事情。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-02-14T07:52:04.357

我知道这个答案可能来晚了一点，但是我在尝试寻找[MARS](http://courses.missouristate.edu/kenvollmar/mars/)（MIPS 汇编器和运行时模拟器）的 ARM 替代品时遇到了类似的问题，最近偶然发现了非常好的[ARMSim](http://armsim.cs.uvic.ca/)。

我相信 ARMSim 应该提供您正在寻找的所有功能。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-12T20:26:17.053

您可以看看 ARM ADS ( [http://www.arm.com/products/DevTools/ADS.html](http://www.arm.com/products/DevTools/ADS.html) )。它包括模拟器、可视化调试器、IDE、在线文档，支持 ARM 7、9、9e 和 10 等。您可以在 Windows 或 Linux 上使用它。

我在大学学习 ARM 汇编程序时，教授使用了这个 IDE，它看起来非常强大。不幸的是，我们（学生）正在研究功能较弱的模拟器系统（称为 ATLAS）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-05T22:33:12.230

第一次教您的儿子组装，请查看 Chip-8 解释器，它只有 36 个命令，维基百科包含操作码的明确定义。

# c# - 我可以在 C# 和 .NET 中将多维数据绑定到 DataGridView 吗？

> ID：436731
> 
> 赞同：5
> 
> 时间：2009-01-12T19:43:52.410
> 
> 标签：c#, .net, visual-studio, datagridview, interface

我正在寻找开发一个应用程序，该应用程序具有从 DataGridView 子类化的工作表。用户可以将类似 CSV 的数据粘贴（或导入）到工作表中，它将反映在内存中的数据结构中——我的第一个猜测是浮点数的二维数组。

DataGridView 可以绑定到具有特定接口集（即 IList、IListSource 等）的对象，因此理论上我可以创建一个封装 2D 数组并实现其中一个接口的类。然而，令人费解的是，接口规范似乎只适用于一维数组——例如，参见[IList 。](http://msdn.microsoft.com/en-us/library/system.collections.ilist.aspx)到底是怎么回事？！

**更新：**从答案来看，似乎 IList 适合对象列表。那么有没有办法将任意大小（浮点数）的多维数组绑定到 DataGridView？还是可以使用 DataGridView 本身作为存储浮点数的数据结构？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-12T20:37:09.747

我以前做过类似的事情，[在这里](http://groups.google.com/group/microsoft.public.dotnet.languages.csharp/browse_thread/thread/ae1251a6855b9254/29ed401fdfb1b4c1#29ed401fdfb1b4c1)- 在 ; 中表示一个二维数组`IList`。可能有用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-12T19:59:26.077

[CodeProject 上](http://www.codeproject.com/KB/database/BindArrayGrid.aspx)有一篇不错的文章，展示了如何将 2D 数组绑定到 DataGridView。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-12T19:53:16.463

这样想吧。IList 可以是对象的集合。然后每个对象可以在其中具有多个属性。所以本质上，这就像一个二维数组。第一个维度是对象，以及它的所有属性，第二个维度是所述对象的集合。像这样的东西：

```
list[0] --> Name, (think of this as list[0]["Name"])
            Age, (think of this as list[0]["Age"])
            Height  (think of this as list[0]["Height"])

list[1] --> Name, (think of this as list[1]["Name"])
            Age, (think of this as list[1]["Age"])
            Height  (think of this as list[1]["Height"]) 
```

因此，在您的情况下，如果列是固定的，那么您只需要一个封装所有这些字段的对象，然后拥有这些对象的集合，然后将这些对象绑定到 DataGridView。

如果这没有任何意义，那么我不明白你的问题，我很抱歉。

# c# - 寻找字符串操作的边缘情况。我需要测试什么？

> ID：436736
> 
> 赞同：0
> 
> 时间：2009-01-12T19:45:07.777
> 
> 标签：c#, string, globalization, cultureinfo

我正在进入我的绳索（一个更具可扩展性的版本`String`）实施的最后阶段。显然，我希望所有操作尽可能给出与 s 上的操作相同的结果`String`。

为序数操作执行此操作非常简单，但我担心正确实施文化敏感操作。特别是因为我只知道两种语言，并且在这两种语言中，文化敏感操作的行为与序数操作完全相同！

那么有没有什么具体的事情我可以测试并至少让我对我做正确的事情有信心？例如，当忽略德语中的大小写时，我知道 ß 等于 SS；关于土耳其语中加点和不加点的 i。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-12T19:51:35.453

代理对，如果您打算支持它们 - 包括无效组合（例如，只有一个的一部分）。

如果您正在进行编码和解码，请确保您保留足够的状态以应对任意给出的二进制数据块进行解码，这些数据块可能在一个字符的一半结束，剩下的一半在下一个字符中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T19:49:08.843

土耳其语测试是我所知道的最好的 :)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-12T19:57:41.293

您应该模仿 String 方法的实现，并使用核心库为您执行此操作。很难考虑每种文化的每一个可能方面。与其重新发明轮子，不如在 String 方法上使用反射器并查看内部调用。例如 String.Compare 使用 CultureInfo.CurrentCulture.CompareInfo.Compare 比较当前文化中的 2 个字符串。

# java - Java不继承访问器方法？

> ID：436742
> 
> 赞同：0
> 
> 时间：2009-01-12T19:45:56.777
> 
> 标签：java, inheritance

给定一个扩展类“Foo”的类“Bar”，该类实现接口“DeeDum”

```
public interface DeeDum {
    public String getDee();
    public String getDum();
}

public class Foo implements DeeDum {
    public String dee = "D";
    public String dum;

    public String getDee() { return dee; }
    public String getDum() { return dum; }
}

public class Bar extends Foo {
    public String dee = "DEE";
    public String dum = "DUM";
} 
```

为什么这不起作用？

```
public static Bar mybar = new Bar();
Assert.assertEquals("DEE", mybar.getDee());
Assert.assertEquals("DUM", mybar.getDum()); 
```

我得到“D”和空值。换句话说，Bar 不会从 Foo 继承访问器，也不能覆盖属性。以某种方式调用 mybar.getDum() 调用类 Foo 的静态实例并从父类返回静态属性。即使属性在子类中被覆盖！这是否意味着您不能继承*任何*方法或属性？

我无法绕过它。为什么 Java 不能继承访问器（为什么他们选择了这样一个奇怪的替代方案？）

还是我只是做错了什么？

* * *

实际上，我仍然看到一些奇怪和不确定的东西。如果您有另一个类 'Bar' 扩展 Foo 并在初始化块中设置继承的访问器

虽然您可以在上面的块中设置 parent 属性，但它实际上并没有为子类创建副本。

这似乎是多个类的非确定性初始化。

因此，如果您有 Bar 和 Baz，它们都扩展了 foo 并具有初始化块，那么它们似乎都继承了 Bar 设置的值。

```
public class Bar extends Foo {
    {
        dee = "dee";
        dum = "dum";
    }
}
public class Baz extends Foo {
    {
        dee = "DEE";
        dum = "DUM";
    }
}

public static Bar bar = new Bar();
public static Baz baz = new Baz();

System.out.println("mybaz: " + mybaz.getDee() + mybaz.getDum());  // DEEDUM
System.out.println("mybar: " + mybar.getDee() + mybar.getDum());  // DEEDUM 
```

但如果它们以不同的顺序实例化，我会得到：

```
public static Baz baz = new Baz();
public static Bar bar = new Bar();

System.out.println("mybaz: " + mybaz.getDee() + mybaz.getDum());  // deedum
System.out.println("mybar: " + mybar.getDee() + mybar.getDum());  // deedum 
```

如果在基类 Foo 中设置了默认值，结果仍然不同。

我想我现在明白 Bar 和 Baz 中的初始化块实际上是设置 Foo::dee 和 Foo::dum，但为什么声明的差异？对我来说似乎“未定义”。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-12T19:52:04.157

问题是您对成员`dee`和in`dum`的重复声明隐藏了. 有**自己的**成员；那些永远不会被. 你的意思是像`Foo``Bar``Foo``Bar`**`Foo``Bar`**

 **```
public class Bar extends Foo {
  {
    dee = "DEE";
    dum = "DUM";
  }
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-12T19:50:36.470

您正在使用子类中定义的变量隐藏继承的变量。

```
public class Bar extends Foo {
    public Bar() {
        dee = "DEE";
        dum = "DUM";
    }
} 
```

应该工作得更好。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-12T19:59:33.800

当您调用 时`mybar.getDee()`，您正在调用`Foo`基类中定义的方法。（该方法*是*由`Bar`. `Bar`_ `dee`_方法本身已定义。编译器在类中解析方法编译时对字段的引用。`dee``Foo``Foo`

其他一些答案使用*覆盖*一词来定义您通过声明名为`dee`in的字段`Bar`所做的事情，但事实并非如此。您不能覆盖字段，因为字段不是虚拟的。不过，也许你认为他们是。如果有“虚拟字段”之类的东西，我也可能希望`getDee()`返回运行时类的字段版本（in`Bar`中的那个），而不是编译方法时范围内的那个（`Foo`' s)。但这根本不是 Java（或 C#、C++、Delphi 或我知道的任何其他语言）的工作方式。您习惯使用哪种语言，这在哪里会起作用？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-12T19:49:35.677

访问器方法本身（例如`getDee()`）是继承的，但实例变量不是。

如果实例变量可以在子类中被覆盖（就像你在这里尝试做的那样），它会导致比它修复的问题更多的问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-12T19:52:31.600

访问器不是问题，而是字段。访问者指的是`Foo.this.dee`，而不是`Bar.this.dee`单独的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-12T23:03:24.083

至于你的第二个“问题”......

> *实际上，我仍然看到一些奇怪和不确定的东西......*

...

> *"...System.out.println(baz.getDee()); // 'DEE' 但期望 'dee'"*

如果您在发布问题之前运行程序以查看实际结果，这将很有用。

这就是我得到的。正如你所料，它是“dee”。

您可以通过创建文件、编译它们并运行它们来亲自查看它，如下所示：

```
C:\oreyes\samples\java\dee>type DeeDum.java Foo.java Bar.java Baz.java Test.java

DeeDum.java

public interface DeeDum {
    public String getDee();
    public String getDum();
}

Foo.java

public class Foo implements DeeDum {
    public String dee = "D";
    public String dum;

    public String getDee() { return dee; }
    public String getDum() { return dum; }
}

Bar.java

public class Bar extends Foo {
    {
        dee = "DEE";
        dum = "DUM";
    }
}

Baz.java

public class Baz extends Foo {
    {
        dee = "dee";
        dum = "dum";
    }
}

Test.java

class Test {
    public static Bar bar = new Bar();
    public static Baz baz = new Baz();
    public static void main( String [] args ) {
        System.out.println(bar.getDee()); // 'DEE'
        System.out.println(baz.getDee()); // 'DEE' but would expect 'dee'
    }
}

C:\oreyes\samples\java\dee>javac *.java

C:\oreyes\samples\java\dee>java Test
DEE
dee

C:\oreyes\samples\java\dee> 
```

佩布卡克？

# java - 在 Tomcat 中支持没有 Cookie 的会话

> ID：436752
> 
> 赞同：14
> 
> 时间：2009-01-12T19:49:23.460
> 
> 标签：java, session, tomcat, cookies

我目前正在运行具有以下属性的应用程序：

*   基于 Java 的 Spring 和 Acegi
*   在 Tomcat 5 上运行

我需要能够支持**没有**cookie 的用户会话。有人可以指出我正确的方向。

谢谢你。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-01-13T21:44:15.867

这个问题的完整答案是你所有回答的组合，所以我要总结一下：

1.  无需在 context.xml 文件中设置 cookies="false"。理想的功能是让 tomcat 使用它的基于 url 的会话标识，如果用户不支持 cookie，则默认使用该标识。

2.  当用户未启用 cookie 时，tomcat 将通过请求 url 中的“JSESSIONID”参数来识别会话。几个示例 url 如下 `http://www.myurl.com;jsessionid=123456AFGT3` `http://www.myurl.com;jsessionid=123456AFGT3?param1=value&param2=value2` 注意会话 id 不是 url 查询字符串的一部分（这是 j2ee 标准）

3.  为了确保 jsessionid 参数附加到您的所有请求 URL，您不能有纯 url 引用。例如，在 JSTL 中，您必须使用 <c:url>。如果需要，servlet 引擎会自动将 jsessionid 附加到 url。这是一个例子：

    <%--这很糟糕：--%> <a href="page.html">链接</a>

    <%--这很好：--%> <a href="<c:url value='page.html'/>">链接</a>

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-12T19:57:21.060

请参阅[http://tomcat.apache.org/tomcat-5.5-doc/config/context.html](http://tomcat.apache.org/tomcat-5.5-doc/config/context.html)。

在文件 META-INF/context.xml 中，

```
<?xml version='1.0' encoding='UTF-8'?>
<Context path='/myApplicationContext' cookies='false'>
  <!-- other settings -->
</Context> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-12T19:54:33.107

您可以通过 IP 地址进行跟踪，但代理服务器（和 NAT？）可能会让您感到困惑。

您可以强制所有 URL 将会话作为参数，并将所有表单作为隐藏字段。也许用于生成 URL 的自定义标签在这里会有所帮助，但我没有对 taglibs 做太多工作。

您将需要考虑安全性 - 人们可能会通过电子邮件将链接发送给其他人，其中包含会话 ID，因此您需要对每次访问进行 IP 地址检查，以检查该地址是否与会话匹配。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-12T21:54:39.200

正如 matt b 评论的那样，这应该是开箱即用的（tomcat 将尝试 cookie，如果失败，则回退到在 url 中对会话进行编码）。但是，如果您自己创建一个“普通”链接，这将不起作用 - 始终使用类似 JSTL 的方法，以便 tomcat 可以将跟踪参数添加到所有 url。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-10-02T17:51:21.617

最好的方法是使用**URL 重写**。因此，当您使用时`request.getSession()`，将在 HTTP 响应中`container`发送“ `Set-Cookie`”标头并附加到（但您必须用于 url 重写）。`session-id``session-id``URL``response.encodeURL(session_info)`

```
public void doGet(HttpServletRequest req, HttpServletResponse resp)
throws ServletException, IOException  {
    resp.setContentType("text/html");
    PrintWriter pw=resp.getWriter();
    HttpSession session=req.getSession();
    pw.println("<html><body>");
    pw.println("<a href=\""+resp.encodeURL("/session_info")+"\">Click</a>");
    pw.println("</body></html>");

} 
```

# c# - C# Out 参数问题：Out 如何处理值类型？

> ID：436759
> 
> 赞同：4
> 
> 时间：2009-01-12T19:50:48.217
> 
> 标签：c#, stack, heap-memory, out-parameters

**更新所以完全拉了一个工具时刻。我真正的意思是参考与输出/参考。任何说“参考”的东西，我真正的意思是参考，如**

一些方法（对象一些对象）

**相对**

SomeMethod(out someObject)

**对不起。只是不想更改代码，因此答案已经有意义。**

据我了解，与 ref 不同，它“复制”指针并在堆栈上创建一个新空间以使用该指针，但不会更改指针：

```
SomeMethod()
{
 SomeThing outer = new SomeThing();
 RefMethod(ref outer)
}

RefMethod(ref inner)  //new space on stack created and uses same pointer as outer
{
   inner.Hi = "There"; //updated the object being pointed to by outer
   inner = new SomeThing();//Given a new pointer, no longer shares pointer with outer
                           //New object on the heap
} 
```

Out 复制指针并可以操纵它指向的位置：

```
SomeMethod()
{
 SomeThing outer = new SomeThing();
 RefMethod(out outer)
}

RefMethod(out inner)  //same pointer shared
{

   inner = new SomeThing();//pointer now points to new place on heap  
                           //outer now points to new object
                           //Old object is orphaned if nothing else points to it
} 
```

对对象来说这很好而且很花哨，但是值类型怎么办，因为它们没有任何东西指向仅在堆栈上？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-12T19:52:45.607

仅仅因为变量存在于堆栈中（如果它是局部变量）并不意味着您不能创建指向它的指针——事实上引用类型也是如此。

RefMethod 中的指针指向“外部”变量 - 变量本身存在于堆栈中，因为它是一个未捕获的局部变量。

正如 Leppie 所说， ref 和 out 除了明确分配的规则外是相同的 - 事实上，IL 中唯一的区别是应用于 out 参数的属性。

有关 ref/out 的更多详细信息，请参阅[我关于参数传递的文章。](http://pobox.com/~skeet/csharp/parameters.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-12T19:52:22.003

据我所知， ref 和 out 完全相同，只是无法初始化 out 参数。因此两者都进入堆栈。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-12T20:40:08.617

实际上在引用类型上使用 ref 或 out 也会创建一个指针……不是指向对象，而是指向对象的引用！所以这将是某种

```
RefMethod(SomeThing **inner)
{
} 
```

在 C++ 中，而对于值类型，它会是

```
RefMethod2(int *inner)
{
} 
```

对于值类型。

# c# - SMO 脚本对象和安全性

> ID：436760
> 
> 赞同：0
> 
> 时间：2009-01-12T19:51:00.073
> 
> 标签：c#, sql-server-2005, security, smo

我有一个客户在托管服务器上有一个 SQL 数据库；调用数据库“myDatabase”。

托管公司 已锁定对象资源管理器 - 我在列出的数据库中看不到 myDatabase（我看到 tempdb 和 master）。但是，如果我“使用 myDatabase”然后“从 myTable 中选择 *”，一切正常。

由于我们无法访问对象资源管理器，因此我无法右键单击并生成脚本。我以为我可以使用 SMO 来完成我想要的，但是当我尝试类似的事情时：

```
Server myServer = new Server(conn);
Database myDB = server.Databases["myDatabase"];
Table myTbl = myDB.Tables["myTable"]; 
```

它失败了 - myDB 为空（当我遍历数据库集合时，正如预期的那样，我只看到 master 和 tempdb - 我可以在对象资源管理器中看到的 db）。这显然与安全有关——如果我在对象资源管理器中看不到表，它不会让我通过 SMO 访问它。任何人都对允许我生成脚本的解决方法或替代方法有任何想法？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-12T20:17:03.547

我还没有查看 SMO 代码，但是您是否尝试过在数据库对象上使用构造函数？也许您可以直接访问它。

```
Database myDB = new Database(myServer, "myDatabase"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-12T20:42:51.857

myDb.Tables 集合是空的吗？可能是您使用错误的名称引用它吗？

您可以尝试的一种选择是使用 Linq2Sql 生成数据库模型。然后，您可以使用该模型创建一个与原始数据库大致相同的新数据库。查找 DataContext.CreateDatabase 方法以获取更多信息。

另一种选择是使用以下查询列出所有表：

```
select * from sys.tables 
```

然后使用以下命令列出表中的所有列：

```
select * from sys.columns where object_id = (object id from the previous query) 
```

这将为您提供数据库中定义的所有表和列，并且应该足以创建数据库结构。此外，您还定义了其他对象的系统视图。

# javascript - 外部接口错误

> ID：436776
> 
> 赞同：0
> 
> 时间：2009-01-12T19:53:39.943
> 
> 标签：javascript, flash, constants, externalinterface

这是我用来`calc`在 javascript 中调用函数的代码：

```
import flash.external.ExternalInterface;

ExternalInterface.addCallback("asFunc", this, asFunc); 

function asFunc(str:String):Void {
    out.text = "JS > Hello " + str;
}

send_btn.addEventListener(MouseEvent.CLICK, clickListener);

function clickListener(eventObj:Object):Void {
    trace("click > " + mean.text);
    ExternalInterface.call("calc", mean.text);
} 
```

但我收到以下错误：

> 1046：未找到类型或不是编译时常量：无效。

我在这里做错了什么？（我修改了实时文档上的示例。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-12T20:24:02.830

void 应该是小写的。

像这样：

```
void 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T20:36:18.857

看起来（根据您的错误）您在这里有几个问题：

1.  ExternalInterface 在 AS3 中采用两个参数，而不是三个
2.  “无效”在 AS3 中应该是“无效”

所以假设你的 JavaScript 代码是这样的：

```
function myJSFunction()
{
    myFlashObject.asFunc("Hello!");
}

function calc(s)
{
    // ...
} 
```

...您相应的 ActionScript 3 代码应该看起来更像这样：

```
import flash.external.ExternalInterface; 

function myInitializationHandler():void
{   
    ExternalInterface.addCallback("asFunc", asFunc); 
    myFlexButton.addEventListener(MouseEvent.CLICK, clickListener); 
}

function asFunc(str:String):void 
{ 
    //... 
}

function clickListener(event:MouseEvent):void 
{ 
    // ...
    ExternalInterface.call("calc", myFlexTextInput.text); 
} 
```

有道理？

# c# - 从所有网络适配器发送广播消息

> ID：436778
> 
> 赞同：8
> 
> 时间：2009-01-12T19:53:50.537
> 
> 标签：c#, .net, sockets

我有一个发送广播消息并侦听响应数据包的应用程序。下面是代码片段。

```
m_socket = new Socket(AddressFamily.InterNetwork, SocketType.Dgram, ProtocolType.Udp);
m_socket.SetSocketOption(SocketOptionLevel.Socket, SocketOptionName.Broadcast, 1);

m_socket.Bind(new IPEndPoint(IPAddress.Any, 2000));

m_socket.BeginSendTo(
                    buffer, 
                    0, 
                    buffer.Length, 
                    SocketFlags.None,
                    new IPEndPoint(IPAddress.Broadcast, 2000),
                    Callback), 
                    null
                    ); 
```

当我运行应用程序时，没有发送广播消息。在我的机器上，我有三个网络适配器。一个是我的本地网络适配器，另外两个是 VMWare 网络虚拟适配器。当我运行我的应用程序时，我可以看到（使用wireshark 网络捕获）广播消息是从VMWare 网络适配器之一发送的。

我想修改代码，以便从 pc 上的所有网络适配器发送广播消息。最好的方法是什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-12T20:28:33.587

您可以使用以下内容获取所有 IP 地址（以及更多）。因此，当您发送多播时，您可以遍历列表并绑定（如 Jon B 所说）到您想要的特定 IP。

```
foreach (var i in System.Net.NetworkInformation.NetworkInterface.GetAllNetworkInterfaces())
    foreach (var ua in i.GetIPProperties().UnicastAddresses)
        Console.WriteLine(ua.Address); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-12T20:08:23.407

当您调用 Bind() 时，您正在设置本地 IP 端点。不要使用 IPAddress.Any，而是使用您要从中发送的 NIC 的 IP 地址。您需要为每个 NIC 单独执行此操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T15:16:13.830

检查这个[http://salaam.codeplex.com/](http://salaam.codeplex.com/) 我和我的朋友开发了一个名为 Salaam 的类库。下载源代码或使用二进制文件 (.dll) 来使用它。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2010-09-12T07:34:16.750

您可以在构造 tcpListener 时使用 IPAddress.Any。这会将 tcp 侦听器绑定到所有接口

# authentication - SSO 最佳实践：无法访问 IDP 的解决方案是什么？

> ID：436796
> 
> 赞同：2
> 
> 时间：2009-01-12T19:59:24.347
> 
> 标签：authentication, login, single-sign-on, cas

这[是与一般 SSO best-practices 上的这个问题类似的内容](https://stackoverflow.com/questions/291874/best-practices-for-building-a-sso-system)。处理禁用或出于任何原因无法访问的中央身份提供者的最佳方法是什么。如果您的网站允许用户使用他们集中存储的凭据登录，而中央服务不工作或无法访问，您是否：

*   允许用户在本地站点上重新输入他们的凭据，以便他们可以使用 Web 应用程序（或内容管理系统或其他）的本机登录设施

*   允许用户请求他们可以在 Web 应用程序本身上使用的另一组辅助凭据（即，当 IDP 关闭时他们可以使用的单独密码）[注意：显然这违背了“单一凭据”的目标，只是抛弃了所有想法]。

*   允许用户使用相同凭据的多个不同维护者中的任何一个登录（通过向他们提供多个链接到多个提供者，然后尝试每个链接，直到其中一个真正连接并工作）

出于可能显而易见的原因，上述这些*解决方案*似乎都没有吸引力，因此在您使用最佳替代方法回答时，请随意将它们放在“最差实践”列表中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-12T21:03:11.503

我认为最好的方法是*分散*SSO，就像在 Open ID 中实现的那样。如果每个帐户可以有许多提供者，那么如果一个提供者出现故障，您可以故障转移到另一个提供者。

另一方面，如果需要集中式 SSO。我唯一能想到的就是让中央机构为每个用户生成一个加密证书。如果服务具有证书撤销列表的新副本和中央机构公钥的缓存副本，即使中央机构不可用，它也可以验证证书。不幸的是，这种方法可能会遇到可用性问题，因为用户既需要随身携带一份证书副本，又需要在您要求时知道您在说什么。

# c# - 有人可以使用 Amazon Web Services 的 itemsearch 提供一个 C# 示例吗

> ID：436801
> 
> 赞同：5
> 
> 时间：2009-01-12T20:00:12.567
> 
> 标签：c#, amazon, albumart

我正在尝试使用 Amazon Web Services 来查询艺术家和标题信息并接收专辑封面。使用 C# 我找不到任何与此类似的示例。所有在线示例都已过时，不适用于 AWS 的较新版本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-12T20:05:29.093

[CodePlex](http://www.codeplex.com/aws)上有一个开源项目，您可能想看看......它是亚马逊网络服务的 .NET 库。S3、SQS、FPS、EC2 和 DevPay

它可以像这样简单（如 codeplex 所示）：

```
S3Client s3 = new S3Client("myAWSKey", "MyAWSPassword");

bool success = s3.Connect();

S3Client s3 = new S3Client("key", "secret"):
var buckets = from b in s3.Buckets
                           where b.Name == "demo"
                           select b;
foreach(Bucket b in buckets)
{
     Console.WriteLine(b.About());
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T20:50:31.840

在这里你去看看它的价值。这是在 Asp.Net 控件中显示书籍信息的代码。您可能可以很容易地根据您的目的调整它。或者至少给你一个起点。如果您真的想要，我很乐意将控件捆绑起来并按照您的方式发送。

```
if (!(string.IsNullOrEmpty(ISBN) && string.IsNullOrEmpty(ASIN)))
{
    AWSECommerceService service = new AWSECommerceService();
    ItemLookup lookup = new ItemLookup();
    ItemLookupRequest request = new ItemLookupRequest();

    lookup.AssociateTag = ConfigurationManager.AppSettings["AssociatesTag"];
    lookup.AWSAccessKeyId = ConfigurationManager.AppSettings["AWSAccessKey"];
    if (string.IsNullOrEmpty(ASIN))
    {
        request.IdType = ItemLookupRequestIdType.ISBN;
        request.ItemId = new string[] { ISBN.Replace("-", "") };
    }
    else
    {
        request.IdType = ItemLookupRequestIdType.ASIN;
        request.ItemId = new string[] { ASIN };
    }
    request.ResponseGroup = ConfigurationManager.AppSettings["AWSResponseGroups"].Split(new char[] { ' ', ',', ';' }, StringSplitOptions.RemoveEmptyEntries);

    lookup.Request = new ItemLookupRequest[] { request };
    ItemLookupResponse response = service.ItemLookup(lookup);

    if (response.Items.Length > 0 && response.Items[0].Item.Length > 0)
    {
        Item item = response.Items[0].Item[0];
        if (item.MediumImage == null)
        {
            bookImageHyperlink.Visible = false;
        }
        else
        {
            bookImageHyperlink.ImageUrl = item.MediumImage.URL;
        }
        bookImageHyperlink.NavigateUrl = item.DetailPageURL;
        bookTitleHyperlink.Text = item.ItemAttributes.Title;
        bookTitleHyperlink.NavigateUrl = item.DetailPageURL;
        if (item.OfferSummary.LowestNewPrice == null)
        {
            if (item.OfferSummary.LowestUsedPrice == null)
            {
                priceHyperlink.Visible = false;
            }
            else
            {
                priceHyperlink.Text = string.Format("Buy used {0}", item.OfferSummary.LowestUsedPrice.FormattedPrice);
                priceHyperlink.NavigateUrl = item.DetailPageURL;
            }
        }
        else
        {
            priceHyperlink.Text = string.Format("Buy new {0}", item.OfferSummary.LowestNewPrice.FormattedPrice);
            priceHyperlink.NavigateUrl = item.DetailPageURL;
        }
        if (item.ItemAttributes.Author != null)
        {
            authorLabel.Text = string.Format("By {0}", string.Join(", ", item.ItemAttributes.Author));
        }
        else
        {
            authorLabel.Text = string.Format("By {0}", string.Join(", ", item.ItemAttributes.Creator.Select(c => c.Value).ToArray()));
        }
        ItemLink link = item.ItemLinks.Where(i => i.Description.Contains("Wishlist")).FirstOrDefault();
        if (link == null)
        {
            wishListHyperlink.Visible = false;
        }
        else
        {
            wishListHyperlink.NavigateUrl = link.URL;
        }
    }
} 
```

# c++ - 封装对象的生命周期管理

> ID：436804
> 
> 赞同：3
> 
> 时间：2009-01-12T20:02:30.207
> 
> 标签：c++, memory-management, encapsulation

封装对象和管理其生命周期的最佳方法是什么？示例：我有一个类*A*，它包含一个*B*类型的对象并**单独负责**它。

**解决方案 1**，克隆*b*对象以确保只有*A*能够清理它。

```
class A
{
    B *b;
public:
    A(B &b)
    {
        this->b = b.clone();
    }

    ~A()
    {
        delete b; // safe
    }
}; 
```

**解决方案2**，直接使用传递的对象，我们在这里冒着潜在的双重释放的风险。

```
class A
{
    B *b;
public:
    A(B *b)
    {
        this->b = b;
    }

    ~A()
    {
        delete b; // unsafe
    }
}; 
```

在我的实际情况下，解决方案＃2 最适合。但是我想知道这是否被认为是糟糕的代码，因为有人可能不知道*A*的行为，即使它已记录在案。我可以想到这些场景：

```
B *myB = new B();
A *myA = new A(myB);
delete myB; // myA contains a wild pointer now 
```

或者，

```
B *myB = new B();
A *firstA = new A(myB);
A *secondA = new A(myB); // bug! double assignment
delete firstA; // deletes myB, secondA contains a wild pointer now
delete secondA; // deletes myB again, double free 
```

如果我正确记录了 A 的行为，我可以忽略这些问题吗？声明责任并让其他人阅读文档就足够了吗？这是如何在您的代码库中管理的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-12T20:20:05.520

除非我真的必须这样做，否则我自己从不删除任何东西。这会导致错误。

智能指针是您的朋友。 `std::auto_ptr<>`当一个对象拥有另一个对象并负责在超出范围时将其删除时，它是您的朋友。 `boost::shared_ptr<>`（或者，现在，`std::tr1::shared_ptr<>`）是您的朋友，当可能有多个对象附加到另一个对象时，并且您希望在不再引用该对象时删除该对象。

因此，要么将解决方案 1 与 一起使用`auto_ptr`，要么将解决方案 2 与`shared_ptr`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-12T20:28:13.353

您应该定义您的对象，以便所有权语义尽可能由接口定义。正如 David Thornley 所指出的， std::auto_ptr 是表示*所有权转移*的智能指针。像这样定义你的类：

```
class A
{    
    std::auto_ptr<B> b;
public:    
    A(std::auto_ptr<B> b)    
    {
        this->b = b;
    }
    // Don't need to define this for this scenario
    //~A()
    //{ 
    //   delete b; // safe
    //}
}; 
```

由于 std::auto_ptr 的约定是赋值 = 所有权转移，因此您的构造函数现在隐式声明 A 对象拥有指向它传递的 B 的指针的所有权。实际上，如果客户端*尝试*使用他们在构造后用来构造 A 的 std::auto_ptr<B> 做某事，则操作将失败，因为它们持有的指针将无效。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-12T20:11:42.997

如果您正在编写其他人稍后将使用的代码，则必须解决这些问题。在这种情况下，我会选择简单的引用计数（可能使用智能指针）。考虑以下示例：

当封装类的一个实例被分配一个对象 B 时，它调用一个方法来增加对象的 B 引用计数器。当封装类被销毁时，它不会删除B，而是调用一个方法来减少引用计数。当计数器达到零时，对象 B 被销毁（或就此而言自毁）。这样，封装类的多个实例可以与对象 B 的单个实例一起工作。

有关该主题的更多信息：[引用计数](http://en.wikipedia.org/wiki/Reference_counting)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-12T20:16:12.487

如果您的对象对传递的对象负全部责任，那么删除它应该是安全的。如果它不安全，那么您全权负责的断言是错误的。那么它是哪一个？如果您的接口记录了您将删除入站对象，那么调用者有责任确保您收到必须由您删除的对象。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-12T20:14:12.350

如果您正在克隆 A，并且 A1 和 A2 都保留对 B 的引用，则 B 的生命周期并非完全由 A 控制。它在各个 A 之间共享。克隆 B 可确保 As 和 B 之间的一对一关系，这将很容易确保生命周期的一致性。

如果克隆 B 不是一种选择，那么您需要放弃 A 负责 B 的生命周期的概念。要么是另一个对象需要管理各种 B，要么你需要实现像引用计数这样的方法。

作为参考，当我想到“克隆”一词时，它意味着一个深拷贝，它也将克隆 B。我希望这两个 As 在克隆后完全分离。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-12T20:15:33.050

我不会不必要地克隆东西或“只是为了安全”。

相反，我知道删除某些东西是谁的责任：要么通过文档，要么通过智能指针......例如，如果我有一个`create`函数实例化某些东西并返回指向它的指针并且不删除它，所以不清楚该东西应该在哪里以及由谁来删除，那么我可以将' 返回类型定义为返回包含在某种智能指针中的指针，而不是`create`' 返回一个裸指针。`create`

# silverlight-2.0 - 向列表和画布添加一行

> ID：436806
> 
> 赞同：0
> 
> 时间：2009-01-12T20:04:02.510
> 
> 标签：silverlight-2.0

我目前正在尝试向画布和自定义对象添加常规线条形状。我没有收到错误，但该行未添加到画布中

相关的代码如下

```
lh = new LineHolder();
Line lnx = new Line();

lnx.StrokeThickness = 1;

MainCan.Children.Add(lnx);

lh.MainLiner = lnx;
lstLH.Add(lh); 
```

lstLH 是 LineHolder 对象的列表。

有没有人遇到过这样的事情？它似乎不喜欢被添加到两个实体中。

谢谢~史蒂夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-12T20:07:51.943

我可能需要指定要添加的孩子的 Top 和 Left 属性？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-13T00:59:49.653

我认为 Micah 是在正确的轨道上——除了你需要设置的 Line 上的大多数属性是 X1、Y1、X2、Y2——即线的每一端的坐标。如果这不起作用，我建议也设置 Fill 属性。

我不认为将线添加到您自己的对象是这里的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-13T15:29:44.343

我尝试设置 X 和 Y 坐标，并得到相同的结果。我确实将坐标匹配放在了第二个函数中（它执行了两次），并在将线条添加到画布后用计时器调用它，这出于某种未知原因而起作用。

# language-agnostic - 您避免关键字命名冲突的系统是什么？

> ID：436807
> 
> 赞同：4
> 
> 时间：2009-01-12T20:04:49.717
> 
> 标签：language-agnostic, naming-conventions, keyword

通常，语言的关键字无法直接使用完全相同的拼写和大小写来命名程序中的事物（变量、函数、类...）。然而，有时关键字是命名某事物的唯一自然选择。在您选择的技术中，您避免/解决这种冲突的系统是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-12T20:08:45.403

我只是避免名字，通常。找到一个不同的名称或稍微更改它 - 例如`clazz`，而不是`class`在 C# 或 Java 中。在 C# 中，您*可以*使用 @ 前缀，但这很可怕：

```
int @int = 5; // Ick! 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-12T20:29:14.630

关键字本质上并没有包罗万象，因为它应该阻止您命名变量。由于所有名称在某种程度上都只是某种类型的概括实例，因此您始终可以在抽象中上下移动以找到另一个有用的名称。

例如，如果您编写了一个跟踪学生的系统，并且您想要一个对象来代表他们在特定领域的学习，即他们在某方面上过“课”，如果您不能直接使用该术语或复数形式“classes”，或类似“studies”的替代词，您可能会发现更“实例化”的变体：studentClass、currentClass 等或更高的视角：“courses”、“courseClass”或特定类型属性：dailyClass、nightClass、等等

很多选项，你应该只喜欢最简单和最明显的一个，仅此而已。

我总是喜欢听用户说话，因为他们的语言范围有助于定义问题的范围，通常如果你听足够长的时间，你会发现他们对相同的底层事物有许多多个术语（只有细微的差别） . 他们通常有答案...

保罗。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-12T20:14:27.513

我的系统是不使用关键字期间！

如果我有一个函数/变量/类，并且用关键字命名它似乎是合乎逻辑的，我将在关键字前面使用一个描述性的词。

（形容词名词）格式。即：personName 而不是 Name，其中“Name”是关键字。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-12T20:15:25.733

我只是使用一个更具描述性的名称。例如，“id”变成标识符，“string”变成“descriptionString”，等等。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-12T20:19:08.597

在 Python 中，我通常在模块上使用正确的命名空间以避免名称冲突。

```
import re
re.compile() 
```

代替：

```
from re import *
compile() 
```

有时，当我无法避免关键字名称冲突时，我只是将变量名称的最后一个字母去掉。

```
for fil in files:
    pass 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-12T20:15:11.100

如前所述，要么在 Java/C# 中将类更改为 clazz，要么使用一些下划线作为前缀，例如

```
int _int = 0; 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-12T20:26:15.197

没有理由使用关键字作为变量名。要么使用更详细的词，要么使用同义词库。将单词的某些字母大写以使其与关键字不完全相同，这对以后继承您的代码的人没有多大帮助。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-12T20:29:44.473

快乐那些没有任何关键字的语言......

但别开玩笑了，我认为在“但有时关键字是命名某事物的唯一自然选择”的情况很少见。你可以通过在它前面加上“my”、“do”、“_”或类似的前缀来相处。

老实说，我真的想不出很多这样的例子，其中关键字本身就是一个好名字（“int”，“for”和“if”无论如何肯定是坏的）。C 语言家族中仅有的几个可能有意义的是“continue”（让它成为“doContinue”）、“break”（“breakWhenEOFIsreached”或类似的东西怎么样？）和已经提到的“class”（“classOfThingy”怎么样？ “？）。

换句话说：使名称更合理。永远记住：代码只写一次，但通常要经常阅读。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-12T20:42:55.647

通常我遵循匈牙利符号。因此，如果出于某种原因，我想将“End”用作整数类型的变量，我会将其声明为“iEnd”。字符串将是“strEnd”等。这通常给我一些变量的空间。

如果我正在处理一个其他人只会看到我所做的特定个人项目，例如，在使用 UnrealEngine 为游戏制作插件时，我可能会在名称中的某处使用我的首字母。'DS_iEnd' 也许。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-12T21:04:32.733

我为每种语言编写了我自己的 [vim] 语法荧光笔，并且我给所有关键字一个明显的颜色，以便我在编码时注意到它们。像 PHP 和 Perl 这样的语言使用`$`变量，使其成为非问题。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-12T21:11:13.920

在 Ruby on Rails 中进行开发 我有时会查找这个[保留字列表](http://wiki.rubyonrails.org/rails/pages/ReservedWords)。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-12T21:15:35.080

在 15 年的编程生涯中，我很少遇到这个问题。

我可以立即想到的一个地方可能是一个 css 类，在这种情况下，我会使用一个更具描述性的名称。因此，我可能会使用“targetClass”或类似的东西来代替“class”。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-12T21:38:20.417

在python中，普遍接受的方法是附加一个'_'

```
class -> class_
or -> or_
and -> and_ 
```

[您可以在操作员](http://docs.python.org/library/operator.html)模块中看到这一点。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-03-26T15:32:30.203

我切换到一种完全不限制标识符名称的语言。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2011-11-09T19:47:38.870

首先，大多数代码约定都阻止了这种事情的发生。

如果没有，我通常会添加一个描述性的散文前缀或后缀：

```
the_class or theClass infix_or (prefix_or(class_param, in_class) , a_class) or_postfix 
```

一种实践，通常与您可以找到的所有代码样式建议保持一致（“长名称不会杀死”，“更长的变量名称不会占用更多内存空间，我保证。”）通常，如果您认为关键字是最好的描述，稍微差一点会更好。

请注意，在您提出问题的前提下，您引入了歧义，这对读者不利，无论是编译器还是人类。即使使用 class、clazz 或 klass 是一种习惯，即使这种习惯不习惯以至于它是一种习惯：它需要一个单词 word，尽管单词可能是精确的描述性，然后扭曲它，有效地射击 w0rd 在“wrd”。习惯了另一种 w_Rd 约定或语言的人可能会对您的 wolds 有一些苛刻的字眼。

我们大多数人比“花”、“房子”或“汽车”要说的更多，所以通常有更多关于 typeNames、decoratees、class_params、BaseClasses 和 typeReferences 的说法。

这是我个人的代码混淆容忍度结束的地方：

**Never(!!!)**依靠范围或神秘的语法规则来防止名称与“关键字”发生冲突。（不知道任何允许这样做的编译器，但是，这些天，你永远不知道......）。

尝试一下，有人会在 wörd 中与您联系，所以 __rd，Word 对您来说看起来像 TeX！

* * *

## 回答 #16

> 赞同：-2
> 
> 时间：2009-01-12T20:14:39.930

我在 Java 中的系统是将单词的第二个字母大写，例如：

```
 int dEfault;
 boolean tRansient;
 Class cLass; 
```

# sql - SQL Server 2000 - “实际行数”到底是什么？

> ID：436816
> 
> 赞同：2
> 
> 时间：2009-01-12T20:08:39.897
> 
> 标签：sql, sql-server, performance

我有一个 SQL Server 2000 查询，它执行聚集索引扫描并显示大量行。对于我有 260.000 条记录的表，计划执行中显示的实际行数是...... 34.000.000。

这有意义吗？我有什么误解？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-12T20:09:17.650

执行计划上显示的值是基于统计的估计值。普通查询如：

```
SELECT COUNT(*) FROM Table 
```

对您的交易 100% 准确*。

这是一个[相关的问题](https://stackoverflow.com/questions/93150/sql-server-post-join-rowcount-underestimate)。

*边缘情况可能因事务隔离级别而异。

* * *

有关统计数据的更多信息：

*   [更新统计信息](http://msdn.microsoft.com/en-us/library/ms187348.aspx)
*   [多久和如何（维护计划++）](https://stackoverflow.com/questions/131116/how-often-do-you-update-statistics-in-sql-server-2000)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-14T14:19:43.580

但是……如果是“**实际**行数”……为什么要基于统计数据？

我假设在构建查询计划时使用了**估计**行数（并从当时的统计数据中收集），而实际行数是在查询执行后添加的一些额外信息，用于用户调试和调整目的？

这不是吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-12T20:24:23.157

如果您的行数超出查询计划，则需要更新统计信息，否则查询优化器可能会选择错误的计划。此外，聚集索引扫描几乎就像表扫描......尝试修复索引，以便获得聚集索引查找或至少索引查找。

# latex - 如何在使用 LaTeX 的数学模式下指示破折号？

> ID：436823
> 
> 赞同：48
> 
> 时间：2009-01-12T20:10:08.397
> 
> 标签：latex

LaTeX 中有四种“破折号”：连字符、破折号(--)、破折号(---) 和减号$-$。它们分别用于连字和连接词，表示范围、标点符号和数学符号。我的问题是：如何在数学模式下指示短划线（范围）？（如`$S=1 to 2$`）？我是否必须在“方程式”中间退出数学模式（`$S=1$--$2$)`？或者有一个符号我可以使用并保持数学模式吗？我试过`$S=1\--2$`了，但这给了我一个减号，而不是一个破折号，并`$S=1--2$`给出两个缺点。我的猜测是我将不得不退出数学模式，但也许有一种方法可以做到这一点。

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2009-01-12T20:41:05.323

最简单的方法是使用`$S=1\mbox{--}2$`. `\usepackage{amsmath}`但是，如果您在文档的序言中已经有了，最好使用`\text`:`$S=1\text{--}2$`因为`\text`在上标和下标中使用时会调整字体的大小：`$S_{1\text{--}2}=0$`。

数学中使用的破折号很容易与减号混淆。您可能想查看其他用于指示范围的技术，例如省略号（`\ldots`用于基线上的点 [用于逗号之间]，或`\cdots`用于中心点 [用于中心运算符之间，例如加号]）或使用括号表示法。一些例子：

```
$S = \{1, 2, \ldots, n\}$ indicates an element in the set containing integers between 1 and $n$.
$S = [0, 1]$ indicates a real number between 0 and 1 (inclusive). 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-13T20:04:54.663

您可以使用`\textrm`which 不依赖于`\usepackage{amsmath}`. 一些例子：

```
$S=1\textrm{--}2$
$S_{1\textrm{--}2}=0$ % correctly changes the font size for subscript
$S_{1\textrm{2}2}=0$  % does not change the font size :( 
```

或者也许使用`\textnormal`而不是`\textrm`. 另见[LaTeX：在 math 中使用 \textnormal 而不是 \textrm （或 \textsf）](http://stefaanlippens.net/textnormal/)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-12T20:19:03.353

好吧，您可以使用`$1\mbox{--}2$`，但我会查看符号列表中的数学符号[列表](http://www.ctan.org/tex-archive/info/symbols/comprehensive/symbols-a4.pdf)。唔。我没有找到。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-03-16T05:42:31.693

使用`\leftrightline`包[MnSymbol](https://ctan.org/pkg/mnsymbol)中的命令。我不知道这是否是您的目的所需的长度，但希望它能起到作用。

# openid - 您如何将您的 OpenId 委托给 Google Apps

> ID：436829
> 
> 赞同：28
> 
> 时间：2009-01-12T20:11:39.750
> 
> 标签：openid, google-apps

我将 Google Apps 用于我的域电子邮件，我想知道是否可以将该帐户用于 OpenID，而不是常规的 Gmail 帐户。

我知道我可以使用以下方法将 Openid 委托给其他 URL：

```
<link rel="openid.server" href="http://www.myopenid.com/server" />
<link rel="openid.delegate" href="http://samruby.myopenid.com/" /> 
```

但我找不到适合 Google 的 URL。

谢谢

-马修

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-07-30T05:00:13.860

Google 最近（大约一个小时前）宣布了对 Google Apps 客户的 OpenID 支持。

查看[Google Groups 上的发现协议](http://groups.google.com/group/google-federated-login-api/web/openid-discovery-for-hosted-domains)。应该是一个好的开始。

我相信端点是 ht tps://www.google.com/accounts/o8/site-xrds?hd= **your-domain.com**

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-30T21:02:34.767

您可以在您的 Google Apps 域中运行您自己的 openid 服务器（使用 GAE） - Google 提供了 openid 服务器的示例代码。我最近将它移植到最新的 OpenID 库，所以现在它与 Openid 2.0 兼容。项目页面：[http ://code.google.com/p/appengine-openid-provider/](http://code.google.com/p/appengine-openid-provider/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-12T20:35:10.873

MyOpenID.com[确实在您自己的域上提供 openid](https://www.myopenid.com/product_domains)。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-10-01T04:54:57.880

对于 OpenId2，我目前在我的网站上有这个

```
<link rel="openid2.provider" href="https://www.google.com/accounts/o8/ud" /> 
```

因为它是唯一需要的。由于我现在作为我的默认 Google 帐户登录到 Google Apps。OpenID 消费者（此时主要是 Stack Exchange 站点）使用该帐户（我从 google 收到一条消息，询问该站点是否可以使用该 google 帐户。

这不会像您使用非谷歌应用程序帐户那样强制使用谷歌应用程序帐户（除了上面的提供程序）

```
<link rel="openid2.local_id" href="http://www.google.com/profiles/YOURGOOGLEPROFILE" /> 
```

但它确实允许我使用我的谷歌应用程序帐户，因为它是我当前登录的帐户。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-12T20:23:18.573

我的理解是 Google 没有公开该服务器 url，因此使该技术无法用于 Google OpenID。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-24T00:32:20.080

他们说他们会在未来，但没有给出未来何时到来的任何线索。在 Google 群组中查看此主题[http://groups.google.com/group/google-federated-login-api/browse_thread/thread/19b33847210e5708](http://groups.google.com/group/google-federated-login-api/browse_thread/thread/19b33847210e5708)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-23T16:17:02.163

这是不可能的。

> 注意：OpenID 身份验证目前仅支持 Google 帐户，不支持 Google Apps（托管）帐户

© [http://code.google.com/apis/accounts/docs/OpenID.html](http://code.google.com/apis/accounts/docs/OpenID.html)

# visual-studio-2008 - 为什么我的控制台应用程序通过 setup.exe 运行？

> ID：436834
> 
> 赞同：0
> 
> 时间：2009-01-12T20:12:24.383
> 
> 标签：visual-studio-2008, console, installation

我究竟做错了什么？我在 VS08 中有一个简单的控制台应用程序。当我点击发布时，它会在目标文件夹中创建一个 setup.exe。当您运行 setup.exe 时，它​​会执行安装动作，但它也会运行应用程序，至少可以说这是不可取的。是否有我缺少的设置或什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-12T20:26:45.850

您正在创建 ClickOnce 安装程序。你不需要那个。只需从菜单中选择“项目”，然后选择“构建__”。`/bin/Debug/`这将在您的项目文件夹中的or下创建一个 *.exe 文件`/bin/Release/`。如果在 .Net 框架之外没有依赖项（例如额外的程序集 (dll) 或 app.config 文件），并且框架已经安装在将使用该应用程序的机器上，那么您可以通过以下方式分发 exe 文件本身。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-12T20:28:33.523

这是 ClickOnce 设置吗？也许您想创建一个“设置和部署”类型的单独项目来创建一个不启动您的应用程序的 MSI 安装程序？

从您的问题来看，实际上并不清楚您要做什么。您是想在目标系统上安装应用程序，还是只是想将其复制到某个文件夹然后执行它？

# generics - 将使用泛型的 java 5 代码转换为可以在 J2ME 设备上运行的代码？

> ID：436847
> 
> 赞同：3
> 
> 时间：2009-01-12T20:16:45.543
> 
> 标签：generics, java-me, java-5

是否有任何解决方案或工具可以将使用所有新 java 5 功能（泛型、自动装箱、可变参数、静态导入）的 java 5 代码转换为可以在 J2ME 设备上运行的代码？我对处理泛型特别感兴趣——其他特性很好但不是强制性的。

我需要源代码作为此转换的结果，因为这将使用自定义编译器进行编译。（我不能使用字节码操作（ala retroweaver））

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2009-01-12T23:12:06.547

使用常规 javac 编译并针对较旧的 JVM 至少可以为您提供适当的泛型字节码。

如果您确实需要源代码，尽管很奇怪，但可能可以编译为字节码，然后反编译回源代码。

# cocoa-touch - 使用按钮更改 iPhone 的方向

> ID：436849
> 
> 赞同：1
> 
> 时间：2009-01-12T20:17:04.233
> 
> 标签：cocoa-touch

有没有办法使用按钮更改 iPhone 的方向？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-12T20:19:44.977

不，翻转手机，方向改变。就这样吧，否则你会破坏手机的完整性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-12T20:27:30.890

有时我们需要以正确的方向显示我们的应用程序，即使没有直接的方法来做 domness 想要的事情，您也可以查看[这个 SO 条目](https://stackoverflow.com/questions/314382/how-to-force-a-screen-orientation-in-specific-view-controllers)并查看一些响应。

PS @domness，在发布新问题之前尝试搜索您需要的内容。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-12T21:28:24.727

你到底想重新定位什么？`UIApplication -setStatusBarOrientation:animated:`您可以使用;更改状态栏的位置 使用适当的转换重新排列您的 UI，您将拥有它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-12T21:13:04.430

您可以强制更改方向，但只能使用不受支持的私有 API。如果这是您希望 Apple 公开的内容，您应该[提交增强请求](http://bugreporter.apple.com)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-13T12:09:29.660

顺便说一句，这是我的新帐户..

是的，我通过将转换应用于单击按钮时想要显示的内容来进行排序。它是在滚动视图中显示一个带有应用动画的滚动视图。

# regex - 用正则表达式匹配不包含特定文本的行

> ID：436850
> 
> 赞同：10
> 
> 时间：2009-01-12T20:17:07.587
> 
> 标签：regex

我想用正则表达式做以下事情，但不知道该怎么做。我希望它匹配`one two`何时`one two`是行的开头，除非字符串包含`three`之后的任何位置`one two`。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-12T20:21:47.110

你需要一个[否定的前瞻断言](http://www.perl.com/doc/manual/html/pod/perlre.html#item__pattern_)——像这样：

```
/^one two(?!.*three)/m 
```

这是[一个关于前瞻/后瞻断言的教程](http://www.regular-expressions.info/lookaround.html)

注意：我添加了 'm' 修饰符，以便 ^ 匹配行的开头而不是整个字符串的开头。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-12T20:20:07.923

```
^one two(?!.*three) 
```

# java - 在 Java 对象中存储 MATLAB 结构

> ID：436852
> 
> 赞同：8
> 
> 时间：2009-01-12T20:18:02.547
> 
> 标签：java, matlab, hashmap

我在 MATLAB 中使用 Java HashMap

```
h = java.util.HashMap; 
```

虽然字符串、数组和矩阵可以无缝地使用它

```
h.put(5, 'test');

h.put(7, magic(4)); 
```

结构不

```
h=java.util.HashMap;
st.val = 7;
h.put(7, st);

??? No method 'put' with matching signature found for class 'java.util.HashMap'. 
```

**使它适用于结构的最简单/最优雅的方法是什么？**

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-12T23:02:48.843

您需要确保从 MATLAB 传递到 Java 的数据可以正确转换。有关将哪些类型转换为其他类型的转换矩阵，请参阅 MATLAB 的[外部接口文档。](http://www.mathworks.com/help/pdf_doc/matlab/apiext.pdf)

MATLAB 将大多数数据视为按值传递（具有句柄语义的类除外），并且似乎没有办法将结构包装在 Java 接口中。但是您可以使用另一个 HashMap 来充当结构，并将 MATLAB 结构转换为 HashMap（对于多级结构、函数句柄和其他不能很好地与 MATLAB/Java 数据转换过程配合使用的野兽有一个明显的警告） .

```
function hmap = struct2hashmap(S)
if ((~isstruct(S)) || (numel(S) ~= 1))
    error('struct2hashmap:invalid','%s',...
          'struct2hashmap only accepts single structures');
end

hmap = java.util.HashMap;
for fn = fieldnames(S)'
    % fn iterates through the field names of S
    % fn is a 1x1 cell array
    fn = fn{1};
    hmap.put(fn,getfield(S,fn));
end 
```

一个可能的用例：

```
>> M = java.util.HashMap;
>> M.put(1,'a');
>> M.put(2,33);
>> s = struct('a',37,'b',4,'c','bingo')

s = 

    a: 37
    b: 4
    c: 'bingo'

>> M.put(3,struct2hashmap(s));
>> M

M =

{3.0={a=37.0, c=bingo, b=4.0}, 1.0=a, 2.0=33.0}

>> 
```

（读者练习：将其更改为递归地为本身是结构的结构成员工作）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-03-02T18:07:21.577

Matlab R2008b 和更新版本有一个containers.Map 类，它在本机Matlab 数据类型上提供类似HashMap 的功能，因此它们可以处理结构、单元、用户定义的Matlab 对象等。

```
% Must initialize with a dummy value to allow numeric keys
m = containers.Map(0, 0, 'uniformValues',false);
% Remove dummy entry
m.remove(0);

m(5) = 'test';
m(7) = magic(4);
m(9) = struct('foo',42, 'bar',1:3);
m(5), m(7), m(9) % get values back out 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-12T20:40:27.867

我不熟悉 Java HashMaps，但是您可以尝试使用元胞数组而不是结构来存储数据吗？

```
h = java.util.HashMap;
carr = {7, 'hello'};
h.put(7, carr);

% OR

h = java.util.HashMap;
st.val = 7;
h.put(7, struct2cell(st)); 
```

# mysql - phpMyAdmin 使 MySQL 主机服务器崩溃

> ID：436864
> 
> 赞同：1
> 
> 时间：2009-01-12T20:20:16.050
> 
> 标签：mysql, crash, phpmyadmin, sysadmin

在过去的几天里，我遇到过几次这个问题。所以，它偶尔会发生。我在一台远程机器上设置了mysql，另一台机器上有一个java程序查询数据库每隔几秒读取和写入记录。

我正在使用 phpMyAdmin 来管理我的数据库。而且，有时，在运行一些 SQL 查询后，mysql 服务器会停止响应。即使 ping 主机也不成功。而且，我必须让可以物理访问机器的人再次启动它。

我检查了日志文件，但在 mysql 目录中找不到它们。默认情况下禁用日志记录吗？这里缺少什么？而且，我该如何解决这个问题？

编辑：一段时间后我能够ping服务器。所以，服务器一定是暂时繁忙。这不是一个特定的查询，而是诸如在浏览选项卡下连续重新排序表的数据之类的事情。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-12T21:37:20.187

使用 mysqlclient 建立连接并保持打开状态。我个人从命令行使用mysql。

如果服务器变得无响应执行

```
SHOW PROCESSLIST; 
```

它将列出所有 mysql 进程并显示查询等待/执行的时间。

可以选择使用 KILL 语句来终止锁定表的查询。

```
KILL $pid 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T21:15:28.420

我强烈建议使用 MySQL 自己的[GUI 工具](http://dev.mysql.com/downloads/gui-tools/5.0.html)进行数据库管理，原因有很多：

*   他们完全支持 InnoDB 表，包括外键管理
*   您可以使用数据库级别的安全性来确保只有您才能访问您的数据（与 phpMyAdmin 不同，它充其量只能是安装在 .htaccess 密码后面的 root 访问权限）
*   它是官方的并受支持。服务器上没有运行额外的二进制文件，因此您不会冒它崩溃并导致服务器停机的风险（除非您的查询本身将其锁定......）

# c# - 你能在 ASP.NET MVC 中重载控制器方法吗？

> ID：436866
> 
> 赞同：339
> 
> 时间：2009-01-12T20:20:20.870
> 
> 标签：c#, asp.net-mvc, overloading

我很想知道您是否可以在 ASP.NET MVC 中重载控制器方法。每当我尝试时，我都会收到以下错误。这两种方法接受不同的参数。这是不能做的事情吗？

> 当前对控制器类型“MyController”的操作“MyMethod”的请求在以下操作方法之间不明确：

* * *

## 回答 #1

> 赞同：207
> 
> 时间：2009-01-12T20:37:43.083

如果您希望代码进行重载，可以使用该属性。

```
[ActionName("MyOverloadedName")] 
```

但是，您必须为同一个 http 方法使用不同的操作名称（正如其他人所说）。所以这只是当时的语义。您宁愿在代码中使用名称还是在属性中使用名称？

Phil 有一篇与此相关的文章：http: [//haacked.com/archive/2008/08/29/how-a-method-becomes-an-action.aspx](http://haacked.com/archive/2008/08/29/how-a-method-becomes-an-action.aspx)

* * *

## 回答 #2

> 赞同：70
> 
> 时间：2009-01-12T20:33:55.463

是的。我已经能够通过将每个控制器方法的`HttpGet`/ `HttpPost`（或等效`AcceptVerbs`属性）设置为不同的东西来做到这一点，即`HttpGet`或`HttpPost`，但不能同时使用两者。这样它就可以根据请求的类型来判断使用哪种方法。

```
[HttpGet]
public ActionResult Show()
{
   ...
}

[HttpPost]
public ActionResult Show( string userName )
{
   ...
} 
```

我的一个建议是，对于这样的情况，应该有一个私有实现，你的两个公共 Action 方法都依赖它来避免重复代码。

* * *

## 回答 #3

> 赞同：44
> 
> 时间：2011-03-29T06:22:27.750

这是您可以做的其他事情......您想要一个能够有参数而不是没有参数的方法。

为什么不试试这个...

```
public ActionResult Show( string username = null )
{
   ...
} 
```

这对我有用......在这种方法中，您实际上可以测试是否有传入参数。

* * *

更新以删除字符串上无效的可为空语法并使用默认参数值。

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2014-11-27T23:48:25.570

不，不，不。去试试下面我们有“LoadCustomer”重载的控制器代码。

```
public class CustomerController : Controller
    {
        //
        // GET: /Customer/

        public ActionResult LoadCustomer()
        {
            return Content("LoadCustomer");
        }
        public ActionResult LoadCustomer(string str)
        {
            return Content("LoadCustomer with a string");
        }
    } 
```

如果您尝试调用“LoadCustomer”操作，您将收到如下图所示的错误。

![在此处输入图像描述](https://i.stack.imgur.com/Hvc7n.png)

多态性是 C# 编程的一部分，而 HTTP 是一种协议。HTTP 不理解多态性。HTTP 适用于概念或 URL，而 URL 只能具有唯一名称。所以HTTP没有实现多态。

为了解决同样的问题，我们需要使用“ActionName”属性。

```
public class CustomerController : Controller
    {
        //
        // GET: /Customer/

        public ActionResult LoadCustomer()
        {
            return Content("LoadCustomer");
        }

        [ActionName("LoadCustomerbyName")]
        public ActionResult LoadCustomer(string str)
        {
            return Content("LoadCustomer with a string");
        }
    } 
```

因此，现在如果您调用 URL“Customer/LoadCustomer”，将调用“LoadCustomer”操作，并使用 URL 结构“Customer/LoadCustomerByName”调用“LoadCustomer(string str)”。

![在此处输入图像描述](https://i.stack.imgur.com/rVByW.png)

![在此处输入图像描述](https://i.stack.imgur.com/1Tu2N.png)

我从这篇 codeproject 文章中得到的上述答案 --> [MVC Action 重载](http://www.codeproject.com/Articles/846403/Can-we-overload-MVC-controller-action-methods-MVC)

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2010-02-17T01:09:53.867

为了克服这个问题，您*可以*编写一个`ActionMethodSelectorAttribute`检查`MethodInfo`每个操作的方法并将其与发布的表单值进行比较，然后拒绝任何表单值不匹配的方法（当然不包括按钮名称）。

这是一个示例：- [http://blog.abodit.com/2010/02/asp-net-mvc-ambiguous-match/](http://blog.abodit.com/2010/02/asp-net-mvc-ambiguous-match/)

但是，这不是一个好主意。

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2009-01-12T20:33:28.723

据我所知，您只能在使用不同的 http 方法时使用相同的方法。

IE

```
[AcceptVerbs("GET")]
public ActionResult MyAction()
{

}

[AcceptVerbs("POST")]
public ActionResult MyAction(FormResult fm)
{

} 
```

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2015-06-03T09:32:36.560

我在 MVC5中的[属性路由的帮助下实现了这一点。](http://blogs.msdn.com/b/webdev/archive/2013/10/17/attribute-routing-in-asp-net-mvc-5.aspx)诚然，我是使用 WebForms 进行 Web 开发十年的新手，但以下内容对我有用。与公认的答案不同，这允许所有重载的动作由同一个视图文件呈现。

首先在 App_Start/RouteConfig.cs 中启用属性路由。

```
public class RouteConfig
{
    public static void RegisterRoutes(RouteCollection routes)
    {
        routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

        routes.MapMvcAttributeRoutes();

        routes.MapRoute(
            name: "Default",
            url: "{controller}/{action}/{id}",
            defaults: new { controller = "Home", action = "Index", id = UrlParameter.Optional }
        );            
    }
} 
```

可以选择使用默认路由前缀装饰您的控制器类。

```
[RoutePrefix("Returns")]
public class ReturnsController : BaseController
{
    //....... 
```

然后用一个共同的路线和参数来装饰你的控制器动作，这些动作相互过载。使用类型约束参数，您可以使用具有不同类型 ID 的相同 URI 格式。

```
[HttpGet]
// Returns
public ActionResult Index()
{
    //.....
}

[HttpGet]
[Route("View")]
// Returns/View
public ActionResult View()
{
    // I wouldn't really do this but it proves the concept.
    int id = 7026;
    return View(id);
}

[HttpGet]
[Route("View/{id:int}")]
// Returns/View/7003
public ActionResult View(int id)
{
    //.....
}

[HttpGet]
[Route("View/{id:Guid}")]
// Returns/View/99300046-0ba4-47db-81bf-ba6e3ac3cf01
public ActionResult View(Guid id)
{
    //.....
} 
```

希望这会有所帮助，并且不会导致某人走错路。:-)

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2012-12-03T14:18:52.963

您可以使用单个`ActionResult`来处理`Post`和`Get`：

```
public ActionResult Example() {
   if (Request.HttpMethod.ToUpperInvariant() == "GET") {
    // GET
   }
   else if (Request.HttpMethod.ToUpperInvariant() == "POST") {
     // Post  
   }
} 
```

如果您的`Get`和`Post`方法具有匹配的签名，则很有用。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2016-02-04T17:10:11.923

我刚刚遇到这个问题，尽管它现在已经很老了，但它仍然非常相关。具有讽刺意味的是，该线程中的一个正确评论是由一位自认是 MVC 初学者在撰写帖子时发布的。甚至 ASP.NET 文档也不完全正确。我有一个大项目，我成功地重载了动作方法。

如果人们理解路由，除了简单的 {controller}/{action}/{id} 默认路由模式之外，很明显控制器操作可以使用任何独特的模式进行映射。这里有人谈及多态，说：“HTTP 不懂多态”，但路由与 HTTP 无关。简单地说，它是一种字符串模式匹配的机制。

完成这项工作的最佳方法是使用路由属性，例如：

```
[RoutePrefix("cars/{country:length(3)}")]
public class CarHireController
{
    [Route("{location}/{page:int=1}", Name = "CarHireLocation")]
    public ActionResult Index(string country, string location, int page)
    {
        return Index(country, location, null, page);
    }

    [Route("{location}/{subLocation}/{page:int=1}", Name = "CarHireSubLocation")]
    public ActionResult Index(string country, string location, string subLocation, int page)
    {
        //The main work goes here
    }
} 
```

这些操作将处理 和 之类的 url `/cars/usa/new-york`，`/cars/usa/texas/dallas`它们将分别映射到第一个和第二个 Index 操作。

检查这个示例控制器很明显，它超出了上面提到的默认路由模式。如果您的 url 结构与您的代码命名约定完全匹配，则默认设置效果很好，但情况并非总是如此。代码应该是对域的描述，但 url 通常需要更进一步，因为它们的内容应该基于其他标准，例如 SEO 要求。

默认路由模式的好处是它会自动创建唯一的路由。这是由编译器强制执行的，因为 url 将匹配唯一的控制器类型和成员。滚动您自己的路线模式需要仔细考虑以确保唯一性并且它们有效。

**重要说明**一个缺点是使用路由为重载操作生成 url 在基于操作名称时不起作用，例如，在使用 UrlHelper.Action 时。但如果使用命名路由，例如 UrlHelper.RouteUrl，它确实有效。根据备受推崇的消息来源，使用命名路由是无论如何都要走的路（[http://haacked.com/archive/2010/11/21/named-routes-to-the-rescue.aspx/](http://haacked.com/archive/2010/11/21/named-routes-to-the-rescue.aspx/)）。

祝你好运！

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2017-07-15T09:26:49.643

您可以使用 [ActionName("NewActionName")] 来使用具有不同名称的相同方法：

```
public class HomeController : Controller
{
    public ActionResult GetEmpName()
    {
        return Content("This is the test Message");
    }

    [ActionName("GetEmpWithCode")]
    public ActionResult GetEmpName(string EmpCode)
    {
        return Content("This is the test Messagewith Overloaded");
    }
} 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2013-06-10T21:57:00.233

我需要一个重载：

```
public ActionResult Index(string i);
public ActionResult Index(int groupId, int itemId); 
```

我最终这样做的论据很少：

```
public ActionResult Index(string i, int? groupId, int? itemId)
{
    if (!string.IsNullOrWhitespace(i))
    {
        // parse i for the id
    }
    else if (groupId.HasValue && itemId.HasValue)
    {
        // use groupId and itemId for the id
    }
} 
```

这不是一个完美的解决方案，特别是如果你有很多争论，但它对我来说效果很好。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2016-05-27T11:43:29.350

我在我的申请中也遇到了同样的问题。在没有修改任何方法信息的情况下，我在动作头上提供了 [ActionName("SomeMeaningfulName")]。问题解决了

```
[ActionName("_EmployeeDetailsByModel")]
        public PartialViewResult _EmployeeDetails(Employee model)
        {
            // Some Operation                
                return PartialView(model);
            }
        }

[ActionName("_EmployeeDetailsByModelWithPagination")]
        public PartialViewResult _EmployeeDetails(Employee model,int Page,int PageSize)
        {

                // Some Operation
                return PartialView(model);

        } 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2012-02-28T14:40:51.077

将基本方法创建为虚拟

```
public virtual ActionResult Index() 
```

创建被覆盖的方法作为覆盖

```
public override ActionResult Index() 
```

编辑：这显然只适用于重写方法在派生类中，而派生类似乎不是 OP 的意图。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2013-07-02T11:52:01.610

我喜欢在另一个帖子中发布的这个答案

这主要用于如果您从另一个控制器继承并希望覆盖来自基本控制器的操作

[ASP.NET MVC - 用不同的参数覆盖一个动作](https://stackoverflow.com/questions/3890359/asp-net-mvc-overriding-an-action-with-differing-parameters)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2017-08-28T13:59:20.657

每个控制器方法只允许一个公共签名。如果您尝试重载它，它会编译，但您会遇到您遇到的运行时错误。

如果您不愿意使用不同的动词（如`[HttpGet]`and`[HttpPost]`属性）来区分重载方法（这将起作用）或更改路由，那么剩下的就是您可以提供另一个名称不同的方法，或者您可以在现有方法中调度。我是这样做的：

我曾经遇到过必须保持向后兼容性的情况。原始方法需要两个参数，但新方法只有一个。以我预期的方式重载不起作用，因为 MVC 不再找到入口点。

为了解决这个问题，我做了以下事情：

1.  将 2 个重载的操作方法从公共更改为私有
2.  创建了一个包含“仅”2 个字符串参数的新公共方法。那个充当调度员，即：

    ```
    public ActionResult DoSomething(string param1, string param2)
    {
        if (string.IsNullOrEmpty(param2))
        {
            return DoSomething(ProductName: param1);
        }
        else
        {
            int oldId = int.Parse(param1);
            return DoSomething(OldParam: param1, OldId: oldId);
        }
    }

    private ActionResult DoSomething(string OldParam, int OldId)
    {
        // some code here
        return Json(result);
    }

    private ActionResult DoSomething(string ProductName)
    {
        // some code here
        return Json(result);
    } 
    ```

当然，这是一个 hack，应该稍后重构。但就目前而言，它对我有用。

您还可以创建一个调度程序，如：

```
public ActionResult DoSomething(string action, string param1, string param2)
{
    switch (action)
    {
        case "update":
            return UpdateAction(param1, param2);
        case "remove":
            return DeleteAction(param1);
    }
} 
```

可以看到，UpdateAction 需要 2 个参数，而 DeleteAction 只需要一个。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2019-07-25T12:35:44.800

抱歉耽搁了。我遇到了同样的问题，我找到了一个很好答案的链接，这对新人有帮助吗

**BinaryIntellect 网站和作者的所有学分**

基本上有四种情况：*使用不同的动词*，*使用路由*，*使用[NoAction]属性重载标记和*使用*[ActionName]更改动作属性名称*

所以，这取决于你的要求和你的情况。

但是，请点击链接：

链接： http: [//www.binaryintellect.net/articles/8f9d9a8f-7abf-4df6-be8a-9895882ab562.aspx](http://www.binaryintellect.net/articles/8f9d9a8f-7abf-4df6-be8a-9895882ab562.aspx)

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2021-05-27T12:03:31.093

1.  对于那些在同一问题上苦苦挣扎的人来说，这个答案。您可以基于 ActionMethodSelectorAttribute 实现自己的自定义过滤器。[在这里](https://stackoverflow.com/a/58740687/9744434)，我找到了解决您问题的最佳解决方案。在 .net 5 项目上运行良好。

2.  如果您尝试实现与 Web api 控制器中相同的逻辑，请使用 Microsoft.AspNetCore.Mvc.WebApiCompatShim。此 nuget 包提供 ASP.NET Core MVC 与 ASP.NET Web API 2 的兼容性，以简化现有 Web API 实现的迁移。请检查[此答案](https://stackoverflow.com/a/47920194/9744434)，但请考虑从 ASP.NET Core 3.0 开始，Microsoft.AspNetCore.Mvc.WebApiCompatShim 包不再可用。

* * *

## 回答 #18

> 赞同：-1
> 
> 时间：2016-09-12T16:19:58.380

如果这是尝试对多个视图使用一个 GET 操作，这些视图 POST 到具有不同模型的多个操作，则尝试为每个重定向到第一个 GET 的 POST 操作添加一个 GET 操作，以防止刷新时出现 404。

远射但常见的场景。

# networking - 从交换机嗅探数据

> ID：436867
> 
> 赞同：4
> 
> 时间：2009-01-12T20:20:47.440
> 
> 标签：networking, ethernet

我有 2 个通过以太网相互通信的网络设备。我想使用 Wireshark 嗅探流量。但是这些设备正在通过一个开关。交换机仅将流量路由到需要数据的端口。

在另一个位置，我有一个集线器。所有流量都在所有端口上重复。

有没有办法告诉交换机也将流量发送到我的端口？

编辑：这是一个非托管交换机。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-12T20:51:59.653

您可能想研究 ARP 欺骗。 [http://en.wikipedia.org/wiki/ARP_poisoning](http://en.wikipedia.org/wiki/ARP_poisoning)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T20:33:09.583

由于这是一个非托管交换机，我能想到的唯一方法是在交换机和您要监控的设备之一之间临时放置一个集线器，然后将笔记本电脑插入该集线器进行监控。笔记本电脑现在应该可以看到设备和交换机之间的所有流量。

这很容易，因为您可以在其中一台设备的位置进行操作。您只需要一个集线器、两根 CAT 电缆和您用来监控的计算机。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-12T20:25:00.440

如果交换机是托管交换机，则它可能具有像集线器一样的模式。请注意不要那样离开它。

有些还会有镜像端口等的方法。你需要弄清楚它是什么类型的开关。

重新编辑：如果它是不受管理的，那么你就是骨头。在受影响的计算机上使用集线器、托管交换机或运行 wireshark。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-12T20:25:53.963

交换机可能有一个管理界面，可以让您执行此操作。请注意，如果这样做，您将破坏交换机的性能，因为连接到它的所有东西现在都必须处理碰撞。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-13T17:56:25.873

You could try a port redirector, like [this one](http://www.nsauditor.com/docs/html/tools/Tcp%20Port%20Redirector.htm). You would configure one device to talk to your computer instead of the other device, and the redirector will send the data to the real target. There are several programs like this out there, or you could write your own.

# xml - 您对 Microsoft Oslo MGraph 感觉如何？

> ID：436870
> 
> 赞同：2
> 
> 时间：2009-01-12T20:21:08.797
> 
> 标签：xml, json, oslo

MGraph 是微软“奥斯陆”带来的一种很棒的文本数据格式。

您认为它有机会像今天的 XML 一样广泛吗？

示例（谷歌地理编码）：

```
{  
  name = "waltrop, lehmstr 1d",  
  Status {  
    code = 200,  
    request: "geocode"  
  },  
  Placemark [  
    {  
      id = "p1",  
      address = "Lehmstraße, 45731 Waltrop, Deutschland",  
      AddressDetails { Country {CountryNameCode = "DE", CountryName = "Deutschland", AdministrativeArea { AdministrativeAreaName = "Nordrhein-Westfalen", SubAdministrativeArea = { SubAdministrativeAreaName = "Recklinghausen", Locality { LocalityName = "Waltrop", Thoroughfare { ThoroughfareName = "Lehmstraße" }, PostalCode = { PostalCodeNumber = "45731" }}}}}, Accuracy = 6 },  
      ExtendedData {  
        LatLonBox {  
          north = 51.6244226,  
          south = 51.6181274,  
          east = 7.4046111,  
          west = 7.3983159  
        }  
      },  
      Point {  
        coordinates [ 7.4013350, 51.6212620, 0 ]  
      }  
    }  
  ]  
} 
```

此处的模式信息：[Microsoft "Oslo" MGraph - 下一个 XML？](http://startbigthinksmall.wordpress.com/2008/12/10/mgraph-the-next-xml/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-12T21:04:52.903

**以下是[James Clark 对 M 的部分看法](http://blog.jclark.com/2008/11/some-thoughts-on-oslo-modeling-language.html)**：

一个好的建模语言需要以一流的方式支持有序和无序的数据。这个问题可能是最根本的，因为它会影响数据模型。

M 似乎弱的另一个领域是身份。在抽象数据模型中，实体具有独立于其字段值的身份。但是类型系统通过创建复制实体固有身份的人工字段，迫使我以类似 SQL 的方式谈论身份。更糟糕的是，身份范围是范围，它们是平面表。与此相关的是对层次结构的支持。图是比树更通用的数据模型，所以我很高兴有图而不是树。但是当我在处理树时，我希望能够说图是一棵树（相当于指定了对图中节点身份的约束），并且我希望能够将其作为一棵树来操作，特别是我想要分层路径。

XML 的优势之一是它可以同时处理文档和数据。这很重要，因为世界并没有整齐地划分为文档和数据。您有包含文档的数据和包含数据的文档。对文档进行清晰建模所需的关键是混合文本。您将如何支持 M 中的文档？缺乏对 order 的支持是这里的一个主要问题，因为有序是文档的规范。

一个相关的问题是 M 和 XML 如何结合在一起。我相信有一种将 M 值表示为 XML 文档的规范方法。但是，如果您有 XML 格式的数据，您如何用 M 表示它？在许多情况下，您需要将 XML 结构转换为 M 结构，以便对数据进行清晰的建模。但是您可能并不总是想花时间来做这件事，而且如果您的 XML 有类似文档的内容，它会变得很丑陋。您最好将 XML 块表示为 M 中的简单值（就像在 JSON 世界中，您经常得到包含 HTML 块的字符串）。M应该让这很容易。你可以用 RELAX NG 优雅地解决这个问题（我知道这不会发生，因为微软对 XSD 的承诺，但这是一个有趣的思想实验）：

最后，还有标准化的问题。在我看来，XML 的成就主要不是技术成就。这是一个社会性的：让大量社区同意使用一种通用格式。标准化是达成该协议的关键因素。XML 不会作为单一供应商格式出现在任何地方。令人惊讶的是，在 PDC 上关于 Oslo 的讨论多次提到了开源，以及微软如何将规范置于其开放规范承诺之下以实现开源实施，但没有提到标准化。我可以理解这一点：如果我是 Microsoft，我当然不会热衷于重复 XSD 或 OOXML 体验。但开源并不能替代标准化。

"

[**在此处**](http://blog.jclark.com/2008/11/some-thoughts-on-oslo-modeling-language.html)阅读James Clark 关于[Oslo 建模语言](http://msdn.microsoft.com/en-us/library/dd285282.aspx)的博客文章。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T20:25:17.523

我情不自禁，但我觉得奥斯陆是一个寻找真正优秀的具体问题来解决的解决方案。我真的希望他们能找到它。

我也有一种感觉，他们需要一些有趣的东西来充实今年的 PDC。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-28T15:12:35.533

回应 James Clark 对 M 的看法：

我还看到 M 和 Oslo 缺少一些东西，但并不完全相同。

最好有一些保证，即 M 会保留集合中的实体被保留的顺序。但是，您希望如何对元素进行排序是一个实现细节。如果您在 M 中有一个有序集合并将其保存到数据库中，您如何在其中维护它们的顺序？唯一的方法是对数据的形状做出一些假设，将一些列添加到您未指定的表中，在这种情况下，完全控制数据结构的形状更有意义。

身份也是如此。我们在内存中有对象标识的原因是因为每个对象在内存中分配了不同的位置，并且具有该内存地址来唯一标识它。但是，当保存到数据库时，此信息不再相关，您需要一些列或列组合来唯一标识该记录，作为其主键。如果您不指定它，则 M 必须为您发明一个列，您将不会引用它，除非可能通过某种难以发现的技巧。换句话说，没有“固有的身份”；总有一些数据可以明确识别它。

文档和数据不是两个不同的东西。XML 本身不处理文档；它只代表分层数据，文档就是由此组成的。只要数据是结构化的，它就可以用 M 表示，就像您可以为层次结构的各个部分编写类并从另一种类型引用一种类型以将它们组合成任意复杂的树一样。诚然，这更容易放在 XML 中，因为它是自由格式的文本，除非您编写 XSD 模式，否则没有真正的验证，但在这些情况下，您所做的工作与在代码类中定义类型和关系相同.

因此，最终，M 会处理您为其定义结构的文档，并且该结构实际​​上并没有任何限制。问题是这样做有多容易。使用工具来拆分 XML 文档并生成 M 模式的想法非常好。我想写一个不会太难，或者一旦它成熟一点，微软就将其包含在他们的工具链中。就“变得丑陋”的结构而言，如果您的数据结构真的那么复杂，那就是它。对它进行模式化具有很大的优势，在 XSD 或 M 或 C# 类中也是如此，但如果您的目标是将其存储在 SQL Server 数据库（或特别是 Oslo 存储库）中，那么它是必要且值得的。

我非常有信心 M 和支持工具链将演变成非常神奇和有用的东西。现在显然有很多缺失。就个人而言，我更关心的是，M 目前的目标是在关系、物理数据库级别而不是概念级别（如实体框架）进行建模，开发人员在概念级别开始建模是最自然的。毕竟，当编写类以从 MGraphs 实例化对象时（DSL 的目的和输出），您的类的定义可能与它们的持久化方式完全不同。特别是如果您在模型中使用继承。

我同意你的标准化。那样就好了。但是，我认为它不太重要，因为目标是将这些数据存储在 Oslo 存储库中。尤其是当 SQL 数据服务成熟到足以托管存储库时，我们将拥有所有不同的协议和格式来查询和操作这些数据。客户端将能够通过 ADO.NET 数据服务进行查询和更新，使用 JSON、POX、SOAP、MGraph 等格式化消息。所有 MGraph 数据都需要一个 MGraph 连接器，以便在数据库中获取它，可以通过任何可以想象的方式访问它。

您可以在我的文章中找到有关奥斯陆的更多信息：http: [//dvanderboom.wordpress.com/2009/01/17/why-oslo-is-important/](http://dvanderboom.wordpress.com/2009/01/17/why-oslo-is-important/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-12T20:37:38.420

...而 JSON 不具备的功能是什么？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-08-04T21:19:56.820

我想知道为什么总是将 MGraph 与 XML 而不是看起来更相似的 YAML 进行比较。为什么我们经常重新发明轮子是无知还是盲目？

**PS：**这就是 YAML 的样子（除了 JSON 之外，没有自定义数据类型和对 YAML 提供的节点“p1”的引用）：

```
{  
  name: "waltrop, lehmstr 1d",  
  Status: {  
    code: 200,  
    request: "geocode"  
  },  
  &p1 Placemark: [  
    {
      address: "Lehmstraße, 45731 Waltrop, Deutschland", 
      ExtendedData: { LatLonBox: {  
          north: 51.6244226,  
          south: 51.6181274,  
          east: 7.4046111,  
          west: 7.3983159
      }},  
      Point: { coordinates: [ 7.4013350, 51.6212620, 0.0 ] }
    }  
  ]  
} 
```

# flash - 控制 FLV/MP4 音频和声相电平

> ID：436885
> 
> 赞同：0
> 
> 时间：2009-01-12T20:25:55.493
> 
> 标签：flash, actionscript-3, actionscript, flash-cs4

如何控制通过 Video 对象播放的外部 FLV 或 MP4 视频的音频和平移级别？

在 AS 2 中，执行此操作的方法是创建一个空的影片剪辑，然后使用已弃用的 attachAudio 函数。我应该以同样的方式继续这样做，还是有更好的方法来控制音频而不必跳过箍？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-12T20:32:35.167

我刚刚想通了。AS 3 中有一种更有效的方法来调整声音属性。

```
stream_ns.soundTransform.volume = vol;
stream_ns.soundTransform.pan = panLevel; 
```

[ActionScript 3.0 API - NetStream#soundTransform](http://help.adobe.com/en_US/AS3LCR/Flash_10.0/flash/net/NetStream.html#soundTransform)

# model-view-controller - 在 MVC 中，分页信息应该放在路径还是查询字符串中？

> ID：436889
> 
> 赞同：6
> 
> 时间：2009-01-12T20:26:50.610
> 
> 标签：model-view-controller, path, pagination, query-string

在路径中：

**格式：** [http](http://mydomain.com/) : //mydomain.com/{category}/{subcategory}/{pageNumber}/{pageSize}

**示例： http:** [//mydomain.com/books/thriller/3/25](http://mydomain.com/books/thriller/3/25)

在查询字符串中：

**格式： http:** [//mydomain.com/](http://mydomain.com/) {category}/{subcategory}? pageNumber={pageNumber}&pageSize={pageSize}

**示例：** [http ://mydomain.com/books/thriller?pageNumber=3&pageSize=25](http://mydomain.com/books/thriller?pageNumber=3&pageSize=25)

我喜欢一切都在路上，但我的问题是，虽然在第一个示例中“书籍”和“惊悚片”是显而易见的（或至少*有些*明显），但“3”和“25”似乎相当随意相比之下。

是否有一种规范的方法来确定 MVC 中的内容，或者它真的只是由开发人员决定？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-01-12T20:30:07.683

我更喜欢将页码之类的内容放在查询字符串变量中。我认为描述性之间存在差异

```
http://mydomain.com/books/thriller?pagesize=50&page=4 
```

和

```
http://mydomain.com/books/thriller/50/4 
```

（对我来说）拥有干净的 url 的目的是让它们更具描述性和可读性，我发现第一个例子就是这样。

[JohnRudolfLewis](https://stackoverflow.com/users/52102/johnrudolflewis)提出的一个有趣观点是：

> 我遵循的一条经验法则是，如果参数是必需的，请考虑使用路径，如果参数是可选的，请始终使用查询字符串参数。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-12T20:30:43.363

我遵循的一条经验法则是，如果参数是必需的，请考虑使用路径，如果参数是可选的，请始终使用查询字符串参数。

总的来说，我会坚持任何使 url 看起来更可读的方法。

该站点将其放在查询字符串中：[https ://stackoverflow.com/questions?page=2&pagesize=30](https://stackoverflow.com/questions?page=2&pagesize=30)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-12T20:32:45.853

好吧，这显然取决于你。但是，您正在设计一个应该是人类可读的 RESTful 接口。在这方面，查询字符串要好得多。否则，您将看到两个可能真的是任何数字的数字。谁会记住这个命令？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-12T20:30:03.067

> 是否有一种规范的方法来确定 MVC 中的内容，或者它真的只是由开发人员决定？

由你决定。

MVC 是关于服务器端代码的组织/流程以及将视图与业务层分离，而不是关于查询参数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-12-21T04:04:08.417

您还可以考虑以下

**格式**

```
http://mydomain.com/{category}/{subcategory}/page/{pageNumber}/results/{pageSize} 
```

**例子**

```
http://mydomain.com/books/thriller/page/3/results/25 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-01-12T20:30:15.377

这几乎取决于开发人员。我会说将 pageSize 放在 URL 中。

# delphi - Delphi 5：模拟“过时”或“弃用”方法的想法？

> ID：436896
> 
> 赞同：1
> 
> 时间：2009-01-12T20:28:18.670
> 
> 标签：delphi, deprecated

我想将一个方法标记为过时，但 Delphi 5 没有这样的功能。

举个例子，这里是一个虚构的方法，它已被弃用和新的首选形式：

```
procedure TStormPeaksQuest.BlowHodirsHorn; overload; //obsolete
procedure TStormPeaksQuest.BlowHodirsHorn(UseProtection: Boolean); overload; 
```

**注意：**对于这个假设的例子，我们假设使用无参数版本是非常糟糕的。不“*使用保护*”存在问题 - 没有好的解决方案。没有人喜欢不得不使用保护，但没有人愿意**不**使用保护。[所以我们让调用者在吹霍迪尔的喇叭](http://www.wowhead.com/?quest=12977)时决定他们是否要使用保护。如果我们默认无参数版本继续*不*使用保护：

```
procedure TStormPeaksQuest.BlowHodirsHorn;
begin
    BlowHodirsHorn(False); //No protection. Bad!
end; 
```

那么开发人员就有各种讨厌的东西的风险。如果我们强制无参数版本使用保护：

```
procedure TStormPeaksQuest.BlowHodirsHorn;
begin
    BlowHodirsHorn(True); //Use protection; crash if there isn't any
end; 
```

如果开发商没有得到任何保护，或者没有任何保护，那么就有可能出现问题。

现在我可以重命名过时的方法：

```
procedure TStormPeaksQuest.BlowHodirsHorn_Deprecatedd; overload; //obsolete
procedure TStormPeaksQuest.BlowHodirsHorn(UseProtection: Boolean); overload; 
```

但这会导致编译错误，人们会嘲笑我（我真的不想听到他们的抱怨）。我希望他们得到一个*唠叨*，而不是一个实际的错误。

我想过添加一个断言：

```
procedure TStormPeaksQuest.BlowHodirsHorn; //obsolete
begin
   Assert(false, 'TStormPeaksQuest.BlowHodirsHorn is deprecated. Use BlowHodirsHorn(Boolean)');

   ...
end; 
```

但我不能保证开发人员不会在没有断言的情况下发布版本，从而给**客户**造成严重的崩溃。

如果开发人员正在调试，我考虑只使用抛出一个断言：

```
procedure TStormPeaksQuest.BlowHodirsHorn; //obsolete
begin
   if DebugHook > 0 then
      Assert(false, 'TStormPeaksQuest.BlowHodirsHorn is deprecated. Use BlowHodirsHorn(Boolean)');

   ...
end; 
```

但我真的不想造成崩溃。

如果它们在调试器中，我想显示一个 MessageDlg（这是我过去做过的一种技术）：

```
procedure TStormPeaksQuest.BlowHodirsHorn; //obsolete
begin
   if DebugHook > 0 then
        MessageDlg('TStormPeaksQuest.BlowHodirsHorn is deprecated. Use BlowHodirsHorn(Boolean)', mtWarning, [mbOk], 0);

   ...
end; 
```

但这仍然太具有破坏性。并且它导致了代码卡在显示模式对话框的问题，但对话框并不明显可见。

我希望有某种警告信息会坐在那里唠叨他们 - 直到他们挖出他们的眼睛并最终改变他们的代码。

我想也许如果我添加了一个未使用的变量：

```
procedure TStormPeaksQuest.BlowHodirsHorn; //obsolete
var
   ThisMethodIsObsolete: Boolean;
begin
   ...
end; 
```

我希望这只会在有人引用代码时引起提示。但是即使您不调用实际使用过时的方法，Delphi 也会显示提示。

谁能想到别的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-13T01:11:01.377

像这样的东西怎么样

```
procedure TStormPeaksQuest.BlowHaldirsHorn; //obsolete
begin
  if DebugHook > 0 then asm int 3 end;  
  // This method is Obsolete!  Use XXXXX instead.
  Abort; // Optional, makes method useless  
  // old code here . . . 
end; 
```

一种断言和显示信息之间的折衷。开发人员只需按 F9 即可继续。您可以输入一个 Abort，然后该方法将什么也不做，这将迫使他们切换方法，而 break 让他们意识到这一点。

我个人建议升级到较新版本的 Delphi。2007 和 2009 是很棒的版本，确实值得升级。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-01-29T14:52:33.267

我最终使用的是选择进入您同意没有任何弃用代码的系统的组合，否则输出调试字符串和断点。

像`strict`html 一样，我创建了一个`Strict`定义。

如果已定义，则所有通用单元都定义了过时的代码`Strict`。这样开发人员就同意他们的项目中不会有弃用的代码：

```
{$IFNDEF Strict}
procedure TStormPeaksQuest.BlowHaldirsHorn; overload; //obsolete
{$ENDIF}
procedure TStormPeaksQuest.BlowHaldirsHorn(UseProtection: Boolean); {$IFNDEF Strict}overload;{$ENDIF}

{$IFNDEF Strict}
procedure TStormPeaksQuest.BlowHaldirsHorn; //obsolete
begin
   OutputDebugString(PAnsiChar('TStormPeaksQuest.BlowHaldirsHorn is deprecated. Use BlowHaldirsHorn(Boolean)'));

   //Don't debugbreak without a debugger attached!
   if DebugHook > 0 then
        Windows.DebugBreak;

   ...
end; 
```

因此，如果开发人员想要拥有正确的代码，并且在新事物被弃用时不得不执行代码更改，他们可以：

```
{$DEFINE Strict} 
```

如果没有，那么**总会**有一个 OutputDebugString，任何有[Debug View](http://technet.microsoft.com/en-us/sysinternals/bb896647.aspx)的人都可以看到（甚至是客户）。看到带有输出调试字符串的商业软件（甚至是微软的）很有趣。

最后，如果附加了一个调试器，那么他们会突然得到一个调试断点。如果有人问起，我可以借此机会取笑他们。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-12T22:13:07.960

这并不能完全回答您的问题，但它可能会提供替代解决方案。你能不能用默认值更新原始函数...

```
procedure TStormPeaksQuest.BlowHaldirsHorn(UseProtection: Boolean = False); 
```

...因此遗留代码的编译和行为相同，但新功能可供新开发人员使用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-12T21:04:23.060

为什么要这样做，为什么不想升级 Delphi 版本？

如果没有 deprecated 标记，您真的没有干净的选项来过滤已弃用方法的使用。所以这取决于你想在哪里做出让步：

*   重命名会在编译时捕获错误（除非范围内有另一个同名的方法/函数）。
*   所有其他方法仅在运行时被捕获。这有滑入生产代码的风险。

您可以做的是创建一个已弃用的日志。这不会激怒任何人，如果它进入生产代码也不是完全的灾难。但是，如果您的测试完全覆盖，您将抓住所有的罪魁祸首。您只需在（测试）运行后检查日志文件。

当然，最好的方法是使用 grep 查找所有出现的代码并进行更改。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-13T00:35:47.923

如果它可以完成这项工作，我会同意一个可选参数。但我能想到的情况是可选参数不适合。例如，我已将函数移入新单元，但保留旧单元并将它们标记为已弃用。

我想您采用的任何解决方案也将取决于您团队的纪律。他们是否积极注意并努力纠正其应用程序的所有提示和警告？希望他们这样做，但我很惭愧地承认与我一起工作的团队（包括我自己）并没有掌握所有提示和警告。时不时我会在时间允许的情况下修复尽可能多的提示和警告，我们绝对应该修复警告，但实际上我们必须完成工作并且更专注于新功能和截止日期。

所以我的观点是，即使您可以将它们标记为已弃用或给出类似的提示/警告，您是否觉得您的团队无论如何都会花时间更改他们的代码？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-01-30T00:15:32.047

这不是一个完整的解决方案，因为您无法区分他们是否使用了该方法，但如果它在 Delphi 5 中可用，但您可以使用[$MESSAGE](http://docwiki.embarcadero.com/RADStudio/en/MESSAGE_directive_(Delphi))编译器指令在编译时发出警告。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-04-18T22:14:10.127

没有说“修复我！” 像编译器中断。
也就是说，我有一位同事经常修改“通用代码”例程的签名……是的，这很烦人！

我的首选（即我们的团队还没有：/）方法如下：

1.  所有开发人员都必须能够在他们自己的机器上轻松执行所有项目的完整构建。
2.  谁决定更改通用代码，谁就应对后果负责。即修复所有受影响的代码。
    *   诚然，有时所说的开发人员可能并不非常适合正确实施和验证所有修复程序。
    *   但是，出于同样的原因，开发人员在他们自己的代码中强加“采用新合同”可能不清楚新合同的细节。IE
        *   为了使用保护，有什么特别需要做的吗？
        *   如何使用保护？
        *   关于它如何破坏现有代码的担忧是什么？
    *   这就是为什么一套全面的测试用例很重要的一个主要原因。
3.  通常，您希望尽快应用所有更改的连锁反应。即，虽然更改的更精细的细节在原始开发人员的脑海中是新鲜的 - 在注意力转移到其他东西之前！
4.  涟漪效应如此巨大（数千行）以至于您希望在很长一段时间内应用更改应该是一种罕见的情况。
    *   如果是这种情况，则实施一个集成到您的构建过程中的简单代码度量收集工具，以报告未完成实例的数量。

我认为第 2 点非常重要，尤其是因为它强调了团队内部合作和沟通的必要性。

回到我的开场白，你越早发现并修复错误越好。
让编译器报告中断！-- 这是我们拥有的“最早的机会”错误报告机制。

那是我的2铜！:D

# html - 在 Ruby on Rails 中显示电子表格数据的最佳方式是什么？

> ID：436915
> 
> 赞同：2
> 
> 时间：2009-01-12T20:32:36.823
> 
> 标签：html, ruby-on-rails, grid, spreadsheet

我正在寻找一种方法来编辑数据并动态计算值（即总数、平均值等）。我的应用程序是一个基于 Web 的教师成绩簿系统，其中一个重大挑战是允许他们输入/更新成绩。这种类型的数据最自然的解决方案是表格或电子表格网格，我的第一个想法是自己写一些东西，但我很快就克服了这个想法。:)

我遇到的主要问题是能够实时计算事物。当老师更改成绩时，我需要表格来更新学生的 AVG % 和可能的字母成绩。它不必将这些计算反馈给服务器（它们只是为了展示），但必须保存单元格更改（通过 AJAX）。

我知道这可能应该是一个常见问题解答，我找到了这两个答案（[1](https://stackoverflow.com/questions/271276/what-is-the-easiest-way-to-display-an-editable-listlike-a-spreadsheet-in-html)、[2](https://stackoverflow.com/questions/158695/spreadsheet-like-functionality-in-webapp)），但我的要求有点不同（我认为）。首先，我正在寻找能够很好地与 RoR 集成的东西；这意味着使用原型。它也应该非常轻巧和干净；我不需要像图片、子组等花哨的东西。最后，由于我的项目是在 GPL 下，它必须是开源的。

有什么提示吗？现在我正在查看[TableKit](http://www.millstream.com.au/view/code/tablekit)和[Rico LiveGrid](http://openrico.org/)，但我不确定他们是否可以进行我需要的行和列计算。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-12T22:55:11.807

我认为 ExtJS 有这样的东西。值得一试：http: [//extjs.com/](http://extjs.com/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-14T00:43:59.980

将其保存在数据库中可能是最简单的。计算并保存您需要的东西，然后更新视图。

我不确定您的 UI 是如何工作的，但是您可以将 AJAX 事件附加到他们输入信息的 UI 上，从而保存数据。控制器可以响应 javascript，放入一个 RJS 模板，该模板将更新您在页面上需要的值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-14T14:52:02.437

在寻找轻量级和易于使用的东西后，我放弃了，正在编写自己的一点点 JavaScript 来为我出价。它并不完美，但它似乎工作得很好，并且满足了我的需求（目前）。

# java - Maven安装文件夹结构问题j2ee(spring,struts..)

> ID：436920
> 
> 赞同：5
> 
> 时间：2009-01-12T20:33:11.220
> 
> 标签：java, eclipse, spring, maven-2, struts

我正在使用 maven 2.1-SNAPSHOT 作为 Eclipse 插件。我的项目结构是这样的：

src/main/java
   -model
   -service
   -action
src/test/java
   空atm
src/main/resources
   空atm
src/test/resources
   空atm
src/main/webapp
   -js
    -dojo
   -META-INF
   -WEB-INF
     web .xml
     appcontext.xml
     struts.xml
   index.jsp

我无法理解构建过程以及放置哪个文件的位置。我用作 Application Server Jetty，但我也想在 tomcat 上部署我的项目（所以我已经在我的 pom 打包大战中进行了设置）。

当我使用 maven:install 命令运行我的项目时，我的目标文件夹如下所示： myproject.war
war
   not related
test-classes
   empty atm
myproject
   js
   META-INF
   WEB-INF
   index.jsp
classes
   模型
   服务
   操作

我的问题是我在类文件夹中需要我在 META-INF 中的 persistence.xml。我猜也是struts.xml。我也不确定道场是否在那里。老实说，我根本不知道这种结构是否正确。我也不知道如何配置输出更改。

我希望有人可以帮助我我真的很想了解这个过程应该如何正确，也许甚至有很好的资源可以查找以更好地处理这些事情。在此先感谢 kukudas

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-12T20:36:22.633

我相信您要部署到类路径的文件位于该`resources/`文件夹中。

查看[Maven in 5 Minutes 指南](http://maven.apache.org/guides/getting-started/maven-in-five-minutes.html)以及[入门](http://maven.apache.org/guides/getting-started/index.html)指南。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-12T22:17:12.180

我认为您缺少 src/main/webapp 目录下的资源目录。这就是你可以为 hibernate、struts 和 spring 放入属性和配置文件的地方。

这将允许 Maven 将文件复制到 WAR 中的类目录中。

希望这可以帮助。

# c# - 从 GridView 列到 TextBox 的 Ajax 刷新/更新总和

> ID：436938
> 
> 赞同：2
> 
> 时间：2009-01-12T20:39:04.127
> 
> 标签：c#, asp.net, ajax, gridview

我有一个 GridView A 有很多列，其中之一包含每行的价格。所以提示是如何或以何种方式，我可以更新/刷新将显示在标签或文本框（而不是 GridView 页脚）中的总价格吗？

我的工作平台是 C# 3.0 / ASP.Net

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-12T23:50:08.297

设置一个“总计”变量。使用 jquery 遍历表/网格视图的每一行并将特定列值添加到总数中。（该方法需要知道从 Td 或文本输入中获取数值。

在文本框的 onchange 事件上，再次调用该方法。

# asp.net - 如何在不触发 Application_Start 事件的情况下启动 aspnet_wp.exe

> ID：436941
> 
> 赞同：1
> 
> 时间：2009-01-12T20:39:55.840
> 
> 标签：asp.net, web-services, debugging, global-asax

我正在尝试调试 Web 服务（Windows XP SP3、VS 2008、ASP.NET 2、VB.NET）。

对于大多数情况，如果已经加载了 asp.net 工作进程，我可以启动调用 Web 服务的 Windows 窗体，附加到 Visual Studio 中的 aspnet_wp.exe，然后调试到我心仪的内容，但捕获应用程序启动global.asax 中的事件很痛苦。

如果我重置 IIS，当然没有要附加的进程，直到 Application start 事件结束。

我发现这样做的唯一方法是创建一个单独的 aspx 页面，将其设置为起始页面，然后运行它 - 然后我可以在 App 启动事件的中断处停下来，但维护一个页面很麻烦这本质上只是一个测试存根。

对一些更整洁的东西有什么想法吗？有点像“一开始就附加到进程”。

当然，更好的是不必*显式*附加到 aspnet_wp.exe 以便能够调试 Web 服务，但我也没有找到这样做的方法。

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-12T20:50:13.807

尝试将其粘贴在您的应用程序启动事件中，它应该每次都启动您的调试器。只要确保你完成后把它拿出来:-)。

```
System.Diagnostics.Debugger.Launch() 
```

或者更好的是，在 WebService 的 OnStart 中：

```
Protected Overrides Sub OnStart(ByVal args() As String)
    ' Add code here to start your service. This method should set things
    ' in motion so your service can do its work.
    System.Diagnostics.Debugger.Launch()
End Sub 
```

更新：将此评论添加到答案中，因为这是个好主意：

> 将此包装在#if DEBUG 中，它会更安全一些（最终不会将如此灾难性的东西滑入测试/生产环境）。– 滑块规则

# python - 自定义表单小部件的“value_from_datadict”方法应该返回什么？

> ID：436944
> 
> 赞同：5
> 
> 时间：2009-01-12T20:40:11.953
> 
> 标签：python, django, django-forms

我正在尝试构建自己的自定义 django 表单小部件（将它们放在我的项目目录的 widgets.py 中）。值“value_from_datadict()”应该返回什么？它是返回一个字符串还是该字段的实际预期值？

我正在使用 JQuery 对象构建我自己的拆分日期/时间小部件版本，小部件的每个部分应该返回什么？日期小部件是否应该返回一个日期时间，而时间小部件是否应该返回一个日期时间？什么胶水代码将这两个值合并在一起？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-12T22:56:34.113

因为`value_from_datadict()`您想返回您期望的值或无。[django/forms/widgets.py](https://github.com/django/django/blob/master/django/forms/widgets.py)中的源代码提供了一些示例。

但是你应该能够通过提供一个`render`方法来构建一个 DatePicker 小部件：

```
DATE_FORMAT = '%m/%d/%y'

class DatePickerWidget(widgets.Widget):
    def render(self, name, value, attrs=None):
        if value is None:
            vstr = ''
        elif hasattr(value, 'strftime'):
            vstr = datetime_safe.new_datetime(value).strftime(DATE_FORMAT)
        else:
            vstr = value
        id = "id_%s" % name
        args = [
            "<input type=\"text\" value=\"%s\" name=\"%s\" id=\"%s\" />" % \
            (vstr, name, id),
            "<script type=\"text/javascript\">$(\"#%s\").datepicker({dateFormat:'mm/dd/y'});</script>" % id
            ]
        return mark_safe("\n".join(args)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-12T22:58:27.823

Django 消息来源说

> 给定一个数据字典和这个小部件的名称，返回这个小部件的值。如果未提供，则返回 None。

阅读代码，我看到 Django 的单独日期和时间小部件都是 Input 的子类，Widget 的子类，它似乎与简单的字符串一起工作。

# c# - 谁在 Dictionary<>.First() 上？

> ID：436954
> 
> 赞同：21
> 
> 时间：2009-01-12T20:44:49.230
> 
> 标签：c#, .net

当您在集合`Enumerable.First()`的实例上调用 .NET 3.5 扩展方法时，它的含义是什么？`Dictionary`

这组键是确定哪个项目是第一个，还是只是没有定义？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-01-12T20:47:01.800

好吧，我相信这组键*将*确定哪个项目是第一个，但不是以明确定义（或易于预测）的方式。换句话说，不要假设它总是以相同的方式工作 - 它与依赖哈希码实现在运行之间保持相同一样不安全。

编辑：我相信事实上，插入的顺序*确实*很重要，这与我之前的想法相反。但是，这*是*特定于实现的（因此可以在下一个版本中轻松更改）。我相信在当前的实现中，*如果*没有删除，添加的第一个条目将是第一个返回的条目。如果删除了添加的第一个条目，则顺序被破坏 - 并不是*最早*的条目被删除。这是一个例子：

```
using System;
using System.Collections.Generic;

class Test
{
    static void Main(string[] args)
    {
        var dict = new Dictionary<int, int>();        
        dict.Add(0, 0);
        dict.Add(1, 1);
        dict.Add(2, 2);
        dict.Remove(0);
        dict.Add(10, 10);

        foreach (var entry in dict)
        {
            Console.WriteLine(entry.Key);
        }
        Console.WriteLine("First key: " + dict.First().Key);
    }
} 
```

结果是 10、1、2 和“First key: 10” - 表明*最后*添加的条目最先返回。

但是，我想再次强调，框架版本之间的一切都可能发生变化。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-12T21:06:16.880

如果您需要字典中的第一项，最好使用 SortedDictionary。我认为 First() 方法只会返回恰好位于顶部的第一个项目，但不一定是添加的第一个项目。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-12T21:23:14.957

我正在查看一些使用 foreach 循环来获取字典对象中的“第一个”项目的代码。该代码假定这是添加到字典中的第一个。

最初我认为 Dictionary.First() 方法会更有效。但后来我意识到，在这种情况下，首先是什么项目的整个概念可能没有多大意义。

Echilon 建议的 SortedDictionary 可能具有比我需要的更多的开销和更多的功能。我倾向于只保存添加的第一个元素的键。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-12T23:19:18.560

我做了更多的挖掘，发现[MSDN](http://msdn.microsoft.com/en-us/library/ekcfxy3x(VS.80).aspx)警告说字典中的值和键的顺序是未指定的。所以我相信这意味着 First() 在添加更多值时可能并不总是返回相同的值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-13T01:13:30.453

未指定`Keys`实现类中集合的顺序。`Dictionary<TKey, TValue>`所以你不知道`First()`会返回什么值。

但是`First()`无论如何都要使用 - 或者更具体地说，使用`FirstOrDefault()`. 如果您有一个带`IEnumerable<T>`参数的方法，并且您知道 T 是一个默认值为`null, your method can use`FirstOrDefault() 的类型，则可以测试对象是否为空。

你为什么要这样做而不是使用`Count()`？利用延迟执行。如果您调用`FirstOrDefault()`生成器，生成器会产生一个结果并停止。如果您调用`Count()`生成器，则生成器必须枚举到列表的末尾。

所以你可以写一个这样的函数：

```
bool ListIsEmpty(IEnumerable<string> list)
{
    return list.FirstOrDefault() == null;
} 
```

并像这样使用它：

```
if (!ListIsEmpty(dict.Keys)) 
{
    Console.WriteLine("Dictionary is not empty");
}
if (!ListIsEmpty(dict.Keys.Where(x => x.Contains("foo"))
{
    Console.WriteLine("Dictionary has at least one key containing 'foo'.");
} 
```

并且知道为了做出这些决定，代码正在做它必须做的最低限度的工作。

**编辑：**

我应该指出，上面的代码所做的另一个假设是：`IEnumerable<T>`它的第一项没有 null！

`Keys`对于字典的集合或`DataRowCollection`（我对 LINQ 的主要用例）的集合，或者在其中一个集合上运行时，始终可以保证这一点`Where()`。

但不能保证 a`List<string>`或 a `List<DataRow>`。因此，在某些情况下，您在使用`FirstOrDefault()`.

# c# - 使用 Process.Start 时如何隐藏控制台应用程序用户界面？

> ID：436956
> 
> 赞同：9
> 
> 时间：2009-01-12T20:46:48.353
> 
> 标签：c#, .net

我想运行一个将输出文件的控制台应用程序。

我使用以下代码：

```
Process barProcess = Process.Start("bar.exe", @"C:\foo.txt"); 
```

当它运行时，会出现控制台窗口。我想隐藏控制台窗口，以便用户看不到它。

这可能吗？使用 Process.Start 是启动另一个控制台应用程序的最佳方式吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-12T20:50:01.157

```
 Process p = new Process();
        StreamReader sr;
        StreamReader se;
        StreamWriter sw;

        ProcessStartInfo psi = new ProcessStartInfo(@"bar.exe");
        psi.UseShellExecute = false;
        psi.RedirectStandardOutput = true;
        psi.RedirectStandardError = true;
        psi.RedirectStandardInput = true;
        psi.CreateNoWindow = true;
        p.StartInfo = psi;
        p.Start(); 
```

这将启动一个子进程而不显示控制台窗口，并允许捕获 StandardOutput 等。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-12T20:49:24.230

检查 ProcessStartInfo 并设置 WindowStyle = ProcessWindowStyle.Hidden 和 CreateNoWindow = true。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-03-09T23:41:23.043

如果您想在进程执行时检索它的输出，您可以执行以下操作（示例使用“ping”命令）：

```
var info = new ProcessStartInfo("ping", "stackoverflow.com") {
    UseShellExecute = false, 
    RedirectStandardOutput = true, 
    CreateNoWindow = true 
};
var cmd = new Process() { StartInfo = info };
cmd.Start();
var so = cmd.StandardOutput;
while(!so.EndOfStream) {
    var c = ((char)so.Read()); // or so.ReadLine(), etc
    Console.Write(c); // or whatever you want
}
...
cmd.Dispose(); // Don't forget, or else wrap in a using statement 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-01-12T20:49:16.150

我们过去通过使用命令行以编程方式执行我们的流程来完成此操作。

# .net - .NET app.config 问题

> ID：436958
> 
> 赞同：1
> 
> 时间：2009-01-12T20:47:49.490
> 
> 标签：.net, excel, configuration

我创建了一个使用 CLR 2.0 的 Excel 2003 加载项，该加载项将安装在我客户站点的数百台机器上。问题是安装了加载项的某些机器同时运行了 .NET 1.1 和 .NET 2.0，并且该插件在尝试加载时会引发错误。

我遇到的可行的解决方案是在 excel.exe 所在的同一文件夹中创建一个 excel.exe.config 文件，将supportedRuntime 版本设置为v2.0.50727。

因为这个解决方案在我的情况下不能很好地扩展（因为加载项将在数百台机器上使用，用户可能甚至无法访问创建配置文件），我想知道是否可以添加相同的 supportedRuntime 参数在我的插件 app.config 文件中，它会工作。

如果这不起作用，你们知道我还可以尝试什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-12T21:38:57.250

您收到的错误信息是什么？

您描述的问题不应该出现在 Office 2007 中。但是，这是 Office 2003 中所谓的共享加载项（基于 Extensibility.IDTExtensibility2 接口使用 COM 互操作性的 .NET 加载项）的已知问题。

Microsoft 发布了一个补丁，应该为每个使用该插件的用户安装该补丁。您可以在此处获取补丁：

> [http://support.microsoft.com/kb/908002](http://support.microsoft.com/kb/908002)

使用配置文件的解决方案是一个非标准的解决方案，但也应该解决以下文章中所述的问题：

> [http://nielsvanvliet.com/excel.html#Patch](http://nielsvanvliet.com/excel.html#Patch)

如果要使用 MSI 安装程序部署加载项，您应该检查**Microsoft .NET Framework 2.0 (KB908002) 的共享加载项支持更新**作为安装项目属性中的先决条件。请注意，只能为当前用户安装此修复程序，即应禁用 ALLUSERS 设置。

更新： VS 2008 的安装稍微复杂一些。看这里：

> [.NET Word 2003 加载项可以安装在 GAC 之外吗？](https://stackoverflow.com/questions/553794/can-a-net-word-2003-add-in-be-installed-outside-of-the-gac/553886#553886)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-12T20:56:37.537

好吧，如果有数百台机器，我假设有组策略或其他运行管理脚本或设置文件的方法。也许您可以创建一个小型 MSI 包来推出此配置文件或将其添加到启动脚本中？

# ruby-on-rails - 思考狮身人面像索引未过期的记录

> ID：436966
> 
> 赞同：1
> 
> 时间：2009-01-12T20:49:30.440
> 
> 标签：ruby-on-rails, indexing, conditional-statements, thinking-sphinx

让 Thinking Sphinx 仅索引今天日期小于或等于记录的“expires_at”字段的记录的最佳方法是什么？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-13T08:33:44.010

最简单的方法是将以下语句添加到您的 define_index 块中：

```
其中“expired_at >= NOW()”
```

无论如何，那是 MySQL 版本。PostgreSQL 将非常相似：

```
其中“expired_at >= current_timestamp”
```

虽然，我不是 PostgreSQL 专家，但希望这足以满足需要。

干杯

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-17T10:50:55.367

PostgreSQL 也接受函数 'now()'

# active-directory - 如果缓存数据存在，LDAP 不会更新

> ID：436976
> 
> 赞同：1
> 
> 时间：2009-01-12T20:53:17.530
> 
> 标签：active-directory, ldap, nss, selinux

我们有一个 SELinux 客户端，它使用连接到 Active Directory 服务器的 LDAP 对网络用户进行身份验证。由于我们的机器必须“不受限制”地运行，我们必须使用 nscd 来缓存组和密码信息。

这就是问题所在。如果我们在 Active Directory 服务器上更改组信息，然后登录客户端，如果该用户存在缓存，LDAP 似乎会忽略服务器并仅使用缓存的数据。我们能够获得更新的唯一方法是使 passwd 缓存无效。

/etc/nsswitch.conf 的重要部分：

```
    passwd：文件 ldap 缓存
    组：文件 ldap 缓存
    shadow：文件 ldap 缓存

```

谢谢。

**更新：**发现`strace getent passwd`在读取 /etc/nsswitch.conf 之前会检查 nscd 缓存，因此 nss 的配置无关紧要。

**更新 2：**今天玩 nss_updatedb 看看它是否有效。到目前为止还没有任何乐趣，尽管[这个](https://help.ubuntu.com/community/PamCcredsHowto)方法看起来正是我们需要做的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-12T23:58:24.363

如果您不想缓存来自活动目录的结果，那么您需要关闭 nscd 或将其缓存寿命设置为几分钟（编辑 /etc/nscd.conf）。我相信 passwd 的默认生存时间是 10 分钟，组的默认生存时间是 10 分钟。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-12-10T12:34:47.067

您可以使用以下命令轻松刷新 nscd 缓存：

```
sudo nscd -i passwd
sudo nscd -i group 
```

使用给定命令刷新 nscd 缓存后，您会看到更改的 LDAP 数据。

有关详细信息，请参阅：[http ://sysadmin-notepad.blogspot.rs/2013/05/how-to-flush-nscd-cache-in-linux.html](http://sysadmin-notepad.blogspot.rs/2013/05/how-to-flush-nscd-cache-in-linux.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T21:31:45.557

我们最终通过使用 nss_updatedb 在本地缓存 group 和 passwd 数据库来解决这个问题。然后我们关闭了 nscd。

我们将 pam_exec 模块添加到 pam.d 列表中，并使用它在身份验证之前运行 nss_updatedb 以确保本地缓存是最新的。

# mysql - 有人从 Ruby 成功连接到 MySQL 吗？

> ID：436980
> 
> 赞同：0
> 
> 时间：2009-01-12T20:56:05.043
> 
> 标签：mysql, ruby

在尝试获取 ruby​​ 脚本以连接到 MySQL 时，我开始有点绝望。

我已经放弃了 DBI，因为无论我做什么，我似乎都无法让它工作。我认为仅使用 ruby​​-mysql 中的 mysql.rb 可能会更幸运。但是，在使用它时，我收到以下错误：

```
./mysql.rb:453:in `read': Client does not support authentication protocol requested by server; consider upgrading MySQL client (Mysql::Error) 
```

[我通过谷歌搜索该错误消息](http://www.ocsinventory-ng.org/index.php?mact=News,cntnt01,detail,0&cntnt01articleid=3&cntnt01returnid=77)收集到，这意味着我的 MySQL 版本太新并且不支持旧式密码。我在共享服务器上并且没有 root 访问权限，所以我无法对 MySQL 配置进行建议的更改。

顺便说一句，我的版本是：

```
mysql  Ver 14.7 Distrib 4.1.22, for pc-linux-gnu (i686) using readline 4.3 
```

有没有人成功让 ruby​​ 连接到 MySQL？我一直在 Windows 下尝试，因为我在我的 Windows 机器上具有管理员访问权限，但如果有办法在 Linux 上没有 root 访问权限，那就更好了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-12T21:05:27.677

这里有一个很好的总结：[http ://rubylearning.com/satishtalim/ruby_activerecord_and_mysql.html](http://rubylearning.com/satishtalim/ruby_activerecord_and_mysql.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-12T21:26:11.737

听起来你遇到了 MySQL 的怪癖。大约在 5.0 版左右，他们更改了连接密码的格式。不过，这很容易解决：http: [//dev.mysql.com/doc/refman/5.1/en/old-client.html](http://dev.mysql.com/doc/refman/5.1/en/old-client.html)

（另外，查看 Ruby Sequel gem，它可以让你用各种数据库做一些真正有趣的事情，而不需要 ActiveRecord 的开销：[http://sequel.rubyforge.org/documentation.html](http://sequel.rubyforge.org/documentation.html)）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-12T21:03:05.403

你想做什么？我认为可以使用 Rails 的 ActiveRecord 组件来建立与 MySQL 的连接。我会看看是否可以找到一些文档来支持这一点，我会更新这个答案。

[链接到 ActiveRecord/MySQL 集成](http://rubylearning.com/satishtalim/ruby_activerecord_and_mysql.html)

更新：要将 ActiveRecord 用于正在寻找的目的，您将需要创建各种模型类来表示您从中提取数据的表，并指定它们的关系。完成后，您将能够执行以下操作：

```
SomeModel.find(:all, :conditions => ['some_column = ?', some_value] 
```

我过去曾使用这种方法为我的 Rails 应用程序提供对 WordPress 数据的访问权限。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-12T21:05:02.420

在我的测试机器上从 Ruby 连接到 MySQL 没有任何问题。

您提到您正在使用共享托管服务提供商。如果他们有旧的 ruby​​-mysql 版本，它与新样式的密码不兼容，也许他们的支持人员可以对 MySQL 中的用户行进行所需的更改。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-01-12T22:49:05.860

可能是您使用的是旧版本的 mysql，需要对其进行升级。

# c# - C#按值/引用传递？

> ID：436986
> 
> 赞同：24
> 
> 时间：2009-01-12T20:59:39.497
> 
> 标签：c#

常见问题，但我可以使用“英语”解释。

像Java一样吗？

```
Cat myCat 
```

实际上是一个指向`Cat`?

我真的应该在 C# 中创建复制构造函数吗？

* * *

我知道我们是按值传递的，但现在我的问题是我们是按指针值传递还是对象的完整副本传递？

如果是后者，那是不是太昂贵的性能/内存明智？那是你必须使用 ref 关键字的时候吗？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2009-01-12T21:08:45.203

正如@rstevens 回答的那样，如果它是一个类，则 myCat 是一个参考。但是如果你将 myCat 传递给一个方法调用，那么引用本身是按值传递的——即参数本身将引用同一个对象，但它是一个全新的引用，所以如果你将它分配给 null，或者创建一个新对象，旧的 myCat 引用仍将指向原始对象。

```
SomeMethod(myCat);

void SomeMethod(Cat cat)
{
    cat.Miau(); //will make the original myCat object to miau
    cat = null; //only cat is set to null, myCat still points to the original object
} 
```

Jon Skeet 有一篇关于它的好[文章](https://jonskeet.uk/csharp/parameters.html)。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-01-12T21:04:48.800

请记住，指针与引用并不完全相同，但如果您愿意，您可以这样想。

我发誓我在 10 分钟前看到了另一个关于此的 SO 问题，但我现在找不到链接。在我看到的另一个问题中，他们正在谈论通过 ref 与按值传递参数，归结为：

> 默认情况下，在 .Net 中，您不会通过引用传递对象。您按值传递对对象的引用。

区别是微妙但重要的，特别是如果，例如，您想在方法中分配给您传递的对象。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-12T21:03:06.510

如果您将 Cat 声明为

```
class Cat {...} 
```

那么它就是。

如果您将 Cat 定义为

```
struct Cat {...} 
```

那么你的变量“就是”结构本身。

这是 .Net 中引用类型和值类型之间的区别。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-12T21:12:25.337

是的，它是关于指针，但不是真的......最初让我感到困惑的是，它并不是真正关于保护你的变量免受方法内的更改。如果您在方法中更改对象，则这些更改对外部方法可见，无论它是否在“ref”中传递。

区别（据我所知）是如果您更改变量引用的对象，您发送的变量是否会更新其引用。所以给定这个方法

```
public void DoSomething(ref CoolShades glasses)
{
    glasses.Vendor = "Ray Ban";
    glasses = new CoolShades();
} 
```

您作为参数传入的变量现在包含对新 CoolShades 的引用，而不是它之前引用的任何对象。无论您是否传递了参数 ref，原始参数对象的 Vendor 属性都将更改为“雷朋”。

# java - 如何在Java中从网络数据包数据中获取数据

> ID：436989
> 
> 赞同：5
> 
> 时间：2009-01-12T21:01:04.207
> 
> 标签：java, c, networking, udp, packet

在 C 中，如果您有某种类型的数据包，您通常会定义一些结构并将 char * 转换为指向该结构的指针。在此之后，您可以直接以编程方式访问网络数据包中的所有数据字段。像这样：

```
struct rdp_header {
  int version;
  char serverId[20];
}; 
```

当您收到网络数据包时，您可以快速执行以下操作：

```
char * packet;
// receive packet
rdp_header * pckt = (rdp_header * packet);
printf("Servername : %20.20s\n", pckt.serverId); 
```

这种技术非常适用于基于 UDP 的协议，并且允许使用非常少的代码和简单的错误处理（只需检查数据包的长度）非常快速和非常有效地解析和发送数据包。是否有等效的方法，就像在 java 中一样快速地做同样的事情？还是您被迫使用基于流的技术？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-12T21:03:38.927

将您的数据包读入一个字节数组，然后从中提取您想要的位和字节。

这是一个示例，没有异常处理：

```
DatagramSocket s = new DatagramSocket(port);
DatagramPacket p;
byte buffer[] = new byte[4096];

while (true) {
    p = new DatagramPacket(buffer, buffer.length);
    s.receive(p);

    // your packet is now in buffer[];
    int version = buffer[0] << 24 + buffer[1] << 16 + buffer[2] < 8 + buffer[3];
    byte[] serverId = new byte[20];
    System.arraycopy(buffer, 4, serverId, 0, 20);

     // and process the rest
} 
```

在实践中，您可能最终会使用辅助函数从字节数组中按*网络顺序提取数据字段，或者正如*[Tom](https://stackoverflow.com/users/4725/tom-hawtin-tackline)在评论中指出的那样，您可以使用 a `ByteArrayInputStream()`，您可以从中构造 a`DataInputStream()`具有读取结构化数据的方法从流中：

```
...

while (true) {
    p = new DatagramPacket(buffer, buffer.length);
    s.receive(p);

    ByteArrayInputStream bais = new ByteArrayInputStream(buffer);
    DataInput di = new DataInputStream(bais);

    int version = di.readInt();
    byte[] serverId = new byte[20];
    di.readFully(serverId);
    ...
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-12T21:11:22.437

我不相信这种技术可以在 Java 中完成，除非使用 JNI 并且实际上用 C 编写协议处理程序。实现您描述的技术的另一种方法是变体记录和联合，Java 也没有。

如果您可以控制协议（它是您的服务器和客户端），您可以使用序列化对象（inc.xml）来获得数据的自动（但运行时效率不高）解析，但仅此而已。

否则，您将无法解析 Streams 或字节数组（可以视为 Streams）。

请注意，您所描述的技术非常容易出错，并且对于任何相当有趣的协议来说都是安全漏洞的来源，因此损失并不大。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-13T00:30:57.107

我写了一些东西来简化这种工作。像大多数任务一样，编写工具比尝试手动完成所有事情要容易得多。

它由两个类组成，这是一个如何使用它的示例：

```
 // Resulting byte array is 9 bytes long.
    byte[] ba = new ByteArrayBuilder()

     .writeInt(0xaaaa5555) // 4 bytes
     .writeByte(0x55) //      1 byte
     .writeShort(0x5A5A) //   2 bytes
     .write( (new BitBuilder())  //     2 bytes---0xBA12                
            .write(3, 5) //     101      (3 bits value of 5)
            .write(2, 3) //        11    (2 bits value of 3)
            .write(3, 2) //          010 (...)
            .write(2, 0) //     00
            .write(2, 1) //       01
            .write(4, 2) //         0002
        ).getBytes(); 
```

我编写了 ByteArrayBuilder 来简单地累积位。我使用了一种方法链接模式（只是从所有方法中返回“this”），以便更容易地一起编写一堆语句。

ByteArrayBuilder 中的所有方法都是微不足道的，就像 1 或 2 行代码（我只是将所有内容都写入数据输出流）

这是构建一个数据包，但撕开一个应该不会更难。

BitBuilder 中唯一有趣的方法是这个：

```
public BitBuilder write(int bitCount, int value) {
    int bitMask=0xffffffff;  
    bitMask <<= bitCount;   // If bitcount is 4, bitmask is now ffffff00
    bitMask = ~bitMask;     // and now it's 000000ff, a great mask

    bitRegister <<= bitCount; // make room
    bitRegister |= (value & bitMask); // or in the value (masked for safety)
    bitsWritten += bitCount;
    return this;
} 
```

同样，可以很容易地反转逻辑以读取数据包而不是构建数据包。

编辑：我在这个答案中提出了一种不同的方法，我将把它作为一个单独的答案发布，因为它完全不同。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-17T15:28:41.197

查看 Javolution 库及其结构类，它们会满足您的要求。事实上，作者有这个确切的例子，使用 Javolution Struct 类来操作 UDP 数据包。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-13T21:53:58.357

这是我在上面留下的答案的替代建议。我建议您考虑实现它，因为它的行为与 C 解决方案几乎相同，您可以按名称从数据包中选择字段。

您可以从一个外部文本文件开始，如下所示：

```
OneByte,       1
OneBit,       .1
TenBits,      .10
AlsoTenBits,  1.2
SignedInt,    +4 
```

它可以指定数据包的整个结构，包括可能重复的字段。语言可以根据您的需要简单或复杂——

你会创建一个像这样的对象：

```
new PacketReader packetReader("PacketStructure.txt", byte[] packet); 
```

您的构造函数将遍历 PacketStructure.txt 文件并将每个字符串存储为哈希表的键，并将其数据的确切位置（位偏移量和大小）存储为数据。

一旦你创建了一个对象，传入了 bitStructure 和一个数据包，你就可以使用如下语句随机访问数据：

```
int x=packetReader.getInt("AlsoTenBits"); 
```

还要注意，这些东西的效率会比 C 结构低得多，但没有你想象的那么多——它可能仍然比你需要的效率高很多倍。如果处理得当，规范文件只会被解析一次，因此您只会对从数据包中读取的每个值进行一次散列查找和一些二进制操作的轻微打击——一点也不差。

例外情况是，如果您正在从高速连续流中解析数据包，即使这样，我也怀疑快速的网络可能会淹没速度较慢的 CPU。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-13T22:12:31.940

简短的回答，不，你不能那么容易做到。

更长的答案，如果你可以使用`Serializable`对象，你可以连接`InputStream`到一个`ObjectInputStream`并使用它来反序列化你的对象。但是，这需要您对协议有一定的控制权。如果您使用 TCP ，它也更容易工作`Socket`。如果您使用 UDP `DatagramSocket`，则需要从数据包中获取数据，然后将其输入`ByteArrayInputStream`.

如果您无法控制协议，您可能仍然可以使用上述反序列化方法，但您可能必须实现`readObject()`and`writeObject()`方法，而不是使用提供给您的默认实现。如果您需要使用其他人的协议（比如因为您需要与本机程序互操作），这可能是您将找到的最简单的解决方案。

另外，请记住 Java 在内部对字符串使用 UTF-16，但我不确定它是否以这种方式序列化它们。无论哪种方式，在将字符串来回传递给非 Java 程序时都需要非常小心。

# xslt - 将两个数字相乘然后相加

> ID：436998
> 
> 赞同：11
> 
> 时间：2009-01-12T21:04:34.557
> 
> 标签：xslt, xslt-1.0, xslt-2.0

我很难尝试做一些看起来应该很容易做的事情。我基本上想将一个节点中的 2 个数字相乘，然后将所有节点的这些数字相加。这是我尝试过的 XSLT 代码。

```
<xsl:value-of select="sum(Parts/Part/Quantity * Parts/Part/Rate)"/> 
```

此代码导致错误提示“函数 sum 的参数 1 无法转换为节点集”。

有谁知道出了什么问题或我如何才能完成我想做的事情？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-01-13T01:00:10.183

**以下是三种可能的解决方案**：

# 解决方案1 ​​XSLT2：

```
<xsl:stylesheet version="2.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output method="text"/>

    <xsl:template match="/">
      <xsl:sequence select="sum(/*/*/(rate * quantity))"/>
    </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于以下 XML 文档时**：

```
<parts>
  <part>
        <rate>0.37</rate>
    <quantity>10</quantity>
  </part>
  <part>
        <rate>0.03</rate>
    <quantity>10</quantity>
  </part>
</parts> 
```

**产生了想要的结果**：

4

[**XSLT 2.0**](http://www.w3.org/TR/xslt20/)解决方案使用的事实是，在[**XPath 2.0**](http://www.w3.org/TR/xpath20/#context)中，允许最后一个“/”运算符的右参数可以是表达式或通常是函数。该表达式/函数适用于目前选择的作为上下文节点的每个节点，并且每个函数应用产生一个结果。

# 解决方案 2 XSLT 1.0：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output method="text"/>

    <xsl:template match="/">
      <xsl:call-template name="sumProducts">
        <xsl:with-param name="pList" select="*/*"/>
      </xsl:call-template>
    </xsl:template>

    <xsl:template name="sumProducts">
        <xsl:param name="pList"/>
        <xsl:param name="pAccum" select="0"/>

        <xsl:choose>
          <xsl:when test="$pList">
            <xsl:variable name="vHead" select="$pList[1]"/>

            <xsl:call-template name="sumProducts">
              <xsl:with-param name="pList" select="$pList[position() > 1]"/>
              <xsl:with-param name="pAccum"
               select="$pAccum + $vHead/rate * $vHead/quantity"/>
            </xsl:call-template>
          </xsl:when>
          <xsl:otherwise>
            <xsl:value-of select="$pAccum"/>
          </xsl:otherwise>
        </xsl:choose>
    </xsl:template>
</xsl:stylesheet> 
```

**当应用于上述 XML 文档时，会产生正确的结果**：

4

**这是一个典型的 XSLT 1.0 递归解决方案**。**请注意`sumProducts`模板如何递归调用自身**，直到`$pList`处理传入参数的整个输入列表。

# 解决方案 3 FXSL (XSLT 1.0)：

```
<xsl:stylesheet version="1.0" 
xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
xmlns:ext="http://exslt.org/common"
xmlns:test-map-product="test-map-product"
exclude-result-prefixes="xsl ext test-map-product"
>
   <xsl:import href="sum.xsl"/>
   <xsl:import href="map.xsl"/>
   <xsl:import href="product.xsl"/>

   <!-- This transformation is to be applied on:
        salesMap.xml

        It contains the code of the "sum of products" from the 
        article "The Functional Programming Language XSLT"
     -->

   <test-map-product:test-map-product/>

   <xsl:output method="text"/>

   <xsl:template match="/">
     <!-- Get: map product /sales/sale -->
     <xsl:variable name="vSalesTotals">
         <xsl:variable name="vTestMap" select="document('')/*/test-map-product:*[1]"/>
         <xsl:call-template name="map">
           <xsl:with-param name="pFun" select="$vTestMap"/>
           <xsl:with-param name="pList1" select="/sales/sale"/>
         </xsl:call-template>
     </xsl:variable>

     <!-- Get sum map product /sales/sale -->
      <xsl:call-template name="sum">
        <xsl:with-param name="pList" select="ext:node-set($vSalesTotals)/*"/>
      </xsl:call-template>
   </xsl:template>

    <xsl:template name="makeproduct" match="*[namespace-uri() = 'test-map-product']">
      <xsl:param name="arg1"/>

      <xsl:call-template name="product">
        <xsl:with-param name="pList" select="$arg1/*"/>
      </xsl:call-template>
    </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于以下 XML 文档时**：

```
<sales>
  <sale>
    <price>3.5</price>
    <quantity>2</quantity>
    <Discount>0.75</Discount>
    <Discount>0.80</Discount>
    <Discount>0.90</Discount>
  </sale>
  <sale>
    <price>3.5</price>
    <quantity>2</quantity>
    <Discount>0.75</Discount>
    <Discount>0.80</Discount>
    <Discount>0.90</Discount>
  </sale>
</sales> 
```

**产生正确的结果**：

7.5600000000000005

在最后一种情况下，我们`sale`计算和所有可用（可变数量）-s 的乘积。`price``quantity``discount`

[**FXSL**](http://fxsl.sf.net) **是高阶函数的纯 XSLT 实现。在这个例子中，高阶函数`f:map()`用于**将函数映射到`f:product()`每个`sale`元素的子元素列表中。然后将结果相加以产生最终结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T17:46:54.283

Dimitre 的所有解决方案都有效，他是对的，您*不需要*使用扩展功能，但有时它会让生活更轻松。这并不太有害，尤其是当您使用跨多个 XSLT 处理器支持的 exslt 扩展时。此外，您收到序列错误的原因可能是因为您使用的是 XSLT 1 处理器。

如果您想坚持使用您选择的解决方案，则需要使用 Saxon 或其他一些支持 XSLT 2 的 XSLT 处理器。

否则，这是在 XSLT 1 中执行此操作的另一种方法。这将适用于大多数 XSLT 处理器，并且某些人可能会发现它比递归版本更容易理解。就个人而言，我更喜欢递归版本（Dimitre 的第三个提案），因为它更便携。

```
<xsl:stylesheet version="1.0"
                xmlns:ex="http://exslt.org/common"
                xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output method="text"/>

  <xsl:template name="GetProducts">
    <xsl:param name="left"/>
    <xsl:param name="right"/>

    <xsl:for-each select="$left/text()">
      <product>
        <xsl:value-of select="number(.) * number($right[position()])"/>
      </product>
    </xsl:for-each>
  </xsl:template>

  <xsl:template match="/">
    <xsl:variable name="products">
      <xsl:call-template name="GetProducts">
        <xsl:with-param name="left" select="Parts/Part/Rate"/>
        <xsl:with-param name="right" select="Parts/Part/Quantity"/>
      </xsl:call-template>
    </xsl:variable>

    <xsl:value-of select="sum(ex:node-set($products)/product)"/>
  </xsl:template>
</xsl:stylesheet> 
```

# wordpress - WordPress 选项

> ID：436999
> 
> 赞同：0
> 
> 时间：2009-01-12T21:04:46.757
> 
> 标签：wordpress, wordpress-theming

今天我正在疯狂询问：P

无论如何...现在我正在开发一个免费的 WordPress 主题。问题是我想让它尽可能灵活，这就是为什么我会使用一些主题选项来设置一些 CSS 颜色、宽度等。我的问题是这样的：

如果我假设其中一个主题将用于流量大的博客，这将如何影响服务器性能？我会增加SQL查询吗？还是别的什么（错误）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-12T21:28:02.420

我认为 SQL 查询的数量不会增加。当然，除非您决定通过使主题在某种程度上由数据驱动来扩展 wopress 功能。

但是，模板/图像/CSS/javascript 文件的大小可能会对应用程序的性能产生一些影响。

作为一般经验法则，如果您担心基于 Web 的应用程序的性能，那么让您的文件尽可能轻量总是好的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-13T01:32:04.220

任何使用 WordPress 开发高流量博客的人几乎肯定会使用[WP Super Cache](http://wordpress.org/extend/plugins/wp-super-cache/)，这意味着几乎所有的页面浏览量都会导致（取决于是否使用超级位）0 或 1 个 SQL 查询，无论您的主题是什么.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-12T21:40:47.213

Wordpress 并不以对数据库的温和而闻名——尽管我想随着时间的推移可能会有改进的意图。

因此，添加额外的查询不会造成大问题。

但将其保留为一个查询：拥有所有选项，以便一个 SELECT 将它们全部获取，并在每个页面加载时调用一次。

或者，不要将选项存储在数据库中。有一个位于主题目录中的配置文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-13T02:26:19.480

如果您想保持较低的数据库负载，您不应该添加任何除了为您的主题提供样式之外的任何功能。（当然，我的意思是除了几乎所有主题中的默认数据检索功能。）

真正应该进行任何重要查询的主题的唯一部分是：

1.  [循环](http://codex.wordpress.org/The_Loop)中的常规零碎（用于主博客页面和存档页面）
2.  评论检索（针对单视图帖子）
3.  侧边栏（假设您要使用支持小部件的侧边栏）

我建议将额外的功能（因此，额外的数据库查询）留给插件 - 一个主题应该纯粹关注美学。******************