# StackOverflow 问答 10742000-10742999

# configuration - 有没有办法配置 dbx 将空白命令视为上一个命令的重复？

> ID：10742005
> 
> 赞同：4
> 
> 时间：2012-05-24T16:56:50.333
> 
> 标签：configuration, gdb, solaris, repeat, dbx

在 gdb 中，如果我只是按回车键，它会重复最后一个命令。有没有办法配置 Sun/Oracle/Solaris dbx 来做同样的事情？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T13:21:09.700

看起来您可以为此使用 $repeatmode 。我从[dbx-guide得到以下信息](http://techpubs.sgi.com/library/manuals/0000/007-0906-090/pdf/007-0906-090.pdf)

```
Repeating Commands

You can execute any of the commands contained in the history list. Each
history command begins with an exclamation point (!):

!!  Repeats the previous command. If the value of the dbx
variable $repeatmode is set to 1, then entering a carriage
return at an empty line is equivalent to executing !!. By
default, $repeatmode is set to 0. 
```

似乎还有另一个选项“gdb on”，它使 dbx 的行为类似于 gdb。我也没有尝试过，因为我现在无法访问 dbx，所以你可以告诉我这是否适合你。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-05T16:28:55.510

您可以通过在 dbx 中启用“gdb 模式”来获得该行为。

```
(dbx) gdb on
(dbx) step
stopped in main at line 4 in file "t.c"
    4       printf("world");
(dbx) 
step
stopped in main at line 5 in file "t.c"
    5       printf("!");
(dbx) 
step
stopped in main at line 6 in file "t.c"
    6       printf("\n");
(dbx) 
step
helloworld!
stopped in main at line 7 in file "t.c"
    7   } 
```

这是来自最新 dbx 的 gdb 模式的帮助。

```
(dbx) 帮助 gdb
gdb（命令）
gdb 上 | 离开
使用 `gdb on' 进入 dbx 会理解的 gdb 命令模式
并接受 gdb 命令。退出 gdb 命令模式并返回到 dbx
命令模式，输入“gdb off”。请注意，dbx 命令不会
在 gdb 命令模式下被接受，反之亦然。所有调试设置
例如断点在不同的命令模式下被保留。这
当前版本不支持以下 gdb 命令：
        - 命令 - 定义
        - 处理 - hbreak
        - 中断 - 维护
        -printf -rbreak
        - 返回 - 信号
        - tcatch - 直到

```

# php - jQuery 代码放置建议

> ID：10742009
> 
> 赞同：5
> 
> 时间：2012-05-24T16:56:59.933
> 
> 标签：php, jquery

我*知道*这听起来像是一个愚蠢的问题，但是当我通过示例学习 jQuery 时，我发现脚本和函数的位置因示例而异。举个例子，在某处我读到 .onReady 函数应该放在其他所有内容的下方，以确保整个 DOM 实际准备就绪，以及这种性质的事情。

问题很简单，除了明显的脚本标签之外，是否有关于 PHP 文件 jquery 应该位于何处的最佳实践？一次性内联脚本呢？对于这种天真的性质感到抱歉，但我会以“正确”的方式尝试这些示例，因为我想知道如何将它们组合在一起。

这个网站似乎有一些非常有见地的人做出贡献，所以提前感谢任何指导！:)

显然，它并不像我想象的那么愚蠢——感谢大家的见解——我对我试图从大局中理解的内容有了更清晰的认识。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-24T17:00:53.900

AFAIK，没有`.onReady`

也许你指的是`$(document).ready()`？

的重点`.ready()`是等待元素准备好。在这种情况下，文档。因此，在文档准备好之前，其中的任何内容都不会被执行。因此，您可以将其放在任何您想要的地方。

但是，至于链接到 JS 文件的位置，出于性能原因，您希望在文档底部执行此操作：

[http://developer.yahoo.com/performance/rules.html](http://developer.yahoo.com/performance/rules.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-24T17:01:08.887

不了解 PHP，但是将每个 onReady 代码放在底部 *“以确保整个 DOM 实际就绪”的指令* **是错误的**！

ready 事件的全部意义在于，您可以将它放置在您想要的任何地方，并且它仍然可以工作。

**例子：**

```
$('#foo').val() // undefined - the DOM isn't ready yet.

$(document).ready(function(){
    $('#foo').val() // bla - the DOM is ready now.
});
<input id="foo" value="bla" /> 
```

[**现场演示**](http://jsfiddle.net/w5k5t/)

请注意，`$(callbackFunction)`等于详细语法`$(document).ready(callbackFunction);`

你应该阅读[`ready`文档](http://api.jquery.com/ready/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-24T17:00:23.537

您应该`<script type="text/javascript"></script>`在关闭`<body>`页面标签之前包含您的标签。这将确保您在上面加载页面的所有静态部分。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-24T17:04:49.513

准备好的指令允许您将您的 javascript 代码放在任何地方。只有当文档准备好时才会执行。

语法如下：

```
$(document).ready(function() {
  // Put your code here.
}); 
```

或者这个：

```
$(function() {
 // Put your code here.
}); 
```

但要做出选择，出于性能原因，更喜欢页面底部，就在关闭</body>之前。

# php - 我怎样才能打印这些数据？（对象数据）

> ID：10742020
> 
> 赞同：1
> 
> 时间：2012-05-24T16:57:34.247
> 
> 标签：php, object

var_dump 结果：

```
object(stdClass)#2 (1) {
 [0]=>
  array(5) {
    ["title"]=>
    string(71) "Tarihte Bugün Neler Olmuş? Bugünün önemli olayları! | Ttbugun.com"
    ["keywords"]=>
    string(47) "tarih,tarih dersi,tarihte bugün,günün sözü"
    ["description"]=>
    string(69) "Tarihte bugün olan olaylar ve diğer tarihi olayların hepsi burada."
    ["author"]=>
    string(17) "Yusuf Ali Bozkır"
    ["id"]=>
    string(1) "1"
  }
} 
```

使用 var_dump：

```
var_dump($header->headers); 
```

我如何打印标题、描述和其他内容？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T17:02:35.490

试试这个

```
echo $header->headers{0}['title'];
echo $header->headers{0}['keyword'];
echo $header->headers{0}['description'];
echo $header->headers{0}['author'];
echo $header->headers{0}['id']; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T17:01:53.067

您可以尝试将其转换为这样的数组：

```
$array = (array)$header->headers; 
```

和往常一样使用 assoc 数组。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T17:02:02.247

我目前无法尝试，但我会执行以下操作：

```
echo $headers->headers->{'0'}['title']; 
```

# c# - 从 C# 中的 Object 继承是多余的吗？

> ID：10742021
> 
> 赞同：32
> 
> 时间：2012-05-24T16:57:45.883
> 
> 标签：c#, .net

如上所述，在c#中从Object继承是否是多余的？下面的两组代码是否会导致定义等效对象？

```
class TestClassUno : Object
{
    // Stuff
} 
```

对比

```
class TestClassDos
{
    // Stuff
} 
```

我在 MSDN 上四处窥探，但无法找到任何完全确定的信息。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-05-24T17:01:19.227

如果未指定，每个`class`定义都将隐式继承自，`System.Object`因此这两个定义是等价的。

这两者唯一不同的是，如果有人`Object`在同一个命名空间中实际定义了另一种类型。在这种情况下，本地定义`Object`将优先并更改继承对象

```
namespace Example {
  class Object { } 
  class C : Object { } 
} 
```

非常极端的案例，但如果我以前没有看过它就不会指出它

请注意，如果您使用`object`而不是`Object`. C# 关键字`object`是类型别名`System.Object`，因此它不会匹配`Example.Object`.

```
namespace Example2 { 
  class Object { } 
  class C : Object { } // Uses Example.Object
  class D : object { } // Uses System.Object
} 
```

当然，如果您有一个真正邪恶的开发人员，您仍然可能会引起混淆`object`

```
namespace System { 
  class Object { 
    private Object() { } 
  }
}

namespace Example3 {
  // This will properly fail to compile since it can't bind to the private
  // Object constructor.  This demonstrates that we are using our definition
  // of Object instead of mscorlib's 
  class C : object { } // Uses our System.Object
} 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-05-24T16:58:23.870

是的，如果定义为 ，一切最终都继承自一个对象`class`。将显式继承排除在代码之外。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-05-24T17:00:35.760

是的，从类中的对象继承是多余的

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2012-05-24T17:05:06.750

MSDN：[对象类](http://msdn.microsoft.com/en-us/library/system.object%28v=vs.80%29.aspx)：支持 .NET Framework 类层次结构中的所有类，并为派生类提供低级服务。这是 .NET Framework 中所有类的终极基类；它是类型层次结构的根。

检查这项研究：[从对象继承？调查如何。](http://www.ytechie.com/2009/04/int-inherits-from-object-an-investigation-into-how.html)

![在此处输入图像描述](../Images/34e373c1699f292dc718cbdb826495b3.png)

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-05-24T17:00:02.713

Object 是 .Net 中所有类的母体。上面没有任何东西。

所有类都继承自它。所以这段代码

```
class TestClassDos
{
    // Stuff
} 
```

自动意味着它是从对象继承的。

**证明**：您可以将任何实体类型转换为对象，如果它继承自它是可能的。

对象类摘要说

```
// Supports all classes in the .NET Framework class hierarchy and provides low-level
// services to derived classes. This is the ultimate base class of all classes
// in the .NET Framework; it is the root of the type hierarchy. 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-05-24T17:22:37.533

是的，它们都是一回事，我想我没有看到任何人提到结构，但是所有对象（即无论您声明一个类还是结构）它们最终都继承自**Object**，请参阅此[Object MSDN 文章](http://msdn.microsoft.com/en-US/library/ms173110%28v=VS.80%29.aspx)和此关于[结构](http://msdn.microsoft.com/en-US/library/saxz13w4%28v=vs.80%29.aspx)的其他文章

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-10-19T21:13:02.867

有时继承自是有意义的——当你有一个*定义*，并且你想锁定继承并防止其他部分声明扩展不同的类时。尝试从分部类中的另一种类型继承将给您[CS0263 Compiler Error](https://docs.microsoft.com/en-us/dotnet/csharp/misc/cs0263)。`object``partial class`

这仅在您的部分类尚未从其他类型继承的情况下才有意义。

该`partial`关键字不在您的代码示例中，但我认为它可能值得一提，因为在看到 API 中的类似设置后，我从 Google 找到了我的方式。除了像其他人指出`object`的那样从不指向官方的 s 继承之外，这样做没有任何好处，因为所有类都隐式地继承自。`System.Object``object`

# mysql-workbench - MySQL Workbench... 填充 fk 列

> ID：10742044
> 
> 赞同：0
> 
> 时间：2012-05-24T16:59:19.610
> 
> 标签：mysql-workbench

我是 MySQL Workbench 的新手，并且对数据库 (MS Access) 有一些经验。我无法用数据填充我的 fk。这是我的数据库架构中的内容：

*   2 个表 Block 和 Set（具有 pk Block_ID（INT 类型）的 Block；Set 具有 fk 到具有 fk 名称 Set_Block_ID（INT 类型）的 Block。
*   从 Block 到 Set 表创建的一对多关系将 Block_ID 链接到 Set_Block_ID。建立关系，没有问题
*   我用数据填充块表。没问题
*   然后我去用数据填充 Set 表。我可以看到我所有的专栏，但看不到 fk。我的问题是为什么？

我在 MS Access 中创建了完全相同的数据库，我的 fk 显示在链接表中，我可以在 MS Access 确保执行引用完整性的同时填充它。我对 Workbench 真的很陌生，无法弄清楚为什么我看不到和填充我的 fk 列。

任何帮助表示赞赏！谢谢！！=)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-02-18T21:10:21.420

正如您所注意到的，关系绘制工具不会创建实际的外键约束。

但是，如果双击引用表并切换到外键选项卡，则可以创建引用并指定所涉及的列。这会自动生成并维护视觉链接：

![在此处输入图像描述](../Images/955b97a4c6c5eeb3c51fa562ce2a364f.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T07:25:59.590

在消化了对我的问题的所有回复（请注意此处的讽刺）之后，我终于找到了解决问题的解决方法。回顾一下：

问题：

*   使用 PK 和 FK（1 .. n 关系）与 Workbench 创建了一个简单的 2 表关系
*   FK 列在表格编辑中不可见，因此无法输入任何参考数据

解决方案：

*   安装 SQLyog 并连接到同一台服务器
*   打开同一个数据库并重做简单的 1 .. n 关系
*   在 SQLyog 中编辑可见的 FK 列
*   同样，FK 列可见，可在 Workbench 中进行编辑

正如我所说，我对这一切都是新手，所以我不知道 Workbench 中的问题是什么。我只知道它现在*似乎*工作正常。

# magento - 登录页面的重复内容问题

> ID：10742052
> 
> 赞同：1
> 
> 时间：2012-05-24T16:59:55.767
> 
> 标签：magento, seo

我正在使用 SEOmoz 从 SEO 角度评估我的商店。它为客户登录页面引发重复内容错误。典型的 URL 如下所示：

www.site.com/customer/account/login/referer/aHR0cDovL3d3dy5tbW1zcGVjaW9zYS5jb20vcmV2aWV3L3Byb2R1Y3QvbGlzdC9pZC8xOTYvY2F0ZWdvcnkvNC8jcmV2aWV3LWZvcm0%2C/

我已将包括登录在内的标题链接配置为使用“rel=nofollow”，但也许我需要将“canonical”标签添加到登录页面。我将如何在 XML 中执行此操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T17:41:52.843

你真的应该把它添加到你的 robots.txt 文件中的禁止列表中。这是最简单的方法。

```
User-agent: *
Disallow: /customer/ 
```

[有关RogerBot](http://www.seomoz.org/dp/rogerbot)的更多信息。

# python - Mongoengine Uwsgi Dbref 属性错误

> ID：10742053
> 
> 赞同：0
> 
> 时间：2012-05-24T16:59:58.307
> 
> 标签：python, mongodb, flask, uwsgi, mongoengine

我的烧瓶应用程序中有一个奇怪的错误。问题是下面的代码在 Flask 开发服务器中运行良好，但在生产服务器（Uwsgi+Nginx）中失败。该代码的目的是从 mongoDb 检索整个集合并将其内容作为 JSON 提供。

我没有使用 virtualenv，因为我在虚拟机下工作，而且我没有在该机器上运行任何其他项目。所以堆栈是这样的：

Python Flask MongoDb->MongoEngine Uwsgi NginX

我有两个模型：

公司一份：

```
class Company(Document):
    name = StringField(max_length=50)
    .... 
```

一个用于活动：

```
class Campaign(Document):
    name = StringField(min_length=8)
    company = ReferenceField(Company)
    .... 
```

路由是这样完成的：

```
@app.route('/getjson', methods=['GET', 'POST'])
    def getJson():
        if request.method == 'GET':
        collection = request.args.get('collection')
        if collection == 'Campaign':
            return jsonify (getCampaign()) 
```

getCampaign() 函数是这样的：

```
def getCampaign():
    theCollection = Campaign.objects.all()
    theDict = {}
    for obj in x:
        dict_model = {
            obj.name:
            {
            'company': obj.company.name,
            ...
            }
    theDict.update(dict_model)
return theDict 
```

这会产生一个格式良好的 Json，其中“application/json”作为 Content-Type。问题是当在生产服务器上尝试相同的代码时，它会惨遭失败并抛出以下错误！

```
 Traceback (most recent call last):
  File "/usr/local/lib/python2.6/dist-packages/flask/app.py", line 1518, in __call__
    return self.wsgi_app(environ, start_response)
  File "/usr/local/lib/python2.6/dist-packages/flask/app.py", line 1506, in wsgi_app
    response = self.make_response(self.handle_exception(e))
  File "/usr/local/lib/python2.6/dist-packages/flask/app.py", line 1504, in wsgi_app
    response = self.full_dispatch_request()
  File "/usr/local/lib/python2.6/dist-packages/flask/app.py", line 1264, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/usr/local/lib/python2.6/dist-packages/flask/app.py", line 1262, in full_dispatch_request
    rv = self.dispatch_request()
  File "/usr/local/lib/python2.6/dist-packages/flask/app.py", line 1248, in dispatch_request
    return self.view_functions[rule.endpoint](**req.view_args)
  File "./mobuy.py", line 58, in getJson
    return jsonify (getCampaign())
  File "./jsonOut.py", line 36, in getCampaign
    'company': obj.company.name,
  File "/usr/local/lib/python2.6/dist-packages/bson/dbref.py", line 88, in __getattr__
     raise AttributeError(key)
  AttributeError: name 
```

运行 " 'company': "%s" % **obj.dict** " 会抛出这个结果：

```
"company":"{'_created': False, '_data': {'status': 3, 'startDate':
datetime.datetime(2012, 5, 23, 20, 22, 28, 42000), None: ObjectId('4fbd4704f65b813c5900000d'), 
'EndDate': datetime.datetime(2012, 5, 23, 20, 22, 28, 42000), 
'name': u'Campaign13', 'max_claimed': 39, 'text': u'a discount', 
'company': DBRef(u'company', ObjectId('4fbd36f2f65b813869000008')),
'image': u'http://www.Company8.com/image.jpg', 'Shops': [],
 'category': 5, 'id': None, 'coupons': []},
 '_id': ObjectId('4fbd4704f65b813c5900000d'), '_changed_fields': [],
 '_initialised': True}", 
```

帮助！为什么这在开发服务器中工作而不在 Uwsgi 中工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T17:05:41.923

Tty 将 --lazy 添加到您的 uWSGI 选项中。也许您的 mongodb 驱动程序对 fork() 不友好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T17:45:09.503

您在开发中的 mongoengine 和 uwsgi / nginx 中是否有相同的版本？

你能试试这个：

```
Campaign.objects.all().select_related() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-26T11:52:01.727

我找到的解决方案是，我绕过问题，直接用pymongo查询数据库

```
#init pymongo dor dbfer quering as uwsgi fails miserably
connection = Connection()
db = connection.mobuy_test
company_collection = db.company
campaign_collection = db.campaign
for obj in Campaign.objects.all(): #the mongoengine queryset loop
    theId = campaign_collection.find_one({'_id':obj.id})['company'].id
    companyName = company_collection.find_one({'_id':theId})['name']
    dict_model = {
                  'campaign_name': obj.name,
                  'campaign_company':companyName
                   ...
                  } 
```

不确定我是否正确使用了 pymongo 查询，但这目前有效，唯一的问题是，它很脏。

# msbuild - 有什么方法可以更新 MSBuild 项元数据值？

> ID：10742059
> 
> 赞同：4
> 
> 时间：2012-05-24T17:00:15.960
> 
> 标签：msbuild

我需要更新项目元数据值。很容易**增加**价值：

```
<ItemDefinitionGroup>
  <ClCompile>
    <PreprocessorDefinitions>FOO;BAR;%(PreprocessorDefinitions)</PreprocessorDefinitions>
  </ClCompile>
</ItemDefinitionGroup> 
```

但是，我需要做的是**删除**部分价值。理想情况下，这样的事情会起作用，但它不会：

```
<ItemDefinitionGroup>
  <ClCompile>
    <PreprocessorDefinitions>%(PreprocessorDefinitions.Replace('FOO;',''))</PreprocessorDefinitions>
  </ClCompile>
</ItemDefinitionGroup> 
```

有没有办法在 MSBuild 4 中实现这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T18:39:42.273

我试图做同样的事情，虽然我不知道如何从字符串中删除定义，但我确实发现了一个额外的属性：`UndefinePreprocessorDefinitions`.

```
<ItemDefinitionGroup>
  <ClCompile>
    <UndefinePreprocessorDefinitions>FOO</UndefinePreprocessorDefinitions>
  </ClCompile>
</ItemDefinitionGroup> 
```

这将取消之前对 FOO 的定义。传递给编译器而不是什么都不传递可能看起来有点傻`-DFOO -UFOO`，但它也同样有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-02-18T03:12:14.810

在随后的`ItemDefinitionGroup`中，您可以[创建](https://msdn.microsoft.com/en-us/library/system.string.copy(v=vs.110).aspx)当前元数据的副本，然后对其调用[Replace](https://msdn.microsoft.com/en-us/library/system.string.replace(v=vs.110).aspx)：

```
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="12.0" DefaultTargets="Dump" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">

  <ItemDefinitionGroup>
    <SomeItem>
      <SomeMetaData>foo,bar,baz</SomeMetaData>
    </SomeItem>
  </ItemDefinitionGroup>

  <ItemGroup>
    <SomeItem Include="one;two" />
  </ItemGroup>

  <ItemDefinitionGroup>
    <SomeItem>
      <!-- Remove "bar" -->
      <SomeMetaData>$([System.String]::Copy('%(SomeMetaData)').Replace('bar',''))</SomeMetaData>
    </SomeItem>
  </ItemDefinitionGroup>

  <Target Name="Dump">
    <Message Text="SomeItem.SomeMetaData: @(SomeItem -> '%(Identity)=%(SomeMetaData)') " />
  </Target>
</Project> 
```

下面是使用 MSBuild 14 运行时的输出：

```
 > MSBuild .\foo.proj
Microsoft (R) Build Engine version 14.0.25420.1
Copyright (C) Microsoft Corporation. All rights reserved.

Build started 2/17/2017 7:09:48 PM.
Project "D:\temp\mb\foo.proj" on node 1 (default targets).
Dump:
  SomeItem.SomeMetaData: one=foo,,baz;two=foo,,baz
Done Building Project "D:\temp\mb\foo.proj" (default targets).

Build succeeded.
    0 Warning(s)
    0 Error(s)

Time Elapsed 00:00:00.03 
```

# android - Android 使用 WPS 连接

> ID：10742060
> 
> 赞同：2
> 
> 时间：2012-05-24T17:00:16.443
> 
> 标签：android, wifi

在我的应用程序中，我可以使用 presharedkey 毫无问题地连接到 wifi 网络。我的手机（Galaxy Nexus）能够通过 wifi-network-settings 中的 WPS 进行连接。

但现在我正在尝试使用 WPS pin 方法连接到 wifi 网络。（在设备上输入密码）我搜索了很多，发现“android.net.wifi.WpsInfo” [http://developer.android.com/reference/android/net/wifi/WpsInfo.html](http://developer.android.com/reference/android/net/wifi/WpsInfo.html)

有了这个我可以设置 WPS 设置，但是我如何使用它来连接到 wifi 网络？

我几天前才开始编写android-apps，请有更多经验和知识的人帮助我吗？

（我使用的是 api15，Android 4.0.3）

# android - 具有不同侦听器的按钮顶部的按钮

> ID：10742066
> 
> 赞同：-2
> 
> 时间：2012-05-24T17:00:58.917
> 
> 标签：android, android-button

> **可能重复：**
> [Android 按钮工具提示](https://stackoverflow.com/questions/10506543/android-button-tooltip)

有没有办法构建一个`Button`存在于另一个之上的视图`Button`？每个按钮都需要有自己独特的`onClick`听众。

下图显示了我试图在 Android 中实现的 iOS 版本。

“i”部分是另一个图像，显示了各种工具提示。该视图当前是一个`LinearLayout`.

![在此处输入图像描述](../Images/25357b661b3fe401cdcaab31d0c088bb.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T17:02:09.150

是的，这很容易。从 RelativeLayout 或类似开始，然后照常进行。

**添加**

您已经问过这个完全相同的问题：[Android Button Tooltip](https://stackoverflow.com/q/10506543/1267661)

# c - 从 cstring 中删除空字符

> ID：10742071
> 
> 赞同：1
> 
> 时间：2012-05-24T17:01:18.627
> 
> 标签：c

```
#ifndef UNICODE
#define UNICODE
#endif

#include <Windows.h>
#include <cstring>
#include <cstdio>

int main()
{
    TCHAR* greeting = L"HELL\0O W\0ORLD!";

    wprintf(L"%s\n",greeting);

    _wsystem(L"pause");
    return 0;
} 
```

如何删除“问候”中的所有空字符（尾随除外）？我想避免从头开始创建函数。我的意思是 PHP 的 str_replace 的 C++ 对应物。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-24T17:04:48.750

不幸的是，之后

```
TCHAR* greeting = L"HELL\0O W\0ORLD!"; 
```

字符串的长度丢失。运行时只会看到

```
greeting == L"HELL"; //HA! 
```

您需要存储字符串的长度并手动移动字符。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-24T18:51:20.337

像这样的东西：

```
TCHAR greeting[] = L"HELL\0O W\0ORLD!";
TCHAR *writepos = greeting;
for (int i = 0; i < sizeof(greeting) - 1; ++i) {
    if (greeting[i] != 0) {
        *writepos++ = greeting[i];
    }
}
*writepos = 0;

wprintf(L"%s\n",greeting); 
```

重要的一点是，当您仍然知道数据的长度时，您需要删除 nul 字符。我们可以使用 , 轻松获取字符串文字的大小（或在我的代码中，文字的副本）`sizeof`，其中包括 nul 终止符。如果输入不是真正的字符串文字，而是从某个地方读取的，则您需要知道读取的数据的大小。

如果你曾经传递一个指向没有长度的数据的指针，那么你就完成了。长度一旦丢失就无法恢复。

C 没有从字符串或缓冲区中删除特定字符的标准函数。C++ 有`std::remove_copy_if`，但我希望这对你没用。

# google-maps - 谷歌地图上基于参数强度的热图

> ID：10742074
> 
> 赞同：12
> 
> 时间：2012-05-24T17:01:30.273
> 
> 标签：google-maps, heatmap

我收集了一些带有位置标记的 Wi-Fi 网络的性能数据。现在我可以在“本地”谷歌地图上显示我获取数据的位置。我想在谷歌地图上显示一个热图，以便参数的值设置颜色。
例如：带宽：最大值 1000 最小值 10
位置 1，带宽 1000 -> 红色
位置 2，带宽 15 -> 蓝色
位置 3，带宽 500 -> 橙色等等
我需要可以插值的东西数据并获得如下内容： [![一只忙碌的猫](../Images/63c32190a90bde686268612b82a0ebfa.png)](https://i.stack.imgur.com/GCU3d.png)

我尝试过 Google 的融合地图，但热图仅基于位置的密度，而不是参数的值。那是对的吗？
我想使用谷歌地图，但如果有更简单的东西，我可以使用它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-30T10:10:09.907

我找到了一个关于如何使用本地工作的谷歌地图创建热图的解决方案：[heatmap.js](http://www.patrick-wied.at/static/heatmapjs/)。
我已经使用并且在我的范围内工作得很好。谢谢

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T18:13:37.277

这不是您想要的，但您可以查看[HeatmapApi](http://www.heatmapapi.com/)。

有一个最大的免费版本。100 个数据点。关于您的要求的主要限制是您无法调整配色方案。此功能在他们的网页上公布，但没有日期。

我在过去几天尝试了 API，它按预期和承诺工作。它作为 Web 服务提供，并采用 [lat, lng, value] 格式的参数来计算热图。

# c - 知道如何在 C 中使用 TUI 制作按钮吗？

> ID：10742076
> 
> 赞同：1
> 
> 时间：2012-05-24T17:01:42.443
> 
> 标签：c, windows, console, tui

我正在开发一个基于控制台的 C 项目，我希望它有一些按钮。

*   我怎样才能添加一些？
*   如何管理注意力？

我`windows.h`用于制作 TUI。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T17:35:12.553

基本上使用面板库（添加到ncurses）并制作第二个带有边框的窗口，其中包含您的“按钮文本”。请记住指定 z 顺序，以便第二个窗口浮动在第一个窗口上，最好是在第一个窗口的非文本包含部分上。

然后绑定键导航，其他窗口的鼠标进入/退出例程将焦点直接指向“下一个”所需窗口并切换该窗口的颜色（以指示突出显示）。最后为窗口提供一个键处理程序来捕获输入/空格/任何作为按钮单击的内容（然后可以调用您绑定到它的任何函数）。

虽然使用菜单功能可能有更好的方法来做到这一点，但我没有发现（在我公认的快速搜索中）一种将“菜单窗口”的菜单显示与显示菜单窗口以外的操作挂钩的方法.

# objective-c - 为什么使用 NSDate 将双精度转换为字符串会增加 30 分钟

> ID：10742078
> 
> 赞同：0
> 
> 时间：2012-05-24T17:01:56.967
> 
> 标签：objective-c, ios, xcode, nsdate, nsdateformatter

```
double duration = 20; // duration is in seconds 

NSDate* durationDate = [[NSDate alloc]initWithTimeIntervalSinceReferenceDate:duration];

NSDateFormatter *formatter = nil;

formatter = [[[NSDateFormatter alloc] init] autorelease];
[formatter setDateFormat:@"mm:ss"];

NSString *durationString=[formatter stringFromDate:durationDate];//here durationString should have 20 
```

但我得到了 30:20？从哪里添加这 30 分钟。我试过给更大的数字然后也是同样的结果

请让我知道对此的想法以及如何解决这个问题

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-24T17:07:13.617

你可能在印度标准时间？

参考日期定义为格林威治标准时间午夜。IST 是 GMT+5:30。

因此，当您将 20 秒添加到参考日期时，您会得到 GMT 午夜后 20 秒。然后，当您创建日期格式化程序并且不对其进行任何其他设置时，它将在您设备的自然时区中运行。这意味着当您在时间结束时询问分钟和秒时，您会得到 30 分钟和 20 秒。

`NSDate`s 是绝对时间，是任何时区或日历的抽象。如果五个不同时区中的五个设备都`[NSDate date]`同时调用以获取当前时间，那么它们都将获取具有相同值的对象。

`NSDateFormatter`将 an`NSDate`与 an`NSCalendar`和 an结合`NSTimeZone`以确定分钟、秒、小时、月、年等。

# c# - 如何设置 WCF 代理中继服务

> ID：10742079
> 
> 赞同：1
> 
> 时间：2012-05-24T17:01:58.010
> 
> 标签：c#, asp.net, wcf, iis

我正在用 C# 编写一个 ASP.net 仪表板应用程序。该应用程序将收集警报统计信息并通过 Ajax(jQuery) 将它们显示在仪表板上。

该应用程序可以跨域收集警报统计信息，因此我们选择如下设置：

独立的 Windows 服务通过与 Broker（一个收集统计信息的程序）的持续连接运行。在 Windows 服务中，我们托管了 WCF 服务。Windows 服务会将统计信息字符串加载到 WCFExternalService 中。

然后我们设置一个托管在 IIS 中并在客户端应用程序中引用的 WCF 服务（该服务将充当中继/代理服务）。

有人可以指点我一篇文章或解释如何设置绑定/端点以将代理服务连接到外部 WCF 服务吗？

提前感谢您对此的任何帮助！

拉里

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T18:06:57.643

看起来您已经完成了大部分结构。我的输入如下：

*   WCF 代理（在 UI 层中）可以实现与其对应的 WCF 服务（在 Windows 服务中）相同的服务契约。但是，WCF 代理将是真正的 WCF 服务的“客户端”（您需要在 Web.config 中进行配置）。

*   `WebInvoke`现在，使用属性启用 jQuery / JavaScript 使用 WCF 代理。`[WebInvoke("GET", WebMessageBodyStyle.WrappedRequest, ResponseFormat:=WebMessageFormat.Json)]`

*   使用 jQuery $.ajax 语法来使用您的 WCF 代理。`url`应该等效于“http://myHost/myVirtual/MyProxy.svc/MyMethod”，并且应该`data`是等效于 WCF 代理参数的 JSON 字符串。

**关于第一点的进一步解释：**

[这篇](http://msdn.microsoft.com/en-us/library/ms735103.aspx)MSDN 文章解释了如何设置 WCF 客户端（由您的代理 WCF 使用）。

接下来，您可以创建一个代理 WCF 服务来使用 WCF 客户端。

您网站的 Web.config（包含代理）需要 WCF 客户端和 WCF 代理部分。

在 WCF 中托管无关紧要，因此您的“真实”服务可以根据您的要求和环境支持任何绑定（Http、Tcp）

# javascript - 如何在 InDesign 中使用 ExtendScript 以编程方式将文本设置为“小写字母”？

> ID：10742081
> 
> 赞同：1
> 
> 时间：2012-05-24T17:01:59.233
> 
> 标签：javascript, adobe, extendscript, adobe-indesign

我正在尝试做相当于选择一些文本并单击*Small Caps*按钮的操作。以下是一些尝试：

```
app.activeDocument.textFrames[0].texts.appliedCharacterStyle.capitalization = Capitalization.SMALL_CAPS; 
```

不起作用：“对根样式的请求无效”

```
var myCharacterStyle = new CharacterStyle();
myCharacterStyle.capitalization = Capitalization.SMALL_CAPS;
app.activeDocument.textFrames[0].texts[0].applyCharacterStyle(myCharacterStyle); 
```

不起作用：“方法'applyCharacterStyle'的参数'using'的值无效。预期的CharacterStyle，但什么也没收到。”

我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T09:40:19.320

如果要更改默认的“[无]”，则需要先创建新的字符样式

```
//First create a new character style
var newCharacterStyle = document.characterStyles.add(text.appliedCharacterStyle);
if(text.appliedCharacterStyle!=null){
    newCharacterStyle.basedOn = text.appliedCharacterStyle;
}   
text.appliedCharacterStyle = newCharacterStyle;

//then apply capitalization
newCharacterStyle.capitalization = Capitalization.SMALL_CAPS; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T17:43:33.847

我发现了一种在文本上设置*Small Caps的***错误方法：**

 *```
app.activeDocument.textFrames[0].texts[0].appliedParagraphStyle.capitalization = Capitalization.SMALL_CAPS; 
```

我说**buggy**是因为不是只在想要的文本上设置*Small Caps* ，而是整个段落的样式。之所以如此，是因为我使用`appliedParagraphStyle`而不是`appliedCharacterStyle`. 但是当我使用时`appliedCharacterStyle`，我得到“根样式的无效请求”。因为电流`CharacterStyle`是那个特殊的，叫做“[None]”。"[None]" CharacterStyle 不允许写入其applyCharacterStyle 属性，也不允许重复（使用`duplicate()`）。*

# html - 自定义 Twitter Bootstrap 默认网格

> ID：10742082
> 
> 赞同：2
> 
> 时间：2012-05-24T17:02:02.100
> 
> 标签：html, css, twitter-bootstrap, less, responsive-design

我正在尝试将默认 Bootstrap 网格中的列数从 12 更改为 8。根据[Bootstrap 文档](http://twitter.github.com/bootstrap/scaffolding.html)，这涉及更改`@gridColumns`变量，然后在 responsive.less 中自定义网格。

我试图编辑 responsive.less 中的网格（以及它导入的文件），但我做错了。将网格从 12 列更改为 8 列需要哪些特定值？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-24T17:35:17.503

打开 variables.less 它包含您需要在底部附近更改的所有变量：

```
@gridColumns:             16;
@gridColumnWidth:         45px;
@gridGutterWidth:         16px; 
```

确保您加载的是 less 而不是 css

# objective-c - 无法通过事件点击在某些应用程序上模拟退格按钮

> ID：10742086
> 
> 赞同：1
> 
> 时间：2012-05-24T17:02:11.327
> 
> 标签：objective-c, macos, cocoa, cgeventtap

我正在尝试在 Mac OS 上模拟一些按键。如果按下“h”键（例如，如果用户键入“tigh”，它将变为“ti”），此代码应该通过修改键盘事件删除前一个字符。但是它只适用于某些应用程序；其他人完全拒绝我的活动。这段代码有问题吗？

```
- (void)applicationDidFinishLaunching:(NSNotification *)aNotification
{
    CFMachPortRef      eventTap;
    CGEventMask        eventMask;
    CFRunLoopSourceRef runLoopSource;

    eventMask = ((1 << kCGEventKeyDown) | (1 << kCGEventKeyUp));

    eventTap = CGEventTapCreate(kCGSessionEventTap, kCGHeadInsertEventTap, 0,
                                eventMask, KeyHandler, NULL);
    if (!eventTap) {
        fprintf(stderr, "failed to create event tap\n");
        exit(1);
    }

    runLoopSource = CFMachPortCreateRunLoopSource(kCFAllocatorDefault, eventTap, 0);
    CFRunLoopAddSource(CFRunLoopGetCurrent(), runLoopSource, kCFRunLoopCommonModes);    
    CGEventTapEnable(eventTap, true);
    CFRunLoopRun();
}

CGEventRef KeyHandler(CGEventTapProxy proxy, CGEventType type, CGEventRef event, void *refcon)
{
    UniCharCount actualStringLength;
    UniCharCount maxStringLength = 1;    
    UniChar chars[3];

    CGEventKeyboardGetUnicodeString(event, maxStringLength, &actualStringLength, chars);

    if (chars[0] == 'h') {
        chars[0] = '\b';
        CGEventKeyboardSetUnicodeString(event, 1, chars);
        return event;        
    }

    return event;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T17:54:34.347

一些应用程序根据事件 ( `CGEventGetIntegerValueField(event, kCGKeyboardEventKeycode)`) 中的键代码而不是事件的`UnicodeString`.

也就是说，您需要将事件的`kCGKeyboardEventKeycode`值从“h”提供的**4更新为****51**或退格键 ( **0x33** )。

# database - 3NF中的数据库关系？

> ID：10742094
> 
> 赞同：1
> 
> 时间：2012-05-24T17:02:34.487
> 
> 标签：database, relational-database, normalization, 3nf

我有以下关系。一家公司有多名员工。每个员工都由其员工编号定义，`ENr`并且他住在一个`EAddress`带有 ZipCode的地址上`ZZipCode`。带有 ZipCode 的 City 是一个自己的表，因为否则表 Employee 中存在冗余。因此`ZZipCode`是 Employee 中的外键。

一个 Group 由它定义`GGroupId`，因此它是主键。每个组有一个组长，可以是任何员工。因此`ENr`是外键。

每个员工都可以在一个或多个组中工作。出于这个原因，该表`GroupMember`存在于元组`ENr`和`GGroupID`定义主键并且两者都是外键的位置（我不能同时使用粗体和斜体）。

最后，产品由其产品 id 定义`PId`并关联到一个组`GGroupID`。

那么这里是该书面描述的关系。

> Employe( **ENr** , EName, EGender, EAddress, *ZZipCode* , ESocNr, ESalery)
> Group( **GGroupId** , GName, GCostNr, *ENr* ) GroupMember
> ( **ENr** , **GGroupID** ) #both 成员也是外键！
> 产品（**PId**，PName，PPrice，*GGRoupId*）
> 邮编（**ZZipCode**，ZCityName，*SStateID*）
> 状态（**SStateID**，SStateName）

为了澄清：**粗体**成员是主键，*斜体*成员是外键。

我试图将这种关系放入`3NF`. 任何人都可以确认这是正确的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T13:20:06.450

这似乎很好并且正常化。我没有看到表格的任何进一步划分。

# matlab - matlab中的正态分布函数

> ID：10742095
> 
> 赞同：1
> 
> 时间：2012-05-24T17:02:35.000
> 
> 标签：matlab, normal-distribution

为这个愚蠢的问题道歉，数学不是我的强项。我正在尝试在 matlab 中设计一个函数，该函数根据 d 维中的正态分布 N(mu, sigma) 生成样本。这是我到目前为止的代码，

```
mu = [1 2];
Sigma = [1 .5; .5 2]; R = chol(Sigma);
z = repmat(mu,100,1) + randn(100,2)*R; 
```

我通过阅读各种维基百科和谷歌文章发现了这一点，想知道它是否正确？提前致谢，

生锈的

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T17:12:18.963

简短的回答 - 是的。

稍微长一点的答案 - 为什么不自己尝试呢？

```
>> z = repmat(mu,1000000,1) + randn(1000000,2)*R;
>> mean(z)
ans =
        1.001       2.0005
>> cov(z)
ans =
      0.99937      0.49942
      0.49942       2.0017 
```

# javascript - 我的代码有什么问题？（Threejs聚光灯阴影）

> ID：10742097
> 
> 赞同：0
> 
> 时间：2012-05-24T17:02:41.117
> 
> 标签：javascript, webgl, three.js

我在 Three.js 中创建了一个场景，平面上有两个立方体。聚光灯位于左上角，它应该看给定的坐标 50、0、-50。

阴影看起来很奇怪，而且光线没有看给定的坐标（我试过`light.target.position.set`，和`light.lookAt`）

链接：http: [//jsfiddle.net/5gNvr/](http://jsfiddle.net/5gNvr/)

提前致谢，

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-24T17:36:01.893

这是错误的：

```
cube.position = {
    x: -50,
    y: 15,
    z: 50
}; 
```

*position*是一个*Vector3*并且您将其替换为一个失去其所有方法的*对象*（灯光可能依赖这些方法）。

改为这样做：

```
cube.position.set( -50, 15, 50 ); 
```

这可能会也可能不会解决您的问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-24T19:28:35.263

尝试将灯光的 fov 增加到 75。

```
light.shadowCameraFov = 75; 
```

# python - 在 Gunicorn 配置文件中访问 Django 代码

> ID：10742099
> 
> 赞同：1
> 
> 时间：2012-05-24T17:02:57.513
> 
> 标签：python, django, gunicorn

我正在将 Django 应用程序从 modWSGI 转换为 Gunicorn/NGINX。我有一些从 modwsgi 文件运行的 django 代码，以确保它在服务器启动时运行。我试图弄清楚如何让它在 Gunicorn 启动时工作。

免责声明 - 我想要访问的代码是一个穷人的缓存，它处理来自数据库的数据并将其存储为一种对我稍后在 Django 应用程序中所做的许多事情都很友好的格式。 **与使用缓存解决方案相比，这个问题与此方法的优点无关。**

这是我在 mod-WSGI 中运行得很好的代码：

```
sys.path.append('/src/accx/navigation')
from navigation.views import rebuild_cache_all
rebuild_cache_all() 
```

其中“accx”是 Django 项目，“navigation”是 Django 应用程序。

现在，我正在尝试使用 Gunicorn 来做同样的事情。

```
def when_ready(server):
    from navigation.views import rebuild_cache_all
    rebuild_cache_all() 
```

我还尝试在此代码的各个位置附加到 sys.path，但无论我做什么，我都会收到以下错误：

```
ImportError: No module named navigation.views 
```

我错过了一些明显的东西吗？我会以错误的方式解决这个问题吗？任何和所有的指导表示赞赏！

**.............回答......**
在输入上述问题后，我正在仔细阅读其他一些与我的“相关”的gunicorn问题问题，但没有出现在我的搜索中。在这样做的同时，我发现了我的问题。

**尾随斜线！**

尝试添加到 gunicorn 中的 sys.path 时，我没有使用一个。一旦我解决了这个问题，gunicorn 开始抱怨它丢失了它的 Django_settings_module，所以我最终也不得不提供它。

这是我现在可以使用的：

```
import sys,os
if not '/src/accx-venv/' in sys.path:
    sys.path.insert(0,'/src/accx-venv/')

os.environ["DJANGO_SETTINGS_MODULE"] = "accx.settings"

def when_ready(server):
    if not '/src/accx-venv/accx/' in sys.path:
        sys.path.insert(0,'/src/accx-venv/accx/')
    from navigation.views import rebuild_cache_all
    rebuild_cache_all() 
```

可能还有另一种更清洁的方法，但这让我工作。

# cron - 用于备份目录的简单 Cronjob

> ID：10742105
> 
> 赞同：4
> 
> 时间：2012-05-24T17:03:17.777
> 
> 标签：cron, zip, crontab

我知道这看起来很微不足道，但我看不到让它在 cronjob 中工作。

我在跑步

```
zip -r /backup/$(date +'%Y%m%d').zip /var/www 
```

这工作正常。它在我的备份目录中为我提供了 zip 文件。

但我会打开 Cron 选项卡

```
crontab -e 
```

我将它附加到文件的底部，以便它每天更新。

这是它不起作用的地方。

我究竟做错了什么？

编辑：crontab 看起来像

```
0 1 * * * /home/serveradmin/backup.sh 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-11-17T20:05:17.160

在 cron 中，`%`（百分比）符号需要转义。`\`您应该在百分号前用（反斜杠）注释掉百分号。IE，

> 日期+\%Y-\%m-\%d-\%H-\%M

# c# - 在 MVC 中处理长查询字符串的最佳方法是什么？

> ID：10742108
> 
> 赞同：3
> 
> 时间：2012-05-24T17:03:27.317
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, c#-4.0

我正在开发一个可能有很长的查询字符串来维护状态的应用程序。

我不确定在操作方法中处理这些长查询字符串的最佳方法是什么，因为我最终会得到一个非常长的参数列表。

最好直接从请求对象访问查询字符串参数，还是应该继续创建一个参数列表很长的操作方法？

即需要传入一个配置参数来自定义页面。所以我们可能有这样一个查询字符串：?rid=123&bid=456&cid=789&did=aaa&bg=333&f=999&.....

```
 public ActionResult AvailableTimes(int rid, int bid, int cid, string did, string bg, string f......)
        {
          // Do stuff
        } 
```

或者

```
public ActionResult AvailableTimes()
        {
          var query = Request.Query;
          // Do stuff
        } 
```

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-24T17:27:54.497

创建一个包含查询字符串的所有参数的类。然后在您的操作结果中，使用对象而不是所有参数。

```
public ActionResult AvailableTimes(TimeItem time)
        {
          // Do stuff with time
        }
public Class TimeItem
{
    int rid { get; set; }
    int bid { get; set; }
    int cid { get; set; }
    string did { get; set; }
    string bg { get; set; }
} 
```

# java - 如何在本地构建中触发对 yaml 文件的处理？

> ID：10742112
> 
> 赞同：2
> 
> 时间：2012-05-24T17:03:40.560
> 
> 标签：java, google-app-engine

我正在开发一个 GAE/Java 应用程序，今天我阅读了有关使用 app.yaml、queue.yaml 等更简单地指定要进入 web.xml、appengine-web.xml 的值的信息。以前我一直在自己手动构建这些 .xml 文件。

所以，我创建了一个 app.yaml 和一个 queue.yaml。现在，如何将它们连接到我的构建（Eclipse 和 maven）中，以便它们生成正确的 .xml 输出文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T17:05:54.417

好的，我知道这是如何工作的。在本地开发环境中，`app.yaml`被处理生成`web.xml`和`appengine-web.xml`运行时`dev_appserver.sh`（或 Windows 上的 .cmd）。因此实际上没有必要在构建期间生成它们。

这些文件的生成是在您执行时执行`appconfg.sh/.cmd`的。

# gwt - 使用 GWT CellTable 突出显示行

> ID：10742115
> 
> 赞同：4
> 
> 时间：2012-05-24T17:03:57.870
> 
> 标签：gwt, highlight, celltable

我创建了一个包含 300 多行的 CellTable，分为 20 页。我的菜单中有一个命令，允许用户根据某些列中的值突出显示行（类似于 Excel 中的条件格式）。

我需要帮助的是更改不在当前页面上的行的行样式。

我已经浏览了 Celltable 和 SimplePager 文档，但没有任何东西对我产生影响。我对 GWT 很陌生，因此我们将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-29T16:26:08.253

我创建了一个看起来像这样的函数（其中 redRow 和 yellowRow 是我的 CSS 中的样式）：

```
private void highlightAlerts() {
    alertHighlight = true;
    Range range = siteTable.getVisibleRange();
    int start = range.getStart();
    for (int i=0; i<siteTable.getPageSize(); i++) {
        if (dataProvider.getList().get(start+i).alert.equals("Error"))
            siteTable.getRowElement(i).setClassName("redRow");
        else if (dataProvider.getList().get(start+i).alert.equals("Warning"))
            siteTable.getRowElement(i).setClassName("yellowRow");
    } 
```

然后在我的寻呼机中，我将其添加到 onRowOrRowCountChanged() 以便在用户浏览表格页面时样式会持续存在：

```
protected void onRangeOrRowCountChanged() {
    super.onRowOrRountCountChanged();
    if (alertHighlight)
        highlightAlerts();
} 
```

# php - 无法使用 PHP 在 Facebook 应用程序上上传和标记照片？

> ID：10742120
> 
> 赞同：-2
> 
> 时间：2012-05-24T17:04:14.680
> 
> 标签：php, facebook

我正在尝试通过 php 应用程序上传图像。

```
Error :-

Uncaught CurlException: 26: failed creating formpost data thrown in

base_facebook.php on line 814 
```

我的代码：-

```
$pic='img/'.$fbid.'.jpg'; 

$photo_details = array( 'message'=> "test", 'image' => '@' . realpath($pic), 'tags' => $tags );
$upload_photo = $facebook->api('/'.$album_uid.'/photos', 'post', $photo_details);

imagedestroy($image); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-26T07:24:09.387

好的，首先你不能同时上传和标记照片。您需要先上传照片然后标记它。所以代码将是

```
$args = array('message' => 'Testing photo tagging');
$args['image'] = '@' . realpath($FILE_PATH);
$data = $facebook->api('/me/photos', 'post', $args); 
```

然后我们必须在图像上标记用户，但我发现我不能同时标记多个朋友，所以我不得不循环遍历数组。另一件事，标签数组中 X & Y 的值不是 px ，而是百分比，因此这些值不会超过 100

```
$photo_id = $data['id'];
$tags = array(

    array(
        'tag_uid' => 1337904214,
        'tag_text' => 'Joy',
        'x' => 50,
        'y' => 30
    ),
    array(
        'tag_uid' => 709019872,
        'tag_text' => 'test',
        'x' => 100,
        'y' => 100
    )
);

foreach($tags as $t) {
    $t = array($t);
    $t = json_encode($t);
    try {
        $facebook->api('/' . $photo_id . '/tags', 'post', array('tags' => $t));
    } catch (Exception $e) {
        print_r($e);
    }
} 
```

祝你好运 ！

# python - 在文件中进行字符串搜索的有效方法

> ID：10742127
> 
> 赞同：2
> 
> 时间：2012-05-24T17:04:53.440
> 
> 标签：python

我有 2 个文件 'example' 和 'inp' 如下：

文件示例的内容：

```
hi      wert    123

jui     fgrt    345

blabla  dfr     233 
```

文件 inp 的内容：

```
jui
hi 
```

我需要获取'example'每一行的第一列，如果该字符串存在于文件'inp'中，那么我想将整行'example'写入另一个文件out.txt这是我的代码写：

```
f=file('example')
f1=file('inp')

for l in f.readlines():
    s=l.split()
    for p in f1.readlines():
            if s[0] in p:
                    print l >> 'out.txt' 
```

我无法得到预期的结果。而且，由于文件示例实际上有 200000 个条目，我认为这种程序需要太多时间。有什么方法可以让我正确快速地完成我的任务。非常感谢帮助。谢谢你

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T17:16:07.600

那这个呢？它首先加载 inp 文件，然后遍历示例文件，仅打印以包含在从 inp 读取的单词列表中的单词开头的行。

```
with open('inp') as inpf:
    lines = [l.strip() for l in inpf]

with open('example') as exf, open('out.txt', 'w') as outf:
    for l in exf:
        if l.split(' ', 1)[0] in lines:
            print >>outf, l 
```

您还可以使用 a`set`来加快搜索速度。在集合中搜索具有 O(1) 平均成本。只需将第一`with`条语句更改为：

```
with open('inp') as inpf:
    lines = set([l.strip() for l in inpf]) 
```

如果您使用的是 Python 3，请使用`print`函数而不是“旧”语句：

```
print(l, file=outf) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T17:13:54.277

如果“inp”的大小合理，我会将它的所有字符串读入一个集合，然后遍历“example”的行

（未经测试的伪代码）

```
words = set()
for line in inp:
  words.add(line)

for line in example:
  if line[0:line.find(' ')] in words:
    print line 
```

内存中的集合查找非常快，您只需读取每个文件一次。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T17:18:51.890

一点优化：

1.  使用 set 进行更快的搜索
2.  将示例中的行拆分到第一个空格字符为止
3.  与使用 print >> 或 print() 时不同，输出文件中没有额外的新行

.

```
with open("inp") as f:
    a = set(l.rstrip() for l in f)

with open("out.txt", "w") as o, open("example") as f:
    for l in f:
        if l.split(" ", 1)[0] in a:
            o.write(l) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-24T17:10:28.263

您正在遍历文件中的每一*行*。尝试：

```
s=l.split()
for line in f1.readlines():
    for p in line:
        if s[0] in p:
            print p, 'matches', s[0] 
```

如果您想以超快的速度执行此操作，请为搜索字符串编译一个正则表达式，并尝试在文件的整个字符串表示中找到它。

HTH。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-24T17:10:52.850

这个怎么样？

```
with open('inp') as inf:
    words = inf.read()

with open('example') as inf, open('out.txt', 'w') as outf:
     for line in inf:
         word = line.split()[0]
         if word in words:
             outf.write(line) 
```

产量：

```
hi wert 123
jui fgrt 345
jui hi 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-24T17:38:33.437

```
with open('inp') as inp: inp_words = set(line.strip() for line in inp)

with open('example') as example, open('result', 'w') as result:
    for line in example:
        if line.split()[0] in inp_words:
            result.write(line) 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-05-24T17:20:12.893

您可以对 inp 文件进行排序，然后尝试二进制搜索！

# git - git中的p4merge合并工具出错

> ID：10742129
> 
> 赞同：11
> 
> 时间：2012-05-24T17:05:02.913
> 
> 标签：git, p4merge

我已经为 p4merge 设置了我的类路径并设置了文件 .gitconfig，但是当 p4merge 工具假设对这两个冲突的文件进行操作时，我得到了这个错误。有人知道解决方案吗？

添加到类路径：“C:\Program Files\Perforce\p4merge.exe”添加到 .gitconfig 文件：

```
[merge]
    tool = p4merge
[mergetool "p4merge"]
    cmd = p4merge.exe \\\"$BASE\\\" \\\"$LOCAL\\\" \\\"$REMOTE\\\" \\\"$MERGED\\\" 
```

错误信息：

```
Normal merge conflict for 'protected/views/layouts/main.php':
  {local}: modified file
  {remote}: modified file
Hit return to start merge resolution tool (p4merge):
C:\Program Files (x86)\Git/libexec/git-core/mergetools/p4merge: line 8: p4merge:
 command not found
protected/views/layouts/main.php seems unchanged.
Was the merge successful? [y/n] n
merge of protected/views/layouts/main.php failed 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-09-09T10:33:16.200

这个对我有用：

```
[merge]
    keepBackup = false;
    tool = p4merge
[mergetool "p4merge"]
    path = C:/Program Files/Perforce/p4merge.exe
    cmd = \"C:/Program Files/Perforce/p4merge.exe\" "$BASE" "$LOCAL" "$REMOTE" "$MERGED"
    keepTemporaries = false
    trustExitCode = false
    keepBackup = false
[difftool]
    prompt = false
[mergetool]
    prompt = false 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-11-08T21:23:58.110

为什么一切都那么难，我讨厌写命令，所以我做了什么？

1.  [在此处](https://www.perforce.com/downloads/helix#product-10) 为 P4Merge安装 p4Merge 工具表格并安装 exe，然后您只需要

[![在此处输入图像描述](../Images/31d5e0c78d5b20674a509d62d33388fe.png)](https://i.stack.imgur.com/kERhn.png)

2.  以 Windows 用户身份安装

3.  进入您的用户目录并搜索**.gitconfig**编辑并添加

> ```
> [mergetool "p4merge"]
>   path = C:\\Program Files\\Perforce\\p4merge.exe
>   cmd = \"C:/Program Files/Perforce/p4merge.exe\" "$BASE" "$LOCAL" "$REMOTE" "$MERGED"
> [merge]
>   tool = p4merge 
> ```

如何使用它？当你拉一些东西并发生冲突时，你可以写

> git 合并工具

该工具将打开。

[![在此处输入图像描述](../Images/db9160130941464a67d1c33e19eed1ef.png)](https://i.stack.imgur.com/DETxZ.png)

底部是你的最终版本，你可以在那里编辑，然后保存并提交，冲突就会得到解决。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-12T16:32:24.897

如果您刚刚安装了 p4merge，您可能还需要重新启动 git 控制台，以便注册更新的环境变量。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-01-31T16:21:04.960

安装 P4Merge 后，我按照此页面上的说明进行操作，它非常适合我。

[https://gist.github.com/tony4d/3454372](https://gist.github.com/tony4d/3454372)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-24T18:13:26.923

It looks like it can't find p4merge so try adding "C:\Program Files\Perforce\" to your PATH environment variable via System Properties.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-02-05T14:04:53.053

如果您不想在环境变量 Path 中添加 p4merge（如 Dan Lister 所述），您可以在 git 配置中添加参数路径：

```
[mergetool "p4merge"]
    path = C:/Program Files/Perforce/p4merge.exe 
```

它适用于 git v1.7.11 (WinXP)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-24T19:10:48.803

将完整的 P4merge 路径添加到您的 .gitconfig。这是我的（请注意，路径分隔符是翻转的，即 c:/ 而不是 c:\）：

```
[merge]
    tool = p4
[mergetool "p4"]
    cmd = c:/winprogs/p4merge/p4merge.exe \"$BASE\" \"$LOCAL\" \"$REMOTE\" \"$MERGED\" 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-10-12T18:13:30.553

```
These steps worked for me. 
```

从 perforce.com 下载并安装 P4Merge 工具后

在您的个人资料名称/电子邮件 ID 之后。

在 ~/.gitconfig 文件中替换此内容

```
 enter code here

[merge]
  keepBackup = false
    tool = p4merge
[mergetool "p4merge"]
    cmd = /Applications/p4merge.app/Contents/Resources/launchp4merge "\"$PWD/$BASE\"" "\"$PWD/$LOCAL\""  "\"$PWD/$REMOTE\"" "\"$PWD/$MERGED\""   
    keepTemporaries = false
    trustExitCode = false
    keepBackup = false
[diff]
    tool = p4merge
[difftool "p4merge"]
    cmd = /Applications/p4merge.app/Contents/Resources/launchp4merge "\"$REMOTE\"" "\"$LOCAL\"" 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-05-28T06:53:28.043

1) 编辑你的 git 配置文件

```
git config --edit --global 
```

2）添加以下内容（相应更改）

```
[merge]
    keepBackup = false;
    tool = p4merge
[mergetool "p4merge"]
    path = C:/Program Files/Perforce/p4merge.exe
    cmd = \"C:/Program Files/Perforce/p4merge.exe\" "$BASE" "$LOCAL" "$REMOTE" "$MERGED"
    keepTemporaries = false
    trustExitCode = false
    keepBackup = false
[diff]
    tool = p4mergetool
[difftool "p4merge"]
    cmd = /Applications/p4merge.app/Contents/Resources/launchp4merge $LOCAL $REMOTEhere 
```

3）初始化配置文件

```
git init 
```

一切就绪，您可以出发了。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-07-22T21:33:38.600

将此用于正确设置为合并工具。

*   $ git config --global merge.tool p4mergetool

*   $ git config --global mergetool.p4mergetool.cmd \ "/Applications/p4merge.app/Contents/Resources/launchp4merge \$PWD/\$BASE \$PWD/\$REMOTE \$PWD/\$LOCAL \$PWD/ \$合并"

*   $ git config --global mergetool.p4mergetool.trustExitCode false

*   $ git config --global mergetool.keepBackup false

参考：[https ://gist.github.com/tony4d/3454372](https://gist.github.com/tony4d/3454372)

# java - 为什么我的 JDBC 准备语句更新不更新数据库？

> ID：10742133
> 
> 赞同：4
> 
> 时间：2012-05-24T17:05:07.667
> 
> 标签：java, mysql, jdbc, sql-update

我正在使用 JDBC 更新我的 MySQL 数据库中的一行：

```
 pConnection.setAutoCommit(true); 

    PreparedStatement pstmt = pConnection.prepareStatement("update mg_build_queue " + //
            "set buildsetid=?,locale=?,areacode=?,distversionid=?,platformid=?,version=?," + //
            "priority=?,buildstatus=?,computername=?,buildoutput=?,started=?,finished=?, packageid=?, lockcounter=0 where buildid=?" //
    );

    pstmt.setInt(1, mBuildSet.getId());
    pstmt.setString(2, Locale.localesToString(mLocales, ","));
    pstmt.setString(3, mAreaCode.toString());
    pstmt.setInt(4, mDistVersionId);
    pstmt.setInt(5, mPlatform);
    pstmt.setInt(6, mVersion);
    pstmt.setLong(7, mPriority);
    pstmt.setInt(8, mBuildStatus);
    pstmt.setString(9, mComputerName);
    pstmt.setString(10, mBuildOutput);
    pstmt.setTimestamp(11, timeToTimestamp(mStarted));
    pstmt.setTimestamp(12, timeToTimestamp(mFinished));
    pstmt.setInt(13, mResultPackageId);
    pstmt.setInt(14, mBuildId);

    LOGGER.debug("Updating data for mg_build_queue: " + pstmt);
    pstmt.execute();
    LOGGER.debug("Updated " + pstmt.getUpdateCount() + " rows."); 
```

这将生成以下输出：

```
2012-05-24 09:54:33,211 [Thread-1] DEBUG com.buildmaster.BuildQueueEntryImpl - Updating data for mg_build_queue: com.mysql.jdbc.JDBC4PreparedStatement@35e09eab: update mg_build_queue set buildsetid=201,locale='FR',areacode='XX',distversionid=95,platformid=4604,version=65807,priority=33652480,buildstatus=1,computername='MY_COMPUTER-C:\\BUILDS',buildoutput='',started='2012-05-24 09:54:33',finished='2012-05-24 19:45:27', packageid=0, lockcounter=0 where buildid=122418
2012-05-24 09:54:33,214 [Thread-1] DEBUG com.buildmaster.BuildQueueEntryImpl - Updated 1 rows. 
```

我看不出有什么例外。如果我在 DBVisualizer 中查询条目，我只会看到旧值。如果我在 DBVisualizer 中手动运行命令（从上面复制和粘贴），我可以看到更新的值。

为什么会这样？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T17:21:26.473

如果您明确设置，调用`pConnection.commit()`必须反映数据库中的更改

`pConnection.setAutoCommit(false)`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T17:45:37.040

问题似乎是 DBVisualizer 正在做一些结果缓存。我使用 DBVisualizer 断开连接并重新连接，并且可以看到更新。感谢大家的建议。

感谢[DBVisualizer 论坛上的 Hans Bergsten，以下](http://www.dbvis.com/forum/message.jspa?messageID=14064)是防止我的问题的方法：

> 工具 -> 工具属性 -> 数据库 -> MySQL -> 物理连接

更改`Transaction Isolation`为`TRANSACTION_READ_COMMITTED`。

**注意**我还重新启动了我的 MySQL 数据库，我认为这不会影响事情，但值得一提。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T22:46:08.650

这可能是由 MySQL 的默认隔离级别“REPEATABLE READ”引起的。

如果您的 JDBC 语句正确提交，您还需要结束 DBVisualizer 中的打开事务。任何 select 语句都会启动一个事务，除非您终止，否则您不会看到其他事务所做的任何更改。

另一种选择是将默认隔离级别更改为 READ COMMITTED ，你应该没问题

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-11-27T05:43:26.620

很奇怪，但是当我重新启动 Eclipse 时这个问题停止了

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2017-06-15T11:41:15.913

```
 if(checkInputs() && txt_id.getText() == null)
    {
        String UpdateQuery = null;
        PreparedStatement ps=null;
        Connection con=getConnection();
        if(ImgPath == null)
        {
            try {
                     UpdateQuery="UPDATE products SET name = ? , price = ? , add_date=? WHERE id=?";
                     ps=con.prepareStatement(UpdateQuery);
                      ps.setString(1, txt_name.getText());
                ps.setString(2, txt_price.getText());

                SimpleDateFormat dateformat=new SimpleDateFormat("dd-MM-yyyy");
                String addDate=dateformat.format(btn_date.getDate());
                ps.setString(3, addDate);
                ps.setInt(4, Integer.parseInt(txt_id.getText()));
                ps.executeUpdate();
            } catch (SQLException ex) {
                Logger.getLogger(Main_window.class.getName()).log(Level.SEVERE, null, ex);
            }
        }
        else
        {
            try {
                //update with image

                InputStream img=new FileInputStream(new File(ImgPath));
                UpdateQuery="UPDATE products SET name = ? , price = ?  ,add_date=? , image = ? WHERE id=?";
                ps=con.prepareStatement(UpdateQuery);
                ps.setString(1, txt_name.getText());
                ps.setString(2, txt_price.getText());

                SimpleDateFormat dateformat=new SimpleDateFormat("dd-MM-yyyy");
                String addDate=dateformat.format(btn_date.getDate());
                ps.setString(3, addDate);
                ps.setBlob(4, img);
                ps.setInt(5, Integer.parseInt(txt_id.getText()));
                ps.executeUpdate();
            } catch (FileNotFoundException | SQLException ex)
            {
                Logger.getLogger(Main_window.class.getName()).log(Level.SEVERE, null, ex);
            }

        }
    }
    else
    {
        JOptionPane.showMessageDialog(null,"One or more fields are empty or wrong");

    } 
```

# .net - .net google api：使用 oauth 上传文件

> ID：10742135
> 
> 赞同：1
> 
> 时间：2012-05-24T17:05:17.267
> 
> 标签：.net, oauth, google-api, google-docs, google-docs-api

我正在尝试通过 oauth 将文件（pdf）上传到谷歌文档。但是，我收到 403 禁止响应。我想知道这是否可能，因为我不断看到的代码示例是您传递用户名和密码的代码示例。这不是我想要的；我不想要求用户输入他/她的凭据。

如果它可能有帮助，这是我在访问代码请求中放入的范围：“https://docs.google.com/feeds/ [https://docs.googleusercontent.com/](https://docs.googleusercontent.com/) https://spreadsheets.google.com /饲料/”

任何人都可以对此有所了解吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T17:40:35.107

使用带有 OAuth 的 ResumableUploader 组件将文件上传到云端硬盘时，您应该实例化[OAuth2Authenticator](http://code.google.com/p/google-gdata/source/browse/trunk/clients/cs/src/core/authentication.cs#503)或[OAuth3LeggedAuthenticator](http://code.google.com/p/google-gdata/source/browse/trunk/clients/cs/src/core/authentication.cs#455)，具体取决于您要使用 OAuth 2.0（推荐）还是 OAuth 1.0。

该库还包含一个示例，显示如何定义 OAuth2Authenticator 所需的 OAuth2Parameters：[http ://code.google.com/p/google-gdata/source/browse/trunk/clients/cs/samples/oauth2_sample/oauth2demo.cs](http://code.google.com/p/google-gdata/source/browse/trunk/clients/cs/samples/oauth2_sample/oauth2demo.cs)

实例化身份验证器后，您可以使用文档中的示例代码上传文档：[https ://developers.google.com/google-apps/documents-list/#uploading_a_new_document_or_file_with_both_metadata_and_content](https://developers.google.com/google-apps/documents-list/#uploading_a_new_document_or_file_with_both_metadata_and_content)

# ruby-on-rails - Backbone JS 和 Ruby on Rails 新问题

> ID：10742138
> 
> 赞同：-2
> 
> 时间：2012-05-24T17:05:28.233
> 
> 标签：ruby-on-rails, ruby, backbone.js

好的，所以我们已经推出了我们的第一个 Backbone JS 应用程序，现在我们有了新问题。显然，当我最初为评论和评论加载模型时，它们具有“created_at”属性，其中包含添加它们的时间戳。当我编辑评论然后执行 model.sync() 时，它会将“created_at”传递回服务器。现在 RoR 应用程序出错了，正如我们的 Rails 开发人员告诉我的那样，我在任何情况下都不能将“created_at”传递回服务器，并且它只是为了显示而计算的。

现在必须给予一些东西。要么我必须在 sync() 之前破解 Backbone 并删除一些属性，要么必须在 Rails 端做一些事情。

您对解决方案有何建议？

在任何情况下，如何在 model.sync() 期间不传递某些属性？我将衷心感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T17:23:36.767

我在尝试发布到不可变属性时遇到了这个确切的问题。Backbone 模型的问题在于，默认情况下，它们要么全部发布，要么不发布。但是您可以进行部分更新。为了解决这个问题，我创建了一个 Backbone.Model 后代，并像这样覆盖了 model.save：

```
 save : function(key, value, options) {
        var attributes, opts;

        //Need to use the same conditional that Backbone is using
        //in its default save so that attributes and options
        //are properly passed on to the prototype
        if (_.isObject(key) || key == null) {
            attributes = key;
            opts = value;
        } else {
            attributes = {};
            attributes[key] = value;
            opts = options;
        }

        //Now check to see if a partial update was requested
        //If so, then copy the passed attributes into options.data.
        //This will be passed through to Backbone.sync. When sync
        //sees that there's an options.data member, it'll use it instead of
        //the standard attributes hash.
        if (opts && opts.partialUpdate) {
            opts["data"] = JSON.stringify(attributes);
            opts["contentType"] = "application/json";
        }

        //Finally, make a call to the default save now that we've
        //got all the details worked out.
        return Backbone.Model.prototype.save.call(this, attributes, opts);
    } 
```

这允许我有选择地将我想要的属性发布到后端，如下所示：

```
//from the view - the GET may have delivered 20 fields to me, but I'm only interested
//in posting the two fields.
this.model.save({
    field1 : field1Value,
    field2 : field2Value
},{
       partialUpdate : true
}); 
```

无法告诉你这如何让我的生活变得如此轻松！现在考虑到这一点，有些人可能会问为什么不直接传递 changedAttributes() JSON？原因是因为在某些情况下，更改的属性仅适用于客户端，特别是引发对也使用该模型的视图的更改。

无论如何，试试这个...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T17:28:06.270

您可以添加到您的模型：

```
attr_protected :created_at, :updated_at 
```

# java - Java - 按位运算让我感到困惑，它可以工作，但我认为它不应该

> ID：10742143
> 
> 赞同：4
> 
> 时间：2012-05-24T17:05:50.833
> 
> 标签：java, bit-manipulation

我一直在玩按位运算以紧凑地存储有关对象的信息，我打算做的是`short[][]`每个条目存储两条信息，即第一组位（8 位或 4 位）包含信息和然后剩余的位（分别为 8 位或 12 位）存储其余位。

在下面的代码中，我演示了我提到的两个示例，需要遵循的问题；

```
private void test1() {
    // This test takes a 16 bit binary number and breaks it into two
    // bytes of 8 bits. It then takes the bytes and sticks them back
    // together then outputs their decimal value
    String st = "0011111100110111";
    short s = Short.parseShort(st,2);
    byte[] ba = new byte[] {
        (byte)(s & 0xFF),
        (byte)((s >>> 8) & 0xFF)
        };

    System.out.println(s);
    System.out.println(ba[0]);
    System.out.println(ba[1]);

    byte b0 = ba[0];
    byte b1 = ba[1];

    short sh = (short)((b1 << 8) | b0);

    System.out.println(sh);
}

private void test2() {
    // This test takes two shorts and sticks them together in a
    // 4 bit 12 bit configuration within a short, it then breaks
    // them apart again to see if it worked!
    short s0 = 4095;
    short s1 = 15;

    short sh = (short)((s1 << 12) | s0);

    System.out.println(sh);

    short[] sa = new short[] {
        (short)(sh & 0xFFF),
        (short)((sh >>> 12) & 0xF)
    };

    System.out.println(sa[0]);
    System.out.println(sa[1]);

} 
```

我主要担心的是在 test2() 中我希望只能使用有符号值，但是我似乎能够将值 4095 用于 12 位，将 15 用于 4 位（我预计范围为 -2048 到2047 和 -8 到 7），它如何与这些值一起工作，我错过了什么？

还有一个问题，为什么我不能`1011111100110111`在 test1() 中使用？

最后，以这种方式存储信息是个好主意吗？该阵列将是大约 500x200 或 1000x 500 之类的东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T17:13:49.227

4095 在第二行中起作用的原因是因为您在打印之前对其进行了符号扩展。如果您了解无符号 4095 与 -2048 位完全相同，那么您如何解释它们就很重要。

如果您要打印一个 12 位有符号值，它将是：`'b1111_1111_1111`，它会被解释为 -2048。但是，您将其转换为短片，最后添加了另外 4 位：`'b0000_1111_1111_1111`. 4095 非常适合这个值。

这同样适用于 15/-8，您在打印之前将其转换为更大的值。

# javascript - 如何在 Three.JS 中创建定向光影？

> ID：10742149
> 
> 赞同：24
> 
> 时间：2012-05-24T17:06:30.557
> 
> 标签：javascript, three.js

是否可以从 a 中创建阴影`DirectionalLight`？

如果我使用`SpotLight`，那么我会看到一个阴影，但如果我使用`DirectionalLight`它就不起作用。

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2013-02-24T19:11:07.403

Be aware that shadow maps are scale dependent. I'm working on a scene where the unit distance represents one metre, and my objects are around 0.4 metres large. This is quite small by Three.js standards. If you have this situation too, then you can take a few important steps:

*   Ensure the shadow camera's near/far planes are reasonable given your scene's dimensions.
*   Ensure the shadow camera top/left/bottom/right values are not too large, otherwise each shadow 'pixel' may be so large that you don't even notice the shadow in your scene.

Let's look at how to do this.

### Debugging

Be sure to turn on the debug rendering per light via [`CameraHelper`](https://threejs.org/docs/#api/en/helpers/CameraHelper):

```
scene.add(new THREE.CameraHelper(camera)) 
```

Or in older versions of the Three.js:

```
light.shadowCameraVisible = true; 
```

This will show you the volume over which the shadow is being calculated. Here is an example of what that might look like:

![](../Images/a718b2205400420b833e9a1a91dbdfd2.png)

Notice the near and far planes (with black crosses), and the top/left/bottom/right of the shadow camera (outer walls of the yellow box.) You want this box to be tight around whatever objects you are going to have in shadow — possibly even tighter than I'm showing here.

### Code

Here are some snippets of code that might be useful.

```
var light = new THREE.DirectionalLight(0xffffff);
light.position.set(0, 2, 2);
light.target.position.set(0, 0, 0);
light.castShadow = true;
light.shadowDarkness = 0.5;
light.shadowCameraVisible = true; // only for debugging
// these six values define the boundaries of the yellow box seen above
light.shadowCameraNear = 2;
light.shadowCameraFar = 5;
light.shadowCameraLeft = -0.5;
light.shadowCameraRight = 0.5;
light.shadowCameraTop = 0.5;
light.shadowCameraBottom = -0.5;
scene.add(light); 
```

Make sure some object(s) cast shadows:

```
object.castShadow = true; 
```

Make sure some object(s) receive shadows:

```
object.receiveShadow = true; 
```

Finally, configure some values on the `WebGLRenderer`:

```
renderer = new THREE.WebGLRenderer({ antialias: true });
renderer.setSize(canvasWidth, canvasHeight);
renderer.shadowMapEnabled = true;
renderer.shadowMapSoft = true; 
```

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2012-06-05T20:44:16.973

是的，您绝对*可以*使用定向灯来投射阴影。您需要确保您没有使用`MeshBasicMaterial`它们，因为它们不支持阴影。使用`MeshLambertMaterial`或`MeshPhongMaterial`代替。

您需要通过以下方式为渲染器启用阴影：

```
renderer.shadowMapEnabled = true;
renderer.shadowMapSoft = true;

renderer.shadowCameraNear = 3;
renderer.shadowCameraFar = camera.far;
renderer.shadowCameraFov = 50;

renderer.shadowMapBias = 0.0039;
renderer.shadowMapDarkness = 0.5;
renderer.shadowMapWidth = 1024;
renderer.shadowMapHeight = 1024; 
```

然后您必须为每个对象和每个灯光启用阴影投射和阴影接收，这样您就可以拥有

```
dirLight.castShadow = true;
object.castShadow = true;
otherObject.receiveShadow = true; 
```

然后，*如果*将灯光和物体放置在适当的位置。`dirLight`会造成的阴影`object`被投反对`otherObject`。

**[编辑]：**这是一个适用于任何想要做类似事情的人的**[工作演示。](http://jsfiddle.net/Q4uqE/5)**

# java - 单击时如何将字符串值设置为 ExpandableListView Childs 文本？

> ID：10742150
> 
> 赞同：0
> 
> 时间：2012-05-24T17:06:52.110
> 
> 标签：java, android, eclipse, expandablelistview

有一个很好的解释，这可能对任何试图做同样的人有用！！！

```
 public class ExpList extends ExpandableListActivity
{
 String gametype;

  // strings for group elements

    static final String arrGroupelements[] = 
    {
   "POKER TOURNAMENTS",
   "SLOTS TOURNAMENTS",
   "ROULLETTE/CRAPS TOURNAMENTS",
   "BLACKJACK TOURNAMENTS",
   "BINGO/CHARITY BINGO"
 };

  // strings for child elements

 static final String arrChildelements[][] = 
 {
   {
  "TEXAS HOLD'EM",
  "OMAHA HIGH-LOW",
  "SEVEN CARD STUD",
  "THREE CARD POKER",
  "OTHER POKER VARIANTS",
  "ONLINE/SATTELITE TOURNAMENTS"
   },
   {
  "SLOTS"
   },
   {
  "ROULLETTE",
  "CRAPS"

   },
   {
  "BLACKJACK"
   },
   {
       "BINGO"
        }
    }; 
```

并按以下方式处理 onChildClick 函数，以在下面单击该子项时将字符串的值设置为“TEXAS HOLD 'EM”

```
@Override
        public boolean onChildClick(ExpandableListView parent, View v,
                int groupPosition, int childPosition, long id) {
            //ExpandableListAdapter adapter = getExpandableListAdapter();
            gametype = ExpList.arrChildelements[groupPosition][childPosition];
            //---------------------
            Intent pullt = new Intent(ExpList.this,
                    SearchActivity.class);
            Bundle bundle = new Bundle();
            bundle.putString("gametype", gametype);
            pullt.putExtras(bundle);
            pullt.putExtra("gametype", gametype);

            startActivity(pullt);
            //---------------------
            return false;
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T20:32:58.563

```
public class ExpList extends ExpandableListActivity
{
 String gametype;

  // strings for group elements

    static final String arrGroupelements[] = 
    {
   "POKER TOURNAMENTS",
   "SLOTS TOURNAMENTS",
   "ROULLETTE/CRAPS TOURNAMENTS",
   "BLACKJACK TOURNAMENTS",
   "BINGO/CHARITY BINGO"
 };

  // strings for child elements

 static final String arrChildelements[][] = 
 {
   {
  "TEXAS HOLD'EM",
  "OMAHA HIGH-LOW",
  "SEVEN CARD STUD",
  "THREE CARD POKER",
  "OTHER POKER VARIANTS",
  "ONLINE/SATTELITE TOURNAMENTS"
   },
   {
  "SLOTS"
   },
   {
  "ROULLETTE",
  "CRAPS"

   },
   {
  "BLACKJACK"
   },
   {
       "BINGO"
        }
    }; 
```

并按以下方式处理 onChildClick 函数，以在下面单击该子项时将字符串的值设置为“TEXAS HOLD 'EM”

```
@Override
        public boolean onChildClick(ExpandableListView parent, View v,
                int groupPosition, int childPosition, long id) {
            //ExpandableListAdapter adapter = getExpandableListAdapter();
            gametype = ExpList.arrChildelements[groupPosition][childPosition];
            //---------------------
            Intent pullt = new Intent(ExpList.this,
                    SearchActivity.class);
            Bundle bundle = new Bundle();
            bundle.putString("gametype", gametype);
            pullt.putExtras(bundle);
            pullt.putExtra("gametype", gametype);

            startActivity(pullt);
            //---------------------
            return false;
        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T17:16:17.363

在`onChildClick()`你得到`groupPosition`和`childPosition`。

```
ExpandableListAdapter adapter = getExpandableListAdapter();
gametype = adapter.getChild(groupPosition, childPosition).toString; 
```

# haskell - 为什么不能将 ContT 设为 MonadError 的实例？

> ID：10742151
> 
> 赞同：7
> 
> 时间：2012-05-24T17:06:52.773
> 
> 标签：haskell, monads, monad-transformers

我有一个单子变压器堆栈，包括一个`ErrorT`，我想`ContT r`在整个东西周围包裹一个变压器。当我尝试这样做时，我对`throwError`生成类型错误的调用 - 显然`ContT r`不会自动成为`MonadError`. 好吧，我想——我就把它变成一个：

```
instance MonadError e m => MonadError e (ContT r m) where
  throwError = lift . throwError
  catchError = liftCatch . catchError 
```

使用一些合适的定义`liftCatch`。但是现在编译时出现错误：

```
src\Language\Types.hs:68:10:
    Illegal instance declaration for `MonadError e (ContT r m)'
      (the Coverage Condition fails for one of the functional dependencies;
       Use -XUndecidableInstances to permit this)
    In the instance declaration for `MonadError e (ContT r m)' 
```

我很高兴使用 UndecidableInstances 杂注（我的印象不是太令人担忧，例如看到[这个问题](https://stackoverflow.com/questions/9951382/making-a-custom-monad-transformer-an-instance-of-monaderror)）但我想知道将延续转换器变成一个实例是否有困难`MonadError`- 我想如果它是好吧，这个包的作者`Control.Monad.Trans`早就做了……对吧？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-24T18:00:19.607

ContT 和 ErrorT 都允许非标准控制流。有一种方法可以在 mtl 中将 ErrorT 类型包装在 ContT 周围：

```
instance (Error e, MonadCont m) => MonadCont (ErrorT e m) 
```

但是这两个单子变压器不通勤。记住：

```
newtype Identity a = Identity {runIdentity :: a}
newtype ErrorT e m a = ErrorT {runErrorT :: m (Either e a)}
newtype ContT r m a = ContT {runContT :: (a -> m r) -> m r} 
```

`ErrorT String (ContT Bool Identity) ()`在 mtl 包中没问题的可能是：

```
ErrorT (ContT ( \ (k :: Either String () -> Identity Bool) -> k (Right ()) ) ) 
```

`ContT r (ErrorT e Identity) a`在 mtl 包中不行。但是你可以写。

您想要在组合单子中的 (>>=) 语义是什么？您希望您的嵌套错误处理程序堆栈如何与非本地 callCC 交互？

以下是我的写法：

```
{-# LANGUAGE FlexibleInstances, MultiParamTypeClasses, UndecidableInstances   #-}
import Control.Monad
import Control.Monad.Cont
import Control.Monad.Error
import Data.Function
import Data.IORef

handleError :: MonadError e m => (e -> m a) -> m a -> m a
handleError = flip catchError

test2 :: ErrorT String (ContT () IO) ()
test2 = handleError (\e -> throwError (e ++ ":top")) $ do
  x <- liftIO $ newIORef 1
  label <- callCC (return . fix)
  v <- liftIO (readIORef x)
  liftIO (print v)
  handleError (\e -> throwError (e ++ ":middle")) $ do
    when (v==4) $ do
      throwError "ouch"
  when (v < 10) $ do
         liftIO (writeIORef x (succ v))
         handleError (\e -> throwError (e ++ ":" ++ show v)) label
  liftIO $ print "done"

go2 = runContT (runErrorT test2) (either error return)

{-

*Main> go2
1
2
3
4
*** Exception: ouch:middle:top

-} 
```

所以上面只适用于 mtl，这是新实例及其工作原理：

```
instance MonadError e m => MonadError e (ContT r m) where
  throwError = lift . throwError
  catchError op h = ContT $ \k -> catchError (runContT op k) (\e -> runContT (h e) k)

test3 :: ContT () (ErrorT String IO) ()
test3 = handleError (\e -> throwError (e ++ ":top")) $ do
  x <- liftIO $ newIORef 1
  label <- callCC (return . fix)
  v <- liftIO (readIORef x)
  liftIO (print v)
  handleError (\e -> throwError (e ++ ":middle")) $ do
    when (v==4) $ do
      throwError "ouch"
  when (v < 10) $ do
         liftIO (writeIORef x (succ v))
         handleError (\e -> throwError (e ++ ":" ++ show v)) label
  liftIO $ print "done"

go3 = runErrorT (runContT test3 return)

{-

*Main> go3
1
2
3
4
Left "ouch:middle:3:middle:2:middle:1:middle:top"

-} 
```

# ios - ios为tableview自定义多选

> ID：10742154
> 
> 赞同：0
> 
> 时间：2012-05-24T17:06:56.620
> 
> 标签：ios, uitableview

我有一张桌子，里面有三个部分。每个部分有 4 行。我希望每个部分有一个选择，这使得整个表格有 3 个选择。我正在尝试使用以下功能来执行此操作，这些功能重置当前部分并设置新选择。

```
- (void)selectOneRow:(int)row inSection:(int)section
{
    NSIndexPath *indexPath = [NSIndexPath indexPathForRow:row inSection:section];

    for(int i = 0; i < [[self.dataSource objectAtIndex:section] count]; ++i) {
        NSIndexPath *ip = [NSIndexPath indexPathForRow:i inSection:section];
        [self.table deselectRowAtIndexPath:ip animated:NO];
        //[[self.table cellForRowAtIndexPath:ip] setHighlighted:NO];
    }

    [self.table selectRowAtIndexPath:indexPath animated:NO scrollPosition:UITableViewScrollPositionNone];
    //[[self.table cellForRowAtIndexPath:indexPath] setHighlighted:YES];

    [self disableInteractionForRow:row inSection:section];
}

- (void)disableInteractionForRow:(int)row inSection:(int)section
{
    NSIndexPath *indexPath = [NSIndexPath indexPathForRow:row inSection:section];

    for(int i = 0; i < [[self.dataSource objectAtIndex:section] count]; ++i) {
        NSIndexPath *ip = [NSIndexPath indexPathForRow:i inSection:section];
        [[self.table cellForRowAtIndexPath:ip] setUserInteractionEnabled:YES];
    }

    [[self.table cellForRowAtIndexPath:indexPath] setUserInteractionEnabled:NO];
} 
```

选择第一部分的第一行的示例是：

```
[self selectOneRow:0 inSection:0]; 
```

这在第一次时效果很好，但每次后记都会关闭该行，使该部分留空。我怎样才能解决这个问题？还是我一开始就错了？谢谢你的帮助。

** 编辑添加图像 **

![在此处输入图像描述](../Images/631539248fb373eebe487ccfc18b508f.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T20:36:35.390

听起来你试图让它变得太复杂。不要将三个选项放在一个包含三个部分的表格视图中，而是制作三个单独的表格和三个单独的视图。

例如，转到 iPhone 上的设置应用程序。点击“邮件、通讯录、日历”，然后向下滚动到“邮件”部分标题下的“显示”、“预览”和“最小字体大小”选项。对于这些设置中的每一个，都会使用新的表视图控制器推送一个新视图，您只能选择其中一个选项然后返回。这样可以保持界面清洁，更不用说您的代码了。

希望像这样重组它会更好地为您服务。我不知道我是否可以说您现在的做法是错误的，但这与 Apple 构建其应用程序的方式不一致。

# objective-c - 用于过滤掉无效/不准确位置的 iOS 位置服务方法

> ID：10742156
> 
> 赞同：11
> 
> 时间：2012-05-24T17:07:12.040
> 
> 标签：objective-c, ios, gps, core-location, cllocationmanager

我`Location Services`在我的一些应用程序中使用。我在我的方法中使用了`locationManager:didUpdateToLocation:fromLocation:`一种方法来过滤掉错误、不准确或太远的位置。并尽量减少gps“抖动”。这是我使用的：

```
/**
 * Check if we have a valid location
 *
 * @version $Revision: 0.1
 */
+ (BOOL)isValidLocation:(CLLocation *)newLocation withOldLocation:(CLLocation *)oldLocation {

    // Filter out nil locations
    if (!newLocation) return NO;

    // Filter out points by invalid accuracy
    if (newLocation.horizontalAccuracy < 0) return NO;
    if (newLocation.horizontalAccuracy > 66) return NO;

    // Filter out points by invalid accuracy
    #if !TARGET_IPHONE_SIMULATOR
    if (newLocation.verticalAccuracy < 0) return NO;
    #endif

    // Filter out points that are out of order
    NSTimeInterval secondsSinceLastPoint = [newLocation.timestamp timeIntervalSinceDate:oldLocation.timestamp];
    if (secondsSinceLastPoint < 0) return NO;

    // Make sure the update is new not cached
    NSTimeInterval locationAge = -[newLocation.timestamp timeIntervalSinceNow];
    if (locationAge > 5.0) return NO;

    // Check to see if old and new are the same
    if ((oldLocation.coordinate.latitude == newLocation.coordinate.latitude) && (oldLocation.coordinate.longitude == newLocation.coordinate.longitude)) 
        return NO;

    return YES;

}//end 
```

有没有人对此方法有任何改进以使其更准确？**66**是不是太高了`horizontalAccuracy`，会收到很多无效的位置？我应该降低这个吗？

有没有办法摆脱 iPhone 上的 gps 带来的“抖动”？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-24T17:17:51.047

除了这些，我还使用了一个：

```
if(self.lastKnownLocation)
{
     CLLocationDistance dist = [newLocation distanceFromLocation:self.lastKnownLocation];

     if(dist > newLocation.horizontalAccuracy)
     {
          //.....
     }
} 
```

实际上我拥有的最后一个有效位置在哪里`self.lastKnownLocation`，它是：

```
@property(nonatomic, copy) CLLocation *lastKnownLocation; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-20T12:54:04.547

```
-(void)locationManager:(CLLocationManager *)manager
    didUpdateToLocation:(CLLocation *)newLocation
           fromLocation:(CLLocation *)oldLocation
{
 if (!newLocation)
    {
        NSLog(@"Filter out points by invalid accuracy");
        return;
    }

    // Filter out points by invalid accuracy
    if (newLocation.horizontalAccuracy < 0)
    {
        return;
    }
    if(oldLocation.coordinate.latitude>90 && oldLocation.coordinate.latitude<-90 && oldLocation.coordinate.longitude>180 && oldLocation.coordinate.longitude<-180)
    {   
       NSLog(@"old");
       return;
    }
    if(newLocation.coordinate.latitude>90 || newLocation.coordinate.latitude<-90 || newLocation.coordinate.longitude>180 || newLocation.coordinate.longitude<-180)
    {
       NSLog(@"new");
       return;
    }

    ///////   
    NSDate *eventDate=newLocation.timestamp;   
    NSTimeInterval eventinterval=[eventDate timeIntervalSinceNow];

    if (abs(eventinterval)<30.0)
    {           
       if (newLocation.horizontalAccuracy>=0 && newLocation.horizontalAccuracy<20)
       { 
          **//finally you are getting right updated value here....**
       }          
    }           
 } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-08-16T08:55:35.853

你可以签出这个

[https://medium.com/@mizutori/make-it-even-better-than-nike-how-to-filter-locations-tracking-highly-accurate-location-in-774be045f8d6](https://medium.com/@mizutori/make-it-even-better-than-nike-how-to-filter-locations-tracking-highly-accurate-location-in-774be045f8d6)

主要思想是在方法中归档数据`didUpdateLocation:`

过滤方法是这样的：

```
func filterAndAddLocation(_ location: CLLocation) -> Bool{
    let age = -location.timestamp.timeIntervalSinceNow

    if age > 10{
        return false
    }

    if location.horizontalAccuracy < 0{
        return false
    }

    if location.horizontalAccuracy > 100{
        return false
    }

   locationDataArray.append(location)

    return true

} 
```

# java - Apache Camel：死信通道不起作用

> ID：10742171
> 
> 赞同：0
> 
> 时间：2012-05-24T17:09:24.920
> 
> 标签：java, apache-camel

我不知道我错过了什么，但我的死信频道没有启动。骆驼配置定义为

```
 <bean id="myDeadLetterHandler" class="org.apache.camel.builder.DeadLetterChannelBuilder">
        <property name="deadLetterUri" value="activemq:queue:TESTQUEUE"/>
    </bean>
        <route errorHandlerRef="myDeadLetterHandler">
            <from uri="seda:elixirBatchQueue" />
            <convertBodyTo type="String"/>
            <inOnly uri="activemq:queue:someQ"/>
        </route> 
```

这里**someQ**不存在，而 TESTQUEUE 确实存在。
日志是：

```
DEBUG SendProcessor:114 - >>>> Endpoint[activemq://queue:someQ] Exchange[Message: org.dom4j.tree.DefaultDocument@afdb52]
DEBUG FailoverTransport:660 - Reconnect was triggered but transport is not started yet. Wait for start to connect the transport.
DEBUG FailoverTransport:302 - Started.
DEBUG FailoverTransport:653 - Waking up reconnect task
DEBUG FailoverTransport:683 - urlList connectionList:[tcp://localhost:61616], from: [tcp://localhost:61616]
DEBUG FailoverTransport:855 - Attempting connect to: tcp://localhost:61616 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T17:52:02.140

现在工作正常。当路由启动已删除队列时，活动 MQ 正在创建已删除队列。

# java - EL 相当于 WAS 8 中的 <%= object.method(parameter) %>？

> ID：10742174
> 
> 赞同：0
> 
> 时间：2012-05-24T17:09:43.880
> 
> 标签：java, jakarta-ee, websphere, el, websphere-8

文档说参数是受支持的，但是示例使用了`hl`并且`#`我不知道我在哪里使用 c: 和 $ 而不是来自文档的这个：

`<h:inputText value="#{userNumberBean.userNumber('5')}">`

我所知道的关于 EL 中的 $ vs # 是与右值和左值有关，我需要进一步解释何时使用 # 样式。我正在寻找 typ $... 的 EL 表达式如何获取参数以及如何使用参数调用非 getter 非 setter，例如从请求上下文中的 bean 获取常量静态字符串。

# 与 $ 相比有什么作用？如果我想使用 $，如何在 EL 中使用参数？`<%= Constants.CONSTANT %>`我想迁移到 EL的scriptlet 类似于`<%= object.method(parameter) %>`我想在 EL 中执行的操作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T17:17:44.463

该`#{}`语法应该只在[Java EE 的 MVC 框架 JSF](https://stackoverflow.com/tags/jsf/info)中使用。另请参阅[JSP EL、JSF EL 和 Unified EL 之间的区别](https://stackoverflow.com/questions/4812755/difference-between-jsp-el-jsf-el-and-unified-el)。只需坚持`${}`旧 JSP 中的语法即可。

至于使用参数调用方法，这是在 Servlet 3.0 / EL 2.2 中引入的。WAS 8 是一个 Servlet 3.0 容器，因此它应该支持它。您只需要确保您`web.xml`的声明符合 Servlet 3.0 规范版本。否则，容器将以与 . 指示的版本匹配的回退方式运行`web.xml`。正确的 Servlet 3.0`web.xml`声明如下所示：

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app 
    xmlns="http://java.sun.com/xml/ns/javaee"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"
    version="3.0">

    <!-- Config here. -->

</web-app> 
```

这种方式`${object.method(param)}`必须工作。

在 EL 中引用常量是另一回事。这将在即将到来的 EL 3.0 中[引入](http://java.net/projects/el-spec/pages/StaticField)，它是未来 Java EE 7 / Servlet 3.1 的一部分（未来的 WAS 9 或 10 可能会支持它）。有自定义标记库风格的解决方案或将它们保存在 a 中`Map`，所有这些都在这个答案中详细解释：[如何在 EL 中引用常量？](https://stackoverflow.com/questions/3732608/how-to-reference-constants-in-el)

### 也可以看看：

*   [我们的 EL 维基页面](https://stackoverflow.com/tags/el/info)

# apache-flex - 要将电子邮件地址从 AIR 应用程序传递到 Outlook？

> ID：10742179
> 
> 赞同：0
> 
> 时间：2012-05-24T17:10:02.707
> 
> 标签：apache-flex, email, air

是否可以从 AIR 应用程序将电子邮件地址传递给 Outlook？？？？我的 adobe air 应用程序还必须发送电子邮件地址和消息内容。可以吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T17:14:50.097

您可以使用 URL 语法发送电子邮件；[并在URLRequest](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/net/URLRequest.html)和[navigateToURL](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/net/package.html#navigateToURL%28%29)中打开它。像这样的东西：

```
var request:URLRequest = new URLRequest("mailto:someone@example.com?Subject=Hello&Body=SomeText");
navigateToURL(request); 
```

这基本上将请求传递给将处理它的操作系统。无法保证 Outlook 将成为默认打开的电子邮件客户端。我已经很多年没有这样做了，所以如果没有记错的话，并不是所有的邮件客户端都支持“body”属性来预填充电子邮件正文。

# c# - 录音波 naudio 库 - 音质差

> ID：10742184
> 
> 赞同：2
> 
> 时间：2012-05-24T17:10:19.613
> 
> 标签：c#, .net, audio, naudio, wave

我正在学习使用 naudio 进行音频编程（使用教程）。我的程序（C# .net winForms）我有录制和停止按钮。代码如下所示：

```
 NAudio.Wave.WaveIn sourceStream = null;
    NAudio.Wave.WaveFileWriter waveWriter = null;

    private void RecordButton_Click(object sender, EventArgs e)
    {
        int deviceNumber = 0;
        sourceStream = new NAudio.Wave.WaveIn();
        sourceStream.DeviceNumber = deviceNumber;
        sourceStream.WaveFormat = new NAudio.Wave.WaveFormat(44100, NAudio.Wave.WaveIn.GetCapabilities(deviceNumber).Channels);

        sourceStream.DataAvailable += new EventHandler<NAudio.Wave.WaveInEventArgs>(sourceStream_DataAvailable);
        waveWriter = new NAudio.Wave.WaveFileWriter("d:\\a.wav", sourceStream.WaveFormat);

        sourceStream.StartRecording();
    }

    private void sourceStream_DataAvailable(object sender, NAudio.Wave.WaveInEventArgs e)
    {
        if (waveWriter == null) return;

        waveWriter.WriteData(e.Buffer, 0, e.BytesRecorded);
        waveWriter.Flush();
    }

    private void StopButton_Click(object sender, EventArgs e)
    { 
            waveWriter.Dispose();
            waveWriter = null;       
    } 
```

它可以工作，但波形文件质量不好 - 我录制的声音有小间隙。我想要 44100 Hz 的采样率和 16 位的采样格式。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-05-07T18:16:18.393

我无法完全复制您发现的内容，但我确实注意到该`DataAvailable`事件并没有为其他操作留下太多空间来阻止。一个简单`Thread.Sleep(100);`的停止应用程序。

假设您的连续写入（和刷新）可能会导致问题，我实现了一个`Queue`保持要写入的字节并使用线程池中的线程进行实际写入的天真的问题。

事件现在`DataAvailable`看起来像这样：

```
 Queue<byte[]> writebuffer = new Queue<byte[]>();

    private void sourceStream_DataAvailable(object sender, NAudio.Wave.WaveInEventArgs e)
    {
        if (waveWriter == null) return;

        byte[] realbytes = new byte[e.BytesRecorded];
        Array.Copy(e.Buffer, realbytes, e.BytesRecorded);
        writebuffer.Enqueue(realbytes);
    } 
```

就在`StartRecording`通话之后，我将任务排入队列以读取队列并将数据写入流。如果我在那里添加延迟，则应用程序不再停止。

```
ThreadPool.QueueUserWorkItem((s) =>
{
    var keeprunning = true;
    sourceStream.RecordingStopped += (rss, rse) => { keeprunning = false; };
    while(keeprunning)
    {
        if (writebuffer.Count==0)
        {
                Thread.Sleep(0);
        }
        else
        { 
            var buf = writebuffer.Dequeue();
            waveWriter.Write(buf,0,buf.Length);
            // Thread.Sleep(100); // for testing 
        }
    }
    waveWriter.Dispose();
    waveWriter = null;
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-03-28T21:33:03.323

我也遇到过这个问题。解决方案是从使用 WaveIn 进行录制切换到 WasapiCapture。设置和使用几乎相同，但质量要好得多。尝试这个：

```
public class Recorder
{
    public string _outputFolder { get; set; }
    public string _outputFilePath { get; set; }
    public WasapiCapture _capture { get; set; }
    public WaveFileWriter _writer { get; set; }

    public Recorder()
    {
        _outputFolder = Path.Combine(Environment.GetFolderPath(Environment.SpecialFolder.Desktop), "NAudio");
        Directory.CreateDirectory(_outputFolder);
        _outputFilePath = Path.Combine(_outputFolder, "recorded.wav");
    }

    public void StartRecording()
    {
        _capture = new WasapiCapture();
        _capture.ShareMode = AudioClientShareMode.Shared;
        _capture.WaveFormat = new WaveFormat(44100, 32, 1);

        _writer = new WaveFileWriter(_outputFilePath, _capture.WaveFormat);

        _capture.DataAvailable += _capture_DataAvailable;
        _capture.RecordingStopped += _capture_RecordingStopped; ;

        _capture.StartRecording();
    }

    public void StopRecording()
    {
        _capture.StopRecording();
    }

    private void _capture_DataAvailable(object sender, WaveInEventArgs e)
    {
        _writer.Write(e.Buffer, 0, e.BytesRecorded);
    }

    private void _capture_RecordingStopped(object sender, StoppedEventArgs e)
    {
        _writer?.Dispose();
        _writer = null;
        _capture.Dispose();
        _capture = null;
    }

} 
```

# doctrine-orm - Doctrine 2 ORDER BY joinTable 的字段

> ID：10742185
> 
> 赞同：0
> 
> 时间：2012-05-24T17:10:23.930
> 
> 标签：doctrine-orm, dql

我有一个这样定义的实体：

```
Munkatars:
    id:
        id:
            type: integer
    fields:
        nev:
            type: text
        [...]
    manyToOne:
        vezeto:
            targetEntity: Munkatars
            inversedBy: alarendeltek
    oneToMany:
        alarendeltek:
            targetEntity: Munkatars
            mappedBy: vezeto
            fetch: EXTRA_LAZY 
```

有没有办法创建一个按它们的字段对这些`Munkatars`对象排序的查询？`vezeto``nev`

我试过 ORDER BY m.vezeto.nev，但这给了我一个错误，并且文档没有提供太多关于此的信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T19:28:19.960

你必须像这个例子一样使用join：

```
createQuery("SELECT m.nev 
             FROM  Entity\Munkatars as m 
             LEFT JOIN m.vezeto as v
             ORDER BY v.nev"); 
```

# php - 从 Excel 导入中将值更新为零

> ID：10742186
> 
> 赞同：2
> 
> 时间：2012-05-24T17:10:24.990
> 
> 标签：php

我正在使用以下代码将 csv 导入 mysql。

```
 if($_POST['sform'] == "1")
{
     $fname = $_FILES['upload']['name'];        
     $chk_ext = explode(".",$fname);        
     if(strtolower($chk_ext[1]) == "csv")
     { 
        $filename = $_FILES['upload']['tmp_name'];
        $row = 1;
        if (($handle = fopen($filename, "r")) !== FALSE)
        {
        while (($data = fgetcsv($handle, 1000, ",")) !== FALSE)
              {
                $row++;
                $data_entries[] = $data ;
              }
              fclose($handle);
         }
         foreach($data_entries as $line)
         {
              $sql = "INSERT into testposts(ID,UID,title,tags,desc) values('','$data[0]','$data[1]','$data[2]','$data[3]')";
$conn->execute($sql);
          $conn->execute($line);
         }
         $msg = "Successfully Imported";
     }
     else
     {
         $error = "Invalid File";
     }   
} 
```

当我尝试更新时，所有值都会更新为 0

我的 csv 文件如下（示例）

```
1,title,tags,send2 
```

不包括 PID 值，因为它是自动递增的

所以我尝试了我的第二个变体

```
if($_POST['sform'] == "1")
{
     $fname = $_FILES['upload']['name'];        
     $chk_ext = explode(".",$fname);        
     if(strtolower($chk_ext[1]) == "csv")
     { 
 $filename = $_FILES['upload']['tmp_name'];
     $handle = fopen($filename, "r");

     while (($data = fgetcsv($handle, 1000, ",")) !== FALSE)
     {
              $sql = "INSERT into testposts(ID,UID,title,tags,desc) values('','$data[0]','$data[1]','$data[2]','$data[3]')";
          mysql_query($sql) or die(mysql_error());
          //$conn->execute($sql);
         }
         $msg = "Successfully Imported";
     }
     else
     {
         $error = "Invalid File";
     }   
} 
```

在我的第二个代码中，它按预期正确上传了值，但它插入了两次。

任何帮助将不胜感激，谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T17:28:11.007

我很惊讶第二个版本有效：

```
$sql = "INSERT into testposts(ID,UID,title,tags,desc) values('','$data[0]','$data[1]','$data[2]','$data[3]','$data[4]')"; 
```

你有比列名更多的值。有`$data[4]`吗？

如果您启用了警告，您的数据可能包含 php 警告，并且这些警告可能包含`'`字符，从而破坏您的查询。

你真的应该切换到 PDO /prepared statements 以避免 sql 注入问题和类似的错误。

# python - 在宏开发期间将 python 脚本“部署”到 LibreOffice 的首选方法？

> ID：10742188
> 
> 赞同：2
> 
> 时间：2012-05-24T17:10:34.957
> 
> 标签：python, openoffice.org, libreoffice

至少在 Linux 上为 LibreOffice / OpenOffice 开发 Python 宏时，我读到您必须将 py 脚本放在特定目录中。

Python LibreOffice/OOo 开发人员是否有部署这些脚本的首选方法，或者是否有另一种方法可以在 LibreOffice/OOo 中指定您希望这些脚本的位置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T18:51:47.997

也许一个不错的方法是熟悉 Python 设置工具本身（http://packages.python.org/an_example_pypi_project/setuptools.html），并编写一个适当的 setup.py 脚本，将所有需要的文件放在适当的目录

您的宏甚至可以使用“easy_install”Python 框架安装

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2017-02-08T09:05:19.030

为避免重新加载已更改的宏（即使将其部署到正确的文件夹），您可以让 LibreOffice 在开发期间侦听套接字：

```
import uno

def getModel():
    # get the uno component context from the PyUNO runtime
    localContext = uno.getComponentContext()

    # create the UnoUrlResolver
    resolver = localContext.ServiceManager.createInstanceWithContext(
    "com.sun.star.bridge.UnoUrlResolver", localContext)

    # connect to the running office
    context = resolver.resolve("uno:socket,host=localhost,port=2002;urp;StarOffice.ComponentContext")
    manager = context.ServiceManager

    # get the central desktop object
    desktop = manager.createInstanceWithContext("com.sun.star.frame.Desktop", context)

    # access the current writer document
    return desktop.getCurrentComponent() 
```

[我在这篇文章](https://onesheep.org/scripting-libreoffice-python/)中解释了当你准备好部署时如何替换这个开发道具

# asp.net-mvc - ASP.Net mvc Url.Action 参数始终为空

> ID：10742189
> 
> 赞同：1
> 
> 时间：2012-05-24T17:10:35.887
> 
> 标签：asp.net-mvc, asp.net-mvc-routing

我是 MVC 新手，所以请多多包涵。

我要做的是，在第 1 页上，用户在两个文本字段中输入值，然后单击提交按钮，它将调用 wcf 服务，如果 wcf 调用返回经过验证的值，那么它应该重定向到不同的页面并显示返回的值来自 wcf 调用。

我创建了这样的视图 -

```
 <input type="text" name="txtUniqueCode" value="@Model.UniqueCode" placeholder="unique identifier" />
            <label for="name">
                Vehicle Registration
            </label>
            <input type="text" name="txtRegistration" value="@Model.Registration" placeholder="Registration" />

            <a href="@Url.Action("ShowRepairDetails", "RepairDetails", new { uniqueCode = Model.UniqueCode, registration = Model.Registration })">Check Status</a> 
```

用户在文本框中输入值并单击“检查状态”后，我正在尝试使用 Url.Action 将值传递给控制器​​。但是当我调试并检查控制器上的参数值时，它们会以空值返回给我。不知道为什么？

我尝试在 url.Action 中用静态值替换参数值，如下所示 -

```
 @Url.Action("ShowRepairDetails", "RepairDetails", new { uniqueCode = 1234, registration = "Test" }) 
```

这工作正常，我在控制器端正确接收参数值。因此，据我了解，即使用户在文本框中输入了一些值，“模型”对象也没有得到更新。我在这里遗漏了一些东西。能否请你帮忙..

提前感谢
赛

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T17:16:23.620

您似乎误解了这里的工作流程。您代码中的链接在将页面发送到客户端之前由服务器计算。它无法使用用户稍后在文本框中输入的值。为此，您需要一个带有提交操作的表单，或者一个提取 HTML 元素值并将其发送回服务器的 AJAX 调用。

# git - 如何在 git-svn 中获取最新的 SVN HEAD？

> ID：10742190
> 
> 赞同：5
> 
> 时间：2012-05-24T17:10:39.013
> 
> 标签：git, repository, git-svn

我正在使用`git-svn`，我想更新到最新的 SVN HEAD。

当我打字`git pull`时，它说：

```
fatal: No remote repository specified.  Please, specify either a URL or a
remote name from which new revisions should be fetched. 
```

[我在这里](https://stackoverflow.com/questions/352692/how-do-i-revert-a-git-svn-branch-to-svn-head)读到我应该做类似的事情：

```
git checkout -b real-trunk remotes/trunk 
```

但我不明白这个命令。是什么`remote-trunk`？在任何情况下，`git`都会出现错误：

```
fatal: git checkout: updating paths is incompatible with switching branches.
Did you intend to checkout 'remotes/trunk' which can not be resolved as commit? 
```

这是我的`.git/config`：

```
$ cat .git/config 
[core]
        repositoryformatversion = 0
        filemode = true
        bare = false
        logallrefupdates = true
[svn-remote "svn"]
        url = http://name.xyz.com/svn/trunk/project
        fetch = :refs/remotes/git-svn 
```

另外，谁能告诉我如何恢复我在 git checkout 中所做的所有更改？我想回到新鲜的 SVN HEAD 版本。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-24T18:11:58.687

对于更新而不是“git pull”：

```
git svn rebase 
```

我猜你已经有 refs/heads/master 对应你的 refs/remotes/git-svn，所以使用它，你不需要“real-trunk”。

“git checkout”不执行任何更改，它只是更改您当前的分支。您可以改回当前分支，但使用“git checkout your_previous_commit_or_branch”。

“git checkout -b branchname”创建一个新分支。要删除分支，请使用“git branch -D branchname”。

# jakarta-ee - 为什么 SIB 连接关闭？（Websphere 服务集成总线）

> ID：10742192
> 
> 赞同：1
> 
> 时间：2012-05-24T17:11:05.003
> 
> 标签：jakarta-ee, jms, websphere

我在 WebSphere 7.0.0.21 上部署了一个消息驱动 Bean (MDB)，它在 SIB（服务集成总线）队列上发送 JMS 消息。

创建 JMS 资源：

```
@Resource(name = CONN_FACTORY, mappedName = CONN_FACTORY)
private QueueConnectionFactory connFactory;

@PostConstruct
public void postConstruct() {
  queueConnection = connFactory.createQueueConnection();
  queueSession = queueConnection.createQueueSession(true, Session.AUTO_ACKNOWLEDGE);
  responseQueueSender = queueSession.createSender(getResponseQueue());
} 
```

并销毁：

```
@PreDestroy
public void preDestroy() {
  responseQueueSender.close();
  queueSession.close();
  queueConnection.close();
} 
```

像这样发送：

```
TextMessage responseMessage = queueSession.createTextMessage("message");
responseQueueSender.send(responseMessage, DeliveryMode.PERSISTENT, Message.DEFAULT_PRIORITY, expirationTime);
queueSession.commit(); 
```

我有大约 20 个 MDB 实例。当我向 MDB 生成大量传入消息时，就会出现问题。我收到以下错误：

```
CWSIA0053E: An exception was received during the call to the method JmsSessionImpl.getTransaction (#1): javax.resource.spi.IllegalStateException: CWSJR1121E: An internal error has occurred. During the call to the method getManagedConnection the exception javax.resource.spi.ResourceAllocationException: CWSJR1028E: An internal error has occurred. The exception com.ibm.ws.sib.processor.exceptions.SIMPConnectionUnavailableException: CWSIK0022E: The connection is closed to messaging engine seit3022Node01.server1-Payment and cannot be used. was received in method createManagedConnection. was thrown.. 
```

如果我将队列连接工厂的连接池大小增加很多，错误发生的几率会更低，但它仍然存在。如果我降低池大小，则会经常发生错误。

如何关闭连接？如果我的连接池大小大于并发 MDB:s 的数量，如何关闭连接？

连接池有各种属性，但我找不到任何关于关闭正在使用的连接...而且我的代码肯定不会关闭任何连接（除了`@PreDestroy`）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T17:05:58.607

我不确定是什么导致了`SIMPConnectionUnavailableException`这里，但是您在 MDB 中管理连接的方式无论如何都不正确。您应该将`postConstruct`and`preDestroy`方法中的代码移动到`onMessage`方法中，而不是尝试重用相同的连接。如果您想确保 MDB 具有正确的事务行为，这一点尤其重要。请注意，由于连接工厂执行连接池，因此为每个接收到的消息请求连接不会导致开销。

# .net - 移动应用程序作为基于相同结构的两个版本

> ID：10742196
> 
> 赞同：1
> 
> 时间：2012-05-24T17:11:33.647
> 
> 标签：.net, visual-studio, windows-phone-7

我目前正在为手机（智能手机）开发一个应用程序。我的想法已经选择了以两个不同版本分发应用程序的路径。一种是免费的，但里面有添加和横幅，另一种是你必须付费购买的，没有添加或横幅。

所以基本上，这两个版本都基于相同的程序，但主要区别在于它们要么绑定广告，要么不绑定广告。这对我来说很清楚，我对这个想法没有任何疑问。**但..**

我发现为我的应用程序组织我的项目非常棘手，明确地说，我正在为 Windows Phone 7、Android 和 iOS 开发应用程序。目前我试图在 Visual Studio 中组织我的 Windows Phone 7 项目，但我很困惑我应该以哪种方式保存项目。

我的意思是，如果我在 Visual Studio 中有两个不同的项目，一个有广告，一个没有。如果我需要修复应用程序中的某些内容，我需要在两个项目中进行更改，并且我确信这不是处理这些事情的正确方法。因此，如果有人在让您的应用程序具有两个不同版本但具有相同功能（广告除外）方面有任何经验，请随时向我解释您通常如何处理此类问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T17:15:48.340

我个人会有一个项目，只有一组文件，并且只需使用条件编译 ( `#ifdef`... `#endif`) 来去除与广告相关的代码。我会创建两个目标（四个包括两个调试目标），一个带有编译时标志，一个没有，然后构建我当时需要的任何一个。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-24T17:17:50.910

我认为最好添加应用程序的试用版。然后您可以拥有一个应用程序并添加以下内容：

```
if(isTrial)
{
 //show banner
} 
```

在 Windows Phone 中你必须使用

```
using Microsoft.Phone.Marketplace; 
```

并使用此命名空间的属性。

# android - 如何以平板电脑形式制作 Android 4.0.3 x86 虚拟设备？

> ID：10742197
> 
> 赞同：2
> 
> 时间：2012-05-24T17:11:38.287
> 
> 标签：android, avd, android-4.0-ice-cream-sandwich

前几天刚刚发布了对 Android 4.0.3 模拟器的新 x86 支持。我已经能够使用新的 Intel x86 构建成功地创建一个新的虚拟设备，而且效果很好！硬件加速带来了多么大的不同……唯一的事情是我想创建一个表现得像平板电脑的 VD。我能够创建一个平板大小的 VD，但它显示得好像它是 Android 操作系统的智能手机版本。

![我的 AVD 设置试图创建平板电脑大小的显示器。](../Images/75ec7314e0ee2cabd727259bae567a35.png)

请注意，生成的 VD 是智能手机而不是平板电脑。

![在此处输入图像描述](../Images/468aa6b1cc6409c47e6e34d6e3ab26fd.png)

如何创建 Android 4.0.3 的平板电脑版本？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T17:18:19.040

也许您需要从 API-13 文件夹（SDK 内）复制**WXGA800皮肤文件夹并粘贴到 API-15 的皮肤文件夹。**

有关更多信息，请阅读[此](https://groups.google.com/forum/?fromgroups#!topic/android-platform/RG2jiZHCIYI)

# javascript - 悬停在子菜单项上时保持悬停状态

> ID：10742200
> 
> 赞同：0
> 
> 时间：2012-05-24T17:11:47.217
> 
> 标签：javascript, jquery, menu, hover, mouseenter

当鼠标悬停在此菜单中的子菜单上时，如何使 :hover 状态保持在顶层？这可能很简单，但我似乎无法让它发挥作用。我试过做 mouseEnter 但我很可能做的不正确，因为我对 jQuery 知之甚少。提前致谢！

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>New Menu</title>

<link rel="stylesheet" type="text/css" href="droplinetabs.css" />

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>

<script src="droplinemenu.js" type="text/javascript"></script>

<script type="text/javascript">

//build menu with DIV ID="myslidemenu" on page:
droplinemenu.buildmenu("droplinetabs1")

</script>

</head>

<body>

<div id="droplinetabs1" class="droplinetabs">
<ul id="base">
<li><a href="#">Stuff to Do</a>
  <ul>
  <li class="base"><a href="#">Activities 1.1</a>     
    <ul>
          <li><a href="#">Cricket</a></li>
          <li><a href="#">Rugby</a></li>
          <li><a href="#">Soccer</a></li>
         <li><a href="#"> Football</a></li>
      </ul>
  </li>
  <li><a href="#">Activities 1.2</a>      
        <ul>
          <li><a href="#">Eating</a></li>
          <li><a href="#">Cooking</a></li>
          <li><a href="#">Baking</a></li>
      </ul>
  </li>
  <li><a href="#">Activities 1.3</a>
      <ul>
        <li><a href="#">Music</a></li>
        <li><a href="#">Chess</a></li>
        <li><a href="#">Reading</a></li>
        <li><a href="#">Scribbling</a></li>
      </ul>
    </li>
  </ul>
</li>
<li class="base"><a href="#">More Stuff to Do</a>
  <ul>
  <li><a href="#">Activities 2.1</a>      
    <ul>
        <li><a href="#">Cricket</a></li>
        <li><a href="#">Rugby</a></li>
        <li><a href="#">Soccer</a></li>
        <li><a href="#"> Football</a></li>
      </ul>
  </li>
  <li><a href="#">Activities 2.2</a>      
    <ul>
          <li><a href="#">Eating</a></li>
          <li><a href="#">Cooking</a></li>
          <li><a href="#">Baking</a></li>
   </ul>
  </li>
  <li><a href="#">Activities 2.3</a>
      <ul>
         <li><a href="#">Music</a></li>
         <li><a href="#">Chess</a></li>
         <li><a href="#">Reading</a></li>
         <li><a href="#">Scribbling</a></li>
      </ul>
    </li>
  </ul>
</li>
<li class="base"><a href="#">Even More</a>
  <ul>
  <li><a href="#">Activities 3.1</a>      
    <ul>
      <li><a href="#">Cricket</a></li>
      <li><a href="#">Rugby</a></li>
      <li><a href="#">Soccer</a></li>
      <li><a href="#">Football</a></li>
     </ul>
  </li>
  <li><a href="#">Activities 3.2</a>      
    <ul>
      <li><a href="#">Eating</a></li>
      <li><a href="#">Cooking</a></li>
      <li><a href="#">Baking</a></li>
    </ul>
  </li>
  <li><a href="#">Activities 3.3</a>
    <ul>
      <li><a href="#">Music</a></li>
      <li><a href="#">Chess</a></li>
      <li><a href="#">Reading</a></li>
      <li><a href="#">Scribbling</a></li>
      </ul>
   </li>
</ul>
</li>
</ul>
</div>

</body>
</html> 
```

和

```
var droplinemenu={

arrowimage: {classname: 'downarrowclass', src: 'down.gif', leftpadding: 5}, //customize down arrow image
animateduration: {over: 1, out: 1}, //duration of slide in/ out animation, in milliseconds

buildmenu:function(menuid){
    jQuery(document).ready(function($){
        var $mainmenu=$("#"+menuid+">ul")
        var $headers=$mainmenu.find("ul").parent()
        $headers.each(function(i){
            var $curobj=$(this)
            var $subul=$(this).find('ul:eq(0)')
            this._dimensions={h:$curobj.find('a:eq(0)').outerHeight()}
            this.istopheader=$curobj.parents("ul").length==1? true : false
            if (!this.istopheader)
                $subul.css({left:0, top:this._dimensions.h})
            var $innerheader=$curobj.children('a').eq(0)
            $innerheader=($innerheader.children().eq(0).is('span'))? $innerheader.children().eq(0) : $innerheader //if header contains inner SPAN, use that

            $curobj.hover(
                function(e){
                    var $targetul=$(this).children("ul:eq(0)")
                    if ($targetul.queue().length<=1) //if 1 or less queued animations
                        if (this.istopheader)
                            $targetul.css({left: $mainmenu.position().left, top: $mainmenu.position().top+this._dimensions.h})
                        if (document.all && !window.XMLHttpRequest) //detect IE6 or less, fix issue with overflow
                            $mainmenu.find('ul').css({overflow: (this.istopheader)? 'hidden' : 'visible'})
                        $targetul.dequeue().slideDown(droplinemenu.animateduration.over)
                },
                function(e){
                    var $targetul=$(this).children("ul:eq(0)")
                    $targetul.dequeue().slideUp(droplinemenu.animateduration.out)
                }
            ) //end hover
        }) //end $headers.each()
        $mainmenu.find("ul").css({display:'none', visibility:'visible', width:$mainmenu.width()})
    }) //end document.ready
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T17:55:49.560

添加`$(this).addClass('hover');`到您的悬停输入功能和`$(this).removeClass('hover');`悬停功能并添加`li.hover{/* css specific to it */}`到您的 CSS。

```
 $curobj.hover(
            function(e){
                var $targetul=$(this).children("ul:eq(0)")
                                    $(this).addClass('hover');
                if ($targetul.queue().length<=1) //if 1 or less queued animations
                    if (this.istopheader)
                        $targetul.css({left: $mainmenu.position().left, top: $mainmenu.position().top+this._dimensions.h})
                    if (document.all && !window.XMLHttpRequest) //detect IE6 or less, fix issue with overflow
                        $mainmenu.find('ul').css({overflow: (this.istopheader)? 'hidden' : 'visible'})
                    $targetul.dequeue().slideDown(droplinemenu.animateduration.over)
            },
            function(e){
                var $targetul=$(this).children("ul:eq(0)")
                                    $(this).removeClass('hover');
                $targetul.dequeue().slideUp(droplinemenu.animateduration.out)
            }
        ) //end hover 
```

或者，如果你想要一个纯 CSS 替代品。这是我使用的每个网站。

```
nav ul{
    margin-bottom:10px;
    list-style-image:none
}
nav>ul>li{
    display:inline-block;/* float:left needed for some designs */
    font-size:20px;
    text-align:center;
    position:relative;
    z-index:950
}
nav a{
    text-decoration:none;
    display:block;
    color:#000;
    padding:8px 0
}
nav li ul{
    display:none;
    position:absolute;
    padding:0 8px;
    margin:0
}
nav li:hover ul{display:block}
nav li li{
    font-size:15px;
    float:none;
    width:100%;
    z-index:999
} 
```

请注意，这是一个骨架，并没有设计成漂亮的样式。

HTML 也很简单：

```
<nav>
    <ul>
        <li><a href="#">top level item</a>
            <ul>
                <li><a href="#">sub-item</a></li>
            </ul>
        </li>
        <li>top level item</li>
    </ul>
</nav> 
```

# amazon - 亚马逊应用内购买错误

> ID：10742204
> 
> 赞同：2
> 
> 时间：2012-05-24T17:12:22.327
> 
> 标签：amazon, kindle, in-app-purchase

我们刚刚使用他们新的应用内购买 SDK 在 Amazon Android Store 上推出了我们的游戏。我们看到一些销售导致用户无法获得他们支付的虚拟商品。我已经复制了一个用例，每次都会导致这种情况发生。

基本上，用户发起和 IAP，他们被带到亚马逊购买对话框，他们进行购买，他们得到亚马逊的购买确认对话框。
如果用户单击对话框上的关闭按钮或屏幕底部选项栏上的返回按钮（使用 Kindle Fire），对话框将关闭，并且 IAP 流程会向应用程序发送一条消息，购买已完成成功。我收到消息并处理它，一切都很好。
但是，如果用户点击“主页”按钮，购买确认关闭并且用户被转储到主屏幕，则应用程序永远不会收到购买成功消息。

我正在尝试解决一些问题，因为用户不会关心亚马逊 IAP 实施中消息回执的变幻莫测，他们只关心他们为没有得到的东西付费。我们有 1 件非消耗品，这不是问题，因为我们的应用会在启动时检查以前的购买。但消耗品是另一个问题。你无法恢复那些。

有没有人遇到过这种情况并且有解决方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-12-16T19:38:12.417

实际上有 2 个应用程序执行购买。购买由您的应用程序发起，但由设备中的亚马逊 IAP 组件执行，该设备是另一个应用程序。如果您按下主页按钮，这会将应用程序带到后台，并且通常由于 android 的积极内存管理，应用程序会进入休眠阶段甚至被终止，具体取决于设备上的资源利用率。这会导致购买无法到达您的应用。

亚马逊有一个解决方法。如此处所述 - [https://developer.amazon.com/public/apis/earn/in-app-purchasing/docs-v2/implementing-iap-2.0](https://developer.amazon.com/public/apis/earn/in-app-purchasing/docs-v2/implementing-iap-2.0)，实施 onPurchaseUpdateResponse()，它将在应用程序重新启动。有一小段时间延迟会阻止立即“获取待处理的购买”。

还要确保在项目完成后调用 notifyFullfilment() 给用户。不这样做仍然会导致您的应用程序正常工作；但这可能会对您的获利产生负面影响（有不同的原因，我不会详细说明）。

# sql-server-2008 - 无法在 SQL 中使用不同的 Case 语句

> ID：10742207
> 
> 赞同：1
> 
> 时间：2012-05-24T17:12:54.007
> 
> 标签：sql-server-2008, tsql

当我执行 SP 时，我收到以下错误消息：

> 消息 102，级别 15，状态 1，第 1 行
> '.' 附近的语法不正确。

我在没有 case 语句的情况下测试了 SQL，它可以工作，它返回每个管理员。

```
ALTER PROCEDURE [dbo].[GetRoles]
AS
DECLARE @num varchar(25),
@reportid Decimal,
@dom varchar(10)
set @reportid = 1
set @dom = 'use5'

SELECT @num = 
Case @reportid

 WHEN 1 THEN
  'select distinct u.id as userId, u.domain, u.isAdmin, u.email, u.canReport, a.[site],
  a.bldgNum, a.dataCenterNum, l.shortName, l.[description], a.canApprove, a.canComplete
  from locAdmin a inner join location l on (a.site=l.site and a.bldgNum = l.bldgNum 
  and a.dataCenterNum = l.dataCenterNum) right outer join [user] u on u.id=a.userId 
  and u.domain=a.domain where u.isAdmin = 1'

 End

 EXEC (@num) 
```

由于某种原因， distinct 也不会过滤掉重复的用户 ID。根据他们拥有的访问权限，一些用户 ID 被输入了 3 倍（这就是我进来之前的设置方式）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T17:17:42.483

您限制`@num`为 25 个字符 - 但您设置的字符串要长得多 - 它将被截断
（另外：*`@num`这是一个非常奇怪且可能具有误导性的名称 - 它暗示了一些数字 - 这真的是更多的 SQL 语句或其他东西 - 在命名变量时使用最不意外的原则！*）

尝试这样的事情：

```
DECLARE @stmt NVARCHAR(2000)
.....

SELECT @stmt = 
   CASE @reportid
      WHEN 1 THEN
          N'select distinct u.id as userId, u.domain, u.isAdmin, u.email, u.canReport, a.[site],
  a.bldgNum, a.dataCenterNum, l.shortName, l.[description], a.canApprove, a.canComplete
  from locAdmin a inner join location l on (a.site=l.site and a.bldgNum = l.bldgNum 
  and a.dataCenterNum = l.dataCenterNum) right outer join [user] u on u.id=a.userId 
  and u.domain=a.domain where u.isAdmin = 1'

 EXEC (@stmt) 
```

# ruby-on-rails - 目标方法的名称是否在 before_filter 中可用

> ID：10742208
> 
> 赞同：4
> 
> 时间：2012-05-24T17:12:59.620
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

有没有办法让目标方法的名称在前置过滤器中可用。

例如，我有以下代码

```
before_filter :login

def show
   #...
end

def login
   # ...
   # get the name of method original called 
   # ...
end 
```

`http://<host>/show`被调用，随后调用 login

我可以获得一个`show`字符串或类似的东西，以便我可以将指令传递给实际发生在不同控制器上的登录，以返回原始目标方法

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-24T18:34:50.860

您可以简单地从参数中获取操作：`params[:action]`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T17:52:00.780

正如@apneadiving 提到的，您可以访问`params[:action]`以获取“目标”（即“显示”、“索引”等）。

需要注意的一点是，通常对于 before_filters 你应该使用`request.params`而不是仅仅`params`因为有时使用 just`params`会导致奇怪的行为（我过去做过。我不记得确切的奇怪行为，但它并不理想）。另外，如果您要更新参数，我发现我需要合并到 request.params 而不是只做类似`params[:key] = value`.

# javascript - 如何在不从我自己的服务器托管博客的情况下从 Blogger 页面（其中包含投票）存储和访问 javascript 变量？

> ID：10742209
> 
> 赞同：0
> 
> 时间：2012-05-24T17:13:03.670
> 
> 标签：javascript, html, database, blogger

我不想在用户每次足够慷慨地通过投票给我反馈时丢失从用户那里收集的信息。并且代码不完整，但总体思路就在那里。如果这个问题已经得到解决，我深表歉意，但在考虑写这篇文章之前，我环顾四周。

```
 <script type="text/javascript" src="script.js">
        function sendForm() {

        var previousPollResults;
        // array read from webpage which will be added to.

        for (var i=0; i < document.pollForm.choice.length; i++) {
            if (document.pollForm.choice[i].checked) {
                previousPollResults.choice[i]+=1;
            } else {
                //nothing
            }
        } 
```

```
 <form name="pollForm">
        <input type="radio" name="choice" value="java" checked />Java<br>
        <input type="radio" name="choice" value="webDesign">Web Design<br>
        <input type="radio" name="choice" value="blogging" checked />Blogging<br>
        <input type="radio" name="choice" value="arduino">Arduino<br>
        <input type="radio" name="choice" value="digitalElectronics" checked />Digital Electronics<br>
        <input type="radio" name="choice" value="onlineResources">Online Resources <br>

        <input type="button" value="send" onclick="sendForm()">
    </form> 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-05-24T17:19:37.777

由于您使用的是 Blogger 页面而不是托管自己的网站，我假设他们应该有一个投票工具设置。

如果我没记错的话，除了通过 JS 的 COOKIES 之外，您将无法在网站上/从网站上保存任何数据，这不会让您跟踪您的投票，只有用户在访问时拥有投票信息。

阅读：[博客民意调查](http://support.google.com/blogger/bin/answer.py?hl=en&answer=42077)

这可能是另一种选择：[Blogger 上的服务器端代理](https://stackoverflow.com/questions/10117343/server-sided-proxy-on-blogger)

或者这个：[自定义嵌入式投票](http://www.bloggingehow.com/2012/02/3-steps-to-make-free-custom-embedded.html)

还有：[Blogger 投票](http://bloggerfordummies.blogspot.com/2007/10/polls-for-blogger.html)

# xml - 隔离存储文件流上不允许 Windows Phone 7 操作

> ID：10742210
> 
> 赞同：0
> 
> 时间：2012-05-24T17:13:06.477
> 
> 标签：xml, windows-phone-7, isolatedstorage

我正在开发一个具有目录的应用程序，它通过 XML 从 Web 将其拉入，将其写入本地 XML 文件，然后从那里读取它以显示联系人。我遇到了我的 IsolatedStorageFileStream 无法正常工作的问题，因为不允许该操作。这是我的代码：

```
IsolatedStorageFile isoStorage = IsolatedStorageFile.GetUserStoreForApplication();
        IsolatedStorageFileStream file = isoStorage.OpenFile("Components/contacts.xml", FileMode.OpenOrCreate, FileAccess.Read);
        var reader = new StreamReader(file);
        XElement appDataXml = XElement.Load(reader);
        lstContacts.ItemsSource = from contact in appDataXml.Descendants("contact")
                                  select new ContactItem
                                  {
                                      ImageSource = contact.Element("Image").Value,
                                      FName = contact.Element("FName").Value,
                                      LName = contact.Element("LName").Value,
                                      Extension = contact.Element("Extension").Value,
                                      Email = contact.Element("Email").Value,
                                      Cell = contact.Element("Cell").Value,
                                      Title = contact.Element("TitleName").Value,
                                      Dept = contact.Element("deptName").Value,
                                      Office = contact.Element("officename").Value,
                                      ID = contact.Element("ID").Value
                                  }; 
```

我可以直接从互联网上提取它并将其放入`lstContacts`，但我似乎什至无法打开文件将其写入文件（这样它就可以离线使用）。[这是我放入 pastebin 的实际错误](http://pastebin.com/JHQnQehQ)。这直接发生在`IsolatedStorageFileStream file = isoStorage.OpenFile("Components/contacts.xml", FileMode.OpenOrCreate, FileAccess.Read);`

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T20:23:05.193

下载并保存文件时，请确保在尝试再次读取之前关闭文件。

您应该在 using 块中包装 File The Readers/Writers，因为这是一种快速且安全的方法（请参阅下面的 MSDN 示例） [http://msdn.microsoft.com/en-us/library/aa664736(v=vs. 71).aspx](http://msdn.microsoft.com/en-us/library/aa664736(v=vs.71).aspx)

```
using System;
using System.IO;
class Test
{
   static void Main() {
      using (TextWriter w = File.CreateText("log.txt")) {
         w.WriteLine("This is line one");
         w.WriteLine("This is line two");
      }
      using (TextReader r = File.OpenText("log.txt")) {
         string s;
         while ((s = r.ReadLine()) != null) {
            Console.WriteLine(s);
         }
      }
   } 
```

}

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T12:13:39.613

我发现了这个问题。问题是我在运行它之前已经在我的系统上创建了文件，但它不喜欢那样。

# javascript - AJAX 可访问的长时间运行的服务任务在启用 ASP.NET 兼容性/会话的环境中阻止后续 AJAX 服务请求

> ID：10742211
> 
> 赞同：1
> 
> 时间：2012-05-24T17:13:12.283
> 
> 标签：javascript, asp.net, wcf, http, session

我在以下链接中描述并解决了一个问题

[http://blogs.msdn.com/b/silverlightws/archive/2009/09/30/having-a-pollingduplex-service-and-any-other-wcf-service-in-the-same-website-causes- silverlight-calls-to-be-slow.aspx](http://blogs.msdn.com/b/silverlightws/archive/2009/09/30/having-a-pollingduplex-service-and-any-other-wcf-service-in-the-same-website-causes-silverlight-calls-to-be-slow.aspx)

...但是我不能使用推荐的解决方案（使用客户端 HTTP 堆栈），因为我使用的是 JavaScript 而不是 Silverlight！

```
POST /PollingWcfServices/ServiceWcf.svc HTTP/1.1
Accept: */*
Content-Length: 564
Content-Type: application/soap+xml; charset=utf-8
Accept-Encoding: gzip, deflate
User-Agent: Mozilla/4.0
Host: foo
Connection: Keep-Alive
Pragma: no-cache
Cookie: ASP.NET_SessionId=iyr4sf55rm1kypafjdvlhm55 
```

使用以下轮询代码

```
 request.onreadystatechange = function () {
            if (request.readyState == 4) {
                if (request.status == 200)
                    //Process and Poll again
                else
                    //Handle errors
            }

  request.open("POST", url);            
  request.setRequestHeader("Content-Type", "application/soap+xml;charset=utf-8");
  request.send(httpBody); 
```

不幸的是，由于 Session 是在 cookie 中设置的，服务器将尝试按顺序处理相同的会话服务调用。这是长轮询过程的一个大问题。一个简单的解决方案是从标头中删除 Cookie，使其看起来像使用 silverlight 客户端堆栈的 Silverlight 轮询。

request.setRequestHeader，只会追加到标头值；这似乎没有任何区别，因为 cookie 似乎设置在 .send 的头部。

Mozilla 唯一的解决方案，位于

[http://www.michael-noll.com/tutorials/cookie-monster-for-xmlhttprequest/](http://www.michael-noll.com/tutorials/cookie-monster-for-xmlhttprequest/)

`request.channel.loadFlags |= Ci.nsIRequest.LOAD_ANONYMOUS;`

也不会删除 ASP.NET_SessionID cookie。虽然它确实删除了 ASPXAUTH cookie。

有没有人在启用 ASP.NET 兼容性/会话的环境中为 AJAX 可访问的长时间运行的服务任务提供不阻塞后续 AJAX 服务请求的解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T19:11:01.970

答案就在这里……

> 在 .NET 4 中，您可以在 Application_BeginRequest 中执行此操作
> 
> if (Context.Request.Path.EndsWith("xxx.svc")) Context.SetSessionStateBehavior(SessionStateBehavior.ReadOnly);

--[如何强制 IIS 托管的 WCF 或 ASMX [webservice] 以只读方式使用会话对象？](https://stackoverflow.com/questions/1269198/how-to-force-an-iis-hosted-wcf-or-asmx-webservice-to-use-session-object-readon)

通过更改回调服务的 SessionStateBehavior，我能够隔离该服务以非顺序运行并停止阻塞。

谢谢电影（[https://stackoverflow.com/users/264022/cine](https://stackoverflow.com/users/264022/cine)）

# c# - LINQ - 返回随机值不起作用

> ID：10742212
> 
> 赞同：1
> 
> 时间：2012-05-24T17:13:15.503
> 
> 标签：c#, asp.net

我的基础设施中有这个类，假设返回随机图像。它总是返回相同的图像。我在我的网站上的不同位置使用了完全相同的代码，并且可以正常工作。有任何想法吗？

[这个](https://stackoverflow.com/questions/648196/random-row-from-linq-to-sql)问题是我获得获取随机值的信息的地方。我不明白为什么它适用于一个地方而不是另一个地方......

背景.cs

```
public static class Background
{
    public static string Get()
    {
        photoBlogModelDataContext _db = new photoBlogModelDataContext();
        var image = _db.Images.OrderBy(x => Guid.NewGuid()).FirstOrDefault();
        return image.Small; // Always same value?
    }
} 
```

另一个页面上的相同代码在我循环浏览我的画廊并从中选择随机图像的地方工作

```
<img src="@Url.Content("~/content/uploads/" + item.Images.OrderBy(x => Guid.NewGuid()).FirstOrDefault().Small)" alt="" /> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T17:18:38.960

[向导不是随机数](http://blogs.msdn.com/b/ericlippert/archive/2012/04/30/guid-guide-part-two.aspx)。它们通常是连续的，因为它们具有时间戳组件，这意味着您将始终从该代码中获取第一张或最后一张图像。您应该使用`Random`该类（或加密随机数生成器之一，如果它真的很重要）来获取 0 和您拥有的图像数量之间的随机数，然后获取第 n 个图像（其中 n 是随机数）。如果您在短时间内多次调用此函数，则应确保在`Random`对该方法的所有调用之间使用相同的实例。（这意味着创建一个可以重复使用的私有静态 Random 实例。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T17:18:59.197

好吧，我会说一次你有 linq2entities，一次有 linq2object

不确定 OrderBy(Guid.NewGuid()) 是否相同。

如果您尝试枚举

```
public static class Background
{
    public static string Get()
    {
        photoBlogModelDataContext _db = new photoBlogModelDataContext();
        var image = _db.Images.ToList().OrderBy(x => Guid.NewGuid()).FirstOrDefault();
        return image.Small; // Always same value?
    }
} 
```

它应该改变。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T17:47:29.750

您是否有理由不能使用`System.Random`下面的课程？

```
var random = new Random();
var index = random.Next(0, count); // use the list count here
var randomImage = _db.Images[index]; // or equivalent 
```

# facebook - 如何通过开放图访问 facebook 用户的订阅？

> ID：10742222
> 
> 赞同：1
> 
> 时间：2012-05-24T17:14:07.477
> 
> 标签：facebook, facebook-opengraph

Facebook 在 11 年 9 月推出了订阅按钮。

订阅连接似乎介于 Like 关系和友谊之间。

我的喜欢和我的朋友都可以通过打开的图表 -

`https://graph.facebook.com/me/likes?(access_token)` 和 `https://graph.facebook.com/me/friends?(acces_token)`

但我订阅的公众人物并没有出现在这些回复中。有一种订阅连接类型，但这涉及应用程序接收有关其用户的实时更新。

如何通过开放图访问用户的订阅？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T17:34:22.443

我猜你没有看过这个文档

请参阅[https://developers.facebook.com/docs/reference/api/user/#subscribers](https://developers.facebook.com/docs/reference/api/user/#subscribers)和[https://developers.facebook.com/docs/reference/api/user/#subscribedto](https://developers.facebook.com/docs/reference/api/user/#subscribedto)

您需要的权限是`user_subscriptions`或`friends_subscriptions`

# java - 在 Play 框架中使用 ElementCollection 时出现 LazyInitializationException

> ID：10742224
> 
> 赞同：7
> 
> 时间：2012-05-24T17:14:13.273
> 
> 标签：java, hibernate, jpa, playframework

我的应用程序模型集中有一个用户实体，定义如下：

```
public class User extends Model {

    private String name;

    private byte[] sk;

    @Column(columnDefinition = "BINARY(272)")
    private byte[] pk;

    private int port;

    @OneToOne
    public Profile profile;

    @ElementCollection
    public List<String> friends;

    @ElementCollection
        public List<String> mirrors;
...
} 
```

在我的应用程序（控制器类）的不同部分的方法中，我正在检索并尝试修改镜像列表，如下所示：

```
 User u = User.connect(username);
    int port = ProfileFinder.getLocation(username, mirror);
    u.mirrors.remove(mirror);
    u.save(); 
```

这引发了一个错误，指出：

```
LazyInitializationException occured : failed to lazily initialize a collection of role: models.User.mirrors, no session or session was closed 
```

我怀疑这是因为我误解了`@ElementCollection`标签的某些元素，但谁能澄清我该如何纠正这个问题？

谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-24T17:27:34.330

默认情况下，`XxxToMany`关联和元素集合是延迟加载的。

这意味着集合元素仅在需要时才从数据库中加载，此时调用集合方法之一。但是，当然，实体需要附加到它的会话才能工作。如果会话关闭，则会抛出您得到的异常。

您可以通过设置注释的 fetch 属性使其急切加载，或者在返回之前在事务中使用初始化集合的查询或服务。请注意，如果您使其急切加载，它将始终被急切加载，即使您不需要集合元素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-06T05:37:41.583

如果您不想从延迟加载更改为急切，您还有另一个选择：合并。

```
User u = User.connect(username);
u.merge(); 
```

合并将获取与会话断开连接的对象并重新连接它。

例如，如果您缓存一个对象（在这种情况下是 User 的实例），则如果不首先在对象上使用 .merge()，则无法检索用户对象的镜像。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-03-10T12:23:01.163

类级别的用户事务

@零件

@Transactional

公共类类名

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-24T17:33:10.123

是的，您应该使用 EAGER 注释，但要小心，因为正如 JB Nizet 所说，这些元素总是会被急切地加载。

# python - 如何在 SQLAlchemy 声明性类中使用引擎？

> ID：10742225
> 
> 赞同：0
> 
> 时间：2012-05-24T17:14:15.140
> 
> 标签：python, orm, sqlalchemy

可以说我`User`的`user.py`模块中有这个。我将把它`User`用作更大应用程序的一部分。我将`Engine`在主应用程序模块中配置（数据库连接）。但...

如果`User.foo`需要使用`Engine`or`Session`怎么办？例如，我在数据库中有一个函数，它需要一个用户 ID，我想在`foo`. 为此，我需要使用`Engine.execute`or `Session.execute`; 但`Engine`or`Session`尚未创建。

```
from sqlalchemy.ext.declarative import declarative_base
from sqlalchemy import Column, Integer, String
Base = declarative_base()
class User(Base):
    __tablename__ = 'users'

    id = Column(Integer, primary_key=True)
    name = Column(String)
    fullname = Column(String)
    password = Column(String)

    def __init__(self, name, fullname, password):
        self.name = name
        self.fullname = fullname
        self.password = password

    def foo(self, bar):
        """I need an Engine or Session!"""
        pass #....

    def __repr__(self):
       return "<User('%s','%s', '%s')>" % (self.name, self.fullname, self.password) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T20:25:19.370

使用[`object_session`](http://docs.sqlalchemy.org/en/rel_0_7/orm/session.html#sqlalchemy.orm.session.Session.object_session)类的类方法`Session`：

```
def foo(self, bar):
    session = Session.object_session(self)
    #.... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T17:20:28.270

每当有人调用该方法时，您都需要创建一个应用程序级 API 来检索数据库。

例如，当`collective.lead`用于将 SQLAlchemy 与 Zope 集成时，数据库作为实用程序注册到 Zope 组件体系结构中，因此每当我需要会话时，我都会使用 getUtility 查找：

```
db = getUtility(IDatabase, name=u'responsecentre')
session = db.session 
```

在这种情况下，ZCA`getUtility`是特定于应用程序的 API，用于查找数据库连接，其中会话绑定到线程。

# c# - C# OpenSSL RSA 私钥加密

> ID：10742229
> 
> 赞同：3
> 
> 时间：2012-05-24T17:14:28.113
> 
> 标签：c#, openssl, rsa

我在使用 OpenSSL 库的 .Net 包装器来计算一组字节的 RSA 私钥加密时遇到了一些问题。

目前，我读入了一个 .pem 文件，其中包含我想在 BIO 对象中使用的私钥。

```
public byte[] ComputeRSAEncryption(byte[] dataBlock, BIO privateKey)
{
   RSA rsa = RSA.FromPrivateKey(privateKey);
   return rsa.PrivateEncryption(dataBlock, RSA.Padding.None);
} 
```

我正在使用大小为 64 字节的 RSA 密钥和大小为 64 字节的数据块。调用上述方法时，出现错误：

> 数据对于模数来说太大了

但是，如果我使用大小为 64 字节的数据块，其中所有字节都设置为 0x00，则该方法可以正常工作。

有什么我想念的吗？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-25T09:01:52.737

我终于解决了这个问题。对于其他感兴趣的人，数据块的最低有效字节的值必须为 0x00。通过强制执行此条件，RSA 加密和解密就像一个魅力。

# html - 这个例子中的height属性如何整理？

> ID：10742233
> 
> 赞同：0
> 
> 时间：2012-05-24T17:14:54.510
> 
> 标签：html, css, height

我在为模式窗口中的内容设置高度属性时遇到问题。

我希望模态窗口中的内容为 100%，但问题是它仅高达 30% 左右。为什么会发生这种情况，如何让模态窗口中的内容能够填充模态窗口，而不是填充大约 30%，从而启用滚动条？

下面是模态窗口的宽度，很好：

```
#simplemodal-container {height:75%; width:50%;} 
```

下面是 iframe 的高度和宽度：

```
$.modal('<iframe src="' + src + '" style="border:0;width:100%;height:100%;">'); 
```

最后下面是进入模态窗口的内容（我确实将此高度设置为 100%，但后来我无法让它工作，所以它目前没有高度属性：

```
<div id="previouslink">
<button type="button" id="close" onclick="return parent.closewindow();">Close</button>
<h1>PREVIOUS QUESTIONS</h1>

<p>Search for a previous question by entering in a phrase in the search box below and submitting the phrase</p>

<form action="previousquestions.php" method="post" id="modalform">
      <p>Search: <input type="text" name="questioncontent" value="<?php echo $questioncontent; ?>" /></p>
      <p><input id="searchquestion" name="searchQuestion" type="submit" value="Search" /></p>
      </form>

</div> 
```

您可以通过访问此[链接](http://helios.hud.ac.uk/u0867587/Mobile_app/QandATable2.php)然后单击加号按钮来查看模式窗口。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T17:19:23.117

添加此样式：

```
#simplemodal-data {height: 100%} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T17:22:45.223

如果文档主体本身没有填充窗口，则可能会发生这种情况 - 文档高度小于窗口高度。通常，解决方案是这样的：

```
body {
  padding-bottom: 1500px;
} 
```

或者，一旦您将代码带到真实环境中，文档总是比窗口高，这可能不是问题。

# android - ListView cookie 问题

> ID：10742234
> 
> 赞同：0
> 
> 时间：2012-05-24T17:14:58.410
> 
> 标签：android, caching, cookies, android-listview

下面是我从我的 Web 服务填充 ListView 的代码。

1.  如何从 cookie 中设置和获取此 ListView？（我的代码上有一个例子）
2.  假设我有一个按钮可以刷新此列表，如何处理？
3.  如果用户连接到互联网如何处理？

我基本上想知道如何管理从 WebService 填充的 ListView。

```
public class EventsActivity extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.dashboard);

        RequestParams params = new RequestParams();
        params.put("user_id", "1");

        BloompItClient.get("get_events", params, new AsyncHttpResponseHandler() {
            @Override
            public void onStart() {

            }

            @Override
            public void onSuccess(String response) {                
                JSONObject jsonResponse;
                try {
                    jsonResponse = new JSONObject(response);

                    try {
                        String state = jsonResponse.getString("state");

                        if (state.equals("1")) {
                            ArrayList<HashMap<String, String>> eventsList = new ArrayList<HashMap<String, String>>();
                            JSONArray events = jsonResponse.getJSONArray("events");

                            for (int i = 0; i < events.length(); i++) {
                                JSONObject currentEvent = events.getJSONObject(i);
                                HashMap<String, String> eventMap = new HashMap<String, String>();

                                eventMap.put("college", currentEvent.getString("college_username"));
                                eventMap.put("author", currentEvent.getString("user_username"));
                                eventMap.put("title", currentEvent.getString("title"));                                                     
                                eventMap.put("date", currentEvent.getString("date"));

                                eventsList.add(eventMap);
                            }

                            ListView eventsListView = (ListView) findViewById(R.id.events);
                            EventsListAdapter eventsListAdapter = new EventsListAdapter(getApplicationContext(), eventsList);

                            // testing cookies

                            AsyncHttpClient asyncHttpClient = new AsyncHttpClient();

                            PersistentCookieStore persistentCookieStore = new PersistentCookieStore(getApplicationContext());
                            asyncHttpClient.setCookieStore(persistentCookieStore);

                            BasicClientCookie baseClientCookie = new BasicClientCookie("cookiesare", "awesome");
                            baseClientCookie.setVersion(1);
                            baseClientCookie.setDomain("it.bloomp");
                            baseClientCookie.setPath("/");
                            persistentCookieStore.addCookie(baseClientCookie);

                            List<Cookie> cookieList = persistentCookieStore.getCookies();

                            for (int i = 0; i < cookieList.size(); i++) {
                                System.out.println(cookieList.toString());
                            }

                            // testing cookies end

                            eventsListView.setAdapter(eventsListAdapter);
                        } else {

                        }
                    } catch (JSONException e) {
                        e.printStackTrace();
                    }
                } catch (JSONException e1) {
                    e1.printStackTrace();
                }
            }

            @Override
            public void onFailure(Throwable e) {

            }

            @Override
            public void onFinish() {

            }
        });
    }

    public void getEvents() {

    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T18:01:39.743

我会反过来回答你的问题。

> 如果用户连接到互联网如何处理？

如果这不是本地保存的数据，那么如果没有互联网连接，您将无能为力。您可以提示用户是否要激活 WiFi 或数据连接（如果它们都没有激活）。

[检查 Internet 连接是否可用？](https://stackoverflow.com/q/8018396/1267661)

> 假设我有一个按钮可以刷新此列表，如何处理？

如果在本地存储数据有意义，那么只需在适配器上调用 notifyDataSetChanged()。否则重新查询您的服务器并检查新的或修改的条目。

> 如何从 cookie 中设置和获取此 ListView？

假设您的示例有效，因为您没有发布任何 logcat 错误，因此将数据移入和移出 cookie 非常简单；使用 setAttribute() 和 getAttribute()。实际上，您可以使用任何形式的数据存储：SQLite 数据库、文本文件等来处理您通过 JSONArray 收集和解析的信息。

**添加**

循环遍历 List 的最简单方法是使用内置迭代器：

```
for(Cookie cookie : cookieList) {
    if(cookie.getAttribute("college_username").equals("Brown")) {
        // check more attributes or do something
    }
} 
```

# python - Python查询 - 可迭代的方法？

> ID：10742239
> 
> 赞同：1
> 
> 时间：2012-05-24T17:15:24.313
> 
> 标签：python, oop, methods, iteration

我正在尝试模拟以下输出（来自 Marakana.com 的[优秀 Python 教程](http://marakana.com/bookshelf/python_fundamentals_tutorial/oop.html#_emulation)：

```
>>> for c in lot.cars_by_age():
...     print c
1981 VW Vanagon
1988 Buick Regal
2010 Audi R8 
```

到目前为止我的代码：

```
class ParkingLot(object):
    def __init__(self, spaces, cars=[]):
        self.spaces = spaces
        self.cars = cars
    def park(self, car):
        if self.spaces == 0:
            print "The lot is full."
        else:
            self.spaces -= 1
            self.cars.append(car)
    def __iter__(self):
        return (car for car in self.cars)

class Car(object):
    def __init__(self, make, model, year):
        self.make = make
        self.model = model
        self.year = year
    def __str__(self):
        return '%s %s %s' % (car.year, car.make, car.model) 
```

我想向 ParkingLot() 类添加一个方法 (cars_by_age())。但是，根据示例代码，此方法在某种程度上需要是可迭代的。我不知道该怎么做——对于一个类，你定义了一个**iter**函数，但是你如何为一个方法做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-24T17:16:45.373

并不是*方法*是可迭代的；*该方法返回*的值是可迭代的。一个 `cars_by_age`实现可以简单地返回一个`Car`s 列表。

```
def cars_by_age(self):
    return sorted(self.cars, key=lambda car: car.year) 
```

用于[`sorted`](http://docs.python.org/library/functions.html#sorted)创建新的排序列表，并用于[`lambda`](http://docs.python.org/reference/expressions.html#lambda)指定要按汽车`year`属性排序。

[http://wiki.python.org/moin/HowTo/Sorting](http://wiki.python.org/moin/HowTo/Sorting)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T22:46:57.303

```
from operator import attrgetter

class ParkingLot(object):
    def __init__(self, spaces, cars=None):
        self.spaces = max(spaces, 0)
        self.cars = cars or []
    def park(self, car):
        if self.spaces > 0:
            self.spaces -= 1
            self.cars.append(car)
        else:
            print "The lot is full."
    def __iter__(self):
        return iter(self.cars)
    def cars_by_age(self):
        return sorted(self.cars, key=attrgetter("year"), reverse=True)

class Car(object):
    def __init__(self, make, model, year):
        self.make = make
        self.model = model
        self.year = year
    def __str__(self):
        return "{} {} {}".format(self.year, self.make, self.model) 
```

# c# - 无法将“AjaxControlToolkit.MaskedEditExtender”类型的对象转换为“System.Web.UI.WebControls.TextBox”类型

> ID：10742240
> 
> 赞同：0
> 
> 时间：2012-05-24T17:15:39.360
> 
> 标签：c#, jquery, asp.net

我正在使用这个：[http ://www.asp.net/ajaxLibrary/AjaxControlToolkitSampleSite/MaskedEdit/MaskedEdit.aspx](http://www.asp.net/ajaxLibrary/AjaxControlToolkitSampleSite/MaskedEdit/MaskedEdit.aspx)

在一个列中，我有多个文本框绑定到数据库中的某些列。我的目标是从那些掩码编辑的文本框中获取值。由于列中有 4 个控件，因此我试图获取如下值：

```
String firstTXT = ((TextBox)(row.Cells[5].Controls[1])).Text;
String SecondTXT = ((TextBox)(row.Cells[5].Controls[2])).Text; 
```

我可以从 firsttexbox 中获取值而没有任何错误（但它也被屏蔽了）。当我尝试从第二个开始时，我得到： `Unable to cast object of type 'AjaxControlToolkit.MaskedEditExtender' to type 'System.Web.UI.WebControls.TextBox'`。

有机会解决吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T17:21:48.440

显然，单元格中的第三个控件是`MaskedEditExtender`扩充您的第一个文本框的控件。根据您的标记，您可能希望获得第四个控件：

```
string secondTXT = ((TextBox) row.Cells[5].Controls[3]).Text; 
```

或者，更好的是，`id`为您的文本框提供属性并使用[FindControl()](http://msdn.microsoft.com/en-us/library/486wc64h.aspx)来获取它们：

```
string firstTXT = ((TextBox) row.Cells[5].FindControl("firstID")).Text;
string secondTXT = ((TextBox) row.Cells[5].FindControl("secondID")).Text; 
```

# google-chrome - 奇怪的 websocket 行为：仅在关闭选项卡时发送数据

> ID：10742247
> 
> 赞同：1
> 
> 时间：2012-05-24T17:16:28.017
> 
> 标签：google-chrome, websocket

你有没有遇到过这种奇怪的情况。我正在使用warmcat.com最新版本提供的libwebsocket来支持chrome 20。连接正确打开，没有任何错误（控制台日志中没有任何错误）但是当我调用HTML5 Websocket的connection.send（）方法时，什么也没有发生（也控制台日志中没有任何内容）。只有当我关闭选项卡或浏览器时，数据才会立即发送到 libwebsocket 服务器。

我已经在 Chrome 19 和 Firefox 12 中进行了测试，同样的症状也适用。

有趣的是我有一台安装了 Window XP home 和 Chrome 19 的 vmware 客户机（与主机版本相同，我的主机运行 Windows 7）。当我在那台客户机上尝试 HTMl5 Websocket 时，一切都很好@_@

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T12:41:26.480

在过去 6 个月左右的时间里，我一直在遇到这个问题，它随机开始的一天，影响了我本地 Windows 机器上的所有标准浏览器。

9/10 次 WebSocket 连接数据只流向一个方向，我尝试安装了许多浏览器，它们都做同样的事情。我唯一的解决方案是使用在 linux 虚拟机中运行的任何浏览器。

有趣的是，现在嵌入到 Source 游戏引擎中的最新 Webkit 浏览器已经更新，它可以与游戏中的 WebSockets 完美配合（即使同一台机器上使用的 Webkit Chrome 没有）

我唯一的结论是，这是一些非常奇怪的 Windows 错误，唯一的解决方案是格式化！

# asp.net - 当 CultureInfo='zh-CN(S)' 时，在 ASP.NET 应用程序中一般使用的 SQL Server 数据库排序规则？

> ID：10742250
> 
> 赞同：0
> 
> 时间：2012-05-24T17:16:36.447
> 
> 标签：asp.net, sql-server, localization

假设我选择 'zh-CN' in

```
Thread.CurrentThread.CurrentCulture = new CultureInfo("zh-CN");
Thread.CurrentThread.CurrentUICulture = new CultureInfo("zh-CN"); 
```

针对中华人民共和国使用的中文，我应该将哪种 SQL 服务器排序规则用于一般用途的数据库？

选择是如此广泛：

![在此处输入图像描述](../Images/bfe8e634e1fcd15f0bb107884eaf55f5.png)

# jqgrid - jqGrid：即使提供数据，addRowData 也会添加一个空行

> ID：10742256
> 
> 赞同：0
> 
> 时间：2012-05-24T17:16:48.853
> 
> 标签：jqgrid

我有 2 个 jqGrid，当我单击第一个 jqGrid 中的一行时，我需要将该行添加到第二个 jqGrid 并将其从第一个网格中删除，但是当我单击该行时，将一个空行添加到第二个网格虽然我在萤火虫中看到了数据。我在第一个网格的 onSelectRow 中有以下代码：

```
var sourceGrid = jQuery('#admin-chooser-source-'+randomId);;
var destGrid = jQuery('#admin-chooser-dest-'+randomId);
var data = sourceGrid.getRowData(id);
console.log('data is ',data);
var success = destGrid.addRowData('admin-chooser-dest-row-'+id, data, 'last');
console.log('success ',success);
sourceGrid.delRowData(id); 
```

控制台打印：数据是
对象> allAvailPrinters：“实验室”

成功真

# asp.net-mvc-3 - 在 MVC3 中使用自定义 IPrincipal 和 IIdentity

> ID：10742259
> 
> 赞同：21
> 
> 时间：2012-05-24T17:17:25.380
> 
> 标签：asp.net-mvc-3, forms-authentication, iprincipal, iidentity, custom-authentication

我创建了自己的`IPrincipal`实现`IIdentity`，如下所示：

```
[ComVisible(true)]
[Serializable]
public sealed class CustomIdentity : IIdentity {

    private readonly string _name;
    private readonly string _email;
    // and other stuffs

    public CustomIdentity(string name) {
        _name = name.Trim();
        if(string.IsNullOrWhiteSpace(name))
            return;
        _email = (connect to database and read email and other stuffs);
    }

    public string Name {
        get { return _name; }
    }

    public string Email {
        get { return _email; }
    }

    public string AuthenticationType {
        get { return "CustomIdentity"; }
    }

    public bool IsAuthenticated {
        get { return !string.IsNullOrWhiteSpace(_name); }
    }

}

[ComVisible(true)]
[Serializable]
public sealed class CustomPrincipal : IPrincipal {

    private readonly CustomIdentity _identity;

    public CustomPrincipal(CustomIdentity identity) {
        _identity = identity;
    }

    public bool IsInRole(string role) {
        return _identity != null && 
               _identity.IsAuthenticated &&
               !string.IsNullOrWhiteSpace(role) &&
               Roles.IsUserInRole(_identity.Name, role);
    }

    IIdentity IPrincipal.Identity {
        get { return _identity; }
    }

    public CustomIdentity Identity {
        get { return _identity; }
    }

} 
```

另外，我创建了一个`HttpModule`并且在它的`AuthenticateRequest`事件中，我这样做：

```
 public void Init(HttpApplication context) {
        _application = context;
        _application.AuthenticateRequest += ApplicationAuthenticateRequest;
    }

    private void ApplicationAuthenticateRequest(object sender, EventArgs e) {
        var formsCookie = _application.Request.Cookies[FormsAuthentication.FormsCookieName];
        var identity = formsCookie != null
             ? new CustomIdentity(FormsAuthentication.Decrypt(formsCookie.Value).Name)
             : new CustomIdentity(string.Empty);
        var principal = new CustomPrincipal(identity);
        _application.Context.User = Thread.CurrentPrincipal = principal;
    } 
```

另外，我创建了自己的`Controller`并`WebViewPage`喜欢这些：

```
public abstract class CustomController : Controller {
    public new CustomPrincipal User {
        get {
            var user = System.Web.HttpContext.Current.User as CustomPrincipal;
            return user;
        }
    }
}

public abstract class CustomWebViewPage<TModel> : WebViewPage<TModel> {
    public new CustomPrincipal User {
        get {
            // (Place number 1) here is the error I'm speaking about!!!
            var user = HttpContext.Current.User as CustomPrincipal;
            return user;
        }
    }
} 
```

如上面的代码所示，似乎一切都是正确的；但正如您所见，在**1 号位置**我无法访问`CustomPrincipal`！意味着在这个地方，我有 a`RolePrincipal`而不是`CustomPrincipal`. eg`HttpContext.Current.User`是 a`RolePrincipal`而不是`CustomPrincipal`. 但`RolePrincipal.Identity`属性是`CustomIdentity`！

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-05-24T18:45:35.143

你的错误在这里：

```
_application.AuthenticateRequest += ApplicationAuthenticateRequest; 
```

有一个`HttpModule`命名`RoleManagerModule`的方法调用 in`HttpApplication.PostAuthenticateRequest`并将其设置`HttpContext.Current.User`为`RolePrincipal`。因此，您正在设置`User`in`AuthenticateRequest`和`RoleManagerModule`set in `PostAuthenticateRequest`，这意味着在您的设置之后，因此会覆盖您的设置。改变你的`Module.Init`：

```
public void Init(HttpApplication context) {
    _application = context;
    // change just this line:
    _application.PostAuthenticateRequest += ApplicationAuthenticateRequest;
} 
```

**重要更新：**

如果这个问题不起作用，请参阅[这个问题- 由初学者再次提出，取决于当前问题 - 以获得第二个解决方案。](https://stackoverflow.com/questions/11001061/roleprovider-dosnt-work-with-custom-iidentity-and-iprincipal-on-server)

# git - 不知何故，我在 gitosis 中有一个非裸存储库？

> ID：10742268
> 
> 赞同：2
> 
> 时间：2012-05-24T17:17:57.343
> 
> 标签：git, gitosis

我正在尝试推送到由服务器上的 gitosis 管理的 git 存储库。当我推动时，我收到此错误：

```
william@utapau:~/lyre$ git push
Enter passphrase for key '/home/william/.ssh/id_dsa': 
Counting objects: 9, done.
Compressing objects: 100% (5/5), done.
Writing objects: 100% (5/5), 705 bytes, done.
Total 5 (delta 4), reused 0 (delta 0)
remote: error: refusing to update checked out branch: refs/heads/master
remote: error: By default, updating the current branch in a non-bare repository
remote: error: is denied, because it will make the index and work tree inconsistent
remote: error: with what you pushed, and will require 'git reset --hard' to match
remote: error: the work tree to HEAD.
remote: error: 
remote: error: You can set 'receive.denyCurrentBranch' configuration variable to
remote: error: 'ignore' or 'warn' in the remote repository to allow pushing into
remote: error: its current branch; however, this is not recommended unless you
remote: error: arranged to update its work tree to match what you pushed in some
remote: error: other way.
remote: error: 
remote: error: To squelch this message and still keep the default behaviour, set
remote: error: 'receive.denyCurrentBranch' configuration variable to 'refuse'.
To r:lyre
 ! [remote rejected] master -> master (branch is currently checked out)
error: failed to push some refs to 'r:lyre' 
```

我发现了这个问题：

[Git推送错误'[远程拒绝]主->主（当前已签出分支）'](https://stackoverflow.com/q/2816369/403554)

并在那里尝试了答案，但没有运气。远程存储库没有`.git`文件夹，因为它是用 gitosis 设置的。那里不应该有工作树或签出分支。

存储库文件夹结构如下所示：

```
william@sirius:/home/git/repositories/lyre.git$ ls -hal
total 40K
drwxr-xr-x   7 git users 4.0K May 24 12:58 .
drwxr-xr-x   5 git users 4.0K May  4  2011 ..
drwxr-xr-x   2 git users 4.0K May  4  2011 branches
-rw-rw-r--   1 git users   66 May 24 12:58 config
-rw-r--r--   1 git users   73 May  4  2011 description
-rw-r--r--   1 git users   23 May  4  2011 HEAD
drwxr-xr-x   2 git users 4.0K May  4  2011 hooks
drwxr-xr-x   2 git users 4.0K May  4  2011 info
drwxr-xr-x 163 git users 4.0K Apr 26 15:26 objects
drwxr-xr-x   4 git users 4.0K May  4  2011 refs

william@sirius:/home/git/repositories/lyre.git$ cd branches/
william@sirius:/home/git/repositories/lyre.git/branches$ ls -hal
total 8.0K
drwxr-xr-x 2 git users 4.0K May  4  2011 .
drwxr-xr-x 7 git users 4.0K May 24 12:58 .. 
```

我怎样才能摆脱这种混乱并推送到存储库？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T14:44:10.433

PEBCAK。原来我没有克隆我认为我克隆的存储库。我试图推送到非裸存储库。

在远程服务器上，gitosis 存储库位于`/home/git/repositories/lyre.git/`，我也有一个克隆位于`/home/william/lyre/`.

在我的本地工作站上，我`~/.ssh/config`这样设置：

```
host r
  user william 
```

当我克隆存储库时，我使用它`git clone r:lyre`并无意中克隆了克隆而不是 gitosis 存储库。当我尝试推送时，我确实在推送到一个非裸仓库。

我改成`~/.ssh/config`这样：

```
host r
  user git 
```

我所有的问题都消失了。这都是一个错误的身份案例。

# jquery - Jquery resizable plugin，通过拖动对象的边缘来调整对象的大小

> ID：10742269
> 
> 赞同：2
> 
> 时间：2012-05-24T17:17:57.987
> 
> 标签：jquery, jquery-ui, jquery-plugins, jquery-ui-resizable

我喜欢 JQuery ui 的可调整大小的插件：http: [//jqueryui.com/demos/resizable/](http://jqueryui.com/demos/resizable/)

我想在我的脚本中实现它，但要做到这一点，我需要插件通过拖动它的四个角中的任何一个来重新调整元素的大小，而不仅仅是我在演示中看到的顶部和左侧。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T17:20:11.427

阅读文档（您喜欢的）有助于：

$( ".selector" ).resizable({ 句柄: "all" });

# php - PHP 使用 simplexml_load_string() 解析 XML 响应

> ID：10742273
> 
> 赞同：0
> 
> 时间：2012-05-24T17:18:12.263
> 
> 标签：php, simplexml

由于某种原因，我遇到了解析错误。我把它缩小到“什么”，而不是“为什么”。

这是我的测试脚本：

```
<?php
$xml_string = '<?xml version="1.0" encoding="utf-8"?>
    <soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
    <soap:Body>
        <AccountsGetXMLResponse xmlns="https://test.testsite.com/v3.0/">
            <AccountsGetXMLResult>
            <AccountsWSDS xmlns="">
                <CUSACCOUNTS><ACCOUNT_ID>6036335098370413</ACCOUNT_ID><ACTIVE_FLAG>N</ACTIVE_FLAG><IN_USE>Y</IN_USE><ACCOUNT_BALANCE>0</ACCOUNT_BALANCE></CUSACCOUNTS>
                <CUSACCOUNTS><ACCOUNT_ID>6036335098370414</ACCOUNT_ID><ACTIVE_FLAG>N</ACTIVE_FLAG><IN_USE>Y</IN_USE><ACCOUNT_BALANCE>0</ACCOUNT_BALANCE></CUSACCOUNTS>
                <META_INFO><INFO_CLASS>TableInfo</INFO_CLASS><INFO_TYPE>Accounts</INFO_TYPE><INFO_CODE>PageSize</INFO_CODE><VALUE>10</VALUE></META_INFO>
                <META_INFO><INFO_CLASS>TableInfo</INFO_CLASS><INFO_TYPE>Accounts</INFO_TYPE><INFO_CODE>PageNumber</INFO_CODE><VALUE>1</VALUE></META_INFO>
                <META_INFO><INFO_CLASS>TableInfo</INFO_CLASS><INFO_TYPE>Accounts</INFO_TYPE><INFO_CODE>RowCount</INFO_CODE><VALUE>200</VALUE></META_INFO>
                <META_INFO><INFO_CLASS>TableInfo</INFO_CLASS><INFO_TYPE>Accounts</INFO_TYPE><INFO_CODE>PageCount</INFO_CODE><VALUE>20</VALUE></META_INFO>
            </AccountsWSDS>
            </AccountsGetXMLResult>
            <rowCount>200</rowCount>
            <pageCount>20</pageCount>
        </AccountsGetXMLResponse>
    </soap:Body>
</soap:Envelope>'; 

if( ! $xml = simplexml_load_string( $xml_string ) ) 
{ 
    echo "Unable to load XML string"; 
} 
else 
{ 
    echo "XML String loaded successfully"; 
}
?> 
```

使用上面的测试 xml 字符串，我得到“无法.....”条件。但是，当我取出“”时，它起作用了！显然 simplexml_load_string() 有一些细节。但是我收到了这个回复，我不想先做一个查找/替换脚本。

另外，我这样做对吗？最后我需要开始解析 CUSACCOUNTS，提取里面的数据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T18:15:03.080

我以前曾与 SimpleXML 和 soap 争论过，但发现使用[XMLReader 类](http://php.net/manual/en/book.xmlreader.php)要容易得多，而且一旦我检索到数据，我就可以将数据的内容（比如你的 CUSACCOUNTS 的东西）转换为 SimpleXML 对象。

这是我在你的情况下所做的：

```
$xml_string = <<<XML
<?xml version="1.0" encoding="utf-8"?>
<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
    <soap:Body>
        <AccountsGetXMLResponse xmlns="https://test.testsite.com/v3.0/">
            <AccountsGetXMLResult>
            <AccountsWSDS xmlns="">
                <CUSACCOUNTS><ACCOUNT_ID>6036335098370413</ACCOUNT_ID><ACTIVE_FLAG>N</ACTIVE_FLAG><IN_USE>Y</IN_USE><ACCOUNT_BALANCE>0</ACCOUNT_BALANCE></CUSACCOUNTS>
                <CUSACCOUNTS><ACCOUNT_ID>6036335098370414</ACCOUNT_ID><ACTIVE_FLAG>N</ACTIVE_FLAG><IN_USE>Y</IN_USE><ACCOUNT_BALANCE>0</ACCOUNT_BALANCE></CUSACCOUNTS>
                <META_INFO><INFO_CLASS>TableInfo</INFO_CLASS><INFO_TYPE>Accounts</INFO_TYPE><INFO_CODE>PageSize</INFO_CODE><VALUE>10</VALUE></META_INFO>
                <META_INFO><INFO_CLASS>TableInfo</INFO_CLASS><INFO_TYPE>Accounts</INFO_TYPE><INFO_CODE>PageNumber</INFO_CODE><VALUE>1</VALUE></META_INFO>
                <META_INFO><INFO_CLASS>TableInfo</INFO_CLASS><INFO_TYPE>Accounts</INFO_TYPE><INFO_CODE>RowCount</INFO_CODE><VALUE>200</VALUE></META_INFO>
                <META_INFO><INFO_CLASS>TableInfo</INFO_CLASS><INFO_TYPE>Accounts</INFO_TYPE><INFO_CODE>PageCount</INFO_CODE><VALUE>20</VALUE></META_INFO>
            </AccountsWSDS>
            </AccountsGetXMLResult>
            <rowCount>200</rowCount>
            <pageCount>20</pageCount>
        </AccountsGetXMLResponse>
    </soap:Body>
</soap:Envelope>
XML;

$xml = new XmlReader();
$xml->xml($xml_string);
while($xml->read()){
  // if the current item is an open tag AND matches the account response, grab it's xml
  if ($xml->nodeType == XMLReader::ELEMENT && $xml->name == "AccountsGetXMLResponse") {
    // BAM! readOuterXML yanks the xml string out (including the element we matched)
    // so that we can convert it into a simplexml object for easy iterating
    $xml_obj = new SimpleXMLElement($xml->readOuterXML());
    break;
  }
}

// now we can iterate through it hooray!
foreach($xml_obj->AccountsGetXMLResult->AccountsWSDS->CUSACCOUNTS as $cusaccount){
  // I convert to array and print here but you can do w/e you want now
  print_r((array)$cusaccount);
} 
```

我得到了：

```
Array
(
    [ACCOUNT_ID] => 6036335098370413
    [ACTIVE_FLAG] => N
    [IN_USE] => Y
    [ACCOUNT_BALANCE] => 0
)
Array
(
    [ACCOUNT_ID] => 6036335098370414
    [ACTIVE_FLAG] => N
    [IN_USE] => Y
    [ACCOUNT_BALANCE] => 0
) 
```

# c++ - std::get 使用枚举类作为模板参数

> ID：10742275
> 
> 赞同：13
> 
> 时间：2012-05-24T17:18:16.433
> 
> 标签：c++, get, c++11, tuples, enum-class

我使用`std::tuple`并定义了一个类枚举以某种方式“命名”元组的每个字段，忘记了它们的实际索引。

所以不要这样做：

```
std::tuple<A,B> tup;
/* ... */
std::get<0>(tup) = bleh; // was it 0, or 1? 
```

我这样做了：

```
enum class Something {
     MY_INDEX_NAME = 0,
     OTHER_INDEX_NAME
};

std::tuple<A,B> tup;
/* ... */
std::get<Something::MY_INDEX_NAME> = 0; // I don't mind the actual index... 
```

问题是，由于使用 gcc 4.5.2 编译，我现在安装了 4.6.1 版本，我的项目无法编译。此代码段重现了错误：

```
#include <tuple>
#include <iostream>

enum class Bad {
    BAD = 0
};

enum Good {
    GOOD = 0
};

int main() {
    std::tuple<int, int> tup(1, 10);
    std::cout << std::get<0>(tup) << std::endl;
    std::cout << std::get<GOOD>(tup) << std::endl; // It's OK
    std::cout << std::get<Bad::BAD>(tup) << std::endl; // NOT!
} 
```

该错误基本上表明没有与我的调用相匹配的重载`std::get`：

```
test.cpp: In function ‘int main()’:
test.cpp:16:40: error: no matching function for call to ‘get(std::tuple<int, int>&)’
test.cpp:16:40: note: candidates are:
/usr/include/c++/4.6/utility:133:5: note: template<unsigned int _Int, class _Tp1, class _Tp2> typename std::tuple_element<_Int, std::pair<_Tp1, _Tp2> >::type& std::get(std::pair<_Tp1, _Tp2>&)
/usr/include/c++/4.6/utility:138:5: note: template<unsigned int _Int, class _Tp1, class _Tp2> const typename std::tuple_element<_Int, std::pair<_Tp1, _Tp2> >::type& std::get(const std::pair<_Tp1, _Tp2>&)
/usr/include/c++/4.6/tuple:531:5: note: template<unsigned int __i, class ... _Elements> typename std::__add_ref<typename std::tuple_element<__i, std::tuple<_Elements ...> >::type>::type std::get(std::tuple<_Elements ...>&)
/usr/include/c++/4.6/tuple:538:5: note: template<unsigned int __i, class ... _Elements> typename std::__add_c_ref<typename std::tuple_element<__i, std::tuple<_Elements ...> >::type>::type std::get(const std::tuple<_Elements ...>&) 
```

那么，有什么方法可以将我的枚举类用作模板参数`std::get`？这是不是要编译的东西，而是在 gcc 4.6 中修复的？我可以使用一个简单的枚举，但我喜欢枚举类的作用域属性，所以如果可能的话，我更喜欢使用后者。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-24T17:20:46.873

C++11 引入的强类型枚举不能隐式转换为 say 类型的整数值`int`，而`std::get`希望模板参数是整数类型。

您必须用来`static_cast`转换枚举值：

```
std::cout <<std::get<static_cast<int>(Bad::BAD)>(tup)<< std::endl; //Ok now! 
```

或者您可以选择转换为基础整数类型：

```
//note that it is constexpr function
template <typename T>
constexpr typename std::underlying_type<T>::type integral(T value) 
{
    return static_cast<typename std::underlying_type<T>::type>(value);
} 
```

然后将其用作：

```
std::cout <<std::get<integral(Bad::BAD)>(tup)<< std::endl; //Ok now! 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-12T15:10:00.330

我想添加另一个答案，因为原始海报要求一种通过类枚举对 std::tuple 元素进行命名访问的方法。

可以有一个类枚举类型的模板参数（至少在 GCC 中）。这使得定义您自己的`get`检索给定类枚举值的元组的元素成为可能。下面是一个将此值转换为 int 的实现，但您也可以做一些更花哨的事情：

```
#include <tuple>

enum class names { A = 0, B, C };

template< names n, class... Types >
typename std::tuple_element<static_cast< std::size_t >( n ), std::tuple<Types...> >::type&
    get( std::tuple<Types...>& t )
{
    return std::get< static_cast< std::size_t >( n ), Types... >( t );
}

int main( int, char** )
{
    std::tuple< char, char, char > t( 'a', 'b', 'c' );
    char c = get<names::A>( t );
} 
```

请注意，[`std::get`](http://en.cppreference.com/w/cpp/utility/tuple/get)还有两个变体（一个 for `const tuple&`，一个 for `tuple&&`），可以完全相同的方式实现。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-24T17:19:24.793

是的，这是 GCC 4.5 中的一个错误。作用域枚举没有到整数类型的隐式转换。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-24T22:41:56.727

一个完全不同的解决方案是：

```
A& my_field(std::tuple<A,B>& t) { return std::get<0>(t); }
A const& my_field(std::tuple<A,B> const& t) { return std::get<0>(t); }

B& my_other_field(std::tuple<A,B>& t) { return std::get<1>(t); }
B const& my_other_field(std::tuple<A,B> const& t) { return std::get<1>(t); }

my_field(t) = blah;
my_other_field(t) = frob; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-05-31T16:28:30.883

2018年更新：

这不再是问题了。当我尝试“枚举类 int”的变体时，我确实遇到了问题，但这现在适用于 VS 2017 15.7.2

```
enum 
{
  WIDTH,
  HEIGHT
};
std::get<HEIGHT>( Remaining ) = std::get<HEIGHT>( Remaining ) - MinHeight; 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2016-10-02T09:45:12.677

我的解决方案是使用：

```
namespace Something{enum class Something {MY_INDEX_NAME = 0,OTHER_INDEX_NAME};}; 
```

# asp.net-mvc - web.config 调试/发布不起作用

> ID：10742277
> 
> 赞同：0
> 
> 时间：2012-05-24T17:18:21.873
> 
> 标签：asp.net-mvc, debugging, web-config, release

在我的 web.config

```
<connectionStrings>

    <add name="Context" connectionString="Server=tcp:database.windows.net,1433;Database=DbDev;User ID=xxxx;Password=xxxx.;Trusted_Connection=False;Encrypt=True;MultipleActiveResultSets=True"
    providerName="System.Data.SqlClient" />
<connectionStrings/> 
```

我的 web.Debug.config

```
<configuration xmlns:xdt="http://schemas.microsoft.com/XML-Document-Transform">

    <connectionStrings>

      <add name="Context" connectionString="Server=tcp:database.windows.net;Database=DbDev;
      User ID=xxxx;Password=xxxx.;
      Trusted_Connection=False;Encrypt=True;MultipleActiveResultSets=True"
    providerName="System.Data.SqlClient" xdt:Transform="Replace" xdt:Locator="Match(name)"/>
    </connectionStrings>

  <system.web>

      <customErrors mode="Off" xdt:Transform="Replace">

      </customErrors>

    </system.web>
</configuration> 
```

在我的 web.Release.config

```
<configuration xmlns:xdt="http://schemas.microsoft.com/XML-Document-Transform">

    <connectionStrings>

      <add name="Context" connectionString="Server=tcp:database.windows.net;
           Database=DbProd;User ID=xxxx;Password=xxxx.;
           Trusted_Connection=False;Encrypt=True;MultipleActiveResultSets=True"
            providerName="System.Data.SqlClient" 
            xdt:Transform="Replace" xdt:Locator="Match(name)" />
    </connectionStrings>

    <system.web>
    <compilation xdt:Transform="RemoveAttributes(debug)" />

      <customErrors defaultRedirect="GenericError.htm" mode="On" xdt:Transform="Replace">
        <error statusCode="500" redirect="InternalError.htm"/>
      </customErrors>

    </system.web>
</configuration> 
```

它只是没有获得生产数据库 DbProd

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T13:24:24.047

我认为在 VS 中运行“发布”模式时，它会转换 web.release.config 文件，但由于某些原因（缓存？bin？）它不会使用它。但是，当我在 Azure 环境中发布它时，那么它将正确获取配置

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T17:22:29.353

`xdt:Locator="Match(name)"``name`表示如果属性值匹配，将应用转换后的值。

在 web.config 你有

```
<add name="Context" 
```

但是在 web.release.config

```
<add name="PoqContext" 
```

将连接字符串名称更改为相同的值应该会对您有所帮助。此外，请查看[Web.config Transformation Syntax](http://msdn.microsoft.com/en-us/library/dd465326.aspx)以了解其他可用选项

# macos - 自定义 zsh shell

> ID：10742278
> 
> 赞同：0
> 
> 时间：2012-05-24T17:18:26.413
> 
> 标签：macos, terminal, zsh

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T18:17:30.490

**To add `~/bin` to your path:**

1.  First, we make the folder (if it isn't already made).

    ```
    mkdir ~/bin 
    ```

2.  Copy `batcharge.py` into `~/bin`:

    ```
    cp batcharge.py ~/bin/batcharge.py 
    ```

    (Obviously you'll want to do this from where-ever the `batcharge.py` script is located).

3.  Check if `~/bin` is in your path:

    ```
    echo $PATH | grep ~/bin 
    ```

    This should come back with a line. If it does *not*, we shall add it:

    1.  Open `~/.zshrc`.

    2.  At the end, add the line:

        ```
        export PATH=$PATH:~/bin 
        ```

        This will add `~/bin` to your `$PATH`.

    3.  Close the terminal window, and re-open it. (Or open a new one).

    4.  Type `echo $PATH | grep ~/bin`. This should now show a line (and you should see `~/bin` at the end of the long-ish list of paths).

4.  Now, we test: you should be able to type `which batcharge.py` and see that `zsh` knows where to find it. For example, type `which batcharge.py` in terminal, and you should see something like:

    ```
    /Users/simont/bin/batcharge.py 
    ```

    Now we can type `batcharge.py` and see the script run :)

# php - 使用 PHP cPanel 配置远程 MySQL 访问

> ID：10742279
> 
> 赞同：1
> 
> 时间：2012-05-24T17:18:27.030
> 
> 标签：php, mysql, cpanel, remote-access, remote-server

这真的是一件简单的事情。但我无法解决它，所以我希望有人能尽快给我答案。

我有两个单独的服务器。MySQL 数据库托管在服务器 #1 上，该服务器上的 PHP 文件通过查询运行网站。现在我想通过远程访问同一个数据库并运行数据库查询，在网站#2 上拥有相同的内容。

我已授予对服务器 #1 上数据库的远程 IP 访问权限。我已将相同的 PHP 文件（在服务器 #1 上进行查询）复制到服务器 #2，并将“localhost”更改为该服务器的 IP 地址。用户名和密码保持不变。

当我运行该 PHP 文件时，我收到一条消息“未找到数据库”。

这是访问服务器 #1 上的数据库的 PHP 代码，该服务器与数据库所在的服务器相同：

```
$user_name = "database_xxx";
$password = "xxx";
$database = "database_name";
$server = "localhost"; 
```

这是第二种情况，服务器#2 上的 PHP 文件应该访问同一个数据库：

```
$user_name = "database_xxx";
$password = "xxx";
$database = "database_name";
$server = "xx.xxx.xxx.xxx"; //IP address of server #1 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T17:30:36.847

您说您已经检查了防火墙并确保远程主机正在使用数据库连接到计算机，因此这些都已退出。之后最容易检查的是权限。请记住，权限授予给`user@host`& 您可能只授予访问权限`user@localhost`. 在那之后，是时候[看看你的数据库配置了。](http://dev.mysql.com/doc/refman/5.5/en/can-not-connect-to-server.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T18:48:49.370

如果您使用 Cpanel，您真正应该做的是转到数据库下的远程 MySql...在它要求允许连接的输入字段中。只需输入服务器#2 的域名，输入您在问题中提供的相同配置，但这次，不是将服务器#1 的 IP 地址放在服务器#2 Php 连接代码中，而是输入服务器#1 的域名。例如

```
$user_name = "database_xxx";
$password = "xxx";
$database = "database_name";
$server = "server#1.com"; //Domain name address of server #1 
```

# sql - 将多个参数传递给 sql 游标输出

> ID：10742289
> 
> 赞同：0
> 
> 时间：2012-05-24T17:19:07.517
> 
> 标签：sql, sql-server, sql-server-2008

这是我的 SQL 游标的片段，可以正常工作。但我现在想将多个参数传递给`@sql`.

请参阅第二个代码片段中的注释。我用谷歌搜索，但我似乎无法找到这个问题的答案。

```
set @sql = N' use TESTDOMAINDATABASE' + convert(nvarchar, @domainID) + @NewLineChar  +
           N' select @subDomain = (select subDomain from tblDomains (nolock))'

execute sp_executesql @sql, N'@subDomain nvarchar(500) output', @subDomain output

print 'subDomain is ' + @subDomain + ' and the domainID is ' + convert(nvarchar,@domainID) 
```

但是，假设我想要`tblDomains`（比如说`domainName`）的另一列。

我将如何更新上述声明？

```
set @sql = N' use TESTDOMAINDATABASE' + convert(nvarchar, @domainID) + @NewLineChar  +
           N' select @subDomain = (select subDomain from tblDomains (nolock))' + @NewLineChar  + 
           N'select @domainName = (select domainName from tblDomains(nolock))'

execute sp_executesql @sql, N'@subDomain nvarchar(500) output', @subDomain output /* How do I pass multiple paramaters here ? */
execute sp_executesql @sql, N'@domainName nvarchar(500) output', @domainName output /*Adding a 2nd line does not do the trick - results in an error that I must declare the scalar variable @domainName */

print 'subDomain is ' + @subDomain + ' and the domainID is ' + convert(nvarchar,@domainID) + ' +  and the domain name is ' @domainName' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T17:23:57.600

你的意思是这样吗？每个数据库的 tblDomains 表中是否只有一行？

```
set @sql = N' use TESTDOMAINDATABASE' + convert(nvarchar, @domainID) + @NewLineChar  +
           N' select @subDomain = subDomain, @domainName = domainName 
              from tblDomains (nolock);'

execute sp_executesql @sql, 
    N'@subDomain nvarchar(500) output, @domainName nvarchar(500) output', 
    @subDomain output, @domainName output;

print 'subDomain is ' + @subDomain + ' and the domainID is ' + convert(nvarchar,@domainID) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T17:23:47.050

您可以将多个逗号分隔的参数传递到 sp_executesql。

```
DECLARE @sql nvarchar(MAX)
DECLARE @x nvarchar(25)
DECLARE @y nvarchar(25)

SET @sql = N'SELECT @x = ''hello'', @y = ''world'''

execute sp_executesql @sql, N'@x nvarchar(25) output, @y nvarchar(25) output'
       ,@x output
       ,@y output

PRINT @x + ' ' + @y 
```

# javascript - Javascript 文件输入在 IE 中不起作用

> ID：10742291
> 
> 赞同：1
> 
> 时间：2012-05-24T17:19:15.187
> 
> 标签：javascript, jquery, internet-explorer

我无法在 IE 中使用以下代码。它在 Firefox 和 Chrome 上运行良好。

任何人都可以帮忙，如何使这个功能在 IE 上工作？

```
 function readURL(input) {
   if (input.files && input.files[0]) {
     var reader = new FileReader();

     reader.onload = function (e) {
        $('#img_prev')
                .attr('src', e.target.result)
                .width(160)
                .height(152);
    };

    reader.readAsDataURL(input.files[0]);
  }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T17:21:45.863

我过去也遇到过类似的问题。`FileReader`IE 尚不支持：

[http://html5demos.com/](http://html5demos.com/)

如果需要 IE 支持来包含常规文件上传，您可能需要重新设计您的解决方案。

# python - Python 时间转换 h:m:s 到秒

> ID：10742296
> 
> 赞同：8
> 
> 时间：2012-05-24T17:19:31.380
> 
> 标签：python, datetime, formatting

我知道使用 timedelta 函数，您可以使用以下方法将秒转换为 h:m:s：

```
>> import datetime
>> str(datetime.timedelta(seconds=666)) 
'0:11:06' 
```

但我需要将 h:m:s 转换为秒或分钟。

你知道可以做到这一点的功能吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-24T17:28:43.280

```
>>> import time, datetime
>>> a = time.strptime("00:11:06", "%H:%M:%S")
>>> datetime.timedelta(hours=a.tm_hour, minutes=a.tm_min, seconds=a.tm_sec).seconds
666 
```

如果您真的打算拆分“：”，这里有一个厚颜无耻的衬线。

```
>>> s = "00:11:06"
>>> sum(int(i) * 60**index for index, i in enumerate(s.split(":")[::-1]))
666 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-05-24T17:34:03.867

```
def hms_to_seconds(t):
    h, m, s = [int(i) for i in t.split(':')]
    return 3600*h + 60*m + s 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-24T17:28:36.630

不幸的是，它并不像`datetime`使用`datetime.strptime`. 这个问题之前在 Stack Overflow 上被问过：[如何从一个简单的字符串构造一个 timedelta 对象](https://stackoverflow.com/questions/4628122/how-to-construct-a-timedelta-object-from-a-simple-string)，其中解决方案涉及使用[python-dateutil](http://niemeyer.net/python-dateutil)。

或者，如果您不想添加另一个模块，可以使用以下类`timedelta`从字符串中解析 a：http: [//kbyanc.blogspot.ca/2007/08/python-reconstructing-timedeltas-from .html](http://kbyanc.blogspot.ca/2007/08/python-reconstructing-timedeltas-from.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-24T17:38:20.443

```
>>> def tt(a):
...     b = a.split(':')
...     return int(b[0]) * 3600 + int(b[1]) * 60 + int(b[2])
... 
>>> print tt('0:11:06') 
```

666

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-24T17:28:55.970

这适用于 2.6.4：

```
hours, minutes, seconds = [int(_) for _ in thestring.split(':')] 
```

如果你想把它变回时间增量：

```
thetimedelta = datetime.timedelta(hours=hours, minutes=minutes, seconds=seconds) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-24T17:35:32.077

我什至不确定我是否会为此烦恼 timedelta

```
>>> pseconds = lambda hms:sum(map(lambda a,b: int(a)*b,hms.split(':'),(3600,60,1)))
>>> pseconds('0:11:06')
666 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-01-01T14:16:44.967

你不需要导入任何东西！

```
def time(s):
  m = s // 60
  h = (m // 60) % 60
  m %= 60
  s %= 60
  return h,m,s 
```

# php - Imagick 蒙太奇与 PHP

> ID：10742297
> 
> 赞同：2
> 
> 时间：2012-05-24T17:19:32.030
> 
> 标签：php, imagemagick, montage

我想要这个功能，但我一生都无法弄清楚如何处理这里描述的功能：http: [//php.net/manual/en/imagick.montageimage.php](http://php.net/manual/en/imagick.montageimage.php)。到目前为止，谷歌搜索一直没有成效。

我已经阅读了这个[http://www.imagemagick.org/Usage/montage/](http://www.imagemagick.org/Usage/montage/)并且在命令行中看起来很容易，但是如何指定要在 PHP 中操作的 URL？

我也看到了这个，但这只会让我更加困惑，因为这样做的人说这对他不起作用。[Imagick PHP 扩展——蒙太奇帮助？](https://stackoverflow.com/questions/2830427/imagick-php-extension-montage-help)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T18:22:55.047

我不知道如何使用 Imagick 但使用命令行和 php 会是这样的：

```
exec("montage balloon.gif medical.gif present.gif shading.gif montage.jpg"); 
```

您可以使用变量：

```
exec("montage $image1 $image2 $image3 $image4 $output"); 
```

你可以创建一个循环并连接吗？将所有图像放入一个变量中，以便该变量为：

```
$images = "$image1 $image2 $image3 $image4";

exec("montage $images $output"); 
```

您可能会看到带有 exec() 的 Imagemagick 比 Imagick 简单得多。

我不确定您是否可以使用图像数组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-02T14:05:47.510

我同意 - php 方法`montageImage()`非常混乱。我发现了另一种使用方法`appendImages()`。

这就是我水平平铺从pdf生成的png的方式：

```
$im = new Imagick();
$im->readimageblob($blob);
$im->setiteratorindex(0); // start at first page (blob-specific)
$im->setImageFormat('png'); // jpg-artifacts - not thanks
$montage = $im->appendImages(false); // true will tile vertically 
```

[imagick::appendimages() - php.net](http://www.php.net/manual/en/imagick.appendimages.php)

# perl - 规范化 ASCII 字符

> ID：10742299
> 
> 赞同：6
> 
> 时间：2012-05-24T17:19:39.307
> 
> 标签：perl, ascii, normalization

我需要对诸如“quee”之类的字符串进行规范化，但我似乎无法将扩展的 ASCII 字符（例如 é、á、í 等）转换为罗马/英语版本。我尝试了几种不同的方法，但到目前为止没有任何效果。关于这个一般主题有相当多的材料，但我似乎找不到这个问题的有效答案。

这是我的代码：

```
#transliteration solution (works great with standard chars but doesn't find the 
#special ones) - I've tried looking for both \x{130} and é with the same result.
$mystring =~ tr/\\x{130}/e/;

#converting into array, then iterating through and replacing the specific char
#( same result as the above solution )
my @breakdown = split( "",$mystring );

foreach ( @breakdown ) {
    if ( $_ eq "\x{130}" ) {
        $_ = "e";
        print "\nArray Output: @breakdown\n";
    }
    $lowercase = join( "",@breakdown );
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-24T17:26:58.887

1）这篇[文章](http://ahinea.com/en/tech/accented-translate.html)应该提供一个相当好的（如果复杂的话）方法。

它提供了将所有带重音的Unicode字符转换为基本字符+重音的解决方案；完成后，您可以简单地单独删除重音字符。

* * *

2) 另一个选项是 CPAN：（[`Text::Unaccent::PurePerl`](http://search.cpan.org/perldoc?Text::Unaccent::PurePerl)改进的 Pure Perl 版本`Text::Unaccent`）

* * *

3）此外，[这个SO答案](https://stackoverflow.com/a/1572516/119280)提出`Text::Unidecode`：

> ```
> $ perl -Mutf8 -MText::Unidecode -E 'say unidecode("été")'
>   ete 
> ```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-24T18:00:26.550

您的原始代码不起作用的原因`\x{130}`是不是é。这是 [拉丁文大写字母 I，上面带点（U+0130 或 İ）](http://www.fileformat.info/info/unicode/char/130/index.htm)。您的意思是`\x{E9}`或只是`\xE9`（对于两位数，大括号是可选的），[LATIN SMALL LETTER E WITH ACUTE (U+00E9)](http://www.fileformat.info/info/unicode/char/00e9/index.htm)。

此外，您的`tr`;中有一个额外的反斜杠。它应该看起来像`tr/\xE9/e/`。

通过这些更改，您的代码将可以工作，尽管我仍然建议使用 CPAN 上的模块之一来处理此类事情。我自己更喜欢[Text::Unidecode](http://search.cpan.org/perldoc?Text::Unidecode)，因为它处理的不仅仅是重音字符。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-25T18:56:22.163

在工作和重新工作之后，这就是我现在所拥有的。它正在做我想做的一切，除了我想在输入字符串中间保留空格以区分单词。

```
open FILE, "funnywords.txt";

# Iterate through funnywords.txt
while ( <FILE> ) {
    chomp;

    # Show initial text from file
    print "In: '$_' -> ";

    my $inputString = $_;

    # $inputString is scoped within a for each loop which dissects
    # unicode characters ( example: "é" splits into "e" and "´" )
    # and throws away accent marks. Also replaces all
    # non-alphanumeric characters with spaces and removes
    # extraneous periods and spaces.
    for ( $inputString ) {
        $inputString = NFD( $inputString ); # decompose/dissect
        s/^\s//; s/\s$//;                   # strip begin/end spaces
        s/\pM//g;                           # strip odd pieces
        s/\W+//g;                           # strip non-word chars
    }

    # Convert to lowercase 
    my $outputString = "\L$inputString";

    # Output final result
    print "$outputString\n";
} 
```

不完全确定为什么它将一些正则表达式和评论染成红色......

以下是“funnywords.txt”中的一些行示例：

队列

22.

?éÉíóñúÑ¿¡

[ 。这？]

阿奎，阿利

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-30T23:40:37.880

对于关于摆脱任何剩余符号但保留字母和数字的第二个问题，将您的最后一个正则表达式从 更改`s/\W+//g`为`s/[^a-zA-Z0-9 ]+//g`。由于您已经对输入的其余部分进行了规范化，因此使用该正则表达式将删除任何不是 az、AZ、0-9 或空格的内容。在开头使用 [] 和 ^ 表示您要查找不在括号其余部分中的所有内容。

# flash - 来自 Flash/Flex 应用程序的帖子没有出现在我的主页新闻提要上。

> ID：10742300
> 
> 赞同：0
> 
> 时间：2012-05-24T17:19:39.493
> 
> 标签：flash, facebook-graph-api

我使用示例教程作为应用程序的起点。

[http://www.adobe.com/devnet/facebook/articles/flex_fbgraph_intro.html](http://www.adobe.com/devnet/facebook/articles/flex_fbgraph_intro.html)

该应用程序可以很好地登录到我的 Facebook 帐户，并且能够显示来自我的帐户的最新新闻提要状态更新。我遇到的问题是，当我发帖时，它没有出现在我的主页上。

这是登录的作用： Facebook.login(loginHandler,{scope:"user_birthday,read_stream, publish_stream"});

这是登录处理程序：

```
protected function loginHandler(success:Object,fail:Object):void
{
if(success){
    loggedIn = true;
    currentState="map";
    Facebook.api("/me",getMeHandler);
    Facebook.api("/me/statuses",getStatusHandler);
}
} 
```

这是我要发布的内容：

```
 protected function submitPost():void
   {
     Facebook.api("/me/feed",submitPostHandler,{    message:statusInput.text},"POST"); 
   }

   protected function submitPostHandler(result:Object,fail:Object):void
   {
     statusInput.text="";
    Facebook.api("/me/statuses",getStatusHandler);
   } 
```

这是状态处理程序：

```
 protected function getStatusHandler(result:Object, fail:Object):void
   {
     fbUser.status = result[0].message;
   } 
```

提前致谢！-斯科特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T02:12:10.577

我想到了。我认为只有我的 Facebook 帐户中的帖子会显示在我的“主页”新闻提要中，而不是我从应用程序中发布的任何帖子。如果我使用“查找朋友”左侧的个人资料选择单击我的名字，就像我看到我的所有帖子一样，甚至来自应用程序。

-斯科特

# python - 代码未将“检查”变量传递给函数

> ID：10742301
> 
> 赞同：0
> 
> 时间：2012-05-24T17:19:54.950
> 
> 标签：python, tk

我正在尝试将名为 checks 的变量列表传递给函数 installFunc，由于某种原因它似乎不起作用，这是我（认为是）相关代码：

```
def installFunc(checks):
    subprocess.call("md c:\MGInstall", shell=True)
    subprocess.call (u"net use w: \\it01\files")
    if checks[0] == 1:
        subprocess.call(u"w:\\software\\snagitup.exe")
    if checks[1] == 1:
        subprocess.call(u"w:\\software\\camtasia.exe")
    if checks[2] == 1:
        urllib.urlretrieve(u"LONGURL", u"c:\\MGinstall\\gotomeeting.exe")
        subprocess.call (u"c:\\MGinstall\\gotomeeting.exe")
    if checks[3] == 1:
        sixtyfourcheck()
        if is64bit == True:
            urllib.urlretrieve(u"LONGURL", u"c:\\MGinstall\\tortoiseSVN.exe")
        elif is64bit == False:
            urllib.urlretrieve(u"LONGURL", u"c:\\MGinstall\\tortoiseSVN.exe")
    #urllib.urlretrieve(u"LONGURL", u"c:\\MGinstall\\MGinstall.exe")
    #subprocess.call (u"c:\\MGinstall\\MGinstall.exe")
    #subprocess.call (u"w:\\printers\\installer\\printer.exe")

app = Tk()

w = Label(app, text="IT Automatic Installer")
w.pack()

text = ["Snagit", "Camtasia", "GotoMeeting", "TortoiseSVN"]
variables = []
for name in text:
    variables.append(IntVar())
    Checkbutton(text=name, variable=variables[-1]).pack()

checks = [variable.get() for variable in variables]
b = Button(text="Install", command= lambda : installFunc(checks))
b.pack()

app.mainloop() 
```

现在，我尝试了一些不同的东西——我实际上是由堆栈溢出给出的 Lamba 部分——我在理解它是如何工作的时候遇到了一些麻烦。

但我遇到的最大问题是 - 为什么不将检查传递给 installFunc()？我希望将检查的完整列表（与我放入其中的项目一样多）传递给 installFunc()。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T18:13:28.170

`variable.get()`返回`IntVar`实例**被调用时**的值，即在应用程序启动之前。因此，它将充满零。

```
def installCommand(variables):
    checks = [variable.get() for variable in variables]
    return installFunc(checks)

b = Button(text="Install", command= lambda v=variables: installCommand(v))
b.pack() 
```

此外，您需要将`variables`默认参数作为默认参数传递给 lambda，这样您就不会与全局变量和局部变量发生冲突。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T18:11:14.303

至少，您可以通过几种方式做到这一点。正如 Hugh Bothwell 的评论所提到的，就个人而言，我会将安装程序抽象为一个对象。这具有最大的灵活性以及对状态的简洁遏制。但是，如果您只使用一个函数，则可以使用 functools 来“curry”该函数：动态创建一个嵌入给定参数的新函数。这是您需要做的更改...

```
def installFunc(checks):
    subprocess.call("md c:\MGInstall", shell=True)
    subprocess.call (u"net use w: \\it01\files")
    if checks[0].get( ) == 1:
        subprocess.call(u"w:\\software\\snagitup.exe")
    if checks[1].get( ) == 1:
        subprocess.call(u"w:\\software\\camtasia.exe")
    if checks[2].get( ) == 1:
        urllib.urlretrieve(u"LONGURL", u"c:\\MGinstall\\gotomeeting.exe")
        subprocess.call (u"c:\\MGinstall\\gotomeeting.exe")
    if checks[3].get( ) == 1:
        sixtyfourcheck()
        if is64bit == True:
            urllib.urlretrieve(u"LONGURL", u"c:\\MGinstall\\tortoiseSVN.exe")
        elif is64bit == False:
            urllib.urlretrieve(u"LONGURL", u"c:\\MGinstall\\tortoiseSVN.exe")

import functools

app = Tk()

w = Label(app, text="IT Automatic Installer")
w.pack()

text = ["Snagit", "Camtasia", "GotoMeeting", "TortoiseSVN"]
variables = []
for name in text:
    variables.append(IntVar())
    Checkbutton(text=name, variable=variables[-1]).pack()

checks = [variable.get() for variable in variables]

#-- Here's where we "curry" the installFunc, producing the new doInstall function.
doInstall = functools.partial(installFunc, checks)

b = Button(text="Install", command = doInstall)
b.pack()

app.mainloop() 
```

这里的问题是 variable.get( ) 创建了一个不可变的 int，而你的列表“检查”永远不会改变。你可能真正想要的是……

```
import functools

app = Tk()

w = Label(app, text="IT Automatic Installer")
w.pack()

text = ["Snagit", "Camtasia", "GotoMeeting", "TortoiseSVN"]
variables = []
for name in text:
    variables.append(IntVar())
    Checkbutton(text=name, variable=variables[-1]).pack()

checks = [variable for variable in variables]

#-- Here's where we "curry" the installFunc, producing the new doInstall function.
doInstall = functools.partial(installFunc, checks)

b = Button(text="Install", command = doInstall)
b.pack()

app.mainloop() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T19:07:46.503

根据我之前的评论，重构版本：

```
import urllib
import subprocess
import os
import Tkinter as tk

class ProgramInstaller(object):
    def __init__(self, name, descr, do_install):
        self.name    = name
        self.descr   = descr
        self.do_install = do_install    # can be function or list of strings

    def install(self):
        if callable(self.do_install):
            self.do_install()
        else:
            for s in self.do_install:
                subprocess.call(s)

TEMP_DIR = r"c:\MGInstall"

def makeTempDir(dir=TEMP_DIR):
    # need to expand on this - what if dir already exists, etc
    os.mkdir(dir)

def removeTempDir(dir=TEMP_DIR):
    # need to expand on this - del files in dir before rmdir, etc
    os.rmdir(dir)

def installGoToMeeting():
    makeTempDir()
    url = "http://www.gotomeeting.com/download/something"
    fname = os.path.join(TEMP_DIR, "gotomeeting.exe")
    urllib.urlretrieve(url, fname)
    subprocess.call(fname)
    removeTempDir()

def installTortoiseSVN():
    makeTempDir()
    if is64bit(): url = "http://www.tortoisesvn.net/download/something/64bit"
    else:         url = "http://www.tortoisesvn.net/download/something/32bit"
    fname = os.join(TEMP_DIR, "tortoisesvn.exe")
    urllib.urlretrieve(url, fname)
    subprocess.call(fname)
    removeTempDir()

installers = (
    ProgramInstaller("SnagIt",      "Take screen-shots",           [r"net use w: \\it01\files", r"w:\software\snagitup.exe"]),
    ProgramInstaller("Camtasia",    "Record your desktop",         [r"net use w: \\it01\files", r"w:\software\camtasia.exe"]),
    ProgramInstaller("GoToMeeting", "Web conferencing",            installGoToMeeting),
    ProgramInstaller("TortoiseSVN", "(Sub)Version control client", installTortoiseSVN),
    ProgramInstaller("Printer",     "HP4020 Printer drivers",      [r"net use w: \\it01\files", r"w:\printers\installer\printer.exe"])
)

def doInstall():        # install-button callback
    for inst in installers:
        if inst.cbvar.get():
            inst.install()

def main():
    app = tk.Tk()
    tk.Label(app, text="IT Automatic Installer").pack()

    # need to fiddle with a grid layout to make this look right
    for inst in installers:
        inst.cbvar = tk.IntVar()
        tk.Checkbutton(text=inst.name, variable=inst.cbvar).pack()
        tk.Label(text=inst.descr).pack()

    tk.Button(text="Install", command=doInstall()).pack()
    app.mainloop()

if __name__=="__main__":
    main() 
```

# anchor - 在锚点加载页面，小于 175px

> ID：10742302
> 
> 赞同：1
> 
> 时间：2012-05-24T17:19:58.547
> 
> 标签：anchor

当使用锚点（即 website.com/#midPage）从链接加载页面时，我需要锚点实际加载到页面顶部下方 175 像素处。有没有方便的方法来做到这一点？Javascript 或 JQUERY 对我来说很好，但我不知道使用什么方法。

# c# - C# 代码风格：从“this”切换。“下划线”的前缀

> ID：10742309
> 
> 赞同：4
> 
> 时间：2012-05-24T17:20:27.087
> 
> 标签：c#, this, naming-conventions, stylecop

我一直在用“这个”。前缀大约两年（StyleCop SA1102 规则）。但现在我改变主意，对静态和实例私有字段使用“下划线”前缀，并删除“this”。字首。

这是我从“这个”切换的原因。“下划线”：

1.  **容易中断：**你的团队中没有人会一直使用“这个”。前缀，所以当你看到一个遵循这种风格的项目时，你不会看到“this”。所有实例成员的前缀。
2.  **无用区分：**区分实例字段和静态字段有什么好处？你有什么收获吗？
3.  **噪音：**如果您注意使用“this”。前缀，你会在任何地方看到“this”。例如，我们在一个类中有 77 次“this”关键字，但在更改样式后，我们只有 9 个下划线，我认为代码更具可读性（您可以轻松遵循代码逻辑）。
4.  **Razor**：用“this”似乎很难看。Razor C# 代码中的前缀。例如，您将拥有“@this.Html.Something”而不是“@Html.Something”。我们喜欢一个通用的规则，适用于我们所有的 C# 代码。

你有什么想法？

忽略 StyleCop SA1102 规则（“this.”前缀）并使用“下划线”前缀区分类字段是否合理？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-25T16:25:16.503

你们所有的点也适用于下划线（它需要强制执行，不是那么有用等），如果你将 77 'this' 更改为 9 _ - 你也可以使用 9 'this'，我确定。

知道这是一个实例还是静态字段/属性非常有用，imo，esp。在多线程环境中。

然而，当我看到“这个”时——我确切地知道它的意思；下划线..我可以猜到，但在这一点上，这真的取决于你的一致性。

就个人而言，我经常（并非总是）使用“this”来区分局部变量和类属性，尤其是。如果方法很长。

归根结底，这只是一个建议，如果您和您的团队对下划线感到满意 - 使用它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-03-25T11:34:30.650

我不会说区分静态成员和实例成员是没有用的。这取决于您大部分时间都在处理哪种代码（多线程或仅与线程无关的代码）。“这。” 提供有关所使用成员的即时语义，您个人不需要它的事实在这里并不重要。由几个团队开发的大型企业应用程序极大地受益于像“this”这样的简单可读性改进。

[更多细节](https://burstz.tumblr.com/post/158809293592/stylecop-and-this "详细意见")

# postgresql - 从 pgplsql 中复制

> ID：10742310
> 
> 赞同：0
> 
> 时间：2012-05-24T17:20:27.833
> 
> 标签：postgresql

我尝试在 pgplsql 函数中运行以下语句，但收到错误消息“格式 '%2f' 无效或与参数不兼容”

```
copy raw_import from 'c:\\files\\test.csv' CSV; 
```

如果我直接作为脚本运行，它会按预期工作，所以我已经消除了 test.csv 的内容作为问题。我还尝试将其包装在“执行”语句中并获得相同的结果。

```
execute 'copy raw_import from ''c:\\files\\test.csv'' CSV'; 
```

我是 postgresql 的新手，所以我怀疑这是我所缺少的基本内容 - 任何想法都会受到赞赏。

请求的文件样本 - 前 3 条记录：a、b、c、d e、f、g、h i、j、k、l

表定义：col1 VARCHAR(100)、col2 VARCHAR(100)、col3 VARCHAR(100)、col4 VARCHAR(100)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T18:13:35.113

检查客户端和服务器编码：

```
cpn=> show server_encoding;
 server_encoding 
-----------------
 UTF8
(1 row)

cpn=> show client_encoding;
 client_encoding 
-----------------
 UTF8
(1 row) 
```

如果它们不匹配，则可以解释为什么当您将其作为脚本运行时它可以工作，而在服务器上运行时却不能，也就是说，文件的编码错误。

# mime-types - 支持 DRM 的文件类型的 MIME 类型列表

> ID：10742313
> 
> 赞同：1
> 
> 时间：2012-05-24T17:20:28.833
> 
> 标签：mime-types, drm

我正在编写一个程序来检测给定文件是否需要使用某些 DRM 软件来解密它。有谁知道 DRM 文件格式及其相关的 mime 类型的完整列表（或者实际上任何文件元数据/标题信息都可以让我确定它是否需要 DRM）。

不幸的是，IANA 和以下网站都没有包含有关 DRM 文件格式的信息：

*   [http://www.webmaster-toolkit.com/mime-types.shtml](http://www.webmaster-toolkit.com/mime-types.shtml)
*   [http://www.besthostratings.com/articles/mime-types-htaccess.html](http://www.besthostratings.com/articles/mime-types-htaccess.html)

# php - 不能对重载对象或字符串偏移使用赋值操作运算符

> ID：10742314
> 
> 赞同：5
> 
> 时间：2012-05-24T17:20:36.163
> 
> 标签：php, mysql, overloaded-strings

我有这部分代码，它给了我标题中的错误。

我`$k`为每张桌子从 1 计数到 5。

`$myarray`至少包含 3 到 4 个名称。

错误发生在**`$qu .=`**...

到目前为止我尝试了什么：将变量名更改`$i`为`$v{$i}`行中`$qu .=`。

那么有没有可能迭代查询？所以它`AND`在子句中的 s`WHERE`与数组的计数一样多？

```
while ($k<=5) {
  $queryname = "SELECT Name FROM description";
  $qname = mysql_query($queryname,$link);

  while ($reihe = mysql_fetch_object($qname)) {
    {
      $unse = unserialize($reihe->Name);
      {
        foreach ($unse as $j=>$h)
          foreach ($h as $m) {
            $myarray = preg_split('/ |\s| /',$m);
            {
              echo "<br>";
              $array_empty = $myarray;
              $empty_elements = array("");
              $myarray = array_diff($array_empty,$empty_elements);
              var_dump($myarray);
              for ($i=1; $i<=count($myarray); $i++) {
                $v{$i} = $myarray[$i];
                echo $v{$i};
                $esc{$i} = strtolower(mysql_escape_string($v{$i}));
                echo "<br>" . $esc{$i} . "<br>";
                $qu = "SELECT * FROM `table ID=$k` WHERE";
                $qu{$i} .= "AND `table ID=$k`.`name` LIKE '%$esc{$i}%'";
              }
            }
          }
        {
          $test_a = mysql_query($qu,$link) or die (mysql_error());
          echo "<br>";
          var_dump($test_a);
          for ($x=0; $x<mysql_num_rows($test_a); $x++) {
            $row = mysql_result($test_a,$x,'data1');
            $namee = mysql_result($test_a,$x,'data2');
            echo 'data1' . $row . '<br>';
            echo 'data2' . $namee . '<br>';
          }
        }
      }
    }
  }
  $k++;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-24T18:11:35.230

您似乎误解了一些基本的 PHP 语法。

如[手册中所述](http://www.php.net/manual/en/language.types.string.php#language.types.string.substr)：

> [字符串](http://www.php.net/manual/en/language.types.string.php)s中的字符可以通过使用方[数组](http://www.php.net/manual/en/language.types.array.php)括号指定[字符串](http://www.php.net/manual/en/language.types.string.php)后所需字符的从零开始的偏移量来访问和修改，如. 为此，将[字符串](http://www.php.net/manual/en/language.types.string.php)视为字符[数组。](http://www.php.net/manual/en/language.types.array.php)当您想要提取或替换超过 1 个字符时，可以使用这些功能。*`$str[42]`*[`substr()`](http://www.php.net/manual/en/function.substr.php)[`substr_replace()`](http://www.php.net/manual/en/function.substr-replace.php)
> 
> > **注意：** [字符串](http://www.php.net/manual/en/language.types.string.php)s 也可以使用大括号访问，如 in *`$str{42}`*，用于相同目的。

因此，您在整个代码中使用大括号（定义`for`控制结构范围的除外）是完全错误的，并且不能实现您的意图。

其次，从您的代码看来，您将关系数据存储在序列化的 PHP 对象中；这破坏了使用像 MySQL 这样的 RDBMS 的许多好处。除非您有令人信服的理由不这样做，否则您应该以[规范化](http://en.wikipedia.org/wiki/Database_normalization)的形式存储您的 PHP 对象。例如，不是每条`description`记录都有一个`Name`包含序列化 PHP 对象的字段，其属性是包含内爆名称字符串的数组，只需将每个这样的名称存储在`descriptionNames`引用表中相关记录的新表中`description`：

```
CREATE TABLE descriptionNames (
  descriptionID INT NOT NULL,
  name VARCHAR(50),
  PRIMARY KEY (descriptionId, name),
  FOREIGN KEY (descriptionId) REFERENCES description (descriptionId)
); 
```

您似乎还有五个（示意性地）相同的表，名为`Table ID=1`,`Table ID=2`等？如果是这样，您可能应该*将*您的五个表合并为一个，并使用一列（如果需要）来指示记录来自哪个表；我还建议更改您的表名，以避免使用空格等特殊字符，`=`因为如果您忘记正确引用它们，它们可能只会在以后造成麻烦和混乱。例如：

```
ALTER TABLE `Table ID=1`
  RENAME TO CombiTable,
  ADD COLUMN FromTableID TINYINT NOT NULL;

UPDATE CombiTable SET FromTableID = 1;

INSERT INTO CombiTable
  SELECT *, 2 FROM `Table ID=2` UNION ALL
  SELECT *, 3 FROM `Table ID=3` UNION ALL
  SELECT *, 4 FROM `Table ID=4` UNION ALL
  SELECT *, 5 FROM `Table ID=5`;

SELECT * FROM CombiTable;  -- check everything is okay

DROP TABLE `Table ID=2`, `Table ID=3`, `Table ID=4`, `Table ID=5`; 
```

无论如何，您不应该使用古老的`mysql_*`功能。它们不再被维护并且社区已经开始了[弃用过程](http://news.php.net/php.internals/53799)。相反，您应该了解[准备好的语句](http://en.wikipedia.org/wiki/Prepared_statement)并使用[PDO](http://php.net/pdo)抽象层或改进的[MySQLi](http://php.net/mysqli)扩展。

如果您需要维护现有的数据结构，使用 PDO，您可以执行以下操作：

```
$dbh = new PDO("mysql:dbname=$dbname;charset=utf8", $user, $password);

$qry = $dbh->query("SELECT Name FROM description");
$myarray = array();
while ($reihe = $dbh->fetchColumn())
  foreach (unserialize($reihe) as $h)
    foreach ($h as $m)
      array_merge($myarray, preg_split("/\s+/", $m, -1, PREG_SPLIT_NO_EMPTY));

for ($k = 1; $k <= 5; $k++) {
  $qry = $dbh->prepare("SELECT * FROM `table ID=$k` WHERE " . implode(" OR ",
    array_pad(array(), count($myarray), "name LIKE CONCAT('%', ?, '%')")
  ));

  $qry->execute($myarray);
  while($row = $qry->fetch()) {
    echo "data1:$row[data1]<br/>";
    echo "data2:$row[data2]<br/>";
  }
} 
```

但是，使用我提出的新数据结构，您只需要：

```
$dbh = new PDO("mysql:dbname=$dbname;charset=utf8", $user, $password);

$qry = $dbh->query("
  SELECT   *
  FROM     CombiTable JOIN descriptionNames USING (name)
  WHERE    FromTableID BETWEEN 1 AND 5   -- in case you have others?
  ORDER BY FromTableID
");

while ($row = $qry->fetch()) {
  echo "data1:$row[data1]<br/>";
  echo "data2:$row[data2]<br/>";
} 
```

# python - PyGTK/Glade 保持按钮尺寸标准

> ID：10742317
> 
> 赞同：0
> 
> 时间：2012-05-24T17:20:49.870
> 
> 标签：python, pygtk, glade

我有一个带有菜单和 3x3 网格的简单 pygtk/glade 窗口。网格的每一行包括：两个标签和一个按钮。

当窗口调整大小时，标签保持相同的字体大小，但按钮会调整大小，如果窗口变得非常大，它们可能会变得巨大。

无论窗口是否调整大小，我怎样才能使我的按钮始终保持相同的大小（按钮的“标准”大小，就像刚刚打开界面时一样）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T18:37:00.953

您只需将 Buttons的`fill`和参数设置为 False（在 Glade 界面中取消选中它们）。`expand`

您还希望将每个按钮放在 3x3 的中心`GtkTable`，这样它就会在单元格顶部居中而不对齐

# c++ - C++ 链表：对象的 IndexOf

> ID：10742321
> 
> 赞同：0
> 
> 时间：2012-05-24T17:21:16.137
> 
> 标签：c++, indexing, linked-list, nodes

我试图在我的链表中找到给定对象的索引。我想返回 -1 是我的列表中不存在该对象。以下是我的代码，请指导我。

```
int List::indexOf(const Object& o) const
{
    Node* tempNode = first;
    int count = 0;
    while(tempNode != NULL)
    {
        if (o.compare(tempNode->o) == 0)
        {
            break;
        }
    ++count;
    tempNode = tempNode->next;
    }
    return count;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T17:23:44.267

为什么不从循环内部返回？

```
Node* tempNode = first;
    int count = 0;
    while(tempNode != NULL)
    {
       if (o.compare(tempNode->o) == 0)
       {
           //return the count when you found a match
           return count;
       }
       ++count;
       tempNode = tempNode->next;
    }
    //return -1 if no match is found
    return -1;
} 
```

您还可以存储一个辅助信息，告诉您是否找到了节点，但这种方法更清洁 IMO。

# java - 如何以非递归方式重写 Ackermann 函数？

> ID：10742322
> 
> 赞同：17
> 
> 时间：2012-05-24T17:21:24.847
> 
> 标签：java, non-recursive

我有功能

```
public static int func(int M,int N){
    if(M == 0 || N == 0) return M+N+1;
    return func(M-1, func(M, N-1));
} 
```

如何以非递归风格重写它？也许，它是实现某种算法吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-24T20:07:21.197

不完全是 O(1)，但绝对是非递归的。

```
public static int itFunc(int m, int n){
    Stack<Integer> s = new Stack<Integer>;
    s.add(m);
    while(!s.isEmpty()){
        m=s.pop();
        if(m==0||n==0)
            n+=m+1;
        else{
            s.add(--m);
            s.add(++m);
            n--;
        }
    }
    return n;
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2019-01-24T23:30:50.867

之前发布的所有答案都没有正确实现 Ackermann。

```
def acker_mstack(m, n)
  stack = [m]
  until stack.empty?
    m = stack.pop

    if m.zero?
      n += 1
    elsif n.zero?
      stack << m - 1
      n = 1
    else
      stack << m - 1 << m
      n -= 1
    end
  end
  n
end 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-05-24T17:29:53.783

这看起来像家庭作业，所以我不会给你答案，但我会引导你朝着正确的方向前进：

如果你想分解递归，列出所有的值可能会很有用，让 m = {0...x} n = {0...y}。

例如：

```
m = 0, n = 0 = f(0,0) = M+N+1 = 1
m = 1, n = 0 = f(1,0) = M+N+1 = 2
m = 1, n = 1 = f(1,1) = f(0,f(1,0)) = f(0,2) = 3
m = 2, n = 1 = f(2,1) = f(1,f(2,0)) = f(1,3) = f(0,f(1,2)) = f(0,f(0,f(1,1))
             = f(0,f(0,3))          = f(0,4) = 5 
```

有了这个，你可以想出一个你可以使用的非递归关系（一个非递归函数定义）。

编辑：所以看起来这是[Ackermann function](http://demonstrations.wolfram.com/RecursionInTheAckermannFunction/)，一个**非**原始递归的总可计算函数。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-07-31T10:04:36.893

这是我自己已经检查过的正确版本。

```
public static int Ackermann(int m, int n){
Stack<Integer> s = new Stack<Integer>;
s.add(m);
while(!s.isEmpty()){
    m=s.pop();
    if(m==0) { n+=m+1; }
    else if(n==0)
    {
       n += 1;
       s.add(--m);
    }
    else{
        s.add(--m);
        s.add(++m);
        n--;
    }
}
return n;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-09-19T04:47:06.847

好吧，我来这里是为了找到这个问题的答案。但是即使在查看答案后也无法编写代码。所以，我自己尝试了一下，经过一番努力构建了代码。所以，我会给你一个提示（因为我觉得这里的礼仪是家庭作业问题并不意味着完全回答）。因此，您可以使用单个堆栈来计算函数，而无需使用递归。看看大卫回答中的控制流程。你必须使用它。只需启动一个 while(1) 循环并在其中检查您的参数是否令人满意。让 if-else 块中的所需块执行。然后将 ackerman 函数的两个最新参数压入堆栈。然后在循环结束时弹出它们并让循环重复直到达到结束条件，此时不再生成 ackermann 函数的参数。您必须在 while 循环中放置一个 for 语句才能继续检查它。并最终得到最终结果。我不知道这在多大程度上是可以理解的，但我希望我能有一些想法开始。所以，只是分享了方式。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-09-05T03:18:16.853

用python编写，仅使用1个数组和1个变量，希望对您有所帮助！

```
def acker(m,n):

    right = [m]
    result = n
    i = 0

    while True:
        if len(right) == 0:
            break

        if right[i] > 0 and result > 0:
            right.append(right[i])
            right[i] -= 1
            result -= 1
            i += 1

        elif right[i] > 0 and result == 0:
            right[i] -= 1
            result = 1

        elif right[i] == 0:
            result += 1
            right.pop()
            i -=1

    return result 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-06-29T00:16:47.747

我无法得到@LightyearBuzz 的工作答案，但我从[WikiWikiWeb](https://web.archive.org/web/20160322060819/http://c2.com/cgi/wiki?IteratedAckermannExample)中找到了对我有用的 Java 5 代码：

```
import java.util.HashMap;
import java.util.Stack;

public class Ackerman {
  static class  Pair <T1,T2>{
    T1 x; T2 y;
    Pair(T1 x_,T2 y_) {x=x_; y=y_;}
    public int hashCode() {return x.hashCode() ^ y.hashCode();}
    public boolean equals(Object o_) {Pair o= (Pair) o_; return x.equals(o.x) && y.equals(o.y);}
  }

  /**
   * @param args
   */
  public static int ack_iter(int m, int n) {
    HashMap<Pair<Integer,Integer>,Integer> solved_set= new HashMap<Pair<Integer,Integer>,Integer>(120000);
    Stack<Pair<Integer,Integer>> to_solve= new Stack<Pair<Integer,Integer>>();
    to_solve.push(new Pair<Integer,Integer>(m,n));

    while (!to_solve.isEmpty()) {
      Pair<Integer,Integer> head= to_solve.peek();
      if (head.x.equals(0) ) {
        solved_set.put(head,head.y + 1);
        to_solve.pop();
      }
      else if (head.y.equals(0)) {
        Pair<Integer,Integer> next= new Pair<Integer,Integer> (head.x-1,1);
        Integer result= solved_set.get(next);
        if(result==null){
          to_solve.push(next);
        } 
        else {
          solved_set.put(head, result);
          to_solve.pop();
        }
      }
      else {
        Pair<Integer,Integer> next0= new Pair<Integer,Integer>(head.x, head.y-1);
        Integer result0= solved_set.get(next0);
        if(result0 == null) {
          to_solve.push(next0);
        }
        else {
          Pair<Integer,Integer> next= new Pair<Integer,Integer>(head.x-1,result0);
          Integer result= solved_set.get(next);
          if (result == null) {
            to_solve.push(next);
          }
          else {
            solved_set.put(head,result);
            to_solve.pop();
          }
        }
      }
    }
    System.out.println("hash size: "+solved_set.size());
    System.out.println("consumed heap: "+ (Runtime.getRuntime().totalMemory()/(1024*1024)) + "m");
    return solved_set.get(new Pair<Integer,Integer>(m,n));
  }
} 
```

# ruby-on-rails - 如何在 Ruby on Rails 中正确地将默认条目添加到数据库中？

> ID：10742325
> 
> 赞同：0
> 
> 时间：2012-05-24T17:21:37.723
> 
> 标签：ruby-on-rails, ruby-on-rails-3

大多数情况下，我在seeds.rb 中的条目都很简单，如下所示：

```
User.create!(
name: "Peter"
admin: false;
# etc.
) 
```

如果我收到“无法批量分配受保护的属性”错误，我会在模型中进行一些小的更改，在本例中为 user.rb：

```
attr_accessible: name, admin 
```

到现在为止还挺好。但是我应该如何将条目播种到由 rails gem 生成的表中，从而为我的应用程序添加另一个引擎？[例如，前锋](https://github.com/radar/forem)。我敢肯定还有其他人。

我已将这些条目添加到我的seeds.rb 文件中：

```
Forem::Category.create!(
name: "cat1"
)

Forem::Forum.create!(
title: "forum1",
description: "forum1 description",
category_id: 1
)

Forem::Topic.create!(
forum_id: 1,
user_id: 1,
subject: 'topic1',
locked: false,
pinned: false,
hidden: false,
) 
```

类别和论坛已生成，主题不是：

```
Can't mass-assign protected attributes: forum_id, user_id, locked, pinned, hidden 
```

如果我有一个 topic.rb 模型，我会知道该怎么做。**但我没有**。Forem 是一个[引擎](http://edgeapi.rubyonrails.org/classes/Rails/Engine.html)，我不知道如何使模型 topic.rb 的某些属性可见。

我知道application.rb中的这一行：

```
config.active_record.whitelist_attributes = true 
```

启用防止批量分配的保护。禁用它会留下一个巨大的安全漏洞，所以它不是一个选择。并且禁用它无论如何都不允许我进入主题表。

我也尝试过使用固定装置。我将此添加到我的seeds.rb 文件中：

```
require 'active_record/fixtures'
Fixtures.create_fixtures("#{Rails.root}/test/fixtures", "topics.yml") 
```

测试/topics.yml：

```
one:
  id: 1
  forum_id: 1
  user_id: 1
  subject: "topic1"
  created_at: 2012-05-19 19:54:19
  updated_at: 2012-05-19 19:54:20
  locked: false
  pinned: false
  hidden: false
  last_post_at: 2012-05-19 19:54:21
  state: "open"
  views_count: 3 
```

我得到的错误是 -**未初始化的常量 Fixtures**

我的seeds.rb 和fixture 有什么问题？或者我应该使用迁移？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T17:31:09.440

> 禁用它会留下一个巨大的安全漏洞，所以它不是一个选项`

不，这不是一个巨大的安全漏洞。这是一个有争议的辩论，但是`attr_accessible`（和变体）（在我和许多其他人看来）不是一个很好的解决方案，可以解决阻止用户创建/更新他们不应该创建/更新对象/属性的问题。换句话说，`attr_accessible`是控制器问题的模型解决方案。因为这是控制器的工作，以确保数据被清理和可用，检查当前用户是否被允许做这样的事情，等等。

所以我要做的是删除所有对的引用`attr_accessible`并将其设置`whitelist_attributes`为false。

然后由您在控制器中过滤参数。您可以按照[本要点](https://gist.github.com/1975644)中的操作或使用[rails/strong_parameters](https://github.com/rails/strong_parameters)或任何其他可能让您满意的方式。

之后，您在播种时将不再遇到这些问题

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T17:28:41.087

Seeds.rb 只是 ruby​​ 代码。您不必在一行中创建整个资源。尝试这样的事情

```
topic = Forem::Topic.create(
  :subject => "topic 1",
  :locked => false
  # etc
)

topic.user_id = 1
topic.save 
```

# datagrid - JSF RichFaces reRender 事件变化丰富：dataGrid 结构

> ID：10742326
> 
> 赞同：1
> 
> 时间：2012-05-24T17:21:42.347
> 
> 标签：datagrid, jboss, richfaces, seam, ajax4jsf

我正在寻找有关如何处理重新渲染数据网格的奇怪效果的提示。我有以下网格结构：

```
<rich:dataGrid id="allProductsGrid" value="#{allProducts}" var="_product">                       
     <s:div styleClass="grid-element">
         <s:link view="/product.xhtml">
             <s:div styleClass="product-element">                                                                                                           
                 <h:graphicImage value="/content/images?id=#{_product.image.id}&amp;width=170"/>                                                                                                                                                                                                                                        
             </s:div>                           
             <div id="title">
                 <h:outputText value="#{_product.name}" />
             </div>
             <f:param name="productId" value="#{_product.id}" />
        </s:link>                                                                
     </s:div>
 </rich:dataGrid> 
```

网格在搜索输入字段触发的 onkeyup 事件上重新渲染。到目前为止还没有魔法。现在的问题是重新渲染改变了生成的 html (DOM) 的结构。结果，链接不再起作用。

页面第一次渲染的firebug-html-inspect如下：

```
 <div id="j_id86:allProductsGrid:0:j_id124" class="grid-element">
    <a id=".. " onclick=".." href="/portal/product.vc?productId=22&cid=69">
        <div id="j_id86:allProductsGrid:0:j_id126" class="product-element">
            <img src="/portal/content/images?id=&width=170">
        </div>
        <div id="title">Sample Product</div>
    </a>
</div> 
```

重新渲染网格后，html 输出为：

```
<div id="j_id86:allProductsGrid:0:j_id124" class="grid-element">
    <a id=".." onclick=".." href="/portal/product.vc?productId=22&cid=76"></a>
    <div id="j_id86:allProductsGrid:0:j_id126" class="product-element">
        <img src="/portal/content/images?id=&width=170">
    </div>
    <div id="title">Sample Product</div>
</div> 
```

结果是 a-tag 不再包装 product-element 。谁能给我提示一下这里可能出了什么问题？任何帮助表示赞赏。提前致谢。

乔希

ps：使用Seam 2.2.2 / JSF Mojarra 2.0.3 / RichFaces 3.3.3

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T15:32:04.313

确保您的`allProducts`bean 具有 ViewScope 而不是 RequestScope。因此，在重新渲染中，数据将保留在调用中。

# pdf - 将 4 页合二为一，节省墨水、空间和纸张

> ID：10742329
> 
> 赞同：0
> 
> 时间：2012-05-24T17:21:48.283
> 
> 标签：pdf, batch-file, openoffice.org

计划是将一堆（约 100 个）OpenOffice odp 文档转换为 PDF。这不是什么大不了的事！但是，我需要减少 PDF 页面的数量，例如在将它们导出为 PDF 之前将 4 张纸移到一张。有没有办法像批处理程序那样为我做这件事？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T20:14:11.887

您要执行的操作称为*拼版*，需要在 pdf 结果文件上执行

假设您导出的任何 pdf 页面都是 A4 尺寸**(29.7x21cm)**，

**多价**

*   [https://rg.to/file/c6bd7f31bf8885bcaa69b50ffab7e355/Multivalent20060102.jar.html](https://rg.to/file/c6bd7f31bf8885bcaa69b50ffab7e355/Multivalent20060102.jar.html) （包含工具的最新免费版本，当前本身没有工具）

您可以将 4 页（将其缩小为 A6 页面：**14.8x10cm**）放入 A4

```
java -cp path....to/Multivalent.jar tool.pdf.Impose -dim 2x2 -paper  A4 file.pdf 
```

![在此处输入图像描述](../Images/4659de79311b4e1a2d33463755ad3f87.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T16:06:12.550

除了 Dingo 推荐的 Multivalent，还有[jPdf Tweak](http://jpdftweak.sourceforge.net/)，它有一个不错（但不是很好）的 GUI。您可能想使用“ *Shuffle/N-up* ”功能来获得您想要做的事情。

# magento - Magento solr search - 如何将自定义字段添加到产品搜索索引

> ID：10742332
> 
> 赞同：1
> 
> 时间：2012-05-24T17:21:55.437
> 
> 标签：magento, search, solr

我有企业 magento 1.10，我需要将自定义字段添加到 solr 索引以获得更好的搜索结果。此自定义字段应包含索引产品的类别名称。

我需要知道我需要修改magento的哪一部分。我修改了 Enterprise_Search_Model_Resource_Index::_getCatalogCategoryData 方法，它实际上产生了一些与类别相关的数据，但我的新字段没有出现在发送给 sorl 的消息中。

我错过了什么吗？

我这里也有一些注释，也许有人会帮助[http://docs.nostresscommerce.com:8090/pages/viewpage.action?pageId=2490371](http://docs.nostresscommerce.com:8090/pages/viewpage.action?pageId=2490371)

我重写了 Enterprise_Search_Model_Resource_Index::_getCatalogCategoryData 的输出，我需要 solr 中的 category_name_level_*。

```
 [result] => Array
        (
            [12227] => Array
                (
                    [#categories] => Array
                        (
                            [0] => 2
                            [3] => 3235
                            [7] => 2765
                            [10] => 6672
                        )

                    [#show_in_categories] => Array
                        (
                            [1] => 6671
                            [2] => 6670
                            [4] => 3224
                            [5] => 3199
                            [6] => 3191
                            [8] => 2761
                            [9] => 2760
                        )

                    [#position_category_2] => 1
                    [#position_category_6671] => 120000
                    [#position_category_6670] => 120000
                    [#position_category_3235] => 0
                    [#position_category_3224] => 150000
                    [#position_category_3199] => 150000
                    [#position_category_3191] => 120000
                    [#position_category_2765] => 1
                    [#position_category_2761] => 250001
                    [#position_category_2760] => 250001
                    [#position_category_6672] => 0
                    [#visibility] => 4
                    [#category_name_level_1] => Array
                        (
                            [0] => BCC Root Category
                        )

                    [#category_name_level_4] => Array
                        (
                            [0] => Huishouden
                            [1] => Top wasmachines
                            [2] => Accessoires wasmachine
                        )

                    [#category_name_level_3] => Array
                        (
                            [0] => Beste Koop Shop
                            [1] => Top
                            [2] => Wasmachine
                        )

                    [#category_name_level_2] => Array
                        (
                            [0] => Acties
                            [1] => Speciale informatie pagina's
                            [2] => Huishouden
                        )

                    [#category_name_level_5] => Array
                        (
                            [0] => Wasmachines
                        )

                )

        ) 
```

非常感谢，杰罗。

我找到了解决方案

```
class Xyz_Solrsearch_Model_Resource_Engine extends Enterprise_Search_Model_Resource_Engine {
    public function __construct()
    {
        $this->_advancedDynamicIndexFields[] = '#category_name_level_';
        parent::__construct();
    }
} 
```

# java - 使用条件 API 的复杂休眠查询

> ID：10742334
> 
> 赞同：0
> 
> 时间：2012-05-24T17:22:07.017
> 
> 标签：java, sql, hibernate, criteria

我正在尝试使用标准 API 编写一个复杂的查询。我可以在这方面使用一些帮助。

我有 3 个类，资产、资产组件和任务。Task 类与 AssetComponent 具有 1 对 M 的关系，AssetComponent 与 Asset 具有 1 对 M 的关系。我需要找到与它们相关联的一些任务的所有资产（它应该是唯一列表）（任务有一个组件，并且该组件知道它连接的资产）。

这是我到目前为止所拥有的

```
public List<Asset> retrieveTask(Project project, boolean assigned) {

  DetachedCriteria subquery = DetachedCriteria.forClass(Task.class);

  subquery.add(Restrictions.eq("project", project));
  if (assigned) {
     subquery.add(Restrictions.isNotNull("assignedTo"));
  } else {
     subquery.add(Restrictions.isNull("assignedTo"));
  }

  subquery = subquery.createCriteria("component");
  subquery.add(Restrictions.isNotNull("asset"));

  Criteria criteria = super.createCriteria();
  criteria.add(Subqueries.in("id", subquery));

  return criteria.list();
} 
```

deataced 查询应返回所有已分配资产的任务，并且是给定项目的一部分。现在我需要看看所有这些任务的独特资产是什么。

谢谢你帮我解决这个问题。

干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T17:46:26.513

在黑暗中拍摄了一点，但这对你有什么作用：

```
public List<Asset> retrieveTask(Project project, boolean assigned) {

    DetachedCriteria subquery = DetachedCriteria.forClass(Task.class);

    subquery.add(Restrictions.eq("project", project));
    DetachedCriteria assetCriteria = subquery
        .createCriteria("component")
        .createCriteria("asset").setProjection(Projections.groupProperty("id"));

    Criteria criteria = super.createCriteria();
    if(assigned) {
        criteria.add(Subqueries.propertyIn("id", subquery));
    }
    else {
        criteria.add(Subqueries.propertyNotIn("id", subquery));
    }
    return criteria.list();
} 
```

# c++ - 包含 '\0' 的字符串文字 - 为什么它们不一样？

> ID：10742335
> 
> 赞同：5
> 
> 时间：2012-05-24T17:22:12.723
> 
> 标签：c++, string

所以我做了以下测试：

```
char* a = "test";
char* b = "test";
char* c = "test\0"; 
```

现在的问题是：

1) 可以保证`a==b`吗？**我知道我在比较地址。这并不是要比较字符串，而是要比较相同的字符串文字是否存储在单个内存位置**

2）为什么不`a==c`呢？编译器不应该能够看到它们指的是同一个字符串吗？

`\0`3) 是否在 的末尾附加了一个额外的内容`c`，即使它已经包含一个？

我不想为此问 3 个不同的问题，因为它们似乎有点相关，抱歉。

注意：标签是正确的，我对 C++ 感兴趣。（尽管请指定 C 的行为是否不同）

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-05-24T17:24:41.090

> 是否保证a==b？

不可以。但是 §2.14.5/12 允许这样做：

> 是否所有字符串文字都是不同的（即，存储在不重叠的对象中）是实现定义的。尝试修改字符串文字的效果是未定义的。

正如您从最后一句中看到的那样，使用`char*`代替`char const*`是一个麻烦的秘诀（并且您的编译器应该拒绝它；确保您启用了警告并选择了高一致性级别）。

> 为什么不 a==c？编译器不应该能够看到它们指的是同一个字符串吗？

不，它们不需要引用相同的字符数组。一个有五个元素，另一个有六个。实现可以将两者存储在重叠存储中，但这不是必需的。

> 是否在 c 的末尾附加了一个额外的 \0，即使它已经包含一个？

是的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-24T17:24:05.707

1 - 绝对不是。a 可能 == b 但如果编译器选择共享相同的静态字符串。

2 - 因为它们不是指同一个字符串

3 - 是的。

除了 C++ 编译器应该拒绝对非 const char* 的赋值之外，这里的 C 和 C++ 之间的行为没有什么不同。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-24T17:25:17.020

> 1）是否保证a==b？

它不是。请注意，您正在比较地址，它们可能指向不同的位置。大多数智能编译器会折叠这个重复的文字常量，因此指针可能比较相等，但标准也不能保证。

> 2）为什么不 a==c？编译器不应该能够看到它们指的是同一个字符串吗？

您正在尝试比较指针，它们指向不同的内存位置。即使您在比较这些指针的内容，它们仍然不相等（请参阅下一个问题）。

> 3) 是否在 c 的末尾附加了一个额外的 \0，即使它已经包含一个？

就在这里。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-05-24T17:28:21.663

首先请注意，这应该是 const char* ，因为这就是字符串文字衰减的原因。

1.  两者都创建用 't' 'e' 's' 't' 初始化的数组，后跟 '\0' （长度 = 5）。比较相等性只会告诉您它们是否都以相同的指针开头，而不是它们是否具有相同的内容（尽管从逻辑上讲，这两个想法是相互遵循的）。
2.  A 不等于 C，因为适用相同的规则，a = 't' 'e' 's' 't' '\0' 和 b = 't' 'e' 's' 't' '\0' '\0'
3.  是的，编译器总是这样做，如果你正在制作这样的字符串，你不应该明确地这样做。但是，如果您创建了一个数组并手动填充它，则需要确保添加 \0。

请注意，对于我的#3， const char[] = "Hello World" 最后也会自动获得 \0，我指的是手动填充数组，而不是让编译器解决它。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-05-24T17:24:51.663

这里的问题是你混合了指针和文本等价的概念。

当您说`a == b`或`a == c`询问所涉及的指针是否指向相同的物理地址时。测试与指针的文本内容无关。

要获得文本等价，您应该使用`strcmp`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-24T17:25:32.973

如果您进行的指针比较比 a != b、b != c 和 c != a。除非编译器足够聪明，可以注意到您的前两个字符串是相同的。

如果您执行 strcmp(str, str) 那么您的所有字符串都将作为匹配项返回。

我不确定编译器是否会为 c 添加一个额外的空终止，但我猜它会。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-24T17:33:25.010

正如在其他答案中多次说过的那样，您正在比较指针。但是，我要补充一点，这`strcmp(b,c)`应该是正确的，因为它在第一个`\0`.

# spring - Hibernate Validator 未正确显示 Unicode 字符

> ID：10742337
> 
> 赞同：0
> 
> 时间：2012-05-24T17:22:16.023
> 
> 标签：spring, hibernate, validation, internationalization

我正在构建一个使用 JSR-303 验证的 Spring MVC Web 应用程序。在我创建的第一个表单中，我向表单支持 bean 添加了几个验证注释（包括自定义错误消息代码）。我还创建了 ValidationMessages.properties 和 ValidationMessages_en.properties 文件。

一切似乎都正常工作，但有一个例外：多字节 utf-8 编码字符显示不正确（例如，“ñ”显示为“Ã±”）。

这不是我用于字段标签和其他文本的标准 messages.properties 和 messages_en.properties 文件的问题，所以我假设这是休眠验证器代码的问题。有没有其他人遇到过这个问题并解决了？仅供参考，我使用的是 Hibernate 版本 4.3.0.Final。

谢谢，彼得

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T17:30:07.723

在我的属性文件中，我必须包含这样的特殊字符：\u00F3 而不是 ó

这样他们就可以很好地展示出来。

希望能帮助到你。

PS：使用 Eclipse 中的 ResourceBundleEditor 也有帮助。

# asp.net - ASP.NET C# 处理图像

> ID：10742338
> 
> 赞同：0
> 
> 时间：2012-05-24T17:22:16.260
> 
> 标签：asp.net, image

类似于我的其他问题之一，但我需要澄清。

我有一个 Web 应用程序，其中多个用户将同时打开。在应用程序中，将在其中一个应用程序文件夹中绘制图像，如下所示，保存，然后添加到页面上的图像控件。

```
Bitmap image = new Bitmap(Server.MapPath("~") + "/Assets/img/timegrid.jpg");
Graphics graphics = Graphics.FromImage(image);
Pen p = new Pen(Color.Blue, 5); 
//draw on image
graphics.DrawLine(p, aPoint, bPoint); 

//save new image
image.Save(Server.MapPath("~") + "/Assets/img/newtimegrid.jpg");
imgGrid.ImageUrl = "~/Assets/img/newtimegrid.jpg"; 
```

每个用户的新图像看起来都不同。但是，我担心用户 A 会看到用户 B 的 newtimegrid.jpg 而不是他自己的，因为每个用户都保存到相同的文件名。我听说过使用通用图像处理程序并且我已经阅读了一些解决方案here，但我仍然不明白如何使用它，或者如果我做了一个如何调用它，或者这甚至是一个解决方案我的问题。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T17:27:10.060

我建议您将 userID 保留在会话中，并在路径中使用此 id 来唯一标识每个用户图像路径的图像路径。

您可以先检查用户的路径是否已存在。

```
string strDirPath = Server.MapPath("~") + "/Assets/img/ + Session["UserID"].ToString();

if(Directory.Exists(strDirPath))
{
     Bitmap image = new Bitmap(strDirPath + "\\" + timegrid.jpg");
     //your code here
}
else
{
     DirectoryInfo CreateDirectory(strDirPath);
     Bitmap image = new Bitmap(strDirPath + "\\" + timegrid.jpg");
     //your code here
} 
```

# c# - 可以切换 if/else 方法中返回的值吗？

> ID：10742340
> 
> 赞同：1
> 
> 时间：2012-05-24T17:22:23.217
> 
> 标签：c#

`Calculations.cs`我在一个类中有以下代码：

```
public decimal decPaymentPlan(QuoteData quoteData)
    {
        if (quoteData.StepFilingInformation.PaymentPlanRadioButton 
            == StepFilingInformation.PaymentPlan.No)
            return PriceQuote.priceNoPaymentPlan;
        else
            return PriceQuote.pricePaymentPlanChapter7; //may want to switch
                                                        //to Chapter13 value
    }

public decimal CalculateChapter7(QuoteData quoteData)
    {
        decimal total = PriceQuote.priceChapter7;
        total += this.decPaymentPlan(quoteData); //want to be able to tell
                                                 //which to use, 7 or 13
        return total;
    } 
```

我想看看我是否可以避免额外`decPaymentPlan`的最终回报`pricePaymentPlanChapter13`。我认为可能有一种方法可以将其关闭。

否则，我必须执行以下操作：

```
public decimal decPaymentPlanChapter7(QuoteData quoteData)
    {
        ...
        else
            return PriceQuote.pricePaymentPlanChapter7;
    }

public decimal decPaymentPlanChapter13(QuoteData quoteData)
    {
        ...
        else
            return PriceQuote.pricePaymentPlanChapter13;
    }

...

//the following will appear anyway, but rather than just using
//one method call which switches the choice based on something
public decimal CalculateChpater7(QuoteData quoteData)
    {
        ...
        //instead of decPaymentPlan(quoteData) + something to switch
        total+= this.decPaymentPlanChapter7(quoteData);
        ...
    }

public decimal CalculateChpater13(QuoteData quoteData)
    {
        ...
        //instead of decPaymentPlan(quoteData) + something to switch
        total+= this.decPaymentPlanChapter13(quoteData);
        ...
    } 
```

这样的事情可行（以及如何）？谢谢。感谢任何代码示例或指导。

**更新：** 这是我的控制器：

```
public ActionResult EMailQuote()
{
    Calculations calc = new Calculations();

    QuoteData quoteData = new QuoteData
    {
        StepFilingInformation = new Models.StepFilingInformation
        {
            //just moking user input here temporarily to test out the UI
            PaymentPlanRadioButton = Models.StepFilingInformation.PaymentPlan.Yes,
        }
     };

     var total = calc.CalculatePrice(quoteData);
     ViewBag.CalculatePrice = total; // ADDED THIS LINE
     return View(quoteData);
} 
```

此外，我在 PriceQuote 中为第 7 章和第 13 章设置了一个值（例如，`public static decimal priceChapter7 { get { return 799; } }`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T17:26:37.797

7和13有什么区别？我会选择这样做：

```
if (quoteData.StepFilingInformation.PaymentPlanRadioButton ==
StepFilingInformation.PaymentPlan.No)              
      return PriceQuote.priceNoPaymentPlan;          
else if (//whatever fulfills ch. 7)             
      return PriceQuote.pricePaymentPlanChapter7;
else //ch. 13
      return PriceQuote.pricePaymentPlanChapter13; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T17:28:58.420

看起来您可以创建一个枚举`Chapters`并将其作为第二个参数传递给该`decPaymentPlan`方法，是吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T17:36:47.757

如果不进一步了解您在做什么，很难确定建议，但如果您的方法之间的唯一区别是一组要使用的值（一组用于第 7 章，另一个用于第 13 章），那么采用这些值可能是有意义的出 PriceQuote 并创建一个基本类型来保存这些值。然后您的 decPaymentPlan 和其他方法将只采用该类型的实例。例如：

```
class Chapter // for lack of a better name
{
    public decimal PaymentPlan { get; set; }
    public decimal Price { get; set; }
    ....
} 
```

然后，更改您的方法以获取章节参数

```
public decimal decPaymentPlan(QuoteData quoteData, Chapter chapter)
{
    if (quoteData.StepFilingInformation.PaymentPlanRadioButton 
        == StepFilingInformation.PaymentPlan.No)
        return PriceQuote.priceNoPaymentPlan;
    else
        return chapter.PaymentPlan;
}

public decimal Calculate(QuoteData quoteData, Chapter chapter)
{
    decimal total = chapter.Price;
    total += this.decPaymentPlan(quoteData, chapter);

    return total;
} 
```

现在您只需要两个 Chapter 实例，一个用于 7，另一个用于 13，并相应地调用您的计算方法。

**更新**：为了详细说明“相应地调用你的计算方法”的意思，假设你有两个静态变量（在你的应用程序中有意义的地方，也许在 Calculations.cs 中）

```
static Chapter Chapter7 = new Chapter() { Price = 799.99, PaymentPlan = 555.55 };
static Chapter Chapter13 = ... 
```

然后在您的控制器中，您将能够编写

```
ViewBag.Chapter7Total = calc.CalculatePrice(quoteData, Chapter7);
ViewBag.Chapter13Total = calc.CalculatePrice(quoteData, Chapter13); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-24T17:37:20.937

您正在将业务逻辑与可视化层混合：

> if (quoteData.StepFilingInformation.PaymentPlanRadioButton == StepFilingInformation.PaymentPlan.No)

更好的设计是有一个模型可以应用更改，例如 MVC、MVP、MVVM。

例子：

```
public class View
{
    private Model _model = new Model();

    public View()
    {
    }

    public Controller Controller
    {
        get;
        set;
    }

    private void OnButton1Click(object sender, EventArgs args)
    {
        _model.Option = Options.Option1;
    }

    private void OnSaveClick(object sender, EventArgs args)
    {
        if (Controller != null)
            Controller.ApplyChanges(_model);
    }
} 
```

然后控制器可以应用业务逻辑而不受视图结构的影响，这样您就可以自由地更改两者中的任何一个。

例如

```
public class Controller
{
    Model Model
    {
        get;
        set;
    }

    decimal CalculateSum()
    {
        return Model.Items.Aggregate((a, b) => a + b);
    }
} 
```

# performance - 自动更新 appcache 清单文件版本

> ID：10742341
> 
> 赞同：0
> 
> 时间：2012-05-24T17:22:26.433
> 
> 标签：performance, html, caching, html5-appcache

我为我的 Web 应用程序启用了[应用程序缓存。](http://www.html5rocks.com/en/tutorials/appcache/beginner/)现在我需要确保每次生成战争或部署应用程序时，缓存清单文件的版本都会自动更新。这样浏览器就会在每次部署后从服务器加载内容而不是缓存。

所以让我知道是否有任何方法可以自动更新版本。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T12:40:01.040

动态生成清单。使用 PHP、JSP 或您想要/可以使用的任何其他服务器端语言。如果没有有关使用/首选语言的信息，我无法提供实用示例。

或者你让你的构建脚本在创建战争时附加 lin。

# javascript - 如何根据滑块值动态设置 jquerymobile 滑块的步长？

> ID：10742344
> 
> 赞同：1
> 
> 时间：2012-05-24T17:22:36.330
> 
> 标签：javascript, jquery, jquery-ui, jquery-mobile, slider

我有一个 jquery 移动滑块：

```
<input type="range" name="slider" data-track-theme="c" 
        data-highlight="true" id="slider-step1" step="10000" 
        value="10000" min="10000" max="9000000" /> 
```

我必须像这样动态设置步长值：最多 200.000 步 10.000，最多 500.000 步 25.000，最多 1.000.000 步 50.000，最多 2.000.000 步 200.000，最多 9.000.000 步500.000。

我尝试了很多东西，但一无所获。请帮忙！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T07:59:59.110

这是可能的！！使用您的值或变量尝试此解决方案：

```
$("#slider-step").attr("min", 4);
$("#slider-step").attr("max", 40);
$("#slider-step").attr("step", 4); 
$("#slider-step").val(4);
$('#slider-step').slider('refresh'); 
```

这个对我有用！！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T22:23:35.953

这样的事情可能会奏效。

```
$('#slider-step1').change(function(){
    currentValue = $(this).val();
    if(currentValue > 200000){
        $(this).attr('step','25000');
    }
    if(currentValue > 500000){
        $(this).attr('step','50000');
    }
    // and on and on 
}); 
```

我敢肯定，您将不得不对其进行改进以按您的意愿工作，但这是基本思想。

# android - 如何在android中创建一个半圆形ProgressBar

> ID：10742348
> 
> 赞同：0
> 
> 时间：2012-05-24T17:23:02.187
> 
> 标签：android, xml

我正在开发一个媒体播放器应用程序，我希望 ProgressBar 处于半圆形。我尝试了一些 xml 文件，如 Shape,rotate 但它不起作用。改变这种进度条形状的可能方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T17:29:30.277

**res->drawable->progressbackground1.xml**

```
<?xml version="1.0" encoding="utf-8"?>
<animated-rotate xmlns:android="http://schemas.android.com/apk/res/android"
android:drawable="@drawable/progressbar1"
android:pivotX="50%"
android:pivotY="50%" /> 
```

**res->layout->main.xml**

```
 <ProgressBar
        android:id="@+id/progressBar1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentTop="true"
        android:layout_marginTop="5dp"
        android:indeterminateDrawable="@drawable/progressbackground1" /> 
```

**res->drawable->progressbar1.png**

![](../Images/8ae4349413f8c0a45dfda81f73b15210.png)

# javascript - 专注于 HTML 元素的下一个 tabindex onEnter keypress by JQuery

> ID：10742349
> 
> 赞同：16
> 
> 时间：2012-05-24T17:23:07.053
> 
> 标签：javascript, jquery, asp.net, html, tabindex

**嗨朋友们，** 我正在做一个小任务，即让用户能够在输入按键时对 html 元素进行制表索引。

作为 jquery 的新手，我编写了一些代码，在我看来它可以工作，但其中存在一些问题。

**初步发现**
罪魁祸首代码，它不起作用，因为 Msg 标签中的输出是“未定义”

```
$('*').attr('tabindex').id 
```

![在此处输入图像描述](../Images/29c84098d88132a1c99f0c5dab845330.png)

下面给出了代码，我什至创建了一个[JSFiddle](http://jsfiddle.net/PPB9s/1/)。

**jQuery**

```
 $(document).ready(function (eOuter) {
    $('input').bind('keypress', function (eInner) {
        if (eInner.keyCode == 13) //if its a enter key
        {
            var tabindex = $(this).attr('tabindex');
            tabindex++; //increment tabindex
            //after increment of tabindex ,make the next element focus
            $('*').attr('tabindex', tabindex).focus();

                       **//Msg Label**
            //Just to print some msgs to see everything is working
            $('#Msg').text( this.id + " tabindex: " + tabindex 
               + " next element: " + $('*').attr('tabindex').id);

            return false; // to cancel out Onenter page postback in asp.net
        }
    });
}
); 
```

**HTML**

```
<div>
    Employee Info<br />
    Name<br />
    <input name="TxtbxName" type="text" value="ok" id="TxtbxName" tabindex="1" />
    <br />
    Age<br />
    <input name="TxtbxAge" type="text" id="TxtbxAge" tabindex="2" />
    <br />
    Gender<br />
    <select name="DdlGender" id="DdlGender" tabindex="3">
      <option selected="selected" value="Male">Male</option>
      <option value="Female">Female</option>
    </select>
    <br />
    <div>
        Previous Employment<br />
        <select name="DdlCompany" id="DdlCompany" tabindex="4">
   <option selected="selected" value="0">Folio3</option>
   <option value="1">Null Soft</option>
   <option value="2">Object Soft</option>
   <option value="3">Excepption Soft</option>
    </select>
        &nbsp;&nbsp;or Enter Code&nbsp;&nbsp;
        <input name="TxtbxCompanyCode" type="text" id="TxtbxCompanyCode" tabindex="5" />
        <br />
        Address<br />
        <input name="TxtbxAddress" type="text" id="TxtbxAddress" tabindex="6" />
        <br />
       <input type="submit" name="BtnSubmit" value="Submit" id="BtnSubmit" tabindex="7"/>
        <br />
        <label id="Msg">Message here</label>
    </div>
</div> 
```

**让我知道我哪里出错了：/**

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-24T17:44:24.527

我发现了几个小的 jQuery 问题。固定在这里：[JSFiddle](http://jsfiddle.net/vansimke/PPB9s/3/)。

这一行：

```
$('*').attr('tabindex', tabindex).focus(); 
```

可以这样写：

```
$('[tabindex=' + tabindex + ']').focus(); 
```

还有这个：

```
$('#Msg').text($(this).id + " tabindex: " + tabindex 
           + " next element: " + $('*').attr('tabindex').id); 
```

没有以 jQuery 方式调用 id 属性（您使用的是 JavaScript 语法，但 $(this) 的结果是一个 jQuery 对象。所以...`$(this).id`变成`$(this).attr('id')`.

该表单仍然存在提交问题，我没有深入研究，但它现在改变了焦点并填写了“#Msg”元素。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2016-11-18T21:38:45.180

**这是我在没有***jQuery*的情况下使用[JSFiddle 示例](https://jsfiddle.net/eapo/pnL3nue7/)*`focusNextElement`*在`keydown`[Enter]上的完整工作代码，该示例基于以下*stackoverflow*答案创建：

 ****1.  [如何防止按 ENTER 键提交 Web 表单？](https://stackoverflow.com/a/37242043/1589669)
2.  [聚焦标签索引中的下一个元素](https://stackoverflow.com/a/35173443/1589669)

```
<script type="text/javascript">

    function focusNextElement() {
      var focussableElements = 'a:not([disabled]), button:not([disabled]), input[type=text]:not([disabled]), [tabindex]:not([disabled]):not([tabindex="-1"])';
      if (document.activeElement && document.activeElement.form) {
        var focussable = Array.prototype.filter.call(document.activeElement.form.querySelectorAll(focussableElements),
          function(element) {
            return element.offsetWidth > 0 || element.offsetHeight > 0 || element === document.activeElement
          });
        var index = focussable.indexOf(document.activeElement);
        focussable[index + 1].focus();
      }
    }

    window.addEventListener('keydown', function(e) {
      if (e.keyIdentifier == 'U+000A' || e.keyIdentifier == 'Enter' || e.keyCode == 13) {
        if (e.target.nodeName === 'INPUT' && e.target.type !== 'textarea') {
          e.preventDefault();
          focusNextElement();
          return false;
        }
      }
    }, true);

</script> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-26T11:04:14.170

不想发布新帖子并使用我认为有用的解决方案制作垃圾邮件。

从其他来源收集信息（[Brian Glaz 代码](https://stackoverflow.com/questions/7208161/focus-next-element-in-tab-index)nice-one）并 使用**Enter**键制作了跨浏览器版本的**Focus Next Element In Tab-index**。

 ****选项卡索引**不是**一个接一个**，但也可以在 (1,2,9,11,30 等) 之间包含一个空格

```
var tabindex = 1; //start tabindex || 150 is last tabindex
    $(document).keypress(function(event) {
        var keycode = (event.keyCode ? event.keyCode : event.which);
        if(keycode == '13') { //onEnter
            tabindex++;
            //while element exist or it's readonly and tabindex not reached max do
            while(($("[TabIndex='"+tabindex+"']").length == 0 || $("[TabIndex='"+tabindex+"']:not([readonly])").length == 0) && tabindex != 150 ){
                tabindex++;
            }
            if(tabindex == 150){ tabindex = 1 } //reseting tabindex if finished
            $("[TabIndex='"+tabindex+"']").focus()
            return false;
        }
    });

    $("input").click(function() { //if changing field manualy with click - reset tabindex 
        var input = $(this);
        tabindex = input.attr("tabindex");
    }) 
```

我希望有人会觉得它有用。随意编辑/评论它。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-08-09T16:23:53.967

```
var tab = $(this).attr("tabindex");
tab++;
$("[tabindex='"+tab+"']").focus(); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-09-25T15:59:10.653

为了解决这个问题，我生成了一个小的 jquery 函数来查找下一个有效的 tabindex；假设它更容易维护，并且可能比 while 循环快一点：

```
function getNextTabindex(currentTabIndex) {
  return $("[tabindex]").index($("[tabindex=" + currentTabIndex + "]")) + 1;
} 
```

希望这对需要它的人有所帮助；这是经过测试并且有效的。

简而言之：寻找当前tabindex的元素，在所有tabindex元素的列表中找到这个元素，获取它的索引并增加索引。

然后，使用这个函数，你可以这样选择下一个 tabindex 元素：

```
$('[tabindex=' + getNextTabindex($(":focus").attr("tabindex")) + ']').focus(); 
```

我没有测试电话，但假设它可以工作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-06-06T02:10:50.727

```
var tabindex= $(this).attr("tabindex");
tabindex++;
$("[tabindex='"+tabindex+"']").focus(); 
```

> 表格中可编辑单元格的示例

```
 $(document).on('dblclick', 'td', function () {
        console.log('clicked');
        this.contentEditable = 'true';
    });
 $(document).on('keydown', 'td', function (event) {
        if (event.keyCode === 9 || event.keyCode === 13) {
            this.contentEditable = 'false';
            //  $(this).next().focus().dblclick().focus();
            var tabindex = $(this).attr('tabindex');
            tabindex++;
            var next = $('[tabindex=' + tabindex + ']').focus().dblclick();
            if (next.is('td') == false)
                return true;
            var sel, range;
            if (window.getSelection && document.createRange) {
                range = document.createRange();
                range.selectNodeContents(next[0]);
                range.collapse(true);
                sel = window.getSelection();
                sel.removeAllRanges();
                sel.addRange(range);
            } else if (document.body.createTextRange) {
                range = document.body.createTextRange();
                range.moveToElementText(next[0]);
                range.collapse(true);
                range.select();
            }

            return false;
        }
    }); 
```

[动态表格中的可编辑单元格](https://stackoverflow.com/a/44380264/3615816)******

# crystal-reports - 交叉表汇总字段不受列限制

> ID：10742351
> 
> 赞同：0
> 
> 时间：2012-05-24T17:23:09.350
> 
> 标签：crystal-reports

所以我正在使用 Crystal Reports 10 并且正在查看交叉表以尝试制作一个漂亮整洁的信息表。我正在尝试制作一个报告，其中对于每个项目（作为一行），列将是它进入的不同大小，并且该单元格的值将是数量。

所以看起来像这样的东西：

```
 Small  | Medium | Large
Item 1    1    |  5     | 10
Item 2    5    |  10    | 15 
```

但是，使用交叉表，我必须对数量字段进行总计、平均等，因此我无法在这样的漂亮表格中获得每种尺寸的具体细分。有没有办法调整交叉表来做到这一点，或者水晶报表中是否有另一个工具可以让我以有组织的方式获得每个尺寸的数量？

感谢你们提供的任何帮助。

更新：我尝试过的交叉表给了我一些看起来像这样的东西

```
 Small  | Medium | Large
Item 1    16   |  16    | 16
Item 2    30   |  30    | 30 
```

如果我将详细信息部分中的值作为单独的字段，我可以使值正确匹配，但格式不正确。出来是这样的

```
Item 1 | Small | 1
Item 1 | Medium| 5
Item 1 | Large | 10 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T18:10:33.503

*   创建交叉表
*   将 {table.size} 添加到列
*   将 {table.item} 添加到行
*   将 {table.quantity} 添加到汇总字段

# c - C从文件中读取，它读取“@”

> ID：10742354
> 
> 赞同：1
> 
> 时间：2012-05-24T17:23:32.893
> 
> 标签：c, file, file-processing

我正在尝试读取 C 中的文件。但是当我读取并将其写入标准输出时，它会打印 @ 也没有在我的文件中。是什么原因？

```
 #include <stdio.h>

int main() {

FILE *fp;
int br;
char buffer[10];
int i;
fp = fopen("a.txt","r");
while(1) {
        br = fread(buffer,1,10,fp);
        printf("%s",buffer);
        if (br==0)
                break;
        }
} 
```

输出：

1234567891@2345678912@3456789 12@3456789 12@

档案：123456789123456789123456789

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-24T17:34:50.557

您的`fread`调用最多可以正确读取 10 个字节，但要求字符串以空值结尾`printf`。`%s`您可以通过将缓冲区的大小增加到 11 个字节并在每次调用后`fread`在数据末尾写入零来修复它，即`buffer[br] = 0;`.

另一种方法是`printf`通过调用来判断数据的大小`printf("%.*s", br, buffer);`。你不需要修改你的缓冲区数组。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-24T17:29:32.963

动态分配缓冲区并将其初始化为零，如下所示：

```
 char *buffer = calloc(1, 11);

   <do your read loop>

   free(buffer) 
```

这样，您将在末尾获得零字节，这将在打印时终止字符串。当 C 打印一个字符串时，它期望它以 NULL（或 0）字节终止。

# python - Python新手@patch装饰器问题

> ID：10742361
> 
> 赞同：44
> 
> 时间：2012-05-24T17:23:54.867
> 
> 标签：python, mocking, patch

我尝试通过用以下方式装饰测试方法来修补提供程序类`@patch`：

```
class TestMyUnit(unittest.TestCase):
...
@patch(provider.Provider,autospec=True)
def test_init(self, mock_provider):
    pass 
```

但是，当我运行测试时，出现错误：

```
*@patch(provider.Provider)*  
*File "build\bdist.win32\egg\mock.py", line 1518, in patch*  
*getter, attribute = \_get\_target(target)*  
*File "build\bdist.win32\egg\mock.py", line 1367, in \_get\_target*  
*target, attribute = target.rsplit('.', 1)*  
*AttributeError: class Provider has no attribute 'rsplit'*  
*ERROR: Module: test\_my\_unit could not be imported (file: C:\dev\src\test\_my\_unit.py).* 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2012-05-24T17:46:38.320

使用字符串而不是类。

```
@patch('provider.Provider', autospec=True)
def test_init(self, mock_provider):
    pass 
```

# c# - AutoresetEvent 和 Singleton 问题

> ID：10742363
> 
> 赞同：3
> 
> 时间：2012-05-24T17:23:56.413
> 
> 标签：c#, singleton, autoresetevent

有人可以告诉我以下代码有什么问题吗？理想情况下，它应该首先启动一个线程，然后等待设置事件。相反，它不会启动线程，只会卡在 WaitOne() 上。

我很想知道线程发生了什么，为什么？

```
class Program
{   
    static void Main(string[] args)
    {
        Testing t = Testing.Instance;
        Console.Read();
    }
}

class Testing
{
    private static AutoResetEvent evt = new AutoResetEvent(false);
    public static Testing Instance = new Testing();

    private Testing()
    {
        Create();
        evt.WaitOne();
        Console.WriteLine("out");
    }

    private void Create()
    {
        Console.WriteLine("Starting thread");
        new Thread(Print).Start();
    }

    private void Print()
    {
        Console.WriteLine("started");
        evt.Set();
    }
} 
```

**编辑：** 到目前为止，@BrokenGlass 提供的描述是有道理的。但是将代码更改为以下代码允许另一个线程可以访问实例方法而无需完成构造函数。（@NicoSchertler 建议）。

```
private static Testing _Instance;

public static Testing Instance
{
get
{
    if (_Instance == null)
        _Instance = new Testing();
    return _Instance;
}
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-24T17:28:14.237

我怀疑这种行为的根本原因是生成的线程在构造函数完成执行之前无法访问该`Print`方法 - 但构造函数永远不会完成执行，因为它正在等待仅从该`Print`方法触发的信号。

`evt.WaitOne()` 用长调用替换`Thread.Sleep()`确认相同的行为 - 构造函数必须在对象的任何实例方法可以从另一个线程执行之前完成运行。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-24T17:41:15.587

问题是第二个线程创建得太早了。我不知道为什么，但是在主程序启动之前启动时，它不会执行。

您应该在其原始版本中使用单例模式。这将起作用。

```
private static Testing _Instance;

public static Testing Instance
{
    get
    {
        if (_Instance == null)
            _Instance = new Testing();
        return _Instance;
    }
} 
```

此外，您不应将 evt 变量设为静态。在大多数情况下，实例变量应该是单例类的唯一静态成员。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T17:30:17.420

我的猜测是静态字段初始化的相对时间问题。`evt`尝试在构造函数中初始化`Testing`：

```
private static AutoResetEvent evt;
public static Testing Instance = new Testing();

private Testing()
{
    evt = new AutoResetEvent(false);
    Create();
    evt.WaitOne();
    Console.WriteLine("out");
} 
```

我应该注意到这实际上只是一个猜测——我原以为这段代码可以正常工作。

# scala - 带有playframework 2的scala 2.10Mx

> ID：10742366
> 
> 赞同：11
> 
> 时间：2012-05-24T17:24:12.050
> 
> 标签：scala, playframework, sbt

如何在 play 2.xx 中使用 scala 2.10Mx？

我尝试将 scalaVersion := "2.10.0-M3" 添加到 project/Build.scala 但没有效果。

这是我的项目/Build.scala：

```
import sbt._
import Keys._
import PlayProject._

object ApplicationBuild extends Build {

    val appName         = "dashboard-server"
    val appVersion      = "1.0-SNAPSHOT"

    resolvers += "Local Ivy Repository" at "file://"+Path.userHome.absolutePath+"/.ivy2/cache"

    scalaVersion := "2.10.0-M3"

    val appDependencies = Seq(
      "mysql" % "mysql-connector-java" % "5.1.10"
    )

    val main = PlayProject(appName, appVersion, appDependencies, mainLang = SCALA).settings(
      // Add your own project settings here

    )

} 
```

我正在使用 sbt 0.11.3

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T11:21:57.997

play bugtracker中有一张票：[https ://play.lighthouseapp.com/projects/82401/tickets/650-support-for-scala-210-m6](https://play.lighthouseapp.com/projects/82401/tickets/650-support-for-scala-210-m6)

答案是由于 akka，您目前无法将 play 2 与 scala 2.10 一起使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T16:04:55.317

play 2.0.x 不适用于 Scala 2.10。Play 2.1 分支确实如此，但截至我写这篇文章时（2012 年 10 月 25 日），您需要从源代码构建开发分支，并且开发分支仍在积极开发中。TLDR：还不适合生产应用程序，给它几个月

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-28T07:15:43.203

嗯，实际上你可以做到。我在**[这里](https://stackoverflow.com/a/15675008/226895)**的回答中描述了细节。

但简而言之，您需要在`Build.scala`.

`scalaVersion`通过设置来切换版本对`2.10.1`我没有帮助，因为 SBT 仍然会进入存储库并获取 2.10.0 的片段。所以我告诉 SBT 通过设置以下变量来使用 Scala 的本地副本

```
scalaVersion := "2.10.1-local",
autoScalaLibrary := false,
scalaHome := Some(file("/Program Files (x86)/scala/")) 
```

# sql-server-2008 - 如果字段值为空，则报告服务表达式避免使用逗号

> ID：10742367
> 
> 赞同：0
> 
> 时间：2012-05-24T17:24:17.197
> 
> 标签：sql-server-2008, reporting-services

我有以下表达式，并在每列之后显示逗号。如果字段值为空，我不想在每个字段值之后显示逗号（，）。我将不胜感激任何帮助。谢谢你。

```
=Fields!address.Value &", "&Fields!city.Value &", "& Trim(Fields!zipcode.Value) &", "& Fields!state_code.Value 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T18:13:44.557

使用存储过程。然后你可以说：

```
SELECT COALESCE(address + ',', '') + COALESCE(city + ',', '') + ... 
```

# javascript - Javascript“shift”与“splice”——这些语句是否相等？

> ID：10742369
> 
> 赞同：22
> 
> 时间：2012-05-24T17:24:18.120
> 
> 标签：javascript, arrays, array-splice

我只想确认以下两个 Javascript 语句是否产生相同的结果，在我看来：

第一的：

```
var element = my_array.splice(0,1)[0]; 
```

第二：

```
var element = my_array.shift(); 
```

我想在我自己的代码中用第二个代替第一个，以提高可读性。我可以这样做吗？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-05-24T17:28:12.623

它们将具有相同的效果，是的。`splice(0, 1)`将从中删除第一个元素`my_array`并返回包含该元素的新数组。`shift`会做同样的事情，但返回元素本身，而不是数组。

`shift`更具可读性（在我看来）并且速度也[明显更快](http://jsperf.com/shift-vs-splice)（至少在 Chrome 中）：

![在此处输入图像描述](../Images/5708db44569e75fcc1202face7c740c5.png)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-24T17:28:11.303

这两行代码都从数组中删除第一个元素，并返回删除的元素，所有主流浏览器都支持它们。

您应该使用第二个，代码确实更具可读性。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-24T17:28:20.877

[shift](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/shift)返回被移除的元素，[splice](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/splice)返回被移除元素的数组。

话虽如此，这两个陈述做同样的事情，我同意第二个更具可读性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-03-30T16:49:43.920

**splice**将作为数组返回，但不会从对象中删除数据，而是进行复制

* * *

**shift**只从前面给出一个数据，并从对象中删除

* * *

例如，

```
const object = {1}
object.slice(); // return [{1}]
//object will be : {1}
object.shift(); // return {1}
//object will be : {} as shift remove the front data 
```

# html - 应用缓存：按需清单？

> ID：10742371
> 
> 赞同：0
> 
> 时间：2012-05-24T17:24:34.023
> 
> 标签：html, mobile, application-cache, cache-manifest

我正在开发一个可以在线和**离线**使用的 Web 应用程序。用户可以选择是否下载内容。提示打开并将他重定向到包含 HTML 标记上的 manifest 属性的页面。

这就像一个魅力，浏览器​​按预期运行并下载清单中列出的所有内容并在离线模式下工作。

现在，如果用户将页面添加到他的主屏幕，在他选择下载内容之前。他显然会链接到没有清单属性的页面。

如果他选择在他的主屏幕上从 webapp 下载内容，该应用程序将拒绝在离线模式下工作。

我想这是因为最初缓存/链接到主屏幕上的文件 IOS 上缺少清单标记。

* * *

**简短概述：**

联机 -> Safari -> 选择下载 appcache -> 添加到主屏幕 -> 脱机 -> 从主屏幕打开 Webapp ->**工作**

联机 -> Safari -> 添加到主屏幕 -> 从主屏幕打开 Webapp -> 选择下载 appcache -> 脱机 -> 从主屏幕打开 Webapp ->**不起作用**

* * *

你会怎么处理这个？有没有办法选择主屏幕上链接的文件？我总是提供一个空的清单文件并仅为主屏幕上的版本填充它吗？我错过了一些明显的东西吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T09:10:39.310

尝试将没有清单属性的起始页添加到缓存清单中列出的页面。一旦浏览器下载了清单，它就不必再依赖该属性了。

# jquery-mobile - 使用 jQuery Mobile 和 Phonegap 管理动态列表

> ID：10742376
> 
> 赞同：0
> 
> 时间：2012-05-24T17:25:12.687
> 
> 标签：jquery-mobile, cordova

我有一个要从数据库显示的列表。列表中的每个项目都与一个 ID 相关联。我想知道跟踪列表中每个项目的 ID 的最佳方法。所以当我点击item时，我可以使用ID映射到数据库中item的其他属性。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T18:28:18.507

我不知道“最好的方法”，但你可以做到这一点的一种方法是通过将 id 嵌入到锚标记中，然后使用客户端路由解决方案来处理它（查看[jQuery 移动路由器](https://github.com/azicchetti/jquerymobile-router)）。

或者，您可以在 js 对象中为列表中的每个项目维护一个引用，将 id 保留在对象中。最简单的方法可能是使用某种 javascript mvc 类型框架，例如[backbone.js](http://documentcloud.github.com/backbone/) ，在其中您将拥有代表每个项目的模型集合以及与 DOM 中特定元素挂钩的每个项目的视图（在您的情况下是一个 li），并且可以连接以响应该元素上的事件（例如，当您单击项目时，项目视图会响应其单击事件并采取相应措施）。

**编辑**：

就我个人而言，我一直在使用backbone.js 来构建我自己的代码，如果你对它感兴趣，你应该能够找到很多关于它的教程。无论如何，这里有一个[jsfiddle](http://jsfiddle.net/kSMtp/)，其基本思想是使用backbone.js 来维护对列表中每个项目的引用。当然，你也可以在 vanilla JavaScript 中做到这一点。

# php - PHP/数据库表循环 - 一次只显示 15 行

> ID：10742378
> 
> 赞同：1
> 
> 时间：2012-05-24T17:25:18.447
> 
> 标签：php, sql, loops, mysqli

我有一个数据库，我试图通过 PHP 显示以进行编辑。在主页上，我只想显示表的前 15 行，然后让用户单击以生成更多表行。

```
<?php 
include('../config.php'); 
$result = $mysqli->query("SELECT uid, title, description, tblFacilityHrsDateTimes.* FROM tblFacilityHrs LEFT JOIN tblFacilityHrsDateTimes ON tblFacilityHrs.uid = tblFacilityHrsDateTimes.owner_uid ORDER BY tblFacilityHrs.title") or die($mysqli->error);
    while($row =$result->fetch_assoc()){ 
        extract ($row);
        echo "<tr>";  
            echo "<td> {$id} </td>";  //hide when finished
            echo "<td> {$title} </td>"; 
            echo "<td> {$description} </td>";
            echo "<td> {$startEventDate} </td>";
            echo "<td> {$endEventDate} </td>";
            echo "<td> {$startTime} </td>";
            echo "<td> {$endTime} </td>";
            echo "<td> {$days} </td>";
            echo "<td> {$recurrence} </td>";
            echo "<td> {$finalDate} </td>";
            echo "<td>";
            echo "<a class=\"buttons\" href=edit.php?id={$id}&uid={$uid}>Edit</a><span class='icon'></span></a>
";
            echo " / ";
            echo "<a class=\"buttons\" href='javascript: Confirm()'>Delete</a>";
            echo "</td>";
        echo "</tr>";
        echo "</div>"; 
    } 

echo "</table>";

$result->free();
$mysqli->close();

?> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T17:27:19.297

使用[`LIMIT`](http://dev.mysql.com/doc/refman/4.1/en/limit-optimization.html)：

```
"SELECT uid, title, description, tblFacilityHrsDateTimes.* FROM tblFacilityHrs LEFT JOIN tblFacilityHrsDateTimes ON tblFacilityHrs.uid = tblFacilityHrsDateTimes.owner_uid ORDER BY tblFacilityHrs.title LIMIT 15" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-24T17:28:38.430

查看[本手册页中](http://dev.mysql.com/doc/refman/5.1/en/select.html)`limit`的语法。将返回从偏移量 0 开始的 15 行（第一行）。对于第二页，您将用于获取第 16-30 行，依此类推。`select * from table limit 0,15``limit 15, 15``limit 30,15`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-24T17:40:42.827

您需要查看分页。本教程可能会有所帮助：[http ://www.php-mysql-tutorial.com/wikis/php-tutorial/paging-using-php.aspx](http://www.php-mysql-tutorial.com/wikis/php-tutorial/paging-using-php.aspx)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-24T17:49:03.977

可能你正在寻找分页，这可以通过 mysql **LIMIT来完成**

类似的东西

```
$result = $mysqli->query("SELECT uid, title, description, tblFacilityHrsDateTimes.* FROM tblFacilityHrs LEFT JOIN tblFacilityHrsDateTimes ON tblFacilityHrs.uid = tblFacilityHrsDateTimes.owner_uid ORDER BY tblFacilityHrs.title LIMIT 15, $page ") 
```

$page 用于偏移的位置

这里有一些创建自定义分页的教程

[MySQL 查询结果的分页](http://php.about.com/od/phpwithmysql/ss/php_pagination.htm)

[分页 - 它是什么以及如何做](http://www.tonymarston.net/php-mysql/pagination.html)

# actionscript - ActionScript 意外的斜杠、括号和波浪括号？

> ID：10742379
> 
> 赞同：0
> 
> 时间：2012-05-24T17:25:19.600
> 
> 标签：actionscript

我已经研究了几天的这个 ActionScript 代码现在在 JavaScript 中可以 100% 正常工作，但是当我尝试在 ActionScript 中编译它时，它说我有意外的 /、) 和 } 符号。这种语法是否错误，如果是，我应该如何解决？我想我可以将它作为 Javascript 进行测试，以便使用[http://jsfiddle.net/](http://jsfiddle.net/)进行更快的测试，但现在我喜欢 =(

```
var txt = "This is a [rainbow]test to show that I can[/rainbow] make whatever I want [rainbow]appear as a rainbow[/rainbow] because I am [rainbow]awesome[/rainbow].";

    if ((txt.indexOf("[rainbow]") > -1) && (txt.indexOf("[/rainbow]") > -1)) {
        var colors = ['f0f', 'f0c', 'f09', 'f06', 'f03', 'f00', 'f30', 'f60', 'f90', 'fc0', 'ff0', 'cf0', '9f0', '6f0', '3f0', '0f0', '0f3', '0f6', '0f9', '0fc', '0ff', '0cf', '09f', '06f', '03f', '00f', '30f', '60f', '90f', 'c0f'];

        function rainbowify(text) {
            return text.replace(/\[rainbow\](.+?)\[\/rainbow\]/g, function(_, inner) {
                return inner.replace(/./g, function(ch, i) {
                    return '<font color="#' + colors[i % colors.length] + '">' + ch + '</font>';
                });
            })
        }
        txt = rainbowify(txt);
        document.write(txt);
    }​ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T20:38:15.240

嗯，就是这样：

```
 txt = txt.replace("&apos;", "@");
if ((txt.indexOf("[rainbow]") > -1) && (txt.indexOf("[/rainbow]") > -1)) {
    var firstChar = txt.indexOf("[rainbow]") + 9;
    var lastChar = txt.indexOf("[/rainbow]");

    while (lastChar <= txt.lastIndexOf("[/rainbow]")) {
        var RAINBOWTEXT = '';
        var i = firstChar;
        while (i < lastChar) {
            RAINBOWTEXT += txt.charAt(i);
            i++
        }
        var text = RAINBOWTEXT;
        var texty = '';

        colors = new Array('ff00ff','ff00cc','ff0099','ff0066','ff0033','ff0000','ff3300','ff6600','ff9900','ffcc00','ffff00','ccff00','99ff00','66ff00','33ff00','00ff00','00ff33','00ff66','00ff99','00ffcc','00ffff','00ccff','0099ff','0066ff','0033ff','0000ff','3300ff','6600ff','9900ff','cc00ff');

        i = 0;

        while (i <= text.length) {
            var t = text.charAt(i);

            if (t != undefined) {
                texty += "<font color=\"#" + colors[i % colors.length] + "\">" + t + "</font>";
                i++;
            }
        }

        texty = texty.replace("> <", ">&nbsp;<");
        var REPLACEME = "[rainbow]" + RAINBOWTEXT + "[/rainbow]";
        txt = txt.replace(REPLACEME, texty);

        if (lastChar == txt.lastIndexOf("[/rainbow]")) {
            break;
        }
        nextChar = lastChar + 10;
        firstChar = txt.indexOf("[rainbow]", lastChar) + 9;
        lastChar = txt.indexOf("[/rainbow]", lastChar);
    }
}
txt = txt.replace("@", "&apos;"); 
```

# jsf-2 - 使用复合组件时的异常

> ID：10742388
> 
> 赞同：1
> 
> 时间：2012-05-24T17:25:52.280
> 
> 标签：jsf-2, composite-component

我是 JSF 的新手，我想创建嵌套的复合组件，问题是当我声明这些属性时（在上面的代码中）我收到这条消息***javax.servlet.ServletException: Argument is not an array***意味着属性**itemSelection** JSF 没有像数组一样考虑这个属性。如果您有一些想法可以提供帮助，我不知道我的组件是否声明得很好。谢谢。这是代码：

```
<composite:interface>
        <composite:attribute name="itemValue" default="#{utilisateurController.items}" type="javax.faces.model.ListDataModel" required="false"/>
        <composite:attribute name="itemSelection" default="#{utilisateurController.selectedItems}" type="com.netescape.entities.Utilisateur[]" required="false"/>
        <composite:attribute name="actionEdit" method-signature="java.lang.String action()" default="#{utilisateurController.prepareEdit(item)}" required="false"/>
        <composite:attribute name="actionView" method-signature="java.lang.String action()" default="#{utilisateurController.prepareView(item)}" required="false"/>
        <composite:attribute name="actionDestroy" method-signature="java.lang.String action()" default="#{utilisateurController.destroy(item)}" required="false"/>
    </composite:interface>
    <composite:implementation>
        <h:form prependId="false" id="formListUtilisateur" >

            <p:dataTable value="#{cc.attrs.itemValue}" var="item" paginator="true" rows="10"  
                         paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} 
                         {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"  
                         selection="#{cc.attrs.itemSelection}" rowKey="#{item.id}"> 
```

# c# - 为什么默认枚举值为 0 而不是最小值？

> ID：10742392
> 
> 赞同：18
> 
> 时间：2012-05-24T17:26:02.780
> 
> 标签：c#, enums

在 C# 中将“0”作为枚举的默认值有什么意义？如果我声明以不同数字开头的枚举：

```
enum Color
{
   Blue = 1,
   Green,
   Red,
} 
```

然后`var color = default(Color)`- 将返回“0”。我希望看到最小值。如果枚举的每个成员都对应于某个特定数字并且“0”不是有效值，则此行为可能会导致问题。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-24T17:29:13.647

所有值类型（包括枚举）的默认值是按位 0。因此这意味着 0 始终是枚举的可能值，即使它没有明确定义。

这是规范：[默认值表](http://msdn.microsoft.com/en-us/library/83fhsxwc.aspx)

编辑：有关更多详细信息，请查看 MSDN 的枚举类型 - [enum](http://msdn.microsoft.com/en-us/library/sbbt4032.aspx)

enum 是一种特殊的类型，它派生自其他值类型（这通常是不可能的），但表现为其支持类型的值类型。枚举只能使用一些整数值作为支持类型。

注意：正如@a​​rchil 指出的那样，枚举值可能包含任何支持类型的值，而与枚举本身枚举的常量列表无关。对于标有“FlagsAttribute”的枚举，这种行为通常是预期的，但对于普通枚举，它可能不直观。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-05-24T17:50:45.350

我们只能推测*为什么*.NET 框架的某个方面是以某种方式设计的。对于最直接的解释，我想强调[一下 MSDN 文档中的](http://msdn.microsoft.com/en-us/library/1zt1ybx4)这句话：

> 枚举是一组命名常量，其基础类型是除 Char 之外的任何整数类型。如果没有显式声明基础类型，则使用 Int32。

请注意，.NET 枚举本质上是整数类型的扩展。整数类型的默认值为 0，因此枚举继承该行为是合理的（如果在您说明的情况下有些不便）。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-05-24T17:30:02.560

枚举总是有可能具有不存在的价值。这就是[Enum.IsDefined 方法](http://msdn.microsoft.com/en-us/library/system.enum.isdefined.aspx)存在的原因。

> 枚举 E 的默认值是表达式 (E)0 产生的值。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-05-24T18:15:53.817

正如迄今为止在多个答案中所述，任何固定大小的数据结构的“默认”值都是 0。结构内存的大小设置为零，这被认为是“默认”。现在，如果您想为枚举定义自己的“默认”值，您有多种选择。最简单的方法是编写自己的函数来为您提供“最小有效枚举”

```
private E GetDefaultEnum<E>()
{
    return (E)(Enum.GetValues(typeof(E)).Cast<E>().Min<E>());
} 
```

用法：

```
enum Color
{
   Blue = 1,
   Green,
   Red,
}

Color defaultColor = GetDefaultEnum<Color>();
MessageBox.Show(defaultColor.ToString()); // "Blue" 
```

您显然可以更改确定“默认”值的方式，但这种方式似乎最适合您的需求。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-24T17:56:38.507

为什么 0 是默认枚举值？易于运行时实施。任何值类型的默认值都是按位 0，并且大概是一个空引用由按位 0 表示。因此，要初始构造一个具有其默认值的对象，我们只需要知道它的大小即可；运行时不需要知道或处理有关对象结构的任何内容。类似地，预定义的值类型构造函数只能用零填充内存范围。

不管你喜不喜欢，事情就是这样。作为回应，我们需要做的是在设计枚举时，无论名称是合适的默认值，都将其值设为 0。如果没有合适的默认值，那么接受这样一个枚举作为参数的方法可能会检查它是否正确设置，例如

```
void ProcessColor(Color c) {
    if (c == 0)
        throw new ArgumentException("Color is not set", "c");
    //...
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-24T17:28:42.520

关键*可能*在于具有较少的正整数可能值。

为什么不那么*积极*？

为了能够正确地处理带有位移操作的枚举。

我自然是在谈论默认值，可以由开发人员更改。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-24T17:55:46.390

我不知道*为什么*，但是...

这是关于 C# 枚举的文档：http: [//msdn.microsoft.com/en-us/library/sbbt4032.aspx](http://msdn.microsoft.com/en-us/library/sbbt4032.aspx)

> 枚举器可以使用初始化器来覆盖默认值，如下例所示。
> 
> enum Days {Sat=1, Sun, Mon, Tue, Wed, Thu, Fri};
> 
> 在此枚举中，元素的序列被强制从 1 而不是 0 开始。但是，建议包含一个值为 0 的常量。有关详细信息，[请参阅枚举类型（C# 编程指南）](http://msdn.microsoft.com/en-us/library/cc138362.aspx)。

他们建议您始终包含一个与值 0 相对应的占位符枚举值，否则您可能会遇到问题。您可以将此枚举值命名为类似`Undefined`或`Default`类似的名称。

正如我在对您的问题的评论中提到的那样，我的建议是根本不要为您的枚举使用值，**除非**您有充分的理由这样做。如果需要，请遵循[MSDN Programming Guide for Enumeration Types](http://msdn.microsoft.com/en-us/library/cc138362.aspx)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-05-24T18:00:09.333

`enum`是`int`（默认情况下）。对于我们的源代码，枚举是人类可读的整数，但是当你的程序被编译时，没有s `enum`，只有`int`s。int 的默认值为 0。

这段代码：

```
public enum test { One, Two, Three }

var x = test.One;
var y = 0; 
```

在 IL 中变成这样：

```
IL_0001:  ldc.i4.0   
IL_0002:  stloc.0     
IL_0003:  ldc.i4.0    
IL_0004:  stloc.1 
```

那么，在某些情况下（如您所问），在其他情况下怎么可能`int`有默认值 1，但在其他情况下却没有呢？

# jquery - 流畅的 jQuery 页面转换

> ID：10742399
> 
> 赞同：0
> 
> 时间：2012-05-24T17:26:28.360
> 
> 标签：jquery, html, optimization, transition

所以这是我的问题：我正在设计一个使用 jQuery 转换网页主框架的网站。索引页面有一个高度为 450 的横幅，当转到其他页面时会减小到 200 像素。主页上有一个按钮（大约向下一页），应该滚动回到页面顶部，然后执行页面转换。这里的问题是，每当我单击按钮时，它会在向上滚动时进行页面转换，从而使它看起来像一个草率的转换。

这是我的函数调用：

```
$('a[href=#services]').click(function(){
    $('html, body').animate({scrollTop:0}, 'slow').delay(1500).animate({scrollTop:0}, 'slow');
    $.indexClear();
    $.serviceSET();
    $.servicelinkSET();
    return false;
}); 
```

函数调用全部由 hide() 和 fadeIn() 组成，仅此而已。任何的想法？此外，延迟功能似乎无法正常工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T17:33:22.213

我在任何地方都看不到您的左右滚动代码，但听起来您需要在回调中执行此操作。一旦动画到页面顶部完成，运行左/右代码。

```
$('element').animate({scrollTop: 0}, function() {
    //callback is called when first animation finishes
    $('element2').animate({left: 100});
}); 
```

# c - 使用函数在 C 中操作结构

> ID：10742400
> 
> 赞同：-2
> 
> 时间：2012-05-24T17:26:29.453
> 
> 标签：c, arrays, pointers, struct

我正在尝试使用函数来操作声明为全局指针的动态分配矩阵，为简单起见，我不会在此处粘贴代码，但我将提供一个等效且可能更清晰的示例

```
structname **variable;

int main()
{
    variable = readfile("filename");
    variable = modify(variable);
    output(variable);
} 
```

这看起来很简单，输入和输出工作正常，问题是我的“修改”函数没有做任何修改，这是一个例子：

```
structname **modify(structname **p)
{
  swapitems(p[x][y],p[j][z]);
  modifyitem(p[x][y]);
  return p;
} 
```

和

```
void swapitems(structname a, structname b)
{
     structname buffer;

     buffer = b;
     b = a;
     a = buffer;
} 
```

我想问题是我不能将元素传递给类似`swapitems`的`modifyitem`东西，我如何使用类似的函数来修改项目`modify`？（当然没有编译错误）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T17:35:54.947

由于您实际上将结构本身作为参数传递，因此您只是交换哪些堆栈位置具有哪个结构，然后当您返回它时不会影响原始数组。您可以通过传入数组中结构的实际地址来解决此问题：

```
void swapitems(structname* a, structname *b){

    structname buffer;

    buffer = *b;
    *b = *a;
    *a = buffer;
} 
```

那么函数调用应该是

```
swapitems(&p[x][y],&p[j][z]); 
```

您还应该同样将您正在修改的项目的地址传递到`modifyitem`

# continuous-integration - Jenkins：如何在参数化构建中制作所需的参数？

> ID：10742401
> 
> 赞同：28
> 
> 时间：2012-05-24T17:26:32.223
> 
> 标签：continuous-integration, jenkins

在 Jenkins 中是否有一个用于参数化构建的插件来制作所需的参数？标准“此构建已参数化”选项下的字段似乎没有提供。

澄清：“必需”是指在该字段填充了一个值之前，构建不会执行。这显然会排除自动触发器。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2019-02-19T08:54:14.623

接受的答案不再有效。

有一个[插件可以做到这一点，](https://wiki.jenkins.io/display/JENKINS/Validating+String+Parameter+Plugin)但不再维护。

有一个[开放的错误来支持它](https://issues.jenkins-ci.org/browse/JENKINS-3509)。

同时，您可以做的是检查您的参数是否存在，如果不存在则抛出如下错误：

```
if (params.SomeParam == null) {
    error("Build failed because of this and that..")
} 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-05-24T17:40:39.567

这是我用来做这类事情的插件：[链接](https://wiki.jenkins-ci.org/display/JENKINS/Validating+String+Parameter+Plugin)......
你可以设置一个正则表达式来验证输入

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2020-02-18T07:31:53.867

无法评论回答米格尔的问题，所以在这里回答：

如果未设置参数，要使构建失败，可以执行以下操作：

```
stage('Checkout') 
    {
        steps
        {
            checkout scm
            script 
            {
                if (params.myParam == '') { // and/or whatever condition you want
                    currentBuild.result = 'ABORTED'
                    error('myParam not set')
                }
            }
        }
    } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2022-01-06T20:44:39.637

有一个名为“验证字符串参数”的插件。当您在项目中安装此插件时，您会在添加参数时看到验证字符串参数的附加选项。使用此选项将显示正则表达式的附加列。对于非空字符串参数，在正则表达式字段中写入：

```
^(?!\s*$).+ 
```

这最终将使您的字符串参数成为必需的。

# python - 以编程方式将列名添加到 numpy ndarray

> ID：10742406
> 
> 赞同：14
> 
> 时间：2012-05-24T17:26:49.950
> 
> 标签：python, arrays, numpy, multidimensional-array

我正在尝试将列名添加到 numpy ndarray，然后按名称选择列。但它不起作用。我不知道是在添加名称时出现问题，还是在稍后尝试调用它们时出现问题。

这是我的代码。

```
data = np.genfromtxt(csv_file, delimiter=',', dtype=np.float, skip_header=1)

#Add headers
csv_names = [ s.strip('"') for s in file(csv_file,'r').readline().strip().split(',')]
data = data.astype(np.dtype( [(n, 'float64') for n in csv_names] )) 
```

基于维度的诊断符合我的预期：

```
print len(csv_names)
>> 108
print data.shape
>> (1652, 108) 
```

“print data.dtype.names”也返回预期的输出。

但是，当我开始按字段名称调用列时，就会发生一些奇怪的事情。“列”仍然是一个包含 108 列的数组...

```
print data["EDUC"].shape
>> (1652, 108) 
```

...并且它似乎包含比数据集中的行更多的缺失值。

```
print np.sum(np.isnan(data["EDUC"]))
>> 27976 
```

知道这里出了什么问题吗？添加标题应该是一个微不足道的操作，但我已经与这个错误作斗争了几个小时。帮助！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-25T08:07:36.770

问题是您正在考虑类似电子表格的数组，而 NumPy 确实使用不同的概念。

以下是您必须了解的有关 NumPy 的信息：

1.  NumPy 数组只包含**单一类型**的元素。
2.  如果您需要类似电子表格的“列”，则此类型必须是**类似元组的类型**。这样的数组称为结构化数组，因为它们的元素是结构（即元组）。

在您的情况下，NumPy 将因此获取您的二维常规数组并生成一个*一*维数组，其类型是 108 个元素的元组（您正在考虑的电子表格数组是二维的）。

这些选择可能是出于效率原因：数组的所有元素都具有相同的类型，因此具有相同的大小：它们可以在低级别非常简单和快速地访问。

现在，正如 user545424 所示，对于您想要做的事情有一个简单的 NumPy 答案（`genfromtxt()`接受`names`带有列名的参数）。

如果要将数组从常规 NumPy ndarray 转换为结构化数组，可以执行以下操作：

```
data.view(dtype=[(n, 'float64') for n in csv_names]).reshape(len(data)) 
```

（你很接近：你用`astype()`而不是`view()`）。

您还可以查看很多 Stackoverflow 问题的答案，包括[将 2D numpy 数组转换为结构化数组](https://stackoverflow.com/questions/3622850/converting-a-2d-numpy-array-to-a-structured-array)以及[如何将常规 numpy 数组转换为记录数组？](https://stackoverflow.com/questions/7724711/how-to-convert-regular-numpy-array-to-record-array).

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-24T18:15:07.280

不幸的是，当您尝试添加字段名称时，我不知道发生了什么，但我知道您可以通过以下方式直接从文件中构建您想要的数组

```
data = np.genfromtxt(csv_file, delimiter=',', names=True) 
```

编辑：

似乎添加字段名称仅在输入是元组列表时才有效：

```
data = np.array(map(tuple,data), [(n, 'float64') for n in csv_names]) 
```

# qt - 将小部件添加到 QString 中指定的布局

> ID：10742407
> 
> 赞同：1
> 
> 时间：2012-05-24T17:26:53.967
> 
> 标签：qt

我在 Qt 中开始了我的第一步编程，但找不到答案。我有一些小部件，假设它被命名为“标签”。我想在它的布局中添加新的小部件。我可以通过写来做到这一点：

```
QLabel *label = new QLabel(tab); 
```

我想做同样的事情，但我不想说“tab”，而是想使用存储在 QString 变量中的小部件名称。像这样的东西（但它不起作用，不能将 QString 转换为 QWidget）：

```
QString name = "tab";
QLabel *label = new label(zakladka); 
```

可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T17:42:05.263

QObjects 有一个属性`objectName`。因此，如果您命名您的对象并让它们成为 QObject 层次结构的一部分（即您知道它们是父对象的子对象），您可以使用[findChild](http://qt-project.org/doc/qt-4.8/qobject.html#findChild)

```
QLabel* label = new QLabel(parentWidget->findChild(name)); 
```

# css - 为同一类中的 2 个不同图像提供两个不同的位置

> ID：10742410
> 
> 赞同：1
> 
> 时间：2012-05-24T17:27:10.390
> 
> 标签：css

有没有办法在同一个班级中给 2 张图像不同的位置？

```
<div class="image">
 <img src="image1.jpg">
 <img src="image2.jpg">
</div> 
```

CSS：

```
.image img {
 top: 100px;
} 
```

是否可以在同一类中为 image1 赋予与 image2 不同的位置值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T17:30:54.443

是的，您选择使用的第一个图像`.image img:first-child`并设置不同的最高值 - 类似于`.image img:first-child { top: 50px; }`

# php - 合并数组中的数组，保留数字索引

> ID：10742411
> 
> 赞同：0
> 
> 时间：2012-05-24T17:27:12.263
> 
> 标签：php, arrays

Array_merge 和 array_merge_recursive 没有按预期工作，创建更多索引而不是将数组推到一起并保留索引号。请参阅下面的输入/所需输出：

```
Array (
    [0] => array(
        [0] => "string1",
        [1] => "string2",
        [2] => "string3"
    ),
    [1] => array(
        [0] => "string4",
        [1] => "string5",
        [2] => "string6"
    ),
    [2] => array(
        [0] => "string7",
        [1] => "string8",
        [2] => "string9"
    )
) 
```

期望的输出：

```
Array (
    [0] => array("string1","string4","string7"),
    [1] => array("string2","string5","string8"),
    [2] => array("string3","string6","string9")

) 
```

编辑：

也许不是最好的例子；我想获得相同的结果，但每个嵌套数组中的键数不相等。请参阅下面的更好示例：

```
<?php
$array = Array (
[0] => array(
    [0] => "string1",
    [1] => "string2",
    [2] => "string3"
    ),
[1] => array(
    [0] => "string4",
    [1] => "string5",
    [2] => "string6"
    ),
[2] => array(
    [0] => "string7",
    [1] => "string8",
    [2] => "string9"
    ),
[3] => array(
    [0] => "string10",
    [1] => "string11",
    [2] => "string12"
    )
);

$output=array();
    for($0=0;$j<count($array[0]);$j++){
        $output[$j] = array();
    }

for($i=0;$i<count($array);$i++){
    for($0=0;$j<count($array[0]);$j++){
        $output[$j] = array_push($output[$j],$column_values[$i][$j]);
    }
}

?> 
```

但是当我这样做时，我在 $output 数组中得到了正确数量的键，但它们都包含一个 bool(false)。有什么帮助吗？

这是所需的输出：

```
Array (
    [0] => array("string1","string4","string7","string10"),
    [1] => array("string2","string5","string8","string11"),
    [2] => array("string3","string6","string9","string12")
) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T18:50:04.930

这是为这种数组结构制作一个数组，因此您可以根据需要更改代码...

```
<pre>
<?php
    $array = array(array("string1","string2","string3"),array("string4","string5","string6"),array("string7","string8","string9"));
    $output=array();
    for($i=0;$i<count($array[0]);$i++){
        for($j=0;$j<count($array[0]);$j++){
            $output[$i][$j] = $array[$j][$i];
        }
    }

    print_r($output);
?>
</pre> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T19:25:58.427

知道了。最后一个循环应该简单地`array_push($output[$j],$column_values[$i][$j]);`而不是试图设置变量`$output[$j] = array_push(Yadda,yadda)`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T22:51:40.013

这是针对您的“第二种”情况：

```
<?php

    $array = array(array("string1","string2","string3"),array("string4","string5","string6"),array("string7","string8","string9"),array("string10","string11","string12"));
    $output=array();

    for($i=0;$i<count($array[0]);$i++){
        for($j=0;$j<=count($array[0]);$j++){
            $output[$i][$j] = $array[$j][$i];
        }
    }
    print_r($output);
?> 
```

# ruby-on-rails - 托管多个低命中 Rails/sinatra 应用程序的最佳 Web/应用程序服务器

> ID：10742415
> 
> 赞同：2
> 
> 时间：2012-05-24T17:27:30.877
> 
> 标签：ruby-on-rails, webserver, hosting

我需要托管许多不同 ruby​​ 版本的简单 rails/sinatra/padrino 应用程序，每个应用程序每天的点击量为 0..low。它们属于不同的所有者，应该相互隔离。

当一个应用程序被点击时，它应该会在相当短的时间内做出响应，但我预计几个同时访问者同时访问同一个站点的情况很少见。

我将为每个应用程序创建单独的操作系统用户。当然，我想在每台服务器上尽可能多地放置它们。因此，我需要选择内存占用最少的 Web 服务器，它可以代表具有不同 ruby​​ 版本和 gemset 的不同用户运行应用程序。

我考虑 webrick、nginx+passenger、thin、apache+passenger。我想所有选择的可靠性都足以完成这样的工作，虽然性能不是问题，但内存消耗才是。

我发现了很多关于性能问题的帖子，但其中大多数都讨论了性能调整和问题。我找不到空闲时 Web 服务器内存使用情况的比较。

“进行中”webrick 是最佳选择吗？你会选择哪一个来做这份工作？

而且我不知道如何使用 webrick 将子域解析为应用程序端口。我应该使用 nginx 还是 apache？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T17:39:44.170

我没有太多托管自己的经验，但我认为使用 Webrick 进行生产并不是一个好主意。您还可以查看我在生产中看到的 mongrel。在大多数情况下，您可能希望在瘦身和独角兽之间进行选择。看看这个[http://cmelbye.github.com/2009/10/04/thin-vs-unicorn.html](http://cmelbye.github.com/2009/10/04/thin-vs-unicorn.html)或谷歌。祝你好运 ：-）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T12:44:20.333

为什么不使用 Heroku？它是免费的，让您摆脱服务器配置和维护的麻烦。

# android - 在 Android 的 DownloadManager 中设置请求正文？

> ID：10742417
> 
> 赞同：11
> 
> 时间：2012-05-24T17:27:43.673
> 
> 标签：android, download-manager

对于我的应用程序的下一步，我需要添加下载功能。用户可以选择他们想要下载的内容，并且可以选择从 1 个文件到数千个文件中的任何内容，如果他们不愿意选择那么多的话。

我想使用 Android 的内置 DownloadManager 来提供此下载功能，但不幸的是我看不到如何为我的场景实现它。

为了让目标服务器授权下载，我需要在请求正文中发送一些 JSON。像这样，如果我是手动做的：

```
DataOutputStream 输出 = new DataOutputStream(connection.getOutputStream());
output.writeBytes(rawData);
输出.flush();
```

`rawData`JSON 字符串在哪里。请求正文始终设置为`POST`.

我似乎找不到任何方法将此 JSON 字符串添加到 DownloadManager，并且在我能做到之前，服务器将始终拒绝下载。

我能想到的唯一其他解决方案，我非常想避免，是在我的服务器上编写一个 PHP 脚本来获取一些`GET`参数，生成 JSON，然后重定向请求。

有人知道我可以将我的 JSON 数据与 DownloadManager 一起发送吗？我正在下载的每个文件都需要自己的唯一 JSON 字符串。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2020-05-28T13:14:30.467

您不能在 Android 的下载管理器中执行此操作，[请参阅下载管理器问题](https://issuetracker.google.com/issues/36909335)，我有类似的要求，我最终使用了 HttpClient (Xamarin)。

示例代码-

```
using(var httpClient = new HttpClient()) {
  using(var request = new HttpRequestMessage(new HttpMethod("POST"), URL)) {
   request.Headers.TryAddWithoutValidation("User-Agent", userAgent);
   request.Headers.TryAddWithoutValidation("Accept", "text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8");
   request.Headers.TryAddWithoutValidation("Accept-Language", "en-US,en;q=0.5");
   request.Headers.TryAddWithoutValidation("Connection", "keep-alive");
   request.Headers.TryAddWithoutValidation("Referer",RefererURL);
   request.Content = new StringContent("YOUR_REQUEST_BODY_HERE");
   request.Content.Headers.ContentType = MediaTypeHeaderValue.Parse("application/x-www-form-urlencoded");

   var responser = await httpClient.SendAsync(request);
   return responser;
  } 
```

# javascript - 防止浏览器在 HTML5 History popstate 上滚动

> ID：10742422
> 
> 赞同：89
> 
> 时间：2012-05-24T17:28:00.783
> 
> 标签：javascript, html, dom-events, browser-history

是否可以防止在 popstate 事件发生时滚动文档的默认行为？

我们的网站使用 jQuery 动画滚动和 History.js，状态更改应该通过 pushstate 或 popstate 将用户滚动到页面的不同区域。问题是当popstate事件发生时，浏览器会自动恢复之前状态的滚动位置。

我尝试使用一个容器元素设置为文档的 100% 宽度和高度并滚动该容器内的内容。我发现的问题是它似乎不像滚动文档那么流畅。特别是如果使用大量的 css3，比如 box-shadows 和渐变。

我还尝试在用户启动滚动期间存储文档的滚动位置，并在浏览器滚动页面后恢复它（在 popstate 上）。这在 Firefox 12 中运行良好，但在 Chrome 19 中，由于页面正在滚动和恢复，会出现闪烁。我认为这与滚动和被触发的滚动事件（滚动位置恢复）之间的延迟有关。

Firefox 在 popstate 触发之前滚动页面（并触发 scroll 事件），Chrome 首先触发 popstate，然后滚动文档。

我见过的所有使用历史 API 的网站要么使用与上述类似的解决方案，要么在用户返回/前进时忽略滚动位置的变化（例如 GitHub）。

是否可以在 popstate 事件中完全防止文档滚动？

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2015-10-08T01:01:40.273

```
if ('scrollRestoration' in history) {
  history.scrollRestoration = 'manual';
} 
```

（[谷歌](https://developers.google.com/web/updates/2015/09/history-api-scroll-restoration)于 2015 年 9 月 2 日宣布）

**浏览器支持：**

Chrome：支持（从 46 开始）

Firefox：支持（从 46 开始）

IE：不支持

边缘：支持（从 79 开始）

Opera：支持（33 起）

Safari：支持

有关详细信息，请参阅[MDN 上的浏览​​器兼容性](https://developer.mozilla.org/en-US/docs/Web/API/History#Browser_compatibility)。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2012-08-20T21:05:14.717

[一年多来，](https://bugzilla.mozilla.org/show_bug.cgi?id=679458)这个问题一直是 Mozilla 开发者核心的一个报告问题。不幸的是，票并没有真正进展。我认为 Chrome 是一样的：没有可靠的方法来`onpopstate`通过 js 处理滚动位置，因为它是本机浏览器行为。

但是，如果您查看[HTML5 历史规范](http://www.whatwg.org/specs/web-apps/current-work/multipage/history.html)，那么未来还是有希望的，它明确希望滚动位置在状态对象上表示：

> 历史对象将其浏览上下文的会话历史表示为会话历史条目的平面列表。每个会话历史条目由一个 URL 和一个可选的状态对象组成，并且可能还具有标题、文档对象、表单数据、滚动位置以及与其相关的其他信息。

这一点，如果您阅读了上面提到的 Mozilla 票证上的评论，则表明在不久的将来滚动位置可能不会再恢复`onpopstate`，至少对于使用`pushState`.

不幸的是，在此之前，滚动位置在使用时被存储`pushState`，并且`replaceState`不会替换滚动位置。否则，这将相当容易，并且您可以`replaceState`在每次用户滚动页面时使用设置当前滚动位置（使用一些谨慎的 onscroll 处理程序）。

同样不幸的是，HTML5 规范没有具体说明何时`popstate`必须触发该事件，它只是说：“在导航到会话历史记录条目时在某些情况下触发”，它没有明确说明它是之前还是之后；如果它总是在之前，则可以解决处理 popstate 之后发生的滚动事件的解决方案。

**取消滚动事件？**

此外，如果滚动事件可以取消，这也很容易，但事实并非如此。如果是这样，您可以取消系列的第一个滚动事件（用户滚动事件就像旅鼠一样，它们有几十个，而历史重新定位触发的滚动事件是一个），您会没事的。

**暂时没有解决办法**

据我所知，我现在唯一推荐的是等待 HTML5 规范完全实现并在这种情况下随浏览器行为滚动，这意味着：当浏览器允许时为滚动设置动画，并让浏览器在有历史事件时重新定位页面。**唯一可以影响位置的事情是`pushState`当页面以一种好的方式定位时使用。**任何其他解决方案要么必然有错误，要么过于特定于浏览器，或两者兼而有之。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-20T11:16:08.333

You're going to have to use some kind of horrible browser sniffing here. For Firefox, I would go with your solution of storing the scroll position and restoring it.

I thought I had a good Webkit solution based on your description, but I just tried in Chrome 21, and it seems that Chrome scrolls first, then fires the popstate event, then fires the scroll event. But for reference, here's what I came up with:

```
function noScrollOnce(event) {
    event.preventDefault();
    document.removeEventListener('scroll', noScrollOnce);
}
window.onpopstate = function () {
    document.addEventListener('scroll', noScrollOnce);
};​ 
```

Black magic such as pretending the page is scrolling by moving an `absolute` positioned element is ruled out by the screen repainting speed too.

So I'm 99% sure that the answer is that you can't, and you're going to have to use one of the compromises you've mentioned in the question. Both browsers scroll before JavaScript knows anything about it, so JavaScript can only react after the event. The only difference is that Firefox doesn't paint the screen until after the Javascript has fired, which is why there's a workable solution in Firefox but not in WebKit.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-12-25T16:18:34.877

现在你可以做

```
history.scrollRestoration = 'manual'; 
```

这应该可以防止浏览器滚动。这目前仅适用于 Chrome 46 及更高版本，但似乎 Firefox 也计划支持它

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-06-06T13:01:35.517

解决方案是使用`position: fixed`并指定`top`等于页面的滚动位置。

这是一个例子：

```
$(window).on('popstate', function()
{
   $('.yourWrapAroundAllContent').css({
      position: 'fixed',
      top: -window.scrollY
   });

   requestAnimationFrame(function()
   {
      $('.yourWrapAroundAllContent').css({
         position: 'static',
         top: 0
      });          
   });
}); 
```

是的，您会收到闪烁的滚动条，但它不那么邪恶。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-06-21T13:48:49.007

将 scrollRestoration 设置为手动对我不起作用，这是我的解决方案。

```
window.addEventListener('popstate', function(e) {
    var scrollTop = document.body.scrollTop;
    window.addEventListener('scroll', function(e) {
        document.body.scrollTop = scrollTop;
    });
}); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-10-20T15:41:17.413

以下修复应该适用于所有浏览器。

您可以在卸载事件上将滚动位置设置为 0。您可以在此处阅读有关此事件的信息： [https](https://developer.mozilla.org/en-US/docs/Web/Events/unload) ://developer.mozilla.org/en-US/docs/Web/Events/unload 。本质上，卸载事件会在您离开页面之前触发。

通过在卸载时将 scrollPosition 设置为 0 意味着当您以设置的 pushState 离开页面时，它将 scrollPosition 设置为 0。当您通过刷新或按下返回到此页面时，它不会自动滚动。

```
//Listen for unload event. This is triggered when leaving the page.
//Reference: https://developer.mozilla.org/en-US/docs/Web/Events/unload
window.addEventListener('unload', function(e) {
    //set scroll position to the top of the page.
    window.scrollTo(0, 0);
}); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-08-01T19:41:15.537

就像其他人说的那样，没有真正的方法可以做到，只有丑陋的hacky方式。删除滚动事件侦听器对我不起作用，所以这是我的丑陋方法：

```
/// GLOBAL VARS ////////////////////////
var saveScrollPos = false;
var scrollPosSaved = window.pageYOffset;
////////////////////////////////////////

jQuery(document).ready(function($){

    //// Go back with keyboard shortcuts ////
    $(window).keydown(function(e){
        var key = e.keyCode || e.charCode;

        if((e.altKey && key == 37) || (e.altKey && key == 39) || key == 8)
        saveScrollPos = false;
    });
    /////////////////////////////////////////

    //// Go back with back button ////
    $("html").bind("mouseout",  function(){ saveScrollPos = false; });
    //////////////////////////////////

    $("html").bind("mousemove", function(){ saveScrollPos = true; });

    $(window).scroll(function(){
        if(saveScrollPos)
        scrollPosSaved = window.pageYOffset;
        else
        window.scrollTo(0, scrollPosSaved);
    });

}); 
```

它适用于 Chrome、FF 和 IE（第一次返回 IE 时它会闪烁）。欢迎任何改进建议！希望这可以帮助。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-01-05T17:42:01.533

在页面顶部的某处创建一个“跨度”元素，并在加载时将焦点设置为该元素。浏览器将滚动到焦点元素。我知道这是一种解决方法，并且专注于“跨度”不适用于所有浏览器（uhmmm.. Safari）。希望这可以帮助。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-02-04T13:04:13.620

这是我在一个网站上实现的，该网站希望在触发 poststate 时将滚动位置聚焦到特定元素（后退按钮）：

```
$(document).ready(function () {

     if (window.history.pushState) {
        //if push supported - push current page onto stack:
        window.history.pushState(null, document.title, document.location.href);
    }

    //add handler:
    $(window).on('popstate', PopStateHandler);
}

//fires when the back button is pressed:
function PopStateHandler(e) {
    emnt= $('#elementID');
    window.scrollTo(0, emnt.position().top);
    alert('scrolling to position');
} 
```

经过测试并在 Firefox 中工作。

Chrome 将滚动到某个位置，然后重新定位回原来的位置。

* * *

## 回答 #11

> 赞同：-5
> 
> 时间：2012-08-15T22:00:31.090

Might want to try this?

```
window.onpopstate = function(event) {
  return false;
}; 
```

# ant - 我的 ant signjar 任务似乎正在更改我的密码

> ID：10742429
> 
> 赞同：1
> 
> 时间：2012-05-24T17:28:13.013
> 
> 标签：ant, jar-signing, jarsigner

当我尝试用这一行签署一个罐子时：

```
jarsigner -storetype pkcs12 -keystore cert_comodo.pfx MyJar.jar "le-01234567-0123-0123-0123-0123456789ab" 
```

它提示我输入密码，一切正常。当我尝试用这个蚂蚁目标签署它时：

```
<target name="sign_jars" depends="obfuscated_jar">
    <signjar 
            keystore="cert_comodo.pfx"
            alias="le-01234567-0123-0123-0123-0123456789ab"
            storepass="A, pa$$." <Not my real password or alias, btw>
            storetype="pkcs12">
        <path>
            <fileset dir="." includes="*.jar" />
        </path>
    </signjar>
</target> 
```

我收到此错误：

```
[signjar] jarsigner error: java.lang.RuntimeException: keystore load: failed t
o decrypt safe contents entry: javax.crypto.BadPaddingException: Given final blo
ck not properly padded 
```

如果我输入错误的密码，这与我得到的错误相同。

我的密码中的字符是否`$`被 Ant 修改了？有没有办法可以欺骗 ant 让我以交互方式输入密码？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T18:00:15.423

该问题很可能是由于将其视为转义的 single ，因此将实际密码字符串传递给`ant`jarsigner 。如果问题仍然存在，请尝试将密码更改为 2秒以进行转义。`$$``$``A, pa$``A, pa$$$$``$`

[来自Apache Ant™ 任务设计指南](https://ant.apache.org/ant_task_guidelines.html)的一些附加文档：

> ... Ant 1.5 通过字符串传递单个美元符号“$”；Ant 1.4 及之前版本会剥离它。为了得到这个修复，我们首先必须编写测试套件来公开当前行为，然后改变一些东西，使单个“$”通过，但双“$$”映射到“$”以实现向后兼容性。

# visual-studio-2010 - Ghost doc 添加“修改者”注释

> ID：10742443
> 
> 赞同：1
> 
> 时间：2012-05-24T17:28:52.363
> 
> 标签：visual-studio-2010, ghostdoc

有没有办法让 ghost doc 修改方法的现有 XML 注释（由 Ghost doc 制作）以在您重新运行该方法时添加“修改者”行？

我个人认为这就是源代码控制的用途，但他们想在 XML 中做到这一点，所以这是一个新的工作要求。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T06:39:33.460

（披露：我代表提供 GhostDoc 的公司）

我同意你的观点，“修改者”属于源代码控制而不是 XML 注释。

但是，如果您仍然想使用 GhostDoc 完成它，您可以使用标签在 Options 中对“修改者”进行硬编码。不过，这不会动态设置当前日期/时间。

如果您需要当前日期/时间选项，您可以仅使用 GhostDoc Pro 完成此操作 - 使用其基于 T4 模板的注释来配置具有当前时间的 BCL DateTime.Now 函数的“修改者”注释/部分。

我希望这有帮助。

# php - Facebook OAuthException：无法解密访问令牌

> ID：10742445
> 
> 赞同：15
> 
> 时间：2012-05-24T17:28:57.350
> 
> 标签：php, facebook, facebook-graph-api

我有一个正在运行的应用程序，它代表用户向他们的一位朋友发送预定的墙贴。

该应用程序在很长一段时间内运行良好，但最近一些用户报告消息未发布。

日志显示

```
OAuthException: The access token could not be decrypted. 
```

即使用户重新访问应用程序并重置其访问令牌，异常仍然存在。

错误的根源和解决方法可能是什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-22T07:14:40.863

如果您在向 Facebook API 发出 HTTP 请求时收到以下错误消息：

```
{
  "error": {
       "message": "The access token could not be decrypted",
       "type": "OAuthException",
       "code": 190
  }
} 
```

这意味着**您在发出 HTTP 请求时发送给 Facebook 的访问令牌*无效*。**

如果您查看**HTTP 响应标头**，您将看到如下字段：

```
WWW-Authenticate:OAuth "Facebook Platform" "invalid_token" "The access token could not be decrypted" 
```

我收到上述错误是因为我发送的访问令牌比有效令牌短 1 个字符。
在将访问令牌与我发送的令牌进行比较后，我发现了这个错误。

[您可以使用Access Token Debugger](https://developers.facebook.com/tools/debug/access_token)检查 Facebook 上使用的 OAuth 2.0 访问令牌（不记名令牌）的有效性。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-08-18T08:31:55.907

Facebook 令牌的大小正在增加，并且不再限制为 255 个字符，因此如果您使用大小有限的变量或数据库字段，存储它们的方式可能会导致异常。

这在此 Facebook 文档的最后一部分中指定：[https ://developers.facebook.com/docs/facebook-login/access-tokens](https://developers.facebook.com/docs/facebook-login/access-tokens)

> **尺寸**
> 
> 预计随着 Facebook 更改其中存储的内容以及它们的编码方式，所有类型的访问令牌的大小都会随着时间而变化。您可以预期它们会随着时间的推移而增长和缩小。请使用没有特定最大大小的可变长度数据类型来存储访问令牌。

例如，在 SQL 中存储令牌，您可以避免使用 VARCHAR 并改用 TEXT 或 BLOB

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-30T07:50:07.203

这可能是因为令牌在保存到数据库之前进行了修剪。或字段大小小于令牌章程大小。在 {variable} 表中检查一次以获取正确和完整的令牌。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-08T14:45:48.683

在我的情况下，这是由于我向“我”发出请求时 accessToken 不包含用户 ID（我假设它试图从令牌中确定用户 ID）。

令牌调试器响应：

```
App ID: 
<ID> :   <app>
User ID: Unknown
Issued:  Unknown
Expires: 1339171200 (in about an hour)
Valid:   True
Origin:  Web
Scopes: 
```

为了解决这个问题，我没有请求“我”，而是请求了 userID 的配置文件，我可以直接从 authResponse 访问该配置文件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-08-08T00:05:25.177

当访问令牌长度不正确时，通常会发生此错误。验证令牌的格式。

# casting - D中的整数到字符串转换

> ID：10742449
> 
> 赞同：14
> 
> 时间：2012-05-24T17:29:07.613
> 
> 标签：casting, d, phobos

我如何在 D 中将整数转换为字符串？就像是

```
int i = 15
string message = "Value of 'i' is " ~ toString(i); // cast(string) i - also does not work 
```

谷歌为我提供了如何使用 tango 的答案，但我想要 phobos 版本。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-05-24T17:32:08.653

```
import std.conv;

int i = 15;
string message = "Value of 'i' is " ~ to!string(i); 
```

或`format`：

```
import std.string;
string message = format("Value of 'i' is %s.", i); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-24T17:31:55.760

`to`从 std.conv使用：

```
int i = 15
string message = "Value of 'i' is " ~ to!string(i); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-27T07:28:43.287

```
import std.conv;
auto i = 15;
auto message = text("Value of 'i' is ", i); 
```

还有 wtext 和 dtext 变体，女巫返回 wstring 和 dstring。

# groovy - Groovy DSL：在闭包中设置属性

> ID：10742450
> 
> 赞同：2
> 
> 时间：2012-05-24T17:29:08.360
> 
> 标签：groovy, map, dsl, ternary-operator

我想在我的 DSL 中为规则实现一个“活动”标志。这是我希望它的样子：

```
Shipping("Standard") {
    active: true
    description: "some text"

    rules {
      ... define rules here
    }
} 
```

以下是我按照几个教程让一切运行的方法：

```
Script dslScript = new GroovyShell().parse(new File("Standard"))

dslScript.metaClass.Shipping = { String name, Closure cl ->
  ShippingDelegate delegate = new ShippingDelegate()
  delegate.name = name
  cl.delegate = delegate
  cl.setResolveStrategy Closure.DELEGATE_FIRST
  cl()
}

dslScript.run() 
```

ShippingDelegate 很简单：

```
class ShippingDelegate {

  String name

  void rules(Closure cl) {
    ... do stuff here
  }
} 
```

这一切都运行良好，没有投诉，但我怎样才能访问“活动”或“描述”？

无论如何，这种语法实际上做了什么？它看起来像一个地图分配，但没有。还是 groovy 编译器将其视为不完整的三元运算符？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-25T20:59:08.023

我可以建议对您的 DSL 进行一些小改动，以便简化您的设计吗？

**已编辑，在您的示例中不清楚您是否有多个运输实例。在我的第二次尝试中，我认为答案是肯定的**

```
class ShippingRules {
    boolean active
    String description
    String name

    ShippingRules(String name) {
        this.name=name
    }

    def rules(Closure c) {
        c.delegate=this
        c()
    }
}

abstract class ShippingRulesScript extends Script {
    def shipppingRules =[]

    def shipping(String name, Closure c) {
        def newRules=new ShippingRules(name)
        shipppingRules << newRules
        c.delegate=newRules
        c()
    }
}

def cfg= new CompilerConfiguration(
    scriptBaseClass:ShippingRulesScript.name
)
Script dslScript = new GroovyShell(cfg).parse(new File("Standard"))

dslScript.run() 
```

DSL应该改成这样：

```
shipping("Standard") {
    active= true
    description= "some text"

    rules {
      ... define rules here
    }
}
shipping("International") {
    active= true
    description= "some text"

    rules {
      ... define rules here
    }
} 
```

即失去运输的资本，并使用分配而不是冒号。

然后，您稍后可以从 dslScript shippingRules 变量中检索运输规则。

**免责声明：**我现在无法测试我的代码，因此代码中可能有一些拼写错误，但您明白了：使用一个基类，您可以在其中为脚本提供规则和属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-02T09:58:59.180

我在 Google+ 上问过类似的问题，请参见[此处](https://plus.google.com/117783247727182623015/posts/9qjU7nR6gsU)。
总结是：您只能在构造函数（ctors）和函数参数上使用映射语法。

有趣的是它不会抛出异常。

# c++ - 如何从无符号字符 * 模数和指数 65537(RSA_F4) 创建 RSA 公钥

> ID：10742451
> 
> 赞同：6
> 
> 时间：2012-05-24T17:29:11.887
> 
> 标签：c++, c, linux, openssl

我正在尝试从模数类型 char[] 生成 rsa 公钥，我现在的指数是 RSA_F4(65537); 但是当我尝试使用“n”和“e”的值生成我的公钥时，RSA_public_encrypt 返回-1；

谢谢！

我的代码：

```
#include <string.h>
#include <stdio.h>
#include <unistd.h>
#include <crypt.h>
#include <iostream>
#include <stdlib.h>
#include <openssl/rsa.h>
#include <openssl/aes.h>
#include <openssl/opensslconf.h>
#include <openssl/engine.h>
#include <openssl/pem.h>
#include <openssl/rc4.h>

using namespace std;
int main(void)
{

//modulus in format char hex;
char key[] = "C0E7FC730EB5CF85B040EC25DAEF288912641889AD651B3707CFED9FC5A1D3F6C40062AD46E3B3C3E21D4E71CC4800C80226D453242AEB2F86D748B41DDF35FD";

    char palavra[] = "teste";
    char crip[512];
    int ret;
    RSA * pubkey = RSA_new();
    BIGNUM * modul = BN_new();
    BIGNUM * expon = BN_new();

    BN_hex2bn(&modul, (const char *) key);
    BN_hex2bn(&expon, "010001");

    cout << "N KEY: " << BN_bn2hex(modul) << endl;
    cout << "E KEY: " << BN_bn2hex(expon) << endl;

    pubkey->n = modul;
    pubkey->e = expon;

    cout << "N PUB KEY: " << BN_bn2hex(pubkey->n) << endl;
    cout << "E PUB KEY: " << BN_bn2hex(pubkey->e) << endl;

    if (RSA_public_encrypt(strlen((const char *) palavra), (const unsigned char *) palavra, (unsigned char *) crip, pubkey, RSA_PKCS1_PADDING ))
    {
        printf("ERRO encrypt\n");
    }
    else
    {
        printf("SUC encrypt\n");
    }
return 0;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T18:09:23.657

您可能想要看起来更像的东西：

```
RSA *pubkey = RSA_new();
int len = BN_hex2bn(&pubkey->n, (const char *)p);
if (len == 0 || p[len])
    fprintf(stderr, "'%s' does not appear to be a valid modulus\n", p);
BN_hex2bn(&pubkey->e, "010001"); 
```

**编辑**

您的代码工作正常，除了错误检查。RSA_public_encrypt 成功时返回密文的大小，而不是 0，因此要使上面的代码正常工作，`<= 0`请在行中添加一个测试`if`：

```
if (RSA_public_encrypt(....) <= 0) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-05T19:32:31.463

这是一些C代码，可以解决问题：

```
#include <string.h>
#include <openssl/rsa.h>
#include <openssl/evp.h>
#include <openssl/bn.h>
#include <openssl/pem.h>

// cheating, .. ignoring deprecation warnings
#pragma GCC diagnostic ignored "-Wdeprecated-declarations"

unsigned char *base64_decode(const char* base64data, int* len) {
   BIO *b64, *bmem;
   size_t length = strlen(base64data);
   unsigned char *buffer = (unsigned char *)malloc(length);
   b64 = BIO_new(BIO_f_base64());
   BIO_set_flags(b64, BIO_FLAGS_BASE64_NO_NL);
   bmem = BIO_new_mem_buf((void*)base64data, length);
   bmem = BIO_push(b64, bmem);
   *len = BIO_read(bmem, buffer, length);
   BIO_free_all(bmem);
   return buffer;
}

BIGNUM* bignum_base64_decode(const char* base64bignum) {
   BIGNUM* bn = NULL;
   int len;
   unsigned char* data = base64_decode(base64bignum, &len);
   if (len) {
       bn = BN_bin2bn(data, len, NULL);
   }
   free(data);
   return bn;
}

EVP_PKEY* RSA_fromBase64(const char* modulus_b64, const char* exp_b64) {
   BIGNUM *n = bignum_base64_decode(modulus_b64);
   BIGNUM *e = bignum_base64_decode(exp_b64);

   if (!n) printf("Invalid encoding for modulus\n");
   if (!e) printf("Invalid encoding for public exponent\n");

   if (e && n) {
       EVP_PKEY* pRsaKey = EVP_PKEY_new();
       RSA* rsa = RSA_new();
       rsa->e = e;
       rsa->n = n;
       EVP_PKEY_assign_RSA(pRsaKey, rsa);
       return pRsaKey;
   } else {
       if (n) BN_free(n);
       if (e) BN_free(e);
       return NULL;
   }
}

void assert_syntax(int argc, char** argv) {
   if (argc != 4) {
      fprintf(stderr, "Description: %s takes a RSA public key modulus and exponent in base64 encoding and produces a public key file in PEM format.\n", argv[0]);
      fprintf(stderr, "syntax: %s <modulus_base64> <exp_base64> <output_file>\n", argv[0]);
      exit(1);
   }
}

int main(int argc, char** argv) {
   assert_syntax(argc, argv);

   const char* modulus = argv[1];
   const char* exp = argv[2];
   const char* filename = argv[3];

   EVP_PKEY* pkey = RSA_fromBase64(modulus, exp);

   if (pkey == NULL) {
      fprintf(stderr, "an error occurred :(\n");
      return 2;
    } else {
       printf("success decoded into RSA public key\n");
       FILE* file = fopen(filename, "w");
       PEM_write_PUBKEY(file, pkey);
       fflush(file);
       fclose(file);
       printf("written to file: %s\n", filename);
    }

    return 0;
} 
```

有关更多信息，请参阅此链接：[http ://www.techper.net/2012/06/01/converting-rsa-public-key-modulus-and-exponent-into-pem-file/](http://www.techper.net/2012/06/01/converting-rsa-public-key-modulus-and-exponent-into-pem-file/)

# javascript - jQuery 持久的非事件绑定

> ID：10742456
> 
> 赞同：0
> 
> 时间：2012-05-24T17:29:23.833
> 
> 标签：javascript, jquery

```
 var $thingy = $('.thingy'),
     $window = $(window);

 $window.on('resize', function(){
       thingy.width($window.width()/12);
 }); 
```

是否可以在页面中添加更多`.thingy`s 并在不重新查询的情况下调整它们的大小？

我知道以下将起作用：

```
 var $window = $(window);

 $window.on('resize', function(){
       $('.thingy').width($window.width()/12);
 }); 
```

问题是，我不`.thingy`经常在页面中添加 s，这使得创建新的 jQuery 对象和快速重新查询 DOM 看起来像是很多开销。

有没有更好的办法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T17:34:44.883

您可以简单地重新分配给变量：

```
var $window = $(window),
    $thingy = $('.thingy');
$window.on('resize', function(){
    $thingy.width($window.width()/12);
});

// then sometime:
$thingy = $('.thingy');
// or:
$thingy = $thingy.add(elements) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T17:32:50.490

每当你添加一个新的`.thingy`，更新选择

```
$thingy = $('.thingy'); 
```

或者

```
$thingy = $thingy.add(the_new_thingy) 
```

当然`$thingy`必须在两个地方都可见。

# c# - 替代字典进行查找

> ID：10742461
> 
> 赞同：3
> 
> 时间：2012-05-24T17:29:47.413
> 
> 标签：c#, collections, lookup-tables

我需要建立查找表。我使用 Dictionary 它包含 45M long 和 45M int 。只要 key 和 int 作为 value 。集合的大小为 (45M*12) 其中 long 为 8 字节， int 为 4 字节 大小约为 515 Mbyte 。但实际上进程的大小是 1.3 Gbyte 。该过程仅包含此查找表。Mat be，有没有字典的替代品？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T17:36:31.033

你愿意付出多少努力？
你可以使用一个

```
KeyValuePair<long,int>[] table = new KeyValuePair<long,int> [45 M]; 
```

然后在第一列 ( `long Key`) 上对其进行排序并使用二进制搜索来查找您的值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T18:26:32.883

如果您的范围限制为 10^12 的最大 long 值，那么空间方面的问题是您必须使用 long，因为您只需要比 int 可以容纳的多几位。如果是这种情况，您可以执行以下操作：将数据存储在 512 Dictionary 的数组中

```
 var myData = new Dictionary<int,int>[512]; 
```

要引用与 long 值关联的 int（在此示例中我将其称为“key”），您可以执行以下操作：

```
myData[key & 511].Add((int) (key >> 9), intValue);
int result = myData[(int) (key & 511)][(int) (key >> 9)]; 
```

您创建的字典数量以及位摆弄中使用的位数可能需要调整以适应数据的真实约束。使用这种方法可以减少大约三分之一的内存使用量

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T17:35:40.453

您可以使用 SortedList 而不是 Dictionary，这将提高内存效率，但 CPU 效率可能会稍低，忽略有关测量内存的问题以及为什么首先需要一次性加载这么多数据:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-24T17:39:21.707

字典有一个保存数据的底层数组，但数组的大小*必须*大于你拥有的项目数，这就是字典查找速度的来源。事实上，底层数组的大小应该比项目数（25+%）大很多。结合这一点，当您添加项目时，该底层数组正在被取消分配和重新创建（以使其更大），您可能有相当多的内存准备好进行垃圾收集（这意味着如果您实际上需要更多内存GC 会回收它，但既然你现在有足够的东西，它不会打扰）。

这个字典消耗的内存是否超出了您的允许范围，或者您只是好奇为什么它比您想象的要多？您可以使用其他选项（其他答案和评论列出了一些），它们将使用更少的内存但也会更慢。您是否遇到内存不足的问题？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-24T17:38:57.700

另一种方法，假设数据是静态的：使用两个排序的数组——一个是long，一个是int。确保一个索引 N 处的项目是另一个索引 N 处的键的值。使用[Array.BinarySearch](http://msdn.microsoft.com/en-us/library/system.array.binarysearch.aspx)查找您要查找的键值。

# linux - localhost 重定向到 http://www.localhost:8000/

> ID：10742469
> 
> 赞同：1
> 
> 时间：2012-05-24T17:30:17.483
> 
> 标签：linux, firefox, google-chrome, localhost, hosts

我的 google chrome 和 firefox 有问题（我仅有的 2 个浏览器）

当运行我的 django 服务器时`./manage.py runserver 0.0.0.0:8000`，当我转到 chrome 或 firefox 并输入`localhost:8000`chrome 时重定向到[http://www.localhost:8000/](http://www.localhost:8000/)

你知道是什么问题吗？？

我的主机文件是：

```
#
# /etc/hosts: static lookup table for host names
#

#<ip-address>   <hostname.domain.org>   <hostname>
127.0.0.1   localhost.localdomain   localhost arch
127.0.0.1   example.com 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-17T03:17:01.803

那么问题解决了添加这一行：

```
::1     localhost.localdomain   localhost arch 
```

在`/etc/hosts`文件中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-18T11:52:15.323

设置`PREPEND_WWW = False`并清除浏览器缓存后，它可以在 Firefox 和 Chromium 中运行。

# visual-studio-2010 - 使用 Func 进行单元测试 作为参数

> ID：10742471
> 
> 赞同：2
> 
> 时间：2012-05-24T17:30:18.167
> 
> 标签：visual-studio-2010, unit-testing, func

如何在 VS2010 中为以下方法生成单元测试？

```
public bool myResult(Func<int, int, bool> myFunc)
{
    int a = 1;
    int b = 2;    
    return myFunc(a, b);
} 
```

当我右键单击并选择“生成单元测试...”时，无法为单元测试选择 myResult 方法。确实会出现不包含 Func 作为参数的方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T18:01:21.967

虽然自动测试生成器不起作用，但您可以手动进行单元测试。

所需要的只是在你的类中有一个标记为的方法[`[TestMethod]`](http://msdn.microsoft.com/en-us/library/microsoft.visualstudio.testtools.unittesting.testmethodattribute.aspx)，然后自己编写单元测试。

# java - 客户端“Raven-Java 0.4”引发 API 错误

> ID：10742474
> 
> 赞同：1
> 
> 时间：2012-05-24T17:30:25.877
> 
> 标签：java, sentry, raven

我正在尝试在我的服务器上设置一个本地哨兵。

当我的 java 应用程序向服务器发送异常时，哨兵返回“Client 'Raven-Java 0.4' raise API error:”（不显示错误）。

哨兵中此异常的 JSON 数据： `{"id": "4f8e8377122340da92c7192c9a059aea", "checksum": "5c99c531830313a994bf4de2e8bb4fd4", "project": "default", "logger": "sentry.api.http", "level": "error", "culprit": "", "extra": {"thread": -1219086144, "process": 8395, "threadName": "MainThread", "module": "api", "filename": "api.py", "pathname": "/opt/sentry/lib/python2.5/site-packages/sentry-4.4.6-py2.5.egg/sentry/web/api.py", "lineno": 153, "message": "Client 'Raven-Java 0.4' raised API error: ", "funcName": "store"}, "modules": {"sentry": "4.4.6", "djcelery": "2.5.5", "django": "1.3.1", "kombu.transport.django": "1.0.0", "kombu": "2.1.8", "south": "0.7.5", "raven": "1.9.1"}, "sentry.interfaces.Message": {"message": "Client 'Raven-Java 0.4' raised API error: ", "params": []}}`

我可以将相同的异常从我的 java 应用程序发送到 getsentry 公共服务器。

怎么了？

# apache - .htaccess - 重定向所有用户，除了我

> ID：10742475
> 
> 赞同：0
> 
> 时间：2012-05-24T17:30:30.250
> 
> 标签：apache, .htaccess, mod-rewrite, nginx, litespeed

请帮助我使用htaccess。我试图创建一个规则，使访问特定网页的用户自动重定向到站点上的另一个页面，但是如果我访问该页面，则此规则对我不起作用（对于特定的 IP 地址）。

LiteSpeed安装在服务器上，我认为符合Apache的规则（如果我错了请纠正，我只是不了解服务器软件）。

抱歉英语不好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T17:35:37.173

这是一个[302-Moved 临时重定向](http://en.wikipedia.org/wiki/HTTP_302)。

```
Options +FollowSymlinks
RewriteEngine on
RewriteCond %{REMOTE_HOST} !^xxx\.xxx\.xxx\.xxx
RewriteRule \.html$ /anotherPage.html [R=302,L] 
```

其中 xxx.xxx.xxx.xxx 是您的 ip，anotherPage.html 是重定向页面。

# algorithm - 将 stl 映射转换为基于数值的键的排序列表的好算法

> ID：10742476
> 
> 赞同：0
> 
> 时间：2012-05-24T17:30:31.247
> 
> 标签：algorithm, sorting, stl, map, c++03

我有一个类型为 stl 的地图：

```
map<Object*, baseObject*> 
```

在哪里

```
class baseObject{
    int ID;
    //other stuff
}; 
```

如果我想返回一个对象列表（std::list< Object* >），那么按照 baseObject.ID 的顺序对其进行排序的最佳方法是什么？

我只是一直在寻找每个数字或其他东西吗？我不想将地图更改为提升地图，尽管我不一定反对做一些自包含在返回函数中的事情，比如

```
GetObjectList(std::list<Object*> &objects)
{
   //sort the map into the list
} 
```

编辑：也许我应该遍历并将 obj->baseobj 复制到 baseobj.ID->obj 的映射中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T17:47:22.270

我要做的是首先将键（因为您只想返回它们）提取到向量中，然后对其进行排序：

```
std::vector<baseObject*> out;
std::transform(myMap.begin(), myMap.end(), std::back_inserter(out), [](std::pair<Object*, baseObject*> p) { return p.first; });
std::sort(out.begin(), out.end(), [&myMap](baseObject* lhs, baseObject* rhs) { return myMap[lhs].componentID < myMap[rhs].componentID; }); 
```

如果您的编译器不支持 lambda，只需将它们重写为自由函数或函数对象。我只是为了简洁而使用 lambdas。

为了性能，最初我可能会`reserve`在向量中留出足够的空间，而不是让它逐渐扩展。

（另请注意，我没有测试代码，所以它可能需要一点点摆弄）

另外，我不知道这个映射应该代表什么，但是持有一个键和值类型都是指针的映射*确实*让我的“糟糕的 C++”感觉刺痛。它闻起来有手动内存管理和混乱（或不存在）的所有权语义的味道。

您提到在 a 中获取输出`list`，但 a`vector`几乎可以肯定是一个性能更好的选项，所以我使用了它。a 更可取的唯一情况`list`是，当您不打算对其进行迭代时，并且如果您需要保证指针和迭代器在修改列表后保持有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T18:10:45.677

这是您所说的“按baseObject.ID的顺序对其进行排序”的方法：

```
typedef std::map<Object*, baseObject*> MapType;
MapType mymap; // don't care how this is populated
               // except that it must not contain null baseObject* values.

struct CompareByMappedId {
    const MapType &map;
    CompareByMappedId(const MapType &map) : map(map) {}
    bool operator()(Object *lhs, Object *rhs) {
        return map.find(lhs)->second->ID < map.find(rhs)->second->ID;
    }
};

void GetObjectList(std::list<Object*> &objects) {
    assert(objects.empty()); // pre-condition, or could clear it
    // or for that matter return a list by value instead.

    // copy keys into list
    for (MapType::const_iterator it = mymap.begin(); it != mymap.end(); ++it) {
        objects.push_back(it->first);
    }
    // sort the list
    objects.sort(CompareByMappedId(mymap));
} 
```

这并不是非常有效：它在映射中的查找比严格必要的要多，并且在其中操作列表节点`std::list::sort`可能比`std::sort`在操作指针的随机访问容器时要慢一些。但是，`std::list`对于大多数用途而言，它本身并不是很有效，因此您预计设置一个会很昂贵。

如果您需要优化，您可以创建一个成对的向量`(int, Object*)`，这样您只需遍历地图一次，无需查找。对这些对进行排序，然后将每对的第二个元素放入列表中。这可能是一个过早的优化，但它在实践中是一个有效的技巧。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T17:45:30.943

我认为你会做得很好：

```
GetObjectList(std::list<Object*> &objects)
{
  std::vector <Object*> vec;
  vec.reserve(map.size());
  for(auto it = map.begin(), it_end = map.end(); it != it_end; ++it)
    vec.push_back(it->second);
  std::sort(vec.begin(), vec.end(), [](Object* a, Object* b) { return a->ID < b->ID; });
  objects.assign(vec.begin(), vec.end());
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-24T17:49:15.250

第一件事是我不会使用 a `std::list`，而是使用 a `std::vector`。现在对于特定问题，您需要执行两个操作：生成容器，根据您的标准对其进行排序。

```
// Extract the data:
std::vector<Object*> v;
v.reserve( m.size() );
std::transform( m.begin(), m.end(), 
                std::back_inserter(v),
                []( const map<Object*, baseObject*>::value_type& v ) {
                     return v.first;
                } );
// Order according to the values in the map
std::sort( v.begin(), v.end(), 
           [&m]( Object* lhs, Object* rhs ) {
               return m[lhs]->id < m[rhs]->id;
           } ); 
```

如果没有 C++11，您将需要创建仿函数而不是 lambda，如果您坚持返回 a，`std::list`那么您应该使用`std::list<>::sort( Comparator )`. 请注意，这可能效率低下。如果性能是一个问题（在你得到这个工作并且你分析并知道这实际上是一个瓶颈之后）你可能需要考虑使用中间`map<int,Object*>`：

```
std::map<int,Object*> mm;
for ( auto it = m.begin(); it != m.end(); ++it )
   mm[ it->second->id ] = it->first;
}
std::vector<Object*> v;
v.reserve( mm.size() );                  // mm might have less elements than m!
std::transform( mm.begin(), mm.end(), 
                std::back_inserter(v),
                []( const map<int, Object*>::value_type& v ) {
                     return v.second;
                } ); 
```

同样，这可能比原始版本...配置文件更快或更慢。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-24T18:02:52.543

我不确定我是否完全理解您要在地图中存储的内容，但也许[请看这里](http://www.cplusplus.com/reference/stl/map/)

std::map 的第三个模板参数是一个 less 函子。也许您可以利用它在插入时对存储在地图中的数据进行排序。然后它将是地图迭代器上的直接循环来填充列表

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-24T17:45:07.107

我将创建一个新地图，该地图具有使用对象的组件 ID 的排序标准。从第一个映射填充第二个映射（只需迭代或 std::copy in）。然后您可以使用迭代器按顺序阅读此地图。

与使用向量或列表（log(n) 时间而不是常数时间）相比，这在插入方面有一点开销，但它避免了在创建向量或列表之后进行排序的需要，这很好。

此外，您稍后可以在程序中向其添加更多元素，并且无需使用手段即可维持其顺序。

# android - Android 从相机流式传输视频

> ID：10742479
> 
> 赞同：2
> 
> 时间：2012-05-24T17:30:47.127
> 
> 标签：android, video, stream, camera

> **可能重复：**
> [使用 VideoView 流式传输或渐进式下载视频](https://stackoverflow.com/questions/2058945/using-videoview-for-streaming-or-progressive-download-video)

我正在开发一款适用于 Android 的应用程序，我的目的是通过手机摄像头将视频流式传输到其他 Android 手机（应用程序）。我对流媒体视频了解不多，我想知道的是我需要做什么？

我需要创建一个流媒体服务器来接收来自一部安卓手机的视频吗？我该怎么做？最好的方法是什么？如何设置/配置流媒体服务器？

有人可以帮我做一些解释或教程吗？

# .htaccess - mod rewrite .htaccess 表达式引擎删除 index.php 和特定的子目录

> ID：10742485
> 
> 赞同：1
> 
> 时间：2012-05-24T17:31:14.367
> 
> 标签：.htaccess, mod-rewrite, expressionengine

讨厌问这个问题，但我已经把头撞在桌子上一段时间了，似乎无法理解。我正在使用 ExpressionEngine，并且正在使用 mod_rewrite 从我的所有 URL 中删除 index.php。这很好用。此外，我希望将 myurl.com/adwords/(anything) 中的任何内容重写为 myurl.com/(anything)。我的正则表达式和 htaccess Skillz 很弱。这是我在 .htaccess 中的内容：

```
Options +FollowSymlinks
RewriteEngine On
RewriteBase /

RewriteCond %{REQUEST_URI} ^/adwords/(.*)$
RewriteRule ^(.*)$ /index.php/$1 [L]

RewriteCond %{QUERY_STRING} !^(ACT=.*)$ [NC]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ /index.php/$1 [L] 
```

所以我想我说的是任何以/adwords/(something) 结尾的东西，捕获一些东西，然后通过$1 将它附加到index.php 的末尾。我猜这很简单。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T18:37:09.633

您正在寻找的规则可能很简单

```
RewriteRule ^adwords/(.*)$ index.php/$1 [L] 
```

不需要重写条件，但我想知道......你真的想重写[http://myurl.com/adwords/foo](http://myurl.com/adwords/foo)到[http://myurl.com/index.php/foo](http://myurl.com/index.php/foo)，而不是[http:// /myurl.com/index.php?a=foo](http://myurl.com/index.php?a=foo)？

如果您还想将[http://myurl.com/baa/adwords/foo](http://myurl.com/baa/adwords/foo)之类的内容重写为[http://myurl.com/baa/index.php/foo](http://myurl.com/baa/index.php/foo)，则必须省略 ^：

```
RewriteRule adwords/(.*)$ index.php/$1 [L] 
```

顺便说一句，你可以在这里测试你的大部分重写规则：http: [//htaccess.madewithlove.be/](http://htaccess.madewithlove.be/)

# css - 多个导航组的 CSS 格式

> ID：10742488
> 
> 赞同：0
> 
> 时间：2012-05-24T17:31:39.373
> 
> 标签：css

给定标记类似于：

```
<h1 id="Menu1Title">Menu1</h1>
<nav id="Menu1">
    <a>Item1-1</a>
    <a>Item1-2</a>
    <a>Item1-3</a>
</nav>

<h1 id="Menu2Title">Menu2</h1>
<nav id="Menu2">
    <a>Item2-1</a>
    <a>Item2-2</a>
    <a>Item2-3</a>
</nav>

<h1 id="Menu3Title">Menu3</h1>
<nav id="Menu3">
    <a>Item3-1</a>
    <a>Item3-2</a>
    <a>Item3-3</a>
</nav> 
```

如何仅使用 CSS 实现此演示文稿？

```
Menu1  Menu2  Menu3
Item1-1
Item1-2
Item1-3
Item2-1
Item2-2
Item2-3
Item3-1
Item3-2
Item3-3 
```

也可以使用 UL，只要它们是三个独立的元素而不是彼此的子列表。我不希望使用绝对定位，因为在此下方还有其他内容应该围绕上面的标记流动。我也不需要旧的 IE hack；仅支持 IE9 和现代浏览器。

这甚至可能吗？谢谢！

编辑...上面的格式问题是为移动设备设计的。非移动显示如下，这就是为什么我希望有一个不需要标记更改的纯 CSS 解决方案。

```
Menu1
Item1-1 
Item1-2 
Item1-3 

Menu2
Item2-1 
Item2-2 
Item2-3 

Menu3 
Item3-1 
Item3-2 
Item3-3 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T18:56:05.820

好的，如果你真的不能改变标记或使用 jQuery 来改变标记，那么下面是一个 CSS 唯一的解决方案：

[http://jsfiddle.net/wSLEb/](http://jsfiddle.net/wSLEb/)

您可以绝对定位标题并给出第一个 ul 边距顶部。然后使用`:nth-of-type`伪类选择器，您可以定位单个标题并为它们提供更多左侧定位，以将它们推过页面并彼此远离。

它不是很灵活，因为您必须对左侧定位进行硬编码，因此请考虑标题的宽度如何在移动屏幕上呈现。

标记将是：

```
<h1 id="Menu1Title" class="header">Menu1</h1>
<nav id="Menu1">
<ul class="first">
<li><a>Item1-1</a></li>
<li><a>Item1-2</a></li>
<li><a>Item1-3</a></li>
</ul>
</nav>
<h1 id="Menu2Title" class="header">Menu2</h1>
<nav id="Menu2">
<ul>
<li><a>Item2-1</a></li>
<li><a>Item2-2</a></li>
<li><a>Item2-3</a></li>
</ul>
</nav>
<h1 id="Menu3Title" class="header">Menu3</h1>
<nav id="Menu3">
<ul>
<li><a>Item3-1</a></li>
<li><a>Item3-2</a></li>
<li><a>Item3-3</a></li>
</ul>
</nav> 
```

和 CSS 将是：

```
.header {
   position: absolute;
    top: 0;
    left:0;
}
.header:nth-of-type(2) {
    left:50px;
}
.header:nth-of-type(3) {
    left:100px;
}
ul {
    list-style: none;
    margin:0;
    padding:0;
}
ul.first {
 margin-top: 20px;
} 
```

您可以在 Chris Coyier 的网站上阅读更多关于伪类选择器的信息：http: [//css-tricks.com/pseudo-class-selectors/](http://css-tricks.com/pseudo-class-selectors/)

祝你好运

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T18:48:19.637

开始你的列表应该在 uls 中。

如果您不能使用绝对定位，那么您需要更改标记以实现这种样式。标题应在 html 中一个接一个地出现。如果您无法在源代码处更改标记，那么您将不得不使用 jQuery 在页面加载时重新排序标记。

在您的 jQuery 中，我将定位所有标头，然后删除除第一个以外的所有标头，然后在第一个标头之后插入这些已删除的标头，然后在最后一个标头之后放置一个清除 div。

请参阅此或下面的代码：http: [//jsfiddle.net/wSLEb/](http://jsfiddle.net/wSLEb/)

你的标记会变成这样：

```
<h1 id="Menu1Title" class="header">Menu1</h1>
<h1 id="Menu2Title" class="header">Menu2</h1>
<h1 id="Menu3Title" class="header">Menu3</h1>
<div class="clear"></div> <!--clearing div added to move first ul under the headers-->
<nav id="Menu1">
<ul>

<li><a>Item1-1</a></li>
<li><a>Item1-2</a></li>
<li><a>Item1-3</a></li>
</ul>
</nav>
<nav id="Menu2">
<ul>
<li><a>Item2-1</a></li>
<li><a>Item2-2</a></li>
<li><a>Item2-3</a></li>
</ul>
</nav>
<nav id="Menu3">
<ul>
<li><a>Item3-1</a></li>
<li><a>Item3-2</a></li>
<li><a>Item3-3</a></li>
</ul>
</nav> 
```

样式将是这样的：

```
.header {
    float: left;
    margin-right: 10px;
}
ul {
    list-style: none;
    margin:0;
    padding:0;
}
.clear {
    clear: both;
} 
```

# c++ - 使用迭代器打印出集合的每个成员

> ID：10742491
> 
> 赞同：6
> 
> 时间：2012-05-24T17:31:44.987
> 
> 标签：c++, iterator, set

我正在尝试使用迭代器来打印出集合的每个成员。据我从其他stackoverflow答案中可以看出，我的格式正确。当我运行此代码时，它正确输出 myset 的大小为 3，但它只输出 ii 一次。如果我用 *iter 取消注释该行，Visual Studio 会引发运行时异常，指出“map/set 迭代器不可取消引用。知道为什么吗？

```
int main()
{
set<int> myset;
myset.insert(5);
myset.insert(6);
myset.insert(7);
set<int>::iterator iter;
cout<<myset.size()<<endl;
int ii=0;
for(iter=myset.begin(); iter!=myset.end();++iter);{
    //cout<<(*iter)<<endl;
    ii+=1;
    cout<<ii<<endl;
}
return 0;
} 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-24T17:38:26.557

`;`你在这一行有一个额外的：

```
for(iter=myset.begin(); iter!=myset.end();++iter);{ 
```

这意味着循环的主体实际上是空的，以下几行只执行一次。

所以将该行更改为：

```
for(iter=myset.begin(); iter!=myset.end();++iter) { 
```

# css - Facebook Like Button - 如何禁用评论弹出框？

> ID：10742492
> 
> 赞同：1
> 
> 时间：2012-05-24T17:31:46.627
> 
> 标签：css, facebook, button, facebook-like, facebook-likebox

我想禁用用户点击 Facebook Like 按钮时弹出的评论框，

我关注了[Facebook Like Button 的帖子 - 如何禁用评论弹出窗口？](http://facebook.stackoverflow.com/questions/3247855/facebook-like-button-how-to-disable-comment-pop-up) 并更改了 CSS 但它没有任何其他建议请

我不能使用 IFRAME 否则我将无法使用 FB.Event.subscribe('edge.create',

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T18:24:05.473

来自[http://developers.facebook.com/docs/reference/plugins/like/](http://developers.facebook.com/docs/reference/plugins/like/)：

> **用户何时可以选择添加评论？**
> 
> 如果您使用 XFBML 版本的 Like 按钮，用户将始终可以选择添加评论。> 如果您使用的是 Iframe 版本的按钮，如果您使用的是 > 宽度至少为 400 像素的“标准”布局，用户将可以选择评论。如果用户确实添加了评论，则发布 > 返回 Facebook 的故事会更加突出。

只需使用 iframe 版本的按钮并将宽度设置为小于 400 像素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-09-16T13:31:47.110

只需添加一个带有溢出的样式属性：隐藏

```
<div style="overflow: hidden !important;" class="fb-like" data-href="<?php echo $url; ?>" data-layout="button_count" data-action="like" data-show-faces="false" data-share="true"></div> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T17:43:41.843

将 iframe 放置在 div 中，并使用具有宽度和高度的溢出隐藏来隐藏除按钮之外的任何内容。

我试图从 iframe 中更改 css，但这对我不起作用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-04-17T13:13:24.523

创建一个自定义的 CSS 类，例如，

```
.fb-like{
overflow: hidden !important;
} 
```

将课程提及到 facebook DIV

就是这样...

# python - 是否有破解 pdb 内置 print 的技巧？

> ID：10742501
> 
> 赞同：6
> 
> 时间：2012-05-24T17:32:14.737
> 
> 标签：python, printing, stack-trace, pdb

基本上，标题。

我试图追踪在大型代码库中发生虚假打印的位置，并且我想中断，或者每当打印“发生”时以某种方式获取堆栈跟踪。有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-24T18:11:51.637

对于这种特殊情况，您可以重定向`stdout`到打印输出及其调用者的帮助程序类。你也可以打破它的一种方法。

完整示例：

```
import sys
import inspect

class PrintSnooper:
    def __init__(self, stdout):
        self.stdout = stdout
    def caller(self):
        return inspect.stack()[2][3]
    def write(self, s):
        self.stdout.write("printed by %s: " % self.caller())
        self.stdout.write(s)
        self.stdout.write("\n")

def test():
    print 'hello from test'

def main():
    # redirect stdout to a helper class.
    sys.stdout = PrintSnooper(sys.stdout)
    print 'hello from main'
    test()

if __name__ == '__main__':
    main() 
```

输出：

```
printed by main: hello from main
printed by main: 

printed by test: hello from test
printed by test: 
```

`inspect.stack()`如果您需要更详尽的信息，也可以只打印。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T18:08:54.680

我能想到的唯一方法是替换`sys.stdout`，例如用`codecs.getwriter('utf8')`. 然后你可以`write`在 pdb 的方法上设置断点。或者`write`用调试代码替换它的方法。

```
import codecs
import sys

writer = codecs.getwriter('utf-8')(sys.stdout) # sys.stdout.detach() in python3
old_write = writer.write

def write(data):
    print >>sys.stderr, 'debug:', repr(data)
    # or check data + pdb.set_trace()
    old_write(data)

writer.write = write
sys.stdout = writer

print 'spam', 'eggs' 
```

# wix - WiX - 在安装时设置合并模块目录？

> ID：10742505
> 
> 赞同：3
> 
> 时间：2012-05-24T17:32:36.780
> 
> 标签：wix, wix3.5, merge-module

我已经按照入门 Wix 指南中的说明创建了一个合并模块，该指南位于：[http](http://wix.sourceforge.net/manual-wix2/authoring_merge_modules.htm) ://wix.sourceforge.net/manual-wix2/authoring_merge_modules.htm 。

这是合并模块wxs：

```
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <Module Id="SomeRepositoryMergeModule" Language="1033" Version="1.0.0.0">
    <Package Id="f11e7321-a687-4d53-8be7-21a8ae0721a6" Manufacturer="SomeCompany Technologies" InstallerVersion="200" />

    <Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="ProgramFilesFolder">
          <Directory Id="MODULEINSTALLLOCATION" Name="Some Repository">
            <Component Id="ServicesHostWindowsService" Guid="257D1FAE-4AFF-4155-BDB8-D81F50E5862B">
              <File Id="ServicesHostInstallerExecutable" KeyPath="yes" DiskId="1" Name="WindowsServiceHost.exe" Source="..\WindowsServiceHost\bin\Output_For_Installer\WindowsServiceHost.exe" />
              <File Id="ServicesHostConfig" KeyPath="no" DiskId="1" Name="WindowsServiceHost.exe.config" Source="..\WindowsServiceHost\bin\Output_For_Installer\WindowsServiceHost.exe.config" />
              <File Id="SomeCompanyCommon" KeyPath="no" DiskId="1" Name="SomeCompany.Common.dll" Source="..\WindowsServiceHost\bin\Output_For_Installer\SomeCompany.Common.dll" />
              <File Id="SomeRepositorySqlScript" KeyPath="no" DiskId="1" Name="SomeRepository.sql" Source="..\..\..\..\..\DB\SomeRepository\SomeRepository.sql" />
              <File Id="LogConfigXml" KeyPath="no" DiskId="1" Name="log.config.xml" Source="..\WindowsService\log.config.xml" />
              <ServiceInstall Id="ServicesHostInstallElement" ErrorControl="normal" Start="auto" Type="ownProcess" Vital="yes"
                              Name="AServer WindowsService Host"
                              Description="The windows service responsible for hosting SomeCompany Some Repository's WindowsService."
                                                    />
              <ServiceControl Id="ServicesHostController" Name="AServer WindowsService Host" Remove="uninstall" Start="install" Stop="uninstall" Wait="no" />
            </Component>
          </Directory>
      </Directory>
    </Directory>
    <ComponentGroupRef Id="Product.Generated" /><!-- Harvested by heat -->
  </Module>  
</Wix> 
```

这是主要产品wxs：

```
 <Media Id="1" Cabinet="media1.cab" EmbedCab="yes" />

<Directory Id="TARGETDIR" Name="SourceDir">
  <Directory Id="ProgramFilesFolder">
    <Directory Id="SomeCompanyGlobalDir" Name="SomeCompany Technologies">
      <Directory Id="INSTALLLOCATION" Name="Some Repository">
        <Merge Id='SomeRepositoryPrimaryModule' Language='1033' SourceFile='..\SomeRepositoryMergeModule\bin\Output_For_Installer\SomeRepositoryMergeModule.msm' DiskId='1' />          
      </Directory>
    </Directory>
  </Directory>
</Directory>

<Feature Id="ProductFeature" Title="SomeRepositoryStandaloneInstaller" Level="1">           
  <!-- Note: The following ComponentGroupRef is required to pull in generated authoring from project references. -->            
  <MergeRef Id="SomeRepositoryPrimaryModule"/>
</Feature>

<UIRef Id="WixUI_InstallDir" />
<UIRef Id="WixUI_ErrorProgressText" />
<Property Id="WIXUI_INSTALLDIR" Value="INSTALLLOCATION" /> 
```

当我构建安装程序并运行它时，合并模块中的文件不会进入用户从安装程序 UI 中选择的目录。无论如何，它们都会进入“[Program Files]\SomeCompany Technologies\Some Repository\”目录。

如果我从合并模块目录路径中删除对 Program Files 的引用并使用名称为“。”的根目录。拾取父 MSI 的父目录，然后合并模块拾取用户选择的目录就好了。但随后 Visual Studio 在构建时抛出一个错误，即无法收集，因为路径必须植根于标准目录之一，才能使用自动生成的 Guid。

那么如何让合并模块获取用户在安装时选择的目录，同时仍然保持合并模块路径植根于标准目录？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-24T20:19:19.017

您混淆了 MSI，因为 ProgramFilesFolder 是保留的属性名称。将该值更改为“MergeRedirectFolder”，并且凭借 ID 为 INSTALLLOCATION 的 Directory 元素下的 Merge 元素，MergeRedirectFolder 将与 INSTALLLOCATION 关联。Some Repository ([MODULEINSTALLLOCATION]) 目录将成为 INSTALLLOCATION 的子目录。

也可以随意查看 CodePlex 上的[ISWIX](http://iswix.codeplex.com/)项目。它对于创作和维护合并模块很有用，并且具有与您在此处尝试执行的操作相关的示例源代码。

# xpages - 如何在 xpages 中将值附加到 @DBlookup 的结果？

> ID：10742506
> 
> 赞同：1
> 
> 时间：2012-05-24T17:32:37.173
> 
> 标签：xpages, xpages-ssjs

如何在 xpages 中将值附加到 @DBlookup 的结果？

我试过这个，但它似乎不起作用。

var v = @DbLookup("","Setup","Setup","ModRationales").push("其他 2"); 返回 v;

它在我的列表框中显示 6.0。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-24T17:44:18.240

首先：@DbLookup 只查找一个值时返回一个字符串，找到多个值时返回一个数组。因此，我建议您使用[可用作 xsnippet 的 DbLookupArray() 函数，](http://openntf.org/XSnippets.nsf/snippet.xsp?id=dblookup-dbcolumn-with-cache-sort-and-unique)因为此函数始终返回一个数组。它还有其他优点，例如结果的可选缓存。

然后只需在 DbLookupArray() 返回的结果上使用 .push() 将元素添加到数组中。

您当前的查找很可能返回单个元素 - 在 @DbLookup 的情况下是一个字符串。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-24T17:44:18.190

知道了：

var v = @DbLookup("","Setup","Setup","ModRationales");

v.push("其他");

返回 v;

# facebook-fql - 检索喜欢相同粉丝页面的用户朋友时的结果数量错误

> ID：10742511
> 
> 赞同：0
> 
> 时间：2012-05-24T17:32:54.447
> 
> 标签：facebook-fql, facebook-page

我在检索与我共同的朋友和给予粉丝专页时遇到问题。我发现了这个问题[，retrieve-users-friends-who-like-the-same-fan-page](https://stackoverflow.com/questions/6530193/retrieve-users-friends-who-like-the-same-fan-page)

并尝试了这两个建议。由@skycrew 提供的网址

```
https://graph.facebook.com/me/likes/PAGE_ID&access_token=ACCESS_TOKEN 
```

不返回任何数据，其中

```
SELECT uid FROM page_fan 
WHERE uid IN (SELECT uid2 FROM friend WHERE uid1 = me()) 
AND page_id = "[fan_page_id]" 
```

正在给我一些结果，但不是所有我认识的和喜欢粉丝页面的用户：/ 结果仅限于 3 个朋友，我应该至少能看到 4 个人。

也许我仍然遗漏了一些东西，但文档只涵盖了基本的东西，没有错误消息或其他东西。

我的最终查询是这样的

```
SELECT uid, name, username, pic_small from user where uid in
(SELECT uid FROM page_fan WHERE uid IN (SELECT uid2 FROM friend WHERE uid1=me()) AND page_id="fanPageId")
&access_token=access_token 
```

# validation - JSF 2 -- 保存所有有效的组件值

> ID：10742512
> 
> 赞同：3
> 
> 时间：2012-05-24T17:32:57.553
> 
> 标签：validation, jsf, jsf-2, components, partial

我需要创建一个 javascript 函数，该函数在调用时会将所有有效组件保存在 JSF 2.0 表单上。由于完整的表单作为一个整体永远不会有效，我需要找出一种方法来运行每个组件的生命周期，以便如果验证阶段成功，模型将被更新并最终保存。

理想情况下，这需要是单个 ajax 请求，因为使用单独的 ajax 请求迭代每个组件会非常低效。

以前有没有人解决过这个问题？如果不能，你能给我一些关于可能实现的指示吗？

**编辑：**

到目前为止，这是我所拥有的似乎运作良好的东西：

```
@ManagedBean(name = "partialAppSaveBean")
@RequestScoped
public class PartialAppSaveBean implements Serializable {

    protected static final Logger LOGGER = LoggerFactory.getLogger(PartialAppSaveBean.class);
    private static final long serialVersionUID = 1L;

    /**
     * Save any valid Application values
     *
     * @param event
     */
    public void saveData(AjaxBehaviorEvent event) {
        final FacesContext context = FacesContext.getCurrentInstance();

        UIForm form = getParentForm(event.getComponent());
        Set<VisitHint> hints = EnumSet.of(VisitHint.SKIP_UNRENDERED);

        form.visitTree(VisitContext.createVisitContext(context, null, hints), new VisitCallback() {

            @Override
            public VisitResult visit(VisitContext context, UIComponent component) {
            if (component instanceof UIInput) {
                UIInput input = (UIInput) component;
                input.validate(context.getFacesContext());

                if (input.isValid() && input.getValue() != null) {
                    ValueExpression valueExpression = input.getValueExpression("value");

                    if (valueExpression != null
                            && valueExpression.getExpressionString() != null) {
                        try {
                            valueExpression.setValue(context.getFacesContext().getELContext(), input.getValue());
                        } catch (Exception ex) {
                            LOGGER.error("Expression [ " + valueExpression.getExpressionString() + 
                                    "] value could not be set with value [" + input.getValue() + "]", ex);
                        }                            
                    }
                }
            }

            return VisitResult.ACCEPT;
            }
        });

        //Save data here
    }

    /**
     * Returns the parent form for this UIComponent
     * 
     * @param component
     * @return form
     */
    private static UIForm getParentForm(UIComponent component) {
        while (component.getParent() != null) {
            if (component.getParent() instanceof UIForm) {
                return (UIForm) component.getParent();
            } else {
                return getParentForm(component.getParent());
            }
        }

        return null;
    }

} 
```

调用类似：

```
<h:commandButton
    id="saveData">
    <f:ajax listener="#{partialAppSaveBean.saveData}" execute="@form" immediate="true" onevent="onPartialSave" />
</h:commandButton> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T17:40:18.133

你可以[`UIComponent#visitTree()`](http://docs.oracle.com/javaee/6/api/javax/faces/component/UIComponent.html#visitTree%28javax.faces.component.visit.VisitContext,%20javax.faces.component.visit.VisitCallback%29)在[`UIForm`](http://docs.oracle.com/javaee/6/api/javax/faces/component/UIForm.html).

```
FacesContext context = FacesContext.getCurrentInstance();
UIForm form = getFormSomehow();
Map<String, Object> validValues = new HashMap<String, Object>();
Set<VisitHint> hints = EnumSet.of(VisitHint.SKIP_UNRENDERED);

form.visitTree(VisitContext.createVisitContext(context, null, hints), new VisitCallback() {

    @Override
    public VisitResult visit(VisitContext context, UIComponent component) {
        if (component instanceof UIInput) {
            UIInput input = (UIInput) component;

            if (input.isValid()) {
                validValues.put(input.getClientId(context.getFacesContext()), input.getValue());
            }
        }

        return VisitResult.ACCEPT;
    }
}); 
```

# heroku - 在 Heroku 中使用 Play Framework（或非 Rails 项目）进行调度/脚本编写

> ID：10742515
> 
> 赞同：2
> 
> 时间：2012-05-24T17:33:15.083
> 
> 标签：heroku, playframework

好吧，我的头在这里有点旋转。我从我认为很简单的任务开始，在 heroku 上定期进行 db 转储并将它们推送到个人 S3 帐户进行备份。

我不确定执行此操作的最佳方法。在 Java 中访问 S3 非常清晰，从 heroku 获取 db 转储现在就像泥巴一样清晰......

免责声明：我不知道 Ruby，如果我不需要，我真的不想学习 Ruby，我真的很想使用 Java（这就是我选择 play 的原因）并且我想托管它，这就是我选择 Heroku 的原因 :-)

所以，我可以使用 heroku 调度程序，但我不明白这里正在执行什么脚本 - 是 /bin 中的所有脚本吗？这些是什么类型的脚本，它们是 ruby​​ 脚本吗？当它们不是 rake 任务时，我如何将它们添加为“任务”？

我可以通过 URL 以某种方式使用 pgbackups 吗？看起来 rake 示例执行 pg_dump 代替，写入 tmp 文件，然后从那里移动它。我很不清楚如何从脚本中访问 heroku 数据库的东西，到目前为止我看到的例子都是 rake，所以任何见解都会有帮助......

或者从我的 java 应用程序内部访问它，Heroku java API 的状态是什么？如果有办法从我的 java 访问 heroku 运行时，或者以某种方式使用 heroku.jar？

很高兴获得该领域的一些总体指导和最佳实践 - 谢谢！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T16:51:05.503

从谷歌组我发现这个花絮： [http ://groups.google.com/group/heroku/browse_thread/thread/7fe984c3d2d01f21/9474f31138636332?lnk=gst&q=scheduler+#9474f31138636332](http://groups.google.com/group/heroku/browse_thread/thread/7fe984c3d2d01f21/9474f31138636332?lnk=gst&q=scheduler+#9474f31138636332)

“抱歉延迟回复。我们更新了文档以提及通过以下方式运行 Procfile 条目： [http](http://devcenter.heroku.com/articles/oneoff-admin-ps)`heroku run` : //devcenter.heroku.com/articles/oneoff-admin-ps

**任何`heroku run`通过 Heroku Scheduler 工作**的东西。只需将进程类型的名称作为“任务”在调度程序中。不需要特殊的语法。你甚至可以传递它的参数。“

从这个和**上面詹姆斯沃德的最后一个例子中，**我正在考虑这个答案。

# c# - 通过窗口名称绑定到代码后面的属性

> ID：10742517
> 
> 赞同：1
> 
> 时间：2012-05-24T17:33:23.900
> 
> 标签：c#, .net, wpf, binding

我想将文本框绑定到代码隐藏文件中定义的窗口属性。

使用“FindAncestor”设置RelativeSource 来查找窗口时，在引用窗口时绑定成功。

为什么按名称引用窗口不起作用，就像我可以绑定窗口的“标题”属性一样？

**XAML：**

```
<Window x:Class="WpfApplication123.MainWindow"
        x:Name="MyWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="WPF Binding Example" Height="180" Width="237">
<Grid>
    <TextBox Height="23" HorizontalAlignment="Left" Margin="24,24,0,0" Name="textBox1" VerticalAlignment="Top" Width="136"
             Text="{Binding ElementName=MyWindow, Path=Title}"/>
    <TextBox Height="23" HorizontalAlignment="Left" Margin="24,53,0,0" Name="textBox2" VerticalAlignment="Top" Width="136"
             Text="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Window}}, Path=XYZ}"/>
    <TextBox Height="23" HorizontalAlignment="Left" Margin="24,82,0,0" Name="textBox3" VerticalAlignment="Top" Width="136"
             Text="{Binding ElementName=MyWindow, Path=XYZ}" />
  </Grid>
</Window> 
```

**后面的代码：**

```
namespace WpfApplication123
{
  public partial class MainWindow : Window
  {
    public MainWindow()
    {
      InitializeComponent();
      XYZ = "XYZ!";
    }

    public string XYZ { get; set; }
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T17:39:38.273

我从未使用过普通属性，但我猜你需要实现 INotifyPropertyChanged 接口，并在 XYZ 的设置器中引发属性更改事件。恕我直言，更好的方法是直接使用依赖属性。

只需使 XYZ 成为依赖属性，它就可以工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T18:01:24.450

您可以设置 this.DataContext = this 然后绑定到路径。

你需要

```
XYZ = "XYZ"; 
```

在 InitializeComponent 之前

当文本框初始化时 XYZ 为空

# java - 发生错误：在 JNDI 中找不到 EntityManagerFactory：java:/seam1EntityManagerFactory

> ID：10742522
> 
> 赞同：2
> 
> 时间：2012-05-24T17:33:44.430
> 
> 标签：java, jsf, jboss, seam

我是 jboss 的新手，当我尝试列出数据库的联系人时，我遇到了这个错误，我正在使用以下软件：
jboss-4.2.3.GA
jboss-seam-2.2.2.Final
PostgreSQL 8.4
Eclipse Helios + JBoss Tools
这是 Stack Strace（只有第一个错误）：

```
Caused by: javax.naming.NameNotFoundException: seam1EntityManagerFactory not bound
    at org.jnp.server.NamingServer.getBinding(NamingServer.java:529)
    at org.jnp.server.NamingServer.getBinding(NamingServer.java:537)
    at org.jnp.server.NamingServer.getObject(NamingServer.java:543)
    at org.jnp.server.NamingServer.lookup(NamingServer.java:296)
    at org.jnp.interfaces.NamingContext.lookup(NamingContext.java:667)
    at org.jnp.interfaces.NamingContext.lookup(NamingContext.java:627)
    at javax.naming.InitialContext.lookup(InitialContext.java:392)
    at org.jboss.seam.persistence.ManagedPersistenceContext.getEntityManagerFactoryFromJndiOrValueBinding(ManagedPersistenceContext.java:257)
    ... 117 more 
```

contato_list.xhtml：

```
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
                             "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<ui:composition xmlns="http://www.w3.org/1999/xhtml"
    xmlns:s="http://jboss.com/products/seam/taglib"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:rich="http://richfaces.org/rich" template="layout/template.xhtml">

    <ui:define name="body">

        <h:messages globalOnly="true" styleClass="message" id="globalMessages" />

        <rich:panel>
            <f:facet name="header">Contatos</f:facet>
            <div class="results" id="contatoList">
                <rich:dataTable id="contatoList" var="_contato" value="#{contatos}">
                    <h:column>
                        <f:facet name="header">Id</f:facet>
                        #{_contato.id}
                    </h:column>
                    <h:column>
                        <f:facet name="header">Nome</f:facet>
                        #{_contato.nome}
                    </h:column>
                    <h:column>
                        <f:facet name="header">Email</f:facet>
                        #{_contato.email}
                    </h:column>
                    <h:column>
                        <f:facet name="header">Ação</f:facet>
                        <s:link id="editar" action="#{contatoAction.editarContato}"
                            value="Editar" />
                        <s:link id="remover" action="#{contatoAction.removerContato}"
                            value="Remover" />
                    </h:column>
                </rich:dataTable>
            </div>
        </rich:panel>
        <s:div styleClass="actionButtons">
            <s:button id="novo" action="#{contatoAction.novoContato}" value="Novo contato"/>
        </s:div>
    </ui:define>
</ui:composition> 
```

ContatoAction.java：

```
package org.domain.seam1.session;

import java.io.Serializable;
import java.util.List;
import javax.persistence.EntityManager;
import org.domain.seam1.entity.Contato;
import org.jboss.seam.ScopeType;
import org.jboss.seam.annotations.Begin;
import org.jboss.seam.annotations.End;
import org.jboss.seam.annotations.Factory;
import org.jboss.seam.annotations.In;
import org.jboss.seam.annotations.Name;
import org.jboss.seam.annotations.Out;
import org.jboss.seam.annotations.Scope;
import org.jboss.seam.annotations.datamodel.DataModel;
import org.jboss.seam.annotations.datamodel.DataModelSelection;

@Name("contatoAction")
@Scope(ScopeType.CONVERSATION)
public class ContatoAction implements Serializable{

    private static final long serialVersionUID = 4121233854017478226L;

    @In
    private EntityManager entityManager;

    @SuppressWarnings("unused")
    @DataModel
    private List<Contato> contatos;

    @DataModelSelection
    @Out(required=false)
    private Contato contato;

    @Factory("contatos")
    @SuppressWarnings("unchecked")
    public void listarContatos() {
        //seleciona todos os contatos
        contatos = entityManager.createQuery("select c from Contato c").getResultList();
    }

    @Begin
    public String novoContato() {
        contato = new Contato();

        return "novoContato";
    }

    @Begin
    public String editarContato() {
        //atualiza os dadis do contato para fazer a ediÃ§Ã£o
        entityManager.refresh(contato);

        return "editarContato";
    }

    public String removerContato() {
        //remove o contato
        entityManager.remove(contato);

        return "contatoRemovido";
    }

    @End
    public String salvarContato() {
        //se nÃ£o tem id Ã© porque deve ser inserido, caso contrÃ¡rio alterado
        if (contato.getId() == null) {
            entityManager.persist(contato);
        } else {
            entityManager.merge(contato);
        }

        return "contatoSalvo";
    }
} 
```

联系.java：

```
package org.domain.seam1.entity;

import java.io.Serializable;
import javax.persistence.Column;
import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.Id;

@Entity
public class Contato implements Serializable {

    private static final long serialVersionUID = 4121233854017478226L;

    @Id @GeneratedValue
    private Long id;

    @Column(length=50, nullable=false)
    private String nome;

    @Column(length=50, nullable=false)
    private String email;

    public Long getId() {
        return id;
    }

    public String getNome() {
        return nome;
    }

    public void setNome(String nome) {
        this.nome = nome;
    }

    public String getEmail() {
        return email;
    }

    public void setEmail(String email) {
        this.email = email;
    }

    /* (non-Javadoc)
     * @see java.lang.Object#hashCode()
     */
    @Override
    public int hashCode() {
        final int prime = 31;
        int result = 1;
        result = prime * result + ((email == null) ? 0 : email.hashCode());
        result = prime * result + ((nome == null) ? 0 : nome.hashCode());
        return result;
    }

    /* (non-Javadoc)
     * @see java.lang.Object#equals(java.lang.Object)
     */
    @Override
    public boolean equals(Object obj) {
        if (this == obj)
            return true;
        if (obj == null)
            return false;
        if (!(obj instanceof Contato))
            return false;
        Contato other = (Contato) obj;
        if (email == null) {
            if (other.email != null)
                return false;
        } else if (!email.equals(other.email))
            return false;
        if (nome == null) {
            if (other.nome != null)
                return false;
        } else if (!nome.equals(other.nome))
            return false;
        return true;
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T16:23:36.587

只需将 antlr.jar 文件从 antlr-2.7.6.jar 更改为 antlr-3.1.1.jar 即可解决我的错误

# php - 从 php 中的 MySQL 函数检索返回值

> ID：10742525
> 
> 赞同：2
> 
> 时间：2012-05-24T17:33:59.677
> 
> 标签：php, mysql, function, integer

> **可能重复：**
> [mysql_fetch_array() 期望参数 1 是资源，选择中给出的布尔值](https://stackoverflow.com/questions/2973202/mysql-fetch-array-expects-parameter-1-to-be-resource-boolean-given-in-select)

我有以下 MySQL 函数：

```
DELIMITER $$
DROP FUNCTION IF EXISTS DoUsernameAndPasswordMatch$$
CREATE FUNCTION DoUsernameAndPasswordMatch(
    UserLogin VARCHAR(20),
    UserPass VARCHAR(20)
)
RETURNS BOOLEAN
BEGIN
DECLARE userCount BOOLEAN;

    SELECT COUNT(*) INTO userCount
    FROM Users_Login 
    WHERE Users_Login.UserLogin = UserLogin AND Users_Login.UserPass = SHA1(UserPass);

    RETURN userCount;    
END$$
DELIMITER ; 
```

我像这样从 PHP 调用它：

```
$username_escaped = escapeMySQLParam($_POST["user"]);
$userpass_escaped = escapeMySQLParam($_POST["pass"]);

$mysql_query = "SELECT DoUsernameAndPasswordMatch('$username_escaped', '$userpass_escaped')";
$mysql_results = mysql_query($mysql_query);
$mysql_row = mysql_fetch_row($mysql_results); 
```

但我收到以下错误：

```
Warning: mysql_fetch_row() expects parameter 1 to be resource, 
boolean given in D:\xampp\webdesktop\login.php on line 22 
```

我了解该错误并尝试修复它并解决它但没有成功。是否可以在 PHP 中从 MySQL 中检索 INTEGER 值以及如何检索？

或者你能告诉我更好的方法来做到这一点。

感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T18:56:14.260

进行以下更改以使其正常工作：

```
 DELIMITER $$
DROP FUNCTION IF EXISTS DoUsernameAndPasswordMatch$$
CREATE FUNCTION DoUsernameAndPasswordMatch(
    UserLogin VARCHAR(20),
    UserPass VARCHAR(20)
) RETURNS TEXT
BEGIN
DECLARE userCount TEXT;

    SELECT COUNT(*) INTO userCount
    FROM Users_Login 
    WHERE Users_Login.UserLogin = UserLogin AND Users_Login.UserPass = SHA1(UserPass);

    RETURN userCount;    
END$$
DELIMITER ; 
```

# ios - 摆脱 ios uiwebview 上的视频按钮

> ID：10742531
> 
> 赞同：0
> 
> 时间：2012-05-24T17:34:23.223
> 
> 标签：ios, video, button, uiwebview, playback

有没有办法在检测到视频时摆脱巨大的 uiwebview 视频播放按钮。我只想显示一个没有播放按钮的视频屏幕。

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T18:23:41.193

如果您使用 HTML5 视频标签，则控件的外观被指定为属性，即

没有控制

```
<video  src="sample_mpeg4.mp4"></video> 
```

所有控件

```
<video  src="sample_mpeg4.mp4" controls></video> 
```

只有一个控件

```
<video  src="sample_mpeg4.mp4" controls="Volume"></video> 
```

PS 如果您希望视频在 UIWebView 内内联播放，您需要在 HTML 本身以及 UIWebView 实现中执行一些操作，如果需要，我可以添加此信息。

# .net - 使用 ThreadStatic 而不是 DI 容器有什么问题

> ID：10742532
> 
> 赞同：8
> 
> 时间：2012-05-24T17:34:27.363
> 
> 标签：.net, unit-testing, dependency-injection

我正在尝试使一个非常大、非常遗留的项目可测试。

我们的大多数代码都使用了许多静态可用的服务。问题是这些很难模拟。他们曾经是单身人士。现在它们是伪单例——相同的静态接口，但函数委托给可以切换的实例对象。像这样：

```
class ServiceEveryoneNeeds
{
    public static IImplementation _implementation = new RealImplementation();

    public IEnumerable<FooBar> GetAllTheThings() { return _implementation.GetAllTheThings(); }
} 
```

现在在我的单元测试中：

```
void MyTest()
{
    ServiceEveryoneNeeds._implementation = new MockImplementation();
} 
```

到现在为止还挺好。在产品中，我们只需要一个实现。但是测试并行运行并且可能需要不同的模拟，所以我这样做了：

```
class Dependencies
{
     //set this in prod to the real impl
     public static IImplementation _realImplementation;

     //unit tests set these
     [ThreadStatic]
     public static IImplementation _mock;

     public static IImplementation TheImplementation
     { get {return _realImplementation ?? _mock; } }

     public static void Cleanup() { _mock = null; }
} 
```

进而：

```
class ServiceEveryoneNeeds
{
     static IImplementation GetImpl() { return Dependencies.TheImplementation; }

     public static IEnumerable<FooBar> GetAllTheThings() {return GetImpl().GetAllTheThings(); }

}

//and
void MyTest()
{
    Dependencies._mock = new BestMockEver();
    //test
    Dependencies.Cleanup();
} 
```

我们采用这条路线是因为构造函数将这些服务注入到每个需要它们的类中是一个庞大的项目。同时，这些是我们代码库中大多数功能所依赖的通用服务。

我知道这种模式是不好的，因为它隐藏了依赖关系，而不是使依赖关系显式的构造函数注入。

但是好处是：
- 我们可以立即开始单元测试，而不是进行 3 个月的重构然后进行单元测试。
- 我们仍然有全局变量，但这似乎比我们原来的要好。

虽然我们的依赖关系仍然是隐含的，但我认为这种方法比我们拥有的方法要好得多。除了隐藏的依赖关系之外，这是否比使用适当的 DI 容器更糟糕？我会遇到什么问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T18:48:27.790

它是一个[糟糕的服务定位器](http://blog.ploeh.dk/2010/02/03/ServiceLocatorIsAnAntiPattern.aspx)。但你已经知道了。如果您的代码库如此庞大，为什么不开始部分迁移呢？向容器注册单例实例，并在您接触代码中的类时启动构造函数注入它们。然后，您可以将大部分零件留在（希望）工作状态，并在其他任何地方获得 DI 的好处。

理想情况下，没有 DI 的零件会随着时间的推移而收缩。您可以立即开始测试。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-24T23:54:16.343

这称为[环境上下文](http://blogs.msdn.com/b/ploeh/archive/2007/07/23/ambientcontext.aspx)。如果正确使用和实施，使用环境上下文没有任何问题。可以使用环境上下文时有一些先决条件：

1.  它必须是一个横切关注点，返回一些价值
2.  您需要一个本地默认值
3.  你必须确保`null`不能被分配。（改用[Null 实现](http://en.wikipedia.org/wiki/Null_Object_pattern)）

对于不返回值的横切关注点，例如日志记录，您应该更喜欢拦截。对于其他不是横切关注点的依赖项，您应该进行构造函数注入。

但是，您的实现有几个问题（不会阻止分配 null、命名、无默认值）。以下是如何实现它：

```
public class SomeCrossCuttingConcern
{
     private static ISomeCrossCuttingConcern default = new DefaultSomeCrossCuttingConcern();

     [ThreadStatic]
     private static ISomeCrossCuttingConcern current;

     public static ISomeCrossCuttingConcern Default
     { 
         get { return default; }
         set 
         { 
             if (value == null) 
                 throw new ArgumentNullException(); 
             default = value; 
         } 
     }

     public static ISomeCrossCuttingConcern Current
     { 
         get 
         { 
             if (current == null)
                 current = default; 
             return current; 
         }

         set 
         { 
             if (value == null) 
                 throw new ArgumentNullException(); 
             current = value; 
         } 
     }

     public static void ResetToDefault() { current = null; }
} 
```

环境上下文具有这样的优势，即您不会因横切关注点而污染您的 API。

但另一方面，关于测试，您的测试可能会变得依赖。例如，如果你忘记为一个测试设置你的模拟，如果模拟是由另一个测试设置的，它会正确运行。但是当它独立运行或以不同的顺序运行时，它将失败。它使测试更加困难。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T18:45:25.190

依赖注入和使用 DI 容器确实是独立的任务，尽管一个自然会导致另一个。使用 DI 容器意味着代码具有一定的结构。这样的结构可能更容易阅读，并且在不深入了解隐藏依赖关系的情况下肯定更容易工作，因此更易于维护。

现在您不再依赖于结核，您已经实现了一种控制反转的形式。我认为这是一个更好的设计，并且代表了使代码更具可测试性的良好起点。听起来您从这一步中获得了一些立竿见影的价值。

显式依赖比隐式依赖更好吗（换句话说，DI 与环境上下文）？我倾向于说是的，但这实际上取决于成本与收益。好处取决于诸如引入错误的成本，您可能在代码中看到多少流失，调试的难度，谁将维护它，它的预期寿命等。

全局可变静态总是不好的。一些聪明的人可能会决定他们需要在调用时替换全局服务的实现，然后再替换它。如果他们事后不清理，这可能会出错。这可能是一个愚蠢的例子，但这种意想不到的副作用总是不好的，所以最好通过设计完全消除它们。您可以通过纪律和警惕来阻止它们，但这更难。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-25T07:41:32.510

我觉得你做的还不错。您正在尝试使您的代码库可测试，而诀窍是通过小步骤来做到这一点。[在阅读《有效地使用遗留代码》](https://rads.stackoverflow.com/amzn/click/com/0131177052)时，你会得到同样的建议。然而，你正在做的事情的缺点是，一旦你开始使用依赖注入，你将不得不再次重构你的代码库。但更重要的是，您将不得不更改大量测试代码。

我同意亚历克斯。更喜欢使用构造函数注入而不是使用环境上下文。您不必为此直接重构整个代码库，但是构造函数注入会使调用堆栈“冒泡”，并且您必须在某些地方进行“剪切”以防止它冒泡，因为这会迫使您做出整个代码库有很多变化。

我目前正在处理遗留代码库，不能使用 DI 容器（痛苦）。我仍然尽可能使用构造函数注入，这有时意味着我必须恢复对某些类型使用[糟糕的依赖注入。](http://lostechies.com/chadmyers/2009/07/14/just-say-no-to-poor-man-s-dependency-injection/)这是我用来阻止“构造函数注入气泡”的技巧。不过，这比使用环境上下文要好得多。穷人的 DI 是次优的，但仍然允许您编写适当的单元测试，并且以后更容易打破默认构造函数。

# javascript - 我应该如何重写这段代码

> ID：10742535
> 
> 赞同：0
> 
> 时间：2012-05-24T17:34:32.340
> 
> 标签：javascript, backbone.js

这些函数 ( * ) 和 ( ** ) 在 a`Backbone.View`中，但我认为不需要 Backbone 的知识来解决这个问题。

正如您从我在代码中的注释中看到的那样：
1）我调用该`getAvatar`函数一切正常，
2）当 getAvatar 调用时，`setAvatar`某些东西被破坏了

我应该如何解决以下问题？

* * *

( * )

```
 getAvatar: function ()
    {
        var creatorIds = this.getCreatorIds();
        console.log(creatorIds); // [1,2]  ******  here is ok *******

        for (var c = 0, l = creatorIds.length; c < l; c += 1) {
            if (typeof this.avatars[creatorIds[c]] === 'undefined') {
                this.userModel = new UserModel({id: creatorIds[c]});
                this.userModel.fetch();
                this.userModel.on('change', this.setAvatar, this);      
            }
        }
    }, 
```

* * *

( ** )

```
 setAvatar: function ()
    {       
        console.log(this.userModel.get('id')); // 2, 2  *********  it should be 1, 2  *******
        this.names[this.userModel.get('id')] = this.userModel.get('name');
        this.avatars[this.userModel.get('id')] = typeof this.userModel.get('avatar');
        this.render();
    }, 
```

* * *

( *** )

```
initialize: function ()
{
     _.bindAll(this, 'getAvatar', 'setAvatar');
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T18:16:17.593

看起来backbone.js 有第三个参数用于[上下文](http://documentcloud.github.com/backbone/#Events-on)

```
object.on(event, callback, [context]) 
```

你的代码是

```
getAvatar: function ()
{
    var creatorIds = this.getCreatorIds();
    console.log(creatorIds); // [1,2]  ******  here is ok *******

    for (var c = 0, l = creatorIds.length; c < l; c += 1) {
        if (typeof this.avatars[creatorIds[c]] === 'undefined') {
            this.userModel = new UserModel({id: creatorIds[c]});
            this.userModel.fetch();
            this.userModel.on('change', this.setAvatar, this );  //added this after the function.
        }
    }
}, 
```

或者你可以使用闭包

```
getAvatar: function ()
{
    var that = this;  //variable to maintain scope
    var creatorIds = this.getCreatorIds();
    console.log(creatorIds); // [1,2]  ******  here is ok *******

    for (var c = 0, l = creatorIds.length; c < l; c += 1) {
        if (typeof this.avatars[creatorIds[c]] === 'undefined') {
            this.userModel = new UserModel({id: creatorIds[c]});
            this.userModel.fetch();
            this.userModel.on('change', function(){ that.setAvatar(); } );  //use a closure here with that variable that which is defined above.    
        }
    }
}, 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T20:35:55.010

问题是您分配了两次相同的变量。在`getAvatar()`中，您将首先设置`this.userModel`为 id == 1 的 UserModel。然后在下一次循环迭代中，将为其分配 id == 2 的 UserModel。

当该`setAvatar()`函数被点击时，它会查看`this.userModel`并且只看到您设置的一个值。您应该尽量不要使用实例变量来存储模型。

这是修复它的一种方法。可能有更简单的方法来修复它，但很难从给出的代码示例中分辨出来。我还添加了一些关于代码中一些奇怪之处的评论。

( * )

```
getAvatar: function ()
{
    var creatorIds = this.getCreatorIds();
    console.log(creatorIds); // [1,2]  ******  here is ok *******

    var self = this;

    for (var c = 0, l = creatorIds.length; c < l; c += 1) {
        if (typeof this.avatars[creatorIds[c]] === 'undefined') {
            var user = new UserModel({id: creatorIds[c]});

            //probably better to bind the handler first, in case fetch() completes synchronously from cache
            user.on('change', function(){
                console.log(user.get('id'));
                self.names[user.get('id')] = user.get('name');
                self.avatars[user.get('id')] = typeof user.get('avatar'); //are you sure you want typeof here?
                self.render(); //Note, this will get called a lot. Are you sure you want to do this?
            });   

            user.fetch();   
        }
    }
} 
```

# qooxdoo - Qooxdoo -- 如何将图标绑定到 VirtualTree 的项目

> ID：10742536
> 
> 赞同：0
> 
> 时间：2012-05-24T17:34:32.987
> 
> 标签：qooxdoo

我正在使用 VirtualTree 作为映射应用程序的图层选择器，并且我试图让“图层”或“文件”在图层处于活动状态时显示绿色图标，而当图层处于非活动状态时显示灰色图标。

你可以吗...

1.  设置选择的图标？或者
2.  将 VirtualTree 项目的图标绑定到数组的布尔属性？

我看到有一个属性：iconOptions 带有一个地图，它引用了 qx.data.SingleValueBinding，但是如何实际实现它让我很困惑。我的树是使用以下方法创建的：

```
var store = new qx.data.store.Json(url);
store.bind("model", tree, "model"); 
```

我试过：

```
tree.setIconPath("icon"); 
```

但这要求我的 JSON 文件的每个元素都有一个图标属性来显示文件夹/文件，并且不允许多个（开/关）功能。

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-03T10:27:36.030

看看[虚拟树演示](http://demo.qooxdoo.org/current/demobrowser/index.html#virtual~Tree_Dynamic.html)。使用 setIconOption，您可以在决定设置哪种类型的图标时指定一个考虑其他数据的转换器。

# selenium - 使用 HTML Selenese 进行 Selenium 测试

> ID：10742548
> 
> 赞同：1
> 
> 时间：2012-05-24T17:35:25.307
> 
> 标签：selenium

我正在使用 selenium maven 插件和 HTML selenese 脚本在 Selenium 中进行一些测试。除了我遇到的这种情况外，一切都运行良好：我正在单击提交按钮，它会将我带到重定向 url。该 URL 的服务器未运行，但重定向 URL 的 Web 服务创建代码查询参数并将其添加到重定向 URL。我希望能够单击提交并使用 storeLocation selenese 命令提取重定向 url 并提取该代码参数。当我使用 clickAndWait 时，会发生重定向，但测试失败，因为页面尝试加载并最终构建 maven。当我使用 just click 命令时，测试通过，但页面未加载，并且 storeLocation 不包含我需要的带有 code 参数的重定向 url 的值。任何人都知道如何让硒点击并等待，但忽略页面不会加载的事实？我认为它需要涉及一些 javascript，并且可能需要使用 waitForCondition 命令，但我找不到任何正在完成的示例。基本上，重定向 URL 没有运行它的服务器，但是我的服务创建了一个令牌参数，我需要从中提取并将其传递给另一个测试用例

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-17T20:33:10.770

页面加载超时了吗？如果是这样，您可以增加默认超时（尽管应该是 30 秒），或者您可以使用 click 事件，然后执行 waitForLocation 以匹配您想要的新 URL（带有重定向参数）。这会给你另一个等待（如点击并等待）30 秒。但是您也可以在单击和等待之间添加暂停命令，以延长页面加载时间，而无需触及默认超时。

# linq - 如何编写也可以用作 LIKE 运算符的 LINQ IN 子句查询？

> ID：10742550
> 
> 赞同：4
> 
> 时间：2012-05-24T17:35:33.557
> 
> 标签：linq, entity-framework, linq-to-entities, sql-like, in-clause

我们如何为以下 select sql 查询编写 LINQ 查询：

```
string brandid="1,2,3"
string bodystyleid="1,2,3"
-------------------
-----------------

select * from car
where brandid in (brandid)
and bodystyleid in (brandid)
----------------------
------------------- 
```

我的具体要求是，如果brandid 或bodystyleid 为空白（如果用户没有选择特定搜索选项的任何复选框）查询应该返回该特定where 条件的所有记录。

请指导我。

谢谢，

保罗

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-24T18:07:16.183

为了满足您在未指定任何项目的情况下返回所有项目的要求，您需要检查列表是否为空。

```
var brands = brandid.Split(',').Select(x => Int32.Parse(x));
var styles = bodystyleid.Split(',').Select(x => Int32.Parse(x));

var result = from c in car
             where (!brands.Any() || brands.Contains(c.brandid))
                  && (!styles.Any() || styles.Contains(c.bodystyleid))
             select c; 
```

（类似于 sgmoore 的解决方案，但包括检查未指定品牌/样式）

我实际上并没有检查它是如何转换回 SQL 的——使用标志来指示是否有任何值可能更有效：

```
var brands = ....;   // As above
bool anyBrands = brands.Any()
var result = from c in car
             where (!anyBrands || brands.Contains(c.brandid))
               ..... 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-24T17:37:45.793

bodystyleid 是用来检查brandid 还是bodystyleid？（我假设bodystyleid，但是已经编写了查询以匹配问题中的查询（brandid））

作为开始，你可以这样做：

```
var results = (from c in car
               where c.brandid.Contains(brandid)
               && c.bodystyleid.Contains(brandid)
               select c).ToList(); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-24T17:52:05.077

```
var brandids     = brandid    .Split(',').Select(n => int.Parse(n)).ToList();
var bodyStyleids = bodystyleid.Split(',').Select(n => int.Parse(n)).ToList();

var results =
    (from c in car where 
      brandids.Contains(c.brandid) && 
      bodyStyleids.Contains(c.bodystyleid) 
     select c
   ).ToList(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-24T17:50:18.580

您拥有的`Id`s 是带有逗号分隔符的字符串，您需要它们是与表的 s`List`相同类型的集合，因此如果列必须是，那么您可以这样做`Id``Car``brandid``int``brandids``List<long>`

```
var results = (
    from c in cars
    where brandids.Contains(c.brandid) && bodystyleid.Contains(c.bodystyleid) 
    select c).ToList(); 
```

# ruby - 如何获取块中元素的数量？

> ID：10742558
> 
> 赞同：1
> 
> 时间：2012-05-24T17:36:03.853
> 
> 标签：ruby

我有两个文件`init.rb`和`airport.rb`.

如何计算与该值匹配的项目数？

初始化.rb：

```
airport1.airplanes_count { |a| a.aircraft_type == "Boeing 747" } 
```

机场.rb：

```
def airplanes_count
  @airplanes.each  { |a|  a if yield(a)  }
end 
```

如果`aircraft_type`= 波音 747，我需要获得一些飞机：

```
=> 2 
```

而不是飞机名称

```
=> #<Airplane:0x0000000155e348>
   #<Airplane:0x0000000155e028>" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T17:43:51.547

Ruby 已经为[`count`](http://ruby-doc.org/core-1.9.3/Enumerable.html#method-i-count)所有枚举器（如哈希、数组......）带来了一个方法。您可以像这样“转发”您的块：

```
def airplanes_count(&block)
  @airplanes.count(&block)
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T17:42:30.383

您的方法应如下所示：

```
def airplanes_count
    @airplanes.count{ |a|  a if yield(a)  }
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T17:51:20.820

有更好的方法可以做到这一点......但是......如果您不想更改太多代码，您可以将 planes_count 的主体更改为这一行。

```
def airplanes_count
    @airplanes.inject(0)  { |count,a|  yield(a)?  (count + 1) : count  }
end 
```

这将为您提供您正在寻找的东西。

# iphone - iOS：静音模式下无法播放我的声音

> ID：10742559
> 
> 赞同：0
> 
> 时间：2012-05-24T17:36:09.170
> 
> 标签：iphone, objective-c, ios, audio, audiotoolbox

所以我已经完成了我能找到的关于 SO 的大部分相关问题，但我仍然无法在静音时播放我的音频。我相信这可能是我犯的一个小错误。

我正在尝试播放一个小的警报声。这是我`viewDidLoad`方法中的代码：

```
AudioSessionInitialize (NULL, NULL, NULL, NULL);
AudioSessionSetActive(true); 
```

这是我需要播放音频剪辑时调用的方法

```
-(void)playAudioClip:(CFStringRef)clip{

CFBundleRef mainBundle = CFBundleGetMainBundle();
CFURLRef soundFile = CFBundleCopyResourceURL(mainBundle, clip, CFSTR("wav"), NULL);

//Supposed to make sound playable even when silent right?
UInt32 soundType = kAudioSessionCategory_MediaPlayback; 
UInt32 soundID;

AudioSessionSetProperty(kAudioSessionProperty_AudioCategory, sizeof(soundType), &soundType);
AudioServicesCreateSystemSoundID(soundFile, &soundID);
AudioServicesPlaySystmSound(soundID);
} 
```

我从 SO 中得到了大部分内容，并在 Apple 编程指南中确认了这一点。我已经尝试将`Uint32`两者结合使用，但这也没有做任何事情，在锁定/静音模式下仍然没有播放。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T17:52:38.430

在静音模式下不播放系统声音。（顾名思义）如果您需要在静音时播放音频，您需要使用不同的方法，如媒体播放器或其他音频方法。查看 Apple 播放音乐的示例。

# php - 如何创建语义搜索

> ID：10742561
> 
> 赞同：0
> 
> 时间：2012-05-24T17:36:27.710
> 
> 标签：php, mysql, sql, database

我想创建一个搜索框，而不是在查询中使用 WHERE cluse 来匹配字段中的确切短语，我希望搜索框能够执行语义搜索，以便当用户输入部分短语时，它会在能够匹配短语含义的情况下显示合适的结果。当您尝试通过 Google 进行搜索时，Google 究竟是如何工作的。这有可能实现吗？有人有什么想法吗？

下面是我目前使用的代码，以便能够使用数据库来查看一行是否与在搜索框中输入的确切短语匹配：

```
 <?php

    //connected to DB

          foreach (array('questioncontent') as $varname) {
            $questioncontent = (isset($_POST[$varname])) ? $_POST[$varname] : '';
          }

    ?>

    <p>Search for a previous question by entering in a phrase in the search box below and submitting the phrase</p>

    <form action="previousquestions.php" method="post" id="modalform">
          <p>Search: <input type="text" name="questioncontent" value="<?php echo $questioncontent; ?>" /></p>
          <p><input id="searchquestion" name="searchQuestion" type="submit" value="Search" /></p>
          </form>

    <?php 
                if (isset($_POST['searchQuestion'])) {

                  $questionquery = "SELECT QuestionContent FROM Question
              WHERE(QuestionContent = '".mysql_real_escape_string($questioncontent)."')";

          $questionnum = mysql_num_rows($questionresult = mysql_query($questionquery));

          if($questionnum !=0){

          $output = "";

            while ($questionrow = mysql_fetch_array($questionresult)) {

    $output .= "
          <table>
          <tr>
          <td>{$questionrow['QuestionContent']}</td>
          </tr>";
            }
            $output .= "        </table>";

            echo $output;

      }

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T17:42:31.360

您正在寻找“自动完成”功能。试试这些 php + mysql 教程：

[jquery-php-mysql-ajax-自动完成](http://beski.wordpress.com/2009/11/20/jquery-php-mysql-ajax-autocomplete/)

[Stackoverflow jquery 自动完成](https://stackoverflow.com/questions/5305294/jquery-autocomplete-mysql-php)

[关于自动完成的博客](http://www.jackbarber.co.uk/blog/20/Blog)

[ajax-自动完成-使用-php-mysql](http://www.sks.com.np/article/9/ajax-autocomplete-using-php-mysql.html)

[jquery-ui-autocomplete-widget-with-php-and-mysql](http://www.jensbits.com/2010/03/29/jquery-ui-autocomplete-widget-with-php-and-mysql/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T17:51:06.607

如果您正在寻找 PHP 搜索引擎教程，请观看此[YouTube 视频](http://www.youtube.com/watch?v=PdM2ZIG9yR0)- 它可能会有所帮助。

# linux - 安装脚本需要设置一个程序在 Linux 中登录时运行

> ID：10742564
> 
> 赞同：-1
> 
> 时间：2012-05-24T17:36:41.543
> 
> 标签：linux, installation, gnome, kde

我需要编写一个安装脚本，在 Linux 中登录（而不是启动）运行可执行文件/脚本。这需要适用于所有可以登录系统的当前用户以及将来创建的用户。有没有办法做到这一点？

在 Windows 中，这可以通过在“所有用户”的启动文件夹中放置一个快捷方式来实现。Linux中是否有类似的位置/初始化脚本？如果没有，是否有任何替代方案？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T17:38:25.307

用户 ~/.bash_profile 或 ~/.profile 取决于 shell 在登录时执行。你可以添加它。如果你想为每个用户使用它，你可以把它放在 /etc/profile.

# json - 是否可以使用 Stripe API 查询日期时间范围？

> ID：10742566
> 
> 赞同：13
> 
> 时间：2012-05-24T17:36:49.550
> 
> 标签：json, api, http, stripe-payments

使用[Stripe API](https://stripe.com/docs/api)，我希望能够查询日期*范围*，或者如果没有查询，则可以查询*大于*或*小于*某个任意日期的日期。

我知道我可以根据*确切*日期查询某些内容，例如：

```
https://api.stripe.com/v1/events?created=1336503409 
```

但我想要一些类似的东西......

```
# Search for events where `created` is greater than the epoch time: 1336503400
https://api.stripe.com/v1/events?created__gt=1336503400 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-25T05:25:17.540

是的。来自[https://stripe.com/docs/api?lang=curl#list_events](https://stripe.com/docs/api?lang=curl#list_events)

> **created**：基于事件创建日期的列表过滤器。该值可以是具有精确 UTC 时间戳的字符串，**也可以是具有以下选项的字典**：
> 
> **gt**（可选）应在此时间戳之后创建返回值。
> 
> **gte**（可选）返回值应该在此时间戳之后或等于该时间戳之后创建。
> 
> **lt**（可选）返回值应该在此时间戳之前创建。
> 
> **lte**（可选）返回值应该在此时间戳之前或等于该时间戳之前创建。

因此，使用 curl，您可以构建这样的请求：

```
curl "https://api.stripe.com/v1/events?created%5Blt%5D=1337923293" \
 -u ${YOUR_API_KEY}: 
```

未*转义*的查询参数是`created[lt]=1337923293`.

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-12-23T00:44:49.797

如果您正在寻找如何使用[ruby​​ 客户端](https://github.com/stripe/stripe-ruby)来执行此操作，那么它是：

```
Stripe::Charge.all(limit: 100, 'created[lt]' => timestamps }) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-02-02T21:54:19.260

沿着同样的路线。您可以使用 Python 客户端实现相同的目的，如下所示：

```
import stripe
from datetime import datetime, timedelta

my_date = '1/31/2011'
my_timestamp = datetime.strptime(my_date, "%m/%d/%Y").timestamp()

stripe.Charge.all(created={'lt': my_timestamp}) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-11-04T11:12:22.760

对于我们这些使用 Go Api 的人，以下两种格式都适用于选择范围：

```
params := &stripe.ChargeListParams{}
params.Filters.AddFilter("created", "lt", strconv.Itoa(1592217599))
params.Filters.AddFilter("created", "gt", strconv.Itoa(1591612124)) 
i := charge.List(params) 
```

* * *

```
params := &stripe.ChargeListParams{}
params.Filters.AddFilter("created[lt]", "", strconv.Itoa(1592217599))
params.Filters.AddFilter("created[gt]", "", strconv.Itoa(1591612124))
i := charge.List(params) 
```

# java - FocusListener 回调方法不适用于来自同一变量的单独实例化对象？

> ID：10742567
> 
> 赞同：0
> 
> 时间：2012-05-24T17:37:02.167
> 
> 标签：java, constructor, callback, focuslistener

我目前正在研究我们小组第一学期考试项目的 GUI 部分，我遇到了一个关于回调和事件处理的奇怪问题。

有点跑题了：我已经用谷歌搜索了这个，但是真的没有找到在 Java 中使用回调的任何具体例子，所以从我收集的内容来看......根据定义......我在这里做的实际上是一个回调（如果你能解释原因会很棒，或者指向一个详细解释它的页面）

这是代码：

```
private FocusListener callback = new FocusListener(){
    @Override public void focusGained(FocusEvent e){
        if(hasBeenSet){}else{tfield.setText("");hasBeenSet=true;}
    } @Override public void focusLost(FocusEvent e){}};

    ...

    tfield = new JTextField("Insert CPR number", 8);
    constraint.gridx = 0;
    constraint.gridy = 1;
    constraint.gridwidth = 2;
    panel.add(tfield, constraint);

            tfield.addFocusListener(callback);

    tfield = new JTextField("Type new password", 8);
    constraint.gridx = 0;
    constraint.gridy = 2;
    panel.add(tfield, constraint);

            tfield.addFocusListener(callback);

    tfield = new JTextField("Retype new password", 8);
    constraint.gridx = 0;
    constraint.gridy = 3;
    panel.add(tfield, constraint);

            tfield.addFocusListener(callback); 
```

当我启动 GUI 时，它具有这三 (3) 个文本字段，其想法是在用户关注文本字段时删除文本。这应该适用于所有三个文本字段，但显然，无论您单击什么文本字段，只有最后一个文本字段被设置为空字符串。我对此非常好奇，因为每个对象都是单独实例化的。

这里明显的解决方法是将 tfield 重命名为喜欢“tfield [1-3]”，但如果你能用这个来幽默我会很棒:)

另外：请注意，所有的 GUI 代码实际上都在构造函数中。是的，我知道这完全是荒谬的，但我们的设计表明所有逻辑和数据处理都将在构造函数完成后发生......所以这里不应该有任何威胁，但我不知道这是否会以某种方式与 FocusListener 的回调方法发生冲突。

谢谢你。:)

PS 对于“重新/键入新密码”字段，我确实承认 JComponent JPasswordField，并且在此问题修复后将更改。所以不需要安全警告:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T17:46:51.850

该`tfield`变量保存对 的*最后一个*实例的引用`JTextField`。做你想做的事情是这样的：

```
private FocusListener callback = new FocusListener() {
    @Override public void focusGained(FocusEvent e){
        JTextField jtf = (JTextField) e.getSource();
        if(hasBeenSet){}else{jtf.setText("");hasBeenSet=true;}
    }
    ... 
```

注意：当您的代码读取时，`hasBeenSet`将在所有 3 个文本字段中共享。

**更新：**

Java 不支持闭包，因此在`focusGained`运行时，它会看到 的最后一个值`tfield`，而不是`tfield`安装侦听器时的值。

它看起来`hasBeenSet`被定义为外部类的成员，因此`focusGained`正在检查所有 3 个文本字段的*相同*变量。这是一种处理我认为您正在尝试做的事情的方法：

```
tfield = new JTextField("Insert CPR number", 8);
tfield.putClientProperty("originalText", tfield.getText()); 
```

然后在焦点上获得了：

```
 @Override public void focusGained(FocusEvent e){
        JTextField jtf = (JTextField) e.getSource();
        if(jtf.getClientProperty("originalText").equals(jtf.getText())){
             jtf.setText("");
        }
    } 
```

这些`putClientProperty/getClientProperty`方法是在`JComponent`类中定义的，因此这些方法在每个从`JComponent`. 他们存储/检索`Object`给定的字符串。在这种情况下，字符串“originalText”包含最初用于初始化`JTextField`. 获得焦点后，如果该字段仍包含该值，则将其设置为空白。同样，您可以执行类似的操作`focusLost`，如果该字段为空白，则将其设置为为“originalText”检索的值。

# java - 使用远程 api 的 appengine 文件服务

> ID：10742568
> 
> 赞同：1
> 
> 时间：2012-05-24T17:37:05.790
> 
> 标签：java, google-app-engine

我正在尝试以编程方式将一些文件上传到 blobstore 并更新数据存储中的某些内容。可以使用专门的 servlet 和 CURL 来完成，但使用远程 api 会更优雅。是否可以通过 appengine 的远程 API 使用文件服务？如果是，为什么在执行 bos.write(b) 时会出现此异常？感谢代码：

```
String localFileName = "c:\\actcut fail.jpg";
                AppEngineFile aeF = fileService.createNewBlobFile("", "actcutfail.jpg");
                FileWriteChannel writeChannel = (FileWriteChannel) fileService.openWriteChannel(aeF, true); 
                BufferedOutputStream bos = new BufferedOutputStream(Channels.newOutputStream(writeChannel));
                FileInputStream fis = new FileInputStream(localFileName);
                try {
                    while (true) {
                        int b = fis.read();
                        bos.write(b);
                    }
                } catch (EOFException eofex) {
                    // end of file reached
                } catch (Exception ex) {
                    ex.printStackTrace();
                } finally {
                    fis.close();
                    bos.flush();
                    bos.close();
                    writeChannel.closeFinally();
                    System.out.println("uploaded blob file with key=" + fileService.getBlobKey(aeF).getKeyString());
                } 
```

例外：

```
java.io.IOException
    at com.google.appengine.api.files.FileServiceImpl.translateException(FileServiceImpl.java:601)
    at com.google.appengine.api.files.FileServiceImpl.makeSyncCall(FileServiceImpl.java:574)
    at com.google.appengine.api.files.FileServiceImpl.append(FileServiceImpl.java:510)
    at com.google.appengine.api.files.FileServiceImpl.append(FileServiceImpl.java:255)
    at com.google.appengine.api.files.FileWriteChannelImpl.write(FileWriteChannelImpl.java:52)
    at com.google.appengine.api.files.FileWriteChannelImpl.write(FileWriteChannelImpl.java:44)
    at java.nio.channels.Channels.write(Channels.java:63)
    at java.nio.channels.Channels.access$000(Channels.java:47)
    at java.nio.channels.Channels$1.write(Channels.java:134)
    at java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:65)
    at java.io.BufferedOutputStream.write(BufferedOutputStream.java:78)
    at cri.uploaddevalle.UploadDevalle.main(UploadDevalle.java:61)
Caused by: com.google.apphosting.api.ApiProxy$ApplicationException: ApplicationError: 10: File not opened: /blobstore/writable:GlPgcwTQdPtgYVY_Jpk9hg
    at com.google.appengine.api.files.dev.LocalFileService.throwError(LocalFileService.java:206)
    at com.google.appengine.api.files.dev.LocalFileService.append(LocalFileService.java:352)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at com.google.appengine.tools.development.ApiProxyLocalImpl$AsyncApiCall.callInternal(ApiProxyLocalImpl.java:498)
    at com.google.appengine.tools.development.ApiProxyLocalImpl$AsyncApiCall.call(ApiProxyLocalImpl.java:452)
    at com.google.appengine.tools.development.ApiProxyLocalImpl$AsyncApiCall.call(ApiProxyLocalImpl.java:430)
    at java.util.concurrent.Executors$PrivilegedCallable$1.run(Executors.java:463)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.util.concurrent.Executors$PrivilegedCallable.call(Executors.java:460)
    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)
    at java.util.concurrent.FutureTask.run(FutureTask.java:138)
    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
    at java.lang.Thread.run(Thread.java:619)
java.io.IOException
    at com.google.appengine.api.files.FileServiceImpl.translateException(FileServiceImpl.java:601)
    at com.google.appengine.api.files.FileServiceImpl.makeSyncCall(FileServiceImpl.java:574)
    at com.google.appengine.api.files.FileServiceImpl.append(FileServiceImpl.java:510)
    at com.google.appengine.api.files.FileServiceImpl.append(FileServiceImpl.java:255)
    at com.google.appengine.api.files.FileWriteChannelImpl.write(FileWriteChannelImpl.java:52)
    at com.google.appengine.api.files.FileWriteChannelImpl.write(FileWriteChannelImpl.java:44)
    at java.nio.channels.Channels.write(Channels.java:63)
    at java.nio.channels.Channels.access$000(Channels.java:47)
    at java.nio.channels.Channels$1.write(Channels.java:134)
    at java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:65)
    at java.io.BufferedOutputStream.flush(BufferedOutputStream.java:123)
    at cri.uploaddevalle.UploadDevalle.main(UploadDevalle.java:69)
Caused by: com.google.apphosting.api.ApiProxy$ApplicationException: ApplicationError: 10: File not opened: /blobstore/writable:GlPgcwTQdPtgYVY_Jpk9hg
    at com.google.appengine.api.files.dev.LocalFileService.throwError(LocalFileService.java:206)
    at com.google.appengine.api.files.dev.LocalFileService.append(LocalFileService.java:352)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at com.google.appengine.tools.development.ApiProxyLocalImpl$AsyncApiCall.callInternal(ApiProxyLocalImpl.java:498)
    at com.google.appengine.tools.development.ApiProxyLocalImpl$AsyncApiCall.call(ApiProxyLocalImpl.java:452)
    at com.google.appengine.tools.development.ApiProxyLocalImpl$AsyncApiCall.call(ApiProxyLocalImpl.java:430)
    at java.util.concurrent.Executors$PrivilegedCallable$1.run(Executors.java:463)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.util.concurrent.Executors$PrivilegedCallable.call(Executors.java:460)
    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)
    at java.util.concurrent.FutureTask.run(FutureTask.java:138)
    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
    at java.lang.Thread.run(Thread.java:619) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-25T04:54:44.320

目前，remote_api 不完全支持文件 API。您应该能够使用它获取文件上传 URL，但如果您想实际上传文件，则需要发布到自定义 servlet。

# regex - Apache 重写/重定向目录到查询字符串

> ID：10742569
> 
> 赞同：0
> 
> 时间：2012-05-24T17:37:13.497
> 
> 标签：regex, apache, mod-rewrite

我计划学习 mod_rewrite 的来龙去脉，但我有一个问题我想在开始之前解决，而且我可能只是在这里遗漏了一些小东西。

我想强制将任何包含数字的目录重定向`[0-9]{1,4}`到带有该数字查询字符串的单个 php 文件。

例如

```
http://example.com/23 
```

或者

```
http://example.com/23/ 
```

将重定向到：

```
http://example.com?23 
```

（.php 文件是我的索引）

目前我有以下内容：

```
RewriteCond  $/([0-9]{1,4})/^
RewriteRule  $/([0-9]+)^ ?%1 [R] 
```

这引发了`500`...

谢谢你的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T19:36:00.770

尝试

```
RewriteCond %{REQUEST_FILENAME} !-f 
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^([0-9]{1,4})$ ?$1 [QSA,L] 
```

# .net - 如何从 U2 Toolkit for .NET 访问多值数据？

> ID：10742570
> 
> 赞同：1
> 
> 时间：2012-05-24T17:37:19.197
> 
> 标签：.net, u2, unidata, u2netdk

尝试从 U2 数据文件中选择 * 时收到以下消息。

`[U2][UCINET][UNIDATA]:Multi-value or multi-subvalue are not supported in this version\r\n"`

是否有没有出现此错误的版本，如果我只选择一个字段，我不会收到错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T17:44:56.640

您需要在 U2ConnectionStringBuilder 类中设置属性“FirstNormalForm=false”。例如：

```
 U2ConnectionStringBuilder conn_str = new U2ConnectionStringBuilder();
            conn_str.UserID = "user";
            conn_str.Password = "pass";
            conn_str.Server = "localhost";
            conn_str.Database = "XDEMO";
            conn_str.ServerType = "UNIVERSE";
            conn_str.FirstNormalForm = false;

            U2Connection con = new U2Connection();
            con.ConnectionString = conn_str.ToString();
            con.Open();
            ....... 
```

对于 UniVerse 数据库：SQL 语句：SELECT FNAME,PRICE,BUY_DATE FROM UNNEST CUSTOMER ON ORDERS（PRICE 和 BUY_DATE 是多值属性）

对于 UniData 数据库：SQL 语句：SELECT * FROM STUDENT UNNEST NL_ALL CGA（FNAME、...、SEMESTER 是多值属性）

# jpa - 在 jpa 实体中指定 lob 大小

> ID：10742572
> 
> 赞同：9
> 
> 时间：2012-05-24T17:37:44.010
> 
> 标签：jpa, blob

我正在使用 openjpa (Websphere Application Server 7) 与数据库进行交互。是否可以在 java 实体文件中指定 blob 大小？看起来像：

```
@Id
@GeneratedValue(strategy = GenerationType.AUTO)
private Long id;

@Lob
@Nullable
private byte[] content; 
```

默认情况下，DB2 给它的大小为 1MB。我想将其更改为 20MB。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-24T18:38:42.863

您可以使用`@Column`注释：

```
@Id
@GeneratedValue(strategy = GenerationType.AUTO)
private Long id;

@Lob
@Nullable
@Column(length = 20971520)
private byte[] content; 
```

# java - PSQLException 没有被捕获

> ID：10742577
> 
> 赞同：3
> 
> 时间：2012-05-24T17:38:01.267
> 
> 标签：java, postgresql, tomcat, sqlexception

我正在使用 Tomcat 6 和 Postgresql 8.4。我的代码如下所示：

```
try {
  // Prepared statement inserting something...
} catch (final PSQLException e) {
  LOG.log(Level.SEVERE, "Saving failed.", e);
} catch (final SQLException e) {
  LOG.log(Level.SEVERE, "Saving failed (SQL).", e);
} 
```

这个插入 DB 可能会导致我想用第一个`catch`. 但是，我在日志中实际发现的是：

```
SEVERE: Saving failed (SQL).
org.postgresql.util.PSQLException: ERROR: duplicate key value violates unique constraint "UZIVATELIA_U_LOGIN"
    at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2102)
    at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1835)
    at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:257)
    at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:500)
    at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:388)
    at org.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:273)
    at org.apache.commons.dbcp.DelegatingPreparedStatement.executeQuery(DelegatingPreparedStatement.java:96)
    at org.apache.commons.dbcp.DelegatingPreparedStatement.executeQuery(DelegatingPreparedStatement.java:96)
    at cz.ecoremedia.realpad.web.backend.Users.saveNewUser(Users.java:119)
    at cz.ecoremedia.realpad.web.backend.Users.saveUser(Users.java:237)
    at org.apache.jsp.User_jsp._jspService(User_jsp.java:159)
    at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
    at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:388)
    at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)
    at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:293)
    at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:859)
    at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:602)
    at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)
    at java.lang.Thread.run(Thread.java:662) 
```

如果我检查`e`我捕获的类型，例如这样：

```
} catch (final SQLException e) {
  LOG.log(Level.SEVERE, e.getClass().getName());
  LOG.log(Level.SEVERE, "Saving failed (SQL).", e); 
```

它仍然告诉我它是`org.postgresql.util.PSQLException`。

当我在我的 Eclipse 中本地尝试这个时，它工作得很好——在第一个块`PSQLException`中被正确捕获。`catch`

如果我正确理解了这个问题，那么I catch 是一个与实际抛出`org.postgresql.util.PSQLException`的不同的类。`org.postgresql.util.PSQLException`这怎么可能？我究竟做错了什么？

谢谢你的想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T15:28:08.603

事实证明，我的 Tomcat`lib/`文件夹中有另一个 JDBC 驱动程序，除了`WEB-INF/lib/`. 删除 Tomcat 解决了我的问题。

（是的，这是一个不同的类加载器问题，感谢@NathanHughes。）

# android - 将联系人的图片加载到 ListView（第 2 部分）

> ID：10742578
> 
> 赞同：0
> 
> 时间：2012-05-24T17:38:02.470
> 
> 标签：android, image, contactscontract

我已经根据那里的答案修改[了这个问题的代码，以便在 ListView 上加载联系人的图片。](https://stackoverflow.com/questions/8338038/load-a-contacts-picture-into-a-listview-instead-of-the-default)我正在获取 Photo_id，并使用它来获取联系人的位图，使用 loadContactPhoto(ContentResolver cr, long id) 。问题是没有 ImageView 正在获取新图像，尽管照片 ID 总是不同的。我尝试使用Contact._ID，但仍然只有两个联系人的ImageView得到了联系人图片，而且他们都错了。我已经评论了我在下面添加的新行。

这是修改后的代码：

联系库存：

```
public class ContactStock {

private String name;
private String number;
private Bitmap picture;

public ContactStock(String name, String number) {
    this.name = name;
    this.number = number;
}

public ContactStock(String name, String number, Bitmap photo) {
    this.name = name;
    this.number = number;
    this.picture = photo;
}

public void setName(String name) {
    this.name = name;
}

public void setNumber(String number) {
    this.number = number;
}

public String getName() {
    return this.name;
}

public String getNumber() {
    return this.number;
}

public void setPicture(Bitmap picture) { // NEW METHOD
    this.picture = picture;
}

public Bitmap getPicture() { // NEW METHOD
    return picture;
}
} 
```

联系人添加列表：

```
 public class addlistfromcontact extends Activity {
private ListView lst;
private List<ContactStock> contactstock;
private Cursor mCursor;

@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setContentView(R.layout.tab_contact_list);
    lst = (ListView) findViewById(R.id.tab_contact_list);
    contactstock = new ArrayList<ContactStock>();

    mCursor = managedQuery(ContactsContract.Data.CONTENT_URI, null,
            Data.MIMETYPE + "='" + Phone.CONTENT_ITEM_TYPE + "'", null,
            ContactsContract.Data.DISPLAY_NAME + " ASC");

    int number = mCursor.getColumnIndex(Phone.NUMBER);
    int name = mCursor.getColumnIndex(ContactsContract.Data.DISPLAY_NAME);
    int id = mCursor.getColumnIndex(Contacts.PHOTO_ID); // NEW LINE

    while (mCursor.moveToNext()) {

        String phName = mCursor.getString(name);
        String phNumber = mCursor.getString(number);
        long phId = mCursor.getLong(id); // NEW LINE

        Bitmap phPhoto = loadContactPhoto(getContentResolver(), phId); // NEW LINE
        Log.d("phId=", phId + "");

        contactstock.add(new ContactStock(phName, phNumber, phPhoto)); // NEW LINE EDIT
    }
    lst.setAdapter(new ContactListAdapter(addlistfromcontact.this,
            contactstock));
}

public static Bitmap loadContactPhoto(ContentResolver cr, long id) { // NEW METHOD
    Uri uri = ContentUris.withAppendedId(
            ContactsContract.Contacts.CONTENT_URI, id);
    InputStream input = ContactsContract.Contacts
            .openContactPhotoInputStream(cr, uri);
    if (input == null) {
        return null;
    }
    return BitmapFactory.decodeStream(input);
}

    } 
```

联系人列表适配器：

```
public class ContactListAdapter extends ArrayAdapter {
    private final Activity activity;
    private final List stocks;

    public ContactListAdapter(Activity activity, List objects) {
        super(activity, R.layout.listview_detail_tab_contact_list, objects);
        this.activity = activity;
        this.stocks = objects;
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {

        View rowView = convertView;
        ContactStockView sv = null;
        if (rowView == null) {
            // Get a new instance of the row layout view
            LayoutInflater inflater = activity.getLayoutInflater();
            rowView = inflater.inflate(
                    R.layout.listview_detail_tab_contact_list, null);

            // Hold the view objects in an object,
            // so they don't need to be re-fetched
            sv = new ContactStockView();
            sv.name = (TextView) rowView.findViewById(R.id.contact_name);
            sv.number = (TextView) rowView.findViewById(R.id.contact_number);
            sv.photo = (ImageView) rowView.findViewById(R.id.contact_photo);

            // Cache the view objects in the tag,
            // so they can be re-accessed later
            rowView.setTag(sv);
        } else {
            sv = (ContactStockView) rowView.getTag();
        }
        // Transfer the stock data from the data object
        // to the view objects
        ContactStock currentStock = (ContactStock) stocks.get(position);
        sv.name.setText(currentStock.getName());
        sv.number.setText(currentStock.getNumber());
        sv.photo.setImageBitmap(currentStock.getPicture()); // NEW LINE

        // TODO Auto-generated method stub
        return rowView;
    }

    protected static class ContactStockView {
        protected TextView name;
        protected TextView number;
        protected ImageView photo; // NEW LINE
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T15:54:54.207

您的代码中有两个问题。第一个很容易克服，其他需要更多的工作。

让我们从简单的开始：该方法`ContactsContract.Contacts.openContactPhotoInputStream(cr, uri)`采用联系人 uri 而不是照片 uri。那就是您呼叫中的 id`ContentUris.withAppendedId(ContactsContract.Contacts.CONTENT_URI, id)`必须是联系人 id。

`Bitmap`此外，您在遍历结果集时会创建很多对象。不要这样做。尽管一开始这可能有效，`OutOfMemory`但当列表过长时，它可能会因错误而崩溃。尽量创建尽可能少的`Bitmap`对象。即：仅适用于那些可见的行。滚动列表视图时，您必须回收现有的位图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T18:29:44.757

由于我在弄清楚如何在不冻结任何 UI 的情况下有效地加载所有联系人的照片时遇到了很多麻烦，当我第一次开始在 Android 上工作时加载图像时出错，我强烈建议任何看到我的问题的人在[**这里**](http://developer.android.com/training/displaying-bitmaps/index.html)好好看看。

这是一个示例应用程序，可教您如何处理所有处理数据并无缝加载图像，在滚动列表时不会出现任何“打嗝”。这也是一个让您开始在 Android 上工作的好项目！

具体来说，对于我的问题代码的联系人图像部分，API 提供了两个简单的方法，可以在[**此处**](http://developer.android.com/reference/android/provider/ContactsContract.Contacts.Photo.html)找到 返回`InputStream`联系人的高分辨率图像或缩略图的方法。您所要做的就是使用`BitmapFactory.decodeByteArray()`. 请记住加载您需要在应用程序中使用的图像大小（在上面的链接中描述），这样您就不会收到 OutOfMemoryError！

为了进一步改进代码，你还可以将 ArrayAdapter 替换为自定义的 Cursor 适配器，并且只在现场加载你需要的 listView 的行。

# c# - 将表达式树作为方法参数传递

> ID：10742581
> 
> 赞同：1
> 
> 时间：2012-05-24T17:38:18.257
> 
> 标签：c#, expression-trees

我有一个功能：

```
public void Execute(Expression<Action> expression)
{
    var time = expression.Compile().Benchmark();

    var msg = string.Format("{0} took {1} to complete",
        ReflectionHelper.GetComponentCallDetails().ToString(),
        time.ToString(@"hh\:mm\:ss\.ff"));

    Logger.Info(msg);
} 
```

需要调用的委托类似于：

```
channels = GetAllChannelsImpl(maxResults); 
```

我对表达式树比较陌生，无法找到将 Action 委托传递给该方法的方法。

我能够使用

```
public void Execute(Action action)
{
    var time = action.Benchmark();

    var msg = string.Format("{0} took {1} to complete",
        ReflectionHelper.GetComponentCallDetails().ToString(),
        time.ToString(@"hh\:mm\:ss\.ff"));

    Logger.Info(msg);
} 
```

并调用

```
Execute(() =>
{
    channels = GetAllChannelsImpl(maxResults);
}); 
```

但我想使用基于表达式树的方法，以消除使用反射的开销来找出调用来记录它的方法的细节的需要。

谁能建议将上述动作委托的表达式树作为方法参数传递的正确方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T03:49:47.610

lambda 表达式本身没有类型。它采用的实际类型由编译器根据您尝试分配或强制转换的内容来推断。话虽如此，使用简单 lambda 对您的方法的任何调用`Execute()`都是模棱两可的，因为您的 lambda 将与`Action`or兼容`Expression<Action>`。您必须通过显式转换为您期望的类型来消除歧义。

```
// assign to a variable
Expression<Action> action1 = () => ...;
Execute(action1);

// cast
Execute((Expression<Action>)(() => ...));

// use the constructor
Execute(new Expression<Action>(() => ...)); 
```

恕我直言，删除模棱两可的重载并重命名其中一种方法会更好。我建议将表达式重命名为`ExecuteExpression()`.

# php - 通过 Graph API 卸载 Facebook 应用

> ID：10742587
> 
> 赞同：0
> 
> 时间：2012-05-24T17:38:35.937
> 
> 标签：php, facebook-graph-api

我正在为客户构建一个工具，他可以在其中自定义自己的 Facebook 标签。安装按钮工作正常，标签被添加到他的 Facebook 页面。但我还计划在我正在使用的工具中包含一种从页面中删除选项卡的方法。

[该文档提到了通过 API https://developers.facebook.com/docs/reference/api/page/#tabs](https://developers.facebook.com/docs/reference/api/page/#tabs)删除选项卡的选项

我试过了，但我只收到“Uncaught OAuthException: (#210) Subject must be a page”错误。这是我使用的代码。

$facebook->api('/'.$page_id.'/tabs/app_'.$app_id.'', ​​'DELETE', array('access_token', $page_token));

我一直在寻找另一种删除它的方法，也找到了这个选项，但这也会返回错误。

[https://graph.facebook.com/pageid/tabs/tabid?method=delete&access_token=token](https://graph.facebook.com/pageid/tabs/tabid?method=delete&access_token=token)返回 -> (#100) 标签未安装或不可移除：而且它肯定已安装！

您可以通过 API 删除已安装的应用程序甚至应该可以工作，还是文档中写了有关无法正常工作的内容的情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T18:25:02.517

我刚刚用我的页面测试了它，`/PAGE_ID/tabs/app_APPID`使用方法`DELETE`和页面的格式`access_token`，它工作正常 - 它返回为“true”并且标签被删除 - 请注意，我第一次尝试时也遇到了 210 错误，因为我不小心将用户 access_token 用作页面的管理员而不是页面访问令牌 - 所以可能要仔细检查一下

# ruby-on-rails - 带导轨的设计模式

> ID：10742591
> 
> 赞同：0
> 
> 时间：2012-05-24T17:39:20.850
> 
> 标签：ruby-on-rails, ruby-on-rails-3, design-patterns

我正在为我的软件工程考试做一个网络应用程序。我决定使用 Rails 框架，我正在努力学习它。

在课程中，我们学习了 GoF 的设计模式，但我没有发现 Rails 有什么有趣的东西。

谁能给我一些可以帮助我的资源？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T17:48:17.567

我读了这个[http://www.amazon.com/Design-Patterns-Ruby-Russ-Olsen/dp/0321490452](https://rads.stackoverflow.com/amzn/click/com/0321490452)发现它很有趣。无论是在设计模式方面，还是在人们通常知道的关于 ruby​​ 的事情背后的方式方面。

# rest - 版本控制 REST API

> ID：10742594
> 
> 赞同：33
> 
> 时间：2012-05-24T17:39:28.693
> 
> 标签：rest

在阅读了大量有关 REST 版本控制的材料后，我正在考虑对调用而不是 API 进行版本控制。例如：

```
http://api.mydomain.com/callfoo/v2.0/param1/param2/param3
http://api.mydomain.com/verifyfoo/v1.0/param1/param2 
```

而不是首先拥有

```
http://api.mydomain.com/v1.0/callfoo/param1/param2
http://api.mydomain.com/v1.0/verifyfoo/param1/param2 
```

然后去

```
http://api.mydomain.com/v2.0/callfoo/param1/param2/param3
http://api.mydomain.com/v2.0/verifyfoo/param1/param2 
```

我看到的优势是：

*   当调用发生变化时，我不必重写我的整个客户端——只需要重写受更改调用影响的部分。
*   客户端的那些部分可以继续工作（我们投入了大量的测试时间来确保客户端和服务器端都是稳定的。）
*   对于已更改的呼叫，我可以使用永久或非永久重定向。
*   向后兼容将是一件轻而易举的事，因为我可以保留旧的呼叫版本。

我错过了什么吗？请指教。

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2012-08-12T16:20:14.813

需要 HTTP 标头。

`Version: 1`

[Version](http://www.w3.org/Protocols/HTTP/Object_Headers.html#z13)标头在[RFC 4229](https://www.rfc-editor.org/rfc/rfc4229#section-2.2.17)中临时注册，并且有一些合理的理由避免使用 X- 前缀或特定于使用的 URI。**yfeldblum**在[https://stackoverflow.com/a/2028664](https://stackoverflow.com/a/2028664)提出了一个更典型的标头：

`X-API-Version: 1`

在任何一种情况下，如果标头丢失或与服务器可以交付的内容不匹配，请发送**412 Precondition Failed**响应代码以及失败的原因。这要求客户端每次都指定它们支持的版本，但会在客户端和服务器之间强制执行一致的响应。（可选地支持`?version=`查询参数会给客户额外的灵活性。）

这种方法简单、易于实施且符合标准。

## 备择方案

我知道一些非常聪明、善意的人建议使用 URL 版本控制和内容协商。在某些情况下和通常提出的形式，两者都存在重大问题。

### URL 版本控制

如果您控制所有服务器和客户端，则端点/服务 URL 版本控制有效。否则，您将需要处理回退到旧服务器的较新客户端，最终您将使用自定义 HTTP 标头进行处理，因为部署在您无法控制的异构服务器上的服务器软件的系统管理员可以做各种各样的事情来搞砸如果您使用**302 Moved Temporarily**之类的东西，您认为很容易解析的 URL 。

### 内容协商

`Accept`如果您非常关心遵循 HTTP 标准但又想忽略 HTTP/1.1 标准文档的实际内容，则通过标头进行内容协商是可行的。您倾向于看到的建议的 MIME 类型是某种形式`application/vnd.example.v1+json`。有几个问题：

1.  当然，在某些情况下，供应商扩展实际上是合适的，但是客户端和服务器之间略有不同的通信行为并不真正符合新“媒体类型”的定义。此外，[RFC 2616 (HTTP/1.1)](https://www.rfc-editor.org/rfc/rfc2616#section-14.1)写道，“*媒体类型值已在 Internet 号码分配机构注册。媒体类型注册过程在 RFC 1590 中进行了概述。不鼓励使用未注册的媒体类型。”* 我不想为每个具有 REST API 的软件产品的每个版本都看到单独的媒体类型。
2.  任何子类型范围（例如，`application/*`）都没有意义。对于将结构化数据返回给客户端进行处理和格式化的 REST API，接受有什么好处`*/*`？
3.  标`Accept`头需要一些努力才能正确解析。应该遵循隐含和明确的优先级，以最大程度地减少实际正确进行内容协商所需的来回。如果您担心正确实施此标准，那么正确执行这一点很重要。
4.  [RFC 2616 (HTTP/1.1)](https://www.rfc-editor.org/rfc/rfc6648)描述了任何不包含`Accept`标头的客户端的行为：*“如果不存在 Accept 标头字段，则假定客户端接受所有媒体类型。”* 因此，对于您不自己编写的客户端（您控制最少的地方），最正确的做法是使用服务器知道的最新、最容易破坏的旧版本来响应请求关于。换句话说，您可能根本没有实现版本控制，而这些客户端仍然会以完全相同的方式中断。

**2014 年编辑**：

我已经阅读了很多其他答案和每个人的深思熟虑的评论；我希望我可以利用几年的反馈改进这一点：

1.  [不要使用“X-”前缀](https://www.rfc-editor.org/rfc/rfc6648)。我认为`Accept-Version`2014 年可能更有意义，并且在评论中提出了关于重用语义的一些有效担忧`Version`。与定义的标头（例如）和 URI 的相对不透明性肯定有重叠`Content-Version`，我尽量小心地将两者与内容协商的变体混淆，`Version`标头实际上是。URL 的第三个“版本”与`https://example.com/api/212315c2-668d-11e4-80c7-20c9d048772b`“第二个”完全不同，无论它是否包含数据或文档。
2.  关于我上面所说的关于 URL 版本控制的内容（例如`https://example.com/v1/users`，端点），反过来可能更符合事实：如果您控制所有服务器和客户端，那么 URL/URI 版本控制可能就是您想要的。对于可以发布单个服务 URL 的大型服务，我会为每个版本使用不同的端点，[就像大多数](http://www.lexicalscope.com/blog/2012/03/12/how-are-rest-apis-versioned/). 我的特别看法深受以下事实的影响：上述实现通常由许多不同的组织部署在许多不同的服务器上，也许最重要的是，部署在我无法控制的服务器上。我总是想要一个规范的服务 URL，如果一个站点仍在运行 API 的 v3 版本，我绝对不希望请求`https://example.com/v4/`返回他们的网络服务器的*404 Not Found*页面（或者更糟糕的是，*200 OK*将他们的主页作为 500k 的 HTML 通过蜂窝数据返回给 iPhone 应用程序。）
3.  如果您想要非常简单的 /client/ 实现（以及更广泛的采用），那么很难说在 HTTP 请求中要求自定义标头对于客户端作者来说就像`GET`-ting vanilla URL 一样简单。（尽管身份验证通常需要您的令牌或凭据在标头中传递，无论如何。使用`Version`或`Accept-Version`作为秘密握手以及*实际*的秘密握手非常适合。）
4.  使用标头进行内容协商`Accept`有利于为相同内容获取不同的 MIME 类型（例如，XML、JSON 和 Adob​​e PDF），但没有为这些东西的版本定义（Dublin Core 1.1 vs. JSONP vs. PDF/A） . 如果您希望支持`Accept`标头，因为尊重行业标准很重要，那么您不希望虚构的 MIME 类型干扰您可能需要在请求中使用的媒体类型协商。保证定制的 API 版本标头不会干扰大量使用、经常引用的`Accept`，而将它们混为相同的用法只会让服务器和客户端感到困惑。也就是说，根据 2013 年的[RFC6906将您期望的内容命名为命名配置文件](https://www.rfc-editor.org/rfc/rfc6906)由于很多原因，它比单独的标题更可取。这很聪明，**我认为人们应该认真考虑这种方法**。
5.  为每个请求添加标头是在无状态协议中工作的一个特殊缺点。
6.  恶意代理服务器几乎可以做任何事情来破坏 HTTP 请求和响应。[他们不应该](http://www.w3.org/TR/2009/WD-ct-guidelines-20091006/#sec-altering-header-values)，虽然我没有在这种情况下谈论[Cache-Control](http://odino.org/rest-better-http-cache/)或[Vary](https://www.mnot.net/blog/2012/07/11/header_versioning)标头，但所有服务创建者都应该仔细考虑他们的内容在许多不同的环境中是如何被使用的。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-11-24T23:25:34.183

这是一个见仁见智的问题；这是我的，以及意见背后的动机。

1.  **在 URL 中包含版本。**
    对于那些说它属于 HTTP 标头的人，我说：*也许。*但是根据该领域的早期领导者，输入 URL 是公认的方法。（谷歌、雅虎、推特等）。这是开发人员所期望的，做开发人员所期望的，换句话说，按照最小惊讶的原则行事，可能是一个好主意。它绝对不会让“客户更难升级”。如果 URL 的更改以某种方式对消费应用程序的开发人员构成了障碍，正如此处不同答案中所建议的那样，则需要解雇该开发人员。

2.  **跳过次要版本**
    有很多整数。你不会用完的。你不需要小数点。您的 API 从 1.0 到 1.1 的任何更改都不应该破坏现有的客户端。所以只使用自然数。如果你喜欢用分离来暗示更大的变化，你可以从 v100 开始，然后做 v200 等等，但即便如此，我认为[YAGNI](http://en.wikipedia.org/wiki/You_ain%27t_gonna_need_it)和它是矫枉过正的。

3.  **将版本放在 URI 中的最左侧**
    假设您的模型中将有多个资源。它们都需要同步进行版本控制。你不能让人们使用资源 X 的 v1 和资源 Y 的 v2。它会破坏一些东西。如果您尝试支持它将在您添加版本时创建维护噩梦，并且无论如何对开发人员都没有任何附加值。所以, `http://api.mydomain.com/v1/Resource/12345`, where`Resource`是资源的类型，`12345`并被资源 id 替换。

你没有问，但是...

1.  **从 URL 路径中省略动词**
    REST 是面向资源的。你的 URL 路径中有诸如“CallFoo”之类的东西，它看起来很像一个动词，而不像一个名词。这是错误的。[*使用原力，卢克。*](http://www.youtube.com/watch?v=o2we_B6hDrY) 使用属于 REST 的动词：GET PUT POST DELETE 等等。如果您想对资源进行验证，请执行`GET http://domain/v1/Foo/12345/verification`. 如果要更新它，请执行`POST /v1/Foo/12345`.

2.  **将可选参数作为查询参数或有效负载**
    可选参数不应位于 URL 路径中（在第一个问号之前），除非您建议这些可选参数构成独立资源。所以，`POST /v1/Foo/12345?action=partialUpdate&param1=123&param2=abc`。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-24T22:04:06.727

Don't do either of those things, because they push the version into the URI structure, and that's going to have downsides for your client applications. It will make it harder for them to upgrade to take advantage of new features in your application.

Instead, you should version your media types, not your URIs. This will give you maximum flexibility and evolutionary ability. For more information, see [this answer](https://stackoverflow.com/questions/8993467/rest-vs-soap-evolvability/8995061#8995061) I gave to another question.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-03-23T09:12:05.650

我喜欢使用配置文件媒体类型参数：

```
application/json; profile="http://www.myapp.com/schema/entity/v1" 
```

更多信息：

[https://www.rfc-editor.org/rfc/rfc6906](https://www.rfc-editor.org/rfc/rfc6906)

[http://buzzword.org.uk/2009/draft-inkster-profile-parameter-00.html](http://buzzword.org.uk/2009/draft-inkster-profile-parameter-00.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-11-06T22:21:19.913

It depends on what you call versions in your API, if you call versions to different representations (xml, json, etc) of the entities then you should use the accept headers or a custom header. That is the way http is designed for working with representations. It is RESTful because if I call the same resource at the same time but requesting different representations, the returned entities will have exactly the same information and property structure but with different format, this kind of versioning is cosmetic.

In the other hand if you understand 'versions' as changes in entity structure, for example adding a field 'age' to the 'user' entity. Then you should approach this from a resource perspective which is in my opinion the RESTful approach. As described by Roy Fielding in his disseration ...a REST resource is a mapping from an identifier to a set of entities... Therefore makes sense that when changing the structure of an entity you need to have a proper resource that points to that version. This kind of versioning is structural.

I made a similar comment in: [http://codebetter.com/howarddierking/2012/11/09/versioning-restful-services/](http://codebetter.com/howarddierking/2012/11/09/versioning-restful-services/)

When working with url versioning the version should come later and not earlier in the url:

```
GET/DELETE/PUT onlinemall.com/grocery-store/customer/v1/{id}
POST onlinemall.com/grocery-store/customer/v1 
```

Another way of doing that in a cleaner way but which could be problematic when implementing:

```
GET/DELETE/PUT onlinemall.com/grocery-store/customer.v1/{id}
POST onlinemall.com/grocery-store/customer.v1 
```

Doing it this way allows the client to request specifically the resource they want which maps to the entity they need. Without having to mess with headers and custom media types which is really problematic when implementing in a production environment.

Also having the url late in the url allows the clients to have more granularity when choosing specifically the resources they want, even at method level.

But the most important thing from a developer perspective, you don't need to maintain the whole mappings (paths) for every version to all the resources and methods. Which is very valuable when you have lot of sub-resources (embedded resources).

From an implementation perspective having it at the level of resource is really easy to implement, for example if using Jersey/JAX-RS:

```
@Path("/customer")
public class CustomerResource {
    ...
    @GET
    @Path("/v{version}/{id}")
    public IDto getCustomer(@PathParam("version") String version, @PathParam("id") String id) {
         return locateVersion(version, customerService.findCustomer(id));
    }
    ...
    @POST
    @Path("/v1")
    @Consumes(MediaType.APPLICATION_JSON)
    public IDto insertCustomerV1(CustomerV1Dto customer) {
         return customerService.createCustomer(customer);
    }

    @POST
    @Path("/v2")
    @Consumes(MediaType.APPLICATION_JSON)
    public IDto insertCustomerV2(CustomerV2Dto customer) {
         return customerService.createCustomer(customer);
    }
...
} 
```

IDto is just an interface for returning a polymorphic object, CustomerV1 and CustomerV2 implement that interface.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-08-20T17:44:07.017

Facebook[在 url](https://www.google.com/url?q=https%3A%2F%2Fblog.apigee.com%2Fdetail%2Frestful_api_design_tips_for_versioning&sa=D&sntz=1&usg=AFQjCNEdjV_8IoRvgzK-qLTUWWc0nN3neA)中进行验证。我觉得 url 版本控制在现实世界中也更干净、更容易维护。

.Net 使以这种方式进行版本控制变得非常容易：

```
[HttpPost]
[Route("{version}/someCall/{id}")]
public HttpResponseMessage someCall(string version, int id)) 
```

# iphone - 网站在 iphone 上呈现不正确

> ID：10742601
> 
> 赞同：-2
> 
> 时间：2012-05-24T17:40:14.697
> 
> 标签：iphone, css, ios, wordpress

我网站的右边距在 iphone 上被切断了.. 有什么想法吗？谢谢！

[http://speedsociety.com/](http://speedsociety.com/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T17:51:53.270

为 iPhone 创建一个自定义样式表并将其附加如下：

```
<?php
  $browser = strpos($_SERVER['HTTP_USER_AGENT'],"iPhone");
    if ($browser == true){
    $browser = 'iphone';
  }
?>

<?php if($browser == 'iphone'){ ?> <!-- Attach style-sheet here -- <?php } ?> 
```

# java - 有纯 Java NSSearchField 替代品吗？

> ID：10742603
> 
> 赞同：0
> 
> 时间：2012-05-24T17:40:21.313
> 
> 标签：java, swing, search, user-interface

正如标题所说，有没有人（最好是一个完善的图书馆）得到了这个小伙子在 2004 年试图完成的更好的版本？

[http://elliotth.blogspot.co.uk/2004/09/cocoa-like-search-field-for-java.html](http://elliotth.blogspot.co.uk/2004/09/cocoa-like-search-field-for-java.html)

在 stackoverflow 上有很多关于获得圆角边框、设置图标等的问题。但在获得实际外观、感觉和行为类似于适当搜索栏的东西方面，它们似乎都没有真正击中头部。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T22:33:13.553

SwingX 中的 JXSearchField 可能就是您正在寻找的。

# c# - 使用 DomainCollectionView 进行分组和分页

> ID：10742605
> 
> 赞同：0
> 
> 时间：2012-05-24T17:40:24.703
> 
> 标签：c#, wcf-ria-services, silverlight-5.0

我试图让分组和分页（在数据网格中）在 RIA 服务中同时工作。我已经有了一个非常精细的 UserControl，它基于出色的 DomainCollectionView。但是，我在分组工作时遇到了麻烦。

我将此行添加到示例中：

```
this.CollectionView.GroupDescriptions.Add(new PropertyGroupDescription("Int32")); 
```

> 关于示例的注意事项：我更改了将 Int32 分配为键 % 2 的方式，因此应该有两个结果组，每个组应该有数百个项目。分页设置为 10 项。在查询级别不应用分组。

所以在这种情况下，我希望分组标题显示项目总数，但是，它只是“组 0”，因为项目计数为 10，这显然是不正确的。它仅在第一页显示项目计数。

**问题** 是否有任何使分组和分页一起使用或不使用 DomainCollectionView？

有关正确的上下文，请参阅有关[DomainCollectionView](http://blogs.msdn.com/b/kylemc/archive/2011/04/15/domaincollectionview-updates-for-mix-11.aspx)的文章和为其发布[的示例](http://code.msdn.microsoft.com/Server-Side-Filtering-737becda)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T16:28:20.960

Microsoft 的 Kyle McClellan 回复了一封有关此问题的个人电子邮件，并在下面提供了详细说明。

总之，分组和分页不能很好地协同工作——您肯定不会在 DataGrid 中获得功能齐全的分组体验。

对我来说，解决方案是在存在分组时删除分页。

> **2012 年 6 月 6 日，星期三，晚上 7:51，Kyle McClellan 写道：**啊，现在我明白你的期望了。这里有两个（竞争？）事情在起作用。首先，客户端技术对服务器一无所知。它只看到本地存在的数据。因此，控件等会报告只有一个组，并且它只包含一个页面的数据。其次，服务器技术可以看到所有数据但只被要求返回一个页面。它对数据进行适当的排序和切片，然后将其返回。它可以确定组的数量和每个组的大小，但无法将其传达回客户端。
> 您所看到的是按设计运行的视图。它会先显示第 0 组中的所有项目，然后再显示第 1 组中的所有项目。在中间的某个位置，您会在页面上看到两个组，否则结果将全部位于同一组中。

# html - 导航链接在 Chrome 和 Firefox 中不起作用

> ID：10742606
> 
> 赞同：0
> 
> 时间：2012-05-24T17:40:27.943
> 
> 标签：html, css, firefox, google-chrome, internet-explorer-9

我在一个网站上工作，该网站是[http://fredsrewards.loyaltylane.com/fredsshopper](http://fredsrewards.loyaltylane.com/fredsshopper)。页面顶部有一个导航菜单。这些链接在 Chrome 或 Firefox 中无效，但在 IE9 中有效。该站点使用了一些 javascript 文件。我曾尝试更改 CSS 和 HTML 中的内容，但没有任何效果。该站点是使用 MVC 3 构建的。任何建议将不胜感激。先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T18:12:30.750

It's because you have another div (phar_panel) on top of the navigation.

You can fix it by setting:

```
#m_box {
    /* rules you already have */
    position: relative;
}

#phar_panel {
    /* rules you already have */
    width: 230px;
    height:31px;
    right:30px;
    position: absolute;
}
#phar_panel img {
    /* rules you already have */
    left: 230px;
    position: absolute;
} 
```

Also, be careful, you have more than one element with the same id (navigation) in your page!

# ruby-on-rails - has_many :through - 使用 NULL id 的 sql 语句

> ID：10742608
> 
> 赞同：0
> 
> 时间：2012-05-24T17:40:31.813
> 
> 标签：ruby-on-rails, activerecord, ruby-on-rails-3.1

我们最近将我们的 rails 应用程序从版本 3.0.3 升级到了 3.1.0。该应用程序在大多数情况下都像以前一样成功运行，但有一个主要例外。我们在两个模型之间存在多对多关系，SurveyDatum 和 SubGroup，通过一个名为 SubGroupSurveyDatum 的模型连接。这是每个的代码：

```
class SurveyDatum < ActiveRecord::Base
  has_many :sub_group_survey_data
  has_many :sub_groups, :through => :sub_group_survey_data
end

class SubGroup < ActiveRecord::Base
  has_many :sub_group_survey_data
  has_many :survey_data, :through => :sub_group_survey_data
end 
```

正如您所料：

```
class SubGroupSurveyDatum < ActiveRecord::Base
  belongs_to :survey_datum
  belongs_to :sub_group
end 
```

如果我有一个之前从数据库中检索到的 SurveyDatum 对象（我们称之为“sd”），并且我调用 sub_groups 方法（sd.sub_groups），这是由活动记录生成的结果 sql 查询：

```
SELECT `sub_groups`.* FROM `sub_groups` INNER JOIN `sub_group_survey_data` ON `sub_groups`.`id` = `sub_group_survey_data`.`sub_group_id` WHERE `sub_group_survey_data`.`survey_datum_id` IS NULL 
```

“IS NULL”部分显然是我的调查数据对象的 id 应该去的地方，但是活动记录无法使用它。该对象确实有一个 id，因为如前所述，它是从数据库中持久化和检索的。这个问题是在我们迁移到 rails 3.1 之后才出现的，所以我认为我没有按照新版本正确完成某些事情，但我不知道。有任何想法吗？预先感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T18:39:09.660

嗯，我使用 rails 3.1.0 并尝试复制，但一切都很好。唯一的情况是我手动设置`id = nil`从数据库检索到的记录。然后我得到：

```
SELECT "authors".* FROM "authors" INNER JOIN "relations" ON "authors"."id" = "relations"."author_id" WHERE "relations"."post_id" IS NULL 
```

你用的是什么数据库？我正在用 sqlite3 尝试这个。还要注意某些宝石，尤其是那些与 ActiveRecord 一起使用的宝石。我过去在这方面遇到过麻烦。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T13:44:08.280

我们发现了这个问题。我忘记了survey_data 表有一个复合主键。当我们升级到版本 3.2.3 并在 SurveyDatum 模型中添加以下内容时：

```
set_primary_key :id 
```

查询最终正确构建并执行。

# r - R 使用 't' 和 ddply

> ID：10742610
> 
> 赞同：1
> 
> 时间：2012-05-24T17:40:38.113
> 
> 标签：r, plyr

我需要像这样转换一些数据：

```
df<-data.frame(Plate=c("4660", "4660", "4660", "4660", "4660", "4660", "4660", "4660", "4660", "4660", "4660"), Well=c("A1", "A2", "A3", "A4", "B1", "B2", "B3", "C1", "C2", "C3", "C4"), Result=c(1, 10, 100, 1000, 1, 10, 100, 1, 10, 100, 1000), Compound=c("C1", "C1", "C1", "C1", "C2", "C2", "C2", "C3", "C3", "C3", "C3"))
cmpds <- ddply(df, .(Compound), .fun = "t") 
```

我想要结束的是：

```
 1     2     3     4
A  1     10    100   1000
B  1     10    100   NA
C  1     10    100   1000 
```

有没有办法用或忽略它来填充缺失的`B4`行？`NA`该`t`功能或`ddply`似乎因`B`长度与其他长度不同而令人窒息。

谢谢，J--

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T18:10:25.833

像@Justin 一样，我假设您的列名来自井规范的数字部分。如果是这样，这里有一个稍微更通用的解决方案（适用于非单个数字和非单个字母，嗯，字母。

```
library("gsubfn")
library("reshape2")

wells <- strapply(as.character(df$Well), ".*([A-Z]+)([0-9]+)", c, simplify=rbind)
colnames(wells) <- c("well.letter", "well.number")
df <- cbind(df, wells) 
```

然后使用`dcast`：

```
> dcast(df, Compound~well.number, value.var="Result")
  Compound 1  2   3    4
1       C1 1 10 100 1000
2       C2 1 10 100   NA
3       C3 1 10 100 1000 
```

如果水平标签没有意​​义，而你只想填写你有多少个值，你可以这样做`plyr`：

```
ddply(df, .(Compound), function(DF) {
  as.data.frame(t(DF$Result))
}) 
```

这使

```
 Compound V1 V2  V3   V4
1       C1  1 10 100 1000
2       C2  1 10 100   NA
3       C3  1 10 100 1000 
```

您想要的并不是很清楚，因为您的示例中的行标有井字母，而代码暗示按复合名称拆分。不确定你真正想要的是哪个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T17:50:22.577

您希望您的行和列是 Well 列中的字母和数字吗？您可以将它们拆分为两个新列：

```
well.split <- strsplit(df$Well, '')

df$well.letter <- sapply(well.split, '[', 1)
df$well.number <- sapply(well.split, '[', 2) 
```

然后我会`dcast`从`reshape2`包中使用：

```
dcast(df, well.letter~well.number, value.var='Result') 
```

# macos - 我们是否需要为 Mountain Lion 签署 NPAPI 插件

> ID：10742613
> 
> 赞同：0
> 
> 时间：2012-05-24T17:40:49.037
> 
> 标签：macos, npapi, osx-mountain-lion

我有一个基于 NPAPI 的插件。我必须签署它才能使其在 Mountain Lion 上运行吗？我知道文档说如果应用程序不是 App Store 的一部分，我们需要对其进行签名。该要求是否适用于插件？

我问这个是因为，在 Mountain Lion 中测试我的插件时我没有看到任何问题。有人对此有任何想法吗？

问候，

维什韦什

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T23:06:17.453

Gatekeeper 上的公开信息意味着它只影响应用程序，而不影响插件之类的东西。但是，除了这个含义之外，没有明确的答案。

如果您是 NDA 下的 Mac 开发人员计划成员，这已在论坛上讨论过，您可以在那里找到答案 (https://devforums.apple.com/community/mac/pre)，但不允许任何人将该信息复制到其他任何地方。

# mysql - 获取在一行sql中具有最大值的列名

> ID：10742616
> 
> 赞同：4
> 
> 时间：2012-05-24T17:41:03.077
> 
> 标签：mysql, sql, max

我的数据库中有一个表，我在其中存储新闻文章的类别，每次用户阅读一篇文章时，它都会增加相关列中的值。像这样：

![在此处输入图像描述](../Images/568eb1713f04457ac85bb81fa7b4b2b1.png)

现在我想执行一个查询，我可以在其中获取每条记录的 4 个最高值的列名。例如，对于用户 9，它将返回：

![在此处输入图像描述](../Images/3418bb8dba65dac198565e8d06100fa0.png)

我尝试了几件事，搜索了很多，但不知道该怎么做。谁能帮我？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T18:34:12.530

这应该这样做：

```
select
  userid,
  max(case when rank=1 then name end) as `highest value`,
  max(case when rank=2 then name end) as `2nd highest value`,
  max(case when rank=3 then name end) as `3rd highest value`,
  max(case when rank=4 then name end) as `4th highest value`
from
(
  select userID, @rownum := @rownum + 1 AS rank, name, amt from (
    select userID, Buitenland as amt, 'Buitenland' as name from newsarticles where userID = 9 union
    select userID, Economie, 'Economie' from newsarticles where userID = 9 union
    select userID, Sport, 'Sport' from newsarticles where userID = 9 union
    select userID, Cultuur, 'Cultuur' from newsarticles where userID = 9 union
    select userID, Wetenschap, 'Wetenschap' from newsarticles where userID = 9 union
    select userID, Media, 'Media' from newsarticles where userID = 9
  ) amounts, (SELECT @rownum := 0) r
  order by amt desc
  limit 4
) top4
group by userid 
```

演示：[http ://www.sqlfiddle.com/#!2/ff624/11](http://www.sqlfiddle.com/#!2/ff624/11)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T04:03:52.287

一个非常简单的方法如下所示

```
select userId, substring_index(four_highest,',',1) as 'highest value', substring_index(substring_index(four_highest,',',2),',',-1) as '2th highest value',  substring_index(substring_index(four_highest,',',3),',',-1) as '3 rd highest value',  substring_index(four_highest,',',-1) as '4th highest value'   from
(
select userid, convert(group_concat(val) using utf8) as four_highest from
(
select userId,Buitenland as val,'Buitenland' as col from test where userid=9 union
select userId,Economie as val,' Economie' as col from test where   userid=9 union
select userId,Sport as val ,'Sport' as col from test where  userid=9 union
select userId,Cultuur as val,'Cultuur' as col from test where userid=9 union
select userId,Wetenschap as val,'Wetenschap' as col from test where userid=9 union
select userId,Media as val,'Media' as col from test where  userid=9 order by val desc limit 4
) inner_query
)outer_query; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T18:43:25.897

PL/SQL，也许吧？设置 user_id，查询您的表，将返回的行存储在 nx2 列名和值数组中（其中 n 是列数）并根据值对数组进行排序。

当然，正确的做法是以@octern 建议的方式重新设计您的数据库。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-24T19:52:13.447

这将使您开始了解从单行上的多个列中获取最高值的概念（针对您的特定表进行修改 - 我创建了一个假表）。

```
create table fake 
(
  id int Primary Key,
  col1 int,
  col2 int,
  col3 int,
  col4 int 
)
insert into fake values (1, 5, 9, 27, 10)
insert into fake values (2, 3, 5, 1, 20)
insert into fake values (3, 89, 9, 27, 6)
insert into fake values (4, 17, 40, 1, 20)

SELECT *,(SELECT Max(v) 
FROM (VALUES (col1), (col2), (col3), (col4) ) AS value(v))
FROM fake 
```

# java - 如何使用 Play Framework 和 videojs 流式传输视频？

> ID：10742617
> 
> 赞同：2
> 
> 时间：2012-05-24T17:41:10.833
> 
> 标签：java, playframework, video-streaming, playframework-1.x

关于[使用 videojs 在播放框架中流式传输视频](https://stackoverflow.com/questions/10264416/streaming-video-in-play-framework-using-videojs)我想知道使用播放控制器流式传输视频的最佳方式。

我将视频存储在文件系统上，由于并非每个用户都可以观看每个视频，因此我想使用控制器限制访问。所以我的问题是，如何将视频从控制器内流式传输到客户端（运行 videojs）？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T17:47:42.700

您的视频是静态内容，例如图像或 .css 文件。您可以使用任何网络服务器来提供此内容。

如果你想控制访问，有很多技术。您可以创建一个控制器来验证请求，打开视频并在响应中写入字节。我从来没有尝试过，对我来说更有趣的是生成一个安全令牌并通过使用一些安全插件的 apache 或 nginx 提供文件。

但如果你想的东西不同于渐进式下载（如 http 实时流媒体或 rtmp、rtsp 等），你需要一个视频服务器，如 wowza、flash 媒体服务器或 red5。您可以使用相同的令牌策略

# jquery - 将新内容加载到 div 标签中时，如何禁用奇怪的 JQuery 捕捉效果？

> ID：10742619
> 
> 赞同：0
> 
> 时间：2012-05-24T17:41:12.770
> 
> 标签：jquery

我怎样才能让“好选择”的代码行不被抢购，而是出现在与上一个关于欧洲的问题相同的位置？反正有告诉它不要拍吗？

我真的只想要一个响应在单击时淡入或淡出但在同一位置。谢谢！下面的所有代码都在**Tumblr**（HTML、CSS 和 JQuery）上运行。

[patriciahighsmith.tumblr.com/quiz](http://patriciahighsmith.tumblr.com/quiz)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T17:44:39.473

您可以同时尝试淡出和 SlideUp，而不只是淡出，这样内容不仅会消失，还会向上滑动。或者，您只能在第一个部分淡出并且已经隐藏时才显示下一部分。

做你想做的事，你需要：

```
var me = $(this);
$('.msg_body').fadeOut("slow", function()
{
    $(me.attr("href")).fadeIn("slow");
}); 
```

# javascript - 调整窗口大小时限制居中 div 的水平范围

> ID：10742622
> 
> 赞同：0
> 
> 时间：2012-05-24T17:41:21.893
> 
> 标签：javascript, jquery, css

我有两个div。一个应位于距窗口左边框 5% 处，另一个应位于前面提到的 div 的右侧并相对于窗口宽度居中。如果窗口太窄，它不应该与第一个 div 重叠，也不应该移动到下面。

后面的任何内容都应位于前两个 div 中最高的下方。

我怎样才能做到这一点？

我最接近的是对第一个 div 使用浮点数。[http://jsfiddle.net/7qVLm/](http://jsfiddle.net/7qVLm/)

编辑：这是我满意的最终结果：http: [//jsfiddle.net/ATHpg/](http://jsfiddle.net/ATHpg/)

感谢@Christopher Smithson 和@gmebeh，他们的回答帮助我找到了这个解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T18:30:32.343

这是您的解决方案要考虑的小提琴。

[http://jsfiddle.net/f2Muj/5/](http://jsfiddle.net/f2Muj/5/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T18:48:31.817

使用基于百分比的`width`'s 你可以做到这一点：

[jsFiddle](http://jsfiddle.net/f2Muj/7/)

*   `#d1`距离左侧 5%，居中对齐的内容
*   `#d2`相对于浏览器窗口居中，并且永远不会重叠`#d1`
*   两者都使用固定高度来容纳固定数量的内容

玩弄百分比以获得您想要的确切宽度。

# django - 将表单输入数据强制为大写

> ID：10742631
> 
> 赞同：0
> 
> 时间：2012-05-24T17:42:25.577
> 
> 标签：django, django-models, django-forms

尝试将表单输入数据强制为大写时，出现属性错误“'NoneType' 对象没有属性 'strip'”。我的表单代码（从另一个程序员借来的干净方法）是：

```
class PostPageForm(ModelForm):
    class Meta: 
        model = PostPage
    def clean(self):
        return dict([(k, v.strip().upper()) for k, v in self.cleaned_data.items()]) 
```

和我的模型：

```
class PostPage(models.Model):
    client = models.CharField(max_length=50, choices=CLIENT_CHOICES)
    job_number = models.CharField(max_length=30, unique=True, blank=False, null=False)
    job_name = models.CharField(max_length=64, unique=False, blank=False, null=False)
    page_type = models.CharField(max_length=50, default='POST')
    create_date = models.DateField(("Date"), default=datetime.date.today)
    contact = models.ForeignKey(UserProfile)
    contact2 = models.ForeignKey(UserProfile, related_name='+', blank=True, null=True)
    contact3 = models.ForeignKey(UserProfile, related_name='+', blank=True, null=True)
    contact4 = models.ForeignKey(UserProfile, related_name='+', blank=True, null=True)

    def __unicode__ (self):
        return u'%s %s %s' % (self.client, self.job_number, self.job_name)

    class Admin: 
         pass

    class Meta:
        permissions = (
            ('view_postpage', 'View postpage'),
        ) 
```

我认为表单代码中“clean”方法的覆盖需要根据模型的返回值重新配置。我只是不确定如何。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T17:54:24.333

这不是一个好方法，这样做：它尝试调用`.upper`中的每个对象`cleaned_data`，它可以是`int`，`None`以及任何其他类型。

解决方案类似于：

```
return dict((k, v.strip().upper()) for k, v in self.cleaned_data.iteritems() if isinstance(v, basestring)) 
```

但是你为什么需要这个？可能最好按原样存储字符串并将它们*显示*为大写？

# java - 从 Java 中的外部进程读取时出现乱码

> ID：10742632
> 
> 赞同：3
> 
> 时间：2012-05-24T17:42:26.997
> 
> 标签：java, ls, processbuilder

我正在使用 Java 中的 ProcessBuilder 类启动与 Cygwin 捆绑的 SSH 实用程序。一切正常。我通过 SSH 连接到 linux 服务器，可以运行命令并读取输出。

但是，无论何时返回输出，它仅在登录服务器并运行命令（例如目录列表）后才会发生`ls`，返回如下内容：

```
InputStream: root@myserver:/scripts/common# ls 
InputStream: [00m[00mA1-4.yaml[00m                            [01;32mscip-1.2.0.linux.x86_64.gnu.opt.qso[00m
InputStream: [00madditional_files.txt[00m                 [01;32mscip-1.2.0.linux.x86_64.gnu.opt.spx[00m 
```

据我所知，它只发生在文件列表命令中。例如，当我运行其他命令（如时间等）时，它会显示正常输出。

您能建议将这些随机字符附加到文件名的原因是什么吗？

我什至尝试使用 UTF8 编码，但没有任何改变。当我使用命令行直接登录时，我看不到这些结果。但是，cmdline 以彩色值显示文件名。是否添加了一些不是 ASCII 的附加信息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T10:48:13.513

使用命令`ls --color=none` 可以解决这个问题。

发生这种情况是因为默认情况下 ls 命令返回附加了不同颜色代码值的文件名。[此链接提供了更多信息](http://linux-sxs.org/housekeeping/lscolors.html)。

`ls`下图描述了和之间的区别`ls --color=none`：

![在此处输入图像描述](../Images/a00a7efef96b925a50179c0e71f2026e.png)

# java - 创建 < 100 个线程时的 Java `OutOfMemoryError`

> ID：10742634
> 
> 赞同：12
> 
> 时间：2012-05-24T17:42:30.580
> 
> 标签：java, jvm, threadpool, out-of-memory, openjdk

由于这个错误，我已经阅读和测试并将我的头撞到墙上超过一天。

我在一个名为的类中有一些 Java 代码`Listener`，看起来像这样

```
ExecutorService executor = Executors.newFixedThreadPool(NTHREADS);
boolean listening = true;
int count = 0;
while (listening) {
    Runnable worker;
    try {
        worker = new ServerThread(serverSocket.accept()); // this is line 254
        executor.execute(worker);
        count++;
        logger.info("{} threads started", count);
    } catch (Exception e1){
        //...
    }
} 
```

我一直在调整 JVM 设置`-Xmx`（从 1 到 15G）和`-Xss`（从 104k 到 512M）。服务器有 24 GB 的 RAM，但还必须运行支持该程序的数据库。

创建 2-20 个线程后（程序中其他地方也存在几十个线程），我收到错误

```
Exception in thread "Thread-0" java.lang.OutOfMemoryError: unable to create new native thread
at java.lang.Thread.start0(Native Method)
at java.lang.Thread.start(Thread.java:657)
at java.util.concurrent.ThreadPoolExecutor.addWorker(ThreadPoolExecutor.java:943)
at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1325)
at xxx.Listener.run(Listener.java:254) 
```

`$java -version`产量：

```
java version "1.6.0_24"
OpenJDK Runtime Environment (IcedTea6 1.11.1) (fedora-65.1.11.1.fc16-x86_64)
OpenJDK 64-Bit Server VM (build 20.0-b12, mixed mode) 
```

发生这种情况时，系统上总是有大量可用内存，其他程序继续正常执行。是什么导致 Java 认为它没有更多内存可用于新线程？

**更新：** 也许这比我想象的要大 - 我在使用时设法得到这个错误（只有一次）`^C`：

```
OpenJDK 64-Bit Server VM warning: Exception java.lang.OutOfMemoryError occurred dispatching signal SIGINT to handler- the VM may need to be forcibly terminated 
```

当我试图杀死客户端时也发生了同样的情况（也是用Java编写并在同一台服务器上运行，它是一个读取文件并通过套接字将其发送到服务器的单线程），所以肯定有一个超出的限制JVM 导致一个干扰另一个，但我无法想象如果我仍然有空闲内存并且根本不使用交换会怎样？服务器 -Xmx1G -Xss104k 客户端 -Xmx10M

**UPDATE2：** 放弃 perl`Forks::Super`库并从 bash 运行客户端让我在服务器因 OOME 崩溃之前获得多达 34 个线程，因此运行多个客户端肯定会对服务器产生影响，但同时我应该仍然能够运行一次超过 34 个（如果算上客户端，则为 68 个）java 线程。哪些系统资源阻止了更多线程的创建（即我应该在哪里寻找猪）？当一切（客户端、服务器、GC ...）同时耗尽内存时，`top`说明我的 CPU 和内存使用情况：

```
Cpu(s):  0.0%us,  0.0%sy,  0.0%ni,100.0%id,  0.0%wa,  0.0%hi,  0.0%si,  0.0%st
Mem:  24681040k total,  1029420k used, 23651620k free,    30648k buffers
Swap: 26836988k total,        0k used, 26836988k free,   453620k cached 
```

**UPDATE3：**下面的 hs_error 日志是否表明我的 java 不是 64 位的？

```
# There is insufficient memory for the Java Runtime Environment to continue.
# Cannot create GC thread. Out of system resources.
# Possible reasons:
#   The system is out of physical RAM or swap space
#   In 32 bit mode, the process size limit was hit
# Possible solutions:
#   Reduce memory load on the system
#   Increase physical memory or swap space
#   Check if swap backing store is full
#   Use 64 bit Java on a 64 bit OS
#   Decrease Java heap size (-Xmx/-Xms)
#   Decrease number of Java threads
#   Decrease Java thread stack sizes (-Xss)
#   Set larger code cache with -XX:ReservedCodeCacheSize=
# This output file may be truncated or incomplete.
#
# JRE version: 6.0_24-b24
# Java VM: OpenJDK 64-Bit Server VM (20.0-b12 mixed mode linux-amd64 compressed oops)
# Derivative: IcedTea6 1.11.1
# Distribution: Fedora release 16 (Verne), package fedora-65.1.11.1.fc16-x86_64 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-27T21:01:37.877

您可以通过限制`max user processes`，了解您的限制使用：

```
ulimit -u 
```

要更改限制：

在`/etc/security/limits.conf`集合中：

```
user soft nproc [your_val] 
user hard nproc [your_val] 
```

如果还不够，您可能需要添加一些其他配置，请参阅此[链接](http://directory.fedoraproject.org/wiki/Performance_Tuning)。

注意： OP 在 fedora 和 centos 中发现了这个[错误报告](https://bugzilla.redhat.com/show_bug.cgi?id=823030)，它解释了编辑的限制`/etc/security/limits.conf`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-24T18:02:13.663

您的问题可能与 JVM 无法为新线程分配堆栈内存有关。具有讽刺意味的是，这个问题可以通过减少堆空间（-Xmx）和堆栈空间（-Xss）来解决。例如，在这里查看一个很好的解释： http: [//www.blogsoncloud.com/jsp/techSols/java-lang-OutOfMemoryError-unable-to-create-new-native-thread.jsp](http://www.blogsoncloud.com/jsp/techSols/java-lang-OutOfMemoryError-unable-to-create-new-native-thread.jsp)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-24T18:02:46.040

它不是缺少新线程的内存，而是缺少实际线程。系统可能会阻止您：用户可以创建的线程数量是有限的。你可以这样查询：

```
cat /proc/sys/kernel/threads-max 
```

请注意，您可能会受到同一台机器上的其他进程的影响，它们也创建了许多线程。您可能会发现这个问题很有用： [Linux 中每个进程的最大线程数？](https://stackoverflow.com/questions/344203/maximum-number-of-threads-per-process-in-linux)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-25T19:53:54.780

只是为了澄清：

您`ServerSocket`向`Thread`. 您是否将数据发送到该套接字？也许您在 Thread-Context 中存储了大量数据。查看一个模式，您将 Streamdata 存储在`byte[]`.

# sql-server - 获取 SQL Server 中的列类型

> ID：10742638
> 
> 赞同：4
> 
> 时间：2012-05-24T17:42:42.483
> 
> 标签：sql-server, types

例如我想做这样的事情：

```
//if the Column type is nvarchar
//do something

//if the Column type is int
//do something 
```

**编辑：**

例如 ：

我有一个包含列的表（col1 是 int，col2 是 nvarchar），并且我在这个表中有数据，例如

```
col1 : 1,2,3,4,NULL and col2 : a,b,d,f,E,NULL 
```

现在我想用 0 填充 col1 的 NULL 数据，用 " " 填充 col2 的 NULL 数据

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-05-24T17:50:16.250

如果您知道表和列名，那么：

```
DECLARE @tn sysname;

SELECT @tn = TYPE_NAME(system_type_id) 
FROM sys.columns 
WHERE name = @column_name 
AND [object_id] = OBJECT_ID(N'dbo.tablename');

IF @tn = N'nvarchar'
     DECLARE @x nvarchar(32);

IF @tn = N'int'
     DECLARE @i int; 
```

但是请注意，您将无法以这种方式声明具有不同数据类型的*相同*变量名，即使 SQL Server 只能访问其中一个。你会得到类似的东西：

> 消息 134，级别 15，状态 1
> 变量名称“@i”已被声明。变量名称在查询批处理或存储过程中必须是唯一的。

如果您知道表的名称，那么您可以构建一个动态 SQL 语句，如下所示（请注意，这仅涵盖类型的子集 - 但应该给您这个想法）：

```
DECLARE @table nvarchar(512) = N'dbo.whatever';

DECLARE @sql nvarchar(max) = N'SELECT ';

SELECT @sql = @sql 
    + STUFF((SELECT N',' + QUOTENAME(c.name) + N' = COALESCE(' 
    + QUOTENAME(c.name) + N',' + CASE
      WHEN t.name LIKE N'%int' THEN N'0'
      WHEN t.name LIKE N'%char' THEN N''' '''
      END + N')'
 FROM sys.types AS t
INNER JOIN sys.columns AS c 
ON t.system_type_id = c.system_type_id
AND t.user_type_id = c.user_type_id
WHERE c.[object_id] = OBJECT_ID(@table)
ORDER BY c.column_id
FOR XML PATH(''), 
TYPE).value(N'./text()[1]', N'nvarchar(max)'), 1, 1, N'');

SET @sql = @sql + N' FROM ' + @table;
--SET @sql = @sql + N' WHERE...'

EXEC sys.sp_executesql @sql; 
```

我不知道如果没有动态 SQL，你怎么会梦想这样做。而且，为了防止您的表示层不得不处理 NULL，这需要做很多工作。那可能是处理这个问题的更好地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T21:07:58.383

这是你要找的吗？

```
declare @columns as table
(col1 int,col2 nvarchar)

insert @columns
values (1,'a'),(2,'b'),(3,'d'),(4,'f'),(null,null)

select isnull(col1,0), isnull(col2,'') from @columns 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-12T11:06:23.097

```
SELECT  typ.name, c_name,CASE when system_type_id <> 243  then typ.max_length 
                              when system_type_id = 243 then   c_maxlen
                         END AS [Maxlen1] ,
                         CASE when system_type_id <> 243  then typ.precision 
                              when system_type_id = 243 then   c_precision
                         END AS [precision] ,

                         CASE when system_type_id <> 243  then typ.scale 
                              when system_type_id = 243 then   c_scale
                         END AS [scale] ,

                         CASE when system_type_id <> 243  then typ.is_nullable 
                              when system_type_id = 243 then   c_nullability
                         END AS [nullabilty] ,
                         CASE 
                         WHEN system_type_id = 34    THEN 'image'
             WHEN (system_type_id = 35 OR cid = 35)    THEN 'text'
             WHEN (system_type_id = 36  OR cid = 36)  THEN 'uniqueidentifier'
             WHEN (system_type_id = 40  OR cid = 40)  THEN 'date'
             WHEN (system_type_id = 41  OR cid = 41)  THEN 'time'
             WHEN (system_type_id = 42  OR cid = 42)  THEN 'datetime2'
             WHEN (system_type_id = 48  OR cid = 48)  THEN 'tinyint'
             WHEN (system_type_id = 52  OR cid = 52)  THEN 'smallint'
             WHEN (system_type_id = 56  OR cid = 56)  THEN 'int'
             WHEN (system_type_id = 58  OR cid = 58)  THEN 'smalldatetime'
             WHEN (system_type_id = 59  OR cid = 59)  THEN 'real'
             WHEN (system_type_id = 60  OR cid = 60)  THEN 'money'
             WHEN (system_type_id = 61  OR cid = 61)  THEN 'datetime'
             WHEN (system_type_id = 62  OR cid = 62)  THEN 'float'
             WHEN (system_type_id = 98  OR cid = 98)  THEN 'sql_variant'
             WHEN (system_type_id = 99  OR cid = 99)  THEN 'ntext'
             WHEN (system_type_id = 104 OR cid = 104)   THEN 'bit'
             WHEN (system_type_id = 106 OR cid = 106)  THEN 'decimal'
             WHEN (system_type_id = 108 OR cid = 108)  THEN 'numeric'
             WHEN (system_type_id = 122 OR cid = 122)  THEN 'smallmoney'
             WHEN (system_type_id = 127 OR cid = 127)  THEN 'bigint'
             WHEN (system_type_id = 165 OR cid = 165)  THEN 'varbinary'
             WHEN (system_type_id = 167 OR cid = 167)  THEN 'varchar'
             WHEN (system_type_id = 173 OR cid = 173)  THEN 'binary'
             WHEN (system_type_id = 175 OR cid = 175)  THEN 'char'
             WHEN (system_type_id = 189 OR cid = 189)  THEN 'timestamp'
             WHEN (system_type_id = 231 OR cid = 231)  THEN 'nvarchar'
             WHEN (system_type_id = 239 OR cid = 239)  THEN 'nchar'
             WHEN (system_type_id = 241 OR cid = 241)  THEN 'xml'
--             when (system_type_id = 243 OR cid = 243)  THEN 'TABLE'
         END AS [Type]
  FROM sys.types as typ  left outer join (select table_types.name tt_name, columns.name c_name ,columns.max_length c_maxlen ,columns.precision c_precision ,columns.scale c_scale,columns.is_nullable c_nullability ,columns.system_type_id cid
                                          from sys.table_types , sys.columns  
                                          where columns.object_id = table_types.type_table_object_id)  tt
 on  (typ.name = tt.tt_name)                           
 where typ.is_user_defined = 1 
```

# python - Python中更快的套接字

> ID：10742639
> 
> 赞同：6
> 
> 时间：2012-05-24T17:42:44.220
> 
> 标签：python, performance, sockets, python-3.x

我有一个用 Python 编写的用于服务器的客户端，它通过 LAN 运行。该算法的某些部分密集使用套接字读取，它的执行速度比用 C++ 编写的[几乎相同](http://pastie.org/3962231)的算法慢 3-6 倍。有哪些解决方案可以让 Python 套接字读取更快？

我实现了一些简单的缓冲，我使用套接字的类如下所示：

```
import socket
import struct

class Sock():
    def __init__(self):
        self.s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        self.recv_buf = b''
        self.send_buf = b''

    def connect(self):
        self.s.connect(('127.0.0.1', 6666))

    def close(self):
        self.s.close()

    def recv(self, lngth):
        while len(self.recv_buf) < lngth:
                self.recv_buf += self.s.recv(lngth - len(self.recv_buf))

        res = self.recv_buf[-lngth:]
        self.recv_buf = self.recv_buf[:-lngth]
        return res

    def next_int(self):
        return struct.unpack("i", self.recv(4))[0]

    def next_float(self):
        return struct.unpack("f", self.recv(4))[0]

    def write_int(self, i):
        self.send_buf += struct.pack('i', i)

    def write_float(self, f):
        self.send_buf += struct.pack('f', f)

    def flush(self):
        self.s.sendall(self.send_buf)
        self.send_buf = b'' 
```

PS：分析还表明大部分时间都花在了读取套接字上。

**编辑：**因为数据是在已知大小的块中接收的，所以我可以一次读取整个块。因此，我将代码更改为：

```
class Sock():
    def __init__(self):
        self.s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        self.send_buf = b''

    def connect(self):
        self.s.connect(('127.0.0.1', 6666))

    def close(self):
        self.s.close()

    def recv_prepare(self, cnt):
        self.recv_buf = bytearray()
        while len(self.recv_buf) < cnt:
            self.recv_buf.extend(self.s.recv(cnt - len(self.recv_buf)))

        self.recv_buf_i = 0

    def skip_read(self, cnt):
        self.recv_buf_i += cnt

    def next_int(self):
        self.recv_buf_i += 4
        return struct.unpack("i", self.recv_buf[self.recv_buf_i - 4:self.recv_buf_i])[0]

    def next_float(self):
        self.recv_buf_i += 4
        return struct.unpack("f", self.recv_buf[self.recv_buf_i - 4:self.recv_buf_i])[0]

    def write_int(self, i):
        self.send_buf += struct.pack('i', i)

    def write_float(self, f):
        self.send_buf += struct.pack('f', f)

    def flush(self):
        self.s.sendall(self.send_buf)
        self.send_buf = b'' 
```

`recv`'ing from socket 在这段代码中看起来是最佳的。但现在`next_int`并`next_float`成为第二个瓶颈，它们每次调用大约需要 1 毫秒（3000 个 CPU 周期）来解包。是否有可能让它们更快，就像在 C++ 中一样？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-26T04:20:03.933

您最新的瓶颈在于`next_int`and`next_float`因为您从 and 创建中间字符串`bytearray`，因为您一次只解压缩一个值。

该`struct`模块有一个`unpack_from`带缓冲区和偏移量的模块。这更有效，因为无需从您的 : 创建中间字符串`bytearray`：

```
def next_int(self):
    self.recv_buf_i += 4
    return struct.unpack_from("i", self.recv_buf, self.recv_buf_i-4)[0] 
```

此外，`struct`模块一次可以解包多个值。目前，您为每个值从 Python 调用 C（通过模块）。通过减少调用它的次数并让它在每次调用中做更多的工作，你会得到更好的服务：

```
def next_chunk(self, fmt): # fmt can be a group such as "iifff" 
    sz = struct.calcsize(fmt) 
    self.recv_buf_i += sz
    return struct.unpack_from(fmt, self.recv_buf, self.recv_buf_i-sz) 
```

如果您知道这`fmt`将始终是 4 字节整数和浮点数，您可以替换`struct.calcsize(fmt)`为`4 * len(fmt)`.

最后，作为一个偏好问题，我认为这读起来更干净：

```
def next_chunk(self, fmt): 
    sz = struct.calcsize(fmt) 
    chunk = struct.unpack_from(fmt, self.recv_buf, self.recv_buf_i)
    self.recv_buf_i += sz
    return chunk 
```

# iphone - 如何在 Core Data 中建立与可选值的有序关系？

> ID：10742644
> 
> 赞同：2
> 
> 时间：2012-05-24T17:43:15.887
> 
> 标签：iphone, core-data

我的汽车对象有四个乘客对象。汽车需要知道乘客坐在哪里，但反向关系没有意义，即`frontPassengerSeatOccupant`合乎逻辑，但`carWhosFrontPassengerSeatImSittingIn`似乎毫无意义（那么我需要另外三个座位来代替其他三个座位），我宁愿只是有一个`carImSittingIn`。

CoreData 建议我对除“高级”情况外的所有内容都有反向关系，因此我正在努力遵守这一点。所以我试图做一个有序的`occupants`关系，座位0是司机，1是前排乘客，2是后排司机，3是后排乘客。当我在 1 号座位上没有任何人，但在 2 号或 3 号座位上有人时，就会出现问题，因为我无法在阵列中放置占位符。

什么是一种干净的方法来实现这个有序的、可能是空座位的问题，同时保持反向关系，并且没有所有这些额外的无意义的属性？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T17:50:30.950

只需让 Occupants 对象包含您为每个占用者设置的 seatNumber 属性（您可以使用上述想法中的整数）。

然后，您可以在有序集中拥有 1-4 个 Occupant 对象，而不会将“空”点用作占位符。

然后，我将在您的 Car 对象中有一个方法，类似于：

```
- (BOOL)addOccupant:(Occupant *)occupant {
    // Make sure that occupant.seatNumber is valid.
    // Check your existing occupants to make sure nobody is already in that seat.
    // Add them to the relationship (your ordered set) in the proper order.
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T17:52:51.843

有两种方法可以做到这一点：提供一个代表空座位的对象，或者创建一个`Seat`包含参与者的中间对象。

Core Data 将有序关系建模为`NSOrderedSet`. `NSOrderedSet`连续存储对象（即它不包含任何`nil`值） 您可以创建一个虚拟对象来表示一个未占用的座位。您需要跟踪“null occupant”对象，我想您最终会遇到很多复杂的`if ([occupant isNullOccupant])`逻辑来处理这种特殊情况。

另一种我认为更简洁的解决方案是拥有三个实体：`Car`、`Seat`和`Occupant`。汽车将与 具有一对多关系`Seat`，而 a`Seat`将与 具有一对一关系`Occupant`。您的模型将如下所示：

```
Car <-->> Seat <<--> Occupant 
```

# asp.net - RDLC“导出”选项显示在数据后面

> ID：10742646
> 
> 赞同：1
> 
> 时间：2012-05-24T17:43:25.477
> 
> 标签：asp.net, vb.net, reporting-services, rdlc, rdl

我开发了一些我在我的 asp.net/vb.net 项目中使用的 rdlc 文件。报告加载得很好，但是当我单击工具栏中的“导出”时，它显示在数据后面

![](../Images/013a79f2c25a17668e027916f9a5469f.png)

我想我可以玩弄`Z indexes`，但没有明确地看到工具栏的任何方法。关于如何解决的任何想法？下面是我在aspx页面中的代码

```
<asp:ReportViewer ID="ReportViewer1" runat="server" Font-Names="Verdana" 
    Font-Size="8pt" InteractiveDeviceInfos="(Collection)" 
    WaitMessageFont-Names="Verdana" WaitMessageFont-Size="14pt" Width="100%" AsyncRendering="true" SizeToReportContent="true">                                                                                                                                             
    <LocalReport ReportPath="Report\myReport.rdlc" EnableHyperlinks="true">                                           
        <DataSources>                                
            <asp:ReportDataSource DataSourceId="SqlDataSource1" Name="DataSet1"/>                                                                  
        </DataSources>                
    </LocalReport>                          
</asp:ReportViewer> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T20:11:30.813

万一有人在以后遇到这个问题，我将以下 jquery 添加到我的 .aspx 文件中并且它起作用了。

```
<script type="text/javascript">
    $(document).ready(function () {
        $('#ctl00_appPages_ReportViewer1_ctl06_ctl04_ctl00_Menu').css('z-index', 99);
    });        
</script> 
```

# gwt - GWT：发送 csv 文件作为响应时，响应未返回到 onSubmitComplete

> ID：10742659
> 
> 赞同：0
> 
> 时间：2012-05-24T17:43:56.637
> 
> 标签：gwt, csv, download, httpresponse

我试图从本质上是一个“.csv”文件的 servlet 中获取响应。我将文件上传到服务器解析它读取它，然后如果文件中有任何错误，我将其写入 CSV 文件并将其发送回作为响应。但似乎响应永远不会回到 onSubmitComplete。这是我的代码。

```
if (!errorContents.isEmpty()) {

                            CSVWriter csv = null;
                            try{
                                String filename = "errorList.csv";
                                resp.setContentType("text/plain");
                                resp.setHeader("Content-Disposition", "attachment; filename=\"" + filename + "\"");
                                csv = new CSVWriter(new OutputStreamWriter(resp.getOutputStream()));

                                for (String[] row : errorContents) {
                                    csv.writeNext(row);
                                }

                            }finally {
                                csv.close();
                            }

                        } else {
                            resp.setContentType("text/plain");
                            resp.getWriter().write("Successful Processing");

                        } 
```

现在客户端控制器的代码

```
formPanel.addSubmitCompleteHandler(new FormPanel.SubmitCompleteHandler() {
            @Override
            public void onSubmitComplete(FormPanel.SubmitCompleteEvent event) {
                controller.reloadAll();
                com.google.gwt.user.client.Window.alert(event.getResults().toString());
                hideContentDiv();
//                loading.hide();
            } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T20:22:42.743

许多浏览器只会在 text/html 返回时触发该事件。这是一个已知的怪癖，并记录在[http://google-web-toolkit.googlecode.com/svn/javadoc/latest/com/google/gwt/user/client/ui/FormPanel.html#FormPanel](http://google-web-toolkit.googlecode.com/svn/javadoc/latest/com/google/gwt/user/client/ui/FormPanel.html#FormPanel) ()

# c# - C# 使用不同的用户凭据访问活动目录

> ID：10742661
> 
> 赞同：7
> 
> 时间：2012-05-24T17:44:14.707
> 
> 标签：c#, .net, active-directory, directoryservices

我们刚刚为我们的用户提供了一个新的用户创建应用程序。然而，这些用户需要能够通过应用程序创建用户，即使他们自己没有创建用户的权限。

在 C# 中，您如何模拟另一个用户才能拥有此功能。此应用程序主要使用`System.DirectoryServices`.

代码片段：

```
DirectoryEntry dEntry = new DirectoryEntry("LDAP://OU=");
DirectorySearcher dSearcher = new DirectorySearcher(dEntry);
//filter just user objects
dSearcher.SearchScope = SearchScope.Subtree;
dSearcher.Filter = "(&(objectClass=user)(mail=" + excel_Holding_Table.Rows[i]["EmailAddress"].ToString() + "))";
dSearcher.PageSize = 1000;
sResults = dSearcher.FindAll(); 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-24T17:50:25.660

您可以[`DirectoryEntry`](http://msdn.microsoft.com/en-us/library/system.directoryservices.directoryentry.aspx)直接使用该类并指定用户名和密码：

```
DirectoryEntry de = new DirectoryEntry(path);

de.Username = "username";
de.Password = "password"; 
```

并从 de 对象访问 Active Directory。或者您可以使用`WindowsIdentity`该类并模拟用户：

```
WindowsIdentity newId = new WindowsIdentity(safeTokenHandle.DangerousGetHandle());
WindowsImpersonationContext impersonatedUser = newId.Impersonate(); 
```

完整的代码示例可在以下位置获得：

[模拟和目录条目](https://stackoverflow.com/questions/8957886/impersonation-and-directoryentry)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T17:51:25.617

使用带有用户名、密码和 authenticationType 参数[的`DirectoryEntry`构造函数](http://msdn.microsoft.com/en-us/library/wh2h7eed.aspx)。

顺便说一句，`DirectoryEntry` `DirectorySearcher`and`SearchResultCollection`类型是`IDisposable`- 您需要处理它们，可能带有`using`语句。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T17:52:20.760

使用接受用户名和密码而不是模拟的 DirectoryEntry 构造函数（字符串、字符串、字符串、AuthenticationTypes）。

```
DirectoryEntry directoryEntry = new DirectoryEntry("IIS://" + serverName + "/W3SVC/1/Root", @"domain\username", "password", AuthenticationTypes.Secure | AuthenticationTypes.Sealing); 
```

[参考](https://stackoverflow.com/questions/9620566/impersonate-not-working-for-directoryservices)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-01-21T12:19:17.247

正如其他答案所建议的那样，您可以使用特权凭据连接到 AD 或模拟特权用户。

但这具有安全隐患，因为这意味着您的用户将能够将这些特权凭据用于其他未经授权的目的。

更安全的解决方案是创建一个在具有适当 AD 权限的服务帐户下运行的 Web 服务。用户可以使用 Windows 身份验证对 Web 服务进行身份验证，并且 Web 服务将代表他们创建用户。它可以使用授权来限制允许用户做什么（例如只在他们自己的部门创建用户）。

# python - 将元素分配给缓冲区和缓冲区中的特定位置 - 如何加快速度/为什么不同的实现这么慢？

> ID：10742664
> 
> 赞同：1
> 
> 时间：2012-05-24T17:44:18.667
> 
> 标签：python

我正在尝试加快以下代码的速度，在给定字符串列表的情况下，`str_list`我试图将字符串转换为数字 ( `unpack`) 并将此数字分配到嵌套列表的正确位置`data`。的尺寸`data`大致为`data[4][20][1024]`. 不幸的是，这个函数运行得很慢。这是代码：

```
for abs_idx in range(nbr_elements):

    # get string
    this_element = str_list[abs_idx]

    # convert into number
    this_element = unpack('d', this_element)[0]

    # calculate the buffer number
    buffer_nbr = abs_idx / NBR_DATA_POINTS_PER_BUFFER_INT

    # calculate the position inside the buffer
    index_in_buffer = abs_idx % NBR_DATA_POINTS_PER_BUFFER_INT

    # write data into correct position
    data[file_idx][buffer_nbr][index_in_buffer] = this_element 
```

我还尝试了以下替代解决方案，它甚至更慢：

```
# convert each string into a number
unpacked_values = [unpack('d', str_list[j])[0] for j in range(nbr_elements)]
for abs_idx in range(nbr_elements):

    # calculate the buffer number
    buffer_nbr = abs_idx / NBR_DATA_POINTS_PER_BUFFER_INT

    # calculate the position inside the buffer
    index_in_buffer = abs_idx % NBR_DATA_POINTS_PER_BUFFER_INT

    # write data into correct position
    data[file_idx][buffer_nbr][index_in_buffer] = unpacked_values[abs_idx] 
```

令我惊讶的是，下一个实现是最慢的（我预计它是最快的）：

```
# convert each string into a number
unpacked_values = [unpack('d', str_list[j])[0] for j in range(nbr_elements)]

# calculate all buffer numbers at once
buffer_ids = np.arange(nbr_elements) / NBR_DATA_POINTS_PER_BUFFER_INT

# calculate all positions inside the buffer at once
index_in_buffer_id = np.arange(nbr_elements) % NBR_DATA_POINTS_PER_BUFFER_INT

for abs_idx in range(nbr_elements):
    data[file_idx][buffer_ids[abs_idx]][index_in_buffer_id[abs_idx]] = unpacked_values[abs_idx] 
```

为什么连续的实现表现更差？个人瓶颈在哪里？我怎样才能加快我的初始代码？

**编辑：**从我的分析测试中，以下两个步骤是瓶颈：运行`unpack`并将值分配给`data`. 我不知道如何加快这些步骤。

**EDIT2：**我需要使用`unpack`，因为我的字符串是十六进制的。

**EDIT3：** `values = unpack("d" * n, "".join(str_list))`解决了解包速度慢的问题。尽管如此，使用三重（原始）或双重（修改）嵌套循环对数据的分配占用了 50% 的时间。有没有办法减少这个时间？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T18:08:57.310

一些优化：

1.  一次拆开所有的刺
2.  循环前获取项目数据[file_idx]

尝试一下：

```
n = len(str_list)
values = unpack("d" * n, "".join(str_list))

a = data[file_idx]

# Just to shorten this code sample
q = NBR_DATA_POINTS_PER_BUFFER_INT

for i in xrange(n):
    a[i / q][i % q] = values[i] 
```

顺便说一句，您是否分析了代码的哪一部分花费的时间最多？

**更新：**

```
n = len(str_list)
values = unpack("d" * n, "".join(str_list))

# Just to shorten this code sample
q = NBR_DATA_POINTS_PER_BUFFER_INT

data[file_idx] = [values[i:i+q] for i in xrange(0, n, q)] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T18:27:05.240

这是不是更快？它减少了一些查找并且不需要使用所有字符串的数字制作中间列表？

```
df = data[file_idx]
index = 0
for value in str_list:
    # not sure what unpack does... is there a faster function 
    # that does the same?
    number = unpack('d', value)[0]

    # calculate the buffer number
    buffer_nbr = index / NBR_DATA_POINTS_PER_BUFFER_INT

    # calculate the position inside the buffer
    index_in_buffer = index % NBR_DATA_POINTS_PER_BUFFER_INT

    # write data into correct position
    df[buffer_nbr][index_in_buffer] = number

    index += 1 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T19:32:45.743

这个怎么样：

```
df = data[file_idx]
index = 0
bufnr = 0
buf = df[0]
for value in str_list:
    # not sure what unpack does... is there a faster function 
    # that does the same?
    number = unpack('d', value)[0]

    buf[index] = number

    index += 1

    if index >= NBR_DATA_POINTS_PER_BUFFER_INT:
        index = 0
        bufnr += 1
        buf = df[bufnr] 
```

难道数据是字典而不是列表？

# jquery - 使用微调器加载 jQuery 整个 HTML 页面

> ID：10742665
> 
> 赞同：17
> 
> 时间：2012-05-24T17:44:19.523
> 
> 标签：jquery, ajax, jspinner

我正在尝试一些简单的事情——制作一个 jQuery 脚本，它将等待显示整个页面，包括所有 DIV、文本和图像。当页面加载时，我想显示一个旋转的 GIF 图像，而不是显示页面的一部分，当整个页面加载时，我们可以在浏览器窗口中淡化页面的内容。

有很多脚本可以通过 ajax 请求加载到容器 DIV 中——但这是不同的。这将在加载 HTML 页面时显示旋转的 GIF。任何帮助表示赞赏

这种类型的脚本仅适用于 ajax 请求

```
$('#loadingDiv')
    .hide()  // hide it initially
    .ajaxStart(function() {
        $(this).show();
    })
    .ajaxStop(function() {
        $(this).hide();
    }); 
```

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-05-24T17:54:47.357

`$(document).ready(...)`加载 DOM 后立即触发。这还为时过早。你应该使用`$(window).on('load', ...)`：

JavaScript：

```
$(window).on('load', function(){
    $('#cover').fadeOut(1000);
}) 
```

CSS：

```
#cover {
    background: url("to/your/ajaxloader.gif") no-repeat scroll center center #FFF;
    position: absolute;
    height: 100%;
    width: 100%;
} 
```

HTML：

```
<div id="cover"></div>
<!-- rest of the page... --> 
```

看看这个jsFiddle：http: [//jsfiddle.net/gK9wH/9/](http://jsfiddle.net/gK9wH/9/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-24T19:00:19.720

我会用覆盖覆盖整个页面，然后在页面加载后删除覆盖。如果您愿意，您可以调整它以显示 loading.gif。这是一个例子：

HTML

```
​&lt;body>
<div id="container">
    <h2>Header</h2>
    <p>Page content goes here.</p>
    <br />
    <button id="remove_overlay">Remove Overlay</button>
</div>
​&lt;/body>​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​ 
```

CSS

```
#container{padding:20px;}

h2 {margin-bottom: 10px; font-size: 24px; font-weight: bold;}

#overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height:2305px !important; /*change to YOUR page height*/
        background-color: #000;
        filter:alpha(opacity=50);
        -moz-opacity:0.5;
        -khtml-opacity: 0.5;
        opacity: 0.5;
        z-index: 998;
}
#remove_overlay{position:relative; z-index:1000;} 
```

jQuery：

```
$(document).ready(function () { 

        // Set a variable that is set to the div containing the overlay (created on page load)
        var page_overlay = jQuery('<div id="overlay"> </div>');

        // Function to Add the overlay to the page
        function showOverlay(){
            page_overlay.appendTo(document.body);
        }
        // Function to Remove the overlay from the page
        function hideOverlay(){
            page_overlay.remove();
        }

        // Show the overlay.
        $(showOverlay);

       });
});

$(document).ready(function () { 
    $(hideOverlay);
}); 
```

您需要对此进行调整，以便在请求页面时立即加载叠加层（调整`$(showOverlay);`调用，使其在文档准备好之前触发。

这是一个简单的工作小提琴，带有一个按钮来删除覆盖。你应该可以从那里去:) [http://jsfiddle.net/3quN5/](http://jsfiddle.net/3quN5/) ​​​</p>

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-24T17:48:27.857

我认为最好的方法是有一个“封面” div，它会在加载时覆盖整个页面。它将是不透明的，并且会包含您的 GIF。

页面加载后，以下内容将隐藏 div：

```
$(document).ready(function() {
  // Hide the 'cover' div
}); 
```

以下将使 div 成为页面的大小：

```
.div{
  height:100%;
  width:100%;
  overflow:hidden;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-24T17:53:39.897

首先，您是指body标签之间的所有内容吗？做旋转礼物的最好方法是添加一个类，将 gif 定义为不重复和居中。当页面准备好显示时删除类。

```
$('body').addClass('loading')
$('body').removeClass('loading') 
```

这始终是最好的技术，因为如果您提交一些东西，然后尝试通过 DOM 添加添加 gif，一些浏览器将不会这样做，因为页面已经提交。

# linux - 可以通过 apache 服务器流式传输或收听来自麦克风的实时音频吗？

> ID：10742680
> 
> 赞同：2
> 
> 时间：2012-05-24T17:45:30.803
> 
> 标签：linux, apache, firewall, audio-streaming, live-streaming

我有一个带有 Zoneminder 的 Fedora13 linux 家庭服务器，用于我自己的家庭安全系统。我可以使用许多网络摄像头和网络摄像头视频直观地监控家庭。但是我听不到任何声音，例如水检测警报或火灾或防盗警报。

有没有办法通过互联网收听来自家庭服务器麦克风的现场声音？我已经有 zoneminder 的 apache 主服务器，所以，我认为它必须与 apache 服务器一样，因为绑定到 apache 服务器的端口 80 不能与其他应用程序共享。由于家里和工作的防火墙，并且由于单个动态 IP 地址，我认为除了 apache 服务器之外别无他法。

如果我可以在 zoneminder 网页上嵌入音频监听应用程序，那将是最理想的。但是，就目前而言，我只想在家里实时收听任何声音。互联网上的单独应用程序很好，只要它是实时的并且通过端口 80 （如 VNC over SSH）。

我查看了 Icecast2 和 Ices，但由于防火墙，这似乎很难或不可能。我考虑使用 'sox' linux 应用程序来检测任何声音并将声音文件作为电子邮件附件发送，但它似乎不太适合我的需要。

我将非常感谢任何建议。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-10-30T15:49:04.807

如果您对家中配备麦克风的 Linux 机器具有 ssh 访问权限，则可以执行以下操作以实时收听周围的声音/噪音。

假设您在家庭 Linux 机器上安装了 arecord，并且**在本地机器上安装了****aplay** （arecord 和 aplay 在 Linux Ubuntu 上都存在）

```
ssh username@your_home_device_ip 'arecord -f cd -t wav' | aplay - 
```

希望这有帮助。

# javascript - Wordpress & AJAX - 使用 AJAX 加载内部页面会阻止 Javascript 在内部页面上运行

> ID：10742684
> 
> 赞同：2
> 
> 时间：2012-05-24T17:46:07.087
> 
> 标签：javascript, ajax, wordpress, jquery

我很抱歉这个长标题，但它充分代表了这个问题。

我正在尝试在我的 WordPress 网站上使用 AJAX 来加载内页。我有这个功能，但是，当加载内页时，任何打算加载和在这些内页上运行的 Javascript/jQuery 都没有运行/加载。

有两个步骤可以查看并重新创建问题：

1st - 看看这个页面：[http](http://www.trekradio.net/dev/schedule) ://www.trekradio.net/dev/schedule - 这个页面包含一个时间表 - 天是标签，当你点击一个时间表项目时，它会打开一个 jQuery 弹出窗口。右侧边栏也使用了 Javascript，在“支持我们”小部件中，下拉菜单是基于 JS 的，而且 Twitter 提要使用 Twitter API 脚本加载。如您所见，所有脚本都存在并且工作正常。

2 - [http://www.trekradio.net/dev/](http://www.trekradio.net/dev/) - 转到主页面，然后单击主菜单上的“计划” - 它使用 AJAX 加载计划页面，但是，页面上的所有脚本现在都丢失了或没有被执行。

我已经尝试了很多方法来解决这个问题 - 在计划页面上，一些脚本嵌入到页面本身中，我尝试将它们移动到标题中，希望因为标题没有重新加载，脚本可能会运行- 他们没有。

另外，我尝试了这里提到的解决方案：[在 AJAX 检索的 <div> 中执行 <script>](https://stackoverflow.com/questions/4619668/executing-script-inside-div-retrieved-by-ajax) - 它谈到使用动态脚本模式，但是，我要么无法使其正常工作，要么无法正常工作在我想要完成的事情的背景下正确地进行。

我也尝试使用这里建议的解决方案：[jquery html() 去除脚本标签](https://stackoverflow.com/questions/4079179/jquery-html-strips-out-script-tags)，但是，我再次无法让它工作。

这是我的 ajax.js 的内容，它支持 ajax 功能：

```
jQuery(document).ready(function($) {
    var $mainContent = $("#ajax-content-container"),
        siteUrl = "http://" + top.location.host.toString(),
        url = ''; 

    $(document).delegate("a[href^='"+siteUrl+"']:not([href*=/wp-admin/]):not([href*=/wp-login.php]):not([href$=/feed/])", "click", function() {
        location.hash = this.pathname;
        return false;
    }); 

    $("#searchform").submit(function(e) {
        location.hash = '?s=' + $("#s").val();
        e.preventDefault();
    }); 

    $(window).bind('hashchange', function(){
        url = window.location.hash.substring(1); 

        if (!url) {
            return;
        } 

        url = url + " #main-content-container"; 

        $mainContent.animate({opacity: "0.1"}).html('<p>Please wait...</>').load(url, function() {
            $mainContent.animate({opacity: "1"});
        });
    });

    $(window).trigger('hashchange');
}); 
```

根据我通过 Google-ing 发现的情况 - 许多人的 AJAX 网站存在此类问题，难以让脚本在加载的页面上运行，所以我希望这里的人们可以帮助提出一个解决方案，不仅我可以申请我的网站，但其他人也可以在他们的网站上使用。

如果人们能在他们的答案中包含代码，或者至少清楚地解释我如何修改代码以完成所需的工作，我将不胜感激。我仍在学习 jQuery/AJAX，所以也许我很愚蠢，忽略了一个相对简单的解决方案，但我怀疑，整个社区以及我自己都会欣赏有据可查的答案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T18:28:12.430

这是因为您提供了一个选择器表达式作为 URL 的一部分：

[http://api.jquery.com/load/](http://api.jquery.com/load/)

根据文档：

> 但是，在以下情况下，正在加载到 #b 的文档中的脚本块被剥离并且不被执行：

```
$('#b').load('article.html #target') 
```

您的网址有选择器：

```
url = url + " #main-content-container"; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-27T16:58:33.023

我想我已经为自己解决了这个问题——我不确定它是否是最优雅的解决方案，但它似乎有效。

基本上，我已经将所有将加载到我的内页上的脚本放入一个名为“inner-scripts.js”的文件中，并将 ajax.js 修改为：

```
jQuery(document).ready(function($) {
    var $mainContent = $("#ajax-content-container"),
        siteUrl = "http://" + top.location.host.toString(),
        url = ''; 

    $(document).delegate("a[href^='"+siteUrl+"']:not([href*=/wp-admin/]):not([href*=/wp-login.php]):not([href$=/feed/])", "click", function() {
        location.hash = this.pathname;
        return false;
    }); 

    $("#searchform").submit(function(e) {
        location.hash = '?s=' + $("#s").val();
        e.preventDefault();
    }); 

    $(window).bind('hashchange', function(){
        url = window.location.hash.substring(1); 

        if (!url) {
            return;
        } 

        url = url + " #main-content-container"; 

        $mainContent.animate({opacity: "1.0"}).html('<div id="loading">Loading the next page for you.  Please stand by!</div>').load(url, function() {
            $mainContent.animate({opacity: "1"});
            $.getScript('http://www.trekradio.net/dev/wp-content/themes/tr2012/js/inner-scripts.js', function() {});
            $.getScript('http://ui.jquery.com/latest/ui/effects.core.js', function() {});
            $.getScript('http://twitter.com/javascripts/blogger.js', function() {});
        $.getScript('https://api.twitter.com/1/statuses/user_timeline.json?screen_name=trekradio&include_rts=1&count=3&callback=twitterCallback2', function() {});      
        });
    });

    $(window).trigger('hashchange');
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-31T10:25:14.703

我知道你自己已经回答了这个问题，但这是另一种方法。

在 wordpress 中发出 ajax 请求的常规方法是使用此处记录的 admin-ajax 接口：http: [//codex.wordpress.org/AJAX_in_Plugins](http://codex.wordpress.org/AJAX_in_Plugins)。

这允许您将函数附加到 ajax 请求，并且该函数或多或少在 WordPress 的上下文中执行。所以你可以在你的`functions.php`：

```
add_action('wp_ajax_trekradio_get_ajax_page', 'trekradio_get_ajax_page');
add_action('wp_ajax_nopriv_trekradio_get_ajax_page', 'trekradio_get_ajax_page');

function trekradio_get_ajax_page() {

    $page_id = $_POST['page_id']; // send this in the ajax request

    if ( the page is a certain page that needs scripts ) {
        print_relevant_script_tags();
    }

    print_page_content( $page_id );

    die(); // you have to do this at the end
} 
```

# java - 在ChildClick上获取空指针异常

> ID：10742685
> 
> 赞同：0
> 
> 时间：2012-05-24T17:46:21.967
> 
> 标签：java, android, expandablelistview, expandablelistadapter

试图在可扩展列表视图中获取子项的文本值。

在 onchildclick 事件中获取空指针异常。

```
 E/AndroidRuntime(358): at tournament.tracker.pkg.ExpList$5.onChildClick(ExpList.java:124) 
```

第 124 行是该`adapter.getChild`行。

我正在尝试将单击的子项的字符串值传递给另一个活动。

```
expList.setOnChildClickListener(new OnChildClickListener()
  {

    @Override
    public boolean onChildClick(ExpandableListView parent, View v, int groupPosition, int childPosition, long id) {
        ExpandableListAdapter adapter = getExpandableListAdapter();
        gametype = adapter.getChild(groupPosition, childPosition).toString();
        //---------------------
        Intent pullt = new Intent(ExpList.this, JsonActivity.class);
        Bundle bundle = new Bundle();
        bundle.putString("gametype", gametype);
        pullt.putExtras(bundle);
        pullt.putExtra("gametype", gametype);

        startActivity(pullt);
        //---------------------
        return false;
    }

  }); 
```

任何人都知道为什么这不起作用？如果可能，请提供帮助

*编辑*

这是适配器：

```
public class ExpAdapter extends BaseExpandableListAdapter {

      private Context myContext;
      public ExpAdapter(Context context) {
       myContext = context;
      }

      @Override
      public Object getChild(int groupPosition, int childPosition) {
       return null;
      }

      // Other code - not relevant
     } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T18:03:51.990

```
public Object getChild(int groupPosition, int childPosition) {
    return null;
} 
```

此函数将**始终**返回 null。尝试以任何方式（如使用`toString()`）访问 null 将创建一个空指针异常，您必须实现此函数才能返回实际数据。

修复可能是：

```
public Object getChild(int groupPosition, int childPosition) {
    return ExpList.arrChildelements[groupPosition][childPosition];;
} 
```

# batch-file - 使用 Windows 批处理编程在文件中搜索和替换

> ID：10742686
> 
> 赞同：3
> 
> 时间：2012-05-24T17:46:23.923
> 
> 标签：batch-file

我有一个批处理文件，我想打开一个文件并对该文件进行非常简单的搜索和替换，然后保存（覆盖）它执行搜索和替换的文件。

我知道如何读取文件的第一行：

```
set /p file= < file.txt 
```

但是在读取整个文件并对其进行搜索/替换的批处理方法上苦苦挣扎。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T20:19:45.387

很难给出明确的答案，因为不清楚您所说的*非常简单的搜索和替换*是什么意思，但这里有所有需要的元素：

**读取文件**

您可以使用以下命令逐行读取文件`for /f`：

```
for /f %%a in (myfile.txt) do (
    echo %%a
) 
```

**替换文本**

这是我知道如何替换文本的一种方法：

```
SETLOCAL ENABLEDELAYEDEXPANSION
for /f "delims=" %%a in (myfile.txt) do (
    SET s=%%a
    SET s=!s:stringtoreplace=replacementstring!
    echo !s!
) 
```

这将输出所有行`myfile.txt`并将*stringtoreplace*替换为*replacementstring*。

**覆盖文件**

您可以考虑先写入一个新的临时文件，然后用新的临时文件替换原始文件。

通过上面的例子，它就像`>>yourtempfilename.txt`在`echo`语句之后添加一样简单。

**过滤文件的行**

如果您只是想从文件中删除一些行，您也可以考虑使用`findstr`命令 ( `help findstr`)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-02-06T16:28:30.453

将 filename.txt 和 search1/replace1 替换为您的文件名和正确的搜索/替换字符串或文本。

```
 Echo off
    set "textfile=filename.txt"
    set "tempfile=filenametemp.txt"
    (for /f "delims=" %%i in (%textfile%) do (
        set "line=%%i"
        setlocal enabledelayedexpansion
        set "line=!line:search1=replace1!"
        echo(!line!
        endlocal
    ))>"%tempfile%"
    del %textfile%
    rename %tempfile%  %textfile% 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-02-21T09:34:58.453

您可以在文件中进行搜索和替换，或者使用硬编码字符串或使用 VBScript 的正则表达式（可以通过批处理脚本执行）。

以下是使用硬编码搜索条件进行搜索和替换的示例：

```
<job>
<script language="JavaScript">
    var fso = new ActiveXObject("Scripting.FileSystemObject");  
    var MyFile = fso.GetFile("c:\\file.json");
    var txt = MyFile.OpenAsTextStream(1).ReadAll();
    txt = txt.replace("criteria", "replacing value");
    WScript.echo("Replaced File"+txt);
    var out = MyFile.OpenAsTextStream(2);
    out.write(txt);
</script> 
```

将此脚本保存在名为 replace.wsf 的文件中。然后，您可以从这样的批处理文件中执行脚本（在 Windows 操作系统中）：

```
pushd %~dp0
cscript c:\replace.wsf 
```

如果您需要基于正则表达式进行搜索和替换，那么我建议您查看此示例：[regex search replace in batch](https://stackoverflow.com/questions/7023460/regex-search-replace-in-batch)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2022-01-17T20:08:33.813

要添加到[Johan A 的答案](https://stackoverflow.com/a/48647602/1263035)，如果您希望从用户输入中提供查找/替换字符串而不是硬编码，您可以这样编写。

*（我还添加了一个`finalfilename`变量，因为我想保持原始文件不变，只生成一个带有输出的新文件。如果您希望它覆盖原始文件，只需将其设置为与源文件名相同）*

```
@ECHO OFF
set "sourcefile=sourcefilename.txt"
set "tempfile=filenametemp.txt"
set "finalfilename=outputfile.txt"

ECHO Enter search term to find:
set /p search1=

ECHO Enter replacement string:
set /p replace1=

ECHO Finding  %search1%  and replacing with  %replace1%

(for /f "delims=" %%i in (%sourcefile%) do (
    set "line=%%i"
    setlocal enabledelayedexpansion
    set "line=!line:%search1%=%replace1%!"
    echo(!line!
    endlocal
))>"%tempfile%"

:: Delete potential existing final file to avoid duplicate error when renaming
del %finalfilename%
ECHO Setting filename to  %finalfilename%
rename %tempfile%  %finalfilename%

ECHO Done
:: Pause to see messages
PAUSE 
```

# objective-c - 基于文档的应用程序中的 NSTableView 为空

> ID：10742688
> 
> 赞同：0
> 
> 时间：2012-05-24T17:46:35.517
> 
> 标签：objective-c, cocoa, nstableview, document-based

我正在开发基于 OSC 文档的应用程序。我在与我的文档关联的 xib 文件中有一个“静态”NSTableView。表视图绑定了一个 NSObject 类，该类在我创建 OSC 连接时初始化（因此内部没有“didLoadNib”方法）。一切似乎都正常：mu 连接正常，NSTableView 显示良好，但课程没有通过

```
- (id) tableView:(NSTableView*)tableView objectValueForTableColumn:(NSTableColumn*)tableColumn row:(NSInteger)row 
```

并且 NSTableView 仍然为空，即使我更改了我的实例化类值，并且 NSMutableArray 与 NSTableView 绑定它似乎只有当我在我的 [[myTableView alloc] init]

```
- (void)windowControllerDidLoadNib:(NSWindowController *)aController 
```

（但没有显示任何东西，它只看到我有正确的行数，它没有通过以前的方法）希望这有点清楚......有没有人有想法。提前非常感谢。

本

# vim - 铬浏览器换行模式

> ID：10742690
> 
> 赞同：0
> 
> 时间：2012-05-24T17:46:42.220
> 
> 标签：vim, chromium

我有一个 21 英寸的桌面，通常两个窗口并排打开。打开网页时，我必须水平滚动才能查看内容。有没有办法像vim一样包装网页内容

```
:set wrap 
```

我希望我的问题很清楚。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T21:04:09.713

[存在](http://www.apple.com/safari/whats-new.html#read)[一些](http://evernote.com/clearly/)允许您以更易于管理的方式阅读网页内容的工具[。](http://www.readability.com/)

或者，您可以使用 Pendule 或其他 Chrome 扩展程序完全禁用给定网页的 css。

有趣的是，www*和*HTML 实际上是围绕可访问性、可用性、互操作性以及在我碰巧使用的任何该死的客户端中舒适地阅读该死网页的该死内容的能力等完全美丽的原则设计的。

但是我们的客户并不在乎这一切，他们是那些付钱给我们设计/建立他们的网站的人。*这就是*为什么当窗口太窄而无法显示他们该死的右栏时，你（和我）被迫水平滚动。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T18:00:33.333

您可以使用 view-source:http://...... 然后您不必水平滚动，只需垂直滚动即可。

# ios - iOS 5 - 在触摸时画一个圆圈

> ID：10742694
> 
> 赞同：2
> 
> 时间：2012-05-24T17:47:19.063
> 
> 标签：ios, ios5, core-graphics

我想让我的应用程序绘制一个以触摸坐标为中心的圆。

这是我现在拥有的代码，它肯定是一团糟，我没有任何绘制事物和使用上下文的实践。我在这里想念什么？提前致谢。

视图控制器是 UIViewController 的子类

```
@implementation ViewController

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
if (self) {
    // Custom initialization
}
return self;
}

- (void)viewDidLoad
{
[super viewDidLoad];
}

- (void)viewDidUnload
{
[super viewDidUnload];
}

- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event
{
UITouch *theTouch = [touches anyObject];

[self doSomething];

//[self.view setNeedsDisplay];

}

- (void) drawCircleAtPoint:(CGPoint)point withRadius:(CGFloat)radius inContext:(CGContextRef)context{
UIGraphicsPushContext(context);
CGContextBeginPath(context);
CGContextAddArc(context, point.x, point.y, radius, 0, 2*M_PI, YES);
CGContextFillPath(context);
UIGraphicsPopContext();
}

- (void)drawRect:(CGRect)rect
{
CGPoint point;
CGContextRef context = UIGraphicsGetCurrentContext();
point.x = self.view.bounds.origin.x + self.view.bounds.size.width/2;
point.y = self.view.bounds.origin.y + self.view.bounds.size.height/2;
CGContextSetLineWidth(context, 5.0);
[[UIColor whiteColor] setFill];
[self drawCircleAtPoint:point withRadius:50 inContext:context];

}

@end 
```

在这里，我希望它至少在屏幕中心绘制圆圈，但我什至不能这样做。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T19:02:51.283

**drawRect 是 UIView 类的一个方法。** 它在 ViewController 中不可用，因此不会被调用。

理想情况下，您应该将 drawRect 和 drawCircleAtPoint 放在 UIView 子类中。还要在该视图类中添加触摸方法。你可以叫它，DrawCircleView 什么的。

现在创建这个自定义视图的对象，并将其作为子视图添加到 viewDidLoad 中的 viewcontroller 视图中。

在 touches 方法中调用 setNeedsDisplay 并将 touvh 的点存储在 CGPoint 实例变量中并在 drawRect 中访问它。

**更新**

您可能想要保存以前绘制的圆圈。

有很多可能性，选择最适合你的，我没有给你详细的解释，但足够的信息让你继续。

*   如果您希望圆是可编辑的，那么您将不得不继续添加有关中心和半径的圆信息作为**NSMutableArray 中的一个对象**。并且在您的 drawRect 开始时，您将不得不在一个循环中重绘所有这些。

    **事实上，我建议您使用 CGPath**并**继续向该路径添加圆圈，**并将路径添加到 drawRect 中的 cgcontext 保持 CGPath 作为实例变量，以便它保留上次 drawRect 调用的先前信息。但是同样，如果您希望能够用不同的颜色绘制圆圈，那么它们必须位于不同的 CGPath 中，那么您可以将这些 CGPath 与对象中的颜色信息再次添加到可变数组中。

或者

*   如果数组不断增长，保存和重绘所有这些圆圈将阻碍性能。如果您不想要撤消功能或者您不想编辑以前的圈子。然后，您可以将 drawRect 末尾绘制的任何内容保存为 imageData ，然后将其保存为实例 var 并在每次调用 drawRect 时重绘它，然后在其顶部绘制一个圆圈并将图像再次保存到同一实例中。

例如：在 drawRect 结束时，您可以将屏幕图像保存到实例变量 _savedImage 中。

```
 _savedImage = UIGraphicsGetImageFromCurrentImageContext(); 
```

并且在 drawRect 的开头重绘时，如果 _savedImage**不为零**，则

```
 [_savedImage drawInRect:rect]; 
```

然后你可以在你点击的点周围画一个圆圈。此外，如果您愿意，您可以随时将绘图保存到实际图像文件中：

```
 NSData *imageData = UIImagePNGRepresentation(_savedImage);
[imageData writeToFile:@"imageName.png"]; 
```

或者

*   如果你愿意，你可以探索`CGContextSaveGState() and CGContextRestoreGState()` 它们分别用于推送和弹出上下文到堆栈。因此，您可以获得最后一个上下文并重新绘制它，在恢复和保存之间，您可以绘制您的圆圈。签出此 stackOverflow 帖子：[保存和恢复 CGContext](https://stackoverflow.com/questions/1446446/saving-and-restoring-cgcontext)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-24T19:00:53.963

drawRect 的方法调用发生在**UIView**中，而不是在**UIViewController**中- UIViewController 管理视图，并自己处理委托和其他相关项目。绘图发生在 viewController 的 view 属性中。

在您的情况下，您需要执行以下操作：

1.  使用您自己的视图子类化 UIView，并在那里实现 drawRect 和 drawCircle 方法
2.  将 XIB 中的默认 UIView 替换为您自己的类（IB -> Identity Inspector -> Custom Class）
3.  连接事件以检测手指触摸，然后使用 [查看 setNeedsDisplay] 强制刷新

注意：子类化和覆盖 UIImageView 的 drawRect 什么都不做 - 它是专门处理的：

> UIImageView 类经过优化，可以将其图像绘制到显示器上。UIImageView 不会调用 drawRect: 一个子类。如果您的子类需要自定义绘图代码，建议您使用 UIView 作为基类。

# matlab - Matlab：从文件中存储数据

> ID：10742700
> 
> 赞同：-1
> 
> 时间：2012-05-24T17:47:49.447
> 
> 标签：matlab, file-io

我正在尝试从文本文件中读取数据并在 Matlab 中对其进行 3D 绘图。目前，我得到的只是一个空白图，所以我的猜测是数据没有正确存储或根本没有存储。另外，我不希望每个向量末尾都有 1.000000，所以我怎么能忽略它呢？谢谢。

这是文件：

> 块引用

```
TechEdge4:<152.266724,173.189377,27.995975>  1.000000
<117.880638,156.116531,27.999983>  1.000000
<129.849899,59.195660,27.999983>  1.000000
<249.321121,60.605404,27.999983>  1.000000
<224.120361,139.072739,28.000668>  1.000000
<171.188950,143.490921,56.933430>  1.000000
<171.188950,143.490921,83.548088>  1.000000
<171.188950,143.490921,27.999985>  1.000000 
```

这是代码：

```
file = fopen('C:\Program Files (x86)\Notepad++\testFile.txt'); % open text file

tline = fgetl(file); % read line by line and remove new line characters

% declare empty arrays
CX = [];
CY = [];
CZ = [];

while ischar(tline) % true if tline is a character array

    temp = textscan(tline,'%n%n%n', 'delimiter',',');

    % convert all the cell fields to a matrix
    CX = vertcat(CX, cell2mat(temp));
    CY = vertcat(CY, cell2mat(temp));
    CZ = vertcat(CZ, cell2mat(temp));

    tline = fgetl(file);
end

fclose(file); % close the file

plot3(CX, CY, CZ) % plot the data and label the axises
xlabel('x')
ylabel('y')
zlabel('z') 
grid on
axis square 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T18:19:05.110

您的代码现在运行的方式，您的`temp`变量在每次迭代中都是空白的。将 textscan 行替换为

```
temp = cell2mat(textscan(tline, '<%n,%n,%n>')); 
```

然后 CX、CY 和 CZ 线与

```
CX = vertcat(CX, temp(1));
CY = vertcat(CY, temp(2));
CZ = vertcat(CZ, temp(3)); 
```

那应该使它起作用。当然，您需要单独处理第一行，因为其中包含 TechEdge4: 东西。

另外我建议添加一个检查以确保 temp 在`vertcat`s 之前不为空。

# salesforce - 如何在 Apex 或 VisualForce (Salesforce) 中合并两个列表中的数据？

> ID：10742701
> 
> 赞同：2
> 
> 时间：2012-05-24T17:47:54.097
> 
> 标签：salesforce, apex-code, visualforce

在 Apex 或 VisualForce 中合并以下两个列表的最佳方法是什么？数据是相关的，但是不能一起查询，所以需要把两个List合并起来。

注意事项：

1.  这两个列表：additionalInfoQuestionMaps 是父列表，additionalInfoQuestionAvailableResponses 是子列表。可以有 1 到多个孩子。

2.  我需要加入 Question_Type_Info__c 对象的列表。

基本上它是一组来自父列表的问题，然后我需要将可能的答案与这些问题相关联，例如位于子列表中的是和否。这些结果将以表格的形式显示在 VF 页面上。

```
public with sharing class mytest {

    public List<Questions__c> additionalInfoQuestionMaps {get;set;}
    public List<Available_Question_Answer_Options__c> additionalInfoQuestionAvailableResponses {get;set;} 
    public List<retrieveMergedQuestionList> retrieveMergedQuestionLists {get;set;}

    public String buildId {get;set;}

    public Build__c build {get;set;}

    public mytest() {

        buildId = 'a1DV00000001BBBBBB';
        build = sharedfile.getBuild(buildId);
        updateAdditionalInfoQuestionMaps();
        updateAdditionalInfoFieldValueIds();
        updateAdditionalInfoQuestionAvailableResponses();
    }

    public void updateAdditionalInfoQuestionMaps() {

            additionalInfoQuestionMaps = new List<Questions__c>([SELECT Id, Name, 
                          Associated_Product_Item__c, 
                          Associated_Product__c, 
                          Label__c,
                             (select Response__c from Responses_Object__r),  
                          Question_Type_Info__c,  
                          Required__c
                    FROM Questions__c                
                    WHERE Associated_Product__c = :build.Associated_Product__c 
                    ORDER BY Sort_Index__c, Label__c]);
    }

    public Set<Id> additionalInfoFieldValueIds = new Set<Id>();

    public void updateAdditionalInfoFieldValueIds(){
        for (Questions__c aimb : additionalInfoQuestionMaps) {
                additionalInfoFieldValueIds.add(aimb.Question_Type_Info__c);
        }
    }

    public void updateAdditionalInfoQuestionAvailableResponses() {
            additionalInfoQuestionAvailableResponses = new List<Available_Question_Answer_Options__c>([select Id,
                        Field_Value__c, Question_Type_Info__c
                        from Available_Question_Answer_Options__c
                        where Question_Type_Info__c IN :additionalInfoFieldValueIds]);

    }           

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T06:14:04.773

如果我正确理解您的问题，我认为您应该参加包装类

看看我之前发布的一个类似的问题，LaceySnr 给出了解决方案

[如何在 Vf 页面中创建分组数据的部分](https://stackoverflow.com/questions/8900129/how-to-create-sections-of-grouped-data-in-vf-page)

希望这可以帮助。

谢谢

# blackberry - 在 OS 5.0 上运行的应用程序，而不是在 7.0 上运行

> ID：10742702
> 
> 赞同：0
> 
> 时间：2012-05-24T17:47:55.483
> 
> 标签：blackberry, httpconnection

我使用 OS 5.0 制作了一个程序。它可以在 8520 曲线的模拟器上正常工作，也可以在设备中正常工作。

现在我正在尝试在 7.0 版本的 9900 上使用此应用程序，并且它`HttpConnection`在设备中进行堆栈操作。使用我的程序 5.0 版本，在 9900 模拟器中，它工作正常。2个版本有区别吗？我将用于建立连接的代码放入我的线程中。我不知道在哪里可以找到这个问题的任何答案。

```
try {
    mTimer = new Timer();
    mTimer.schedule(new CountDown(), 60000);
    UiApplication.getUiApplication().invokeLater(new Runnable() {
        public void run() {
            popup = new MyPopup("Cargando Incidentes...");
            UiApplication.getUiApplication().pushModalScreen(popup);
        }
    });

    conn = (HttpConnection) Connector.open(URL);

    InputStream contentIn = conn.openInputStream();
    byte[] data = new byte[400];
    int length = 0;
    StringBuffer raw = new StringBuffer();
    while (-1 != (length = contentIn.read(data))) {
        raw.append(new String(data, 0, length));
        str = raw.toString();
    }

    UiApplication.getUiApplication().invokeLater(new Runnable() {
        public void run() {
            try {
                conn.close();
                UiApplication.getUiApplication().invokeLater(new Runnable() {
                    public void run() {
                        try {
                            String datos[] = mainScreen.split(str, "ENDOFPAGE");
                            datos[0] = datos[0].substring(2, datos[0].length());
                            mainScreen.vecRegistro = mainScreen.split(datos[0],"$");
                            mainScreen.insertoEnBd();
                            mainScreen.insertoEnTablaDatosBD(_act);

                            UiApplication.getUiApplication().popScreen(popup);
                        } catch (Exception e) {
                            e.printStackTrace();
                            mainScreen.add(new RichTextField("Error ThreadIncidentes.run: "+ e.toString()));
                        }
                    }
                });
            } catch (IOException e) {
                e.printStackTrace();
            }
        }
    });
    return;
} catch (Exception e) {
}

private class CountDown extends TimerTask {
    public void run() {
        if (str.length() < 50){
            UiApplication.getUiApplication().invokeLater(new Runnable() {
                public void run() {
                    UiApplication.getUiApplication().popScreen(popup);
                    Dialog.alert("Error en la conexion");
                    System.exit(0);

                    clsThreadIncidentes.currentThread().interrupt();
                }
            });
            return;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T07:29:51.363

不要使用`Connection.open`. 这是打开连接的传统方式，通常涉及大量代码来处理后缀，具体取决于您是通过 BIS、MDS、Wi-Fi 还是 TCP 直接连接。

从 5.0 开始，您可以使用更新的 Networking API。这里要参考的关键类是[`ConnectionFactory`](http://www.blackberry.com/developers/docs/5.0.0api/index.html).

# jquery - jQuery 函数与 .load 中断

> ID：10742706
> 
> 赞同：0
> 
> 时间：2012-05-24T17:48:19.133
> 
> 标签：jquery, function, load

我能够成功地将名为 test.html 的页面中的内容加载到名为 page.htm 的页面中：

```
$(document).ready(function(){ 
     $("#reveal").load("test.html");
}); 
```

我在调用的 page.htm 中放置了一个空 div`#reveal`并加载内容 - 没问题。

在 test.html 中，我有两个 div 类，分别指定文章标题和文章内容：.artTitle 和 .artContent。在 page.html 的 css 文件中，我有 display:hidden `.artContent`- 所以所有显示的是`.artTitles`. 然后我想`.artContents`通过切换点击来显示。

我能够让这个 jQuery 进程内联工作（在同一页面中），但在加载 html 时会中断。加载我缺少的问题是什么 - （非常绿色的新手）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T08:21:39.257

好吧，我不是 jQuery 专家。事实上，我来到这里是希望对本质上相同的问题有一个明确的答案。已经给出的答案帮助我指出了正确的方向......这是我的解决方案......

我假设您有一些 jquery 函数，看起来类似于，

```
 $('.trigger').click(function() { $('.artContents').toggle(); }); 
```

通过 .load() 加载的 HTML 包含要单击的 .trigger ，它将切换 .artContents ，是吗？尝试，

```
$(document).on('click','.trigger', function() { $('.artContents').toggle(); }); 
```

我真的希望这会有所帮助。我和你一起在“非常绿色的新手”阵营，但这对我有用。我无法准确解释它为什么起作用。也许别人可以。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T17:51:11.940

罪魁祸首可能是切换功能，而不是加载功能。您可能会绑定到在内容加载之前不存在的元素。您需要使用委托语法`on()`来将侦听器绑定到 #reveal 或其他祖先。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T18:12:05.847

You need to use live event like following:

```
$('body').on('click', '.artTitles', function() { // binding live click to upcoming elements
   var self = this; // keeping reference to clicked title, because this will not catch into the hide callback function due to different scope
   $('.artContents:visible').hide( // hiding visible contents
    function() { // callback function
      $(self).closest('.artContents').show(300); // show content corresponding to title
   });
}); 
```

# mercurial - 使用 TortoiseHG 强制版本号

> ID：10742708
> 
> 赞同：4
> 
> 时间：2012-05-24T17:48:24.090
> 
> 标签：mercurial, versioning

我们有一个受 Mercurial 版本控制的 Java 应用程序。我们正在努力在应用程序中实现[版本控制模式](http://en.wikipedia.org/wiki/Software_versioning#Sequence-based_identifiers)，我想知道 TortoiseHG 如何帮助解决这个问题。是否可以在提交时执行诸如增加构建版本之类的操作，还是必须由开发人员自行决定？我们当前的计划包括在推送到 UAT 时为每个版本号创建书签。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-24T19:58:22.777

原则上，您必须在 TortoiseHg 之外执行此操作 — Mercurial（以及 TortoiseHg）的工作是保持工作副本的状态与单击“提交”时完全相同。

不过，您可能会得到一些帮助：TortoiseHg 可以使用[pre-commit hook](http://www.selenic.com/mercurial/hgrc.5.html#hooks)触发这个“外部”动作。这是在运行之前`hg commit`运行的脚本，并且该脚本有机会更改文件。

当您尝试实施这样的方案时，请记住 Mercurial 是一个**分散**的版本控制系统（这应该不足为奇......），因此人们在*本地*进行提交而不与中央服务器通信。因此，无法保证版本号不被其他人使用。唯一的解决方法是使用变更集哈希作为版本“编号”，但是您不会得到很好的递增数字。但是，如果您有一个集中式构建服务器，那么您可以让它增加版本号，然后回到一个简单的集中式世界观。

最后，让我提一下，Mercurial 有一个[`latesttagdistance`模板关键字](http://www.selenic.com/mercurial/hg.1.html#templates)，它对集中式构建机器非常有帮助：它计算到最新标签的距离，并且这个距离在构建机器上通常是单调递增的。像这样使用它

```
hg parents --template "{latesttag}+{latesttagdistance}-{node|short}" 
```

有关更多灵感，请参阅[Mercurial`setup.py`文件](http://selenic.com/hg/file/tip/setup.py)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-25T12:08:01.210

最好让构建系统将当前版本标识符插入到您的分发存档和/或文件名中。

第一个问题是，如何获取这个版本标识符。基本上有三种方式：

1.  通过让构建服务器发出`hg id`命令来找出构建错误。
2.  通过在 Mercurial 存储库配置中配置`version`一个由钩子填充的文件。`changegroup`
3.  通过拥有一个`version`使用关键字扩展名填充的文件。（不建议！）

第一种方法直接从 Mercurial 中提取信息，这对开发人员几乎不需要任何设置。缺点是它将构建系统与特定版本控制系统的存在紧密结合。

第二种方法保持独立于存储库系统，并且如果您从源存档构建，或者如果您想手动指定版本标签，它将保持可用。缺点是它确实需要你设置一个钩子，但是由于构建机器通常是专门配置的中央服务器，这应该不是一个大问题。

为了完整起见，我提到了第三种方法，但我认为普遍认为你真的想避免这种机制。

最好采用 1 和 2 的混合方法，首先尝试方法 2，然后在`version`找不到文件时使用方法 1。为了更好地支持`hg archive`源导出，您还可以检查`.hg_archival.txt`文件。

第二个问题是，您对内部版本号使用什么样的值：

1.  版本标识符（来自`hg id -i`）。
2.  本地修订号（来自`hg id -n`）。
3.  使用`latesttag`and的标识符`latesttagdistance`，请参阅 Martin 的答案。

第一个的优点是它相当简单并且唯一地标识了所构建的确切版本。虽然它不是很可读，并且不能从哈希中得出相对年龄。

第二个有一个递增的数字，但是这个数字仅适用于构建机器的存储库，因此您应该为开发人员提供一种方法来循环该数字以获取变更集哈希 id，否则它将毫无用处。

我个人特别喜欢的第三种方法，它使用标签和距离以非常易于阅读的方式提供时间信息，并另外指定确切修订的节点 ID。不过还是比较长的。

# authentication - ASP.NET MVC4 安全、身份验证和授权

> ID：10742709
> 
> 赞同：9
> 
> 时间：2012-05-24T17:48:24.360
> 
> 标签：authentication, security, asp.net-mvc-4

我正在使用 Visual Studio 2011 beta 开发一个新的 asp.net mvc4 项目，并试图了解整个安全问题。它是一个内部 Intranet 应用程序，最初将使用单点登录，因此（还）不会提示用户输入 Windows ID/密码。该公司有一个自定义应用程序，用于存储不同应用程序的角色，并可通过存储过程调用获得。它将获取用户的登录 ID 并返回某种包含角色的集合，例如“MyApp.Data”、“MyApp.User”、“MyApp.Admin”。所以这被称为 - 这是一个自定义成员资格提供程序，自定义角色提供者还是别的什么？

我一直在阅读有关授权、身份验证、成员资格、角色等的所有细节，目前我看不到树木的木材。我读过现有的 ASP.NET 安全对象已经过试验和测试，除非有非常复杂的要求，否则内置的就足够了，所以我很乐意使用已经存在的东西。

因此，如果用户已经登录到网络，这意味着他们已经过身份验证 - 对吗？如果是这样，那么我只需要实现授权。是否需要用 Authorize 属性来装饰每个 Controller 或 Action？如果是这样，如果我从自定义角色存储应用程序中检索角色，[Authorize(Roles = "ABC")] 的“ABC”部分如何设置？

我阅读了几篇文章和博客文章，包括 Jon Galloway 的这篇文章，但最后我迷路了：

[以正确的方式自定义身份验证和授权](http://weblogs.asp.net/jgalloway/archive/2012/05/04/asp-net-mvc-authentication-customizing-authentication-and-authorization-the-right-way.aspx)

这么多问题......如果有人知道所有这些如何联系在一起的良好高级描述，那么我会全神贯注:)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-28T18:37:47.270

好的，如果没有一个答案可以对所有这些是如何联系在一起的，我想我会草草写下我的发现：

*   该公司使用 Active Directory 来存储用户登录详细信息，因此它用于会员资格，我不需要自定义会员资格提供程序。一旦用户登录到公司网络，他们就会被验证。添加全局授权过滤器可确保访问系统的任何用户都需要进行身份验证。来自 Rick Anderson 在 msdn 上的最新信息：

    [http://blogs.msdn.com/b/rickandy/archive/2012/03/23/securing-your-asp-net-mvc-4-app-and-the-new-allowanonymous-attribute.aspx](http://blogs.msdn.com/b/rickandy/archive/2012/03/23/securing-your-asp-net-mvc-4-app-and-the-new-allowanonymous-attribute.aspx)

所以在 Global.asax 我要补充：

```
public static void RegisterGlobalFilters(GlobalFilterCollection filters)
{
    filters.Add(new HandleErrorAttribute());
    filters.Add(new System.Web.Mvc.AuthorizeAttribute()); //new
} 
```

*   一旦用户通过身份验证，我就需要处理授权。该公司有一个现有的全局数据存储，用于存储我没有更新访问权限的角色，只有读取访问权限，因此我可以通过存储的 proc 调用检索给定用户的角色。提出请求后，帮助台创建角色可能需要几天到几周的时间，因此最初将创建 2 个标准角色，用户和管理员，后续角色将存储在我们的应用程序数据库中.

*   除了这两个标准角色之外，还需要后续角色，例如超级用户等。这些角色将根据业务规则等具有各种权限，并且需要存储在我们的应用程序数据库中。因此，对于这种情况，我需要创建一个自定义角色提供程序，将适当的 asp.net 角色表添加到我的应用程序数据库中，并将其插入 web.config。这是一个名为“使用角色管理授权”的 ms 页面，我从中挑选了一些内容：

    [http://msdn.microsoft.com/en-us/library/9ab2fxh0.aspx](http://msdn.microsoft.com/en-us/library/9ab2fxh0.aspx)

*   到目前为止，我所阅读的自定义角色提供程序所需的唯一表是 Roles 和 UsersInRoles。

    创建表角色（角色名称文本（255）非空，应用程序名称文本（255）非空，约束 PKRoles 主键（角色名称，应用程序名称））

    CREATE TABLE UsersInRoles（用户名文本（255）非空，角色名文本（255）非空，应用程序名文本（255）非空，约束PKUsersInRoles主键（用户名，角色名，应用程序名））

*   设置完所有这些后，我需要弄清楚如何将全局数据存储中的 2 个标准角色（用户和管理员）与存储在我的应用程序数据库中的自定义角色合并，以及是否可以使用（例如）[Authorize(Roles= “管理员，超级用户”）] 在控制器/操作上，或者如果我需要继承 AuthoriseAttribute 并做一些更聪明的事情。

*   我刚刚意识到，当我使用 AD 进行身份验证时，我需要一种添加/注入当前用户所属角色集合的方法。因此，尽管我不需要任何自定义成员资格提供程序功能，但我仍然必须与 httpContext.User 交互以更新其 Roles 集合。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-25T02:22:55.353

如果您的身份验证已经由 Windows 处理（我猜是通过 Active Directory），那么您正在寻找的是一种将角色与用户匹配的授权机制。您拥有的一种选择是将用户角色成功加载到当前会话中。然后创建一个自定义授权属性，该属性将检查当前会话是否具有您正在使用的必要角色

```
[AttributeUsage(AttributeTargets.Class | AttributeTargets.Method, Inherited=true, AllowMultiple=true)]
public class CustomAuthorizationAttribute : AuthorizeAttribute
{
   protected override bool AuthorizeCore(HttpContextBase httpContext)
   {         
      IPrincipal user = httpContext.User;
      if (!user.Identity.IsAuthenticated)
      {
          return false;
      }

     //check your users against a database and return true or false
      return base.AuthorizeCore(httpContext);
   }
} 
```

然后你可以像这样使用属性

```
[CustomAuthorization]
public ActionResult SomeAction()
{
   return View();
} 
```

**更新**

AuthorizeCore 是用于检查是否应允许此用户访问相应的操作方法的方法。在此方法中，您可以根据您的数据库或存储角色的位置检查 httpContext.User.Identity.Name 属性。如果您通过 Active Directory 使用 Windows 身份验证，则 HttpContext.User.Identity 应该是[WindowsIdentity的一个实例](http://msdn.microsoft.com/en-us/library/system.security.principal.windowsidentity.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-19T15:23:58.170

与 RoleProvider 一起更新的 RolePrincipal 应该是获取与经过身份验证的用户关联的角色列表所需的全部内容。请记住，RolePrincipal 已经包含正确的 WindowsIdentity。

您不需要自定义 Authorize 属性。RolePrincipal/RoleProvider 将获取所需的角色并使用标准的 Authorize 属性。

看起来有点奇怪的是，您希望拥有应用程序特有的角色，但您说您还想要与来自单独公司商店的 Windows 用户相关联的角色。正如你所说，你想合并它们。这对我来说似乎不正确。您想在公司级别为您的应用程序管理角色，或者您想在本地级别管理它们。一般来说，你不会两者都做。

但是，如果这确实是您想要做的，那么您的 RoleProvider 听起来好像需要进行服务（例如 WCF）调用或 AD 调用以获取更多信息。也许windows用户所属的“组”的名称可以作为“角色”。然后，您将只过滤掉您的应用程序关心的那些组，并与您在本地角色数据库中找到的角色相结合。

收集完所有信息后，请确保指示 roleManager 将角色信息存储在 cookie 中。用户提出的每一个请求都经历了那个喧嚣是没有意义的。

# android - Android：以步行模式开始导航

> ID：10742710
> 
> 赞同：6
> 
> 时间：2012-05-24T17:48:27.440
> 
> 标签：android, android-intent, navigation

我正在尝试为导航启动 Intent：

```
startActivity(new Intent(Intent.ACTION_VIEW, Uri.parse("google.navigation:q=" + item.getPoint().getLatitudeE6()/1E6 + ","+item.getPoint().getLongitudeE6()/1E6))); 
```

这工作正常，但导航在驾驶模式下开始。如何在步行模式下启动导航？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-06-28T13:02:00.857

这应该可以正常工作：

```
Intent intent = new Intent(android.content.Intent.ACTION_VIEW, Uri.parse("google.navigation:q=your+address&mode=w"));
       startActivity(intent); 
```

问候。

# html - 主页中间框的设计问题

> ID：10742717
> 
> 赞同：0
> 
> 时间：2012-05-24T17:49:09.230
> 
> 标签：html, css

我的网站[http://www.gotskinsretail.com/Dev/index.php](http://www.gotskinsretail.com/Dev/index.php)有中间框的设计问题。当我们放大（ctrl--）时，在中间的框中（保持连接并获胜），文本进入下一行，因此不显示段落的最后一行。如果我增加了段落的高度，则在 div 后面的本段 coe 下共享图像。请帮助我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T17:56:10.660

将图片 div 的元素样式更改为`position:absolute;`并添加`bottom:0;`

这会将图像保留在容器底部，并且文本不会移动它。

# performance - 如何估计 Windows Azure 表存储查询性能？

> ID：10742719
> 
> 赞同：4
> 
> 时间：2012-05-24T17:49:09.623
> 
> 标签：performance, azure, azure-storage

我想评估我的 Windows Azure 表存储查询如何扩展。为此，我构建了一个简单的测试环境，我可以在其中增加表中的数据量，并测量查询的执行时间。并且基于时间，我想定义一个可用于评估未来查询性能的成本函数。

我评估了以下查询：

1.  使用 PartitionKey 和 RowKey 查询
2.  使用 PartitionKey 和属性进行查询
3.  使用 PartitionKey 和两个 RowKey 进行查询
4.  使用 PartitionKey 和两个属性进行查询

对于最后两个查询，我检查了以下两种模式：

1.  PartitionKey == "..." && (RowKey == "..." || RowKey == "...")
2.  (PartitionKey == "..." && RowKey == "...") || (PartitionKey == "..." && RowKey == "...")

为了最大限度地减少传输延迟，我在 Azure 实例上执行了测试。从测量中，我可以看到

*   查询 1（毫不奇怪，因为表是基于这些字段编制索引的）非常快，如果表中有大约 150000 个条目，则大约需要 10-15 毫秒。
*   查询 2 需要进行分区扫描，因此执行时间随着存储的数据线性增加。
*   查询 3.1 的执行几乎与查询 2 完全相同。因此，此查询也执行全分区扫描，这对我来说似乎有点奇怪。
*   查询 4.1 比查询 3.1 慢两倍多一点。所以看起来它是通过两次分区扫描来评估的。
*   最后，查询 3.2 和 4.2 的执行速度几乎比查询 2 慢 4 倍。

你能解释一下查询/过滤器解释器的内部结构吗？即使我们接受查询 3.1 需要分区扫描，查询 4.1 也可以使用相同的逻辑（并且在同一时间）进行评估。查询 3.2 和 4.2 对我来说似乎是个谜。对这些有任何指示吗？

显然，这一点的重点是我想在一个查询中查询不同的元素，以最小化成本同时不损失性能。但似乎对每个元素使用单独的查询（使用任务并行库）是唯一真正快速的解决方案。这样做的公认方式是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T06:27:59.847

对于 3.2 和 4.2 之类的查询，将与属性一一进行全分区扫描。即使这些分区在两台不同的机器上，查询也不会并行运行，这就是为什么你会看到这么长的执行时间。这是因为 Windows Azure 没有对查询进行查询优化。以一种可以并行运行的方式编写代码是代码责任。

You are right if you want to have faster performance, you would nee to run the query in parallel using Task Parallel Libraries to achieve higher performance.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T09:17:45.957

由于表存储内部实现的细节是非公开的，如果你想评估未来查询的性能，我建议你查看 [http://blogs.msdn.com/b/windowsazurestorage/archive/2010/ 11/06/how-to-get-most-out-of-windows-azure-tables.aspx](http://blogs.msdn.com/b/windowsazurestorage/archive/2010/11/06/how-to-get-most-out-of-windows-azure-tables.aspx)了解一些最佳实践。

最好的祝福，

明旭。

# ajax - 如何使用图形 api ajax 调用获取#facebook 评论

> ID：10742722
> 
> 赞同：1
> 
> 时间：2012-05-24T17:49:34.130
> 
> 标签：ajax, facebook, json

```
var url = 'https://graph.facebook.com/?ids=http://www.stackoverflow.com';

$.getJSON(url, function(resp) {
  $("p").html('comments = ' + resp.comments);
}); 
```

这会将以下 html 放入我的`<p>`:`comments = undefined`

我从调用中得到的返回字符串是这样的：

```
{
   "http://www.thinlinebetween.com/tuesday-quote-of-the-day-jean-ingelow/": {
      "id": "http://www.thinlinebetween.com/tuesday-quote-of-the-day-jean-ingelow/",
      "shares": 2,
      "comments": 1
   }
} 
```

我需要做类似的事情`resp."http://www.thinlinebetween.com/tuesday-quote-of-the-day-jean-ingelow/".comments`来获得价值吗？返回的 json 不容易解析。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T18:06:40.733

```
var postUrl = 'http://www.stackoverflow.com';
var apiUrl = 'https://graph.facebook.com/?ids=' + postUrl;

$.getJSON(apiUrl, function(resp) {
  $("p").html('comments = ' + resp[postUrl].comments);
}); 
```

需要做的`resp["http://www.stackoverflow.com"].comments`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T18:46:40.993

应该是这样的

```
$(function(){ 
        var webUrl = 'http://www.stackoverflow.com';
        var endpoint = 'https://graph.facebook.com';
        $.getJSON(endpoint,{'ids':webUrl},function(response){
            var comments = response[webUrl].comments;
              $("p").html('comments = ' + comments);
        })
    }); 
```

# markdown - Linux 中 Markdown.pl 的位置

> ID：10742723
> 
> 赞同：0
> 
> 时间：2012-05-24T17:49:37.843
> 
> 标签：markdown

我应该把 Markdown.pl 放在哪里让 shell 在我使用时可以识别它

```
perl Markdown --html4tags filename.md > filename.html 
```

在 Linux 中，例如 Red Hat Enterprise 6

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T17:54:15.830

可能最好的地方是`/usr/local/bin`。确保这是你`PATH`的课程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T18:07:09.720

您可以将它放在 PATH 可以读取的任何位置。然后，您可以这样称呼它：

```
Markdown.pl --html4tags filename.md > filename.html 
```

# c++ - 如何确定哪些库是动态加载的？

> ID：10742725
> 
> 赞同：0
> 
> 时间：2012-05-24T17:49:46.390
> 
> 标签：c++, windows, gdb

我的程序在 gdb 下给出了这个错误：`During startup program exited with code 0xc0000135.`我在`main`, `__main`, `__getmainargs`,处放置了一个断点`_imp____getmainargs`，`mainCRTStartup`但是在抛出错误之前它们都没有被命中。我做了一点谷歌搜索，发现错误来自失败的`LoadLibrary`调用（显然，我没有调用）。

所以我的问题是如何确定它试图加载哪个库？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T18:05:11.777

我会使用[Dependency Walker](http://www.dependencywalker.com/) 这是一个非常棒的工具，我在调试加载的库时经常使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T18:02:30.797

双击`exe`，应该会触发一个异常，显示缺少的库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T17:59:09.077

您可以尝试在[Process Explorer](http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx)下运行您的程序。即使程序无法启动，它也应该能够告诉您加载了什么。

# html - 基本 HTML - 应用 div id

> ID：10742726
> 
> 赞同：0
> 
> 时间：2012-05-24T17:49:52.463
> 
> 标签：html, ios, uiwebview

```
 NSString *HTML = [NSString stringWithFormat:@"<html> \n"
                      "<head> \n"
                       "<meta name=\"viewport\" content=\"width=device-width; initial-scale=1.0; maximum-scale=1.0;\">"
                      "<div id='main' style type=\"text/css\"> \n"
                      "body {font-family: \"%@\"; font-size: %@; color:rgb(30,30,30); line-height: %ipx;}\n"
                      "</div> \n"
                      "</head> \n"
                      "<body>%@</body> \n"
                      "</html>", @"helvetica", [NSNumber numberWithInt:[UIFont mainTextFont].pointSize], kWebViewLineSpacing, text]; 
```

我正在尝试将 div id`main`应用于我的内容，但我不知道如何让它工作。我认为有问题的行是：“`<div id='main' style type=\"text/css\"> \n"`但我不确定如何调整它以使其工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T17:53:47.360

你把一个 div 放在 head 部分，那是行不通的

```
NSString *HTML = [NSString stringWithFormat:@"<html> \n"
                  "<head> \n"
                   "<meta name=\"viewport\" content=\"width=device-width; initial-scale=1.0; maximum-scale=1.0;\">"
                  "<style type=\"text/css\"> \n"
                  "body {font-family: \"%@\"; font-size: %@; color:rgb(30,30,30); line-height: %ipx; -webkit-transform: translate3d(0,0,0); word-wrap: break-word; -webkit-hyphens: auto; hyphens: auto; text-overflow: ellipsis; -webkit-text-size-adjust: none; overflow: hidden;}\n"
                  "</style> \n"
                  "</head> \n"
                  "<body><div id=\"main\">My main div</div></body> \n"
                  "</html>", @"helvetica", [NSNumber numberWithInt:[UIFont mainTextFont].pointSize], kWebViewLineSpacing, text]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-24T17:54:39.077

你把东西混合在一起，你想要更像的东西

```
[NSString stringWithFormat:@"<html> \n"
                      "<head> \n"
                       "<meta name=\"viewport\" content=\"width=device-width; initial-scale=1.0; maximum-scale=1.0;\">"
                      "<style type=\"text/css\"> \n"
                      "body {font-family: \"%@\"; font-size: %@; color:rgb(30,30,30); line-height: %ipx;}\n"
                      "</style> \n"
                      "</head> \n"
                      "<body><div id='main'>%@</div></body> \n"
                      "</html>", @"helvetica", [NSNumber numberWithInt:[UIFont mainTextFont].pointSize], kWebViewLineSpacing, text]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T17:54:23.770

那条线没有任何意义。我相信你的意思是：

```
"<div id='main'><style type=\"text/css\"> \n" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-24T17:53:50.400

div 作为 head 的子级无效。它应该是身体的孩子

# windows-server-2008 - 为 100 名员工设计本地 Intranet... 我有自己的服务器，XAMPP 是否合适？

> ID：10742728
> 
> 赞同：0
> 
> 时间：2012-05-24T17:50:00.077
> 
> 标签：windows-server-2008, xampp, intranet

非常简单... 我刚刚设置了一个 Windows Server 2008 r2 虚拟机，它将托管我们公司的 Intranet。我在本地使用 XAMPP，但想知道在这个新的生产服务器上使用 XAMPP 是否会导致任何问题。

当然，我可以自己安装每一个，但 XAMPP 让一切变得如此简单，因为任何可以访问我们网络的人都可以严格查看它（仅限内部）......有什么害处......如果有的话？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T17:56:06.883

使这些捆绑包很棒的原因是它们做了很多假设，从而节省了开发过程中的时间。这也是使包不适合托管生产实例的原因。开箱即用的配置可能会影响安全性和性能，因此了解 Apache、PHP 和 MySQL 的配置选项很重要，即使这需要一些时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T18:01:43.183

考虑到[XAMPP 理念](http://www.apachefriends.org/en/xampp.html#300)：

> XAMPP 背后的理念是为开发人员构建一个易于安装的发行版以进入 Apache 的世界。为了方便开发人员，XAMPP 配置为启用了所有功能。从安全的角度来看，默认配置并不好，并且对于生产环境来说不够安全 - 请不要在这样的环境中使用 XAMPP。

我想说在生产服务器上安装 XAMPP 不是一个好主意，因为所有功能都已打开，并且默认配置设置为由本地服务器使用。

在本地服务器上使用 XAMPP 几乎不会有任何问题，因为它只是安装/配置 Mysql、Php、Perl 和 Apache 的一种简单方法。但是你必须确定你需要在你的配置文件中为开发服务器打开什么。

您应该在之前验证 XAMPP 配置。

但是从 LAMPP 0.9.5 开始，可以通过调用 »/opt/lampp/lampp security« 来保护 XAMPP 安装。

我从来没有测试过这个安全的安装。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-24T18:03:05.163

好吧，XAMPP 只是一个为您设置 AMP（Apache、MySQL、PHP）环境的软件。只要您知道自己在做什么，就不会在设置方面遇到任何问题，也就是说，您应该能够配置 Apache、MySQL 和 PHP 以满足您的需求。但通常，XAMPP 提供的默认设置可以正常工作。

# kohana - Kohana 3.2 安装下载。应用程序文件夹中的views文件夹在哪里？

> ID：10742729
> 
> 赞同：0
> 
> 时间：2012-05-24T17:50:04.147
> 
> 标签：kohana

Kohana 3.2 安装包是从官网下载的。应用程序文件夹中的views文件夹在哪里？我在应用程序文件夹中看到的唯一文件夹是 classess 文件夹。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T05:13:54.413

**Kohana**不需要您使用`APPPATH/views`文件夹。例如，您可以在模块中创建视图。因此，安装包不包含空文件夹，例如`classes/controller`. 如果要在`APPPATH/views`文件夹中存储视图，只需创建它。

# flash - 从本地 Flash 文件收集和传输数据

> ID：10742730
> 
> 赞同：1
> 
> 时间：2012-05-24T17:50:08.883
> 
> 标签：flash, actionscript, shared-objects

我继承了一个大型 Flash 脚本（用 AS2 编写），它运行实验并使用`SharedObject`框架保存数据。该脚本将提供给用户在他们的本地机器上运行，可能在 USB 驱动器或 CD 上。将本地存储的内容传输`SharedObject`到此 USB 驱动器或以电子方式发送的最简单方法是什么？是否可以将其存储`SharedObject`在与 swf 文件相同的位置（例如，在 USB 驱动器上？）我看到使用 PHP 连接闪存是可能的，但是是否有一种纯粹的闪存方式通过电子邮件、ftp 或服务器的另一个协议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T18:44:30.690

我会避免尝试使用包含 SharedObject 数据的文件。即使您将这些文件复制到 USB 驱动器，您也必须编写一个知道如何打开每个文件并取出数据的应用程序。SharedObject 数据是特定于用户的，因此不清楚后面的过程将如何工作。

不幸的是，我对 AS2 中的编程一无所知——只有 AS3。

大多数情况下，在 Actionscript 中使用 HTTP 将数据发送到服务器。还有其他方法，但这显然是最直接的手段。

如果您在 AS3 中进行编程，您可以一起使用 URLLoader、URLRequest、URLVariables 类对服务器执行 HTTP POST 或 GET。

这是我在使用 AS2 进行 HTTP POST/GET 时发现的一些链接：

*   [使用 ActionScript 2.0 POST 登录](https://stackoverflow.com/questions/231693/post-login-with-actionscript-2-0)
*   [http://www.flash-here.com/tutorials/flash_loadvars_sample.html](http://www.flash-here.com/tutorials/flash_loadvars_sample.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T22:22:40.477

您可以使用该方法将文件保存到 ActionScript 2.0 中的本地文件系统[`FileReference.save()`](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/net/FileReference.html?filter_flash=cs5&filter_flashplayer=10.2&filter_air=2.6)。这将打开一个对话框，允许用户将文件保存到他们选择的位置。您可以自由选择最适合输出数据的格式。

# python - 更改默认python路径

> ID：10742731
> 
> 赞同：0
> 
> 时间：2012-05-24T17:50:12.177
> 
> 标签：python

我有两个python安装。一个安装在默认位置，另一个安装在我的主目录中。我正在使用主目录python安装。我面临关于 pythonpath 的问题。当我在第二次 python 安装上运行 sys.path 时，它为我提供了默认 python 安装库的路径

例如。

现在安装了第二个python，`/home/python2.6.1` 当我使用`sys.path`它时它给了我

`/lib/python2.6/lib-old, /lib/python2.6/lib-dynload`等等

代替

```
/home/python2.6.1/lib/python2.6/lib-old, /home/python2.6.1/lib/python2.6/lib-dynload 
```

如何在主目录中更改我的 python 安装路径

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T17:58:01.883

这是因为您的库安装在 /lib 中，或者解释器已配置为扫描 /lib 以查找库。您需要重新编译 Python 并为配置脚本赋予库的另一个前缀。

但是，这不是我会做的。我会安装 virtualenv 并开始以这种方式管理我的 Python 版本。这就是我实际所做的；）干净简单！

# jquery - 在 jQuery 中调用具有两个类的 div

> ID：10742737
> 
> 赞同：0
> 
> 时间：2012-05-24T17:50:32.967
> 
> 标签：jquery, css, class

我有一个 div 有两个类：

```
<div class="content pager" style="width: 1156px; float: left; list-style: none outside none;"></div> 
```

我想用 jQuery 改变元素样式：

```
$(".content pager").width(0);  //Change the element style width 
```

但它不起作用。它有什么问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-24T17:51:10.523

试试这个：

```
$(".content.pager").width(0); 
```

检查**[jQuery 的](http://en.wikipedia.org/wiki/JQuery)** [**类选择器**](http://api.jquery.com/class-selector/)。

`width(0)`不会隐藏其内容。你需要`hide`它。而不是`width(0)`. 所以，你可以试试这个：

```
$(".content.pager").hide(0); // Will hide the div and free its space.
$(".content.pager").css('visibility', 'hidden'); // Will hide the div and take space belongs to it. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T18:07:09.977

另一种选择是 jQuery 的[.filter](http://api.jquery.com/filter/)方法。基本上，您搜索一个类，然后按另一个过滤选择。不过，对于您的特殊需求， $(".class1.class2") 应该就足够了。.filter 示例：

```
<div class="foo bar">div1</div>
<div class="foo">div2</div>
<div class="bar">div3</div>
​
$(".foo").filter(".bar").css('background-color', 'red');​ 
```

见[小提琴](http://jsfiddle.net/ZPBZ3/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T17:54:43.397

试试这个：

```
$(".content").filter(".pager").width(0); 
```

但是[codeparadox 的解决方案](https://stackoverflow.com/questions/10742737/calling-a-div-with-two-classes-in-jquery/10742745#10742745)也应该有效。

# ssas - 如何在 ssas 中使用更改脚本进行部署

> ID：10742738
> 
> 赞同：4
> 
> 时间：2012-05-24T17:50:34.543
> 
> 标签：ssas

如果我在开发服务器 SSMS 的分析服务中的整个数据库上创建更改脚本并在生产服务器 SSMS 上执行该脚本而不是通过 BIDS 部署，有什么问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T20:56:42.610

不，您实际上不应该使用 BIDS 来部署到 prod。BIDS 将始终覆盖目标服务器的管理设置（安全和分区）。

最好的选择是使用部署向导。它使您能够生成更新多维数据集和维度结构的增量部署脚本。可以自定义角色和分区的处理方式。它使用通过在 BIDS 中构建 SSAS 生成的 XML 输出文件作为输入文件，您可以在多种模式下运行：

*   静默模式 (/s)：以静默模式运行实用程序，并且不显示任何对话框。
*   应答文件模式 (/a)：不部署。只修改输入文件。
*   输出模式（/o）：不显示用户界面。生成将发送到部署目标的 XMLA 脚本。不会发生部署。

如果你想要一个完整的同步，你可以使用“同步数据库向导”。它几乎克隆了一个数据库。当目标数据库已经存在时，执行元数据同步和增量数据同步。当目标数据库不存在时，会进行完整部署和数据同步。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T09:28:35.650

我认为编写整个数据库脚本的主要缺点是所有内容都可能被重新处理。此外，如果另一个团队或团队成员负责部署脚本，那么审查和理解是否每次更新都会重建所有内容可能会更加困难。

我在 Red Gate 工作，我们最近推出了一个名为 SSAS Compare 的免费工具来帮助管理这个场景。它可以帮助您创建一个仅包含您要部署的更改的脚本

# python - Python插件安装说明看不懂，谁能解释一下？

> ID：10742742
> 
> 赞同：0
> 
> 时间：2012-05-24T17:51:01.497
> 
> 标签：python

我正在尝试为 Trac 安装 python 插件。

作为一个菜鸟，我不太明白指令......

有人可以解释一下吗？

```
$> svn co https://www.coderesort.com/svn/open/trac-talkplugin/trunk tractalk-trunk
$> cd tractalk-trunk
$> python setup.py install # or 'bdist_egg' or 'develop' 
```

从 SVN 结帐 - 完成

cd tractalk-trunk - 完成

**我被安装程序困住了。**

我应该完全按照它的编写方式运行它吗？

或者只是 python setup.py install ？

小心解释这个命令发生了什么？

据我了解 # 表示该部分被忽略？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T17:55:41.970

该命令行调用包中包含[的安装程序。](http://docs.python.org/install/index.html)之后的所有`#`内容都是注释，不会影响 shell，所以你不需要写出来。

# go - 使用反射获取函数名称

> ID：10742749
> 
> 赞同：23
> 
> 时间：2012-05-24T17:51:32.320
> 
> 标签：go, reflection, go-reflect

我正在尝试使用 Go 的反射系统来检索函数的名称，但是在调用其类型的 Name 方法时得到一个空字符串。这是预期的行为吗？

这是我如何解决问题的一个简单示例：

```
package main

import "fmt"
import "reflect"

func main() {
    typ := reflect.TypeOf(main)
    name := typ.Name()
    fmt.Println("Name of function" + name)
} 
```

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-05-24T18:04:34.760

解决方案是使用[FuncForPc](http://golang.org/pkg/runtime/#FuncForPC)返回一个`*Func`.

这返回`"main.main"`：

```
package main

import "fmt"
import "reflect"
import "runtime"

func main() {
    name := runtime.FuncForPC(reflect.ValueOf(main).Pointer()).Name()
    fmt.Println("Name of function : " + name)
} 
```

如果需要`"main"`，只需对其进行标记。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2012-05-24T19:08:33.777

```
package main

import "fmt"
import "runtime"

func main() {
    pc, _, _, _ := runtime.Caller(0)
    fmt.Println("Name of function: " + runtime.FuncForPC(pc).Name())
    fmt.Println()

    // or, define a function for it
    fmt.Println("Name of function: " + funcName())
    x()
}

func funcName() string {
    pc, _, _, _ := runtime.Caller(1)
    return runtime.FuncForPC(pc).Name()
}

func x() {
    fmt.Println("Name of function: " + funcName())
    y()
}

func y() {
    fmt.Println("Name of function: " + funcName())
    z()
}
func z() {
    fmt.Println("Name of function: " + funcName())
} 
```

输出：

> 函数名称：main.main
> 
> 函数名：main.main
> 函数名：main.x
> 函数名：main.y
> 函数名：main.z

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-01-16T09:00:22.980

```
import runtime

func funcName() string {
    pc, _, _, _ := runtime.Caller(1)
    nameFull := runtime.FuncForPC(pc).Name()    // main.foo
    nameEnd := filepath.Ext(nameFull)           // .foo
    name := strings.TrimPrefix(nameEnd, ".")    // foo
    return name
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-10-22T16:24:37.283

这是一个经过测试的生产就绪实用程序函数，用于返回函数名称。

注 1：我们正在处理来自 nil 指针的可能性`FuncForPC`

注 2： optFuncLevel 只是*堆栈帧*级别的友好名称。这使我们可以灵活地在另一层实用函数中使用它。say 的直接调用`main`只会传递 1（或者默认情况下什么都不传递），但是如果我在调用`FunctionName`日志丰富函数，比如`PrettyLog()`从常规代码调用，我会像`FunctionName(2)`在 PrettyLog 的调用中那样调用它，所以函数名称返回的是 PrettyLog 调用者的名字，而不是 PrettyLog 本身。

```
// FunctionName returns the function name of the caller
// optFuncLevel passes the function level to go back up.
// The default is 1, referring to the caller of this function
func FunctionName(optFuncLevel ...int) (funcName string) {
    frameLevel := 1 // default to the caller's frame
    if len(optFuncLevel) > 0 {
        frameLevel = optFuncLevel[0]
    }

    if pc, _, _, ok := runtime.Caller(frameLevel); ok {
        fPtr := runtime.FuncForPC(pc)
        if fPtr == nil {
            return
        }
        // Shorten full function name a bit
        farr := strings.SplitN(fPtr.Name(), "/", 2)
        if len(farr) < 2 {
            return
        }
        return farr[1]
    }

    return
} 
```

# android - 如何使应用程序将信息提交到网络表单

> ID：10742750
> 
> 赞同：0
> 
> 时间：2012-05-24T17:51:41.587
> 
> 标签：android, web-services

我正在尝试编写一个 android 应用程序来帮助人们在 craiglist、ebay 等多个网站上进行更轻松的搜索，但我不确定真正从哪里开始，或者我将使用的技术的名称。为了使问题更准确，这些网站都是基于您发布内容或通过搜索检索内容的形式。我怎样才能让我的 android 应用程序真正在其中向用户询问项目名称（我知道的那部分），然后将项目名称发送到 craiglist 以便它返回结果？

当我在任何网站上单击搜索并使用带有字符串操作的相同链接以包含所需内容时，我正在考虑复制我的浏览器上显示的 url。这个对吗？我知道其他任何想法吗？我有点到处都是，但我需要一个起点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T22:27:34.143

某些站点可能会公开一个公共 API 供您连接，但这是特定于站点的。

不公开此类系统的站点可能会被“抓取”，这意味着您正在使用字符串操作（如您所提到的）来解析您所追求的数据。

这两种方法都需要有关如何执行 HTTP 操作的基本知识，有几种方法可以做到这一点，但最简单的方法是使用 HttpURLConnection 类，如网络上的各种教程中所述。

谷歌搜索“android http GET POST 教程”应该为您指明正确的方式来开始您的冒险:)

# mysql - MySQL在小数点后转换丢失数字的子字符串

> ID：10742751
> 
> 赞同：1
> 
> 时间：2012-05-24T17:51:48.777
> 
> 标签：mysql, regex, substring

我正在运行以下查询：

```
SELECT
    SUBSTRING(pluginText,LOCATE('cvss', pluginText), 21) AS CVSS_Base_Score_Text,
    CONVERT(SUBSTRING_INDEX(SUBSTRING(pluginText,
        LOCATE('cvss', pluginText), 21),' : ',-1),UNSIGNED INTEGER)
    AS CVSS_Base_Score_Number
FROM vulnerabilities_internal
WHERE LCASE(pluginText) REGEXP '.*cvss.*' 
```

它返回 2 列

```
CVSS_Base_Score_Text         CVSS_Base_Score Number
CVSS Base Score: 4.3         4 
```

如何修改此查询，使 CVSS_Base_Score_Number 列中的数字带入小数点并显示为 4.3 ？

回答了我自己的问题：

```
SELECT
SUBSTRING(pluginText,LOCATE('cvss', pluginText), 21) AS CVSS_Base_Score_Text,
CONVERT(SUBSTRING_INDEX(SUBSTRING(pluginText,LOCATE('cvss', pluginText), 21),' : ',  
-1), 
DECIMAL(10,1)) AS CVSS_Base_Score_Number
FROM vulnerabilities_internal 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T20:26:56.650

下面是查询，它会给你想要的结果。

```
SELECT
    SUBSTRING(pluginText,LOCATE('cvss', pluginText), 21) AS CVSS_Base_Score_Text,
    CAST(SUBSTRING_INDEX(SUBSTRING(pluginText,
        LOCATE('cvss', pluginText), 21),' : ',-1) as decimal(2,1))
    AS CVSS_Base_Score_Number
FROM vulnerabilities_internal
WHERE LCASE(pluginText) REGEXP '.*cvss.*' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T00:20:36.103

```
SELECT 
SUBSTRING(pluginText,LOCATE('cvss', pluginText), 21) AS CVSS_Base_Score_Text, 
CONVERT(SUBSTRING_INDEX(SUBSTRING(pluginText,LOCATE('cvss', pluginText), 21),' : ',   
-1),  
DECIMAL(10,1)) AS CVSS_Base_Score_Number 
FROM vulnerabilities_internal 
```

# flex-monkey - 输入不启用按钮

> ID：10742752
> 
> 赞同：2
> 
> 时间：2012-05-24T17:51:48.830
> 
> 标签：flex-monkey

在我的应用程序中，用户必须在密码文本输入中输入至少一个字符才能启用登录按钮。

如果我使用 FlexMonkey 记录事件，我会看到：

SelectedText：'password' (0,0) 输入：'password' (myPassword)

但是当我从 FlexMonkey 运行它时，该按钮没有启用。这里发生了什么？

任何有用的线索将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T08:08:59.020

Flex Monkey 可能不会与 UI 交互或触发 UI 事件

对我来说，我总是使用文本更改事件来捕捉这类事情。

# tomcat - 是否可以在嵌入式 Tomcat 7 中启用 JMX？

> ID：10742762
> 
> 赞同：3
> 
> 时间：2012-05-24T17:52:12.023
> 
> 标签：tomcat, tomcat7, jmx

我想从我的 web 应用程序中访问`Server`和s。`Connector`此外，我需要从嵌入式 Tomcat 启动这个 webapp。这是我启动tomcat的方式：

```
Tomcat tomcat = new Tomcat();
tomcat.setPort(port);
StandardServer server = (StandardServer) tomcat.getServer();
server.addLifecycleListener(new AprLifecycleListener());
tomcat.addWebapp("/", webapp.getAbsolutePath());
tomcat.start();
tomcat.getServer().await(); 
```

当我使用[典型示例通过 JMX](https://stackoverflow.com/a/7968752/207161) [1](https://stackoverflow.com/a/7968752/207161)访问服务器时：

```
import javax.management.*;
import org.apache.catalina.Server;

MBeanServer mBeanServer = MBeanServerFactory.findMBeanServer(null).get(0);
ObjectName name = new ObjectName("Catalina", "type", "Server");
Server server = (Server) mBeanServer.getAttribute(name, "managedResource"); 
```

我得到：

```
Caused by: javax.management.InstanceNotFoundException: Catalina:type=Server
at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.getMBean(DefaultMBeanServerInterceptor.java:1094)
at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.getAttribute(DefaultMBeanServerInterceptor.java:662)
at com.sun.jmx.mbeanserver.JmxMBeanServer.getAttribute(JmxMBeanServer.java:638) 
```

我认为这是因为我无法以某种方式引导 JMX。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T18:04:07.097

看起来 JMX 运行良好，问题在于我用于查找的名称。本来应该：

```
ObjectName name = new ObjectName("Tomcat", "type", "Server"); 
```

反而。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-10-01T05:52:56.177

可以通过使用`PR_JVMOPTIONS`. 我通过在嵌入式 tomcat 安装服务文件中使用以下配置参数解决了这个问题。

```
set PR_JVMOPTIONS=-Dcom.sun.management.jmxremote.authenticate=false;-Dcom.sun.management.jmxremote.ssl=false;-Dcom.sun.management.jmxremote.port=9111 
```

# java - 命令行中的元字符

> ID：10742763
> 
> 赞同：1
> 
> 时间：2012-05-24T17:52:20.053
> 
> 标签：java, regex, string, command-line-arguments

编码：

`String s = "\d";`

引发编译器错误，非法转义字符。好的了解了！！

但是代码：

```
class Test
{
public static void main(String[] args)
{
String s = args[0];
System.out.println(s);
}
} 
```

`java Test \d`使用命令或调用时不会`java Test "\d"`。为什么？？

事实上它甚至可以打印：`\d`不使用双反斜杠（“\\d”）。

通过命令行提供的参数不是仅被视为字符串吗？

我知道它不能引发*编译器错误*，因为命令行提供的参数是*在*编译阶段之后，但它不应该引发*运行时异常*或其他什么吗？

还是一旦我们通过了编译阶段，String 包含什么就无关紧要了（因为代码被转换成字节码并且整个代码结构都被改变了）？如果是，那么有人可以详细说明。

提前谢谢！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T17:58:42.693

加倍反斜杠只是语法问题。在 Java 代码中，要在引号内表示单个反斜杠，您必须键入两次。但是，您真正代表的是一个反斜杠。

当您通过命令行传递它时，您不需要转义，因为它不是 Java 代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T18:09:44.313

您没有意识到 shell 命令行和 Java 是两种不同的语言。给 shell 的命令行被解析为 shell 命令。给定的 Java 程序`java`被解析为 Java。

您可能还会混淆*字符串文字*（产生字符串的代码段）和*字符串*（由字符序列组成的值）。

您希望将两个*字符串* `\d`存储在 variable 中`s`。您需要构造一个适当的*字符串文字*才能做到这一点。

*   要生成两个字符串`\d`，可以使用 cmd (Windows shell) 字符串文字`\d`。
*   要生成两个字符串`\d`，可以使用 Java 字符串文字`"\\d"`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T18:01:00.237

> 通过命令行提供的参数不是仅被视为字符串吗？

是的，它们是字符串。字符串*对象*。没关系。

但是，在*代码*中，您有字符串*文字*。这些由 Java 编译器解析以在执行时生成 String*对象*。转义是 Java 语言的一部分，*而不是*String 对象的一部分。

（请注意，其他一些库 - 特别是正则表达式 - 也可能*有*自己的转义机制，但基本上如果你运行

```
java Foo \d 
```

然后假设你的*shell*没有做任何有趣的事情（这将取决于那个 shell！）然后你最终得到一个两个字符串：一个反斜杠，后跟一个`d`.

# ubuntu-10.04 - 将 rlwrap 与 ssh 会话一起使用

> ID：10742767
> 
> 赞同：0
> 
> 时间：2012-05-24T17:52:33.567
> 
> 标签：ubuntu-10.04, rlwrap

我正在使用 SSH 登录到 ubuntu 服务器。但是，我无法使用选项卡自动完成等命令或使用箭头键查看以前的历史记录。我已经在远程机器和本地目录上安装了 rlwrap。我想知道是否有任何方法可以使用 rlwrap 让我在服务器（或其他东西）上使用这些快捷方式。该服务器正在运行 Ubuntu Server 版本 10.0.4。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T07:45:32.430

检查远程服务器上的 shell，如果不是，请将其更改为 /bin/bash

```
 chsh /bin/bash 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T07:06:03.177

我很难理解您的问题（例如，您在远程服务器上运行什么命令？您的本地目录是什么以及如何在其上安装 rlwrap？。您的登录 shell 的输入历史记录是否正常工作？）

一般来说：

*   如果交互式命令没有可用的（通过箭头键）输入历史记录，`rlwrap`请在命令名称前键入。例如：`rlwrap sqlplus`而不仅仅是`sqlplus`
*   如果您根本无法使用箭头键*，*即使在您的登录 shell 中，您的安装也有问题。在这种情况下，您必须请求远程机器的系统管理员来帮助您。您可以从*本地*`rlwrap ssh remote.host`计算机上的 shell 提示符运行作为权宜之计

# php - ezpdf中的while循环

> ID：10742770
> 
> 赞同：0
> 
> 时间：2012-05-24T17:52:47.157
> 
> 标签：php

我在使用 ezpdf 时遇到问题。它适用于记录集的第一行，但是我无法在 ezpdf 中获取记录集的所有行。似乎 ezpdf 在第一条记录之后以某种方式结束工作，并且无论如何都只是创建 pdf 文件。

这就是我正在做的事情。

从交易表中获取订单详细信息并根据订单中的数量生成票证。因此，假设它有 3 张票要按订单生成，pdf 只会生成第一行的票。它不累积第 2 行和第 3 行的数据。

这是我的代码。 [http://pastebin.com/DMaZUpqw](http://pastebin.com/DMaZUpqw)

请帮忙。

谢谢阿里

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T17:09:07.637

好吧，如果我理解正确，它应该将这些票中的多张打印到 pdf 文档上。为什么这一行被注释掉了？：

```
#$pdfid = $pdf->newPage(1, $pdfid, 'after'); 
```

在继续在那里打印东西之前，您不必添加另一页吗？

如果 $RowsTkt 实际上返回了多行，那就没办法了，它只迭代一次。您是否检查过（通过转储索引等）循环实际上并没有像您暗示的那样执行三次？

问候斯特凡

# excel - 来自不同工作表的具有四分位数函数的 Excel 数组

> ID：10742771
> 
> 赞同：3
> 
> 时间：2012-05-24T17:52:50.803
> 
> 标签：excel, excel-formula

我正在尝试计算我在几个不同工作表中拥有的一组值的第一个和第三个四分位数值。我现在使用的公式是

```
QUARTILE((C15,'Week 05-13 to 05-19'!C15,'Week 05-06 to 05-12'!C15,'week 04-29 to 05-04'!C15), 1) 
```

其中“05-13 至 05-19 周”、“05-06 至 05-12 周”和“04-29 至 05-04 周”是不同的工作表，“C15”是指当前工作表上的单元格 C15 .

这在我计算 MAX、MIN 和 MEDIAN 时效果很好，但现在尝试计算 QUARTILE，我得到一个“#VALUE！” 即使我知道所有的值都是数字也会出错，因为它适用于 MAX、MIN 和 MEDIAN。

我觉得我的数组语法搞砸了，这就是导致我出现问题的原因，但我似乎无法弄清楚。谢谢你的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T18:07:13.993

您不能在不同的工作表上使用多范围语法。如果您的工作表是连续的，您可以尝试输入 3D 参考作为第一个参数，方法是直接输入如下，或者选择一个工作表上的一个单元格，然后选择另一个带有 shift 的选项卡。

```
=QUARTILE('week 04-29 to 05-04:Week 05-20 to 05-26'!C15, 1) 
```

# javascript - 需要帮助只需验证字段是否仅为文本

> ID：10742778
> 
> 赞同：0
> 
> 时间：2012-05-24T17:53:21.307
> 
> 标签：javascript

现在我有（这是来自另一个已经完成的功能）

```
function validatelength() {
    var length = parseInt(document.getElementById("length").value, 10);
    var lengthError = document.getElementById("lengthError");
    if (isNaN(length) || length < 50 || length > 220) {
        lengthError.innerHTML = ">>Please enter your height<<";
        return false;
    } else {
        lengthError.innerHTML = "";
    }
    return true;
} 
```

这是我的小代码，用于检查该字段是否真的包含一个人的长度。

现在对于文本字段（名称/前名/注释）我也想要这个到目前为止我有

```
function validatetext() {
    var text = parseInt(document.getElementById("text").value, 10);
    var textError = document.getElementById("textError");
    if (isNaN(text) || text < 50 || text > 220) {
        textError.innerHTML = ">>Please enter text only<<";
        return false;
    } else {
        textError.innerHTML = "";
    }
    return true;
} 
```

谁能帮我完成这个功能？谢谢顺便说一句：我不能使用 jquery。（不被允许）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T17:59:45.200

使用正则表达式确保值中只出现字母。

就像是

`/^[A-Za-z]*$/`

应该管用。那个正则表达式说

“匹配 AZ 和 az 中的任何字母，从 0 到无限次，从行首到行尾”。

我假设您不想接受任何不是字母的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T17:59:57.467

假设这`textError`是您正在评估的字符串，并且应该是纯文本，我建议：

```
if (textError.match(/\d/)){
    // there's numbers in this string
} 
```

[JS Fiddle 概念验证](http://jsfiddle.net/davidThomas/U7V6f/)。

参考：

*   [`match()`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String/match).
*   [JavaScript 正则表达式，在 MDN](https://developer.mozilla.org/en/JavaScript/Guide/Regular_Expressions)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T09:50:25.530

```
<SCRIPT LANGUAGE="JavaScript">

function checkIt(evt) {
    evt = (evt) ? evt : window.event
    var charCode = (evt.which) ? evt.which : evt.keyCode
    if (!((charCode > 64 && charCode < 91) || (charCode > 96 && charCode < 123))) {
       document.getElementById("lengthError").innerHTML = "This field accepts numbers only."
        return false
    }
    document.getElementById("lengthError").innerHTML = ""
    return true
}

</SCRIPT>

<INPUT TYPE="text" NAME="text" onKeyPress="return checkIt(event)"> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-24T18:25:24.287

看，这个实现可以帮助你一生，如果你是学生，它比正则表达式更容易解释。

```
//In this case I will define here the lower and upper case alphabet
//you can restrict this alphabet to match commas, spaces, or anything else, you just
//need to add them to the var.

var lowercaseLetters = "abcdefghijklmnopqrstuvwxyzáéíóúñü"; 
var uppercaseLetters = "ABCDEFGHIJKLMNOPQRSTUVWXYZÁÉÍÓÚÑ";

//This function will check if an specific letter "c" exist in the previous defined
//alphabet
function isLetter (c) 
{ 
    return( ( uppercaseLetters.indexOf( c ) != -1 ) || 
            ( lowercaseLetters.indexOf( c ) != -1 ) ) 
} 

//this is the Main Method, basically their function is split the Word "s" in all chars
//and check if those chars are defined in 
//the initials vars lowercaseLetters and uppercaseLetters

function isAlphabetic (s) {
   var i; 

    for (i = 0; i < s.length; i+=1) 
    {    
        // Check that current character is letter. 
        var c = s.charAt(i); 

        if (!isLetter(c)) 
        return false; 
    } 
    return true; 
} 
```

现在，调用这个函数非常简单，你只需要从 Input 中捕获文本并调用 isAlphabetic(text) ，其中 text 是捕获的文本。

# google-maps-api-3 - 将 StyledMapType 设置为 overlayMapType

> ID：10742782
> 
> 赞同：0
> 
> 时间：2012-05-24T17:53:28.567
> 
> 标签：google-maps-api-3

我创建了一个自定义 StyledMapType 并将其插入 google.maps.overlayMapTypes 以便在另一个图层上绘制此自定义地图。不幸的是，我收到了这条 javascript 错误消息：

> 未捕获的类型错误：无法调用未定义 main.js:9
> （匿名函数）main.js:9
> d
> L main.js:9
> du
> H.$
> （匿名函数）的方法“应用”

这是我在浏览器中执行的代码：

```
function initialize() {
  var pinkParksStyles = [
  {
    featureType: "all",
    stylers: [
      { saturation: -80 }
    ]
  },
  {
    featureType: "poi.park",
    stylers: [
      { hue: "#ff0023" },
      { saturation: 40 }
    ]
  }
  ];
  var pinkMapType = new google.maps.StyledMapType(pinkParksStyles,
    {name: "Pink Parks"});

  var mapOptions = {
    zoom: 11,
    center: new google.maps.LatLng(55.6468, 37.581),
    mapTypeControlOptions: {
      mapTypeIds: [google.maps.MapTypeId.ROADMAP]
    }
  };
  var map = new google.maps.Map(document.getElementById('map_canvas'),
    mapOptions);

  //Insert styled map in overlayMapTypes.
  map.overlayMapTypes.insertAt(0, pinkMapType);
  map.setMapTypeId(google.maps.MapTypeId.ROADMAP);
} 
```

要查看完整示例，请参阅 jsfiddle 代码链接：http: [//jsfiddle.net/X5r8r/460/](http://jsfiddle.net/X5r8r/460/) 在此示例中，您可以注意到样式地图作为 mapType 而不是 overlayMapType。

谢谢，弗朗索瓦

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T13:41:12.430

首先，我不确定您为什么要这样做。设置基本地图类型的样式不是更容易吗？ [https://developers.google.com/maps/documentation/javascript/styling#styling_the_default_map](https://developers.google.com/maps/documentation/javascript/styling#styling_the_default_map)

基本上，当您创建要在 overlayMapTypes 中使用的地图类型时，它需要定义 getTile。在此处查看文档： [https](https://developers.google.com/maps/documentation/javascript/maptypes#OverlayMapTypes) ://developers.google.com/maps/documentation/javascript/maptypes#OverlayMapTypes StyledMap 没有公开这一点。

# xml - xsd.exe 选项 - 如何忽略约束错误消息？

> ID：10742784
> 
> 赞同：6
> 
> 时间：2012-05-24T17:53:40.027
> 
> 标签：xml, xsd.exe

我有以下错误消息：

```
C:\Users\humphrt\Desktop\AVV>xsd AVV038526.xml
Microsoft (R) Xml Schemas/DataTypes support utility
[Microsoft (R) .NET Framework, Version 2.0.50727.3038]
Copyright (C) Microsoft Corporation. All rights reserved.
Error: There was an error processing 'AVV038526.xml'.
  - Cannot add constraint to DataTable 'REEL' which is a child table in two nest
ed relations.

If you would like more help, please type "xsd /?". 
```

我在 W3.org 验证了我的 xml，[这里](http://validator.w3.org/check)

> 此文档已成功检查为格式正确的 XML！

xsd.exe 是否存在我不知道的问题？根据 W3.org，我有格式良好的 xml。因此，我很惊讶 xsd.exe 给了我一条错误消息。

我阅读了许多有关此问题的在线主题。在其中一个线程中，一位 Microsoft 工作人员建议使用 xsd.exe 的显式选项。我没有在 xsd.exe 的文档中看到“显式”作为选项。

我可以使用帮助来解决这个问题，以便我可以从我的 *.xml 文件生成 *.xsd。

# jquery - 使用 jquery 向下拉列表添加选项

> ID：10742786
> 
> 赞同：0
> 
> 时间：2012-05-24T17:53:44.570
> 
> 标签：jquery

我是 jquery 的新手，我想做的是向下拉列表添加新选项。这是我到目前为止所拥有的。有人可以解释我做错了什么吗？

```
 <asp:DropDownList ID="drop_company" runat="server"/>

     These dont work:
    $("#drop_company").append($("<option>").val("this"));
    or
    $("#drop_company").append($("<option value="1">Apple</option>")); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T17:54:28.330

尝试，

`$("#drop_company").append('<option value="1">Apple</option>');`

1.  你失踪`$`了`("#drop_company")`
2.  您可以将其附加一个简单的字符串
3.  您不能在双引号内使用双引号而不对其进行转义，否则您可以使用单引号，并且可以在其中使用上述双引号。

# c# - 实体框架 Linq 为 Null，不是 Null 问题

> ID：10742793
> 
> 赞同：1
> 
> 时间：2012-05-24T17:54:09.580
> 
> 标签：c#, linq, entity-framework, optional-parameters, isnull

我有一个接收类别 id 的方法，后跟两个默认为 null 的可选字符串参数。

我尝试使用其他关于 SO 的问题的类似答案，但到目前为止没有任何帮助。

我试图让 linq to EF 查询按如下方式工作：

如果任一可选参数有值，则使用该值，否则使用 Is Null。

如果两个可选参数都存在，则将它们用作查询的一部分，或者仅在提供的 eis 上使用其中一个。但如果没有添加参数，则只需使用类别 id。

db 中的两个可选参数都标记为可为空。

这是不起作用的代码：

```
 from c in dtx.Categories
          where c.CategoryId == CatId
         && (string.IsNullOrEmpty(param1) ? c.Param1 == null : c.Param1 == param1)
         && (string.IsNullOrEmpty(param2) ? c.Param2 == null : c.Param2 == Param2)
        select c 
```

尝试二：

```
 from c in dtx.Categories
          where c.CategoryId == CatId
          && (c.Param1 == null ? c.Param1 == null : c.Param1 == param1)
          && (c.Param2 == null ? c.Param2 == null : c.Param2 == param2)
          select c 
```

不会抛出任何错误，但两个查询始终返回零结果，除非两个参数都存在。

我尝试过的帖子之一： [如何在实体框架中查询空值？](https://stackoverflow.com/questions/682429/how-can-i-query-for-null-values-in-entity-framework)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T18:36:36.077

据我所知，问题看起来像查询的条件写得不正确。让我们检查一下将附加一个示例的内容：

数据：

```
Id = 1, Param1 = null, Param2 = null
Id = 2, Param1 = 'a'   param2 = null
Id = 3, Param1 = null, Param2 = 'b'
Id = 4, Param1 = 'a'   param2 = 'c' 
```

使用当前查询和提出的其他解决方案，您只会得到 Id 1。您的条件是：如果 Param1 为 Null 且 c.Param1（存储的值）为 null 或 c.Param1 等于 Param1 值。

您需要的是一个条件：如果 Param1 为 Null 或 c.Param1 等于 Param1 值。

如果您使用此查询，您将始终得到您的结果。

```
from c in dtx.Categories
where c.CategoryId == CatId
    && (string.IsNullOrEmpty(param1) || c.Param1 == param1)
    && (string.IsNullOrEmpty(param2) || c.Param2 == param2)
select c 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T17:59:45.130

第三次编辑运气，也许我这次读到了这个问题:)

```
var p1 = string.IsNullOrEmpty(param1) ? null : param1;
var p2 = string.IsNullOrEmpty(param2) ? null : param2;

var query = dtx.Categories.Where(c => c.CategoryId == CatId);
if (p1 != null || p2 != null) {
    query = query.Where(c => c.Param1 == p1 && c.Param2 == p2);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T17:58:21.820

您应该明确展开检查，两者都是`null`或它们匹配

```
((string.IsNullOrEmpty(param1) && c.Param1 == null) || (c.Param1 == param1)) 
```

编辑：刚刚测试过，你检查`null`或不检查SQL是否相同并不重要，所以就这样做

```
from c in dtx.Categories 
    where c.CategoryId == CatId 
       && (c.Param1 == param1) 
       && (c.Param2 == Param2) 
select c 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-24T10:55:51.733

问题是当你写

```
from ... where c.Param1 == null ... 
```

LINQ 将其转换为相同的 SQL 表达式：

```
SELECT ... FROM ... WHERE Param1 = null ... 
```

但你需要这个：

```
SELECT ... FROM ... WHERE Param1 IS NULL ... 
```

**所以这里正确的解决方案是**：

```
from c in dtx.Categories
where c.CategoryId == CatId && 
     (param1 == null ? !c.Param1.HasValue : c.Param1.Value == param1) && 
     (param2 == null ? !c.Param2.HasValue : c.Param2.Value == param2)
select c 
```

# java - 带有 JSON 友好编码的简单 Java 加密？

> ID：10742798
> 
> 赞同：2
> 
> 时间：2012-05-24T17:54:28.533
> 
> 标签：java, json, web-services, encryption

我正在寻找一个简单的 Java 加密解决方案，它允许我指定编码，以便可以将加密数据嵌入到 JSON 文档中。

**为什么？**发生错误时，我的 Web 服务会返回描述性 JSON 消息。如果发生内部服务器错误，我想包含一个包含诊断信息的字段，但是我想加密此数据以避免潜在的安全问题。

我要寻找类似于 YouTube 的内部服务器错误的东西，加上 JSON 和减去猴子。：

![YouTube 500 错误](../Images/66aa7146db58c5fb5684db25ced224b1.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T19:15:31.433

加密数据并将其作为[base64](http://en.wikipedia.org/wiki/Base64)字符串返回。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-25T03:07:41.497

正如 Hot Licks 所说，使用您选择的方法进行加密以达到您想要的安全级别与性能/简单性。然后对该数据使用 Base64 编码，以便在 JSON 中轻松传输。周围有几个 Base64 库。查看这些堆栈溢出答案以获得良好的 Java 加密选项：

[Java简单加密](https://stackoverflow.com/questions/1354803/java-simple-encryption)

[如何在 Java 中加密字符串](https://stackoverflow.com/questions/1205135/how-to-encrypt-string-in-java)

# drupal - Drupal Views：输出项目字段按字段而不是项目分组？

> ID：10742803
> 
> 赞同：0
> 
> 时间：2012-05-24T17:54:44.317
> 
> 标签：drupal, drupal-views

因此，目前如果我创建一个输出三篇文章及其标题和正文字段的视图，则 html 结构的清理版本将是：

```
<div class="item-1">
   <div class="title">Item One Title</div>
   <div class="body">Blah Blah Blah......</div>
</div>
   <div class="item-2">
   <div class="title">Item Two Title</div>
<div class="body">Blah Blah Blah......</div>
</div>
<div class="item-3">
   <div class="title">Item Three Title</div>
   <div class="body">Blah Blah Blah......</div>
</div> 
```

任何人都知道我可以如何通过 Views 或最佳替代方案来制作这样的结构：

```
<div class="titles">
   <div class="title1">Item One Title</div>
   <div class="title2">Item Two Title</div>
   <div class="title3">Item Three Title</div>
</div>
<div class="bodies">
   <div class="body1">Blah Blah Blah......</div>
   <div class="body2">Blah Blah Blah......</div>
   <div class="body3">Blah Blah Blah......</div>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T18:42:24.920

查看视图附件。设置您的第一个视图，仅包含标题。添加显示>附件，覆盖您的字段以获取正文并使用附件设置将其定位在第一个之后。如果这令人困惑，应该有一些教程。希望能帮助到你。

# java - 不同的输出——在命令行中运行 mathtext 以及使用 apache-commons-exec 从 java 程序执行命令时

> ID：10742805
> 
> 赞同：0
> 
> 时间：2012-05-24T17:54:48.510
> 
> 标签：java, apache-commons-exec

我正在尝试使用 apache-commons-exec 从 java 程序运行 mathtext。问题是当我从 java 程序运行相同的命令和通过 shell 运行它时，我得到不同的输出。所以如果在shell中像这样运行mathtext：

```
./mathtext test.png "\$\frac{{\left( {{p^2} - {q^2}} \right)}}{2}\$" 
```

在外壳中，我得到了完美的 png，但是当我使用 apache-commons-exec 运行相同的东西时

```
Map map = new HashMap();    

        map.put("target", new File(trgtFileName));
        DefaultExecuteResultHandler resultHandler = new DefaultExecuteResultHandler();
        Executor exec = new DefaultExecutor();
        exec.setWorkingDirectory(/*I set the working directory where the mathtext is*/);
        CommandLine cl = new CommandLine("./mathtext"); 
        cl.addArgument("${target}");
        cl.addArgument(latex);
        cl.setSubstitutionMap(map);
//      Logger.log4j.info("command is:::"+cl.toString());
        ExecuteWatchdog watchdog = new ExecuteWatchdog(5000);
        exec.setWatchdog(watchdog);
        exec.execute(cl,EnvironmentUtils.getProcEnvironment(),resultHandler);
        resultHandler.waitFor(); 
```

我得到了图像，不是方程，而是原始的 TeX 字符串:(

有人可以帮我解决这个问题吗？我想得到确切的输出。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T01:37:21.547

我发现问题出在哪里：

$ 是 unix shell 的特殊字符，而不是 java 的特殊字符。所以即使在命令行中输入需要转义 $ 像：

```
"\$\frac{{\left( {{p^2} - {q^2}} \right)}}{2}\$" 
```

在Java程序中，我不需要转义'$'或在开头和结尾加上“（双引号）。我必须像这样输入命令：

```
$\frac{{\left( {{p^2} - {q^2}} \right)}}{2}$ 
```

希望这可以帮助某人:)

——香科内尔

# asp.net - OleDb - 检索 Excel 工作表名称也会检索定义的名称

> ID：10742807
> 
> 赞同：1
> 
> 时间：2012-05-24T17:54:54.220
> 
> 标签：asp.net, excel, c#-4.0, oledb

我正在尝试检索 Excel 工作簿中的工作表列表，但我返回的集合同时具有工作表名称和数据列 ID，在原始 xlsx xml 中似乎称为“定义名称”。你能告诉我如何只返回工作表名称吗？

我正在使用的代码是：

```
OleDbConnection connExcel = new OleDbConnection(@"Provider=Microsoft.ACE.OLEDB.12.0;"
            + @"Data Source=" + FilePath + ";"
            + @"Extended Properties=""Excel 8.0;HDR=Yes;""");

OleDbCommand cmdExcel = new OleDbCommand();
cmdExcel.Connection = connExcel;
connExcel.Open();

DataTable testTable = connExcel.GetSchema("Tables"); 
```

生成的 testTable 集合的内容包含以下 TABLE_NAME 下的条目：

*   数据1
*   数据2
*   数据3
*   数据4
*   数据5
*   表 1$
*   测试1-测试2
*   测试密钥
*   测试键
*   测试密钥

它们都有一个 TABLE_TYPE 的 TABLE。

与上述对应的原始工作簿将有一个包含 5 列的工作表，第一行将包含一个标题。我只对 Sheet1$ 条目感兴趣。该电子表格是在 Excel 2010 中创建的，我正在尝试在用 C# 编写的 ASP.NET 4 应用程序中处理它。工作表名称可能已更改，因此我不能保证它始终是 Sheet1$。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T19:17:54.873

我的第一个想法是错误的，所以我想出了一个解决方法。返回的实际工作表名称应始终以 $ 结尾，因此我对其进行了破解以进行检查。凌乱，但你明白我敢肯定。

```
OleDbConnection connExcel = new OleDbConnection(@"Provider=Microsoft.ACE.OLEDB.12.0;"
        + @"Data Source=c:\test.xlsx;"
        + @"Extended Properties=""Excel 12.0 Xml;HDR=Yes;""");

        OleDbCommand cmdExcel = new OleDbCommand();
        cmdExcel.Connection = connExcel;
        connExcel.Open();

        DataTable testTable = connExcel.GetSchema("Tables");

        String[] excelSheets = new String[testTable.Rows.Count];
        int i = 0;

        foreach (DataRow row in testTable.Rows)
        {
            excelSheets[i] = row["TABLE_NAME"].ToString();

            if (excelSheets[i].EndsWith("$"))
            {
                Console.WriteLine(excelSheets[i] = row["TABLE_NAME"].ToString());
                i++;
            }
            else
            {
                i++;
            }

        }

        Console.ReadLine(); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2019-09-30T14:33:06.890

```
private static string EXCEL_CONNECTIONSTRING = string.Format("Provider=Microsoft.ACE.OLEDB.12.0; data source={0}; Extended Properties=Excel 12.0;", "#{FILENAME}");

private IEnumerable<string> GetWorksheetNames(string excelFile)
{

     var currentConnectionString = EXCEL_CONNECTIONSTRING.Replace("#{FILENAME}", excelFile);

     using (OleDbConnection connection = new OleDbConnection(currentConnectionString))
     {
        OleDbCommand cmdExcel = new OleDbCommand();

        cmdExcel.Connection = connection;
        connection.Open();

        DataTable dt = connection.GetSchema("Tables");

        IEnumerable<string> excelSheets = dt.Rows.Cast<DataRow>().Select(row => row["TABLE_NAME"].ToString());
        dt.Dispose();
        connection.Close();
        return excelSheets;

     }

  } 
```

# .net - 如何引用资源以保存在设置中 - Visual Basic 2008 .net

> ID：10742811
> 
> 赞同：2
> 
> 时间：2012-05-24T17:55:35.630
> 
> 标签：.net, vb.net, reference, settings, embedded-resource

我正在尝试保存一个设置，以保留我当前使用的背景图像。

如果它是一个外部文件，没有问题，我可以获取 .location 并将其设置为 String 设置来存储它。

但是，如果我想将图像资源存储为设置，我该怎么做？

我知道我可以存储原始数据，例如位图信息，但是我无法将这种类型的数据设置为 my.background。

我不知道问题是否应该是：“我如何引用资源”，但 my.resources.resource.methodsList 不包含任何似乎有用的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T18:27:52.597

您可以使用`My.Resources.ResourceManager.GetObject("resource name")`按字符串读取资源。下面是一些示例代码，向您展示如何从资源中获取所有嵌入图像的列表，其中包括它们的字符串名称和图像对象本身：

```
Public Class EmbeddedImage
    Public Sub New(ByVal name As String, ByVal image As Image)
        _name = name
        _image = image
    End Sub

    Public ReadOnly Property Name() As String
        Get
            Return _name
        End Get
    End Property
    Private _name As String

    Public ReadOnly Property Image() As Image
        Get
            Return _image
        End Get
    End Property
    Private _image As Image
End Class

Private Function getEmbeddedImages() As List(Of EmbeddedImage)
    Dim images As List(Of EmbeddedImage) = New List(Of EmbeddedImage)()
    Dim resources As ResourceSet = My.Resources.ResourceManager.GetResourceSet(CultureInfo.CurrentCulture, True, True)
    For Each resource As DictionaryEntry In resources
        If TypeOf resource.Value Is Image Then
            images.Add(New EmbeddedImage(resource.Key.ToString(), CType(resource.Value, Image)))
        End If
    Next
    Return images
End Function 
```

# delphi - 如何在 Panel 内制作透明表单？

> ID：10742819
> 
> 赞同：1
> 
> 时间：2012-05-24T17:56:04.153
> 
> 标签：delphi, transparent, delphi-6

我需要在运行时在面板内创建一个部分透明的表单。

我怎么能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T08:07:40.800

如果您的问题仅与将表单放入 TPanel 的方式有关，那么这很容易。您只需要使用新创建的表单的句柄调用**Windows.SetParent() 。**

```
MyNewForm := TMyNewForm.Create(Self); 
Windows.SetParent(MyNewForm.Handle,MyPanel.Handle); 
```

这也可以通过使用 TForm Property *ParentWindow*来工作。但是（很）有可能没有处理透明度（我用半透明的形式简单地测试了它并且没有正确绘制，所以如果透明度是强制性的，它可能无法达到你的目标......）

# python - Python multiple processes instead of threads?

> ID：10742820
> 
> 赞同：2
> 
> 时间：2012-05-24T17:56:05.333
> 
> 标签：python, multithreading, multiprocess

I am working on a web backend that frequently grabs realtime market data from the web, and puts the data in a MySQL database.

Currently I have my main thread push tasks into a Queue object. I then have about 20 threads that read from that queue, and if a task is available, they execute it.

Unfortunately, I am running into performance issues, and after doing a lot of research, I can't make up my mind.

As I see it, I have 3 options: Should I take a distributed task approach with something like Celery? Should I switch to JPython or IronPython to avoid the GIL issues? Or should I simply spawn different processes instead of threads using processing? If I go for the latter, how many processes is a good amount? What is a good multi process producer / consumer design?

Thanks!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T18:33:21.863

First, profile your code to determine what is bottlenecking your performance.

If each of your threads are frequently writing to your MySQL database, the problem may be disk I/O, in which case you should consider using an in-memory database and periodically write it to disk.

If you discover that CPU performance is the limiting factor, then consider using the `multiprocessing` module instead of the `threading` module. Use a `multiprocessing.Queue` object to push your tasks. Also make sure that your tasks are big enough to keep each core busy for a while, so that the granularity of communication doesn't kill performance. If you are currently using `threading`, then switching to `multiprocessing` would be the easiest way forward for now.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T18:34:23.340

Maybe you should use an [event-driven](http://en.wikipedia.org/wiki/Event-driven_architecture) approach, and use an event-driven oriented frameworks like [twisted](http://twistedmatrix.com/trac/)(python) or [node.js](http://nodejs.org/)(javascript), for example this frameworks make use of the UNIX domain sockets, so your consumer listens at some port, and your event generator object pushes all the info to the consumer, so your consumer don't have to check every time to see if there's something in the queue.

# c# - 反射，动态。如何用另一个对象替换一个对象？

> ID：10742823
> 
> 赞同：1
> 
> 时间：2012-05-24T17:56:10.753
> 
> 标签：c#

我有一个像这样的对象

```
public class Simple
{
    public string Value
    {
      get { return GetProperty(); }
    }

    // different methods, fields, events, etc.
} 
```

可以用相等的对象替换*Simple类的实例，但是用setter？*

如何实施...

```
private object Substitution(object simple)
{
    object newSimple;

    // implementations

    newSimple.Value = "data";
    return newSimple;
} 
```

拥有这样的东西

```
public class Simple
{
    public string Value { get; set; }

    // my methods, fields, events ...
} 
```

我想创建一个类并从 SystemObject 继承，然后您可以创建不同的动态属性，但不能这样做:(

或者也许尝试从这个对象继承（如何？）并覆盖属性？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T18:06:11.200

您不能在运行时更改已加载类型的定义或结构。

您可能会创建一个具有类似属性和字段集的*新类型，并添加属性设置器。*但是，在大多数情况下，这将是有限的用途，因为现有代码将无法理解新类型（因为它是运行时生成的），因此仍将处理现有类型，这将不兼容。

通常，如果您需要在一个类型中进行运行时可扩展性，还有其他选项，包括使用 a`Dictionary<T,U>`或`dynamic`with`ExpandoObject`或其他一些机制，用于在编译时未知的类中存储“额外”信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T18:13:24.173

You couuld always use an interface, that only defines a property getter. Then in the implementation have a property setter?

```
class Program
{
    static void Main(string[] args)
    {
        IMyClass myA = new ClassA{ Property = "Class A" };

        Console.WriteLine(myA.Property);

        // can't do this
        // myA.Property = "New Property"; 

        // can do this
        (myA as ClassA).Property = "New Property"; 
        Console.WriteLine(myA.Property);
    }
}

interface IMyClass
{
    string Property { get; }
}

class ClassA : IMyClass
{
    public string Property { get; set; }
} 
```

Failing that, you could do an user defined conversion using the explicit keyword, [more info at MSDN](http://msdn.microsoft.com/query/dev10.query?appId=Dev10IDEF1&l=EN-US&k=k%28EXPLICIT_CSHARPKEYWORD%29;k%28TargetFrameworkMoniker-%22.NETFRAMEWORK%2cVERSION%3dV4.0%22%29;k%28DevLang-CSHARP%29&rd=true)

# java - 如何将旧的原始数据从一个表重新处理到另一个表？

> ID：10742827
> 
> 赞同：0
> 
> 时间：2012-05-24T17:56:33.240
> 
> 标签：java, sql-server

嗨，我正在实现一个 java 应用程序。应用程序将从设备中读取数据并存储到数据库中。在这里我的问题是我只存储了 1 个月后的数据，它将被删除，但我在 cd 中有备份或将其写入文件。假设客户询问 3 个月前的数据。我如何使用 Sql server 2005 重新处理该数据。请告诉我如何做到这一点..

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T18:42:04.750

我不确定您是否只想创建仅保留一个月历史的数据库并将它们粘合在一起以备不时之需。在这种情况下，您可以执行以下操作：

```
CREATE DATABASE [TEST] ON  PRIMARY 
( NAME = N'TEST', FILENAME = X:\SOMEPLACE\MSSQL10_50.MSSQLSERVER\MSSQL\DATA\TEST.mdf' , SIZE = 2048KB , FILEGROWTH = 1024KB )
 LOG ON ( NAME = N'TEST_log', FILENAME = X:\SOMEPLACE\MSSQL10_50.MSSQLSERVER\MSSQL\DATA\TEST_log.ldf' , SIZE = 1024KB , FILEGROWTH =     10%)
GO
USE TEST
CREATE TABLE DATATBL (USRKEY INT IDENTITY(1,1), SOMEDATA VARCHAR(50))
/* IN A SQL SERVER AGENT SCRIPT YOU SCHEDULE TO RUN THE END OF THE MONTH*/
GO
DECLARE @DBNAME VARCHAR(50)
SELECT @DBNAME ='TEST_HIST_' + CAST(DATEPART(YEAR,GETDATE()) AS VARCHAR(4)) + '_' +CAST(DATEPART(MONTH,GETDATE()) AS VARCHAR(2))
EXEC(
'CREATE DATABASE ['+@DBNAME+'] ON  PRIMARY ( NAME = N'''+@DBNAME+''', FILENAME =     N''X:\SOMEPLACE\MSSQL10_50.MSSQLSERVER\MSSQL\DATA\'+@DBNAME+'.mdf'' , SIZE = 2048KB ,     FILEGROWTH = 1024KB )  LOG ON  ( NAME = N'''+@DBNAME+'_log'', FILENAME =     N''X:\SOMEPLACE\MSSQL10_50.MSSQLSERVER\MSSQL\DATA\'+@DBNAME+'_log.ldf'' , SIZE = 1024KB ,     FILEGROWTH = 10%) ')
GO
DECLARE @DBNAME VARCHAR(50)

BEGIN TRANSACTION

SELECT @DBNAME ='TEST_HIST_' + CAST(DATEPART(YEAR,GETDATE()) AS VARCHAR(4)) + '_' +CAST(DATEPART(MONTH,GETDATE()) AS VARCHAR(2))
 EXEC('USE '+@DBNAME)
CREATE TABLE DATATBL (USRKEY INT , SOMEDATA VARCHAR(50))
INSERT INTO DATATBL SELECT * FROM TEST.DATATBL
DELETE FROM DATATBL

COMMIT TRANSACTION

/* ACCESSING DATA*/
GO
DECLARE @SCR VARCHAR(MAX)='SELECT * FROM TEST.DATATBL'
DECLARE @GETTOTMONTHS INT=3
DECLARE @CUR INT=0
DECLARE @CURDB VARCHAR(50)
DECLARE @REFDATE DATE=DATEADD(MONTH,DATEPART(MONTH,GETDATE()),DATEADD(YEAR,DATEPART(YEAR,GETDATE()),0))
WHILE @CUR<@GETTOTMONTHS
BEGIN
    SET @REFDATE=DATEADD(MONTH,-1,@REFDATE)
    SET @CURDB = 'TEST_HIST_' + CAST(DATEPART(YEAR,@REFDATE) AS VARCHAR(4)) + '_' + CAST    (DATEPART(MONTH,@REFDATE) AS VARCHAR(2))
    IF @SCR>'' SET @SCR=@SCR+' UNION ALL '
    SET @SCR=@SCR+'SELECT * FROM '+@CURDB+'.DATATBL'
    SET @CUR=@CUR+1
END
SELECT @SCR
EXEC @SCR 
```

我不建议转储到文本文件中，这会对性能产生明显影响 - 毕竟，您仍然可以分离/备份 mdf 文件，该文件将准备好重新附加和完美地重用

# html - CSS Flyout 菜单在 IE9 中被其容器的边框截断

> ID：10742828
> 
> 赞同：1
> 
> 时间：2012-05-24T17:56:36.283
> 
> 标签：html, css, internet-explorer

我有一个弹出菜单，（当然）在 FF/Chrome 中看起来很棒，但在 IE 中，它令人窒息。我在 JS Fiddle 上有一个完整的例子：http: [//jsfiddle.net/JXw3S/4/](http://jsfiddle.net/JXw3S/4/)

如果您将鼠标悬停在第二个 2 菜单项上，那里应该有一个弹出菜单。然而，在 IE 中，它似乎被#primaryMenu 容器的边界截断了。

如果 JSFiddle 不可用，这是我的代码：

HTML

```
<menu id="primaryMenu">
    <ul>
        <li class="active"><a href="#"><span>FMS</span></a><div class="arrow"><div></div></div>
            <ul>
                <li><a href="#">Project Accounts</a></li>
                <li><a href="#">Non-Project Accounts</a></li>
                <li><a href="#">DocID Log</a></li>
                <li><a href="#">Gift Card Tracking</a></li>
                <li><a href="#">PO/Account Reference</a></li>
                <li><a href="#">Speedkey Reference</a></li>
            </ul>
        </li>
        <li><a href="#"><span>Personel</span></a><div class="arrow"><div></div></div>
            <ul>
                <li><a href="#">Payroll</a>
                    <ul>
                        <li><a href="#">Report</a></li>
                        <li><a href="#">Analysis</a></li>
                    </ul>
                </li>
                <li><a href="#">Manage</a></li>
                <li><a href="#">PI/Project Effort</a></li>
            </ul>
        </li>
        <li><a href="#"><span>Facilities</span></a><div class="arrow"><div></div></div>
            <ul>
                <li><a href="#">Manage</a></li>
            </ul>
        </li>
    </ul>
    <a href="#" id="primaryMenuCollapse"><span>Collapse Menu</span></a>
</menu> 
```

CSS：

```
#primaryMenu{display:block;position:fixed;left:0px;top:132px;z-index:90;padding:40px 0 0;margin:0;width:200px}
#primaryMenu ul{padding:0;margin:0;list-style-type:none}
#primaryMenu li{padding:0;margin:0;position:relative}
#primaryMenu a{font-size:0.95em}

#primaryMenu>ul{border-bottom:1px solid #aaa;position:relative}
#primaryMenu>ul>li{border-bottom:1px solid #fff;border-top:1px solid #aaa}
#primaryMenu>ul>li>a{color:#333;text-shadow:-1px 1px 0 #fff;display:block;height:32px}
#primaryMenu>ul>li.active>a{display:block}
#primaryMenu>ul>li>a>span{display:block;padding:5px 10px 5px 30px;line-height:normal;background:url(../img/cog.png) no-repeat 10px 9px;color:#666;text-shadow:-1px 1px 0 #fff}
#primaryMenu>ul>li.hovered>a>span{color:#fff;text-shadow:-1px 1px 0 #666}
#primaryMenu>ul>li.active>a>span{color:#fff;text-shadow:-1px 1px 0 #666}

#primaryMenu>ul>li>.arrow{top:-1000em}
#primaryMenu>ul>li.active>.arrow,
#primaryMenu>ul>li.hovered>a+.arrow{position:absolute;right:1px;top:0px;z-index:5}
#primaryMenu>ul>li.active>.arrow>div,
#primaryMenu>ul>li.hovered>a+.arrow>div{position: absolute;top: 0px;left: 0px;width: 14px;height: 32px;-webkit-border-top-right-radius: 20px;-webkit-border-bottom-right-radius: 20px;-moz-border-radius-topright: 20px;-moz-border-radius-bottomright: 20px;border-top-right-radius: 20px;border-bottom-right-radius: 20px}

#primaryMenu>ul>li>ul{display:none}
#primaryMenu>ul>li>ul>li>a,
#primaryMenu>ul>li>ul>li>ul>li>a{display:block;font-size:0.9em;padding:1px 10px;color:#444}
#primaryMenu>ul>li>ul>li>a:hover{color: #06e;}
#primaryMenu>ul>li.active>ul{display:block}

#primaryMenu>ul>li.hovered{}
#primaryMenu>ul>li.hovered>ul{display:block; position:absolute;width:140px;background:#fff;top:-1px;right:-141px;border-right:1px solid #aaa;border-bottom:1px solid #aaa;border-top:1px solid #aaa;z-index:1}
#primaryMenu>ul>li.hovered>ul>li>a{padding-left:20px}
#primaryMenu>ul>li.hovered>ul>li>a:hover,
#primaryMenu>ul>li>ul>li>ul>li>a:hover{background:#f0f6fd}

#primaryMenu>ul>li>ul>li>ul>li>a{padding-left:40px;font-size:0.8em;font-style:italic} 
```

还有一点 JS 添加了一个悬停类

```
$('#primaryMenu>ul>li').hover(function(){
    if($(this).hasClass('active')){}else
    {
        $(this).addClass('hovered')
    }
},
function(){
    $(this).removeClass('hovered')
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T18:00:42.853

`#primarymenu`有一个`z-index`值集，这导致了 IE9 中的问题。

[http://jsfiddle.net/JXw3S/5/](http://jsfiddle.net/JXw3S/5/)

# awk - 比较同一文件中的列

> ID：10742834
> 
> 赞同：0
> 
> 时间：2012-05-24T17:56:54.613
> 
> 标签：awk

我的文件有数千行，看起来像

```
R4604                17131G1                   499456.1 1966201.0   0.0  1000001
R4604                17131G1                   499456.1 1966201.0   8.5  1000001
R4604                17131G1                   499456.1 1966201.0   8.5  1000001
R4604                17131G1                   499456.1 1966201.0   8.5  1000001
R4604                17131G1                   499456.1 1966201.0   8.5  1000001
R4604                17131G1                   499456.1 1966201.0   8.5  1000001
R4604                17131G1                   499456.1 1966201.0   8.5  1000001
R4604                17131G1                   499456.1 1966201.0   8.5  1000001
R4604                17131G1                   499456.1 1966201.0   8.5  1000001
R4496                12011G1                   473856.2 1960800.9   0.0  1000001
R4496                12011G1                   473856.2 1960800.9  64.0  1000001 
```

我想得到的输出是

```
R4604                17131G1                   499456.1 1966201.0   8.5  1000001
R4496                12011G1                   473856.2 1960800.9  64.0  1000001 
```

因此，如果第 1-5 列相同，只需获取一行，如果第 1-4 列相同且第 5 列中的值不同，则删除第 5 列值为 0.0 的行

感谢您的帮助亚历杭德罗

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T19:13:21.720

假设一个已排序的值，并且对于组中的每一行，第 5 列始终为 0 或相同的非零值，并且第 5 列等于 5 时没有要保留的行：

```
awk '$5 != 0 {key = $1 $2 $3 $4 $5; if (prev != key) {print saved}; prev = key; saved = $0} END {print saved}' inputfile 
```

# javascript - 使用 $.when() 从多个 $.get() 读取数据

> ID：10742837
> 
> 赞同：0
> 
> 时间：2012-05-24T17:57:17.237
> 
> 标签：javascript, jquery

我正在使用 jQuery`$.when()`来处理多个`$.get()`请求。这就是我设置它的方式。

```
var request1 = $.get('myURL');
var request2 = $.get('mySecondURL');

$.when(request1, request2).done(go);

function go(request1, request2){
    console.log(request1);
    console.log(request2);
} 
```

一切都很好。Chrome 的控制台显示

```
[#document, "success", Object] 
```

我知道这`#document`是我需要阅读的内容，但是获取它的语法是什么？**我见过的每个示例都使用来自OOP AS3**的匿名函数，这些函数我不习惯并困扰我。

我试过`console.log(request1[0]);`哪种方法可行，但必须有更合适的方法。像`request1.data`或`$(request1).$('#document');`

就像我说的，我是一名重度 Flex 开发人员，开始涉足 JS 和 jQuery，所以我仍在尝试学习语法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T17:59:02.073

创建一个 jQuery 对象并像使用从选择器创建的对象一样使用它：`$(request1)`

例如，`$(request1).appendTo('#out')`将新加载的内容附加到带有`id="out"`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T18:35:50.640

根据[文档`$.when`](http://api.jquery.com/jQuery.when/)，`request1[2]`具有`jqXHR`对象，而对象又具有`responseText`成员。如果您`console.log`至少在 Chrome 中使用，您可以查看 的内容`jqXHR`以找到您特别想要访问的成员，但它可能是`responseText`.

# vb.net - 如何使用报表查看器在 SSRS 2008 R2 中的主报表下方显示钻取报表

> ID：10742838
> 
> 赞同：2
> 
> 时间：2012-05-24T17:57:27.457
> 
> 标签：vb.net, ssrs-2008, reportviewer, reporting-services

我将 ReportViewer 与 ServerReports、SSRS 2008 R2 和 VB.NET 一起使用。我正在使用“转到报告”操作将报告链接在一起。单击 SSRS 报表上的链接时的默认功能是将该报表替换为钻取报表。相反，我想将主报告保留在那里，并将钻取报告显示为下面的单独 ReportViewer。

我在某种程度上找到了一种方法来实现这一点，但它似乎不是很有效。下面是我到目前为止的代码（从这个[线程](http://social.msdn.microsoft.com/Forums/en-US/sqlreportingservices/thread/9131fa89-458a-44d1-87ba-61f6a6f3d9e0)找到）：

```
Public Sub SummaryDrillthroughHandler(ByVal sender As Object, _
    ByVal e As DrillthroughEventArgs)

    e.Cancel = True 'Stop action from replacing main report as expected

    Dim rpic As ReportParameterInfoCollection = e.Report.GetParameters()
    Dim params As New List(Of ReportParameter)

    For Each param As ReportParameterInfo In rpic
        params.Add(New ReportParameter(param.Name, param.Values(0)))
    Next

    ReportViewer3.ServerReport.ReportServerUrl = New Uri("myReportServer")
    ReportViewer3.ServerReport.ReportPath = e.ReportPath
    ReportViewer3.ServerReport.SetParameters(params)

End Sub 
```

这确实有效，但看起来好像它正在尝试加载报告两次。我无法找到有关 DrillthroughEventHandler 的太多文档，但是当钻取报告已从服务器获取并准备好与所有数据一起呈现时，该事件似乎会触发。

因此，调用我上面的代码实际上会按顺序加载报告两次（一次是在主报告中单击链接时，另一次是在设置钻取报告参数时）。在萤火虫中，我看到每个发布事件大约需要 8 秒（钻取报告有点慢）。当我取出上面的代码并且钻取报告替换主报告时，只发送了 1 个帖子。

有没有办法拦截对钻取报表的第一次调用，并使用所需的参数直接从 ReportViewer3 控件调用它？我错过了什么吗，这看起来是一个相当普遍的要求？

# php - 我的 Wordpress 数组有什么问题？

> ID：10742846
> 
> 赞同：0
> 
> 时间：2012-05-24T17:57:59.350
> 
> 标签：php, arrays, wordpress, posts

我正在尝试使用数组排除 Wordpress 中的某些帖子。我可以通过这样做成功删除其中一个帖子：

```
<?php if ( $post->ID != '443' ) { ?>
  ...
<?php } ?> 
```

我正在尝试创建要删除的帖子数组并具有以下内容：

```
<?php $excluded = array('443', '479', '464', '589', '333', '296', '381', '405', '252', '301', '291', '306', '632', '634', '636', '313', '317', '389', '410', '417', '321');
if ( $post->ID != $exclude ) { ?>
  ...
<?php } ?> 
```

我一直在尝试自学 PHP 并且正在努力解决数组问题，有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T18:03:40.793

正如您的第一个示例所示，将数字与数字进行比较确实有效。

但是我第二个将数字（ID）与数组（数字列表）进行比较。

要检查 ID 是否是“排除”列表的元素，您必须使用[in_array()](http://php.net/manual/en/function.in-array.php)：

```
if (!in_array($post->ID,$exclude)){
...
} 
```

问候，

斯蒂芬

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T18:00:30.560

你应该用它`in_array`来测试一个值是否在一个数组中

IE，

```
if (in_array($post->ID, $exclude)) {

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T18:04:35.037

您的 if 语句的问题是您正在检查 postID != 是否是整个数组，而不是检查值是否在与该值匹配的数组内。

您想使用[in_array](http://php.net/manual/en/function.in-array.php)函数。这看起来像：

```
if ( !in_array($post->ID, $exclude ) 
```

# sql-server - 估计的执行计划显示需要的索引？

> ID：10742849
> 
> 赞同：3
> 
> 时间：2012-05-24T17:58:23.710
> 
> 标签：sql-server

行，

我不知道我是不是疯了，但是估计的执行计划没有用来向您展示您需要哪些索引来提高您的性能？我在以前的工作中习惯了这一点，但现在看来我必须使用调优顾问。我不介意调优顾问，但我之前的做法是如此简单！

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-24T18:02:34.023

在 SSMS 2008 和 SSMS 2012 中，这对于估计和实际计划都适用。

这是一个简单的示例，显示估计的和实际的执行计划都将显示缺失的索引：

```
USE tempdb;
GO

CREATE TABLE dbo.smorg(blamp INT);
GO

INSERT dbo.smorg(blamp) SELECT n FROM
(
  SELECT ROW_NUMBER() OVER (ORDER BY c1.object_id)
  FROM sys.all_objects AS c1, sys.all_objects AS c2

) AS x(n);
GO 
```

现在突出显示并选择估计的执行计划，或者打开实际执行计划并点击执行：

```
SELECT blamp FROM dbo.smorg WHERE blamp BETWEEN 100 AND 105; 
```

您应该会看到缺失的索引建议。你会看到它在这里表示：

```
SELECT * 
    FROM sys.dm_db_missing_index_details 
    WHERE [object_id] = OBJECT_ID('dbo.smorg'); 
```

您可以在此处阅读有关 DMV 的更多信息：

[http://msdn.microsoft.com/en-us/library/ms345434.aspx](http://msdn.microsoft.com/en-us/library/ms345434.aspx)

您还应该调查[SQL Sentry Plan Explorer](http://sqlsentry.net/plan-explorer/sql-server-query-view.asp)（免责声明：我为 SQL Sentry 工作）。这是一个免费工具，显示估计计划的缺失索引（如果它们在 SQL Server 提供的 XML 中），没有像 SSMS 这样的错误（它在多个批次中重复相同的建议，即使批次没有提到相同的表），并生成实际的执行计划*，而不*会将所有结果通过网络拉到客户端 - 它只是丢弃它们（因此网络和数据开销不会影响计划分析）。

# php - 将表链接在一起

> ID：10742852
> 
> 赞同：1
> 
> 时间：2012-05-24T17:58:49.700
> 
> 标签：php, mysql

一些前提：一个种植者种植农产品，一种农产品可以有很多品种，但有些品种只由某些种植者种植

因此，我有 4 张桌子：

农产品（id，produce_name）
品种（id，variety_name）
种植者（id， grower_name）种植者品种（id
，grower_id，variety_id）

我正在从当前登录的会话中获取我的 grower_id。

我只需要在我的下拉列表中显示种植者种植的品种。

到目前为止，我的代码是：

```
 <SELECT name="productcode">

            <?php

            $query   = "SELECT grower_id, variety_id FROM grower_variety WHERE grower_id = '$grower_id'"; 

            $result  = mysql_query($query) or die('Error : ' . mysql_error()); 
            while ($row     = mysql_fetch_array($result, MYSQL_ASSOC)) { 

            $variety_id   = $row['variety_id']; 

            echo ?>

            <option value="<?php $variety_id;?>">
            <?php echo $variety_id;?>
            </option>

            <?php
            ; }
            ?>

            </SELECT> 
```

然后我有点卡住了，无法理解它。这可以很好地显示品种的 id。但我想结束：

PRODUCE_NAME - VARIETY_NAME
PRODUCE_NAME - VARIETY_NAME
PRODUCE_NAME - VARIETY_NAME

在我的下拉列表中。

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T18:30:36.430

*   第一：在产品定义中添加对品种的引用。尝试填写 x 和 y 字段，然后建立您的关系：“产品属于 x 到 y 品种。”

如果 y > 1，您将必须创建一个表来链接概念，就像链接种植者和品种一样，否则将需要一个简单的外键。

*   第二：在您的选择中，根据您的要求，根据关系是在 FK 还是 TABLE 下表示，添加一个或 2 个连接。

# java - 在 Unix 机器上的 Java 程序中使用 FilenameFilter 时，收到 ClassNotFoundException

> ID：10742853
> 
> 赞同：0
> 
> 时间：2012-05-24T17:58:50.950
> 
> 标签：java

所以我有以下代码：

```
File txtFileDir = new File(MAIN_DIR + "test");
FilenameFilter filter = new FilenameFilter() {
    @Override
    public boolean accept(File dir, String name) {
        return name.endsWith(".txt");
    }
}; 
File[] txtFiles = txtFileDir.listFiles(filter); 
```

它在我使用安装了 Java 1.6 的 Windows 的开发机器上运行良好。但是，当我将类移植到将要运行的 unix 框并尝试运行它时，我在 FilenameFilter 行上得到一个 ClassNotFoundException。unix 盒子上也有 Java 1.6，所以我不知道问题出在哪里。这并不是什么大问题，因为有多种方法可以完成同样的事情，但我只是好奇是否有人对为什么它不能在 unix 机器上工作有任何想法。

我也尝试在 unix 机器上编译代码，以查看是否有任何区别，但没有。代码在 unix 机器上编译得很好，但我仍然收到同样的错误。有人有什么想法吗？

**更新**

我弄清楚了这个问题。显然，当我在其中编译包含该类的代码时，它创建了一个附加的 .class 文件，其中包含我的类的名称并在其上附加了 $1。所以我有Test.class 和Test$1.class。一旦我保留了 Test$1.class 文件，事情就会正常工作。我猜它需要第二个类文件，因为我创建了内部类？至少我认为这是一个内部阶级。

无论如何，谢谢大家的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T18:29:02.153

如评论中所述，您应该首先验证您使用的版本是否与另一台机器相同。检查路径中是否存在 FilenameFilter 的另一种方法是：

`javap java.io.FilenameFilter`

因此，如果上面的命令将 FilenameFilter 的类名和方法列出为

```
Compiled from "FilenameFilter.java"
public interface java.io.FilenameFilter{
    public abstract boolean accept(java.io.File, java.lang.String);
} 
```

那么 FilenameFilter 就在你的路径中，不需要担心版本。

但是，如果它给你错误，那么最简单的方法是复制`rt.jar`包含几乎所有（绝对必要的）类文件并将其替换为你现有的`rt.jar`，它可能存在`/usr/include/jvm/....`或者你可以`find`（不要忘记进行备份，你也可以通过提取并通过检查是否`FilenameFilter.class`存在）`rt.jar``java/io/`

# php - 如何指定 PHP Fog 上的 Git Push 使用哪个密钥文件？

> ID：10742854
> 
> 赞同：1
> 
> 时间：2012-05-24T17:58:59.800
> 
> 标签：php, git, ssh, phpfog

以下是我的 ~/.ssh/config 内容

```
ForwardAgent yes

# Default PHP Fog user (name)
Host phpfog
HostName git01.phpfog.com
User git
IdentityFile /Users/Pk_2/.ssh/id_rsa_phpfog

# Default github
Host github.com
User git
Hostname github.com
PreferredAuthentications publickey
IdentityFile /Users/Pk_2/.ssh/id_rsa 
```

但是当我尝试对 phpfog repo 文件夹执行 git push 时，它给了我

```
Permission denied(public key)
fatal:the  remote end hung up unexpectedly 
```

但除非我将 id_rsa_phpfog 重命名为 id_rsa，否则我无法推送到 phpfog。那么我可以指定密钥文件吗

PHPFog 配置 - [http://docs.phpfog.com/getting-started/ssh/](http://docs.phpfog.com/getting-started/ssh/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T01:31:49.250

Your project's .git/config may need to be edited to allow the origin to use the host you defined in the ~/.ssh/config

Edit your `< project folder >/.git/config` file

```
[remote "origin"]
    fetch = +refs/heads/*:refs/remotes/origin/*
    url = <ssh-config-host>:<app_name_here> 
```

If your apps name is www.example.com then the url line would look like:

```
url = phpfog:www.example.com 
```

**Alternatively** you could also re-clone your app using the host you defined:

```
git clone phpfog:www.example.com 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T18:06:02.960

在我的`~/.ssh/config`文件中，每个“主机”定义中都有一行：

```
IdentitiesOnly yes 
```

并且 git 可以为不同的主机使用不同的密钥愉快地工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T20:42:00.927

您可以使用：

```
ssh phpfog -vvv 
```

获取 ssh 在尝试连接时正在执行的操作的调试输出。如果您使用的是不同的密钥，您应该会看到类似

```
debug1: Reading configuration data /Users/<yourusername>/.ssh/config
debug1: Applying options for phpfog
debug1: Reading configuration data /etc/ssh_config
...
debug1: Offering RSA public key: /Users/<yourusername>/.ssh/id_rsa_phpfog
debug3: send_pubkey_test
debug2: we sent a publickey packet, wait for reply 
```

如果您没有看到任何提及`id_rsa_phpfog`您没有使用您在`.ssh/config`文件中定义的主机名或文件不在正确位置的信息。

如果一切看起来都正确，则很可能您在 phpfog 上添加的公钥不正确（与您自己的公钥不完全匹配）

# java - 多线程应用程序中编译时和运行时之间类路径不匹配的原因是什么？

> ID：10742857
> 
> 赞同：3
> 
> 时间：2012-05-24T17:59:08.007
> 
> 标签：java, multithreading, swing, classpath

我正在编写一个 Swing 桌面应用程序。我使用以下方法编译我的程序：

> C:\MyJavaPrograms\src>"C:\Program Files\Java\jdk1.7.0_04\bin\javac" SVNTool.java -cp ".;C:\parsers\commons\commons-lang-2.4.jar;C: \parsers\svnkit-1.7.4-v1\lib\svnkit-cli-1.7.4-v1.jar;C:\parsers\svnkit-1.7.4-v1\lib\svnkit-1.7.4-v1.jar"

我使用以下方法调用我的程序：

> C:\MyJavaPrograms\src>"C:\Program Files\Java\jdk1.7.0_04\bin\java" SVNTool -cp ".;C:\parsers\commons\commons-lang-2.4.jar;C:\parsers \svnkit-1.7.4-v1\lib\svnkit-cli-1.7.4-v1.jar;C:\parsers\svnkit-1.7.4-v1\lib\svnkit-1.7.4-v1.jar"

它编译得很好。它开始很好。但是当我单击该按钮时，它会创建一个 SwingWorker 线程，但该线程因 NoClassDefFoundError 而失败。

我已经搜索了网络，并且能够通过使用以下方法将一些 jar 文件添加到 CLASSPATH 环境变量中来解决该问题：

> C:\MyJavaPrograms\src>set CLASSPATH=%CLASSPATH%;C:\parsers\svnkit-1.7.4-v1\lib\svnkit-1.7.4-v1.jar;C:\parsers\svnkit-1.7.4- v1\lib\svnkit-cli-1.7.4-v1.jar;C:\parsers\commons\commons-lang-2.4.jar

那么，是什么导致了多线程 Swing 应用程序中编译时和运行时之间的类路径不匹配？有没有办法让线程可以使用所有环境变量和命令行选项？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-24T18:06:34.523

线程与您的问题无关。假设您在源文件中使用`Foo`库中的类。`A.jar`要编译您的类，您需要`A.jar`在类路径中，以便编译器能够了解`Foo`、其方法、字段等。但是如果 的代码`Foo`依赖于 中的另一个类`Bar`，`B.jar`您还需要`B.jar`在运行时类路径中。

简而言之，只需要类路径中的直接依赖即可编译。但是你需要类路径中的所有传递依赖来运行程序。

你不应该弄乱 CLASSPATH 环境变量。始终使用 -cp 选项来设置程序的类路径。

# streaming - 使用 mjpg-streamer 以高于 640x480 的分辨率捕获图像

> ID：10742867
> 
> 赞同：2
> 
> 时间：2012-05-24T18:00:12.173
> 
> 标签：streaming, webcam, resolution, beagleboard, mjpeg

我在 BeagleBone 上的 Angstrom Linux 上使用[mjpg-streamer](http://sourceforge.net/apps/mediawiki/mjpg-streamer/)，并且能够从流中捕获图像。但是，我似乎无法使分辨率超过 640x480。当我尝试设置该选项时，结果显示它以我选择的分辨率流式传输，但该软件实际上并没有保存任何图像。

例如，这有效：

```
# ./mjpg_streamer -i "./input_uvc.so -d /dev/video0 -r 640x480 -yuv -n -f 1 -q 80" -o "./output_file.so -f ./tests/ -d 5000"
MJPG Streamer Version: svn rev: 
 i: Using V4L2 device.: /dev/video0
 i: Desired Resolution: 640 x 480
 i: Frames Per Second.: 1
 i: Format............: YUV
 i: JPEG Quality......: 80
 o: output folder.....: ./tests
 o: input plugin.....: 0: ./input_uvc.so
 o: delay after save..: 5000
 o: ringbuffer size...: no ringbuffer
 o: command...........: disabled 
```

虽然这不会：

```
# ./mjpg_streamer -i "./input_uvc.so -d /dev/video0 -r 1280x720 -yuv -n -f 1 -q 80" -o "./output_file.so -f ./tests/ -d 5000"
MJPG Streamer Version: svn rev: 
 i: Using V4L2 device.: /dev/video0
 i: Desired Resolution: 1280 x 720
 i: Frames Per Second.: 1
 i: Format............: YUV
 i: JPEG Quality......: 80
 o: output folder.....: ./tests
 o: input plugin.....: 0: ./input_uvc.so
 o: delay after save..: 5000
 o: ringbuffer size...: no ringbuffer
 o: command...........: disabled 
```

我成功地将分辨率更改为*低于*默认值。

```
# ./mjpg_streamer -i "./input_uvc.so -d /dev/video0 -r 320x240 -yuv -n -f 1 -q 80" -o "./output_file.so -f ./tests/ -d 5000"
MJPG Streamer Version: svn rev: 
 i: Using V4L2 device.: /dev/video0
 i: Desired Resolution: 320 x 240
 i: Frames Per Second.: 1
 i: Format............: YUV
 i: JPEG Quality......: 80
 o: output folder.....: ./tests
 o: input plugin.....: 0: ./input_uvc.so
 o: delay after save..: 5000
 o: ringbuffer size...: no ringbuffer
 o: command...........: disabled 
```

我试过玩帧率无济于事。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-27T06:14:36.977

我之前遇到过同样的问题（但我使用的是Raspberry pi），只需调整目标文件夹的权限即可。我在文件夹 777 上设置了权限，只是为了测试目的，我运行了一个与您使用的命令类似的命令`./mjpg_streamer -i "input_uvc.so -y --device /dev/video0" -o "output_file.so -f /home/pi/images -d 1500"`

它就像一个魅力

PS不太确定为什么它仍然显示：`o: ringbuffer size...: no ringbuffer`..但它有效！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-09-10T17:36:17.747

对我来说，解决方案很简单——根本不指定帧速率，只指定分辨率。它开始起作用了。

# jquery - 触摸事件的问题

> ID：10742872
> 
> 赞同：0
> 
> 时间：2012-05-24T18:00:33.013
> 
> 标签：jquery, ipad

我试图在我的网站上使用播放器（我没有编码）。无论如何，播放器内置了一些触摸事件，当我尝试使用 ipad 测试它们时似乎没有响应。音量滑块应该能够左右拖动，音乐流应该能够做同样的事情，但目前它们不起作用。

```
 // seeking in the loaded track buffer
  $('.sc-time-span')
    .live('click', function(event) {
      scrub(this, event.pageX);
      return false;
    })
    .live('touchstart', function(event) {
      this.addEventListener('touchmove', onTouchMove, false);
      event.originalEvent.preventDefault();
    })
    .live('touchend', function(event) {
      this.removeEventListener('touchmove', onTouchMove, false);
      event.originalEvent.preventDefault();
    });

  // changing volume in the player
  var startVolumeTracking = function(node, startEvent) {
    var $node = $(node),
        originX = $node.offset().left,
        originWidth = $node.width(),
        getVolume = function(x) {
          return Math.floor(((x - originX)/originWidth)*100);
        },
        update = function(event) {
          $doc.trigger({type: 'scPlayer:onVolumeChange', volume: getVolume(event.pageX)});
        };
    $node.bind('mousemove.sc-player', update);
    update(startEvent);
  };

  var stopVolumeTracking = function(node, event) {
    $(node).unbind('mousemove.sc-player');
  };

  $('.sc-volume-slider')
    .live('mousedown', function(event) {
      startVolumeTracking(this, event);
    })
    .live('mouseup', function(event) {
      stopVolumeTracking(this, event);
    });

  $doc.bind('scPlayer:onVolumeChange', function(event) {
    $('span.sc-volume-status').css({width: event.volume + '%'});
  }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T18:10:29.780

我猜是因为您使用的是 jQuery 的 live() 绑定，但它可能依赖于 jQuery UI 触摸事件插件来工作。如果您包含来自[http://touchpunch.furf.com/](http://touchpunch.furf.com/)的插件，它可能会解决您的问题。

# visual-c++ - 在 Visual C++ Express 2010 中调试期间写入日志

> ID：10742878
> 
> 赞同：-1
> 
> 时间：2012-05-24T18:00:49.883
> 
> 标签：visual-c++, ide

我正在 Visual C++ Express 2010 中开发一个 GUI 项目。现在正在处理这些类，并测试它们我不想已经开始在 GUI 中工作。有没有办法将一些调试输出发送到日志文件或调试器输出窗口？

最近在 Appcelerator 的 Titanium 中做了很多工作，您可以使用`Ti.API.info()`它向自己发送一些信息，以查看应用程序的行为。Visual C++ 也有一些东西吗？

谢谢！彼得

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T18:21:43.533

您可以使用`TRACE` [宏](http://msdn.microsoft.com/en-us/library/6w95a4ha.aspx)- 它们会将输出发送到调试输出窗口。您还可以使用 [DebugView在不运行调试器的情况下查看跟踪消息](http://technet.microsoft.com/en-us/sysinternals/bb896647)

有关可用调试/跟踪技术的概述，另请参阅[this 。](http://msdn.microsoft.com/en-us/library/7sx52ww7.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T22:17:39.730

使用 TRACE 作为关键字，对 Google 进行了一些研究。最后得到[了](http://support.microsoft.com/kb/815787)一个完全符合我要求的解决方案。

```
using namespace System::Diagnostics;
Debug::WriteLine("This will be written to debug output"); 
```

现在，开始调试，转到“输出”窗口中的“输出”选项卡并显示“调试”的输出。然后它会给你我正在寻找的消息。我`Debug::WriteLine`在这里需要的也是如此。

# c#-4.0 - 如何在 Windows 2003 任务计划程序中为任务创建无限期

> ID：10742880
> 
> 赞同：2
> 
> 时间：2012-05-24T18:00:57.923
> 
> 标签：c#-4.0, scheduled-tasks, windows-2003-webserver

我正在尝试创建无限期的任务。在 Windows Server 2008 上，如果我不指定持续时间，则假定持续时间是无限的。但是，在 Windows Server 2003 上，必须指定持续时间（并且等于或大于间隔）。目前，如果要重复很长时间，我只是将任务设置为持续一年。

**有没有办法在 Windows Server 2003 上指定无限期的持续时间？**

```
if (m_TimeInterval.m_Expire.Year < 2099) //xp and win7 max year is 2099
    tTrigger.Repetition.Duration = m_TimeInterval.getDuration();
else if (!newVer) tTrigger.Repetition.Duration = m_TimeInterval.getInterval().Add(TimeSpan.FromDays(365));
tTrigger.Repetition.Interval = m_TimeInterval.getInterval();
tTrigger.Repetition.StopAtDurationEnd = true; 
```

笔记：

*   我正在使用 Task Scheduler API 添加这些任务定义。
*   使用 TimeSpan 设置间隔和持续时间。
*   `newVer`是错误的，因为我使用的是 Task Scheduler 1.1 而不是 1.2 或更高版本
*   `tTrigger`属于 TimeTrigger 类型

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-07-30T20:50:21.537

我最终使用 1-1-2099 作为“无限期”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-11-12T10:54:49.663

您也可以使用`TimeSpan.Zero`which 使任务无限。

下面是一个简短的代码片段来演示如何在 Trigger 上使用它：

```
Trigger triggerTask = Trigger.CreateTrigger(TaskTriggerType.Time);
triggerTask.StartBoundary = DateTime.Now.AddMinutes(3);
triggerTask.SetRepetition(new TimeSpan(0, 3, 0, 0, 0), TimeSpan.Zero); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T22:42:39.753

你可以使用[Duration.Forever.TimeSpan](http://msdn.microsoft.com/en-us/library/system.windows.duration.forever.aspx)吗？

# php - call_user_func_array() 中的日志记录错误

> ID：10742881
> 
> 赞同：3
> 
> 时间：2012-05-24T18:00:58.427
> 
> 标签：php, command-line-interface

如何记录 call_user_func_array 中发生的致命错误？它在作为守护进程运行的 CLI 脚本中。我想在发生错误时进行记录，但它总是会返回错误消息。

我尝试过但无法使其工作的事情：

```
try {call_user_func_array()} catch (Exception $e ) {do_log} 
```

或者

```
ob_start ();
try {call_user_func_array()} catch (Exception $e ) {do_log} 
```

或者

```
register_shutdown_function('shutdownFunction'); 
```

或者

```
ini_set('error_log',$baseDir.'/Jobque_error.log');
fclose(STDIN);
fclose(STDOUT);
fclose(STDERR);
$STDIN = fopen('/dev/null', 'r');
$STDOUT = fopen($baseDir.'/Jobque_application.log', 'ab');
$STDERR = fopen($baseDir.'/Jobque_daemon.log', 'ab'); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T18:07:25.783

您无法捕获致命错误。这是致命的，所以你的脚本死了，你无能为力。

实际上，通过注册的函数`register_shutdown_handler`仍然会执行，但你无法获得回溯等，所以这没什么用。

致命错误的唯一可能记录是通过`log_errors`php.ini 设置。

# c# - 如何将我们在控制台窗口上的操作保存到文本文件中？

> ID：10742884
> 
> 赞同：6
> 
> 时间：2012-05-24T18:01:08.083
> 
> 标签：c#, visual-studio-2010

如果我们编译以下代码并运行生成的应用程序，我们将通过输入我们的名称、按 enter 并按任意键退出来与之交互。所有这些操作都在控制台窗口上完成。

```
using System;

namespace HelloWorld
{
    class Program
    {

        static void Main(string[] args)
        {
            Console.Write("Enter your name: ");
            var name = Console.ReadLine();
            Console.WriteLine("Your name is {0} ", name);
            Console.ReadKey();

        }
    }
} 
```

是否可以将所有这些操作保存到文本文件中，以便我可以将其用作日志？

编辑：

我应该解释一下真实情况。我正在写一本关于 C# 的书。我想避免将控制台窗口的屏幕截图附加到书中，因为我想让我的书的文件大小尽可能小。相反，我想将显示控制台窗口内容的文本文件附加到书中。添加额外的代码（用于创建文本文件）会使代码示例复杂化，进而使读者感到困惑。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T18:29:49.520

好的，所以这里的想法是更改控制台输入和输出的读取器/写入器，以执行它们之前所做的操作，同时写入日志文件。我创建了一个 Log 类，它可能应该被扩展以便将文件名/路径作为参数，但重要的是要有一个这样才能同步输出流。

```
public class Log
{
    private StreamWriter output;
    public Log()
    {
        output = new StreamWriter(File.OpenWrite("output.txt"));

    }
    public void Write(char c)
    {
        lock (output)
        {
            output.Write(c);
        }
    }
    public void Close()
    {
        output.Close();
    }
}

public class MyConsoleOutput : TextWriter
{
    private TextWriter standard;
    private Log log;

    public MyConsoleOutput(TextWriter standard, Log log)
    {
        this.standard = standard;
        this.log = log;
    }

    public override void Write(char value)
    {
        standard.Write(value);
        log.Write(value);
    }

    public override Encoding Encoding
    {
        get { return Encoding.Default; }
    }

    protected override void Dispose(bool disposing)
    {
        standard.Dispose();
    }
}

public class MyConsoleInput : TextReader
{
    private TextReader standard;
    private Log log;
    public MyConsoleInput(TextReader standard, Log log)
    {
        this.standard = standard;
        this.log = log;
    }

    public override int Peek()
    {
        return standard.Peek();
    }

    public override int Read()
    {
        int result = standard.Read();
        log.Write((char)result);
        return result;
    }
    protected override void Dispose(bool disposing)
    {
        standard.Dispose();
    }
} 
```

现在我们已经创建了这些类，我们将在开始时执行以下操作`Main`：

```
Log log = new Log();
Console.SetOut(new MyConsoleOutput(Console.Out, log));
Console.SetIn(new MyConsoleInput(Console.In, log)); 
```

我们在结尾处也需要这个`Main`：

```
log.Close(); 
```

这是一个有点快速和肮脏的写作。如果您在生产中使用它，您可能需要更改很多类/方法名称。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T18:02:21.530

没有什么会自动“隐藏”您的控制台 IO，因此您必须自己执行此操作。话虽这么说，打开一个文本文件并写任何你想要的东西是相当容易的。

在您的情况下，只需打开一个文本文件，并在您写入控制台并根据需要从控制台读取时将信息写入其中。有关详细信息，请参阅 MSDN 的[如何：写入文本文件](http://msdn.microsoft.com/en-us/library/8bh11f1k.aspx)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T18:03:24.120

您可以使用 a`StreamWriter`输出您通过以下方式捕获的内容`Console`：

```
using (System.IO.StreamWriter file = new System.IO.StreamWriter(@"C:\ProgramOutput.txt", true))
        {
            file.WriteLine(name);
        } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-24T18:25:54.213

这个例子可以帮助你：

```
Console.WriteLine("Hello World");
FileStream fs = new FileStream("Test.txt", FileMode.Create);
// First, save the standard output.
TextWriter tmp = Console.Out;
StreamWriter sw = new StreamWriter(fs);
Console.SetOut(sw);
Console.WriteLine("Hello file");
Console.SetOut(tmp);
Console.WriteLine("Hello World");
sw.Close(); 
```

阅读更多： http: [//msdn.microsoft.com/ru-ru/library/system.console.setin.aspx，http](http://msdn.microsoft.com/ru-ru/library/system.console.setin.aspx) : [//msdn.microsoft.com/ru-ru/library/system.console.setout。 aspx](http://msdn.microsoft.com/ru-ru/library/system.console.setout.aspx)， http: [//msdn.microsoft.com/en-us/library/system.console.in.aspx，http](http://msdn.microsoft.com/en-us/library/system.console.in.aspx) : [//msdn.microsoft.com/ru-ru/library/system.console.out.aspx](http://msdn.microsoft.com/ru-ru/library/system.console.out.aspx)

# objective-c - 从异步代码块返回 NSDictionary？

> ID：10742885
> 
> 赞同：1
> 
> 时间：2012-05-24T18:01:20.450
> 
> 标签：objective-c, ios5, twitter, nsurlrequest

> **可能重复：**
> [从块返回 UIImage](https://stackoverflow.com/questions/9474018/returning-uiimage-from-block)

嗨，我正在尝试返回 json twitter 数据的字典，以便我可以在我的应用程序中使用它。如何从异步块中调用它。我无法保存或返回任何想法？

```
 -(NSDictionary *)TweetFetcher
    {

    TWRequest *request = [[TWRequest alloc] initWithURL:
                          [NSURL URLWithString: @"http://search.twitter.com/search.json?
    q=iOS%205&rpp=5&with_twitter_user_id=true&result_type=recent"] parameters:nil 
    requestMethod:TWRequestMethodGET];

    [request performRequestWithHandler:^(NSData *responseData, NSHTTPURLResponse 
    *urlResponse, 
    NSError *error)
     {
         if ([urlResponse statusCode] == 200) 
         {
             NSError *error;        
             NSDictionary *dict = [NSJSONSerialization JSONObjectWithData:responseData 
             options:0 error:&error];

             //resultsArray return an array [of dicitionaries<tweets>];
             NSArray* resultsArray = [dict objectForKey:@"results"]; 
             for (NSDictionary* internalDict in resultsArray)

                 NSLog([NSString stringWithFormat:@"%@", [internalDict 
             objectForKey:@"from_user_name"]]);
        ----> return dict; // i need this dictionary of json twitter data
         }
         else
             NSLog(@"Twitter error, HTTP response: %i", [urlResponse statusCode]);
         }];
      } 
```

提前谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T19:10:22.387

我觉得我最近写了很多这样的异步代码。

```
- (void)tweetFetcherWithCompletion:(void(^)(NSDictionary *dict, NSError *error))completion
{
    NSURL *URL = [NSURL URLWithString:@"http://search.twitter.com/search.json?q=iOS%205&rpp=5&with_twitter_user_id=true&result_type=recent"];
    TWRequest *request = [[TWRequest alloc] initWithURL:URL parameters:nil requestMethod:TWRequestMethodGET];

    [request performRequestWithHandler:^(NSData *responseData, NSHTTPURLResponse *urlResponse, NSError *error) {
        if ([urlResponse statusCode] == 200) {
            NSError *error;
            NSDictionary *dict = [NSJSONSerialization JSONObjectWithData:responseData options:0 error:&error];

            if (error) {
                completion(nil, error);
                return;
            }

            //resultsArray return an array [of dicitionaries<tweets>];
            NSArray* resultsArray = [dict objectForKey:@"results"]; 
            for (NSDictionary* internalDict in resultsArray)
                NSLog(@"%@", [internalDict objectForKey:@"from_user_name"]);

            completion(dict, nil);
        }
        else {
            NSLog(@"Twitter error, HTTP response: %i", [urlResponse statusCode]);
            completion(nil, error);
        }
    }];
} 
```

因此，`self.tweetDict = [self TweetFetcher];`您可以这样称呼它，而不是调用 。

```
[self tweetFetcherWithCompletion:^(NSDictionary *dict, NSError *error) {
    if (error) {
        // Handle Error Somehow
    }

    self.tweetDict = dict;
    // Everything else you need to do with the dictionary.
}]; 
```

# blackberry - 黑莓 - 音量节省问题

> ID：10742888
> 
> 赞同：0
> 
> 时间：2012-05-24T18:01:23.390
> 
> 标签：blackberry, volume

我面临在持久性内存上存储音量级别的问题。我正在使用以下代码：

```
int _currentVolume = 50; 
```

设置播放器音量的代码：

```
volumeControl = (VolumeControl) _player.getControl("VolumeControl");
volumeControl.setLevel(_currentVolume);
setVolume(_currentVolume); 
```

存储卷的代码：

```
public void Save() {
    StoreInfo info = new StoreInfo();
    info.setElement(StoreInfo.VOL2, String.valueOf(volumeControl.getLevel()));

    _data.addElement(info); 
    synchronized (store) { 
        store.setContents(_data); 
        store.commit(); 
    }
}

public void Get() { 
    synchronized (store) { 
        _data = (Vector) store.getContents(); 

        if (!_data.isEmpty()) { 
            StoreInfo info = (StoreInfo) _data.lastElement();   
        }   
    } 
} 
```

但是代码不起作用:(。在这个问题上需要一些帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T19:29:04.407

我看不到你在哪里申请`Integer.parseInt((String)StoreInfo.getElement(StoreInfo.VOL2))`你的`_currentVolume`.

# android - WebView.requestFocusNodeHref (Message hrefMsg) 中的消息是什么？

> ID：10742896
> 
> 赞同：1
> 
> 时间：2012-05-24T18:02:02.593
> 
> 标签：android

我正在尝试获取用户在`WebView`. 我使用[`getHitTestResult()`](http://developer.android.com/reference/android/webkit/WebView.html#getHitTestResult%28%29)但我需要处理`getHitTestResult()`return的情况`UNKNOWN_TYPE`。

文档建议[`requestFocusNodeHref (Message hrefMsg)`](http://developer.android.com/reference/android/webkit/WebView.html#requestFocusNodeHref%28android.os.Message%29)但我不明白[Message](http://developer.android.com/reference/android/os/Message.html)应该是什么。

谢谢你的任何想法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-08T14:53:56.780

在这里回答我自己的问题。这就是它的工作原理。有问题的消息必须发送到`Handler`将处理请求的人。

```
/*
 * Used to get the result of requestFocusNodeHref(msg)
 */
class MyHandler extends Handler{
    @Override
    public void handleMessage(Message msg) {
        super.handleMessage(msg);
        String src = msg.getData().getString("src");
        launchImageSaveAs(src);
        }
    } 
```

然后，在您的代码中的某处，例如在`OnLongClickListener`您创建一条新消息并将处理程序设置为目标并最后调用`requestFocusNodeHref`

```
if(result.getType() == HitTestResult.UNKNOWN_TYPE){
    Message msg = new Message();
    msg.setTarget(new MyHandler());
    webview.requestFocusNodeHref(msg);
} 
```

# jquery - 带有 jqTree 的 Ajax 树

> ID：10742898
> 
> 赞同：0
> 
> 时间：2012-05-24T18:02:05.807
> 
> 标签：jquery, ruby-on-rails, ajax

我正在使用 jqTree 将 json 数据转换为易于查看的树。我想一次加载一级树节点，因此页面加载会更快，并且仅在需要时才访问节点。但是，当我将深度 0 的节点发送到 jqTree 时，不会出现展开图标。

如何在不一次发送整批数据的情况下实现这棵树？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T12:51:08.563

除非您对咖啡/javascript 进行一些更改，否则我认为您不能使用 jqTree。看看我在 github 上的 fork：

[https://github.com/dougnorton/jqTree](https://github.com/dougnorton/jqTree)

看看 demo2.html 页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T19:00:31.923

jqtree的*dev*分支包含一个用于加载子树的新功能。函数**loadData**现在接受**parent_node**参数。

`$tree.tree('loadData', data, parent_node);`

另请参阅[https://github.com/mbraak/jqTree/issues/10](https://github.com/mbraak/jqTree/issues/10)

# javascript - 用户登录后如何刷新 Facebook 窗口

> ID：10742900
> 
> 赞同：0
> 
> 时间：2012-05-24T18:02:14.807
> 
> 标签：javascript, facebook, asp.net-mvc-3, facebook-graph-api

如果用户登录到 Facebook，我的 MVC 应用程序首先被检测到：\

```
function isLoggedIn(callback, param1) {
    window.FB.getLoginStatus(function (response) {
        if (response.status === 'connected') {
            updateUser(response.authResponse);
            callback(param1);
        } else {
            login(callback, param1);
        }
    });
} 
```

如果用户未连接，我使用此功能登录：

```
function login(callback, success) {
    window.FB.login(function (response) {
        if (response.authResponse) {
            updateUser(response.authResponse, callback, success);
            callback(success);
        } else {
            callback(null);
        }
    });
} 
```

此外，我还订阅了更改状态：

```
FB.Event.subscribe('auth.authResponseChange', function (response) {
        if (response.status === 'connected') {
            top.location.href = top.location.href;
          //window.location.reload();
        }
        if (response.status != 'connected' && response.status != 'not_authorized') {
            updateUser(null);
        }
    }); 
```

我必须在用户登录后刷新页面才能在服务器上获取 FacebookSignedRequest。

top.location.href = top.location.href 和 window.location.reload() 不起作用...任何建议:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T18:05:23.567

`location.reload()`确实有效。

如果不是，则代码永远不会执行，或者您在`location`某处覆盖了全局变量。

# knockout.js - 如何在嵌套绑定中获取父模板绑定值？

> ID：10742901
> 
> 赞同：3
> 
> 时间：2012-05-24T18:02:15.057
> 
> 标签：knockout.js

我有一个像这样的淘汰赛模板：

```
<script type="text/html" id="list">
  <ul data-bind="foreach: items">
    <li data-bind="{text: name}"></li>
  </ul>
</script> 
```

我这样使用：

```
<div data-bind="
  template: {name: 'list', data: itemList}, 
  myBinding: {itemType: 'foo'}
"></div> 
```

我有一个`myBinding`自定义绑定处理程序：

```
ko.bindingHandlers.myBinding = {
  init: function(element, valueAccessor) {
    var bindingValue = valueAccessor();

    alert ( bindingValue.itemType );  // alerts "foo"

    // now set up a jQuery click handler
    $(element).on("click", "li", listItemClickHandler);
  }
}; 
```

和一个事件处理程序：

```
function listItemClickHandler() {
  var bindingContext = ko.contextFor(this);

  alert( "bindingValue.itemType ???" );
}); 
```

**有没有办法`itemType`通过敲除在点击处理程序中获取自定义绑定中提供的父模板`bindingContext`？**

*   `.type-foo`无需添加一些虚假的CSS 类`<ul>`（这就是我现在所做的）。
*   期间不存储`"foo"`在数组项中`myBinding.init()`。
*   无需内联事件处理程序以利用闭包变量 ( `bindingValue`)。
*   不使用 jQuery 的`event.data`工具。我可以这样做，但我想从淘汰赛的绑定上下文中检索它，除非那是不可能的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-25T03:11:21.343

绑定上下文作为绑定的第 5 个参数传入。因此，您可以在自定义绑定中增加绑定上下文，例如`context.$itemType = bindingValue.itemType;`. 示例：http: [//jsfiddle.net/rniemeyer/yeN8P/](http://jsfiddle.net/rniemeyer/yeN8P/)

另一种选择是确保您`itemType`在`$parent`数据中可用。您可以通过将数据传递给您的模板来做到这一点，例如：

`template: {name: 'list', data: { items: items, itemType: 'foo' } }`

`items`所以，现在我们不只是传递，而是传递`items`and `itemType`，因此其中一个孩子`$parent.itemType`将包含“foo”。

示例：http: [//jsfiddle.net/rniemeyer/yeN8P/1/](http://jsfiddle.net/rniemeyer/yeN8P/1/)

# node.js - 将 express 与需要数据的第二个 div 一起使用的正确方法是什么

> ID：10742902
> 
> 赞同：1
> 
> 时间：2012-05-24T18:02:16.353
> 
> 标签：node.js, express, pug

我有以下 layout.jade 文件：

```
!!! 5
html
    head
    body
        #left
            #leftbody
        #center
            #centerbody
                #container!= body
        #right
            #rightbody 
```

我有以下 route.js 文件：

```
app.get('/',
    function(req, res) {
        Post.find({}).execFind(
            function(err, data) {
                res.render('post/index', {
                    posts: data
                });
        });
}); 
```

我目前正在`#centerbody`基于`#leftbody`. 我想知道如何使用 express 来填充`#rightbody`. 目前我正在使用 ajax 调用填充一个 in`ul`但想知道是否有另一种使用 express 的方法。`#rightbody``document.ready`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T07:53:46.670

我强烈建议您看一下 Jade[包含](https://github.com/visionmedia/jade/blob/master/Readme.md#includes)，或者更好的是 Jade[模板继承](https://github.com/visionmedia/jade/blob/master/Readme.md#template-inheritance)

这将允许您将所有页面的公共部分保存在单独的文件中。并允许更轻松的维护。这绝对是要做的事情。

# .net - .NET 的 U2 工具包 - 实体框架示例“EntityFramework_CodeFirst”不起作用

> ID：10742907
> 
> 赞同：1
> 
> 时间：2012-05-24T18:02:31.797
> 
> 标签：.net, u2, universe, unidata, u2netdk

当我们尝试运行“EntityFramework_CodeFirst”和“EntityFramework_CodeFirst2”示例时，我们收到以下错误：

**无法确定“U2.Data.Client.U2Connection”类型连接的提供者名称**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T19:59:28.497

我想自己回答这个问题。您需要正确版本的 Entity Framework 4.1。如果您使用的是旧版本（程序集文件版本 4.1.10331.0），您将看到此问题。您需要安装 Entity Framework 4.1 Update 1（程序集文件版本 4.1.10715.0）请参阅此链接：[http ://www.ladislavmrnka.com/2011/08/problems-with-entity-framework-4-1-update-1 /](http://www.ladislavmrnka.com/2011/08/problems-with-entity-framework-4-1-update-1/)

# android - startactivityforresult 和 contextmenu 更改后刷新活动

> ID：10742909
> 
> 赞同：0
> 
> 时间：2012-05-24T18:02:40.017
> 
> 标签：android, android-activity

我正在尝试使用 startactivityforresult() 使用联系人选择器，并希望在恢复活动后刷新我的设置页面，该页面显示数据库中的选定联系人。因此，我的 onResume() 与 onCreate() 完全相同。所以我将我的 onCreate 代码原样复制到覆盖的 onResume() 中。

我面临两个问题 - 1\. listview 详细信息被复制 2\. refresh 方法在本质上似乎非常多余

有人可以建议我刷新我的活动的好方法。我还想在使用 contextmenu 删除列表视图项后刷新 - 即使重复的 onResume() 似乎也不会发生。

编辑： - 一些澄清

在选择联系人 1 时，列表显示两个项目联系人 1 和联系人 1，尽管 db 有一个联系人 1 的非重复条目（列表视图旨在显示已复制到数据库的联系人的名称）。

当活动开始时，列表视图由显示已添加联系人名称的数据库填充。游标接收 db 列并以编程方式填充列表视图。我希望每次更改数据库时都会发生这种情况-通过长按上下文菜单添加新联系人或删除联系人。

冗余是除了简单地将与 onCreate 相同的代码复制到 onResume 之外，还有其他方法（更简洁）。

```
 @Override
    protected void onResume() {
        super.onResume();

           setContentView(R.layout.setting);
           TabHost th = (TabHost)findViewById(R.id.tabhost);
           th.setup();

           spec1 = th.newTabSpec("tag1");
           spec1.setIndicator("CONTACTS");

           try {

               db = this.openOrCreateDatabase("App_Database",MODE_PRIVATE , null);
               Cursor cur = db.rawQuery("SELECT NAME FROM Contacts_Table",null);    
               cur.moveToFirst();    
               String first = cur.getString(cur.getColumnIndex("NAME"));
               if(cur.isNull(cur.getColumnIndex("NAME")) || first.equals(null) ){
                     setAddContactTab();     
                    }

               else{ 
                      Log.e("first name" , first);
                      populateContactsList();

                   }

              }catch(SQLiteException e){

                  setAddContactTab();

              }

           th.addTab(spec1);

           TabSpec spec2 = th.newTabSpec("tag2");
           spec2.setContent(R.id.tab2);
           ListView lv = (ListView) findViewById(R.id.variable_list);  
           lv.setAdapter(new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1, getResources().getStringArray(R.array.variables)));
           spec2.setIndicator("VARIABLES");
           th.addTab(spec2);

           TabSpec spec3 = th.newTabSpec("tag3");
           spec3.setContent(R.id.tab3);
           et = (EditText) findViewById(R.id.webaddress);
           SharedPreferences webad = getSharedPreferences(filename,0);
           et.setText(webad.getString("tvalue",""));   
           spec3.setIndicator("WEBSITE");
           th.addTab(spec3);

    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T20:14:58.640

仅在 onResume 中创建列表，每次都会调用它，即使在初始启动时也是如此。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T18:16:49.237

您是否尝试过在方法返回后使用[invalidate() ？](http://developer.android.com/reference/android/view/View.html#invalidate%28%29)

```
ViewGroup vg = findViewById (R.id.mainLayout);
vg.invalidate(); 
```

# python - 循环和 raw_input 同时？

> ID：10742911
> 
> 赞同：0
> 
> 时间：2012-05-24T18:02:51.687
> 
> 标签：python

我正在制作一个程序，它既可以监听来自循环 raw_input 的命令，又可以反复检查文件是否有更新。有没有办法做到这一点？基本上，有一个`time.sleep(1)`用于检查文件的循环和一个带有`raw_input`. 多处理似乎不是我需要的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T18:35:26.663

所以看起来答案是“线程”。似乎很有希望。

# android - 支持多种屏幕尺寸 - 以编程方式确定

> ID：10742920
> 
> 赞同：0
> 
> 时间：2012-05-24T18:03:35.970
> 
> 标签：android

所以我通过Android上的这个部分创建了我的布局：http: [//developer.android.com/guide/practices/screens_support.html](http://developer.android.com/guide/practices/screens_support.html)

由于额外的屏幕空间，sw720dp 具有标准甚至 sw600dp 不包括的几个对象，因此会出现此问题。不同的布局都正确加载，但是当我实际处理活动时，我不知道如何确定正在使用哪些布局（所以我无法挂钩额外的按钮等）。确定这一点的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T18:05:14.690

最简单的方法是`findViewById`在连接 UI 元素之前检查是否返回非空值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-24T18:05:22.833

我通常使用`Button b = (Button)findViewById(R.id.btn);`then 检查按钮是否为空，如果为空则表示它不存在并且我无法使用它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-24T18:29:53.703

[来自关于多屏幕设计](http://developer.android.com/training/multiscreen/screensizes.html#TaskUseOriQuali)的 Android 培训课程。

在 res/values/layout.xml res/values-sw600dp/layout.xml、res/values-sw720dp/layout.xml 等中定义一个值，它只设置一个布尔值“hasExtraStuff”。该值将根据加载的布局文件夹（就像您的布局一样）而变化，您可以在应用程序运行开始时检查该值一次。

# grails - Grails 控制器没有将错误传递给 gsp 页面

> ID：10742925
> 
> 赞同：1
> 
> 时间：2012-05-24T18:03:55.163
> 
> 标签：grails, groovy

不知道我在这里做错了什么。我希望它是微妙的。我似乎无法将错误传递给我的 gsp 页面。我的控制器中有以下代码：

```
def submit = {
    if (params) { // if there are parameters
        def sampleInstance = new Sample(params)// new sample
        if (sample.validate()) { // try to validate
            sample.save()
            flash.message = "Successfully Entered Sample"
            redirect ( action: 'sample' )
        }else{
            flash.message = "Error Entering Sample"
            sampleInstance.errors.each {
                println it
            }
            redirect ( action: 'sample', model:[sampleInstance:sampleInstance])
        }
    } 
} 
```

我已经验证 params 不为空。验证失败会创建 hasErrors() ，它也已经过验证，并且代码`sample.errors.each {println it}`会按照我的预期通知我正确的字段错误。但是我的重定向语法可能有问题？因为这`flash.message`将起作用，但我无法访问`model:[sampleInstance:sampleInstance]`地图并且没有呈现错误。

这是我的 gsp 中的代码：

```
 <g:hasErrors>
        <div class="errors">
         <g:renderErrors bean="${sampleInstance}" as="list" />
        </div>

     </g:hasErrors> 
```

我的控制器叫SubmitSampleController，动作叫submit，gsp页面叫sample.gsp。

这可能是我的问题的答案：我有另一个名为示例的操作，也许我需要在示例操作中执行我的所有逻辑，而不是在提交操作中？或者有没有办法将模型从一个动作传递到同一个控制器内的另一个动作？我有一种感觉，我的原始模型正在丢失。

```
def sample(){
    def now = new Date()// today's date
    def today = com.Sample.findAllBySampleReceivedDateGreaterThanEquals(now.clearTime())// finds all samples submitted today
   [checkDate:today, date: now] // passes a map of checkDate and todays date to the sample.gsp page
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T19:12:01.140

在重定向中，模型用作查询参数，这与渲染不同，后者执行实际转发并将对象置于请求范围内。如果出现错误，您需要做的是**渲染**视图并传递模型。然后您将获得所需的输出。

# php - 有没有更好的方法在循环对象的方法时创建数组？

> ID：10742926
> 
> 赞同：0
> 
> 时间：2012-05-24T18:04:05.103
> 
> 标签：php, arrays, object, loops

我正在使用

```
foreach ($objs as $obj) {
    $data[] = $obj->getValue;
} 
```

从可能返回的方法中收集值

```
array[4]{
    [0]=>
    string(2) "1234"
    [1]=>
    string(7) "5678"
    [2]=>
    string(7) "9ab"
    [3]=>
    string(10) "cdefg"
    ...
} 
```

但我需要多维关联数组格式的数据，比如......

```
array[2]{
[0] =>
    array[2]{
        ["alpha"]=>
        string(2) "1234"
        ["beta"]=>
        string(7) "5678"
    }
[1] =>
    array[2]{
        ["alpha"]=>
        string(7) "9ab"
        ["beta"]=>
        string(10) "cdefg"
} 
```

我已经能够通过两个独立的循环来做到这一点，一个将方法数据循环到一个二维数组中，第二个循环遍历该数组并将索引值手动更改为关联值。

```
 $key_labels = array('alpha','beta');
    $row_num = $col_num = 0;
    $rows = array(
                array(),
                array()
            );

    /* Parse the query into a two-dimensional array */
    foreach ($objs as $obj) {
        $rows[$row_num][$col_num++] = $obj->nodeValue;

        if ($col_num == count($key_labels)) {   
            $col_num = 0;
            $row_num++;
        }
    }

    /* Change the array second dimension index values to associative values */
    foreach ($rows as $rows_idx => $row) {
        unset($rows[$rows_idx]);
        foreach ($row as $row_idx => $row_val) {
            $rows[$rows_idx][$key_labels[$row_idx]] = $row_val;
        }
    }

    var_dump($rows); 
```

我的问题是……有没有办法比使用两个冗长（而且看似笨拙）的循环更直接地完成这个任务？或者这真的是最好的方法吗？

注意：预计该对象将始终返回等于计数的某个偶数因子的行`$key_labels`数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T18:14:53.923

未经测试，需要 php 5.3。但是如果你没有 5.3，你可以用另一个 foreach 替换 array_map 和匿名函数

```
$vals = array();
foreach ($objs as $obj) {
    $vals[] = $obj->nodeValue;
}

$key_labels = array('alpha','beta');

$result = array_map(array_chunk($vals, count($key_labels)), function($chunkOfVals) use ($key_labels) {
    return array_combine($key_labels, $chunkOfVals);
}); 
```

编辑 - 这是非 5.3 方式。老实说，写出来后我更喜欢这种方式。清楚得多。

```
$result = array();
foreach (array_chunk($vals, count($key_labels)) as $chunkOfVals) {
    $result[] = array_combine($key_labels, $chunkOfVals);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-26T03:12:25.133

```
$i = 0;
foreach ($objs as $j => $obj) {
  $data[$j % 2 == 0 ? ++$i : $i][$j % 2 == 0 ? 'alpha' : 'beta'] = $obj->getValue;
}

var_dump($data); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T18:15:49.067

也许，您可以为数组 key 使用特定的 obj 值：

```
foreach( $objs as $obj) {
     $array[$obj->name] = $obj->getValues();
} 
```

或者创建一个通过 ref 获取数组的方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-24T18:52:31.737

把我的帽子扔进戒指：

```
$myArray = array();
$tempArray = array();

$counter = 0;
foreach($objs as $obj) {

    $tempArray[$key_labels[$counter % 2]] = $obj->getValue;

    if($counter % 2 == 0) {
        $myArray[] = $tempArray;
        $tempArray = array();
    }

    $counter++;
} 
```

完整演示：http: [//codepad.org/dCX9KEcB](http://codepad.org/dCX9KEcB)

结果如下：

```
array(4) {
  [0]=>
  array(1) {
    ["alpha"]=>
    int(12345)
  }
  [1]=>
  array(2) {
    ["beta"]=>
    int(78945)
    ["alpha"]=>
    int(43579)
  }
  [2]=>
  array(2) {
    ["beta"]=>
    int(29853)
    ["alpha"]=>
    int(63542)
  }
  [3]=>
  array(2) {
    ["beta"]=>
    int(75675)
    ["alpha"]=>
    int(12233)
  } 
```

# android - 同步滚动画廊视图

> ID：10742932
> 
> 赞同：2
> 
> 时间：2012-05-24T18:04:32.400
> 
> 标签：android, scroll, gallery

我已经被这种情况困扰了几天了。我的问题是我有多个画廊视图，我想让所有画廊视图的滚动同步。因此，如果滚动了一个画廊视图，我需要同时滚动布局中的所有其他画廊视图，并且整个视图看起来应该是滚动的一个连贯视图，而不是多个视图。

我必须使用多个图库视图，并且在我的情况下使用 Horizo​​ntalScrollView 或其他任何东西似乎都不是一个好的选择。

我在这里发现了一个类似的问题： [同步两个画廊](https://stackoverflow.com/questions/5625522/synchronize-two-galleries)，但没有解决方案。

现在我没有想法，任何指示都会有所帮助

# c# - 保持 Point(2) 或 Vector2(2) 连接到 Point(1) 或 Vector2(1)

> ID：10742935
> 
> 赞同：0
> 
> 时间：2012-05-24T18:04:42.027
> 
> 标签：c#, xna-4.0

想象一个分段的生物，例如蜈蚣。通过对头部段的控制，身体段通过一个点连接到前一个身体段。

随着头部的移动（目前在 8 个基本/基本方向上），一个点相对于它的旋转移动。

```
public static Vector2 RotatePoint(Vector2 pointToRotate, Vector2 centerOfRotation, float angleOfRotation)
{
    Matrix rotationMatrix = Matrix.CreateRotationZ(angleOfRotation);
    return Vector2.Transform(pointToRotate - centerOfRotation, rotationMatrix);
} 
```

本来打算在这里张贴图表，但你知道...

```
 center(2)      point(2)                      center(1)    point(1)

                                                     point(1)                    

                point(2)    ^                                        |
                           / \                                       |
                            |                                        |
 center(2)                                           center(1)      \ /
                                                                     V 
```

我曾想过为基本精灵使用矩形属性/字段，

```
private Rectangle bounds = new Rectangle(-16, 16, 32, 32); 
```

并检查身体段内的预定义点是否保持在头部精灵的边界内。
虽然我目前正在做：

```
 private static void handleInput(GameTime gameTime)
    {
        Vector2 moveAngle = Vector2.Zero;

        moveAngle += handleKeyboardMovement(Keyboard.GetState()); // basic movement, combined to produce 8 angles
                                                                  // of movement

        if (moveAngle != Vector2.Zero)
        {
            moveAngle.Normalize();
            baseAngle = moveAngle;
        }

        BaseSprite.RotateTo(baseAngle);

        BaseSprite.LeftAnchor = RotatePoint(BaseSprite.LeftAnchor,
 BaseSprite.RelativeCenter, BaseSprite.Rotation); // call RotatePoint method

        BaseSprite.LeftRect = new Rectangle((int)BaseSprite.LeftAnchor.X - 1,
 (int)BaseSprite.LeftAnchor.Y - 1, 2, 2); 
 // All segments use a field/property that is a point which is suppose to rotate around the center
        // point of the sprite (left point is (-16,0) right is (16,0) initially
        // I then create a rectangle derived from that point to make use of the .Intersets method of the
        // Rectangle class

        BodySegmentOne.RightRect = BaseSprite.LeftRect; // make sure segments are connected?

        BaseSprite.Velocity = moveAngle * wormSpeed;

        //BodySegmentOne.RightAnchor = BaseSprite.LeftAnchor;

        if (BodySegmentOne.RightRect.Intersects(BaseSprite.LeftRect)) // as long as there two rects occupy the 
        {                                                             // same space move segment with head

            BodySegmentOne.Velocity = BaseSprite.Velocity;
        }

    } 
```

就目前而言，该段与头部一起移动，但以平行方式移动。当它被头部拖动时，我希望得到更细微的片段运动。

我知道这种运动的编码将比我在这里所涉及的要复杂得多。关于我应该如何看待这个问题的一些提示或方向将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T20:34:36.267

我将描述使用像 Farseer 这样的物理引擎需要做什么，但如果你想编写自己的物理引擎，同样如此。

1.  为蜈蚣身体的每个关节点创建一个 Body。
2.  创建一个封装将附加到每个点的外壳的形状。
3.  使用夹具连接身体和形状。这会在您的蜈蚣中创建一个链接。
4.  使用 SliderJoint 附加多个链接。

例如 - 假设每个链接的外壳是一个圆圈，下面是如何创建两个链接并将它们连接在一起。

```
 Fixture fix1 = FixtureFactory.CreateCircle(_world, 0.5f, 1, new Vector2(-5, 5));
    fix1.Body.BodyType = BodyType.Dynamic;

    Fixture fix2 = FixtureFactory.CreateCircle(_world, 0.5f, 1, new Vector2(5, 5));
    fix2.Body.BodyType = BodyType.Dynamic;

    JointFactory.CreateSliderJoint(_world, fix1.Body, fix2.Body, Vector2.Zero, Vector2.Zero, 10, 15); 
```

现在对任何物体施加力或在形状上碰撞将拖动第二个关节 - 就像你想要的那样。

这一切都只是物理原理——所以如果你真的想的话，你可以实现自己的。;)

# asp.net - gridview 不突出显示搜索词

> ID：10742937
> 
> 赞同：0
> 
> 时间：2012-05-24T18:05:10.993
> 
> 标签：asp.net, vb.net

我设置了一个网格视图来在网页上显示搜索结果。

我有下面的代码“应该”用该词的粗体版本替换搜索词的任何实例。

我尝试了许多不同的版本，但没有任何效果。

```
 Private Sub gvSearchResults_RowDataBound(sender As Object, e As System.Web.UI.WebControls.GridViewRowEventArgs) Handles gvSearchResults.RowDataBound
    If e.Row.RowType = DataControlRowType.DataRow Then
        For Each cell As TableCell In e.Row.Cells
            If cell.Text.Contains(searchTerm) Then
                cell.Text = cell.Text.Replace(Session("SearchTerm"), "<span style='font-weight: bold;'>" & Session("SearchTerm") & "</span>")
            End If
        Next
    End If
End Sub 
```

我的逻辑中有什么遗漏吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T18:15:01.640

您的代码中有一个可疑的`searchTerm`变量。

请注意，在您的代码中，您正在使用`searchTerm`变量***以及*** `Session("SearchTerm")`.

我会这样做：

```
searchTerm = Session("SearchTerm")

If cell.Text.Contains(searchTerm) Then
     cell.Text = cell.Text.Replace(searchTerm , "<span style='font-weight: bold;'>" & searchTerm  & "</span>")
End If 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T19:01:52.277

如果为空白，则可能是 gridview 在集合`Cell.Text`中放置了 Literal 控件。`Cell.Controls`你应该把这样的东西放在：

```
If e.Row.RowType = DataControlRowType.DataRow Then
    For Each cell As TableCell In e.Row.Cells
        If cell.Controls.Count > 0 Then
            Dim ltl as Literal = CType(cell.Controls(0), Literal)
            If ltl.Text.Contains(searchTerm) Then
                cell.Text = cell.Text.Replace(Session("SearchTerm"), "<span style='font-weight: bold;'>" & Session("SearchTerm") & "</span>")
            End If
        End If
    Next
End If 
```

# java - java android应用每10秒执行一次

> ID：10742944
> 
> 赞同：-2
> 
> 时间：2012-05-24T18:05:34.273
> 
> 标签：java, android

我有这个代码，用于我正在开发的 android 应用程序：

```
package com.exercise.AndroidInternetTxt;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.net.MalformedURLException;
import java.net.URL;
import android.app.Activity;
import android.os.Bundle;
import android.widget.TextView;

public class AndroidInternetTxt extends Activity {

    TextView textMsg, textPrompt, textSite;
    final String textSource = "http://www.xxx/s.php";

    @Override
    public void onCreate(Bundle savedInstanceState) {

        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        textPrompt = (TextView)findViewById(R.id.textprompt);
        textMsg = (TextView)findViewById(R.id.textmsg);
        textSite = (TextView)findViewById(R.id.textsite);

        //textPrompt.setText("Asteapta...");

        URL textUrl;
        try {
            textUrl = new URL(textSource);
            BufferedReader bufferReader = new BufferedReader(new InputStreamReader(textUrl.openStream()));
            String StringBuffer;
            String stringText = "";
            while ((StringBuffer = bufferReader.readLine()) != null) {
                stringText += StringBuffer;
            }
            bufferReader.close();
            textMsg.setText(stringText);
        } catch (MalformedURLException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
            textMsg.setText(e.toString());
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
            textMsg.setText(e.toString());
        }

        //textPrompt.setText("Terminat!");

    }

} 
```

它工作正常，它从 .php 文件输出文本。我希望它每 10 秒自动刷新一次，但我真的不知道该怎么做。你能帮我解决这个问题吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T18:33:20.807

在这里之前应该已经回答了很多次。这就是我的做法。

```
TimerTask fileProcessTask = new TimerTask(){

        @Override
        public void run() {
            //put your code to process the url here  
            processFile();

        }

    };

        Timer tm = new Timer();
        tm.schedule(fileProcessTask, 10000L); 
```

应该管用

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T20:02:46.473

计时器任务将不起作用，因为它将创建一个不同的线程并且只有原始线程可能会触及它的视图。

对于 android，首选的方法是使用处理程序。以太币

```
textMsg.post( new Runnable(){

     public void run(){
            doProcessing();
            testMesg.setText("bla");
            testMsg.postDelayed(this,(1000*10));
     }
}; 
```

或拥有 Handler 类的单独实例

```
Handler mHanlder = new Handler();
mHandler.post(runnable); 
```

# javascript - 在用户交互之间保存一个 Javascript 变量？

> ID：10742946
> 
> 赞同：0
> 
> 时间：2012-05-24T18:05:50.880
> 
> 标签：javascript, ruby-on-rails-3

在我的 js 文件中设置全局变量似乎不起作用。如何`session`从 JavaScript 设置 rails 变量？

我想要一个不使用 jQuery 的解决方案。

* * *

**编辑**：解决方案是使用包含隐藏字段的 HTML 表单。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T18:10:02.917

全局变量仅在页面查看期间有效。重新呈现页面后，它们将重置为其默认值。

如果您需要保留这些值，则需要使用 cookie 或本地存储。其他选项是使用 Ajax 将它们提交到服务器，并让服务器记住它们并在呈现页面时设置值。

# jquery - 二级菜单下拉菜单 Google Chrome

> ID：10742952
> 
> 赞同：2
> 
> 时间：2012-05-24T18:06:11.403
> 
> 标签：jquery, css, google-chrome, drop-down-menu

我正在开发一个使用 CSS 和 jQuery 完成的下拉菜单的网站。

当我点击打开它，并且菜单大于页面底部时，滚动条会自动增加。但是当我打开一个带有悬停效果的子菜单时，滚动条并没有增加，内容被隐藏了。

这只发生在谷歌浏览器上，IE 和 Firefox 正常显示。

为了可视化问题，打开 www.rspneus.com.br 单击标有“MARCA”的菜单，然后将鼠标悬停在“KUMHO”项上。

感谢和问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T18:15:11.330

您可以使用：

```
position:relative; 
```

我已经测试过了，它也可以在 chrome 上使用；）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T18:24:57.980

您需要在灰色下拉列表中添加一个类（例如，当您将鼠标悬停在 KUMHO 上时出现的那个），然后添加以下样式：

```
.yourNewClass {
 overflow: auto;
 max-height: 200px; /*you can alter this*/
} 
```

这样，当下拉菜单的高度超过 200px 时，下拉菜单中会出现一个滚动条，以便用户可以在其中上下滚动。

# ios - xCode 的注释样式

> ID：10742953
> 
> 赞同：0
> 
> 时间：2012-05-24T18:06:22.153
> 
> 标签：ios, xcode4.2

我应该如何在我的类中为公共方法和属性编写（什么风格）注释，以便它们在快速帮助窗口中可见，就像它们在内置方法中一样？

iOS 中缺少强类型数组给我带来了很多问题，尤其是当一个方法接受 NSArray* 时，如果我是在 6 个月前编写的，那么我需要确保进入该方法并检查必须的实际类型是什么存储在该数组中。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T19:11:22.340

是的，您必须在需要更改时重新生成文档。Xcode 不会像 Visual Studio 那样根据您的评论即时获取文档。我链接到的问题中的评论证实了这一点：

> Xcode 的快速帮助使用您安装的文档集来显示其内容。除非您为类创建和安装文档集，否则所有快速帮助显示都是指向您声明类、方法或数据成员的头文件的链接。

Appledoc 似乎是您最好的选择。我知道这不是您要寻找的答案，但似乎还不错。

# architecture - 大型 Java 项目组织和流程

> ID：10742954
> 
> 赞同：0
> 
> 时间：2012-05-24T18:06:23.057
> 
> 标签：architecture, project-management

我为一个正在寻找新想法的大型组织工作。目前有一个大型项目，旨在为各种应用程序提供通用架构。我们组织了许多“共享”组件，用于创建“可部署单元”或 DU，DU 是最终应用程序。

如果不涉及太多无聊（和敏感）的细节，我们现在的做法是行不通的。我们有 30 多个应用程序，您可以等待 2 年以上才能获得许可，而不是最绝望的紧急修复。我正在寻找涵盖组织和测试的建议。

如果你有兴趣，到目前为止我的想法如下：

1.  根据专业技能创建团队。例如，一个 GUI 团队、一个 JSP 团队、一个数据库团队、一个 HTML/CSS 团队等。当这些人收到解决方案的请求时，他们处于理想的位置，可以看到应该加速开发的重用机会。团队由主题专家组成的事实也意味着生成的代码质量也应该更好。这些团队将根据请求生成定制解决方案，并且仅包含提供解决方案所需的内容 - 没有其他内容。
2.  创建一个与业务客户合作的团队，他们将收集需求，然后转到适当的专业团队寻求解决方案。然后，该团队将负责将各种解决方案集成到最终应用程序中并执行单元测试。
3.  尽可能使用自动化测试工具（例如 JUnit）。此外，为了最大限度地增加可以在生产环境中通过用户验收测试的应用程序数量，您需要建立较短的固定测试持续时间。如果你在那个时间框架结束时还没有准备好，你就回到开发和单元测试——**没有例外！** 换句话说，在您提出要求之前，请确保您已准备好接受用户接受/生产。

你最终得到的是两组团队。一组以应用程序为中心，关注为商业客户提供大图解决方案。另一组以技术为中心，并不真正了解或关心大局，只是他们的专长。

有没有什么像我刚才描述的那样遥远？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T19:40:16.033

考虑实施本书中的想法：[持续交付](https://rads.stackoverflow.com/amzn/click/com/0321601912)

# php - 在 PHP 中将类似 sql 的语法转换为 xpath

> ID：10742957
> 
> 赞同：0
> 
> 时间：2012-05-24T18:06:30.903
> 
> 标签：php, sql, xpath, domxpath

我正在编写一个类来读取具有类似 mysql 语法的 xml 的内容（当然它的语法不完全相同，我忽略了很多东西，只是想有一些基础知识）。

首先，语句看起来像：

```
"SELECT name passwd FROM table WHERE id = 1 and description = 'desc'" 
```

一些基本规则：

*   一切之间必须有一个空格
*   在“WHERE”之后不超过两次比较

除了选择语句的方法，我什么都没做。我分解语句，将其排序为一个数组，然后尝试将其转换为 DOMXpath

如果没有 WHERE，它就可以工作。但是我正在为 where-clauses 苦苦挣扎（这是我到目前为止所做的事情：）

语句：“从用户 WHERE id = '1' 和描述 = 'test 或 test2' 中选择名称 pw”

数组看起来像：

```
array(4) {
  ["type"]=>
  string(6) "SELECT"
  ["searchFields"]=>
  array(2) {
    ["searchField0"]=>
    string(4) "name"
    ["searchField1"]=>
    string(2) "pw"
  }
  ["tableName"]=>
  string(4) "user"
  ["comparer"]=>
  array(2) {
    ["where0"]=>
    array(3) {
      ["field"]=>
      string(2) "id"
      ["operator"]=>
      string(1) "="
      ["value"]=>
      string(3) "'1'"
    }
    ["where1"]=>
    array(4) {
      ["splitTag"]=>
      string(3) "and"
      ["field"]=>
      string(11) "description"
      ["operator"]=>
      string(1) "="
      ["value"]=>
      string(15) "'test or test2'"
    }
  }
} 
```

我如何尝试使用以下代码将语句转换为 Xpath：

```
for ($i = 0; $i < count($arrQuery['searchFields']); $i++) {
    $conditions = "";
    foreach ($arrQuery['comparer'] as $value) {
        switch (count($arrQuery['comparer'])) {
            case 1:
                $conditions .= '//parent::content[@name="'.$value['field'].'" and text()='.$value['value'].']';
                break;
            case 2:
                if (!isset($value['splitTag']) || $value['splitTag'] == "and") {
                    $conditions .= '//parent::content[@name="'.$value['field'].'" and text()='.$value['value'].']';
                    break;
                } else {
                    //$conditions .= 'content[@'.$value['field'].' and text()='.$value['value'].']//parent::*';
                }
                break;
        }
    }
    $xpathquery = '//datarange[@name="'.$arrQuery['tableName'].'"]'.$conditions.'//content[@name="'.$arrQuery['searchFields']['searchField'.$i].'"]';
    $nodeList = $this->xpath->query($xpathquery);
    foreach ($nodeList as $node) {
        $arrContent['searchField'.$i][] = $node->nodeValue;
    }
} 
```

我的第一点是：如果案例 2 中的 if 子句的条件得到确认，则创建的 xpath 不起作用（可能是父级或我的逻辑有问题）

我的第二点是：我仍然不知道如何处理条件不匹配且 $value['splitTag'] 为“或”的情况。如果有人提示如何解决这个问题，我将非常感激。

**/编辑**：好的，感谢您的提示，这是我的 xml 示例：

```
<database>
  <datarange id="user">
    <dataset id="0">
      <content name="id">
        1
      </content>
      <content name="description">
        test or test2
      </content>
      <content name="name">
        Name
      </content>
      <content name="pw">
        Passwort
      </content>
    </dataset>
    <dataset id="1">
      <content name="name">
        Name2
      </content>
      <content name="pw">
        Passwort2
      </content>
    </dataset>
  </datarange>
  <datarange id="config">
    <dataset id="0">
      <content name="type">
       command
      </content>
      <content name="name">
       lab
      </content>
      <content name="type">
       request
      </content>
      <content name="target">
       target_name
      </content>
      <content name="desc">
        Address Book
      </content>
    </dataset>
  </datarange>
</database> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T17:05:40.297

给定您的输入文档和查询：`SELECT name pw FROM user WHERE id = '1' and description = 'test or test2`您必须自己构建以下 XPath 才能到达`dataset`具有所需值的节点：

```
//datarange[@id = 'user']/dataset
      [normalize-space(content[@name = 'id']) = '1']
      [normalize-space(content[@name = 'description']) = 'test or test2'] 
```

这将为您提供一个`dataset`节点，然后您可以在该节点上运行以下命令：

```
normalize-space(content[@name = 'name']) 
```

得到`name`和：

```
normalize-space(content[@name = 'pw']) 
```

这是一个简单的 XSLT 来测试它：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

    <xsl:template match="/">
        <xsl:apply-templates select="//datarange[@id = 'user']/dataset
                [normalize-space(content[@name = 'id']) = '1']
                [normalize-space(content[@name = 'description']) = 'test or test2']"/>
    </xsl:template>

    <xsl:template match="dataset">
        name: <xsl:value-of select="normalize-space(content[@name = 'name'])"/>
        pwd: <xsl:value-of select="normalize-space(content[@name = 'pw'])"/>
    </xsl:template>

</xsl:stylesheet> 
```

当应用于您的输入文档时，它将产生：

```
name: Name
pwd: Passwort 
```

您现在可以将其纳入查询 SQL-like-to-XPath 引擎。

不过还有一件事。如果您可以*升级*到 XPath 2.0，您可能想尝试[条件](http://www.w3.org/TR/xpath20/#id-conditionals)表达式和[量化](http://www.w3.org/TR/xpath20/#id-quantified-expressions)表达式，以使您的 XPath 更像查询。谁知道呢，也许您一开始就不需要类似 SQL 的语法。另外还有[XQuery](http://www.w3.org/TR/xquery/)。

# postgresql - 基于包含“select unnest”子句的子查询更新列

> ID：10742966
> 
> 赞同：2
> 
> 时间：2012-05-24T18:06:59.227
> 
> 标签：postgresql, postgresql-9.1

我正在尝试根据一秒钟内的值更新一个表中的布尔列。

```
UPDATE channels
SET contains_photos = TRUE 
WHERE id IN (SELECT unnest(ancestors) 
    FROM channel_tree WHERE id = 11329); 
```

该`channel_tree.ancestors`列包含一组通道 ID。以上失败并出现以下错误：

> 错误：无法截断“channel_tree”，因为此会话中的活动查询正在使用它

最重要的目标是将所有给定通道的`contains_photos`列设置为 true 。`ancestors`任何人都知道如何最好地缓解此错误，甚至是替代解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T05:17:40.310

不知道为什么你的错误说 TRUNCATE。听起来您有一个触发器或规则正在执行我们看不到的截断。

以下是执行相同查询的一些替代方法：

```
UPDATE channels
SET contains_photos = TRUE 
WHERE id = ANY (SELECT ancestors 
    FROM channel_tree WHERE id = 11329); 
```

或加入：

```
UPDATE channels
SET contains_photos = TRUE
FROM channel_tree
WHERE channels.id = ANY (channel_tree.ancestors)
      AND channel_tree.id = 11329; 
```

# prolog - prolog xpce 动态列表

> ID：10742973
> 
> 赞同：0
> 
> 时间：2012-05-24T18:07:18.587
> 
> 标签：prolog, xpce

我对 Prolog 和 XPCE 循环菜单有疑问。

这是我的代码：

```
list:-
new(D,dialog('List')),
send_list(D,append,
[
new(Von,menu(von,cycle)),
new(Zu,menu(zu,cycle)),
new(Ok,button('OK'))
]),
send_list(Von, append, findall(X,city(X),Y)),
send_list(Zu, append, findall(X,city(X),Y)),
send(D,open).

city(berlin).
city(london).
city(paris).
city(rom). 
```

我的问题是，他可以使用 findall 术语。

```
ERROR: findall: Unknown class 
```

但是如果你单独使用 findall，它会很好用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T18:24:46.993

Prolog 不是函数式语言。

```
findall(X,city(X),Y),
send_list(Von, append, Y), 
```

应该管用

# multidimensional-array - 为什么 $_POST 返回多数组

> ID：10742974
> 
> 赞同：0
> 
> 时间：2012-05-24T18:07:20.757
> 
> 标签：multidimensional-array

我有以下 HTML 表单

```
<form id="form2" name="form2" method="post" action="process.php">
<table width="271" border="1">
<tr>
  <td width="5"><input name="txtIdone2" type="text" id="txtIdone2" value="Richard" /></td>
  <td width="250">
  <label for="txtIdone"></label>
  <input name="txtIdone" type="text" id="txtIdone" value="Hopes" />
</td>
</tr>
<tr>
  <td><input name="txtIdone3" type="text" id="txtIdone3" value="Testing" /></td>
  <td><input name="txtIdone4" type="text" id="txtIdone4" value="this" /></td>
</tr>
<tr>
  <td><input name="txtIdone5" type="text" id="txtIdone5" value="it" /></td>
  <td><input name="txtIdone6" type="text" id="txtIdone6" value="works" /></td>
</tr>
<tr>
  <td colspan="2"><input type="submit" name="btnTest" id="btnTest" value="Submit" />
    </td>
</tr>
</table>
</form> 
```

提交给具有以下代码的 process.php：

```
 $data = array($_POST);
print_r ($data); 
```

简单的。但是，我收到的不是一个常规数组，而是一个多数组。这是一个例子：

```
Array
(
    [0] => Array
        (
            [txtIdone2] => Richard
            [txtIdone] => Hopes
            [txtIdone3] => Testing
            [txtIdone4] => this
            [txtIdone5] => it
            [txtIdone6] => works
        )

) 
```

我只想返回一个常规数组。我究竟做错了什么？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T18:09:24.167

`$_POST`已经是[一个数组](http://php.net/manual/en/reserved.variables.post.php)。

通过这样做`$data = array($_POST);`，您正在使数组成为多维的。

尝试简单地做：

```
print_r($_POST); 
```

# gwt - 如何在 gwt 中使 I18N 动态化？

> ID：10742977
> 
> 赞同：1
> 
> 时间：2012-05-24T18:07:30.763
> 
> 标签：gwt, internationalization, gwt-platform

我正在使用 gwtp，我想让我的 gwt 应用程序的 I18N 动态化，我做了类似[展示示例的操作](http://gwt.google.com/samples/Showcase/Showcase.html#!CwCheckBox "展示")

即使它很好，但它也不是最好的方法，因为每次语言环境发生变化时它都会重新加载。

所以我只想将它更改为动态，以便它允许我在运行时更改我的语言环境，

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T23:48:01.500

GWT 为每种语言编译不同版本的代码，以避免用户在很可能只需要自己的语言时不得不下载所有语言。

如果您确实想让用户下载所有语言，因为您想在运行时更改语言，无论出于何种原因，您都必须以完全不同的方式进行。

There are many solutions for this (google Javascript Internationalization), none of which would involve the GWT way of doing things, as this is not very good practice and is discouraged by GWT.

By the way, if you mean you just want to change the locale at run time for testing, I hope you know you can just add the URL parameter:

```
http://your-url?locale=de 
```

(for German locale)

# windows-phone-7 - 将sql查询转换为linq

> ID：10742978
> 
> 赞同：0
> 
> 时间：2012-05-24T18:07:32.397
> 
> 标签：windows-phone-7

我有以下代码块可以正常工作；

```
var toDoSessionsInDB = from ZSESSION todo in todoZession.ZSESSIONs
                       select todo ;

ToDoZessions = new ObservableCollection<ZSESSION>(toDoSessionsInDB); 
```

我想修改“选择”部分，但以下代码抛出错误

```
var toDoSessionsInDB = from ZSESSION todo in todoZession.ZSESSIONs
                       select  ContactName
                                  .Substring(0,c.ContactName.IndexOf(' ')),Age,ContactNumber;
ToDoZessions = new ObservableCollection<ZSESSION>(toDoSessionsInDB); 
```

编译前显示以下错误...... *System.Collections.ObjectModel.ObservableCollection.ObservableCollection(System.Collections.Generic.List) 的最佳重载方法匹配有一些无效参数*

有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T18:55:34.917

如果您尝试选择不止一件事，则需要`select new`在 LINQ 中选择。它看起来像这样：

```
var toDoSessionsInDB = from todo in todoZession.ZSESSIONs
                       select new ZSESSION
                       {
                         Name = todo.ContactName.Substring(0,c.ContactName.IndexOf(' ')),
                         Age = todo.Age,
                         ContactNumber = todo.ContactNumber
                       }; 
```

其中等号左侧的项目是 ZSESSION 类中的属性。你没有提供那个课程，所以我不得不猜测他们的名字。

# javascript - Jquery-ui 可调整大小的插件不起作用

> ID：10742980
> 
> 赞同：1
> 
> 时间：2012-05-24T18:07:49.983
> 
> 标签：javascript, jquery, jquery-ui, jquery-resizable

我到底做错了什么？

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>Draggable crop</title>
        <script type="text/javascript" src="/scripts/jquery.js"></script>
        <script type="text/javascript" src="/scripts/jquery.ui.js"></script>
        <script type="text/javascript">
            $(document).ready(function() {
                $('.image_outline').resizable();
            });
        </script>

        <style type="text/css">
            .image_outline {
                border: dashed 1px #000;
                width: 300px;
                height: 200px;
            }
        </style>
    </head>

    <body>
        <div class="image_outline"></div>
    </body>
</html> 
```

这是 jsfiddle 上的代码：http: [//jsfiddle.net/dAHt8/](http://jsfiddle.net/dAHt8/)

为什么可调整大小的插件不能`div`调整大小？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T18:11:30.493

添加正确的 CSS 链接后工作正常：

**[jsFiddle 示例](http://jsfiddle.net/j08691/dAHt8/3/)**。

对于那个 jsFiddle，我在以下位置链接到托管的 jQuery UI CSS：[http ://ajax.googleapis.com/ajax/libs/jqueryui/1.7.2/themes/ui-lightness/jquery-ui.css](http://ajax.googleapis.com/ajax/libs/jqueryui/1.7.2/themes/ui-lightness/jquery-ui.css)

# android - android:minSdkVersion、android:targetSdkVersion 和“目标”之间的关系

> ID：10742981
> 
> 赞同：13
> 
> 时间：2012-05-24T18:07:50.483
> 
> 标签：android

所以，我有点困惑，我以为我理解`android:minSdkVersion`,`android:targetSdkVersion`和`target`项目属性中的含义。

现在我把这些设置为：

```
 android:minSdkVersion="7" 
    android:targetSdkVersion="13" 
```

和：

```
 target=android-15 
```

在`project->properties->Android->Project Build Target`.

当我尝试在安装了 Android 2.3.3 的设备上运行此应用程序应用程序时，我看到设备名称上有一个红叉，但应用程序在其上运行良好。

![](../Images/a00824ffbf6cba581fc822d5470dbd64.png)

我错过了什么？如果我针对 15 构建，它如何在 android-7 上运行？这种混淆是在我将 AdMob 集成到我的应用程序中后出现的，该应用程序声明它需要最低 SDK 级别 13。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-05-24T18:20:34.807

一次描述一个：

*   android:minSdkVersion 帮助 Google Play 根据用户的设备过滤应用程序。例如，使用 minSdkVersion="7" 时，使用仅支持 6 的设备浏览的人不会在 Google Play 上看到您的应用，因此不会下载它，发现它不起作用，并留下差评： )

*   android:targetSdkVersion 是向设备发出的信号，告知您的应用针对哪个 API 版本进行了测试。*对于至少*针对该平台版本的应用程序，新行为通常在默认情况下可用于新版本的平台。例如，通过将 targetSdkVersion 设置为 11 或更高，您会在 ActionBar 中获得一个溢出菜单（对于 Honeycomb 及以上设备），而不是“羞耻的传统菜单按钮”。

*   project.properties 目标是向本地构建系统发出的信号，告知您应该针对哪个版本的平台编译代码。通常，最好将其设置为您为 targetSdkVersion 设置的任何内容。

> 我错过了什么？如果我针对 15 构建，它如何在 android-7 上运行？

出于这个原因，Android 保持向后兼容性。当您使用在平台版本 15 中添加的 API 时，显然它们不会出现在运行旧设备的设备上。

However, it's possible (and encouraged) to design your application in such a way as to take advantage of features added on new platforms, but "degrade gracefully" such that your application continues to run on older ones. There's an Android Training lesson on just this topic, called [Supporting Different Platform Versions](http://developer.android.com/training/basics/supporting-devices/platforms.html).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T18:13:38.397

`android:minSdkVersion="7"`表示您无法在`2.1(API-7)`. `android:targetSdkVersion="13"`该应用程序是针对此 API 构建的。构建目标将设置为 13，并且在 13 之前可用的方法和内容将起作用。

[http://developer.android.com/guide/topics/manifest/uses-sdk-element.html](http://developer.android.com/guide/topics/manifest/uses-sdk-element.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T18:18:33.217

android:targetSdkVersion="13" 表示此应用程序已通过将 sdk 13 作为目标构建，以充分利用其功能

android:minSdkVersion="7" 表示它可以在sdk 7 及更高版本上工作，但是如果某些功能在较低的sdk 中不可用，它的某些功能可以被剥离。即（小于 sdk 13）

# c++ - 当用于指向字符串时，指向 char 的指针是否会覆盖内存？

> ID：10742984
> 
> 赞同：1
> 
> 时间：2012-05-24T18:08:11.273
> 
> 标签：c++, string

```
char str[]="Hello"; 
```

这为字符串分配了 6 个字节，但是如果我写

```
char *str = "Hello"; 
```

这会覆盖数据，因为它只是为了存储 1 个字符？所以我要问的是，当我声明一个字符串，但没有初始化它 (char str[12]; ) 时，是在此处保留 12 个字节还是在初始化它时？如果它们确实在这里被初始化，那么这意味着：

```
char *str; 
```

只有 1 个字节被保留，但是当我让它指向一个字符串时，这不会覆盖超出它的界限的数据吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T18:10:10.297

```
char *str; 
```

不为内容保留任何数据。它是一个指针，大小可容纳内存地址。

```
char *str = "Hello"; 
```

`{ 'H', 'e', 'l', 'l', 'o', 0 }`编译器已经将6 个字节存储在某处。现在你正在创建一个变量来保存它的地址（指向它）。不复制字符串内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T18:11:13.087

```
char str[]="Hello"; 
```

你没看错，它是一个 6 `char`s的数组

```
char *str = "Hello"; 
```

这是一个指向字符串文字的指针。某处有一个 6 `char`s 的数组，而您的变量`str`只是指向它。

```
char *str; 
```

这不保留任何东西，它是一个指向不确定位置的指针。当你让它指向一个字符串时，它指向一个`char`存在于其他地方的 s 数组，不涉及副本。

# php - 将 PHP 文件解析为 XML 文件？

> ID：10742985
> 
> 赞同：1
> 
> 时间：2012-05-24T18:08:13.697
> 
> 标签：php, mysql, xml, database, parsing

我一直在研究一个在 XML 文件中显示数据的项目。（有点像 API）。我知道如何用 PHP 解析 XML，以及如何用 PHP 制作 XML 文件，但它们不能一起工作。:)

基本上，我有两个文件：`parse.php`和`xml.php`.

`xml.php`从 MySQL 数据库中获取信息，并将其输出为 XML。

`parse.php`加载和解析`xml.php`并将其输出为 HTML。

如果我运行`parse.php`，它不会加载`xml.php`。但是，如果我复制输出的 XML（来自`xml.php`）并将其保存为 xml.xml 文件（并将文件名更改`parse.php`为“xml.xml”），它就可以工作。我真的很感激任何帮助。

parse.php 的内容：

```
<?php

    $doc = "xml.php";

    $doc = @simplexml_load_file($doc) or die("Server Error: Recipe not found!");

    $title = $doc->title;

    echo $title

?> 
```

xml.php 的内容：

```
<?php

    header("Content-type: text/xml");

    $dbc = mysql... //gets data from database

    echo "<!DOCTYPE..."; //xml stuff here

    echo "<title>" . $dataFromMySQL . "</title>";

?> 
```

数据库连接正常，并且 XML 中的 DOCTYPE 没问题，所以这不是问题。

同样，我只有在使用 PHP 动态生成 XML 时才会遇到问题。如果它是一个 .XML 文件，它可以正常工作。

谁能帮我？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-24T18:13:11.167

`simplexml_load_file`将尝试实际加载`xml.php`文件的 php 内容。它不会首先运行该文件。您需要进行一些重写或使用这个丑陋的解决方案：

```
ob_start();
include 'xml.php';
$xml = ob_get_clean();

$doc = simplexml_load_string($xml);
//... 
```

注意：我更喜欢@lonesomeday 提出的解决方案，它只需要更多的重写。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-24T18:12:54.263

```
@simplexml_load_file($doc); 
```

那就是你的问题所在。这不会执行`xml.php`，但会尝试将该文件（您编写的 PHP 代码）解析为 XML。显然（因为它不是 XML）这行不通。

您必须找到一种将输出从执行`xml.php`到`parse.php`.

执行此操作的简单方法是将所有`echo`调用更改为`$xml .=`调用，然后简单地更改`include` `xml.php`为`parse.php`.

```
// xml.php
$xml = '';
$xml .= "<!DOCTYPE..."; //xml stuff here

$output .= "<title>" . $dataFromMySQL . "</title>";

// parse.php
include('xml.php');

simplexml_load_string($xml); 
```

请注意，您的问题在这里显示了使用错误抑制运算符的愚蠢性`@`。如果您没有使用它，PHP 会向您显示各种错误，这些错误会帮助您了解问题所在。

* * *

附录：在我看来，实际上最好的方法是忘记一路上毫无意义的 XML 步骤，只需将数据库输出转换为 HTML。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T18:14:33.017

如果您想在不重写 xml.php 的情况下执行此操作，可以通过 url 访问让 PHP 处理文件：

```
$doc = file_get_contents("http://localhost/xml.php"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-24T18:21:12.577

您实际上是在加载本地文件。除非你评估它，否则代码不会运行，所以你只会得到代码本身。

您可以使用 CURL 通过 HTTP 下载 xml.php，或者您可以使 xml.php 的 XML 生成组件成为您只需包含并执行的可调用函数。

解析.php：

```
<?php
  include('xml.inc');

  $doc = @simplexml_load_string(xml_function()) or die("Error");
  echo $doc->title; 
```

xml.php：

```
<?php
  include('xml.inc');

  header("Content-type: text/xml");
  echo xml_function(); 
```

xml.inc：

```
<?php
  function xml_function() {
    $dbc = mysql... //gets data from database
    $xml = "<!DOCTYPE..."; //xml stuff here
    $xml .= "<title>" . $dataFromMySQL . "</title>";
    return $xml;
  } 
```

但是......老实说，即使这看起来很愚蠢，当您可以让两种输出方法连接到相同的数据并跳过生成/解析步骤时。只需有条件地输出 HTML/XML。

# php - 循环直到给出空值

> ID：10742986
> 
> 赞同：0
> 
> 时间：2012-05-24T18:08:18.300
> 
> 标签：php, loops, null

我有一个第三方库，它从函数返回值，如果不存在值（不是数据库），则返回 null。

我有第一个值，我想用它来返回第二个值，并使用第二个值返回第三个值，依此类推。当返回一个空值时，这个循环应该停止。

因此该函数使用 ID 来获取下一个值，例如：`getNextValue($id)`。这个函数的返回是`value`or `null`。

那么我应该如何将这个函数包含在一个循环中，该循环使用一个起始值并返回第二个，并使用第二个返回第三个，依此类推，直到它返回一个空值并停止？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T18:10:12.963

```
while ($value = getNextValue($id)) ... 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-24T18:12:05.423

```
while ($id = getNextValue($id)) { 
//this will keep passing $id to the function over and over again
//Assuming your function will return different input or a null, this will work.

//code 
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T18:21:14.713

```
while (null !== ($value = getNextValue($id))) {

} 
```

# javascript - 根据是否选中复选框打开 3 个 div

> ID：10742987
> 
> 赞同：0
> 
> 时间：2012-05-24T18:08:24.400
> 
> 标签：javascript, jquery, html

我正在使用下面的脚本根据是否选中复选框来显示和隐藏 div，如果是这样，我可以显示/隐藏 paypal 按钮，直到他们接受条款。

但是我们现在想要提供三种支付选项，所以它需要打开/关闭 3 个 div，我尝试只复制 div 3 次，但它仍然只打开一个。任何机构都可以帮我解决这个问题吗？

```
<script type="text/javascript">
function doInputs(obj){
  var checkboxs = obj.form.c1;
  var i =0, box;
  document.getElementById('mydiv').style.display = 'none';
  while(box = checkboxs[i++]){
    if(!box.checked)continue;
    document.getElementById('mydiv').style.display = '';
    break;
  }
}
</script>

<form>
  <input type="checkbox" name="c1" onclick="doInputs(this)">
</form>
<div id="mydiv" style="display:none">
  <input type="text">
</div> 
```

如果有人可以帮助我添加另一个`checkbox`，并让贝宝按钮（div）仅在两者都显示时显示，那将是**惊人**的`checked`？

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T18:26:50.840

我还偷了 Marcus 的答案，但做了以下改进：

*   我使用 jQuery 文档就绪事件，因此代码在页面加载后触发
*   我简化了逻辑
*   它适用于多种付款方式

[http://jsfiddle.net/5Byes/3/](http://jsfiddle.net/5Byes/3/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T18:19:01.657

使用 jQuery，您可以有一个数组或只有两个设置为 false 的变量。当一个按钮被选中时，你将这个等效值设置为当前值的相反值（所以如果它是假的，它就会变成真，反之亦然）。

这是一个简单的示例，说明如何完成此操作：http: [//jsfiddle.net/5Byes/](http://jsfiddle.net/5Byes/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T18:24:19.290

[http://jsfiddle.net/5Byes/4/](http://jsfiddle.net/5Byes/4/)

我偷了 Marcus 的小提琴并对其进行了更新以做你想做的事。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-24T18:26:56.247

页面上只允许有一个具有特定 ID 的元素。如果你想要更多——使用`class`属性。另一方面，您可以将所有`div`带有支付方法的 s 包装在一个`div`带有 ID 的地方，比如说，`paymentsMethods`然后显示/隐藏它。

```
var paymentsDiv = document.getElementById('paymentsMethods');
if (box.checked) paymentsDiv.show(); else paymentsDiv.hide(); 
```

如果您想要 2 个复选框 - 将`onclick`两者设置为相同的处理程序并将条件更改为`box1.checked && box2.checked`.

使用 jQuery（在您的问题标签中），您可以`$('#paymentsMethods').toogle()`单击复选框（另请参阅`$.hide()`和`$.show()`）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-24T18:29:11.243

如果我正确理解你在找什么，你可以这样做：

HTML：

```
<input id="opt1cb" type="checkbox" value="Option 1" />Option 1<br />
<input id="opt2cb" type="checkbox" value="Option 2" />Option 2<br />
<input id="opt3cb" type="checkbox" value="Option 3" />Option 3<br />

<div class="option" id="opt1">Option 1</div>
<div class="option" id="opt2">Option 2</div>
<div class="option" id="opt3">Option 3</div>
<div class="option" id="opt23">Option 2 & 3</div> 
```

jQuery：

```
$('.option').hide();

$('#opt1cb').click( function() {
    if( $(this).prop("checked") ) {
        $('#opt1').show();
    } else {
        $('#opt1').hide();
    }
});

$('#opt2cb').click( function() {
    if( $(this).prop("checked") ) {
        $('#opt2').show();
        if( $('#opt3cb').prop("checked") )
            $('#opt23').show();
    } else {
        $('#opt2').hide();
        $('#opt23').hide();
    }
});

$('#opt3cb').click( function() {
    if( $(this).prop("checked") ) {
        $('#opt3').show();
        if( $('#opt2cb').prop("checked") )
            $('#opt23').show();
    } else {
        $('#opt3').hide();
        $('#opt23').hide();
    }
}); 
```

​ 在这里工作 jsfiddle：http: [//jsfiddle.net/bCDqa/](http://jsfiddle.net/bCDqa/)

# c - 使用 malloc 释放 c 中分配的空间

> ID：10742988
> 
> 赞同：6
> 
> 时间：2012-05-24T18:08:24.850
> 
> 标签：c, struct, malloc, free, typedef

我对此代码有疑问：

```
typedef struct pop {
unsigned long int *np; // matrix
unsigned long int f;
long double fp; 
unsigned long int *R; // matrix
unsigned long int *C; // matrix
unsigned long int Dp;
unsigned long int Ds;
unsigned long int count;
struct popolazione *ptrTempLst; // pointer
struct popolazione *leftTree;  // left tree pointer
struct popolazione *rightTree; // right tree pointer
} Node; 
```

当我释放为此结构分配的空间时，我是否必须先释放指向结构内矩阵的指针？

例如，

```
 Node *ptr=(Node *) malloc(sizeOf(Node));
 ptr->np=(unsigned long int *)malloc(10*sizeOf(unsigned long int));

 /*code code code*/

 // is necessary: free(ptr->np); 

 free(ptr); 
```

提前致谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-24T18:09:33.213

是的。

每个对 的调用都`malloc`必须有一个对 的匹配调用`free`。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-24T18:42:37.590

那是对的。

为了帮助避免射中自己的脚，您可以考虑以下做法：

1.  始终使用 free() 释放所有 malloc/calloc 的内存
2.  然后，将指针设置为 NULL
3.  使用专用的清理/销毁功能来确保一致的内存清理

以下函数将是确保您始终正确清理结构、避免内存泄漏并避免意外释放已释放内存并导致分段错误的好方法：

```
int destroyNode(Node* myNode) {
  if(!myNode) {
    printf("Invalid pointer! Exiting");
    return (-1);
  }

  // Clear out memory
  if(np) {
    free(np);
    np = NULL;
  }
  if(R) {
    free(R);
    R = NULL;
  }
  if(C) {
    free(C);
    C = NULL;
  }
  if(ptrTempLst) {
    free(ptrTempLst);
    ptrTempLst = NULL;
  }
  if(leftTree) {
    free(leftTree);
    leftTree = NULL;
  }
  if(rightTree) {
    free(rightTree);
    rightTree = NULL;
  }

  free(myNode);
} 
```

例如：

```
int main(void) {
  Node *tempNode = calloc((size_t)1,sizeof(Node));

  // Alloc the member nodes, etc, do some code

  // Ready to clean up and exit program
  destroyNode(tempNode);
  tempNode = NULL;

  return 0;
} 
```

祝你好运！

# ios - iOS：在纵向模式/方向中修复/锁定相机视图

> ID：10742989
> 
> 赞同：1
> 
> 时间：2012-05-24T18:08:26.793
> 
> 标签：ios, xcode, camera, orientation, portrait

我想在人像模式下修复我的相机视图，但到目前为止我没有找到解决方案......

你是否有一个？会让我的一天.__.'

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T18:42:49.937

您无法将 UIImagePickerController 显式限制为纵向模式，但您可以自定义相机用户界面的外观，这可能会对您有所帮助。这是来自 Apple 的示例代码：

[https://developer.apple.com/library/ios/#samplecode/PhotoPicker/Introduction/Intro.html](https://developer.apple.com/library/ios/#samplecode/PhotoPicker/Introduction/Intro.html)

这个问题中提到了另一种控制相机外观的方法：

[具有自定义视图的相机](https://stackoverflow.com/questions/7639188/ios-camera-with-custom-view)

我不确切知道您的目标是什么，但是其中一种方法应该会有所帮助。

# css - 如何在 Twitter Bootstrap 上将框居中

> ID：10742991
> 
> 赞同：11
> 
> 时间：2012-05-24T18:08:38.173
> 
> 标签：css, twitter-bootstrap

我正在布置一个登录屏幕，在该屏幕上将只有一个带有 LOGIN 和 PASSWORD 的框。我需要垂直和水平集中（就像任何传统的登录屏幕一样）。

如何使用 Twitter Bootstrap 实现这一目标？

谢谢！

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-05-24T18:13:22.043

If you are using bootstrap grid, then you can offset your columns:

```
<div class="row">
  <div class="span6 offset3">
     Your content goes here
  </div>
</div> 
```

See example here: [http://twitter.github.com/bootstrap/scaffolding.html#gridSystem](http://twitter.github.com/bootstrap/scaffolding.html#gridSystem)

Or you can just use CSS to simply center block element,

```
div.login-box{
  margin:0 auto;
  width: 720px;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-14T01:04:34.487

更新 Johny 的答案：对于 Bootstrap 3；语法有点不同：

```
<div class="row">
    <div class="col-sm-6 col-sm-offset-3">
        Your content goes here
    </div>
</div> 
```

或者：更好：

```
<div class="container">
    <div class="row">
        <div class="col-sm-6 col-sm-offset-3">
            Your content goes here
        </div>
    </div>
</div> 
```

# java - quizQuestions 数组列表的继承

> ID：10742994
> 
> 赞同：1
> 
> 时间：2012-05-24T18:08:46.490
> 
> 标签：java, inheritance, arraylist, boolean

**编辑：非常感谢我的程序终于运行了。**

我编辑了 addChoice 的代码，让它读取一串连接的数字和空格；我还修改了 checkanswer 方法，但每当我输入正确答案时，它仍然算错，以下是我的代码

```
 public void addChoice(String choice, boolean correct){
      super.addChoice(choice, correct);
      if(correct == true){
           count++;
           choiceString +=   "" + count+" " ;
           answers.add(choiceString);
            }
       super.setAnswer(choiceString.trim());
     }            

     public boolean checkAnswer( String response )
   {
    super.checkAnswer(response);
    boolean ok = false;
    response = response.trim();
    String correctAnswers [] = response.split(" ");
    for(int i=0; i<correctAnswers.length;i++){
        if (answers.contains(correctAnswers[i]))
        { ok = true;}
        else
        {  ok=false;}
     }
    return ok;
   } 
```

**我的问题：**

对于我的问题，第一个和第二个选项是正确的。因此，他/她可以输入 1 或 2 或 1 2 或 2 1 以便他/她在问题上获得满分；当我键入除上面列出的选项之外的任何其他选项时，我应该恢复一个零。所以我的问题是我的检查答案方法总是出于某种原因返回 true，所以无论我输入什么，即使我输入了错误的答案，它也会将其视为 true。所以，我需要这部分的帮助。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T18:11:56.067

您总是将其设置为`true`here inside `AnyChoiceQuestion`。`checkAnswer`：

```
if(true)
     {ok = true;} 
```

我想你的意思是：

```
if (answers.contains(correctAnswers[i]))
    ok = true; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T18:14:27.223

您的问题在于 if(true)，它总是会触发。所以答案将是真实的。我想你的意思是如果 (answers.contains(correntAnswers[i[)