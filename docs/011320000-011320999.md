# StackOverflow 问答 11320000-11320999

# php - PHP图像生成错误/无法显示，因为它包含错误

> ID：11320000
> 
> 赞同：0
> 
> 时间：2012-07-03T22:19:24.143
> 
> 标签：php, image

我一直在使用统计 PHP 脚本处理某种命中计数器，但遇到以下错误：图像`http://localhost/site/counter.php`无法显示，因为它包含错误。

这是执行图像生成的代码：

```
// Generate Image

// Get Value from DB
if ($show == "last24h")
{

// Last24h
$islast = $time-24*60*60;
$totalips = mysql_query("SELECT count(id) FROM counter_ips WHERE time>='$islast'");
$value = mysql_result($totalips,0,0);
$title = "Last 24 hours";
mysql_free_result($totalips);
}
else
{

// Total Visitors   
$totalvisitors = mysql_query("SELECT sum(user) FROM counter_day");
$value = mysql_result($totalvisitors,0,0);
$title = "Total Visitors";
mysql_free_result($totalvisitors);  
}

// Short Value
if ( $value > 999 ) { $value = $value / 1000; $unit = "k"; }
if ( $value > 999 ) { $value = $value / 1000; $unit = "m"; }
if ( $value > 999 ) { $value = ">999"; $unit = "m"; }
else { 
if ( $value >=10 ) $value = round($value,0);
else $value = round($value,1);}
$value .= $unit;

// Variables
$title_font="OpenSans-Regular.ttf";
$value_font="OpenSans-Bold.ttf";

if ($size == "small")
{
$width = 90;
$height = 20;
$title_font_size = 8;
$value_font_size = 9;
$title_pos_y = 15;
$value_pos_y = 16;  

// short title
if ($show == "last24h") {$title="Last24h";}
else {$title="Visitors";}

// left title
$size = imagettfbbox($title_font_size, 0, $title_font, $title);
$titleWidth = $size[2] - $size[0];
$title_pos_x = 8;

// right center value
$size = imagettfbbox($value_font_size, 0, $value_font, $value);
$valueWidth = $size[2] - $size[0];
$space_left = $title_pos_x + $titleWidth;
$value_pos_x = $space_left + ((($width - $space_left) / 2) - ($valueWidth / 2));
}
else
{
$width = 90;
$height = 55;
$title_font_size = 8;
$value_font_size = 24;
$title_pos_y = 15;
$value_pos_y = 48;
// center title
$size = imagettfbbox($title_font_size, 0, $title_font, $title);
$textWidth = $size[2] - $size[0];
$title_pos_x = ($width / 2) - ($textWidth / 2);
// center value
$size = imagettfbbox($value_font_size, 0, $value_font, $value);
$textWidth = $size[2] - $size[0];
$value_pos_x = ($width / 2) - ($textWidth / 2);
}

//  Create a blank image
$im = imagecreatetruecolor($width,$height); 

// Colors
if ($style == "light")
{
$bg_color = imagecolorallocatealpha($im, 235,235,235,0);
$title_color = imagecolorallocate($im, 50,50,50);
$value_color = imagecolorallocate($im, 25,25,25);   
}
else
{
$bg_color = imagecolorallocatealpha($im, 50,50,50,0);
$title_color = imagecolorallocate($im, 255,255,255);
$value_color = imagecolorallocate($im, 255,255,255);
}
$shadow_color = imagecolorallocatealpha($im, 0,0,0,115);
$red = imagecolorallocate($im, 223,1,1);

// Fill BG color
imagefill($im, 0, 0, $bg_color);
// Red line
imageline($im,0,0,$width,0,$red);
imageline($im,0,1,$width,1,$red);
//  title
imagettftext ($im, $title_font_size, 0, $title_pos_x+2, $title_pos_y+2, $shadow_color, $title_font, $title); 
imagettftext ($im, $title_font_size, 0, $title_pos_x, $title_pos_y, $title_color, $title_font, $title); 
// value
imagettftext ($im, $value_font_size, 0, $value_pos_x+2, $value_pos_y+2, $shadow_color, $value_font, $value);
imagettftext ($im, $value_font_size, 0, $value_pos_x, $value_pos_y, $value_color, $value_font, $value); 

// image output
header ("Content-type: image/png");

// create PNG
imagepng($im);

// destroy temp image
imagedestroy($im); 
```

我知道整个 header(); 应该总是排在第一位，但我不知道该移到哪里。

[编辑] 完整代码：

```
 // Date and Time
            $time = time();
            $day = date("Y.m.d",$time); // YYYY.MM.DD
            $month = date("Y.m",$time); // YYYY.MM

            // Language
            $language = substr($_SERVER['HTTP_ACCEPT_LANGUAGE'],0,2);

            // IP address
            $ip = $_SERVER['REMOTE_ADDR']; 

            // Get Referrer and Page
            if (isset($_GET["ref"])) 
                {
                // from javascript
                $referer = $_GET["ref"];
                $page = parse_url($_SERVER['HTTP_REFERER'], PHP_URL_PATH);  
                } 
            else 
                {
                // from php
                $referer = $_SERVER['HTTP_REFERER'];
                $page = $_SERVER['PHP_SELF']; // with include via php       
                }   

            // Cleanup
            if (basename($page) == basename(__FILE__)) $page="" ; // count not counter.php

            $server_host = $_SERVER["HTTP_HOST"]; // Server Host
            if (substr($server_host,0,4) == "www.") $server_host = substr($server_host,4); // Server Host without www.

            $referer_host = parse_url($referer, PHP_URL_HOST); // Referrer Host
            if (substr($referer_host,0,4) == "www.") $referer_host = substr($referer_host,4); // Referer Host without www.

            // Adjust Search Engines
            // Google 
            if (strstr($referer_host, "google."))
                {
                $referer_query = parse_url($referer, PHP_URL_QUERY);
                $referer_query .= "&";
                preg_match('/q=(.*)&/UiS', $referer_query, $keys);

                $keyword = urldecode($keys[1]); // These are the search terms
                $referer_host = "Google"; // adjust host
                }

            // Yahoo    
            if (strstr($referer_host, "yahoo."))
                {
                $referer_query = parse_url($referer, PHP_URL_QUERY);
                $referer_query .= "&";
                preg_match('/p=(.*)&/UiS', $referer_query, $keys);

                $keyword = urldecode($keys[1]); // These are the search terms
                $referer_host = "Yahoo"; // adjust host
                }

            // Bing
            if (strstr($referer_host, "bing."))
                {
                $referer_query = parse_url($referer, PHP_URL_QUERY);
                $referer_query .= "&";
                preg_match('/q=(.*)&/UiS', $referer_query, $keys);

                $keyword = urldecode($keys[1]); // These are the search terms
                $referer_host = "Bing"; // adjust host
                }

            // Delete Old IPs
            $timecheck = mktime(0, 0, 0, date("n"), date("j"), date("Y")) - 48*60*60 ; // 48*60*60 => after 48 hours

            $delete = mysql_query("DELETE FROM counter_ips WHERE time < '$timecheck'");
            if (!$delete) 
            {
            die("Database Selection Failed: ".mysql_error());
            }

            // Delete Old Page, Eeferrer, Language and Keywords
            $old_day = date("Y.m.d", mktime(0, 0, 0, date("n"), date("j")-$oldentries, date("Y")) ); 

            $delete = mysql_query("DELETE FROM counter_page WHERE day<='$old_day'");
            $delete = mysql_query("DELETE FROM counter_referer WHERE day<='$old_day'");
            $delete = mysql_query("DELETE FROM counter_keyword WHERE day<='$old_day'");
            $delete = mysql_query("DELETE FROM counter_language WHERE day<='$old_day'");
            if (!$delete) 
            {
            die("Database Selection Failed: ".mysql_error());
            }

            // Insert a New Day
            $newday = mysql_query("SELECT id FROM counter_day WHERE day='$day'");
            if (!$newday) 
            {
            die("Database Selection Failed: ".mysql_error());
            }

            if (mysql_num_rows($newday)==0)
                { 
                mysql_query("INSERT INTO counter_day (day, user, view) VALUES ('$day', '0', '0')");
                }

            // Check Reload and Set Online Time
            $newuser = 0;
            $oldreload = $time-$reload;
            $userid = mysql_query("SELECT id FROM counter_ips WHERE ip='$ip' AND time>'$oldreload' ORDER BY id DESC LIMIT 1");
            if (!$userid)
            {
            die("Database Selection Failed: ".mysql_error());
            }

            if (mysql_num_rows($userid)==0)
                {
                // New Visitor
                $newuser = 1;
                mysql_query("INSERT INTO counter_ips (ip, time, online) VALUES ('$ip', '$time', '$time')");
                mysql_query("UPDATE counter_day SET user=user+1, view=view+1 WHERE day='$day'");
                }
            else
                {
                // Reload Visitor
                $olduser = mysql_result($userid,0,0);
                mysql_query("UPDATE counter_ips SET online='$time' WHERE id='$olduser'");
                mysql_query("UPDATE counter_day SET view=view+1 WHERE day='$day'");
                }

            // Page
            if($page <> "") {

            $result = mysql_query("SELECT id from counter_page WHERE page='$page' AND day='$day'");
            if (!$result)
            {
            die("Database Selection Failed: ".mysql_error());
            }

                if (mysql_num_rows($result)==0)
                    {
                    mysql_query("INSERT INTO counter_page (day, page, view) VALUES ('$day', '$page', '1')");
                    }
                else
                    { 
                    $pageid = mysql_result($result,0,0);
                    mysql_query("UPDATE counter_page SET view=view+1 WHERE id='$pageid'");
                    }

            }
            // Referer
            if(stristr($server_host, $referer_host) === FALSE AND $referer_host<>"" AND $newuser == 1) {

            $result = mysql_query("SELECT id FROM counter_referer WHERE referer='$referer_host' AND day='$day'");
            if (!$result)
            {
            die("Database Selection Failed: ".mysql_error());
            }

                if (mysql_num_rows($result)==0)
                    {
                    mysql_query("INSER INTO counter_referer (day, referer, view) VALUES ('$day', '$referer_host', '1')");
                    }
                else
                    { 
                    $refererid = mysql_result($result,0,0);
                    mysql_query("UPDATE counter_referer SET view=view+1 WHERE id='$refererid'");
                    }

            }

            // Keywords 
            if(isset($keyword) AND $newuser == 1) {

            $result = mysql_query("SELECT id FROM counter_keyword WHERE keyword='$keyword' AND day='$day'");
            if (!$result)
            {
            die("Database Selection Failed: ".mysql_error());
            }

                if (mysql_num_rows($result)==0)
                    {
                    mysql_query("INSERT INTO counter_keyword (day, keyword, view) VALUES ('$day', '$keyword', '1')");
                    }
                else
                    { 
                    $keywordid = mysql_result($result,0,0);
                    mysql_query("UPDATE counter_keyword SET view=view+1 WHERE id='$keywordid'");
                    }

            }

            // Language 
            if($language<>"" AND $newuser == 1) {

            $result = mysql_query("SELECT id FROM counter_language WHERE language='$language'");
            if (!$result)
            {
            die("Database Selection Failed: ".mysql_error());
            }   

                if (mysql_num_rows($result)==0)
                    {
                    mysql_query("INSERT INTO counter_language (day, language, view) VALUS ('$day', '$language', '1')");
                    }
                else
                    { 
                    $languageid = mysql_result($result,0,0);
                    mysql_query("UPDATE counter_language SET view=view+1 WHERE id='$languageid'");
                    }
                } 
```

现在的2个错误如下：

*   注意：未定义索引：第 27 行 C:\wamp\www\site\counter.php 中的 HTTP_REFERER

*   注意：未定义变量：第 245 行 C:\wamp\www\site\counter.php 中的单位

这是我在我的页面上使用的代码来进行计数：

```
<a href="<?php echo $siteurl; ?>admin/login.php">Admin Login</a>

<script type="text/javascript">
document.write('<a href="stats.php"><img src="counter.php?ref=' + escape(document.referrer) + '" border="0"></a>')
</script>
<noscript><a href="stats.php"><img src="counter.php" border="0"></a></noscript> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-03T23:25:13.430

尝试改变：

```
 // Get Referrer and Page
        if (isset($_GET["ref"])) 
            {
            // from javascript
            $referer = $_GET["ref"];
            $page = parse_url($_SERVER['HTTP_REFERER'], PHP_URL_PATH);  
            } 
        else 
            {
            // from php
            $referer = $_SERVER['HTTP_REFERER'];
            $page = $_SERVER['PHP_SELF']; // with include via php       
            } 
```

到：

```
 // Get Referrer and Page
        if (isset($_GET["ref"])) 
            {
            // from javascript
            $referer = $_GET["ref"];
            $page = ((isset($_SERVER['HTTP_REFERER'])) ? (parse_url($_SERVER['HTTP_REFERER'], PHP_URL_PATH)) : (''));  
            } 
        else 
            {
            // from php
            $referer = ((isset($_SERVER['HTTP_REFERER'])) ? ($_SERVER['HTTP_REFERER']) : (''));
            $page = $_SERVER['PHP_SELF']; // with include via php       
            } 
```

至于另一个错误，我不确定，因为您的帖子中似乎缺少那行代码。

# android - Android HTML5 视频播放但不可见

> ID：11320002
> 
> 赞同：4
> 
> 时间：2012-07-03T22:19:38.273
> 
> 标签：android, html, video, webview, inline

我进行了大量研究，试图找出为什么 html5 视频无法在我的应用程序中正确播放。更具体地说，页面加载正常，您可以看到视频播放器的初始控件，但是当您在此处点击播放时，您会听到视频中的声音，但您什么也看不到。

我正在使用 webview 来显示它并使用几个在线链接进行测试，例如：

*   [http://videojs.com/](http://videojs.com/)
*   [http://broken-links.com/tests/video/](http://broken-links.com/tests/video/)

这是我的网络视图代码：

```
String _location = "http://broken-links.com/tests/video/";
WebView wv = (WebView) findViewById(R.id.dsWebView);
wv.setWebChromeClient(new WebChromeClient()); //chromeClient());        
wv.setWebViewClient(new HelloWebViewClient());
WebSettings webSettings = wv.getSettings();
webSettings.setJavaScriptEnabled(true);
webSettings.setJavaScriptCanOpenWindowsAutomatically(true);
webSettings.setBuiltInZoomControls(true);
webSettings.setSupportZoom(true);   
webSettings.setUseWideViewPort(true);   
webSettings.setPluginsEnabled(true);
webSettings.setPluginState(PluginState.ON);
webSettings.setDomStorageEnabled(true);
webSettings.setAllowFileAccess(true);
wv.setInitialScale(50); 
wv.loadUrl(_location);

private class HelloWebViewClient extends WebViewClient
{ 
    public boolean shouldOverrideUrlLoading(WebView view, String url)
    { 
        view.loadUrl(url); 
        return true;//false; 
    } 
} 
```

我还更改了我的项目，使其适用于 android 4.0 及更高版本，并在我的清单文件中设置 android:hardwareAccelerated="true"。

另外，我确实在我的 htc one x 和 chrome beta 浏览器上的默认浏览器中测试了这两个链接，并且它在两者上都能完美播放。这只是我的网络视图不起作用:(。

我基本上是想弄清楚我缺少什么才能让视频在我的 webview 中正确播放。

感谢您提前提供任何帮助，

火

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-04-21T14:09:44.773

试试这个

```
wv.setLayerType(View.LAYER_TYPE_HARDWARE, null); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T14:34:52.403

最后！我想出了我的问题。这是我清单文件中的意图过滤器。如果我发布它，可能会有人能够更快地发现问题，对此感到抱歉。

```
<manifest>
    <uses-sdk android:minSdkVersion="7" 
        android:targetSdkVersion="14" />
  <supports-screens android:resizeable="true"
              android:smallScreens="true"
              android:normalScreens="true"
              android:largeScreens="true"
              android:anyDensity="true"/> 

<uses-permission android:name="android.permission.INTERNET" />
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE"  />
<uses-permission android:name="android.permission.READ_PHONE_STATE" />          
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/> 

<application android:icon="@drawable/icon"
             android:label="@string/app_name"
             android:hardwareAccelerated="true">
    <activity android:name=".Main"
              android:label="@string/app_name">
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
        <intent-filter
            android:icon="@drawable/icon"
            android:label="Test File"
            android:priority="1">              
            <action android:name="android.intent.action.VIEW" />
            <category android:name="android.intent.category.DEFAULT" />
            <category android:name="android.intent.category.BROWSABLE" />
            <data android:scheme="http" android:host="*"
                android:pathPattern=".*\\.test"/>             
        </intent-filter>
        <intent-filter
            android:icon="@drawable/icon"
            android:label="Test File"
            android:priority="1">              
            <action android:name="android.intent.action.VIEW" />
            <category android:name="android.intent.category.DEFAULT" />
            <category android:name="android.intent.category.BROWSABLE" />
            <data android:scheme="https" android:host="*"
                android:pathPattern=".*\\.test"/>
        </intent-filter>            
        <intent-filter
            android:icon="@drawable/icon"
            android:label="Test File"
            android:priority="1">               
            <action android:name="android.intent.action.VIEW" />
            <category android:name="android.intent.category.DEFAULT" />
            <category android:name="android.intent.category.BROWSABLE" />
            <data android:scheme="content" android:host="*"
                android:pathPattern=".*\\.test"/>
        </intent-filter>            
        <intent-filter
            android:icon="@drawable/icon"
            android:label="Test File"
            android:priority="1">            
            <action android:name="android.intent.action.VIEW" />
            <category android:name="android.intent.category.DEFAULT" />
            <category android:name="android.intent.category.BROWSABLE" />
            <data android:scheme="file" android:host="*"
                android:pathPattern=".*\\.test"/>
        </intent-filter>                              
    </activity>
    <activity android:name="myWebView"
              android:configChanges="keyboardHidden|orientation"         
    ></activity>
</application> 
```

我必须删除我添加的意图过滤器，以便从任何带有“.test”的文件中启动我的应用程序。基本上删除这部分并开始工作：

```
 <intent-filter
            android:icon="@drawable/icon"
            android:label="Test File"
            android:priority="1">              
            <action android:name="android.intent.action.VIEW" />
            <category android:name="android.intent.category.DEFAULT" />
            <category android:name="android.intent.category.BROWSABLE" />
            <data android:scheme="http" android:host="*"
                android:pathPattern=".*\\.test"/>             
        </intent-filter>
        <intent-filter
            android:icon="@drawable/icon"
            android:label="Test File"
            android:priority="1">              
            <action android:name="android.intent.action.VIEW" />
            <category android:name="android.intent.category.DEFAULT" />
            <category android:name="android.intent.category.BROWSABLE" />
            <data android:scheme="https" android:host="*"
                android:pathPattern=".*\\.test"/>
        </intent-filter>            
        <intent-filter
            android:icon="@drawable/icon"
            android:label="Test File"
            android:priority="1">               
            <action android:name="android.intent.action.VIEW" />
            <category android:name="android.intent.category.DEFAULT" />
            <category android:name="android.intent.category.BROWSABLE" />
            <data android:scheme="content" android:host="*"
                android:pathPattern=".*\\.test"/>
        </intent-filter>            
        <intent-filter
            android:icon="@drawable/icon"
            android:label="Test File"
            android:priority="1">            
            <action android:name="android.intent.action.VIEW" />
            <category android:name="android.intent.category.DEFAULT" />
            <category android:name="android.intent.category.BROWSABLE" />
            <data android:scheme="file" android:host="*"
                android:pathPattern=".*\\.test"/>
        </intent-filter> 
```

现在我的下一个问题是如何从 .t​​est 文件启动我的应用程序，如果它导致我的 html5 无法工作。（我想我可以删除 http 过滤器，但我想点击下载并打开我的 .test 文件的网页上的链接。

# quartz-2d - 我可以从 CGContext 查询当前点吗？

> ID：11320003
> 
> 赞同：6
> 
> 时间：2012-07-03T22:19:48.687
> 
> 标签：quartz-2d, cgcontext

Apple 的 Quartz2d 编程指南说“Quartz 跟踪**当前点**，这是用于路径构建的最后一个位置。” 给定 CGContext 参考，我有什么方法可以查询当前点是什么？

我正在编写分段绘制图表的方法，看起来如果 CGContext 已经知道当前点是什么，我不应该编写单独跟踪它所需的逻辑。在方法调用中同时传递 CGContext 和当前点坐标似乎很愚蠢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-27T04:45:41.067

这就是我得到当前观点的方式：

```
CGPoint currentPoint = CGContextGetPathCurrentPoint(context);
NSLog(@"currentPoint: %@", NSStringFromCGPoint(currentPoint)); 
```

# c++ - 性能：原始类型的 typedef 与包装类？

> ID：11320004
> 
> 赞同：7
> 
> 时间：2012-07-03T22:20:07.063
> 
> 标签：c++, inline, micro-optimization

我想在 C++ 中定义一个新类型，它只是一些原始类型（在我的示例中，一个`int`, 可以是任何类型）。`NodeId`我在这个例子中调用类型。

我可以只使用`typedef int NodeId`. 我想要 s 的默认值`NodeId`，所以我会使用`#define NULL_NODE_ID -1`.

`typedef`现在，我认为定义一个类而不是允许一个函数`isValid()`和一个默认构造函数构造一个 null会更好`NodeId`：

```
class NodeId
{
    int value;
public:
    inline NodeId() : value(-1) {}
    inline NodeId(int value) : value(value) {}
    inline operator int() {return value;}
    inline bool isValid() {return value != -1;}
    //...
}; 
```

是否存在导致使用第二种方法的性能劣势？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-03T22:47:04.930

实际上，这可能会变慢有两个原因。

首先，无法创建未初始化的 NodeId。通常，这是一件*好事*。但是想象一下你有这样的代码：

```
NodeId nodeid;
foo.initializeNodeId(&nodeid); 
```

你会做一个实际上没有必要的额外任务。

您可以通过添加一个特殊的构造函数来解决这个问题。创建一个 Foo::createNodeId() 可能要好得多，这样你就不需要 Foo::initializeNodeId(&NodeId)，但如果你不控制 Foo 的定义，那可能是不可能的。

其次，NodeId 不是编译时常量表达式。正如 dasblinkenlight 所暗示的，这更可能导致代码不合法​​而不是导致性能问题，但两者都有可能。（为什么？因为您可能会强制编译器在运行时插入代码来执行一些计算，如果您使用的是 int，那么这可能在编译时完成。这对于名为 NodeId 的类来说可能不是问题...... )

幸运的是，如果您使用的是 C++11，则可以使用 constexpr 修复它。如果你希望你的代码也是合法的 C++03，你可以用一个宏来处理它。

此外，正如 dasblinkenlight 所指出的，您在两种方法中都缺少 const 。

最后，没有理由在类定义中定义的方法上写“内联”；它们本身就已经是内联的了。

把它们放在一起：

```
#if __cplusplus > 201000L
#define CONSTEXPR_ constexpr
#else
#define CONSTEXPR_
#endif

class NodeId
{
    int value;
public:
    struct Uninitialized {};
    CONSTEXPR_ NodeId() : value(-1) {}
    CONSTEXPR_ NodeId(Uninitialized) {}      
    CONSTEXPR_ NodeId(int value) : value(value) {}
    CONSTEXPR_ operator int() const {return value;}
    CONSTEXPR_ bool isValid() const {return value != -1;}
    //...
}; 
```

现在您可以这样做，以避免额外的 -1 分配成本。

```
NodeId nodeId(NodeId::Uninitialized());
foo.initializeNodeId(&nodeid); 
```

并且，为了合法地使用 NodeId 作为非类型模板参数：

```
myClassTemplate<NodeId(3)> c; 
```

或者，为了确保编译器可以合法地将 x 初始化为 4：

```
int x = 3;
x += NodeId(1); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-03T22:24:46.060

如果您使用相对较新的编译器，那么生成的代码应该是相同的。编译器内联这些成员函数应该没有问题。如果您真的对此有疑问，您可以随时反汇编可执行文件。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-03T22:28:02.593

如果编译器优化设置让编译器内联所有内容，那么应该没有性能差异。我能发现的唯一缺点是基于此类对象的表达式可能不再符合编译时常量的条件，这在模板编程中可能很重要。除此之外，您最终会获得额外的清晰度，而无需运行时成本。

* * *

`const`PS您在`operator int`and 中缺少`isValid`：

```
inline operator int() const {return value;}
inline bool isValid() const {return value != -1;} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-03T22:54:51.027

如果你打算把它做成一个库，可以被其他一些编程语言使用（比如如果你把它写成一个 C++ DLL），那么拥有一个`typedef int`.

例如，当您为 API 编写 python 包装器或 java 包装器时，将类和类型移植过来就不会那么头疼了。那么你只需要担心`int`.

# php - Python 字典能像 PHP 数组一样方便吗？

> ID：11320007
> 
> 赞同：-1
> 
> 时间：2012-07-03T22:20:16.123
> 
> 标签：php, python

最近，我正在做一个基于 Python 的项目，并面临一个字典问题。在 PHP 中，我可以通过以下指令轻松创建多维数组：

```
$user = "Tom";
$type = "New";
$userlist[$user]['count'] += 1;
$userlist[$user][$type] += 1; 
```

如果数组不存在，PHP 会在数组中创建一个新元素，这样编码非常方便。Python 字典能否提供与 PHP 相同且方便的功能？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-03T22:36:07.613

Python 并不像 PHP 那样神奇地实例化字典。但是，只要稍加考虑，您就可以让它为所欲为。

```
from collections import defaultdict, Counter

users = defaultdict(Counter)

users['Tom']['Count'] += 1
users['Tom']['New'] += 1 
```

（另外，当它不是一个列表时调用一个变量“somethinglist”可能是个坏主意，它`type`是一个 Python 关键字，所以也不要将它用作变量名！）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-03T22:31:40.977

您可以使用 Python 的 defaultdict （如[this answer](https://stackoverflow.com/a/2600813/183791)所示）：

```
from collections import defaultdict
user = "Tom"
type = "New"
userlist = defaultdict(lambda: defaultdict(int))
userlist[user]['count'] += 1
userlist[user][type] += 1 
```

# php - 如果 Ajax 请求太快，jQuery 动画将无法正常工作

> ID：11320010
> 
> 赞同：1
> 
> 时间：2012-07-03T22:20:26.317
> 
> 标签：php, javascript, jquery, ajax

我环顾四周，还没有找到答案。

我有一个 ajax 请求，当您单击按钮时，它会将信息发送到服务器并隐藏当前 div 并加载加载 gif。我已经设置好了，所以当服务器响应时它会摆脱加载 gif 并显示来自服务器的内容。

代码：

```
$("#submit").click(function(e){
    e.preventDefault();
    var $domain = $.fn.HTTP($('#domain').val());
    if(!$.fn.ValidURL($domain)){
      $('#domainerror').fadeIn(500);
      return false;
    } 

    if($('#domainerror').css('display')!=='none'){
      $('#domainerror').fadeOut(350);
    }

    $('#question').hide(500, function(){
        $('#waiting').show(350);
    });

    $.getJSON('http://localhost/file.php',
    {
        i: $domain
    },
      function(data){
        $('#answer').html(data.message + $('#trybutton').html());
        $('#waiting').hide(350, function(){
          $('#answer').show(350);
        });
    });
}); 
```

问题是 jQuery 从服务器接收响应太快，加载 gif 并没有消失。

但是，如果我告诉服务器休眠 3 秒，它就可以正常工作。这不是我想要的解决方案。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-03T22:25:38.290

当然，您的用户不必看到加载动画是一件好事，因为它是如此之快？！

无论如何，问题在于动画至少需要 500 毫秒 - 动画是异步处理的，与您的 AJAX 请求同时进行。在发送 AJAX 请求之前，不要让服务器休眠（这可以说是浪费 CPU），而是让浏览器等待。

将调用放入`setTimeout()`函数中，此示例将使其等待 3 秒：

```
setTimeout(function() {
    $.getJSON('http://localhost/file.php',
    {
        i: $domain
    },
    function(data){
        $('#answer').html(data.message + $('#trybutton').html());
        $('#waiting').hide(350, function(){
            $('#answer').show(350);
        });
    });
}, 3000); 
```

然而，理想的解决方案是不使用动画效果，而只使用 show() 和 hide()。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-03T22:26:00.413

消除显示等待动画的延迟，因此在请求返回时它仍然不显示。

```
 $('#question').hide() //was 500
 $('#waiting').show(); //was 350 
```

如果你加起来几乎一秒钟后。到那时，大多数系统中的 ajax 请求可能已经返回，所以到那时仍然不值得制作动画

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-03T22:26:37.463

似乎 ajax 回调是在问题隐藏结束之前执行的，然后`$('#waiting').show(350);`是`$('#waiting').hide(350, ...)`. 您有三种可能性来解决这个问题：

如果您立即**显示**`#waiting`img （不**等待**问题消失），这不会发生；答案也不应等待#waiting 隐藏。

* * *

或者你使用一个变量来表示当问题淡出时答案已经淡入，然后**不显示动画**：

```
var answered = false,
    waiting = false;
$('#question').hide(500, function(){
    if (!answered) {
        waiting = true;
        $('#waiting').show(350);
    }
});

$.getJSON('http://localhost/file.php', {
    i: $domain
}, function(data){
    $('#answer').html(data.message + $('#trybutton').html());
    answered = true;
    if (waiting) {
        $('#waiting').stop().hide(350, function(){
            $('#answer').show(350);
        });
    } else {
        $('#answer').show(350);
    }
}); 
```

* * *

如果您希望四个动画**始终连续显示**（**至少**1550 毫秒），则需要手动对其进行编码：

```
var showanswer = false;
$('#question').hide(500, function() {
    $('#waiting').show(350, function() {
        if (showanswer) // already loaded
           showanswer(); // execute callback
        else
           showanswer = true; // mark as shown
    });
});

$.getJSON('http://localhost/file.php', {
    i: $domain
}, function(data){
    $('#answer').html(data.message + $('#trybutton').html());
    function animate() {
        $('#waiting').hide(350, function(){
            $('#answer').show(350);
        });
    }
    if (showanswer) // waiting image shown
        animate();
    else
        showanswer = animate; // set as callback
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-03T22:27:00.567

使用 Javascript 的[setTimeout](http://www.w3schools.com/jsref/met_win_settimeout.asp)。代码可能看起来像这样（可能不完全是）：

```
setTimeout("getResponse()", 3000);

function getResponse() {
    $.getJSON('http://localhost/file.php',
    {
        i: $domain
    },
      function(data){
        $('#answer').html(data.message + $('#trybutton').html());
        $('#waiting').hide(350, function(){
          $('#answer').show(350);
        });
    });
} 
```

这样，您的 AJAX 请求仍将您的`i`变量发送到服务器，处理 file.php 中的代码并发送回您可以处理的数据。唯一的技巧是把它放在一个函数中（不是必需的，但它确实使`setTimeout`函数看起来更漂亮）并在 3000 毫秒后调用它。

# perl - 比较公共键合并值的多个哈希

> ID：11320012
> 
> 赞同：1
> 
> 时间：2012-07-03T22:20:57.993
> 
> 标签：perl, comparison, bioinformatics, hash

我在这里有一段工作代码，我将六个哈希的键一起比较，以找到它们之间共有的键。然后，我将每个散列中的值组合成一个新散列中的值。我想做的是使它可扩展。我希望能够轻松地将 3 个哈希值与 100 个哈希值进行比较，而无需返回我的代码并对其进行更改。关于我将如何实现这一目标的任何想法？其余代码已经适用于不同的输入量，但这是让我卡住的部分。

```
my $comparison = List::Compare->new([keys %{$posHashes[0]}], [keys %{$posHashes[1]}], [keys %{$posHashes[2]}], [keys %{$posHashes[3]}], [keys %{$posHashes[4]}], [keys %{$posHashes[5]}]);
my %comboHash;
for ($comparison->get_intersection) {
$comboHash{$_} = ($posHashes[0]{$_} . $posHashes[1]{$_} . $posHashes[2]{$_} . $posHashes[3]{$_} . $posHashes[4]{$_} . $posHashes[5]{$_});
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-03T23:20:29.620

```
my %all;
for my $posHash (@posHashes) {
   for my $key (keys(%$posHash)) {
      push @{ $all{$key} }, $posHash->{$key};
   }
}

my %comboHash;
for my $key (keys(%all)) {
   next if @{ $all{$key} } != @posHashes;
   $comboHash{$key} = join('', @{ $all{$key} });
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-03T23:06:29.677

*创建一个子程序：*

```
sub combine_hashes {
  my %result = ();
  my @hashes = @_;
  my $first = shift @hashes;
  for my $element (keys %$first) {
    my $count = 0;
    for my $href (@hashes) {
      $count += (grep {$_ eq $element} (keys %$href));
    }
    if ($count > $#hashes) {
      $result{$element} = $first->{$element};
      $result{$element} .= $_->{$element} for @hashes;
    }
  }
  \%result;
} 
```

*并通过以下方式调用它：*

```
my %h = %{combine_hashes(\%h1, \%h2, \%h3)}; 
```

*...或作为：*

```
my %h = %{combine_hashes(@posHashes)}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-03T23:21:02.973

只需创建一个子例程并将其传递给哈希引用

```
my $combination = combine(@posHashes);

sub combine {
    my @hashes = @_;
    my @keys;
    for my $href (@hashes) {
        push @keys, keys %$href;
    }
    # Insert intersection code here..
    # .....
    my %combo;
    for my $href (@hashes) {
        for my $key (@intersection) {
            $combo{$key} .= $href->{$key};
        }
    }
    return \%combo;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-04T21:04:36.570

有一个非常简单的解决方案：

```
sub merge {
    my $first = shift;
    my @hashes = @_;
    my %result;
    KEY:
    for my $key (keys %$first) {
        my $accu = $first->{$key};
        for my $hash (@hashes) {
            next KEY unless exists $hash->{$key};
            $accu .= $hash->{$key};
        }
        $result{$key} = $accu;
    }
    return \%result;
} 
```

您必须使用对哈希的引用来调用它，它也会返回哈希引用，例如：

```
my $comboHashRef = merge(@posHashes); 
```

# linux - 使用它的音频源和开源工具有效地生成预转录语音的时间索引

> ID：11320018
> 
> 赞同：2
> 
> 时间：2012-07-03T22:21:44.363
> 
> 标签：linux, speech-recognition, cmusphinx, transcription

在 TED.com 上，他们有转录，当点击转录的一部分时，他们会转到视频的相应部分。

我想在带有 OSS 的 Linux 上完成 80 小时的音频和转录。

这是我正在考虑的方法：

1.  从 30 分钟的样本开始
2.  将音频分成 2 分钟的 WAV 文件格式的块，即使它打断了单词
3.  在每个块上运行来自 CMU Sphinx 的长音频对齐器的短语检测器，并带有成绩单
4.  获取在每个位中找到的已识别单词/短语的时间索引，并计算原始音频文件中 ngram 的实际估计时间。

这看起来是一种有效的方法吗？有没有人真的这样做过？

是否有其他值得尝试的方法，例如可能足够准确的哑字计数？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T16:05:14.983

您可以在一个长音频对齐器中输入所有音频和文本，它会为您提供单词的时间戳。使用此时间戳，您可以跳转到文件中的特定单词。

我不确定您为什么要拆分音频或做其他事情。

# c# - 通过 WebReference 或通过实例化在同一网站内使用 Web 服务之间的性能

> ID：11320024
> 
> 赞同：2
> 
> 时间：2012-07-03T22:22:00.347
> 
> 标签：c#, asp.net, performance, web-services

看，我关心的是使用同一个网站/WebApplication 中的 WebService 更快/最好的方法。

想象一下，我在同一个网站中有 20 个页面和 1 个 WebService..

在每个页面中，我都必须使用 WebService 中的所有内容......

但我关心的是它应该如何消费？我应该添加在同一个网站中的 WebService 的 webreference，并使用该 Webservice 的代理生成的所有内容。或者我应该像普通类一样直接实例化 WebService 并使用这些方法？

我知道（或者我认为）最佳实践是将其用作 SOA especifications 的 webService 并在我的解决方案中的另一个网站中使用 WebService。

但我的推理是，使用 WebService 需要通过该协议发出请求的 http 协议，并且 Web 服务序列化响应......

我猜要注意的重要一点是，My WebService 的 webmethods 可以返回多个记录/信息/数据，因此序列化步骤可能是一个问题或性能问题。

我正在寻找这样做的最佳方法。

我应该将 WebService 移动到另一个站点并在我的页面中使用它吗？即使性能会受到影响？或者我不应该？如果是，多少钱？它会花费吗？还是影响不大？

如果我应该移动 WebService，如果我像 http:// localhost .. 而不是 ... 192.168.1.1 或 Web 域而不是 localhost 一样使用它，它会影响吗？它是一样的还是会影响某些东西？

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-03T22:24:37.203

> 但我的推理是，使用 WebService 需要通过该协议发出请求的 http 协议，并且 Web 服务序列化响应......

你的推理绝对正确。如果您在同一个项目中，则无需在无用的 HTTP 请求中浪费 CPU 周期。您可以直接调用您的 Web 服务方法已经使用的同一个存储库层。如果您需要非 .NET 客户端来使用它，您仍然可以使用可互操作的格式（例如 SOAP）公开 Web 服务，否则我认为没有必要这样做。实际上，您为什么首先开发 Web 服务？我猜你对未来的消费者有一些期望？经验法则是始终将可重用的服务域逻辑封装到服务层中，然后根据需要使用它的人，直接使用实现此功能的程序集（如果我们谈论的是 .NET 客户端），或者如果你需要互操作性，它'

但是，如果您对确切的数字感兴趣，请不要犹豫，执行一些负载测试，并比较直接从您的 cinsuming Web 应用程序中直接调用 .NET 方法与使用可互操作协议的 HTTP 请求之间的响应时间。

备注：WebReference 客户端现已弃用。如果您决定在整个网络连接中调用您的服务，则应该使用 ServiceReference。

# javascript - 在 Rails 中测试 JavaScript 视图

> ID：11320025
> 
> 赞同：12
> 
> 时间：2012-07-03T22:22:06.567
> 
> 标签：javascript, ruby-on-rails, bdd, konacha

在 Rails 中测试 JavaScript 视图（测试页面是否适用于 JavaScript）的最佳方法是什么？

因此，假设我有一个名为的页面`/users/new`，其中包含一个执行某些操作的表单。我想要它，以便我提交表单，JavaScript 测试工具会让我知道该页面是否中断。做这个的最好方式是什么？

我遇到了三个测试选项：

1.  **Konacha**（迄今为止 JS BDD 的最佳工具）[http://www.solitr.com/blog/2012/04/konacha-tutorial-javascript-testing-with-rails/](http://www.solitr.com/blog/2012/04/konacha-tutorial-javascript-testing-with-rails/)

2.  **JasmineRice** (Jasmine + Rails + Guard) [https://github.com/bradphelan/jasminerice/](https://github.com/bradphelan/jasminerice/)

3.  **水豚**Webkit。[https://github.com/thoughtbot/capybara-webkit](https://github.com/thoughtbot/capybara-webkit)

前两个基本上用于**BDD**和隔离测试。最后一个更适合我正在寻找的东西，但**我不想为 JavaScript BDD 和集成测试设置单独的测试设置**。

有没有人有更好的解决方案？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-27T08:27:47.263

检查 github 上的 Teaspoon 项目。

[https://github.com/modeset/teaspoon](https://github.com/modeset/teaspoon)

它支持 Mocha、Jasmine 和 QUnit.. 很好地支持使用 PhantomJS（或 Selenium Webdriver）无头运行您的规范，并允许使用完整的 Rails 资产管道（coffeescript、fixtures 等）。

此外，它还深受我与其他使用 Rails 的测试运行者的经验的影响。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-06T04:19:41.397

如果您使用的是 RSpec，您可以在 RSpec 集成测试中使用 Capybara：

```
spec/requests/my_spec.rb:

describe "my test", :js => true do
  it "should do something" do
    visit '/some/path'

    click_on 'Submit'

    page.should have_content 'Congratulations!'
  end
end 
```

记得设置`Capybara.javascript_driver = :webkit`。`spec_helper.rb`

# javascript - 解析加载某个脚本的脚本标签内的数据

> ID：11320031
> 
> 赞同：1
> 
> 时间：2012-07-03T22:22:34.267
> 
> 标签：javascript

有时你会看到这样的代码。

```
<script type="text/javascript" src="https://apis.google.com/js/plusone.js">
      {lang:'en', parsetags:'explicit'}
</script> 
```

我想知道如何从加载的脚本中解析这个脚本标签内的对象文字。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-03T22:25:46.057

```
var scripts = document.getElementsByTagName('script');
var thisScriptTag = scripts[scripts.length - 1];
var data = thisScriptTag.textContent || thisScriptTag.innerText;
alert(data); 
```

如果您有 JSON 数据，您将使用`JSON.parse()`该数据将数据转换为 JavaScript 对象。请注意，代码不得包装在 DOMready/onload 事件中 - 它需要在`<script>`处理该标记时立即运行。

[获取当前脚本标签的代码取自[如何引用加载当前执行脚本的脚本标签？](https://stackoverflow.com/questions/403967/how-may-i-reference-the-script-tag-that-loaded-the-currently-executing-script)]

# jquery - 在文档开始时调用更改函数

> ID：11320036
> 
> 赞同：0
> 
> 时间：2012-07-03T22:23:15.343
> 
> 标签：jquery

我已经实现了以下代码：

```
$('#select1').change(function() {
    var options = '';
    if($(this).val() == 'a') {
        options = '<option value="1">1</option><option value="2">2</option>';
    }
    else if ($(this).val() == 'b'){
        options = '<option value="3">3</option><option value="4">4</option>';
    }

    $('#select2').html(options);
}); 
```

当文档被初始化时，我想第一次调用更改函数来填充我的`select`，而不是更改选项来触发`change`。这可能吗？如何？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-03T22:25:00.357

这应该做的工作：

```
$("#select1").trigger("change"); 
```

甚至更短：

```
$("#select1").change(); 
```

所以最后你的代码可能看起来像这样：

```
$(function() {
    $("#select1").change(function() {
        var options = "";
        if ($(this).val() == "a") {
            options = '<option value="1">1</option><option value="2">2</option>';
        } else if ($(this).val() == "b") {
            options = '<option value="3">3</option><option value="4">4</option>';
        }

        $("#select2").html(options);
    }).trigger("change");
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-03T22:26:20.693

在事件中触发change[`ready`](http://api.jquery.com/ready/)事件。

```
$(function(){      

  $('#select1').change(function() {
     var options = '';
     if($(this).val() == 'a') {
         options = '<option value="1">1</option><option value="2">2</option>';
     } 
     else if ($(this).val() == 'b'){
         options = '<option value="3">3</option><option value="4">4</option>';
     }
     $('#select2').html(options);
  });

  $("#select1").trigger("change");  

}); 
```

# ruby-on-rails - Ruby on Rails“未指定重复运算符的目标”

> ID：11320038
> 
> 赞同：0
> 
> 时间：2012-07-03T22:23:43.917
> 
> 标签：ruby-on-rails, linux, ruby-on-rails-3

我突然管理的应用程序（重启后）显示以下错误；

```
target of repeat operator is not specified: /\A\/(*hn)(?:\.([^\/.?]+))?\Z/ 
```

该代码在我的 Macbook（开发和生产环境）上运行良好，但在我的服务器上我看到了上述 500 消息。

这是堆栈跟踪；

```
journey (1.0.3) lib/journey/path/pattern.rb:94:in `accept'
journey (1.0.3) lib/journey/path/pattern.rb:177:in `to_regexp'
journey (1.0.3) lib/journey/path/pattern.rb:167:in `match'
journey (1.0.3) lib/journey/router.rb:129:in `block in find_routes'
journey (1.0.3) lib/journey/router.rb:128:in `each'
journey (1.0.3) lib/journey/router.rb:128:in `find_all'
journey (1.0.3) lib/journey/router.rb:128:in `find_routes'
journey (1.0.3) lib/journey/router.rb:56:in `call'
actionpack (3.2.0) lib/action_dispatch/routing/route_set.rb:570:in `call'
sass (3.1.15) lib/sass/plugin/rack.rb:54:in `call'
warden (1.1.1) lib/warden/manager.rb:35:in `block in call'
warden (1.1.1) lib/warden/manager.rb:34:in `catch'
warden (1.1.1) lib/warden/manager.rb:34:in `call'
actionpack (3.2.0) lib/action_dispatch/middleware/best_standards_support.rb:17:in `call'
rack (1.4.1) lib/rack/etag.rb:23:in `call'
rack (1.4.1) lib/rack/conditionalget.rb:25:in `call'
actionpack (3.2.0) lib/action_dispatch/middleware/head.rb:14:in `call'
actionpack (3.2.0) lib/action_dispatch/middleware/params_parser.rb:21:in `call'
actionpack (3.2.0) lib/action_dispatch/middleware/flash.rb:242:in `call'
rack (1.4.1) lib/rack/session/abstract/id.rb:205:in `context'
rack (1.4.1) lib/rack/session/abstract/id.rb:200:in `call'
actionpack (3.2.0) lib/action_dispatch/middleware/cookies.rb:338:in `call'
activerecord (3.2.0) lib/active_record/query_cache.rb:64:in `call'
activerecord (3.2.0) lib/active_record/connection_adapters/abstract/connection_pool.rb:443:in `call'
actionpack (3.2.0) lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'
activesupport (3.2.0) lib/active_support/callbacks.rb:405:in `_run__567979529779051348__call__4075940477208431972__callbacks'
activesupport (3.2.0) lib/active_support/callbacks.rb:405:in `__run_callback'
activesupport (3.2.0) lib/active_support/callbacks.rb:385:in `_run_call_callbacks'
activesupport (3.2.0) lib/active_support/callbacks.rb:81:in `run_callbacks'
actionpack (3.2.0) lib/action_dispatch/middleware/callbacks.rb:27:in `call'
actionpack (3.2.0) lib/action_dispatch/middleware/reloader.rb:65:in `call'
actionpack (3.2.0) lib/action_dispatch/middleware/remote_ip.rb:31:in `call'
actionpack (3.2.0) lib/action_dispatch/middleware/debug_exceptions.rb:16:in `call'
actionpack (3.2.0) lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'
railties (3.2.0) lib/rails/rack/logger.rb:26:in `call_app'
railties (3.2.0) lib/rails/rack/logger.rb:16:in `call'
actionpack (3.2.0) lib/action_dispatch/middleware/request_id.rb:22:in `call'
rack (1.4.1) lib/rack/methodoverride.rb:21:in `call'
rack (1.4.1) lib/rack/runtime.rb:17:in `call'
activesupport (3.2.0) lib/active_support/cache/strategy/local_cache.rb:72:in `call'
rack (1.4.1) lib/rack/lock.rb:15:in `call'
actionpack (3.2.0) lib/action_dispatch/middleware/static.rb:53:in `call'
railties (3.2.0) lib/rails/engine.rb:479:in `call'
railties (3.2.0) lib/rails/application.rb:220:in `call'
rack (1.4.1) lib/rack/content_length.rb:14:in `call'
railties (3.2.0) lib/rails/rack/log_tailer.rb:14:in `call'
rack (1.4.1) lib/rack/handler/webrick.rb:59:in `service'
/home/deploy/.rvm/rubies/ruby-1.9.2-p320/lib/ruby/1.9.1/webrick/httpserver.rb:111:in `service'
/home/deploy/.rvm/rubies/ruby-1.9.2-p320/lib/ruby/1.9.1/webrick/httpserver.rb:70:in `run'
/home/deploy/.rvm/rubies/ruby-1.9.2-p320/lib/ruby/1.9.1/webrick/server.rb:183:in `block in start_thread' 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T01:28:30.930

没关系。发现一个有问题的路线条目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-03T22:27:09.070

您的服务器运行的 Ruby 版本是否与您的开发环境相同？这正是我希望看到的是否存在版本差异。

# mysql - MySQL 获得最高平均条目

> ID：11320039
> 
> 赞同：2
> 
> 时间：2012-07-03T22:23:47.193
> 
> 标签：mysql

我正在尝试编写一个 mysql 查询来返回平均课程评分最高的前 3 门课程。我有两张表，评级和课程。

评分表：

```
courseId    rating  
   1           6    
   2           2        
   1           4
   2           5
   3           3
   4           0
   6           0 
```

课程表：

```
courseId        cnum        cname
   1            100         name1
   2            112         name2
   3            230         name3
   4            319         name4
   5            122         name5
   6            320         name6 
```

我需要返回平均评分最高的前 3 门课程。任何想法我怎么能做到这一点？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-03T22:27:05.090

```
SELECT Courses.*
FROM   Courses NATURAL JOIN (
  SELECT   courseId, AVG(rating) avg_rating
  FROM     Ratings
  GROUP BY courseId
  ORDER BY avg_rating DESC
  LIMIT    3
) t 
```

在[sqlfiddle](http://sqlfiddle.com/#!2/07768/1/0)上查看。

# c# - 如何通过 getJSON 将许多变量传递给我的 WebService？

> ID：11320043
> 
> 赞同：1
> 
> 时间：2012-07-03T22:24:13.737
> 
> 标签：c#, javascript, jquery, web-services, rest

我想将大量变量传递给 Web 服务（大约 60 个），并且我想知道是否有更好的方法来实现这一点。目前，我正在使用 GET 并且能够通过 URI 传递参数（例如 blahblah.com/People/{person_id} ），虽然这对于传递 ID 之类的东西非常有用，但它看起来有很多变量不好，很麻烦。我知道通过 POST 代替它可以让我传递我的许多变量，而无需创建一个巨大的 URL 并让 WebService 处理映射。我想这样做，但是只是在我的 [WebInvoke(...)] 注释中将我的 Method 值从 GET 更改为 POST 就会出现“不允许”类型的消息。我敢肯定，我缺少一些简单的东西，并且很想获得一些见解。还，

如果前面的内容对我的服务器端不明显，我在 Visual Studio 2008 中将 C# 用于面向 .NET Framework 3.5 的 RESTful Web 服务。我相信该应用程序是一个“Web 服务”，因为实际代码位于一个名为 MyRestService.svc.cs 的文件中。

对于我的客户端，我使用标准的 HTML/CSS/JS/jQuery（我没有在客户端使用 aspx）。为了从服务器中提取，我使用了 $.getJSON() 函数。

请让我知道我遗漏了哪些可以帮助您的信息。

感谢您的关注，

jnsohnumr

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-03T22:41:05.887

更改`[WebInvoke]`注释将在服务器端设置您，但您仍然告诉 jQuery 从浏览器执行 GET。根据[docs](http://api.jquery.com/jQuery.getJSON/)， $.getJson 是以下的简写：

```
$.ajax({
  url: url,
  dataType: 'json',
  data: data,
  success: callback
}); 
```

因此，您可以将 $.getJson 调用替换为对 $.ajax 的调用，但使用附加参数使其使用 POST：

```
$.ajax({
  url: url,
  type: 'POST', // Use POST instead of GET
  dataType: 'json',
  data: data, // A javascript object with fifty variables on it.
  success: callback
}); 
```

PS——如果你在一个网络请求中传递了五十个变量，这表明你可能正在将请求用于属于其他地方的东西（比如用户的会话）。您可能需要重新考虑您的整个方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-03T22:35:16.903

对于 GET 请求，即使您将数据整齐地打包到客户端上的 JS 对象中，最终它也会被发送为`file.php?var1=1&var2=2`etc。

这很好，除了：

*   服务器有时会响应“URL 太长”错误代码（我忘记了实际代码）
*   浏览器对 URL 长度有自己的限制（例如，IE 是或至少曾经是 2083 个字符）

GET 还存在安全隐患，但如果您正在考虑 GET，我猜您已经了解了。

当然，POST 可以避免此类问题。最好的做法是让服务器接受 POST，但我不知道这对你来说有多可行。

回到 GET ......我不知道 C#，但在 PHP 中有一个 GET 超全局变量，它可以接收所有这些传入变量并将它们打包到一个关联数组中。

```
$_GET; //array of incoming GET vars 
```

如果 C# 中没有类似的东西，那么最好的办法是反序列化为服务器上的其他结构。

希望这个漫步助手的任何部分。

# android - 如何通过 XML 将 textview 的背景颜色设置为全息绿光？

> ID：11320044
> 
> 赞同：23
> 
> 时间：2012-07-03T22:24:17.247
> 
> 标签：android

我有一个文本视图，我可以将其背景颜色设置为全息绿光，如此[处所述。](http://developer.android.com/reference/android/R.color.html)

但是，我不知道如何通过 XML 做到这一点。是否可以？我目前有：

```
 <TextView
        android:text="2"
        android:textSize="200sp"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:id="@+id/textView2"
        android:background="#00FF00"
        android:gravity="center"
        android:textColor="#EEEEEE"
        android:layout_alignParentRight="true" /> 
```

但是，我无法将 android:background 更改为以某种方式引用全息绿灯。

有没有人有什么建议？我试过“@android:color/”但没有骰子。

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-07-03T22:41:48.287

通过 Java：

```
TextView test = (TextView) view.findViewById(R.id.textView2);
test.setBackgroundResource(context.getResources().getColor(android.R.color.holo_green_light)); 
```

通过 XML：

```
 <TextView
        android:text="2"
        android:textSize="200sp"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:id="@+id/textView2"
        android:style="@style/textviewStyle" 
        android:background="@android:color/holo_green_light"
        android:gravity="center"
        android:textColor="#EEEEEE"
        android:layout_alignParentRight="true" /> 
```

[这](http://developer.android.com/guide/topics/resources/accessing-resources.html#ResourcesFromXml)是有关此主题的 API 页面

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-07-03T22:36:07.087

`android:background="@android:color/holo_green_light"`似乎对我有用。您的目标 API 版本确实包含 Holo 主题，对吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-01-13T00:01:43.083

添加新信息也可能对某人有所帮助，您也可以通过 java 做到这一点

```
 textView.setBackgroundResource(R.color.the_color_you_defind_in_your_colors_._xml); 
```

# android - 索尼爱立信安卓不支持APK文件

> ID：11320050
> 
> 赞同：-1
> 
> 时间：2012-07-03T22:24:47.630
> 
> 标签：android

我想在我的手机上尝试我的android应用程序，所以我去移动硬盘并调用文件夹`LMCO3`然后运行我的模拟器，然后去`bin`我的项目文件夹上的文件夹，我复制`apk`并把它放在`LMCO3`文件夹中，然后我导航到从我的手机中获取该文件夹并收到此消息`There are no suppored files in this folder`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-03T22:30:34.747

我相信发生这种情况的原因是因为 apk 已打包，但并未实际安装在您的设备上。

我的一些朋友遇到了这个问题，我们绕过它的方法是使用来自 Google Play 的免费应用程序来查找并安装在您的设备上找到的 apk。

[https://play.google.com/store/apps/details?id=com.graphilos.apkinst&hl=en](https://play.google.com/store/apps/details?id=com.graphilos.apkinst&hl=en)

希望这可以帮助！

# bash - 针对 MongoDB 数据库中的测试数据运行 node.js 测试

> ID：11320052
> 
> 赞同：0
> 
> 时间：2012-07-03T22:24:50.473
> 
> 标签：bash, node.js, shell, mongodb

我正在尝试设置一个脚本来为我的使用 MongoDB 的 node.js 程序执行测试。我的想法是我想要一个可以运行的脚本：

1.  启动 MongoDB 进程，作为守护进程分叉
2.  用一些测试数据预先填充数据库
3.  永远启动我的节点服务器，因此它作为守护进程运行
4.  运行我的测试
5.  从数据库中删除测试数据

我有一个执行所有这些步骤的粗略脚本。我的问题是 MongoDB 需要花费可变的时间来设置，这导致`sleep`在我的脚本中调用。因此，它只是偶尔起作用。

> ```
> # the directory of this script
> DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"
> 
> # launch mongodb.
> $DIR/../../db/mongod --fork --logpath ./logs/mongodb.log --logappend --dbpath ./testdb/ --quiet 
> 
> # takes a bit of time for the database to get set up, 
> # and since we make it a daemon process we cant run the tests immediately
> sleep 1
> 
> # avoid EADDRINUSE errors because existing node servers are up.
> killall node &> /dev/null
> 
> # start up our node server using a test database.
> forever start $DIR/../main.js --dbname=testdb --logpath=test/logs/testlog.log
> 
> # takes a bit of time for node to get set up, 
> # and since we make it a daemon process we cant run the tests immediately
> sleep 1
> 
> # run any database setup code (inject data for testing)
> $DIR/../../db/mongo 127.0.0.1:27017/testdb $DIR/setup.js --quiet
> 
> # actually run the tests
> node $DIR/tests.js
> 
> # kill the servers (this could be a little less heavy handed...)
> killall node &> /dev/null
> killall forever &> /dev/null
> 
> # finally tear down the database (drop anything we've added to the test db)
> $DIR/../../db/mongo 127.0.0.1:27017/testdb $DIR/teardown.js --quiet
> 
> # and then shut mogodb down
> kill -2 `ps ax | grep mongod | grep -v grep | awk '{print $1}'` 
> ```

做我想做的事情的最好方法是什么？我会在这里陷入困境，还是我错过了 MongoDB 文档中的某些内容？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T03:16:22.777

问问自己你的测试目的是什么：是测试代码中的实际数据库连接，还是关注你的代码是否正确处理和处理来自数据库的数据？

假设您的代码是在 Javascript 中，如果您严格想要测试您的代码逻辑是否正确处理数据，并且正在使用 MongoDB 包装器对象类（即 Mongoose），您可能有兴趣添加到您的工作流程中的一件事是创建和使用[Jasmine](http://pivotal.github.com/jasmine/)测试套件运行规范测试。

这将涉及编写测试代码，将测试数据模拟为 javascript 对象。是的，这意味着来自数据库本身的任何实际数据都不会参与您的规范测试。毕竟，您的主要目的是测试您的代码是否在逻辑上正常工作？这是你的项目，只有你知道答案:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T04:00:00.813

如果您的主要问题是如何找出 mongod 实际启动的时间，为什么不编写一个脚本来告诉您呢？

例如，您可以编写一个直到循环并根据返回值检查客户端是否可以在 mongo 服务器上正确连接。例如，不要`sleep 1`使用这样的东西：

```
isMongoRunning=-1

until [[ ${isMongoRunning} -eq 0 ]]; do
        sleep 1
        $DIR/../../db/mongo 127.0.0.1:27017/testdb $DIR/empty.js --quiet
        isMongoRunning=${?}
done 
```

这个循环只会在 mongodb 启动后结束。

你们中的一些人还想改进 mongodb 添加`--pidfilepath`到您的 mongod 执行行的停止，以便您可以轻松找到要终止的进程。

# ruby-on-rails - 如何在 routes.rb 中使用 GET 变量重定向 URL 而 Rails 不首先删除变量？

> ID：11320060
> 
> 赞同：1
> 
> 时间：2012-07-03T22:25:03.987
> 
> 标签：ruby-on-rails, ruby-on-rails-3, routes, rack, http-status-code-301

我正在 Rails 中建立一个网站来替换现有网站。在`routes.rb`我试图将一些旧 URL 重定向到它们的新等价物（一些 URL slug 正在发生变化，因此不可能使用动态解决方案。）

我的`routes.rb`样子是这样的：

```
 match "/index.php?page=contact-us" => redirect("/contact-us")
  match "/index.php?page=about-us" => redirect("/about-us")
  match "/index.php?page=committees" => redirect("/teams") 
```

当我访问`/index.php?page=contact-us`时，我不会被重定向到`/contact-us`. 我已经确定这是因为 Rails 正在删除 get 变量并且只尝试匹配`/index.php`. 例如，如果我通过`/index.php?page=contact-us`以下路线，我将被重定向到`/foobar`：

```
 match "/index.php?page=contact-us" => redirect("/contact-us")
  match "/index.php?page=about-us" => redirect("/about-us")
  match "/index.php?page=committees" => redirect("/teams")
  match "/index.php" => redirect("/foobar") 
```

如何将 GET 变量保留在字符串中并以我想要的方式重定向旧 URL？Rails 是否为此提供了预期的机制？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-04T16:41:48.663

我有类似的情况，这就是我所做的：

通过一个操作创建一个处理重定向的控制器

```
RedirectController < ApplicationController
  def redirect_url
    if params[:page]
      redirect_to "/#{params[:page]}", :status => 301
    else
      raise 404 #how handle your 404
  end
end 
```

**在路线.rb**

```
match "/index.php" => "redirect#redirect_url" 
```

# iphone - iPod Touch CLLocation 跟踪限制？

> ID：11320066
> 
> 赞同：0
> 
> 时间：2012-07-03T22:25:38.743
> 
> 标签：iphone, ios, geolocation, ipod-touch

我只是想知道是否有人知道 ipod touch 在设备的位置跟踪方面是否有任何限制？你能得到设备的长/纬度和高度吗？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-03T22:29:57.023

iPod touch 没有 GPS 或手机信号塔定位功能，所以是的，有一些限制。

它将从附近的任何 Wifi 点获取纬度/经度，但不会有任何高度信息。

也可以看看;

[如何使用 iPod Touch（第 4 代）获取 gps 位置](https://stackoverflow.com/questions/4166378/how-to-get-gps-location-with-an-ipod-touch-4th-gen)

# iphone - 如何添加单击键盘时引发的 uitextfield

> ID：11320068
> 
> 赞同：0
> 
> 时间：2012-07-03T22:25:40.943
> 
> 标签：iphone, objective-c, xcode

嗨，有人可以帮我创建这个功能吗，我想在我的应用程序底部有一个文本框，一旦用户点击它，它应该将该文本框提升到键盘正上方的屏幕中间。类似于 Skype 应用程序，谢谢！![在此处输入图像描述](../Images/63655a52a9c27056fb9fc6d1ad234db2.png)

![在此处输入图像描述](../Images/1e0489053015c4d80f8b487b9ec6c58b.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T00:24:23.467

试试这个

```
#define kKeyboardAnimationDuration 0.3
@interface YourViewController:UIViewController
{
    BOOL keyboardIsShown;
} 
```

然后在你的实现中

```
- (void)viewDidLoad
{
// register for keyboard notifications
    [[NSNotificationCenter defaultCenter] addObserver:self 
                                             selector:@selector(keyboardWillShow:) 
                                                 name:UIKeyboardWillShowNotification 
                                               object:self.view.window];
    // register for keyboard notifications
    [[NSNotificationCenter defaultCenter] addObserver:self 
                                             selector:@selector(keyboardWillHide:) 
                                                 name:UIKeyboardWillHideNotification 
                                               object:self.view.window];

    keyboardIsShown = NO;
}

- (void)viewDidUnload
{
[super viewDidUnload];
    // Release any retained subviews of the main view.
    // e.g. self.myOutlet = nil;

    // unregister for keyboard notifications while not visible.
    [[NSNotificationCenter defaultCenter] removeObserver:self 
                                                    name:UIKeyboardWillShowNotification 
                                                  object:nil]; 
    // unregister for keyboard notifications while not visible.
    [[NSNotificationCenter defaultCenter] removeObserver:self 
                                                    name:UIKeyboardWillHideNotification 
                                                  object:nil]; 
}

#pragma mark - Keyboard Events
- (void)keyboardWillShow:(NSNotification *)n
{
    if (keyboardIsShown) 
    {
        return;
    }

    NSDictionary* userInfo = [n userInfo];
    CGSize keyboardSize = [[userInfo objectForKey:UIKeyboardFrameBeginUserInfoKey] CGRectValue].size;

    CGRect viewFrame = self.view.frame;
    viewFrame.origin.y-= (keyboardSize.height);

    [UIView beginAnimations:nil context:NULL];
    [UIView setAnimationBeginsFromCurrentState:YES];
    [UIView setAnimationDuration:kKeyboardAnimationDuration];
    [self.view setFrame:viewFrame];
    [UIView commitAnimations];

    keyboardIsShown = YES;
}

- (void)keyboardWillHide:(NSNotification *)n
{
    NSDictionary* userInfo = [n userInfo];
    CGSize keyboardSize = [[userInfo objectForKey:UIKeyboardFrameBeginUserInfoKey] CGRectValue].size;

    CGRect viewFrame = self.view.frame;
    viewFrame.origin.y+= (keyboardSize.height);

    [UIView beginAnimations:nil context:NULL];
    [UIView setAnimationBeginsFromCurrentState:YES];
    [UIView setAnimationDuration:kKeyboardAnimationDuration];
    [self.view setFrame:viewFrame];
    [UIView commitAnimations];

    keyboardIsShown = NO;
} 
```

# silverlight - Internet Explorer 将不同的用户代理字符串发送到不同的站点

> ID：11320069
> 
> 赞同：4
> 
> 时间：2012-07-03T22:25:44.203
> 
> 标签：silverlight, internet-explorer, user-agent

我现在正在尝试使用 silverlight 应用程序来查找错误。我们从 HtmlPage.BrowserInformation 类获取浏览器信息，但它似乎返回了不正确的信息。在 IE9 上运行时，浏览器信息显示它运行在 8.0 版上。我打开 Fiddler 看看在 HTTP 级别发生了什么，这是我为我的测试服务器获取的用户代理字符串（测试服务器运行我们自己的服务器软件，它使用 WCF 进行 HTTP 请求）：

> 用户代理：Mozilla/4.0（兼容；MSIE 7.0；Windows NT 6.1；WOW64；Trident/5.0；SLCC2；.NET CLR 2.0.50727；.NET CLR 3.5.30729；.NET CLR 3.0.30729；Media Center PC 6.0 ；InfoPath.3；.NET4.0C；.NET4.0E)

这是我访问任何其他站点时的用户代理字符串：

> 用户代理：Mozilla/5.0（兼容；MSIE 9.0；Windows NT 6.1；WOW64；Trident/5.0）

我不确定 BrowserInformation 类是如何工作的（即，它的所有信息是来自用户代理字符串还是来自其他地方）。对此的任何见解都会有所帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-10T16:01:39.333

从您的问题可以清楚地看出您不是 IE 用户。

解决您的问题，您需要将其添加到所有页面：

```
<meta http-equiv="X-UA-Compatible" content="IE=edge" /> 
```

在 head 标签之后添加它很重要，如下所示：

```
<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge" /> 
```

# linux - 仅使用 AH 的 Linux IPSec 传输模式

> ID：11320071
> 
> 赞同：1
> 
> 时间：2012-07-03T22:25:47.837
> 
> 标签：linux, ipsec

我计划通过公共 VPS 提供商托管我的网络应用基础设施。由于与他一起托管的所有 VPS 都可以访问 VPS 主机的专用网络，并且由于许多基础架构组件没有任何类型的访问控制/身份验证，因此我需要将我的 VPS 与其他 VPS 隔离，并且只让我的 VPS 在它们之间连接他们自己。我还需要以尽可能少的开销透明地完成此操作。我不需要隐私和加密。

我发现只有 AH 和共享密钥的 IPsec 可以做到这一点，但我希望这样的设置可以与任意数量的主机/VPS 一起使用。我不想为虚拟网络中的每个可能对定义共享密钥，并且我的虚拟网络应该扩展到所有知道共享密钥的 VPS/主机。

这可以通过 Linux 内核中当前的 IPSec 实现来完成吗？

任何指向网络上的教程/操作方法的链接都非常有用！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-24T20:17:52.253

请查看传输模式下的 ESP，因为不建议使用 AH，并且现代实现可能不支持。

您可以将 ESP 与仅身份验证和 NULL 加密一起使用，类似于 AH。

*   [http://www.unixwiz.net/techtips/iguide-ipsec.html](http://www.unixwiz.net/techtips/iguide-ipsec.html)
*   [http://www.networksorcery.com/enp/protocol/esp.htm](http://www.networksorcery.com/enp/protocol/esp.htm)

要建立 IPSec 配置，您可以查看 IPSec 工具： http: [//ipsec-tools.sourceforge.net/](http://ipsec-tools.sourceforge.net/) - 您将使用“setkey”命令来玩 SAD 和 SPD：

*   [http://www.nbi.dk/cgi-bin/man2html?8+setkey](http://www.nbi.dk/cgi-bin/man2html?8+setkey)
*   [http://www.ipsec-howto.org/x304.html](http://www.ipsec-howto.org/x304.html)

“-E null”（RFC 2410）将为您提供空加密。使用“-A please”设置所需的身份验证。您可以指定范围策略以涵盖所有传入和传出流量。

# javascript - 基于索引动态创建时间的for循环逻辑

> ID：11320076
> 
> 赞同：1
> 
> 时间：2012-07-03T22:26:13.207
> 
> 标签：javascript

所以我有 43 个单选按钮。When one of them is selected, it returns their index number. 它是从零开始的，所以它是 0-42。每个索引对应一个特定的时间。0 是上午 8:00，42 是晚上 10:00，每个指数增加 20 分钟的时间。本质上，我试图生成我需要的时间，而不必为每个索引手动创建 if 语句。这是我到目前为止的损坏代码。

```
function decipherIndex(radx) {
    var actime = "";
    var hr = 8;
    var min = 0;
    var day = "am";
    for (i=0;i<radx;i++) {
        min = min + 20;
        if (min = 60) {
            hr = hr + 1;
            min = 0;
        }
        if (hr = 13) {
            hr = 0;
            day = "pm";
        }
    }
    actime = hr + ":" + min + day;
    alert(actime);
} 
```

希望有人可以帮助我在这里解决我的逻辑。radx 是传递给函数的索引。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-03T22:27:03.437

```
if (min = 60) {
    hr = hr + 1;
    min = 0;
}
if (hr = 13) {
    hr = 0;
    day = "pm";
} 
```

您正在分配`=`, 所以`min`并且`hr`将永远是`0`并且`day`将永远是`"pm"`。使用`==`or`===`比较：

```
if (min == 60) {
    hr = hr + 1;
    min = 0;
}

if (hr == 13) {
    hr = 0;
    day = "pm";
} 
```

* * *

但是，循环不是必需的。你所需要的只是一点数学知识。

```
function decipherIndex(i) {
    var t = 60 * 8 + i * 20;
    var min = t % 60;
    var hr = t / 60 | 0;

    return hr % 12 + ':' + (min < 10 ? '0' : '') + min + (hr >= 12 ? ' PM' : ' AM');
} 
```

# javascript - 删除 HTML 标记并保留文本

> ID：11320078
> 
> 赞同：2
> 
> 时间：2012-07-03T22:26:25.200
> 
> 标签：javascript, jquery, html

有没有办法删除 HTML 块引用标签，但保留文本？基本上，如果在我的代码中是`<blockquote>Hello!</blockquote>`，我希望它显示为`Hello!`- 我不知道是否有办法过滤掉块引用或只是克隆文本，但答案会很有帮助！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-03T22:29:34.690

[`contents`](http://api.jquery.com/contents/)与 一起使用[`unwrap`](http://api.jquery.com/unwrap/)：

```
$("blockquote").contents().unwrap(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-03T22:32:18.823

您可以使用`.html()`来实现这一点

```
$("blockquote").html() 
```

查看[这个运行示例](http://jsfiddle.net/SpykC/)

# build - Sublime Text 构建和运行

> ID：11320081
> 
> 赞同：0
> 
> 时间：2012-07-03T22:26:37.940
> 
> 标签：build, sublimetext2

Notepad++ 有一个“运行”功能，您可以在其中简单地运行“$(full_current_path)”，它将使用其默认程序运行您正在处理的文件。

Sublime Text 有什么方法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T11:51:45.147

在 ST2 中，您可以在以下位置设置其构建系统：Tools > Build System > New Build System

在这里你可以找到手册[https://www.sublimetext.com/docs/3/build_systems.html](https://www.sublimetext.com/docs/3/build_systems.html)

# vim - 有没有办法在 vim 中获得整数对象运动？

> ID：11320083
> 
> 赞同：6
> 
> 时间：2012-07-03T22:26:47.043
> 
> 标签：vim

我经常处理 CSS 文件或其他需要旋转数字的文件。我希望能够拥有一个以`w`引用单词或`(`引用句子的方式引用整数的键。例如，在一个 css 文件中，我可以导航到一个高度声明的开头，并更改它的值，而不必在结尾处重新键入“px”，如果我使用`w`.

有没有这样的事情，但我在文档中遗漏了它，或者有没有办法将此功能添加到我的 .vimrc 中？

如果有一种方法可以使用它，例如`ci"`我可以在行首的位置并使用“更改内部”命令跳转到并更改下一个整数，则可以加分。

如果我能做简单的算术，更多的奖励积分。我希望能够发出一个简明的命令，它是“Add too, internal, integer, 5”的缩写，并且让当前行上的下一个整数比我开始时大五。

**编辑：**

每个人都有一些非常棒的建议，一些很棒的想法肯定会改善我的工作。谢谢！Hassek 的回答可能最有可能出现在我的工作流程中，但其他人似乎都没有（完全）回答我最初的问题：适用于整数的运动。romainl 追踪的提案似乎有这个目标~~，但我无法让它可靠地工作~~。

**对于我自己（也许还有其他人），我将在下面阐明我的需求：**

一个键在很大程度上`w`作用于单词，但作用于整数，这样我就可以简单地将它添加到我的精神 vim 词汇表中并无缝使用它。这包括以下场景。（我将`d`用作我的示例键）：

1.  普通模式`d`：跳转到下一个整数
2.  普通模式`cd`：更改到光标下整数的末尾（注意这`cw`是一个特殊情况，应该更改为 NEXT 单词。`cw`实际上就像`ce`。）我希望这种特殊情况也可以用整数来实现
3.  可视模式`id`：选择 [count] 个整数。
4.  可视模式`ad`：选择 [count] 个整数。包括前导或尾随空格。

我是否错过`w`了新动议可能预期的任何行为？在普通模式和视觉模式下是否都有可用的键？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-03T22:37:04.117

您可以使用以下命令添加或减去整数：

```
<num>Ctrl-a (to add)
<num>Ctrl-x (to substract) 
```

它将直接进入下一个数字并执行命令

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-04T06:31:55.380

请参阅[此建议](http://twitter.com/dotvimrc/statuses/184280754686144512)。这看起来不错的样子。

***编辑***

确实，那一款相当不错。这让我觉得我这样做的习惯`/<number><Esc>`不是很有效，所以我将这些映射（并稍微修改了上面的映射以保持一致性）添加到我的`~/.vimrc`. 让我们看看它们从长远来看是否有用：

```
nnoremap è  /\v\d+<CR>
nnoremap é  ?\v\d+<CR> 
```

乍一看，`èciè132<Esc>`似乎比`/2<Esc>{count}s132<Esc>`按键要好一点，但如果它允许我跳过 a. 检查我要更改的值的第一位数字和 b。计算要替换的字符。

时间会证明一切。

***重新编辑***

以下是函数及其映射：

```
onoremap N  :<c-u>call <SID>NumberTextObject(0)<cr>
xnoremap N  :<c-u>call <SID>NumberTextObject(0)<cr>
onoremap aN :<c-u>call <SID>NumberTextObject(1)<cr>
xnoremap aN :<c-u>call <SID>NumberTextObject(1)<cr>
onoremap iN :<c-u>call <SID>NumberTextObject(1)<cr>
xnoremap iN :<c-u>call <SID>NumberTextObject(1)<cr>

function! s:NumberTextObject(whole)
    normal! v

    while getline('.')[col('.')] =~# '\v[0-9]'
        normal! l
    endwhile

    if a:whole
        normal! o

        while col('.') > 1 && getline('.')[col('.') - 2] =~# '\v[0-9]'
            normal! h
        endwhile
    endif
endfunction 
```

有了这个，我可以：

*   `vcdy`从光标到以 结尾的数字的一部分`<command>N`。不知何故类似于`<command>e`or `<command>w`。

    ```
    Here are some random numbers: 24 7635 1000018
                                            ^---> 
    ```

    如果光标不在数字上并且它不会向后移动，则它不起作用。

*   `vcdy`一个整数`<command>iN`。

    ```
    Here are some random numbers: 24 7635 1000018
                                          <-^---> 
    ```

    同样，如果光标不在数字上，它就不起作用。

当然，整个事情都可以改进，但这是一个开始！

***结束编辑***

我也经常使用 CSS。

我使用两种策略来更改数值：

*   `{count}<C-a>`并且`{count}<C-x>`，就像在哈塞克的回答中一样，当我知道我想增加/减少多少数字时。假设我想`20px`变成`25px`，一个简单`5<C-a>`的技巧就不需要我将光标移动到数字上。这**非常酷**。

*   `/<number><CR>{count}s<new number>`当新值与当前值有很大差异并且我懒得计算增量时。`/2<CR>2s67<Esc>`会让我`23px`变成`67px`. `/2<CR>R67<Esc>`是另一种方式，但只有新值与当前值的长度相同时才好。`f<number>`如果您在同一行，请使用。

请注意，您也可以插入`<C-r>=137-42<CR>`我经常使用的表达式的结果。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-04T00:50:40.347

我在internetz的深处发现了一些东西[并](http://vim.1045645.n5.nabble.com/Visually-select-current-match-td4610773.html)像这样修改它

```
nnoremap ,n /\v\d+/b<cr>mah/\v\d+/e<cr>mb`av`b
vnoremap ,n <esc>/\v\d+/b<cr>mah/\v\d+/e<cr>mb`av`b 
```

*   `\v\d+`搜索一组数字
*   `/b`+`mah`回到它的`b`起点，设置一个标记并返回一个字符，这样我们就可以再次
*   `\v\d+`搜索同一组数字
*   `/e`+`mb`走到尽头并设置另一个标记，最后
*   ``av`b`从第一个到第二个标记视觉选择

# twitter-bootstrap - Bootstrap 手风琴体无法打开；保持崩溃

> ID：11320088
> 
> 赞同：1
> 
> 时间：2012-07-03T22:27:05.060
> 
> 标签：twitter-bootstrap

我正在尝试使用 Bootztrap 设计一个可折叠的手风琴，并且信息都与手风琴一起出现（循环使用 Django 模板）。

我遇到的唯一问题是标题无法打开以显示内容。第一个从一开始就按照设计的方式打开并显示内容，但不会关闭。

我在我的应用程序中的另一个模板上使用了完全相同的方法来制作不同的手风琴，它可以顺利运行。“点击”似乎有问题。

任何有关如何修复此问题的见解将不胜感激。

这是手风琴部分的代码：

```
 <div class="span4 offset1">
    <h2>Notes</h2>
    <div class="accordion" id="note_accordion">
        {% for note in user.notes.all reversed %}
            <div class="accordion-group">
                <div class="accordion-heading">
                    <a class="accordion-toggle note-header well" data-toggle="collapse" href="#note_{{ note.id }}">
                      {{ note.title }} – {{ note.date }}</a>
               </div>
                <div id="notes{{ note.id }}" class="accordion-body collapse{% if forloop.counter0 == 0 %} in{% endif %}">
                    <div class="accordion-inner">
                        <div>
                                <p>{{ note.copy|linebreaksbr }}</p>
                        </div>
                    </div>
                </div>
               </div>
                {% endfor %}    
            </div>
    </div>  
</div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T17:28:21.210

看来您没有使用相同的`id`和`href`值：

```
<a ... href="#note_{{ note.id }}"> <!-- href="#note_1" -->

<div id="notes{{ note.id }}" ... > <!-- id="notes1" --> 
```

# sql - 在我使用完全限定名之前，表名无效？

> ID：11320091
> 
> 赞同：0
> 
> 时间：2012-07-03T22:27:14.453
> 
> 标签：sql, sql-server-2008

```
select *
from PLAYERS 
```

给我一个错误：

> 对象名称“玩家”无效。

但是，这有效：

```
select *
from tennis.dbo.PLAYERS 
```

为什么？在许多其他示例中，我继续只使用表名而没有问题。那为什么我只在这里得到错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-03T22:31:09.850

您可以为表创建[同义词](http://msdn.microsoft.com/en-us/library/ms177544.aspx)，因此您不必使用四部分名称。

# c# - ASP.Net MVC3 缺少模型属性

> ID：11320095
> 
> 赞同：0
> 
> 时间：2012-07-03T22:27:37.337
> 
> 标签：c#, sql-server, asp.net-mvc-3, entity-framework

我是 MVC3 的新手，正在尝试编写一个博客应用程序作为学习工具。

我为博客文章创建了一个数据库对象，并使用带有读/写操作的控制器和使用实体框架控制实体的视图生成了一个控制器。

我在编辑命令时遇到问题。一篇博客文章大约有 6 个属性，但我只想允许编辑来修改文章的标题和内容。我的代码如下：

```
public ActionResult Edit(int id)
    {
        blog_Post blog_post = db.blog_Post.Find(id);
        return View(blog_post);
    }

    //
    // POST: /Post/Edit/5

    [HttpPost]
    public ActionResult Edit(blog_Post blog_post)
    {
        if (ModelState.IsValid)
        {
            db.Entry(blog_post).State = EntityState.Modified;
            db.SaveChanges();
            return RedirectToAction("Index");
        }
        return View(blog_post);
    }

@model BlogVersion1._0.blog_Post

@{
    ViewBag.Title = "Edit";
}

<h2>Edit</h2>

@using (Html.BeginForm()) {
@Html.ValidationSummary(true)
<fieldset>
    <legend>blog_Post</legend>

    <div class="editor-label">
        @Html.LabelFor(model => model.Title)
    </div>
    <div class="editor-field">
        @Html.EditorFor(model => model.Title)
        @Html.ValidationMessageFor(model => model.Title)
    </div>

    <div class="editor-label">
        @Html.LabelFor(model => model.PostContent)
    </div>
    <div class="editor-field">
        @Html.EditorFor(model => model.PostContent)
        @Html.ValidationMessageFor(model => model.PostContent)
    </div>

    <p>
        <input type="submit" value="Save" />
    </p>
</fieldset>
}

<div>
@Html.ActionLink("Back to List", "Index")
</div> 
```

出现的问题出在公共 ActionResult Edit(blog_Post blog_post) 方法中。在 Edit(int id) 方法中，我在其中放置了一个断点，我可以看到 blog_post 被正确地传递给视图（包括填充的所有属性）。

但是返回到 [HttpPost] 方法的 blog_post 缺少 UserId、DateCreated 等属性。由于缺少所需的外键，显然在 db.SaveChanges 调用上引发了异常。

如何确保所有属性都返回到第二个编辑方法以正确进行更新？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-03T22:41:12.027

因为当您执行**POST**时，您没有从表单中发送这些元素的值。解决此问题的一种方法是使用`Hidden`变量将它们保留在表单中

```
@using(Html.BeginForm())
{
  @Html.EditorFor(model => model.Title)
  @Html.HiddenFor(model => model.UserId)
  <input type="submit" />
} 
```

我认为干净的解决方案是“不要在视图中使用域模型，使用具有视图**必要**属性的视图模型。在这种情况下，显然 CreatedDate 不应该是视图应该提供的东西。它应该是代码将提供的东西填充到对象。

所以为此创建一个 ViewModel

```
public class BlogPostViewModel
{
  public int ID { set;get;}
  public string Title { set;get;}
  public string Description { set;get;}  
} 
```

并使用它来将数据从视图传输到控制器，反之亦然

```
public ActionResult Edit(int id)
{
  var domainObject=repo.GetPost(id);
  var viewModel=new BlogPostViewModel();
  viewModel.ID=domainObject.ID;
  viewModel.Title=domainObject.Title;
 //map other REQUIRED properties also
  return View(viewModel);
} 
```

您的视图将被强输入到这个

```
@model BlogPostViewModel
@using(Html.BeginForm())
{
  @Html.EditorFor(model => model.Title)
  @Html.HiddenFor(model => model.Description)
  <input type="submit" />
} 
```

在 POST 操作中，将其映射回域对象并保存

```
[HttpPost]
public ActionResult Edit(BlogPostViewModel model)
{
 if(ModelState.IsValid)
 {
   var domainObject=new blog_Post();
   domainObject.Title=model.Title;

   domainObject.ModifiedDate=DateTime.Now;
   //set other properties also

   repo.Update(domainObject);
   return RedirecToAction("Success");
 }
 return View(model);
} 
```

[**您可以考虑使用AutoMapper**](http://automapper.codeplex.com/)库，而不是一一手动映射属性，它可以在一行代码中为您完成此操作！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-03T22:32:00.010

只需为所有其他不可编辑的属性添加隐藏字段。

```
@Html.HiddenFor(model => model.Id) 
```

这些字段将包含在 POST 中，因此模型绑定器将正确地将它们放入您的 blog_post 实例中。

另一方面，您应该真正使用视图模型 - 简单的 POCO 类将成为您的视图的模型。不建议直接使用实体模型。

这里有一些信息：
[ASP.NET MVC ViewModel Pattern](https://stackoverflow.com/questions/1361092/asp-net-mvc-viewmodel-pattern)
[http://stephenwalther.com/archive/2009/04/13/asp-net-mvc-tip-50-ndash-create-view-models.aspx](http://stephenwalther.com/archive/2009/04/13/asp-net-mvc-tip-50-ndash-create-view-models.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-03T22:40:22.177

对于您的情况，我认为您应该使用 HtmlHelper 扩展方法“EditorForModel”而不是为每个属性调用“EditorFor”。您在每个属性上使用 EditorFor 使您的生活变得复杂（正如 gred84 所说，它不会在您的上下文中的 HTTP 请求中发布未显示的属性）。

在您的 blog_Post 模型类中，您应该使用属性 [HiddenInput(DisplayValue = false)] 标记您不想编辑的每个属性

然后，您可以简单地拥有（简化 - 没有验证摘要），而不是视图中的所有代码

```
@using (Html.BeginForm())
{        
   @Html.EditorForModel()
   <input type="submit" value="Save" />   
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-03T22:32:46.177

模型绑定器将仅填充在 HTTP 请求中发布的属性。您的视图仅包含 Title 和 PostContent。

您需要为每个缺失的属性包含隐藏字段。或者只是 ID 属性，然后对其余部分进行数据库查找。

# cython - 未定义符号（链接 .so C 和 Cython 代码）

> ID：11320105
> 
> 赞同：3
> 
> 时间：2012-07-03T22:28:25.513
> 
> 标签：cython

*由于我取得了一些进展，我更改了标题并进行了第二次编辑，描述了我的新问题。您可以选择忽略 Edit1*

我一直在尝试从 C 代码运行 python 代码。为此，我一直在使用 Cython。

我的系统的语义是这样的，有一个二进制文件（我无法访问谁的源代码）调用文件中定义的 C 函数（源代码是可访问的），在这个函数中我需要调用 python 函数，做一些处理并返回结果为二进制。

为了达到这个目的，我遇到了两种方法：

1.  [http://docs.python.org/release/2.5.2/ext/callingPython.html](http://docs.python.org/release/2.5.2/ext/callingPython.html) ===> 这种方法建议将python回调函数传递给C端，以便在必要时调用回调，但是这对我不起作用，因为我无权访问二进制文件的源代码（用于运行整个系统）

2.  [https://stackoverflow.com/a/5721123/1126425](https://stackoverflow.com/a/5721123/1126425) ==> 我已经尝试过这种方法，当调用 cython 函数时出现此错误：程序收到信号 SIGSEGV，分段错误。[切换到线程 0xb47deb70 (LWP 2065)] PySys_GetObject () 中的 0x007fd38a 来自 /usr/lib/libpython2.6.so.1.0

3.  [http://www.linuxjournal.com/article/8497?page=0,0](http://www.linuxjournal.com/article/8497?page=0,0) ==> 这实际上是 cython 功能的基础，但是当我再次使用那里描述的示例时，我得到类似于 2 的错误。

我不知道如何解决这些错误。任何帮助将非常感激。

谢谢！！

**Edit1：** 这是一个反映情况的简单场景：

* * *

## 外部.c

```
#include <external.h>

int callback(int param1,int param2)//Function that the binary calls
{
    /*SomeTasks*/
    cython_func();//Function defined in the following .pyx file
    /*SomeTasks*/
} 
```

* * *

## cython_file.pyx

```
cdef void cython_function():
    print "Do Nothing!" 
```

我将 cython 创建的共享库文件与通过编译上述 C 代码生成的库链接，然后二进制文件使用该库...

**Edit2：** 当我添加 Py_Initialize(); 时，分段错误消失了。在调用 cython_function() 之前。但现在我得到未定义符号错误：符号查找错误：lib_c_code.so：未定义符号：cython_function

这里的 lib_c_code.so 是由上面的 external.c 文件创建的共享库。我已经尝试在 external.c 中包含由 cython 编译器创建的 .h 文件，但它仍然没有成功。这是我编译 lib_c_code.so 的方式：

```
gcc -shared -dynlib -lm -W1 -o lib_c_code.so $(OBJDIR)/*.o -lc -lm -lpy_code 
```

libpy_code.so 是从 cython_file.pyx 文件创建的共享对象文件，如下所示：

```
cython cython_file.pyx -o cython_file.c
gcc $(IFLAGS) -I/usr/include/python2.6 -fPIC -shared cython_file.c -lpython2.6 -lm -o libpy_code.so 
```

另外，当我这样做时，我可以在 lib_c_code.so 文件中看到符号 cython_function：nm -g lib_c_code.so.. 有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-29T09:25:02.140

我不得不在这里猜测有一个回调注册函数，您可以将函数指针传递给该函数，在这种情况下，您可以简单地放弃 C 文件并直接在 Cython 代码中定义一个 cdef 函数，然后将其与回调注册函数一起传递。`with gil`在您操作其中的任何 Python 对象时使用。

```
cdef extern from "external.h":
    ctypedef int (*Cb_Func)(int param1, int param2)
    void register_callback(Cb_Func func)

cdef int my_callback(int param1,int param2) with gil:
    <implementation>

register_callback(my_callback) 
```

这也在 Cython 用户手册中进行了解释：http: [//docs.cython.org/src/userguide/external_C_code.html](http://docs.cython.org/src/userguide/external_C_code.html)

# encoding - What does the message "Invalid byte 2 of a 3-byte UTF-8 sequence" mean?

> ID：11320108
> 
> 赞同：17
> 
> 时间：2012-07-03T22:28:59.240
> 
> 标签：encoding, utf-8, orbeon

I changed a file in Orbeon Forms, and the next time I load the page, I get an error message saying *Invalid byte 2 of a 3-byte UTF-8 sequence*. How can I solve this problem?

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-03T22:29:00.237

This happens when Orbeon Forms reads an XML file and expects it to use the UTF-8 encoding, but somehow the file isn't properly encoded in UTF-8\. To solve this, make sure that:

1.  You have an XML declaration at the beginning of the file saying the file is in UTF-8:

    ```
    <?xml version="1.0" encoding="UTF-8" ?> 
    ```

2.  Your editor is XML-aware, so it can parse the XML declaration and consequently use the UTF-8 encoding. If your editor isn't XML aware, and you don't want to use another editor, look for an option or preference allowing you to specify that the editor must use UTF-8.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-04T12:57:47.277

一个三字节的 UTF-8 序列如下所示：

```
1110xxxx 10xxxxxx 10xxxxxx 
```

您的错误消息可能意味着三个字节中的第一个字节错误地标记了三个字节序列的开始，或者第二个字节格式错误。

正如@avernet 所说，您需要确保系统中的所有元素都在生成并期待 UTF-8。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-12-30T21:56:23.013

启动程序时，请使用以下 Java 命令行参数：

```
-Dfile.encoding=UTF-8 
```

例如，

```
java -Dfile.encoding=UTF-8 -jar foo.jar 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-10-30T14:32:08.767

我在 Eclipse 中遇到了同样的问题，我只是尝试更改文件类型。

右键单击文件 -> 资源 -> 文本文件编码（UTF-8）

这个解决方案对我有用。

谢谢。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-04T06:11:38.933

我正在使用 Eclipse，我还必须更改文本文件编码：

->Windows->首选项->工作区

然后它工作得很好。

谢谢

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-12-16T14:29:31.363

您可能需要使用以下参数配置 Tomcat：

-Dfile.encoding=UTF-8

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-04-15T11:22:10.570

有同样的问题。

**问题**> 我正在获取 X509 证书值（多个编码源）以生成 PDF 报告。PDF 是通过等待 UTF-8 xml 请求的 web 服务生成的，我必须在编组之前重新编码这些值。

**解决方案**> [http://fabioangelini.wordpress.com/2011/08/04/converting-java-string-fromto-utf-8/](http://fabioangelini.wordpress.com/2011/08/04/converting-java-string-fromto-utf-8/)

使用这个类：

```
public class StringHelper {

// convert from UTF-8 -> internal Java String format
public static String convertFromUTF8(String s) {
    String out = null;
    try {
        out = new String(s.getBytes("ISO-8859-1"), "UTF-8");
    } catch (java.io.UnsupportedEncodingException e) {
        return null;
    }
    return out;
}

// convert from internal Java String format -> UTF-8
public static String convertToUTF8(String s) {
    String out = null;
    try {
        out = new String(s.getBytes("UTF-8"), "ISO-8859-1");
    } catch (java.io.UnsupportedEncodingException e) {
        return null;
    }
    return out;
}
} 
```

用法：

```
//getSummaryAttMap() returns a HashMap
String value = (String) getSummaryAttMap().get(key);
if(value != null)
value = StringHelper.convertToUTF8(value);
else
value = ""; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-12-13T06:24:45.993

我将提供一个特殊的编码答案。当您检查 xml 文件并且没有任何问题时，您正在使用 Java 并运行 Tomcat 服务器。您的源代码可能会忽略自己指定编码，因此 JVM 在将 xml 内容作为字符串或其他表示字符串的内容读取时使用默认编码，这反过来又引用了 Tomcat 的默认编码。如果xml和Tomcat的编码不一致，也可能报同样的错误信息。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-04-07T07:04:00.960

输入的编码切换可能会有所帮助：

```
XMLEventReader eventReader =
                            inputFactory.createXMLEventReader(in, 
                                    "utf-8"
                                    //"windows-1251"
                            ); 
```

# jquery - 在鼠标悬停时动画边距并在没有鼠标悬停的情况下动画返回

> ID：11320110
> 
> 赞同：1
> 
> 时间：2012-07-03T22:29:02.753
> 
> 标签：jquery, jquery-animate

我试图在鼠标悬停时为图像设置动画，我希望它在不使用鼠标悬停的情况下动画回到正常位置。

```
 $(document).ready(function() {
$("#bysti-menu li").mouseover(function(){

                var $elem = $(this);
                $elem.find('.uprmenuicon')
                      .animate({
                        'margin-top':'-40px'

                     },400,'easeOutBack').animate({
                        'margin-top':'0px'

                     },400,'easeOutBack')
}).mouseout(function(){
  // do nothing
}); 
```

});

在这里，当我将鼠标悬停在图像上时，它的边距变为-40px，但我希望在那之后它立即变为0px，即使鼠标还没有出来？任何人都可以帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-03T22:54:22.797

您可以设置您的函数来监听正在发生的事件类型：http: [//jsfiddle.net/dn9wD/1/](http://jsfiddle.net/dn9wD/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-03T22:42:39.530

jquery .animate() 有一个“完成”参数，一旦动画完成就会被调用。[在此处](http://api.jquery.com/animate/)查看文档。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-03T22:45:22.517

**示例演示** [http://jsfiddle.net/R4bzf/](http://jsfiddle.net/R4bzf/)（行为：将鼠标拖到黄色/橙色面板上，然后执行 mouseout）

API`.stop`可以解决问题[http://api.jquery.com/stop/](http://api.jquery.com/stop/)

希望这会有所帮助，如果我错过了什么，请告诉我，thanx

**代码**

```
$(this).stop() // Do whatever - .animate({ left: "-270" }, 500); 
```

# perl - WWW::Mechanize::Firefox 点击链接

> ID：11320114
> 
> 赞同：0
> 
> 时间：2012-07-03T22:29:28.850
> 
> 标签：perl

我有以下这行

```
$agent->follow_link( xpath => '//a[text() = "123456"]' ); 
```

我正在尝试单击具有值的链接`<a href="alwaysdifferenthere">123456</a>`

上面的代码没有点击链接。我做错了吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-03T22:55:56.903

```
use WWW::Mechanize::Firefox;
my $mech = WWW::Mechanize::Firefox->new();
...
$mech->follow_link( tag => 'a', text => '123456' ); 
```

# iphone - 使用 setValue:forKey: 进行多对多关系时，Core Data 应用程序崩溃

> ID：11320123
> 
> 赞同：0
> 
> 时间：2012-07-03T22:30:23.987
> 
> 标签：iphone, ios, core-data

我一遍又一遍地讨论这个问题，我一生都无法弄清楚为什么通过 setValue:forKey: 分配关系不起作用。我的方法如下。

```
-(void)saveNewCartItemName:(NSString *)name Price:(float)price Qty:(int)qty Tax:(int)tax inCart:(NSDate *)cartDate{
    NSManagedObject *newItem = [NSEntityDescription insertNewObjectForEntityForName:@"Item"
                                                             inManagedObjectContext:self.appDelegate.managedObjectContext];

    NSFetchRequest *query = [[NSFetchRequest alloc] initWithEntityName:@"Cart"];
    NSLog(@"cartDate = %@", cartDate);
    [query setPredicate:[NSPredicate predicateWithFormat:@"cartDate = %@", cartDate]];
    NSError *error;
    NSMutableArray *queryResults = [[self.appDelegate.managedObjectContext executeFetchRequest:query error:&error] mutableCopy];
    NSLog(@"queryResults count = %d", [queryResults count]);
    if ([queryResults count] == 1) [newItem setValue:[queryResults objectAtIndex:0] forKey:@"cartThatHasItem"];
    [newItem setValue:name forKey:@"itemName"];
    [newItem setValue:[NSNumber numberWithFloat:price] forKey:@"itemPrice"];
    [newItem setValue:[NSNumber numberWithInt:qty] forKey:@"itemQty"];
    [newItem setValue:[NSNumber numberWithInt:tax] forKey:@"itemTax"];

    [self.appDelegate.managedObjectContext save:&error];
} 
```

它每次崩溃的行是：

```
if ([queryResults count] == 1) [newItem setValue:[queryResults objectAtIndex:0] forKey:@"cartThatHasItem"]; 
```

我的 NSLog 显示有一个 NSManagedObject 可以分配关系，并且我仔细检查了 forKey 中的名称：没有拼写错误。Xcode 告诉我的只是它在我的控制台上打印出“(null)”，然后在下一行告诉我“libc++abi.dylib: terminate called throwing an exception”。

为什么会崩溃？我该如何解决？

更新：这是整个错误信息。

```
2012-07-03 18:28:57.844 appName[3063:11603] (null)
libc++abi.dylib: terminate called throwing an exception
(lldb) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-03T23:54:56.423

我看到的一个问题是您没有检查错误对象。如果发生错误，那么 queryResults 可能会 = nil，并且您随后尝试检查 count 将使您崩溃。至少检查 nil 条件：

```
NSMutableArray *queryResults = [[self.appDelegate.managedObjectContext executeFetchRequest:query error:&error] mutableCopy];

if( queryResults == nil ) return; // Or better yet check the value of Error. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-03T22:56:04.397

好吧，没有足够的调试信息......因为你只需要检查是否`queryResults`有一个对象，所以我会使用

```
[newItem setValue:[queryResults lastObject] forKey:@"cartThatHasItem"]; 
```

代替

```
if ([queryResults count] == 1) [newItem setValue:[queryResults objectAtIndex:0] forKey:@"cartThatHasItem"]; 
```

不确定它是否能解决您的问题，但值得一试。:)

* * *

### 编辑

通过您的问题标题*“... for many-to-many relationship”*`cartThatHasItem` ，我想知道&之间的关系是`Cart`什么？如果是多对一或多对多，则`cartThatHasItem`的数据类型为`NSSet`。所以，你需要包装`[queryResults objectAtIndex:0]`'喜欢

```
[newItem setValue:[NSSet setWithObject:[queryResults objectAtIndex:0]]
           forKey:@"cartThatHasItem"]; 
```

，或者你可以使用

```
[newItem addCartThatHasItem:[queryResults objectAtIndex:0]] 
```

反而。（`addCartThatHasItem:`将在您生成购物车模型时自动添加。）

* * *

### 编辑 2

Cart 模型应该是这样的：

```
@interface Cart : NSManagedObject

//...
@property (nonatomic, retain) NSSet *cartThatHasItem;

@end

@interface Cart (CoreDataGeneratedAccessors)

//...
- (void)addCartThatHasItemObject:(CartThatHasItem *)value;
- (void)removeCartThatHasItemObject:(CartThatHasItem *)value;
- (void)addCartThatHasItem:(NSSet *)values;
- (void)removeCartThatHasItem:(NSSet *)values;

@end 
```

如果您正确生成模型。

# javascript - 使用 Javascript 获取信息的下拉菜单

> ID：11320129
> 
> 赞同：2
> 
> 时间：2012-07-03T22:31:25.593
> 
> 标签：javascript, jquery, html, drop-down-menu

我有一个看起来像这样的下拉列表。我需要使用 javascript 从当前选择中获取信息的帮助。我需要添加什么 id 和任何适当的 javascript 调用来获取当前选择的“值”

```
<dl id="order" class="dropdown">
  <dt><a href="#"><span>(Name of Selected Item Ends up here)</span></a></dt>
  <dd>
    <ul style="z-index: 1000; display: none; ">
      <li value="1"><a href="1">Item 1</a></li>
      <li value="2"><a href="2">Item 2</a></li>
      <li value="3"><a href="3">Item 3</a></li>
    </ul>
  </dd>
</dl> 
```

```
$(document).ready(function() {
    $(".dropdown dt a").click(function() {
        $(".dropdown dd ul").toggle();
    });

    $(".dropdown dd ul li a").click(function() {
        var text = $(this).html();
        $(".dropdown dt a span").html(text);
        $(".dropdown dd ul").hide();
        if(order != getSelectedValue("order")) {
        order = getSelectedValue("order");
        }
    });

    function getSelectedValue(id) {
        return $("#" + id).find("dt a span.value").html();
    }

    $(document).bind('click', function(e) {
        var $clicked = $(e.target);
        if (! $clicked.parents().hasClass("dropdown"))
            $(".dropdown dd ul").hide();
        return false;
    });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T04:03:35.710

单击时，这将返回被单击的列表项的值：

```
$(this).closest('li').attr('value'); 
```

然后，您可以删除 getSelectedValue 函数。

**[jsFiddle 示例](http://jsfiddle.net/j08691/KKgWv/)**

# html - 在构建网站时，我应该以绝对的跨浏览器一致性为目标还是应用一些默认的用户代理样式？

> ID：11320130
> 
> 赞同：1
> 
> 时间：2012-07-03T22:31:39.143
> 
> 标签：html, css, cross-browser

创建网站时您首选的方法是什么：

*   努力使页面在每个浏览器上看起来都**完全相同？**或者
*   让浏览器将其**默认样式表**应用于某些特定对象，如输入、边框、颜色等。 ?

第一个解决方案显然是我们在完美世界中自然会拥有的，但需要更多的工作、CSS hack、浏览器特定的样式表等等。
这是网页设计师应该倾向于做的事情吗？

关于第二个，我在考虑表单、禁用的元素、有时的颜色、表格的页眉和页脚……让浏览器处理它要容易得多，并且具有*跨网站*对用户保持一致的优势。
这是一个好习惯还是我很懒？如何将此解决方案“出售”给不关心这些考虑的客户？

* * *

我正在寻找每种方法的优缺点。
如何在一个和另一个之间进行选择？极限在哪里？（怎么样：坚持 W3C 标准，让浏览器处理剩下的事情？）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-03T22:42:00.797

网页设计的艺术是在媒介的限制下工作，其中有很多，并且仍然想出跨许多不同平台的 100% 功能。使您的页面在多种屏幕尺寸、分辨率、文化、语言、连接速度、可访问性问题等下在所有浏览器上看起来都很好并且完全正常运行是一项挑战，如果您可以完成“在 IE 中没有损坏”，那就太好了.

当然，我希望它看起来像在 Fireworks 中所做的那样，但这不是一个现实的目标。每台机器都是不同的，所以你的页面的每一个视图也将是不同的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-03T22:37:30.637

你有一些 CSS 框架，比如 Twitter Bootstrap 或 Blue print。实际上有很多。然后，如果您正在编写自定义 CSS，我建议您使用 CSS 预处理器。

*   [CSS 框架列表](http://blog.templatemonster.com/2011/08/11/free-css-frameworks/)
*   [CSS 预处理器列表](http://www.catswhocode.com/blog/8-css-preprocessors-to-speed-up-development-time)
*   [http://twitter.github.com/bootstrap/](http://twitter.github.com/bootstrap/)

由于 Twitter Bootstrap 和列表中的许多都包含响应式设计，因此您无需为平板电脑和其他设备返工。我希望此列表可以帮助您入门。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-03T22:50:06.053

作为开发人员，您希望在所有浏览器中保持一致的外观。你不想像你建议的那样有懒惰的态度！！这对开发人员来说是一个糟糕的习惯，会导致产品质量低下。

熟悉解决跨浏览器问题的不同框架。Twitter bootstrap 和 jQuery 是一个很好的起点。还要了解不同的浏览器并了解它们支持和不支持的内容，以便在编码时可以避免某些事情！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-04T00:02:58.973

虽然大多数网页设计师希望跨浏览器的一致性，但它本质上并不“正确”，实际上它取决于您正在创建的网页的性质。

[特别是，完全一致性与渐进增强](http://en.wikipedia.org/wiki/Progressive_enhancement)和[响应式网页设计](http://en.wikipedia.org/wiki/Responsive_Web_Design)的原则背道而驰。没有黄金法则，在每种情况下为您的客户做正确的事。

# winapi - GetAdapterIndex() 返回错误的索引

> ID：11320131
> 
> 赞同：0
> 
> 时间：2012-07-03T22:31:40.133
> 
> 标签：winapi, network-programming

我想通过名称获取适配器索引，经过几天的搜索，我找到了[GetAdapterIndex()](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365909%28v=vs.85%29.aspx)函数：

```
#include <winsock2.h>
#include <iphlpapi.h>
#include <stdio.h>
#include <iostream>
#include <stdlib.h>
#pragma comment(lib, "IPHLPAPI.lib")

#define MALLOC(x) HeapAlloc(GetProcessHeap(), 0, (x)) 
#define FREE(x) HeapFree(GetProcessHeap(), 0, (x))

int main()
{
    DWORD res;
    DWORD rs;
    ULONG IfIndex;
    LPWSTR AdapterName;
    int i = 0;
    res = GetAdapterIndex(L"AMD PCNET Family PCI Ethernet Adapter - Packet Scheduler Miniport", &IfIndex);
    if(res == NO_ERROR)
        printf("Adapter Index: %ld\n", IfIndex);

    res = GetNumberOfInterfaces(&rs);
    if(res == NO_ERROR)
        printf("Number of Adapters: %ld\n", rs);
return 0;
} 
```

**首先：**它不会返回我选择的特定适配器名称的索引。 **第二：**它返回我有两个适配器，即使我只有一个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T21:16:43.343

您可以使用 打印网络接口的名称和描述`GetIfEntry`，索引范围从 1 到 返回的值`GetNumberOfInterfaces`。所有名称的格式`\DEVICE\TCPIP_{846EE342-7039-11DE-9D20-806E6F6E6963}`都解释了为什么您没有使用好名称找到您的界面。

# c# - 获取 ListBox 中的所有选定项（包括重复项）

> ID：11320133
> 
> 赞同：2
> 
> 时间：2012-07-03T22:31:47.277
> 
> 标签：c#, silverlight, listbox, duplicates, selecteditem

我有一个包含重复项的 ListBox。根据我收集的信息，`ListBox.SelectedItems`只会返回重复项的第一个实例，但是当我想对用户选择的所有项目执行操作时，这会导致问题。当我选择多个重复项并调用`ListBox.SelectedItems.Count`时，我总是得到`1`. 有没有办法获取所有项目的索引，无论它们是否唯一？（ListBox 模式设置为 Multiple）。

添加了演示代码，表明同一项目被视为重复项。

xml:

```
<Grid x:Name="LayoutRoot" Background="White">
   <ListBox Height="288" HorizontalAlignment="Left" Margin="12,0,0,0" Name="listBox1" VerticalAlignment="Top" Width="276" SelectionMode="Multiple" />
   <Button Content="Button" Height="23" HorizontalAlignment="Left" Margin="313,12,0,0" Name="button1" VerticalAlignment="Top" Width="75" Click="button1_Click" />
</Grid> 
```

代码：

```
ObservableCollection<string> fruits = new ObservableCollection<string>();
fruits.Add("Apple");
fruits.Add("Pear");
fruits.Add("Orange");
fruits.Add("Apple");
listBox1.ItemsSource = fruits ; 
```

我刚刚连接了一个按钮事件：

```
MessageBox.Show(listBox1.SelectedItems.Count.ToString()); 
```

选择顶部`Apple`并单击按钮，它将返回`1`。选择两者`Apples`，它将返回`1`。选择一个`Apple`and `Pear`，它会返回`2`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T23:20:13.393

我在我的类中添加了一个 GUID 属性，并在添加到 ObservableCollection 之前将其随机化。用户看不到 GUID，但 ListBoxItem 仍然被认为是唯一的，它现在可以工作了。如果有人知道不需要不必要地修改类的解决方案，我会暂时保留这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T08:14:22.993

当您添加两个具有相同值的字符串时，Listbox 会将它们视为相同。最好创建一个自定义类 Like

类复合{公共字符串键{get;set;}公共字符串值{get;set;}}

将列表与此类绑定。这样，如果您将 Apple 设置为两个对象但键不同，您将获得正确的结果

干杯! 维诺德

# string - 装配换行符

> ID：11320135
> 
> 赞同：2
> 
> 时间：2012-07-03T22:31:55.830
> 
> 标签：string, assembly, x86

我用汇编（NASM 语法）编写了一个简单的引导加载程序，但是当我在 QEMU 中运行它时，换行符显示如下：

![在此处输入图像描述](../Images/387d1e8344e3b7d3d5576833369cf522.png)

这是我的代码：

有没有办法阻止`0Ah`向前推进线路？

```
.loop_top:

mov si, text_string ; Put string position into SI
call print_string   ; Call our string-printing routine

loop .loop_top

jmp $           ; Jump here - infinite loop!

text_string db "This is my cool new OS!", 0Ah, 0 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-03T22:36:09.007

好吧，显然 :-) 你的“print_string”子例程认真对待 0x0a——它被称为“LF”，它就是这样做的，前进到下一行。

我的猜测是使用 0x0a 0x0d 就可以了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-03T23:00:29.617

我相信发送 a`\r`会使光标返回到屏幕的左侧。所以，你应该使用`\r\n`或类似的东西来制作新的线条。

我不确定没有更多细节。我不确定您的 print_string 过程是如何实现的。如果通过 BIOS 调用实现，例如使用 int 0x10, AH=0x0E 循环遍历字符串，则上述解决方案将起作用，或者您可以执行类似使用 int 0x10, AH=0x03 手动调整光标位置的操作。

# lisp - mit-scheme vim slimv：“读取错误：没有为 #\F 定义调度函数”

> ID：11320144
> 
> 赞同：3
> 
> 时间：2012-07-03T22:32:31.067
> 
> 标签：lisp, scheme, mit-scheme, slimv

这是一个非常简单的方案功能

```
(define member?
  (lambda (a lat)
    (cond
      ((null? lat) #f)
      (else (or (eq? (car lat) a)
                (member? a (cdr lat))
                ))
      )
    )
  ) 
```

但是，当我在 vim 中按**,d**或**,F**来运行此函数时，出现错误

> /home/oo/tmp/t.scm:64 读取错误：没有为 #\F 定义调度函数
> 
> 行：4，列：21，文件位置：64
> 
> 流：#<SB-SYS:FD-STREAM for "file /home/oo/tmp/t.scm" {AC84DA9}>

![在此处输入图像描述](../Images/bf060a12867aea54100e6bdba3d8eaa2.png)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-04T09:29:34.847

Chris 已经指出您尝试将 Scheme 代码与 Common Lisp swank 服务器一起使用。您需要运行一个 Scheme swank 服务器（例如`swank-mit-scheme.scm`，也包含在 Slimv 中）。通常 Slimv 应该在 Linux 上自动检测 MIT 方案，而无需在`.vimrc`. 要使自动检测正常工作，您需要安装 MIT 方案并且该`scheme`命令可用。

我建议您从您的`.vimrc`. 然后在 Vim 中加载 .scm 并输入以下命令：

`:echo SlimvSwankCommand()`

如果 Scheme 被自动检测到，那么这应该打印运行 Scheme swank 服务器的命令（`swank-mit-scheme.scm`在输出中搜索）。如果自动检测不成功，那么要么您没有该`scheme`命令，要么 Slimv 没有找到`swank-mit-scheme.scm`。在这种情况下，您需要告诉 Slimv 运行 Scheme swank 服务器的命令。您可以通过向您添加类似的命令来完成`.vimrc`：

`let g:slimv_swank_cmd = '! xterm -e scheme --load /your-path-to/slime/contrib/swank-mit-scheme.scm &'`

但只有在自动检测失败时才这样做。如果您需要更多帮助，请随时与我联系，我是 Slimv 的作者。

# eclipse - 如何在 Eclipse 中的 tomcat 中部署 maven 项目

> ID：11320151
> 
> 赞同：1
> 
> 时间：2012-07-03T22:33:27.123
> 
> 标签：eclipse, tomcat, maven

我一直在尝试部署我在 Eclipse 中创建的项目，但是当我右键单击 tomcat 服务器并单击“添加和删除...”时，我收到消息“没有可以添加或删除的资源服务器”。

据我了解，这与方面有关吗？我不确定这里出了什么问题。

这是我所做的：

*   我创建了一个 Maven 项目。
*   在项目的文件夹上通过命令行执行 mvn eclipse:eclipse
*   已安装 m2e
*   试图将项目添加到tomcat服务器

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-03T22:39:34.150

您可能想要使用`mvn eclipse:eclipse`OR m2e，但不能同时使用两者。m2e 在过去几年里变得更好了，所以这就是我的建议。

*   确保您使用的是 Eclipse for Java EE，否则您将需要安装其他插件，例如 WTP
*   安装 m2e。
*   为 wtp 安装 maven 集成（来自 eclipse 市场）
*   确保您的项目的工件类型是战争
*   在 eclipse 中导入现有的 Maven 项目并浏览到您的 pom 以导入项目。

它应该为您的项目提供正确的方面，使其看起来像一个 Web 项目。

# javascript - “稍后提醒我”/“快速事件”javascript 解决方案？

> ID：11320152
> 
> 赞同：0
> 
> 时间：2012-07-03T22:33:30.427
> 
> 标签：javascript, jquery, calendar, datepicker

我正在构建一个需要用户输入日期和时间的应用程序（显然），我一直认为[Remind Me Later](http://www.bdunagan.com/remind-me-later/)应用程序和Apple 最终制定的[解决方案是解决这个问题的一个非常好的方法。](http://images.macworld.com/images/article/2011/09/add-new-event-253307.jpg)有没有人知道任何反映这一点的好的开源或付费解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T01:12:23.297

我找到了一个很好的解决方案，足够接近[http://www.datejs.com/](http://www.datejs.com/)

# c# - GUI 何时超载？

> ID：11320156
> 
> 赞同：3
> 
> 时间：2012-07-03T22:34:21.007
> 
> 标签：c#, user-interface, asynchronous, dispatcher, begininvoke

假设您*永久地*在 UI 线程/调度程序上异步调用一个方法

```
while (true) {

    uiDispatcher.BeginInvoke(new Action<int, T>(insert_), DispatcherPriority.Normal, new object[] { });
} 
```

在程序的每次运行中，您都会观察到应用程序的 GUI 在大约 90 秒后由于*调用*的泛滥而开始冻结（时间会有所不同，但大致在 1 到 2 分钟之间）。

怎样才能准确地确定（测量？）这种*过载*发生的时间点以便足够早地停止它？

**附录一：**

在我的实际程序中，我没有无限循环。我有一个算法在终止之前迭代数百次。在每次迭代中，我都在 WPF 应用程序的 List 控件中添加一个字符串。我使用了 while (true) { ... } 构造，因为它最符合发生的情况。事实上，算法正确终止，所有（数百个）字符串都正确添加到我的列表中，但一段时间后，我失去了使用我的 GUI 的能力，直到算法终止 - 然后 GUI 再次响应。

**附录二：**

我的程序的目的是在运行时观察一个特定的算法。我添加的字符串是日志条目：每次迭代一个日志字符串。我调用这些添加操作的原因是该算法在 UI 线程之外的另一个线程中运行。为了赶上我不能从除了 UI 线程之外的任何线程进行 UI 操作的事实，我构建了某种 ThreadSafeObservableCollection（但我很确定这段代码不值得发布，因为它会减损实际问题我认为是 UI 无法处理方法的重复和快速调用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-03T23:44:43.133

这很简单：当您使用户的眼球超负荷时，您就做错了。就现代 cpu 内核而言，这种情况发生得很快，超过每秒 20 次更新，显示的信息开始看起来像模糊。电影院利用的东西，电影以每秒 24 帧的速度播放。

比这更快的更新只是浪费资源。在 UI 线程开始崩溃之前，您还有很大的喘息空间。这取决于您要求它完成的工作量，但典型的是 x50 安全裕度。一个基于 Environment.TickCount 的简单计时器将完成工作，当差异 >= 45 毫秒时触发更新。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-03T23:53:40.203

经常将其发布到 UI 是一个危险信号。这是另一种选择：将新字符串放入 a`ConcurrentQueue`并让计时器每 100 毫秒将它们拉出。

非常简单易实现，结果很完美。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-03T23:07:58.737

好的，对于之前评论中的错误链接感到抱歉，但我一直在阅读，也许这会有所帮助：

```
The DispatcherOperation object returned by BeginInvoke can be used in several ways to interact with the specified delegate, such as:

Changing the DispatcherPriority of the delegate as it is pending execution in the event queue.
Removing the delegate from the event queue.
Waiting for the delegate to return.
Obtaining the value that the delegate returns after it is executed.

If multiple BeginInvoke calls are made at the same DispatcherPriority, they will be executed in the order the calls were made.

If BeginInvoke is called on a Dispatcher which has shut down, the status property of the returned DispatcherOperation is set to Aborted. 
```

也许你可以用你正在等待的代表数量做一些事情......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-03T23:23:48.287

我没有使用 WPF——只是 Windows 窗体，但我建议如果有一个需要异步更新的仅查看控件，正确的方法是编写控件，以便其属性可以是从任何线程自由访问，并且*仅当还没有更新挂起时*`BeginInvoke`更新控件才会刷新例程；后一种确定可以使用“标志”和（属性设置器在更改基础字段后调用标志；如果标志已被清除，它会执行*`Int32``Interlock.Exchange``Interlocked.Exchange``BeginInvoke`关于刷新程序；然后刷新例程清除标志并执行刷新）。在某些情况下，可以通过让控件的刷新例程检查自上次运行以来经过了多少时间来进一步增强模式，如果答案小于 20 毫秒左右，则使用计时器在 20 毫秒后触发刷新前一个。*

 *尽管 .net 可以处理`BeginInvoke`在 UI 线程上发布的许多操作，但一次只为单个控件进行更新通常是没有意义的。将待处理的操作限制为每个控件一个（或最多一个少量），并且不会有队列溢出的危险。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-03T23:53:43.973

要将 supercat 的解决方案以更类似于 WPF 的方式放置，请尝试使用 MVVM 模式，然后您可以拥有一个单独的*视图模型*类，您可以在线程之间共享它，也许在适当的点锁定或使用并发集合类。您实现了一个接口（我认为它是 INotifyPropertyChanged 并触发一个事件来说明集合已更改。此事件必须从 UI 线程触发，但只需要

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-04T06:34:31.900

After going through the answers provided by others and your comments on them, your actual intent seems to be ensuring that UI remains responsive. For this I think you have already received good proposals.

But still, to answer your question (how to detect and flag overloading of UI thread) verbatim, I can suggest the following:

1.  First determine what should be the definition of 'overloading' (for e.g. I can assume it to be 'UI thread stops rendering the controls and stops processing user input' for a big enough duration)
2.  Define this duration (for e.g. if UI thread continues to process render and input messages in at-most 40ms I will say it is not overloaded).
3.  Now Initiate a [DispactherTimer](http://msdn.microsoft.com/en-us/library/system.windows.threading.dispatchertimer.aspx) with DispatcherPriority set according to your definition for overloading (for my e.g. it can be DispatcherPriority.Input or lower) and Interval sufficiently less than your 'duration' for overloading
4.  Maintain a shared variable of type DateTime and on each tick of the timer change its value to DateTime.Now.
5.  In the delegate you pass to BeginInvoke, you can compute a difference between current time and the last time Tick was fired. If it exceeds your 'measure' of overloading then well the UI thread is 'Overloaded' according to your definition. You can then set a shared flag which can be checked from inside your loop to take appropriate action.

Though I admit, it is not fool proof, but by empirically adjusting your 'measure' you should be able to detect overloading before it impacts you.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-04T09:30:18.070

使用[秒表](http://msdn.microsoft.com/en-us/library/system.diagnostics.stopwatch.aspx)测量最小、最大、平均、第一次和最后一次更新持续时间。（您可以将其输出到您的 UI。）

您的更新频率必须小于 1/（平均更新持续时间）。

更改算法的实现，以便它的迭代由多媒体计时器调用，例如[this .NET wrapper](http://www.codeproject.com/Articles/5501/The-Multimedia-Timer-for-the-NET-Framework)或[this .NET wrapper](http://www.codeproject.com/Articles/98346/Microsecond-and-Millisecond-NET-Timer)。激活计时器后，使用[Interlocked](http://msdn.microsoft.com/en-us/library/system.threading.interlocked.compareexchange.aspx)防止在当前迭代完成之前运行新的迭代。如果您需要在 main 上进行迭代，请使用调度程序。您可以为每个计时器事件运行 1 次以上的迭代，为此使用一个参数，并与时间测量一起确定每个计时器事件要运行多少次迭代以及您希望计时器事件的频率。

我不建议定时器使用少于 5 毫秒的时间，因为定时器事件会使 CPU 窒息。

正如我之前在评论中所写，在调度到主线程时使用[DispatcherPriority.Input](http://msdn.microsoft.com/en-us/library/system.windows.threading.dispatcherpriority.aspx)，这样 UI 的 CPU 时间不会被调度窒息。这与 UI 消息具有相同的优先级，因此它们不会被忽略。*

# email - 我应该使用哪些网络技术将随机字符串添加到 icalendar url？

> ID：11320157
> 
> 赞同：1
> 
> 时间：2012-07-03T22:34:25.180
> 
> 标签：email, url, random, ms-project

我正在使用 microsoft project 一次发送许多电子邮件，其中都包含 url。这些 url 包含私人信息，问题是通过更改 url 的 id 中的一两个数字，人们可以看到他们不应该看到的信息。因此，为了使其更安全，我想将 ajkw42HH 或其他一些随机字符串添加到 url，这样人们就不能只更改一两个数字并获得另一个有效的 url？那么很明显，无论谁在浏览器中打开它，都需要能够去掉这个随机字符串，这样他们才能看到并访问原始 url。谁能给我一个好的起点或一些好的关键字。我现在迷路了

# php - 变量没有在数组中传回

> ID：11320158
> 
> 赞同：1
> 
> 时间：2012-07-03T22:34:54.250
> 
> 标签：php, arrays, oop, class, return

这个问题与[这个](https://stackoverflow.com/questions/11319447/return-multiple-values-from-a-method-in-a-class)主题有关。我将语法更改为建议的语法，因此我的代码现在如下所示：

类中的方法：

```
private $password;
private $user_id;
private $img_thumb;

public function getUserInfo(){
            $stmt = $this->dbh->prepare("SELECT user_id FROM oopforum_users WHERE username = ?");
            $stmt->bindParam(1, $this->post_data['username']);
            $stmt->execute();

            while($row = $stmt->fetch(PDO::FETCH_ASSOC)) {

                $password = $row['password'];
                $user_id = $row['user_id'];
                $img_thumb = $row['thumbnail'];
            }
            return array(
                'password' => $this->password,
                'id' => $this->user_id,
                'thumb' => $this->img_thumb
                );

        } 
```

调用程序：

```
session_start();
require_once('init.php');

$username = trim($_POST['username']);
// create a new object
$login = new Auth($_POST, $dbh);

    if($login->validateLogin()){

        $_SESSION['loggedin'] = true;
        $list = $login->getUserInfo();

        $_SESSION['password'] = $list['password'];
        $_SESSION['id'] = $list['id'];
        $_SESSION['thumb'] = $list['img_thumb'];
} 
```

所有变量似乎都没有传回调用程序，我是否错过了类中需要明确声明它们可以传回的内容？

我`print_r()`是`$list`数组，它不包含三个变量。

这三个条目确实存在于数据库中。

在调用程序的数组中获取检索到的数据库条目时我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-03T22:37:17.237

在您的 while 循环中，将变量分配给当前对象：

```
while ($row = $stmt->fetch(PDO::FETCH_ASSOC)) {
  $this->password  = $row['password'];
  $this->user_id   = $row['user_id'];
  $this->img_thumb = $row['thumbnail'];
} 
```

**更新：**您错过了 SQL 中的一些字段：

```
SELECT user_id, password, img_thumb FROM oopforum_users WHERE username = ? 
```

# css - CSS3媒体查询放在哪里？

> ID：11320163
> 
> 赞同：6
> 
> 时间：2012-07-03T22:35:30.890
> 
> 标签：css, responsive-design, media-queries

我正在与自己就将媒体查询放在样式表中的最佳位置进行哲学辩论。我正在尝试以模块化方式构建我的 CSS（如 OOCSS 或 SMACSS 等）。鉴于这种情况，我看到了两种选择：

1.  将所有媒体查询放在一个单独的样式表或主样式表的部分中。
2.  将媒体查询置于其基本对应项之下。例如，如果我有一个名为“news-item”的模块，我可以将任何必要的媒体查询样式放在该模块定义的正下方。

我倾向于后者，但这意味着我会有更多独立的媒体查询（需要响应式调整的每个 CSS 逻辑块的独立媒体查询）。

对此有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-03T23:44:10.780

如何使用媒体查询来加载特定于设备的样式表

喜欢：

```
@import url(mydevice.css) this and (that); 
```

或者：

```
<link rel="stylesheet" media="only this and (that)" href="mydevice.css" /> 
```

...如果您将设备特定的调整视为主要布局的一种“子主题”（只是覆盖一些属性），这对我来说也很有意义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-04-12T16:09:05.707

**方法 2**对我来说效果更好。

当我还是一个新手时，我使用的是**方法 #1** - 我一起编写媒体查询（在我的样式表的底部或另一个文件中）。

```
.header { ... }
.news-item { ... }
.footer { ... }

/**
 * ...
 *
 * bla bla, imagine a huge amount of styles here
 *
 * ...
 */

/** All style tweaks for screens < 1024px */
@media screen and (max-width: 1024px) {
  .header { ... }
  .news-item { ... }
} 
```

这种方法有一些缺点。根据我的经验，最值得注意的是**可维护性是一个很难的**. 主要原因：`.news-item`逻辑分布在多个不相关的 CSS 行中。

后来，很自然地，我决定把相关的风格放在一起。**方法#2**：

```
/** Header's styles and media queries */
.header {
  ...
}
@media screen and (max-width: 1024px) {
  .header { ... }
}
@media screen and (max-width: 720px) {
  .header { ... }
}

/** News-item's styles and media queries */
.news-item {
  ...
}
@media screen and (max-width: 1024px) {
  .news-item { ... }
}
@media screen and (max-width: 720px) {
  .news-item { ... }
}

/** ... and so on */ 
```

但是，在这种方法中，全面重复媒体查询`max-width`值看起来不够可维护。我通过使用 CSS 预处理器（如 SASS）解决了这个问题，它允许我用变量替换所有它们并定义它们一次。

为了提高可维护性并使这些定义更加优雅，我开始在媒体查询之上使用抽象。

如果您对更多详细信息感兴趣，请[阅读我的博客文章](https://medium.com/@superKalo/journey-to-highly-effective-and-maintainable-css-media-queries-876e5b92f918):-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-01T20:46:08.397

使用 Sass，可以更轻松地直接在对应对象下方使用媒体查询。但是，如果您的 CSS 在您的模块中得到了很好的注释，我认为将查询放在下面没有问题，因为这很容易找到。

您最终会编写更多代码来重新键入查询，但没什么大不了的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-06-05T03:58:07.213

也许你可以试试`css variables`，这是原生支持重用你的css！

```
:root {
  --main-color: #F06D06;
}

.main-header {
  color: var(--main-color);
}
.main-footer {
  background-color: var(--main-color);
}
```

[https://developer.mozilla.org/en-US/docs/Web/CSS/Using_CSS_variables](https://developer.mozilla.org/en-US/docs/Web/CSS/Using_CSS_variables)

[https://developers.google.com/web/updates/2016/02/css-variables-why-should-you-care](https://developers.google.com/web/updates/2016/02/css-variables-why-should-you-care)

[https://css-tricks.com/difference-between-types-of-css-variables/](https://css-tricks.com/difference-between-types-of-css-variables/)

# ruby - Ruby 的'is_a?' 为内置类型返回 false，发生了什么？

> ID：11320164
> 
> 赞同：4
> 
> 时间：2012-07-03T22:35:32.400
> 
> 标签：ruby, arrays, oop, types, duck-typing

我只学习了 Ruby 的深层部分几个月，所以如果这是一个有点愚蠢的问题，我深表歉意。我正在尝试递归迭代一个*可能*包含嵌套数组的数组，因此我需要检查当前元素的类型。我有以下代码作为一个小测试：

```
arr = [ 1..2, [3..4, [5..6]], [7..8, [9..10]] ]

arr.each do |node|
  p node.class
  p node.instance_of? Array
end 
```

当我运行它时，我得到以下输出：

```
Range
false
Array
false
Array
false 
```

我希望最后两个返回 True，因为我有一个包含 Range 和两个嵌套数组的数组。

更奇怪的是，如果我写以下内容：

```
node.class.name == "Array" 
```

它应该返回 True。

这里发生了什么事？

**红宝石版本：** MRI 1.9.3-p194

**注意：**我最终意识到这是由于我使用模块命名我的代码以避免代码冲突的方式，就像这样，但也以一种顽皮的方式验证对象身份：

```
module MyProg
  class MyClass
    attr_reader :my_array

    def initialize(size)
      @my_array = Array.new(size)
    end
  end
end

MyProg::MyClass.new 
```

这样做会隔离您的代码，但会导致从您的命名空间下开始解析**所有类查找。**这意味着在上面的示例中，`my_array.class`实际上会解析为*`MyProg::Array`*而不是全局 Array 类。

如果你像这样命名空间并且你仍然想使用这个方法，你可以通过在类之前使用双冒号全局标识符来强制 Ruby 从全局命名空间开始查找来解决它：

```
arr.is_a? ::Array
arr.is_a? ::String 
```

然而，鉴于 Ruby 的 Duck Typing 能力（以及以后更好的代码维护），您应该按照下面彼得的建议测试对象的*行为*。因此，我将他的答案标记为正确，以便为学习者提供一些极好的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-03T22:38:55.337

你的意思是`is_a?`，这是一个更通用的测试，看看是否`node`是 type ，而不是你提到`Array`的特定类的特定实例。`Array`有关更多详细信息，请参见[此处](https://stackoverflow.com/questions/3893278/ruby-kind-of-vs-instance-of-vs-is-a)。但如果你只是使用`is_a?`一切都会有意义。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-03T23:21:46.097

我写了另一个答案，但一个主要问题是 - 你为什么要这样做？为什么不直接调用`flatten`数组来获取条目呢？或者，改为检查对象的*行为*。您可能需要详细说明您的需求。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-03T22:41:41.583

我运行了您的代码并得到了这些结果。

```
Range
false
Array
true
Array
true 
```

我正在运行 ruby​​ 1.9.3p125

# php - 您可以使用 GPLv2 许可的模块或扩展来做什么，可以对其进行修改吗？

> ID：11320165
> 
> 赞同：2
> 
> 时间：2012-07-03T22:35:48.350
> 
> 标签：php, joomla, licensing, gpl, joomla-extensions

我想为我自己的公司网站修改 Joomla 扩展，但我不明白。该扩展名在 GPLv2 或更高版本的许可证下，我认为这意味着您可以根据需要更改它，但是当您打开文件时说它不能被修改，这不是 GPLv2 或更高版本的许可证的重点吗？还有一些文件对这样的人和这样的人有版权我可以改变那些扩展我不会分发它们只是为了我的公司网站那么它是如何工作的？还有一个 Joomla 的网站说有些是非商业的，当它是 GPLv2 时这意味着什么？抱歉有这么多问题，我只是不明白这在现实世界中是如何运作的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-03T23:02:00.273

去读驾照。如果没有明确的附加请求（GPLv2 允许，只要它们不违反 GPLv2 的条款），您可以修改代码以供自己使用。因此，您不能修改代码的限制直接违反了第 2 条：

> 您可以修改您的一份或多份本程序或其任何部分，

如果软件的许可声明“但是当你打开文件时说它不能被修改”，那么事实上它不能是 GPLv2。但如果它是 GPLv2，那么事实上它必须是你可以修改的。

如果您随后将修改后的代码提供给其他任何人（出售或赠送），那么您必须根据 GPLv2 的条款提供它 - 即您可以出售修改后的代码，但您不能阻止您的客户出售它上。但是，如果您不将其传递给其他任何人，那么您就没有义务将其提供给所有人。

> 该扩展在 GPLv2 或更高版本许可下

诶？这是没有意义的。尽管 UCITA 似乎在美国提供了这一点，但在实践中，签订合同时条款未明确的协议是没有意义的。它要么是 GPLv2，要么是其他东西。

假设这个“许可证”是为了覆盖整个包，那么它是如此自相矛盾以至于胡言乱语。

一组软件可能包含不同许可证下的组件（典型的 Linux 发行版包含在 GPLv2、MIT、BSD、Mozila 公共许可证、Apache 许可证、Perl 许可证、PHP 许可证、CCDL ......下提供的软件）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-03T22:37:55.590

您遇到权限问题。可以修改 GPLv2 代码 - 但是您的操作系统会阻止您保存或打开文件。我的猜测是您正在尝试在 linux 服务器上执行此操作，并且该文件不属于您的“用户”。

代码许可证只是有关文件的法律文本 - 它对文件的操作或行为方式没有影响。它不是物理安全系统。

在其他新闻中，只要您的更改也在 GPL 下发布，GPL 代码就可以被修改、保留或放弃。基本上，分享和分享。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-03T22:56:56.183

要扩展@Xeoncross 的答案，这里有两个与 GPL 及其扩展目录相关的 Joomla.org 特定答案。

1.  [Joomla 扩展目录和 GPL](http://docs.joomla.org/Extensions_and_GPL)
2.  [免费和商业扩展](http://docs.joomla.org/Free_and_Commercial_extensions)

# wpf - Wpf ItemsControl.ItemsPanelTemplate 作为网格并在不同列中添加新项目

> ID：11320166
> 
> 赞同：3
> 
> 时间：2012-07-03T22:35:53.407
> 
> 标签：wpf, grid, dynamically-generated, itemspaneltemplate

我正在处理一个动态创建的网格，每个新列中都包含一个添加到 ItemsControl 的新项目。

我正在使用 Rachel Lim 的[GridHelper](https://stackoverflow.com/a/9007442/1462911)

现在，我有一个如下主窗口，

Xml代码：

```
<Window x:Class="WpfApplication1.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:WpfApplication1"
    Title="MainWindow" Height="350" Width="525">
    <Window.Resources>
        <local:StarsConverter x:Key="conv"/>
    </Window.Resources>
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="9*"/>
        </Grid.ColumnDefinitions>
        <Button Grid.Column="0" Command="{Binding Add}"/>
        <ItemsControl x:Name="list" Grid.Column="1" ItemsSource="{Binding Oc}">
            <ItemsControl.ItemsPanel>
                <ItemsPanelTemplate>
                    <Grid x:Name="grid" Background="Black"
                      local:GridHelpers.StarColumns="{Binding ColumnCount, Converter={StaticResource conv}, Mode=OneWay}" local:GridHelpers.ColumnCount="{Binding ColumnCount}"/>
                </ItemsPanelTemplate>
            </ItemsControl.ItemsPanel>
            <ItemsControl.ItemTemplate>
                <DataTemplate>
                    <Canvas Loaded="canvas_Loaded" x:Name="canvas" Background="White">
                        <Border  Canvas.Left="25" Canvas.Top="25" Height="25" Width="50" Background="Red">
                            <TextBlock Text="{Binding}"/>
                        </Border>
                    </Canvas>
                </DataTemplate>
            </ItemsControl.ItemTemplate>
        </ItemsControl>
    </Grid>
</Window> 
```

和 Xaml.cs

```
public partial class MainWindow : Window
{
    private Canvas canvas;
    public MainWindow()
    {
        InitializeComponent();

        this.DataContext = new ViewModel();
    }

    private void canvas_Loaded(object sender, RoutedEventArgs e)
    {
        ViewModel vm = this.DataContext as ViewModel;
        canvas = sender as Canvas;
        Binding b = new Binding();
        b.Source = vm;
        b.Path = new PropertyPath(ViewModel.ColumnCountProperty);
        b.Mode = BindingMode.OneWay;
        canvas.SetBinding(Grid.ColumnProperty, b);
    }
} 
```

这个 MainWindow 有一个 ViewModel 作为 DataContext：

```
public class ViewModel : DependencyObject
{
    private RelayCommand add;

    public ViewModel()
    {
    }

    public ObservableCollection<String> Oc
    {
        get { return (ObservableCollection<String>)GetValue(OcProperty); }
        set { SetValue(OcProperty, value); }
    }

    // Using a DependencyProperty as the backing store for Oc.  This enables animation, styling, binding, etc...
    public static readonly DependencyProperty OcProperty =
        DependencyProperty.Register("Oc", typeof(ObservableCollection<String>), typeof(ViewModel), new UIPropertyMetadata(new ObservableCollection<string>()));

    public int ColumnCount
    {
        get { return (int)GetValue(ColumnCountProperty); }
        set { SetValue(ColumnCountProperty, value); }
    }

    // Using a DependencyProperty as the backing store for ColumnCount.  This enables animation, styling, binding, etc...
    public static readonly DependencyProperty ColumnCountProperty =
        DependencyProperty.Register("ColumnCount", typeof(int), typeof(ViewModel), new UIPropertyMetadata(0));

    public RelayCommand Add
    {
        get
        {
            if (this.add == null)
                this.add = new RelayCommand(param => this.AddString(), param => this.CanAddString());
            return this.add;
        }
    }

    private bool CanAddString()
    {
        return true;
    }

    private void AddString()
    {
        this.Oc.Add("test" + ColumnCount);
        ColumnCount++;
    }
} 
```

当我单击按钮时，该命令运行良好，因此我有一个新的 itemscontrol 项和我的网格，因为 ItemsPanelTemplate 正在使用新的 ColumnDefinition 进行更新，但该项目不在右列中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-08-21T12:06:24.360

我知道这是一个迟到的答案 :)
一个更优雅的解决方案是将两个 Dependency Properties Row 和 Column 添加到您的 Items ViewModel

然后在您的 ItemsControl 中定义一个 ItemContainerStyle：

```
<ItemsControl>
     <ItemsControl.ItemContainerStyle>
       <Style>                            
          <Setter Property="Grid.Row" Value="{Binding Path=Row}" />
          <Setter Property="Grid.Column" Value="{Binding Path=Column}" />
       </Style>                  
    </ItemsControl.ItemContainerStyle>
</ItemsControl> 
```

当您填充 ItemsSource 集合时，您已经设置了 The Row 和 Column 属性：

```
for (uint i = 0; i < yourCollection.Count; ++i )
{
    var item = yourCollection[i];
    item.Row = (int)(i / ColumnCount);
    item.Column = (int)(i % ColumnCount);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T20:56:47.943

事实上 canvas_loaded 的东西是没用的......

问题来自 ColumnCountChanged 中的 GridHelpers 类。

我在 SetStarColumns(grid) 之后的 ColumnCountChanged 事件的末尾添加了这个，以便在相应的单元格中添加项目：

```
for (int i = 0; i < childCount; i++)
{
    var child = grid.Children[i] as FrameworkElement;
    Grid.SetColumn(child, i);
} 
```

它奏效了！

**编辑：**我还使用了一个转换器（在上面的 Xaml 示例中称为“conv”）用于 ColumnCount ViewModel 属性上 GridHelper.StarColumns 属性的 OneWay 绑定，以使所有新创建的列的大小相同：

```
public class StarsConverter : IValueConverter
{
    public object Convert(object value, Type TargetType, object parameter, CultureInfo culture)
    {
        int i = (int)value;
        string s = "0";
        for (int j = 1; j < i; j++)
        {
            s = s + ',' + j;

        }
        return s;
    }
    public object ConvertBack(object value, Type TargetType, object parameter, CultureInfo culture)
    {
        throw new NotImplementedException();
    }
} 
```

# jquery - Grails：使用 javascript 在同一视图中显示结果

> ID：11320173
> 
> 赞同：1
> 
> 时间：2012-07-03T22:36:19.503
> 
> 标签：jquery, grails

我有两个域（模型）工作和结果。列出已运行的作业的作业页面和结果页面列出了作业的结果。

我想要做的是结合这两个页面，以便用户停留在一个页面上。

我的解决方案是使用remoteFunction，我很接近但一直坚持从Grails 获取数据。下面的代码调用我的控制器（方法**doit**）并返回一个 Groovy 列表：

```
...  
<g:render template="resulttable" />
<button id=show>show()</button>
<script type="text/javascript">
$("#show").click(function () {
  // Returns Groovy List
  var results = <g:remoteFunction action="doit" id="${idx}" update="showit"/>  
  $(".resulttable").show('slow');
}); 
```

我不是 jQuery 高手，那么我该如何处理这个结果列表呢？我已经尝试了六种不同的东西并且被难住了。我有一个部分**结果表**，我想在其中显示结果。还是我用这种方法在左外野？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T04:06:40.153

我认为您不一定需要直接使用 jQuery 来执行此操作。您可以像这样设置您的 gsp：

```
<g:remoteLink action="doit" id="${idx}" update="showit"><button>show()</button></g:remoteLink>
<div id="showit">
</div> 
```

然后在您的控制器中执行`doit`以下操作：

```
def doit = {
    //find your list here
    def yourList = ...
    render(template: "resulttable", model: [listInTemplate: yourList])
} 
```

# java - JDBC-ODBC 连接到 Excel

> ID：11320176
> 
> 赞同：1
> 
> 时间：2012-07-03T22:36:59.780
> 
> 标签：java, excel, jdbc, odbc

我正在尝试使用 sun.jdbc.odbc.JdbcOdbcDriver 通过 Java 访问 Microsoft Excel 文件。但是，我不断收到：“java.sql.SQLException：[Microsoft][ODBC Driver Manager] Data source name not found and no default driver specified”。

```
try
{
 Class.forName("sun.jdbc.odbc.JdbcOdbcDriver");
 Connection c = DriverManager.getConnection("jdbc:odbc:Driver={Microsoft Excel Driver (*.xls)};DBQ="+ fileName + ";DriverID=22;READONLY=false;");
 c.close();
}
catch(Exception ex)
{
 JOptionPane.showMessageDialog(parent, ex.toString());
} 
```

干杯!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-06-20T15:43:45.823

我知道这是 WAYYYYYY 晚了，但以防万一其他人在这里徘徊：

我很确定您需要整个文件路径，包括您要连接的文件。像这样的东西：

```
Class.forName($Driver"URL").newInstance();
CONNECTION = DriverManager.getConnection( "jdbc:odbc:Driver={Microsoft Excel Driver (*.xls)};DBQ=C:/Users/Pat/Documents/test.xls"); 
```

# mysql - 从表中对 MySQL 值进行分组

> ID：11320177
> 
> 赞同：0
> 
> 时间：2012-07-03T22:37:03.853
> 
> 标签：mysql

我确定这是可能的，我不知道从哪里开始。我有一个包含 2000 个值的表，它们的范围从 0 到 100。我想查询该表以获取不同的值组。即我有这些值 5, 10 , 5 , 2 , 2, 0, 1, 1, 1, 1, 1, 10, 2

我想要这样的输出：

```
 Value - Number_of_times 
   0            1
   1            5
   2            3
   5            2
  10            2 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-03T22:37:55.550

您需要按您的领域对结果进行分组，并获取[`COUNT()`](http://dev.mysql.com/doc/en/group-by-functions.html#function_count)每个组的结果：

```
SELECT   myfield, COUNT(*) as number_of_times
FROM     mytable
GROUP BY myfield 
```

# haskell - 在固定时间内计算尽可能多的列表

> ID：11320180
> 
> 赞同：25
> 
> 时间：2012-07-03T22:37:15.773
> 
> 标签：haskell, time, timeout

我想编写一个函数，它需要一个时间限制（以秒为单位）和一个列表，并在时间限制内计算尽可能多的列表元素。

我的第一次尝试是首先编写以下函数，该函数对纯计算进行计时并返回经过的时间以及结果：

```
import Control.DeepSeq
import System.CPUTime

type Time = Double

timed :: (NFData a) => a -> IO (a, Time)
timed x = do t1 <- getCPUTime
             r  <- return $!! x
             t2 <- getCPUTime
             let diff = fromIntegral (t2 - t1) / 10^12
             return (r, diff) 
```

然后我可以定义我想要的功能：

```
timeLimited :: (NFData a) => Time -> [a] -> IO [a]
timeLimited remaining []     = return []
timeLimited remaining (x:xs) = if remaining < 0
    then return []
    else do
        (y,t) <- timed x
        ys    <- timeLimited (remaining - t) xs
        return (y:ys) 
```

但这并不完全正确。即使忽略计时错误和浮点错误，这种方法一旦开始就不会停止列表元素的计算，这意味着它可能（实际上通常会）超出其时间限制。

相反，如果我有一个函数，如果它花费了太长时间，它可能会使评估短路：

```
timeOut :: Time -> a -> IO (Maybe (a,t))
timeOut = undefined 
```

然后我可以编写我*真正*想要的函数：

```
timeLimited' :: Time -> [a] -> IO [a]
timeLimited' remaining []     = return []
timeLimited' remaining (x:xs) = do
    result <- timeOut remaining x
    case result of
        Nothing    -> return []
        Just (y,t) -> do
            ys <- timeLimited' (remaining - t) xs
            return (y:ys) 
```

我的问题是：

1.  我该怎么写`timeOut`？
2.  是否有更好的方法来编写函数`timeLimited`，例如，不会因多次累加时间差而遭受累积浮点误差的影响？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-04T03:46:20.687

这是一个我可以使用上面的一些建议来制作的例子。我没有进行大量测试以确保在计时器用完时准确地切断工作，但根据 文档[`timeout`](http://hackage.haskell.org/packages/archive/base/latest/doc/html/System-Timeout.html)，这应该适用于所有不使用 FFI 的东西。

```
import Control.Concurrent.STM
import Control.DeepSeq
import System.Timeout

type Time = Int

-- | Compute as many items of a list in given timeframe (microseconds)
--   This is done by running a function that computes (with `force`)
--   list items and pushed them onto a `TVar [a]`.  When the requested time
--   expires, ghc will terminate the execution of `forceIntoTVar`, and we'll
--   return what has been pushed onto the tvar.
timeLimited :: (NFData a) => Time -> [a] -> IO [a]
timeLimited t xs = do
    v <- newTVarIO []
    _ <- timeout t (forceIntoTVar xs v)
    readTVarIO v 

-- | Force computed values into given tvar
forceIntoTVar :: (NFData a) => [a] -> TVar [a] -> IO [()]
forceIntoTVar xs v = mapM (atomically . modifyTVar v . forceCons) xs

-- | Returns function that does actual computation and cons' to tvar value
forceCons :: (NFData a) => a -> [a] -> [a]
forceCons x = (force x:) 
```

现在让我们尝试一些昂贵的东西：

```
main = do
    xs <- timeLimited 100000 expensiveThing   -- run for 100 milliseconds
    print $ length $ xs  -- how many did we get?

-- | Some high-cost computation
expensiveThing :: [Integer]
expensiveThing = sieve [2..]
  where
      sieve (p:xs) = p : sieve [x|x <- xs, x `mod` p > 0] 
```

用 编译和运行`time`，它似乎可以工作（显然在定时部分之外有一些开销，但我大约是 100 毫秒：

```
$ time ./timeLimited
1234
./timeLimited  0.10s user 0.01s system 97% cpu 0.112 total 
```

另外，关于这种方法的一些注意事项；因为我在一次调用中将运行计算并将它们推送到 tvar 的整个操作封闭起来，所以`timeout`在创建返回结构时可能会丢失一些时间，尽管我假设（如果你的计算成本很高）它不会t 占或大部分时间。

**更新**

现在我已经有时间考虑了，由于 Haskell 的懒惰，我不是 100% 肯定上面的注释（关于创建回报结构所花费的时间）是正确的；无论哪种方式，如果这对于您要完成的工作来说不够精确，请告诉我。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-04T01:13:10.850

您可以`timeOut`使用您提供的类型来实现[`timeout`](http://hackage.haskell.org/packages/archive/base/latest/doc/html/System-Timeout.html#v%3atimeout)and [`evaluate`](http://hackage.haskell.org/packages/archive/base/latest/doc/html/Control-Exception-Base.html#v%3aevaluate)。它看起来像这样（我省略了计算剩余时间的部分——使用`getCurrentTime`或类似的部分）：

```
timeoutPure :: Int -> a -> IO (Maybe a)
timeoutPure t a = timeout t (evaluate a) 
```

如果你想要更多的强制，而不仅仅是弱头范式，你可以用一个已经序列化的参数来调用它，例如，`timeoutPure (deepseq v)`而不是`timeoutPure v`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-04T07:35:33.943

当达到超时时，我将与 TVar 一起使用两个线程并在计算线程中引发异常（导致每个正在进行的事务回滚）：

```
forceIntoTVar :: (NFData a) => [a] -> TVar [a] -> IO [()]
forceIntoTVar xs v = mapM (atomically . modifyTVar v . forceCons) xs

-- | Returns function that does actual computation and cons' to tvar value
forceCons :: (NFData a) => a -> [a] -> [a]
forceCons x = (force x:)

main = do

  v <- newTVarIO []
  tID <- forkIO $ forceIntoTVar args v
  threadDelay 200
  killThread tID
  readTVarIO v 
```

**在此示例中，您（可能）需要稍微调整forceIntoTVar**以便例如列表节点不在原子事务内部计算，而是首先计算，然后启动原子事务以将它们添加到列表中。

在任何情况下，当引发异常时，正在进行的事务被回滚或正在进行的计算在结果被提供给列表之前停止，这就是你想要的。

您需要考虑的是，当准备节点的单个计算以高频率运行时，与不使用 STM 相比，此示例可能非常昂贵。

# php - 确保有唯一的数组条目

> ID：11320185
> 
> 赞同：3
> 
> 时间：2012-07-03T22:37:25.450
> 
> 标签：php, arrays, unique, verification

我有一个包含以下内容的文件：

```
toto;145
titi;7
tata;28 
```

我将这个文件分解成一个数组。我能够使用该代码显示数据：

```
foreach ($lines as $line_num => $line) {
    $tab = explode(";",$line);
    //erase return line
    $tab[1]=preg_replace('/[\r\n]+/', "", $tab[1]);
    echo $tab[0]; //toto //titi //tata
    echo $tab[1]; //145 //7 //28
} 
```

我想确保每个中包含的数据`$tab[0]`是`$tab[1]`唯一的。

例如，如果文件如下，我想要一个“抛出新异常”：

```
toto;145
titi;7
tutu;7
tata;28 
```

或喜欢：

```
toto;145
tata;7
tata;28 
```

我怎样才能做到这一点 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-03T22:54:48.510

使用 将文件转换为数组`file()`，并通过额外的重复检查转换为关联数组。

```
$lines = file('file.txt', FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);
$tab = array();
foreach ($lines as $line) {
    list($key, $val) = explode(';', $line);
    if (array_key_exists($key, $tab) || in_array($val, $tab)) {
        // throw exception
    } else {
        $tab[$key] = $val;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-03T22:40:36.823

将它们作为 key => value 对存储在数组中，并在循环文件时检查数组中是否已经存在每个键或值。[您可以使用array_key_exists](http://php.net/array_key_exists)检查现有键，使用[in_array](http://php.net/in_array)检查现有值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-03T22:43:45.250

一个简单的方法是使用[array_unique](http://php.net/manual/en/function.array-unique.php)，在分解后将部件（tab[0] 和 tab[1]）保存到两个单独的数组中，例如将它们命名为 $col1 和 $col2，然后，您可以执行以下简单测试：

```
<?php
if (count(array_unique($col1)) != count($col1))
echo "arrays are different; not unique";
?> 
```

如果存在重复条目，PHP 会将您的数组部分变成唯一的，因此如果新数组的大小与原始数组不同，则意味着它不是唯一的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-03T22:40:35.687

当您遍历数组时，将值添加到现有数组中，即占位符，这将用于通过[in_array()](http://www.php.net/manual/en/function.in-array.php)检查值是否存在。

```
<?php
$lines = 'toto;145 titi;7 tutu;7 tata;28';
$results = array();

foreach ($lines as $line_num => $line) {
    $tab = explode(";",$line);
    //erase return line
    $tab[1]=preg_replace('/[\r\n]+/', "", $tab[1]);

    if(!in_array($tab[0]) && !in_array($tab[1])){
        array_push($results, $tab[0], $tab[1]);
    }else{
        echo "value exists!";
        die(); // Remove/modify for different exception handling
    }

}

?> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-03T22:41:28.097

使用键为“toto”、“tata”等的关联数组。
要检查键是否存在，您可以使用[array_key_exists](http://php.net/array_key_exists)或[isset](http://php.net/manual/en/function.isset.php)。

顺便提一句。而不是`preg_replace('/[\r\n]+/', "", $tab[1])`，尝试[trim](http://php.net/manual/en/function.trim.php)（甚至[rtrim](http://www.php.net/manual/en/function.rtrim.php)）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-03T22:46:13.257

```
//contrived file contents
$file_contents = "
toto;145
titi;7
tutu;7
tata;28";

//split into lines and set up some left/right value trackers
$lines = preg_split('/\n/', trim($file_contents));
$left = $right = array();

//split each line into two parts and log left and right part
foreach($lines as $line) {
    $splitter = explode(';', preg_replace('/\r\n/', '', $line));
    array_push($left, $splitter[0]);
    array_push($right, $splitter[1]);
}

//sanitise left and right parts into just unique entries
$left = array_unique($left);
$right = array_unique($right);

//if we end up with fewer left or right entries than the number of lines, error...
if (count($left) < count($lines) || count($right) < count($lines))
    die('error'); 
```

# testcomplete - Keword测试失败后如何通过TestComplete关闭程序

> ID：11320192
> 
> 赞同：1
> 
> 时间：2012-07-03T22:38:03.430
> 
> 标签：testcomplete

所以可以说我正在做一个测试完成关键字测试。如果其中出现问题，则文本停止。实际上，我发现如果我有 8 个检查点，如果第 4 个检查点失败，其余的总是会失败。所以我得到一个“测试执行被中断”错误。那很好，但它没有完成测试并关闭应用程序。这是一个问题的原因是因为它之后的任何测试都会失败，因为应用程序仍然处于打开状态。我可以重写这些测试，以便应用程序在启动时打开，但是在测试失败后有没有办法杀死和应用程序？如果测试通过，则关闭应用程序。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T08:23:18.667

您需要使用测试项目来组织测试。在这种情况下，您至少创建 3 个测试项：第一个启动应用程序，第二个执行测试，第三个关闭应用程序。如果在执行第二个测试期间发生错误，则结束该第二个测试执行，并且 TestComplete 运行第三个最终确定测试项。

有关测试项目的信息可以在[测试和测试项目](http://support.smartbear.com/viewarticle/29699/)帮助主题中找到。请注意，您需要在**Stop on error**列中为所需的测试项目（上例中的第二个）指定**测试项目**值。可以在[此处](http://support.smartbear.com/viewarticle/33322/)找到有关此栏和其他栏的信息。该列默认隐藏，您需要添加它：右键单击测试项目列表的标题并选择**Field Chooser**。在此之后，将所需的列从“**字段**选择器”对话框拖到标题。

 ******[在停止对错误和异常的测试中](http://support.smartbear.com/viewarticle/28751/)找到有关此解决方案的更多信息。

替代解决方案是使用**OnLogError**或**OnStopTest**事件处理程序。[在为 TestComplete 事件创建事件处理程序](http://support.smartbear.com/viewarticle/33041/)帮助主题中查找有关如何处理标准 TestComplete 事件的描述。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-03T23:15:45.027

也许我过于简单化了，但这可能是测试回放的设置吗？请检查以下页面，如果有帮助，请告诉我：http: [//support.smartbear.com/viewarticle/28751/](http://support.smartbear.com/viewarticle/28751/)。

如果这不起作用，请随时在 SmartBear 论坛中重新发布：http: [//community.smartbear.com/](http://community.smartbear.com/)

支持团队正在监控论坛，我相信他们会很乐意提供帮助。******

# list - CLIPS 增加了列表中某些项目的确定性

> ID：11320193
> 
> 赞同：0
> 
> 时间：2012-07-03T22:38:17.073
> 
> 标签：list, expert-system, clips

我有这样定义的葡萄酒：

```
(deftemplate wine
  (slot name)
  (slot color)
  (slot certainty (type NUMBER) (default 0))) 
```

并且列表自由葡萄酒定义如下：

```
(deffacts wines
  (wine (name "Chardonnay") (color white))
  (wine (name "Merlot") (color red))
  (wine (name "Cabernet sauvignon") (color red))) 
```

现在，如果触发规则，我想增加列表中颜色槽设置为“红色”的项目的确定性值。

任何想法如何做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T14:37:57.110

我是 CLIPS 的新手，所以我确信有更好的方法，但以下规则可以满足您的需求：

```
(defrule inc-wines-with-color
  (increase-all-with color ?color ?amount)
  (wine (name ?name) (color ?color))
  =>
  (assert (increase-certainty ?name ?amount)))

(defrule retract-inc-all-with
  ?f <- (increase-all-with $?)
  =>
  (retract ?f))

(defrule increase-wine-certainty
  (not (increase-all-with $?))
  ?ic <-(increase-certainty ?name ?amount)
  ?wine <- (wine (name ?name) (certainty ?c))
  =>
  (printout t "Incrementing " ?name " from " ?c " to " (+ ?amount ?c) crlf)
  (modify ?wine (certainty (+ ?amount ?c)))
  (retract ?ic)) 
```

以下是运行它的结果：

```
CLIPS> (reset)
CLIPS> (assert (increase-all-with color red 0.2))
<Fact-4>
CLIPS> (run)
Incrementing Merlot from 0 to 0.2
Incrementing Cabernet sauvignon from 0 to 0.2
CLIPS> (facts)
f-0     (initial-fact)
f-1     (wine (name "Chardonnay") (color white) (certainty 0))
f-7     (wine (name "Merlot") (color red) (certainty 0.2))
f-8     (wine (name "Cabernet sauvignon") (color red) (certainty 0.2))
For a total of 4 facts. 
```

注意：您可能需要将冲突解决策略设置为 LEX 或 MEA，以保证规则的正确排序。

# mysql - 调用同一个表和同一个触发器的递归 MySQL 触发器

> ID：11320194
> 
> 赞同：0
> 
> 时间：2012-07-03T22:38:17.370
> 
> 标签：mysql, sql, triggers

我正在为一个 php 站点编写一个简单的论坛。我正在尝试计算每个类别的帖子数。现在一个类别可以属于另一个类别，根类别被定义为具有 NULL parent_category_id。使用这种架构，一个类别可以有无限数量的子类别，并使表结构保持相当简单。

为了简单起见，假设类别表有 3 个字段：`category_id`、`parent_category_id`、`post_count`。我不认为剩余的数据库结构是相关的，所以我暂时不考虑它。

另一个触发器正在调用使该触发器运行的类别表。我想要的是更新帖子数，然后递归地遍历每个父类别，增加帖子数。

```
DELIMITER $$

CREATE TRIGGER trg_update_category_category_post_count BEFORE UPDATE ON categories FOR EACH ROW
BEGIN
IF OLD.post_count != NEW.post_count THEN
  IF OLD.post_count < NEW.post_count THEN
    UPDATE categories SET post_count = post_count + 1 WHERE categories.category_id = NEW.parent_category_id;
  ELSEIF OLD.post_count > NEW.post_count THEN
    UPDATE categories SET post_count = post_count - 1 WHERE categories.category_id = NEW.parent_category_id;
  END IF;
END IF;
END $$

DELIMITER ; 
```

我得到的错误是：

```
#1442 - Can't update table 'categories' in stored function/trigger because it is already used by statement which invoked this stored function/trigger. 
```

我认为您可以在每个页面加载时执行 count() 来计算帖子总数，但在大型论坛上，这会减慢速度，正如此处多次讨论的那样（例如[，使用 php 计数帖子或存储在数据库中](https://stackoverflow.com/questions/1969849/count-posts-with-php-or-store-in-database)）。因此，为了将来打样，我将帖子计数存储在表中。为了更进一步，我想我会使用触发器来更新这些计数而不是 PHP。

我知道 MySQL 对在正在更新的同一个表上运行触发器存在限制，这就是导致此错误的原因（即停止无限循环），但在这种情况下，一旦到达具有 NULL parent_category_id 的类别，循环肯定会停止? 无论是调整这个触发器还是完全不同的东西，都必须有某种解决方案。谢谢。

**编辑**我很欣赏这可能不是最好的做事方式，但它是我能想到的最好的事情。我想如果您将父母类别更改为另一个类别，它会搞砸，但这可以通过另一个重新同步所有内容的触发器来解决。我对如何解决这个问题的其他建议持开放态度。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T09:38:38.437

我通常建议不要使用触发器，除非你真的非常需要；递归触发器是引入难以重现的错误的好方法，并且要求开发人员了解一个看似简单的操作的副作用——“我所做的只是将一条记录插入到类别表中，现在整个数据库已锁定向上”。我已经多次看到这种情况发生 - 没有人做错或愚蠢的事情，这只是你冒着副作用的风险。

所以，我只会在你能证明你需要的时候才使用触发器；与其依赖基于一般性的陌生人的意见，我会搭建一个测试环境，放入几百万条测试记录，并尝试优化“在页面加载时计算帖子”解决方案以使其正常工作。

一个可能对此有所帮助的数据库设计是[Joe Celko 的“嵌套集”模式](http://www.ibase.ru/devinfo/DBMSTrees/sqltrees.html)——这需要一段时间才能让你头脑清醒，但查询速度可能非常快。

只有当你知道你有一个除了预先计算帖子计数之外你真的无法解决的问题时，我才会考虑使用基于触发器的方法。我会将“帖子计数”分开到一个单独的表格中；这使您的设计更简洁，并且应该解决递归触发问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T09:51:44.803

最简单的解决方案是获取每个类别的所有帖子，然后使用脚本/编程语言将它们链接在一起：

例如在 php 中：

```
<?php
// category: id, parent, name
// posts: id, title, message
$sql = "select *, count(posts.id) From category left join posts ON posts.cat = category.id Group by category.id";
$query = mysql_query($sql);
$result = array();
while($row = mysql_fetch_assoc($query)){
  $parent = $row['parent'] == null ? 0 : $row['parent'];
  $result[$parent][] = $row;
}
recur_count(0);
var_dump($result);
function recur_count($depth){
    global $result;

    var_dump($result[$depth],$depth); 
       foreach($result[$depth] as $id =>  $o){
          $count = $o['count'];
          if(isset($result[$o['id']])){
             $result[$depth][$id]['count']  += recur_count($o['id']);
           }   

       }   
        return $count;

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T13:55:38.850

好的，所以对于想知道我是如何解决这个问题的人来说，我混合使用了触发器和 PHP。

我没有让每个类别更新其父级，而是将其保留为以下结构：一个帖子更新它的线程，然后一个线程使用帖子计数更新它的类别。

然后，我使用 PHP 从数据库中提取所有类别，并使用以下内容循环添加每个帖子计数值：

```
function recursiveCategoryCount($categories)
{
    $count = $categories['category']->post_count;

    if(!is_null($categories['children']))
        foreach($categories['children'] as $child)
            $count += recursiveCategoryCount($child);

    return $count;  
} 
```

在最坏的情况下，PHP 不会在每个页面加载时添加每个帖子，它只会添加总类别帖子（取决于您所在树中的哪个节点）。这应该非常有效，因为您根据类别的数量将总计算量从 1000 减少到 10 或 100。我还建议每周运行一个脚本来重新计算帖子计数，以防它们变得不同步，就像 phpBB。如果我在使用触发器时遇到问题，那么我会将该功能移到代码中。感谢大家的建议。

# java - 新的 jre7 尝试块资源

> ID：11320196
> 
> 赞同：3
> 
> 时间：2012-07-03T22:38:22.123
> 
> 标签：java, try-catch, java-7

如果我做类似的事情

```
 try (
        Connection conn = Database.getConnection();
        PreparedStatement ps = conn.prepareStatement("SELECT * FROM table WHERE something = ? LIMIT 1");
    ) {
        ps.setString(1, "hello world");
        ResultSet results = ps.executeQuery();
        if(results.next()) {
            // blah
        }
    } catch(SQLException e) {
        e.printStackTrace();
    } 
```

当 PreparedStatement 关闭时，ResultSet 是否仍会关闭，还是我还必须显式关闭 ResultSet？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-03T23:21:44.717

根据[javax.sql.Statement.close()](http://docs.oracle.com/javase/6/docs/api/java/sql/Statement.html#close%28%29)方法的 JavaDoc：

> 注意：当 Statement 对象关闭时，其当前的 ResultSet 对象（如果存在）也将关闭。

因此，回答您的问题 - 是的，`ResultSet`将在您的情况下自动关闭，因为相关`Statement`已在`try-with-resources`块中关闭。

但是，请注意，明确关闭`ResultSet`s 是一种建议遵循的良好做法，因此您按照良好做法修改的代码如下所示：

```
try (
    Connection conn = Database.getConnection();
    PreparedStatement ps = prepareStatement(conn, "SELECT * FROM table WHERE something = ? LIMIT 1", param);
    ResultSet results = ps.executeQuery();
) {        
    if(results.next()) {
        // blah
    }
} catch(SQLException e) {
    e.printStackTrace();
}

private static PreparedStatement prepareStatement(Connection connection, String sql, String param) throws SQLException {
    final PreparedStatement ps = conn.prepareStatement(sql);
    ps.setString(1, param);
    return ps;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-03T23:01:53.590

~~始终~~作为一种好的做法，请尝试关闭您的~~ResultSets 和~~PreparedStatements。在 finally 块中。~~每一次~~，管理异常，所以你不会让资源无人看管（这是泄漏的常见来源）。

除非您将它们注入方法，否则调用方法可能需要它们。

编辑：立场更正。如果结果集是作为 try-with-resource 创建的，则会随着您的 PS 而死。

# jquery - Fancybox jQuery 链接到外部页面

> ID：11320205
> 
> 赞同：0
> 
> 时间：2012-07-03T22:39:40.967
> 
> 标签：jquery, jquery-plugins, fancybox, lightbox

我可能在这里问一个菜鸟问题，但我似乎找不到答案。

我已经设置了fancybox，它的工作就像一个魅力。我将外部页面调用到 iframe 功能中。在页面上（我加载到灯箱中）有一个联系页面链接。当我单击它时，联系人页面会加载到 iframe 中。

单击“联系链接”时，我想关闭灯箱并转到联系页面。

有人可以帮助我吗？提前致谢...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-11-04T20:33:12.937

只需将 target="_parent" 放在链接上，它就会像魅力一样工作。这也可能是您一生中第一次使用它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-03T22:47:25.360

我假设您的链接是这样的：`<a href="contact.php">Contact Page</a>`. 如果是这样，请尝试将其更改为以下内容：`<a onClick="closeFBContact()" style="cursor: pointer;">Contact Page</a>`

此代码将做的是链接到 Javascript 函数而不是实际页面。我还添加了一些光标样式，以使您的`a`标签仍然看起来像可点击的超链接。

从那里，转到您初始化 Fancybox 的主 Javascript 文件并编写以下内容：

```
function closeFBContact() {
    $.fancybox.close; //This will close the Fancybox window
    window.open("contact.php"); //This will change the page to contact.php
} 
```

查看[Fancybox 的 API](http://fancybox.net/api)以获取有关其公共方法的更多信息。在使用该插件时，这应该对您有所帮助。

# java - 有效地使用设置器

> ID：11320208
> 
> 赞同：0
> 
> 时间：2012-07-03T22:40:16.360
> 
> 标签：java, setter

所以，我想为一个 bean 设置一些属性。我必须设置 25 个变量值。我知道我可以写 25 个集合语句，比如 bean.setProperty()。我想知道是否有更有效或更清洁的方法来做到这一点！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-03T22:50:56.777

如果您知道属性的名称并且它们的名称与设置器匹配，则可以使用反射。

这是一个示例（未测试）：

```
public String getSetterName(String property) {
    StringBuilder methodName     = new StringBuilder();
    Character     firstCharacter = Character.toUpperCase(property.charAt(0));

    methodName.append("set").append(firstCharacter).append(property.substring(1));
    return methodName.toString();
}

public void callSetters(Bean bean, String properties[], Object values[]) {
    for (int idx = 0; idx < properties.length; idx++) {
        String property   = properties[idx];
        Object value      = values[idx];
        String setterName = getSetterName(property);

        try {
            Method method = Bean.class.getMethod(setterName);
            method.invoke(bean, value);
        } catch (NoSuchMethodException nsmE) {
            // method doesn't exist for the given property, handle...
        } catch (InvocationTargetException itE) {
            // failed to invoke on target, handle...
        } catch (IllegalAccessException iaE) {
            // can't access method, handle...
        }
    }
} 
```

此代码假定`properties`并具有相同的长度，并且具有从到`values`的一对一映射，因此任何给定索引处的值都适用于同一索引处的属性。`property``value`

*注意：这假定 setter 是使用 Java 中的标准做法生成的（即，名为的属性`myName`将具有名为`setMyName`.*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-03T23:13:59.933

如果所有属性都是普通属性，那么最简洁的方法是使用[方法链](http://en.wikipedia.org/wiki/Method_chaining)。

但是，如果要创建的对象更复杂，则应考虑使用构建器模式，其描述可在此处找到： [http ://rwhansen.blogspot.com/2007/07/theres-builder-pattern-that-约书亚.html](http://rwhansen.blogspot.com/2007/07/theres-builder-pattern-that-joshua.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-04T01:34:39.040

你在使用 Eclipse 吗？如果是这样，一旦定义了 bean 类和所有类成员，只需右键单击其中一个成员变量，选择 Source，然后“Generate Getter and Setters...”，单击 Select All 按钮，然后单击 OK你就完成了。

在 Java 中，您的选择是 1) 使变量本身公开，然后无法通过方法限制它们的修改，2) 使它们成为受保护/私有的成员变量，并且只能通过 setter 和 getter 方法修改，或者 3) 使它们私有并且只能通过类构造函数设置。

# php - 在服务器忽略的脚本 PHP 输出缓冲区设置中

> ID：11320217
> 
> 赞同：4
> 
> 时间：2012-07-03T22:40:51.753
> 
> 标签：php

我一直在尝试按需将某些脚本的输出刷新到浏览器，但它们在我们的生产服务器上不起作用。

例如，我尝试运行“Phoca 更改排序工具”（在 Google 上找到），在脚本完成执行之前我看不到任何输出。

我已经尝试立即刷新其他脚本上的缓冲区，该脚本在任何服务器上都可以正常工作，但这个使用以下代码：

```
echo "something";
ob_flush();
flush(); 
```

设置“ob_implicit_flush(1);” 也无济于事。

服务器是 Apache 2.2.21，在 Linux 上运行 PHP 5.2.17。如果有帮助，您可以在此处查看我们的 php.ini 文件： [http ://www.smallfiles.org/download/1123/php.ini.html](http://www.smallfiles.org/download/1123/php.ini.html)

这不是我们在服务器忽略脚本指令时遇到的唯一问题。服务器也会忽略超时编码，例如：

```
ini_set('max_execution_time', 900*60); 
```

和

```
set_time_limit(86400); 
```

脚本总是在 php.ini 默认值下超时。

在 IE 或 Firefox 中执行脚本似乎无关紧要。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T19:23:00.040

解开了这个谜团。两个都。

为了解决输出缓冲区问题，我需要关闭 .htaccess 文件中的 gzip 压缩，但我希望我可以在脚本中执行此操作。

以下是您应该在 .htaccess 文件中放入的内容：

```
<IfModule mod_gzip.c>
    mod_gzip_on  No
</IfModule>

SetEnv no-gzip dont-vary 
```

为了修复脚本终止而没有错误，我检查了我的 Apache 日志文件，发现它不是 PHP，而是在 Apache 配置中：指定的超时已过期：ap_content_length_filter:apr_bucket_read() failed

必须增加 Apache 超时以防止此错误使我的脚本看起来像超时。在 Apache 中启用 KeepAlive 也有助于一劳永逸地解决这个问题。

希望这对某人有所帮助，并感谢其他所有人的帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T08:29:19.333

您可能正在加载不正确的`php.ini`文件，因为它往往会根据目录而变化。

要检查您加载的`php.ini`文件，请写入：`echo php_ini_loaded_file();`，这将为您提供它所在的目录。请参阅[php.net](http://php.net/manual/en/function.php-ini-loaded-file.php)

如果失败，请参阅[serverfault.com](http://serverfault.com)以获取服务器 stackexchange 站点。

# java - 使用 Java 构建和打印复杂的表格布局

> ID：11320220
> 
> 赞同：0
> 
> 时间：2012-07-03T22:41:10.530
> 
> 标签：java, layout, printing, graphics

一位客户要求我提供一个软件，其要求之一是构建一个表格并填写从数据库收集的数据。

此表单当前正在 Excel 中创建。它使用单元格来构建表单，一些单元格具有空白背景，其他单元格具有黑色底边框的空白背景（看起来像输入文本的行），其他单元格具有带有白色文本的灰色背景，还有一个徽标图像。在 Excel 中，一些单元格被合并以变得比其他单元格更大。他们将文本填充到另一个电子表格中，表单中所需的单元格获取该文本并对其进行格式化。

我看过很多 Java 报告框架，有些非常复杂，有些看起来像 Excel 的图形构建器，但我没有看到可以制作像这样复杂的 2D 表单。

填写的数据很简单，如姓名、数量、一些数字，但它们的长度不同，例如需要将该姓名的单元格合并以覆盖一整条水平线，还有一些字体大小较小。没有需要排序的重复数据，我收集数据也没有问题。

最后，填写的表格也必须打印出来，所以我不能使用普通的 Swing 表格或网格。它现在将在 Windows 中使用，但也可以支持 Linux 打印。

任何关于构建像这样的 2D 布局并用字符串填充的 Java 组件的建议都将不胜感激。我什至想截取他们当前形式的屏幕截图，然后只使用 2D Graphics 打印文本，但我无法打印它。

这是我必须构建的那种表单的示例，有点像那样，但有些区域有灰色背景和白色文本：

[![在此处输入图像描述](../Images/d21c70ecafc1604f43f1bee62a4f77ca.png)](https://i.stack.imgur.com/v5zeq.gif)

不，它不是重复的，但它是布局的一个很好的例子。

# python - RE 拆分多个参数 | （或）不返回任何蟒蛇

> ID：11320231
> 
> 赞同：9
> 
> 时间：2012-07-03T22:41:52.920
> 
> 标签：python

我在 python 中使用 RE 表达式并尝试按句点和感叹号分割一大块文本。但是，当我拆分它时，结果中出现“无”

```
a = "This is my text...I want it to split by periods. I also want it to split \
by exclamation marks! Is that so much to ask?" 
```

这是我的代码：

```
re.split('((?<=\w)\.(?!\..))|(!)',a) 
```

请注意，我有这个 (?<=\w).(?!..) 因为我希望它避免省略号。尽管如此，上面的代码还是吐出：

```
['This is my text...I want it to split by periods', '.', None, ' \
I also want it to split by exclamation marks', None, '!', \
' Is that so much to ask?'] 
```

如您所见，句号或感叹号在哪里，它在我的列表中添加了一个特殊的“无”。为什么会这样，我该如何摆脱它？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-03T22:49:56.117

尝试以下操作：

```
re.split(r'((?<=\w)\.(?!\..)|!)', a) 
```

您得到了，`None`因为您有两个捕获组，并且所有组都包含在`re.split()`结果中。

因此，任何时候匹配`.`第二个捕获组都是`None`，任何时候匹配`!`第一个捕获组都是`None`。

结果如下：

```
['This is my text...I want it to split by periods',
 '.',
 ' I also want it to split by exclamation marks',
 '!',
 ' Is that so much to ask?'] 
```

如果您不想在结果中包含`'.'`and `'!'`，只需删除围绕整个表达式的括号：`r'(?<=\w)\.(?!\..)|!'`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-03T22:54:29.280

这是一个更简单的表达式（任何没有在句点之后或之前的句点），外部捕获组围绕整个 or`|`子句来避免`None`，而不仅仅是第一部分：

```
re.split(r'((?<!\.)\.(?!\.)|!)', a)

# Result:
# ['This is my text...I want it to split by periods', 
#  '.', 
#  ' I also want it to split by exclamation marks', 
#  '!', 
#  ' Is that so much to ask?'] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-03T22:48:10.060

之所以发生这种情况，是因为在每个感叹号之后都有一个空格字符，`None`这里返回。

您可以使用过滤器删除这些`None`。

```
>>> import re
>>> a = "This is my text...I want it to split by periods. I also want it to split \
by exclamation marks! Is that so much to ask?"

>>> filter(lambda x:x!=None, re.split('((?<=\w)\.(?!\..))|(!)',a))

['This is my text...I want it to split by periods', '.', ' I also want it to split by exclamation marks', '!', ' Is that so much to ask?'] 
```

# android - eclipse上的android模拟器无法打开

> ID：11320232
> 
> 赞同：0
> 
> 时间：2012-07-03T22:41:58.947
> 
> 标签：android, ubuntu, emulation

我之前已经让它工作了，但现在eclipse上的android模拟器拒绝打开。没有新窗口，什么都没有。大多数情况下，当我告诉它启动时，控制台什么也没说，其他时候它会说“与 adb 的连接已关闭，并且发生了严重错误。” 但是如果我等了一会儿再试，它就会消失，然后它会说 Launching.... 并且什么也不做。

我尝试删除 avds，它说它们当前正在模拟器中运行，即使没有打开窗口也无法删除。我尝试重新安装（1.6）SDK，但没有成功。

哦，我正在使用 Ubuntu

编辑控制台终于可以工作了，在抱怨 adb 之后，我再次运行它，我得到了

“使用虚拟设备“XXX”启动新模拟器，然后什么也没有

然后我尝试使用相同的模拟器启动不同的项目并得到：

自动目标模式：首选 AVD“XXX”不可用。启动新的模拟器。使用虚拟设备“XXX”启动新模拟器

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-22T08:10:13.873

我确实遇到了同样的问题，我通过从命令行运行模拟器解决了这个问题。转到 SDK 包中的工具文件夹并从那里启动模拟器，使用您在 Eclipse 中设置的模拟器的名称（在虚拟设备管理器中）：

```
./emulator -avd [the name] 
```

GUI 应该出现（GUI 出现得相当快，但会“闲置”很多），或者您可能会在命令行上收到错误。对我来说，这是一个缺失的库，即 libGL.so。使用 apt-get 安装包含 libGL 的库并重试。

```
sudo apt-get install libgl1-mesa-dev:i386
./emulator -avd [the name] 
```

我做了一些谷歌搜索，但我不是唯一一个，当然这些库在 64 位环境中丢失了。[这是另一个有同样问题的人](http://technophilism.wordpress.com/2012/06/18/android-sdk-gpu-accelerated/)。

希望能帮助到你！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-03T23:19:02.030

运行`adb kill-server`，然后`sudo adb start-server` ，然后`adb devices`看看你是否看到了模拟器。有时模拟器正在运行，但它隐藏在某个地方。还尝试在调试模式下运行应用程序。此外，模拟器有时会非常慢。adb 是我认为位于 sdk 工具目录中的命令。将其添加到您的路径中，它将为您节省大量时间。您还可以使用命令安装和卸载您的应用程序。然后告诉我们你看到了什么。

# jquery - Jquery Mobile在同一个文件中具有多个相同的背景

> ID：11320235
> 
> 赞同：1
> 
> 时间：2012-07-03T22:42:42.500
> 
> 标签：jquery, css, jquery-mobile

我制作了一个带有多个`data-role=page`div 的 jquery 移动页面以在页面内导航。

问题是我需要保留在页面内导航时不会刷新或移动的相同背景图片。

有什么办法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-03T23:08:20.283

您可以从伪页面元素中删除默认背景，然后将自定义背景添加到`body`元素中。这可以通过 CSS 完成：

```
.ui-mobile .ui-page {
    background : transparent;
}
body {
    background : url(...);
} 
```

这是一个演示：http: [//jsfiddle.net/jasper/feZJ7/2/](http://jsfiddle.net/jasper/feZJ7/2/)

这将为所有页面应用相同的背景。您可以`.ui-mobile .ui-page`使用 CSS 定位元素以分别更改它们的背景。

# mysql - com.mysql.jdbc.PacketTooBigException

> ID：11320236
> 
> 赞同：20
> 
> 时间：2012-07-03T22:42:45.123
> 
> 标签：mysql, blob, packet

我将图像存储在 MYSQL 中。

我有桌子

```
CREATE TABLE myTable (id INT, myImage BLOB); 
```

当我尝试插入`4.7MB`文件时，出现异常

```
com.mysql.jdbc.PacketTooBigException: Packet for query is too large (4996552 > 1048576). You can change this value on the server by setting the max_allowed_packet' variable. 
```

我相信这仅与图像大小有关。还有其他我可以使用的变量类型吗？

* * *

## 更新 1

根据较早的 SO 问题，我也尝试过，`MEDIUMBLOB`但仍然遇到相同的错误。

***[在 Java 中将图像添加到数据库](https://stackoverflow.com/a/624376/1066828)***

* * *

## 更新 2

在项目开始时，我执行以下查询，现在一切正常

```
SET GLOBAL max_allowed_packet = 1024*1024*14; 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-07-03T22:44:08.133

正如错误所说，它与变量类型无关，而是与[`max_allowed_packet`](http://dev.mysql.com/doc/en/server-system-variables.html#sysvar_max_allowed_packet)变量有关：

> 如果您使用大[`BLOB`](http://dev.mysql.com/doc/en/blob.html)列或长字符串，则必须增加此值。它应该与[`BLOB`](http://dev.mysql.com/doc/en/blob.html)您要使用的最大一样大。协议限制为[`max_allowed_packet`](http://dev.mysql.com/doc/en/server-system-variables.html#sysvar_max_allowed_packet)1GB。该值应为 1024 的倍数；非倍数向下舍入到最接近的倍数。

但是，一般来说，不要将文件存储在数据库中 - 将它们存储在文件系统中并记录数据库中文件的路径。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-04-12T08:57:48.153

对于 Windows 用户：

mysql_home 指向您的 mysql/mariadb 安装文件夹。

打开 cmd，cd 到 %mysql_home%\bin 并运行`mysqladmin > temp.txt`这会吐出很多关于工具使用的信息。在所有输出中的某个地方，您会发现以下信息：

默认选项按给定顺序从以下文件中读取： C:\windows\my.ini C:\windows\my.cnf C:\my.ini C:\my.cnf c:\mariadb-5.5.29- w inx64\my.ini c:\mariadb-5.5.29-winx64\my.cnf

这表明，如果您还没有的话，您可以在 %mysql_home% 目录中拥有一个名为**或**`my.ini`my.conf 的文件。

创建 my.ini 并添加以下行：

```
[mysqld]
#allow larger BLOBs to be stored
max_allowed_packet = 10M 
```

确保包含设置**组**，`[mysqld]`否则它将无法启动（对我而言，它最终陷入困境）。

您现在需要重新启动 MySQL 守护程序，这可以通过杀死并启动当前正在运行的 mysqld 进程或重新启动 MySQL 服务来完成（运行 services.msc，找到 MySQL，按重新启动按钮；或从 cmd，`net stop MySQL`然后按`net start MySQL`） .

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-04-24T02:44:40.923

以下为我工作

编辑 my.cnf 文件（我的在 /etc/mysql 中）

然后修改max_allowed_pa​​cket值我设置为max_allowed_pa​​cket=200M

确保重新启动 MySQL 以使更改生效

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-07-31T07:45:20.527

如果使用 AWS RDS，可以使用[数据库参数组修改 max_allowed_pa​​cket](https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_WorkingWithParamGroups.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-12-23T22:07:44.400

max_allowed_pa​​cket 变量在配置文件（在我的例子中是 my.ini）中设置了默认值。如果您的应用程序尝试执行数据包大小超过此值的查询，则会引发此异常。

我的设置是在装有 MySQL Server 8.0 的 Windows 10 机器上。

我将带有我想要的 max_allowed_pa​​cket 值 (64M) 的 my.ini 文件复制到各种可能的位置（C:\my.ini、C:\Windows\my.ini）。然后重启了mysql服务器。它没有用。当我在数据库中查询 max_allowed_pa​​cket 变量时，该值保持不变。

以下步骤有效：

1.  我发现在不同的位置有一个 my.ini 文件。

2.  打开位于以下位置 C:\ProgramData\MySQL\MySQL Server 8.0 的 my.ini 文件。除了 max_allowed_pa​​cket 之外，它还有很多条目。

3.  找到 max_allowed_pa​​cket 的条目，并将其设置为所需的值（例如 64M）。

4.  保存并关闭 my.ini 文件。

5.  重启 MySQL80 服务。

6.  登录到 mysql 服务器提示符并运行查询

    ```
     show variables like 'max_allowed_packet'; 
    ```

7.  您应该看到该值设置为您想要的值。

# c++ - 对构造函数的调用不能出现在常量表达式中

> ID：11320238
> 
> 赞同：2
> 
> 时间：2012-07-03T22:42:49.813
> 
> 标签：c++

对于我的新手问题，我很抱歉，但我对 C++ 了解不多。任何人都可以回答为什么我在编译以下代码时收到错误“错误：对构造函数的调用不能出现在常量表达式中”；

```
class EliminationWeight
{
 public:
    typedef double Type;
    static const Type MAX_VALUE = __DBL_MAX__;
    static const Type MIN_VALUE = -__DBL_MAX__;
}; 
```

我使用 Ubuntu 12.04 和它附带的 gcc。这不是我的代码，我知道这段代码可能 100% 可以正常工作（可能在旧版本的 gcc 或其他编译器中）。有没有快速修复它的方法？

在此先感谢您的任何答案，这实际上是我第一次在 SO 提出问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-03T22:49:25.173

`Call to a constructor cannot appear in a constant-expression`是一条 GCC 错误消息，在这里对我来说没有任何意义。例如，Clang 接受您的代码时会发出一些警告：

```
test.cpp:31:23: warning: in-class initializer for static data member of type
      'const Type' (aka 'const double') is a GNU extension [-Wgnu]
    static const Type MAX_VALUE = __DBL_MAX__;
                      ^           ~~~~~~~~~~~ 
```

无论如何，在类主体中初始化 double 是非标准的。您应该单独进行初始化：

```
class EliminationWeight
{
 public:
    typedef double Type;
    static const Type MAX_VALUE;
    static const Type MIN_VALUE;
}; 
```

然后在一个源文件（不是头文件）中：

```
const EliminationWeight::Type EliminationWeight::MAX_VALUE = __DBL_MAX__;
const EliminationWeight::Type EliminationWeight::MIN_VALUE = -__DBL_MAX__; 
```

通常，您只能在类主体中初始化具有整数类型的静态成员变量，尽管这已在 C++ 0x11 中进行了扩展。另请参见[在 C++ 中的类声明中初始化 const 成员](https://stackoverflow.com/q/9141950/471164)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-11T06:06:52.673

我只是偶然发现了这个完全相同的问题。我们正在讨论的代码是[KIT 实现的 Contraction Hierarchies](http://algo2.iti.kit.edu/english/routeplanning.php)的一部分。

这是尝试使用 gcc 4.8 编译代码时出现的唯一编译错误。

@vitaut 建议的修复是完成这项工作所需要的。但是，请注意 main.cpp 中已经存在以下行：

```
// doesn't look nice, but required by the compiler (gcc 4)
...
const EliminationWeight::Type EliminationWeight::MAX_VALUE;
const EliminationWeight::Type EliminationWeight::MIN_VALUE; 
```

如果您决定创建一个 EliminationWeight.cpp 文件以与您的 EliminationWeight.h 一起使用并将其包含在 Makefile 中，那么这些行就是您看到与上述不同的错误的原因：

```
main.cpp:86:31: error: uninitialized const ‘EliminationWeight::MAX_VALUE’ [-fpermissive]
 const EliminationWeight::Type EliminationWeight::MAX_VALUE;
                               ^
main.cpp:87:31: error: uninitialized const ‘EliminationWeight::MIN_VALUE’ [-fpermissive]
 const EliminationWeight::Type EliminationWeight::MIN_VALUE;
                               ^ 
```

解决方案是删除 main.cpp 中的这些行或将它们用于实际初始化。我选择了后者，现在的线条如下所示：

```
const EliminationWeight::Type EliminationWeight::MAX_VALUE = std::numeric_limits< EliminationWeight::Type >::max();
const EliminationWeight::Type EliminationWeight::MIN_VALUE = -std::numeric_limits< EliminationWeight::Type >::max(); 
```

请注意，我使用了由typedef`std::numeric_limits`定义的类型的模板。`EliminationWeight::Type`这意味着我们只需要更改 typedef 以使用不同的类型。

但是，在 main.cpp 中使用这些要求我们包含`numeric_limits`模板的标头。它在不包含标题的情况下也对我有用，但这可能是因为它是通过其他一些包含文件包含的。为了干净的代码，我们无论如何都应该包含它。

```
#include <limits> 
```

另请注意，C++11 为模板提供了一个新函数`lowest`，这`numeric_limits`意味着您可以将最后一行替换为以下内容：

```
const EliminationWeight::Type EliminationWeight::MIN_VALUE = std::numeric_limits< EliminationWeight::Type >::lowest(); 
```

但是，[C++ 参考`lowest`](http://www.cplusplus.com/reference/limits/numeric_limits/)将浮点类型的返回值指定为

> 依赖于实现；通常，max() 的负数

所以我不确定你是否通过使用这个功能获得了很多。它确实为您提供了看起来更清晰的代码，但似乎返回值有些未指定。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-19T21:03:45.513

当我要在 class 中声明和实例化 class 的静态 const 对象时，我遇到了这个`Time`问题`Alg`。当我在类中声明成员变量并在外部实例化它时，它起作用了，如下所示：

```
Class Alg {

    public: 
    .
    .

    static const Time genTime;
    .
    .
}

const Alg::genTime = Time(0,0,1,0); 
```

# c# - 通过 ASP.NET C# 发送 HTTP 请求

> ID：11320240
> 
> 赞同：3
> 
> 时间：2012-07-03T22:42:55.630
> 
> 标签：c#, asp.net, http, request

我正在尝试通过 C# 发送 HTTP Get 请求。但它似乎不起作用。这是我的工作。我想从你那里得到使其工作所需的更正！

```
 String Mobile = txt_phone.Text;
            String Message = "You have registered successfuly.";
            Uri targetUri = new Uri("http://sms-om.com/smspro/sendsms.php?user=HatemSalem");
            System.Net.HttpWebRequest request = (System.Net.HttpWebRequest) System.Net.HttpWebRequest.Create(targetUri); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-03T22:49:51.390

我没有收到错误消息，而是出现“无效登录”消息，这让我认为表单实际上发出了 Post 请求。无论如何，这是一个获取请求示例：

```
using System;
using System.Net;
using System.Text;
using System.IO;

public partial class _Default : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        StringBuilder sb = new StringBuilder();

        byte[] buf = new byte[8192];

        //do get request
        HttpWebRequest request = (HttpWebRequest)
            WebRequest.Create("http://sms-om.com/smspro/sendsms.php?user=HatemSalem");

        HttpWebResponse response = (HttpWebResponse)
            request.GetResponse();

        Stream resStream = response.GetResponseStream();

        string tempString = null;
        int count = 0;
        //read the data and print it
        do
        {
            count = resStream.Read(buf, 0, buf.Length);
            if (count != 0)
            {
                tempString = Encoding.ASCII.GetString(buf, 0, count);

                sb.Append(tempString);
            }
        }
        while (count > 0);
        Response.Write(sb.ToString());
    }
} 
```

祝你好运！

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-03T22:51:49.807

您当前尚未执行请求，请使用：

```
var response = request.GetResponse() as HttpWebResponse; 
```

这是它将实际从网络获取数据并为您提供任何相关错误的地方

# ios - Ios - 尝试向文本视图添加侦听器时出现语法错误

> ID：11320242
> 
> 赞同：0
> 
> 时间：2012-07-03T22:43:10.127
> 
> 标签：ios, ios5

我有一个 textView，其提交按钮被键盘重叠，所以我试图添加一个侦听器，用于当用户点击屏幕上的其他任何地方以摆脱键盘时。

我正在尝试将这样的代码添加到我的控制器中：

```
-(void)touchesBegan:(NSSet *) touches withEvent:(UIEvent *)event
{
    [textView resignFirstResponder];
} 
```

但这给出了未声明 textView 的语法错误。但这很令人困惑，因为我已经将 textView 添加到了屏幕上。

这是代码：

```
#import "FeedbackController.h"

@interface FeedbackController ()

@end

@implementation FeedbackController

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        // Custom initialization
    }
    return self;
}

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view.
}

- (void)viewDidUnload
{
    [super viewDidUnload];
    // Release any retained subviews of the main view.
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return (interfaceOrientation == UIInterfaceOrientationPortrait);
}

-(void)touchesBegan:(NSSet *) touches withEvent:(UIEvent *)event
{
    [textView resignFirstResponder];
}

- (IBAction)submitFeedback:(id)sender {
    NSLog(@"This is a test hello");
}
@end 
```

这是屏幕的样子： ![在此处输入图像描述](../Images/e94b9cd15990682588541cb0df23d2d4.png)

知道如何尝试正确引用 textView 吗？以及如何在触摸屏幕的其他部分时使键盘消失？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-03T22:52:54.210

在您的 .h 文件中，您需要创建一个`IBOutlet`变量`textView`，这是您[在情节提要中创建插座访问视图的方法](https://stackoverflow.com/questions/11276738/access-view-inside-a-storyboard)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-03T22:46:32.740

你需要为你的 textView 创建一个属性，它是一个 IBOutlet。然后你可以在接口生成器中连接它并调用：

```
[self.textView resignFirstRespnder] 
```

当您希望键盘隐藏时。

# php - Codeigniter 通过单击按钮更改表单操作

> ID：11320250
> 
> 赞同：1
> 
> 时间：2012-07-03T22:44:21.533
> 
> 标签：php, javascript, html, forms, codeigniter

我的表单中有 2 个提交按钮，我试图让每个按钮都使用不同的控制器方法。我尽量不避免使用多种形式。

我目前正在使用

```
<button type="submit" onclick="javascript: form.action='restore'">Restore</button>
<button type="submit" onclick="javascript: form.action='delete'">Delete</button> 
```

...这行得通，但我不确定这是否是最好的方法。有什么想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-04T00:31:28.883

通常我想通过给按钮/输入标签一个名称 attr 来处理多个提交。通过这种方式，您可以在同一个控制器中提交和调用一个功能/动作，只需检查提交了哪个按钮。例如：

```
<form id="your_form" action="your_controller/process" method="post">
<input type="submit" name="restore" id="restore" value="Restore" />
<input type="submit" name="delete"  id="delete" value="Delete" />
</form> 
```

然后在您的控制器中，将有一个名为“进程”的函数执行此操作：

```
function process(){
  if(isset($_POST["restore"])) {
    //do your restore code
  }

  if(isset($_POST["delete"])){
    //do your delete code
  }   
} 
```

希望这会有所帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-04T00:09:52.913

最好的办法是使用 javascript，毕竟它是在页面呈现后完成的。这是一个替代解决方案（对不起，它是 jQuery，我不太擅长 vanilla JS）。

看法：

```
<div id="submit-buttons" action="<?php echo site_url('controller/postmethod1'); ?>​"​​​​​&gt;Submit 1</div>

<div id="submit-buttons" action="<?php echo site_url('controller/postmethod2'); ?>">Submit 2</div>​ 
```

JS：

```
​$(function(){
    $('.submit-buttons').click(function(){
        $('form').attr('action',$(this).attr('action')).submit();
        return false;
    });

});​ 
```

所以当按钮被点击后，它会从提交按钮的action属性中更新表单动作参数，然后立即提交表单。

Ps：我没有测试它，但它应该可以工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-03T22:53:31.357

那这个呢？

```
<?php echo form_open('controller/method',array('id'=>'my_form')); ?>
<!--Form-->
<input type="submit" value="Submit" />
<?php echo form_close();?> 
```

希望能帮助到你

# html - 和相邻之间不需要的空格

> ID：11320251
> 
> 赞同：2
> 
> 时间：2012-07-03T22:44:23.117
> 
> 标签：html, css

我的 HTML 有点奇怪。我以前从来没有遇到过这个问题。

测试页面：http: [//jsfiddle.net/egjJ5/1/](http://jsfiddle.net/egjJ5/1/)

我看到图像和黑色 div 之间的空白。当我取出 DTD 时，它渲染得很好。

我的 html 或 css 有问题吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-03T22:49:10.343

图像是一个`inline-block`，它下面的 div 是一个`block`. 有几种方法可以解决此问题。[一种是像本例](http://jsfiddle.net/egjJ5/12/)那样添加`display: block`到图像中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-03T23:05:18.510

只需使您的 img 元素成为块元素：

```
display: block; 
```

# javascript - 地理编码在第二次调用时返回 (NaN, Nan)

> ID：11320253
> 
> 赞同：0
> 
> 时间：2012-07-03T22:45:12.007
> 
> 标签：javascript, html, google-app-engine, google-maps-api-3

我的 javascript 函数 getLatLng 在由 window.onload 调用时效果很好。但是当我使用处理程序调用它时，我从地理编码器中获得了一个位置（NaN，NaN）。

为什么当我单击提交按钮时它不起作用但在 window.onload 中运行良好？

```
<script type="text/javascript"
  src="http://maps.googleapis.com/maps/api/js?key=MYSECRETKEYHERE&sensor=false">
</script>    

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>

<form id="update_info" method="post" action="{{upload_url}}" enctyp="multipart/form-data">
<input name="address" id="address" type="text" value="100 W Main St Lehi, UT"/>
<input name="latlng" id = "latlng" type="text" value=""/>
<input name="update_reseller_button" id="update_reseller_button" type="submit">
</form>

<script>

function getLatLng()
{
    var geocoder = new google.maps.Geocoder();

    var theaddress = document.getElementById('address').value;
    var position = new google.maps.LatLng();

    geocoder.geocode({'address': theaddress}, function(results, status
      )
    {                       
        position = results[0].geometry.location;                  
        document.getElementById('latlng').value = position.toString();
    });
    return position;
}

$('#update_info').submit(function()

  {
    alert('The Position is: ' +  getLatLng().toString());
    return true;
  });

  window.onload = getLatLng();

</script> 
```

编辑：修复了处理程序中指向错误表单的错字

编辑 2：修正了更多的错别字

编辑 3：更改，因此警报显示位置的值

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T01:29:13.117

您的 getLatLng 函数永远不会按预期工作，它永远不会返回地理编码的结果，因为地理编码是一个异步请求。

这：

```
window.onload = getLatLng(); 
```

...将调用函数（不是 onload，立即），函数将执行指令，但也会返回 (NaN, NaN)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-03T22:58:16.230

你可以试试这个

```
if (status == google.maps.GeocoderStatus.OK) {
    document.getElementById('latlng').value=results[0].geometry.location.lat()+", "+results[0].geometry.location.lng();
} 
```

# java - 在Java中将任何文件转换为PNG

> ID：11320255
> 
> 赞同：1
> 
> 时间：2012-07-03T22:45:32.000
> 
> 标签：java, rgba

我想将任何文件转换为 PNG 并反转该过程，所有这些都在 Java 中。

我想对图像使用 int-RGB 形式，并将文件中的字节作为 RGB 整数中的字节。这应该会产生一个图像。

我已经通过仅以红色存储字节来实现这一点，但我无法弄清楚如何同时使用绿色和蓝色。

这是我目前使用的代码，它只使用红色，它工作正常：

```
public static void fileToImage(String sourceFile, String imageFile) throws IOException {
    DataInputStream dis = new DataInputStream(new FileInputStream(sourceFile));
    int size = ((int) Math.sqrt(dis.available())) + 2;
    BufferedImage image = new BufferedImage(size,size, BufferedImage.TYPE_INT_RGB);
    for (int y = 0; y < size; y++) {
        for (int x = 0; x < size; x++) {
            int red = dis.read(); // I'm using only red
            int green = 0; // default
            int blue = 0; // default
            int rgb = (0xFF << 24) | ((red & 0xFF) << 16) | ((green & 0xFF) << 8) | (blue & 0xFF);
            image.setRGB(x, y, rgb);
        }
    }
    dis.close();
    ImageIO.write(image, "png", new File(imageFile));
}

public static void imageToFile(String imageFile, String outputFile) throws IOException {
    BufferedImage image = ImageIO.read(new File(imageFile));
    DataOutputStream dos = new DataOutputStream(new FileOutputStream(outputFile));
    for (int y = 0; y < image.getHeight(); y++) {
        for (int x = 0; x < image.getWidth(); x++) {
            int rgb = image.getRGB(x, y);
            int red = (rgb >> 16) & 0xFF;
            int green = (rgb >> 8) & 0xFF;
            int blue = rgb & 0xFF;
            dos.write(red); // I'm using only red
        }
    }
    dos.close();
} 
```

编辑：好的，所以我修改了代码，这里是：

```
public static void fileToImage(String sourceFile, String imageFile) throws IOException {
    DataInputStream dis = new DataInputStream(new FileInputStream(sourceFile));
    int size = ((int) Math.sqrt(dis.available())) + 2;
    BufferedImage image = new BufferedImage(size,size, BufferedImage.TYPE_INT_RGB);
    for (int y = 0; y < size; y++) {
        for (int x = 0; x < size; x++) {
            int red = dis.read();
            int green = dis.read();
            int blue = dis.read();
            int rgb = (0xFF << 24) | ((red & 0xFF) << 16) | ((green & 0xFF) << 8) | (blue & 0xFF);
            image.setRGB(x, y, rgb);
        }
    }
    dis.close();
    ImageIO.write(image, "png", new File(imageFile));
}

public static void imageToFile(String imageFile, String outputFile) throws IOException {
    BufferedImage image = ImageIO.read(new File(imageFile));
    DataOutputStream dos = new DataOutputStream(new FileOutputStream(outputFile));
    for (int y = 0; y < image.getHeight(); y++) {
        for (int x = 0; x < image.getWidth(); x++) {
            int rgb = image.getRGB(x, y);
            int red = (rgb >> 16) & 0xFF;
            int green = (rgb >> 8) & 0xFF;
            int blue = rgb & 0xFF;
            dos.write(red);
            dos.write(green);
            dos.write(blue);
        }
    }
    dos.close();
} 
```

这确实“有效”，但并不完全符合预期。生成的 PNG 中有很多黑色空间，因为我认为图像的“大小”是错误的。因此，在将 PNG 转换回原始文件时，它会变得比原来大得多。

编辑：我现在遇到的问题是：例如，如果我使用 fileToImage 方法将具有以下内容的文本文件转换为 PNG：hello world！然后我用imageToFile把它转回来，输出是：hello world!SSSSSSSSSSSSSSS（S代表“空格”，有15个）

编辑：仍然无法弄清楚这一点。这是我正在使用的：

```
private static final int NAN = -1;

private static int readByte(DataInputStream dis) throws IOException {
    int b;
    try {
        b = dis.readByte();
    } catch (EOFException e) {
        b = NAN;
    }
    return b;
}

public static void fileToImage(String sourceFile, String imageFile) throws IOException {
    DataInputStream dis = new DataInputStream(new FileInputStream(sourceFile));
    int size = ((int) Math.sqrt(dis.available())) + 2;
    BufferedImage image = new BufferedImage(size, size, BufferedImage.TYPE_INT_RGB);
    for (int y = 0; y < size; y++) {
        boolean finished = false;
        for (int x = 0; x < size; x++) {
            int alpha = 3;
            int red = readByte(dis);
            int green = readByte(dis);
            int blue = readByte(dis);
            if (red == NAN) {
                alpha--;
                red = 0;
            }
            if (green == NAN) {
                alpha--;
                green = 0;
            }
            if (blue == NAN) {
                alpha--;
                blue = 0;
            }
            int rgb = ((alpha & 0xFF) << 24) | ((red & 0xFF) << 16) | ((green & 0xFF) << 8) | (blue & 0xFF);
            image.setRGB(x, y, rgb);
            if (alpha < 3) {
                finished = true;
                break;
            }
        }
        if (finished) break;
    }
    dis.close();
    ImageIO.write(image, "png", new File(imageFile));
}

public static void imageToFile(String imageFile, String outputFile) throws IOException {
    BufferedImage image = ImageIO.read(new File(imageFile));
    DataOutputStream dos = new DataOutputStream(new FileOutputStream(outputFile));
    for (int y = 0; y < image.getHeight(); y++) {
        boolean finished = false;
        for (int x = 0; x < image.getWidth(); x++) {
            int rgb = image.getRGB(x, y);
            int alpha = (rgb >> 24) & 0xFF;
            int red = (rgb >> 16) & 0xFF;
            int green = (rgb >> 8) & 0xFF;
            int blue = rgb & 0xFF;
            if (alpha == 0) {
                finished = true;
                break;
            }
            if (alpha >= 1) dos.write(red);
            if (alpha >= 2) dos.write(green);
            if (alpha == 3) dos.write(blue);
        }
        if (finished) break;
    }
    dos.close();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-03T23:17:08.853

我认为您只需要稍微调整内部循环即可。一个小的辅助方法将使这个东西更容易使用，我认为我的草图有点难看：

```
int myReadByte(DataInputStream dis) {
    int b;
    try {
        b = dis.readByte():
    } catch (EOFException e) {
        b = 0;
    }
    return b;
} 
```

现在有了这个帮手...

```
for (int x = 0; x < size; x++) {
        int red = myReadByte(dis);
        int green = myReadByte(dis);
        int blue = myReadByte(dis);
        int rgb = (0xFF << 24) | ((red & 0xFF) << 16) | ((green & 0xFF) << 8) | (blue & 0xFF);
        image.setRGB(x, y, rgb); 
```

和

```
for (int x = 0; x < image.getWidth(); x++) {
        int rgb = image.getRGB(x, y);
        int red = (rgb >> 16) & 0xFF;
        int green = (rgb >> 8) & 0xFF;
        int blue = rgb & 0xFF;
        dos.write(red);
        dos.write(green);
        dos.write(blue);
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-01-07T10:02:23.787

您的代码似乎将连续的 3 个字节转换为一个像素。因此，您仅获得 1/3 的带有颜色的文件，其余 2/3 为空。

要解决这个问题，只需将文件大小除以 3。

```
int size = ((int) Math.sqrt(dis.available()/3)) + 2; 
```

# themes - 带有网格苹果主题的jstree永远无法与字体对齐

> ID：11320263
> 
> 赞同：0
> 
> 时间：2012-07-03T22:46:55.350
> 
> 标签：themes, alignment, jstree

如何使带有网格的jstree中的文本与苹果主题中的背景线对齐？在我的情况下，它似乎永远不会正确。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T20:40:29.800

jstree 网格对于我的实现来说不够强大。我最终使用 jqGrid。

# objective-c - 目标 c：如何将 .txt 文件中的字符串添加到 NSArray？

> ID：11320266
> 
> 赞同：1
> 
> 时间：2012-07-03T22:47:15.410
> 
> 标签：objective-c

我的项目中有 weekdays.txt 文件。在这个文件中，一周中有几天有空格。而且我的代码不起作用。

```
NSString* path = [[NSBundle mainBundle] pathForResource:@"weekdays" ofType:@"txt"];
weekdaysDataSource = [[NSArray alloc] initWithContentsOfFile:path]; 
```

问题可能出在哪里？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-04T00:46:09.170

你的文件是什么格式的？

say的文档应该是`-initWithContentsOfFile`“`path`包含由 writeToFile:atomically: 方法生成的数组的字符串表示的文件的路径。” 那将是一个财产清单。

如果您的文件不是属性列表，您可以将文件读入 NSString ( `+[NSString stringWithContentsOfFile:encoding:error:]`)，然后将其拆分为单词 ( `-[NSArray componentsSeparatedByString:]`)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T03:02:54.807

您还可以执行以下操作：

```
// create an NSURL object that holds the path of the file you want to read

NSURL *fileURL = [NSURL fileURLWithPath:@"/Users/yourname/weekdays.txt"];  

//Create an NSMutaable string object and use the stringWithContentsOfURL: encoding: error: method to hold whatever might be you have in the text file. 
//Just pass the NSURL object you created in the previous step to as an argument like so

NSMutableString *text = [NSMutableString stringWithContentsOfURL:fileURL encoding:NSUTF8StringEncoding error:nil];

NSLog(@"The content of the file is: %@", text); 
```

就是这样。NSLog 实际上会输出您在文件中键入的任何内容，以证明这是有效的。

# javascript - 使用 jQuery/Javascript 过滤字符串

> ID：11320269
> 
> 赞同：2
> 
> 时间：2012-07-03T22:47:42.903
> 
> 标签：javascript, jquery

我试图使用 $.get 加载页面而不重新加载页面。

```
<script>
$('#top_links a').click(function (e) {
    e.preventDefault();
    var link = $(this).attr('href');
    $('#content').empty();

    $.get(link, { }, 
        function(data) {
            $('#content').empty().append(data);
        }
    )
});
</script> 
```

这可行，但整个请求的页面都被塞进`#content`. 我不想在服务器端检测 ajax 请求并过滤数据，而是在客户端进行。有没有办法使用 javascript 来有效地过滤字符串，以便我只得到某些 div？我要保留的内容将全部包含在一个名为的 div 中`#content`（我只是试图将当前页面`#content`与请求的页面交换`#content`）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-03T22:50:49.610

尝试[`load`](http://api.jquery.com/load/)加载页面片段的方法：

```
$("#content").load(link + " #content > *");​​​​​​​​​​​ 
```

在这里，我们可以使用`> *`以便`#content`仅包含块的内部 HTML，而不用包围它（[在此处](https://stackoverflow.com/questions/11233142/jquery-load-page-fragment-loading-double-div-ids/)`<div id="content"></div>`查看有关它的更多信息）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-03T22:52:04.457

您可以像处理`get`页面上的元素一样操作返回的数据。

例如：

```
$('#content').replaceWith($(data).find("#content")); 
```

# c++ - 为什么 cin 和 cout 使用 << 和 >>

> ID：11320270
> 
> 赞同：0
> 
> 时间：2012-07-03T22:47:53.663
> 
> 标签：c++

> **可能重复：**
> [为什么 cout 和 cin 使用按位移位（<< 和 >>）？](https://stackoverflow.com/questions/4854248/why-are-bitwise-shifts-and-used-for-cout-and-cin)

我知道 cout 和 cin 重载了按位运算符 << 和 >>。但是，大多数时候函数和工具使用参数或参数来传递信息。

在 C++ 的宏大历史中是否存在导致这种情况的原因？

我知道这是一个基本的东西，但我对 C++ 还很陌生，搜索 SO 和 Google，以及询问一些人，都没有找到一个好的答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-03T22:52:03.117

(a) 运算符优先级

和

(b) 看起来不错 - 运算符的形式暗示了它们的功能

# javascript - 使用 inline-block 设置的 Safari/Chrome 重叠元素

> ID：11320272
> 
> 赞同：2
> 
> 时间：2012-07-03T22:48:01.613
> 
> 标签：javascript, html, css

我正在尝试构建一个页面以并排显示两个图像。我希望这些项目以书本格式在屏幕上居中，并且随着浏览器大小的调整，图像高度会发生变化，因此它们会填满窗口。

为了做到这一点，我使用带有文本对齐中心的显示内联块来实现效果。它在 FF 上运行良好，但是当我在 Safari 或 Chrome 中打开调整大小时，div 开始重叠。我创建了这个 jsfiddle 来展示我的 dom 示例。我需要 pageOne 和 pageTwo div 内联块，因为后来我绝对将链接放在页面图像的顶部。

我错过了什么？

为了看到这个问题，您需要在 safari/chrome 中打开 jsFiddle 并使结果窗格大于默认值。从浏览器开始，大约为正常宽度/高度的 1/2。运行 jsFiddle 时，放大浏览器并注意两个图像是如何开始重叠的。如果你在 FF 中打开它，它们不会重叠。

[http://jsfiddle.net/X9NNh/1](http://jsfiddle.net/X9NNh/1)

使用表格，我能够在所有浏览器中接近我想要的效果：

[http://jsfiddle.net/x82uK/](http://jsfiddle.net/x82uK/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T01:02:38.590

实际上，这很棘手，因为这些内联块容器不会随着内容的缩放而调整自己的大小以适应其内容。

虽然当涉及到绝对定位图像顶部的链接时，它会使您的工作更加困难（阅读：需要 Javascript），但[这里有一种](http://jsfiddle.net/4nYkV/1/)使用`background-size: contain`.

HTML：

```
<div id="issue">
  <div id="leftPage" class="page" style="background-image: url(http://placekitten.com/g/304/400);"></div>
  <div id="rightPage" class="page" style="background-image: url(http://placekitten.com/g/304/400);"></div>
</div> 
```

CSS：

```
html, body {
  height: 100%;
  background: #666;
}
#issue {
  position: absolute;
  top: 20px; bottom: 20px;
  left: 20px; right: 20px;
  border: 1px solid grey;
  box-sizing: border-box;
  background: #EEE;
}
.page {
  position: absolute;
  top: 30px; bottom: 30px;
  background-repeat: no-repeat;
  background-size: contain;
}
#leftPage {
  background-position: center right;
  left: 30px; right: 50%;
}
#rightPage {
  background-position: center left;
  left: 50%; right: 30px;
} 
```

# opengl-es - OpenGL，是否值得在绘图调用后显式解除绑定？

> ID：11320277
> 
> 赞同：16
> 
> 时间：2012-07-03T22:48:32.993
> 
> 标签：opengl-es, opengl-es-2.0, vbo

在给定的绘图调用结束时使用`glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, 0)`和/或解除绑定对我来说似乎更干净。`glBindBuffer(GL_ARRAY_BUFFER, 0)`我喜欢确信没有什么是不应该的；但是，这对性能有很大影响吗？

有人会认为这样做是“干净”的方式有用吗？还是我应该走快速而草率的路线？

（是的，我知道绑定的缓冲区对象将被下一个要绑定在该目标上的缓冲区对象替换，无论如何——无论是在这次还是下一次渲染更新中。是的，我可以进行性能测试。但是快速的人类反应会很好。）

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-03T23:25:10.233

我会在编码时取消绑定以保持清洁，然后在发布时对其进行优化。

好处是你可以重新组织你的代码而不用担心状态变化，但最终仍然有优化的状态变化。而且您只会在实际优化上花费一小部分时间。

就性能影响而言，如果您有数千个额外的 unbind 调用，将会有一些开销，但它不太可能成为您的瓶颈。

# mysql - mysql多个左连接和分组的问题

> ID：11320278
> 
> 赞同：0
> 
> 时间：2012-07-03T22:48:36.613
> 
> 标签：mysql

好吧，我有 3 张桌子：

**待定1：**

```
tb1_id PK
tb1_name 
```

**待定2：**

```
tb2_id PK
tb1_id FK 
```

**待定3：**

```
tb3_id PK
tb2_id FK 
```

我得到了这个查询：

```
select a.tb1_nome
      ,b.tb2_id
      ,count(c.tb2_id) as lins 
 from tb1 a 
      left join tb2 b on a.tb1_id=b.tb1_id 
      left join tb3 c on b.tb2_id=c.tb2_id 
 group by b.tb2_id order by a.tb1_id desc 
```

但它不会返回 tb1 的所有行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-03T23:49:29.020

> 我有 3 个表，我需要**获取与 tb1 匹配的所有 tb2 行，**并显示**与 tb2 匹配的所有 tb3 行的计数**

我认为你只需要使用`INNER JOIN`而不是`LEFT JOIN`. `INNER JOIN`选择在连接的表上有记录的行。试一试，稍后再反馈:)

```
SELECT  a.tb1_name,
        b.tb2_id,
        COUNT(c.tb2_id) TotalCount
FROM    tb1 a 
          INNER JOIN tb2 b
             on a.tb1_id = b.tb1_id
          INNER JOIN tb3 c
             on b.tb2_id = c.tb2_id
GROUP BY a.tb1_name, b.tb2_id
ORDER BY a.tb2_id DESC 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-03T22:56:19.663

当你这样做

```
left join tb2 b on a.tb1_id=b.tb1_id 
```

也许你有一个错字，因为 b 只有 tb2_id...没有 tb1_id

此外，如果您需要获取所有 tb1 行，即使 tb2 上没有匹配结果，请考虑使用外连接。

# asp.net - 如何将参数从javascript传递到代码后面？

> ID：11320290
> 
> 赞同：0
> 
> 时间：2012-07-03T22:50:55.147
> 
> 标签：asp.net, parameters, pagemethods

我尝试将参数从 jscript 传递到代码后面，但它不起作用。我的代码：

[C＃]

```
[WebMethod]
public static String sendEmail(String str)
{
     ...
     msg.body = str;
     ...
     return str;
} 
```

[脚本]

如果我使用功能警报，它返回 null

```
function onOkClickButton()
{
    var content = "Hello";
    alert("<%=sendEmail(" + content + ")%>");
} 
```

如果我使用 PageMethod，我的电子邮件正文为空

```
<asp:ScriptManager enablePageMethods="true"></asp:ScriptManager> 
function onOkClickButton()
{
    var content = "Hello";
    PageMethods.sendEmail(content, onSuccess, onError);
}
function onSuccess(text)
{
    alert(text)
}

function onError(text)
{
    alert(text)
} 
```

你能帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-03T23:52:20.747

jQuery ajax 将是最简单的方法，IMO：

```
function onOkClickButton()
{
    var content = "Hello";

    $.ajax({
      type: "POST",
      url: "urlToPageHostingSendEmail.aspx/sendEmail",
      data: { str: content }
    }).success(function( msg ) {
      alert( msg );
    });
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-03T23:16:36.633

您可以使用 jquery 来调用您的页面方法：

[从 jquery 调用没有脚本管理器的页面方法](https://stackoverflow.com/questions/5325721/call-page-method-without-script-manager-from-jquery)

或者

[http://encosia.com/using-jquery-to-directly-call-aspnet-ajax-page-methods/](http://encosia.com/using-jquery-to-directly-call-aspnet-ajax-page-methods/)

也看看这个视频：

[http://www.highoncoding.com/Articles/430_Calling_Page_Methods_Using_JQuery_and_Returning_JSON_Result.aspx](http://www.highoncoding.com/Articles/430_Calling_Page_Methods_Using_JQuery_and_Returning_JSON_Result.aspx)

# c# - 单击按钮时从资源中随机播放图片

> ID：11320293
> 
> 赞同：3
> 
> 时间：2012-07-03T22:51:40.150
> 
> 标签：c#, image, random, picturebox, shuffle

我有 1 个图片框，名为`studPic`. 我想要得到的是，当我单击“随机播放”按钮时，从资源中获取随机图像。

```
private void button2_Click(object sender, EventArgs e)
        {
...     
        } 
```

经过研究，我发现以下

[http://social.msdn.microsoft.com/Forums/en-US/Vsexpressvcs/thread/38d36fa4-1f5f-43e9-80f6-3c9a4edc7705/](http://social.msdn.microsoft.com/Forums/en-US/Vsexpressvcs/thread/38d36fa4-1f5f-43e9-80f6-3c9a4edc7705/)

我是 C# 的新手。有没有更简单的方法来实现这个结果？例如，不添加图片名称？

# 更新

```
List<string> pictureNames = new List<string>();
pictureNames.Add("1");
pictureNames.Add("2");
pictureNames.Add("3");
int randomPictureIndex = new Random().Next(0, pictureNames.Count);
string randomPictureName = pictureNames[randomPictureIndex];
pictureNames.Remove(randomPictureName);
Image img = Properties.Resources.randomPictureName; //erroor
studPic.Image = img; 
```

收到错误消息错误 1“Properties.Resources”不包含“randomPictureName”的定义

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-03T23:24:27.807

我不会为此使用系统资源。它们不像断开软件的文件系统那样可维护。

将图像放在应用程序的文件夹中。通过这种方式，它们可以轻松更新/更改。说 ：

```
C:\Ninjas - app
c:\Ninjas\images - images 
```

创建一个包含这些图像的数组。

```
string[] files = System.IO.Directory.GetFiles("c:\ninjas\images"); 
```

您需要在 GetFiles 上放置一些过滤器，以确保您只获取图片。

现在在该数组中获取一个随机位置（您已经展示了如何处理随机数）。

我们有数组，让我们洗牌，然后你可以按顺序浏览它们（比随机选择要快得多。CPU 会喜欢你的）

```
 private string[] files;
    private int currentIndex = 0;

    private void initializeImages()
    {
        //Grab directories in your images directory
        string appRoot = System.IO.Path.GetDirectoryName(Application.ExecutablePath);
        files = System.IO.Directory.GetFiles(appRoot + @"\images");
        Random rnd = new Random();
        files = files.OrderBy(x => rnd.Next()).ToArray();
    }

    private void setImage()
    {
        pictureBox1.ImageLocation = files[currentIndex];
    }

    private void previousImage()
    {
        currentIndex = currentIndex > 0 ? currentIndex - 1 : 0;
        setImage();
    }

    private void nextImage()
    {
        currentIndex = currentIndex < files.Length - 1 ? currentIndex + 1 : files.Length - 1;
        setImage();
    } 
```

几件事：

*   不要硬编码文件路径。在你的 app.config 文件中有这个，并引用它。
*   您可以将文件数组放在全局范围内，这样就不需要每次都运行它。

如果您想将此作为幻灯片放映，直到用户取消它，我建议您执行以下操作：

*   使用计时器对象调用方法来增加图像计数，从而更改图片。
*   不要在你的 GUI 上使用 thread.sleep，因为它会暂停你的 GUI - 这不是一件好事。

如果你想添加下一个/上一个按钮，你需要有一个可以增加/减少的全局索引（比如 currentIndex），然后调用代码来设置图像

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-03T23:34:05.810

您参与了一些设置，但反对者大多是正确的。对于生产应用程序，这不是一个非常有效的解决方案。话虽如此，我怀疑这是你分发给很多人的东西，所以我们称之为学术练习。如果您只是简单地将资源添加到您的应用程序并将其命名为“ImageResource”（任何名称都可以），然后将您的图像添加到其中，那么您可以使用以下代码（假设存在相应的 UI 元素）。

首先，我们创建一个函数来从您的资源中提取位图。

```
private Bitmap[] GetResourceImages()
{
    PropertyInfo[] props = typeof(ImageResource).GetProperties(BindingFlags.NonPublic | BindingFlags.Static);
    var images = props.Where(prop => prop.PropertyType == typeof(Bitmap)).Select(prop => prop.GetValue(null, null) as Bitmap).ToArray();

    return images;
} 
```

其次，我们创建一个函数，该函数将根据可用图像随机化图像：

```
private void RandomizePicture()
{
    Bitmap[] images = GetResourceImages();
    if (images == null || images.Length == 0)
    {
        //Nothing to do here...
        return;
    }

    int maxValue = images.Length;
    Random r = new Random();
    int idx = r.Next(maxValue);
    this.uxStupidPic.Image = images[idx];
} 
```

最后，在单击按钮时调用该函数：

```
private void btnRandmoize_Click(object sender, EventArgs e)
{
    this.RandomizePicture();
} 
```

瞧，来自资源文件的随机图像。快乐编码！

编辑：刚刚注意到您说您使用的是应用程序资源而不是随机资源文件。只需在 GetResourceImages 中将“ImageResource”替换为“Properties.Resources”，您就可以开展业务了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-04T00:07:36.610

我喜欢 Ryan Ternier 的回答非常简单和优雅，我打算发布一个类似于他的解决方案。

我只是想评论一下线路不起作用/不应该起作用的原因：

图片 img = Properties.Resources.randomPictureName;

1.  是因为 Properties Resources 正在寻找一个名为“randomPictureName”的资源，而不是实际名称本身。
2.  Properties.Resources 对象的工作方式是在代码编译后在运行时查找解决方案属性中的所有资源。它不会按照您想要的方式工作，因为您试图传递一个甚至可能不存在于资源中的静态变量，从而迫使您将方法包装在 try/catch 语句中以防万一。

[http://msdn.microsoft.com/en-us/library/7k989cfy(v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/7k989cfy(v=vs.80).aspx)

# .net - KeyBinding 两个命令（一个在 VM 中，一个在 View 中）到一个键

> ID：11320298
> 
> 赞同：1
> 
> 时间：2012-07-03T22:52:01.460
> 
> 标签：.net, wpf, xaml, binding, mvvm

我有一个如下所示的文本框：

```
<TextBox Text="{Binding Stuff, UpdateSourceTrigger=PropertyChanged}">
    <TextBox.InputBindings>
        <KeyBinding Key="Enter" Command="{Binding Path=LoadStuffCommand}" />
        <KeyBinding Key="Enter" Command="SelectAll"  />
    </TextBox.InputBindings>
</TextBox> 
```

当它运行时，只运行 SelectAll 命令。但是，如果我取出 SelectAll 行，则 LoadStuffCommand 运行良好。

显然，它正在用下​​一个命令替换命令（最后一个获胜）。但是我需要一种方法来运行我的命令并选择 TextBox 中的所有文本。

通常，我只会发出另一个命令来触发我的两个命令。但其中之一在我的 ViewModel 中，一个在我的视图中。我怎样才能发出一个同时触发两者的命令？（有没有办法在 XAML 中创建命令？）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-03T23:17:55.837

这可以通过[aggregator](http://www.codeproject.com/Articles/25808/Aggregating-WPF-Commands-with-CommandGroup)来完成。基本上，将命令分组到一个按顺序调用它们的对象中，并像一个命令一样绑定到该对象。

# javascript - 倒计时 Unix 时间

> ID：11320302
> 
> 赞同：0
> 
> 时间：2012-07-03T22:52:08.253
> 
> 标签：javascript, html

我试试这个：

```
<span id="countdown"></span>
<script type="text/javascript">
    function updateClock() {
        var ts = Math.round(((new Date().getTime() / 1000) - <?php echo $userInfo['drive_in_town_time']; ?>) * -1);

        document.getElementById("countdown").innerHTML = ts;
    }    
</script> 
```

但是在跨度倒计时中什么也没有出现？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-03T23:02:52.627

您的 PHP 代码运行不正常，或者您实际上并未调用该函数。我猜你没有调用这个函数；您只在代码中显示了一个函数声明。

检查[这个 jsfiddle](http://jsfiddle.net/Qd6AP/)。

我所做的就是用你的 PHP 代码的值替换`1`并添加对函数的调用。

# php - 与用户 2 不是朋友时向用户 1 隐藏内容

> ID：11320308
> 
> 赞同：0
> 
> 时间：2012-07-03T22:53:00.000
> 
> 标签：php, stream, pseudocode, privacy, if-statement

我有一个正在使用两个用户流构建的网站。我有朋友的代码，它只是使用伪代码的一个例子，如果陈述在正确的地方..只是它让我绞尽脑汁。

我需要的是，当我 user1_id 访问你 user2_ids 流时，如果我们不是朋友，它会隐藏表单和流，并告诉我在查看之前添加你。显示您已添加此朋友但朋友尚未接受...如果我们是朋友，请显示表格和流。

这是所有代码

这是为了确定我的用户及其工作..

```
<?

$user1_id=$_SESSION['id'];
if($_SESSION['id']==$user1_id){
        define('user_isself','2');
    }else{
        define('user_isself','1');
    }

    $friends = rawfeeds_user_core::check_active_friends($id,$_SESSION['id']);

    define('USER_BEFRIENDED',$friends);

    ?> 
```

这是我的两个提要的代码，第一个表单的第一个提要是 user1_ids 提要，第二个是 user2_id 的提要。

```
<?php if($user2_id==$_SESSION['id']){ ?>
    <div id="statusholder">
    <div class="divider">
        <h2>Post a status</h2>  
        <form action="insert.php" method="POST" target="ifr1" class="form_statusinput">
        <input type="hidden" name="toid" value="<?php echo $user1_id ?>">
        <input type="text" name="newmsg" id="newmsg" class="homescreen_status_input" placeholder="Say something" autocomplete="off">
        <iframe name="ifr1" id="ifr1" style="display:none;"></iframe>
        <input type="submit" target="ifr1" value="Share" >
    </form>
    </div></div>

    <?php 

    //FRIENDSHIPS
            $following_string       =   $_SESSION['id'];
            $sql_follows="SELECT * FROM friends WHERE user1_id=".$_SESSION['id']." AND status=2 OR user2_id=".$_SESSION['id']." AND status=2";
            $query_follows=mysql_query($sql_follows) or die("Error finding friendships");
            if($query_follows>0){
            $friendlist="(".$_SESSION['id'].",";
            $t=0;
            while ($follow=mysql_fetch_array($query_follows))
            {
                if($follow['user1_id']==$_SESSION['id']){
                    if($t>0){
                    $friendlist=$friendlist.",";
                    }
                    $friendlist =   $friendlist. $follow['user2_id'];
                }else{

                    if($t>0){
                        $friendlist=$friendlist.",";
                    }
                    $friendlist =   $friendlist. $follow['user1_id'];

                }
                $t=$t+1;
            }
            $friendlist=$friendlist.")";
            }
        //STREAMDATA
        $badcall = "(".$_SESSION['id'].",)";

if($friendlist==$badcall){
$friendlist="(".$_SESSION['id'].")";
}

        //FRIENDSHIPS
        $user1_id;
            if(isset($data['id'])){
            $user2_id = $data['id'];
            }else{
            $user1_id = $_SESSION['id'];
            }
            $following_string       =   $_SESSION['id'];
            $sql_follows="SELECT * FROM friends WHERE user1_id=".$user1_id." OR user2_id=".$user2_id;
            $query_follows=mysql_query($sql_follows) or die("Error finding friendships");

            while ($follow=mysql_fetch_array($query_follows))
            {
            if($follow['user2_id']==$_SESSION['id']){
                $following_string   =   $following_string. " OR streamitem_creator =" . $follow['user1_id']." OR streamitem_target=".$follow['user1_id'];
            }else{
                $following_string   =   $following_string. " OR streamitem_creator =" . $follow['user2_id']." OR streamitem_target=".$follow['user2_id'];
            }
            }

        //STREAMDATA

        $call="SELECT * FROM streamdata WHERE streamitem_target = " . $user1_id ." AND streamitem_type_id NOT IN ('2') ORDER BY streamitem_timestamp DESC LIMIT 15";
    $chant= mysql_query($call) or die(mysql_error());
        $num = mysql_num_rows($chant);
        if($num>0){

            while($streamitem_data = mysql_fetch_array($chant)){

                echo'<div id="statusholder"><div class="divider">';
                if($streamitem_data['streamitem_type_id'] == 1||$streamitem_data['streamitem_type_id'] == 3){
                echo "<img class='stream_profileimage' style='border:none;padding:0px;display:inline;' src='";rawfeeds_user_core::output_profile_image_url($streamitem_data['streamitem_creator']);echo "' onerror='this.src=\"/img/no_profile_img.jpeg\";'>
                ";
                    $poster_name = rawfeeds_user_core::getuser($streamitem_data['streamitem_creator']);
                    $target_name = rawfeeds_user_core::getuser($streamitem_data['streamitem_target']);
                    $cont = stripslashes($streamitem_data['streamitem_content']);

                    if(!($streamitem_data['streamitem_type_id']==2)){
                    $cont = htmlentities($cont);
                    $cont = ereg_replace("[[:alpha:]]+://[^<>[:space:]]+[[:alnum:]/]","<a class='user_link' href=\"\\0\">\\0</a>", $cont);

                    }

                    if($streamitem_data['streamitem_creator']==$streamitem_data['streamitem_target']){
                        echo "<a href='/sn-profile.php?user1_id=".$poster_name['id']."'>" . $poster_name['fullusersname']."</a><span class='subtleLink'> said </span>";
                    }else{
                        echo "<a href='/sn-profile.php?user1_id=".$poster_name['id']."'>" .$poster_name['fullusersname']."</a>  
                        <span class='subtleLink'>wrote</span>";
                    }
                    echo "<br/><a href='#' class='subtleLink' style='font-weight:normal;'>".Agotime($streamitem_data['streamitem_timestamp'])."</a><hr>";

                    if($streamitem_data['streamitem_type_id']==2){
                    $cont = nl2br($cont);
                    echo "<div style='display:inline;'><span class='subtleLink'>".$cont."</span> </div>";
                    }else{

                        if($streamitem_data['streamitem_creator']==$streamitem_data['streamitem_target']){
                        $cont = nl2br($cont);
                            echo "<div>".$cont."</div>";
                        }else{
                        $cont = nl2br($cont);
                        echo "<div>".$cont."</div>";

                        }
                        echo"</div></div>";
                    }}}

                ?>  
                    <div class="stream_show_posts" onClick="global_streamcount=global_streamcount+10;refreshstream();">Show More Posts</div>
                    <?php                   
}else{
            echo "<div class='global_softerror'>No posts yet!</div>";
        }

    }else{
    ?>
-----------------------------------------START OF USER2_ID'S STREAM-------
<div id="statusholder">
    <div class="divider">
        <h2>Post on <?php echo $data['fullusersname']; ?>'s stream</h2>
        <form action="insert.php" method="POST" target="ifr2" class="form_statusinput">
        <input type="hidden" name="toid" value="<?php echo $user2_id ?>">
        <input type="text" name="newmsg" id="newmsg" class="homescreen_status_input" placeholder="Say something" autocomplete="off">
        <iframe name="ifr2" id="ifr2" style="display:none;"></iframe>
        <input type="submit" target="ifr2" value="Share" >

    </form>
    </div></div>

    <?php 
    //FRIENDSHIPS
            $following_string       =   $_SESSION['id'];
            $sql_follows="SELECT * FROM friends WHERE user2_id=".$_SESSION['id']." AND status=2 OR user1_id=".$_SESSION['id']." AND status=2";
            $query_follows=mysql_query($sql_follows) or die("Error finding friendships");
            if($query_follows>0){
            $friendlist="(".$_SESSION['id'].",";
            $t=0;
            while ($follow=mysql_fetch_array($query_follows))
            {
                if($follow['user2_id']==$_SESSION['id']){
                    if($t>0){
                    $friendlist=$friendlist.",";
                    }
                    $friendlist =   $friendlist. $follow['user1_id'];
                }else{

                    if($t>0){
                        $friendlist=$friendlist.",";
                    }
                    $friendlist =   $friendlist. $follow['user2_id'];

                }
                $t=$t+1;
            }
            $friendlist=$friendlist.")";
            }
        //STREAMDATA
        $badcall = "(".$_SESSION['id'].",)";

if($friendlist==$badcall){
$friendlist="(".$_SESSION['id'].")";
}

  date_default_timezone_set("GMT");

        //FRIENDSHIPS
        $user1_id;
            if(isset($data['id'])){
            $user2_id = $data['id'];
            }else{
            $user1_id = $_SESSION['id'];
            }
            $following_string       =   $_SESSION['id'];
            $sql_follows="SELECT * FROM friends WHERE user2_id=".$user2_id." OR user1_id=".$user1_id;
            $query_follows=mysql_query($sql_follows) or die("Error finding friendships");

            while ($follow=mysql_fetch_array($query_follows))
            {
            if($follow['user1_id']==$_SESSION['id']){
                $following_string   =   $following_string. " OR streamitem_creator =" . $follow['user2_id']." OR streamitem_target=".$follow['user2_id'];
            }else{
                $following_string   =   $following_string. " OR streamitem_creator =" . $follow['user1_id']." OR streamitem_target=".$follow['user1_id'];
            }
            }

        //STREAMDATA

        $call="SELECT * FROM streamdata WHERE streamitem_target = " . $user2_id ." AND streamitem_type_id NOT IN ('2') ORDER BY streamitem_timestamp DESC LIMIT 15";
    $chant= mysql_query($call) or die(mysql_error());
        $num = mysql_num_rows($chant);
        if($num>0){

            while($streamitem_data = mysql_fetch_array($chant)){

                echo'<div id="statusholder">
    <div class="divider">';
                if($streamitem_data['streamitem_type_id'] == 1||$streamitem_data['streamitem_type_id'] == 3){
                echo "<img class='stream_profileimage' style='border:none;padding:0px;display:inline;' src='";rawfeeds_user_core::output_profile_image_url($streamitem_data['streamitem_creator']);echo "' onerror='this.src=\"/img/no_profile_img.jpeg\";'>
                ";
                    $poster_name = rawfeeds_user_core::getuser($streamitem_data['streamitem_creator']);
                    $target_name = rawfeeds_user_core::getuser($streamitem_data['streamitem_target']);
                    $cont = stripslashes($streamitem_data['streamitem_content']);

                    if(!($streamitem_data['streamitem_type_id']==2)){
                    $cont = htmlentities($cont);
                    $cont = ereg_replace("[[:alpha:]]+://[^<>[:space:]]+[[:alnum:]/]","<a class='user_link' href=\"\\0\">\\0</a>", $cont);

                    }

                    if($streamitem_data['streamitem_creator']==$streamitem_data['streamitem_target']){
                        echo "<a href='/profile.php?username=".$poster_name['username']."'>" . $poster_name['fullusersname']."</a><span class='subtleLink'> said </span>";
                    }else{
                        echo "<a href='/profile.php?username=".$poster_name['username']."'>" .$poster_name['fullusersname']."</a>  
                        <span class='subtleLink'>wrote</span>";
                    }
                    echo "<br/><a href='#' class='subtleLink' style='font-weight:normal;'>".Agotime($streamitem_data['streamitem_timestamp'])."</a><hr>";

                    if($streamitem_data['streamitem_type_id']==2){
                    $cont = nl2br($cont);
                    echo "<div style='display:inline;'><span class='subtleLink'>".$cont."</span> </div>";
                    }else{

                        if($streamitem_data['streamitem_creator']==$streamitem_data['streamitem_target']){
                        $cont = nl2br($cont);
                            echo "<div>".$cont."</div>";
                        }else{
                        $cont = nl2br($cont);
                        echo "<div>".$cont."</div>";
                        }
                    echo'</div>';
                    }}
            }
                    }else{
            echo "<div class='global_softerror'>No posts yet!</div>";
                    }
                    echo'<div class="stream_show_posts" onClick="global_streamcount=global_streamcount+10;refreshstream();">Show More Posts</div>';
    }
}

            ?> 
```

这是我需要插入的代码。

```
<?php if(USER_BEFRIENDED==0){ ?>
    Add <?php echo $data['fullusersname']; ?> as a friend to see posts and information.
    <?php } 
    if(USER_BEFRIENDED==1){
    ?>
    You've added <?php echo $data['fullusersname']; ?> as a friend, but he hasn't accepted yet. Check back later!
    <?php } }?> 
```

如果我考虑一下..我会在对 user2_id 的流进行编码之前将其放入代码中..而且我现在不会处于这样的困境中。

希望有人可以提供帮助。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T08:02:13.400

查看您的代码，我假设您想从数据库中获取友谊。我不太明白发布的很多代码的相关性，但我可以提出一些建议：

**编写一个函数来返回友谊“状态”**

我猜你会想在其他地方做类似的事情（内容隐藏/原始隐私），所以这很有用。显然我无法对此进行测试，但类似于：

```
function checkUserFriendship($user1,$user2)
{
  $sql = "SELECT status FROM friends WHERE user1_id = $user1 AND user2_id = $user2 OR user1_id = $user2 AND user2_id = $user1";
  $query = mysql_query($sql);
  $data  = mysql_fetch_array($query);
  return $data['status'];
} 
```

现在，我非常怀疑这会直接起作用，但它会（希望）实现的是返回您在“朋友”表中的“状态”字段。然后，您可以在输出时使用它。例如：

```
$friendshipStatus = checkUserFriendship($user1,$user2);

switch($friendshipStatus){
 case "accepted":
  //Show something
 break;
 case "pending":
  //Show "pending" message
 break;
 case 0:
  //Show nothing (or an error message)
 break;
} 
```

这可能不是您想要的，但这是我处理这种情况的方式。看起来您可能已经使用包含的行完成了此操作

```
rawfeeds_user_core::check_active_friends 
```

但是您发布了很多代码，我不完全确定它们是如何组合在一起的。

**全局变量的使用**

这是一个旁注，但我会避免使用已定义的全局变量。看起来他们在这里没有任何目的。

**不必要的代码 (?)**

在您的用户流（让我们这样称呼它们）中，您有一大块代码构建 SQL 的“IN (n,n,n,n)”部分，以仅选择某些朋友。我想这在网站的全球/公共/“新闻提要”部分是必要的，但我看不到你在哪里使用它。（这可能是我的疏忽/只是愚蠢！）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-03T23:03:32.750

在不阅读所有代码的情况下，我会推荐一个简单的多维数组：

```
$friends_of_users["user1"] = array("user3", "user9");
$friends_of_users["user2"] = array("user5", "user6");
$friends_of_users["user3"] = array("user1", "user7"); 
```

这是伪代码，你应该使用 ID 而不是“userX”，当然。到目前为止，这不是最性感的解决方案，但它会解决您的问题。

# javascript - 从段落中删除某些文本字符串？

> ID：11320309
> 
> 赞同：-1
> 
> 时间：2012-07-03T22:53:02.993
> 
> 标签：javascript, jquery, html

为了与我网站的同一区域一起使用，我想知道是否有办法删除段落中的某些字符串，但不是整个段落。对于一些照片标题，它说`Photo Title (by username)`- 有没有办法只删除段落的（按用户名）部分，所以我只剩下照片标题？如果有人可以提供一个有用的脚本！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-03T23:02:52.923

jQuery：

```
$('p').html(function(){
   return $(this).text().replace(/\s+\(by\s+\w+\)/g, "");
}); 
```

演示：http: [//jsfiddle.net/arEzS/](http://jsfiddle.net/arEzS/)

上述解决方案将替换每个段落元素中与 的模式匹配的文本`(by [a-zA-Z0-9])`，其中 [a-zA-Z0-9] 表示字母数字字符的任意组合。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-03T22:57:24.990

这是我的正则表达式解决方案：

```
$("p").html(function(i, val) {
    return val.replace(/\s+\(by\s+\w+\)$/, "");
});​ 
```

**演示：http:** [//jsfiddle.net/GWyhM/](http://jsfiddle.net/GWyhM/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-03T22:59:03.173

**演示** [http://jsfiddle.net/QeZxn/11/](http://jsfiddle.net/QeZxn/11/)

g = /g 修饰符确保所有出现的“替换”

i = /i 使正则表达式匹配不区分大小写

好读：[http ://www.regular-expressions.info/javascript.html](http://www.regular-expressions.info/javascript.html)

**代码**

```
$(document).ready(function() {
    var $foo = $('#content');

    $foo.html($foo.text().replace(/\(by Hulk\)/g,''));

}); 
```

# java - 使用 OSC 时如何避免 java.util.ConcurrentModificationException？

> ID：11320310
> 
> 赞同：4
> 
> 时间：2012-07-03T22:53:07.917
> 
> 标签：java, multithreading, exception, osc

我正在处理的代码正在引发上述异常。我对多线程编程不是很有经验，而且我没有很多运气来解决这个问题。

该程序是使用处理和 OSC 用 Ja​​va 编写的。主要的 OSC 事件处理程序正在向 Vector 添加元素。它是在用户输入时触发的，因此高度不可预测。这个向量也在 Processing 的动画线程中被迭代和更新，它以每秒大约 60 次的速度非常有规律地发生。

有时，当 Vector 在动画线程中被迭代并抛出异常时，会调用 OSC 事件处理程序。

我尝试将“ `synchronized`”修饰符添加到 OSC 事件处理程序。我还尝试在动画线程的下一帧（时间步）之前提示对 Vector 的更改，但我发现它最终只是延迟了抛出的异常。

我能做些什么来防止这种行为？如果 Vector 尚未使用，有没有办法只访问它？

**更新：** 两个答案表明列表在迭代时添加或删除了元素。这实际上是由于 OSC 从一个线程触发处理程序而不是迭代列表的线程而发生的。我正在寻找一种方法来防止这种情况。

这是一些伪代码：

```
Vector<String> list = new Vector<String>();
Vector<Particle> completedParticles = new Vector<Particle>();

public void oscEvent( OSCMessage message )
{
    list.add( new Particle( message.x, message.y ) );
}

public void draw()
{
    completedParticles.clear();
    for( Particle p : list )
    {
        p.draw();
        if( p.isComplete ) {
            completedParticles.add( p );
        }   
    }
    list.removeAll( completedParticles );
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-03T22:56:56.747

## 关于您的代码

在您的代码中，您的 for-each 循环正在遍历列表，并且您`osEvent`修改了列表。同时运行的两个线程可能会尝试：迭代列表，而其他线程正在向其中添加元素。您的 for 循环创建了一个迭代器。

您可以执行以下操作（前提是只有这两个地方会发生这种情况）：

```
//osEvent
synchronized(this.list) {
   list.add( new Particle( message.x, message.y ) );
}

//draw
synchronized(this.list) {
  for( Particle p : list )
    {
        p.draw();
        if( p.isComplete ) {
            completedParticles.add( p );
        }   
    }
} 
```

或者，正如我在下面解释的，在迭代它之前制作一个向量的副本，这可能会更好。

## 关于并发修改异常

此异常不一定在多线程代码中引发。当您在迭代时修改集合时会发生这种情况。即使在单线程应用程序中，您也可以获得此异常。例如，在 for-each 循环中，如果您向列表中删除或添加元素，您最终会得到一个`ConcurrentModificationException`.

因此，向代码添加同步不一定能解决问题。一些替代方案包括制作要迭代的数据的副本，或使用接受修改的迭代器（即 ListIterator），或具有快照迭代器的集合。

显然，在多线程代码中，您仍然需要注意同步以避免进一步的问题。

让我举几个例子：

假设您想在迭代集合时从集合中删除项目。您避免 a 的替代方法`ConcurrentModificationException`是：

```
List<Book> books = new ArrayList<Book>();
books.add(new Book(new ISBN("0-201-63361-2")));
books.add(new Book(new ISBN("0-201-63361-3")));
books.add(new Book(new ISBN("0-201-63361-4"))); 
```

在增强的 for 循环中收集要删除的所有记录，完成迭代后，删除所有找到的记录。

```
ISBN isbn = new ISBN("0-201-63361-2");
List<Book> found = new ArrayList<Book>();
for(Book book : books){
    if(book.getIsbn().equals(isbn)){
        found.add(book);
    }
}
books.removeAll(found); 
```

或者，您可以`ListIterator`在迭代过程中使用支持删除/添加方法的 a。

```
ListIterator<Book> iter = books.listIterator();
while(iter.hasNext()){
    if(iter.next().getIsbn().equals(isbn)){
        iter.remove();
    }
} 
```

在多线程环境中，您可能会考虑在迭代之前制作集合的副本，这样，允许其他人修改原始集合而不影响迭代：

```
synchronized(this.books) {
   List<Book> copyOfBooks = new ArrayList<Book>(this.books)
}
for(Book book : copyOfBooks) {
   System.out.println(book);
} 
```

或者，您可以考虑使用快照迭代器使用其他类型的集合，例如`java.util.ConcurrentCopyOnWriteArrayList`保证不抛出`ConcurrentModificationException`。但是先看文档，因为这种类型的集合并不适合所有的场景。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-03T23:22:10.680

如果您想要独占访问，您需要锁定列表上的整个操作。Vector 是内部同步的，但它仍然会释放锁，然后在每次迭代时再次获取它。

```
java.util.concurrent.locks.Lock lock = new java.util.concurrent.locks.ReentrantLock();
Vector<String> list = new Vector<String>();
Vector<Particle> completedParticles = new Vector<Particle>();

public void oscEvent( OSCMessage message )
{
    lock.lock();
    try {
      list.add( new Particle( message.x, message.y ) );
    } finally {
      lock.unlock();
    }
}

public void draw()
{
    completedParticles.clear();
    lock.lock();
    try {
      for( Particle p : list )
      {
          p.draw();
          if( p.isComplete ) {
              completedParticles.add( p );
          }   
      }
      list.removeAll( completedParticles );
    } finally {
      lock.unlock();
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-03T23:06:08.457

如果在迭代期间从集合中添加/删除项目，则会发生这种情况。您可以查看的一些内容：

1.  CopyOnWriteArrayList() - 相当昂贵但可以帮助您避免并发修改异常，或者
2.  使用并发HashMap
3.  在迭代本身上同步

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-03T23:26:07.787

正如已经提到的，并发修改异常发生在您迭代列表并且迭代期间内容发生变化时。对于某些使用集合的迭代器的类将解决这个问题，但并非所有集合都实现迭代器。

尝试使用组合来包装正在迭代的集合，并在迭代之前获得锁，然后在迭代之后释放锁。为此，任何添加、删除等操作都需要由同一个锁保护。

```
// example only
public class LockingVector {
  private final Vector v;
  private final ReentrantLock lock = new ReentrantLock();

  public void lock(){
    lock.lock();
  }
  public void unlock(){
    lock.unlock();
  }

  // other 'vector' method delegated to v
  public Object get() {
    return v.get();
  }
} 
```

然后使用是做类似的事情

```
 public class Main {
   public static void main(String[] args){
     Vector v = ...
     LockingVector lv = new LockingVector(v);
     try {
       lv.lock();
       // do stuff here (add, delete, iterate, etc.)
     } finally {
       lv.unlock();
     }
   }
 } 
```

# abap - 如何为某个用户限制某个交易码【ABAP编程】

> ID：11320311
> 
> 赞同：0
> 
> 时间：2012-07-03T22:53:14.553
> 
> 标签：abap

我只是想知道如何限制 SAP NetWeaver Developers Kit 中的某个用户使用自定义事务代码。

我正在访问此代码“se80”，我们可以在其中创建自己的程序来自定义 SAP 系统，但我的情况是我希望它限制。

例如，总经理可以使用此自定义事务代码，例如（ZBDGEN），其中他/她可以使用自定义程序/事务代码，而销售员只能使用自定义程序/事务代码，例如（ZBDSC）

我创建了一个两个程序，第一个程序是更新/编辑/删除总经理使用的权限，而第二个程序是第一个程序的副本，但该程序只能用于更新和销售员使用。

而且我认为，出于特权目的和安全目的，如果事务代码仅限于某个用户，会更好。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-04T04:19:18.503

通过将 tcode 分配给角色并将这些角色分配给特定用户，您可以实现您所需要的。您不能直接为用户授予 Tcode 授权。不仅如此，您将无权分配角色和所有内容。只有您的 Basis 团队有权执行此操作。

这些活动中涉及的 Tcode 是**PFCG**和**SU01**。

# python - 用于电压/时间数据的 NumPy/SciPy FFT

> ID：11320312
> 
> 赞同：3
> 
> 时间：2012-07-03T22:53:22.067
> 
> 标签：python, numpy, scipy, fft

这是一个非常基本的问题。我正在尝试使用 SciPy/NumPy 对来自示波器的电压与时间数据执行 fft。在将数据传递给 scipy 进行 fft 处理时，我完全迷失了方向。我将数据作为两个列表（x 和 y 值），显然可以将列表压缩为元组。我不确定该怎么做。我似乎找不到太多文档。抱歉，如果以前有人问过这个问题，我找不到相关的问题。

总结一下：如果一个人有 x 和 y 数据存储在两个列表中或存储在一个元组中，他们如何对这些数据进行 FFT？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-03T23:04:22.703

假设所有样本都是等距的（即每次样本之间存在相同的差异），您只需将`y`向量传递给 fft 函数。

它将返回一个复数向量。第一个数字将对应于直流电压。然后向量的一半将是正频率，而另一半将对应于负频率。如果您只处理实际电压，则可能不需要负频率。

这是一个示例，假设`x`任何`y`都是 numpy 数组：

```
from matplotlib import pyplot
fy = numpy.fft.fft(y)
dt = x[1] - x[0]
n = x.size
freqs = numpy.fft.fftfreqs(n, d=dt) # Frequencies associated with each samples
pyploy.plot(numpy.fft.fftshift(freqs), numpy.fft.fftshift(abs(fy)))
pyplot.show() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-03T22:57:25.933

该文档可以在[http://docs.scipy.org/doc/scipy/reference/generated/scipy.fftpack.fft.html找到](http://docs.scipy.org/doc/scipy/reference/generated/scipy.fftpack.fft.html)

我不知道你为什么要打发时间；肯定它隐含在电压测量序列中吗？

一般来说，

```
import numpy as np
import scipy.fftpack

data = np.arange(0.0, 12.8, 0.1)
fft = scipy.fftpack.fft(data) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-03T23:05:43.527

```
from scipy.fftpack import fft

my_voltage_list = [1.1,1.2,1.1,1.1,3.0,3.1]
my_time_list = [1,2,3,4,5,6]

fft_result = fft(my_voltage_list)

print fft_result

>>> array([ 10.6 +0.00000000e+00j,   0.1 +3.29089653e+00j,
    -2.0 +4.44089210e-16j,  -0.2 +0.00000000e+00j,
    -2.0 -4.44089210e-16j,   0.1 -3.29089653e+00j]) 
```

# linux - 在 Ubuntu 12.04 上重新安装 Apache Tomcat7

> ID：11320316
> 
> 赞同：5
> 
> 时间：2012-07-03T22:53:39.590
> 
> 标签：linux, tomcat, ubuntu

我在 ubuntu 上安装了 tomcat7，然后我删除了 /etc/tomcat7 文件夹以完全删除它。现在我想重新安装 Tomcat7，但是 sudo apt-get install tomcat7 命令给了我错误。有人可以帮我解决这个问题吗？

错误 - ![在此处输入图像描述](../Images/ed42651661caa40c32645e5c3bcfc724.png)

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-07-03T23:27:52.210

我发现了问题。我将其发布以供将来参考。

这个问题可以通过使用命令来解决——

```
 sudo apt-get purge tomcat7 
```

这将删除所有相关的依赖项。在这之后我做了——

```
 sudo apt-get install tomcat7 
```

# javascript - 滚动时自动加载

> ID：11320318
> 
> 赞同：0
> 
> 时间：2012-07-03T22:54:22.270
> 
> 标签：javascript, jquery, scroll

当用户向下滚动时，我有这个脚本可以进行新的 ajax 调用。但是如何让它做一次。因为如果用户滚动到快速，它们是具有相同数据的**n ajax 调用。**

```
 $(window).scroll(function(){

            whenTo=$(window).scrollTop();

        if(whenTo>=($(document).height()-($(window).height())-600)){
// make ajax call
}

}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-03T22:56:46.810

如何添加一个布尔值来检查它是否已经完成？

例如：

```
var hasLoaded = false;
$(window).scroll(function(){

        whenTo=$(window).scrollTop();

        if(!hasLoaded && (whenTo>=($(document).height()-($(window).height())-600))){
            hasLoaded = true;
            // make ajax call
        }
}); 
```

使用此方法意味着您可以随时将变量更改为 false，以便在需要时再次调用 ajax。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-03T22:58:19.917

我会使用 Underscore.js，[`_.throttle()`](http://underscorejs.org/#throttle)或者[`_.debounce()`](http://underscorejs.org/#debounce)– 假设您想重复调用该函数，或者[`_.once()`](http://underscorejs.org/#once)只调用一次。

# css - TW Bootstrap：如何溢出列

> ID：11320323
> 
> 赞同：12
> 
> 时间：2012-07-03T22:54:35.207
> 
> 标签：css, twitter-bootstrap

我想要一行可以水平滚动的列：

![twitter bootstrap 单行中的可滚动列](../Images/6d4685112684d5ce742ee51a7ebde404.png)

如您所见，该行是外部块（带有填充）。在其中，有一些列，每个列都有一些`span*`类，例如`span3`. 而且由于所有列都不适合该行，因此滚动条位于底部。

这是我尝试做的（使用内联css），到目前为止还没有运气。

```
<div class="row">

<!-- the parent element which will have scrollbar -->
<div class="span12" style="white-space: nowrap; overflow-x: auto;">

<div class="row">

<div class="span3" style="display: inline-block;">content here</div>
<div class="span3" style="display: inline-block;">content here</div>
<div class="span3" style="display: inline-block;">content here</div>
...

<div>

</div>

</div> 
```

但是，一旦它们无法放入行中，列就会自动换行。我怎样才能做到这一点？

谢谢你。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-07-04T18:05:42.487

**更新**

我猜你只是错过了`float: none;`：`float`部队`display: block;`。

[现场演示（jsfiddle）](http://jsfiddle.net/Sherbrow/D3LuT/)

```
<div class="myClass">
    <div class="row">
        <div class="span5"></div>
        <div class="span5"></div>
        <div class="span5"></div>
    </div>
</div> 
```

```
div.myClass {
    overflow-x: auto;
    white-space: nowrap;
}
div.myClass [class*="col"], /* TWBS v3 */
div.myClass [class*="span"] {  /* TWBS v2 */
    display: inline-block;
    float: none; /* Very important */
} 
```

无论如何，这并不是因为你可以做到你应该做到的。有像[轮播](http://twitter.github.com/bootstrap/javascript.html#carousel)这样的东西可以达到这种效果。

恕我直言**，网页最初是用来水平滚动的**，而 JavaScript 可以做任何事情。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-07-27T18:07:51.647

我更进一步。可滚动的水平列！

```
 div.h-scrollable {
overflow-x: auto;
white-space: nowrap; 
}

 div.h-scrollable [class*="col"] {
    display: inline-block;
    float: none;
    white-space: normal;
    vertical-align: top;
  }

    <div class="h-scrollable container-fluid ">
    <div class="row">
        <div class="col-xs-1">
            <label>9:00am</label>
        </div>
        <div class="col-xs-6">
            <label>Blah blah blah blah blah blahBlah blah blah blah blah blahBlah blah blah blah blah blahBlah blah blah blah blah blahBlah blah blah blah blah blahBlah blah blah blah blah blahBlah blah blah blah blah blahBlah blah blah blah blah blah</label>
        </div>
        <div class="col-xs-6">
            <label>Blah blah blah blah blah blah</label>
        </div>
        <div class="col-xs-6">
            <label>BBlah blah blah blah blah blahBlah blah blah blah blah blahBlah blah blah blah blah blahBlah blah blah blah blah blahBlah blah blah blah blah blahBlah blah blah blah blah blahBlah blah blah blah blah blahBlah blah blah blah blah blahBlah blah blah blah blah blahBlah blah blah blah blah blahBlah blah blah blah blah blahBlah blah blah blah blah blahBlah blah blah blah blah blahBlah blah blah blah blah blahBlah blah blah blah blah blahBlah blah blah blah blah blahBlah blah blah blah blah blahBlah blah blah blah blah blahBlah blah blah blah blah blahBlah blah blah blah blah blahBlah blah blah blah blah blahBlah blah blah blah blah blahBlah blah blah blah blah blahBlah blah blah blah blah blahah</label>
        </div>
        <div class="col-xs-6">
            <label>Blah blah blah blah blah blah</label>
        </div>
        <div class="col-xs-6">
            <label>Blah blah blah blah blah blah</label>
        </div>
        <div class="col-xs-6">
            <label>Blah blah blah blah blah blah</label>
        </div>
    </div>
    <div class="row">
        <div class="col-xs-1">
            <label>9:00am</label>
        </div>
        <div class="col-xs-6">
            <label>Blah blah blah blah blah blahBlah blah blah blah blah blahBlah blah blah blah blah blahBlah blah blah blah blah blahBlah blah blah blah blah blahBlah blah blah blah blah blahBlah blah blah blah blah blahBlah blah blah blah blah blah</label>
        </div>
        <div class="col-xs-6">
            <label>Blah blah blah blah blah blah</label>
        </div>
        <div class="col-xs-6">
            <label>BBlah blah blah blah blah blahBlah blah blah blah blah blahBlah blah blah blah blah blahBlah blah blah blah blah blahBlah blah blah blah blah blahBlah blah blah blah blah blahBlah blah blah blah blah blahBlah blah blah blah blah blahBlah blah blah blah blah blahBlah blah blah blah blah blahBlah blah blah blah blah blahBlah blah blah blah blah blahBlah blah blah blah blah blahBlah blah blah blah blah blahBlah blah blah blah blah blahBlah blah blah blah blah blahBlah blah blah blah blah blahBlah blah blah blah blah blahBlah blah blah blah blah blahBlah blah blah blah blah blahBlah blah blah blah blah blahBlah blah blah blah blah blahBlah blah blah blah blah blahBlah blah blah blah blah blahah</label>
        </div>
        <div class="col-xs-6">
            <label>Blah blah blah blah blah blah</label>
        </div>
        <div class="col-xs-6">
            <label>Blah blah blah blah blah blah</label>
        </div>
        <div class="col-xs-6">
            <label>Blah blah blah blah blah blah</label>
        </div>
    </div>
</div> 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-03T23:00:14.530

你需要 span3 上的 overflow-x 而不是我认为的 span12

# php - wordpress 中的“警告：无法修改标题信息”错误

> ID：11320324
> 
> 赞同：-1
> 
> 时间：2012-07-03T22:54:34.933
> 
> 标签：php, wordpress, session, http-headers

我在开发插件中遇到此错误。
在 localhost 中工作正常，但在远程服务器中失败：

> 警告：无法修改标头信息 - 标头已由第 866 行 /path_wordpress/public_html/wp-includes/pluggable.php 中的（输出开始于 /path_wordpress/public_html/wp-admin/includes/template.php:1657）发送

我已经删除了文件开头和结尾前后的所有空格（此错误的常见原因），并且不涉及任何会话。

还有什么可能的原因？

===
**编辑 1**

wp-admin/includes/template.php：

```
$attributes = '';
if ( is_array( $other_attributes ) ) {
    foreach ( $other_attributes as $attribute => $value ) { // line 1657 
        $attributes .= $attribute . '="' . esc_attr( $value ) . '" '; // Trailing space is important
    }
} else if ( !empty( $other_attributes ) ) { // Attributes provided as a string
    $attributes = $other_attributes;
} 
```

===
**编辑 2**：

wp-admin/wp-includes/pluggable.php：

```
if ( !function_exists('wp_redirect') ) :
/**
 * Redirects to another page.
 *
 * @since 1.5.1
 * @uses apply_filters() Calls 'wp_redirect' hook on $location and $status.
 *
 * @param string $location The path to redirect to
 * @param int $status Status code to use
 * @return bool False if $location is not set
 */ // line 866
function wp_redirect($location, $status = 302) {
    global $is_IIS; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T02:54:50.033

无法修改标头信息通常发生在您在某些 html 输出后尝试使用 header() 或重定向功能时。它不太可能位于 Wordpress 本机代码文件之一中，因此请检查您可能编写的一些尝试重定向页面的自定义代码。

参考： http: [//php.net/manual/en/function.header.php](http://php.net/manual/en/function.header.php)

# javascript - 在 iPhone 和 iPad 之间切换 div

> ID：11320325
> 
> 赞同：2
> 
> 时间：2012-07-03T22:54:46.643
> 
> 标签：javascript, iphone, html, css, ipad

我试图在不同的 div 之间切换（在同一个 html 页面上）取决于设备是 iPhone 还是 iPad，我尝试了所有我能想到的方法，但它不起作用。我希望在 ipad 上打开时显示 nav_ipad 并且 nav_iphone 消失，但无论我做了什么，我总是显示 nav_iphone。这是我的代码，如果可以，请帮助我，谢谢！

**html代码**

```
<nav id="nav_ipad"> 
<ul>
<li><a href="about.html"><b>A</b>BOUT</a></li>
<li><a href=""><b>P</b>ROCESS</a></li>
<li><a href=""><b>W</b>ORK</a></li>
<li><a href=""><b>C</b>ONTACT</a></li>
</ul>
</nav>

<nav id="nav_iphone">
<ul>
<li><a href="site/about.html"><b>A</b>BOUT</a></li>
<li><a href=""><b>W</b>ORK</a></li>
</ul>
</nav> 
```

**Javascript**

```
if(navigator.userAgent.match(/iPhone/i) || navigator.userAgent.match(/iPod/i)) {

$('#nav_ipad').hide();
}

if(navigator.userAgent.match(/iPad/i)) {

$('#nav_iphone').hide();
// document.getElementById("nav_iphone").style.display = "none";
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T14:14:25.087

您应该只使用 css，顶部链接标签用于 iPhone，另一个用于 iPad

```
<link media="only screen and (max-device-width: 480px)" rel="stylesheet" href="css/small-device.css" type="text/css" title="no title"/>

<link media="only screen and (device-width: 768px)" rel="stylesheet" href="css/ipad.css" type="text/css" title="no title"/> 
```

然后创建 2 个 css 文件并设置样式 :)

# c++ - 基类未定义的 Visual Studio 2010

> ID：11320327
> 
> 赞同：2
> 
> 时间：2012-07-03T22:54:48.383
> 
> 标签：c++, visual-studio-2010, class, templates, undefined

使用 Visual Studio 2010 编译以下代码：

```
#include "filter.h"
#include "filter_table.h"
#include "scene.h"
#include "common.h"

using namespace std;

class absval_filter : public typed_map_filter<float> {
public:
absval_filter(filter_input *input) : typed_map_filter<float>(input) {}

bool compute(const filter_param_set *params, bool adding, float &res, bool &changed) {
    float newres;
    if (params->empty()) {
        return false;
    }
    filter_val *fv = params->begin()->second;
    if (!get_filter_val(fv, newres)) {
        return false;
    }
    newres = fabs(newres);
    changed = (newres != res);
    res = newres;
    return true;
}
}; 
```

产生以下错误（第 8 行 = 类 absval_filter 的定义开始）：

```
Core\SVS\src\filters\absval.cpp(8) : error C2504: 'typed_map_filter' : base class undefined Core\SVS\src\filters\absval.cpp(8) : error C2143: syntax error : missing ',' before '<' Core\SVS\src\filters\absval.cpp(12) : error C4430: missing type specifier - int assumed. >Note: C++ does not support default-int Core\SVS\src\filters\absval.cpp(12) : error C2143: syntax error : missing ',' before '*' Core\SVS\src\filters\absval.cpp(10) : error C2059: syntax error : '<' Core\SVS\src\filters\absval.cpp(14) : error C2065: 'params' : undeclared identifier Core\SVS\src\filters\absval.cpp(14) : error C2227: left of '->empty' must point to >class/struct/union/generic type
       type is ''unknown-type'' Core\SVS\src\filters\absval.cpp(17) : error C2065: 'filter_val' : undeclared identifier Core\SVS\src\filters\absval.cpp(17) : error C2065: 'fv' : undeclared identifier Core\SVS\src\filters\absval.cpp(17) : error C2065: 'params' : undeclared identifier Core\SVS\src\filters\absval.cpp(17) : error C2227: left of '->begin' must point to >class/struct/union/generic type
       type is ''unknown-type'' Core\SVS\src\filters\absval.cpp(17) : error C2227: left of '->second' must point to >class/struct/union/generic type Core\SVS\src\filters\absval.cpp(18) : error C2065: 'fv' : undeclared identifier Core\SVS\src\filters\absval.cpp(18) : error C3861: 'get_filter_val': identifier not found Core\SVS\src\filters\absval.cpp(21) : error C3861: 'fabs': identifier not found Core\SVS\src\filters\absval.cpp(22) : error C2065: 'changed' : undeclared identifier Core\SVS\src\filters\absval.cpp(22) : error C2065: 'res' : undeclared identifier Core\SVS\src\filters\absval.cpp(23) : error C2065: 'res' : undeclared identifier Core\SVS\src\filters\absval.cpp(29) : error C2065: 'input' : undeclared identifier Core\SVS\src\filters\absval.cpp(29) : fatal error C1903: unable to recover from previous error(s); stopping compilation 
```

类“typed_map_filter”在 filter.h 中定义：

```
#ifndef FILTER_H
#define FILTER_H

#include <iostream>
#include <string>
#include <list>
#include <map>
#include <sstream>
#include <iterator>

#include "linalg.h"
#include "sgnode.h"
#include "scene.h"
#include "common.h"

...

/*
 The filter is the basic query unit in SVS. Each filter takes a list of
 parameter sets generated by the filter_input class and produces a single
 result list. Soar can "mix-and-match" filters by plugging their outputs
 into inputs of other filters. This is done by specifying the desired
 filter plumbing on the SVS command link.

 Filter results are updated once every output phase. Updating a filter's
 result is recursive: the filter will first request an update on its
 input, which in turn requests updates on all filters feeding into the
 input. Filters should also try to cache results when possible to avoid
 unnecessary computation.
*/
class filter {
public:
filter() {
    input = new null_filter_input();
}

filter(filter_input *in) : input(in) {
    if (input == NULL) {
        input = new null_filter_input();
    }
}

virtual ~filter() {
    delete input;
}

std::string get_error() {
    return errmsg;
}

bool is_error() {
    return !errmsg.empty();
}

void set_error(std::string msg) {
    errmsg = msg;
    result.clear();
}

void clear_error() {
    errmsg.clear();
}

void add_result(filter_val *v, const filter_param_set *p) {
    result.add(v);
    result2params[v] = p;
}

bool get_result_params(filter_val *v, const filter_param_set *&p) {
    return map_get(result2params, v, p);
}

void remove_result(filter_val *v) {
    result.remove(v);
    result2params.erase(v);
}

void change_result(filter_val *v) {
    result.change(v);
}

filter_result *get_result() {
    return &result;
}

bool update() {
    if (!input->update()) {
        set_error("Errors in input");
        result.clear();
        input->reset();
        return false;
    }

    if (!update_results()) {
        result.clear();
        input->reset();
        return false;
    }
    input->clear_changes();
    return true;
}

const filter_input *get_input() const {
    return input;
}

private:
virtual bool update_results() = 0;

filter_input *input;
filter_result result;
std::string errmsg;
std::map<filter_val*, const filter_param_set*> result2params;
};

/*
 This type of filter assumes a one-to-one mapping of results to input
 parameter sets. It's also assumed that each result is only dependent
 on one parameter set. This is in contrast to filters that perform some
 kind of quantification over its inputs; returning the closest object,
 for example.
*/
class map_filter : public filter {
public:
map_filter(filter_input *input) : filter(input) {}

/*
 All created filter_vals are owned by the result list and cleaned
 up there, so don't do it here.
*/
virtual ~map_filter() {}

/*
 Compute the result from parameters. If called with a new
 parameter set, res will be NULL, and the implementation should
 set it to a new filter_val object (which will be owned by the
 result list). Otherwise, res will point to a valid filter_val and
 the implementation should change its value. If the value is
 actually changed, the changed output argument should be set to
 true. The implementation should return false if an error occurs.
 */
virtual bool compute(const filter_param_set *params, filter_val *&res, bool &changed) = 0;

/*
 Some derived classes might allocate memory associated with each
 result. They should override this function so they know when
 to deallocate that memory.
*/
virtual void result_removed(const filter_val *res) { }

/*
 Sometimes the function that maps from parameter set to result
 is conditioned on things other than the parameter set, such as
 the state of the scene graph. A derived class that implements
 such a function should explicitly mark a result as needing to be
 recomputed even when its associated parameter set doesn't change.
*/
void mark_stale(const filter_param_set *s) {
    stale.push_back(s);
}

bool update_results() {
    const filter_input* input = get_input();
    std::vector<const filter_param_set*>::iterator j;

    for (int i = input->first_added(); i < input->num_current(); ++i) {
        filter_val *v = NULL;
        bool changed = false;
        if (!compute(input->get_current(i), v, changed)) {
            return false;
        }
        add_result(v, input->get_current(i));
        io_map[input->get_current(i)] = v;
    }
    for (int i = 0; i < input->num_removed(); ++i) {
        io_map_t::iterator r = io_map.find(input->get_removed(i));
        assert(r != io_map.end());
        result_removed(r->second);
        remove_result(r->second);
        io_map.erase(r);
    }
    for (int i = 0; i < input->num_changed(); ++i) {
        if (!update_one(input->get_changed(i))) {
            return false;
        }
    }
    for (j = stale.begin(); j != stale.end(); ++j) {
        if (!update_one(*j)) {
            return false;
        }
    }
    stale.clear();
    return true;
}

void reset() {}

private:
bool update_one(const filter_param_set *params) {
    filter_val *v = io_map[params];
    bool changed = false;
    if (!compute(params, v, changed)) {
        return false;
    }
    if (changed) {
        change_result(v);
    }
    return true;
}

typedef std::map<const filter_param_set*, filter_val*> io_map_t;
io_map_t io_map;
std::vector<const filter_param_set*> stale;
};

/*
 User-defined filters should derive from this class so that they don't
 have to work with filter_val* directly. Assumes that the filter only
 returns one type of result.
*/
template <typename T>
class typed_map_filter : public map_filter {
public:
typed_map_filter(filter_input *input) : map_filter(input) {}
virtual ~typed_map_filter() {}

virtual bool compute(const filter_param_set *params, bool adding, T &res, bool &changed) = 0;
virtual void result_removed(const T &res) { }

private:
bool compute(const filter_param_set *params, filter_val *&res, bool &changed) {
    bool success;
    T val;
    if (res != NULL) {
        success = get_filter_val(res, val);
        assert(success);
    }
    success = compute(params, res == NULL, val, changed);
    if (!success) {
        return false;
    }
    if (!res) {
        res = new filter_val_c<T>(val);
    } else {
        success = set_filter_val(res, val);
        assert(success);
    }
    return true;
}

void result_removed(const filter_val *res) {
    T val;
    bool success = get_filter_val(res, val);
    assert(success);
    result_removed(val);
}
};

...

#endif 
```

我还手动检查了递归包含，但没有找到。这段代码还可以在 linux 和 Mac OS X 上使用 gcc 编译（并且运行良好）；它也可以在 Mac OS X 上使用 clang 编译。Clang 的静态分析器也没有发现任何东西。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-02-08T18:13:51.667

（在问题编辑中回答。转换为社区 wiki 答案。请参阅[将问题的答案添加到问题本身时的适当操作是什么？](https://meta.stackoverflow.com/questions/267434/what-is-the-appropriate-action-when-the-answer-to-a-question-is-added-to-the-que)）

OP写道：

> 解决了。该问题最终成为包含问题。
> 
> ```
> cl /Fobuild\Core\SVS\src\filters\absval.obj /c Core\SVS\src\filters\absval.cpp /TP /nologo /EHsc /D _CRT_SECURE_NO_DEPRECATE /D _WIN32 /W2 /Z7 /DEBUG /D _USRDLL /ICore\shared /ICore\pcre /ICore\SoarKernel\src /ICore\ElementXML\src /ICore\KernelSML\src /ICore\ConnectionSML\src /ICore\ClientSML\src /ICore\CLI\src "/IC:\Program Files\Microsoft Visual Studio 10.0\VC\INCLUDE" "/IC:\Program Files\Microsoft SDKs\Windows\v7.0A\include" /ICore\SVS\src /ICore\SVS\src\filters /ICore\SVS\src\models /ICore\SVS\src\algorithms /ICore\SVS\eigen /ICore\SVS\bullet\include 
> ```
> 
> 对比
> 
> ```
> cl /Fobuild\Core\SVS\src\filters\absval.obj /c Core\SVS\src\filters\absval.cpp /TP /nologo /EHsc /D _CRT_SECURE_NO_DEPRECATE /D _WIN32 /W2 /Z7 /DEBUG /D _USRDLL /ICore\shared /ICore\pcre /ICore\SoarKernel\src /ICore\ElementXML\src /ICore\KernelSML\src /ICore\ConnectionSML\src /ICore\ClientSML\src /ICore\CLI\src /ICore\SVS\src /ICore\SVS\src\filters /ICore\SVS\src\models /ICore\SVS\src\algorithms /ICore\SVS\eigen /ICore\SVS\bullet\include "/IC:\Program Files\Microsoft Visual Studio 10.0\VC\INCLUDE" "/IC:\Program Files\Microsoft SDKs\Windows\v7.0A\include" 
> ```
> 
> 不知何故，一个 Windows 标题正在弄乱包含并创建一个导致此问题的问题。

# django - Gondor 抱怨无法导入设置

> ID：11320338
> 
> 赞同：1
> 
> 时间：2012-07-03T22:55:59.733
> 
> 标签：django

我试图在 Gondor 上创建一个新应用程序，但我收到了这个错误：

```
Error: Could not import settings 'dt.conf.production' (Is it on sys.path?): No module named dt.conf.production. 
```

但是，我确认该文件存在，甚至在 shell 中成功地“从 dt.conf 导入生产”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-03T22:56:01.543

这里有两个问题。在这里，他们的尴尬程度越来越高。

首先，确保您已将父目录添加到 sys.path。您的 wsgi.py 文件应如下所示：

```
import os
import sys

os.environ.setdefault("DJANGO_SETTINGS_MODULE", "dt.conf.production")

# Add parent dir to path
sys.path.insert(0, os.path.abspath(
    os.path.join(os.path.abspath(os.path.dirname(__file__)),
    os.pardir)))

from django.core.wsgi import get_wsgi_application
application = get_wsgi_application() 
```

其次，这是杀死我的那个，请记住，当您调用 gondor deploy 时，它将占用您存储库中的任何内容。所以，就我而言，我必须这样做

```
git add conf
git commit 
```

然后做

```
gondor deploy primary master 
```

希望能帮助到你！

# svn - VisualSVN、SVN 锁和数据集

> ID：11320341
> 
> 赞同：1
> 
> 时间：2012-07-03T22:56:07.043
> 
> 标签：svn, dataset, tortoisesvn, visualsvn

我们正在使用 Visual SVN 和 VS2010，我们有一个包含多个数据集的数据项目。为避免不得不尝试合并 XSD 文件，我们将它们设置为需要锁定，因此一次只有一个人可以编辑。

唯一的问题是，当有人在设计器中扩展 TableAdapters 和 DataTables 时，它要求锁定，我已经从“requires-lock”属性中排除了布局文件（xss，xsc），但仍然要求锁定。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T12:27:12.943

这可能是一个错误。设计师很可能要求使用 svn:needs-lock 编辑文件，这就是 VisualSVN 要求您锁定文件的原因。

请在以下网址向我们提供有关此问题的详细报告：http: [//www.visualsvn.com/support/feedback/](http://www.visualsvn.com/support/feedback/) 请注意，详细的复制脚本将有助于我们快速调查和解决此问题。

# ios - 使用 AVFoundation 的 AVCaptureSession 捕获静止图像很慢（iPhone 4S 相机）

> ID：11320342
> 
> 赞同：1
> 
> 时间：2012-07-03T22:56:18.157
> 
> 标签：ios, performance, image, avfoundation, avcapturesession

使用 .拍摄静止图像时遇到性能问题`AVCaptureSession`。对于较大的图像（在 iPhone 4S 上），该`captureStillImageAsynchronouslyFromConnection`方法`AVCaptureStillImageOutput`似乎很慢。`AVCaptureSessionPresetPhoto`虽然它适用于较低的预设/分辨率（包括 iPod touch 的相机）。我还尝试了 WWDC 示例代码 AVCam，并且从拍摄照片到我可以在`UIImageView`. 有没有比`UIImage`从`NSData`（得到`[AVCaptureStillImageOutput jpegStillImageNSDataRepresentation:imageSampleBuffer]`）更快、更有效的方法？

我也可以显示正在处理图像的 HUD 消息或设置较低质量的预设，但实际上我什至遇到延迟的事实让我很烦。

顺便提一下 - 我还在用户拍摄图像后裁剪/调整图像大小，这会增加一点延迟，但不会太多。

感谢所有建议/回答者！

# machine-learning - 机器学习——哪种方法最适合从各种重要的特征中预测离散的、连续的解决方案？

> ID：11320344
> 
> 赞同：3
> 
> 时间：2012-07-03T22:56:35.810
> 
> 标签：machine-learning, feature-selection

我需要想出一个公式，该公式最多需要 N 个输入并计算一个应该尽可能多地预测“正确”答案的数字。每个输入都是十进制值或整数。输出也是十进制值。

我有大量荒谬的数据（认为它是无限的）。在每种情况下，我都有所有输入的值和输出的正确值。

这些特征都是相互关联的（即，当一个高时另一个更可能低）并且它们与答案具有不同程度的相关性。

没有“完美”的公式，但应该有一个在许多具有统计意义的情况下都适用。如果我有一个“最佳”解决方案，它可能既是非线性的又是离散的。然而，这是一次性计算。

哪种机器学习解决方案最适合利用这些特征并创建一个准确的模型来表示如此复杂的、有点随机的数据？

编辑：做一些更多的研究似乎任何类型的线性回归都会失败。神经网络看起来是最好的选择，但我不知道他们是否可以预测这种在不同范围内具有不同公式的“离散”函数。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-08T07:09:07.243

拥有几乎无限量的训练和测试数据是一个巨大的优势。线性回归*不太*可能对您描述的不规则函数有用，但在完全注销之前，您可能希望查看派生特征而不是输入本身的回归。径向偏置函数有时可以代替您的基本 N 输入或作为其补充。

然而，我的建议是看一下回归树，尤其是随机森林。

回归树基本上是决策树，它从根开始，对 N 个输入中的一个进行比较以选择要遵循的分支。这一直持续到您到达具有与其关联的线性模型的树的叶子。在最简单的情况下，这可能只是一个常数值函数，表示在该叶子中结束的数据的平均值，但更复杂的学习算法将尝试为叶子选择一个线性模型，这将最小化叶子的预期平方误差（例如对 N 个输入值的某个子集进行岭回归）。

回归树对您的问题的优势在于，树将您的输入划分为可以应用不同公式的不同区域。有了足够的区域，线性函数可以逼近非常复杂的函数。

回归树确实有一些问题。模型在定义区域的决策边界附近的行为可能会出现数据不支持的不切实际的跳跃。此外，他们可能有一些统计问题。通过使用随机森林，这两个问题都得到了极大的缓解。

随机森林中的每棵树都是由一组唯一的引导数据创建的。通常，此引导程序集是通过从训练数据中获取带有替换的随机样本来创建的，但在您的独特情况下，您可以通过获取新的随机训练数据集来创建森林中的每棵树来改进这一点。然后在树的生长过程中，在每个节点处分支树的决策变量在该唯一节点处被限制为 N 个变量的随机子集。由于森林中的每棵树都是从不同的数据集创建的，并且可能在不同的数据上分支，因此回归树的弱点是分布的。为了进行预测，将输入提供给森林中的每棵树，并通过对所有树的结果进行平均来获得答案。这也回避了回归树可能存在的统计问题。

随机森林广受好评，是许多测试问题较好的回归技术之一。

（参见《统计学习要素：数据挖掘、推理和预测》第 2 版。- Trevor Hastie、Robert Tibshirani、Jerome Friedman、Springer 2008。）

或者更窄一点，Microsoft 技术报告决策森林用于分类、回归、密度估计、流形学习和半监督学习，[http://research.microsoft.com/pubs/155552/decisionForests_MSR_TR_2011_114.pdf](http://research.microsoft.com/pubs/155552/decisionForests_MSR_TR_2011_114.pdf)

# image - ExtJS 4：表单字段中的图像？

> ID：11320348
> 
> 赞同：3
> 
> 时间：2012-07-03T22:56:54.453
> 
> 标签：image, forms, extjs, extjs4

我有一个包含如下字段的表单：

```
items: [{
    fieldLabel: 'Name',
    name: 'name'
},{
    fieldLabel: 'Description',
    name: 'description'
},{
    xtype: 'field',
    fieldLabel: 'Icon',
    name: 'icon',
    fieldSubTpl: new Ext.XTemplate('<img src="images/icons/{value}"/>')
}] 
```

我正在尝试根据加载的记录中的值在表单中显示图像。因此，如果`icon`equals `'test.png'`，则`images/icons/test.png`应该加载。关于最好的方法的任何线索？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T09:08:12.727

我会为此创建一个自定义字段，这是一个小的开始代码，这还行不通，但会让你朝着正确的方向前进：

```
Ext.define('Ext.ux.field.ImageField', {
    extend: 'Ext.form.field.Base',
    alias: 'widget.imagefield',
    fieldSubTpl: ['<img id="{id}" class="{fieldCls}" src="images/icons/{value}" />', {
        compiled: true,
        disableFormats: true
    }],

    fieldCls: Ext.baseCSSPrefix + 'form-image-field',
    value: null,

    initEvents: function () {
        this.callParent();

        //Adding the click event (can make other events here aswell)
        this.inputEl.on('click', this._click, this, {
            delegate: 'img.form-image-field'
        });

    },

    setValue: function (v) {
        var me = this;
        me.callParent(arguments);

        //Change ur image value here...
    },

    onRender: function () {
        var me = this;
        me.callParent(arguments);

        var name = me.name || Ext.id();

        me.hiddenField = me.inputEl.insertSibling({
            tag: 'input',
            type: 'hidden',
            name: name
        });

        me.setValue(me.value);
    },

    _click: function (e, o) {
        this.fireEvent('click', this, e);
    }
}); 
```

# c# - 从 Moq 返回计算值并传入多个值

> ID：11320353
> 
> 赞同：0
> 
> 时间：2012-07-03T22:57:21.960
> 
> 标签：c#, .net, unit-testing, mocking, moq

在我的一些单元测试中，我试图返回使用 Moq 作为参数传递的字符串。

如果我要求它返回一个指定的字符串，例如“home.aspx”，它将起作用。

```
var navMock = new Mock<INavigationService>();
navMock
    .Setup(x => x.GetUrlForSystem(It.IsAny<NavigationService.System>(), It.IsAny<string>()))
    .Returns("home.aspx"); 
```

但是，当要求它返回参数时，我收到一个

> System.Reflection.TargetParameterCountException ：参数计数不匹配。

```
var navMock = new Mock<INavigationService>();
navMock
    .Setup(x => x.GetUrlForSystem(It.IsAny<NavigationService.System>(), It.IsAny<string>()))
    .Returns((string s) => s); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-03T23:38:22.270

```
 var navMock = new Mock<INavigationService>();  
     navMock  
    .Setup(x => x.GetUrlForSystem(It.IsAny<NavigationService.System>(), It.IsAny<string>()))  
    .Returns((NavigationService.System n, string s) => s); 
```

# c# - 我将如何有效地制作假瓷砖阴影？

> ID：11320359
> 
> 赞同：7
> 
> 时间：2012-07-03T22:57:50.883
> 
> 标签：c#, block

所以我正在制作一个基于瓷砖的游戏，我想在瓷砖上添加一些假阴影。这有点难以解释，所以我会用图片来做：

假设这是我的瓷砖世界：

![世界](../Images/b50f1ea560aca689adced3bc26d5f329.png)

我希望它有这样的阴影：

![阴影](../Images/4153e609dcd2c2b1f43d2526e97bf5be.png)

因为世界是基于瓦片的，所以我可以将所有阴影部分拆分为单独的图像：

![部分](../Images/61b99c900b9a6564d565cf5784d957a0.png)

但现在我不知道如何将它带到代码中。好吧，实际上我确实有一些想法，但它们非常乏味，而且它们不能以最佳方式工作。

我尝试了一个巨大的if语句......

```
bool ul = adjacentBlocks[0, 0] == Block.Type.Rock; //Upper Left
bool um = adjacentBlocks[1, 0] == Block.Type.Rock; //Upper Middle
bool ur = adjacentBlocks[2, 0] == Block.Type.Rock; //Upper Right

bool ml = adjacentBlocks[0, 1] == Block.Type.Rock; //Center Left
//bool cm = adjacentBlocks[1, 1] == Block.Type.Rock; //CURRENT BLOCK - NOT NEEDED
bool mr = adjacentBlocks[2, 1] == Block.Type.Rock; //Center Right

bool ll = adjacentBlocks[0, 2] == Block.Type.Rock; //Lower Left
bool lm = adjacentBlocks[1, 2] == Block.Type.Rock; //Lower Middle
bool lr = adjacentBlocks[2, 2] == Block.Type.Rock; //Lower Right

if (ml) { texture = "Horizontal"; flipX = false; flipY = false; }
if (mr) { texture = "Horizontal"; flipX = true;  flipY = false; }
if (um) { texture = "Vertical"; flipX = false; flipY = false; }
if (lm) { texture = "Vertical"; flipX = false; flipY = true; }
if (ml && ul && um) texture = "HorizontalVertical";
//More if statements I can't be bothered to write
if (ul && um && ur && ml && mr && ll && lm & lr) texture = "Full"; 
```

还有一个庞大的查找表...

```
var table = new List<TextureBlockLayout>
                                        {
                                            new TextureBlockLayout("Horizontal", false, false, new[,]
                                                                                         {
                                                                                             { true, true, false },
                                                                                             { true, true, false },
                                                                                             { true, true, false }
                                                                                         }),
                                            new TextureBlockLayout("Horizontal", true, false, new[,]
                                                                                         {
                                                                                             { false, true, true },
                                                                                             { false, true, true },
                                                                                             { false, true, true }
                                                                                         }),
                                            new TextureBlockLayout("Full", false, false, new[,]
                                                                                         {
                                                                                             { true, true, true },
                                                                                             { true, true, true },
                                                                                             { true, true, true }
                                                                                         })
                                        }; 
```

但要么我做错了什么，要么他们根本拒绝工作。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-03T23:17:25.930

每个图块有八个邻居。每个邻居有两种可能的状态。将邻居的状态映射到一个字节中的位，并使用该字节作为索引到一个 256 元素的查找表中。

是的，这是“蛮力”解决方案，您可以使用一些更聪明的方法来解决一个小得多的表。但是 256 个元素并没有那么多（您可以轻松地从数据文件中加载它），而且这种方法的好处是它完全通用 - 如果您愿意，您可以让所有 256 个图块看起来略有不同。

* * *

好的，仔细看看您的示例图块的着色方式，看起来您真的只需要四个位（因此需要一个 16 元素表）：

1.  如果北、西和西北邻居都是绿色的，则设置该位。
2.  如果北部、东部和东北部的邻居都是绿色的，则设置该位。
3.  如果南、西和西南邻居都是绿色的，则设置该位。
4.  如果南部、东部和东南部的邻居都是绿色的，则设置该位。

即使这 16 个图块中的一些图块仍然是彼此的旋转/镜像版本，但将方向存储在图块索引旁边的表格中可能是最简单的，而不是尝试在代码中计算它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-03T23:28:30.097

我会尝试这样的事情：

```
struct surroundingTiles
{
    static bool blockNE;
    static bool blockN;
    static bool blockNW;
    static bool blockW;
    static bool blockSW;
    static bool blockS;
    static bool blockSE;
    static bool blockE;
}
foreach(object tile in floor)
{
    if(currentTile.surroundingTiles.blockW && currentTile.surroundingTiles.blockNW && currentTile.surroundingTiles.blockN)
        useTexture(currentTile, shadowSEtexture);
} 
```

# jfreechart - 将图例嵌入到 JFreeChart 的绘图区域中

> ID：11320360
> 
> 赞同：7
> 
> 时间：2012-07-03T22:58:11.237
> 
> 标签：jfreechart

在`JFreeChart`中，是否可以将图例嵌入图表本身？图例可以设置在图表的顶部、底部、左侧、右侧，如下所示，但是是否可以将其嵌入到图表中？

```
LegendTitle legend=chart.getLegend();
legend.setPosition(RectangleEdge.TOP); 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-04T07:37:45.497

[JFreeChart Samples](http://www.jfree.org/jfreechart/samples.html) 中包含了如何在 polt 中设置图例的示例`XYTitleAnnotationDemo1`，这是关键部分：

```
XYPlot plot = (XYPlot) chart.getPlot();
LegendTitle lt = new LegendTitle(plot);
lt.setItemFont(new Font("Dialog", Font.PLAIN, 9));
lt.setBackgroundPaint(new Color(200, 200, 255, 100));
lt.setFrame(new BlockBorder(Color.white));
lt.setPosition(RectangleEdge.BOTTOM);
XYTitleAnnotation ta = new XYTitleAnnotation(0.98, 0.02, lt,RectangleAnchor.BOTTOM_RIGHT);

ta.setMaxWidth(0.48);
plot.addAnnotation(ta); 
```

![在此处输入图像描述](../Images/2967938c0d46a69bfde4887e1b851d64.png)

# php - 将 URL 加载到父保留子中

> ID：11320364
> 
> 赞同：1
> 
> 时间：2012-07-03T22:58:28.120
> 
> 标签：php, forms, hyperlink

我想让这段代码在父页面中加载新的 URL 并像现在一样打开子页面......我该如何完成这个？

```
<form action="<?php echo $_SERVER['SCRIPT_NAME']; ?>" method="post" target="foo" onSubmit="window.open('', 'foo', 'width=1040,height=900,status=yes,resizable=yes,scrollbars=yes')"> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-03T23:07:29.803

```
<form action="<?php echo $_SERVER['SCRIPT_NAME']; ?>" method="post" target="foo" onSubmit="window.open('', 'foo', 'width=1040,height=900,status=yes,resizable=yes,scrollbars=yes'); document.location='http://google.com/'"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-03T23:08:43.810

您可以简单地将 Javascript 代码放在子窗口中，由 onLoad 触发（但这不是必需的），这会将 window.opener.location.href 设置为指向其他地方。

当您发布表单时，表单结果将在新窗口中打开，并且该窗口 .opener 属性应设置为父级（仍显示输入表单的页面）。然后子页面将能够知道它的父页面。

您可能会尝试将提交绑定到将打开新窗口并刷新当前页面的函数，但我已经混合（和浏览器相关）结果[编辑：我的结果很可能已经过时]

# c++ - InternetGetConnectedState 和 MSDN 的“它不应该从服务中使用”声明

> ID：11320366
> 
> 赞同：0
> 
> 时间：2012-07-03T22:58:42.910
> 
> 标签：c++, winapi, service, windows-services

我正在使用 C++ 和 WinAPI 编写 Windows 本地服务。在该服务中，我需要知道 Internet 连接是可用的（通常），所以我想出了[`InternetGetConnectedState`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa384346%28v=vs.85%29.aspx)API，但是在阅读了 MSDN 之后，我在备注部分找到了这个：

> 此外，不应从服务中使用它。

好吧，“谢谢”，微软！

有谁知道为什么以及我可以从服务中使用什么替代方案。

PS。我不想使用 ping 方法，因为显然无法知道我正在 ping 的站点是否已启动，因此它会打开一个全新的蠕虫罐。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-03T23:28:08.093

通常您不需要关心 Internet 是否可用，您只需尝试连接到该站点并处理任何故障。

# c++ - 在 C++ 中隐藏命名空间

> ID：11320367
> 
> 赞同：0
> 
> 时间：2012-07-03T22:58:46.107
> 
> 标签：c++, static, namespaces

我已经阅读了一些关于 SO 的其他类似问题的答案，这些答案似乎表明可以隐藏命名空间（为了隐藏实现细节），但他们没有说明如何。

因此，例如，如果我想要一个`namespace A`包含 a 的 a `namespace B`，并且`B`有一些令人讨厌的功能实现细节，`A`因为我希望对最终用户隐藏这些功能，那么我可以使用某种链接器技巧，以便`B`在 之外不可见`A`，但是`A`对程序的其余部分仍然可见？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-03T23:17:07.703

您似乎在谈论的是“Pimpl”模式和/或句柄/身体习语。或者你能想出的其他几个名字。一个非常简短的例子是在 boost [Smart Pointer](http://www.boost.org/doc/libs/1_50_0/libs/smart_ptr/shared_ptr.htm#Handle/Body)页面上。它解释了如何将具有不完整类型的类声明为智能指针，然后在其他地方定义实现。这对 API 用户“隐藏”了它，因为“内部”类的实现可以更改而无需库创建者以外的任何人重新编译，因为大小仅在实现中，而不在头文件中。只有“公共”类的大小是已知的，并且保持不变。通读这两个 .cpp 文件和一个 .hpp 文件，看看它为什么起作用。

我希望这与你正在尝试做的事情有关。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-03T23:20:16.920

命名空间的目的是避免名称冲突。这基本上就是全部了。它们不提供任何隐藏任何东西的功能。尽管在一定程度上他们强迫写作`namesp_name::sometinng`。这可能会让用户思考这是否值得做。

上面的评论所暗示的，基本上是将您的标头分为公共标头和私有标头。私有标头仅包含在您的 cpp 文件中，预计不会包含在上层代码中。这在许多情况下都有效，这很有帮助，但并不能解决所有问题。

# r - R 的 read.csv() 省略行

> ID：11320372
> 
> 赞同：4
> 
> 时间：2012-07-03T22:59:42.923
> 
> 标签：r, read.csv

在 R 中，我试图读取大约 42,900 行的基本 CSV 文件（由 Unix 的 wc -l 确认）。相关代码是

```
vecs <- read.csv("feature_vectors.txt", header=FALSE, nrows=50000) 
```

其中 nrows 稍微高估了，因为为什么不呢。然而，

```
>> dim(vecs)
[1] 16853     5 
```

表明生成的数据框有大约 17,000 行。这是内存问题吗？每行由一个~30 个字符的哈希码、一个~30 个字符串和3 个整数组成，所以文件的总大小只有4MB 左右。

如果它是相关的，我还应该注意到很多行都缺少字段。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-04T13:15:32.690

这类问题通常很容易解决`count.fields`，它会告诉您调用时生成的数据框会有多少列`read.csv`。

```
(n_fields <- count.fields("feature_vectors.txt")) 
```

如果不是所有 n_fields 的值都相同，那么您就有问题了。

```
if(any(diff(n_fields)))
{
  warning("There's a problem with the file")
} 
```

在这种情况下，请查看`n_fields`与您期望的值不同的值：问题出现在这些行中。

正如贾斯汀所说，一个常见的问题是不匹配的引号。打开你的 CSV 文件，看看那里的字符串是如何被引用的。然后调用`read.csv`，指定`quote`参数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-04T14:40:52.833

我的猜测是你嵌入了 unmatched `"`。所以你的一些行实际上比它们应该的长得多。我会做一些`apply(vecs, 2, function(x), max(nchar(as.character(x)))`检查。

# sencha-touch-2 - 如何获得参考并采取行动？煎茶触控2.0

> ID：11320374
> 
> 赞同：1
> 
> 时间：2012-07-03T22:59:44.800
> 
> 标签：sencha-touch-2

代码如下所示。我正在尝试实现一个简单的聊天应用程序，这里的列表是 msgs 的内存存储。我发现`this.getMsgList().add([myPanel]);`列表之后仍然没有新项目。

我正在寻找获取 msgList 引用并向其中添加新引用的正确方法（希望是 imm）

```
Ext.define('Chat.controller.Main', {
extend: 'Ext.app.Controller',

views: ['MainView'],

config: {
    refs: {
        msgBox: '#msgBox',
        msgList: '#msgList'
    }
},

    init: function () {
    console.log('controller inited.')
    this.control({
        'button[action=submitMsg]':{
            tap: 'submitMsgToServer'
        }
    });
},

submitMsgToServer: function() {
    console.log('submitMsgToServer')
    var msg = this.getMsgBox()
    //Ext.Msg.alert(msg)
    //console.log(this.getMsgBox())
    var myPanel = Ext.create('Ext.Panel', {
        data: [ {string: msg} ]
    });

    this.getMsgList().add([myPanel]);
    console.log(this.getMsgList())
} 
```

});

msgList 在这里定义：

```
Ext.define('Chat.view.MainView', {
extend: 'Ext.Panel',

config: {

    layout: {
        type: 'fit'
    },

    items: [
        {
            docked: 'top',
            xtype: 'titlebar',
            title: 'Chat'
        },
        {
            docked: 'bottom',
            xtype: 'toolbar',
            items: [
                { 
                    xtype: 'textfield', 
                    id: 'msgBox'
                },
                { 
                    xtype: 'button',
                    ui: 'confirm',
                    text: 'send',
                    action: 'submitMsg'
                }
            ]
        },
        {
            xtype: 'list',
            id: 'msgList',
            itemTpl: [
                '<div>List Item {string}</div>'
            ],
            data: [
                        { string: 'Item 1' },
                        { string: 'Item 2' }
            ]
        }
    ]

} 
```

});

# javascript - jquery是否存在父级

> ID：11320375
> 
> 赞同：0
> 
> 时间：2012-07-03T22:59:45.717
> 
> 标签：javascript, jquery

我需要知道父母是否存在，然后我需要这样做。这是代码：

```
if ($('#block-slides p a img.alignleft').parent().length) {
        $(this).parent().parent().css({'max-width' : '100%', 'padding' :   '0'}).addClass('clearfix');
    } else {
        $('#block-slides p img.alignleft').parent().css({'max-width' : '100%', 'padding' : '0'}).addClass('clearfix');
    } 
```

但什么也没有发生。请问有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-03T23:07:16.117

...如果您只是在寻找`<p>`-element，请尝试：

```
$('#block-slides img.alignleft').closest('p').css({.....}); 
```

[http://api.jquery.com/closest/](http://api.jquery.com/closest/)

# svn - 如何将项目链接到 svn 存储库？

> ID：11320383
> 
> 赞同：1
> 
> 时间：2012-07-03T23:00:44.403
> 
> 标签：svn

我已经`svn` `/home/svn/repository/project`在`/tmp/svn-structure-template`.

我有一个项目`/home/project`。如何将其链接到存储库、主干和分支？

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-03T23:08:01.690

新项目的初始设置通常通过以下方式完成

变体“a”（远程 mkdir）

1.  svnadmin 创建 /path/to/repo
2.  svn mkdir -m '初始设置' file:///path/to/repo/trunk
3.  svn mkdir -m '初始设置' file:///path/to/repo/branches
4.  svn mkdir -m '初始设置' file:///path/to/repo/tags
5.  cd /my/working/area && svn co -depth infinity file:///path/to/repo/trunk
6.  cd后备箱
7.  享受结果

变体“b”（本地 mkdir）

1.  svnadmin 创建 /path/to/repo
2.  cd /my/working/area && svn co -depth infinity file:///path/to/repo
3.  光盘回购
4.  svn mkdir 树干标签 分支
5.  svn commit -m '初始设置'
6.  cd后备箱
7.  享受结果

创建存储库的工作副本后，可以将新文件/目录放入工作副本并使用“svn add”+“svn commit”将其添加到版本控制中。

或者，可以使用“svn import”将目录树直接上传到指定 url 下的存储库。

# javascript - html5 canvas pacman 游戏 - javascript 太多递归

> ID：11320384
> 
> 赞同：2
> 
> 时间：2012-07-03T23:00:46.873
> 
> 标签：javascript, html, canvas, recursion

我一直在做一个有趣的小项目来定制 dale harvey 的 html5 canvas pacman 游戏[http://arandomurl.com/2010/07/25/html5-pacman.html](http://arandomurl.com/2010/07/25/html5-pacman.html)并同时自学一些 javascript . 但是玩游戏几秒钟后它会冻结......我相信这是因为递归过多（即需要关闭某些东西？）但我的印象是游戏循环需要保持打开状态以允许连续控制和人物的动作……对吗？

我在 javascript 游戏中有点菜鸟，所以任何帮助都会很棒。

[http://bridgestreetcollective.harmonyapp.com/pacman/?password=test](http://bridgestreetcollective.harmonyapp.com/pacman/?password=test)

干杯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-03T23:10:04.790

你似乎在递归调用移动，我的意思是你的调用移动内部移动。这就是您的调用堆栈变得太大的原因。

您应该有一个游戏循环，您可以从其中调用移动，而不是从内部调用移动。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-03T23:11:37.877

你的`clone`功能搞砸了。您在某处的文档`body`元素上调用它，并且具有循环引用。您应该能够使用调试器看到这一点。请参阅[如何在 Javascript 中克隆对象数组？](https://stackoverflow.com/q/597588/1048572)和[在 Javascript 中，当执行深层复制时，由于属性是“this”，我如何避免循环？](https://stackoverflow.com/q/10728412/1048572).

此外，你[永远不应该使用 Object.prototype](https://stackoverflow.com/q/8341123/1048572)。

# c# - 自定义过滤 OpenFileDialog

> ID：11320387
> 
> 赞同：0
> 
> 时间：2012-07-03T23:01:43.270
> 
> 标签：c#, .net, winforms, openfiledialog

我正在尝试制作一个允许用户查看 PictureBox 中的图标的程序。我希望用户只能打开 24x24 像素的图像。

我想在 OpenFileDialog 中放置一个过滤器，只显示 24x24 的图像。有没有办法做到这一点？我听说可以通过自定义 OpenFileDialog 和使用 P/Invoke 来实现。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-03T23:04:56.807

您可以检查图像的`Width`和`Height`：

```
// 'image' is the image you want to check
if(image.Width > 24 || image.Height > 24)
    MessageBox.Show("Please select a smaller image!");
else
    // This code will always run if the image is smaller than 24x24 
```

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-03T23:08:18.210

如果您通过将其存储为对象（我假设您是）来读取它，您只需要读取 imageObject.Width “使用 System.Drawing;” 或“使用 System.Drawing.Image；”

[这里](https://stackoverflow.com/questions/111345/getting-image-dimensions-without-reading-the-entire-file)和[这里](http://imar.spaanjaars.com/234/measuring-the-size-of-an-image-with-c-sharp)的例子。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-03T23:09:53.887

你不能用 OpenFileDialog 做到这一点。您需要编写自己的对话框来询问每个文件夹中的文件并确定它们是否符合您的条件，然后仅显示这些文件。

# internationalization - Yii - 使用什么方法来处理这个日期变化？

> ID：11320393
> 
> 赞同：0
> 
> 时间：2012-07-03T23:02:30.400
> 
> 标签：internationalization, yii

我不知道在哪里做这个。这是我的配置文件的一部分：

```
'basePath'=>dirname(__FILE__).DIRECTORY_SEPARATOR.'..',
    'name'=>'myApp',
        'defaultController' => 'event/index', //events as default
        'language'=>'pt',
        'timeZone'=>'Europe/Lisbon',
        'localeDataPath'=>dirname(__FILE__).'/../data/i18n',

   'components'=>array(
            'format' => array(
                    'datetimeFormat' => 'dd/mm/yyyy hh:mm',
                    'dateFormat' => 'dd/mm/yyyy',
                    'timeFormat' => 'hh:mm',
            ), 
```

所以：我将日期作为字符串检索，如下所示：

```
'2010-11-02' 
```

所以我需要将此字符串转换为： 02-11-2010 。

我试过这个：

```
Yii::app()->format->formatDate($data); 
```

我得到：

> “遇到格式不正确的数值”

为什么 ？

：秒

更新：使用：yii::app()->dateFormatter->format('dd', $data); //返回当天；使用：yii::app()->dateFormatter->format('MMMM', $data); //返回月份；

工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T07:29:26.077

我们在配置中：

```
 'components' => array(
       'format' => array(
            'datetimeFormat' => 'm/d/Y h:i A',
            'dateFormat' => 'm/d/Y',
            'timeFormat' => 'h:i A',
        ), 
```

我们像这样使用：

你可以`Yii::app()->format`用来格式化

# css - 如何使用 Chrome 调试器与 @font-face 定义进行交互？

> ID：11320394
> 
> 赞同：18
> 
> 时间：2012-07-03T23:02:44.330
> 
> 标签：css, font-face, google-chrome-devtools

使用 CSS 时，我真的很喜欢能够使用 Web 检查器添加新规则并以交互方式编辑现有规则。但是，我不知道如何使用[@font-face](https://developer.mozilla.org/en/CSS/@font-face)规则

1.  **在哪里可以查看样式表中的@font-face 规则是否已被识别并生效？**

    例如，如果我有一个带有“div.foo”选择器的规则，那么我所要做的就是检查页面上具有类 foo 的任何 div，以便查看规则生效并实时编辑其值。

2.  **如何以交互方式添加新的 @font-face 规则？**

    每当我尝试通过“新样式规则”按钮（带有 + 符号的那个）添加一个时，Chrome 就会崩溃。它与选择器上奇怪的“@”有关吗？无论如何，“@”是什么意思？

我正在使用 Chrome 19，因为我最喜欢它的调试器，但如果这是唯一的可能性，我不介意使用其他浏览器。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-04T00:02:34.833

**(1)**我认为你不能。@font-face 只是将新字体添加到可用字体集中。给定一个具有 的元素，`font-family: Foo`开发工具似乎没有提供有关字体来源的任何信息（无论是在本地可用还是通过 @font-face 规则下载）。您必须在页面样式表中手动搜索@font-face 规则，并记下哪些字体名称是“外部”的。（您可以通过转到开发工具的“资源”选项卡并在搜索框中输入“@font-face”来做到这一点。）

顺便说一句，您可以通过转到开发工具中的“资源”选项卡并展开字体目录来查看网页可用的外部字体文件。此目录中的每个文件代表一个@font-face 规则。

**(2)**不能使用“新样式规则”方法，因为@font-face 不是样式规则，而是at 规则。为了在网页中添加@font-face 规则，请转到开发工具中的“资源”选项卡，在 Stylesheets 目录中选择样式表（.css 文件），然后复制粘贴@font-面规则到该样式表中。现在，您可以立即在`font-family`属性中开始使用新添加的字体名称。

# c++ - Xorg 选择剪贴板

> ID：11320397
> 
> 赞同：0
> 
> 时间：2012-07-03T23:03:04.173
> 
> 标签：c++, c, linux, clipboard, x11

在过去的 2 个小时里，我一直在努力在 Xorg API 文档中找到与“选择”相关的任何内容。我正在寻找一种方法来检索 Xorg PRIMARY 选择的内容（如果你愿意，也可以使用剪贴板。）

我找到了头文件 /usr/include/X11/SelectionI.h 但无法以任何方式使用它。

谢谢你的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T00:17:42.610

如果您有一个特定的问题，并且联机帮助页没有回答，那么 SO 是一个很好的资源。但是，如果您只是不明白，请查找 HOWTO。

如果您想了解 X11 选择的工作原理，请参阅[X Windows Copy-Paste mini HOWTO](http://michael.toren.net/mirrors/doc/X-copy+paste.txt)。这包括示例代码，“如果在任何应用程序中选择了文本，每两秒钟将通知我们有关应用程序中所选文本的信息”，这听起来非常接近您想要做的事情。

您的机器上应该有完整的 Xlib 文档。如果没有，这里有一个[HTML 版本](http://tronche.com/gui/x/xlib/window-information/selection.html)。

当然，您应该拥有每个功能的联机帮助页。如果没有，例如“man XGetSelectionOwner”的 google 几乎肯定会为您提供大多数热门歌曲的各种不同的 HTML 版本。

但是，如果您只是学习 X11，我强烈建议您不要学习 Xlib；选择包装它的更高级别的库之一。

# php - PHP RegEx 防止重复字符

> ID：11320402
> 
> 赞同：2
> 
> 时间：2012-07-03T23:03:36.557
> 
> 标签：php, regex

```
if(preg_match("%(?=.{8})[A-Za-z0-9]([.-]{0,1})%", stripslashes(trim($_POST['username'])))) 
```

我希望用户名至少是 8 个字符 A-Za-z0-9 ，只有 1 。或 1 - 。我该如何实施？我的代码允许“.......”的用户名有效。<-不想那样。

顺便说一句：“。” 或“-”是可选的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-03T23:11:45.723

有时，正则表达式并不是适合这项工作的工具。

```
$username = stripslashes(trim($_POST['username']));

if(preg_match('/^[a-zA-Z0-9.-]{8,}$/', $username)
&& substr_count($username, '-') <= 1
&& substr_count($username, '.') <= 1) {
    # It's valid.
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-03T23:14:33.133

一个快速的补丁是在第一次检查后计算这些字符。

IE，

```
 if (strlen(preg_replace("#[^.-]#", '', $username)) > 2)
     // Not valid. 
```

这不是您要求的支票，这将 .'s 和 -'s 一起计算，因此两个点或两个破折号将被视为有效。但它可以快速轻松地扩展到更多字符。

# flash - 在 Flash Professional CS6 中为 Flash 10.1 编译

> ID：11320405
> 
> 赞同：10
> 
> 时间：2012-07-03T23:04:15.430
> 
> 标签：flash, adobe, samsung-smart-tv, flash-10

我目前正在为三星智能电视开发一个项目。

这个项目需要 Flash，如果我想在电视上使用 Flash 10.1，需要编译规范。但是，我正在查看 Flash Professional CS6 中的发布选项，我只能选择 10.3，而不是 10、10.1 或 Flash 10 的任何其他子版本。（我可以选择 Flash 9 、8、11 等等）。

有没有办法强制 CS6 为 Flash 10.1 编译？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-07-04T02:00:51.293

让我先声明我没有 CS6；但是，我认为这与在以前的版本中覆盖播放器相同。

1.  您需要下载 10.1 playerglobal.swc，该文件可从[Adob​​e 的存档 Flash Player 版本站点获得。](http://helpx.adobe.com/flash-player/kb/archived-flash-player-versions.html)

2.  将 playerglobal.swc 放在 Flash Pro CS6 安装路径中的 FP10.1 文件夹中 /Common/Configuration/ActionScript 3.0/FP10.1/playerglobal.swc

    示例：/Applications/Adobe Flash CS6/Common/Configuration/ActionScript 3.0/FP10 .1

3.  创建发布目标 XML 以在 Flash Pro 的发布设置对话框下拉列表中添加 Flash Player 10.1 选项。这些位于 /Common/Configuration/Players/

    示例： /Applications/Adobe Flash CS5.5/Common/Configuration/Players/FlashPlayer10_1.xml

    复制并粘贴现有的 Flash Player 10 XML 作为模板；或者，它应该是这样的：

    ```
    <?xml version="1.0" encoding="UTF-8"?>
    <players>
        <player id="FlashPlayer10" version="10" asversion="3">
            <name>Flash Player 10 & 10.1</name>
            <path builtin="true" />
            <path platform="WIN">Device Central/adcdl.exe</path>
            <path platform="MAC">Device Central/adcdl</path>
            <playerDefinitionPath
                as2="$(UserConfig)/Classes/FP10;$(UserConfig)/Classes/FP9;$(UserConfig)/Classes/FP8;$(UserConfig)/Classes/FP7"
                as3="$(AppConfig)/ActionScript 3.0/FP10/playerglobal.swc" />
            <feature name="multiScreenPublish" supported="true" />
            <feature name="mobileAuthoringIntegration" supported="true" />
            <feature name="deviceSound" supported="false" />
            <feature name="exportStreamingSound" supported="true" />
            <feature name="exportEventSound" supported="true" />
            <feature name="FSCommand2" supported="false" />
            <feature name="gradient_linearRGB" supported="true" />
            <feature name="gradient_overflow" supported="true" />
            <feature name="shape_strokeHint" supported="true" />
            <feature name="shape_cap" supported="true" />
            <feature name="shape_join" supported="true" />
            <feature name="shape_mitre" supported="true" />
            <feature name="shape_scale" supported="true" />
            <feature name="linkage_exportForActionscript" supported="true" />
            <feature name="linkage_exportForRuntimeSharing" supported="true" />
            <feature name="linkage_exportInFirstFrame" supported="true" />
            <feature name="linkage_importForRuntimeSharing" supported="true" />
            <feature name="linkage_importAndAddToCache" supported="false" />
            <feature name="publish_localPlaybackSecurity" supported="true" />
            <feature name="publish_hardwareAcceleration" supported="true" />
            <feature name="symbol_blendMode" supported="true" />
            <feature name="actionScript_documentClass" supported="true" />
            <feature name="symbol_blendMode" supported="true" />
            <feature name="filters" supported="true" />
            <feature name="component_binding" supported="true" />
            <feature name="component_schema" supported="true" />
            <feature name="screens" supported="true" />
            <feature name="video" supported="true" />
            <feature name="deviceVideo" supported="false" />
            <feature name="accessibility" supported="true" />
            <feature name="dynamic_text_kerning" supported="true" />
            <feature name="static_text_charwidth_nondeviceFont" supported="true" />
            <feature name="static_text_charwidth_deviceFont" supported="true" />
            <feature name="advanced_anti_alias_text" supported="true" />
            <feature name="nine_slice_scaling" supported="true" />
            <feature name="runtimeNumberMinMax" supported="true" />
            <feature name="use8kSampleRate" supported="true" />
            <feature name="useDefineFont4ForDeviceText" supported="true" />
            <feature name="useDefineFont4ForEmbeddedFonts" supported="true" />
            <feature name="textLayoutFramework" supported="true" />
            <encodingPresets>
                <preset uuid="da5cac1a-417a-4d86-b7f7-ef21010a5d7d" name="FLV - Match Source Attributes (High Quality)"
                    ext="flv" default="true" />
            </encodingPresets>

            <testmenu>
                <menu name="ID_testInFlash" default="true" />
                <menu name="ID_testInDeviceCentral" />
            </testmenu>

            <debugmenu>
                <menu name="ID_debugtInFlash" default="true" />
                <menu name="ID_debugInDeviceCentral" />
            </debugmenu>

        </player>
    </players> 
    ```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-05T01:11:33.850

杰森上面的回答是完美的——只有一点点改变——确保这条线

```
as3="$(AppConfig)/ActionScript 3.0/FP10/playerglobal.swc" 
```

匹配您安装 playerglobal.swc 的路径 - 即 Jason 示例中的 FP10.1，而不是 FP10

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-10-17T15:32:34.100

对于 Adob​​eFlash CC xml 文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<players>
    <player id="FlashPlayer10" version="10" asversion="3">
        <name>Flash Player 10.1</name>
        <path builtin="true" />
        <path platform="WIN">Device Central/adcdl.exe</path>
        <path platform="MAC">Device Central/adcdl</path>
        <playerDefinitionPath
            as2="$(UserConfig)/Classes/FP10;$(UserConfig)/Classes/FP9;$(UserConfig)/Classes/FP8;$(UserConfig)/Classes/FP7"
            as3="$(AppConfig)/ActionScript 3.0/FP10.1/playerglobal.swc" />
        <feature name="multiScreenPublish" supported="true" />
        <feature name="mobileAuthoringIntegration" supported="true" />
        <feature name="deviceSound" supported="false" />
        <feature name="exportStreamingSound" supported="true" />
        <feature name="exportEventSound" supported="true" />
        <feature name="FSCommand2" supported="false" />
        <feature name="gradient_linearRGB" supported="true" />
        <feature name="gradient_overflow" supported="true" />
        <feature name="shape_strokeHint" supported="true" />
        <feature name="shape_cap" supported="true" />
        <feature name="shape_join" supported="true" />
        <feature name="shape_mitre" supported="true" />
        <feature name="shape_scale" supported="true" />
        <feature name="linkage_exportForActionscript" supported="true" />
        <feature name="linkage_exportForRuntimeSharing" supported="true" />
        <feature name="linkage_exportInFirstFrame" supported="true" />
        <feature name="linkage_importForRuntimeSharing" supported="true" />
        <feature name="linkage_importAndAddToCache" supported="false" />
        <feature name="publish_localPlaybackSecurity" supported="true" />
        <feature name="publish_hardwareAcceleration" supported="true" />
        <feature name="symbol_blendMode" supported="true" />
        <feature name="actionScript_documentClass" supported="true" />
        <feature name="symbol_blendMode" supported="true" />
        <feature name="filters" supported="true" />
        <feature name="component_binding" supported="true" />
        <feature name="component_schema" supported="true" />
        <feature name="screens" supported="true" />
        <feature name="video" supported="true" />
        <feature name="deviceVideo" supported="false" />
        <feature name="accessibility" supported="true" />
        <feature name="dynamic_text_kerning" supported="true" />
        <feature name="static_text_charwidth_nondeviceFont" supported="true" />
        <feature name="static_text_charwidth_deviceFont" supported="true" />
        <feature name="advanced_anti_alias_text" supported="true" />
        <feature name="nine_slice_scaling" supported="true" />
        <feature name="runtimeNumberMinMax" supported="true" />
        <feature name="use8kSampleRate" supported="true" />
        <feature name="useDefineFont4ForDeviceText" supported="true" />
        <feature name="useDefineFont4ForEmbeddedFonts" supported="true" />
        <feature name="textLayoutFramework" supported="true" />
        <encodingPresets>
            <preset uuid="da5cac1a-417a-4d86-b7f7-ef21010a5d7d" name="FLV - Match Source Attributes (High Quality)"
                ext="flv" default="true" />
        </encodingPresets>

        <testmenu>
            <menu name="ID_testInFlash" default="true" />
            <menu name="ID_testInDeviceCentral" />
        </testmenu>

        <debugmenu>
            <menu name="ID_debugtInFlash" default="true" />
            <menu name="ID_debugInDeviceCentral" />
        </debugmenu>

    </player>
</players> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-19T04:45:58.263

完全按照上面两个答案。有关进一步的步骤和参考，请点击以下链接，

[http://blog.prevail.co.nz/2011/06/21/overlaying-air2-7-in-flash-cs5/comment-page-2/#comment-1803](http://blog.prevail.co.nz/2011/06/21/overlaying-air2-7-in-flash-cs5/comment-page-2/#comment-1803)

[http://www.yeahbutisitflash.com/?p=2949&cpage=1#comment-67603](http://www.yeahbutisitflash.com/?p=2949&cpage=1#comment-67603)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-08-22T09:36:45.797

只需在 Mac 上为 Flash CC 添加 playerglobal.swc FP10.2。

需要这个来对 DoubleClick for Advertisers 的 swf 版本问题进行排序，因为它不接受高于 11 的版本。播放器版本和 swf 版本不再同步。

```
Flash Player 9 = swf version 9
Flash Player 10 and 10.1 = swf version 10
Flash Player 10.2 = swf version 11
Flash Player 10.3 = swf version 12
Flash Player 11 = swf version 13 
```

为了自己做这件事，您需要进入“应用程序/Adobe Flash CC”。

右键单击 Flash CC 应用程序并选择“显示包内容”。

现在您需要找到以下文件夹：

/Applications/Adobe Flash CC/Adobe Flash CC.app/Contents/Common/Configuration/Players

您需要将 FlashPlayer10_3.xml 复制为 FlashPlayer10_2.xml 并替换文件中的相关详细信息。这对我有用：

```
<?xml version="1.0" encoding="UTF-8"?>
<players>
  <player id="FlashPlayer10.2" version="11" asversion="3">
   <name>Flash Player 10.2</name>
        <path builtin="true" />
        <path platform="WIN">Device Central/adcdl.exe</path>
        <path platform="MAC">Device Central/adcdl</path>
        <playerDefinitionPath as2="$(UserConfig)/Classes/FP10;$(UserConfig)/Classes/FP9;$(UserConfig)/Classes/FP8;$(UserConfig)/Classes/FP7" as3="$(AppConfig)/ActionScript 3.0/FP10.2/playerglobal.swc" />
        <feature name="multiScreenPublish" supported="true" />
        <feature name="mobileAuthoringIntegration" supported="true" />
        <feature name="deviceSound" supported="false" />
        <feature name="exportStreamingSound" supported="true" />
        <feature name="exportEventSound" supported="true" />
        <feature name="FSCommand2" supported="false" />
        <feature name="gradient_linearRGB" supported="true" />
        <feature name="gradient_overflow" supported="true" />
        <feature name="shape_strokeHint" supported="true" />
        <feature name="shape_cap" supported="true" />
        <feature name="shape_join" supported="true" />
        <feature name="shape_mitre" supported="true" />
        <feature name="shape_scale" supported="true" />
        <feature name="linkage_exportForActionscript" supported="true" />
        <feature name="linkage_exportForRuntimeSharing" supported="true" />
        <feature name="linkage_exportInFirstFrame" supported="true" />
        <feature name="linkage_importForRuntimeSharing" supported="true" />
        <feature name="linkage_importAndAddToCache" supported="false" />
        <feature name="publish_localPlaybackSecurity" supported="true" />
        <feature name="publish_hardwareAcceleration" supported="true" />
        <feature name="symbol_blendMode" supported="true" />
        <feature name="actionScript_documentClass" supported="true" />
        <feature name="symbol_blendMode" supported="true" />
        <feature name="filters" supported="true" />
        <feature name="component_binding" supported="true" />
        <feature name="component_schema" supported="true" />
        <feature name="screens" supported="true" />
        <feature name="video" supported="true" />
        <feature name="deviceVideo" supported="false" />
        <feature name="accessibility" supported="true" />
        <feature name="dynamic_text_kerning" supported="true" />
        <feature name="static_text_charwidth_nondeviceFont" supported="true" />
        <feature name="static_text_charwidth_deviceFont" supported="true" />
        <feature name="advanced_anti_alias_text" supported="true" />
        <feature name="nine_slice_scaling" supported="true" />
        <feature name="runtimeNumberMinMax" supported="true" />
        <feature name="use8kSampleRate" supported="true" />
        <feature name="useDefineFont4ForDeviceText" supported="true" />
        <feature name="useDefineFont4ForEmbeddedFonts" supported="true" />
        <feature name="textLayoutFramework" supported="true" />
        <encodingPresets>
            <preset uuid="da5cac1a-417a-4d86-b7f7-ef21010a5d7d" name="FLV - Match Source Attributes (High Quality)" ext="flv" default="true" />
        </encodingPresets>
        <testmenu>
            <menu name="ID_testInFlash" default="true" />
            <menu name="ID_testInDeviceCentral" />
        </testmenu>
        <debugmenu>
            <menu name="ID_debugtInFlash" default="true" />
            <menu name="ID_debugInDeviceCentral" />
        </debugmenu>
    </player>
</players> 
```

下一步是将您的 playerglobal.swc 添加到此处名为 FP10.2 的新文件夹中：

/Applications/Adobe Flash CC/Adobe Flash CC.app/Contents/Common/Configuration/ActionScript 3.0/FP10.2

确保您实际上已将 swc 文件重命名为 playerglobal 而不是 playerglobal10_2。

现在，如果您重新启动 Flash，您应该可以在 10.2 中导出

# seo - 通过反转字符串来防止 Google 索引 div 的内容

> ID：11320407
> 
> 赞同：17
> 
> 时间：2012-07-03T23:04:44.840
> 
> 标签：seo

我想防止 Google 将`<div>`我页面上的内容编入索引。当然我可以创建一个图像，但在我的情况下这并不是一个真正的选择，因为数据是非常动态的。

所以，我想出了以下解决方案：

假设我有一个字符串：

`The quick brown fox jumps over the lazy dog.`

1.  我将字符串反转为：`.god yzal eht revo spmuj xof nworb kciuq ehT`
2.  我使用了一点 CSS 来正确显示它：`unicode-bidi:bidi-override; direction: rtl;`

代码：

```
<div style="unicode-bidi:bidi-override; direction: rtl;">
  .god yzal eht revo spmuj xof nworb kciuq ehT
</div> 
```

**问题**：这是否会对我的 SEO 排名产生负面影响，因为 Google 的爬虫显示：

`.god yzal eht revo spmuj xof nworb kciuq ehT`

..这在英语中是垃圾

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-01T23:10:01.343

我在谷歌论坛上问过，答案是：没有

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-07-05T01:24:59.687

> 我想防止 Google 将我页面上的内容编入索引

那么我认为你不应该把这些内容放在页面上，句号。

根据这篇文章，您可以尝试使用 googleon/googleoff 标签：

[告诉 Google 不要索引您页面的某些部分](http://perishablepress.com/tell-google-to-not-index-certain-parts-of-your-page/)

```
<!--googleoff: index-->
don't index this content
<!--googleon: index--> 
```

再说一次，我发现这篇文章指出这是不可能的：

[http://productforums.google.com/forum/#!topic/webmasters/qrBI_v-N4N0](http://productforums.google.com/forum/#!topic/webmasters/qrBI_v-N4N0)

> 如何告诉谷歌不要这样做？==============
> 
> 你没有！
> 
> > 如果它是内容，如果它是该页面的一部分，那么它将被抓取，并且可能被索引和排名

> 您不能使用元标记或 HTML 标记来告诉 Google 忽略、折扣、不使用、参考或触摸您的部分内容。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2019-09-27T21:45:51.077

更新此线程。虽然 google 仍会抓取和索引，但您可以使用 HTML 中的 data-nosnippet 属性阻止它出现在搜索结果中。可用于`<div>`、`<span>`和`<section>`元素。

例子：`<p><span data-nosnippet>Harry Houdini</span> is undoubtedly the most famous magician ever to live.</p>`

[看这里](https://webmasters.googleblog.com/2019/09/more-controls-on-search.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-03T23:57:52.707

你的问题有点不清楚。您应该澄清您是否担心对您的排名产生负面或正面影响。

我认为人们无法完全知道使用您的方法是否会对您的 SEO 排名产生负面或正面的影响。您的排名会因使用反向文本而受到处罚吗？也许如果您在 div 中填充关键字或其他垃圾邮件类型的内容。谷歌的爬虫很有可能可以解释你的 CSS 并阅读文本，因为它本来是要被阅读的。

另一个可能阻止 Google 抓取特定元素的选项是使用 javascript。例如，将下面的 javascript 放在外部 JS 文件中，并在网页的头部或底部链接到它。

```
<script>
function jsText() {
  document.getElementById("noindex").innerHTML="The quick brown fox jumps over the lazy dog.";
}
</script> 
```

然后将以下内容用于要显示隐藏文本的 div。

```
<div id="noindex">
  <script>
    jsText();
  </script>
</div> 
```

这应该通过 javascript 在 div 中写入文本。Google 还可以抓取 javascript，因此它仍然可以找到文本并将其编入索引。为了进一步降低 Google 抓取 javascript 的可能性，您也可以排除 robots.txt 中的 javascript 文件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-09-20T07:51:23.673

我使用服务器端代码从 googlebot 隐藏 div

```
<?php if(self::isNotGoogleBot()):?>
<div id="noindex"></div>
<?php endif?>
public static function isNotGoogleBot()
    {
        $ua = strtolower($_SERVER['HTTP_USER_AGENT']);
        if(strpos($ua,'googlebot') === false && strpos($ua,'mediapartners-google') === false)return true;
        return false;
    } 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2018-10-05T06:16:30.123

您是否可以创建一个新的 html 文件来放置文本和元标记

```
<meta name=”robots” content=”noindex”/> 
```

然后，您可以在主页上包含带有 iframe 或类似内容的 html。

# php - 从帖子标题自动生成关键字

> ID：11320408
> 
> 赞同：1
> 
> 时间：2012-07-03T23:04:50.757
> 
> 标签：php, wordpress, split, title

例如，我有标题“战舰预告片”，所以它会生成像“最好的，玩家，的，世界”这样的关键字，我该怎么做？

我想像这样出现在html中......

```
First:The
Second:Battleship
Third:Trailer

<meta name="keywords" content="<FirstWord>,<second>,<third>"/> 
```

更确切地说，我想用文字拆分标题。

我使用 WordPress

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-03T23:08:49.130

```
echo '<meta name="keywords" content="'.implode(',', explode(' ', $string)).'"/>'; 
```

这将`$string`用逗号将由空格分隔的单词连接起来。显然替换`$string`适当的变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T03:14:38.740

```
$string = get_the_title(); // Inside your header.php 
echo '<meta name="keywords" content="'.implode(',', explode(' ', $string)).'"/>'; 
```

参考：[http ://codex.wordpress.org/Template_Tags/get_the_title](http://codex.wordpress.org/Template_Tags/get_the_title)

参考： http: [//php.net/manual/en/function.implode.php](http://php.net/manual/en/function.implode.php)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-08T11:11:56.067

获得帖子的slug可能会更好。这将**清理并删除**对搜索引擎没有任何价值的任何较短的单词。然后用 PHP 爆炸和内爆......

**这里如何：**

```
 // Get the global post variable (inside or outside the loop)
 global $post;

 // Seperate title slug by dashes into array
 $the_slug_into_array = explode('-', $post->post_name);

 // Convert array back into a string with comma separation
 $the_keywords = implode(',', $the_slug_into_array );

 // Echo out the string of terms from the title
 echo $the_keywords; 
```

*让我知道这是否对您有用...*

# sql-server-2008 - 带有链接 SQL Server 2008 表的 MS Access 2007 - 使用 Date() 和 Now() 查询不起作用

> ID：11320416
> 
> 赞同：-1
> 
> 时间：2012-07-03T23:05:53.690
> 
> 标签：sql-server-2008, ms-access, ms-access-2007

带有链接 SQL Server 2008 表的 MS Access 2007 - 当表是来自 SQL 的链接表时，使用 Date() 和 Now() 的查询在 Access 中不起作用。如果没有手动日期标准，即 01/01/2012 和 31/01/2012 之间，有什么解决方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-03T23:11:37.507

SQL Server 不知道什么`Date()`和`Now()`是。我认为您正在寻找类似[`DATEADD`](http://msdn.microsoft.com/en-us/library/ms186819.aspx)and的语法[`GETDATE()`](http://msdn.microsoft.com/en-us/library/ms188383.aspx)。如果您发布您尝试在 Access 中运行的查询，有人可能会帮助您将其转换为等效的 SQL Server 查询。

# javascript - 从数组创建 JSON 对象

> ID：11320418
> 
> 赞同：1
> 
> 时间：2012-07-03T23:06:06.153
> 
> 标签：javascript, jquery, json

我有一个输入字段，`#tag_field`我的用户在其中输入一个标签，然后我想检查 JSON 对象中是否存在指定的值。

下面包含的是我当前正在使用的代码，但我不确定如何将用户输入传递给`blur()`事件中的函数。

```
var tags = [
                    {
                        "tag": "php",
                        "id": "x&8j"
                    },
                    {
                        "tag": "ruby",
                        "id": "x&8jX90"
                    }
];

$j('#tag_field').blur(function(){
        var tagMap = {};
        var i = null;
        for (i = 0; tags.length > i; i += 1) {
            tagMap[tags[i].tagName] = tags[i];
        }

        var hasTag = function(tagName) {
            return tagMap[tagName];
        };
    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-03T23:24:30.897

你的意思是[这样的吗](http://jsfiddle.net/2Vdke/1/)

您是否只需要获取输入的值并将其与标签对象中的名称进行比较？

```
$('#tag_field').blur(function() {
    var tagMap = {};
    var i = null;
    for (i = 0; tags.length > i; i += 1) {

        if (tags[i].tag == $(this).val()) alert('exist' + tags[i].id)
        //Check
    }

    var hasTag = function(tagName) {
        return tagMap[tagName];
    };
});​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-03T23:46:40.000

```
var tags = [
    {
        "tag": "php",
        "id": "x&8j"
    },
    {
       "tag": "ruby",
       "id": "x&8jX90"
    }
]

$(function() { 
    $('#tag_field').on('blur', function(e) {
        var $this = $(this), val = $.trim($this.val());
        if (!val) return false;

        for(var i=0, l=tags.length;i<l;i++) {
            if (tags[i]['tag'] === val) {
                console.log('tag exists')
                return tags[i]['tag'];
            }
        }
        console.log('tag does not exist');
        return false;
    })
}) 
```

简化您的标签映射（如果可能）将使其更容易

```
var tags =  { "php" : "x&8j", "ruby" : "x&8jX90" }

$(function() { 
    $('#tag_field').on('blur', function(e) {
      if(tags[$.trim($(this).val())]) {
          console.log('tag exists')
      } else {
          console.log('tag does not exist')
      }
    })
})
​ 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-03T23:37:36.123

如果可用，最好使用[Array.some](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/some)：

```
function tagExists(needle, haystack) {
  if (Array.prototype.some) {
    return haystack.some(function(element) {
      return element.tag == needle
    });
  } else {
    for(i in haystack) {
      if(typeof(haystack[i]) == 'object' && haystack[i].tag == needle) {
        return true;
      }
    }
    return false;
  }
} 
```

要在您的特定场景中使用它，请遵循以下原则：

```
$('#tag_field').on('blur', function() {
  if(tagExists($(this).val(), tags) {
    // Tag exists. 
  }
}); 
```

请注意，正如我定义的那样，这是区分大小写的，但可以通过在比较期间调用 以及每个标签来轻松`String.toLowerCase()`调整`needle`。

最后，也许我过于挑剔了，但您的标签映射在技术上不是 JSON 对象；它只是一个对象数组。

# c# - 使用夹具测试实体框架

> ID：11320421
> 
> 赞同：22
> 
> 时间：2012-07-03T23:06:09.400
> 
> 标签：c#, asp.net-mvc-3, entity-framework, unit-testing, tdd

我喜欢[Rails](http://guides.rubyonrails.org/testing.html#the-low-down-on-fixtures)和[Django](https://docs.djangoproject.com/en/dev/topics/testing/?from=olddocs#fixture-loading)测试方法的一件事是它们支持在每次测试运行之前使用夹具来设置数据库。

过去，我将严格的单元测试与模拟存储库结合使用来测试我的代码，但我希望拥有与上述测试方法一样易于使用的东西，以便进行集成测试。

我听说过一些关于代码优先和 EF 5 的此类支持的讨论，但我不知道它是否达到了 Rails 和 Django 提供的水平。

当然，那里有可比的东西。任何信息，将不胜感激！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-09T06:25:23.157

在 EF5 中引入了新概念，称为**Migrations**。您可能曾经在 Rails 或 Django 应用程序中使用过类似的东西。

迁移是一个类，具有升级/降级数据库版本的多种功能。

```
public partial class VoteTime : DbMigration
{
    public override void Up()
    {
        AddColumn("Votes", "Time", c => c.DateTime(nullable:false, defaultValue:DateTime.UtcNow));
    }

    public override void Down()
    {
        DropColumn("Votes", "Time");
    }
} 
```

您还必须设置 DbContext 和 DbMigrationsConfiguration 配置类以允许代码优先方法工作。

出于测试目的，您需要引入，`TestDatabaseInitilizer`

```
public class TestDatabaseInitilizer : DropCreateDatabaseAlways<DbContext>
{

} 
```

它将负责为单元测试初始化​​测试数据库。

最后，您应该设计测试代码来设置上下文。

```
public class SomeRepositoryTests
{
    private DbContext _context;

    [SetUp]
    public void Setup()
    {
        Database.SetInitializer(new TestDatabaseInitilizer());
        _context = new DbContext("TestContext");
        _repository = new SomeRepository(_context);
    }

    [Test]
    public void should_return_some_entities()
    {
        Assert.That(_repository.Get(), Is.Not.Null);
    }
} 
```

如果需要，可以将设置代码移至基类。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-07-12T17:30:19.177

我使用实体框架开发了一个应用程序，该应用程序具有 600 多个自动化集成测试。这是我使用的过程：

*   Entity Framework 代码首先迁移只是为了设置数据库结构（表、索引等）。我不使用迁移来播种数据。

*   将数据库设置为特定的、众所周知的状态的 SQL 脚本。例如，一个插入 ASP.NET 会员用户的脚本；另一个为最相关的表格设置样本数据；和其他更具体的场景。脚本通常从适当的表中删除记录，然后以适当的顺序再次插入它们以避免关系冲突。这些脚本作为嵌入式资源包含在 Visual Studio 项目中。

*   一个帮助类，它可以通过名称从资源中获取脚本并针对数据库执行它，包括带有“GO”的批处理命令。ConnectionContext.ExecuteNonQuery 可以用于此。

*   在整个测试套件开始时，我执行设置用户、权限和其他非常通用的环境配置的脚本。

*   在每种测试方法之前，我会根据需要执行一个或多个脚本，以在运行测试所需的上下文中设置数据库。例如，在一系列读取、插入、更新和删除数据的 CRUD 测试之前，我运行了一个脚本，该脚本使用测试数据为适当的表提供种子。

*   我假设数据库设置在特定的上下文中编写测试用例。例如，更新操作的测试将尝试检索具有已知键的记录，更新它并再次读取以检查它是否在数据库中更新。

尽管 SQL 脚本不像 Rails 固定装置那样容易编写和阅读，但它们非常快并且可以进行任何需要的操作（例如，删除、插入、更新、执行存储过程）。

这种技术在一个涉及 50 个数据库表和非常复杂的业务规则和流程的项目中得到了很好的证明。它使测试保持简单和一致。

# algorithm - 我对最近对问题的分治算法的逻辑有什么问题？

> ID：11320423
> 
> 赞同：4
> 
> 时间：2012-07-03T23:06:26.993
> 
> 标签：algorithm, divide-and-conquer

我一直在关注 Coursera 的算法课程，并想出了一个关于最近配对问题的分/治算法的想法，我想澄清一下。

根据 Roughgarden 教授的算法（如果您有兴趣，可以[在此处](https://class.coursera.org/algo-2012-002/lecture/download.mp4?lecture_id=18)查看）：对于给定的一组点 P，我们有两个副本 - 在 X 和 Y 方向上排序 - Px 和 Py，算法可以给出为

最接近对（Px，Py）：

1.  将点分成左半部分 - Q 和右半部分 - R，并沿 x 和 y 方向形成两半的排序副本 - Qx,Qy,Rx,Ry
2.  让closestPair(Qx,Qy)为点p1和q1
3.  设最接近对(Rx,Ry)为p2,q2
4.  令 delta 为 dist(p1,q1) 和 dist(p2,q2) 的最小值
5.  这是不幸的情况，让 p3,q3 成为最接近的SplitPair(Px,Py,delta)
6.  返回最好的结果

现在，我想要的澄清与第 5 步有关。我应该事先说一下，我的建议几乎没有任何改进，但如果你仍然感兴趣，请继续阅读。

R 教授说，由于点已经在 X 和 Y 方向上排序，为了在步骤 5 中找到最佳对，我们需要迭代宽度为 2*delta 的条带中的点，从下到上，在内部循环我们只需要 7 个比较。这可以改善到只有一个吗？

我觉得怎么可能用纯文本解释起来有点困难，所以我画了一张图，写在纸上，然后上传到这里：

![在此处输入图像描述](../Images/66e4b7444c076e92a86a6798d3ef8725.png)

由于没有其他人想出是，我很确定我的思路有一些错误。但我现在已经想了好几个小时了，我只好发布这个。这就是我脑子里的一切。

有人可以指出我哪里出错了吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-03T23:43:42.173

您在第 5 点中的结论是不正确的。尝试将点 A 靠近分界线。

您可以在 A 的 delta 范围内有两个点（一个在上面，一个在下面），它们不在彼此的 delta 范围内。

```
 | B
  | 
 A|
  | 
  | C 
```

在这里，`dist(A,B) = dist(A,C) < dist(B,C)`。

这是一个很好的例子，说明为什么图片有助于获得直觉，但仍然需要证据来支持你的结论。

# clojurescript - ClojureScript、JavaScript、AJAX 调用、继续传递样式

> ID：11320425
> 
> 赞同：2
> 
> 时间：2012-07-03T23:06:42.733
> 
> 标签：clojurescript

我意识到 Clojure 特意选择了没有延续。

我目前正在玩 ClojureScript。

我注意到在 JavaScript 的 AJAX 调用协议中，我经常传递一个函数来处理“AJAX 调用返回后要做什么”。

这听起来很像一个延续。

是否有一些标准方法可以在 ClojureScript 中设置 CPS？

如果不是，那么处理 AJAX 回调的正确方法是什么？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T14:54:49.817

与 Scheme 不同， Clojure（和 ClojureScript）缺少[**一流的 continuation**](http://en.wikipedia.org/wiki/Continuation#First-class_continuations)，但没有什么能阻止您以显式的 continuation-passing-style 编写代码。你是对的，一个接受函数回调的 JavaScript AJAX 调用是类似的。

查看关于 SO for AJAX 和 ClojureScript[的](https://stackoverflow.com/questions/8554745/implementing-an-ajax-call-in-clojurescript)另一个问题，它指出了如何使用 Google Closure 库，并且可能是最容易从“开箱即用”开始的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T17:12:28.157

您可能想查看 Clojure 的 Ganelon 微框架（我是它的作者）。

那里没有 CPS，但一般的想法 - 服务器端 AJAX 回调可以更新客户端内容或执行客户端 JavaScript 非常类似于 Common Lisp 的延续式 Web 框架 - Weblocks。

Ganelon 的演示和文档可在[http://ganelon.tomeklipski.com/获得](http://ganelon.tomeklipski.com/)

# python - 如何为 urllib2.OpenDirector open() 方法设置超时

> ID：11320428
> 
> 赞同：0
> 
> 时间：2012-07-03T23:07:06.727
> 
> 标签：python, settimeout, urllib2

我正在使用一些 urllib2.HTTPHandler 子类作为[socksipy 项目](http://socksipy.sourceforge.net/)的代理。

一切都很好，除了当他们点击一个挂起的 URL 时。全局和通过 OpenDirector.open() 方法设置超时不会做任何事情。

以下是 urllib2.HTTPHandlers：

```
# get the socksipy project code
import socks

class SocksiPyConnection(httplib.HTTPConnection):
    def __init__(self, proxytype, proxyaddr, proxyport = None, rdns = False, username = None, password = None, *args, **kwargs):
        self.proxyargs = (proxytype, proxyaddr, proxyport, rdns, username, password)
        httplib.HTTPConnection.__init__(self, *args, **kwargs)

    def connect(self):
        self.sock = socks.socksocket()
        self.sock.setproxy(*self.proxyargs)
        if isinstance(self.timeout, float):
            self.sock.settimeout(self.timeout)
        self.sock.connect((self.host, self.port))

class SocksiPyHandler(urllib2.HTTPHandler):
    def __init__(self, *args, **kwargs):
        self.args = args
        self.kw = kwargs
        urllib2.HTTPHandler.__init__(self)

    def http_open(self, req):
        def build(host, port=None, strict=None, timeout=0):
            conn = SocksiPyConnection(*self.args, host=host, port=port, strict=strict, timeout=timeout, **self.kw)
            return conn
        return self.do_open(build, req) 
```

我尝试将超时全局设置为**socket.setdefaulttimeout(30)**，但没有成功。当我在上面实例化**SocksiPyConnection**时，我也尝试过设置超时 。最后，我尝试使用**OpenDirector.open**方法设置超时，[因为 API 说它需要超时](http://docs.python.org/library/urllib2.html#urllib2.OpenerDirector.open)而没有成功。

挂起的测试代码：

```
import sys
# import socksipy base code
sys.path.append( "/parent/path/to/socks.py" )
import socks 
import urllib2
import socket
socket.setdefaulttimeout(30)
proxyhost = "responder.w2"
proxyport = 1050
sys.path.append( "/home/gcorradini" )
from sock_classes import SocksiPyHandler
opener = urllib2.build_opener(SocksiPyHandler(socks.PROXY_TYPE_SOCKS5, proxyhost, int(proxyport)) )
resp = opener.open("http://erma.orr.noaa.gov/cgi-bin/mapserver/charts?version=1.1.1&service=wms&request=GetCapabilities", timeout=30.0)
# i just hang here forever 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T20:12:11.333

事实证明，我上面提到的“挂起/超时”问题实际上是[sockssipy socks.py](http://sourceforge.net/projects/socksipy/)代码中的“阻塞”问题。如果您访问的端点仍然以 200 响应但不发送数据（0 字节），那么 socks.py 将阻塞，因为这就是它的写入方式。这是创建自己的超时之前和之后：

**socks.py 之前**：

```
def __recvall(self, bytes):
    """__recvall(bytes) -> data
    Receive EXACTLY the number of bytes requested from the socket.
    Blocks until the required number of bytes have been received.
    """
    data = ""
    while len(data) < bytes:
       data = data + self.recv(bytes-len(data))
    return data 
```

**socks.py 后超时**：

```
def __recvall(self, bytes):
    """__recvall(bytes) -> data
    Receive EXACTLY the number of bytes requested from the socket.
    Blocks until the required number of bytes have been received.
    """
    data = self.recv(bytes, socket.MSG_WAITALL)
    if type(data) not in (str, unicode) or len(data) != bytes:
        raise socket.timeout('timeout')
    return data 
```

# android - SQLite rawQuery selectionArgs 和 Integers 字段

> ID：11320434
> 
> 赞同：9
> 
> 时间：2012-07-03T23:07:34.013
> 
> 标签：android, sqlite

正如 Android 文档所说，rawQuery 方法的 selectionArgs 参数被解析为字符串。

> SQLiteDatabase.rawQuery(String sql, String[] selectionArgs)
> 
> selectionArgs：您可以在查询的 where 子句中包含 ?s，它将被 selectionArgs 中的值替换。这些值将绑定为字符串。

但是今天，我遇到了一个问题，这个问题占据了我大部分时间。想象以下查询：

```
SELECT * FROM TABLE_A WHERE IFNULL(COLUMN_A, 0) >= 15 
```

COLUMN_A 是整数。该表有大约 10 行符合该标准。在数据库编辑器上运行查询，结果总是正确的，但在智能手机上，语句总是不返回任何行。

一段时间后，a 将查询更改为：

```
SELECT * FROM TABLE_A WHERE IFNULL(COLUMN_A, 0) >= '15' 
```

并且编辑器没有返回任何行，就像 Android 一样。因此，将查询更改为：

```
SELECT * FROM TABLE_A WHERE CAST(IFNULL(COLUMN_A, 0) as INTEGER) >= '15' 
```

解决了这个问题。进行的另一项测试是：

```
SELECT * FROM TABLE_A WHERE COLUMN_A >= '15' 
```

此外，返回了正确的结果。

这似乎是一个问题，涉及 Android 使用 IFNULL 子句将参数绑定到查询（作为字符串）的方式。

那么，有人知道为什么会这样吗？有什么建议可以在不使用 CAST 的情况下解决这个问题吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-04T00:00:31.503

*将值绑定*到查询的原因是为了防止[SQL 注入攻击](http://en.wikipedia.org/wiki/SQL_injection)。

*基本上*，您将查询（包括占位符）发送到数据库并说“我的下一个查询将采用这种形式，而不是其他形式！”。当攻击者随后注入不同的查询字符串（例如，通过表单字段）时，数据库会显示“嘿，这不是您说要发送的查询！” 并向您抛出错误。

> ~~由于命令（可以像链接文章中所示注入到您的实际查询中）是字符串，因此字符串数据类型是更“危险”的一种。如果用户尝试将一些代码注入到您的字段中，该代码应该只接受数字，并且您尝试将输入转换/解析为整数（在将值放入查询之前），您将立即收到异常。使用字符串，就没有这种安全性。因此，他们可能必须逃脱。这*可能*是绑定值都被解释为字符串的原因。~~

以上是**假**的！无论您绑定的参数是字符串还是整数，它们都同样危险。此外，在代码中预先检查您的值会导致大量样板代码，容易出错且不灵活！

* * *

为了防止您的应用程序发生 SQL 注入并加快多个数据库**写入**操作（使用具有不同值的相同查询），您应该使用“准备好的语句”。在 Android SDK 中**写入**数据库的正确类是[`SQLiteStatement`](http://developer.android.com/reference/android/database/sqlite/SQLiteStatement.html).

要创建准备好的语句，请使用-object的[`compileStatement()`-method](http://developer.android.com/reference/android/database/sqlite/SQLiteDatabase.html#compileStatement%28java.lang.String%29)并使用正确的-method（继承自）`SQLiteDatabase`绑定相应的值（将`?`在查询中替换为 -marks ）：`bindXX()`[`SQLiteProgram`](http://developer.android.com/reference/android/database/sqlite/SQLiteProgram.html)

```
SQLiteDatabase db = dbHelper.getWritableDatabase();
SQLiteStatement stmt = db.compileStatement("INSERT INTO SomeTable (name, age) values (?,?)");
// Careful! The index begins at 1, not 0 !!
stmt.bindString(1, "Jon");
stmt.bindLong(2, 48L);
stmt.execute();
// Also important! Clean up after yourself.
stmt.close(); 
```

取自这个较早的问题的示例：[如何在 Android 的 SQlite 中使用准备好的语句？](https://stackoverflow.com/questions/433392)

* * *

可悲的是，`SQLiteStatement`没有返回 a 的重载`Cursor`，因此您不能将它用于`SELECT`- 语句。对于那些，您可以使用`rawQuery(String, String[])`- 方法`SQLiteDatabase`：

```
int number = getNumberFromUser();
String[] arguments = new String[]{String.valueOf(number)};
db.rawQuery("SELECT * FROM TABLE_A WHERE IFNULL(COLUMN_A, 0) >= ?", arguments); 
```

请注意，`rawQuery()`-method 采用字符串数组作为参数值。这其实没关系，SQLite 会自动转换为正确的类型。只要字符串表示等于您在 SQL 查询中所期望的，就可以了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T00:10:54.023

我猜我有完全相同的问题。您要提及的是您无法对 sqlite 数据库进行实际计算。我发现问题比你提到的更大。SQLite 数据库似乎不了解有关字段值的任何字段类型。这意味着如果您尝试在 INTEGER 字段类型中插入 String 值，则插入不会抱怨。

因此，如您所见，问题更大。虽然我已经看到，如果你有一列只有整数，并且你做了一个 where 语句，比如： where id = 1 without ' ' 那么就有一个结果数据集。所以我可能会问你是否确定这个语句不起作用：“SELECT * FROM TABLE_A WHERE IFNULL(COLUMN_A, 0) >= 15”。但是 where id >= '15' 确实有效，因为它采用 id 的字符串表示形式，它是实际的 2 个 unicode 字符（!!!），并尝试将运算符 >= 设为适用的 '15'。

我第一次遇到这些问题时让我感到惊讶，我决定动态创建 SQL 而不绑定参数并作为一个完整的字符串执行。我知道在没有绑定参数的情况下，这不是访问数据库的最佳方式，但它是一种解决方案，而且是一个很好的解决方案，因为尽管您的数据库是安全的并且您的访问方法对您的应用程序来说是私有的，但安全原因并不那么重要. 如果“入侵者”能够通过 root 电话访问数据库，他只需将其放入 SQLITE Studio 即可。

# c# - 在 XAML 中创建全屏 GridView

> ID：11320435
> 
> 赞同：2
> 
> 时间：2012-07-03T23:07:44.230
> 
> 标签：c#, xaml, windows-8

我想为 Windows 8 中的 Metro Style 应用程序创建一个全屏 GridView 控件，该控件会增长并适应用户更改屏幕分辨率。

我正在尝试模仿 Windows 8 上的日历应用程序，当您在监视器之间交换 Metro 屏幕时，每个正方形（日期）的大小会发生变化，因此屏幕始终会被填满。

通常情况下，`ItemTemplate`我需要一种流体来确保整个屏幕已满，因此有时 GridView 项目会很小（在平板电脑上运行时），有时它们会很大（在我的桌面上运行时）。

我可以使用 XAML 来实现这一点，还是`ItemTemplate`在屏幕尺寸发生变化时必须通过更改 GridView 变得时髦？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T05:32:16.400

其他 xaml 框架中执行您想要的操作的控件称为 UniformGrid。它允许您指定行数或列数，然后将每个子项调整为适当的大小。

UniformGrid 目前没有出现在 WinRT xaml 堆栈中，但移植起来并不困难（我做过一次，但无法访问源代码）。您可以从[Jeff Wilcox - Uniform Grid](http://www.jeff.wilcox.name/2009/01/uniform-grid/)获得 Silverlight 版本的源代码。

对于日历样式的应用程序，您将有一个统一的行网格，然后每一行都有一个用于列的网格。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T01:48:29.097

我认为您应该能够将 GridView 放在 Grid 中，这应该照顾灵活的布局。只要 Grid 是您分配给`Windows.UI.Xaml.Window.Current`属性的页面的根元素，并且 GridView 是 Grid 的唯一子元素，它就应该水平和垂直拉伸以填满屏幕。

要获得日历类型的外观，您可以将 GridView 放在 Grid 的第二行，并将标题等放在第一行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-22T17:33:02.800

也许您可以使用[Viewbox 控件](http://msdn.microsoft.com/en-us/library/system.windows.controls.viewbox.aspx)。

# oop - Matlab，类，不能更改实例的属性

> ID：11320437
> 
> 赞同：0
> 
> 时间：2012-07-03T23:07:59.703
> 
> 标签：oop, class, matlab

我在 matlab 中声明了一个类，这里​​是构造函数和函数。

```
function Ri = RGBimages(datadir)
    if(isempty(dir(datadir)))
        warning([datadir, ' is empty']);
        return;
    end
    Ri.dataSrc=datadir;
    Ri.twoEnds = load([datadir,'\seIndex.txt']);
    Ri.startFrame = Ri.twoEnds(1);
    Ri.endFrame = Ri.twoEnds(2);
    Ri.numberOfFrames=Ri.twoEnds(2)-Ri.twoEnds(1)+1;
    Ri.faceLmks = zeros(68,2,Ri.numberOfFrames);
end

function obtainFaceLmks(Ri)
    indx=1;
    for i = Ri.startFrame;%:Ri.endFrame
        imstr = [Ri.dataSrc,'\rgb_',num2str(i),'.png'];
        [status,result] = system(['fitD -m src\my.amf -h src\haarcascade_frontalface_alt2.xml -i ',imstr,' -n 30']);
        if(status==-1)
            warning(result);
        else
            temp=flHelper(result(1:size(result,2)-59));
            Ri.faceLmks(:,:,indx)=temp;
        end
        indx=indx+1;
    end
    return;
end 
```

然后我这样做：

```
ims = RGBimages('data\a01_s01_e01');

ims.obtainFaceLmks(); 
```

而且似乎ims的属性（ims.faceLmks）没有改变，为什么？

谢谢你的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T00:12:01.220

值类是按值传递的。因此，方法应该返回（更新的）类实例，您需要捕获它。换句话说，方法定义应该是

```
function Ri = obtainFaceLmks(Ri) 
```

你会调用这个方法

```
ims = ims.obtainFaceLmks(); 
```

句柄类通过引用传递。因此，方法不需要返回更新后的类实例，也不需要捕获它。但是，您需要继承自`handle`，并且您需要实现一个复制方法来复制一个类实例；分配给另一个变量将不起作用。

有关更多信息，请参阅[文档](http://www.mathworks.com/help/techdoc/matlab_oop/brfylwk-1.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-03T23:15:45.080

这个类应该被继承来处理，这样它就可以改变自己的值，否则它只是一个“值类”，只能通过返回一些东西来改变它的值。

# ruby-on-rails - Rails 3、nginx 和独角兽。如果我在生产中，为什么 Rails 会寻找开发数据库？

> ID：11320443
> 
> 赞同：1
> 
> 时间：2012-07-03T23:08:27.260
> 
> 标签：ruby-on-rails, ruby, nginx, unicorn

我刚刚使用 capistrano、nginx 和 unicorn 部署了一个应用程序。我曾经使用 Apache 和 Passenger，但我正在尝试一些新的东西。

我的 production.log 中不断出现错误`ActiveRecord::StatementInvalid (Could not find table 'users')`（我已经检查过，这些表确实存在于 MySQL 中）。

我一直在寻找错误的原因，我发现 Rails 似乎正在寻找开发数据库（sqlite3）而不是生产数据库（mysql）。

我遵循 RailsCast 335 [http://railscasts.com/episodes/335-deploying-to-a-vps](http://railscasts.com/episodes/335-deploying-to-a-vps)但我使用的是 MySQL 而不是 Postgres。

我的 database.yml 文件位于 /apps/myappname/shared/config，这就是它包含的内容（**没有用于测试或开发 dbs 的信息**）...

```
production:
  adapter: mysql2
  database: dbname
  pool: 5
  timeout: 5000
  host: localhost
  username: db_user
  password: secret 
```

**那么为什么 Rails 不查看这个文件来进行数据库访问呢？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-03T23:19:50.907

你的`gemfile`呢？

您必须指定用于开发的数据库和用于生产的数据库：

```
# make sure you place your db gems in a group block
group :development do
  gem 'sqlite3'
end

group :production do
  gem 'mysql'
end 
```

# java - Java中n个链接元素的集合

> ID：11320448
> 
> 赞同：0
> 
> 时间：2012-07-03T23:08:50.207
> 
> 标签：java, performance, collections

我需要在收据上存储以下行项目：`quantity, description, upc, and price`.

Java中存储这些的最佳方法是什么？我需要将它们逐行打印到输出，就像收据打印机一样。集合中的元素数量应该是任意的，因为我将添加和删除元素。

```
5 item1 new item 324234  $4.99
1 item2 dish soap 34235346 $6.33 
```

..等等

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-03T23:14:37.290

我会考虑创建一些反映您想要表示的项目的对象。例如，也许您可​​能有一个`Receipt`对象，它有一个`List`of `ReceiptItem`s。

```
public class Receipt {
    private List<LineItem> receiptItems;

    // ... 

    public void add(LineItem lineItem) {
        // be mindful of handling duplicates if needed
        receiptItems.add(lineItem); 
    }

} 
```

您的每个项目都将包含您希望跟踪的值

```
public class LineItem {
    private int quantity;
    private String description;
    private String upc;
    private BigDecimal price; // depending on the accuracy you need, you might be able to get away with double

    // ...

    public String getDescription() {
        return description;
    }

    // ... add more getters to your heart's content ...
} 
```

* * *

更新：

要访问私有方法，您将创建一些 getter 或操作方法。我在上面添加了一些作为示例。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-03T23:11:59.783

为每个 arttibute 编写一个带有 getter 和 setter 的简单类来表示一个行项目。然后使用 List 来表示收据中行项目的顺序。最后，您可能需要一个收据类，其中包含行项目列表和一堆其他属性：日期、总金额、税金等。

您使用哪个 List 实现类可能没有任何区别。LinkedList 可以，ArrayList 也可以。性能上的差异将无法察觉。

* * *

（不要试图尝试使用像哈希表这样的开放数据结构来表示它。它会使您的代码更复杂，更难维护。而且开放数据结构的时间和空间效率较低......如果你担心的话关于那个......你可能不应该在你的项目的这个阶段。）

# php - 访问多维数组中任意深度的键

> ID：11320449
> 
> 赞同：3
> 
> 时间：2012-07-03T23:08:55.537
> 
> 标签：php, arrays, multidimensional-array

如果我有一个包含的数组，是否有任何方法可以在不使用循环或 eval()的情况下`['key1', 'key2', 'key3']`将其映射到数组？`$array['key1']['key2']['key3']`

数组示例：

```
$var = [
    'key1' => [
        'subkey1' => [
            'finalkey' => 'value',
        ],
        'subkey' => [
            'otherkey' => 'value',
        ],
    ],
    'key2' => 'blah'
]; 
```

然后我有一个这样的数组：

```
$keys = ['key1', 'subkey1', 'finalkey'] 
```

或者

```
$keys = ['key1', 'subkey'] 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-03T23:17:31.750

```
function array_find($needle, &$haystack)
{
    $current = array_shift($needle);
    if(!isset($haystack[$current]))
    {
        return null;
    }
    if(!is_array($haystack[$current]))
    {
        return $haystack[$current];
    }
    return array_find($needle, $haystack[$current]);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-03T23:20:32.430

未经测试，来自对不同问题的[类似答案。](https://stackoverflow.com/a/6415785/259778)

```
function get_value($dest, $path)
{
  # allow for string paths of a/b/c
  if (!is_array($path)) $path = explode('/', $path);

  $a = $dest;
  foreach ($path as $p)
  {
    if (!is_array($a)) return null;
    $a = $a[$p];
  }

  return $a;
} 
```

这应该比递归解决方案执行得更好。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-04T01:16:10.680

[我为我的个人框架](https://github.com/alixaxel/phunction/blob/64362af4f05b76c2439f91a240b388a958c3d0de/phunction.php#L692)提出了以下非递归方法：

```
function Value($data, $key = null, $default = false)
{
    if (isset($key) === true)
    {
        if (is_array($key) !== true)
        {
            $key = explode('.', $key);
        }

        foreach ((array) $key as $value)
        {
            $data = (is_object($data) === true) ? get_object_vars($data) : $data;

            if ((is_array($data) !== true) || (array_key_exists($value, $data) !== true))
            {
                return $default;
            }

            $data = $data[$value];
        }
    }

    return $data;
} 
```

用法：

```
var_dump(Value($array, 'key1.subkey1.finalkey')); // or
var_dump(Value($array, array('key1', 'subkey1', 'finalkey'))); 
```

它可以通过删除对象和默认值支持以及其他检查来进一步简化。

# regex - “某些文本重复：XXhYYmZZs”的正则表达式

> ID：11320452
> 
> 赞同：0
> 
> 时间：2012-07-03T23:09:14.697
> 
> 标签：regex, shell, scripting

我想构造一个正则表达式，对于我给它的每一行文本输入，选择 XX、YY 和 ZZ 是什么，最好将这些值返回给我可以添加或放入数组的变量中或任何。

问题是我对正则表达式和 shell 脚本都很陌生（我将使用 csh 来完成这项任务）。所以我想知道如何使用 csh 正则表达式来做到这一点，以及它是否与 perl 正则表达式不同。

重申一下模式如下：

```
Some text repeating: 23h04m31s
...
Some text repeating: 12h13m22s
... 
```

编辑 - 我的脚本需要为此查看特定文件。我想我可以在我的 csh 脚本中使用 GREP 工具，并使用正确的正则表达式。

感谢您的任何帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-03T23:20:41.587

```
while read line
do
    time=${line##*: }
    hours=${time%h*}
    minutes=${time#*h}
    minutes=${minutes%m*}
    seconds=${time#*m}
    seconds=${seconds%s*}

    do_something_with "$hours" "$minutes" "$seconds"
done < yourinputfile 
```

# image - 使用 feed 模块将图像导入 Drupal 7

> ID：11320461
> 
> 赞同：3
> 
> 时间：2012-07-03T23:10:11.280
> 
> 标签：image, drupal, csv, import, drupal-feeds

我必须将自定义（非 CMS）网站迁移到**Drupal 7**。在当前的网站中，一些表有图像数据，这些数据作为 URL 存储在 db 中。

我已经尝试了带有**Feeds Image Grabber插件的****Feeds**模块，以及**Media Feeds**插件，但没有成功（用于将数据作为节点导入）。

 ******问题：**

1.  有没有办法使用 Feeds 模块（或任何其他允许通过映射导入文本和图像的工具）将图像从（外部）URL 作为“图像”**从 CSV 文件导入 Drupal？**

2.  如果没有，有没有办法从 Drupal 的图像库中导入它们，也可以使用 Feeds 模块和/或 Media Feeds 插件？

我尝试通过提供完整的外部 URL 路径或 public://myimage.jpg 路径从 CSV 导入，但没有成功。

感谢您提供任何帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-10T16:55:44.777

您确定问题是由于空格引起的是正确的。仅供参考：您可以使用提要的篡改插件删除空格。只需选择修剪并在必填字段中输入一个空格。而不是使用`public://image`它也可以从您获取图像的站点输入完整的 url，只需记住删除空格。****

# facebook-graph-api - 尝试发布自定义操作时出现“对象属于网站类型”错误

> ID：11320463
> 
> 赞同：2
> 
> 时间：2012-07-03T23:10:22.153
> 
> 标签：facebook-graph-api, post, types, web, custom-action

当我尝试发布自定义操作时，我收到一个错误（如下），声称代表我的对象的 URL 是网站类型。正如您从我的对象 html 中看到的那样，我已经包含了一个。og:type '{app_namespace}:{object_name}' 标签，实际上这段代码大部分是由开发者应用程序生成的。我过去曾为其他应用程序成功发布过自定义操作，但这次我不知道有什么不同。任何建议，将不胜感激。

脸书错误：

```
{"error":{"message":"(#3502) Object at URL {URL} has og:type of 'website'. The property 'issue' requires an object of og:type '{app_namespace}:{object_name}'. ","type":"OAuthException","code":3502}} 
```

对象 HTML：

```
<html>
  <head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# {app_namespace}: http://ogp.me/ns/fb/{app_namespace}#">
    <meta property="og:type"   content="{app_namespace}:{object_name}" /> 
    <meta property="fb:app_id" content="{app_id}" /> 
    <meta property="og:url"    content={URL for this Html} /> 
    <meta property="og:title"  content="Sample title" /> 
    <meta property="og:image"  content="https://s-static.ak.fbcdn.net/images/devsite/attachment_blank.png" />
  </head>
<body>
</body>
</html> 
```

我用来发布操作的代码：

```
<head>
    <script type="text/javascript" src="http://code.jquery.com/jquery-latest.min.js"></script>
    <script type="text/javascript">
        function clickHandler() {
            FB.getLoginStatus(function (response) {
                if (response.authResponse) {
                    FB.api('/me/{app_namespace}:{action_name}?{object_name}={object_url}', 'post', function (response) {
                        alert(JSON.stringify(response));
                    });
                } else {
                    //If user not logged in initiate login process
                    FB.login(function (response) {

                        if (response.authResponse) {
                            FB.api('/me/{app_namespace}:{action_name}?{object_name}={object_url}', 'post', function (response) {
                                alert(JSON.stringify(response));
                            });
                            //actionPublish();
                        } else {
                            //user cancelled login or did not grant authorization
                        }
                    }, {
                        scope: 'publish_actions'
                    });
                }

            });
        }

        $(document).ready(function () {
            window.fbAsyncInit = function () {
                FB.init({
                    appId: '{app_id}',
                    status: true,
                    cookie: true,
                    xfbml: true,
                    oauth: true
                });

                // run once with current status and whenever the status changes
                FB.getLoginStatus(updateButton);
                FB.Event.subscribe('auth.statusChange', updateButton);
            };

            (function () {
                var e = document.createElement('script');
                e.async = true;
                e.src = document.location.protocol + '//connect.facebook.net/en_US/all.js';
                $("#fb-root").append(e);
            }());
        });
    </script>
</head>

<body>
    <div id="fb-root"></div>
    <button id="publishButton" onclick=clickHandler(); return false " >Publish</button>
</body> 
```

编辑：

如果我将 fb 对象 URL 粘贴到调试工具中，则会收到以下错误：

“在 URL 'http://www.thepropagator.com/takeAction/draft_1/demos3/issue_4.php' 或通过重定向或 'og:url' 指定的 URL 之一获取对象时出错属性，包括[http://www.thepropagator/takeAction/draft_1/demos3/issue_4.php](http://www.thepropagator/takeAction/draft_1/demos3/issue_4.php)之一。”

如果我尝试将 URL 标签全部屏蔽掉，错误就会消失，无论哪种情况，当我尝试发布操作时，Facebook 都会发回错误，指出该对象是网站类型。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T00:56:12.383

[请参阅对此线程](https://stackoverflow.com/questions/7975498/submitting-object-to-facebook-via-open-graph-doesnt-work-but-then-works-after)的前两个响应。

[这个线程](https://stackoverflow.com/questions/10135323/facebook-open-graph-meta-property-ogtype-of-website-the-property-object-nam)也可以帮助你。

还是[这个](https://stackoverflow.com/questions/7570335/difficulty-posting-actions-to-timeline)。

其他建议：

1.  fb:app_id 标签必须与您尝试使用的应用相匹配。
2.  您确定 og:url 实际上与对象 URL 匹配吗？也许您在事件页面上有一个 og:url 标签，它将 facebook 重定向到没有事件 og 标签的其他地方。
3.  您是否对另一个应用程序中的对象使用了相同的 URL？这也可能导致问题。如果您的网站需要登录，这也可能是一个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T00:39:17.400

我最终创建了一个新的 Facebook 应用程序。该应用程序也有同样的问题，但在稍微调整后（使用调试器和我的代码，我开始工作。我不确定这里有什么收获，但我相信问题可能有多达三个根，我这边的错误，我这边的 Facebook 缓存和缓存。

感谢每一个人的回复。

# asp.net - 消息收件箱的 Gridview 可点击行

> ID：11320464
> 
> 赞同：2
> 
> 时间：2012-07-03T23:10:27.130
> 
> 标签：asp.net, gridview, messaging, clickable

我知道还有其他一些类似的问题，但根据他们的回答我无法弄清楚。

我正在使用 gridview 构建一个消息收件箱页面。目前，gridview 向用户显示他们的消息，其列标题为：Sent from、Subject 和 Date。我希望使行可单击（并在单击时突出显示）并且消息显示在 gridview 框旁边的文本框中。我希望该行可单击，但每行侧面没有“选择”按钮。

对此的任何帮助将不胜感激。我不确定是否需要更改 gridview 框的属性或制作全新的方法。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-03T23:18:09.323

首先，您在 GridView 上添加一个按钮命令，如下所示：

```
<asp:ButtonField Text="View" CommandName="ViewMe" ButtonType="Button" /> 
```

然后在函数后面的代码上添加`OnRowCommand="RowCommand"`属性：`GridView`

```
protected void RowCommand(object sender, GridViewCommandEventArgs e)
{
    // if the ViewMe command is fired
    if (e.CommandName == "ViewMe")
    {
        // go to find the index on the grid view
        int iTheIndexNow;
        if (int.TryParse(e.CommandArgument.ToString(), out iTheIndexNow))
        {
            // Set and highlight the selected
            gvGridViewID.SelectedIndex = iTheIndexNow;

            // get the table data id
            if (gvGridViewID.SelectedValue != null)
            {
                // now load the text where gvGridViewID.SelectedValue is 
                // the line id. This function load the text 
                //   into a TextBox or other control
                LoadText(gvGridViewID.SelectedValue.ToString());
            }    
        }
    }
} 
```

在此函数上，您设置选定的行并获得您设置的 SelectedValue `DataKeyNames`，通常是表中的 ID。拥有此 ID，您可以显示消息的额外文本。

# php - PHP 数组排序与多列数据

> ID：11320470
> 
> 赞同：0
> 
> 时间：2012-07-03T23:11:01.393
> 
> 标签：php, arrays, sorting

我想做一个数组排序方法，这样你就可以通过价格/ID号等对一些信息进行排序。

我的数组是这样的：

```
[1] 1002234985, $123.00, ITEM DESCRIPTION #1

[2] 1034234985, $143.70, ITEM DESCRIPTION #2

[3] 1002467455, $133.06, ITEM DESCRIPTION #3

[4] 1564334985, $883.11, ITEM DESCRIPTION #4 
```

我想按价格对数组进行排序，但要匹配描述和 ID 号。我怎样才能做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-03T23:13:27.900

编写`compare`函数（接收两个元素并返回哪个更大）并使用[usort](http://php.net/manual/en/function.usort.php)来使用它

一个例子：

```
$arr = array(
              array(1002234985, '125.00', 'ITEM DESCRIPTION'), 
              array(1002234986, '124.00', 'ITEM DESCRIPTION'), 
              array(1002234987, '123.00', 'ITEM DESCRIPTION')
);
function mycomp($itm1, $itm2){
    if($itm1[1] > $itm2[1]){
        return 1;
    }
    else if($itm1[1] < $itm2[1]){
        return -1;
    }
    else{
        return 0;
    }
}
usort($arr, 'mycomp');
print_r($arr); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-03T23:23:29.107

[这是一个使用 PHP 的usort](http://php.net/manual/en/function.usort.php)对多维数组进行排序的示例。

```
// Change this to the index of the key you wish to sort by
$sortBy = 0;

$myArray = array(
  array(1002234985, '$123.00', 'ITEM DESCRIPTION #1'),
  array(1034234985, '$143.70', 'ITEM DESCRIPTION #2'),
  array(1002467455, '$133.06', 'ITEM DESCRIPTION #3'),
  array(1564334985, '$883.11', 'ITEM DESCRIPTION #4')
];

usort($myArray, 'cmp');

function cmp($a, $b){
  if ($a[$sortBy] == $b[$sortBy]) {
    return 0;
  }
  return ($a[$sortBy] < $b[$sortBy]) ? -1 : 1;
} 
```

# javascript - 代码只执行一次，但应该继续

> ID：11320473
> 
> 赞同：0
> 
> 时间：2012-07-03T23:11:31.483
> 
> 标签：javascript, jquery

如果您将鼠标悬停在弹出窗口或按钮上，下面的代码应该会阻止弹出窗口关闭，但是，它仅在重新加载时有效，然后停止工作。

```
$('.popover3-test').popover({
    placement:'bottom',
    template: $('.popover2'),
    trigger: 'manual',

    }).mouseenter(function(e) {
    $(this).popover('show');

    var t = null;

    $(".popover2, .popover3-test")
        .mouseleave(function() {
            t = setTimeout(function() {
                $('.popover2').hide();
            }, 1000); // Or however many milliseconds
        })
        .mouseenter(function() {
            if(t !== null)
                clearTimeout(t);
         });
    }); 
```

演示：http: [//jsfiddle.net/MnpWV/1/](http://jsfiddle.net/MnpWV/1/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-03T23:21:59.710

尝试这个：

```
$(".popover2, .popover3-test")
        .mouseleave(function() {
           $('.popover2').delay(1000).fadeOut('1000');
        }
}); 
```

[http://jsfiddle.net/MnpWV/8/](http://jsfiddle.net/MnpWV/8/)

更新：

```
$(".popover2").hover(function(e) {
    $(this).show()
}, function() {
    $('this').delay(1000).fadeOut('1000');
}) 
```

[http://jsfiddle.net/MnpWV/16/](http://jsfiddle.net/MnpWV/16/)

删除`.popover3-test`触发`mouseleave`事件的。

# maven - 蝙蝠脚本意外退出

> ID：11320481
> 
> 赞同：3
> 
> 时间：2012-07-03T23:12:26.960
> 
> 标签：maven, batch-file

我有以下 bat 脚本：

```
@echo off
set JAVA_HOME=C:\Program Files\Java\jdk1.6.0_32
set JRE_HOME=C:\Program Files\Java\jdk1.6.0_32\jre
set Path=%JAVA_HOME%\bin;%Path%

cd C:\project
mvn validate compile package db-migration:migrate -DskipTests
REM script exits here, the second line never been executed
java  -jar target/compiled_tar.jar 
```

最后一行从未被执行。"mvn..." 成功完成，compiled_tar.jar 被创建，输出为：

```
[INFO] BUILD SUCCESS 
```

如果我在最后一行和上一行之间插入 PAUSE 命令，则 PAUSE 也从未发生过。为什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-03T23:17:42.593

`mvn`它本身就是一个`.bat`文件，因此（为了与 MS-DOS 1.0 兼容）Windows 将停止执行您的批处理文件。要解决此问题，请使用以下`call`命令：

```
call mvn validate compile package db-migration:migrate -DskipTests 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T07:41:29.330

使用这个 Maven 命令 (set maven_batch_pause=on) 将完美地解决这个问题：

```
@echo off

set JAVA_HOME=C:\Program Files\Java\jdk1.6.0_32
set JRE_HOME=C:\Program Files\Java\jdk1.6.0_32\jre
set Path=%JAVA_HOME%\bin;%Path%

set maven_batch_pause=on
cd C:\project
mvn validate compile package db-migration:migrate -DskipTests

REM The script exits here, and the second line will never be executed
java  -jar target/compiled_tar.jar 
```

# python - 如何为 Xcode 4 配置 Python 环境？

> ID：11320482
> 
> 赞同：1
> 
> 时间：2012-07-03T23:12:28.297
> 
> 标签：python, xcode, autocomplete

我想将我的 Xcode 4.3 环境配置为使用具有自动完成功能的 Python。例如，如果我输入 import numpy Xcode 将能够完成 numpy。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T00:37:14.363

与 Xcode 3.2 不同，Xcode 4.x 不支持 Python 项目。

[您可以通过使用项目模板（例如， https](https://github.com/chenhaiteng/Python-Project-Template-for-Xcode-4) ://github.com/chenhaiteng/Python-Project-Template-for-Xcode-4）来解决大部分缺失的功能。但是有一些事情你不能用这种方式处理，包括自动完成。（您也不能运行 Python 调试器等）

# ruby-on-rails - 使用 rspec/devise 进行登录集成测试

> ID：11320483
> 
> 赞同：0
> 
> 时间：2012-07-03T23:13:25.380
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rspec, devise

我在进行集成测试时遇到了麻烦，因为用户在我的 rails 应用程序中登录，通过。

我正在使用 Rspec 和 capybara，以及设计用户身份验证

这是我的代码：

请求/身份验证_spec.rb

```
describe 'log in' do
  before { visit root_path }
  subject { page }

  describe 'should be able to log in' do
    before do
      user = FactoryGirl.create(:user)
      fill_in :user_email, with: user.email
      fill_in :user_password, with: user.password
      click_on 'Log in'
    end
    it { should have_link 'Log out' }
  end
end 
```

工厂/user_factory.rb

```
FactoryGirl.define do
  factory :user do
    sequence( :first_name )  { |n| "FirstName#{n}" }
    sequence( :last_name )  { |n| "LastName#{n}" }
    sequence( :email ) { |n| "foo#{n}@example.com" }
    password              'foobar'
    password_confirmation 'foobar'
    created_at            Time.now
    updated_at            Time.now
  end
end 
```

_login_form.html.erb，此表单呈现在应用程序布局标题中。

```
<%= form_for(resource, as: resource_name, url: session_path(resource_name), html: { id: 'login-mini-form' }) do |f| %>
  <%= f.email_field :email,       placeholder: 'Your email' %>
  <%= f.password_field :password, placeholder: '******' %>
  <%= f.submit "Log in", id: 'login-button' %>

  <%- if devise_mapping.rememberable? -%>
    <%= f.check_box :remember_me %> <%= f.label :remember_me %>
  <%- end -%>

<% end %> 
```

在布局中，我有类似的东西：

```
if user_signed_in?
  render 'devise/menu/logout_button'
else
  render 'devise/menu/login_form'
end 
```

测试给了我

```
1) User should be able to log in with valid credentials 
     Failure/Error: it { should have_link 'Log out' }
       expected link "Log out" to return something
     # ./spec/requests/authentications_spec.rb:117:in `block (6 levels) in <top (required)>'

Finished in 0.71406 seconds
8 examples, 2 failures, 2 pending 
```

我不明白为什么我的测试没有通过。有任何想法吗 ？

非常感谢 ！

编辑：我得到相同的行为测试注册：`expect { click_button register_button }.to change(User, :count).by 1`，测试返回：

```
Failure/Error: expect { click_button register_button }.to change(User, :count).by 1
       count should have been changed by 1, but was changed by 0 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T11:07:29.010

所以，我发现什么不起作用：

```
describe 'log in' do
  before { visit root_path }
  subject { page }

  describe 'should be able to log in' do
    before do
      user = FactoryGirl.create(:user)
      fill_in :user_email, with: user.email
      fill_in :user_password, with: user.password
      click_on 'Log in'
    end
    it { should have_link 'Log out' }
  end 
```

正确的代码实际上是：

```
describe 'log in' do
  before { visit root_path }
    subject { page }

    describe 'should be able to log in' do
      before do
        user = FactoryGirl.create(:user)
        fill_in 'user_email', with: user.email
        fill_in 'user_password', with: user.password
        click_on 'Log in'
      end
      it { should have_link 'Log out' }
    end
  end
end 
```

似乎 Capybara fill_in 方法不将符号作为 ids 的参数，而仅将字符串作为参数。傻我。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-03T23:57:18.840

您没有提供您期望的主题，所以看起来 RSpec 正在使用最后一个表达式的结果。最后一个表达式是 your `click_button`，它不返回任何内容。你不能`should`什么都不叫。

要解决这个问题，您只需要指定页面应该有链接。我使用 Capybara 和 Selenium-Webdriver，所以对我来说它看起来像`page.should have_link...`. 我的 RSpec-fu 不够强大，无法知道您是否也应该使用`page`，或者替代`response`,`session`或其他东西。

# c# - rdr = cmd.ExecuteReader() 在标准表达式中给出数据类型不匹配

> ID：11320485
> 
> 赞同：0
> 
> 时间：2012-07-03T23:13:39.637
> 
> 标签：c#, types, criteria, mismatch

我对下面的代码有一些问题。给我一个错误的是`rdr = cmd.ExecuteReader();`，我不知道为什么。该代码假设检查 Items 表中是否有任何记录。任何帮助，将不胜感激。

```
protected void Page_Load(object sender, EventArgs e)
{
    OleDbConnection mDB = new OleDbConnection();
    mDB.ConnectionString = "Provider = Microsoft.Jet.OLEDB.4.0;Data source="
    + Server.MapPath("~/App_Data/Database.mdb");
    OleDbCommand cmd;
    OleDbDataReader rdr;
    int intOrderNo = int.Parse(Session["sOrderNo"].ToString());
    String strSql = "SELECT iProdID FROM Items WHERE iOrdersID = "+ intOrderNo;
    cmd = new OleDbCommand(strSql, mDB);
    mDB.Open();
    rdr = cmd.ExecuteReader();
    Boolean booRows = rdr.HasRows;
    if (booRows)
    {
        ShoppingCartLabel.Text = "Your Shopping Cart";
        if (Session["sFlag"] == "T")
        {
            BizCheckOutButton.Visible = true;
            CusCheckOutButton.Visible = false;
        }
        else
        {
            BizCheckOutButton.Visible = false;
            CusCheckOutButton.Visible = true;
        }
    }
    else
    {
        ShoppingCartLabel.Text = "Your Shopping Cart is empty";
        CusCheckOutButton.Visible = false;
        BizCheckOutButton.Visible = false;
    }
    mDB.Close();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-03T23:31:13.460

我没有看到您在代码中添加参数。你能添加参数并检查吗？喜欢，

```
OleDbCommand cmd = new OleDbCommand(<your sql query>, <your sql connection>);
cmd.Parameters.Add("order_no", OleDbType.Int);
cmd.Parameters["order_no"].Value = intOrderNo; 
```

# push-notification - APNS和消息的连续广播

> ID：11320488
> 
> 赞同：1
> 
> 时间：2012-07-03T23:14:29.450
> 
> 标签：push-notification, apple-push-notifications

所以我一直在为 iOS 开发一个即时通讯工具，当用户没有活动会话时，它使用 APNS 进行通知。

目前，如果用户处于活动状态，它不会发送通知，但有时可能会发送消息，然后用户在消息到达后一瞬间关闭应用程序。

这意味着用户可能会错过消息，因为没有发送通知。另一方面，如果一直发送通知，用户可能会在锁定屏幕上收到“叮咚”的声音。

我的问题是，是否与每条“行业标准”消息一起发送 APNS 通知？像 whatsapp/viber 这样的应用程序是这样做的，还是他们试图与 APNS 配合得很好，并且只在没有存储会话时才使用它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-03T23:36:42.920

虽然我不能告诉你它是否是“行业标准”（尽管我怀疑垃圾邮件这么多通知是“好”），但我只是想指出，当应用程序处于活动状态时通知到达时，你确实可以控制做什么（即您可以选择忽略通知而不播放声音）。所以不，用户不会得到“叮咚”的声音。

比向 APNS 发送垃圾邮件更好的方法可能是在消息显示 2 秒后将它们标记为“已读”。如果用户关闭应用程序，请使用 appicon 徽章显示“未读”消息的数量，从而防止您的瞬间应用关闭问题（用户会看到有 1 条未读消息）。

# objective-c - 读取 NSMutableArray

> ID：11320496
> 
> 赞同：0
> 
> 时间：2012-07-03T23:15:48.903
> 
> 标签：objective-c, xcode

如何读取包含此格式对象的数组：

```
Second pair: {
latitude = "26.499023";
longitude = "42.326061";
} 
```

??

编辑：

```
NO..this is the way I come up with that...   

NSArray *MaparrayLongitude = [dataMap objectForKey:@"longitude"];
NSArray *MaparrayLatitude = [dataMap objectForKey:@"latitude"];

if (MaparrayLongitude.count != MaparrayLatitude.count) {
    //Error: Unequal number of longitude/latitude values
} else {
    NSMutableArray *pairs = [NSMutableArray array];
    for (int i = 0; i < MaparrayLongitude.count; i++) {
        NSDictionary *pair = [NSDictionary dictionaryWithObjectsAndKeys:
                              [MaparrayLongitude objectAtIndex:i], @"longitude",
                              [MaparrayLatitude objectAtIndex:i], @"latitude", nil];
        [pairs addObject:pair]; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-03T23:20:14.023

我怀疑您正在寻找的答案称为 NSDictionary。我来自 PHP，如果它是数字索引或字符串键控，我们称它为数组；在 Objective-C 中，有 3 种基本类型的集合：

NSArray - 作为索引的有序自然整数

NSSet - 无序集合，单一成员

NSDictionary - 键入几种对象之一，通常是字符串。

[这是苹果的文档](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/nsdictionary_Class/Reference/Reference.html)

编辑：作为参考，这是您的代码最终可能的样子：

```
double myLat = [[secondPair objectForKey:@"latitude"] doubleValue]; 
```

编辑（在您编辑之后）：也许它是快速枚举，结合您寻求的字典访问：

```
for (NSDictionary *coordinate in pairs) {
  // lat = [coordinate objectForKey@"latitude"];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-03T23:28:21.980

嗯，这是一个简单的数据结构，有两个浮点值，所以我更喜欢

```
[NSValue valueWithCGPoint:CGPointMake(26.499023, 42.326061)]; 
```

并将其存储到数组中。为了获得价值，您可以这样做：

```
CGPoint coordinate = [[array objectAtIndex:index] CGPointValue]; 
```

* * *

您还可以定义 CGPoint 的名称，例如

```
typedef CGPoint YourCustomNameForPoint; 
```

然后像使用它

```
YourCustomNameForPoint coordinate = [[array objectAtIndex:index] CGPointValue]; 
```

它不会导致混乱。;)

# security - 如何让用户安全地在我的网站上分享视频

> ID：11320499
> 
> 赞同：0
> 
> 时间：2012-07-03T23:16:19.473
> 
> 标签：security, node.js, couchdb, express

刚读完一本关于 Web App Security 的很棒的书，我有一个安全问题。我想允许用户在我的网站上分享视频。将它们限制为 youtube 和 vimeo 嵌入没有问题，无论如何都可以节省存储空间，但我不希望在站点上运行不受信任的代码。

那么，最好的方法是什么？

仅供参考，我在 node.js 和 couchdb 之上使用 express.js 作为数据库。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T08:44:03.443

你指的是什么不受信任的代码？您可以在数据库中存储对外部视频的引用，并使用它们在您的视图中嵌入播放器。无需在您的服务器上运行来自 Youtube 或 Vimeo 的代码即可完成此操作。Youtube API 还使您能够允许用户从浏览器直接将视频上传到 Youtube，而无需通过您的网络服务器进行代理。这意味着用户可以在应用程序的服务器端上传和嵌入 youtube 视频，而无需任何第三方代码。

[https://developers.google.com/youtube/2.0/developers_guide_protocol_browser_based_uploading#Browser_based_uploading](https://developers.google.com/youtube/2.0/developers_guide_protocol_browser_based_uploading#Browser_based_uploading)

要从视频 ID 创建链接，您可以简单地使用：

```
var directLink = "http://youtube.com/watch?v={0}".format(videoId);
var embedLink = "http://youtube.com/embed/watch?v={0}".format(videoId);
var shortLink = "http://youtu.be/watch?v={0}".format(videoId); 
```

# c++ - 使用 Boost 的 C++ 中的正则表达式

> ID：11320500
> 
> 赞同：1
> 
> 时间：2012-07-03T23:16:20.003
> 
> 标签：c++, regex, boost, boost-regex

到目前为止..我有这个测试字符串：

```
Hello {John|Paul|Cindy}, hows {david}? 
```

我的表达是：

```
(\{\w+\}) 
```

但是，它只返回大卫。我希望能够抓住约翰、保罗和辛迪。只有 0 或 2 个竖线。有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-03T23:46:24.630

如果不是某种竞争，我会简单地使用两个正则表达式：

`{[\w|]+}`抓取每对大括号及其内容，然后在每个结果`\w+`上提取单词。

仅使用一个正则表达式就不能简单了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-03T23:28:32.390

如果只有 0 或 2 个竖线：

```
(\{\w+\}|\{\w+\|\w+\|\w+\}) 
```

对于 0 个或更多：

```
(\{\w+(\|\w+)*\}) 
```

# node.js - 如何使用中间件，特别是 Formidable，与 Bogart 一起创建服务器响应？

> ID：11320501
> 
> 赞同：1
> 
> 时间：2012-07-03T23:16:32.833
> 
> 标签：node.js, middleware

我正在使用[Bogart](https://github.com/nrstott/bogart)框架构建一个 node.js 应用程序，我想使用[Formidable](https://github.com/felixge/node-formidable)处理文件上传。

这是我的 HTML（或多或少直接从 Formidable 文档中复制而来）：

```
<form action="/upload" enctype="multipart/form-data" method="post">
    <input type="text" name="title"><br>
    <input type="file" name="upload" multiple="multiple"><br>
    <input type="submit" value="Upload">
</form> 
```

这是我的服务器代码：

```
var bogart = require('bogart'),
formidable = require('formidable');

var router = bogart.router();

router.post('/upload', function(req) {
    var form = new formidable.IncomingForm();
    var res = bogart.res();
    console.log("Beginning to parse files.");

    form.parse(req, function(err, fields, files) {
        console.log("Completed parsing files.");
        res.setHeader('Content-Type', 'text/plain');
        if (err) {
            console.log("Upload error.")
            res.status(500);
            res.send('Error');
            return res.end();
        }
        res.status(200);
        res.send("Success.");
        res.end();
    });
    return res;
});

var app = bogart.app();
app.use(bogart.batteries);
app.use(router);
app.start(8991, '127.0.0.1'); 
```

当我提交数据时，我的节点服务器记录`"Beginning to parse files."`，表明它已收到 POST，但是`"Completed parsing files."`，在 form.parse() 回调中，从未被记录，所以我认为解析一定有问题。我没有收到其他错误——客户端只是无限期地等待服务器响应。

我的预感是我不明白如何正确使用中间件，但我也不确定调用 Formidable 中间件是否正确，尽管它似乎在中间件......

# php - 检查数组元素是否具有特定值

> ID：11320510
> 
> 赞同：0
> 
> 时间：2012-07-03T23:17:40.780
> 
> 标签：php, arrays, codeigniter

我试图组合一个方法来查看 Codeigniter 购物车并根据购物车中物品的 id 确定交易类型

方法如下

```
function parse_transaction_type() {
            $card_skus = array("MYU_SC1","MYU_SC2","MYU_SC3");
            $fee_skus = array("MYU_SF1","MYU_AD1","MYU_AD2");
            foreach ($this->cart->contents() as $key => $item) {
                if(in_array($item['id'], $card_skus) && in_array($item['id'], $fee_skus))
                {
                    $type = "fees-cards";
                }
                if (in_array($item['id'], $card_skus) && !in_array($item['id'], $fee_skus))
                {
                    $type ="cards";
                }
                if (in_array($item['id'], $fee_skus) && !in_array($item['id'], $card_skus))
                {
                    $type ="fees";
                }
            }

            echo $type;
        } 
```

即使两者都存在，该方法也只返回“卡”或“费用”。做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-03T23:25:24.737

您应该为要检查的每种类型使用布尔标志，然后根据两个标志的值分配字符串（或做任何事情）。在循环之前将它们初始化为 FALSE，然后当您发现每种类型的项目时，将其标志设置为 TRUE。

然后，您可以优化循环以检查两者是否已经为真 和`break`，以便在前两项各为一项的情况下，您可以跳过其余的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-03T23:32:45.560

您的代码通过了第一个`if`，因为该术语在两者中都有。该脚本继续到您的第二个`if`，它再次通过并重新分配`$type`您应该使用`else if`。

```
parse_transaction_type() {
  $card_skus = array("MYU_SC1","MYU_SC2","MYU_SC3");
  $fee_skus = array("MYU_SF1","MYU_AD1","MYU_AD2");
  foreach ($this->cart->contents() as $key => $item) {
    if(in_array($item['id'], $card_skus) && in_array($item['id'], $fee_skus)){
      $type = "fees-cards";
    }
    else if (in_array($item['id'], $card_skus) && !in_array($item['id'], $fee_skus)){
      $type ="cards";
    }
    else if (in_array($item['id'], $fee_skus) && !in_array($item['id'], $card_skus)){
      $type ="fees";
    }
  }
  echo $type;
} 
```

# java - Jython：包含自定义 java 类 [oanda]

> ID：11320514
> 
> 赞同：1
> 
> 时间：2012-07-03T23:17:58.827
> 
> 标签：java, jython

```
 >>> import sys
  >>> sys.path.append("/usr/local/oanda_fxtrade.jar") # add the jar to your path
   >>> 
  >>> import com.oanda.fxtrade.api.test.Example1 as main1
  >>> import com.oanda.fxtrade.api.test.Example2 as cancel
  main1("JPY",9,'-1')
  TypeError: main1("JPY",9,'-1'): expected 0 args; got 3 
```

这似乎没有错误 - 但我真的需要一些参数

cancel()
线程[Thread-0,5,main]

内部java类

```
 public final class Example1 extends Thread {
  private Example1() {
        super();
    }
 public static void main(String[] args) throws Exception {
FXClient fxclient  = API.createFXGame();

String username = "foo";
String password = "foo";
String sel=args[0];
String str1=args[1];
    String str2=args[2]; 
```

main1.main("JPY 9 -1")

TypeError: main(): 1st arg 不能被强制转换为 String[]

好的，我想我已经进入了一个新的水平

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-03T23:50:23.187

后

```
import com.oanda.fxtrade.api.test.Example1 as main1 
```

main1 是类。在 java 中，执行该类将运行 main 但这并不意味着您可以将 args 传递给该类。

尝试：

```
main1.main(["JPY","9","-1"]) 
```

**编辑：** 这里有两个单独的问题。

对于随后的错误`Could not initialize class com.oanda.fxtrade.api.API`......看起来您应该查看这个问题：[为什么 Jython 拒绝找到我的 Java 包？](https://stackoverflow.com/questions/1681849/why-does-jython-refuse-to-find-my-java-package)

调用 sys.path.append 添加 jar 不允许在加载时发生的包扫描器操作。您应该尝试手动导入所需的模块/类，或者在调用 jython 之前 将 jar 添加到**CLASSPATH 。**

从这里开始，我认为 jython 答案就在其中，它变成了一个*com.oanda.fxtrade.api*问题，可能超出了 SO 范围。

# ruby-on-rails-3.1 - Rails SIMple 从发布到不同的控制器创建动作

> ID：11320518
> 
> 赞同：0
> 
> 时间：2012-07-03T23:19:12.507
> 
> 标签：ruby-on-rails-3.1, controller, simple-form

我有 3 个模型。用户、组和成员资格。User 和 Group 通过 Membership 具有 has_many 关系。我希望能够通过单击组显示视图中的加入按钮来创建成员资格。

Groups 控制器上的 Show 视图的一部分

```
= simple_form_for @membership, :url => memberships_path do |f|
  = f.input :group_id, :value => @group.id, :as => :hidden
  = f.submit "Join This Group!" 
```

我在组显示操作中设置了@membership，`@membership = Membership.new` 只是想弄清楚我需要做什么才能将上面的内容传递给成员控制器上的创建操作。现在它似乎正试图将其传递给成员控制器中的 show 动作。感谢您的任何帮助，您可以提供。

编辑：问题不在于这没有传递给会员资格。那是它没有将 group_id 传递给成员资格。以下是解决我的问题

```
= simple_form_for @membership do |f|
  = f.input :group_id, :input_html => { :value => @group.id }, :as => :hidden
  = f.submit "Join This Group!" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T00:15:32.180

如果您将 @user 实例变量设置为当前用户 ID，则可以使用

```
 simple_form_for [@user, @membership] do |f| 
```

# django - GAE 中的 NoReverseMatch

> ID：11320519
> 
> 赞同：0
> 
> 时间：2012-07-03T23:19:23.507
> 
> 标签：django, google-app-engine

我正在使用 GAE 1.7.0 版和从 Google 的示例应用程序下载的“django_example”应用程序。如果我使用 运行这个应用程序`dev_appserver.py`，它工作正常。

然后我修改了应用程序以使用 Django 1.2（默认情况下它使用 0.96）。我登录，然后单击“创建新礼物”，然后我得到：

> 渲染时捕获 NoReverseMatch：“views.edit”的反向参数“（”，）”和关键字参数“{}”未找到。

调试屏幕将有问题的行（in `gift.html`）显示为

```
<form action="<span class="specific">{%url views.edit gift.key.id%}</span>" method="post"> 
```

使用“创建新礼物”按钮，`gift.key.id`等于`None`。我也尝试使用 Django 1.3 并得到了类似的错误。

有人能告诉我为什么它适用于 0.96，但不适用于 1.2 或 1.3？

更新：

对于任何这些测试，我都没有修改原始示例中的“urls.py”。该文件包含：

```
from django.conf.urls.defaults import *

urlpatterns = patterns(
  '',
  (r'^$', 'views.index'),
  (r'^new$', 'views.new'),
  (r'^edit/(\d+)$', 'views.edit'),
  ) 
```

# scala - Scala：基于类型参数过滤集合

> ID：11320520
> 
> 赞同：4
> 
> 时间：2012-07-03T23:19:38.137
> 
> 标签：scala, collections, type-erasure

假设我可以控制这两个类并且我需要协变过滤，那么根据这些对象的类型参数过滤对象集合的最佳方法是什么？

这是一些无法正常工作的代码：

```
trait Foo
case class Foo1() extends Foo
trait ReadableFoo extends Foo {def field: Int}
case class Foo2(field: Int, flag: Boolean) extends ReadableFoo
case class Foo3(field: Int, name: String) extends ReadableFoo

case class Bar[+F <: Foo](foo: F)

val seq = Seq(
  Bar[Foo1](Foo1()),
  Bar[Foo2](Foo2(1,true)), 
  Bar[Foo3](Foo3(1,"Fooz"))
)

// Should keep one
val first = seq collect {case x: Bar[Foo2] => x}

// Should keep two
val both = seq collect {case x: Bar[ReadableFoo] => x} 
```

现在，我知道这是因为`case x: Bar[Foo1]`通过类型擦除将其转换为`case x: Bar[_]`编译后。我一直无法使用清单来解决这个问题。有没有办法添加一个成员类型（即`memberType = F`）`Bar`，我可以像这样打开`case x if (x.memberType <:< ReadableFoo) => x`？

**更新**

0__ 很快就找到了解决原问题的好办法。一个轻微的修改是当案例类字段本身是一个集合时：

```
case class Bar[+F <: Foo](foo: Seq[F])

val seq = Seq(
  Bar[Foo1](Seq(Foo1())),
  Bar[Foo2](Seq(Foo2(1,true))),
  Bar[ReadableFoo](Seq(Foo2(1,true), Foo3(1,"Fooz")))
)

// Should keep one
val first = seq collect {case x: Bar[Foo2] => x}

// Should keep two
val both = seq collect {case x: Bar[ReadableFoo] => x} 
```

我不确定这是否可行，因为`Seq`可能是空的，因此没有要测试的元素。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-03T23:36:33.450

您可以将提取器与类型检查结合使用：

```
val first = seq collect { case x @ Bar(_: Foo2)        => x }
val both  = seq collect { case x @ Bar(_: ReadableFoo) => x } 
```

但是返回类型仍然是`List[Bar[Foo]]`......所以如果你需要它，使用这种方法你需要强制转换或重新构造`Bar`对象（`case Bar(f: Foo2) => Bar(f)`）。

* * *

我猜你正在`Seq`寻找一个异类？`collect``Seq`

```
case class Bar(seq: Seq[Foo])

def onlyFoo2(b: Bar) = Bar(b.seq.collect { case f: Foo2 => f })

onlyFoo2(Bar(Seq(Foo1(), Foo2(1, true)))) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T03:04:16.493

我不知道提取器技巧中的类型检查，因此我对您的第一个问题的最初解决方案会有所不同。我会提供一个提取器`ReadableFoo`

```
object ReadableFoo { def unapply(x: ReadableFoo) = Some(x.field) } 
```

然后你可以做

```
val first = seq collect { case x @ Bar(Foo2(_,_)) => x }
val both  = seq collect { case x @ Bar(ReadableFoo(_)) => x } 
```

但是对于您更新的代码，我认为您需要拖动清单。

```
case class Bar[+F <: Foo : Manifest](foo: Seq[F]) { 
    def manifest = implicitly[Manifest[_ <: F]] 
} 
```

由于 Bar 是协变的并且 Manifest 是不变的，我们不能简单地承诺返回 Manifest[F] 而是返回 F 的某个子类型的 Manifest。（我想这是您尝试使用清单时的问题？）
之后你可以做

```
val first = seq collect {case x if x.manifest <:< manifest[Foo2] => x}
val both = seq collect {case x if x.manifest <:< manifest[ReadableFoo] => x} 
```

尽管如此，使用清单总是让人觉得有点 hacky。我会看看我是否可以使用不同的方法并尽可能少地依赖类型匹配和具体化。

# paypal - Paypal 自适应支付：支付链式/错误 550001 feepayer

> ID：11320530
> 
> 赞同：1
> 
> 时间：2012-07-03T23:20:53.503
> 
> 标签：paypal, paypal-adaptive-payments

如何在我的实时应用程序中设置费用支付者？

我想要的链式支付是让次要收款人支付贝宝费用。但是，当我在调用 API 时设置了 feepayer 属性时，我得到了 550001 错误。

从我阅读的内容来看，我的实时应用程序无权使用此功能。我怎样才能得到这个功能？当我提交应用程序时，它已经被请求了。

另外，有没有人知道 paypal/x.com 开发人员应该在哪里发布他们的票/问题？

看起来 x.com 开发者论坛是一个无人问津的地方，没有任何问题得到解答。金额让我担心贝宝也会忽略我的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-04T03:40:37.820

你必须确保两件事。1) 确保您用作 API 调用者的 PayPal 帐户**经过验证**（即您有一个与之关联的银行帐户）并且是高级帐户或企业帐户。个人帐户不适用于此。

2) 当您提交申请时，您必须检查第二接收人支付费用的字段。问题是即使您可能已经检查过它，有时表单审阅者也会错过它。为确保您拥有权限，您需要为其提交支持票。

商家技术服务是这样做的地方：http: [//www.paypal.com/mts](http://www.paypal.com/mts)

祝你好运！

# ruby - 如何使用参数中给出名称的模块扩展 ruby 中的对象？

> ID：11320537
> 
> 赞同：5
> 
> 时间：2012-07-03T23:21:21.000
> 
> 标签：ruby, inheritance

我想用一个模块扩展一个 Ruby 对象，但我希望能够在运行时更改要使用的模块，并且能够通过对象来改变它。换句话说，我想将模块的名称`extend`作为参数传递给。我怎样才能做到这一点？

我尝试了以下方法：

```
module M1
end

module M2
end

class C
  def initialize module_to_use
    extend module_to_use
  end
end

m = get_module_name_from_config_file
c1 = C.new m 
```

（假设该方法`get_module_name_from_config_file`返回`String`带有所需模块名称的 a - 此处为`"M1"`或`"M2"`。）

但我明白了：

```
error: wrong argument type String (expected Module). 
```

因为`m`是 type `String`，不是`Module`，很明显。我也尝试将它`m`作为一个符号，但我遇到了同样的问题（在错误消息中替换为）`String`。`Symbol`

那么，我可以转换`m`成某种类型的东西`Module`吗？还是有另一种方法可以实现这一目标？

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-03T23:52:45.583

你可以这样做（`const_get`根据 Jörg W Mittag 的建议修改为使用）

```
module M1
end

module M2
end

class C
  def initialize module_to_use
    extend module_to_use
  end
end

m = Module::const_get("M1")
c1 = C.new m 
```

顺便说一句，您在上面的代码中有一些错误 -`class`并且`module`应该是小写的。

# javascript - 通过 .load() 加载的脚本失败

> ID：11320545
> 
> 赞同：1
> 
> 时间：2012-07-03T23:22:40.187
> 
> 标签：javascript, jquery, html, ajax

我正在加载一个`.load()`包含如下脚本的联系人页面：

```
<script type="text/javascript">

    $('#submit').click(function(e){
        e.preventDefault();
        var name = $('#name').val();
        var email = $('#email').val();
        var message = $('#message').val();
        $.post("<?php echo bloginfo( 'template_directory' ) . '/inc/mailit.php';?>", 
            {
                name: name,
                email: email,
                message: message
            },
            function(data) {
                var n = data.indexOf('<span class="success_message">');
                if (n !== 0) {
                    $('#message_box_1').empty().append(data);
                } else {
                    $('#contact_form').empty().append(data);
                }
            }
        );
    });
</script> 
```

当我直接加载联系页面（即转到`http://example.com/contact-us`）时，该脚本工作正常，但当我使用`.load()`. 当我单击`#submit`时，表单提交而不运行脚本。有什么想法吗？

哦，加载脚本如下所示：

```
<script>
$('#top_links a').click(function (e) {
    e.preventDefault();
    var link = $(this).attr('href');
    $('#content').empty();

    $('#content').load(link + ' #content > *');

});
</script> 
```

**更新：**

感谢@pointy 指出`.load()`. 所以现在我修改了我的代码以使用`$.get`：

```
<script>
$('#top_links a').click(function (e) {
    e.preventDefault();
    var link = $(this).attr('href');
    $('#content').empty();

    $.get(link, { }, 
        function(data) {
            $('#content').replaceWith($(data).find("#content"));
        }
    )
});
</script> 
```

问题是一样的，当用户点击提交按钮时，上面的 AJAX Script 仍然没有阻止表单提交或发送 post 请求。我已将两个脚本放在正在加载的内容之外`$.get`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-03T23:24:53.790

当您像您正在做的那样在 URL 之后加载`.load()`并使用选择器时，jQuery 根本不会在加载的内容中运行任何脚本。它明确地将它们剥离并扔掉。

我认为这样做的主要原因是，由于它丢弃了已加载的页面的某些部分，因此它不知道所选内容中的嵌入脚本是否可以在*未*选择页面上没有其他 JavaScript 的情况下工作。

*编辑*——不幸的是，你的替代代码也会遇到同样的问题。问题在于`$(data)`将返回的页面 HTML 转换为文档片段。这在 jQuery 内部，将通过一个名为“clean”的函数来去除脚本。`$(data)`它确实保存了它们，但是在函数调用返回时它们被丢弃了。

*如果您可以找到一种方法让您的服务器*完成确定它不必返回完整页面的工作，那么它可能会更加顺畅。无论如何，它会让事情变得更快；当您只使用其中的一部分时，发送一个完整的页面是没有意义的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T03:49:13.410

问题是提交按钮是动态加载的内容，我需要使用 live()。`$("#submit").live("click", function(e){})`

# mediaelement.js - 使用 MediaElement.js 拉伸视频以填充 div

> ID：11320546
> 
> 赞同：3
> 
> 时间：2012-07-03T23:23:03.543
> 
> 标签：mediaelement.js

可能吗？

我知道这是完全不同的事情，但是使用 jw 媒体播放器，您可以选择拉伸视频以填充 div。只是 html5 对这些事情嗤之以鼻？

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-06-10T19:10:22.913

根据上面的答案，以下对我有用：

```
// Get video container width and height
var w = $('#video').parent().width();
var h = $('#video').parent().height();
$('#video')
    .attr('width', w)
    .attr('height', h)
    .delay( 500 )  // don't know why, but without this sometimes it doesn't work.
    .mediaelementplayer({
        defaultVideoWidth: w
        , defaultVideoHeight: h
        , videoWidth: -1
        , videoHeight: -1
        , enableAutosize: true
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-04T15:12:10.103

尝试设置以下

```
<div id="mediaContent">
                    <video id="mediaPlayer"  width="100%" height="100%">
                        <source type="video/mp4" src="http://clips.vorwaerts-gmbh.debig_buck_bunny.mp4" /> 

                    </video>
                </div> 
```

然后将您的容器 div mediaContent 在您的 CSS 中设置为您想要的任何大小。然后视频将重新调整到容器的大小。严格来说，宽度和高度应该是绝对像素尺寸，但设置为 % 有效。

然后，您可能必须使用类似的东西设置元素

```
 $(document).ready(function () {

        var myPlayer = $('#mediaPlayer');  

        var w = parseInt($('#mediaContent').css('width'));
        var h = parseInt($('#mediaContent').css('height')) ;

        myPlayer.mediaelementplayer({
            // if the <video width> is not specified, this is the default
            defaultVideoWidth: w ,
            // if the <video height> is not specified, this is the default
            defaultVideoHeight: h,
            // if set, overrides <video width>
            videoWidth: -1,
            // if set, overrides <video height>
            videoHeight: -1,
            // width of audio player
            audioWidth: 400,
            // height of audio player
            audioHeight: 30,
            // initial volume when the player starts
            startVolume: 0.8,
            // useful for <audio> player loops
            loop: false,
            // enables Flash and Silverlight to resize to content size
            enableAutosize: true,
            // the order of controls you want on the control bar (and other plugins below)
            features: ['playpause', 'progress', 'current', 'duration', 'tracks', 'volume', 'fullscreen'],
            // Hide controls when playing and mouse is not over the video
            alwaysShowControls: false,

            // forces the hour marker (##:00:00)
            alwaysShowHours: false,
            // show framecount in timecode (##:00:00:00)
            showTimecodeFrameCount: false,
            // used when showTimecodeFrameCount is set to true
            framesPerSecond: 25,
            // turns keyboard support on and off for this instance
            enableKeyboard: true,
            // when this player starts, it will pause other players
            pauseOtherPlayers: true,
            // array of keyboard commands
            keyActions: []

        });
  }); 
```

# c# - 重用需要参数的 Button 模板

> ID：11320552
> 
> 赞同：1
> 
> 时间：2012-07-03T23:24:42.337
> 
> 标签：c#, .net, wpf, binding, datatemplate

我有几个按钮，我设置如下：

```
<Button Template="{DynamicResource btnTmplt}" Command="{Binding ImgChgeCmd}" >
  <Button.Resources>
  <ControlTemplate x:Key="btnTmplt" TargetType="{x:Type Button}">
    <StackPanel x:Name="stPanel" HorizontalAlignment="Left" Width="Auto" 
                Height="Auto" Orientation="Horizontal">
    <Image x:Name="img" Source=""></Image>
    </StackPanel>
      <ControlTemplate.Triggers>
        <Trigger Property="IsEnabled" Value="False">
          <Trigger.Setters>
            <Setter TargetName="img" Property="Source" 
Here--------->      Value="{Binding FirstImage, Converter={StaticResource GrayScaleConverter}}" />
            <Setter TargetName="stPanel" Property="BitmapEffect">
              <Setter.Value>
                <BlurBitmapEffect Radius="1" />
              </Setter.Value>
            </Setter>
          </Trigger.Setters>
        </Trigger>
        <Trigger Property="IsEnabled" Value="True">
          <Trigger.Setters>
And Here--> <Setter TargetName="img" Property="Source" Value="{Binding FirstImage}" />
            <Setter TargetName="stPanel" Property="BitmapEffect" Value="{x:Null}" />
          </Trigger.Setters>
        </Trigger>
      </ControlTemplate.Triggers>
    </ControlTemplate>
  </Button.Resources>
</Button> 
```

Button.Resources 部分在所有这些按钮中几乎相同。不同的两行是上面“Here--->”指示的值绑定。

这些差异允许我为每个按钮加载不同的图像。

**有没有办法进行设置，这样我就不必为每个按钮复制 Button.Resources 了？** （但仍然在每个按钮中加载不同的图像）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T02:22:34.623

您可以创建自定义控件。我已经做了一个简单的例子，但你可以自定义控件以随心所欲地表现（它非常强大）。另外请注意 BitMapEffects 已被弃用，如果您尝试在 .net 4 中使用它们，您将遇到异常。无论如何...创建一个自定义控件，例如：

```
public class VaccanoButton : Button
{        
    static VaccanoButton()
    {
        DefaultStyleKeyProperty.OverrideMetadata(typeof(VaccanoButton), new FrameworkPropertyMetadata(typeof(VaccanoButton)));
    }

    public ImageSource FirstImage
    {
        get { return (ImageSource)GetValue(FirstImageProperty); }   
        set { SetValue(FirstImageProperty, value); }
    }

    // Using a DependencyProperty as the backing store for FirstImage.  This enables animation, styling, binding, etc...
    public static readonly DependencyProperty FirstImageProperty =
        DependencyProperty.Register("FirstImage", typeof(ImageSource), typeof(VaccanoButton), new UIPropertyMetadata(null));  
} 
```

并在 Generic.xaml 中设置 xaml，如下所示：（注意：我取出了您的 GrayScaleConverter，因为我没有它的代码，只需将其作为资源放回原处，它应该可以工作）

```
<Style TargetType="{x:Type local:VaccanoButton}">
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="{x:Type local:VaccanoButton}">
                <Button>
                    <StackPanel x:Name="stPanel" HorizontalAlignment="Left" Width="Auto"  
                Height="Auto" Orientation="Horizontal">
                        <Image x:Name="img"></Image>
                    </StackPanel>
                </Button>
                <ControlTemplate.Triggers>
                    <Trigger Property="IsEnabled" Value="False">
                            <Setter TargetName="img" Property="Source" Value="{Binding RelativeSource={RelativeSource Mode=TemplatedParent}, Path=FirstImage}" />
                            <Setter TargetName="stPanel" Property="BitmapEffect">
                                <Setter.Value>
                                    <BlurBitmapEffect Radius="1"  />
                                </Setter.Value>
                            </Setter>
                    </Trigger>
                    <Trigger Property="IsEnabled" Value="True">
                        <Trigger.Setters>
                            <Setter TargetName="img" Property="Source" Value="{Binding RelativeSource={RelativeSource Mode=TemplatedParent}, Path=FirstImage}" />
                            <Setter TargetName="stPanel" Property="BitmapEffect" Value="{x:Null}" />
                        </Trigger.Setters>
                    </Trigger>
                </ControlTemplate.Triggers>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

然后像这样使用它：

```
 <local:VaccanoButton FirstImage="\Untitled.png"/> 
```

# perl - Mojolicious 测试和 plackup 实时运行不同

> ID：11320553
> 
> 赞同：2
> 
> 时间：2012-07-03T23:24:51.810
> 
> 标签：perl, mojolicious

有时当我运行测试时，我会得到以下信息。

```
# Inactivity timeout 
```

[Mojo 的文档](http://mojolicio.us/perldoc/Mojolicious/Guides/Cookbook#EventSource_web_service)似乎建议添加

```
Mojo::IOLoop->stream($self->tx->connection)->timeout(300); 
```

但是，当我尝试将其添加到程序中时，我在`plackup`运行实例上收到此错误

```
[fatal] Processing request failed: encountered object 'Can't call method "timeout" on an undefined value at ... line 22. 
```

超时的可能原因是由于通过使用 LWP 的客户端库运行的 HTTP 请求非常慢（尽管我尝试将 LWP 替换为[AnyEvent::HTTP::LWP::UserAgent](https://metacpan.org/module/AnyEvent%3a%3aHTTP%3a%3aLWP%3a%3aUserAgent)而没有任何真正的代码更改，只是传递一个不同的用户代理）

我想知道我可能会尝试做些什么来保持连接在测试中运行，我似乎对通过 chrome 的实时请求没有问题，或者我应该完全转向不同的方向？

# c# - C# 电子邮件密件抄送显示错误的收件人电子邮件地址。

> ID：11320558
> 
> 赞同：0
> 
> 时间：2012-07-03T23:25:28.837
> 
> 标签：c#, .net

我在密件抄送方面遇到了一个奇怪的问题。接收邮件的收件人，但在收件人：字段中具有收件人电子邮件地址。因此，例如 bcc1@server.com 收件人在正确的邮箱中获得正确的消息，但 To: 字段而不是 to@server.com 而不是 bcc1@server.com。与 bcc2 相同。任何人都可以看到一个问题？我做错了什么？

```
MailAddress from = new MailAddress("from@server.com", "Ben Miller");
MailAddress to = new MailAddress("to@server.com", "Jane Clayton");
MailMessage message = new MailMessage(from, to);
message.Subject = "Test Subject.";
message.IsBodyHtml = true;
message.Body = "Some body text";
MailAddress bcc1 = new MailAddress("bcc1@server.com", "BCC1 Reciever");
message.Bcc.Add(bcc1);
MailAddress bcc2 = new MailAddress("bcc2@server.com", "BCC2 Reciever");
message.Bcc.Add(bcc2);

SmtpClient client = new SmtpClient(server);
System.Net.NetworkCredential SMTPUserInfo = new           System.Net.NetworkCredential("from@server.com", "pass");
client.UseDefaultCredentials = true;
client.Credentials = SMTPUserInfo;

client.Send(message); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T00:04:22.643

# bash - Bash - 打印 CSV 文件

> ID：11320560
> 
> 赞同：2
> 
> 时间：2012-07-03T23:25:50.370
> 
> 标签：bash, csv

我正在尝试使用某些列宽打印 CSV 文件。我认为 i 有一个错误导致第一列不打印。正如您将看到的，我是 bash 的新手，并且拼命想让它表现得像 C。

```
CSV='./test.csv'
column_width=(20 6 5 10 10 10 10 8 30)

IFS=","
        while read LINE
        do
                set -- $LINE
                arg=($@)
                for (( i = 0 ; i < ${#arg[@]} ; i++))
                do
                        case $i in
                                1) printf "%-20s"   ${arg[$i]} ;;
                                2) printf "%-6s"    ${arg[$i]} ;;
                                3) printf "%-5s"    ${arg[$i]} ;;
                                4) printf "%-10s"   ${arg[$i]} ;;
                                5) printf "%-10s"   ${arg[$i]} ;;
                                6) printf "%-10s"   ${arg[$i]} ;;
                                7) printf "%-10s"   ${arg[$i]} ;;
                                8) printf "%-8s"    ${arg[$i]} ;;
                                9) printf "%-30s\n" ${arg[$i]} ;;
                        esac
                done
        done < $CSV
        unset IFS 
```

我也无法将 case 语句转换为循环。无济于事，我尝试将整个 C 风格的 for 循环替换为：

```
for i in "${arg[@]}"; do
        printf "%-${column_width[$i]}s" ${arg[$i]}
done 
```

我确信有更好的方法来实现这一点。我正在尝试了解 sed/awk，但我现在想知道如何在没有它们的情况下做到这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T00:01:53.130

我认为脚本非常优雅。你将很难用任何语言更简洁地做到这一点（尽管这使用了我不喜欢的 bashisms :->）

由于我更倾向于避免脚本逻辑和使用您的编辑器的宏功能方面，这将是我的版本。

```
#!/bin/sh

CSV='./test.csv'

while IFS=, read one two three four five six seven eight nine
do
    test "$one"   && printf %s-20s "$one"
    test "$two"   && printf %s-6s  "$two"
    test "$three" && printf %s-5s  "$three"
    test "$four"  && printf %s-10s "$four"
    test "$five"  && printf %s-10s "$five"
    test "$six"   && printf %s-10s "$six"
    test "$seven" && printf %s-10s "$seven"
    test "$eight" && printf %s-8s  "$eight"
    test "$nine"  && printf %s-30s "$nine"
    printf \\n
done < "$CSV"   # mind the quoting 
```

我个人认为它更令人赏心悦目（并且没有 bashisms！），但是 YMMV。我也会避免进行广泛的测试，但如果可能的话就简单地打印。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-04T08:06:40.063

```
#!/usr/bin/env bash

csv=./test.csv
column_width=(20 6 5 10 10 10 10 8 30)

while n=0; IFS=, read -ra x; do
    printf '%-*s' {,,,,,,,,}{"${column_width[n]}","${x[n++]}"} 1 $'\n'
done <"$csv" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-04T02:06:44.207

干得好，反对派。

脚本中的错误是因为即使在 Bash 中的数组索引也以 0 开头，而您的 switch case 没有。我能想到的最小变化是“移动”数组`arg`。尝试使用`arg=(0 $@)`. 您可以在数组的第 0 个索引处使用任何其他值。将处理不存在的 0 案例。

# android - Monodroid 上的 ContextMenuCreated 事件

> ID：11320563
> 
> 赞同：-1
> 
> 时间：2012-07-03T23:26:14.313
> 
> 标签：android, dialog, contextmenu, xamarin.android

我想在对话框中创建一个上下文菜单，并尝试使用 List View 控件中的此事件 ContextMenuCreated。所以我用它创建了上下文菜单，但我想知道如何将方法委托给我创建的那些菜单项。这是代码：

```
dialogFilter.RegisterForContextMenu(listView);

        listView.ContextMenuCreated += delegate(object sender, CreateContextMenuEventArgs e) {
            e.Menu.SetHeaderTitle("Options");
            e.Menu.Add(0,1,1,"Edit");
            e.Menu.Add(0,2,1,"Delete");
        }; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-03T23:44:50.247

也许这就是你正在寻找的：

```
public override void OnCreateContextMenu(IContextMenu menu, View v, ContextMenuContextMenuInfo menuInfo)
{
    base.OnCreateContextMenu(menu, v, menuInfo);
    menu.SetHeaderTitle("Options");
    menu.Add(0,1,1,"Edit");
    menu.Add(0,2,1,"Delete");
}

public override bool OnContextItemSelected(IMenuItem item)
{
    Toast.MakeText(this, item.TitleFormatted, ToastLength.Short).Show();
    return true;
} 
```

希望有帮助。

# c++ - C++ 指针损坏？

> ID：11320566
> 
> 赞同：2
> 
> 时间：2012-07-03T23:26:43.827
> 
> 标签：c++, pointers, corruption

老实说，我不知道标题是否适合我遇到的问题。问题是这样的。我有一个名为 Engine 的类，其中有一个实例。

它包含两个成员变量（除其他外）`testTexture`，我的自定义`Texture`类`testObject`的一个实例和我的自定义对象类的一个实例。

在 Engine 函数中，`Init`它们的值是这样设置的：

```
testTexture = Texture(0, TEXT("D:\\spriteWallVertical112.png"),
                      renderer.ReturnDevice());
testObject = Object(0,testTexture.textureID, D3DXVECTOR3(0,0,0),
                    D3DXVECTOR3(100,100,100), testTexture.texture, &renderer); 
```

这一切似乎都按照我的意愿运行，它们的值被存储并且似乎保持良好。

但是，在`Object`类构造函数内部调用了我的`Renderer`类中的一个函数`AddNewTextureObject`：

```
rendererPointer->AddNewTextureObject(&objectID, &textureID, textureInput, 
                                     &origin, &coordinates); 
```

这似乎很顺利，但是当程序运行这些值时，指针似乎会随着程序的继续而被覆盖。它们不会立即成为垃圾记忆，但很明显它们是。我可以根据需要提供代码，但我不想只是用与问题无关的代码向这个问题发送垃圾邮件，特别是如果其他人可能会看到我做错了明显的事情。

但是，我现在将发布`TextureObject`课程代码，因为我认为它在这里最相关：

```
#ifndef TEXTUREOBJECT_H
#define TEXTUREOBJECT_H
#ifndef UNICODE
#define UNICODE
#endif

#include <d3dx9.h>

class TextureObject
{
public:
    TextureObject();
    TextureObject(unsigned int *, int *, LPDIRECT3DTEXTURE9, D3DXVECTOR3 *, D3DXVECTOR3 *);
    ~TextureObject();

    unsigned int *objectID; // The object with the texture.  Use this for locating and deleting this instance of TextureObject.
    int *textureID;
    LPDIRECT3DTEXTURE9 texture; // May not be needed if we can simply select the texture via ID.
    const D3DXVECTOR3 *origin; // Needed for drawing rotations....I think.
    D3DXVECTOR3 *coordinates;
    int maintainMe;
};
#endif 
```

如果我分配给它，该变量`maintainMe`确实保持其值。

这是`AddNewTextureObject()`函数的代码：

```
void Renderer::AddNewTextureObject(unsigned int *objectIDInput, int *textureIDInput, LPDIRECT3DTEXTURE9 textureInput, D3DXVECTOR3 *originInput, D3DXVECTOR3 *coordinatesInput)
{
    //testTextureObject = TextureObject(objectID, textureID, textureInput, originInput, coordinatesInput);
    testTextureObject.objectID = objectIDInput;
    testTextureObject.textureID = textureIDInput;
    testTextureObject.texture = textureInput;
    testTextureObject.origin = originInput;
    testTextureObject.coordinates = coordinatesInput;
    testTextureObject.maintainMe = 3067; 
```

请注意，任何一种分配值的方法都会`testTextureObject`导致问题。

对此的任何帮助将不胜感激。

编辑：

这是`Object`该类的构造函数：

```
Object::Object(unsigned int objectIDInput, int textureIDInput, D3DXVECTOR3 originInput, D3DXVECTOR3 coordinatesInput, LPDIRECT3DTEXTURE9 textureInput, Renderer *rendererInput)
{
    objectID = objectIDInput;
    textureID = textureIDInput;
    origin = originInput;
    coordinates = coordinatesInput;
    rendererPointer = rendererInput;
    rendererPointer->AddNewTextureObject(&objectID, &textureID, textureInput, &origin, &coordinates);
} 
```

它`Object.h`在`Object`类中声明为 public，如下所示：

`Object(unsigned int, int, D3DXVECTOR3, D3DXVECTOR3, LPDIRECT3DTEXTURE9, Renderer *);`

EDIT2：我制作了一个复制构造函数和一个赋值运算符：

```
Object::Object(const Object &source)
{
    objectID = source.objectID;
    textureID = source.textureID;
    texture = source.texture;
    origin = source.origin;
    coordinates = source.coordinates;
    rendererPointer = source.rendererPointer;
}

Object& Object::operator=(const Object &source)
{
    if(this == &source)
    {
        return *this;
    }

    objectID = source.objectID;
    textureID = source.textureID;
    texture = source.texture;
    origin = source.origin;
    coordinates = source.coordinates;
    rendererPointer = source.rendererPointer;

    return *this;
} 
```

这些对您更有经验的人来说是否正确？不幸的是，仅此一项似乎并不能解决问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-03T23:33:14.633

由于您定义了析构函数，并且您的`TextureObject`类中有指针，因此您需要遵循规则 3：定义析构函数、复制构造函数和赋值运算符。似乎指针可能来自`Object`，因此您可能也需要对该类执行相同的操作。

我想你面临的问题是一个悬空指针问题，在你初始化之后`testObject`，用于初始化它的临时对象会破坏并释放在其中初始化的指针。因此，`testTextureObject`现在持有指向已释放内存的指针（因为这些指针最初来自临时）。

**编辑：**基于 的构造函数`Object`，我们看到`rendererPointer->AddNewTextureObject`正在从当前`Object`实例传递指针，这将是临时实例。

```
testObject = Object(0,testTexture.textureID, D3DXVECTOR3(0,0,0),
                    D3DXVECTOR3(100,100,100), testTexture.texture, &renderer); 
```

这行代码创建了一个 的临时实例`Object`，然后使用赋值运算符进行初始化`testObject`。在这行代码之后，临时文件将被破坏。现在`renderer`持有一个`TextureObject`已初始化为不再存在的临时指针的指针。

**编辑：**您似乎对规则 3 试图帮助您解决的问题有些困惑。您可以阅读关于 3 规则的问题[的公认答案](https://stackoverflow.com/questions/4172722/what-is-the-rule-of-three)。但举个简单的例子，只需考虑一个分配内存的类的简单问题。

```
class Foo {
    Bar *bar;
public:
    Foo () : bar(new Bar) {}
    ~Foo () { delete bar; }
    Bar * get_bar () { return bar; }
}; 
```

要求析构函数不泄漏内存。但是，如果使用复制构造函数或赋值运算符，则会引入一些问题。

```
Foo a;
Foo b(a); // copy 
```

问题`b`在于它拥有与 相同的指针`a`。因此，当`b`和`a`被破坏时，指针将被删除两次。

```
Foo a;
Foo c;
c = a;    // assign 
```

问题`c`在于，它不仅持有相同的指针`a`（这将导致双重删除），而且它在其构造函数中创建的任何内存现在都已泄漏。

规则 3 是：如果需要析构函数，则需要复制构造函数和赋值运算符。该规则的目的是让开发人员思考需要通过添加析构函数来解决的问题，以及这些问题会对复制构造和赋值产生什么影响，并创建一个合理的解决方案。

在你的情况下，`renderer`持有一个`TextureObject`由临时创建的`Object`. 您需要考虑如何解决这种情况，无论是在析构函数、复制构造函数和赋值运算符中`Object`，还是通过其他解决方案来避免问题。

# objective-c - iOS：pushViewController 冻结应用

> ID：11320567
> 
> 赞同：0
> 
> 时间：2012-07-03T23:27:09.437
> 
> 标签：objective-c, ios

我是一名新的 iOS 开发人员，正在处理一些遗留代码。我从代码中了解到要启动一个新屏幕，我可以这样做：

```
SomeViewController* view = [[SomeViewController alloc] initWithNibName:@"SomeViewController" bundle:[NSBundle mainBundle]];
[self.navigationController pushViewController:view animated:YES];
[view release]; 
```

我有一个从屏幕 A 启动的屏幕 B。我需要从屏幕 B 进一步启动屏幕 C。流程是 A -> B -> C。当我执行 B-> C 时，应用程序冻结并且屏幕看起来像这个：

![在此处输入图像描述](../Images/0812f105d6ee6a9be34045c5c95b6470.png)

但是，当我做 A->C 时，它工作得很好。有没有人见过这个？非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T03:40:38.547

如果不查看更多代码，很难说出真正的问题可能是什么。但是，我确实注意到两个问题：

1.  当您将视图控制器推送到 UINavigationController 堆栈时，通常会看到正在显示的导航栏。我在您的屏幕截图中没有看到导航栏。您可能需要嵌入 UINavigationController。
2.  这一点在其中一条评论中已经有所提及。将 UIView 推送到 UIViewController 堆栈是一个未定义的操作——您应该推送 UIViewController。例如：

    [self.navigationController pushViewController:myViewControllerForViewC 动画：YES];

# c# - Selenium FindBy 属性使用 Javascript 并在 C# 中等待

> ID：11320583
> 
> 赞同：1
> 
> 时间：2012-07-03T23:28:56.647
> 
> 标签：c#, c#-4.0, selenium, pageobjects

我正在使用 Selenium，并且我有以下用于执行 javascript 的扩展方法。

```
 private const int s_PageWaitSeconds = 30;

    public static IWebElement FindElementByJs(this IWebDriver driver, string jsCommand)
    {
        return (IWebElement)((IJavaScriptExecutor)driver).ExecuteScript(jsCommand);
    }

    public static IWebElement FindElementByJsWithWait(this IWebDriver driver, string jsCommand, int timeoutInSeconds)
    {
        if (timeoutInSeconds > 0)
        {
            var wait = new WebDriverWait(driver, TimeSpan.FromSeconds(timeoutInSeconds));
            wait.Until(d => d.FindElementByJs(jsCommand));
        }
        return driver.FindElementByJs(jsCommand);
    }

    public static IWebElement FindElementByJsWithWait(this IWebDriver driver, string jsCommand)
    {
        return FindElementByJsWithWait(driver, jsCommand, s_PageWaitSeconds);
    } 
```

在我的 HomePage 类中，我具有以下属性。

```
public class HomePage : SurveyPage
{
    [FindsBy(How = How.Id, Using = "radio2")]
    private IWebElement employerSelect; 

    public HomePage(IWebDriver driver) : base(driver)
    {
    }

    public override SurveyPage FillOutThisPage()
    {
        employerSelect.Click();
        employerSelect.Submit();
        m_driver.FindElement(By.)
        return new Level10Page(m_driver); 
    }
} 
```

但是，employerSelect 是由 Javascript 生成的，所以有没有办法做这样的事情：

```
public class HomePage : SurveyPage
{
    const string getEmployerJsCommand= "return $(\"li:contains('Employer')\")[0];";

    [FindsBy(How = How.FindElementByJsWithWait, Using = "getEmployerJsCommand")]
    private IWebElement employerSelect; 

    public HomePage(IWebDriver driver) : base(driver)
    {
    }

    public override SurveyPage FillOutThisPage()
    {
        employerSelect.Click();
        employerSelect.Submit();
        m_driver.FindElement(By.)
        return new Level10Page(m_driver); 
    }
} 
```

本质上，我想将原始 ExecuteJs 调用替换为 FindsBy 属性的一部分，例如：

```
 const string getEmployerJsCommand = "return $(\"li:contains('Employer')\")[0];";
    IWebElement employerSelect = driver.FindElementByJsWithWait(getEmployerJsCommand); 
```

进入 FindsBy 属性的一部分，如下所示：

```
 const string getEmployerJsCommand= "return $(\"li:contains('Employer')\")[0];";

    [FindsBy(How = How.FindElementByJsWithWait, Using = "getEmployerJsCommand")]
    private IWebElement employerSelect; 
```

我可以扩展什么来做这样的事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T00:49:26.557

不幸的是，`FindsByAttribute`在`sealed`Selenium 中。因此，您不能覆盖它来添加新的行为。并且`How`是一个`Enum`所以没有办法在不覆盖整个属性类的情况下添加新值。

所以目前没有办法做你想做的事。

但是，我不认为密封 FindsBy 是一个深思熟虑的设计决定，而是 .NET Selenium 是 Java Selenium 的直接端口这一事实的结果。在 Java 中，默认情况下所有类都是“密封的”，并且必须明确标记为虚拟以允许覆盖。C# 正好相反，我认为大多数类在 Java-C# 移植期间都被标记为密封，因此没有考虑是否应该允许它。

在 Selenium 的最新版本之前，`By`该类也是密封的，而这只是固定的，我正在利用它来创建我自己的 By 查找。（使用 jQuery 选择器）。我敢肯定有人可以提交一个拉取请求来做同样的事情`FindsBy`

# hibernate - JPA：如何从多个表的列组合实体（不将实体保存到多个表）

> ID：11320586
> 
> 赞同：5
> 
> 时间：2012-07-03T23:29:52.967
> 
> 标签：hibernate, jpa, join

我有两个实体：

```
@Entity
@Table(name="TableA")
public class TableA {
     @Id
     @Column(name="id")
     long id;

     @Column(name="tableB_id")
     long tbId;

     @Column(name="column1", table="TableB")
     String tbColumn1; 
}

@Entity
@Table(name="TableB")
public class TableB {
     @Id
     @Column(name="id")
     long id;

     @Column(name="column1")
     String column1; 
} 
```

TableA 有一个指向 TableB.id 的外键“tbId”。TableB 有一个名为“column1”的列，现在我想通过某种连接在 TableA 实体中获取“column1”。就JPA而言，我应该采取什么方式？这不是 OneToOne，因为我不想在 TableA 中连接整个 TableB 实体。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-04T12:10:39.547

如果您只想将一个对象中的列分组以读取数据，我建议您采用两种方法：

1.  创建 DB VIEW 并将其映射为实体。
2.  使用[Result Classes Constructor Expression](http://www.objectdb.com/java/jpa/query/jpql/select#Result_Classes_Constructor_Expressions_)，它将根据结果查询返回实例化和填充提供的类的对象。

来自 ObjectDB 上的结果类构造函数表达式：

> JPA 支持使用自定义结果类的实例包装 JPQL 查询结果。这主要用于具有多个 SELECT 表达式的查询，其中自定义结果对象可以提供一种面向对象的替代方案，以将结果表示为 Object[] 元素。

# git - 如何在 *Windows* 中将 Mercurial 存储库转换为 Git...？

> ID：11320587
> 
> 赞同：17
> 
> 时间：2012-07-03T23:29:56.733
> 
> 标签：git, mercurial

> **可能重复：**
> [在 Windows 上将 Mercurial (hg) 存储库转换为 Git (7)](https://stackoverflow.com/questions/3267232/converting-a-mercurial-hg-repository-to-git-on-windows-7)

我想将一个 Mercurial 存储库转换为 Git，这是我们在工作中使用的。我安装了 Mercurial（适用于 Windows），并且已经在本地克隆了 Hg 存储库。我一直在尝试转换它。

我发现的大多数页面都假设我使用的是 Unix/Linux，而最常见的建议 hg-fast-export 似乎只适用于这些操作系统。我确实可以访问 Git Bash。我已经做到了这一点（换行以便于阅读）：

```
$ ~/codeingit/fast-export/hg-fast-export.sh -r
        ~/codeinmercurial/projectiwanttoconvert 
```

作为回应，我得到：

> ImportError：没有名为 mercurial 的模块

我已经阅读了许多关于此的网页，再次假设我使用的是 Unix/Linux 并且为此安装了 Mercurial。

有没有人成功地将 Hg 存储库转换为**Windows**上的 Git ，并且可以编写分步指南来执行此操作？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-07-04T07:07:01.823

## 1)在 Windows 10 上[安装 Cygwin](http://cygwin.com/install.html)或[Bash](https://msdn.microsoft.com/en-us/commandline/wsl/install_guide)

**赛格温**

*   运行[setup.exe](http://cygwin.com/install.html)
*   选择*从 Internet 安装*
*   在“**选择包**”对话框中：
    *   单击树顶部的*安装（在**All*旁边），直到它显示*Default*
    *   展开***Devel***子树：安装*git*（从*Skip*更改为版本号）
    *   在***Devel***子树中：安装*mercurial*（从*Skip*更改为版本号）
    *   安装***Python***子树（从*Default*更改为*Install*）
    *   点击下一步
*   如果提示解决依赖关系，请单击下一步
*   喝杯咖啡，看你最喜欢的电影，或者小睡一会儿

Cygwin 安装完成后，打开 bash shell 以运行以下步骤中指示的命令。bash 的快捷方式将称为***Cygwin Terminal***。

**视窗 10**

*   [在 Windows 10 上安装 Bash](https://msdn.microsoft.com/en-us/commandline/wsl/install_guide)
*   来杯咖啡
*   打开 Bash 并键入以下内容：
    *   sudo apt install git
    *   sudo apt install mercurial

## 2) 安装[快速导出](http://repo.or.cz/w/fast-export.git/)

打开终端（bash shell）并安装*fast-export*：

```
   https://github.com/frej/fast-export.git

```

## 3）初始化新的git repo并迁移mercurial repo

```
   mkdir new_git_repo
   cd new_git_repo
   混帐初始化
   ../fast-export/hg-fast-export.sh -r /path/to/old/mercurial_repo
   git结帐头

```

**潜在错误**

```
fatal: Invalid raw date "<devnull@localhost> xxx -xxxx" in ident:  <><devnull@localhost> xxx -xxxx 
```

尝试按照[此处](https://github.com/frej/fast-export/issues/15)所述添加“authors.txt”文件，其中包含：

```
<>=devnull <devnull@localhost> 
```

命令行现在显示：

```
../fast-export/hg-fast-export.sh -r /path/to/old/mercurial_repo -A ../fast-export/authors 
```

# php - 修改 jquery 隐藏/显示框以使用相同 div 的多个实例

> ID：11320588
> 
> 赞同：1
> 
> 时间：2012-07-03T23:30:03.663
> 
> 标签：php, jquery

我有这个 jquery 代码：

```
<script type="text/javascript">

    jQuery(document).ready(function($){  
        // hides the slickbox as soon as the DOM is ready
        $('#slickbox').hide();
        // shows the slickbox on clicking the noted link  
        $('#slick-show').click(function() {
            $('#slickbox').show('slow');
            return false;
        });
        // hides the slickbox on clicking the noted link  
        $('#slick-hide').click(function() {
            $('#slickbox').hide('fast');
            return false;
        });
        // toggles the slickbox on clicking the noted link  
        $('#slick-toggle').click(function() {
            $('#slickbox').toggle(400);
            return false;
        });
    });
    </script> 
```

**问题是：如何使代码适用于同一 div 的多个实例？**

像这样，它适用于第一个 for 循环中的 div。

**更新：使用的类，现在所有的 div 都可以一次切换。我需要的是，例如，如果我单击循环生成的第三个链接，则只显示第三个 slickbox。希望你能理解。**

```
<?       for ($i = 1; $i <= get_option('category_nr'); $i++): 

         <table class="form-table">
            <tr valign="top">
                <td colspan="2"><a href="#" class="slick-toggle<? echo $i; ?>">Toggle the box</a></td>
            </tr>
        </table>

        <div class="slickbox<? echo $i; ?>">
                Content
        </div>

<?      endfor; ?> 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-03T23:34:37.357

编辑：

现在每个链接都会切换一个 div。链接的 id 必须与 div 的类相同。

代码未经测试：

HTML：

```
<a href="#" class="toggle_link" id="toggle_1">link 1</a>
<div class="toggle_1">Box 1</div>

<a href="#" class="toggle_link" id="toggle_2">link 2</a>
<div class="toggle_2">Box 2</div> 
```

jQuery：

```
$('a.toggle_link').click(function(e) {
  e.preventDefault();
  $('.'+$(this).attr('id')).toggle();
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-03T23:33:24.503

将点击绑定到类或其他属性而不是 ID。

例如，我正在编造一个新的属性并绑定到它。

```
$('div[rel="slickbox"]').hide();

<div rel="slickbox" id="slickbox"> 
```

我想你明白了。

Ps：ID应该是唯一的，不要在循环中使用相同的ID，使它们唯一。

编辑：用解决方案更新响应：

示例 HTML：

```
 <a class="click" id="id1" rel="1">Click me</a>
    <a class="click" id="id2" rel="2">Or me</a>
    <a class="click" id="id3" rel="3">Or to me</a>

    <br /><br />
    <div id="hidden1" class="hidden">First Hidden Div <button class="closeme">Close Me</button></div>
    <div id="hidden2" class="hidden">Second Hidden Div <button class="closeme">Close Me</button></div>
    <div id="hidden3" class="hidden">Third Hidden Div <button class="closeme">Close Me</button></div>​ 
```

示例 jQuery：

```
$(function(){

    $('.click').click(function(){
        if($('#hidden'+$(this).attr('rel')).is(':hidden')) {
            $('#hidden'+$(this).attr('rel')).show('fast');
        } else {
            $('#hidden'+$(this).attr('rel')).hide('fast');
        }
    });

    $('.closeme').click(function(){
    $(this).parent('div').hide('fast');
    });

});​ 
```

我必须更新切换事件并在每次单击时检查其状态，因为关闭按钮正在杀死切换顺序（我的意思是，单击[此处](http://jsfiddle.net/y5AAL/8/)，打开一个 div 并在 div 内使用关闭按钮关闭，然后尝试从主要切换器。你会明白我的意思。）

示例 CSS：

```
.click {
 display:block;
 cursor:pointer;    
}

.hidden {
 display:none; /*hide for default*/
background:red;
 color: white;   
} 
```

你可以从[这里](http://jsfiddle.net/y5AAL/5/)检查。您可以通过这种方式将任何链接与您想要的任何内容相关联。​</p>

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-03T23:34:49.920

您不能生成多个相同的 ID。创建一个空类“slickbox”并使用

```
 <div id="slickbox_<?php print "$i"; ?>" class="slickbox"> 
```

然后 jQuery 选择“.slickbox”而不是“#slickbox”。

编辑：如果有（例如在 CSS 中），还可以通过 id 检查对“slickbox”的任何其他引用。

然后点击函数必须引用的不是 id 或类，而是被点击的对象：

```
$('.slick-show').click(function() {
        self.show('slow');
        return false;
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-04T00:00:16.910

我不确定您要达到什么目标，但这似乎是：

请参阅此[工作小提琴示例](http://jsfiddle.net/zuul/SX58R/2/)！

**假设以下 HTML：**

```
<div id="actions">
    <button id="slick-show">Show all</button>
    <button id="slick-hide">Hide all</button>
</div>
<div class="slickbox">Hello</div>
<div class="slickbox">Hello</div>
<div class="slickbox">Hello</div>
<div class="slickbox">Hello</div>
<div class="slickbox">Hello</div> 
```

**jQuery**

```
jQuery(document).ready(function($){

  // define the target element
  var $target = $('.slickbox');

  // hides all by default
  $target.hide();

  // shows all
  $('#slick-show').bind("click", function(event) {
    event.preventDefault();
    $target.show('slow');
  });

  // hides all
  $('#slick-hide').bind("click", function(event) {
    event.preventDefault();
    $target.hide('fast');
  });

  // toggles the clicked one
  $target.bind("click", function(event) {
    event.preventDefault();
    $(this).toggle(400);
  });

}); 
```

# javascript - CKEditor 自动插入\n

> ID：11320595
> 
> 赞同：1
> 
> 时间：2012-07-03T23:31:34.710
> 
> 标签：javascript, ckeditor

我的问题是`CKEditor`，它会`\n`在我提交数据时添加。

要获取我正在使用的数据：

```
CKEDITOR.instances['contentBox'].getData() 
```

在数据库中提交后的数据示例：

```
<p>\n   Heloo<br />\n   How are you?</p>\n
<p>\n   Another Subject<br />\n My name is Luis</p>\n 
```

一切都很好，只是想取消`\n`. 我不想使用 REGEX 或其他 PHP 函数来删除它。我更喜欢通过 CKEditor 的配置解决方案。

**编辑 ：：**

**CKEditor 不是问题（看`David Mulder`答案）。**

我创建的 Ajax 代码（可能是问题）：

```
$('#edit').live('click', function() {
    if ($("#formValue").valid())
    {
        $('.simplebox').slideUp(200, function() {
            $('body').animate({scrollTop:140}, 350, function() {
                $('#loading-edit').slideDown(300, function() {
                    $.ajax({
                        type: "POST",
                        dataType: "json",
                        url: "../new_lesson_proccess/",
                        data: getDataToPost(),
                        success: function(data){

                            if (data.success == true)
                            {
                                $('#loading-edit').fadeOut(200, function() {
                                    $('.name_news_success').html($('input[name=name]').val());
                                    $('#successfull-edit').fadeIn(200);
                                });
                            }

                        }
                    });
                });
            });
        });
    }
})

function getDataToPost()
{
    var value = CKEDITOR.instances['valuecontent'].getData();

    return {
        id: $('input[name=news_id]').val(),
        tags : $('#tags').textext()[0].tags()._formData,
        name: $('input[name=name]').val(),
        content: value
    }
} 
```

这里有什么问题？

**编辑 2::**

我正在使用`CodeIgniter`框架。

*控制器部分：*

```
public function new_lesson_proccess()
    {
        // # POST to Array
        $data = array(
            'content' => $this->input->post('content', FALSE)
        );

        $dataExport = array(
            'success' => $this->lessons_model->news_lesson($data)
        );

        echo json_encode($dataExport);
    } 
```

*部分模型`lessons_model`：*

```
function new_lesson($data)
    {
        $dataInsert = array(
            'content' => mysql_real_escape_string($data['content'])
        );

        if ($this->db->affected_rows($this->db->insert('web_lessons', $dataInsert)) == 1)
            return true;
        else
            return false;
    } 
```

编码：`UTF-8`

数据库中的字段`content`定义为`TEXT`

我删除了一些验证代码等，因为它并不重要。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T07:05:44.983

这可能会有所帮助。

```
CKEDITOR.on( 'instanceReady', function( ev )
   {
      ev.editor.dataProcessor.writer.setRules( 'p',
         {
            indent : false,
            breakBeforeOpen : true,
            breakAfterOpen : false,
            breakBeforeClose : false,
            breakAfterClose : true
         });
   }); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-06T11:21:33.440

这可能有点远，但我认为这很可能不是 ckEditor 的设置（因为我过去广泛使用 ckEditor，并且没有遇到这样的问题），而是一个功能（更改`character 10`和表示您正在使用的 ajax 库或数据库库。无论哪种方式，记录并检查哪个点被替换为`character 13``\n``chr(13)``\n`首先，如果它在 ajax 库中，那么只有在你的 php 代码中解析它才有意义，如果它在你的数据库脚本中，那么你需要在里面的某个地方更改它（我不会太惊讶，据我所知，有些人喜欢在数据库中没有“隐藏”字符，例如换行符）。当然，此答案仅在您尝试使换行符采用有效格式时才有效，如果您根本不关心换行符`Lee Taylor`答案将是去的地方。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-03T23:39:49.987

看起来这可能是您的解决方案：

[http://dev.ckeditor.com/ticket/3260](http://dev.ckeditor.com/ticket/3260)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-10T23:43:37.263

请参阅此 ckeditor 输出格式化程序：[http ://docs.cksource.com/CKEditor_3.x/Developers_Guide/Output_Formatting](http://docs.cksource.com/CKEditor_3.x/Developers_Guide/Output_Formatting)

这个答案也可能会有所帮助：[Removing不需要的换行符时添加 <p> in CKEditor](https://stackoverflow.com/questions/2547090/removing-unwanted-newline-characters-when-adding-p-in-ckeditor)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-04-27T13:14:41.410

我知道这是一个老话题，但我遇到了同样的问题，只是想分享我的解决方案。

我使用 jquery 的 ajax 方法，将数据发布到我的 php 脚本中，并且内容断线更改为 \n。

这是我的（解决方法）解决方案，在将数据解析到数据库之前，我在 php 脚本中执行此操作：

```
if (strpos($content,'\n') !== false) {
    $content = str_replace('\n', chr(13), $content);
} 
```

# php - 从文本文件中获取最新数据

> ID：11320598
> 
> 赞同：0
> 
> 时间：2012-07-03T23:32:21.240
> 
> 标签：php, javascript, html

更新文本文件的内容时，它不会更新。相反，我必须删除我的谷歌浏览器中的所有缓存和其他内容，以使其刷新。但是，它在使用 Apache 服务器（本地主机）时确实有效。

我尝试添加 a: `<meta http-equiv="expires" content="Mon, 26 Jul 1997 05:00:00 GMT"/> <meta http-equiv="pragma" content="no-cache" />`，但问题仍然存在。

```
function MakeRequest()
{
  var xmlHttp = getXMLHttp(); // just a basic XML request
  xmlHttp.onreadystatechange = function()
  {
    if(xmlHttp.readyState == 4)
    {
      HandleResponse(xmlHttp.responseText);
    }
  }
  xmlHttp.open("GET", "counter.txt", true); 
  xmlHttp.send(null);
} 
```

我有另一个 JavaScript 只是在一个 div 中打印它：（定时运行有一些延迟）

```
document.getElementById('counterHolder').innerHTML = response; 
```

[如果您需要实时查看网页，请单击此处。](http://rawnhansen.com/ng/stats.php)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-03T23:55:20.967

这似乎是一个缓存问题。我无法准确描述为什么会发生这种情况，但根据我的经验，在获取请求中的 url 末尾添加一个随机字符串应该可以工作。我建议如下：

```
xmlHttp.open("GET", "counter.txt?" + Math.random(), true); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-03T23:58:02.720

我相信与这篇文章类似的东西会帮助你。它旨在链接到一个文件，每次重新加载页面时都会被视为一个新链接，但是，同样适用于您的情况：

[绕过缓存的 HTML 链接](https://stackoverflow.com/questions/7062680/html-link-that-bypasses-cache)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-04T00:00:23.920

我推荐使用 jQuery，或者其他不错的 JavaScript 库。如果这样做，请检查 jQuery 中是否有缓存选项。

试图解决你的问题，试试这个..

```
function MakeRequest()
{
  var xmlHttp = getXMLHttp(); // just a basic XML request
  xmlHttp.onreadystatechange = function()
  {
    if(xmlHttp.readyState == 4)
    {
      HandleResponse(xmlHttp.responseText);
    }
  }
  var timestamp_since_epoch = new Date().getTime();
  xmlHttp.open("GET", "counter.txt?"+timestamp_since_epoch, true); 
  xmlHttp.send(null);
} 
```

上面所做的就是生成一个自纪元以来的时间戳，并将其作为参数添加到 AJAX 调用中。

# sql - 当可以找到数据时，从另一个数据库表中查询

> ID：11320599
> 
> 赞同：0
> 
> 时间：2012-07-03T23:32:25.060
> 
> 标签：sql, asp-classic

所以假设有表 A、B 和 C

A 和 B 来自数据库 AAA，C 来自数据库 BBB 据我所知，我无法连接来自不同数据库的表。

所以我想加入A和B，如果没有返回，我想从C表中查询。

```
A_ID    NAME        B_ID  NAME      C_ID   NAME
------------------------------------------------
1       Paul        1     NULL      1      NULL
2       NULL        2     BOB       2      NULL
3       NULL        3     NULL      3      PETER 
```

例如，

```
select * from A outer join B on A_ID= B_ID 
```

1 和 2 将返回“名称”下的 PAUL 和 BOB。但是 3 会加入，但什么都不会返回。然后我想查询C。

我的想法是循环它，但我想知道是否有更好的想法。而且我对 ASP 完全陌生，所以如果我标记错误...请帮忙。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T00:02:57.953

只要所有数据库都在同一台服务器上（并且您的登录名可以访问所有数据库），您就可以，架构名称`JOIN DatabaseC.dbo.SomeTable`在哪里。`dbo`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T00:07:31.750

如果您的数据库在同一台服务器上，您可以使用[完全限定名称](http://msdn.microsoft.com/en-us/library/ms187879%28v=sql.105%29.aspx)来连接两个数据库中的表。请注意，您的 an 语法`outer join`是无效的 t-sql。你需要指定`outer join`你想要什么类型... a `left join`, `right join`, 等等。

```
SELECT      *
FROM        A
LEFT JOIN   B on A.A_ID = B.B_ID
LEFT JOIN   [BBB].[dbo].C c on B.B_ID = c.C_ID 
```

一条`CASE`语句可能会使您的输出更具可读性，但如果给定 ID 的多个表中存在一个名称，它就不起作用（好吧，它会起作用，但您会丢失一些数据）。但是，如果一个 ID 只在一个表中具有名称，那么它可能会使您的输出更具可读性。

```
SELECT      A.A_ID,
            CASE WHEN A.[Name] IS NOT NULL THEN A.[Name]
                 WHEN B.[Name] IS NOT NULL THEN B.[Name]
                 ELSE c.[Name]
            END
FROM        A
LEFT JOIN   B on A.A_ID = B.B_ID
LEFT JOIN   [BBB].[dbo].C c on B.B_ID = c.C_ID 
```

如果您的数据库在不同的服务器上，那么您仍然可以完成这项工作，但您需要设置[链接服务器](http://msdn.microsoft.com/en-us/library/ms188279.aspx)，这有点困难。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-03T23:43:04.250

```
SELECT  ID,
        Name = CASE temp.ID
                    WHEN NULL THEN  (SELECT Name FROM C WHERE C_ID = temp.ID)
                    ELSE temp.ID
               END
  FROM  (
            SELECT  A.ID,
                    Name = ISNULL(A.Name, B.Name)
              FROM  A 
                    OUTER JOIN B on A_ID = B_ID  
        ) temp 
```

# c++ - 我如何组织 C++ 代码而不考虑是否有模板化？

> ID：11320602
> 
> 赞同：1
> 
> 时间：2012-07-03T23:32:48.787
> 
> 标签：c++, templates, compilation, linker

（我觉得这一定是重复的，但我找不到它）。

考虑：

*飞机.hpp：*

```
template<class T>
void wings();

void tail(); 
```

现在......在哪里定义 `wings()`和`tail()`？我想在同一个地方定义它们；我不想考虑`wings()`模板化和`tail()`不是模板化的事实。也许你会明白为什么我有时会写：

*飞机.hpp：*

```
template<class T>
void wings();

void tail();

#ifndef airplane_cpp
#define header
#endif
#include "airplane.cpp" 
```

*飞机.cpp：*

```
#define airplane_cpp
#include "airplane.hpp"

template<class T>
void wings() { }

#ifndef header
void tail() { }
#endif 
```

但这肯定不是最好的方法。

**编辑：**似乎有必要添加我正在TI DSP芯片上编程，根据[文档](http://www.cs.cmu.edu/afs/cs/academic/class/15745-s07/www/c6xref/compiler_guide.pdf)，`inline`关键字对生成的代码有定义的后果：

> inline 关键字指定函数在其被调用处内联扩展，而不是使用标准调用过程。编译器执行使用 inline 关键字声明的函数的内联扩展。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-03T23:38:00.097

如果您制作它们，您可以在标题中定义所有功能`inline`：

```
template<class T>
inline void wings() {}
// inline not really needed here, but if you don't want to think about it...

inline void tail() {} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-03T23:44:21.377

您可以使用`export`模板前面的关键字来实现您想要的。不幸的是，这个关键字并没有在编译器中获得相当大的支持。

换句话说，实际上，您应该在头文件中定义模板的主体。

从我的角度来看，编译器供应商应该努力实现用于函数的相同范例，也用于模板。即接口的描述应该留在头文件中，主体的描述在cpp文件中。在链接过程中，所有内容都应该组合在一起。他们没有这样做。正如我们今天所拥有的，函数和模板的范式是不同的。模板是`compile time ony`实体。

# android - Eclipse（Indigo 和 Juno）错误编辑 XML Android 文件

> ID：11320603
> 
> 赞同：0
> 
> 时间：2012-07-03T23:32:51.880
> 
> 标签：android, xml, eclipse

当我在 Eclipse 中编辑 xml（资源 android）文件时，出现以下错误：

```
20:23:17,196 INFO  [main] Main  - javax.xml.transform.TransformerFactory=null
20:23:17,198 INFO  [main] Main  - java.endorsed.dirs=C:\Program Files\Java\jre7\lib\endorsed
20:23:17,202 INFO  [main] Main  - launchFile: C:\Users\Anderson\workspace\.metadata\.plugins\org.eclipse.wst.xsl.jaxp.launching\launch\launch.xml
20:23:17,267 FATAL [main] Main  - No embedded stylesheet instruction for file: file:/C:/Users/Anderson/workspace/ControleRenda/res/layout/main.xml
org.eclipse.wst.xsl.jaxp.debug.invoker.TransformationException: No embedded stylesheet instruction for file: file:/C:/Users/Anderson/workspace/ControleRenda/res/layout/main.xml
    at org.eclipse.wst.xsl.jaxp.debug.invoker.internal.JAXPSAXProcessorInvoker.transform(JAXPSAXProcessorInvoker.java:225)
    at org.eclipse.wst.xsl.jaxp.debug.invoker.internal.JAXPSAXProcessorInvoker.transform(JAXPSAXProcessorInvoker.java:186)
    at org.eclipse.wst.xsl.jaxp.debug.invoker.internal.Main.main(Main.java:73)
Caused by: org.eclipse.wst.xsl.jaxp.debug.invoker.TransformationException: No embedded stylesheet instruction for file: file:/C:/Users/Anderson/workspace/ControleRenda/res/layout/main.xml
    at org.eclipse.wst.xsl.jaxp.debug.invoker.internal.JAXPSAXProcessorInvoker.transform(JAXPSAXProcessorInvoker.java:214)
    ... 2 more 
```

xml代码是这样的：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

</LinearLayout> 
```

main.out 文件记录此错误：

```
No XML content. Please add a root view or layout to your document. 
```

有时我有错误“意外的EOF”。

如果我在记事本或记事本++中编辑文件，将其保存在项目目录中并刷新eclipse；然后项目运行....

你能帮助我吗？我已经为此搜索了几天的解决方案...

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T10:14:13.557

可能不需要删除 xslt 转换，只需转到文件，右键单击它并选择`run configurations`

从那里选择`android`并创建一个新配置。在此之后填写向导并单击`run`，一切都会正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T01:12:43.437

听起来你遇到了我[在这里](https://stackoverflow.com/a/9637885/639520)回答的同样的事情。基本上，您是在对文件调用 XSLT 转换，而不是按照您的意图进行操作。

# python - 元组迭代的基本列表

> ID：11320604
> 
> 赞同：-2
> 
> 时间：2012-07-03T23:33:11.703
> 
> 标签：python, iterator, tuples, list-comprehension, itertools

大家好，我卡在我的python脚本上我有2list a&b列表A包含用于循环遍历列表的元组b只包含我想要增加的值，所以每次“a”完成时我都想返回值

```
A=[(a,b,c),(a,b,c).(a,b,c),(a,b,c)]
B=["a","b","c",'d']
for x in a:
  Print " yo"
  itert=B.__iter()__
  Y=itert.next()
  print y 
```

及其返回`yo a,yo a,yo a,yo a yo b,yo b,yo b,yo b,yo b ...`

但我想要`yo a,yo b,yo c,yo d, yo a,yo b,yo c,yo d ...`

对不起这个例子，但这是我可以解释很多的最好方法

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T00:28:28.310

就像你的代码一样奇怪和破碎，每次通过循环你都重置`itert`为`B.__iter__()`. 这会回到列表的开头`B`，所以`Y`总是设置为`"a"`。

（更正后的）代码的实际输出是：

```
 yo
a
 yo
a
 yo
a
 yo
a 
```

我猜你需要这样的嵌套循环？

```
a=b=c=1   # so definition of A succeeds
A=[(a,b,c),(a,b,c),(a,b,c),(a,b,c)]
B=['a','b','c','d']
for x in A:
    for y in B:
        print "yo %s," % y,
print 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-01T04:50:55.787

是的，对不起，我的英语真的不好，我的意思是同时迭代两个列表

对于 zip(listA,listB) 中的 a,b：打印 a,b

它的基本列表迭代我真的很抱歉我的英语不好和例子

# android - 控制 WallpaperManager.setBitmap 如何以 bmp 为中心？

> ID：11320607
> 
> 赞同：2
> 
> 时间：2012-07-03T23:33:37.150
> 
> 标签：android

我想设置一张图片作为壁纸。我只是在做：

```
WallpaperManager wm = WallpaperManager.getInstance(context);
wm.setBitmap(bmp); 
```

bmp 似乎有一个非常严格的缩放级别设置，这样只有 40% 的照片实际上在桌面上是可见的。有点夸张，但这就是它的外观：

```
------------
|          |
|    --    |
|    ||    |  (visible rect of phone in center)
|    --    |
|          |
------------ 
```

似乎没有办法控制墙纸管理器如何设置 bmp。我们是否通过以不同方式裁剪我们提供的 bmp 来隐式控制这一点？

谢谢

# java - Java 从 Ubuntu 中的串口读取

> ID：11320610
> 
> 赞同：1
> 
> 时间：2012-07-03T23:33:45.537
> 
> 标签：java, serial-port

`/dev/ttyUSB0`我正在使用操作系统为我提供的标准文件在 Ubuntu 中读取和写入 USB 串行端口。我在一个扩展 Thread 的类中完成了所有艰苦的工作：

```
public PacketHandlingThread(String fileName, PacketListener listener)
{
    mListener = listener;

    //the filename points toward a serial port. Something like /dev/ttyUSB0
    try
    {
        mOutputStream = new FileOutputStream(fileName);
        mInputStream = new FileInputStream(fileName);
        System.out.println("Created Serial Listener");
    }
    catch (Exception e)
    {
        e.printStackTrace();
    }
} 
```

运行方法如下所示：

```
public void run()
{
    while(true)
    {
        int numRead = -1;
        try
        {
            while(mInputStream.available() < 1)
            {
                //spin in circles
                try {
                    Thread.sleep(10);
                }catch (Exception e) {}
            }

            numRead = mInputStream.read(data);
            System.out.println("Num Read: "+numRead);   
        }
        catch (Exception e)
        {
            e.printStackTrace();
            numRead = -1;
        }

        if (numRead == -1)
        {
            mListener.OnConnectionClosed();
            break;
        }
    }
} 
```

此代码按预期工作，但它必须不断地轮询文件以查看它是否有任何新数据。而不是那个while循环，我宁愿有类似的东西：

```
synchronized(mInputStream)
{
    mInputStream.wait();    
} 
```

但是当我这样做时，它会永远等待，大概是因为底层流从不调用`notify()`（并且没有任何理由怀疑它会调用，我只是说我希望它调用）。

我的问题是：有没有办法以非轮询方式从串行端口读取？

我真的很讨厌必须使用串行库，因为我的研究似乎表明它们中的每一个都非常糟糕。任何建议表示赞赏！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-03T17:58:37.487

看看[Java 简单的串行连接器](http://code.google.com/p/java-simple-serial-connector/wiki/jSSC_examples)库。

您需要做的是实现一个 SerialPortEventListener 接口，如上面的链接所示。

我们已经在生产中使用它，通过 USB 适配器读取串行数据，并且显示稳定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T00:07:49.607

首先，恕我直言，如果您正在编写任何与较低级别（IE 设备连接、硬件实现等）接口的东西，最好的选择是使用**C++**（为您使用 GCC），因为 java 在涉及到处理操作系统级别的功能（在大多数情况下，java 在尝试跨平台时无法使用或者没有明确和直接的操作系统功能实现）。

如果您正在调用基础对象（当您从中读取时应该调用它），您可以使用 for 循环来检查 i ，`fileName.size()`而不是直接测试流。

```
for(int i = 0; i < filename.size(); i++)
   try{
        //...code here...
      }
       catch(Exception e)
       {
         e.printStackTrace();
       }
} 
```

祝你好运，

# android - 如何通过 HttpRequest 从连接的 Android 设备访问本地 tomcat

> ID：11320612
> 
> 赞同：0
> 
> 时间：2012-07-03T23:33:50.603
> 
> 标签：android, http, tomcat

从模拟器访问时可以正常工作：

```
 response = CustomHttpClient.executeHttpPost(
                "http://10.0.2.2:8080/DWAP/SERVLET", postParameters); 
```

当我从我的 Android 设备上写作时

```
 response = CustomHttpClient.executeHttpPost(
                "http://XX.XX.XX.XX:8080/DWAP/SERVLET", postParameters); 
```

其中 xx.xx.xx.xx 是我的公共 IP，我无法访问本地服务器。

有没有一种简单的方法可以从 Android 设备测试应用程序以访问本地 Tomcat，还是我只需要使用模拟器进行测试？

确实需要通过我的路由器上的 port-fprwarding，或者是否有另一种方法可以在我的 WLAN 上“内部”连接。（Android 手机 <-> MAC 与本地 Tomcat）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T10:26:15.647

尝试将您的计算机设置为路由器的 DMZ。这样，与您的路由器（公共 IP）的通信直接导致您的计算机（本地 IP）。

# html - 在 Google Chrome 中禁用本机日期选择器

> ID：11320615
> 
> 赞同：92
> 
> 时间：2012-07-03T23:34:15.583
> 
> 标签：html, google-chrome, datepicker

日期选择器登陆 Chrome 20，是否有任何属性可以禁用它？我的整个系统使用 jQuery UI 日期选择器，它是跨浏览器，所以，我想禁用 Chrome 原生日期选择器。有标签属性吗？

* * *

## 回答 #1

> 赞同：145
> 
> 时间：2012-09-04T16:45:45.123

要隐藏箭头：

```
input::-webkit-calendar-picker-indicator{
    display: none;
} 
```

并隐藏提示：

```
input[type="date"]::-webkit-input-placeholder{ 
    visibility: hidden !important;
} 
```

* * *

## 回答 #2

> 赞同：55
> 
> 时间：2012-12-07T15:42:58.290

如果您误用了`<input type="date" />`，您可能会使用：

```
$('input[type="date"]').attr('type','text'); 
```

在它们加载后将它们转换为文本输入。您需要先附加您的自定义日期选择器：

```
$('input[type="date"]').datepicker().attr('type','text'); 
```

或者你可以给他们上课：

```
$('input[type="date"]').addClass('date').attr('type','text'); 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2012-07-13T12:17:21.300

你可以使用：

```
jQuery('input[type="date"]').live('click', function(e) {e.preventDefault();}).datepicker(); 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2013-04-24T01:55:42.683

使用 Modernizr ( [http://modernizr.com/](http://modernizr.com/) )，它可以检查该功能。然后你可以将它绑定到它返回的布尔值：

```
// does not trigger in Chrome, as the date Modernizr detects the date functionality.
if (!Modernizr.inputtypes.date) { 
    $("#opp-date").datepicker();
} 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2015-06-10T16:19:19.423

这对我有用

```
input[type=date]::-webkit-inner-spin-button, 
input[type=date]::-webkit-outer-spin-button { 
  -webkit-appearance: none; 
  margin: 0; 
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-07-24T19:08:57.193

上面的代码没有设置输入元素的值，也没有触发更改事件。以下代码适用于 Chrome 和 Firefox（未在其他浏览器中测试）：

```
$('input[type="date"]').click(function(e){
     e.preventDefault();
}).datepicker({
    onSelect: function(dateText){
        var d = new Date(dateText),
        dv = d.getFullYear().toString().pad(4)+'-'+(d.getMonth()+1).toString().pad(2)+'-'+d.getDate().toString().pad(2);
        $(this).val(dv).trigger('change');
    }
}); 
```

pad 是一个简单的自定义字符串方法，用零填充字符串（必需）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-02-21T18:35:23.927

我同意 Robertc，最好的方法不是使用 type=date，而是我的 JQuery Mobile Datepicker 插件使用它。所以我必须做一些改变：

我正在使用 jquery.ui.datepicker.mobile.js 并进行了以下更改：

从（第 51 行）

```
$( "input[type='date'], input:jqmData(type='date')" ).each(function(){ 
```

到

```
$( "input[plug='date'], input:jqmData(plug='date')" ).each(function(){ 
```

并在使用表单中，输入文本并添加 var 插件：

```
<input type="text" plug="date" name="date" id="date" value=""> 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-10-26T17:11:53.693

我使用以下（咖啡脚本）：

```
$ ->
  # disable chrome's html5 datepicker
  for datefield in $('input[data-datepicker=true]')
    $(datefield).attr('type', 'text')
  # enable custom datepicker
  $('input[data-datepicker=true]').datepicker() 
```

它被转换为普通的javascript：

```
(function() {
  $(function() {
    var datefield, _i, _len, _ref;
    _ref = $('input[data-datepicker=true]');
    for (_i = 0, _len = _ref.length; _i < _len; _i++) {
      datefield = _ref[_i];
      $(datefield).attr('type', 'text');
    }
    return $('input[data-datepicker=true]').datepicker();
  }); 
}).call(this); 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2019-10-22T23:12:24.067

这对我有用：

```
// Hide Chrome datetime picker
$('input[type="datetime-local"]').attr('type', 'text');

// Reset date values
$("#EffectiveDate").val('@Model.EffectiveDate.ToShortDateString()');
$("#TerminationDate").val('@Model.TerminationDate.ToShortDateString()'); 
```

即使日期字段的*值*仍然存在并且正确，它也没有显示。这就是我从视图模型中重置日期值的原因。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-09-18T10:54:55.450

这对我有用：

```
;
(function ($) {
    $(document).ready(function (event) {
        $(document).on('click input', 'input[type="date"], input[type="text"].date-picker', function (e) {
            var $this = $(this);
            $this.prop('type', 'text').datepicker({
                showOtherMonths: true,
                selectOtherMonths: true,
                showButtonPanel: true,
                changeMonth: true,
                changeYear: true,
                dateFormat: 'yy-mm-dd',
                showWeek: true,
                firstDay: 1
            });

            setTimeout(function() {
                $this.datepicker('show');
            }, 1);
        });
    });
})(jQuery, jQuery.ui); 
```

也可以看看：

[如何禁用新的 Chrome HTML5 日期输入？](https://stackoverflow.com/questions/11270675/how-can-i-disable-the-new-chrome-html5-date-input/25910154#25910154)

[http://zizhujy.com/blog/post/2014/09/18/Add-date-picker-to-dynamically-generated-input-elements.aspx](http://zizhujy.com/blog/post/2014/09/18/Add-date-picker-to-dynamically-generated-input-elements.aspx)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-11-07T17:12:04.497

我知道这是一个老问题了，但我只是来到这里寻找有关此的信息，因此其他人也可能会这样做。

您可以使用[Modernizr](http://modernizr.com/)来检测浏览器是否支持 HTML5 输入类型，例如“日期”。如果是这样，这些控件将使用本机行为来显示日期选择器之类的内容。如果没有，您可以指定应该使用什么脚本来显示您自己的日期选择器。对我来说效果很好！

我在页面中添加了[jquery-ui](http://jqueryui.com/)和 Modernizr，然后添加了以下代码：

```
<script type="text/javascript">
    Sys.WebForms.PageRequestManager.getInstance().add_endRequest(initDateControls);
    initDateControls();

    function initDateControls() {
        //Adds a datepicker to inputs with a type of 'date' when the browser doesn't support that HTML5 tag (type=date)'
        Modernizr.load({
            test: Modernizr.inputtypes.datetime,
            nope: "scripts/jquery-ui.min.js",
            callback: function () {
                $("input[type=date]").datepicker({ dateFormat: "dd-mm-yy" });
            }
        });
    }

</script> 
```

这意味着原生的datepicker显示在Chrome中，jquery-ui的显示在IE中。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-03-24T10:22:16.897

对于 Laravel5 自从一个使用

{！！Form::input('date', 'date_start', null , ['class' => 'form-control', 'id' => 'date_start', 'name' => 'date_start']) !!}

=> Chrome 将强制使用它的日期选择器。=>如果你用css把它拿走，你会得到通常的格式错误！！（指定的值不符合要求的格式，“yyyy-MM-dd”。）

解决方案：

$('input[type="date"]').attr('type','text');

```
$("#date_start").datepicker({
    autoclose: true,
    todayHighlight: true,
    dateFormat: 'dd/mm/yy',
    changeMonth: true,
    changeYear: true,
    viewMode: 'months'
});
$("#date_stop").datepicker({
    autoclose: true,
    todayHighlight: true,
    dateFormat: 'dd/mm/yy',
    changeMonth: true,
    changeYear: true,
    viewMode: 'months'
});
$( "#date_start" ).datepicker().datepicker("setDate", "1d");
$( "#date_stop" ).datepicker().datepicker("setDate", '2d'); 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-06-05T15:37:01.350

在 HTML 中使用道具“min”

```
 <input type="date" class="form-control" [min]="getDate()"> 
```

并在课堂上利用这种乐趣来获得今天的约会。

```
 getDate(): string {
    return new Date().toISOString().split('T')[0];
   } 
```

# nuget - 如何复制相对于解决方案根目录的 Nuget 内容文件

> ID：11320618
> 
> 赞同：2
> 
> 时间：2012-07-03T23:34:46.793
> 
> 标签：nuget, nuget-package

我已经在我当前的项目上创建了一个 DAL，它是持久性无知的，并且有一个需要直接引用的合同 dll，然后是实现 dll，这些 dll 旨在由我们的 IoC 容器扫描以解决 ORM 特定的实现和相关\实现的映射合约 dll 中定义的接口和 POC。我的愿望是将实现 dll 复制到 [solution root]\lib 目录。我创建了一个包并将实现 dll 加载到内容文件夹中，并且在安装包时它们最终位于 [项目根目录]\lib 中。

我的问题是如何让 Nuget 将我的实现 dll 复制到 [solution root]\lib？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T09:52:31.053

我发现了一种似乎可行的方法。

1.  在 Nuget 包的内容文件夹中，将要扫描的 dll 放在临时文件夹中。
2.  将每个解决方案仅执行一次的 Init.ps1 脚本添加到 Nuget 包的工具文件夹 ( [http://docs.nuget.org/docs/creating-packages/creating-and-publishing-a-package](http://docs.nuget.org/docs/creating-packages/creating-and-publishing-a-package) )。在此脚本中，将文件复制到所需目录`[solution dir]\lib`
3.  将 Install.ps1 文件添加到工具文件夹中，该文件夹将在每个安装的项目中运行一次，这将删除临时文件夹

然后我可以为我的容器注册创建另一个包，它依赖于我的 dal 包，并使用类似的方法来设置我的 IoC 注册。所以我有

```
Company.Dal
Company.Dal.Ninject
Company.Dal.StructureMap 
```

然后消费者将安装使用他们使用的相同容器的包，这将负责安装所需的 dll`[solution dir]\lib`并配置容器以使用这些 dll。

优点

1.  它会完成工作。

缺点

1.  必须将 dll 复制到所有已安装的项目然后删除它们
2.  每次打开解决方案时也会运行 Init.ps1

**编辑** @MrMVCMan，我继续创建了一篇博客文章，记录了我是如何在这里做到的：[http ://www.ryanvice.net/nuget/creating-a-nuget-package-that-will-install-files-relative-to -解决方案/](http://www.ryanvice.net/nuget/creating-a-nuget-package-that-will-install-files-relative-to-the-solution/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-18T08:32:34.197

我创建了一个通用的 nuget 包，它可以解决您的问题，但采用不同的方法。它不是将包复制到 lib 文件夹，而是在构建时将它们复制到构建输出文件夹。

您的 nuspec 文件可能如下所示：

```
<files>
    <file src="output\Implementation.dll" target="output\Implementation.dll" />
    <file src="lib\Implementation.Contract.dll" target="output\Implementation.Contract.dll" />
</files> 
```

将此 nuget 包添加到项目时，会添加 Implementation.Contract.dll 作为对项目的引用，但不会将实施添加到项目中。

有关完整示例，请阅读我的博客： [http ://www.baseclass.ch/blog/Lists/Beitraege/Post.aspx?ID=6&mobile=0](http://www.baseclass.ch/blog/Lists/Beitraege/Post.aspx?ID=6&mobile=0)

# java - 在构造函数和方法中调用thread.start()方法有什么区别

> ID：11320619
> 
> 赞同：0
> 
> 时间：2012-07-03T23:34:49.120
> 
> 标签：java, multithreading, constructor

例如。- 上课

```
import java.awt.Color;
import java.util.Random;

import javax.swing.JLabel;

public class flashThread implements Runnable {
private JLabel temp;
Thread thread;
Color randColor;

public flashThread(JLabel toFlash) {
    temp = toFlash;
    thread = new Thread(this);
}

public void run() {
    Random r = new Random();
    while (true) {
        temp.setForeground(new Color(r.nextInt(246) + 10,
                r.nextInt(246) + 10, r.nextInt(246) + 10));
        String tempString = temp.getText();
        temp.setText("");
        try {
            thread.sleep(r.nextInt(500));
        } catch (InterruptedException e) {
        }
        temp.setText(tempString);
        try {
            thread.sleep(r.nextInt(500));
        } catch (InterruptedException e) {
        }
    }
}

public void begin() {
    thread.start();
}

} 
```

如果我在构造函数中添加了thread.start()，当我创建flashThread的两个对象时，只有一个会闪烁。但是，如果我删除然后，添加 begin() 方法，然后从初始化两个 flashThread 对象的类中调用 begin 方法，它们都闪烁。

任何帮助 - 我才刚刚开始了解线程。

提前致谢！-我

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-03T23:48:13.027

首先，请以大写字母开头您的类名，因为这是 java 中的约定。
在构造函数或方法中启动线程并不重要。一个问题是您在[事件调度线程](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/dispatch.html)(EDT) 之外访问 UI 元素，这是唯一允许访问 UI 元素的线程。
请改用[SwingUtilities.invokeLater](http://docs.oracle.com/javase/6/docs/api/javax/swing/SwingUtilities.html#invokeAndWait%28java.lang.Runnable%29)。此外，在类上调用静态方法，如[Thread#sleep](http://docs.oracle.com/javase/6/docs/api/java/lang/Thread.html#sleep%28long%29)`Thread.sleep(1000);` ，而不是在实例上。
所以更新你的代码看起来像：

```
public class FlashThread implements Runnable {
  private JLabel temp;
  Thread thread;
  Color randColor;

  public FlashThread(JLabel toFlash) {
    temp = toFlash;
    thread = new Thread(this);
    thread.start();
  }

  public void run() {
    final Random r = new Random();
    while (true) {
        SwingUtilities.invokeAndWait(new Runnable(){
           public void run() {
              // this will be executed in the EDT
              temp.setForeground(new Color(r.nextInt(246) + 10,
                r.nextInt(246) + 10, r.nextInt(246) + 10));
              // don't perform long running tasks in the EDT or sleep
              // this would lead to non-responding user interfaces
           }
        });
        // Let our create thread sleep
        try {
            Thread.sleep(r.nextInt(500));
        } catch (InterruptedException e) {
        }
    }
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-03T23:43:43.603

如果您在构造函数中调用 new Thread(this) ，则您将在对象完全创建之前传递对它的引用 - 因此它不应始终正常工作。

# php - 动态创建 Yii FormModel 对象（CFormModel）

> ID：11320621
> 
> 赞同：5
> 
> 时间：2012-07-03T23:34:51.653
> 
> 标签：php, forms, class, yii, magic-methods

我正在开发一个涉及在高抽象级别生成表单的应用程序（它是一个 CMS 应用程序）。我想动态创建 CFormModel 对象并即时设置表单字段。我想我可以通过扩展 CFormModel 来做到这一点，然后动态地创建代表表单字段的类属性（Yii 术语中的“属性”）。

为了说明，而不是在以下类中指定登录表单（在文件中定义）：

```
// From: http://www.yiiframework.com/doc/guide/1.1/en/form.model
class LoginForm extends CFormModel
{
    public $username;
    public $password;
    public $rememberMe=false;

    private $_identity;

    public function rules()
    {
        return array(
            array('username, password', 'required'),
            array('rememberMe', 'boolean'),
            array('password', 'authenticate'), // assume function authenticate defined elsewhere
        );
    }
} 
```

我想这样做：

```
class MyFormModel extends CFormModel {

    protected $_rules = array();

    public function __construct($attributes=array(), $rules=array()) {

        foreach ($attributes as $i => $attr) {
            $this->{$attr} = ???; // <<== This is the key here
        }

        // pass in array of rules as described in Yii doc for CFormModel
        $this->_rules = $rules;
    }

    public function rules() {
        return $_rules;
    }
} 
```

并在需要时调用它，如下所示：

```
$myModelObj = new MyFormModel($attr, $rules); 
```

在哪里 ：

```
$attr = array(
            'username',
            'rememberMe',
            'password',
        );
$rules = array(
            array('username, password', 'required'),
            array('rememberMe', 'boolean'),
            array('password', 'authenticate'), // assume function authenticate defined elsewhere
        ); 
```

请注意，在我要完成的工作中，任何文件中都没有写入“LoginClass”，它是在代码中动态创建的。

这将允许我创建表单（在视图中）做这样的事情：

```
// based on http://www.yiiframework.com/doc/guide/1.1/en/form.view
<?php echo $wForm->textField($myModelObj,'username'); ?> 
```

等等

我已经尝试过了，并且 $this->{$attr} 行失败了：

```
Property "MyFormModel.username" is not defined. 
```

实际上，该行的代码只是：

```
$this->{$attr}; 
```

这 ？？？表示我不确定要为此分配什么。在 Yii 文档示例中，他们只是将字段定义为公共类变量。

我应该使用魔术方法吗？

我在这里尝试做的事情甚至可能吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-04T06:43:51.497

你可能知道 Yii 使用[OOP 重载](http://php.net/manual/en/language.oop5.overloading.php)来解决你的 AR 属性。

你需要在这里做的和 Yii 内部做的类似。

定义一个硬编码的属性来存储你所有的自定义属性，比如一个数组：`$_data`

并且此数据将是一个数组，并将保存您在运行时添加的所有属性。你可能需要像 Yii 那样覆盖魔法方法（setters,getters,isset）来挑战验证，首先从你的`$_data`属性持有者中解析属性名称。

[您将在CActiveRecord](http://code.google.com/p/yii/source/browse/tags/1.1.10/framework/db/ar/CActiveRecord.php)中找到的某种代码会查找所有`__XXX`类似方法。

如果您将 AR 属性处理复制到您的自定义类中，您将在您的级别上运行所有这些，并且当您的魔术方法无法解决它时将退回到 Yii。

另外我会研究行为，因为您可以将许多常见功能委托给行为类。

**组件行为的使用**

一个组件支持[mixin](http://en.wikipedia.org/wiki/Mixin)模式并且可以附加一个或多个行为。行为是一个对象，其方法可以通过收集功能而不是专门化（即普通类继承）的方式由其附加组件“继承”。一个组件可以附加多个行为，从而实现“多重继承”。

行为类必须实现`IBehavior`接口。大多数行为都可以从`CBehavior`基类扩展。如果需要将行为附加到模型，它也可以从[CModelBehavior](http://www.yiiframework.com/doc/api/1.1/CModelBehavior)或[CActiveRecordBehavior](http://www.yiiframework.com/doc/api/1.1/CActiveRecordBehavior)扩展，后者实现了特定于模型的附加功能。

要使用行为，必须首先通过调用行为的`attach()`方法将其附加到组件。然后我们可以通过组件调用行为方法：

```
// $name uniquely identifies the behavior in the component
$component->attachBehavior($name,$behavior);
// test() is a method of $behavior
$component->test(); 
```

可以像组件的普通属性一样访问附加的行为。例如，如果一个名为 tree 的行为附加到一个组件，我们可以使用以下方法获取对该行为对象的引用：

```
$behavior=$component->tree;
// equivalent to the following:
// $behavior=$component->asa('tree'); 
```

可以暂时禁用行为，使其方法无法通过组件使用。例如，

```
$component->disableBehavior($name);
// the following statement will throw an exception
$component->test();
$component->enableBehavior($name);
// it works now
$component->test(); 
```

附加到同一组件的两个行为可能具有相同名称的方法。在这种情况下，第一个附加行为的方法将优先。

当与[事件](http://www.yiiframework.com/doc/guide/1.1/en/basics.component#component-event)一起使用时，行为更加强大。一个行为，当被附加到一个组件时，可以将它的一些方法附加到组件的一些事件上。通过这样做，行为有机会观察或改变组件的正常执行流程。

行为的属性也可以通过它所附加的组件来访问。属性包括公共成员变量和通过行为的 getter 和/或 setter 定义的属性。例如，如果行为具有名为 xyz 的属性，并且该行为附加到组件 $a。然后我们可以使用表达式`$a->xyz`来访问行为的属性。

更多阅读：
[http ://www.yiiframework.com/wiki/44/behaviors-events](http://www.yiiframework.com/wiki/44/behaviors-events)
[http://www.ramirezcobos.com/2010/11/19/how-to-create-a-yii-behavior/](http://www.ramirezcobos.com/2010/11/19/how-to-create-a-yii-behavior/)

# bash - 循环填充 .bash_history

> ID：11320623
> 
> 赞同：2
> 
> 时间：2012-07-03T23:34:52.750
> 
> 标签：bash, shell, loops, history

如何编写一个循环来达到 bash 中 $HISTFILESIZE 的限制？

这样的东西实际上会打印命令吗？

```
for i in $(seq 1 $HISTFILESIZE); do echo test-$i;done 
```

目标是查看日志是否可以被恶意用户用来隐藏其 shell 历史记录的简单循环覆盖。我的 .bash_history 仅附加： chattr +a 我知道依靠 .bash_history 可能不是跟踪的最佳方式，这更像是一个“我很好奇”的问题。

谢谢乔恩

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T01:25:21.197

您不需要`seq`，Bash 有两种方法可以提供数字以通过循环进行迭代`for`。

```
for i in {1..100} 
```

它不会将变量作为参数（除非您使用`eval`）。

和

```
for ((i = 1; i <= $HISTFILESIZE; i++)) 
```

这显然可以使用变量。

你可以做：

```
for ((i = 1; i <= $HISTFILESIZE; i++))
do
    history -s "anything you want"
done 
```

使用这种技术，用户可以删除当前会话的内存历史列表。当用户退出时，该列表被写入历史文件。

您可以截断历史文件：

```
>~/.bash_history 
```

假设它不是仅附加的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T01:09:31.767

好吧，用户总是可以运行

```
for i in $(seq 1 $HISTFILESIZE); do echo test-$i;done 
```

正如您所说，并将输出粘贴到终端中。但是`.bash_history`是在用户的主目录中，所以他可以`chmod +w`再`shred`它一样轻松。

# asp.net - 如何在没有 SSL 的情况下安全登录？

> ID：11320624
> 
> 赞同：1
> 
> 时间：2012-07-03T23:34:53.140
> 
> 标签：asp.net, security

我的网络托管服务没有给我 SSL。我想知道是否有一种方法可以在没有它的情况下保护登录。它不是一个高风险的网络应用程序，但有一个登录来编辑内容，我不希望该网站被黑客入侵。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T00:01:14.460

**简短的回答：没有。**

如果没有 SSL，您将有一个根本不安全的登录。

# python - 为什么 jinja2/python 上的这个 HTML 模板在字符串替换中产生 'u( )' 元组错误？

> ID：11320625
> 
> 赞同：0
> 
> 时间：2012-07-03T23:35:05.260
> 
> 标签：python, google-app-engine, utf-8, jinja2

我写了下面的代码，但是发生了一些奇怪的事情。用 jinga2 替换字符串的某些部分将替换的字符串放入`'u( )'`，这样：

![在此处输入图像描述](../Images/bf21c9432872659e0ebfb6c9959587f3.png)

但这仅发生在 3 个变量中。这里是 HTML 模板：

```
<!DOCTYPE html>

<html>
  <head>
    <title>Contract with Python</title>
    <style type="text/css">
      .label {text-align: right}
      .error {color: red}
    </style>

  </head>

  <body>
    <h2>Contract with Python</h2>
    <form method="post">

 <hr>

      <table> 

        <tr>
          <td class="label">
            Name
          </td>
          <td>
            <input type="text" name="person" value= 

"{{person}}">
          </td>
          <td class="error">        {{person_error}}
         </td>
         </tr>

         <tr>
          <td class="label">
            Nacionality
          </td>
          <td>
            <input type="text" name="nacionality" value= 

"{{nacionality}}">
          </td>
        </tr>

        <tr>
          <td class="label">
            Profession
          </td>
          <td>
            <input type="text" name="profession" value= 

"{{profession}}">
          </td>
        </tr>

        <tr>
          <td class="label">
            Marital Status
          </td>
          <td>      
          <select name = "maritalStatus">
              <option>unmarried</option>
              <option>married</option>
              <option>divorced</option>
              <option>widower</option>
          </select>
           </td>
          </tr>

        <tr>
          <td class="label">
            Driver's License
          </td>
          <td>
            <input type="text" name="driverLicense" value=" 

{{driverLicense}}">
          </td>
        </tr>

        <tr>
          <td class="label">
            SSN
          </td>
          <td>
            <input type="text" name="SSN" value="{{SSN}}">
          </td>
          <td class="error"> {{SSN_error}}
          </td>
        </tr>

        <tr>
          <td class="label">
            Address
          </td>
          <td>
            <input type="text" name="address" value= 

"{{address}}">
          </td>
        </tr>

        <tr>
          <td class="label">
            Email (optional)
          </td>
          <td>
            <input type="text" name="email" value="{{email}}">
          </td>
          <td class="error"> {{email_error}}
          </td>
        </tr>

      </table>

<br>

<hr>
        <td class="label">
          Contract Type
          <select name = "contractType">
              <option>House  Rental Contract</option>
              <option>Car Rental Contract</option>
              <option>Other</option>
          </select>
          </td>
<br>
<br>
<tr>
              <td class="label">
               Contract number
              </td>
              <td>
                <input type="text" name="numBook" value= 

    "{{numBook}}">
              </td>
            </tr>

    <tr>
              <td class="label">
                Initial Page
              </td>
              <td>
                <input type="text" name="numInitialPage" value= 

    "{{numInitialPage}}">
              </td>
            </tr>

    <tr>
              <td class="label">
                Final Page
              </td>
              <td>
                <input type="text" name="numFinalPage" value= 

    "{{numFinalPage}}">
              </td>
            </tr>

<hr>

      <input type="submit">
    </form>
  </body>

</html> 
```

如何解决？**为什么它只发生在“numBook”、“numInitialPage”和“numFinalPage”（而不是其他字符串替换）**？

整个代码在这里：

```
# -*- coding: utf-8 -*-
# -*- coding: utf-8 -*-
#!/usr/bin/env python
#
# Copyright 2007 Google Inc.
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

import os

import webapp2

import jinja2

jinja_environment = jinja2.Environment(autoescape=True,
    loader=jinja2.FileSystemLoader(os.path.join(os.path.dirname(__file__), 'templates')))

import re

from google.appengine.ext import db

USER_RE = re.compile(r"^[a-zA-Z0-9_ -]{3,20}$")
def valid_person(person):
    return USER_RE.match(person)

PASS_RE = re.compile(r"^.{3,20}$")
def valid_SSN(SSN):
    return PASS_RE.match(SSN)

EMAIL_RE = re.compile(r"^[\S]+@[\S]+\.[\S]+$")
def valid_email(email):
    return EMAIL_RE.match(email)

import time

import datetime

def getNumBookPg():
    doc = open("numbookpg.txt")
    numBookPg = []
    numbers = doc.read().split()
    for n in numbers:
        numBookPg.append(n)
    return numBookPg

numBookPage = getNumBookPg()

##def updateNumBookPg(b, ip, fp):
##    newNumBookPg = ' ' + b + ' ' + str(int(fp) + 1) + ' ' + str(int(fp) + 1)
##    doc = open("numbookpg.txt", "w")
##    doc.write(newNumBookPg)

def dateToday():
    today = datetime.datetime.today()
    todayDay = str(today.day)
    todayMonth = str(today.month)
    monthExt = {'1':' January ', '2':'February', '3':' March ', '4':'April', '5':'May', '6':'June', '7':' July ', '8':'August', '9':'September', '10':'October', '11':'November ', '12':'December'}
    todayYear = str(today.year)
    return(todayDay + ' of  ' + monthExt[todayMonth] + ' of ' + todayYear)

class MainHandler(webapp2.RequestHandler):
    def get(self):
        numBook = numBookPage[-3]
##        numInitialPage = numBookPage[-2]
##        numFinalPage = numBookPage[-1]
        template_values = {"person": "",
                                       "nacionality": "",
                                       "SSN": "",
                                       "driverLicense": "",
                                       "email":"",
                                       "person_error": "",
                                       "SSN_error": "",
                                       "driverLicense_error": "",
                                       "address": "",
                                       "email_error": "",
                                       "numBook": numBook,
##                                       "numInitialPage": numInitialPage,
##                                       "numFinalPage": numFinalPage,
                                       }
        template = jinja_environment.get_template('index.html')
        self.response.out.write(template.render(template_values))

##    def write_form(self, text_write):
##        self.response.out.write(text_write)

    def post(self):
        person_name = self.request.get("person")
        user_nacionality = self.request.get('nacionality')
        user_profession = self.request.get('profession')
        user_maritalStatus = self.request.get('maritalStatus')
        user_SSN = self.request.get('SSN')
        user_email = self.request.get('email')
        user_driverLicense = self.request.get('driverLicense')
        person_error = ""
        SSN_error = ""
        driverLicense_error = ""
        geted_email_error = ""
        address = self.request.get('address')
        contractType = self.request.get("contractType")
        owner = self.request.get("owner")
        witness = self.request.get("witness")
        numBook = self.request.get("numBook"),
        numInitialPage = self.request.get("numInitialPage"),
        numFinalPage = self.request.get("numFinalPage"),

        if (person_name and valid_person(person_name)) and (user_SSN and valid_SSN(user_SSN)) and ((not user_email) or (user_email and valid_email(user_email))):
            a = Person(firstName = person_name,
                                   nacionality = user_nacionality,
                                   maritalStatus = user_maritalStatus,
                                   profession = user_profession,
                                   SSN = int(user_SSN),
                                   driverLicense = int(user_driverLicense)
                                   #address = user_address
                                   )
            a.put()
            self.redirect('/your_contract?person=%s&nacionality=%s&profession=%s&maritalStatus=%s&SSN=%s&driverLicense=%s&email=%s&witness=%s&owner=%s&contractType=%s&address=%s&numBook=%s&numInitialPage=%s&numFinalPage=%s' % (person_name, user_nacionality, user_profession, user_maritalStatus, user_SSN, user_driverLicense, user_email,
witness, owner, contractType, address, numBook, numInitialPage, numFinalPage))

        else:
            if not person_name or not valid_person(person_name):
                person_error = "Oh no!!! this person name isn't valid!"
            if not user_SSN or not valid_SSN(user_SSN):
                SSN_error = "Oh no!!! SSN isn't valid!"
            if user_email and not valid_email(user_email):
                geted_email_error = "Oh no!!! e-mail isn't valid!"
            template_values = {"person": person_name,
                                "nacionality": user_nacionality,
                                "maritalStatus": user_maritalStatus,
                                "profession": user_profession,
                                "SSN": user_SSN,
                                "driverLicense": user_driverLicense,
                                "email": user_email,
                                "person_error": person_error,
                                "SSN_error": SSN_error,
                                "driverLicense_error": user_driverLicense,
                                "address": address,
                                "email_error": geted_email_error}
            template = jinja_environment.get_template('index.html')
            self.response.out.write(template.render(template_values))

class your_contractHandler(webapp2.RequestHandler):
    def get(self):
        geted_person_name = self.request.get('person')
        geted_user_nacionality = self.request.get("nacionality")
        geted_user_profession = self.request.get("profession")
        geted_user_maritalStatus = self.request.get("maritalStatus")
        geted_user_SSN = self.request.get('SSN')
        geted_user_email = self.request.get('email')
        geted_user_driverLicense = self.request.get('driverLicense')
        geted_person_error = ""
        geted_SSN_error = ""
        geted_driverLicense_error = ""
        geted_address = self.request.get('address')
        geted_owner = self.request.get("owner")
        geted_witness = self.request.get("witness")
        geted_contractType = self.request.get("contractType")
        geted_dateToday = dateToday()
        your_contract = jinja_environment.get_template('your_contract.html')
        geted_numBook = self.request.get('numBook')
        geted_numInitialPage = self.request.get('numInitialPage')
        geted_numFinalPage = self.request.get('numFinalPage')
##        updateNumBookPg(geted_numBook, geted_numInitialPage, geted_numFinalPage)
        your_contract_values = {"person":geted_person_name,
                                "nacionality":geted_user_nacionality,
                                "maritalStatus": geted_user_maritalStatus,
                                "profession": geted_user_profession,
                                "SSN":geted_user_SSN,
                                "driverLicense":geted_user_driverLicense,
                                "address":geted_address,
                                "email":geted_user_email,
                                "contractType":geted_contractType,
                                "dateContract":geted_dateToday,
                                "numBook":geted_numBook,
                                "numInitialPage":geted_numInitialPage,
                                "numFinalPage":geted_numInitialPage,
                                }
        template = jinja_environment.get_template('index.html')
        self.response.out.write(your_contract.render(your_contract_values))

class Person(db.Model):
    firstName = db.StringProperty(required = True)
#    lastName = db.StringProperty(required = True)
    nacionality = db.StringProperty(required = True)
    maritalStatus = db.StringProperty(required = True)
    profession = db.StringProperty(required = True)
    SSN = db.IntegerProperty(required = True)
    driverLicense = db.IntegerProperty(required = True)
#    address = db.PostalAdressProperty(required = True)
#    condition = db.StringProperty(required = False, choices=set(["buyer", "seller", "renter", "owner", "witness"]))

##class Acts(db.Model):
##    firstPart = db.StringProperty(required = True)
##    secondPart = db.StringProperty(required = True)
##    contractNumber = db.IntegerProperty(required = False)
##    contractDate = db.DateProperty(auto_now_add=True)
##    contractDraft = db.TextProperty(required = True)

app = webapp2.WSGIApplication([('/', MainHandler), ('/your_contract', your_contractHandler)],
                              debug=True) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T06:14:12.640

```
numBook = self.request.get("numBook"),
numInitialPage = self.request.get("numInitialPage"),
numFinalPage = self.request.get("numFinalPage"), 
```

正如 Wooble 的评论所说，这些行不应该以逗号结尾。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-03T23:41:47.433

看起来你在那里有一个元组。您可以只使用第 0 个索引。

喜欢

```
<td class="label">
            Contract number
          </td>
          <td>
            <input type="text" name="numBook" 

value="{{numBook.0}}">
            Page <input type="text" name="numInitialPage" 

value="{{numInitialPage.0}}"> to <input type="text" 

name="numFinalPage" value="{{numFinalPage.0}}">
          </td> 
```

# excel - Excel 是否有用于解析公式的内置方法？（即：获取包含的 RANGE 参考列表）

> ID：11320626
> 
> 赞同：6
> 
> 时间：2012-07-03T23:35:08.687
> 
> 标签：excel, vba

对于单元格中的给定 Excel 公式，我希望能够解析公式以获取公式中包含的 Excel 范围引用列表。

例如，如果我有一个带有这个公式的单元格：

```
= A + 25 + B 
```

....我希望能够获得公式中包含的 excel 范围数组，因此在这种情况下，它将包含 [A] 和 [B]

“你为什么要这样做”？，我可以听到你问：我
为什么要这样做的一个例子是在公式中查找范围的“标签”......所以，而不是仅仅执行 CTRL+~ 来查看工作表中的公式，我想要以编程方式访问公式中的范围引用的选项，以便在目标范围旁边查找标签。

因此，在上面的示例中，我可以编写如下公式：

```
=Offset(CellFormulaRanges('TheAddressMyFormulaIsIn',1),0,-1)
=Offset(CellFormulaRanges('TheAddressMyFormulaIsIn',2),0,-1) 
```

...这会给我公式中第一个和第二个范围左侧的标签。

这样做必须调用 Excel 本身中已有的一些功能，因为手写公式解析器是一项复杂的任务：
[http ://ewbi.blogs.com/develops/2004/12/excel_formula_p.html](http://ewbi.blogs.com/develops/2004/12/excel_formula_p.html)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-12T18:17:33.383

感谢@TimWilliams 和@brettdj 为我在之前关于该主题的讨论中指明了正确的方向，我可以自信地说：

不，EXCEL 没有解析方法。

但是，出于我相当小的目的，我想出了一些可行的方法，可以与跨工作表引用一起使用，并且可以从 UDF 中调用。

但是，它非常脆弱，并且有许多完全合法的公式我敢肯定它不会正确处理。

代码是一团糟，可以大大改进，但我只是想把它扔在这里，因为我暂时要转向别的东西......

## 编辑

还发现了这个，看起来很有趣：
[http ://www.dailydoseofexcel.com/archives/2009/12/05/formula-tokenizer/](http://www.dailydoseofexcel.com/archives/2009/12/05/formula-tokenizer/)

```
Public Function CellPrecedents(cell As Range) As Variant()
    Dim resultRanges As New Collection
    If cell.Cells.count <> 1 Then GoTo exit_CellPrecedents
    If cell.HasFormula = False Then GoTo exit_CellPrecedents

    Dim formula As String
    formula = Mid(cell.formula, 2, Len(cell.formula) - 1)

    If IsRange(formula) Then
        resultRanges.Add Range(formula), 1
    Else
        Dim elements() As String
        'Debug.Print formula & " --> "
        formula = Replace(formula, "(", "")
        formula = Replace(formula, ")", "")
        'Debug.Print formula & " --> "
        elements() = SplitMultiDelims(formula, "+-*/\^")
        Dim n As Long, count As Integer
        For n = LBound(elements) To UBound(elements)
            If IsRange(elements(n)) Then
                'ACTUALLY JUST DO A REDIM PRESERVE HERE!!!!
                count = count + 1
                'resultRanges.Add Range(Trim(elements(n)))  '<---  Do **NOT** store as a range, as that gets automatically Eval()'d
                resultRanges.Add Trim(elements(n))
            End If
        Next
    End If

    Dim resultRangeArray() As Variant
    ReDim resultRangeArray(resultRanges.count)
    Dim i As Integer
    For i = 1 To resultRanges.count
        resultRangeArray(i) = CStr(resultRanges(i))  '// have to store as a string so Eval() doesn't get invoked (I think??)
    Next

    CellPrecedents = resultRangeArray

exit_CellPrecedents:
    Exit Function
End Function

Public Function IsRange(var As Variant) As Boolean
    On Error Resume Next
    Dim rng As Range: Set rng = Range(var)
    If err.Number = 0 Then IsRange = True
End Function 
```

（只需谷歌 SplitMultiDelims 即可获得该功能）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-08-06T18:24:40.097

Tbone，另一种选项不是您直接要求的，但可以作为替代解决方案。

与其使用公式来尝试找到相应的标签，不如尝试调整公式以适合您。以下是几个选项，具体取决于您尝试解析的公式是什么。1.如果你的公式是一个查找，你可以偏移到左边看。2\. 或者，您可以在两个公式中使用“间接”函数来确保它们引用正确的位置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-04T21:53:39.657

简而言之，我认为您想做 : 的子部分`Use VBA to generate code to reproduce basic calculations on an Excel worksheet`，并使用函数返回第 n 个 DirectPrecedents 集合元素的地址或名称。

来源：[http ://www.vb-helper.com/howto_vba_excel_formulas.html](http://www.vb-helper.com/howto_vba_excel_formulas.html)

但是，此用例已被弃用。从 Excel 2007 开始，表格可以提供更好的解决方案。

# serial-port - 远程串口协议，带认证和加密

> ID：11320627
> 
> 赞同：11
> 
> 时间：2012-07-03T23:35:29.277
> 
> 标签：serial-port, network-protocols, remote-access

我想通过网络提供一个串行端口。[RFC-2217](https://www.rfc-editor.org/rfc/rfc2217)为 Telnet 提供扩展以传输额外的串行端口信息，例如速度、数据位、停止位和硬件握手线。

但是，我想确保网络上的任何人都不能自由访问它，所以我想做身份验证和加密。Telnet 在身份验证方面很弱，并且不提供加密。SSH 通常优于 Telnet。

是否有任何协议允许通过 SSH 进行串行端口传输，类似于[RFC-2217](https://www.rfc-editor.org/rfc/rfc2217)？

我意识到一种选择可能是通过 SSH 隧道隧道 Telnet + [RFC-2217 。](https://www.rfc-editor.org/rfc/rfc2217)这在技术上是可以实现的，但实际上它有点尴尬。

**零配置**

另一个问题是，如何使用 Zeroconf DNS-SD 通告这样的端口？例如，一个 Telnet + RFC-2217 串行端口（通过 SSH 隧道传输）如何通过 Zeroconf 发布？`_telnetcpcd._tcp`（据我所知，普通的 Telnet + RFC-2217 可能会被宣传。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-28T02:34:52.927

我不确定 SSH 隧道是否像您想象的那样尴尬：

> **-W** *host* :port
> 请求将客户端上的标准输入和输出通过安全通道转发到端口上的主机。隐含**-N**、**-T**、**ExitOnForwardFailure**和**ClearAllForwardings**并且仅适用于协议版本 2。

下面是一个短的 SMTP 会话的隧道的样子（以粗体输入）：

```
$ **ssh -W mail.server.com:25 blahdiblah@server.com**
220 mail.server.com ESMTP 
Postfix
**ehlo foo.com**
250-mail.server.com
250-PIPELINING
250-SIZE
250-ETRN
250-AUTH LOGIN PLAIN
250-STARTTLS
250-ENHANCEDSTATUSCODES
250-8BITMIME
250 DSN
**quit**
221 2.0.0 Bye 
```

无需单独设置隧道然后连接到该端口，只需管道输入和输出来自 ssh 进程。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-29T21:53:50.910

您想要的是一个安全的 LAN 串行连接。

您找不到任何这样做的免费项目的原因很简单——大多数开源项目将传输层安全性与协议分开（有充分的理由）。无需为每个应用程序重新发明轮子，您只需重新使用安全组件（在本例中为 SSH）并将其应用于您的不安全协议（例如，与 RFC-2217 兼容）。

只需使用 SSH 隧道或*stunnel*来保护连接。对于 Windows 客户端，您可以使用*com2com*和 *nix 系统，例如*ttyd*。

*例如， com2com*甚至不需要在初始设置后手动启动，因此您的用户只需建立一个 SSH 隧道（例如通过 PuTTY）。

*   [com2com](http://com0com.sourceforge.net/)
*   [socat](http://www.dest-unreach.org/socat/)，使用`pty`，`openssl-listen`你可以做你想做的事（与我上面写的有点矛盾，因为它*确实*实现了传输层安全性）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-08-01T02:18:44.977

SSH 提供[“请求伪终端”](https://www.rfc-editor.org/rfc/rfc4254#section-6.2)和[“伪终端编码终端模式”](https://www.rfc-editor.org/rfc/rfc4254#section-8)。它提供设置波特率、位、奇偶校验、停止位配置。可以设置`PARMRK`接收帧错误和中断条件。然而，目前 SSH 协议似乎缺少任何命令来*设置*中断条件，或设置 DTR 和 RTS 调制解调器硬件线路，或获取 DSR、CTS、DCD 和 RING 调制解调器硬件线路。

看：

*   [RFC 4254 - 安全外壳 (SSH) 连接协议](https://www.rfc-editor.org/rfc/rfc4254)
*   [安全外壳 (SSH) 协议参数 — IANA](http://www.iana.org/assignments/ssh-parameters/ssh-parameters.xhtml)

# html - CSS 选择器“div p”和“div > p”有什么区别？

> ID：11320631
> 
> 赞同：15
> 
> 时间：2012-07-03T23:36:21.000
> 
> 标签：html, css, css-selectors

> **可能重复：**
> [“div > p”和“div p”是否相同？](https://stackoverflow.com/questions/3948846/are-div-p-div-p-same)

[这是](http://www.w3schools.com/cssref/css_selectors.asp)我用作 CSS 参考的页面，请注意我今天早上才开始学习 HTML/CSS。

我对引用站点的两个选择器感到困惑，“div p”选择器`selects all <p> elements inside <div> elements`和“div > p”选择器`selects all <p> elements where the parent is a <div> element`。

这两者有什么区别？如果可能的话，这两个选择器不能互换使用的例子会很有帮助。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-07-03T23:41:19.830

`div > p`仅选择`<p>`作为 a 的直接子级的元素`<div>`。

所以：

```
div > p 
```

将选择此段落：

```
<div>
    <p>This is a paragraph</p>
</div> 
```

但不会选择这一段：

```
<div>
    <table>
        <tr>
            <td>
                <p>This will not get selected</p>
            </td>
        </tr>
    </table>
</div> 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-07-03T23:38:51.630

选择`p`a 内的所有标签`div`意味着`p`a `div`... 内的所有标签，其中第二个表示`p`仅比 a 低一级的标签`div`。

来自[你必须记住的 30 个 CSS 选择器](http://net.tutsplus.com/tutorials/html-css-techniques/the-30-css-selectors-you-must-memorize/)#8：

> 标准 XY 和 X > Y 的区别在于后者只会选择直接子代。例如，考虑以下标记。

考虑这个例子：

**HTML**

```
<div class="one">
  <p>asdf</p>
  <div>
    <p>asdf</p>
  </div>
</div>

<div class="two">
  <p>asdf</p>
  <div>
    <p>asdf</p>
  </div>
</div> 
```

**CSS**

```
div.one p {
  margin: 20px;
  background-color:#F00;
}

div.two > p {
  margin: 20px;
  background-color:#0F0;
} 
```

在第一个中，两个`p`标签都将被涂成红色 ( `#F00`)，因为它选择`p`了`div`. 在第二个中，只有第一个`p`标记将是蓝色 ( `#0F0`)，因为它只选择直接后代。

[**演示**](http://cssdesk.com/8GsBX)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-03T23:41:11.017

`div p`是后代选择器，它将匹配其层次结构`p`中具有`div`更高层次的任何元素。`div > p`，它使用子选择器，只会匹配`p`直接父元素是 a 的元素`div`。

[http://www.w3.org/TR/CSS2/selector.html#pattern-matching](http://www.w3.org/TR/CSS2/selector.html#pattern-matching)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-03T23:42:43.030

**案例 1**：`"div p"`意味着所有的`<p>`'s 将被选中

```
<div>
  <p id=1> 
    <p id=2>
      <p id=3></p>
    </p>
  </p>
</div> 
```

**情况 2**：`"div > p"`仅`<p id=1>`将被选中，即所有`p`标签都`div`作为直接父级

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-03T23:44:10.677

`div p`将匹配任何`p`与祖先`div`，不需要是它的父母。所以所有这些匹配：

```
<div><p>Matches</p></div>
<div><form><p>Matches</p></form></div>
<div><section><blockquote><p>Matches</p></blockquote></section></div> 
```

`div > p`只会将 a`p`与直接父级匹配`div`。像这样：

```
<div><p>Matches</p></div> 
```

（您会注意到匹配的所有`div > p`内容也匹配`div p`。）

# python - 使用 wexpect 运行可执行文件

> ID：11320639
> 
> 赞同：2
> 
> 时间：2012-07-03T23:38:05.370
> 
> 标签：python, wexpect

我有一个可执行文件 (evapo.exe) 必须使用输入文件 (inputs.prj) 调用，通常我只需键入 c:\myfiles\evapo inputs.prj 即可使用 Windows 命令提示符执行此操作（当然这两个可执行文件和位于 myfiles 文件夹中的输入文件）

现在我希望能够使用 python 做同样的事情。此处关于 SO 的其他类似问题建议使用 wexpect，因为当可执行文件要求运行其他信息时，其他方法（例如 subprocess）不起作用（对于我的情况，信息是输入文件）。我试过：

```
import wexpect

wexpect.run(r'c:\myfiles\evapo.exe') 
```

并且python挂起...，如果有人知道我如何使用cmd合并exe和输入文件，请帮助我。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-04T00:04:08.823

`wexpect`如果要传递的所有信息都是文件名，则不需要：

```
from subprocess import check_call

check_call(r'c:\myfiles\evapo.exe inputs.prj') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-03T23:55:43.037

我猜 wexpect 是 pexpect 的一个 python 端口，行为类似，但适用于 Windows。

我检查了以下内容：[http ://www.jjoseph.org/files/led_calibration/wexpect.py](http://www.jjoseph.org/files/led_calibration/wexpect.py)

如果是这种情况，那么 for 的任何示例`pexpect`都应该有效。

> 当您只想收集输出时，应该使用 run() 命令。当您想要交互并提供输入时，这不起作用。

如果要发送输入，则需要使用 spawn() 函数。

请参阅代码中的示例。在这里，命令要求输入由 wexpect 发送

```
child = wexpect.spawn('some command')
child.expect ('Password:')
child.sendline (mypassword) 
```

只需通过以下有关 pexpect 的答案并将其替换为 wexpect。

*   [从 python 运行期望脚本的最简单方法](https://stackoverflow.com/questions/11160504/simplest-way-to-run-expect-script-from-python/11160553#11160553)
*   [几乎不需要 pexpect 模块的帮助](https://stackoverflow.com/questions/11208931/need-little-assistance-with-pexpect-module/11210485#11210485)
*   [在预期交互方面几乎不需要帮助](https://stackoverflow.com/questions/11296426/need-little-assistance-with-pexpect-interaction/11297257#11297257)

并且对于windows，以下端口也被建议作为工作之一：

*   [https://bitbucket.org/geertj/winpexpect/wiki/Home](https://bitbucket.org/geertj/winpexpect/wiki/Home)

# c# - 反映特定属性的类

> ID：11320641
> 
> 赞同：1
> 
> 时间：2012-07-03T23:38:33.910
> 
> 标签：c#, asp.net, .net, reflection

如何编写通过我的项目并查找具有特殊属性并能够收集 2 条信息的类的反射代码：ClassName.PropertyName 和传递给属性内 ResourceManager.GetValue 的字符串。我的代码如下。请帮忙。谢谢

```
 [TestMethod]
    public void TestMethod1()
    {

        Dictionary<string, string> mydictionary = new Dictionary<string, string>();
        mydictionary = ParseAllClassesWithAttribute("MyAttribute");

        Assert.AreEqual(mydictionary["MyClass.FirstNameIsRequired"].ToString(), "First Name is Required");

    }

    private Dictionary<string, string> ParseAllClassesWithAttribute(string p)
    {
        Dictionary<string,string> dictionary = new Dictionary<string, string>();

        // use reflection to go through the class that is decorated by attribute MyAttribute
        // and is able to extract ClassName.PropertyName along with what is Inside
        // GetValue method parameter.
        // In the following I am artificially populating the dictionary object.

        dictionary.Add("MyClass.FirstNameIsRequired", "First Name is Required");
        return dictionary;
    }

     [MyAttribute]
     public class MyClass
        {
            public string FirstNameIsRequired
            {
                get
                {
                    return ResourceManager.GetValue("First Name is required");
                }
            }
        }

        public static class ResourceManager
        {
            public static string GetValue(string key)
            {
                return String.Format("some value from the database based on key {0}",key);
            }
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T00:06:44.163

反射无法提取`"First Name is Required"`值，除非您获取 IL 字节并解析它们。这是一个潜在的解决方案：

```
[AttributeUsage(AttributeTargets.Property)]
public class MyAttribute : Attribute
{
    public string TheString { get; private set; }
    public MyAttribute(string theString)
    {
        this.TheString = theString;
    }
}

const string FirstNameIsRequiredThing = "First Name is required";
[MyAttribute(FirstNameIsRequiredThing)]
public string FirstNameIsRequired
{
    get
    {
        return ResourceManager.GetValue(FirstNameIsRequiredThing);
    }
} 
```

现在您可以读取所有属性`MyAttribute`并查看预期值。（如果您对这部分有疑问，请务必遵循对您问题的评论的建议）

# iphone - 区分纯文本和网站链接以及 youtube 链接

> ID：11320644
> 
> 赞同：0
> 
> 时间：2012-07-03T23:38:53.363
> 
> 标签：iphone, ios, nsstring

我有 NSString 变量包含纯文本、youtube 链接、图像链接和花药网站链接。所以我的问题是如何提取每一个并保存在不同的变量中。

像这样的输出：

2012-07-04 02:45:23.158 mywordpressblog[67403:f803]

[http://www.mediafire.com/?ggnkn91qw57t33c](http://www.mediafire.com/?ggnkn91qw57t33c)

httpv://www.youtube.com/watch?v=_3VdzqChORI&feature=colike

# php - 在 CentOS 上使用 PHP 5.4 安装 APC（主干）

> ID：11320646
> 
> 赞同：0
> 
> 时间：2012-07-03T23:39:26.090
> 
> 标签：php, compilation, centos, apc

有人`APC`在 php 5.4 上成功安装了吗？根据我在 StackOverflow 上找到的另一个线程，似乎可以使用最新的`trunk`.

我抓住了后备箱，，，`phpize`但是`./configure`当我尝试运行时，`make`出现以下错误：

```
>/bin/sh /root/trunk/libtool --mode=compile cc  -I. -I/root/trunk -DPHP_ATOM_INC -I/root/trunk/include -I/root/trunk/main -I/root/trunk -I/usr/include/php -I/usr/include/php/main -I/usr/include/php/TSRM -I/usr/include/php/Zend -I/usr/include/php/ext -I/usr/include/php/ext/date/lib  -DHAVE_CONFIG_H  -g -O2   -c /root/trunk/apc.c -o apc.lo   
libtool: compile:  cc -I. -I/root/trunk -DPHP_ATOM_INC -I/root/trunk/include -I/root/trunk/main -I/root/trunk -I/usr/include/php -I/usr/include/php/main -I/usr/include/php/TSRM -I/usr/include/php/Zend -I/usr/include/php/ext -I/usr/include/php/ext/date/lib -DHAVE_CONFIG_H -g -O2 -c /root/trunk/apc.c  -fPIC -DPIC -o .libs/apc.o    
In file included from /root/trunk/apc.c:44:
/usr/include/php/ext/pcre/php_pcre.h:29:18: error: pcre.h: No such file or directory    
In file included from /root/trunk/apc.c:44:
/usr/include/php/ext/pcre/php_pcre.h:37: error: expected ‘=’, ‘,’, ‘;’, ‘asm’ or ‘__attribute__’ before ‘*’ token
/usr/include/php/ext/pcre/php_pcre.h:38: error: expected ‘=’, ‘,’, ‘;’, ‘asm’ or ‘__attribute__’ before ‘*’ token
/usr/include/php/ext/pcre/php_pcre.h:44: error: expected specifier-qualifier-list before ‘pcre’
/root/trunk/apc.c: In function ‘apc_search_paths’:
/root/trunk/apc.c:361: warning: assignment discards qualifiers from pointer target type
/root/trunk/apc.c: At top level:
/root/trunk/apc.c:394: error: expected specifier-qualifier-list before ‘pcre’
/root/trunk/apc.c: In function ‘apc_regex_compile_array’:
/root/trunk/apc.c:455: error: ‘apc_regex’ has no member named ‘preg’
/root/trunk/apc.c:455: error: ‘apc_regex’ has no member named ‘preg’
/root/trunk/apc.c:456: error: ‘apc_regex’ has no member named ‘nreg’
/root/trunk/apc.c:456: error: ‘apc_regex’ has no member named ‘nreg’
/root/trunk/apc.c: In function ‘apc_regex_match_array’:
/root/trunk/apc.c:488: error: ‘apc_regex’ has no member named ‘preg’
/root/trunk/apc.c:488: error: ‘apc_regex’ has no member named ‘preg’
/root/trunk/apc.c:489: error: ‘apc_regex’ has no member named ‘nreg’
/root/trunk/apc.c:489: error: ‘apc_regex’ has no member named ‘nreg’
make: *** [apc.lo] Error 1 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T01:08:30.443

您需要安装 PCRE 的开发头文件。

如果您使用的是 Centos 或 Fedora（或 REPL 或 ...），您可以通过以下方式获得它们：

*   `yum install pcre-devel`

如果您使用的是 Debian 或 Ubuntu，您可以通过以下方式获得它们：

*   `apt-get install libpcre3-dev`

# javascript - 如何用同位素附加图像

> ID：11320647
> 
> 赞同：1
> 
> 时间：2012-07-03T23:39:39.243
> 
> 标签：javascript, ajax, dom, jquery-isotope, pinterest

我正在编写一个显示图像的单页 javascript 应用程序，一个 la pinspire。我使用的库是 jQuery(1.7.2) 和最新版本的同位素。

我正在尝试在应用程序中实现无限滚动。当您滚动到页面底部时，ajax 与服务器对话并以 JSON 格式返回一个对象数组。此 JSON 用于构建多个 div，其中包含有关每个图像和图像本身的一些信息。

我将创建的每个 div 附加到启用同位素的容器中。在我的 ajax 调用的完整部分中，我调用 isotope("reLayout")。这工作得很好。

我的问题是添加十几个 div 会导致项目“颤动”，然后我希望将项目放在最后。我尝试了 addItems、插入、附加和不使用 to isotope("reLayout") 的各种排列，但无济于事。

如何添加包含带有 ajax 的图像的项目而不让它们重叠或飘动？

问候，尼克

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-28T19:27:28.107

我不知道这是否有帮助，但这是我所做的摘录：

```
var tmp = $();

// adding a jQuery-wrapped element to the tmp object
tmp = tmp.add( $( buildTemplate() ) );

$('#container').append(tmp);

tmp.imagesLoaded(function() {
    $('#container').isotope('appended', tmp);
}); 
```

我的关键是等待图像加载，否则 reLayout 没有做任何事情。

# c++ - 有一个小错误的正则表达式

> ID：11320650
> 
> 赞同：1
> 
> 时间：2012-07-03T23:39:55.920
> 
> 标签：c++, regex, boost-regex

我有这个字符串

```
hey {Bobby|Apple|Peter}, nice to meet you {David} 
```

这个正则表达式：

```
(\{(\w+)(\|(\w+))*)\} 
```

答案：

```
Bobby
Peter
David 
```

但是，它没有得到“Apple”，我该如何解决这个问题呢？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-03T23:45:48.253

重复不适用于团体。相反，尝试在字符串上迭代地使用 find 。可能最好先过滤掉`{Bobby|Apple|Peter}`，从中获取名称，然后从中查找`{David}`并获取名称。如果您继续使用正则表达式，那将是两个发现。或者一个`find`，然后`|`从结果中分离出来。

find: 的正则表达式`\{(\w+(?:\|\w+)*)\}`，然后使用组 1（大括号*内的所有内容）并拆分结果。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-03T23:50:42.633

你能展示重现这个问题的完整的、最小的代码吗？问题可能在于您如何遍历捕获的组。

# perl - PERL：使用 REGEX 匹配字符串，而字符串中没有重复的第一个标记。（ABC，不是 AAA ABC）

> ID：11320651
> 
> 赞同：1
> 
> 时间：2012-07-03T23:40:13.060
> 
> 标签：perl

我对 perl 比较陌生，如果这个问题很简单并且我遗漏了一些完全明显的东西，我提前道歉，但是，我已经四处寻找答案几天了，但找不到解决方案。

我正在尝试使用正则表达式来匹配第一个实例，其中 A 后跟 C，而 A 和 C 之间没有另一个 A。请注意，在此文本字符串中，在第一个 AC 组合之后还有其他实例也可能适合 AC， （特别注意ADC）这是文本：

```
$text = "AAA ABC ADE AFG ADC AHI AJK AIZ XXB NBV"; 
```

我第一次尝试：

```
@finds1=$TEXT=~m/(A.*?C)/;
$result = $finds1[0];
print "result = $result\n"; 
```

这将打印以下内容：

```
result = AAA ABC 
```

当我想要的只是：

```
result = ABC 
```

请注意，我正在尝试创建一个可以在 B 可以是任何字符串的情况下使用的正则表达式。例如 ADC、AFGHJKC、AYUIOKJHGTC。

接下来我尝试使用前瞻语句和 if then else 语句。这是代码：

```
@finds1=$TEXT=~m/(A(?(?!.*?A.*?C).*?C|Z{100}))/;
$result = $finds1[0];
print "result = $result\n"; 
```

正则表达式 (A) 的第一部分告诉 perl 找到 A。一旦找到，perl 就会处理 if then else 语句，其中条件语句是没有 . *?A.* ?A 跟在 A 后面的实例, 如果没有找到，则 perl 查找 .*?C，如果至少找到一个，则搜索 100 个 Z 实例。我试图解析有 100 个 Z。）

这将返回：

```
result = ADC 
```

在第一次识别 C 后，我考虑过使用积极的后视。但是，就像我上面提到的，第一个 AC 组合之间没有 A 的字符数是可变的。据我所知，PERL 不能进行可变长度的后视。

非常感谢您提供的任何帮助或指导！

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T00:39:06.353

你不只是想要

```
/A[^AC]*C/ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T00:03:01.113

据我所知，你想要：

*   一个“A”
*   后跟任意数量的非 A 字符
*   后跟一个“C”

这可以通过正则表达式来实现

`/A[B-Z]*?C/`

方括号`[]`中的字符代表一个字符类。使用字符类，您可以告诉正则表达式引擎只匹配几个字符中的一个。只需将要匹配的字符（或字符范围）放在方括号 ( [http://www.regular-expressions.info/charclass.html](http://www.regular-expressions.info/charclass.html) ) 之间。假设你想用另一个字母 Q 来做这个，你会有一个稍微不同的字符类

`/Q[A-PR-Z]*?C/`

如果您想修改它以适应 A 和 C 之间的空间，您可以通过两种不同的方式来处理它。你可以否定一个字符类，它会匹配除其中的字符之外的*任何字符，如下所示：*

`/A[^AC]*C/`

它将匹配一个 A，然后是除 A 和 C 之外的任意数量的字符，然后是一个 C。

或者，您可以在原始字符类中添加一个空格，如下所示：

`/A[B-Z ]*?C/`（注意Z后面的空格）

如果您想要任何类型的空格，请将空格替换为 \s，它表示任何空格，如下所示：

`/A[B-Z\s]*?C/`

# asp.net-mvc - ASP.NET MVC 图像上传仅将总字节数组的部分量保存到数据库

> ID：11320659
> 
> 赞同：1
> 
> 时间：2012-07-03T23:41:24.477
> 
> 标签：asp.net-mvc, file-upload

我使用此代码将图像上传到服务器并存储在数据库中：
认为数据库列是二进制（最大），当我上传一个文件并尝试从数据库中读取它时，只读取总字节数组的一部分（文件流) 被保存到数据库中。

```
 public virtual ActionResult CreateService(Service service, HttpPostedFileBase serviceImage )
    {
        if (ModelState.IsValid)
        {
            if (serviceImage != null)
            {
                var target = new MemoryStream();
                serviceImage.InputStream.CopyTo(target);
                service.Image = target.ToArray();
            }

            _serviceTask.AddNewItem(service); // Inserting new entity using NHibernate
        }
        return RedirectToAction("Index");
    } 
```

一切正常，但是当我尝试从数据库中检索它并将其显示给用户时，我得到的图像不完整。例如，用户上传了这张图片： ![上传的图片](../Images/b9fd26c5755f7903e198e0c535a9af8e.png) 但是当我检索它时，我得到![这个图片](../Images/b8865eb521a86c7c0afe9814f4fb917c.png)：
我已将数据库图像列设置为 varbinary(max) 我也尝试了图像数据类型。这是我的表单代码：

```
 @using (Html.BeginForm("CreateService", "Services", FormMethod.Post, new { @id = "dialogForm", @class = "mws-form", @enctype = "multipart/form-data" }))
    {
    <input type="file" name="serviceImage" />
     } 
```

我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T11:27:52.240

正如 Darin Dimitrov 所说，问题出在 DAL 中。假设您使用的是 NHibernate 3.2 和 SQL 2008，您必须检查数据库字段类型和 NHibernate 映射。必须将数据库字段类型设置为`Varbinary(MAX)`并且映射必须显式声明列长度。

就像以下（通过代码映射）：

```
 internal class ServiceOverride : IOverride
{
    public void Override(ModelMapper mapper)
    {
        mapper.Class<Service>(map =>
                                  {
                                      map.Property(x => x.Image,
                                                   status => status.Column(c =>
                                                   {
                                                       c.SqlType("VARBINARY(MAX)");
                                                       c.Length(int.MaxValue);
                                                   }));
                                  });
    }
} 
```

有关更多信息，请访问[二进制 Blob 截断为 8000 字节 - SQL Server 2008 / varbinary(max)](https://stackoverflow.com/questions/4584170/binary-blob-truncated-to-8000-bytes-sql-server-2008-varbinarymax)和[在数据库中存储图像会导致部分图像](https://stackoverflow.com/questions/5706829/storing-images-in-database-results-in-partial-image)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T00:41:34.067

也许你应该使用 GetBuffer()，它返回一个 byte[]

[http://msdn.microsoft.com/en-us/library/system.io.memorystream.getbuffer.aspx](http://msdn.microsoft.com/en-us/library/system.io.memorystream.getbuffer.aspx)

在备注中：请注意，缓冲区包含可能未使用的已分配字节。

ToArray 省略了这些字节。

# php - 如果服务器上没有安装 ZipArchive 类，则在 php 中使用它

> ID：11320662
> 
> 赞同：0
> 
> 时间：2012-07-03T23:42:06.917
> 
> 标签：php, ziparchive

我正在创建一个使用 ZipArchive 类的应用程序。问题是 - 当我将它发送给我的雇主时，他无法让它在他的服务器上工作。他收到以下错误：

`Fatal error: require_once(classes/ZipArchive.php) failed to open stream. No such file or directory in ...`

我可以只下载 ZipArchive.php 并将其放在那里，还是必须以其他方式安装它？另外，如果它是一个 linux 服务器 - 我需要 SSI 访问权限才能安装它或类似的东西吗？

提前致谢！

# c# - 使用 TFS api 执行（通过/失败）测试用例？

> ID：11320663
> 
> 赞同：4
> 
> 时间：2012-07-03T23:42:23.097
> 
> 标签：c#, tfs, microsoft-test-manager, testautomationfx

我目前正在开发一个程序以在程序中执行测试用例，并且我查看了[如何使用 Team Foundation Server API 创建测试运行和结果？](https://stackoverflow.com/questions/6505812/how-to-create-a-test-run-and-result-using-the-team-foundation-server-api)以及其他各种文章，但仍然遇到很多麻烦。我的目标是找到具有特定标题和配置的测试用例，执行它并在失败时添加注释。这只是我一直在搞乱的一些代码

```
 String server = "http://tfs.net:8080/tfs";
        String project = "Project";
        // Connect to the TeamFoundationServer.
        Console.Write("Connecting to Team Foundation Server {0}...\n", server);

        TfsTeamProjectCollection projectCollection = TfsTeamProjectCollectionFactory.GetTeamProjectCollection(new Uri(server));
        Console.WriteLine("Success!\n");
        Console.WriteLine("getting project {0}...\n", project);

        ITestManagementTeamProject teamProject = projectCollection.GetService<ITestManagementService>().GetTeamProject(project);

        Console.WriteLine("Success!\nGetting test cases...\n\n");
        IEnumerable<ITestCase> testCases = teamProject.TestCases.Query("SELECT [Title] FROM WorkItems WHERE State = 'Ready' AND Title CONTAINS 'Phase 1: test case title'");
        foreach (ITestCase t in testCases)
            Console.WriteLine(t.Title);
        ITestSuiteCollection suites = teamProject.TestSuites.Query("SELECT * FROM TestSuite");

        ITestConfigurationCollection configs = teamProject.TestConfigurations.Query("Select * FROM TestConfiguration WHERE Name='Mainline Android Phone 2.3'");
        ITestConfiguration config = configs[0];

        ITestPlan plan = teamProject.TestPlans.Create();
        plan.Name = "herpa derp";

        ITestSuiteBase suite = teamProject.TestSuites.Find(606);

        Console.WriteLine(plan.Name);
        Console.WriteLine(suite.Title);
        plan.RootSuite.Entries.Add(suite);//Object reference not set to an instance of an object.
        plan.Save();

        suite.TestCases.AddCases(testCases);
        plan.Save();

        ITestRun run = plan.CreateTestRun(false);

        ITestPointCollection points = plan.QueryTestPoints("SELECT * FROM TestPoint");
        foreach (ITestPoint p in points)
        {
            run.AddTestPoint(p, null);
        }
        run.Save();
        ITestCaseResult result = run.QueryResults()[0];
        result.Outcome = TestOutcome.Passed;
        result.Save();

        //wait dood
        Console.Read(); 
```

`plan.RootSuite.Entries.Add(suite);` 那是我得到错误“nullreferenceexception is unhandled”的那一行，它是套件，但对象看起来很好。如果你能帮忙，请告诉我:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T00:09:43.037

看起来您可能无法正确访问 teamProject 以查看将其传递给计划所需的所有字段。

# google-analytics - 将事件推送到多个配置文件

> ID：11320664
> 
> 赞同：1
> 
> 时间：2012-07-03T23:42:23.110
> 
> 标签：google-analytics

我们正在测试链接跟踪解决方案，目前希望将事件显示在两个不同的帐户上。我们有这样的设置：

```
var _gaq = _gaq || [];
  _gaq.push(
  ['_setAccount', 'UA-516606-1'],
  ['_trackPageview'],
  ['_setDomainName', 'du.edu'],
  ['b._setAccount', 'UA-516606-24'],
  ['b._trackPageview'],
  ['b._setDomainName', 'du.edu']
);
(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})(); 
```

[我们使用的是http://support.google.com/googleanalytics/bin/answer.py?hl=en&answer=55527](http://support.google.com/googleanalytics/bin/answer.py?hl=en&answer=55527)上的跟踪代码，但我不知道如何修改它以适用于多个帐户。此处的解决方案：[Google Analytics event tracking on Multiple accounts not working](https://stackoverflow.com/questions/9264348/google-analytics-event-tracking-on-multiple-accounts-not-working)因此不太有效。是否可以将 ab 帐户添加到 recordOutboundLink 函数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T03:16:06.910

您只需要使用不同的`recordOutboundLink`功能。

```
function recordOutboundLink(link, category, action) {
  _gaq.push(
    ['_trackEvent', category, action],
    ['b._trackEvent', category, action]
  );
  setTimeout('document.location = "' + link.href + '"', 100);
} 
```

然后在你的链接上

```
<a href="http://www.example.com" onClick="recordOutboundLink(this, 'Outbound Links', 'example.com');return false;"> 
```

# iphone - AFNetworking AFAmazonS3Client 上传问题

> ID：11320665
> 
> 赞同：0
> 
> 时间：2012-07-03T23:42:31.017
> 
> 标签：iphone, ios, afnetworking

我正在使用[Amazon S3 AFNetworking 客户端](https://github.com/AFNetworking/AFAmazonS3Client)尝试将文件上传到 S3，但遇到了麻烦。在模拟器中运行时收到错误的 URL 响应，在设备上运行时收到 405 响应。收到 405 响应时，日志表明 100% 的文件已上传。我不确定我是否正确。这是我的代码：

```
 AFAmazonS3Client *s3Client = [[AFAmazonS3Client alloc] initWithAccessKeyID:kAccessKeyID
                                                                        secret:kSecret];
    s3Client.bucket = kBucket;

    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString *documents = [paths objectAtIndex:0];
    NSString *path = [documents stringByAppendingPathComponent:@"test.jpeg"];

    [s3Client postObjectWithFile:path parameters:nil progress:^(NSInteger bytesWritten, long long totalBytesWritten, long long totalBytesExpectedToWrite) {
        NSLog(@"%f%% Uploaded", (totalBytesWritten / (totalBytesExpectedToWrite * 1.0f) * 100));
    } success:^(id responseObject) {
        NSLog(@"Upload Complete");
    } failure:^(NSError *error) {
        NSLog(@"Error: %@", error);
    }]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T02:55:41.097

只是猜测，但

```
AFAmazonS3Client *s3Client = [[AFAmazonS3Client alloc] initWithAccessKeyID:@"kAccessKeyID"
                                                                    secret:@"kSecret"]; 
```

kAccessKeyId / kSecret 是常量，是吗？通常，您将常量定义为

```
#define kAccessKeyId @"myKeyId" 
```

所以你不想在它们周围添加额外的引号。我真的很惊讶编译器允许它。你的线应该看起来更像

```
AFAmazonS3Client *s3Client = [[AFAmazonS3Client alloc] initWithAccessKeyID:kAccessKeyID
                                                                    secret:kSecret]; 
```

其他一些常规调试：

*   注销您尝试访问的路径并确保您有适当数量的斜杠。
*   405 错误通常表示您用于访问特定 URL 的方法无效。你真的可以发帖吗/你有发帖的权限吗？这又回到了我的观点，即您可能在不需要双引号时意外添加了双引号，因此无法正确访问您的 S3 存储。

# android - 在 LinearLayout 中添加 ImageView

> ID：11320667
> 
> 赞同：0
> 
> 时间：2012-07-03T23:42:36.133
> 
> 标签：android, android-layout, imageview

```
ImageView img = new ImageView(getBaseContext());
img.setImageDrawable(Drawable.createFromPath(new File (newBA,"/thumbanil.png").toString()));
LinearLayout Previews = (LinearLayout)findViewById(R.id.Previews);
Previews.addView(img); 
img.invalidate(); 
Previews.invalidate(); 
```

这个想法是从一个可绘制的，在一个线性布局内创建一个图像视图。

但它不起作用..代码有什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T00:03:34.977

您`thumbnail.png`的设备的根文件系统上有文件吗？我猜不是，因为那是一个只读文件系统。

如果您想知道 SD 卡的根目录或外部存储位置，可以调用[getExternalStorageDirector()](http://developer.android.com/reference/android/os/Environment.html#getExternalStorageDirectory%28%29)。如果要确保外部存储可用，可以使用[getExternalStorageState()](http://developer.android.com/reference/android/os/Environment.html#getExternalStorageState%28%29)。例如，

```
if (Environement.getExternalStorageState().equals(Enviroment.MEDIA_MOUNTED) {
  ImageView img = new ImageView(getBaseContext());
  img.setImageDrawable(Drawable.createFromPath(new File (newBA, Environment.getExternalStorageDirectory() + File.separator + "thumbanil.png").toString()));
  LinearLayout Previews = (LinearLayout)findViewById(R.id.Previews);
  Previews.addView(img); 
  img.invalidate(); 
  Previews.invalidate();
} 
```

# html - 响应式设计在 chrome/safari 和其他浏览器中根本不起作用？

> ID：11320668
> 
> 赞同：0
> 
> 时间：2012-07-03T23:42:39.473
> 
> 标签：html, css, wordpress, responsive-design

因此，响应式 css 在 IE / Firefox 中正确加载，但是当我放大 chrome 或 safari 时它不起作用。就像根本没有加载css一样。

网址是[http://teothemes.com/wp/](http://teothemes.com/wp/)

任何帮助表示赞赏，谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T09:00:01.860

Plus, it's not responsive, just adaptive. B-)

# iphone - 我应该如何在 iOS 中为 200 多张图像制作动画？

> ID：11320670
> 
> 赞同：4
> 
> 时间：2012-07-03T23:42:49.507
> 
> 标签：iphone, objective-c, ios, ipad, animation

我有超过 200 张图像我想在大约 10 秒的空间内制作动画。我尝试`animationImages`通过将图像加载到数组中然后调用该`startAnimating`方法来使用。这在模拟器中运行良好，但导致 iPad 崩溃。

我尝试`NStimer`每 1/25 秒调用一次，并在每次定时器触发时更改图像。这比以前的方法表现更好，它在模拟器中运行良好，但在 iPad 上的（滞后）动画结束时也崩溃了。

有人可以帮助我并告诉我解决这个问题的理想方法吗？谢谢。

原始代码：

```
- (void) humptyFallingAnim {

    NSString *filename;
    if (humptyImageCounter < 285) {
        filename = [NSString stringWithFormat:@"Humpty Animation HD1.2 png sequence/humpty_HD1.2_%d.png", humptyImageCounter];
            UIImage *someImage = [UIImage imageNamed:filename];
            humptyFalling.image = someImage;
            NSLog(@"loaded image: %d", humptyImageCounter);
        humptyImageCounter++;
    } else {
        NSLog(@"Timer invalidated");
        [humptyTimer invalidate];
        humptyTimer = nil;
    }

} 
```

编辑：一些对我不起作用的新代码

```
NSString *filename;
    if (humptyImageCounter < 285) {
        filename = [NSString stringWithFormat:@"Humpty Animation HD1.2 png sequence/humpty_HD1.2_%d.png", humptyImageCounter];
        @autoreleasepool {
            UIImage *someImage = [UIImage imageWithContentsOfFile:filename];
            humptyFalling.image = someImage;
            NSLog(@"loaded image: %d", humptyImageCounter);
        }
        humptyImageCounter++;
    } else {
        NSLog(@"Timer invalidated");
        [humptyTimer invalidate];
        humptyTimer = nil;
    } 
```

编辑2：

```
-(void) motionBegan:(UIEventSubtype)motion withEvent:(UIEvent *)event {
    NSLog(@"You shook it!");
    [self.view bringSubviewToFront:imgSnail];
    if (deviceHasBeenShaken == 0) {
        deviceHasBeenShaken = 1;
    }
    humptyTimer = [NSTimer scheduledTimerWithTimeInterval:(1/25) target:self selector:@selector(humptyFallingAnim) userInfo:nil repeats:YES];
    [self moveHumptyPosition];

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-03T23:48:07.550

不幸的是，这听起来像是 OpenGL ES 的工作。应用程序是游戏吗？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-03T23:50:12.540

内存管理 ：）。

```
NSString* somePath;
UIImageView *imageView;
for (i=0;i<200;i++) {
@autoreleasepool {
UIImage *someImage = [UIImage imageWithContentsOfFile:somePath];
imageView.image = someImage; //every time this line is executed, old reference disappears and previous UIImage is discarded
}
} 
```

我的意思是，您必须实现自动释放池并且不要使用 +(UIImage *) imageNamed: 方法，因为它会缓存图像。

**更新** 让我解释一下。您的问题与内存管理有关。您的应用程序必须有效地使用设备的内存，但您实际上没有。我不知道您的应用程序是如何工作的，但总体思路如上所示。 **更新 2**让我知道您是否使用 ARC。

**更新 3**对不起我奇怪的语言，但已经晚了。对不起 ：）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-04T00:27:10.980

尝试使用`CALayer`隐式动画。创建图层并循环设置它们的图像，如下所示：

```
NSMutableArray *allLayers = [NSMutableArray array];
for (int i = 0 ; i != 200 ; i++) {
    CGImageRef image = ...; // Get i-th image from an image source
    CALayer* sub = [CALayer layer];
    sub.contents = (__bridge id)image;
    sub.contentsRect = CGRectMake(...); // Create a rectangle based on the image size
    [self.layer addSublayer:sub];
    [allLayers addObject:sub];
} 
```

现在你可以通过设置它们的属性来隐式地为你的图层设置动画：

```
for (CALayer *sub in allLayers) {
    sub.position = CGMakePoint(...); // The position to which to move the image
} 
```

完成图层后，将它们从超级视图中删除：

```
for (CALayer *sub in allLayers) {
    [sub removeFromSuperlayer];
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-04T10:07:10.500

使用[cocos2d](http://www.cocos2d-iphone.org/)我的朋友。免得自己头疼。您所说的使用 OpenGLES 效率提高了一百倍。然而，OpenGL 并不复杂，cocos2d 在它之上提供了一个很好的抽象层，因此您只需几行代码就可以完成。

# asp.net - ASP.NET WebAPI RC 部署是否真的需要所有 ASP.NET MVC 4 RC 程序集？

> ID：11320681
> 
> 赞同：12
> 
> 时间：2012-07-03T23:45:12.687
> 
> 标签：asp.net, deployment, asp.net-mvc-4, asp.net-web-api

当我在 Visual Studio 2010 中创建“空 WebAPI”项目时，添加了几个支持 MVC 网页的新程序集作为参考（下面列表中的几个示例）：

*   System.Web.Razor.dll
*   System.Web.WebPages.Deployment.dll
*   System.Web.WebPages.dll
*   System.Web.WebPages.Razor.dll

为了简洁起见，我删除了那些我没有使用的 DLL 引用（或者我认为我没有“使用”）。部署到服务器时，我会得到如下异常：

> ```
> Exception message: Could not load file or assembly 'System.Web.Razor,Version=2.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35' or one of its dependencies. The system cannot find the file specified. 
> ```

我目前正在使用所有程序集将 bin 部署到服务器，直到 JIT 编译错误停止。

我了解 FileNotFoundException。我了解运行时正在尝试解析该引用。

**我的问题**：当您尝试创建的只是一个 WebAPI 站点时，为什么有必要携带 MVC Razor 程序集？是否还有其他需要删除的依赖项？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-07-04T05:09:55.593

不，您不需要所有这些程序集。

我总是喜欢*从头开始*构建我的 Web API 项目。我不使用模板。我只需创建一个空的 ASP.NET 项目并添加[Microsoft.AspNet.WebApi](http://nuget.org/packages/Microsoft.AspNet.WebApi) NuGet 包。

以下是似乎只需要的参考资料：

```
Microsoft.CSharp
Microsoft.Web.Infrastructure   // Microsoft.Web.Infrastructure NuGet package
Newtonsoft.Json                // Newtonsoft.Json NuGet package
System.Net.Http                // Microsoft.Net.Http NuGet package
System.Net.Http.Formatting     // Microsoft.AspNet.WebApi.Client NuGet package
System.Net.Http.WebRequest     // Microsoft.Net.Http NuGet package
System.Web.DynamicData
System.Web.Entity
System.Web.ApplicationServices
System.ComponentModel.DataAnnotations
System
System.Data
System.Core
System.Data.DataSetExtensions
System.Web.Extensions
System.Web.Http                // Microsoft.AspNet.WebApi.Core NuGet package
System.Web.Http.WebHost        // Microsoft.AspNet.WebApi.WebHost NuGet package
System.Xml.Linq
System.Drawing
System.Web
System.Xml
System.Configuration
System.Web.Services
System.EnterpriseServices 
```

# java - 在 Tegra 设备上使用 NV_depth_nonlinear 扩展

> ID：11320682
> 
> 赞同：0
> 
> 时间：2012-07-03T23:45:17.740
> 
> 标签：java, android, opengl-es-2.0, nvidia, tegra

有人成功使用过这个扩展吗？Khronos 规范可以在这里阅读：[NV_depth_nonlinear extension](http://www.khronos.org/registry/gles/extensions/NV/EGL_NV_depth_nonlinear.txt)

我已经通过 EGL 配置选择成功检查了扩展：

```
public class CustomEGLConfigChooser implements EGLConfigChooser {
    private static final int EGL_DEPTH_ENCODING_NV      = 0x30E2;
    private static final int EGL_DEPTH_ENCODING_NONLINEAR_NV = 0x30E3;
    private int[] mValue = new int[1];

    public EGLConfig chooseConfig(EGL10 egl, EGLDisplay display) {
        // request configs
        EGLConfig[] configs = egl.eglChooseConfig(...);
        // ...

        EGLConfig bestConfig = null;        
        for(EGLConfig config : configs){
            // check for EGL_DEPTH_ENCODING_NV
            egl.eglGetConfigAttrib(display, config, EGL_DEPTH_ENCODING_NV, 0);
            int hasDepthNonLinear = findConfigAttrib(egl, display, config, EGL_DEPTH_ENCODING_NV, 0);
            if(hasDepthNonLinear == EGL_DEPTH_ENCODING_NONLINEAR_NV) {
                // what to do now ???...
            }
        }
        return bestConfig;
    }

    private int findConfigAttrib (EGL10 egl, EGLDisplay display, EGLConfig config, int attribute, int defaultValue) {
        if (egl.eglGetConfigAttrib(display, config, attribute, mValue)) {
            return mValue[0];
        }
        return defaultValue;
    }
} 
```

但是如何使用非线性深度扩展？我必须使用：

```
glBindRenderbuffer(...);
glRenderbufferStorage(...); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T12:58:34.583

为了开始使用任何 GPU 的非线性 Z 缓冲区，您需要启用扩展（就像您在代码中所做的那样），仅此而已。

非线性 Z-Buffer 由 GPU 本身处理，而且我们经常没有意识到，它被大多数现代 GPU 使用。

正如这篇有趣的文章 (http://www.sjbaker.org/steve/omniv/love_your_z_buffer.html) 中所报道的：

> Z的决议。
> 
> 人们经常没有意识到的是，在几乎所有机器中，Z 缓冲区都是非线性的。Z 缓冲存储器中存储的实际数字与对象的 Z 坐标的关系如下：
> 
> z_buffer_value = (1<
> 
> 在哪里：
> 
> ```
>  N = number of bits of Z precision
>  a = zFar / ( zFar - zNear )
>  b = zFar * zNear / ( zNear - zFar )
>  z = distance from the eye to the object 
> ```
> 
> ...并且 z_buffer_value 是一个整数。
> 
> 这意味着 Z（以及因此 Z 的精度）与 z_buffer_value 的倒数成正比 - 因此在眼睛附近有很多精度，而在远处则有很少的精度。这种交互行为有些用处，因为您需要靠近眼睛的对象才能被渲染得非常详细——并且您需要更好的 Z 精度来处理详细对象。
> 
> 但是，这样做的一个不良后果是您的 Z 缓冲区的许多位都被浪费了——在接近剪辑平面的附近存储了非常精细的细节。如果您将近端剪辑拉近您的眼睛，那么将有更多的位用于渲染离您很近的事物，这会以相当大的成本降低精度。
> 
> 因此，在大多数情况下，可以通过将近剪辑平面远离您的眼睛来大大减少甚至消除闪烁。

以我的卑微经验，我已经成功地使用了 TEGRA 上的非线性 ZBuffer，正如我在此回复中所建议的那样，因此，我可以说它按所述工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-16T17:25:25.243

Testing on Nexus 7, I was able to get this to work by adding to the `eglChooseConfig` call:

```
EGL_DEPTH_ENCODING_NV, EGL_DEPTH_ENCODING_NONLINEAR_NV, 
```

and by using

`DEPTH_COMPONENT16_NONLINEAR_NV` in place of `GL_DEPTH_COMPONENT16` for our `glRenderbufferStorage` call.

**Edit:** Actually we don't use a depth buffer for our main egl surface, so only `GL_DEPTH_COMPONENT16_NONLINEAR_NV` was needed. Also changed `DEPTH_COMPONENT16_NONLINEAR_NV` to `GL_DEPTH_COMPONENT16_NONLINEAR_NV` as it's defined in the NDK .

# google-drive-api - 通过 google drive sdk v2 上传分段时出现 503 错误

> ID：11320683
> 
> 赞同：1
> 
> 时间：2012-07-03T23:45:29.553
> 
> 标签：google-drive-api

当我尝试通过 sdk v2 将多部分内容发布到谷歌驱动器时，出现 503 错误提示“服务不可用”。我得到了一个空的响应内容和一个如下的标题：

```
{'content-length': '0', 'x-google-cache-control': 'remote-fetch', 'expires': 'Fri, 01 Jan 1990 00:00:00 GMT', 'server': 'HTTP Upload Server Built on Jun 14 2012 02:12:09 (1339665129)', 'via': 'HTTP/1.1 GWA', 'pragma': 'no-cache', 'cache-control': 'no-cache, no-store, must-revalidate', 'date': 'Tue, 03 Jul 2012 23:12:09 GMT', 'content-type': 'text/html; charset=UTF-8'} 
```

这是我发布的内容：

```
POST /upload/drive/v2/files?uploadType=multipart

Authorization: Bearer <Access token>
Content-Length: <length>
Content-Type: multipart/related; boundary="<a base64 encoded guid>"

--<a base64 encoded guid>
Content-Type: application/json

{"title": "test.jpg", "mimeType":"image/jpeg", "parents":[]}
--<a base64 encoded guid>
Content-Type: image/jpeg
Content-Transfer-Encoding: base64

<base64 encoded binary data>
--<a base64 encoded guid>-- 
```

我做错什么了吗？我可以通过 POST 成功创建元数据，然后使用 uploadType=media 进行 PUT 更新，但我不想进行两次 API 调用。

任何的想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-03T23:48:53.807

可能不是。503 错误只是表示服务器停机以进行维修或其他原因。它对 503 错误的响应能力最低，但它基本上已经关闭。如果您想了解更多信息，请阅读以下内容：

```
http://www.checkupdown.com/status/E503.html 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T01:32:43.843

嗨，克里斯：这就是我正在做的......

```
url = 'https://www.googleapis.com/upload/drive/v2/files?uploadType=multipart'

boundary = base64.b64encode(uuid.uuid4().bytes)
parts = []
parts.append('--' + boundary)
parts.append('Content-Type: application/json')
parts.append('')
parts.append(json.dumps({
    'title': name,
    'mimeType': 'image/jpeg',
    'parents': [{
        'kind': 'drive#file',
        'id': folderId
        }] if folderId else []
    }))
parts.append('--' + boundary)
parts.append('Content-Type: image/jpeg')
parts.append('Content-Transfer-Encoding: base64')
parts.append('')
parts.append(base64.b64encode(content))
parts.append('--' + boundary + '--')
parts.append('')
body = '\r\n'.join(parts)

headers = {
    'Content-Type': 'multipart/related; boundary="%s"' % boundary,
    'Content-Length': str(len(body)),
    'Authorization': 'Bearer %s' % access_token
    }
response = urlfetch.fetch(url, payload=body, method='POST', headers=headers)
assert response.status_code == 200, '%s - %s' % (response.status_code, response.content)
r = json.loads(response.content) 
```

# android - 如何在 Android 中实现“发送反馈”功能？

> ID：11320685
> 
> 赞同：33
> 
> 时间：2012-07-03T23:45:53.743
> 
> 标签：android

![在此处输入图像描述](../Images/5f7bdf6f79aa28293718ddfaff8bb9c7.png)我希望它的行为就像您单击 Google+ Android 应用程序中的菜单项时的“发送反馈”行为一样。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-07-04T00:28:34.490

我不确定这个应用程序在“发送反馈”中的表现如何。你能给我解释一下，这样我就不用下载应用程序了吗？

由于我不知道它是什么样子，我只是猜测一下，并为您提供一种让用户发送反馈的方法：

```
@Override
public boolean onCreateOptionsMenu(Menu menu){
    super.onCreateOptionsMenu(menu);
    MenuInflater hardwaremenu = getMenuInflater();
    hardwaremenu.inflate(R.menu.main_menu, menu);
    return true;
}

@Override
public boolean onOptionsItemSelected(MenuItem item){
    switch (item.getItemId()){
    case R.id.sendEmail:
        Intent Email = new Intent(Intent.ACTION_SEND);
        Email.setType("text/email");
        Email.putExtra(Intent.EXTRA_EMAIL, new String[] { "admin@hotmail.com" });
        Email.putExtra(Intent.EXTRA_SUBJECT, "Feedback");
        Email.putExtra(Intent.EXTRA_TEXT, "Dear ...," + "");
        startActivity(Intent.createChooser(Email, "Send Feedback:"));
        return true;
    }
} 
```

要么将其合并到现有菜单中，要么简单地将其添加到要显示菜单的 Activity 底部。

我希望这有帮助！

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-08-03T09:26:42.230

如果您真的想捕获任何未处理的异常并将它们作为错误报告提交到您自己的站点或 Google 文档电子表格，您应该看看 ACRA ( [https://github.com/ACRA/acra/](https://github.com/ACRA/acra/) )。它可以选择在向您发送错误报告之前询问用户的书面反馈。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-22T22:20:33.097

免责声明：这是我自己的项目

我目前正在研究这个：[http](http://www.android-feedback.com) ://www.android-feedback.com ，我认为，这就是你要找的。如果您想参与测试，只需在表格上留下您的电子邮件地址。

# python - 使用 lxml.html 抓取嵌入元素，或者如何欺骗网站认为您安装了 Flash

> ID：11320687
> 
> 赞同：0
> 
> 时间：2012-07-03T23:46:04.070
> 
> 标签：python, screen-scraping, web-scraping, lxml

我正在尝试抓取一个网站，我需要获取一个嵌入元素，但是因为我使用的是 Python 和 lxml.html，所以该网站准确地断定我没有安装 Flash，而不是向我展示嵌入元素，它给我看这个：

```
<div>
    <font>
        <u>
            <b>
                <a href="http://get.adobe.com/flashplayer/">
                ATTENTION:<br>This video will not play. You currently do not have Adobe Flash installed on this computer. Please click here to download it (it's free!)
                </a>
            </b>
        </u>
    </font>
</div> 
```

显然这是一个问题，所以我想知道是否有可能为了检索正确的元素而欺骗浏览器认为你安装了 Flash，即使你没有安装？

我希望有人能帮帮忙！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T00:23:13.570

我相信以下博客文章很好地回答了您的问题。作者也有同样的需求，使用 Python 抓取 Flash 内容。同样的问题出现了。他意识到他只需要实例化一个浏览器（即使只是一个甚至不显示在屏幕上的内存中的浏览器），然后抓取它的输出。我认为这可能是满足您需要的成功方法，并且他使您易于理解。

[http://blog.motane.lu/2009/06/18/pywebkitgtk-execute-javascript-from-python/](http://blog.motane.lu/2009/06/18/pywebkitgtk-execute-javascript-from-python/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T00:26:38.593

要获取 JavaScript 生成的内容，您还可以尝试 Selenium，[例如](https://stackoverflow.com/a/7957176/4279)。

# php - CakePHP 验证规则：带空格的字母数字

> ID：11320691
> 
> 赞同：3
> 
> 时间：2012-07-03T23:47:03.843
> 
> 标签：php, validation, cakephp, alphanumeric

我的数据库中有一个`description`字段，它接受字母数字字符和空格，以及换行符。我想在我的`Server`模型中设置该验证规则。

这是我现在拥有的：

```
<?php

class Server extends AppModel {

    public $validate = array(
        // ...
        'description' => array(
            'characters' => array(
                'rule'     => 'alphaNumeric',
                'message'  => 'Alphanumeric characters only'
            )
        ),
        // ...
    );

} 
```

如何修改它以允许空格和换行以及字母数字字符？我认为 Cake 会有一个内置的验证规则，但我看不到。我需要自己编写并使用一些正则表达式吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-09-20T06:05:29.733

CakePHP 中的 alphaNumeric 表示没有空格的字母数字字符。因此，您必须使用自己的正则表达式模式。

例子：

```
'description' => array(
    'characters' => array(
        'rule' => array('custom', '/^[a-z0-9 ]*$/i'),
        'message'  => 'Alphanumeric characters with spaces only'
    )
), 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T01:40:14.157

不，CakePHP 不能涵盖所有情况，而您的情况也不是那么常见。

请参阅[http://api20.cakephp.org/view_source/validation#l-73](http://api20.cakephp.org/view_source/validation#l-73)它只是字符和整数。

利用

```
'rule'     => array('custom', 'your-regex-here'), 
```

应该很容易找到符合您需要的正则表达式，或者从验证类中复制和修改正则表达式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-10-12T19:25:30.920

如果您查看 lib/cake/utility/validation.php 中的 alphaNumeric 函数，您将拥有：

```
/^[\p{Ll}\p{Lm}\p{Lo}\p{Lt}\p{Lu}\p{Nd}]+$/Du 
```

这匹配字母数字 unicode 字母和数字，如Владимир（俄罗斯）、김정（韩国）、习近平（中国）等...

所以我用默认的 CakePhp 和 O'Brian、François、Mary-Louise、Juan Martin 等名字制作了我的自定义字母数字模式...

```
/^(?![\s'-])(?:[\s'-]{0,1}[\p{Ll}\p{Lm}\p{Lo}\p{Lt}\p{Lu}\p{Nd}])+$/Du 
```

现在它匹配带有**'**、**-**和空格的名称。但如果它们是连续的，则不是在第一个或最后一个位置（因为我认为这不可能存在^^）

希望这会对某人有所帮助:)

编辑：但是有时它不接受一些重音的非拉丁字符，例如西里尔语 и́ 这实际上是两个字符 и 和 ́ 。́ 属于 Mark, Nonspacing Mn 的 unicode 类别（并且 Mn 不在此正则表达式模式中）。这种异常在亚洲语言（中文、韩文、印地文……）中并不罕见，因为那里充满了 Mn unicode 字符。

FD

# javascript - javascript在双击时启用输入

> ID：11320692
> 
> 赞同：10
> 
> 时间：2012-07-03T23:47:14.803
> 
> 标签：javascript, html, forms

我有一个禁用了一些输入的表单。我希望双击时启用这些输入。不幸的是，JS 事件似乎不会在禁用输入时触发。

```
<input type="text" value="asdf" disabled="disabled" ondblclick="this.disabled=false;">​ 
```

有没有办法绕过这个限制？

还是我只需要将任何受影响的输入包装在一个跨度中以容纳该事件？

[http://jsfiddle.net/vhktx/](http://jsfiddle.net/vhktx/)

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-07-03T23:54:59.247

`ondblclick`不会在`disabled`元素上触发，您应该将其标记为`readonly`：

```
<input type="text" value="asdf" readonly="true" ondblclick="this.readOnly='';"> 
```

[http://jsfiddle.net/vhktx/4/](http://jsfiddle.net/vhktx/4/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-03T23:50:15.567

您必须将元素包装在容器中，因为该事件不会在禁用的元素上触发。

[jsFiddle](http://jsfiddle.net/SsYFd/)

```
<div ondblclick="document.getElementById('test').disabled=false;">
    <input type="text" id="test" value="asdf" disabled="disabled"></div> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-08-21T13:53:45.627

标记为正确的答案不会将输入恢复为需要再次双击以再次编辑。

为此添加此 onchange 函数：onchange="this.readOnly='true';"

整个事情： onchange="this.readOnly='true';" readonly="true" ondblclick="this.readOnly='';"

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2021-05-01T06:02:48.570

这会做！对我有用，因为“禁用”和“只读”看起来几乎相同（至少在引导程序中）。内联脚本不适用于禁用的属性。

```
<input type="text" ondblclick="this.readOnly=false;" readonly/> 
```

# vhdl - 如何使用块 RAM 进行读写？

> ID：11320697
> 
> 赞同：0
> 
> 时间：2012-07-03T23:47:55.210
> 
> 标签：vhdl, fpga, xilinx, hdl, spartan

如何在 spartan 3 中使用 block ram 读写？

我在 sim.pdf 中阅读了 xilinix 的手册，每次写入都需要一个时钟周期，并且每次读取也需要一个时钟周期，因为 BRAM 是同步的。我们是否应该让有限状态机释放 ram 的每个写入和读取操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T05:45:35.030

您可以将其用作`dual-port RAM`，因此您可以在一个周期内从不同地址读取写入。看看[xapp463](http://www.xilinx.com/support/documentation/application_notes/xapp463.pdf)。

# slideshow - 自定义 Pandoc 的 Slidy CSS？

> ID：11320701
> 
> 赞同：11
> 
> 时间：2012-07-03T23:48:15.207
> 
> 标签：slideshow, pandoc

我正在使用神奇的 Pandoc 从 Markdown 转换为 Slidy 幻灯片格式。我想编辑 Slidy CSS，但我一生都无法弄清楚 CSS 文件在哪里被使用。我在这里和那里找到了一堆 slidy.css 文件并尝试修改它们，但 Pandoc 的 Slidy 输出从未改变。

有谁知道 slidy.css 在 OSX 上默认在哪里？谢谢！

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-07-04T01:18:54.180

默认情况下 pandoc 使用来自 slidy 网站的 CSS 和 javascript 文件。如果您想使用本地版本，请创建一个目录，例如`myslidy`，包含子目录`scripts`和`styles`. 放入并放入。`slidy.js.gz`_ 然后使用以下选项调用 pandoc：`scripts``slidy.css``styles`

```
pandoc -s -t slidy -V slidy-url=myslidy 
```

Pandoc 然后将链接到您的本地 CSS 文件。如果您想将所有这些都包含在 HTML 文件本身中，因此它不依赖于外部 myslidy 目录，然后添加选项`--self-contained`.

另一种选择是继续使用来自 slidy 网站的 slidy 脚本，但替换您自己的 CSS 文件。为此，您必须创建一个具有不同样式表链接的自定义滑动模板。要获取您自己的默认模板副本，请执行

```
pandoc -D slidy > my.slidy 
```

编辑此文件中的 CSS 链接，并调用 pandoc

```
pandoc -s -t slidy --template my.slidy 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-10-18T09:52:47.370

用 . 指定其他 css 文件`pandoc -t slidy --css my.css ...`。这不需要修改 pandoc 的默认滑动模板。

（这是在 John MacFarlane 之前的评论中。我只是将其发布为更高知名度的答案。）

# django - 从 django.db.models.fields.related 导入 RelatedManager

> ID：11320702
> 
> 赞同：11
> 
> 时间：2012-07-03T23:48:21.293
> 
> 标签：django, django-managers

我正在尝试这样做：

```
from django.db.models.fields.related import RelatedManager 
```

因为我希望能够测试一个对象是否是相关的管理器，即：

```
isinstance(obj, RelatedManager) 
```

但是我不断收到此错误：错误：无法导入名称相关管理器

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-04T00:18:57.723

相关的管理器类是在运行时在 django.db.models.fields.related 的生成器函数中创建的，因此您不能直接导入它们。如果要检查对象是否是特定关系的相关管理器，可以使用`isinstance(obj, MyModel.my_relation.__class__)`. 您还可以使用`hasattr`来确定对象是否具有您需要的属性（ducktyping）并完全避免使用 isinstance。

# django - Django - 在启动时配置数据库

> ID：11320705
> 
> 赞同：-1
> 
> 时间：2012-07-03T23:48:28.187
> 
> 标签：django, security

出于安全原因，我不想将所有数据库信息以明文形式存储在 settings.py 中。我想在 Django 服务器启动时将信息加载到内存中（即 - 设置 DATABASE 设置变量）。

我怎样才能做到这一点？

编辑：我认为这里有一个误解。这个想法是划分安全性。如果攻击者成功访问了 django 机器，我不希望他们能够访问数据库（在不同的机器上）。这并非不合理。显然，当机器重新启动时，必须重新输入信息——但这就是完全划分的成本。使用这种方法，入侵 django 服务器机器不会影响数据的安全性。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-07-04T06:34:45.813

You can move the database settings to another file but what do you gain? The details would need to be stored somewhere: the server can't load the details into memory and then delete the file from which it read the details because then it won't be able to connect to the database the next time it restarts.

It would also needlessly complicate your system because your system has already been compromised when someone can read the source. You should worry more about that than moving all passwords (and similar details, such as API keys) into special files elsewhere.

# jquery - 将数据从自动完成传递到动态隐藏 ID

> ID：11320706
> 
> 赞同：1
> 
> 时间：2012-07-03T23:48:33.463
> 
> 标签：jquery, hidden, html-input

所以我有这个

```
 $('input[name^="numEmp"]').autocomplete({source: Empleados,select: function(event, ui){
    $(this).val(ui.item.label);
    $('#nomDetEmp').val(ui.item.value);     
    return false;
    }
    }); 
```

我创建这样的动态输入

```
 $(".Nuevo").on("click", function() {

   $(".readdireccion:first").clone().insertAfter(".readdireccion:last").find('input[name^="numEmp"],input[name^="servicioNom"],input[name^="numCta"],input[name^="cantidad"],').val("");

   $('input[name^="numEmp"]').autocomplete({source: Empleados,select: function(event, ui){

   $(this).val(ui.item.label);
   return false; 
```

html是这样的

```
<div class="readdireccion">
<div class="input_quitapon">

<a class="Eliminar">Erase</a>

        <div class="input_element">
            <div class="input_label">Numero Empleado</div>
            <div class="input_value">
                <input type="text" name="numEmp[]" class="emp" maxlength="10" size="12" value=""/>
                <input type="hidden" name="nomDetEmp[]" id="nomDetEmp" class="emp" maxlength="10" size="12" value=""/>
            </div>
        </div> 
```

现在我的问题是我分配了字段 numEmp[] 并且它们没有 ID，因为它仅用于用户视图，但隐藏的字段存储发送到数据库的信息。我该如何分配它们？我对代码的问题是它只保存到第一个隐藏字段而不是新字段。

# php - 从 Twitter 获取用户详细信息

> ID：11320713
> 
> 赞同：1
> 
> 时间：2012-07-03T23:50:31.187
> 
> 标签：php, javascript, twitter, twitter-oauth

我正在使用 php 和 JavaScript 创建一个 Web 应用程序，它将从 twitter 获取用户的详细信息。我已尝试阅读[https://dev.twitter.com/docs/api/1/get/users/show](https://dev.twitter.com/docs/api/1/get/users/show)上的文档，但无法理解任何内容。我发现关于这个主题的相关文档很少。我需要查看教程的示例代码。有想法的人吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-03T23:57:20.477

以我的 Twitter 帐户为例。我的网名是`charliekilian`。因此，如果您访问此 URL：

[https://api.twitter.com/1/users/show.json?screen_name=charliekilian&include_entities=true](https://api.twitter.com/1/users/show.json?screen_name=charliekilian&include_entities=true)

你会得到一个关于我的账户的 JSON 实体。换句话说，您通过 HTTP GET 发出请求，它会响应一个结构化为 JSON 对象的文档，您可以解析该对象以找出数据。

如果您想要其他用户的数据，请将 URL 中我的用户名部分替换为您要查找的用户名。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T00:30:05.143

我处理这个问题的方法是使用：

```
$username = ''; // Twitter Username
$page_data = file_get_contents("https://api.twitter.com/1/users/show.json?include_entities=true&screen_name=$username"); 
```

然后搜索`$page_data`您想要的特定详细信息，`preg_match()`用于匹配您要查找的数据的正则表达式模式。

我也发现了这个，它是相同的，但没有正则表达式。

[http://tareq.wedevs.com/2009/05/playing-with-twitter-json-using-php/](http://tareq.wedevs.com/2009/05/playing-with-twitter-json-using-php/)

# objective-c - 简单的正则表达式消除 3 点后的任何内容

> ID：11320714
> 
> 赞同：0
> 
> 时间：2012-07-03T23:50:38.907
> 
> 标签：objective-c, ios5, ios4

我正在尝试创建一个简单的正则表达式，它将删除文本块中三个点之后的任何内容。不知道我应该使用什么符号，因为第一部分将不止字母和数字

例如，如果我通过

**任何东西都可以在三个点之前进行 $ NC >> ... 这应该被淘汰 d& < >**

我应该得到

**任何东西都可以在三个点之前进行 $ NC >>**

我有以下

（[不知道这里发生了什么]）...（[这里的任何东西]）替换为：$ 1

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T00:01:43.633

您没有说出您尝试过的内容或正在使用的 RE 语法，因此这对您来说可能不正确，但想法是：

```
^\(.*\)\.\.\..*$ 
```

分解：

```
^ - start of line
.* - zero or more of anything
\(.*\) - the above tagged
\.\.\. - three dots, escaped to match a literal dot
.*$ - anything else till end of line 
```

正如我所说，您的语法可能与此不完全相同，但关键是您可能需要转义三个点以使它们成为文字，因为大多数 RE 使用点作为特殊字符。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T00:05:26.460

点代表任何字符。0+ 次重复的星号。So`.*`代表任意长度的（可选）字符串。要搜索点，您必须避开它们。

此表达式将搜索后跟 3 个点的任何内容：`.*\.\.\.`

在末尾添加可选字符串：`.*\.\.\..*`

然后附上您感兴趣的部分：`(.*)\.\.\..*`并替换为`$1`. 据我所知，在 Cocoa 中你不必逃避括号，但我不是 100% 确定。

如果您正在处理文本行，您可能还想在表达式中添加`^`前缀和`$`后缀。

未经测试的建议：

```
NSRegularExpression *regex = [NSRegularExpression regularExpressionWithPattern:@".*\.\.\..*" options:nil error:&error];
[regex replaceMatchesInString:myString options:nil range:range withTemplate:@"$1"]; 
```

# ruby-on-rails - 当表格以's'结尾时如何通过表格关系检索项目（即Wbs）

> ID：11320717
> 
> 赞同：0
> 
> 时间：2012-07-03T23:50:58.643
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我有一张名为“Wbs”的表。我已经生成了从命令行执行时可以正常工作的控制器。

例子：

> Wbs
> 
> Wbs(id: integer, description: string, project_id: integer, wbs_no: string, published: boolean, created_at: datetime, updated_at: datetime))

问题是当我尝试返回给定项目的所有 Wbs 对象时。Rails 从 wbs 中删除 's' 并尝试调用一个名为“Project::Wb”而不是“Project::Wbs”的方法。

例子：

> 项目.first.wbs
> 
> 项目加载 (0.4ms) SELECT "projects".* FROM "projects" LIMIT 1 NameError: uninitialized constant Project::Wb

我确实在各自的模型中设置了belong_to 和has_many。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T15:41:03.287

我认为，您应该告诉 Rails 您的模型名称与预期的不同。你可以这样做：

```
has_many :wbs, :class_name => "Wbs" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T16:19:04.427

您可以指定 "wbs" 是*不可数*的。补充`config/initalizers/inflections.rb`：

```
ActiveSupport::Inflector.inflections do |inflect|
  inflect.uncountable "wbs"
end 
```

之后您必须重新启动服务器/控制台。

# php - F1 键进入我的支持页面？

> ID：11320718
> 
> 赞同：0
> 
> 时间：2012-07-03T23:50:59.297
> 
> 标签：php, javascript, hyperlink

> **可能重复：**
> [使用 JavaScript 和 jQuery、跨浏览器处理按键事件 (F1-F12)](https://stackoverflow.com/questions/424407/handling-key-press-events-f1-f12-using-javascript-and-jquery-cross-browser)

如何获取我的 javascript 代码并将其转到我的支持文档？

```
key['/'] = "support.php";   

function getKey(keyStroke) {
isNetscape=(document.layers);
eventChooser = (isNetscape) ? keyStroke.which : event.keyCode;
which = String.fromCharCode(eventChooser).toLowerCase();
for (var i in key) if (which == i) window.location = key[i];
}
document.onkeypress = getKey; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-03T23:53:09.170

正如您将在这个[类似的问题](https://stackoverflow.com/questions/1473496/overriding-the-f1-key-in-ff-chrome-ie-is-f1-on-ie8-chrome-on-keyup-and-in-ff)中看到的那样，几乎不可能实现您希望跨浏览器的行为。您应该改用其他键盘快捷键。

# eclipse - 如何让 Eclipse 从不同的镜像下载新软件？

> ID：11320722
> 
> 赞同：0
> 
> 时间：2012-07-03T23:51:17.140
> 
> 标签：eclipse

我想安装 C/C++ 开发工具，但镜像 Eclipse 试图将其从挂起中拉出来。我怎样才能强迫它尝试另一个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T01:04:36.187

尝试从这里下载 C/C++ 开发工具的存档存储库，只需一个 zip 文件：[下载 cdt-master-8.1.0.zip 存储库](http://www.eclipse.org/downloads/download.php?file=/tools/cdt/releases/juno/r/cdt-master-8.1.0.zip) 在页面上，您可以选择适当的镜像。然后在您的本地 Eclipse（原版安装）中转到帮助 > 安装软件... > 添加... > 使用存档选项并指向下载的 zip 文件。

# ruby-on-rails - has_many :autosave => true 保存孩子时跳过验证

> ID：11320723
> 
> 赞同：5
> 
> 时间：2012-07-03T23:51:48.063
> 
> 标签：ruby-on-rails, ruby-on-rails-3

在 Rails 2 和 Rails 3 中，如果 :autosave => true 是一个 has_many 关联，则循环遍历集合并在每个子关联上调用 save(:validate => false)。这是为什么？我们需要一个 before_validation 回调来为该子对象运行，但它不会因为它是跳过验证的保存。

有什么好办法解决这个问题？跳过验证的目的是什么？

任何帮助将非常感激！谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-13T16:07:22.610

验证**确实**会运行。有一个验证阶段和一个保存阶段。AutoSave 尝试同时为两个模型执行这两个阶段。因此，在保存父模型时，验证父模型，然后验证它的自动保存子模型。验证通过后，会发生保存阶段，即保存父模型并保存子模型（但跳过验证）。原因是验证已经运行。

当我在 before_save 回调期间尝试在父级内部构建子模型时遇到了问题。因此，在验证阶段不会验证关联的对象。

# html - Perl Module HTML::Template 是否可以使用除此之外的其他语法 ?

> ID：11320725
> 
> 赞同：3
> 
> 时间：2012-07-03T23:52:05.160
> 
> 标签：html, perl, templates

我正在尝试使用该`Perl`模块`HTML::Template`，根据文档，它说您可以`HTML`在其标记周围使用注释而不是大于/小于，但它对我不起作用。

来自 HTML::Template 的 perldoc

> 如果您对有效的 HTML 很狂热，并且希望您的模板符合有效的 HTML 语法，您可以选择以 HTML 注释的形式键入模板标签。这可能对希望在处理 HTML::Template 之前验证其模板的 HTML 语法或使用 DTD 精通编辑工具的 HTML 作者有用。
> 
> ```
>  <!-- TMPL_VAR NAME=PARAM1 --> 
> ```

当我尝试这个时，我在我的 apache 日志中收到这些消息：

> [2012 年 7 月 3 日星期二 19:24:23] [错误] [client ::1] HTML::Template : 尝试设置不存在的参数 'fname' - 此参数名称与模板文件中的任何声明都不匹配: (die_on_bad_params => 1) 在 /var/www/cgi-bin/form.cgi 第 90 行，引用者：....getcontactinfo.html

将选项设置`die_on_bad_params => 0`为`HTML::Template->new`方法似乎允许模板名称的注释格式起作用，任何人都可以确认这是完成此操作的正确方法吗？

**编辑#1**

以下是一些实际代码：

**从我的 .html 模板文件**

```
<tbody>
<tr>             <td>First Name:         </td>  <td><!-- TMPL_VAR NAME=FNAME -->           </td> </tr>
<tr>             <td>Name:               </td>  <td><!-- TMPL_VAR NAME=NAME -->           </td> </tr>
<tr class="alt"> <td>Email:              </td>  <td><!-- TMPL_VAR NAME=EMAIL -->          </td> </tr>
<tr>             <td>Affiliation:        </td>  <td><!-- TMPL_VAR NAME=AFFILIATION -->    </td> </tr> 
```

**从我的 .cgi 脚本**

```
my $template = HTML::Template->new(filename => '/var/www/html/acknowledge.html', die_on_bad_params => 0);
$template->param(FNAME          => $firstName);
$template->param(NAME           => $firstName . " " . $lastName);
$template->param(EMAIL          => $email);
$template->param(AFFILIATION    => $affiliation); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T00:36:06.883

到目前为止，我发现的唯一两种方法如下：

1 - HTML::Template 有一个名为 vanguard_compatibility_mode 的开关...来自 perldocs

> vanguard_compatibility_mode - 如果设置为 1，模块将期望看到除了标准语法之外看起来像 %NAME% 的 s。还设置 die_on_bad_params => 0。如果您不在 Vanguard Media 尝试使用旧格式模板，请不要担心这个。默认为 0。

2 - HTML::Template 还支持在注释块中嵌入模板标签，以便您的代码与 HTML 兼容，如下所示：`<!-- TMPL_NAME NAME=FNAME -->`

再次来自 perldocs：

> 如果您对有效的 HTML 很狂热，并且希望您的模板符合有效的 HTML 语法，您可以选择以 HTML 注释的形式键入模板标签。这可能对希望在处理 HTML::Template 之前验证其模板的 HTML 语法或使用 DTD 精通编辑工具的 HTML 作者有用。
> 
> `<!-- TMPL_VAR NAME=PARAM1 -->`

This 2nd option didn't work originally for me until I set the `die_on_bad_params => 0` for the constructor.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T10:28:33.767

I don't see a paramater named "fname" anywhere in your code, so I don't understand the error message. Maybe the code you posted is not the complete code?

Regarding die_on_bad_params: Yes, setting it to 0 is the way to solve this, and I personally always set it to 0 and have never understood why one would need this option anyway. In my HTML::Template::Compiled (similar alternative to HTML::Template) module I have never implemented it.

# php - PHP 字符串文字

> ID：11320728
> 
> 赞同：0
> 
> 时间：2012-07-03T23:52:41.483
> 
> 标签：php, string, concatenation, literals

我正在尝试在 PHP 中创建一个如下所示的字符串：

```
<xsl:sort select="TITLE"/> 
```

我尝试了很多不同的方法来创建它并像那样回显它，并且遇到了错误。到目前为止，我让变量 $myvar 保存了值 TITLE，并使用在它周围添加了引号

`$myvar="\"". $myvar . "\"";`这样 $myvar 现在看起来像这样`"TITLE"`

但试图连接其余的给我带来了问题。它似乎不喜欢 <。如果我把它放在引号中，我可以将它作为变量回显，但是如果我尝试将它连接到任何其他字符串，它就会消失。

任何想法如何使用 $myvar 变量将第一个字符串存储到变量中？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-03T23:54:24.583

```
$foobar = 'TITLE';
echo '<xsl:sort select="' . $foobar. '" />'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T00:05:03.493

```
echo '<xsl:sort select="' . $myvar . '"/>'; 
```

# facebook - facebook android应用程序集成问题

> ID：11320733
> 
> 赞同：0
> 
> 时间：2012-07-03T23:53:16.360
> 
> 标签：facebook

我正在使用 android 应用程序将图像发布到 facebook。在 facebook 页面上，在发布的图片上方会出现一个带有我的应用程序名称的链接。如何在此链接中添加 url？现在，如果我们单击此链接，它会显示页面不可用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T10:42:59.647

在您的应用设置中设置网站或画布页面 URL。

# sql-server - 尝试在临时表中插入记录时出现问题

> ID：11320736
> 
> 赞同：0
> 
> 时间：2012-07-03T23:53:31.187
> 
> 标签：sql-server, sql-server-2008

我在尝试在临时表中插入记录时遇到问题

我有一个临时表`#TmpCapacityTable`

```
CapacityDate    InstallerCode   WorkAreadID FoxtelCodeID    value
2/8/12      BAW     7       1510        3
2/8/12      BAW     7       1508        3 
```

第二个临时表`#TmpAdjustmentTable`

```
CapacityDate    InstallerCode   WorkAreadID fFoxtelCodeID   value
2/8/12      BAW     7       1510        1
2/8/12      BAW     7       1508        1
2/8/12      BAW     7       1509        1 
```

我需要插入`#TmpCapacityTable`那些不在但有的行中`#TmpAdjustmentTable`，在示例中只有代码 1509

我正在使用

```
Insert into #TmpCapacityTable
select * from #TmpAdjustmentTable 
    where #TmpAdjustmentTable.CapacityDate not in (select #TmpCapacityTable.CapacityDate from #TmpCapacityTable)  
    and   #TmpAdjustmentTable.WorkAreadID not in (select #TmpCapacityTable.WorkAreadID from #TmpCapacityTable)
    and   #TmpAdjustmentTable.InstallerCode not in (select #TmpCapacityTable.InstallerCode from #TmpCapacityTable)
    and   #TmpAdjustmentTable.FoxtelCodeID not in (select #TmpCapacityTable.FoxtelCodeID from #TmpCapacityTable) 
```

但它不起作用，我看不出问题出在哪里

有人可以帮我拜托！！！

提前致谢

埃利亚纳

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T00:00:54.943

```
INSERT INTO TmpCapacityTable(CapacityDate, InstallerCode, WorkAreaID, FoxtelCodeID, value)
    SELECT  ta.CapacityDate, ta.InstallerCode, ta.WorkAreaID, ta.FoxtelCodeID, ta.value
      FROM  #TmpAdjustmentTable ta
            LEFT OUTER JOIN #TmpCapacityTable tc
                ON  ta.CapacityDate     = tc.CapacityDate
                AND ta.InstallerCode    = tc.InstallerCode
                AND ta.FoxtelCodeID     = tc.FoxtelCodeID 
     WHERE  tc.value IS NULL 
```

# iphone - 进入前台时iPhone屏幕移动

> ID：11320744
> 
> 赞同：1
> 
> 时间：2012-07-03T23:54:48.593
> 
> 标签：iphone, ios, ipad

我注意到，当我的 iPhone 应用程序在 iPad2（iOS 版本 4.3.3）上暂停后进入前台时，iPhone 屏幕似乎在一瞬间向上移动了一小部分。我的理解是，iOS 在暂停应用程序之前会拍摄屏幕快照，因此它可以在恢复时快速恢复，但我不清楚它为什么会被转移。状态栏占位符和 iPhone 图像不会上移，只有 iPhone 屏幕的其余部分会上移。我在 5.0 模拟器中没有看到这个问题。

任何想法发生了什么或如何解决这个问题？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T00:35:14.703

当应用程序加载时，它会显示您在应用程序包中拥有的 default.png 文件。如果此图像与您的应用程序的第一个屏幕相同（苹果建议您应该这样做），那么它将显示此图像，然后在应用程序完成初始化后显示实际屏幕。您可以通过向上移动一两个像素来编辑 png 文件（您只需猜测并检查以查看您需要的确切内容）。

另一种可能性是您的 default.png 大小不正确，因此在应用程序实际启动时正在调整它的大小。检查尺寸是否适合您正在测试的设备。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T23:03:17.917

将状态棒设置为最初隐藏对我来说是这样的。

> 状态栏最初是隐藏的 YES

这修复了它

```
- (void) setStatusBarVisible: (NSTimer *)timer 
{
     [[UIApplication sharedApplication] setStatusBarHidden:NO withAnimation:UIStatusBarAnimationNone];
}

- (void)applicationWillEnterForeground:(UIApplication *)application
{
     [[UIApplication sharedApplication] setStatusBarHidden:YES withAnimation:UIStatusBarAnimationNone];

     [NSTimer scheduledTimerWithTimeInterval:0.05 target:self selector:@selector(setStatusBarVisible:) userInfo:nil repeats:NO];
 } 
```

似乎设置然后重置（经过短暂延迟）状态栏解决了这个问题。

这解决了它，但它不应该首先发生。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-29T11:00:49.370

是的，当您再次回到前台时会发生这种情况。它发生在我身上，我已经通过使用解决了这个问题

```
 (void)layoutSubviews 
```

这意味着我在 layoutSubviews 方法中绘制的东西会发生变化并且工作正常。

有关这方面的更多信息，[请查看我的问题和解决方案](https://stackoverflow.com/questions/14331432/application-life-cycle-issue/14357154#14357154)

# android - Android、opengl、移动glsurfaceview

> ID：11320746
> 
> 赞同：0
> 
> 时间：2012-07-03T23:54:58.250
> 
> 标签：android, opengl-es, glsurfaceview

我已经`glsurfaceview`在 xml 文件中创建了，我想`glsurfaceView`在按下按钮时更改它的 X、Y。我有`onSurfaceChanged()`方法并且有 x,y 变量。我可以将此方法称为chane`glsurfaceview`位置吗？如果可以，我该怎么做，或者如何改变位置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T19:11:18.920

> 我有 onSurfaceChanged() 方法并且有 x,y 变量。我可以将此方法称为chane glsurfaceview 位置吗？

不，你不能，因为`onSurfaceChanged (GL10 gl, int width, int height)`作为一个事件。**当您的表面尺寸已经**改变时，它由 OpenGL ES 子系统调用。因此，当您的表面大小已经改变时，它用于覆盖和执行某些典型操作（[如这里详述）。](http://developer.android.com/reference/android/opengl/GLSurfaceView.Renderer.html)

由于`GLSurfaceView`是`SurfaceView`后代并且是层次结构的一部分`View`，您可以使用通常的定位方法（例如[setX()](http://developer.android.com/reference/android/view/View.html#setX%28float%29)）来设置其位置（但*不要忘记*您应该在 Android 应用程序中确保的屏幕和密度独立性）。

作为旁注：我不知道您的应用程序架构和详细信息，但是当需要重新定位 a`GLSurfaceView`时，通常对于同一问题有一个等效的解决方案/解决方法，不需要重新定位。

# sublimetext2 - 在 Sublime Text 中，如何增加“查找全部”返回的上下文行数？

> ID：11320755
> 
> 赞同：27
> 
> 时间：2012-07-03T23:55:58.420
> 
> 标签：sublimetext2

我正在使用 Sublime Text 中的“查找全部”功能，我想从查找结果中再看到几行。我找不到这个设置——有什么办法吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-05-07T17:03:32.863

To expand upon DarkWater's comment to your question:

Add new lines with a regex before and after your search string:

`.*\n.*\n.*search_string.*\n.*\n.*`

This will match 2 new lines before and after your `search_string`.

Make sure you enable regular expression searching in the find dialog. Also make sure that you escape any regex special characters in your `search_string`.

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-12-31T06:30:47.663

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2017-03-01T17:19:54.487

To expand on the solutions provided by @dasl and @zaboco

I found that this variation was more suitable.

Example:

```
(.*\n){0,2}.*search_string.*(\n.*){0,2} 
```

This will match 0-2 new lines before/after your search_string. Adjust numbers as needed to provide more/less context, but always keep the 0 as the first number in the quantifier.

Again, make sure you enable regular expression searching in the find dialog.

(The original regexes required that 2 lines above/below are present in the files, and excluded some necessary files from the search results)

# ruby-on-rails - rake db：回滚不起作用？

> ID：11320756
> 
> 赞同：46
> 
> 时间：2012-07-03T23:56:20.103
> 
> 标签：ruby-on-rails

我正在编写我的第一个 Rails 应用程序。我已经运行了一些命令`rails generate model ...`，`rake db:migrate`但我现在想更改我的数据模型，因此需要撤消一些迁移。

[文档](http://guides.rubyonrails.org/migrations.html#rolling-back)说我可以使用撤消迁移`rake db:rollback`，但这不起作用。当我在控制台中运行它时，计算机会思考几秒钟，但不会对`db/migrate/`or进行任何更改`db/migrate/schema.rb`。没有输出打印到控制台。

这种行为正确吗？不`db:rollback`应该改变我的架构吗？如果是这样，谁能想到为什么它可能不起作用？

我在 Rails v. 3.2.6 上。

编辑

此刻`rake db:migrate:status`给

```
database: db/development.sqlite3

 Status   Migration ID    Migration Name
--------------------------------------------------
   up     20120617191211  Create irs
   up     20120701154357  Create paths
   up     20120701154421  Create nodes
   up     20120702151447  ********** NO FILE **********
  down    20120702155140  Create venues
  down    20120703233833  Remove path from venues 
```

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2012-07-04T00:13:37.507

解决方案（见我的评论）：运行

```
rake db:migrate:status 
```

并纠正您在那里发现的问题。在这种情况下（根据@MarkThomas 的跟进），您可能需要检查您需要的所有文件是否都已到位。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2017-07-13T07:09:44.563

这对我有用。结合[这个答案](https://stackoverflow.com/questions/3872586/how-to-delete-migration-files-in-rails-3)中给出的步骤和分贝的评论。

1.  跑`rake db:migrate:status`
2.  如果您有`****NO FILE****`条目，只需将版本号记为 noFileVersion。注意没有文件条目（stable_version）上方的条目版本。
3.  创建了一个带有 name`noFileVersion_create_nothing.rb`和 body的“虚拟”文件

```
class CreateNothing < ActiveRecord::Migration[6.0] 
  def change 
  end 
end 
```

4.  跑`rake db:migrate VERSION=stable_version`
5.  `noFileVersion_create_nothing.rb`手动删除。
6.  运行`rake db:migrate`。
7.  再次运行`rake db:migrate:status`以检查 No file entry 是否消失。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2019-03-04T09:37:49.663

以下对我有用： `rake db:migrate:down VERSION=20190304092208`

版本号可以通过以下命令获取： `rake db:migrate:status`

这是回滚最后一次迁移的最后一个版本号

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-06-27T23:40:36.840

> **注意：**谨慎使用这些建议，这对于非开发环境非常危险。

* * *

如果

```
rake db:migrate:status 
```

给你一个迁移，说

`up 20120702151447 ********** NO FILE **********`

那么最好的办法就是做一个（注意以下命令将删除数据库）：

```
rake db:reset 
```

重做所有迁移。如果最后一个迁移是缺失的，那么`schema.rb`将有最后一个迁移，`rake db:migrate`它将寻找：

`ActiveRecord::Schema.define(:version => 20120702151447) do`

将该编号更改​​为 migrate 文件夹中的最后一个编号。

# jquery - 根据名称和值选择选择哪个单选按钮

> ID：11320758
> 
> 赞同：2
> 
> 时间：2012-07-03T23:56:41.877
> 
> 标签：jquery

我正在编写一个非常基本的显示/隐藏脚本，并基于以下两个单选按钮中的哪一个被选中。我的问题是我无法将 id 添加到单选按钮，因为代码是动态生成的。有没有办法使用JQuery根据名称和值的组合来选择选中哪个框？一旦我有了那个 IF 语句，我就可以处理其余的事情，但我只知道如何使用类或 ID 来完成它。

```
<span class="wpcf7-form-control-wrap mysql">
   <span id="mysql" class="wpcf7-form-control wpcf7-radio radiobuttons">
      <span class="wpcf7-list-item">
         <label>
            <span class="wpcf7-list-item-label">Yes</span>
            &nbsp;
            <input type="radio" name="mysql" value="Yes">
         </label>
      </span>
      <span class="wpcf7-list-item">
         <label>
            <span class="wpcf7-list-item-label">No</span>
            &nbsp;
            <input type="radio" name="mysql" value="No">
         </label>
      </span>
   </span>
</span> 
```

所以基本上我正在寻找类似“如果名称是mysql，值为Yes，并且选中单选按钮，执行X。如果名称是mysql，值为No，并且选中单选按钮，执行Y .

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-04T00:02:06.853

**工作演示** [http://jsfiddle.net/YLesK/3/](http://jsfiddle.net/YLesK/3/)

name 属性如果始终相同，所以我认为如果你检查你会没事的`this.value`；否则，您可以添加此条件`$(this).prop('name') === "mysql"`==> [http://jsfiddle.net/YLesK/5/](http://jsfiddle.net/YLesK/5/)

希望这可以帮助，`:)`

**代码**

```
$(function(){
    $('input[type="radio"]').click(function(){
        if(this.value === "Yes")
            alert("Do X I am yes");
        else if (this.value === "No")
            alert("Do Y I am No");
    });

}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T00:06:28.267

```
$(".wpcf7-list-item input:radio").click(function(){
    if($(this).val() == "Yes"){
        alert("do yes function");
    }else{
       alert("do no function");             
    }
}); 
```

演示：http: [//jsfiddle.net/jeBFN/1/](http://jsfiddle.net/jeBFN/1/)

# azure - Azure 虚拟机错误：无法捕获映像：“找不到端点

> ID：11320764
> 
> 赞同：2
> 
> 时间：2012-07-03T23:57:48.207
> 
> 标签：azure, azure-virtual-machine

保存 vhd 时，我在 Azure 虚拟机中收到如下错误：-

```
Failed to capture image vmvhdtrialacc of virtual machine vmvhdalpha

Endpoint Not found: There was no endpoint listening at https://management.core.windows.net:8443/*GUID*/services/hostedservices/vmvhdalpha/deployments/vmvhdalpha/roleInstances/vmvhdalpha/Operations that could accept the message. This is often caused by an incorrect address or SOAP action. See InnerException, if present, for more details. 
```

知道这里可能有什么问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T00:15:23.860

不幸的是，您的问题是最近已知的 Windows Azure 虚拟机问题，在以下[Windows Azure 虚拟机论坛](http://social.msdn.microsoft.com/Forums/en-US/WAVirtualMachinesforWindows/threads)中描述为“仍在调查状态” ：

[http://social.msdn.microsoft.com/Forums/en-US/WAVirtualMachinesforWindows/thread/29fc7e72-6c95-4704-bf79-b9aba562c6ad](http://social.msdn.microsoft.com/Forums/en-US/WAVirtualMachinesforWindows/thread/29fc7e72-6c95-4704-bf79-b9aba562c6ad)

我的建议是在同一个论坛中提交您的问题，并在上​​述链接中跟踪您的问题状态。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-05T13:51:05.273

奇怪的是，我有一个正在运行的虚拟机，然后通过门户将 SSL 证书添加到单独的云服务，这似乎让我的虚拟机失败了。它进入停止状态，并在尝试启动时收到上述错误。只有在之前的帖子链接中提到的解决方案，删除虚拟机（或删除虚拟机并从 VHD 克隆新的虚拟机）。

# ruby-on-rails - 表单和 DB 之间的 Rails 关系

> ID：11320770
> 
> 赞同：0
> 
> 时间：2012-07-03T23:58:08.300
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.1

我的 rails 表单中有一个文本字段。我如何能够允许用户输入一组或逗号分隔的值，例如“12343、121223、32212”，并将这些字符串存储在数据库中的新行上，以便我可以轻松地对该字段执行不同的计数。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T02:32:06.050

您可以拆分字段值：

```
values = param[:field_name].split(', ')
values.each do |v|
  Model.create(:column_name => value)
end 
```

我不确定我是否理解正确，你的问题并不准确

# c# - 样式化自定义控件

> ID：11320777
> 
> 赞同：2
> 
> 时间：2012-07-03T23:58:50.677
> 
> 标签：c#, wpf

我做了我自己的控制。一个继承自`DataGrid`，另一个继承自`ContentControl`。其中一个得到另一个，所以我尝试公开它们的属性，但由于我需要许多不同的控件，我想为我的控件（继承自的那个`DataGrid`）创建一个 Style，并将该控件的属性设置为我的`ContentControl`. 我刚刚写了这样的代码，但它不起作用。任何人都知道我做错了什么？

```
<Style x:Key="CustomDataGridStyle"
       TargetType="{x:Type controls:CustomDataGrid}">
    <Setter Property="CurrentRow"
            Value="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type controls:DataGridContainer}}, Path=SelectedItem, Mode=TwoWay}" />
    <Setter Property="CaptionVisibility"
            Value="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type controls:DataGridContainer}}, Path=CaptionVisibility, Mode=TwoWay}" />
    <Setter Property="CaptionText"
            Value="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type controls:DataGridContainer}}, Path=CaptionText, Mode=TwoWay}" />
    <Setter Property="RowValidationErrorTemplate"
            Value="{StaticResource BasicRowValidationErrorTemplate}" />
    <Setter Property="CurrentView"
            Value="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type controls:DataGridContainer}}, Path=CurrentView, Mode=OneWayToSource}" />
    <Setter Property="CurrentColumnHeaderText"
            Value="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type controls:DataGridContainer}}, Path=CurrentColumnHeader, Mode=OneWayToSource}" />
    <Setter Property="SelectedCellText"
            Value="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type controls:DataGridContainer}}, Path=SelectedText, Mode=OneWayToSource}" />
    <Setter Property="IsDataGridFocused"
            Value="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type controls:DataGridContainer}}, Path=HasFocus, Mode=OneWayToSource}" />
</Style> 
```

我已经像这样定义了我的控制

```
<controls:CustomDataGrid x:Key="DataGridOne" AutoGenerateColumns="True" x:Shared="False" ItemsSource="{Binding UpdateSourceTrigger=PropertyChanged}" /> 
```

和另一个

```
<controls:DataGridContainer Content="{StaticResource DataGridOne}" DataContext="{Binding Products}" 
                                            x:Name="dataGridOne" SelectedItem="{Binding RelativeSource={RelativeSource FindAncestor, 
                                        AncestorType={x:Type UserControl}},
                                        Path=DataContext.SelectedItem, Mode=TwoWay}" CaptionVisibility="Collapsed"/> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T18:16:02.623

您的样式设置了 x:Key 属性。这意味着默认情况下它不会应用于该类型的所有控件。您应该删除 Key 属性以使样式默认并应用于所有 CustomDataGrid 控件，或者在 CustomDataGrid 定义中引用 Style ，如下所示：

```
<Window>
  <Window.Resources>
    <Style x:Key="CustomDataGridStyle" TargetType="{x:Type controls:CustomDataGrid}">
     ...
    </Style>
  </Window.Resources>

 <controls:CustomDataGrid ... Style="{StaticResource CustomDataGridStyle}" ... />
</Window> 
```

# php - php mail() 函数去除返回中断

> ID：11320781
> 
> 赞同：0
> 
> 时间：2012-07-03T23:59:28.183
> 
> 标签：php, mysql, html, special-characters

这是一个示例电子邮件：

```
Hello $name

thank you for joining $sitenamee

regards, the management. 
```

它使用一个简单`submit`的按钮从文本区域保存我遇到的问题是当我使用 php mail() 函数通过电子邮件发送它时，我将它发送到我的电子邮件：

```
Hello $name
thank you for joining $sitenamee
regards, the management. 
```

相同的内容很好，但是返回中断消失了。现在，如果我将 `<br>`标签添加到`<textarea>`并保存，它会发送带有中断的电子邮件。无需在`<br>`我的电子邮件中添加标签即可解决此问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T00:03:35.190

使用 nl2br() 命令让 php
在您发送时在运行时添加标签。

[http://php.net/manual/en/function.nl2br.php](http://php.net/manual/en/function.nl2br.php)

```
nl2br($message);
mail($to, $subject, $message); 
```

# bash - Bash：获取守护进程屏幕会话的 PID

> ID：11320782
> 
> 赞同：12
> 
> 时间：2012-07-03T23:59:40.100
> 
> 标签：bash, gnu-screen

如果我将 GNU 屏幕会话作为守护进程启动，我将如何以编程方式检索其 PID？我不知道输出的一致性如何 `screen -ls`，所以我想知道如何使用 bash 的常量之一或更好的替代方法来做到这`$$`一点`$!`。

我正在使用 启动屏幕`screen -dmS screenname`。

如何在开始屏幕会话之前或之后立即获得屏幕的 PID？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-07-04T00:58:52.543

这显示了名为 的屏幕的 pid `nameofscreen`：

```
$ screen -ls
There are screens on:
    19898.otherscreen   (07/03/2012 05:50:45 PM)    (Detached)
    19841.nameofscreen  (07/03/2012 05:50:23 PM)    (Detached)
2 Sockets in /var/run/screen/S-sarnold.

$ screen -ls | awk '/\.nameofscreen\t/ {print strtonum($1)}'
19841
$ 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-15T19:12:38.447

您可以使用：

```
screen -DmS nameofscreen 
```

它不会派生一个让您知道 pid 的守护进程。

如果两个屏幕会话已以相同的名称启动，则解析 screen -ls 的输出可能不可靠。另一种方法是不要让屏幕会话分叉一个进程并自己将其置于后台：

例如，对于现有的初始屏幕会话：

```
fess@hostname-1065% screen -ls
There is a screen on:
        19180.nameofscreen    (01/15/2013 10:11:02 AM)        (Detached) 
```

使用 -D -m 而不是 -d -m 创建一个屏幕，它不会派生新进程。把它放在后台，得到它的pid。（使用 posix shell 语义）

```
fess@hostname-1066% screen -DmS nameofscreen & 
[3] 19431
fess@hostname-1067% pid=$! 
```

现在有两个屏幕都具有相同的名称：

```
fess@hostname-1068% screen -ls
There are screens on:
        19431.nameofscreen    (01/15/2013 10:53:31 AM)        (Detached)
        19180.nameofscreen    (01/15/2013 10:11:02 AM)        (Detached) 
```

但我们知道区别：

```
fess@hostname-1069% echo $pid
19431 
```

我们可以准确地要求它退出：

```
fess@hostname-1070% screen -S $pid.nameofscreen -X quit
[3]  - done       screen -DmS nameofscreen 
```

现在又是原来的那个了：

```
fess@hostname-1071% screen -ls 
There is a screen on:
        19180.nameofscreen    (01/15/2013 10:11:02 AM)        (Detached) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-02-08T14:47:00.533

您可以在这里获取屏幕会话的 PID，如下所示：

```
$ screen -ls
There are screens on:
        1934.foo_Server         (01/25/15 15:26:01)     (Detached)
        1876.foo_Webserver      (01/25/15 15:25:37)     (Detached)
        1814.foo_Monitor        (01/25/15 15:25:13)     (Detached)
3 Sockets in /var/run/screen/S-ubuntu. 
```

让我们假设您希望在`foo_Monitor`屏幕会话中运行在 Bash 中的程序的 PID。使用`foo_Monitor`屏幕会话的 PID`bash`通过搜索已知 PID 的 PPID（父 PID）来获取在其中运行的会话的 PID：

```
$ ps -el | grep 1814 | grep bash
F S   UID   PID  PPID  C PRI  NI ADDR SZ WCHAN  TTY          TIME CMD
0 S  1000  1815  1814  0  80   0 -  5520 wait   pts/1    00:00:00 bash 
```

现在只获取`bash`会话的 PID：

```
$ ps -el | grep 1814 | grep bash | awk '{print $4}'
1815 
```

现在我们想要具有*该*PID 的进程。只需嵌套命令，这次使用`-v`标志 on`grep bash`来获取*不是*bash 的进程：

```
echo $(ps -el | grep $(ps -el | grep 1814 | grep bash | awk '{print $4}') | grep -v bash | awk '{print $4}')
23869 
```

**只需将 1814 替换为屏幕会话的真实 PID：**

```
echo $(ps -el | grep $(ps -el | grep SCREEN_SESSION_PID | grep bash | awk '{print $4}') | grep -v bash | awk '{print $4}') 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-04T01:31:50.287

我怀疑你真的想要在屏幕内运行的程序的 PID，这似乎并不容易获得。（这并不是一个定义明确的问题，因为单个屏幕进程可以管理多个子进程——这是屏幕的一大优点！）

您可以使用 pgrep 查找其 PPID 是屏幕 PID 的进程。或者做这样的事情：

```
rm mypidfile
screen -dmS blah sh -c 'echo $$ > mypidfile ; exec sh'
# the write to mypidfile is happening in the background, so wait it to show up
while [ ! -s mypidfile ]; do sleep 1; done
pid=`cat mypidfile`
# $pid is now the PID of the shell that was exec'ed inside screen 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-03-09T10:13:31.377

这个答案的灵感来自@sarnold。

让我添加一种获取所有屏幕 PID 的方法：

```
screen -ls | awk '/[0-9]{1,}\./ {print strtonum($1)}' 
```

由于 0-299 是旧内核中守护进程的 PID，您可以将 {1,} 更改为 {3,}

您可以通过以下方式对每个进程进行操作，例如退出它们。

```
pidList=(screen -ls | awk '/[0-9]{3,}\./ {print strtonum($1)}')
for pid in ${pidList[@]};
do
    screen -X -S $pid quit
done 
```

您还可以使用`screen -X -S $pid stuff 'command\n'`.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-02-08T04:03:00.593

完成萨诺德的回答：

```
$ screen -ls
There are screens on:
    19898.otherscreen   (07/03/2012 05:50:45 PM)    (Detached)
    19841.nameofscreen  (07/03/2012 05:50:23 PM)    (Detached)
2 Sockets in /var/run/screen/S-sarnold.

$ screen -ls | awk '/\.nameofscreen\t/ {print strtonum($1)}'
19841 
```

...获取具有此 PID 作为 PPID 的进程的 PID，如下所示：

```
$ ps --ppid 19841 -o pid=
19842 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-11-17T00:40:46.150

另一种方法是使用屏幕的 -Q 参数来查询会话：

```
screen -S nameofscreen -Q echo '$PID' 
```

请注意，这还将在屏幕会话中显示 PID 作为通知。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-08-09T16:52:34.940

第一个答案对我不起作用。相反，我使用了这个：

```
screen -ls | grep -oE "[0-9]+\.screen_name" | sed -e "s/\..*$//g" 
```

`grep -oE`仅返回与正则表达式匹配的内容，该正则表达式至少匹配 1 个数字、一个文字点，然后是`screen_name`. 例如，这可能会输出`784.screen_name`（如果 pid 为 784）。然后，使用 sed 删除从第一个点到字符串末尾的所有内容。

# iis-7 - 如何配置 IIS7，以便我可以使用 Web Deploy 从 WebMatrix 上传？

> ID：11320784
> 
> 赞同：0
> 
> 时间：2012-07-03T23:59:52.797
> 
> 标签：iis-7, upload, webmatrix, webdeploy

如何配置 IIS，以便我可以将站点从 WebMatrix 上传到远程 Windows Server 2008 服务器？我会在框中的 webmatrix 上放什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T00:32:03.613

您不需要在服务器上安装 WebMatrix，您需要安装的是 Web Deploy v2：

> [http://www.iis.net/download/webdeploy](http://www.iis.net/download/webdeploy)

这里有一篇关于如何安装的好文章：

> [http://blogs.iis.net/msdeploy/archive/2011/04/05/announcing-web-deploy-2-0-refresh.aspx](http://blogs.iis.net/msdeploy/archive/2011/04/05/announcing-web-deploy-2-0-refresh.aspx)

这里还有很多关于 Web Deploy 的好东西：

> [http://learn.iis.net/page.aspx/346/web-deploy/](http://learn.iis.net/page.aspx/346/web-deploy/)

# visual-studio - 不能在 Visual Studio 中包含 Boost 标头

> ID：11320786
> 
> 赞同：0
> 
> 时间：2012-07-04T00:00:20.127
> 
> 标签：visual-studio, boost, header-files

我刚刚建立了这样的提升：

```
bjam toolset=msvc-11.0 variant=debug,release threading=multi link=static 
```

我添加了包含路径：C:/boost/boost_1_50_0

库路径：C:/boost/boost_1_50_0/stage/lib

* * *

当我尝试包含文件系统标头时

```
#include <boost\filesystem.hpp> 
```

我得到：错误 1 ​​错误 C1083：无法打开包含文件：'boost/filesystem.hpp'：没有这样的文件或目录

然而

```
#include <filesystem> 
```

编译就好了。

有人可以告诉我我做错了什么吗？谢谢。

# ios - 使用 XML 或 JSON 解析器解析 iOS 应用程序中的数据

> ID：11320790
> 
> 赞同：0
> 
> 时间：2012-07-04T00:00:46.550
> 
> 标签：ios, xml, json, web-services, nsurlconnection

我只是想澄清一下我对 iOS 应用程序中使用的 Web 服务的理解。

因此，NSURLConnection 用于从 iOS 应用程序调用 Web 方法并获取 Web 方法返回的数据。一旦接收到数据，我们可以使用 XMLParser 或 JSON 解析器来解析该数据，具体取决于 Web 服务的写入内容。这样是否正确？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T02:12:02.927

只是为了补充其他人在评论中已经说过的话：

理想情况下，您希望始终使用不会阻塞主线程[的 NSURLConnection 的委托进行异步连接。](https://developer.apple.com/library/mac/#documentation/Foundation/Reference/NSURLConnectionDelegate_Protocol/Reference/Reference.html#//apple_ref/occ/intf/NSURLConnectionDelegate)如果您还不知道，iOS 将强制退出阻塞主线程太长时间的应用程序。在某些情况下同步连接是可以的，但我会说超过 90% 的时间你需要异步连接。

也就是说，异步连接会引起他们自己的一系列麻烦。如果您需要在允许用户访问应用程序界面之前获取数据，则需要抛出加载屏幕，然后将其删除。如果用户移动到启动新请求的应用程序的不同部分，您将需要管理取消请求。您还需要确定是否需要为后台完成注册任何正在进行的请求，以防用户将应用程序置于后台。

在 JSON 解析方面，总是建议尽可能使用 NSData，因为从 NSString 转换 JSON 会增加 NSString 本身的大量开销。我个人不使用 Apple 提供的 JSON 解析器，而是[使用出色的 JSONKit](https://github.com/johnezang/JSONKit/)，因为它甚至比 Apple 的二进制 plist 解析器还要快。但是，它确实要求您的 JSON 非常严格地遵守 JSON RFC，并且它是 UTF-8/16/32 编码的，而不是 ASCII。这在可用的更快的 JSON 解析器中是相当标准的。

尽可能避免使用 XML。内置的 iPhone 解析器只是一个 SAX 风格的解析器，实现起来很麻烦。如果您必须使用 XML，请查看[Ray Wenderlich 的 XML 解析器比较](http://www.raywenderlich.com/553/how-to-chose-the-best-xml-parser-for-your-iphone-project)并选择一个合适的。但是，如果您要解析大型 XML 文档，那么 SAX 可能是您唯一的选择，因为 iDevices 的处理能力有限。

- 编辑 -

其中一位评论者提到了 SBJSON。我建议完全反对。它比 Apple 的 JSON 解析器（从 iOS 5 开始可用）慢，并且比 JSONKit 和其他几个慢一个数量级。由于在 JSON 解析中也收到错误，我特意将我当前的企业级 iOS 应用程序从 SBJSON 中移出。

# php - 将 JSON 字符串保存到 MySQL 数据库

> ID：11320796
> 
> 赞同：8
> 
> 时间：2012-07-04T00:01:34.543
> 
> 标签：php, mysql, xampp

我有一个 JSON 字符串

```
{"name":"jack","school":"colorado state","city":"NJ","id":null} 
```

我需要将其保存在数据库中。我怎么能这样做？

我的 PHP 代码（我只建立了与 MySQL 的连接，但我无法保存记录）

```
 <?php
    // the MySQL Connection
    mysql_connect("localhost", "username", "pwd") or die(mysql_error());
    mysql_select_db("studentdatabase") or die(mysql_error());

    // Insert statement

    mysql_query("INSERT INTO student
    (name, school,city) VALUES(------------------------- ) ") // (How to write this)
    or die(mysql_error());  

    echo "Data Inserted or failed";

    ?> 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-07-04T00:59:21.993

我们将使用`json_decode` [json_decode 文档](http://php.net/manual/en/function.json-decode.php)

也一定要逃走！这就是我在下面的做法......

```
/* create a connection */
$mysqli = new mysqli("localhost", "root", null, "yourDatabase");

/* check connection */
if (mysqli_connect_errno()) {
    printf("Connect failed: %s\n", mysqli_connect_error());
    exit();
}

/* let's say we're grabbing this from an HTTP GET or HTTP POST variable called jsonGiven... */
$jsonString = $_REQUEST['jsonGiven'];
/* but for the sake of an example let's just set the string here */
$jsonString = '{"name":"jack","school":"colorado state","city":"NJ","id":null}
';

/* use json_decode to create an array from json */
$jsonArray = json_decode($jsonString, true);

/* create a prepared statement */
if ($stmt = $mysqli->prepare('INSERT INTO test131 (name, school, city, id) VALUES (?,?,?,?)')) {

    /* bind parameters for markers */
    $stmt->bind_param("ssss", $jsonArray['name'], $jsonArray['school'], $jsonArray['city'], $jsonArray['id']);

    /* execute query */
    $stmt->execute();

    /* close statement */
    $stmt->close();
}

/* close connection */
$mysqli->close(); 
```

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T07:09:23.410

这是帮助您的示例

```
<?php
 $json = '{"name":"jack","school":"colorado state","city":"NJ","id":null}';// You can get it from database,or Request parameter like $_GET,$_POST or $_REQUEST or something :p
 $json_array = json_decode($json);

 echo $json_array["name"];
 echo $json_array["school"];
 echo $json_array["city"];
 echo $json_array["id"];
?> 
```

希望这有帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-04T00:07:26.580

解码成一个数组并将其传递到您的 mysql_query 中，下面的代码没有使用 mysql_real_escape_string 或您应该实施的任何其他安全手段。

假设 $json 是 {"name":"jack","school":"colorado state","city":"NJ","id":null}

```
$json_array = json_decode($json); 
```

您现在在 php 数组中有索引，例如： $json_array['name']

```
mysql_query("INSERT INTO student (name, school,city) VALUES('".$json_array['name']."', '".$json_array['school']."', '".$json_array['city']."') ") or die(mysql_error()); 
```

# php - 定位此代码使用的 WordPress 插件源代码

> ID：11320802
> 
> 赞同：2
> 
> 时间：2012-07-04T00:02:30.177
> 
> 标签：php, filter, wordpress, hook

我正在尝试为[s2Member](http://wordpress.org/extend/plugins/s2member/)编写一个钩子：

我对以下代码有疑问：

```
eval ('foreach(array_keys(get_defined_vars())as$__v)$__refs[$__v]=&$$__v;');
do_action ("ws_plugin__s2member_after_paypal_notify", get_defined_vars ());
unset ($__refs, $__v); /* Unset defined __refs, __v. */ 
```

1.  做什么`eval ('foreach(array_keys(get_defined_vars())as$__v)$__refs[$__v]=&$$__v;');`，尤其是`&$$__v`？

2.  我找不到`ws_plugin__s2member_after_paypal_notify`. 这应该是一堂课吗？我怎样才能找到这个类的源代码？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T00:12:07.193

1.  eval 接受一个字符串，然后像运行 PHP 代码一样运行它。在这种特殊情况下，代码接受一个字符串并对其进行操作，试图插入一些变量名或变量地址。Eval 是一种非常非常糟糕的做法，也是一种反模式。如果可以 - 不要使用这个插件，因为它可能充满了安全漏洞。

2.  `ws_plugin__s2member_after_paypal_notify`是一个钩子。WordPress 钩子很棒——它就像 JavaScript 中的一个事件。例如，如果您单击页面中的某些内容，JavaScript 会触发 onclick 事件，并且任何人都可以附加到该事件并运行一些代码。WordPress 钩子的工作方式相同。现在，当您运行`do_action ("ws_plugin__s2member_after_paypal_notify", get_defined_vars ());`已安装的任何第三方插件时，可以附加到它并执行操作。

如果您想查找在此操作上运行的代码位，请查找`add_action('ws_plugin__s2member_after_paypal_notify' ...)`（这是您附加到挂钩的方式），或者只是`ws_plugin__s2member_after_paypal_notify`在您的*wp-content*目录中查找（任何插件和/或主题都可以附加到此挂钩）。

# php - 如何计算php文件中的行数？

> ID：11320805
> 
> 赞同：1
> 
> 时间：2012-07-04T00:02:43.603
> 
> 标签：php, windows, file-management

我正在开发一个 php 应用程序，想知道文件中的行数。这些文件位于几个不同的目录中，但如果需要，我可以将它们全部复制到一个目录中。

计算文件行数的最佳 Windows 应用程序/工具是什么？

我在这里搜索过，但几乎所有的问题都是关于在 php 中计数，而不是使用外部程序。

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-04T00:08:34.437

[CLOC](http://cloc.sourceforge.net/)是一个非常强大的工具，可以按照您的要求执行并分隔代码行、空白行和注释。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-04T00:05:03.823

如果您有权访问 Linux shell，则可以运行以下命令：

```
find . -name '*.php' -exec cat {} \; | wc -l 
```

如果您使用的是 Windows，请先安装[Cygwin](http://www.cygwin.com/)，然后运行该命令。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-04T00:05:22.277

如果您不想使用，`count(file($fn))`那么外部工具也是可行的。

一个标准的 Unix 工具是`wc`wordcount。使用该`-l`选项只返回行：

```
 $count = intval(`wc -l '$fn'`); 
```

不要忘记逃跑。是的，你可以用谷歌搜索 Windows 版本。

# mysql - 如何从 MySQL 上的单个查询中搜索不同行的相同值

> ID：11320810
> 
> 赞同：0
> 
> 时间：2012-07-04T00:03:08.103
> 
> 标签：mysql, wordpress

我有这张表'post_meta'

```
post_id name        value
87      my_keyname1 randval1
87      my_keyname2 randval2 
```

我想搜索 2 个不同的行并希望返回一个 post_id。我知道“名称”和“值”的所有值，并且我想满足我的查询，即我得到具有 2 个不同“名称”和“值”行的相同 post_id。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T00:06:43.590

```
SELECT DISTINCT post_id FROM post_meta
WHERE (name = 'my_keyname1' AND value = 'randval1')
OR (name = 'my_keyname2' AND value = 'randval2'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T00:24:02.213

如果您仅针对感兴趣的记录过滤表，然后按分组`post_id`，则您想要的结果是那些恰好包含两个不同记录的组：

```
SELECT   post_id
FROM     post_meta
WHERE    (name = 'my_keyname1' AND value = 'randval1')
      OR (name = 'my_keyname2' AND value = 'randval2')
GROUP BY post_id
HAVING   COUNT(DISTINCT name, value) = 2 
```

如果保证组内每条记录的名称或值是唯一的，您可以替换为`COUNT(DISTINCT name, value)`以`COUNT(*)`获得更好的性能。

# php - 使用 CSS 和 PHP 导航 - 基于图像的悬停菜单 (jQuery)

> ID：11320811
> 
> 赞同：0
> 
> 时间：2012-07-04T00:03:16.167
> 
> 标签：php, jquery, css, menu

我有一个基于图像的菜单（例如，一个黄色和一个蓝色）。我在 Illustrator 中设计了按钮，然后转换为 PNG 文件。现在，我正在使用 CSS 来实现悬停效果。

因此，当我将鼠标悬停在图像上时，它会发生变化。所以这很好（因为它有效），但它远非完美（这就是我在这里的原因）......我在 CSS 中的一个按钮看起来像这样：

```
.home_menu, .about_menu, .video_menu, .demo_menu, .contact_menu {
    float: left;
    margin-bottom: 10px;
    margin-top: 10px;
    margin-left: 10px;
    width: 100px;
    height: 34px;
    display: block;
}

.home_menu {        
    background: transparent url('../images/buttons/home_but.png');
}

.home_menu:hover {
    background-image: url('../images/buttons/home_but_hov.png');
} 
```

HTML就像这样开始：

```
<div id="main_menu">
    <a href="index.php" class="home_menu" title="Home"></a>
    <a href="index.php/about" class="about_menu" title="About"></a>
    <a href="index.php/videos" class="video_menu" title="Videos"></a>
    <a href="index.php/demo" class="demo_menu" title="Demo"></a>
    <a href="index.php/contact" class="contact_menu" title="Contact"></a>
</div> 
```

所以基本上我正在更改每个类的 CSS 背景图像。

两个问题。首先，我试图让每个菜单在该页面上都是蓝色版本。所以我写了一个 PHP 函数来做这个（在一个类中），以防万一我想避免使用 JavaScript。它看起来像这样：

```
// Display table and loop through links and images from array
public function print_navigation($image_dir, $ds, $page_nav, $page_nav_alt, $menu) {

    $current_file = explode('/', $_SERVER['PHP_SELF']);
    $current_page = $current_file[count($current_file) - 1];
    $current_page;
    //$i = 0;

    foreach ($page_nav as $key => $value) {

        $menu_output .= '<a href="';
        $menu_output .= $key;
        $menu_output .= '" id="';
        $menu_output .= $menu[$key];
        $menu_output .= '" style="background: transparent url(';

        if ($current_page == $key) {
            $menu_output .= $image_dir . $ds . $page_nav_alt[$key];
        }
        else {
            $menu_output .= $image_dir . $ds . $page_nav[$key];
        }

        $menu_output .= ');"';
        $menu_output .= '></a>';

        $i++;
    }

    echo $menu_output; 
} 
```

它似乎适用于主页（`$home`变量），但不适用于其他页面。我有这样的变量（另一个文件中的数组和变量，为简洁起见被截断）：

```
$menu = array(
    $home => 'home_menu',
    ...);

$page_nav_ylw = array(
    $home => $home_but_ylw,
    ...);

$page_nav_blu = array(
    $home => $home_but_blu,
    ...); 
```

然后我将所有图像放在变量中，在数组中引用，例如，`$home_but_ylw`引用该按钮的 PNG。

PHP 函数有点奇怪，因为我使用`$key`for 两个数组，我敢肯定这是不好的。但是我很难让它正常工作。

第二个问题是：有什么理由我不能在此之上添加 JavaScript（如 jQuery）来获得悬停效果，以便我可以将其从 CSS 中删除？理想情况下，我想用一个 PHP 循环显示按钮，该循环也处理当前页面，然后使用 jQuery 进行悬停影响。

对不起，很长的帖子。希望这是有道理的。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T01:26:03.887

如果您打算动态地为您的页面提供服务，那么我认为 jQuery 会是一个更好的选择。但是，如果您的链接要分开页面，请尝试以下操作：

```
 function printNav($Page = "home"){

    $HTML = "<a href=\"index.php\" class=\"MenuItem HomeMenuItem"; if($Page == "home"){ $HTML .= " ActiveNav"; } $HTML .= "\" title=\"Home\"></a>";
    $HTML .= "<a href=\"#\" class=\"MenuItem"; if($Page == "about"){ $HTML .= " ActiveNav"; } $HTML .= "\" title=\"About\"></a>";
    $HTML .= "<a href=\"#\" class=\"MenuItem"; if($Page == "video"){ $HTML .= " ActiveNav"; } $HTML .= "\" title=\"Videos\"></a>";
    $HTML .= "<a href=\"#\" class=\"MenuItem"; if($Page == "demo"){ $HTML .= " ActiveNav"; } $HTML .= "\" title=\"Demo\"></a>";
    $HTML .= "<a href=\"#\" class=\"MenuItem"; if($Page == "contact"){ $HTML .= " ActiveNav"; } $HTML .= "\" title=\"Contact\"></a>";
     echo $HTML;
} 
```

**在每个单独的页面上：**

```
<div id="main_menu">
    <?php printNav("home"); ?>
</div> 
```

**CSS：**

```
.ActiveNav {
    background-image: url('../images/buttons/blue_bg.png');
}
.MenuItem {
    float: left;
    margin-bottom: 10px;
    margin-top: 10px;
    margin-left: 10px;
    width: 100px;
    height: 34px;
    display: block;
}

.HomeMenuItem {        
    background: transparent url('../images/buttons/home_but.png');
}

.HomeMenuItem:hover {
    background-image: url('../images/buttons/home_but_hov.png');
} 
```

编辑：如果您想为每个按钮使用不同的图像 - 我建议使用通用按钮背景并悬停并将文本和图标放在其顶部。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T05:25:24.120

基于这个答案，我能够找到解决我的问题的方法：

[PHP 菜单导航](https://stackoverflow.com/questions/4464438/php-menu-navigation)

基本上，我使用 GET 方法来获取选定的类。这很好用。我整合了我的 CSS，并且能够让这个东西正常工作。

对于一个链接，结果如下：

```
<?php $class = $_GET['selected_tab']; ?>
<div id="main_menu">
    <a href="index.php/?selected_tab=home" id="home_menu" title="Home"
        class="<?php if(strcmp($class, 'home') == 0) {echo 'selected';} ?>"></a> 
```

像这样的CSS：

```
#home_menu {
    background: transparent url('../images/buttons/home_but.png');
}

#home_menu:hover, #home_menu.selected {
    background-image: url('../images/buttons/home_but_hov.png');
} 
```

下一步是转换为 jQuery。

感谢 Mike GB 的帮助，但这并不是我想要的。

# webgl - 使用矩阵变换 Three.js 场景图

> ID：11320817
> 
> 赞同：5
> 
> 时间：2012-07-04T00:04:10.203
> 
> 标签：webgl, three.js, scenegraph

我正在尝试将文件中的场景加载到 Three.js（自定义格式，不是 Three.js 支持的格式）。这种特定格式描述了一个场景图，其中树中的每个节点都有一个指定为 4x4 矩阵的变换。将其推入 Three.js 的过程如下所示：

```
// Yeah, this is javascript-like psuedocode
function processNodes(srcNode, parentThreeObj) {
    for(child in srcNode.children) {
        var threeObj = new THREE.Object3D();

        // This line is the problem
        threeObj.applyMatrix(threeMatrixFromSrcMatrix(child.matrix));

        for(mesh in child.meshes) {
            var threeMesh = threeMeshFromSrcMesh(mesh);
            threeObj.add(threeMesh);
        }

        parentThreeObj.add(threeObj);

        processNodes(child, threeObj); // And recurse!
    }
} 
```

或者至少这就是我想要的。正如我所指出的，这`applyMatrix`条线并不像我期望的那样工作。大部分场景看起来不错，但某些已旋转的元素没有正确对齐（而其他元素则很奇怪）。

通过 COLLADA 加载器（它与我正在尝试做的事情大致相同）看起来他们[将矩阵分解](https://github.com/mrdoob/three.js/blob/master/examples/js/loaders/ColladaLoader.js#L820)为平移/旋转/缩放并单独应用每个。我尝试用它代替上面显示的 applyMatrix：

```
var props = threeMatrixFromSrcMatrix(child.matrix).decompose();
threeObj.useQuaternion = true;
threeObj.position = props[ 0 ];
threeObj.quaternion = props[ 1 ];
threeObj.scale = props[ 2 ]; 
```

这再一次产生了一个场景，其中大多数元素都在正确的位置，但以前未对齐的网格现在已经在某个地方变成了遗忘，根本不再出现。所以最后这并不比`applyMatrix`上面的好。

查看有关该主题的几个在线讨论，似乎推荐的使用矩阵进行变换的方法是将它们直接应用于几何，而不是节点，所以我尝试通过手动构建变换矩阵，如下所示：

```
function processNodes(srcNode, parentThreeObj, parentMatrix) {
    for(child in srcNode.children) {
        var threeObj = new THREE.Object3D();

        var childMatrix = threeMatrixFromSrcMatrix(child.matrix);
        var objMatrix = THREE.Matrix4();
        objMatrix.multiply(parentMatrix, childMatrix);

        for(mesh in child.meshes) {
            var threeMesh = threeMeshFromSrcMesh(mesh);
            threeMesh.geometry.applyMatrix(objMatrix);
            threeObj.add(threeMesh);
        }

        parentThreeObj.add(threeObj);

        processNodes(child, threeObj, objMatrix); // And recurse!
    }
} 
```

这实际上产生了正确的结果！（减去法线的一些怪癖，但我可以弄清楚）这很好，但问题是我们现在已经有效地扁平化了场景层次结构：更改父级的变换将对子级产生意想不到的结果，因为完整的变换堆栈现在“烘焙”到网格中。在这种情况下，关于场景的信息丢失是不可接受的。

那么如何告诉 Three.js 执行相同的逻辑，但在场景图中的适当位置？

（抱歉，我非常想发布一些实时代码示例，但不幸的是，在这种情况下，这不是一个选项。）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-04T00:32:43.237

*叹...*

Altered Qualia在我发布此消息后的几分钟内就在 Twitter 上[指出了解决方案。](https://twitter.com/alteredq/status/220311650182508544)

这是一个简单的单行修复：只需`matrixAutoUpdate`在 Object3D 实例上设置为 false，第一个代码示例就会按预期工作。

```
threeObj.matrixAutoUpdate = false; // This fixes it
threeObj.applyMatrix(threeMatrixFromSrcMatrix(child.matrix)); 
```

总是那些愚蠢的小事让你...

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-04T00:33:54.210

您可以使用 matrixAutoUpdate = false 跳过 Three.js 场景图位置/缩放/旋转的内容。然后将 object.matrix 设置为您想要的矩阵，所有这些都应该是花花公子（好吧，它仍然会乘以父节点矩阵，所以如果您使用绝对模型视图矩阵，您需要破解 Object3D 上的 updateMatrixWorld 方法。）

```
object.matrixAutoUpdate = false;
object.matrix = myMatrix; 
```

现在，如果您想在 Three.js 位置/缩放/旋转的东西上应用自定义转换矩阵，您需要将 Object3D#updateMatrix 编辑为类似的东西。

```
THREE.Object3D.prototype._updateMatrix = THREE.Object3D.prototype.updateMatrix;
THREE.Object3D.prototype.updateMatrix = function() {
  this._updateMatrix();
  if (this.customMatrix != null)
    this.matrix.multiply(this.customMatrix);
}; 
```

见[https://github.com/mrdoob/three.js/blob/master/src/core/Object3D.js#L209](https://github.com/mrdoob/three.js/blob/master/src/core/Object3D.js#L209)

# jquery - 单击#gen后，我想用文本框值设置href吗？

> ID：11320818
> 
> 赞同：1
> 
> 时间：2012-07-04T00:04:12.110
> 
> 标签：jquery, textbox, set, anchor

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T00:08:54.737

将您移动`var address`到点击处理程序中：

```
$('#gen').click( function(){
    var address=$(textbox).val();
    $('a').attr('href', address);
});​ 
```

[JSFiddle 演示](http://jsfiddle.net/EgLre/)

在您的示例中，它将设置`address`为空字符串，因为在页面加载时它还为空。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T00:12:24.290

尝试这个

**HTML**

```
<input type='text' value='' name="address" id="address" />
<label id='gen'>Generate</label>
</br></br>
<a href=''>Download</a>​ 
```

**JS**

```
$('#gen').click(function(e){
    //e.preventDefault();
    url='http://'+$('#address').val();
    $('a').attr('href', url);
}); 
```

[**演示。**](http://jsfiddle.net/hNsm5/)

我认为您应该将 an`id`与 the 一起使用，`a tag`并且可以使用 a`button`而不是`label` [**see this**](http://jsfiddle.net/hNsm5/2/)。

# c++ - 绘制二维条纹

> ID：11320821
> 
> 赞同：1
> 
> 时间：2012-07-04T00:04:35.420
> 
> 标签：c++, opengl, glut

这个简单的程序旨在绘制 13 条均匀的、交替放置的红色和白色条纹，就像美国国旗一样。

```
// A Simple OpenGL Project
// Author: Michael Hall
//
// This C++ code and project are provided "as is" without warranty of any kind.
//
// Copyright 2010 XoaX - For personal use only, not for distribution
// 
// Elaborated by me :)

#include <glut.h>

void DrawStripes(const int quantity)
{
    glBegin(GL_QUADS);

    for(int i=1; i <= quantity ; i++)
    {
        if(i%2)
            glColor3f(1.0,0.0,0.0);
        else 
            glColor3f(1.0,1.0,1.0);

            glVertex2f(0,static_cast<float>(i-1)/static_cast<float>(quantity));
            glVertex2f(1.0,static_cast<float>(i-1)/static_cast<float>(quantity));

            glVertex2f(0,static_cast<float>(i)/static_cast<float>(quantity));
            glVertex2f(1.0,2*static_cast<float>(i)/static_cast<float>(quantity));
    }
}

void Draw() 
{
    glClear(GL_COLOR_BUFFER_BIT);
    glColor3f(0.0, 0.0, 1.0);
    DrawStripes(13);

    glEnd();
    glFlush();
}

void Initialize() 
{
    glClearColor(0.0, 0.0, 102.0/255.0, 0.0);
    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();
    glOrtho(0.0, 1.0, 0.0, 1.0, -1.0, 1.0);
}

int main(int iArgc, char** cppArgv) 
{
    glutInit(&iArgc, cppArgv);
    glutInitDisplayMode(GLUT_SINGLE | GLUT_RGB);
    glutInitWindowSize(950,500);
    glutInitWindowPosition(200, 200);
    glutCreateWindow("Rough draft");
    Initialize();

    glutDisplayFunc(Draw);
    glutMainLoop();

    return 0;
} 
```

这就是它在实践中的样子： ![最后的窗口](../Images/98d1d86b3220a4524d286970856db392.png) 为什么前景上有蓝色三角形？我在 Draw/DrawStripes 函数中只指定了“QUADS”。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T00:22:14.040

蓝色来自你清晰的颜色：

```
 glClearColor(0.0, 0.0, 102.0/255.0, 0.0); 
```

第三个参数是清晰颜色的蓝色通道。当您调用 glClear(GL_COLOR_BUFFER_BIT); 您使用清晰的颜色初始化渲染目标。

因此，您看到的蓝色来自您的顶点，没有覆盖整个渲染目标，并让蓝色清晰的颜色通过。要查看它，请启用线框 (glPolygonMode(GL_FRONT_AND_BACK, GL_LINE);)。

此外，您真的应该以逆时针方式绘制：左上角、左下角、右下角、右上角。这将导致您的多边形被绘制为正面（这*通常*是您想要避免背面剔除的内容）。

目前，您正在“折叠”多边形，通过执行左上角、右上角、**左下角**，然后右下角，您实际上会扭曲四边形。按顺时针顺序尝试（反转右下角和左下角），看看你是否仍然可以看到多边形（如果背面剔除打开，你不应该看到）。

最后你也*只*将右下角的 Y 坐标乘以 2，为什么？这就是导致您变形的原因（在扭曲之上）。您应该让两个底部顶点具有相同的 Y 坐标来制作一个矩形（因此右下角和左下角 Y 坐标必须匹配）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-04T00:11:42.820

我认为您以错误的顺序绘制四边形顶点。它们应该是逆时针的，但你正在绘制一个“扭曲”的四边形。

尝试在 for 循环中交换第三个和第四个顶点。

# c++ - 为什么在 C++ 中通过空指针“工作”调用方法？

> ID：11320822
> 
> 赞同：18
> 
> 时间：2012-07-04T00:05:00.393
> 
> 标签：c++

> **可能重复：**
> [通过 NULL 类指针调用类方法](https://stackoverflow.com/questions/2505328/calling-class-method-through-null-class-pointer)

```
#include <iostream>
using namespace std;
class test
{
    int i;
public:
    test():i(0){ cout << "ctor called" << endl;}
    void show()
    {
        cout<<"show fun called"<<endl;
    }
};

int main(int argc , char *argv[])
{
    test *ptr = NULL;
    ptr->show();
    return 0;
} 
```

显然，不会调用任何ctor。这是标准吗？或者只是一些编译器优化，因为这个指针没有在 show() 成员函数中使用？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-07-04T00:07:29.937

调用该方法不需要指针。指针的类型是已知的，因此方法的代码是已知的。该方法不使用`this`，因此它可以正常运行代码。这是未定义的行为，但不检查指针是否为 NULL 更有效，因此它运行。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-07-04T00:15:10.897

如果您查看程序集（对于至少一个编译器），您可以看到它运行的原因（即使它是许多人指出的未定义行为）。对于这两行：

```
test *ptr = NULL;
ptr->show(); 
```

生成了这个程序集（在我刚刚尝试过的一个编译器中）：

```
00000004: C7 45 FC 00 00 00  mov         dword ptr [ebp-4],0
          00
0000000B: 8B 4D FC           mov         ecx,dword ptr [ebp-4]
0000000E: E8 00 00 00 00     call        ?show@test@@QAEXXZ 
```

它将 NULL (0) 压入堆栈并调用该方法，因为该方法的地址与实际对象实例无关。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-04T00:08:08.257

它无效，行为未定义，实际结果取决于您的编译器。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-04T00:09:42.033

好吧，首先，它是无效的，因为它会调用未定义的行为。您真的在问为什么编译器允许它，答案是因为那是在实际应用程序中根本不会出现的愚蠢代码，那么为什么要麻烦呢？当指针*在运行时*以静态代码分析无法预料的方式变为无效时，真正的问题就出现了。

编译器不是用来牵你的手的，它是用来根据标准编译你的代码的。如果它提供有用的警告，那就太好了，但那里没有语法或语义上的非法内容，您只是在编写导致未定义行为的代码。

# c# - 在 MVC4 中注册启动脚本

> ID：11320828
> 
> 赞同：1
> 
> 时间：2012-07-04T00:05:43.707
> 
> 标签：c#, javascript, jquery, asp.net-mvc-4

我意识到对于 .NET 和 MVC 的不同语言/版本，这已经被问过很多次了。

使用 MVC4，目前注册 Javascript 启动脚本的公认方法是什么？我想在页面完成加载后触发脚本，是否有内置方法或者我应该只使用 jQuery 来完成它？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-04T00:10:48.567

“注册启动脚本”是源自ASP.Net WebForms的一个概念，MVC没有这个概念。要引用要在多个页面上使用的“全局”脚本文件，请将脚本引用 ( `<script></script>`) 添加到*主视图*。要引用在单个页面/视图上使用的脚本，请在视图本身中引用它。

MVC 促进*关注点分离，*使您能够*将*视图逻辑（脚本）与域/路由逻辑分离。因此，将 JavaScript（一种客户端技术）与服务器端代码混合即使没有消除，也会得到缓解。

* * *

ASP.Net 4 确实具有*[脚本捆绑和缩小](http://www.codeproject.com/Tips/389545/ASP-NET-MVC4-Bundling-and-Minification)*功能，这将使脚本引用的捆绑和缩小能够更好地管理应用程序具有大量脚本文件的场景。

[http://www.beletsky.net/2012/04/new-in-aspnet-mvc4-bundling-and.html](http://www.beletsky.net/2012/04/new-in-aspnet-mvc4-bundling-and.html)

# c++ - 防止函数返回的指针超出范围？

> ID：11320833
> 
> 赞同：1
> 
> 时间：2012-07-04T00:06:38.157
> 
> 标签：c++

我正在使用 opendir（它返回 dir *）打开一个目录，并希望在我的对象中不断地保留和重用该目录。我最初在我的构造函数中打开了目录并将指针存储为私有变量，这显然失败了，因为一旦构造函数结束，指针就超出了范围并且内存被释放。

我的问题是，我如何保留目录引用，以便我的班级可以一遍又一遍地使用它，而无需每次都重新打开它？我尝试将其复制到 DIR 类型，但我收到了 DIR 未完全定义的投诉。我怀疑即使我能弄清楚 DIR 的定义位置，它无论如何都会有一个复制构造函数。必须有另一种方法来保持它在范围内？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T02:35:49.107

在 C++ 中，对象超出范围的唯一方法是使其成为局部变量。我猜你做了这样的事情：

```
Object *objMemberPointer;

Constructor()
{
    Object obj;
    objMemberPointer = &obj;
} <- obj goes out of scope here and deallocates your object. 
```

# mysql - 没有计数功能的MySQL计数？

> ID：11320838
> 
> 赞同：0
> 
> 时间：2012-07-04T00:07:11.223
> 
> 标签：mysql, count

数据库：`tennis`，即网球俱乐部。

讨论的表：`penalties`

列：`paymentno`, `amount`,`playerno`

任务：

*   将罚款金额分类为高、中、低 - 完成！
*   然后，计算低类别的处罚数量 - 需要帮助。

如何在不使用计数功能的情况下完成第 2 部分？这可能吗 ？

1的SQL查询：

```
use tennis;

select tennis.penalties.paymentno, 
       tennis.penalties.amount, 
       tennis.penalties.playerno,
       case 
         when playerno >= 0 and  playerno <= 40 then 'low'
         when playerno > 40 and  playerno < 80 then 'medium'
         when playerno > 80 then 'high'
       end
from tennis.penalties; 
```

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T00:19:53.760

```
SUM(playerno >= 0 and playerno <= 40) AS count_penalties_in_low 
```

或者

```
SUM(CASE WHEN playerno >= 0 and playerno <= 40 THEN 1 ELSE 0 END) AS count_penalties_in_low 
```

所以从技术上讲，你总结了 1，实际上等于计数

PS：

```
playerno >= 0 and  playerno <= 40 
```

可以改写为

```
playerno BETWEEN 0 AND 40 
```

PP:

`playerno`= 80 不被任何条件覆盖

PPPS：我会这样写这个案例：

```
 case 
     when playerno <= 40 then 'low'
     when playerno <= 80 then 'medium'
                         else 'high'
   end 
```

PPPPS：没有功能的解决方案（概念）

```
SELECT @I:=@I+1, other_columns FROM table, (SELECT @I:=0) x 
```

并拥有@I，您可以计算您想要的

但在这种情况下这是一个糟糕的解决方案

# android - Android Log 类：它不安全吗？

> ID：11320840
> 
> 赞同：0
> 
> 时间：2012-07-04T00:07:25.597
> 
> 标签：android, security, logging

我在一些地方听说 Android Log 类可能会引发诸如反汇编程序之类的安全问题。这有多真实？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-04T00:29:03.617

您不应在`LogCat`. JellyBean 的另一个改进是其他应用程序现在无法`LogCat`从您的应用程序中看到 's。您应该观看此内容以了解[Android 应用程序中的安全性](http://www.youtube.com/watch?v=RPJENzweI-A)。

# visual-studio-2010 - 在 Visual Studio 中更改选定文本的文本颜色

> ID：11320853
> 
> 赞同：9
> 
> 时间：2012-07-04T00:08:34.833
> 
> 标签：visual-studio-2010, visual-studio, user-interface, textcolor

> **可能重复：**
> [我无法在 Visual Studio 2010 中编辑选定的文本前景色。有人知道该怎么做吗？](https://stackoverflow.com/questions/2256942/i-cant-edit-selected-text-foreground-color-in-visual-studio-2010-anyone-know-h)

在**Options->Environment->Fonts and Colors**对话框中，您可以`Selected Text`在 Display Items 列表框中进行选择，但这仅允许您更改 Item 背景属性。

如何更改文本颜色，例如，当我选择一个项目时，我可以在蓝色背景上有白色文本？此外，有没有办法将文本加粗（该`Bold`框也被禁用）。

注意：[这是](https://stackoverflow.com/q/2790179/13295)询问背景颜色变化的问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-14T12:43:23.917

VS2010 编辑器中的前景色不是在一个地方设置的，而是在选项表单中的多个地方设置的。如果您安装了 Resharper，它还会设置一些前台属性。VS2010 这样做的原因是允许前景中的单个项目（单词）根据它们的类型（例如注释、值类型、枚举等）表达不同的颜色，即使它们被选中。换句话说，VS2010 将优先级应用于这些特定类型的前景色，而不是通用的选定文本颜色格式。

例如，当您查看字体和颜色对话框时，您会注意到用户类型的条目。在我的 VS2010 上，它的 RGB 值为 RGB(43, 145, 175)，看起来像蓝绿色。如果我将该颜色更改为红色，我的编辑器前景色上的用户类型将更改为红色，并且即使在选择区域时仍保持红色。

在某些情况下，VS2010 会覆盖前景色，例如对一行应用断点。在我的 VS2010 上，在编辑模式下启用的断点具有白色的前景色，无论行中的术语如何。

要回答您如何更改所有选定文本的前景色的问题，VS2010 不支持此功能。

[我写了一个 VS2010 扩展，如此处](http://msdn.microsoft.com/en-us/library/ee818135)所述。我按原样使用示例代码并添加了以下行：

```
 selectedText[EditorFormatDefinition.ForegroundBrushId] = Brushes.Green;
        formatMap.SetProperties("Selected Text", selectedText); 
```

...但这并没有将所选文本的前景色更改为绿色。它保持黑色。这可能是由于 VS2010 WPF 编辑器对每种格式和一种或多种其他格式使用优先顺序来覆盖选定的文本前景色。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-09T02:15:23.373

您是否尝试在“字体和颜色”窗口中的“突出显示参考”选项上设置颜色？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-09T02:12:18.450

`Selected Text`前景属性没有单独的设置，它使用`Plain Text`选项表单中的前景设置，但这仅适用于普通文本，属性、注释和其他特殊颜色文本的前景色将保持不变，有没有可用于所有项目的覆盖前景色。

# wpf - DragMove WPF 不工作

> ID：11320855
> 
> 赞同：0
> 
> 时间：2012-07-04T00:08:58.227
> 
> 标签：wpf, menu, drag

我的方法有一个小问题`DragMove()`。我想在`MouseLeftButtonDown`处理菜单上的事件时调用它（简单地说，我想通过菜单拖动窗口）。

我的 XAML：

```
 <Window x:Class="LoginForm.RidicWindow"
    ...namespaces...
    Title="RidicWindow" Height="600" Width="800" WindowStyle="None" ResizeMode="NoResize" BorderBrush="#48067f" BorderThickness="2" Icon="img/EvidenceLogo.png">

some XAML
        <Menu x:Name="Menu" Grid.Column="0" Grid.Row="0" MouseLeftButtonDown="Drag">
 ...rest of doc 
```

以及相应的 C# 代码：

```
private void Drag(object sender, MouseButtonEventArgs e)
    {
        base.OnMouseLeftButtonDown(e);
        this.DragMove();
    } 
```

它不起作用。我不知道为什么。Menu 是 的后代`UIElement`，所以在我看来一切都还可以。

我相信这很简单，我在代码中有一个愚蠢的错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-19T17:31:23.013

Menu 本身使用 MouseLeftButtonDown 事件。因此，不会调用任何事件处理程序。只会引发 PreviewMouseLeftButtonDown。但是在此事件中调用 DragMove() 会阻止正常的菜单功能。在 DragMove() 内部发送了一条 WM_LBUTTONUP 消息，在此方法返回后，似乎根本没有按下任何按钮。

解决方案可以是：将菜单放入具有两列的网格中，一列自动，一列 *（或省略宽度）。给网格一个背景，否则它不会接收到鼠标事件

```
<Grid MouseLeftButtonDown="handler">
  <Grid.Background>
    <SolidColorBrush Color="{DynamicResource {x:Static SystemColors.MenuBarColorKey}}" />
  </Grid.Background>
  <Grid.ColumnDefinitions>
    <ColumnDefinition Width="Auto" />
    <ColumnDefinition />
  </Grid.ColumnDefinitions>

  <Menu IsMainMenu="True">...</Menu>
</Grid> 
```

在左侧，菜单消耗点击，在右侧，处理程序将被调用。

# c# - WCF 服务调用

> ID：11320856
> 
> 赞同：2
> 
> 时间：2012-07-04T00:08:59.900
> 
> 标签：c#, asp.net, wcf

我有一个 WCF 服务，它将网络上的计算机 ID、ID 作为输入参数，并在数据库中保存过去 12 小时的计算机统计信息[比如计算机被锁定、活动、空闲等的时间。]。

另外我有一个网站，我可以在其中设置一些计算机在某个时间 t 的调度以获取统计信息[如上所述的过去 12 小时]。这个调度信息[计算机是和时间]将被保存到数据库中。

**现在的问题是如何使用 WCF 服务来确保它在特定的调度时间运行，以及如何在调用 WCF 并生成统计信息时在网站上显示计算机统计信息。** 如果我使用窗口服务调用 WCF 服务，我将如何确保它在预定时间运行，以及如何通知网站已生成统计信息。

任何帮助，将不胜感激。

干杯!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T00:32:03.677

设置一个计划任务，该任务将调用您想要使用[cUrl 之类的东西运行的 WCF 服务方法](http://curl.haxx.se/docs/manual.html)

我相信网站需要刷新，以便它可以在 WCF 方法执行后选择数据，这样您就可以再次使用 cUrl 进行网页调用

# ios - iOS 上的圆形头像图像和性能问题

> ID：11320858
> 
> 赞同：3
> 
> 时间：2012-07-04T00:09:07.460
> 
> 标签：ios, performance, uiimage, drawrect

有没有办法在不执行以下任何操作的情况下绘制圆形 UIImages？

1.  混合（Core Animation Instruments 中的红色）
2.  离屏渲染（Core Animation Instruments 中的黄色）
3.  绘制矩形

我试过了

1.  带有剪切路径的drawRect。这太慢了。（见：http: [//developer.apple.com/library/ios/#qa/qa1708/_index.html](http://developer.apple.com/library/ios/#qa/qa1708/_index.html)）
2.  带有 maskLayer 的 CALayer 内容。这引入了离屏渲染。
3.  UIImageView 和设置cornerRadius 和maskToBounds。这与＃2具有相同的效果。

我最后的手段是直接修改图像。有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T01:48:56.727

我使用[blog.sallarp.com 的圆角算法](http://blog.sallarp.com/iphone-uiimage-round-corners/)的变体。我将我的修改为仅圆某些角落，它是无缝集成的类别，但该链接为您提供了基本概念。我认为这可能符合“屏幕外渲染”的条件，这是您拒绝的技术之一，但我并不完全确定。我从未见过任何可观察到的性能问题，但也许您遇到了一些特殊情况。

你能在你的图像视图上覆盖一个只有角落的图像视图，以呈现圆角的外观吗？

或者，如果您担心圆角会导致性能下降，为什么不让您的应用程序保存带有圆角的图像副本，这样您只能在第一次获得性能？这相当于您的“直接修改图像”的概念，但要及时进行。

**更新：**

底线，我不知道任何其他解决方案（缺少我笨拙的想法，下面的第 2 点）。但我做了一些实验（因为我正在处理类似的问题）并得出以下结论：

1.  如果您在 3GS 或更高版本的设备上具有圆角性能，则问题可能不在圆角上。我发现虽然它对 3G 上的 UI 产生了重大影响，但在 3GS 上几乎不明显，而在后来的设备上则难以察觉。如果您从圆角看到性能问题，请确保是圆角而不是其他问题。我发现，如果我对以前缓存的图像进行即时舍入，舍入的影响可以忽略不计。（当我在缓存之前进行四舍五入时，UI 就像丝绸一样光滑。）

2.  遮罩的替代方法是创建一个反转圆角的图像（即，它与角落中的背景匹配，在您希望图像显示的地方透明），然后将此图像放在 tableviewcell 的图像前面. 我发现，要让它工作，我必须使用自定义单元格（例如，创建我自己的主图像视图控件、我自己的标签，加上这个角遮罩图像视图控件），但它肯定比即时更好调用圆角算法。如果您试图在分组表中圆角，这可能效果不佳，但如果您只是想要圆角的外观而不实际圆角，这是一个可爱的小技巧。

3.  如果您因为使用分组表格视图而圆角并且您不喜欢图像溢出圆角，您可以简单地将第一行图像的左上角和最后一个图像的左下角. 这将减少圆角逻辑的调用。它看起来也不错。

4.  我知道你没有问过这个问题，但是关于 tableviews 中图像的其他可能的性能问题包括：

    *   如果您使用类似`imageWithContentsOfFile`（不缓存） in 的东西`cellForRowAtIndexPath`，您肯定会看到性能问题。如果您不能利用`imageNamed`缓存（无论如何有些人抱怨它），您可以自己缓存您的图像，无论是即时缓存还是提前在辅助线程上预加载它们。如果您的 tableview 引用了以前加载的图像并且您会看到巨大的性能改进，那么圆角可能会或可能不会仍然是一个问题。

    *   其他性能问题的来源包括使用的图像不是为您的 tableview 的 imageview 优化大小的。大图像对性能产生了巨大影响。

5.  底线，

    *   在你在这里自杀之前，确保舍入是唯一的性能问题。如果您在当代硬件上看到问题，则尤其如此，因为根据我的经验，影响可以忽略不计。另外，如果有一个更广泛的解决方案会更好，那么在这个问题上浪费太多睡眠将是一种耻辱。使用不是尺寸优化的缩略图的图像、缓存图像失败等都会对性能产生巨大影响。

    *   如果可能的话，提前把图像的角落弄圆，UI 会是最好的，并且视图控制器的代码会很好很简单。

    *   如果您不能提前做到这一点（例如，因为您正在实时下载图像），您可以尝试角落遮蔽图像技巧，但这仅在某些情况下有效（尽管非分组的 tableview 是其中之一）。

    *   如果您必须在 UI 进行时进行圆角，请在单独的队列中进行圆角并且不要阻塞 UI。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-17T00:06:59.030

这就是我所做的，我通常对它的表现感到满意：

```
UIImageView *iv=[[UIImageView alloc] initWithImage:[UIImage imageNamed:@"769-male"]];
UIGraphicsBeginImageContextWithOptions(iv.bounds.size, NO, [UIScreen mainScreen].scale);
[[UIBezierPath bezierPathWithRoundedRect:v.bounds cornerRadius:s] addClip];
[image drawInRect:v.bounds];
v.image = UIGraphicsGetImageFromCurrentImageContext();
UIGraphicsEndImageContext(); 
```

# c# - 显示新表单时控件为白色

> ID：11320859
> 
> 赞同：2
> 
> 时间：2012-07-04T00:09:12.583
> 
> 标签：c#, .net, forms, controls, paint

因为这是一个相当大的项目，而且我经常需要从一个类中访问其他形式的对象，所以我首先在我的 program.cs 类型的“MainForm”类中创建一个静态变量，这是一个 Windows 窗体。

从我的 DataManger.cs 类中，我实例化对象“Program.MainFormObj = new MainForm()”，然后调用 Show 方法以显示我的表单。看起来窗体的 Paint 事件没有完成，但它确实在绘制一些控件时启动。大概是因为主线程（这一切都在一个主线程上运行）被下一条语句“占用”。我想，不管已知问题如何，我都会使用 Application.DoEvents() 来临时解决这个问题。正如我想象的那样，它起作用了，但只是在一定程度上。如果我使用像 MessageBox.Show() 这样的阻塞方法，我可以在后台查看我完全完美的表单，但只要我按下“确定”并且代码继续，整个应用程序就会退出。

我真的被困住了。尽管在这里和使用谷歌进行了广泛的搜索，但我找不到合适的答案。我做了这个线程：[Form.Show() 没有显示它的子控件](https://stackoverflow.com/questions/2428530/form-show-is-not-showing-its-child-controls)，但给定的解决方案不适合我的解决方案。非常感谢任何帮助，谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T00:14:18.913

如果这是一个大型项目，请立即投入时间对其进行重构。

*   考虑一个 MVC 模式。您可以[使用 WinForms 来做些什么](https://stackoverflow.com/questions/2406/looking-for-a-mvc-sample-for-winforms)，而不仅仅是更新的 UI 技术。
*   如果你不选择 WinForms，至少要分离 UI 和数据（[数据绑定](http://msdn.microsoft.com/en-us/library/ef2xyb33.aspx)是你的朋友）。
*   当不同的表单共享通用功能时，构建可重用的组件。

与 WinForms 的工作方式作斗争在中期将比现在投入时间做正确的事情要昂贵得多。

如果您对该技术有任何选择，请考虑 WPF。WPF 有一个学习曲线，但现在可能值得投资于该学习。

**更新**

根据您的代码示例，我看到您可能正在主 UI 线程以外的线程上创建一些表单。虽然这是允许的，但它会创建非常混乱的代码，因为表单只能从**创建它们的线程**更新。

最简单的破解方法可能是更新`HandleIncomingData`以调用`Show()`主 UI 线程上的调用。

应该有一种方法可以从静态方法中干净地做到这一点，如下所述：

[https://stackoverflow.com/a/505361/141172](https://stackoverflow.com/a/505361/141172)

但是，当我尝试这样做时，我发现它`SynchronizationContext`始终为空。我确定我只是少了一步。

我能够通过滥用`LoginForm`（假设，也许是错误的，该表单始终可用。如果没有，也许创建一个仅用于线程编组的特殊表单）。

黑客看起来像这样：

```
Program.MainForm = new MainForm();
try
{

    MessageBox.Show("Login Success.", "Login", MessageBoxButtons.OK, MessageBoxIcon.Information);

            // Abusing LoginForm's Invoke method.  Code assumes LoginForm is always available.
    Program.LoginForm.Invoke((MethodInvoker)delegate
    {
        Program.MainForm.Show();
    });

}
catch (Exception Ex)
{
    MessageBox.Show(Ex.ToString()); //Debuging purposes
} 
```

顺便说一句，有一个出色的扩展方法可以让从非 UI 线程调用 UI 代码变得轻而易举：

[https://stackoverflow.com/a/3588137/141172](https://stackoverflow.com/a/3588137/141172)

# html - 如何使用 CSS 实现“淘汰”效果？

> ID：11320866
> 
> 赞同：8
> 
> 时间：2012-07-04T00:10:23.950
> 
> 标签：html, css

**更新 -**很确定我想通了。代码有点长，但我在这里放了一个页面，以便您查看源代码：http: [//www.sorryhumans.com/knockout-header](http://www.sorryhumans.com/knockout-header)

该概念基于：[http](http://algemeenbekend.nl/misc/challenge_gerben_v2.html) ://algemeenbekend.nl/misc/challenge_gerben_v2.html ，然后根据我的需要进行了调整。

标题响应并被淘汰。（请忽略糟糕的 1 分钟响应式 bg 图像实现！）。这个实现也没有使用任何 CSS3，所以我想兼容性不会有很多问题。

我发现的唯一问题是，当 Chrome 中的浏览器宽度为奇数（例如 1393 像素）时，右侧流体列和主中心列之间存在 1 像素的间隙。在最新版本的 Firefox、Internet Explorer 或宽度为偶数时（例如 Chrome 中的 1394px），我没有看到此问题。有任何想法吗？

**原始问题：** 我正在尝试编写我设计的标题，但无法弄清楚如何获得我正在寻找的效果。请查看所附图片（不，这实际上不是我正在做的事情：）只是一个例子！）

![示例图片](../Images/f70b4a64a4ba84938ef2a7cbbb9b64ed.png)

该照片是全幅响应式照片。标题是全角的，但其内容位于不超过任意大小（由黑线显示）的响应式网格上，但可以按比例缩小。我可以完成所有这些，但我无法弄清楚如何使标题栏在徽标所在的位置透明。换句话说，我不想将徽标放在栏的顶部，而是想从标题中“敲掉它”。

这甚至可能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-04T00:32:41.020

没有对剔除效果的固有支持，因此您必须将文本作为图像的一部分。

最简单的方法是让剔除效果背后的背景成为图像的实体部分。`.png`您可以在想要剔除效果的地方创建具有纯色背景和透明度的，并使用 css`opacity`使整个标题部分透明。您将需要设置包含多个部分的标题，以便非图像部分（即黑条之外）具有背景色，而带有图像的部分则没有。

非常粗略：

```
<div id="outerHeaderWithOpacity">
  <div class="hasBackground">Left side, will stretch</div>
  <div class="noBackground">Image(s) go here</div>
  <div class="hasBackground">As many sets as you need</div>
  <div class="noBackground">Image(s) go here</div>
  <div class="hasBackground">Right side, will stretch</div>
</div> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-04T02:04:55.207

[http://jsfiddle.net/GZ8Xv/](http://jsfiddle.net/GZ8Xv/)

不是最漂亮的解决方案，而是使用实验性的 css3 flexbox：（*带有`display: table`后备）*

```
<div class="wrapper">
    <div class="left"><br /></div>
    <div class="middle"><br /></div>
    <div class="right"><br /></div>
</div> 
```

```
.left, .right
{
    height:100%;
    border: 1px solid black;
    display:table-cell;
    display: -webkit-flexbox;
    display: -moz-flexbox;
    display: -ms-flexbox;
    display: -o-flexbox;
    -webkit-flex: 1;
}

.middle
{
    display: table-cell;
    display: -webkit-flexbox;
    width: 500px;
    height:100%;
    border: 1px solid blue
}

.wrapper
{
    display: table;

    display: -webkit-flexbox;
    display: -moz-flexbox;
    display: -ms-flexbox;
    display: -o-flexbox;
    -webkit-box-orient: horizontal;
    -moz-box-orient: horizontal;
    -ms-box-orient: horizontal;
    -o-box-orient: horizontal;
    width: 100%;
    height: 100px;
} 
```

**请注意：** flexbox w3c 规范仍在不断变化，可能会第三次更改。我只在 IE9（IE9 和 IE8 模式下。不适用于 IE7 模式）和 Chrome 20 和 22

一些小改动： http: [//jsfiddle.net/GZ8Xv/2/](http://jsfiddle.net/GZ8Xv/2/)，你的 5 div 布局没有 javascript。

# java - Java 自定义 TreeModel：使用 treeStructureChanged()

> ID：11320868
> 
> 赞同：0
> 
> 时间：2012-07-04T00:10:47.110
> 
> 标签：java, jtree, treemodel

我已经为我的 Java 应用程序构建了一个自定义 TreeModel，并且作为其中的一部分，我设置了我的模型来触发[TreeModelListener](http://docs.oracle.com/javase/6/docs/api/javax/swing/event/TreeModelListener.html)事件。文档说当树从节点向下发生巨大变化时调用 treeStructureChanged() 但我不清楚这对实际使用它意味着什么。我的 TreeModel 什么时候应该调用 treeStructureChanged()？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T00:20:11.830

取自[此链接](http://java.sun.com/products/jfc/tsc/articles/jtree/)（网站已更改，链接现在错误）

> 为了通知侦听器多个插入和删除，或识别树中多个级别的更改，您使用 treeStructureChanged() 并使用简单的无子 TreeModelEvent。在这种情况下，路径参数指定树中未更改的节点，并且该节点下具有所有其他更改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T00:22:28.687

当您实现 TreeModelListener 时，回调（包括 treeStructureChanged）有助于检测树何时发生变化。在多次插入/删除或树中多个级别发生更改的情况下调用 treeStructureChanged 回调。希望能帮助到你

# opencart - Opencart如何将产品选项添加到选项卡中

> ID：11320873
> 
> 赞同：0
> 
> 时间：2012-07-04T00:11:20.727
> 
> 标签：opencart

Opencart 1.5.3。我试图让页面上的产品选项显示在选项卡内。如果我使用下面的代码，我不会收到任何错误并且看起来很好，但是单击添加到购物车没有任何作用。如果代码在选项卡之外，它可以正常工作。我不确定我做错了什么。

```
<div id="tabs_container">
<ul id="tabs">
<li class="active"><a href="#tab1">tab1</a></li>
<li><a href="#tab2">tab2</a></li>
<li><a href="#tab3">tab3</a></li>
<li><a href="#tab4">tab4</a></li>
</ul>
</div>

<div id="tabs_content_container">
<div id="tab1" class="tab_content" style="display:block"></div><!--tab1-->
<div id="tab2" class="tab_content"></div><!--tab2-->
<div id="tab3" class="tab_content"></div><!--tab3-->
<div id="tab4" class="tab_content">

<?php if ($options) { ?>
      <div class="options">
        <h2><?php echo $text_option; ?></h2>
        <br />
        <?php foreach ($options as $option) { ?>
        <?php if ($option['type'] == 'select') { ?>
        <div id="option-<?php echo $option['product_option_id']; ?>" class="option">
          <?php if ($option['required']) { ?>
          <span class="required">*</span>
          <?php } ?>
          <b><?php echo $option['name']; ?>:</b><br />
          <select name="option[<?php echo $option['product_option_id']; ?>]">
            <option value=""><?php echo $text_select; ?></option>
            <?php foreach ($option['option_value'] as $option_value) { ?>
            <option value="<?php echo $option_value['product_option_value_id']; ?>"><?php echo $option_value['name']; ?>
            <?php if ($option_value['price']) { ?>
            (<?php echo $option_value['price_prefix']; ?><?php echo $option_value['price']; ?>)
            <?php } ?>
            </option>
            <?php } ?>
          </select>
        </div>
        <br />
        <?php } ?>
        <?php } ?>
      </div>

</div><!--tab4-->
</div><!--tabs_content_container--> 
```

这是 Opencart 使用的表单提交的 javascript。

```
<script type="text/javascript"><!--
    $('#button-cart').bind('click', function() {
        $.ajax({
            url: 'index.php?route=checkout/cart/add',
            type: 'post',
            data: $('.product-info input[type=\'text\'], .product-info input[type=\'hidden\'], .product-info input[type=\'radio\']:checked, .product-info input[type=\'checkbox\']:checked, .product-info select, .product-info textarea'),
            dataType: 'json',
            success: function(json) {
                $('.success, .warning, .attention, information, .error').remove();

                if (json['error']) {
                    if (json['error']['option']) {
                        for (i in json['error']['option']) {
                            $('#option-' + i).after('<span class="error">' + json['error']['option'][i] + '</span>');
                        }
                    }
                } 

                if (json['success']) {
                    $('#notification').html('<div class="success" style="display: none;">' + json['success'] + '<img src="catalog/view/theme/default/image/close.png" alt="" class="close" /></div>');
                    $('.success').fadeIn('slow');
                    $('#cart-total').html(json['total']);
                    $('html, body').animate({ scrollTop: 0 }, 'slow'); 
                }   
            }
        });
    });
    //--></script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T12:16:29.047

问题是结束`</form>`标签不会在标签内容周围。你需要`</form>`在你的内容之后移动，应该这样做

# desire2learn - 如何使用 Desire2learn Valence API 为学生注册课程？

> ID：11320880
> 
> 赞同：0
> 
> 时间：2012-07-04T00:12:14.537
> 
> 标签：desire2learn

在尝试自动化工作流时，如何使用 D2L REST API 为学生注册课程？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T00:14:11.647

D2L 处理的注册是用户、角色和课程或组织结构的元组（orgunitid 表示课程*或*结构元素，如部门或教师）。[创建这些注册](http://docs.valence.desire2learn.com/res/enroll.html#post--d2l-api-lp-%28D2LVERSION-version%29-enrollments-)的调用允许您指定所有这些值，而其他调用允许检索用户或课程的 ID。

大多数情况下，开发人员需要按课程代码进行搜索，但这在 9.4.1 或 10.0 版本上是不可能的，因此您需要在调用代码中从课程代码中找到 d2lid（此[课程代码搜索在其他问题中介绍以及](https://stackoverflow.com/questions/11125532/desire2learn-valence-course-getting-orgunitid-from-offering-code)）。

# cocoa - 如何使`NSView`子视图`QLPreviewView`中的文本可选择？

> ID：11320884
> 
> 赞同：2
> 
> 时间：2012-07-04T00:12:38.880
> 
> 标签：cocoa, quicklook, selectable

Apple 在 10.7 Lion 中引入`QLPreviewView`了允许您在自己的应用程序中嵌入快速查看视图。但是，默认情况下似乎不允许文本选择。我发现一个提示可以让你在 macworld 上选择全局 quicklook 预览，（[http://www.macworld.com/article/1164668/select_and_copy_text_within_quick_look_previews.html](http://www.macworld.com/article/1164668/select_and_copy_text_within_quick_look_previews.html)），但我真正想做的是让嵌入预览视图可选。我在标题上使用了类转储，`QuicklookUI.framework`但找不到任何有用的东西。有谁知道如何使嵌入的`QLPreviewView`文本可选择？（如下例所示）

![在此处输入图像描述](../Images/96f54e7b5da29ac7bbe2300f38324b52.png)

# c++ - SFINAE：编译器不选择专门的模板类

> ID：11320887
> 
> 赞同：9
> 
> 时间：2012-07-04T00:13:45.230
> 
> 标签：c++, templates, sfinae

我有一个[SFINAE](http://en.wikipedia.org/wiki/Substitution_failure_is_not_an_error)问题：

在下面的代码中，我希望 C++ 编译器选择专用函子并打印“special”，但它正在打印“general”。

```
#include <iostream>
#include <vector>

template<class T, class V = void>
struct Functor {
  void operator()() const {
    std::cerr << "general" << std::endl;
  }
};

template<class T>
struct Functor<T, typename T::Vec> {
  void operator()() const {
    std::cerr << "special" << std::endl;
  }
};

struct Foo {
  typedef std::vector<int> Vec;
};

int main() {
  Functor<Foo> ac;
  ac();
} 
```

如何修复它以便自动使用专用结构？请注意，我不想直接将`Functor`struct专门化`Foo`，但我想将其专门化为具有类型的所有类型`Vec`。

PS：我正在使用 g++ 4.4.4

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-04T02:26:58.113

很抱歉在最后一个答案中误导了您，我想了一下会更简单。所以我会尝试在这里提供一个完整的解决方案。解决此类问题的一般方法是编写一个*特征*帮助器模板并将其与`enable_if`（C++11、boost 或手动实现）一起使用来决定类专业化：

**特征**

一个简单的方法，不一定是最好的，但写起来很简单：

```
template <typename T>
struct has_nested_Vec {
    typedef char yes;
    typedef char (&no)[2];
    template <typename U>
    static yes test( typename U::Vec* p );
    template <typename U>
    static no test( ... );

    static const bool value = sizeof( test<T>(0) ) == sizeof(yes);
}; 
```

方法很简单，提供两个模板函数，返回不同大小的类型。其中一个采用嵌套`Vec`类型，另一个采用省略号。对于所有具有嵌套`Vec`的类型，第一个重载是更好的匹配（省略号是任何类型的最差匹配）。对于那些没有嵌套`Vec`SFINAE 的类型将丢弃该重载，剩下的唯一选项将是省略号。所以现在我们有一个特征来询问任何类型是否有嵌套`Vec`类型。

**启用如果**

您可以从任何库中使用它，也可以自己滚动，这非常简单：

```
template <bool state, typename T = void>
struct enable_if {};

template <typename T>
struct enable_if<true,T> {
    typedef T type;
}; 
```

当第一个参数是`false`时，基本模板是唯一的选项，并且没有嵌套的`type`，如果条件是`true`，则`enable_if`有一个`type`可以与 SFINAE 一起使用的嵌套。

**执行**

现在我们需要提供模板和专门化，将 SFINAE 仅用于那些带有嵌套的类型`Vec`：

```
template<class T, class V = void>
struct Functor {
    void operator()() const {
        std::cerr << "general" << std::endl;
    }
};
template<class T>
struct Functor<T, typename enable_if<has_nested_Vec<T>::value>::type > {
    void operator()() const {
        std::cerr << "special" << std::endl;
    }
}; 
```

每当我们`Functor`用一个类型实例化时，编译器都会尝试使用特化，这将反过来实例化`has_nested_Vec`并获得一个真值，传递给`enable_if`. 对于那些值为`false`,`enable_if`的类型没有嵌套`type`类型，因此 SFINAE 中将丢弃特化并使用基本模板。

**您的特殊情况**

在您的特定情况下，您似乎不需要专门化整个类型而只需要专门化运算符，您可以将三个元素混合为一个元素：a`Functor`根据存在性分派到两个内部模板化函数之一的`Vec`，消除对`enable_if`和特征类的需要：

```
template <typename T>
class Functor {
   template <typename U>
   void op_impl( typename U::Vec* p ) const {
      std::cout << "specialized";
   }
   template <typename U>
   void op_impl( ... ) const {
      std::cout << "general";
   }
public:
   void operator()() const {
      op_impl<T>(0);
   }
}; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-12-04T23:38:21.357

尽管这是一个老问题，但我认为仍然值得提供更多替代方案来快速修复原始代码。

基本上，问题不在于 SFINAE 的使用（实际上那部分很好），而在于主模板 ( `void`) 中的默认参数与部分专业化 ( `typename T::Vec`) 中提供的参数的匹配。由于主模板中的默认参数，`Functor<Foo>`实际上意味着`Functor<Foo, void>`. 当编译器尝试使用特化来实例化它时，它会尝试将两个参数与特化中的参数进行匹配并且失败，因为`void`无法替换`std::vector<int>`. 然后它回退到使用主模板进行实例化。

因此，假设您所有的`Vec`s 都是`std::vector<int>`s，最快的解决方法是替换该行

```
template<class T, class V = void> 
```

有了这个

```
template<class T, class E = std::vector<int>> 
```

现在将使用专业化，因为参数将匹配。简单，但过于局限。显然，我们需要更好地控制特化中参数的类型，以使其与我们可以在主模板中指定为默认参数的内容相匹配。一种不需要定义新特征的快速解决方案是：

```
#include <iostream>
#include <vector>
#include <type_traits>

template<class T, class E = std::true_type>
struct Functor {
  void operator()() const {
    std::cerr << "general" << std::endl;
  }
};

template<class T>
struct Functor<T, typename std::is_reference<typename T::Vec&>::type> {
  void operator()() const {
    std::cerr << "special" << std::endl;
  }
};

struct Foo {
  typedef std::vector<int> Vec;
};

int main() {
  Functor<Foo> ac;
  ac();
} 
```

这适用于任何`Vec`在这里可能有意义的类型，例如，包括基本类型和数组，以及指向它们的引用或指针。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-11-27T20:39:25.193

检测成员类型是否存在的另一种方法是使用`void_t`. 由于有效的部分特化比一般实现更可取，只要它们与默认参数匹配，我们想要一个在有效时评估为的类型`void`，并且仅在指定成员存在时才有效；这种类型通常（并且，从 C++17 开始，是规范的）称为`void_t`.

```
template<class...>
using void_t = void; 
```

如果您的编译器不能正确支持它（在早期的 C++14 编译器中，别名模板中未使用的参数不能保证确保 SFINAE，违反上述规定`void_t`），可以使用解决方法。

```
template<typename... Ts> struct make_void { typedef void type; };
template<typename... Ts> using void_t = typename make_void<Ts...>::type; 
```

从 C++17 开始，`void_t`可在实用程序库中使用`type_traits`.

```
#include <iostream>
#include <vector>
#include <type_traits> // For void_t.

template<class T, class V = void>
struct Functor {
  void operator()() const {
    std::cerr << "general" << std::endl;
  }
};

// Use void_t here.
template<class T>
struct Functor<T, std::void_t<typename T::Vec>> {
  void operator()() const {
    std::cerr << "special" << std::endl;
  }
};

struct Foo {
  typedef std::vector<int> Vec;
};

int main() {
  Functor<Foo> ac;
  ac();
} 
```

有了这个，输出`special`就像预期的那样。

* * *

在这种情况下，由于我们要检查成员类型是否存在，所以过程非常简单；它可以在没有表达式 SFINAE 或`type_traits`库的情况下完成，允许我们在必要时重写检查以使用 C++03 工具。

```
// void_t:
// Place above Functor's definition.
template<typename T> struct void_t { typedef void type; };

// ...

template<class T>
struct Functor<T, typename void_t<typename T::Vec>::type> {
  void operator()() const {
    std::cerr << "special" << std::endl;
  }
}; 
```

据我所知，这应该适用于大多数（如果不是全部）支持 SFINAE 的 C++03、C++11、C++14 或 C++1z 兼容的编译器。在处理稍微落后于标准的编译器时，或者在为还没有 C++11 兼容编译器的平台进行编译时，这可能很有用。

* * *

有关 的详细信息`void_t`，请参阅[cppreference](http://en.cppreference.com/w/cpp/types/void_t)。

# qt - 未使用 QGLBuffer 更新 VBO

> ID：11320890
> 
> 赞同：1
> 
> 时间：2012-07-04T00:14:11.047
> 
> 标签：qt, opengl

我正在使用 OpenGL 创建一个应用程序，它在三维空间中绘制一些四边形平面。一切正常，直到我开始为每个平面设置不同的顶点坐标。现在，当我创建一个具有新坐标的平面时，它的绘制就像以前创建的平面一样。换句话说，它的新坐标正在被使用。

我正在使用带有 Qt 库的 OpenGL。

```
void Plane::initBuffers()
{
    mVertexVBO.create(); //QGLBuffer
    mIndexVBO.create();  //QGLBuffer

    mVertexVBO.bind();
    mIndexVBO.bind();

    mVertexVBO.setUsagePattern(QGLBuffer::StaticDraw);
    mIndexVBO.setUsagePattern(QGLBuffer::StaticDraw);

    /* mVertices and mIndices are a QVarLengthArray object */
    Vertex* aVerts = mVertices.data();
    for(int i=0; i<4; ++i)
    {
        qDebug() << aVerts[i].x << " " << aVerts[i].y << " " << aVerts[i].z;
    }
    qDebug() << " --- ";

    mVertexVBO.allocate(mVertices.data(), sizeof(Vertex)*4);
    mIndexVBO.allocate(mIndices.data(), sizeof(GLuint)*6);
} 
```

我创建了 2 架飞机。默认情况下，它们中的每一个都是使用以下坐标创建的：

```
-1   -1  0 
-1   1   0 
1    1   0 
1   -1   0 
```

我将第一架飞机的坐标更改为

```
1   0   0 
0   0   0 
0   0   1 
1   0   1 
```

但是，这些平面的绘制完全相同。它们只是在不同的地方，因为我改变了他们的模型矩阵。QVarLengthArray 已正确更新（上面的代码执行向我展示了这一点）。

有人知道我错过了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T02:10:34.907

问题解决了！实际上，没有与 VBO 相关的问题......我只是没有更新法线，我的飞机（如预期的那样）完全黑暗（不可见）。希望没有人浪费时间思考这个问题......对不起！=D

# c# - 我的浏览器中的主要 C# 错误

> ID：11320894
> 
> 赞同：0
> 
> 时间：2012-07-04T00:14:51.300
> 
> 标签：c#, winforms, visual-studio-2010

以下是我在调试时遇到的错误：

错误 1 ​​字符文字中的字符过多 错误 2 'System.Windows.Forms.WebBrowser.Navigate(string)' 的最佳重载方法匹配有一些无效参数 错误 3 参数 1：无法从 'char' 转换为 'string'

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;

namespace BroZer
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        private void Reload_Click(object sender, EventArgs e)
        {
            webBrowser1.Refresh();
        }

        private void Go_Click(object sender, EventArgs e)
        {
            webBrowser1.Navigate(textBox1.Text);
        }

        private void Back_Click(object sender, EventArgs e)
        {
            webBrowser1.GoBack();
        }

        private void Forward_Click(object sender, EventArgs e)
        {
            webBrowser1.GoForward();
        }

        private void textBox1_TextChanged(object sender, EventArgs e)
        {
            webBrowser1.Navigate('https://www.google.com/search?&ie=UTF-8&q= + (textBox1.Text)');
        }

        private void webBrowser1_DocumentCompleted(object sender, WebBrowserDocumentCompletedEventArgs e)
        {

        }
    }
} 
```

所有错误都在第 41 行。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-04T00:19:14.400

> 'https://www.google.com/search?&ie=UTF-8&q= + (textBox1.Text)'

我知道你认为这应该做什么，但这是错误的。

`'x'`表示一个*字符*文字（即 的实例`char`，而不是`string`。在这种情况下，字符`x`），但是您像使用字符串一样使用它，然后想要对其进行插值`textbox1.Text`，但 C# 根本不支持这种类型的直接插值. 你想写：

```
// concatenate a string literal and a string variable
"https://www.google.com/search?&ie=UTF-8&q=" + textBox1.Text; 
```

接下来的两个错误消息是第一个错误消息的直接结果。此处的错误消息非常清楚，您最好搜索它们的含义并尝试推断问题的根本原因。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-04T00:19:36.570

换行

```
webBrowser1.Navigate('https://www.google.com/search?&ie=UTF-8&q= + (textBox1.Text)'); 
```

至

```
webBrowser1.Navigate(string.Format("https://www.google.com/search?&ie=UTF-8&q={0}", textBox1.Text); 
```

这是因为 Navigate 方法需要 String 或 Uri 作为您通过 char 发送的参数（ [WebBrowser.Navigate Method @ MSDN ）。](http://msdn.microsoft.com/en-us/library/system.windows.forms.webbrowser.navigate.aspx)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-04T00:19:45.943

```
The error is line webBrowser1.Navigate('https://www.google.com/search?&ie=UTF-8&q= + (textBox1.Text)'); 
```

您正在使用单引号 ' 而不是 "

请以这种方式使用它：

```
webBrowser1.Navigate("https://www.google.com/search?&ie=UTF-8&q=" + textBox1.Text); 
```

只是为了您在 C# 中的知识，'' 用于 Char，而 "" 用于字符串

```
e.g char c = 'C'; and string s = "something"; 
```

# javascript - Javascript拆分删除“：”冒号字符

> ID：11320897
> 
> 赞同：4
> 
> 时间：2012-07-04T00:15:11.983
> 
> 标签：javascript

我有一个这样的字符串。

```
var a="1:2:3:"; 
```

我想将其拆分`a.split(":")`以删除“：”冒号字符。

我想得到这个结果：

```
["1","2","3"] 
```

但结果`a.split(":")`是这样的：

```
["1","2","3",""] 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-04T00:17:38.030

使用此修剪方法删除尾随冒号。

```
function TrimColon(text)
{
    return text.toString().replace(/^(.*?):*$/, '$1');
} 
```

然后你可以这样称呼它：

```
TrimColon(a).split(":") 
```

如果您愿意，您当然可以制作`TrimColon`一个字符串原型方法，允许您执行以下操作：

```
a.TrimColon().split(":"); 
```

如果您想了解所使用的正则表达式： http: [//bit.ly/Ol8lsX](http://bit.ly/Ol8lsX)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-04T02:41:54.640

在解析这样的字符串之前，您应该从字符串的开头和结尾去掉冒号：

```
a.replace(/(^:)|(:$)/g, '').split(":") 
```

# objective-c - Xcode - 来自单个输入的多个值

> ID：11320900
> 
> 赞同：0
> 
> 时间：2012-07-04T00:15:18.213
> 
> 标签：objective-c, xcode

我正在尝试学习一些关于 Xcode 的知识，但我一直在尝试从单个输入中获取多个值。

```
- (void)degreeConvert:(id)sender
{
double timelonn = [tempTextBox.text doubleValue];
double monedslonn = (timelonn * 162.5);
// double arslonn = (timelonn * 1950);

[tempTextBox resignFirstResponder];

NSString *convertResult = [[NSString alloc] initWithFormat: @"Månedslønn: %0.f", monedslonn];
// NSString *convertResult = [[NSString alloc] initWithFormat: @"Årslønn: %0.f", arslonn];
calcResult.text = convertResult;} 
```

这需要我的输入**“timelonn”**（小时工资/收入）并返回**“monedslonn”**（月工资/收入）。双虚线评论是我的菜鸟想法，我如何让它也显示**“arslonn”**（年工资/收入）。

我离这里很远吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T00:49:57.673

你离得并不远。如果取消注释第一行注释，然后更改设置 convertResult 的行，则可以将 convertResult 字符串设置为多行，如下所示：

```
- (void)degreeConvert:(id)sender
{
    double timelonn = [tempTextBox.text doubleValue];
    double monedslonn = (timelonn * 162.5);
    double arslonn = (timelonn * 1950);

    [tempTextBox resignFirstResponder];

    NSString *convertResult = [[NSString alloc] initWithFormat: @"Månedslønn: %0.f\nÅrslønn: %0.f", monedslonn, arslonn];

    calcResult.text = convertResult;
} 
```

请注意，在格式字符串“Månedslønn: %0.f\nÅrslønn: %0.f”中，\n 代表换行符。

另请注意，您必须编辑 .nib 并更改 UILabel 的属性。单击标签并将（我将在此处关闭 Xcode 4）Lines 属性更改为 2（或您想要的任意多行）。在 Xcode 4 上，它应该是实用工具窗格的第 4 个选项卡中的倒数第二个（Command-Option-4）。当您使用它时，请调整您的 UILabel 大小，使其有足够的空间来容纳您的多行；）

# iphone - iPhone应用程序更新后立即崩溃

> ID：11320903
> 
> 赞同：7
> 
> 时间：2012-07-04T00:15:23.843
> 
> 标签：iphone, ios, xcode, crash

今天我的应用程序更新它已经在商店中发布，当第一次更新或下载时，应用程序在启动时立即崩溃。

我已经在模拟器和设备上测试了该应用程序（我从商店安装更新的地方相同），但我从未遇到过这个问题。

我的更新已在归档后提交给管理器，在分发部分。

Apple 在发布应用程序之前不会执行这些类型的控制吗？

有人遇到过类似的问题吗？我不知道可能是什么原因。谢谢你，Stefano。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-04T00:45:32.677

这是在不部署到商店的情况下测试生产构建的最佳方法：

*   将您的构建方案设置为“iOS 设备”
*   进行存档构建
*   选择您的存档并单击分发
*   选择“为企业或临时部署保存”
*   选择您的代码签名证书
*   保存 ipa 文件后，使用 Apple 的 iPhone 配置实用程序 (*) 将其安装到您的设备上

您应该始终执行两项测试：

*   卸载您的应用程序后在空白设备上安装 *以及“设置”->“常规”->“配置文件”中的任何配置文件”
*   在您的应用程序的先前版本之上安装，以确保所有文件/首选项/等都正确转换为新格式

(*) iPhone 配置实用程序主要用于企业应用程序部署，但它对开发人员也很有用，可在 support.apple.com 上免费下载 Mac 和 Windows。您也可以改用 iTunes，但它很复杂。

至于为什么你的应用程序崩溃了？不知道......它可能是任何东西。适用标准调试建议。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-04T12:15:59.457

该问题与框架有关。我有这个确切的错误。这不是逻辑问题，因为它甚至在调用 AppDelegate 之前就崩溃了，而我对 NSMetadataQuery 的使用在生命周期中要晚得多。

事实证明，需要对 Foundation 框架进行弱链接。

通过（在 Xcode 中的项目信息下）将 Foundation.framework 的依赖项选项从必需更改为可选来解决问题。检查任何此类框架。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-06T01:58:03.743

这也发生在我们的应用程序上，显然，其他应用程序也发生了。Apple 已经意识到这个问题，目前正在研究解决方案。

看到这篇文章： [http ://techcrunch.com/2012/07/05/apple-responds-to-app-crashing-issues-has-a-dedicated-team-working-on-a-fix/](http://techcrunch.com/2012/07/05/apple-responds-to-app-crashing-issues-has-a-dedicated-team-working-on-a-fix/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-04T00:31:28.933

尝试删除设备上所有旧版本的应用程序，然后重新安装。还可以在不同的设备上尝试，可能与您的开发者帐户使用不同的 Apple id。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-11-18T12:42:19.050

如果您正在使用核心数据并且您在最新版本中更新了数据库而没有对核心数据进行版本控制，在这种情况下，应用程序在更新后启动时崩溃。

# drools - 如何在drools中使用决策表实现小于和大于规则？

> ID：11320905
> 
> 赞同：4
> 
> 时间：2012-07-04T00:15:39.023
> 
> 标签：drools

我想使用决策表根据流口水中较小和较大的值来实施简单的规则。

在 drl 中实现规则很容易，例如：

```
rules "less than"
when Example(value < 10)
then 
    System.out.println("Less than 10")
end

rules "equals"
when Example(value = 10)
then 
    System.out.println("Equals 10")
end

rules "greater than"
when Example(value > 10)
then 
    System.out.println("Greater than 10")
end 
```

但是我怎样才能把它翻译成流口水的决策表呢？到目前为止，我看到的所有示例都是在条件单元格中进行比较。甚至可以在值单元格中进行比较吗？

我看到的所有示例都是以下格式：

```
CONDITION                          |  ACTION
Example                            |
value                              |
-----------------------------------|-------------------------------------
10                                 |  System.out.println("equals to 10") 
```

但这仅适用于1条规则，并且执行以下操作完全具有不同的含义：

```
CONDITION  | CONDITION  | CONDITION  | ACTION
Example
value      | value > $1 | value < $1 |
-----------+------------+------------+----------------
10         | 10         | 10         | ??? 
```

甚至可以执行以下操作吗？

```
CONDITION                          |  ACTION
Example                            |
value                              |
-----------------------------------+----------------------------------------
10                                 |  System.out.println("equals to 10")
> 10                               |  System.out.println("greater than 10")
< 10                               |  System.out.println("less than 10") 
```

执行这些规则的正确方法是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-08T21:08:08.830

我发现我可以通过将*$param*放入约束字段单元格并将整个约束放入值单元格中来实现我所需要的。所以决策表如下所示：

```
CONDITION                      | ACTION
Example                        |
$param                         | System.out.println("$param");
-------------------------------+-----------------------------------
value == 10                    | equals to 10
value > 10                     | greater than 10
value < 10                     | less than 10 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-02-19T15:46:26.563

可以将条件的一部分作为值给出。在标题中，您可以给出“ **value $param** ”来评估。（顺便说一句，为了能够输入 == 10 之类的值，您必须将单元格格式更改为 Excel 中的文本）

```
CONDITION                          |  ACTION
Example                            |
value $param                       |
-----------------------------------+----------------------------------------
== 10                              |  System.out.println("equals to 10")
in (10, 11)                        |  System.out.println("is 10 or 11")
> 10                               |  System.out.println("greater than 10")
< 10                               |  System.out.println("less than 10") 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-06T11:16:00.423

你可以看看这个

[http://s11.postimage.org/oya6zxr83/Screenshot.png](http://s11.postimage.org/oya6zxr83/Screenshot.png)

在这里，我们从用户那里获取用户位置和计数，并检查计数是否小于每个城市的初始计数，如果满足条件，则循环将运行直到循环条件。

希望它会有所帮助。

# javascript - 无法获取 iframe 内容

> ID：11320906
> 
> 赞同：1
> 
> 时间：2012-07-04T00:16:15.623
> 
> 标签：javascript, jquery, html

我知道有很多关于它的话题，但没有一个有效。我只需要获取 iframe 内容（不是源代码）。

我有一个表单，将一些参数发布到另一台服务器，并将其定位到 iframe（位于同一页面上）。因此，我收到存储在 iframe 中的服务器响应代码而无需刷新页面：

```
<form name='vin_form' id='file_upload_form' action='*****' method='post'>
    <input name='name1' value='value1'>
    <input name='name2' value='value2' type='hidden'>
    <input name='name3' value='value3' type='hidden'>
    <div onclick=\"document.getElementById('file_upload_form').target = 'upload_target'; document.vin_form.submit();\">Send form</div>
</form>";

<iframe id='upload_target' name='upload_target'></iframe> 
```

为了获得 iframe 内容，我使用了一切，但没有任何效果：

```
jQuery('#upload_target').load(function()
    {
            alert(jQuery('#upload_target').contents().find('body').html());

            var myIFrame = document.getElementById('upload_target');
            var content = myIFrame.contentWindow.document.body.innerHTML;
            alert(content);

            alert(window.frames.upload_target.document.body);
    }
); 
```

我读到了“同源政策”，但我认为在我的情况下不应该禁止它，因为我可以通过 url 访问该页面并阅读所有代码，那么为什么我不能以编程方式进行呢？

PS：还有其他方法可以从另一台服务器获取表单响应代码吗？（由于某些站点框架防御，php curl 不起作用）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T00:39:01.063

*更新 - 试试这个：

```
 var t = document.getElementById("upload_target");
 var y =( t.contentWindow || t.contentDocument);
 alert(y.document.body.innerHTML) 
```

# mongodb - MongoDB：一个集合中的数十亿个文档

> ID：11320907
> 
> 赞同：47
> 
> 时间：2012-07-04T00:16:38.057
> 
> 标签：mongodb

我需要将 66 亿个 bigram 加载到一个集合中，但我找不到任何有关执行此操作的最佳方法的信息。

将这么多文档加载到单个主键索引上需要很长时间，但据我所知，mongo 不支持等效的分区？

分片会有帮助吗？我是否应该尝试将数据集拆分为多个集合并将该逻辑构建到我的应用程序中？

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2012-07-05T10:44:05.710

很难说最佳的批量插入是什么——这部分取决于您插入的对象的大小和其他不可衡量的因素。您可以尝试几个范围，看看什么可以为您提供最佳性能。作为替代方案，有些人喜欢使用 mongoimport，它非常快，但您的导入数据需要是 json 或 csv。如果数据是 BSON 格式，显然有 mongodrestore。

Mongo 可以轻松处理数十亿个文档，并且可以在一个集合中拥有数十亿个文档，但请记住[最大文档大小为 16mb](http://www.mongodb.org/display/DOCS/Documents)。许多人在 MongoDB 中拥有数十亿个文档，并且在[MongoDB Google 用户组](https://groups.google.com/forum/?fromgroups#!forum/mongodb-user)上有很多关于它的讨论。如果您改变主意并希望改为拥有多个集合，这里有[一份](http://www.mongodb.org/display/DOCS/Using+a+Large+Number+of+Collections)关于使用大量集合的文档，您可能想阅读这些文档。您拥有的集合越多，您将拥有的索引也就越多，这可能不是您想要的。

这是来自 Craigslist 的关于将数十亿文档插入 MongoDB 和该人的[博客文章的](http://blog.zawodny.com/2011/03/06/mongodb-pre-splitting-for-faster-data-loading-and-importing/)[演示文稿](https://www.10gen.com/presentations/mongosf2011/craigslist)。

看起来分片对你来说是一个很好的解决方案，但通常分片用于跨多个服务器进行扩展，很多人这样做是因为他们想要扩展他们的写入或者他们无法保留他们的工作集（数据和索引）在内存中。从单个服务器开始，然后随着数据的增长或您需要额外的冗余和弹性而移动到分片或副本集是完全合理的。

但是，还有其他用户使用多个 mongod 来绕过具有大量写入的单个 mongod 的锁定限制。这很明显，但仍然值得一提，但多 mongod 设置比单个服务器更复杂。如果您的 IO 或 cpu 没有在这里达到最大值，您的工作集小于 RAM，并且您的数据很容易保持平衡（相当随机分布），您应该会看到改进（在单个服务器上进行分片）。作为一个仅供参考，内存和 IO 争用的可能性是存在的。随着 2.2 改进了[dblocking的](http://blog.serverdensity.com/2012/05/23/goodbye-global-lock-mongodb-2-0-vs-2-2/)[并发性](http://www.mongodb.org/display/DOCS/2.2+Release+Notes)，我怀疑这种部署的理由要少得多。

你需要正确地计划你的分片，即仔细考虑选择你的分片键。如果您采用这种方式，那么最好预先拆分并关闭平衡器。移动数据以保持平衡会适得其反，这意味着您需要预先决定如何拆分它。此外，有时在设计文档时考虑到某些字段可用于分片或作为主键的想法很重要。

这里有一些很好的链接 -

*   [选择分片键](http://www.mongodb.org/display/DOCS/Choosing+a+Shard+Key)
*   [关于分片键的博客文章](http://www.snailinaturtleneck.com/blog/2011/01/04/how-to-choose-a-shard-key-the-card-game/)
*   [分片概述演示](http://www.10gen.com/presentations/MongoNYC-2012/sharding-overview)
*   [分片最佳实践演示](http://www.10gen.com/presentations/MongoNYC-2012/Sharding-Best-Practices-Advanced)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-07-04T00:21:04.557

您绝对可以[在 MongoDB 中对数据进行分片（在](http://www.mongodb.org/display/DOCS/Sharding+Introduction)[shard key](http://www.mongodb.org/display/DOCS/Sharding+Introduction#ShardingIntroduction-ShardKeys)上跨 N 个服务器进行分区）。事实上，这是它的核心优势之一。在您的应用程序中无需这样做。

对于大多数用例，我强烈建议对 66 亿个文档执行此操作。以我的经验，MongoDB 在多台中端服务器上的表现要好于一台大型服务器。

# desire2learn - D2L 隐藏/锁定内容？

> ID：11320914
> 
> 赞同：0
> 
> 时间：2012-07-04T00:18:27.993
> 
> 标签：desire2learn

在为 Desire2Learn 中的学生自动化内容工作流程时，我试图根据外部事件隐藏和取消隐藏内容。在 D2L REST API 中，内容对象和学习对象如何锁定/解锁或隐藏/取消隐藏？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T00:20:03.297

isHidden 和 isLocked 字段由使用[ContentDataObject](http://docs.valence.desire2learn.com/res/content.html#Content.ContentObjectData)的调用控制，例如[更新主题](http://docs.valence.desire2learn.com/res/content.html#put--d2l-api-le-%28D2LVERSION-version%29-%28D2LID-orgUnitId%29-content-topics-%28D2LID-topicId%29)的调用。

# java - 如何在 Google App Engine 中运行 Java 应用程序？

> ID：11320916
> 
> 赞同：1
> 
> 时间：2012-07-04T00:18:31.207
> 
> 标签：java, google-app-engine, jnlp, java-web-start, jar-signing

我创建了一个简单的 Java 应用程序，其中包含按钮、文本字段等。我已经为它创建了 JAR 文件和 JNLP 文件，并由 Jarsigner 签名。

现在我希望能够从 Google App Engine 项目运行 Java 应用程序（Java Web-Start）。我用了：

<a href="/.../mycode.jnlp">启动应用程序</a>

这适用于普通的 html 页面，但不适用于我使用 JSP 页面的 Java App Engine 项目。如果我单击 App Engine 上的链接，它只会下载 JNLP 文件而不运行 java 程序。

我已经寻找解决方案无济于事。任何帮助，将不胜感激！

# php - 在 Magento 中将元关键字条件添加到 IF - Edit01

> ID：11320923
> 
> 赞同：0
> 
> 时间：2012-07-04T00:19:11.607
> 
> 标签：php, magento

此代码 (1) 的目的是以网格形式显示 Magento 存储中的子类别。类别图像的大小在代码中定义，而分隔和宽度在styles.css 中。

如果我正常使用代码，我会得到所有启用的子类别（IsActive 为真）。请参阅此“正在进行的工作”链接：[http ://www.aldetal.biz/index.php/vabaro/fitness/nutricion.html](http://www.aldetal.biz/index.php/vabaro/fitness/nutricion.html)

我更喜欢显示已启用并在其他地方标记为“值得展示”的子类别。这样我就可以将登录页面中以网格形式显示的子类别与菜单中显示的子类别分开。为了避免接触数据库，我将使用 Meta Keywords 字段添加字符串 showgrid 作为“关键字”标志。

## 代码

```
<?php
/** 
* Original code by Jake Rutter
* @website: http://www.onerutter.com/web/magento-custom-category-images-listing-block-tutorial.html#idc-ctools
* Fixed by func0der
*
*/
?>

<div id="categories">
    <div class="col_full">
        <div class="listing" >
        <?php
            $_maincategorylisting = $this->getCurrentCategory();
            $_categories = $this->getCurrentChildCategories();

            if($_categories->count()):
                foreach ($_categories as $_category):

    /** Choose between the two possible IFs. The first one works (as before, incompletely. The second Should work completely but instead breaks the code */
    /**                 if($_category->getIsActive()): */ 
                        if($_category->getIsActive() && preg_match('/^showgrid/ism', $_category->getData('meta_keywords'))): 

                        $cur_category=Mage::getModel('catalog/category')->load($_category->getId());
                        $layer = Mage::getSingleton('catalog/layer');
                        $layer->setCurrentCategory($cur_category);

    /** This is just for debugging. The first shows the sub-category name under the image (as it should in final version). The second one shows the text in Meta_Keywords. */
    /** 
    /**                 $catName = $this->getCurrentCategory()->getName(); */
                        $catName = $this->getCurrentCategory()->getData('meta_keywords'); 

                        if($_imageUrl = $this->getCurrentCategory()->getImageUrl()):
            ?>

            <div class="category-box">
                <div class="category-image-box">
                    <a href="<?php echo $this->getCategoryUrl($_category)?>"><img src="<?php echo $_imageUrl?>" height="150"></a>
                </div>
                <div class="category-name">

                    <?php
                    /**  Changed to check writing the category vs variable */
                    /** <a href="<?php echo $this->getCategoryUrl($_category)?>"> <?php echo $_category->getName()?></a> */
                    ?>

                    <p>
                        <a href="<?php echo $this->getCategoryUrl($_category)?>"> <?php echo $catName ?></a>
                    </p>
                </div>
            </div>
            <?php 
                        else:
            ?>
            <div class="category-box">
                <div class="category-image-box">
                    <a href="<?php echo $this->getCategoryUrl($_category)?>"><img src="/skin/frontend/default/default/images/media/default01.jpg" height="150"); ?></a>
                </div>
                <div class="category-name">
                    <p>
                        <a href="<?php echo $this->getCategoryUrl($_category)?>"><?php echo $catName ?></a>
                    </p>
                </div>
            </div>

            <?php 
                        endif; /* END: if($_imageUrl=!$this->getCurrentCategory()->getImageUrl()) */
                    endif; /* END: $_category->getIsActive()) */
                endforeach; /* END: ($_categories as $_category) */

                /* This resets the category back to the original pages category
                *    If this is not done, subsequent calls on the same page will use the last category in the foreach loop.
                * 
                *    The next line is the one showing the problem. If I use the expanded IF I get the error here...
                */

                $layer->setCurrentCategory($_maincategorylisting);
                endif; /* END: if($_categories->count()) */
            ?>
        </div>
        <br clear=all>
    </div>
</div> 
```

* * *

出于某种原因，蒂姆建议的优秀 IF

(1) 最初由 Jake Rutter 写在这里：[http](http://www.onerutter.com/web/magento-custom-category-images-listing-block-tutorial.html) : //www.onerutter.com/web/magento-custom-category-images-listing-block-tutorial.html 并由我调整

* * *

我有以下结构的代码来显示 Magento 前端的子类别。子类别在启用时显示（“IsActive”为真）。

```
 if($_categories->count()):
 foreach ($_categories as $_category):
        if($_category->getIsActive()):
               a whole bunch of stuff if true
            else
               other stuff if not true 
```

我想在不弄乱数据库的情况下添加另一个条件，所以我使用了 Meta Keywords 字段（因为它被 Google 正式忽略了，无论如何拥有一个古怪的关键字并没有任何害处）。

如果启用了类别（IsActive）并且该字段中的第一个字符串是“showgrid”，则 IF 为真，并且发生了很多事情。

**但要小心：**元关键字字段可能为空，因此我需要对其进行测试并确定其内容。如果未启用类别（IsActive 为假）或元关键字为空或元关键字不以 showgrid 开头，则发生其他事情

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T21:34:40.930

比元标记字段更好的解决方案是向类别添加新属性。

在 app/code/local/[YourCompany]/Category 中创建目录

在 app/code/local/[YourCompany]/Category/etc/config.xml 中创建您的 config.xml 文件

```
<?xml version="1.0"?>
<config>
    <modules>
         <YourCompany_Category>
             <version>0.1.0</version>
         </YourCompany_Category>
    </modules>
    <global>
        <resources>
            <category_setup>
                <setup>
                    <class>Mage_Eav_Model_Entity_Setup</class>
                    <module>YourCompany_Category</module>
                </setup>
                <connection>
                    <use>default_setup</use>
                </connection>
            </category_setup>
        </resources>
    </global>
</config> 
```

接下来在 app/etc/modules/YourCompany_Category.xml 中创建您的模块配置

```
<?xml version="1.0"?>
<config>
    <modules>
         <YourCompany_Category>
             <active>true</active>
             <codePool>local</codePool>
         </YourCompany_Category>
    </modules>
</config> 
```

接下来我们在 app/code/local/YourCompany/Category/sql/category_setup/mysql4-install-0.1.0.php 中创建安装程序

```
<?php
$installer = $this;
$installer->startSetup();
$installer->addAttribute('catalog_category','category_show_grid', array(
    'type'              => 'int',
    'group'             => 'General Information',
    'backend'           => '',
    'frontend'          => '',
    'label'             => 'Show in grid',
    'input'             => 'select',
    'class'             => '',
    'source'            => 'eav/entity_attribute_source_boolean',
    'global'            => Mage_Catalog_Model_Resource_Eav_Attribute::SCOPE_STORE,
    'visible'           => 1,
    'required'          => 0,
    'user_defined'      => 1,
    'default_value'     => 1,
    'searchable'        => false,
    'comparable'        => false,
    'visible_on_front'  => false,
    'unique'            => false
));
$installer->endSetup(); 
```

然后你应该可以在你的代码中调用它

```
if ($_category->getIsActive() && $_category->getCategoryShowGrid()) {
} 
```

# c++ - osx c++ 最大内存

> ID：11320928
> 
> 赞同：1
> 
> 时间：2012-07-04T00:19:52.713
> 
> 标签：c++, macos, memory

我正在编写一个 c++ 程序，该程序需要在程序启动时初始化大型无符号字符数组。

一旦数组的大小超过 1.5gb，我的程序就会崩溃，并显示 mmap 错误代码 = 12 消息。计算机作为 4gb 的内存，所以我想利用更多的内存，但显然不是整个 4gb。

有什么方法可以增加我的程序可以使用的内存量吗？这是在 xcode 的编译器中设置的，还是可以更改的 mac 设置？

# java - Java regex string replace

> ID：11320933
> 
> 赞同：0
> 
> 时间：2012-07-04T00:20:55.260
> 
> 标签：java, regex, string, replace

I am trying to write regex for replacing string.

There are string examples:

`I am student.`

`I <a href="am.html">am</a> student.`

I want to write regex which will replace "am" with `<a>` html tag, and get second string as result of replacing the first string.

Problem is nesting in quotes and text inside tag.

For example if I try to replace string "am" in this example:

`I <a href="am.html">am</a> am student.`

Result should be:

`I <a href="am.html">am</a> <a href="am.html">am</a> student.`

Thanks in advance!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T00:27:19.373

If it's a simple case like this you could use simple lookarounds to make sure that the thing you are matching is not surrounded by `>` and `<` but that it has word boundaries (`\b`) around it:

```
(?<!>)\bam\b(?!<) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T00:32:57.057

Below regex only matches `am` surrounded by whitespace.

```
str.replaceAll("(?<=\\s)am(?=\\s)","<a href=\"am.html\">am</a>") 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-04T00:42:31.123

I can see some answers related to regex string posted already so there's no need for me to post another one. But as for this simple case, how about something as simple as replacing String? Or perhaps the real problem is more complicated than this? My solution for this case is:

```
s.replaceAll(" am ", " <a href=\"am.html\">am</a> "); 
```

# php - PHP system() 命令在本地主机上不起作用

> ID：11320934
> 
> 赞同：0
> 
> 时间：2012-07-04T00:21:01.777
> 
> 标签：php, batch-file, locking, cmd

我有这个代码：

```
<?php
system('shutdown -s');
?> 
```

它工作得很好，关闭了我的本地主机和一切。但这不会锁定计算机：

```
<?php    
system('Rundll32.exe System32\User32.dll,LockWorkStation');
?> 
```

为什么它不起作用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T16:11:16.297

Web 服务器未在用户会话中运行，因此无法锁定它。

# php - php strip_tags 不删除 div （和其他）

> ID：11320936
> 
> 赞同：1
> 
> 时间：2012-07-04T00:21:15.683
> 
> 标签：php, strip-tags

我正在尝试使用 AJAX/PHP 验证评论表单，现在几乎完成了，除了 php 中的 strip_tags 函数似乎没有删除所有元素。这是我所拥有的：

```
$msg = $_POST['message'];
$msg = strip_tags( $msg ); 
```

此功能似乎只是删除结束标签。例如`<div>`，输入到消息框中的内容没有被删除，`</div>` *正在*被删除的地方。我想从字面上删除消息中的每个 html 元素。我如何实现这一目标？

谢谢，丹。

编辑：

我觉得自己像个彻头彻尾的白痴！

我有一个与我的显示评论功能分开的验证功能，并且刚刚意识到我的错误。我从来没有在我显示的消息上运行 strip_tags！

无论如何，感谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T00:44:05.813

`strip_tags()`可能失败的一件事是`htmlentities()`。

它会`<div>`显示`%3Cdiv%3E`为例如。

试试这个。htmlentities 将转换代码，例如。`%3C`到 HTML，例如。`<`

```
$msg = strip_tags(htmlentities($msg)); 
```

您应该能够通过比较这些来查看您要调试的内容：

```
echo $msg . '<br/>';
echo strip_tags($msg) . '<br/>';
echo htmlentities($msg) . '<br/>';
echo strip_tags(htmlentities($msg)) . '<br/>'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T00:29:36.237

> [strip_tags](http://php.net/manual/en/function.strip-tags.php) () 将标签视为 < 和第一个空格或 > 之间的不区分大小写的字符串

因此`strip_tags('< / div >')`，`strip_tags('< div >')`如果您在其中有任何空格，则不会改变。

您可能希望发布您尝试清理的字符串的示例。

您还应该尝试直接回显 $msg 并查看发出的源。由于您正在发布数据（取决于您如何从客户端发送数据），您可能会发现您实际上是在尝试剥离`%3Cdiv%3E%3C%2Fdiv%3E`（这是有效的）而不是`<div></div>`您期望的。

# xml - 使用 xsl 转换将一个 xml 文件转换为另一个 xml 文件

> ID：11320939
> 
> 赞同：-3
> 
> 时间：2012-07-04T00:21:40.237
> 
> 标签：xml, xslt, xml-parsing, xslt-1.0, xalan

这与 XSL 转换有关。输入.xml

```
<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="/x/transform.xsl"?>
<!-- input file root node-->
<message>           
    <header>
     <!--Many descendents will be there -->
    </header>
    <body>
     <!-- some other several elements will be there-->
      <TaskList>
        <TaskItem>
          <DataPoint>
            <Name>software.prog_name</Name>
            <Target>JAVA</Target>
          </DataPoint>
          <DataPoint>
            <Name>software.prog_rev</Name>
            <Target>1</Target>
          </DataPoint>
          <DataPoint>
            <Name>software.sw_product_id</Name>
            <Target>1000</Target>
          </DataPoint>
          <DataPoint>
            <Name>software.limits_file_name</Name>
            <Target>limits.txt</Target>
          </DataPoint>
          <DataPoint>
            <Name>software.limits_file_rev</Name>
            <Target>2</Target>
          </DataPoint>
          <DataPoint>
            <Name>hw_exp.class</Name>
            <Target>Car</Target>    
          </DataPoint>
          <DataPoint>
            <Name>hw_exp.type</Name>
            <Target>B</Target>
          </DataPoint>
          <DataPoint>
            <Name>hw_exp.rev</Name>
            <Target>32</Target>
          </DataPoint>
          <DataPoint>
            <Name>prompt_id</Name>
            <Target>100</Target>
          </DataPoint>
        </TaskItem>
        <AutomationParam>
          <Profile>Profile 1</Profile>
          <SubGroup>1</SubGroup>
          <Name>software.prog_name</Name>
          <Value>JAVA</Value>
       </AutomationParam>
       <AutomationParam>
         <Profile>Profile 1</Profile>
         <SubGroup>1</SubGroup>
         <Name>software.sw_product_id</Name>
         <Value>1000</Value>
       </AutomationParam>
       <AutomationParam>
         <Profile>Profile 1</Profile>
         <SubGroup>2</SubGroup>
         <Name>hw_exp.class</Name>
         <Value>Animal</Value>  
       </AutomationParam>
       <AutomationParam>
         <Profile>Profile 1</Profile>
         <SubGroup>2</SubGroup>
         <Name>hw_exp.type</Name>
         <Value>B</Value>
       </AutomationParam>
       <AutomationParam>
         <Profile>Profile 1</Profile>
         <SubGroup>3</SubGroup>
         <Name>hw_exp.class</Name>
         <Value>Flight</Value>
       </AutomationParam>
       <AutomationParam>
         <Profile>Profile 1</Profile>
         <SubGroup>3</SubGroup>
         <Name>hw_exp.type</Name>
         <Value>E</Value>
       </AutomationParam>
       <AutomationParam>
         <Profile>Profile 1</Profile>
         <SubGroup>3</SubGroup>
         <Name>hw_exp.rev</Name>
         <Value>1</Value>
       </AutomationParam>
       <AutomationParam>
         <Profile>Profile 2</Profile>
         <SubGroup>1</SubGroup>
         <Name>software.sw_product_id</Name>
         <Value>1000</Value>
       </AutomationParam>    
     </TaskList>
   </body>
 </message> 
```

在 input.xml 上应用 XSL 转换后，生成的文件是 output.xml output.xml（应该是这样的）

```
<?xml version="1.0" encoding="utf-8"?>
<!-- output file root node-->
<text>    
  <header>
    <!--All descendents will/should be copied as it is-->
  </header>
  <body>
    <sub_body>
     <!-- All such several elements from input.xml will/should be there-->
     <test_profile>
       <software>
         <prog_name>JAVA</prog_name>
         <prog_rev>1</prog_rev>
         <sw_product_id>1000</sw_product_id>
         <limits_file_name>limits.txt</limits_file_name>
         <limits_file_rev>2</limits_file_rev>
       </software>
       <hw_exp>
         <class>Car</class>
         <type>B</type>
         <rev>32</rev>
       </hw_exp>
       <prompt_id>100</prompt_id>
     </test_profile>
     <test_profile>
       <software>
         <prog_name>JAVA</prog_name>
         <sw_product_id>1000</sw_product_id>
       </software>
       <hw_exp>
         <class>Animal</class>
         <type>B</type>
       </hw_exp>
       <hw_exp>
         <class>Flight</class>
         <type>E</type>
         <rev>1</rev>
       </hw_exp>
     </test_profile>
     <test_profile>
       <software>
         <sw_product_id>1000</sw_product_id>
       </software>
     </test_profile>
   </sub_body>
 </body> 
```

请有人帮助我实现这一目标，那将是一个很大的帮助。我需要 XSL 1.0（但不是 2.x +）代码。

映射规则：a) output.xml 中的一个**<test_profile>**记录应该映射到 input.xml 中的整个**TaskList.TaskItem** b) 你在 output.xml 中看到额外的两个**<test_profile>**元素 [records]，就像你看到**<profile >** input.xml 中元素的值作为 Profile 1 和 Profile 2 [这意味着所有 Profile 1 相关的东西应该进入一个不同的**<test_profile>**并且所有 Profile 2 相关的东西应该进入另一个不同的**<test_profile>**。c) **<header>**元素及其全部内容（可以是多个后代）应按原样复制。d) **<DataPoint>**和**<AutomationParams>**不是固定数量的元素。这些东西可以是 0 [要么没有] 到无穷大 [许多]，这意味着一切都应该动态完成，而且可以有 0 到多个配置文件 [即配置文件 1、配置文件 2、配置文件 3 ......它可以是任何字符串，如jack、jill 等，] 用于 AutomationParams

注意：认为这个 input.xml 文件是根据数据库中的记录动态填充的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T13:51:19.093

这不是一个完整的解决方案。你的问题太不清楚了，不允许这样做。这个 XSLT 1.0 样式表可能会为您提供自己的解决方案提供有用的指示。

这个样式表...

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:output method="xml" indent="yes" encoding="utf-8"/>

<xsl:template match="@*|node()">
 <xsl:copy>
  <xsl:apply-templates select="@*|node()"/>
 </xsl:copy>
</xsl:template>

<xsl:template match="body">
 <xsl:copy>
  <sub_body>
   <test_profile>
    <xsl:apply-templates select="TaskList/TaskItem"/>
   </test_profile>
  </sub_body>
 </xsl:copy>
</xsl:template>

<xsl:template match="TaskItem">
 <test_profile>
  <software>
   <prog_name><xsl:value-of select="DataPoint[Name='software.prog_name']/Target" /></prog_name>
    <prog_rev><xsl:value-of select="DataPoint[Name='software.prog_re']/Target"/></prog_rev>
   <sw_product_id><xsl:value-of select="DataPoint[Name='software.sw_product_id']/Target"/></sw_product_id>
   <limits_file_name><xsl:value-of select="DataPoint[Name='software.limits_file_name']/Target"/></limits_file_name>
   <limits_file_rev><xsl:value-of select="DataPoint[Name='software.limits_file_rev']/Target" /></limits_file_rev>
  </software>
  <hw_exp>
   <class><xsl:value-of select="DataPoint[Name='hw_exp.class']/Target" /></class>
   <type><xsl:value-of select="DataPoint[Name='hw_exp.type']/Target" /></type>
   <rev><xsl:value-of select="DataPoint[Name='hw_exp.rev']/Target" /></rev>
  </hw_exp>
  <prompt_id><xsl:value-of select="DataPoint[Name='prompt_id']/Target" /></prompt_id>
 </test_profile>
</xsl:template>

</xsl:stylesheet> 
```

...当应用于您的示例输入时，将产生您所需输出的第一个 test_profile 节点。您没有解释与其他两个 test_profile 节点相关的转换规则。

* * *

**更新**

此样式表将使用 muenchian 分组和运行时计算的元素名称来生成额外的 test_profile 节点并按子组组织 hw_exp 节点。

这个样式表...

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:output method="xml" indent="yes" encoding="utf-8"/>

<xsl:key name="param-by-profile" match="AutomationParam" use="substring-after( Profile, 'Profile ')" />
<xsl:key name="subgroup" match="AutomationParam" use="SubGroup" />

<xsl:template match="@*|node()">
 <xsl:copy>
  <xsl:apply-templates select="@*|node()"/>
 </xsl:copy>
</xsl:template>

<xsl:template match="body">
 <xsl:copy>
  <sub_body>
    <xsl:apply-templates select="TaskList/TaskItem"/>
    <xsl:for-each select="TaskList/AutomationParam[
      generate-id(.) = generate-id( key('param-by-profile', substring-after( Profile, 'Profile '))[1])
      ]">
        <xsl:sort data-type="number" select="substring-after( Profile, 'Profile ')" />
        <xsl:call-template name="profile-from-param">
          <xsl:with-param name="automations" select="key('param-by-profile',substring-after( Profile, 'Profile '))" />
        </xsl:call-template>  
    </xsl:for-each>
  </sub_body>
 </xsl:copy>
</xsl:template>

<xsl:template match="TaskItem">
 <test_profile>
  <software>
   <prog_name><xsl:value-of select="DataPoint[Name='software.prog_name']/Target" /></prog_name>    
   <prog_rev><xsl:value-of select="DataPoint[Name='software.prog_rev']/Target"/></prog_rev>
   <sw_product_id><xsl:value-of select="DataPoint[Name='software.sw_product_id']/Target"/></sw_product_id>
   <limits_file_name><xsl:value-of select="DataPoint[Name='software.limits_file_name']/Target"/></limits_file_name>
   <limits_file_rev><xsl:value-of select="DataPoint[Name='software.limits_file_rev']/Target" /></limits_file_rev>
  </software>
  <hw_exp>
   <class><xsl:value-of select="DataPoint[Name='hw_exp.class']/Target" /></class>
   <type><xsl:value-of select="DataPoint[Name='hw_exp.type']/Target" /></type>
   <rev><xsl:value-of select="DataPoint[Name='hw_exp.rev']/Target" /></rev>
  </hw_exp>
  <prompt_id><xsl:value-of select="DataPoint[Name='prompt_id']/Target" /></prompt_id>
 </test_profile>
</xsl:template>

<xsl:template name="profile-from-param">
 <xsl:param name="automations" />
 <test_profile>
  <software>
   <xsl:apply-templates select="$automations[SubGroup=1]" /> 
  </software>
  <xsl:for-each select="$automations
    [generate-id(.) = generate-id( key('subgroup', SubGroup)[1])]
    [SubGroup >= 2]
    ">
    <xsl:sort data-type="number" select="SubGroup" />
    <xsl:call-template name="hw-group">
      <xsl:with-param name="automations" select="key('subgroup', SubGroup)" />
    </xsl:call-template>  
   </xsl:for-each>    
 </test_profile>  
</xsl:template>  

<xsl:template name="hw-group">
  <xsl:param name="automations" />
  <hw_exp>
   <xsl:apply-templates select="$automations" /> 
  </hw_exp>
</xsl:template>  

<xsl:template match="AutomationParam">
 <xsl:element name="{substring-after(Name,'.')}"> 
  <xsl:value-of select="Value" />
 </xsl:element>
</xsl:template>

</xsl:stylesheet> 
```

...当应用于提供的示例输入时，将生成此文档 ...

```
<?xml version="1.0" encoding="utf-8"?>
<message>           
 <header>
     <!--Many descendents will be there -->
 </header>
 <body>
  <sub_body>

   <test_profile>
    <software>
     <prog_name>JAVA</prog_name>
     <prog_rev>1</prog_rev>
     <sw_product_id>1000</sw_product_id>
     <limits_file_name>limits.txt</limits_file_name>
     <limits_file_rev>2</limits_file_rev>
    </software>
    <hw_exp>
     <class>Car</class>
     <type>B</type>
     <rev>32</rev>
    </hw_exp>
    <prompt_id>100</prompt_id>
   </test_profile>

   <test_profile>
    <software>
     <prog_name>JAVA</prog_name>
     <sw_product_id>1000</sw_product_id>
    </software>
    <hw_exp>
     <class>Animal</class>
     <type>B</type>
    </hw_exp>
    <hw_exp>
     <class>Flight</class>
     <type>E</type>
     <rev>1</rev></hw_exp>
    </test_profile>

    <test_profile>
     <software>
      <sw_product_id>1000</sw_product_id>
     </software>
    </test_profile>

  </sub_body>
 </body>
 </message> 
```

# android - OpenCV在轮廓边界内获取黑色像素

> ID：11320940
> 
> 赞同：4
> 
> 时间：2012-07-04T00:22:07.380
> 
> 标签：android, image-processing, opencv, pixel

我目前正在尝试检索轮廓边界内存在的所有黑色像素。我对轮廓边界不感兴趣，而是对位于边界内并构成实际图像的黑色像素感兴趣。如果我能得到图像的实际坐标，那就太好了。

我曾尝试使用带有掩码的 copyTo 方法，但我相信我没有设置正确的参数。同时，我也尝试使用 Core.fillPoly ，它只用命令中指定的颜色填充整个轮廓区域，并且对获取像素信息没有帮助。有人可以在这里指导我吗？我正在使用 OpenCV 2.3.1 开发 Android 2.2。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-04T02:20:43.360

有一组像素落在轮廓边界内。还有另一组黑色像素。您想找到这两组的交集，即既在边界内又为黑色的像素组。

为此，我会：

1.  将轮廓绘制为填充形状，黑底白字（在其自己的图像中），使其成为蒙版。您可以使用`cv::drawContours`或`cv::fillPoly`。

2.  从图像中过滤黑色像素作为另一个蒙版。您可以使用`cv::threshold`with`THRESH_BINARY_INV`和零阈值。

3.  `bitwise_and`使用或简单的`&`运算符找到相交集`matResult = mat1 & mat2;`

结果是一个与您的图像大小相同的矩阵，其非零值仅适用于满足您在轮廓内和图像中黑色标准的像素。您可以通过遍历此矩阵并测试非零值来获取各个坐标。

# desire2learn - D2L 每用户内容可见性

> ID：11320944
> 
> 赞同：0
> 
> 时间：2012-07-04T00:22:30.907
> 
> 标签：desire2learn

我们能否为特定用户解锁或取消隐藏内容，或者这是否适用于 D2L 课程中的所有学生？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T00:30:19.620

隐藏适用于角色中没有“查看未发布的内容”权限的所有用户。系统不会按用户管理隐藏。

不确定您的特定应用程序，但是，由于系统的这个属性，有些应用程序显然使用几个角色来控制项目的可见性，然后使用注册 api 在角色之间动态交换。这用于使用角色权限显示或隐藏的测验等项目。（注意：如果您希望“撤销”可见性，因为您无法“满足”Desire2Learn 内容限制，这不适用于限制，也就是发布条件。但您可以使用它来逐步显示内容；它可能不是特别优美的代码）。

注册通常对系统具有特殊意义，因此您需要与您的运营团队核实，以了解更改注册是否适用于他们的计划/策略。

# ruby-on-rails-3 - Rails 范围不等于

> ID：11320945
> 
> 赞同：5
> 
> 时间：2012-07-04T00:22:38.970
> 
> 标签：ruby-on-rails-3, activerecord

我正在编写一个范围，应该说选择 call_status = open 并且 unit_id 不为零的所有调用。我在 Ruby 上真的很弱，而且对 Rails 也很陌生，并且很难表达这种权利。

这是我所拥有的：

```
scope :open_calls, where(:call_status => "open", :unit_id != nil).order("id ASC") 
```

我应该使用不同的运算符来评估 nil 吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-04T00:31:48.997

据我所知，没有办法告诉 ActiveRecord 用哈希构建一个 NULL 子句。但是您可以链接字符串样式和哈希样式的 where 子句：

```
scope :open_calls, where(:call_status => "open").where("unit_id IS NOT NULL").order("id ASC") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T00:41:43.657

你可以这样做：

```
scope :open_calls, where("call_status IS ? AND unit_id IS NOT ?", "open", nil).order("id ASC") 
```

请注意，值`"open"`和`nil`被放置在一个数组中，我们`?`用来插入它们。这有助于防止由于引用/转义等导致的 SQL 注入错误，强烈推荐。[请参阅此处了解更多信息。](http://guides.rubyonrails.org/security.html#sql-injection)

# c++ - 将 boost::bind 与模板化对象一起使用

> ID：11320953
> 
> 赞同：0
> 
> 时间：2012-07-04T00:23:33.973
> 
> 标签：c++, templates, boost-thread, boost-bind

我想传递给*boost::bind*一个模板化对象，但*g++*总是产生错误。我找到了如何传递模板化函数，但是是否可以传递模板化对象？

这是代码。

```
#include <boost/thread/thread.hpp>
#include <boost/thread/mutex.hpp>

#include "tbb/tick_count.h"

#include <iostream>
#include <vector>

template<class T>
class LockedVector {
private:
  std::vector<T> v;
  boost::mutex vector_mutex;
public:
  LockedVector(void):v(){}
  LockedVector(const unsigned int& n){
    v.reserve( n );
  }
  void Push(const T& t) {
    boost::mutex::scoped_lock lock( vector_mutex );
    v.push_back(t);
  }
  void Print(std::ostream& O) {
    for(unsigned int i(0);i<v.size();++i){
      O << v[i] << " ";
    }
    std::cout << std::endl;
  }
};

template<class T>
void AddToGlobalVector(LockedVector<T>& lv, unsigned int& start, const unsigned int& end, double& time)  {
  tbb::tick_count t0( tbb::tick_count::now() );
  for(;
  start < end;
  ++start) {
   lv.Push( (T)start );
  }
  time = (tbb::tick_count::now()-t0).seconds();
};

int main(void) {
  double time_t1(0.0);
  double time_t2(0.0);
  LockedVector<unsigned int> global;
  boost::thread t1(&AddToGlobalVector, global, (unsigned int)1, (unsigned int)10, boost::ref(time_t1) );
  boost::thread t2(&AddToGlobalVector, global, (unsigned int)11, (unsigned int)20, boost::ref(time_t2) );
  t1.join();
  t2.join();
  global.Print(std::cout);
  std::cout << "First thread(seconds): " << time_t1 << std::endl;
  std::cout << "Second thread(seconds): " << time_t2 << std::endl; 
} 
```

这是 g++ 输出：

```
main.cpp: In function ‘int main()’:
main.cpp:58: error: no matching function for call to ‘boost::thread::thread(<unresolved overloaded function type>, LockedVector<unsigned int>&, unsigned int, unsigned int, const boost::reference_wrapper<double>)’
/usr/include/boost/thread/detail/thread.hpp:199: note: candidates are: boost::thread::thread(boost::detail::thread_move_t<boost::thread>)
/usr/include/boost/thread/detail/thread.hpp:147: note:                 boost::thread::thread()
/usr/include/boost/thread/detail/thread.hpp:118: note:                 boost::thread::thread(boost::detail::thread_data_ptr)
/usr/include/boost/thread/detail/thread.hpp:108: note:                 boost::thread::thread(boost::thread&)
main.cpp:59: error: no matching function for call to ‘boost::thread::thread(<unresolved overloaded function type>, LockedVector<unsigned int>&, unsigned int, unsigned int, const boost::reference_wrapper<double>)’
/usr/include/boost/thread/detail/thread.hpp:199: note: candidates are: boost::thread::thread(boost::detail::thread_move_t<boost::thread>)
/usr/include/boost/thread/detail/thread.hpp:147: note:                 boost::thread::thread()
/usr/include/boost/thread/detail/thread.hpp:118: note:                 boost::thread::thread(boost::detail::thread_data_ptr)
/usr/include/boost/thread/detail/thread.hpp:108: note:                 boost::thread::thread(boost::thread&) 
```

谢谢。

**编辑：**

好吧，好吧。我已经找到了怎么做。

```
boost::thread t1(&AddToGlobalVector<unsigned int>, boost::ref(global), (unsigned int)1, (unsigned int)10, boost::ref(time_t1) );
boost::thread t2(&AddToGlobalVector<unsigned int>, boost::ref(global), (unsigned int)11, (unsigned int)20, boost::ref(time_t2) ); 
```

此外，我不得不将*boost::mutex*移出*LockedVector*类，因为它不可移动并且*boost::bind*抱怨。

所以现在的问题是是否可以在类中维护互斥锁。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T14:14:55.920

您可能想要声明一个移动构造函数 to `LockedVector`，它实例化一个新的互斥体而不是试图移动它。

```
LockedVector(LockedVector<T> && lv) : v(lv.v) {} 
```

请注意，我在这里完全是推测性的，因为我无法访问编译器。

# asp.net-mvc-3 - 创建自定义用户注册系统，就像 MVC3 默认用户注册系统一样

> ID：11320958
> 
> 赞同：1
> 
> 时间：2012-07-04T00:24:10.463
> 
> 标签：asp.net-mvc-3

MV3默认的用户注册系统够好吗？如果不是，我应该如何创建我的一个，就像默认的一样（使用会员系统、角色系统、配置文件系统）？我应该如何使用我的数据库表来做到这一点？

我是 MVC3 的新手，所以请给出一个很好的例子或一个很好的教程链接。请帮助我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T00:27:40.853

“足够好”取决于您的需要。

我正在为一个相当繁忙和复杂的网站使用默认的[成员资格提供程序](http://msdn.microsoft.com/en-us/library/yh26yfzy.aspx)和[配置文件提供程序。](http://msdn.microsoft.com/en-us/library/014bec1k.aspx)他们有点尴尬，但要完成工作。

[SQL Membership Provider](http://msdn.microsoft.com/en-us/library/system.web.security.sqlmembershipprovider.aspx)更灵活一些，可以[与 MVC 3 一起使用](http://helios.ca/2009/04/22/aspnet-mvc-sqlmembershipprovider/)。

如果您想实现自定义成员资格提供程序，请查看

[http://msdn.microsoft.com/en-us/library/f1kyba5e.aspx](http://msdn.microsoft.com/en-us/library/f1kyba5e.aspx)

[http://www.asp.net/web-forms/videos/how-do-i/how-do-i-create-a-custom-membership-provider](http://www.asp.net/web-forms/videos/how-do-i/how-do-i-create-a-custom-membership-provider)

[http://www.danharman.net/2011/06/23/asp-net-mvc-3-custom-membership-provider-with-repository-injection/](http://www.danharman.net/2011/06/23/asp-net-mvc-3-custom-membership-provider-with-repository-injection/)

# jquery - jQuery 无限滚动 + Masonry + CSS 媒体查询 + nth-child

> ID：11320960
> 
> 赞同：1
> 
> 时间：2012-07-04T00:24:17.877
> 
> 标签：jquery, responsive-design, jquery-masonry, infinite-scroll, css-selectors

我遇到了一个不寻常的问题。

我在网站上同时使用 jQuery Masonry 和 Infinite Scroll。

[http://masonry.desandro.com/](http://masonry.desandro.com/)

[http://www.infinite-scroll.com/](http://www.infinite-scroll.com/)

该站点也是响应式的，因此在某些断点（480px、768px 等）处，我添加了一些样式来使用 nth-child 选择器更改框的顺序。详细地说，每块砖石都包含两个方块，它们会根据屏幕大小向左或向右切换。所以你会看到这样的东西：

```
#main-content article:nth-child(2) .first,
#main-content article:nth-child(2n+8) .first {
    left: 0;
}
#main-content article:nth-child(2) .second,
#main-content article:nth-child(2n+8) .second {
    left: 15em; /* 240px / 16px = 15em */
} 
```

问题是，当 Infinite Scroll 引用我的其他帖子时，这些 nth-child 样式并没有得到应用……留下了一个看起来非常不稳定的设计。

无论如何我可以强制无限滚动应用我的媒体查询中的所有内容吗？是否有一个回调函数可以让我强制 Infinite Scroll 接受我的第 n 个子样式或重新加载 styles.css？

任何帮助是极大的赞赏。谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T15:25:26.343

我的愚蠢错误。

发生的事情是，Infinite Scroll 在容器中添加了一个 #loading ......因为我使用的是 nth-child 而不是 nth-of-type ......我的样式包括该元素。

现在一切都很好。

# firefox - 如何从 Emacs 在浏览器中设置 javascript 断点？

> ID：11320963
> 
> 赞同：2
> 
> 时间：2012-07-04T00:24:39.737
> 
> 标签：firefox, google-chrome, emacs, automation

作为一名 JS 开发人员，我想在 JS 文件中的一行上按下一个键，并在浏览器的调试器中设置一个调试断点。对于加分，找到这一行的方法应该是“模糊的”，因为我的构建系统可能会在当前文件前面添加其他 JS。

我知道 slime-js，它与页内 JS 对话，但我正在寻找与 Firebug 或 Chrome“开发者工具”的连接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T00:45:12.507

这就是我的 .emacs 中的内容

```
(defun line-matches-p (regexp)
  (string-match-p
   regexp
   (buffer-substring
    (line-beginning-position)
    (line-end-position))))

(defun js-toggle-debugger ()
  (interactive)
  (if (line-matches-p "debugger")
      (delete-region (line-beginning-position)
                     (1+ (line-end-position)))
      (progn (beginning-of-line)
             (insert "\n")
             (backward-char)
             (insert "debugger;")
             (indent-according-to-mode)
             (end-of-line)))) 
```

它插入或删除“调试器”关键字。我已经将它与 firebug 和 moz-repl 一起使用。

缺点是它需要您重新评估该功能。

# c# - Newtonsoft Json.NET 可以跳过序列化空列表吗？

> ID：11320968
> 
> 赞同：64
> 
> 时间：2012-07-04T00:26:17.597
> 
> 标签：c#, list, serialization, json.net

我正在尝试序列化一些“懒惰创建”各种列表的遗留对象。我无法改变遗留行为。

我把它归结为这个简单的例子：

```
public class Junk
{
    protected int _id;

    [JsonProperty( PropertyName = "Identity" )]
    public int ID 
    { 
        get
        {
            return _id;
        }

        set
        {
            _id = value;
        }
    }

    protected List<int> _numbers;
    public List<int> Numbers
    {
        get
        {
            if( null == _numbers )
            {
                _numbers = new List<int>( );
            }

            return _numbers;
        }

        set
        {
            _numbers = value;
        }
    }
}

class Program
{
    static void Main( string[] args )
    {
        Junk j = new Junk( ) { ID = 123 };

        string newtonSoftJson = JsonConvert.SerializeObject( j, Newtonsoft.Json.Formatting.Indented );

        Console.WriteLine( newtonSoftJson );

    }
} 
```

目前的结果是： { "Identity": 123, "Numbers": [] }

我想得到：{“身份”：123}

也就是说，我想跳过任何列表、集合、数组或此类为空的内容。

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2012-11-05T18:28:25.203

如果您没有找到解决方案，当您设法找到它时，[答案非常简单。](http://james.newtonking.com/projects/json/help/index.html?topic=html/ConditionalProperties.htm)

如果您被允许扩展原始类，则向其添加一个`ShouldSerializePropertyName`函数。这应该返回一个布尔值，指示是否应该为类的当前实例序列化该属性。在您的示例中，这可能看起来像这样（未经测试，但您应该得到图片）：

```
public bool ShouldSerializeNumbers()
{
    return _numbers.Count > 0;
} 
```

这种方法对我有用（尽管在 VB.NET 中）。如果您不允许修改原始类，那么`IContractResolver`链接页面上描述的方法就是要走的路。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2018-09-27T01:57:41.000

关于 David Jones 的使用建议`IContractResolver`，这对我来说可以涵盖所有`IEnumerables`变体，而无需显式修改需要序列化的类：

```
public class ShouldSerializeContractResolver : DefaultContractResolver
{
    public static readonly ShouldSerializeContractResolver Instance = new ShouldSerializeContractResolver();

        protected override JsonProperty CreateProperty(MemberInfo member, MemberSerialization memberSerialization) {
            JsonProperty property = base.CreateProperty(member, memberSerialization);

            if (property.PropertyType != typeof(string)) {
                if (property.PropertyType.GetInterface(nameof(IEnumerable)) != null)
                    property.ShouldSerialize =
                        instance => (instance?.GetType().GetProperty(property.PropertyName).GetValue(instance) as IEnumerable<object>)?.Count() > 0;
            }
            return property;
        }
} 
```

然后我将它构建到我的设置对象中：

```
static JsonSerializerSettings JsonSettings = new JsonSerializerSettings
{
    Formatting = Formatting.Indented,
    NullValueHandling = NullValueHandling.Ignore,
    DefaultValueHandling = DefaultValueHandling.Ignore,
    ReferenceLoopHandling = ReferenceLoopHandling.Ignore,
    ContractResolver = ShouldSerializeContractResolver.Instance,
}; 
```

并像这样使用它：

```
JsonConvert.SerializeObject(someObject, JsonSettings); 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2019-01-04T06:05:16.163

布莱恩，你是最不需要实例变量开销的方式，你需要捕获字段和成员实例，而且我不会运行计数操作，这需要枚举耗尽整个集合，你可以简单地运行MoveNext() 函数。

```
public class IgnoreEmptyEnumerableResolver : CamelCasePropertyNamesContractResolver
{
    protected override JsonProperty CreateProperty(MemberInfo member,
        MemberSerialization memberSerialization)
    {
        var property = base.CreateProperty(member, memberSerialization);

        if (property.PropertyType != typeof(string) &&
            typeof(IEnumerable).IsAssignableFrom(property.PropertyType))
        {
            property.ShouldSerialize = instance =>
            {
                IEnumerable enumerable = null;
                // this value could be in a public field or public property
                switch (member.MemberType)
                {
                    case MemberTypes.Property:
                        enumerable = instance
                            .GetType()
                            .GetProperty(member.Name)
                            ?.GetValue(instance, null) as IEnumerable;
                        break;
                    case MemberTypes.Field:
                        enumerable = instance
                            .GetType()
                            .GetField(member.Name)
                            .GetValue(instance) as IEnumerable;
                        break;
                }

                return enumerable == null ||
                       enumerable.GetEnumerator().MoveNext();
                // if the list is null, we defer the decision to NullValueHandling
            };
        }

        return property;
    }
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-07-02T13:44:20.027

只是为了成为普通人，我将 if 测试构造为：

```
public bool ShouldSerializecommunicationmethods()
{
    if (communicationmethods != null && communicationmethods.communicationmethod != null && communicationmethods.communicationmethod.Count > 0)
        return true;
    else
        return false;
} 
```

因为空列表通常也为空。感谢您发布解决方案。ATB。

# java - 不可变的子类

> ID：11320970
> 
> 赞同：4
> 
> 时间：2012-07-04T00:27:09.967
> 
> 标签：java, immutability

我目前正在开发一个多线程框架。为了避免副作用，我想要求框架操作的所有数据都必须是不可变的。

那么Java中是否存在一种方法来指定我希望给定类的所有子类或实现给定接口的所有类都是不可变的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T21:42:22.617

我建议研究[Mutability Detector](http://code.google.com/p/mutability-detector/)。它执行静态分析以确定给定类是否是不可变的。它可以用来添加类似于运行时断言的东西，即如果传递给可变类的实例，您可以选择抛出异常。请注意，它可以在运行时分析实际的具体类，包括您定义的接口的子类或实现。

它仍然是 1.0 之前的版本，并且存在问题`java.lang.String`，但它可以使用。如果它接近您正在寻找的东西，但没有完全满足您的需求，我建议联系邮件列表或提交错误报告，因为我相信项目维护者是一个非常合理的人。免责声明：那个维护者是我;-)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-04T00:30:01.663

没有办法要求子类的不变性。您可以通过不提供设置器并保持实例变量私有来确保类的子类不会改变您的状态，但是如果子类声明了自己的实例变量，则它们可以完全控制它们。

就接口而言，您唯一能做的就是不提供设置器。但是，实现可以提供自己的设置器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-04T22:04:25.433

要使一个类真正不可变，该类的所有成员都必须是不可变的，并且该类本身必须是`final`. 这确保了不能从类内或类外更改对象。

要使类中的成员不可变，这不仅仅意味着使它们`final`. 例如

```
private final List<String> strings = new LinkedList<String>(); 
```

`strings`是`final`但仍然可以更改，因为可以从列表中添加和删除项目。在这种情况下，您可以将其包装在不可修改的集合中。即使这也不是完美的，因为您列表中的对象可能是可变的（`Strings`不是很明显，但您的列表中可能有您可以做的可变对象`list.get(index).mutator(...)`）

关于如何使对象不可变，没有灵丹妙药。如果它提供了任何改变对象的方法，那么它就不可能是不可变的。

至于创建一个类`final`，以实现保证不变性这是必要的。想象一下这种情况，

```
class MyImmutableClass {
    private final String name
}

class MutableClass extends MyImmutableClass {
    private String mutableValue;

    public void setMutableValue(String mutableValue...)
}

void doSomething(MyImmutableClass c) {...} 
```

不能保证`doSomething`实际上是在处理一个不可变的实例，而是它可能是在处理一个可变的子类。如您所见，这会给使用接口带来问题。没有办法保证接口的实现者是不可变的。

`@Immutable`注释不保证不变性，而只是声明类告诉你它是不可变的，但没有好的方法来强制执行。

如果您能够在 groovy 中工作，则`@Immutable`注释会产生一些效果，因为它可以执行我提到的上述许多技术。[http://groovy.codehaus.org/Immutable+AST+Macro](http://groovy.codehaus.org/Immutable+AST+Macro)

# php - 如何根据 PHP 中 xpath 的标签值将一个 xml 转换为另一个 xml？

> ID：11320972
> 
> 赞同：0
> 
> 时间：2012-07-04T00:27:11.447
> 
> 标签：php, xml, xpath, tags

如何使用 xpath 将 xml 转换为另一种 xml 格式？xml 文件是动态的，它可以是任何级别，不同的标签。以下 xml 是一个示例：

```
<?xml version="1.0"?> 
<student_info>     
<total_stud>500</total_stud>     
  <student>         
    <id>1</id>         
    <name>abc</name>         
    <address>             
       <city>Pune</city>             
       <zip>411006</zip>         
    </address>     
  </student>     
  <student>         
    <id>1</id>         
    <name>bbc</name>         
    <address>             
      <city>Toronto</city>             
      <zip>82233</zip>         
    </address>     
  </student> 
  <student>         
    <id>2</id>         
    <name>wec</name>         
    <address>             
      <city>North York</city>             
      <zip>59522</zip>         
    </address>     
  </student> 
</student_info> 
```

致：所有学生“id=1”

```
<?xml version="1.0"?>
<student_info>
  <student>
    <name>abc</name>
    <city>Pune</city>             
    <zip>411006</zip>      
  </student> 
  <student>
    <name>bbc</name>
    <city>Toronto</city>             
    <zip>82233</zip>      
  </student>
</student_info> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T23:17:01.350

您可能想要使用有助于 XPath 的 XSL 转换。

您可以像这样从 PHP 中使用它：[http ://www.php.net/manual/en/book.xsl.php](http://www.php.net/manual/en/book.xsl.php)

您的示例的 XSL 可能如下所示：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output method="xml" indent="yes"/>

  <xsl:param name="id" />

  <xsl:template match="/student_info">
    <xsl:copy>
      <xsl:apply-templates select=".//student[id=$id]"/>
    </xsl:copy>
  </xsl:template>

  <xsl:template match="student">
    <xsl:copy>
      <xsl:copy-of select="name" />
      <xsl:copy-of select="address/city" />
      <xsl:copy-of select="address/zip" />
    </xsl:copy>
  </xsl:template>

</xsl:stylesheet> 
```

您可以使用和将`id`参数（与样式表一起使用）传递给转换器。`<xsl:param>``$id``setParameter`

编辑：这里有一块 xsltCake 可以玩：[http](http://www.xsltcake.com/slices/dnuFXh) ://www.xsltcake.com/slices/dnuFXh 不幸的是它不支持参数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T07:08:06.973

试试这个：

// 将其保存在一个文件中：ts1.xml

```
<?xml version="1.0" encoding="utf-8"?>
<student_info>     
    <total_stud>500</total_stud>     
  <student>         
    <id>1</id>         
    <name>abc</name>         
    <address>             
       <city>Pune</city>             
       <zip>411006</zip>         
    </address>     
  </student>     
  <student>         
    <id>1</id>         
    <name>bbc</name>         
    <address>             
      <city>Toronto</city>             
      <zip>82233</zip>         
    </address>     
  </student> 
  <student>         
    <id>2</id>         
    <name>wec</name>         
    <address>             
      <city>North York</city>             
      <zip>59522</zip>         
    </address>     
  </student> 
</student_info> 
```

**PHP代码在这里：**

```
<?php
$xml = simplexml_load_file( 'ts1.xml' );

// search all nodes with id=1
$xpath = ( $xml->xpath( '//student/id[.=1]/..' ) );

// create a new XML
$newXML = simplexml_load_string( "<?xml version=\"1.0\" encoding=\"utf-8\"?><student_info></student_info>" );

// add matching xml nodes to it.
foreach( $xpath as $st ) {
    $student = $newXML->addChild( 'student' );
    $student->addChild( 'name', (string)$st->name );
    $student->addChild( 'city', (string)$st->address->city );
    $student->addChild( 'zip', (string)$st->address->zip );
}

$xmldoc = new DomDocument( '1.0' );
$xmldoc->preserveWhiteSpace = false;
$xmldoc->formatOutput = true;

$xmldoc->loadXML( $newXML->asXML(), LIBXML_NOBLANKS );
//save as 1.xml
$xmldoc->save( '1.xml' );
?> 
```

**结果保存在 1.xml**

```
<?xml version="1.0" encoding="utf-8"?>
<student_info>
  <student>
    <name>abc</name>
    <city>Pune</city>
    <zip>411006</zip>
  </student>
  <student>
    <name>bbc</name>
    <city>Toronto</city>
    <zip>82233</zip>
  </student>
</student_info> 
```

这将为所有 id=1 的节点创建一个新的 xml。您可以修改它以满足您的需要。希望这可以帮助。

# sql-server-2008 - SQL Server 2008 自动夜间数据库备份

> ID：11320973
> 
> 赞同：1
> 
> 时间：2012-07-04T00:27:13.400
> 
> 标签：sql-server-2008, database-backups

我正在使用 SQL Server 2008 网络版，我想创建一个自动夜间备份，将 .bak 文件保存到本地目录，如 C:\DB-backups，具有以下命名结构 dbname-date.bak (dbname- 07032012.bak)。

我对日期格式并不挑剔，只要它可读且独特。

例如，我想安排自动备份并在美国东部标准时间凌晨 3 点运行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T09:39:12.447

这并不像使用标准（哦更高）版本的 sql server 那样容易。您可以在那里设置维护计划来完成这项工作。

在您的情况下，创建一个存储过程以使用即。`EXEC BackupDatabases`. 此链接向您展示了如何执行此操作：

[https://support.microsoft.com/en-ca/help/2019698/how-to-schedule-and-automate-backups-of-sql-server-databases-in-sql-se](https://support.microsoft.com/en-ca/help/2019698/how-to-schedule-and-automate-backups-of-sql-server-databases-in-sql-se)

# http - 为什么 FireFox 不将 http://%67oogle.com 指向 http://google.com？

> ID：11320982
> 
> 赞同：1
> 
> 时间：2012-07-04T00:29:15.953
> 
> 标签：http, url

我有一个 HTML 文件*test.html*：

```
<a href="http://%67oogle.com">http://%67oogle.com</a>
<br>
<a href="http://www.%67oogle.com">http://www.%67oogle.com</a> 
```

这些链接在 Chrome、IExplorer、Safari 和 Opera 中有效（[http://%67oogle.com](http://google.com)指向[http://google.com](http://google.com)）。

但是，这些链接在 FireFox (v13.0.1) 上不起作用。

为什么 FireFox 不将[http://%67oogle.com](http://%67oogle.com)指向[http://google.com](http://google.com)？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-05-16T22:31:44.343

有效的 HTTP URI 是符合[RFC 2616](https://www.rfc-editor.org/rfc/rfc2616#section-3.2.2)的 HTTP/1.1 标准。它说：

```
... For definitive information on
URL syntax and semantics, see "Uniform Resource Identifiers (URI):
Generic Syntax and Semantics," RFC 2396 [42] (which replaces RFCs
1738 [4] and RFC 1808 [11]). This specification adopts the
definitions of "URI-reference", "absoluteURI", "relativeURI", "port",
"host","abs_path", "rel_path", and "authority" from that
specification. 
```

和

```
The "http" scheme is used to locate network resources via the HTTP
protocol. This section defines the scheme-specific syntax and
semantics for http URLs.

http_URL = "http:" "//" host [ ":" port ] [ abs_path [ "?" query ]] 
```

如果我们深入研究[RFC 2396](https://www.rfc-editor.org/rfc/rfc2396)，它定义`host`为：

```
 host          = hostname | IPv4address
  hostname      = *( domainlabel "." ) toplabel [ "." ]
  domainlabel   = alphanum | alphanum *( alphanum | "-" ) alphanum
  toplabel      = alpha | alpha *( alphanum | "-" ) alphanum 
```

让我们也看看[RFC 3986](https://www.rfc-editor.org/rfc/rfc3986)

> reg-name 语法允许百分比编码的八位字节，以便以独立于底层名称解析技术的统一方式表示非 ASCII 注册名称。非 ASCII 字符必须首先根据 UTF-8 [STD63] 进行编码，然后必须对相应 UTF-8 序列的每个八位字节进行百分比编码才能表示为 URI 字符。 **生成 URI 的应用程序不得在主机中使用百分比编码，除非它用于表示 UTF-8 字符序列。**

所以 Firefox 不重定向你是完全正确的。`%67oogle.com`是 URL 的无效主机部分。

# java - Java 的 KeyStorage .Net 等价物？

> ID：11320985
> 
> 赞同：4
> 
> 时间：2012-07-04T00:29:46.080
> 
> 标签：java, password-storage

我正在寻找与 Java 的 KeyStorage .Net (http://keystorage.codeplex.com/) 库等效的版本。

该库允许使用各自的本机机制在不同的操作系统上进行密码管理。即 Windows 上的 DPAPI、Mac OS X 上的 Keychain Services API 和 Linux 上的 GNOME-Keyring。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-07-05T10:41:46.567

我在 C++ 中寻找完全相同的东西。

到目前为止，我发现：ppasskeeper：[https](https://gitorious.org/ppasskeeper/ppasskeeper) ://gitorious.org/ppasskeeper/ppasskeeper （自 2010 年以来没有采取任何行动。）

以及 Chromium 中的 password_manager (chrome/browser/password_manager)

（除了上述之外，还有人知道一个好的 C 或 C++ 实现吗？）

对于 Java，这里有一个很好的链接： [http ://help.sap.com/saphelp_47x200/HELPDATA/EN/70/526bfc1405f94fb519f962ace28feb/content.htm](http://help.sap.com/saphelp_47x200/HELPDATA/EN/70/526bfc1405f94fb519f962ace28feb/content.htm)

# java - 播放框架中日期格式的国际化

> ID：11320986
> 
> 赞同：1
> 
> 时间：2012-07-04T00:29:49.607
> 
> 标签：java, internationalization, playframework, playframework-1.x

我使用 messages.en、messages.de 等将我的 play 应用程序国际化。但是，美国和英国有不同的日期格式偏好。

播放文档有点不清楚，我认为您必须使用 2 个字母的 ISO 代码，但似乎 3 个字母的 ISO 语言代码也可以使用。

我在这里找到了 eng 和 enu 并将其插入到游戏中并取得了成功。[http://msdn.microsoft.com/en-us/library/ee825488%28v=cs.20%29.aspx](http://msdn.microsoft.com/en-us/library/ee825488%28v=cs.20%29.aspx)

不过，我在官方 ISO 中找不到它们的文档，并且希望该游戏更清楚地表明 3 字母代码可以工作，因此我知道这是一个功能而不是错误。

一般来说，关于如何在这里最好地使用日期格式有什么建议吗？将它们与语言选择联系起来是一个好主意还是更好地为用户提供独立于语言的选择？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T06:00:32.660

要为 Play 设置日期格式，请在配置文件中定义它，而不是专门在此处的消息文件中定义 - [http://www.playframework.org/documentation/1.2.4/configuration#date.format](http://www.playframework.org/documentation/1.2.4/configuration#date.format)

Play 说明了以下关于在 2 个字符代码（语言代码）和语言和国家代码之间进行选择的内容，这里 - [http://www.playframework.org/documentation/1.2.4/i18n#languages](http://www.playframework.org/documentation/1.2.4/i18n#languages)

> 如果要区分变体，例如 en_US 和 en_GB，或 zh_CN 和 zh_TW，可以使用语言/国家/地区对。但是，请注意，某些用户可能仅在其接受语言中公开一种语言而不是国家/地区。出于这个原因，您应该始终提供“裸露”的语言（例如 en）。
> 
> 例如，如果您的大部分用户来自美国，但您也想支持英式英语，则建议简单地使用美式英语的“en”和英式英语的“en_GB”。

它没有特别提到 3 个字符代码。但是，Play 使用 Java Locale 对象进行国际化，因此如果您查看该对象的[Javadoc](http://docs.oracle.com/javase/6/docs/api/java/util/Locale.html)，您可以看到仅对 2 个字符代码的引用，而不是 3 个字符代码的引用。因此，依靠 2 个字符代码（或国家和语言代码，例如`en_gb`）可能更安全，因为虽然 Locale 似乎支持 3 个国家代码，但您不能保证全部！

# c - C中奇怪的malloc错误，标记单词

> ID：11320987
> 
> 赞同：1
> 
> 时间：2012-07-04T00:29:52.493
> 
> 标签：c, malloc

我试图用空格和引号来标记一个单词，但是在正确的输出之后我得到了一个奇怪的 malloc 错误。

我希望这个函数接受类似的东西：

```
hello world "SOme quote" 
```

并且输出应该是：

```
hello
world
"some quote" 
```

或者如果输入是：

```
hello world no quote 
```

输出应该是：

```
hello
world
no
quote 
```

~~但是现在，我得到：~~

 ~~```
Hello
WOrld
"Hello World"
*** glibc detected *** ./a.out: free(): invalid next size (fast): 0x0000000001760010 ***
a.out: malloc.c:2451: sYSMALLOc: Assertion `(old_top == (((mbinptr) (((char *) &((av)->bins[((1) - 1) * 2])) - __builtin_offsetof (struct malloc_chunk, fd)))) && old_size == 0) || ((unsigned long) (old_size) >= (unsigned long)((((__builtin_offsetof (struct malloc_chunk, fd_nextsize))+((2 * (sizeof(size_t))) - 1)) & ~((2 * (sizeof(size_t))) - 1))) && ((old_top)->size & 0x1) && ((unsigned long)old_end & pagemask) == 0)' failed.
Aborted (core dumped) 
```~~ 

看起来输出是正确的，但是之后它就搞砸了

代码是：

```
int process_command(char command[80]){
char curr_char;
char *word;
int start_pos;
int i;
int len;
len = strlen(command);
for(i=0,start_pos=0;i<strlen(command);i++){
    curr_char = command[i];
    if (curr_char == ' '){
        if (command[i-1]==' ') {start_pos++;continue;}
        word = malloc(i-start_pos*(sizeof(char)));
        strncpy(word,command+start_pos,i-start_pos);
        printf("%s\n",word);
        free(word);

        start_pos =i+1;

    }
    else if (curr_char == '\"'){
        word= malloc(len-i*(sizeof(char)));
        strncpy(word,command+i,len);
        printf("%s\n",word);
        free(word);
        i=len+len;
    }

}

return 0;
}
int main(){
    char buffer[80] = "Hello   WOrld  \"Hello World\"";
    process_command(buffer);
    return 0;
} 
```

 ~~问题已解决！谢谢继承人更新的代码：

```
int process_command(char command[80]){
char curr_char;
char *word;
int start_pos;
int i;
int len;
int quote=0;
len = strlen(command);
for(i=0,start_pos=0;i<strlen(command);i++){
    curr_char = command[i];
    if (curr_char == ' '){      /*If there was a space found copy the stuff before the space*/
        if ( i>0 && command[i-1]==' ') {
            start_pos++;
            continue;
        }
        word = malloc(i-start_pos+1*(sizeof(char)));
        strncpy(word,command+start_pos,i-start_pos);
        word[i-start_pos+1]='\0';
        printf("%s\n",word);
        free(word);
        start_pos =i+1;

    }
    else if (curr_char == '\"'){        /*If a quote was found, copy the rest of the string and exit loop*/
        word= malloc(len-i+1*(sizeof(char)));
        strncpy(word,command+i,len-i);
        word[len-i+1]='\0';
        printf("%s\n",word);
        free(word);
        quote=1;
        break;
    }

}if (quote==0){                 /*If there was no quote in the string, get the last element*/
    word = malloc(len-start_pos+1*(sizeof (char)));
    strncpy(word,command+start_pos,len-start_pos);
    word[len-start_pos+1]='\0';
    printf("%s\n",word);
        free (word);
    }
    return 0;
}
int main(){
    char buffer[80] = "Hello   \"WOrld  test\"";
    process_command(buffer);
    return 0;
} 
```

但是，我想知道这是否是一种有效的标记方式？这是为了处理用户输入的指令。所以如果用户输入

```
add 1 2 "SOme text" 
```

我想将查询标记为三个部分，然后对其进行处理。所以要做到这一点，我将它标记化，并将它们推入队列，稍后我可以将项目一个接一个地弹出并处理它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T00:35:34.630

您必须确保为要执行的 strncpy 分配足够的内存。这两行相差一个，因为`strncpy`也写入了一个零字节：

```
word = malloc(i-start_pos*(sizeof(char)));
strncpy(word,command+start_pos,i-start_pos); 
```

这两行没有意义：您分配 len-i 字节，然后将 len 字节（加上零字节）写入它：

```
word = malloc(len-i*(sizeof(char)));
strncpy(word,command+i,len); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T00:50:55.273

您有几个问题，其中一些是：

```
for(i=0,start_pos=0;i<strlen(command);i++){
    curr_char = command[i];
    if (curr_char == ' '){
        if (command[i-1]==' ') {start_pos++;continue;}      // accesses an invalid array offset when i == 0
        word = malloc(i-start_pos*(sizeof(char)));          // doesn't allocate space for null terminator
        strncpy(word,command+start_pos,i-start_pos);        // doesn't null terminate the string
        printf("%s\n",word);
        free(word);

        start_pos =i+1;

    }
    else if (curr_char == '\"'){
        word= malloc(len-i*(sizeof(char)));                 // doesn't allocate space for null terminator
        strncpy(word,command+i,len);                        // writes past the end of the allocated buffer
        printf("%s\n",word);
        free(word);
        i=len+len;                                          // not sure what the intent of this is?  use `break;`?
    }

} 
```

一般来说，`strncpy()`应该避免，因为它并不总是符合用户的期望，因此它经常涉及错误代码。

此外，您的报价处理非常简单 - 它假定引用的项目始终是字符串中的最后一个标记。这可能是您想要的，但它不适用于一组令牌，例如：

```
"one and two" three 
```~~

# actionscript-3 - AS3，将变量添加到函数名称

> ID：11320988
> 
> 赞同：1
> 
> 时间：2012-07-04T00:29:53.260
> 
> 标签：actionscript-3, function, variables, actionscript

我有 6 个函数，分别称为 callClip1、callClip2、callClip3 等。

我曾计划写出 6 个 else/if 语句，以便在需要时调用其中的每一个，但我认为它可以（可能）以另一种方式完成。我可以调用一个名为“callClip”的函数并在其末尾添加一个我在其他地方设置的变量吗？那么如果变量设置为 3，它会将 callClip + 3 放在一起并调用该函数吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-04T00:34:38.387

这可以通过一个 switch 块来完成：

用作： `callClip(1);`

```
function callClip(number:int):void
{
    switch(number)
    {
        case 1:
            callClip1();
            break;
        case 2:
            callClip2();
            break;
        case 3:
            callClip3();
            break;
        case 4:
            callClip4();
            break;
        case 5:
            callClip5();
            break;
        case 6:
            callClip6();
            break;
    }
} 
```

虽然我不推荐它，但这也可以实现为：

```
function callClip(number:int):void
{
    this["callClip" + number]();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-04T01:02:55.860

添加到杰森的答案，你也可以这样做：

```
// Store references to each method.
var methods:Vector.<Function> = new <Function>[
    callClip1, callClip2, callClip3,
    callClip4, callClip5, callClip6
];

// Call relevant callClip function.
function callClip(num:int):void
{
    methods[num-1]();
} 
```

# ruby-on-rails - 您可以在 Backbone 中对方法进行字符串处理吗？

> ID：11320994
> 
> 赞同：1
> 
> 时间：2012-07-04T00:30:20.663
> 
> 标签：ruby-on-rails, backbone.js, coffeescript

假设我想`where`和`pluck`我的应用程序的鸟。

首先我想找到所有`word_type`的名词。

然后我想采摘`word`属性，这样最终的结果是：

所有属于名词的词。

```
["Lion", "Capybara", "Cat"] 
```

当我尝试：

```
@words = new Project.Collections.WordsCollection()
@words.where(word_type: "noun").pluck("word_type") 
```

它返回：

```
this.words.where({word_type: "noun"}).pluck is not a function 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T01:32:01.830

问题是它`where`返回一个模型数组，并且该数组没有混合任何下划线方法。您可以展开`pluck`（实际上只是特定类型的`map`）：

```
_(@words.where(work_type: 'noun')).map (m) -> m.attributes.word_type 
```

或使用[下划线混合](http://backbonejs.org/#Collection-Underscore-Methods)：

```
@chain()
    .filter((m) -> m.attributes.word_type == 'noun')
    .map((m) -> m.attributes.word_type)
    .value() 
```

或者，由于您正在过滤和采摘相同的东西，您可以计算匹配项并在之后构建您的数组：

```
n = @reduce(
    ((n, m) -> n += (if m.attributes.word_type == 'noun' then 1 else 0)),
    0
)
matches = ('noun' for i in [0 ... n]) 
```

# ruby-on-rails - 覆盖 has_many 关联以使用两个不同的 owner_id

> ID：11320995
> 
> 赞同：0
> 
> 时间：2012-07-04T00:30:31.603
> 
> 标签：ruby-on-rails, activerecord

我有两个模型：用户和通知。

```
User has_many :notifications
Notification belongs_to User 
```

这是通知的描述代码

```
+------------+--------------+------+-----+---------+----------------+
| Field      | Type         | Null | Key | Default | Extra          |
+------------+--------------+------+-----+---------+----------------+
| id         | int(11)      | NO   | PRI | NULL    | auto_increment |
| user_id    | int(11)      | YES  |     | NULL    |                |
| namespace  | varchar(255) | YES  |     | NULL    |                |
| key        | varchar(255) | YES  |     | NULL    |                |
| value      | tinyint(1)   | YES  |     | NULL    |                |
+------------+--------------+------+-----+---------+----------------+ 
```

这些是一些通知示例：

```
+----+---------+-----------+-----------------+-------+
| id | user_id | namespace | key             | value |
+----+---------+-----------+-----------------+-------+
|  4 |      -1 | facebook  | launch_campaign |     1 |
|  5 |      -1 | facebook  | add_video       |     1 |
|  6 |      -1 | facebook  | add_image       |     1 |
|  7 |      -1 | twitter   | add_image       |     1 |
|  8 |      -1 | twitter   | add_video       |     1 |
|  9 |      -1 | twitter   | launch_campaign |     1 |
|  10|      21 | facebook  | add_video       |     0 |
|  11|      1  | facebook  | add_image       |     0 |
|  12|      10 | twitter   | add_image       |     0 |
|  13|      12 | twitter   | add_video       |     0 |
+----+---------+-----------+-----------------+-------+ 
```

user_id = -1 的行是默认值，每次用户覆盖默认值时，我都会为该用户添加一行以及命名空间和操作以及覆盖的值。

现在，如果我这样做，我会发怒

```
User.notifications 
```

我只会获得其中包含 user_id 的通知，但我还想获得用户尚未覆盖的默认通知 (use_id = -1)。任何想法如何做到这一点？还感谢有关此设计/主题的更多建议:)！

这也是我设计 [数据库+数据模型设计模式的更详细的解释](https://stackoverflow.com/questions/11303854/data-base-data-model-design-patter/11304238#11304238)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T15:30:30.370

我认为您可以尝试`:conditions`为您的关联使用选项：

```
has_many :notifications, :conditions => 'user_id = #{id} OR user_id = -1' 
```

**注意：**这不是插值字符串，它将在对象而不是类的上下文中进行插值。

**更新。**

或者甚至`:finder_sql`会足够好。[不管怎样，这里](http://apidock.com/rails/ActiveRecord/Associations/ClassMethods/has_many)有很多有趣的生活。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T03:59:46.550

在您的 User 类中尝试使用范围，而不是直接使用 has_many 关系。像这样的东西：

```
scope :all_notifications, joins("left join notifications n on n.user_id=users.id").where(["n.user_id=? OR n.user_id=?", self.id, -1]) 
```

# java - 在 Eclipse 中的 Android dex'ing 之前始终运行 proguard

> ID：11320998
> 
> 赞同：6
> 
> 时间：2012-07-04T00:30:38.203
> 
> 标签：java, android, eclipse, proguard

尝试运行 Android 应用程序时，有没有办法让 Eclipse在 dex'ing 之前*始终运行 proguard？*例如某种无缝插入它作为构建步骤的方式？

默认情况下它会在导出时运行，但我需要它始终运行，即使只是从菜单/键盘执行正常的“运行”或“调试”。

* * *

对于上下文，这是相关的原因是我遇到了“操作码太多/没有扩展的操作码”（http://code.google.com/p/android/issues/detail?id=26203）问题我在 Eclipse 中构建。对于 ant 构建来说这不是问题，因为它们运行 proguard，它会剥离所有未使用的代码。到目前为止，我一直在手动从第三方依赖项中删除未使用的东西，但这有点荒谬。

此外，作为附带的好处，它应该会大大加快我的构建速度，因为仅收缩的 proguard 运行方式比 dex'ing 快得多，并且它删除了大部分需要 dex'ed 的代码。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-04T14:38:30.343

此行为在 Android 开发工具中的 Eclipse 插件的构建器中进行了硬编码。您可以调整其源代码 ( [Android Tools](http://tools.android.com/overview) )，使构建器的行为更像导出向导（或者在内部，BuildHelper 类的行为更像 ExportHelper 类）。不过，这可能不是很有趣。

或者，您可以从 Eclipse 运行 Ant。

另外，ProGuard 的商业闭源兄弟[DexGuard](http://www.saikoa.com/dexguard)集成了 ProGuard 和 dx（以及 apkbuilder、jarsign、zipalign）的功能。它可以配置为在 Eclipse 和 Ant 中为调试/发布构建收缩/混淆/优化。

（我是 ProGuard 和 DexGuard 的开发者）

# visual-studio-2010 - 是否有针对 knockout.js 的语法检查器？

> ID：11320999
> 
> 赞同：0
> 
> 时间：2012-07-04T00:30:41.600
> 
> 标签：visual-studio-2010, knockout.js

我喜欢knockout.js，唯一的问题是Visual Studio对这个框架一无所知，所以它不会阻止我做一些愚蠢的事情，比如用'='运算符为可观察属性分配一些值，这使它成为常规属性，而且不容易在编译时显示，甚至经常在运行时显示。我想知道 Visual Studio 2010 是否有任何语法检查器/荧光笔可以帮助我防止此类错误？VS 2011 怎么样？对于刚接触淘汰赛的开发人员来说，这可能是一个很大的帮助。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T03:11:00.697

在 2010 年，您可以通过在 JS 文件顶部使用以下语法引用它们来获取 IntelliSense for JavaScript 库。

```
/// <reference path="ScriptFile1.js" /> 
```

此链接应提供更多信息：[JScript IntelliSense 概述](http://msdn.microsoft.com/en-us/library/bb385682.aspx)

VS 2012 你甚至不必这样做......