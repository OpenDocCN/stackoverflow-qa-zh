# StackOverflow 问答 10551000-10551999

# python - 所有迭代后的 Python 保存矩阵

> ID：10551000
> 
> 赞同：0
> 
> 时间：2012-05-11T12:05:47.783
> 
> 标签：python, file, numpy, save

通过这个命令我可以保存结果：

```
np.savetxt('Result.txt', phi) 
```

，但我想保存这个文件一百次。例如，我有 100 次迭代，使用不同的 phi-s，我想保存一百个文件：

```
Result1.txt,
Result2.txt,
.
.
.
Result100.txt. 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T12:06:40.647

如果您有一个`phi`名为的数组列表`phis`：

```
for i, phi in enumerate(phis, 1):
    np.savetxt('Result{0}.txt'.format(i), phi) 
```

或者

```
for i, phi in enumerate(phis):
    np.savetxt('Result{0}.txt'.format(i+1), phi) 
```

这相当于：

```
np.savetxt('Result1.txt', phis[0])
np.savetxt('Result2.txt', phis[1])
np.savetxt('Result3.txt', phis[2])
np.savetxt('Result4.txt', phis[3])
… 
```

并且适用于任何长度`phis`。

或者，如果它发生在迭代中：

```
for i in xrange(100):

   # phi = something()

   np.savetxt('Result{0}.txt'.format(i+1), phi) 
```

# php - array_unique 在 php 中没有按预期工作

> ID：10551001
> 
> 赞同：2
> 
> 时间：2012-05-11T12:05:51.987
> 
> 标签：php, array-unique

这是一个问题。我正在按数组中的换行符分解字符列表。并在其上做唯一的数组。但它没有按预期工作。下面是代码：

```
$list = "test
ok
test
test
ok
ok
test";
$list_explode = explode("\n", $list); //exploding the characters of the list from the input
//displaying unique 

array_map('trim', $list_explode);
$result = array_unique($list_explode);
print_r($result); 
```

结果是

`Array ( [0] => test [1] => ok [6] => test )`

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-11T12:09:20.810

使用`var_dump`而不是，`print_r`你会看到“测试”之间的区别（[看看codepad](http://codepad.org/dqjVCUMu)）。

您的代码包含`\r\n`换行符，并且您正在拆分`\n`，因此`\r`除最后一个之外的所有条目仍然存在。

您已经使用`array_map`它来防止这种情况，但忘记在后面的代码中使用 retun-value （它不能通过引用工作）。将该行更改为：

```
$list_explode = array_map('trim', $list_explode); 
```

完成此操作后，您将得到您所期望[的（再次参见键盘](http://codepad.org/ulZg9vAe)）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T12:08:34.990

您没有考虑到您的字符串具有`\r\n`换行符的序列。在爆炸时，您只删除了该`\n`部分，因此您的结果实际上看起来像：

```
Array ( [0] => test\r [1] => ok [6] => test ) 
```

但是，`\r`不会打印为可见字符（即使代码看到它）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-11T12:11:33.387

您可以通过两种主要方式拆分多行文本：

1.  采用`$list_explode = array_map('rtrim', explode("\n", $list));`

2.  采用`$list_explode = preg_split("/\r?\n/", $list);`

# javascript - 如何在网页上查找破坏 HTTPS 的元素？

> ID：10551004
> 
> 赞同：8
> 
> 时间：2012-05-11T12:05:58.650
> 
> 标签：javascript, html, https

是否有一种简单的方法（可能通过 firefox 插件或其他方式）来判断网页上的哪个元素破坏了 HTTPS 连接？

我搜索了任何“http”的来源，但没有找到。我认为问题的根源在于某个地方的 javascript 文件，但我希望比逐行浏览所有 javascript 文件更容易缩小范围。

任何简单的解决方案或建议？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T12:12:36.317

我不了解 Firefox，但 Google Chrome 会在控制台中显示所有不安全的内容源。

例如：

> [https://mail.google.com/mail/u/0/?shva=1#inbox](https://mail.google.com/mail/u/0/?shva=1#inbox)上的页面显示来自[http://example.com](http://example.com)的不安全内容。

等等。

# mod-rewrite - apache mod 用 the_request 重写

> ID：10551007
> 
> 赞同：0
> 
> 时间：2012-05-11T12:06:08.760
> 
> 标签：mod-rewrite

我想用 apache 做以下事情（mod rewrite）。

1.  如果用户请求[http://hostname.tld/index.php/folder/subfolder](http://hostname.tld/index.php/folder/subfolder)我希望它重定向（使用 R=301）到[http://hostname.tld/folder/subfolder](http://hostname.tld/folder/subfolder)。

2.  如果用户请求[http://hostname.tld/folder/subfolder](http://hostname.tld/folder/subfolder)，则该请求应在内部重写为 index.php/folder/subfolder。

为了防止无休止的重定向，第一条规则应该检查 %{THE_REQUEST}。这里的问题是我无法用正则表达式附加“文件夹/子文件夹”。我该怎么做？

对于第二条规则，我有这个（并且似乎有效）。

```
RewriteCond %{HTTP_HOST} hostname.tld [NC]
RewriteRule ^(.*)$ index.php [QSA,L] 
```

第一个还是有问题的。

我认为第一个应该是

```
RewriteCond %{THE_REQUEST} (.*)index.php(.*) [NC]
RewriteRule /index.php/$ http://hostname.tld/$1 [R=301,QSA,L] 
```

但事实并非如此。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T16:17:01.530

第一个应该是。

```
RewriteCond %{HTTP_HOST} ^hostname\.tld$ [NC]
RewriteCond %{THE_REQUEST} index\.php [NC]
RewriteRule ^index.php/(.*)$ http://hostname.tld/$1 [R=301,L] 
```

我还看到您的第二条规则重定向 `http://hostname.tld/folder/subfolder`到 `http://hostname.tld/index.php`（不是`http://hostname.tld/index.php/folder/subfolder`）。但只要这样就可以了，因为它也可以防止重定向循环。但以防万一，这里是添加文件夹/子文件夹部分的解决方案：

```
RewriteCond %{HTTP_HOST} ^hostname\.tld$ [NC]
RewriteCond $1 !^index\.php
RewriteRule ^(.*)$ index.php/$1 [QSA,L] 
```

# android - 如何使 ProgressBar 无法恢复？

> ID：10551016
> 
> 赞同：2
> 
> 时间：2012-05-11T12:06:54.803
> 
> 标签：android, progress-bar

我有一个 ProgressBar，用于选择从 0 到最大值的值，现在一切正常，但是有时我想限制 ProgressBar 不能向后滚动。该栏用于选择最大玩家，稍后会选择玩家，我想阻止将最大玩家设置为低于所选玩家的能力。

这意味着如果栏设置为 6，在某些情况下我想让它无法向后滚动，但只能向前滚动。

**我不想改变 minimum**，因为那会改变酒吧。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T12:14:33.197

您可以继承`MyProgressBar`并`ProgressBar`覆盖`setProgress()`您自己的版本，这将检查新值是否大于当前值。

# asp.net - ASP.NET 服务声明数据集

> ID：10551018
> 
> 赞同：1
> 
> 时间：2012-05-11T12:06:59.523
> 
> 标签：asp.net

我想从我的数据库中获取信息到网格视图。我有以下内容，但我不确定在何处以及如何声明数据集，因为此方法不起作用：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;

namespace ConsumeDSetService
{
public partial class _Default : System.Web.UI.Page
{

    public class MyDataSet
    {
        public static DataSet ds;
    }

    protected void Page_Load(object sender, EventArgs e)
    {

    }

    protected void Button1_Click(object sender, EventArgs e)
    {
        localhost.Service1 myws = new localhost.Service1();
        ds = myws.GetDataSet();
        GridView1.DataSource = ds;
        GridView1.DataBind();

    }
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T12:10:03.367

我猜这段代码不能编译？`ds`是 MyDataSet 类的一个属性，因此您需要`MyDataSet.ds`从单击按钮时引用它，这是该类的一部分`_Default`

# jenkins - Jenkins 继续测试

> ID：10551019
> 
> 赞同：0
> 
> 时间：2012-05-11T12:07:01.990
> 
> 标签：jenkins

我想使用 Jenkins 继续测试。工作场景应如下所示： 1\. 连接到 svn，调用脚本以签出 repo，构建并运行测试。测试将例如检查某些输出文件中的数字是否与参考文件中的相同。所有脚本都在python中。问题是 - 当文件中的数字不同时，如何强制 Jenkins 将工作指示为“失败”？

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-12T07:50:55.920

通常你会稍微不同地使用 Jenkins。完全可以做你想做的事，但 Jenkins 和 python 可以为你省去一些工作。

首先，Jenkins 能够从包括 Subversion 在内的各种版本控制系统中检查内容。这是使用 Jenkins 的常用方法。设置作业时，您需要告知版本控制存储库的地址，然后配置在文件签出后执行的步骤。

其次，您应该使用 python 测试框架[http://docs.python.org/library/unittest.html](http://docs.python.org/library/unittest.html)来编写您的测试。然后您可以使用例如nosetests 实用程序来运行测试。Nosetests 甚至可以创建 xml 格式的测试报告，Jenkins 可以阅读报告并向您显示哪些测试失败以及失败的原因（如果报告包含该信息。）

但是要回答您的问题：如果您使用非零退出代码退出构建步骤，詹金斯将解释为构建失败，并将用红球标记该构建。

Jenkins 可以将构建标记为稳定（绿色）、不稳定（黄色）和失败（红色）。如果构建步骤以非零退出代码退出，则构建失败。如果构建步骤以零退出，则可以将 Jenkins 配置为查找测试报告文件。如果测试报告未通过测试，则构建将不稳定。如果所有测试都通过了，则构建是稳定的。

通常人们使用失败（红色）表示测试中的致命问题（例如未能安装应测试的软件），然后使用测试报告表示不稳定或稳定的构建。

# php - 在登录过程中使用 OOP 的方法

> ID：10551026
> 
> 赞同：0
> 
> 时间：2012-05-11T12:07:38.033
> 
> 标签：php, oop

在当前的登录方式中：

```
 $sth = $this->db->prepare("SELECT id, username, active FROM user WHERE username = ? AND password = ?");
        $sth->setFetchMode(PDO::FETCH_OBJ);
        $sth->execute(array($username, $password));

        if (($obj = $sth->fetch()) !== FALSE)
            return $obj; 
```

在 login.php 文件上。

```
$auth = new Auth($db);

$user = $auth->login('username', 'password');

if ($user) {
    if ($user->active == 0) { die('You must activate your account')}

    //If all is okay... Set the session variables...
} 
```

但是有人告诉我，我宁愿在 login() 方法中设置会话变量，但如果我这样做了，我应该如何处理检查，例如用户是否被激活？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T12:23:39.117

我可能会创建一个这样的结构：

```
class Auth {
  public function login($user, $pass);
  public function logout();
  public function loggedIn();

  private function getUserSession();
  private function updateUserSession();
  private function deleteUserSession();
} 
```

login() 检查数据库和验证成功（如果用户处于活动状态，用户：密码匹配和其他测试）运行 updateUserSession()。最后返回 $this->loggedIn() 的结果。

logout() 使用 deleteUserSession() 取消设置会话。

loggedIn() 使用 getUserSession() 检查会话，如果用户已登录，则返回 true 或 false。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T12:20:51.027

您可以在任一过程中执行此操作。会话变量是相同的。

要检查活动用户，只需在查询中添加“and userActive = 1”。要停用用户，只需将此列更改为该用户的 0。

# delphi - 德尔福 2006 中的 MIDIYOKE

> ID：10551028
> 
> 赞同：4
> 
> 时间：2012-05-11T12:07:55.657
> 
> 标签：delphi, midi, delphi-2006

我正在使用 delphi 中的应用程序。我需要使用**MIDIYOKE**将输出从我的应用程序发送到另一个应用程序。第二个应用是虚拟钢琴键盘。

![在此处输入图像描述](../Images/c322a9cc79f9bdf3eee3f7db3935d23b.png)

我安装了所有的软件包并在 delphi 中获得了 MIDI 组件。

我尝试使用 MidiOutputPort1 和 MidiInput1 组件。我尝试播放一个 MIDI。代码如下：

```
procedure TForm3.Button1Click(Sender: TObject);
var
outputPort : TMidiOutputPort;
begin
 outputPort := TMidiOutputPort.Create (Nil);
   try
    outputPort.PortId := -1;
    outputPort.Active := True;
    outputPort.PatchChange(0, 127, 0); // Gunshot
    outputPort.NoteOn (1, 20, 127);    // Play note at full volume

    Sleep (1000);
    outputPort.NoteOff (0, 60, 0);
finally
outputPort.Free
end
end; 
```

我想在我的应用程序和虚拟钢琴键盘之间建立连接。如何使用 MidiOutputPort1 和 MidiInput1 进行两者之间的连接。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T15:21:06.953

我认为您应该将其中一个轭端口的端口号放在 portid 属性中。

要知道要使用哪个 id，您必须枚举可用端口，因为如果添加硬件或更改 midi yoke 配置，id 可能会发生变化。

因此，要记住用户选择了哪些端口，您需要存储设备名称，并希望用户不要重命名其设备:)

如果这对您继续工作有足够的帮助，请告诉我；否则我会挖掘一些旧代码来做你想做的事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-12T13:20:08.057

如果两个应用程序都支持 MIDI 同步，您可以使用 MIDI 同步。在这种情况下，MIDIYOKE 是主设备，Vpk 是从设备。同步由以下命令处理：

```
mc_MIDI_Timing_Clock           = $F8;
mc_MIDI_Start                  = $FA;
mc_MIDI_Continue               = $FB;
mc_MIDI_Stop                   = $FC; 
```

我在很久以前就用过它，所以我的知识有点生疏。我可以从我的代码中收集到它的工作原理如下：将从属设置为从属/同步接收/无论它被称为模式。接下来将 $FA 发送到您选择的频道。一些（不是全部）从站要求您收听特定的频道。

在每个时钟滴答声中，首先发送 $F8。接下来发送消息，前面是 $FB 消息（两个数据字节都为零）。当你准备好发送 $FC。

# asp.net-mvc-4 - 在 MVC 4.0 Web Api 早期向客户端提供数据

> ID：10551030
> 
> 赞同：1
> 
> 时间：2012-05-11T12:08:00.960
> 
> 标签：asp.net-mvc-4, asp.net-web-api

使用 MVC 4.0 Web Api 我有一个长时间运行的数据库查询，它异步运行，在它完成之前，控制器完成其“获取”或“发布”操作。这一切都符合预期/想要的。

然而，尽管看起来 MVC 已将数据发送回客户端，但在长时间运行的查询完成之前，实际上并没有传输任何数据。

有什么方法可以强制将数据提前“输出”给客户端，甚至创建和传输新的响应？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T14:32:14.220

> 关键是我不需要查询的结果 - 我只想触发并忘记，并且立即向客户端返回响应（说查询已经开始）很重要

如果是即发即弃且您不需要将结果发送给客户端，只需启动任务

```
Task.Factory.StartNew(() => db.DoThatQueryThatBroughtDownChicago()); 
```

并返回一个字符串，一个 JSON 结果显示“任务已启动”。

# sql - 将多个表合并为一个下一个 ID

> ID：10551033
> 
> 赞同：0
> 
> 时间：2012-05-11T12:08:04.580
> 
> 标签：sql, sql-server, database, tsql, join

我有十几个具有以下格式的表格：

**表格1**

```
[idA] [numA]
 NULL   8
 1      10
 2      15
 3      16 
```

**表 2**

```
[idB] [numB]
 2      14
 3      30
 4      32 
```

**表3**

```
[idC] [numC]
 NULL   56
 1      24
 4      37
 5      36 
```

**...**

现在，我不确定如何制定 T-Sql 查询以产生以下结果：

```
[id] [numA] [numB] [numC] ...
NULL  8      0      56
1     10     0      24
2     15     14     0
3     16     30     0
4     0      32     37
5     0      0      36 
```

关于如何解决这个问题有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T13:16:22.463

我提供了一个完全外连接的解决方案，因为这似乎是一种自然的方法：

```
SELECT coalesce(a.id, b.id, c.id, . . .) as id,
       a.NumA, b.NumB, c.NumC, . . .
FROM TableA a full outer join
     TableB b
     on a.id = b.id full outer join
     TableC c
     on coalesce(a.id, b.id) = c.id 
```

但是，需要仔细编写查询，以使合并保持一致。这种方法的一个优点是它应该在查询的 id 列上使用索引。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T13:27:11.327

请试试这个

```
select id, max(numa),max(numb),max(numc) from
(
select id,numa,0 as numb,0 as numc from tb1
union all
select id,0 as numa,numb as numb,0 as numc from tb2
union all
select id,0 as numa,0 as numb,numc as numc from tb3
)X
group by id
order by id 
```

谢谢拉贾特

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T12:23:27.483

```
SELECT Maintable.id, 
       Table1.numA, 
       Table2.numB, 
       Table3.numC 
FROM   (SELECT ida AS id 
        FROM   Table1 
        UNION 
        SELECT idb AS id 
        FROM   Table2 
        UNION 
        SELECT idc AS id 
        FROM   Table3) MainTable 
       LEFT JOIN Table1 
         ON Maintable.id = Table1.Ida 
       LEFT JOIN Table2 
         ON Maintable.id = Table2.idB 
       LEFT JOIN Table3 
         ON Maintable.id = Table3.idC 
```

# mysql - 无法执行 mysql 查询

> ID：10551040
> 
> 赞同：0
> 
> 时间：2012-05-11T12:08:25.583
> 
> 标签：mysql

我无法执行一个查询。我想从 2 个表 tbl_order_detail 和 tbl_order_lead_send_detail 中获取结果，其中 tbl_order_detail 具有dealer_id，所以我想将该dealer_id 转换为dealer_name（表tbl_order_lead_send_detail 中提到了dealer_name）

```
SELECT tbl_order_detail.*, tbl_order_lead_send_detail.dealer_name 
where tbl_order_detail.order_status='Active' 
```

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T12:09:53.013

```
 select tbl_order_detail.*, tbl_order_lead_send_detail.dealer_name 
    from tbl_order_detail, tbl_order_lead_send_detail
    where tbl_order_detail.order_status='Active' 
```

从子句中缺失

但是您还需要将这两个表连接在一起吗？什么链接他们？

其中 tbl1.field1=tbl2.field5

例如

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T12:14:36.520

您错过了查询中的 from 子句。

没有连接条件的查询将创建两个表的笛卡尔积，您将获得结果中的行数 =（表 1 中的行数 * 表 2 中的行数）每个可能的组合。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T12:45:30.110

> SELECT od.*, olsd.dealer_name from tbl_order_detail od join tbl_order_lead_send_detail olsd ON od.dealer_id=olsd.dealer_id where od.order_status='Active'

首先查询有错误，你还没有定义任何表和

其次，我通过dealer_id 假设了这些表之间的关系，即两者都有dealer_id 共同......这是你想要的吗？

如果您对联接不太了解，请参阅[此](http://dev.mysql.com/doc/refman/5.0/en/join.html)或 [此](http://mysqljoin.com/)

# html - 如何使用 clear:both？

> ID：10551041
> 
> 赞同：3
> 
> 时间：2012-05-11T12:08:30.500
> 
> 标签：html, css

```
<div class="one">aaaaaaaaaa </div>
<div class="one">bbbbbbbbbb </div>
<div class="one">ccccccccccc </div>
<span style="clear: both">
    THIS SHOULD BE BELOW TABLE. WHY NOT?

.one {
  background-color: red;
  float: left;
} 
```

[http://jsfiddle.net/bLsju/2/](http://jsfiddle.net/bLsju/2/)

为什么在这个例子中仍然是浮动的？我如何使用 clear:both？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-11T12:11:00.623

`clear`如果元素不是块元素，则忽略该属性。在 span 上使用 `style="display: block"`或使用 div，它是一个块元素。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-11T12:10:54.970

将 更改`span`为`div`. 它适用于块元素。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-11T12:12:12.847

Clear 仅适用于具有显示类型块的元素。添加`display: block;`以使其按预期工作。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-05-11T12:17:58.833

你能检查一下这个[DEMO](http://jsfiddle.net/bLsju/7/)吗，它可能对你有帮助。使用 DIV 而不是跨度。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-05-11T12:10:32.313

使用 div 而不是 span，因为 span 是内联元素。您可以为块元素编写 clear 。

[http://jsfiddle.net/bLsju/2/](http://jsfiddle.net/bLsju/2/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-05-11T12:12:54.377

```
 <div style="clear: both">&nbsp;</div> 
```

而不是 span 因为它的内联元素

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-05-16T12:34:06.047

问题是跨度不是块元素。要么让它阻塞。通过使用“display:block”作为样式属性

或者你可以使用 div 而不是 span

看到这两个链接：

jsfiddle.net/bLsju/7/

jsfiddle.net/wmT9w/

你会很容易理解的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-09-16T03:34:44.080

使用一个 div。如果您坚持跨度，请执行以下操作：

```
<span style="display:block;clear: both"></span> 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2012-05-11T12:12:42.817

clear:both 使元素下降到文档中它之前的任何浮动元素之下。

重复：[style="clear:both" 的用途是什么？](https://stackoverflow.com/questions/1012131/what-is-the-use-of-style-clearboth)

# python - 在 pyramid_jqm 中使用 sqlalchemy

> ID：10551042
> 
> 赞同：0
> 
> 时间：2012-05-11T12:08:30.810
> 
> 标签：python, sqlalchemy, pyramid

我知道金字塔带有 sqlalchemy 的脚手架。但是如果我使用的是 pyramid_jqm 脚手架怎么办。那么您将如何集成或使用 sqlalchemy？当我创建一个 model.py 并从 sqlalchemy 导入时，我收到一个错误，他找不到模块。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T17:06:57.243

您必须以与构建炼金术脚手架相同的方式设置项目。将“sqlalchemy”放入您的 setup.py requires 字段并运行“python setup.py develop”以安装依赖项。这只是 python，与 Pyramid 无关。

# c# - 为什么 ajax 更新面板一直在等待，而请求在服务器上完全处理。是否有数据未接收到 ajax 面板？

> ID：10551043
> 
> 赞同：0
> 
> 时间：2012-05-11T12:08:33.197
> 
> 标签：c#, ajax, azure

我正在创建一个 azure 应用程序，它在 azure sql server 上有数据库。在我的一个页面上，我有文件上传控件，我用它来上传 Excel 文件，该文件在第一张表的一个表中包含一些数据。像 50 行和 8 列。现在上传文件后，我点击处理按钮，处理每一行并对每一行进行一些验证，并将有效行保存在数据库中。然后我把这个保存的数据放在pdf文件上。所有这些处理每行需要 2 秒。我已经使用更新面板发送了一个异步请求。

在服务器端，请求完成，即行被处理并保存在数据库中，但在客户端，我只能在页面上看到数据来自服务器的 ajax 加载器图像，请稍候。它一直等到我在脚本管理器中放置了 1000 秒的异步超时。超时后它再次发送请求。

我不明白为什么它要等到超时并且没有向我显示任何我正在等待的已处理行数和行中发生错误的消息？另外为什么超时后重新发送请求？我

谁能帮我解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T19:35:13.247

服务器是否响应它已完成？您应该会看到一些通信返回给客户端。您还可以执行以下操作来处理超时错误而不重新发送请求：

```
<script type="text/javascript">  
        Sys.WebForms.PageRequestManager.getInstance().add_endRequest(function (sender, args) {  
            if (args.get_error() && args.get_error().name === 'Sys.WebForms.PageRequestManagerTimeoutException') {  
                            args.set_errorHandled(true);  
            }  
        });  
</script> 
```

# php - PHP exec ImageMagick 总是返回 0

> ID：10551044
> 
> 赞同：0
> 
> 时间：2012-05-11T12:08:33.400
> 
> 标签：php, imagemagick, exec, imagick

我正在尝试让 ImageMagick 为我计算 PDF 文件中的页数。功能如下：

```
<?php
function countPdfPages($filepath)
{
    $magick = "identify -format %n ".$filepath;
    exec($magick, $debug, $result);
    return $result;
}
?> 
```

但是，该函数始终返回`0`. 我已经验证 ImageMagick 运行正常，所以这应该不是问题。我没有`exec()`正确使用吗？我应该以另一种方式检索输出吗？我也尝试过使用`$debug`，但奇怪的是，这并没有给我任何输出。

我敢打赌我在这里做了一些愚蠢的事情，但我只是没有看到。谁能给我推动正确的方向？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T12:22:58.487

如[手册页](http://php.net/manual/en/function.exec.php)所述，通过第三个参数`exec`提供已执行命令的*返回状态*。值`0`表示它正常退出。听起来您应该使用类似[`popen`](http://www.php.net/manual/en/function.popen.php).

[`fread`这是从手册页](http://www.php.net/manual/en/function.fread.php)的示例 #3 中提取的示例（编辑为使用`popen`）：

```
<?php
// For PHP 5 and up
$handle = popen("identify -format %n myfile.jpg", "r");
$contents = stream_get_contents($handle);
pclose($handle);
// $contents is the output of the 'identify' process
?> 
```

# asp.net-mvc-3 - 有没有办法在 Asp.net MVC3 中使用数据注释删除属性？

> ID：10551046
> 
> 赞同：1
> 
> 时间：2012-05-11T12:08:35.987
> 
> 标签：asp.net-mvc-3, data-annotations

```
Public class UserMetdata
  {
    [Required]
    [Display(Name="User ID")]
    public int UserID { get; set; }

    [Display(Name="User Name")]
    public string UserName { get; set; }

} 
```

我不希望用户名显示在视图中。它类似于创建不需要的注释。一种解决方案是**删除用户名表单类，但我不希望这样**。如何使用数据注释来完成。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T12:10:42.510

您可以对该属性使用[ScaffoldColumnAttribute](http://msdn.microsoft.com/en-us/library/system.componentmodel.dataannotations.scaffoldcolumnattribute.aspx)

```
[ScaffoldColumn(false)]
public string UserName { get; set; } 
```

**仅**当您让框架通过调用`@Html.DisplayForModel()`或类似方法动态生成视图，并且您**没有**`Views/Shared/DisplayTemplates`在or处为该模型定义显示模板时，这才有效`Views/ControllerName/DisplayTemplates`。否则，您应该编辑该显示模板并从中删除相应的行

# mysql - 在mysql中选择部分表列数据

> ID：10551051
> 
> 赞同：6
> 
> 时间：2012-05-11T12:09:01.220
> 
> 标签：mysql

我有一个包含 2000 个条目的表“照片”。该表有一个名为的列`photo_note`，其中包含以下格式的数据，但具有不同的放大率值。

```
Magnification 30x. The resolution varies depending on..... 
```

我需要选择以“分辨率”开头的其余列数据并将其附加到另一个字段“photo_note_2”中

任何关于如何在 mysql 中执行此操作的建议都非常感谢

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-05-11T12:18:52.507

`SUBSTRING`让您返回字符串的一部分。`INSTR`返回一个字符串在其他字符串中的位置。

如果您知道所有列都将具有“分辨率”，那么：

```
SELECT SUBSTRING(photo_note, INSTR(photo_note, 'The resolution')) from table; 
```

如果你知道所有都会有一个'x。' 在要检索的字符串之前，然后

```
SELECT SUBSTRING(photo_note, INSTR(photo_note, 'x. ') + 3) from table; 
```

[您可以在此处](http://dev.mysql.com/doc/refman/5.5/en/string-functions.html)查看 mysql 的所有字符串函数。

# html - 在链接上嵌入带有目标的更改 src

> ID：10551055
> 
> 赞同：1
> 
> 时间：2012-05-11T12:09:18.393
> 
> 标签：html

使用 iFrame 和 html 链接，我可以使用 html 链接的 TARGET 属性并为 iframe 设置名称来更改 iframe 的 src。这很好用...

如何使用嵌入而不是 iframe 来做同样的事情？

所以我从

`<embed name="test1" src="http://www.example.com"></embed>`

如果有帮助，嵌入在对象类中。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T12:25:31.433

Javascript :)

```
<a onclick="document.getElementById('emb').src='whatever'">Whatever</a>
<a onclick="document.getElementById('emb').src='whatever2'">Whatever2</a>
<embed id="emb" src="default"></embed> 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-05-11T12:23:22.907

不，你不能。只需使用 iframe。

# ios - 如何在 Xcode 中传递数据并动态放入表中

> ID：10551059
> 
> 赞同：0
> 
> 时间：2012-05-11T12:09:30.183
> 
> 标签：ios, objective-c, xcode

如何将数据传递到另一个视图并显示或放入动态表中？

如果我有这样的动作：

```
- (IBAction)steeperchange:(id)sender {
    Quintity1.text = [NSString stringWithFormat:@"%.f", x.value];
    res1 = x.value * suop;
    Cost.text = [NSString stringWithFormat:@"%.3f", res1 + res2];
    suop_q1 = Quintity1.text.intValue;
    Soup_total = res1 + res2;

    //to save data btween view 
    NSString *Quit1value = Quintity1.text;
    NSString *costvalue = Cost.text;

    // Store the data
    NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
    [defaults setObject:Quit1value forKey:@"Quit1value"];
    [defaults setObject:costvalue forKey:@"costvalue"];
    [defaults synchronize];
} 
```

如果我点击这个更陡峭，我想保存（`Quintity1.text.intValue`以及价格和mil的名称）所有这些都定义为全局变量。

如果仅单击，我想移至最终视图。我有许多更陡峭的变化。

餐厅菜单等项目；
我想最终查看打印所有内容。如何做到这一点>>>请有任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T13:24:01.917

听起来您需要使用接收视图控制器中的公共属性传递所需的数据。如果没有看到更多代码（接收 VC 的代码）并且不知道您是如何转换的（故事板或 nib），将很难为您提供更多帮助。

# android - 使用 ItemizedOverlayWithFocus 的代码

> ID：10551061
> 
> 赞同：0
> 
> 时间：2012-05-11T12:09:44.690
> 
> 标签：android, osmdroid

目前使用 OSMdroid 库中的 ItemizedIconOverlay

```
import org.osmdroid.views.overlay.ItemizedIconOverlay; 
```

我这样设置参数：

```
public class OsmActivity extends Activity implements LocationListener{
    private ItemizedIconOverlay<OverlayItem> mMyLocationOverlay
...
} 
```

我以这种方式添加项目：

```
 mItems.add(new OverlayItem("Title 2", "Sample Description2", new GeoPoint((int)(35.1359488*1E6),(int)(33.3336289*1E6))));
    mItems.add(new OverlayItem("Title 3", "Sample Description3", new GeoPoint((int)(35.1259488*1E6),(int)(33.3436289*1E6))));
    this.mMyLocationOverlay = new ItemizedIconOverlay<OverlayItem>(mItems, myCustomIconMarker, new Glistener(), mResourceProxy); 
```

现在我如何用这个 ItemizedOverlayWithFocus 做到这一点？

[http://code.google.com/p/osmdroid/source/browse/trunk/osmdroid-android/src/org/osmdroid/views/overlay/ItemizedOverlayWithFocus.java?r=802](http://code.google.com/p/osmdroid/source/browse/trunk/osmdroid-android/src/org/osmdroid/views/overlay/ItemizedOverlayWithFocus.java?r=802)

这让我感到困惑：

```
ItemizedOverlayWithFocus<T extends OverlayItem> extends ItemizedOverlay<T> 
```

T 是什么意思？

有人可以发布使用它的示例代码吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T12:50:24.210

实际上并没有尝试编写任何代码来支持这一点，但是快速查看有问题的代码，您应该能够完全按照您的方式进行操作，但是将 ItemizedIconOverlay 替换为 ItemizedOverlayWithFocus

这与泛型和模板有关，这些概念使我们能够制作更多类型安全的对象。

因此，在您拥有 ItemizedIconOverlay 的地方，您是在说 ItemizedIconOverlay 的内部结构只能与 OverlayItems（或其子类）一起使用。

同样适用于 ItemizedOverlayWithFocus

这就是说，当您创建构造函数（以及您放入其中的所有项目数组等）时，您在 V 形 <> 中指定的数据类型必须是 OverlayItem 类型，或者必须扩展 OverlayItem。

所以理论上你的代码可以改为

```
 private ItemizedOverlayWithFocus<OverlayItem> mMyLocationOverlay;
...
mItems.add.... 
```

诀窍在于构造函数，因为 WithFocus 类具有与您在上面使用的构造函数不同的构造函数，您可以选择（只要您在需要 Context 对象的活动类中，这将起作用）

```
 this.mMyLocationOverlay = newItemizedOverlayWithFocus<OverlayItem>(this, mItems, new GListener()); 
```

或 this.mMyLocationOverlay = newItemizedOverlayWithFocus(this, mItems, new GListener(), mResourceProxy);

或（您必须在此填写引用的“空白”）

```
 this.mMyLocationOverlay = newItemizedOverlayWithFocus<OverlayItem>(this, mItems, 'Drawable marker', 'Point markerHotspot', 'Drawable markerFocusedBase', 'Point markerFocusedHotspot', 'int focusedBackgroundColour', new GListener(), mResourceProxy); 
```

# html - IE8 中的 HTML 基本标记问题，没有 sheme/协议

> ID：10551064
> 
> 赞同：-1
> 
> 时间：2012-05-11T12:10:00.103
> 
> 标签：html, internet-explorer-8, base

我正在将 TYPO3 用于网站。TYPO3`<base href="" />`在每个页面上都包含一个标签

现在我有带和不带 SSL 的页面，所以最好使用带有现在 shema url 的基本标记

`<base href="//example.org" />`代替`<base href="http://example.org" >`

唉，IE8 将不再加载我的 CSS 和 JS。除了重新分配方案之外，还有其他解决方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T12:24:02.493

您可以使用[TypoScript 条件](http://typo3.org/documentation/document-library/core-documentation/doc_core_tsref/4.7.0/view/1/4/)来设置正确的`baseURL`

例如，如果您的 HTTPS 树放置在 UID = 123（及以下）的页面中，请使用：

```
config.baseURL = http://domain.tld/

[PIDinRootline = 123]
  config.baseURL = https://domain.tld/
[end] 
```

通过这种方式，您可以确保每个能够理解“完整”`base`标签的浏览器都能正常工作。

# java - Unicode 字符的正则表达式问题

> ID：10551065
> 
> 赞同：2
> 
> 时间：2012-05-11T12:10:01.833
> 
> 标签：java, regex

我有以下正则表达式，它应该接受以下输入

```
yes
no
b 03211111111 10 
```

图案：

```
Pattern.compile(
    "^((B\\s(92|0)?(3[0-9]{2,9})\\s([1-9][0-9]|1[0-9]{2}|200))|(y)|(yes)|(n)|(no))$",
    Pattern.CASE_INSENSITIVE
); 
```

但今天我发现它接受一个输入，如下所示

```
b 03211111111 10? 
```

在上面的行中，问号方向相反，我不知道如何在这里输入。

它看起来像一些 unicode 字符，我只想限制我的正则表达式以获取输入

```
b 03211111111 10 
```

以下是代码

```
balShareReq =   Pattern.compile("^((B\\s(92|0)?(3[0-9]{2,9})\\s([1-9][0-9]|1[0-9]{2}|200))|(y)|(yes)|(n)|(no))$",Pattern.CASE_INSENSITIVE);
Matcher matcher   =   balShareReq.matcher(vo.getMessage());             
            if( matcher.find() ) {
//my business logic 
} 
```

问候，伊姆兰

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T12:35:00.113

您的程序中还有其他一些错误：

```
Pattern p = Pattern.compile(
"^((B\\s(92|0)?(3[0-9]{2,9})\\s([1-9][0-9]|1[0-9]{2}|200))|(y)|(yes)|(n)|(no))$",
Pattern.CASE_INSENSITIVE
);

p.matcher("b 03211111111 10?").matches();  // false
p.matcher("b 03211111111 10¿").matches();  // false
p.matcher("b 03211111111 10⸮").matches();  // false 
```

**更新**

您正在使用[`find()`](http://docs.oracle.com/javase/7/docs/api/java/util/regex/Matcher.html#find%28%29)您可能应该使用的地方[`matches()`](http://docs.oracle.com/javase/7/docs/api/java/util/regex/Matcher.html#matches%28%29)。从java文档，`matches`：

> 尝试将整个区域与模式匹配。

虽然`find`：

> 尝试查找与模式匹配的输入序列的下一个子序列。

但甚至`find`不应该与您给定的模式匹配，除非在`¿`主模式之后的一行上（因为您`$`在模式的末尾有）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T12:38:47.923

你的正则表达式失败，因为你的 $ 最后。$ 表示正则表达式必须通过，直到到达字符串的末尾。删除 $ 或在字符串结尾之前允许一些其他字符。

-> "...|(y)|(yes)|(n)|(no))¿?$" 将传递 ¿ 字符（？在正则表达式中表示可选）

-> "...|(y)|(yes)|(n)|(no))" 将在最后传递所有字符

# javascript - jQuery动态生成HTML表格的修改

> ID：10551070
> 
> 赞同：0
> 
> 时间：2012-05-11T12:10:13.713
> 
> 标签：javascript, jquery, html-table

我有下表

```
 <table id="edit_po_table">
        <thead>
            <tr>
                <th>Discount</th>
                <th>
                    <select id="discount">
                        <option value="0">0%</option>
                        <option value="25">25%</option>
                        <option value="35">35%</option>
                        <option value="42">42%</option>
                        <option value="50">50%</option>
                    </select>
                </th>
                <th></th>
                <th></th>
                <th></th>
                <th></th>
                <th></th>
            </tr>
            <tr>
                <th>Quantity</th>
                <th>Stock #</th>
                <th>Product Name</th>
                <th>Volume Points</th>
                <th>Price</th>
                <th>Volume Total</th>
                <th>Line Total</th>
            </tr>
        </thead>
        <tbody>

        </tbody>
    </table> 
```

以及下面的 jQuery 代码

```
 $('#table_po_product_list :checkbox').click(function() {

        if($("#table_po_product_list :checkbox").prop('checked')) {

            var i = $("#table_po_product_list input:checked").length;
            $('#bottom-menu span').html(i + (i != 1 ? " items" : " item"));

        } else {

            var i = $("#table_po_product_list input:checked").length;
            $('#bottom-menu span').html(i + (i != 1 ? " items" : " item"));

        }

        var stocknos = $('#table_po_product_list :checked').map(function(){
                return $(this).val();
            }).get().join(',');

        if($('#table_po_product_list :checked').length === 0) {
            $('#edit_po_table tbody').html('');
        }

        alert(stocknos);

        if (stocknos.length > 0) {
            $.ajax({
                type: "POST",
                url: "functions.php",
                data: "ids=" + stocknos, //{'stock_nos[]': stocknos},
                cache: false,
                success: function(html) {

                    $('#edit_po_table tbody').html(html);

                }
            });
        }

    })

    $('#edit_po_table tbody input').on("change", function(event){

            var tdid = $(this).attr('id');

            var qty = $('#edit_po_table tbody tr#'+tdid+' td input').val();

            var vol = $('#edit_po_table tbody tr#'+tdid+' td#vol_pts').text();

            var price = $('#edit_po_table tbody tr#'+tdid+' td#price').text();

            alert(tdid);

            $('#edit_po_table tbody tr#'+tdid+' td#total_vol').html(qty*vol);
            $('#edit_po_table tbody tr#'+tdid+' td#total_price').html(qty*price);

    }) 
```

并且 functions.php 将在被询问时返回以下内容：

```
<tr id=0141>
<td><input type="text" size="5"></td>
<td>0141</td>
<td>Formula</td>
<td id="vol_pts">23.95</td>
<td id="price">68.49</td>
<td id="total_vol"></td>
<td id="total_price"></td>
</tr>

<tr id=6424>
<td><input type="text" size="5"></td>
<td>6424</td>
<td>Reference Guide (Bilingual)</td>
<td id="vol_pts">0.00</td>
<td id="price">9.20</td>
<td id="total_vol"></td>
<td id="total_price"></td>
</tr> 
```

现在，我正在尝试让我的`$('#edit_po_table tbody input').on("change", function(event)`jquery 代码部分工作，但无法找到使其工作的方法。

基本上，这就是我希望我的代码运行的方式，向用户显示一个产品表，然后他们从表中选择产品。选择通过 jquery 传递给 functions.php，然后返回`<tbody>`edit_po_table 的数据。

然后用户需要填写所需的数量，表格应自动计算该行的总成交量点和价格。我尝试了不同的方法来获取`<tr>`id，然后转到`<td>`它仅适用于第一行，我无法让它适用于任何其他行。

帮助？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T12:16:47.810

您可以在将[jQuery.on](http://api.jquery.com/on/)修改为此之后尝试

```
$('#edit_po_table tbody').on("change",'input', function(event){
  //your code

}); 
```

此语法等效于[$.live](http://api.jquery.com/live/)并且事件绑定也将持续用于动态添加的元素。:)

# nlp - WEKA 中 SVM 训练的名义属性中名义值的最大数量是多少？

> ID：10551072
> 
> 赞同：0
> 
> 时间：2012-05-11T12:10:15.613
> 
> 标签：nlp, weka, svm, libsvm

我有一个 NLP 问题，我计划在 WEKA 中使用 SVM 进行分类。我正在尝试对单词进行分类 - POS 标签集有 24 个标签，而基本短语块 (BPC) 标签集有 15 个标签。

但是我有“特征集”，我希望每个词都针对它的每个特征进行分类。

第一个特征集是 {POS}，因此这将是名义属性 POS 的 24 个名义值。第二个是 {POS+BPC}，因此 POS+BPC 名义属性的名义值是 24*15=375。

因此，例如，一个单词可能会像这样输出，每个名词属性都分类：

```
word, POS=tag1, POS+BPC=tag234 
```

我只是想知道这是否可能？对于标称属性，我可以拥有的（类）标称值的最大数量是多少？因为我可能会使用更多的标签集和更多的组合。我需要使用 LibSVM 包吗？使用 SVM 解决这个多类问题是否有意义？

我的训练数据集约为。288K 字，我的测试数据集约为。35k 字。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-12T01:45:40.973

我认识一个拥有 300 万个特征并使用 weka 构建分类器的人。但他不得不将提供给 weka 的内存从 1 GB 增加到 3 GB。与他的设置相比，您有 2 个功能，但有 3 位数值范围。我相信除了内存问题之外根本不应该有任何问题。Weka 是一个大型采矿工作台。您为什么不运行一些样本作为健全性测试并提醒我们？

# c# - 在 gridview 中显示增量数据的最佳方式是什么？

> ID：10551074
> 
> 赞同：4
> 
> 时间：2012-05-11T12:10:22.473
> 
> 标签：c#, .net, winforms, data-binding

我正在构建一个监控应用程序。数据在网格视图中呈现给用户。此数据经常更改（应用程序每秒添加 5-6 个条目）。加载的整体总数可能是几千个。

将这些行加载到 gridview 的最佳方法是什么？

我应该增量加载数据吗？并手动添加每一行？

或者

再次调用 DataBind 会不会太贵？我注意到这种方法在屏幕上闪烁，所以不想使用它。

有没有更好的方法来用增量数据填充网格视图？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T12:28:26.277

我正在构建一个监控应用程序。数据以网格视图呈现给用户。此数据经常更改（应用程序每秒添加 5-6 个条目）

人眼可以每秒捕捉 5-6 次更新吗？我认为每 500 毫秒更新一次你会很好。

性能提示：

*   使用 BindingList 或 List。远离数据表/数据集。

*   维护所有更新的缓存。使用间隔为 500 毫秒的计时器，在间隔过去时从缓存中更新列表数据源。

*   刷新 CurrencyManager 并且**不要重新绑定网格**。

    CurrencyManager currencyManager = (CurrencyManager)this.BindingContext[Grid.DataSource]; 货币管理器.Refresh();

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T12:15:51.280

我认为增量加载数据是更好的选择，特别适合监控应用程序。

# android - 视图上的 Android 浮动按钮

> ID：10551079
> 
> 赞同：13
> 
> 时间：2012-05-11T12:10:44.580
> 
> 标签：android, android-layout, android-view

我试图在我的视图上有一个浮动按钮，我用谷歌搜索并发现这个链接很好地总结了它。

[http://www.jondev.net/articles/Floating_Views_in_Android_(按钮)](http://www.jondev.net/articles/Floating_Views_in_Android_%28Buttons%29)

虽然这对于一个按钮是正确的，但是如果我想要两个浮动按钮，一个在“左上角”，另一个在“右下角”。

我想有一个相对布局，它有两个按钮，布局重力不同。这行得通吗。我试过了，惨遭失败。有没有其他人尝试过这样做？有没有办法做到这一点，如果有，请告诉我。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-05-11T12:28:29.350

您可以通过以下方式实现`RelativeLayout`：

```
<RelativeLayout
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

    <ListView
        android:id="@+id/listView1"
        android:layout_width="match_parent"
        android:layout_height="match_parent" >
    </ListView>

    <Button
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentBottom="true"
        android:layout_alignParentRight="true"
        android:layout_marginBottom="15dp"
        android:layout_marginRight="15dp"
        android:text="Button" />
</RelativeLayout> 
```

请注意，最后添加的 Widget 位于顶部。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T12:30:09.470

`RelativeLayout`尽管您也可以使用`FrameLayout`（如链接中的示例）来实现它，但您可以做到这一点。在`FrameLayout`为按钮设置适当的重力（`Gravity.BOTTOM|Gravity.RIGHT`或通过 XML...）中，并将`RelativeLayout`reuiqred 规则设置为按钮：

```
android:layout_alignParentBottom="true"
android:layout_alignParentRight="true" 
```

等等

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-17T07:22:17.357

```
<RelativeLayout
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >

    <ListView
        android:id="@+id/listView1"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent" >
    </ListView>
    <Button
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentTop="true"
        android:layout_alignParentLeft="true"
        android:layout_marginTop="15dp"
        android:layout_marginLeft="15dp"
        android:text="Button" />
    <Button
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentBottom="true"
        android:layout_alignParentRight="true"
        android:layout_marginBottom="15dp"
        android:layout_marginRight="15dp"
        android:text="Button" />
</RelativeLayout> 
```

# mysql - MySQL 截断我的第一个零数据

> ID：10551083
> 
> 赞同：0
> 
> 时间：2012-05-11T12:11:01.133
> 
> 标签：mysql, sql

我有一个 MySQL 列“电话”，当数据来自我的 php 表单时，如果开头有一个零，它将在表中消失，例如：“ **06719823** ”变成“ **6719823** ”

我首先虽然这是php的问题，因为我使用的是mysql_real_escape_string（），但后来我尝试直接在phpmyadmin上修改SQL字段，我无法添加第一个0，它总是删除它。

```
Colonne     Type     Interclassement    Attributs   Null    Défaut  Extra
phone       int(10)                                 Oui     NULL 
```

怎么了 ？我应该分配一个“类间” **utf8_general_ci**吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T12:13:00.043

将您的列类型更改`char(10)`为 10 位电话号码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T12:16:52.227

如果列类型是 int（整数），**则数字将在内部表示为 integer**，这意味着不会存储“前 0”，因为它们对整数没有意义。

由于您实际尝试存储的内容具有**字符序列而不是数量的含义，因此将其存储为****char(n)**、n 位序列或**varchar**的序列更有意义大小变化很大。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T12:13:38.873

将您的电话属性设为 Varchar 或 Text 以避免这种情况。

电话号码有时也可以包含括号和连字符，而且您也可以避免您的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-11T12:14:43.033

更改您的数据类型。Int 数据类型不会存储起始 0。

您可以按照上面的建议尝试 char 或 varchar

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-11T12:15:41.553

```
Integers : 06719823 = 6719823 = 0006719823 
```

如果您想在开头保留零，请将电话另存为 varchar

# php - 如何检查所有通过for循环显示的复选框？

> ID：10551092
> 
> 赞同：0
> 
> 时间：2012-05-11T12:11:35.933
> 
> 标签：php, checkbox

我想检查 div 标签中的所有复选框我的代码如下。

```
<div id="cBoxes">
<li><input class="radio" name="list" id="list" type="checkbox" 
     value="<?php echo $resultPages['id'];?>"></li>
</div> 
```

我已将整个代码放入带有 php 标签的 for 循环中。有什么办法可以完成这个任务。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T12:15:14.757

设置 的`checked`属性`checkbox`。[w3.org](http://www.w3.org/TR/html4/interact/forms.html#adef-checked)有完整的文档。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T12:22:31.210

查看`checked`属性：

```
<div id="cBoxes">
<ul>
<li><input class="radio" name="list" id="list" type="checkbox" 
     value="<?php echo $resultPages['id'];?>" checked="checked"/></li>
</ul>
</div> 
```

# c++ - boost microsec_clock 和 second_clock::universal_time 之间相差 1 秒

> ID：10551093
> 
> 赞同：2
> 
> 时间：2012-05-11T12:11:43.070
> 
> 标签：c++, boost

在开发一个将带有时间戳的传入事件写入文件的模块时，我遇到了一个问题，我在 www.www 上找不到任何信息。希望你们中的一些人可以帮助我：

部分代码：

```
boost::posix_time::ptime micro_time = boost::posix_time::microsec_clock::local_time();
std::cout << "micro time: " << micro_time  << std::endl;

boost::posix_time::ptime utc_time(boost::posix_time::second_clock::universal_time());
std::cout << "utc time: " << utc_time << std::endl; 
```

它工作得很好，但是两个时间戳之间存在 1 秒的不匹配。这 4 个事件紧随其后发生，但事件 3 出现了问题。但就在它之后，一切又好了。

```
1\. event (good):  
micro time: 2012-May-11 13:13:32.002949  
utc time:   2012-May-11 11:13:32.003069

2\. event (good):  
micro time: 2012-May-11 13:13:32.003600  
utc time:   2012-May-11 11:13:32.003716  

3\. event (bad):   
micro time: 2012-May-11 13:13:32.004241  
utc time:   2012-May-11 11:13:33.004411  

4\. event (good again):  
micro time: 2012-May-11 13:13:32.004943  
utc time:   2012-May-11 11:13:32.005073 
```

我正在使用 32 位 Kubuntu 并提升库 1.46。有没有人对可能导致不匹配的原因有任何想法？

# json - 使用 curl 使用 Github API v3 创建新的 gist

> ID：10551094
> 
> 赞同：6
> 
> 时间：2012-05-11T12:12:02.170
> 
> 标签：json, curl, github-api, gist

在为使用他们的 API V3 在 Github 上发布一个私人要点而奋斗了很长时间之后，我几乎放弃了。几乎。可能有人也遇到过类似的问题，或者知道以下行为的原因可能是什么：

现在 curl 命令如下所示：

```
curl -H "Authorization: bearer MY_AUTHORIZATION_TOKE" -H "Accept: application/json" -H "Content-type: application/json" -X POST -d '{"public":false,"files":{"test.txt":{"content":"String file contents"}}}' https://api.github.com/gists 
```

我也试过

```
curl -H "Authorization: bearer MY_AUTHORIZATION_TOKE" -X POST -d '{"public":false,"files":{"test.txt":{"content":"String file contents"}}}' https://api.github.com/gists 
```

我可以使用完全相同的数据在没有授权令牌的情况下创建要点：

```
curl -X POST -d '{"public":true,"files":{"test.txt":{"content":"String file contents"}}}' https://api.github.com/gists 
```

但在这种情况下，它将是匿名的

如果我打算将其公开发布，结果相同

无论如何，Github 都会返回我

```
HTTP/1.1 404 Not Found
{
  "message": "Not Found"
} 
```

我很确定我已获得授权，因为`curl -H "Authorization: bearer MY_AUTHORIZATION_TOKE" https://api.github.com/user`我返回了我的用户详细信息。

应用范围如下：

[https://github.com/login/oauth/authorize?client_id=...&scope=gist](https://github.com/login/oauth/authorize?client_id=...&scope=gist)

因此，它应该具有读取和写入权限。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-12T22:34:41.817

您的 OAuth2 令牌似乎没有所需的`gist`范围。

如果您`curl`使用参数运行命令，`-v`您可以看到发送到请求（标头）的范围以及使用发送的令牌成功执行`X-OAuth-Scopes`请求（标头）所需的范围。`X-Accepted-OAuth-Scopes`

如果您没有`gist`在标题值中看到列出，`X-OAuth-Scopes`那么这就是您的问题。

# javascript - 长度大于 1,024 字节的字节数组图像，IE8

> ID：10551100
> 
> 赞同：0
> 
> 时间：2012-05-11T12:12:17.080
> 
> 标签：javascript, css, internet-explorer-8, bytearray

我在获取长度大于 1024 字节的字节数组图像时遇到问题。(IE8)

有什么解决方法吗？

问题是包含超过 1024 字节长度的图片会被剪切。换句话说，由于字节流被切断，因此不会显示整个图片。

# c# - 使用 TOAD for Oracle 将包从一个数据库复制到另一个数据库

> ID：10551104
> 
> 赞同：0
> 
> 时间：2012-05-11T12:12:25.760
> 
> 标签：c#, oracle, toad

我正在使用 TOAD for oracle 来管理 Oracle 数据库，我想将一个程序包从一个数据库复制到另一个数据库。有没有一些简单的方法可以做到这一点，比如复制粘贴？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T12:19:44.480

简单的选项是使用 TOAD 中可用的“在另一个模式中创建”选项。请按照以下步骤操作：（有两个数据库 DB1 和 DB2。假设您要将 DB1 中的过程创建到另一个数据库 DB2 中。）

1.  您需要同时登录两个数据库（比如 DB1 和 DB2）。
2.  转到 DB1 中的过程。
3.  右键单击它。选择“在另一个架构中创建”。
4.  选择所需的脚本选项，然后单击“确定”。
5.  选择 Destination Connection 和 Destination Schema（将用于 DB2）。
6.  点击“执行”

你的工作完成了。我让它变得更简单了吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T12:19:23.083

使用模式浏览器，如果您有权限，您可以访问包的源代码。在那之后，您可以随心所欲地使用它。

如果您正在谈论的这两个数据库*实际上是两个模式*，我建议不要重新创建包，而是将其授予另一个模式。

* * *

编辑：关于包的更多解释。

基本上，一个 Oracle 包包括两个对象；一个`package`和一个`package body`。`package`是您的包中对用户公开且可见的方法所在的位置。`package body`是您实际执行程序的地方。

因此，当将包移动到其他地方时，您需要创建这两个对象。Toad 有一种方法可以使用模式浏览器向您显示这些对象的脚本。找到源，复制两个脚本并在目标上运行它们。

# jquery - 使用 jQuery Ajax 返回 JSON 对象

> ID：10551108
> 
> 赞同：0
> 
> 时间：2012-05-11T12:12:37.933
> 
> 标签：jquery

这是一个非常简单的问题，所以请不要开玩笑......我已经获得了一个 Web 服务的 URL，它将为我提供一个 JSON 对象。我希望使用 jQuery 的 getJSON 方法，例如...

```
var myObj = $.getJSON("https://www.myurl/"); 
```

但是，这不起作用，因为当我使用 console.log(myObj.toSource()) 时，我似乎在将 JavaScript 写入控制台而不是我的对象时得到了很多。我知道我可以用这个方法添加一个回调，我应该这样做：

```
var thisJsonObj;

$.getJSON("https://www.myurl/", function(result){
    thisJsonObj = result;

});

console.log(thisJsonObj.toSource()); 
```

这也不起作用......我哪里出错了？该 URL 有效且正确。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T12:15:34.397

Ajax 以异步方式工作，因此您必须在回调函数中使用 JSON 对象：

```
var thisJsonObj;
$.getJSON("https://www.myurl/", function(result) {
    thisJsonObj = result;
    console.log(thisJsonObj);
}); 
```

此外，如果您使用外部 web 服务，您应该[考虑](http://api.jquery.com/jQuery.getJSON/)将请求视为[JSONP](http://bob.pythonmac.org/archives/2005/12/05/remote-json-jsonp/)。因此，请检查您的 URL 是否有点像“callback=?”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T12:45:00.047

虽然 URL 可能是 Web 服务的 URL，但您是否假设在 Web 服务中调用函数？例如，如果您有一个 python 微框架（例如我的示例中的[Flask](http://flask.pocoo.org/)），并且我想获取要在组合框中显示的项目列表，那么我的 python 可能看起来有点像：

```
@app.route('/_gest_list.json')
def get_list():
    #return list of jsonified items 
```

在你的 jQuery 中调用

```
$.getJSON("/get_list.json", {}, function(data) {
    //Do something
}); 
```

把它想象成我正在调用`get_list()`映射到 webservice/server 的 url 并具有别名的函数`/get_list.json`

Also if you are working with ASP.Net to access the data you must write something like (variable name).d. All JSON data in ASP.Net is wrapped within d!

# c - 空指针的内存

> ID：10551111
> 
> 赞同：3
> 
> 时间：2012-05-11T12:12:52.277
> 
> 标签：c, pointers

这是一个非常基本的问题。我只是想知道 void 类型的指针的内存中会有什么。

任何帮助都非常感谢。谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-11T12:15:09.730

`void`指针只是一个提供内存地址的值。`void`如果没有进一步的信息，就无法确定指针实际指向的内容。

至于指针占用的内存是什么，在`void`32 位架构上是 32 位的值，在 64 位架构上是 64 位的值（以此类推）。

这个值的解释在很大程度上取决于底层架构以及它如何实现内存寻址。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T12:38:27.247

`void`是没有值的类型。

因此，如果您有 a `void *foo`，C 将不允许您阅读`*foo`，更不用说为它分配一些值了。

因此，您的问题的答案是：您无法找出`void`指针所指向的值。您必须将 void 指针转换为其他类型，并且新指针指向的地址处的值根据其类型进行解释。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T12:15:01.773

指针是一个内存地址，所以无论它是一个空指针还是一个对象的指针都是一样的......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-11T14:43:46.620

其实它也是一个指针，所以大小应该和普通指针一样。

# c# - HashSet UnionWith() 方法在 C# 中的性能问题

> ID：10551112
> 
> 赞同：3
> 
> 时间：2012-05-11T12:12:54.130
> 
> 标签：c#, performance, list, hashset

我有很多`HashSet`包含不同的索引异常。`HashSet`我根据输入数据将这些哈希集组合成一个大的。出于测试目的，我还移植`HashSet`了`List`类似物。

*   `HashSet`and的唯一目的`List`是从随机数生成中排除索引。

这就是我在 List 的情况下所做的：

```
list2 = new List<int>();
for (int d = 0; d < list1.Count; d++)
{
  if (dicCat4[30].ContainsKey(list1[d]))
  {
    list2.AddRange(dicCat4[30][list1[d]]);
  }
}

rand = 2 * RandString.Next(0 / 2, (dicCat[30].Count) / 2);
while (list2.Contains(rand))
{
  rand = 2 * RandString.Next(0 / 2, (dicCat[30].Count) / 2);
}
// action with random 
```

如您所见，所有异常（索引）都使用`AddRange()`. 使用`Contains()`方法我们检查随机数是否在列表中。

HashSet 也可以进行同样的操作：

```
excludehash = new HashSet<int>();

for (int d = 0; d < list1.Count; d++)
{
  if (dicCat4[30].ContainsKey(list1[d]))
  {
    excludehash.UnionWith(dicCat3[30][list1[d]]);
  }
}

rand = 2 * RandString.Next(0 / 2, (dicCat[30].Count) / 2);
while (excludehash.Contains(rand))
{
  rand = 2 * RandString.Next(0 / 2, (dicCat[30].Count) / 2);
}
// action with random 
```

在这种情况下，`AddRange()`我不是使用`UnionWith()`方法来合并`HashSet`索引异常。

奇怪的是，经过数千次迭代 -方法的**整体性能`List`更好！**，但根据许多消息来源`HashSet`应该执行得更快。性能分析器显示，最大的性能消耗是 HashSet 的`UnionWith()`方法。

我只是好奇-**有什么方法可以使`HashSet`解决方案更快地执行吗？**（我突然想到了一个快速的想法：作为替代方案，我可以`Contains(rand)`在每个单独的哈希集上使用，因此跳过`UnionWith()`方法）

PS 哈希集和列表检索自：

```
static Dictionary<int, Dictionary<int, HashSet<int>>> dicCat3;
static Dictionary<int, Dictionary<int, List<int>>> dicCat4; 
```

**编辑：核心迭代解决方案**

```
int inter = list1.Count;
int cco = 0;

while (inter != cco)
{
  cco = 0;

  rand = 2 * RandString.Next(0 / 2, (dicCat[30].Count) / 2);

  for (int d = 0; d < list1.Count; d++)
  {
    if (dicCat4[30].ContainsKey(list1[d]))
    {
      if (!dicCat3[30]][list1[d]].Contains(rand))
      {
        cco++;
      }
      else
      {
        break;
      }
   }
   else
   {
     cco++;
   }
 }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-03T01:02:00.833

尝试使用 SortedSet 而不是 HashSet。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-02T19:52:17.833

如果您想在编辑中获得一点性能，请交换 if/else。C# 假设​​ else 子句更有可能，因此首先评估该树！你应该在那里剃掉几毫秒。但除此之外，我看不到真正的方法来拯救你任何东西！

如果您发布一个我可以导入的解决方案，那么我会很高兴地玩一玩，看看我能做什么，但我不会为了好玩而把它全部打出来！;)

# php - HTML，PHP - 回显时转义“<”和“>”符号

> ID：10551116
> 
> 赞同：16
> 
> 时间：2012-05-11T12:13:04.830
> 
> 标签：php, html, escaping

我想按原样打印以下文本：

```
echo "<label> AAAAA"; 
```

但它只是显示'AAAAA'作为输出。

如何转义“<”和“>”符号。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-05-11T12:15:03.363

使用[htmlspecialchars](http://php.net/manual/en/function.htmlspecialchars.php)。

```
<?php
    echo htmlspecialchars("abc & < >");
?> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-11T12:14:36.920

使用该[`htmlentities()`](http://php.net/manual/en/function.htmlentities.php)函数转换为纯文本字符串。

```
<?php
echo htmlentities("<label> AAAAA");
?> 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-05-11T12:16:35.750

```
echo htmlentities("<label> AAAAA"); 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-05-11T12:19:54.223

```
<?php
    $string = "<label> AAAAA"; //whatever you want
    echo htmlspecialchars($string);
?> 
```

**参考** [htmlspecialchars](http://php.net/manual/en/function.htmlspecialchars.php)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-05-11T12:17:00.773

检查这个[http://php.net/manual/en/function.htmlentities.php](http://php.net/manual/en/function.htmlentities.php)，这是代码 -

```
echo htmlentities ("<label> AAAAA"); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-05-11T12:28:04.643

您应该转义 HTML 的特殊字符。

`echo "&lt;label&gt; AAAA"`

[http://www.w3schools.com/tags/ref_entities.asp](http://www.w3schools.com/tags/ref_entities.asp)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-11T12:15:16.220

```
echo "&lt;label&gt; AAAAA"; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-05-11T12:15:37.773

使用 HTML 实体：`&lt;`for`<`和`&gt;`for `>`。可以使用`htmlspecialchars`函数来实现：http: [//php.net/htmlspecialchars](http://php.net/htmlspecialchars)。

在此处阅读有关 HTML 实体的更多信息：http: [//www.santagata.us/characters/CharacterEntities.html](http://www.santagata.us/characters/CharacterEntities.html)

# python - 使用 argparse 时从环境变量设置选项

> ID：10551117
> 
> 赞同：59
> 
> 时间：2012-05-11T12:13:17.330
> 
> 标签：python, argparse

我有一个脚本，它具有某些选项，可以在命令行上传递，也可以从环境变量传递。如果两者都存在，则 CLI 应该优先，如果两者都没有设置，则会发生错误。

我可以在解析后检查该选项是否已分配，但我更愿意让 argparse 完成繁重的工作，并在解析失败时负责显示使用语句。

我已经提出了几种替代方法（我将在下面发布作为答案，以便可以单独讨论），但它们对我来说非常笨拙，我认为我错过了一些东西。

是否有公认的“最佳”方式来做到这一点？

（当 CLI 选项和环境变量都未设置时，编辑以明确所需的行为）

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2012-05-11T12:32:50.270

您可以使用要获取的环境变量`default=`将参数的[`.get()`](https://docs.python.org/library/stdtypes.html#dict.get)of 设置为 a of 。[`os.environ`](https://docs.python.org/library/os.html#os.environ)

您还可以在`.get()`调用中传递第二个参数，如果`.get()`没有找到该名称的环境变量，这是默认值（在这种情况下默认`.get()`返回`None`）。

```
import argparse
import os

parser = argparse.ArgumentParser(description='test')
parser.add_argument('--url', default=os.environ.get('URL'))

args = parser.parse_args()
if not args.url:
    exit(parser.print_usage()) 
```

* * *

## 回答 #2

> 赞同：66
> 
> 时间：2012-05-11T12:17:53.067

我经常使用这种模式，所以我打包了一个简单的动作类来处理它：

```
import argparse
import os

class EnvDefault(argparse.Action):
    def __init__(self, envvar, required=True, default=None, **kwargs):
        if not default and envvar:
            if envvar in os.environ:
                default = os.environ[envvar]
        if required and default:
            required = False
        super(EnvDefault, self).__init__(default=default, required=required, 
                                         **kwargs)

    def __call__(self, parser, namespace, values, option_string=None):
        setattr(namespace, self.dest, values) 
```

然后我可以从我的代码中调用它：

```
import argparse
from envdefault import EnvDefault

parser=argparse.ArgumentParser()
parser.add_argument(
    "-u", "--url", action=EnvDefault, envvar='URL', 
    help="Specify the URL to process (can also be specified using URL environment variable)")
args=parser.parse_args() 
```

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2017-07-29T17:46:31.093

我通常必须为多个参数（身份验证和 API 密钥）执行此操作。这很简单直接。使用 **kwargs。

```
def environ_or_required(key):
    return (
        {'default': os.environ.get(key)} if os.environ.get(key)
        else {'required': True}
    )

parser.add_argument('--thing', **environ_or_required('THING')) 
```

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2014-09-13T23:52:02.587

[ConfigArgParse](https://pypi.python.org/pypi/ConfigArgParse/)向 argparse 添加了对环境变量的支持，因此您可以执行以下操作：

```
p = configargparse.ArgParser()
p.add('-m', '--moo', help='Path of cow', env_var='MOO_PATH') 
options = p.parse_args() 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2012-05-11T12:14:08.547

一种选择是检查是否设置了环境变量，并相应地修改对 add_argument 的调用，例如

```
import argparse
import os

parser=argparse.ArgumentParser()
if 'CVSWEB_URL' in os.environ:
    cvsopt = { 'default': os.environ['CVSWEB_URL'] }
else:
    cvsopt = { 'required': True }
parser.add_argument(
    "-u", "--cvsurl", help="Specify url (overrides CVSWEB_URL environment variable)", 
    **cvsopt)
args=parser.parse_args() 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2014-07-09T19:26:52.990

这个话题很老了，但我有类似的问题，我想我会和你分享我的解决方案。不幸的是，@Russell Heilling 建议的自定义操作解决方案对我不起作用，原因如下：

*   它阻止我使用[预定义的操作](https://docs.python.org/dev/library/argparse.html#action)（如`store_true`）
*   我希望它回退到不在的`default`时候（这很容易修复）`envvar``os.environ`
*   我希望我的所有论点都具有这种行为，而无需指定`action`or `envvar`（应该始终是`action.dest.upper()`）

这是我的解决方案（在 Python 3 中）：

```
class CustomArgumentParser(argparse.ArgumentParser):
    class _CustomHelpFormatter(argparse.ArgumentDefaultsHelpFormatter):
        def _get_help_string(self, action):
            help = super()._get_help_string(action)
            if action.dest != 'help':
                help += ' [env: {}]'.format(action.dest.upper())
            return help

    def __init__(self, *, formatter_class=_CustomHelpFormatter, **kwargs):
        super().__init__(formatter_class=formatter_class, **kwargs)

    def _add_action(self, action):
        action.default = os.environ.get(action.dest.upper(), action.default)
        return super()._add_action(action) 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2019-07-22T21:27:18.487

您可以使用`OptionParser()`

```
from optparse import OptionParser

def argument_parser(self, parser):
    parser.add_option('--foo', dest="foo", help="foo", default=os.environ.get('foo', None))
    parser.add_option('--bar', dest="bar", help="bar", default=os.environ.get('bar', None))
    return(parser.parse_args())

parser = OptionParser()
(options, args) = argument_parser(parser)
foo = options.foo
bar = options.bar
print("foo: {}".format(foo))
print("bar: {}".format(bar)) 
```

壳：

```
export foo=1
export bar=2
python3 script.py 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-04-19T18:05:45.833

以为我会发布我的解决方案，因为原始问题/答案给了我很多帮助。

我的问题与罗素的问题有点不同。我使用的是 OptionParser，而不是每个参数的环境变量，我只有一个模拟命令行的环境变量。

IE

MY_ENVIRONMENT_ARGS = --arg1 "马耳他语" --arg2 "猎鹰" -r "1930" -h

解决方案：

```
def set_defaults_from_environment(oparser):

    if 'MY_ENVIRONMENT_ARGS' in os.environ:

        environmental_args = os.environ[ 'MY_ENVIRONMENT_ARGS' ].split()

        opts, _ = oparser.parse_args( environmental_args )

        oparser.defaults = opts.__dict__

oparser = optparse.OptionParser()
oparser.add_option('-a', '--arg1', action='store', default="Consider")
oparser.add_option('-b', '--arg2', action='store', default="Phlebas")
oparser.add_option('-r', '--release', action='store', default='1987')
oparser.add_option('-h', '--hardback', action='store_true', default=False)

set_defaults_from_environment(oparser)

options, _ = oparser.parse_args(sys.argv[1:]) 
```

在这里，如果找不到参数，我不会抛出错误。但如果我愿意，我可以做类似的事情

```
for key in options.__dict__:
    if options.__dict__[key] is None:
        # raise error/log problem/print to console/etc 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2018-09-30T13:57:39.390

有一个[示例用例用于`ChainMap`](https://docs.python.org/3/library/collections.html#chainmap-examples-and-recipes)将默认值、环境变量和命令行参数合并在一起。

```
import os, argparse

defaults = {'color': 'red', 'user': 'guest'}

parser = argparse.ArgumentParser()
parser.add_argument('-u', '--user')
parser.add_argument('-c', '--color')
namespace = parser.parse_args()
command_line_args = {k:v for k, v in vars(namespace).items() if v}

combined = ChainMap(command_line_args, os.environ, defaults) 
```

来自关于*美丽和惯用*的python[的精彩演讲。](https://youtu.be/OSGv2VnC0go?t=29m11s)

 *但是，我不确定如何区分小写和大写字典键。在两者`-u foobar`都作为参数传递并且环境设置为的情况下`USER=bazbaz`，`combined`字典将如下所示`{'user': 'foobar', 'USER': 'bazbaz'}`。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-06-15T06:27:12.763

另外的选择：

```
 parser = argparse.ArgumentParser()
    env = os.environ
    def add_argument(key, *args, **kwargs):
        if key in env:
            kwargs['default'] = env[key]
        parser.add_argument(*args, **kwargs)

    add_argument('--type', type=str) 
```

或者这个，`os.getenv`用于设置默认值：

```
parser = argparse.ArgumentParser()
parser.add_argument('--type', type=int, default=os.getenv('type',100)) 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-04-07T16:26:15.847

[Click](https://click.palletsprojects.com/)库明确地处理这个：

```
import click

@click.command()
@click.argument('src', envvar='SRC', type=click.File('r'))
def echo(src):
    """Print value of SRC environment variable."""
    click.echo(src.read()) 
```

并从命令行：

```
$ export SRC=hello.txt
$ echo
Hello World! 
```

[https://click.palletsprojects.com/en/master/arguments/#environment-variables](https://click.palletsprojects.com/en/master/arguments/#environment-variables)

你可以安装它

```
pip install click 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-06-06T16:20:40.003

这是一个相对简单（看起来更长，因为它的注释很好）但完整的解决方案，`default`通过使用`parse_args`. 默认情况下，它解析环境变量与命令行参数没有什么不同，尽管可以轻松更改。

```
import shlex

# Notes:
#   * Based on https://github.com/python/cpython/blob/
#               15bde92e47e824369ee71e30b07f1624396f5cdc/
#               Lib/argparse.py
#   * Haven't looked into handling "required" for mutually exclusive groups
#   * Probably should make new attributes private even though it's ugly.
class EnvArgParser(argparse.ArgumentParser):
    # env_k:    The keyword to "add_argument" as well as the attribute stored
    #           on matching actions.
    # env_f:    The keyword to "add_argument". Defaults to "env_var_parse" if
    #           not provided.
    # env_i:    Basic container type to identify unfilled arguments.
    env_k = "env_var"
    env_f = "env_var_parse"
    env_i = type("env_i", (object,), {})

    def add_argument(self, *args, **kwargs):
        map_f = (lambda m,k,f=None,d=False:
                    (k, k in m, m.pop(k,f) if d else m.get(k,f)))

        env_k = map_f(kwargs, self.env_k, d=True, f="")
        env_f = map_f(kwargs, self.env_f, d=True, f=self.env_var_parse)

        if env_k[1] and not isinstance(env_k[2], str):
            raise ValueError(f"Parameter '{env_k[0]}' must be a string.")

        if env_f[1] and not env_k[1]:
            raise ValueError(f"Parameter '{env_f[0]}' requires '{env_k[0]}'.")

        if env_f[1] and not callable(env_f[2]):
            raise ValueError(f"Parameter '{env_f[0]}' must be callable.")

        action = super().add_argument(*args, **kwargs)

        if env_k[1] and not action.option_strings:
            raise ValueError(f"Positional parameters may not specify '{env_k[0]}'.")

        # We can get the environment now:
        #   * We need to know now if the keys exist anyway
        #   * os.environ is static
        env_v = map_f(os.environ, env_k[2], f="")

        # Examples:
        # env_k:
        #   ("env_var", True,  "FOO_KEY")
        # env_v:
        #   ("FOO_KEY", False, "")
        #   ("FOO_KEY", True,  "FOO_VALUE")
        #
        # env_k:
        #   ("env_var", False, "")
        # env_v:
        #   (""       , False, "")
        #   ("",        True,  "RIDICULOUS_VALUE")

        # Add the identifier to all valid environment variable actions for
        # later access by i.e. the help formatter.
        if env_k[1]:
            if env_v[1] and action.required:
                action.required = False
            i = self.env_i()
            i.a = action
            i.k = env_k[2]
            i.f = env_f[2]
            i.v = env_v[2]
            i.p = env_v[1]
            setattr(action, env_k[0], i)

        return action

    # Overriding "_parse_known_args" is better than "parse_known_args":
    #   * The namespace will already have been created.
    #   * This method runs in an exception handler.
    def _parse_known_args(self, arg_strings, namespace):
        """precedence: cmd args > env var > preexisting namespace > defaults"""

        for action in self._actions:
            if action.dest is argparse.SUPPRESS:
                continue
            try:
                i = getattr(action, self.env_k)
            except AttributeError:
                continue
            if not i.p:
                continue
            setattr(namespace, action.dest, i)

        namespace, arg_extras = super()._parse_known_args(arg_strings, namespace)

        for k,v in vars(namespace).copy().items():
            # Setting "env_i" on the action is more effective than using an
            # empty unique object() and mapping namespace attributes back to
            # actions.
            if isinstance(v, self.env_i):
                fv = v.f(v.a, v.k, v.v, arg_extras)
                if fv is argparse.SUPPRESS:
                    delattr(namespace, k)
                else:
                    # "_parse_known_args::take_action" checks for action
                    # conflicts. For simplicity we don't.
                    v.a(self, namespace, fv, v.k)

        return (namespace, arg_extras)

    def env_var_parse(self, a, k, v, e):
        # Use shlex, yaml, whatever.
        v = shlex.split(v)

        # From "_parse_known_args::consume_optional".
        n = self._match_argument(a, "A"*len(v))

        # From the main loop of "_parse_known_args". Treat additional
        # environment variable arguments just like additional command-line
        # arguments (which will eventually raise an exception).
        e.extend(v[n:])

        return self._get_values(a, v[:n])

# Derived from "ArgumentDefaultsHelpFormatter".
class EnvArgHelpFormatter(argparse.HelpFormatter):
    """Help message formatter which adds environment variable keys to
    argument help.
    """

    env_k = EnvArgParser.env_k

    # This is supposed to return a %-style format string for "_expand_help".
    # Since %-style strings don't support attribute access we instead expand
    # "env_k" ourselves.
    def _get_help_string(self, a):
        h = super()._get_help_string(a)
        try:
            i = getattr(a, self.env_k)
        except AttributeError:
            return h
        s = f" ({self.env_k}: {i.k})"
        if s not in h:
            h += s
        return h

# An example mix-in.
class DefEnvArgHelpFormatter\
        ( EnvArgHelpFormatter
        , argparse.ArgumentDefaultsHelpFormatter
        ):
    pass 
```

示例程序：

```
parser = EnvArgParser\
        ( prog="Test Program"
        , formatter_class=DefEnvArgHelpFormatter
        )

parser.add_argument\
        ( '--bar'
        , required=True
        , env_var="BAR"
        , type=int
        , nargs="+"
        , default=22
        , help="Help message for bar."
        )

parser.add_argument\
        ( 'baz'
        , type=int
        )

args = parser.parse_args()
print(args) 
```

示例程序输出：

```
$ BAR="1 2 3 '45  ' 6 7" ./envargparse.py 123
Namespace(bar=[1, 2, 3, 45, 6, 7], baz=123)

$ ./envargparse.py -h
usage: Test Program [-h] --bar BAR [BAR ...] baz

positional arguments:
  baz

optional arguments:
  -h, --help           show this help message and exit
  --bar BAR [BAR ...]  Help message for bar. (default: 22) (env_var: BAR) 
```*

# linux - Bash 脚本 + 移位多个变量

> ID：10551122
> 
> 赞同：1
> 
> 时间：2012-05-11T12:13:35.580
> 
> 标签：linux, bash, shell, shift

我在 Linux 上创建了一个简单的 bash 脚本来创建随机文件。我将文件名和文件大小传递给脚本，如下所示：

```
./createFiles 5 filename1 filename2 
```

*5 = 文件大小

我的代码如下所示：

```
#! /bin/bash

oriDir=files/ori
fileSize=$1
fileName=$2

# Create files
for fileName do

    dd if=/dev/urandom of=$oriDir/$2.mp4 bs=1048576 count=$fileSize

    # Shift through filenames
    shift 1

done 
```

输出符合预期。我的目录中有 2 个新文件：

```
filename1.mp4 (size 5)
filename2.mp4 (size 5) 
```

我现在要做的是为每个文件名使用各种文件大小。我的命令看起来像这样：

```
./createFiles 5 2 filename1 filename2 
```

该脚本将生成 2 个文件：

```
filename1.mp4 (size 5)
filename2.mp4 (size 2) 
```

可选地，脚本应该能够执行以下操作：如果文件名多于给定的文件大小，它应该只取所有剩余文件名的最后一个文件大小：

```
./createFiles 5 2 filename1 filename2 filename3 
```

会产生：

```
filename1.mp4 (size 5)
filename2.mp4 (size 2)
filename3.mp4 (size 2) 
```

我确实尝试过使用 shift 并添加另一个狗屎命令，但没有任何效果。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T12:22:33.813

如果你选择这样的东西

./script file1 size1 file2 size2 ... fileN sizeN

您可以成对遍历此列表

```
limit=$[ $#/2 ]; 
for((i=0;i<$limit;i++)){
file=$1 
size=$2

# do some stuff
shift 2
} 
```

# c++ - 提升字符串拆分以消除单词中的空格

> ID：10551125
> 
> 赞同：10
> 
> 时间：2012-05-11T12:13:48.607
> 
> 标签：c++, string, boost, split

我已经编写了这段代码来将包含带有许多空格和/或制表符的单词的字符串拆分为仅包含单词的字符串向量。

```
#include<iostream>       
#include<vector>                        
#include<boost/algorithm/string/split.hpp>       
#include<boost/algorithm/string.hpp>                         
int main()                              
{                  
    using namespace std;                                     

    string str("cONtainS            SoMe    CApiTaL WORDS");       

    vector<string> strVec;              
    using boost::is_any_of;       

    boost::algorithm::split(strVec, str, is_any_of("\t "));       

    vector<string>::iterator i ;       

    for(i = strVec.begin() ; i != strVec.end(); i++)       
        cout<<*i<<endl;              

    return 0;                                             
} 
```

我期待一个输出

```
cONtainS
SoMe
CApiTaL
WORDS 
```

但是我在strVec中以空间作为元素得到输出，即

```
cONtainS

SoMe

CApiTaL
WORDS 
```

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-05-11T12:17:47.397

`boost::token_compress_on`您需要根据[文档](http://www.boost.org/doc/libs/1_49_0/doc/html/boost/algorithm/split_id820181.html)添加带有值的最终参数：

```
boost::algorithm::split(strVec,str,is_any_of("\t "),boost::token_compress_on); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-11T12:17:55.460

这是因为您的输入包含连续的分隔符。默认情况下`split`，这意味着它们之间有空字符串。

要获得您期望的输出，您需要`eCompress`使用 value 指定可选参数`token_compress_on`。

[http://www.boost.org/doc/libs/1_43_0/doc/html/boost/algorithm/split_id667600.html](http://www.boost.org/doc/libs/1_43_0/doc/html/boost/algorithm/split_id667600.html)

# gwt - GWT 平台、GWT-Ext 和 SmartGWT

> ID：10551127
> 
> 赞同：0
> 
> 时间：2012-05-11T12:13:54.280
> 
> 标签：gwt, smartgwt, gwt-ext

目前我们正在使用具有 MVP 架构的 GWT 平台进行 UI 开发。我可以看到我们总是在使用 SmartGWT 或 GWT-Ext 而非 GWT 平台时获得优势，因为有许多内置组件很难在常规 GWT 小部件中编写。

我现在有以下问题要继续。1\. 我们可以在常规 GWT P 项目上安装 GWT-Ext 或 Smart GWT 并工作吗？即现有的屏幕功能将保留在 GWT 常规小部件中。但是新的开发将与 Smart GWT 或 GWT-Ext 一起使用。这样做会不会有任何冲突或问题？2\. 使用 Smart GWT 或 GWT-Ext，我们还能像 GWT-Platform 一样遵循相同的 MVP 框架，还是我们有不同的服务器端调用机制？3\. 我们想使用免费的授权产品。所以如果我理解的话，SmartGWT 和 GWT-Ext 是免费软件。我对么？4\. 现在 Smart GWT 和 GWT-Ext 都出现了，我应该考虑哪个开始使用它，我将获得更多好的组件、更快的开发、良好的文档帮助和技术的美好未来。现在很难选择使用什么？请建议。

如果您觉得有其他东西比这些最好而且免费，您也可以提出建议。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-12T08:36:40.500

我将总结如下，有很多链接，对我的问题的评论。与可用的小部件库相比，SmartGWT 优于 GWT-Ext。此外，GWT-Ext 支持并不多，而 SmartGWT 即使现在也有足够的支持。SmartGWT 可以免费使用。此外，我们可以在现有的 GWT 平台应用程序之上开始使用 SmartGWT 进行进一步的开发。通过您的上述评论，我知道混合 GWT 和 SmartGWT 小部件不是一个好习惯。但是我们总是可以开始使用所有 SmartGWT 小部件来进行新的 UI 工作。即您将拥有来自 GWT 小部件和 SmartGWT 小部件（较新的屏幕）的屏幕。请确认我的理解是否正确。

现在我有最后一个非常重要的问题——所有当前的服务器调用都是 GWT 平台 RPC 调用——使用 GWT MVP 框架。服务层是使用 GUIC 框架构建的。我想以最少的努力迁移到 SmartGWT。即现有的 GWT 平台屏幕与 GWT 保持原样 - 对 GUICE servlet 框架的 RPC 调用 新开发将使用 SmartGWT 小部件完成，但希望对 GUICE 框架进行 Restful WS 调用。尽管 SmartGWT 为更好的服务器调用提供了数据绑定机制，但我可能不感兴趣，因为我们打算将所有客户端服务器调用转换为带有 JSON 的 Restful Web 服务。我们在这种方法中是否存在任何问题，其中 SmartGWT 用于更好的 UI 开发，但服务器调用是使用 Restful Web 服务（JSON 数据格式）实现的。有人可以帮助我了解如何实现这种行为吗？我希望 GWT 客户端和服务是独立的（技术独立），因此希望采用 Restful Webservice 方法进行客户端-服务器通信。如果我们有任何带有 RESTful Web 服务调用的 SmartGWT 示例，那就太好了。

# javascript - 链接按钮与 url 中的数据

> ID：10551128
> 
> 赞同：0
> 
> 时间：2012-05-11T12:14:03.130
> 
> 标签：javascript, html

我想制作一个按钮链接到另一个页面。此外，我想在 url 中包含一些数据。onclick 方法有效，但我试图在没有 JavaScript 的情况下这样做。表单提交方法几乎可以工作，但不发送数据（id1 和 id2）。有什么建议么？最好使用 JavaScript 吗？谢谢

```
<input type="button" value="Clickable Button - onclick" onclick="window.location.href='http://www.google.com?id1=123&amp;id2=345'" />

<form action="http://www.google.com?id1=123&amp;id2=345"><input type="submit" value="Clickable Button - Submit" /></form> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T12:16:05.567

您需要将一些`hidden`字段添加到您的`<form>`：

```
<form action="http://www.google.com">
    <input type="hidden" name="id1" value="123" />
    <input type="hidden" name="id2" value="345" />
    <input type="submit" value="Clickable Button - Submit" />
</form> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T12:17:53.333

下面是一个非js的解决方案：

```
 <form method="get" action="http://www.google.com">
    <input type="hidden" name="id1" value="123" />
    <input type="hidden" name="id2" value="345" />
    <input type="submit" value="Clickable Button - Submit" />
 </form> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-11T12:18:59.060

```
<form action="http://www.google.com">
<input type="submit" value="Clickable Button - Submit" />
<input type="hidden" name="id1" value="123" />
<input type="hidden" name="id2" value="345" />
</form> 
```

不过，更好的选择是使用普通链接并在必要时使用 CSS 将其设置为按钮样式。[链接想成为链接](http://www.cs.tut.fi/~jkorpela/www/links.html)。

# javascript - 用字符串替换字符串

> ID：10551132
> 
> 赞同：0
> 
> 时间：2012-05-11T12:14:12.670
> 
> 标签：javascript, string, function, variables, d3.js

我有这个功能：

```
var chart = d3.parsets()
        .dimensions(["Survived", "Age", "Class"]); 
```

我想`["Survived", "Age", "Class"]`用来自其他变量的字符串替换。所以我可以改变它。在这个例子中：`.dimensions(["Survived", "Age"]);`

我所拥有的是：

```
var strDimensions = ('"Survived", "Age"');

var chart = d3.parsets()
    .dimensions([strDimensions]); 
```

但这不起作用

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T13:07:00.010

你的数组语法错误，试试这个：

```
var strDimensions = ['Survived', 'Age'];

var chart = d3.parsets().dimensions(strDimensions); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T12:22:19.010

```
var strDimensions = ('"Survived", "Age"');

var chart = d3.parsets()
    .dimensions([strDimensions]); 
```

你得到的是一个有一个索引的数组，而不是两个。

如果要使用字符串，可以将其拆分为数组。

```
var strDimensions = ('Survived,Age');

var chart = d3.parsets()
    .dimensions(strDimensions.split(","); 
```

你为什么不从数组开始呢？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T12:24:52.993

你需要的是

变暗淡 = [];

现在您可以根据需要从数组中添加和删除

然后使用

var chart = d3.parsets().dimensions(dims);

# iphone - 处理大数字

> ID：10551133
> 
> 赞同：0
> 
> 时间：2012-05-11T12:14:14.000
> 
> 标签：iphone, objective-c, ios

我有一个像 12345678910111213 这样的数字，我需要将它从一个方法（cellForRow）传递给另一个（按钮操作方法）。我曾经使用的最简单的方法是通过按钮标签传递它。在这种情况下，这是不可能的（？）。我也可以为它创建一个属性，但是封装呢？我想知道真正正确（最好是简单）的方式来做这样的事情。提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T12:29:06.073

好吧，您实际上可以将值附加到`UIButton`. 当您拥有要传递的值并且您有对按钮的引用时：

```
static char kMyObject;

objc_setAssociatedObject(myButton, &kMyObject, [NSNumber numberWithInt:myInt], OBJC_ASSOCIATION_RETAIN_NONATOMIC); 
```

另一方面，当您收到按钮为 id 的操作时：

```
- (void)myAction:(id)sender
{
   UIButton *myButton = (UIButton*)sender;
   NSNumber *number=objec_getAssociatedOject(myButton,&kMyObject);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T12:50:00.253

正如萨德所说，您不能将其作为标签传递。您可以在此处使用[NSDecimal 数字](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSDecimalNumber_Class/Reference/Reference.html)。@Saad 不能使用双精度，因为它会失去精度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T12:29:07.753

在这个整数标签中，您可以将指针（32 位地址的情况）存储到类/结构/代表 bigint 的任何内容。

例如：

```
UIButton *button = [UIButton ...];
button.tag = (int)[[MyBigInt alloc] initWithString:@"12131312312312312"]; 
```

后：

```
MyBigInt *bigInt = (MyBigInt *)button.tag;
...
[bigInt release]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-11T14:10:50.173

我将在这里做一些假设，因为我只是在经历类似的事情时。

1.  带有操作的 UIButton 位于 UITableViewCell 中。
2.  您拥有所有数据的基础来源（即，包含所有数据的数组）。
3.  您可以轻松访问您的 tableView。

首先，您需要获取包含按钮的单元格：

```
UITableViewCell *cell = nil;
for (UIView *view = sender; view; view = view.superview) {
    if ([view isKindOfClass:[UITableViewCell class]]) {
        cell = (UITableViewCell *)view;
        break;
    }
} 
```

接下来，您需要获取该单元格的 indexRow：

```
NSIndexPath *indexPath = [self.tableView indexPathForCell:cell]; 
```

最后，您必须访问您的数据：

```
ModelClass modelObject* obj = [self.data objectAtIndex:indexPath.row]; 
```

现在，您可以对模型进行所需的任何更改。

# php - 使用 PHP 显示文件夹中的文件

> ID：10551135
> 
> 赞同：0
> 
> 时间：2012-05-11T12:14:24.070
> 
> 标签：php

我在使用 PHP 显示文件夹中的文件时遇到问题，用于显示的代码是

```
<?php

$dir="public_html/Uploads"; // Directory where files are stored

if ($dir_list = opendir($dir))
{
while(($filename = readdir($dir_list)) != false)
{
?>
<p><a href="<?php echo $filename; ?>"><?php echo $filename;
?></a></p>
<?php
}
closedir($dir_list);
}

?> 
```

此代码在本地服务器中工作正常，它是一个 wamp 服务器，它列出了文件夹中的所有文件。

但我的问题是当我将它上传到 hostgator 服务器时它会出现问题，它给我一个 500 错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T12:17:49.253

这可能是因为您的权限不足。尝试使用 chmod：

```
chmod("public_html/Uploads", 0644); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T12:24:58.713

`public_html/`从这行代码中删除`$dir="public_html/Uploads";`，让我知道它是否有效。

# windows - taskkill：不同的行为控制台与脚本

> ID：10551139
> 
> 赞同：1
> 
> 时间：2012-05-11T12:14:31.743
> 
> 标签：windows, batch-file, taskkill

我正在为 java 应用程序编写一个小的关闭脚本。我得到了 pid，然后尝试执行以下操作：

```
taskkill /t /pid !pid! 
```

如果我从控制台运行命令（手动输入）一切正常。我看到在 java 控制台中执行了关闭例程，然后 java 控制台就消失了。我有时会在几秒钟后看到窗口“进程没有响应。立即终止或等待”对话框，但当 java 程序停止时，对话框会自动关闭。

如果我使用相同的命令执行 bat 文件，我会立即看到“进程没有响应...”对话框。我看到控制台输出：“进程已成功关闭”，但 java 控制台仍处于打开状态。它甚至没有启动关机程序。

编辑：完整的批处理脚本

```
@echo off
setlocal enabledelayedexpansion
if exist .\lock (
set /p pid=< lock
taskkill /t /pid !pid!
) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T12:45:49.223

在命令行`!pid!`上通常不会展开，因为延迟展开被禁用并且只能由注册表 ey 或使用`cmd /V:on`.

所以在命令行将`!pid!`保持不变，在批处理中它将被扩展为`pid`变量的内容。

**编辑** 当您在 cmd 行上显示*正确*的命令时，批处理中的命令一定是错误的。

您应该在 set/p 行之后添加一个回声

```
Echo pid="!pid!" 
```

# python - Python 执行名称错误

> ID：10551143
> 
> 赞同：4
> 
> 时间：2012-05-11T12:14:39.120
> 
> 标签：python, scope

我有一个包含函数的字符串变量。该函数如下所示：

```
def program():
    x[0] = y[1]
    z[0] = x[0]
    out = z[0] 
```

这是在一个方法中：

```
def runExec(self, stringCode):
    x = [1,2,3,4]
    y = [5,6,7,8]
    z = [6,7,8,9]
    exec stringCode
    return out 
```

我收到一个 NameError，似乎无法从 stringCode exec 访问 x、y 和 z？

如何使这些变量可访问，我是否必须以某种方式传递它们？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T12:28:17.197

***假设您有充分的理由使用`exec`**，这是您应该仔细检查的假设。*

您需要为`exec`函数提供全局和本地范围。此外，“程序”字符串需要实际运行，而不是仅仅定义一个函数。这将起作用：

```
prog = """
x[0] = y[1]
z[0] = x[0]
out = z[0]
"""

def runExec(stringCode):
    x = [1,2,3,4]
    y = [5,6,7,8]
    z = [6,7,8,9]
    exec(stringCode, globals(), locals())
    return out

print runExec(prog) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T12:17:23.007

为什么需要使用`exec`？以下代码应该以相同的方式工作，只是没有`exec`：

```
def program(x, y, z):
    x[0] = y[1]
    z[0] = x[0]
    out = z[0]
    return out

def runExec(self, func):
    x = [1,2,3,4]
    y = [5,6,7,8]
    z = [6,7,8,9]
    out = func(x, y, z)
    return out

self.runExec(program) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-11T12:18:19.590

你可以让它们全球化。

```
global x,y,z
def runExec(self, func):
    x = [1,2,3,4]
    y = [5,6,7,8]
    z = [6,7,8,9]
    out = func(x, y, z)
    return out 
```

# xmpp - ejabber MUC 未通知新消息

> ID：10551146
> 
> 赞同：-1
> 
> 时间：2012-05-11T12:14:43.547
> 
> 标签：xmpp, ejabberd, multiuserchat

我在 centos 5 系统上设置了 ejabber，效果很好。唯一的问题是MUC。在 MUC 上收到新消息时，客户端不会收到通知。我正在使用 Adium 和 Pidgin。

MUC 设置如下所示：

```
 {mod_muc,      [
                  %%{host, "conference.@HOST@"},
                  {access, muc},
                  {access_create, muc_admin},
                  {access_persistent, muc},
                  {access_admin, muc_admin},
                  {default_room_options,
                        [
                          {allow_change_subj, true},
                          {allow_private_messages, true},
                          {allow_user_invites, true},
                          {anonymous, true},
                          {logging, true},
                          {members_by_default, true},
                          {persistent, true},
                          {public, true},
                          {public_list, false}
                        ]}
                 ]}, 
```

如果在普通用户节点上的用户之间收到消息，则通知效果很好。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T08:49:58.377

In my understanding this is a client side configuration / usage problem. This is not related to ejabberd. Please configure or change your client to your liking.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T13:15:50.040

正如 Mickael 所指出的，它是客户端。XMPP 通过设计禁用群聊通知，以避免数百条通知溢出您的屏幕。

在客户端中有一个选项可以启用群聊通知。在 Adium 中，需要启用以下事件：收到消息（后台群聊）

# jquery - jQuery - 基于锚类预加载图像

> ID：10551147
> 
> 赞同：0
> 
> 时间：2012-05-11T12:14:49.367
> 
> 标签：jquery, preloader, preload, image-preloader

所以我有以下HTML：

```
<ul id="nav">
    <li><a href="somepage1.php" class="class1">Link1</a></li>
    <li><a href="somepage2.php" class="class2">Link2</a></li>
</ul> 
```

jQuery函数：

```
(function($) {
    var imgList = [];
    $.extend({
        preload: function(imgArr, option) {
            var setting = $.extend({
                init: function(loaded, total) {},
                loaded: function(img, loaded, total) {},
                loaded_all: function(loaded, total) {}
            }, option);
            var total = imgArr.length;
            var loaded = 0;

            setting.init(0, total);
            for(var i in imgArr) {
                imgList.push($("<img />")
                    .attr("src", imgArr[i])
                    .load(function() {
                        loaded++;
                        setting.loaded(this, loaded, total);
                        if(loaded == total) {
                            setting.loaded_all(loaded, total);
                        }
                    })
                );
            }

        }
    });
})(jQuery); 
```

和文档就绪触发器（简化）：

```
$.preload([
    'path/to/image.jpg',
    'path/to/image2.jpg',
    'path/to/image3.jpg',
    'path/to/image4.jpg',
]); 
```

它工作得很好，但我需要加强它。当用户单击类“class1”的锚点时，预加载器应读取分配给特定数组的图像。**而且我只需要写一次'$.preload'。**

所以我的想法是创建两个不同的数组，例如：

```
var arraysClass1 = [
    'path/to/image.jpg',
    'path/to/image2.jpg',
    'path/to/image3.jpg',
    'path/to/image4.jpg'
];

var arraysClass2 = [
    'path/to/image5.jpg',
    'path/to/image6.jpg',
    'path/to/image7.jpg',
    'path/to/image8.jpg'
]; 
```

然后创建如下所示的文档就绪事件。**我被困在这里，下面的代码有错误**

```
$('#nav a').live("click", (function(event){
    event.preventDefault();
    var getClass = '.'+$(this).attr("class");
    $(function() {
        $.preload([
            if(getClass=='.class1'){
                arrayClass1;
            }
            elseif(getClass=='.class2'){
                arrayClass2;
            }

        ]);
    }); 
```

我不知道如何在 $.preload([...]); 中创建“IF”逻辑；

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T12:29:12.360

为什么不找出 $.preload([]) 之外的适当对象，如下所示。

```
$('#nav a').live("click", (function(event){
    event.preventDefault();
    var getClass = '.'+$(this).attr("class");
    var targetObj ;
     if(getClass=='.class1'){
                targetObj = arrayClass1;
     }
     else if(getClass=='.class2'){
                targetObj = arrayClass2;
     }  
        $.preload(targetObj);
}); 
```

`$(function())`并且您在点击回调中不需要另一个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T12:34:27.520

这是可以执行您要查找的代码的代码块：

```
$('#nav a').live("click", function(event){
    event.preventDefault();
    usearr='';
    if ($(this).attr("class")=="class1") {
        usearr=arraysClass1;
    } else if ($(this).attr("class")=="class2") {
        usearr=arraysClass2;
    }
    $.preload(usearr);
}); 
```

# javascript - 链接到外部 .js 文件不起作用

> ID：10551149
> 
> 赞同：0
> 
> 时间：2012-05-11T12:14:56.913
> 
> 标签：javascript

我目前将我的文件放在虚拟服务器（USB Webserver V8.2）上。现在在服务器上，打开页面没有任何反应。我知道它与链接路径名称有关，但我尝试以多种不同的方式更改链接，但没有。

```
<script type="text/javascript" src="/root/help_page_code.js"></script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T12:19:22.717

那是一个[相对路径](http://www.boogiejack.com/server_paths.html)，所以服务器正在寻找一个`root`在网页文件夹中命名的目录。

如果你想从页面上去一个目录，只需 make it `../root/help_page_code.js`。如果您要走得更远，并且可以访问，只需`../`为每个级别添加一个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T12:18:36.160

尝试`.`在路径前添加点：

```
<script type="text/javascript" src="./root/help_page_code.js"></script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T12:26:31.727

*   在谷歌浏览器中打开你的页面。按 F12 键打开开发者菜单。
*   在第一个选项卡（元素）中，查看您的脚本文件是否位于 html 的头部
*   在第二个选项卡（资源）中查找脚本并将鼠标悬停在其名称上。然后您将看到用于查找脚本的实际路径

验证它是否与服务器上的物理路径相同。

如果脚本和网页都在同一个文件夹中，你可以选择这个：

```
<script type="text/javascript" src="help_page_code.js"></script> 
```

# json - 如何在动作脚本中解析 JSON？

> ID：10551150
> 
> 赞同：0
> 
> 时间：2012-05-11T12:14:57.373
> 
> 标签：json, actionscript-3

我想解析 JSON

```
[ 
{ 
    "food": [ 
        { 
            "name": "pasta", 
            "price": 14.50, 
            "quantity": 20 
        }, 
        { 
            "name": "soup", 
            "price": 6.50, 
            "quantity": 4 
        } 
    ] 
}, 
{ 
    "food": [ 
        { 
            "name": "salad", 
            "price": 2.50, 
            "quantity": 3 
        }, 
        { 
            "name": "pizza", 
            "price": 4.50, 
            "quantity": 2 
        } 
    ] 
} 
] 
```

如何从 JSON 中获取元素，例如每个数组和每个数组中的元素。我有比这更大的 JSON。逐行解析需要几分钟。任何更快的解决方案。
期待org JSON util之类的链接以及一些如何使用它的代码

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T12:40:30.880

[as3corelib](https://github.com/mikechambers/as3corelib)是一个包含 JSON 静态类的库，该类具有函数`JSON.parse()`. 默认情况下，这应该已经包含在您的 Flash 项目中。

`JSON.parse()`接受一个字符串并返回您解析的 JSON 对象。如果您需要帮助解释/访问结果，互联网上有许多使用 JSON.parse() 的教程。

# iphone - 使用 UIView (AwesomeMenu) -> 视图不出现

> ID：10551163
> 
> 赞同：0
> 
> 时间：2012-05-11T12:15:49.027
> 
> 标签：iphone, cocoa-touch

我尝试在我的代码中使用 AwesomeMenu，这里是： [https ://github.com/levey/AwesomeMenu](https://github.com/levey/AwesomeMenu)

它的用法很简单，在 github 页面中列出。我照原样跟着它。但是菜单没有出现在 UI 中。我正在使用 iOS 5.0 和 Xcode 4.2，以及 iOS 模拟器进行测试。

这就是我所做的：

**在我的 ViewController.h**

```
...
#import "AwesomeMenu.h"
#import "AwesomeMenuItem.h"
...
// I included the AwesomeMenuDelegate here 
@interface com_FirstViewController : UIViewController <UITableViewDelegate,      UITableViewDataSource,AwesomeMenuDelegate> {
...
}
@property (nonatomic, retain) IBOutlet AwesomeMenu *awesomeMenu;
... 
```

**在 Storyboard** 中，我创建了一个 UIView 实例，将其定位并调整其大小，将其类更改为类型“AwesomeMenu”，并将其“引用插座”链接到 IBOutlet 属性“awesomeMenu”。

**在 ViewController.m 中**

```
...
@synthesize awesomeMenu;
...
AwesomeMenuItem *starMenuItem1;
AwesomeMenuItem *starMenuItem2;
...
...

// This method seems to be getting called, as I see the log messages
-(void) initializeSpringMenu {
    NSLog(@"InitializeSpringMenu: entered");
    UIImage *storyMenuItemImage = [UIImage imageNamed:@"GooglePlus.png"];
    UIImage *storyMenuItemImagePressed = [UIImage imageNamed:@"GooglePlus.png"];
    UIImage *starImage = [UIImage imageNamed:@"Mail-icon.png"];

    starMenuItem1 = [[AwesomeMenuItem alloc] 
                                    initWithImage:storyMenuItemImage
                                    highlightedImage:storyMenuItemImagePressed 
                                    ContentImage:starImage 
                                    highlightedContentImage:nil];
    starMenuItem2 = [[AwesomeMenuItem alloc] 
                                    initWithImage:storyMenuItemImage
                                    highlightedImage:storyMenuItemImagePressed 
                                    ContentImage:starImage 
                                    highlightedContentImage:nil];

    // Now, setup the menu and the options
    awesomeMenu = [[AwesomeMenu alloc] 
                initWithFrame:self.view.bounds 
                menus:[NSArray arrayWithObjects:starMenuItem1, starMenuItem2, nil]];
    awesomeMenu.delegate = self;
    NSLog(@"initializeSpringMenu: Done initializing it");
}

- (void)viewDidLoad {
    ...
    [self initializeSpringMenu];
    ...
} 
```

我认为这很简单，我看不出这里缺少什么。执行 AwesomeMenu 的“初始化”时是否有界限？有人可以帮忙吗？当我运行应用程序时，视图在 UI 中显示为空白。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T12:57:17.697

让，

您需要添加`AwesomeMenu`到 ViewController 的视图中。修改结尾`initializeSpringMenu`如下：

```
 .......

    // Now, setup the menu and the options
    awesomeMenu = [[AwesomeMenu alloc] 
                  initWithFrame:self.view.bounds 
                  menus:[NSArray arrayWithObjects:starMenuItem1, starMenuItem2, nil]];
    awesomeMenu.delegate = self;

    [self.view addSubView:awesomeMenu] // <-- THIS ADDS THE AWESOME VIEW TO YOUR VIEWCONTROLLERS VIEW
    NSLog(@"initializeSpringMenu: Done initializing it");
} 
```

这应该就是全部了。

# android - Textview 导致 java.lang.ClassCastException: android.widget.TextView

> ID：10551180
> 
> 赞同：0
> 
> 时间：2012-05-11T12:17:14.563
> 
> 标签：android, textview

我有三个文本视图并在它们上应用了 clickevent，但是当我单击它们中的任何一个时，它们会导致应用程序中的 Forceclose 错误。我也尝试过更改 ids textviews 然后清理项目并运行项目仍然没有删除错误。

我的 XML 代码是

对于一个文本视图

```
<LinearLayout
        android:id="@+id/LL_fb" 
        android:layout_width="180px"
        android:layout_height="27px"
        android:layout_above="@+id/txt_msg_regs"
        android:layout_alignLeft="@+id/LL_signup"
        android:layout_marginBottom="25dp"
        android:background="@drawable/facebook" >        
    <TextView
        android:id="@+id/btn_txt_fb"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Connect with facebook"
        android:layout_gravity="center_vertical"
        android:layout_marginLeft="23dp"
        android:layout_marginTop="1dp"
        android:clickable="true"
        android:textColor="#FFFFFF" />
    </LinearLayout> 
```

对于第二个文本视图

```
<LinearLayout 
        android:id="@+id/LL_signup"
        android:layout_width="180px"
        android:layout_height="29px"
        android:layout_above="@+id/textView1"
        android:layout_alignLeft="@+id/LL_login"
        android:background="@drawable/lmyic_signup">

    <TextView
        android:id="@+id/btn_txt_sinup"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="signup with email"
        android:layout_gravity="center_vertical"
        android:layout_marginLeft="25dp"
        android:layout_marginTop="1dp"
        android:clickable="true"
        android:textColor="#FFFFFF" />

    </LinearLayout> 
```

第三个

```
 <LinearLayout 
            android:id="@+id/LL_login"
            android:layout_width="180px"
                android:layout_height="29px"
                android:layout_alignParentBottom="true"
                android:layout_centerHorizontal="true"
                android:layout_marginBottom="69dp"
                android:background="@drawable/lmyic_login">
        <TextView
            android:id="@+id/btn_txt_login"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Log in"
            android:layout_gravity="center_vertical"
            android:layout_marginLeft="70dp"
            android:layout_marginTop="1dp"
            android:textColor="#FFFFFF" 
            android:clickable="true"/> 
        </LinearLayout> 
```

这是我的安卓代码。意图中的这个类名也是正确的，我验证了它们。

```
TextView img_login;
img_login = (TextView)findViewById(R.id.btn_txt_login);
 img_login.setOnClickListener(new OnClickListener() {

            @Override
            public void onClick(View v) {
                // TODO Auto-generated method stub

                if(v.getId() == img_login.getId())
                {
                Intent i_lin = new Intent(LockmeifyoucanActivity.this,lmiyc_login.class);
                startActivity(i_lin);
                }                   
            }
        }); 
```

请告诉我这有什么问题。如果需要 logcat，请向我索取....

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T12:24:17.043

请发布完整的 XMl，以便我们可以查看其中的 btn_txt_login。

它看起来是按钮，因为“findViewById(R.id.btn_txt_login);” 如果此“btn_txt_login”id 不在 xml 中，将返回 null。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T12:50:29.070

你在 lmiyc_login activity.in lmiyc_login corrent line number 46 中的 textview 有一些问题，这可能是：

```
TextView txtview;
txtview = (TextView)yourlayout.findViewById(R.id.txtviewid); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T12:46:47.983

要快速解决此错误，请在以下行设置一个断点：

```
View view = findViewById(R.id.btn_txt_login); 
```

然后，在 locals 选项卡上查看哪个组件，查看`gen/R.java.`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-11T12:59:19.740

这些是 42-48 行

```
 setContentView(R.layout.lmyic_login_page);                 
  txtBack = (TextView)findViewById(R.id.ImgViewTxtBack);          txtBack.setTypeface(null,Typeface.BOLD);
   iv_login = (ImageView)findViewById(R.id.Txtlogin);
   iv_login.setOnClickListener(this);
   iv_sign_up = (ImageView)findViewById(R.id.TxtSignup); 
```

我认为问题在于 iv_login = (ImageView)findViewById(R.id.Txtlogin); – Dheeresh Singh 1 分钟前编辑，因为这是 46 行，它应该是 textview，您在 Imageview 中进行投射 – Dheeresh Singh 刚刚编辑

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-11T12:34:17.863

用这个改变你的代码

```
TextView img_login;
 img_login = (TextView)findViewById(R.id.txt_login);
   img_login.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {
            // TODO Auto-generated method stub

            if(v.getId().equals(img_login.getId()))
            {
            Intent i_lin = new Intent(LockmeifyoucanActivity.this,lmiyc_login.class);
            startActivity(i_lin);
            }                   
        }
    }); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-03-26T17:07:35.127

如果您有重复的资源 ID，则会抛出 ClasscastException。因此，请确保您在整个项目中没有重复的元素 ID。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-11T12:20:24.147

```
findViewById(R.id.btn_txt_login); 
```

这真的是 TextView 还是您的布局中也有 Button？我认为您正在尝试将 Button 转换为 TextView

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-05-11T12:20:52.493

资源ID错误...

```
img_login = (TextView)findViewById(R.id.btn_txt_login); 
```

根据你的 XML 应该是

```
img_login = (TextView)findViewById(R.id.txt_login); 
```

ETC..

# sql - 在多对多关系连接中合并列值

> ID：10551182
> 
> 赞同：5
> 
> 时间：2012-05-11T12:17:17.953
> 
> 标签：sql, sql-server, asp.net-3.5, sql-server-2008-express

我有两个表，**Books**和**Authors ，它们之间通过名为****book_authors**的第三个表具有多对多关系，我正在尝试使用内部连接列出每本书的作者的所有书籍，以便将它们显示在[DataList](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.datalist.aspx)控件，但是连接导致了几个重复的行，因为每本书可能有很多作者，所以每个作者都会有一行。
例子：

```
book_title           author  
b1                    a1  
b1                    a2 
```

解决此问题的最佳方法是什么，使其变为：

```
book_title                author  
b1                        a1, a2 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-11T12:27:43.223

也许是这样的：

```
SELECT
    Books.book_title,
    STUFF
    (
        (
            SELECT 
                ',' +author
            FROM
                book_authors
                JOIN Authors
                    ON book_authors.authorId=Authors.authorId
            WHERE
                book_authors.bookId=Books.bookid
            FOR XML PATH('')
        )
    ,1,1,'')
FROM
    Books 
```

**编辑**

没有你的数据很难说。这是否有效：

```
DECLARE @Table1 TABLE(ID INT)
DECLARE @Table2 TABLE(Name varchar(100),ID INT)

INSERT INTO @Table1 VALUES(1),(2)
INSERT INTO @Table2 VALUES('test1',1),('test2',1),('test3',2),('test4',2)

SELECT
    t1.ID,
    STUFF
    (
        (
            SELECT 
                ',' +t2.Name
            FROM
                @Table2 AS t2
            WHERE
                t1.ID=t2.ID
            FOR XML PATH('')
        )
    ,1,1,'')
FROM
    @Table1 AS t1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T12:46:37.497

如果您想纯粹在 SQL 中执行此操作，那么您将需要一个子查询，该查询将获取图书 ID 并生成作者列表（如果您想要的话，则为 csv）。在另一个查询中使用该子查询，**对于每个唯一的 bookid**，它都会返回 book_title 和 author 列表。

如果您不介意不使用纯 SQL，我会说只需遍历您当前正在获取的 DataList 并制作一个地图类型的结构（book_title -> authorList），然后在您浏览时添加作者。

最佳选择取决于您使用它的范围，但通常我会说 sql 路由是要走的路。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-11T13:31:41.187

您要做的是字符串聚合连接。关于这个主题有一些非常好的帖子。

这是一种替代方法，在您的情况下可能很容易，因为书籍没有太多作者：

```
select b.name,
       (max(case when authornum = 1 then author else '' end) +
        max(case when authornum = 2 then ', '+ author else '' end) +
        max(case when authornum = 3 then ', '+ author else '' end)
       ) as authors
 from (select ba.*,
              row_number() over (partition by bookid order by authorid) as authornum
       from BookAuthors ba
      ) bajoin
      Authors a
      on a.authorid = ba.authorid join
      Books b
      on b.bookid = ba.bookid
 group by b.name 
```

您只需要确保在 select 语句中包含足够多的作者。

# sorting - 字符串选择排序

> ID：10551186
> 
> 赞同：0
> 
> 时间：2012-05-11T12:17:40.260
> 
> 标签：sorting, selection

选择排序如何处理字符串？我做了一些搜索，似乎无法找到明确的答案。如果我有 4 个名字 [Rob、Adam、Tom、Thomas] - 选择排序如何对这些进行排序？它会简单地按第一个字母排序吗？如果是这样，它会像下面这样排序吗：[Adam, Rob, Thomas, Tom]。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T13:31:16.813

所有排序算法都使用某种比较函数来确定元素的顺序。它通常独立于您选择的特定排序算法。

大多数语言尝试猜测比较函数，具体取决于排序数据的类型。例如，数字比较只是检查哪个数字更大。字符串上的比较函数使用[字典顺序](http://en.wikipedia.org/wiki/Lexicographical_order)来比较连续的字母。一些示例（GT - 大于，LT - 小于）：

*   比较数字：

    ```
    > compare 1 2
    LT 
    ```

*   字母：

    ```
    > compare 'R' 'A'
    GT 
    ```

*   字符串（它在内部比较字母，想想如何）：

    ```
    > compare "Rob" "Adam"
    GT 
    ```

排序函数在内部使用此比较（[1,2,3] 是三个数字的列表）。您不知道内部使用了哪种排序算法，但只要使用相同的比较函数，结果应该不会有所不同：

```
> sort [3,1,2]
[1,2,3]

> sort ['t', 'h', 'o', 'm', 'a', 's']
['a', 'h', 'm', 'o', 's', 't']

> sort ["Rob", "Adam", "Tom", "Thomas"]
["Adam","Rob","Thomas","Tom"] 
```

您甚至可以定义自己的比较函数，以按一些更复杂的标准进行排序：

*   按素数除数对数字列表进行排序。

    第一个自定义比较函数：

    ```
    > numOfPrimeDivs 30
    3

    > numOfPrimeDivs 6
    2

    > let compareNumOfPrimeDivs n1 n2 = compare (numOfPrimeDivs n1) (numOfPrimeDivs n2)) 

    > compareNumOfPrimeDivs 30 6
    GT

    > sortBy compareNumOfPrimeDivs [2,210,30,2310,6]
    [2,6,30,210,2310] 
    ```

*   按字符串长度排序

    比较功能：

    ```
     > length "Rob"
     3

     > length "Adam"
     4

     > let compareLength s1 s2 = compare (length s1) (length s2)

     > compareLength "Rob" "Adam"
     LT

     > sortBy compareLength ["Rob", "Adam", "Tom", "Thomas"]
     ["Rob","Tom","Adam","Thomas"] 
    ```

# php - 仅在 PHP 中随机配对用户 - 解决方案

> ID：10551196
> 
> 赞同：3
> 
> 时间：2012-05-11T12:18:18.817
> 
> 标签：php, mysql

所以我只想在 PHP 中配对用户：

首先，获取一个可用的用户 ID //现在不是随机的

```
mysql_query('SELECT id FROM users WHERE state="0" LIMIT 1'); //state 0 = user avaliable, 1 = talking/playing with someone 
```

$available_id = 从查询中获取 id 的东西

然后更新：

```
$result = mysql_query('UPDATE INTO users SET state="1" WHERE (id=$available_id OR id=$my_id) AND state="0"'); 
```

如果`$result == false`那么这意味着没有一行更新。那么回到第一步，
如果`$result == true`然后呢？这可能意味着我的行已更新或可用用户，或两者兼而有之。我很困惑如何处理它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T12:21:32.020

`mysql_query`返回`false`错误。[您可以使用mysql_affected_rows](http://php.net/manual/en/function.mysql-affected-rows.php)检查更新的行数

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T12:21:54.850

你可以使用`mysql_num_rows();` [http://php.net/manual/en/function.mysql-num-rows.php](http://php.net/manual/en/function.mysql-num-rows.php)和`mysql_affected_rows();` [http://php.net/manual/en/function.mysql-affected-rows.php](http://php.net/manual/en/function.mysql-affected-rows.php)

您的查询似乎错误`$result = mysql_query('UPDATE INTO users SET state="1" WHERE (id=$available_id OR id=$my_id) AND state="0"');`删除`into`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T12:31:43.193

```
$id = mysql_query('SELECT id FROM users WHERE state="0" LIMIT 1');
$uid = mysql_fetch_array($id);

$id2 = mysql_query('SELECT id FROM users WHERE status="0" AND `id`!='".$uid."' ORDER BY rand LIMIT 1');
$uid2 = mysql_fetch_array($id2);

mysql_query("UPDATE user SET `user`='1' WHERE `id` IN($uid,$uid2)"); 
```

并在您的配对表中配对。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-11T13:08:59.803

试试这个代码

```
$first=mysql_query('select id from users where state =0 limit 1');

$available=mysql_fetch_row($first);
$available_id=$available['id'];

$result = mysql_query('UPDATE INTO users SET state="1" WHERE
(id=$available_id OR id=$my_id) AND state="0"'); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-11T12:22:22.210

不，

是这样的

> INSERT、UPDATE、DELETE、DROP 等，mysql_query() 在成功时返回 TRUE，在错误时返回 FALSE。

如果 mysql_query 返回 FALSE 意味着您查询失败并且有语法错误，如果 TRUE，则意味着查询成功运行，但这并不意味着该行已更新。

成功执行 UPDATE 查询后，您可以使用[mysql_affected_rows](http://php.net/manual/en/function.mysql-affected-rows.php)真正检查行是否更新

# c# - 如何检查一个单词是否包含字符串中的字符？

> ID：10551200
> 
> 赞同：1
> 
> 时间：2012-05-11T12:18:34.923
> 
> 标签：c#, string, word, contains

我正在尝试创建一个程序来读取这个带有域列表的文本文件，但它还有很多其他不必要的东西，比如标题、每个域的标题等。我想要的只是域。

现在，一个共同点是所有域都有一个“。”。某处甚至两个。有没有办法检查该 .txt 文件中的**单词是否有“。”，然后将其添加到另一个字符串？**

我环顾四周，但我只发现字符串包含，而不是单词包含。

现在如果不存在，有没有办法将每个单词分成一个字符串数组，然后用 for 循环单独测试每个单词？

这是一个例子：

```
Domain list name the first domain ip magicdomain.com name the second domain ip magicdomain2.com
etc. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T12:21:27.343

考虑这段代码：

```
 var words = text.Split(" ");

        foreach (var word in words)
            if (word.Contains("lookup"))
                Console.WriteLine("found it"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T12:22:10.103

或者您可以为此使用正则表达式。谷歌“域名的正则表达式”，我发现[这个库](http://regexlib.com/Search.aspx?k=URL)很有用

相关 SO：[使用 C# 正则表达式解析域名？](https://stackoverflow.com/questions/3325326/using-a-c-sharp-regex-to-parse-a-domain-name)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T12:20:15.843

[`string.IndexOf`](http://msdn.microsoft.com/en-us/library/719kb161)`-1`如果存在或不存在，将返回传入的字符或字符串的索引。

```
if(word.IndexOf('.') > -1)
{
  // got a `.` do something with word
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-11T12:22:01.137

获取字符串中的单词比检查每个单词的所需字符

从字符串中获取单词

检查“正则表达式：如何从字符串中获取单词（C#）”[链接](https://stackoverflow.com/questions/2159026/regex-how-to-get-words-from-a-string-c)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-11T12:23:03.890

您确定只有域部分将包含`.`

是否有任何分隔符用于分隔同一行上的其他信息。

如果没有看到您的一些示例数据，很难提出建议，但是如果您是域，则始终是一行的第一件事，然后是一个空格。您可以使用 Substring 和 IndexOf 的组合来获取第一个标记词。

```
line.Substring(0, line.IndexOf(' ')) 
```

或者，您可以使用该`string.Split()`方法根据某些分隔符对行进行标记。

您可以发布一些示例数据吗？

# java - 解析从 OMIM RESTful Web 服务获得的 DOM 时出错

> ID：10551202
> 
> 赞同：0
> 
> 时间：2012-05-11T12:18:39.050
> 
> 标签：java, web-services, rest, bioinformatics

> 我是网络服务的初学者，任何有经验的人都可以帮助我解决以下问题：
> 
> 我正在编写一个试图从 OMIM RESTful Web 服务获取信息的客户端。我正在使用注册后提供的密钥 OMIM。( [http://omim.org/help/api](http://omim.org/help/api) ) 我成功连接到客户端。同样使用 GET 方法，我可以将所需的数据提取到 DOM 文档中。此外，我可以成功地将整个 DOM 写入本地磁盘上的文件中。但是，我无法使用可用于 DOM 的标准解析函数来处理 DOM。
> 
> 例如：我可以使用 NodeList nl=doc.getDocumentElement() 获取根节点并打印到控制台上。但是当我尝试打印根节点的第一个子节点时，它返回 null 而不是预期的子节点。
> 
> 示例 XML 表单：webservices -> DOM -> 文件

```
 <?xml version="1.0" encoding="UTF-8" standalone="no"?><omim version="1.0">
    <clinicalSynopsisList>
    <clinicalSynopsis>
    <mimNumber>100070</mimNumber>
    <prefix>%</prefix>
    </clinicalSynopsis>
    </clinicalSynopsisList>
    </omim> 
```

请在下面找到我的代码：

```
String path="http://api.omim.org:8000/api/clinicalSynopsis?mimNumber="+"100070"+"&include=clinicalSynopsis&format=xml&apiKey="+"<< xxxxx private key xxxxxxxxxx >> ";

                  URL url = new URL(path);

                  HttpURLConnection conn=(HttpURLConnection)url.openConnection();

                  conn.setRequestMethod("GET");

                  InputStream is = conn.getInputStream();

                  DocumentBuilder docBuilder = DocumentBuilderFactory.newInstance().newDocumentBuilder();

                  Document doc = docBuilder.parse(is);

                  Source src= new DOMSource(doc);

                  File file = new File("d:/text.xml");

                  Result rs = new StreamResult(file);

                  TransformerFactory tmf = TransformerFactory.newInstance();

                  Transformer trnsfrmr = tmf.newTransformer();

                  trnsfrmr.transform(src, rs);

                  System.out.println("XML file is created successfully");

                  System.out.println("The root element is :: "+doc.getDocumentElement().getNodeName());

                  NodeList nl=doc.getDocumentElement().getChildNodes();

                  System.out.println("child nodelist length::"+nl.getLength());

                  System.out.println("First child node name :: "+doc.getDocumentElement().getFirstChild().getNodeName());

                  System.out.println("Last child node name :: "+doc.getDocumentElement().getLastChild().getNodeName()); 
```

> 我得到的输出：- XML 文件创建成功根元素是 :: omim child nodelist length::3 第一个子节点名称 :: #text 最后一个子节点名称 :: #text
> 
> 在得到的输出中，根节点是“omim”，它有 3 个子节点。但在尝试打印第一个和最后一个子名称时返回 null。同样getParent()、getChild()、getSibling() 方法对我不起作用。
> 
> 任何帮助将不胜感激。
> 
> 谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T16:41:37.070

（我对[biostar](http://www.biostars.org/post/show/44705/parsing-dom-document-from-omim-restful-web-services/#44715)的回答很腼腆）我目前无法使用 OMIM API，但下面的 java 代码应该可以完成这项工作。我认为您的问题是您假设 XML 节点的第一个子节点是一个 ELEMENT，这是错误的，它似乎是一个包含回车的 TEXT 节点。

```
import java.net.URLEncoder;

import javax.xml.parsers.DocumentBuilder;
import javax.xml.parsers.DocumentBuilderFactory;
import javax.xml.transform.OutputKeys;
import javax.xml.transform.Transformer;
import javax.xml.transform.TransformerFactory;
import javax.xml.transform.dom.DOMSource;
import javax.xml.transform.stream.StreamResult;

import org.w3c.dom.Document;
import org.w3c.dom.Element;
import org.w3c.dom.Node;

public class Biostar44705
    {
    private static final String API_KEY="XXXXXXXX"; 
    private DocumentBuilder builder;
    private Transformer echoTransformer=null;

    private Biostar44705()throws Exception
        {
        DocumentBuilderFactory factory=DocumentBuilderFactory.newInstance();
        factory.setCoalescing(true);
        factory.setIgnoringComments(true);
        factory.setNamespaceAware(false);
        builder=factory.newDocumentBuilder();

        TransformerFactory trf=TransformerFactory.newInstance();
        this.echoTransformer =trf.newTransformer();
        this.echoTransformer .setOutputProperty(OutputKeys.INDENT, "yes");
        this.echoTransformer .setOutputProperty(OutputKeys.OMIT_XML_DECLARATION, "yes");
        }
    void get(int omimId)throws Exception
        {
        String uri="http://api.omim.org:8000/api/clinicalSynopsis?mimNumber="+omimId+
                "&include=clinicalSynopsis&format=xml&apiKey="+
                URLEncoder.encode(API_KEY,"UTF-8");
        Document dom=builder.parse(uri);
        Element root=dom.getDocumentElement();
        if(root==null) return;
        for(Node n1=root.getFirstChild();n1!=null;n1=n1.getNextSibling())
            {
            if(n1.getNodeType()!=Node.ELEMENT_NODE) continue;
            echoTransformer.transform(new DOMSource(n1),new StreamResult(System.out));
            break;
            }
        }
public static void main(String[] args) throws Exception
    {
    new Biostar44705().get(100070);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T13:13:50.947

我发表了评论，然后我想我宁愿在答案中进一步解释。您应该问为什么`root`有 3 个子节点。只有一个孩子`element`-`clinicalSynopsisList`为什么是 3 个？第一个和最后一个孩子是`clinicalSynopsisList`. 您的节点内容被解释为[MIXED](http://www.w3.org/TR/REC-xml/#sec-mixed-content)，因为您没有模式或 DTD 来告诉`omni`只能包含元素的解析。如果你有，[你可以告诉你的解析器](http://docs.oracle.com/javase/1.4.2/docs/api/javax/xml/parsers/DocumentBuilderFactory.html#setIgnoringElementContentWhitespace%28boolean%29)忽略可忽略的[空格](http://www.w3.org/TR/REC-xml/#sec-white-space)，就像[我在我的评论中提到的另一个 SO 问题](https://stackoverflow.com/questions/229310/how-to-ignore-whitespace-while-reading-a-file-to-produce-an-xml-dom)中解释的那样。

自从我直接使用 DOM API 以来已经有一段时间了，但我不相信你可以要求它提供第一个子*元素*。相反，您可以使用 XPath（例如从[这里](http://docs.oracle.com/javase/1.5.0/docs/api/javax/xml/xpath/XPathFactory.html)开始，或者搜索 SO 或 google 以获取示例）来获取您的第一个子元素，或者只是使用 DOM API 遍历子节点并咨询它们的[节点类型](http://docs.oracle.com/javase/1.4.2/docs/api/org/w3c/dom/Node.html#getNodeType%28%29)（您将忽略[文本节点](http://docs.oracle.com/javase/1.4.2/docs/api/org/w3c/dom/Node.html#TEXT_NODE))

而且我还建议查看[Apache CXF和](http://cxf.apache.org/)[JAXB](http://www.oracle.com/technetwork/articles/javase/index-140168.html)等编组技术，这样您就不必使用从 Web 服务端点读取的“原始”XML。

# android - 在我的位置周围画圈

> ID：10551204
> 
> 赞同：2
> 
> 时间：2012-05-11T12:18:43.587
> 
> 标签：android, geolocation, geometry, ondraw

我试图在我的位置周围画一个圆圈。我不确定我做错了什么，但圆圈没有显示：

```
@Override
public void draw(Canvas canvas, MapView mapView, boolean shadow) {
    Projection projection = mapView.getProjection();

    if (shadow == false && location != null) {
        // Get the current location
        Double latitude = location.getLatitude() * 1E6;
        Double longitude = location.getLongitude() * 1E6;
        GeoPoint geoPoint = new GeoPoint(latitude.intValue(),
                longitude.intValue());

        int radius = metersToRadius(100, mapView, latitude);

        // Convert the location to screen pixels
        Point point = new Point();
        projection.toPixels(geoPoint, point);

        // Setup the paint
        Paint paint = new Paint();
        paint.setAntiAlias(true);
        paint.setStrokeWidth(2.0f);

        paint.setColor(0xff6666ff);
        paint.setStyle(Style.STROKE);
        canvas.drawCircle(point.x, point.y, radius, paint);

        paint.setColor(0x186666ff);
        paint.setStyle(Style.FILL);
        canvas.drawCircle(point.x, point.y, radius, paint);
    }
    super.draw(canvas, mapView, shadow);
} 
```

编辑：为了清楚起见，我将发布我的课程：CustomItemizedOverlay

```
public class CustomItemizedOverlay extends ItemizedOverlay<OverlayItem> {

protected final List<OverlayItem> mOverlays = new ArrayList<OverlayItem>();

protected final Context mContext;

public CustomItemizedOverlay(Drawable defaultMarker, Context context) {
    super(boundCenterBottom(defaultMarker));
    this.mContext = context;
}

public void addOverlay(OverlayItem overlay) {
    mOverlays.add(overlay);
    populate();
}

@Override
protected OverlayItem createItem(int i) {
    // TODO Auto-generated method stub
    return mOverlays.get(i);
}

public void removeOverlay(OverlayItem overlay) {
    mOverlays.remove(overlay);
    populate();
}

public void clear() {
    mOverlays.clear();
    populate();
}

@Override
public int size() {
    // TODO Auto-generated method stub
    return mOverlays.size();
}

@Override
protected boolean onTap(int i) {
    OverlayItem itemClicked = this.mOverlays.get(i);

    AlertDialog.Builder builder = new AlertDialog.Builder(this.mContext);

    builder.setTitle(itemClicked.getTitle());
    builder.setMessage(itemClicked.getSnippet());
    builder.setCancelable(true);

    AlertDialog alert = builder.create();
    alert.show();

    return true;
} 
```

和 PCCustomizedOverlay

```
public class PcCustomItemizedOverlay extends CustomItemizedOverlay {

public static int metersToRadius(float meters, MapView map, double latitude) {
    return (int) (map.getProjection().metersToEquatorPixels(meters) * (1 / Math
            .cos(Math.toRadians(latitude))));
}

private Location location;

public PcCustomItemizedOverlay(Drawable defaultMarker, Context context) {
    super(defaultMarker, context);
}

@Override
public void draw(Canvas canvas, MapView mapView, boolean shadow) {
    Projection projection = mapView.getProjection();

    if (shadow == false && location != null) {
        // Get the current location
        Double latitude = location.getLatitude() * 1E6;
        Double longitude = location.getLongitude() * 1E6;
        GeoPoint geoPoint = new GeoPoint(latitude.intValue(),
                longitude.intValue());

        int radius = metersToRadius(40, mapView, latitude);

        // Convert the location to screen pixels
        Point point = new Point();
        projection.toPixels(geoPoint, point);

        // Setup the paint
        Paint paint = new Paint();
        paint.setAntiAlias(true);
        paint.setStrokeWidth(2.0f);

        paint.setColor(0xff6666ff);
        paint.setStyle(Style.STROKE);
        canvas.drawCircle(point.x, point.y, radius, paint);

        paint.setColor(0x186666ff);
        paint.setStyle(Style.FILL);
        canvas.drawCircle(point.x, point.y, radius, paint);
    }
    super.draw(canvas, mapView, shadow);
}

public Location getLocation() {
    return location;
}

public void setLocation(Location location) {
    this.location = location;
} 
```

}

有谁知道问题出在哪里？

非常感谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T12:48:59.447

试试这个代码

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    mapView = (MapView) findViewById(R.id.mapview);
    MapController mc = mapView.getController();
    MyLocationOverlay myLocationOverlay = new MyLocationOverlay(MainMap.this, mapView);
    mapView.getOverlays().add(myLocationOverlay);
    mc.animateTo( new GeoPoint(lat, lng));
    mc.setZoom(15);
    mapView.invalidate();
} 
```

不要忘记添加 overlay.enableMyLocation(); 在 onresume() 和 overlay.disableMyLocation() 中；在暂停

如果你想在你的点周围画圆圈，而不是上面的代码，你可以使用下面的示例代码：

```
Point screenPnts =new Point();
GeoPoint curr_geopoint = new GeoPoint((int)(location.getLatitude()*1E6),(int)(location.getLongitude()*1E6));
mapview.getProjection().toPixels(curr_geopoint, screenPnts);
canvas.drawCircle(screenPnts.x, screenPnts.y, 15, paint); 
```

通过操作 screenPnts.x 和 screenPnts.y 值进行一些试验和错误以围绕该点获得该圆圈。这里 paint 是 Paint 类的对象，用于为圆圈赋予颜色

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T12:45:47.563

我认为你的问题`void draw`。

```
@Override
public void draw(Canvas canvas, MapView mapView, boolean shadow) {
    super.draw(canvas, mapView, shadow);
   Projection projection = mapView.getProjection();

    if (shadow == false && location != null) {
        // Get the current location
        Double latitude = location.getLatitude() * 1E6;
        Double longitude = location.getLongitude() * 1E6;
        GeoPoint geoPoint = new GeoPoint(latitude.intValue(),
                longitude.intValue());

        int radius = metersToRadius(100, mapView, latitude);

        // Convert the location to screen pixels
        Point point = new Point();
        projection.toPixels(geoPoint, point);

        // Setup the paint
        Paint paint = new Paint();
        paint.setAntiAlias(true);
        paint.setStrokeWidth(2.0f);

        paint.setColor(0xff6666ff);
        paint.setStyle(Style.STROKE);
        canvas.drawCircle(point.x, point.y, radius, paint);

        paint.setColor(0x186666ff);
        paint.setStyle(Style.FILL);
        canvas.drawCircle(point.x, point.y, radius, paint);
    }

} 
```

也可以在这里查看将图像放在地图上。[将图像绘制为 mapoverlay](http://www.androidsnippets.com/drawing-an-image-as-a-map-overlay2)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T14:48:58.807

我有类似的问题。

通过覆盖布尔绘制而不是扩展 Overlay 的内部类中的 void one 来解决它。

它看起来像这样：

```
 //inner class MapOverlay
class MapOverlay extends com.google.android.maps.Overlay
{
    @Override
    public boolean draw(Canvas canvas, MapView mapView, boolean shadow, long when) 
    {
        super.draw(canvas, mapView, shadow);                   

        Projection projection = mapView.getProjection();

        //the rest of your code here................

        super.draw(canvas,mapView,shadow);

        return true;
    }
} 
```

构建你的圈子

```
MapOverlay mapOverlayCircle = new MapOverlay(); 
```

并将其添加到您的地图视图中的叠加层。而已。

# asp.net - 在 asp.net 动态数据母版页中忽略链接标记

> ID：10551209
> 
> 赞同：0
> 
> 时间：2012-05-11T12:18:53.457
> 
> 标签：asp.net, asp.net-dynamic-data

我快疯了。Site.master 页面在 head 标记中包含以下行。当项目启动时，我可以在 firebug Net 面板中看到该行被忽略。即使我没有得到 404 not Found 错误；

```
<link href='<%=Page.ResolveUrl("~/NewStyles/ui-lightness/jquery-ui-1.8.20.custom.css")%>' type="text/css" /> 
```

它出什么问题了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T12:27:11.580

尝试使用井号并调用 Page.Header.DataBind

```
<link href='<%# Page.ResolveUrl("~/NewStyles/ui-lightness/jquery-ui-1.8.20.custom.css")%>>' type="text/css" /> 
```

# haskell - 功能实例展示

> ID：10551210
> 
> 赞同：5
> 
> 时间：2012-05-11T12:18:57.700
> 
> 标签：haskell

我目前正在尝试为原始算术函数编写一个小 Show 实例。

目标是制作可显示的功能列表。

非常简单的 show 函数如下所示：

```
 showOp :: (Int -> Int -> Int) -> String
  showOp op
    | op 3 3 == 6 = "plus"
    | op 3 3 == 0 = "minus"
    | op 3 3 == 9 = "times"
    | op 3 3 == 1 = "divide"
    | otherwise = "undefined" 
```

但我无法获得（Int -> Int -> Int）的 Show 实例。我是这样尝试的：

```
 instance Show (Int -> Int -> Int) where
    show op = show "asdf" 
```

但它不起作用。WinHugs 只返回错误

```
 Syntax error in instance head (variable expected) 
```

甚至可以为函数定义 Show 吗？如果是，我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-11T12:40:43.153

不要使用 WinHugs。使用 GHC。

事实上，在最近的 Haskell 平台版本中，已经有一个 Show 函数的实例。

```
Prelude Text.Show.Functions> show (+1)
"<function>"
Prelude Text.Show.Functions> show (\x -> x ++ "foo")
"<function>" 
```

但是，现在，在您的情况下，您需要`-XFlexibleInstances`继续，因为您的实例不是`(Constructor a1 .. an)`a1 .. an 是不同类型变量的形式。

打开它`{-# LANGUAGE FlexibleInstances #-}`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-11T13:00:33.920

（这不是答案（唐的报道），但评论太长了）

代码有很多重复的逻辑（特别`op 3 3 ==`是出现了很多），但是要使这个更清晰：[案例表达式](http://learnyouahaskell.com/syntax-in-functions#case-expressions)。这允许我们计算`op 3 3`一次，然后处理各种情况（与函数定义中的模式匹配完全相同）。

```
showOp op = case op 3 3 of
              6 -> "plus"
              0 -> "minus"
              9 -> "times"
              1 -> "divide"
              _ -> "undefined" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-12T08:05:42.273

你也可以使用拥抱。

`hugs -98 +o`使用or启动 Hugs`runhugs -X-98 +o`并`{-# LANGUAGE FlexibleInstances #-}`在源文件中使用。

# iphone - 连续使用 writeToFile:atomically: 不起作用...为什么？

> ID：10551214
> 
> 赞同：0
> 
> 时间：2012-05-11T12:19:02.163
> 
> 标签：iphone, ios5, writetofile

我正在尝试编写一个 csv 文件。我手头有两个数组 - 一个带有标题（名称、编号等），另一个带有实际值（Jon、123 ...）。

现在，经过以下两个操作：

```
[[titles componentsJoinedByString:@", "] writeToFile:file atomically:YES];

[[values componentsJoinedByString:@", "] writeToFile:file atomically:YES]; 
```

只有值数组被写入文件。我意识到我可能需要再次打开文件，但是在写入第一个数组之后我该怎么做呢？或者，如果不是这种情况，我到底做错了什么？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T12:24:10.777

第二行实际上是覆盖您在第一行中编写的文件。解决此问题的一种简单方法是简单地将第二个字符串附加到第一个字符串（因为您正在制作 csv 文件，因此可能在两者之间添加一个 '\n'）并将该字符串写入您的文件：

```
NSString *str1 = [[titles componentsJoinedByString:@", "];
NSString *str2 = [[values componentsJoinedByString:@", "];
NSString *outputStr = [str1 stringByAppendingFormat:@"\n%@", str2];
[outputStr writeToFile:file atomically:YES]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T13:37:18.787

第二次替换旧内容。因此，您可以读取旧内容，将旧内容附加到新内容中并保存在文件中。

写第一行

```
[[titles componentsJoinedByString:@", "] writeToFile:file atomically:YES]; 
```

每次都需要在哪里添加另一行

```
NSString *previousContent = [[NSString alloc] initWithContentsOfFile:file usedEncoding:nil error:nil];
NSString *str2 = [[values componentsJoinedByString:@", "];
NSString *outputStr = [previousContent stringByAppendingFormat:@"\n%@", str2];
[outputStr writeToFile:file atomically:YES]; 
```

# http - RavenDB 查询多个文档返回 401

> ID：10551219
> 
> 赞同：0
> 
> 时间：2012-05-11T12:19:16.000
> 
> 标签：http, ravendb, fiddler

使用 RavenDB，使用 Fiddler2，我正在尝试请求按 ID 获取多个文档。我在提琴手的 POST 请求如下：

```
url: http://localhost:8080/queries
request body: ['albums/626','albums/631'] 
```

我收到了 401 未授权错误。此操作是否有权限要求？还是我错过了其他东西？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T14:09:43.157

您可能需要对请求进行身份验证，您可以通过在配置文件中将“Raven/AnonymousAccess”设置为“All”来设置 ravendb 接受匿名请求

# xcode - 使用 AppleScript 从 Xcode 4 项目中删除文件

> ID：10551221
> 
> 赞同：2
> 
> 时间：2012-05-11T12:19:22.077
> 
> 标签：xcode, applescript

我有这样的脚本

```
tell application "Xcode"
    tell project 1
        delete file reference 1 of group 1
    end tell
end tell 
```

但结果我有`error "Xcode got an error: AppleEvent handler failed." number -10000`

如何使用 AppleScript 从 Xcode 项目中删除文件？

# android - OpenGL ES 2.0：在 Android 上围绕自身旋转对象

> ID：10551225
> 
> 赞同：3
> 
> 时间：2012-05-11T12:19:44.120
> 
> 标签：android, opengl-es

我正在尝试旋转移动的物体，但它围绕坐标系的中心旋转。如何让它在移动时围绕自身旋转？代码是：

```
Matrix.translateM(mMMatrix, 0, 0, -y, 0);
Matrix.setRotateM(mMMatrix, 0, mAngle, 0, 0, 1.0f);
y += speed;
Matrix.translateM(mMMatrix, 0, 0, y, 0); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T08:23:25.347

不要使用视图矩阵来旋转对象，该矩阵用作所有场景的相机，要转换对象，您应该使用模型矩阵。要围绕自己的中心旋转，可以使用以下方法：

```
public void transform(float[] mModelMatrix) {
    Matrix.setIdentityM(mModelMatrix, 0);
    Matrix.translateM(mModelMatrix, 0, 0, y, 0);
    Matrix.rotateM(mModelMatrix, 0, mAngle, 0.0f, 0.0f, 1.0f); 
} 
```

不要忘记使用单位矩阵来重置每个循环中的转换。

我认为您的代码已磨损。您应该在应用任何转换之前更新“y”的值。

```
public void onDrawFrame(GL10 gl) {
    ...
    y += speed;
    transform(mModelMatrix);
    updateMVP(mModelMatrix, mViewMatrix, mProjectionMatrix, mMVPMatrix);
    renderObject(mMVPMatrix);
    ...
} 
```

updateMVP 方法将结合模型、视图和投影矩阵：

```
private void updateMVP( 
        float[] mModelMatrix, 
        float[] mViewMatrix, 
        float[] mProjectionMatrix,
        float[] mMVPMatrix) {

    // combine the model with the view matrix
    Matrix.multiplyMM(mMVPMatrix, 0, mViewMatrix, 0, mModelMatrix, 0);

    // combine the model-view with the projection matrix
    Matrix.multiplyMM(mMVPMatrix, 0, mProjectionMatrix, 0, mMVPMatrix,   0);
} 
```

最后 render 方法将执行着色器来绘制对象：

```
public void renderObject(float[] mMVPMatrix) {

    GLES20.glUseProgram(mProgram);

    ...

    // Pass the MVP data into the shader
    GLES20.glUniformMatrix4fv(mMVPMatrixHandle, 1, false, mMVPMatrix, 0);

    // Draw the shape
    GLES20.glDrawElements (...);
} 
```

我希望这能帮到您。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-19T06:54:12.613

我只是使用视图矩阵而不是模型矩阵，一切都解决了。有关模型、视图和投影矩阵的详细信息，[请参阅](https://stackoverflow.com/questions/5550620/the-purpose-of-model-view-projection-matrix)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T12:58:22.533

你在哪里绘制对象？

我想是在你在这里放的代码之后，比如：

```
Matrix.translateM(mMMatrix, 0, 0, -y, 0);
Matrix.setRotateM(mMMatrix, 0, mAngle, 0, 0, 1.0f);
y += speed;
Matrix.translateM(mMMatrix, 0, 0, y, 0); 
drawHere();//<<<<<<<<<<<<<<<<<<< 
```

然后，第二个翻译调用就是问题所在。您应该在第二次翻译之前移动您的绘图调用。或者干净的方法是：

```
Matrix.setIdentityM(mMMatrix, 0);//<<<<<<<<added
Matrix.translateM(mMMatrix, 0, 0, -y, 0);
Matrix.setRotateM(mMMatrix, 0, mAngle, 0, 0, 1.0f);
y += speed;
//Matrix.translateM(mMMatrix, 0, 0, y, 0); //<<<<<<<<<removed
drawHere(); 
```

# c# - 创建 MTOM 并对其进行反序列化

> ID：10551228
> 
> 赞同：3
> 
> 时间：2012-05-11T12:20:04.007
> 
> 标签：c#, serialization, deserialization, mtom, xop

我一直在使用一些代码通过使用[MSDN](http://social.msdn.microsoft.com/Forums/is/wcf/thread/7cb0ff86-5fe1-4266-afac-bcb91eaca5ec)中的代码来创建 MTOM 。

似乎有一个错误，我不明白问题出在哪里，因为论坛上的一位用户指出有一个错误。

文件 (JPEG) 数据在反序列化后损坏。下面列出了完整的代码。

```
 public class Post_7cb0ff86_5fe1_4266_afac_bcb91eaca5ec
            {
                [DataContract()]
                public partial class TestAttachment
                {
                    private byte[] fileField;
                    private string filenameField;

                    [DataMember()]
                    public byte[] File
                    {
                        get
                        {
                            return this.fileField;
                        }
                        set
                        {
                            this.fileField = value;
                        }
                    }
                    [DataMember()]
                    public string Filename
                    {
                        get
                        {
                            return this.filenameField;
                        }
                        set
                        {
                            this.filenameField = value;
                        }
                    }
                }
                public static void Test()
                {
                    string Filename = "Image.jpg";
                byte[] file = File.ReadAllBytes(Filename);

                TestAttachment Attachment = new TestAttachment();
                Attachment.Filename = Filename;
                Attachment.File = file;
                MemoryStream MTOMInMemory = new MemoryStream();
                XmlDictionaryWriter TW = XmlDictionaryWriter.CreateMtomWriter(MTOMInMemory, Encoding.UTF8, Int32.MaxValue, "");
                DataContractSerializer DCS = new DataContractSerializer(Attachment.GetType());
                DCS.WriteObject(TW, Attachment);
                TW.Flush();
                Console.WriteLine(Encoding.UTF8.GetString(MTOMInMemory.ToArray()));
                var v = DeserializeMTOMMessage(Encoding.UTF8.GetString(MTOMInMemory.ToArray()));
                File.WriteAllBytes(v.Filename,v.File);
                }

                public static TestAttachment DeserializeMTOMMessage(string MTOMMessage)
                {

                    try
                    {

                        MemoryStream MTOMMessageInMemory = new MemoryStream(UTF8Encoding.UTF8.GetBytes(MTOMMessage));

                        XmlDictionaryReader TR = XmlDictionaryReader.CreateMtomReader(MTOMMessageInMemory, Encoding.UTF8, XmlDictionaryReaderQuotas.Max);

                        DataContractSerializer DCS = new DataContractSerializer(typeof(TestAttachment));

                        return (TestAttachment)DCS.ReadObject(TR);

                    }
                    catch
                    {

                        return null;

                    }

                }
            } 
```

如果有人可以帮助我指出问题所在，我将不胜感激。我是 XOP/MTOM 的新手，发现很难找出错误可能出在哪里。序列化或反序列化。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-20T09:05:05.970

您的代码中有一个错误。更改您的方法调用

```
MTOMInMemory.Position = 0;
DeserializeMTOMMessage(Encoding.UTF8.GetString(MTOMInMemory.ToArray())); 
```

到

```
DeserializeMTOMMessage(MTOMInMemory.ToArray()) 
```

和实施

```
 public static TestAttachment DeserializeMTOMMessage(byte[] MTOMMessage) 
    { 
        try 
        { 
            MemoryStream MTOMMessageInMemory = new MemoryStream(MTOMMessage);
            XmlDictionaryReader TR = XmlDictionaryReader.CreateMtomReader(MTOMMessageInMemory, Encoding.UTF8, XmlDictionaryReaderQuotas.Max); 
            DataContractSerializer DCS = new DataContractSerializer(typeof(TestAttachment)); 
            return (TestAttachment)DCS.ReadObject(TR); 
        } 
        catch
        {

            return null;
        } 
    } 
```

您所做的是从 utf8 到字节数组的双重转换，反之亦然，最终创建的不是您使用的原始字节数组

# c# - 删除被 vshost.exe c# 锁定的图像文件

> ID：10551229
> 
> 赞同：2
> 
> 时间：2012-05-11T12:20:05.297
> 
> 标签：c#, file, sharing, filelock

我有 ac# 应用程序，它以一种形式显示图像。我正在尝试覆盖这些图像并重新生成它们。我在尝试删除现有图像时遇到异常（在这种情况下是 png）。我尝试处理图片框正在使用的图像，然后将其设置为 null，但由于共享冲突，我仍然遇到异常。不过，我可以毫无问题地去资源管理器并删除文件。

在试图找出锁定此图像的进程时，进程监视器告诉我它`vhost.exe`是托管我的应用程序的进程。

我怎样才能解决这个问题？有什么方法可以让主机释放文件的锁定，以便我可以删除/重新创建它？最终，我有大量的图像生成为缩略图，只要我的数据库发生影响图形的更改，就需要更新这些图像。我不想认为我需要调用命令外壳来执行此操作。

感谢您的任何建议。

加里

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T12:25:31.060

您可以尝试使用文件流加载图像并在阅读后关闭它们。

```
FileStream fileStream = new FileStream("ImageName.jpg", FileMode.Open, FileAccess.Read);
yourPictureBox.Image = Image.FromStream(fileStream);
fileStream.Close(); 
```

或者不是显式关闭；您可以使用`using`声明；

```
using(FileStream fileStream = new FileStream("ImageName.jpg", FileMode.Open, FileAccess.Read))
{
    yourPictureBox.Image = Image.FromStream(fileStream);
} 
```

# php - 计算色差

> ID：10551232
> 
> 赞同：5
> 
> 时间：2012-05-11T12:20:20.183
> 
> 标签：php

是否可以根据定义的“中心值”检查某个十六进制颜色是否更接近 FFF 或 000？

我想根据 #888 检查颜色是否更接近 #FFF 或 #000。因此，如果我检查#EFEFEF，它应该返回#FFF，如果我尝试#878787，它应该返回#000。

如何做到这一点？我不知道在 Google 上搜索什么...

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T12:22:46.963

您可以将颜色转换为数字：

```
$color_num = hexdec(substr($color, 1)); // skip the initial # 
```

然后将它们与`0x0`或进行比较`0xffffff`。

您也可以将它们分解为R，G和B并进行三个比较；然后平均它们？不知道你想要这个东西有多精确:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T12:38:06.133

解决问题的最简单方法是使用它们的灰度值计算颜色之间的距离（还有其他方法，但这很简单）。所以像：

```
// returns a distance between two colors by comparing each component
// using average of the RGB components, eg. a grayscale value
function color_distance($a, $b)
{
    $decA = hexdec(substr($a, 1));
    $decB = hexdec(substr($a, 1));
    $avgA = (($decA & 0xFF) + (($decA >> 8) & 0xFF) + (($decA >> 16) & 0xFF)) / 3;
    $avgB = (($decB & 0xFF) + (($decB >> 8) & 0xFF) + (($decB >> 16) & 0xFF)) / 3;
    return abs($avgA - $avgB);
}

// I am going to leave the naming of the function to you ;)
// How this works is that it'll return $minColor if $color is closer to $refColorMin
// and $maxColor if $color is closer to $refColorMax
// all colors should be passed in format #RRGGBB
function foo($color, $refColorMin, $refColorMax, $minColor, $maxColor)
{
    $distMin = color_distance($color, $refColorMin);
    $distMax = color_distance($color, $refColorMax);
    return ($distMin < $distMax) ? $minColor : $maxColor;
}

// Example usage to answer your original question:
$colorA = foo('#EFEFEF', '#888888', '#FFFFFF', '#000000', '#FFFFFF');
$colorA = foo('#898989', '#888888', '#FFFFFF', '#000000', '#FFFFFF');
// Check the values
var_dump($colorA, $colorB); 
```

输出是：

```
string(7) "#FFFFFF"
string(7) "#000000" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-11T12:25:40.260

您可以执行以下操作：

```
function hex2rgb($hex) {
   $hex = str_replace("#", "", $hex);

   if(strlen($hex) == 3) {
      $r = hexdec(substr($hex,0,1).substr($hex,0,1));
      $g = hexdec(substr($hex,1,1).substr($hex,1,1));
      $b = hexdec(substr($hex,2,1).substr($hex,2,1));
   } else {
      $r = hexdec(substr($hex,0,2));
      $g = hexdec(substr($hex,2,2));
      $b = hexdec(substr($hex,4,2));
   }
   $rgb = array($r, $g, $b);
   //return implode(",", $rgb); // returns the rgb values separated by commas
   return $rgb; // returns an array with the rgb values
}

$rgb = hex2rgb("#cc0"); 
```

从中您可以获取 $rgb 的值，看看它们的值是否平均大于或小于 122.5。如果它大于 122.5 你会更接近#FFFFFF，低于 122.5 你会更接近 #000000。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-11T13:22:20.437

感谢大家的帮助！

在我的 startpost 中，我犯了 oezi 提到的一个小错字。对我来说，解决方案是对已接受答案的小修改（由 reko_t 提供）：

```
function color_distance($sColor1, $sColor2)
{
    $decA = hexdec(substr($sColor1, 1));
    $decB = hexdec(substr($sColor2, 1));
    $avgA = (($decA & 0xFF) + (($decA >> 8) & 0xFF) + (($decA >> 16) & 0xFF)) / 3;
    $avgB = (($decB & 0xFF) + (($decB >> 8) & 0xFF) + (($decB >> 16) & 0xFF)) / 3;
    return abs($avgA - $avgB);
}

function determine_color($sInputColor, $sRefColor, $sMinColor, $sMaxColor)
{
    $distRef    = color_distance($sInputColor, $sRefColor);
    $distMin    = color_distance($sInputColor, $sMinColor);
    $distMax    = color_distance($sInputColor, $sMaxColor);

    return $distMax - $distRef <  $distMin - $distRef ? $sMinColor : $sMaxColor;
} 
```

我需要这个函数来确定背景颜色上的文本颜色，可以通过一些设置来设置。谢谢！:) 归功于 reko_t！

# android - Facebook Android SDK 使用 Native FaceBook 应用程序或通过网络浏览器在我的墙上发布（如果 FB 应用程序不存在）

> ID：10551234
> 
> 赞同：1
> 
> 时间：2012-05-11T12:20:28.297
> 
> 标签：android, facebook

我想在可能的应用程序中添加一个按钮，让用户可以输入一些消息并将其发布在他的墙上。我的问题是，如何实现这个场景：

1.  用户输入消息并单击共享按钮。
2.  如果设备上存在 Native FaceBook 应用程序，则会触发它以发布此消息，或先登录并授予权限。
3.  如果设备上不存在 Native FaceBook 应用程序，则会触发 Web 浏览器并将其重定向到 facebook 页面，以便登录并发布消息。（或弹出 WebView 而不是 Web 浏览器应用程序）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T13:00:59.927

这是示例项目链接[https://github.com/facebook/facebook-android-sdk](https://github.com/facebook/facebook-android-sdk)

教程链接是：[http ://blog.doityourselfandroid.com/2011/02/28/30-minute-guide-integrating-facebook-android-application/](http://blog.doityourselfandroid.com/2011/02/28/30-minute-guide-integrating-facebook-android-application/)

# iphone - 播放和停止声音（2 次观看）

> ID：10551239
> 
> 赞同：0
> 
> 时间：2012-05-11T12:20:46.330
> 
> 标签：iphone, ios, xcode, sdk, audio

如何从第一个视图中的按钮播放声音，然后从另一个视图中停止（使用按钮）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T12:41:12.140

首先明确您要停止来自其他视图而不是视图控制器的声音。

如果您想从其他视图停止，则将音频播放器设为您的类对象，并在其他视图的按钮方法中停止它。

如果您想从其他视图控制器停止，请使用委托。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T12:43:41.853

十分简单！首先添加 AVFoundation 框架并实现 AVAudioPlayer。您可以查看有关如何播放音乐/声音的文档和其他堆栈溢出问题。然后使 AVAudioPlayer 成为一个类中的属性。然后声明一个停止声音的方法，通过调用`[audioPlayer stop]`也值得一提的是`[audioPlayer pause] // and [audioPlayer play]`两者都存在。或者，您可以通过另一个类的指向该类本身的指针来调用这些消息。然后在另一个类中，声明一个具有指向另一个类的指针的 IBAction，并向该类发送一条消息，告诉它执行停止方法。很简单，这是一个结构：

1.  在 FirstView 中，声明一个播放音乐的 AVAudioPlayer 属性
2.  在 FirstView 中，声明一个停止方法
3.  实现那个停止方法
4.  使用将页面更改为 SecondView 的 IBAction 方法声明并绘制 UIButton
5.  在 SecondView`viewDidLoad`方法中，添加并绘制一个 UIButton 链接到调用 stop 方法的 IBAction 或者只是调用`[FirstView audioPlayer] stop];`或类似的东西！

记得遵守代表！重要的！

您可以参考 AVAUDIOPLAYER 代码的建议问题！

[iPhone/iPad - 循环播放背景音乐？](https://stackoverflow.com/questions/3631353/iphone-ipad-loop-background-music)

但请记住不要从字面上复制这段代码，记住属性，你显然有参数修改。对不起，如果我听起来太明显了，只是因为你的问题太模糊了，我不知道你是不是一个初学者！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T12:55:26.903

用一个监听自定义通知的类包裹你的播放器。
例如：

```
#define PlayerPlayNotification @"PlayerPlayNotification"
#define PlayerStopNotification @"PlayerStopNotification" 
```

然后每个按钮可以发送所需的通知以开始/停止播放，而无需了解实际播放器或有任何指向它的指针。

# java - 如何解决 EI_EXPOSE_REP2 以及为什么它错了

> ID：10551242
> 
> 赞同：10
> 
> 时间：2012-05-11T12:21:08.737
> 
> 标签：java, date, findbugs

我在我的项目中运行了 FindBugs，并收到以下警告：

> `new foo.pkg.Key(Client, Product, Date, String)`可以通过将外部可变对象存储到`Key.expireDate`MALICIOUS_CODE **EI_EXPOSE_REP2**中来公开内部表示 60 Medium

`Key`是一个实体，它有一个`Date expireDate`, 具有各自的 getter 和 setter，并在构造函数中使用它们。

实际上，我只是返回 a `(Date) dataNascimento.clone()`，并在 setter 中使用相同的策略。

问题（按向后逻辑顺序）：

*   **这是更好的方法吗？**
*   之前的代码有什么问题？
*   为什么这样做是错误的？
*   是因为 Date 是可变类型吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-15T16:10:40.150

我建议`(Date) dataNascimento.clone()`在构造函数中执行您的调用（直接或通过您的设置器）。

是的，FindBugs 会警告您，因为数据是可变的。您可能在 setter 和 getter 中有克隆调用，但您仍然会收到警告，因为您仍然可以更改构造函数中的日期。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-09-29T08:51:21.580

将参数类型更改为不可变的类型`LocalDate`（Java 8）。

好处：之后没有人可以修改这个（不可变的）日期。

### 错误描述

请参阅 Spotbugs 的文档 >**错误描述**： EI2 `EI_EXPOSE_REP2`：[可能通过合并对可变对象的引用来公开内部表示](https://spotbugs.readthedocs.io/en/stable/bugDescriptions.html#ei2-may-expose-internal-representation-by-incorporating-reference-to-mutable-object-ei-expose-rep2)：

> 此代码将对外部可变对象的引用存储到对象的内部表示中。如果实例由不受信任的代码访问，并且对可变对象的未经检查的更改会危及安全性或其他重要属性，则您将需要做一些不同的事情。在许多情况下，存储对象的副本是更好的方法。

[注意：您也可以在FindBugs 的错误描述](http://findbugs.sourceforge.net/bugDescriptions.html)中查找这样的描述。

### 修复：使用不可变的日期对象，例如`LocalDate`

要修复 in 等不可变参数的 FindBugs 问题`new foo.pkg.Key(Client, Product, Date, String)`，请将构造函数更改为接受**不可变**的日期对象，例如：

*   乔达时间[`DateTime`](http://joda-time.sourceforge.net/apidocs/org/joda/time/DateTime.html)：

    > 所有主要的日期时间类都是不可变的（如字符串），并且在创建后无法更改。

*   自 Java 8或 Java 8 *Date & Time API* (JSR 310)[`LocalDate`](https://docs.oracle.com/javase/8/docs/api/java/time/LocalDate.html)的其他不可变版本以来。请参阅 Ben Evans 和 Richard Warburton (2014) 的文章中的新 Time API 概念：[Java SE 8 Date and Time](https://www.oracle.com/technical-resources/articles/java/jf14-date-time.html)： *> 不可变值类。Java 中现有格式化程序的严重弱点之一是它们不是线程安全的。这给开发人员增加了以线程安全的方式使用它们的负担，并在他们的日期处理代码的日常开发中考虑并发问题。新 API 通过确保其所有核心类都是不可变的并表示明确定义的值来避免这个问题。* 

 *```
var today = LocalDate.now();
var key = new Key(client, product, today, "immutable date - can't change")`

// no modification possible:
today.setYear(1988); // no such modifier exists 
```

此外，您的实体类中的构造函数和字段需要针对不变性进行设计，例如：

```
package foo.pkg;

public class Key {
    private LocalDate expiryDate; // now immutable (before: Date)

    // remaining fields omitted

    public Key(Client client, Product product, LocalDate expiryDate, String s) {
       this.expiryDate = expiryDate;

      // remaining initialization omitted
    }

} 
```

### 查看相关问题

*   [Findbugs 与 Java 中 Date 对象的可变性有关的问题](https://stackoverflow.com/questions/7932489/findbugs-issues-with-mutability-of-date-object-in-java)
*   [FindBugs EI_EXPOSE_REP 错误是否只涉及日期？](https://stackoverflow.com/questions/13473155/does-the-findbugs-ei-expose-rep-bug-only-concern-date)*

# vba - 范围内唯一条目的数量，VBA

> ID：10551246
> 
> 赞同：0
> 
> 时间：2012-05-11T12:21:20.850
> 
> 标签：vba, range, unique, duplicate-removal

在尝试实现以下操作时，我总是收到类型不匹配错误或除以零错误：我只想计算一个范围内唯一条目的数量，该范围内的条目是“类”文本：

```
startRow = 3
startColumn = 1
col = "A"
Set topCell = Cells(startRow, startColumn)
Set bottomCell = Cells(Rows.Count, startColumn)
If IsEmpty(bottomCell) Then Set bottomCell = bottomCell.End(xlUp)
Set selectRows = Range(col & topCell.Row & ":" & col & bottomCell.Row)
nRows = WorksheetFunction.CountA(selectRows)

test = WorksheetFunction.SumProduct(WorksheetFunction.IsText(selectRows) / WorksheetFunction.CountIf(selectRows, selectRows)) 
```

我在测试计算中有一个错误，但我不明白。一些帮助非常感谢

非常感谢

BR马丁

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T13:13:10.130

你的第一个问题是`WorksheetFunction.CountIf(selectRows, selectRows)`你`test`计算的一部分。当没有重复时，这将导致除以零错误。在输入工作表时也会发生这种情况，因此您要么需要更改逻辑，要么首先测试这种情况。

我相信您的`Type Mismatch`问题是由`WorksheetFunction.IsText(selectRows)`细分引起的。我无法弄清楚是什么原因造成的，但正如我在评论中提到的那样，我认为该`IsText()`函数在 VBA 中可能不会像在输入单元格时那样占用一个范围。

我可能会以不同的方式解决这个问题。这是我在其他地方找到的一个例子 SO [Count unique values in Excel](https://stackoverflow.com/q/1676068/250725) 这主要有工作表公式，但有一个 VBA 代码的答案，你可能可以适应。

另一种选择是创建一个集合并计算元素的数量

```
Sub CountUnique()
Dim Col As New Collection
Dim i As Integer

On Error Resume Next

For i = 3 To 10
    Col.Add Sheet1.Cells(i, 1).Value, Sheet1.Cells(i, 1).Value
Next

MsgBox Col.Count

On Error GoTo 0
End Sub 
```

# java - Hibernate“未映射”异常

> ID：10551247
> 
> 赞同：7
> 
> 时间：2012-05-11T12:21:23.723
> 
> 标签：java, hibernate

我刚刚遇到了休眠配置的问题。

我得到的 Stacktrace 是：

```
Servlet.service() for servlet jsp threw exception
org.hibernate.hql.ast.QuerySyntaxException: TESTPROJECTBEAN is not mapped [FROM TESTPROJECTBEAN]
at org.hibernate.hql.ast.util.SessionFactoryHelper.requireClassPersister(SessionFactoryHelper.java:181)
at org.hibernate.hql.ast.tree.FromElementFactory.addFromElement(FromElementFactory.java:110)
at org.hibernate.hql.ast.tree.FromClause.addFromElement(FromClause.java:94)
at org.hibernate.hql.ast.HqlSqlWalker.createFromElement(HqlSqlWalker.java:316)
at org.hibernate.hql.antlr.HqlSqlBaseWalker.fromElement(HqlSqlBaseWalker.java:3228)
at org.hibernate.hql.antlr.HqlSqlBaseWalker.fromElementList(HqlSqlBaseWalker.java:3112)
at org.hibernate.hql.antlr.HqlSqlBaseWalker.fromClause(HqlSqlBaseWalker.java:720)
at org.hibernate.hql.antlr.HqlSqlBaseWalker.query(HqlSqlBaseWalker.java:571)
at org.hibernate.hql.antlr.HqlSqlBaseWalker.selectStatement(HqlSqlBaseWalker.java:288)
at org.hibernate.hql.antlr.HqlSqlBaseWalker.statement(HqlSqlBaseWalker.java:231)
at org.hibernate.hql.ast.QueryTranslatorImpl.analyze(QueryTranslatorImpl.java:254)
at org.hibernate.hql.ast.QueryTranslatorImpl.doCompile(QueryTranslatorImpl.java:185)
at org.hibernate.hql.ast.QueryTranslatorImpl.compile(QueryTranslatorImpl.java:136)
at org.hibernate.engine.query.HQLQueryPlan.<init>(HQLQueryPlan.java:101)
at org.hibernate.engine.query.HQLQueryPlan.<init>(HQLQueryPlan.java:80)
at org.hibernate.engine.query.QueryPlanCache.getHQLQueryPlan(QueryPlanCache.java:94)
at org.hibernate.impl.AbstractSessionImpl.getHQLQueryPlan(AbstractSessionImpl.java:156)
at org.hibernate.impl.AbstractSessionImpl.createQuery(AbstractSessionImpl.java:135)
at org.hibernate.impl.SessionImpl.createQuery(SessionImpl.java:1651)
at projectConfiguration.ITBProjectDetails.loadProjectList(ITBProjectDetails.java:21)
at org.apache.jsp.WEB_002dINF.jsp.home.projectConfigurationHome_jsp._jspService(projectConfigurationHome_jsp.java:103)
at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:377)
at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)
at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
at com.opensymphony.module.sitemesh.filter.PageFilter.parsePage(PageFilter.java:127)
at com.opensymphony.module.sitemesh.filter.PageFilter.doFilter(PageFilter.java:56)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:646)
at org.apache.catalina.core.ApplicationDispatcher.processRequest(ApplicationDispatcher.java:436)
at org.apache.catalina.core.ApplicationDispatcher.doForward(ApplicationDispatcher.java:374)
at org.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:302)
at org.springframework.web.servlet.view.InternalResourceView.renderMergedOutputModel(InternalResourceView.java:236)
at org.springframework.web.servlet.view.AbstractView.render(AbstractView.java:257)
at org.springframework.webflow.mvc.servlet.ServletMvcView.doRender(ServletMvcView.java:50)
at org.springframework.webflow.mvc.view.AbstractMvcView.render(AbstractMvcView.java:179)
at org.springframework.webflow.engine.ViewState.render(ViewState.java:282)
at org.springframework.webflow.engine.ViewState.doEnter(ViewState.java:186)
at org.springframework.webflow.engine.State.enter(State.java:194)
at org.springframework.webflow.engine.Flow.start(Flow.java:535)
at org.springframework.webflow.engine.impl.FlowExecutionImpl.start(FlowExecutionImpl.java:364)
at org.springframework.webflow.engine.impl.FlowExecutionImpl.start(FlowExecutionImpl.java:222)
at org.springframework.webflow.executor.FlowExecutorImpl.launchExecution(FlowExecutorImpl.java:140)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
at java.lang.reflect.Method.invoke(Method.java:601)
at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:307)
at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:182)
at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:149)
at org.springframework.security.intercept.method.aopalliance.MethodSecurityInterceptor.invoke(MethodSecurityInterceptor.java:66)
at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:171)
at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:204)
at $Proxy37.launchExecution(Unknown Source)
at org.springframework.webflow.mvc.servlet.FlowHandlerAdapter.handle(FlowHandlerAdapter.java:193)
at org.springframework.webflow.mvc.servlet.FlowController.handleRequest(FlowController.java:174)
at org.springframework.web.servlet.mvc.SimpleControllerHandlerAdapter.handle(SimpleControllerHandlerAdapter.java:48)
at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:875)
at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:807)
at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:571)
at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:501)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:617)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
at com.jaspersoft.jasperserver.war.common.UploadMultipartFilter.doFilter(UploadMultipartFilter.java:83)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
at org.springframework.security.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:378)
at com.jaspersoft.jasperserver.war.security.JSSwitchUserProcessingFilter.doFilterHttp(JSSwitchUserProcessingFilter.java:146)
at org.springframework.security.ui.SpringSecurityFilter.doFilter(SpringSecurityFilter.java:53)
at org.springframework.security.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:390)
at org.springframework.security.intercept.web.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:109)
at org.springframework.security.intercept.web.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:83)
at org.springframework.security.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:390)
at org.springframework.security.ui.ExceptionTranslationFilter.doFilterHttp(ExceptionTranslationFilter.java:101)
at org.springframework.security.ui.SpringSecurityFilter.doFilter(SpringSecurityFilter.java:53)
at org.springframework.security.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:390)
at com.jaspersoft.ji.license.JILicenseFilter.doFilter(JILicenseFilter.java:92)
at org.springframework.security.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:390)
at org.springframework.security.providers.anonymous.AnonymousProcessingFilter.doFilterHttp(AnonymousProcessingFilter.java:105)
at org.springframework.security.ui.SpringSecurityFilter.doFilter(SpringSecurityFilter.java:53)
at org.springframework.security.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:390)
at com.jaspersoft.jasperserver.api.metadata.user.service.impl.MetadataAuthenticationProcessingFilter.doFilter(MetadataAuthenticationProcessingFilter.java:139)
at org.springframework.security.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:390)
at com.jaspersoft.jasperserver.war.util.RequestParameterAuthenticationFilter.doFilter(RequestParameterAuthenticationFilter.java:97)
at org.springframework.security.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:390)
at com.jaspersoft.jasperserver.multipleTenancy.MTBasicProcessingFilter.doFilterHttp(MTBasicProcessingFilter.java:180)
at org.springframework.security.ui.SpringSecurityFilter.doFilter(SpringSecurityFilter.java:53)
at org.springframework.security.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:390)
at com.jaspersoft.jasperserver.war.UserPreferencesFilter.doFilter(UserPreferencesFilter.java:175)
at org.springframework.security.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:390)
at org.springframework.security.ui.AbstractProcessingFilter.doFilterHttp(AbstractProcessingFilter.java:277)
at org.springframework.security.ui.SpringSecurityFilter.doFilter(SpringSecurityFilter.java:53)
at org.springframework.security.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:390)
at com.jaspersoft.jasperserver.war.UserPreferencesFilter.doFilter(UserPreferencesFilter.java:175)
at org.springframework.security.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:390)
at com.jaspersoft.jasperserver.api.logging.filter.BasicLoggingFilter.doFilter(BasicLoggingFilter.java:53)
at org.springframework.security.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:390)
at org.springframework.security.context.HttpSessionContextIntegrationFilter.doFilterHttp(HttpSessionContextIntegrationFilter.java:235)
at org.springframework.security.ui.SpringSecurityFilter.doFilter(SpringSecurityFilter.java:53)
at org.springframework.security.util.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:390)
at org.springframework.security.util.FilterChainProxy.doFilter(FilterChainProxy.java:175)
at org.springframework.security.util.FilterToBeanProxy.doFilter(FilterToBeanProxy.java:99)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
at com.jaspersoft.jasperserver.war.util.CharacterEncodingFilter.doFilter(CharacterEncodingFilter.java:67)
at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:236)
at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:167)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)
at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)
at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:558)
at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)
at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)
at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:298)
at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:852)
at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:588)
at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)
at java.lang.Thread.run(Thread.java:722) 
```

我通过以下方式在托管 bean 中调用它：

```
public void loadProjectList()
{
Session session = SessionHandler.getSessionFactory().openSession();
session.beginTransaction();
List list = session.createQuery("FROM TESTPROJECTBEAN").list();
iTBProjectList = (ProjectDetails[]) list.toArray(new ProjectDetails[0]);
session.getTransaction().commit();
session.close();
fillLists();
} 
```

“ProjectDetails”类：包projectConfiguration；

```
import javax.persistence.*;

@Entity
@Table (name="TESTPROJECTBEAN")
public class ProjectDetails {
    @Id
    @GeneratedValue
    @Column (name="PK")
    private Integer projectId;

    @Column (nullable=false, name="PROJNAME")
    private String projectName;

    public Integer getProjectId() {
        return projectId;
    }

    public void setProjectId(Integer projectId) {
        this.projectId = projectId;
    }

    public String getProjectName() {
        return projectName;
    }

    public void setProjectName(String projectName) {
        this.projectName = projectName;
    }
} 
```

我的hibernate.cfg.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE hibernate-configuration PUBLIC "-//Hibernate/Hibernate Configuration DTD     3.0//EN" "http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd">
<hibernate-configuration>
<session-factory>
<property name="hibernate.dialect">org.hibernate.dialect.OracleDialect</property>
<property name="hibernate.connection.driver_class">oracle.jdbc.OracleDriver</property>
<property name="hibernate.connection.url">jdbc:oracle:thin:@localhost:1521:XE</property>
<property name="hibernate.connection.username">testbench</property>
<property name="hibernate.connection.password">testbench</property>
<property name="hibernate.hbm2ddl.auto">update</property>
<mapping class="projectConfiguration.ProjectDetails"/>
</session-factory>
</hibernate-configuration> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-11T12:32:28.447

它应该是

```
List list = session.createQuery("FROM ProjectDetails").list(); 
```

在 Hibernate（更具体地说，在 HQL 中）类和对象很重要（ProjectDetails），而不是表（TESTPROJECTBEAN）。

# c++ - 来自其他 c++ 文件的访问方法

> ID：10551248
> 
> 赞同：0
> 
> 时间：2012-05-11T12:21:25.780
> 
> 标签：c++, header, include

我已经为主要功能和菜单功能实现了客户、DVD、收据、类和 2 个文件，我包含了所有 .h 文件，但是当我使用菜单功能中的一个功能时，它不起作用，并说功能不是定义。我想在一个单独的 .cpp 文件中编写它，该文件称为 main ，它是我的应用程序的驱动程序。

这是我的代码：

```
#ifndef CUSTOMER_H
#include "Customer.h"
#endif

#ifndef DVD_H
#include "DVD.h"
#endif

#ifndef MAIN_FUNC_H
#include "MainFunctions.h"
#endif

#ifndef MENU_FUNC_H
#include "MenuFunctions.h"
#endif

#ifndef RECEIPT_H
#include "Receipt.h"
#endif

using namespace std;

int main () {
    intro();

    return 0;
} 
```

错误是：

> 错误 1 ​​错误 C2129：静态函数 'void intro(void)' 已声明但未定义 c:\program files (x86)\microsoft visual studio 10.0\vc\include\xmemory 186 1 DVD_App

即使该函数`intro()`在`MenuFunctions.h`文件中定义，并在`MenuFunctions.cpp`

注意：这 2 个文件，MenuFunctions 和 MainFunctions 中没有类，只是静态函数

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T12:31:51.310

如果您使用`static`（注意 - 功能，而不是方法）标记函数，则它意味着编译单元（.cpp 文件）的“本地”。所以它需要在那里声明和定义，并且在其他 cpp 文件中不可见。因此，删除静态意味着可以跨编译单元访问该函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T12:26:54.207

您没有编译 MenuFunctions.cpp，以便编译器知道它需要实现代码的 intro() 的定义。检查你的makefile是否有，如果没有，在main()之前包含MenuFunctions.cpp，或者将MenuFunctions.cpp也指定给编译器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T12:27:51.837

确保**MenuFunctions.cpp**文件有

```
#include "MenuFunctions.h" 
```

在它的开始。该错误表明它已声明，但未定义。维护`#include "MenuFunctions.h"`防止双重包含。

# xcode - 使用多点触控拖动两个图像

> ID：10551251
> 
> 赞同：0
> 
> 时间：2012-05-11T12:21:33.367
> 
> 标签：xcode, image, drag, touches, multi-touch

我对触摸事件还很陌生，但我遇到了问题。我使用上面的代码在屏幕上拖动两个图像。但是，当第二根手指触摸屏幕时，代码会起作用，第一个动作就会停止。因此，问题与多点触控有关。我也是，不知道如何计算第二个触摸坐标。我在视图和两个图像中都启用了多点触控。如果有人可以帮助我用每根手指移动每张图像，我会非常满意。提前致谢！

```
-(void) touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event {
UITouch *touch = [[event allTouches] anyObject];
CGPoint location = [touch locationInView:self.view];
if ([touch view] == image) {
    image.center = location;
} else if ([touch view] == image2) {
    image2.center = location;
}}

-(void) touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event {
[self touchesBegan:touches withEvent:event];} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T12:24:40.193

我建议为此使用自定义[UIGestureRecognizer](http://developer.apple.com/library/ios/#DOCUMENTATION/UIKit/Reference/UIGestureRecognizer_Class/Reference/Reference.html)。它将为您提供一种很好的封装方式来管理您想要的内容。同时拖动两个图像本质上是一种手势。

# android - 使用 OnTouchListener 和 OnLongClickListener 相互干扰

> ID：10551261
> 
> 赞同：4
> 
> 时间：2012-05-11T12:22:29.203
> 
> 标签：android, ontouchlistener, onlongclicklistener

我有这个使用 onclicklistener 和 onlongclicklistener 的按钮，还有一个使用 ontouchlistener 的按钮......

关键是按钮 1 按下了 0,1 秒，按钮 2 按下了 2 秒，按钮 3 可以按下 50 秒甚至更长时间......但是按钮 3 被视为长按而不是在 5 秒后释放时触摸，所以它不会触发我的动作

我用了：

```
 MainActivity extends Activity implements View.OnClickListener,
        View.OnLongClickListener, View.OnTouchListener {

    button1.setOnClickListener(this);
    button2.setOnLongClickListener(this);
    button3.setOnTouchListener(this);

    public boolean onTouch(View v, MotionEvent event) {
    switch (v.getId()) {
    case R.id.button3:
         if(event.getAction() == MotionEvent.ACTION_DOWN) {
             DoTest1();
            } else if (event.getAction() == MotionEvent.ACTION_UP) {
             DoTest2();
                }
        break;
    }
    return false;
} 
```

当我删除 onlongclicklistener 它工作正常..

有任何想法吗？

谢谢你的支持！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-12T04:30:10.893

您可以`View.setLongClickable(false)`在按钮 3 上使用。

# javascript - 是否可以将简单的 html 和 javascript 文件结构上传到 heroku？

> ID：10551273
> 
> 赞同：85
> 
> 时间：2012-05-11T12:23:16.817
> 
> 标签：javascript, heroku

我正在尝试将我的一个开源项目部署到heroku，它必须非常简单，只需要静态html和javascript。但他们不支持静态网站吗？如果我不打算使用除 html 和 javascript 之外的任何东西，我宁愿不让它成为 Sinatra 项目。

```
~/sites/d4-site $ heroku create --stack cedar
Creating quiet-ice-4769... done, stack is cedar
http://quiet-ice-4769.herokuapp.com/ | git@heroku.com:quiet-ice-4769.git
Git remote heroku added

~/sites/d4-site $ git remote -v
heroku  git@heroku.com:quiet-ice-4769.git (fetch)
heroku  git@heroku.com:quiet-ice-4769.git (push)

~/sites/d4-site $ git push heroku master
Counting objects: 53, done.
Delta compression using up to 2 threads.
Compressing objects: 100% (49/49), done.
Writing objects: 100% (53/53), 206.08 KiB, done.
Total 53 (delta 4), reused 0 (delta 0)

-----> Heroku receiving push
-----> Removing .DS_Store files
 !     Heroku push rejected, no Cedar-supported app detected 
```

* * *

## 回答 #1

> 赞同：215
> 
> 时间：2013-07-08T16:46:03.797

一种简单的方法是将 HTML 应用程序伪装成 PHP 应用程序。Heroku 正确识别 PHP 应用程序。

1.  将 index.html 文件重命名为 home.html。
2.  创建一个 index.php 文件并包含您的条目 html 文件。如果您的 HTML 条目文件按照建议命名为 home.html，则您的 index.php 应如下所示：

    `<?php include_once("home.html"); ?>`

3.  在您从中推送的机器上的命令行中，键入：

    `git add .
    git commit -m 'your commit message'
    git push heroku master`

Heroku 现在应该正确地将您的应用检测为 php 应用：

```
-----> PHP app detected
-----> Bundling Apache version 2.2.22
-----> Bundling PHP version 5.3.10
-----> Discovering process types
       Procfile declares types -> (none)
       Default types for PHP   -> web

-----> Compiled slug size: 9.9MB
-----> Launching... done, v3
... 
```

非常感谢 lemiffe 的博客文章： http: [//www.lemiffe.com/how-to-deploy-a-static-page-to-heroku-the-easy-way/](http://www.lemiffe.com/how-to-deploy-a-static-page-to-heroku-the-easy-way/)

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2016-10-14T20:36:13.680

这是一个更优雅的方法：只需添加一个名为的文件`package.json`，它告诉 Heroku 使用[harp](https://harpjs.com/)作为您的服务器：

```
{
  "name": "my-static-site",
  "version": "1.0.0",
  "description": "This will load any static html site",
  "scripts": {
    "start": "harp server --port $PORT"
  },
  "dependencies": {
    "harp": "*"
  }
} 
```

然后部署到 Heroku。完毕！

更多信息：[https ://harpjs.com/docs/deployment/heroku](https://harpjs.com/docs/deployment/heroku)

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2012-05-11T12:36:11.700

您可以使用机架来执行此操作：

[https://devcenter.heroku.com/articles/static-sites-on-heroku](https://devcenter.heroku.com/articles/static-sites-on-heroku)

或者您可以使用使用 sinatra 的 Octopress/Jekyll 之类的东西。

但是您需要一个最小堆栈来提供 html 静态内容

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2015-10-29T12:18:45.983

这对我有用：

```
cd myProject 
git init
heroku create myApp 
heroku git:remote -a myApp 
```

如果入口点是`main.html`，请`index.php`使用以下单行内容创建：

```
<?php include_once("main.html"); ?> 
```

然后执行以下步骤：

```
echo '{}' > composer.json 
git add . 
git commit -am "first commit" 
git push heroku master 
```

转到[http://myApp.herokuapp.com/](http://myApp.herokuapp.com/)，您的应用程序现在应该在线了。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2016-08-05T04:49:17.823

有一种更简单的方法可以做到这一点，以防万一有人发现其他答案难以理解。

假设您的静态网站的根目录位于`index.html`. 现在你想把它部署到 Heroku，怎么做？

```
# initialise a git repo
git init

# add the files
git add -A

# commit the files
git commit -m "init commit"

# Now add two files at the root, composer.json and index.php
touch composer.json
touch index.php

# add this line to index.php, making a PHP app that simply displays index.html
<?php include_once("index.html"); ?>

# add an empty object to composer.json
{} 
```

现在只需运行`git push heroku master`，你就完成了！

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-04-15T13:14:51.147

我知道这可能有点旧，但我最终使用 Vienna Gemw 来部署它，基本上它是一个小型 Rack 应用程序，它可以让你只用几行就可以提供公共文件夹中的所有内容（css、图像、js、html）红宝石：

```
require 'vienna'
run Vienna 
```

此外，要在 heroku 上部署它，您需要创建一个 Gemfile：

```
source 'https://rubygems.org'
gem 'rack'
gem 'vienna' 
```

然后运行 ​​bundle install，以防你没有安装 bundle gem，只需在你的终端上运行：

```
sudo gem install bundle 
```

差不多就是这样，您可以了解更多信息： http: [//kmikael.com/2013/05/28/creating-static-sites-in-ruby-with-rack/](http://kmikael.com/2013/05/28/creating-static-sites-in-ruby-with-rack/)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2019-01-09T08:08:01.280

按照这个步骤

**第1步**

类型`touch composer.json index.php index.html`

**第 2 步** 中的 index.php 类型：

```
<?php include_once("index.html"); ?> 
```

在 composer.json 中输入 {}

**第 3 步**

```
git add .

git commit -m "[your message]"

git push ['yourrepo'] ['yourbranch'] 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2020-07-03T22:14:11.517

2020 年更新：

如果您得到一个带有此处提到的 PHP 答案的空白页面，请尝试此操作 - 如果您的主页位于`index.html`：

```
echo '<?php header( 'Location: /index.html' ) ;  ?>' > index.php
echo '{}' > composer.json 
```

添加文件后创建 Git 存储库并提交：

```
git init
git add .
git commit -m "My site ready for deployment." 
```

Heroku 部署 -

```
heroku login
heroku apps:create my-static-site-example
git push heroku master 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-05-11T12:44:53.700

嗯...... heroku 拒绝该应用程序的一个原因可能是它试图在我认为的 rails 3.1.x 应用程序中检测资产管道。

为什么不通过运行在默认堆栈**Bamboo上创建您的应用程序**

```
heroku create 
```

然后，您的所有 js 和 css 都可以进入 rails 应用程序中的公用文件夹，并停用资产管道。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-03-29T05:56:29.963

好吧，每当您的网页包含 HTML、CSS 和 JavaScript 时，只需执行 2 个步骤：

1) 将一个文件命名为 index.html（保留所有内容）例如：脚本、样式表和正文。

2）现在，更改这些文件，复制并粘贴这些相同的文件，但将域更改为 index.php

然后部署在 Heroku 上。

因此，此方法将帮助您部署您的网页

# java - github存储库之间的库（jar）依赖关系

> ID：10551280
> 
> 赞同：1
> 
> 时间：2012-05-11T12:23:39.683
> 
> 标签：java, git, jar, github

我想不出一种合适的方式来构建 git 存储库以处理 git 存储库之间的库依赖关系。我有许多 Java 项目依赖于另一个经常更新的项目，这些项目作为 .jar 库包含在其中。我现在想将它们全部迁移到 github。

我可以在 github 中设置项目，以便每当我推送项目 A 时，所有其他项目都可以自动拉新版本的 projectA.jar 吗？他们不依赖任何源文件，他们只需要最新的库 jar。目前它是由一个 ant 脚本完成的，该脚本试图在每次构建时从另一个项目中复制最新的 jar。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-30T22:14:23.797

将您的项目更改为 Maven 可能会有很大帮助；.jar 文件将不再存储在版本控制中。

您需要打开项目 A，运行“mvn install”以在您的 PC 上生成库文件，然后您可以使用项目 B 中的项目 A 的库。

另一种选择是运行您自己的 Maven 工件服务器，例如 Artifactory、Nexus 等。项目 B 将查看工件服务器以查看项目 A 的文件是否可用。

# asp.net - 如何创建表名 (FROM) 和列名 (SELECT) 可变的 LINQ 语句？

> ID：10551286
> 
> 赞同：0
> 
> 时间：2012-05-11T12:24:05.973
> 
> 标签：asp.net, sql-server, vb.net, linq-to-sql, webforms

在我的编程任务中，我走上了一条黑暗的小巷，但愿我没有，但现在没有回头路了。

我正在构建一个 SQL 语句，其中从查询字符串参数中检索表名、列名和 id 值，即`("SELECT [{0}] FROM [{1}] WHERE [Id] = {2};", c, t, id)`

但它并不像看起来那么糟糕，我受到保护：

*   只有经过身份验证的用户（即登录用户）才能执行`Page_Load`
*   我正在检查表和列是否都存在（使用`GetSchema`等）
*   我正在检查 Id 是否是一个整数
*   我所有的表都有 Id 列
*   数据库连接相当安全

字段值应为 NVARCHAR(4000) 或 NVARCHAR(MAX) 类型，因此我避免使用`ExecuteScalar`LINQ `ExecuteQuery`，因为我喜欢 LINQ。但我又有点超出我的深度了。

我已经做到了这一点：

```
 Dim db As New MyDataContext

    Dim result = db.ExecuteQuery(Of ITable)("SELECT [{0}] FROM [{1}] WHERE [Id] = {2};", c, t, id) 
```

*   这是正确的方法吗？
*   如何获得第一行和第一列的值？
*   有更好的选择吗？

PS 这是一个 SQL Server 2005 数据库

任何帮助表示赞赏。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T18:20:47.427

SQL Server 要求表和列是静态已知的。您不能使用命令参数提供它们。你不能说

```
select * from @tableName 
```

因为表名不能是变量。

您需要使用 C# 构建 SQL 字符串，以确保正确转义标识符。转义是这样的：

```
var escaped = "[" + rawUntrustedUserInput.Replace("]", "]]") + "]"; 
```

这是安全的。

# haskell - 如何在不使用混合列表的情况下实现此功能？

> ID：10551290
> 
> 赞同：3
> 
> 时间：2012-05-11T12:24:41.557
> 
> 标签：haskell, types, existential-type

假设我有一个函数，它采用函数列表对的列表，并将每对中的函数映射到对中的列表上，例如：

```
myFunction [("SOME"++,["DAY","ONE"]), (show,[1,2])] == [["SOMEDAY", "SOMEONE"],["1","2"]] 
```

有没有办法实现 myFunction 以便我上面提供的代码无需任何修改就可以正常工作？

我的问题是我不知道如何实现 myFunction 因为每个子列表的类型可能不同（在我的示例中，我有一个字符串列表 ["DAY", ONE"] 和一个数字列表：[ 1,2]). 我知道列表中的每个函数都会将其列表转换为字符串列表（因此最终列表将具有 [[Char]] 类型），但我不知道如何在 Haskell 中表达这一点.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T12:54:17.917

您可以使用存在类型来做到这一点

```
{-# LANGUAGE ExistentialQuantification #-}

data T = forall a b. Show b => (:?:) (a -> b) [a]

table =
    [ ("SOME"++) :?: ["DAY","ONE"]
    , (show)     :?: [1,2]
    , (+1)       :?: [2.9, pi]
    ] 
```

并将其运行为：

```
apply :: T -> String
apply (f :?: xs) = show $ map f xs

main = print $ map apply table 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T12:57:29.897

您想使用*存在量化*来定义一个可以保存任何值的类型，只要它是类型类的成员`Show`。例如：

```
{-# LANGUAGE ExistentialQuantification #-}

data S = forall a. Show a => S a

instance Show S where
    show (S s) = show s

f :: [S] -> [String]
f xs = map show xs 
```

现在在 ghci 中：

```
*Main> f [S 1, S True, S 'c']
["1","True","'c'"] 
```

您将无法在不修改的情况下运行您的问题中的代码，因为它包含一个异构列表，这是 Haskell 类型系统所禁止的。相反，您可以将异构类型包装为变体类型（如果您事先知道将需要的所有类型）或作为存在量化类型（如果您不知道需要哪些类型，但您确实知道一个属性他们必须满足）。

# sql - 一次撤销多个用户的 Oracle 权限

> ID：10551291
> 
> 赞同：4
> 
> 时间：2012-05-11T12:24:41.943
> 
> 标签：sql, oracle

我们正在合理化我们的数据库用户权限，为此我们希望撤销授予所有用户（但不是特定角色）的架构中所有表的所有选择权限。

使用一些正则表达式，我尝试`revoke`为每个表创建一个通用表达式，例如：

> 从 USER1、USER2、USER3... 撤销对 TABLE1 的选择；
> 
> 从 USER1、USER2、USER3... 撤销对 TABLE2 的选择；

但是，由于并非所有用户都被授予对所有表的权限，这会导致 oracle 错误：

`01927\. 00000 - "cannot REVOKE privileges you did not grant"`

这是有道理的，但没有帮助。

* * *

我还尝试使用`All_Tab_Privs`获取所有表的列表，其中包含要撤销的必要授权，这很有效，但我看不出如何轻松地从中获得实际撤销权限。

`SELECT * From All_Tab_Privs where grantor = 'GRANTING_USER' and grantee != 'READROLE' and grantee != 'PUBLIC' and grantee != 'SYS';`

关于如何在电子表格中花费数小时而不用花费数小时来做到这一点的任何建议？我猜是一些 PL/SQL？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T12:32:42.263

此类作业的一般模式是使用隐式游标返回所需的数据，然后构建 DDL 并执行它们。

```
begin
  for x in (select attribute_1, attribute_2 ... from ... where ...)
  loop
    execute immediate 'REVOKE ...'||x.attribute1||' etc';
  end loop;
end;
/ 
```

一个不错的选择是在 SELECT 中构建您想要执行的 SQL，然后执行它。它更容易测试，但 SQL 看起来有点笨拙。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-06-03T15:17:31.383

```
-- Revoke Privs Granted to Users
BEGIN
  FOR r IN (SELECT * FROM all_tab_privs WHERE grantee IN ('USER_1', 'USER_2'))
    LOOP
      EXECUTE IMMEDIATE 'REVOKE '||r.privilege||' ON '||r.table_name||' FROM '||r.grantee;
    END LOOP;
END;
/ 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-11T12:33:25.133

一些 PL/SQL 和动态 SQL：

```
begin
    for r in (SELECT * From All_Tab_Privs 
              where grantor = 'GRANTING_USER' 
              and grantee != 'READROLE' 
              and grantee != 'PUBLIC' 
              and grantee != 'SYS')
     loop
        execute immediate 'revoke '||r.privilege||' from '||r.grantee;
    end loop;
end; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-02-17T09:01:59.777

我的数据库有一个非常有趣的情况。Oracle 自己的[SQL Developer](http://www.oracle.com/technetwork/developer-tools/sql-developer/overview/index-097090.html)仍然列出了每个表的现有授权，尽管它们已从`all_tab_privs`表中消失（*SELECT*没有为搜索的被授权*者*带来任何结果）。

我已经通过使用以下构造解决了这个问题：

```
BEGIN
  FOR r IN (SELECT owner, table_name FROM dba_tables WHERE owner IN ('owner1', 'owner2'))
    LOOP
      EXECUTE IMMEDIATE 'REVOKE ALL ON '||r.owner||'.'||r.table_name||' FROM grantee1, grantee2';
    END LOOP;
END;
/ 
```

这首先从某些所有者的每个表中选择所有所有者和表名。然后它撤销对某些受赠者的*所有*赠款。

好消息是，如果所选表之一的列出的受让人之一没有任何赠款，这不会失败。

请注意，这应该从管理员帐户执行，例如*system*，因此当前用户有权撤销对另一个用户的表的授权。

# google-sites - 外部脚本谷歌网站可视化

> ID：10551292
> 
> 赞同：1
> 
> 时间：2012-05-11T12:24:49.870
> 
> 标签：google-sites

我有一个谷歌网站。我想使用外部脚本使谷歌可视化在我的网站上工作：

这是出错的脚本。

```
<html>
  <head>
    <script type="text/javascript" src="https://www.google.com/jsapi"></script>
    <script type="text/javascript">
      google.load("visualization", "1", {packages:["corechart"]});
      google.setOnLoadCallback(drawChart);
      function drawChart() {
        var data = google.visualization.arrayToDataTable([
          ['Year', 'Sales', 'Expenses'],
          ['2004',  1000,      400],
          ['2005',  1170,      460],
          ['2006',  660,       1120],
          ['2007',  1030,      540]
        ]);

        var options = {
          title: 'Company Performance',
          hAxis: {title: 'Year', titleTextStyle: {color: 'red'}}
        };

        var chart = new google.visualization.ColumnChart(document.getElementById('chart_div'));
        chart.draw(data, options);
      }
    </script>
  </head>
  <body>
    <div id="chart_div" style="width: 900px; height: 500px;"></div>
  </body>
</html> 
```

我通过 htmlbox 添加了此脚本，但出现错误： **1+13 - 42: failed to load external url jsapi**

为什么它不会加载jsapi？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-24T07:24:34.217

据我所知，您无法在 HTML Box 小工具中加载外部站点/页面（甚至是谷歌页面）。
为此，您可以在 Google 小工具编辑器中创建自定义小工具（使用您的 gmail 帐户），方法是访问以下 URL：
  [http://www.google.com/ig/ifr? url=gge.xml](http://www.google.com/ig/ifr?url=gge.xml)

您可以将上面的代码放在那里并保存，您将通过右键单击并复制右侧文件名中的链接来获取 url。然后，在您的 google 站点页面中，
  编辑页面 --> 插入 --> 更多小工具 -- > 通过 URL 添加小工具 --> 粘贴上面复制的 URL 并保存。

# c# - 每秒从不同线程更新列表视图

> ID：10551296
> 
> 赞同：2
> 
> 时间：2012-05-11T12:25:02.143
> 
> 标签：c#, multithreading, listview

我正在从不同的线程更新我的 listView 中的“计时器”字段。它工作正常，问题只是它闪烁。这是每个线程在需要更新时（几乎每秒）调用的代码。

```
 private void AddToListView(string user, string status, string proxy, int number)
    {
        Invoke(new MethodInvoker(
                       delegate
                       {

                                listView1.BeginUpdate();
                                this.listView1.Items[number].SubItems[1].Text = status;
                                listView1.EndUpdate();

                       }
                       ));
    } 
```

谷歌了一下，我什至不确定我能不能让这个闪烁消失？：/

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T12:47:50.757

我不会`Invoke`在这里使用。事实上，在大多数情况下，尽管您可能会在互联网上阅读到这些内容，但它通常不是一个好的选择。相反，将线程正在生成的数据打包到[POCO](http://en.wikipedia.org/wiki/Plain_Old_CLR_Object)中并放入队列中。`System.Windows.Forms.Timer`每秒有一个滴答声，事件处理程序将项目从队列中拉出`ListView`以批量更新。另外，尝试设置`DoubleBuffered`为true。这些建议应该会有所帮助。

```
public class YourForm : Form
{
  private ConcurrentQueue<UpdateInfo> queue = new ConcurrentQueue<UpdateInfo>();

  private void YourTimer_Tick(object sender, EventArgs args)
  {
    UpdateInfo value;
    listView1.BeginUpdate();
    while (queue.TryDequeue(out value)
    {
      this.listView1.Items[value.Number].SubItems[1].Text = value.Status;
    }
    listView1.EndUpdate();
  }

  private void SomeThread()
  {
    while (true)
    {
      UpdateInfo value = GetUpdateInfo();
      queue.Enqueue(value);
    }
  }

  private class UpdateInfo
  {
    public string User { get; set; }
    public string Status { get; set; }
    public string Proxy { get; set; }
    public int Number { get; set; }
  }
} 
```

# linq - 联接表查询中 Where 子句中的 Linq MAX

> ID：10551302
> 
> 赞同：0
> 
> 时间：2012-05-11T12:25:36.613
> 
> 标签：linq

我处于一种我的思绪被阻塞的情况，希望有人能帮助我。

我有两张桌子。一张包含订阅服务客户的表格和一张发票表格。如果客户被删除，这些表没有与数据库中用于保存发票历史记录的键链接。这样，我必须通过另一个唯一约束（数据库不知道）查询加入 invoiceheader 表的客户表。此约束同时使用名称和地址。

发票每年发送一次。在发票标题表中，日期存储在发票创建时。在几年内，消费者可以拥有多张发票。

我正在尝试创建一个 linq 查询，但恐怕我正在寻找错误的解决方案。

谁能指出我正确的方法？

现在我有一个查询：

```
var temp = from c in context.customer
           from i in context.invoiceheader
           where c.name + c.address == i.name + i.address
           && i.invoicedate < DateTime.Now.Year
           select c; 
```

通过这个查询，我得到了所有去年收到发票并且仍然订阅的客户。问题在于从未收到发票的新客户。

如果客户在这种情况下没有任何发票记录，该怎么办？

总结：我想查询最后知道的发票。如果此发票超过一年（上一年）或根本没有发送发票，我想检索应发送新发票的客户列表。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T21:01:37.290

我想你想要的是一个左外连接 - 这样你应该能够获得你需要的所有客户：

```
var customers = from c in context.customer
                join i in context.invoiceheader
                on c.Name + c.Address equals i.Name + i.Address
                into g
                from row in g.DefaultIfEmpty()
                where row == null ||row.invoicedate < DateTime.Now.Year
                select c; 
```

# sql - 通用oracle程序调用其他程序进行排序、分页和过滤

> ID：10551305
> 
> 赞同：0
> 
> 时间：2012-05-11T12:25:45.950
> 
> 标签：sql, oracle, oracle10g

我在 oracle 10g 中有多个存储过程，我想在不接触它们的情况下实现排序、分页和过滤。

我正在考虑有一个通用过程，我将把排序方向、排序列、页面索引和过滤子句以及目标过程和所需参数传递给它。

这个通用过程将执行并返回其中的行，并应用我想要的过滤、排序和分页。

关于如何实现这一目标的任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T19:09:45.247

假设您有一个返回`employee data`如下所示的包：

```
CREATE OR REPLACE PACKAGE get_data
IS 
TYPE emp_data IS REF CURSOR;

PROCEDURE get_emp_data(p_emp_data IN OUT emp_data);

END get_data;
/

create or replace package body get_data
IS 

PROCEDURE get_emp_data(p_emp_data IN OUT emp_data)
IS

begin

open p_emp_data for select empno
                          ,ename
                          ,job
                          ,mgr
                          ,hiredate
                          ,sal
                          ,comm
                          ,deptno 
                    from   emp;

end get_emp_data;

end get_data;
/ 
```

现在我假设您正在从过程中获取光标`get_data.get_emp_data(..)`。您需要编写一个调用上述过程的过程并对`sorting,pagination and filtering`上述从光标返回的数据进行处理。

在这里，我认为您知道从上述光标返回的列。现在我将创建从 proc 返回的列的对象和该对象的类型。

```
create or replace type emp_obj as object 
(
 empno number(4)
,ename varchar2(10)
,job varchar2(9)
,mgr number(4)
,hiredate date
,sal number(7,2)
,comm number(7,2)
,deptno number(2)
);

create type emp_data_nt as table of emp_obj; 
```

现在，主要问题是，您想对现有过程中 emp 光标的数据进行排序和分页。例如：您需要`order by hiredate`并选择仅有的 5 条记录。

创建一个将调用上述包过程的过程

```
create or replace procedure get_emp_data1
(
 v_emp_data IN OUT get_data.emp_data
)
is
v_emp_data_nt emp_data_nt:=emp_data_nt();
v_emp_data_rec emp%ROWTYPE;
i integer :=1;
begin

get_data.get_emp_data(v_emp_data);
LOOP
  FETCH v_emp_data INTO v_emp_data_rec;
  EXIT WHEN v_emp_data%NOTFOUND;
  v_emp_data_nt.extend();

  v_emp_data_nt(i) := emp_obj(v_emp_data_rec.empno
                             ,v_emp_data_rec.ename
                             ,v_emp_data_rec.job  
                             ,v_emp_data_rec.mgr
                             ,v_emp_data_rec.hiredate
                             ,v_emp_data_rec.sal
                             ,v_emp_data_rec.comm
                             ,v_emp_data_rec.deptno);
 i:=i+1;
END LOOP;
close v_emp_data;

open v_emp_data for select * 
                     from (select * from table(v_emp_data_nt) ed 
                            order by ed.hiredate) 
                    where rownum<=5;

end; 
```

如果我执行上述过程，我将得到以下输出

```
 EMPNO      ENAME   JOB        MGR   HIREDATE       SAL     COMM    DEPTNO
 ===========================================================================
 7369   SMITH   CLERK     7902  17-12-1980  800     20
 7499   ALLEN   SALESMAN  7698  20-02-1981  1600    300 30
 7521   WARD    SALESMAN  7698  22-02-1981  1250    500 30
 7566   JONES   MANAGER   7839  02-04-1981  2975        20
 7698   BLAKE   MANAGER   7839  01-05-1981  2850        30 
```

可能这不是有效的方法，但是通过这种方式，您将实现您想要的。我知道这里有很多专家的建议，他们总是受欢迎的:)

# c# - 取消在浏览器中打开链接

> ID：10551306
> 
> 赞同：-1
> 
> 时间：2012-05-11T12:25:57.737
> 
> 标签：c#, windows-phone-7

在我的 Windows 手机应用程序中，我使用 RichTextBox 元素

我上面有一个超链接，当用户点击它时会出现一个对话框：你想在外部浏览器中打开这个链接吗？如果用户拒绝，则不应打开外部浏览器。我取消导航，但无论如何 - 外部浏览器打开。如何取消浏览器中的打开链接？

```
//Constructor
        static Helper()
                {
                    var phoneApplicationFrame = Application.Current.RootVisual as PhoneApplicationFrame;
                    if (Application.Current.RootVisual as PhoneApplicationFrame != null)
                    {
                        phoneApplicationFrame.Navigating += new NavigatingCancelEventHandler(NavigationService_Navigating);
                    }

                }

link.Foreground = new SolidColorBrush(Colors.Blue);
                            link.MouseOverForeground = new SolidColorBrush(Colors.Blue);
                            link.TargetName = "_blank";

                            var linkText = new Run() { Text = linkDesc };
                            link.Inlines.Add(linkText);
                            link.Click += new RoutedEventHandler(NavidateTo);

private static void NavidateTo(object sender, RoutedEventArgs routedEventArgs)
        {

            if (MessageBox.Show(
                             Constants.BrowserNavigating,
                             "",
                              MessageBoxButton.OKCancel) == MessageBoxResult.Cancel)
            {
                StateManager.Set("ExternalBrowser", "true");
            }
            else
            {
                StateManager.Set("Browser", "true");
            }
        }

        public static void NavigationService_Navigating(object sender, NavigatingCancelEventArgs e)
        {
            var res = StateManager.Get("ExternalBrowser");
            if (res != null)
            {
                StateManager.Remove("ExternalBrowser");
                e.Cancel = true;
            }

        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T17:45:33.810

不要让 HyperlinkBut​​ton 打开链接本身，不要指定 NavigationUri，而是`Tap`自己处理事件。

在事件处理程序中提出问题，只有在他们说是时才打开浏览器。
这比试图取消已经在进行中的事情要简单得多。

# events - Titanium mobile - 视图上的 addEventListener

> ID：10551307
> 
> 赞同：1
> 
> 时间：2012-05-11T12:26:25.223
> 
> 标签：events, view, titanium, titanium-mobile, addeventlistener

我正在使用常见的 JS 制作一个可滚动的菜单。

菜单项是一个包含其他 2 个组件的视图：一个用于图标的 imageView，一个用于该菜单文本的标签。

在 android 和 ios 模拟器上的行为很奇怪，而且不一样。

在 android 上，如果在标签或 imageview 上单击，则会给出：“未捕获的 TypeError：无法读取属性...”在 iphone 上，它只是不启动任何东西。

如果我点击其他地方（仍然进入查看项目）但不是在图像或唇上，例如在边缘上，那就完美了！

这是代码：

功能菜单图标（itemTab）{

```
var menuMain = Ti.UI.createView({
    layout : 'vertical',
    backgroundColor : '#333333',
    height : 125,
    bottom : 10,
    left : 10,
    right : 10,
    borderRadius : 5.0
});

var menuFirstLine = Ti.UI.createScrollView({
    scrollType : 'horizontal',
    contentHeight : 120,
    contentWidth : 'auto',
    layout : 'horizontal',
    height : 120,
    marginLeft : 5
});

var items = [];
var menuIconsItem = require('view/module/menuIconsItem');

for(var i in itemTab) {
    var page = itemTab[i].page;

    items[i] = new menuIconsItem(itemTab[i]);

    (function(itemsEvent) {
        itemsEvent.id = itemTab[i].id;
        itemsEvent.addEventListener('click', function(e) {

            Ti.App.fireEvent('main_menu_' + itemsEvent.id, {
                id : e.source.id
            });
        })
    })(items[i]);

    menuFirstLine.add(items[i]);
}
menuMain.add(menuFirstLine);
return menuMain; 
```

}

module.exports = 菜单图标；

以及所需项目的代码 (var menuIconsItem = require('view/module/menuIconsItem');) ：

功能菜单图标项目（项目）{

```
// path for images on Android  besoin de centraliser tout ca
var pathImages = '';

var itemImage = Ti.UI.createImageView({
    image : item.imageLink,
    width : 64,
    height : 64,
    top : 15
});

var itemLabel = Ti.UI.createLabel({
    color : '#afafaf',
    text : item.text,
    font : {
        textAlign : 'center'
    },
    height : 40,
    top : 80
});

var menuItem = Ti.UI.createView({
    width : 120,
    height : 120,
    backgroundColor : '#424242',
    top : 5,
    left : 5
});

menuItem.add(itemImage);
menuItem.add(itemLabel);

return menuItem; 
```

}

module.exports = menuIconsItem;

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T12:41:41.670

您还必须为标签和图像视图设置 id。

# java - Android KEYCODE_DPAD 刷卡

> ID：10551310
> 
> 赞同：0
> 
> 时间：2012-05-11T12:26:36.170
> 
> 标签：java, android, touch

我正在尝试在 android 开发网站上实现[蛇游戏示例](http://developer.android.com/resources/samples/Snake/index.html)，但我的手机没有 D-pad，只有触摸屏。更改（或添加）使用手指滑动的功能的最简单方法是什么，就像使用滚动网页而不是方向键一样

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T12:35:45.040

```
public class SelectFilterActivity extends Activity implements OnClickListener
{

    private static final int SWIPE_MIN_DISTANCE = 120;
    private static final int SWIPE_MAX_OFF_PATH = 250;
    private static final int SWIPE_THRESHOLD_VELOCITY = 200;
    private GestureDetector gestureDetector;
    View.OnTouchListener gestureListener;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        /* ... */

        // Gesture detection
        gestureDetector = new GestureDetector(new MyGestureDetector());
        gestureListener = new View.OnTouchListener() {
            public boolean onTouch(View v, MotionEvent event) {
                return gestureDetector.onTouchEvent(event);
            }
        };

    }

    class MyGestureDetector extends SimpleOnGestureListener {
        @Override
        public boolean onFling(MotionEvent e1, MotionEvent e2, float velocityX, float velocityY) {
            try {
                if (Math.abs(e1.getY() - e2.getY()) > SWIPE_MAX_OFF_PATH)
                    return false;
                // right to left swipe
                if(e1.getX() - e2.getX() > SWIPE_MIN_DISTANCE && Math.abs(velocityX) > SWIPE_THRESHOLD_VELOCITY) {
                    Toast.makeText(SelectFilterActivity.this, "Left Swipe", Toast.LENGTH_SHORT).show();
                }  else if (e2.getX() - e1.getX() > SWIPE_MIN_DISTANCE && Math.abs(velocityX) > SWIPE_THRESHOLD_VELOCITY) {
                    Toast.makeText(SelectFilterActivity.this, "Right Swipe", Toast.LENGTH_SHORT).show();
                }
            } catch (Exception e) {
                // nothing
            }
            return false;
        }

    } 
```

看

[网格布局上的 Fling 手势检测](https://stackoverflow.com/questions/937313/android-basic-gesture-detection)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T12:31:15.413

[这里](http://www.eridem.net/android-tip-010-left-and-right-swipe-gesture-events)有一个关于监听滑动手势的不错的教程。

# java - 从java运行交互式bat文件？

> ID：10551312
> 
> 赞同：0
> 
> 时间：2012-05-11T12:26:39.083
> 
> 标签：java, batch-file

需要帮助从 java 调用批处理文件，它是交互式的，不应在新窗口中打开。尝试使用运行时调用 --- cmd /c start batchfilename --- 但它正在新窗口中打开。我需要在调用批处理文件的同一窗口中关注和执行调用批处理文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T14:20:17.480

Windows 有一个启动命令：

```
C:\>start /?
Starts a separate window to run a specified program or command.

START ["title"] [/D path] [/I] [/MIN] [/MAX] [/SEPARATE | /SHARED]
      [/LOW | /NORMAL | /HIGH | /REALTIME | /ABOVENORMAL | /BELOWNORMAL]
      [/AFFINITY <hex affinity>] [/WAIT] [/B] [command/program]
      [parameters]

    "title"     Title to display in  window title bar.
    path        Starting directory
    B           Start application without creating a new window. The
                application has ^C handling ignored. Unless the application
                enables ^C processing, ^Break is the only way to interrupt
                the application
    I           The new environment will be the original environment passed
                to the cmd.exe and not the current environment.
    MIN         Start window minimized
    MAX         Start window maximized
    SEPARATE    Start 16-bit Windows program in separate memory space
    SHARED      Start 16-bit Windows program in shared memory space
    LOW         Start application in the IDLE priority class
    NORMAL      Start application in the NORMAL priority class
    HIGH        Start application in the HIGH priority class
    REALTIME    Start application in the REALTIME priority class
Press any key to continue . . . 
```

尝试运行 start（而不是 cmd）。如果这对您没有帮助，您可以捕获用户输入/输出并通过管道传输到[Process](http://docs.oracle.com/javase/6/docs/api/java/lang/Process.html#getInputStream%28%29)。

# node.js - MongoDB Node findone如何处理没有结果？

> ID：10551313
> 
> 赞同：50
> 
> 时间：2012-05-11T12:26:39.617
> 
> 标签：node.js, mongodb

`mongodb`我使用带有节点的 npm驱动程序。

我有

```
collection.findOne({query}, function(err, result) {
    //do something
} 
```

问题是说我没有任何结果，`err`仍然`null`是我是否找到结果。我怎么知道查询没有找到结果？

我也试过

```
info = collection.findOne(.... 
```

但这`info`只是`undefined`（它看起来是异步的，所以我不认为这是要走的路……）

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2012-05-11T12:36:15.757

未找到任何记录不是错误情况，因此您要查找的是`result`. 由于任何匹配的文件总是“真实的”，您可以简单地使用简单的`if (result)`检查。例如，

```
collection.findOne({query}, function(err, result) {
    if (err) { /* handle err */ }

    if (result) {
        // we have a result
    } else {
        // we don't
    }
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2016-01-07T09:23:32.603

以下所有这些答案都已过时。findOne 已[弃用](https://github.com/mongodb/node-mongodb-native/blob/2.0/lib/collection.js)。最新的 2.1 文档建议使用

```
find(query).limit(1).next(function(err, doc){
   // handle data
}) 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-02-17T12:09:57.180

简单来说：

```
collection.findOne({query}, function(err, result) {
    if (!result) {
        // Resolve your query here
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-03-18T20:50:38.477

如今 - 从[节点 8](https://nodejs.org/en/blog/release/v8.0.0/#say-hello-to-async_hooks)开始- 您可以在`async`函数中执行此操作：

```
async function func() {
  try {
    const result = await db.collection('xxx').findOne({query});
    if (!result) {
      // no result
    } else {
      // do something with result
    }
  } catch (err) {
    // error occured
  }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-11T12:37:10.673

如果结果为空，则 mongo 未找到与您的查询匹配的文档。是否尝试过来自 mongo shell 的查询？

* * *

## 回答 #6

> 赞同：-8
> 
> 时间：2015-07-17T01:08:50.737

```
collection.findOne({query}, function(err, result) {
   if (err) { /* handle err */ }

   if (result.length === 0) {
    // we don't have result
   }
} 
```

# scorm - 导入符合 SCORM 的课程 (imsmanifest.xml)

> ID：10551315
> 
> 赞同：0
> 
> 时间：2012-05-11T12:26:48.793
> 
> 标签：scorm

我正在开发一个基本的**LCMS（学习内容管理系统）**，我必须在我的系统中导入一个符合 SCORM 的课程，为此我必须解析**imsmanifest.xml**文件，然后基于 XML 文件导入所有内容。

有没有人做过这个任务？你能用示例代码或有用的链接指导我吗？

我正在使用 VB.Net，但即使是 C# 代码也适用于我。

等待快速和积极的回应在此先感谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-12T06:34:00.013

我认为 XPath 和 Linq 是您解析 imsmanifest.xml 以执行此操作的最佳技术。您还可以在 C# 中使用 System.IO 命名空间来实现您的项目。

# git - git 中间存储库（作为另一个代理）

> ID：10551318
> 
> 赞同：0
> 
> 时间：2012-05-11T12:26:55.020
> 
> 标签：git, gitorious

是否可以让 git 存储库（可克隆和可推送）本身成为另一个远程存储库的克隆？

场景：

我们为我们公司的 git 托管安装了 gitorious。我们希望保持更新，但添加一些非常私有的功能（主要是部署脚本），因此需要一个可推送的项目。所需的工作流程是：

*   创建一个 mygitorous 作为可推送的 git repo
*   将 gitorious-official 克隆到 mygitorious （不作为子模块，作为参考）
*   用户现在可以克隆和推送 mygitorious
*   然后我可以将 mygitorious 与 gitorious-official 合并以从上游更新
*   我可以更新我部署的克隆
*   用户可以使用合并版本更新他们的克隆

PS。由于这些部署脚本非常敏感，我不能简单地在 gitorious 中创建一个公共克隆并使用它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T15:43:24.083

当然。分布式版本控制系统背后的整个想法`git`是没有存储库是“特殊的”。任何存储库都可以是零个、一个或多个其他存储库的克隆或目标。

例如，假设我有一个存储库`repo1.git`，我可以这样做：

```
$ git clone --bare repo1.git repo2.git
$ git clone repo2.git repo3
$ cd repo3
$ ...make some changes and commit...
$ git push
$ cd ../repo2.git
$ git push 
```

如果你跟着它，你可以看到我推了 repo3 --> repo2，然后是 repo2 --> repo1。

回复您的评论：

您不能`git checkout`在裸存储库中运行。就是这个`fatal: This operation must be run in a work tree`意思。当您`git clone`创建存储库时，您会得到两件事：

*   存储库的副本，包含在`.git`目录中，以及
*   “工作副本”或“工作树”，它是包含存储库中文件的签出副本的目录。许多命令 ( `checkout`, `pull`) 仅在您与工作副本交互时才有意义。

但是请注意，推*送到*非裸存储库（即具有关联工作树的存储库）是很棘手的；git 会在没有显式配置的情况下抛出错误。您会看到以下内容：

```
To /home/lars/tmp/so/repo
 ! [remote rejected] foo -> foo (branch is currently checked out)
error: failed to push some refs to '/home/lars/tmp/so/repo' 
```

这是因为如果其他人正在推动它，那么在您的工作树下的存储库中发生更改会令人惊讶。[您可以在此答案](https://stackoverflow.com/questions/804545/what-is-this-git-warning-message-when-pushing-changes-to-a-remote-repository)中阅读更多内容。

# c# - WPF 中 WinForms ListView.FullRowSelect 的等价物

> ID：10551320
> 
> 赞同：0
> 
> 时间：2012-05-11T12:27:14.600
> 
> 标签：c#, wpf, listview

我似乎找不到我喜欢在 Windows 窗体中使用的 ListView.FullRowSelect 属性的等效项。WPF ListView 是否支持此功能，还是我必须将其迁移到 DataGrid 控件？;)

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T12:41:28.380

我没有使用过 WinForms，但如果它类似于 MFC，我假设您的意思是您希望在单击某个项目时突出显示整行，而不仅仅是该行中的第一个单元格。完全可以在 WPF 的`ListView`控制下进行。

由于您没有发布 XAML，我必须假设您没有将 View 设置`ListView`为`GridView`. 您不必立即跳到使用`DataGrid`控件。

这是一个典型的方法示例：

```
<ListView ItemsSource="{Binding Items}">
    <ListView.View>
        <GridView>
            <GridViewColumn DisplayMemberBinding="{Binding Column1}" Header="Column 1" />
            <GridViewColumn DisplayMemberBinding="{Binding Column2}" Header="Column 2" />
            <GridViewColumn DisplayMemberBinding="{Binding Column3}" Header="Column 3" />
        </GridView>
    </ListView.View>
</ListView> 
```

`Items`可能是`ObservableCollection<MyClass>`，其中`MyClass`具有三个公共字符串属性，称为 Column1、Column2 和 Column3：

```
public class MyClass
{
    public string Column1 { get; set; }
    public string Column2 { get; set; }
    public string Column3 { get; set; }
} 
```

当您使用`GridView`.

# jquery - 将通过 AJAX/MYSQL 检索到的内容加载到 jQueryTools 覆盖中

> ID：10551321
> 
> 赞同：1
> 
> 时间：2012-05-11T12:27:15.997
> 
> 标签：jquery, ajax, overlay, jquery-tools

jQuery 新手，无法使其正常工作。我已经使用 jQuery $.ajax() 从 MYSQL 数据库中检索了内容。那部分有效。您可以在下面的 onBeforeLoad 事件中看到该代码。

我希望将此内容加载到 jQueryTools 覆盖中。我已将该内容转储到 ID 为“contentWrap”的块中。

jQueryTools 覆盖文档有一个使用 onBeforeLoad 事件将外部页面加载到覆盖中的示例，但我无法根据我的目的调整该代码。这是他们的示例，来自[http://jquerytools.org/demos/overlay/external.html](http://jquerytools.org/demos/overlay/external.html)：

```
onBeforeLoad: function() {

    // grab wrapper element inside content
    var wrap = this.getOverlay().find(".contentWrap");

    // load the page specified in the trigger
    wrap.load(this.getTrigger().attr("href"));
} 
```

我尝试将我的 ajax 代码放在覆盖调用中的 onBeforeLoad 事件中，但没有奏效。那么如何将我的内容直接加载到叠加层中呢？

好的，经过一些更改，这是实际运行的代码，但仍然无法正常工作：

查询：

```
$("a.noteref[rel]").overlay({
mask: {
    color: '#000',
    loadSpeed: 100,
    opacity: 0.7
},
closeOnClick: true,
fixed: false,
onBeforeLoad: function() {
        $.ajax({
            url: 'api.php',
            data: "ID=" + $(this).attr('id').replace('#', ''),
            type: 'post',
            dataType: 'json',
            success: function(data) {
                var id = data[0];
                var vtype = data[1];
                var vcontent = data[2];
                var vlink = data[3];
                var data

                $('#contentWrap').html(vcontent);
                }
        });
        var wrap = this.getOverlay().find("#contentWrap");
        wrap.load();

    }
}); 
```

HTML：

```
<a hef="http://www.example.com/" class="noteref" id="cite01">Example</a>

<div class="overlay">
    <div id="contentWrap"></div>
</div> 
```

# python - 读取文件并复制到标准输出。

> ID：10551330
> 
> 赞同：0
> 
> 时间：2012-05-11T12:28:08.500
> 
> 标签：python, input, copy

我正在尝试编写一个 python 程序来读取输入并将其复制到标准输出（没有更改）。我被告知它需要作为 Unix cat 函数的 Python 版本运行。如果无法打开文件，则需要打印错误消息，然后程序需要继续处理任何其他文件。我是一个完整的初学者，并已尽力用我有限的知识来拼凑一些东西。这是我到目前为止所拥有的：

```
from sys import argv, stdout, stdin, stderr

if len(argv) == 1:

    try:
        stdout.write(raw_input(' ') + '\n')
    except:
        stderr.write ('sorry' + '\n')
        quit()

else:

    for filename in argv[1:]:
        try:
            filehandle + open(filename)
        except IOError:
            stderr.write('Sorry, could not open', filename + '\n')
            continue

        f = filehandle.read()

        stdout.write(f) 
```

我不太确定从这里去哪里..有没有人有任何建议/我是否走在正确的轨道上？谢谢，麻烦您了！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T12:30:38.327

此函数将逐行复制指定的文件到控制台（以防您稍后决定赋予它使用`-n`cat 的命令行选项的能力）

```
def catfile(fn):
  with open(fn) as f:
    for line in f:
      print line, 
```

一旦确定文件存在，就可以使用文件名调用它。

# forms - 在 Joomla JForm 中插入安全检查

> ID：10551339
> 
> 赞同：0
> 
> 时间：2012-05-11T12:28:46.950
> 
> 标签：forms, joomla

我有一个 joomla RSMonial 表单，我想插入一个像这样的安全检查

安全检查 * .. 带有输入框，例如“请填写 8+7 的总和”...而不是验证码

我正在使用 Joomla v.1.5.21

先感谢您

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-12T07:31:33.987

看看这个地方：[Joomla！扩展目录](http://extensions.joomla.org/extensions/access-a-security/site-security/captcha)

# c# - 从控制台应用程序运行时到 IIS 的 WebRequest 失败并超时

> ID：10551341
> 
> 赞同：0
> 
> 时间：2012-05-11T12:28:54.263
> 
> 标签：c#, iis, timeout, webrequest

我有最基本的可能代码，它试图从 WebRequest 获得响应。它将超时设置为 500 毫秒（这绰绰有余），并获得响应。如果请求超时，它会返回信息。当我从通过 VPN 连接到运行 IIS 的服务器的计算机上运行此代码时 - 一切正常。此代码返回“OK”。在 IIS 服务器上运行的相同代码返回“超时。”。总是。

请注意，我已经通过在我的计算机上运行此代码以及在 IIS 服务器计算机上的 InternetExplorer 中测试此 URI 来仔细检查 URI 是否有效。

文件 Pulse.aspx 是一个包含 1 个字符“1”的简单文本文件。它可以通过我在代码中提供的 URI 访问。

运行 IIS 的机器是安装了所有最新更新的 Windows 2008 Server。

有趣的是 - 消息“超时”。在超过 2000 毫秒后显示，而不是 500 毫秒，所以这不是正常的超时。在我的计算机上，我可以将超时值设置为 100 毫秒，然后超时，但它会立即发生（在真正的 100 毫秒之后）。

我尝试以普通用户和管理员用户身份运行我的测试代码。没有喜悦。

我究竟做错了什么？我真的需要从 IIS 服务器运行这段代码（它是检测 IIS 崩溃的看门狗/脉冲服务的一部分）。

这是完整的代码：

```
using System;
using System.Net;

namespace ConsoleApplication1 {
    class Program {

        private static bool CheckForTimeout(Uri uri, int timeout) {
            var status = false;
            var req = WebRequest.Create(uri);
            req.Method = "GET";
            req.Timeout = timeout;
            WebResponse res = null;
            try {
                res = req.GetResponse();
            } catch (WebException x) {
                status = x.Status == WebExceptionStatus.Timeout;
            } finally {
                if (res != null) res.Close();
            }
            return status;
        }        

        static void Main(string[] args) {
            if (CheckForTimeout(new Uri("http://192.168.1.11/Pulse.aspx"), 500))
                Console.WriteLine("Timed out.");
            else
                Console.WriteLine("OK.");
        }
    }
} 
```

**更新：**在将超时更改为 5000 后，我让它工作了！但这仍然很奇怪。为什么我只需要 300 毫秒从远程主机运行代码，而从 localhost 运行相同的代码需要 5000 毫秒？

# jquery - jQuery on submit preventDefault() 不起作用

> ID：10551345
> 
> 赞同：0
> 
> 时间：2012-05-11T12:29:13.993
> 
> 标签：jquery, asp.net-mvc-3, forms, onsubmit

我有带有提交按钮和 input='file' 控件的 html 表单：

```
<form action="/Profile/UploadFile" enctype="multipart/form-data" method="post" onsubmit="OnUploadSubmit(this)"> 
```

OnUploadSubmit 函数如下所示：

```
 if (e.files[0].size > 5000000) {
        $('#upload_error').css('display', 'block');
        $('#upload_error').text('The file size is too large for upload')
        e.preventDefault();
        return false;
    }

    var files = e.files;
    var ext = $('#file_uploader').val().split('.').pop().toLowerCase();
    if ($.inArray(ext, ['jpeg', 'jpg', 'png']) == -1) {
        $('#upload_error').css('display', 'block');
        $('#upload_error').text('Only, jpg, jpeg, png is allowed');
        e.preventDefault();
        return false;
    }
    return true;
} 
```

e.preventDefault() 并返回 false；无论如何，表格都不起作用。

有人知道我的问题是什么吗？

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-11T12:36:29.937

首先，您不能以这种方式使用 preventDefault ，因为您没有将事件对象传递给函数，然后：

```
onsubmit="return OnUploadSubmit(this)" 
```

我推荐：

添加 id 属性并删除 onsubmit：

```
<form id="upload" action="/Profile/UploadFile" enctype="multipart/form-data" method="post"> 
```

jQuery：

```
$(function(){ // Document Ready

        $('#upload').submit(function(e){

        e.preventDefault();
         if (e.files[0].size > 5000000) {
                $('#upload_error').css('display', 'block');
                $('#upload_error').text('The file size is too large for upload')
            }

            var files = e.files;
            var ext = $('#file_uploader').val().split('.').pop().toLowerCase();
            if ($.inArray(ext, ['jpeg', 'jpg', 'png']) == -1) {
                $('#upload_error').css('display', 'block');
                $('#upload_error').text('Only, jpg, jpeg, png is allowed');
            }
        }

    });

}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-11T12:33:13.697

您的 OnUploadSubmit 方法定义是否包含 e 作为参数？如果没有，e.preventDefault 将不起作用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-11T12:34:51.373

你试过`onsubmit="return OnUploadSubmit(this);"`代替`onsubmit="OnUploadSubmit(this)"`吗？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-11T12:35:20.750

我想你需要`onsubmit="return OnUploadSubmit(this)"`

# c# - SelectedIndexChange 事件触发后，列表框弹回第一项

> ID：10551346
> 
> 赞同：1
> 
> 时间：2012-05-11T12:29:16.950
> 
> 标签：c#, asp.net

我有一个带有正确触发的 selectedindexchanged 事件的 3 下拉列表控件。但是，当您从列表中选择一个项目时，返回给 selectedindexchanged 事件的索引值不会改变；列表框弹回到列表中的第一项。任何帮助，将不胜感激。～达门陀罗～

```
`public partial class Production : System.Web.UI.Page
{ 
    EmployeeQuotientCL.Production _production = null;
    DataSet dsNatureOfWork = new DataSet();
    DataSet dsProjectRegion = new DataSet();
    DataSet dsCountyDetails = new DataSet();
    DataSet dsWorkType = new DataSet();
    DataSet dsTask = new DataSet();

    protected void Page_Load(object sender, EventArgs e)
    {
        if (!IsPostBack)
        {
             string userEcode=Convert.ToString(Session["UserID"]); 
            _production = new EmployeeQuotientCL.Production();                       
            dsNatureOfWork = _production.GetNatureOfWork();
            if (dsNatureOfWork.Tables[0].Rows.Count > 0)
            {
                BindDdlNatureOfWork(dsNatureOfWork);
            }
            else
            {
            }
        }            

    }

    public void BindDdlNatureOfWork(DataSet dsNatureOfWork)
    {
        ddlNatureofWork.DataSource = dsNatureOfWork.Tables[0];
        ddlNatureofWork.DataTextField = "NatureOfWorkName";
        ddlNatureofWork.DataValueField = "NatureOfWorkID";
        ddlNatureofWork.DataBind();
        ddlNatureofWork.Items.Insert(0, "--Select Nature of Work--");
    }

    public void FillRegionProject(int NatureOfWorkID)
    {
        if ((NatureOfWorkID != null) || (NatureOfWorkID != 0))
        {
            _production = new EmployeeQuotientCL.Production();
            dsProjectRegion = _production.GetProjectRegion(NatureOfWorkID);
            if (dsProjectRegion.Tables[0].Rows.Count > 0)
            {
                ddlRegionProjectName.DataSource = dsProjectRegion.Tables[0];
                ddlRegionProjectName.DataTextField = "RegionProjectName";
                ddlRegionProjectName.DataValueField = "RegionProjectID";
                ddlRegionProjectName.DataBind();
                ddlRegionProjectName.Items.Insert(0, "--Select Region/Project--");

            }
            else
            {
            }
        }

    }

    protected void ddlRegionProjectName_SelectedIndexChanged(object sender, EventArgs e)
    {
        int RegionProjectID = Convert.ToInt32(ddlRegionProjectName.SelectedValue.ToString());
        FillCounty(RegionProjectID);
        ddlRegionProjectName.SelectedIndex = 0;

    }

    public void FillCounty(int regionprojectID)
    {
        if ((regionprojectID != null) || (regionprojectID != 0))
        {
            _production = new EmployeeQuotientCL.Production();
            dsCountyDetails = _production.GetCounty(regionprojectID);
            if (dsCountyDetails.Tables[0].Rows.Count > 0)
            {
                ddlCountyName.DataSource = dsCountyDetails.Tables[0];
                ddlCountyName.DataTextField = "CountyName";
                ddlCountyName.DataValueField = "CountyID";
                ddlCountyName.DataBind();
                ddlCountyName.Items.Insert(0, "--Select County--");

            }
            else
            {
            }
        }
    }

    protected void ddlNatureofWork_SelectedIndexChanged(object sender, EventArgs e)
    {
        int NowID = Convert.ToInt32(ddlNatureofWork.SelectedValue.ToString());
        FillRegionProject(NowID);
        ddlRegionProjectName.SelectedIndex = 0;
    }

} 
```

}`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T12:36:49.207

你 `ddlRegionProjectName.SelectedIndex = 0;`在每一个`SelectedIndexChanged`事件中都在做。

您共享的代码中没有 ddlCountyName 控件的事件。

# java - 在java中打开新的动态web项目

> ID：10551352
> 
> 赞同：0
> 
> 时间：2012-05-11T12:29:51.783
> 
> 标签：java, servlets, amazon-ec2, eclipse-wtp

我正在用java编写需要在亚马逊的ec2上运行的服务器应用程序。我在某处读到需要打开**动态 Web 项目**，但在 Eclipse 中没有此选项。我的 Eclipse 版本是![蚀](../Images/36fa64c7f844781b4a857aabce4fc064.png).

我尝试通过帮助安装新软件 -> 从[http://download.eclipse.org/webtools/repository/indigo](http://download.eclipse.org/webtools/repository/indigo)安装包“Web Tools Platforms”， 但在安装过程中失败。

有人可以帮我吗？

谢谢！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T12:44:32.990

您需要一个标记为***[Eclipse for Java EE Developers](http://www.eclipse.org/downloads/moreinfo/jee.php)***的工具，它可以让您创建 Web 项目。

另见[this](http://help.eclipse.org/indigo/index.jsp?topic=%2Forg.eclipse.wst.webtools.doc.user%2Ftopics%2Fccwebprj.html) & [this](http://besthowtodo.com/blog/2010/05/how-to-create-dynamic-web-project-in-eclipse.html)。它会帮助你..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T19:06:18.710

并非所有这些都是必需的（我认为），但是在安装了下面列出的组件后，我将“动态 Web 项目”模板添加到了我的 Eclipse（Indigo）中。名单是：

*   Eclipse Java EE 开发人员工具
*   Eclipse Java Web 开发者工具
*   Eclipse Web 开发人员工具
*   Eclipse XML 编辑器和工具

您可以通过单击“帮助”>“安装新软件”来安装这些软件包，选择与您的 Eclipse 构建相对应的存储库（即，对于 Indigo，[http://download.eclipse.org/releases/indigo ）。](http://download.eclipse.org/releases/indigo)这些包被分组在“Web、XML、Java EE 和 OSGi 企业开发”下。

# vba - 使用VB将excel工作表保存为文件名+工作表名称的CSV文件

> ID：10551353
> 
> 赞同：29
> 
> 时间：2012-05-11T12:29:55.467
> 
> 标签：vba, excel, csv

我对 VB 编码非常陌生，我正在尝试将多个 excel 文件工作表保存到 csv，我不知道如何为多个工作表执行此操作，但我找到了一种处理单个文件的方法。我在这个网站上找到了对我想要做的事情非常有用的代码，唯一的问题是文件是用工作表名称保存的，但我试图用原始文件和工作表名称保存它们，例如`filename_worksheet name`，我试图自己做，但不断出错，你能告诉我我做错了什么吗？

我正在使用的代码如下：

```
 Public Sub SaveWorksheetsAsCsv()

   Dim WS As Excel.Worksheet
   Dim SaveToDirectory As String

   Dim CurrentWorkbook As String
   Dim CurrentFormat As Long

   CurrentWorkbook = ThisWorkbook.FullName
   CurrentFormat = ThisWorkbook.FileFormat
   ' Store current details for the workbook
   SaveToDirectory = "H:\test\"
   For Each WS In ThisWorkbook.Worksheets
   WS.SaveAs SaveToDirectory & WS.Name, xlCSV
   Next

Application.DisplayAlerts = False
ThisWorkbook.SaveAs Filename:=CurrentWorkbook, FileFormat:=CurrentFormat
Application.DisplayAlerts = True
' Temporarily turn alerts off to prevent the user being prompted
'  about overwriting the original file.

End Sub 
```

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-05-11T13:00:09.850

我想这就是你想要的...

```
Sub SaveWorksheetsAsCsv()

Dim WS As Excel.Worksheet
Dim SaveToDirectory As String

Dim CurrentWorkbook As String
Dim CurrentFormat As Long

CurrentWorkbook = ThisWorkbook.FullName
CurrentFormat = ThisWorkbook.FileFormat
' Store current details for the workbook
SaveToDirectory = "H:\test\"

For Each WS In Application.ActiveWorkbook.Worksheets
    WS.SaveAs SaveToDirectory & WS.Name, xlCSV
Next

Application.DisplayAlerts = False
ThisWorkbook.SaveAs Filename:=CurrentWorkbook, FileFormat:=CurrentFormat
Application.DisplayAlerts = True
' Temporarily turn alerts off to prevent the user being prompted
'  about overwriting the original file.

End Sub 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-05-09T12:15:32.707

我有一个类似的问题。我需要将工作表中的数据另存为单独的 CSV 文件。

这是我在命令按钮后面的代码

* * *

```
Private Sub cmdSave()
    Dim sFileName As String
    Dim WB As Workbook

    Application.DisplayAlerts = False

    sFileName = "MyFileName.csv"
    'Copy the contents of required sheet ready to paste into the new CSV
    Sheets(1).Range("A1:T85").Copy 'Define your own range

    'Open a new XLS workbook, save it as the file name
    Set WB = Workbooks.Add
    With WB
        .Title = "MyTitle"
        .Subject = "MySubject"
        .Sheets(1).Select
        ActiveSheet.Paste
        .SaveAs "MyDirectory\" & sFileName, xlCSV
        .Close
    End With

    Application.DisplayAlerts = True
End Sub 
```

* * *

这对我有用:-)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-11T12:58:19.360

这是你正在尝试的吗？

```
Option Explicit

Public Sub SaveWorksheetsAsCsv()
    Dim WS As Worksheet
    Dim SaveToDirectory As String, newName As String

    SaveToDirectory = "H:\test\"

    For Each WS In ThisWorkbook.Worksheets
        newName = GetBookName(ThisWorkbook.Name) & "_" & WS.Name
        WS.Copy
        ActiveWorkbook.SaveAs SaveToDirectory & newName, xlCSV
        ActiveWorkbook.Close Savechanges:=False
    Next
End Sub

Function GetBookName(strwb As String) As String
    GetBookName = Left(strwb, (InStrRev(strwb, ".", -1, vbTextCompare) - 1))
End Function 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-06-17T16:01:18.843

上面的代码完美地工作，但有一个小缺陷；生成的文件不使用 .csv 扩展名保存。– Tensigh 2 天前

我在代码中添加了以下内容，并将我的文件保存为 csv。感谢这段代码。一切都按预期工作。

```
ActiveWorkbook.SaveAs Filename:=SaveToDirectory & ThisWorkbook.Name & "-" & WS.Name & ".csv", FileFormat:=xlCSV 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-11T13:04:56.227

找出答案的最佳方法是记录宏并执行确切的步骤并查看它生成的 VBA 代码。然后你可以去替换你想要通用的位（即文件名和东西）

# ejb-3.0 - 重新部署远程 JBoss 5.1.0 应用程序后客户端 JBoss 上出现 NotFoundInDispatcherException

> ID：10551356
> 
> 赞同：2
> 
> 时间：2012-05-11T12:30:10.647
> 
> 标签：ejb-3.0, jboss5.x

我有以下设置：

```
Tomcat --WEB-SERVICE--> JBoss Proxy --EJB--> JBoss Back End 
```

如果我在 JBoss 后端重新部署应用程序而不在代理上重新部署代码，则代理对后端 EJB 的后续调用将失败，日志中出现以下错误：

```
2012-05-11 08:40:31,907 ERROR [com.mycompany.ProxyImplI] (http-0.0.0.0-18880-2) Error method findUser null
java.lang.reflect.UndeclaredThrowableException
    at $Proxy360.findUser(Unknown Source)
    at com.mycompany.ProxyImplI.findUser(ProxyImplI.java:622)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.jboss.aop.joinpoint.MethodInvocation.invokeTarget(MethodInvocation.java:122)
    at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:111)
    at org.jboss.ejb3.EJBContainerInvocationWrapper.invokeNext(EJBContainerInvocationWrapper.java:69)
    at org.jboss.ejb3.interceptors.aop.InterceptorSequencer.invoke(InterceptorSequencer.java:73)
    at org.jboss.ejb3.interceptors.aop.InterceptorSequencer.aroundInvoke(InterceptorSequencer.java:59)
    at sun.reflect.GeneratedMethodAccessor307.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.jboss.aop.advice.PerJoinpointAdvice.invoke(PerJoinpointAdvice.java:174)
    ... snip ...
Caused by: org.jboss.aop.NotFoundInDispatcherException: Object with oid: jboss.j2ee:ear=backend.ear,jar=backend-internal-services-6.1.6-SNAPSHOT.jar,name=UserAccountsServiceImplI,service=EJB3 was not found in the Dispatcher
    at org.jboss.aop.Dispatcher.invoke(Dispatcher.java:85)
    at org.jboss.aspects.remoting.AOPRemotingInvocationHandler.invoke(AOPRemotingInvocationHandler.java:82)
    at org.jboss.remoting.ServerInvoker.invoke(ServerInvoker.java:891)
    at org.jboss.remoting.transport.socket.ServerThread.completeInvocation(ServerThread.java:744)
    at org.jboss.remoting.transport.socket.ServerThread.processInvocation(ServerThread.java:697)
    at org.jboss.remoting.transport.socket.ServerThread.dorun(ServerThread.java:524)
    at org.jboss.remoting.transport.socket.ServerThread.run(ServerThread.java:232)
    at org.jboss.remoting.MicroRemoteClientInvoker.invoke(MicroRemoteClientInvoker.java:211)
    at org.jboss.remoting.Client.invoke(Client.java:1724)
    at org.jboss.remoting.Client.invoke(Client.java:629)
    at org.jboss.aspects.remoting.InvokeRemoteInterceptor.invoke(InvokeRemoteInterceptor.java:60)
    at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:102)
    at org.jboss.aspects.tx.ClientTxPropagationInterceptor.invoke(ClientTxPropagationInterceptor.java:61)
    at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:102)
    at org.jboss.ejb3.security.client.SecurityClientInterceptor.invoke(SecurityClientInterceptor.java:65)
    at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:102)
    at org.jboss.ejb3.remoting.IsLocalInterceptor.invoke(IsLocalInterceptor.java:74)
    at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:102)
    at org.jboss.aspects.remoting.PojiProxy.invoke(PojiProxy.java:62)
    at $Proxy375.invoke(Unknown Source)
    at org.jboss.ejb3.proxy.impl.handler.session.SessionProxyInvocationHandlerBase.invoke(SessionProxyInvocationHandlerBase.java:207)
    at org.jboss.ejb3.proxy.impl.handler.session.SessionProxyInvocationHandlerBase.invoke(SessionProxyInvocationHandlerBase.java:164)
    at $Proxy360.findUser(Unknown Source)
    at com.mycompany.ProxyImplI.findUser(ProxyImplI.java:622)
    ...snip... 
```

其他有用的信息：

*   JBoss 5.1.0，在非标准端口上运行*，禁用了一些未使用的服务，添加了 Metro Web Services 3.2.1
*   Tomcat 6.0.14（看不到这真的会影响任何东西）
*   JDK 1.6.0_18
*   被调用的 bean 是`@Stateless`

我很确定应该可以在不重新部署代理的情况下重新部署后端。

目前我们通过重新部署代理服务器来绕过它，但我们宁愿不必这样做。

有没有办法使`org.jboss.aop.Dispatcher`类中已经存在的引用无效，还是有另一种方法可以采取？

* * *

*   我见过[这个](https://issues.jboss.org/browse/JBAS-3724)错误，它在使用非标准端口时提到了类似的问题，但它适用于 JBoss 4.0.4。

# jakarta-ee - 无法从 Jboss 存储库中检索依赖项

> ID：10551361
> 
> 赞同：1
> 
> 时间：2012-05-11T12:30:34.237
> 
> 标签：jakarta-ee, maven, jboss, ejb-3.0

我制作了一个 EJB 3.0 和一个客户端。这是我的 EJB 的 pom：

```
 <repositories>
    <repository>
      <id>Jboss</id>
      <url>https://repository.jboss.org/nexus/content/repositories/releases/</url>
    </repository>
  </repositories>
  <dependencies>
    <dependency>
      <groupId>javax</groupId>
      <artifactId>javaee-api</artifactId>
      <version>6.0</version>
      <scope>provided</scope>
    </dependency>
    <dependency>
      <groupId>org.jboss.ejb3</groupId>
      <artifactId>jboss-ejb3-ext-api</artifactId>
      <version>1.0.0</version>
    </dependency>
    <dependency>
      <groupId>org.jboss.ejb3</groupId>
      <artifactId>jboss-ejb3-ext-api-impl</artifactId>
      <version>1.0.0</version>
    </dependency>
  </dependencies> 
```

但是 jboss-ejb3-ext-api 及其实现无法检索：/ eclipse 告诉我：

> 容器 'Maven Dependencies' 引用了不存在的库 'C:\usr\local\m2-repository\org\jboss\ejb3\jboss-ejb3-ext-api\1.0.0\jboss-ejb3-ext-api-1.0。 0.jar' MyFirstMavenEjb

在我的客户端中，我刚刚添加了“jnp-client”，检索这个没有问题。
知道为什么我不能找回那两个罐子吗？
谢谢。

编辑
我需要这个类：“org.jboss.ejb3.annotation.RemoteBinding”要使用@RemoteBinding。

编辑2：在cmd中执行一些“mvn clean install”后的解决方案我看到maven正在尝试下载一些transitie依赖......来自旧的JBOSS REPO。因为它被拒绝访问，所以它在下载最终的 .jar 之前就停止了

![禁止访问旧仓库](../Images/0df6ab43e4b3cbe871c45e2094507d6a.png)

添加以下排除解决了问题（拒绝访问的罐子）

```
<exclusions>
<exclusion>
<groupId>gnu-getopt</groupId>
<artifactId>getopt</artifactId>
</exclusion>
<exclusion>
<groupId>apache-xerces</groupId>
<artifactId>xml-apis</artifactId>
</exclusion>
<exclusion>
<groupId>apache-xerces</groupId>
<artifactId>xercesImpl</artifactId>
</exclusion>
<exclusion>
<groupId>wutka-dtdparser</groupId>
<artifactId>dtdparser121</artifactId>
</exclusion>
<exclusion>
<groupId>sun-jaxb</groupId>
<artifactId>jaxb-api</artifactId>
</exclusion>
</exclusions> 
```

然而就没有更好的解决方案吗？我猜它正试图从旧的 repo 中获取东西，因为这个 jar 不再使用了，一个新的肯定很受欢迎。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T13:05:35.640

我找到了一个更好的解决方案，事实上这个存储库已经被贬值了，这意味着 jboss 管理不希望你再使用它里面的东西了。

但是，如果您将配置文件添加到您的 maven settings.xml，则可以授予对该 repo 的访问权限

添加此配置文件：

```
<profile>
  <id>jboss-deprecated-repository</id>
  <repositories>
    <repository>
      <id>jboss-deprecated-repository</id>
      <name>JBoss Deprecated Maven Repository</name>
      <url>https://repository.jboss.org/nexus/content/repositories/deprecated/</url>
      <layout>default</layout>
      <releases>
        <enabled>true</enabled>
        <updatePolicy>never</updatePolicy>
      </releases>
      <snapshots>
        <enabled>false</enabled>
        <updatePolicy>never</updatePolicy>
      </snapshots>
    </repository>
  </repositories>
</profile> 
```

并且不要忘记通过 addind that betwen 来激活配置文件

```
 <pluginGroups>
    <pluginGroup>org.jboss.maven.plugins</pluginGroup>
  </pluginGroups> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T12:55:53.830

好的，所以您要查找的 jar 就在其中，`$JBOSS_HOME/common/lib`因此我将执行以下操作以使其在您的 Maven 存储库中可用：
`mvn install:install-file -Dfile=$JBOSS_HOME/common/lib/jboss-ejb3-ext-api.jar -DgroupId="org.jboss.javaee" -DartifactId="jboss-javaee" -Dversion="1.0.0" -Dpackaging=jar`

之后在 Eclipse 中更新您的 Maven 依赖项。

# c++ - c++ 简单的函数分配

> ID：10551365
> 
> 赞同：3
> 
> 时间：2012-05-11T12:30:53.187
> 
> 标签：c++, allocation

我试图了解这种分配在 c++ 中是如何工作的：

```
Test other = toto(); 
```

这是完整的代码源：

```
#include <iostream>

class Test
{
public:
    Test()
    {
        j = i++;
        std::cout<<"default constructor "<<j<<std::endl;
    }

    Test(const Test&)
    {
        std::cout<<"constuctor by copy "<<j<<std::endl;
    }
    Test & operator=(const Test&)
    {
        std::cout<<"operator = "<<j<<std::endl;
        return *this;
    }
    int j;
    static int i;
};

int Test::i = 0;

Test toto()
{
    Test t;
    return t;
}

int main()
{
    Test other = toto();
    std::cout<<other.j<<std::endl;
    Test another;
    return 0;
} 
```

代码没有通过复制或运算符 = 使用构造函数，所以我真的不明白它是如何工作的......我使用了 gcc 4.7.0

感谢您的帮助:)

杰罗姆

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-11T12:41:27.160

格式语义：

```
Test other = toto(); 
```

涉及多个副本（但没有分配）。但是，允许编译器省略所有不同的实例，这会消除副本；几乎所有的编译器都会做这种优化。

更具体地说，标准没有指定类类型值的返回位置，但通常的解决方案是调用者分配空间，并将指向它的隐藏指针传递给函数。没有上面提到的优化：

```
Test
toto()
{
    Test t;
    return t;
} 
```

将导致`t`构造局部变量，然后 return 语句将复制`t`到隐藏指针指向的空间中。这里的优化（称为命名返回值优化，或 NRVO）导致编译器使用隐藏指针指向的空间 for ，而不是在本地`t`创建一个单独的。`t`（显然，当它这样做时，它不会*破坏*，`t`因为它会在复制之后。）

在声明中：

```
Test t = toto(); 
```

，形式语义将让编译器为 Test 类型的临时分配空间，将此空间的地址作为隐藏指针传递给`toto`，然后将此临时复制到`t`并销毁它。这里的优化在于编译器将地址 `t`直接传递给`toto`，省略中间临时地址。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-11T12:35:46.357

看看[返回值优化](http://www.parashift.com/c++-faq-lite/ctors.html#faq-10.9)，这是一种避免构造函数调用的常见优化。

# c - 如何使用 GNU hcreate_r

> ID：10551366
> 
> 赞同：4
> 
> 时间：2012-05-11T12:30:57.550
> 
> 标签：c, gnu

```
#include <stdio.h>
#include <stdlib.h>
#include <search.h>
#include <assert.h>

char *data[] = { "alpha", "bravo", "charlie", "delta",
      "echo", "foxtrot", "golf", "hotel", "india", "juliet",
      "kilo", "lima", "mike", "november", "oscar", "papa",
      "quebec", "romeo", "sierra", "tango", "uniform",
      "victor", "whisky", "x-ray", "yankee", "zulu"
       };

int
main(void)
{
    ENTRY e, **ep;
    struct hsearch_data *htab;
    int i;
    int resultOfHcreate_r;
    resultOfHcreate_r=hcreate_r(30,htab);
    assert(resultOfHcreate_r!=0);
    hdestroy_r(htab);
    exit(EXIT_SUCCESS);
} 
```

错误`hcreate_r`

这个怎么用`hcreate_r`？

另一个问题是：

您能否提供 GNU 扩展 C 库示例？我认为GNU扩展C库的文档知识不够写。

我有很多关于如何使用扩展 C 库的问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T14:52:05.737

首先，您需要添加`#define _GNU_SOURCE`宏才能正确访问 GNU 扩展。IE：

```
#define _GNU_SOURCE
#include <search.h> 
```

然后你需要了解文档：

 **> 功能： int hcreate_r (size_t nel, struct hsearch_data *htab)
> 
> ```
> The hcreate_r function initializes the object pointed to by htab to contain a 
> hashing table with at least nel elements. So this
> function is equivalent to the hcreate function except that the
> initialized data structure is controlled by the user.
> 
> This allows having more than one hashing table at one time. 
> The memory necessary for the struct hsearch_data object can be allocated
> dynamically. It must be initialized with zero before calling this
> function.
> 
> The return value is non-zero if the operation was successful. 
> If the return value is zero, something went wrong, which probably means
> the programs ran out of memory. 
> ```* 

 *因此，与 不同的是`hcreate`，*您*提供的是散列表数据结构。此外，这些结构应初始化为零。那么你可能想做这样的事情：*

 *```
//dynamically create a single table of 30 elements 
htab=calloc(1,sizeof(struct hsearch_data));
resultOfHcreate_r=hcreate_r(30,htab);

//do some stuff

//dispose of the hash table and free heap memory
hdestroy_r(htab);
free(htab) 
```**

# vb.net - 从 .NET 通用处理程序流式传输 PDF 文件会生成 Adob e Reader 损坏错误

> ID：10551368
> 
> 赞同：0
> 
> 时间：2012-05-11T12:31:01.763
> 
> 标签：vb.net, pdf, stream, httphandler

我有一个通用处理程序，它提供文件以供下载：

```
 Dim request As HttpRequest = context.Request
    Dim response As HttpResponse = context.Response
    response.ContentType = "application/octet-stream"
    response.AddHeader("content-disposition", "inline; filename=" & filename)
    response.Buffer = True
    response.OutputStream.Write(fileBytes, 0, fileBytes.Length)
    response.Flush()
    response.Close() 
```

（'fileBites' 是我的咬合数组，'filename' 是我的文件名）。

例如，当 fileBites 是一个 .txt 文件时 - 下载被触发并且文件被完美读取。

但是，我发现 .pdf 和 .docx 文件已损坏 - 对于 .docx，Word 说需要恢复该文件并请求我允许这样做。当我授予此权限时，它立即修复并完美显示。

显然我不希望用户看到这个腐败对话，经过一段时间的研究，我发现了这个：[http](http://forums.asp.net/t/1301978.aspx/1/10) ://forums.asp.net/t/1301978.aspx/1/10 - 这表明了腐败的原因是否在字节数组的末尾写入了一个额外的空位：我通过将长度减少一位来检查：

response.OutputStream.Write(fileBytes, 0, fileBytes.Length - 1)

就像魔术一样，.docx 下载现在可以工作了！（这不是我当前的问题，我将其包含在上下文中，以防其他人有同样的问题）

我目前的问题是，虽然 .docx 文件现在可以正确流式传输，但 .pdf 文件却没有。它们似乎是一块传输（以正确的 KB 大小），但是当我尝试打开下载的文件时，Adobe Reader X 告诉我：

```
Adobe Reader could not open xxxx because it is either not a supported file type 
or because the file has been damaged (for example, it was sent as an email 
attachment and wasn't correctly decoded). 
```

[在 2008 年的 adobe 论坛 ( http://forums.adobe.com/thread/391712](http://forums.adobe.com/thread/391712) )上进行了相当长的未解决讨论，解决了这个确切的问题，但现在已经死了。我已经尝试了用户发布的所有解决方法（内容类型：/pdf 不是 /octet，处置：应用程序不是内联，不同的内容编码和字符集等），但都无济于事。

我想知道在此之前是否有人遇到过这个问题，可以指出我在某个地方模糊地近似于一些甚至与正确方向相似的东西！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-01-26T22:27:59.753

（在评论和编辑中回答。请参阅[没有答案的问题，但问题已在评论中解决（或在聊天中扩展）](https://meta.stackoverflow.com/questions/251597/question-with-no-answers-but-issue-solved-in-the-comments)）

OP写道：

> 盯着它看了好几个小时，在发布这个问题后不久答案就出现了——这经常是这样！无论如何，以下是解决我的具体问题的其他人的解决方案：

当我将一个文件添加到数据库中时，我也允许它被重命名。我会选择一个文件，给它一个名称并将其存储在数据库中`[Fileblob],[Filename]`- 我假设我可以选择任何任意名称，因为它不再与文件系统中的特定位置相关联。- 错误的！- 使用 .txt 和 .docx 文件，这很好，原始名称从未被调用。

显然，某些东西在保存时将文件的名称嵌入到二进制对象中，并检查内容处置中提供的名称与打开时嵌入到文档中的名称。如果它们不匹配，则会引发损坏错误。

现在，我将文件存储在数据库中，`[Fileblob],[Filename],[originalFilename]`并在打开它时使用：

```
response.AddHeader("content-disposition", "inline;filename=" & originalFilename) 
```

> ..给它一个它理解的名字。我想更优雅的方法是在将 PDF 存储在数据库中时从 PDF 中删除原始名称，因为它不再需要，但作为一种解决方法，这很好。

# css - 不知道宽度和数量时如何使用 CSS 均匀分布菜单项？

> ID：10551369
> 
> 赞同：10
> 
> 时间：2012-05-11T12:31:13.267
> 
> 标签：css, menu, tabs, distributed

我已经阅读了很多关于使用 css 均匀分布元素的内容，但我发现的每个解决方案都要求您了解并定义要分布的元素的宽度和/或数量。

我有一个固定宽度的容器 - 这里可以是任意数量的自动宽度的 li 元素，这些元素需要从左到右均匀分布在父元素上。

这是我的标记 - 除了可以有任意数量的标签，其中包含任意长度的文本。

```
<ul class="tabs">
     <li class="tab active" id="tab-1"><span class="tab-title">Tab 1</span></li>
     <li class="tab " id="tab-2"><span class="tab-title">Tab 2</span></li>
     <li class="tab " id="tab-3"><span class="tab-title">Tab 3</span></li>
     <li class="tab " id="tab-4"><span class="tab-title">Tab 4</span></li>
</ul> 
```

因此，当元素的数量和宽度是动态的时，使用 css 进行均匀分布 - 可以做到吗？

这似乎是一件显而易见的事情——该死的 CSS！

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-05-11T12:34:39.550

为此，您可以使用 CSS`display:table-cell`属性。写这个：

```
.tabs {
  display: table;
  width: 300px;
  border: 1px solid green;
}

.tabs li {
  display: table-cell;
  border: 1px solid red;
  height: 40px;
} 
```

检查这个[JSFiddle](http://jsfiddle.net/px7Uf/)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2016-01-04T14:42:45.000

这是一个使用 flexbox 在内容溢出分配的单元格宽度时保持均匀宽度的解决方案：

```
ul.tabs {
  display: flex;
  flex-wrap: nowrap;
  align-items: stretch;
  list-style-type: none;
  margin: 0;
  padding: 0;
}

ul.tabs>li.tab {
  flex: 1;
  text-align: center;
  /* just adding visibility to the tabs */
  border: 1px solid rgba(0,0,0,.12); 
  padding: 10px;
}
```

```
<ul class="tabs">
     <li class="tab active" id="tab-1"><span class="tab-title">Tab 1</span></li>
     <li class="tab " id="tab-2"><span class="tab-title">Tab 2</span></li>
     <li class="tab " id="tab-3"><span class="tab-title">Tab 3\. This is a very long tab and should overflow...</span></li>
     <li class="tab " id="tab-4"><span class="tab-title">Tab 4</span></li>
</ul>
```

# asp.net - 使会话持续更长时间

> ID：10551371
> 
> 赞同：2
> 
> 时间：2012-05-11T12:31:16.477
> 
> 标签：asp.net, session

在我的 web.config 我有这个：

```
<sessionState timeout="70"/> 
```

但是，5 分钟后我的会话为空，我的程序崩溃了。如何让这个时间更长？

这是我初始化它的方式：

```
Session["mySession"] = "blah blah"; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T13:45:11.857

像这样修改超时：

```
HttpContext.Current.Session.Timeout = 200000 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T12:40:33.150

检查应用程序池超时[http://technet.microsoft.com/nl-nl/library/cc771956%28v=ws.10%29.aspx](http://technet.microsoft.com/nl-nl/library/cc771956%28v=ws.10%29.aspx)

使用表单身份验证？它有自己的超时/

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-12-07T15:48:53.947

您放入 Web.Config 的时间

`<sessionState timeout="60"/>`（分分钟）

影响到

```
HttpContext.Current.Session.Timeout = 60 
```

**或者**

```
 System.Web.HttpContext.Current.Session.Timeout = 60 
```

# php - 确定使用过 parent::__construct() 的子类；

> ID：10551373
> 
> 赞同：0
> 
> 时间：2012-05-11T12:31:35.197
> 
> 标签：php, oop

我有一种情况，我需要将子类的名称传递回父类才能采取一些措施。

我目前设置的方式是：

```
class SomeParentClass {

    public function __construct($c = false){
        ...
    }

}

class SomeChildClass extends SomeParentClass {

    public function __construct(){
        parent::__construct(__CLASS__){
            ...
        }
    }

} 
```

这会将子类的名称传递回父类，但如果子类不这样做，则变量`$c`将保留 bool 值`false`。

它有效，有道理，但这是最干净的方法吗？有没有办法自动检测调用了哪个子类`parent::__construct()`而不将其作为变量传递？

非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T12:34:24.237

您可以使用PHP 5 中的 get_call_class() ( [http://php.net/manual/en/function.get-called-class.php ) 来完成此操作。](http://php.net/manual/en/function.get-called-class.php)

请参阅：[获取父类中子类的名称（静态上下文）](https://stackoverflow.com/questions/283004/getting-the-name-of-a-child-class-in-the-parent-class-static-context)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T12:39:18.690

```
<?php
class SomeParentClass {

    public function __construct($c = false){       
        echo get_called_class();
    }

}

class SomeChildClass extends SomeParentClass {

    public function __construct(){
        parent::__construct(__CLASS__);       
    }

}

class OtherChildClass extends SomeParentClass {
    public function __construct(){
        parent::__construct(__CLASS__);  
    }

}

$a = new SomeChildClass();
$b = new OtherChildClass(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-11T12:40:30.687

我可能是错的，但在正常情况下，父母不应该知道它的子类。我确信有更好的方法来做你想做的事情。

此“规则”的例外可能是暴露静态（可选最终）构造函数的基类，然后以子类为前缀调用这些构造函数，例如

```
class Parent
{
    public final static function create()
    {
        return new static;
    }
}

class Child extends Parent
{
    public function __construct()
    {
        // special code here
    }
}

var_dump(Child::create()); 
```

# sql - 如何提高 SQL 查询执行性能？

> ID：10551374
> 
> 赞同：1
> 
> 时间：2012-05-11T12:31:35.513
> 
> 标签：sql

查询一：

```
select a.*
from 
   (
   select 
row_number() over (order by id desc) as srno
id,name as myname,*
   from table
where name like 'search%' or column1 like 'search%' or column2 like 'search%'
or column3 like 'search%'
or column4 like 'search%'
or column5 like 'search%'
   ) a
where srno>=1 and srno<=50 
```

我的桌子上有 100 000 行。此查询执行需要 48 秒。我已经应用了备用查询：

查询 2：

```
 select top 50
row_number() over (order by id desc) as srno
id,name as myname,*
   from table
where name like 'search%' or column1 like 'search%' or column2 like 'search%'
or column3 like 'search%'
or column4 like 'search%'
or column5 like 'search%' 
```

查询 2 执行大约需要 0 秒 有索引 一切就绪 在两种情况下都应用

有什么方法可以在 0 秒内执行查询 1 吗？

我想实时执行速度。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T13:29:11.883

我认为这里不需要使用分析功能`ROW_NUMBER()`。您的行可以由 标识，`id` 您可能正在使用`srn`only 将结果限制为 50 行。所以，你可以简单地这样做：

```
SELECT TOP (50)
      id
    , name AS myname 
    , *
FROM  table
WHERE name LIKE 'search%' 
   OR column1 LIKE 'search%' 
   OR column2 LIKE 'search%'
   OR column3 LIKE 'search%'
   OR column4 LIKE 'search%'
   OR column5 LIKE 'search%'
ORDER BY id DESC 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T12:39:14.040

不。

在第二个查询中，当您有 50 条记录时，您就完成了。在第一个查询中，您检查所有 100.000 条记录，然后仅检索前 50 条。

现在，如果您只想检查前 50 条记录，请尝试以下操作：

```
select a.*
from 
   (
   select 
row_number() over (order by id desc) as srno
id,name as myname,*
   from table
   ) a
where srno>=1 and srno<=5
and (a.name like 'search%'
 or a.column1 like 'search%'
 or a.column2 like 'search%'
 or a.column3 like 'search%'
 or a.column4 like 'search%'
 or a.column5 like 'search%') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T12:48:26.690

连接列值，然后应用 LIKE 运算符来查找值。

```
SELECT a.* 
FROM   (SELECT Row_number() OVER (ORDER BY id DESC) AS srno, 
               id, 
               name                                 AS myname, 
               * 
        FROM   mytable) a 
WHERE  ( Isnull(a.name, '') + Isnull(a.column1, '') + Isnull(a.column2, '') + 
                  Isnull(a.column3, '') + Isnull(a.column4, '') + 
       Isnull(a.column5, '') ) LIKE 'search%' 
       AND srno >= 1 
       AND srno <= 50 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-11T12:37:54.947

好吧，对于所有这些正则表达式和那么多行，您无能为力来改进它。我会说放置一些全文搜索字段，或者可能清理您的输入，以便所有具有该类型正则表达式的数据进入不同的表。无论如何，如果您的表要继续增长，那么正则表达式会非常慢，不要期望很快会有很多性能。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-11T12:41:10.530

在我看来，您在两种情况下都得到了相同的结果集。

在第一条语句中，您正在搜索整个表，然后进行过滤。第二条语句在到达前 50 条记录时才停止，这仅是因为它更快是合理的。和第二个一起去吧。

# c - 限制用户停止 Windows 服务

> ID：10551377
> 
> 赞同：-1
> 
> 时间：2012-05-11T12:31:39.133
> 
> 标签：c, windows, winapi, service

我参与编写 Windows 服务。在我开始写之前，我想知道

1.  LOGIN USERS 有哪些需要考虑的点，具体如何限制其他用户“停止服务”？
2.  在编写服务时我应该考虑哪些一般要点？
3.  一旦用户尝试停止服务，我如何显示警告警报？

注意：我正在尝试用 C 编写服务。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T14:40:24.637

1.  普通用户将无法停止服务。它需要管理权限。
2.  您不能做任何涉及写入屏幕或读取键盘/鼠标的事情。
3.  您将需要编写一个位于后台（隐藏窗口）并通过某种进程间通信方法（RPC/套接字等）与服务通信的应用程序。 **此**应用程序将从显示消息框或以其他方式与用户通信的服务接收消息。

我会尝试用 C# 编写代码（用于服务和应用程序），因为大部分艰苦的工作（向 SCM 注册、启动/停止等）已经为您完成。

# jquery - 如何使用 jquery 使图像在圆形路径中移动？

> ID：10551380
> 
> 赞同：8
> 
> 时间：2012-05-11T12:31:54.887
> 
> 标签：jquery

在这里，我试图让图像在圆形路径中移动，但它没有在圆形路径中移动..我试过这样[慢慢移动图片](https://stackoverflow.com/questions/5915622/moving-a-picture-around-slowly)

CSS

```
#friends { position: absolute; } 
```

标记

```
<img src="http://jsfiddle.net/img/logo.png" 
id="friends"/> 
```

JS

```
function moveit() {

    var newTop = Math.floor(Math.random()*350);
    var newLeft = Math.floor(Math.random()*1024);
    var newDuration = Math.floor(Math.random()*5000);

    $('#friends').animate({
      top: newTop,
      left: newLeft,
      }, newDuration, function() {
        moveit();
      });

}

$(document).ready(function() {
    moveit();
}); 
```

现场演示：http: [//jsfiddle.net/W69s6/embedded/result/](http://jsfiddle.net/W69s6/embedded/result/)

有什么建议吗？？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-11T12:45:00.840

另一个变体（基于[Div 使用 Javascript 在循环旋转中移动](https://stackoverflow.com/questions/842789/div-moving-in-cycle-rotation-using-javascript)）：

```
var t = 0;

function moveit() {
    t += 0.05;

    var r = 100;         // radius
    var xcenter = 100;   // center X position
    var ycenter = 100;   // center Y position

    var newLeft = Math.floor(xcenter + (r * Math.cos(t)));
    var newTop = Math.floor(ycenter + (r * Math.sin(t)));

    $('#friends').animate({
        top: newTop,
        left: newLeft,
    }, 1, function() {
        moveit();
    });
}

$(document).ready(function() {
    moveit();
});​ 
```

**DEMO:** [http://jsfiddle.net/W69s6/20/](http://jsfiddle.net/W69s6/20/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-11T12:39:41.427

使用 Animate 试试这个：

```
function animateCircle(id, speed, radius, startx, starty, phi) {  
    if (!phi) { phi = 0 };
    var int = 2 * (Math.PI) / speed;
    phi = (phi >= 2 * (Math.PI)) ? 0 : (phi + int);
    var $m = startx - radius * Math.cos(phi);
    var $n = starty - radius * Math.sin(phi);

    $("#friends").animate({
        marginLeft: $m + 'px',
        marginTop: $n + 'px'
      }, 1, function() { 
             animateCircle.call(this, id, speed, radius, startx, starty, phi) 
          }
    );

}; 
```

您可以`div`像这样调用函数：

```
animateCircle('#friends', 100, 100, 400, 250); 
```

**演示**：http: [//jsfiddle.net/W69s6/18/](http://jsfiddle.net/W69s6/18/)

**演示 2**：http: [//jsfiddle.net/W69s6/34/](http://jsfiddle.net/W69s6/34/)

改编自[这里](http://tadhg.com/wp/2007/02/19/animating-circles-with-javascript/)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-11T12:35:14.167

看看这个很棒的插件[jQuery.path](http://weepy.github.com/jquery.path/) :)

# django - 是否有一种自动方法来查找分页列表中的哪个页面包含特定对象？

> ID：10551381
> 
> 赞同：0
> 
> 时间：2012-05-11T12:32:02.853
> 
> 标签：django, pagination

用户创建新对象后，我想将它们重定向回对象的分页列表。重要的是，我想将它们发送到显示新创建对象的列表页面（以便我可以突出显示它）。

有没有一种内置在 Django 或库中的好方法？

[MySql 分页结果，找到特定结果的“页面”](https://stackoverflow.com/questions/9086719/mysql-paginated-results-find-page-for-specific-result)是相关的，但我正在寻找 Django 应用程序的最佳实践。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T14:57:43.287

没有“自动化”的方式，因为对象本身并没有与“页面”的概念相关联。此外，查询集的顺序是可变的，因此特定对象的页码也是可变的。但是，您可以很容易地将该答案适应 Django 的 DBAPI，本质上是：

```
MyModel.objects.filter(my_order_by_field__lt=my_instance.my_order_by_field).count() 
```

然后，只需将其除以每页的项目：

```
page_number = count / items_per_page 
```

由于 Python 的`/`运算符在处理整数时已经落地，因此您无需执行任何其他操作。

# dynamics-crm - CRM 2011 工作流程中的活动应该只有一个所有者方

> ID：10551382
> 
> 赞同：4
> 
> 时间：2012-05-11T12:32:13.533
> 
> 标签：dynamics-crm, dynamics-crm-2011, crm, dynamics-crm-4, dynamics-crm-online

我在 CRM 2011 中创建了一个系统工作流，以便在创建活动时将记录分配给团队，如下图所示。

![在此处输入图像描述](../Images/0ee17561d6120d4749163709718be4e8.png)

当工作流触发时，它不会将记录分配给团队，而是给出错误**"Invalid Argument"**。在错误详细信息中，错误消息是**“活动应该只有一个所有者方”**，如下图所示。

![在此处输入图像描述](../Images/8baf63e0f6c2a96f1f962d6fda486841.png)

如何解决这个问题..？我们如何将记录分配给 Team..？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-13T12:30:12.007

据我所知，解决方案有点复杂。首先是执行以下查询：

```
select subject
                , RegardingObjectIdName
                , statecodename
                , owneridname
                , Activitytypecodename
                , CreatedOn
from filteredactivitypointer ap
where not exists(select *
                      from filteredactivityparty ay
                      where ap.activityid=ay.activityid
                       and ay.participationtypemaskname = 'Owner') 
```

此查询应产生没有将所有者定义为活动方的所有活动。在此之后，我选择了所有主题并使用高级查找查询删除了所有这些无效的活动。

接下来是查找定义了多个所有者类型的活动方的所有活动。

```
select subject
                , RegardingObjectIdName
                , statecodename
                , owneridname
                , Activitytypecodename
                , CreatedOn
from filteredactivitypointer ap
where (select COUNT(1)
                      from filteredactivityparty ay
                      where ap.activityid=ay.activityid
                       and ay.participationtypemaskname = 'Owner') > 1 
```

这些应该只用一个所有者来更正（直接在数据库中，或者通过使用重新分配）。

该线程有所帮助：[http ://social.microsoft.com/Forums/en-US/6f67ffaa-7162-4030-b2ee-af23af6b4cf5/error-when-assigning-certain-record-in-crm-error-there-should- be-only-one-owner-party-for-an?forum=crm](http://social.microsoft.com/Forums/en-US/6f67ffaa-7162-4030-b2ee-af23af6b4cf5/error-when-assigning-certain-record-in-crm-error-there-should-be-only-one-owner-party-for-an?forum=crm)即使是用于 CRM 4.0，它也适用于 2011 年。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-05-22T07:03:13.177

可能是在创建记录时，它必须有某个所有者，但同时触发了 WF 并尝试将此记录分配给其他人，因为到目前为止还没有设置记录的所有者。

那么，当这条记录没有设置所有者时，如何分配这条记录呢？

可能这就是问题所在。

为了摆脱这种情况，让工作流等待 1 分钟，然后将记录分配给其他人。这可以以非常简单的方式解决这个问题..:)

谢谢，

阿尼什

# asp.net-mvc - 在 MVC AuthorizeAttribute 之前执行自定义 Attribute 中的代码

> ID：10551383
> 
> 赞同：0
> 
> 时间：2012-05-11T12:32:15.190
> 
> 标签：asp.net-mvc, authentication, action-filter

**问题**
创建一个`IAuthorizeAttribute`将在默认 MVC AuthorizeAttribute 之前执行的自定义。默认 AuthorizeAttribute 似乎总是在我的自定义属性之前运行。

**我尝试过的事情**

*   我创建了一个继承自 IAuthorizationFilter 的自定义属性。
*   我已经将此属性注册为全局过滤器，如下所示：
    `filters.Add(new HandleCrossDomainAuthenticationAttribute() { Order = 1 });`
*   我已经阅读了有关 msdn 上的操作过滤器：http: [//msdn.microsoft.com/en-us/library/dd381609.aspx](http://msdn.microsoft.com/en-us/library/dd381609.aspx)

**自定义属性**

```
public class HandleCrossDomainAuthenticationAttribute : FilterAttribute, IAuthorizationFilter
{
    #region IAuthorizationFilter Members

    void IAuthorizationFilter.OnAuthorization(AuthorizationContext filterContext)
    {
        if (filterContext == null)
        {
            throw new ArgumentNullException("filterContext");
        }

        if (!filterContext.HttpContext.User.Identity.IsAuthenticated)
        {
            tryCrossDomainAuthentication(filterContext); //this will set the filterContext.Result to a certain url
        }
    }

    #endregion
} 
```

**其他观察**
当我指定一个让我很难过`Order = 2`的事情时，它确实有效。`AuthorizeAttribute`但这不是一个非常易于管理的方法......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T13:17:13.593

我一定是按照我想要的方式阅读了 msdn 文章......

> Order 属性采用一个整数值，该整数值必须为 0（默认值）或更大，但有一个例外。省略 Order 属性会为过滤器提供 -1 的顺序值，这表示未指定的顺序。范围内其 Order 属性设置为 -1 的任何操作过滤器都将以未确定的顺序执行，**但在具有指定 order 的过滤器*之前***执行。

`AuthorizeAttribute`因此，阅读本文，除非您编写 custom或 custom ，否则似乎不可能做我想做的事`ControllerActionInvoker`。真是糟透了！

# heroku - Heroku：可以关闭自定义错误页面吗？

> ID：10551393
> 
> 赞同：1
> 
> 时间：2012-05-11T12:33:00.533
> 
> 标签：heroku

我刚刚将一个 Node.js 站点（基于 Express 构建）迁移到 Heroku，我看到在应用程序错误的情况下，Heroku 显示其自定义错误页面，而不是我的应用程序返回的任何内容。

我不希望它这样做，因为 Express 已经提供[了一种机制](http://expressjs.com/guide.html#error-handling)来做到这一点，而我的应用程序就是这样做的。是否可以告诉 Heroku 使用我的应用返回的任何内容？

我更喜欢这个的一个例子是因为我的应用程序的错误页面可以正确显示登录或注销状态，而静态页面（例如在 S3 上）无法做到这一点。另一个例子是我的应用程序实际上根据精确的 5xx 状态码显示不同的页面，而 Heroku 将所有 5xx 码视为相同。

***编辑：**想到另一个特别值得注意的例子：我们的应用程序为每个错误实例创建唯一的 ID，并在错误页面上向用户显示该 ID，以便如果/当他们联系我们时，我们可以在我们的日志。不能用静态页面做到这一点。*

我意识到 Heroku 只通过状态码检测错误，所以我可以在出现错误的情况下发回 200。但这似乎是错误的——例如，在 404 的情况下，您不会发送 200。（想想看，Heroku 上的 REST API 如何返回 5xx 的 JSON？希望 Heroku 的自定义错误页面只覆盖 HTML 响应？）

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T13:29:44.513

要直接回答问题 - 不，您不能关闭 Heroku 错误页面……</p>

Heroku 处理的错误是您的应用程序没有处理的错误，因此如果您的应用程序捕获错误并返回一个页面，那么 Heroku 不会干预。

我有很多应用程序，当然不是 Node，可以做到这一点。

# html - 如何移动 CSS 生成的箭头？

> ID：10551394
> 
> 赞同：1
> 
> 时间：2012-05-11T12:33:03.407
> 
> 标签：html, css

[http://cssarrowplease.com/](http://cssarrowplease.com/)

如果我去那里，你会在盒子的顶部中间看到箭头。

如何使箭头位于顶部，但 25%（从左侧）而不是中间？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T12:38:00.720

```
.arrow_box::before {
border-bottom-color: #C2E1F5;
border-width: 36px;
left: 25%;
margin-left: -36px;
}

.arrow_box::after {
border-bottom-color: #88B7D5;
border-width: 30px;
left: 25%;
margin-left: -30px;
} 
```

# c# - 实体容器“MyEntities”中未定义实体集或函数导入 tblUser。近乎简单的标识符

> ID：10551395
> 
> 赞同：0
> 
> 时间：2012-05-11T12:33:03.660
> 
> 标签：c#, wcf, entity-framework, windows-phone-7

```
public string LoginUser(string email, string password)
    {
        string query = @"SELECT VALUE tblUser FROM MyEntities.tblUser AS tblUser WHERE tblUser.email = @email AND tblUser.password = @password";
        ObjectParameter[] parameters = new ObjectParameter[2];
        parameters[0] = new ObjectParameter("email", email);
        parameters[1] = new ObjectParameter("password", password);

        using (var context = new MyEntities())
        {
            ObjectQuery<string> results = context.CreateQuery<string>(query, parameters);
            foreach (string result in results)
            {
                if (result != null)
                {
                    return result;
                }
            }
        }
        return null;
    } 
```

我仔细检查了我的代码，实体查询本身没有问题，但我不知道为什么它会给我标题的消息并且无法加载数据。这是 WCF 部分并从 SQL Azure 调用数据。通过使用电话。任何人都可以给我一个关于如何解决它的提示，而我花了几个小时仍然无法克服这个问题。谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T12:41:12.390

我怀疑，您的模型没有名为 tblUser 的实体。数据库表名和实体名可能不相同。例如; 如果您使用具有默认设置的模型优先方法；数据库中的表名是用“set”或“s”后缀生成的。

# asp.net-mvc-3 - 简单的菜单生成器 MVC3

> ID：10551398
> 
> 赞同：-1
> 
> 时间：2012-05-11T12:33:07.820
> 
> 标签：asp.net-mvc-3

我在 ASP.NET MVC 3 方面相对较新。在过去的几个月里，我正在研究简单的投资组合网站。
经过艰苦的工作和学习 MVC 3，我建立了带有后端的站点，用于填充我的站点内容。一切正常，我对框架印象深刻。

我的下一步将是升级我的网站以执行一些基本的 CMS 功能。首先，我想创建后端页面以创建具有空索引操作的简单控制器。我想用简单的网络界面来做到这一点。是否有此类示例的博客文章或简单代码。

另外我想知道如何创建这样的功能，每一个提示都会受到欢迎。

提前致谢，

亚历克斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T13:28:14.873

嗯，很难理解你需要什么？您不要动态创建动态 html 页面。好的，您可以创建动态控制器，甚至为它注册路由，但是您将如何为它制作内容？

也许您只需要一个控制器，html 页面上的重定向取决于您的规则？

# asp.net - MaskedEditExtender 的问题

> ID：10551400
> 
> 赞同：1
> 
> 时间：2012-05-11T12:33:11.080
> 
> 标签：asp.net, c#-4.0, ajaxcontroltoolkit, maskededitextender, maskededitvalidator

我正在为 .Net 4.0 使用 AjaxControlToolkit

我有一个带有文本框的表单，它以 MM/DD/YYYY HH:MM 格式显示/接受日期和时间，即具有 24 小时时间格式的美国日期格式。

我已将 TextBox 与 MaskedEditExtender 和 MaskedEditValidator 一起使用。请看下面的代码——

```
<p>
        First Date Time : 
        <asp:TextBox ID="txtDateTime1" runat="server"></asp:TextBox>
        <asp:MaskedEditExtender ID="mskDateTime1" runat="server" 
            Mask="99/99/9999 99:99" MaskType="DateTime" TargetControlID="txtDateTime1" 
            UserTimeFormat="TwentyFourHour">
        </asp:MaskedEditExtender>
        <asp:MaskedEditValidator ID="mskValDateTime1" runat="server" 
            ControlExtender="mskDateTime1" ControlToValidate="txtDateTime1" 
            IsValidEmpty="False"></asp:MaskedEditValidator>
    </p>

    <p>
        Second Date Time : 
        <asp:TextBox ID="txtDateTime2" runat="server"></asp:TextBox>
        <asp:MaskedEditExtender ID="mskDateTime2" runat="server" 
            Mask="99/99/9999 99:99" MaskType="DateTime" TargetControlID="txtDateTime2" 
            UserTimeFormat="TwentyFourHour">
        </asp:MaskedEditExtender>
        <asp:MaskedEditValidator ID="mskValDateTime2" runat="server" 
            ControlExtender="mskDateTime2" ControlToValidate="txtDateTime2" 
            IsValidEmpty="False"></asp:MaskedEditValidator>
    </p> 
```

为了以上述格式显示日期，我在 ToString() 中使用格式，如下所示 -

```
protected void Page_Load(object sender, EventArgs e)
        {
            txtDateTime1.Text = DateTime.Now.ToString("MM/dd/yyyy HH:mm");
            txtDateTime2.Text = DateTime.Now.ToString("MM/dd/yyyy HH:mm");
        } 
```

日期和时间显示正确，但当焦点离开文本框时，时间会发生变化。

我不知道为什么会这样。

请看以下截图——

A) 原本 ![软件天才公司](../Images/f75c568355a0eff4b02774f0241f0c34.png)

B) 聚焦后改变 ![软件天才公司](../Images/24399aed65b4098d2a9c821b2710184b.png)

谁能帮我解决这个问题。

如果有的话，请提供更好的想法。

感谢您分享您的智慧。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T11:17:03.263

最后，我已经回答了我自己的问题，因为没有收到开发人员的任何回复。我发现这实际上是 MaskEditExtender 的一个问题。你可以查看[这个讨论](http://forums.asp.net/t/1086284.aspx/1)。

# asp.net - 给定查询的休眠条件？

> ID：10551403
> 
> 赞同：-2
> 
> 时间：2012-05-11T12:33:16.133
> 
> 标签：asp.net, nhibernate

我正在尝试为以下查询创建 Nhibernate 标准，但没有得到正确的想法。请指导

```
SELECT PEH.ResponseStatus FROM PatientEligibilityHistory PEH WHERE PEH.PatientId = " + patientId + " AND PEH.PayorId = " + payorId  + " AND PEH.DateOfService = '" + dateOfService + "' AND PEH.Insured_Id = '" + insuredId + "' HAVING PEH.ResponseDateTime = MAX(PEH.ResponseDateTime) 
```

我无法理解如何为使用 max 的子句创建标准。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T12:54:59.303

you need a correlated subquery

```
DetachedCriteria query = DetachedCriteria.For<PatientEligibilityHistory>()
    .Add(Expression.In("PatientId", patientList))
    .Add(Expression.In("PatientCaseId", patientCaseList))
    .Add(Expression.In("PayorId", payorList))
    .Add(Expression.In("InsuredId", insuredList));

DetachedCriteria subquery = CriteriaTransformer.Clone(query).SetProjection(Projections.Max("ResponseDateTime"));

ICriteria criteria = query.GetExecutableCriteria(session)
    .Add(Subquery.Eq("ResponseDateTime", subquery));
    .SetProjection(Projections.Max("ResponseStatus")); 
```

# algorithm - 删除自然数第 k 遍中的每个 (k+1) 个剩余元素

> ID：10551404
> 
> 赞同：4
> 
> 时间：2012-05-11T12:33:17.590
> 
> 标签：algorithm, math, sieve, number-sequence

在自然数系列中，我们必须在第一遍中删除每个第二个元素。然后在剩余的元素中，删除第二遍中的每个第 3 个元素。然后在第 K 次通过时，从剩余元素中删除每个第 (k+1) 个元素。

这个系列会这样

```
1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, ... 
```

第一次通过后（删除每个第二个元素后），

```
1, 3, 5, 7, 9, 11, 13, 15, 17, 19, 21, 23, 25, 27, 29, ... 
```

在第二遍之后，（在删除每个第三个元素之后），

```
1, 3, 7, 9, 13, 15, 19, 21, 25, 27, ... 
```

第 3 遍后，（每删除第 4 个元素后），

```
1, 3, 13, 15, 19, 25, 27, ... 
```

所以，在无限通过之后，它会变成

```
1, 3, 7, 13, 19, 27, 39, 49, 63, 79, ... 
```

该系列也称为 Flavius-Josephus 筛。

解决方案是找到系列中的第 6 个元素：

*   做 6^2 = 36
*   下降到 5 的倍数，得到 35
*   然后下降到 4 = 32 的倍数
*   然后下降到 3 = 30 的倍数
*   然后下降到 2 = 28 的倍数
*   然后下降到 1 = 27 的倍数
*   所以第六个幸运数字是27。

虽然它有效，但我不明白解决方案是如何工作的？

交流计划是，

```
int calc(int n)
{
   if (n == 1) return 1;
   return calc_rec(n*n, n-1);
}

int calc_rec(int nu, int level)
{
   int tmp;
   if (level == 1) return (nu-1);
   tmp = nu % level;
   return calc_rec(nu - (tmp ? tmp : level), level-1);
} 
```

解释此[http://oeis.org/A000960的链接](http://oeis.org/A000960)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T13:58:04.377

这不能回答你的问题，但这里是一种更直观的算法的推导，用于计算同样快的流的任意元素。

让我们将包含所有整数的初始序列称为 S[0]，然后将 S[1] 称为第一遍之后的序列，S[2] 称为第二遍之后的序列，依此类推。

在系列 S[0] 上，第 N 个整数（从零开始索引）是 N + 1。

```
1 2 3 4 5 6 7 8 9 10 ... 
```

在系列 S[1] 上，第 N 个整数是通过访问 S[0] 中的第 (2N) 个元素获得的。注 2N = N+(N div 1)。'div' 是整数除法，即丢弃余数的除法。

```
1 3 5 7 9 11 13 15 17 ... 
```

在系列 S[2] 上，第 N 个整数是通过访问 S[1] 中的第 N+(N div 2) 个元素获得的。

```
1 3 7 9 13 15 19 21 ... 
```

在序列 S[3] 上，第 N 个整数是通过从 S[2] 访问第 N+(N div 3) 个元素获得的，依此类推。

```
1 3 7 13 15 19 ... 
```

因此，您得到以下递归过程：

```
get_number(int series, int N):
   if (series == 0):
      return N + 1
   else:
      return get_number(series - 1, N + floor(N / series)) 
```

但请注意，当 series > N 时， floor(N / series) 完全为零，因此您可以始终将其称为 get_number(N, N)。

例如，

```
get_number(5, 5) = get_number(4, 6) = get_number(3, 7) =
  get_number(2, 9) = get_number(1, 13) = get_number(0, 26) = 27. 
```

这显示了如何从流中获得“27”作为第 6 个（5 个但从零开始的索引）。

# ios - 您可以在 iphone 上录制视频/音频，同时播放单独的视频（可选音频）吗？

> ID：10551409
> 
> 赞同：5
> 
> 时间：2012-05-11T12:33:29.273
> 
> 标签：ios, objective-c, iphone, video

是否有任何`iOS`库`API`支持同时播放和录制多个视频？例如，`AVMutableVideo`合成接口是否支持这个？

任何人都可以提供代码外观的要点吗？有谁知道这是如何表现？例如，有没有办法估计可以同时播放/录制多少个给定质量的视频？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-24T20:32:44.280

AVFoundation 库支持硬件加速同时播放多达 4 个视频。解压缩是在 GPU 级别完成的，因此它在大多数情况下都表现得足够好。虽然不确定问题的记录部分。

# python - oath2回调时如何恢复flask.session对象

> ID：10551412
> 
> 赞同：3
> 
> 时间：2012-05-11T12:33:47.070
> 
> 标签：python, oauth-2.0, flask

我正在通过oauth2编写新浪微博客户端，为已经使用我自己网站帐户登录的当前用户添加身份验证，因为OAuth2使用重定向回调机制，似乎在这个例程之后，并且在回调视图处理程序中， flask.session 完全是一个新对象。因此我失去了当前用户的登录状态。

但是在同一个浏览器（比如Firefox）中添加一个新标签并访问我网站的主页（www.funfunsay.com），会话对象仍然存在！

所以同一个浏览器实例中有两个flask.session？？？

我写了一个非常简单的模块，除了我丢失了旧会话之外，它与新浪微博很好。

```
# -*- coding: utf-8 -*-

from flask import (Flask, render_template, current_app, request,
                   flash, url_for, redirect, session, g, abort)

# For import *
__all__ = ['create_app']

app = Flask(__name__)
app.config['DEBUG'] = True
app.secret_key = 'secret key'

@app.before_request
def before_request():
    print "before request:", session
    #<1st output>for first visit www.funfunsay.com, the output is: before request: <SecureCookieSession {}>
    #<3rd output>for callback from sina, the output is the same

@app.after_request
def after(response):
    print "after request:", session
    #<2nd output>for first visit www.funfunsay.com, the output is: after request: <SecureCookieSession {'testinfo': 'abc'}*>
    return response

@app.route('/')
def hello_world():
    print "request:", request
    login_uri = 'https://api.weibo.com/oauth2/authorize?redirect_uri=http%3A//funfunsay.com/connect/sina/callback&response_type=code&client_id=3921006605&display=default'

    session['testinfo'] = 'abc' #a key-value for test

    return redirect(login_uri)

@app.route("/connect/sina/callback")
def connect_sina_callback():
    print "connect_sina_callback: ", session
    #<4th output>will output: connect_sina_callback:  <SecureCookieSession {}>
    return 'Callback success!'

if __name__ == '__main__':
    app.run('0.0.0.0', 80) 
```

PS：出于测试目的，我在我的主机文件中添加了“127.0.0.1 www.funfunsay.com”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-12T17:45:45.683

只要保持域名的一致性。我的解决方案是始终使用“www.my-web-site.com”，如果用户输入“my-web-site.com”，将他们重定向到“www.my-web-site.com”。现在一切正常！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-08T00:24:50.650

Flask 为来自不同来源的每个请求分配一个新会话——因此即使地址解析为相同的 IP，来自不同起始点的每个请求也将被分配一个不同的会话。例如，启动的浏览器窗口`http://localhost:5000`将被分配与同一浏览器窗口中的选项卡不同的会话，该选项卡指向`http://127.0.0.1:5000`...，即使两者解析到相同的位置。

这可能令人沮丧，因为一个会话中的数据将无法在同一浏览器中的另一个选项卡中使用，正如您所期望的那样......虽然一个会话可能会在您浏览网站时愉快地存储您的所有数据，另一个会话选项卡将有一个空`session`变量。

在使用 OAuth 回调时，我发现这最棘手，因为我需要确保回调 URL（在您发送请求的服务器上定义，例如，当您使用数据提供者定义 OAuth 应用程序时）匹配所在的站点我正在发起我的请求。例如，如果我在 Github API 开发人员页面中的 OAuth 应用程序设置列出了回调 URL，因为`http://localhost:5000/callback`我无法将浏览器指向，`http://127.0.0.1:5000`因为回调将在新会话中启动，并且会话数据为空。

幸运的是，这很容易调试（至少在开发中`localhost`）：确保使用与在数据提供者的 OAuth 应用程序设置中定义回调 URL 相同的主机格式测试您的站点（当您在例如 Facebook、Twitter 或 Github OAuth API 面板）。

# c++ - 如何在 C++ 中从相机流式传输图像/数据

> ID：10551423
> 
> 赞同：4
> 
> 时间：2012-05-11T12:34:37.723
> 
> 标签：c++, image, camera, streaming

我的 PC 中插入了一个 USB 摄像头（使用 Windows 7），我正在尝试创建一个程序来流式传输来自摄像头的图像。

我该怎么做呢？我有摄像机的 VID 和 PID，但对它一无所知。请帮忙。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T12:47:15.173

[如果你可以使用 OpenCV，这里](http://opencv.willowgarage.com/wiki/CameraCapture)有一个很好的例子

```
 #include "cv.h" 
 #include "highgui.h" 
 #include <stdio.h>  
 // A Simple Camera Capture Framework 
 int main() {
   CvCapture* capture = cvCaptureFromCAM( CV_CAP_ANY );
   if ( !capture ) {
     fprintf( stderr, "ERROR: capture is NULL \n" );
     getchar();
     return -1;
   }
   // Create a window in which the captured images will be presented
   cvNamedWindow( "mywindow", CV_WINDOW_AUTOSIZE );
   // Show the image captured from the camera in the window and repeat
   while ( 1 ) {
     // Get one frame
     IplImage* frame = cvQueryFrame( capture );
     if ( !frame ) {
       fprintf( stderr, "ERROR: frame is null...\n" );
       getchar();
       break;
     }
     cvShowImage( "mywindow", frame );
     // Do not release the frame!
     //If ESC key pressed, Key=0x10001B under OpenCV 0.9.7(linux version),
     //remove higher bits using AND operator
     if ( (cvWaitKey(10) & 255) == 27 ) break;
   }
   // Release the capture device housekeeping
   cvReleaseCapture( &capture );
   cvDestroyWindow( "mywindow" );
   return 0;
 } 
```

# sql - 在子查询中使用查询值从另一个表中获取计数数据

> ID：10551425
> 
> 赞同：2
> 
> 时间：2012-05-11T12:34:41.357
> 
> 标签：sql, sql-server, tsql

我有一个父/子/孙类型表关系定义如下：

表A：父ID描述

tableB: childID parentId 描述

tableC：grandchildID childId 描述 itemComplete

我需要编写一个查询，该查询将列出 tableB 中任何给定 parentID 的所有记录，以及孙记录的总数和已完成的孙记录的总数（其中 itemComplete = true）。

parentID 将成为 where 子句的一部分（select * from tableB where parentId = x）。我无法弄清楚的问题是如何从 tableC 中获取计数，因为计数取决于 childId 的当前行值。

换句话说，我需要某种看起来像这样的查询：

```
select description,  
(select count (*) from tableC where childId = X) as Items,
(select count (*) from tableC where childId = X And itemComplete = true) as CompleteItems
from tableB where parentId=Y 
```

其中 X 是 tableB 中当前行的 childId。如何从子查询中的每一行引用 childId 以获取完整的项目数和项目数？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-11T12:41:29.530

使用子选择是一种选择，但我更喜欢`JOIN`两个表，并使用`GROUP BY`使用语句的子句`CASE`来获取总数。

```
SELECT b.description
       , COUNT(*) AS Items
       , SUM(CASE WHEN c.itemComplete = true THEN 1 ELSE 0 END) AS CompleteItems
FROM   tableB b
       LEFT OUTER JOIN tableC c ON c.childid = b.childid
WHERE  b.parentID = 'Y'
GROUP BY
       b.description 
```

如果您坚持使用原始语句，那么所缺少的只是对外部表的引用`tableB.childID`

```
select description,  
(select count (*) from tableC where childId = tableB.childID) as Items,
(select count (*) from tableC where childId = tableB.childID And itemComplete = true) as CompleteItems
from tableB where parentId=Y 
```

或重新格式化

```
SELECT description
       ,  (SELECT COUNT(*) FROM tableC WHERE childId = tableB.childID) AS Items,
       ,  (SELECT COUNT(*) FROM tableC WHERE childId = tableB.childID AND itemComplete = true) AS CompleteItems
FROM   tableB 
WHERE  parentId=Y 
```

# tfs - 尝试获取 TFS 自定义策略时出现权限错误 - vsts 2010

> ID：10551428
> 
> 赞同：1
> 
> 时间：2012-05-11T12:34:52.457
> 
> 标签：tfs

我在 tfs 服务器中开发了一个自定义策略。

我正在尝试以下操作以获取部署到开发人员机器的策略副本。

VSTS 电动工具 (2010) 用于此

“团队资源管理器 | 右键单击​​项目 | 团队项目设置 | 源代码控制... | 签入策略 | 添加...

当我单击上述流程中的源代码控制菜单项时，会显示以下错误。

> 项目测试需要错误权限 AdminProjectRights。

每个开发人员是否都需要管理员权限才能下载自定义策略？如果不是，那么需要为开发人员设置哪个权限

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T13:34:45.793

除了他们拥有的通常的贡献权限之外，您不需要为开发人员设置任何权限。

将策略添加到项目后（您需要管理员权限才能执行此操作），每个开发人员都可以下载它。

# java - 将图像从android上传到java servlet并保存

> ID：10551431
> 
> 赞同：6
> 
> 时间：2012-05-11T12:35:02.730
> 
> 标签：java, android, image, servlets

我一直在寻找这个，没有什么对我有用。

我正在尝试将图像从 android 应用程序上传到 java servlet 并将其保存在服务器中。我发现的每个解决方案都对我不起作用。

我的代码当前所做的：android 应用程序正在将图像发送到 servlet，当我尝试保存它时，文件已创建，但它是空的 :(

谢谢你的帮助！

我在 android 客户端中的代码（i_file 是设备上的文件位置）：

```
public static void uploadPictureToServer(String i_file) throws ClientProtocolException, IOException {
    // TODO Auto-generated method stub   
    HttpClient httpclient = new DefaultHttpClient();
    httpclient.getParams().setParameter(CoreProtocolPNames.PROTOCOL_VERSION, HttpVersion.HTTP_1_1);

    HttpPost httppost = new HttpPost("http://192.168.1.106:8084/Android_Server/GetPictureFromClient");
    File file = new File(i_file);

    MultipartEntity mpEntity = new MultipartEntity();
    ContentBody cbFile = new FileBody(file, "image/jpeg");
    mpEntity.addPart("userfile", cbFile);

    httppost.setEntity(mpEntity);
    System.out.println("executing request " + httppost.getRequestLine());
    HttpResponse response = httpclient.execute(httppost);
    HttpEntity resEntity = response.getEntity();

    System.out.println(response.getStatusLine());
    if (resEntity != null) {
      System.out.println(EntityUtils.toString(resEntity));
    }
    if (resEntity != null) {
      resEntity.consumeContent();
    }

    httpclient.getConnectionManager().shutdown();

} 
```

我在服务器端的代码：

```
protected void doPost(HttpServletRequest request, HttpServletResponse response)
        throws ServletException, IOException {
    processRequest(request, response);

        InputStream in = request.getInputStream();
        OutputStream out = new FileOutputStream("C:\\myfile.jpg");
        IOUtils.copy(in, out); //The function is below
        out.flush();
        out.close();

} 
```

IOUtils.copy 代码：

```
public static long copy(InputStream input, OutputStream output) throws IOException {
    byte[] buffer = new byte[4096];

    long count = 0L;
    int n = 0;

    while (-1 != (n = input.read(buffer))) {
        output.write(buffer, 0, n);
        count += n;
    }
    return count;
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-11T13:08:21.670

你误解了这个问题。图像文件不为空，但图像文件已**损坏**，因为您将整个 HTTP 多部分请求正文存储为图像文件，而不是从 HTTP 多部分请求正文中提取包含图像的部分。

您需要[`HttpServletRequest#getPart()`](http://docs.oracle.com/javaee/6/api/javax/servlet/http/HttpServletRequest.html#getPart%28java.lang.String%29)获取多部分请求正文的各个部分。如果您已经在使用 Servlet 3.0（Tomcat 7、Glassfish 3 等），请首先使用[`@MultipartConfig`](http://docs.oracle.com/javaee/6/api/javax/servlet/annotation/MultipartConfig.html)

```
@WebServlet("/GetPictureFromClient")
@MultipartConfig
public class GetPictureFromClient extends HttpServlet {
    // ...
} 
```

`doPost()`然后按如下方式修复您的部分，通过其名称获取部件，然后将其主体作为输入流：

```
InputStream in = request.getPart("userfile").getInputStream();
// ... 
```

如果您还没有使用 Servlet 3.0，那么请使用[Apache Commons FileUpload](http://commons.apache.org/fileupload)。另请参阅此答案以获取详细示例：[如何使用 JSP/Servlet 将文件上传到服务器？](https://stackoverflow.com/questions/2422468/how-to-upload-files-in-jsp-servlet/2424824#2424824)

哦，请摆脱 Netbeans 生成的`processRequest()`方法。`doGet()`将两者都委托`doPost()`给单个`processRequest()`方法绝对不是正确的方法，它只会使不使用 Netbeans 的其他开发人员和维护人员感到困惑。

# php - 如何构造像这些 mychoice.domainname.com 这样的 URL，

> ID：10551436
> 
> 赞同：0
> 
> 时间：2012-05-11T12:35:22.857
> 
> 标签：php, zend-framework, url-rewriting

我需要像这样收缩 URL

例如：我的域名：**www.domainname.com**
*期待输出*

**以候选人**身份登录我需要将其更改为Candidate.domainname.com

 **以招聘人员身份登录我需要将其更改为**recrutier.domainname.com**

有什么帮助，我是建筑用户友好 url 的新手。即使你的建议很小，它也会帮助我。，所以不要犹豫，提出建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T17:26:01.080

您可以`$_SERVER['HTTP_HOST']`在引导程序中检查并根据它设置默认模块：

```
protected function _initModules()
{
    $frontController = Zend_Controller_Front::getInstance();
    $frontController->addModuleDirectory(APPLICATION_PATH . '/modules');
    $frontController->setParam('prefixDefaultModule', true);

    $systemDomainName = 'domainname.com';

    // our api is located at api.domainname.com
    if ( ($_SERVER['HTTP_HOST'] == 'api.' . $systemDomainName)) {
        $frontController->setDefaultModule('api');

        $restRoute = new Zend_Rest_Route($frontController);
        $frontController->getRouter()->addRoute('default', $restRoute);
     } else if ( ($_SERVER['HTTP_HOST'] == 'candidate.' . $systemDomainName)) {
         $frontController->setDefaultModule('candidate');
     }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T12:38:46.833

这不是友好的网址。这是在域控制面板中管理的子域系统。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T12:51:41.250

您需要登录您的域控制工具，通常由您的托管公司提供，并为您的域添加一个 CNAME 记录，也称为别名，该记录指向您的 DNS 配置中的“A”记录，通常这也指向到“www”。

以 GoDaddy 为例，CNAME 记录将指向“@”，这意味着它指向您的 A 记录。**

# silverlight - 在 Enterprise Library 5.0 + Silverlight 中实例化和配置记录器

> ID：10551439
> 
> 赞同：0
> 
> 时间：2012-05-11T12:35:33.823
> 
> 标签：silverlight, enterprise-library

我在 Silverlight 项目中使用 Enterprise Library 5.0，Logging 块。在我希望能够实例化记录器的项目中，我相信正确的类是 LogWriterImpl。而且我还希望能够使用 Xml 配置来配置这个 LogWriterImpl，所以最后我想要这样的东西：

```
public class LoggerFactory
{
    public LoggerWriter Create(string xmlFilePath)
    {
        // Load configuration from xmlFilePath
        ???

        // Read the configuration and create the parameters for the LogWritterImpl
        ???

        // In Silverlight there are several constructors for the LogWritterImpl class
        // which one to use? which arguments to use?
        var logger = new LogWritterImpl( /* which parameters go here? */ );

        return logger;
    }
} 
```

谁能帮我填空？

感谢您的时间！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-12T15:08:53.690

请参阅此演练： [http ://channel9.msdn.com/posts/Enterprise-Library-for-Silverlight-Logging-demo](http://channel9.msdn.com/posts/Enterprise-Library-for-Silverlight-Logging-demo)

演示的源代码在[这里](http://entlib.codeplex.com/releases/view/63549)。

此外，请参阅开发人员指南的[这一章](http://msdn.microsoft.com/en-us/library/hh852706%28v=pandp.51%29)。

# iphone - NSManagedObject、NSManagedObjectContext 和 NSManagedObjectModel 的区别

> ID：10551449
> 
> 赞同：15
> 
> 时间：2012-05-11T12:36:22.293
> 
> 标签：iphone, ios, core-data, nsmanagedobject

这三类核心数据有什么区别，`[NSManagedObject , NSManagedObjectContext , NSManagedObjectModel ]`我们如何用最简单的方式描述？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2012-05-11T12:49:14.713

在数据库方面：

*   NSManagedObject = 一行
*   NSManagedObjectContext = 一个事务
*   NSManagedObjectModel = 架构

当然，Core Data 不是数据库。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-05T10:50:16.513

***来自 CoreData 编程指南：***

您可以将 a`managed object context`视为智能便签本。当您从持久存储中获取对象时，您将临时副本带到便笺簿上，它们在此处形成对象图（或对象图的集合）。然后，您可以随意修改这些对象。**但是，除非您实际保存这些更改，否则持久存储将保持不变。**

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-12-06T04:33:16.653

NSManagedObjects 表示存储在数据库中的数据。您可以将它们视为模型对象。

NSManagedObjectContext 允许您从数据库中插入、保存和检索（使用 NSFetchRequest）NSManagedObjects。”</p>

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-11T12:40:25.740

上下文是您可能会在您阅读对象之后或将其插入数据库之前说您的对象所在的位置

有关更多信息，请简要阅读这些主题并了解差异

[将 NSManagedObject 的实例添加到 NSManagedObjectContext ok，更新同一个实例失败](https://stackoverflow.com/questions/3329055/add-an-instance-of-nsmanagedobject-to-nsmanagedobjectcontext-ok-updating-the-sa)

[如何将 NSManagedObject 从一个上下文复制或移动到另一个上下文？](https://stackoverflow.com/questions/2998613/how-do-i-copy-or-move-an-nsmanagedobject-from-one-context-to-another)

[http://www.cimgf.com/2011/01/07/passing-around-a-nsmanagedobjectcontext-on-the-iphone/](http://www.cimgf.com/2011/01/07/passing-around-a-nsmanagedobjectcontext-on-the-iphone/)

[NSManagedObject 是否保留其 NSManagedObjectContext？](https://stackoverflow.com/questions/8378456/does-an-nsmanagedobject-retain-its-nsmanagedobjectcontext)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-11T12:47:11.890

NSManagedObject 继承自对象，并添加了需要由核心数据管理的方法。

上下文是保存由核心数据管理的对象的位置，当您从数据库中获取对象或创建以保存到它时会发生这种情况

对象模型描述了持久存储的核心数据模式

# c++ - 使用boost库将句子中每个单词的首字母大写

> ID：10551451
> 
> 赞同：1
> 
> 时间：2012-05-11T12:36:27.193
> 
> 标签：c++, string, boost

我正在寻找一种使用 boost 将句子中每个单词的首字母大写的方法。为了使代码一致，即如果输入语句中存在，最终输出将不包含任何空格或制表符。为了获得单个单词，我使用 boost::algorithm::split 并将它们组合回 boost::algorithm::join 。但是如何让每个首字母大写？

我试过这段代码

```
 #include <iostream>                                                              
 #include <vector>                                                                
 #include <boost/algorithm/string/split.hpp>                                      
 #include <boost/algorithm/string.hpp>

 int main()                                                                      
 {                                                                               
     using namespace std;                                                        

     string str("cONtainS            SoMe    CApiTaL WORDS");                    

     vector<string> strVec;                                                      
     using boost::is_any_of;                                                     
     using boost::algorithm::token_compress_on;                                  

     boost::algorithm::split(strVec, str, is_any_of("\t "), token_compress_on);  

     vector<string>::iterator i ;                                                

     for(i = strVec.begin() ; i != strVec.end(); i++)                            
     {
         (*i)[0] = boost::to_upper((*i)[0]);
         cout<<*i<<endl;                                                             
     }                                                                           

     return 0;                                                                   
 } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T13:00:22.947

问题是定义你如何确定一个句子是什么。最简单的解决方案是它是以正则表达式结尾的任何序列`"[.!?][\"\']*"`（因为您已经消除了空格）；这实际上很简单，你可以在没有正则表达式的情况下做到这一点。然后记住你已经看过它，并将下一个单词大写：

```
bool atEndOfSentence = true;
for ( std::vector<std::string>::const_iterator current = words.begin();
        current != words.end();
        ++ current ) {
    if ( atEndOfSentence ) {
        (*current)[0] == toupper( (*current)[0] );
    }
    std::cout << *current << std::endl;
    atEndOfSentence = isSentenceEnd( 
            *std::find_if( current->rbegin(), current->rend(),
                           IsNotQuoteChar() ).base() );
} 
```

和：

```
struct IsNotQuoteChar
{
    bool operator()( char ch ) const
    {
        return ch != '\'' and ch != '\"';
    }
}; 
```

和：

```
bool
isSentenceEnd( char ch )
{
    return ch == '.' || ch == '!' || ch == '?';
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T13:06:23.830

我很欣赏这不使用 Boost 并且不适用于 Unicode，但提供了使用标准库函数的基本解决方案。我正在打破`isalpha`文字的界限。也许不是最好的方法，但这只是一种选择：

```
#include <string>
#include <iostream>

using namespace std;

int main()
{
    string str("  cONtainS            SoMe    CApiTaL WORDS");

    bool niw(true);
    string strC;
    for (size_t i = 0; i < str.size(); ++i)
    {
        if ( niw && isalpha( str[i] ) )
        {
            strC += toupper( str[i] );
            niw = false;
        }
        else if ( ! niw )
        {
            if  ( isalpha( str[i] ) )
                strC += tolower( str[i] );
            else
            {
                niw = true;
                strC += str[i];
            }
        }
        else
            strC += str[i];
    }

    cout << str << endl;
    cout << strC << endl;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-12T07:37:27.450

这段代码让我工作

```
#include <iostream>
#include <boost/algorithm/string.hpp>
#include <boost/algorithm/string/trim.hpp>
#include <vector>
#include <ctype.h>

int main()
{
    using namespace std;

    string str("contAins Some       CapItal WORDS");
    string result;

    vector<string> strVec;

    using boost::is_any_of;
    using boost::algorithm::token_compress_on;

    boost::algorithm::split(strVec, str, is_any_of("\t "), token_compress_on);

    vector<string>::iterator i; 

    for(i = strVec.begin(); i !=strVec.end(); ++i)
    {                                                                                

        boost::to_lower(*i);
        (*i)[0]=toupper((*i)[0]);

        cout<<(*i)<<endl;
        result += *i +" ";
    }  

    boost::trim_right(result);
    cout<<result;
    return 0; 
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-03-14T23:19:04.383

如果有人感兴趣，这是我的 C++11 解决方案：

```
std::string s("some lowercase string");
s[0] = toupper(s[0]);
std::transform(s.begin()+1, s.end(),s.begin(),s.begin()+1, 
[](const char& a, const char& b) -> char
{
    if(b==' ' || b=='\t')
    {
        return toupper(a);
    }
    return a;
}); 
```

# drupal - 从一个域重定向到另一个域但保留请求的页面

> ID：10551454
> 
> 赞同：3
> 
> 时间：2012-05-11T08:26:14.507
> 
> 标签：drupal, redirect

我想为我的一个域创建一个重定向到另一个域。我遵循了[这个问题中报告的](https://drupal.stackexchange.com/questions/18347/how-to-redirect-all-urls-to-a-new-domain)内容，它工作得很好。

我现在遇到的问题是我想将 www.example.com/some-page 重定向到 www.new-example.com/some-page。

现在，www.example.com/some-page 只是重定向到 www.new-example.com，这可能会让为网站某些部分创建书签的用户感到困惑。

两个 URL 都链接到同一个虚拟主机，我正在运行一个 litespeed 服务器。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T08:31:42.590

将以下内容添加到您的 .htaccess 文件中：

```
RewriteCond %{HTTP_HOST} !^yourdomain.com [NC]
RewriteRule ^ http://yourdomain.com%{REQUEST_URI} [L,R=301] 
```

编辑：yourdomain.com 应该是您要重定向到的域。

# windows-phone-7 - 从 HTTP 响应中获取 Cookie

> ID：10551464
> 
> 赞同：1
> 
> 时间：2012-05-11T12:37:06.613
> 
> 标签：windows-phone-7, cookies, asynchronous, httpwebrequest, response

我在从 HTTP 响应中获取 cookie 时遇到问题。我确定，该响应应该有 cookie，但我在我的应用程序中看不到它们。

这是我的代码：

```
 private static CookieContainer cookies = new CookieContainer();
    private static CookieContainer Cookies
    {
        get
        {
            return cookies;
        }
    }

    public static async Task<HttpStatusCode> SendPostRequest(string url, string postData)
    {
        if (url == null)
            throw new ArgumentNullException("url");

        if (postData == null)
            throw new ArgumentNullException("postData");

        HttpStatusCode statusCodeToReturn = HttpStatusCode.Forbidden;
        HttpWebRequest webRequest = HttpWebRequest.CreateHttp(url);
        webRequest.Method = "POST";
        var cookies = Cookies;
        webRequest.CookieContainer = cookies;
        //webRequest.SupportsCookieContainer = true;
        using (var requestStream = await webRequest.GetRequestStreamAsync())
        {
            var bytes = Encoding.UTF8.GetBytes(postData);
            requestStream.Write(bytes, 0, bytes.Length);
        }

        using (WebResponse response = await webRequest.GetResponseAsync())
        {
            statusCodeToReturn = WebResponseToHTTPStatusCode(response);
        }

        return statusCodeToReturn;
    } 
```

Cookies（使用 Wireshark）：

```
rack.session=BAh7BkkiD3Nlc3Npb25faWQGOgZFRiJFMzg1ZjYxNzIzNzQ4MmY5NmI3NTMw%0AYWMwZmRjNmVmZjMwMDk4OTgzZGUwNjRlNzIzODlmODNjYzE2YmVmMjNlOQ%3D%3D%0A--30d79cd2276c3236de11104852bba4b84bf80f26; path=/; HttpOnly 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T20:54:39.617

问题在于返回的 Cookie。WP7 不支持没有设置 DOMAIN 的 Cookie。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T13:19:06.150

我认为您可以只创建一个全局变量来保存 cookie。例如在您的 app.xaml.cs 文件中，您可以创建一个像这样的变量：

```
public CookieContainer GlobalCookie{get;set;} 
```

并使 GloalCookie 等于您成功的 HttpWebRequest CookieContainer。

然后你可以在调用另一个API的时候使用这个变量。希望对你有帮助:)

# windows-8 - 从 Xbox 移植到 Windows 8

> ID：10551467
> 
> 赞同：1
> 
> 时间：2012-05-11T12:37:26.913
> 
> 标签：windows-8, xbox

我们为 XBOX 360 开发了应用程序，它是基于 silverlight 的应用程序。我们需要将它移植到 Windows 8 平台...选项卡和桌面。

这里有一些问题

*   移植可能吗？
*   在 winRT 而不是 SilverLight 上从头开始移植是个好主意吗？
*   XBOX 是否有与 windows phone 8 平台相同的 Metro 风格应用程序？

任何建议都将是可观的。

谢谢拉什米

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T08:46:19.423

1.  是的，但会涉及到工作。它不会只是运行。您的大部分业务代码都可以正常工作，但您的 UI 需要更新到新的 Windows8 XAML 命名空间和概念。
2.  我建议移植您的业务逻辑，但重新实现您的 UI。您可能可以重复使用许多资产，但控制器（或 Kinect）和触摸/鼠标界面之间的交互范式将完全不同。只是移植最终可能会导致在 Windows 8 上感觉不合适的应用程序。
3.  Xbox 上没有 WinRT/Metro 风格的 UI。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T16:51:10.293

移植是可能的。但是，您可能必须重新编码代码隐藏的某些部分，因为 winrt 的 api 略有不同。

我相信移植指南类似于将 windows phone 移植到 windows 8 的指南。

您应该移植，因为大多数 xaml 代码不应该有太大的变化。

# xcode4 - 产品日志的 iTunes 连接配置

> ID：10551468
> 
> 赞同：0
> 
> 时间：2012-05-11T12:37:37.880
> 
> 标签：xcode4, in-app-purchase, mkstorekit

在测试我的应用内购买时，我在我的控制台中收到了用于连接设备和模拟器的这些。谁能建议我的构建可能有什么问题？我的应用程序已提交到商店，目前正在等待审核。

产品的 iTunes 连接配置问题：com.mugunthkumar.subinapptest.wk1 产品的 iTunes 连接配置问题：com.mugunthkumar.caltasks.propack 产品的 iTunes 连接配置问题：com.mugunthkumar.inappsubtest.consumable1

在设备上进行测试时，我也看到了这条消息。这可能是相关的。我没有在摘要中检查权利。我没有设置配置文件，所以我不能说 iCloud 是如何在它们上配置的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T12:43:07.147

您在 iTunes 中的产品捆绑包名称是否连接`com.mugunthkumar.subinapptest`？您的应用内购买是否已在 iTunes Connect 中完全设置？

plist`MKStoreKit`是否正确配置？

# c# - 我需要什么窗体控件

> ID：10551472
> 
> 赞同：1
> 
> 时间：2012-05-11T12:37:59.100
> 
> 标签：c#, winforms, user-controls

所有，我想实现浮动窗口窗体的某些部分的能力。实现以下目标的最佳方法是什么...

这是在浮子之前（电蓝色面板表示正在移动的部分）。

![浮动前](../Images/4ebf041f043e6d2b44ecc0c23c112520.png)

这是在浮动之后。

![浮动后](../Images/135e42f53164c24451e1ccb4b0f94ad7.png)

我可以将 MDI 容器设置为给定表单的特定面板本地吗？

抱歉这个可怜的问题，我以前没有这样做过。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T12:41:28.843

您需要对接管理器。市场上有很多，付款人与否。

例如：

[码头面板套件](http://sourceforge.net/projects/dockpanelsuite/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T12:54:34.173

如果您正在设计新的东西，最好使用 WPF 并使用 WPF 控件。这是未来！:)

您可以试用免费[的 AvalonDoc](http://avalondock.codeplex.com/)

# objective-c - RKObjectLoader 用数组参数截断我的路径

> ID：10551474
> 
> 赞同：2
> 
> 时间：2012-05-11T12:38:01.003
> 
> 标签：objective-c, ios, rest, restkit

我对 RestKit 有疑问

我尝试发送参数字符串数组。这样做。

```
RKObjectMapping* tagMapping = [[RKObjectManager sharedManager].mappingProvider
    objectMappingForClass:[RKTag class]];
NSArray *tags = [NSArray arrayWithObjects:@"Home", @"Relation", nil];
NSDictionary *dictParams =
    [NSDictionary dictionaryWithObject:tags forKey:@"type"];

NSString *resourcePath = [[NSString stringWithString:@"/tags"]
    stringByAppendingQueryParameters:dictParams];
[_m loadObjectsAtResourcePath:resourcePath usingBlock:^(RKObjectLoader *loader) {
    [loader setObjectMapping:tagMapping];
    [loader setMethod:RKRequestMethodGET];
    [loader setDelegate:delegate];
}]; 
```

但是，当我在服务器上看到控制台时，我看到了

> 开始 GET "/tags?type%5B%5D=%D0%A0%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%B5%D0%BD%D0%BD%D1 127.0.0.1 在 %8B%D0%B5%20%D0%BE%D1%82%D0%BD%D0%BE%D1%88%D0%B5%D0%BD%D0%B8%D1%8F" 2012-05-11 16:30:54 +0400 由 TagsController#index 处理为 JSON 参数：{"type"=>["Home"]}

当 RKObjectLoader 初始化时，调用方法 loaderWithResourcePath，截断我的数组

如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T05:59:35.307

我通过更改 RKUrlClass 解决了这个问题

```
- (id)initWithBaseURL:(NSURL *)theBaseURL resourcePath:(NSString *)theResourcePath queryParameters:(NSDictionary *)theQueryParameters {
    NSDictionary *resourcePathQueryParameters = [theResourcePath queryParameters];
    NSMutableDictionary *mergedQueryParameters = [NSMutableDictionary dictionaryWithDictionary:[theBaseURL queryParameters]];
    [mergedQueryParameters addEntriesFromDictionary:resourcePathQueryParameters];
    [mergedQueryParameters addEntriesFromDictionary:theQueryParameters];

    // Build the new URL path
    NSRange queryCharacterRange = [theResourcePath rangeOfCharacterFromSet:[NSCharacterSet characterSetWithCharactersInString:@"?"]];
    NSString *resourcePathWithoutQueryString = (queryCharacterRange.location == NSNotFound) ? theResourcePath : [theResourcePath substringToIndex:queryCharacterRange.location];
    NSString *baseURLPath = [[theBaseURL path] isEqualToString:@"/"] ? @"" : [[theBaseURL path] stringByStandardizingPath];
    NSString *completePath = resourcePathWithoutQueryString ? [baseURLPath stringByAppendingString:resourcePathWithoutQueryString] : baseURLPath;
    NSString* completePathWithQuery = [completePath stringByAppendingQueryParameters:mergedQueryParameters];

    // before
    //    NSURL* completeURL = [NSURL URLWithString:completePathWithQuery relativeToURL:theBaseURL];
    // after my edit
    NSString *cPath = theResourcePath ? theResourcePath : baseURLPath;
    NSURL* completeURL = [NSURL URLWithString:cPath relativeToURL:theBaseURL];

    if (!completeURL) {
        RKLogError(@"Failed to build RKURL by appending resourcePath and query parameters '%@' to baseURL '%@'", theResourcePath, theBaseURL);
        [self release];
        return nil;
    }

    self = [self initWithString:[completeURL absoluteString]];
    if (self) {
        self.baseURL = theBaseURL;
        self.resourcePath = theResourcePath;
    }

    return self;
} 
```

# android - 无法在 Facebook 中进行身份验证

> ID：10551475
> 
> 赞同：1
> 
> 时间：2012-05-11T12:38:05.710
> 
> 标签：android, facebook, facebook-authentication

我在 android 中创建了一个应用程序，在其中我在按钮单击时设置了 Facebook 身份验证。但是当我点击那个按钮时，它又回到了我的活动中。

我知道问题是：我无法登录 Facebook，因为我已经在设备中使用 Facebook 应用程序登录。

那么我的问题是如何在我的 Android 应用和 Facebook 应用中分别登录？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T12:53:24.420

如果您使用 fb sdk 比在**FacebookConnector**类中 更改 **登录**方法，如下所示

```
public void login() {
    if (!facebook.isSessionValid()) {
        facebook.authorize(this.activity, this.permissions,-1,new LoginDialogListener());
    }
} 
```

可以吗

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T13:09:03.973

最后我用这个解决了这个问题：

打开由 facebook sdk 提供的 Facebook.java，然后我进行了如下更改：

```
public void authorize(Activity activity, String[] permissions,
            int activityCode, final DialogListener listener) {

        boolean singleSignOnStarted = false;

        mAuthDialogListener = listener;

      /*  // Prefer single sign-on, where available.
        if (activityCode >= 0) {
            singleSignOnStarted = startSingleSignOn(activity, mAppId,
                    permissions, activityCode);
        }
        // Otherwise fall back to traditional dialog.
        if (!singleSignOnStarted) {*/
            startDialogAuth(activity, permissions);
       // }
    } 
```

最后我可以在我的设备上登录这两个应用程序

# java - 构造函数参数在传递给超级构造函数时丢失

> ID：10551477
> 
> 赞同：0
> 
> 时间：2012-05-11T12:38:11.187
> 
> 标签：java, generics, gwt, constructor, nested-generics

在我的 GWT 应用程序中，我有一个扩展超类的数据类型（用于构建和跟踪类似对象的层次结构），而超类又扩展了另一个抽象超类。在抽象类中声明了一个泛型参数，然后每个子类将其指定为自身的类型。结构如下：

```
public abstract class AbstractFoo<T extends AbstractFoo> {
     protected T parent;

     protected AbstractFoo(T parent){
          if (parent != null) parent.addChild(this);
          this.parent = parent;
     }
     //...
}

public class Foo<T extends Foo> extends AbstractFoo<T> {
     public Foo(T parent){
          super(parent);
          //...
     }
}

public class SpecialFoo<T extends SpecialFoo> extends Foo<T> {
     public SpecialFoo(T parent){
          super(parent);
          //...
     }
} 
```

当我将父参数传递给 SpecialFoo 的构造函数时，Foo 的构造函数将被称为超级构造函数，而该构造函数又会调用 AbstractFoo 的构造函数作为超级构造函数。

我遇到的问题是，当从 Foo 传递到 AbstractFoo 时，父参数被重置为 NULL。我不知道为什么会这样。谁能告诉我我需要做什么才能将它传递给抽象基类而不受伤害？

* * *

**编辑：** 我想我已经解决了......诀窍似乎是我必须在每个子类中声明父参数，以便对它有更具体的引用，如下所示：

```
 public abstract class AbstractFoo<T extends AbstractFoo> {
      protected T parent;

      protected AbstractFoo(T parent){
           if (parent != null) parent.addChild(this);
           this.parent = parent;
      }
      //...
 }

 public class Foo<T extends Foo> extends AbstractFoo<T> {
      protected T parent;

      public Foo(T parent){
           super(parent);
           //...
      }
 }

 public class SpecialFoo<T extends SpecialFoo> extends Foo<T> {
      private SpecialFoo parent;

      public SpecialFoo(T parent){
           super(parent);
           //...
      }
 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T12:42:13.257

回顾以下几点：

1.  积极地证明您`null`在构造函数中接收到一个参数（打印它）；
2.  检查您的类中的**其他构造函数。**您可能正在调用您不希望调用的构造函数，尤其是由于该参数的泛型类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T12:43:29.927

你有没有检查过你的父母**不是** `null`你给你的 SpecialFoo 构造函数？

# jquery - linq to jquery with jquery ver jquery-1.7.2

> ID：10551482
> 
> 赞同：1
> 
> 时间：2012-05-11T12:38:38.267
> 
> 标签：jquery, asp.net, vb.net, json, entity-framework-4

这是我的课：

```
Public Class Employeeclass
Public Property Fname As String
Public Property Lname As String
Public Property Bdate As Date
End Class 
```

这是我的方法：

```
 <WebMethod()>
Public Shared Function Getemployee(ByVal id As Integer) As List(Of Employeeclass)
    Threading.Thread.Sleep(2000)
    Dim db As New NorthwindEntities
    Return db.Employees.Where(Function(q) q.EmployeeID = id).Select(Function(q) New Employeeclass With {.Lname = q.LastName, .Fname = q.FirstName, .Bdate = q.BirthDate}).ToList()
End Function 
```

这是我的脚本代码：

```
$(document).ready(function () {
        $("#btnsearch").click(function () {
            $("#result").addClass("loading");
            $("#result").text("");
            $.ajax({
                type: "POST",
                url: "Default.aspx/Getemployee",
                contentType: "application/json;charset=utf-8",
                data: "{'id':" + $("#txtsearch").val() + "}",
                dataType: "json",
                success: function (data) {
                    $("#result").removeClass("loading");
                    var employee = data.d;
                    if (employee.length > 0) {
                        for (var i = 0; i < employee.length; i++) {
                            $("#result").append(employee[i].Fname + ",");
                            $("#result").append(employee[i].Lname + ",");
                            $("#result").append(employee[i].Bdate + "<br/>");
                        }
                    }
                }
            });
        });
    }); 
```

使用 jquery ver "jquery-1.3.2.js" 一切都可以。
但是当我使用ver“jquery-1.7.2.js”或“jquery-1.7.2.min.js”时。
我收到此错误：消息 = 无效的 Web 服务调用，参数缺少值：'id'。
**对不起我的英语不好**。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T12:41:45.910

不要将数据包装在字符串中。试试：

```
data: { id: $("#txtsearch").val() } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T12:47:27.797

发送这个

```
"{'id':" + $("#txtsearch").val() + "}" 
```

只会发送一个无法绑定到整数的 json 字符串，
而不是您应该发送一个可以绑定到整数类型 id 的 json 对象

```
data:{"id":$("#txtsearch").val()} 
```

现在，当您发送请求时，您可以调试并看到数据是这样发送的

```
id=ur_value 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T12:51:16.900

我每次`$.ajax()`将数据发布到网络方法时，我都会`JSON.stringify()`在我的对象上使用它来确保它是正确的。

除此之外，您可以尝试更改引号： `'{"id":' + $("#txtsearch").val() + '}'`看看它们是否有问题......

# java - 休眠：级联类型

> ID：10551485
> 
> 赞同：17
> 
> 时间：2012-05-11T12:38:49.377
> 
> 标签：java, hibernate, jpa

让我有 entity`A`和 entity `B`。实体与`A`有`@OneToOne`关系`B`。
我接下来要做的是：
如果我删除 A，那么 B 也必须被删除。
如果我删除 B，则不会删除 A。

我必须在哪个实体中设置

```
@OneToOne(cascade = {CascadeType.MERGE, CascadeType.PERSIST, CascadeType.REFRESH}) 
```

我必须在哪一边

```
@OneToOne(cascade = {CascadeType.ALL}) 
```

?

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-05-11T12:46:05.893

从 A 到 B 的级联应该放在`B`类中的字段引用上`A`，从 B 到 A 的级联应该放在`A`类中的字段引用上`B`。

```
public class A {
    @OneToOne(cascade = {CascadeType.ALL})
    B b;
} 
```

应该在课堂`A`上，因为你希望每个动作都被级联到`B`。

```
public class B {
    @OneToOne(cascade = {CascadeType.MERGE, CascadeType.PERSIST, CascadeType.REFRESH})
    A a;
} 
```

应该在课堂`B`上，因为你只希望某些动作级联到`A`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-11T12:42:43.870

如果 A “有” B，那么您必须在 A 中定义 CascadeType.ALL：

```
public class A {
  // changes to A cascade to B
  @OneToOne(cascade = {CascadeType.ALL})
  B b
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T13:04:18.167

如果 A 类具有 B 类，则 **CascadeType.ALL**将应用于 B。然后

```
Public Class A
{
  Private B b;
  @OneToOne(cascade = CascadeType.ALL)   
  public B getB() {       
    return this.b;   
   }     
  public void B(B b) {         
    this.b = b;   
  }
} 
```

有关更多信息，请阅读[此](http://www.vaannila.com/hibernate/hibernate-example/hibernate-mapping-one-to-one-using-annotations-1.html)示例

# php - PHP 脚本未在 WordPress 中正确运行

> ID：10551489
> 
> 赞同：0
> 
> 时间：2012-05-11T12:39:05.887
> 
> 标签：php, html, wordpress, wordpress-theming

我最近将[http://usborrow.pizzli.com/apply](http://usborrow.pizzli.com/apply)转换为网站的 WordPress 页面模板。其他所有页面都很好，但是当我访问[http://usborrow.pizzli.com/?page_id=6](http://usborrow.pizzli.com/?page_id=6)时，页面似乎失去了所有样式。任何支持将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T12:45:51.680

显然，相对 URL 引用存在问题。而不是引用样式表

```
<link href="../css/style.css" rel="stylesheet" type="text/css" /> 
```

尝试使用绝对路径

```
<link href="/css/style.css" rel="stylesheet" type="text/css" /> 
```

这应该适用于所有页面，假设您将样式表文件存储在站点根文件夹内的 css 文件夹中。你也应该对 IE 的其他 CSS 做同样的事情

```
<!--[if lt IE 8]><link rel="stylesheet" type="text/css" href="/css/ie7below.css" /><![endif]--> 
```

这样，无论用户访问的路径有多深（例如[http://usborrow.pizzli.com/folder1/folder2/folder3/file.abc](http://usborrow.pizzli.com/folder1/folder2/folder3/file.abc)），都可以毫无问题地引用 CSS。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T12:46:45.473

看来您应该包括*/apply/style.css*。

# java - 在不使用内置类或方法的情况下将字符串替换为空格

> ID：10551491
> 
> 赞同：-2
> 
> 时间：2012-05-11T12:39:17.987
> 
> 标签：java, string, replace

我有

```
String  url =” http://@50stackoverflow.com/questions/@50724043/@50xyz.html ” 
```

我想在不使用内置类或函数的情况下将 @50 替换为空格。

我想要的是

```
String url =” http:// stackoverflow.com/questions/ 724043/ xyz.html ” 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T12:48:31.540

这是一个很奇怪的问题，为什么不使用 java 的工具呢？“for”是内置的吗？String 是内置的吗？无论如何，这是否足够好不是java解决方案？（请不要在任何地方使用此代码）

```
char[] url = "http://@50stackoverflow.com/questions/@50724043/@50xyz.html".toCharArray();
    String output = "";
    int i;
    for (i = 0; i < url.length - 3; i++) {
        if (url[i] == '@' && url[i+1] == '5' && url[i+2] == '0') {
            output += " ";
            i+=3;
        } else {
            output += url[i];
        }
    }
    for (;i < url.length; i++) {
        output += url[i];
    }
    System.out.println(output); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T13:17:48.170

试试这个

```
char[] realString = "http://@50stackoverflow.com/questions/@50724043/@50xyz.html".toCharArray();
String newString = "";
for (int i = 0; i < realString.length; i++) {
    if (i<realString.length-2 && realString[i] == '@' && realString[i+1] == '5' && realString[i+2] == '0') {
        newString = newString + " ";
        i=i+3;
    } else {
        newString = newString + realString[i];
    }
}
System.out.println(newString); 
```

# c# - 在不单击的情况下显示标签消息

> ID：10551496
> 
> 赞同：1
> 
> 时间：2012-05-11T12:39:46.223
> 
> 标签：c#, label

所以我希望能够在不点击标签的情况下在标签上显示消息。

```
 public void servicestatus_Click_1(object sender, EventArgs e)
    {
        var mavbridgeservice = new System.ServiceProcess.ServiceController("MavBridge");

        if (mavbridgeservice.Status == ServiceControllerStatus.Running)
        {
            servicestatus.Text = ("The service is running!");
        }

        else
        {
            servicestatus.Text = "The service is stopped!";
        }  
    } 
```

我将（null，null）绑定在（object sender，EventArgs e）中，但这给出了错误，我不知道为什么。我里面的代码与任何点击都没有任何关联。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T12:52:44.453

您显然希望显示服务器的状态。

但是当用户要求更新时您不想更改它，您希望它自动更改对吗？

你有两个选择。编辑：我现在看到选项#1 不起作用，您将需要下面的计时器选项。我删除了选项 #1

选项 #2 如果它在您的程序之外更改，那么您可以添加一个计时器，根据您希望更新用户的速度，每隔一秒或两秒询问一次，然后添加您的代码以设置标签

```
 public Timer t = new Timer(); 
```

然后在您的主表单构造函数中，在 InitializeComponent(); 行添加这个

```
 t.Interval = 1000;
    t.Tick+=new EventHandler(t_Tick);
    t.Enable=true; 
```

在 timer.Tick 事件中运行您的代码以确定状态（当前在您的标签的点击事件中）

```
 void t_Tick(object sender, EventArgs e)
    {
       var mavbridgeservice = new System.ServiceProcess.ServiceController("MavBridge");

        if (mavbridgeservice.Status == ServiceControllerStatus.Running)
        {
            servicestatus.Text = ("The service is running!");
        }

        else
        {
            servicestatus.Text = "The service is stopped!";
        }  
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T12:53:13.070

将 null null 放在事件处理程序的参数中会给您一个错误，因为代码需要知道发送此请求的内容（对象，在本例中为标签）以及它使用的事件参数（e）您不能将这些设置为空，它需要它们发挥作用。这就是它给出错误的原因。

也正如所解释的那样，当您单击时，这可能不会触发，因为您没有将标签单击事件与此代码链接（click_1 显示有一个传统的点击，它链接到您未使用的链接）

# bash - 如何用制表符完成替换命令行参数？

> ID：10551498
> 
> 赞同：7
> 
> 时间：2012-05-11T12:39:51.920
> 
> 标签：bash, command-line-interface

我想知道这在 Bash 中是否可行，但我想使用制表符完成来完全替换正在扩展的当前参数。我举个例子：我想有一个函数可以在树中向上移动任意数量的级别，所以我可以调用 2 这将 cd 我向上 2 个目录。但是，我想这样做，如果在数字 2 处，我按下制表符，它将将该数字扩展为路径（相对或绝对，都可以）。我几乎使用完整的内置函数来工作，除了它只会附加文本，所以它会像 up 2/Volumes/Dev/

是否可以替换已完成的符号？

提前致谢 ：）

# 更新：

非常感谢 chepner，因为实际上检查我的代码会发现我的错误在哪里。我正在与错误的 var 进行比较，而我的调试代码导致该值无法替换。

对于任何感兴趣的人，这是代码（可能有更好的方法来完成此操作）：

```
# Move up N levels of the directory tree
# Or by typing in some dir in the PWD
# eg. Assuming your PWD is "/Volumes/Users/natecavanaugh/Documents/stuff"
#     `up 2` moves up 2 directories to "/Volumes/Users/natecavanaugh"
#     `up 2/` and pressing tab will autocomplete the dirs in "/Volumes/Users/natecavanaugh"
#     `up Users` navigate to "/Volumes/Users"
#     `up us` and pressing tab will autocomplete to "/Volumes/Users"
function up {
    dir="../"
    if [ -n "$1" ]; then
        if [[ $1 =~ ^[0-9]+$ ]]; then
            strpath=$( printf "%${1}s" );
            dir=" ${strpath// /$dir}"
        else
            dir=${PWD%/$1/*}/$1
        fi
    fi

    cd $dir
}

function _get_up {
    local cur
    local dir
    local results
    COMPREPLY=()
    #Variable to hold the current word
    cur="${COMP_WORDS[COMP_CWORD]}"

    local lower_cur=`echo ${cur##*/} | tr [:upper:] [:lower:]`

    # Is the arg a number or number followed by a slash
    if [[ $cur =~ ^[0-9]+/? ]]; then
        dir="../"
        strpath=$( printf "%${cur%%/*}s" );
        dir=" ${strpath// /$dir}"

        # Is the arg just a number?
        if [[ $cur =~ ^[0-9]+$ ]]; then
            COMPREPLY=($(compgen -W "${dir}"))
        else
            if [[ $cur =~ /.*$ ]]; then
                cur="${cur##*/}"
            fi

            results=$(for t in `cd $dir && ls -d */`; do if [[ `echo $t | tr [:upper:] [:lower:]` == "$lower_cur"* ]]; then echo "${t}"; fi done)

            COMPREPLY=($(compgen -P "$dir" -W "${results}"))
        fi
    else
        # Is the arg a word that we can look for in the PWD
        results=$(for t in `echo $PWD | tr "/" "\n"`; do if [[ `echo $t | tr [:upper:] [:lower:]` == "$lower_cur"* ]]; then echo "${t}"; fi; done)

        COMPREPLY=($(compgen -W "${results}"))
    fi  
}

#Assign the auto-completion function _get for our command get.
complete -F _get_up up 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-25T08:43:00.853

可以用一个新词完全替换当前词。使用我的 bash 4.2.29，我可以这样做：

```
_xxx() { COMPREPLY=( foo ); }
complete -F _xxx x
x bar # pressing tab turns this into x foo 
```

但是，如果有多个可能的补全，并且您希望获得公共前缀的部分补全，则会遇到问题。然后我的实验表明 bash 将尝试将可用的完成匹配到您输入的前缀。

所以一般来说，如果某个东西是唯一定义的，你可能应该只用完全不同的东西替换当前参数。否则，您应该生成与当前前缀匹配的补全，让用户从中进行选择。在您的情况下，您可以使用`COMPREPLY=($(compgen -P "$dir" -W "${results}"))`以下内容替换它：

```
local IFS=$'\n'
COMPREPLY=( $(find "${dir}" -maxdepth 1 -type d -iname "${cur#*/}*" -printf "%P\n") )
if [[ ${#COMPREPLY[@]} -eq 1 ]]; then
    COMPREPLY=( "${dir}${COMPREPLY[0]}" )
fi 
```

但是，在这种特定情况下，最好只用适当的路径替换前缀数字，并将其他所有内容留给默认的 bash 完成：

```
_up_prefix() {
    local dir cur="${COMP_WORDS[COMP_CWORD]}"
    COMPREPLY=()

    if [[ ${cur} =~ ^[0-9]+/? ]]; then
        # Starting with a number, possibly followed by a slash
        dir=$( printf "%${cur%%/*}s" );
        dir="${dir// /../}"
        if [[ ${cur} == */* ]]; then
            dir="${dir}${cur#*/}"
        fi
        COMPREPLY=( "${dir}" "${dir}." ) # hack to suppress trailing space
    elif [[ ${cur} != */* ]]; then
        # Not a digit, and no slash either, so search parent directories
        COMPREPLY=( $(IFS='/'; compgen -W "${PWD}" "${cur}") )
        if [[ ${#COMPREPLY[@]} -eq 1 ]]; then
            dir="${PWD%${COMPREPLY[0]}/*}${COMPREPLY[0]}/"
            COMPREPLY=( "${dir}" "${dir}." ) # hack as above
        fi
    fi
}

complete -F _up_prefix -o dirnames up 
```

代码变得更容易阅读和维护，而且启动效率更高。唯一的缺点是，在某些情况下，您必须比以前多按一次 tab：一次替换前缀，再按两次才能真正看到可能的完成列表。你的选择是否可以接受。

还有一件事：完成会将参数转换为常规路径，但您的 up 函数不接受这些。因此，也许您应该通过检查来启动该功能`[[ -d $1 ]]`，并简单地 cd 到该目录（如果存在）。否则，您的完成将生成被调用函数不可接受的参数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-11T05:38:44.890

以下内容基于问题中 OP 自己的代码，并且：

*   **提高健壮性**：正确处理需要`\`-转义的目录名称-例如，带有嵌入空格的名称；如果指定了无效的目录名，则报告错误（未完成）
*   **修改命令完成方法**：在命令完成时，级别编号/名称前缀扩展为带有*终止符*的相应*绝对路径*，因此如果需要，可以立即执行基于子目录的进一步完成。*`/`*

修改后的例子是：

```
# Assume that the working directory is '/Users/jdoe/Documents/Projects/stuff'.
#  `up 2` moves 2 levels up to '/Users/jdoe/Documents'
#  `up 2<tab>` completes to `up /Users/jdoe/Documents/`
#     Hit enter to change to that path or [type additional characters and]
#     press tab again to complete based on subdirectories.
#  `up Documents` or `up documents` changes to '/Users/jdoe/Documents'
#  `up Doc<tab>` or `up doc<tab>` completes to `up /Users/jdoe/Documents/`
#     Hit enter to change to that path or [type additional characters and]
#     press tab again to complete based on subdirectories.
#     Note: Case-insensitive completion is only performed if it is turned on
#     globally via the completion-ignore-case Readline option
#     (configured, for instance, via ~/.inputrc or /etc/inputrc). 
```

这是完整的代码（请注意，语法着色表明代码格式错误，但事实并非如此）：

```
# Convenience function for moving up levels in the path to the current working directory.
# Synopsis:
#     `up [n]` moves n levels up in the directory hierarchy; default is 1.
#     `up dirname` changes to the closest ancestral directory by that name, regardless of case.
#     `up absolutepath` changes to the specified absolute path; primarily used with command completion (see below).
# Additionally, if command completion via _complete_up() is in effect (<tab> represents pressing the tab key):
#      `up [n]<tab>` replaces n with the absolute path of the directory n levels up (default is 1).
#      `up dirnameprefix<tab>` replaces dirnameprefix with the absolute path of the closest ancestral directory whose name starts with the specified name prefix, terminated with '/'.
#         Whether dirnameprefix is matched case-insensitively or not depends on whether case-insensitive command completion is turned on globally via ~/.inputrc or /etc/inputrc.
#       In both cases the completed absolute path ends in '/', allowing you to optionally continue completion based on that path's subdirectories.
# Notes:
#   - Directory names with characters that need escaping when unquoted (such as spaces) are handled correctly.
#   - For command completion, to specify names that need escaping when unquoted, specify them escaped rather than quoted;
#     e.g., `up my \di<tab>' to match 'my dir' in the ancestral path.
function up {

    local dir='../'   # By default, go up 1 level.

    [[ "$1" == '-h' || "$1" == '--help' ]] && { echo -e "usage:\n\t$FUNCNAME [n]\n\t$FUNCNAME dirname\n  Moves up N levels in the path to the current working directory, 1 by default.\n  If DIRNAME is given, it must be the full name of an ancestral directory (case does not matter).\n  If there are multiple matches, the one *lowest* in the hierarchy is changed to." && return 0; }

    if [[ -n "$1" ]]; then
        if [[ $1 =~ ^[0-9]+$ ]]; then   # A number, specifying the number of levels to go up.            
            local strpath=$( printf "%${1}s" ) # This creates a string with as many spaces as levels were specified.
            dir=${strpath// /$dir}  # Create the go-up-multiple-levels cd expression by replacing each space with '../'
        elif [[ $1 =~ ^/ ]]; then  # Already an absolute path? Use as is. (Typically, this happens as a result of command-line completion invoked via _complete_up().)
            dir=$1
        else # Assumed to be the full name of an ancestral directory (regardless of level), though the case needn't match.
            # Note: On case-insensitive HFS+ volumes on a Mac (the default), you can actually use case-insensitive names with 'cd' and the resulting working directory will be reported in that case(!).
            #       This behavior is NOT related to whether case-insensitivity is turned on for command completion or not.
            # !! Strangely, the 'nocasematch' shopt setting has no effect on variable substitution, so we need to roll our own case-insensitive substitution logic here.
            local wdLower=$(echo -n "$PWD" | tr '[:upper:]' '[:lower:]')
            local tokenLower=$(echo -n "$1" | tr '[:upper:]' '[:lower:]')
            local newParentDirLower=${wdLower%/$tokenLower/*}   # If the specified token is a full ancestral directory name (irrespective of case), this substitution will give us its parent path.
            [[ "$newParentDirLower" == "$wdLower"  ]] && { echo "$FUNCNAME: No ancestral directory named '$1' found." 1>&2; return 1; }
            local targetDirPathLength=$(( ${#newParentDirLower} + 1 + ${#tokenLower} ))
            # Get the target directory's name in the exact case it's defined.
            dir=${PWD:0:$targetDirPathLength}
        fi
    fi

    # Change to target directory; use of 'pushd' allows use of 'popd' to return to previous working directory.
    pushd "$dir" 1>/dev/null
}

# Companion function to up(), used for command completion.
# To install it, run (typically in your bash profile):
# `complete -o filenames -F _complete_up up`
# Note: The '-o filenames' option ensures that:
#   (a) paths of directories returned via $COMPREPLY leave the cursor at the terminating "/" for potential further completion
#   (b) paths with embeddes spaces and other characters requiring \-escaping are properly escaped.
function _complete_up {

    COMPREPLY=() # Initialize the array variable through which completions must be passed out.

    # Retrieve the current command-line token, i.e., the one on which completion is being invoked.
    local curToken=${COMP_WORDS[COMP_CWORD]}
    # Remove \ chars., presumed to be escape characters in the current token, which is presumed to be *unquoted*. This allows invoking completion on a token with embedded space, e.g., '$FUNCNAME some\ directory'
    # !! Strictly speaking, we'd have to investigate whether the token was specified with quotes on the command line and, if quoted,  NOT unescape. Given that the purpose of this function is expedience, we
    # !! assume that the token is NOT quoted and that all backslashes are therefore escape characters to be removed.
    curToken=${curToken//'\'}

    if [[ $curToken =~ ^/ ]]; then # Token is an absolute path (typically as a result of a previous completion) -> complete with directory names, similar to 'cd' (although the latter, curiously, also completes *file* names).

        local IFS=$'\n' # Make sure that the output of compgen below is only split along lines, not also along spaces (which the default $IFS would do).
        COMPREPLY=($(compgen -o dirnames -- "$curToken"))

    elif [[ $curToken =~ ^[0-9]+/? ]]; then # Token is a number (optionally followed by a slash) -> replace the token to be completed with the absolute path of the directory N levels above, where N is the number specified.

        # Create a go-up-multiple-levels cd expression that corresponds to the number of levels specified.
        local strpath=$( printf "%${curToken%%/*}s" ) # This creates a string with as many spaces as levels were specified.
        local upDirSpec=${strpath// /../}  # Create the go-up-multiple-levels cd expression by replacing each space with '../'        

        # Expand to absolute path (ending in '/' to facilitate optional further completion) and return.
        local dir=$(cd "$upDirSpec"; echo -n "$PWD/")
        if [[ "$dir" == '//' ]]; then dir='/'; fi # In case the target dir turns out to be the root dir, we've accidentally created '//' in the previous statement; fix it.
        # !! Note that the path will appear *unquoted* on the command line and must therefore be properly \-escaped (e.g., a ' '  as '\ ').
        # !! Escaping is performed automatially by virtue of defining the compspec with '-o filenames' (passed to 'complete').
        COMPREPLY=("$dir") 

    else # Token is a name -> look for a prefix match among all the ancestral path components; use the first match found (i.e., the next match up in the hierarchy).

        # Determine if we should do case-insensitive matching or not, depending on whether cases-insensitive completion was turned on globally via ~/.inputrc or /etc/inputrc.
        # We do this to be consistent with the default command completion behavior.
        local caseInsensitive=0        
        bind -v | egrep -i '\bcompletion-ignore-case[[:space:]]+on\b' &>/dev/null && caseInsensitive=1

        # If we need to do case-INsensitive matching in this function, we need to make sure the 'nocasematch' shell option is (temporarily) turned on.
        local nocasematchWasOff=0
        if (( caseInsensitive )); then
            nocasematchWasOff=1
            shopt nocasematch >/dev/null && nocasematchWasOff=0
            (( nocasematchWasOff )) && shopt -s nocasematch >/dev/null
        fi

        local pathSoFar=''
        local matchingPath=''
        # Note: By letting the loop iterate over ALL components starting at the root, we end up with the *last* match, i.e. the one *lowest* in the hierarchy (closed to the current working folder).
        # !! We COULD try to return multiple matches, if applicable, but in practice we assume that there'll rarely be paths whose components have identical names or prefixes.
        # !! Thus, should there be multiple matches, the user can reinvoke the same command to change to the next-higher match (though the command must be typed again), and so forth.
        local parentPath=${PWD%/*}
        local IFS='/' # This will break our parent path into components in the 'for' loop below.
        local name
        for name in ${parentPath:1}; do
            pathSoFar+=/$name
            if [[ "$name" == "$curToken"* ]]; then
                matchingPath="$pathSoFar/"
            fi
        done

        # Restore the state of 'nocasematch', if necessary.
        (( caseInsensitive && nocasematchWasOff )) && shopt -u nocasematch >/dev/null

        # If match was found, return its absolute path (ending in / to facilitate optional further completion).
        # !! Note that the path will appear *unquoted* on the command line and must therefore be properly \-escaped (e.g., a ' '  as '\ ').
        # !! Escaping is performed automatially by virtue of defining the compspec with '-o filenames' (passed to 'complete').
        [[ -n "$matchingPath" ]] && COMPREPLY=("$matchingPath")

    fi  
}

# Assign the auto-completion function for up().
complete -o filenames -F _complete_up up 
```

# javascript - 在Javascript中等待一些异步任务完成的最简单方法？

> ID：10551499
> 
> 赞同：112
> 
> 时间：2012-05-11T12:39:59.937
> 
> 标签：javascript, node.js, asynchronous, mongoose, synchronous

我想删除一些 mongodb 集合，但这是一个异步任务。代码将是：

```
var mongoose = require('mongoose');

mongoose.connect('mongo://localhost/xxx');

var conn = mongoose.connection;

['aaa','bbb','ccc'].forEach(function(name){
    conn.collection(name).drop(function(err) {
        console.log('dropped');
    });
});
console.log('all dropped'); 
```

控制台显示：

```
all dropped
dropped
dropped
dropped 
```

`all dropped`在删除所有集合后确保打印的最简单方法是什么？任何第三方都可以用来简化代码。

* * *

## 回答 #1

> 赞同：129
> 
> 时间：2012-05-22T21:13:35.163

使用[承诺](http://www.html5rocks.com/en/tutorials/es6/promises/)。

```
var mongoose = require('mongoose');

mongoose.connect('your MongoDB connection string');
var conn = mongoose.connection;

var promises = ['aaa', 'bbb', 'ccc'].map(function(name) {
  return new Promise(function(resolve, reject) {
    var collection = conn.collection(name);
    collection.drop(function(err) {
      if (err) { return reject(err); }
      console.log('dropped ' + name);
      resolve();
    });
  });
});

Promise.all(promises)
.then(function() { console.log('all dropped)'); })
.catch(console.error); 
```

这会丢弃每个集合，在每个集合之后打印“dropped”，然后在完成时打印“all dropped”。如果发生错误，则显示为`stderr`。

* * *

## 上一个答案（这早于 Node 对 Promises 的原生支持）：

使用[Q](https://github.com/kriskowal/q)承诺或[Bluebird](https://github.com/petkaantonov/bluebird)承诺。

用**问**：

```
var Q = require('q');
var mongoose = require('mongoose');

mongoose.connect('your MongoDB connection string');
var conn = mongoose.connection;

var promises = ['aaa','bbb','ccc'].map(function(name){
    var collection = conn.collection(name);
    return Q.ninvoke(collection, 'drop')
      .then(function() { console.log('dropped ' + name); });
});

Q.all(promises)
.then(function() { console.log('all dropped'); })
.fail(console.error); 
```

与**蓝鸟**：

```
var Promise = require('bluebird');
var mongoose = Promise.promisifyAll(require('mongoose'));

mongoose.connect('your MongoDB connection string');
var conn = mongoose.connection;

var promises = ['aaa', 'bbb', 'ccc'].map(function(name) {
  return conn.collection(name).dropAsync().then(function() {
    console.log('dropped ' + name);
  });
});

Promise.all(promises)
.then(function() { console.log('all dropped'); })
.error(console.error); 
```

* * *

## 回答 #2

> 赞同：91
> 
> 时间：2012-05-11T13:33:58.553

我看到您正在使用`mongoose`，所以您在谈论服务器端 JavaScript。在这种情况下，我建议查看[异步模块](https://github.com/caolan/async)并使用`async.parallel(...)`. 你会发现这个模块真的很有帮助——它是为了解决你正在努力解决的问题而开发的。您的代码可能如下所示

```
var async = require('async');

var calls = [];

['aaa','bbb','ccc'].forEach(function(name){
    calls.push(function(callback) {
        conn.collection(name).drop(function(err) {
            if (err)
                return callback(err);
            console.log('dropped');
            callback(null, name);
        });
    }
)});

async.parallel(calls, function(err, result) {
    /* this code will run after all calls finished the job or
       when any of the calls passes an error */
    if (err)
        return console.log(err);
    console.log(result);
}); 
```

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2012-05-11T13:40:37.903

这样做的方法是向任务传递一个更新共享计数器的回调。当共享计数器达到零时，您知道所有任务都已完成，因此您可以继续正常流程。

```
var ntasks_left_to_go = 4;

var callback = function(){
    ntasks_left_to_go -= 1;
    if(ntasks_left_to_go <= 0){
         console.log('All tasks have completed. Do your stuff');
    }
}

task1(callback);
task2(callback);
task3(callback);
task4(callback); 
```

当然，有很多方法可以使这种代码更通用或可重用，并且[许多异步编程库](https://stackoverflow.com/questions/9432587/what-is-the-correct-way-to-chain-async-calls-in-javascript/9432771#9432771)中的任何一个都应该至少有一个函数来做这种事情。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2013-05-28T08:34:42.883

扩展@freakish 的答案， async 还提供了 each 方法，这似乎特别适合您的情况：

```
var async = require('async');

async.each(['aaa','bbb','ccc'], function(name, callback) {
    conn.collection(name).drop( callback );
}, function(err) {
    if( err ) { return console.log(err); }
    console.log('all dropped');
}); 
```

恕我直言，这使代码更加高效和清晰。我冒昧地删除了`console.log('dropped')`- 如果你想要它，请改用它：

```
var async = require('async');

async.each(['aaa','bbb','ccc'], function(name, callback) {
    // if you really want the console.log( 'dropped' ),
    // replace the 'callback' here with an anonymous function
    conn.collection(name).drop( function(err) {
        if( err ) { return callback(err); }
        console.log('dropped');
        callback()
    });
}, function(err) {
    if( err ) { return console.log(err); }
    console.log('all dropped');
}); 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2013-12-27T14:19:12.853

我这样做没有外部库：

```
var yourArray = ['aaa','bbb','ccc'];
var counter = [];

yourArray.forEach(function(name){
    conn.collection(name).drop(function(err) {
        counter.push(true);
        console.log('dropped');
        if(counter.length === yourArray.length){
            console.log('all dropped');
        }
    });                
}); 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2013-11-06T09:27:03.377

所有的答案都很老了。自 2013 年初以来，Mongoose 开始[逐渐](http://mongoosejs.com/docs/api.html#promise-js)支持所有查询的 Promise，因此我猜这将是按照所需顺序构建多个异步调用的推荐方式。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-12T19:32:00.113

使用`deferred`（另一个承诺/延迟实现），您可以执行以下操作：

```
// Setup 'pdrop', promise version of 'drop' method
var deferred = require('deferred');
mongoose.Collection.prototype.pdrop =
    deferred.promisify(mongoose.Collection.prototype.drop);

// Drop collections:
deferred.map(['aaa','bbb','ccc'], function(name){
    return conn.collection(name).pdrop()(function () {
      console.log("dropped");
    });
}).end(function () {
    console.log("all dropped");
}, null); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-03-12T16:20:19.567

如果您使用 Babel 或此类转译器并使用 async/await，您可以这样做：

```
function onDrop() {
   console.log("dropped");
}

async function dropAll( collections ) {
   const drops = collections.map(col => conn.collection(col).drop(onDrop) );
   await drops;
   console.log("all dropped");
} 
```

# php - 循环 SQL 行并对它们进行排序

> ID：10551501
> 
> 赞同：0
> 
> 时间：2012-05-11T12:40:02.353
> 
> 标签：php, javascript, sql, loops

正如答案中指出的那样，我不是要组织结果，而是要过滤它们。我很抱歉造成混乱！:D

我已经尽力用谷歌搜索解决这个问题，但我很难找到解决方案..

我有一个具有这种结构的 SQL 数据库，因为我正在尝试制作一个基本的 CMS：

## 页码 | 标题 | 页文 | 菜单栏

我想做的是在页面上做一个导航，循环所有的行，让它们看起来像链接，几个月前我的老师帮助我：

```
$query_MenuItems = "SELECT pageid,title,menu_par FROM v2 ORDER BY menu_par ASC";
$MenuItems = $mysqli->query($query_MenuItems);
$row_MenuItem = $MenuItems->fetch_assoc();
$totalRows_MenuItems = $MenuItems->num_rows;    

do { echo 
"<a href=\"?page={$row_MenuItem['pageid']}\">{$row_MenuItem['title']}</a><br/>";
} 
while ($row_MenuItem = $MenuItems->fetch_assoc());
} 
```

这很好用，但是我的问题是我不知道如何根据它们的 menu_par 值对不同的链接进行排序。

我觉得我已经尽我所能来解决这个问题，这让我感到压力很大

有什么办法可以像上面那样制作一个类似的循环，但是通过使用多个循环对其进行排序？：

```
while ($row_MenuItem = $MenuItems->fetch_assoc())
{
if ("{$row_MenuItem['menu_par']}" == '1') echo
"<a href=\"?page={$row_MenuItem['id']}\">{$row_MenuItem['title']}</a><br/>";
} 
```

我希望你们能帮助我:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T12:43:39.903

首先，我没有阅读整个问题，而是加载了所有数据，然后将其排序到 PHP 中似乎不是一个好主意。DBMS 就是为此而设计的，由于您对检索数据的查询，您应该通过执行类似操作来直接订购它们

```
SELECT pageid,title,menu_par FROM v2 order by menu_par 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T12:45:12.337

为什么不在`ORDER BY`您的 SQL 查询中使用？

```
SELECT pageid,title,menu_par FROM v2 ORDER BY menu_par ASC 
```

通过此查询（和 ORDER BY x ASC 子句），记录按 menu_par 值升序排列...

您可以在此处阅读有关此内容的更多信息：http: [//dev.mysql.com/doc/refman/5.0/en/order-by-optimization.html](http://dev.mysql.com/doc/refman/5.0/en/order-by-optimization.html)

如果您想根据`menu_par`值过滤结果（例如，您只想选择那些具有 的链接`menu_par == 1`）您将使用一个`WHERE`子句：

```
SELECT pageid,title,menu_par FROM v2 WHERE menu_par = 1 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T12:45:16.113

您应该使用`WHERE`子句在数据库中执行此操作。

```
SELECT pageid,title,menu_par FROM v2
WHERE menu_par = 1 
```

# ruby-on-rails - ActiveRecord::StatementInvalid ruby on rails 3.2

> ID：10551503
> 
> 赞同：0
> 
> 时间：2012-05-11T12:40:15.430
> 
> 标签：ruby-on-rails, heroku

我已经在 heroku 上部署并运行命令 heroku open。它在浏览器中打开正常。但是当我点击一个注册按钮时，它会停止并给出以下 heroku 日志。它在本地服务器上完美运行。但我也想在heroku服务器上运行。这是[http://ruby.railstutorial.org/chapters/sign-in-sign-out#sec:signin_success的示例](http://ruby.railstutorial.org/chapters/sign-in-sign-out#sec%3asignin_success)

```
2012-05-11T12:24:58+00:00 app[web.1]: Started GET "/users/new" for 122.179.134.45 at 2012-05-11 05:24:58 -0700
2012-05-11T12:24:58+00:00 app[web.1]: Processing by UsersController#new as HTML
2012-05-11T12:24:58+00:00 app[web.1]: Completed 500 Internal Server Error in 37ms
2012-05-11T12:24:58+00:00 app[web.1]:
2012-05-11T12:24:58+00:00 app[web.1]: :             SELECT a.attname, format_type(a.atttypid, a.atttypmod), d.adsrc, a.attnotnull
2012-05-11T12:24:58+00:00 app[web.1]: ActiveRecord::StatementInvalid (PG::Error: ERROR:  relation "users" does not exist
2012-05-11T12:24:58+00:00 app[web.1]:                 ON a.attrelid = d.adrelid AND a.attnum = d.adnum
2012-05-11T12:24:58+00:00 app[web.1]:              WHERE a.attrelid = '"users"'::regclass
2012-05-11T12:24:58+00:00 app[web.1]:               FROM pg_attribute a LEFT JOIN pg_attrdef d
2012-05-11T12:24:58+00:00 app[web.1]:                AND a.attnum > 0 AND NOT a.attisdropped
2012-05-11T12:24:58+00:00 app[web.1]:              ORDER BY a.attnum
2012-05-11T12:24:58+00:00 app[web.1]: ):
2012-05-11T12:24:58+00:00 heroku[router]: GET demoapp3708.heroku.com/users/new dyno=web.1 queue=0 wait=0ms service=44ms status=500 bytes=643
2012-05-11T12:24:58+00:00 app[web.1]:   app/controllers/users_controller.rb:8:in `new'
2012-05-11T12:24:58+00:00 app[web.1]:   app/controllers/users_controller.rb:8:in `new' 
```

Gemfile如下：

```
source 'https://rubygems.org'

gem 'rails', '3.2.3'
gem 'bootstrap-sass', '2.0.2'
gem 'jquery-rails', '2.0.0'
#We’ll use the state-of-the-art hash function called bcrypt to irreversibly encrypt the password    to form the password hash.
gem 'bcrypt-ruby', '3.0.1'
gem 'pg', '0.13.2'

group :development do
  gem 'rspec-rails', '2.9.0'
  gem 'guard-rspec', '0.5.5'
  gem 'capybara', '1.1.2'
  gem 'annotate', '~> 2.4.1.beta'
  gem 'sqlite3', '1.3.6'
end

group :test do
  gem 'rspec-rails', '2.9.0'
  gem 'capybara', '1.1.2'
  gem 'guard-spork', '0.3.2'
  gem 'spork', '0.9.0'
  gem 'factory_girl_rails', '1.4.0'    
  #gem 'webrat', '0.7.1'
end

group :assets do
  # gem 'execjs'
  gem 'therubyracer', :platforms => :ruby
  gem 'sass-rails',   '~> 3.2.4'
  gem 'coffee-rails', '~> 3.2.2'  
  gem 'uglifier', '>= 1.2.3'
end 
```

app/controllers/users_controller.rb 是：

```
class UsersController < ApplicationController

  def show
    @user = User.find(params[:id])
  end

  def new
    @user = User.new
  end 

  def create
    @user = User.new(params[:user])
    if @user.save
      sign_in @user
      flash[:success] = "Welcome to the Sample App!"
      redirect_to @user
    else
      render 'new'
    end
  end  
end 
```

在 heroku 运行 rake db:migrate

```
 PG::Error: ERROR:  relation "users" does not exist
 : ALTER TABLE "users" ADD COLUMN "password_digest" character varying(255) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T12:52:00.020

您是如何部署此代码的？数据库迁移是部署脚本的一部分。

否则，您将不得不使用手动运行它们

```
heroku run rake db:migrate 
```

# html - 将 .doc/docx 转换为 Html

> ID：10551504
> 
> 赞同：0
> 
> 时间：2012-05-11T12:40:16.303
> 
> 标签：html, css, ms-word, converter

我知道 Word 可以选择将文档保存到网页中，但是生成的结果不适合我的需要。

我希望将我的文档保存为具有单独文件夹的网页，其中包括图像和 .css 文件。但是 Word 只包含图像而不是 css 文件。

如何使用 Word 或其他工具（需要免费）来实现这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T21:37:03.490

鉴于 Java 是您的首选语言，您可以尝试 docx4j [免责声明：我管理它]。

请参阅[CreateHtml](https://github.com/plutext/docx4j/blob/master/src/main/java/org/docx4j/samples/CreateHtml.java)示例。

注意：docx4j 仅支持 docx（与传统二进制 .doc 不同；可以使用 LibreOffice 进行转换）。

# jquery - JQuery - 获取 js 文件中的实际行号

> ID：10551505
> 
> 赞同：0
> 
> 时间：2012-05-11T12:40:22.290
> 
> 标签：jquery

我使用下面的代码来处理 ajax 调用错误。我想添加该行的行号`'$('body').append(...'`以便能够回显它。行号是指我的 .js 文件中的行号。想知道是否有可能获得实际的行号？预先感谢您的回复。干杯。马克

```
$.ajax({
    type: "POST",
    url: "myfile.php",
    error: function(jqXHR, textStatus, errorThrown) {

        $('body').append('aj.ERROR! [' + jqXHR.status + ' : ' + errorThrown + ']');
    },
    success: function(data) {
        // somecode
    }
});​ 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-11T12:47:08.083

我知道公开当前行号的唯一方法是使用`window.onerror`具有以下签名的事件处理程序：

```
window.onerror = function(msg, url, line) { ... } 
```

所以*理论上*你可以在你的代码中触发一个真正的错误（`throw`？），然后在错误处理程序中进行附加，例如：

```
window.onerror = function(msg, url, line) {
    $('body').append(msg + ' at ' + url + ':' + line);
};

$.ajax({
    type: "POST",
    url: "myfile.php",
    error: function(jqXHR, textStatus, errorThrown) {
        throw 'aj.ERROR! [' + jqXHR.status + ' : ' + errorThrown + ']';
    },
    success: function(data) {
        // somecode
    }
});​ 
```

**编辑**它的工作原理（至少在 Chrome 中......） - [http://jsfiddle.net/alnitak/gLzY2/](http://jsfiddle.net/alnitak/gLzY2/)

# oracle - 为什么 Oracle 应用程序失败？

> ID：10551511
> 
> 赞同：0
> 
> 时间：2012-05-11T12:40:42.090
> 
> 标签：oracle

我有有限的 Oracle exp。我为 SQL Server 和 Oracle 编写了应用程序，asp.net c#。SQL Server 工作正常。Oracle 一个客户端无法运行该应用程序。日志显示 sp 启动，然后不执行任何操作。然后应用程序中止。

我的问题是如何调试正在发生的事情？是我应该关注的存储过程吗？

该应用程序在我们的 Oracle 服务器中进行了测试，并且可以在我们的测试服务器上运行。

我需要关于问题所在和/或如何发现问题所在的指导。然后我们可以考虑解决。以下是日志中的一些信息：

```
4-27-2012|INFO: Bootstrapper :  GetAllInstances(OPTFDashboard.Common.Modules.MissedMedications.Views.MedicineTileView)
04-27-2012|INFO: Bootstrapper : GetAllInstances(OPTFDashboard.Common.Modules.Orders.Views.OrderTileView)
04-27-2012|INFO: Bootstrapper : GetAllInstances(OPTFDashboard.Common.Modules.Schedules.Views.ScheduleTileView)
04-27-2012|INFO: Bootstrapper : GetAllInstances(OPTFDashboard.Common.Modules.MissingAllergies.Views.MissingAllergiesTileView)
04-27-2012|INFO: Bootstrapper : GetAllInstances(OPTFDashboard.Common.Modules.POWarnings.Views.POWarningsTileView)
04-27-2012|INFO: Bootstrapper : GetAllInstances(OPTFDashboard.Common.Modules.Decline.Views.DeclineTileView)
04-27-2012|INFO: Bootstrapper : GetAllInstances(OPTFDashboard.Common.Modules.CNA.Views.CNATileView)
04-27-2012|INFO: Bootstrapper : GetAllInstances(OPTFDashboard.Common.Modules.Improved.Views.ImprovedTileView)
04-27-2012|INFO: AutoGrid : ArrangeChildren. True, 0
04-27-2012|INFO: AutoGrid : Arranging children in 1 column(s) by 2 row(s).
04-27-2012|INFO: AutoGrid : ArrangeChildren. True, 11
04-27-2012|INFO: AutoGrid : Arranging children in 2 column(s) by 6 row(s).
04-27-2012|INFO: Bootstrapper : GetInstance(Caliburn.Micro.IWindowManager, '')
04-27-2012|INFO: Bootstrapper : GetInstance(OPTFDashboard.Common.UserInterface.MainWindow.MainWindowViewModel, '')
04-27-2012|INFO: Database : Query: SELECT MODULE_ID, DESCRIPTION FROM OGEN.DBD_C_MODULES WHERE ACTIVE = 1
04-27-2012|INFO: Database : Query: SELECT CODKEY, DESCR FROM OGEN.PAT_C_STATES WHERE FACILITY_KEY = 'BASE' ORDER BY DESCR
04-27-2012|INFO: Database : Query: SELECT CODKEY, DESCR FROM OGEN.PAT_C_FAC_REGION
04-27-2012|INFO: Database : Query: SELECT CORP_KEY, CORP_NAME FROM OGEN.GEN_M_CORPORATION ORDER BY CORP_NAME
04-27-2012|INFO: Bootstrapper : GetAllInstances(OPTFDashboard.Common.UserInterface.MainWindow.MainWindowView)
04-27-2012|INFO: Bootstrapper : GetAllInstances(OPTFDashboard.Common.UserInterface.MainWindow.FacilitySelectionView)
04-27-2012|INFO: Database : Query: SELECT R.*, S.MODULE_ID
                           FROM OGEN.GEN_M_USER_ROLE R 
```

这里的信息列表实际上并没有运行，这是我认为的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T12:56:19.763

oracle服务是否启动，连接字符串是否有效，可以tnsping oracle服务器吗？您是否设置了用户权限？

# delphi - 在辅助显示器上时 CPU 使用率高（窗口模式）

> ID：10551512
> 
> 赞同：0
> 
> 时间：2012-05-11T12:40:42.697
> 
> 标签：delphi, windows-xp, direct3d, direct3d9

我们的自定义 DirectShow 视频渲染器使用 Direct3D9。当在主显示器/显示器上以窗口模式（覆盖整个显示器表面）显示时，它在 CPU 使用率低的情况下表现良好，但是当它显示在辅助显示器上时，由于 DirectX 使用 cpu 来执行 CPU（内核）使用率非常高进行设备之间的传输。这只发生在 Windows XP 上。我使用适当的适配器创建 Direct3DDevice9，至少我认为是这样。首先，我获取指定窗口句柄的监视器句柄，然后使用 GetAdapterMonitor() 搜索与此监视器对应的 D3D 适配器。移动窗口并重新初始化设备时，我可以看到适配器从 0 变为 1，正如预期的那样。还有什么我应该做的吗？这是相关代码（Delphi）。

```
Adapter := D3DADAPTER_DEFAULT;
if (FWnd <> 0) and (FWnd <> INVALID_HANDLE_VALUE) then
begin
  monitor := MonitorFromWindow(FWnd, MONITOR_DEFAULTTONEAREST);
  for idxAdapter := 0 to D3D.GetAdapterCount - 1 do
    if D3D.GetAdapterMonitor(idxAdapter) = monitor then
    begin
      Adapter := idxAdapter;
      Break;
    end;
end;
Result := D3D.GetDeviceCaps(Adapter, D3DDEVTYPE_HAL, Caps);

PP.BackBufferCount := 1;
PP.BackBufferFormat := FFormat; // xrgb
PP.BackBufferWidth := FWidth;
PP.BackBufferHeight := FHeight;
PP.Flags := D3DPRESENTFLAG_VIDEO;
PP.PresentationInterval := D3DPRESENT_INTERVAL_ONE;
PP.SwapEffect := D3DSWAPEFFECT_DISCARD;

PP.hDeviceWindow := FWnd;
PP.Windowed := not FFullScreen;

D3D.CreateDevice(Adapter, D3DDEVTYPE_HAL, FWnd, D3DCREATE_MULTITHREADED or D3DCREATE_MIXED_VERTEXPROCESSING, @PP, Device); 
```

其他播放器和渲染器没有这个问题。MPC-HC 和 madVR 有这个问题，但修复了它。查看 MPC-HC 的代码，我找不到与我的操作方式有任何显着差异。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T07:18:53.887

您是否尝试将 BackBufferFormat 设置为 Caps.BackBufferFormat？据我所知 xrgb 不是通用格式，某些分辨率不支持。

# web-config - SQL Azure 中的连接池

> ID：10551515
> 
> 赞同：1
> 
> 时间：2012-05-11T12:40:44.367
> 
> 标签：web-config, connection-pooling, azure-sql-database

我正在开发一个 ASP.NET MVC 应用程序。此应用程序依赖于存储在 SQL Azure 数据库中的数据。当我登录到 SQL Azure 管理界面时，我注意到我的数据库有 17 个活动连接。依稀记得很久以前的数据库连接池的概念。出于某种原因，我想使用连接池，您需要在 web.config 文件中的连接字符串中添加一个设置。不过，就我的一生而言，我不记得或找不到有关设置的文档。

作为参考，我在连接字符串设置中使用 System.Data.SqlClient 作为提供。有人可以告诉我如何在 SQL Azure 中使用连接池吗？考虑到我是唯一一个访问数据库的人，17 个活动连接似乎很高。我想如果打开连接池，应该只出现 1 个活动连接。

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T06:10:27.347

连接池是客户端无法为 Sql Azure 配置的默认行为。默认情况下，您的应用程序应该获得连接池的好处。确保您的连接字符串是唯一的，因为将为具有不同字符串的连接创建一个新池。[MSDN 中的这篇文章](http://msdn.microsoft.com/en-us/library/8xx3tyca%28v=vs.110%29.aspx)指定：

> 打开新连接时，如果连接字符串与现有池不完全匹配，则会创建一个新池。每个进程、每个应用程序域、每个连接字符串以及在使用集成安全性时，每个 Windows 身份都将连接池化。连接字符串也必须完全匹配；以不同顺序为同一连接提供的关键字将分别汇集。

现在关于您不记得的设置。您可能一直在谈论[MARS（多个活动结果集）。](http://www.sqlteam.com/article/multiple-active-result-sets-mars)此功能[现在可](http://blogs.msdn.com/b/sqlazure/archive/2010/04/16/9997517.aspx)在 Sql Azure 上使用。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-05-11T17:11:22.507

我建议您阅读以下文章，该文章解释了如何正确设计与 SQL Azure 的连接，并且它还有一个 C# 基本示例代码向您展示如何：

[http://blogs.msdn.com/b/sqlazure/archive/2010/05/11/10011247.aspx](http://blogs.msdn.com/b/sqlazure/archive/2010/05/11/10011247.aspx)

# django - 使用 Apache 在 URL 中正确转义 %

> ID：10551518
> 
> 赞同：1
> 
> 时间：2012-05-11T12:40:56.833
> 
> 标签：django, apache, url, apache2

我有一个 Django 项目，其中有一个搜索页面，该页面通过 POST 获取输入并重定向到`/search/<search string>/`，该页面呈现结果。百分号 (%) 在搜索中用作通配符（tes%er 返回 testuser、tester 等，然后 url 看起来像这样：）`example.com/search/tes%25er/`并且在 Django 开发服务器上一切正常。如果我在 url 中手动写入 tes%er，它会自动更改为 tes%25er。

现在我正在使用 mod_wsgi 在 Apache 服务器上进行部署，当我的搜索页面重定向到`example.com/search/tes%er/`我收到服务器错误：`Bad Request. Your browser sent a request that this server could not understand.`. 如果我手动将“25”添加到 url，就像编码的 % 符号一样，它看起来就像开发服务器一样工作正常。

Apache 有没有办法自动转义 %-sign 并创建一个有效的 url，理解 % unscaped 还是我需要在构建 url 的搜索页面中做丑陋的黑客攻击？（我宁愿不做这种丑陋的黑客行为，因为这样用户就不能手动将 % 添加到 url 并让它工作）。

**编辑**：将查询从搜索页面发送到搜索 url 的代码。

```
if form.is_valid():
    if 'search_user' in request.POST:
        q = request.POST['search_user']
        return redirect('/search/'+q) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T14:14:55.033

正如 Ignacio 已经建议的那样，您不应重定向到无效的 url。所以回答你的问题：

您可以（或者说“应该”更好）不要要求您的 Apache 服务器转义您的 url。您转义 URL 的原因是某些字符具有其他含义。例如，获取一个查询字符串：

somedomain.com/?key=value

如果我们想在您的值中使用 a`?`或 a`=`您会遇到问题，因为您的服务器会认为您正在使用查询字符串的运算符。

- 符号也是`%`如此。当您的 apache 服务器看到一个 %-symbol 时，他认为他会找到一个 enconded 并尝试对其进行解码。如果您的查询字符串是`%20`，则 apache 会将其转换为空格，而您的意思是“wildcard20”。

总之：apache 解码你的字符串，所以你不希望他编码它。

但这并不能解决您的问题。您可以通过将代码更改为以下内容来解决您的问题：

```
from urllib import urlencode
if form.is_valid():
    if 'search_user' in request.POST:
        q = request.POST['search_user']
        return redirect('/search/?q='+urlencode(q)) 
```

如果您想知道：如果我的用户输入`/search/?q=%`; 在那种情况下，他会遇到问题，因为他输入了一个无效的地址。

希望这可以帮助 ：-）。

伍特

# python - LinkedIn JS API 令牌交换为 REST 令牌

> ID：10551523
> 
> 赞同：3
> 
> 时间：2012-05-11T12:41:28.003
> 
> 标签：python, linkedin

我正在使用 Python python-oauth2。尝试交换我的代币时收到错误消息。这是代码片段：

```
consumer = oauth.Consumer(consumer_key, consumer_secret)

client = oauth.Client(consumer)

client.request(access_token_url, "POST", headers={'xoauth_oauth2_access_token':'XXXXXXXXXX'})
({'status': '400', 'content-length': '83', 'transfer-encoding': 'chunked', 'vary': 'Accept-Encoding', 'server': 'Apache-Coyote/1.1', '-content-encoding': 'gzip', 'date': 'Thu, 10 May 2012 22:28:38 GMT', 'nncoection': 'close', 'content-type': 'application/x-www-form-urlencoded;charset=UTF-8', 'www-authenticate': 'OAuth realm="https%3A%2F%2Fapi.linkedin.com", oauth_problem="parameter_absent", oauth_parameters_absent="oauth_token%26oauth_verifier"'}, 'oauth_problem=parameter_absent&oauth_parameters_absent=oauth_token%26oauth_verifier') 
```

收到 400 条回复：

```
oauth_problem="parameter_absent", oauth_parameters_absent="oauth_token%26oauth_verifier" 
```

我无法获得 auth_verifier，因为这是 JSAPI 到 REST 的交换。我应该为通话做些什么不同的事情吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-12T01:31:16.180

您不会将 xoauth_oauth2_access_token 作为标头传递，而是作为查询参数传递。

# android - 无法确定 Android 设备上是否安装了 Google Play 商店

> ID：10551531
> 
> 赞同：21
> 
> 时间：2012-05-11T12:41:39.180
> 
> 标签：android, google-play

这是检查设备上已安装软件包的简单问题......在我将操作系统升级到 2.3.5 之前，我可以使用以下代码找到 Market/Play 商店：

```
private static final String GooglePlayStorePackageName = "com.google.market";

void someMethod() {
    packageManager = getApplication().getPackageManager();
    List<PackageInfo> packages = packageManager.getInstalledPackages(PackageManager.GET_UNINSTALLED_PACKAGES);
    for (PackageInfo packageInfo : packages) {
        if (packageInfo.packageName.equals(GooglePlayStorePackageName)) {
            googlePlayStoreInstalled = true;
            break;
        }
    }
} 
```

由于某些原因，更新后，我根本找不到表明应用程序已安装的包名称，尽管它在设备上，并且我可以访问市场。

包名变了吗？还是我看错了？

谢谢，

亚当。

**更新：**

这是检查是否安装了软件包的愚蠢方法……更好的方法是：

```
protected final boolean isPackageInstalled(String packageName) {
    try {
        application.getPackageManager().getPackageInfo(packageName, 0);
    } catch (NameNotFoundException e) {
        return false;
    }
    return true;
} 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-05-11T12:47:28.100

**请注意，这近 5 年的旧代码并不是最佳的，而且 Google 不喜欢您无缘无故地检查所有已安装的软件包。请检查其他答案。**

包名已更改，现在为 com.android.vending

* * *

尝试：

```
private static final String GooglePlayStorePackageNameOld = "com.google.market";
private static final String GooglePlayStorePackageNameNew = "com.android.vending";

void someMethod() {
    PackageManager packageManager = getApplication().getPackageManager();
    List<PackageInfo> packages = packageManager.getInstalledPackages(PackageManager.GET_UNINSTALLED_PACKAGES);
    for (PackageInfo packageInfo : packages) {
        if (packageInfo.packageName.equals(GooglePlayStorePackageNameOld) ||
            packageInfo.packageName.equals(GooglePlayStorePackageNameNew)) {
            googlePlayStoreInstalled = true;
            break;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-05-06T19:56:57.673

GooglePlayServices 有一个实用程序类，其中包含处理此问题的方法：

`isGooglePlayServicesAvailable(Context)`.

它为设备上播放服务的状态提供适当的错误对话框。

**API参考：**

[GoogleApiAvailability.isGooglePlayServicesAvailable(android.content.Context)](https://developers.google.com/android/reference/com/google/android/gms/common/GoogleApiAvailability#isGooglePlayServicesAvailable(android.content.Context))

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2016-02-10T15:39:00.980

正如迈克尔在评论中所说，Google Play 服务与 Google Play 商店不同。使用它来确定您的设备上是否安装了 Play 商店：

```
public static boolean isPlayStoreInstalled(Context context){
    try {
        context.getPackageManager()
                .getPackageInfo(GooglePlayServicesUtil.GOOGLE_PLAY_STORE_PACKAGE, 0);
        return true;
    } catch (PackageManager.NameNotFoundException e) {
        return false;
    }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-03-29T22:21:28.410

在大多数情况下，我们想知道是否安装了 Google Play 商店，以便在预加载一些应用页面的情况下启动它。

为什么我们不能这样做：

```
final String appPackageName = getPackageName(); // get your app package name
try {
    Uri uri = Uri.parse("market://details?id=" + appPackageName);
    startActivity(new Intent(Intent.ACTION_VIEW, uri));
} catch (android.content.ActivityNotFoundException anfe) {
    // Google Play Store is not available.
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-07-17T07:17:51.273

使用此代码，您可以检查您的设备上是否安装了**Google Play 服务。**

```
int val=GooglePlayServicesUtil.isGooglePlayServicesAvailable(MainActivity.this);
            if(val==ConnectionResult.SUCCESS)
            {
                play_installed=true;
            }
            else
            {
                play_installed=false;
            } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-09-02T12:56:18.257

检查是否已安装并激活 Google Play 商店：

**科特林**

```
companion object {
    private const val GOOGLE_PLAY_STORE_PACKAGE = "com.android.vending"
}

private fun isPlayStoreInstalled(context: Context): Boolean {
    return try {
        val packageInfo = context.packageManager.getPackageInfo(GOOGLE_PLAY_STORE_PACKAGE, 0)
        packageInfo.applicationInfo.enabled
    } catch (exc: PackageManager.NameNotFoundException) {
        false
    }
} 
```

**爪哇**

```
 private static final String GOOGLE_PLAY_STORE_PACKAGE = "com.android.vending";

   private final boolean isPlayStoreInstalled(Context context) {
      boolean flag;
      try {
         PackageInfo packageInfo = context.getPackageManager().getPackageInfo(GOOGLE_PLAY_STORE_PACKAGE, 0);
         flag = packageInfo.applicationInfo.enabled;
      } catch (PackageManager.NameNotFoundException exc) {
         flag = false;
      }
      return flag;
   } 
```

# sql-server - Unicode 转换，数据库问题（Delphi 2007 到 XE2）

> ID：10551535
> 
> 赞同：3
> 
> 时间：2012-05-11T12:41:57.190
> 
> 标签：sql-server, sql-server-2008, delphi, unicode, ansi

目前，我正在将我们所有的 Delphi 2007 代码库更新到 Delphi XE2。最大的考虑是 ANSI 到 Unicode 的转换，我们通过将所有基本类型（char/string）重新定义为 ANSI 类型（ansichar/ansistring）来处理这个问题。这在我们的许多程序中都有效，直到我开始使用数据库。

当我将从文件读取的信息存储到 SQL Server 2008 数据库中的程序转换时，问题就开始了。突然间，使用字符串定位数据的简单查询会失败，例如：

```
SELECT id FROM table WHERE name = 'something' 
```

该`name`字段是一个`varchar`. 我发现我可以通过在字符串名称前加上`N`. 我的印象是*只能*`varchar`存储ANSI字符，但它似乎是存储Unicode？

 *更多信息：Delphi 中的 name 字段是`string[13]`，但我尝试删除`[13]`. 数据库排序规则是`SQL_Latin1_General_CP1_CI_AS`. 我们使用 ADO 与数据库交互。连接信息存储在 ODBC 管理器中。

注意：由于 Panagiotis 的一些指导，我已经解决了我的实际问题。我们从地图文件中读取的名称是`array[1..24] of AnsiChar`. 该值被隐式转换为`string[13]`，其中包括空字符。因此，一个 5 个字符的名称实际上是作为 5 个字符 + 8 个空字符存储在数据库中的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T13:42:20.487

*varchar*字段不存储 Unicode 字符。它们将 ASCII 值存储在由字段排序规则指定的代码页中。当您尝试存储 Unicode 或来自不同代码页的数据时，SQL Server 将[尝试将字符转换为正确的代码页。](http://msdn.microsoft.com/en-us/library/ms175074%28v=sql.105%29)您可以禁用此功能，但最好的选择是通过在应用程序中使用*nvarchar*字段和 UnicodeString来避免整个混乱。

您提到您将所有字符类型更改为 ANSI，而不是应用程序中的 UNICODE 类型。如果你想使用 UNICODE，你应该使用像 UnicodeString 这样的 UNICODE 类型。否则，您的值将在发送到您的服务器时转换为 ANSI。当您创建发送到服务器的 AnsiString 时，此转换由您的代码完成。

顺便说一句，您的 select 语句在字段中存储一个 ASCII 值。如果要将其存储为 unicode 值，则必须在该值前面加上 N，例如

```
SELECT id FROM table WHERE name = N'something' 
```

即使这样也不能保证您的数据将以 Unicode 格式到达服务器。如果将语句存储在 AnsiString 中，则整个语句在发送到服务器之前将转换为 ANSI。如果您的应用程序进行了错误的转换，您最终会在服务器上得到损坏的数据。

解决方案很简单，只需使用参数化语句将 unicode 值作为 unicode 参数传递并存储在 NVarchar 字段中。它速度更快，避免了所有转换错误并防止 SQL 注入攻击。*

# android - CSS 媒体查询未按预期运行

> ID：10551536
> 
> 赞同：0
> 
> 时间：2012-05-11T12:42:00.687
> 
> 标签：android, android-layout, css, media-queries

我已将我的网站转换为使用 CSS3 媒体查询的 android 兼容性（我只是更改了 CSS）。我的 android 设备尺寸为 1280x 600。它在 android 设备中运行良好。

但是当我把我的桌面分辨率调到 1280 时，设计就改变了（就像我为安卓设备写的一样）。但它不应该是这样的。

仅适用于我在@media only screen 和 (max-device-width:1280px){ } 下面使用 css 的设备

我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T12:47:10.003

该查询会影响最大为 1280 像素的所有设备，而不仅仅是移动设备。

# javascript - 将html代码放入textarea

> ID：10551537
> 
> 赞同：4
> 
> 时间：2012-05-11T12:42:02.697
> 
> 标签：javascript, html

我有一个 div，我想把它的 innerHTML 放在 textarea 中，问题是 div 内容带有 html 标签，当我将它放在 textarea 中时，它不显示已执行的 html 代码，但它显示带有 html 标签的文本。我想要在 textarea 中执行的 html 代码，我该如何实现呢？我已经通过网络搜索了所有但无法找到它。任何形式的帮助将不胜感激

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-11T12:47:33.643

而不是`textarea`你可以使用`div`contenteditable[属性](https://developer.mozilla.org/en/HTML/Content_Editable)：

```
<div contenteditable="true">
  This text can be edited by the user.
</div> 
```

# c - 如何检查 Windows 用户是否在 C 中具有管理员权限？

> ID：10551538
> 
> 赞同：5
> 
> 时间：2012-05-11T12:42:10.787
> 
> 标签：c, windows, if-statement

有没有办法有条件地检查（严格在 C 中）Windows 用户是否具有管理员权限？

我希望以编程方式执行此操作（不仅仅是告诉用户“以管理员身份运行”）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-11T14:12:54.840

有几种根本不同的方式。不幸的是，最常见的是相当乏味。它涉及查找当前用户的 SID，然后查找他所属的组，然后查找其中一个是否是 Administrators 组：

```
#include <windows.h> 
#include <vector>

bool is_administrator() { 
    HANDLE access_token; 
    DWORD buffer_size = 0; 
    PSID admin_SID; 
    TOKEN_GROUPS *group_token = NULL; 
    SID_IDENTIFIER_AUTHORITY NT_authority = SECURITY_NT_AUTHORITY; 

    if (!OpenProcessToken(GetCurrentProcess(),TOKEN_READ,&access_token)) 
        return false; 

    GetTokenInformation( 
        access_token, 
        TokenGroups, 
        group_token, 
        0, 
        &buffer_size 
        ); 

    std::vector<char> buffer(buffer_size);

    group_token = 
        reinterpret_cast<TOKEN_GROUPS*>(&buffer[0]); 

    bool succeeded = GetTokenInformation( 
        access_token, 
        TokenGroups, 
        group_token, 
        buffer_size, 
        &buffer_size 
        ); 

    CloseHandle(access_token); 
    if (!succeeded) 
        return false;

    if (!AllocateAndInitializeSid( 
        &NT_authority, 
        2, 
        SECURITY_BUILTIN_DOMAIN_RID, 
        DOMAIN_ALIAS_RID_ADMINS, 
        0,0,0,0,0,0, 
        &admin_SID 
        )) 
    {
        return false; 
    }

    bool found=false; 
    for(int i=0; !found && i < group_token->GroupCount; i++) 
        found = EqualSid(admin_SID,group_token->Groups[i].Sid); 
    FreeSid(admin_SID); 
    return found; 
} 
```

还有另一种更简单的方法：

```
bool is_administrator() 
{ 
        bool result; 
        DWORD rc; 
        wchar_t user_name[256]; 
        USER_INFO_1 *info; 
        DWORD size = sizeof( user_name ); 
        GetUserNameW( user_name, &size); 
        rc = NetUserGetInfo( NULL, user_name, 1, (byte **) &info ); 
        if ( rc != NERR_Success ) 
                return false; 
        result = info->usri1_priv == USER_PRIV_ADMIN; 
        NetApiBufferFree( info ); 
        return result; 
} 
```

在任何一种情况下，如果您有一个域，事情可能会有点麻烦，因为特定用户可能是本地计算机上的管理员，但不是域上的管理员，反之亦然。查找信息不一定有太大变化，但您可能需要考虑一下才能弄清楚您真正想要什么。

编辑：正如@Benj 指出的那样，第一种方法确实可以使用一些更新。虽然我已经修复了它存在的明显漏洞，但它仍然是一个巨大的、单一的功能，没有异常安全性，而且通常是相当过时的编码风格。也许需要进行一个小更新：

```
#include <windows.h> 
#include <vector>
#include <algorithm>

class sid {
    PSID s;
public:
    sid(SID_IDENTIFIER_AUTHORITY auth, std::vector<DWORD> sub_auths) {
        DWORD count = sub_auths.size();
        sub_auths.resize(7, DWORD());

        if (!AllocateAndInitializeSid( 
            &auth,
            count, 
            sub_auths[0], sub_auths[1], sub_auths[2], sub_auths[3],
            sub_auths[4], sub_auths[5], sub_auths[6], sub_auths[7],
            &s 
            )) 
        {
            throw std::runtime_error("Unable to allocate Admin SID");
        }
    }

    sid(PSID const &p=NULL) : s(p) {}
    bool operator==(sid const &r) const { return EqualSid(s, r.s); }
};

class access_token {
    HANDLE token;
public:
    access_token(HANDLE PID=GetCurrentProcess(), DWORD access=TOKEN_READ) {
        if (!OpenProcessToken(PID, access, &token))
            throw std::runtime_error("Unable to open process token");
    }
    operator HANDLE() { return token; }
    ~access_token() { CloseHandle(token); }
};

std::vector<sid> get_group_sids() {
    DWORD buffer_size = 0; 
    TOKEN_GROUPS *group_token = NULL; 
    std::vector<sid> groups;
    access_token token;

    GetTokenInformation(token, TokenGroups, group_token, 0, &buffer_size);

    std::vector<char> buffer(buffer_size);

    group_token = reinterpret_cast<TOKEN_GROUPS*>(&buffer[0]);

    if (GetTokenInformation(token, TokenGroups, group_token, buffer_size, &buffer_size))
        for (int i=0; i<group_token->GroupCount; i++)
            groups.push_back(group_token->Groups[i].Sid);
    return groups;
}

bool is_administrator() {
    std::vector<sid> groups = get_group_sids();

    SID_IDENTIFIER_AUTHORITY NT_authority = SECURITY_NT_AUTHORITY;
    std::vector<DWORD> sub_auths;

    sub_auths.push_back(SECURITY_BUILTIN_DOMAIN_RID);
    sub_auths.push_back(DOMAIN_ALIAS_RID_ADMINS);

    sid admin_SID(NT_authority, sub_auths);

    return std::find(groups.begin(), groups.end(), admin_SID) != groups.end();
}

#ifdef TEST
#include <iostream>
#include <iomanip>

int main() {
    std::cout << std::boolalpha << is_administrator() << "\n";
}

#endif 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-10-21T21:01:07.253

一种略有不同（更短？更简单？）的方法改编自 MSDN 上的一些提示：

```
PSID administrators_group = NULL;
SID_IDENTIFIER_AUTHORITY nt_authority = SECURITY_NT_AUTHORITY;
BOOL result = AllocateAndInitializeSid( &nt_authority, 2, SECURITY_BUILTIN_DOMAIN_RID, DOMAIN_ALIAS_RID_ADMINS, 0, 0, 0, 0, 0, 0, &administrators_group);
BOOL is_user_admin = FALSE;
if (result)
{
    CheckTokenMembership(NULL, administrators_group, &is_user_admin);
    FreeSid(administrators_group);
}

if (is_user_admin)
{
    // do something here for admin users...
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-11T12:48:01.360

当然你需要打电话：

```
OpenThreadToken() 
```

获取用户的令牌。

```
GetTokenInformation(hToken, TokenGroups, NULL, 0, &dwNeeded) 
```

获取令牌组信息的大小（并分配足够的空间）

```
GetTokenInformation(hToken, TokenGroups, pTokenGroups, dwSize, &dwNeeded) 
```

获取本地组

```
AllocateAndInitializeSid(&SIDAuthNT, 2, SECURITY_BUILTIN_DOMAIN_RID, DOMAIN_ALIAS_RID_ADMINS, 0, 0, 0, 0, 0, 0, &psidAdministrators); 
```

获取管理员的 SID

```
EqualSid() 
```

将该 SID 与本地组中的 SID 进行比较。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2014-06-11T17:27:04.427

您应该使用 SHELL32 中的 IsUserAnAdmin

# relational-database - 是什么让访问 OLAP 多维数据集/数据集市和类似数据结构比访问关系数据库更快？

> ID：10551541
> 
> 赞同：2
> 
> 时间：2012-05-11T12:42:13.183
> 
> 标签：relational-database, olap, database-performance, olap-cube, datamart

是什么让访问 OLAP 多维数据集/数据集市和类似数据结构比访问关系数据库更快？

**编辑**

将尽快提供 200 的赏金。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T11:35:18.093

我会说主要是因为不同的目的。

OLAP 多维数据集/数据集市主要用于业务用户的数据分析的读取模式，而我假设在提到关系数据库时，您正在谈论需要例如 ACID 事务的 OLTP 使用。

这些不同的目的意味着：

*   不同的实现约束导致不同的数据结构；只读数据结构比读/写交易对手快得多；面向行的 DB 对于 OLTP 的使用非常好，但对于 OLAP 的使用来说效率很低（因为无用的信息被访问），因为您主要想访问整个列/度量（因此关于垂直 DB 的嗡嗡声；请注意，内存中的 OLAP系统也是面向列的）。
*   对于非常大的系统，OLAP 系统也可以执行某些维度聚合的一些预计算。
*   不同的内容：不需要整个“运营”数据，业务模型可能会被业务用户简化为分析目的；然后可以使用数据子集，可以在创建维度时预先完成连接，等等......

此外，OLAP 具有更强大的语言 (MDX)，具有更高的概念，如层次维度；实现可以利用这一点并提出针对这些概念优化的内部数据结构。

我的 2 美分。

# css - 非扩展容器 div

> ID：10551543
> 
> 赞同：-1
> 
> 时间：2012-05-11T12:42:39.757
> 
> 标签：css, layout, html

我正在尝试设置一个基本布局，无论用户设置什么分辨率，页眉和页脚都会在页面宽度上进行。

我已经解决了这个问题，但现在我遇到了一个问题，即主容器 div 无法正确扩展高度以包含其中的 div。无论您更改什么高度或最小高度样式，它似乎都只会扩展到某个高度，然后就不会再进一步​​了。

这是基本结构：

```
<div id="page">
    <div id="content">
    </div>

</div>
<div id="footClear"></div>

<div id="footer">
</div> 
```

页脚代码是强制页脚粘在页面底部，无论主容器的高度如何（id="page"）

我对这些部分的 CSS 是：

```
#page {
margin:0 auto;
width:1000px;
background:red;
padding:0px;
min-height:100%;
position:relative;
margin-bottom:-47px;
}

#content {

}

#footer {
width:100%;
height:22px;
position:relative;
margin:0 auto;
background:#000000;
text-align:center;
padding-top:3px;
font-size:12px;
}

#footClear {
    height:22px;
    clear:both;
} 
```

如果您想看一下，这里有指向我网站的链接：www.therapyoracle.co.uk/new

可以看到页面 div 是红色的，并且没有进行向下页面。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T12:46:56.750

如果你把身高从你身上拿走，`body`这将为你解决如下问题

```
body {
    font-family: "Lucida Sans Unicode", "Lucida Grande", sans-serif;
    font-size: 14px;
    padding: 0;
    margin: 0;
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T12:48:20.207

在您的实时站点上，`#page`已`height: 100%`设置，这导致了问题。

它来自你的`ie6.css`！这就是您尝试使其仅在 IE6 中加载的方式：

```
<!—[if lt IE 7]>
<link rel="stylesheet" type="text/css" href="assets/css/ie6.css" />
<![endif]—&gt; 
```

上面 HTML 中的连字符是错误的。用这个替换那个 HTML：

```
<!--[if lt IE 7]>
<link rel="stylesheet" type="text/css" href="assets/css/ie6.css" />
<![endif]--> 
```

`ie6.css`然后只会在 IE6 中加载，而不是在所有浏览器中加载，您的问题将得到解决。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T12:51:58.053

ie6.css中的删除`margin-bottom:-47px;`和删除`#page {height: 100%;}`

# iphone - 如何关闭 QLPreviewController 上显示的 Popover

> ID：10551547
> 
> 赞同：0
> 
> 时间：2012-05-11T12:42:44.650
> 
> 标签：iphone, ios, ipad

如何关闭弹出窗口显示在`QLPreviewController`. 该弹出窗口包含打印选项。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T06:37:28.323

似乎我们无法控制此弹出窗口。我已经通过模拟触摸事件来消除弹出框来解决这个问题。

[参考这个来模拟触摸事件](https://stackoverflow.com/questions/9496761/how-to-fire-uibarbuttonitem-click-event-programmatically)

# java - 即使我将布尔值设置为自动为假，如果语句不起作用

> ID：10551549
> 
> 赞同：1
> 
> 时间：2012-05-11T12:42:54.603
> 
> 标签：java, if-statement

```
grass.addActionListener(new ActionListener() {
@Override
public void actionPerformed(ActionEvent arg0) {
    pm = false;
    if(pm=false){
    drawGrassBlock(x1, y, Color.green, size, size2);
    }
    }
}); 
```

这是我的代码，无论出于何种原因，if 语句什么都不做......我将布尔值设置为 false，并告诉它在 if 语句中打印一个字符串，但控制台不会返回任何内容，这意味着它没有正确“进入”。我告诉它打印布尔值及其打印错误，所以请帮忙！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T12:44:03.013

做

```
if(pm == false) 
```

代替

```
if(pm = false) 
```

使用单`=`将设置`pm`为`false`
使用双`==`将`pm`与`false`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T12:44:06.757

那是 中的赋值`if`，而不是相等比较。从Java 语言规范的第***15.26 节赋值运算符：***

> 在运行时，赋值表达式的结果是赋值发生后变量的值。

意思`pm = false`是总是的结果`false`，所以`if`永远不会进入分支。

改成：

```
if (false == pm) // or if (!pm) 
```

# drupal-7 - drupal 7在page.tpl.php中定位特定数组

> ID：10551550
> 
> 赞同：1
> 
> 时间：2012-05-11T12:43:00.920
> 
> 标签：drupal-7, drupal-theming

我有一种情况，我需要满足两个不同的条件才能将给定节点的标题打印到页面上（下面的这一点来自我的 page.tpl）：

```
<?php if 
($title && ($user->uid == 1) || $title && ($page['#object']['type']['blog_post'])
/* is the node a full blog post? */
): ?> 
```

我只想在用户登录时显示节点的标题。这是有效的，但我不确定如何显示我的特定节点类型的标题。显然我正在深入到阵列的错误部分。但我似乎无法弄清楚阵列的哪一部分将满足我的条件。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-12T01:35:17.300

当显示的页面是节点时，您可以在 page.tpl.php 中使用 $node 变量。节点类型存储在 $node->type 中。但仅适用于节点页面。'blog_post' 类型的节点页面显示完整的博客文章。

```
<?php if(isset($node) && $node->type == 'blog_post');?>
  <?php print $title; ?>
<?php endif?> 
```

在 page.tpl 将仅在您类型的完整节点上打印标题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T13:40:17.733

您可以使用 node.tpl.php 来处理特定的节点参数，您可以在 /modules/node/node.tpl.php 中找到 node.tpl.php

节点模板为您提供用于检查该节点的视图模式 ($view_mode) 和 $title 的参数。

PS，如果你想检查你的用户是否登录，drupal 为你提供了一个函数 user_is_logged_in()

# php - php只有数字验证功能

> ID：10551551
> 
> 赞同：1
> 
> 时间：2012-05-11T12:43:04.490
> 
> 标签：php, validation

我只想为数字创建一个验证函数，实际上我有那些可以正常工作的函数，我尝试自己创建一个，但不幸的是它不起作用。以下是字母数字和其他工作正常：

```
// Validators
private function custom($validator, $value)
{
    return call_user_func($validator, $value, $this->request, $this->id);
}

private function alphanumeric($value, $custom)
{
    return preg_match('/^(['.$custom.'a-z0-9_]*)$/i', $value);
}

private function valid_email($value)
{
    return preg_match('/^\S+@\S+\.\S+$/', $value);
} 
```

我试图通过修改字母数字来创建一个：

```
private function numbers_only($value, $custom)
{
    return preg_match('/^(['.$custom.'0-9_]*)$/i', $value);
} 
```

这个有什么问题？

编辑：我还有一个 JS 帮助表单，对于字母数字，它是：

```
Form.prototype.alphanumeric = function(value, custom)
{
    return !value.replace(new RegExp('['+custom+'a-z0-9_]', 'ig'), '').length;
}; 
```

仅用于数字的 JS 是什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-11T12:47:24.440

采用

```
is_numeric($value); 
```

返回是真还是假

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-11T12:44:40.753

如果您只需要数字，请`$custom`从函数中删除该部分。这`/i`意味着不区分大小写的匹配，它与数字匹配无关，因此可以删除。

```
private function numbers_only($value)
{
    return preg_match('/^([0-9]*)$/', $value);
} 
```

上面的表达式将匹配零个或多个数字，因此允许空白输入。要至少要求一个数字，请更改`*`为`+`

```
return preg_match('/^([0-9]+)$/', $value); 
```

并且`[0-9]+`可以简写为`\d+`。由于您没有在匹配数组中捕获值，因此不需要通过包含`()`捕获组而增加的额外开销。这也可以省略。

```
return preg_match('/^\d+$/', $value); 
```

### 或者完全跳过正则表达式......

最后，如果您已经做到了这一点并且只匹配整数，那么这样做会更容易且资源消耗更少：

```
// If you really intend to match numbers only, and not all numeric values
// which might include .,
function numbers_only($value)
{
  return ctype_digit(strval($value));
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2019-04-05T09:21:50.980

在 PHP 中，对于“仅数字”验证，您可以使用不同的方法：

*   is_int 或 is_integer
*   is_numeric
*   常用表达
*   ctype_digit
*   过滤器变量

**is_integer()**

对于此函数，这些值无效：“0010”、“123”

**is_numeric()**

对于此函数，这些值有效：1.3、+1234e44 和 0x539

**filter_var()**

对于此函数，“00123”值无效

**结论**

it seems that only **regex** and **ctype_digit** work always fine.

**TEST**

[a simple test here](http://phpfiddle.org/lite/code/z1zx-csdg)

# spring - 将值注入 JPA-Table-Annotation

> ID：10551553
> 
> 赞同：0
> 
> 时间：2012-05-11T12:43:10.640
> 
> 标签：spring, jpa, annotations, code-injection

我有一个想要用于 2 个表的 JPA 实体。

```
@Entity
@Table(name="table_name_should_be_injected")
class MyEntity{
  // Implementation goes here
} 
```

所以我想用Spring注入表名。这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T12:50:48.357

请不要追求这种设计路线。它会给您的解决方案增加一个完全不必要的复杂程度，它违背了 JPA 规范和意图，它会让其他任何人看着您的解决方案摸不着头脑。

在 JPA 中实现这一点的正确方法是使用抽象基类和`@Inheritance(strategy=TABLE_PER_CLASS)`（请参阅[@Inheritance](http://docs.oracle.com/javaee/6/api/javax/persistence/Inheritance.html)）。

# vector - 需要一种用于 3D 矢量交集的算法

> ID：10551555
> 
> 赞同：0
> 
> 时间：2012-05-11T12:43:16.643
> 
> 标签：vector, 3d, geometry, line, intersection

我有 2 个向量，每个向量由 2 `Point3D`（原点和方向）定义。我需要找出他们的交点。一点点帮助总是受欢迎的。我将发布我的函数，这给了我错误的输出。

```
public static CurvIntersect3D Intersect2Linii3D (Vector3D dr1, Vector3D dr2) {
    CurvIntersect3D result = new CurvIntersect3D(0, null);

    double x = Math3D.VectorNorm3D(dr1.getDirectie());
    double t = Math3D.VectorNorm3D(dr2.getDirectie());
    double cosa = (dr1.getDirectie().getX()*dr2.getDirectie().getX() + dr1.getDirectie().getY()*dr2.getDirectie().getY() + dr1.getDirectie().getZ()*dr2.getDirectie().getZ()) / (t*x);
    Punct3D p1 = dr1.getOrigine();
    Punct3D p2 = new Punct3D(), p3 = new Punct3D();
    for (int i=0; i<3; i++)
    {
        p2.set(i, dr1.getOrigine().get(i) + dr1.getDirectie().get(i));
        p3.set(i, dr1.getOrigine().get(i) + dr2.getDirectie().get(i));
    }

    Matrici.Matrice3x3 rot = Math3D.GetMatriceRotatie(p1, p2, p3);
    Punct3D orig = new Punct3D();
    for (int i=0; i<3; i++)
        orig.set(i, rot.getElement(i, 0) * (dr2.getOrigine().getX()-dr1.getOrigine().getX()) +
                    rot.getElement(i, 1) * (dr2.getOrigine().getY()-dr1.getOrigine().getY()) +
                    rot.getElement(i, 2) * (dr2.getOrigine().getZ()-dr1.getOrigine().getZ()));

    x = orig.getY() - orig.getZ()* cosa / Math.sqrt(1 - cosa*cosa);
    p1 = new Punct3D();
    for (int i=0; i<3; i++)
        p1.set(i, dr1.getOrigine().get(i) + x*dr1.getDirectie().get(i));
    result.setCount(1);
    result.add(p1);
    return result;
} 
```

CurvIntersec3D 是一个存储点数组及其长度的结构。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-11T15:41:19.047

如前所述，两条线可能不会在一个点相交。一般来说，您可以做的最好的事情是在 line1 上找到最接近 line2 的点，反之亦然。连接这两个点以创建*共同的法线*方向。

给定两条穿过 3D 点`r1=[r1x,r1y,r1z]`并`r2=[r2x,r2y,r2z]`具有单位方向的线`e1=[e1x,e1y,e1z]`，`e2=[e2x,e2y,e2z]`您可以找到线上最接近另一条线的点，如下所示：

1.  找到方向投影`u=Dot(e1,e2)=e1x*e2x+e1y*e2y+e1z*e2z`
2.  如果`u==1`那么线是平行的。不存在交叉点。
3.  找到分离投影`t1=Dot(r2-r1,e1)`和`t2=Dot(r2-r1,e2)`
4.  沿 line1 查找距离`d1 = (t1-u*t2)/(1-u*u)`
5.  沿 line2 查找距离`d2 = (t2-u*t1)/(u*u-1)`
6.  找到 line1 上的点`p1=Add(r1,Scale(d1,e1))`
7.  找到 line2 上的点`p2=Add(r2,Scale(d2,e2))`

注意：您必须将方向作为单位向量，`Dot(e1,e1)=1`并且`Dot(e2,e2)=1`。该函数`Dot()`是向量点积。该函数`Add()`将向量的分量相加，该函数将向量`Scale()`的分量与一个数字相乘。

祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T13:55:02.553

你确定你的线有交点吗？

如果有保证，那么问题就相当简单：获取线的参数方程，求解两个线性方程组，如下所示：

A_X0+t*A_Dir_X = B_X0+u*B_DirX ，其中 X0 是基点，Dir 是方向向量（考虑任何具有非零叉积的坐标对）

如果不是，那么首先需要计算两条[斜线](http://en.wikipedia.org/wiki/Skew_lines)之间的距离。如果距离为零，那么我们可以找到交点。

# php - 无法连接到 mysql：MySQL 服务器已消失

> ID：10551559
> 
> 赞同：1
> 
> 时间：2012-05-11T12:43:28.890
> 
> 标签：php, mysql

不久前我开始学习mysql，现在我有问题，我不能自己解决。我正在尝试使用 php 连接到 mysql 服务器。我的管理员给了我 ip、端口、登录名、密码和数据库名称。php 文件如下所示：

```
$hostname = '192.168.1.20:1433';
$username = "h";
$password = "h";
$dbName = "mydb";
mysql_connect($hostname,$username,$password) OR DIE(mysql_error());
mysql_select_db($dbName) or die(mysql_error());
$query = "SELECT * FROM `insy` WHERE 1;";
$result=mysql_query($query) or die(mysql_error());
echo "works!";
mysql_close(); 
```

当我运行页面时，几分钟后它什么也没做，然后出现错误：警告：mysql_connect() [function.mysql-connect]：MySQL 服务器已在 N:\home\192.168.1.19\www\phlib.php 中消失12

```
Warning: mysql_connect() [function.mysql-connect]: Error while reading greeting packet. PID=1908 in N:\home\192.168.1.19\www\phlib.php on line 12

Warning: mysql_connect() [function.mysql-connect]: MySQL server has gone away in N:\home\192.168.1.19\www\phlib.php on line 12
MySQL server has gone away 
```

第 12 行是：

```
mysql_connect($hostname,$username,$password) OR DIE(mysql_error()); 
```

我尝试通过控制面板创建 ODBC Sql Server -> 管理 - 使用相同的参数 - 它工作正常，连接正常，我可以看到 Db。

请告诉我，我的错在哪里？我希望，我很清楚。

感谢帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T12:49:09.150

`mysql_ping($conn)`如果您的服务器连接丢失， 您可以尝试。[http://php.net/manual/en/function.mysql-ping.php](http://php.net/manual/en/function.mysql-ping.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-10T22:12:23.660

我刚刚解决了这个问题..问题是当我在 MySql 中创建一个新用户时，在写入用户之后，服务器会询问您“服务器”的位置，然后您输入 localhost:8080 .. 错误！不要放端口！！只是本地主机。我就是这样解决它的..

# php - 将 Moodle 1.9 和 PHP 应用程序集成到单点登录

> ID：10551565
> 
> 赞同：0
> 
> 时间：2012-05-11T12:43:44.793
> 
> 标签：php, moodle

我有 PHP 应用程序来提供课程注册，一些课程是由 Moodle 1.9 版网站提供的。

如何使用 PHP 应用程序在 Moodle 1.9 中实现单次登录？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-12T04:29:08.627

目前尚不清楚您是否需要单点登录（身份验证插件）或注册插件。

但是，这里有一些提示可以继续：

Moodle 支持各种身份验证后端，例如 SAML(Shibboleth)、LDAP。这是一个完整的列表：[http ://docs.moodle.org/22/en/Authentication](http://docs.moodle.org/22/en/Authentication)

还有几个贡献的身份验证插件可以在这里找到：[http ://moodle.org/plugins/browse.php?list=category&id=21](http://moodle.org/plugins/browse.php?list=category&id=21)

如果您只需要注册插件，请检查管理-->插件-->注册以获取支持的插件列表。

还有一些贡献的注册插件：[http ://moodle.org/plugins/browse.php?list=category&id=22](http://moodle.org/plugins/browse.php?list=category&id=22)

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-12T09:53:48.037

您可以使用外部数据库身份验证和/或注册插件将应用程序的数据库连接到 Moodle。

使用此插件，您还可以在两个系统之间同步用户/注册信息。

# java - 通过传递相同的 Runnable 实例创建两个线程

> ID：10551567
> 
> 赞同：1
> 
> 时间：2012-05-11T12:43:58.920
> 
> 标签：java, multithreading

```
Thread runnableInst = new Runnable(){  public void run(){}};

Thread thread1 = new Thread(runnableInst);
Thread thread2 = new Thread(runnableInst);

thread1.start();
thread2.start(); 
```

在同一个 Object runnableInst 上启动两个线程可以吗？

做这样的设计好不好？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T12:46:19.560

是的，您可以这样做，但需要注意的一点是，两个线程都将访问`runnableInst`. 因此，您必须确保在必要时同步访问。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T12:45:07.967

这样做没有问题。但是，如果您计划调度大量并行任务，则可能需要开始使用`ExecutorService`API。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T12:49:32.913

这确实是可能的。在大多数情况下，我认为这不是好的或好的设计。我喜欢将 Runnable 实例视为一段孤立的代码，它只通过定义明确、安全的方式与其他线程共享数据。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-06-08T18:05:21.553

在同一个 Object runnableInst 上启动两个线程可以吗？

是的，可以在同一个 Object runnableInst 上启动两个线程。

做这种设计好不好——这取决于用例。例如，如果没有与共享资源上的读/写相关的内容，那么这是一个很好的设计。

# php - 使用 google API 获取 gmail 联系人，显示错误帐户已禁用

> ID：10551568
> 
> 赞同：2
> 
> 时间：2012-05-11T12:43:59.720
> 
> 标签：php, api, curl, google-api

我正在使用 PHP。我想获取用户的所有 gmail 联系人，我正在使用通过 CURL 调用 google API 的 PHP 代码。但是，当我在 localhost 上执行此操作时，它运行良好并为我提供了所有联系人。

但是当我在美国服务器的在线服务器上执行此操作时，它给了我“帐户已禁用”的响应，并且还收到了来自谷歌的同一用户的安全邮件。

我正在使用以下代码：

```
function getGmailContacts($user, $password) {
//========================================== step 1: login ===========================================================
$login_url = "https://www.google.com/accounts/ClientLogin";
$fields = array(
    'Email' => $user,
    'Passwd' => $password,
    'service' => 'cp', // <== contact list service code
    'source' => 'test-google-contact-grabber',
    'accountType' => 'GOOGLE',
);

$curl = curl_init();
curl_setopt($curl, CURLOPT_URL,$login_url);
curl_setopt($curl, CURLOPT_POST, 1);
curl_setopt($curl, CURLOPT_POSTFIELDS,$fields);
curl_setopt($curl, CURLOPT_SSL_VERIFYPEER, 0);
curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1); 
$result = curl_exec($curl);

$returns = array();

foreach (explode("\n",$result) as $line)
{
    $line = trim($line);
    if (!$line) continue;
    list($k,$v) = explode("=",$line,2);

    $returns[$k] = $v;
}

curl_close($curl);

//echo "<pre>"; 
//print_r($returns);exit;

if(!isset($returns['Error'])) {

    //========================== step 2: grab the contact list ===========================================================
    $feed_url = "http://www.google.com/m8/feeds/contacts/$user/full?alt=json&max-results=250";

    $header = array(
        'Authorization: GoogleLogin auth=' . $returns['Auth'],
    );

    $curl = curl_init();
    curl_setopt($curl, CURLOPT_URL, $feed_url);
    curl_setopt($curl, CURLOPT_HTTPHEADER, $header);
    curl_setopt($curl, CURLOPT_SSL_VERIFYPEER, 0);
    curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1); 

    $result = curl_exec($curl);
    curl_close($curl);

    $data = json_decode($result, true);
    //echo "<pre>";
    //print_r($data);exit;
    $contacts = array();
    $i=0;
    foreach ($data['feed']['entry'] as $entry)
    {
        //echo $i." ";
        $entryElement = $entry;
        if(isset($entryElement['gd$email'])) {

            $gdEmailData = $entryElement['gd$email'][0];

            //$contact->title = $entryElement['title']['$t'];
            //$contact->email = $gdEmailData['address'];

            $contacts[$gdEmailData['address']] = $entryElement['title']['$t'];
        }
    }

    //var_dump($contacts);
    //print_r($contacts);
    return $contacts;
}
else {

    if($returns['Error']=='BadAuthentication') {

        //echo '<strong>User Name and Password is incorrect.</strong>';
        $errorArr = array("Error"=>"User Name and Password is incorrect.");
        //print_r($errorArr);
        return $errorArr;
    }
} 
```

}

该邮件包含

> “最近有人尝试使用应用程序登录您的 Google 帐户......位置：纽约 NY，纽约，美国......”

.

我认为此错误是由于位置更改而发生的。有人能帮帮我吗？提前致谢。

# javascript - 如何在不知道请求的情况下获得 Ajax 响应？

> ID：10551573
> 
> 赞同：0
> 
> 时间：2012-05-11T12:44:17.927
> 
> 标签：javascript, ajax, xmlhttprequest

我需要我所在的网页对 Ajax-Requests 做出响应，但我无权访问该请求。原因：请求存储在本地变量中，我无法更改变量可用的代码（因为更新问题）。该请求是通过 XMLHttpRequest 发送的（而不是 jquery :-( ）。

我知道，这听起来像是我在制作垃圾代码，但这一切都取决于客户的意愿：-/

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T20:42:52.827

解决它：这是不可能的。如果不访问 XHR-Object，就不可能了解它。jQuery 全局保存 XHR，因此它们可以提供全局事件处理程序。

# zend-framework - 如何将自己的库添加到 Zend Framework

> ID：10551576
> 
> 赞同：-2
> 
> 时间：2012-05-11T12:44:37.610
> 
> 标签：zend-framework, namespaces

所以我一直在设计一个在 Zend Framework 1.11 上运行的应用程序，就像任何程序员在看到重复的功能时都会做的那样，我想去构建一个具有上述功能的基类。

现在我的计划是构建一个库“我的”，所以我在应用程序的库目录中创建了一个文件夹。所以看起来像这样

```
Project 
   Application 
   docs 
   library 
      My 
   public 
   test 
```

所以我在 My 文件夹中创建了一个 BaseController 类，然后决定让我的应用程序中的 IndexController 扩展 BaseController。

Basecontroller 看起来像这样：

```
class My_BaseController extends Zend_Controller_Action
{

    public function indexAction()
    {
        $this->view->test = 'Hallo Wereld!';
    }

} 
```

IndexController 看起来像这样：

```
class WMSController extends My_BaseController
{

    public function indexAction()
    {
        parent::indexAction();
    }

} 
```

根据许多资源的建议，我尝试使用以下行在 application.ini 中添加库的命名空间

```
autoloadernamespaces.my = “My_” 
```

但是当我尝试运行此应用程序时，我收到以下错误

> 致命错误：在 C:\wamp\www\ZendTest\application\controllers\IndexController.php 中找不到类“My_BaseController”

我在这里错过了什么吗？还是我只是一个布偶，应该尝试不同的方法？

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T14:37:43.767

您的原始方法将在 application.ini 中为您工作，您的设置只是遇到了一些问题。

您的 application.ini 应该有这一行：-

```
autoloadernamespaces[] = "My_" 
```

此外，你必须小心你的类名，以你的基本控制器为例，它应该在`library/My/Controller/Base.php`并且应该看起来像这样：-

```
class My_Controller_Base extends Zend_Controller_Action
{
    public function indexAction()
    {
        $this->view->test = 'Hello World!';
    }
} 
```

然后你可以像这样使用它： -

```
class WMSController extends My_Controller_Base
{
    public function indexAction()
    {
        parent::indexAction();
    }  
} 
```

所以，你几乎是对的，但只是遗漏了几个细节。值得了解自动加载在 Zend Framework 中的工作原理并学习使用[类命名约定](http://framework.zend.com/manual/en/learning.autoloading.design.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T12:47:15.410

我不知道`.ini`配置，但我添加了这样的客户库（index.php）：

```
require_once 'Zend/Loader/Autoloader.php';
Zend_Loader_Autoloader::getInstance()->registerNamespace('My_'); 
```

# android - 在 TextView 中滚动内容

> ID：10551580
> 
> 赞同：0
> 
> 时间：2012-05-11T12:44:49.910
> 
> 标签：android, android-layout, android-intent

我想在 TextView 中滚动内容，这是将结果设置为在 TextView 中显示的代码：

```
do
{                   
y = m;
f = x / y;
m = (y + f) / 2;
str[i] = x + "\t " + y + "\t " + f + "\t " + m + "\t";                  
i++;
a = i;

} while (Math.abs(y - m) >= 0.00001 * y);               
str4 = numfmt1.format(y);
for (int j = 0; j < a; j++){
ris.append(str[j] + "\n");//TextView that contains the string str
}
ris.append("La radice è: " + str4)
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T13:21:28.387

将 TextView 放在 ScrollView 内。但要小心，因为 ScrollView 只能容纳一个孩子......并且 TextView 将是 ScrollView 的孩子。使用 Eclipse 中的 xml 或图形布局功能执行此操作。

```
<ScrollView>

   TextView

</ScrollView> 
```

# html - 失去从 RTF 到 HTML 转换的居中属性

> ID：10551586
> 
> 赞同：3
> 
> 时间：2012-05-11T12:45:02.853
> 
> 标签：html, rtf

我正在尝试使用 OO 将 RTF 输入（来自 MS Word 2000）转换为 HTML。如果我打开 RTF 文件，屏幕上的一切看起来都完全正确。如果我将其保存为 HTML，然后在 OO 中重新打开 HTML 文件，几乎所有内容看起来都相同（例外：表格）。但是，如果我在 Firefox 中打开 HTML 文件，则文本不正确。具体来说，在 RTF 中居中或右对齐的段落以及在 OO HTML 中查看时现在都是左对齐的。

这很奇怪，因为 HTML 文件的文本是

```
<P CLASS="western" ALIGN=CENTER STYLE="text-indent: 0in; margin-bottom: 0in">
<FONT COLOR="#000000"><FONT FACE="Verdana, sans-serif"><FONT SIZE=4 STYLE="font-size: 16pt"><B>Some text that should be centered</B></FONT></FONT></FONT></P> 
```

而“西方”类是

```
P.western { font-size: 10pt; so-language: en-US } 
```

有人知道为什么居中没有按预期工作吗？改天我会处理桌子的问题。网址：[https ://netsuite.folio3.com/](https://netsuite.folio3.com/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T13:01:46.277

那么这是一个非常有用的链接到这个问题

[http://user.services.openoffice.org/en/forum/viewtopic.php?f=30&t=46850](http://user.services.openoffice.org/en/forum/viewtopic.php?f=30&t=46850)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-09-15T16:26:51.810

我创建了一个脚本来设置rtf 到 html 转换后的**中心**和**右对齐。**我用javascript和Java制作了它。遵循以下代码：

两者都需要两个 css 类：

```
.wricent {
    text-align: center;
}
.wririgh {
    text-align: right;
} 
```

***JavaScript***

```
function fixCenterRightAlign(rtf, html) {
  html = fixAlign(rtf, html, 'qc');
  return fixAlign(rtf, html, 'qr');
}

function fixAlign(rtf, html, align) {
  let lastCountParBeforePard = 0;
  let countParBeforePard = 0;
  let indexPard = 0;
  let iqc = 0;
  let toContinue = true;
  let firstCicle = true;
  const p_class = '<p class=';
  const c_class = align === 'qc' ? '<p class=wricent' : '<p class=wririgh';
  while(toContinue) {
    let indexNextP = 0;
    iqc = rtf.substr(indexPard).indexOf('\\' + align);
    if (iqc > -1) {
      iqc += indexPard;
      let parQtLeft = getParQt(rtf.substr(0, iqc));
      let rtfFirstQc = rtf.substr(iqc);
      indexPard = rtfFirstQc.indexOf('\\pard');
      if (indexPard > -1) {
        rtfFirstQc = rtfFirstQc.substr(0, indexPard);
        countParBeforePard = getParBeforePard(rtfFirstQc, indexPard);
      } else {
        toContinue = false;
        indexPard = 0;
        countParBeforePard = 0;
      }
      let parQt = getParQt(rtfFirstQc) + (lastCountParBeforePard - countParBeforePard);
      firstCicle && parQt++;
      indexPard += iqc;

      if (parQt > 0) {
        for (let i = 0; i < (parQtLeft + parQt); i++) {
          let actualIdexNextP = html.substr(indexNextP).indexOf(p_class);

          if ((i + 1) > parQtLeft && actualIdexNextP > -1) {
            html = replaceAt(html, indexNextP + actualIdexNextP, c_class);
          }
          indexNextP += c_class.length + actualIdexNextP;
        }
      }
      lastCountParBeforePard = angular.copy(countParBeforePard);
    } else {
      toContinue = false;
    }
    firstCicle = false;
  }
  return html;
}
function replaceAt(text, index, character) {
    return text.substr(0, index) + character + text.substr(index + character.length);
}

function getParBeforePard(rtfFirstQc, indexPard) {
  let text = rtfFirstQc.substr(indexPard - 6, indexPard);
  return getParQt(text);
}

function getParQt(text) {
  let pardQt = text.match(new RegExp('\\\\pard', "g"));
  let parQt = text.match(new RegExp('\\\\par', "g"));
  pardQt = pardQt ? pardQt.length : 0;
  return (parQt ? parQt.length : 0) - pardQt;
} 
```

***爪哇***

```
 private final String RTF_CENTER_TAG = "qc";
    private final String RTF_RIGHT_TAG = "qr";

    /**
     * Fix the alignment center and right of the html template
     * @param rtf String containing the <b>rtf template</b>
     * @param html String containing the <b>html template from the rtf convertion</b>
     * @author desilva
     * @return String with the html template with the center/right align fixed
     */
    private String stylizeAligment(String rtf, String html) {
        html = fixAlign(rtf, html, this.RTF_CENTER_TAG);
        return fixAlign(rtf, html, this.RTF_RIGHT_TAG);
    }

    /**
     * Fix the align of the html template based on the rtf and the rtf tag to fix
     * @param rtf String containing the <b>rtf template</b>
     * @param html String containing the <b>html template from the rtf convertion</b>
     * @param tagAlign
     * @return
     */
    private String fixAlign(String rtf, String html, String tagAlign) {
        Integer parQt = 0;
        Integer pardQt = 0;
        Integer lastCountParBeforePard = 0;
        Integer countParBeforePard = 0;
        Integer indexPard = 0;
        Integer iqc = 0;
        boolean toContinue = true;
        boolean firstCicle = true;
        String pClass = "<p class=";
        String cClass = (tagAlign.equals(this.RTF_CENTER_TAG) ? "<p class=wricent" : "<p class=wririgh");
        while(toContinue) {
          int indexNextP = 0;
          iqc = rtf.substring(indexPard).indexOf("\\" + tagAlign);
          if (iqc > -1) {
            iqc += indexPard;
            Integer pardQtLeft = this.getMatches(rtf.substring(0, iqc), "\\\\pard");
            Integer parQtLeft = this.getMatches(rtf.substring(0, iqc), "\\\\par") - pardQtLeft;
            String rtfFirstQc = rtf.substring(iqc);
            indexPard = rtfFirstQc.indexOf("\\pard");
            if (indexPard > -1) {
              rtfFirstQc = rtfFirstQc.substring(0, indexPard);
              countParBeforePard = this.getParBeforePard(rtfFirstQc, indexPard);
            } else {
              toContinue = false;
              indexPard = 0;
              countParBeforePard = 0;
            }
            pardQt = this.getMatches(rtfFirstQc,"\\\\pard");
            parQt = this.getMatches(rtfFirstQc,"\\\\par") - pardQt;
            parQt += (lastCountParBeforePard - countParBeforePard);
            if(firstCicle) parQt++;
            indexPard += iqc;

            if (parQt > 0) {
              for (int i = 0; i < (parQtLeft + parQt); i++) {
                Integer actualIdexNextP = html.substring(indexNextP).indexOf(pClass);

                if ((i + 1) > parQtLeft && actualIdexNextP > -1) {
                  html = this.replaceAt(html, indexNextP + actualIdexNextP, cClass);
                }
                indexNextP += cClass.length() + actualIdexNextP;
              }
            }
            lastCountParBeforePard = countParBeforePard;
          } else {
            toContinue = false;
          }
          firstCicle = false;
        }
        return html;
    }

    private String replaceAt(String text, int index, String character) {
        return text.substring(0, index) + character + text.substring(index + character.length());
    }

    private int getParBeforePard(String rtfFirstQc, int indexPard) {
      String text = rtfFirstQc.substring(indexPard - 6, indexPard);
      int pardQt = this.getMatches(text, "\\\\pard");
      return this.getMatches(text, "\\\\par") - pardQt;
    }

    private Integer getMatches(String input, String regex) {
        Pattern pattern = Pattern.compile(regex);
        Matcher matcher = pattern.matcher(input);
        int from = 0;
        int count = 0;
        while(matcher.find(from)) {
            count++;
            from = matcher.start() + 1;
        }

        return count;
    } 
```

**使用**方法： **stylizeAligment**和**fixCenterRightAlign**方法接收到 String rtf 和它的 html 转换后，返回的是 align 固定的 html。

我需要创建它，因为我使用 javax.swing.text.rtf 将 rtf 转换为 html。

在我的情况下，带下划线的文本也不起作用，所以要修复它只需放置 css 样式：

```
 p span u {
    text-decoration: underline;
  } 
```

# java - 在java中从catch/finally返回值？

> ID：10551587
> 
> 赞同：3
> 
> 时间：2012-05-11T12:45:05.050
> 
> 标签：java, exception, jdbc

我有以下代码。如果查询没有异常执行，则应返回 true，如果抛出任何异常，则应返回 false。最后声明和连接应该关闭。我的问题是我应该在哪里写退货声明？赶上还是最后？在下面的代码中，如果执行查询，我在 try 中返回 true，如果抛出任何异常，则在 catch 中返回 false。我的问题是，如果抛出任何异常，是否会返回 false 并关闭连接和语句？

```
try {
            statement = connection.createStatement();
            statement.executeQuery("select * from dual");
            return true;
        } catch (SQLException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
                   return false;
        } finally{
                try {

                        statement.close();

                        connection.close();

                } catch (SQLException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();

                }

        } 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-11T12:47:48.917

在两者中，都将其写在 try-catch 块之外，在其下方。**切勿在最终块中使用返回**，因为该返回语句将始终执行，践踏您在 try 块中的常规返回语句！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-11T12:48:27.577

> 我应该在哪里写return语句？

把它放在最后，在 final 之后`}`：

```
 try {
        ...
        return true;
    } catch (SQLException e) {
        e.printStackTrace();
    } finally {
        ...
    }
    return false; // <===== HERE 
```

这样，`true`当且仅当`try`块中的代码在没有引发异常的情况下执行时，该函数才会返回。在所有其他情况下，该函数将返回`false`.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-11T12:48:25.170

它不会像你写的那样工作。要`finally`正确执行带有块的返回，您需要保持状态，即

```
boolean result = false;

try
{
 // all good
 result = true;
} 
catch(...)
{
 // crap
 result = false;
}
finally
{
 // close
}
return result; 
```

这假设您希望`finally`执行块中的内容并返回正确的结果。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-11T12:49:05.593

最好尝试使用 JDK 7 并使用新的资源尝试。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-11T12:49:12.337

你可以试试

```
boolean returnVal = false
try {
            statement = connection.createStatement();
            statement.executeQuery("select * from dual");
            returnVal = true;
    } catch (SQLException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    returnVal = false;
    } finally{
            try {

                    statement.close();

                    connection.close();

            } catch (SQLException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
         returnVal = false;

            }
    return returnVal;

    } 
```

# android - 自定义下拉式布局

> ID：10551588
> 
> 赞同：0
> 
> 时间：2012-05-11T12:45:07.553
> 
> 标签：android, drop-down-menu

我想要我的应用程序的自定义布局下拉框，就像我在我的主页上一样，我按下页面中心的按钮，然后在我按下该按钮后应该出现这个布局，我尝试了其他几个并搜索了互联网但是我不知道如何制作这样的下拉框：![下拉布局](../Images/9e848ccf3dadce4f643a25500efaf768.png)

这显示了两种布局，第一种我们在第一列中选​​择日期，例如 12 个月，然后是 1-31 数字，然后是 2001-2012 年，我不明白如何使这种效果像玻璃一样我想制作与此处所示完全相同的布局，任何人都可以建议我如何实现该编码对我有很大帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T14:32:40.127

有一个例子你可以参考这个

[http://code.google.com/p/android-wheel/](http://code.google.com/p/android-wheel/)

你可以从这里获取源代码

[http://android-wheel.googlecode.com/svn/trunk/](http://android-wheel.googlecode.com/svn/trunk/)

另一个例子

[https://github.com/sys1yagi/AndroidPractice/tree/master/DrumPicker/trunk](https://github.com/sys1yagi/AndroidPractice/tree/master/DrumPicker/trunk)

# android - Android简单的计算器应用程序

> ID：10551602
> 
> 赞同：1
> 
> 时间：2012-05-11T12:46:09.403
> 
> 标签：android

我是安卓新手。我正在开发一个简单的计算器应用程序。我的代码有一些问题。没有语法错误。当我运行它时，它给出了一些错误。将所有代码都写在 a 中，`try catch`但我仍然无法捕捉到它。

```
 b1.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {
            //char x = lbldisp.getText().toString().charAt(1);

        try
        {
            String x = lbldisp.getText().toString();
            if(x.charAt(0)=='0' && x.charAt(1)!='.')
            {
                    lbldisp.setText("1");
            }
            else
            {
                lbldisp.setText(x+"1");
            }

        }
        catch(Exception e)
        {
            Toast.makeText(Calculator.this,e.getMessage().toString(), Toast.LENGTH_SHORT).show();
        }
        }
    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T12:55:17.573

尝试替换此字符串

```
 if(x.charAt(0)=='0' && x.charAt(1)!='.') 
```

通过这个字符串

```
 if(x.charAt(0).equals("0") && x.charAt(1).equals(".")) 
```

您已将值转换为字符串，因此请尝试使用 .equals 方法。

# ruby - Rspec：当匹配器失败时

> ID：10551605
> 
> 赞同：0
> 
> 时间：2012-05-11T12:46:17.820
> 
> 标签：ruby, ruby-on-rails-3, rspec2

我有一个 Rails 项目并使用 RSpec 作为测试框架。我需要的是在某些匹配器失败时订阅事件，例如我得到了这个：

```
true.should be_false 
```

我想对每一次失败采取一些行动。这个功能是由 RSpec 提供的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T14:22:24.820

您可以将此行为猴子修补到 RSpec::Core::Example 类中：

```
require 'spec_helper'
class RSpec::Core::Example  
  def failed?
    !@exception.nil?
  end
end

describe "my_tested_things" do 
 ...
end 
```

然后你可以确保它会在所有失败的匹配之后运行你想要的代码：

```
after(:each) do    
  run_my_code if example.failed?    
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T13:30:19.533

检查钩子，不确定它是否会有所帮助，但它将示例传递到块中（在文档中）你可能能够得到结果......

[https://www.relishapp.com/rspec/rspec-core/v/2-0/docs/hooks](https://www.relishapp.com/rspec/rspec-core/v/2-0/docs/hooks)

# c# - DataGridView 中的计算列绑定到一个对象

> ID：10551607
> 
> 赞同：5
> 
> 时间：2012-05-11T12:46:25.847
> 
> 标签：c#, winforms, datagridview, datagridviewcolumn

我的 UI 包含一个`AutoCreateColumns= false`绑定到我的业务对象列表的 datagridview ()。假设我的对象包含 2 列 - 价格和数量 - 我想在我的网格中添加一个新列 - 总计 - 将计算哪个值 - 价格 * 数量，**但**不修改我的业务对象。

是否可以？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T13:03:48.523

是的。

您可以以编程方式将未绑定的列添加到网格，并使用事件填充列的单元格。

填充未绑定列的内容有两种主要方法：处理**RowsAdded**事件或处理**CellFormatting**事件。如果网格是可编辑的，还需要处理**CellValueChanged 。**CellFormatting 事件还可用于将单元格中显示的值转换为与实际存储在位于网格后面的数据中的值不同的值。

**代码示例 -**

```
private void OnCellFormatting(object sender,
   DataGridViewCellFormattingEventArgs e)
{

    if (e.ColumnIndex == grid.Columns["Unbound"].Index)
    {
       e.FormattingApplied = true;
       DataGridViewRow row = grid.Rows[e.RowIndex];
       e.Value = string.Format("{0} : {1}",
          row.Cells["SomeColumn1"].Value,
          row.Cells["SomeColumn2"].Value);
    }
}

private void OnRowsAdded(object sender,
   DataGridViewRowsAddedEventArgs e)
{

   for (int i = 0; i < e.RowCount; i++)
   {
      DataGridViewRow row = grid.Rows[e.RowIndex + i];
      row.Cells["Unbound"].Value = string.Format("{0} : {1}",
         row.Cells["SomeColumn1"].Value,
         row.Cells["SomeColumn2"].Value);
    }
} 
```

更详细 - [http://www.informit.com/articles/article.aspx?p=446453&seqNum=5](http://www.informit.com/articles/article.aspx?p=446453&seqNum=5)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T12:59:00.840

不，不是不编辑你的对象。

# python - 使用 Python 流式传输和录制视频

> ID：10551608
> 
> 赞同：0
> 
> 时间：2012-05-11T12:46:27.833
> 
> 标签：python, django, video-streaming, video-processing

我正在考虑使用视频流的服务架构。2 人在带有网络摄像头的浏览器中互相通话（如 google plus 中的小组讨论，但只有 2 人）。他们的谈话转储到服务器。服务器知道对话何时开始、何时结束以及哪些客户端进行通信。

在后端，我计划使用 Python/Django。我对流/前端（html5，flash）使用什么没有任何想法。我想使用 python 控制流式处理（转储、开始|停止对话）。

你有什么可以推荐给我的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T13:06:47.417

我认为您需要查看以下两个-

[http://videocapture.sourceforge.net/](http://videocapture.sourceforge.net/) #用于视频录制

和

[http://twistedmatrix.com/trac/](http://twistedmatrix.com/trac/) #用于网络传输

以下使用 Twisted 的示例可能会有所帮助 -

[http://www.rtmpy.org/index.html](http://www.rtmpy.org/index.html)

# properties - 如何从外部属性文件将映射包含到 Application.cfc 中？

> ID：10551613
> 
> 赞同：5
> 
> 时间：2012-05-11T12:46:38.170
> 
> 标签：properties, coldfusion, mapping, application.cfc

我在 Application.cfc 中设置映射时遇到问题 我们有不同的服务器（dev、QS、prod），每个服务器都有一些不同的路径。我想通过配置文件设置服务器特定的路径和变量。在 ApplicationStart 上，您读取 ini 文件并设置您的系统。 [http://www.raymondcamden.com/index.cfm/2005/8/26/ColdFusion-101-Config-Files-AGoGo](http://www.raymondcamden.com/index.cfm/2005/8/26/ColdFusion-101-Config-Files-AGoGo) 这很好用。

通常，您在 Applcation.cfc 中设置映射，如下所示：

```
<!--- in Application.cfc --->
<cfset this.mappings['/components'] = "D:\Inetpub\wwwroot\myApp\components"> 
```

在普通 cfm 文件中的某个地方，我通过以下方式创建了一个名为 test 的 cfc：

```
<cfset t = createObject("component", "components.test")> 
```

我只想在**onApplicationsStart设置一次映射**

```
<cffunction
    name="OnApplicationStart"
    access="public"
    returntype="boolean"
    output="false"
    hint="Fires when the application is first created.">

    <!---create structure to hold configuration settings--->
    <cfset ini = structNew()>
    <cfset ini.iniFile = expandPath("./ApplicationProperties.ini")>
    <cfset application.ini = ini>

    <!--- read ini file --->
    <cfset sections = getProfileSections(application.ini.iniFile)>

    <cfloop index="key" list="#sections.mappings#">
       <cfset this.mappings[key] = getProfileString(application.ini.iniFile, "mappings", key)>
    </cfloop> 
```

但这不起作用，因为 this.mappings 是空的并且是下一个请求。:(

把它放到 OnRequestStart

```
<!--- read ini file --->
    <cfset sections = getProfileSections(application.ini.iniFile)>

    <cfloop index="key" list="#sections.mappings#">
       <cfset this.mappings[key] = getProfileString(application.ini.iniFile, "mappings", key)>
    </cfloop> 
```

我收到无法找到组件的错误。这很奇怪。

将结构放入应用程序范围

```
 <cfloop index="key" list="#sections.mappings#">
       <cfset APPLICATION.mappings[key] = getProfileString(application.ini.iniFile, "mappings", key)>
    </cfloop> 
```

如何调用我的组件？

```
<cfset t = createObject("component", "application.components.test")> 
```

不工作。

所以我有3个目标。

1.  从 ini 文件中读取所有路径和映射
2.  在 ApplicationStart 阅读一次
3.  在源代码中易于使用。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-11T14:00:36.467

映射不能在 onApplicationStart() 中设置，必须在 Application.cfc 的伪构造函数中设置，并且必须在每次请求时设置。

同样重要的是要注意，此时应用程序范围不可用，因此如果您需要缓存任何内容，则需要使用服务器范围。您可以将映射结构缓存到服务器范围，然后将其设置到 this.mappings 每个请求中。

```
<cfcomponent>
  <cfset this.name = "myapp" />

  <!--- not cached so create mappings --->
  <cfif NOT structKeyExists(server, "#this.name#_mappings")>
    <cfset iniFile = getDirectoryFromPath(getCurrentTemplatePath()) & "/ApplicationProperties.ini" />
    <cfset sections = getProfileSections(iniFile) />
    <cfset mappings = structnew() />
    <cfloop index="key" list="#sections.mappings#">
      <cfset mappings[key] = getProfileString(iniFile, "mappings", key)>
    </cfloop>
    <cfset server["#this.name#_mappings"] = mappings />
  </cfif>

  <!--- assign mappings from cached struct in server scope --->
  <cfset this.mappings = server["#this.name#_mappings"] />

  <cffunction name="onApplicationStart">
  <!--- other stuff here --->
  </cffunction>

</cfcomponent> 
```

如果您打算将 ini 文件保留在 webroot 中，则应将其设为 .cfm 模板并以 <cfabort> 开头。它的工作原理相同，但不可读

*应用程序属性.ini.cfm*

```
<cfabort>
[mappings]
/foo=c:/bar/foo 
```

# php - 在 url 中显示用户名... www.example.com/JoeMason

> ID：10551616
> 
> 赞同：0
> 
> 时间：2012-05-11T12:46:47.923
> 
> 标签：php, url

我会假设有点简单，但似乎在这里找不到任何可以帮助我的答案。

基本上不是显示

www.example.com/profile.php

我想显示登录人的用户名。

www.example.com/JoeMason

有什么简单的方法可以实现吗？#

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T12:49:38.900

是的，您可以使用 mod rewrite 将 www.example.com/JoeMason 重写为 www.example.com/profile.php?name=JoeMason

尝试将此添加到您的 .htaccess 文件中：

```
RewriteEngine On
RewriteRule ^/(.*)/$ http://www.example.com/profile.php?name=$1 [L] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T12:49:39.883

你可以使用重写规则来改变这个，从

www.example.com/profile.php?user=JoeMason

至

www.example.com/JoeMason

查看 nginx conf 中的 .htaccess 或 rewrite 规则

# sharepoint - 带有 SetResponseHeaders 的 SharePoint 发布 BlobCache 错误

> ID：10551623
> 
> 赞同：0
> 
> 时间：2012-05-11T12:47:04.980
> 
> 标签：sharepoint, sharepoint-2010

在我的错误日志中，我看到以下错误和堆栈跟踪：

页面错误：**URL：** /SiteCollectionImages/Push/zh-cn/Machining_calculators.jpg
**启用调试：**错误
**相关 ID：** 857a397e-8063-447c-af92-b114074282b8
**消息**：发送 HTTP 标头后服务器无法附加标头。
**来源**： System.Web
**StackTrace**：在
Microsoft.SharePoint.Publishing.BlobCache.SetResponseHeaders(HttpContext context, BlobCacheEntry target)
在 Microsoft.SharePoint.Publishing.BlobCache.SendCachedFile( HttpContext 上下文、BlobCacheEntry 目标、SPUserToken currentUserToken、SiteEntry currentSiteEntry)
在 Microsoft.SharePoint.Publishing.BlobCache.HandleCachedFile（HttpContext 上下文
，BlobCacheEntry 目标，布尔匿名用户，SiteEntry currentSiteEntry）在 Microsoft.SharePoint.Publishing 的 Microsoft.SharePoint.Publishing.BlobCache.SendCachedFile（HttpContext 上下文，BlobCacheEntry 目标，SiteEntry currentSiteEntry）。 BlobCache.RewriteUrl(Object sender, EventArgs e, Boolean preAuthenticate) at Microsoft.SharePoint.Publishing.PublishingHttpModule.AuthorizeRequestHandler(Object sender, EventArgs ea)
at System.Web.HttpApplication.SyncEventExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute()
在 System.Web.HttpApplication.ExecuteStep（IExecutionStep 步骤，Boolean& completedSynchronously）

似乎内置的 BlobCache 在将响应发送到服务器后尝试设置 httpresponse-headers。有谁知道如何纠正这个问题，或者它是 SharePoint 平台中的一个错误？

更新：我的 web.config 看起来像这样：

```
<BlobCache location="d:\BlobCache\companyname" path="\.(gif|jpg|jpeg|jpe|jfif|bmp|dib|tif|tiff|ico|png|wdp|hdp|css|js|asf|avi|flv|m4v|mov|mp3|mp4|mpeg|mpg|rm|rmvb|wma|wmv)$" maxSize="10" enabled="true" /> 
```

还值得一提的是，并非所有图像请求都会发生这种情况。大约 90-95% 的图像请求最终被正确地缓存在指定的位置，并使用正确的响应代码发送到客户端。

Update2：从 HttpModules 挂钩到 HttpApplication：

```
app.PreSendRequestContent += new EventHandler(app_PreSendRequestContent); 
```

以及 HttpModule 中的一些 SharePoint 特定代码：

```
var spApp = context as SPHttpApplication;
if (spApp != null)
{
    var labelHandler = new VaryByLabelHandler();
    spApp.RegisterGetVaryByCustomStringHandler(labelHandler);
    var countryHandler = new VaryByCountryHandler();
    spApp.RegisterGetVaryByCustomStringHandler(countryHandler);
    var claimHandler = new VaryByClaimHandler();
    spApp.RegisterGetVaryByCustomStringHandler(claimHandler);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T14:57:16.767

该问题是由我认为 SharePoint 平台中的错误引起的。该问题影响了存储在 SiteCollection-library 中的图像，但并非所有图像。在深入挖掘之后，并获得了一些运气。我可以看到这些图像在我们关闭列表上的内容批准之前已经上传，这可以通过使用“管理内容和结构”工具看到。这些图像仍处于草稿模式。这不应该是这样，因为我们关闭了内容批准，但由于某种原因，此设置影响了 BlobCache 正确服务它们的能力。

使用 Fiddler 可以很容易地观察到哪些图像受到影响，并且看到这些图像提示来自服务器的 304 响应，而其他图像则直接从客户端缓存中获取。

解决方案是对这些图像进行批量签出和批量签入，然后他们获得批准状态“已批准”，问题就解决了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T19:56:48.547

您没有会绕过/覆盖本机 SharePoint 的客户 http 处理程序吗？看起来有些东西设法在 SharePoint 从磁盘检索响应或从数据库中获取响应并随后将其存储在磁盘上之前将其发回。

你能在网络配置上给我们你的 blobcache 条目吗？blob 存储的目标位置是否根据请求填充？您是否在该文件夹上设置了相关权限？

亲切地。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-17T09:26:03.227

我的猜测是，这实际上不是由 blob 缓存引起的，而是由 http 模块之一引起的。例如，您是否在任何地方挂钩 HttpApplication.ReleaseRequestState？在这种情况下，需要将其更改为 HttpApplication.EndRequest。这是这个问题的一个很常见的原因......

# java - 自定义标题栏中的问题（android）

> ID：10551628
> 
> 赞同：1
> 
> 时间：2012-05-11T12:47:11.750
> 
> 标签：java, android

当我通过添加图像自定义视图中的标题栏时，我遇到了一个问题，因为图像没有准确地固定在边缘。我附上了图像，您可以在其中看到窗口边距和添加的图像之间的空间。如何克服这个问题。下面是我用来自定义标题栏的代码。谁能帮我解决这个问题。

爪哇代码：

```
 requestWindowFeature(Window.FEATURE_CUSTOM_TITLE);
 setContentView(R.layout.home_view);
 this.getWindow().setFeatureInt(Window.FEATURE_CUSTOM_TITLE,
            R.layout.upwindow); 
```

布局代码：

```
 <?xml version="1.0" encoding="utf-8"?>
  <RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"    
  android:orientation="vertical" 
   android:layout_width="fill_parent"
     android:layout_height="32dp">

     <ImageView
         android:id="@+id/imageView1"
         android:layout_width="fill_parent"
         android:layout_height="fill_parent"
         android:background="@drawable/up_bar"
         android:src="@drawable/up_bar" />

<TextView 
    android:id="@+id/pagename"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentLeft="true"
    android:text="Sify MyStorage"
    android:textAppearance="?android:attr/textAppearanceMedium" />

</RelativeLayout> 
```

![在此处输入图像描述](../Images/8e165f1b4f1487701ace03998c18dd0e.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T13:03:57.757

你有不同分辨率的不同图像吗？可能是您的图像根本不适合该空间，并且您需要更大的图像。不过要小心，您的应用程序在不同平台上工作时可能会遇到问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T13:05:04.080

在值文件夹中创建样式 xml：

```
<resources>
  <style name="CustomWindowTitleBackground" /> 
  <style name="CustomTheme" parent="android:Theme">
  <item name="android:windowTitleSize">32dp</item> 
 <item name="android:windowTitleBackgroundStyle">@style/CustomWindowTitleBackground
 </item> 

</style>
</resources> 
```

然后在清单中将其称为：

```
 android:theme="@style/CustomTheme"> 
```

这将解决它。

希望这有帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-11T13:05:53.767

您需要对样式进行一些操作才能覆盖此行为。定义一个自定义主题（样式），如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <style name="customTitle">
        <item name="android:background">@drawable/up_bar</item>
    </style>
    <style name="myTheme" parent="android:Theme"> 
        <item name="android:windowTitleBackgroundStyle">@style/customTitle</item>
    </style>
</resources> 
```

然后通过在*AndroidManifest.xml*`android:theme="@style/myTheme"`中应用您所需的**活动**标签，在您的活动中使用此主题

 ** * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-11T13:05:59.363

```
requestWindowFeature(Window.FEATURE_NO_TITLE); 
```

并将 setBackground 设置为布局文件中的布局...

像，，，

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"    
  android:orientation="vertical"  
   android:layout_width="fill_parent"  android:background="@drawable/up_bar" <---Add this
     android:layout_height="32dp"> 
```

和`Remove imageview from xml`*

# javascript - 在 JSP 中的 JavaScript 中，有没有办法打开另存为对话框？

> ID：10551631
> 
> 赞同：0
> 
> 时间：2012-05-11T12:47:17.403
> 
> 标签：javascript, jsp, dialog

谁能告诉我如何在 JSP中打开**另存为对话框？**

`<a href="#" onClick="doSave()"> <img src="save.gif" alt="Save As"></a>`

我需要`doSave`在 JavaScript 中消除，我必须在 JSP 中实现它。我搜索并`execCommand`在 Netscape 浏览器中不支持。请提供跨浏览器兼容的解决方案。我在谷歌上搜索已经失去了两天的时间。:( :(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T15:54:38.263

我们不能使用 jsp 自动提高另存为选项。因为另存为是客户端选项。我得到的唯一解决方案（不写js）是用户必须使用右键单击“另存为”来保存文件/图像。

# image - 如何从图像中提取对象

> ID：10551640
> 
> 赞同：0
> 
> 时间：2012-05-11T12:48:01.850
> 
> 标签：image, computer-vision, image-segmentation

我想从图像中提取一个对象，如人、汽车或类似的东西。图像只是一个普通的图像，而不是医学图像或其他特定用途的图像。

我找了很久，发现自动图像分割算法只是将图像分割成一组区域或给出图像中的轮廓，而不是语义对象。所以我转向交互式图像分割算法，我发现了一些流行的算法，如交互式图形切割和 SIOX 等。我认为这些算法正好满足我的需求。

此外，我还下载了两个交互式图像分割工具，第一个是[交互式分割工具](http://kspace.cdvp.dcu.ie/public/interactive-segmentation/index.html)，第二个是[交互式分割工具箱](http://www.cs.cmu.edu/~mohitg/segmentation.htm)。

所以我的问题是

1.如果交互式图像分割算法是我的任务的正确解决方案，因为性能是最重要的。

2.如果我想使用自动图像分割算法，下一步该怎么做？

```
Any suggestion will be  approciated. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T07:34:15.430

如果您想通过一些涂鸦从单个静态图像中挑选出一个对象。我建议你阅读

```
'Closed-form solution to image matting' 
or 'Spectral matting', 
or 'lazy snapping' 
```

但是在我的测试中，最后一种方法在处理毛发等细微物体时的性能不如前两种方法。但是你可以很容易地从谷歌找到他们的 matlab 源代码。

但是前两种方法实际上使用起来并不那么愉快，我认为您需要进行大量修改才能使其易于使用。恕我直言，这是主要问题，是否需要在图像上进行非常体面的涂鸦，那就是如果你画了一些额外的涂鸦或在错误的位置，你会毁掉你的对象切割。

除此之外，您还可以尝试“贝叶斯抠图、位置抠图等”。所有这些都需要一些名为trimap的帮助图像，而且真的很难绘制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-13T16:13:37.227

如果这是一个商业案例，您最好寻找专门从事“视频内容分析”的公司。我的意思是：可靠的人员和车辆检测不是一个人的项目。

通用的分割工具无法解决问题，因为它们不知道人或汽车的样子。他们所要做的就是在图像中找到均匀的区域。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-26T07:30:27.800

现在已经很晚了，但是有一个名为 的算法`connected component labeling`，您可能会发现它很有用。

这是算法的[wiki链接](http://en.wikipedia.org/wiki/Connected-component_labeling)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-11T14:36:29.713

从图像中提取对象，特别是图片并不像你想象的那么容易，你可能想看看 OpenCV 项目。

[开放式CV](http://opencv.willowgarage.com/wiki/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-12T05:53:50.353

除了 OpenCV，我建议看看[ITK](http://www.itk.org/)。它在医学图像分析项目中非常流行，因为众所周知，半自动分割工具可提供最佳结果。我认为这些方法也适用于自然图像。

尝试查看诸如 livewire 分割和基于水平集的图像分割之类的工具。ITK 有几个演示，可让您在自己的图像上使用这些工具。[像这样](http://www.itk.org/ITK/applications/segmentationeditor.html)的演示应用程序是开源分发的一部分，但可以直接从 itk 服务器下载（四处寻找说明）

# php - mysql：逐字母匹配查询

> ID：10551641
> 
> 赞同：1
> 
> 时间：2012-05-11T12:48:12.697
> 
> 标签：php, mysql

我正在学习 MySQL 和查询，现在开始使用 PHP。出于学习目的，我选择了一个小型字谜求解器类型的项目开始。我在互联网上找到了一个非常古老的英语单词列表，可免费用作数据库。我尝试查询、查找集合和全文搜索匹配但失败了。

我怎样才能：

逐个字母匹配结果？

例如，假设我有字母 SLAOG 来匹配数据库条目。

由于我有一个肯定包含许多单词的大型数据库，因此我希望返回查询：

```
lag
goal
goals
slag
log
... and so on. 
```

没有任何其他可能使用两次字母的结果。

我将如何用 SQL 解决这个问题？

非常感谢您的宝贵时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T12:58:12.087

```
$str_search = 'SLAOG';

SELECT word
FROM table_name
WHERE word REGEXP '^[{$str_search}]+$' # '^[SLAOG]+$'

// Filter the results in php afterwards

// Loop START

$arr = array();
for($i = 0; $i < strlen($row->word); $i++) {

    $h = substr($str_search, $i, 0);
    preg_match_all("/{$h}/", $row->word, $arr_matches);
    preg_match_all("/{$h}/", $str_search, $arr_matches2);

    if (count($arr_matches[0]) > count($arr_matches2[0]))
        FALSE; // Amount doesn't add up

}

// Loop END 
```

基本上对给定的单词运行 REGEXP，并根据单词与搜索单词相比的出现次数过滤结果。

REGEXP 使用给定单词的组合从头到尾检查所有列。这可能会导致您需要的行数更多，但它仍然会提供一个很好的过滤器。

循环部分是过滤在搜索字符串中使用更多次字母的单词。我`preg_match_all()`在 find the word 和 search word 中的每个字母上运行 a 以检查出现次数，并将它们与`count()`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T14:47:28.807

如果你想要一个快速而肮脏的解决方案......

将您尝试获取字谜的单词拆分为单个字母。为每个字母分配一个单独的素数值，并将它们相乘；例如：

```
C - 2
A - 3
T - 5 
```

总共 30

然后逐步浏览您的字典列表，并对其中的每个单词执行相同的操作。如果你的目标词的值可以被字典词的值整除，那么你就知道字典词只有出现在你的目标词中的字母。

您可以通过预先计算字典值，然后查询正确的值来加快速度： SELECT * FROM dictionary WHERE ($searchWordTotal % wordTotal) = 0（searchWordTotal 是您要查找的单词的总数，并且wordTotal 是数据库中的一个）

这些天我应该好好写这篇文章....

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T12:56:13.363

因为你只想要带有给定字母的单词，而不需要其他单词，但你不需要使用所有字母，那么我建议这样的逻辑：

```
* take your candidate word,
* do a string replace of the first occurrence of each letter in your match set,
* set the new value to null
* then finally wrap all that in a strlength to see if there are any characters left. 
```

您可以在 sql 中完成所有这些操作 - 但对于大多数编码人员来说，一个小过程可能看起来更熟悉。

# c# - Outlook 安全提示自动审批

> ID：10551642
> 
> 赞同：2
> 
> 时间：2012-05-11T12:48:13.723
> 
> 标签：c#, .net, winapi, outlook

我正在编写一个函数，允许用户将他们的电子邮件从 Outlook 导入到企业存储中。但是我遇到了安全提示问题，因为我们仍然有使用 Office 2003 的客户端，所以我们无法禁用它。

我正在尝试使用以下代码自动单击它：

```
 [DllImport("User32.dll")]
    public static extern Int32 FindWindow(String lpClassName, String lpWindowName);

    [DllImport("user32.dll", CharSet = CharSet.Auto)]
    public static extern int SendMessage(int hWnd, int msg, int wParam, IntPtr lParam);

    [DllImport("user32.dll", SetLastError = true)]
    public static extern IntPtr FindWindowEx(IntPtr parentHandle, IntPtr childAfter, string className, string windowTitle);

    private const int WM_LBUTTONDOWN = 0x201;
    private const int WM_LBUTTONUP = 0x0202;

    private void button1_Click(object sender, EventArgs e)
    {
        int hwnd = 0;
        IntPtr hwndChild = IntPtr.Zero;
        while (true)
        {
            hwnd = FindWindow(null, "Microsoft Outlook");
            if (hwnd != 0)
            {
                hwndChild = FindWindowEx((IntPtr)hwnd, IntPtr.Zero, "Button", "Yes");
                if (hwndChild != IntPtr.Zero)
                {
                    SendMessage((int)hwndChild, WM_LBUTTONDOWN, 0, IntPtr.Zero);
                    SendMessage((int)hwndChild, WM_LBUTTONUP, 0, IntPtr.Zero);
                }
                else
                {
                    //...
                }
            }
            else
            {
                //...
            }
            hwnd = 0;
        }
    } 
```

但是当我尝试使用该代码时，我遇到了意想不到的问题。仅当我实际执行鼠标单击时，安全提示才会消失，即使在某些空白屏幕空间上也是如此。它有什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T18:47:46.083

您应该[尝试使用`SendKeys`](http://msdn.microsoft.com/en-us/library/ms171548.aspx)并发送**Yes**`Y`。

 *** * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-12T14:42:18.883

试用 MAPILab 的 Outlook 高级安全功能。也应该适用于 Outlook 2003。这将使您可以永久访问您的应用程序 - 一个弹出窗口将仅在您第一次访问 Outlook 项目时显示：http: [//www.mapilab.com/outlook/security/](http://www.mapilab.com/outlook/security/)

必须在您运行应用程序的每台机器上安装高级安全性。它可免费用于非商业和商业用途。**

# php - 我如何将其更改为 JSON？

> ID：10551650
> 
> 赞同：0
> 
> 时间：2012-05-11T12:48:30.177
> 
> 标签：php, jquery, arrays, json, foreach

如何使用 JSON 发送多个这样的值？

```
foreach($_POST['listItem'] as $key => $values){

    list($eventDate, $eventTitle) = $values;

} 
```

目前，这些值按如下方式发送。但这似乎不能正常工作，因为它只发送了一些字符串。我也无法弄清楚在哪里/如何发送 caltitle 值。

这让我发疯。任何帮助都会很棒。

```
var txt = $("#listbox");

            var caltitle = copiedEventObject.title

            var dtstart = $.fullCalendar.formatDate(copiedEventObject.start, 'yyyyMMdd');

            var txt = $('#listbox');     
            txt.append("<li class ='listItem'> " + dtstart + "</li>")

            // remove the element from the "Draggable Events" list
            $(this).remove();           

        }
    });

        $('#calendarform').submit(function(e) {
            var form = $(this);
            var listItems = $('.listItem'); 
            listItems.each(function(index){   //For each event do this:
                var listItem = $(this);
                    $("<input type='hidden'/>").val(listItem.text()).appendTo(form).attr('name', 'listItem[' + index + ']');
                });

            //Get text information from elements

        }); 
```

编辑：

（使用 JSON）

```
 $('#calendarform').submit(function(e) {
            var form = $(this);

            var going_to_be_json = [];
            list.each(function(i, item) {
              going_to_be_json.push({
                 'id':'test',
                 'title': 'test'
              });
            });

            $('#stuff').val( JSON.stringify(going_to_be_json) );

     }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T12:52:46.507

使用 jQuery Post 或 Get 方法发送它并通过 php 获取它您可以使用[$.post](http://api.jquery.com/jQuery.post/)或[$.get发送多个值](http://api.jquery.com/jQuery.get/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T14:01:30.030

将数据准备为对象数组，然后使用 JSON.stringify() 将该数组转换为 JSON，并将隐藏的表单值设置为所述字符串（或使用 XHR 将其提交到服务器）。

以下是如何准备数据的一个非常有限的示例：

```
var going_to_be_json = [];
list.each(function(i, item) {
  going_to_be_json.push({
     'id':item.id,
     'title': item.title,
     'date': (new Date()).now()
  });
});
hidden_form_element.val( JSON.stringify(going_to_be_json) ); 
```

并在服务器上

```
<?php
$json_data_string = $_POST['hidden_form_field_containing_json_data']; // sanitize however
$array_data = json_decode($json_data_string); 
```

可以从[json.org](http://www.json.org/)和[Tag Wiki](https://stackoverflow.com/tags/json/info)获得更多关于 JSON（Javascript Object Notation）的信息（尽管 tag wiki 只是向您展示了更多示例和链接）

看来你需要更多的方向。我希望你不会只是复制和粘贴我所拥有的，你会阅读并尝试理解它在做什么......

```
 $('#calendarform').submit(function(e) {
        var form = $(this),
            listItems = $('.listItem'),
            data = [],
            hidden = $('<input />'); // create a hidden field for the form.
                                    // or just select the hidden form element from the page
        hidden[0].type = 'hidden'; // set the type
        hidden[0].name = 'some_name_for_php_to_recognize'; // and name

        listItems.each(function(i,el){ 
             data.push({'index': i, 'text': $(el).text()});
        });

        hidden.val(JSON.stringify(data));
        $(this).append(hidden); // not needed if the hidden element is already in the DOM

    }); 
```

# c# - 用于 android 的 mono 存在的 dll（.NET 4 框架）问题

> ID：10551652
> 
> 赞同：5
> 
> 时间：2012-05-11T12:48:36.780
> 
> 标签：c#, android, xamarin.android

我正在使用[http://xamarin.com/monoforandroid创建一个全新的 Mono for android 应用程序](http://xamarin.com/monoforandroid) ![在此处输入图像描述](../Images/06a020d737e2f7344aeebe7c27f37c14.png)

我使用 Visual C#选项*为 Android 应用程序选择了 Mono 。*

我的 Android 目标版本是： ![在此处输入图像描述](../Images/66cb451aaf1195d86655132e61382615.png)

我去了项目的引用并尝试添加我预先存在的 dll（在 .NET 4 Framework 中制作），但我收到了这个错误：

![在此处输入图像描述](../Images/c783a7705bcd7a8f41e0add64ede0a9a.png)

奇怪的是没有选项可以从项目属性中更改 .NET Framework。你能告诉我我错过了什么吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T13:19:18.530

这里的问题是您试图从不是 .NET 4 的项目中引用 .NET 4 DLL。Mono for Android 使用自己的 .NET 配置文件，这与 Silverlight 的配置文件非常相似（但不完全是相同）。虽然添加为不同配置文件编译的 DLL 可能会起作用，但这是非常危险的，因为您可能会在运行时遇到应用程序崩溃的问题，因为 Mono for Android 配置文件中缺少某些内容。

现在最好的答案是创建一个 Mono for Android 类库，从你想使用的库中链接适当的文件，然后引用它。这将使您在编译时检查您没有使用 Mono for Android 配置文件不支持的任何内容，并帮助您从长远来看更加清醒。我在[这里有一篇旧博客文章](http://www.gregshackles.com/2010/12/shared-libraries-for-windows-phone-7-monodroid-and-beyond/)，讨论了如何跨项目链接文件。

也就是说，在这种情况下，您很幸运，因为其他人已经为您完成了最后一部分！查看[Json.NET 的这个分支，](https://github.com/attilah/Newtonsoft.Json)它提供了 MonoTouch 和 Mono for Android 的版本。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T12:51:15.793

> 奇怪的是没有选项可以从项目属性中更改 .NET Framework。你能告诉我我错过了什么吗？

这并不奇怪 - 该对话框是由 Microsoft 编写的，考虑到它自己的项目类型*。*听起来 Mono for Android 没有可用的相同选项。

我强烈怀疑您只需要使用面向 .NET 3.5 的 JSON.NET 版本。

（话虽如此，Android 的 Mono 声称支持“动态语言功能”，这听起来*应该*针对 .NET 4。奇怪。我怀疑修复是一样的。）

# jquery - 如何从另一页隐藏第一页中的 div？

> ID：10551657
> 
> 赞同：0
> 
> 时间：2012-05-11T12:48:56.877
> 
> 标签：jquery, html

我的第一页上有一些普通的 div：

```
<div id="news">
            <div class="loginform">

                <div id="form_news">

                <form id="loginform" method="post" action="envianews.asp">
                <div id="news_campos">
                    <input type="text" id="nome" name="nome" value="" title="Nome" placeholder="NOME" autocomplete="off" required />
                    <input type="text" id="email" name="email" value="" title="Email" placeholder="EMAIL" autocomplete="off" required/>
                </div>
                <input type="submit" class="bt_news" name="submit" id="submit" value=""/>
                <div id="news_response"></div>
                </form>             

                </div>

            </div>
        </div> 
```

在我`envianews.asp`的身上，我有将这些信息发送到数据库的脚本。我想知道我需要做什么，因为当这个人点击发送数据的按钮时，隐藏我的 div `news`...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T12:51:39.333

使用[http://jquery.com/](http://jquery.com/)

然后隐藏 div 使用

```
$("#news").hide(); 
```

并将值发送到数据库使用 Ajax

[http://docs.jquery.com/Ajax](http://docs.jquery.com/Ajax)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T12:51:10.357

这很简单，在您发送数据并且想要隐藏您的 div 之后，您所要做的就是：

```
document.getElementById('news').style.display = 'none' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T12:53:39.290

```
$(function(){
 $("#submit").click(function(e){
  e.preventDefault();
  $.post("envianews.asp", { name: $("#nome").val(), email: $("#email").val() } ,function(data){
     $("#news_campos").hide();  // hide when we get the resonse from ajax call
  });

 });
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-11T12:53:46.357

```
$(function(){
    $('#submit').click(function(){
        $('#news').hide();
    });
}); 
```

[演示](http://jsfiddle.net/TRWkK/)

# c - 如何创建渲染 3D 场景的 4KB Linux 二进制文件？

> ID：10551665
> 
> 赞同：13
> 
> 时间：2012-05-11T12:49:05.687
> 
> 标签：c, linux, linker, executable

我刚刚了解了[4k 演示场景竞赛](http://www.creativeapplications.net/windows/hartverdrahtet-infinite-complexity-in-4096-bytes/)。它包括创建一个 4KB 的可执行文件，它可以渲染一个漂亮的 3D 场景。引用的演示是为 Windows 构建的，所以我想知道，如何在 Linux 上创建 4KB OpenGL 场景。

一个简单的“hello world”已经消耗了 8KB：

```
$ cat ex.c
#include <stdio.h>

int main()
{
       printf("Hello world\n");
}
$ gcc -Os ex.c -o ex
$ ls -l ex
-rwxrwxr-x 1 cklein cklein 8374 2012-05-11 13:56 ex 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-11T13:19:03.717

使用标准设置无法制作小工具的主要原因是大量符号和对标准库的引用被拉入二进制文件。你必须明确地删除那些基本的东西。

我是这样做的：

[http://phresnel.org/gpl/4k/ntropy2k7/](http://phresnel.org/gpl/4k/ntropy2k7/)

## 相关选项：

主要是自我解释：

```
gcc main.c -o fourk0001 -Os -mfpmath=387 \
  -mfancy-math-387 -fmerge-all-constants -fsingle-precision-constant \
  -fno-math-errno -Wall -ldl -ffast-math -nostartfiles -nostdlib  \
  -fno-unroll-loops -fshort-double 
```

## 按摩：

`strip`帮助您摆脱二进制文件中嵌入的不需要的符号：

```
strip -R .note -R .comment -R .eh_frame -R .eh_frame_hdr -s fourk0001 
```

## 代码：

您可能需要进行很多调整和反复试验。有时，循环给出更小的代码，有时是调用，有时是强制内联函数。例如，在我的代码中，我没有一个包含所有花哨多态样式的火焰变换的干净链表，而是有一个固定数组，其中每个元素都是一个包含所有参数（使用或未使用）的大实体，作为所有火焰的联合根据 Scott Draves 火焰纸。

您的技巧不会是可移植的，其他版本的 g++ 可能会产生次优结果。

请注意，使用上述参数，您编写的不是`main()`函数，而是`_start()`函数。

另请注意，使用库有点不同。您必须手动完成，而不是以优雅、便捷的方式链接 SDL 和标准库函数。例如

```
void *libSDL = dlopen( "libSDL.so", RTLD_LAZY );
void *libC = dlopen( "libc.so", RTLD_LAZY );
#if 1
    SDL_SetVideoMode_t sym_SDL_SetVideoMode = dlsym(libSDL, "SDL_SetVideoMode");
    g_sdlbuff = sym_SDL_SetVideoMode(WIDTH,HEIGHT,32,SDL_HWSURFACE|SDL_DOUBLEBUF);
#else
    ((SDL_SetVideoMode_t)dlsym(libSDL, "SDL_SetVideoMode"))(WIDTH,HEIGHT,32,SDL_HWSURFACE|SDL_DOUBLEBUF);
#endif

//> need malloc, probably kinda craft (we only use it once :| )
//> load some sdl cruft (cruft!)
malloc_t sym_malloc = dlsym( libC, "malloc" );
sym_rand   = dlsym( libC, "rand" );
sym_srand  = dlsym( libC, "srand" );
sym_SDL_Flip          = dlsym(libSDL, "SDL_Flip");
sym_SDL_LockSurface   = dlsym(libSDL, "SDL_LockSurface");
sym_SDL_UnlockSurface = dlsym(libSDL, "SDL_UnlockSurface");
sym_SDL_MapRGB        = dlsym(libSDL, "SDL_MapRGB"); 
```

即使没有汇编程序必须受到损害，您的代码也可能会产生 UB。

* * *

编辑：

哎呀，我在组装上撒了谎。

```
void _start() {
    ...
    asm( "int $0x80" :: "a"(1), "b"(42) );
} 
```

这将使您的程序返回 42。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-11T13:36:38.410

[*A Whirlwind Tutorial on Creating really Teensy ELF Executables for Linux*](http://www.muppetlabs.com/~breadbox/software/tiny/teensy.html)是一篇有趣的文章，它通过逐步过程创建尽可能小的 ELF 可执行文件。

我不想破坏结局，但作者把它缩小到比 4K 小很多；*）*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-11T12:55:23.120

看看不久前 KSplice 博客中的这篇文章。它讨论了没有标准库的链接。

[https://blogs.oracle.com/ksplice/entry/hello_from_a_libc_free](https://blogs.oracle.com/ksplice/entry/hello_from_a_libc_free)

# android - 是否可以在您自己的应用程序中呈现第 3 方小部件？

> ID：10551677
> 
> 赞同：1
> 
> 时间：2012-05-11T12:49:40.970
> 
> 标签：android, android-widget

小部件只能在启动器中呈现吗？是否可以在我的应用程序中呈现来自其他开发人员的小部件？

# jquery - jQuery.live() 和黄瓜测试

> ID：10551678
> 
> 赞同：0
> 
> 时间：2012-05-11T12:49:47.213
> 
> 标签：jquery, ruby-on-rails, testing, selenium, cucumber

selenium 在黄瓜测试中用作默认 Capybara javascript 驱动程序时是否支持 jQuery.live()？如果没有，您会建议什么替代方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T13:48:23.697

我不相信 Selenium 真的在乎你使用什么 jQuery 方法。我将 Selenium 与 Cucumber/Capybara 一起使用，并且之前使用过 .live()，一切都很好。

作为一个稍微无关的旁注，如果您使用的是 jQuery 7.x 或更高版本，您应该使用 .on() 方法而不是 .live()，因为 .live() 因一些细微的错误和性能问题而被弃用。

[http://api.jquery.com/live/](http://api.jquery.com/live/)

[http://api.jquery.com/on/](http://api.jquery.com/on/)

**编辑**根据要求，我使用 cucumber-rails 1.2.1，它引入了水豚。目前我的水豚是 1.1.2，它引入了我在 2.21.2 的 selenium-webdriver。

# javascript - 通过div模糊页面背景？

> ID：10551683
> 
> 赞同：0
> 
> 时间：2012-05-11T12:50:03.027
> 
> 标签：javascript, css

我已经看过几乎相同的问题的另一篇文章，但我不明白如何实现它。我有一个链接到我的 html 文件的 .css 文件。我将如何使用“blurfast.js”来获得模糊的 div 背景？我可以做这样的事情吗？

`mydiv {background:blurfast;}`

在我的 .css 文件中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T12:51:50.933

不，在 JS 中：

```
<script type="text/javascript">
    Pixastic.process(domeDiv, "blurfast", {amount:1});
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T12:55:53.747

这仅适用于图像，因此据我所知不适用于您的要求！对于图像，下面的 javascript 应该可以工作！

```
<script type="text/javascript">
    var img = document.getElement("myImage");
    Pixastic.process(img, "blurfast", {amount:1});
</script> 
```

# windows - WS_EX_LAYERED 窗口不相对于其父窗口移动

> ID：10551692
> 
> 赞同：0
> 
> 时间：2012-05-11T12:50:26.547
> 
> 标签：windows, winapi, win32gui

我创建了一个具有 WS_EX_LAYERED 扩展样式的窗口。之后，我将此窗口的父级更改为对 SetParent 的调用。但是当我在桌面上移动父窗口时，我的窗口并没有改变其相对于其父窗口的位置。

```
int translevel = 50;  /* 0 - 255 */
      SetWindowLong(m_hWnd,GWL_EXSTYLE,GetWindowLong(m_hWnd,GWL_EXSTYLE)|WS_EX_LAYERED );
      ::SetLayeredWindowAttributes(m_hWnd,RGB(0,0,0),translevel, 0x02);

      HWND hParent  = ::FindWindow(TEXT("TSSHELLWND"), NULL);

      ::SetParent(m_hWnd, hParent); 
```

注意：- TSSHELLWND 是 mstsc 会话窗口。我想让我的窗口成为 mstsc 会话窗口的子窗口。

它没有移动，因为我在子窗口上应用了 LAYESRED 属性？？？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T14:52:04.383

您不能`WS_EX_LAYERED`在 Windows8 之前的系统上的子窗口上使用。[文档说了这么多](http://msdn.microsoft.com/en-us/library/windows/desktop/ff700543.aspx)：

> Windows 8：顶级窗口和子窗口支持 WS_EX_LAYERED 样式。以前的 Windows 版本仅支持顶级窗口的 WS_EX_LAYERED。

# java - 如何访问正在运行的 servlet 过滤器？

> ID：10551694
> 
> 赞同：1
> 
> 时间：2012-05-11T12:50:38.497
> 
> 标签：java, servlets, cron, quartz-scheduler, servlet-filters

我将创建一个`ServletFilter`将改变处理 HTTP 请求的方式。

将`ServletFilter`根据数据库中数据的状态做出这些决定。

`ServletFilter`我宁愿每次调用时都不会发生数据库命中。

webapp 已经`quartz`实现了，所以在预定时间访问数据库不是问题。

我的问题是，*我怎样才能`ServeltFilter`在这些时间间隔内联系它，以便在下一个时间间隔之前为其提供一组新的保存信息？*

* * *

**更新：** 在这篇 SOF 帖子中有关于将 ServletContext 放入 Quartz 作业的有用讨论。 [如何在 Java servlet 上下文中获取和设置全局对象](https://stackoverflow.com/questions/3215988/how-to-get-and-set-a-global-object-in-java-servlet-context)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T12:56:40.890

简短的回答是：是的*，你可以，但虽然我不推荐它*，因为你的更新功能不应该在那里，而是在一个负责该任务的类中，这提高了凝聚力。

*   如果您想知道如何获取过滤器，请查看 javadoc 中的此方法。

    [ServletContext.getFilterRegistration()](http://docs.oracle.com/javaee/6/api/javax/servlet/ServletContext.html#getFilterRegistration%28java.lang.String%29)

*   调用此方法可以获取 Servlet 上下文实例：

    [ServletContext.getContext("路径")](http://docs.oracle.com/javaee/6/api/javax/servlet/ServletContext.html#getContext%28java.lang.String%29)

希望你觉得这很有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T13:58:38.983

与其试图找到过滤器告诉它，不如让过滤器通过查询某处的服务（例如存储在 中`ServletContext`）来查找信息，或者让服务将信息存储在`ServletContext`.

# labview - 使用 XY 图形作为控制

> ID：10551695
> 
> 赞同：2
> 
> 时间：2012-05-11T12:50:40.363
> 
> 标签：labview

我想要做的是使用 XY 图表作为用户输入控件，它同时给我 x 和 y 值。我能够在框图中将 XY 图表从指示器切换到控件，但在运行时没有效果。

XY 图表中没有数据。

为了从 XY 图表中获取数据，我使用“索引数组”块和“按名称解绑”块将第一个元素解绑到 X 和 Y 坐标。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T08:49:53.580

图形控件的值就是其中显示的内容。将其用作控件是没有意义的。如果您想知道点击的位置，您应该使用鼠标按下事件并使用调用节点将坐标转换为 XY，如下所示：

![图表点击坐标](../Images/8bbb03da7cc7f975e82246ad17f8be94.png)

当然，您可以在任何类型的控件（例如表格）上使用鼠标按下事件，因此您不需要专门为类似的东西绘制图表，除非比例尺为您提供方便的 UI。

# php - PHP散列输入字段名称

> ID：10551696
> 
> 赞同：1
> 
> 时间：2012-05-11T12:50:43.597
> 
> 标签：php, security, md5

我一直在阅读[这篇博客文章](http://nedbatchelder.com/text/stopbots.html)和这篇[堆栈溢出文章](https://stackoverflow.com/questions/3622433/how-much-the-honey-pot-practice-is-efficently-against-spam)，但我对散列表单字段没有太多经验（蜜罐部分，网上似乎有很多例子）所以我有几个问题。

**问题 1**

是这样的还是我离基地很远？（注意，这是一个简化的示例，为简洁起见仅包含时间戳）

表单上的 PHP：

```
$time = mktime(); 
$first_name = md5($time + 'first_name'); 
```

表单上的 HTML：

```
<form action="register.php" method="post">
<input type="text" name="<?php echo $first_name ?>" >
<input type="hidden" name="check" value="<?php echo $time ?>" >
<input type="submit" name="register">
</form> 
```

注册.php

```
// check to see if there is a timestamp
if (isset($_POST['check'])) {
    $time = strtotime($_POST['check']);

    if (time() < $time) {
    // original timestamp is in the future, this is wrong
    }

    if (time() - $time < 60) {
    // form was filled out too fast, less than 1 minute?
    }

    // otherwise
    $key = $_POST['check'];

    if (md5($key + 'first_name') == $_POST['whatever-the-hash-on-the-first_name-field-was']) {
        // process first_name field?
    }
} 
```

**问题2：**

字段名称的散列如何使事情更安全？我得到了时间戳检查（虽然我不理解博客文章中“过去太远”的部分......如果有的话，机器人不会太快填写它吗？？）但我不确定什么是散列name 属性确实如此。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-11T13:14:19.173

在将字段名称发送到客户端之前，您需要对服务器端进行哈希处理：

```
<form action="register.php" method="post">
<? $timestamp = time() ?>
<!-- This is where the user would put the email. Don't put this comment in for real -->
<input type="text" name="<?php echo md5("email" . $timestamp . $secretKey) ?>" >
<input type="hidden" name="check" value="<?php echo $timestamp ?>" >
<input type="submit" name="register">
</form> 
```

这将随机化字段的名称。在您的服务器上发布数据时，您需要重新散列字段名称以找到正确的发布变量：

```
<?
    if (isset($_POST['check'])) {
        $email = $_POST[md5("email" . $_POST['check'] . $secretKey)];
    }
?> 
```

该博客的作者说这是一种防止重放攻击的方法。我认为这个想法有一些优点，下面是它的工作原理：

1.  攻击者会访问您的站点，并手动填写表单，记录您的所有字段名称。
2.  然后，他会将这些记录的字段名称输入到他的机器人中，并对机器人进行编程，以便稍后重新填写您的表格。
3.  攻击者可能会将此记录在“电子邮件字段”`<input type="text" name="0c83f57c786a0b4a39efab23731c7ebc" />`和隐藏的检查字段中`<input type="hidden" name="2012/05/11 12:00:00" />`
4.  然后，该机器人将发布具有不同数据的相同字段。
5.  This is where your "too far in the past" check would be triggered. The bot would be posting a timestamped form with an old date and you would reject it.

I hope this helps you understand what the blog author was getting at.

# javascript - 如果发生更改代码错误的顺序，这意味着什么？

> ID：10551697
> 
> 赞同：0
> 
> 时间：2012-05-11T12:50:47.663
> 
> 标签：javascript

我更改了places函数，以便在调用调用者之前发生错误。

这个角色能说什么？也许在一公里范围内的某个地方没有关闭？

UPD：例如，如果我将第一个字符串放在末尾，它的代码可以正常工作：

SCRIPT5022：传递一个函数，该函数返回dependentObservable knockout-2.0.0.debug.js 的值，第 1054 行字符 9

```
osagoViewModel.fields.yearsBoxes = new field("Years", yearsBoxesFunc, null, osagoViewModel);

function yearsBox() {
    this.year = new field("Years", function () { return ["1 year", "2 years", "3 years", "4 years", "5 years", "6 years", "7 years", "8 years", "9 years", "10 years"]; }, null, osagoViewModel);
}

var yearsBoxesFunc = function () {
    var yearsBoxCount = osagoViewModel.fields.driversCount.selectedValue();

    var retArrFunc = function (count) {
        var arr = [];
        for (var i = 0; i < count; i++) {
            arr.push(new yearsBox());
        }
        return arr;
    };

    switch (yearsBoxCount) {
        case "many":
            return retArrFunc(0);
        case "1":
            return retArrFunc(1);
        case "2":
            return retArrFunc(2);
        case "3":
            return retArrFunc(3);
        case "4":
            return retArrFunc(4);
        case "5":
            return retArrFunc(5);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T12:54:34.440

这取决于你如何声明函数。是否使用 var 是有区别的。看看这个样本：

```
function FunctionDefinitionOrder() {
    assert(isRed(), "Named function definition doesn't matter");        
    assert(isGreen === undefined, "However, it's not the case with anonymous functions");

    function isRed() { return true; }
    var isGreen = function () { return true; };

    assert(isGreen(), "Anonymous functions are known only after the definition");
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T12:55:36.950

您应该恢复您的更改并处于最新的稳定状态。然后开始做任何你想做的小改动。这将花费大量时间来识别代码中的任何语法错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-11T13:45:00.873

打开你的控制台，让它在错误时停止。在堆栈跟踪中，您将看到在没有函数作为参数的情况下调用了 knockout.js 函数的位置。

要了解函数解析及其在当前范围内的可用性，请阅读[JavaScript 中的函数表达式与声明有什么区别？](https://stackoverflow.com/q/1013385/1048572)和/或[var functionName = function() {} vs function functionName() {}](https://stackoverflow.com/questions/336859/javascript-var-functionname-function-vs-function-functionname)。

# java - 我们可以编写自定义标记接口吗

> ID：10551699
> 
> 赞同：7
> 
> 时间：2012-05-11T12:50:56.700
> 
> 标签：java

我想编写自己的标记接口，例如JVM 可以理解的`java.io.Serializable`或。`Cloneable`请建议我执行程序。

例如，我实现了一个名为的接口`NotInheritable`，实现该接口的所有类都必须避免继承。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T12:52:52.517

```
public interface MyMarkerInterface {}

public class MyMarkedClass implements MyMarkerInterface {} 
```

然后，例如，您可以让方法仅采用`MyMarkerInterface`实例：

```
public myMethod(MyMarkerInterface x) {} 
```

或`instanceof`在运行时检查。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-03-02T09:26:14.903

是的，我们可以编写自己的标记异常......请参见以下示例......

```
interface Marker{   
}

class MyException extends Exception {   

    public MyException(String s){
        super(s);
    }
}

class A implements Marker {

   void m1() throws MyException{        
     if((this instanceof Marker)){
         System.out.println("successfull");
     }
     else {
         throw new MyException("Unsuccessful  class must implement interface Marker ");
     }      
}   
}

/* Class B has not implemented Maker interface .
 * will not work & print unsuccessful Must implement interface Marker
*/
class B extends A  {    

}

// Class C has not implemented Maker interface . Will work & print successful

public class C  extends A implements Marker   
 { // if this class will not implement Marker, throw exception
     public static void main(String[] args)  {
     C a= new C();
     B b = new B();

     try {
        a.m1(); // Calling m1() and will print
        b.m1();
     } catch (MyException e) {

        System.out.println(e);
    }

}
} 
```

![输出](../Images/86cac403f9539f75b5e6931185a0b7f6.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-26T13:38:10.177

假设只有当标记 MyInterface 应该在那里标记时才应该调用 myMethod 。

```
interface MyInterface{}

class MyException extends RuntimeException{

    public MyException(){}
    public MyException(String message){
        super(message);
    }
}

class MyClass implements MyInterface{
    public void myMethod(){
        if(!(this instanceOf MyInterface)){
            throw new MyException();
        }else{
            // DO YOUR WORK
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-11T12:59:34.590

您可以编写自己的 Marker 接口，JVM 对此一无所知。

您必须通过使用来提供功能`instanceof`。[检查这个](https://stackoverflow.com/questions/2146640/is-this-possible-to-write-a-marker-interface)

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2012-05-11T12:54:02.830

标记接口是一个空接口。这意味着您只需要创建一个接口，而不是在其中创建任何方法。你会在[这里](http://en.wikipedia.org/wiki/Marker_interface_pattern)找到更好的解释。

这种方法可以用在类型上具有相似功能的[注释代替。](http://en.wikipedia.org/wiki/Java_annotation)[更多的](http://docs.oracle.com/javase/tutorial/java/javaOO/annotations.html)

# wpf - DataContext vs. EventTriggers vs. Window.SizeToContent

> ID：10551702
> 
> 赞同：1
> 
> 时间：2012-05-11T12:51:06.500
> 
> 标签：wpf, binding

我有一个非常简单的 UserControl，它在加载时启动进度条动画：

```
<UserControl x:Class="WpfApplication2.UserControl1" 
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <ProgressBar Width="200"  Height="10" Maximum="{Binding Delay}" SmallChange="1">
        <ProgressBar.Triggers>
            <EventTrigger RoutedEvent="ProgressBar.Loaded">
                <BeginStoryboard>
                    <Storyboard>
                        <DoubleAnimation 
                        Storyboard.TargetProperty="Value" To="{Binding Delay}" Duration="00:00:10" />
                    </Storyboard>
                </BeginStoryboard>
            </EventTrigger>
        </ProgressBar.Triggers>
    </ProgressBar>
</UserControl> 
```

动画的`To`值来自 UserControl 的 DataContext：

```
class ViewModel
{
    public int Delay
    {
        get { return 10; }
    }
} 
```

UserControl 显示在一个窗口中，如下所示：

```
var w = new Window();
var vm = new ViewModel();
var c = new UserControl1 {DataContext = vm};
w.Content = c;
w.Owner = this;
w.WindowStartupLocation = WindowStartupLocation.CenterOwner;
// to make the animation play, I have to remove the following line
w.SizeToContent = SizeToContent.WidthAndHeight;
w.ShowDialog(); 
```

只要我有线，动画就不会播放

`w.SizeToContent = SizeToContent.WidthAndHeight;`

在我的代码中。

有没有人对这种非常奇怪的行为有解释并能提出解决方案？

最终目标非常简单。我想要的只是在加载 UserControl/Window 后一段时间（由 viewmodel 指定）的进度条动画。最好是仅 XAML。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T13:33:24.327

代替

```
w.SizeToContent = SizeToContent.WidthAndHeight 
```

使用该代码，我同意它的混乱，但它有效

```
 w.SourceInitialized += (s, a) =>
            {

                w.SizeToContent = SizeToContent.WidthAndHeight;

                w.UpdateLayout();
                w.Left = this.Left + (this.ActualWidth / 2.0 - w.ActualWidth / 2.0);
                w.Top = this.Top + (this.ActualHeight / 2.0 - w.ActualHeight / 2.0);
            }; 
```

不幸的是，我对此没有任何解释。我只知道 WPF 的工作方式以及 Windows 本身在内部处理 Windows 的方式有时会发生冲突。我在设置窗口的左侧/顶部/宽度/高度然后直接最大化它时遇到了同样的问题。为了解决它，我只是将它推迟到`SourceInitialized`事件被触发。我对您的代码进行了同样的尝试，这似乎是一个类似的问题，因为这成功了。

# regex - 使用 sed 提取日期时间

> ID：10551705
> 
> 赞同：2
> 
> 时间：2012-05-11T12:51:13.977
> 
> 标签：regex, sed

我正在查看来自 tomcat 的访问日志，其中包含以下内容：

```
96.28.193.125 - - [10/May/2012:07:08:39 +0000] 0 "GET / " 200 123 "-" "-" 
```

我想使用 sed 来提取日期时间。

所以我只看到：

```
[10/May/2012:07:08:39 +0000] 
```

我知道它应该是这样的：

```
sed -e 's/oldstuff//g' inputFileName > outputFileName 
```

oldstuff 应该是一个正则表达式来获取不在方括号之间的文本。

我不知道如何在正则表达式中表达它，并且希望有任何提示？

我最大的努力是：

```
sed -e 's
/[^\[(.*?)\]]//g' inputfilename > outputFileName 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T12:58:41.357

试试这个：

```
 sed -e 's;^.*\(\[.*\]\).*$;\1;' inputFileName > outputFileName 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T14:05:12.097

```
grep -o '\[[^]]\+\]' file 
```

找到一个`[`然后一个或多个不是`]`然后一个的字符`]`

# javascript - 在 JavaScript 中使用 {}？

> ID：10551708
> 
> 赞同：4
> 
> 时间：2012-05-11T12:51:23.580
> 
> 标签：javascript

非常简单的问题，但我对 JS 很陌生，这并不容易搜索。

如果我看到这样的一行：

```
var colours = {}, r, g, b; 
```

我知道这只是 3 个变量的声明，但是 {} 位是什么意思？我看不到任何地方可以让我知道这是在声明什么？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T12:53:03.723

它声明了新对象并等效于`new Object();`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-11T13:02:06.433

```
 var colours = {}, r, g, b; 
```

这声明了 4 个变量，它们与

```
 var colors = {}; // this is an empty object like, var colors = new Object();
   var r; // undefined
   var g; // undefined
   var b; // undefined 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-11T12:52:47.620

这意味着颜色将成为一个对象。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-11T12:54:25.127

`{}`声明一个没有成员的对象。就像一个空的数据容器。 `[]`将声明一个空数组。

数组有数字索引（和一些方便的方法），对象可以有字符串索引（但缺少数组的方法）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-05-11T12:55:26.980

这是*四个*变量的声明，而不是三个。一个被调用`colours`并初始化为`{}`。其他的称为`r`、`g`和`b`，它们的初始值为`undefined`。`{}`是一个空对象字面量。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-05-11T12:53:25.880

它声明了一个空的对象文字。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-05-11T12:53:54.530

`colors`它使用一个新的空对象进行初始化。

虽然 JavaScript 中的对象也可以有方法，但它们通常用作关联数组，这在这种情况下很可能（基于名称的假设以及它在没有任何属性的情况下初始化的事实）。

# javascript - Javascript - 跨浏览器关闭选项卡事件和 ajax

> ID：10551710
> 
> 赞同：1
> 
> 时间：2012-05-11T12:51:30.593
> 
> 标签：javascript, ajax, javascript-events

如何实现跨浏览器关闭标签事件？我试试这个：

```
function callAjax() {
 //some ajax stuffs for removing user from database
}

window.onunload = function() {
 callAjax();
 return null;
}
window.onbeforeunload = function() {
 callAjax();
 return null;
} 
```

它有效。但是如果我快速多次按下 F5 刷新页面，ajax 有时不会发生。异步为假；

# jquery - 如何自动将页面滚动到 动画到另一个位置后的元素？

> ID：10551711
> 
> 赞同：1
> 
> 时间：2012-05-11T12:51:36.227
> 
> 标签：jquery, html, css, animation, scroll

我有这段代码，但我不知道如何自动滚动到球的移动位置。球移出屏幕，向上移动。

编码：

```
jQuery(document).ready(function($) {
$(".scroll").click(function(event){     
    event.preventDefault();
    $('html,body').animate({scrollTop:$(this.hash).offset().top}, 500);
}); 
});

$(function() {
    $( "#ball" ).draggable({ containment: "#containment-wrapper", scroll: false, revert: "invalid" });
    $( "#ball2" ).draggable({ containment: "#containment-wrapper", scroll: false, revert: "invalid" });
$( "#droppable" ).droppable({
        activeClass: "ui-state-hover",
        hoverClass: "ui-state-active",
        drop: function( event, ui ) {
            $("#ball2").animate({left: '-=100', top: '-=250'}, 300);
            $( this )
                .addClass( "ui-state-highlight" )
                .find( "p" )
                    .html( "ball runs up" );
        }           
});
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T12:55:06.837

你不能用`scrollIntoView()`吗？

[http://www.quirksmode.org/dom/tests/scrollintoview.html](http://www.quirksmode.org/dom/tests/scrollintoview.html)

# html - Xpath - 如果其类包含一些文本，则获取 HTML 元素

> ID：10551717
> 
> 赞同：19
> 
> 时间：2012-05-11T12:51:49.153
> 
> 标签：html, xpath

如果元素的类包含一些文本，我可以获得一个元素吗？

例子：

```
<div class="headerbody"></div>   - match (header)
<div class="headerbottom"></div>   - match (header)
<dov class="text"></div>     - not match (header) 
```

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2012-05-11T12:54:24.857

您可以[`contains()`](http://www.w3.org/TR/xpath/#function-contains)在 XPath 谓词中使用。像这样：

```
div[contains(@class, 'header')] 
```

# php - 获取 Youtube 视频标题、描述和缩略图时出错

> ID：10551719
> 
> 赞同：1
> 
> 时间：2012-05-11T12:51:52.440
> 
> 标签：php, youtube, youtube-api

我从相同的代码中获取 youtube 标题和 youtube 描述，但现在它不起作用我收到以下错误：

警告：DOMDocument::load() [domdocument.load]: http:// wrapper 在服务器配置中被 /home/colorsfo/public_html/zaroorat/admin/pages/addSongProcess.php 第 16 行的 allow_url_fopen=0 禁用

警告：DOMDocument::load(http://gdata.youtube.com/feeds/api/videos/Y7G-tYRzwYY) [domdocument.load]：无法打开流：在 /home/colorsfo/ 中找不到合适的包装器public_html/zaroorat/admin/pages/addSongProcess.php 在第 16 行

警告：DOMDocument::load() [domdocument.load]：I/O 警告：无法在 /home/colorsfo 中加载外部实体“http://gdata.youtube.com/feeds/api/videos/Y7G-tYRzwYY” /public_html/zaroorat/admin/pages/addSongProcess.php 第 16 行

..................................... 以下编码用于获取 Youtube 视频数据：

`$url = "http://gdata.youtube.com/feeds/api/videos/".$embedCodeParts2[0]; $doc = new DOMDocument; @$doc->load($url); $title = $doc->getElementsByTagName("title")->item(0)->nodeValue; $videoDescription = $doc->getElementsByTagName("description")->item(0)->nodeValue;`

它以前可以工作（此编码在本地服务器上工作正常，但在互联网上它不工作）但现在它不工作。请指导我如何解决此错误。谢谢你的时间。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-09T10:43:10.917

您的服务器的 allow_url_fopen 已禁用（我的也是如此）。我感觉到你的痛苦。这就是我所做的。

尝试使用[cURL](http://php.net/manual/en/book.curl.php)，但使用 YouTube 的 v2 api 以 json 格式返回您的数据。您可以通过将该数据附加到 url 的末尾来做到这一点。

```
?v=2&alt=json 
```

您没有发布如何获取 YouTube ID，这可能是问题的一部分（尽管您的示例网址确实有效）。所以以防万一，我还发布了一个简单的函数来从 YouTube 视频 url 中检索 ID。

```
function get_youtube_id($url) {
    $newurl = parse_url($url);
    return substr($newurl['query'],2);
} 
```

好的，现在假设您有视频 ID，您可以为要返回的每个字段运行以下函数。

```
// Grab JSON and format it into PHP arrays from YouTube.
// Options defined in the switch. No option returns entire array
// Example of what the returned JSON will look like, pretty, here:
// http://gdata.youtube.com/feeds/api/videos/dQw4w9WgXcQ?v=2&alt=json&prettyprint=true
function get_youtube_info ( $vid, $info ) {
    $youtube = "http://gdata.youtube.com/feeds/api/videos/$vid?v=2&alt=json";
    $ch = curl_init($youtube);
    curl_setopt($ch, CURLOPT_HEADER, false);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
    $output = curl_exec($ch);
    curl_close($ch);

    //If $assoc = true doesn't work, try:
    //$output = json_decode($output, true);
    $output = json_decode($output, $assoc = true);

    //Add the ['feed'] in if it exists.
    if ($output['feed']) {
        $path = &$output['feed']['entry'];
    } else {
        $path = &$output['entry'];
    }

    //set up a switch to return various data bits to return.
    switch($info) {
        case 'title':
            $output = $path['title']['$t'];
            break;
        case 'description':
            $output = $path['media$group']['media$description']['$t'];
            break;
        case 'author':
            $output = $path['author'][0]['name'];
            break;
        case 'author_uri':
            $output = $path['author'][0]['uri'];
            break;
        case 'thumbnail_small':
            $output = $path['media$group']['media$thumbnail'][0]['url'];
            break;
        case 'thumbnail_medium':
            $output = $path['media$group']['media$thumbnail'][2]['url'];
            break;
        case 'thumbnail_large':
            $output = $path['media$group']['media$thumbnail'][3]['url'];
            break;
        default:
            return $output;
            break;
    }
    return $output;
}

$url = "http://www.youtube.com/watch?v=oHg5SJYRHA0";
$id = get_youtube_id($url);

echo "<h3><a href=" . $url . ">" . get_youtube_info($id, 'title') . "</a></h3>"; //echoes the title
echo "<p><a href=" . $url . "><img style='float:left;margin-right: 5px;' src=" . get_youtube_info($id, 'thumbnail_small') . " /></a>" . get_youtube_info($id, 'description') . "</p>"; //echoes the description
echo "<br style='clear:both;' /><pre>";
echo print_r(get_youtube_info($id));
echo "</pre>"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-28T12:50:14.557

我希望现在还不算晚。我的解决方案是在您的 Linux 机器中编辑 /etc/resolv.conf：并将第一行替换为以下行：

名称服务器 8.8.8.8

然后保存文件。无需重新启动服务。

可能适用于出于安全考虑意外禁用某些功能的服务器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T12:55:37.787

DOMDocuments 的 load() 函数使用 PHP 的 fopen 包装器来检索文件。似乎在您的网络服务器上，`allow_url_fopen`设置为 0，因此禁用了这些包装器。尝试将以下行添加到脚本的顶部：

```
ini_set ('allow_url_fopen', 1); 
```

更新：试试这个：

```
<?php
$url = "http://gdata.youtube.com/feeds/api/videos/" . $embedCodeParts2[0];

$ch = curl_init();

curl_setopt($ch, CURLOPT_URL, $url);
curl_setopt($ch, CURLOPT_HEADER, 0);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);

$file = curl_exec($ch);

curl_close($ch);

$doc = new DOMDocument;
@$doc->loadHTML($file);
$title = $doc->getElementsByTagName("title")->item(0)->nodeValue;
$videoDescription = $doc->getElementsByTagName("description")->item(0)->nodeValue; 
```

# maven - 如何在不将执行附加到 maven 阶段的情况下调用 maven-antrun-plugin 目标？

> ID：10551726
> 
> 赞同：4
> 
> 时间：2012-05-11T12:52:04.607
> 
> 标签：maven, maven-antrun-plugin

我将 maven-antrun-plugin 用于我的项目的初始化配置文件。但是我只需要初始化一次配置文件，当我第一次开始初始化我的开发环境时，而不是每次我启动 jetty:run 时。

例如，如果我将阶段附加到进程资源，则每次启动码头时，我的配置文件都会重置。

所以我像这样配置了antrun：

```
<plugin>
    <artifactId>maven-antrun-plugin</artifactId>
    <executions>
        <execution>
        <goals>
            <goal>run</goal>
        </goals>
        <configuration>
            <target name="init_config_files">
                <!-- init files -->
            </target>
        </configuration>
        </execution>
    </executions>
</plugin> 
```

如果我启动 mvn antrun:run，它只会返回这个错误：“[INFO] No ant target defined - SKIPPED”。如果我指定目标：“mvn antrun:run -Dtarget=init_config_files”，也是一样的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-13T07:14:42.813

尝试这个：

```
 <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-antrun-plugin</artifactId>
            <version>1.7</version>
            <executions>
                <execution>
                    <id>default-cli</id>
                    <configuration>
                        <target>
                            <property name="compile_classpath" refid="maven.compile.classpath" />
                            <echo message="compile classpath: ${compile_classpath}" />
                        </target>
                    </configuration>
                    <goals>
                        <goal>run</goal>
                    </goals>
                </execution>
            </executions>
        </plugin> 
```

并运行：

```
 mvn antrun:run 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2016-02-18T20:01:52.033

到目前为止我找到的最佳解决方案：

```
 <plugin>
            <artifactId>maven-antrun-plugin</artifactId>
            <version>1.7</version>
            <executions>
                <execution>
                    <id>go-live</id>
                    <configuration>
                        <target>
                            <!-- go live! -->
                            <exec executable="${basedir}/deploy2server.sh" failonerror="true" dir="${basedir}">
                                <arg value="deploy" />
                                <arg value="${deploy.to.server}" />
                                <arg value="${jetty.port.live}" />
                            </exec>
                        </target>
                    </configuration>
                    <goals>
                        <goal>run</goal>
                    </goals>
                </execution>
            </executions>
        </plugin> 
```

并运行：

```
 mvn antrun:run@go-live 
```

该解决方案避免了目标被意外运行，即。它不仅可以通过键入“mvn antrun:run”来运行，而且它也不会在常规 maven 运行期间运行。在所有模块（包括针对最终分发包完成的集成）已成功执行后，我将其用于我的 jenkins 实例中的 qa 自动部署。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-11-13T14:56:08.773

我刚刚遇到了同样的问题，终于弄明白了：如果你只想运行一次 ant 任务，你可以像这样设置插件：

```
<plugin>
    <artifactId>maven-antrun-plugin</artifactId>
    <configuration>
        <target name="init_config_files">
            <!-- init files -->
        </target>
    </configuration>
</plugin> 
```

并用于`mvn antrun:run`执行它。这样，蚂蚁的东西就不会绑定到任何阶段。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-11T15:39:46.630

如果您需要在特殊条件下运行构建的某些部分（例如一次），您可以将这些部分放入[Maven 配置文件](http://maven.apache.org/guides/introduction/introduction-to-profiles.html)中，然后调用 Maven 指定配置文件名称，例如`mvn -p init_config_files package`

# highcharts - 图例中的 Highcharts 符号

> ID：10551727
> 
> 赞同：4
> 
> 时间：2012-05-11T12:52:10.193
> 
> 标签：highcharts, scatter-plot

我有一个 highcharts 图例，其中符号以不同的大小显示，因为它们在实际图表中的大小不同。不幸的是，当数据点的大小增长时，它们也在图例中增长。无论数据点大小如何，我都希望图例符号保持相同大小。

这是一个数据点随图表增长的示例。万一这很重要，我使用的实际图表是散点图（与示例不同）。

[http://jsfiddle.net/RsUhk/](http://jsfiddle.net/RsUhk/)

任何帮助深表感谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-12T16:27:22.647

这有点hacky，但这是我能想到的最好的。绘制绘图后，手动调整图例符号：

```
$(chart.series).each(function(){
    this.legendSymbol.attr('width',8);
    this.legendSymbol.attr('height',8);
    this.legendSymbol.attr('x',this.legendLine.attr('translateX')-17);
    this.legendSymbol.attr('y',this.legendLine.attr('translateY')-4);
}); 
```

[在这里](http://jsfiddle.net/SAYRC/)更新了小提琴。

# ssas - 计算成员显示所有成员，包括不存在事实的成员

> ID：10551730
> 
> 赞同：1
> 
> 时间：2012-05-11T12:52:22.537
> 
> 标签：ssas, mdx, member, cube

我创建了一个分配客户类型的计算成员。问题是它显示了客户维度的每一个成员，我没有太多经验来修复它。

我只想显示实际订购的客户。例如 [措施].[总金额]>0 为当前选定的期间。例如当年。（[基本日历]。[年 - 周 - 日期]）

请告知并查看下面的公式。

```
CREATE MEMBER CURRENTCUBE.[Measures].[Customer Type]
 AS IIF( [Measures].[Orders by Customer]=0, "Zero Customer",
            IIF( [Measures].[Orders by Customer]=1, "One Off Customer",  
            IIF([Measures].[Orders by Customer]>1 and [Measures].[Orders by Customer]<4 , "2 to 3 Orders", 
            IIF([Measures].[Orders by Customer]>3 and [Measures].[Orders by Customer]<6,  "4 to 5 Orders", 
            IIF([Measures].[Orders by Customer]>5, "VIP Customer",  "Other"))))), 
VISIBLE = 1  ; 
```

非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T13:31:51.810

只需添加一个返回 null 的“空”条件：

```
CREATE MEMBER CURRENTCUBE.[Measures].[Customer Type]
 AS
            IIF( IsEmpty([Measures].[Orders by Customer]), null,
            IIF([Measures].[Orders by Customer]=0, "Zero Customer",
            IIF( [Measures].[Orders by Customer]=1, "One Off Customer",  
            IIF([Measures].[Orders by Customer]>1 and [Measures].[Orders by Customer]<4 , "2 to 3 Orders", 
            IIF([Measures].[Orders by Customer]>3 and [Measures].[Orders by Customer]<6,  "4 to 5 Orders", 
            IIF([Measures].[Orders by Customer]>5, "VIP Customer",  "Other")))))), 
VISIBLE = 1  ; 
```

# css - 找出浏览器正在使用什么字体并调整css？

> ID：10551748
> 
> 赞同：4
> 
> 时间：2012-05-11T12:53:27.150
> 
> 标签：css, macos, browser

一位客户抱怨说，在他的 mac 上，他网站上的 CSS 看起来很糟糕。我检查了一下，发现他在浏览器中使用了一些设置来将字体设置为特定的字体，并且还具有最小高度。

现在的问题是某些 css 取决于高度，现在无法正常工作。我有没有机会检测到这些东西并覆盖css？（除了用 php 做它并加载自定义 css）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T14:42:35.263

我同意上面的评论。如果用户自定义了他们的本地字体设置，那么你不应该有责任让它工作。他们已经覆盖了您的预期设计。话虽如此，这是一种使用 JavaScript 检测字体的方法。

[http://www.lalit.org/lab/javascript-css-font-detect/](http://www.lalit.org/lab/javascript-css-font-detect/)

# apache-camel - 如何使用 CAMEL 发送带有多部分请求的 POST 方法

> ID：10551753
> 
> 赞同：0
> 
> 时间：2012-05-11T12:53:43.343
> 
> 标签：apache-camel, multipart

如何使用 CAMEL 发送带有多部分请求的 POST 方法

我有一个带有骆驼设置的应用程序，我需要附加文档并发送和 HTTP POST 请求。

我怎样才能做到这一点，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T18:32:55.637

您总是可以使用 apache httpcompenents 库编写一些 java 代码。见[http://hc.apache.org/](http://hc.apache.org/)

使用起来并不难

# c++ - 如何反序列化没有 Qt 的 QVariant 的输出

> ID：10551754
> 
> 赞同：1
> 
> 时间：2012-05-11T12:53:44.543
> 
> 标签：c++, string, qt, deserialization, qvariant

如何在不使用 QT 的情况下将输出 QVariant 反序列化为 std::string。

根据要求，我的程序不能包含 Qt。

`QVariant.toString().toStdString()`;

例子。

file.ini（使用 QSetting 写入）..

```
ID="\x1\0\0\0\xd0\x8c\xd9\xec\xfb*" 
```

profile_program /* 伪代码 */

```
int main ()
{
   void* IDQt =getIDFromIniFile("file.ini");
   std::string myId = convertID(IDQt);
   process(myID);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T18:58:46.777

查看源代码，可能是 src/corelib/kernel/qvariant.cpp 的`QDataStream& operator<<(QDataStream&, const QVariant&)`. 这样你就会知道在序列化过程中会写什么。

完成后，您将看到 operator<< 调用 QVariant::save(QDataStream&)。写的内容如下：

```
quint32 QVariant::type()
quint8 QVariant::isNull()
if type()==UserType
  QString MetaType::typeName(userType())
end
if the variant is not valid
  QString empty
else
  -- MetaType::save(...)
end 
```

您需要深入研究 QString 和 QMetaType 以弄清楚它们是如何序列化的。

# sql-server-2008 - 无法通过 Windows 服务访问 SQL Server 2008

> ID：10551758
> 
> 赞同：1
> 
> 时间：2012-05-11T12:53:55.420
> 
> 标签：sql-server-2008

我有一个通过 Windows 服务连接到 SQL Server 2008 的应用程序。基本上，Windows 服务会获取配置文件以获取连接详细信息，例如实例名称、用户名和密码。目前，此 Windows 服务无法启动并出现以下错误消息：-

建立与 SQL Server 的连接时发生与网络相关或特定于实例的错误。服务器未找到或无法访问。验证实例名称是否正确以及 SQL Server 是否配置为允许远程连接。（提供者：命名管道提供者，错误：40 - 无法打开与 SQL Server 的连接）

应用程序服务器和数据库服务器是不同的机器。我可以从应用程序服务器通过 SSMS 连接到 SQL Server，没有任何问题。我还在应用服务器上创建了一个 UDL，它也很好地连接到了数据库服务器。非常感谢这里的任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T13:22:40.110

检查 wwow windows 服务下的帐户是否正在运行 - 很可能该帐户不允许连接到其他计算机。

# outlook - 如何使用 ics 文件取消日历活动？

> ID：10551764
> 
> 赞同：27
> 
> 时间：2012-05-11T12:54:21.677
> 
> 标签：outlook, icalendar

我们的要求之一是创建 iCalendar 文件 (.ics) 并将它们作为附件发送到电子邮件中。我们正在使用[DDay.Ical.dll](http://sourceforge.net/projects/dday-ical/)创建 ics 文件，如下所示：

```
// Create a new iCalendar
iCalendar iCal = new iCalendar();

// Create the event, and add it to the iCalendar
Event evt = iCal.Create<Event>();

// Set information about the event
evt.Start = new iCalDateTime(SomeStartTime);
evt.End = new iCalDateTime(SomeEndTime);
evt.Location = "At so and so place";
evt.Description = "Some Description";
evt.Summary = "About Some Subject";
iCal.Method = "PUBLISH";

// Serialize (save) the iCalendar
iCalendarSerializer serializer = new iCalendarSerializer();
serializer.Serialize(iCal, @"iCalendar.ics"); 
```

完整的流程是：

1.  用户 1 为特定日期和时间创建 iCal 文件并将其发送给用户 2。
2.  User2 将打开 ics 文件并接受邀请。将在 User2 的 LOCAL Outlook 中创建一个约会项目。

现在，假设由于某种原因取消了约会，那么 User1 必须创建一个 ics 文件并将其发送给 User2，以便 User2 可以从本地 Outlook 取消他的事件。

如何创建这样的ics文件？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-05-12T07:03:24.220

文件的创建方式与原始 ics 文件相同。事件状态会有所不同。UID 将标识事件，序列号将指示更新的优先级，然后将记录事件详细信息（更改或取消）

如果您想在发出邀请后更改/取消事件，则需要通过其 UID 来识别事件/约会，并分配比原始 ics 事件更大的 SEQUENCE 编号。

UID（唯一标识符）：[https ://www.rfc-editor.org/rfc/rfc5545#page-117](https://www.rfc-editor.org/rfc/rfc5545#page-117)

序列：[https ://www.rfc-editor.org/rfc/rfc5545#page-138](https://www.rfc-editor.org/rfc/rfc5545#page-138)

并设置事件状态

```
 / "CANCELLED"    ;Indicates event was cancelled. 
```

状态： [https ://www.rfc-editor.org/rfc/rfc5545#page-92](https://www.rfc-editor.org/rfc/rfc5545#page-92)

哦 - 和方法 如果您需要发送一个事件的取消，UID 应该与原始事件相同，并且组件属性应该设置为取消 Ex。方法：取消状态：取消

当然，如果收件人随后实际单击以将其加载/订阅到与第一次相同的日历应用程序中，这只会“取消”该事件。对于已“订阅”远程 ics 的应用程序 - 当他们下一次执行“更新”时，检查是否应处理更新并覆盖原始事件。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2021-03-22T10:02:15.947

旧线程，但只是想提供我的意见。

Outlook 在取消 ics 上显示“不支持的格式”也有问题。尝试将 METHOD 更改为 REQUEST，某种程度上解决了 Outlook 中的问题，但 Gmail 和其他人处理得不好，看起来像邀请，带有是/否/也许按钮。

经过大量（大量）寻找解决问题后，我终于意识到问题不在 ics 文件中，而是文件如何附加到电子邮件中。我用方法添加它：请求。将其更改为 method:CANCEL 后，它在所有客户端都运行良好。

```
contype = new System.Net.Mime.ContentType("text/calendar");
//contype.Parameters.Add("method", "REQUEST");
contype.Parameters.Add("method", "CANCEL");
contype.Parameters.Add("charSet", "utf-8");
contype.Parameters.Add("name", "invite.ics"); 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2020-03-03T10:45:28.960

使用任何文本文件编辑器（例如[Visual Studio Code](https://code.visualstudio.com/) ）编辑ics 文件中的**所有事件**并再次导入修改日历：

[![在此处输入图像描述](../Images/19a2cd94c55d8528515db8edf99a443c.png)](https://i.stack.imgur.com/toMJw.png)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2020-06-02T08:13:36.237

当我发送包含用于删除事件的 ics 文件的邮件时遇到问题，但在 Outlook 中它显示我不支持格式然后我在网上的某个地方找到了，我发现我只需要将 METHOD: CANCEL 更改为**MEHTHOD: REQUEST**

[![在此处输入图像描述](../Images/008de46df7d1edae81d934d55b477e19.png)](https://i.stack.imgur.com/bOsjx.png)

当我在 Outlook 中导入它时 [![在此处输入图像描述](../Images/ababe9cc1f5981f0e34036c2a67ff10f.png)](https://i.stack.imgur.com/Y2fLx.png)

# sql - 查询中的用户定义变量

> ID：10551771
> 
> 赞同：1
> 
> 时间：2012-05-11T12:54:37.527
> 
> 标签：sql, tsql

我一直在从事一个包含大量汇总统计数据的项目。对我很有帮助的一件事是设置一个变量，该变量集等于出现在每一行的查询结果。就像是

```
declare @totalpop int
set @totalpop = select count(*) as [population]
from myTable

select sex, count(sex), @totalpop
from myTable 
```

忍者编辑我尝试过的查询，但失败了。错误是关键字选择附近的语法不正确

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T12:58:43.127

```
SELECT gender, count(gender) AS countGender, @totalPop AS totalPop 
FROM myTable  
GROUP BY gender 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T13:07:14.127

根据您的最后一段，这似乎是您想要的：

```
SELECT tsum.*, sum(cnt) over (partition by NULL) as TotalPop
FROM (SELECT gender, count(*) as cnt
      FROM t
      GROUP BY gender
     ) tsum 
```

带有“over”子句的表达式是一个将所有窗口相加的窗口函数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-11T12:56:43.547

```
SELECT gender, count(gender), @totalPop
FROM myTable 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-11T13:06:05.687

由于您使用`@`的是变量，我假设您使用的是 Sql Server。以下脚本返回一行，包含 3 列（每个计数一列）。我知道这不完全符合您的要求，但我想这是返回相同信息的一种简单方法：

```
DECLARE @COUNT_TOTAL INT;
DECLARE @COUNT_MALE INT;
DECLARE @COUNT_FEMALE INT;

SELECT @COUNT_TOTAL = COUNT(*)
  @COUNT_MALE = SUM(CASE WHEN gender='MALE' THEN 1 ELSE 0 END),
  @COUNT_FEMALE = SUM(CASE WHEN gender='FEMALE' THEN 1 ELSE 0 END),
FROM myTable;

SELECT @COUNT_TOTAL AS [COUNT_TOTAL]
    , @COUNT_MALE AS [COUNT_MALE]
    , @COUNT_FEMALE AS [COUNT_FEMALE]; 
```

# java - java资源图片不显示

> ID：10551772
> 
> 赞同：3
> 
> 时间：2012-05-11T12:54:42.170
> 
> 标签：java, image, swing, resources, gradle

我一直在尝试让图像资源显示在我正在开发的 GUI 上，但很难让它们显示出来。我遇到过有关加载资源的其他问题，例如[java-swing-displaying-images-from-within-a-jar](https://stackoverflow.com/questions/31127/java-swing-displaying-images-from-within-a-jar)和[images-will-not-work-in-a-jar-file](https://stackoverflow.com/questions/1662686/images-will-not-work-in-a-jar-file)，但它们不起作用为了我。

我的问题似乎与第一个链接相同，从 Eclipse 运行时会出现图像，而使用 Jars 从命令行运行时不会出现图像。但是，这些问题的解决方案不会使图像出现。

我用于检索资源的代码是：

```
public class R {

    public static final String resourcePackage = "path/to/image/package";

    /**
     * Returns the resource string that refers to the <code>resource</code> file
     * in the <code>path.to.image.package.png</code> package.
     * 
     * @param resource
     *            the file in the <code>png</code> package
     * @return the full resource string
     */
    public static String png(String resource) {
        return String.format("%s/png/%s", resourcePackage, resource);
    }

    public static ResizableIcon resizableIcon(String resource) {
        return ImageWrapperResizableIcon.getIcon(R.class.getClassLoader()
            .getResourceAsStream(resource), new Dimension(48, 48));
    }
} 
```

我在生成 GUI 时调用它

```
JCommandButton connect = new JCommandButton(i18ln.getString("ports"),
                R.resizableIcon(R.png("serial-port-32x32.png"))); 
```

打印语句指示已找到资源，因为`R.class.getClassLoader().getResourceAsStream`返回`sun.net.www.protocol.jar.JarURLConnection$JarURLInputStream`.

我难住了。我花了几个小时试图弄清楚这一点，但可以使用一些帮助。有任何想法吗？

*仅供参考：*我认为这并不重要，但我使用[Flamingo](https://github.com/Insubstantial/insubstantial/tree/master/flamingo)作为我的 GUI。

*编辑：*根据 Stefan 的要求

```
源/
    主要的/
        爪哇/
            com.company.project（包）
                R.java
                MyGui.java
        资源/
            com.company.project（包）
                .png（包）
                    串行端口 32x32.png
                    （更多图片）
                .i18ln（包）
                    MyGui.properties

```

至于更多代码，我不知道我还能提供什么对这个问题有很大好处。上面提供了用于检索资源的所有代码以及我如何使用该代码。您是否正在寻找特定的东西？

*更新：*

当我使用 Eclipse 创建一个 Jar 并从命令行运行它时，图像资源会正确显示。当我使用 Gradle 创建 Jar 时，不显示图像。因此，在生成允许通过 Eclipse Jar 而不是 Gradle Jar 正确访问图像资源的 Jar 时，有一些不同的做法。关于这个问题，我[在 Gradle 论坛上提出了一个问题](http://forums.gradle.org/gradle/topics/java_compiler_differences_cause_resources_to_not_be_found_when_jard)。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T14:34:26.577

根据您的应用程序所在的*环境*（*独立*、*应用*服务器），您将需要使用**适当** `ClassLoader`的.

如果你可以有一个实用程序类，`Utils`你可以尝试这样的事情：

```
/* Returns a instance of InputStream for the resource */
public static InputStream getResourceAsStream(String resource) 
                                                   throws FileNotFoundException {
    String stripped = resource.startsWith("/")?resource.substring(1):resource;
    InputStream stream = null;
    ClassLoader classLoader = Thread.currentThread().getContextClassLoader();
    if (classLoader != null) {
        stream = classLoader.getResourceAsStream(stripped);
    }
    if (stream == null) {
        stream = Utils.class.getResourceAsStream(resource);
    }
    if (stream == null) {
        stream = Utils.class.getClassLoader().getResourceAsStream(stripped);
    }
    if (stream == null) {
        throw new FileNotFoundException("Resource not found: " + resource);
    }
    return stream;
} 
```

用来：

```
Utils.getResourceAsStream("com/company/project/png/serial-port-32x32.png"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T14:28:30.730

在这里尝试这个示例[如何将图像加载到您的 ECLIPSE 项目](https://stackoverflow.com/questions/9864267/load-icon-image-exception/9866659#9866659)中。希望这将为您解释，[更多步骤在这里](http://gagandeepbali.uk.to/gaganisonline/webpages/makejareclipse.html)

不要使用 ClassLoader，尽管如此[Java Doc](http://docs.oracle.com/javase/7/docs/technotes/guides/lang/resources.html)中所述，引用它的一段话指出**“所有类加载器都会首先搜索资源作为系统资源，其方式类似于搜索类文件。”**

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-11T15:47:26.607

忘记类加载器，检查路径。如果可行，请使用 getResource io getResourceAsStream （风格问题：更直接，找不到时提供 null ）。

由于 getResource(AsStream) 是基于类的，路径是相对的，所以试试这个：

```
R.class.getResource("/" + resource) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-11T13:11:52.150

创建一个资源包并将此类和您的图像放入其中：

```
public final class Resources {

    public static ImageIcon getImage(String filename) {
        URL resourceUrl = Resources.class.getResource(filename);
        return new ImageIcon(resourceUrl);
    }
} 
```

**编辑：**

我已经用 maven 和 flamingo 重建了你的结构（使用你的 R 类），它适用于这些添加：

改变：

```
R.class.getClassLoader().getResourceAsStream(resource); 
```

至：

```
R.class.getResource("png/"+resource); 
```

我已经使用 maven-assemble-plugin 来构建 jar，如此[处](https://stackoverflow.com/questions/574594/how-can-i-create-an-executable-jar-with-dependencies-using-maven)所述。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-21T10:55:16.050

```
URL imageurl = getClass().getResource("/images/serial-port-32x32.png");//relative path of the image as argument 
Image myPicture = Toolkit.getDefaultToolkit().getImage(imageurl); 
```

使用此 Image 'myPicture' 作为 ImageWrapperResizableIcon.getIcon 方法的第一个参数

# java - .ics 文件中使用的时间格式？

> ID：10551776
> 
> 赞同：8
> 
> 时间：2012-05-11T12:55:08.667
> 
> 标签：java, events, calendar, icalendar

我正在用 Java 创建一个 .ics 文件，我需要知道要使用什么日期和时间格式。

这是我的 ics 文件的当前格式：

```
BEGIN:VCALENDAR
VERSION:2.0
BEGIN:VEVENT
DTSTART:20120901T180000
DTEND:20120901T183000
SUMMARY:my birthday
LOCATION:Bangalore
DESCRIPTION:Every one is welcome..!! time to party
PRIORITY:3
END:VEVENT
END:VCALENDAR 
```

我曾经`ISO_DATETIME_TIME_ZONE_FORMAT`将我的日期转换为所需的格式，但它返回了`2012-09-01T18:00:00+00:00`

`DTSTART`和`DTEND`值中使用的日期格式是什么？具体来说，如何在 Java 中正确格式化？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-11T14:12:00.157

使用 Java，您可以使用

```
DateFormat dateFormat = new SimpleDateFormat("yyyyMMdd'T'HHmmss"); 
```

[在iCalendar RFC 5545](https://www.rfc-editor.org/rfc/rfc5545)中查看更多信息

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T13:08:05.883

您是否对使用第三方库有任何保留可以使这更容易？如果没有，请查看[ICal4j](http://ical4j.sourceforge.net/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-05-29T19:42:42.393

根据 Roger 的回答，我为任何想要快速在线“转换器”的人编写了一个快速代码块。

[https://repl.it/repls/SomeNovelFields](https://repl.it/repls/SomeNovelFields)

编译和运行的代码在这里：

```
import java.text.DateFormat;
import java.util.Date;
import java.text.SimpleDateFormat;

public class HelloWorld{

     public static void main(String []args){
        System.out.println("Hello World");
        DateFormat dateFormat = new SimpleDateFormat("yyyyMMdd'T'HHmmss");

        try {
        Date date = dateFormat.parse("20140110T000732");
                System.out.println(date);

        } catch(Exception e) {

        }
     }
} 
```

# html - Ubuntu 字体在 Firefox 中导致奇怪的选择边框

> ID：10551778
> 
> 赞同：3
> 
> 时间：2012-05-11T12:55:12.410
> 
> 标签：html, css, firefox, fonts, drop-down-menu

我在我的项目中使用来自 Google 字体的 Ubuntu 字体。不幸的是，在使用字体时，Firefox 不显示选择/下拉菜单的右边框。

我创建了一个小提琴，用 Firefox[检查一下。](http://jsfiddle.net/bvencel/WX2xT/5/)

![Firefox 中的边框消失](../Images/fc7d3b00b5a5223704af6b41a13e53b6.png)

相关代码

```
<link 
    href="http://fonts.googleapis.com/css?family=Ubuntu" 
    rel="stylesheet" type="text/css" />

<style>
    input, textarea, select, span
    {
        font-family: 'Ubuntu' , sans-serif !important;
        font-size: 13px;
    }​
</style>

<span>Some text to show that the font is indeed in use</span>
<br />
<select name="testSelect" id="testSelect">
    <option value="1">1</option>
    <option selected="selected" value="2">2</option>
    <option value="3">3</option>
    <option value="4">4</option>
    <option value="5">5</option>
    <option value="6">6</option>
    <option value="7">7</option>
    <option value="8">8</option>
    <option value="9">9</option>
    <option value="10">10</option>
    <option value="11">11</option>
    <option value="12">12</option>
</select>​ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T14:18:31.653

尽管这可能不是您正在寻找的答案，但*总的来说*，我尽量避免`<select>`直接为元素设置样式。一种浏览器与另一种浏览器中“采用”的属性似乎差异很大，因此它似乎永远无法正常工作。例如，我在 Chrome 中检查了您的 jsFiddle，下拉列表完全忽略了您的 Ubuntu 字体声明。这就是 Chrome 滚动的方式。

所以，我的建议是删除样式`select`表中的样式，让浏览器做他们的事情。*这种方法的结果是用户将在他们的浏览器中*获得他们熟悉的下拉菜单。

综上所述，如果你真的需要为下拉菜单设置样式，那么有一些方法可以基本上`<select>`用 javascript 劫持一个元素，然后用一堆 div 替换它。我喜欢为这类事情选择的库[。](http://harvesthq.github.com/chosen/)当它`<div>`在页面上呈现时，您可以根据自己的喜好设置样式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T12:57:53.267

请设置**宽度**选择/下拉菜单。

# android - Android标题视图单独滚动到列表视图

> ID：10551784
> 
> 赞同：0
> 
> 时间：2012-05-11T12:55:20.780
> 
> 标签：android, commonsware-cwac

您好我正在使用合并适配器创建一个列表视图。但我对标题有一些问题。它们似乎独立于列表滚动到通常只是捕捉到页面顶部。我如何得到它以使标题保持在原位？或者没有人会导致这种情况吗？

这是我的代码

```
arrayAdapter = new ArrayAdapter<String>(this, R.layout.single_item, newsList);
arrayAdapter2 = new ArrayAdapter<String>(this, R.layout.single_item, newsList2);
arrayAdapter3 = new ArrayAdapter<String>(this, R.layout.single_item, newsList3);

 RelativeLayout layout = new RelativeLayout(this);
 RelativeLayout.LayoutParams labelLayoutParams = new RelativeLayout.LayoutParams(
            RelativeLayout.LayoutParams.FILL_PARENT, RelativeLayout.LayoutParams.FILL_PARENT);
    layout.setLayoutParams(labelLayoutParams);

    ImageView mImage = new ImageView(this);
    mImage.setBackgroundResource(R.drawable.titlerect);        
    layout.addView(mImage,labelLayoutParams);

    TextView latestFixtures;         
       latestFixtures = new TextView(this);
       latestFixtures.setText("Latest League Fixture");
       layout.addView(mImage,labelLayoutParams);

    ListView list = getListView();
       list.setTextFilterEnabled(true);

setListAdapter (arrayAdapter);

    adapter = new MergeAdapter();
    adapter.addView(layout);
    adapter.addAdapter(arrayAdapter);
    adapter.addView(layout);
    adapter.addAdapter(arrayAdapter2);
    adapter.addView(layout);
    adapter.addAdapter(arrayAdapter3);
    setListAdapter(adapter);

} 
```

代码

```
05-15 13:35:14.489: E/ListView(1045): java.lang.ClassCastException: android.widget.RelativeLayout$LayoutParams
05-15 13:35:14.489: E/ListView(1045):   at android.widget.ListView.setupChild(ListView.java:1834)
05-15 13:35:14.489: E/ListView(1045):   at android.widget.ListView.makeAndAddView(ListView.java:1803)
05-15 13:35:14.489: E/ListView(1045):   at android.widget.ListView.fillDown(ListView.java:670)
05-15 13:35:14.489: E/ListView(1045):   at android.widget.ListView.fillFromTop(ListView.java:727)
05-15 13:35:14.489: E/ListView(1045):   at android.widget.ListView.layoutChildren(ListView.java:1646)
05-15 13:35:14.489: E/ListView(1045):   at android.widget.AbsListView.onLayout(AbsListView.java:1260)
05-15 13:35:14.489: E/ListView(1045):   at android.view.View.layout(View.java:7277)
05-15 13:35:14.489: E/ListView(1045):   at android.widget.LinearLayout.setChildFrame(LinearLayout.java:1254)
05-15 13:35:14.489: E/ListView(1045):   at android.widget.LinearLayout.layoutVertical(LinearLayout.java:1130)
05-15 13:35:14.489: E/ListView(1045):   at android.widget.TableLayout.onLayout(TableLayout.java:440)
05-15 13:35:14.489: E/ListView(1045):   at android.view.View.layout(View.java:7277)
05-15 13:35:14.489: E/ListView(1045):   at android.widget.FrameLayout.onLayout(FrameLayout.java:338)
05-15 13:35:14.489: E/ListView(1045):   at android.view.View.layout(View.java:7277)
05-15 13:35:14.489: E/ListView(1045):   at android.widget.FrameLayout.onLayout(FrameLayout.java:338)
05-15 13:35:14.489: E/ListView(1045):   at android.view.View.layout(View.java:7277)
05-15 13:35:14.489: E/ListView(1045):   at android.view.ViewRoot.performTraversals(ViewRoot.java:1203)
05-15 13:35:14.489: E/ListView(1045):   at android.view.ViewRoot.handleMessage(ViewRoot.java:1957)
05-15 13:35:14.489: E/ListView(1045):   at android.os.Handler.dispatchMessage(Handler.java:99)
05-15 13:35:14.489: E/ListView(1045):   at android.os.Looper.loop(Looper.java:143)
05-15 13:35:14.489: E/ListView(1045):   at android.app.ActivityThread.main(ActivityThread.java:4263)
05-15 13:35:14.489: E/ListView(1045):   at java.lang.reflect.Method.invokeNative(Native Method)
05-15 13:35:14.489: E/ListView(1045):   at java.lang.reflect.Method.invoke(Method.java:507)
05-15 13:35:14.489: E/ListView(1045):   at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
05-15 13:35:14.489: E/ListView(1045):   at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
05-15 13:35:14.489: E/ListView(1045):   at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T16:36:22.113

*要么*使用`MergeAdapter` *要么*使用`addHeaderView()`，而不是两者兼而有之。

# nhibernate - NHibernate - 模式导出

> ID：10551790
> 
> 赞同：1
> 
> 时间：2012-05-11T12:55:30.520
> 
> 标签：nhibernate, fluent-nhibernate

现在我在我的项目中使用 NHibernate + ASP.NET MVC 3。我总是添加一个新的类模型，我需要像这样设置 SchemaExport：

```
Fluently
       .Configure()
       .Database(MsSqlConfiguration.MsSql2008.ConnectionString(connectionString).ShowSql())
       .Mappings(m => m.FluentMappings
           .AddFromAssembly(typeof(Usuario).Assembly)
           .AddFromAssembly(typeof(Empresa).Assembly)
           .AddFromAssembly(typeof(TipoUsuario).Assembly))

       .ExposeConfiguration(config =>
       {
           var schemaExport = new SchemaExport(config);
           schemaExport.Drop(true, true);
           schemaExport.Create(true, true);
       }) 
```

每次 schemaExport 导出一个新模型时，有什么方法可以在几个表中插入一组默认值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T13:02:54.327

虽然没有严格回答您的问题，但我发现使用 NHibernate 生成架构可以快速解决您当前面临的问题类型。因此，我没有使用 NHibernate，而是使用[Fluent Migrator](http://www.github.com/schambers/fluentmigrator)。然后，您可以创建/修改您的模式并将数据添加到基于非常流畅的 API 的模式中，而无需将自己束缚于特定的 SQL 风格。

# java - 在 Akka 中，从 UntypedActor 中访问配置参数的推荐方法是什么

> ID：10551793
> 
> 赞同：17
> 
> 时间：2012-05-11T12:55:44.983
> 
> 标签：java, akka

我有一个`UntypedActor`需要从`application.conf`. 以下行有效，但似乎有点啰嗦。

```
public class FooUntypedActor extends UntypedActor {

    private final long bar = context().system().settings().config().getLong("foo.bar");

    // other stuff

} 
```

这是在 Akka 中获取可配置值的正确方法吗？

我可能应该明确说明我正在使用 Java API。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T15:19:02.127

要么就是这样，要么在它的构造函数中取值，所以你对配置没有硬依赖。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-06-08T19:44:25.287

Akka 文档建议在其中创建`Extension`和放置应用程序特定的设置。[文档](http://doc.akka.io/docs/akka/2.4.7/java/extending-akka.html#Application_specific_settings)中指定了*Akka 2.4.7*的好示例。

# java - 在运行时从文件动态创建类

> ID：10551794
> 
> 赞同：2
> 
> 时间：2012-05-11T12:55:51.083
> 
> 标签：java, class, dynamic

我正在寻找一种在运行时将 Java 代码动态加载到类中的可能性。Java 代码应该从 XML 文件中读取。只有一些“If-Then”表达式，应该添加到一个类中，并像我项目中的任何其他类一样使用它。

实际上我的文件包含一些我想像缓存一样加载的规则代码并进一步使用这个类

有人知道在java中是否可能？

最好的问候
阿比吉

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T13:03:08.823

我相信您可以使用[CGLib](http://sourceforge.net/projects/cglib/)来做到这一点，但我所做的只是在运行时使用它来模拟类。如果动态代码是您的应用程序的主要方面，您应该考虑使用像 Ruby 这样的语言，它对运行时读入的运行代码有更好的支持。

# iphone - iPhone 4s 处理器的可比速度

> ID：10551805
> 
> 赞同：2
> 
> 时间：2012-05-11T12:56:39.117
> 
> 标签：iphone, ios

开发一种最终会进入 iPhone 应用程序的算法。现在在我的 3.4GHz 四核、8 线程英特尔处理器上，算法大约需要 3 秒。有什么方法可以将这些数字与 iPhone 4s 规格相匹配？我读过处理器是 1GHz，但我的感觉是没有苹果对苹果的线性比较。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T13:02:57.757

即使你可以除以 32*3.4，它仍然是苹果到橘子。iPad 使用 ARM 处理器，其架构与您的英特尔处理器非常不同，并且运行在完全不同的操作系统上，使用不同的进程管理技术。恐怕唯一的方法就是在真实设备上运行它并对其进行分析。

# c++ - O(log N) 查找和更新的数据结构，考虑到小型 L1 缓存

> ID：10551808
> 
> 赞同：19
> 
> 时间：2012-05-11T12:56:43.603
> 
> 标签：c++, algorithm, complexity-theory

我目前正在从事一个嵌入式设备项目，我遇到了性能问题。分析找到了一个我想消除的 O(N) 操作。

我基本上有两个数组`int A[N]`和`short B[N]`. 中的条目`A`是唯一的，并由外部约束排序。最常见的操作是检查特定值是否`a`出现在`A[]`. 不太常见但仍然常见的是对 的元素进行更改`A[]`。新值与之前的值无关。

由于最常见的操作是查找，这就是`B[]`出现的地方。它是 中的索引的排序数组`A[]`，因此`A[B[i]] < A[B[j]]`当且仅当`i<j`。这意味着我可以`A`使用二进制搜索找到值。

当然，当我更新时`A[k]`，我必须找到`k`并`B`移动它到一个新的位置，以保持搜索顺序。由于我知道 的新旧值`A[k]`，因此这只是 的新旧位置之间的`memmove()`一个子集。这是我需要修复的 O(N) 操作；由于 的新旧值基本上是随机的，我平均移动大约~~N/2~~ N/3 个元素。`B[]``k``A[k]`

 ~~我研究了`std::make_heap`用作`[](int i, int j) { return A[i] < A[j]; }`谓词。在那种情况下，我可以很容易地`B[0]`指出 的最小元素`A`，并且更新`B`现在是一个廉价的 O(log N) 重新平衡操作。但是，我通常不需要 A 的最小值，我需要查找是否存在任何给定值。现在这是一个 O(N log N) 搜索`B`。（我的 N 个元素中有一半位于堆深度 log N，四分之一位于 (log N)-1 等），这与直接在`A`.

考虑到`std::set`有 O(log N) 的插入和查找，我想说应该有可能在这里获得相同的性能来进行更新和查找。但是我该怎么做呢？我需要另一个订单`B`吗？不同的类型？

`B`目前是`short [N]`因为`A`和`B`一起大约是我的 CPU 缓存的大小，而我的主内存要慢很多。从 6*N 到 8*N 字节不是很好，但如果我的查找和更新都达到 O(log N) 仍然可以接受。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-11T13:17:24.380

如果唯一的操作是 (1) 检查值 'a' 是否属于 A 和 (2) 更新 A 中的值，为什么不使用**哈希表**代替排序数组 B？特别是如果 A 的大小没有增长或缩小并且值只会改变，这将是一个更好的解决方案。哈希表不需要比数组更多的内存。（或者，不应该将 B 更改为堆，而应将其更改为二叉搜索树，这可以是自平衡的，例如 splay 树或红黑树。但是，由于左右-树需要*额外的内存*指针。）

将内存使用量从 6N 增加到 8N 字节的一个实用解决方案是瞄准 50% 填充的哈希表，即使用由 2N 个短数组组成的哈希表。我建议实施**Cuckoo Hashing**机制（请参阅[http://en.wikipedia.org/wiki/Cuckoo_hashing](http://en.wikipedia.org/wiki/Cuckoo_hashing)）。进一步阅读这篇文章，您会发现通过使用更多的散列函数，您可以获得超过 50% 的负载因子（即将内存消耗从 8N 降低到 7N）。"**仅使用三个哈希函数将负载增加到 91%。** "

来自维基百科：

> Zukowski 等人的一项研究。已经表明，对于现代处理器上的**小型缓存驻留哈希表**，布谷鸟哈希比链式哈希要快得多。Kenneth Ross 已经展示了布谷鸟哈希的分桶版本（使用包含多个键的桶的变体）在空间利用率很高的情况下也比传统方法更快地用于大型哈希表。Askitis 进一步研究了桶化杜鹃哈希表的性能，并将其性能与其他哈希方案进行了比较。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T14:14:11.657

`std::set`通常使用二叉搜索树提供*O(log(n))插入和删除。*不幸的是，对于大多数基于指针的实现来说，这使用了 3*N 空间。假设字大小的数据，1 表示数据，2 表示每个节点上左右子节点的指针。

如果你有一些常数 N 并且可以保证它`ceil(log2(N))`小于字长的一半，你可以使用一个固定长度的树节点数组，每个 2*N 大小。使用1表示数据，1表示两个子节点的索引，存储为单词的上半部分和下半部分。这是否会让您以某种方式使用自平衡二叉搜索树取决于您的 N 和字长。对于 16 位系统，您只能得到 N = 256，但对于 32，它是 65k。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T14:10:35.897

既然你的 N 有限，你不能`std::set<short, cmp, pool_allocator> B`和[Boost`pool_allocator`](http://www.boost.org/doc/libs/1_49_0/libs/pool/doc/html/boost_pool/pool/interfaces.html#boost_pool.pool.interfaces.interfaces.pool_allocator)一起使用吗？~~

# jquery - 用 jquery 编写的这条语句的错误是什么？

> ID：10551810
> 
> 赞同：0
> 
> 时间：2012-05-11T12:56:51.193
> 
> 标签：jquery, internet-explorer, syntax-error

我现在正在编写 javascript 代码，其中一条语句是 : `if(($(this).find("option").filter(":selected").length > 0)`。在 Chrome 和 Firefox 上，没问题。但是在 ie8 上，它一直告诉我“语法错误”，有人可以帮我解决这个问题吗？

ps：由于我的粗心，我多写了一个$，我修改了上面的代码。现在问题就在眼前。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T12:58:44.470

你有一个额外的（$

```
if($($(this).find("option").filter(":selected").length > 0) 
```

应该

```
if ( $(this).find("option").filter(":selected").length > 0 ) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T12:58:47.503

> 而不是 $($(this)

利用 `$(this)`

# java - 检查 URL 是否有效或存在于 java 中

> ID：10551813
> 
> 赞同：5
> 
> 时间：2012-05-11T12:57:04.650
> 
> 标签：java, http, url

我正在编写一个 Java 程序，它会访问一个 url 列表，并且需要首先知道该 url 是否存在。我不知道该怎么做，也找不到要使用的 java 代码。

网址是这样的：

```
http: //ip:port/URI?Attribute=x&attribute2=y 
```

这些是我们内部网络上的 URL，如果有效，它们将返回 XML。

谁能建议一些代码？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-11T13:05:45.577

你可以只使用`httpURLConnection`. 如果它无效，您将不会得到任何回报。

```
 HttpURLConnection connection = null;
try{         
    URL myurl = new URL("http://www.myURL.com");        
    connection = (HttpURLConnection) myurl.openConnection(); 
    //Set request to header to reduce load as Subirkumarsao said.       
    connection.setRequestMethod("HEAD");         
    int code = connection.getResponseCode();        
    System.out.println("" + code); 
} catch {
//Handle invalid URL
} 
```

或者你可以像从 CMD 一样 ping 它并记录响应。

```
String myurl = "google.com"
String ping = "ping " + myurl 

try {
    Runtime r = Runtime.getRuntime();
    Process p = r.exec(ping);
    r.exec(ping);    
    BufferedReader in = new BufferedReader(new InputStreamReader(p.getInputStream()));
    String inLine;
    BufferedWriter write = new BufferedWriter(new FileWriter("C:\\myfile.txt"));

    while ((inLine = in.readLine()) != null) {             
            write.write(inLine);   
            write.newLine();
        }
            write.flush();
            write.close();
            in.close();              
     } catch (Exception ex) {
       //Code here for what you want to do with invalid URLs
     } 
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-11T13:02:28.950

1.  格式错误的 url 会给你一个例外。
2.  要知道您的网址是否处于活动状态，您必须点击该网址。没有其他办法。

您可以通过从 url 请求标头来减少负载。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-11T13:39:47.560

```
package com.my;

import java.io.IOException;
import java.io.InputStream;
import java.net.MalformedURLException;
import java.net.URL;
import java.net.UnknownHostException;

public class StrTest {

public static void main(String[] args) throws IOException {

    try {
        URL url = new URL("http://www.yaoo.coi");
        InputStream i = null;

        try {
            i = url.openStream();
        } catch (UnknownHostException ex) {
            System.out.println("THIS URL IS NOT VALID");
        }

        if (i != null) {
            System.out.println("Its working");
        }

    } catch (MalformedURLException e) {
        e.printStackTrace();
           }
      }
  } 
```

输出：此 URL 无效

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-11T12:59:37.710

打开连接并检查响应是否包含有效的 XML？这太明显了还是你在寻找其他魔法？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-11T13:02:27.110

您可能想要使用 HttpURLConnection 并检查错误状态：

[HttpURLConnection javadoc](http://docs.oracle.com/javase/7/docs/api/java/net/HttpURLConnection.html)

# java - 为什么不运行这个java程序？

> ID：10551816
> 
> 赞同：0
> 
> 时间：2012-05-11T12:57:16.120
> 
> 标签：java, regex

我想用程序从[这个 source.txt获取](https://docs.google.com/open?id=0B4bPCqeXhvHcVFNBSnItT016S1E)[这个 imageurl.txt](https://docs.google.com/open?id=0B4bPCqeXhvHcYTR3R3VRY29SNHc)文件。如果我只尝试使用“p”或“p2”，那么就可以了。但是两种模式都写出来，什么都没有。

```
import java.util.regex.Pattern;
import java.util.regex.Matcher;
import java.io.*;

public class imageurl
{
    public static void main(String[] args) 
            throws IOException
    {
    for ( int i = 1; i < 5000; i++ )
        {
        toContent(i);
        Pattern p = Pattern.compile("cacheimages/(.*)[\"][ ]*target=");
        Pattern p2 = Pattern.compile("</b>[ ]*[(](.*)[)]</div>");
        BufferedReader r = new BufferedReader(new FileReader("source\\source"+i+".txt"));
        String line;
        FileWriter writer = new FileWriter("imageurl\\imageurl"+i+".txt");
        while ((line = r.readLine()) != null )
            {
            Matcher m = p.matcher(line);
            Matcher m2 = p2.matcher(line);
            while (m.find())
            while (m2.find())
                {
                String c = (m.group(1));
                String c2 = (m2.group(1));
                System.out.println("<name>"+c2+"</name>_<url>http://www.geocaching.hu/cacheimages/"+c+"</url>"+"\n");
                writer.write("<name>"+c2+"</name>_<url>http://www.geocaching.hu/cacheimages/"+c+"</url>"+"\n");
                }
            }
            writer.close();
        }
    }
    private static void toContent(int i)
    {
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T14:53:53.817

问题是您匹配的两个表达式不会同时存在于同一行。您需要一次阅读两行以获得所需的结果。

```
. . .
String line2;
while ((line = r.readLine()) != null )
    Matcher m=p.matcher(line);
    if (m.find()) {
        if (line2 = r.readLine() != null) {
            Matcher m2=p2.matcher(line);
            if (m2.find()) {
                String c=m.group(1);
                String c2=m2.group(1);
                String outmsg=String.format("<name>%s</name>_<url>http://www.geocaching.hu/cacheimages/%s</url>\n", c2, c);
                System.out.print(outmsg);
                writer.write(outmsg);
            }
        }
        writer.close();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T13:51:34.027

如果你有每`m.find()`一个`m2.find()`，那么如果你只有一个`while`和一个`if`而不是第二个就可以了`while`。

否则，如果你有更多`m2.find()`的，`m.find()`那么你必须检查的位置`m2.find()`是否在两者之间`m.find()`（正确的一个和下一个）。

# c - 为什么 sizeof(void) == 1？

> ID：10551822
> 
> 赞同：12
> 
> 时间：2012-05-11T12:57:38.967
> 
> 标签：c, gcc

> **可能重复：**
> [空隙的大小是多少？](https://stackoverflow.com/questions/1666224/what-is-the-size-of-void)

在 §6.2.5.19 中，先知让我们知道：

> 该`void`类型包含一组空值

`sizeof(void)`那么当 0 似乎就足够时，为什么要产生 1？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-05-11T13:00:15.683

这是一个 gcc 扩展： http: [//gcc.gnu.org/onlinedocs/gcc-4.4.2/gcc/Pointer-Arith.html#Pointer-Arith](http://gcc.gnu.org/onlinedocs/gcc-4.4.2/gcc/Pointer-Arith.html#Pointer-Arith)

> 在 GNU C 中，`void`函数指针和函数指针支持加法和减法运算。这是通过将 a`void`或函数的大小视为 1 来完成的。
> 
> 这样做的结果是在函数类型`sizeof`上和函数类型上也允许这样做`void`，并返回 1。
> 
> `-Wpointer-arith`如果使用这些扩展，该选项会请求警告。

`void`需要大小来执行此类算术的原因是它`ptr - ptr2`实际上并没有给出地址的数字差异，而是两个指针分开的元素数量 - 指向的元素的大小`void *ptr`是`sizeof(*ptr)`which is `sizeof(void)`。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-05-11T13:22:29.993

`sizeof(void)`不会在 C 编译器上编译。

> **ISO 9899:2011 6.2.5/19**
> 
> “void 类型包含一组空值；它是一种无法完成的不完整对象类型。”
> 
> **ISO 9899:2011 6.5.3.4/1**
> 
> “sizeof 运算符不得应用于具有函数类型或不完整类型的表达式”

这是规范文本：sizeof(void) 无效 C.

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-05-11T13:00:54.920

您可能正在使用 gcc 或其他一些将其作为扩展的编译器（在 C 中，sizeof(void) 无效）。

gcc 说：

> 在 GNU C 中，指向 void 的指针和指向函数的指针支持加法和减法运算。这是通过将 void 或函数的大小视为 1 来完成的。
> 
> 这样做的结果是 sizeof 也允许在 void 和函数类型上使用，并返回 1。
> 
> 如果使用这些扩展，选项 -Wpointer-arith 会请求警告。

*   [http://gcc.gnu.org/onlinedocs/gcc-4.4.2/gcc/Pointer-Arith.html#Pointer-Arith](http://gcc.gnu.org/onlinedocs/gcc-4.4.2/gcc/Pointer-Arith.html#Pointer-Arith)

# .net-3.5 - Windows Mobile 6.5 - Process.Start() 上的 TypeLoadException

> ID：10551825
> 
> 赞同：2
> 
> 时间：2012-05-11T12:57:52.970
> 
> 标签：.net-3.5, compact-framework, windows-mobile-6.5, opennetcf, typeloadexception

在解决方案中，我有几个`.exe`文件位于同一目录中。其中之一是主菜单，它查找所有其他可执行文件的路径（在同一目录中）并分配给表单中的按钮。单击按钮时，它的底层 exe 将通过`Process.Start()`.

每个`exe`都包装在单独的安装 CAB 中。初始安装后，我运行主菜单，然后选择任何按钮并成功启动底层应用程序。我退出了它，然后再次运行相同或任何其他应用程序，但这次它崩溃了：

```
TypeLoadException
   at System.Windows.Forms.Control.OnGotFocus(EventArgs e)
   at System.Windows.Forms.Control.WnProc(WM wm, Int32 wParam, Int32 lParam)
   at System.Windows.Forms.Control._InternalWnProc(WM wm, Int32 wParam, Int32 lParam)
   at Microsoft.AGL.Forms.WL.SetFocus(IntPtr hwnFocus)
   at System.Windows.Forms.Control.Focus()
   at myApp.Login..ctor()
   at myApp.Form_UnderApp1.InitializeComponent()
   at myApp.Form_UnderApp1..ctor()
   at myApp.Program.Main() 
```

`myApp.Login``TextBox.Focus()`是一个在其构造函数中的 UserControl 。我试图将其移至“已验证”事件处理程序，但结果是相同的，不同之处在于这次它在`Form.Load()`尝试设置自己的可见性时崩溃。

设备复位后可以重复该循环。最重要的是，如果我直接运行任何子可执行文件，它们就会一直启动并正常工作。

相同的代码集在 WinMo 6.1 上运行良好。我还使用 OpenNETCF 的`Application2`类 - 尝试用标准`Application`类替换它，结果相同。试图设置`Process.StartInfo.WorkingDirectory`，`UseShellExecute`但又没有快乐。在“主菜单”应用程序中查看`Process()`对象时 - 它的行为符合预期（创建进程，返回“真”`.Start()`等）。

GAC 没有安装任何程序集，所有文件都位于同一目录中。

有什么线索吗？

[编辑]

在我收到错误并且设备保持不动大约 10 分钟后，一切都会重新开始：我可以再次运行子应用程序一次等。假设我尝试从主菜单中擦除对当前进程的引用，终止进程，调用`GC.Collect()`没有结果。

[编辑]

到目前为止，加载程序日志看起来还不错（这是应用程序开始失败的地方）：

```
Redirecting [Microsoft.WindowsCE.Forms, Version=2.0.0.0, Culture=neutral, PublicKeyToken=969DB8053D3322AC] to [Microsoft.WindowsCE.Forms, Version=3.5.0.0, Culture=neutral, PublicKeyToken=969DB8053D3322AC]
Loading module [\windows\GAC_Microsoft.WindowsCE.Forms_v3_5_0_0_cneutral_1.dll]
Loaded [Microsoft.WindowsCE.Forms, Version=3.5.0.0, Culture=neutral, PublicKeyToken=969DB8053D3322AC] from [\windows\GAC_Microsoft.WindowsCE.Forms_v3_5_0_0_cneutral_1.dll]
Loading module [\Program Files\MyApp\System.SR.dll]
Attempt to load [\Program Files\MyApp\System.SR.dll] has failed (err 0x80001000).
Loading module [\Program Files\MyApp\System.SR.exe]
Attempt to load [\Program Files\MyApp\System.SR.exe] has failed (err 0x80001000).
Loading module [\windows\System.SR.dll]
Attempt to load [\windows\System.SR.dll] has failed (err 0x80001000).
Loading module [\windows\System.SR.exe]
Attempt to load [\windows\System.SR.exe] has failed (err 0x80001000).
Failed to load [System.SR, Version=3.5.0.0, Culture=neutral, PublicKeyToken=969DB8053D3322AC] 
```

复制`System.SR.dll`到应用安装目录后：

```
Loading module [\windows\en\System.SR.resources.dll]
Attempt to load [\windows\en\System.SR.resources.dll] has failed (err 0x80001001) 
```

已安装`System_SR_ENU.CAB`，`NETCFv2.wm.armv4i.cab`但现在日志显示`ITCScan.DLL`无法加载设备特定的 dll ( ) 之一，我认为这是 .NET 3.5 程序集。据我所知`System.SR`，仅在 .NET2 中使用，难道不是其他一些异常正试图浮出水面并像这样表现出来吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-11-18T16:00:37.710

我有同样的问题，我无法解决它。我不得不寻找另一种方式来调用应用程序。

我所做的是将参数放入表单**B**的构造函数中，然后从**A**调用它。**这些参数与B**应用程序的 .exe 的参数相同。

调用代码：

```
MyAppNameSpace.MyForm _B = new MyAppNameSpace.MyForm(UserID,Date,this);
F.Show(); 
```

构造函数：

```
public MyForm(string _U, DateTime _d, Form _PrevForm)
{
   Form A = _PrevForm;
   string U = _U;
   DateTime d = _d;
   InitializeComponent();
} 
```

App B 在构造函数中有一个额外的参数，即表单 A。我使用该表单来管理 application.exit()。调用该函数将关闭整个系统（APP A 和 B）。而不是你应该使用 A.show();

```
public void BackToAppA()
{
   A.show();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-12T23:50:11.623

我的猜测是您正在运行的第一个可执行文件（称为**Exe A**）仍在运行。

当有人单击菜单上对应于**Exe A**的按钮时，查看所有正在运行的进程以查看它是否已经在运行。如果是这样，只需将**Exe A**拉到前面。

这可能不是您问题的解决方案，但当我阅读您的描述时，这是我想到的第一件事。在 Windows Mobile 下，应用程序不一定会在有人关闭时关闭，除非该应用程序的创建者确保它会关闭。

我希望这有帮助。

# jquery-mobile - 是否可以在列表视图的过滤器栏旁边有一个按钮？

> ID：10551830
> 
> 赞同：1
> 
> 时间：2012-05-11T12:58:09.427
> 
> 标签：jquery-mobile

我有一个列表视图，它是用 data-filter='true' 定义的，它将显示过滤器栏。

在我的列表视图中，每个项目都有一个具有“购买”、“挑选”或“正常”值的类。

我想有一种方法来根据这个类名过滤列表。为此，我正在考虑在过滤器栏旁边有一个按钮，以便用户可以使用它来切换类名以相应地过滤列表。

所以，基本问题是——是否可以在过滤器栏旁边添加一个按钮？

我的其他选择是在标题中添加按钮，这会使标题变得混乱，因为我已经有 2 个其他按钮。

非常感谢任何帮助。

# c# - 如何在 C# 中使用 Routrek Granados 通过 SSH 连接从服务器接收数据

> ID：10551832
> 
> 赞同：1
> 
> 时间：2012-05-11T12:58:14.250
> 
> 标签：c#, ssh, connection, putty

我正在使用 C# 中的 Routrek Granados 库制作一个应用程序，通过 SSH 与我的服务器建立连接。

我几乎做了所有的事情。但没有得到如何从服务器接收响应/数据的方式。

有人知道吗？

请告诉我，我将非常感谢你。

示例代码在这里

```
 var param=new SSHConnectionParameter();
            param.UserName = "username";
            param.Password = "password";
            param.Protocol=SSHProtocol.SSH2;
            param.AuthenticationType=AuthenticationType.Password;
            param.PreferableCipherAlgorithms=new CipherAlgorithm[]{CipherAlgorithm.Blowfish, CipherAlgorithm.TripleDES, CipherAlgorithm.AES128, };
            param.WindowSize = 0x1000;
            var reader = new Reader();
            var sock=new Socket(AddressFamily.InterNetwork,SocketType.Stream, ProtocolType.Tcp);
            sock.Connect(new IPEndPoint(IPAddress.Parse("ip address"),(port number)));
            _conn = SSHConnection.Connect(param, reader, sock);
            reader._conn = _conn;
            SSHChannel ch = _conn.OpenShell(reader);
            reader._pf = ch;
            SSHConnectionInfo info = _conn.ConnectionInfo; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T17:32:41.080

在方法 OnData 上的阅读器类中，您需要将返回的响应设置为公共属性，然后在代码的末尾检查 reader.new 属性。请注意，这都是异步的，因此您可能需要等待我建议使用等待信号。如果需要，我有完整的代码。

# c# - 为什么在将值与常量进行比较之前检查 null？

> ID：10551839
> 
> 赞同：2
> 
> 时间：2012-05-11T12:58:44.333
> 
> 标签：c#

有时，必须检查一个值是否与常量相等。在这种情况下，我总是看到这样的代码：

```
if (!string.IsNullOrEmpty(text))
{
    if (text == "Some text here")¹
    {
        // Do something here.
    }
} 
```

就我而言，我宁愿写：

```
if ("Some text here".Equals(text))
{
    // Do something here.
} 
```

毕竟，如果`text`是`null`，`Equals`将返回`false`，这是意料之中的。常量和变量的反转感觉很奇怪，但是对于初学者来说还是可以理解的，并且避免了`NullReferenceException`which 会被抛出`text.Equals("Some text here")`。

我错过了什么吗？

为什么我看到的所有源代码都使用第一个示例中的语法，而从不使用第二个示例中的语法？

* * *

^(¹ 在实际代码中，它宁愿是常量或只读字段。为了缩短示例，我将字符串内联。)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-11T13:01:55.807

> 在这种情况下，我总是看到这样的代码：

你认为这是奇怪和不必要的，因为它是正确的。这是一张完全多余`null`或空洞的支票。坦率地说，我会在代码审查中告诫这样的代码。

```
if (text == "Some text here") {
    // Do something here.
} 
```

非常好，这就是我要使用的。

> 我错过了什么吗？

不，你没有错过任何东西。

> 为什么我看到的所有源代码都使用第一个示例中的语法，而从不使用第二个示例中的语法？

因为你在所有错误的地方寻找爱情？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-11T13:02:03.210

仅此一点并没有错。

```
if (text == "Some text here")
{
    // Do something here.
} 
```

无需检查 null/empty，因为它无论如何都不相等。

如果您希望使用该`Equals`方法，则有一个对空值不敏感的版本。

```
if (string.Equals(text, "Some text here"))
{
    // Do something here.
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-11T13:03:12.303

只要您有文字或您知道不会有的东西，您的版本就可以了`null`。

另一方面，如果你有

```
if (text1.Equals(text2)) 
```

那么显然你需要防御`text1`存在`null`。

但我会`Equals`在这里停止使用并使用`==`它消除了`null`检查的需要

```
if (text1 == text2) 
```

`Equals`您是否因为您的 Java 根源而更喜欢使用？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-11T13:02:28.693

我认为这是人性，当你比较smth时，你总是将“你的”东西与其他人比较。不是相反，我认为同样的自然想法也适用于 C# 编码:)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-11T13:02:52.360

我只会使用`if (text == "Some text here")`. 它清晰、简洁、快速。您提到的`IsNullOrEmpty`检查可能是（很可能是无用的）微优化。

# maven-3 - 如何使用 maven 从源 jar-s 构建项目依赖项

> ID：10551846
> 
> 赞同：0
> 
> 时间：2012-05-11T12:59:11.070
> 
> 标签：maven-3

我有一个项目，它正在使用 maven 3 构建。在构建项目时，maven 会下载很多依赖项（jar）。我想从 source-jars 构建所有这些依赖项，这些依赖项是从带有 maven 依赖插件的 maven 存储库中获得的。

但是这个源 jars 不包含任何 pom 或其他用于构建的东西。我如何用 Maven 构建它们？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T14:57:12.397

你不能。您需要从项目的源代码库中获取源代码。source-jars 仅用于帮助开发人员调试依赖项。

# tcpdf - TCPDF 中的阴影

> ID：10551847
> 
> 赞同：2
> 
> 时间：2012-05-11T12:59:13.627
> 
> 标签：tcpdf, dropshadow

我相信 TCPDF 中没有本地方法来创建阴影。有什么想法可以用它的任何其他方法创造这样的效果吗？我首先考虑在每个边缘（用于矩形）旁边创建一个小渐变，但发现无法创建具有不同 Alpha 通道的渐变。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-23T09:50:44.490

像这样的东西：

```
class MYPDF extends TCPDF {
    public function addShadow($x,$y,$h,$w){

        for($i=5;$i>=1;$i-=0.5){
            $this->SetAlpha(0.1-($i*0.02));
            $this->SetFillColor(0, 0, 0);
            $this->SetDrawColor(0, 0, 0);
            $this->Rect($x+$i, $y+$i, $h, $w, 'DF');
        }

        $this->SetAlpha(1);
    }
} 
```

# android - 在开关盒功能中正确显示图像？（Android）

> ID：10551848
> 
> 赞同：0
> 
> 时间：2012-05-11T12:59:18.727
> 
> 标签：android

所以我需要根据我的 switch case 功能显示其中一张图像，我真的不知道最好的方法是什么。我真的需要将它们放在一个 xml 文件中，我可以在函数中绘制它们吗？另外，我需要把这个功能放在一个活动中吗？

我可以为您提供我的开关盒功能：

```
public void BloodStatistics(){
        String state;
        int cases=1;
        switch(cases){
        case 1: if(sys<90 && dys<60)
            state="Hypotension";
        break;
        case 2: if(sys>90 && sys<119 && dys>60 && dys<79)
            state="Desriable";
        break;
        case 3: if(sys>120 && sys<139 && dys>80 && dys<89)
            state="Prehypertension";
        break;
        case 4: if(sys>140 && sys<159 && dys>90 && dys<99)
            state="Hypertension Stage 1";
        break;
        case 5: if(sys>160 && sys<179 && dys>100 && dys<109)
            state="Hypertension Stage 2";
        break;
        case 6: if(sys>=180 && dys>=110)
            state="Hypertension Crisis";
        break;
        case 7: if(sys<90 && dys>=60)
            state="Hypotension";
        break;
        default: state="invalid mesurements";
        break;

        }
    } 
```

这些是我的图像：

```
ImageView Hypotension, Desriable, Prehypertension, Hypertension_Stage_1, Hypertension_Stage_2, Hypertension_Crisis; 
```

如果这个问题看起来太简单了，我很抱歉:(

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T13:10:36.843

我会使用一个`ImageView`，然后根据您的条件将图像设置到其中。我也对您的 switch 语句感到有些困惑。据我了解，您只是在检查血压范围，所以我的代码如下：

```
ImageView image = findViewById(R.id.status_image);
int res;

if(sys<90 && dys<60) {
    res = r.drawable.Hypotension;
}
else if(sys>90 && sys<119 && dys>60 && dys<79) {
    res = r.drawable.Desriable;
}
else if(sys>120 && sys<139 && dys>80 && dys<89) {
    res = r.drawable.Prehypertension;
}
else if(sys>140 && sys<159 && dys>90 && dys<99) {
    res = r.drawable.Hypertension_Stage_1;
}
else if(sys>160 && sys<179 && dys>100 && dys<109) {
    res = r.drawable.Hypertension_Stage_2;
}
else if(sys>=180 && dys>=110) {
    res = r.drawable.Hypertension_Crisis;
}
else if(sys<90 && dys>=60) {
    res = r.drawable.Hypotension;
}
else {
    res = 0;
}

if(res != 0) {
    image.setImageDrawable(res);
} 
```

确保将具有您指定名称的图像放入文件夹中（或者，更好的是，`drawable`将每个图像的不同分辨率版本放入`drawable-ldpi`、`drawable-mdpi`和`drawable-hdpi``drawable-xhdpi`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T13:09:55.040

你`switch`没有意义，因为你总是会进入`case 1:`，删除`switch`/`case`东西并`if ... else`只使用它。

```
 String state="invalid mesurements"; // or use the R.id. here and make state int
    if(sys<90 && dys<60)
        state="Hypotension";
    if(sys>90 && sys<119 && dys>60 && dys<79)
        state="Desriable";
    if(sys>120 && sys<139 && dys>80 && dys<89)
        state="Prehypertension";
    if(sys>140 && sys<159 && dys>90 && dys<99)
        state="Hypertension Stage 1";
    if(sys>160 && sys<179 && dys>100 && dys<109)
        state="Hypertension Stage 2";
    if(sys>=180 && dys>=110)
        state="Hypertension Crisis";
    if(sys<90 && dys>=60)
        state="Hypotension"; 
```

小心：如果多个`if`匹配条件`state`将被覆盖，因此将最重要的情况排在最后。

# android - Android 按钮未显示在 SurfaceView 顶部

> ID：10551850
> 
> 赞同：0
> 
> 时间：2012-05-11T12:59:26.707
> 
> 标签：android, android-layout, button, surfaceview

所以在一个 Activity 中，我有一个 SurfaceView 用作绘图画布，还有 2 个布局来提供 UI 功能。有一个 LinearLayout 持有按钮和一个我稍后使用的 RelativeLayout（它从一开始就消失了，后来称为 VISIBLE）。

现在按钮行没有正确显示在屏幕上。纽扣都被洗掉了，好像被困在画布后面一样。我尝试使用以下方法设置 alpha：

```
 button.getBackground().setAlpha(255); 
```

我曾尝试使 SurfaceView 透明，就像[如何使](https://stackoverflow.com/questions/5391089/how-to-make-surfaceview-transparent)SurfaceView 透明一样，但这些都没有奏效。

有趣的是，如果我将按钮的背景设置为#ff000000（如下面的一些按钮所示，一直在测试一些想法），那么它在画布上看起来完全是黑色的，尽管显然它现在已经失去了按钮的形状这不是我想要的！

这是布局：

```
<?xml version="1.0" encoding="utf-8"?>
<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/TopLevelView"
android:layout_width="fill_parent"
android:layout_height="fill_parent">

<!--  Drawing Surface -->
<stu.test.project.DrawingSurface
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:id="@+id/drawingSurface"/>

<!--  Button Row -->
<LinearLayout
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:gravity="center"
        android:id="@+id/ButtonRow">
        <!--  START BUTTON -->
        <Button
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Start"
            android:visibility="gone"
            android:id="@+id/startDrawingButtonId"/>
        <!--  FINISH BUTTON -->
        <Button
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Finish"
            android:visibility="gone"
            android:id="@+id/finishButtonId"/>
        <!--  RESET BUTTON -->
        <Button
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:background="#ff000000"
            android:text="Restart"
            android:visibility="gone"
            android:id="@+id/resetButtonId"/>
        <!--  HOME BUTTON -->
        <Button
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Home"
            android:background="#ff000000"
            android:visibility="gone"
            android:id="@+id/homeButtonId"/>
        <!--  RESTART BUTTON -->
        <Button
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Restart"
            android:background="#ff000000"
            android:visibility="gone"
            android:id="@+id/restartButtonId"/>
        <!--  SAVE BUTTON -->
        <Button
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Save"
            android:background="#ff000000"
            android:visibility="gone"
            android:id="@+id/saveButtonId"/>
        <!--  STATS BUTTON -->
        <Button
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Stats"
            android:visibility="gone"
            android:id="@+id/statsButtonId"/>
        <!--  EMAIL BUTTON -->
        <Button
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Send email"
            android:visibility="gone"
            android:background="#ff000000"
            android:id="@+id/emailButtonId"/>
        <!--  LOAD BUTTON -->
        <Button
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Load another record"
            android:visibility="gone"
            android:background="#ff000000"
            android:id="@+id/loadButtonId"/>
        <!--  MARKS BUTTON -->
        <Button
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Add marks"
            android:visibility="gone"
            android:id="@+id/marksButtonId"/>       
</LinearLayout>

<!--  Here is the Marking Scheme Layout -->
<RelativeLayout
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:visibility="gone"
    android:background="@drawable/marks_background"
    android:id="@+id/marksRelativeLayout">
    <!--  Element Title -->
    <TextView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerHorizontal="true"
        android:id="@+id/markTitle"
        android:padding="10dp"/>
    <!--  Instructions -->
     <TextView
         android:layout_width="wrap_content"
         android:layout_height="wrap_content"
         android:text="Enter the score"
         android:id="@+id/markDescription"
         android:padding="10dp"
         android:layout_centerHorizontal="true"
         android:layout_below="@id/markTitle"/>
     <!--  Previous Button -->
    <Button
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Previous"
        android:id="@+id/previousMarkButton"
        android:layout_below="@id/markDescription"
        android:layout_alignParentLeft="true"
        android:layout_marginLeft="10dp"/>
    <!--  Marking Scheme -->
    <RadioGroup
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:orientation="horizontal"
        android:padding="10dp"
        android:layout_below="@id/markDescription"
        android:layout_toRightOf="@id/previousMarkButton"
        android:id="@+id/marksRadioGroup">
        <RadioButton 
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="0"
            android:id="@+id/radioButton0"/>
        <RadioButton 
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="1"
            android:id="@+id/radioButton1"/>
        <RadioButton 
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="2"
            android:id="@+id/radioButton2"/>
    </RadioGroup>
    <!-- Next Button -->
    <Button
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Next"
        android:id="@+id/nextMarkButton"
        android:layout_below="@id/markDescription"
        android:layout_marginRight="10dp"
        android:layout_toRightOf="@id/marksRadioGroup"/>
    <!--  Done Button -->
    <Button
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Done"
        android:id="@+id/doneMarkButton"
        android:layout_centerHorizontal="true"
        android:layout_marginBottom="10dp"
        android:layout_below="@id/marksRadioGroup"/>
</RelativeLayout>

</FrameLayout> 
```

这是一张图片： ![按钮的显示方式](../Images/92b855ac43691e516f7d6b28c4981c61.png) ![使用具有红色背景的 LinearLayout](../Images/deeb165fcc8c18e8198d37611c05797e.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T14:31:51.800

如果您想要布局顶部的“按钮行”，只需在 LinearLayout 中添加：

```
android:layout_gravity="bottom" 
```

默认情况下，视图添加到 FrameLayout 堆栈。

看到您的布局，我也注意到所有按钮都可以看到 GONE。要检查该行是否位于 surfaceView 的顶部，请向 Button 行 LinearLayout 添加背景。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T17:30:03.723

您的问题与 Android 3.0+ 上 Holo 主题中使用的默认图像有关；看看[这个链接](https://github.com/android/platform_frameworks_base/blob/master/core/res/res/drawable-hdpi/btn_default_normal_holo.9.png)，这是该主题中用于默认按钮的实际 9-patch。请注意 PNG 本身是如何部分透明的？这意味着无论您在其下方放置什么颜色，它都会通过其背景部分显示。它旨在用于该主题中存在的深色背景的顶部。

Holo 主题中的所有按钮都是部分透明的，甚至 Holo.Light 中的按钮也是如此，因此您可以使用任何默认按钮背景获得这种效果。因为透明度在背景图像中，所以设置 alpha`Drawable`不会有任何效果。正如您已经发现的那样，您可以将按钮背景设置为纯色，这不再是问题。

如果您想要一个仍然保持 Holo 外观的纯色按钮，我建议从我提供的链接源中提取 PNG 图像，并修改 9-patches 以具有完全纯色的底层。

高温高压

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-26T04:08:41.713

SurfaceView.setZOrderOnTop(false);希望对你有帮助

# asp.net-mvc-3 - 在mvc3中传递多个参数

> ID：10551851
> 
> 赞同：1
> 
> 时间：2012-05-11T12:59:27.767
> 
> 标签：asp.net-mvc-3, url

我有一个需要 3 个参数的控制器

```
public ActionResult Directives(string MachineName, int ProjectId, int CompanyId) 
```

现在 URL 看起来像这样。

```
/Project/Directives?projectId=41&MachineName=Apple%20Macbook%20Luft 
```

但是我如何让它看起来像这样。

```
/Project/Directives/41/AppleMacbookAir/ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T13:06:11.780

尝试自定义路线：

```
routes.MapRoute(
     "Project",                                              // Route name
     "{Controller}/{Action}/{projectId}/{machineName}/{companyId}",                           
     new { controller = "Project", action = "Directives", projectId = 0, machineName = "", companyId = 0 }  // Parameter defaults
); 
```

[http://www.asp.net/mvc/tutorials/controllers-and-routing/creating-custom-routes-cs](http://www.asp.net/mvc/tutorials/controllers-and-routing/creating-custom-routes-cs)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T13:05:57.107

您可以将 id 作为`RedirectToAction()`方法的 routeValues 参数的一部分传递。

```
return RedirectToAction("Action", new { id = 99 }); 
```

这将导致重定向到`Site/Controller/Action/99.`

**编辑：** 要自定义 url，您必须创建`custom route`为：

```
routes.MapRoute(  "Project", // Route name
                   "{controller}/{Action}/{ProjectId}/{MachineName}/{CompanyId}", 
                   new { controller = "Project", 
                         action = "Directives", 
                         ProjectId= 0,
                         MachineName= "",
                         CompanyId = 0 
                       }  // Parameter defaults ); 
```

`UrlParameter.Optional`如果您想要任何参数可选，请使用。跟随 Stephen Walthe 关于[ASP.NET MVC 路由的文章](http://www.asp.net/mvc/tutorials/older-versions/controllers-and-routing/asp-net-mvc-routing-overview-cs)

请参考：[带参数的 RedirectToAction](https://stackoverflow.com/questions/1257482/redirecttoaction-with-parameter/1257632#1257632)

# java - AWS us-east 中基于 Java 的应用程序的托管消息队列？

> ID：10551852
> 
> 赞同：6
> 
> 时间：2012-05-11T12:59:34.437
> 
> 标签：java, amazon-web-services, message-queue, publish-subscribe, paas

我正在寻找**作为服务的消息队列**..

*   .. 托管在 AWS us-east
*   .. 提供真正的 PubSub（不是轮询！）
*   .. 可用于生产
*   .. 提供高可用性
*   .. 有一个很好的 Java 客户端

我只找到[了 CloudAMQP](http://www.cloudamqp.com/)（仍处于测试阶段）、[AppEngine 任务队列](https://developers.google.com/appengine/docs/java/taskqueue/overview)（不是 AWS）、SQS（仅轮询）、[Redis To Go](http://redistogo.com/)（没有高可用性？-twitter 流似乎充满了问题）和[IronMQ](http://www.iron.io/products/mq)（仅轮询）。

我错过了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-12T06:18:53.820

您应该检查一种可用的开放式 PaaS（例如 Cloudify、OpenShift 或 Cloudfoundry），使用此类 PaaS 可以轻松地使用大多数服务和大多数流行的消息队列，例如 ActiveMQ、RabitMQ 或 SonicMQ。

[Cloudify](http://www.cloudifysource.org) （我是它的贡献者之一）是开源和免费的，可以在任何云上加入你想要的任何消息队列。您可以轻松地使用 ActiveMQ、RabitMQ、SonicMQ 或您曾经在云端使用的其他服务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T07:22:06.723

看起来[Iron.io](http://www.iron.io/)已经添加了 pub/sub。也许它现在适合您的需求？此外，它似乎在谈论 beanstalkd，因此您可能会在未来的某个时候轻松地迁移到自托管解决方案（如果您有这种冲动！）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T12:46:29.767

您是否尝试过纯消息传递解决方案？ [http://www.pubnub.com/faq](http://www.pubnub.com/faq) 或[http://pusher.com](http://pusher.com)？根据他们的网站，他们在 EC2 上有存在。

# zend-form - Zend_Form 默认复选框问题

> ID：10551855
> 
> 赞同：1
> 
> 时间：2012-05-11T12:59:48.827
> 
> 标签：zend-form, zend-form-element

绞尽脑汁，我浏览了 zend 文档并爬了谷歌，但找不到解决方案。我有一个使用 Zend_Form 的表单，在初始页面加载时，我需要默认选中与我联系的复选框。

我有下面的代码，我被告知它应该可以工作，但不适合我。有人有这方面的经验吗？

```
 $contactme = new Zend_Form_Element_Checkbox('contactme','checked');
    $contactme->setLabel("Please untick box if you don't want to be updated with offers.")
             ->setAttrib('checked','checked')
             ->setCheckedValue(1)
             ->setUncheckedValue(0)
             ->setValue(1); 
```

干杯

约翰

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T13:06:06.607

```
$form->addElement('checkbox', 'paid', array('value' => true/false)); 
```

是我这样做的方式。您也可以在数组中设置所有其他属性。

# php - 来自其他两个数组的新数组，具有一个公共键。有什么优化技巧吗？

> ID：10551858
> 
> 赞同：3
> 
> 时间：2012-05-11T13:00:05.280
> 
> 标签：php, arrays, optimization, multidimensional-array, php-5.2

所以这就是我正在做的事情，我有一个包含客户的数组和一个包含订单的数组，所以我正在从这两个数据中创建一个新数组......这是一些代码：

客户阵列：

```
Array
(
    [0] => Array
        (
            [customerid] => 1234
            [name] => John Doe
            [email] => john@doe.com
        )

    [1] => Array
        (
            [customerid] => 4321
            [name] => Jane Smith
            [email] => jane@smith.com
        )

    (etc...)
) 
```

订单数组：

```
Array
(
    [0] => Array
        (
            [customerid] => 1234
            [amount] => 100.00
            [date] => 2012-05-11
        )

    [1] => Array
        (
            [customerid] => 4321
            [amount] => 200.00
            [date] => 2012-03-01
        )

    [2] => Array
        (
            [customerid] => 4321
            [amount] => 500.00
            [date] => 2012-02-22
        )

    (etc...)
) 
```

最终数组：

```
Array
(
    [1234] => Array
        (
            [name] => John Doe
            [email] => john@doe.com
            [orders] => Array
                (
                    [0] => Array
                        (
                            [amount] => 100.00
                            [date] => 2012-05-11
                        )

                )

        )

    [4321] => Array
        (
            [name] => Jane Smith
            [email] => jane@smith.com
            [orders] => Array
                (
                    [0] => Array
                        (
                            [amount] => 200.00
                            [date] => 2012-03-01
                        )
                    [1] => Array
                        (
                            [amount] => 500.00
                            [date] => 2012-02-22
                        )

                )

        )

    (etc...)
) 
```

所以......这是我想到的PHP代码：

```
$customers = array(blah...); # See above...
$orders    = array(blah...); # See above...
$new_array = array();

foreach ($customers as $c) {
  $new_array[$c['customerid']] = array(
    'name'   => $c['name'],
    'email'  => $c['email'],
    'orders' => array()
  );
}

foreach ($orders as $o) {
  $new_array[$o['customerid']]['orders'][] = array(
    'amount' => $o['amount'],
    'date'   => $o['date']
  );
} 
```

终于，我们来到了这篇文章的主题！你们中的任何人有任何以任何方式优化它的技巧吗？或者一开始就在正确的轨道上...不过那也很好...无论如何，即使我选择不遵循它们，任何提示都将受到赞赏...在此先感谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T13:05:19.753

正如我在评论中所说，它看起来不错。不过，您可以做的一件事来缩短您的代码，即在创建新数组时不要再次提及所有字段，如果您最终有很多字段，这可以为您节省相当多的打字时间。

例如，而不是：

```
foreach ($customers as $c) {
  $new_array[$c['customerid']] = array(
    'name'   => $c['name'],
    'email'  => $c['email'],
    'orders' => array()
  );
} 
```

你可以这样做：

```
foreach ($customers as $c) {
  $new_array[$c['customerid']] = $c;
  $new_array[$c['customerid']]['orders'] = array();
} 
```

通常没有理由过早地优化代码，只要让它工作并在需要时对其进行优化（当然，对什么是好的和什么是坏的有很好的基础知识将帮助您首先编写高质量的代码）。

**编辑**

如果您真的只是对如何使其更快感到好奇，那么有办法做到这一点。例如，如果您在创建新数组后不需要关心原始的两个数组，则可以稍微更改代码以删除所有不必要的数组副本。PHP 有一个内部引用计数机制，数组的副本不是在赋值时创建的，而只是在您稍后实际修改数组时（这称为写时复制）。例如：

```
foreach ($customers as $c) {
  $new_array[$c['customerid']] = $c; // $c is not yet actually copied here, PHP just creates an internal reference to $c
  $new_array[$c['customerid']]['orders'] = array(); // this is what copies the underlying array, as it is now modified
} 
```

请记住这一点，如果您不在乎原始数组`$customers`和`$orders`数组在生成后保持不变`$new_array`，您可以简单地修改原始数组以防止不必要的复制：

```
// iterate through the array by reference
foreach ($customers as &$c) {
  $c['orders'] = array(); // modifies the original $customers array
  $new_array[$c['customerid']] = $c;
}

// clean up the reference, to prevent accidents later on
unset($c);

// there's no need to use a reference here, as PHP's internal refcounting mechanism will kick in
foreach ($orders as $o) {
  $new_array[$o['customerid']]['orders'][] = $o;
}

// finally if you don't need the original arrays anymore, clean up after them
// this also means that modifying $new_orders afterwards will not create a copy
// of anything, as $new_orders is the only array keeping internal references
// to the customers and orders
unset($customers, $orders); 
```

但是我再次重申，真的没有必要像这样过早地优化。更喜欢干净、可读的代码，并且只在必要时进行优化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T13:01:52.020

看起来对我来说是正确的，虽然我不是 PHP 专家。不能优化更多。另外，我会小心过早的优化。在你四处尝试加快速度之前让你的代码完全运行——它会在未来为你节省一个痛苦的世界。

# vim - 如何在 Vim 中增加/减少字符的非字母数字 ASCII 值？

> ID：10551866
> 
> 赞同：5
> 
> 时间：2012-05-11T13:00:31.833
> 
> 标签：vim, ascii

我想增加几行字符的 ASCII 值。它们中的大多数不是字母数字的，否则我可以简单地[`:set nrformats+=alpha`用来制作`CTRL-A`和`CTRL-X`处理它们](http://vim.wikia.com/wiki/Increasing_or_decreasing_numbers)。是否有任何本地 Vim 方式来增加和减少 ASCII 值，或者我需要编写脚本吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T14:01:28.487

```
:help nr2char
:help char2nr 
```

例子：

```
:%s/./\=nr2char(char2nr(submatch(0))+1)/g 
```

# php - 仅当 strlen() > 0 时设置密码 - Symfony 1.4

> ID：10551869
> 
> 赞同：0
> 
> 时间：2012-05-11T13:00:36.650
> 
> 标签：php, security, symfony1, symfony-1.4

我有简单的类：

```
User:
  id | login | password | desc 
```

并以此形成。

我该怎么做 - 如果输入密码为空（strlen == 0），那么在模型中并不重要。

现在我在 User.class.php 中保存了函数：

```
$this->setPassword(sha512($this->getPassword)); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-13T09:57:13.790

您必须确保在 DB 级别上没有“NOT NULL”，因此 ORM 通常会忽略空值。

通过自定义函数更改给定密码有 2 种可能性，因此我将给您一些简单的示例。

1）在你的模型文件中（我猜你有教义或推进？！）：

```
 /**
 * via object's event handler
 */
 preSave(){
    if(strlen($this->getPassword()) > 0){
        $this->setPassword(sha512($this->getPassword()));
    }
 } 
```

2）甚至作为表单验证器：

```
/**
 * custom validator
 */
class myValidatorOldPassword extends sfValidatorBase{

    /**
     * Clean and validate user input
     *
     * @param mixed $value Value of form input
     * @return mixed Value 
     */
     protected function doClean($value)
     {
        // trim is not needed
        $clean = (string) $value;

        // password is ok?
        if (strlen($clean) > 0)
        {
            return sha512($clean);
        }

        // Throw error - if you want
        // throw new sfValidatorError($this, 'invalid', array('value' => $value)); 

        // or return empty value
        return $clean;
    }

} 
```

当然，此代码可能会有所改进，因为它只是对您的提示。

# pdf - 从 pdf 索引数据

> ID：10551872
> 
> 赞同：0
> 
> 时间：2012-05-11T13:00:43.787
> 
> 标签：pdf, solr, indexing

我现在正在尝试从 pdf 索引数据，并且我从 Solr 得到以下响应：

```
<response>
<lst name="responseHeader">
<int name="status">0</int>
<int name="QTime">1</int>
</lst>
<lst name="initArgs">
<lst name="defaults">
<str name="config">data-config.xml</str>
</lst>
</lst>
<str name="command">full-import</str>
<str name="status">idle</str>
<str name="importResponse"/>
<lst name="statusMessages">
<str name="Time Elapsed">0:0:1.236</str>
<str name="Total Requests made to DataSource">0</str>
<str name="Total Rows Fetched">1</str>
<str name="Total Documents Processed">0</str>
<str name="Total Documents Skipped">0</str>
<str name="Full Dump Started">2012-05-11 15:45:01</str>
<str name="">Indexing failed. Rolled back all changes.</str>
<str name="Rolledback">2012-05-11 15:45:01</str></lst><str name="WARNING">This response format is experimental.  It is likely to change in the future.</str>
</response> 
```

**显示此的日志文件：**

```
org.apache.solr.common.SolrException log
SEVERE: Full Import failed:java.lang.RuntimeException: java.lang.RuntimeException: org.apache.solr.handler.dataimport.DataImportHandlerException: java.lang.NoClassDefFoundError: org/apache/tika/parser/AutoDetectParser
    at org.apache.solr.handler.dataimport.DocBuilder.execute(DocBuilder.java:264)
    at org.apache.solr.handler.dataimport.DataImporter.doFullImport(DataImporter.java:375)
    at org.apache.solr.handler.dataimport.DataImporter.runCmd(DataImporter.java:445)
    at org.apache.solr.handler.dataimport.DataImporter$1.run(DataImporter.java:426)
Caused by: java.lang.RuntimeException: org.apache.solr.handler.dataimport.DataImportHandlerException: java.lang.NoClassDefFoundError: org/apache/tika/parser/AutoDetectParser
    at org.apache.solr.handler.dataimport.DocBuilder.buildDocument(DocBuilder.java:621)
    at org.apache.solr.handler.dataimport.DocBuilder.doFullDump(DocBuilder.java:327)
    at org.apache.solr.handler.dataimport.DocBuilder.execute(DocBuilder.java:225)
    ... 3 more
Caused by: org.apache.solr.handler.dataimport.DataImportHandlerException: java.lang.NoClassDefFoundError: org/apache/tika/parser/AutoDetectParser
    at org.apache.solr.handler.dataimport.DocBuilder.buildDocument(DocBuilder.java:759)
    at org.apache.solr.handler.dataimport.DocBuilder.buildDocument(DocBuilder.java:619)
    ... 5 more
Caused by: java.lang.NoClassDefFoundError: org/apache/tika/parser/AutoDetectParser
    at java.lang.Class.forName0(Native Method)
    at java.lang.Class.forName(Unknown Source)
    at org.apache.solr.core.SolrResourceLoader.findClass(SolrResourceLoader.java:388)
    at org.apache.solr.handler.dataimport.DocBuilder.loadClass(DocBuilder.java:1100)
    at org.apache.solr.handler.dataimport.DocBuilder.getEntityProcessor(DocBuilder.java:912)
    at org.apache.solr.handler.dataimport.DocBuilder.buildDocument(DocBuilder.java:635)
    at org.apache.solr.handler.dataimport.DocBuilder.buildDocument(DocBuilder.java:709)
    ... 6 more
Caused by: java.lang.ClassNotFoundException: org.apache.tika.parser.AutoDetectParser
    at java.net.URLClassLoader$1.run(Unknown Source)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(Unknown Source)
    at java.lang.ClassLoader.loadClass(Unknown Source)
    at java.net.FactoryURLClassLoader.loadClass(Unknown Source)
    at java.lang.ClassLoader.loadClass(Unknown Source)
    ... 13 more 
```

配置文件如下所示： **data-config.xml：**

```
<?xml version="1.0" encoding="utf-8"?>

<dataConfig>
<dataSource type="BinFileDataSource" name="binary" />
    <document>
        <entity name="f" dataSource="binary" rootEntity="false" processor="FileListEntityProcessor" baseDir="C:\solr\solr\docu" fileName=".*pdf" recursive="true">
            <entity name="tika" processor="TikaEntityProcessor" url="${f.fileAbsolutePath}" format="text">
                <field column="id" name="id" meta="true" />
                <field column="fake_id" name="fake_id" />
                <field column="model" name="model" meta="true" />
                <field column="text" name="biog" />
            </entity>
        </entity>
    </document>

</dataConfig> 
```

**架构.xml：**

```
<fields>
<field  name="id" type="string" indexed="true" stored="true" /> 
  <field  name="fake_id" type="string" indexed="true" stored="true" /> 
  <field  name="model" type="text_en" indexed="true" stored="true"  />
  <field  name="firstname" type="text_en" indexed="true" stored="true"/>
  <field  name="lastname" type="text_en" indexed="true" stored="true"/>
  <field  name="title" type="text_en" indexed="true" stored="true"/>
  <field  name="biog" type="text_en" indexed="true" stored="true"/>
  </fields>
<uniqueKey>fake_id</uniqueKey>
<defaultSearchField>biog</defaultSearchField> 
```

最后，我拥有的“Tika”罐子是：

tika-core-1.0.jar 和 tika-parsers-1.0.jar

出了什么问题？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T14:31:06.367

问题可能出在您的 data-config.xml 中，您在名为“f”的实体（带有 FileListEntityProcessor 处理器）上指定了 bin 文件 dataSource，而不是带有 TikaEntityProcessor 处理器的实体。我认为您可以尝试使用以下代码：

```
<?xml version="1.0" encoding="utf-8"?>
<dataConfig>
<dataSource type="BinFileDataSource" name="binary" />
    <document>
        <entity name="f" dataSource="null" rootEntity="false" processor="FileListEntityProcessor" baseDir="C:\solr\solr\docu" fileName=".*pdf" recursive="true">
            <entity name="tika" dataSource="binary" processor="TikaEntityProcessor" url="${f.fileAbsolutePath}" format="text">
                <field column="id" name="id" meta="true" />
                <field column="fake_id" name="fake_id" />
                <field column="model" name="model" meta="true" />
                <field column="text" name="biog" />
            </entity>
        </entity>
    </document>
</dataConfig> 
```

# java - Java转置密码加密/解密

> ID：10551877
> 
> 赞同：1
> 
> 时间：2012-05-11T13:01:13.663
> 
> 标签：java, encryption

我正试图让我的转置密码工作。

每当我将加密方法得到的密文输入解密方法时，我都应该取回原始的明文……但事实并非如此……

我究竟做错了什么？

谢谢您的帮助！

```
public String EncryptTranspositionCipher(){
    String outputstring = "";

    for(int j=0;j<key;j++){
       for(int i=j;i<plainText.length();i+=key){
           outputstring += plainText.charAt(i);
       }
    }
    return outputstring;
 }
 public String DecryptTranspositionCipher(){
      String outputstring = "";
      int stepforDec=0;
      stepforDec= plainText.length() / key;
      for(int j=0;j<stepforDec;j++){
         for(int i=j;i<plainText.length();i+=stepforDec){
             outputstring += plainText.charAt(i);
         }
      }
      return output string; } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T20:09:10.690

看你的`DecryptTranspositionCipher()`方法。它在哪里找到你想要它解码的密文？也许您可以通过以下方式做得更好：

```
 public String DecryptTranspositionCipher(String cyphertext){ ... } 
```

# javascript - 单击 OpenLayers 中的 GML 轨道

> ID：10551879
> 
> 赞同：0
> 
> 时间：2012-05-11T13:01:37.593
> 
> 标签：javascript, events, openlayers

如何在 Open Layers 中捕获 GML 轨道上的点击事件？

我有以下代码：

```
var gmlTrack = new OpenLayers.Layer.GML("Track", myGpxUrl, {
    format: OpenLayers.Format.GPX,
    projection: new OpenLayers.Projection("EPSG:4326")
}); 
```

我认为解决方案是添加以下几行：

```
gmlTrack.events.register("click", gmlTrack, function(e){
    alert("Click on GPX track!");
}); 
```

但它不起作用。

明确一点：我只希望在用户点击 GPX 轨道时触发点击事件。

我做错了什么，我该如何解决？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T08:43:53.790

您可以使用选择功能控件来实现您正在寻找的东西（这使 OpenLayers 知道如何处理事件）

```
 selectControl = new OpenLayers.Control.SelectFeature(
        [gmlTrack],
        {
            clickout: true, toggle: false,
            multiple: false, hover: false,
            onSelect: trackSelected
        }
    );

    map.addControl(selectControl);
    selectControl.activate(); 
```

并包括一些用于 trackSelected 的处理程序，例如

```
function trackSelected(feature){
    alert("something here");  
} 
```

这是一个有用的[OpenLayers 示例](http://openlayers.org/dev/examples/select-feature-multilayer.html)

# php - 想要 从 textarea 中获取标签，尽管根本没有其他 HTML

> ID：10551885
> 
> 赞同：-1
> 
> 时间：2012-05-11T13:01:56.500
> 
> 标签：php, javascript, html, css, textarea

我正在做一个网络构建器，我遇到了一些麻烦。

我想要一个文本区域，你可以在 TEXT 元素中输入你想要的文本。这个元素我在稍后通过简单地在发布预览之前放置一个 .innerText 进行预览时禁用了 HTML。不过，我可能只需要`<br>`标签。

我可以使用 PHP 或 JS。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T13:09:41.623

`nl2br(htmlspecialchars($str))`显示文本时使用。请注意，函数调用的顺序很重要——首先将字符串中的所有 HTML 转义，然后将换行符转换为 HTML 换行符。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T13:21:40.233

当您在文本区域中输入并按下返回键时，

幕后实际发生的事情是这样的

> 你好，\n那里

它在 textarea 中产生以下内容。

> 你好
> 
> 那里

因此，您需要做的基本上是更改 \n （换行符）以中断标签。

[http://php.net/manual/en/function.nl2br.php](http://php.net/manual/en/function.nl2br.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T13:08:11.793

只需使用纯文本区域，在 html 页面中显示后使用[nl2br之类的功能](http://php.net/manual/en/function.nl2br.php)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-11T13:11:51.177

```
nl2br(htmlspecialchars($string)) 
```

将换行符更改为`<br />`标签，因此您可以在 html 中显示它们，如 textarea 中所示。

# jsf-2 - 当 URL 中没有参数时，将 f:viewParam 属性设置为 null

> ID：10551888
> 
> 赞同：5
> 
> 时间：2012-05-11T13:02:10.150
> 
> 标签：jsf-2, viewparams

假设我们有一个接受一个参数的简单页面：

```
<f:viewParam name="name" value="#{bean.name}"/> 
```

当用户转到 时`http://localhost/myapp/?name=Joe`，则`#{bean.name}`设置为`Joe`。然后，如果用户转到`http://localhost/myapp/`or `http://localhost/myapp/?something=Else`，则`#{bean.name}`仍设置为`Joe`，但我希望它是`null`。如何做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T13:26:49.587

对其保存的数据使用正确的托管 bean 范围。您显然已将其放在会话范围内。将持有参数的 bean 放在请求或视图范围而不是会话范围中，并且在使用视图范围时，请确保在执行操作时通过普通链接或重定向后获取进行导航。

### 也可以看看：

*   [如何选择合适的bean范围？](https://stackoverflow.com/questions/7031885/how-to-choose-the-right-bean-scope/7031941#7031941)

# c# - 应用命名空间时，使用 XElement 生成的 KML 已损坏

> ID：10551896
> 
> 赞同：1
> 
> 时间：2012-05-11T13:02:41.143
> 
> 标签：c#, kml, xelement

我正在开展一个项目，以从我们的交付数据库中生成一些 KML 数据。

我很高兴使用 LINQ 构建 KML 结构，但似乎当命名空间属性应用于节点时，我无法将数据输出到字符串。

这是我用来生成 KML 的代码：

```
// Create a new XDocument object
_xDoc = new XDocument(new XDeclaration("1.0", "UTF-8", "yes"));

// Build internal kml document node
XElement document = CreateKmlDocumentNode();

if (document != null)
{
    // Add data points to the kml document node
    foreach (KmlData delivery in _deliveryData)
    {
        document.Add( CreatePlacemark(delivery) );
    }
}

// Add the document node to the kml node
XElement kml = new XElement("kml",
                            document);

// ** Comment out this line and the output is generated **
kml.Add( new XAttribute("xmlns", @"http://earth.google.com/kml/2.2"));

// And finally add the kml node to the XDocument
_xDoc.Add( kml ); 
```

这是我用来生成字符串的代码：

```
string output;

using (var stringWriter = new StringWriter())
{
    XmlWriterSettings xws = new XmlWriterSettings();
    xws.NamespaceHandling = NamespaceHandling.OmitDuplicates;
    xws.Indent = true;

    using (var xmlTextWriter = XmlWriter.Create(stringWriter, xws))
    {
        // The Line below throws the exception when the namespace attribute is added
        _xDoc.WriteTo(xmlTextWriter);

        xmlTextWriter.Flush();
        output = stringWriter.GetStringBuilder().ToString();
    }
}
return output; 
```

生成的异常文本：

**{“前缀 '' 不能在同一个起始元素标记中从 '' 重新定义为 'http://earth.google.com/kml/2.2'。”}**

这是我希望数据看起来像的示例：

```
<?xml version="1.0" encoding="UTF-8"?>
<kml xmlns="http://earth.google.com/kml/2.2">
  <Document>
    <name>Sample</name>
    <description><![CDATA[]]></description>

    <Style id="depot">
      <IconStyle>
        <Icon>
          <href>http://maps.gstatic.com/mapfiles/ms2/micons/rangerstation.png</href>
        </Icon>
      </IconStyle>
    </Style>
    <Style id="pickupIcon">
      <IconStyle>
        <Icon>
          <href>http://maps.gstatic.com/mapfiles/ms2/micons/truck.png</href>
        </Icon>
      </IconStyle>
    </Style>
    <Style id="letterIcon">
      <IconStyle>
        <Icon>
          <href>http://maps.gstatic.com/mapfiles/ms2/micons/postoffice-us.png</href>
        </Icon>
      </IconStyle>
    </Style>
    <Placemark>
      <name>Chester Depot</name>
      <description><![CDATA[]]></description>
      <styleUrl>#depot</styleUrl>
      <Point>
        <coordinates>-2.881701,53.197021,0.000000</coordinates>
      </Point>
    </Placemark>
    <Placemark>
      <name>15 Hankelow Close</name>
      <description><![CDATA[<div><b><font size="4">Delivery Successful - 10:14am</font></b></div><div style="font-size:10pt"><b>Contact </b>Sam Spade</div><b style="font-size:10pt">Address </b><font size="2">15 Hankelow Close, Chester, Cheshire West and Chester CH2 2DZ, UK]]></description>
      <styleUrl>#letterIcon</styleUrl>
      <Point>
        <coordinates>-2.889466,53.199226,0.000000</coordinates>
      </Point>
    </Placemark>
    <Placemark>
      <name>45 Victoria Rd</name>
      <description><![CDATA[<div><b><font size="4">Pickup Successful - 1:24pm</font></b></div><div style="font-size:10pt"><b>Contact </b>Sam Spade</div><b style="font-size:10pt">Address </b><font size="2">Chester, Cheshire West and Chester CH2 2AX, UK]]></description>
      <styleUrl>#pickupIcon</styleUrl>
      <Point>
        <coordinates>-2.892855,53.198498,0.000000</coordinates>
      </Point>
    </Placemark>
  </Document>
</kml> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-20T08:48:41.237

我通过使用[SharpKML](http://sharpkml.codeplex.com/)库而不是从头开始构建 KML 解决了这个问题。

# iphone - iphone中的自动滚动选取框标签

> ID：10551897
> 
> 赞同：2
> 
> 时间：2012-05-11T13:02:48.380
> 
> 标签：iphone, objective-c, uilabel, marquee

我有一个 UILabel，我想像 HTML 中的 marquee 标签一样滚动，我应该怎么做？

```
#define LEFTSCROLLDIRECTION 0
#define RIGHTSCROLLDIRECTION 1

MarqueeLabel *marquee = [[MarqueeLabel alloc] initWithFrame:CGRectMake(10, 10, 300, 30)];
label.scrollDirection = LEFTSCROLLDIRECTION;
[self.view addSubview:marquee]; 
```

# 编辑

我发现[这](http://blog.stormyprods.com/2009/10/simple-scrolling-uilabel-for-iphone.html)门课一开始似乎有效..

但这有一个错误..如果我在 UINavigationController 中向前导航并在一段时间后弹出 pushViewController，则 autoScrollLabel 停止动画..

```
AutoScrollLabel *autoScrollLabel = [[AutoScrollLabel alloc] init];
autoScrollLabel.text = @"Hi Mom!  How are you?  I really ought to write more often.";
autoScrollLabel.textColor = [UIColor yellowColor]; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-04-02T21:17:24.440

查看[这个](https://github.com/cbpowell/MarqueeLabel)开源组件，实际上称为 MarqueeLabel。

它使这变得非常容易。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-05-21T18:01:28.017

在 Interface Builder（Main.storyboard 文件）中，我添加了一个 UIView 给他一个位置，

我在 ViewController.h 中钩住了对象

```
IBOutlet UIView *marqueeView; 
```

之后，在 ViewController.m 中，进入我编写的 viewDidLoad 方法：

```
MarqueeLabel *marqueeLabel = [[MarqueeLabel alloc] initWithFrame:CGRectMake(0, 0, 315, 20) duration:8.0 andFadeLength:10.0f];
marqueeLabel.text = @"marquee text.. this text will scroll";
[marqueeView addSubview:marqueeLabel]; 
```

我希望你能有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-11T13:17:24.287

UILabel 是一个 UIView。有很多方法可以为 UIView 设置动画，但使用块可能是您的最佳选择

```
MarqueeLabel *marquee == ...
[UIView animateWithDuration:5.0 animations:^{ 
    CGRect frame = marquee.frame;
    frame.origin.x = -50.0f
    marquee.frame = frame;
}]: 
```

这将产生在 5 秒内向左“滚动”选框 50 个像素的效果。您需要调整包含视图的大小以及选取框的宽度。

如果您希望左侧的滚动立即出现在右侧，您可以使用第二个选取框来实现此目的，该选取框的 x 原点从 320 开始，因为第一个选取框的 x 原点为 0。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-01-27T08:30:21.757

它很简单。试试下面的代码，

```
 [UIView animateKeyframesWithDuration:5 delay:0 options:UIViewKeyframeAnimationOptionRepeat|UIViewAnimationOptionCurveLinear animations:^{
//_mlabel is my created sample label
        _mlabel.frame=CGRectMake(0-(self.view.frame.size.width), _mlabel.frame.origin.y, _mlabel.frame.size.width, _mlabel.frame.size.height);

    } completion:nil]; 
```

希望能帮助到你 ：）

# jakarta-ee - 为什么，何时以及在何种情况下，我们应该在 spring mvc 中使用多个 servlet 而不是单个 servlet？

> ID：10551898
> 
> 赞同：3
> 
> 时间：2012-05-11T13:02:48.887
> 
> 标签：jakarta-ee, spring-mvc

我昨天开始学习 Spring MVC，然后我发现在 Spring MVC（或其他框架）中，我们可以在一个 Web 应用程序中拥有许多 servlet。
Servlet 有一个 url 模式，如果有任何 http 请求，它将被匹配。另一方面，我们可以只使用@RequestMapping 对http 请求进行映射。
所以问题是为什么、何时以及在什么情况下我们应该使用多个 servlet ？
最好的做法是什么？

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T13:29:07.597

通常使用 Spring MVC，您在 web.xml 中声明一个 servlet，如下所示：

```
<servlet>
    <servlet-name>ActivityReplicator</servlet-name>
    <servlet-class>
        org.springframework.web.servlet.DispatcherServlet
    </servlet-class>
    <load-on-startup>1</load-on-startup>
</servlet>

<servlet-mapping>
    <servlet-name>ActivityReplicator</servlet-name>
    <url-pattern>/</url-pattern>
</servlet-mapping> 
```

这个 servlet 将负责处理对应用程序的每个请求，并将它们分派给正确的控制器。

使用单个 servlet 限制了必须在 web.xml 中完成的配置。Spring 控制器专门用于处理来自 DispatcherServlet 的重定向。正如 Nathan 解释的那样，控制器的配置不太复杂。

我会为您的应用程序中找到的每个域建议一个控制器。例如，一个控制器用于用户管理，另一个控制器用于论坛帖子管理。您可以阅读使用 Spring 的 Restfull 控制器，以了解要实现多少个控制器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T18:26:14.093

如果您想要诸如开发人员 API RESTful 服务之类的东西，使用 Jersey 之类的东西而不是 Spring MVC 的冗长性更容易实现，您可以拥有多个 servlet。在这种情况下，您将拥有一个用于使用 Jersey 的 API 服务的 servlet，以及一个用于处理前端网站的 Spring Servlet。

# objective-c - 视频播放器在 Xcode 4.2 中不起作用

> ID：10551899
> 
> 赞同：0
> 
> 时间：2012-05-11T13:02:49.397
> 
> 标签：objective-c

`我在开发用于在 ios5 Xcode 编程中运行 mp4 视频的代码时遇到问题。当我运行应用程序时，虽然clip2.mp4 文件在我的bundle 中，但会显示。请给我一个适当的解决方案

```
 - (void)viewDidLoad
  {
   [super viewDidLoad];
// Do any additional setup after loading the view, typically from a nib.

  NSString *url = [[NSBundle mainBundle]
                 pathForResource:@"clip2"
                 ofType:@"mp4"];
 player =[[MPMoviePlayerController alloc]
   initWithContentURL:[NSURL fileURLWithPath:url]];
  [player prepareToPlay];
   [player play];    

   [[NSNotificationCenter defaultCenter]
 addObserver:self
   selector:@selector(movieFinishedCallback:)                                                 
   name:MPMoviePlayerPlaybackDidFinishNotification
   object:player];

  //---play movie---

 }

   - (void) movieFinishedCallback:(NSNotification*) aNotification {
  MPMoviePlayerController *play= [aNotification object];
   [[NSNotificationCenter defaultCenter]
   removeObserver:self
    name:MPMoviePlayerPlaybackDidFinishNotification
    object:play];    
   /    / [player autorelease];    
   } ` 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T13:05:28.527

它应该是

```
player = [[MPMoviePlayerController alloc] initWithContentURL:url]; 
```

`url`已经是一个`NSURL`. `-fileURLWithPath:`用于从包含文件路径 (ie ) 而不是普通 URL (ie )的`NSURL`from创建一个`NSString``/path/to/file``http://stackoverflow.com/`

# php - 检查字段组为空白或未使用数组

> ID：10551902
> 
> 赞同：0
> 
> 时间：2012-05-11T13:02:53.943
> 
> 标签：php, arrays

例如，我有 5 个变量（字段值），

```
$companyname
$firstname,
$lastname,
$address1,
$address2 
```

所以，根据要求，这里有2组。

```
$group1 = array('firstname','lastname','address1');
$group2 = array('companyname','address2'); 
```

Group1 变量是必需的，Group2 变量是必需的。IE

```
Either $firstname AND $lastname AND $address1 Can Not Be Blank 
OR
$companyname AND $address2 Can Not Be Blank. 
```

**目标是：**

这个函数：$alt_req_arrays($arr1,$arr2); 应该返回真或假。

**问题是：** 我想用最少的代码编写这个函数（使用数组函数或类似的东西......）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T14:44:51.237

如果你形成你的 $group 就像：

```
$group1 = array('firstname' => 'dfgdf','lastname' => 'dsfsad','address1' => 'ccc');
$group2 = array('companyname' => 'a','address2' => 'fdgdf'); 
```

即hash "field" => "value of the field"，那么可以使用如下：

```
$group1 = array('firstname' => 'dfgdf','lastname' => 'dsfsad','address1' => 'ccc');
$group2 = array('companyname' => 'a','address2' => 'fdgdf');

function alt_req_arrays($arr1,$arr2)
{
    return !array_search(null,$arr1) || !array_search(null,$arr2);
}
var_dump(alt_req_arrays($group1,$group2)); 
```

# php - 适用于所有主要数据库的查询生成器？

> ID：10551909
> 
> 赞同：1
> 
> 时间：2012-05-11T13:03:21.173
> 
> 标签：php, mysql, sql, oracle

我需要使用生成包含占位符的 SQL 语句的查询生成器。

它应该：

*   生成包含占位符的 SQL 语句(:placeHolder or ?)
*   没有**对象**映射
*   以字符串或类似形式返回查询
*   使用所有主要数据库（例如 Oracle、MySQL）

我正在考虑这样的事情：

```
QueryBuilder::select(
    'db' => 'MySQL'
    'from' => 'users',
    'fields' => array(
         'user_id' => 'id'
    ),
    'where' => array(
        'AND' => array(
             /**
              * ...conditions...
              */
        )
    ),
    'ljoin' => array(
        'Group' => array(
            'from' => 'groups'
             /**
              * ...stuff...
              */
        )
    )
); 
```

我查看了 Doctrine2，但它需要对象映射。还有很多初始配置。我查看了 Doctrine2 DBAL，它不处理 INSERT 查询。

*注意：*查询是在开发阶段生成的，并为每个支持的数据库引擎保存为纯文本。

先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T13:43:45.443

[在http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/reference/query-builder.html](http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/reference/query-builder.html)上尝试 Doctrine 2 ORM Query builder 非常通用，并且可以与大多数 DBMS 系统一起使用

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T13:20:33.057

一个例子是 Code Igniter [Active Record](http://codeigniter.com/user_guide/database/active_record.html)，你可以构建如下查询：

```
$this->db->select('field_one, field_two')
    ->from('mytable')
    ->where(array('field' => 'value', 'field' => 'value')) 
```

# php - 现在之前的 MySQL 查询

> ID：10551911
> 
> 赞同：-2
> 
> 时间：2012-05-11T13:03:39.307
> 
> 标签：php, mysql, forms, timestamp

现在，我在这个奇妙的网站上阅读了有关如何检查数据库中的时间戳是否在 now() 之前的内容，这回答了我的部分问题。

但是我的问题的其余部分仍然让我难以理解：

您如何不仅可以检查**BEFORE** now() 之前的时间戳，还可以限制之前查询的时间戳数？

我有一个充当留言簿的数据库，输出是一个看起来像便利贴板的闪存片。您填写一张表格，提交的内容会立即“粘贴”到便利贴板上。问题是当你第一次加载页面时，它会加载从 id-0 到 id-5,000,000 的每一个帖子，依此类推。

我想限制加载的数量，以便查询查看以下内容：

> **当前时间戳是多少？**
> **回到过去（例如） 10 个条目之前**
> **从那个点开始发布**

我在数据库中的字段是：id、comments、timestamp

**编辑**
我正在查看一些答案，我想问一下限制。如果我对查询设置了限制，我现在还能查询过去的帖子吗？

示例：假设有两个人同时查看该网站。一位访问者在数据库中发表评论。我希望第 2 个人仍然能够看到他最后弹出的评论。

Flash 便利贴区域运行一个 php 脚本，该脚本查询数据库并将其导出为 Flash 可以读取的 XML 格式。每隔 5 秒，flash 会重新查询数据库以检查更多帖子。

如果我在查询中设置了限制，我仍然能够即时获取新条目吗？我只希望 LIMIT 生成一个从零点偏移的起点

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T13:24:46.333

```
SELECT * FROM
    (SELECT ... WHERE dt<NOW() ORDER BY dt DESC LIMIT 10) a
ORDER BY a.dt ASC 
```

或者

```
SELECT ... WHERE dt<NOW() ORDER BY dt DESC LIMIT 10 
```

检查哪个更适合您。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T13:06:50.273

我认为您要查找的内容称为[Limit](http://php.about.com/od/mysqlcommands/g/Limit_sql.htm) 您只需将其放在语句的末尾，查询将返回您想要的结果数量

```
YOUR QUERY LIMIT 0,10 
```

这将返回 10 个第一个结果

# c# - 如果搜索框位于 _SiteLayout 页面中（在标题 DIV 中），如何将搜索结果返回给用户

> ID：10551916
> 
> 赞同：1
> 
> 时间：2012-05-11T13:04:01.600
> 
> 标签：c#, javascript, html, forms, webmatrix

我正在构建一个基于 WebMatrix 的站点，但我忽略了一些东西。只是我没有想到的事情。

我的网站是这样组成的，因此每个页面的页眉和页脚都引用了 _SiteLayout.cshtml 页面。例如：

**_SiteLayout.cshtml**：

```
<html>
<head>
</head>
<body>
     <div id="Container">
          <div id="heading">
               <input type="text" name="search" value="search" id="searchbox" />
          </div>
          @RenderBody() <!-- display Default.cshtml content -->
         <div id="footer"><p>stuff here</p></div>
     </div>
</body>
</html> 
```

**默认.cshtml**：

```
@{
     Layout = "~/_SiteLayout.cshtml";
}
<p>
 I want to display search results in the Default.cshtml (homepage) page, but I don't know how to if the search form is inside the SiteLayout page. How to do this?
</p> 
```

所以，我的问题是我想在 Default.cshtml（主页）页面中显示搜索结果，但如果搜索表单位于 SiteLayout 页面内，我不知道该怎么做。

我该怎么做呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T13:31:00.673

您需要将该搜索输入中的信息发布到服务器。取回数据后，您可以使用它来定位您知道将在子视图中的 HTML 元素。

[jQuery 文档中的这篇文章](http://api.jquery.com/jQuery.getJSON/)帮助了我。我的数据来自 JSON 响应，但该示例显示了如何使用 jQuery 获取结果响应并将其添加到特定元素（在本例中为`<body>`, 但您可以轻松地创建一个 id 为的 div “搜索结果”并以`#search-results`) 为目标：

```
$.getJSON('ajax/test.json', function(data) {
  var items = [];

  $.each(data, function(key, val) {
    items.push('<li id="' + key + '">' + val + '</li>');
  });

  $('<ul/>', {
    'class': 'my-new-list',
    html: items.join('')
  }).appendTo('body');  // Here, you could append your items to #search-results
}); 
```

然后由所有视图包含一个带有搜索结果 ID 的部分，但如果它不存在，那么数据就不会出现在任何地方。该脚本应位于单独的文件中，并在您的主站点布局中引用。

# xml - Bash 脚本和 xml/rss 解析

> ID：10551917
> 
> 赞同：1
> 
> 时间：2012-05-11T13:04:04.253
> 
> 标签：xml, bash, parsing, xml-parsing, xmllint

我正在编写一个使用 xmllint 解析 rss 的小脚本。

现在我使用以下命令获取标题列表：

```
ITEMS=`echo "cat //title" | xmllint --shell rss.xml `
echo $ITEMS > tmpfile 
```

但它返回：

```
<title>xxx</title> ------- <title>yyy :)</title> ------- <title>zzzzzz</title> 
```

没有换行符或空格。现在我只对标题标签的文本内容感兴趣，如果可能的话，我想使用 for/while 循环浏览标题，例如：

```
for  val in $ITEMS 
do
       echo $val
done 
```

怎么做？提前致谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T14:14:19.657

在某些时候，我有相同类型的要求来解析 bash 中的 xml。我最终使用了 xmlstarlet [http://xmlstar.sourceforge.net/](http://xmlstar.sourceforge.net/)，您可能可以安装它。

如果没有，类似的东西会删除周围的标签：

```
echo "cat  //title/text()" | xmllint --shell  rss.xml 
```

然后你需要在管道后清理输出，一个基本的解决方案是：

```
echo "cat  //title/text()" | xmllint --shell  rss.xml  | egrep '^\w' 
```

希望这可以帮助

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T13:42:38.527

`$ITEMS`要回答您的第一个问题， with的未引用用法`echo`是消除您的换行符。尝试

```
ITEMS=`echo "cat //title" | xmllint --shell rss.xml `
echo "$ITEMS" > tmpfile
#----^------^--- dbl-quotes only 
```

一般来说，使用`for`循环最好留给不会产生意外空格或其他不可打印字符的项目。（非字母数字），例如`for i in {1..10} ; do echo $i; done`

而且你真的不需要变量或临时文件，试试

```
 echo "cat //title" | xmllint --shell rss.xml |
  while read line ; do
      echo "$line"
  done 
```

根据您的 rrs 提要中的内容，您还可以从更改读取 cmd 使用的默认 IFS（内部字段分隔符）中受益，尝试

```
while IFS= read line ....
# or 
while IFS="\n" read line
# or
while IFS="\r\n" read line 
```

我不确定你想通过`echo "cat //title" |`进入 xmllint 来实现什么，所以我保持原样。这是对 xmllint 的指令吗？还是通过创建文档标题？（现在没有 xmllint 可以体验）。

此外，您可能想查看[使用 awk 阅读 rss 提要](http://awk.info/?doc/tools/myrss.html)，但它的级别相当低。

我希望这有帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-06-27T16:20:36.427

除了[Philippe 的回答](https://stackoverflow.com/a/10553095/4375327)，如果你想**直接**从类似的**命令****`cURL`**获取 xml 输出，你可以使用[另一个文件描述符](https://unix.stackexchange.com/q/18899/138686)来管道它。

事实上，STDIN 已经被`xmllintt`shell 输入所占用。下面是一个工作示例（只需记住将 URL 参数替换为您的）。

```
# Create a temporary file and use it as third fd
exec 3<> $(tempfile) &&
# cURL the RSS URL and redirect STDOUT to the 3rd fd
curl https://your-url/to/some/rss.xml >&3 &&
# Then read  fd 3 with xmllint
xmllint --format --shell /dev/fd/3 <<< 'cat //title/text()' | egrep '^\w' &&
# Close the temporary file (remember global warming issues)
exec 3>&- 
```

# django - 如何打印出访问 Django 中的 2 个表的 HTML 表？

> ID：10551919
> 
> 赞同：-1
> 
> 时间：2012-05-11T13:04:11.910
> 
> 标签：django, django-queryset, django-managers

为了开始使用 Django，我使用它为我的垒球队构建了一个小站点，我们可以在其中列出每个球员的统计数据。对于模型，我定义了 2 个表 - Player 和 Statline，其中 Statline 中的玩家是外键。

```
class Player(models.Model):
    name = models.CharField(max_length=32)
    gender = models.CharField(max_length=1, choices=GENDER_CHOICES)
    bats = models.CharField(max_length=1, choices=HANDED_CHOICES)
    throws = models.CharField(max_length=1, choices=HANDED_CHOICES)
    position = models.CharField(max_length=2, choices=POSITION_CHOICES)
    pitches = models.CharField(max_length=1, choices=PITCHES_CHOICES)
    hometown = models.CharField(max_length=32)

    def __unicode__(self):
        return self.name

class StatLine(models.Model):
    season_name = models.CharField(max_length=12, choices=SEASON_CHOICES)
    player = models.ForeignKey(Player)
    at_bats = models.IntegerField(max_length=2, choices=NUMBER_CHOICES, default=0)
    singles = models.IntegerField(max_length=2, choices=NUMBER_CHOICES, default=0)
    doubles = models.IntegerField(max_length=2, choices=NUMBER_CHOICES, default=0)
    triples = models.IntegerField(max_length=2, choices=NUMBER_CHOICES, default=0)
    homeruns = models.IntegerField(max_length=2, choices=NUMBER_CHOICES, default=0)
    runs = models.IntegerField(max_length=2, choices=NUMBER_CHOICES, default=0)
    rbis = models.IntegerField(max_length=2, choices=NUMBER_CHOICES, default=0)
    rboe = models.IntegerField(max_length=2, choices=NUMBER_CHOICES, default=0) 
```

我要做的是做一个查询，在其中总结每个玩家的所有统计数据并按玩家分组。这样我就可以对每个赛季的所有统计数据进行统计。当我用 PHP 构建网站时，在 SQL 中，它是：

```
FROM Stats
INNER JOIN Players ON Players.player_id = Stats.player_id 
WHERE season_name = 'Spring 2012'
GROUP BY Players.player_name 
```

我对如何使用 Django 执行相同的查询感到困惑。任何帮助将非常感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T13:24:32.057

[Django 关于聚合的文档](https://docs.djangoproject.com/en/1.4/topics/db/aggregation)应该足够了。

我不知道您为什么要分组，`player_name`因为您没有说明要选择哪些字段以及是否应该在某处进行聚合。一个对象可以有多个`StatLine`对象`Player`吗？

如果您希望为每个球员总结特定赛季的所有本垒打，您可以使用以下代码段：

```
from django.db.models import Sum
Player.objects.filter(
      statline__season_name="Spring 2012"
   ).annotate(
      sum_homeruns=Sum(statline__homeruns),
      sum_abats=Sum(statline__abats),
      sum_singles=Sum(statline__singl‌​es),
      […]
) 
```

如[文档](https://docs.djangoproject.com/en/1.4/topics/db/aggregation/#order-of-annotate-and-filter-clauses)`filter()`中所述，和的顺序`annotate()`很重要。

# php - 文件大小统计失败

> ID：10551922
> 
> 赞同：2
> 
> 时间：2012-05-11T13:04:33.607
> 
> 标签：php, unicode

我有一个 php 脚本正在运行，它遍历指定目录中的所有文件。它为找到的每个文件返回名称、文件大小、修改日期等。该脚本正确返回了大多数文件的信息，但其中包含中文或其他符号的文件除外。然后我得到著名的文件大小统计失败错误（警告）。在不更改文件名的情况下，我将如何解决这个问题？

如果需要，我会提供代码。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T13:09:44.033

我以前遇到过这种情况；文件系统编码很难预测，但这通常对我有用：

```
stat(iconv('UTF-8', 'ISO-8859-1', $filename)); 
```

它只是将文件名从 utf8 转换为 iso8859-1 并尝试。

不过这很棘手，只需查看此页面，即可在帖子评论中找到一个有趣的对话框：[http ://www.rooftopsolutions.nl/blog/filesystem-encoding-and-php](http://www.rooftopsolutions.nl/blog/filesystem-encoding-and-php)

# vb.net - 在循环中添加了多个 OrderBy 语句的 Linq 查询

> ID：10551925
> 
> 赞同：7
> 
> 时间：2012-05-11T13:04:47.013
> 
> 标签：vb.net, linq, sql-order-by

我在 Web 服务中有一个方法，该方法具有参数，用户可以使用该参数来决定他们希望如何对结果进行排序。这是一个`List(Of String)`按照他们想要对它们进行排序的顺序的字段名称。

我知道我通常可以通过执行以下操作对多个列进行排序

```
Dim test = Bars.OrderBy(Function(x) x.Foo) _
               .ThenBy(Function(x) x.Bar) _
               .ThenBy(Function(x) x.Test) 
```

但是在这种情况下，这将不起作用，因为我无法链接该`ThenBy`函数，因为我正在循环中添加排序顺序。要使用`ThenBy`我需要一个`IOrderedQueryable`集合。这就是我希望它工作的方式

```
Dim sortColumns = {"Foo", "Bar", "Test"}
Dim query = From b in Bars
For each column in sortColumns
    Select Case column
        Case "Foo"
            query = query.Orderby(Function(x) x.Foo)
        Case "Bar"
            query = query.Orderby(Function(x) x.Bar)
        Case "Test"
            query = query.Orderby(Function(x) x.Test)
    End Select
Next

Dim result = query.Select(Function(x) x.x).ToList()
Return result 
```

这当然行不通，因为`OrderBy`它将取代任何以前的订购。我能想到的唯一解决方案是先在其他变量上排序列表，所以我已经有一个`IOrderedQueryable`集合，但这似乎是错误的方法。

```
Dim bars As New List(Of Bar)
Dim sortColumns = {"Foo", "Bar", "Test"}
Dim query = bars.Select(Function(x) New With {.Temp = 1, .x = x}) _
                .OrderBy(Function(x) x.Temp)

For Each column In sortColumns
    Select Case column
        Case "Foo"
            query = query.ThenBy(Function(x) x.x.Foo)
        Case "Bar"
            query = query.ThenBy(Function(x) x.x.Bar)
        Case "Test"
            query = query.ThenBy(Function(x) x.x.Test)
    End Select
Next

Dim result = query.Select(Function(x) x.x).ToList()
Return result 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-11T13:08:28.867

您可以编写自己的扩展方法`OrderByOrThenBy`来检查值是否*已经*是`IOrderedQueryable`，如果是，则使用`ThenBy`，`OrderBy`否则。有点臭，但做起来并不难。

编辑：C# 示例（未经测试）：

```
public static class QueryableOrdering
{
    public static IOrderedQueryable<TElement> OrderByOrThenBy<TElement, TKey>
        (this IQueryable<TElement> source,
         Expression<Func<TElement, TKey>> ordering)
    {
        if (source == null)
        {
            throw new ArgumentNullException("source");
        }
        if (ordering == null)
        {
            throw new ArgumentNullException("ordering");
        }
        var ordered = source as IOrderedQueryable<TElement>;
        return ordered == null ? source.OrderBy(ordering)
                               : ordered.ThenBy(ordering);
    }
} 
```

# java - 没有 ANT 的 JiBX？

> ID：10551930
> 
> 赞同：1
> 
> 时间：2012-05-11T13:05:01.397
> 
> 标签：java, jibx

有没有办法在没有 Ant 的情况下使用 JiBX Databinder？

我的应用程序服务器上没有 ant，当我想在那里运行我的映射时，我得到绑定未编译的异常。

最好的问候投票

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T15:49:27.577

你是用 Eclipse 开发的吗？如果是这样，[JiBX Eclipse 插件](http://jibx.sourceforge.net/eclipse/index.html)工作得很好。它“将在检测到可能影响绑定或绑定类的更改时自动运行 JiBX 绑定编译器”。

# python - Python电子邮件模块：带有一些unicode名称+电子邮件的表单标题“发件人”

> ID：10551933
> 
> 赞同：13
> 
> 时间：2012-05-11T13:05:08.147
> 
> 标签：python, email

我在 Python 电子邮件模块的帮助下生成电子邮件。
这里有几行代码，它演示了我的问题：

```
msg = email.MIMEMultipart.MIMEMultipart('alternative')

msg['From'] = "somemail@somedomain.com"

msg.as_string()

Out[7]: 'Content-Type: multipart/alternative;\n boundary="===============9006870443159801881=="\nMIME-Version: 1.0\nFrom: somemail@somedomain.com\n\n--===============9006870443159801881==\n\n--===============9006870443159801881==--' 
```

如您所见，这里一切正常，发件人字段包含电子邮件蚂蚁，这很酷。但是如果我想在电子邮件之前添加一些名字怎么办？特别是unicode一：

```
In [8]: u.get_full_name()
Out[8]: u'\u0414\u0438\u043c\u0430 \u0426\u0443\u043a\u0430\u043d\u043e\u0432'

In [9]: msg = email.MIMEMultipart.MIMEMultipart('alternative')

In [10]: msg['From'] = "%s <%s>" % (u.get_full_name(), "email@at.com")

In [11]: msg.as_string()
Out[11]: 'Content-Type: multipart/alternative;\n boundary="===============5792069034892928634=="\nMIME-Version: 1.0\nFrom: =?utf-8?b?0JTQuNC80LAg0KbRg9C60LDQvdC+0LIgPGVtYWlsQGF0LmNvbT4=?=\n\n--===============5792069034892928634==\n\n--===============5792069034892928634==--' 
```

在这里您可以看到，所有字符串（姓名、电子邮件）都以 base64 编码（甚至非常合乎逻辑，MIMEMultipart 将如何知道字符串包含 unicode 和非 unicode 部分）。
所以，我的问题是：我如何告诉电子邮件模块让我漂亮的“发件人”标题，如：
`From: =?UTF-8?B?0JLQmtC+0L3RgtCw0LrRgtC1?= <admin@notify.vk.com> ?`

此外，我还学习了一点 RFC2822（http://www.faqs.org/rfcs/rfc2822.html，p.3.6.2）。它说：

发起者字段指示消息源的邮箱。“发件人：”字段指定消息的作者，即负责编写消息的人或系统的邮箱。“发件人：”字段指定负责实际传输消息的代理的邮箱。例如，如果秘书要为另一个人发送消息，则秘书的邮箱将出现在“发件人：”字段中，而实际作者的邮箱将出现在“发件人：”字段中。如果消息的发起者可以由单个邮箱指示并且作者和发送者相同，则不应使用“发件人：”字段。否则，两个字段都应该出现。

这是否意味着我应该结合这两个标题？（发件人和发件人）。我有点困惑，因为我注意到我的 gmail 中有很多电子邮件（通过“显示原始”查看），其中显示了 From 字段名称和电子邮件。

感谢帮助。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-05-11T14:41:46.867

您需要使用以下代码分别对名称部分进行编码`email.header.Header`：

```
from email.MIMEMultipart import MIMEMultipart
from email.header import Header
from email.utils import formataddr

author = formataddr((str(Header(u'Alał', 'utf-8')), "somemail@somedomain.com"))
msg = MIMEMultipart('alternative')
msg['From'] = author
print msg 
```

我希望这将有所帮助。

# javascript - 多维数组

> ID：10551940
> 
> 赞同：0
> 
> 时间：2012-05-11T13:05:31.663
> 
> 标签：javascript, jquery, arrays

如何从以下代码创建？

```
 var x = [12, 155, 177];
      var y = [120, 175, 255];
      var z = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285, 286, 287, 288, 289, 290, 291, 292, 293, 294, 295, 296, 297, 298, 299, 300];
      var value = [];

      for (var i = 0; i < x.length; i++) {

          for (var index = x[i]; index < y[i]; index++) {

              value.push(z[index]);

          }

      }

      console.log(value); 
```

此代码生成一个从 12 到 12、155 到 175 和 177 到 255 的一维数组 RESULT : [13 ,.....,120 , 155 ,........,175 , 177 ,.... .....,255]

我想要做的是在这个数组中创建另一个数组以获得 [[13....120] ， [155,.....,175] ， [175,.....,255]] ；

jsfiddle：http: [//jsfiddle.net/minagabriel/SK2vJ/](http://jsfiddle.net/minagabriel/SK2vJ/)

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T13:08:48.033

试试这个

```
 var x = [12, 155, 177];
 var y = [120, 175, 255];
 var z = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285, 286, 287, 288, 289, 290, 291, 292, 293, 294, 295, 296, 297, 298, 299, 300];
  var value = [];

  for (var i = 0; i < x.length; i++) {

      var temp = []

      for (var index = x[i]; index < y[i]; index++) {

          temp.push(z[index]);

      }

      value.push(temp);

  }

  console.log(value); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T13:11:56.183

我并没有完全遵循您想要做的事情，但这里有一些信息应该会有所帮助。

JavaScript 没有多维数组。（事实上​​，JavaScript 数组[根本不是真正](http://blog.niftysnippets.org/2011/01/myth-of-arrays.html)的数组。）但是您可以拥有一个以数组作为元素值的数组。所以：

```
var i, j, a, sub;

// Create the main array
a = [];

// This loop creates the outermost level
for (i = 0; i < 10; ++i) {
    // Here we create the array to store in a[i]:
    sub = [];

    // This loop builds it up
    for (j = 0; j < 20; ++j) {
        sub[j] = "I'm the element at a[" + i + "][" + j + "]"; // Just a sample value
    }

    // Remember this sub-array
    a[i] = sub;
}
console.log("a[1][12] = " + a[1][12]); // "I'm the element at a[1][12]" 
```

对上述内容的主要说明：

1.  您必须在循环中创建每个从属数组

2.  您不必预先分配或类似的东西，您可以通过分配给一个元素来扩展一个数组。（`push`也有效。它有点*慢*，但这通常没关系。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T13:12:46.477

像这样的东西应该工作。我还使用了一个 for 循环来生成`z`数组，而不是手动写出来。

```
var x = [12, 155, 177], y = [120, 175, 255], z = [], value = [];

// generate z, 1 to 300
for(var i = 1; i<=300; i++) {
    z.push(i);
}

for(var i = 0, len = x.length; i < len; i++) {
    var arr = [];
    for(var j = 0; j < y[i]; j++) {
        arr.push(z[j]);
    }

    value.push(arr);
} 
```

# c# - 将 Gridview 导出到 Excel：无法导出显示的正确数据

> ID：10551941
> 
> 赞同：1
> 
> 时间：2012-05-11T13:05:37.197
> 
> 标签：c#, .net, export-to-excel

我需要将我的gridview 数据导出到excel。这没有问题。一切正常问题是我可以将过滤器应用于网格中显示的数据。当我只想导出那些数据时（一旦应用了过滤器），它会导出过滤器之前我的网格中先前包含的所有数据。

我希望我足够清楚...

这是我正在使用的代码：

```
 public void ExportGridToExcel(GridView grdGridView, string fileName)
    {
        Response.Clear();
        Response.Buffer = true;

        Response.AddHeader("content-disposition", "attachment;filename=GridViewExport.xls");
        Response.Charset = "";
        Response.ContentType = "application/vnd.ms-excel";
        StringWriter sw = new StringWriter();
        HtmlTextWriter hw = new HtmlTextWriter(sw);

        grdGridView.AllowPaging = false;
        grdGridView.DataBind();

        //Change the Header Row back to white color
        grdGridView.HeaderRow.Style.Add("background-color", "#FFFFFF");

        // Apply style to Individual Cells
        grdGridView.HeaderRow.Cells[0].Style.Add("background-color", "green");
        grdGridView.HeaderRow.Cells[1].Style.Add("background-color", "green");
        grdGridView.HeaderRow.Cells[2].Style.Add("background-color", "green");
        grdGridView.HeaderRow.Cells[3].Style.Add("background-color", "green");
        grdGridView.HeaderRow.Cells[4].Style.Add("background-color", "green");
        grdGridView.HeaderRow.Cells[5].Style.Add("background-color", "green");
        grdGridView.HeaderRow.Cells[6].Style.Add("background-color", "green");

        for (int i = 0; i < grdGridView.Rows.Count; i++)
        {
            GridViewRow row = grdGridView.Rows[i];

            // Change Color back to white
            row.BackColor = System.Drawing.Color.White;
            // Apply text style to each Row
            row.Attributes.Add("class", "textmode");
            // Apply style to Individual Cells of Alternating Row
            if (i % 2 != 0)
            {
                row.Cells[0].Style.Add("background-color", "#C2D69B");
                row.Cells[1].Style.Add("background-color", "#C2D69B");
                row.Cells[2].Style.Add("background-color", "#C2D69B");
                row.Cells[3].Style.Add("background-color", "#C2D69B");
                row.Cells[4].Style.Add("background-color", "#C2D69B");
                row.Cells[5].Style.Add("background-color", "#C2D69B");
                row.Cells[6].Style.Add("background-color", "#C2D69B");
            }
        }
        grdGridView.RenderControl(hw);

        // style to format numbers to string
        string style = @"<style> .textmode { mso-number-format:\@; } </style>";
        Response.Write(style);
        Response.Output.Write(sw.ToString());
        Response.Flush();
        Response.End();
    } 
```

我如何应用过滤器（一切都很好）

```
 public void refreshGridFactures()
    {
        DateTime? debutFacture = null;
        DateTime? FinFacture = null;
        DateTime? DebutReglement = null;
        DateTime? FinReglement = null;
        int? NumeroFacture = 0;

        if (PickerDateDebut.SelectedDate != null) { debutFacture = PickerDateDebut.SelectedDate; }
        if (PickerDateFin.SelectedDate != null) { FinFacture = PickerDateFin.SelectedDate; }
        if (PickerDebutReglement.SelectedDate != null) { DebutReglement = PickerDebutReglement.SelectedDate; }
        if (PickerFinReglement.SelectedDate != null) { FinReglement = PickerFinReglement.SelectedDate; }
        int IdEntreprise = Convert.ToInt32(ddlEntreprises.SelectedValue);
        string Intitule = txtIntitule.Text;
        if (txtNumeroFacture.Text != "") { NumeroFacture = Convert.ToInt32(txtNumeroFacture.Text); }

        List<DBAccess.Facturation> listFacturation = DBAccess.DAOFacturation.GetFactures(IdEntreprise, debutFacture, FinFacture, DebutReglement, FinReglement, Intitule, NumeroFacture);
        GridFactures.DataSource = listFacturation;
        GridFactures.DataBind();

        double total = Math.Round(listFacturation.Sum(a => a.MontantTTC), 2);
        double totalHT = Math.Round(listFacturation.Sum(a => a.MontantHT), 2);

        lblTotalTTC.Text = "Montant total TTC : " + total;
        lblTotalHT.Text = "Montant total HT : " + totalHT;
    } 
```

谢谢你的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T13:17:36.027

在您`GridViewRow row = grdGridView.Rows[i];`添加检查以查看该行是否可见之后

`if(!row.Visible) continue;`

# has-many - Silverstripe：模板中 Siteconfig 输出中的数据对象

> ID：10551942
> 
> 赞同：2
> 
> 时间：2012-05-11T13:05:41.770
> 
> 标签：has-many, silverstripe, data-objects

我有一个与 silverstripe 问题类似的问题：[http://www.silverstripe.org/dataobjectmanager-module-forum/show/19853][1]

我有一个工作数据对象，主要提供标题、标题和图像。这进入了一个 has_many，它应该在模板输出中提供一个滑块。

CMS 部分已全部完成，这意味着我可以从 SiteConfig 的选项卡中添加多个“幻灯片”。只有模板中的输出似乎不会发生。

对于我使用的代码：

**SingleSlide 扩展 DataObject：**

```
public function getCMSFields_forPopup()
{
    return new FieldSet(
        new ImageUploadField('SlideImg', 'Afbeelding van slide'),
        new TextField('SlideTitle'),
        new TextField('SlideCaption'),
        new SimpleSiteTree('SlideLinkID')
    );
} 
```

**在 SiteConfigOverride**

```
 $fields->addFieldToTab('Root.SliderA', new ComplexTableField(
        $this->owner, 'SliderA', 'SingleASlide',
        array('SlideImg' => 'Afbeelding van slide', 'SlideTitle' => 'Titel van Slide', 'SlideCaption' => 'Tekst bij slide', 'SlideLink.Title' => 'Link naar pagina'
    ))); 
```

剩下要做的就是能够从模板中的此处获取输出。任何帮助都会很棒！

问候，

凯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-12T11:56:12.363

您可以在 Page.php 中的 Page_Controller 类中添加一个函数，如下所示

```
class Page_Controller extends ContentController {
   ...
      function SingleSlideList() {
         return DataObject::get('SingleSlide');
      }
   ...
} 
```

然后在您的 ss 文件中，您可以使用如下内容：

```
<% control SingleSlideList %>
    <div class="Image"><% control SlideImg %><% control CroppedImage(880,493) %><img src="$BaseHref$Filename.XML" height="$Height" width="$Width"><% end_control %><% end_control %></div>
    <div class="Content">
        <h2>$SlideTitle</h2>
        <p>$SlideCaption</p>
        <p><a href="$SlideLinkID.Link">my link</a></p>
    </div>
<% end_control %> 
```

您将需要更改 html 以使用您需要的内容。

# iphone - iOS：从图像列表创建视频文件时 VideoToolBox 中的内存泄漏

> ID：10551944
> 
> 赞同：2
> 
> 时间：2012-05-11T13:05:45.307
> 
> 标签：iphone, ios, ios4, ios5

## 参考

我已经通过 SO 中的可能很好的链接从图像的 NSArray 创建视频文件。最有用的一个是这个[SO Question Links](https://stackoverflow.com/questions/3741323/how-do-i-export-uiimage-array-as-a-movie "例子")

## 问题

*   现在 VideoToolBox 中存在内存泄漏。（我在 iOS 5.1 模拟器中运行应用程序时附上了仪器的屏幕截图）![仪器屏幕截图](../Images/c81d3f3625a831f6d3d9062f9b07fc60.png)
*   我的应用程序在创建此视频时使用了 346 MB 的内存。主要是因为这个方法。

```

    (BOOL)appendPixelBuffer:(CVPixelBufferRef)pixelBuffer withPresentationTime:(CMTime)presentationTime

```

AVAssetWriterInputPixelBufferAdaptor 类的这个方法会保留所有的 CVPixelBufferRef 直到视频被创建。

## 代码

我创建了一个 ImageToVideo.m NSOperation 类来从图像创建视频。

```

#import "ImageToVideo.h"

@implementation ImageToVideo

//global pixcel buffer.
CVPixelBufferRef pxbuffer = NULL;

- (void) pixelBufferFromCGImage:(CGImageRef)image size:(CGSize)size
{
    NSDictionary *options = [NSDictionary dictionaryWithObjectsAndKeys:
                             [NSNumber numberWithBool:YES], kCVPixelBufferCGImageCompatibilityKey,
                             [NSNumber numberWithBool:YES], kCVPixelBufferCGBitmapContextCompatibilityKey,
                             nil];

    CVBufferRelease(pxbuffer);
    CVReturn status = CVPixelBufferCreate(kCFAllocatorDefault, size.width,
                                          size.height, kCVPixelFormatType_32ARGB, (CFDictionaryRef) options, 
                                          &pxbuffer);
    options = nil;
    [options release];

    status=status;//Added to make the stupid compiler not show a stupid warning.
    NSParameterAssert(status == kCVReturnSuccess && pxbuffer != NULL);

    CVPixelBufferLockBaseAddress(pxbuffer, 0);
    void *pxdata = CVPixelBufferGetBaseAddress(pxbuffer);
    NSParameterAssert(pxdata != NULL);

    CGColorSpaceRef rgbColorSpace = CGColorSpaceCreateDeviceRGB();
    CGContextRef context = CGBitmapContextCreate(pxdata, size.width,
                                                 size.height, 8, 4*size.width, rgbColorSpace, 
                                                 kCGImageAlphaNoneSkipFirst);
    NSParameterAssert(context);

    CGContextDrawImage(context, CGRectMake(0, 0, CGImageGetWidth(image), 
                                           CGImageGetHeight(image)), image);
    CGColorSpaceRelease(rgbColorSpace);
    CGContextRelease(context);

    CVPixelBufferUnlockBaseAddress(pxbuffer, 0);   

}

- (void)writeImageAsMovietoPath:(NSString*)path size:(CGSize)size 
{
    NSError *error = nil;
    AVAssetWriter *videoWriter = [[AVAssetWriter alloc] initWithURL:
                                  [NSURL fileURLWithPath:path] fileType:AVFileTypeQuickTimeMovie
                                                              error:&error];
    NSParameterAssert(videoWriter);

    NSDictionary *videoSettings = [NSDictionary dictionaryWithObjectsAndKeys:
                                   AVVideoCodecH264, AVVideoCodecKey,
                                   [NSNumber numberWithInt:size.width], AVVideoWidthKey,
                                   [NSNumber numberWithInt:size.height], AVVideoHeightKey,
                                   nil];
    AVAssetWriterInput* writerInput = [[AVAssetWriterInput
                                        assetWriterInputWithMediaType:AVMediaTypeVideo
                                        outputSettings:videoSettings] retain];

    AVAssetWriterInputPixelBufferAdaptor *adaptor = [AVAssetWriterInputPixelBufferAdaptor
                                                     assetWriterInputPixelBufferAdaptorWithAssetWriterInput:writerInput
                                                     sourcePixelBufferAttributes:nil];
    NSParameterAssert(writerInput);
    NSParameterAssert([videoWriter canAddInput:writerInput]);
    [videoWriter addInput:writerInput];

    NSMutableArray *photoImages = [[[NSMutableArray alloc] init] autorelease];

    //Creating a image Array
    for (int i = 0; i = [photoImages count]) 
            {
                CVBufferRelease(pxbuffer);
                pxbuffer = NULL;

            } 
            else 
            {
                //creating the pixcel buffer.
                [self pixelBufferFromCGImage:[[photoImages objectAtIndex:i] CGImage] size:CGSizeMake(640, 980)];
            }          

            if (pxbuffer) 
            {
                // append buffer
                [adaptor appendPixelBuffer:pxbuffer withPresentationTime:presentTime];
                CVBufferRelease(pxbuffer);
                pxbuffer = NULL;
                i++;
            } 
            else 
            {
                //Finish the session:
                [writerInput markAsFinished];
                [videoWriter finishWriting];                

                CVPixelBufferPoolRelease(adaptor.pixelBufferPool);
                [videoWriter release];
                [writerInput release];
                NSLog (@"Done");
                break;
            }
        }
    }

    //release the photoImage array.
    [photoImages removeAllObjects];
}

- (void)image:(UIImage *)image didFinishSavingWithError:(NSError *)error contextInfo:(void *)contextInfo
{
    // Unable to save the image  
    if (error)
    {
        UIAlertView *alert;
        alert = [[UIAlertView alloc] initWithTitle:@"Error" 
                                           message:@"Unable to save image to Photo Album." 
                                          delegate:self cancelButtonTitle:@"Ok" 
                                 otherButtonTitles:nil];
        [alert show];
        [alert release];
    }
}

- (void) main
{
    NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];
    NSLog(@"Operation Started");

    NSString *path = [NSHomeDirectory() stringByAppendingPathComponent:[NSString stringWithFormat:@"Documents/movie.mp4"]];  
    CGSize size = CGSizeMake(640, 960);

    [self writeImageAsMovietoPath:path size:size] ;

    [pool drain];
}

@end

```

## 问题

*   为什么 VideoToolBox 中存在内存泄漏？
*   有没有更好的方法将图像列表转换为 iOS 中的视频？
*   创建视频时如何减少我的应用程序内存占用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-06T23:25:15.437

VideoToolBox 中没有真正的泄漏。在模拟器中运行时看起来确实有，但在设备上运行时不会泄漏。您问题的第 2 部分和第 3 部分的答案是肯定的，有更好的方法。您可以使用像素缓冲池来获得更好的性能和更少的内存分配，但您必须“恰到好处”地做到这一点。

我不会在剪切和粘贴上浪费您的时间，因为您已经体验过尝试通过 SO 复制其他人的代码的缺点。这种电影编码操作非常复杂，Apple API 也不是那么容易使用。最好看一下工作代码的实际完成版本，而不是尝试剪切和粘贴您的成功之路。基本上，您应该调用 CVPixelBufferPoolCreatePixelBuffer() 而不是 CVPixelBufferCreate() 来创建一个像素缓冲区，但如果它已经存在，则重用和现有的像素缓冲区。

看看[AVAssetWriterConvertFromMaxvid.m](https://github.com/mdejong/AVAnimator/blob/master/Classes/AVAnimator/AVAssetWriterConvertFromMaxvid.m)类，它是我在 github 上的 AVAnimator 库的一部分。本课程展示了一个像素缓冲池的真实工作示例，以及您的代码需要如何与辅助线程的运行循环进行交互，以避免在某些编码情况下卡住。

# android - 如何从日期格式“yyyy-MM-dd'T'HH:mm:ss.SSSZ”中分别获取日、年、小时、分钟？

> ID：10551955
> 
> 赞同：19
> 
> 时间：2012-05-11T13:06:15.073
> 
> 标签：android, datetime

我正在做一个以`"yyyy-MM-dd'T'HH:mm:ss.SSSZ"`这种格式存储当前时间和日期的程序。我将它作为字符串存储在数据库中。当我收集数据时，我需要单独的值，如日、年、分钟、秒等。我该怎么做？

```
SimpleDateFormat formatter = new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss.SSSZ");
String now = formatter.format(new Date()); 
```

谢谢，

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-05-11T13:13:18.023

只需使用 parse 而不是 format ：

```
String dateFromDB = "";
SimpleDateFormat parser = new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss.SSSZ");
Date yourDate = parser.parse(dateFromDB); 
```

然后您可以使用 java.util.Date & Calendar API 读取您想要的任何字段：

```
 Calendar calendar = Calendar.getInstance();
    calendar.setTime(yourDate);
    calendar.get(Calendar.DAY_OF_MONTH); //Day of the month :)
    calendar.get(Calendar.SECOND); //number of seconds
//and so on 
```

我希望它符合你的需求

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-05-11T13:47:00.177

我建议您将数据库中的时间存储为“timeInMillis”。以我的经验，它简化了代码，并允许您将时间值相互比较。

存储时间：

```
Calendar calendar = Calendar.getInstance(); // current time
long timeInMillis = calendar.getTimeInMillis();
mDb.saveTime (timeInMillis); // adjust this to work with your DB 
```

要检索时间：

```
long timeInMillis = mDb.getTime();
Calendar calendar = Calendar.getInstance();
calendar.setTimeInMillis (timeInMillis);
int milliSeconds = calendar.get(MILLISECOND);
//etc 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-11T13:12:29.360

有这些方法可用于获取日期的各个部分

```
getDate()
getMinutes()
getHours()
getSeconds()
getMonth()
getTime()
getTimezoneOffset()
getYear() 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-12-07T01:15:02.140

尝试使用： int hour = Calendar.getInstance().get(Calendar.HOUR_OF_DAY);

这里，

*   Calendar.HOUR_OF_DAY 为您提供 24 小时制时间。
*   Calendar.HOUR 为您提供 12 小时的时间。

# python - 如何让 Django 的错误邮件报告“locals()”？

> ID：10551960
> 
> 赞同：4
> 
> 时间：2012-05-11T13:06:44.640
> 
> 标签：python, django, debugging

当您的 Django 应用程序引发异常时，Django 会向您发送一封电子邮件以报告错误，其中包含一些有用的信息。那太棒了。但是有一条信息有助于调试，但这些电子邮件中缺少：`locals()`.

如何使 Django 的错误电子邮件包含`locals()`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T14:04:39.660

通过在设置中包含`'include_html': 'True',`next to 来解决它。现在我通过电子邮件收到包含所有信息的 HTML 报告。`'class': 'django.utils.log.AdminEmailHandler',``LOGGING``settings.py``locals()`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T13:27:14.003

根据[文档，](https://docs.djangoproject.com/en/dev/howto/error-reporting/#s-filtering-error-reports) Django 确实包括本地人。还是我错过了什么？您还可以在文档中找到（请参阅：上面的链接）如何编写您自己的自定义错误报告。

# c++ - 如何绕过在 decltype 表达式中指定变量？

> ID：10551962
> 
> 赞同：1
> 
> 时间：2012-05-11T13:06:48.450
> 
> 标签：c++, c++11, type-inference, lambda

假设我有以下示例功能：

```
template <typename Fn> auto call(Fn fn) -> decltype(fn()) {
  return fn();
} 
```

这个函数重要的是它的返回类型取决于它的模板参数，可以推断。所以最终，返回类型取决于函数的调用方式。

现在，我们还有一个测试类：

```
struct X {
  int u;
  auto test() -> decltype(call([this]() -> double {this->u = 5; return 7.4;})) {
    return call([this]() -> double {this->u = 5; return 7.4;});
  }
}; 
```

如您所见，`X::test`调用`call`，返回相同的返回值。在这种情况下，返回类型通常为`double`，但让我们假设我们不知道是什么`call`，并且 lambda 具有更复杂的返回类型。

如果我们尝试编译它，编译器会报错，因为我们`this`在顶层使用（不在允许表达式的范围内）：

```
error: lambda-expression in unevaluated context
error: invalid use of ‘this’ at top level 
```

但是，我*必须*使用传递给的 lambda 的捕获`call`来获得`call`正确的返回类型。你会建议如何解决这个问题，同时仍然离开 lambda？

注意：当然，我可以将 lambda 移动`operator()`为某种辅助类型，我用`this`指针的副本对其进行实例化，但我想避免使用该样板。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T13:53:21.727

我认为真正需要关注的错误是“未评估上下文中的 lambda 表达式”。您不能在未计算的上下文中使用 lambda，因为每个 lambda 表达式都有唯一的类型。也就是说，如果`decltype([]{})`允许，它将推断出与`[]{}`其他上下文不同的类型。即`decltype([]{}) fn = []{};`行不通。

除非您只想显式地编写返回类型而不是推导出它，否则我认为您别无选择，只能创建一个可以在您需要的上下文中使用的真实类型，以及所需的任何样板。

尽管如果更改`test`为不是成员函数是可以接受的，那么如果主体只是一个返回语句，您可以使用 lambda 可以通过省略它来推断其返回类型的事实：

```
template <typename Fn> auto call(Fn fn) -> decltype(fn()) {
    return fn();
}

struct X {
    int u;
};

int main() {
    auto test = [](X *x) { return call([x]() -> double {x->u = 5; return 7.4; });};

    X x;
    test(&x);
} 
```

如果函数的尾随返回类型语法具有相同的属性，那就太好了。我不确定为什么没有。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T13:42:59.953

您不应该总是将函数体复制并粘贴到`decltype`. 引入后期指定的返回类型的意义在于，您将能够以某种方式从参数中推断出正确的返回类型。
例如`auto f(T x) -> decltype(g(x)) { return h(), g(x); }`，不`-> decltype(h(), g(x))`

所以，在你的情况下，`double test()`就足够了，因为我们知道`call`我们传递给它的 lambda 函数的行为并且我们知道返回类型。
在更复杂的情况下，我们应该`decltype`通过使用关于`call`和其他东西的知识来减少内部代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T13:16:29.720

这似乎是一个虚构的（解释的，人为的）问题，因为

*   如果您从其他地方获得 lambda，那么它会被命名并且没有问题 binding `this`。

*   如果您没有从其他地方获取 lambda，那么您就知道结果类型。

简而言之，正如目前所说的问题（正如我正在写这个答案），除了你自己的意愿强加的问题之外，没有问题。

但是，如果您坚持这一点，那么只需将`this`其作为参数传递，而不是通过 lambda 定义绑定它。然后对于对 的调用`call`，绑定参数。但是，也许不用说，因为这只能解决一个虚构的问题，所以它是一个真正的鲁布戈德堡结构，一个体面的过度开花的不必要的复杂性，它不能解决除了其自身复杂性之外的任何实际问题。

如果有的话，最初*的真正问题*是什么？

# java - 自定义转换为原始数据类型

> ID：10551964
> 
> 赞同：1
> 
> 时间：2012-05-11T13:06:54.410
> 
> 标签：java, casting, primitive

我创建了自己的 MutableInt 类，其中包含一个原始 int 和一些用于更改此 int 值或仅将其增加或减少 1 的方法。

我想知道有什么方法可以让这个类像 Integer 类一样工作，所以例如做这样的事情：

```
MutableInt foo = 42; 
```

或者

```
MutableInt foo = new MutableInt(41);
foo++; 
```

或者

```
MutableInt foo = new MutableInt(42);
int bar = foo; 
```

这在Java中可能吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-11T13:08:57.760

不，Java 中不支持用户定义的转换。仅支持规范中明确列出的转换。

# iphone - iOS获取视频帧率

> ID：10551965
> 
> 赞同：7
> 
> 时间：2012-05-11T13:06:55.290
> 
> 标签：iphone, objective-c, ios, video, frame-rate

我想获取特定视频的帧速率。我试图查看 AVURLAsset 或 AVAssetReader 中的`AVFoundation`API `AssetsLibrary`。它们都没有真正的帮助。有谁知道苹果框架/库中获取帧速率的方法

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-21T12:56:54.347

更简单的选择是获取 AVAssetTrack 并读取它的nominalFrameRate 属性。看起来[这](http://developer.apple.com/library/ios/#DOCUMENTATION/AVFoundation/Reference/AVAssetTrack_Class/Reference/Reference.html#//apple_ref/occ/instm/AVAssetTrack/hasMediaCharacteristic:)可以帮助你。

**标称帧速率是轨道的帧速率，以每秒帧数为单位。**（只读） AVAssetTrack 类 @property(nonatomic, readonly) 浮动标称帧率

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-04-06T18:56:45.960

对于 iOS 7+，您可以使用 AVPlayerItemTrack 的 currentVideoFrameRate 属性。它是我见过的唯一一致的属性来衡量 FPS。在 HLS 流中，nominalFrameRate 属性似乎被破坏了。

```
AVPlayerItem *item = AVPlayer.currentItem; // Your current item
float fps = 0.00;
for (AVPlayerItemTrack *track in item.tracks) {
    if ([track.assetTrack.mediaType isEqualToString:AVMediaTypeVideo]) {
        fps = track.currentVideoFrameRate;
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-09-24T05:46:41.477

对于属性`currentVideoFrameRate`，来自 Apple 的[文档](https://developer.apple.com/documentation/avfoundation/avplayeritemtrack/1388956-currentvideoframerate)：

> 如果项目没有播放，或者轨道的媒体类型不是视频，则此属性的值为 0.0。

它要求该项目处于“播放”状态，因此我`nominalFrameRate`改为使用。

它仍然适用于 iOS 12，swift 4：

```
let tracks = asset.tracks(withMediaType: .video)

let fps = tracks?.first?.nominalFrameRate 
```

请记住处理 nil 检查。

# c++ - f(void*&) 调用上的 C++ 错误

> ID：10551969
> 
> 赞同：0
> 
> 时间：2012-05-11T13:07:05.947
> 
> 标签：c++

您能否从以下代码中解释错误：

```
void foo(void*& param)
{
    param = new char[10];
}

void main()
{
    int* p;
    foo(p);
}

error C2664: 'foo' : cannot convert parameter 1 from 'int *' to 'void *&' 
```

我如何调用具有任何指针类型的函数并更改函数内部的指针（不是该地址处的值，地址本身）。我不想使用模板或双指针。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T13:12:44.523

如果要更新指针，最好将指针传递给指针

```
void foo(void** param)
{
    *param = new char[10];
}

void main()
{
    void* p;
    foo(&p);
    int* p2 = (int*)p;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T13:54:56.597

为什么不能将`int*`as 参数传递给`f`？

问题是，如果允许这样做，您将破坏类型系统。老实说，这正是你想要做的......如果你想打破类型系统，你需要通过强制转换明确地请求它。

您在评论中指出您不想使用强制转换，另一方面编译器不希望您破坏类型系统。在那场意志之战中，我不认为你会说服编译器......它太固执了。

# css - LESS 编译错误 ParseError: 第 1 行的语法错误

> ID：10551971
> 
> 赞同：12
> 
> 时间：2012-05-11T13:07:16.907
> 
> 标签：css, twitter-bootstrap, less

我正在尝试通过将我自己的 less 文件导入现有的 bootstrap.less 来对现有的 bootstrap less 文件进行一些自定义。

我认为这很简单，但是我已经花了几个小时痛苦地尝试使新的编译更少。

每次我添加我的文件时，我都会得到：

> ParseError: C:\xxx\content\bootst rap\less\xxx.form.less:9:999 8 中第 1 行的语法错误

我自己的less文件：

```
.form-unit {
  background-color: #F5F5F5;
  border-radius: 6px 6px 6px 6px;
  margin-bottom: 30px;
  padding: 10px;
  min-height: 170px;
  position:relative;
} 
```

有人有同样的问题吗？我错过了什么？？？

我在网上编译它并不奇怪它有效，我很困惑 ![在线编译](../Images/a31b2e2963eb5a38afe202b3e971cd83.png)

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-05-14T11:15:01.670

您是否使用 SimplLESS 作为您的 LESS 编译器？如果是这样，则存在无法使用 BOM 读取以 UTF-8 编码的文件的错误。只需将您的文件转换为没有 BOM 的 UTF-8 即可。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-11-25T18:35:46.500

对于 Visual Studio 中使用的所有 .less 文件，您需要更改 UTF 编码...。

文件 > 高级保存选项...
将“编码”设置为“Unicode（不带签名的 UTF-8）-代码页 65001

完成此操作后，Simpless 编译器将适用于您的文件。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-09-27T13:50:27.307

对于任何使用 Visual Studio 并继续因上述问题而烦恼的人（过去一个小时左右我一直在同一条船上，上面批准的答案对我不起作用），我建议持有[Web Essentials 扩展](http://visualstudiogallery.msdn.microsoft.com/07d54d12-7133-4e15-becb-6f451ea3bea6)。

它允许将 LESS 文件即时编译为缩小的 CSS，只要它们以与 SimpLESS 几乎相同的方式保存。没有关于编码、行尾或其他任何东西的抱怨！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-06-22T13:31:06.567

如果您使用的是 Visual Studio，请确保您没有不小心将包含的文件添加到编译列表中。检查 compilerconfig.json 并确保您没有尝试编译主 SASS 文件和包含的文件。

# c++ - 按名称和国家/地区搜索功能

> ID：10551977
> 
> 赞同：1
> 
> 时间：2012-05-11T13:07:36.030
> 
> 标签：c++, search

当我将其更改为按点或其他整数搜索时它正在工作，但我必须使其按名称和国家/地区搜索。该函数正在检查其中已经有数据的数组。

```
void search (competitor competitors[], int number)  
{
if(number==0)
{
    cout<<"\n Array is empty!!!\n";
    return;
}

char country[50];
char name[50];
char choice;
bool flag;

do{
    cout << "\n\n Enter country: " << endl;
    cin >> country;
    cout << " Enter name: " << endl;
    cin >> name;

    flag = false;

    for(int i=0; i<number; i++)
    {
        if( country==competitors[i].country && name==competitors[i].name)
        {
            count << " Competitor found!" << endl;
        }
    }
    if (flag == false)

    cout << " Want to search again(Y/N)?: ";
    cin >> choice;

}while(choice == 'Y' || choice == 'y'); 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T13:11:27.810

我假设那`competitors[i].country (name)`是一个`char[]`.

您不能`char[]`使用比较数组`==`（将比较数组的基地址，而不是内容），您必须使用`strcmp()`. 或者，因为这是 C++，所以使用`std::string`代替`char[]`和使用`==`.

# google-maps - 谷歌地图：从博文查询

> ID：10551978
> 
> 赞同：2
> 
> 时间：2012-05-11T13:07:36.400
> 
> 标签：google-maps

[我浏览了谷歌https://developers.google.com/maps/articles/phpsqlsearch](https://developers.google.com/maps/articles/phpsqlsearch)的这个优秀教程，但我不明白 API 读取生成的 xml 文件的部分。我通过帖子两次但仍然没有得到它。有人可以向我解释一下吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T13:45:00.503

我无法弄清楚你不明白哪一部分，所以我将给出一个广泛的概述。

读取 XML 发生在这里：

```
function searchLocationsNear(center) {
  var radius = document.getElementById('radiusSelect').value;
  var searchUrl = 'phpsqlsearch_genxml.php?lat=' + center.lat() + '&lng=' + center.lng() + '&radius=' + radius;
  GDownloadUrl(searchUrl, function(data) {
    var xml = GXml.parse(data);
    var markers = xml.documentElement.getElementsByTagName('marker'); 
```

`searchUrl`使用适当的参数指向 php 文件，然后对`GDownloadUrl`php 文件执行 Ajax 调用。`function(data)`是返回 XML 时运行的回调。最后，`markers`从 XML 中生成，采用带有标签 name 的元素`marker`。然后该代码块的其余部分是放置标记并使用结果更新侧边栏。

# bash - 如何在 Bash 中对字符串中的每个字符执行 for 循环？

> ID：10551981
> 
> 赞同：96
> 
> 时间：2012-05-11T13:07:43.830
> 
> 标签：bash, for-loop

我有一个这样的变量：

```
words="这是一条狗。" 
```

我想对每个字符进行一个 for 循环，一次一个，例如 first `character="这"`， then `character="是"`，`character="一"`等。

我知道的唯一方法是将每个字符输出到文件中的单独行，然后使用`while read line`，但这似乎非常低效。

*   如何通过 for 循环处理字符串中的每个字符？

* * *

## 回答 #1

> 赞同：266
> 
> 时间：2012-05-11T13:19:42.123

您可以使用 C 风格的`for`循环：

```
foo=string
for (( i=0; i<${#foo}; i++ )); do
  echo "${foo:$i:1}"
done 
```

`${#foo}`扩展至 的长度`foo`。`${foo:$i:1}`展开到从`$i`长度为 1 的位置开始的子字符串。

* * *

## 回答 #2

> 赞同：54
> 
> 时间：2012-05-13T15:19:33.523

在外壳上`sed`，我得到了以下工作正常：`dash``LANG=en_US.UTF-8`

```
$ echo "你好嗎 新年好。全型句號" | sed -e 's/\(.\)/\1\n/g'
你
好
嗎

新
年
好
。
全
型
句
號 
```

和

```
$ echo "Hello world" | sed -e 's/\(.\)/\1\n/g'
H
e
l
l
o

w
o
r
l
d 
```

因此，输出可以循环使用`while read ... ; do ... ; done`

编辑示例文本翻译成英文：

```
"你好嗎 新年好。全型句號" is zh_TW.UTF-8 encoding for:
"你好嗎"     = How are you[ doing]
" "         = a normal space character
"新年好"     = Happy new year
"。全型空格" = a double-byte-sized full-stop followed by text description 
```

* * *

## 回答 #3

> 赞同：40
> 
> 时间：2012-05-11T13:13:01.573

`${#var}`返回的长度`var`

`${var:pos:N}``pos`从后面返回 N 个字符

例子：

```
$ words="abc"
$ echo ${words:0:1}
a
$ echo ${words:1:1}
b
$ echo ${words:2:1}
c 
```

所以很容易迭代。

另一种方式：

```
$ grep -o . <<< "abc"
a
b
c 
```

或者

```
$ grep -o . <<< "abc" | while read letter;  do echo "my letter is $letter" ; done 

my letter is a
my letter is b
my letter is c 
```

* * *

## 回答 #4

> 赞同：25
> 
> 时间：2015-04-27T21:22:07.717

我很惊讶没有人提到只使用和的明显`bash`解决方案。`while``read`

```
while read -n1 character; do
    echo "$character"
done < <(echo -n "$words") 
```

注意使用`echo -n`以避免末尾多余的换行符。`printf`是另一个不错的选择，可能更适合您的特定需求。如果您想忽略空格，请替换`"$words"`为`"${words// /}"`.

另一种选择是`fold`。但是请注意，它不应该被送入 for 循环。相反，使用 while 循环如下：

```
while read char; do
    echo "$char"
done < <(fold -w1 <<<"$words") 
```

使用外部`fold`命令（*coreutils*包的）的主要好处是简洁。您可以将其输出提供给另一个命令，例如`xargs`（*findutils*包的一部分），如下所示：

```
fold -w1 <<<"$words" | xargs -I% -- echo % 
```

您需要将`echo`上面示例中使用的命令替换为您希望针对每个字符运行的命令。请注意，`xargs`默认情况下将丢弃空格。您可以使用`-d '\n'`来禁用该行为。

* * *

**国际化**

我刚刚测试`fold`了一些亚洲字符，发现它不支持 Unicode。因此，虽然它可以满足 ASCII 需求，但它并不适合所有人。在这种情况下，有一些替代方案。

我可能会`fold -w1`用 awk 数组替换：

```
awk 'BEGIN{FS=""} {for (i=1;i<=NF;i++) print $i}' 
```

或者`grep`另一个答案中提到的命令：

```
grep -o . 
```

* * *

**表现**

仅供参考，我对上述 3 个选项进行了基准测试。前两个速度很快，几乎平手，折叠循环比 while 循环稍快。不出所料`xargs`，它是最慢的……慢了 75 倍。

这是（缩写的）测试代码：

```
words=$(python -c 'from string import ascii_letters as l; print(l * 100)')

testrunner(){
    for test in test_while_loop test_fold_loop test_fold_xargs test_awk_loop test_grep_loop; do
        echo "$test"
        (time for (( i=1; i<$((${1:-100} + 1)); i++ )); do "$test"; done >/dev/null) 2>&1 | sed '/^$/d'
        echo
    done
}

testrunner 100 
```

结果如下：

```
test_while_loop
real    0m5.821s
user    0m5.322s
sys     0m0.526s

test_fold_loop
real    0m6.051s
user    0m5.260s
sys     0m0.822s

test_fold_xargs
real    7m13.444s
user    0m24.531s
sys     6m44.704s

test_awk_loop
real    0m6.507s
user    0m5.858s
sys     0m0.788s

test_grep_loop
real    0m6.179s
user    0m5.409s
sys     0m0.921s 
```

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2016-11-27T20:18:24.677

我相信仍然没有理想的解决方案可以正确保留所有空白字符并且速度足够快，所以我会发布我的答案。使用`${foo:$i:1}`有效，但速度很慢，这对于大字符串尤其明显，如下所示。

**我的想法是对Six**提出的方法进行扩展，其中涉及`read -n1`，并进行了一些更改以保留所有字符并为任何字符串正确工作：

```
while IFS='' read -r -d '' -n 1 char; do
        # do something with $char
done < <(printf %s "$string") 
```

这个怎么运作：

*   `IFS=''`- 将内部字段分隔符重新定义为空字符串可防止空格和制表符的剥离。在同一行执行它`read`意味着它不会影响其他 shell 命令。
*   `-r`- 表示“原始”，防止`read`将`\`行尾视为特殊的行连接字符。
*   `-d ''`- 将空字符串作为分隔符传递可防止`read`剥离换行符。实际上意味着使用空字节作为分隔符。`-d ''`等于`-d $'\0'`。
*   `-n 1`- 表示一次读取一个字符。
*   `printf %s "$string"`- 使用`printf`而不是`echo -n`更安全，因为`echo`将`-n`和`-e`视为选项。如果您将“-e”作为字符串传递，`echo`则不会打印任何内容。
*   `< <(...)`- 使用进程替换将字符串传递给循环。如果您使用 here-strings 代替 ( `done <<< "$string"`)，则会在末尾附加一个额外的换行符。此外，通过管道 ( `printf %s "$string" | while ...`) 传递字符串将使循环在子 shell 中运行，这意味着所有变量操作都是循环内的本地操作。

现在，让我们用一个巨大的字符串来测试性能。我使用以下文件作为源：
[https://www.kernel.org/doc/Documentation/kbuild/makefiles.txt](https://www.kernel.org/doc/Documentation/kbuild/makefiles.txt)
通过`time`命令调用以下脚本：

```
#!/bin/bash

# Saving contents of the file into a variable named `string'.
# This is for test purposes only. In real code, you should use
# `done < "filename"' construct if you wish to read from a file.
# Using `string="$(cat makefiles.txt)"' would strip trailing newlines.
IFS='' read -r -d '' string < makefiles.txt

while IFS='' read -r -d '' -n 1 char; do
        # remake the string by adding one character at a time
        new_string+="$char"
done < <(printf %s "$string")

# confirm that new string is identical to the original
diff -u makefiles.txt <(printf %s "$new_string") 
```

结果是：

```
$ time ./test.sh

real    0m1.161s
user    0m1.036s
sys     0m0.116s 
```

正如我们所看到的，它非常快。
接下来，我将循环替换为使用参数扩展的循环：

```
for (( i=0 ; i<${#string}; i++ )); do
    new_string+="${string:$i:1}"
done 
```

输出准确地显示了性能损失的严重程度：

```
$ time ./test.sh

real    2m38.540s
user    2m34.916s
sys     0m3.576s 
```

不同系统上的确切数字可能非常相似，但总体情况应该相似。

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2012-05-11T13:13:49.340

我只用 ascii 字符串对此进行了测试，但您可以执行以下操作：

```
while test -n "$words"; do
   c=${words:0:1}     # Get the first character
   echo character is "'$c'"
   words=${words:1}   # trim the first character
done 
```

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2015-01-11T17:01:27.917

也可以使用以下方法将字符串拆分为字符数组`fold`，然后对其进行迭代：

```
for char in `echo "这是一条狗。" | fold -w1`; do
    echo $char
done 
```

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2018-11-30T06:43:35.460

@chepner 的答案中的 C 风格循环在 shell function`update_terminal_cwd`中，`grep -o .`解决方案很聪明，但我很惊讶没有看到使用`seq`. 这是我的：

```
read word
for i in $(seq 1 ${#word}); do
  echo "${word:i-1:1}"
done 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2020-10-22T16:31:44.757

```
#!/bin/bash

word=$(echo 'Your Message' |fold -w 1)

for letter in ${word} ; do echo "${letter} is a letter"; done 
```

这是输出：

Y 是字母 o 是字母 u 是字母 r 是字母 M 是字母 e 是字母 s 是字母 s 是字母 a 是字母 g 是字母 e 是字母

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2020-12-31T14:25:31.220

sed 适用于 unicode

```
IFS=$'\n'
for z in $(sed 's/./&\n/g' <(printf '你好嗎')); do
 echo hello: "$z"
done 
```

输出

```
hello: 你
hello: 好
hello: 嗎 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2020-12-18T00:32:36.690

要在 POSIX 兼容的 shell 上迭代 ASCII 字符，您可以通过使用参数扩展来避免使用外部工具：

```
#!/bin/sh

str="Hello World!"

while [ ${#str} -gt 0 ]; do
    next=${str#?}
    echo "${str%$next}"
    str=$next
done 
```

或者

```
str="Hello World!"

while [ -n "$str" ]; do
    next=${str#?}
    echo "${str%$next}"
    str=$next
done 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-12-31T01:09:50.750

另一种方法，如果你不关心空白被忽略：

```
for char in $(sed -E s/'(.)'/'\1 '/g <<<"$your_string"); do
    # Handle $char here
done 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-03-22T23:31:03.420

另一种方法是：

```
Characters="TESTING"
index=1
while [ $index -le ${#Characters} ]
do
    echo ${Characters} | cut -c${index}-${index}
    index=$(expr $index + 1)
done 
```

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2018-02-26T21:59:58.807

我分享我的解决方案：

```
read word

for char in $(grep -o . <<<"$word") ; do
    echo $char
done 
```

* * *

## 回答 #15

> 赞同：-3
> 
> 时间：2018-06-25T13:34:18.433

```
TEXT="hello world"
for i in {1..${#TEXT}}; do
   echo ${TEXT[i]}
done 
```

`{1..N}`包含范围在哪里

`${#TEXT}`是字符串中的字母数

`${TEXT[i]}` - 您可以从字符串中获取字符，就像从数组中获取项目一样

# ruby - 用反斜杠单引号替换单引号

> ID：10551982
> 
> 赞同：47
> 
> 时间：2012-05-11T13:07:49.757
> 
> 标签：ruby, string

我有一个非常大的字符串，需要转义其中的所有单引号，所以我可以将它提供给 JavaScript 而不会打乱它。我无法控制外部字符串，因此无法更改源数据。

例子：

```
Cote d'Ivoir  -> Cote d\'Ivoir 
```

（实际字符串很长，包含很多单引号）

我正在尝试通过`gsub`在字符串上使用来实现这一点，但无法使其正常工作：

```
a = "Cote d'Ivoir"
a.gsub("'", "\\\'") 
```

但这给了我：

```
=> "Cote dIvoirIvoir" 
```

我也试过：

```
a.gsub("'", 92.chr + 39.chr) 
```

但得到了相同的结果；我知道这与正则表达式有关，但我从来没有得到那些。

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2012-05-11T13:43:48.027

%q 定界符在这里派上用场：

```
# %q(a string) is equivalent to a single-quoted string
puts "Cote d'Ivoir".gsub("'", %q(\\\')) #=> Cote d\'Ivoir 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2012-05-11T13:13:48.757

问题在于替换`\'`中的`gsub`意思是“匹配后的字符串的一部分”。

您可能最好使用块语法：

```
a = "Cote d'Ivoir"
a.gsub(/'/) {|s| "\\'"}
# => "Cote d\\'Ivoir" 
```

或哈希语法：

```
a.gsub(/'/, {"'" => "\\'"}) 
```

还有一个hacky解决方法：

```
a.gsub(/'/, '\#').gsub(/#/, "'") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-06-26T14:05:26.300

```
# prepare a text file containing [  abcd\'efg  ]
require "pathname"
backslashed_text = Pathname("/path/to/the/text/file.txt").readlines.first.strip
# puts backslashed_text => abcd\'efg

unslashed_text = "abcd'efg"
unslashed_text.gsub("'", Regexp.escape(%q|\'|)) == backslashed_text # true
# puts unslashed_text.gsub("'", Regexp.escape(%q|\'|)) => abcd\'efg 
```

# unit-testing - AngularJS 控制器单元测试 - 注入服务

> ID：10551986
> 
> 赞同：37
> 
> 时间：2012-05-11T13:07:56.827
> 
> 标签：unit-testing, angularjs

一个关于 AngularJS 单元测试的简单问题。我有一个使用简单服务的控制器（改编自 angular-seed 项目）

**服务.js：**

```
angular.module('myApp.services', []).value('version', '0.1'); 
```

**控制器.js：**

```
function MyCtrl1($s, version) {
  $s.version = version;
}
MyCtrl1.$inject = ["$scope","version"]; 
```

这在我的应用程序中效果很好。但是，我在单元测试框架工作中创建控制器时遇到了麻烦。我不知道我们如何注入“版本”服务（或创建实例）并将其传递给 $controller() 工厂 - 我假设这就是我想要做的？！这是最基本的规格：

**控制器规范.js**：

```
beforeEach(inject(function($rootScope, $controller) {
  scope = $rootScope.$new();
  // how about version service?
  ctrl = $controller(MyCtrl1, {$scope: scope, /* version: <where from?> */});
}));

it('Version should be 0.1 ...', function() {
    expect(scope.version).toBe('0.1');
}); 
```

运行测试工具产生： **>test.sh**

*...失败（3.00 ms）：错误：错误：未知提供者：versionProvider <-版本错误：未知提供者：versionProvider <-版本*

我用 $injector/$provider 和 module() 尝试了各种方法，但无济于事。我确信答案很简单，但我看不到。

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2012-05-12T07:29:51.030

只需添加`beforeEach(module('myApp.services'))`到您的描述块。这会将带有“版本”服务的服务模块加载到测试注入器中，并使其可用于您的测试。

# regex - 使用 grep 或 sed 计算文件中字符串的出现次数？

> ID：10551990
> 
> 赞同：1
> 
> 时间：2012-05-11T13:08:14.247
> 
> 标签：regex, sed

我有一个这样的文件：

```
[10/May/2012:00:00:03 +0000]
[10/May/2012:00:00:03 +0000]
[10/May/2012:00:00:03 +0000]
[10/May/2012:00:00:03 +0000]
[10/May/2012:00:00:06 +0000]
[10/May/2012:00:00:06 +0000]
... 
```

我希望生成一个 CSV 文件来计算每个日期时间的出现次数。

例如

```
[10/May/2012:00:00:03 +0000], 4
[10/May/2012:00:00:06 +0000], 2
... 
```

是否可以使用 sed 或 grep 或两者兼而有之？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T13:14:26.040

试试这个：

```
 sort inputFile | uniq -c | awk '{print $2", "$1}' 
```

或者

```
 sort inputFile | uniq -c | sed 's;^\s*\([0-9]*\)\s*\(.*\)$;\2, \1;' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-11T13:17:06.790

我不了解 sed，因为您在 sed 中没有哈希表，但是您可以使用 perl one liner 来完成...

```
perl -e 'while (<>) {chomp; $a{$_}++}; for $k (keys %a) { print "$k $a{$k}\n"; }' file.txt 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T14:12:21.993

这就是 awk 处理好的工作。这一切都可以在 1 行 awk 中完成，如下所示：

```
awk '{ts[$0]++;} END{for (var in ts) print var",", ts[var];}' file.txt 
```

**输出：**

```
[10/May/2012:00:00:03 +0000], 4
[10/May/2012:00:00:06 +0000], 2 
```

# c - 将 Web 服务器绑定到 80 端口而不是 root

> ID：10551991
> 
> 赞同：6
> 
> 时间：2012-05-11T13:08:13.893
> 
> 标签：c, linux

我已经用 C 编写了自己的 Web 服务器。如何在不成为 root 用户的情况下将其绑定到端口 80，从而不影响安全性（缓冲区溢出等）？

我应该简单地转发来自在端口 80 上运行的另一台“稳定”服务器的任何流量吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-11T13:10:33.820

使用转发代理确实是最简单和最推荐的解决方案。它还具有在非常无效的请求到达您自己编写的服务器之前过滤它们的优点。
如果您的应用程序将用户的 IP 地址用于某些事情，请记住从您的网络服务器使用的任何标头中检索它（`X-Client-IP`等等）。但是，只对真正来自您的网络服务器的请求这样做，否则用户可能会欺骗他们的 IP。您可以通过检查请求是否来自您的 IP 并在这种情况下仅检查标头来执行此操作，或者只是让您的应用程序绑定到 localhost。

另一种解决方案是授予程序该`CAP_NET_BIND_SERVICE`功能。这需要 root 才能使用`setcap cap_net_bind_service=ep /path/to/the/executable`- 由于该标志存储在文件系统属性中，因此在将文件复制到另一个系统或重新编译应用程序时它将丢失。

当然你也可以让你的程序 setuid root 然后在调用`bind()`. 但是，根据您的程序如何工作以及它的作用，这可能不是一个好主意 - 例如，如果它出于某种原因需要关闭并重新打开侦听套接字，则需要完全重新启动该进程。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-11T13:32:45.837

以 root身份调用然后放弃特权的另一种方法`bind()`是让 root 进程创建套接字并绑定它，然后使用`SCM_RIGHTS`消息通过 UNIX 域套接字连接将侦听套接字传递给非特权进程。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-11T13:15:43.507

如果要将服务器绑定到端口 80，则必须以 root 身份执行此操作，然后删除权限。

```
bind(sockfd, addr, addrlen);
/* process is running as root, drop privileges after bind*/
if (setgid(groupid) != 0)
    errx(1, "setgid: Unable to drop group privileges: %s", strerror(errno));
if (setuid(userid) != 0)
    errx(1, "setuid: Unable to drop user privileges: %S", strerror(errno)); 
```

> 如何在没有 root 身份的情况下将其绑定到端口 80，以免安全性受到损害（缓冲区溢出等）

不以 root 身份运行**不会**使您的系统更安全，它只是增加了另一个可利用的层。因此，与其考虑如何不以 root 身份运行，请确保您不使用任何已知不安全的函数，如`strcpy()`,`sprintf()`等，而是使用`strncpy()`,`snprintf()`等。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-12T06:45:57.740

众所周知，Unix 中 1024 以下的所有端口都需要 root 权限才能打开。在 Unix 系统上，您不希望以 root 权限运行的应用程序越少越好。这是并且将永远是一个很大的安全风险。

另一种方法是使用 iptables 将端口 80 的流量重定向到更无害的端口，如 8080。这里是关于如何设置它的[描述。](http://www.faqs.org/docs/iptables/targets.html#REDIRECTTARGET)

iptables 不是最容易设置的工具，但是一旦你掌握了它，它就会非常有用和强大（而且安全）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-02-08T23:39:37.287

我在这个问题上工作了很长一段时间，得出的结论是`systemd`+`iptables`是解决方案，而*不是*Capabilities，正如[这里详细阐述的那样](https://stackoverflow.com/a/21653102/1781435)。

# mysql - MySQL 用户变量和 SUM 函数

> ID：10551993
> 
> 赞同：5
> 
> 时间：2012-05-11T13:08:17.663
> 
> 标签：mysql

我正在尝试使用用户变量在 SELECT 查询中进行一些计算。这很好用，直到我开始使用`SUM`从连接表中收集数据之类的函数。

简化示例：

```
SET @a = 1;

SELECT @a := SUM(1 + 1) AS sum, @a 
```

结果：

```
+------+------+
| 总和 | @a |
+------+------+
| 2 | 1 |
+------+------+
```

我希望@a 在这里是 2。

其他示例：

```
SELECT @b := SUM(1 + 1) AS sum, @b; 
```

```
+------+------+
| 总和 | @b |
+------+------+
| 2 | 空 |
+------+------+
```

现在它是NULL，因为@b 在查询之前没有被设置。

似乎该变量没有被 SUM 函数的结果覆盖。有没有什么办法解决这一问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-11T13:32:38.690

如[文档中所述](http://dev.mysql.com/doc/refman/5.1/en/user-variables.html)：

作为一般规则，**您永远不应为用户变量赋值并在同一语句中读取该值**。您可能会得到预期的结果，但这不能保证。涉及用户变量的表达式的求值顺序是未定义的，并且可能会根据给定语句中包含的元素而改变；此外，不保证此顺序在 MySQL 服务器的版本之间是相同的。在`SELECT @a, @a:=@a+1, ...`中，您可能认为 MySQL 会`@a`先评估，然后再进行赋值。但是，更改语句（例如，通过添加`GROUP BY`、`HAVING`或`ORDER BY`子句）可能会导致 MySQL 选择具有不同评估顺序的执行计划。

到你问题的第二部分。您可以`@variable`在这样的查询中初始化您的（首先评估子查询）：

```
SELECT @b := SUM(1 + 1) AS sum, @b FROM (SELECT @b:=0) b 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T13:34:04.043

它连接到表达式评估。在您的情况下，您可以使用子查询 -

```
SET @a = 1;
SELECT sum, @a FROM
  (SELECT @a := SUM(1 + 1) AS sum, @a) t

+------+------+
| sum  | @a   |
+------+------+
|    2 |    2 |
+------+------+ 
```

更多信息 -[用户定义的变量](http://dev.mysql.com/doc/refman/5.1/en/user-variables.html)。

> 作为一般规则，您永远不应为用户变量赋值并在同一语句中读取该值。您可能会得到预期的结果，但这不能保证。涉及用户变量的表达式的求值顺序是未定义的，并且可能会根据给定语句中包含的元素而改变；此外，不保证此顺序在 MySQL 服务器的版本之间是相同的。在 SELECT @a, @a:=@a+1, ... 中，您可能认为 MySQL 会先评估 @a，然后再进行赋值。但是，更改语句（例如，通过添加 GROUP BY、HAVING 或 ORDER BY 子句）可能会导致 MySQL 选择具有不同评估顺序的执行计划。

# java - 如何将 JScrollPane Layout 设置为与 JTable 相同？

> ID：10551995
> 
> 赞同：3
> 
> 时间：2012-05-11T13:08:18.287
> 
> 标签：java, swing, jtable, jscrollpane

```
Tabel1.setModel(new DefaultTableModel(x,y));
JScrollPane pane = new JScrollPane(Tabel1); 
```

当我运行程序时，滚动窗格看起来比表格大。如何使滚动窗格布局与表格相同？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-11T13:27:14.453

*   `how i can make scrollpane layout the same of table??`

如果您`JTable`只包含几行

```
table.setPreferredScrollableViewportSize(table.getPreferredSize()); 
```

*   `Tabel1.setModel(new DefaultTableModel(x,y));`

正确使用[Java 命名约定](http://java.about.com/od/javasyntax/a/nameconventions.htm)，然后不是`Tabel1`但是`tabel1`

# javascript - selectmenu ('refresh', true)

> ID：10551996
> 
> 赞同：17
> 
> 时间：2012-05-11T13:08:20.690
> 
> 标签：javascript, zend-framework, jquery-mobile, select-menu

I get form from zend framework site and put it in response in new file in function written by jquery mobile, but I get this error:

> uncaught exception: cannot call methods on selectmenu prior to initialization; attempted to call method 'refresh' .

Code of function this file:

```
 function addItem(id) {
        $.ajax({
            url:'http://zf.darina.php.nixsolutions.com/order/index/create-order-mobile',
            dataType:"jsonp",
            data:{id_good:id},
            success:function (resp) {

                console.log(resp);
                $('.product-table').empty();

                $('.product-table').append(resp.prod);
                $('.product-table').append(resp.form);
                $('.add-order-btn').button();

                $('.mob-size').selectmenu('refresh', true);

                $('#block').page();
            }
        })
    } 
```

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2012-10-09T15:43:11.693

Force initialize the selectmenu(s) first:

```
$('.mob-size').selectmenu(); // Initializes
$('.mob-size').selectmenu('refresh', true); 
```

or use this for short

```
$('.mob-size').selectmenu().selectmenu('refresh', true); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-06-06T15:04:47.623

In my case, if I was not initializing the select before invoking the 'disable' method I got the error, while if I was initializing it, the select didn't disable but duplicate itself - I tried to select the object by TAG NAME instead of by CLASS or ID NAME,

```
$('select').selectmenu('disable'); 
```

instead of

```
$('.select-class-name').selectmenu('disable'); 
```

and it worked without forced initialization

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-05-19T09:02:03.033

you do this in your custom refresh delegation function:

```
var w = $("#yourinput");
if( w.data("mobile-selectmenu") === undefined) {
  // not initialized yet, lets do so
  w.selectmenu();
}
w.selectmenu("refresh",true); 
```

according to [enhancement resolution here](https://github.com/jquery/jquery-mobile/issues/4746#issuecomment-10369891)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-04-17T16:10:29.373

I found the same problem, but a more involved solution. When jqm wraps the `select` element, it puts it in a `<span>` element with the same class list as the `select` element. I changed my reference to it so that instead of reading:

```
row.find(".selectCompletion").selectmenu("disable"); 
```

it now reads:

```
row.find("select.selectCompletion").selectmenu("disable"); 
```

Specifying that jquery should only find the `select` element matching the class name, rather than all elements in .row that match the class name, solved the problem.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-12-05T09:54:20.697

This happened to me when **cloning** existing select element in order to **duplicate** the original section multiple times.

Calling '**refresh**' for the original element, worked fine, while calling it for the cloned sections was **leading to the error appearing in the question**.

However, calling **selectmenu()** was causing a 'vandalisation' to the form, as can be seen in the following image:

![](../Images/7bf422bb09374e45cfd008552bf05061.png)

Explanation: top = original. bottom = vandalised cloned element right after calling selectmenu.

**Solution:**

The following code solved this vandalisation problem:

cloned_elem.find('select[name=MyClass]')**.selectmenu().selectmenu("destroy").selectmenu()**;

This is not an ideal solution because we must call the first selectmenu() in order to call selectmenu("destroy"), so I would be glad to hear of a cleaner solution.