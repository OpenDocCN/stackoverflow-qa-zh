# StackOverflow 问答 000418000-000418999

# c# - 如何禁用 TabControl 中的选项卡？

> ID：418006
> 
> 赞同：87
> 
> 时间：2009-01-06T20:30:44.247
> 
> 标签：c#, winforms, tabcontrol

有没有办法禁用[TabControl](https://msdn.microsoft.com/en-us/library/system.windows.forms.tabcontrol(v=vs.110).aspx)中的选项卡？

* * *

## 回答 #1

> 赞同：92
> 
> 时间：2009-01-06T20:38:11.080

将 TabPage 转换为控件，然后将 Enabled 属性设置为 false。

```
((Control)this.tabPage).Enabled = false; 
```

因此，标签页的标题仍将启用，但其内容将被禁用。

* * *

## 回答 #2

> 赞同：79
> 
> 时间：2009-01-06T20:41:09.157

[TabPage](https://msdn.microsoft.com/en-us/library/system.windows.forms.tabpage(v=vs.110).aspx)类隐藏了 Enabled 属性。这是故意的，因为它存在一个尴尬的 UI 设计问题。基本问题是禁用页面不会同时禁用选项卡。如果尝试通过使用 Selecting 事件禁用选项卡来解决此问题，那么当 TabControl 只有一页时它不起作用。

如果您不关心这些可用性问题，请记住该属性仍然有效，它只是对 IntelliSense 隐藏。如果 FUD 不舒服，那么您可以简单地这样做：

```
public static void EnableTab(TabPage page, bool enable) {
    foreach (Control ctl in page.Controls) ctl.Enabled = enable;
} 
```

* * *

## 回答 #3

> 赞同：71
> 
> 时间：2012-10-11T14:31:37.650

您可以简单地使用：

```
tabPage.Enabled = false; 
```

此属性未显示，但它可以正常工作。

您可以对 Selecting 事件进行编程，`TabControler`以使其无法更改为不可编辑的选项卡：

```
private void tabControler_Selecting(object sender, TabControlCancelEventArgs e)
{
    if (e.TabPageIndex < 0) return;
    e.Cancel = !e.TabPage.Enabled;
} 
```

* * *

## 回答 #4

> 赞同：53
> 
> 时间：2009-01-06T20:44:54.453

您可以注册“选择”事件并取消导航到标签页：

```
private void tabControl1_Selecting(object sender, TabControlCancelEventArgs e)
{
    if (e.TabPage == tabPage2)
        e.Cancel = true;
} 
```

另一个想法是将标签页上的所有控件放在一个Panel控件中并禁用该面板！笑脸

您还可以从 tabControl1.TabPages 集合中删除标签页。那将隐藏标签页。

致谢[littleguru @ Channel 9](http://channel9.msdn.com/forums/TechOff/251226-disable-tabpage-in-windows-application/ "小大师")。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2009-07-29T10:44:31.013

大概，您希望在选项卡控件中看到选项卡，但您希望它被“禁用”（即，灰色且不可选择）。对此没有内置支持，但您可以覆盖绘图机制以提供所需的效果。

[此处提供](https://web.archive.org/web/20131102065816/http://tutorials.csharp-online.net/Disabling_Tab_Pages)了如何执行此操作的示例。

神奇之处在于提供的源代码片段和 DisableTab_DrawItem 方法：

```
this.tabControl1.DrawMode = TabDrawMode.OwnerDrawFixed;
this.tabControl1.DrawItem += new DrawItemEventHandler( DisableTab_DrawItem ); 
```

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2012-09-30T01:16:39.413

扩展 Cédric Guillemette 的答案，在您禁用`Control`：

```
((Control)this.tabPage).Enabled = false; 
```

...然后您可以将`TabControl`'`Selecting`事件处理为：

```
private void tabControl_Selecting(object sender, TabControlCancelEventArgs e)
{
    e.Cancel = !((Control)e.TabPage).Enabled;
} 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2011-11-20T19:23:32.303

这将删除标签页，但您需要在需要时重新添加它：

```
tabControl1.Controls.Remove(tabPage2); 
```

如果您以后需要它，您可能希望在删除之前将其存储在临时标签页中，然后在需要时重新添加它。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2009-01-06T20:42:01.603

唯一的方法是捕捉`Selecting`事件并防止选项卡被激活。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-06T20:47:45.927

我不得不在不久前处理这个问题。我从 TabPages 集合中删除了 Tab（我认为就是这样），并在条件发生变化时将其重新添加。但这只是在 Winforms 中，我可以保留标签直到我再次需要它。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2016-12-19T20:26:42.093

最棘手的方法是使其父级等于 null （使选项卡单独没有父级）：

```
 tabPage.Parent = null; 
```

当您想将其退回时（将在页面收集结束时退回）：

```
tabPage.Parent = tabControl; 
```

如果您想将其返回到您可以使用的页面中的特定位置：

```
tabControl.TabPages.Insert(indexLocationYouWant, tabPage); 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-06T20:44:36.840

我过去删除了标签页以防止用户单击它们。这可能不是最好的解决方案，因为他们可能需要查看标签页是否存在。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-07-16T22:45:02.370

使用事件和选项卡控件的属性，您可以在需要时启用/禁用您想要的。我使用了一个 bool，它可用于使用 tabControl 的 mdi 子表单类中的所有方法。

请记住，每次单击任何选项卡时都会触发选择事件。对于大量选项卡，“CASE”可能比一堆 if 更容易使用。

```
public partial class Form2 : Form
    {
        bool formComplete = false;

        public Form2()
        {
            InitializeComponent();

        }

        private void button1_Click(object sender, EventArgs e)
        {

            formComplete = true;
            tabControl1.SelectTab(1);

        }

        private void tabControl1_Selecting(object sender, TabControlCancelEventArgs e)
        {
            if (tabControl1.SelectedTab == tabControl1.TabPages[1])
            {

                tabControl1.Enabled = false;

                if (formComplete)
                {
                    MessageBox.Show("You will be taken to next tab");
                    tabControl1.SelectTab(1);

                }
                else
                {
                    MessageBox.Show("Try completing form first");
                    tabControl1.SelectTab(0);
                }
                tabControl1.Enabled = true;
            }
        }
    } 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2012-12-23T03:20:29.287

您可以通过标签页来完成：tabPage1.Hide()、tabPage2.Show() 等。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2014-02-14T21:29:51.397

用户无法单击选项卡进行导航，但他们可以使用两个按钮 (`Next`和`Back`)。//如果不满足条件，用户不能继续下一个。

```
private int currentTab = 0;

private void frmOneTimeEntry_Load(object sender, EventArgs e)
{
    tabMenu.Selecting += new TabControlCancelEventHandler(tabMenu_Selecting);
}

private void tabMenu_Selecting(object sender, TabControlCancelEventArgs e)
{
    tabMenu.SelectTab(currentTab);
}

private void btnNextStep_Click(object sender, EventArgs e)
{
    switch(tabMenu.SelectedIndex)
    {
        case 0:
            //if conditions met GoTo
        case 2:
            //if conditions met GoTo
        case n:
            //if conditions met GoTo
    {
    CanLeaveTab:
    currentTab++;
    tabMenu.SelectTab(tabMenu.SelectedIndex + 1);
    if (tabMenu.SelectedIndex == 3)
        btnNextStep.Enabled = false;
    if (btnBackStep.Enabled == false)
        btnBackStep.Enabled = true;

    CannotLeaveTab:
        ;
}

private void btnBackStep_Click(object sender, EventArgs e)
{
    currentTab--;
    tabMenu.SelectTab(tabMenu.SelectedIndex - 1);
    if (tabMenu.SelectedIndex == 0)
        btnBackStep.Enabled = false;
    if (btnNextStep.Enabled == false)
        btnNextStep.Enabled = true;
} 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2015-05-22T12:02:25.903

我已经这样解决了这个问题：我有 3 个选项卡，如果他没有登录，我想将用户保留在第一个选项卡上，所以在我写的 TabControl 的 SelectingEvent 上

```
if (condition) { TabControl.Deselect("2ndPage"); TabControl.Deselect("3dPage"); } 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2016-08-15T00:18:32.820

tabControl.TabPages.Remove(tabPage1);

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2020-04-02T23:32:41.490

这是一个老问题，但有人可能会从我的补充中受益。我需要一个 TabControl 来连续显示隐藏的选项卡（在当前选项卡上执行操作之后）。因此，我创建了一个快速类来继承并在加载时调用 HideSuccessive()：

```
public class RevealingTabControl : TabControl
{
    private Action _showNextRequested = delegate { };

    public void HideSuccessive()
    {
        var tabPages = this.TabPages.Cast<TabPage>().Skip(1);
        var queue = new ConcurrentQueue<TabPage>(tabPages);
        tabPages.ToList().ForEach(t => t.Parent = null);
        _showNextRequested = () =>
        {
            if (queue.TryDequeue(out TabPage tabPage))
                tabPage.Parent = this;
        };
    }

    public void ShowNext() => _showNextRequested();
} 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2021-08-10T22:09:20.747

XtraTabPage.PageEnabled 属性允许您禁用某些页面。

* * *

## 回答 #19

> 赞同：-1
> 
> 时间：2015-02-26T06:51:59.923

如果我们在表单加载事件中写入`this.tabpage.PageEnabled = false`，标签页将被禁用。

* * *

## 回答 #20

> 赞同：-1
> 
> 时间：2017-07-14T12:26:36.503

假设您有以下控件：

名称为 tcExemple 的 TabControl。

名称为 tpEx1 和 tpEx2 的标签页。

尝试一下：

将 TabPage 的 DrawMode 设置为 OwnerDrawFixed；在 InitializeComponent() 之后，通过添加以下代码确保 tpEx2 未启用：

```
((Control)tcExemple.TabPages["tpEx2").Enabled = false; 
```

将以下代码添加到 Selection tcExemple 事件：

```
private void tcExemple_Selecting(object sender, TabControlCancelEventArgs e)
    {
        if (!((Control)e.TabPage).Enabled)
        {
            e.Cancel = true;
        }
    } 
```

附加到 tcExemple 这个代码的 DrawItem 事件：

```
private void tcExemple_DrawItem(object sender, DrawItemEventArgs e)
    {
        TabPage page = tcExemple.TabPages[e.Index];
        if (!((Control)page).Enabled)
        {
            using (SolidBrush brush = new SolidBrush(SystemColors.GrayText))
            {
                e.Graphics.DrawString(page.Text, page.Font, brush, e.Bounds);
            }
        }
        else
        {
            using (SolidBrush brush = new SolidBrush(page.ForeColor))
            {
                e.Graphics.DrawString(page.Text, page.Font, brush, e.Bounds);
            }
        }
    } 
```

这将使第二个选项卡不可点击。

* * *

## 回答 #21

> 赞同：-1
> 
> 时间：2018-06-17T15:01:11.190

我找不到这个问题的适当答案。似乎没有禁用特定选项卡的解决方案。我所做的是将特定选项卡传递给变量，并在`SelectedIndexChanged`事件中将其放回`SelectedIndex`：

```
//variable for your specific tab 
int _TAB = 0;

//here you specify your tab that you want to expose
_TAB = 1;
tabHolder.SelectedIndex = _TAB;

private void tabHolder_SelectedIndexChanged(object sender, EventArgs e)
{
    if (_TAB != 0) tabHolder.SelectedIndex = _TAB;
} 
```

因此，您实际上并没有禁用该选项卡，但是当单击另一个选项卡时，它始终会将您返回到选定的选项卡。

* * *

## 回答 #22

> 赞同：-1
> 
> 时间：2020-11-20T18:15:34.023

在 C# 7.0 中，有一个名为**Pattern Matching**的新功能。**您可以通过Type Pattern**禁用所有选项卡。

```
foreach (Control control in Controls)
{
    // the is expression tests the variable and 
    // assigned it to a new appropriate variable type
    if (control is TabControl tabs)
    {
        tabs.Enabled = false;
    }
} 
```

* * *

## 回答 #23

> 赞同：-2
> 
> 时间：2016-01-24T16:00:34.150

采用：

```
 tabControl1.TabPages[1].Enabled = false; 
```

通过编写此代码，标签页不会被完全禁用（无法选择），但它的内部内容将被禁用，我认为这可以满足您的需求。

* * *

## 回答 #24

> 赞同：-2
> 
> 时间：2018-04-21T10:46:28.777

解决方案非常简单。

删除/评论此行

```
this.tabControl.Controls.Add(this.YourTabName); 
```

在 MainForm.cs 的 IntializeComponent() 方法中

* * *

## 回答 #25

> 赞同：-4
> 
> 时间：2009-09-02T05:46:15.063

```
MyTabControl.SelectedTab.Enabled = false; 
```

# perl - 如何回读 Data::Dumper 的输出？

> ID：418027
> 
> 赞同：5
> 
> 时间：2009-01-06T20:35:52.130
> 
> 标签：perl, persistence, data-dumper

假设我有一个使用创建的文本文件[`Data::Dumper`](http://perldoc.perl.org/Data/Dumper.html)，大致如下：

```
my $x = [ { foo => 'bar', asdf => undef }, 0, -4, [ [] ] ]; 
```

我想读回那个文件然后`$x`回来。我试过这个：

```
my $vars;
{
  undef $/;
  $vars = <FILE>;
}

eval $vars; 
```

但它似乎没有工作 -`$x`不仅没有定义，当我尝试使用它时，我收到一个警告

> 全局符号 $x 需要明确的包名。

这样做的正确方法是什么？（是的，我知道它很丑。它是一个快速实用的脚本，而不是生命支持系统。）

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-06T20:40:33.260

这是一个提供几个不同选项的线程：*[Undumper](http://www.perlmonks.org/?node_id=92509)*

如果您只是在寻找数据持久性，那么 Storable 模块可能是您最好的选择。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-06T23:03:14.640

正如其他人已经说过的那样，您最好以更好的序列化格式存储数据：

*   [可存储](http://search.cpan.org/dist/Storable/)- 这既快速又简单，但相当特定于 Perl（但可以轻松满足您在相对不重要的脚本中快速解决方案的需求）
*   [YAML](http://www.yaml.org/)，使用[YAML](http://search.cpan.org/dist/YAML/)模块或[YAML::Tiny](http://search.cpan.org/dist/YAML-Tiny/)或[YAML::Any](http://search.cpan.org/dist/YAML-Any/)作为包装器，以利用系统上可用的任何 JSON 模块
*   [JSON](http://www.json.org/)，使用[JSON](http://search.cpan.org/dist/JSON/)模块或[JSON::XS](http://search.cpan.org/dist/JSON-XS/)以提高速度（或[JSON::Any](http://search.cpan.org/dist/JSON-Any/)作为包装器以利用系统上可用的任何 JSON 模块）
*   XML，使用[XML-Simple](http://search.cpan.org/dist/XML-Simple/)模块或其他 XML 模块之一。

就个人而言，我认为我的目标是 YAML 或 JSON ......你不能比以下更容易：

`my $data = YAML::Any::LoadFile($filename);`

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-06T21:56:47.943

默认情况下，eval 无法解析 Data::Dumper 输出，尤其是当被转储的数据结构在某种程度上是循环的时。但是，您可以设置

```
$Data::Dumper::Purity = 1; 
```

或者

```
$obj->Purity(1); 
```

`obj`Data::Dumper 对象在哪里。这些中的任何一个都会导致 Data::Dumper 产生可以被 eval 解析的输出。

有关所有详细信息，请参阅[CPAN 的 Data::Dumper 文档。](http://search.cpan.org/~ilyam/Data-Dumper-2.121/Dumper.pm)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-01-06T21:39:18.227

正如 Rich 所说，您可能不想使用 Data::Dumper 进行持久性，而是使用类似**Storable**的东西。

但是，要回答所提出的问题... IIRC，Data::Dumper 没有将您的变量声明为`my`，那么您是否以某种方式自己这样做？

为了能够`eval`将数据重新输入，变量不需要`my`在 eval 中。如果您的文本文件包含以下内容：

```
$x = [ { foo => 'bar', asdf => undef }, 0, -4, [ [] ] ]; 
```

那么这将起作用：

```
my $vars;
{
  undef $/;
  $vars = <FILE>;
}

my $x;    
eval $vars;
print $x; 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-07T14:55:42.970

如果你想保留一些简单易读的东西，只需使用[`Data::Dump`](http://search.cpan.org/~ilyam/Data-Dumper-2.121/Dumper.pm)模块而不是`Data::Dumper`. 基本上，它是`Data::Dumper`正确的——它产生了有效的 Perl 表达式，准备好赋值，而没有创建所有那些奇怪`$VAR1`的`$VAR2`等变量。

然后，如果您的代码如下所示：

```
my $x = [ { foo => 'bar', asdf => undef }, 0, -4, [ [] ] ]; 
```

使用以下方法保存：

```
use Data::Dump "pp";
open F, ">dump.txt";
print F pp($x); 
```

这会生成一个`dump.txt`看起来像（至少在我的 PC 上）的文件：

```
[{ asdf => undef, foo => "bar" }, 0, -4, [[]]] 
```

加载它使用：

```
open F, "dump.txt";
my $vars;
{ local $/ = undef; $vars = <F>; }
my $x = eval $vars; 
```

注意

1.  如果您不想将赋值`$/`放在它自己的块中，您应该使用`local`以确保它的值实际上在块的末尾恢复；和
2.  的结果`eval()`需要分配给`$x`.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-06T17:18:15.053

这个片段很短并且对我有用（我正在阅读一个数组）。它从第一个脚本参数中获取文件名。

```
 # Load in the Dumper'ed library data structure and eval it
my $dsname = $ARGV[0];
my @lib = do "$dsname"; 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-06T21:40:23.933

您确定该文件是由 Data::Dumper 创建的吗？里面不应该`my`有。

其他一些选项是 Storable、YAML 或 DBM::Deep。我在[Mastering Perl](http://oreilly.com/catalog/9780596527242/)的“持久性”一章中浏览了一些示例。

祝你好运， ：）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-06T22:00:07.187

我想你想把

```
our $x; 
```

在访问 x 之前进入您的代码。这将满足严格的错误检查。

话虽如此，我加入了其他声音的建议 Storable。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-06T22:13:55.503

这对我来说很好：

写出：

```
open(my $C, qw{>}, $userdatafile) or croak "$userdatafile: $!";
use Data::Dumper;
print $C Data::Dumper->Dump([\%document], [qw(*document)]);
close($C) || croak "$userdatafile: $!"; 
```

读入：

```
open(my $C, qw{<}, $userdatafile) or croak "$userdatafile: $!";
local $/ = $/;
my $str = <$C>;
close($C) || croak "$userdatafile: $!";
eval { $str };
croak $@ if $@; 
```

# .net - Visual Studio - 重写/寿命

> ID：418028
> 
> 赞同：0
> 
> 时间：2009-01-06T20:37:08.353
> 
> 标签：.net, visual-studio, upgrade

仅供参考 - 我是几年前搬到 .NET 世界的大型机制造商，还有很多东西要学。

我们正在考虑将 Visual FoxPro 应用程序重写为 .Net（很可能是 VB）。该项目预计4-6年。

我们现在处于初步设计的早期阶段。我在 VS 2010 上看到了很多来自 Microsoft 的信息。我们应该关注 2005/2008 年有什么问题吗？或者，这个 SOP 让 MS 这么早就开始推未来的产品了吗？是否值得等待 2010 年开始任何编码？无论如何，功能设计可能不会在年底（2009 年）完成，我们总是可以在 VS-2005 中做模型。

其次，FoxPro 和 VB6 同舟共济；不受支持，但现在还活着。迁移到 .NET 是否明智？VB? C＃？MS 是否会决定迁移到 VS 20xx 需要再次完全重写旧代码（VB6）？或者他们可能会为下一个“伟大的”事物（foxpro）消除 VB.net 或 C#.net？或者 .NET 框架的生命周期如何？在其他事情出现之前它是否也受到限制？

我们有一个相当大的应用程序，经过多年的创可贴、更新和法律变更，它已经成为一个需要转换的 PIA。我们想要一个稳定数十年的新平台，以便轻松向上迁移。从现在起 50 年后是否有*任何开发代码？*100？

自从他们使用笔和纸以来，应用程序的核心逻辑并没有太大变化。如果需要每 10-20 年进行一次，现在很难证明多年重写的合理性。FoxPro 应用程序于 1991 年开始开发，于 1999 年上线，现在将用另一种语言重写。

与 Win Apps 的流动性相比，大型机很容易。

以下是一些高级规格。

*   是给政府机关的。
*   它包含高度敏感的数据。
*   基于网络的不是一种选择。
*   它只是一个 MS Windows 应用程序。
*   将从 FoxPro 表迁移到 SQL Server 2005/8/10（无论是当前版本）

我知道那些有工作水晶球的人不会回复，但是*社区*对编程语言稳定下来并长期可用/稳定的可能性有什么看法？

感谢您对此的意见，我很感激他们。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-06T20:49:24.787

我在哪里可以给我这些轻松的政府工作之一？？？？

无论如何，是的，早期宣布和演示操作系统、开发工具等是微软的 SOP，这并不意味着当前的工具有任何问题。从 VS2003 开始​​，如果愿意的话，将项目迁移到新版本的开发环境总是非常容易的，所以当您准备好编写代码时，只需从当前的任何 VS 版本开始。

.NET 将在您编写本文时发生变化，但它们在保持与先前框架版本的向后兼容性方面非常出色，因此这也不是任何问题。

如果您无论如何都要重写，我会推荐 C# over VB.Net。VB.Net 是一种让 VB 程序员进入 .Net 的创可贴语言，有时对兼容性很有用，但我不知道您为什么要使用它开始新的开发。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T20:41:37.220

对于您所描述的长寿命应用程序，Windows 确实不是一个合适的平台。这就是为什么大型机/大型铁供应商虽然比以前弱，但仍然存在。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-06T21:00:50.973

很明显，没有人能准确地说出未来所有最新/最伟大的东西会发生什么。如果您是 80 年代和 90 年代的 Mac OS 程序员，如果与 VB6 程序员不完全一样，您可能也会有点恼火。

从长远来看，.NET 和 VB.NET/C# 是一个可行的提议。它们与经典的 VB 和 FoxPro 之类的东西处于不同的情况，因为它们运行在一个使用许多不同语言的虚拟机中。因此，即使出现了一种新的更流行的以 .NET 为目标的语言，您的旧代码仍然可以运行。

当您说您想要一个桌面应用程序而不是基于 Web 的应用程序时，这是一个令人担忧的问题，因为 Windows 窗体（传统的类似 VB 的用户界面框架）尚未受到 Microsoft 的太多关注。它不会像我说的那样消失，但未来不会有太多改进。如果您像您所说的那样开发一个庞大的永不改变的应用程序，那么这对您来说可能不是问题。

替代的 .NET 用户界面框架是 WPF，它是最新最好的。由于其非凡的资源使用率，因此对其长期可行性存在疑问。到目前为止，只有一个重要的桌面应用程序使用它（微软自己的 WPF 设计工具 Expression Blend）并试图说服人们 WPF 确实是可行的，他们承诺在 Visual Studio 2010 中使用 WPF 用于部分用户界面，如编辑器. 即便如此，我还是很难为您描述的应用程序推荐 WPF - 这太冒险了。

As to your question about Visual Studio versions, VS2005 wasn't very good (rushed out the door eary with some serious performance issues). VS2008 however is a fine release and you would be well advised to start your project with that - there is no guarantee that 2010 will be better (or even as good due to the WPF factor). Teams tend to use Visual Studio versions for a long time (my employer is still using 2003 for some work!) and all versions peacefully co-exist on a single machine.

And yes, Microsoft does tend to talk about dev tools well in advance of when they are available. Apparently the "osbourne effect" doesn't apply to developer tools :)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-08-29T18:11:58.457

I've heart from my partners- there is an engine (team from Ukraine has it) to convert VFP application into the dot net, that will work with an existing DBF files. So - instead rewriting - you just run the convertor (one time deal) and instead FoxPro apps, you'll have dot net. If you’d like more detail please let me know

# svn - 您可以更改客户端登录到哪个 subversion 存储库吗？

> ID：418038
> 
> 赞同：0
> 
> 时间：2009-01-06T20:40:06.693
> 
> 标签：svn, tortoisesvn

在我的笔记本电脑上，我在使用 tortoise svn 访问我的 svn 存储库（例如 svn://computername/repository）时使用计算机的名称。但是，当我在网络之外时，我需要使用 Internet 可寻址名称（例如 svn://computername.dyndns.com/repository）。我想继续这样做，这样当我在家时，我的签入和更新会尽可能快，并且不依赖于另一台服务器的启动（dyndns）。有没有办法使用我已经签出的相同文件夹结构并来回更改名称？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-06T20:46:49.597

是的。在 TortoiseSVN 右键菜单下，选择“重新定位”。您可以从那里更改存储库的 URL。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T20:44:35.513

您应该能够在网络内部和外部使用完全限定的 URL（例如 svn://computername.dyndns.com/repository），而无需进行任何更改。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-06T20:45:23.437

好吧，如果您想将其保存在集中位置以便其他人可以访问，则必须像您一样保留远程服务器。

如果您是唯一的用户，您可以在自己的机器上设置一个 svn 存储库。

瓶颈是远程访问，如果您必须保持它，更改您用来访问的名称不会有任何区别。

最后，如果问题只是重新定位，您可以设置网络 DNS 以将 computername.dyndns.com 指向计算机名，并始终使用 dyndns url 访问。

# c++ - 服务 DLL 的 CPU 利用率？

> ID：418039
> 
> 赞同：0
> 
> 时间：2009-01-06T20:40:18.783
> 
> 标签：c++, windows, cpu, utilization

我需要找出服务 DLL 的 CPU 利用率。我查看了现有示例，我们可以找到进程的 CPU 利用率。

我认为 DLL 将由 services.exe 加载。那么是否可以通过DLL找出CPU利用率。

我在 Windows 平台上使用 C++ 工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-07T00:34:23.677

复制 svchost.exe 并将其命名为 dbgsrvc.exe；然后，进入注册表中的服务条目（例如 HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Eventlog），并将 ImagePath 更改为使用 dbgsrvc 而不是服务。这样，您将服务隔离到自己的进程中，这样您就可以获得性能计数器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T21:08:32.953

Windows 中唯一可用的性能计数器位于进程级别。服务 DLL 是什么意思？我所知道的唯一 service.DLL 是木马病毒。

但是您是在谈论通用服务 DLL 还是特定文件？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T00:21:04.280

试试这个：

1.  使用 Perfmon 记录进程对象的所有计数器。
2.  在测试之前或之后，`tasklist /svc`从命令控制台运行。查看托管服务的 svchost.exe 的输出。注意这个进程的PID。
3.  测试后，使用 Perfmon 加载您的日志文件，为步骤 2 中的进程添加进程度量。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-01-07T01:19:10.593

您应该监视托管 dll 的进程。

# c# - 添加 WCF 服务时 VS2008 崩溃

> ID：418048
> 
> 赞同：0
> 
> 时间：2009-01-06T20:42:44.237
> 
> 标签：c#, visual-studio, wcf

我有一个托管 WCF 服务的控制台应用程序：

*更新了此代码以运行 app.config 文件，而不是以编程方式对其进行初始化*

```
Uri baseAddress = new Uri("http://localhost:8000/ChatServer/Service");
        ServiceHost myHost = new ServiceHost(typeof(ClientServerChat.ChatServer), baseAddress);

            myHost.AddServiceEndpoint(typeof(IChat), new WSHttpBinding(), "ChatService");
            ServiceMetadataBehavior mb = new ServiceMetadataBehavior();
            ServiceBehaviorAttribute attrib = (ServiceBehaviorAttribute)myHost.Description.Behaviors[0];
            attrib.IncludeExceptionDetailInFaults = true;
            mb.HttpGetEnabled = true;
            myHost.Description.Behaviors.Add(mb);

            myHost.Open(); 
```

控制台应用程序编译并运行。svcutil 运行完美。

*svcutil 完美运行新服务代码并生成客户端代码和输出文件*

*我通过 Visual Studio 命令提示符调用 svcutil，如下所示：svcutil.exe [http://localhost:8000/ChatServer/Service](http://localhost:8000/ChatServer/Service)*

它生成这个 output.config：

```
<?xml version="1.0" encoding="utf-8"?>
  <configuration>
   <system.serviceModel>
     <bindings>
       <wsHttpBinding>
         <binding name="WSHttpBinding_IChat" closeTimeout="00:01:00" openTimeout="00:01:00"
        receiveTimeout="00:10:00" sendTimeout="00:01:00" bypassProxyOnLocal="false"
        transactionFlow="false" hostNameComparisonMode="StrongWildcard"
        maxBufferPoolSize="524288" maxReceivedMessageSize="65536"
        messageEncoding="Text" textEncoding="utf-8" useDefaultWebProxy="true"
        allowCookies="false">
           <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="16384"
          maxBytesPerRead="4096" maxNameTableCharCount="16384" />
           <reliableSession ordered="true" inactivityTimeout="00:10:00"
          enabled="false" />
           <security mode="Message">
             <transport clientCredentialType="Windows" proxyCredentialType="None"
            realm="" />
             <message clientCredentialType="Windows" negotiateServiceCredential="true"
            algorithmSuite="Default" establishSecurityContext="true" />
           </security>
         </binding>
       </wsHttpBinding>
     </bindings>
    <client>
       <endpoint address="http://localhost:8000/ChatServer/Service/ChatService"
      binding="wsHttpBinding" bindingConfiguration="WSHttpBinding_IChat"
      contract="IChat" name="WSHttpBinding_IChat">
         <identity>
           <userPrincipalName value="Bedroom-PC\Roberto" />
         </identity>
      </endpoint>
     </client>
   </system.serviceModel>
 </configuration> 
```

除了捆绑的客户端代码（与输出文件位于同一目录中，我应该添加），我应该能够使用以下命令调用服务：

```
ChatClient client = new ChatClient(); 
```

*svcutil 的新输出（代码和配置）仍会引发此异常。*

但它抛出一个异常说：

“在 ServiceModel 客户端配置部分中找不到引用合同‘IChat’的默认端点元素。这可能是因为找不到您的应用程序的配置文件，或者因为在客户端元素中找不到与此合同匹配的端点元素。”

有趣的是，将相同的服务引用添加到客户端项目时，Visual Studio 2008 会崩溃。

*VS2008 仍然会因更新的代码而崩溃。*

它会找到服务，得到所有的操作等等。当我单击添加时，它会崩溃。

任何人都知道发生了什么？

提前致谢

罗伯托

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-06T22:37:14.443

您是否尝试过使用配置文件设置而不是以编程方式进行？然后至少您会知道这是一般设置问题还是与您的代码有关。然后，您可以逐个推出代码位；mex，然后是端点，看看哪个会杀死它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-07T09:37:42.427

VS2008 没有任何反馈就死了吗？如果是这样，请检查 Windows 事件日志（应用程序日志）中的错误消息。

一个可能的原因：VS2008 + System.Core.dll 3.5 + 错误的 NGen 映像可能会在 VS2008 尝试加载 System.Core 或任何引用/依赖它的东西时导致崩溃。

您可能还想将一个 VS 实例附加到另一个（作为调试器）以查看任何其他崩溃详细信息。但我会先探索 System.Core/NGen 轨道。

[https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=341658](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=341658) [https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=337149](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=337149) [https://connect.microsoft。 com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=330302](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=330302) [https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=330903](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=330903)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T13:21:57.327

我修好了它。

我将 system.serviceModel 部分从 output.config 复制并粘贴到 userSettings 部分之后的 app.config 中，并注释掉了整个 output.config。

我还在初始化 ChatClient("name") 时指定了端点的名称。

它似乎正在工作。

# ruby - rubyscript2exe 的许可证到底是什么？

> ID：418053
> 
> 赞同：1
> 
> 时间：2009-01-06T20:44:29.710
> 
> 标签：ruby, licensing, gpl

它说 ruby​​script2exe 许可证是 GPL，但我无法理解以下内容：如果我用它创建一个可执行文件，我可以使用我在公司创建的应用程序而不将其贡献给 GNU 社会（不共享我的 Ruby 代码吗？）

我什至可以将它包含在我们的产品中并将我的可执行文件作为我们产品的一部分出售吗？

这是链接： [http ://www.erikveen.dds.nl/rubyscript2exe/#5.1.0](http://www.erikveen.dds.nl/rubyscript2exe/#5.1.0)

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-06T20:51:32.410

> 我可以使用我在公司创建的应用程序而不将其贡献给 GNU 社会（不共享我的 Ruby 代码吗？）

是的！GPL 许可证仅管理您如何使用 GPL 的*源代码*，而不是您使用它的*数据*。因此，如果您要为原始程序编写扩展，或修改其源代码，您将有义务发布该修改。但是 GPL 从不强制您遵守与 GPL 下程序使用/生成的数据有关的任何规则。

在你的例子中，这些数据恰好也是代码——但就 GPL 而言，它只是任何旧数据。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-06T20:53:48.427

您可以使用任何许可证；[RubyScript2Exe在这里](http://www.erikveen.dds.nl/rubyscript2exe/#5.2.0)特别声明了. 无论如何，GPL 只涵盖 RubyScript2Exe 本身，而不是它产生的应用程序。

# c# - 如何将流从 Java 小程序发送到 ASP .NET 网站？

> ID：418056
> 
> 赞同：1
> 
> 时间：2009-01-06T20:44:40.210
> 
> 标签：c#, java, asp.net

我希望能够从托管在同一网站上的 java 小程序将二进制数据流发送到 asp .net 网站。

我发现[这个链接](http://java.sun.com/docs/books/tutorial/networking/urls/readingWriting.html)讨论了这个问题，但我不确定如何在网站上实际接收数据。

我将发送的流的大小可能在 1mb-20mb 之间，我需要发送其他信息，例如文件名。

我怀疑我会实现一个 IHttpHandler 来处理一个 POST，但我不确定如何处理这个问题。

有什么想法吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T21:32:52.927

Carl，回答您对 casperOne 的评论，向您的 ASP.NET 站点添加一个新的 Web 服务并执行类似的操作...

```
using System;
using System.IO;
using System.Web.Services;

[WebService(Namespace = "http://tempuri.org/")]
[WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
public class Service : System.Web.Services.WebService
{
    [WebMethod]
    public bool RecieveBytes(byte[] data)
    {
        try
        {
            File.WriteAllBytes("~/uploads/uploadedFile.dat", data);
        }
        catch (Exception ex)
        {
            return false;
        }
        return true;
    }
} 
```

至于从Java提交数据。查看 Java 框架的文档，了解如何创建 WebService 客户端。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T20:52:09.540

好吧，如果您想以基于标准的方式进行操作，您可以模仿将文件上传到站点：

[http://www.jguru.com/faq/view.jsp?EID=160](http://www.jguru.com/faq/view.jsp?EID=160)

而在 ASP.NET 端，您只需通过 HttpRequest 上的 Files 属性访问该文件。

但是，这最终会对内容进行文本编码，这将增加您上传内容的开销（大约 33%）。

我认为一个更好的主意是公开一个使用 MTOM 接受内容的 Web 服务/方法（我相信 Java 有一个库）。

# java - 如何从多个扩展的通用接口继承？

> ID：418064
> 
> 赞同：-2
> 
> 时间：2009-01-06T20:46:41.110
> 
> 标签：java, generics, inheritance

我有一些课程，例如：

```
public class XMLStatusMessage extends XMLMessage
{}
public abstract class XMLMessage implements IMessage
{}

public interface IMessageListener
{
    public void onMessage( IMessage message );
}

public interface XMLMessageListener <T extends XMLMessage> extends 
    IMessageListener
{
    public void onMessage( T message ); 
}

public interface XMLStatusMessageListener extends 
    XMLMessageListener <XMLStatusMessage>
{
    @Override
    public void onMessage( XMLStatusMessage message );
} 
```

和

```
public class AStatusHandler implements XMLStatusMessageListener
{
    //...
    @Override
    public void onMessage( XMLStatusMessage message )
    {
        //...
    }
} 
```

我的问题是 AStatusHandler 无法编译，因为我还没有实现 public void onMessage(IMessage)。我不明白为什么我还必须实现 onMessage(IMessage)，因为它已经实现了 onMessage(XMLStatusMessage) 并且 XMLStatusMessage 是一个 IMessage。这个问题有简单的解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-06T21:11:59.797

正如其他答案所指出的，您只能在 AStatusHandler 中处理 XMLStatusMessage 消息，但我猜这就是您想要的？重新声明你的接口如下，我相信你会得到你想要的；

```
public interface IMessageListener<T extends IMessage> {

    public void onMessage(T message);
}

public interface XMLMessageListener<T extends XMLMessage> extends IMessageListener<T> {
}

public interface XMLStatusMessageListener extends XMLMessageListener<XMLStatusMessage> {
} 
```

然后您可以按如下方式创建消息侦听器；

```
public class AStatusHandler implements XMLStatusMessageListener {

    @Override
    public void onMessage(final XMLStatusMessage message) {

        // TODO Auto-generated method stub

    }

} 
```

希望这是您想要的，并且对您有所帮助。

问候弯曲

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T20:52:26.653

您声称（通过实现 IMessageListener）您可以使用*任何*IMessage 调用 onMessage。如果您致电：

```
new XMLMessageListener().onMessage(new SomeOtherMessage()); 
```

? 如果您认为这不应该被允许，那么您不应该实现 IMessageListener。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-06T20:50:27.530

我以前遇到过这些情况，但是对于这个问题并没有真正的完美解决方案。

在您的情况下，IMessageListener 定义 onMessage 以接收 IMessage。

扩展它的 XMLMessageListener 定义了 onMessage 以接收至少一个 XMLMessage。

即使您忽略了泛型，Java 也不允许您在方法的覆盖版本中更改参数类型。所以这两种方法被认为是一种重载，并且您的代码不会编译，因为您没有接收 IMessage 的版本的定义。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-06T20:51:20.647

XMLStatusMessage 是 IMessage，但不是相反的。如果有另一个 IMessage 子类，比如 SMTPStatusMessage，那么：

1.  onMessage(IMessage) 可以合法地传递 SMTPStatusMessage，但是
2.  onMessage(XMLStatusMessage) 不能。

如果您不希望将 XMLStatusMessage 以外的任何内容发送到 AStatusHandler，那么您可以让 onMessage(IMessage) 将 IMessage 转换为 XMLStatusMessage 并调用 onMessage(XMLStatusMessage)，但这不是一个很好的长期策略。

编辑：真的，问题是为什么 XMLMessageListener 是 IMessageListener 的子类，因为大概调用 onMessage(XMLStatusMessage) 的类永远不会调用 onMessage(IMessage)？

# php - 在 PHP 中测试变量是否存在的最佳方法；isset() 明显坏了

> ID：418066
> 
> 赞同：194
> 
> 时间：2009-01-06T20:46:50.797
> 
> 标签：php, variables, isset

从[`isset()`文档](http://php.net/isset)：

```
isset() will return FALSE if testing a variable that has been set to NULL. 
```

基本上，`isset()`根本不检查变量是否已设置，但是否设置为`NULL`.

鉴于此，实际检查变量是否存在的最佳方法是什么？我试过类似的东西：

```
if(isset($v) || @is_null($v)) 
```

（`@`有必要避免`$v`未设置时的警告）但`is_null()`有类似的问题`isset()`：它返回未设置的`TRUE`变量！还可以看出：

```
@($v === NULL) 
```

工作原理完全一样`@is_null($v)`，所以也出来了。

我们应该如何可靠地检查 PHP 中变量的存在？

* * *

编辑：PHP中未设置的变量和设置为的变量之间显然存在差异`NULL`：

```
<?php
$a = array('b' => NULL);
var_dump($a); 
```

PHP表明`$a['b']`存在，并且具有`NULL`价值。如果添加：

```
var_dump(isset($a['b']));
var_dump(isset($a['c'])); 
```

你可以看到我正在谈论的`isset()`功能的歧义。这是所有这三个的输出`var_dump()s`：

```
array(1) {
  ["b"]=>
  NULL
}
bool(false)
bool(false) 
```

* * *

进一步编辑：两件事。

一，用例。将数组转换为 SQL`UPDATE`语句的数据，其中数组的键是表的列，数组的值是要应用于每一列的值。表的任何列都可以保存一个值，通过在数组中`NULL`传递一个值来表示。`NULL`您*需要*一种方法来区分不存在的数组键和数组的值设置为`NULL`; 这就是不更新列的值和将列的值更新为`NULL`.

其次，对于我的上述用例和任何全局变量， [Zoredache 的答案](https://stackoverflow.com/questions/418066/best-way-to-test-for-a-variables-existence-in-php-isset-is-clearly-broken#418162)都可以正常工作：`array_key_exists()`

```
<?php
$a = NULL;
var_dump(array_key_exists('a', $GLOBALS));
var_dump(array_key_exists('b', $GLOBALS)); 
```

输出：

```
bool(true)
bool(false) 
```

由于这可以正确处理几乎所有我可以看到不存在的变量和设置为的变量之间存在任何歧义，因此`NULL`我**调用`array_key_exists()`PHP 中最简单的官方方法来真正检查变量的存在**。

（我能想到的唯一其他情况是类属性，`property_exists()`根据[它的文档](http://php.net/property_exists)，它的工作原理与它类似`array_key_exists()`，因为它正确区分了未设置和设置为`NULL`。）

* * *

## 回答 #1

> 赞同：97
> 
> 时间：2009-01-06T21:07:07.590

如果您要检查的变量在全局范围内，您可以这样做：

```
array_key_exists('v', $GLOBALS) 
```

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2013-09-05T21:52:07.150

试图概述各种讨论和答案：

**这个问题没有一个单一的答案可以取代所有`isset`可以使用的方法。**一些用例由其他功能解决，而另一些则经不起审查，或者具有超出代码高尔夫的可疑价值。其他用例远非“破碎”或“不一致”，而是说明了为什么`isset`对 的反应`null`是合乎逻辑的行为。

# 真实用例（带有解决方案）

## 1\. 数组键

数组可以被当作变量的集合来对待，就像`unset`对待`isset`它们一样对待它们。但是，由于它们可以被迭代、计数等，缺失值与值为 的值不同`null`。

在这种情况下，答案是**使用[`array_key_exists()`](http://php.net/array_key_exists)而不是`isset()`**.

由于这是将数组作为函数参数进行检查，因此如果数组本身不存在，PHP 仍会发出“通知”。在某些情况下，可以有效地争论每个维度应该首先被初始化，所以通知正在完成它的工作。`array_key_exists`对于其他情况，依次检查数组的每个维度的“递归”函数可以避免这种情况，但基本上与`@array_key_exists`. 它也与`null`值的处理有些相切。

## 2.对象属性

在传统的“面向对象编程”理论中，封装和多态是对象的关键属性；在 PHP 等基于类的 OOP 实现中，封装的属性被声明为类定义的一部分，并被赋予访问级别（`public`、`protected`或`private`）。

但是，PHP 还允许您动态地向对象添加属性，就像您将键添加到数组一样，并且有些人以类似的方式使用无类对象（从技术上讲，内置的实例`stdClass`，它没有方法或私有功能）关联数组的方法。这会导致函数可能想知道是否已将特定属性添加到给定对象的情况。

与数组键一样，**用于检查对象属性的解决方案包含在语言中，称为[`property_exists`](http://php.net/property_exists)**.

# 不合理的用例，有讨论

## 3\. `register_globals`、全局命名空间等污染

该`register_globals`功能将变量添加到全局范围，其名称由 HTTP 请求的各个方面（GET 和 POST 参数以及 cookie）确定。这可能会导致错误和不安全的代码，这就是为什么它自[PHP 4.2（2000 年 8 月发布）以来默认禁用并在](http://www.php.net/releases/4_2_0.php)[PHP 5.4（2012 年 3 月发布](http://www.php.net/releases/5_4_0.php)）中完全删除的原因。但是，某些系统可能在启用或模拟此功能的情况下仍在运行。`global`也可以使用关键字或`$GLOBALS`数组以其他方式“污染”全局命名空间。

首先，`register_globals`它本身不太可能意外产生`null`变量，因为 GET、POST 和 cookie 值将始终是字符串（`''`仍然返回`true`from `isset`），并且会话中的变量应该完全在程序员的控制之下。

其次，只有当这覆盖了一些先前的初始化时，变量与值的污染`null`才是一个问题。仅当其他地方的代码区分这两种状态时， “覆盖”未初始化的变量`null`才会有问题，因此这种可能性本身就是*反对*进行这种区分的论据。

## 4.`get_defined_vars`和`compact`

PHP 中的一些很少使用的函数，例如[`get_defined_vars`](http://php.net/get_defined_vars)and [`compact`](http://php.net/compact)，允许您将变量名视为数组中的键。对于全局变量，[超全局数组`$GLOBALS`](http://php.net/manual/en/reserved.variables.globals.php)允许类似的访问，并且更常见。如果变量未在相关范围内定义，这些访问方法的行为将有所不同。

一旦您决定使用其中一种机制将一组变量视为一个数组，您就可以对其执行所有与任何普通数组相同的操作。因此，见 1。

仅用于预测这些函数将如何运行的功能（例如，“在返回的数组中是否会有一个键 'foo' `get_defined_vars`？”）是多余的，因为您可以简单地运行该函数并找出没有任何不良影响。

## 4a。变量变量 ( `$$foo`)

虽然与将一组变量转换为关联数组的函数并不完全相同，但大多数使用[“变量变量”](http://php.net/manual/en/language.variables.variable.php)（“分配给基于此其他变量命名的变量”）的情况可以并且应该改为使用关联数组.

从根本上说，变量名是程序员赋予值的标签。如果您在运行时确定它，它实际上并不是一个标签，而是某个键值存储中的一个键。更实际的是，如果不使用数组，您将失去计数、迭代等的能力；也可能无法在键值存储“外部”拥有一个变量，因为它可能会被`$$foo`.

一旦更改为使用关联数组，代码将适用于解决方案 1。间接对象属性访问（例如`$foo->$property_name`）可以使用解决方案 2 解决。

## 5.`isset`比打字容易得多`array_key_exists`

我不确定这是否真的相关，但是是的，PHP 的函数名称有时会非常冗长且不一致。显然，PHP 的史前版本使用函数名的长度作为哈希键，所以 Rasmus 故意编造函数名，`htmlspecialchars`这样它们就会有不寻常的字符数......

不过，至少我们不是在写 Java，对吧？;)

## 6.未初始化的变量有类型

变量基础的[手册页](http://php.net/manual/en/language.variables.basics.php)包括以下语句：

> 未初始化的变量具有其类型的默认值，具体取决于使用它们的上下文

我不确定 Zend 引擎中是否存在“未初始化但已知类型”的概念，或者这是否对声明的解读过多。

很明显，这对它们的行为没有实际影响，因为该页面上描述的未初始化变量的行为与值为 的变量的行为相同`null`。举一个例子，这段代码中的`$a`和`$b`都以整数结尾`42`：

```
unset($a);
$a += 42;

$b = null;
$b += 42; 
```

（第一个会引发关于未声明变量的通知，试图让您编写更好的代码，但它不会对代码的实际运行方式产生任何影响。）

## 99\. 检测函数是否运行

*（最后保留这个，因为它比其他的要长得多。也许我稍后会编辑它......）*

考虑以下代码：

```
$test_value = 'hello';
foreach ( $list_of_things as $thing ) {
    if ( some_test($thing, $test_value) ) {
        $result = some_function($thing);
    }
}
if ( isset($result) ) {
    echo 'The test passed at least once!';
} 
```

如果`some_function`可以返回`null`，则有可能`echo`即使`some_test`返回也无法到达`true`。程序员的意图是检测何时`$result`从未设置，但 PHP 不允许他们这样做。

但是，这种方法还有其他问题，如果添加外部循环，这些问题就会变得清晰：

```
foreach ( $list_of_tests as $test_value ) {
    // something's missing here...
    foreach ( $list_of_things as $thing ) {
        if ( some_test($thing, $test_value) ) {
            $result = some_function($thing);
        }
    }
    if ( isset($result) ) {
        echo 'The test passed at least once!';
    }
} 
```

因为`$result`从未显式初始化，所以当第一个测试通过时，它将采用一个值，因此无法判断后续测试是否通过。**当变量没有正确初始化时，这实际上是一个非常常见的错误。**

为了解决这个问题，我们需要在我评论说缺少某些东西的那一行做一些事情。最明显的解决方案是设置一个永远无法返回`$result`的“终端值” ；`some_function`如果是这样`null`，那么其余代码将正常工作。如果由于`some_function`具有极其不可预测的返回类型（这本身可能是一个不好的迹象）而没有自然的终端值候选者，那么可以使用额外的布尔值，例如`$found`，来代替。

### 思想实验一：`very_null`常数

PHP 理论上可以提供一个特殊的常量 - 以及`null`- 在这里用作终端值；据推测，从函数返回 this 是非法的，或者它会被强制转换为`null`，同样可能适用于将它作为函数参数传入。这将使这个非常具体的情况稍微简单一些，但是一旦您决定重构代码 - 例如，将内部循环放入单独的函数中 - 它就会变得无用。如果常量可以在函数之间传递，则不能保证`some_function`不会返回它，因此它不再用作通用终端值。

在这种情况下，用于检测未初始化变量的论点归结为该特殊常量的论点：如果将注释替换为`unset($result)`，并将其与 区别对待`$result = null`，则您将引入一个“值”，`$result`因为它不能传递，只能由特定的内置函数检测到。

### 思想实验二：赋值计数器

思考最后一个`if`问题的另一种方式是“有什么任务`$result`吗？” 与其将其视为 的特殊值，不如将其视为*有关*`$result`变量的“元数据” ，有点像 Perl 的“变量污染”。所以不是你可能会调用它，而不是，。*`isset``has_been_assigned_to``unset``reset_assignment_state`*

 *但如果是这样，为什么要停在一个布尔值上？如果您想知道测试通过*了多少次怎么办？*您可以简单地将元数据扩展为整数并拥有`get_assignment_count`和`reset_assignment_count`...

显然，添加这样的功能会在语言的复杂性和性能上进行权衡，因此需要仔细权衡其预期的有用性。与`very_null`常数一样，它仅在非常狭窄的情况下才有用，并且类似地抵抗重构。

希望显而易见的问题是，为什么 PHP 运行时引擎应该提前假设您想要跟踪这些事情，而不是让您使用普通代码明确地进行。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2013-12-29T07:05:53.657

有时我在试图弄清楚在给定情况下使用哪种比较操作时会有点迷茫。`isset()`仅适用于未初始化或显式空值。传递/分配 null 是确保逻辑比较按预期工作的好方法。

尽管如此，考虑起来还是有点困难，所以这里有一个简单的矩阵，比较不同的值将如何被不同的操作评估：

```
|           | ===null | is_null | isset | empty | if/else | ternary | count>0 |
| -----     | -----   | -----   | ----- | ----- | -----   | -----   | -----   |
| $a;       | true    | true    |       | true  |         |         |         |
| null      | true    | true    |       | true  |         |         |         |
| []        |         |         | true  | true  |         |         |         |
| 0         |         |         | true  | true  |         |         | true    |
| ""        |         |         | true  | true  |         |         | true    |
| 1         |         |         | true  |       | true    | true    | true    |
| -1        |         |         | true  |       | true    | true    | true    |
| " "       |         |         | true  |       | true    | true    | true    |
| "str"     |         |         | true  |       | true    | true    | true    |
| [0,1]     |         |         | true  |       | true    | true    | true    |
| new Class |         |         | true  |       | true    | true    | true    | 
```

为了适应表格，我稍微压缩了标签：

*   `$a;`指已声明但未赋值的变量
*   第一列中的所有其他内容都指的是分配的值，例如：
    *   `$a = null;`
    *   `$a = [];`
    *   `$a = 0;`
    *   …</li>
*   这些列指的是比较操作，例如：
    *   `$a === null`
    *   `isset($a)`
    *   `empty($a)`
    *   `$a ? true : false`
    *   …</li>

所有结果都是布尔值，`true`被打印并被`false`省略。

你可以自己运行测试，检查这个要点：
[https ://gist.github.com/mfdj/8165967](https://gist.github.com/mfdj/8165967)

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2009-12-28T11:57:53.477

您可以使用紧凑的语言结构来测试是否存在空变量。结果中不会出现不存在的变量，而会显示空值。

```
$x = null;
$y = 'y';

$r = compact('x', 'y', 'z');
print_r($r);

// Output:
// Array ( 
//  [x] => 
//  [y] => y 
// ) 
```

在您的示例中：

```
if (compact('v')) {
   // True if $v exists, even when null. 
   // False on var $v; without assignment and when $v does not exist.
} 
```

当然，对于全局范围内的变量，您也可以使用 array_key_exists()。

顺便说一句，我会避免像瘟疫这样的情况，即不存在的变量和具有空值的变量之间存在语义差异。PHP 和大多数其他语言只是认为没有。

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2010-03-31T10:13:18.697

## 解释NULL，逻辑思维

我想所有这一切的明显答案是......不要将您的变量初始化为NULL，将它们初始化为与它们打算成为的东西相关的东西。

## 正确对待NULL

NULL应该被视为“不存在的值”，这就是NULL的含义。该变量不能归类为 PHP 存在的变量，因为它没有被告知它试图成为什么类型的实体。它也可能不存在，所以 PHP 只是说“好吧，它不存在，因为它没有任何意义，而 NULL 是我的说法”。

## 一个论点

现在让我们争论。“但 NULL 就像说 0 或 FALSE 或 ''。

错误，0-FALSE-'' 仍然被归类为空值，但它们被指定为某种类型的值或问题的预定答案。**FALSE**是对是或否的答案，**''**是对某人提交的标题的答案，而**0**是对数量或时间等的答案。它们被设置为某种类型的答案/结果，这使得它们在设置时有效。

NULL 只是没有答案，它没有告诉我们是或否，它没有告诉我们时间，也没有告诉我们提交了一个空白字符串。这就是理解 NULL 的基本逻辑。

## 概括

这不是要创建古怪的函数来解决问题，它只是改变你的大脑看待 NULL 的方式。如果它是 NULL，假设它没有被设置为任何东西。如果您正在预定义变量，则根据您打算使用它们的类型将它们预定义为 0、FALSE 或“”。

随意引用这个。这超出了我的逻辑头脑:)

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2009-01-24T12:35:01.213

可以通过[property_exists检查对象属性是否存在](http://fi2.php.net/property_exists)

来自单元测试的示例：

```
function testPropertiesExist()
{
    $sl =& $this->system_log;
    $props = array('log_id',
                   'type',
                   'message',
                   'username',
                   'ip_address',
                   'date_added');

    foreach($props as $prop) {
        $this->assertTrue(property_exists($sl, $prop),
                           "Property <{$prop}> exists");
    }
} 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2013-09-03T21:11:59.243

作为[greatbigmassive 关于 NULL 含义的讨论的](https://stackoverflow.com/a/2551988/157957)补充，请考虑“变量的存在”实际上意味着什么。

**在许多语言中，您必须在使用每个变量之前显式声明它**；这可能决定了它的类型，但更重要的是它声明了它的*范围*。一个变量“存在”在其范围内的任何地方，而在它之外的任何地方——无论是整个函数还是单个“块”。

**在其范围内，变量为您（程序员）选择**的标签赋予了某种意义。**在其范围之外，该标签是没有意义的（在不同的范围内是否使用相同的标签基本上是无关紧要的）。**

 ****在 PHP 中，不需要声明变量**——只要你需要它们，它们就会立即生效。当您第一次写入变量时，PHP 会在内存中为该变量分配一个条目。如果您从当前没有条目的变量中读取，PHP 会认为该变量具有 value `NULL`。

但是，如果您使用变量而不首先“初始化”它，自动代码质量检测器通常会警告您。首先，这有助于检测拼写错误，例如分配给`$thingId`但读取自`$thing_id`; 但其次，它迫使您考虑该变量具有意义的范围，就像声明一样。

**任何关心变量是否“存在”的代码都是该变量范围的一部分**——无论它是否已被初始化，作为程序员的你已经在代码的那个点赋予了该标签的含义。既然你在使用它，它就必须在某种意义上“存在”，如果它存在，它就必须有一个隐含的价值；在 PHP 中，该隐含值为`null`.

由于 PHP 的工作方式，可以编写代码，将现有变量的名称空间不作为您赋予意义的标签范围，而是作为某种键值存储。例如，您可以运行如下代码：`$var = $_GET['var_name']; $$var = $_GET['var_value'];`. **仅仅因为你可以，并不意味着这是一个好主意。**

事实证明，PHP 有一种更好的方式来表示键值存储，称为关联数组。尽管可以将数组的值视为变量，但您也可以对整个数组执行操作。**如果你有一个关联数组，你可以使用[`array_key_exists()`](http://php.net/array_key_exists).**

您也可以以类似的方式使用对象，动态设置属性，在这种情况下，您可以[`property_exists()`](http://php.net/property_exists)以完全相同的方式使用。当然，**如果你定义了一个类，你可以声明它有哪些属性**——你甚至可以在`public`,`private`和`protected`scope 之间进行选择。

尽管尚未初始化（或已显式）的变量（与数组键或对象属性相反）与值为 的变量之间存在*技术*差异，但任何认为该差异*有意义的*代码正在以不应该使用的方式使用变量。`unset()``null`

 ** * *

## 回答 #8

> 赞同：4
> 
> 时间：2013-01-31T15:32:55.250

[`isset`](http://www.php.net/manual/en/function.isset.php)检查变量是否已设置，如果是，则其*值*是否不为 NULL。后一部分（在我看来）不在此功能的范围内。没有像样的解决方法来确定变量是 NULL**是因为它没有设置**还是因为**它被显式设置为 NULL**。

这是一种可能的解决方案：

```
$e1 = error_get_last();
$isNULL = is_null(@$x);
$e2 = error_get_last();
$isNOTSET = $e1 != $e2;
echo sprintf("isNOTSET: %d, isNULL: %d", $isNOTSET, $isNULL);

// Sample output:
// when $x is not set: isNOTSET: 1, isNULL: 1
// when $x = NULL:     isNOTSET: 0, isNULL: 1
// when $x = false:    isNOTSET: 0, isNULL: 0 
```

其他解决方法是探测以下输出[`get_defined_vars()`](http://php.net/manual/en/function.get-defined-vars.php)：

```
$vars = get_defined_vars();
$isNOTSET = !array_key_exists("x", $vars);
$isNULL = $isNOTSET ? true : is_null($x);
echo sprintf("isNOTSET: %d, isNULL: %d", $isNOTSET, $isNULL);

// Sample output:
// when $x is not set: isNOTSET: 1, isNULL: 1
// when $x = NULL:     isNOTSET: 0, isNULL: 1
// when $x = false:    isNOTSET: 0, isNULL: 0 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2011-01-28T15:48:40.510

**我不同意你关于 NULL 的推理**，并且说你需要改变你对 NULL 的心态是很奇怪的。

我认为 isset() 设计不正确， isset() 应该告诉您变量是否已设置并且它不应该关心变量的实际值。

如果您正在检查从数据库返回的值并且其中一列具有 NULL 值，即使该值为 NULL，您仍然想知道它是否存在......不，不要相信 isset() 在这里。

同样地

```
$a = array ('test' => 1, 'hello' => NULL);

var_dump(isset($a['test']));   // TRUE
var_dump(isset($a['foo']));    // FALSE
var_dump(isset($a['hello']));  // FALSE 
```

isset() 应该被设计成这样工作：

```
if(isset($var) && $var===NULL){.... 
```

这样我们就让程序员来检查类型，而不是让 isset() 来假设它不存在，因为值为 NULL - 它只是愚蠢的设计

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2014-05-22T21:52:04.660

我要为此加两分钱。这个问题令人困惑的一个原因是因为这种情况似乎返回了相同的结果，但错误报告*未*完全：

```
$a = null;
var_dump($a); // NULL
var_dump($b); // NULL 
```

您可以从这个结果中假设，`$a = null`与根本没有定义之间的区别`$b`是什么。

曲柄错误报告：

```
NULL

Notice: Undefined variable: b in xxx on line n
NULL 
```

*注意：*它抛出了一个未定义的变量错误，但输出值`var_dump`仍然是`NULL`.

PHP 显然确实具有区分空变量和未定义变量的内部能力。在我看来，应该有一个内置函数来检查这个。

我认为接受的答案在很大程度上是好的，但如果我要实现它，我会为它写一个包装器。正如前面[在这个答案](https://stackoverflow.com/a/418330/2812842)中提到的，我必须同意我实际上并没有遇到过这种问题的情况。我似乎几乎总是在我的变量被设置和定义的情况下结束，或者它们不是（未定义、未设置、空、空白等）。并不是说这样的情况将来不会发生，但由于这似乎是一个非常独特的问题，我并不感到惊讶 PHP 开发人员没有费心把它放进去。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-01-06T21:00:42.627

如果我运行以下命令：

```
echo '<?php echo $foo; ?>' | php 
```

我收到一个错误：

```
PHP Notice:  Undefined variable: foo in /home/altern8/- on line 1 
```

如果我运行以下命令：

```
echo '<?php if ( isset($foo) ) { echo $foo; } ?>' | php 
```

我没有得到错误。

如果我有一个应该设置的变量，我通常会执行以下操作。

```
$foo = isset($foo) ? $foo : null; 
```

或者

```
if ( ! isset($foo) ) $foo = null; 
```

这样，稍后在脚本中，我可以安全地使用 $foo 并知道它“已设置”，并且默认为 null。稍后，`if ( is_null($foo) ) { /* ... */ }`如果我需要并确定变量存在，即使它为空，我也可以。

完整的[isset 文档](http://php.net/manual/en/function.isset.php)比最初粘贴的内容要多一些。是的，它为先前设置但现在为 null 的变量返回 false，但如果尚未设置（曾经）变量以及已标记为未设置的任何变量，它也会返回 false。它还指出 NULL 字节 ("\0") 不被视为 null 并将返回 true。

> 确定是否设置了变量。
> 
> 如果一个变量已经用 unset() 取消设置，它将不再被设置。如果测试已设置为 NULL 的变量，isset() 将返回 FALSE。另请注意，NULL 字节（“\0”）不等同于 PHP NULL 常量。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-01-06T22:17:20.630

尝试使用

```
unset($v) 
```

似乎唯一没有设置变量的时间是当它特别未设置（$v）时。听起来您对“存在”的含义与 PHP 的定义不同。NULL肯定是存在的，它是NULL。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-06T21:50:57.393

我不得不说，在我多年的 PHP 编程中，我从未遇到过`isset()`在 null 变量上返回 false 的问题。OTOH，我遇到`isset()`了空数组条目失败的问题-但`array_key_exists()`在这种情况下可以正常工作。

为了进行一些比较，Icon 明确定义了一个未使用的变量作为返回`&null`，因此您可以使用 Icon 中的 is-null 测试来检查未设置的变量。这确实使事情变得更容易。另一方面，Visual BASIC 对没有值的变量有多种状态（Null、Empty、Nothing，...），您经常需要检查其中的多个状态。众所周知，这是错误的来源。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2014-05-22T06:10:39.717

根据 empty() 函数的 PHP 手册，“确定一个变量是否被认为是空的。如果一个变量不存在或者它的值等于 FALSE，那么它就被认为是空的。如果变量不存在。” （我的重点。）这意味着 empty() 函数应该符合“在 PHP 中测试变量存在的最佳方法”，根据标题问题。

但是，这还不够好，因为 empty() 函数可能会被确实存在并设置为 NULL 的变量所欺骗。

我打断了我之前的答案以提出更好的东西，因为它比我的原始答案（在此中断之后进行比较）更简单。

```
 function undef($dnc) //do not care what we receive
  { $inf=ob_get_contents();             //get the content of the buffer
    ob_end_clean();                     //stop buffering outputs, and empty the buffer
    if($inf>"")                         //if test associated with the call to this function had an output
    { if(false!==strpos($inf, "Undef"); //if the word "Undefined" was part of the output
        return true;                    //tested variable is undefined
    }
    return false;                       //tested variable is not undefined
  } 
```

两行简单的代码可以使用上述函数来显示变量是否未定义：

```
 ob_start();                           //pass all output messages (including errors) to a buffer
  if(undef($testvar===null))            //in this case the variable being tested is $testvar 
```

您可以在这两行之后添加任何适当的内容，例如以下示例：

```
 echo("variable is undefined");
  else
    echo("variable exists, holding some value"); 
```

我想将调用 ob_start() 和 ($testvar===null) 放在函数内部，然后简单地将变量传递给函数，但它不起作用。即使您尝试将变量“通过引用传递”给函数，变量也已被定义，然后函数永远无法检测到它以前未定义。这里展示的是我想要做的和实际工作之间的妥协。

前面暗示有另一种方法可以始终避免遇到“未定义变量”错误消息。（这里的假设是，阻止此类消息是您想要测试变量是否未定义的原因。）

```
 function inst(&$v) { return; }  //receive any variable passed by reference; instantiates the undefined 
```

只需在对 $testvar 执行某些操作之前调用该函数：

```
 inst($testvar);                //The function doesn't affect any value of any already-existing variable 
```

当然，新实例化的变量的值设置为 null！

（中断结束）

所以，经过一些研究和实验，这里有一些保证可以工作的东西：

```
 function myHndlr($en, $es, $ef, $el)
 { global $er;
   $er = (substr($es, 0, 18) == "Undefined variable");
   return;
 }

 $er = false;
 if(empty($testvar))
 { set_error_handler("myHndlr");
   ($testvar === null);
   restore_error_handler();
 }
 if($er)  // will be 1 (true) if the tested variable was not defined.
 { ; //do whatever you think is appropriate to the undefined variable
 } 
```

解释：变量 $er 被初始化为默认值“无错误”。定义了“处理函数”。如果 $testvar（我们想知道是否未定义的变量）通过了初步的 empty() 函数测试，那么我们进行更彻底的测试。我们调用 set_error_handler() 函数来使用之前定义的处理函数。然后我们做一个涉及 $testvar 的简单身份比较，如果未定义将触发错误。处理函数捕获错误并专门测试以查看错误的原因是否是变量未定义的事实。结果被放置在错误信息变量 $er 中，我们可以稍后测试它以执行我们想要的任何操作，因为确定是否定义了 $testvar。因为我们只需要处理函数来达到这个有限的目的，所以我们恢复了原来的错误处理函数。“myHndlr”函数只需要声明一次；其他代码可以复制到任何合适的地方，对于 $testvar 或我们想要以这种方式测试的任何其他变量。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2015-05-29T17:50:22.480

我认为唯一的完整解决方案是报告**通知**

```
error_reporting(E_ALL); // Enables E_NOTICE 
```

但是您必须修复由未定义变量、常量、数组键、类属性等生成的所有通知。一旦你这样做了，你就不必担心空变量和未声明变量之间的区别，并且歧义消失了。

在所有情况下启用**通知报告**可能不是一个好的选择，但启用它有充分的理由：

[为什么要修复 E_NOTICE 错误？](https://stackoverflow.com/questions/5073642/why-should-i-fix-e-notice-errors)

在我的情况下，在没有它的情况下在项目中工作了一年多，但习惯于在声明变量时小心翼翼，因此过渡很快。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2017-02-01T14:34:35.390

知道变量是否在当前范围内定义（`$GLOBALS`不可信）的唯一方法是`array_key_exists( 'var_name', get_defined_vars() )`.

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2011-03-07T22:28:42.133

我更喜欢使用 not empty 作为检查 a) 存在且 b) 不为 null 的变量是否存在的最佳方法。

```
if (!empty($variable)) do_something(); 
```

# foxpro - 在 VFP 8 中的 Vista 64 位上使用 SET PRINTER TO 时如何修复错误 1958

> ID：418071
> 
> 赞同：0
> 
> 时间：2009-01-06T20:48:09.547
> 
> 标签：foxpro, visual-foxpro

我们的 VFP 8 应用程序在执行以下代码行时返回错误 1958，即“加载打印机驱动程序时出错”

```
SET PRINTER TO HP1200 
```

在客户 Vista Business 64 位笔记本电脑上。HP1200 是 HP 商务喷墨打印机型号 1200。

客户使用惠普最新的 64 位驱动程序移除并重新安装了打印机。我们还尝试在 FILE: 端口上添加一个新的 Generic / Text Only 打印机并改用它，但我们得到了同样的错误。因此，它并非特定于 HP 打印机驱动程序。

我们还尝试删除该`SET PRINTER TO`行并仅执行 a`REPORT FORM`命令，以便将其转到默认打印机，但我们没有得到任何输出。

客户有一台台式机，也是 64 Vista Business，安装了相同的打印机和驱动程序，我们没有看到相同的错误。他们确实在两台机器上运行 Avast 防病毒软件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-09T20:13:44.850

我们至少有一个客户正在使用带有 FoxPro 应用程序的 Vista，但我们使用的是 FoxPro 9，并且没有遇到打印问题。

从我读到的所有内容来看，如果您要同时使用 Vista 和 FoxPro，FoxPro 9 是您的最佳选择。

[http://www.promatrix.com/mall/vfp-vista-compatibility.asp](http://www.promatrix.com/mall/vfp-vista-compatibility.asp)

我们将我们的应用程序从 Foxpro 8 切换到 Foxpro 9，特别是为了与 Vista 兼容……虽然我没有直接参与，但我认为转换并不难。

# asp.net - ASP.NET - UpdatePanel 和 JavaScript

> ID：418072
> 
> 赞同：25
> 
> 时间：2009-01-06T20:48:28.440
> 
> 标签：asp.net, asp.net-ajax, updatepanel

有没有办法在 UpdatePanel 进程完成时执行脚本。

我有一个允许“插入”、“复制”和“编辑”记录的页面。这都是在 UpdatePanel 上完成的，以防止页面导航。在页面的其他地方，我想打印一条“flash”消息——比如“您已成功输入一条记录”。它不在 UpdatePanel 附近，我想对消息使用 jQuery 效果，使其在 4 秒后淡出。如何使用 UpdatePanel 发回脚本或在 UpdatePanel 刷新后执行它？我应该将脚本写入 asp:literal 吗？想法？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-01-06T20:59:33.313

是的：

```
Sys.WebForms.PageRequestManager.getInstance().add_endRequest(endRequestHandler); 
```

进而：

```
function endRequestHandler(sender, args)
{
  // Do stuff
} 
```

[此处](http://msdn.microsoft.com/en-us/library/bb383810.aspx)和[此处](http://msdn.microsoft.com/en-us/library/bb397499.aspx)的文档。请记住，这将为页面上的每个 AJAX 请求触发。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-01-06T20:59:37.900

这应该可以解决问题：

```
 <script type="text/javascript">
            var prm = Sys.WebForms.PageRequestManager.getInstance();
            prm.add_beginRequest(BeginRequestHandler);
            prm.add_endRequest(EndRequestHandler);

            function BeginRequestHandler(sender, args) 
            {
                 //Jquery Call
            }

            function EndRequestHandler(sender, args) 
            {
                 //Jquery Call

            }
        </script> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-11-12T20:49:00.767

这是一篇关于如何使用 ScriptManager 的静态方法 RegisterClientScriptBlock 的文章。试了一下，效果很好。

[http://cshaperimage.jeremylikness.com/2009/06/inject-dynamic-javascript-into-aspnet.html](http://csharperimage.jeremylikness.com/2009/06/inject-dynamic-javascript-into-aspnet.html)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-06-23T04:49:11.733

```
var requestManager = Sys.WebForms.PageRequestManager.getInstance();
requestManager.add_beginRequest(function () { alert('here1') });
requestManager.add_endRequest(function () { alert(here2') }); 
```

资料来源：[http ://www.howtositecore.com/?p=36](http://www.howtositecore.com/?p=36)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-06-06T03:49:35.667

Sys.WebForms.PageRequestManager.getInstance() 方法对我也很有效。

我使用了很多包含多个更新面板的页面，并且我了解到即使您不希望更新面板刷新它也会自动触发。因此，在触发事件的函数内部，请确保您具有以下内容：

```
function BeginRequestHandler(sender, args) {
if (args.get_postBackElement().id == "ID of the Updatepanel") {
// do stuff here 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-06T21:00:28.523

布鲁诺，

首先，回答您的直接问题。在更新面板调用的回调中，您应该能够使用 RegisterStartupScript 调用来调用 JS 方法。然后在您的 JS 方法中，您将显示消息，然后您可以使用：

```
setTimeout('$('#myMessage').fadeOut("slow")', 4000); 
```

让它在 4 秒后消失。

更进一步，既然您已经在实现 JavaScript，我会邀请您查看[这篇关于 UpdatePanels](http://encosia.com/2007/07/11/why-aspnet-ajax-updatepanels-are-dangerous/)的文章。如果可能的话，我会尝试发送 Ajax 调用来进行插入、复制和编辑，这将进一步简化您的用户反馈并防止通过网络传输过多的信息。

# bash - 停止向终端回显 ^C

> ID：418073
> 
> 赞同：10
> 
> 时间：2009-01-06T20:48:30.513
> 
> 标签：bash

如何告诉我的 bash 不要将 ^C 回显到终端？

如果我只是在 bash 会话中按 Ctrl+C，则终端窗口中不会打印任何内容。但是如果我用 Ctrl+C 终止某些程序，有时 ^C 会在我的终端中回显并打印出来。有什么方法可以告诉我的 bash 我根本不想回显 ^C 吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-01-06T20:57:09.670

在 Linux 下：

stty -ctlecho

（提示查理的道具-我只是去查了一下）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-06T20:55:00.250

好吧，我相信它实际上是在呼应“插入符号”-C，而不是`CTRL-C`字符。除此之外，这实际上是`tty`驱动程序的功能，而不是外壳；驱动程序实际上截取了`CTRL-C`字符，生成一个`SIGINT`到进程，并回显字符。如果有办法在您的系统上执行此操作（这将严重依赖于操作系统），它将记录在*stty(1)*手册页或*tty(4)*驱动程序页面中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-07-13T05:35:40.630

您可以捕获 sigint... 将一个函数放入您的 .bashrc 或 .profile 中。这是我在信号上的陷阱：

```
``Trap2 () ( Tred "%6s–&lt;Interrupt>–\n" ''; return 202 ); trap Trap2 SIGINT``
```

其中 Tred 是一个打印红色文本的函数。如果您不想显示任何内容，请使用以下命令：

```
``Trap2 () ( return ); trap Trap2 SIGINT``
```

干杯!

——***艾斯提尔***

# css - 如何轻松学习 CSS？

> ID：418075
> 
> 赞同：11
> 
> 时间：2009-01-06T20:48:54.600
> 
> 标签：css, django

我正在使用 Django 框架，并且对使用 Python 的后端逻辑非常满意，但困扰我的是我必须使用 CSS 的前端部分。我怎样才能轻松地学习 CSS 的工作原理，或者有什么工具可以用来轻松地为 Django 创建前端界面？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-06T21:30:35.030

One word. It will change your life: **FIREBUG.**

As a UI developer, I learned much of what I know through trial and error. While there are probably 10 ways to do any single UI-related task, there are better (and more efficient) ways than others. Check out [A List Apart](http://www.alistapart.com/). Probably my favorite UI/CSS blog.

Also, in order to learn the intricacies of how browsers render HTML, **ALWAYS** check your designs in as many browsers as possible. Avoid using browser hacks. You really don't have to use them; if something is wrong in a browser, then you should rethink the way you've put things together. At any point in time, I have Firefox 3, IE6, IE7, and Safari/win open on my PC, checking all my work.

Another great way to learn is challenging yourself: find some free designs somewhere and try to mock them up using table-less layouts. Get familiar with the concepts of **floating** and **margins**. Just remember to always use a doctype!

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-06T20:52:03.783

[在sitepoint](http://www.sitepoint.com/subcat/css)或[w3 学校](http://www.w3schools.com/css/)有一些很好的在线教程。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-07T05:27:19.967

CSS by itself is fairly easy to understand and other answers have pointed to a lot of good CSS resources. The real challenge is learning all the quirks and bugs in each browser and this takes a lot of time.

You should definitely take the time to learn how CSS works, but as a newbie if you want to get started now, without worrying about many issues, I would recommend using one of the so-called CSS frameworks.

Here are some of the better known:

*   [Yahoo! UI Library: Base CSS](http://developer.yahoo.com/yui/base/)
*   [Bluetrip](http://capsizedesigns.com/blog/2008/04/bluetripcss-a-fusion-of-blueprint-and-tripoli/)
*   [Blueprint](http://code.google.com/p/blueprintcss/)
*   [Emastic](http://www.allapis.com/Emastic-CSS-Temaplates/index.html)
*   [YAML](http://www.yaml.de/en/) (not to be confused with the data markup language)
*   [960 Grid System](http://960.gs/)

I've successfully used Blueprint and Emastic templates with Django.

The Yahoo! YUI grid has an extra advantage of there being a Django app designed specifically for using YUI grid with Django called [django-yui-layout-templates](http://code.google.com/p/django-yui-layout-templates/)

If you start with one of these frameworks you can build websites **now** and then gradually develop your own CSS over time as you learn the quirks.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-06T20:51:18.463

我唯一的建议是破解伟大的网站。如果你喜欢这个设计，那就破解它。使用[firebug](https://addons.mozilla.org/firefox/addon/1843)是一个很大的进步，因为它为您提供了计算的 CSS。

但是，真正学习 CSS 绝非易事。很抱歉告诉你。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-06T20:54:58.440

[通过访问CSS Zen Garden](http://csszengarden.com/)，我学到了很多关于 CSS 的知识。灵感和学习资源集中在一处。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-06T20:59:20.243

[Firefox 的Web Developer 工具栏中](https://addons.mozilla.org/en-US/firefox/addon/60)的“编辑 CSS”功能允许您编辑文件的 CSS 内容并实时查看结果。它使实验变得更快、更容易。

当您创建了一个出色的样式表后，请在 Internet Explorer 中查看它，哭泣，然后开始学习如何进行跨浏览器 CSS。[quirksmode](http://www.quirksmode.org/)是一个很好的起点。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-06T21:44:55.813

I have to agree that it's a lot of trial and error. There are sometimes many ways to achieve what you need to...some more "proper" than others. CSS Zen Garden was one of the first sites I discovered that really helped things click in my own head. View the design, view the source, view the design, etc...

A couple of books I appreciate having around are [Dan Cederholm's Bullet Proof Web Design](http://simplebits.com/publications/bulletproof/) and

Andy Budd's [CSS Mastery](https://rads.stackoverflow.com/amzn/click/com/1590596145)

Both give solid ways of accomplishing some common techniques and issues you'll run into with css-based designs.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-06T21:29:01.493

*   一、[规格](http://www.w3.org/TR/CSS2/)
*   玩耍（使用 Firebug）
*   窥探 IE 解决方法和其他技巧。
*   如果您想要印刷的东西，我真的很喜欢[Dan Cederholm 的 Web Standards Solution](http://simplebits.com/publications/solutions/)，尽管我讨厌大多数技术书籍
*   Practice! Practice! Practice!

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-07T05:53:17.420

The best book I've read about CSS and HTML is Zeldman's [Designing with Web Standards](https://rads.stackoverflow.com/amzn/click/com/0321385551)

Zeldman covers the historical aspects of HTML and CSS along with converting a table-based website to semantic CSS. He also covers web standards, graceful degradation and browser quirks. It's often considered the 'bible' of modern web development.

After that I'd recommend Dan Cederholm's books [Web Standards Solutions](https://rads.stackoverflow.com/amzn/click/com/1590593812) and [Bulletproof Web Design](https://rads.stackoverflow.com/amzn/click/com/0321509021)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-07T06:05:50.170

I have the book "CSS in easy steps" by Mike McGrath. It has a lot of pictures to visually explain what is going on. It's very handy for getting a strong understanding of CSS. After you learn the basics, it is helpful to talk with people or read examples online. I find myself going to #css on IRC (Freenode) for help. They are very helpful there.

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-07T18:29:50.230

I second (third?) the advice to use [Firebug](https://addons.mozilla.org/en-US/firefox/addon/1843). It will preserve your sanity.

A fine book I've read on CSS design is Wyke-Smith's [Stylin' with CSS](http://www.stylinwithcss.com/). It is not the best title, perhaps, but the content and presentation are excellent. I keep my copy handy whenever I have to delve into style sheets.

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-07T18:35:11.797

If you're developing on a Mac [CSSEdit](http://macrabbit.com/cssedit/) will save you tons of time.

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-07T18:50:06.197

There are more suggestions for learning CSS in [this question](https://stackoverflow.com/questions/132587/the-best-css-tutorial-site-blog-book).

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2010-03-03T22:45:25.390

CSS isn’t really that easy — it kind of stands on its own in terms of its concepts.

If you’re delving into it deeply, [CSS: The Definitive Guide](https://rads.stackoverflow.com/amzn/click/com/0596527330) is well worth it.

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2020-10-29T07:23:53.213

The best way is by changing the way you think about it.

What holds most people back with CSS is in thinking that its a 'styling' language rather than a language you use as the the way to build and construct web based UI's for people to use.

Seeing CSS in the right way helps you dramatically in then gaining enthusiasm for it. And will ultimately lead to you learning much more about it than you otherwise would.

This article elaborates much more on this general idea: [How To Get Better At CSS](https://planflow.dev/blog/how-to-get-better-at-css)

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2013-03-17T19:09:48.360

Well, as per my thinking, Eclipse is the most wanted tool for every coding job.

This tool just turns my life for coding. So I 100% recommend you to use this tool while coding. It works on any platform: PHP, HTML, CSS so whatever it is, this is an obvious tool.

One of most important comments about this tool is this one tells you if an error will occur.

Suppose you write little code of CSS and make a mistake. Then it will tell you where the mistake occurs.

```
body
{
    background-color: #D0E4FE
}

h1
{
    color: orange;
    text-align: center;
}

p
{
    font-family: "Times New Roman";
    font-size: 20px;
} 
```

In above code I didn't put a semicolon in the **background-color** line. It should look like that.

**background-color: #D0E4FE;**

If this error happens, this tool prompts with a message asking the error. So this is a wonderful tool.

Well, the other way is [**W3Schools CSS**](http://www.w3schools.com/css/). It is a better place to learn.

# javascript - this.form.submit(); 有更好的 jQuery 解决方案吗？

> ID：418076
> 
> 赞同：48
> 
> 时间：2009-01-06T20:49:07.220
> 
> 标签：javascript, jquery, forms, submit

我想触发当前元素所在表单的提交事件。我知道有时可行的方法是：

```
this.form.submit(); 
```

我想知道是否有更好的解决方案，可能使用 jQuery，因为我不是 100% 确定方法适用于每个浏览器。

编辑：

我的情况如下：

```
<form method="get">
    <p><label>Field Label
        <select onchange="this.form.submit();">
            <option value="blah">Blah</option>
            ....
        </select></label>
    </p>
</form> 
```

我希望能够提交更改`<select>`.

我正在寻找的是一种解决方案，可以在任何表单中的任何字段上工作，而无需知道表单上的 id 或名称。`$('form:first')`并且`$('form')`不起作用，因为表单可能是页面上的第三个。另外，我已经在网站上使用 jQuery，所以使用一点 jQuery 没什么大不了的。

那么，有没有办法让 jQuery 检索输入/选择/文本区域所在的表单？

* * *

## 回答 #1

> 赞同：114
> 
> 时间：2009-01-07T03:38:35.723

我认为您正在寻找的是这样的：

```
$(field).closest("form").submit(); 
```

例如，要处理 onchange 事件，您需要：

```
$(select your fields here).change(function() {
    $(this).closest("form").submit();
}); 
```

如果由于某种原因您没有使用 jQuery 1.3 或更高版本，您可以调用`parents`而不是`closest`.

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-01-06T21:12:33.927

```
this.form.submit(); 
```

这可能是你最好的选择。特别是如果您还没有在项目中使用 jQuery，则无需为此添加它（或任何其他 JS 库）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-02-12T19:05:29.273

我发现使用 jQuery 最好的解决方案是

```
$(this.form).submit() 
```

使用此语句 jquery 插件（例如[jquery form plugin](http://jquery.malsup.com/form)）可以正常工作，并且 jquery DOM 遍历开销最小化。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-04T06:33:32.523

与[Matthew 的](https://stackoverflow.com/questions/418076/is-there-a-better-jquery-solution-to-this-form-submit/419111#419111)回答类似，我刚刚发现您可以执行以下操作：

```
$(this).closest('form').submit(); 
```

错误：使用父功能的问题是该字段需要立即在表单内才能工作（而不是在 tds、标签等内）。

我的立场是正确的： parent **s**（带 s）也有效。感谢 Paolo 指出这一点。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-06T20:55:08.270

您总是可以[JQuery 化](http://docs.jquery.com/Events/submit)您的 form.submit，但它可能只是调用相同的东西：

```
$("form").submit(); // probably able to affect multiple forms (good or bad)

// or you can address it by ID
$("#yourFormId").submit(); 
```

您还可以[将](http://docs.jquery.com/Events/submit)函数附加到提交事件，但这是一个不同的概念。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-06T21:15:29.883

您的问题有些令人困惑，因为您没有解释“当前元素”的含义。

如果您在页面上有多个表单，其中包含各种输入元素和“提交”类型的按钮，那么在填写任何字段时点击“输入”将触发该表单的提交。你在那里不需要任何Javascript。

但是，如果您在表单上有多个“提交”按钮并且没有其他输入（例如表格中的“编辑行”和/或“删除行”按钮），那么您发布的行可能就是这样做的方式。

另一种方法（不需要 Javascript）可能是为所有按钮（属于“提交”类型）赋予不同的值。像这样：

```
<form action="...">
    <input type="hidden" name="rowId" value="...">
    <button type="submit" name="myaction" value="edit">Edit</button>
    <button type="submit" name="myaction" value="delete">Delete</button>
</form> 
```

当您单击一个按钮时，只会提交包含该按钮的表单，并且只会发送您点击的按钮的值（以及其他输入值）。

然后在服务器上，您只需读取变量“myaction”的值并决定要做什么。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-06T20:52:51.893

在 JQuery 中，您可以调用

```
$("form:first").trigger("submit") 
```

不知道这样会不会好很多。我认为 form.submit(); 是相当普遍的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-17T10:50:35.580

```
<form method="get">
   <p><label>Field Label
      <select onchange="this.form.submit();">
         <option value="blah">Blah</option>
            ....
     </select>
     </label>
   </p>
    **<!-- <input name="submit" type="submit" /> // name="submit_new_name" -->**
  </form>

<!-- 

   this.form.submit == this.form.elements['submit'];

--> 
```

# sql-server - SQL Server 2005 生成的创建表脚本不起作用

> ID：418082
> 
> 赞同：5
> 
> 时间：2009-01-06T20:50:01.510
> 
> 标签：sql-server

我正在为现有数据库创建数据库脚本。我正在尝试使用 SQL Server 为我生成脚本，但生成的脚本失败了。我正在使用 'Script Table As'>'CREATE To'>'New Query Editor Window' 选项。然后我更改表和约束名称并执行脚本。我难住了。任何人都可以在这里看到这个问题吗？

我收到此错误：

```
Msg 170, Level 15, State 1, Line 17
Line 17: Incorrect syntax near '('. 
```

生成的 SQL：

```
USE [MyDatabase]
GO
/****** Object:  Table [dbo].[MyTable2]    Script Date: 01/06/2009 14:40:41 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[MyTable2](
    [id] [int] IDENTITY(1,1) NOT NULL,
    [u_id] [int] NOT NULL,
    [prog_number] [varchar](5) NOT NULL,
    [trans_id] [varchar](50) NULL,
    [code] [varchar](7) NULL,
    [user_num] [char](9) NULL,
    [is_found] [char](9) NULL,
    [status] [char](1) NULL,
    [status2] [char](1) NULL,
    [inserted_timestamp] [datetime] NULL CONSTRAINT [DF_MyTable2_inserted_timestamp]  DEFAULT (getdate()),
    [s_id] [varchar](10) NULL,
    [p_value] [char](4) NULL,
 CONSTRAINT [PK_MyTable2] PRIMARY KEY CLUSTERED 
(
    [id] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-16T17:51:53.337

我有同样的错误。SQL Sever Management Studio 默认为 SQL Server 2005 生成脚本，与 2000 不兼容。

我的解决方案：在 SQL Sever Management Studio 中，转到工具>>选项>>脚本。在“常规脚本选项”下，将“服务器版本脚本”设置为“SQL Server 2000”。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-06T21:56:37.990

如果您的目标数据库是 SQL 2000，那么它会抱怨这一行

```
WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY] 
```

SQL 2000 仅支持

```
WITH FILLFACTOR = 90 
```

所以可能有一些兼容性设置可以用来只生成 SQL 2000 语法

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-06T21:44:07.297

当我使用 SQL Server Management Studio 2005 在 SQL Server 2000 数据库上生成创建表脚本时，我遇到了完全相同的问题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-06T21:52:47.577

如果您在 SQL Server 2000 数据库上运行它，我相信其中包含 SQL Server 2000 不支持的代码。我从未见过将约束设置为表定义的一部分的 SQL SErver 2000 脚本。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-06T20:53:23.797

我复制/粘贴了这个确切的 SQL 语句，它为我正确执行。我唯一能想到的是你有一些突出显示的东西，它只执行它的那一部分（这可能不是一个完整的语句）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-06T20:55:29.173

除了`use [MyDatabase]`语句（我将其更改为`tempdb`）之外，当我使用 Microsoft SQL Server Management Studio 针对 SQL Server 2005 运行该语句时，它可以正确执行。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-01-11T14:20:47.020

使用 Management Studio 2008，您可以创建一个与较低版本的 SQL Server 兼容的脚本，如下所示：

右键单击数据库>>任务>>生成脚本

在该向导中，您可以访问“服务器版本脚本”选项。只需选择您希望脚本运行的 SQL Server 版本。

# vba - VBA 参考库

> ID：418098
> 
> 赞同：6
> 
> 时间：2009-01-06T20:52:30.100
> 
> 标签：vba, reference, ms-office

我是 VBA 新手，一直在为 Office 编写一个小型宏应用程序。我们有大约 80 个用户使用基本相同的 PC 设置，除少数用户外，所有用户都可以访问它。

我一直在尝试使用 Web 服务引用访问网页的一些自动化，并且我还将 Microsoft Scripting Runtime 引用加载到项目中。我试图在测试 PC 上运行它，但它抱怨缺少引用。

我不是特别想去大约 80 台 PC 并手动加载参考。

基本上，我的问题是我应该如何管理这个宏应用程序向 80 多个用户的分发，以确保每次都为每个用户加载引用。

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-06T22:44:21.823

在大多数情况下，后期绑定将解决 VBA 中的引用问题，除非您有一些不寻常的引用。大多数问题是由可以通过后期绑定克服的库版本差异引起的。使用 VBA，通常建议您使用早期绑定进行开发，但使用后期绑定进行发布。后期绑定的主要缺点是将内置常量更改为值（速度不再是过去的问题。）

所以：

```
Dim fs As Object 'Instead of FileSystemObject '
Dim xl As Object 'Instead of Excel.Application '

Set fs=CreateObject("Scripting.FileSystemObject")
Set xl=CreateObject("Excel.Application")

'Value instead of built-in constant '
ForReading=2
Set f = fs.OpenTextFile("c:\testfile.txt", ForReading) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-06T21:04:46.487

如果您有应用程序所依赖的引用，并且您知道不会出现在目标 PC 上，那么我强烈建议您研究一些安装程序技术。

使用安装程序，您应该能够安装宏，并安装和注册所有适当的引用/库。

Windows 上通常有两种风格，基于 Windows Installer 的技术和基于脚本的技术。

我们在所有部署中都使用 InstallShield，尽管有几个选项供您使用（在 Stack Overflow 上有几个讨论）。

使用 Windows 安装程序技术，您可以构建 MSI 安装文件，然后您可以使用组策略自动部署这些文件。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-06T21:20:11.090

除了[这个答案](https://stackoverflow.com/questions/418098/vba-reference-libraries#418156)，这是解决此类问题的防弹解决方案，但实现起来相当复杂，您还可以编写一些代码以在您的 VBA 应用程序启动时执行，检查“引用”集合“应用程序”对象。然后，您可以检查 (1) 请求的文件（dll、ocx、tlb）是否在计算机上可用，以及 (2) 是否可以创建引用（application.references.addFromFile ...）。

注意：可能是“依赖于引用”的对象声明，例如：

```
Dim cat as ADOX.catalog 
```

如果在“编译”相应模块时引用未激活，则会引发编译错误。然后，我建议您将“引用检查过程”隔离在仅处理 VBA 和基本应用程序对象的启动模块（相当于“自动执行”）中。用您的帮助文件检查它（例如：在 Access 中，可以在没有外部引用的情况下使用的默认引用是 VBA、Access 和 DAO）。

编辑：

如果外部引用依赖于其他软件包并且 (1) 不能与 MSI 文件一起分发或 (2) 可以有多个版本，我认为“references.addFromFile”是唯一可以应用的解决方案。例子：

*   您有一个需要引用 Word（msword.olb 文件）的 VBA/Access 运行时客户端应用程序。
*   对于许可问题，您不能随您的 msi 包免费分发此文件
*   olb 文件可以是 'XP 版本或更新版本

我们的解决方案是在客户端 Access 文件上有 2 个表。一个列出在启动时必须检查或添加的所有引用（Word 将是其中之一），另一个列出文件的所有可能位置（取决于用户是否拥有“office11”版本或更新版本一），两个表之间的一对多关系。

因此，最好的策略可能是混合 msi 包和通过代码进行管理：

*   msi 非常适合分发完全“嵌入”在您的应用程序中的独立 dll 或其他文件，例如 activeX 控件（如扫描仪控件、报告或文件查看器等）
*   代码是最好的解决方案，您的应用程序必须与其他应用程序（word、excel、outlook 等）进行通信，这些应用程序可能存在于用户机器上的不同版本中。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-06T21:01:57.490

与其让文档公开功能，不如让它成为 Office 的加载项（套件或单个应用程序，您的选择）。这样，您不必处理引用。

然后，只需分发带有注册组件的加载项的安装包，并将加载项注册到适当的 Office 应用程序。

VB6 在这里可能是一个好主意，因为它与 VBA 相似。

# import - 有没有人尝试过从 trac 到fogbugz 的转换/导入工具？

> ID：418099
> 
> 赞同：2
> 
> 时间：2009-01-06T20:52:34.797
> 
> 标签：import, trac, fogbugz, data-importer

[http://our.fogbugz.com/default.asp?W977](http://our.fogbugz.com/default.asp?W977)

我怀疑这将是一项简单的任务，但只是想在尝试之前先问一下。

如果你用过，效果如何？有什么注意事项或有帮助的事情吗？可以自动撤消更改吗？

你会做不同的事情或事先在 trac 中进行配置以使其更容易吗？

顺便说一句：我对fogbugz 的初始试用感到满意，trac 没有问题，但我真的想要一个自动回复器和一种发送电子邮件至 support@mycompany.com 的方式来创建新票证并回复。简直太专业了。

对项目估算感到好奇，但这不是一个因素。我期待着尝试。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-10T01:53:04.710

我试过了，它在我们的 Wiki 页面上卡住了。我对导入工具将 Trac 字段映射到 FogBugz 字段的方式并不特别兴奋。

另一个问题是，一旦它们在 FogBugz 中，您就无法真正删除它们，因此在第一次导入失败后，我只是关闭了我的 Student & Startup 帐户并开设了一个新帐户。

我最终手动转移了大约 100 个错误，因为我认为其中太多是陈旧的，值得花时间亲自查看每个错误并重新考虑优先级。如果您有更多错误，或者在您的项目中没有以这种方式退后一步查看整个待办事项列表是有意义的，那么这可能不是一个选择。

所有这一切：我爱 FogBugz。我们的用户和测试人员正在收到带有其票证链接的确认电子邮件，这一事实迫使我们的开发人员对收到的请求做出更快的响应，而电子邮件工具使就每个问题进行对话变得容易。就我而言，进口的痛苦是值得的。

# html - 黑莓的嵌入式 HTML 控件？

> ID：418105
> 
> 赞同：5
> 
> 时间：2009-01-06T20:53:26.040
> 
> 标签：html, user-interface, blackberry, java-me, custom-controls

是否有任何 api 用于从您的黑莓应用程序中查看 html 内容？需要明确的是，我并不是指在我的应用程序顶部启动浏览器来查看页面。而是在我的应用程序中呈现页面。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-06T21:10:48.643

是的。查看 net.rim.device.api.browser.field 包或应用程序集成的 Blackberry Browser 部分。

一切都在这里完成：

```
Field field = browserContent.getDisplayableContent(); 
```

请参阅：
[JDE 4.0.0 API 包](http://www.blackberry.com/developers/docs/4.1api/net/rim/device/api/browser/field/BrowserContent.html#getDisplayableContent())
[RIM 应用程序集成指南](http://na.blackberry.com/eng/deliverables/5648/integrating.pdf)

像往常一样只签名api。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-02-21T15:15:21.107

```
//BrowserField is available for 4.5 OS. RIM provide sample app for BrowserField Demo. you can find the sample example and run it.

    /*
 * BrowserFieldDemo.java 
 * 
 * Copyright © 1998-2010 Research In Motion Ltd.
 * 
 * Note: For the sake of simplicity, this sample application may not leverage
 * resource bundles and resource strings.  However, it is STRONGLY recommended
 * that application developers make use of the localization features available
 * within the BlackBerry development platform to ensure a seamless application
 * experience across a variety of languages and geographies.  For more information
 * on localizing your application, please refer to the BlackBerry Java Development
 * Environment Development Guide associated with this release.
 */

package com.rim.samples.device.blackberry.browser;

import java.io.IOException;

import javax.microedition.io.HttpConnection;

import net.rim.device.api.browser.field.*;
import net.rim.device.api.io.http.HttpHeaders;
import net.rim.device.api.system.Application;
import net.rim.device.api.ui.*;
import net.rim.device.api.ui.component.Status;
import net.rim.device.api.ui.container.MainScreen;
import net.rim.device.api.system.*;

/**
 * This sample application demonstrates how to create a web browser using the
 * net.rim.device.api.browser.field package.
 */
public final class BrowserFieldDemo extends UiApplication implements RenderingApplication 
{

    private static String REFERER = "referer";  

    private RenderingSession _renderingSession;   
    private HttpConnection  _currentConnection;
    private MainScreen _mainScreen;

    /**
     * Entry point for application
     * @param args Command line arguments (not used)
     */
    public static void main(String[] args) 
    {
        BrowserFieldDemo app = new BrowserFieldDemo();

        // Make the currently running thread the application's event
        // dispatch thread and begin processing events.
        app.enterEventDispatcher();
    }

    // Constructor
    public BrowserFieldDemo() 
    {       
        _mainScreen = new MainScreen();        
        pushScreen(_mainScreen);
        _renderingSession = RenderingSession.getNewInstance();

        // Enable javascript
        //_renderingSession.getRenderingOptions().setProperty(RenderingOptions.CORE_OPTIONS_GUID, RenderingOptions.JAVASCRIPT_ENABLED, true);                        

        PrimaryResourceFetchThread thread = new PrimaryResourceFetchThread("http://www.google.com", null, null, null, this);
        thread.start();            
    }

    /**
     * Processes an http connection
     * 
     * @param connection The connection to the web content
     * @param e The event triggering the connection
     */
    void processConnection(HttpConnection connection, Event e) 
    {
        // Cancel previous request
        if (_currentConnection != null) 
        {
            try 
            {
                _currentConnection.close();
            } 
            catch (IOException e1) 
            {                
            }
        }

        _currentConnection = connection;

        BrowserContent browserContent = null;

        try 
        {
            browserContent = _renderingSession.getBrowserContent(connection, this, e);

            if (browserContent != null) 
            {
                Field field = browserContent.getDisplayableContent();

                if (field != null) 
                {
                    synchronized (Application.getEventLock()) 
                    {
                        _mainScreen.deleteAll();
                        _mainScreen.add(field);
                    }
                }

                browserContent.finishLoading();
            }

        } 
        catch (RenderingException re) 
        {
            Utilities.errorDialog("RenderingSession#getBrowserContent() threw " + re.toString());
        } 
        finally 
        {
            SecondaryResourceFetchThread.doneAddingImages();
        }

    }    

    /**
     * @see net.rim.device.api.browser.RenderingApplication#eventOccurred(net.rim.device.api.browser.Event)
     */
    public Object eventOccurred(Event event) 
    {
        int eventId = event.getUID();

        switch (eventId) 
        {
            case Event.EVENT_URL_REQUESTED : 
            {
                UrlRequestedEvent urlRequestedEvent = (UrlRequestedEvent) event;    

                PrimaryResourceFetchThread thread = new PrimaryResourceFetchThread(urlRequestedEvent.getURL(),
                                                                                         urlRequestedEvent.getHeaders(), 
                                                                                         urlRequestedEvent.getPostData(),
                                                                                         event, this);
                thread.start();

                break;

            } 
            case Event.EVENT_BROWSER_CONTENT_CHANGED: 
            {                
                // Browser field title might have changed update title.
                BrowserContentChangedEvent browserContentChangedEvent = (BrowserContentChangedEvent) event; 

                if (browserContentChangedEvent.getSource() instanceof BrowserContent) 
                { 
                    BrowserContent browserField = (BrowserContent) browserContentChangedEvent.getSource(); 
                    String newTitle = browserField.getTitle();
                    if (newTitle != null) 
                    {
                        synchronized (getAppEventLock()) 
                        { 
                            _mainScreen.setTitle(newTitle);
                        }                                               
                    }                                       
                }                   

                break;                

            } 
            case Event.EVENT_REDIRECT : 
            {
                RedirectEvent e = (RedirectEvent) event;
                String referrer = e.getSourceURL();

                switch (e.getType()) 
                {  
                    case RedirectEvent.TYPE_SINGLE_FRAME_REDIRECT :
                        // Show redirect message.
                        Application.getApplication().invokeAndWait(new Runnable() 
                        {
                            public void run() 
                            {
                                Status.show("You are being redirected to a different page...");
                            }
                        });

                    break;

                    case RedirectEvent.TYPE_JAVASCRIPT :
                        break;

                    case RedirectEvent.TYPE_META :
                        // MSIE and Mozilla don't send a Referer for META Refresh.
                        referrer = null;     
                        break;

                    case RedirectEvent.TYPE_300_REDIRECT :
                        // MSIE, Mozilla, and Opera all send the original
                        // request's Referer as the Referer for the new
                        // request.
                        Object eventSource = e.getSource();
                        if (eventSource instanceof HttpConnection) 
                        {
                            referrer = ((HttpConnection)eventSource).getRequestProperty(REFERER);
                        }

                        break;
                    }

                    HttpHeaders requestHeaders = new HttpHeaders();
                    requestHeaders.setProperty(REFERER, referrer);
                    PrimaryResourceFetchThread thread = new PrimaryResourceFetchThread(e.getLocation(), requestHeaders,null, event, this);
                    thread.start();
                    break;

            } 
            case Event.EVENT_CLOSE :
                // TODO: close the appication
                break;

            case Event.EVENT_SET_HEADER :        // No cache support.
            case Event.EVENT_SET_HTTP_COOKIE :   // No cookie support.
            case Event.EVENT_HISTORY :           // No history support.
            case Event.EVENT_EXECUTING_SCRIPT :  // No progress bar is supported.
            case Event.EVENT_FULL_WINDOW :       // No full window support.
            case Event.EVENT_STOP :              // No stop loading support.
            default :
        }

        return null;
    }

    /**
     * @see net.rim.device.api.browser.RenderingApplication#getAvailableHeight(net.rim.device.api.browser.BrowserContent)
     */
    public int getAvailableHeight(BrowserContent browserField) 
    {
        // Field has full screen.
        return Display.getHeight();
    }

    /**
     * @see net.rim.device.api.browser.RenderingApplication#getAvailableWidth(net.rim.device.api.browser.BrowserContent)
     */
    public int getAvailableWidth(BrowserContent browserField) 
    {
        // Field has full screen.
        return Display.getWidth();
    }

    /**
     * @see net.rim.device.api.browser.RenderingApplication#getHistoryPosition(net.rim.device.api.browser.BrowserContent)
     */
    public int getHistoryPosition(BrowserContent browserField) 
    {
        // No history support.
        return 0;
    }

    /**
     * @see net.rim.device.api.browser.RenderingApplication#getHTTPCookie(java.lang.String)
     */
    public String getHTTPCookie(String url) 
    {
        // No cookie support.
        return null;
    }

    /**
     * @see net.rim.device.api.browser.RenderingApplication#getResource(net.rim.device.api.browser.RequestedResource,
     *      net.rim.device.api.browser.BrowserContent)
     */
    public HttpConnection getResource( RequestedResource resource, BrowserContent referrer) 
    {
        if (resource == null) 
        {
            return null;
        }

        // Check if this is cache-only request.
        if (resource.isCacheOnly()) 
        {
            // No cache support.
            return null;
        }

        String url = resource.getUrl();

        if (url == null) 
        {
            return null;
        }

        // If referrer is null we must return the connection.
        if (referrer == null) 
        {
            HttpConnection connection = Utilities.makeConnection(resource.getUrl(), resource.getRequestHeaders(), null);

            return connection;

        } 
        else 
        {
            // If referrer is provided we can set up the connection on a separate thread.
            SecondaryResourceFetchThread.enqueue(resource, referrer);
        }

        return null;
    }

    /**
     * @see net.rim.device.api.browser.RenderingApplication#invokeRunnable(java.lang.Runnable)
     */
    public void invokeRunnable(Runnable runnable) 
    {       
        (new Thread(runnable)).start();
    }
}

/**
 * A Thread class to fetch content using an http connection
 */
final class PrimaryResourceFetchThread extends Thread 
{    
    private BrowserFieldDemo _application;
    private Event _event;
    private byte[] _postData;
    private HttpHeaders _requestHeaders;
    private String _url;

    /**
     * Constructor to create a PrimaryResourceFetchThread which fetches the web
     * resource from the specified url.
     * 
     * @param url The url to fetch the content from
     * @param requestHeaders The http request headers used to fetch the content
     * @param postData Data which is to be posted to the url
     * @param event The event triggering the connection
     * @param application The application requesting the connection
     */
    PrimaryResourceFetchThread(String url, HttpHeaders requestHeaders, byte[] postData, Event event, BrowserFieldDemo application) 
    {
        _url = url;
        _requestHeaders = requestHeaders;
        _postData = postData;
        _application = application;
        _event = event;
    }

    /**
     * Connects to the url associated with this object
     * 
     * @see java.lang.Thread#run()
     */
    public void run() 
    {
        HttpConnection connection = Utilities.makeConnection(_url, _requestHeaders, _postData);
        _application.processConnection(connection, _event);        
    }
}

    /////////////////////////////////////////////////////////////////

    /*
 * SecondaryResourceFetchThread.java
 *
 * Copyright © 1998-2010 Research In Motion Ltd.
 * 
 * Note: For the sake of simplicity, this sample application may not leverage
 * resource bundles and resource strings.  However, it is STRONGLY recommended
 * that application developers make use of the localization features available
 * within the BlackBerry development platform to ensure a seamless application
 * experience across a variety of languages and geographies.  For more information
 * on localizing your application, please refer to the BlackBerry Java Development
 * Environment Development Guide associated with this release.
 */

package com.rim.samples.device.blackberry.browser;

import java.util.Vector;

import javax.microedition.io.HttpConnection;

import net.rim.device.api.browser.field.BrowserContent;
import net.rim.device.api.browser.field.RequestedResource;

/**
 * This class provides the ability to set up an http connection if a referrer 
 * exists (a browser making the request).
 */
class SecondaryResourceFetchThread extends Thread 
{

    /**
     * Callback browser field.
     */
    private BrowserContent _browserField;

    /**
     * Images to retrieve.
     */
    private Vector _imageQueue;

    /**
     * True is all images have been enqueued.
     */
    private boolean _done;

    /**
     * Sync object.
     */
    private static Object _syncObject = new Object();

    /**
     * Secondary thread.
     */
    private static SecondaryResourceFetchThread _currentThread;

    /**
     * Enqueues secondary resource for a browser field.
     * 
     * @param resource - resource to retrieve.
     * @param referrer - call back browsr field.
     */
    static void enqueue(RequestedResource resource, BrowserContent referrer) 
    {
        if (resource == null) 
        {
            return;
        }

        synchronized( _syncObject ) 
        {

            // Create new thread.
            if (_currentThread == null) 
            {
                _currentThread = new SecondaryResourceFetchThread();
                _currentThread.start();
            } 
            else 
            {
                // If thread alread is running, check that we are adding images for the same browser field.
                if (referrer != _currentThread._browserField) 
                {  
                    synchronized( _currentThread._imageQueue) 
                    {
                        // If the request is for a different browser field,
                        // clear old elements.
                        _currentThread._imageQueue.removeAllElements();
                    }
                }
            }   

            synchronized( _currentThread._imageQueue) 
            {
                _currentThread._imageQueue.addElement(resource);
            }

            _currentThread._browserField = referrer;
        }
    }

    /**
     * Constructor
     *
     */
    private SecondaryResourceFetchThread() 
    {
        _imageQueue = new Vector();        
    }

    /**
     * Indicate that all images have been enqueued for this browser field.
     */
    static void doneAddingImages() 
    {
        synchronized( _syncObject ) 
        {
            if (_currentThread != null) 
            {
                _currentThread._done = true;
            }
        }
    }

    /**
     * Connects to the requested resource
     * 
     * @see java.lang.Runnable#run()
     */
    public void run() 
    {
        while (true) 
        {
            if (_done) 
            {
                // Check if we are done requesting images.
                synchronized( _syncObject ) 
                {
                    synchronized( _imageQueue ) 
                    {
                        if (_imageQueue.size() == 0) 
                        {
                            _currentThread = null;   
                            break;
                        }
                    }
                }
            }

            RequestedResource resource = null;

            // Request next image.
            synchronized( _imageQueue ) 
            {
                if (_imageQueue.size() > 0) 
                {
                    resource = (RequestedResource)_imageQueue.elementAt(0);
                    _imageQueue.removeElementAt(0);
                }
            }

            if (resource != null) 
            {

                HttpConnection connection = Utilities.makeConnection(resource.getUrl(), resource.getRequestHeaders(), null);
                resource.setHttpConnection(connection);

                // Signal to the browser field that resource is ready.
                if (_browserField != null) 
                {            
                    _browserField.resourceReady(resource);
                }
            }
        }       
    }   

}

    ///////////////////////////////////////////////////////////////////

    /*
 * Utilities.java
 *
 * Copyright © 1998-2010 Research In Motion Ltd.
 * 
 * Note: For the sake of simplicity, this sample application may not leverage
 * resource bundles and resource strings.  However, it is STRONGLY recommended
 * that application developers make use of the localization features available
 * within the BlackBerry development platform to ensure a seamless application
 * experience across a variety of languages and geographies.  For more information
 * on localizing your application, please refer to the BlackBerry Java Development
 * Environment Development Guide associated with this release.
 */

package com.rim.samples.device.blackberry.browser;

import java.io.IOException;
import java.io.OutputStream;

import javax.microedition.io.Connector;
import javax.microedition.io.HttpConnection;

import net.rim.device.api.io.http.HttpHeaders;
import net.rim.device.api.io.http.HttpProtocolConstants;
import net.rim.device.api.ui.UiApplication;
import net.rim.device.api.ui.component.Dialog;
import net.rim.device.api.util.StringUtilities;

/**
 * This class provides common functions required by the 
 * BrowserContentManagerDemo and BrowserFieldDemo. This class allows the
 * aforementioned classes to make a connection to a specified url.
 */
class Utilities 
{
    /**
     * Connect to a web resource
     * @param url The url of the resource
     * @param requestHeaders The request headers describing the connection to be made
     * @param postData The data to post to the web resource
     * @return The HttpConnection object representing the connection to the resource, null if no connection could be made
     */
    static HttpConnection makeConnection(String url, HttpHeaders requestHeaders, byte[] postData) 
    {
        HttpConnection conn = null;
        OutputStream out = null;

        try 
        {
            conn = (HttpConnection) Connector.open(url);           

            if (requestHeaders != null) 
            {
                // From
                // http://www.w3.org/Protocols/rfc2616/rfc2616-sec15.html#sec15.1.3
                //
                // Clients SHOULD NOT include a Referer header field in a (non-secure) HTTP 
                // request if the referring page was transferred with a secure protocol.
                String referer = requestHeaders.getPropertyValue("referer");
                boolean sendReferrer = true;

                if (referer != null && StringUtilities.startsWithIgnoreCase(referer, "https:") && !StringUtilities.startsWithIgnoreCase(url, "https:")) 
                {             
                    sendReferrer = false;
                }

                int size = requestHeaders.size();
                for (int i = 0; i < size;) 
                {                    
                    String header = requestHeaders.getPropertyKey(i);

                    // Remove referer header if needed.
                    if ( !sendReferrer && header.equals("referer")) 
                    {
                        requestHeaders.removeProperty(i);
                        --size;
                        continue;
                    }

                    String value = requestHeaders.getPropertyValue( i++ );
                    if (value != null) 
                    {
                        conn.setRequestProperty( header, value);
                    }
                }                
            }                          

            if (postData == null) 
            {
                conn.setRequestMethod(HttpConnection.GET);
            } 
            else 
            {
                conn.setRequestMethod(HttpConnection.POST);

                conn.setRequestProperty(HttpProtocolConstants.HEADER_CONTENT_LENGTH, String.valueOf(postData.length));

                out = conn.openOutputStream();
                out.write(postData);

            }
        } 
        catch (IOException e1) 
        {
            errorDialog(e1.toString());
        } 
        finally 
        {
            if (out != null) 
            {
                try 
                {
                    out.close();
                } 
                catch (IOException e2) 
                {
                    errorDialog("OutputStream#close() threw " + e2.toString());
                }
            }
        }    

        return conn;
    }

    /**
     * Presents a dialog to the user with a given message
     * @param message The text to display
     */
    public static void errorDialog(final String message)
    {
        UiApplication.getUiApplication().invokeLater(new Runnable()
        {
            public void run()
            {
                Dialog.alert(message);
            } 
        });
    }
} 
```

# c# - C# 从服务（和在 Vista 中）运行 Windows 窗体应用程序

> ID：418119
> 
> 赞同：7
> 
> 时间：2009-01-06T20:55:36.910
> 
> 标签：c#, winforms, windows-services, windows-vista

我正在用 C# 编写一个需要作为服务运行但也需要用户交互的应用程序。我知道服务没有 UI 等，所以我将我的程序划分为一个 windows 窗体应用程序和一个可以相互通信的服务。

我遇到的问题是我需要该服务来确保 Windows 窗体应用程序始终在运行，如果不是，则重新启动它。我能够检测它是否正在运行，并在 Windows 2000/XP 上使用以下代码重新启动它：

```
System.Diagnostics.Process.Start("ExePath"); 
```

但在 Vista 上，它将新进程作为用户不可见的本地/系统进程运行。有人解决这个问题吗？是否有某种方法可以检测当前登录的用户并以该用户身份运行新进程？在这一点上，我不需要考虑快速用户切换。一些东西 - 任何东西 - 基本就足够了。

如果您对此主题有任何帮助或提示，我将不胜感激。

我需要澄清一下，我在安装服务时设置了“允许服务与桌面交互”选项。这就是允许它在 2000/XP 上工作的原因。但是，Vista 仍然存在上述问题。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-06T21:07:21.567

这种事情的一般想法是，如果用户需要与服务交互，他们应该启动一个单独的应用程序。如果您想帮助他们，您可以通过在启动菜单中放置快捷方式来配置该单独的应用程序以从 Windows 启动。您还可以在应用程序中构建崩溃恢复，以便它可以自动重新启动。

您不应该真正依赖于监视表单应用程序，如果没有人登录怎么办？如果多人登录怎么办？以这种方式做事只会变得一团糟。

让服务坐在那里并向听众广播是要走的路。当表单应用程序启动时，它可以通知它想要监听事件的服务。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-06T22:04:41.310

请参阅问题：[Windows 服务如何执行 GUI 应用程序？](https://stackoverflow.com/questions/267838/how-can-a-windows-service-execute-a-gui-application). 它解决了来自 C/C++ 的相同问题（简短回答：CreateProcessAsUser），但对于 C#，答案仍然有效（带有一些 P/Invoke）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-06T20:58:34.097

在这种情况下，您将必须有第三个监视器进程来检测程序是否失败并在这种情况下重新启动它。

但是，您最终会遇到一个无法解决的问题，因为必须监视监视器进程以确保它不会被关闭，等等，等等，等等。

您可能需要重新考虑这种方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-06T21:27:50.013

这是一个艰难的局面。正如在几个地方所提到的，如果您*必须*拥有 UI，那么从技术上讲，您不应该使用服务。毕竟，服务在没有用户登录的情况下运行。如果没有人登录，您将无法拥有 UI。

通常，当我需要一项服务需要与外界通信时，我会选择两件事。我可以在事件日志中放置一个条目，也可以将消息放入队列中。

在你的情况下，我会使用队列。当用户登录时，您可以为他们自动启动一个监控队列的应用程序。如果应用程序正在运行，当收到消息时，它们也会以这种方式收到警报。但是，如果用户关闭应用程序，则会发生同样的事情......他们不会知道。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-06T21:36:01.290

首先，快速回答：“允许服务与桌面交互”选项（服务 -> 属性 -> 登录）或指定帐户是否允许您想要的？如果是这样，这两个都可以在您的服务安装程序类上进行配置。

像其他人一样，我怀疑有更好的方法来解决这个问题，并且以下任何一个都是正确的： - 服务内的代码可以包含在 winforms 应用程序中（可能在后台线程中运行），并添加到 Windows 启动中。两者都将运行 - winforms 应用程序可以在服务启动时监听服务，不需要从服务启动。或者类似地，可以将应用程序添加到启动中。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-04-20T19:22:46.360

要让您的服务以用户身份运行应用程序（这似乎是您正在尝试做的事情），您需要执行以下操作：

```
System.Security.SecureString ss = new System.Security.SecureString();

foreach (char c in password)
  ss.AppendChar(c);

System.Diagnostics.Process proc = Process.Start(path, arguments, username, ss, domain); 
```

在哪里：

*   path = 可执行文件的完整路径（包括文件名）。
*   arguments = 参数字符串（使用空字符串是无）
*   用户名 = 您的服务器/计算机上的用户帐户名称
*   domain = 您的网络域（如果您使用网络帐户 - 如果没有则为空白）

此外，为了让您的服务有权启动应用程序，它也必须作为服务运行。为此，您需要将这些行添加到您的服务安装程序类中：

```
serviceProcessInstaller.Account = ServiceAccount.User;

serviceProcessInstaller.Username = "yourdomain\\yourAccountName"; //Or just "AccountName" for local accounts..            

serviceProcessInstaller.Password = "yourPassword"; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-06T21:20:27.330

在 Windows 2000 和 XP 中，服务属性窗口的登录选项卡上有一个选项（复选框），允许服务与桌面交互。我相信这就是您正在寻找的。我刚刚在 VB.NET 中使用 Process.Start("calc.exe") 编写了一个快速服务，并且 Windows 计算器打开得很好。

我不是 100% 确定这在 Vista 中的工作方式相同。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-06T21:23:54.450

听起来您可能不需要将其中的一半作为服务运行（除非需要更高的权限），因为您的服务也需要应对没有交互式用户登录的情况。

# haskell - 您对辅助函数的命名约定是什么？

> ID：418120
> 
> 赞同：10
> 
> 时间：2009-01-06T20:55:44.133
> 
> 标签：haskell, functional-programming, naming-conventions

在函数式编程中，将任何“循环”代码优化为尾递归通常很重要。然而，尾递归算法通常分为两个函数 - 一个设置基本情况，另一个实现实际循环。一个好的（尽管是学术的）例子是反向函数。

```
reverse :: [a] -> [a]
reverse = reverse_helper []

reverse_helper :: [a] -> [a] -> [a]
reverse_helper result [] = result
reverse_helper result (x:xs) = reverse_helper (x:result) xs 
```

“reverse_helper”并不是一个很好的描述性名称。但是，“reverse_recursive_part”很尴尬。

对于这样的辅助函数，您会使用什么命名约定？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-01-06T22:43:15.243

您可以随心所欲地调用辅助函数，只要您不将辅助函数放在“全局”命名空间中，这无关紧要。简单地添加一个“素数”似乎是一种常见的做法。:) 例如，在 Haskell 中，

```
reverse :: [a] -> [a]
reverse = reverse' []
    where reverse' :: [a] -> [a] -> [a]
          reverse' result [] = result
          reverse' result (x:xs) = reverse' (x:result) xs 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-06T22:34:39.347

我总是使用do_，比如“do_compute”和“compute”。我发现它非常具有描述性，因为它实际上是执行操作的函数的一部分，而被调用的“计算”需要为外部世界提供一个简单的描述性名称。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-06T23:21:21.377

我同意 ShreevatsaR 的观点，如果您不将辅助函数设为顶级（或者更糟，将其放在导出列表中），那么它的名称无关紧要。我倾向于调用辅助函数`f`和`g`.

```
reverse :: [a] -> [a]
reverse = f []
  where
    f ys []     = xs
    f ys (x:xs) = f (x:ys) xs 
```

我只是将这个命名方案用于小函数（否则我不知道`f`指的是什么）。再说一次，你为什么要写大函数？

但是，如果您确实想导出您的“助手”功能，因为它可能对其他人有用，我会称之为：

```
reverseAccumulator 
```

像 Haskell`zip`和`zipWith`. 但我不会调用那些“帮助”函数，`zipWith`它只是一个通用函数并且`zip`是默认实现（可能是使用最多的那个）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-06T21:01:51.780

我倾向于在末尾添加“_recurse”。所以“reverse_recurse”。不知道我从哪里得到的。我喜欢像您在示例中那样简单地保留基本案例功能。它往往是“公共”函数，并且它使用辅助函数来执行迭代的事实与调用者无关。在 javascript 中，我有时甚至会通过闭包隐藏迭代函数，以明确它不是直接调用的。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-07T01:31:28.507

我使用`aux`or `foo_aux`（用于 main 函数`foo`），并嵌套定义，使其在外部不可见。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-07T09:19:39.453

我也同意 ShreevatsaR 的观点，在这个例子中，我会将助手设为私有函数。

对于我需要帮助函数在整个模块中可见但不导出的其他情况，我倾向于在函数前加上'_'。当然，有明确的导出语句，但在开发过程中，我倾向于导出所有函数以简化交互式探索，例如在 ghci 中。稍后，我添加了导出函数的列表，并且下划线可以很容易地记住我是否打算将函数作为本地函数。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-06T20:59:50.490

设置并执行

例子：

```
function whateverSetup() { ... }
function whateverExecute() { ... } 
```

# c++ - 修改非常量对象的编译器错误

> ID：418121
> 
> 赞同：-1
> 
> 时间：2009-01-06T20:56:09.077
> 
> 标签：c++

```
 #include "iostream"
 #include "vector"

 class ABC {

  private:
      bool m_b;
  public:
      ABC() : m_b(false) {}

      ABC& setBool(bool b) {
          m_b = b;
          return *this;
      }

      bool getBool() const {
          return m_b;
      }
};

 void foo(const std::vector<ABC> &vec) {

      vec[0].setBool(true);
 }

 int main(int argc, char*argv[]) {

     std::vector<ABC> vecI;
     ABC i;
     vecI.push_back(i);
     foo(vecI);
 } 
```

当我编译它时，我得到这个错误：`const ABC`作为`this`参数传递`ABC& ABC::setBool(bool)`丢弃限定符

任何想法为什么会发生这种情况，因为对象本身不是常数。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-06T21:04:44.037

foo 通过对 const 的引用获取 vec，并且您不能更改 const。所以要么删除调用 setBool 的行，或者如果你真的想设置 bool，请将参数类型更改为 std::vector&。

或者对实现更严格......你看，这两个函数存在：

```
T& vector<T>::operator[](int);  
T const& vector<T>::operator[](int) const; 
```

当您在 const 对象上调用“vec[i]”时，只有第二个有效，因此它被选中。但是这个重载显然会返回 T const&，这是你无法改变的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T21:07:53.517

`foo`接受 a `const vector &`，表示向量的内容不能被修改。反过来，这意味着您不能在 和 的任何元素上调用非常量成员`vec`函数`setBoo`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-06T21:09:38.083

该对象可能是常量。尽管向量包含 ABC 而不是 const ABC，但向量本身是 const，因此当您在其上调用 operator[] 时，使用的是 const 版本的运算符。向量上的 const 版本的 operator[] 返回一个 vector::const_reference。因此，据我所知，您正在尝试在 const ABC& 上调用非常量方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-06T21:14:18.310

作为另一种解决方法，您可以将指向 ABC 对象的指针存储在向量中，它会正常工作 - 尽管需要额外的管理清理成本。在这种情况下，您不会修改向量的内容，因为向量仅保存指针。

# css - 我的 html 文件中可以有多个 css 文件吗？

> ID：418125
> 
> 赞同：0
> 
> 时间：2009-01-06T20:57:12.540
> 
> 标签：css, django

我正在使用 django 框架并且正在使用模板，继承了很多管理基础模板。想知道的是：我可以在一个 HTML 文件中有多个 CSS 文件吗？即维护 django admin CSS 文件，然后拥有我自己的另一个不同样式的 CSS 文件！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-06T20:59:02.677

是的你可以。只需将标签放置到 CSS 文件中或将样式嵌入到样式标签中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T20:58:14.673

是的你可以。但是，如果您尝试覆盖 django admin CSS 中的任何 CSS，则必须在样式定义中使用 !important。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-06T21:16:08.180

只是补充一点，虽然多个 css 文件当然是可能的，但实际上最好的做法是将 css（如果可能，以编程方式）合并到尽可能少的文件中。

更少的文件 = 更少的 http 请求 = 为最终用户提供更好的响应能力。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-01-06T21:00:41.643

当然，这就是它们被称为级联样式表的原因，因为您可以连续应用十几个。

# java - 关于 ORM + RDBMS 的替代方案的想法？

> ID：418146
> 
> 赞同：7
> 
> 时间：2009-01-06T21:01:19.490
> 
> 标签：java, database, persistence

我目前正在开发*替代数据存储*的概念证明。之所以需要增强一个以读取为主的集群 webapp，也是因为我想摆脱有时[过于复杂的 ORM+RDBMS 解决方案](http://willcode4beer.com/design.jsp?set=kill_your_db)的痛苦。

总的来说，这个想法非常类似于*具有持久性*的分布式缓存（让集群成为 SoR），但是：

*   希望能够通过 id（提供类和 id）检索任何对象及其子对象 [仅开始，因为主要查询部分已在我的应用程序中使用 lucene 解决]。
*   需要有类型映射的映射（~关系世界中的表），并在其中分发“脱水”存储对象的映射（通过反射深度克隆展平对象图）
*   一个 bin 日志（例如 Prevayler）
    *   如果整个集群出现故障，最终恢复
    *   开发（以及重构代码/更改结构的能力）
    *   可能出于其他目的异步处理（报告等）
*   最终稍后尝试集成静态类型查询机制，如 LINQ、Jaque 或 H2 的 JaQu / 参见 ODBs / Lucene (?)
*   它必须是事务感知的（虽然不确定“JTA 类型”）

我计划用 Hazelcast（我喜欢它超级简单的 API）或 Terracotta（我从未使用过——但我知道他们的“最佳位置”，中期数据）来实现这个想法。如果你愿意，我的目标是或多或少地[做 Jonas 曾经写过的博客](http://jonasboner.com/2007/06/27/invert-your-database-caching-dependency-for-extreme-scalability/)。使用其中之一，存储的数据大致必须适合集群的 JVM 堆的总和。

这应该很容易扩展，可以避免关系阻抗不匹配（即保存为 ODB）和 JDBC + I/O 开销。

您是否知道其他工具/框架或其组合已经提供了类似的功能，而我忽略了？你能建议其他方法来解决这个“摆脱数据库”吗？你已经在这个想法中看到了哪些缺陷？在并发方面考虑 Scala 而不是 Java 是否有意义？

Couch DB、Neo4j、HyperTable、HBase 等非关系型数据存储怎么样？

一个月前有人问过一个[类似的问题](https://stackoverflow.com/questions/346647/on-using-terracotta-as-a-persistence-solution)——但没有具体的解决方案。

顺便说一句，我刚刚偶然发现了[Enterprise Data Fabric](http://en.wikipedia.org/wiki/Enterprise_Data_Fabric)的概念，令我惊讶的是，它描述了很多这样的想法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-06T22:50:56.553

一定要试试[Terracotta 。](http://www.terracotta.org/)它是免费的（除非您选择具有 SLA 和支持的企业版）。可以这么说，它是一个 JVM 级别的集群，因此您不会遇到与不同 JK 工作人员后面的多个盒子上的会话相关的问题（假设您将它用于 J2EE 应用程序）。

我只是漫无边际，所以看看这里：[http ://en.wikipedia.org/wiki/Terracotta_Cluster](http://en.wikipedia.org/wiki/Terracotta_Cluster)

**在网上更新**关于兵马俑的大量信息，例如[http://blog.terracottatech.com/2007/12/fud_of_the_week_terracotta_doe.html](http://blog.terracottatech.com/2007/12/fud_of_the_week_terracotta_doe.html)

**更新2**关于我的观点的一些背景知识：我在一家拥有相当多受众的公司工作。我们有一个企业级 MySQL，运行一个主服务器和大约 5 个从属服务器（考虑到我们有 2 个通道，每个通道有 4 个应用程序服务器，乘以 2），使用 MySQL 的 JDBC 复制驱动程序（我们已经为此提交了各种补丁）。我们使用 Spring2.5/Hibernate3 并使用 Spring 的声明式 JTA 事务管理，因此只读到从属。随着我们网站未来版本中大量 Ajax 增强功能的出现，我们的数据库服务器的负载增加了 - 我们为所有国家/地区创建了数千种产品的定价摘要，同时考虑了所有这些国家/地区的关税/税收规则（加上促销并且实时拍卖一直在运行），那么 Ajax 服务就会在眨眼间获得最新的价格。Terracotta 通过将这些价格提供给 JVM 层上的所有应用程序服务器来减轻数据库和应用程序服务器的负担，并且所有 JVM 都链接在一起。因此，服务器 A 可以每隔几分钟更新一次价格，如果 Ajax 访问服务器 B，价格就会立即可用。我知道有些人/公司有类似的业务，他们可能有更好的想法和实施，所以我总是愿意讨论，但这是我的两分钱。

我也从 Facebook 的人那里获得灵感，例如这篇内容丰富的文章： [http ://www.facebook.com/note.php?note_id=23844338919](http://www.facebook.com/note.php?note_id=23844338919)

他们谈论[memcached](http://en.wikipedia.org/wiki/Memcached)，你也应该检查一下。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-08T12:36:33.377

正如问题中提到的[Neo4j](http://neo4j.org/)一样，在这种情况下，我对使用图形数据库提出了一些想法。（我是 Neo4j 团队的一员）

*   在图形数据库中检索孩子是微不足道的
*   neo4j 有一个[地图实现](http://components.neo4j.org/index-util/apidocs/index.html)
*   由于图形是图形数据库的原生图形，因此您可以考虑不要展平对象图形，而是将数据保存在节点和边/关系中（这使您在处理数据时具有更大的灵活性）
*   neo4j 是完全事务性的

随着当今新的数据库技术的出现，如果您的数据不适合关系范式，则确实没有必要继续使用 RDBMS。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-27T07:02:06.493

在我看来，Terracotta 非常适合您的要求：

*   集群地图以通过键检索子项（例如集群地图）
*   地图地图 - 没问题
*   没有明确的 bin 日志 - 但 Terracotta 已经将所有内容保存到磁盘，因此已经支持完整的集群重启
*   已经集成到 Compass、Hibernate Search 和 Lucene 进行搜索
*   交易？太慢了。将缓存用作数据存储。有了持久性，您就不会丢失写入（集群）内存的数据并回溯到数据库。

此外，Terracotta 会执行您要求的“反射”操作——尽管它不使用反射，因为这太慢了。它使用 BCM。只有更改才会在网络上传播。

Hazelcast btw 需要序列化，因此它会很慢，并且在使用 maps 数据结构的映射时根本不会做得很好（每个 put 都会导致整个网络上的完整深度克隆副本）并且它没有内置任何类型的持久性.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-06T23:10:25.093

有趣的。

我认为我们都开发了一个动物园，其中包含我们在项目中习惯使用的所有抽象层。而且每个抽象层都是完全不同的动物。

我的目标是尽量减少花在照顾和喂养动物上的时间，因为这让我无法解决手头的问题——这是开销——浪费资源。因此，我们可以摆脱的抽象层越少、越简单，我们的生产力就越高。

我通常可以很好地使用两个小动物——OOP 和 RDBMS，通过漂亮、简单、最小、手工制作的 DAL 进行耦合。对我来说，ORM 主要是开销 - 一个抽象太多，而且非常饥饿。

不要忽视将存储过程视为抽象工具的选择。如果您对 SQL 非常熟悉，那么它可能是实现轻量级 BL 外观的有用资源，这意味着无需考虑 ORM 问题。

无论如何，这篇文章建议出现 RDBMS 的替代品来满足某些需求。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T12:38:51.297

感谢您的回答。

实际上，您谈论的是 DB，这是我想完全从图片中删除的东西。

我的目标用例是一家初创公司的中小型集群 web 应用程序（局域网或云中的盒子）。它需要以 ~RAM 的速度检索对象并相当容易地扩展。作为副作用，人们不必考虑数据库服务器安装、阻抗不匹配、JDBC、缓存、使用注释污染域模型等。

同样，我想要完成的事情就像[这里](http://willcode4beer.com/design.jsp?set=kill_your_db)描述的那样，我希望对有关实际实现的想法有更多反馈（为什么使用 Terracotta 而不是 Hazelcast，使用序列化或通过反射或其他方式进行深度克隆，以及像这样的方法的主要缺点——例如，你为什么不为你当前的 ORM/DB 设置改变它）。

它必须非常易于集成，因此它将具有非常简洁的 Java API，从而提高代码的可读性。无需其他软件（需要 DB、memcached）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-07T12:55:31.140

试试[GigaSpaces](http://www.gigaspaces.com/)。我认为他们正是你所需要的，如果我没记错的话，有一个免费版本的初创公司。

一些概念：

*   “空间”是您可以存储和检索对象的地方
*   空间可以由任何符合 JDBC 的数据库自动支持（无需代码，仅配置）
*   空间可以在您的 java 进程中启动，因此所有访问都以 RAM 速度进行
*   可以以任何您想要的方式（完整镜像、部分、网格）对空间进行集群/分区。
*   空间支持分布式或本地事务

检查他们的[wiki](http://www.gigaspaces.com/wiki/display/XAP66/Programmer%27s+Guide)，（但只有“程序员指南” - 其余的都是营销 BS）。

# redirect - 如果提要的 url 发生变化，RSS 阅读器可以跟随重定向吗？

> ID：418154
> 
> 赞同：3
> 
> 时间：2009-01-06T21:04:26.580
> 
> 标签：redirect, rss

我们正在迁移到 Sharepoint 解决方案，并且我们的网址略有变化。

大多数 RSS 阅读器是否能够在不中断提要和手动更新的情况下跟踪重定向链接？

我正在阅读的大多数文档都说这适用于主要的 RSS 阅读器。

我在某些地方读到很多 RSS 阅读器会将 301 视为临时重定向，而不是更新其存储的 url。这有什么道理吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-06T21:08:10.100

假设您使用的是 301 重定向，我会说是的，因为任何值得一读的阅读器都是基于兼容的 HTTP 库构建的，该库将遵循 301 状态代码并遵循重定向。

当然，用您选择的读者进行测试并不*难*。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T22:27:05.510

几乎每个 RSS 阅读器（主要或次要）都会在遇到 301 重定向时更新提要 URL。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-06T23:18:34.500

根据我的（有限）经验，大多数应用程序将忽略永久重定向的“永久”部分，并执行与临时重定向相同的逻辑。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-03T07:15:11.860

可能有必要使其网站 velindekserede 左右。怎样做才能保持 PageRank、链接流行度和流量？

据我了解，该解决方案称为 301 重定向。它告诉搜索引擎该 URL 已被永久移动。如何以特殊方式进行重定向。在此链接上，根据您使用的服务器技术类型，有不同的选项：

[http://www.webconfs.com/how-to-redirect-a-webpage.php](http://www.webconfs.com/how-to-redirect-a-webpage.php)

我只是在实践中尝试过。我在所有网站上都使用 PHP 本身，所以我使用了 PHP 说明：

我撕掉了所有旧页面的标签和内容，并将小代码片段放在页面上。页面的新 URL 的囚徒，并保存它。通过键入旧 URL 测试页面，然后重定向工作。为了绝对确定重定向对搜索引擎友好，我使用了这个“搜索引擎友好重定向检查器”：

[http://www.webconfs.com/redirect-check.php](http://www.webconfs.com/redirect-check.php)

对于 301 重定向的工作情况以及它是否可以将整个站点转移到新域（[http://www.webmasterworld.com/link_deve](http://www.webmasterworld.com/link_deve) ... 135964.htm）没有分歧，但人们的经验表明它已经足够好了。您只需确保新 URL 具有与旧页面相同的内容

# iis - IIS 6 - 按名称对网站进行排序

> ID：418158
> 
> 赞同：2
> 
> 时间：2009-01-06T21:05:15.893
> 
> 标签：iis, iis-6, windows-server-2003

在 Server 2003 机器上的 IIS 6 中，当我查看网站列表时，它没有按字母顺序列出它们。我假设它会根据他们的网站 ID 对它们进行排序。

我有一台服务器暂时不会升级到 2008，它托管了大约 40 个网站。通过列表查找需要修改的网站对我来说变得相当麻烦。有没有办法根据网站名称按字母顺序对这些网站进行排序？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-06T21:10:06.383

你的意思是树视图项目吗？据我所知，你不能。如果您指的是在树视图中选择“网站”时看到的列表视图，您可以单击列表视图标题列对它们进行各种排序。

如果您没有看到任何列，请点击 View > Add Remove Columns 并确保显示所有列。

[替代文字 http://img132.imageshack.us/img132/4623/iissortpl0.png](http://img132.imageshack.us/img132/4623/iissortpl0.png)

# silverlight - 如何正确设置 Silverlight UserControl 的高度？

> ID：418171
> 
> 赞同：1
> 
> 时间：2009-01-06T21:08:57.260
> 
> 标签：silverlight

我无法让我的 silverlight 控件高于 600。请参阅下面的代码以重现此行为。请注意，色带在 exaclty 600 处停止。谁能告诉我如何让这个示例显示网格中的所有行？

```
<html xmlns="http://www.w3.org/1999/xhtml" >
<head runat="server">
    <title></title>
</head>
<body>
    <form id="form1" runat="server">
        <asp:ScriptManager ID="ScriptManager1" runat="server"></asp:ScriptManager>
        <div>
            <asp:Silverlight ID="Xaml1" runat="server" Source="~/ClientBin/IT.xap" MinimumVersion="2.0.31005.0" Width="100%" Height="100%" />
            </div>
    </form>
</body>
</html>

<UserControl xmlns:my1="clr-namespace:System.Windows.Controls;assembly=System.Windows.Controls.Data" x:Class="IT.Test"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
    Width="400" Height="1225">
    <Grid x:Name="LayoutRoot" Background="White">
        <Grid.RowDefinitions >
            <RowDefinition Height="175"/>
            <RowDefinition  Height="175"/>
            <RowDefinition  Height="175"/>
            <RowDefinition  Height="175"/>
            <RowDefinition  Height="175"/>
            <RowDefinition Height="175" />
            <RowDefinition Height="175" />
        </Grid.RowDefinitions>

        <Rectangle Grid.Row="0" Fill="Green"/>
        <Rectangle Grid.Row="1" Fill="Red" />
        <Rectangle Grid.Row="2" Fill="Blue" />
        <Rectangle Grid.Row="3" Fill="Orange"/>
        <Rectangle Grid.Row="4" Fill="Yellow" />
        <Rectangle Grid.Row="5" Fill="Black" />
        <Rectangle Grid.Row="6" Fill="Aqua"/>

    </Grid> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-06T21:36:18.640

我将网格的背景设置为灰色 (Background="Gray") 并将所有行高设置为 50 以查看发生了什么。我认为您的 UserControl 比浏览器的视口高，但由于它是空的，因此滚动条没有出现。所以我在底部得到一条灰色带，一直到该页面的底部。

编辑：如果您想要一个占据整个视口的 UserControl，请从 UserControl 标记中删除 Width 和 Height。

# python - 为什么 Python 的 string.printable 包含不可打印的字符？

> ID：418176
> 
> 赞同：13
> 
> 时间：2009-01-06T21:10:31.780
> 
> 标签：python, character-encoding

我在一个问题中有两个 String.printable 之谜。

首先，在 Python 2.6 中：

```
>>> string.printable
'0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!"#$%&\'()*+,-./:;<=>?@[\\]^_`{|}~ \t\n\r\x0b\x0c' 
```

查看字符串的末尾，您会发现 '\x0b\x0c' 像大拇指一样突出。他们为什么在那里？我正在使用设置为澳大利亚设置的机器，所以不应该有任何重音字符等。

接下来，尝试运行以下代码：

```
for x in string.printable: print x,
print
for x in string.printable: print x 
```

第一行成功打印了由空格分隔的所有字符。这两个奇怪的字符变成了男性和女性符号。

第二行成功打印除最后一个由换行分隔的所有字符。男性符号打印；女性符号被替换为缺少的字符（一个框）。

我敢肯定 Python 的本意不是带有性别偏见，那么有什么区别呢？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-01-06T21:15:36.713

“可以显示在屏幕上”的“可打印”有所不同。您的终端将低 ascii 打印机控制代码 0x0B 和 0x0C 显示为男性和女性符号，因为这就是字体中的索引所包含的内容。这些字符更准确地描述为垂直制表符和换页符。这两个字符以及 \t \r 和 \n 都是可打印的，并且可以在打印机上进行明确定义的操作。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-06T22:27:59.097

从 cmd.exe 中：

```
>>> print '\x0b'
♂
>>> print '\x0c'
♀
>>> print '\f' # form feed
♀
>>> print '\v' # vertical tab
♂
>>> 
```

Emacs 内部：

```
>>> print '\f\v'
^L^K 
```

[这是formats(5)](http://docs.sun.com/app/docs/doc/819-2252/formats-5?a=view) '手册页的摘录：

```
| 序列 | 性格 | 终端行动 |
|----------+--------------+---------- ----------------------|
| \f | 换页 | 将打印位置移动到初始 |
| | | 下一个逻辑页的打印位置。|
| \v | 垂直标签 | 将打印位置移动到 | 的开头
| | | 下一个垂直制表位置。如果有|
| | | 没有更多的垂直标签位置留在 |
| | | 页面，行为未定义。|

```

# spring-mvc - Spring 2.5 如何将传入的请求数据映射到 ModelAttribute 命令？

> ID：418178
> 
> 赞同：0
> 
> 时间：2009-01-06T21:10:48.987
> 
> 标签：spring-mvc

我曾经使用过 Spring 2.0，现在我正在使用 Spring 2.5 当然，就 Web 控制器而言，Spring 2.5 让生活变得非常轻松。这个问题一直在我脑海中浮现，在 2.0 中，我们必须设置命令类，并相应地设置 AbstractFormController 用于为我们填充该命令对象。在 Spring 2.5 中我们不这样做，那么它是如何知道要使用哪个类的呢？它是否取决于我们将 @ModelAttribute("command") 注释为的参数类型？

如果是，那么请让我知道任何提供确切机制的“Utils”类，其中我可以传递 HttpRequest 和类名（或类对象），这将返回我填充的对象！

希望你能得到我的问题。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-07T07:22:36.863

Web MVC 注释绑定最终依赖于

org.springframework.beans.AbstractPropertyAccessor

它有两个具体的实现：

org.springframework.beans.BeanWrapperImpl org.springframework.beans.DirectFieldAccessor

两者都接受一个 Java 对象，该对象将成为为其设置属性的目标。

第一个，BeanWrapperImpl 使用 java 对象的 setter/getter 方法，而另一个直接设置字段。两者都检查方法/字段是否是公共的/可访问的，否则，使用反射的 setAccessible(true) 来确保可以设置它。

从 Web MVC 创建 AbstractPropertyAccessor 的实例，并将 HttpRequest 的参数映射传递给 AbstractPropertyAccessor#setPropertyValues。

调用后，java 对象将填充地图中的任何内容

# php - MySql并在链接表中插入数据，如何？

> ID：418183
> 
> 赞同：1
> 
> 时间：2009-01-06T21:11:57.767
> 
> 标签：php, mysql

MySql（第 4 版）从 PHP thtree Inserts 写入并确保我们可以正确链接表的技巧是什么。

```
[Table1]-[LinkTable]-[Table2] 
```

在 PHP 代码中，我创建了一个插入，在表 1 中添加 1 行，另一个插入在表 2 中添加另一行。我得到两行 PK（主键）和两个 SELECT，它们返回每个表的最后一行。通过这种方式，我从表 1 和表 2 中获取 PK（自动增量）并将其插入到链接表中。

问题是这不是原子的，现在我得到了很多交易，它没有正确链接。

如何在 MySQL 4 中保存数据的 2 个表之间建立链接？我不能使用任何存储过程。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-06T21:25:26.180

好吧，如果您能够使用 InnoDB 表（而不是 MyISAM），那么您可以使用事务。这是一些粗略的代码

```
<?php

//  Start a transaction
mysql_query( 'begin' );

//  Execute the queries
if ( mysql_query( "insert into table_one (col1, col2) values('hello','world')" ) )
{
    $pk1 = mysql_insert_id();
    if ( mysql_query( "insert into table_two (col1, col2) values('foo', 'bar')" ) )
    {
        $pk2 = mysql_insert_id();
        $success = mysql_query( "insert into link_table (fk1, fk2) values($pk1, $pk2)" );
    }
}

//  Complete the transaction
if ( $success )
{
    mysql_query( 'commit' );
} else {
    mysql_query( 'rollback' );
} 
```

如果您不能使用 InnoDB 表，那么我建议您研究[Unit Of Work](http://martinfowler.com/eaaCatalog/unitOfWork.html)模式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T21:46:36.403

你的问题在这里：

> 将每个表的最后一行返回给我的 SELECT。

如果你做了这样的事情： SELECT MAX(id) FROM`table`你可能会为你的交易得到一个错误的 id。

这是一种常见的多对多关系

正如 BaileyP 所说，您应该使用函数 mysql_insert_id()。

在[http://ar2.php.net/mysql_insert_id](http://ar2.php.net/mysql_insert_id)

你可以阅读

> 检索前一个 INSERT 查询为 AUTO_INCREMENT 列生成的 ID。

所以不要关心其他进程是否在同一个表中插入一行。您将始终获得当前连接的最后一个 ID。

# database - 我的关系代数正确吗？

> ID：418186
> 
> 赞同：2
> 
> 时间：2009-01-06T21:13:05.660
> 
> 标签：database, relational, relational-algebra

我有一个数据库任务，我必须为两个问题创建一些关系代数。我对它的大部分感觉都很好，但是当我试图从一个连接到另一个表的表中投影属性时我只是感到困惑。

例如，这是正确的吗？

Q1) 列出未拨打电话的事件的详细信息，以便接待员知道哪些事件仍需要呼叫。

```
RESULT <-- PROJECT<STUDENT.FirstName, STUDENT.LastName, STAFF.FirstName,
STAFF.INCIDENT.LastName, INCIDENT.DateTimeReported, 
INCIDENT.NatureOfIllness(SELECTINCIDENT.DecisionMade = 
  ''(Staff RIGHT JOIN<STAFF.StaffID = INCIDENT.StaffID>
(INCIDENT LEFT JOIN<INCIDENT.StudentID = STUDENT.StudentID>(STUDENT)))) 
```

我试图解释为关系代数的 SQL 是：

```
SELECT 
  s.FirstName, s.LastName, st.FirstName, st.LastName
  , i.DateTimeReported, i.NatureOfIllness
FROM Student s 
RIGHT JOIN Incident i ON s.StudentID = i.StudentID  
LEFT JOIN Staff st ON st.StaffID = i.StaffID
WHERE i.DecisionMade = '' 
```

任何意见将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-06T22:13:08.893

如果您使用 LEFT JOIN 编写所有的sql，*通常*（当然有一些例外）更容易阅读和理解 sql：

```
SELECT s.FirstName, s.LastName, st.FirstName, st.LastName, i.DateTimeReported, i.NatureOfIllness
FROM Incident i
LEFT JOIN Student s ON s.StudentID = i.StudentID
LEFT JOIN Staff st ON st.StaffID = i.StaffID
WHERE i.DecisionMade = '' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T21:54:41.363

您的版本似乎正确，除了一些错别字，如 STAFF.INCIDENT.LastName。这是我的版本：

```
RESULT <--- 
   PROJECT <STUDENT.FirstName, STUDENT.LastName, 
                     STAFF.FirstName, STAFF.LastName,
                     INCIDENT.DateTimeReported, INCIDENT.NatureOfIllness>
      (SELECT <INCIDENT.DecisionMade = ''> 
         ((STUDENT RIGHT JOIN <STUDENT.StudentID = INCIDENT.StudentID> INCIDENT)
             LEFT JOIN <INCIDENT.StaffID = STAFF.StaffID> STAFF) 
```

# c# - 如何使用 LINQ 返回 FileInfo.Name 的子字符串

> ID：418187
> 
> 赞同：4
> 
> 时间：2009-01-06T21:13:39.917
> 
> 标签：c#, .net, linq

我想将下面的“foreach”语句转换为 LINQ 查询，该查询将文件名的子字符串返回到列表中：

```
IList<string> fileNameSubstringValues = new List<string>();

//Find all assemblies with mapping files.
ICollection<FileInfo> files = codeToGetFileListGoesHere;

//Parse the file name to get the assembly name.
foreach (FileInfo file in files)
{
    string fileName = file.Name.Substring(0, file.Name.Length - (file.Name.Length - file.Name.IndexOf(".config.xml")));
    fileNameSubstringValues.Add(fileName);
} 
```

最终结果将类似于以下内容：

```
IList<string> fileNameSubstringValues = files.LINQ-QUERY-HERE; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-06T21:19:58.983

尝试这样的事情：

```
var fileList = files.Select(file =>
                            file.Name.Substring(0, file.Name.Length -
                            (file.Name.Length - file.Name.IndexOf(".config.xml"))))
                     .ToList(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-06T21:17:32.623

```
IList<string> fileNameSubstringValues =
  (
    from 
      file in codeToGetFileListGoesHere
    select 
      file.Name.
        Substring(0, file.Name.Length - 
          (file.Name.Length - file.Name.IndexOf(".config.xml"))).ToList(); 
```

享受 =)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-06T23:34:01.007

如果您碰巧知道`FileInfo`s 集合的类型，并且它是 a `List<FileInfo>`，我可能会跳过 Linq 并写：

```
 files.ConvertAll(
            file => file.Name.Substring(0, file.Name.Length - (file.Name.Length - file.Name.IndexOf(".config.xml")))
            ); 
```

或者如果它是一个数组：

```
 Array.ConvertAll(
            files,
            file => file.Name.Substring(0, file.Name.Length - (file.Name.Length - file.Name.IndexOf(".config.xml")))
            ); 
```

主要是因为我喜欢说“转换”而不是“选择”来向阅读此代码的程序员表达我的意图。

但是，Linq 现在是 C# 的一部分，所以我认为坚持让阅读程序员了解其`Select`功能是完全合理的。Linq 方法让您在未来轻松迁移到 Plinq。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-07T00:06:42.390

供参考，

```
file.Name.Substring(0, file.Name.Length - (file.Name.Length - file.Name.IndexOf(".config.xml"))) 
```

是相同的

```
file.Name.Substring(0, file.Name.IndexOf(".config.xml")); 
```

此外，如果该字符串“.config.xml”出现在文件名的末尾之前，您的代码可能会返回错误的内容；您可能应该将 IndexOf 更改为 LastIndexOf 并检查返回的索引位置 + 11（字符串的大小）== 文件名的长度（假设您正在寻找以 .config.xml 结尾的文件而不仅仅是带有 .config 的文件.xml 出现在名称中的某处）。

# java - 注释继承的属性以实现持久性

> ID：418197
> 
> 赞同：5
> 
> 时间：2009-01-06T21:14:57.310
> 
> 标签：java, hibernate, jpa, annotations, spring

假设我有一个 A 类如下：

```
class A{
   int id;
   int getId(){};
   void setId(int id){};
} 
```

B类如下：

```
@Entity
@Table(name="B")
class B extends A{
   string name;

   @Column(length=20)
   string getName(){}
   void setName(){}
} 
```

如何注释从 A 继承的 id 字段，以便 Hibernate/JPA 知道它是实体的 Id？我尝试简单地将@Id 放在 A 中的字段上，但这不起作用。我也尝试将 A 设为实体，但这也不起作用。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-06T21:19:59.967

假设您不希望超类本身代表一个实体，您可以`@MappedSuperclass`在超类上使用让子类继承属性以实现持久性：

```
@MappedSuperclass
class A{
   int id;
   @Id
   int getId(){};
   void setId(int id){};
} 
```

考虑使超类抽象。有关更多详细信息，请参阅文档的[此部分](http://www.hibernate.org/hib_docs/annotations/reference/en/html_single/#d0e939)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T21:21:21.820

您可以使用多种策略。您可以尝试以下方法：

```
@Entity
@Inheritance(strategy=InheritanceType.TABLE_PER_CLASS)
class A{
   int id;

   @Id @GeneratedValue
   int getId(){};
   void setId(int id){};
}

@Entity
@Table(name="B")
class B extends A{
   string name;

   @Column(length=20)
   string getName(){}
   void setName(){}
} 
```

# serial-port - 使用 POSIX 访问半双工串口

> ID：418203
> 
> 赞同：1
> 
> 时间：2009-01-06T21:16:42.423
> 
> 标签：serial-port, posix

我被要求使用 POSIX 调用读取和写入半双工串行连接（更具体地说，在 Linux 2.6.x 上用 C 语言编写）。我在查找有关该特定模型的详细信息时遇到了一些麻烦（大多数页面都集中在全双工上），并且由于阅读时出现轻微异常，我想检查一下我是否在这里做错了。

使用半双工串行连接，我只能读或写。这不是问题，因为线路上没有未经请求的传入数据 - 唯一一次将任何包裹发送给我（供阅读）是我事先要求它们时。

所以我的代码所做的就是在需要发送某些东西时将其写入（）到端口。如果这些数据导致响应（我事先知道的），我只需读取（）。我没有调用特殊函数 - 但也许我应该调用？这种方法正确吗？即当线路空闲时写？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-07T00:41:33.100

我会阅读 Linux 内核源文档，可能有关于串行驱动程序的文本文件；如果没有，您可以通读实际的驱动程序代码以了解它的作用（我保证，它并不像听起来那么可怕！）

# python - 如何检查路径在python中是否有粘性位？

> ID：418204
> 
> 赞同：2
> 
> 时间：2009-01-06T21:16:59.113
> 
> 标签：python

如果路径设置了粘性位，如何使用 python 检查？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-06T21:26:05.447

```
import os
def is_sticky(path):
    return os.stat(path).st_mode & 01000 == 01000 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-06T21:25:43.933

[os.stat()](http://docs.python.org/library/os.html#os.stat)将返回有关文件的信息元组。第一项将是模式。然后，您将能够使用一些位算术来获得粘性位。粘性位的八进制值为 1000。

# wcf - 我应该为 Silverlight 2 数据使用什么类型的服务？

> ID：418207
> 
> 赞同：0
> 
> 时间：2009-01-06T21:18:07.350
> 
> 标签：wcf, silverlight, rest, asmx, silverlight-2.0

有 ASMX、WCF、REST 和 ADO.NET 数据服务……我已经成功地将 WCF 和 ASMX 与 Silverlight 2 一起使用，但是其他的呢？在 Silverlight 2 中使用每种类型的服务的优缺点是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-06T21:19:49.263

WCF 可能是你想要的，因为它是一个包含 http、soap、tcp、json 等的框架。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T21:28:51.727

您有多种选择 -

1.  RESTful 网络服务（如果您需要的不仅仅是 CRUD）+ ADO.net 数据服务（数据）
2.  久经考验的 ASMX
3.  构建使用 SOAP/HTTP/TCP/JSON/您的自定义绑定的多合一 WCF 服务

3号是我个人的选择。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-06T22:10:05.373

根据您的意图，您还必须考虑以下几点：

1.  ADO.NET 数据服务以及许多其他非 Microsoft 平台都支持 RESTful Web 服务。

2.  WCF Web 服务必须包含一个策略 xml 文件并支持更增强但 Microsoft 特定的 WS-* 实现（如果您需要我的意见，WS “死亡之星”）

3.  ASMX Web 服务很简单，但缺乏围绕 WCF 构建的安全模型（基于 RESTful 或基于 SOAP）。

如果您想进行快速原型设计，我建议您使用 ASMX 服务，因为它们涉及的工作量最少。如果您正在做涉及大量数据库交互的事情，请考虑使用 ADO.NET 数据服务和 RESTful 方法。如果您想增加很多复杂性，但要从更强大的安全性和配置中受益，请使用 WCF。

# dependencies - 在依赖图中容易发现哪些问题？

> ID：418210
> 
> 赞同：1
> 
> 时间：2009-01-06T21:19:01.137
> 
> 标签：dependencies, static-analysis

当我生成依赖图时，我应该寻找什么？

或者换一种说法，好看的图和坏的图有什么特点？

编辑：这里的上下文是我第一次看我在 NDepend 中的程序集。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T08:50:14.283

你能发现的最大问题肯定是依赖循环。NDepend 工具提出了一个交互式[依赖矩阵](http://www.ndepend.com/Doc_Matrix.aspx)和一个[依赖图](http://www.ndepend.com/Doc_VS_Arch.aspx)，这将有助于发现[依赖循环](http://www.ndepend.com/Doc_VS_Arch.aspx#Cycle)。*免责声明：我是该工具的开发人员之一*

![在此处输入图像描述](https://i.stack.imgur.com/GJXhP.png)

请注意，依赖矩阵比图更适合点循环。因为一个循环避免了矩阵是三角形的。

其他问题范围与您的应用程序结构有关：例如，UI 直接使用 DB 是否正常？或者更糟糕的是，数据库依赖于 UI？

您可以[在 LINQ 查询 (CQLinq) 上编写代码规则](http://www.ndepend.com/Features.aspx#CQL)来检查禁止的依赖项。以下代码规则检查 UI 类型不应直接使用 DB 类型：

```
// <Name>UI layer shouldn't use directly DB types</Name>
warnif count > 0

// UI layer is made of types in namespaces using a UI framework
let uiTypes = Application.Namespaces.UsingAny(Assemblies.WithNameIn("PresentationFramework", "System.Windows", "System.Windows.Forms", "System.Web")).ChildTypes()

// You can easily customize this line to define what are DB types.
let dbTypes = ThirdParty.Assemblies.WithNameIn("System.Data", "EntityFramework", "NHibernate").ChildTypes()
              // Ideally even DataSet and associated, usage should be forbidden from UI layer: 
              // http://stackoverflow.com/questions/1708690/is-list-better-than-dataset-for-ui-layer-in-asp-net
              .Except(ThirdParty.Types.WithNameIn("DataSet", "DataTable", "DataRow"))

from uiType in uiTypes.UsingAny(dbTypes)
let dbTypesUsed = dbTypes.Intersect(uiType.TypesUsed)
select new { uiType, dbTypesUsed } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T21:25:51.687

什么的依赖图？上课？存储过程？

循环不好...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-06T21:28:23.523

如果更改一个依赖项意味着您需要更改很多其他依赖项，那就不好了。
但是，是的，一些背景可能会有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-06T21:51:25.707

我不知道 NDepend 显示了什么，但倾向于进入代码的许多部分（特别是不相关的部分）的工件往往是坏的（恕我直言）。我认为这是“癌症代码”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-06T22:27:23.777

NFJS 会议上的一位演讲者向我们展示了一些依赖关系图......他指出的一种气味是寻找与代码库的不同功能部分有关系的东西。这些可能会破坏封装。

此外，我会查看每个部分的一般复杂性。那些满是线条的都是嫌疑人。

# css - 如何修复我网站上的 CSS 以使大图像不会溢出其容器？

> ID：418218
> 
> 赞同：4
> 
> 时间：2009-01-06T21:21:43.660
> 
> 标签：css

我有一个非常酷的网站，允许人们上传图片。有时图像非常大，如下面的 div 所示：

`![Overflow][1]`

有没有一种样式可以添加到我的 DIV 中来解决这个问题？

[关联](http://img242.imageshack.us/img242/6711/overflowds1.png)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-06T21:24:15.683

将div 上的[CSS 溢出属性设置为以下之一：](http://www.w3.org/TR/CSS21/visufx.html#overflow)

```
overflow: auto;    /* Adds scrollbars only when necessary */
overflow: scroll;  /* Adds inactive scrollbars until needed, then activates */
overflow: visible; /* Causes the div to expand to fit the content */
overflow: hidden;  /* Hides any content that overflows */ 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-06T21:26:20.280

您可以使用 CSS[`overflow`](http://www.w3.org/TR/CSS21/visufx.html#overflow)属性：将其设置为隐藏内容`hidden`或`auto`在必要时添加滚动条。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-06T21:24:58.693

一般来说，对于大图像，您希望对它们进行缩略图而不是自动显示它们，特别是当它们超过一定尺寸时。

使用 height 和 width CSS 属性（或 height 和 width 属性）将缩放图像，但它仍会下载整个内容。如果它很大，那可能是个问题。最好在上传时生成缩略图，显示它，然后允许用户单击它以显示全尺寸图像。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-07T16:44:26.620

```
<style>img { max-width: 100% }</style> 
```

这将使浏览器调整图像大小以适合其包含框。有一些缺点，一个是它显然不能在 IE6（可能是 7？）中工作，如果包含元素有填充，则需要在图像周围进行包装以使其适合。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-06T21:27:45.643

另一个虽然没有得到完全支持的好方法是添加`max-width: 400px`到您的图像中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-06T21:29:37.093

您应该在服务器端进行基本的宽度和高度检查，而不是使用 CSS，如果超过某个阈值，请使用 HTML/Javascript 调整图像大小。许多网站论坛应用程序都这样做，并且通常允许您单击以展开图像。

然后确保使用 Z-LAYER 属性来确保图像漂浮在内容块之上，这样当图像展开时，它就在所有内容之上。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-06T21:34:36.287

[使用ImageMagick](http://www.imagemagick.org/)之类的工具包自动调整每个上传图像的大小。你也会得到更好看的图像，因为它会重新采样（而不是仅仅调整大小）。

然后，您可以为每个图像创建好看的缩略图、预览和其他尺寸，以很好地融入您的模板设计。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-06T21:43:39.043

如果您不想一直调整实际图像文件的大小，并且想要保持图像的比例，那么您可以询问图像的大小（高度和宽度），然后将它们乘以所需的因子适合你的 div。

例如，如果您有一个 1024x768 的图像，并希望将其放入 800 宽的 div 中，您知道宽度将为 800，高度将为 768 x (800/1024) = 600。然后在显示图像时您可以根据需要设置高度和宽度属性。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-07T01:07:33.643

或者，使用一小段 javascript，您可以检查图像宽度。如果大于 Xpx，则缩放到 Ypx。当然，在页面完全加载之前，您将有一点“图像滑动”。

您可以从任何 IPB 论坛中激发自己的灵感 :)

# axapta - 冻结一个或多个网格列

> ID：418223
> 
> 赞同：0
> 
> 时间：2009-01-06T21:22:46.280
> 
> 标签：axapta, x++

是否可以冻结 Dynamics Ax 中的网格列，以便当用户向右滚动时，第一列或第二列继续显示并且不会滚动到视图之外？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-11-18T20:00:04.817

不幸的是，这在 Dynamics AX 中是不可能的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-05-18T13:22:01.570

由于 Excel 很容易解决这个问题，并且在 Dynamics AX 中导出到 excel（csv 或 html）是快速和容易的，我建议您询问您的客户是否可以使用 Excel 解决它。

是的。打开Excel后涉及一些手动工作。不是一个完美的解决方案。;-)

# .net - 在 .NET 中实现 IInternetZoneManager

> ID：418230
> 
> 赞同：0
> 
> 时间：2009-01-06T21:23:47.587
> 
> 标签：.net, webbrowser-control, ole

我正在尝试使用 Webbrowser Control 在 .NET 中实现[IInternetZoneManager](http://msdn.microsoft.com/en-us/library/ms537079(VS.85).aspx)，但我不知道该怎么做。

我找不到有关此实现的任何托管代码示例。我对 OLE 的东西很不满意。

任何人都可以提供一个样本吗？我花了大约 2 天没有运气。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-06T21:54:41.520

这是我转换它时得到的：

```
public class Constants
{
    public const int MAX_PATH = 260;
    public const int MAX_ZONE_PATH = 260;
    public const int MAX_ZONE_DESCRIPTION = 200;
}

[StructLayout(LayoutKind.Sequential, CharSet=CharSet.Unicode)]
public struct ZONEATTRIBUTES
{
    public uint cbSize;
    [MarshalAs(UnmanagedType.ByValTStr, SizeConst = Constants.MAX_PATH)]
    public string szDizplayName;
    [MarshalAs(UnmanagedType.ByValTStr, SizeConst = Constants.MAX_ZONE_DESCRIPTION)]
    public string szDescription;
    [MarshalAs(UnmanagedType.ByValTStr, SizeConst = Constants.MAX_PATH)]
    public string szIconPath;
    public uint dwTemplateMinLevel;
    public uint dwTemplateRecommended;
    public uint dwTemplateCurrentLevel;
    public uint dwFlags;
}

public enum URLZONEREG
{
    URLZONEREG_DEFAULT = 0,
    URLZONEREG_HKLM,
    URLZONEREG_HKCU
}

[Guid("79eac9ef-baf9-11ce-8c82-00aa004ba90b")]
[ComImport]
public interface IInternetZoneManager
{
    void CopyTemplatePoliciesToZone(uint dwTemplate, uint dwZone, uint dwReserved);
    void CreateZoneEnumerator(ref uint pdwEnum, ref uint pdwCount, uint dwFlags);
    void DestroyZoneEnumerator(uint dwEnum);
    void GetZoneActionPolicy(uint dwZone, uint dwAction, IntPtr pPolicy, uint cbPolicy, 
        URLZONEREG urlZoneReg);
    void GetZoneAt(uint dwEnum, uint dwIndex, ref uint pdwZone);
    void GetZoneAttributes(uint dwZone, ref ZONEATTRIBUTES pZoneAttributes);
    void GetZoneCustomPolicy(uint dwZone, [In] ref Guid guidKey, ref IntPtr ppPolicy,
        ref uint pcbPolicy, URLZONEREG urlZoneReg);
    void LogAction(uint dwAction, [MarshalAs(UnmanagedType.LPWStr)] string pwszUrl, 
        [MarshalAs(UnmanagedType.LPWStr)] string pwszText, uint dwLogFlags);
    void PromptAction(uint dwAction, IntPtr hwndParent, [MarshalAs(UnmanagedType.LPWStr)] string pwszUrl,
        [MarshalAs(UnmanagedType.LPWStr)] string pwszText, uint dwPromptFlags);
    void SetZoneActionPolicy(uint dwZone, uint dwAction, IntPtr pPolicy, uint cbPolicy,
        URLZONEREG urlZoneReg);
    void SetZoneAttributes(uint dwZone, ref ZONEATTRIBUTES pZoneAttributes);
    void SetZoneCustomPolicy(uint dwZone, [In] ref Guid guidKey, IntPtr pPolicy,
        uint pcbPolicy, URLZONEREG urlZoneReg);
} 
```

我还在[pinvoke.net](http://www.pinvoke.net)上发布了定义：

[http://www.pinvoke.net/default.aspx/Interfaces.IInternetZoneManager](http://www.pinvoke.net/default.aspx/Interfaces.IInternetZoneManager)

通常，您应该首先在此处查找互操作定义（如果不存在则贡献）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T21:32:03.140

我不知道这是否有帮助，但他似乎正在使用 C++ 应用程序中的界面：

[监控 IE 设置的变化](http://www.codeguru.com/cpp/i-n/ieprogram/displayinginformation/article.php/c8559)

# java - 数据采集 硬件的java驱动程序？

> ID：418261
> 
> 赞同：2
> 
> 时间：2009-01-06T21:33:22.653
> 
> 标签：java, device-driver, data-acquisition

我需要做一些数据采集并想使用 Java 来编写我的数据采集应用程序。现在我正在使用一个 LabJack，它的驱动程序有一个 Java 包装器，它对于简单的东西工作正常，但我需要升级到真正的东西。

有人知道有 Java 设备驱动程序可用的数据采集平台（NI 或 Measurement Computing 或其他之一）吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-16T17:58:56.720

我以前用过[Phidg​​et](http://www.phidgets.com/)硬件，但它真的是爱好水平。虽然工作了一个款待。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-02-06T22:03:03.710

我目前正在为 Java 下的 National Instruments 硬件开发，明显的缺点是 NI 不支持 Java。

我还利用了一个名为 JAW [http://www.aplu.ch/jaw/的现有框架](http://www.aplu.ch/jaw/)

通过一些阅读，控制卡片是轻而易举的事。注意：它仅适用于 Windows。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-19T11:09:18.583

You might also want to check out this [wikibook](http://en.wikibooks.org/wiki/Serial_Programming:Serial_Java). I knew about Javaconn, but didn't know it had been withdrawn. I believe most of this hardware comes with serial interfaces.

# .net - 无需重启即可部署紧凑框架

> ID：418262
> 
> 赞同：0
> 
> 时间：2009-01-06T21:33:28.597
> 
> 标签：.net, compact-framework

当您使用 Visual Studio 部署到 Windows 移动设备时，它会自动选择正确的 cab 文件并将紧凑框架安装到该设备上。所有这些都不需要重新启动。

如果您选择相同的 cab 文件并在安装完成后使用主动同步进行安装，则需要重新启动设备。

为什么？你怎么能像 Visual Studio 那样进行静默安装。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-06T21:40:54.713

实际上，您不需要重新启动它。这只是 CAB 中的一个错误。 [您可以放心地忽略它](http://social.msdn.microsoft.com/forums/en-US/vssmartdevicesvbcs/thread/d27c3c96-915b-4af2-be43-57747c6b93c8/)（尽管它很烦人）。

编辑：您可以通过将[/noui 或 /silent 开关](http://msdn.microsoft.com/en-us/library/bb158700.aspx)（取决于您的目标）传递给 wceload 来抑制消息。

# c# - 如何判断 CLR 初始化了哪些值类型

> ID：418265
> 
> 赞同：1
> 
> 时间：2009-01-06T21:34:01.653
> 
> 标签：c#

这特别适用于 C# 和 .NET 框架。

最好不要在 .NET 框架中初始化以下类型，因为 CLR 会为您初始化它们：

int、bool 等

将对象设置为 null 也是如此（我相信）。

例如，您不需要这样做，实际上它会影响性能（是否会下降）：

```
int Myvar = 0; 
```

只需要`int Myvar;`，就是这样。CLR 会将其初始化为 int。

我显然只是从编程中“知道” int 默认设置为 0 并且 bool 设置为 false。

并且还将对象设置为 null，因为 CLR 会为您执行此操作。但是你怎么知道这些原始类型被设置成什么。我尝试打开 Reflector 来查看 int32 和 bool 但无法弄清楚它们是如何默认初始化的。

我在msdn上看了，也没有看到。也许我只是想念它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-06T21:51:14.333

如果你想要一个表，MSDN 是你的朋友：[默认值表（C# 参考）](http://msdn.microsoft.com/en-us/library/83fhsxwc.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-06T21:54:00.600

你想要一份这样的清单[吗](http://msdn.microsoft.com/en-us/library/83fhsxwc(VS.80).aspx)？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-06T21:43:05.863

您可以轻松地制作一个程序，为所有感兴趣的 T 打印 default(T)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-06T21:37:05.923

一切基本上都归零了，所以从那里拿走它。Int/Double/etc 0\. 字符串，或其他结构，可能是 String.Empty、Guid.Empty 等 bool、false（其他语言为 0。）

它非常直观。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-06T21:41:41.593

对于 C#，这里是所有值类型的列表 - 单击每个值类型的链接以了解其默认值：

[值类型表（C# 参考）](http://msdn.microsoft.com/en-us/library/bfft1t3c.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-06T21:42:28.203

这可能是一个很长的镜头，但我会说

```
default( T ) 
```

会给你非常准确的结果。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-06T21:58:55.690

尝试调试应用程序并检查更改之前的初始值。那里可能有更好的答案，但为了关闭这个线程，我只是发布一个快速而肮脏的解决方案。

```
 static void Main(string[] args)
        {
            int iTest;
            string sTest;
            double dTest;
            bool bTest;
            float fTest;

            // stop debugger here
            Console.WriteLine();

            iTest = 0;
            sTest = "";
            dTest = 0.0;
            bTest = false;
            fTest = 0;
        } 

```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-06T22:06:19.170

[http://www.codeproject.com/KB/dotnet/DontInitializeVariables.aspx](http://www.codeproject.com/KB/dotnet/DontInitializeVariables.aspx)

开始了。很简单：值类型初始化为0，引用类型初始化为null

# c - 按位循环遍历大数据块的最快方法是什么

> ID：418266
> 
> 赞同：2
> 
> 时间：2009-01-06T21:34:12.230
> 
> 标签：c, performance, optimization, bitmask

我正在逐字节运行二进制数据的内存块。

目前我正在做这样的事情：

```
for (i = 0; i < data->Count; i++)
{   
    byte = &data->Data[i];
    ((*byte & Masks[0]) == Masks[0]) ? Stats.FreqOf1++; // syntax incorrect but you get the point.
    ((*byte & Masks[1]) == Masks[1]) ? Stats.FreqOf1++;
    ((*byte & Masks[2]) == Masks[2]) ? Stats.FreqOf1++;
    ((*byte & Masks[3]) == Masks[3]) ? Stats.FreqOf1++;
    ((*byte & Masks[4]) == Masks[4]) ? Stats.FreqOf1++;
    ((*byte & Masks[5]) == Masks[5]) ? Stats.FreqOf1++;
    ((*byte & Masks[6]) == Masks[6]) ? Stats.FreqOf1++;
    ((*byte & Masks[7]) == Masks[7]) ? Stats.FreqOf1++;
} 
```

面具在哪里：

```
for (i = 0; i < 8; i++)
{
    Masks[i] = 1 << i;
} 
```

（不知何故，我没有设法在循环或内联函数中做到这一点，所以我把它写出来了。）

有人对如何改进第一个循环有任何建议吗？我对深入浅出相当缺乏经验。

这似乎是一件愚蠢的事情。但我正在实施压缩算法。我只想让位访问部分正确。

谢谢！

PS：这是在 Visual Studio 2008 编译器上。因此，如果建议适用于该编译器，那就太好了。

PPS：我刚刚意识到，我不需要增加两个计数。一个就足够了。然后计算最后的总位数的差异。但这将特定于仅计数。我真正想要快速完成的是位提取。

编辑：提出的查找表想法很好。我意识到我在标题中提出了错误的问题。因为最后我想做的不是计算位，而是尽可能快地访问每个位。

另一个编辑：是否可以在数据中仅将指针推进一位？

另一个编辑：感谢您迄今为止的所有回答。

我想在接下来的步骤中实现的是一个不分析上下文的简单二进制算术编码器。所以我现在只对单个位感兴趣。最终它将成为一个上下文自适应的 BAC，但我将把它留到以后。

处理 4 个字节而不是 1 个字节可能是一种选择。但是超过 32 位的循环也很昂贵，不是吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-06T21:38:34.763

最快的方法可能是建立一个字节值与该字节中设置的位数的查找表。至少这是我在谷歌面试时的答案。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-06T21:42:13.713

使用将每个字节值 (256) 映射到其中 1 的数量的表。（0 的 # 只是（8 - 1 的 #））。然后遍历字节并对每个字节执行一次查找，而不是多次查找和比较。例如：

```
int onesCount = 0;
for (i = 0; i < data->Count; i++)
{   
    byte = &data->Data[i];
    onesCount += NumOnes[byte];
}
Stats.FreqOf1 += onesCount;
Stats.FreqOf0 += (data->Count * 8) - onesCount; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-06T21:41:03.917

您可以使用预先计算的查找表，即：

```
static int bitcount_lookup[256] = { ..... } ; /* or make it a global and compute the values in code */

...

for( ... ) 
   byte = ... 
   Stats.FreqOf1 += bitcount_lookup[byte]; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-06T23:00:08.733

我真的不明白你想做什么。但是，如果您只想访问位图的位，您可以使用这些（未经测试的！！！）函数：

```
#include <stddef.h>

_Bool isbitset(unsigned char * bitmap, size_t idx)
{
    return bitmap[idx / 8] & (1 << (idx % 8)) ? 1 : 0;
}

void setbit(unsigned char * bitmap, size_t idx)
{
    bitmap[idx / 8] |= (1 << (idx % 8));
}

void unsetbit(unsigned char * bitmap, size_t idx)
{
    bitmap[idx / 8] &= ~(1 << (idx % 8));
}

void togglebit(unsigned char * bitmap, size_t idx)
{
    bitmap[idx / 8] ^= (1 << (idx % 8));
} 
```

**编辑：**好的，我*想*我明白你想要做什么：对一系列位进行快速迭代。因此，我们不想使用上面的随机访问函数，而是一次读取一个完整的数据字。

您可以使用任何您喜欢的无符号整数类型，但您应该选择一种可能与您的体系结构的字长相对应的类型。我会`uint_fast32_t`从`stdint.h`：

```
uint_fast32_t * data = __data_source__;
for(; __condition__; ++data)
{
    uint_fast32_t mask = 1;
    uint_fast32_t current = *data;
    for(; mask; mask <<= 1)
    {
        if(current & mask)
        {
            // bit is set
        }
        else
        {
            // bit is not set
        }
    }
} 
```

在内部循环中，您可以使用

```
*data |= mask; 
```

用

```
*data &= ~mask; 
```

并用

```
*data ^= mask; 
```

**警告：**代码在大端架构上可能会出现意外行为！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-06T21:49:58.720

这是一种如何计算 32 位整数的 1 位的方法（基于 Java 的`Integer.bitCount(i)`方法）：

```
unsigned bitCount(unsigned i) {
    i = i - ((i >> 1) & 0x55555555);
    i = (i & 0x33333333) + ((i >> 2) & 0x33333333);
    i = (i + (i >> 4)) & 0x0f0f0f0f;
    i = i + (i >> 8);
    i = i + (i >> 16);
    return i & 0x3f;
} 
```

因此，您可以将数据转换为 int 并以 4 个字节的步长向前移动。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-06T22:04:14.447

这是一个简单的，我只使用一个 32 位值，但你可以看到它并不难适应任何数量的位......

```
int ones = 0;
int x = 0xdeadbeef;
for(int y = 0;y < 32;y++)
{
    if((x & 0x1) == 0x1) ones++;
    x = (x >> 1);
}

printf("%x contains %d ones and %d zeros.\n", x, ones, 32-ones); 
```

但是请注意，它会修改过程中的值。如果您要对需要保留的数据执行此操作，则需要先对其进行复制。

在 __asm 中执行此操作可能会更好，也许更快，但很难说编译器可以优化多少......

对于您考虑的每个解决方案，每个解决方案都会有缺点。查找表或移位器（如我的）都有缺点。

拉里

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-06T22:27:11.063

ttobiass - 请记住，您的内联函数在您所说的应用程序中很重要，但是您需要记住一些事情。您可以从内*联*代码中获得性能，只需记住几件事。

*   调试模式下的内联不存在。（除非你强迫它）
*   编译器将内联它认为合适的函数。通常，如果您告诉它内联一个函数，它可能根本不会这样做。即使你使用 __forceinline。有关内联的更多信息，请查看 MSDN。
*   甚至只能内联某些函数。例如，您不能内联递归函数。

您将从 C/C++ 语言的项目设置以及构建代码的方式中获得最佳性能。此时，了解堆与堆栈操作、调用约定、内存对齐等很重要。

我知道这并不能完全回答您的问题，但是您提到了性能，以及如何获得最佳性能，这些都是关键。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-06T21:43:17.907

加入链接车： [计数位](http://compprog.wordpress.com/2007/11/06/binary-numbers-counting-bits/)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-06T21:47:09.117

如果这不是过早优化的情况，并且您确实需要挤出最后的每一飞秒，那么您最好使用一个 256 元素的静态数组，用每个字节值的位数填充一次，然后

> Stats.FreqOf1 += bitCountTable[字节]

当循环完成时：

> Stats.FreqOf0 = ((data->Count * 8) - Stats.FreqOf1)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-06T21:54:41.893

[Beautiful Code](http://oreilly.com/catalog/9780596510046/)一书中有一整章介绍了不同的技术。[您可以从这里开始](http://books.google.com/books?id=gJrmszNHQV4C&pg=RA2-PA117&lpg=RA2-PA117)在 Google 图书上阅读（大部分）它。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-27T21:32:46.520

一种更快的提取位的方法是使用：

```
bitmask= data->Data[i];

while (bitmask)
{
    bit_set_as_power_of_two= bitmask & -bitmask;
    bitmask&= bitmask - 1;
} 
```

如果您只想计算设置的位，那么每个缓存中的 LUT 会很快，但您也可以使用[此答案链接中](https://stackoverflow.com/questions/418266/what-is-the-fastest-ways-to-loop-through-a-large-data-chunk-on-a-per-bit-basis/418276#418276)的交错位计数方法在恒定时间内完成。

# version-control - 预防/控制图像内容的实践

> ID：418270
> 
> 赞同：3
> 
> 时间：2009-01-06T21:35:58.263
> 
> 标签：version-control

死代码很容易通过代码审查来识别和消除，但是，当涉及到图像时——未使用的图像仍然会进入我们的版本控制。是否有任何干净的方式来组织图形内容，以便网页和图像文件之间存在直接关联？

在我们当前的项目中，我们使用创建主 PNG 文件，然后导出所需的图层以用于开发目的。最近我发现图像文件夹中有一些膨胀。在代码中搜索图像名称会有所帮助，但是当需要搜索数百张奇怪的图像时会非常痛苦。所以去论坛求建议

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-06T22:19:59.020

您可以使用爬虫（如 wget）浏览网站并删除任何未触及的图像（即未在您的日志中列出的图像。）

一种更快的方法是转储代码中找到的所有图像文件名。

```
grep -o -e \w*?\.png    (caution: untested regex) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T21:46:42.440

如果您有 1 步构建并且可以测试死链接，那么您应该能够编写一个脚本来彻底检查项目、删除单个图像并构建和测试项目。如果没有错误弹出图像是不需要的。

运行需要很长时间（可能需要几天，具体取决于项目规模），但这是计算机时间，而不是工时。

# java - Java内存问题的诊断策略

> ID：418272
> 
> 赞同：4
> 
> 时间：2009-01-06T21:36:02.290
> 
> 标签：java, memory, garbage-collection, jconsole

我的任务是调试一个 Java (J2SE) 应用程序，该应用程序经过一段时间的活动开始抛出 OutOfMemory 异常。我是 Java 新手，但有编程经验。我很想听听您对诊断此类问题的好方法的看法？

到目前为止，我已经使用 JConsole 来了解正在发生的事情。我有一种预感，有些对象没有被正确释放，因此在垃圾收集期间没有被清理。

有没有我可以用来了解对象生态系统的工具？你会从哪里开始？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-06T21:49:00.190

我将从一个适当的 Java 分析器开始。JConsole 是免费的，但它的功能远不及花钱的那些。我使用了 JProfiler，物有所值。有关更多选项和意见，请参阅[https://stackoverflow.com/questions/14762/please-recommend-a-java-profiler](https://stackoverflow.com/questions/14762/please-recommend-a-java-profiler)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-06T21:55:01.127

尝试使用[Eclipse Memory Analyzer](http://www.eclipse.org/mat/)或任何其他可以处理 Java 堆转储的工具，然后使用在内存不足时生成堆转储的襟翼运行您的应用程序。

然后分析堆转储并查找可疑的高对象计数。

[有关堆转储](http://blogs.oracle.com/alanb/entry/heap_dumps_are_back_with)的更多信息，请参阅本文。

编辑：另外，请注意，您的应用程序可能只是合法地需要比您最初想象的更多的内存。您可以尝试首先将 java 最小和最大内存分配增加到更大的值，然后查看您的应用程序是否无限期地运行或只是稍微进一步。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-07T00:56:17.610

最新版本的 Sun JDK 包括 VisualVM，它本身就是 Netbeans 分析器。它真的很好用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-06T22:34:28.490

[http://www.yourkit.com/download/index.jsp](http://www.yourkit.com/download/index.jsp)是您需要的唯一工具。您可以在 (1) 应用程序启动时间和 (2) 在运行应用程序 N 时间后拍摄快照，然后比较快照以查看内存分配的位置。它还将在 OutOfMemoryError 上拍摄快照，以便您可以将此快照与 (1) 进行比较。

例如，我必须解决的最新项目抛出 OutOfMemoryError 异常，在启动 YourKit 后，我​​意识到大多数内存实际上被分配给了一些 ehcache “LFU” 类，关键是我们指定了某个 POJO 的负载缓存在内存中，但我们没有指定足够的 -Xms 和 -Xmx（启动和最大 JVM 内存分配）。

我也使用过 Linux 的**vmstat**，例如一些 Linux 平台没有启用足够的交换，或者没有分配连续的内存块，然后是**jstat**（与 JDK 捆绑在一起）。

**更新**见[https://stackoverflow.com/questions/14762/please-recommend-a-java-profiler](https://stackoverflow.com/questions/14762/please-recommend-a-java-profiler)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-01-07T00:40:45.740

您还可以将“UnhandledExceptionHandler”添加到应用程序的线程中。这将捕获“未捕获”异常，例如内存不足错误，并且您至少会知道异常是在哪里引发的。通常这不是问题，而是无法满足的“新”。作为一项规则，我总是将 UnhandledExceptionHandler 添加到线程中，如果没有其他需要添加日志记录的话。

# shell - 如何反转文本文件的行？

> ID：418280
> 
> 赞同：29
> 
> 时间：2009-01-06T21:38:25.123
> 
> 标签：shell, command-line, filter, reverse

我正在编写一个需要反转文本文件行的小型 shell 脚本。是否有标准的过滤器命令来做这种事情？

我的具体应用是我得到一个 Git 提交标识符列表，我想以相反的顺序处理它们：

```
git log --pretty=oneline work...master | grep -v DEBUG: | cut -d' ' -f1 | reverse 
```

我想出的最好的方法是这样实现`reverse`：

```
... | cat -b | sort -rn | cut -f2- 
```

这用于`cat`对每一行进行编号，然后`sort`按数字降序对它们进行排序（最终反转整个文件），然后`cut`删除不需要的行号。

以上适用于我的应用程序，但在一般情况下可能会失败，因为`cat -b`只有数字非空行。

有没有更好、更通用的方法来做到这一点？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2009-01-06T21:43:22.680

在[GNU coreutils](http://www.gnu.org/software/coreutils/)中，有[tac(1)](http://www.gnu.org/software/coreutils/manual/coreutils.html#tac-invocation)

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2011-11-14T17:13:39.850

有一个**标准**命令可用于您的目的：

```
tail -r file.txt 
```

以相反的顺序打印 file.txt 的行！

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2009-01-06T21:40:39.410

答案不是 42 而是**`tac`**。

**编辑：**使用更慢但更消耗内存`sed`

```
sed 'x;1!H;$!d;x' 
```

甚至更长

```
perl -e'print reverse<>' 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-20T17:32:11.710

> cat -b 仅编号非空行"

如果这是您要避免的唯一问题，那么为什么不使用“cat -n”对所有行进行编号呢？

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-05-06T02:40:26.357

与上面的**sed**示例类似，使用**perl** - 可能更容易记住（取决于你的大脑是如何连接的）：

```
perl -e 'print reverse <>' 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-06T23:26:52.863

```
:   "@(#)$Id: reverse.sh,v 1.2 1997/06/02 21:45:00 johnl Exp $"
#
#   Reverse the order of the lines in each file

awk ' { printf("%d:%s\n", NR, $0);}' $* |
sort -t: +0nr -1 |
sed 's/^[0-9][0-9]*://' 
```

对我来说就像一个魅力......

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-05-26T20:53:24.373

在这种情况下，只需使用`--reverse`：

```
$ git log --reverse --pretty=oneline work...master | grep -v DEBUG: | cut -d' ' -f1 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-05-26T20:36:38.483

```
rev <name of your text file.txt> 
```

你甚至可以这样做：

```
echo <whatever you want to type>|rev 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-04-18T15:05:59.400

```
awk '{a[i++]=$0}END{for(;i-->0;)print a[i]}' 
```

比 openwrt 等嵌入式设备更快`sed`且兼容。

# c# - 使用 ASP.NET MVC 模型绑定器进行单元测试

> ID：418284
> 
> 赞同：2
> 
> 时间：2009-01-06T21:40:21.923
> 
> 标签：c#, asp.net-mvc, unit-testing

我想知道利用模型绑定对控制器操作进行单元测试的最佳实践。

```
[AcceptVerbs(HttpVerbs.Get)]
public ActionResult AddProduct(Product product)
{
} 
```

我想知道您如何调用控制器的方法进行单元测试。如果你尝试这样的事情......

```
public void Catalog_AddProduct()
{
    CatalogController controller = new CatalogController();
    // some mocking for controller context, setting form values etc...
    controller.AddProduct(// ?);
} 
```

有些人可能会建议删除 Product 作为参数，但我还有另一个 AddProduct 控制器操作，仅用于 HTTP-Gets。我能想到的唯一解决方案可能是接受名称值集合（表单数据）并仅使用 UpdateModel/TryUpdateModel。

我还想测试模型绑定本身是否正常工作，所以我想将创建新产品的责任交给模型绑定。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-06T22:10:58.583

我不确定我是否理解这个问题，为什么你不能这样做：

```
[TestMethod()]
public void AddProductTest()
{
    CatalogController target = new CatalogController(/*testing variables*/);
    target.AddProduct(new Product { /* product details for testing */ });

    // Test the results
} 
```

虽然我想也许我不理解这个问题。使用表单发布变量是一种很好的方法，但是，当您需要对产品进行编辑时，这将非常有效，并且一段时间后您可能会发现让您的所有操作都采用表单发布变量并更新您的模型要容易得多。TryUpdateModel 和 UpdateModel 值得指出的一点是，我们遇到了实体框架的错误，如果您尝试更新复杂的实体框架模型，它有时会引发异常。但是就像我们所做的那样，编写自己的模型更新程序真的很容易。

编辑：

我不确定您是否能够或是否需要测试模型绑定本身。模型绑定是 MVC 框架的一部分，并且超出了控制器测试的范围，我不关心它并假设它会在您的测试上下文中工作。

如果您确实需要测试模型绑定，我知道的唯一方法是传入表单 post 变量，然后使用 TryUpdateModel 方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-10T08:20:47.050

现在您刚刚向控制器提供了一个 ValueProvider。

# hyperlink - Google Search Appliance 能否生成一份报告，显示您网站上的损坏链接？

> ID：418288
> 
> 赞同：2
> 
> 时间：2009-01-06T21:40:58.427
> 
> 标签：hyperlink, google-analytics

我知道 Google Search Appliance 可以访问这些信息（因为这会影响 PageRank 算法），但是有没有办法从爬虫设备中导出这些信息？

外部工具将不起作用，因为很大一部分内容是针对公司 Intranet 的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-06T21:43:17.220

可能是谷歌上可用的东西，但我从未检查过。我通常使用[W3C 提供的链接检查器](http://validator.w3.org/checklink)。W3C 还可以检测重定向，如果您的服务器通过重定向而不是返回 404 状态代码来处理 404，这很有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T21:48:22.983

您可以使用[Google 网站管理员工具](https://www.google.com/webmasters/tools/)查看您网站上的损坏链接等。

不过，这不会向您显示到外部网站的断开链接。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T12:55:54.943

似乎这是不可能的。在 Status and Reports > Crawl Diagnostics 下，有 2 种可用的报告样式：目录向下钻取“树视图”和一次 100 个 URL 的“列表视图”。有些人尝试创建程序以通过列表视图进行分页，但这似乎在几千个 URL 之后失败了。

我的建议是改用您的服务器日志。确保在您的 Web 服务器上启用 404 和引用 URL 日志记录，因为您可能希望更正包含损坏链接的页面。

然后，您可以使用[日志文件分析器](http://en.wikipedia.org/wiki/Web_log_analysis_software)生成损坏的链接报告。

要创建一种有效的、长期的方法来监控损坏的链接，您可能需要设置一个 cron 作业来执行以下操作：

*   用于`grep`从服务器日志文件中提取包含 404 条目的行。
*   用于`sed`从每一行中删除除请求的 URL 和引用 URL 之外的所有内容。
*   使用`sort`和`uniq`命令从列表中删除重复项。
*   每次将结果输出到一个新文件，以便您可以监控随时间的变化。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-07T17:35:05.053

一个名为 Xenu 的免费工具被证明是这项任务的首选武器。 [http://home.snafu.de/tilman/xenulink.html#Download](http://home.snafu.de/tilman/xenulink.html#Download)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-06T22:02:42.687

为什么不只分析您的网络服务器日志并查找所有 404 页面？这更有意义，也更可靠。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-09-29T04:43:47.817

我知道这是一个老问题，但您可以使用 GSA 管理控制台上的导出 URL 功能，然后查找状态为 not_found 的 URL。这将向您显示 GSA 已发现但在尝试抓取它们时返回 404 的所有 URL。

# uml - UML 类图中的“#”符号是什么意思？

> ID：418308
> 
> 赞同：82
> 
> 时间：2009-01-06T21:46:18.133
> 
> 标签：uml

我正在阅读 Algorithms in a Nutshell (O'Reilly)，并在类图中遇到了这个符号。我的猜测是这意味着该成员受到保护，但我想看看是否有人确切知道这意味着什么。

* * *

## 回答 #1

> 赞同：172
> 
> 时间：2009-01-06T21:50:21.840

它表示类或其他数据类型的受保护*成员*。

`-`表示私有

`+`表示公开

`#`表示受保护

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-06T21:49:35.803

'#' 表示可见性。在这种情况下，它指的是受保护的操作[删除了术语“方法”，因为这不是通用的]。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2017-05-24T09:51:56.813

还添加到：

~ 表示包私有（或默认）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-07-26T17:20:20.620

这意味着它是受保护的，对于一个变量，它只会在类和继承的类中看到。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-08-25T08:21:06.207

'#' 代表类中属性/方法的可见性“受保护”（类似于 public、private）行为。您可以在[uml_basic_notations找到更多相同的内容](http://www.tutorialspoint.com/uml/uml_basic_notations.htm)

# vba - VBA 状态栏

> ID：418316
> 
> 赞同：3
> 
> 时间：2009-01-06T21:48:10.610
> 
> 标签：vba, ms-word, ms-office, status, statusbar

我正在为 80 位左右的用户开发 Word VBA 宏应用程序。该办公室的员工流动率很高，因此培训受到影响，因此该项目的自我要求之一是全面、友好的文档。然而，为了补充这一点，并且为了让新手在尝试新事物时不得不打开一个 100 页的文档，我希望每个用户窗体（有五个）上都有一个状态栏，以提供上下文帮助。我发现工具提示很烦人。

我没有太多经验，所以我想

本质上，我有一个包含每个状态字符串的文件。（这目前是一个文本文件，但我想知道我是否应该使用电子表格或 csv 以便将来其他工作人员进行编辑。）每个控件都有一个 MouseMove 事件，它引用一个函数：getStatus(cID) 打开文件，抓取该行并将其显示在状态标签中。它还从文件的同一行中获取一些参数，例如标签是否可点击（链接到帮助文件中的页面），以及标签应该是什么颜色。

所以真的有几个问题：

如果用户窗体不断引用文件，应用程序会变慢吗？这对我来说感觉很好，但我已经参与其中太久了，而且我是唯一访问该文件的用户。将有 80 个不断访问它。

MouseMove 在控件上是最好的方法吗？我应该改用坐标吗？

最重要的是（就我必须做尽可能少的工作而言）是否有某种方法可以做到这一点，这样我就不必在每个控件上都有一个 MouseMove 事件？我有几百个左右的控件，每个控件都有自己的标识符（嗯，还没有，但如果这是唯一的方法，他们会这样做）。也许当表单加载时，我可以加载所有可能的状态行，这样它们就可以在鼠标悬停时准备好。但是，也许加载时间可以忽略不计？

欣赏任何想法或想法 - 特别是如果 VBA 已经有一系列功能可以做到这一点，而我只是想重新发明轮子。我不能使用应用程序状态栏，因为用户很少看到应用程序本身。

谢谢！

编辑：

它适用于数据输入、点击和一些文档生成。

这是一个受控的环境，所以宏观安全问题对我来说不是一个大问题——如果出现问题，那是别人的错或问题 :)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-06T22:09:44.827

这是数据输入应用程序还是他们只是点击内容？因为通常具有焦点的字段与鼠标悬停的项目不同，这可能会引起很多混乱。

不断地从文件中读取是对时间和资源的巨大浪费——最好在加载表单时只将它们加载到数组或集合中一次。

在 MouseMouse 事件上比坐标更好，因为您可以在不担心的情况下移动东西。这是很多代码，但如果您有一个控件名称列表，您应该能够生成大部分代码，因为代码应该是相同的。

IE

```
Sub Control_MouseMove()
  DisplayStatus(Control)
End sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T22:19:57.130

对于这种帮助，我会考虑控件的 StatusText 属性和 ControlTipText 属性。

**StatusText** 此示例为名为“Age”的表单域设置状态栏帮助文本。

```
With ActiveDocument.FormFields("Age")
    .OwnStatus = True
    .StatusText = "Type your current age."
End With 
```

**ControlTipText** 这可以从控件的属性表中指定。

```
Private Sub UserForm_Initialize()
    MultiPage1.Page1.ControlTipText = "Here in page 1"
    MultiPage1.Page2.ControlTipText = "Now in page 2"

    CommandButton1.ControlTipText = "And now here's"
    CommandButton2.ControlTipText = "a tip from"
    CommandButton3.ControlTipText = "your controls!"
End Sub 
```

# sql - 使用 SQL 生成日期范围

> ID：418318
> 
> 赞同：46
> 
> 时间：2009-01-06T21:48:29.130
> 
> 标签：sql, oracle

我有一个带有日期参数的 SQL 查询（如果我要将它放入函数中），我需要在去年的每一天运行它。

如何生成最近 365 天的列表，以便我可以使用直接 SQL 来执行此操作？

显然，生成一个列表 0..364 也可以，因为我总是可以：

```
SELECT SYSDATE - val FROM (...); 
```

* * *

## 回答 #1

> 赞同：116
> 
> 时间：2009-01-07T20:25:41.697

无需使用超大表或 ALL_OBJECTS 表：

```
SELECT TRUNC (SYSDATE - ROWNUM) dt
  FROM DUAL CONNECT BY ROWNUM < 366 
```

会成功的。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2011-08-11T03:39:47.047

```
 SELECT (sysdate-365 + (LEVEL -1)) AS DATES
 FROM DUAL connect by level <=( sysdate-(sysdate-365)) 
```

如果替换 'from' 和 'to' 日期来代替 sysdate 和 sysdate-365，则输出将是 from 和 to date 之间的日期范围。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2015-05-05T09:22:12.230

最近我遇到了类似的问题，并通过这个简单的查询解决了它：

```
SELECT
  (to_date(:p_to_date,'DD-MM-YYYY') - level + 1) AS day
FROM
  dual
CONNECT BY LEVEL <= (to_date(:p_to_date,'DD-MM-YYYY') - to_date(:p_from_date,'DD-MM-YYYY') + 1); 
```

例子

```
SELECT
  (to_date('01-05-2015','DD-MM-YYYY') - level + 1) AS day
FROM
  dual
CONNECT BY LEVEL <= (to_date('01-05-2015','DD-MM-YYYY') - to_date('01-04-2015','DD-MM-YYYY') + 1); 
```

结果

```
01-05-2015 00:00:00
30-04-2015 00:00:00
29-04-2015 00:00:00
28-04-2015 00:00:00
27-04-2015 00:00:00
26-04-2015 00:00:00
25-04-2015 00:00:00
24-04-2015 00:00:00
23-04-2015 00:00:00
22-04-2015 00:00:00
21-04-2015 00:00:00
20-04-2015 00:00:00
19-04-2015 00:00:00
18-04-2015 00:00:00
17-04-2015 00:00:00
16-04-2015 00:00:00
15-04-2015 00:00:00
14-04-2015 00:00:00
13-04-2015 00:00:00
12-04-2015 00:00:00
11-04-2015 00:00:00
10-04-2015 00:00:00
09-04-2015 00:00:00
08-04-2015 00:00:00
07-04-2015 00:00:00
06-04-2015 00:00:00
05-04-2015 00:00:00
04-04-2015 00:00:00
03-04-2015 00:00:00
02-04-2015 00:00:00
01-04-2015 00:00:00 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-07T18:20:06.350

Oracle 中经常使用的一种方法是这样的：

```
select trunc(sysdate)-rn
from
(   select rownum rn
    from   dual
    connect by level <= 365)
/ 
```

就个人而言，如果应用程序需要日期列表，那么我只需使用它们创建一个表，或者创建一个包含一系列整数的表，直到可用于此类事情的可笑的一百万之类的整数。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-06T23:29:51.373

特定于 Oracle，并且不依赖于预先存在的大型表或数据字典对象上的复杂系统视图。

```
SELECT c1 from dual
  MODEL DIMENSION BY (1 as rn)  MEASURES (sysdate as c1)
  RULES ITERATE (365) 
  (c1[ITERATION_NUMBER]=SYSDATE-ITERATION_NUMBER)
order by 1 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2010-08-26T17:40:12.573

大约晚了一年半，但对于后代来说，这里是 Teradata 的一个版本：

```
SELECT calendar_date 
FROM SYS_CALENDAR.Calendar
WHERE SYS_CALENDAR.Calendar.calendar_date between '2010-01-01' (date) and '2010-01-03' (date) 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2017-05-04T14:00:06.567

日期范围在 1996 年 12 月 31 日到 2020 年 12 月 31 日之间

```
SELECT dt, to_char(dt, 'MM/DD/YYYY') as date_name, 
  EXTRACT(year from dt) as year, 
  EXTRACT(year from fiscal_dt) as fiscal_year,
  initcap(to_char(dt, 'MON')) as month,
  to_char(dt, 'YYYY')        || ' ' || initcap(to_char(dt, 'MON')) as year_month,
  to_char(fiscal_dt, 'YYYY') || ' ' || initcap(to_char(dt, 'MON')) as fiscal_year_month,
  EXTRACT(year from dt)*100        + EXTRACT(month from dt) as year_month_id,
  EXTRACT(year from fiscal_dt)*100 + EXTRACT(month from fiscal_dt) as fiscal_year_month_id,
  to_char(dt, 'YYYY')        || ' Q' || to_char(dt, 'Q') as quarter,
  to_char(fiscal_dt, 'YYYY') || ' Q' || to_char(fiscal_dt, 'Q') as fiscal_quarter
  --, EXTRACT(day from dt) as day_of_month, to_char(dt, 'YYYY-WW') as week_of_year, to_char(dt, 'D') as day_of_week
  FROM (
    SELECT dt, add_months(dt, 6) as fiscal_dt --starts July 1st
    FROM (
      SELECT TO_DATE('12/31/1996', 'mm/dd/yyyy') + ROWNUM as dt 
      FROM DUAL CONNECT BY ROWNUM < 366 * 30 --30 years
    )
    WHERE dt <= TO_DATE('12/31/2020', 'mm/dd/yyyy')
  ) 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-06T21:57:14.837

哈哈哈，这是我刚刚想到的一个有趣的方法：

```
select SYSDATE - ROWNUM
from shipment_weights sw
where ROWNUM < 365; 
```

其中shipping_weights 是任何大表；

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2014-04-17T17:16:28.680

我有同样的要求——我只是用这个。用户输入他/她想要将日历范围限制到的天数。

```
 SELECT DAY, offset
    FROM (SELECT to_char(SYSDATE, 'DD-MON-YYYY') AS DAY, 0 AS offset
            FROM DUAL
          UNION ALL
          SELECT to_char(SYSDATE - rownum, 'DD-MON-YYYY'), rownum
            FROM all_objects d)
            where offset <= &No_of_days 
```

我将上述结果集用作驱动视图，`LEFT OUTER JOIN`并与其他涉及具有日期的表的视图一起使用。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2016-02-23T16:59:20.513

6 个月前的一周

```
SELECT (date'2015-08-03' + (LEVEL-1)) AS DATES
 FROM DUAL 
 where ROWNUM < 8
 connect by level <= (sysdate-date'2015-08-03'); 
```

如果省略 ROWNUM，则仅获得 50 行，与值无关。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2018-07-10T22:58:45.107

迟到总比不到好。这是我设计的一种方法（在阅读这篇文章后）用于返回日期列表，其中包括：（a）当月的第 1 天到今天，加上（b）过去两个月的所有日期：

```
select (sysdate +1 - rownum) dt 
from dual 
 connect by rownum <= (sysdate - add_months(sysdate - extract(day from sysdate),-2)); 
```

“-2”是要包括的先前完整月份的日期数。例如，在 7 月 10 日，此 SQL 将返回从 5 月 1 日到 7 月 10 日的所有日期的列表 - 即两个完整的前一个月加上当前的部分月份。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-01-06T22:27:26.337

为了好玩，下面是一些应该在 SQL Server、Oracle 或 MySQL 中工作的代码：

```
SELECT current_timestamp - CAST(d1.digit + d2.digit + d3.digit as int)
FROM 
(
    SELECT digit
    FROM
    (
        select '1' as digit
        union select '2'
        union select '3'
        union select '4'
        union select '5'
        union select '6'
        union select '7'
        union select '8'
        union select '9'
        union select '0'
    ) digits
) d1
CROSS JOIN
(
    SELECT digit
    FROM
    (
        select '1' as digit
        union select '2'
        union select '3'
        union select '4'
        union select '5'
        union select '6'
        union select '7'
        union select '8'
        union select '9'
        union select '0'
    ) digits
) d2
CROSS JOIN
(
    SELECT digit
    FROM
    (
        select '1' as digit
        union select '2'
        union select '3'
        union select '4'
        union select '5'
        union select '6'
        union select '7'
        union select '8'
        union select '9'
        union select '0'
    ) digits
) d3
WHERE CAST(d1.digit + d2.digit + d3.digit as int) < 365
ORDER BY d1.digit, d2.digit, d3.digit -- order not really needed here 
```

如果你能给我一个跨平台的语法来重用数字表，那就加分。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2020-10-26T17:47:30.510

从今天开始获得 365 天的另一种简单方法是：

```
SELECT (TRUNC(sysdate) + (LEVEL-366)) AS DATE_ID
FROM DUAL connect by level <=( (sysdate)-(sysdate-366)); 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2021-06-14T08:55:08.330

我经常为我工作的调度应用程序这样做，我创建了一个流水线表函数。有时我需要几天、几小时或 15 分钟的间隔。这与我使用的函数不完全相同，因为我的代码在一个包中。但是，在这里，我在 2020 年 1 月 1 日和 2020 年 1 月 10 日之间有几天：

```
SELECT
    days.date_time
FROM
    table(between_times(TO_DATE('2020-01-01'),TO_DATE('2020-01-10'),(60*24), 'Y')) days 
```

流水线功能：

```
function between_times(i_start_time TIMESTAMP, i_end_time TIMESTAMP, i_interval_in_minutes NUMBER, include_end_time VARCHAR2 := 'N')
  RETURN DateTableType  PIPELINED
  AS
    time_counter TIMESTAMP := i_start_time;
  BEGIN
    IF i_start_time IS NULL OR i_end_time IS NULL or i_start_time > i_end_time OR i_interval_in_minutes IS NULL OR
      i_interval_in_minutes <= 0 THEN
        RETURN;
      END IF;
      LOOP

        -- by default does not include end time
        if (include_end_time = 'Y') THEN
          exit when time_counter > i_end_time;
        ELSE
          exit when time_counter >= i_end_time;
        END IF;

        pipe row(DateType( time_counter ));     
        time_counter := time_counter + i_interval_in_minutes/(60*24);

      END LOOP;

      EXCEPTION  WHEN NO_DATA_NEEDED THEN NULL;      
  END; 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2022-02-25T00:48:25.703

```
WITH Date_Table (Dates, Heading) AS  -- Using Oracle SQL
(SELECT  TRUNC(SYSDATE) Dates, '  Start' as Heading FROM dual
UNION ALL
SELECT TRUNC(DATES-1) ,  '  Inside recursion' as Heading FROM Date_Table
WHERE Dates > sysdate-365 )  -- Go back one year
SELECT TO_CHAR(Dates,'MM/DD/YYYY') 
FROM Date_Table
ORDER BY Dates DESC; 
```

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2009-01-06T23:13:55.370

我没有重复使用数字表的答案，但这里有一个代码示例，它至少可以在 SQL Server 中工作并且速度更快一些。

```
print("code sample");

select  top 366 current_timestamp - row_number() over( order by l.A * r.A) as DateValue
from (
select  1 as A union
select  2 union
select  3 union
select  4 union
select  5 union
select  6 union
select  7 union
select  8 union
select  9 union
select  10 union
select  11 union
select  12 union
select  13 union
select  14 union
select  15 union
select  16 union
select  17 union
select  18 union
select  19 union
select  20 union
select  21 
) l
cross join (
select 1 as A union
select 2 union
select 3 union
select 4 union
select 5 union
select 6 union
select 7 union
select 8 union
select 9 union
select 10 union
select 11 union
select 12 union
select 13 union
select 14 union
select 15 union
select 16 union
select 17 union
select 18
) r
print("code sample"); 
```

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2010-12-03T12:13:56.780

此查询生成一个日期列表，其中包含未来 4000 天和过去 5000 天的日期（灵感来自[http://blogs.x2line.com/al/articles/207.aspx](http://blogs.x2line.com/al/articles/207.aspx)）：

```
SELECT * FROM (SELECT
    (CONVERT(SMALLDATETIME, CONVERT(CHAR,GETDATE() ,103)) + 4000 -
                n4.num * 1000 -
                n3.num * 100 -
                n2.num * 10 -
                n1.num) AS Date, 
    year(CONVERT(SMALLDATETIME, CONVERT(CHAR,GETDATE() ,103)) + 4000 -
                n4.num * 1000 -
                n3.num * 100 -
                n2.num * 10 -
                n1.num) as Year,
    month(CONVERT(SMALLDATETIME, CONVERT(CHAR,GETDATE() ,103)) + 4000 -
                n4.num * 1000 -
                n3.num * 100 -
                n2.num * 10 -
                n1.num) as Month,
    day(CONVERT(SMALLDATETIME, CONVERT(CHAR,GETDATE() ,103)) + 4000 -
                n4.num * 1000 -
                n3.num * 100 -
                n2.num * 10 -
                n1.num) as Day
           FROM (SELECT 0 AS num union ALL
                 SELECT 1 UNION ALL
                 SELECT 2 UNION ALL
                 SELECT 3 UNION ALL
                 SELECT 4 UNION ALL
                 SELECT 5 UNION ALL
                 SELECT 6 UNION ALL
                 SELECT 7 UNION ALL
                 SELECT 8 UNION ALL
                 SELECT 9) n1
               ,(SELECT 0 AS num UNION ALL
                 SELECT 1 UNION ALL
                 SELECT 2 UNION ALL
                 SELECT 3 UNION ALL
                 SELECT 4 UNION ALL
                 SELECT 5 UNION ALL
                 SELECT 6 UNION ALL
                 SELECT 7 UNION ALL
                 SELECT 8 UNION ALL
                 SELECT 9) n2
               ,(SELECT 0 AS num union ALL
                 SELECT 1 UNION ALL
                 SELECT 2 UNION ALL
                 SELECT 3 UNION ALL
                 SELECT 4 UNION ALL
                 SELECT 5 UNION ALL
                 SELECT 6 UNION ALL
                 SELECT 7 UNION ALL
                 SELECT 8 UNION ALL
                 SELECT 9) n3  
               ,(SELECT 0 AS num UNION ALL
                 SELECT 1 UNION ALL
                 SELECT 2 UNION ALL
                 SELECT 3 UNION ALL
                 SELECT 4 UNION ALL
                 SELECT 5 UNION ALL
                 SELECT 6 UNION ALL
                 SELECT 7 UNION ALL
                 SELECT 8) n4
        ) GenCalendar  ORDER BY 1 
```

# c# - 匿名类型和反射在一起有多“安全”？

> ID：418320
> 
> 赞同：4
> 
> 时间：2009-01-06T21:48:37.490
> 
> 标签：c#, reflection, anonymous-types

我想这也可能被问到创建的类型名称附加到匿名类型多长时间。这是问题：

一个博客有这样的东西：

```
var anonymousMagic = new {test.UserName};

lblShowText.Text = lblShowText
                     .Text
                     .Format("{UserName}", test); 
```

作为一种愿望清单和几种方法。由于无聊和冒险，我开始创建一个可以处理此问题的字符串扩展方法：

```
var anonymousMagic = new {test.UserName, test.UserID};

lblShowText.Text = "{UserName} is user number {UserID}"
                     .FormatAdvanced(anonymousMagic); 
```

我的想法是从匿名类型中获取属性信息并将其与括号中的字符串匹配。现在有了属性信息来反射，所以我想在类型第一次出现时保存属性信息，这样我就不必再次获取它了。所以我做了这样的事情：

```
 public static String FormatAdvanced(this String stringToFormat, Object source)
    {

        Dictionary<String, PropertyInfo> info;
        Type test; 
        String typeName;
        //
        currentType = source.GetType();
        typeName = currentType.Name;
        //
        //info list is a static list for the class holding this method
        if (infoList == null)
        {
            infoList = new Dictionary<String, Dictionary<String, PropertyInfo>>();
        }
        //
        if (infoList.ContainsKey(typeName))
        {
            info = infoList[typeName];
        }
        else
        {
            info = test.GetProperties()
                       .ToDictionary(item => item.Name);
            infoList.Add(typeName, info);
        }  
        //
        foreach (var propertyInfoPair in info)
        {
            String currentKey;
            String replacement;

            replacement = propertyInfoPair.Value.GetValue(source, null).ToString();
            currentKey = propertyInfoPair.Key;

            if (stringToFormat.Contains("{" + currentKey + "}"))
            {
                stringToFormat = stringToFormat
                                 .Replace("{" + currentKey + "}", replacement);
            }
        }  
        //
        return stringToFormat;
    } 
```

现在在测试中，它似乎保留了它为匿名类型创建的名称，以便第二次通过它不会从类型中获取属性信息，而是从字典中获取。

如果多个人同时使用此方法，它在 Session 之类的 Session 中几乎可以工作吗？IE 的类型名称会特定于程序的每个实例吗？还是会比这更糟？该名称在什么时候被丢弃和覆盖？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-06T21:57:15.350

它永远不会。该类型是在编译时生成的，您可以认为它在应用程序域的整个生命周期中都是不变的和唯一的。

我质疑这个功能的价值。显而易见的第一个原因是因为您没有 String 类的 Format 方法的大部分功能（括号没有转义，括号中的值没有格式等）。

第二个是它基本上将格式字符串链接到传入的类型，因此它们不容易被换出。如果我有两个具有相同概念值但命名它的属性不同的类，我必须更改我的格式字符串以使用您的方法显示它，以补偿属性名称嵌入在格式字符串中的事实。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-06T22:12:42.857

匿名类型是在编译时生成的，因此只要您不重新编译程序集，反射名称就应该是静态的。

[这里](http://community.bartdesmet.net/blogs/bart/archive/2006/12/03/C_2300_-3.0-Feature-Focus-_2D00_-Part-1-_2D00_-Local-Type-Inference.aspx)有一篇详细的帖子描述了这些名称，但我相信你所做的是安全的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T00:32:30.780

我有两件事要说，但这并不是一个真正的答案。

首先， Dictionary 不必有字符串键；关键可能是实际类型。即它可能是一个`Dictionary<Type, Dictionary<String, PropertyInfo>>`. 这会更快，因为您不必获取类型名称，并且更不容易出错 - 如果我向该方法发送两个具有相同名称但名称空间不同的非匿名类型怎么办？

其次，您应该阅读 Phil Haack 最近关于此主题的[博文。](http://haacked.com/archive/2009/01/04/fun-with-named-formats-string-parsing-and-edge-cases.aspx)它包含这种方法的完整实现。

# php - 为什么CakePHP授权组件在同时打开两个站点时会自动注销？

> ID：418329
> 
> 赞同：2
> 
> 时间：2009-01-06T21:50:48.390
> 
> 标签：php, apache, cakephp, authorization

我的 CakePHP 应用程序中有一个问题：我将授权组件用于登录/注销机制。不幸的是，当用户尝试同时打开两个或多个 php 页面时，他们会自动注销。这种情况经常发生，因为我们倾向于使用鼠标中键在短时间内打开许多选项卡。

有人有想法吗？可能是 CakePHP 还是有允许用户同时发出多个请求的 php 设置？

乔治

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-06T22:40:12.300

因为 session_regenerate_id()。对于您打开的每个页面，您都会获得一个新的 session_id。这可以防止会话劫持（这是不常见但可能的）。将 config.php 中的安全级别降低到中等以防止这种情况发生。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T00:22:08.273

您可能在 config.php 中也有两个具有相同种子外观的站点，并查看您是否具有唯一值

```
Configure::write('Session.cookie', 'I_like_to_make_this_unique');
Configure::write('Security.salt', 'this_should_be_unique'); 
```

可能有帮助

# task-management - 推荐PC的轻量级任务管理应用程序

> ID：418331
> 
> 赞同：0
> 
> 时间：2009-01-06T21:51:11.103
> 
> 标签：task-management

谁能推荐一个好的PC任务管理应用程序？我曾经使用 Palm Desktop 并喜欢它，但现在我在工作中使用 Black Berry 和 Outlook，但我发现 Outlook 的任务功能使用起来相当痛苦。回到 Palm Desktop 是可行的，但我真的只需要能够很好地完成任务管理并且不太重量级的东西。

在我家里的 Mac 上，我一直在看[OmniFocus](http://www.omnigroup.com/applications/omnifocus/ "全聚焦")，它看起来相当不错，但它是一个仅限 Mac 的应用程序，我真的需要一些东西用于我在工作中使用的 PC。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-06T21:54:41.567

Google 日历支持任务（新功能，非常简单），或者您可以使用[RememberTheMilk](http://blog.rememberthemilk.com/2007/12/rtm-gmail-task-management-goodness.html)站点/gmail 插件。它具有您可能想要的所有基本功能，并且使用简单。如果您使用 iPhone 或 gPhone，您可以从桌面和口袋中以一流的体验访问该网站。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-12-08T15:33:29.600

这是一个非常简单直观的基于树的任务列表。 [http://www.codeproject.com/KB/applications/todolist2.aspx](http://www.codeproject.com/KB/applications/todolist2.aspx)免费提供源代码和许多插件

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-06T22:09:36.090

我非常喜欢 Llamagraphics 的 Life Balance。我以前在我的手掌上使用它，然后在 Treo 上使用它。

但它也适用于 Mac 和 PC（以及 iPhone）。我不认为有黑莓版本。

它可以用作基本的待办事项列表，但它也有一些很好的概述功能和设置优先级的好方法。与Palm 版本相比，iPhone 版本仍然有些笨拙，但可以使用。所有版本都可以相互同步，并且在 Mac 上它具有与 iCal 的一些同步功能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-12-10T16:52:47.283

我实际上已经开始使用[Evernote](http://www.evernote.com/)和[Moleskin Journal](http://www.moleskine.com/catalogue/diariesplanners/18_months/18_months__weekly_notebook__black_hard_cover__large.php)来跟踪我每天的工作。尽管 Evernote 是一个笔记应用程序，但它足够通用，并且具有似乎足以用于一般任务管理的标签。

# sql - 事实/暗表时间值

> ID：418334
> 
> 赞同：1
> 
> 时间：2009-01-06T21:51:24.007
> 
> 标签：sql, data-warehouse, multidimensional-array

我正在设置 Fact 和 Dim 表，并试图找出设置时间值的最佳方法。AdventureworksDW 为 DimTime 表中的每个时间条目使用一个时间键 (UID)。我想知道有什么理由我不应该只使用时间值，即 0106090800 （我的粒度是每小时）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-06T22:28:25.460

当您想要更改维度中的定义时，“智能键”（在本例中为编码日期和小时数）可能会导致问题。例如，您的用户可能坚持将本地时间更改为 UTC。现在您的键实际上不再是一个有用的数字，而是维度中的旧值。

此外，对于午夜翻转问题，智能密钥的日期部分可能与 UTC 与本地时间更改的实际日期不匹配。

为防止密钥成为问题，您不能将其用于任何类型的任何计算。在这种情况下，它比简单的 GUID 或自动递增数字好一点。

自动增量键（或 GUIDS）既快速又简单。最重要的是，它们在所有维度上都非常一致。

时间恰好有一个数字映射，但它有助于了解这是一个奇怪的巧合，而不是一个好的设计的基础。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T00:54:45.367

这是 Ralph Kimball[最新](http://www.rkimball.com/html/designtipsPDF/KimballDT51LatestThinking.pdf)的时间维度。它的日期是 2004 年，但它仍然很好。

[这个](http://www.ralphkimball.com/html/designtipsPDF/DesignTips2000%20/KimballDT5SurrogateKeys.pdf)也有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-29T05:13:52.097

主键应该是代理，没有意义——但是，使用 YYYYMMDD 作为日期维度键是难以抗拒的，并且还允许简单的表分区。诀窍在于它仍然应该被视为毫无意义——它看起来像一个日期的事实应该被视为纯属巧合。永远不应将此密钥暴露给业务用户。

# c# - 编程监视器定位

> ID：418345
> 
> 赞同：4
> 
> 时间：2009-01-06T21:53:55.810
> 
> 标签：c#, .net-3.5, monitor

当我将笔记本电脑插入扩展坞时，我希望连接外接显示器，而主显示器位于左侧。

为此，我必须进入控制面板，打开显示属性，放置显示器，附加，设置为主，然后点击确定。

有没有办法在代码中做到这一点？？？

我更喜欢 C# .net 3.5，但我什么都愿意！

这个问题已经结束，所以我在[这里重新提问](https://stackoverflow.com/questions/837613/setting-my-display-resolution)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-06T21:59:26.593

以前从未尝试过，但请参见此处：

[连锁](https://stackoverflow.com/questions/195267/use-windows-api-from-c-to-set-primary-monitor)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T22:02:39.350

在显示设置中使用外接显示器上的“设置为主/默认”。也使用扩展我的显示。我的 Gateway Vista 笔记本电脑在家里也有同样的设置。

# perl - 如何修复 Math::BigInt 调用的 Math::Pari 中的“`as_number' 不是 Pari 函数名称”？

> ID：418347
> 
> 赞同：2
> 
> 时间：2009-01-06T21:54:02.940
> 
> 标签：perl, cpan

在 Perl 5.8.5 上，我看到问题中列出的错误。

我正在运行这些版本模块：

*   数学::BigInt: 1.89
*   数学::BigInt::FastCalc: 0.19
*   数学::BigInt::GMP: 1.24
*   数学::BigInt::Pari: 1.13
*   数学：：大老鼠：0.22
*   大数：0.22

产生错误的模块是 Math::Pari。这一切都是为了让 Net::SFTP 工作以将文件放在远程主机上。

感谢您的任何见解，哦 CPAN 大师。:)

* * *

谢谢，没什么，我尝试了这些东西，但是当我删除 Math::Pari 时，Net::SSH::Perl::Util::SSH2MP 抱怨，因为它正在使用它：

```
use Math::Pari qw( PARI floor pari2num Mod lift ); 
```

Math::Pari 版本是 2.010800

我希望我能更好地理解 CPAN 构建过程，这样我就可以知道这是否值得向 Net::SFTP 的维护者报告。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T04:52:21.893

最简单的解决方案可能只是删除 Math::BigInt::Pari。GMP应该能够做你需要的一切。

您还可以在脚本前加上

```
use Math::BigInt only => "GMP"; 
```

或类似的东西（请参阅 Math::BigInt 文档）以确保使用 calc 模块而不是 Math::Pari。

确保此 use 行出现在任何其他可能以不同方式加载 Math::BigInt 的内容之前。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T20:17:05.850

不管它值多少钱：对我来说，问题与目标主机上使用的 SSH 协议有关。它设置为 SSH 版本 2。我暂时将其删除，Net:SSH 现在对我有用。不是解决方案，但至少是一种解决方法。

# c - 调试方法

> ID：418354
> 
> 赞同：1
> 
> 时间：2009-01-06T21:55:17.057
> 
> 标签：c, debugging, visual-c++-6

我是 C 新手，我现在正在使用 MS Visual C++ 6.0。我目前正在研究排序算法，我想自动跟踪每个变量的值。这可以让我深入了解算法如何进行艰苦的工作。也就是说，我不想在纸上写什么产生了什么 :) 是否有任何用于调试目的的运算符或函数，例如 PHP 中的 var_dump()？或者我怎样才能提高我的调试能力？还有其他适合新手的调试工具吗？或者关于使用 Visual C++ 的内置调试器的任何好的教程？谢谢！..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-06T22:01:34.500

在 Visual C++ 中，您可以在使用 F9 键编写的代码行上设置断点。您会在该行的左侧看到一个小红点。然后按 F5 编译并运行。

f10 逐行步进。我认为 F11 进入了一种方法。

如果需要，您还可以对输出窗口进行跟踪输出和调试字符串。

设置断点时，您可以在窗口中查看变量 - 我认为堆栈上的变量将自动位于堆栈/自动变量窗口中。很抱歉，我现在没有 VC6 来提供更多细节或截图。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-06T22:28:57.020

我认为您正在寻找的东西在 Visual Studio 中被称为“手表”。您可以将表达式（例如变量名称）添加为要监视的项目，并且在您逐步执行代码时，它们的值会自动更新。您可能还对“Locals”调试窗口感兴趣，它与 Watches 类似，不同之处在于它填充了当前作用域的本地变量。

这是我通过 Google 找到的关于使用 Locals 和 Watches[的快速教程。](http://www.cs.uvm.edu/~upe/resources/debugging/visualStudioCDebug/#watching)另请查看有关[最佳调试方法](https://stackoverflow.com/questions/260230/best-way-to-debug-a-program)的其他 SO 问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-18T02:40:50.033

使用 (ALT)(F4) 调出变量窗口 这将显示当前语句的变量。

使用 (ALT)(F3) 调出监视窗口。您可以在那里添加变量，因此请在它们处于范围内时对其进行观察。

查看查看调试窗口下的其他选项。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-06T22:04:11.173

`printf`/`fprintf`是最容易使用的调试工具。如果您的程序记录其活动，则更容易分析发生的情况。我更喜欢使用可视化调试器进行日志记录，因为它的交互性较低，并且允许分析程序运行后发生的情况。

PS。最好不要污染标准输出，并将调试输出定向到文件或标准错误。

# windows - boost::random_device 的非 Linux 实现

> ID：418358
> 
> 赞同：1
> 
> 时间：2009-01-06T21:56:47.130
> 
> 标签：windows, boost, portability, non-deterministic, random

目前，Boost 只`random_device`为 Linux（可能是 *nix）系统实现类。有谁知道其他操作系统的现有实现？理想情况下，这些实现将是开源的。

如果不存在，我应该如何为 Windows 和 Mac OS X 实现非确定性 RNG？API 调用是否存在于提供此功能的任一环境中？谢谢（对所有问题感到抱歉）！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-06T22:08:32.130

在 MacOSX 上，您可以使用 /dev/random（因为它是 *​​nix）。

在 Windows 上，您可能需要 CryptGenRandom 函数。我不知道是否有使用它的 boost::random_device 的实现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T22:07:39.387

取决于你想用你的RNG做什么。

一般而言，您会将种子数据输入缓冲区，生成缓冲区的哈希值，将计数器混合到结果中并对其进行更多哈希处理。使用散列函数的原因是良好的散列旨在从更结构化的输入数据中产生看起来随机的结果。

如果你想将它用于密码学，事情会变得更加棘手。您需要跳过更多的障碍，以确保您的 RNG 在合理的安全范围内保持重复模式。我可以推荐 Bruce Schneier 的“Practical Cryptography”（关于 RNG 的介绍和示例实现）。他还收集了一些关于他的[yarrow](http://www.schneier.com/yarrow.html) RNG 的与 RNG 相关的内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-06T22:21:03.523

如果 boost 依赖于 /dev/random，它很可能也可以在 MacOS 上运行（因为它有）。

在 Windows 上，有 CryptoAPI 作为操作系统的一部分，它提供了加密质量的 RNG。

此外，我相信现代英特尔 CPU 在芯片上具有硬件 RNG - 但是您必须弄清楚如何在每个操作系统上实现这一点。使用更高级别的 API 可能是更好的选择。

编辑：这是英特尔 RNG 工作原理的[链接](http://download.intel.com/design/chipsets/rng/CRIwp.pdf)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-03T19:08:17.127

OpenSSL 有一个不错的。

```
#include <openssl/rand.h>
...
time_t now = time(NULL);
RAND_seed(&now, sizeof(now)); // before first number you need

int success = RAND_bytes(...);
if (!success) die_loudly();

RAND_cleanup(); // after you don't need any more numbers 
```

Microsoft CryptoAPI 在 Win32 上有一个。它需要更多的函数调用。此处不包括详细信息，因为每个调用都有 2 到 5 个参数。请注意，CryptoAPI 似乎要求用户正确设置完整的本地配置文件（C:\Documents and Settings\user\Local Settings），然后才能为您提供随机数。

```
CryptAcquireContext // see docs
CryptGenRandom
CryptReleaseContext 
```

# emacs - Boustrophedon 文本编辑？

> ID：418365
> 
> 赞同：3
> 
> 时间：2009-01-06T21:59:22.523
> 
> 标签：emacs, typography

我想在 emacs 中编辑 boustrophedon 中的文本。对于那些不知道 boustrophedon 文本方向的人来说，在田野中“像牛转身”或像打印机喷墨一样。出于同样的原因，这在农场或打印机上很有效，一旦你习惯了它（不会花费太长时间），这个文本就会非常有效地阅读。

有关 boustrophedon 排版/布局的更多信息：http: [//www.ntg.nl/pipermail/aleph/2004-March/000094.html](http://www.ntg.nl/pipermail/aleph/2004-March/000094.html)

据我所知，没有这种排版风格的实现，我对如何实现它感到困惑。

关于如何做到这一点的任何想法？

谢谢， 安德烈亚斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-09T05:17:28.707

我假设建议自插入命令、拦截事件并相应地修改缓冲区是您想要做的。然后，您将需要重新绑定方向命令（forward-char 和朋友在相反的行上反转），依此类推。

很多工作，但绝对有可能。

在你写任何太复杂的东西之前，请在 emacs-devel 上询问。正如评论所暗示的那样，对这样的东西提供通用支持可能会很有用......尽管具有不同方向的任意文本片段不会像您的文本那样自动换行（插入时）。

编辑：显然建议 self-insert-command 对此并不完全有效，因此您需要设置一个键盘映射（并将 ?a 绑定到 (my-new-insert-command ?a) 等等......）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-01-03T18:49:37.897

你可以把它写在`sed`I hacked the `rev`script from the sed1liners text 以跳过一行，然后`rev`每隔一行：

`alias boustrophedon='sed -n "1{p;b a};{/\n/!G;s/\(.\)\(.*\n\)/&\2\1/;//D;s/.//;p};n;p;:a"'`

`$> echo -en "This\nis\nBoustrou...\ntext\non\ndisplay\nhere.\n" | boustrophedon`

```
This
si
Boustrou...
txet
on
yalpsid
here. 
```

或者，如果您想处理整个文件：

`$> boustrophedon <filename>`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-07T14:16:26.670

有用于“转牛”的 linux 软件。查看[http://traevoli.com/boust/](http://traevoli.com/boust/) 享受吧！

# asp.net-mvc - Asp.net mvc：从视图回发

> ID：418366
> 
> 赞同：2
> 
> 时间：2009-01-06T21:59:23.787
> 
> 标签：asp.net-mvc

如果需要，将其回发到从原始控制器进行渲染和重定向的同一控制器是否被认为是更好的做法？或者如果从视图中跳转到不同的控制器，它是一样的吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-07T19:32:19.917

我在控制器中创建了两个重载操作，一个使用 HTTP GET 呈现输入表单，另一个使用 HTTP POST 处理表单发布。像这样的东西：

```
 public ViewResult Foo()
  {
    return View();
  }

  [AcceptVerbs(HttpVerbs.Post)]
  public ViewResult Foo( FormCollection form )
  {
    // process input
    if (inputOK)
      return RedirectToAction("Index");
    return View();
  } 
```

这样做的好处是，如果出现错误，视图会重新呈现任何错误和验证消息。如果成功，则会重定向到另一个操作，这样可以避免在用户刷新页面时在浏览器上重复发布警告 - 请参阅[Wikipedia 上的 Post/Redirect/Get和](http://en.wikipedia.org/wiki/Post/Redirect/Get)[Stephen Walther 的](http://stephenwalther.com/blog/archive/2008/06/20/asp-net-mvc-tip-6-call-redirecttoaction-after-submitting-a-form.aspx)此博客条目。

除了采用 FormCollection 之外，还有其他选择，例如简单参数列表或绑定到对象。请参阅[ScottGu 的这篇文章](http://weblogs.asp.net/scottgu/archive/2008/09/02/asp-net-mvc-preview-5-and-form-posting-scenarios.aspx)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-06T22:05:13.073

我认为被调用的动作应该包含在该动作的相关控制器中。如果视图需要调用动作，它应该从相关控制器调用它，而不一定是它产生的控制器。

例如，如果您有一个库存控制器，您不想定义与管理相关的操作，即使库存屏幕上可能有一个管理操作。

# ruby - 是否有与 Perl 的 Data::Rmap 等效的 Ruby？

> ID：418386
> 
> 赞同：1
> 
> 时间：2009-01-06T22:05:00.030
> 
> 标签：ruby, perl, recursion, nested, language-comparisons

Perl 的[Data::Rmap](http://search.cpan.org/dist/Data-Rmap)允许您在数据结构列表上递归评估 BLOCK（本地设置 $_ 到每个元素）并返回由此类评估结果组成的列表。$_ 可用于修改元素。

这对于迭代嵌套散列或散列数组的层次结构等非常有用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-07T03:20:41.097

`Enumerable`我认为，Ruby 可以满足您的所有需求。“...并返回由此类评估结果组成的列表”表示您想要`Enumerable#map`. 我的第一次尝试是这样的：

```
[ {...}, {...}, {...}, ... ].map do |hash|
  hash.something
  do_other_stuff_with(hash)
  hash                  # important to have as last line b/c of how #map works
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T22:09:20.413

在没有真正研究细节的情况下，我不确定您是否需要 Ruby 中的模块。迭代器和块可以做你想做的事。

# html - GridView 对比 HTML 表格 (ASP.net 2.0)

> ID：418399
> 
> 赞同：4
> 
> 时间：2009-01-06T22:09:38.353
> 
> 标签：html, asp.net, gridview, html-table

为了完全控制您的应用程序，您更喜欢 GridView 还是 HTML 表格？为什么？

例如，我需要在 GridView/HTML 表中创建动态超链接每行。哪个对象更容易添加该功能（或其他类似的功能）？

注意：我正在以编程方式创建我的数据集

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-06T22:14:07.470

如果您不需要对排序或分页的内置支持，并且想要对呈现的输出进行更多控制，那么我会考虑使用 Repeater 控件来输出表格。如果您需要内置的排序/分页，那么 GridView 会很有帮助。

如果您想要两全其美，请升级到 ASP.net 3.5 并使用 ListView。

编辑：你能澄清一下'on-the-fly hyperlinks-per-row'是什么意思吗？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-07T14:44:02.073

远离 Gridview。它必须拉下整个数据集以呈现分页。仅呈现您需要的行（例如，6,0000 行中的第 30 - 40 行）并使用单独的分页器控件会快得多。此外，当涉及到 HTML/CSS 时，使用中继器或列表视图将更容易调试，因为您将完全控制代码。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-07-12T06:23:09.940

由 Response.Write 生成的纯 HTML <table> 非常简单，并且具有额外的好处，即如果您曾经在非 Microsoft 系统上工作，如果没有多余的 ASP.NET Web 控件，您将不会感到赤裸裸很难生成每个人都知道的 HTML。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-06T22:25:25.403

如果您不需要排序和/或分页，我认为中继器或更新的 ListView 是可行的方法。Repeater 和 ListView 允许您控制 HTML（在这方面 GridView 是一个完全黑匣子，并生成残暴的 HTML），同时避免了`<asp:Table>`控件附带的繁琐的服务器端代码：“好的，新行。新单元格。做带有单元格的东西。将单元格添加到行中。将行添加到表中。重复“。

另一方面，如果您需要分页和排序，GridView 可能是更好的解决方案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T00:51:05.780

您可以使用 GridView 或更简单的类似中继器的控件来构建您自己的 html，即使您必须对数据进行排序/分页。例如，使用中继器，您可以使用 PagedDataSource 数据源构建自定义分页系统，其属性 AllowPaging 设置为`true`。

唯一的问题显然是，使用简单的中继器，您必须编写更多代码来完成 GridView 本身所做的工作。

但结果**更快**。

# perl - Catalyst 应用程序的最佳动作持久性技术是什么？

> ID：418406
> 
> 赞同：8
> 
> 时间：2009-01-06T22:12:33.543
> 
> 标签：perl, catalyst

我正在编写一个需要相当短的会话到期时间（15 分钟）的 Catalyst 应用程序。我正在使用标准的 Catalyst 框架身份验证模块，因此用户数据存储在会话中——即，当您的会话到期时，您将被注销。

此应用程序的许多使用都需要超过 15 分钟才能完成，因此用户会经常提交表单，结果却发现他们的会话状态消失了，他们需要重新登录。

如果发生这种情况，我想保留原始表单提交，并且如果他们成功登录，则继续执行表单提交，就像会话没有过期一样。

我已经通过控制器中的 auto() 方法处理了身份验证内容——如果您请求一个需要身份验证的操作并且您当前没有登录，您将被重定向到 login() 方法，该方法显示登录表单，然后在提交后对其进行处理。当 auto 方法重定向到 login() 时，似乎应该可以存储请求和任何表单参数，然后如果 login() 成功，则将它们拉回来——但我不完全确定最好的以通用/标准/可重用的方式获取或存储此信息的方法。（我正在考虑将其存储在会话中，然后在将其拉出后将其删除；如果这看起来是个坏主意，那就另当别论了。）

是否有标准的“最佳实践”或食谱方法来做到这一点？

（一个皱纹：这些表格是通过 POST 提交的。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-07T01:18:54.023

我不禁想到，在一个应用程序中规定 15 分钟的超时时间是一个根本性的缺陷，该应用程序通常需要 15 分钟以上的操作之间的时间。

尽管如此，我会考虑重写该`Catalyst::Plugin::Session->delete_session`方法，以便`$c->request->body_parameters`序列化并保存（可能是数据库）的任何内容以供以后恢复。您可能需要对 POST 参数进行一些基本检查，以确保它们是您所期望的。

同样，`create_session`需要负责将这些数据从数据库中拉出，并使其可用于原始表单操作。

这似乎是一个混乱的情况，我倾向于重复我的第一句话......

更新：

无论您使用`delete_session`还是`auto`，矛盾的问题仍然存在：您不能在会话中存储此信息，因为超时事件会破坏会话。您必须将它存储在更永久的地方，以便它在会话重新初始化时仍然存在。`Catalyst::Plugin::Session`本身正在使用[Storable](http://search.cpan.org/~ram/Storable-1.0.14/Storable.pm)，您应该能够使用以下内容：

```
use Storable;
...
sub auto {
    ...
    unless (...) { #ie don't do this if processing the login action
        my $formitems = freeze $c->request->body_parameters;
        my $freezer = $rs->update_or_create(
              {user => $c->user, formitems => $formitems} );
        # Don't quote me on the exact syntax, I don't use DBIx::Class
    }
    ...
    my $formitems = $c->request->body_parameters
                  || thaw $rs->find({$user => $c->user})->formitems
                  || {} ;
    # use formitems instead of $c->request->body_parameters from here on in 
```

基础表可能有（用户 CHAR(x)、formitems TEXT）或类似的。也许是一个时间戳，以便恢复任何太陈旧的东西。您可能还想存储您正在处理的操作，以确保检索到的表单项属于正确的表单。你比我更了解你的应用程序的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T04:07:56.273

我会将表单数据作为某种用户数据存储在模型中。

[Catalyst::Plugin::Session::PerUser](http://search.cpan.org/perldoc?Catalyst::Plugin::Session::PerUser)是这样做的一种方式（尽管有点老套）。我建议仅将会话插件用于身份验证并将所有状态信息存储在存储用户数据的模型中。

我完全同意 RET 的观点，即 15 分钟的限制在这种情况下似乎真的适得其反。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-12T23:38:13.890

我在 CPAN 搜索完全不相关的东西时遇到了这个问题。

[Catalyst::Plugin::Wizard](http://search.cpan.org/perldoc?Catalyst::Plugin::Wizard)声称可以完全满足您的需求。文档建议它可以重定向到登录页面，同时保留先前操作的状态。

注意：我没用过，所以不能保证它的有效性。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-21T03:35:13.120

最后，我们最终在 auto() 中获取了待处理的请求（URL+参数），对其进行序列化和加密，并通过登录页面上的隐藏表单元素传递它。如果我们收到一个填充了隐藏元素的登录请求，我们会对其进行解密和反序列化，然后进行适当的重定向（确保通过标准的“这个用户可以做这件事”代码路径）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T17:01:12.250

您总是可以在客户端上安装一些 javascript，通过每隔几分钟发出一个小请求来防止会话过期。

或者，您可以让 AJAX 在发布表单之前检查活动会话，并在需要时向用户显示新的登录框。

# animation - 使用核心动画，有没有办法为几个 CALayers 分组动画？

> ID：418419
> 
> 赞同：5
> 
> 时间：2009-01-06T22:19:19.190
> 
> 标签：animation, core-animation

我有一种情况，我有许多以“回合制”方式制作动画的 CALayer。我为每个 CALayers 上的位置设置动画，但它们的持续时间完全相同。一旦所有这些 CALayer 都完成了动画，就会启动一个新的“转弯”，并且它们会再次动画改变位置。

整个想法是，通过位置之间的线性插值，并且以恒定的速度，状态到状态之间的基于回合的转换看起来像实时动画。然而，这很难通过许多不同的 CALayer 来实现。

CAAnimationGroup 用于将单个 CALayer 上的动画组合在一起。但我想知道，是否有一个简单的解决方案来组合动画，它们应该具有相同的持续时间，在几个 CALayers 上？

*编辑包括对凯文巴拉德问题的回复*

我的问题就在于此。我正在为我的每个 CALayers 创建动画，然后将它们放在 NSArray 中。一旦我得到单个动画已经结束的回调，我将它从 NSArray 中删除。一旦它为空，我再次为它们创建动画。

如果层数多于几层，则在所有动画完成与新动画开始之间存在明显的延迟。

我想如果我可以将所有这些动画组合成一个单独的动画，就可以在动画之间没有延迟的情况下制作更多图层。从而不会破坏连续动画的错觉。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-09T02:03:49.657

如果您在一个方法中将动画附加到多个 CALayer，它们都将（有效地）同时开始。我在一个带有落球的益智游戏中使用这种方法，在动画结束时，我将下一阶段的动画附加到任何需要进一步动画的球上。

我一次制作多达 60 个 CALayers 的动画，并且在动画的各个阶段之间没有遇到任何延迟，但我没有将动画缓存在任何类型的数组中，我不确定你那里的开销。

我的动画相对简单，并且动态创建并附加到每个 CALayer。我的精灵是 60 像素的正方形，并使用几十个可能的图像来表示它们的内容。

在某些情况下，我可以使用不同的开始时间（使用 beginTime）创建多个动画，我将它们与 CAAnimationGroup 捆绑在一起 - 但您可能无法预先计算后续动画。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-22T12:13:23.433

如果将动画包装在 CATransaction 中，CG 将确保它们都在主循环的同一迭代中运行。

[CA交易开始]；// 你所有的动画 [CATransaction commit];

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T04:49:12.510

如果您同时将 3 个动画添加到 3 个不同的图层，并且它们具有相同的持续时间，我希望它们都可以一起制作动画。你看到了什么行为？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-07T23:32:27.927

cp21yos：你能详细说明你的方法吗？我正在尝试做类似的事情，这涉及一次动画多个图层，不止一次。你说：“在动画的最后，我附上下一阶段的动画”。你能解释一下吗？当我尝试在 animationDidStop 事件中添加执行附加动画的逻辑时，只会出现最后一个动画，而不是整个动画序列。

# .net - Threading.Timer 与 Forms.Timer

> ID：418423
> 
> 赞同：21
> 
> 时间：2009-01-06T22:21:16.020
> 
> 标签：.net, winforms, multithreading, .net-2.0

这个问题的简短形式：什么时候，如果有的话，在多线程 WinForms 应用程序中使用 Forms.Timer 是否合适？

更具体地说，我正在构建一个应用程序，它使用多个 System.Threading.Timers 来异步启动进程，检查包含这些异步进程结果的队列，并更新应用程序主窗体显示的统计信息。

在这样的应用程序中，使用 Forms.Timer 来实际检查应用程序统计数据并将它们绘制到主窗体是否合适，或者这只会影响应用程序的平稳运行？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-01-06T22:32:14.470

`Forms.Timer`注册定时器以在定时器关闭时发送消息。引发的事件被视为 GUI 事件。`System.Threading.Timer`使用线程阻塞方法。基本上，您应该使用`Forms.Timer`面向 GUI 的计时器（为用户界面添加一些效果）以及`Threading.Timer`安排任务和其他事情。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-01-06T22:25:16.107

MSDN 有一篇[比较文章](http://msdn.microsoft.com/en-us/magazine/cc164015.aspx)，可以做到这一点。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-06T22:35:49.500

我同意 Mehrdad 和 David 所说的，但你应该知道，计时器不能保证及时性、顺序或执行。计时器太多，应用程序将挂起；-)

# php - 我的 MySQL 查询有什么问题？

> ID：418428
> 
> 赞同：1
> 
> 时间：2009-01-06T22:23:13.303
> 
> 标签：php, mysql, inner-join

我没有收到任何错误，因为这只是一个小性能问题。

```
EXPLAIN
SELECT
a.nid,
a.title,
a.uid,
b.parent,
b.weight,
c.name,
d.value
FROM table1 AS a INNER JOIN table2 AS b ON a.vid = b.vid AND a.status = 1
INNER JOIN table3 AS c ON c.uid = a.uid
INNER JOIN table4 AS d ON d.content_id = a.nid AND d.value_type = 'percent' AND d.function = 'average' 
```

当我查看正在引用哪些表时，一切都很好，但是从应该只选择“值”字段的 table4 中，我得到了一个 ALL 被调用...

```
id  select_type     table   type      possible_keys                                   key     key_len   ref                   rows  Extra
1   SIMPLE          a     ref     PRIMARY,vid,status,uid,node_status_type,nid   status  4         const                 1    
1   SIMPLE          b     eq_ref    PRIMARY                                         PRIMARY 4         databasename.a.vid    1    
1   SIMPLE          c     eq_ref    PRIMARY                                         PRIMARY 4         databasename.a.uid    1   Using where
1   SIMPLE          d     ALL     NULL                                          NULL      NULL      NULL                  2     Using where 
```

如您所见，它从决赛桌 (d) 中选择 *。当我只需要从中选择一个字段时，为什么要这样做？谁能帮我吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-06T22:26:38.567

`ALL`表示所有行，而不是所有列。由于它说没有可能的键，我猜你在 d.content_id 或 d.value_type 或 d.function 上没有索引。

如果您想变得花哨，可以在所有 3 列中放置一个索引。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-06T22:26:48.163

d.value_type 和 d.function 是索引字段吗？那将是对原因的最初直觉。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-08T07:26:28.510

`table4`基于`content_type`,`value_type`和列添加多列索引`function`。

您的查询不是从中选择所有列`table4`，而是选择所有行；当只有两个时，这不是什么大问题。

请注意，当您处理少量记录时，MySQL 查询执行计划可能不会给出您期望的答案；在这种情况下，数据库进行全表扫描会更快。

# django - 在 Django 中使用 Jinja2 模板有什么缺点或陷阱吗？

> ID：418430
> 
> 赞同：23
> 
> 时间：2009-01-06T22:24:02.240
> 
> 标签：django, templates, frameworks, django-templates, jinja2

阅读 Jinja2 文档后，我有兴趣在未来的 Django 项目中使用它。但是，我想知道在 Django 中使用 Jinja2 模板时是否有人遇到过任何缺点或陷阱？如果是这样，您是如何解决这些问题的？

我也不介意听到积极的经历，只是为了更好地了解 Jinja2 的最佳和最差。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-06T15:40:10.350

我在我的一些项目中使用 Jinja2，并且喜欢它给我的额外表现力。我可以将我的表示逻辑和应用程序逻辑分开，但我不必向后弯腰来调用我专门为我的表示层设计的函数/方法。

除了其他海报已经列出的内容之外，以下是我发现的一些内容：

*   Admin 应用程序与 Django 模板紧密耦合
*   Auth 应用程序（和其他地方）附带的默认视图和装饰器与 Django 模板耦合，因此如果您想使用 Jinja2 模板进行登录/注销/等，您可能不得不重复工作

在行为上，Django 模板默认会转义其输出，而 Jinja2 不会。我认为这两种方法都有其优点，但如果您在两者之间切换，则必须牢记这一点。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-18T19:40:53.160

我已经[在我的 wiki 上记录了 Django -> Jinja2 的一些语法、配置、过滤器和互操作性注意事项](http://splike.com/wiki/Convert_Django_Templates_to_Jinja2)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-07T05:37:45.127

我还没有将 Jinja2 与实际的 Django 站点一起使用，但我确实将在独立模式下使用 Django 模板的应用程序转换为 Jinja2 模板。我遇到的唯一（非常小的）问题是缺少 {% spaceless %} 模板标签。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-23T13:51:38.940

扩展 Jinja2 比 Django 模板系统困难得多（我说的是模板标签）。虽然大部分包含标签功能都可以在 Jinja 中使用宏来实现（它们甚至看起来更合适），但在 Jinja 中编写更复杂的标签确实很难（请参阅[文档](http://jinja.pocoo.org/2/documentation/extensions#module-jinja2.ext)）。

除此之外，唯一的障碍是基于 Django 的习惯...... ;)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-01-06T03:20:33.440

在 Django 主干中添加了一些新代码，可让您编写可用于使用不同模板语言的 TemplateLoaders 和 Template 类。文档已在[http://docs.djangoproject.com/en/dev/ref/templates/api/#using-an-alternative-template-language](http://docs.djangoproject.com/en/dev/ref/templates/api/#using-an-alternative-template-language)添加，它将在1.2 版本中。这应该可以消除大多数问题，例如使用自定义模板进行登录、注销、管理等。

另一种解决方案是在 Django 之上使用一个层，例如 Chouwa 或 Djinja2。让 Django 的内置视图使用您的模板时会遇到问题，但如果您不想使用 Django 主干，它可以工作。

一旦你完成了其中任何一个，唯一真正主要的问题是 Django 暴露给模板的大部分内容（尤其是评论框架）都暴露在自定义标签中，这些标签不会转换为 Jinja2。遗憾的是，向后兼容性问题不会很快改变。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-09-26T17:08:48.183

对我来说，在 Django 中使用 Jinja2 最烦人的事情是，当某些 Django 应用程序带有自己的模板或模板标签（例如 django-uni-forms）时，**您将无法使用它们。**

有时这可能会令人沮丧，当您找到一个可以解决您的问题但您无法使用它的出色应用程序时，因为它与 Jinja2 不兼容。

[顺便说一句， Armin Ronacher](https://github.com/mitsuhiko) （Jinja2 的作者）似乎正在开发一个新的模板引擎后端，该后端将位于 Jinja2 和 Django 之后，替换当前的基础架构，但保留向后兼容性。[https://www.djangoproject.com/weblog/2011/apr/25/gsoc/](https://www.djangoproject.com/weblog/2011/apr/25/gsoc/)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-09-27T00:49:54.043

回复：在 jinja2中缺少`{% spaceless %}`，查看[jinja2htmlcompress](https://github.com/mitsuhiko/jinja2-htmlcompress)模块：

```
# In shell:
fetch -o myapp/jinja2htmlcompress.py https://raw.github.com/mitsuhiko/jinja2-htmlcompress/master/jinja2htmlcompress.py

# In your app:
app = Flask(__name__, static_path='/static')
app.config.from_object('myapp.default_settings')
app.jinja_env.add_extension('myapp.jinja2htmlcompress.HTMLCompress') 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-06-28T02:50:57.343

截至 2015 年 4 月，**Django 1.8 支持在同一个项目中使用[多个引擎](https://docs.djangoproject.com/en/1.9/topics/templates/#support-for-template-engines)**渲染模板，并[内置了对 Jinja2 的支持](https://docs.djangoproject.com/en/dev/topics/templates/#django.template.backends.jinja2.Jinja2)。所以它不再是一个全有或全无的决定。

（虽然这不是直接回答这个问题，因为以前就是这种情况，我认为它值得不仅仅是评论）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-07-21T18:34:14.903

我在使用 Jinja2 时遇到了一些问题。然而，有一个非常简单的方法可以解决这个问题。

[带有 jinja2 的 django 酥脆形式](https://stackoverflow.com/questions/25364980/django-crispy-forms-with-jinja2)

我认为总的来说，缺点很可能是类似的经常使用的 Django 包，它们只是不与 Jinja2 一起玩

# flash - Flash 编程 - 有人知道如何处理图像数组吗？

> ID：418448
> 
> 赞同：1
> 
> 时间：2009-01-06T22:28:55.567
> 
> 标签：flash, arrays, image

一位朋友要求我制作一个 Flash 8.0 静态图片库网站并使其动态化。我为动态图像库找到的大多数文章都涉及根据请求将图像加载到现有的影片剪辑中。我不能这样做，因为使用了一些非常简洁的过渡，需要两个图像都可用。我已经知道如何使用 MovieClipLoader 类将我需要的图像加载到图像数组中，但是我很难弄清楚如何将它们放置（和复制）到特定的图层中。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-18T14:05:15.547

我建议你重做画廊，而不是试图修复旧的东西。你做过旧项目吗？

基本逻辑是这样的：

你必须有：

*   两个容器
*   保存哪个容器是活动容器的变量
*   要加载的图像列表

程序应该是这样的：

*   将第一个图像加载到第一个容器中并使其可见（容器）
*   将第二个图像加载到第二个容器中并使其不可见（容器）
*   如果用户想看下一张图片，则过渡消失=第二个容器可见，第一个容器被隐藏
*   现在将第三个图像加载到第一个容器中，然后将第一个图像踢出 // 处理必须加载到哪个容器中的逻辑保存在那个变量中

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-07T16:24:21.933

If I were you I would first work through this tutorial and see if you experience any ahHA moments.

[http://flashexplained.com/actionscript/making-the-ultimate-dynamic-image-gallery-in-flash-8/](http://flashexplained.com/actionscript/making-the-ultimate-dynamic-image-gallery-in-flash-8/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-13T21:03:26.447

这是我开始使用的教程，并意识到我需要更多。当我提到应请求加载的图像时，这就是我所指的。我需要的是预先加载图像，可能是在一个数组中，然后放置到不同的层中，这样它们就可以使用遮罩。

# c# - 如何在 Visual Studio 中更改大括号/括号颜色

> ID：418452
> 
> 赞同：39
> 
> 时间：2009-01-06T22:31:33.800
> 
> 标签：c#, visual-studio, ide

我不是在谈论突出显示的颜色，而是实际的颜色。我有一个浅色背景色的配色方案，但大括号/括号几乎不可见。任何人都知道如何改变这个？

顺便说一句，这适用于 C#，因为 C++ 似乎使用运算符颜色为大括号/括号着色。

* * *

## 回答 #1

> 赞同：91
> 
> 时间：2014-10-27T23:57:23.950

由于某种原因，Visual Studio 2014 CTP 14.0.22129 深色主题将括号和分号涂黑。我可以通过更改“标点”显示项的前景色来解决此问题。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2015-11-10T08:55:32.107

工具 > 选项 > 字体和颜色 > 显示项目：标点符号

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2010-06-09T08:14:01.387

我知道这是一个已经回答的老问题，但我找到了一个至少适合我的解决方案。

将“纯文本”颜色设置为您希望大括号的颜色，然后将“标识符”颜色设置为您希望其余文本看起来的颜色。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2017-05-16T07:16:19.530

Visual Studio 2017 仍然存在将黑色作为编辑器中的默认颜色的问题。通常它不是，但由于某些原因它看起来是黑色的。

我将以下两项更改为`Silver`并按确定，然后再次打开选项并返回`Default`解决。

*   工具 > 选项 > 字体和颜色 > 显示项目：标点符号
*   工具 > 选项 > 字体和颜色 > 显示项目：运算符

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-01-06T22:38:29.933

工具>选项>字体和颜色>“显示项目”：纯文本

不幸的是，这不仅改变了大括号，而且据我所知，这是定位它们的唯一方法。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2015-03-07T07:20:37.093

要在 Visual Studio 2010 Ultimate 中更改项目的前景色和背景色，请执行以下操作：工具->选项->环境->常规->字体和颜色。这对我来说可以将 Brace Matching(Rectangle) 从大麦可见的默认颜色更改为我自己选择的颜色。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2017-11-19T21:03:16.620

我使用的是深色主题（不是浅色），但我遇到了非常相似的问题。今天启动 IDE 时，我的括号、大括号和标点符号是黑色的，几乎看不到它们。

我试图“默认”字体和颜色，但这没有帮助。也没有更改纯文本、大括号或标点符号的设置。

但是，从深色主题更改为浅色主题，然后再次返回深色主题，一切都恢复了正常。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2019-11-06T17:13:05.290

它是 C++ 的“运算符”（下面的证明），但 C# 是“标点符号”。改变两者。

[![在此处输入图像描述](https://i.stack.imgur.com/8aOJ6.png)](https://i.stack.imgur.com/8aOJ6.png)

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2018-05-10T18:50:25.993

对于在这里遇到与 Visual C++ 相同问题的任何人，如果您使用视觉辅助，只需知道它会覆盖其他人提到的标点符号配色方案。您必须更改 Visual Assist 选项中的颜色并将其设置为黑色以外的其他颜色（这是默认颜色）。 [![在此处输入图像描述](https://i.stack.imgur.com/D9AEB.png)](https://i.stack.imgur.com/D9AEB.png)

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2018-06-15T21:41:59.063

**对比 2017 <**

以下说明显示了如何更改匹配大括号及其矩形的背景颜色。点击图片看一下源码中的大括号！

> 打开 Visual Studio --> 工具 --> 选项

要更改请`backgroundColor`按照下图中的步骤操作！

[![在此处输入图像描述](https://i.stack.imgur.com/jgaq5.png)](https://i.stack.imgur.com/jgaq5.png)

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-01-06T22:43:26.273

呸，发布了一个答案，它迷路了。FF 和我的代理服务器相处不来。

我认为没有办法只改变括号的颜色，它们似乎遵循文本颜色。我确实找到[了这个工具](http://www.codekana.com/features.html)，它可以让你用paren颜色做各种各样的事情；49美元看起来很漂亮。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2017-12-08T21:43:04.480

您可以在 VS 中更改*标点*颜色，但它实际上会更改属于*标点*类别的所有元素的颜色。

如果您想要一个可以微调的解决方案，您可以使用我们开发的[语义荧光笔扩展。](https://github.com/abmes/SemanticHighlighter)它可以为代码的不同部分着色，例如大括号、方括号、圆括号、尖括号，甚至属性、字段、参数、命名空间等等。

您可以将其安装为 Visual Studio 扩展。它在图库中可用 - 只需搜索“语义荧光笔”

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2019-01-11T06:57:24.167

以下是将匹配括号的巴黎着色为相同颜色的扩展：

[https://marketplace.visualstudio.com/items?itemName=CoenraadS.bracket-pair-colorizer-2](https://marketplace.visualstudio.com/items?itemName=CoenraadS.bracket-pair-colorizer-2)

[https://marketplace.visualstudio.com/items?itemName=TomasRestrepo.Viasfora](https://marketplace.visualstudio.com/items?itemName=TomasRestrepo.Viasfora)

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2018-11-15T21:50:48.693

在 VS 2017 中，它是工具 > 选项 > 环境 > 字体和颜色 > “显示项目”：“大括号匹配”

[![在此处输入图像描述](https://i.stack.imgur.com/kxrQU.png)](https://i.stack.imgur.com/kxrQU.png)

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2021-03-04T17:01:08.930

在 VS2019 中 - 我将下面的项目更改为 Lime，这样当您的鼠标“打开”一个大括号或括号时，它会突出显示您所在的那个以及匹配的大括号/括号。下面的屏幕截图显示了我所做的更改以及对 if 语句大括号的影响。

工具 > 选项 > 环境：字体和颜色 > 显示项目：大括号匹配

[![请注意，我单击了大括号或大括号之前，它是石灰。](https://i.stack.imgur.com/3wfzY.png)](https://i.stack.imgur.com/3wfzY.png)

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2017-03-09T16:24:47.887

我通过选择工具 > 选项 > 环境 > 字体和颜色 > 显示项目：运算符更改了括号、花括号和分号的颜色。享受编码:)

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2017-10-24T07:08:44.513

更改匹配大括号工具>选项>字体和颜色
在“显示项目”下选择“大括号匹配（矩形）”为您想要的颜色。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2020-07-29T10:42:16.857

在 VS2019 中：工具 > 选项 > 字体和颜色 > 显示项目：VA 大括号匹配

* * *

## 回答 #19

> 赞同：-1
> 
> 时间：2009-01-06T22:35:53.043

据我所知，你不能:-(

* * *

## 回答 #20

> 赞同：-1
> 
> 时间：2015-03-06T04:18:14.170

工具 > 选项 > 字体和颜色 >DisplayItem(D:):Paren matching (方括号) 但是visual studio 2015 Preview 只能更改javascript 大括号/括号颜色，C# 貌似不行:(

# apache - 仅当本地目录不存在时才在 Apache 中使用别名？

> ID：418463
> 
> 赞同：5
> 
> 时间：2009-01-06T22:36:42.650
> 
> 标签：apache, alias, cpanel, whm, mod-alias

我们正在运行一个经销商网络主机，并为其中的所有站点设置一个特定目录的别名。这一切都是通过 WHM/Cpanel 发生的，这可能会使我的问题复杂化。

1.  我们希望所有主机都通过服务器上的共享位置运行它们的“/concrete”目录。通过将“别名/concrete/”/usr/local/share/concrete5/concrete-latest/concrete/”添加到 WHM 中的 apache 包含编辑器，这可以正常工作。

2.  但是，如果虚拟主机的特定 webroot 中存在本地具体/目录，我们宁愿使用它而不是全局使用“/concrete”。如果我们可以在 WHM 内的虚拟主机上下文中更改此别名，那也很好（而且我还没有找到一种很好的方法来修改 WHM 中的虚拟主机部分，而无需破解我不相信的文件'应该破解。）

想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-08T14:22:17.220

一个原始的，虽然可能非常有效的解决方案可能是忘记 Alias 指令并简单地依赖符号链接。如果已经存在称为“具体”的东西，那么为您创建这些符号链接的小 shell 脚本将完全失败。

# algorithm - 偏爱蛮力解决方案是一个坏兆头吗？

> ID：418465
> 
> 赞同：12
> 
> 时间：2009-01-06T22:37:16.567
> 
> 标签：algorithm, brute-force

我是一名初学者 C++ 程序员，为了扩展我的想法，我一直在尝试[projecteuler.net](http://projecteuler.net/)上的一些问题。尽管在学校对数学很感兴趣，但我发现自己会自然而然地寻求解决问题的蛮力解决方案，而不是寻找流线型或优雅的东西。

这听起来像是一种糟糕的心态吗？这样做我感到有点内疚，但也许有时快速和肮脏是可以的......

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-01-06T22:46:55.033

我认为你应该看看你的最终目标是什么以及你的限制是什么。

有时，蛮力方法可以在 50 毫秒内解决问题，尝试各种解决方案的组合，而“聪明”的解决方案可以在 10 毫秒内解决。在那一点上，不太聪明但更容易理解的解决方案胜过聪明的解决方案。

但是，存在一些问题，暴力破解不仅不优雅，而且根本行不通。有很多问题，如果你试图天真地暴力破解它们，解决它们将花费大量时间。所以很明显，这些类型的问题需要更优雅的方法。

所以问问你自己，你为什么要尝试这些 Project Euler 问题？你这样做是为了学习吗？那么也许尝试一个聪明的解决方案最符合您的利益，但前提是您最初尝试了一个蛮力解决方案来帮助理解问题。

在做 Python 挑战题时，我尽量用最简洁的方式来做，挑战我的能力极限。在我解决它之后，我会查看其他人的答案，并记下比我更聪明的人以及他们所做的事情。有些人会特别使用我没想到的更适合任务的数据结构，或者他们会使用一些数学技巧来提高算法的效率。最后，我尝试尽可能多地吸收他们的聪明才智，并在下次遇到类似性质的问题时将其展示出来。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-06T22:43:01.873

不，这不是一件坏事。我有非常优雅的解决方案，他们错了。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-01-06T22:47:36.390

作为初学者程序员，您将花费更多的精力来弄清楚如何在 C++ 中实际实现事物，而不是花费精力为每个问题寻找聪明的解决方案。这很好，因为它让您有机会在处理各种问题的同时探索 C++ 的不同领域。

当您精通 C++ 并且不必考虑如何做每一件小事时，*您*将能够花更多时间发明非暴力解决方案。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-01-06T22:43:17.567

优雅的解决方案不是自发创建的；当当前解决方案需要更高的速度或更少的内存消耗时，它们源自蛮力解决方案。

所以不，不是。优雅的解决方案就是这样产生的。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-06T22:45:55.957

肯汤普森：“当有疑问时，使用蛮力”

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-01-06T22:48:53.967

我已经经历了这种演变：

1.  让它编译
2.  使其按预期工作
3.  找出一种可行的解决方案
4.  想出一个好的解决方案
5.  找出多种解决方案，并找到最佳解决方案
6.  找出多种解决方案，并找到最适合这种情况的解决方案
7.  ?? 还没到

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-01-06T22:40:17.417

我会说不，这不是一个坏兆头。事实上，远离过早的优化是在帮自己一个忙，这绝对是一件好事。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-06T22:42:17.740

学习是一个蛮力的过程。我不会说它不好。在尝试以这种方式做某事时，您可能会注意到一种模式。我认为只要您在思考某事并尝试找到解决方案，您就会学到。很少有人会直接跳到最优雅或最有效的解决方案上。

很难让我相信努力学习的人会被称为坏人。除了可能是一个邪恶的科学家：P

祝你好运。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-06T22:46:20.587

您是否符合问题的 1 分钟运行时间规则？如果是，那么您的“蛮力”解决方案满足所有要求，这实际上是一个非常好的迹象，表明您可以快速想出可行的方法！

这些类型的问题鼓励微优化和非常聪明的算法，但一般来说，一个非常易读的简单实现将更容易维护，并且会在商业世界中受到青睐。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-06T22:49:18.537

如果碰巧是“蛮力”=>“简单”和“优雅”=>“复杂”的情况，那么蛮力获胜。这通常是真的。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-01-06T23:09:48.293

一点也不。正确、彻底地解决问题，然后根据需要使其更高效或更优雅。

这并不是说您应该忽略明显的性能改进......只是在您更好地理解问题之前不要关注它们。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2010-09-26T01:19:21.643

把它放在不同的上下文中：

当您使用一个您不太了解的库时（例如，用于创建 UI），您可以以完美的性能方式解决一个简单的问题，尽管您知道有一个“正确的方法”可以做到这一点。如果你对你的蛮力代码让你看起来像个白痴感到好奇和担心，你很快就会找到“正确的方法”来做这件事（例如，在周末，或者在你睡觉的时候）。**与此同时，通过蛮力，你将拥有一些有用的东西。**

实际上，我有时会忘记使用蛮力，并开始扫描 API 以寻找“正确”的解决方案。在许多情况下，这绝对是一个错误。**如果蛮力解决方案易于实施，可以根据需要进行扩展（真的，如果可行的话），然后忘记正确的解决方案。**你很快就会找到它（很多时候你已经知道了！），但与此同时，你解决了问题并能够继续下一个问题。

编码时的障碍是可怕的，绝对应该避免使用暴力解决方案。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-06T22:58:08.380

倾向于蛮力绝对不是一个坏迹象，尤其是作为初学者，因为你可能不知道更好。特别是对于 Project Euler，实施蛮力方法而不查看评论以学习更有效的方法是一个不好的迹象。

我经常和你在同一条船上，这就是我开始做体育问题的原因——我正在实施很多蛮力方法，并希望让自己接触到更优雅的解决方案......

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2010-09-26T01:23:03.203

你已经权衡了你的选择。如果蛮力解决方案能够完成工作并执行良好，那么这是一个很好的解决方案。

# macos - 什么是从文件尾部修剪 N 行的简单方法（不使用“head”）？

> ID：418467
> 
> 赞同：11
> 
> 时间：2009-01-06T22:38:17.810
> 
> 标签：macos, unix, command-line, scripting

假设我有一堆超过 100 行的文件。我想剪掉前 14 行和下 9 行，只留下中间的行。此命令将修剪前十四个：

```
cat myfile.txt | tail -n +15 
```

是否有另一个命令我可以通过管道修剪底部 9 而无需明确传递文件的长度？

编辑添加：我的 head 版本（Mac OS 10.5）不接受负数的行作为参数。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-07T00:51:22.630

这将适用于 OS X，并且可能比`sed`示例更容易理解：

```
< myfile.txt tail -n +15 | tail -r | tail -n +10 | tail -r 
```

当然，如果你能掌握 GNU 版本的`head`，它可以做得更优雅：

```
< myfile.txt tail -n +15 | head -n -9 
```

请注意`tail` *从*第 n 行开始，同时`head` *跳过*输入的 n 行。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-06T22:43:59.750

你可以使用 sed：

```
sed -n -e :a -e '1,9!{P;N;D;};N;ba' myfile.txt 
```

您也可以将 sed 用于前 15 个：

```
sed '1,15d' myfile.txt 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-06T22:44:19.360

在命令中使用负数的行`head`：

```
cat myfile.txt | head -n  -9 
```

打印除最后 9 行之外的所有内容。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-06T22:45:07.500

jbourque 说的完全正确。他只是没有太罗嗦：

```
cat myfile.txt | tail -n +15 | head -n -9 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-06T23:25:40.260

如果您可以通过第一行的独特模式识别最后 9 行，那么一个简单的`sed`命令就可以解决问题：

```
sed -e '1,15d' -e '/distinctive-pattern/,$d' $file 
```

如果您需要从底部开始的纯数字偏移，标准（相对于 GNU）`sed`将无济于事，但`ed`会：

```
ed $file <<'!'
1,15d
$-8,$d
w
q
! 
```

这会覆盖原始文件。如果你想避免这种情况，你必须编写文件写入的脚本。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-06T22:41:10.613

该`head`命令应该做你想做的事。它就像文件的另一端一样`tail`，但来自文件的另一端。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-09T12:45:34.240

这也应该有效，并在一个进程中完成：

```
seq 15 | 
awk -v N=5 '
  { lines[NR % N] = $0 } 
  END { i = NR-N+1; if (i<0) i=0; for (; i <= NR; ++i) print lines[i % N] }' 
```

（这`seq`只是产生一些测试数据的简单方法。）

# ruby-on-rails - Rails 有内置的身份验证系统吗？

> ID：418469
> 
> 赞同：5
> 
> 时间：2009-01-06T22:38:38.247
> 
> 标签：ruby-on-rails, authentication, restful-authentication

这些年来，我已经为 webapps 实施了几次身份验证系统，但在我再次这样做之前，我想我会问是否有我应该知道的罐装解决方案。

上次我检查时，没有内置的 Rails 身份验证系统，标准解决方案是[restful-authentication](http://github.com/technoweenie/restful-authentication/tree/master)插件。还是这样吗？或者它现在已经被合并到 Rails 中了？我见过这种情况。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-06T22:51:47.613

我现在建议[使用 AuthLogic](http://www.railsinside.com/plugins/145-authlogic-another-take-on-rails-authentication.html)而不是 restful-auth，它的侵入性要小得多，但支持较少（restful-auth 包含在[bort](http://jimneath.org/2008/09/09/bort-base-rails-application/)之类的东西中）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-06T22:42:42.187

Restful-authentication 仍然是标准。如果你有一段时间没有看插件，源已经转移到[Github](http://github.com/technoweenie/restful-authentication/tree/master)

# silverlight - Silverlight Control 不会超过 600，错误？

> ID：418475
> 
> 赞同：0
> 
> 时间：2009-01-06T22:42:21.673
> 
> 标签：silverlight

试试这个示例代码。下面是带有 silverlight 控件的 aspx 页面，下面是带有彩色行的网格的 xaml 代码。请注意，网格有 8 行，每行高度为 100，但仅显示前 6 行。我无法控制显示大于 600。

* * *

aspx 代码

* * *

```
<html xmlns="http://www.w3.org/1999/xhtml" >
<head runat="server">
<title></title>
</head>
<body>
<form id="form1" runat="server">
    <asp:ScriptManager ID="ScriptManager1" runat="server"></asp:ScriptManager>
    <div>
        <asp:Silverlight ID="Xaml1" runat="server" Source="~/ClientBin/x.xap" MinimumVersion="2.0.31005.0" Width="100%" Height="100%" />
        </div>
</form>
</body>
</html> 
```

* * *

XAML 代码

* * *

```
<UserControl xmlns:my1="clr- namespace:System.Windows.Controls;assembly=System.Windows.Controls.Data"  x:Class="x.Test"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
Width="400" Height="Auto">
<Grid x:Name="LayoutRoot" Background="White">
    <Grid.RowDefinitions >
        <RowDefinition Height="100"/>
        <RowDefinition  Height="100"/>
        <RowDefinition  Height="100"/>
        <RowDefinition  Height="100"/>
        <RowDefinition  Height="100"/>
        <RowDefinition Height="100" />
        <RowDefinition Height="100" />
        <RowDefinition Height="100" />
    </Grid.RowDefinitions>

    <Rectangle Grid.Row="0" Fill="Green"/>
    <Rectangle Grid.Row="1" Fill="Red" />
    <Rectangle Grid.Row="2" Fill="Blue" />
    <Rectangle Grid.Row="3" Fill="Orange"/>
    <Rectangle Grid.Row="4" Fill="Yellow" />
    <Rectangle Grid.Row="5" Fill="Black" />
    <Rectangle Grid.Row="6" Fill="Aqua"/>
    <Rectangle Grid.Row="7" Fill="Olive"/>

</Grid>
</UserControl> 
```

想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T01:43:01.370

我刚刚尝试了您的 XAML 和 ASPX，它对我有用；我可以看到所有三行。在创建一个新的 Silverlight 项目时，VS 添加了这个 ASPX -

```
<%@ Page Language="C#" AutoEventWireup="true" %>
<%@ Register Assembly="System.Web.Silverlight" Namespace="System.Web.UI.SilverlightControls"
        TagPrefix="asp" %>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
    <html xmlns="http://www.w3.org/1999/xhtml" style="height:100%;">
    <head runat="server">
        <title>SilverlightApplication1</title>
    </head>
    <body style="height:100%;margin:0;">
        <form id="form1" runat="server" style="height:100%;">
            <asp:ScriptManager ID="ScriptManager1" runat="server"></asp:ScriptManager>
            <div  style="height:100%;">
                <asp:Silverlight ID="Xaml1" runat="server" Source="~/ClientBin/SilverlightApplication1.xap" MinimumVersion="2.0.31005.0" Width="100%" Height="100%" />
            </div>
        </form>
    </body>
    </html> 
```

你可以试试上面的ASPX吗？

HTH，印地

# python - 如何将 XML 转换为 Python 对象？

> ID：418497
> 
> 赞同：42
> 
> 时间：2009-01-06T22:47:14.987
> 
> 标签：python, xml

我需要加载一个 XML 文件并将其内容转换为面向对象的 Python 结构。我想接受这个：

```
<main>
    <object1 attr="name">content</object>
</main> 
```

并把它变成这样的东西：

```
main
main.object1 = "content"
main.object1.attr = "name" 
```

XML 数据将具有比这更复杂的结构，我无法对元素名称进行硬编码。解析时需要收集属性名称作为对象属性。

如何将 XML 数据转换为 Python 对象？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2009-01-07T04:51:26.687

值得一看[`lxml.objectify`](http://lxml.de/objectify.html)。

```
xml = """<main>
<object1 attr="name">content</object1>
<object1 attr="foo">contenbar</object1>
<test>me</test>
</main>"""

from lxml import objectify

main = objectify.fromstring(xml)
main.object1[0]             # content
main.object1[1]             # contenbar
main.object1[0].get("attr") # name
main.test                   # me 
```

或者反过来构建 xml 结构：

```
item = objectify.Element("item")
item.title = "Best of python"
item.price = 17.98
item.price.set("currency", "EUR")

order = objectify.Element("order")
order.append(item)
order.item.quantity = 3
order.price = sum(item.price * item.quantity for item in order.item)

import lxml.etree
print(lxml.etree.tostring(order, pretty_print=True)) 
```

输出：

```
<order>
  <item>
    <title>Best of python</title>
    <price currency="EUR">17.98</price>
    <quantity>3</quantity>
  </item>
  <price>53.94</price>
</order> 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-07T00:15:27.430

我今天不止一次推荐这个，但试试[Beautiful Soup](http://www.crummy.com/software/BeautifulSoup/) (easy_install BeautifulSoup)。

```
from BeautifulSoup import BeautifulSoup

xml = """
<main>
    <object attr="name">content</object>
</main>
"""

soup = BeautifulSoup(xml)
# look in the main node for object's with attr=name, optionally look up attrs with regex
my_objects = soup.main.findAll("object", attrs={'attr':'name'})
for my_object in my_objects:
    # this will print a list of the contents of the tag
    print my_object.contents
    # if only text is inside the tag you can use this
    # print tag.string 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-07T01:21:22.757

David Mertz 的[gnosis.xml.objectify](http://www.xml.com/pub/a/2003/07/02/py-xml.html)似乎可以为您做到这一点。文档有点难找，但是有一些 IBM 文章，包括[这篇](http://web.archive.org/web/20090212170316/http://www.ibm.com/developerworks/xml/library/x-matters39.html)文章（[纯文本版本](https://gnosis.cx/publish/programming/xml_matters_39.txt)）。

```
from gnosis.xml import objectify

xml = "<root><nodes><node>node 1</node><node>node 2</node></nodes></root>"
root = objectify.make_instance(xml)

print root.nodes.node[0].PCDATA # node 1
print root.nodes.node[1].PCDATA # node 2 
```

但是，以这种方式从对象创建 xml 是另一回事。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-06T23:00:31.137

这个怎么样

[http://evanjones.ca/software/simplexmlparse.html](http://evanjones.ca/software/simplexmlparse.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-07T01:06:09.713

```
#@Stephen: 
#"can't hardcode the element names, so I need to collect them 
#at parse and use them somehow as the object names."

#I don't think thats possible. Instead you can do this. 
#this will help you getting any object with a required name.

import BeautifulSoup

class Coll(object):
    """A class which can hold your Foo clas objects 
    and retrieve them easily when you want
    abstracting the storage and retrieval logic
    """
    def __init__(self):
        self.foos={}        

    def add(self, fooobj):
        self.foos[fooobj.name]=fooobj

    def get(self, name):
        return self.foos[name]

class Foo(object):
    """The required class
    """
    def __init__(self, name, attr1=None, attr2=None):
        self.name=name
        self.attr1=attr1
        self.attr2=attr2

s="""<main>
         <object name="somename">
             <attr name="attr1">value1</attr>
             <attr name="attr2">value2</attr>
         </object>
         <object name="someothername">
             <attr name="attr1">value3</attr>
             <attr name="attr2">value4</attr>
         </object>
     </main>
""" 
```

#

```
soup=BeautifulSoup.BeautifulSoup(s)

bars=Coll()
for each in soup.findAll('object'):
    bar=Foo(each['name'])
    attrs=each.findAll('attr')
    for attr in attrs:
        setattr(bar, attr['name'], attr.renderContents())
    bars.add(bar)

#retrieve objects by name
print bars.get('somename').__dict__

print '\n\n', bars.get('someothername').__dict__ 
```

输出

```
{'attr2': 'value2', 'name': u'somename', 'attr1': 'value1'}

{'attr2': 'value4', 'name': u'someothername', 'attr1': 'value3'} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-07T00:09:03.213

python 有三种常见的 XML 解析器：xml.dom.minidom、elementree 和 BeautifulSoup。

IMO，BeautifulSoup 是迄今为止最好的。

[http://www.crummy.com/software/BeautifulSoup/](http://www.crummy.com/software/BeautifulSoup/)

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-01-06T23:18:48.167

如果在谷歌上搜索代码生成器不起作用，您可以编写自己的代码生成器，使用 XML 作为输入并以您选择的语言输出对象。

这并不是很困难，但是解析 XML、生成代码、编译/执行脚本这三个步骤的过程确实使调试变得更加困难。

# html - 带有静态 HTML 的通用页眉/页脚

> ID：418503
> 
> 赞同：83
> 
> 时间：2009-01-06T22:50:14.900
> 
> 标签：html

静态 HTML/XHTML 是否有一种不错的方法来创建要显示在网站每个页面上的通用页眉/页脚文件？我知道您显然可以使用 PHP 或服务器端指令来做到这一点，但是有没有什么方法可以做到这一点，并且完全不依赖服务器为您将所有东西拼接在一起？

编辑：所有非常好的答案，是我所期望的。HTML是静态的，句号。如果没有运行服务器端或客户端的东西，就没有真正的方法来改变它。我发现服务器端包含似乎是我最好的选择，因为它们非常简单并且不需要脚本。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-01-06T23:16:15.147

有三种方法可以做你想做的事

## 服务器脚本

这包括像 php、asp、jsp 之类的东西……但你拒绝了

## 服务器端包括

您的服务器正在提供页面，那么为什么不利用内置的[服务器端包含](http://en.wikipedia.org/wiki/Server_Side_Includes)呢？每个服务器都有自己的方法来做到这一点，利用它。

## 客户端包括

此解决方案让您在页面已加载到客户端后回调服务器。

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2013-12-18T08:51:22.087

jQuery load() 函数可用于包含常见的页眉和页脚。代码应该像

```
<script>
    $("#header").load("header.html");
    $("#footer").load("footer.html");
</script> 
```

[你可以在这里](http://phpsmashcode.com/tips-and-tricks/include-common-files-in-html)找到演示

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2009-01-06T23:09:17.547

由于 HTML 没有“包含”指令，我只能想到三种解决方法

1.  框架
2.  Javascript
3.  CSS

对每种方法的一点评论。

框架可以是标准框架或 iFrame。无论哪种方式，您都必须为它们指定一个固定的高度，因此这可能不是您正在寻找的解决方案。

Javascript 是一个相当广泛的主题，并且可能存在许多如何使用它来达到预期效果的方法。在我的脑海中，但是我可以想到两种方法：

1.  成熟的 AJAX 请求，它请求页眉/页脚，然后将它们放在页面的正确位置；
2.  `<script type="text/javascript" src="header.js">`其中有这样的东西：`document.write('My header goes here');`

通过 CSS 来做这件事真的是一种滥用。CSS 具有[`content`](http://www.w3.org/TR/CSS21/generate.html#content)允许您插入一些 HTML 内容的属性，尽管它并不是真的打算这样使用。此外，我不确定浏览器是否支持此构造。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-01-06T23:01:26.877

你可以用javascript来做，我不认为它需要那么花哨。

如果你有一个 header.js 文件和一个 footer.js。

那么 header.js 的内容可能类似于

```
document.write("<div class='header'>header content</div> etc...") 
```

请记住在您正在编写的字符串中[转义任何嵌套的引号字符](http://jennifermadden.com/javascript/escapeCharacter.html)。然后你可以从你的静态模板中调用它

```
<script type="text/javascript" src="header.js"></script> 
```

同样对于footer.js。

注意：我不推荐这个解决方案——它是一个 hack 并且有许多缺点（对于 SEO 来说很差，而且对于初学者来说可用性很差）——但它确实满足了提问者的要求。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2018-12-07T19:01:20.330

最简单的方法是使用纯 HTML。

您可以使用以下方法之一：

```
<embed type="text/html" src="header.html"> 
```

或者：

```
<object name="foo" type="text/html" data="header.html"></object> 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2013-04-19T22:34:43.937

最好的解决方案是使用具有模板/包含支持的静态站点生成器。我在 Mac 上使用 Hammer，它很棒。还有 Guard，一个 ruby​​ gem，它监视文件更改、编译 sass、连接任何文件并且可能包含。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2014-07-30T17:41:16.100

您可以使用 jquery 轻松完成此操作。如此简单的任务不需要 php。只需在您的网页中包含一次。

```
$(function(){
    $("[data-load]").each(function(){
        $(this).load($(this).data("load"), function(){
        });
    });
}) 
```

现在在任何元素上使用数据加载从外部 html 文件中调用其内容，您只需在 html 代码中添加要放置内容的行。

例子

```
<nav data-load="sidepanel.html"></nav>
<nav data-load="footer.html"></nav> 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-01-07T08:09:28.533

最实用的方法是使用**Server Side Include**。当您拥有多个页面时，它非常容易实现并节省大量工作。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-01-06T22:53:17.343

HTML 框架，但它不是一个理想的解决方案。您实际上将一次访问 3 个单独的 HTML 页面。

我认为您的另一个选择是使用 AJAX。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2016-07-06T12:34:49.530

您可以使用任务运行器，例如 gulp 或 grunt。

有一个 NPM gulp 包可以即时执行文件包含并将结果编译为输出 HTML 文件。您甚至可以将值传递给您的部分。

[https://www.npmjs.com/package/gulp-file-include](https://www.npmjs.com/package/gulp-file-include)

```
<!DOCTYPE html>
<html>
  <body>
  @@include('./header.html')
  @@include('./main.html')
  </body>
</html> 
```

吞咽任务的示例：

```
var fileinclude = require('gulp-file-include'),
    gulp = require('gulp');

    gulp.task('html', function() {
        return gulp.src(['./src/html/views/*.html'])
            .pipe(fileInclude({
                prefix: '@@',
                basepath: 'src/html'
            }))
            .pipe(gulp.dest('./build'));
    }); 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2019-05-19T13:59:01.187

您可以尝试通过客户端加载它们，如下所示：

```
<!DOCTYPE html>
<html>
  <head>
    <!-- ... -->
  </head>
  <body>

    <div id="headerID"> <!-- your header --> </div>
    <div id="pageID"> <!-- your header --> </div>
    <div id="footerID"> <!-- your header --> </div>

    <script>
      $("#headerID").load("header.html");
      $("#pageID").load("page.html");
      $("#footerID").load("footer.html");
    </script>
  </body>
</html> 
```

**注意：**内容将从上到下加载并替换您加载到的容器的内容。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-01-06T22:52:57.347

不会。静态 HTML 文件不会更改。您可能会使用一些花哨的 Javascript AJAXy 解决方案来做到这一点，但这会很糟糕。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-01-06T22:53:42.710

现在每种脚本语言中都存在数百种本地模板系统，甚至没有使用您自制的带有`sed`or`m4`并将结果发送到您的服务器的本地模板系统，不，您至少需要 SSI。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-01-06T23:15:59.937

仅使用静态 HTML 包含另一个文件的唯一方法是 iframe。我不会认为它是页眉和页脚的一个很好的解决方案。如果您的服务器由于某种奇怪的原因不支持 PHP 或 SSI，您可以使用 PHP 并在上传之前在本地对其进行预处理。我认为这是比 iframe 更好的解决方案。

# sharepoint - SharePoint 2007 批准工作流 - 任何其他人都可以批准要求

> ID：418504
> 
> 赞同：0
> 
> 时间：2009-01-06T22:50:18.630
> 
> 标签：sharepoint, sharepoint-2007

如何使用 SharePoint 的内容批准来强制执行组中任何两个人都可以进行更改的规则？

我们有一个政策库，任何两个人都可以更新（修改者和批准者）。如果我做一个组并行审批，修改器可以审批自己的工作（我相信）。

不幸的是，我无法访问 Visual Studio 甚至 SharePoint Designer（因为这些已被公司禁用）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-11T09:23:21.690

这是直截了当的

将两个用户添加到审批者组，将工作流任务分配给审批者组。小组中的任何人都可以批准工作流以启动其下一阶段

# html - 是否可以阅读大型网页的最后几行（或 1000 个字符）？

> ID：418521
> 
> 赞同：8
> 
> 时间：2009-01-06T22:54:28.200
> 
> 标签：html, language-agnostic

我们需要每 5 分钟轮询一次网页，并且网页变得相当大。该网页是一个目录列表，我们需要最后一行（获取文件名）。获得最后一行的最佳方法是什么？

（如果这是一个本地文件，我可以相对于文件末尾稍微定位并读取）。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-06T23:07:44.243

HTTP 1.1 确实支持一组标头以仅请求特定范围的字节，包括仅支持文件的最后 n 个字节（使用“后缀”格式）。见[这里](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.35)。例如，

```
Range: bytes=-1000 
```

最后 1000 个字节。（当然，假设服务器支持 Range 标头。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-06T22:58:31.420

HTTP 确实支持分块响应，这意味着您可能会要求相同的页面，但要求使用不同的偏移量 IIRC。检查 HTTP [RFC](https://www.rfc-editor.org/rfc/rfc2616)。

编辑：检查 RFC-2616 后，它是 Range: HTTP 标头你想要的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-06T22:57:23.047

你有两个选择：

1.  使用分块编码。请参阅[http://msdn.microsoft.com/en-us/library/aa287673.aspx](http://msdn.microsoft.com/en-us/library/aa287673.aspx) 注意 Range 请求标头字段。您的服务器也必须支持它。

2.  使用 FTP 并使用您需要的偏移量对 ftp 命令执行“重新启动”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-06T23:02:23.537

以编程方式使用 FTP 和恢复？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-06T23:04:15.763

您可以使用 urllib2（内置）和 Beautiful Soup 3rd 方模块（easy_install BeautifulSoup）的组合在 python 中执行此操作。

无论如何，您都需要加载整个页面，因为数据会按顺序流式传输到您的本地计算机。但是，urllib2 可以轻松连接和检索页面，Beautiful Soup 会将原始 HTML 转换为易于导航的层次结构，您可以使用“点语法”进行遍历。

```
import urllib2
from BeautifulSoup import BeautifulSoup

page = urllib2.urlopen(url)
html = page.read()
soup = BeautifulSoup(html)
# assumes you're looking for a tag in the body with an id='last-line' attribute on it
tag = soup.html.body.find(id='last-line')
# this will print a list of the contents of the tag
print tag.contents
# if only text is inside the tag you can use this
print tag.string 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-06T23:15:13.493

如果您无法使分块编码和范围标头工作，那么我建议使用 CGI 脚本或任何您喜欢的方式来完成工作服务器端。仅仅为了检查整行而检索整个文件似乎很浪费！

如果您发布您正在使用的操作系统和 Web 服务器，我相信如果您遇到困难，这里有人会在几分钟内向您发布一个有效的 CGI 脚本。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2009-01-06T23:06:13.950

一个肮脏的技巧是在 Word 中打开它并记录一个宏来抓取最后一行（这可能涉及删除表格等）

以下 VBA 代码打开“堆栈溢出”的 google 定义结果并删除页眉和页脚，只留下结果列表：

```
Sub getWebpage()

Documents.Open FileName:="http://www.google.com/search?hl=en&safe=off&rls=com.microsoft%3A*&q=define%3A+stack+overflow"

With Selection
    .MoveDown Unit:=wdLine, Count:=8, Extend:=wdExtend
    .Delete Unit:=wdCharacter, Count:=1
    .MoveRight Unit:=wdCharacter, Count:=1
    .EndKey Unit:=wdStory
    .MoveUp Unit:=wdParagraph, Count:=5, Extend:=wdExtend
    .Delete Unit:=wdCharacter, Count:=1
End With

End Sub 
```

然后抓取结果并将其写在某处。

编辑：这太可怕了，我只是录制并稍作改动。

# asp.net - 如何找到连接失败的位置

> ID：418527
> 
> 赞同：0
> 
> 时间：2009-01-06T22:58:51.500
> 
> 标签：asp.net, networking

我有一个运行基本 ASP.NET 应用程序的网站，该应用程序主要在一个位置使用，即我客户的办公室。服务器位于高级数据中心。

每当我在他们办公室外测试或使用我的应用程序时，我一直保持良好的连接，但从他们的办公室来看，连接似乎不一致。有时请求似乎并没有从浏览器到达服务器。我不熟悉办公室的网络硬件，但他们确实有 T1 连接，应该始终打开。

我试过 ping 和 tracert，一切看起来都很正常。在请求失败期间运行 Firebug 时，请求会显示在日志中，然后就坐在那里而不显示它正在发送任何数据，最终它会超时。

我的问题是，我可以使用哪些工具来诊断此连接问题并开始将其缩小到特定原因以便我可以修复它？这是一个间歇性问题，因此如果有任何可用的工具，那么长时间运行的工具可能会更有意义。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-06T23:05:33.233

您所有的标准 ping 和 traceroute 工具可能是您最好的选择。我不明白，但该网站位于哪里？

如果您打开命令提示符，运行**ping -t aspwebsiteurl.domain** <- 将显示是否有丢包。再次从命令提示符中，**tracert aspwebsiteurl.domain** <- 将显示数据包获取站点的路径。也可以告诉你是否有一个特定的跳跃让你打嗝。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-13T00:02:24.200

办公室和数据中心之间是否存在可能导致问题的代理？

您也可以尝试使用[Wireshark](http://www.wireshark.org/)来尝试更详细地调试问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-13T00:12:27.987

[速度测试 - Internet 网络连接速度](http://compnetworking.about.com/od/speedtests/Speed_Test_Internet_Network_Connection_Speed.htm)对于一些链接可能会有所帮助，以便在客户办公室测试连接以查看它的工作情况。

另一个问题是客户端和数据中心有多远？如果一个在纽约，另一个在洛杉矶，那么距离可能是一个因素。另外，您是否检查过任何可能的 DNS 问题？

# iphone - iPhone应用程序中的多个音频声音？

> ID：418529
> 
> 赞同：3
> 
> 时间：2009-01-06T22:59:13.790
> 
> 标签：iphone

我已经开始在 iPhone 应用程序中播放单个声音，但我现在希望基于一个按钮播放多个声音。为每个音频声音创建一组单独的 .m 和 .h 文件，然后将它们全部包含在内，在编码方面似乎不是解决这个问题的最有效方法......再说一次，我才刚刚开始使用 Cocoa 并且刚刚完成了我的第一个应用程序。

任何帮助表示赞赏。这里的关键是多个声音，每个声音都由自己的按钮或图像触发。谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-07T00:29:53.280

如果文件是 MP3 或 AAC 格式，则一次只能播放一个。这是 iPhone 上核心音频的限制。

就一次播放多个声音而言，这很容易，只需为您想要播放的每个声音创建一个新的播放器实例（并记住在完成后释放它们）

```
NSString *path = [[NSBundle mainBundle] pathForResource:@"dream" ofType:@"m4a"];  
AVAudioPlayer* theAudio=[[AVAudioPlayer alloc] initWithContentsOfURL:[NSURL fileURLWithPath:path] error:NULL];  
theAudio.delegate = self;  
[theAudio play]; 
```

要将 MP3 转换为 IMA4 之类的东西（您可以一次播放多个），您将运行以下命令（在终端中，在豹中）：

```
/usr/bin/afconvert -f caff -d ima4 sound.mp3 sound.caf 
```

上面的代码仅适用于固件 2.2，但如果您想支持较旧的固件，您可以对 AudioQueue 文件执行相同的操作（它只是要复杂得多，所以我没有在这里列出代码）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-07T00:08:47.363

如果您可以访问 iPhone 开发者网络，那么[这里有一堆代码示例向您展示如何播放音频](http://developer.apple.com/iphone/library/codinghowtos/AudioAndVideo/index.html)。

您需要做的就是创建一个具有名为的函数的类

```
-(void)Play:(NSString*)sSoundFile {
    // play sound file here
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-06T23:34:59.490

我对 iPhone 开发没有任何直接经验，但理论上你能创建一个包含所有声音的大型声音文件吗？每个声音可以被足够的静音分开，以便通过时间索引单独访问。当然，缺点是您必须将整个文件加载到内存中，除非您能找到一种以随机访问方式加载块的方法......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-06T20:21:58.597

@rustyshelf - 这在模拟器中有效吗？我正在使用该代码，并使用#import，但 audioPlayerDidFinishPlaying 和 audioPlayerDecodeErrorDidOccur 都没有被调用。尝试调试非常烦人。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-01-12T05:22:17.223

[http://www.icodeblog.com/2009/05/04/iphone-game-programming-tutorial-part-4-basic-game-audio/](http://www.icodeblog.com/2009/05/04/iphone-game-programming-tutorial-part-4-basic-game-audio/)

在 ios5 的这个例子中，你必须把 CFURLRef soundurl=(__bridge CFURLRef)[NSURL fileURLWithPath:objstring];

代替

CFURLRef soundurl=(CFURLRef)[NSURL fileURLWithPath:objstring];

哈迪克·曼托拉

# iphone - UIPickerView 添加到 uitableviewcontroller.view 不会旋转

> ID：418535
> 
> 赞同：3
> 
> 时间：2009-01-06T23:00:34.817
> 
> 标签：iphone, cocoa-touch

我在 UITableViewController 中有一个 UIPickerView 作为子视图，我想在单击某一行时将其向上滑动。我已经实现了必要的 dataSource 和委托方法，但是pickerview 的行为很奇怪。它就像被机械卡住一样，无法正常旋转，只是移动了一点。如果我尝试旋转它几次，我会在调试器控制台中收到此消息：

> SendDelegateMessage：委托等待 10 秒后返回失败。主运行循环模式：UITrackingRunLoopMode 如果您在整个时间间隔内都没有使用触摸屏（这会延长等待时间），请提交错误。

我用谷歌搜索了这个，无济于事。无论如何，这是相关的代码。正如您可能猜到的，这是一个数字选择器（用于选择百分比值）。

```
- (void)viewDidLoad {
     [super viewDidLoad];
     percentPicker  = [[UIPickerViewalloc] initWithFrame:CGRectMake(0,420, 320, 200)];
     percentPicker.delegate = self;
     percentPicker.dataSource = self;
     percentPicker.showsSelectionIndicator = YES;
     [self.view addSubview:percentPicker];
 }

- (void)viewWillAppear:(BOOL)animated {
     // sets the rows to the appropriate value
     // etc
}

- (void)startEditingPercentage {
     [UIView beginAnimations :nilcontext:NULL];
     [UIView setAnimationBeginsFromCurrentState:YES];
     [UIViewsetAnimationDuration:kPickerAnimationDuration ];
     percentPicker.transform = CGAffineTransformTranslate(CGAffineTransformIdentity, 0, -220.0);
     [UIViewcommitAnimations];
 }

- (void)stopEditingPercentage {
    NSLog(@"stopEditingPercentage");
    [UIView beginAnimations :nilcontext:NULL];
    [UIViewsetAnimationBeginsFromCurrentState:YES];
    [UIViewsetAnimationDuration:kPickerAnimationDuration];
    percentPicker.transform = CGAffineTransformIdentity;
    [UIView commitAnimations];
}

#pragma mark UIPickerView delegate and dataSource methods

- (NSInteger)numberOfComponentsInPickerView:(UIPickerView *)pickerView {
    return4;
}

- (NSInteger)pickerView:(UIPickerView *)pickerView numberOfRowsInComponent:(NSInteger)component {
    return10;
}

- (CGFloat)pickerView:(UIPickerView *)pickerView widthForComponent:(NSInteger)component { 
    return44;
}

- (UIView *)pickerView:(UIPickerView *)pickerView viewForRow:(NSInteger)row forComponent:(NSInteger)component reusingView:(UIView *)view {
    UILabel *retval = (UILabel *)view;
    if (!retval) {
        retval= [[UILabel newLabelWithPrimaryColor :[UIColorblackColor ] selectedColor:[ UIColor blackColor] fontSize:22bold:YEStransparent:YES] autorelease];
    }
    retval.frame = CGRectMake(0, 0, 44, 44);
    retval.textAlignment = UITextAlignmentCenter;
    retval.backgroundColor = [UIColor clearColor];
    retval.text = [NSStringstringWithFormat:@"%i", row];
    if (component > 1 ) {
        // rows 2 and 3 are decimal, white on black
        retval.backgroundColor = [UIColor blackColor];
        retval.textColor = [UIColor whiteColor];
    }
    return retval;
}

- (void)pickerView:(UIPickerView *)pickerView didSelectRow:(NSInteger)row inComponent:(NSInteger)component {
    NSString *selectedValue;
    selectedValue= [NSString stringWithFormat:@"%i%i.%i%i" ,[percentPickerselectedRowInComponent :0], [ percentPickerselectedRowInComponent: 1], [percentPickerselectedRowInComponent:2], [percentPickerselectedRowInComponent:3]];
    NSNumberFormatter *formatter = [[NSNumberFormatter alloc] init];
    NSString *trimmedValue = [[formatter numberFromString:selectedValue] stringValue];
    percentValue.text = trimmedValue;
    [formatter release];
} 
```

如您所见，我使用 transform 属性将选取器移入和移出（向下）我的主视图；startEditing 和 stopEditing 方法由 teble 视图中的选择触发。然而，出于调试目的，我消除了这些转换，并将选择器留在了桌面上，但没有任何改变。我还评论了 didSelect 方法，但这也没有改变任何东西。顺便说一句，相同的选择器视图构造代码 vorkw 可以在同一应用程序的另一个视图中使用。有什么建议吗？干杯，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T11:57:06.217

您并没有真正使用 viewDidLoad 中的代码将选择器添加到 UITableView。UITableView 只能在 UITableViewCells 中有控件/行，这些在 cellForRowAtIndex 方法中指定。我们不能像添加 UIView 那样向 UITableView 添加控件。

尝试使用 UIView 的子类，并将 UITableView 和选择器添加到此 UIView 子类。

如果您只想使用 UITableViewController 子类，请创建一个自定义单元格并将选择器添加到此自定义单元格中。但是，如果您静态添加它，您将无法隐藏/取消隐藏此单元格。然后你必须使用 reloadData。我建议使用 UIView 子类。

# asp.net - 有没有人尝试为 Amazon SimpleDB 构建 ASP.NET 会话状态提供程序？

> ID：418538
> 
> 赞同：3
> 
> 时间：2009-01-06T23:01:23.210
> 
> 标签：asp.net, amazon-web-services, session-state, amazon-simpledb

如果没有，该服务是否存在任何阻止构建服务的基本限制？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-01T08:18:01.277

回应 Garys 的回答。“如果你在 EC2 上托管你的应用程序，那就没问题了”

即使您将应用程序托管在 EC2 上，也不应该真正使用 SimpleDB 来存储会话状态。它提供了“最终一致”的保证，因此如果您 PUT 某些内容，则无法保证您会在下一次 GET 中看到该项目。

请参阅：[http ://docs.amazonwebservices.com/AmazonSimpleDB/2007-11-07/DeveloperGuide/index.html?EventualConsistencySummary.html](http://docs.amazonwebservices.com/AmazonSimpleDB/2007-11-07/DeveloperGuide/index.html?EventualConsistencySummary.html)

当您想使用 simpledb 对不需要立即更新并且可以稍后协调的数据进行索引时，这很好，但在会话状态的情况下，您可能需要具有 ACID 保证的东西（如 SQL服务器），因为您想知道，一旦您提交了某些内容，您将在下一次阅读时将其取回。

这显然取决于您的要求，但大多数人使用会话状态来存储购物车物品或类似物品。如果他们的购物车中似乎缺少东西，您的网站访问者很快就会感到不安，然后重新添加它们，然后发现他们在付款时已经添加了两次相同的物品。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-07T02:39:39.180

有一个用于使用 SDB的[C# 库。](http://developer.amazonwebservices.com/connect/entry.jspa?externalID=1133)

如果您想自行开发，可以在[http://aws.amazon.com/simpledb/#resources](http://aws.amazon.com/simpledb/#resources)找到 API、WSDL 和其他文档。

这是一个基于 HTTP 的非常简单的 API。最难的部分是编写签名代码。其他语言有很多实现。

至于将其用于会话状态，使用 EC2 中的 SimpleDB 和 Internet 上的任何其他位置之间存在巨大的速度差异。如果您在 EC2 上托管您的应用程序，那会很好，否则，它会非常缓慢。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-26T20:26:09.290

您可以基于此 MySQL 提供程序：

[http://harry-kimpel.spaces.live.com/Blog/cns!CAA619CB4C4D1B6C!342.entry](http://harry-kimpel.spaces.live.com/Blog/cns!CAA619CB4C4D1B6C!342.entry)

# c++ - 一个随机数生成器，可以在一秒内得到不同的数字

> ID：418545
> 
> 赞同：1
> 
> 时间：2009-01-06T23:03:02.130
> 
> 标签：c++, random

我需要一个 C++（伪，我不在乎）随机数生成器，每次调用该函数时都能得到不同的数字。这可能只是我播种的方式，也许有更好的方法，但是我拥有的每个随机生成器每次调用时都不会生成一个新数字。我有时需要每秒获得几个随机数，而我插入的任何 RNG 往往会连续多次获得相同的数字。当然，我知道为什么，因为它是按秒播种的，所以它每秒只会生成一个新号码，但我需要以某种方式在每次通话时获取一个新号码。谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-01-06T23:05:46.227

听起来你这样做是这样的：

```
int get_rand() {
    srand(time(0));
    return rand();
} 
```

这可以解释为什么你在一秒钟内得到相同的数字。但是你必须这样做：

```
int get_rand() {
    return rand();
} 
```

并在程序启动时调用 srand*一次。*

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-06T23:05:43.980

您只需要在`srand()`启动时为生成器播种一次，之后只需调用该`rand()`函数。如果您使用相同的种子为生成器播种两次，则每次都将获得相同的值。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-06T23:05:59.707

您应该只播种**一次**PRNG 。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-06T23:25:52.287

[Boost.Random](http://www.boost.org/doc/libs/1_37_0/libs/random/index.html)有各种非常好的随机数生成器。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-06T23:18:42.333

如果要生成大量随机数，可以尝试 XORShift 生成器。对于长（8 位）：

```
// initial setup
unsigned long x = ... init from time etc ...
// each time we want a random number in 'x':
x ^= x << 21;
x ^= x >> 35;
x ^= x << 4; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-12-20T18:59:58.227

此代码仅生成一次唯一的随机数。

```
#include <ctime>
# include <iostream>
using namespace std;

int main()
{

      int size=100;
      int random_once[100];
      srand(time(0));

      for (int i=0;i<size;i++)  // generate unique random number only once
      {
          random_once[i]=rand() % size;
          for(int j=0;j<i;j++) if (random_once[j]==random_once[i]) i--;   
      }

      for ( i=0;i<size;i++) cout<<" "<<random_once[i]<<"\t";

  return 0; 
```

# silverlight - 为 Silverlight 寻找“半专业”项目，建议？

> ID：418574
> 
> 赞同：0
> 
> 时间：2009-01-06T23:14:30.813
> 
> 标签：silverlight

我想在 Silverlight 中沾沾自喜。我认为世界上所有的阅读和教程都没有真正的项目那么好用。此外，我还完成了教程、阅读了一些书籍、听了播客等等。我已经准备好进行下一步了。我不确定如何迈出这一步。我当然还没有准备好将“Silverlight 开发”放在简历上。一些选项：

*   假设我的部分补偿是经验
*   克雷格列表
*   找一个需要程序员的设计师——我已经问过我所有的设计师朋友了；）

理想情况下，我想找到一个非营利组织，如果我觉得自己在学习时能提供帮助，那就太酷了。但这似乎遥遥无期。我真的希望它成为一个面向公众的网站，这样我就可以将它用作一个投资组合。我愿意免费工作，或者按比例收费。我不是设计师，所以我需要那个部门的帮助。我在这方面有一些经验，但那是很久以前的事了，我不会自欺欺人地相信我的技能。

我在 ASP.NET、Winforms 和 C# 方面有大约 4 年的经验。

寻找这个神秘项目的建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-08T21:40:04.793

不乏愿意有人为他们构建软件的非营利组织，他们不在乎它是什么技术（这或多或少是任何客户的情绪）。我找到了一家有技术需求的非盈利组织，我正在使用 ASP.NET MVC 和 Silverlight 来满足这一需求，尽管无可否认，由于空闲时间非常宝贵，但它的进展速度几乎没有“付费”项目那么快。所以，我的建议是找到一个你相信其使命的非营利组织，然后给他们发一封电子邮件。我怀疑他们会拒绝你。

或者，帮帮我！:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T23:30:14.650

我在 Silverlight 的第一个未完成的项目于 2007 年 11 月开始。我正在设计一个美国的民意调查地图，用户可以在其中查看实时投票计数，将鼠标悬停在一个州上并获得详细的细分。类似于约翰金的魔法地图。

当时我刚出生的双胞胎三个月大，所以我没有机会完成它，但这是一次很棒的经历。Silverlight 非常适合非常直观的应用程序。还有一些想法：

1.  任何地理的东西，比如投票的东西。有一个免费的 XAML 美国地图可用，谷歌“XAML 美国地图”。
2.  图形、图表等。有一些第三方控件可用于此，或者您可以尝试自己滚动。
3.  拖放式界面可以真正使用 Silverlight。
4.  游戏！（我个人最喜欢的）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-06T23:35:22.797

这里有一些想法：

*   在与电子商务后端系统集成的 Silverlight 中制作易于换肤的购物车
*   我会尝试以贡献者的身份加入现有的 Silverlight 开源项目，例如CodePlex 上的[Silverlight Ribbon](http://www.codeplex.com/silverlightribbon)项目。

# design-by-contract - 合同设计中的编译时间检查？

> ID：418588
> 
> 赞同：3
> 
> 时间：2009-01-06T23:19:19.150
> 
> 标签：design-by-contract

我读到编译器可以在编译时强制执行 dbc .. 它是如何做到的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-07T02:52:35.630

据我所知，迄今为止最强大的静态 DbC 语言是[Microsoft Research 的 Spec#](http://Research.Microsoft.Com/SpecSharp/)。它使用名为[Boogie的强大静态分析工具，该工具又使用名为](http://Research.Microsoft.Com/Boogie/)[Z3](http://Research.Microsoft.Com/projects/z3/)的强大定理证明器/约束求解器来证明设计时合同的履行或违反。

If the Theorem Prover can prove that a contract will *always* be violated, that's a compile error. If the Theorem Prover can prove that a contract will *never* be violated, that's an optimization: the contract checks are removed from the final DLL.

As Charlie Martin points out, proving contracts in general is equivalent to solving the Halting Problem and thus not possible. So, there will be a lot of cases, where the Theorem Prover can neither prove nor disprove the contract. In that case, a runtime check is emitted, just like in other, less powerful contract systems.

请注意，不再开发 Spec#。合约引擎已被提取到一个名为[Code Contracts for .NET](http://Research.Microsoft.Com/Contracts/)的库中，它将成为 .NET 4.0 / Visual Studio 2010 的一部分。但是，合约将不提供语言支持。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T23:29:00.347

编译器可以使用[静态分析](http://en.wikipedia.org/wiki/Static_code_analysis)来查看您的程序并确定它是否正确。作为一个简单的示例，以下代码可能会尝试对负数 (C++) 求平方根：

```
double x;
cin >> x;
cout << sqrt(x) << endl; 
```

如果编译器知道不`sqrt`应该用负数调用它，它可能会将其标记为问题，因为它知道从用户输入读取*可能会*返回负数。另一方面，如果你这样做：

```
double x;
cin >> x;
if (x >= 0) {
    cout << sqrt(x) << endl;
} else {
    cout << "Can't take square root of negative number" << endl;
} 
```

然后编译器可以告诉这个代码永远不会`sqrt`用负数调用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-06T23:38:01.933

契约式设计是一个非常抽象的术语，因为可以有许多具有不同表达能力的规范形式。此外，目前静态分析检查和执行规范的能力受到限制。它是计算机科学中最活跃的学术和工业研究领域之一。

在实践中，您可能会使用合同和检查的某些子集，这取决于您使用的语言以及您安装的插件或程序。

一般来说，静态分析试图建立合同模型和实际程序模型，并进行比较。例如，如果合约不允许您在对象处于状态 S 时调用函数，它将尝试确定在任何调用序列中您是否可能最终处于状态 S。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-06T23:27:01.100

哪个编译器和什么语言？埃菲尔可以在一定程度上做到这一点。但是请记住，完全执行按合同设计意味着能够解决停机问题（证明：假设您有一个可以做到这一点的编译器。然后编译器必须能够识别具有真正退出条件的任意函数由于无限循环或无限递归而无法达到退出条件。因此它减少到停止。）

这通常意味着如果你有电话

```
 foo(a); 
```

在其他地方定义

```
 function foo(a:int) is
     assert 0 < a && a < 128
     ...
  end 
```

然后编译器可以检查 a 实际上是否在开区间 (0..128) 中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T00:41:46.940

[像D](http://www.digitalmars.com/d/)这样的一些语言具有相当强大的编译时常量折叠和编译时条件检查（对于 D `static assert(boolCond, msg);`，IIRC C/C++ 可以使用`#if`and `pragma`or `#error`）

# gtk - 信号从 gtkmm 弹出列表中触发两次

> ID：418591
> 
> 赞同：0
> 
> 时间：2009-01-06T23:21:17.630
> 
> 标签：gtk, signals, gtkmm

自从我使用 GTK+ 以来已经有一段时间了，最​​后一次是在 C 中，而不是像现在这样使用 gtkmm 和 C++。无论如何，我有一个我认为应该很容易解决的问题：

我有一个由单选按钮列表组成的弹出菜单，当我单击其中一个时，我希望执行一些操作。代码如下：

```
 Gtk::RadioMenuItem::Group group;
    for ( size_t i = 1; i < LH_MAX; ++i )
    {
        Gtk::RadioMenuItem* pItem = new Gtk::RadioMenuItem( group, names[i], names[i] );
        pItem->set_name( names[i] );
        pItem->signal_activate().connect( sigc::mem_fun(*this, &MyClass::on_item_activated) );
        pItem->show();
        m_Menu.append( *Gtk::manage(pItem) );
    } 
```

我看到的唯一问题是，`MyClass::on_item_activated`当从菜单中选择以前未选择的单选按钮时，它会被调用两次。单击已选择的单选按钮时仅调用一次。

我猜第一次触发是说“不再激活某些东西”，第二次触发是为了激活新的单选按钮。不管我是对是错，问题都是一样的：我怎样才能让我的处理程序每​​次点击只采取一次行动？要么我需要只调用一次处理程序，要么我需要从它内部检查一些东西以了解回调是否是“重复的”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-13T10:52:49.800

您可以使用 sigc::bind 将项目作为参数提供给回调函数。

```
pItem->signal_activate().sigc::bind(sigc::mem_fun(*this,&MyClass::on_item_activated),pItem)); 
```

然后您可以在回调中使用 item->get_active() 来仅响应激活。

```
 void MyClass::on_item_activated(Gtk::RadioMenuItem* item) {
        if (item->get_active()) {
               // Do some stuff
        }
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T21:52:19.560

这也是我所做的，连接`signal_toggled()`并检查是否`get_active()`为真。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-10T04:15:44.657

我不确切知道您要完成什么（或 MyClass 是什么以及它继承自什么基类），但连接到`signal_toggled()`可能比`signal_activate()`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-13T11:02:59.763

/同意约翰内斯。接收信号时检查项目是否被激活。

# c# - 如何在 ASP.NET 中加载页面时增加要处理的步长值？

> ID：418596
> 
> 赞同：1
> 
> 时间：2009-01-06T23:22:49.000
> 
> 标签：c#, asp.net, postback

如何在页面加载时增加要处理的步长值？例如，在下面的代码中，由于 ASP.NET 页面生命周期，viewstate 变量直到 Page_Load 之后才会递增。

```
protected void Page_Load(object sender, EventArgs e)
{
    switch ((int)ViewState["step"])
    {
        //do something different for each step
    }
}

protected void btnIncrementStep_Click(object sender, EventArgs e)
{
    //when the button is clicked, this does not fire 
    //until after page_load finishes
    ViewState["step"] = (int)ViewState["step"] + 1;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-06T23:34:35.840

没有办法解决这个问题。Page_Load 事件总是在任何控制事件被触发之前发生。如果您需要在控制事件之后执行某些操作，请使用 Page_PreRender。

[ASP.Net 页面生命周期图像](http://codebetter.com/blogs//images/codebetter_com/raymond.lewallen/89/o_aspNet_Page_LifeCycle.jpg)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-06T23:45:08.457

只需将 switch 语句移动到稍后发生的事件中。例如 LoadComplete() 或 PreRender()。PreRender 可能有点晚了，这取决于你想要做什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-06T23:34:45.687

[在LoadComplete](http://msdn.microsoft.com/en-us/library/ms178472.aspx)事件期间或什至在 OnLoad 期间递增。

您拥有决定是否从表单数据中增加所需的所有信息。您无需等待 onClick() 事件。检查表单以查看是否会单击该项目。

查看 request.params("__EVENTARGS")

这标识了导致回发的控件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-06T23:52:40.580

如果您需要在 Page_Load 期间增加并检查该值，则可以选择将值存储在会话中而不是 ViewState 中，例如：

```
private int Step
{
  get { return (int)Session["step"]; }
  set { Session["step"] = value; }
}

protected void Page_Load(object sender, EventArgs e)
{
    if (!IsPostBack)
       Step = 0; // init
    else
       Step ++; // increment

    switch (Step)
    {
        //do something different for each step
    }
} 
```

# transactions - 交易范围

> ID：418600
> 
> 赞同：1
> 
> 时间：2009-01-06T23:24:04.567
> 
> 标签：transactions, msdtc, system.transactions, transactionscope

事务范围如何工作？它如何知道何时已经使用了另一个上下文以及我如何在我的代码中实现另一种范围。

我主要是 vb.net 开发人员，但如果你写的话，我可以阅读 c#。

如果上述内容过于模糊：

我了解 system.transactions 的作用以及如何使用它。我想知道的是如何创建类似的东西，我自己的库，我可以包装一些可以以与 system.transactions 范围相同的方式处理它的代码。我计划将它与缓存模型一起使用，它将大大增强它。我正在寻找有关事务范围如何知道的详细信息，例如存在父范围，因此它可以附加到它等等，或者提交需要在更高级别或更高联系人中进行。

例如，如果我有以下

```
using scope1 as new system.transactions.scope
    using scope2 as new system.transactions.scope
        using scope3 as new system.transactions.scope
             scope3.commit
        end using
        scope2.commit
    end using
end using 
```

Scope1 不会提交，因此 scope2 或 scope3 也不会提交，因为它们的父级都是 scope1 的上下文。我希望能够使用我自己的库进行设置。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-07T02:01:23.097

我推荐 Juval Lowy 的文章[Introducing](http://www.idesign.net/idesign/DesktopDefault.aspx?tabindex=3&tabid=5) [System.Transactions](http://msdn.microsoft.com/en-us/library/ms973865.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T23:37:07.520

我会试一试，但我不是 100% 确定这个问题。

就数据库而言，事务往往具有范围。这表示事务中正在更改的数据量的覆盖范围。它们在数据库服务器中实现，不能“在代码中”更改。每个数据库服务器都有自己的实现，每个服务器（oracle、MSSQL、MySQL）都有自己的行为。

通常，事务将锁定任何其他连接，使其无法读取它正在修改的数据。事务的范围将开始尽可能小，然后随着被更改数据量的增长而扩大。锁定尽可能少的数据符合数据库的最大利益，它通过以下方式做到这一点：

*   锁定单行数据中的单列
*   然后锁定单行数据
*   然后锁定一页数据（也许是 8096 字节？）
*   然后锁定整个数据表

如果您的更新修改了多行数据，则事务范围将扩展为一个页面大小（为每个服务器自定义），或者锁定整个表。一些数据库服务器将允许其他连接在事务进行时像更新前一样读取表，而其他数据库服务器将阻止对数据的任何选择，直到事务提交。

基本上，交易是您无法修改服务器的实现方式，并且事务范围不是您应该过多担心的事情。只需确保仅围绕相互依赖的简洁更新使用事务。我通常不使用事务。但话又说回来，我没有使用银行账户或任何其他参考关键系统。

希望这可以帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-06T23:50:50.020

您的问题非常含糊，因此很难知道您实际上在问什么并寻求答案，但这也许会有所帮助？

[http://www.codeproject.com/KB/dotnet/TransactionScope20.aspx](http://www.codeproject.com/KB/dotnet/TransactionScope20.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-08T05:25:56.803

我认为我已经找到了重现作用域行为的解决方案。我将很快发布信息，但基本上它涉及使用静态值实现 idisposable 以跟踪对象的嵌套实例。为了将它连接到缓存提供程序，我计划使用缓存对象的数组列表，以便在对象被处理时运行某种清理。我认为我也知道如何处理线程问题，但我仍在处理后勤问题。完成后，我将发布代码，以便可以将其部署在速度之上，以应对我目前面临的一些挑战。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-08T05:51:33.130

我不知道 System.Transactions 如何在内部工作，但您可以使用线程本地内存来实现这一点。在 .NET 中，ThreadStatic 属性会给你这个。在这样的地方声明你的范围上下文：

```
[ThreadStatic]
private static Context scopeContextThingy; 
```

每个线程只有一个 scopeContextThingy 。那么如果`scopeContextThingy == null`，你是父母，应该创建一个新的上下文。否则，您就是一个嵌套范围。

# c# - 如何在 LINQ 中进行子查询？

> ID：418609
> 
> 赞同：78
> 
> 时间：2009-01-06T23:27:05.140
> 
> 标签：c#, linq, linq-to-sql

这是我尝试转换为 LINQ 的查询示例：

```
SELECT *
FROM Users
WHERE Users.lastname LIKE '%fra%'
    AND Users.Id IN (
         SELECT UserId 
         FROM CompanyRolesToUsers 
         WHERE CompanyRoleId in (2,3,4) ) 
```

`CompanyRolesToUsers`和之间存在 FK 关系`Users`，但它是多对多关系并且`CompanyRolesToUsers`是联结表。

我们已经构建了大部分站点，并且我们已经通过使用 PredicateExtensions 类构建表达式来完成大部分过滤工作。

简单过滤器的代码如下所示：

```
 if (!string.IsNullOrEmpty(TextBoxLastName.Text))
 {
     predicateAnd = predicateAnd.And(c => c.LastName.Contains(
                                     TextBoxLastName.Text.Trim()));
 }

e.Result = context.Users.Where(predicateAnd); 
```

我正在尝试为另一个表中的子选择添加谓词。( `CompanyRolesToUsers`)

我希望能够添加的是这样做的东西：

```
int[] selectedRoles = GetSelectedRoles();
if( selectedRoles.Length > 0 )
{
    //somehow only select the userid from here ???:
    var subquery = from u in CompanyRolesToUsers
                   where u.RoleID in selectedRoles
                   select u.UserId;

    //somehow transform this into an Expression ???:
    var subExpression = Expression.Invoke(subquery);

    //and add it on to the existing expressions ???:
    predicateAnd = predicateAnd.And(subExpression);
} 
```

有没有办法做到这一点？这很令人沮丧，因为我可以轻松地编写存储过程，但我对这个 LINQ 很陌生，而且我有一个截止日期。我还没有找到一个匹配的例子，但我确定它在某个地方。

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2009-01-07T14:51:05.010

这是给您的子查询！

```
List<int> IdsToFind = new List<int>() {2, 3, 4};

db.Users
.Where(u => SqlMethods.Like(u.LastName, "%fra%"))
.Where(u =>
    db.CompanyRolesToUsers
    .Where(crtu => IdsToFind.Contains(crtu.CompanyRoleId))
    .Select(crtu =>  crtu.UserId)
    .Contains(u.Id)
) 
```

* * *

关于这部分问题：

```
predicateAnd = predicateAnd.And(c => c.LastName.Contains(
                                TextBoxLastName.Text.Trim())); 
```

我强烈建议在编写查询之前从文本框中提取字符串。

```
string searchString = TextBoxLastName.Text.Trim();
predicateAnd = predicateAnd.And(c => c.LastName.Contains( searchString)); 
```

您希望对发送到数据库的内容保持良好的控制。在原始代码中，一种可能的解读是未修剪的字符串被发送到数据库中进行修剪——这对数据库来说并不是一件好事。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-01-06T23:46:17.940

该语句不需要子查询，最好写成

```
select u.* 
from Users u, CompanyRolesToUsers c
where u.Id = c.UserId        --join just specified here, perfectly fine
and u.lastname like '%fra%'
and c.CompanyRoleId in (2,3,4) 
```

或者

```
select u.* 
from Users u inner join CompanyRolesToUsers c
             on u.Id = c.UserId    --explicit "join" statement, no diff from above, just preference
where u.lastname like '%fra%'
  and c.CompanyRoleId in (2,3,4) 
```

话虽如此，在 LINQ 中它会是

```
from u in Users
from c in CompanyRolesToUsers 
where u.Id == c.UserId &&
      u.LastName.Contains("fra") &&
      selectedRoles.Contains(c.CompanyRoleId)
select u 
```

或者

```
from u in Users
join c in CompanyRolesToUsers 
       on u.Id equals c.UserId
where u.LastName.Contains("fra") &&
      selectedRoles.Contains(c.CompanyRoleId)
select u 
```

同样，这两种方式都可以代表这一点。在这两种情况下，我自己都更喜欢显式的“加入”语法，但它是......

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-06T23:35:26.447

这就是我在 LINQ 中做子查询的方式，我认为这应该得到你想要的。您可以将显式 CompanyRoleId == 2... 替换为您想要的不同角色的另一个子查询，也可以加入它。

```
from u in Users
join c in (
    from crt in CompanyRolesToUsers
    where CompanyRoleId == 2
    || CompanyRoleId == 3
    || CompanyRoleId == 4) on u.UserId equals c.UserId
where u.lastname.Contains("fra")
select u; 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-07T00:02:23.743

你可以为你的情况做这样的事情——（语法可能有点不对）。也看看这个[链接](http://msdn.microsoft.com/en-us/library/system.linq.expressions.aspx)

```
subQuery = (from crtu in CompanyRolesToUsers where crtu.RoleId==2 || crtu.RoleId==3 select crtu.UserId).ToArrayList();

finalQuery = from u in Users where u.LastName.Contains('fra')  && subQuery.Contains(u.Id) select u; 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-07T15:18:06.297

好的，这是一个获取正确记录的基本连接查询：

```
 int[] selectedRolesArr = GetSelectedRoles();
    if( selectedRolesArr != null && selectedRolesArr.Length > 0 ) 
    {

    //this join version requires the use of distinct to prevent muliple records
        //being returned for users with more than one company role.
    IQueryable retVal = (from u in context.Users
                        join c in context.CompanyRolesToUsers
                          on u.Id equals c.UserId
                        where u.LastName.Contains( "fra" ) &&
                            selectedRolesArr.Contains( c.CompanyRoleId )
                        select  u).Distinct();
} 
```

但这是最容易与我们已有的算法集成的代码：

```
int[] selectedRolesArr = GetSelectedRoles(); 
if ( useAnd ) 
       { 
          predicateAnd = predicateAnd.And( u => (from c in context.CompanyRolesToUsers 
                       where selectedRolesArr.Contains(c.CompanyRoleId) 
                       select c.UserId).Contains(u.Id)); 
        } 
        else 
        { 
           predicateOr = predicateOr.Or( u => (from c in context.CompanyRolesToUsers 
                          where selectedRolesArr.Contains(c.CompanyRoleId) 
                         select c.UserId).Contains(u.Id) ); 
        } 
```

这要感谢[LINQtoSQL 论坛上的一张海报](http://social.msdn.microsoft.com/Forums/en-US/linqtosql/thread/68e6a228-ffa4-4072-880b-8a9bdd681251/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-07T14:29:31.650

这是返回正确记录的 SQL 版本：

```
select distinct u.* 
from Users u, CompanyRolesToUsers c
where u.Id = c.UserId        --join just specified here, perfectly fine
and u.firstname like '%amy%'
and c.CompanyRoleId in (2,3,4) 
```

另外，请注意 (2,3,4) 是 Web 应用程序用户从复选框列表中选择的列表，我忘了提到我只是为了简单起见对其进行了硬编码。实际上它是一组 CompanyRoleId 值，因此它可以是 (1) 或 (2,5) 或 (1,2,3,4,6,7,99)。

另外我应该更清楚地指定的另一件事是 PredicateExtensions 用于动态地将谓词子句添加到查询的 Where 中，具体取决于 Web 应用程序用户填写的表单字段。所以对我来说棘手的部分是如何将工作查询转换为我可以附加到动态表达式列表的 LINQ 表达式。

我将试一试一些示例 LINQ 查询，看看是否可以将它们与我们的代码集成，然后发布我的结果。谢谢！

马塞尔

# c# - Break at throw 捕获的异常

> ID：418613
> 
> 赞同：2
> 
> 时间：2009-01-06T23:28:17.960
> 
> 标签：c#, visual-studio, exception-handling, debugging

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-06T23:32:58.717

Debug -> Exceptions 对话框是否符合您的要求？您可以选择哪些异常会导致 VS 中断，无论它们是否被捕获。我不知道仅针对代码的特定部分执行此操作的方法，仅基于抛出的异常的类型。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-06T23:45:34.197

是的，您应该能够在 catch 块的最后一个大括号上放置一个断点。或者如果您要重新投掷，请使用 throw 命令。

如果您只需要在某个方法内的任何异常上设置断点，请重新抛出。

```
try {  }
catch (Exception exc)
{ 
   throw;  // <-- breakpoint here
} 
```

编辑：我曾经习惯在几乎所有的异常上都设置断点。一旦我到达大约 25 个断点，就会发现这会大大减慢调试器的速度。可能只与 VS2005 相关。

Edit2：导致异常的位置应该在 exc 对象的 StackTrace 中。

# vba - 在 access 97 中查找完整路径的目录部分（减去文件名）

> ID：418622
> 
> 赞同：40
> 
> 时间：2009-01-06T23:31:36.847
> 
> 标签：vba, ms-access, excel, ms-access-97

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2015-03-24T14:34:28.953

你可以做一些简单的事情，比如：`Left(path, InStrRev(path, "\"))`

例子：

```
Function GetDirectory(path)
   GetDirectory = Left(path, InStrRev(path, Application.PathSeparator))
End Function 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-01-07T04:46:55.820

我总是用`FileSystemObject`这种东西。这是我使用的一个小包装函数。请务必参考`Microsoft Scripting Runtime`.

```
Function StripFilename(sPathFile As String) As String

'given a full path and file, strip the filename off the end and return the path

Dim filesystem As New FileSystemObject

StripFilename = filesystem.GetParentFolderName(sPathFile) & "\"

Exit Function

End Function 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2012-11-16T02:31:54.983

This seems to work. The above doesn't in Excel 2010.

```
Function StripFilename(sPathFile As String) As String
'given a full path and file, strip the filename off the end and return the path
Dim filesystem As Object

Set filesystem = CreateObject("Scripting.FilesystemObject")

StripFilename = filesystem.GetParentFolderName(sPathFile) & "\"

Exit Function

End Function 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-09T17:09:55.937

如果您只需要当前在 Access UI 中打开的 MDB 的路径，我建议编写一个解析 CurrentDB.Name 的函数，然后将结果存储在函数内的静态变量中。像这样的东西：

```
Public Function CurrentPath() As String
  Dim strCurrentDBName As String
  Static strPath As String
  Dim i As Integer

  If Len(strPath) = 0 Then
     strCurrentDBName = CurrentDb.Name
     For i = Len(strCurrentDBName) To 1 Step -1
       If Mid(strCurrentDBName, i, 1) = "\" Then
          strPath = Left(strCurrentDBName, i)
          Exit For
       End If
    Next
  End If
  CurrentPath = strPath
End Function 
```

这样做的好处是它只遍历名称一次。

当然，它只适用于在用户界面中打开的文件。

另一种编写方法是使用上面函数内部[链接](http://www.ammara.com/access_image_faq/parse_path_filename.html)中提供的函数，因此：

```
Public Function CurrentPath() As String
  Static strPath As String

  If Len(strPath) = 0 Then
     strPath = FolderFromPath(CurrentDB.Name)
  End If
  CurrentPath = strPath
End Function 
```

这使得检索当前路径非常有效，同时利用可用于查找任何文件名/路径的路径的代码。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-07T18:21:21.590

左(currentdb.Name,instr(1,currentdb.Name,dir(currentdb.Name))-1)

Dir 函数将仅返回完整路径的文件部分。Currentdb.Name 在这里使用，但它可以是任何完整的路径字符串。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-02-27T23:00:45.930

vFilename="C:\Informes\Indicadores\Program\Ind_Cont_PRv.txt"

vDirFile = Replace(vFilename, Dir(vFileName, vbDirectory), "")

' 结果=C:\Informes\Indicadores_Contraloria\Programa\Versiones anteriores\

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-01-15T00:07:23.633

如果您对输入参数有信心，则可以使用这行代码，它使用本机 Split 和 Join 函数以及 Excel 本机 Application.pathSeparator。

```
Split(Join(Split(strPath, "."), Application.pathSeparator), Application.pathSeparator) 
```

如果您想要更*广泛*的功能，下面的代码在 Windows 中进行了测试，并且应该也可以在 Mac 上运行（尽管未经测试）。请务必同时复制支持函数GetPathSeparator，或修改代码以使用Application.pathSeparator。请注意，这是初稿；我真的应该把它重构得更简洁。

```
Private Sub ParsePath2Test()
    'ParsePath2(DrivePathFileExt, -2) returns a multi-line string for debugging.
    Dim p As String, n As Integer

    Debug.Print String(2, vbCrLf)

    If True Then
        Debug.Print String(2, vbCrLf)
        Debug.Print ParsePath2("", -2)
        Debug.Print ParsePath2("C:", -2)
        Debug.Print ParsePath2("C:\", -2)
        Debug.Print ParsePath2("C:\Windows", -2)
        Debug.Print ParsePath2("C:\Windows\notepad.exe", -2)
        Debug.Print ParsePath2("C:\Windows\SysWOW64", -2)
        Debug.Print ParsePath2("C:\Windows\SysWOW64\", -2)
        Debug.Print ParsePath2("C:\Windows\SysWOW64\AcLayers.dll", -2)
        Debug.Print ParsePath2("C:\Windows\SysWOW64\.fakedir", -2)
        Debug.Print ParsePath2("C:\Windows\SysWOW64\fakefile.ext", -2)
    End If

    If True Then
        Debug.Print String(1, vbCrLf)
        Debug.Print ParsePath2("\Windows", -2)
        Debug.Print ParsePath2("\Windows\notepad.exe", -2)
        Debug.Print ParsePath2("\Windows\SysWOW64", -2)
        Debug.Print ParsePath2("\Windows\SysWOW64\", -2)
        Debug.Print ParsePath2("\Windows\SysWOW64\AcLayers.dll", -2)
        Debug.Print ParsePath2("\Windows\SysWOW64\.fakedir", -2)
        Debug.Print ParsePath2("\Windows\SysWOW64\fakefile.ext", -2)
    End If

    If True Then
        Debug.Print String(1, vbCrLf)
        Debug.Print ParsePath2("Windows\notepad.exe", -2)
        Debug.Print ParsePath2("Windows\SysWOW64", -2)
        Debug.Print ParsePath2("Windows\SysWOW64\", -2)
        Debug.Print ParsePath2("Windows\SysWOW64\AcLayers.dll", -2)
        Debug.Print ParsePath2("Windows\SysWOW64\.fakedir", -2)
        Debug.Print ParsePath2("Windows\SysWOW64\fakefile.ext", -2)
        Debug.Print ParsePath2(".fakedir", -2)
        Debug.Print ParsePath2("fakefile.txt", -2)
        Debug.Print ParsePath2("fakefile.onenote", -2)
        Debug.Print ParsePath2("C:\Personal\Workspace\Code\PythonVenvs\xlwings_test\.idea", -2)
        Debug.Print ParsePath2("Windows", -2)   ' Expected to raise error 52
    End If

    If True Then
        Debug.Print String(2, vbCrLf)
        Debug.Print "ParsePath2 ""\Windows\SysWOW64\fakefile.ext"" with different ReturnType values"
        Debug.Print , "{empty}", "D", ParsePath2("Windows\SysWOW64\fakefile.ext")(1)
        Debug.Print , "0", "D", ParsePath2("Windows\SysWOW64\fakefile.ext", 0)(1)
        Debug.Print , "1", "ext", ParsePath2("Windows\SysWOW64\fakefile.ext", 1)
        Debug.Print , "10", "file", ParsePath2("Windows\SysWOW64\fakefile.ext", 10)
        Debug.Print , "11", "file.ext", ParsePath2("Windows\SysWOW64\fakefile.ext", 11)
        Debug.Print , "100", "path", ParsePath2("Windows\SysWOW64\fakefile.ext", 100)
        Debug.Print , "110", "path\file", ParsePath2("Windows\SysWOW64\fakefile.ext", 110)
        Debug.Print , "111", "path\file.ext", ParsePath2("Windows\SysWOW64\fakefile.ext", 111)
        Debug.Print , "1000", "D", ParsePath2("Windows\SysWOW64\fakefile.ext", 1000)
        Debug.Print , "1100", "D:\path", ParsePath2("Windows\SysWOW64\fakefile.ext", 1100)
        Debug.Print , "1110", "D:\p\file", ParsePath2("Windows\SysWOW64\fakefile.ext", 1110)
        Debug.Print , "1111", "D:\p\f.ext", ParsePath2("Windows\SysWOW64\fakefile.ext", 1111)
        On Error GoTo EH:
        ' This is expected to presetn an error:
        p = "Windows\SysWOW64\fakefile.ext"
        n = 1010
        Debug.Print "1010", "D:\p\file.ext", ParsePath2("Windows\SysWOW64\fakefile.ext", 1010)
        On Error GoTo 0
    End If
Exit Sub
EH:
    Debug.Print , CStr(n), "Error: "; Err.Number, Err.Description
    Resume Next
End Sub
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
Public Function ParsePath2(ByVal DrivePathFileExt As String _
                         , Optional ReturnType As Integer = 0)
' Writen by Chris Advena.  You may modify and use this code provided you leave
' this credit in the code.
' Parses the input DrivePathFileExt string into individual components (drive
' letter, folders, filename and extension) and returns the portions you wish
' based on ReturnType.
' Returns either an array of strings (ReturnType = 0) or an individual string
' (all other defined ReturnType values).
'
' Parameters:
'   DrivePathFileExt: The full drive letter, path, filename and extension
'   ReturnType: -2 or a string up of to 4 ones with leading or lagging zeros
'              (e.g., 0001)
'      -2: special code for debugging use in ParsePath2Test().
'          Results in printing verbose information to the Immediate window.
'       0: default: Array(driveStr, pathStr, fileStr, extStr)
'       1: extension
'      10: filename stripped of extension
'      11: filename.extension, excluding drive and folders
'     100: folders, excluding drive letter filename and extension
'     111: folders\filename.extension, excluding drive letter
'    1000: drive leter only
'    1100: drive:\folders,  excluding filename and extension
'    1110: drive:\folders\filename, excluding extension
'    1010, 0101, 1001: invalid ReturnTypes.  Will result raise error 380, Value
'          is not valid.

    Dim driveStr As String, pathStr As String
    Dim fileStr As String, extStr As String
    Dim drivePathStr As String
    Dim pathFileExtStr As String, fileExtStr As String
    Dim s As String, cnt As Integer
    Dim i As Integer, slashStr As String
    Dim dotLoc As Integer, slashLoc As Integer, colonLoc As Integer
    Dim extLen As Integer, fileLen As Integer, pathLen As Integer
    Dim errStr As String

    DrivePathFileExt = Trim(DrivePathFileExt)

    If DrivePathFileExt = "" Then
        fileStr = ""
        extStr = ""
        fileExtStr = ""
        pathStr = ""
        pathFileExtStr = ""
        drivePathStr = ""
        GoTo ReturnResults
    End If

    ' Determine if Dos(/) or UNIX(\) slash is used
    slashStr = GetPathSeparator(DrivePathFileExt)

' Find location of colon, rightmost slash and dot.
    ' COLON: colonLoc and driveStr
    colonLoc = 0
    driveStr = ""
    If Mid(DrivePathFileExt, 2, 1) = ":" Then
        colonLoc = 2
        driveStr = Left(DrivePathFileExt, 1)
    End If
    #If Mac Then
        pathFileExtStr = DrivePathFileExt
    #Else ' Windows
        pathFileExtStr = ""
        If Len(DrivePathFileExt) > colonLoc _
        Then pathFileExtStr = Mid(DrivePathFileExt, colonLoc + 1)
    #End If

    ' SLASH: slashLoc, fileExtStr and fileStr
    ' Find the rightmost path separator (Win backslash or Mac Fwdslash).
    slashLoc = InStrRev(DrivePathFileExt, slashStr, -1, vbBinaryCompare)

    ' DOT: dotLoc and extStr
    ' Find rightmost dot.  If that dot is not part of a relative reference,
    ' then set dotLoc.  dotLoc is meant to apply to the dot before an extension,
    ' NOT relative path reference dots.  REl ref dots appear as "." or ".." at
    ' the very leftmost of the path string.
    dotLoc = InStrRev(DrivePathFileExt, ".", -1, vbTextCompare)
    If Left(DrivePathFileExt, 1) = "." And dotLoc <= 2 Then dotLoc = 0
    If slashLoc + 1 = dotLoc Then
        dotLoc = 0
        If Len(extStr) = 0 And Right(pathFileExtStr, 1) <> slashStr _
        Then pathFileExtStr = pathFileExtStr & slashStr
    End If
    #If Not Mac Then
        ' In windows, filenames cannot end with a dot (".").
        If dotLoc = Len(DrivePathFileExt) Then
            s = "Error in FileManagementMod.ParsePath2 function.  " _
                & "DrivePathFileExt " & DrivePathFileExt _
                & " cannot end iwth a dot ('.')."
            Err.Raise 52, "FileManagementMod.ParsePath2", s
        End If
    #End If

    ' extStr
    extStr = ""
    If dotLoc > 0 And (dotLoc < Len(DrivePathFileExt)) _
    Then extStr = Mid(DrivePathFileExt, dotLoc + 1)

    ' fileExtStr
    fileExtStr = ""
    If slashLoc > 0 _
    And slashLoc < Len(DrivePathFileExt) _
    And dotLoc > slashLoc Then
        fileExtStr = Mid(DrivePathFileExt, slashLoc + 1)
    End If

' Validate the input: DrivePathFileExt
    s = ""
    #If Mac Then
        If InStr(1, DrivePathFileExt, ":") > 0 Then
            s = "DrivePathFileExt ('" & DrivePathFileExt _
                & "')has invalid format.  " _
                & "UNIX/Mac filenames cannot contain a colon ('.')."
        End If
    #End If
    If Not colonLoc = 0 And slashLoc = 0 And dotLoc = 0 _
    And Left(DrivePathFileExt, 1) <> slashStr _
    And Left(DrivePathFileExt, 1) <> "." Then
        s = "DrivePathFileExt ('" & DrivePathFileExt _
            & "') has invalid format.  " _
            & "Good example: 'C:\folder\file.txt'"
    ElseIf colonLoc <> 0 And colonLoc <> 2 Then
        ' We are on Windows and there is a colon; it can only be
        ' in position 2.
        s = "DrivePathFileExt ('" & DrivePathFileExt _
            & "') has invalid format.  " _
            & "In the  Windows operating system, " _
            & "a colon (':') can only be the second character '" _
            & "of a valid file path. "
    ElseIf Left(DrivePathFileExt, 1) = ":" _
    Or InStr(3, DrivePathFileExt, ":", vbTextCompare) > 0 Then
        'If path contains a drive letter, it must contain at least one slash.
        s = "DrivePathFileExt ('" & DrivePathFileExt _
            & "') has invalid format.  " _
            & "Colon can only appear in the second character position." _
            & slashStr & "')."
    ElseIf colonLoc > 0 And slashLoc = 0 _
    And Len(DrivePathFileExt) > 2 Then
        'If path contains a drive letter, it must contain at least one slash.
        s = "DrivePathFileExt ('" & DrivePathFileExt _
            & "') has invalid format.  " _
            & "The last dot ('.') cannot be before the last file separator '" _
            & slashStr & "')."
    ElseIf colonLoc = 2 _
    And InStr(1, DrivePathFileExt, slashStr, vbTextCompare) = 0 _
    And Len(DrivePathFileExt) > 2 Then
        ' There is a colon, but no file separator (slash).  This is invalid.
        s = "DrivePathFileExt ('" & DrivePathFileExt _
            & "') has invalid format.  " _
            & "If a drive letter is included, then there must be at " _
            & "least one file separator character ('" & slashStr & "')."
    ElseIf Len(driveStr) > 0 And Len(DrivePathFileExt) > 2 And slashLoc = 0 Then
        ' If path contains a drive letter and is more than 2 character long
        ' (e.g., 'C:'), it must contain at least one slash.
        s = "DrivePathFileExt cannot contain a drive letter but no path separator."
    End If
    If Len(s) > 0 Then
    End If

' Determine if DrivePathFileExt = DrivePath
' or  = Path (with no fileStr or extStr components).
    If Right(DrivePathFileExt, 1) = slashStr _
    Or slashLoc = 0 _
    Or dotLoc = 0 _
    Or (dotLoc > 0 And dotLoc <= slashLoc + 1) Then
        ' If rightmost character is the slashStr, then no fileExt exists, just drivePath
        ' If no dot found, then no extension.  Assume a folder is after the last slashstr,
        ' not a filename.
        ' If a dot is found (extension exists),
        ' If a rightmost dot appears one-char to the right of the rightmost slash
        '    or anywhere before (left) of that, it is not a file/ext separator. Exmaple:
        '    'C:\folder1\.folder2' Then
        ' If no slashes, then no fileExt exists.  It must just be a driveletter.
        ' DrivePathFileExt contains no file or ext name.
        fileStr = ""
        extStr = ""
        fileExtStr = ""
        pathStr = pathFileExtStr
        drivePathStr = DrivePathFileExt
        GoTo ReturnResults
    Else
        ' fileStr
        fileStr = ""
        If slashLoc > 0 Then
            If Len(extStr) = 0 Then
                fileStr = fileExtStr
            Else
                ' length of filename excluding dot and extension.
                i = Len(fileExtStr) - Len(extStr) - 1
                fileStr = Left(fileExtStr, i)
            End If
        Else
                s = "Error in FileManagementMod.ParsePath2 function. " _
                    & "*** Unhandled scenario: find fileStr when slashLoc = 0\. *** "
                Err.Raise 52, "FileManagementMod.ParsePath2", s
        End If

        ' pathStr
        pathStr = ""
        ' length of pathFileExtStr excluding fileExt.
        i = Len(pathFileExtStr) - Len(fileExtStr)
        pathStr = Left(pathFileExtStr, i)

        ' drivePathStr
        drivePathStr = ""
        ' length of DrivePathFileExt excluding dot and extension.
        i = Len(DrivePathFileExt) - Len(fileExtStr)
        drivePathStr = Left(DrivePathFileExt, i)
    End If

ReturnResults:
    ' ReturnType uses a 4-digit binary code: dpfe = drive path file extension,
    ' where 1 = return in array and 0 = do not return in array
    ' -2, and 0 are special cases that do not follow the code.

    ' Note: pathstr is determined with the tailing slashstr
    If Len(drivePathStr) > 0 And Right(drivePathStr, 1) <> slashStr _
    Then drivePathStr = drivePathStr & slashStr
    If Len(pathStr) > 0 And Right(pathStr, 1) <> slashStr _
    Then pathStr = pathStr & slashStr
    #If Not Mac Then
        ' Including this code add a slash to the beginnning where missing.
        ' the downside is that it would create an absolute path where a
        ' sub-path of the current folder is intended.
        'If colonLoc = 0 Then
        '    If Len(drivePathStr) > 0 And Not IsIn(Left(drivePathStr, 1), slashStr, ".") _
             Then drivePathStr = slashStr & drivePathStr
        '    If Len(pathStr) > 0 And Not IsIn(Left(pathStr, 1), slashStr, ".") _
             Then pathStr = slashStr & pathStr
        '    If Len(pathFileExtStr) > 0 And Not IsIn(Left(pathFileExtStr, 1), slashStr, ".") _
             Then pathFileExtStr = slashStr & pathFileExtStr
        'End If
    #End If
    Select Case ReturnType
        Case -2  ' used for ParsePath2Test() only.
            ParsePath2 = "DrivePathFileExt          " _
                        & CStr(Nz(DrivePathFileExt, "{empty string}")) _
                        & vbCrLf & "        " _
                        & "--------------    -----------------------------------------" _
                        & vbCrLf & "        " & "D:\Path\          " & drivePathStr _
                        & vbCrLf & "        " & "\path[\file.ext]  " & pathFileExtStr _
                        & vbCrLf & "        " & "\path\            " & pathStr _
                        & vbCrLf & "        " & "file.ext          " & fileExtStr _
                        & vbCrLf & "        " & "file              " & fileStr _
                        & vbCrLf & "        " & "ext               " & extStr _
                        & vbCrLf & "        " & "D                 " & driveStr _
                        & vbCrLf & vbCrLf
            ' My custom debug printer prints to Immediate winodw and log file.
            ' Dbg.Prnt 2, ParsePath2
            Debug.Print ParsePath2
        Case 1      '0001: ext
            ParsePath2 = extStr
        Case 10     '0010: file
            ParsePath2 = fileStr
        Case 11     '0011: file.ext
            ParsePath2 = fileExtStr
        Case 100    '0100: path
            ParsePath2 = pathStr
        Case 110    '0110: (path, file)
            ParsePath2 = pathStr & fileStr
        Case 111    '0111:
            ParsePath2 = pathFileExtStr
        Case 1000
            ParsePath2 = driveStr
        Case 1100
            ParsePath2 = drivePathStr
        Case 1110
            ParsePath2 = drivePathStr & fileStr
        Case 1111
            ParsePath2 = DrivePathFileExt
        Case 1010, 101, 1001
            s = "Error in FileManagementMod.ParsePath2 function.  " _
                & "Value of Paramter (ReturnType = " _
                & CStr(ReturnType) & ") is not valid."
            Err.Raise 380, "FileManagementMod.ParsePath2", s
        Case Else   '   default: 0
            ParsePath2 = Array(driveStr, pathStr, fileStr, extStr)
    End Select

End Function 
```

支持函数 GetPathSeparatorTest 扩展本机 Application.pathSeparator（或在需要时绕过）以在 Mac 和 Win 上工作。它还可以采用可选的路径字符串，并尝试确定字符串中使用的路径分隔符（有利于 OS 本机路径分隔符）。

```
Private Sub GetPathSeparatorTest()
    Dim s As String
    Debug.Print "GetPathSeparator(s):"
    Debug.Print "s not provided: ", GetPathSeparator
    s = "C:\folder1\folder2\file.ext"
    Debug.Print "s = "; s, GetPathSeparator(DrivePathFileExt:=s)
    s = "C:/folder1/folder2/file.ext"
    Debug.Print "s = "; s, GetPathSeparator(DrivePathFileExt:=s)
End Sub
Function GetPathSeparator(Optional DrivePathFileExt As String = "") As String
' by Chris Advena
' Finds the path separator from a string, DrivePathFileExt.
' If DrivePathFileExt is not provided, return the operating system path separator
' (Windows = backslash, Mac = forwardslash).
' Mac/Win compatible.

    ' Initialize
    Dim retStr As String: retStr = ""
    Dim OSSlash As String: OSSlash = ""
    Dim OSOppositeSlash As String: OSOppositeSlash = ""
        Dim PathFileExtSlash As String

    GetPathSeparator = ""
    retStr = ""

    ' Determine if OS expects fwd or back slash ("/" or "\").
    On Error GoTo EH
    OSSlash = Application.pathSeparator

    If DrivePathFileExt = "" Then
    ' Input parameter DrivePathFileExt is empty, so use OS file separator.
        retStr = OSSlash
    Else
    ' Input parameter DrivePathFileExt provided.  See if it contains / or \.
        ' Set OSOppositeSlash to the opposite slash the OS expects.
        OSOppositeSlash = "\"
        If OSSlash = "\" Then OSOppositeSlash = "/"

        ' If DrivePathFileExt does NOT contain OSSlash
        ' and DOES contain OSOppositeSlash, return OSOppositeSlash.
        ' Otherwise, assume OSSlash is correct.
        retStr = OSSlash
        If InStr(1, DrivePathFileExt, OSSlash, vbTextCompare) = 0 _
        And InStr(1, DrivePathFileExt, OSOppositeSlash, vbTextCompare) > 0 Then
            retStr = OSOppositeSlash
        End If
    End If

    GetPathSeparator = retStr
Exit Function
EH:
    ' Application.PathSeparator property does not exist in Access,
    ' so get it the slightly less easy way.
    #If Mac Then ' Application.PathSeparator doesn't seem to exist in Access...
        OSSlash = "/"
    #Else
        OSSlash = "\"
    #End If
    Resume Next
End Function 
```

配套功能（实际注释掉了，不打算用的可以跳过）。

```
Sub IsInTest()
' IsIn2 is case insensitive
    Dim StrToFind As String, arr As Variant
    arr = Array("Me", "You", "Dog", "Boo")

    StrToFind = "doG"
    Debug.Print "Is '" & CStr(StrToFind) & "' in list (expect True): " _
                , IsIn(StrToFind, "Me", "You", "Dog", "Boo")

    StrToFind = "Porcupine"
    Debug.Print "Is '" & CStr(StrToFind) & "' in list (expect False): " _
                , IsIn(StrToFind, "Me", "You", "Dog", "Boo")
End Sub
Function IsIn(ByVal StrToFind, ParamArray StringArgs() As Variant) As Boolean
' StrToFind: the string to find in the list of StringArgs()
' StringArgs: 1-dimensional array containing string values.
' Built for Strings, but actually works with other data types.
    Dim arr As Variant
    arr = StringArgs
    IsIn = Not IsError(Application.Match(StrToFind, arr, False))
End Function 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-11-06T11:36:16.900

试试这个功能：

```
函数文件夹路径（文件路径作为字符串）作为字符串

    '---------------------------------------------------- -
    '从文件路径返回文件夹路径。

    '作者：克里斯托斯·萨马拉斯
    '日期：2013 年 6 月 11 日
    '---------------------------------------------------- -

    将文件名变暗为字符串

    带工作表功能
        FileName = Mid(FilePath, .Find("*", .Substitute(FilePath, "\", "*", Len(FilePath) - _
                    Len(.Substitute(FilePath, "\", "")))) + 1, Len(FilePath))
    结束于

    FolderPath = Left(FilePath, Len(FilePath) - Len(FileName) - 1)

结束功能
```

如果您不想删除文件夹路径末尾的最后一个反斜杠“\”，请将最后一行更改为：

```
FolderPath = Left(FilePath, Len(FilePath) - Len(FileName))
```

例子：

```
FolderPath("C:\Users\Christos\Desktop\LAT Analysers Signal Correction\1\TP 14_03_2013_5.csv") 
```

给出：

> C:\Users\Christos\Desktop\LAT Analyzers Signal Correction\1

或者

> C:\Users\Christos\Desktop\LAT Analyzers Signal Correction\1\

在第二种情况下（注意末尾有一个反斜杠）。

我希望它有帮助...

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2014-12-01T08:34:45.457

使用这些代码并享受它。

```
Public Function GetDirectoryName(ByVal source As String) As String()
Dim fso, oFolder, oSubfolder, oFile, queue As Collection
Set fso = CreateObject("Scripting.FileSystemObject")
Set queue = New Collection

Dim source_file() As String
Dim i As Integer        

queue.Add fso.GetFolder(source) 'obviously replace

Do While queue.Count > 0
    Set oFolder = queue(1)
    queue.Remove 1 'dequeue
    '...insert any folder processing code here...
    For Each oSubfolder In oFolder.SubFolders
        queue.Add oSubfolder 'enqueue
    Next oSubfolder
    For Each oFile In oFolder.Files
        '...insert any file processing code here...
        'Debug.Print oFile
        i = i + 1
        ReDim Preserve source_file(i)
        source_file(i) = oFile
    Next oFile
Loop
GetDirectoryName = source_file
End Function 
```

在这里你可以调用函数：

```
Sub test()
Dim s
For Each s In GetDirectoryName("C:\New folder")
Debug.Print s
Next
End Sub 
```

# php - 在 oscommerce / sts 模板网站中设置 iso-8859-1 而不是 utf-8？

> ID：418650
> 
> 赞同：0
> 
> 时间：2009-01-06T23:39:50.713
> 
> 标签：php, templates, oscommerce, content-encoding, sts-simple-templatesystem

在 oscommerce 网站中，我有以下内容：

服务器响应 = Content-type: text/html;charset=UTF-8

我想要： Content-type: text/html;charset=ISO-8859-1

我如何以及在哪里设置它。

* * *

Html 在页面上看起来像这样：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"> 
<html dir="LTR" lang="nl"> 
<head> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"> 
```

将其更改为： utf-8 不能解决问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-07T01:09:43.357

在 .htaccess 文件中

```
AddDefaultCharset ISO-8859-1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-08T12:45:31.860

请注意（尤其是对于商业网站）您应该改用 ISO-8859-15，其中包括欧元符号。

# apache-flex - 文本输入中的幽灵/半透明标题？

> ID：418665
> 
> 赞同：0
> 
> 时间：2009-01-06T23:45:27.443
> 
> 标签：apache-flex

首先，如果文本编辑没有真实文本，那么出现在文本编辑中的幻影标题是什么？

其次，有没有人为 Flex 文本组件发明了那个特殊的轮子？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-06T23:46:39.717

它被称为水印。

我不是 Flex 方面的专家，但这里有一个例子：

[http://labs.flexperiments.nl/writing-components-in-flex-part-2/](http://labs.flexperiments.nl/writing-components-in-flex-part-2/)

# php - PHP 的 create_function() 与仅使用 eval()

> ID：418674
> 
> 赞同：4
> 
> 时间：2009-01-06T23:47:15.113
> 
> 标签：php, eval, create-function

在 PHP 中，您有 create_function() 函数，它创建一个独特的命名 lambda 函数，如下所示：

```
$myFunction = create_function('$foo', 'return $foo;');
$myFunction('bar'); //Returns bar 
```

这实际上是否更好（除了更容易）然后只是做：

```
do{
 $myFunction = 'createdFunction_'.rand();
}
while(function_exists($myFunction));
eval("function $myFunction(\$foo) { return \$foo; }");
$myFunction('bar'); //Returns bar 
```

create_function 真的更好吗？（除了它更容易）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-07T00:29:38.977

使用 eval() 会使全局函数列表变得混乱， create_function() 不会，除此之外没有太大区别。*但是*，这两种方法都需要在 PHP 字符串中编写函数体，这很容易出错，如果您正在处理我的项目，我会命令您只使用正常语法声明一个辅助函数。

PHP 中的匿名函数实现得如此糟糕，以至于您的代码实际上最好**不要**使用它们。（谢天谢地，这将在 PHP 5.3 中修复）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-13T11:53:50.480

根据我对相关文档的理解，[1] 他们都做同样的事情，create_function() 只是为您提供了一个独特的函数名称。

要解决有关此问题的其他一些评论：

> create_function 可以分配给一个变量，使代码的其他部分可以访问该函数，而 eval 仅对给定范围有用。

很可能 eval() 在当前范围内运行，但函数定义无论如何都会被转储到全局命名空间中。 [2] 因此，无论何时定义一个函数，它都可以在程序中的其他任何地方访问。

> 使用 eval() 会使全局函数列表变得混乱， create_function() 不会

create_function() 只返回一个带有新函数名称的字符串，[3] 不是一些特殊的回调类型。因此，这两种技术都会污染您的全局命名空间。

所以不，除了 create_function() 更容易之外，它似乎并不比 eval() 更好。

脚注：

[1] [http://au2.php.net/manual/en/functions.user-defined.php](http://au2.php.net/manual/en/functions.user-defined.php)；[http://au.php.net/create_function](http://au.php.net/create_function)；[http://au.php.net/eval](http://au.php.net/eval)

[2] [http://au2.php.net/manual/en/functions.user-defined.php](http://au2.php.net/manual/en/functions.user-defined.php)

[3] [http://au.php.net/create_function](http://au.php.net/create_function)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-06T23:51:50.533

就个人而言，我发现 create_function() 在对数组进行排序时非常方便。

其实我只是在网上搜索了一下，似乎PHP文档中有一个很好的例子。

[http://us.php.net/create_function](http://us.php.net/create_function)

向下滚动到*示例 #3 使用匿名函数作为回调函数*。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-07T00:06:55.310

`create_function`可以分配给一个变量，使代码的其他部分可以访问该函数，而`eval`仅对给定范围有用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T01:27:27.797

（除了它更容易）

我不明白你怎么能这么轻易地驳回它。鉴于你的两个例子，哪个更容易一目了然？Create_function 告诉你你打算完成什么。评估没有。

# fonts - 简历的最佳平台中立字体是什么？

> ID：418679
> 
> 赞同：0
> 
> 时间：2009-01-06T23:49:46.280
> 
> 标签：fonts

哪种字体最能让简历在所有操作系统上看起来都一样好？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-06T23:52:35.663

为什么不将简历转换为 PDF 以便它在不同操作系统中看起来相同？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-07T00:02:43.727

Arial、Verdana、Tahoma 和 Times New Roman 等 Microsoft 核心字体通常在大多数平台上可用，但不能保证任何字体在任何平台上都可用。最好的办法是使用保留字体信息的文档格式，例如 PDF，这是一种开放规范的文件格式，在最广泛使用的平台上至少可以使用原始查看器。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-06T23:53:45.240

如果您想完全保持平台中立，则应将其格式化为纯文本并将其包装为 80 列。否则，即使您最终使用几乎在每个平台上都可用的 Times New Roman 但将其放入 Word 文档中，您也会受到限制。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-06T23:52:38.443

可悲而无聊的 Times New Roman 用于打印/pdf 文件。

还是您在询问用于网络交付的字体？由于您的问题中没有任何真实信息，因此很难说清楚。

# iphone - iOS 应用程序中的子目录

> ID：418680
> 
> 赞同：50
> 
> 时间：2009-01-06T23:50:16.857
> 
> 标签：iphone, bundle

有没有办法在一个目录中有目录`.app`？

目前，如果我将一个文件添加到`Xcode`中，无论它位于哪个组层次结构中，该文件始终位于我的应用程序包中的平面文件系统中。

* * *

## 回答 #1

> 赞同：93
> 
> 时间：2009-01-08T02:29:43.990

如果您只想将现有文件复制到应用程序包的 Resources 文件夹（在 iPhone 上只是 .app 包的内部），请执行以下操作：

*   将要复制的文件夹拖到 xcode 项目的文件和文件夹列表中。
*   在弹出的询问您是否要将文件添加到目标的工作表中，将单选按钮更改为“为任何添加的文件夹创建文件夹引用”。

您拖入的文件夹及其所有内容将在构建过程中逐字复制。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-01-06T23:59:54.557

在应用程序的目标下，您必须添加一个 Copy Files 阶段。然后，您可以在应用程序包中指定要将文件复制到的子目录。将有一堆用于特定事物（如资源和框架等）的默认目录，但您可以选择任何您想要的目录。构建应用程序包时，您指定的文件将被复制到包中的位置。

# .net - 学习应用程序编程的最佳资源？（.Net/可可/等）

> ID：418692
> 
> 赞同：4
> 
> 时间：2009-01-06T23:53:53.790
> 
> 标签：.net, cocoa, coding-style

我是一名嵌入式程序员——主要是非常小的系统，我将数据作为位而不是对象来处理。

我想学习如何使用它们的本地库（Cocoa 和 .Net）为 Mac 和 PC 编程。我在 Xcode 和 Visual Studio 中一起破解了一些东西，但我觉得我在*破解*，而不是*编程*。我把东西放在*AwakeFromNib*中，却不知道这是否会引起错误或不好的风格或很好。我认为，我需要学习一些桌面应用程序编程的基本概念。

您能推荐有关该主题的资源或书籍吗？我对如何为这种规模的程序编写*好的代码*特别感兴趣——最佳实践、编码标准等的集合。

*编辑：一般来说，好的代码*有很多可用的资源。这些绝对是必读的，但我在这里寻找专门用于编写桌面应用程序的资源。例如，资源会说通常*属于*AwakeFromNib 的内容，而不仅仅是在触发此回调时。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T00:10:54.630

哇，这是一个非常笼统的问题，您可以参考很多关于很多事情的资源......

话虽如此，也许一个好的起点是一本普通的书（我个人喜欢从书开始，因为我发现一本好书往往会合乎逻辑并引导您完成一个主题-当您更有经验时，网络资源会更好并且确切地知道你想在一个非常狭窄的知识领域找到什么）。

我真的很喜欢 Andrew Hunt 和 David Thomas 的“实用程序员：从熟手到大师”。艾迪生卫斯理出版。虽然你可能不同意这一切，但它有很多值得深思的地方。

虽然你已经是一名嵌入式程序员，而且本书的一些内容你已经熟记于心，但它对于成为一名优秀的程序员（或确定你永远不会成为一名优秀的程序员！）有很多智慧的珍珠。

此外，您可以考虑查看一些设计模式书籍，特别是有关您感兴趣的语言和平台的书籍，以便为您提供良好的代码示例（并希望有助于理解）。

另一本在“实践”方面很有趣的书是 Robert L Glass 的“软件工程的事实和谬误”。由艾迪生-韦斯利出版。

查看 Joel on Software 网站上的一些文章，这些文章也经常发人深省且相关。

希望这是一个有益的开始。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T07:02:09.637

一本关于设计模式的好书将带您了解如何使用 cocoa 中的一些内置结构，如 awakwFromNib、windowDidLoad 等。

这里有一个建议：

[http://www.amazon.com/dp/0201633612/](https://rads.stackoverflow.com/amzn/click/com/0201633612)

在您阅读了该书中的几章之后，您可能想要选择一本专门介绍您想要开始学习的框架和开发环境的好书。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T00:12:21.507

[https://stackoverflow.com/](https://stackoverflow.com/)
[http://codeproject.com/](http://codeproject.com/)
需要学习的时间和时间...... :)

# c# - TDD，你有什么技术可以找到好的测试？

> ID：418707
> 
> 赞同：4
> 
> 时间：2009-01-07T00:04:45.000
> 
> 标签：c#, linq-to-sql, tdd, domain-driven-design

我正在编写一个简单的 Web 应用程序，使用 Linq to Sql 作为我的数据层，因为我非常喜欢 Linq2Sql。我最近读了一些关于 DDD 和 TDD 的文章，想试一试。

首先让我感到震惊的是，Linq2Sql 和 DDD 并没有很好。我的另一个问题是寻找测试，我实际上发现很难定义好的测试所以我想问，你发现好的测试用例的最佳技术是什么。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-07T00:11:19.170

好吧，按照 TDD 的标准解释，测试*驱动*你的开发。所以，本质上你是从测试开始的。它会失败，您将编写代码直到测试通过。所以它是由你的需求驱动的，但是你去收集那些。你决定你的应用程序/功能需要做什么，编写测试，然后编码直到它通过。当然，还有许多其他技术，但这只是对 TDD 世界中典型想法的简要说明。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-07T00:20:16.873

测试用例发现更像是一门艺术而不是一门科学。然而，简单的指导方针包括：

*   您知道脆弱/脆弱/可能会破坏的代码
*   跟随用户场景（你的用户将要做什么），看看它将如何接触你的代码（通常这意味着调试它，有时是分析，有时它只是意味着考虑场景）——你的代码中的任何点都会被触及对用户来说，这些是编写测试的最高优先级。
*   在您自己的开发过程中，您运行的测试会导致您发现错误 - 编写测试以避免代码再次以相同的行为回归。

有几本关于如何编写测试用例的书，但除非你在一个需要记录测试用例的大型组织中工作，否则最好的办法是考虑代码中你不喜欢的所有部分（即't "pure") 并确保您可以彻底测试这些模块。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T12:45:17.930

**想想**。阅读代码。问问自己：例如，这个指针在这里永远不会是 NULL 吗？如果在初始化之前调用此方法会发生什么？

**不要做出**诸如“*此文件将永远存在*”之类的假设。测试。

想想边缘情况、边界、负值、溢出......

错误通常按集群分组。当你找到一个时环顾四周。还要在其他位置寻找相同类型的错误。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-08T11:12:54.433

把你的注意力放在测试的实际目标上：发现错误。

创造性地想象可能导致您的程序失败的原因。

您的测试必须找到错误，而不是确认您的程序是否正常。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T00:54:32.390

我经常为第三方 API 编写测试。这样，当 API 更新时，我就知道我是否会中断。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-08T11:16:07.220

我认为这是一个有用的技术：

[使用合同和布尔查询来提高自动测试生成的质量](http://se.ethz.ch/~meyer/publications/lncs/queries.pdf)

* * *

参考资料：Lisa (Ling) Liu、Bertrand Meyer 和 Bernd Schoeller，*使用合同和布尔查询来提高自动测试生成的质量*，在*TAP：测试和证明*的过程中，苏黎世联邦理工学院，2007 年 2 月 5-6 日，编辑。Yuri Gurevich 和 Bertrand Meyer，计算机科学讲义，Springer-Verlag，2007。

# makefile - 所有 .cpp 文件都依赖于两个 .h 文件？

> ID：418740
> 
> 赞同：1
> 
> 时间：2009-01-07T00:22:26.930
> 
> 标签：makefile, nmake

在makefile中，我有以下行：

```
helper.cpp: dtds.h 
```

这可确保在 dtds.h 更改时重新构建 helper.cpp。但是，如果其他两个头文件中的任何一个发生更改，我希望重建项目中的所有文件，如下所示：

```
*.cpp: h1.h h2.h 
```

显然那是行不通的，但我不知道让 nmake 做我想做的事情的正确方法。有人可以帮忙吗？我不想手动指定每个单独的文件都依赖于 h1.h 和 h2.h。

谢谢。（我正在使用 Visual Studio 2005 中包含的 nmake。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T00:30:04.543

尝试

```
%.cpp : h1.h h2.h 
```

这适用于 GNU make - 不知道 nmake 是否兼容......

**编辑：**顺便说一句：不应该这样吗

```
helper.o : dtds.h

%.o :  h1.h h2.h 
```

毕竟，您不想重新制作`.cpp`文件（如何制作源文件？），而是重新编译...

**Edit2：**检查[NMAKE 参考](http://msdn.microsoft.com/en-us/library/dd9y37ha(VS.80).aspx)。据此[，](http://msdn.microsoft.com/en-us/library/x6bt6xe7(VS.80).aspx)类似

```
.cpp.obj: h1.h h2.h 
```

可能工作...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T01:30:36.747

谢谢你的帮助，克里斯托夫。我试过：

```
.cpp.obj: h1.h h2.h 
```

并得到了有用的错误信息：

```
makefile(58) : fatal error U1086: inference rule cannot have dependents 
```

我最终通过列出要编译的文件列表来解决它，然后将依赖项添加到整个列表中。

```
files = file1.obj file2.obj file3.obj
$(files): h1.h h2.h 
```

# asp.net - ASP.NET / IIS 远程调试 - DEBUG 动词

> ID：418741
> 
> 赞同：5
> 
> 时间：2009-01-07T00:22:30.050
> 
> 标签：asp.net, http, iis, debugging, remote-debugging

我正在寻找有关 DEBUG HTTP 动词的详细信息。
我很清楚这用于远程调试 - 尽管我什至不确定它是用于 IIS 还是 ASP.NET ......

如果我想直接访问这个界面——即不是通过 Visual Studio，而是手动发送这些命令——我需要知道什么？它的命令是什么？
我也对滥用案例感兴趣，如果您有任何相关信息...

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2010-02-17T07:25:14.733

只是为了完整起见，在这里合并[what-is-the-non-standard-http-verb-debug-used-for-in-asp-net-iis 的](https://stackoverflow.com/questions/2244293/what-is-the-non-standard-http-verb-debug-used-for-in-asp-net-iis/2278934)答案：（感谢@Mark，@Jørn）。

[http://support.microsoft.com/kb/937523](http://support.microsoft.com/kb/937523)

> 当客户端尝试在 ASP.NET 2.0 应用程序中自动附加调试器时，客户端会发送一个包含 DEBUG 谓词的 HTTP 请求。此 HTTP 请求用于验证应用程序的进程是否正在运行并选择要附加的正确进程。

`DEBUG`动词用于启动/停止远程调试会话。更具体地说，一个`DEBUG`请求可以包含一个带有 value`start-debug`和的 Command 标头`stop-debug`，但实际的调试是通过 RPC 协议完成的。

它使用 Windows 身份验证和 DCOM 来实际进行调试（显然，如果您允许 RPC 流量，那么您会遇到更大的问题）或任何漏洞。不过，UrlScan 默认会阻止它。

但是，使用请求戳 ASP.NET 网站`DEBUG`可用于显示 web.config 是否具有`<compilation debug="true">`. 通过发送如下请求，可以使用 telnet、WFetch 或类似工具执行测试：

```
DEBUG /foo.aspx HTTP/1.0
Accept: */ *
Host: www.example.com
Command: stop-debug 
```

根据是否启用调试，您将获得`200 OK`或`403 Forbidden`。

人们普遍认为，您永远不应该`<compilation debug="true"/>`在生产环境中使用，因为它会对网站的性能产生严重影响。我不确定启用调试是否会打开任何新的攻击向量，除非还启用了 RPC 流量，在这种情况下，无论如何您都会遇到更严重的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-07T01:31:54.437

如果您想进行远程调试，我建议使用 debug.writeline 和 sysinternals [DebugView](http://technet.microsoft.com/en-us/sysinternals/bb896647.aspx)中的工具。这允许您在您的位置机器或远程机器上“监听”调试语句，前提是您具有必要的访问权限。

由于我不熟悉它，我无法直接回答有关 DEBUG http 的部分。

# multithreading - 在线程终止之前调用 CloseHandle() 是否合理？

> ID：418742
> 
> 赞同：13
> 
> 时间：2009-01-07T00:22:44.870
> 
> 标签：multithreading, winapi

我只想创建一个线程，然后立即调用 CloseHandle 并让线程自行终止，这样我就不必在“原始”线程中进行额外的清理工作（并不是清理本身很难，但这意味着我想避免大量的额外簿记）。

MSDN 说在线程上调用 CloseHandle() 不会终止线程，但我不清楚这是否意味着我真的可以这样做。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-01-07T00:26:18.810

不仅合理，不这样做就是句柄泄漏。通常我在创建线程后立即关闭它，除非我在其他地方需要它。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-01-07T00:29:20.053

CreateThread函数使引用计数+2，CloseHandle只使引用计数-1，当线程函数完成时，系统将引用计数-1。

# regex - 捕获字符串直到第一个插入符号在正则表达式中命中？

> ID：418743
> 
> 赞同：0
> 
> 时间：2009-01-07T00:23:06.150
> 
> 标签：regex

我目前正在使用遗留系统，很多工作涉及分解分隔字符串和针对某些规则进行测试。

使用此字符串，我如何在反向引用和搜索词中返回“Active”，当它碰到第一个插入符号 (^) 时停止？：

```
Active^20080505^900^LT^100 
```

可以通过包含在这个 " `(.+)`" 的正则表达式中来完成吗？我问的原因是实际的正则表达式“ `(.+)`”在数据库中定义为切割这些消息，并且可以从前端系统设置它们的相关规则。内容可以是任何内容（在这种情况下为“活动”），这就是在这种情况下使用“.+”的原因。

规则：插入符号不能出现在括号之间，因为这会导致它也被存储在数据库字段中，并且它在另一个系统字段的其他地方定义。

如果您有比“ `(.+)`”更好的建议，您将很高兴听到它。

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-07T00:25:43.897

```
(.+?)\^ 
```

应该抢到第一个^

如果您必须包含不`(.+)`带修改的内容，则可以使用：

```
(.+?)\^(.+) 
```

第一个反向引用仍然是正确的，您可以忽略第二个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T00:38:29.300

正则表达式在这里真的是矫枉过正。

只需取字符串的前 n 个字符，其中 n 是第一个插入符号的位置。

伪代码：

```
InputString.Left(InputString.IndexOf("^")) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T00:29:44.827

```
^([^\^]+) 
```

如果您的 RE 库不支持非贪婪，那应该可以工作。

# mysql - 索引多个数据库列的成本是多少？

> ID：418744
> 
> 赞同：8
> 
> 时间：2009-01-07T00:24:36.800
> 
> 标签：mysql

我正在编写一个带有索引 3 列的 MySQL 表的应用程序。我担心在表达到大量记录后，保存新记录的时间会很慢。请告知如何最好地处理列的索引。

更新

> 我正在索引 point_value、user_id 和 event_id，所有这些都是面向客户端的目的所必需的。例如，通过球员 ID 和游戏 ID 为棒球比赛得分。每天插入大约 200 条新记录的成本是多少，在表保存了两个赛季的记录之后，比如 72,000 次运行，并且在 5 个赛季之后，可能有 25 万条记录？仅用于说明，但我希望每天插入 25 到 200 条记录。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-07T00:44:07.027

索引看起来最合乎逻辑的内容（这应该是显而易见的，例如 CUSTOMERS 表中的客户 ID 列）。

然后运行您的应用程序并定期收集统计信息以查看数据库的执行情况。DB2 上的 RUNSTATS 就是一个例子，我希望 MySQL 有一个类似的工具。

当您发现一些经常运行的查询正在执行全表扫描（或由于其他原因花费太长时间）时，那么，*并且只有这样*，您才应该添加更多索引。优化每月运行一次的午夜查询没有什么好处，因此它可以在 12:05 而不是 12:07 完成。但是，将面向客户的查询从 5 秒减少到 2 秒是一个巨大的改进（这仍然太慢，如果可能的话，面向客户的查询应该是亚秒级的）。

更多的索引往往会减慢插入速度并加快查询速度。所以它总是一个平衡的行为。这就是为什么您只添加索引以特定于对问题的响应。其他任何事情都是过早的优化，应该避免。

此外，定期重新访问您已经拥有的索引以查看它们是否仍然需要。可能是导致您添加这些索引的查询不再经常运行以保证它。

老实说，我不相信索引表上的三列会导致您受苦，除非您计划存储非常大量的行:-) - 索引非常有效。

* * *

在您编辑后，其中指出：

> 我正在索引 a `point_value`、 the`user_id`和 an `event_id`，所有这些都是面向客户的目的。例如，通过球员 ID 和游戏 ID 为棒球比赛得分。每天插入大约 200 条新记录的成本是多少，在表保存了两个赛季的记录之后，比如 72,000 次运行，并且在 5 个赛季之后，可能有 25 万条记录？仅用于说明，但我希望每天插入 25 到 200 条记录。

我的回答是，一天 200 条记录对于一个数据库来说是一个非常小的值，你绝对不用担心这三个索引。

就在这周，我在工作中将价值一天的交易导入我们的一个数据库表中，它包含 210 万条记录（我们在一整天内从 25 台不同的机器获得至少一个交易）。它有四个独立的复合键，比你的三个单独的键更密集。

现在承认，那是在 DB2 数据库上，但我无法想象 IBM比 MySQL 人要好得多，*以至于*MySQL 只能处理不到 0.01% 的 DB2 负载。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2010-02-08T00:49:09.800

我使用我的真实项目和真实的 MySql 数据库做了一些简单的测试。

我的结果是：将平均索引（索引中的 1-3 列）添加到表中 - 使插入速度降低 2.1%。因此，如果您添加 20 个索引，您的插入速度会降低 40-50%。但是您的选择会快 10-100 倍。

那么添加很多索引可以吗？- 这取决于:) 我给了你我的结果 - 你决定！

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-07T02:01:02.660

没有选择查询，尽管更新，尤其是插入速度会慢几个数量级 - 在您开始同时插入大量行之前，您不会真正注意到这一点......

事实上，在以前的雇主（单用户，桌面系统）中，我们实际上在开始我们的“导入例程”之前删除了索引 - 这将首先删除所有记录，然后将大量记录插入同一个表......

然后，当我们完成插入作业时，我们将重新创建索引......

通过在开始操作之前删除索引并在之后重新创建索引，我们将节省 90% 的时间。

这是一个 Sybase 数据库，但相同的数字适用于任何数据库......

所以要*小心*索引，它们*远非*“免费”......

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-01-13T07:01:57.227

> 仅用于说明，但我希望每天插入 25 到 200 条记录。

在这种插入率下，索引额外列的成本可以忽略不计。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-07T01:45:16.967

如果没有更多关于表中数据的预期使用情况的详细信息，担心索引会减慢您的速度，这听起来很像应该避免的过早优化。

如果您真的担心它，那么设置一个测试数据库并在最坏的情况下模拟性能。证明是或不是问题的测试可能比试图猜测和担心可能发生的事情更有用。如果出现问题，您将能够使用您的测试设置尝试不同的方法来解决问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-07T00:50:03.257

索引是为了加快数据的检索速度，所以问题应该是“我需要快速访问哪些数据？”。如果没有索引，一些查询将执行全表扫描（遍历表中的每一行）以找到您想要的数据。对于大量记录，这将是一项缓慢且昂贵的操作。如果是针对您每月运行一次的报告，那么也许没关系；如果是针对经常访问的数据，那么您将需要索引来为您的用户提供更好的体验。

如果您发现插入操作的速度由于索引而变慢，那么您可以通过在问题上投入更多的 CPU、RAM 和更好的硬盘技术来解决硬件级别的问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-10T03:18:52.433

帕克斯所说的。

对于您描述的维度，我能想象的唯一重要问题是“未能索引多个 db 列的成本是多少？”

# assembly - ASM 打印所有已打印的值

> ID：418749
> 
> 赞同：0
> 
> 时间：2009-01-07T00:26:55.987
> 
> 标签：assembly, x86, dos

我有一个显示日期（日、月、年）和时间（小时、分钟、秒）的 ASM 脚本。

这会在 DOS 框上打印当前日期时间。问题是，它是静态的。我想要做的是使其动态化，这意味着我必须将新值写入当前值在屏幕上的确切位置。你如何在 ASM 中做到这一点？

我根本没有任何线索，谷歌也不是我的朋友。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T02:39:42.037

在打印字符串之前使用 ASM 代码定位光标。例如：

```
 MOV     DX,1629H                ; (LINE 16H, COL 29H)
        MOV     AH,2                    ; Move cursor to DH,DL
        INT     10H
        ; now print your string 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-07T02:36:07.223

如果您的 DOS 框是 COMMAND.COM 或 Windows 2000 之前的 CMD.EXE（较新的 CMD.EXE 不提供 ANSI 支持），那么它将支持 ANSI 转义序列。在显示新时间之前，您可以使用各种[光标命令](http://academic.evergreen.edu/projects/biophysics/technotes/program/ansi_esc.htm#cursor)将光标定位在时钟的开头。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T02:46:58.590

这实际上不是特定于语言的问题，而更多的是特定于平台的问题。你说你在 DOS 机器上运行，所以你可以使用以下之一：

1.  如果您使用的是 DOS 打印例程（例如 AH=9 的 INT 21h），您可以打印回车符（ASCII 13）**而不**使用后续换行符（ASCII 10），以将光标返回到当前线。同样，如果这实际上是一个基于控制台的 Windows 应用程序，并且您正在使用 WriteConsole，您应该可以达到相同的效果。
2.  如果你真的在使用 DOS，你可以使用 BIOS 来更新当前光标位置为 INT 10h，AH=2。
3.  正如 Sparr 所提到的，您可以发送“ANSI”转义序列（如果加载了 ansi.sys）来控制光标以及其他内容，例如颜色。这些转义序列将被打印（例如，ala INT 21h，AH=9），就像您的文本一样。

* * *

如果您要在 DOS 中进行大量汇编编程，我会为[几个](http://www.emu8086.com/assembly_language_tutorial_assembler_reference/8086_bios_and_dos_interrupts.html)[中断](http://www.delorie.com/djgpp/doc/rbinter/ix/)[引用](http://www.google.com/search?q=dos+bios+interrupts)[之一](http://www.htl-steyr.ac.at/~morg/pcinfo/hardware/interrupts/inte1at0.htm)保留一个书签。

# user-interface - “今日头条”好吗？

> ID：418751
> 
> 赞同：12
> 
> 时间：2009-01-07T00:29:25.327
> 
> 标签：user-interface, popup

许多程序（通常是大型程序，如 MS Office、The GIMP、Maxthon）都有一个称为“每日提示”的功能。它解释了程序的一小部分，就像 Maxthon 中的这个：

“您可以通过按 Ctrl+F11 隐藏/显示主菜单栏”

您通常可以通过单击下一步来浏览它们。提供的其他选项有“上一个”、“关闭”、“启动时不显示”。

我想我喜欢 Maxthon 过去处理这个问题的方式；在浏览器的状态栏中（通常在底部，连同“完成”、进度条等），有时会有一个小提示或提示，说明您还可以用它做什么。

正如 Joel Spolsky 在他的文章系列“[程序员的用户界面设计](http://www.joelonsoftware.com/uibook/fog0000000249.html)”中所写，人们不喜欢阅读手册。但是我们仍然希望他们使用该程序以及他们可以从中受益的功能，不是吗？因此，我认为拥有这样的功能很有用，而不会在启动时弹出窗口的烦恼。

你怎么看？弹出？傲游风格？没门？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-07T00:46:51.547

我真的只喜欢“一天的提示”的想法，如果它在我无法做任何其他事情时显示。例如，当程序加载一个大文件时。假设程序第一次启动时它必须加载一些大量数据。随着“加载”启动画面，显示一个小提示，并在程序启动时让它消失。它简单、不显眼，有时对某些用户很有帮助。

我讨厌在编程讨论中以“魔兽世界”为例，但它在您第一次登录时使用了这种技术。这是一个[示例加载屏幕](http://www.freeimagehosting.net/uploads/2c7a3582ef.jpg)。除了加载栏和全屏艺术品外，它还会在屏幕底部显示一个小提示。通常，这些提示会引导用户了解他们可以进一步探索的内容（例如设置窗口、角色自定义工具等）。例如，“按下 ESCAPE 会弹出一个菜单，让您自定义游戏的外观和感觉”。

最重要的是：允许用户轻松关闭提示并阻止它们每次出现。使每个键在按下时关闭提示对话框。有两个按钮：“关闭提示”和“关闭提示并且不再显示”，或者类似的东西。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-07T00:59:46.670

消除这些技巧一定很容易——但在学习新的 GUI 时，我经常使用它们。如果它是启动时的提示，我通常会在最多运行十几次后将其关闭，但如果提示设计得当，这会让我对应用程序空间有所了解。

提示可以改进的方法：

*   不要向用户提示用户最近使用过的功能。

*   制作对上下文敏感的提示可能会有所帮助（新的 Vista 条就是一个例子 --- 暂停以获取蒸汽；我刚刚说了一些关于 Vista 的好话）。

*   不引人注目或在其他浪费时间出现的提示是好的。

*   加载画面中的提示是好的，但加载结束后必须可以找到。一些流行的游戏，也许是博德之门，会在加载过程中给你一个提示，然后你可以回去查看你的日志中的提示。因此，如果您对几个屏幕前的有用提示有一个模糊的记忆，您可以在您习惯于查找其他最近信息的相同位置快速找到它。可能是帮助菜单上的“最近提示”项目？

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-07T00:32:21.967

实际上，我从未听说过Maxthon。但我实际上喜欢那些，只要有一个复选框可以让它们停止。我喜欢这些提示实际上告诉我一些有趣的事情，而不是 UI 中非常明显的事情。但这确实是偏好。我不认为使用它们是不好的设计。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-07T01:36:53.503

不——我非常不喜欢他们。当我开始一个软件应用程序时，我几乎总是有一个特定的任务。TOTD 只是打断了这个流程，并试图让我考虑*软件*而不是*任务*。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-07T00:32:49.453

这可能不是您问题的直接答案，但就个人而言，我喜欢 StackOverflow 处理这个问题的方式。徽章系统本质上是一本手册，奖励用户发现和使用它所提供的功能。当然，对于大多数应用程序来说，这并不是一个真正的选择，但它对 StackOverflow 非常有效。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-07T00:45:58.007

我认为这与针对[模态](http://en.wikipedia.org/wiki/Modal_window#Criticisms)的问题有关——它是用户的方式，尽管它可能有多大帮助。这就是为什么需要“启动时不显示”的原因。

虽然我以前从未使用过 Maxthon，但它显示提示的方式听起来确实是个好主意。至于用户是否必须注意他们，这是不引人注目且完全可选的。

IMO，拥有一个必须询问用户是否应该“保持安静”的功能并不是一个好主意。;)

而且，虽然一些提示看起来很明显，但即使这些提示对不太熟悉的用户仍然有用。那些已经知道它的人可以继续他们的一天。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-07T00:35:36.063

提示是个好主意，用户可以发现他们不知道他们不知道的事情。但与其使用弹出窗口妨碍工作，我更喜欢魔兽世界的做法。他们将提示放在加载屏幕上，当您无事可做时，无论如何都要盯着进度条。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-07T17:43:56.640

Norman Ramsey 就如何改进小费提出了一些重要的观点。我对当天提示的问题（我说的是在我自己的应用程序中实现它们的人）是它们不及时并且有点太侵入性。当您启动程序时，一天的典型提示就会出现，并且需要单击按钮才能使其消失。当我真正看到一个有用的提示时，我的思路通常是“当我选择选项时，我必须记住这一点”。当然，当我开始使用 . 并且在程序启动期间单击“确定”很快就会变老，我通常会在前十几个左右之后禁用提示。

我的建议是进行下一步，使当天的提示更加上下文敏感。例如，如果程序检测到用户不断地去**编辑 | 复制**然后**编辑 | Paste**，一个很好的提示是“不是没有，但是 CTRL+C 后跟 CTRL+V 完成了同样的事情”，并在他们像迷路的猴子一样点击菜单时告诉他们，而不是在程序启动期间。哦，不要通过强迫他们单击“确定”来中断他们的工作。

我刚才的建议——这就是那个该死的回形针老兄曾经做过的事吗？

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-07T00:34:26.453

IMO 每日提示（弹出窗口）仅在您经常使用的具有一定复杂程度的程序中。因此，当您打开程序时，您会学到一个对您有帮助的新技巧。

通常人们要么喜欢它，要么讨厌它，所以绝对可以选择禁用它。

我对另一种类型的担心是它会被忽视，你不会相信人们从未看过的程序领域。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-07T00:54:22.077

也许把它放在“工具提示”之类的东西中（或者像 OP 描述的那样放在底部）并使其具有上下文关系。更改为新模式几秒钟后，它会滑入一些有关当前模式的文本。

**是**的，让关闭按钮很容易找到！！！

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-08-17T16:09:44.007

一天的小费可能会很好，如果它是

*   非模态的，从不妨碍
*   有我可以访问的“历史”
*   对我所做的事情是上下文敏感的

不幸的是，糟糕的初始 Office 实现 Clippy 完全扼杀了最后一个想法。

因此，IMO 一个好的实施将：

*   在启动时显示
*   让“启动时不显示”成为显而易见的选择
*   指示（用动画？）TOTD 可从工具栏等访问
*   MouseOver 工具栏图标将给出“当前提示”的标题/摘要
*   点击它会给我提示，通过提示向前/向后导航，链接到手册中的“显示所有提示”。
*   对于大型提示数据库，“相关提示”链接可能会鼓励我探索手册

**上下文相关**

Clippy 的后来版本实际上几乎是有帮助的：它是非模态的，并且*不需要*交互（不过，跳跃很吸引注意力），我记得有一些建议很好的例子 - 例如键盘快捷键我通过菜单反复访问的命令。

一个更简单的方法仍然有效：

*“您知道吗...您可以自定义打印模板，使其看起来像 LSD 上的饼图 - 手册向您展示了如何操作！[clickety]”*在打印对话框中

*你知道吗...我记得你的自定义搜索。只需单击“Goof/Barf/Hidden/Create Index for last Query”——它们就会出现在“Search”菜单中。他们也会跑得更快！*使用搜索/查询表单时

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2010-06-10T21:09:02.827

就个人而言，我更喜欢简单到不需要“每日提示”的软件。

# c# - 通用约束和接口实现/继承

> ID：418764
> 
> 赞同：13
> 
> 时间：2009-01-07T00:33:40.637
> 
> 标签：c#, generics

不完全确定如何表达这个问题，因为它是“为什么这不起作用？” 查询类型。

我已将我的特定问题简化为以下代码：

```
public interface IFoo
{
}

public class Foo : IFoo
{
}

public class Bar<T> where T : IFoo
{
    public Bar(T t)
    {
    }

    public Bar()
        : this(new Foo()) // cannot convert from 'Foo' to 'T'
    {
    }
} 
```

现在，类`T`中的泛型类型*必须*实现 IFoo。那么为什么编译器会在评论中给我错误呢？Foo 的实例肯定是 IFoo，因此可以作为泛型类型的代表传递？`Bar<T>`*`T`*

 *这是编译器限制还是我遗漏了什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-07T00:39:05.570

您还可以有一个 Fiz 以任何其他方式实现与 Foo 无关的 IFoo：

```
public interface IFoo
{
}

public class Foo : IFoo
{
}

public class Fiz : IFoo
{
}

Foo foo = new Foo();
Fiz fiz = foo; // Not gonna compile. 
```

你想要的可能更像是：

```
public class Bar<T> where T : IFoo, new()
{
    public Bar(T t)
    {
    }

    public Bar()
        : this(new T()) 
    {
    }
} 
```

所以你可以拥有

```
Bar<Foo> barFoo = new Bar<Foo>();
Bar<Fiz> barFiz = new Bar<Fiz>(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T00:38:57.850

如果您创建一个类 Baz，然后由构造函数重载定义的泛型类型 Bar baz = new Bar(), new Foo() 将不是 T 类型，在本例中为 Baz。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T00:44:08.447

这是因为如果你创建一个类：

```
public class Fred : IFoo
{
} 
```

然后像这样实例化`Bar<T>`：

```
var bar = new Bar<Fred>(); 
```

然后它违反了类的约束，因为 a `Foo`is not a `Fred`which is current `T`。

`(T)(IFoo)new Foo()`您可以通过将强制转换序列放在构造函数中来强制它编译，但`InvalidCastException`如果实际类型`T`不能从`Foo`.

# apache-flex - 使 Flex 数据网格适合数据

> ID：418765
> 
> 赞同：1
> 
> 时间：2009-01-07T00:33:50.497
> 
> 标签：apache-flex, flex3, itemrenderer

我有几行文本数据，可以在 0 到 100 之间变化，并且一次都需要在屏幕上可见。默认行为适用于网格，直到行 * rowHeight > gridHeight。

基本上我需要一个挂钩到项目高度或行高来根据网格的高度计算它。我已将 paddingTop 和 paddingBottom 设置为零，但行之间仍有大量空白。

我的数据网格组件...

```
<mx:DataGrid xmlns:mx="http://www.adobe.com/2006/mxml"
creationComplete="OnCreationComplete()"
paddingTop="0"
paddingBottom="0"
>

<mx:Script>
    <![CDATA[

    private function OnCreationComplete():void
    {
        //setRowHeight(10);
    }

    override protected function setRowHeight(v:Number):void
    {
        super.setRowHeight(v);
    }

    ]]>
</mx:Script>

</mx:DataGrid> 
```

setRowHeight() 有帮助，但如果我将行高设置为 10，则单元格的 itemRender 比单元格大。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T10:48:13.890

您可能希望查看 DataGrid.variableRowHeight 属性，当它设置为 false（默认值）时，所有行的高度都将与最大的 itemRenderer 相同。您还可以考虑为每个 DataColumn 编写自己的 itemRenderer。

如果你真正想做的只是根据 dataProvider 中的项目数设置行高，你可以像这样设置 DataGrid.rowHeight 属性（假设你的网格有一个固定的高度，比如 100%）：

```
myDataGrid.dataProvider = myArray;
myGrid.rowHeight = Math.floor((myGrid.height - myGrid.headerHeight)/myArray.length); 
```

（我在这里发言是因为如果你最终得到一个四舍五入的小数值，你需要一个滚动条）

正如我认为您已经注意到的那样，这种方法的唯一问题是 itemRenderer 可能无法在太小的一行中正确显示。我想您可以通过根据其高度更改渲染器中的字体来解决此问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-13T00:21:35.707

谢谢inferis，这对我帮助很大。这是我的最后一个网格组件。由于一些调用，它并不是真正独立的，但如果它可以帮助其他人让他们的工作，那就太好了！

```
<?xml version="1.0" encoding="utf-8"?>
<mx:DataGrid xmlns:mx="http://www.adobe.com/2006/mxml"
paddingTop="-3"
paddingBottom="-3"
resize="OnResize(event)"
>

<mx:Script>
    <![CDATA[
        import mx.containers.Panel;
    import mx.core.Application;
    import mx.events.ResizeEvent;

    protected function OnResize(event:ResizeEvent):void
    {
        this.invalidateDisplayList();
    }

/**
 *  @private
 *  Sizes and positions the column headers, columns, and items based on the
 *  size of the DataGrid.
 */
override protected function updateDisplayList(unscaledWidth:Number,
                                              unscaledHeight:Number):void
{
    if( this.collection.length > 0 ) // so don't divide by zero
    {
        var appHeight:Number = Application.application.height;
        var appMinusMenuHeight:Number = appHeight - Application.application.hboxPrintBar.height;
        var boxHeight:Number = Application.application.vboxViewAll.height;
        if( boxHeight > 0 )
        {
            var gridHeight:Number = (appMinusMenuHeight - this.headerHeight) * 0.93;
            var calcHeight:Number = gridHeight / this.collection.length;
            var calcHeightFloor:Number = Math.floor( calcHeight );
            setRowHeight( calcHeightFloor );
            //var p:Panel = this.parent as Panel;
            //p.title = calcHeightFloor.toString();
            if( calcHeightFloor <= 10 )
                this.setStyle("fontSize",calcHeightFloor);
        }
    }
    super.updateDisplayList(unscaledWidth,unscaledHeight);
}

    ]]>
</mx:Script>

</mx:DataGrid> 
```

# tdd - TDD 蜘蛛纸牌

> ID：418778
> 
> 赞同：2
> 
> 时间：2009-01-07T00:40:30.827
> 
> 标签：tdd

我的另一个关于 TDD 的问题。我已经阅读了一些关于 TDD 的文章和书籍章节，我理解为什么应该使用 TDD，并且我理解简单的示例，但是当我在现实世界中尝试这个时，我似乎很容易陷入困境。

如果您要编写 Windows Vista 附带的众所周知的 Spider Solitaire，您能给我一些简单的 TDD 示例吗？你会从哪些测试开始？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-07T01:28:57.967

好吧，当您询问蜘蛛纸牌的 TDD 时，您基本上是在询问如何设计这样的游戏。测试将是设计决策的结果。纸牌是一款简单的游戏，但从头开始设计这样一款游戏并非易事（有不止一种方法可以实现）。

您可能希望从设计更简单的东西开始，例如猜数游戏（系统生成一个随机数，您尝试尽可能少地猜测它）。

这种简单游戏的一些特点是：

1.  在 1 到 10 之间随机生成秘密号码的功能。生成新号码开始新游戏。
2.  比较玩家的输入是高于还是低于该数字，或者猜测是否正确的功能
3.  计算猜测次数的功能

从那里你可以尝试这些测试（就像粗略的例子，但很容易编码）：

1.  运行你的发电机 1000 次。确保`secret_number >= 1 && secret_number <= 10`每次。
2.  对于一组样本数字（随机生成），您的比较函数是否在 时返回“HIGH”，何时返回“ `number > secret_number`LOW”，何时返回`number < secret_number`“WIN” `number == secret_number`？
3.  重复上一个测试，但跟踪您测试的项目数。返回“WIN”时，请确保您的计数器功能与您的测试项目数相匹配。

这只是一个非常粗略的大纲，绝不是完整的。但是您可以从英文描述中看到，代码示例会更加冗长。我想如果你想要更具体的答案，你必须问一个更具体的问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-07T01:52:35.297

纸牌游戏涉及纸牌。

所以，你想到了一个 Card 类。您为单个 Card 对象编写了一些测试。您编写 Card 类以通过测试。

你需要一个可以洗牌并进入布局的牌组。您会想到 Deck 类和 shuffle 算法，以及它如何维护处理状态。你为一个洗牌和发牌的牌组写了一些测试。你编写你的 Deck 类来通过测试。[注意，这需要一个实际上不是随机的模拟随机数生成器。]

纸牌游戏涉及带有空白空间和卡片的布局。一些空白的规则空间（仅限国王或仅限王牌）。纸牌游戏有时涉及股票，或多或少是甲板的剩余部分。

因此，您会想到一个带有卡片空间的 Layout 类。您为布局编写一些测试并放入各种卡片。您编写 Layout 类以通过测试。

然后有关于可以从布局中移动哪些卡片的规则。整堆、子堆、顶牌等等。你有一个 AllowedMove 或 GameState 或一些这样的类。一样的钻。大致定义它的作用，编写测试，完成课程。

你有用户界面和显示的东西。钻头是一样的。

1.  粗略的上课。

2.  定义测试。

3.  完成课程。

等等

我在一本关于[OO Design](http://homepage.mac.com/s_lott/books/oodesign.html)的书中详细介绍了这一点。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-07T09:39:33.250

首先，您应该**将 GUI 从引擎中分离出来**。对 GUI 进行 TDD 是最难的部分，因此您应尽可能保持 GUI 层薄。Google 搜索“简陋的对话框”并阅读[Yahoo! 上的 tddui 列表 团体](http://tech.groups.yahoo.com/group/TestFirstUserInterfaces/)。

引擎层将执行游戏规则。我不确定蜘蛛纸牌与我基于以下内容的古代纸牌（即来自 Windows 3.1）有何不同：

这是我将从以下开始的初始测试列表：

*   您可以随时将卡片移到空堆栈中
*   一张卡片是有价值的，可以与卡片进行比较
*   当顶部的卡片低于移动的卡片时，您只能将卡片移动到非空堆栈
*   你总是可以把几张牌移到一个空堆里
*   当顶部的卡片低于移动的卡片时，您只能将几张卡片移动到非空堆栈中
*   当您从堆叠中移动所有翻牌时，可以退回最上面的牌（或者应该自动退回？）
*   您可以从底座中取出第一张卡片并放入任何堆栈（？）

我对规则不确定，但我认为这足以理解这个想法。

最后，从最简单的测试开始，当你有一个新的测试想法时，或者当你发现自己在质疑时，将测试添加到列表中：如果……会发生什么。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T01:09:13.280

1.  列出蜘蛛纸牌的特点【我不玩纸牌游戏】
2.  描述您将如何测试每个功能
3.  做

# asp.net-mvc - 什么是好的 openid 选择器控件？

> ID：418790
> 
> 赞同：15
> 
> 时间：2009-01-07T00:46:53.980
> 
> 标签：asp.net-mvc, openid, dotnetopenauth, rpxnow

既然[idselector](http://www.idselector.com/)已经升级到[RPXNow](http://rpxnow.com/)并且你不能“只使用”选择器代码，那么有什么好的替代品呢？

我想在我正在使用的新网站上实现 OpenId，但是除非我为他们提供一种简单的方法，否则用户在登录时会变得愚蠢。

作为参考，我将在 ASP.Net MVC Web 应用程序中使用 .Net Open Id 作为背景。

* * *

**编辑**

经过一些廉价的思考，使用[rpxlib](http://code.google.com/p/rpxlib/)怎么样？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-03-07T17:44:02.463

[**Jarrett Vance**](https://web.archive.org/web/20190911021133/http://jvance.com:80/pages/JQueryOpenIDPlugin.xhtml) 制作了一个对开发人员/设计人员更加友好的开放选择器“版本”。

> 这个选择器是不同的，因为**它不会隐藏 javascript 中的标记细节**。因此，**您可以轻松地添加新的提供程序**或重新排列现有的提供程序，而无需深入研究 javascript。如果禁用 javascript，登录表单仍可用于正常的 OpenID 登录

最棒的是，它附带文档、演示和大量图像，包括裁剪和原始[.pdn](https://www.getpaint.net/index.html)文件 ( [paint.net](https://www.getpaint.net/index.html) )

Jarrett Vance 的[openid-selector](https://web.archive.org/web/20190911021133/http://jvance.com:80/pages/JQueryOpenIDPlugin.xhtml) [可以在这里找到](https://web.archive.org/web/20190911021133/http://jvance.com:80/pages/JQueryOpenIDPlugin.xhtml)

[![替代文字](https://i.stack.imgur.com/nHVUU.png)](https://web.archive.org/web/20190911021133/http://jvance.com:80/pages/JQueryOpenIDPlugin.xhtml)
[（来源：[jvance.com](http://jvance.com/media/2009/02/10/JQueryOpenIdPluginUser_thumb2.media)）]

**PS：我建议在实施 RPX 之前阅读[这篇文章。](http://blog.nerdbank.net/2009/01/why-using-rpxnow-is-bad-idea.html)**

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-02T13:47:21.723

另一个要考虑的是[http://code.google.com/p/openid-realselector/ （这是](http://code.google.com/p/openid-realselector/)[http://code.google.com/p/openid-selector/](http://code.google.com/p/openid-selector/)的重写/更新）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-08T16:02:42.413

我已经用 RPXLib 和 RPXNow 完成了一个实现，它真的非常简单。

我想尽量减少以 OpenId 格式完成的工作量，而 RxpL​​ib 无疑帮助了这一点。

RpxNow 还有一个很好的功能，可以告诉我新用户、每天的登录次数等...

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-04T07:12:32.233

我制作了[Open-selector](http://open-selector.com)，您只需将其添加到您的站点并将常规 OpenID 框切换为提供者列表和用户名文本输入。

代码非常简单（以防您需要额外的自定义），并且有一个内联模式，因此它不会改变您的原始布局。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-07T07:40:09.043

我正在使用那个，但后来我发现有几个人使用了另一个让我进行调查的人，我发现了这个[OpenID 选择器](http://code.google.com/p/openid-selector/)。除了 demo.html 本身没有任何说明，但应该不难弄清楚。只需包含 css 和 js，然后使用正确的参数调用 javascript 函数。

关于 rpx 的编辑：我选择远离 rpx，因为我不想有一个“中心故障点”，以及一个不属于我自己的网站，用户将通过该网站进行身份验证。我使用 openid 似乎有点违反直觉，但如果您认为用户使用的 openid 提供程序是用户的一部分，那么这有点道理。

# cocoa - 在 Mac OS X 的桌面上绘图

> ID：418791
> 
> 赞同：4
> 
> 时间：2009-01-07T00:47:22.683
> 
> 标签：cocoa, desktop

我想创建程序[conky](http://conky.sourceforge.net/screenshots.html)的模拟。在 OS X 桌面上绘制信息的最佳方式是什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-07T02:36:59.717

NSWindow 有一个方法，`setLevel:`它可以让你控制窗口与其他窗口相比的位置。根据我自己的经验，您可能想尝试喂它`kCGDesktopIconWindowLevel`，并调用`setHasShadow:NO`以实现您想要的外观。要实际进行绘图，您需要在窗口中放置一个自定义 NSView 子类，并创建没有框架（参见`NSBorderlessWindowMask`）和透明（`[window setBackgroundColor:[NSColor clearColor]], [self setOpaque:NO];`）的窗口。

您可能还想[查看这篇文章](http://www.cocoadev.com/index.pl?DontExposeMe)，以在 Expose 事件期间将您的窗口固定在桌面上。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-07T04:13:40.117

你试过[GeekTool](http://projects.tynsoe.org/en/geektool/)吗？也许您甚至不必编写应用程序。☺</p>

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-07T01:23:25.793

您需要看看使用`NSWindowLevel`透明窗口。

# ruby-on-rails - 运行 Rspec 时出现“没有要加载的文件”错误

> ID：418792
> 
> 赞同：11
> 
> 时间：2009-01-07T00:50:01.290
> 
> 标签：ruby-on-rails, ruby, testing, rspec

```
Mac OS 10.4
rspec (1.1.11, 1.1.4, 1.1.3, 0.5.15)
rspec-rails (1.1.11)
rspec_generator (0.5.15)
rails 2.2.2
ruby 1.8.6 (2007-03-13 patchlevel 0) [universal-darwin8.0] 
```

创建了一个新项目...

```
$ rails myproject 
```

将rspec安装到项目中...

```
$ script/generate rspec 
```

生成资源...

```
$ script/generate rspec_scaffold myresource name:string description:text 
```

试图运行规范...

```
$ rake spec 
```

得到这个错误：

```
/usr/local/lib/ruby/site_ruby/1.8/rubygems/custom_require.rb:31:in `gem_original_require': no such file to load -- ./spec/models/../../vendor/generators/rspec/lib/rspec_on_rails (MissingSourceFile)
        from /usr/local/lib/ruby/site_ruby/1.8/rubygems/custom_require.rb:31:in `require'
        from /usr/local/lib/ruby/gems/1.8/gems/activesupport-2.2.2/lib/active_support/dependencies.rb:155:in `require'
        from ./spec/models/../spec_helper.rb:3
        from ./spec/models/entry_spec.rb:1:in `require'
        from ./spec/models/entry_spec.rb:1
        from /usr/local/lib/ruby/gems/1.8/gems/rspec-1.1.11/lib/spec/runner/example_group_runner.rb:14:in `load'
        from /usr/local/lib/ruby/gems/1.8/gems/rspec-1.1.11/lib/spec/runner/example_group_runner.rb:14:in `load_files'
        from /usr/local/lib/ruby/gems/1.8/gems/rspec-1.1.11/lib/spec/runner/example_group_runner.rb:13:in `each'
        from /usr/local/lib/ruby/gems/1.8/gems/rspec-1.1.11/lib/spec/runner/example_group_runner.rb:13:in `load_files'
        from /usr/local/lib/ruby/gems/1.8/gems/rspec-1.1.11/lib/spec/runner/options.rb:98:in `run_examples'
        from /usr/local/lib/ruby/gems/1.8/gems/rspec-1.1.11/lib/spec/runner/command_line.rb:10:in `run'
        from /usr/local/lib/ruby/gems/1.8/gems/rspec-1.1.11/bin/spec:4
/usr/local/lib/ruby/site_ruby/1.8/rubygems/custom_require.rb:31:in `gem_original_require': no such file to load -- /Users/ethan/project/project/spec/../vendor/generators/rspec/lib/rspec_on_rails (MissingSourceFile)
        from /usr/local/lib/ruby/site_ruby/1.8/rubygems/custom_require.rb:31:in `require'
        from /usr/local/lib/ruby/gems/1.8/gems/activesupport-2.2.2/lib/active_support/dependencies.rb:155:in `require'
        from /Users/ethan/project/project/spec/spec_helper.rb:3
            from ./spec/controllers/entries_controller_spec.rb:1:in `require'
        from ./spec/controllers/entries_controller_spec.rb:1
        from /usr/local/lib/ruby/gems/1.8/gems/rspec-1.1.11/lib/spec/runner/example_group_runner.rb:14:in `load'
        from /usr/local/lib/ruby/gems/1.8/gems/rspec-1.1.11/lib/spec/runner/example_group_runner.rb:14:in `load_files'
        from /usr/local/lib/ruby/gems/1.8/gems/rspec-1.1.11/lib/spec/runner/example_group_runner.rb:13:in `each'
        from /usr/local/lib/ruby/gems/1.8/gems/rspec-1.1.11/lib/spec/runner/example_group_runner.rb:13:in `load_files'
        from /usr/local/lib/ruby/gems/1.8/gems/rspec-1.1.11/lib/spec/runner/options.rb:98:in `run_examples'
        from /usr/local/lib/ruby/gems/1.8/gems/rspec-1.1.11/lib/spec/runner/command_line.rb:10:in `run'
        from /usr/local/lib/ruby/gems/1.8/gems/rspec-1.1.11/bin/spec:4 
```

确实，没有这样的文件...

供应商/发电机，LS：

```
rspec_controller        rspec_model 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2010-11-30T14:45:15.293

对于 rails3

获取列表

```
$ rails generate 
```

生成 spec_helper.rb

```
$ rails g rspec:install 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-09T14:01:57.533

它似乎对我有用。我已经安装了*rspec-rails*，运行了 rspec 生成器，当我给

```
$ script/generate 
```

我得到了生成器列表：

> 已安装的生成器 Rubygems：rspec、rspec_controller、rspec_model、rspec_scaffold 内置：控制器、集成测试、邮件程序、迁移、模型、观察者、性能测试、插件、资源、脚手架、会话迁移

*使用rspec_scaffold*生成脚手架后，规范通过。您的 Rails 项目中是否有供应商/生成器？我认为您应该删除它们并改用 gem 中的生成器。

# flash - 如何在现有的 Flash 演示文稿中找到自己的方式

> ID：418797
> 
> 赞同：4
> 
> 时间：2009-01-07T00:51:49.367
> 
> 标签：flash

我已经在 AS2 和 AS3 中完成了相当多的 Flash 和 Flex 编程（嗯，仅在 AS3 中使用 Flex :)。<self-definition>我已经让这些平台完全按照我的意愿行事。我已经在Flex等中构建了Flash组件并创建了一个MVC框架。</self-definition>

如果你递给我一个我从未见过的 Flex 应用程序并说“进行这些更改”，我知道从哪里开始理解该应用程序：从 Application 标签向下。它可能与某处的服务器进行了一些交互，一些回调等。或者与框架进行了一些交互。

如果你递给我一个 Java 应用程序，我也可以这样做：从前端到后端，或者通过方法调用倒退。

但是，如果你递给我一个 Flash 应用程序，我在第一个小时内完全迷失了方向，而我试图猜测它为什么会这样工作……如果它不能编译，我想我会永远迷路。这与嵌入在 MC 中的 MC 有关（其中一些是隐藏的！太棒了！），与代码无关。然后将代码分散在所有不同的帧、场景等中，以便只有原始开发人员知道什么时候触发。

当我做纯 Flash 时，我在组件中做所有事情并使用非常扁平的结构，但那是另一回事。我的问题是关于我得到的 Flash 演示文稿：

**当你得到一个现有的 Flash 演示文稿时，你是如何开始理解它的？你首先寻找什么，等等？对于第一次看到的 Flash 演示文稿，您有什么建议吗？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-07T08:24:28.627

好吧，如果给你一个 FLA，我要做的第一件事就是尝试了解应用程序的整体结构，首先是查看主（根）时间线。如果它看起来是空的，或者除了动作脚本什么都没有，那么很明显这是代码驱动的——阅读那个脚本或者寻找一个文档类，并假设这个库只是一个组件存储库。

如果根时间轴被填充，那么通常它要么是某种动画，意在播放，要么是状态管理系统，应用程序在更改显示状态时从帧移动到帧。如果是动画，那通常很简单，但您需要弄清楚它是直接播放还是跳跃（查找帧标签），尤其是完成后会发生什么。如果根时间线是一个状态机，那么你就可以开始运行了——你通常可以假设每个重要的帧（通常它们会有标签）在层次上是相等的，并或多或少地分别检查它们。还要注意基本上是状态机的内容，但在状态之间有过渡动画。

话虽如此，关于 Flash 创作的真正强大但令人困惑的事情是，每次您查看影片剪辑时，您都必须递归回两段并重新开始该过程，因为该 MC 本身可能是一个组件或显示状态机或动画。当您查看一堆电影剪辑时，您永远不会真正知道哪些包含微不足道的图形，哪些包含大量复杂性。所以你分而治之——对于任何给定的剪辑，找出它包含的所有重要的东西，然后弄清楚它们每个人在做什么。

更多随机提示：

*   学习使用电影资源管理器（PC 上的 alt+F3）来确定哪些剪辑包含动作脚本。您可能会看到很多琐碎的“停止”命令散布在各处，但如果有大块的逻辑，您想弄清楚它们做了什么，以及它们在对象层次结构中的位置。
*   如果您发现任何附加到电影剪辑的脚本，请为正义的战斗做好准备——您的日子不好过。幸运的是，这在 AS3 中是不允许的。
*   当很多东西混杂在一起时，尝试展开时间线中的所有文件夹并通过它们打开和关闭可见性以了解在哪里。图书馆可能杂乱无章，但至少在时间轴上，资产必须按照它们在视觉上重叠的相同顺序分层，这通常会为您提供线索。如果原始设计师没有将它们合理地组织到文件夹中。
*   偶尔进行一次“全选”以了解哪些事物是单独的对象以及是否有任何不可见的资产也是一个好主意。空剪辑或第一帧上没有任何内容的剪辑始终显示为一个小的白色圆圈，但 alpha 为 0 的剪辑根本不会显示，除非您选择它们​​，或打开轮廓模式（每个时间线层）。
*   When you see the small white circle that marks an empty clip, make sure to check it out. It might be a container for loading content into, or a clip with graphical assets but not on the first frame, or even a marker that other content will be aligned to. But you can bet that it's hiding some complexity from you.
*   If it ever seems like there's less in the root timeline than there should be, just for kicks open up the "Scene" panel. Some designers are crazy like that.

# javascript - ':'（冒号）在 JavaScript 中有什么作用？

> ID：418799
> 
> 赞同：192
> 
> 时间：2009-01-07T00:52:32.627
> 
> 标签：javascript

我正在学习 JavaScript，在浏览 jQuery 库时，我看到`:`（冒号）被大量使用。这在 JavaScript 中是做什么用的？

```
// Return an array of filtered elements (r)
// and the modified expression string (t)
   return { r: r, t: t }; 
```

* * *

## 回答 #1

> 赞同：267
> 
> 时间：2009-01-07T00:55:19.843

```
var o = {
    r: 'some value',
    t: 'some other value'
}; 
```

在功能上等同于

```
var o = new Object();
o.r = 'some value';
o.t = 'some other value'; 
```

* * *

## 回答 #2

> 赞同：110
> 
> 时间：2009-01-07T01:24:54.183

此外，冒号可用于标记语句。例如

```
var i = 100, j = 100;
outerloop:
while(i>0) {
  while(j>0) {
   j++

   if(j>50) {
     break outerloop;
   }
  }
i++

} 
```

* * *

## 回答 #3

> 赞同：78
> 
> 时间：2009-01-07T01:13:37.967

你们忘记了三元运算符中也使用了冒号（尽管我不知道jquery是否将它用于此目的）。

三元运算符是 if/then 语句的表达式形式（表达式返回值）。它是这样使用的：

```
var result = (condition) ? (value1) : (value2) ; 
```

三元运算符也可以用来产生副作用，就像 if/then 一样，但这是非常糟糕的做法。

* * *

## 回答 #4

> 赞同：49
> 
> 时间：2009-01-07T01:01:09.113

':' 基本上是键值对的分隔符。在您的示例中，它是 Javascript 对象文字符号。

在 javascript 中，对象是用冒号分隔属性标识符及其值定义的，因此您可以拥有以下内容：

```
return { 
    Property1 : 125,
    Property2 : "something",
    Method1 : function() { /* do nothing */ },
    array: [5, 3, 6, 7]
}; 
```

然后像这样使用它：

```
var o =  { 
    property1 : 125,
    property2 : "something",
    method1 : function() { /* do nothing */ },
    array: [5, 3, 6, 7]
};

alert(o.property1); // Will display "125" 
```

其中的一个子集也称为 JSON（Javascript 对象表示法），它在 AJAX 调用中很有用，因为它在服务器端语言中非常紧凑且可以快速解析，并且 Javascript 可以轻松地将 JSON 字符串反序列化为对象。

```
// The parenthesis '(' & ')' around the object are important here
var o = eval('(' + "{key: \"value\"}" + ')'); 
```

如果密钥包含某种特殊字符或空格，您也可以将密钥放在引号内，但我不建议这样做，因为它只会让事情变得更难处理。

请记住， JavaScript 语言中的[JavaScript Object *Literal* Notation](https://developer.mozilla.org/en/Core_JavaScript_1.5_Guide/Core_Language_Features#Object_Literals)不同于消息传递的 JSON 标准。两者的主要区别在于函数和构造函数不是[JSON 标准](http://json.org/)的一部分，但在 JS 对象字面量中是允许的。

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2009-01-07T01:00:21.003

它是对象字面量语法的一部分。基本格式是：

```
var obj = { field_name: "field value", other_field: 42 }; 
```

然后您可以通过以下方式访问这些值：

```
obj.field_name; // -> "field value"
obj["field_name"]; // -> "field value" 
```

您甚至可以将函数作为值，基本上为您提供对象的方法：

```
obj['func'] = function(a) { return 5 + a;};
obj.func(4);  // -> 9 
```

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2012-06-08T08:00:30.070

它可用于列出变量中的对象。此外，它还用于 if 语句的简写：

```
var something = {face: 'hello',man: 'hey',go: 'sup'}; 
```

并这样称呼它

```
alert(something.man); 
```

还有 if 语句：

```
function something() {  
  (some) ? doathing() : dostuff(); // if some = true doathing();, else dostuff();
} 
```

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2016-04-08T15:28:28.460

这些通常是在 JavaScript 中使用冒号 ':' 的场景

1- 声明和初始化一个对象

```
var Car = {model:"2015", color:"blue"}; //car object with model and color properties 
```

2- 设置标签（不推荐，因为它会导致复杂的控制结构和意大利面条代码）

```
List: 
while(counter < 50)
{
     userInput += userInput;
     counter++;
     if(userInput > 10000)
     {
          break List;
     }
} 
```

3- 在 Switch 语句中

```
switch (new Date().getDay()) {
    case 6:
        text = "Today is Saturday";
        break; 
    case 0:
        text = "Today is Sunday";
        break; 
    default: 
        text = "Looking forward to the Weekend";
} 
```

4- 三元运算符

```
document.getElementById("demo").innerHTML = age>18? "True" : "False"; 
```

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2011-06-07T10:57:57.717

我们不要忘记 switch 语句，在每个“case”之后使用冒号。

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2009-01-07T00:56:30.917

那是 JSON，或 JavaScript 对象表示法。这是描述对象或哈希映射的快速方法。冒号前面的是属性名，冒号后面的是它的值。所以在这个例子中，有一个属性“r”，它的值是变量 r 中的任何值。对 t 相同。

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2018-11-15T12:48:13.850

JavaScript 中冒号的另一种用法是重命名变量，即：

```
const person = { 
    nickNameThatIUseOnStackOverflow: "schlingel",
    age: 30,
    firstName: "John"
};
let { nickNameThatIUseOnStackOverflow: nick } = person; // I take nickNameThatIUseOnStackOverflow but want to refer it as "nick" from now on.
nick = "schling"; 
```

如果您使用的第三方库返回的值具有您想在代码中重命名的笨拙/长变量名称，这将非常有用。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2016-06-09T19:06:09.933

我不久前犯的一个愚蠢的错误可能对某些人有所帮助。

请记住，如果您在这样的事件中使用“：”，则该值不会改变

```
var ondrag = (function(event, ui) {
            ...

            nub0x: event.target.offsetLeft + event.target.clientWidth/2;
            nub0y = event.target.offsetTop + event.target.clientHeight/2;

            ...
        }); 
```

所以“nub0x”将使用第一个发生的事件进行初始化，并且永远不会改变它的值。但是“nub0y”将在接下来的事件中发生变化。

# .net - 如何开发Windows定时任务？

> ID：418809
> 
> 赞同：2
> 
> 时间：2009-01-07T00:59:10.507
> 
> 标签：.net, sql-server, scheduled-tasks

我需要一个流程，将日常数据编译成 PDF，然后附加到电子邮件中。我已经在正在开发的应用程序中使用 MSSQL 发送电子邮件，并希望继续使用 MSSQL 作为电子邮件处理器。

在我的研究中，我发现这可以通过创建 Windows 服务来实现。但是，因为我真的只希望这个过程每天运行一次；保持始终处于活动状态的 Windows 服务似乎有点过头了。

我从来没有使用任务调度程序来运行自建应用程序。我想确保我以正确的方式去做。据我了解，我将不得不...

1.  在 Visual Studio 中创建一个新项目（Project X）
2.  程序（项目 X）生成 PDF 并与 MSSQL 交互以发送电子邮件
3.  将（项目 X）构建成 EXE
4.  使用任务计划程序安排 EXE 以按我需要的任何计划运行。

有什么我应该关注的安全方面吗？只有我能想到的加密我的 MSSQL 连接字符串；当然，将 EXE 保留在 Web 应用程序所在的 Web 可访问目录之外。

提前感谢您的帮助/确认，因为我知道有些人会认为这是一个愚蠢的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T01:05:28.590

我可以看到您没有考虑的唯一一件事是任务计划程序将运行您的 EXE 的身份，但是看到您似乎如何控制环境中的所有内容，这应该不是太大的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T01:15:20.117

As Esteban notes: will this just be running under your account and will you just stay signed on to the machine? If so, *that* is your biggest security risk. You can use a screen saver to force a login prompt and it is largely true that this is no less secure than logging out. However, I doubt that this would be considered "best practices."

I would consider building a Windows Service that simply wakes up once a day. They are truly not very difficult to build although you'll want to be sure to have a good testing mechanism (an independent class that you compile into a Unit-testable dll is a good idea) since testing them once they are running is very difficult. But don't let the "mystery" of service apps or the idea of resource usage put you off. You'll be surprised how easy they are. As far as resources go...you are spending more resources keeping a full Winforms app running!

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T01:08:06.167

如果要构建 Windows 服务，可以将其设置为在服务器（数据库所在的服务器）启动时启动。我有一个用于发送电子邮件的外部跟踪系统，可能在一个单独的数据库中。当服务器启动时，您的服务也会启动。服务检查今天是否已发送电子邮件。如果没有，请构建电子邮件，发送电子邮件，然后在日志中标记它（我假设的 db 表）。然后让服务休眠 24 小时，然后让它再次检查（使用事件）。重复。

# linux - 运行多线程应用程序的新四核处理器中的 linux 内核有多好

> ID：418815
> 
> 赞同：4
> 
> 时间：2009-01-07T01:03:20.717
> 
> 标签：linux, multithreading, kernel, multicore

这里有没有人在新的四核处理器中运行多线程应用程序的 linux 线程调度程序方面有经验？如果有这样的人，您可以在这里写下您对内核管理不同线程的性能如何的经验，您是否经历过任何线程饥饿或其中一个内核的饥饿？

谢谢你。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-12T10:06:56.227

鉴于像 Christoph Lameter（以及调度程序上的 Ingo Molnar）这样的内核开发人员已经将内核调整为在 4096 处理器上运行良好，并且考虑到英特尔自己在该问题上投入的优化量，针对性能和节能进行了多核特定调整，我敢打赌，内核比我们任何人在用户空间中编写的任何东西都要优化得多。

线程库也一样；目前只有一个线程库，用于 Linux 2.6 的 NPTL。LinuxThreads 在 2.4 版本中从 glibc 中删除，而 NPTL 是在 2.6 版本之前产生的。而且它真的很快。

只要确保避免使用旧内核，您的发行版或 kernel.org 的最新版本是最好的。在生产中部署之前，请确保衡量性能差异，并考虑是否值得额外的支持成本（如果有）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-07T01:10:50.297

Linux 本身很好地支持使用许多处理器。如果我没记错 SMP，Linux 支持 4096 处理器。真正会产生影响的是您的*应用程序*是否是为利用多个处理器而编写的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T02:41:07.027

它在我们正在生产的双四核系统 (V8) 上运行良好……快得要命。

但是当锁（互斥体）受到激烈竞争时，要非常警惕 Linux 的线程饥饿倾向。想象一个场景，当 10 个线程使用一个锁时，需要非常频繁地使用锁，但时间很短，*并且*在任何给定点在锁之外完成的工作少于时间片。Linux 将非常倾向于几乎总是将锁传递给一个线程，而排除所有其他线程。

这也取决于绑定到内核中的特定线程包 - 我相信有几个。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-07T02:48:09.227

我在我们的 Intel Q6600 上获得了绝对惊人的结果，无论是并行构建还是其他一些并行应用程序，但我一直小心避免过多的并行性：我通常在四到八个线程之间分叉，所以没有太多的争论。如果你分叉了足够多的线程，你将有明显的开销，尤其是当它们竞争相同的信号量时。我的猜测是，几千个线程可能太多了，几十个线程可能还可以。但这只是一个猜测；如果你想知道，你必须找到测量过的人，或者你必须自己做一个实验。

但是对于十几个线程，我们的结果非常好。

# c# - RNGCryptoServiceProvider 的优缺点

> ID：418817
> 
> 赞同：73
> 
> 时间：2009-01-07T01:04:36.050
> 
> 标签：c#, .net, random

`System.Security.Cryptography.RNGCryptoServiceProvider`使用vs的优缺点是什么`System.Random`？我知道这`RNGCryptoServiceProvider`是“更随机的”，即黑客更难以预测。还有其他优点或缺点吗？

* * *

**更新：**

`RNGCryptoServiceProvider`根据回复，以下是迄今为止使用的利弊：

### 优点

*   `RNGCryptoServiceProvider`是一个更强的密码随机数，这意味着它会更好地确定加密密钥等。

### 缺点

*   `Random`更快，因为它是一个更简单的计算；当用于加密随机性不重要的模拟或长时间计算时，应该使用它。注意：有关模拟的详细信息，请参阅[Kevin 的回答](https://stackoverflow.com/a/54847919/9536)`Random`-不一定足够随机，您可能希望使用不同的非加密 PRNG。

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2009-01-07T01:11:45.973

加密强的 RNG 会更慢 --- 它需要更多的计算 --- 并且会是光谱白色，但不太适合模拟或 Monte Carlo 方法，因为它们*确实*需要更多时间，而且因为它们可能不可重复，这很适合测试。

通常，当您需要一个唯一编号（如 UUID）或作为加密密钥以及用于速度和模拟的确定性 PRNG 时，您希望使用加密 PRNG。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2010-02-02T00:56:16.117

`System.Random`不是线程安全的。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-01-07T01:29:02.913

是的，只有一个。正如查理马丁所写`System.Random`的那样更快。

我想添加以下信息：

这`RNGCryptoServiceProvider`是符合安全标准的随机数生成器的默认实现。如果出于安全目的需要随机变量，则必须使用此类或等效类，但不要使用 System.Random，因为它具有高度可预测性。

对于所有其他用途，欢迎使用更高性能的`System.Random`和等效类。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2019-02-24T01:30:19.010

除了之前的答案：

`System.Random`永远**不要**用于科学和工程的模拟或数值求解器，因为不准确的模拟结果或收敛失败会产生重大的负面后果。这是因为微软的实现在几个方面*存在严重缺陷*，由于兼容性问题，他们无法（或不会）轻易修复它。看到 [这个帖子](https://stackoverflow.com/questions/31916419/what-is-the-quality-of-random-class-implementation-in-net)。

所以：

*   **如果有一个对手不应该知道生成的序列**，则使用`RNGCryptoServiceProvider`或其他精心设计、实施和验证的加密强 RNG，并尽可能使用硬件随机性。<em>否则；

*   **如果它是需要良好统计属性的模拟等应用程序**，则使用精心设计和实现的非加密 PRNG，例如[Mersenne Twister](https://en.wikipedia.org/wiki/Mersenne_Twister)。（在这些情况下，加密 RNG 也是*正确*的，但通常太慢且笨拙。）<em>否则；

*   ***仅*当数字的使用完全不重要**时，例如决定在随机幻灯片中接下来显示哪张图片，然后使用`System.Random`.

* * *

我最近在进行蒙特卡罗模拟时非常明显地遇到了这个问题，该模拟旨在测试医疗设备不同使用模式的影响。模拟产生的结果与合理预期的*方向相反。*

> *有的时候你说不出来，背后是有原因的，而且这个原因可能很麻烦！*

这是在越来越多的模拟批次中获得的*p值图：*

[![使用 <code>System.Random</code> 时输入和输出 _p_-values](https://i.stack.imgur.com/mIjdv.png)](https://i.stack.imgur.com/mIjdv.png)

红色和洋红色图显示了两个使用模型在研究中的两个输出指标中差异的统计显着性。

青色图是一个特别令人震惊的结果，因为它代表模拟随机*输入特征的**p值。*（绘制此图只是为了确认输入没有错误。）当然，在研究中的两个使用模型之间，输入在设计上是相同的，因此两个模型的*输入*之间不应该有任何统计学上的显着差异. 然而，在这里，我看到了超过 99.97% 的信心，即存在 **如此**大的差异！！

 ****最初我认为我的代码有问题，但一切都检查了。（特别是我确认线程没有共享`System.Random` 实例。）当重复测试发现这个意想不到的结果高度一致时，我开始怀疑 `System.Random`.

我`System.Random`用 Mersenne Twister 实现替换了——没有其他变化——然后输出立即变得截然不同，如下所示：

[![切换到更好的 PRNG 后输入和输出 _p_-values](https://i.stack.imgur.com/JqCjF.png)](https://i.stack.imgur.com/JqCjF.png)

此图表反映了在此特定测试集中使用的参数的两种使用模型之间没有统计学上的显着差异。这是一个预期的结果。

请注意，在第一个图表中，垂直对数刻度（在*p*值上）涵盖了**7 个十年**，而第二个只有一个十年——这表明虚假差异的统计显着性是多么显着！（垂直刻度表示差异可能是偶然出现的概率。）

我怀疑正在发生的事情是`System.Random`在一些相当短的生成器周期内有一些相关性，并且两个被测模型之间的内部随机抽样的不同模式（对 的调用数量大不相同 `Random.Next`）导致这些以不同的方式影响两个模型.

碰巧模拟*输入*来自与模型用于内部决策的相同 RNG 流，这显然导致这些采样差异影响输入。（这实际上是一件幸运的事情，否则我可能没有意识到意外的结果是软件故障，而不是被模拟设备的某些真实属性！）

# asp.net - ASP.NET - 括号中的负数

> ID：418822
> 
> 赞同：4
> 
> 时间：2009-01-07T01:06:02.850
> 
> 标签：asp.net, web-config, cultureinfo

我的应用程序当前将负数显示为 -1。用户已经改变了要求（只是为了改变！），现在我们必须将数字显示为 (1)。我可以为整个应用程序启用它，比如更改 web.config 甚至应用程序的 CultureInfo 吗？由于我们有很多包含数字验证器的页面，这样做有什么副作用吗？

谢谢 ！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-07T02:54:23.333

对于货币来说，这真的很容易：

```
String.Format("{0:C}", value) 
```

这将使用系统的文化信息。

对于数据绑定的普通数字，请使用[Mark Glorie 的示例](https://stackoverflow.com/questions/418822/asp-net-negative-numbers-in-parenthesis#419012)。

[MSDN 文章](http://msdn.microsoft.com/en-us/library/fht0f5be.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-07T01:18:50.077

我会使用字符串格式。对应用程序的配置进行更改以满足 UI 要求是很严厉的。SteveX 写了一篇[很棒的](http://blog.stevex.net/index.php/string-formatting-in-csharp/)关于字符串格式化的博文。它还与标记 (aspx) 兼容，而不仅仅与代码相关。

从他的帖子：

```
String.Format(”{0:$#,##0.00;($#,##0.00);Zero}”, value);

    This will output “$1,240.00″ if passed 1243.50\. It will output the 
    same format but in parentheses if the number is negative, and will
    output the string “Zero” if the number is zero. 
```

这不是你想要的，但它很接近。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-09-05T07:29:14.447

检查这个.. [http://msdn.microsoft.com/en-us/library/91fwbcsb.aspx](http://msdn.microsoft.com/en-us/library/91fwbcsb.aspx)

将指定样式的数字的字符串表示形式转换为其等效的十进制。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T01:21:55.953

```
String.Format(”{0:f;(f);0”, -1); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T02:43:56.427

我已将以下页面添加为用于进行字符串格式化的书签：http: [//idunno.org/archive/2004/14/01/122.aspx](http://idunno.org/archive/2004/14/01/122.aspx)

大约一半下来，它给出了答案：

```
String.Format("{0:£#,##0.00;(£#,##0.00);Nothing}", value); 
```

为了回答您的其他问题，出于其他答案中给出的原因，我不会修改 app.config 以使其全局化。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-03-04T00:24:09.350

这行得通。

```
DataFormatString="{0:c0}" 
```

*   括号中的负数
*   千位分隔符 - 逗号
*   $符号在前面

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-01-07T01:08:40.737

您总是可以编写自己的自定义 ToString() 方法作为扩展方法，但就像您提到的那样，使用 CultureInfo 可能更好。看看这里：

[http://msdn.microsoft.com/en-us/library/system.globalization.numberformatinfo.numbernegativepattern.aspx](http://msdn.microsoft.com/en-us/library/system.globalization.numberformatinfo.numbernegativepattern.aspx)

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-01-07T02:40:09.587

您是否在 Gridview/Datagrids 中显示您的数据？如果是这样，那么可以对每个绑定列应用格式化，例如：

```
<asp:BoundField DataFormatString="{##;(##)}"/> 
```

这仅适用于整数但是...

# python - Python 3.0 是否有任何图形/绘图/类似的库？

> ID：418835
> 
> 赞同：3
> 
> 时间：2009-01-07T01:12:41.713
> 
> 标签：python, python-3.x, plot, graphing, scatter-plot

按照标题。我正在尝试创建一个简单的散点图，但还没有找到任何可以做到的 Python 3.0 库。请注意，这不适用于网站，因此网络版有点没用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T20:32:30.887

也许您可以使用 Python Imaging Library (PIL)。也看看 PyX，但这个库是为了输出到 PDF，......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-21T21:36:59.140

GChartWrapper ( [http://pypi.python.org/pypi/GChartWrapper/0.7](http://pypi.python.org/pypi/GChartWrapper/0.7) ) 确实适用于 py3k

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T01:22:17.043

你看过谷歌图表包装器吗？

[http://pypi.python.org/pypi/GChartWrapper/0.7](http://pypi.python.org/pypi/GChartWrapper/0.7)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T08:10:37.047

我会从 Python调用[Gnuplot 。](http://gnuplot-py.sourceforge.net)无需在 Python 中重新发明轮子，Gnuplot 已经存在并且已经有了 Python 接口。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-01-04T18:56:23.800

[matplotlib](https://github.com/matplotlib/matplotlib)的当前开发版本应该可以在 Python 3 上运行。

# oop - 设计问题 - 将图像存储为对象

> ID：418841
> 
> 赞同：0
> 
> 时间：2009-01-07T01:14:54.110
> 
> 标签：oop, object

好的，所以我的网站以大量动态用户输入图像为中心，用于不同的用户定义对象。所以我有很多对象，这些对象有图像。

由于“图像名称”和“图像字节”列重复多次，因此将图像视为对象是否是一种好习惯？或者将这两列包含在每个对象的表中是否更明智。

我想我是在打字时回答自己的问题......我正在创建一个额外的连接和一个额外的列（每个表上会有三个名称、ID 和 ImageId）

但是，有几个表，每个对象都有多个图像......所以我想它会更好？？？？意见？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-07T01:20:07.050

我通常有一个文件表，可以更通用地存储文件。然后在您的其他表中，您可以为每个图像（文件）设置一个列，这只是对文件表的引用。

您的文件表将包含所有正常的东西，如 ID、文件名、大小、类型等。然后是的，您只需加入它即可获得您正在运行的任何查询所需的内容。

如果有任何疑问 - 我强烈建议您不要将文件直接存储在数据库中。我不认为那是你的追求，但如果其他人有这个想法 - 只是不要这样做！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-07T01:22:00.710

要问的问题是“我是否有多个具有相同图像的对象”。如果是这样，那么您可能需要考虑冗余。另外，您使用的数据库是否能很好地处理“blob”？还是保留图像的文件路径并单独存储图像会更好>

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T01:23:35.280

直觉上，我会发现将图像和对象作为单独的概念处理更容易。只是感觉更灵活。

如果您需要将除图像之外的其他内容附加到特定对象，则只需将对象表条目与“其他事物”表条目相关联即可，尽管您可能必须交换外键指向的方式。它还使您能够在其他用户对象中使用这些图像，或者允许用户借用其他用户的图像。

这种方法的缺点是你会因为需要将一个或多个表连接在一起而付出一些性能损失。但是，如果您的数据库查询分析器相当聪明，那么这可能不是最大的交易。

# asp.net-mvc - 单元测试 aspx 视图

> ID：418842
> 
> 赞同：3
> 
> 时间：2009-01-07T01:14:59.383
> 
> 标签：asp.net-mvc, unit-testing

是否有合适的方法使用 aspx 视图引擎对视图进行单元测试？

我一直在尝试各种方法，让我得到一个可解析的字符串，结果如下：

```
view.RenderView(viewContext); 
```

但到目前为止我没有任何运气。

我读过的大部分内容都进入了集成测试领域。集成测试重叠很多，但不允许我使用虚拟数据来检查输出，这是我试图通过单元测试视图实现的主要目标。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T19:32:42.007

你检查过[硒](http://seleniumhq.org/)吗？它针对 Web UI 测试，并在 Hunt 和 Thomas*[在 C# 中使用 NUnit 进行实用单元测试中进行](https://rads.stackoverflow.com/amzn/click/com/0977616673)*了讨论。它使用 NUnit，尽管它的方式实际上更像是系统测试而不是单元测试（仅仅是因为您必须打开 Web 应用程序并导航到您的页面进行测试）。抱歉，我在之前的回答中没有走这条路，但昨天早上我有点着急！

还有 NUnitAsp，但该项目基本上已被放弃。它可以工作并且在当时受到广泛赞誉，但我不愿意推荐任何不再处于积极开发中的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-07T01:30:00.273

我所做的是创建对象来“驱动”用户界面并将它们全部放入“BusinessObjects”dll 中。当需要创建接口时，接口本质上是从这些对象中提取结果。然后，我使用标准 NUnit 单元测试针对业务对象进行单元测试。恐怕您的问题可能更具体到 MVC 框架，但我希望这能给您一些思考的余地。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-28T21:09:04.890

我的建议是不要打扰。坚持测试模型和控制器。检查特定的 HTML 只会导致脆弱的测试基础，一旦您对布局进行最轻微的更改，就会破坏。

# c# - C#：线程安全的richtextbox事件记录方法？

> ID：418845
> 
> 赞同：5
> 
> 时间：2009-01-07T01:15:56.417
> 
> 标签：c#

我有一种方法可以在表单中的 RichTextBox 上显示输出。

```
 public void LogTextEvent(RichTextBox TextEventLog, Color TextColor, string EventText)
    {
        string nDateTime = DateTime.Now.ToString("hh:mm:ss tt") + " - ";

        // color text.
        TextEventLog.SelectionStart = TextEventLog.Text.Length;
        TextEventLog.SelectionColor = TextColor;

        // newline if first line, append if else.
        if (TextEventLog.Lines.Length == 0)
        {
            TextEventLog.AppendText(nDateTime + EventText);
            TextEventLog.ScrollToCaret();
            TextEventLog.AppendText(System.Environment.NewLine);
        }
        else
        {
            TextEventLog.AppendText(nDateTime + EventText + System.Environment.NewLine);
            TextEventLog.ScrollToCaret();
        }
    } 
```

当我从线程内运行的另一个方法调用 LogEventText() 时出现问题：

```
 Thread thListening = new Thread(new ThreadStart(StartListening));
            thListening.Start(); 
```

在 StartListening 方法中（它是一个线程，用于处理为小型 http 服务器的主侦听套接字上的客户端创建的新 tcp 套接字），我使用 LogTextEvent 记录一些数据，但我收到 InvalidOperationException 未处理错误在第 2 行的 LogTextEvent 方法中，TextEventLog.SelectionStart = TextEventLog.Text.Length;

错误显示，跨线程操作无效：控件“rchEventLog”从创建它的线程以外的线程访问。

任何人都可以帮助分解发生了什么，为什么以及如何修复错误？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-07T01:36:15.223

尝试这样的事情：

```
public void LogTextEvent(RichTextBox TextEventLog, Color TextColor, string EventText)
{
    if (TextEventLog.InvokeRequired)
    {
        TextEventLog.BeginInvoke(new Action(delegate {
            LogTextEvent(TextEventLog, TextColor, EventText);
        }));
        return;
    }

    string nDateTime = DateTime.Now.ToString("hh:mm:ss tt") + " - ";

    // color text.
    TextEventLog.SelectionStart = TextEventLog.Text.Length;
    TextEventLog.SelectionColor = TextColor;

    // newline if first line, append if else.
    if (TextEventLog.Lines.Length == 0)
    {
        TextEventLog.AppendText(nDateTime + EventText);
        TextEventLog.ScrollToCaret();
        TextEventLog.AppendText(System.Environment.NewLine);
    }
    else
    {
        TextEventLog.AppendText(nDateTime + EventText + System.Environment.NewLine);
        TextEventLog.ScrollToCaret();
    }
} 
```

如果从富文本框的 UI 线程以外的线程调用 LogTextEvent 方法，它将向 UI 线程发送一条消息，这将导致在该线程中调用 LogTextEvent 方法。

通过使用 BeginInvoke 而不是 Invoke，它是异步发布的，这意味着它会立即返回给调用者，而不是等待在另一个线程上执行该方法。对于这样的日志记录场景，这可能是您想要的。如果您需要从控件或其他东西中获取值，则可能需要使用 Invoke 代替。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2009-01-07T01:27:15.287

```
new Thread(new ThreadStart(delegate {
    //do some worker-thread processing here
    ...
    //now update the gui from within the gui thread
    MyRichTextBox.Invoke(new Action(delegate {
        MyRichTextBox.SelectionStart = CalculateTheSelectionStart();
    }));
})).Start(); 
```

# perl - 如何使用 Perl 编辑 Kerberos 5 配置文件？

> ID：418859
> 
> 赞同：4
> 
> 时间：2009-01-07T01:22:40.273
> 
> 标签：perl, configuration-files, kerberos, cpan

有没有人遇到过会解析（和编写）kerberos 配置文件（即`/etc/krb5.conf`）的 Perl 模块？我看过很多解析模块，如[Config::General](http://search.cpan.org/dist/Config-General)、[Config::Auto](http://search.cpan.org/dist/Config-Auto)等，但似乎没有一个能够处理如下嵌套结构：

```
pam = {
  debug = false
  ticket_lifetime = 36000
  renew_lifetime = 36000
  forwardable = true
  krb4_convert = false
} 
```

它还需要处理`INI`-style 部分，例如：

```
[domain_realm]
 .example.com = EXAMPLE.COM
 example.com = EXAMPLE.COM

[appdefaults]
 pam = {
   debug = false
   ticket_lifetime = 36000
   renew_lifetime = 36000
   forwardable = true
   krb4_convert = false
 } 
```

有关格式的更多详细信息，请[参阅 krb5 conf 文档](http://www.daemon-systems.org/man/krb5.conf.5.html)

我正在编写自己的解析器，但如果其他人已经编写了一个漂亮、优雅的模块，我宁愿不必这样做。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-07T01:51:07.407

我想如果写一个解析器需要大约 10 分钟，把它变成一个模块可能就没那么有趣了。这是一段可能完成这项工作的代码（免责声明：我对 Kerberos 的配置格式一无所知，代码基于您在此处发布的内容）。

```
#!/usr/bin/perl -w
use strict;

my %conf;
my $section;

while (<>) {
    if (/^\s*(\S*)\s*=\s*\{\s*$/) {
        $section = $1;
        $conf{$section} = {};
    } elsif (/^\s*(\S*)\s*=\s*(\S*)\s*$/) {
        my $key = $1;
        my $value = $2;
        if ($section) {
            $conf{$section}{$key}=$value;
        }
    }
}

foreach (keys %conf) {
    $section = $_;
    foreach (keys %{$conf{$section}}) {
        print "$section:$_:$conf{$section}{$_}\n";
    }
} 
```

编辑：解析ini格式也不难。您只需要在 while 循环中添加更多 if，并使数据结构 %conf 稍微复杂一些。您将需要哈希的哈希而不是哈希的哈希，其中第一级键是 [...] 中的关键字，第二级是我在这里写的（对于“pam = {”）。

# vb.net - 使用 vb.net 查看底层 SOAP 消息

> ID：418877
> 
> 赞同：4
> 
> 时间：2009-01-07T01:33:45.243
> 
> 标签：vb.net, soap, service

我有一个调用第三方 Web 服务的 VB.NET Web 服务。如何在 .NET 生成的 SOAP 消息发送到第三方 Web 服务之前查看它，以及如何在 .NET 序列化之前查看 SOAP 响应。

创建独立 EXE 时，我看到自动生成的 Reference.vb 文件，但当我的项目是 Web 服务时，看不到类似的文件。我发现很多 C# 代码可以做到这一点，但在 VB.NET 中没有。

编辑 - Fiddler 和 TCP 记录器很棒，但不适用于我的目的。我需要能够从应用程序中访问原始 SOAP 消息，以便记录或修改它们。我需要做的不仅仅是查看消息来回传递。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T01:36:29.107

您可以使用 fiddler 或 tcp 嗅探器来过滤和识别主机上的所有传出和传入流量。

这是如果您想查看 xml 请求和响应。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-18T14:47:14.770

使用扩展来检查 SOAP 消息怎么样？

在 ASP.NET Web 服务中访问原始 SOAP 消息 [http://msdn.microsoft.com/en-us/magazine/cc188761.aspx](http://msdn.microsoft.com/en-us/magazine/cc188761.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-04-12T16:04:25.147

我试图做同样的事情，这似乎对我有用：

```
Dim message As String = OperationContext.Current.RequestContext.RequestMessage.ToString() 
```

我不认为这会那么容易，因为大多数时候`ToString()`都会返回类的名称，但我试了一下，低调看。

我知道你在一月份问过这个问题，所以如果从那以后你找到了更好的方法，请告诉我。

请注意，如果您在实现的类中捕获异常，`IErrorHandler`则必须从`ProvideFault()`方法而不是方法中执行此操作，`HandleError()`因为上下文在调用`HandleError()`方法之前已关闭。

希望这可以帮助。

# vb.net - 命令行编译 Settings.settings 使用 VBC

> ID：418878
> 
> 赞同：0
> 
> 时间：2009-01-07T01:34:43.570
> 
> 标签：vb.net, command-line, vbc

[对于我较早的一个问题，涉及 VBC 和 NAnt 与 WinForms](https://stackoverflow.com/questions/417261/vbc-nant-error-compiling-winform)，我已经想出了一个更好的方式来说明这一点。

在 vbproj 文件中，您具有以下内容：

```
<ItemGroup>
  <None Include="My Project\Settings.settings">
    <Generator>SettingsSingleFileGenerator</Generator>
    <CustomToolNamespace>My</CustomToolNamespace>
    <LastGenOutput>Settings.Designer.vb</LastGenOutput>
  </None>
</ItemGroup>
<ItemGroup>
  <Content Include="My Project\Application.myapp">
    <Generator>MyApplicationCodeGenerator</Generator>
    <LastGenOutput>Application.Designer.vb</LastGenOutput>
  </Content>
</ItemGroup> 
```

当从 Visual Studio 中运行构建（Debug Verbosity 设置为 Normal）时，产生的行之一是：

```
Target CoreCompile:
    C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Vbc.exe ... 
```

其中包括运行 vbc.exe 所需的所有设置。但是，从 Visual Studio 中获取该字符串，并直接在命令行上运行它会产生：

```
... My Project\Settings.Designer.vb(67) : error BC30002: Type 'My.MySettings' is not defined.
        Friend ReadOnly Property Settings() As Global.My.MySettings
...\My Project\Settings.Designer.vb(69) : error BC30456: 'My' is not a member of '<Default>'.
                Return Global.My.MySettings.Default 
```

如何让上述生成器从命令行运行，或者是否有一个调用会生成 vbc.exe 正确运行命令字符串所需的正确临时文件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-07T03:11:41.520

在 Visual Studio 中查看构建字符串的问题在于它实际上并没有调用 vbc.exe 来从 Visual Studio 构建。Visual Studio 中的所有构建都使用内存编译器而不是命令行编译器进行（对于 C# 也是如此）。

看起来像 vbc.exe ... 的命令是生成的字符串，实际上并未执行。如果您想找出正确的字符串来构建您的项目，请从 Visual Studio 命令提示符运行以下代码。

msbuild /v:diag myproject.vbproj

这将生成一个 msbuild 日志文件（它会很长，所以我建议通过管道传输到文件）。构建完成后，在该文件中搜索 vbc.exe。它将具有构建项目所需的实际命令行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-01-27T23:00:25.120

我今天花了一些时间来解决这个问题。我想知道关于如何让 vbc 编译器在“我的”命名空间中正常工作的正确答案，但我设法让我的 NAnt 脚本使用 NAnt contrib (http://nantcontrib.sourceforge.网/）。

NAnt contrib 允许您使用 .NET msbuild 进行构建，它至少允许我设置自动构建、通知等。它并没有提供我想要的非常精细的控制，但它达到了它的目的。

这个任务的参考是：

[http://nantcontrib.sourceforge.net/release/latest/help/tasks/msbuild.html](http://nantcontrib.sourceforge.net/release/latest/help/tasks/msbuild.html)

以及我的构建脚本中的相关片段：

```
<target name="build" depends="clean">
     <msbuild project="ProjectName.vbproj" />
</target> 
```

我在 CS 应用程序中使用了很多 NAnt，但这是第一次用于 VB.NET 应用程序。

# c++ - 导出类的客户端不使用 dllimport 时的问题？

> ID：418879
> 
> 赞同：1
> 
> 时间：2009-01-07T01:35:20.217
> 
> 标签：c++

除了方法调用没有优化外，还有其他问题吗？

我注意到的一个区别是，类中的默认编译器生成方法（例如 operator=）出现在导出 dll 中（如果客户端使用 dllimport）或客户端二进制文件中（如果不使用 dllimport）。在后一种情况下，就好像类的一部分是在 dll 中定义的，而一部分是在客户端的二进制文件中定义的。这有什么问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-08T10:51:55.490

我假设在这两种情况下，类实现都驻留在 DLL 中，对吗？

在这种情况下我可以看到的主要问题是，如果编译器生成的赋值运算符分配任何内存，即使是通过调用其他复制构造函数或赋值运算符间接分配，内存可能会分配在“错误”堆（客户端的堆而不是 DLL 的堆，如果赋值运算符驻留在 DLL 中，它们将被分配到堆中）。这可能导致内存泄漏和偶尔难以调试的问题。

也就是说，如果您的对象“足够琐碎”以至于您真的不需要编写自己的复制构造函数和赋值运算符（和析构函数 - 请参阅[三的规则](http://en.wikipedia.org/wiki/Rule_of_three_(C%2B%2B_programming))），那么您很可能会侥幸逃脱，尤其是如果您只扔几个 POD。

# c++ - 用分配的最后一个值覆盖数组？

> ID：418887
> 
> 赞同：3
> 
> 时间：2009-01-07T01:41:14.727
> 
> 标签：c++, arrays, pointers

我有一个指向指针数组的指针。我在下面的while循环中分配每一行，while循环内的printf显示每个都分配了我的id号1-20。
之后，在 while 循环之外，我遍历数组，每个元素都用 id 20 编写？
任何帮助是极大的赞赏。（仅供参考-我使用的是 Template2doc 库和 example1.c，位于此处的底部-http [://www.algonet.se/~thunberg/template2doc/c_version/docs/index.htm](http://www.algonet.se/~thunberg/template2doc/c_version/docs/index.htm)）

下面的代码只显示了问题区域，其余的我都拿出来了。

```
 char **tableData[500]={NULL};         
    char *myData[500][2]; 

while(rc == SQLITE_ROW){
    tableData[r] = myData[r];
    printf(*tableData[r]); <-- Displays id 1-20 fine
    r=r+1;
}//end while 

tableData[r+1] = NULL;//null terminated array

for (a=0; a<r; a++){
    printf("\n");
    printf(*tableData[a]);  <--Displays 20 elements all of id 20?
}

outputFile=insertTableData(outputFile, dataMarker, fieldMarker, tableData); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-08T06:41:03.907

正如所指出的，您在 r+2 位置分配 Null 。您是否以任何方式在 while 和 for 循环之间修改 tableData 或 myData ？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-09T14:33:07.690

您如何填充 myData？我在给出的代码示例中没有看到明显的错误，但我怀疑问题是您在 myData 中分配了一个指向缓冲区的指针，而没有实际复制内容，因此 myData[0 .. r] 都指向相同的缓冲区，它将只存储最近读取的值。试试这个：

```
while(rc == SQLITE_ROW){
        tableData[r] = myData[r];
        if (r > 0)
            printf(*tableData[r-1]);
        r=r+1;
}//end while 
```

那应该可以打印从 1 到 19 的 id。如果它从 id 2 而不是 id 1 开始，这表明 myData 没有保留数据的副本，它都指向同一个位置。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-09T14:35:45.373

您应该创建一些实际编译和重现问题的东西。它不仅会帮助人们帮助你，而且这样做你很可能会自己发现问题。

在您的代码摘录中，我们不知道：

*   rc 是什么，它的值是如何设置的，或者它的值将如何改变并因此终止循环
*   r的初始值是多少
*   myData 的实际内容是什么

我根据您发布的内容创建了这段代码，这两个循环产生了相同的输出。所以要么我错过了你发布的内容，要么你遗漏了一些重要的东西。

```
int main( int argc, char** argv ) {

#define STRING  char *

STRING  dummy = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ!@#$%^&*()";

STRING *tableData[500]={0};         
STRING myData[500][2];

int r=0;

while(r < 20){
        myData[r][0] = dummy+2*r;
        myData[r][1] = dummy+r;
        tableData[r] = myData[r];
        printf(*tableData[r]);
        printf("\n");
        r=r+1;
}//end while 

int a;

for (a=0; a<r; a++){
        printf(*tableData[a]);
        printf("\n");
}

} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-07T23:29:20.157

好吧，从我现在可以看到的情况来看，您正在从您最后的“双重”信息中终止您的 tableData 基本上是 r+2 。此外，如果您在 printf'ing 时执行了 tableData[0][1] 或 tableData[0][2] 可能会更清楚一些（可能只是对我而言）。这种方式更清楚地表明 tableData 是 2 的“结构”的索引，每个结构都包含一个以 NULL 结尾的字符串。这也可能有助于您的调试......

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-09T11:30:27.393

试试这个进行调试：

```
printf("Character at 0x%x : %d", tableData[a], *tableData[a]); 
```

可能是你取出的错误？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-12T19:05:50.507

是的，所有这些都指向完成时的最后一个值。我继续为每个项目分配内存空间，并相应地指向每个项目。

# memory - 在现有程序中查找和使用内存偏移量？

> ID：418893
> 
> 赞同：5
> 
> 时间：2009-01-07T01:44:09.323
> 
> 标签：memory, automation, reverse-engineering

大多数游戏机器人应用程序使用他们为特定版本的游戏客户端找到的一系列内存偏移来促进机器人机器人。它们可能具有健康、x/y 位置等的内存偏移量。每次游戏发布更新时，机器人程序使用的各种信息的偏移量也必须重新查找和更新。

我有兴趣将 Solitaire 机器人作为宠物项目编写。如果你看这里，mmoglider（一个商业机器人）已经完成了这个，作为他们的机器人程序（通常用于机器人 WoW）的演示：[MMOGlider botting Vista Solitaire 的 YouTube 视频。](http://ca.youtube.com/watch?v=f7Oy9fOwyr4)

准确定位各种有用内存偏移的常用方法是什么？我如何才能找到指向纸牌程序中“甲板”的内存偏移量并使用它来确定堆栈上的卡片？我从滑翔机人员的经验中知道，一旦他们能够找到套牌本身的偏移量，他们就会说整个套牌的每张卡值都在那里。

***那么，有没有人有逆向工程和从现有程序中提取内存偏移的经验？一旦你有了这些偏移量，如何能够从内存中的“Deck”结构中提取和读取值？***

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-07T02:17:05.717

通常有两种方法来完成此类任务。为简单起见，让我们考虑一个玩家的“健康”为整数的游戏。

第一种是在程序运行时操作进程内存。这对于查找已知值很有用。当您在游戏中拥有 100 点生命值时，在内存空间中搜索 100（很可能是整数）并记录找到的每个位置。然后，当您的健康状况变为 99 时，交叉搜索这些相同的位置以查看哪些位置发生了适当的变化。继续，直到您缩小了健康变量的精确位置。在大多数现代游戏中，您实际上会发现一个动态分配的内存地址，它是结构的一部分。该结构将由程序中的指针引用，然后您必须在程序内存中搜索可能是指向健康变量附近空间的指针的值，并在多个游戏运行中重复缩小过程，以确定指向所需数据的指针的位置。这是对经典 PC 和主机游戏最有用的方法，尤其是任何内存空间小且易于操作的游戏。

第二种方法要求您反汇编应用程序二进制文件（我为此使用[IDA Pro](http://www.hex-rays.com/idapro/)），然后找到已知使用所需数据的函数。例如，假设您在屏幕上看到“健康：99”。在二进制文件中搜索“Health:”字符串，然后找到对该字符串的引用（您可能会找到对 sprintf 或类似的调用）并查看这些相同函数引用的其他内存位置，这通常会引导您找到“health”变量或包含它的结构。这是更现代的游戏中最常见的方法，具有大量的内存空间和更高级的编程实践。

# c - 如何完成 K&R 练习 2-4？

> ID：418894
> 
> 赞同：2
> 
> 时间：2009-01-07T01:44:18.560
> 
> 标签：c, string, kernighan-and-ritchie

我正在学习如何使用 k&r 书（C 编程语言）用 C 语言编写程序，但其中一个练习有问题。它要求我检测并删除字符串 s1 中的一个字符，该字符与字符串 s2 中的任何字符匹配。

所以，说 s1 = "A";

和 s2 = "AABAACAADAAE"

我希望它返回“BCDE”

我知道我走在正确的道路上，我只是不知道如何很好地设计程序，你能否给我任何额外的提示。我试图阅读二叉搜索树算法，但觉得它对于这个平凡的任务来说有点太高级了。

感谢大家！

```
/* An alternate version of squeeze(s1, s2) that deletes each character in
 * s1 that matches any character in the string s2
 *
 * Angie@odfx.org
 */

#include <stdio.h>
#include <string.h>

void squeeze(char s[], char t[]);

char string[] = "BAD";
char sstring[] = "ABC";

int
main(void)
{
    squeeze(string, sstring);
    return 0;
}

void
squeeze(char s[], char t[])
{
    int i, j, d;

    d = 0;
    if(strstr(s, t) == NULL)
        printf("%c", s[i]);
    s[j] = '\0';
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-07T02:08:29.323

很棒的书。如果我是你，我会完全按照第 2.8 节中的squeeze() 进行操作，但不是直接比较 (s[i] != c) 我会编写并利用一个函数

```
 int contains(char s[], int c) 
```

如果字符串 s 包含 c，则返回 1，否则返回 0。从简单的方法开始；当它起作用时，您可以使用更复杂的解决方案来提高性能（二进制搜索，但请注意，该问题不需要 s2 中的字符按特定顺序排列）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T02:11:36.430

二进制搜索对此太过分了。你需要三个索引。一个索引 ( `i`) 用于遍历`s`，一个索引 ( `k`) 用于遍历`t`，一个索引 ( `j`) 用于跟踪您所在的位置，以`s`查找您需要保留的字符，因为它们不在其中`t`。因此，对于 中的每个字符`s`，检查它是否在 中`t`。如果不是，请将其保留在`s`.

```
void squeeze(char *s, char *t) {
    int i, j, k;
    int found = 0;

    for(i = j = 0; s[i] != '\0'; i++) {
        found = 0;
        for(k = 0; t[k] != '\0' && (found == 0); k++) {
            if(t[k] == s[i]) {
                found = 1;
            }
        }

        if(found == 0) {
            s[j++] = s[i];
        }

    }

    s[j] = '\0';
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T02:00:05.500

您不需要花哨的二进制搜索来完成这项工作。您需要的是一个双 for 循环，它检查一个字符串中每个字符在另一个字符串中的出现，并将未出现的字符复制到第三个字符数组中（这是您的结果）。

代码可能类似于以下内容（未经测试！）：

```
char *s1, *s2, *result; /* original strings and the result string */
int len1, len2; /* lengths of the strings */
for (i = 0; i < len1; i++) {
   for (j = 0; j < len2; j++) {
     if (s1[i] == s2[j]) {
       break;
     }
   }
   if (j == len2) {  /* s1[i] is not found in s2 */
     *result = s1[i]; 
     result++; /* assuming your result array is long enough */
   }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-27T20:25:56.080

```
void squeeze(char s1[], char s2[])
{
    int i,j,k;
    char c;
    for(i=0;s2[i]!='\0';i++)
    {
        c=s2[i];
        for(j=k=0;s1[j]!='\0';j++)
            if(s1[j]!=c)
                s1[k++]=s1[j];
            s1[k]='\0';
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2022-02-14T00:13:29.350

这是我非常清晰和简单的答案，并附有一些合乎逻辑的解释。

```
#include<stdio.h>
void squeeze(); 
```

在 main 我们输入我们测试过的字符串和***wantbedelete***字符串，其中包含我们要从***yourstring***中删除的字符。

```
int main() 
{

    char yourstring[] = "AABAACAADAAE";
    char wantbedelete[] = "A";

    squeeze(yourstring, wantbedelete);
    printf("%s", yourstring);

    return 0;
} 
```

挤压函数内部的逻辑如下，

*   循环在***wantbedelete*** char by char
*   然后，对于在***wantbedelete***中找到的任何字符，我们会遍历整个***yourstring***
*   然后，我们比较两个创建的 char 是否不匹配，我们将 char 从***yourstring***更新（保存）到***yourstring***所以基本上在这里我们定义一个新的索引（**k**）来跟踪和更新唯一想要的字符
*   现在这里的技巧是，每次我们再次返回到循环遍历我们打算删除的每个字符的外部循环时，我们都希望重置索引，以便我们最终得到唯一想要的字符串。

我强烈建议您使用调试器并遵循挤压函数中的每一行，以便您能够更清楚地理解逻辑。

```
void squeeze(char s1[], char s2[]) 
{
    int i, j, k;

    k = 0;
    for (i = 0 ; s2[i] != '\0' ; i++) /* loop for each char we want to delete with index i */
    {
        for (j = 0 ; s1[j] != '\0'; j++) /* loop for each char we want to keep with index j */
        {
            if (s2[i] != s1[j]) /* if the two chars do not match */
            {
                s1[k++] = s1[j]; /* update s1 with the char that we want to keep using index k */
            }
        }
        s1[k] = '\0'; /* since we update all char that we want to keep, the last char of index k must be empty */
        k = 0; /* reset index k so we will be ready for the next char that we want to delete from s1 */
    }
} 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2014-06-16T08:22:45.280

这是我的功能：

```
void squeeze(char s1[],char s2[])
{
int i,j,p;
int found;

p=0;
for(i=0;s1[i]!='\0';i++)
{
    for(j=0;s2[j]!='\0';j++)
        if(s1[i]==s2[j])
            found=YES;
        else
            found=NO;
    if(found==NO)
        s1[p++]=s1[i];
     }
    s1[p]='\0';
} 
```

# linux - 如何将输出重定向到文件和标准输出

> ID：418896
> 
> 赞同：1307
> 
> 时间：2009-01-07T01:45:42.597
> 
> 标签：linux, bash, file-io, io, stdout

在 bash 中，调用`foo`会在标准输出上显示该命令的任何输出。

调用`foo > output`会将来自该命令的任何输出重定向到指定的文件（在本例中为“输出”）。

有没有办法将输出重定向到文件*并*显示在标准输出上？

* * *

## 回答 #1

> 赞同：1864
> 
> 时间：2009-01-07T01:48:08.943

您想要的命令名为**[`tee`](http://www.gnu.org/software/coreutils/manual/html_node/tee-invocation.html)**：

```
foo | tee output.file 
```

例如，如果您只关心标准输出：

```
ls -a | tee output.file 
```

如果要包含 stderr，请执行以下操作：

```
program [arguments...] 2>&1 | tee outfile 
```

`2>&1`将通道 2（stderr/标准错误）重定向到通道 1（stdout/标准输出），这样两者都写为 stdout。从命令开始，它也被定向到给定的输出文件`tee`。

此外，如果要*附加*到日志文件，请使用`tee -a`：

```
program [arguments...] 2>&1 | tee -a outfile 
```

* * *

## 回答 #2

> 赞同：542
> 
> 时间：2011-08-28T05:38:20.797

```
$ program [arguments...] 2>&1 | tee outfile 
```

`2>&1`转储 stderr 和 stdout 流。 `tee outfile`获取它获取的流并将其写入屏幕和文件“outfile”。

这可能是大多数人正在寻找的。可能的情况是某些程序或脚本长时间工作并产生大量输出。用户希望定期检查进度，但也希望将输出写入文件。

问题（尤其是在混合 stdout 和 stderr 流时）是依赖于程序刷新的流。例如，如果对 stdout 的所有写入都*没有*刷新，但对 stderr 的所有写入*都被*刷新，那么它们最终会在输出文件和屏幕上不按时间顺序排列。

如果程序每隔几分钟只输出 1 或 2 行来报告进度，这也很糟糕。在这种情况下，如果程序没有刷新输出，用户甚至在几个小时内都不会在屏幕上看到任何输出，因为在几个小时内它都不会通过管道推送。

更新：程序`unbuffer`，`expect`包的一部分，将解决缓冲问题。这将导致 stdout 和 stderr 立即写入屏幕和文件，并在合并和重定向到`tee`. 例如：

```
$ unbuffer program [arguments...] 2>&1 | tee outfile 
```

* * *

## 回答 #3

> 赞同：152
> 
> 时间：2015-03-20T10:03:47.283

另一种对我有用的方法是，

```
<command> |& tee  <outputFile> 
```

如[gnu bash手册中所示](http://www.gnu.org/software/bash/manual/bashref.html#Pipelines)

例子：

```
ls |& tee files.txt 
```

> *如果使用'|&'，command1的**标准错误**，除了它的**标准输出**，通过管道连接到command2的标准输入；它是**2>&1** | 的简写。标准错误到标准输出的这种隐式重定向是在命令指定的任何重定向之后执行的。*

有关更多信息，请参阅[重定向](http://www.gnu.org/software/bash/manual/bashref.html#Redirections)

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2014-08-15T00:18:41.663

您可以主要使用[Zoredache](https://stackoverflow.com/users/20267/zoredache) [解决方案](https://stackoverflow.com/a/418899/2114786)，但如果您不想覆盖输出文件，您应该使用 -a 选项编写 tee，如下所示：

```
ls -lR / | tee -a output.file 
```

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2015-06-26T10:10:45.980

有什么要补充的...

软件包 unbuffer 对 fedora 和 redhat unix 版本下的某些软件包有支持问题。

抛开烦恼

**以下为我工作**

```
bash myscript.sh 2>&1 | tee output.log 
```

> 谢谢[ScDF](https://stackoverflow.com/users/1666/scdf)和[马修](https://stackoverflow.com/users/822502/matthew-alpert)，您的意见为我节省了很多时间。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2009-01-07T01:50:22.870

使用`tail -f output`应该工作。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2019-05-03T10:47:24.270

您可以通过在脚本开头使用类似的内容来为整个脚本执行此操作：

```
#!/usr/bin/env bash

test x$1 = x$'\x00' && shift || { set -o pipefail ; ( exec 2>&1 ; $0 $'\x00' "$@" ) | tee mylogfile ; exit $? ; }

# do whaetever you want 
```

这会将 stderr 和 stdout 输出重定向到调用的文件`mylogfile` **，并让所有内容****同时**进入 stdout 。

它使用了一些愚蠢的技巧：

*   不使用`exec`命令设置重定向，
*   用于`tee`复制输出，
*   使用想要的重定向重新启动脚本，
*   使用特殊的第一个参数（`NUL`由特殊 bash 表示法指定的简单字符`$'string'`）来指定脚本重新启动（您的原始作品可能不使用等效参数），
*   尝试使用该`pipefail`选项重新启动脚本时保留原始退出状态。

丑陋但在某些情况下对我有用。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2015-10-22T17:55:42.220

奖励答案，因为这个用例把我带到了这里：

**如果您需要以其他用户的身份执行此操作**

```
echo "some output" | sudo -u some_user tee /some/path/some_file 
```

请注意，回显将在您发生时发生，并且文件写入将以“some_user”的身份发生，如果您以“some_user”身份运行回显并使用>>“some_file”重定向输出，则将不起作用，因为文件重定向将**发生**和你一样。

提示： tee 还支持附加 -a 标志，如果您需要将文件中的一行替换为另一个用户，您可以作为所需用户执行 sed。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2018-02-01T16:25:04.510

`< command > |& tee filename`# 这将创建一个以命令状态为内容的文件“文件名”，如果文件已经存在，它将删除现有内容并写入命令状态。

`< command > | tee >> filename`# 这会将状态附加到文件中，但不会在标准输出（屏幕）上打印命令状态。

我想通过在屏幕上使用“回显”来打印一些东西，并将回显的数据附加到文件中

```
echo "hi there, Have to print this on screen and append to a file" 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2021-11-16T20:20:41.233

就我而言，我有带有输出日志的 Java 进程。显示输出日志并将它们重定向到文件（此处命名为 logfile）的最简单解决方案是：

```
my_java_process_run_script.sh |& tee logfile 
```

> 结果是 Java 进程运行，输出日志显示并将它们放入名为 logfile 的文件中

* * *

## 回答 #11

> 赞同：-16
> 
> 时间：2009-01-07T02:47:44.750

tee 非常适合这个，但这也可以完成工作

```
ls -lr / > output | cat output 
```

# sql - SQLite - UPSERT *not* INSERT 或 REPLACE

> ID：418898
> 
> 赞同：589
> 
> 时间：2009-01-07T01:47:23.903
> 
> 标签：sql, sqlite, upsert

[http://en.wikipedia.org/wiki/Upsert](http://en.wikipedia.org/wiki/Upsert)

[在 SQL Server 上插入更新存储过程](https://stackoverflow.com/questions/13540/insert-update-stored-proc-on-sql-server)

在 SQLite 中是否有一些我没有想到的聪明方法？

基本上，如果记录存在，我想更新四列中的三列，如果不存在，我想用第四列的默认（NUL）值插入记录。

ID 是主键，因此 UPSERT 永远只有一条记录。

（我试图避免 SELECT 的开销以确定我是否需要 UPDATE 或 INSERT 显然）

建议？

* * *

我无法在 SQLite 站点上确认 TABLE CREATE 的语法。我还没有建立一个演示来测试它，但它似乎不受支持。

如果是，我有三列，所以它实际上看起来像：

```
CREATE TABLE table1( 
    id INTEGER PRIMARY KEY ON CONFLICT REPLACE, 
    Blob1 BLOB ON CONFLICT REPLACE, 
    Blob2 BLOB ON CONFLICT REPLACE, 
    Blob3 BLOB 
); 
```

但前两个 blob 不会引起冲突，只有 ID 会所以我假设 Blob1 和 Blob2 不会被替换（根据需要）

* * *

当绑定数据是一个完整的事务时，SQLite 中的 UPDATE，这意味着要更新的每个发送的行都需要： Prepare/Bind/Step/Finalize 语句与允许使用重置功能的 INSERT 语句不同

语句对象的生命周期是这样的：

1.  使用 sqlite3_prepare_v2() 创建对象
2.  使用 sqlite3_bind_ 接口将值绑定到主机参数。
3.  通过调用 sqlite3_step() 运行 SQL
4.  使用 sqlite3_reset() 重置语句，然后返回步骤 2 并重复。
5.  使用 sqlite3_finalize() 销毁语句对象。

UPDATE 我猜与 INSERT 相比速度很慢，但它与使用主键的 SELECT 相比如何？

也许我应该使用 select 来读取第 4 列（Blob3），然后使用 REPLACE 编写一条新记录，将原始第 4 列与前 3 列的新数据混合？

* * *

## 回答 #1

> 赞同：915
> 
> 时间：2010-12-02T00:55:15.833

假设表中有三列：ID、NAME、ROLE

* * *

**坏：**这将使用 ID=1 的新值插入或替换所有列：

```
INSERT OR REPLACE INTO Employee (id, name, role) 
  VALUES (1, 'John Foo', 'CEO'); 
```

* * *

**坏：**这将插入或替换 2 列... NAME 列将设置为 NULL 或默认值：

```
INSERT OR REPLACE INTO Employee (id, role) 
  VALUES (1, 'code monkey'); 
```

* * *

**好**：在 SQLite 中使用 SQLite On 冲突子句 [UPSERT 支持！](https://www.sqlite.org/draft/lang_UPSERT.html)UPSERT 语法已添加到 SQLite 版本 3.24.0！

UPSERT 是对 INSERT 的一种特殊语法，如果 INSERT 违反唯一性约束，它会导致 INSERT 表现为 UPDATE 或无操作。UPSERT 不是标准 SQL。SQLite 中的 UPSERT 遵循 PostgreSQL 建立的语法。

[![在此处输入图像描述](https://i.stack.imgur.com/h475O.gif)](https://i.stack.imgur.com/h475O.gif)

**好但乏味：**这将更新 2 列。当 ID=1 存在时，NAME 将不受影响。当 ID=1 不存在时，名称将是默认值 (NULL)。

```
INSERT OR REPLACE INTO Employee (id, role, name) 
  VALUES (  1, 
            'code monkey',
            (SELECT name FROM Employee WHERE id = 1)
          ); 
```

这将更新 2 列。当 ID=1 存在时，ROLE 不受影响。当 ID=1 不存在时，角色将被设置为 'Benchwarmer' 而不是默认值。

```
INSERT OR REPLACE INTO Employee (id, name, role) 
  VALUES (  1, 
            'Susan Bar',
            COALESCE((SELECT role FROM Employee WHERE id = 1), 'Benchwarmer')
          ); 
```

* * *

## 回答 #2

> 赞同：144
> 
> 时间：2010-11-23T07:46:00.187

插入或替换*不*等同于“UPSERT”。

假设我有包含字段 id、name 和 role 的表 Employee：

```
INSERT OR REPLACE INTO Employee ("id", "name", "role") VALUES (1, "John Foo", "CEO")
INSERT OR REPLACE INTO Employee ("id", "role") VALUES (1, "code monkey") 
```

繁荣，您丢失了员工编号 1 的姓名。SQLite 已将其替换为默认值。

UPSERT 的预期输出是更改角色并保留名称。

* * *

## 回答 #3

> 赞同：117
> 
> 时间：2011-09-22T08:13:52.363

如果您只想保留现有行中的一列或两列，[Eric B 的回答是可以的。](https://stackoverflow.com/questions/418898/-/4330694#4330694)如果你想保留很多列，它会变得太麻烦。

这是一种可以很好地扩展到任意数量的列的方法。为了说明这一点，我将假设以下模式：

```
 CREATE TABLE page (
     id      INTEGER PRIMARY KEY,
     name    TEXT UNIQUE,
     title   TEXT,
     content TEXT,
     author  INTEGER NOT NULL REFERENCES user (id),
     ts      TIMESTAMP DEFAULT CURRENT_TIMESTAMP
 ); 
```

请特别注意，这`name`是行的自然键——`id`仅用于外键，所以重点是 SQLite 在插入新行时自行选择 ID 值。但是当基于它更新现有行时`name`，我希望它继续具有旧的 ID 值（显然！）。

`UPSERT`我通过以下构造实现了真实：

```
 WITH new (name, title, author) AS ( VALUES('about', 'About this site', 42) )
 INSERT OR REPLACE INTO page (id, name, title, content, author)
 SELECT old.id, new.name, new.title, old.content, new.author
 FROM new LEFT JOIN page AS old ON new.name = old.name; 
```

此查询的确切形式可能会有所不同。关键是使用`INSERT SELECT`左外连接，将现有行连接到新值。

在这里，如果一行之前不存在，`old.id`将会存在，`NULL`然后 SQLite 将自动分配一个 ID，但如果已经存在这样的行，`old.id`将有一个实际值，这将被重用。这正是我想要的。

事实上，这是非常灵活的。请注意该`ts`列是如何在所有方面都完全缺失的——因为它有一个`DEFAULT`值，SQLite 在任何情况下都会做正确的事情，所以我不必自己处理它。

您还可以在`new`和`old`两侧都包含一列，然后`COALESCE(new.content, old.content)`在外部使用例如`SELECT`“插入新内容（如果有），否则保留旧内容” - 例如，如果您使用固定查询并绑定新内容带有占位符的值。

* * *

## 回答 #4

> 赞同：88
> 
> 时间：2009-01-07T02:29:13.023

如果您通常进行更新，我会..

1.  开始交易
2.  进行更新
3.  检查行数
4.  如果为 0 则插入
5.  犯罪

如果您通常进行插入，我会

1.  开始交易
2.  尝试插入
3.  检查主键违规错误
4.  如果我们遇到错误，请进行更新
5.  犯罪

这样你就可以避免选择，并且你在 Sqlite 上的事务是健全的。

* * *

## 回答 #5

> 赞同：86
> 
> 时间：2015-08-28T12:00:13.723

此答案已更新，因此以下评论不再适用。

**2018-05-18 停止新闻。**

[SQLite 中的 UPSERT 支持！](https://www.sqlite.org/draft/lang_UPSERT.html)UPSERT 语法已添加到 SQLite 版本 3.24.0（待定）！

UPSERT 是对 INSERT 的一种特殊语法，如果 INSERT 违反唯一性约束，它会导致 INSERT 表现为 UPDATE 或无操作。UPSERT 不是标准 SQL。SQLite 中的 UPSERT 遵循 PostgreSQL 建立的语法。

[![在此处输入图像描述](https://i.stack.imgur.com/h475O.gif)](https://i.stack.imgur.com/h475O.gif)

或者：

另一种完全不同的方法是：在我的应用程序中，当我在内存中创建行时，我将内存中的 rowID 设置为 long.MaxValue。（MaxValue 永远不会被用作 ID，您将活得不够长......然后，如果 rowID 不是那个值，那么它必须已经在数据库中，所以如果它是 MaxValue 则需要更新，那么它需要插入。仅当您可以跟踪应用程序中的 rowID 时，这才有用。

* * *

## 回答 #6

> 赞同：65
> 
> 时间：2011-09-08T19:12:04.013

我意识到这是一个旧线程，但我最近一直在使用 sqlite3 并想出了这种方法，它更适合我动态生成参数化查询的需求：

```
insert or ignore into <table>(<primaryKey>, <column1>, <column2>, ...) values(<primaryKeyValue>, <value1>, <value2>, ...); 
update <table> set <column1>=<value1>, <column2>=<value2>, ... where changes()=0 and <primaryKey>=<primaryKeyValue>; 
```

它仍然是 2 个查询，更新时带有 where 子句，但似乎可以解决问题。我也有这样的想法，如果对 changes() 的调用大于零，sqlite 可以完全优化更新语句。它是否真的这样做超出了我的知识范围，但一个人可以做梦，不是吗？;)

对于奖励积分，您可以附加此行，它会返回该行的 id，无论它是新插入的行还是现有行。

```
select case changes() WHEN 0 THEN last_insert_rowid() else <primaryKeyValue> end; 
```

* * *

## 回答 #7

> 赞同：18
> 
> 时间：2018-05-11T17:25:20.690

### 从版本 3.24.0 开始，SQLite 支持 UPSERT。

从[文档](https://www.sqlite.org/lang_UPSERT.html)中：

> **UPSERT 是对 INSERT 的一种特殊语法，如果 INSERT 违反唯一性约束，它会导致 INSERT 表现为 UPDATE 或无操作。UPSERT 不是标准 SQL。SQLite 中的 UPSERT 遵循 PostgreSQL 建立的语法。**UPSERT 语法已添加到 SQLite 版本 3.24.0（待定）。
> 
> **UPSERT 是一个普通的 INSERT 语句，后跟特殊的 ON CONFLICT 子句**

[![在此处输入图像描述](https://www.sqlite.org/images/syntax/upsert-clause.gif)](https://www.sqlite.org/images/syntax/upsert-clause.gif)

^(图片来源：[https ://www.sqlite.org/images/syntax/upsert-clause.gif](https://www.sqlite.org/images/syntax/upsert-clause.gif))

* * *

例子：

```
CREATE TABLE t1(id INT PRIMARY KEY, c TEXT);
INSERT INTO t1(id, c) VALUES (1,'a'), (2, 'b');
SELECT * FROM t1;

INSERT INTO t1(id, c) VALUES (1, 'c');
-- UNIQUE constraint failed: t1.id

INSERT INTO t1(id, c) VALUES (1, 'c')
ON CONFLICT DO NOTHING;

SELECT * FROM t1;

INSERT INTO t1(id, c)
VALUES (1, 'c')
ON CONFLICT(id) DO UPDATE SET c = excluded.c;

SELECT * FROM t1; 
```

**[db<>小提琴演示](https://dbfiddle.uk/?rdbms=sqlite_3.27&fiddle=4908123eb3250a1e97cf23cce071fb61)**

* * *

## 回答 #8

> 赞同：15
> 
> 时间：2014-02-27T22:47:54.313

这是一个真正是 UPSERT（更新或插入）而不是插入或替换（在许多情况下工作方式不同）的解决方案。

它的工作原理如下：
1\. 如果存在具有相同 Id 的记录，请尝试更新。
2\. 如果更新没有改变任何行（`NOT EXISTS(SELECT changes() AS change FROM Contact WHERE change <> 0)`），则插入记录。

因此，要么更新现有记录，要么执行插入。

重要的细节是使用 changes() SQL 函数检查更新语句是否命中任何现有记录，如果没有命中任何记录，则仅执行插入语句。

值得一提的是，changes() 函数不会返回由较低级别的触发器执行的更改（请参阅[http://sqlite.org/lang_corefunc.html#changes](http://sqlite.org/lang_corefunc.html#changes)），因此请务必考虑到这一点。

这是SQL...

测试更新：

```
--Create sample table and records (and drop the table if it already exists)
DROP TABLE IF EXISTS Contact;
CREATE TABLE [Contact] (
  [Id] INTEGER PRIMARY KEY, 
  [Name] TEXT
);
INSERT INTO Contact (Id, Name) VALUES (1, 'Mike');
INSERT INTO Contact (Id, Name) VALUES (2, 'John');

-- Try to update an existing record
UPDATE Contact
SET Name = 'Bob'
WHERE Id = 2;

-- If no record was changed by the update (meaning no record with the same Id existed), insert the record
INSERT INTO Contact (Id, Name)
SELECT 2, 'Bob'
WHERE NOT EXISTS(SELECT changes() AS change FROM Contact WHERE change <> 0);

--See the result
SELECT * FROM Contact; 
```

测试插入：

```
--Create sample table and records (and drop the table if it already exists)
DROP TABLE IF EXISTS Contact;
CREATE TABLE [Contact] (
  [Id] INTEGER PRIMARY KEY, 
  [Name] TEXT
);
INSERT INTO Contact (Id, Name) VALUES (1, 'Mike');
INSERT INTO Contact (Id, Name) VALUES (2, 'John');

-- Try to update an existing record
UPDATE Contact
SET Name = 'Bob'
WHERE Id = 3;

-- If no record was changed by the update (meaning no record with the same Id existed), insert the record
INSERT INTO Contact (Id, Name)
SELECT 3, 'Bob'
WHERE NOT EXISTS(SELECT changes() AS change FROM Contact WHERE change <> 0);

--See the result
SELECT * FROM Contact; 
```

* * *

## 回答 #9

> 赞同：13
> 
> 时间：2018-07-12T13:01:25.883

伯恩哈特的更新：

你确实可以在 SQLite 中做一个 upsert，它只是看起来和你习惯的有点不同。它看起来像：

```
INSERT INTO table_name (id, column1, column2) 
VALUES ("youruuid", "value12", "value2")
ON CONFLICT(id) DO UPDATE 
SET column1 = "value1", column2 = "value2" 
```

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2013-05-21T02:07:41.337

扩展[亚里士多德的答案](https://stackoverflow.com/a/7511635)，您可以从一个虚拟的“单例”表（您自己创建的单行表）中选择。这避免了一些重复。

我还使示例在 MySQL 和 SQLite 之间具有可移植性，并使用“date_added”列作为示例，说明如何仅在第一次设置列。

```
 REPLACE INTO page (
   id,
   name,
   title,
   content,
   author,
   date_added)
 SELECT
   old.id,
   "about",
   "About this site",
   old.content,
   42,
   IFNULL(old.date_added,"21/05/2013")
 FROM singleton
 LEFT JOIN page AS old ON old.name = "about"; 
```

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2009-01-07T02:01:10.773

我知道的最好的方法是先更新，然后再插入。“选择的开销”是必要的，但这并不是一个可怕的负担，因为您正在搜索主键，这很快。

您应该能够使用您的表和字段名称修改以下语句以执行您想要的操作。

```
--first, update any matches
UPDATE DESTINATION_TABLE DT
SET
  MY_FIELD1 = (
              SELECT MY_FIELD1
              FROM SOURCE_TABLE ST
              WHERE ST.PRIMARY_KEY = DT.PRIMARY_KEY
              )
 ,MY_FIELD2 = (
              SELECT MY_FIELD2
              FROM SOURCE_TABLE ST
              WHERE ST.PRIMARY_KEY = DT.PRIMARY_KEY
              )
WHERE EXISTS(
            SELECT ST2.PRIMARY_KEY
            FROM
              SOURCE_TABLE ST2
             ,DESTINATION_TABLE DT2
            WHERE ST2.PRIMARY_KEY = DT2.PRIMARY_KEY
            );

--second, insert any non-matches
INSERT INTO DESTINATION_TABLE(
  MY_FIELD1
 ,MY_FIELD2
)
SELECT
  ST.MY_FIELD1
 ,NULL AS MY_FIELD2  --insert NULL into this field
FROM
  SOURCE_TABLE ST
WHERE NOT EXISTS(
                SELECT DT2.PRIMARY_KEY
                FROM DESTINATION_TABLE DT2
                WHERE DT2.PRIMARY_KEY = ST.PRIMARY_KEY
                ); 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2017-01-31T15:57:00.883

如果有人想阅读我在 Cordova 中的 SQLite 解决方案，由于上面的@david 回答，我得到了这个通用的 js 方法。

```
function    addOrUpdateRecords(tableName, values, callback) {
get_columnNames(tableName, function (data) {
    var columnNames = data;
    myDb.transaction(function (transaction) {
        var query_update = "";
        var query_insert = "";
        var update_string = "UPDATE " + tableName + " SET ";
        var insert_string = "INSERT INTO " + tableName + " SELECT ";
        myDb.transaction(function (transaction) {
            // Data from the array [[data1, ... datan],[()],[()]...]:
            $.each(values, function (index1, value1) {
                var sel_str = "";
                var upd_str = "";
                var remoteid = "";
                $.each(value1, function (index2, value2) {
                    if (index2 == 0) remoteid = value2;
                    upd_str = upd_str + columnNames[index2] + "='" + value2 + "', ";
                    sel_str = sel_str + "'" + value2 + "', ";
                });
                sel_str = sel_str.substr(0, sel_str.length - 2);
                sel_str = sel_str + " WHERE NOT EXISTS(SELECT changes() AS change FROM "+tableName+" WHERE change <> 0);";
                upd_str = upd_str.substr(0, upd_str.length - 2);
                upd_str = upd_str + " WHERE remoteid = '" + remoteid + "';";                    
                query_update = update_string + upd_str;
                query_insert = insert_string + sel_str;  
                // Start transaction:
                transaction.executeSql(query_update);
                transaction.executeSql(query_insert);                    
            });
        }, function (error) {
            callback("Error: " + error);
        }, function () {
            callback("Success");
        });
    });
});
} 
```

因此，首先使用此函数获取列名：

```
function get_columnNames(tableName, callback) {
myDb.transaction(function (transaction) {
    var query_exec = "SELECT name, sql FROM sqlite_master WHERE type='table' AND name ='" + tableName + "'";
    transaction.executeSql(query_exec, [], function (tx, results) {
        var columnParts = results.rows.item(0).sql.replace(/^[^\(]+\(([^\)]+)\)/g, '$1').split(','); ///// RegEx
        var columnNames = [];
        for (i in columnParts) {
            if (typeof columnParts[i] === 'string')
                columnNames.push(columnParts[i].split(" ")[0]);
        };
        callback(columnNames);
    });
});
} 
```

然后以编程方式构建事务。

“值”是您应该在之前构建的数组，它代表您要插入或更新到表中的行。

“remoteid”是我用作参考的 id，因为我正在与远程服务器同步。

SQLite Cordova插件的使用请参考官方[链接](https://github.com/litehelpers/Cordova-sqlite-storage)

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-01-07T02:20:46.240

我认为这可能是您正在寻找的：[ON CONFLICT 子句](http://www.sqlite.org/lang_conflict.html)。

如果你这样定义你的表：

```
CREATE TABLE table1( 
    id INTEGER PRIMARY KEY ON CONFLICT REPLACE, 
    field1 TEXT 
); 
```

现在，如果您使用已经存在的 id 执行 INSERT，SQLite 会自动执行 UPDATE 而不是 INSERT。

嗯...

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2016-01-29T06:20:46.947

此方法重新混合了此问题答案中的一些其他方法，并结合了 CTE（通用表表达式）的使用。我将介绍查询，然后解释我为什么这样做。

如果有员工 300，我想将员工 300 的姓氏更改为 DAVIS。否则，我将添加一个新员工。

表名：员工列：id、first_name、last_name

**查询是：**

```
INSERT OR REPLACE INTO employees (employee_id, first_name, last_name)
WITH registered_employees AS ( --CTE for checking if the row exists or not
    SELECT --this is needed to ensure that the null row comes second
        *
    FROM (
        SELECT --an existing row
            *
        FROM
            employees
        WHERE
            employee_id = '300'

        UNION

        SELECT --a dummy row if the original cannot be found
            NULL AS employee_id,
            NULL AS first_name,
            NULL AS last_name
    )
    ORDER BY
        employee_id IS NULL --we want nulls to be last
    LIMIT 1 --we only want one row from this statement
)
SELECT --this is where you provide defaults for what you would like to insert
    registered_employees.employee_id, --if this is null the SQLite default will be used
    COALESCE(registered_employees.first_name, 'SALLY'),
    'DAVIS'
FROM
    registered_employees
; 
```

基本上，我使用 CTE 来减少必须使用 select 语句来确定默认值的次数。由于这是一个 CTE，我们只需从表中选择我们想要的列，INSERT 语句就会使用它。

现在，您可以通过在 COALESCE 函数中将空值替换为应该使用的值来决定要使用的默认值。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2017-12-30T20:08:14.510

遵循[Aristotle Pagaltzis和](https://stackoverflow.com/a/7511635/513570)[Eric B's answer](https://stackoverflow.com/questions/418898/-/4330694#4330694)的想法`COALESCE`，这里是一个 upsert 选项，仅更新几列或插入整行（如果不存在）。

在这种情况下，假设应该更新标题和内容，在存在时保留其他旧值并在找不到名称时插入提供的值：

**当它应该是自动增量时， **NOTE**`id`被强制为 NULL 。`INSERT`如果它只是一个生成的主键，那么`COALESCE`也可以使用（参见[Aristotle Pagaltzis 评论](https://stackoverflow.com/questions/418898/sqlite-upsert-not-insert-or-replace/48037464?noredirect=1#comment83137236_48037464)）。**

 **```
WITH new (id, name, title, content, author)
     AS ( VALUES(100, 'about', 'About this site', 'Whatever new content here', 42) )
INSERT OR REPLACE INTO page (id, name, title, content, author)
SELECT
     old.id, COALESCE(old.name, new.name),
     new.title, new.content,
     COALESCE(old.author, new.author)
FROM new LEFT JOIN page AS old ON new.name = old.name; 
```

所以一般规则是，如果你想保留旧值，使用`COALESCE`，当你想更新值时，使用`new.fieldname`

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2020-01-05T23:49:32.700

如果您不介意在两个操作中执行此操作。

脚步：

1）使用“插入或忽略”添加新项目

2) 使用“UPDATE”更新现有项目

这两个步骤的输入是相同的新项目或可更新项目的集合。适用于无需更改的现有项目。它们将被更新，但使用相同的数据，因此最终结果是没有变化。

当然，速度较慢等。效率低下。是的。

写sql容易维护和理解吗？确实。

这是一个需要考虑的权衡。非常适合小型 upserts。非常适合那些不介意为了代码可维护性而牺牲效率的人。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2021-04-11T11:15:19.937

使用 WHERE 选择更新日期记录的完整示例。

```
-- https://www.db-fiddle.com/f/7jyj4n76MZHLLk2yszB6XD/22

DROP TABLE IF EXISTS db;

CREATE TABLE db
(
 id PRIMARY KEY,
 updated_at,
 other
);

-- initial INSERT
INSERT INTO db (id,updated_at,other) VALUES(1,1,1);

SELECT * FROM db;

-- INSERT without WHERE
INSERT INTO db (id,updated_at,other) VALUES(1,2,2)
ON CONFLICT(id) DO UPDATE SET updated_at=excluded.updated_at;

SELECT * FROM db;

-- WHERE is FALSE
INSERT INTO db (id,updated_at,other) VALUES(1,2,3)
ON CONFLICT(id) DO UPDATE SET updated_at=excluded.updated_at, other=excluded.other
WHERE excluded.updated_at > updated_at;

SELECT * FROM db;

-- ok to SET a PRIMARY KEY. WHERE is TRUE
INSERT INTO db (id,updated_at,other) VALUES(1,3,4)
ON CONFLICT(id) DO UPDATE SET id=excluded.id, updated_at=excluded.updated_at, other=excluded.other
WHERE excluded.updated_at > updated_at;

SELECT * FROM db; 
```

* * *

## 回答 #18

> 赞同：-3
> 
> 时间：2010-10-07T11:00:32.337

刚刚阅读了这个帖子，并对这个“UPSERT”并不容易感到失望，我进一步调查了......

实际上，您可以在 SQLITE 中直接轻松地执行此操作。

而不是使用：`INSERT INTO`

采用：`INSERT OR REPLACE INTO`

这正是你想要它做的！

* * *

## 回答 #19

> 赞同：-4
> 
> 时间：2014-05-02T03:49:17.197

```
SELECT COUNT(*) FROM table1 WHERE id = 1; 
```

如果`COUNT(*) = 0`

```
INSERT INTO table1(col1, col2, cole) VALUES(var1,var2,var3); 
```

否则如果`COUNT(*) > 0`

```
UPDATE table1 SET col1 = var4, col2 = var5, col3 = var6 WHERE id = 1; 
```

# javascript - 使用 JQuery 克隆 ExtJS 组件

> ID：418910
> 
> 赞同：1
> 
> 时间：2009-01-07T01:55:45.993
> 
> 标签：javascript, jquery, extjs

我正在尝试使用 JQuery 的 .clone() 克隆表单组件（实际上，我正在通过克隆容器元素来克隆字段集合）。一切都很顺利，除了日期字段、组合框不起作用，甚至 minLength 的验证等也不起作用。

顺便说一句，我只是使用 applyTo 将旧的 html 表单字段转换为 ext js 表单字段

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T11:31:19.983

问题是 jQuery clone() 不会克隆与 DOM 元素关联的事件处理程序。但是即使你使用 clone(true)，它确实复制了事件处理程序，它仍然不起作用，因为你还需要在 JavaScript 端克隆 Ext 对象。

您确实需要使用 Ext 提供的工具来创建许多类似的控件。一个好的开始是[创建自定义的 Ext 组件](http://blog.extjs.eu/know-how/writing-a-big-application-in-ext/)，然后您可以更轻松地多次实例化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T06:01:49.960

首先，您可以尝试使用

```
.clone(true) 
```

所以一个元素的所有事件处理程序都会被复制。除此之外，我怀疑 Extjs 在构建它的控件时会做一些其他时髦的事情，因此这可能只是让它工作的第一步。在 extjs 论坛上快速环顾四周，我没有看到很多关于克隆小部件的信息。

# c# - C# 中的平台 SDK 部署

> ID：418913
> 
> 赞同：1
> 
> 时间：2009-01-07T01:58:16.457
> 
> 标签：c#, .net, deployment

我正在阅读 Platform SDK 示例，示例位于 VB.NET 中。我使用 C#，所以我想知道，如何在 C# 中复制这一行？

```
Set   Installer   =   CreateObject("WindowsInstaller.Installer") 
```

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T02:10:20.490

```
using System.Runtime.InteropServices;

Type InstallerType;
object Installer;

InstallerType= Type.GetTypeFromProgID("WindowsInstaller.Installer");
Installer= Activator.CreateInstance(InstallerType); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-05-26T23:04:01.390

转到添加引用，选择 COM 选项卡并选择“WindowsInstaller”。('Interop.WindowsInstaller')

```
Add : using WindowsInstaller;

Type type = Type.GetTypeFromProgID("WindowsInstaller.Installer");
Installer msi = (Installer)Activator.CreateInstance(type);

//ur code: -
foreach (string productcode in msi.Products)
{
//ur code
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T02:07:40.743

这看起来像 VB6/VBScript，而不是 VB.NET :) 但我可能错了。

选项是：

1.  查找与 WindowsInstaller.Installer 对象[等效的 .NET 框架](http://msdn.microsoft.com/en-us/library/system.configuration.install.installer.aspx)并使用它。
2.  使用[Activator.CreateInstance()](http://msdn.microsoft.com/en-us/library/system.activator.createinstance.aspx)。但不要指望强类型的响应。
3.  添加对 WindowsInstaller.Installer COM 对象的引用，VS 将生成一个强类型互操作，这将允许您在 C# 中创建一个实例。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T02:13:40.730

我认为这就是 VBScript。

您最好在 .NET 框架中搜索您想要做的任何事情。它有一个丰富的安装程序库，应该很容易。不要只是尝试使用一些 COM 对象，因为那是你发现的。在您所在的框架中工作。

# c - 为什么 C 这么快，为什么其他语言没有这么快或更快？

> ID：418914
> 
> 赞同：224
> 
> 时间：2009-01-07T01:59:06.080
> 
> 标签：c, performance

在收听 StackOverflow 播客时，不断出现“真正的程序员”用 C 编写的刺戳，而且 C 的速度要快得多，因为它“靠近机器”。将前面的断言留到另一篇文章中，C 有什么特别之处可以让它比其他语言更快？或者换一种说法：是什么阻止了其他语言能够编译成运行速度与 C 一样快的二进制文件？

* * *

## 回答 #1

> 赞同：215
> 
> 时间：2009-01-07T02:15:41.337

**C 语言没有什么特别之处。这就是它速度快的原因之一。**

较新的语言支持[垃圾收集](http://en.wikipedia.org/wiki/Garbage_collection_(computer_science))、[动态类型](http://en.wikipedia.org/wiki/Type_system#Dynamic_typing)和其他设施，使程序员更容易编写程序。

问题是，有额外的处理开销会降低应用程序的性能。C 没有这些，这意味着没有开销，但这意味着程序员需要能够分配内存并释放它们以防止[内存泄漏](http://en.wikipedia.org/wiki/Memory_leak)，并且必须处理变量的静态类型。

也就是说，许多语言和平台，例如 Java（及其[Java 虚拟机](https://en.wikipedia.org/wiki/Java_virtual_machine)）和 .NET（及其公共语言运行时）多年来随着[即时编译](http://en.wikipedia.org/wiki/Just-in-time_compilation)等产生本机机器代码的出现而提高了性能字节码以实现更高的性能。

* * *

## 回答 #2

> 赞同：92
> 
> 时间：2009-01-07T02:10:54.917

C 设计者做了一个权衡。也就是说，他们做出了将速度置于安全之上的决定。C不会

*   检查数组索引范围
*   检查未初始化的变量值
*   检查内存泄漏
*   检查空指针取消引用

当您对数组进行索引时，在 Java 中，它需要在虚拟机中调用一些方法、边界检查和其他健全性检查。这*是有效的并且绝对没*问题，因为它增加了应有的安全性。但是在 C 中，即使是非常琐碎的事情也不会安全。例如，C 不需要 memcpy 来检查要复制的区域是否重叠。它的设计目的*不是*为大型商业应用程序编程。

但这些设计决策*并不是 C 语言中的错误*。它们是设计使然，因为它允许编译器和库编写者从计算机中获得每一点性能。以下是[C Rationale](http://www.lysator.liu.se/c/rat/a.html#1-1)文档如何解释 C 的精神：

> **C 代码可能是不可移植的。**尽管它努力让程序员有机会编写真正可移植的程序，但委员会并不想强迫程序员编写可移植的程序，以排除使用 C 作为“高级汇编程序”：编写特定于机器的能力代码是 C 的强项之一。
> 
> **保留 C 的精神。**委员会将保留 C 的传统精神作为主要目标。C 的精神有很多方面，但本质是 C 语言所基于的基本原则的社区情感。C 精神的某些方面可以概括为以下短语：
> 
> *   相信程序员。
> *   不要阻止程序员做需要做的事情。
> *   保持语言小而简单。
> *   只提供一种方法来进行操作。
> *   让它快速，即使它不能保证是便携的。
> 
> 最后一句谚语需要一点解释。高效代码生成的潜力是 C 语言最重要的优势之一。为了帮助确保看似非常简单的操作不会发生代码爆炸，许多操作被定义为目标机器的硬件如何完成它，而不是由一般抽象规则。这种愿意接受机器所做的事情的例子可以在控制用于表达式的 char 对象扩展的规则中看到：char 对象的值是否扩展为有符号或无符号数量通常取决于哪个字节操作更多在目标机器上有效。

* * *

## 回答 #3

> 赞同：79
> 
> 时间：2009-01-07T02:09:11.630

如果你花一个月用 C 语言构建一个运行时间为 0.05 秒的东西，而我用一天时间用 Java 编写同样的东西，它运行时间为 0.10 秒，那么 C 真的更快吗？

但是要回答您的问题，**编写良好的**C 代码通常会比其他语言编写良好的代码运行得更快，因为“良好”编写 C 代码的一部分包括在接近机器级别进行手动优化。

尽管编译器确实非常聪明，但他们还不能创造性地提出与手动按摩算法竞争的代码（假设“手”属于一个**优秀**的C 程序员）。

**编辑：**

很多评论都与“我用 C 编写并且我不考虑优化”这样的说法相一致。

[但是从这篇文章](https://stackoverflow.com/questions/418894/kr-exercise-2-4#418917)中举一个具体的例子：

在德尔福我可以这样写：

```
function RemoveAllAFromB(a, b: string): string;
var
  before, after :string;
begin
  Result := b;
  if 0 < Pos(a,b) then begin
    before := Copy(b,1,Pos(a,b)-Length(a));
    after := Copy(b,Pos(a,b)+Length(a),Length(b));
    Result := before + after;
    Result := RemoveAllAFromB(a,Result);  //recursive
  end;
end; 
```

并在 CI 中写下：

```
char *s1, *s2, *result; /* original strings and the result string */
int len1, len2; /* lengths of the strings */
for (i = 0; i < len1; i++) {
   for (j = 0; j < len2; j++) {
     if (s1[i] == s2[j]) {
       break;
     }
   }
   if (j == len2) {  /* s1[i] is not found in s2 */
     *result = s1[i]; 
     result++; /* assuming your result array is long enough */
   }
} 
```

但是C版本有多少优化呢？我们做出了很多我在 Delphi 版本中没有考虑到的关于实现的决定。字符串是如何实现的？在德尔福我看不到它。在 C 语言中，我决定它是一个指向 ASCII 整数数组的指针，我们称之为字符。在 C 中，我们一次测试一个字符是否存在。在 Delphi 中，我使用 Pos。

这只是一个小例子。在大型程序中，C 程序员必须每隔几行代码就做出此类低级决策。它加起来是一个手工制作、手工优化的可执行文件。

* * *

## 回答 #4

> 赞同：52
> 
> 时间：2009-01-07T05:53:19.570

我还没有看到它，所以我会说： ***C 往往更快，因为几乎所有其他东西都是用 C 编写的***。

Java 是基于 C 构建的，Python 是基于 C（或 Java，或 .NET 等）构建的，Perl 是等等。操作系统是用 C 编写的，虚拟机是用 C 编写的，编译器是用 C 编写的，解释器是用 C 编写的。有些东西仍然是用汇编语言编写的，这往往会更快。越来越多的东西是用其他东西写的，它本身是用 C 写的。

您用其他语言（不是汇编语言）编写的每条语句通常在下面作为 C 中的多个语句实现，这些语句被编译为本机机器代码。由于那些其他语言的存在往往是为了获得比 C 更高级别的抽象，因此 C 中所需的那些额外语句往往侧重于增加安全性、增加复杂性和提供错误处理。这些通常都是好东西，但它们是有**代价**的，它的名字就是**速度**和**大小**。

就个人而言，我已经用数十种语言编写了涵盖大部分可用范围的语言，并且我个人一直在寻找您暗示的魔力：

> 我怎样才能拥有我的蛋糕并吃掉它呢？我怎样才能在我最喜欢的语言中使用高级抽象，然后为了速度而深入了解 C 的本质？

经过几年的研究，我的答案是 Python（在 C 上）。你可能想看看。顺便说一句，您也可以从 Python 下拉到 Assembly（借助特殊库的一些小帮助）。

另一方面，[糟糕的代码可以用任何语言编写](http://c2.com/cgi/wiki?BadCodeCanBeWrittenInAnyLanguage)。因此，C（或汇编）代码不会*自动*更快。同样，一些优化技巧可以使*部分*高级语言代码接近原始 C 的性能水平。但是，对于大多数应用程序，您的程序将大部分时间花在等待人员或硬件上，因此差异真的无关紧要。

享受。

* * *

## 回答 #5

> 赞同：39
> 
> 时间：2009-01-07T02:10:52.827

里面有很多问题——大部分是我没有资格回答的。但是对于最后一个：

> 是什么阻止了其他语言能够编译成运行速度与 C 一样快的二进制文件？

总之，抽象。

C 与机器语言只有一两个抽象级别。Java 和 .Net 语言距离汇编程序至少有 3 个抽象级别。我不确定 Python 和 Ruby。

通常，程序员的玩具（复杂的数据类型等）越多，您离机器语言就越远，需要做的翻译就越多。

我在这里和那里，但这是基本要点。

**更新**-------- 这篇文章有一些很好的评论，有更多的细节。

* * *

## 回答 #6

> 赞同：36
> 
> 时间：2009-01-07T02:39:59.010

与其说 C 快，不如说**C 的成本模型是透明的**。如果一个 C 程序很慢，那么它很慢的原因很明显：通过执行大量语句。与 C 中的操作成本相比，对对象（尤其是反射）或字符串的高级操作的成本可能并不明显。

通常编译成与 C 一样快的二进制文件的两种语言是 Standard ML（使用[MLton](http://mlton.org/)编译器）和[Objective Caml](http://caml.inria.fr)。如果您查看[基准测试游戏](https://benchmarksgame-team.pages.debian.net/benchmarksgame/)，您会发现对于某些基准测试，例如二叉树，OCaml 版本比 C 更快。（我没有找到任何 MLton 条目。）但不要太认真地对待枪战；正如它所说，它是一款游戏，其结果通常反映了人们在调整代码方面付出了多少努力。

* * *

## 回答 #7

> 赞同：20
> 
> 时间：2009-01-07T04:36:14.750

C并不总是更快。

C 比例如 Modern Fortran 慢。

在某些方面，C 通常比 Java 慢。（尤其是在 JIT 编译器对您的代码进行了测试之后）

C 允许指针别名发生，这意味着一些好的优化是不可能的。特别是当您有多个执行单元时，这会导致数据获取停止。哦。

指针算术有效的假设确实会导致某些 CPU 系列（尤其是 PIC！）的性能缓慢臃肿，它曾经在分段 x86 上吸过大的。

基本上，当您获得向量单元或并行化编译器时，C 很臭，而现代 Fortran 运行得更快。

C 程序员的技巧，如 thunking（即时修改可执行文件）会导致 CPU 预取停顿。

你明白了吗？

而我们的好朋友 x86 执行的指令集如今与实际的 CPU 架构关系不大。影子寄存器、加载存储优化器，都在 CPU 中。所以 C 接近虚拟金属。真正的金属，英特尔不让你看到。（从历史上看，VLIW CPU 有点破产，所以也许这还不错。）

如果您在高性能 DSP（可能是 TI DSP？）上使用 C 语言进行编程，编译器必须做一些棘手的事情才能在多个并行执行单元中展开 C。所以在这种情况下，C 并不接近金属，但它接近编译器，它将进行整个程序优化。奇怪的。

最后，一些 CPU (www.ajile.com) 在硬件中运行 Java 字节码。C 将在该 CPU 上使用 PITA。

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2009-01-07T02:08:04.317

> 是什么阻止了其他语言能够编译成运行速度与 C 一样快的二进制文件？

没有。Java 或 .NET 语言等现代语言更注重程序员的生产力而不是性能。现在硬件很便宜。中间表示的编译也提供了很多好处，例如安全性、可移植性等。.NET CLR 可以利用不同的硬件 - 例如，您不需要手动优化/重新编译程序来使用 SSE 指令集。

* * *

## 回答 #9

> 赞同：11
> 
> 时间：2009-01-07T02:18:26.587

我猜你忘记了汇编语言也是一种语言:)

但说真的，只有当程序员知道自己在做什么时，C 程序才会更快。您可以轻松编写一个运行速度比用其他语言编写的执行相同工作的程序慢的 C 程序。

C之所以更快，是因为它是这样设计的。它可以让你做很多“低级”的事情，帮助编译器优化代码。或者，我们应该说，您是程序员负责优化代码。但这通常非常棘手且容易出错。

其他语言，就像已经提到的其他语言一样，更关注程序员的生产力。人们普遍认为，程序员的时间比机器时间贵得多（即使在过去）。因此，最大限度地减少程序员在编写和调试程序上花费的时间而不是程序的运行时间是很有意义的。为此，您将牺牲一些可以使程序更快的方法，因为很多事情都是自动化的。

* * *

## 回答 #10

> 赞同：9
> 
> 时间：2009-01-07T02:16:06.373

主要因素是它是一种静态类型的语言，并且被编译为机器代码。此外，由于它是一种低级语言，它通常不会做任何你不告诉它的事情。

这些是我想到的其他一些因素。

*   变量不会自动初始化
*   没有对数组进行边界检查
*   未经检查的指针操作
*   没有整数溢出检查
*   静态类型变量
*   函数调用是静态的（除非你使用函数指针）
*   编译器编写者有很多时间来改进优化代码。此外，人们使用 C 进行编程是为了获得最佳性能，因此存在优化代码的压力。
*   部分语言规范是实现定义的，因此编译器可以自由地以最优化的方式做事

大多数静态类型语言的编译速度可以与 C 一样快或更快，特别是如果它们可以假设 C 由于指针别名等原因不能编译时。

* * *

## 回答 #11

> 赞同：8
> 
> 时间：2011-08-11T20:20:30.833

C++ 平均速度更快（因为它最初是 C 的超集，尽管存在一些差异）。但是，对于特定的基准测试，通常会有另一种更快的语言。

[https://benchmarksgame-team.pages.debian.net/benchmarksgame/](https://benchmarksgame-team.pages.debian.net/benchmarksgame/)

`fannjuch-redux`在 Scala 中是最快的

`n-body`并且`fasta`在 Ada 中速度更快。

`spectral-norm`在 Fortran 中是最快的。

`reverse-complement`，`mandelbrot`并且`pidigits`在 ATS 中最快。

`regex-dna`在 JavaScript 中是最快的。

`chameneou-redux`最快的是 Java 7。

`thread-ring`在 Haskell 中是最快的。

其余的基准测试在 C 或 C++ 中是最快的。

* * *

## 回答 #12

> 赞同：7
> 
> 时间：2009-01-07T02:10:04.157

在大多数情况下，每条 C 指令都对应于极少数的汇编指令。您实际上是在编写更高级别的机器代码，因此您几乎可以控制处理器所做的一切。许多其他编译语言，例如 C++，有很多看起来很简单的指令，这些指令可以转化为比您想象的更多的代码（虚拟函数、复制构造函数等），而 Java 或 Ruby 等解释型语言还有另一层您从未见过的说明 - 虚拟机或解释器。

* * *

## 回答 #13

> 赞同：7
> 
> 时间：2009-01-11T00:11:03.450

我知道很多人都说得很啰嗦，但是：

> C 更快，因为它做的更少（对你来说）。

* * *

## 回答 #14

> 赞同：6
> 
> 时间：2009-06-22T23:52:41.153

其中许多答案给出了为什么 C 更快或不是更快（在一般情况下或在特定情况下）的正当理由。不可否认的是：

*   许多其他语言提供了我们认为理所当然的自动功能。例如，边界检查、运行时类型检查和自动内存管理并不是免费的。至少有*一些*与这些特性相关的成本，我们在编写使用这些特性的代码时可能不会考虑甚至意识到这一点。
*   从源代码到机器的步骤在其他语言中通常不像在 C 中那样直接。
*   OTOH，说编译后的 C 代码比用其他语言编写的其他代码执行得更快，这是一种概括，并不总是正确的。反例很容易找到（或设计）。

尽管如此，我还注意到其他一些因素，我认为它对 C 与许多其他语言的比较性能的影响比任何其他因素都大。以机智：

其他语言通常更容易编写执行速度较慢的代码。通常，它甚至受到该语言的设计理念的鼓励。推论：C 程序员更有可能编写不执行不必要操作的代码。

例如，考虑一个简单的 Windows 程序，其中创建了一个主窗口。AC 版本将填充一个`WNDCLASS[EX]`结构，该结构将传递给`RegisterClass[Ex]`，然后调用`CreateWindow[Ex]`并进入消息循环。高度简化和缩写的代码如下：

```
WNDCLASS wc;
MSG      msg;

wc.style         = 0;
wc.lpfnWndProc   = &WndProc;
wc.cbClsExtra    = 0;
wc.cbWndExtra    = 0;
wc.hInstance     = hInstance;
wc.hIcon         = NULL;
wc.hCursor       = LoadCursor(NULL, IDC_ARROW);
wc.hbrBackground = (HBRUSH)(COLOR_BTNFACE + 1);
wc.lpszMenuName  = NULL;
wc.lpszClassName = "MainWndCls";

RegisterClass(&wc);

CreateWindow("MainWndCls", "", WS_OVERLAPPEDWINDOW | WS_VISIBLE,
             CW_USEDEFAULT, 0, CW_USEDEFAULT, 0, NULL, NULL, hInstance, NULL);

while(GetMessage(&msg, NULL, 0, 0)){
    TranslateMessage(&msg);
    DispatchMessage(&msg);
} 
```

C# 中的等效程序可能只是一行代码：

```
Application.Run(new Form()); 
```

这一行代码提供了近 20 行 C 代码所做的所有功能，并添加了一些我们遗漏的东西，例如错误检查。更丰富、更完整的库（与典型 C 项目中使用的库相比）为我们做了很多工作，腾出时间来编写更多在我们看来很短但涉及许多幕后步骤的代码片段。

但是一个丰富的库可以实现简单快速的代码膨胀并不是我的重点。当您开始检查当我们的小单线实际执行时实际发生的情况时，我的观点会更加明显。有时为了好玩，在 Visual Studio 2008 或更高版本中[启用 .NET 源代码访问](http://weblogs.asp.net/scottgu/archive/2008/01/16/net-framework-library-source-code-now-available.aspx)，然后进入上面的简单单行。您会遇到的有趣的小宝石之一是 getter 中的以下评论`Control.CreateParams`：

```
// In a typical control this is accessed ten times to create and show a control.
// It is a net memory savings, then, to maintain a copy on control.
// 
if (createParams == null) {
    createParams = new CreateParams(); 
} 
```

**十次**。该信息大致相当于存储在结构中的内容和传递给的内容的总和，在将`WNDCLASSEX`其存储在结构中并传递给and*之前*`CreateWindowEx`，从类中检索`Control`十次。*`WNDCLASSEX``RegisterClassEx``CreateWindowEx`*

 *总而言之，在 C# 中执行此非常基本任务的指令数量比在 C 中多 2-3 个数量级。部分原因是使用了功能丰富的库，该库必须是通用的，而不是我们简单的 C 代码正是我们需要的，仅此而已。但部分原因在于 .NET 框架的模块化、面向对象的特性使其自身产生大量重复执行，而这些重复执行通常可以通过过程方法避免。

我不想选择 C# 或 .NET 框架。我也不是说模块化、泛化、库/语言特性、OOP 等都是*坏事*。我过去大部分的开发都是用 C 语言，后来是 C++，最近是 C#。同样，在 C 之前，我主要使用汇编。并且随着我的语言“更高”的每一步，我会在更短的时间内编写更好、更可维护、更健壮的程序。但是，它们确实倾向于执行得更慢一些。

* * *

## 回答 #15

> 赞同：6
> 
> 时间：2011-07-27T17:19:36.823

我认为没有人提到 C 编译器比任何其他编译器都付出了更多的努力，也许 Java 除外。

由于已经说明的许多原因，C 具有极强的优化能力 - 几乎比任何其他语言都多。因此，如果在其他语言编译器上投入同样多的努力，C 可能仍会名列前茅。

我认为至少有一种候选语言可以通过努力得到比 C 更好的优化，因此我们可以看到产生更快二进制文件的实现。我正在考虑数字火星 D，因为创建者小心翼翼地构建了一种可能比 C 更好优化的语言。可能还有其他语言具有这种可能性。但是我无法想象任何语言的编译器都会比最好的 C 编译器快几个百分点。我很想错。

我认为真正的“唾手可得的果实”将是设计为易于人类优化的语言。熟练的程序员可以让任何语言变得更快——但有时你必须做一些荒谬的事情或使用不自然的结构来实现这一点。尽管总是需要付出努力，但一门好的语言应该可以生成相对较快的代码，而不必纠结于程序是如何编写的。

同样重要的是（至少对我而言）最坏情况的代码往往很快。网络上有许多“证据”表明 Java 与 C 一样快或更快，但这是基于挑选示例的。我不是 C 的忠实粉丝，但我知道我用 C 编写的任何东西都会运行良好。使用 Java，它“可能”会以 15% 的速度运行，通常在 25% 以内，但在某些情况下可能会更糟。任何与它一样快或在百分之几以内的情况通常是由于大部分时间花在库代码中，而库代码无论如何都经过了高度优化。

* * *

## 回答 #16

> 赞同：5
> 
> 时间：2009-01-07T03:54:54.567

这实际上是一个永恒的谎言。虽然 C 程序确实通常更快，但情况并非总是如此，尤其是在 C 程序员不是很擅长的情况下。

人们往往会忘记的一个明显的大漏洞是程序必须阻塞某种 IO，例如任何 GUI 程序中的用户输入。在这些情况下，您使用哪种语言并不重要，因为您受限于数据传入的速度，而不是处理数据的速度。在这种情况下，使用 C、Java、C# 甚至 Perl 并不重要；你不能比数据进来的速度更快。

另一个主要的事情是使用垃圾收集而不使用正确的指针允许虚拟机进行许多其他语言中不可用的优化。例如，JVM 能够在堆上移动对象以对其进行碎片整理。这使得未来的分配更快，因为可以简单地使用下一个索引而不是在表中查找它。现代 JVM 也不必实际释放内存。相反，它们只是在 GC 时移动活动对象，并且从死对象中消耗的内存基本上是免费恢复的。

这也提出了一个关于 C 的有趣观点，在 C++ 中更是如此。有一种设计理念是“如果你不需要它，你就不用付钱”。问题是，如果你确实想要它，你最终会为此付出代价。例如，Java 中的 vtable 实现往往比 C++ 实现要好得多，因此虚函数调用要快得多。另一方面，你别无选择，只能在 Java 中使用虚函数，它们仍然会花费一些成本，但在使用大量虚函数的程序中，降低的成本会增加。

* * *

## 回答 #17

> 赞同：4
> 
> 时间：2009-01-07T02:10:21.957

与其说是语言，不如说是工具和库。C 的可用库和编译器比新语言的要旧得多。您可能认为这会使它们变慢，但恰恰相反。

这些库是在处理能力和内存非常宝贵的时候编写的。为了工作，它们必须*非常有效地编写。*C 编译器的开发人员也花了很长时间为不同的处理器进行各种巧妙的优化。C 的成熟度和广泛采用使其比同龄的其他语言具有显着优势。与不强调原始性能的新工具相比，它还为 C 提供了速度优势。

* * *

## 回答 #18

> 赞同：4
> 
> 时间：2009-01-07T02:15:55.813

缺乏抽象是使 C 更快的原因。如果你写了一个输出语句，你就知道到底发生了什么。如果您在 java 中编写输出语句，它将被编译成一个类文件，然后在引入抽象层的虚拟机上运行。作为语言的一部分，缺乏面向对象的特性也提高了它的速度，从而减少了生成的代码。如果您使用 C 作为面向对象的语言，那么您正在为诸如类、inharitence 等事物进行所有编码。这意味着而不是为每个人制作足够通用的东西，而代码量和性能要求只需要您编写你需要什么来完成工作。

* * *

## 回答 #19

> 赞同：4
> 
> 时间：2009-01-07T03:10:22.817

令人惊讶的是，古老的“C/C++*必须*比 Java 更快，因为 Java 是解释型的”神话仍然存在并且还在继续。有一些[文章可以追溯到几年前](http://www.idiom.com/~zilla/Computer/javaCbenchmark.html)，以及[最近的文章](http://kano.net/javabench/)，它们用概念或测量来解释为什么[并非总是如此](http://en.wikipedia.org/wiki/Java_performance)。

当前的虚拟机实现（顺便说一下，不仅仅是 JVM）可以利用在程序执行期间收集的信息，使用多种技术在代码运行时动态调整代码：

*   将频繁的方法呈现为机器代码，
*   内联小方法，
*   锁定调整

以及基于知道代码实际在做什么以及它运行的环境的实际特征的[各种其他调整。](http://java.sun.com/performance/reference/whitepapers/6_performance.html)

* * *

## 回答 #20

> 赞同：4
> 
> 时间：2009-01-08T20:55:18.673

运行速度最快的代码将是精心手工制作的机器代码。汇编程序几乎一样好。两者都非常低级，需要大量编写代码才能完成。C略高于汇编程序。你仍然有能力在实际机器中控制非常低级别的东西，但是有足够的抽象使得编写它比汇编程序更快、更容易。其他语言如 C# 和 JAVA 则更加抽象。虽然汇编程序和机器代码被称为低级语言，但 C# 和 JAVA（以及许多其他语言）被称为高级语言。C 有时被称为中级语言。

* * *

## 回答 #21

> 赞同：3
> 
> 时间：2010-10-26T18:23:41.630

**不要相信别人的话，在代码的任何性能关键部分查看 C 和您选择的语言的反汇编。**我认为您可以在 Visual Studio 的运行时查看反汇编窗口以查看反汇编的 .Net。如果使用 windbg 对 Java 来说很棘手的话，应该是可能的，但如果你用 .Net 来做，很多问题都是一样的。

如果不需要的话，我不喜欢用 C 编写，但我认为这些答案中提出的许多吹捧 C 以外语言的速度的主张可以通过简单地反汇编 C 中的相同例程和使用您选择的高级语言，尤其是在涉及大量数据的情况下，这在性能关键型应用程序中很常见。Fortran 可能是其专业领域的一个例外，不知道。是不是比C高？

我第一次将 JITed 代码与本机代码进行比较时，解决了 .Net 代码是否可以与 C 代码类似地运行的所有问题。额外的抽象级别和所有安全检查都带来了巨大的成本。相同的成本可能适用于 Java，但不要相信我的话，在性能至关重要的地方尝试一下。（任何人都对 JITed Java 有足够的了解，可以在内存中找到编译过的过程吗？当然应该可以）

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2009-01-14T03:35:11.523

1）正如其他人所说，C为你做的更少。没有初始化变量，没有数组边界检查，没有内存管理等。其他语言中的这些特性会消耗 C 不花费的内存和 CPU 周期。

2) 我认为 C 的抽象程度较低，因此速度更快的答案只对了一半。从技术上讲，如果你有一个用于语言 X 的“足够先进的编译器”，那么语言 X 可以接近或等于 C 的速度。与 C 的不同之处在于，因为它的映射非常明显（如果你参加过架构课程）并且直接到汇编语言，即使是一个天真的编译器也可以做得很好。对于像 Python 这样的东西，您需要一个非常先进的编译器来预测对象的可能类型并动态生成机器代码——C 的语义非常简单，一个简单的编译器就可以做得很好。

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2009-01-14T04:22:31.943

回到过去，只有两种类型的语言：编译型和解释型。

编译语言使用“编译器”来读取语言语法并将其转换为相同的汇编语言代码，而不仅仅是直接在 CPU 上。解释型语言使用了几种不同的方案，但本质上语言语法被转换为中间形式，然后在“解释器”中运行，即执行代码的环境。

因此，从某种意义上说，在代码和机器之间还有另一个“层”——解释器。而且，与计算机的情况一样，更多意味着使用更多资源。口译员速度较慢，因为他们必须执行更多操作。

最近，我们看到了更多混合语言，如 Java，它们同时使用编译器和解释器来使它们工作。这很复杂，但是 JVM 比旧的解释器更快、更复杂、更优化，因此它代表了更好的性能变化（随着时间的推移），更接近于直接编译的代码。当然，较新的编译器也有更多花哨的优化技巧，因此它们也倾向于生成比以前更好的代码。但是大多数优化通常（尽管并非总是）进行某种类型的权衡，以便它们在所有情况下并不总是更快。像其他一切一样，没有什么是免费的，所以优化器必须从某个地方吹嘘（尽管经常使用编译时 CPU 来节省运行时 CPU）。

回到 C，它是一种简单的语言，可以编译成相当优化的程序集，然后直接在目标机器上运行。在 C 中，如果你增加一个整数，它很可能只是 CPU 中的一个汇编程序步骤，但是在 Java 中，它最终可能远不止于此（并且还可能包括一些垃圾收集： -) C 为您提供了一种更接近机器的抽象（汇编程序是最接近的），但您最终不得不做更多的工作才能让它运行，而且它没有那么受保护、易于使用或错误友好。大多数其他语言为您提供更高的抽象性并为您处理更多的底层细节，但作为交换它们的高级功能，它们需要更多资源来运行。当你概括一些解决方案时，你必须处理更广泛的计算，

保罗。

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2017-12-18T08:02:36.093

撇开[热点优化](https://en.wikipedia.org/wiki/Profile-guided_optimization)、[预编译元算法](https://en.wikipedia.org/wiki/Template_metaprogramming)和各种形式的[并行](https://stackoverflow.com/questions/14674049/parallel-for-vs-omp-simd-when-to-use-each)性等高级优化技术不谈，语言的基本速度与支持通常会执行的操作所需的**隐式幕后复杂性密切相关。在**[内部循环](https://en.wikipedia.org/wiki/Inner_loop)中指定。

也许最明显的是对间接内存引用的有效性检查——例如检查指针`null`和检查数组边界的索引。大多数高级语言都会隐式执行这些检查，但 C 不会。然而，*这不一定是这些其他语言的基本限制*——足够聪明的编译器可能能够通过某种形式的[循环不变代码运动](https://en.wikipedia.org/wiki/Loop-invariant_code_motion)从算法的内部循环中删除这些检查。

C（以及在类似程度上密切相关的 C++）更基本的优势是严重依赖基于[堆栈的内存分配](https://en.wikipedia.org/wiki/Stack-based_memory_allocation)，它**本质上**对于分配、解除分配和访问来说是快速的。在 C（和 C++）中，主[调用堆栈](https://en.wikipedia.org/wiki/Call_stack)可用于分配基元、数组和聚合 ( `struct`/ `class`)。

虽然 C 确实提供了[动态分配](https://en.wikipedia.org/wiki/C_dynamic_memory_allocation)任意大小和生命周期内存的能力（使用所谓的“堆”），但默认情况下会避免这样做（改为使用堆栈）。

有趣的是，有时可以在其他编程语言的运行时环境中复制 C 内存分配策略。[asm.js](https://en.wikipedia.org/wiki/Asm.js)已经证明了这一点，它允许将用 C 或 C++ 编写的代码翻译成 JavaScript 的子集，并在 Web 浏览器环境中安全运行——以接近原生的速度。

* * *

顺便说一句，C 和 C++ 在速度方面胜过大多数其他语言的另一个领域是与本机机器指令集无缝集成的能力。一个值得注意的例子是[SIMD 内在函数](https://en.wikipedia.org/wiki/SIMD)的（编译器和平台相关）可用性，它支持构建自定义算法，利用现在几乎无处不在的并行处理硬件 - 同时仍然利用语言提供的数据分配抽象（较低级寄存器分配由编译器管理）。

* * *

## 回答 #25

> 赞同：2
> 
> 时间：2018-03-31T07:39:02.683

我在链接上找到了一个关于为什么有些语言更快而有些更慢的答案，我希望这能更清楚地说明为什么 C 或 C++ 比其他语言更快，还有一些其他语言也比 C 更快，但我们不能全部使用。一些解释——

Fortran 仍然重要的一个重要原因是它的速度很快：用 Fortran 编写的数字运算例程往往比用大多数其他语言编写的等效例程更快。使用在该领域与 Fortran 竞争的语言（C 和 C++）是因为它们在此性能方面具有竞争力。

这就提出了一个问题：为什么？C++ 和 Fortran 是什么让它们变得快速，为什么它们的性能优于其他流行语言，例如 Java 或 Python？

解释与编译 有很多方法可以对编程语言进行分类和定义，这取决于它们鼓励的编程风格和它们提供的特性。在查看性能时，最大的区别在于解释型语言和编译型语言。

划分并不难。相反，有一个频谱。一方面，我们有传统的编译语言，包括 Fortran、C 和 C++。在这些语言中，有一个离散的编译阶段，将程序的源代码翻译成处理器可以使用的可执行形式。

这个编译过程有几个步骤。对源代码进行分析和解析。此时可以检测到基本的编码错误，例如拼写错误和拼写错误。解析后的代码用于生成内存中的表示，它也可用于检测错误——这次是语义错误，例如调用不存在的函数，或尝试对文本字符串执行算术运算。

然后，此内存表示用于驱动代码生成器，即生成可执行代码的部分。代码优化，以提高生成代码的性能，在此过程中的不同时间执行：可以对代码表示执行高级优化，而对代码生成器的输出使用较低级别的优化。

实际上执行代码发生在稍后。整个编译过程只是用来创建可以执行的东西。

在另一端，我们有口译员。解释器将包括一个与编译器类似的解析阶段，但随后用于驱动直接执行，程序立即运行。

最简单的解释器在其中包含与该语言支持的各种功能相对应的可执行代码，因此它将具有添加数字、连接字符串以及给定语言具有的任何其他功能。在解析代码时，它会查找相应的函数并执行它。在程序中创建的变量将保存在某种查找表中，将它们的名称映射到它们的数据。

解释器风格最极端的例子是批处理文件或 shell 脚本。在这些语言中，可执行代码通常甚至不内置于解释器本身，而是独立的独立程序。

那么为什么这会对性能产生影响呢？通常，每一层间接都会降低性能。例如，将两个数字相加的最快方法是将这两个数字都保存在处理器的寄存器中，并使用处理器的加法指令。这就是编译程序可以做的；他们可以将变量放入寄存器并利用处理器指令。但是在解释程序中，相同的加法可能需要在变量表中进行两次查找以获取要加法的值，然后调用函数来执行加法。该函数很可能使用与编译程序用于执行实际加法相同的处理器指令，但是在实际使用指令之前的所有额外工作会使事情变慢。

如果您想了解更多信息，请查看[来源](https://arstechnica.com/information-technology/2014/05/ask-ars-why-are-some-programming-languages-faster-than-others/)

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2009-01-07T02:11:32.297

一些 C++ 算法比 C 更快，而其他语言的算法或设计模式的一些实现可能比 C 更快。

当人们说 C 很快，然后继续谈论其他语言时，他们通常以 C 的性能作为基准。

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2009-01-07T05:37:11.740

使用现代优化编译器，纯 C 程序不太可能比已编译的 .net 代码快得多，如果有的话。借助 .net 等框架为开发人员提供的生产力增强功能，您可以在过去的常规 C 语言中花费数周或数月的时间完成工作。再加上与开发人员的薪水相比，硬件成本低廉，编写起来*要*便宜得多使用高级语言的东西并以任何缓慢的速度抛出硬件。

Jeff 和 Joel 之所以说 C 是“真正的程序员”语言，是因为 C 中没有手把手。你必须分配自己的内存、释放内存、进行自己的边界检查等。没有这样的事情作为新对象（）；没有垃圾收集、类、OOP、实体框架、LINQ、属性、属性、字段或类似的东西。您必须了解诸如指针算术以及如何取消引用指针之类的知识。而且，就此而言，了解并理解指针是什么。您必须知道堆栈帧是什么以及指令指针是什么。你必须知道你正在研究的 CPU 架构的内存模型。对微型计算机的体系结构有很多隐含的理解（通常*是*您正在使用的微型计算机）在用 C 语言编程时，在用 C# 或 Java 等编程时根本不存在也没有必要。所有这些信息都已卸载到编译器（或 VM）程序员。

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2017-09-15T03:51:11.997

这是自动和手动之间的区别，高级语言是抽象的，因此是自动化的。C/C++ 是手动控制和处理的，甚至错误检查代码有时也是一项人工劳动。

C 和 C++ 也是编译语言，这意味着它们都不能在任何地方运行，这些语言必须针对您使用的硬件进行微调，从而增加了一层额外的陷阱。尽管随着 C/C++ 编译器在所有平台上变得越来越普遍，现在这有点过时了。您可以在平台之间进行交叉编译。它仍然不是到处运行的情况，您基本上指示编译器 A 针对编译器 B 编译相同的代码不同的架构。

底线 C 语言并不意味着易于理解或推理，这也是它们被称为系统语言的原因。他们出现在所有这些高级抽象废话之前。这也是为什么它们不用于前端 Web 编程的原因。他们只是不适合这项任务，他们的意思是解决传统语言工具无法解决的复杂问题。

这就是为什么你会得到一些疯狂的东西，比如（微架构、驱动程序、量子物理、AAA 游戏、操作系统），有些东西 C 和 C++ 非常适合。速度和数字运算是主要领域。

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2018-08-02T17:41:02.533

C 速度很快，因为它是本机编译的低级语言。但是C并不是最快的。[Recursive Fibonacci Benchmark](https://github.com/drujensen/fib#natively-compiled-statically-typed)表明Rust、Crystal 和 Nim 可以更快。

* * *

## 回答 #30

> 赞同：1
> 
> 时间：2019-11-21T00:37:56.297

原因有很多，包括：

*   它编译成汇编语言。
*   它是静态类型的。
*   没有垃圾收集。
*   无异常机制。
*   编译器优化
*   C 的部分哲学是保持简单并保持向后兼容性，而不是添加更多功能。

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2009-01-07T05:36:21.417

甚至 C 和 C++ 之间的差异有时也会很大。

当您为对象分配内存、调用构造函数、在字边界上对齐内存等时，程序最终会经历大量从程序员那里抽象出来的开销。

C 强制您查看程序正在做的每一件事，通常是非常详细的。这使得编写执行大量任务的代码变得更加困难（尽管并非不可能）。

因此，例如在 BASIC 程序中，您将使用 INPUT 关键字从 STDIN 读取字符串并自动为其变量分配内存，而在 C 中，程序员通常已经分配了内存并可以控制诸如程序是否为 I 阻塞之类的事情/O 与否，如果它在获得所需信息后停止读取输入，或者继续读取字符到行尾。

C 也比其他语言执行更少的错误检查，假设程序员知道他们在做什么。因此，在 PHP 中，如果您声明一个字符串`$myStr = getInput();`并继续引用`$myStr[20]`，但输入的长度只有 10 个字符，PHP 会捕捉到这一点并安全地返回给您一个空白字符串。C 假设您已经分配了足够的内存来保存字符串末尾之后的数据，或者您知道字符串后面有什么信息并试图引用它。这些小因素总体上会对开销产生巨大影响。

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2009-01-08T21:05:12.897

只需单步执行 IDE 中的机器代码，您就会明白为什么它更快（如果它更快的话）。它省去了很多牵手。很有可能您的 Cxx 也可以被告知将其排除在外，在这种情况下，它应该大致相同。

编译器优化被高估了，几乎所有关于语言速度的看法都是如此。

生成代码的优化只对热点代码产生影响，即没有函数调用（显式或隐式）的严格算法。在其他任何地方，它取得的成就都很少。

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2009-06-22T21:05:36.420

实际上，在某些应用程序（数字）中，甚至可以击败 C，我指的不是汇编语言，而是旧的、经常被嘲笑的 Fortran。原因是，Fortran 保证没有指针别名。

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2018-05-24T16:15:36.100

这都是关于时间和精力的。

给定无限量的时间和精力：

*   汇编程序将比用 C 编写的程序快。
*   AC 程序将比用 C++ 编写的程序快。

给定固定的时间和精力：

*   C++ 程序将比用 C 编写的程序快。
*   AC 程序将比用汇编编写的程序快。

为什么？因为你做的抽象越多，你可以花更多的时间优化真正重要的代码的关键部分。这里有几个假设是开发人员在所有三种语言中都同样胜任，你不关心二进制大小、内存使用等。

每个抽象都具有成本性能，但应该使代码更容易和更快地编写。

# python - Pythonic 相当于 unshift 或 redo？

> ID：418915
> 
> 赞同：12
> 
> 时间：2009-01-07T01:59:07.657
> 
> 标签：python, redo

我正在学习 Python，我有一种情况，我想使用迭代器中的项目。棘手的部分是，在某些条件下，我想“取消迭代”。也就是说，在循环之前将一个项目放回迭代器的前面。

例如，假设我正在从树上摘苹果。我的水果篮只能装 10 公斤，然后才需要清空。但是我必须先挑选每个苹果，然后才能称重并确定这个苹果是否会超过篮子的容量。

在像 Perl 这样的语言中，我可以`unshift()`将苹果放回树上，然后让循环表达式重新挑选苹果：

```
while ($apple = shift(@tree)) {
  $wt = weight($apple);
  if ($wt + weight(@basket) > 10) {
    send(@basket);
    @basket = ();
    unshift(@tree, $apple);
  } else {
    push(@basket, $element);
  }
} 
```

否则我也可以使用`redo`，它在块顶部恢复处理，而不评估循环表达式。因此，在篮子被清空后，同一个苹果可以重新加工。

```
while ($apple = shift(@tree)) {
  $wt = weight($apple);
  if ($wt + weight(@basket) > 10) {
    send(@basket);
    @basket = ();
    redo;
  } else {
    push(@basket, $apple);
  }
} 
```

对于这类问题，最**Pythonic的解决方案是什么？**

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-07T02:27:28.707

> 我正在学习 Python，我有一种情况，我想使用迭代器中的项目。棘手的部分是，在某些条件下，我想“取消迭代”。也就是说，在循环之前将一个项目放回迭代器的前面。

这是一个简单的解决方案：

```
class MyIterator(object):   # undo-able iterator wrapper
    def __init__(self, iterable):
        super(MyIterator, self).__init__()
        self.iterator = iter(iterable)
        self.stack = []

    def __iter__(self):
        return self

    def next(self):
        if self.stack:
            return self.stack.pop()
        return self.iterator.next()  # Raises StopIteration eventually

    def undo(self, item):
        self.stack.append(item) 
```

```
for i in  MyIterator(xrange(5)): print i
0
1
2
3
4 
```

```
rng = MyIterator(xrange(5))
rng.next()
0
rng.next()
1
rng.undo(1)
rng.next()
1 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-01-07T02:12:11.360

当 else 子句应该总是出现时，为什么还要为 unshifting 烦恼呢？

```
for apple in tree:
    if (apple.weight + basket.weight) > 10:
       send(basket)
       basket.clear()
    basket.add(apple) 
```

无论如何，我相当肯定 Python 没有您正在寻找的那种行为。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-07T06:09:24.657

我会说[最 Pythonic 的解决方案是最简单的解决方案](http://mail.python.org/pipermail/python-list/2004-March/253893.html)。与其尝试将迭代器包装在允许您“回溯”或类似复杂的生成器表达式中，不如使用 while 循环，就像在 Perl 中一样！**[迭代器不能很好地与 mutation 混合](https://stackoverflow.com/questions/299135/when-i-sort-a-list-what-happens-to-its-iterators)**，任何人。

您的实现的简单翻译（忽略[@Patrick](https://stackoverflow.com/questions/418915/pythonic-equivalent-of-unshift-or-redo#418946)的优化）：

```
while tree:
    apple = tree.pop(0)
    if apple.weight + basket.weight > 10:
        basket.send()
        basket.clear()
        tree.insert(0, apple) # Put it back.
    else:
        basket.append(apple) 
```

或者，您可以使用`peek`带有有序序列索引的 -like 功能：

```
while tree:
    apple = tree[0] # Take a peek at it.
    if apple.weight + basket.weight > 10:
        basket.send()
        basket.clear()
    else:
        basket.append(tree.pop(0)) 
```

如果您不喜欢“简单”参数，请查看`collections.deque`上述（链接）线程中提到的迭代器。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-07T12:40:38.250

如果您不想遵循其他人的建议，即删除 else 子句，您可以编写自己的`unshift`函数，该函数将以类似于 perl 的任何可迭代方式工作：

```
class UnshiftableIterable(object):
    def __init__(self, iterable):
        self._iter = iter(iterable)
        self._unshifted = [] # empty list of unshifted stuff
    def __iter__(self):
        while True:
            if self._unshifted:
                yield self._unshifted.pop()
            else:
                yield self._iter.next()
    def unshift(self, item):
        self._unshifted.append(item) 
```

然后在您的代码中：

```
it = UnshiftableIterable(tree)
for apple in tree:
    if weigth(basket) + weight(apple) > MAX_WEIGHT:
        send(basket)
        basket = []
        it.unshift(apple)
    else:
        basket.append(apple) 
```

一些测试`UnshiftableIterable`：

```
it = UnshiftableIterable(xrange(5))

for i in it:
    print '*',
    if i == 2:
        it.unshift(10)
    else:
        print i,
# output: * 0 * 1 * * 10 * 3 * 4 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-07T03:29:59.890

您正在寻找一个生成器，一个可以通过 send() 方法接收对其内部状态的修改的迭代器

[https://docs.python.org/howto/functional.html#passing-values-into-a-generator](https://docs.python.org/howto/functional.html#passing-values-into-a-generator)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-04-14T01:41:59.280

顺便说一句，你真正想要的是 list.insert(0,yourObject)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-07T02:36:02.153

在我写这篇文章时，@Patrick 已经提出了同样的建议。但既然我已经写了它，我还是会粘贴代码，并在 Patrick 的代码标记方法中添加注释。

```
import random

apples=[random.randint(1,3) for j in range(10)]
print 'apples',apples

basket=[]
y=6
baskets=[]

for i in range(len(apples)):
    if sum(basket+[apples[i]])>y:
        #basket is full                                                                                                                                     
        baskets.append(basket)#basket.send()                                                                                                                
        basket=[]#basket.empty()                                                                                                                            
    basket.append(apples[i])#add apple to basket                                                                                                            

print 'baskets',baskets 
```

虽然这不会 pop() 来自原始迭代器的苹果。请备注这是否也是一种理想的行为。

输出

```
apples [1, 1, 3, 3, 1, 1, 3, 3, 2, 3]
baskets [[1, 1, 3], [3, 1, 1], [3, 3]] 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2021-12-29T11:43:59.507

目前我的升级版[pythonizer](https://github.com/snoopyjc/pythonizer)无法处理`redo`，但如果我添加它，我可能会像这样实现它：

```
while (apple:=(tree.pop(0) if tree else None)):
    while True:
        wt = weight(apple)
        if wt+weight(*basket) > 10:
            sendit(basket)
            basket = []
            continue
        else:
            basket.append(apple)
        break 
```

（注意：我必须更改`send`为，`sendit`因为`send`在 perl 中是预定义的。）

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-02-06T21:20:56.743

回到最初关于实施 unshift 的问题，operator.delitem 可以用来实现一个简单的非 OO 函数：

```
from operator import delitem

def unshift(l,idx):
    retval = l[0]
    delitem(l,0)
    return retval

x = [2,4,6,8]

firstval = unshift(x,0)

print firstval,x 
```

2 [4, 6, 8]

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2009-01-07T02:18:04.250

没有办法将值推送到 python 中的迭代器中。堆栈或链表更适合于此。

如果您正在迭代列表或其他内容，当然您可以手动将项目添加回列表。但是您也可以迭代无法以这种方式操作的对象。

如果您想使用 python 来实现该算法，您必须选择一个允许您想要使用的操作的数据结构。我建议使用`.push()`and`.pop()`方法让您将列表视为堆栈。

# string - 通过批处理文件删除txt文件中的某些行

> ID：418916
> 
> 赞同：82
> 
> 时间：2009-01-07T01:59:41.977
> 
> 标签：string, batch-file

我有一个生成的 txt 文件。该文件有一些多余的行，需要删除。需要删除的每一行在该行中有两个字符串之一；“错误”或“参考”。这些标记可能出现在行中的任何位置。我想删除这些行，同时保留所有其他行。

因此，如果 txt 文件如下所示：

```
良好的数据线
C:\Directory\ERROR\myFile.dll 的坏行
另一个很好的数据线
坏行：参考
好线

```

我希望文件最终是这样的：

```
良好的数据线
另一个很好的数据线
好线

```

TIA。

* * *

## 回答 #1

> 赞同：115
> 
> 时间：2009-01-07T02:12:37.987

使用以下内容：

```
type file.txt | findstr /v ERROR | findstr /v REFERENCE 
```

这具有在 Windows 操作系统中使用标准工具的优势，而不必查找和安装 sed/awk/perl 等。

有关它的运行情况，请参见以下成绩单：

```
C:\>输入文件.txt
良好的数据线
C:\Directory\ERROR\myFile.dll 的坏行
另一个很好的数据线
坏行：参考
好线

C:\>输入文件.txt | findstr /v 错误 | findstr /v 参考
良好的数据线
另一个很好的数据线
好线

```

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2013-04-18T18:47:00.920

您可以单独使用 findstr 来完成与@paxdiablo 相同的解决方案。无需将多个命令连接在一起：

```
findstr /V "ERROR REFERENCE" infile.txt > outfile.txt 
```

这是如何工作的详细信息：

*   /v 查找与搜索字符串不匹配的行（@paxdiablo 使用相同的开关）
*   如果搜索字符串在引号中，则使用每个单词执行 OR 搜索（分隔符是空格）
*   findstr 可以接受一个输入文件，你不需要使用“type”命令给它输入文本
*   "> outfile.txt" 会将结果发送到文件 outfile.txt，而不是将它们打印到您的控制台。（请注意，如果文件存在，它将覆盖文件。如果要追加，请改用“>> outfile.txt”。）
*   您也可以考虑添加 /i 开关来进行不区分大小写的匹配。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-07T02:10:03.047

如果你有 sed：

```
sed -e '/REFERENCE/d' -e '/ERROR/d' [FILENAME] 
```

`FILENAME`带有好坏行的文本文件的名称在哪里

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-07T02:12:35.257

如果您安装了 perl，那么`perl -i -n -e"print unless m{(ERROR|REFERENCE)}"`应该可以解决问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-09-24T01:31:55.653

似乎使用 the`FIND`而不是`FINDSTR`can 也支持 unicode 字符。例如`type file.txt | find /v "Ω"`

# postgresql - 废弃的 Postgres 模板1

> ID：418935
> 
> 赞同：3
> 
> 时间：2009-01-07T02:09:39.273
> 
> 标签：postgresql, templates

我在 psql 中搞砸了，并在意识到它们的用法之前重命名了 template0 和 template1。现在，当我尝试重新创建模板 1 时，我从 psql 和表单命令行中获得“复制数据库模板 1 的权限被拒绝”。

为了节省时间，我还需要了解关于 template1 与 /data/base 中的 OS 读/写权限或授予 template1 等相关的其他信息吗？

TIA

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2010-07-13T08:05:48.777

你必须告诉 PostGreSQL 那`template1`是一个模板。如果你不这样做，如果你不是所有者，你将不能复制它：

```
UPDATE pg_database SET datistemplate = TRUE WHERE datname = 'template1'; 
```

我必须阅读`/src/backend/commands/dbcommands.c`（由 Google 找到）的源代码才能理解这一点。它说：

```
/*
 * Permission check: to copy a DB that's not marked datistemplate, you
 * must be superuser or the owner thereof.
 */
if (!src_istemplate)
{
        if (!pg_database_ownercheck(src_dboid, GetUserId()))
                ereport(ERROR,
                                (errcode(ERRCODE_INSUFFICIENT_PRIVILEGE),
                                 errmsg("permission denied to copy database \"%s\"",
                                                dbtemplate)));
} 
```

[我在博客上](http://blog.endpoint.com/2010/05/postgresql-template-databases-to.html)找到了怎么做

[我的类似问题](https://serverfault.com/questions/159646/postgresql-encoding-problem-when-createdb-and-lc-allc/159859)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-20T13:42:36.413

您如何尝试“重新创建模板 1”？

最简单的方法是删除“template1”模式并从“template0”模式重新创建它。也就是说 - 如果“template0”仍然存在。

更多 -[在这里](http://www.postgresql.org/docs/current/static/manage-ag-templatedbs.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-16T20:03:07.837

你重命名了这两个数据库？也许这会做你需要的：

```
UPDATE pg_database SET datistemplate = TRUE, datname = 'template0' WHERE datname = 'current_template0_name';

UPDATE pg_database SET datistemplate = TRUE, datname = 'template1' WHERE datname = 'current_template1_name'; 
```

# asp.net - 支持 Value 属性的 .NET CheckBox 控件

> ID：418947
> 
> 赞同：2
> 
> 时间：2009-01-07T02:12:13.900
> 
> 标签：asp.net, checkbox, user-controls, checkboxlist

我知道默认的 .NET CheckBox 控件不支持 Value 属性。这对我来说似乎很奇怪，因为输入控件确实支持值作为 html 规范的一部分。

所以我的问题是这里是否有人知道asp.net 的自定义用户控件，其行为类似于标准的ASP .NET CheckBox 和CheckBoxList？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-08T06:32:33.640

也许我误解了你的问题，但你知道你也可以使用典型的 HTML 控件吗？

例如，创建一个 ASPX 页面并添加以下源：

```
 <div>
            <input type="checkbox" runat="server" id="chkBox" value="test" />
            <asp:Label ID="lblCheckboxValue" runat="server" />
    </div>

    <asp:Button runat="server" OnClick="Button_Click" /> 
```

然后在你的代码后面添加以下代码：

```
protected void Button_Click(object sender, EventArgs e)
        {
            if (chkBox.Checked)
                lblCheckboxValue.Text = chkBox.Value;
            else
                lblCheckboxValue.Text = "";

        } 
```

您可以将 html 复选框值属性设置为您喜欢的任何值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T02:29:26.143

如果您只需要在服务器端访问它，您可以轻松创建一个继承 Checkbox 控件的服务器控件，并向其添加一个名为 value 的属性，该属性可以从服务器端设置和检索。

但是，如果您需要从客户端访问它，您将不得不对服务器控件呈现的内容充满想象力 - 可能是复选框和隐藏字段的组合，其中隐藏字段包含值。

如果您所做的只是在服务器端提取复选框的值，我想一个简单的复选框控件扩展就足够了 - 添加一个可以从服务器端设置和检索的额外属性.. 。 在公园里散步。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T02:20:27.567

不，他们不一样

我正在开发的功能需要将产品升级列表显示为复选框列表。根据“选中”的复选框，我需要将它们添加到产品中。CheckBoxList 中的项目是动态的，因此当我遍历选中的项目时，我需要某种唯一标识符。“Checked”值只是一个布尔值

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T02:24:25.110

MS 在这里所做的是为他们创建了带有 .net 感觉的 ASP 控件。但是，由于它们应该与浏览器一起使用，因此它们*呈现*为标准 HTML 控件。

所以在cs/vb 的代码隐藏中，你会看到.Checked (bool)，而在客户端/javascript 中你会看到.value。

如果您想要的是唯一标识符，那么您需要查看 ID 或 ClientID。或者，您可以将属性添加到复选框 (.Attributes.Add()) 并使用它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-09T06:20:44.600

似乎这些值没有在 html 中呈现，但仍存储在视图状态中。因此，当我访问 CheckboxList.Items() 中的 ListItem 对象时，我能够在服务器端提取值

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-25T18:19:06.193

您可以通过覆盖 CheckBox 创建自己的自定义控件。这是我刚刚创建的一个示例，用于添加可用的服务器和客户端的 Value 属性：

```
public class ValueCheckBox : CheckBox
{
    public string Value
    {
        get;
        set;
    }

    protected override void Render(System.Web.UI.HtmlTextWriter writer)
    {
        writer.AddAttribute("value", this.Value);
        base.Render(writer);
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-10-10T07:27:43.437

这是一个老问题，但情况已经改变。首先，在 asp.net 4.6 中，将在复选框上设置 value 属性。这些答案很少与 CheckBoxList 相关，CheckBoxList 使用 ListItem 类来生成复选框。

我对 pre-4.6 的解决方案是添加一个数据属性。这将围绕复选框和标签创建一个`<span>`控件，您可以使用 javascript 找到该控件。

```
 foreach( ListItem item in selCheckList.Items)
        {
            item.Attributes["data-role-id"] = item.Value;
        } 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-01-07T02:14:33.257

“Checked”和“Value”不一样吗？

[http://www.w3schools.com/aspnet/control_checkbox.asp](http://www.w3schools.com/aspnet/control_checkbox.asp)

进去看看。您实际上并不需要专门命名为“Value”的属性，因为“Checked”将为您提供相同的信息。

# sql - 在 MS Access 中管理和调试 SQL 查询

> ID：418960
> 
> 赞同：17
> 
> 时间：2009-01-07T02:16:51.753
> 
> 标签：sql, debugging, ms-access

MS Access 管理原始 SQL 查询的能力有限：编辑器很糟糕，没有语法突出显示，它将原始 SQL 重新格式化为长字符串，并且您无法插入注释。

调试复杂的 SQL 查询也是一件痛苦的事情：要么您必须将其拆分为许多较小的查询，当您的架构更改时这些查询变得难以管理，或者您最终得到一个巨大的查询，这是调试和更新的噩梦。

您如何在 MS Access 中管理复杂的 SQL 查询以及如何调试它们？

**编辑**
目前，我主要使用[Notepad++](http://notepad-plus.sourceforge.net/uk/site.htm)进行一些语法着色，使用[SQL Pretty Printer](http://www.wangz.net/)重新格式化来自 Access 的原始 SQL。
使用外部存储库很有用，但始终存在使两个版本不同步的风险，并且您仍然必须在 Access 中尝试查询之前删除评论...

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-07T02:20:24.307

为了调试，我在一个单独的文本编辑器中编辑它们，让我可以合理地格式化它们。当我发现需要进行更改时，我会在文本编辑器中编辑版本，然后将其粘贴回 Access，而不是在 Access 中编辑版本。

仍然是一个主要的 PITA。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-07-08T17:51:28.440

我有一些特定于 VBA 中 SQL 的技巧。

将您的 SQL 代码与字符串变量放在一起。我曾经这样做：

```
Set RS = DB.OpenRecordset("SELECT ...") 
```

这很难管理。改为这样做：

```
strSQL = "SELECT ..."
Set RS = DB.OpenRecordset(strSQL) 
```

通常，除非您看到正在运行的内容，否则您无法修复查询。为此，请在执行前将您的 SQL 转储到即时窗口：

```
strSQL = "SELECT ..."
Debug.Print strSQL
Stop
Set RS = DB.OpenRecordset(strSQL) 
```

将结果粘贴到 Access 的标准查询生成器中（您必须使用*SQL 视图*）。现在您可以测试最终版本，包括代码处理的变量。

当您将长查询准备为字符串时，请分解您的代码：

```
strSQL = "SELECT wazzle FROM bamsploot" _
      & vbCrLf & "WHERE plumsnooker = 0" 
```

`vbCrLf`当我想美化给用户的长消息时，我第一次学会使用。后来我发现它使 SQL 在编码时更具可读性，并且改进了`Debug.Print`. （其他微小的好处：每行末尾不需要空格。新的行语法构建了这一点。）

（注意：您可能认为这会让您在 SQL 行的右侧添加注释。做好失望的准备。）

正如这里其他地方所说，前往文本编辑器可以节省时间。一些文本编辑器提供比官方 VBA 编辑器更好的语法突出显示。（哎呀，StackOverflow 做得更好。）它对于删除 WHERE 子句中多余的表引用和成堆的括号之类的 Access cruft 也很有效。

**严重故障排除的工作流程：**

```
VBA Debug.Print >       (capture query during code operation)
  query builder   >     (testing lab to find issues)
     Notepad++      >   (text editor for clean-up and review)
  query builder   >     (checking, troubleshooting) 
VBA 
```

当然，故障排除通常是降低查询的复杂性，直到您能够隔离问题（或至少使其消失！）。然后，您可以将其重新构建为您想要的杰作。因为解决一个棘手的问题可能需要几个周期，所以您可能会重复使用此工作流程。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-07-23T16:58:36.627

我编写了[Access SQL 编辑器](https://www.fieldeffect.info/purchase/)——Microsoft Access 的一个插件——因为我在 Access 中编写了相当多的传递查询和更复杂的 SQL。此加载项的优点是能够在您的 Access 应用程序本身中存储格式化的 SQL（带有注释！）。将查询复制到新的 Access 应用程序时，会保留格式。当内置编辑器破坏您的格式时，该工具将显示您的原始查询并通知您差异。

它目前不调试；如果有足够的兴趣，我会追求这个——但目前有意将功能集保持在较小的范围内。

暂时不是免费的，但是[购买](https://www.fieldeffect.info/purchase/)license很便宜。如果买不起，可以[联系我](http://fieldeffect.info/wp/access-sql-editor-documentation/)。[这里](https://www.fieldeffect.info/trial/)有 14 天的免费试用期。

安装后，您可以通过加载项菜单访问它（在 Access 2010 中，它是数据库工具->加载项）。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-07T06:26:37.867

调试更具挑战性。如果单列关闭，通常很容易修复。但我假设您需要执行更复杂的调试任务。

`FROM`当我感到困惑时，我通常会从该子句开始调试。我回溯到构成更大查询的所有表和子查询，并确保正确定义了连接。

然后我检查我的`WHERE`条款。我对表以及我已经检查过或我已经信任的子查询运行了许多简单的查询，并确保当我运行更大的查询时，我得到了我所期望的`WHERE`条件地方。我同时仔细检查了`JOIN`条件。

我仔细检查了我的列定义，以确保我正在检索我真正想看到的内容，尤其是在所涉及的公式很复杂的情况下。如果您在列定义中有一些复杂的东西，例如协调子查询

然后我检查我是否正确分组数据，确保“ `DISTINCT`”和“ `UNION`”`UNION ALL`没有删除必要的重复项。

我认为我从未遇到过无法以这种方式分解的 SQL 查询。我并不总是像这样有条不紊，但这是开始打破一个真正的树桩的好方法。

* * *

当您编写查询时，我可以推荐的一件事是：**永远不要`SELECT *`在生产代码中使用。**以这种方式选择所有列是一场维护噩梦，当您的基础架构发生变化时会导致大问题。如果您正在编写将来要维护的 SQL 代码，则应该始终写出每一列。仅仅通过摆脱`SELECT *`项目中的“”，我为自己节省了很多时间和担忧。

这样做的缺点是那些额外的列不会自动出现在引用“ `SELECT *`”查询的查询中。但是无论如何，您应该知道您的查询是如何相互关联的，如果您需要额外的列，您可以返回并添加它们。

* * *

维护代码存储库有一些麻烦，但是如果您有版本控制软件，那么麻烦就值得了。我听说过在 Access 数据库中编写的 SQL 代码版本控制方法，但不幸的是，我从未使用过它们。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-07T02:22:53.490

如果您在 MS Access 中执行非常复杂的查询，我会考虑将这些查询的存储库保存在 Access 数据库本身之外的某个地方......例如，在一个 .sql 文件中，然后您可以在像 Intype 这样的编辑器中进行编辑将提供语法高亮。它需要您在这两个地方更新查询，但您最终可能会发现它很方便，可以为它提供一个格式化和正确突出显示的“官方”位置。

或者，如果可能，切换到 SQL Server 2005 Express Edition，它也是免费的，将通过 SQL Management Studio（也是免费的）为您提供所需的功能。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-02-16T23:13:41.857

扩展 Smandoli 的这个建议：

```
NO:   DoCmd.RunSQL ("SELECT ...")
YES:  strSQL = "SELECT ..."
      DoCmd.RunSQL (strSQL) 
```

如果您想将 SQL 代码保存在外部文件中，以便使用您最喜欢的文本编辑器（使用语法着色等）进行编辑，您可以执行类似以下伪代码的操作：

```
// On initialization:
global strSQL
f = open("strSQL.sql")
strSQL = read_all(f)
close(f)

// To to the select:
DoCmd.RunSQL(strSQL) 
```

这可能有点笨拙——也许很笨拙——但它避免了编辑-复制-粘贴的一致性问题。

显然这并不能直接解决调试 SQL，但以可读的方式管理代码是问题的一部分。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-07T10:38:55.143

您是在谈论 MS-Access 调用的“查询”和 SQL 调用的“视图”还是 SQL 查询的“MS-Access 传递”查询？有人很容易迷路！我的解决方案如下

1.  免费的 SQL Server Management Studio Express，我将在其中详细说明和测试我的查询
2.  客户端的查询表，其中一个字段用于查询名称 ( `id_Query`)，另一个字段 ( `queryText`, 备忘录类型) 用于查询本身。

`getSQLQuery`然后，当我需要执行查询（返回或不返回记录集）时，我的 VBA 代码中有一个小函数可以使用：

```
Dim myQuery as string, _
    rsADO as ADODB.recorset

rsADO = new ADODB.recordset
myQuery = getSQLQuery(myId_Query)

'if my query retunrs a recordset'
set rsADO = myADOConnection.Execute myQuery
'or, if no recordset is to be returned'
myADOConnection.Execute myQuery 
```

对于视图，甚至可以将它们保存在服务器端并从客户端引用它们

```
set rsADO = myADOConnection.execute "dbo.myViewName" 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-07T05:21:14.347

与**递归类似，**我使用外部编辑器来编写查询。我使用带有 Light Explorer 扩展的 Notepad++ 来一次维护多个脚本，而 Notepad2 用于一次性脚本。（我有点偏爱基于 Scintilla 的编辑器。）

另一种选择是使用 SQL Server Express 附带的免费 SQL Server Management Studio Express。*（编辑：对不起，**EdgarVerona**，我没有注意到你已经提到过这个！）*我通常使用它来编写 SQL 查询而不是使用 Access，因为无论如何我通常使用 ODBC 链接到 SQL Server 后端。请注意，SQL Server 使用的 T-SQL 和 Access MDB 使用的 Jet SQL 的语法差异有时很大。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-04-24T07:36:05.560

据我所知，有两种选择：

*   带有Poor man's t-sql formatter plugin的Notepad ++ ..我知道已经提到SQL Pretty Printer但我没有使用它..所以我的工作流程是..我在Access中创建查询..我将它复制粘贴到Notepad++ ...我对其进行格式化..我正在处理它...返回Access..仅问题..在这种情况下，它在某些情况下填充空格：[Forms]！[AForm].[Ctrl]，它们变成[形式] ！[AForm].[Ctrl] 但我习惯了它并没有打扰我..
*   SoftTree SQL 助手 ( [http://www.softtreetech.com/sqlassist/index.htm](http://www.softtreetech.com/sqlassist/index.htm) ) 在 SQL 编辑器上带来了你想要的一切......我过去曾做过一些工作（试用版），但它的价格标签是有点僵硬

# css - 应用于打印样式表的最佳字体是什么？

> ID：418963
> 
> 赞同：3
> 
> 时间：2009-01-07T02:17:41.627
> 
> 标签：css, fonts

在为网页开发打印样式表时，推荐使用哪些字体？

我使用的是 Times New Roman，但它看起来有点乏味。

你以前用过什么？IIRC 他们说衬线字体在纸上更容易阅读。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T02:20:44.057

这取决于文本的目的、长度和位置。

Serif 字体肯定更容易在大块中阅读，但是 san-serif 字体更容易作为标题阅读。

我是普通、标准字体的粉丝——没什么花哨的。所以，对我来说，我喜欢 Times New Roman 的大面积文本和 Arial 的标题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T02:20:59.920

[我本人是Gentium](http://scripts.sil.org/cms/scripts/page.php?site_id=nrsi&id=gentium)打印的忠实粉丝。

我也用它来打印以外的东西，它太性感了。

[龙胆样品 http://www.imagepaste.com/img/f9234d922fead5b3590b465ee0249ff6.png](http://www.imagepaste.com/img/f9234d922fead5b3590b465ee0249ff6.png)

唯一**真正**明显的问题是，使用打印样式表，您还不能对用户安装的字体做出任何假设。

Times New Roman 正变得越来越普遍，但它在许多非 Windows 平台上默认不可用。

在用户指定和即时下载字体支持方面取得了进展，但还不是很可靠。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T02:25:01.240

在选择用于任何目的的字体时，自由是我的主要考虑因素。我已将[Deja Vu](http://dejavu-fonts.org/wiki/index.php?title=Main_Page)系列字体用于我的一般用途，尤其是 Deja Vu Sans。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-08-25T04:50:14.863

```
@media print {
    body {
        font: Georgia, "Times New Roman", Times, serif;
        background: #fff;
        font-size: 11pt;
    }
} 
```

使用 Serif 字体总是很好。

# c# - Winforms 组合框和数据绑定

> ID：418972
> 
> 赞同：1
> 
> 时间：2009-01-07T02:21:52.167
> 
> 标签：c#, winforms, data-binding

我正在将一个组合框数据绑定到一个数据集，但是我想在顶部插入一个“无”的项目。

正在做：

```
 combobox.Items.Insert(0,"None"); 
```

不起作用，因为组合框现在需要一个 DataRowView，但是 DataRowView 没有公共构造函数，所以我不能那样伪造它。

有什么建议吗？我确信这是一个很好解决的问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-07T02:38:12.883

插入到要绑定数据的对象而不是组合框。下面的好例子。

[http://social.msdn.microsoft.com/forums/en-US/winforms/thread/70785e67-5c27-428f-ac79-e45c8c70c3e8/](http://social.msdn.microsoft.com/forums/en-US/winforms/thread/70785e67-5c27-428f-ac79-e45c8c70c3e8/)

# javascript - 我应该拥有哪些工具作为开发 javascript 的核心集？

> ID：418973
> 
> 赞同：3
> 
> 时间：2009-01-07T02:22:11.197
> 
> 标签：javascript

我已经开发**ASP.Net**应用程序好几年了，我一直避免学习**JavaScript**。现在我一直在潜入并尝试尽可能多地学习。

作为**.Net**开发人员，我非常依赖**Visual Studio**。我想知道的是，作为一名**JavaScript**开发人员，你们在开发**JavaScript**时非常依赖哪些工具？我刚刚发现了很棒的**FireBug 。**我还缺少哪些其他**必须具备**的工具？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-07T02:43:00.547

是的，Firebug 很棒。确保您了解其中的[分析](http://getfirebug.com/js.html)功能。此外，还有一个名为[FireUnit](http://fireunit.org/)的新测试框架也可以与 Firebug 一起使用。

我喜欢[Textmate](http://macromates.com/)在我的 Mac 上进行 Javascript 编辑。 [Aptana Studio](http://www.aptana.com/)（独立或作为[Eclipse](http://www.eclipse.org)插件）也非常好。

我一直想尝试使用[YUI 测试库](http://developer.yahoo.com/yui/yuitest/)在 Javascript 中进行测试驱动开发。它承诺就像用于 Javascript 的 NUnit/JUnit，这会很棒。

查看[JS lint](http://www.jslint.com/)。

如果您对面向方面的编程感兴趣，请查看[Dojo](http://lazutkin.com/blog/2008/may/18/aop-aspect-javascript-dojo/)中的 AOP in Javascript 。

最后，有关 Javascript 引擎的当前状态（像[TraceMonkey之类的酷东西）和未来方向的一些有用信息，请查看](https://wiki.mozilla.org/JavaScript:TraceMonkey)[HanselMinutes](http://www.hanselminutes.com/default.aspx?showID=148)的这一集。

享受！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T02:35:27.147

Firebug 几乎是最好的。您也需要一些针对 IE 的解决方案。

请参阅此链接：[在 IE7 中调试 JavaScript](https://stackoverflow.com/questions/361635/debugging-javascript-in-ie7)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-07T02:48:21.753

1.  Visual Studio 2008 - 具有 JavaScript 智能感知和集成的 Js 调试功能
2.  FireBug - 任何 Web 开发人员的必备工具
3.  [FireBug Lite](http://getfirebug.com/lite.html) - “解决方案是 Firebug Lite，您可以将一个 JavaScript 文件插入到您的页面中，以模拟未命名为“Firefox”的浏览器中的一些 Firebug 功能。”
4.  [JsLint](http://www.jslint.com) - 必须确保你写的东西质量不错，JsLint 会帮助你做到这一点

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-07T02:53:11.587

其他有用的工具：

*   [packer](http://dean.edwards.name/packer/)非常好的 JavaScript 压缩器。
*   [Firefox 的 Web 开发者扩展](http://addons.mozilla.org/firefox/addon/60)
*   JsUnit 单元测试框架。
*   [SeleniumIDE](http://seleniumhq.org/projects/ide/) 功能、用户界面和验收测试。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-07T02:35:45.930

最近，Visual Studio 本身在其 JavaScript 支持方面有了很大改进。[例如，IntelliSense 现在可用于 VS2008 中的 JavaScript，包括jQuery](http://weblogs.asp.net/scottgu/archive/2008/11/21/jquery-intellisense-in-vs-2008.aspx)等第三方库。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-07T02:37:00.823

为什么不继续使用 Visual Studio 方便并下载支持智能感知的 jQuery。

斯科特·格思里（Scott Guthrie）有一篇关于如何做到这一点的帖子

[http://weblogs.asp.net/scottgu/archive/2008/11/21/jquery-intellisense-in-vs-2008.aspx](http://weblogs.asp.net/scottgu/archive/2008/11/21/jquery-intellisense-in-vs-2008.aspx)

[http://weblogs.asp.net/scottgu/archive/2008/09/28/jquery-and-microsoft.aspx](http://weblogs.asp.net/scottgu/archive/2008/09/28/jquery-and-microsoft.aspx)

# php - 为什么 CakePHP 不支持具有多列的外键？

> ID：418980
> 
> 赞同：1
> 
> 时间：2009-01-07T02:24:44.767
> 
> 标签：php, mysql, database-design, cakephp

我在谷歌搜索这个没有一个好的结果。我在 CakePHP trac 中找到的唯一[主题是在没有“真实”解释的情况下关闭的。](https://trac.cakephp.org/ticket/1923)由于 CakePHP 就像是 php 的 rails 端口之一，而 rails 确实支持这一点，我想知道它为什么不支持这个特性。

* * *

好的。但我想决定我的数据库模式将如何，在 RoR 中你有工具，如果你想使用它，你会冒着风险去做。顺便说一句：我不知道交响乐是否也允许这样做。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-07T06:03:41.627

只有 CakePHP 团队肯定知道。团队之一，Nate Abdele，早在 2007 年 2 月就[谈到](http://groups.google.com/group/cake-php/msg/255c641339eef6ac)了多列主键：

> 我可以想出一百万个为什么多列主键是一个愚蠢的想法的其他原因，但我认为 2007 年最重要的一个原因是它打破了网络上的 REST 架构，因为没有单一的参考点数据，并且这些数据现在可能会在您不知情的情况下发生变化，因此无法再从单个 URI 一致地引用对象。

我认为这也是他反对多列外键的论点。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-08T13:28:12.867

学蛋糕的人说得最好：

> 我了解到，如果 cakephp 中的某些东西非常困难，那么您可能遇到了设计问题。
> ——阿西莫

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T20:39:13.993

您可以通过将第二列的条件添加到关联中来获得相同的结果吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-07-23T12:55:30.863

不，支持多列主键的真正原因是为了将 CakePHP 改装到现有的应用程序中。当然，不要提倡这种做法，因为它的设计很糟糕，但是如果您可以选择使用多个主键而不是重新设计现有管理系统的大部分内容，那么简单的选择将是一个非常好的功能。

# c# - 聚合惰性列表的设计模式

> ID：418983
> 
> 赞同：1
> 
> 时间：2009-01-07T02:26:35.527
> 
> 标签：c#, .net, ienumerable, lazy-loading, generator

我正在编写如下程序：

*   在给定目录中查找所有具有正确扩展名的文件
*   Foreach，在这些文件中查找给定字符串的所有出现
*   打印每一行

我想以一种功能性的方式编写它，作为一系列生成器函数（调用`yield return`并且一次只返回一个项目的东西延迟加载），所以我的代码将如下所示：

```
IEnumerable<string> allFiles = GetAllFiles();
IEnumerable<string> matchingFiles = GetMatches( "*.txt", allFiles );
IEnumerable<string> contents = GetFileContents( matchingFiles );
IEnumerable<string> matchingLines = GetMatchingLines( contents );

foreach( var lineText in matchingLines )
  Console.WriteLine( "Found: " + lineText ); 
```

这一切都很好，但我还想做的是在最后打印一些统计数据。像这样的东西：

```
Found 233 matches in 150 matching files. Scanned 3,297 total files in 5.72s 
```

问题是，像上面那样以“纯功能”风格编写代码，每个项目都是延迟加载的。
在最终的 foreach 循环完成之前，您只知道总共有多少文件匹配，并且因为一次只`yield`编辑一个项目，所以代码没有任何地方可以跟踪它之前找到了多少东西。如果您调用 LINQ 的`matchingLines.Count()`方法，它将重新枚举集合！

我可以想出很多方法来解决这个问题，但它们似乎都有些难看。它让我印象深刻，因为人们以前一定会做过，而且我相信会有一个很好的设计模式来展示做这件事的最佳实践方式。

有任何想法吗？干杯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T02:43:18.457

我会说您需要将该过程封装到一个“Matcher”类中，您的方法在其中捕获统计信息，因为它们正在进行。

```
public class Matcher
{
  private int totalFileCount;
  private int matchedCount;
  private DateTime start;
  private int lineCount;
  private DateTime stop;

  public IEnumerable<string> Match()
  {
     return GetMatchedFiles();
     System.Console.WriteLine(string.Format(
       "Found {0} matches in {1} matching files." + 
       " {2} total files scanned in {3}.", 
       lineCount, matchedCount, 
       totalFileCount, (stop-start).ToString());
  }

  private IEnumerable<File> GetMatchedFiles(string pattern)
  {
     foreach(File file in SomeFileRetrievalMethod())
     {
        totalFileCount++;
        if (MatchPattern(pattern,file.FileName))
        {
          matchedCount++;
          yield return file;
        }
     }
  }
} 
```

我会停在那里，因为我应该编码工作的东西，但总体思路就在那里。“纯”函数式程序的全部意义在于没有副作用，而这种静态计算是一种副作用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T02:49:48.833

我能想到两个想法

1.  传入一个上下文对象并从您的枚举器返回（字符串+上下文） - 纯功能解决方案

2.  使用线程本地存储为您统计（[CallContext](http://msdn.microsoft.com/en-us/library/system.runtime.remoting.messaging.callcontext.setdata.aspx)），您可以花哨并支持一堆上下文。所以你会有这样的代码。

    ```
    using (var stats = DirStats.Create())
    {
        IEnumerable<string> allFiles = GetAllFiles();
        IEnumerable<string> matchingFiles = GetMatches( "*.txt", allFiles );
        IEnumerable<string> contents = GetFileContents( matchingFiles );
        stats.Print()
        IEnumerable<string> matchingLines = GetMatchingLines( contents );
        stats.Print();
    } 
    ```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-07T07:44:17.070

与其他答案类似，但采取了更通用的方法......

...为什么不创建一个*装饰器*类，它可以包装现有的 IEnumerable 实现并在传递其他项目时计算统计信息。

这是`Counter`我刚刚汇总的一个类 - 但您也可以为其他类型的聚合创建变体。

```
public class Counter<T> : IEnumerable<T>
{
    public int Count { get; private set; }

    public Counter(IEnumerable<T> source)
    {
        mSource = source;
        Count = 0;
    }

    public IEnumerator<T> GetEnumerator()
    {
        foreach (var T in mSource)
        {
            Count++;
            yield return T;
        }
    }

    IEnumerator IEnumerable.GetEnumerator()
    {
        foreach (var T in mSource)
        {
            Count++;
            yield return T;
        }
    }

    private IEnumerable<T> mSource;
} 
```

您可以创建三个实例`Counter`：

1.  一个用来`GetAllFiles()`计算文件总数；
2.  一个用于`GetMatches()`计算匹配文件的数量；和
3.  一个用于`GetMatchingLines()`计算匹配行数。

这种方法的关键是您没有将多个职责分层到现有的类/方法上——该`GetMatchingLines()`方法只处理匹配，您也没有要求它跟踪统计信息。

**澄清**回应评论`Mitcham`：

最终代码如下所示：

```
var files = new Counter<string>( GetAllFiles());
var matchingFiles = new Counter<string>(GetMatches( "*.txt", files ));
var contents = GetFileContents( matchingFiles );
var linesFound = new Counter<string>(GetMatchingLines( contents ));

foreach( var lineText in linesFound )
    Console.WriteLine( "Found: " + lineText );

string message 
    = String.Format( 
        "Found {0} matches in {1} matching files. Scanned {2} files",
        linesFound.Count,
        matchingFiles.Count,
        files.Count);
Console.WriteLine(message); 
```

请注意，这仍然是一种函数式方法——使用的变量是**不可变**的（更像是*绑定*而不是变量），并且整个函数没有副作用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-07T07:23:24.833

如果您乐于颠倒您的代码，您可能会对 Push LINQ 感兴趣。基本思想是反转“拉”模型`IEnumerable<T>`并将其转变为带有观察者的“推”模型——管道的每个部分有效地将其数据推送到任意数量的观察者（使用事件处理程序），这些观察者通常形成新的部分管道。这提供了一种非常简单的方法来将多个聚合连接到相同的数据。

有关更多详细信息，请参阅[此博客条目。](http://msmvps.com/blogs/jon_skeet/archive/2008/01/04/quot-push-quot-linq-revisited-next-attempt-at-an-explanation.aspx)不久前我在伦敦做了一次演讲——我[的演讲页面](http://csharpindepth.com/Talks.aspx)有一些示例代码、幻灯片、视频等的链接。

这是一个有趣的小项目，但确实需要一些时间。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-08T02:07:51.710

我采用了 Bevan 的代码并对其进行了重构，直到我满意为止。好玩的东西。

```
public class Counter
{
    public int Count { get; set; }
}

public static class CounterExtensions
{
    public static IEnumerable<T> ObserveCount<T>
      (this IEnumerable<T> source, Counter count)
    {
        foreach (T t in source)
        {
            count.Count++;
            yield return t;
        }
    }

    public static IEnumerable<T> ObserveCount<T>
      (this IEnumerable<T> source, IList<Counter> counters)
    {
        Counter c = new Counter();
        counters.Add(c);
        return source.ObserveCount(c);
    }
}

public static class CounterTest
{
    public static void Test1()
    {
        IList<Counter> counters = new List<Counter>();
  //
        IEnumerable<int> step1 =
            Enumerable.Range(0, 100).ObserveCount(counters);
  //
        IEnumerable<int> step2 =
            step1.Where(i => i % 10 == 0).ObserveCount(counters);
  //
        IEnumerable<int> step3 =
            step2.Take(3).ObserveCount(counters);
  //
        step3.ToList();
        foreach (Counter c in counters)
        {
            Console.WriteLine(c.Count);
        }
    }
} 
```

按预期输出：21、3、3

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-07T02:41:00.443

假设这些函数是你自己的，我唯一能想到的就是访问者模式，它传入一个抽象的访问者函数，当每件事发生时都会回调你。例如：将 ILineVisitor 传递给 GetFileContents （我假设将文件分成几行）。ILineVisitor 将有一个类似 OnVisitLine(String line) 的方法，然后您可以实现 ILineVisitor 并使其保持适当的统计信息。冲洗并使用 ILineMatchVisitor、IFileVisitor 等重复。或者您可以使用单个 IVisitor 和 OnVisit() 方法，在每种情况下都有不同的语义。

每个函数都需要一个访问者，并在适当的时候调用它的 OnVisit()，这可能看起来很烦人，但至少访问者可以用来做很多有趣的事情，而不仅仅是你在这里做的事情. 事实上，您实际上可以通过将检查 OnVisitLine(String line) 中匹配的访问者传递给 GetFileContents 来避免编写 GetMatchingLines。

这是你已经考虑过的丑陋的事情之一吗？

# svn - 如何将 SVN 存储库热复制到现有位置？

> ID：418984
> 
> 赞同：4
> 
> 时间：2009-01-07T02:26:39.287
> 
> 标签：svn, backup, batch-file, repository

我正在尝试自动备份我的 SVN 存储库。这是我写的一个批处理文件：

```
svnadmin hotcopy C:/myRepository G:/myRepositoryBackup --clean-logs 
```

第一次效果很好。但是，每次之后，我都会收到此错误：

```
svnadmin: 'G:/myRepositoryBackup' exists and is non-empty 
```

如何让它覆盖我的旧数据，或增量复制？

我知道我可以使用`svnadmin dump`，但我想要更小的`hotcopy`输出。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-07T02:39:18.637

您可以使用`svnadmin dump repo --incremental`.

您可以在此处找到更多存储库备份信息：

[SVNBook](http://svnbook.red-bean.com/en/1.1/) -> [Chapter 5\. Repository Administration](http://svnbook.red-bean.com/en/1.1/ch05.html) -> [Repository Backup](http://svnbook.red-bean.com/en/1.1/ch05s03.html#svn-ch-5-sect-3.6)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T03:08:17.313

我对 SVN 备份所做的是使用`svnadmin dump`然后使用 7-Zip 压缩输出。对于我的存储库，这最终小于`hotcopy`. 然后我每天都有一个文件包含整个存储库备份。此外，`dump`面对未来存储库格式的变化，输出更加健壮（`hotcopy`输出只能恢复到完全相同的 SVN 版本）。

# css - XHTML/CSS：为什么 Firefox 会弄乱我的水平标签菜单？

> ID：418998
> 
> 赞同：2
> 
> 时间：2009-01-07T02:36:13.150
> 
> 标签：css, menu, tabs

[问题页面](http://www.antisit.com)

[样式表](http://www.antisit.com/styles.css)

知道如何在 Firefox 中进行这项工作吗？（看起来好像右标签图像被推到链接下方，好像在锚元素中没有足够的空间放置它。

另外，我使用两个标签的原因是我更喜欢使用更少的图像数据而不是更整洁的代码。如果您对更好的方法有任何建议，请告诉我。

谢谢，约翰

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T02:56:13.500

你可以试试这个标记：

```
<a href="http://www.antisit.com/articles">
  <span class="left"></span>
  <span class="right"></span>
  Articles
</a> 
```

尽管我没有在其他任何地方尝试过，但似乎在带有 firebug 的 Firefox 中工作正常。不幸的是，顺序应该无关紧要，但有时确实如此。:(************