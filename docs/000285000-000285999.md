# StackOverflow 问答 000285000-000285999

# perl - 0-65535 整数最快的排序算法是什么？

> ID：285005
> 
> 赞同：8
> 
> 时间：2008-11-12T19:15:30.280
> 
> 标签：perl, algorithm, sorting, performance

我必须对一些整数进行排序，它们的值可以在 30.000.000 到 350.000.000 之间。将有 0 到 65.535 个整数，平均数为 20.000。RAM 的使用无关紧要，只有速度很重要。

稍后我还必须将它们分成组，只要这些值中的两个值之间的差距大于 65.535，就会始终设置分隔符，这就是我需要算法的目的。

如果有任何不同，该算法将在 Perl 脚本中使用。

编辑：仔细考虑并阅读答案后，我开始意识到：我实际上并不关心数据本身。由于我真的只想找到具有小间隙的组的开始和结束值，因此排序只需要创建桶并可以丢弃数据。

Edit2：经过一些测试并尝试了提供的答案，我发现最快的方法是：

```
my @sort = sort {$a <=> $b} @item_offsets;
my @buckets;
my $start = shift @sort;
push @buckets, [$start,$start];
for my $item ( @sort ) {
    if ( $item < $buckets[$#buckets][1]+$gap ) {
        $buckets[$#buckets][1] = $item;
    }
    else {
        push @buckets, [$item,$item];
    }
}
say $#buckets; 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-11-12T19:27:02.173

您不太可能在 Perl 中编写比 Perl 的内置`sort`函数执行得更好的排序算法：

```
@numbers = sort {$a <=> $b} @numbers; 
```

您可以尝试使用 sort pragma 来查看特定算法是否更好：

```
use sort '_quicksort';
use sort '_mergesort'; 
```

由于您的切点会因数据分布而异，因此我认为您需要先对整个列表进行排序，然后循环遍历它以进行切割。

```
my $prev  = shift @numbers;  # already sorted
my @group = [$prev];
my $i     = 0;

foreach my $n (@numbers) {
    $i++ if ($n - $prev > 65535);
    push @{$group[$i]}, $n;
    $prev = $n;
} 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-11-12T19:50:46.683

在运行算法之前，我只需创建一个桶数组，每组 65536 个连续值一个。存储桶将包含其内容的最小值和最大值，但不会存储内容本身。运行算法后，对桶进行一次遍历。如果有两个连续的非空桶 min(bucket2)-max(bucket1) < 65536，则合并它们。在算法完成运行之前不会发生组合。丢弃任何空桶。该算法是线性时间的。

注意[桶排序](http://en.wikipedia.org/wiki/Bucket_sort)。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-11-12T19:18:22.877

我会使用基数排序，因为您需要对输出进行分组。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-12T19:22:40.187

我只是想说基数排序，[http](http://en.wikipedia.org/wiki/Radix_sort) ://en.wikipedia.org/wiki/Radix_sort但是这可能比你想要实现的有点高，Introsort 通常是公认的数据排序解决方案[http://en .wikipedia.org/wiki/Introsort](http://en.wikipedia.org/wiki/Introsort)，它是快速排序的一种变体，当它到达较小的集合时切换到堆排序，因为它在较小的集合上比快速排序更快。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-12T19:50:24.000

我会试试这个：

```
my @sorted = map { unpack "N" } sort map { pack "N" } @unsorted; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-12T19:23:09.000

如果您使用该数字作为数组的索引，然后增加该位置的计数，则您已将它们“分组”，并一次性完成。

在伪代码中：

```
while(morenumbers)
  sorted[[unsorted[number]]++
  number++ 
```

如果提前知道范围，您可以减少索引值（例如，将 value-30000 带入正确的范围）。

# c# - 如何从 C# 中的 DataRow 读取字节数组？

> ID：285010
> 
> 赞同：11
> 
> 时间：2008-11-12T19:17:29.683
> 
> 标签：c#, debugging, bytearray, tableadapter, datarow

我有一个`DataSet`通过 a`DataTable`正确填充单个`DataRow`的 a `TableAdapter`。

我可以使用如下代码从 DataRow 中提取数据：

```
dataFileID = (int)this.dataFileDataRow["DataFileID"];
dataFileName = (string)this.dataFileDataRow["DataFileName"];
dataFileDate = (DateTime)this.dataFileDataRow["DataFileDate"]; 
```

我有另一列名为 DataFile 类型的列`varbinary(max)`。

当我尝试从与上面相同的列中提取该列的数据时`DataRow`，我什么也得不到。

```
byte[] fileFromDatabase = (byte[])this.dataFileDataRow["DataFile"]; 
```

如果我在这个位置放置一个断点，我可以查看 dataFileDataRow，查看 ItemArray 属性并看到二进制数据位于 ItemArray 中的位置 5。

我尝试使用它的索引直接访问 ItemArray，但字节数组没有被复制到 fileFromDatabase 变量。

我还注意到将 fileFromDatabase 添加到我的手表会产生此错误：

> “当前上下文中不存在名称‘fileFromDatabase’”

执行仍然与 fileFromDatabase 的定义在同一个块中，所以我不明白它是如何脱离上下文的。

我将 Visual Studio 的配置设置为 Release 而不是 Debug。这导致我在尝试检查 fileFromDatabase 时看不到我正在寻找的实时调试信息。从 Release 切换到 Debug 后，我现在可以在手表中看到变量，并且可以验证上面的代码是否正常工作。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-12T19:49:41.770

上面的代码有效，请确保您将调试器设置为编译为调试，而不是发布。

基思

# linux - 如何防止在 Linux 中关闭 SSH 客户端后停止后台进程

> ID：285015
> 
> 赞同：298
> 
> 时间：2008-11-12T19:19:54.293
> 
> 标签：linux, process, ssh, background-process

我正在通过 SSH (Putty) 在 Linux 机器上工作。我需要让一个进程在夜间运行，所以我想我可以通过在后台启动进程（在命令末尾带有一个＆符号）并将标准输出重定向到一个文件来做到这一点。

令我惊讶的是，这行不通。一旦我关闭 Putty 窗口，该过程就会停止。

我怎样才能防止这种情况发生？

* * *

## 回答 #1

> 赞同：309
> 
> 时间：2008-11-12T19:21:30.157

查看“ [nohup](http://en.wikipedia.org/wiki/Nohup) ”程序。

* * *

## 回答 #2

> 赞同：169
> 
> 时间：2008-11-12T19:22:00.313

我会推荐使用[GNU Screen](http://www.gnu.org/software/screen/)。它允许您在所有进程继续运行时断开与服务器的连接。在我知道它存在之前，我不知道没有它我是如何生活的。

* * *

## 回答 #3

> 赞同：82
> 
> 时间：2008-11-12T19:27:26.307

当会话关闭时，进程接收到它显然没有捕获的 SIGHUP 信号。您可以在启动进程时使用该`nohup`命令或在启动进程后使用 bash 内置命令`disown -h`来防止这种情况发生：

```
> help disown
disown: disown [-h] [-ar] [jobspec ...]
     By default, removes each JOBSPEC argument from the table of active jobs.
    If the -h option is given, the job is not removed from the table, but is
    marked so that SIGHUP is not sent to the job if the shell receives a
    SIGHUP.  The -a option, when JOBSPEC is not supplied, means to remove all
    jobs from the job table; the -r option means to remove only running jobs. 
```

* * *

## 回答 #4

> 赞同：42
> 
> 时间：2012-03-10T12:01:44.263

守护？没有？屏幕？（tmux ftw，屏幕是垃圾;-)

只需做所有其他应用程序从一开始就做的事情——双叉。

```
# ((exec sleep 30)&)
# grep PPid /proc/`pgrep sleep`/status
PPid:   1
# jobs
# disown
bash: disown: current: no such job 
```

砰! 完成:-) 我在所有类型的应用程序和许多旧机器上都使用过无数次。您可以结合重定向和诸如此类的东西在您和流程之间打开一个私人通道。

创建为 coproc.sh：

```
#!/bin/bash

IFS=

run_in_coproc () {
    echo "coproc[$1] -> main"
    read -r; echo $REPLY
}

# dynamic-coprocess-generator. nice.
_coproc () {
    local i o e n=${1//[^A-Za-z0-9_]}; shift
    exec {i}<> <(:) {o}<> >(:) {e}<> >(:)
. /dev/stdin <<COPROC "${@}"
    (("\$@")&) <&$i >&$o 2>&$e
    $n=( $o $i $e )
COPROC
}

# pi-rads-of-awesome?
for x in {0..5}; do
    _coproc COPROC$x run_in_coproc $x
    declare -p COPROC$x
done

for x in COPROC{0..5}; do
. /dev/stdin <<RUN
    read -r -u \${$x[0]}; echo \$REPLY
    echo "$x <- main" >&\${$x[1]}
    read -r -u \${$x[0]}; echo \$REPLY
RUN
done 
```

进而

```
# ./coproc.sh 
declare -a COPROC0='([0]="21" [1]="16" [2]="23")'
declare -a COPROC1='([0]="24" [1]="19" [2]="26")'
declare -a COPROC2='([0]="27" [1]="22" [2]="29")'
declare -a COPROC3='([0]="30" [1]="25" [2]="32")'
declare -a COPROC4='([0]="33" [1]="28" [2]="35")'
declare -a COPROC5='([0]="36" [1]="31" [2]="38")'
coproc[0] -> main
COPROC0 <- main
coproc[1] -> main
COPROC1 <- main
coproc[2] -> main
COPROC2 <- main
coproc[3] -> main
COPROC3 <- main
coproc[4] -> main
COPROC4 <- main
coproc[5] -> main
COPROC5 <- main 
```

你去那里，产生任何东西。<(:) 通过进程替换打开一个匿名管道，该管道死了，但管道仍然存在，因为你有它的句柄。我通常会做 a`sleep 1`而不是`:`因为它有点活泼，而且我会得到一个“文件忙”错误——如果运行真正的命令（例如，`command true`）永远不会发生

“heredoc 采购”：

```
. /dev/stdin <<EOF
[...]
EOF 
```

这适用于我尝试过的每一个 shell，包括busybox/etc（initramfs）。我以前从未见过它，我在刺激时独立发现它，谁知道source可以接受args？但如果有这样的事情，它通常作为一种更易于管理的 eval 形式。

* * *

## 回答 #5

> 赞同：37
> 
> 时间：2008-11-12T19:31:35.660

```
nohup blah & 
```

将您的进程名称替换为 blah！

* * *

## 回答 #6

> 赞同：17
> 
> 时间：2008-11-12T19:53:57.970

就个人而言，我喜欢“批处理”命令。

```
$ batch
> mycommand -x arg1 -y arg2 -z arg3
> ^D 
```

这会将其填充到后台，然后将结果邮寄给您。它是 cron 的一部分。

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2008-11-12T19:50:05.233

正如其他人所指出的，要在后台运行进程以便您可以断开与 SSH 会话的连接，您需要让后台进程正确地与其控制终端断开关联——这是 SSH 会话使用的伪 tty。

您可以在 Stevens 的“Advanced Network Program, Vol 1, 3rd Edn”或 Rochkind 的“Advanced Unix Programming”等书籍中找到有关守护进程的信息。

我最近（在过去的几年里）不得不处理一个没有正确守护自己的顽固程序。我最终通过创建一个通用的守护程序来处理这个问题——类似于 nohup 但有更多的控件可用。

```
Usage: daemonize [-abchptxV][-d dir][-e err][-i in][-o out][-s sigs][-k fds][-m umask] -- command [args...]
  -V          print version and exit
  -a          output files in append mode (O_APPEND)
  -b          both output and error go to output file
  -c          create output files (O_CREAT)
  -d dir      change to given directory
  -e file     error file (standard error - /dev/null)
  -h          print help and exit
  -i file     input file (standard input - /dev/null)
  -k fd-list  keep file descriptors listed open
  -m umask    set umask (octal)
  -o file     output file (standard output - /dev/null)
  -s sig-list ignore signal numbers
  -t          truncate output files (O_TRUNC)
  -p          print daemon PID on original stdout
  -x          output files must be new (O_EXCL) 
```

在不使用 GNU getopt() 函数的系统上，双破折号是可选的；在 Linux 等上它是必要的（或者你必须在环境中指定 POSIXLY_CORRECT）。由于双破折号在任何地方都可以使用，因此最好使用它。

如果您想要`daemonize`.

但是，代码现在（最终）在我的[SOQ](https://github.com/jleffler/soq)（堆栈溢出问题）存储库中的 GitHub 上作为[packages](https://github.com/jleffler/soq/tree/master/packages) 子目录`daemonize-1.10.tgz`中 的文件可用。

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2016-07-03T00:59:11.907

对于大多数进程，您可以使用这个旧的 Linux 命令行技巧来伪守护进程：

```
# ((mycommand &)&) 
```

例如：

```
# ((sleep 30 &)&)
# exit 
```

然后启动一个新的终端窗口并：

```
# ps aux | grep sleep 
```

将显示`sleep 30`仍在运行。

您所做的是将进程作为子进程启动，当您退出时，`nohup`通常会触发进程退出的命令不会级联到孙子进程，使其成为孤立进程，仍在运行.

我更喜欢这种“设置并忘记它”的方法，不需要处理`nohup`, `screen`, tmux, I/o 重定向或任何类似的东西。

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2014-04-25T23:30:46.767

在基于 Debian 的系统上（在远程机器上）安装：

> sudo apt-get install tmux

用法：

> 多路复用器
> 
> 运行你想要的命令

重命名会话：

> **Ctrl+B**然后**$**
> 
> 设置名称

退出会话：

> **Ctrl+B**然后**D**

（这将离开 tmux 会话）。然后，您可以注销 SSH。

当您需要返回/再次检查时，启动 SSH，然后输入

> tmux 附加会话名称

它将带您回到您的 tmux 会话。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2008-11-12T19:35:15.747

如果父进程被杀死，Nohup 允许客户端进程不被杀死，作为您注销时的参数。更好的是仍然使用：

```
nohup /bin/sh -c "echo \$\$ > $pidfile; exec $FOO_BIN $FOO_CONFIG  " > /dev/null 
```

Nohup 使您启动的进程不受终止，您的 SSH 会话及其子进程在您注销时被终止。我给出的命令为您提供了一种将应用程序的 pid 存储在 pid 文件中的方法，以便您以后可以正确地杀死它并允许该进程在您注销后运行。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2008-11-12T19:53:08.580

如果您使用 screen 以 root 身份运行进程，请注意特权提升攻击的可能性。如果您自己的帐户以某种方式受到损害，将有一种直接的方式来接管整个服务器。

如果此过程需要定期运行并且您在服务器上有足够的访问权限，则更好的选择是使用 cron 运行作业。您还可以使用 init.d（超级守护程序）在后台启动您的进程，它可以在完成后立即终止。

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2014-03-05T05:28:07.583

`nohup`如果您想将您的详细信息记录到文件中，这是非常好的。但是当它进入后台时，如果您的脚本要求，您无法为其提供密码。我认为你必须尝试`screen`。它是一个实用程序，您可以使用 yum 安装在您的 linux 发行版上，例如在 CentOS 上，`yum install screen`然后通过 putty 或其他软件以您的 shell 类型访问您的服务器`screen`。它将在腻子中打开屏幕 [0]。做你的工作。您可以在同一个腻子会话中创建更多屏幕 [1]、屏幕 [2] 等。

你需要知道的基本命令：

开始画面

# 屏幕

* * *

创建下一个**屏幕**

# ctrl+a+c

* * *

移动到**您**创建的下一个屏幕

# ctrl+a+n

* * *

**分离**_ _

# ctrl+a+d

* * *

在工作期间关闭你的腻子。下次您通过腻子类型登录时

# 屏幕-r

重新连接到您的屏幕，您可以看到您的进程仍在屏幕上运行。并退出屏幕类型#exit。

有关更多详细信息，请参阅`man screen`。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2008-11-12T19:23:01.700

使用屏幕。它使用起来非常简单，就像终端的 vnc 一样工作。 [http://www.bangmoney.org/presentations/screen.html](http://www.bangmoney.org/presentations/screen.html)

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2011-11-15T00:17:53.500

如果您也愿意运行 X 应用程序 - 将[xpra](http://xpra.org/)与“screen”一起使用。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2012-05-30T09:23:05.840

我也会选择屏幕程序（我知道其他人的答案是屏幕，但这是一个完成）

不仅 &、ctrl+z bg disown、nohup 等可能会给你一个令人讨厌的惊喜，即当你注销工作时仍然会被杀死（我不知道为什么，但它确实发生在我身上，而且它没有打扰因为我切换到使用屏幕，但我猜 anthonyrisinger 解决方案，因为双分叉可以解决这个问题），屏幕也比仅仅背景有一个**主要**优势：

```
screen will background your process without losing interactive control to it 
```

顺便说一句，这是我一开始就不会问的问题 :) ...我从一开始就在任何 unix 中做任何事情时都使用屏幕 ...我（几乎）从来没有在没有启动屏幕的情况下在 unix/linux shell 中工作首先...我现在应该停下来，否则我将开始无休止地介绍什么是好屏幕以及可以为您做什么...自己查一下，这是值得的；）

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2012-06-16T16:13:26.003

还有开源 libslack 包的[daemon命令。](http://libslack.org/daemon/)

`daemon`是相当可配置的，并且确实关心所有繁琐的守护进程，例如自动重启、日志记录或 pidfile 处理。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2013-08-14T15:51:50.590

将此字符串附加到您的命令中：>&- 2>&- <&- &。>&- 表示关闭标准输出。2>&- 表示关闭标准错误。<&- 表示关闭标准输入。& 表示在后台运行。这也可以通过 ssh 以编程方式启动作业：

```
$ ssh myhost 'sleep 30 >&- 2>&- <&- &'
# ssh returns right away, and your sleep job is running remotely
$ 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2015-11-12T05:02:58.567

我使用了屏幕命令。此链接详细介绍了如何执行此操作

[https://www.rackaid.com/blog/linux-screen-tutorial-and-how-to/#starting](https://www.rackaid.com/blog/linux-screen-tutorial-and-how-to/#starting)

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2017-02-06T08:59:04.860

接受的答案建议使用*nohup*。我宁愿建议使用[pm2](https://www.npmjs.com/package/pm2)。使用*pm2*而不是*nohup*有很多优点，例如保持应用程序的活动、维护应用程序的日志文件以及更多其他功能。有关更多详细信息[，请查看](http://pm2.keymetrics.io/docs/usage/quick-start/)。

要安装*pm2*，您需要下载*npm*。对于基于 Debian 的系统

```
sudo apt-get install npm 
```

对于红帽

```
sudo yum install npm 
```

或者您可以按照[这些说明](http://blog.npmjs.org/post/85484771375/how-to-install-npm)进行操作。安装*npm*后使用它来安装*pm2*

```
npm install pm2@latest -g 
```

完成后，您可以通过以下方式启动您的应用程序

```
$ pm2 start app.js              # Start, Daemonize and auto-restart application (Node)
$ pm2 start app.py              # Start, Daemonize and auto-restart application (Python) 
```

对于进程监控，使用以下命令：

```
$ pm2 list                      # List all processes started with PM2
$ pm2 monit                     # Display memory and cpu usage of each app
$ pm2 show [app-name]           # Show all informations about application 
```

使用应用名称或进程 ID 管理进程或一起管理所有进程：

```
$ pm2 stop     <app_name|id|'all'|json_conf>
$ pm2 restart  <app_name|id|'all'|json_conf>
$ pm2 delete   <app_name|id|'all'|json_conf> 
```

日志文件可以在

```
$HOME/.pm2/logs #contain all applications logs 
```

* * *

二进制可执行文件也可以使用 pm2 运行。您必须对 jason 文件进行更改。将 , 更改`"exec_interpreter" : "node"`为`"exec_interpreter" : "none".`（请参阅[属性部分](http://pm2.keymetrics.io/docs/usage/pm2-doc-single-page/#list-of-attributes-available)）。

```
#include <stdio.h>
#include <unistd.h>  //No standard C library
int main(void)
{
    printf("Hello World\n");
    sleep (100);
    printf("Hello World\n");

    return 0;
} 
```

编译上面的代码

```
gcc -o hello hello.c 
```

并在后台使用 np2 运行它

```
pm2 start ./hello 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2017-12-26T17:10:28.490

在 systemd/Linux 上，[systemd-run](https://www.freedesktop.org/software/systemd/man/systemd-run.html)是启动独立于会话的进程的好工具。

# .net - 如何获取非当前线程的堆栈跟踪？

> ID：285031
> 
> 赞同：32
> 
> 时间：2008-11-12T19:24:46.953
> 
> 标签：.net, multithreading, debugging, stack-trace, visual-studio-debugging

可以使用 System.Diagnostics.StackTrace 获取堆栈跟踪，但必须暂停线程。Suspend 和 Resume 功能已过时，因此我希望存在更好的方法。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-03-07T04:09:06.173

**注意：跳到此答案的底部以获取更新。**

到目前为止，这对我有用：

```
StackTrace GetStackTrace (Thread targetThread)
{
    StackTrace stackTrace = null;
    var ready = new ManualResetEventSlim();

    new Thread (() =>
    {
        // Backstop to release thread in case of deadlock:
        ready.Set();
        Thread.Sleep (200);
        try { targetThread.Resume(); } catch { }
    }).Start();

    ready.Wait();
    targetThread.Suspend();
    try { stackTrace = new StackTrace (targetThread, true); }
    catch { /* Deadlock */ }
    finally
    {
        try { targetThread.Resume(); }
        catch { stackTrace = null;  /* Deadlock */  }
    }

    return stackTrace;
} 
```

如果它死锁，死锁会自动释放，你会得到一个空跟踪。（然后您可以再次调用它。）

我应该补充一点，经过几天的测试，我只能在我的 Core i7 机器上创建一个死锁。但是，当 CPU 以 100% 运行时，死锁在单核 VM 上很常见。

**更新**：此方法仅适用于 .NET Framework。在 .NET Core 和 .NET 5+ 中，`Suspend`并且`Resume`无法调用，因此您必须使用替代方法，例如 Microsoft 的 ClrMD 库。添加对 Microsoft.Diagnostics.Runtime 包的 NuGet 引用；然后您可以调用`DataTarget.AttachToProcess`以获取有关线程和堆栈的信息。请注意，您不能对自己的流程进行抽样，因此您必须启动另一个流程，但这并不困难。这是一个基本的控制台演示，说明了该过程，使用重定向的标准输出将堆栈跟踪发送回主机：

```
using Microsoft.Diagnostics.Runtime;
using System.Diagnostics;
using System.Reflection;

if (args.Length == 3 &&
    int.TryParse (args [0], out int pid) &&
    int.TryParse (args [1], out int threadID) &&
    int.TryParse (args [2], out int sampleInterval))
{
    // We're being called from the Process.Start call below.
    ThreadSampler.Start (pid, threadID, sampleInterval);
}
else
{
    // Start ThreadSampler in another process, with 100ms sampling interval
    var startInfo = new ProcessStartInfo (
        Path.ChangeExtension (Assembly.GetExecutingAssembly().Location, ".exe"),
        Process.GetCurrentProcess().Id + " " + Thread.CurrentThread.ManagedThreadId + " 100")
    {
        RedirectStandardOutput = true,
        CreateNoWindow = true
    };

    var proc = Process.Start (startInfo);

    proc.OutputDataReceived += (sender, args) =>
        Console.WriteLine (args.Data != "" ? "  " + args.Data : "New stack trace:");

    proc.BeginOutputReadLine();

    // Do some work to test the stack trace sampling
    Demo.DemoStackTrace();

    // Kill the worker process when we're done.
    proc.Kill();
}

class Demo
{
    public static void DemoStackTrace()
    {
        for (int i = 0; i < 10; i++)
        {
            Method1();
            Method2();
            Method3();
        }
    }

    static void Method1()
    {
        Foo();
    }

    static void Method2()
    {
        Foo();
    }

    static void Method3()
    {
        Foo();
    }

    static void Foo() => Thread.Sleep (100);
}

static class ThreadSampler
{
    public static void Start (int pid, int threadID, int sampleInterval)
    {
        DataTarget target = DataTarget.AttachToProcess (pid, false);
        ClrRuntime runtime = target.ClrVersions [0].CreateRuntime();

        while (true)
        {
            // Flush cached data, otherwise we'll get old execution info.
            runtime.FlushCachedData();

            foreach (ClrThread thread in runtime.Threads)
                if (thread.ManagedThreadId == threadID)
                {
                    Console.WriteLine();   // Signal new stack trace

                    foreach (var frame in thread.EnumerateStackTrace().Take (100))
                        if (frame.Kind == ClrStackFrameKind.ManagedMethod)
                            Console.WriteLine ("    " + frame.ToString());

                    break;
                }

            Thread.Sleep (sampleInterval);
        }
    }
} 
```

这是 LINQPad 6+ 用来在查询中显示实时执行跟踪的机制（带有额外的检查、元数据探测和更精细的 IPC）。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2010-08-30T17:47:53.310

这是一个旧线程，但只是想警告建议的解决方案：暂停和恢复解决方案不起作用 - 我刚刚在尝试序列暂停/堆栈跟踪/恢复的代码中遇到了死锁。

问题是 StackTrace 构造函数执行 RuntimeMethodHandle -> MethodBase 转换，这改变了内部 MethodInfoCache，它需要一个锁。发生死锁是因为我正在检查的线程也在进行反射，并且持有该锁。

遗憾的是，挂起/恢复的东西没有在 StackTrace 构造函数中完成——那么这个问题很容易被规避。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-02-09T12:59:02.667

根据[C# 3.0 in a Nutshell](http://www.albahari.com/nutshell/)，这是可以调用 Suspend/Resume 的少数情况之一。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2013-02-18T11:36:53.723

正如我在评论中提到的，上面提出的解决方案仍然存在很小的死锁概率。请在下面找到我的版本。

```
private static StackTrace GetStackTrace(Thread targetThread) {
using (ManualResetEvent fallbackThreadReady = new ManualResetEvent(false), exitedSafely = new ManualResetEvent(false)) {
    Thread fallbackThread = new Thread(delegate() {
        fallbackThreadReady.Set();
        while (!exitedSafely.WaitOne(200)) {
            try {
                targetThread.Resume();
            } catch (Exception) {/*Whatever happens, do never stop to resume the target-thread regularly until the main-thread has exited safely.*/}
        }
    });
    fallbackThread.Name = "GetStackFallbackThread";
    try {
        fallbackThread.Start();
        fallbackThreadReady.WaitOne();
        //From here, you have about 200ms to get the stack-trace.
        targetThread.Suspend();
        StackTrace trace = null;
        try {
            trace = new StackTrace(targetThread, true);
        } catch (ThreadStateException) {
            //failed to get stack trace, since the fallback-thread resumed the thread
            //possible reasons:
            //1.) This thread was just too slow (not very likely)
            //2.) The deadlock ocurred and the fallbackThread rescued the situation.
            //In both cases just return null.
        }
        try {
            targetThread.Resume();
        } catch (ThreadStateException) {/*Thread is running again already*/}
        return trace;
    } finally {
        //Just signal the backup-thread to stop.
        exitedSafely.Set();
        //Join the thread to avoid disposing "exited safely" too early. And also make sure that no leftover threads are cluttering iis by accident.
        fallbackThread.Join();
    }
}
} 
```

我认为，ManualResetEventSlim“fallbackThreadReady”并不是真正必要的，但为什么要在这种微妙的情况下冒险呢？

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2017-04-24T14:45:12.043

看起来这是过去受支持的操作，但不幸的是，微软已经过时了：[https ://msdn.microsoft.com/en-us/library/t2k35tat(v=vs.110).aspx](https://msdn.microsoft.com/en-us/library/t2k35tat(v=vs.110).aspx)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-12T20:50:09.683

我认为，如果您想在没有目标线程的合作的情况下执行此操作（例如，在您的线程执行堆栈跟踪时，让它调用一个在信号量上阻塞它的方法或其他东西），您将需要使用已弃用的 API。

一种可能的替代方法是使用.NET 调试器使用[的基于 COM 的 ICorDebug](http://blogs.msdn.com/jmstall/archive/2004/10/05/237954.aspx)接口。MDbg 代码库可能会给你一个开始：

*   [`http://blogs.msdn.com/jmstall/archive/2005/11/07/views_on_cordbg_and_mdbg.aspx`](http://blogs.msdn.com/jmstall/archive/2005/11/07/views_on_cordbg_and_mdbg.aspx)
*   [`http://geekswithblogs.net/johnsPerfBlog/archive/2008/10/13/mdbg-a-managed-wrapper-around-icordebug.aspx`](http://geekswithblogs.net/johnsPerfBlog/archive/2008/10/13/mdbg-a-managed-wrapper-around-icordebug.aspx)

# client-server - 服务器应用程序设计方法

> ID：285035
> 
> 赞同：1
> 
> 时间：2008-11-12T19:26:01.787
> 
> 标签：client-server

在本科期间，我选择参加使用 POSIX 套接字 for linux 的网络编程课程。作为参考，我们使用了 Internetworking using TCP/IP (comer and stevens) 一书。2008 年它是一个相当过时且仍然适用的文本，它需要一个通过多个服务器设计。

书中没有真正介绍的一种设计是客户端连接到后端应用程序服务器通过单个 TCP 连接向服务器发送多个请求的情况。由于多个请求通过从属套接字发送到服务器，并且响应通过同一个从属套接字发送。当响应和请求通过同一个套接字接收时，从套接字变得拥塞，是否允许在端点之间建立第二个 TCP 连接以实现全双工通信速度是更好的选择？还可以使用哪些其他架构来提高服务器性能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-12T19:30:20.530

由于套接字只是附加到数据包的数字（称其为路由号或地址），我无法想象套接字本身会变得拥挤。

您可以处理套接字的代码，但这应该很容易通过在数据包到达时分发数据包来解决。

您还可以对传入和传出的数据包处理进行编码，使其发生在不同的线程上，甚至可以将数据包排队以分发给多个线程。

但我真的不认为最初的假设是完全准确的。我可能是错的...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-12T19:42:58.070

TCP 连接已经是全双工的。您可以（简化事情）将 TCP 连接视为一对单向连接（一个发送和一个接收）。

通过单个连接发送多个请求实际上用于*提高*多个协议的性能（因为重用连接可以避免握手和慢启动开销）。一个例子是 HTTP 保持连接。另一种提高性能的方法是使用流水线（发送多个请求而不等待响应），这显然只能在您为多个请求重用 TCP 连接时才能完成。

# c# - 如何将图像和文本作为一个对象复制到剪贴板？

> ID：285042
> 
> 赞同：5
> 
> 时间：2008-11-12T19:27:43.233
> 
> 标签：c#, .net, clipboard, copy-paste

我正在尝试将文件中的图像和文件中的文本复制到剪贴板。我的意图是打开一个 word 文档或一封 Outlook 电子邮件，并将文本和图像粘贴到一个标准粘贴命令（例如 CTRL-V）中。我可以很容易地分别做这两个，但是在一个操作中同时做这两个似乎不起作用。

这就是我如何让这两个作为单独的操作工作（当然只有相关的代码行，去掉 try/catch 等）：

将图像添加到剪贴板：

...

```
Bitmap imageToAdd = new Bitmap(imageFilePath);
Clipboard.SetImage(imageToAdd); 
```

...

将文本添加到剪贴板：

...

```
StreamReader rdr = new StreamReader(textFilePath);
string text = rdr.ReadToEnd();

Clipboard.SetText(text); 
```

...

我正在使用 c# 和 .net 2.0 框架并针对 Windows XP（在不久的将来可能还会使用 Vista）。

TIA

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2010-12-01T23:59:24.257

您可以使用 RTF，它可以结合文本和图形。请注意，您可以在剪贴板上同时拥有 CF_BITMAP 和 CF_TEXT。但这没有用。粘贴到记事本时会得到文本，粘贴到 Paint 时会得到位图，大多数其他应用程序会选择其中一个，但绝不会两者兼而有之。所以这只是学术性的。有点整洁，就像星际迷航中的运输机故障一样整洁。但也很乱。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-12T21:25:18.643

也许您可以使用需要 Object 参数的 SetDataObject，您可以使用对象数组？

对象数组可以保存您所需的数据。

请参阅此链接：

[http://msdn.microsoft.com/en-us/library/5b8kt5z4.aspx](http://msdn.microsoft.com/en-us/library/5b8kt5z4.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-20T23:18:08.500

我注意到只能传入一个对象。

在这种情况下，当用户按下命令进行粘贴时，你的代码可以执行两个函数，或者递归地执行一个函数，每次都得到你想要的数据并粘贴进去。

所以，看看循环或递归。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-05-11T21:34:14.690

添加具体代码实现；

```
// Load a bitmap without locking it.
private Bitmap LoadBitmapUnlocked(string path)
{
    using (Bitmap bm = new Bitmap(path))
    {
        return new Bitmap(bm);
    }
} 
```

...

```
string path = 
@"C:\Windows\Web\Wallpaper\Architecture\img13.jpg"; 
DataObject dataObj = new DataObject();
dataObj.SetData(DataFormats.Bitmap, true, LoadBitmapUnlocked(path));
dataObj.SetData(DataFormats.UnicodeText, path);
Clipboard.SetDataObject(dataObj); 
```

# python - 您如何以编程方式设置属性？

> ID：285061
> 
> 赞同：244
> 
> 时间：2008-11-12T19:33:07.933
> 
> 标签：python, attributes, object

假设我有一个 python 对象`x`和一个字符串，`s`如何设置属性？所以：`s``x`

```
>>> x = SomeObject()
>>> attr = 'myAttr'
>>> # magic goes here
>>> x.myAttr
'magic' 
```

有什么魔力？顺便说一句，这样做的目的是缓存对`x.__getattr__()`.

* * *

## 回答 #1

> 赞同：345
> 
> 时间：2008-11-12T19:38:30.200

```
setattr(x, attr, 'magic') 
```

寻求帮助：

```
>>> help(setattr)
Help on built-in function setattr in module __builtin__:

setattr(...)
    setattr(object, name, value)

    Set a named attribute on an object; setattr(x, 'y', v) is equivalent to
    ``x.y = v''. 
```

但是，您应该注意，您不能对`object`. 但很可能你有一个简单的对象子类，它可以正常工作。我强烈敦促 OP 永远不要创建这样的对象实例。

* * *

## 回答 #2

> 赞同：61
> 
> 时间：2008-11-12T19:41:19.947

通常，我们为此定义类。

```
class XClass( object ):
   def __init__( self ):
       self.myAttr= None

x= XClass()
x.myAttr= 'magic'
x.myAttr 
```

但是，在某种程度上，您可以使用`setattr`和`getattr`内置函数来执行此操作。但是，它们不适用于`object`直接的实例。

```
>>> a= object()
>>> setattr( a, 'hi', 'mom' )
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
AttributeError: 'object' object has no attribute 'hi' 
```

然而，它们确实适用于各种简单的类。

```
class YClass( object ):
    pass

y= YClass()
setattr( y, 'myAttr', 'magic' )
y.myAttr 
```

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2013-10-28T14:37:59.937

让 x 成为一个对象，那么你可以通过两种方式做到这一点

```
x.attr_name = s 
setattr(x, 'attr_name', s) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-08-28T08:30:54.083

在课堂上也可以正常工作：

```
def update_property(self, property, value):
   setattr(self, property, value) 
```

# opengl - OpenGL：模型视图矩阵的多用户向量？

> ID：285068
> 
> 赞同：7
> 
> 时间：2008-11-12T19:35:22.953
> 
> 标签：opengl, 3d, transformation

有没有办法让OpenGL转换一个我用当前模型视图矩阵给它的通用向量并取回结果？

显而易见的方法是查询模型视图矩阵并自己进行乘法运算，但我几乎可以肯定应该有一种方法可以让 OpenGL 为我做这件事。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-12T20:00:46.333

没错，您必须自己获取模型视图矩阵并转换向量。

如需确认，请参阅第 9.120 段的[此链接](http://www.opengl.org/resources/faq/technical/transformations.htm)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-12T20:38:24.293

最好在 OpenGL 之外进行计算。如果您还不知道[，矩阵和四元数常见问题解答是学习如何执行计算的一个很好的资源。](http://www.j3d.org/matrix_faq/matrfaq_latest.html)您获取 4x4 模型视图矩阵如下

```
float modelview[16];
glGetFloatv(GL_MODELVIEW_MATRIX, modelview); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-12T23:08:41.400

最好在 CPU 端进行转换。我能想到的唯一其他方法是使用[EXT_transform_feedback](http://www.opengl.org/registry/specs/EXT/transform_feedback.txt)加上一个仅执行模型视图转换的顶点着色器。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-11-12T23:33:25.453

opengl 可能不会只为您执行此操作的原因是因为计算不是渲染管道的一部分。而opengl（大部分）只在显示循环期间执行计算。所以提供这种同步接口是没有意义的。

# jquery - 使用 jQuery Sortables 拖动项目时单选按钮被取消选择

> ID：285074
> 
> 赞同：7
> 
> 时间：2008-11-12T19:37:53.993
> 
> 标签：jquery, jquery-ui, drag-and-drop, radio-button, jquery-ui-sortable

我正在使用[jQuery UI sortables](http://docs.jquery.com/UI/Sortables)插件来允许对某些列表项进行重新排序。在每个列表项中，我有几个单选按钮，可以启用或禁用该项目。

拖动项目时，两个单选按钮都被取消选择，这似乎不应该发生。这是正确的行为，如果不是，解决此问题的最佳方法是什么？

这是演示此问题的代码示例：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" >
<head>
    <title>jQuery Sortables Problem</title>
    <script src="jquery-1.2.6.min.js" type="text/javascript"></script>
    <script src="jquery-ui.min.js" type="text/javascript"></script>

    <style type="text/css">
        .items
        {
          margin-top: 30px;
          margin-left: 0px;
          padding-left: 25px;
          cursor: move;
        }
        .items li
        {
          padding: 10px;
          font-size: 15px;
          border: 1px solid #666;
          background: #eee;
          width: 400px;
          margin-bottom: 15px;
          float: left;
          clear:both;
        }
    </style>

</head>
<body>

<ol id="itemlist" class="items"> 
    <li id="1" class="item">
        Item 1
        <input name="status_1" type="radio" value="1" checked="checked" />enabled
        <input name="status_1" type="radio" value="0" />disabled
    </li> 
    <li id="2" class="item">
        Item 2
        <input name="status_2" type="radio" value="1" checked="checked" />enabled
        <input name="status_2" type="radio" value="0" />disabled
    </li> 
    <li id="3" class="item">
        Item 3
        <input name="status_3" type="radio" value="1" checked="checked" />enabled
        <input name="status_3" type="radio" value="0" />disabled
    </li> 
    <li id="4" class="item">
        Item 4
        <input name="status_4" type="radio" value="1" checked="checked" />enabled
        <input name="status_4" type="radio" value="0" />disabled
    </li> 
</ol>

<script type="text/javascript">
    $('#itemlist').sortable();
</script>

</body>
</html> 
```

只要用鼠标抓住一个列表项，两个单选按钮就会被取消选择。

如果这是一个错误，一种解决方法是在移动项目时自动选择“启用”单选按钮，因此任何关于如何实现这一点的建议也将不胜感激。

更新：我已经在 Windows XP x64 上的 FireFox 3、Internet Explorer 7、Opera 9.5 和 Safari 3.1.2 中对此进行了测试，所有这些都出现了这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-17T09:13:40.343

更新：这适用于 jQuery.ui 1.5.2。如果您使用的是 1.6rc2，请尝试 Ben Koehler 解决方案。

* * *

似乎 sortables 插件克隆了正在移动的节点。如果我们使用克隆节点，`$('#itemlist li').clone().appendTo("#itemlist");`我们将看到类似的行为，因为现在有 4 个具有相同名称的单选按钮，而不是两个。

您可以使用 helper 选项覆盖 sortables 插件的工作方式。尝试这个：

```
$('#itemlist').sortable({helper: function(){
    return $("<li>").css({border: "1px solid red", background: "transparent"}).appendTo("#itemlist")[0];
}}); 
```

我们正在创建一个没有单选按钮的新节点并将其附加到列表中。这个新节点将是动画节点。
此代码在 FF3 和 Chrome 中运行良好，但 IE7 不断将单选按钮重置为其默认状态。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-14T17:05:56.117

它可能不是您正在寻找的，但正在改变

```
$('#itemlist').sortable(); 
```

至

```
$('#itemlist').sortable({placeholder: ".items li"}); 
```

保留单选按钮选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-07-23T13:48:49.330

单选按钮失去状态的某种答案在这里 [http://core.trac.wordpress.org/ticket/16972#comment:4](http://core.trac.wordpress.org/ticket/16972#comment:4)

这有点长的路要走，但只有这样我才能找到在被拖到某个地方后重新做单选按钮状态的方法

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-12T21:10:50.467

这是在 Internet Explorer 中吗？众所周知，IE 在复制/移动时会丢失对复选框和收音机的选择。

[http://webbugtrack.blogspot.com/2007/11/bug-299-setattribute-checked-does-not.html](http://webbugtrack.blogspot.com/2007/11/bug-299-setattribute-checked-does-not.html)

需要重置 defaultChecked 才能使 IE 正常运行

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-10-09T17:01:21.570

我遇到了很多同样的问题，但我在这里找到了解决方案：http: [//fiddyp.co.uk/how-to-fix-radio-inputs-losing-focus-when-dragging-a-jquery-ui -sortable-div/](http://fiddyp.co.uk/how-to-fix-radio-inputs-losing-focus-when-dragging-a-jquery-ui-sortable-div/) 这似乎允许我拖放表格行，并且单选按钮保持正确。

```
// global script for commentluv premium settings pages
// workaround for bug that causes radio inputs to lose settings when meta box is dragged.
// http://core.trac.wordpress.org/ticket/16972
jQuery(document).ready(function(){
    // listen for drag drop of metaboxes , bind mousedown to .hndle so it only fires when starting to drag
    jQuery('.hndle').mousedown(function(){
        // set event listener for mouse up on the content .wrap and wait a tick to give the dragged div time to settle before firing the reclick function
        jQuery('.wrap').mouseup(function(){store_radio(); setTimeout('reclick_radio();',50);});
    })
});
/**
* stores object of all radio buttons that are checked for entire form
*/
function store_radio(){
    var radioshack = {};
    jQuery('input[type="radio"]').each(function(){
        if(jQuery(this).is(':checked')){
            radioshack[jQuery(this).attr('name')] = jQuery(this).val();
        }
        jQuery(document).data('radioshack',radioshack);
    });
}
/**
* detect mouseup and restore all radio buttons that were checked
*/
function reclick_radio(){
    // get object of checked radio button names and values
    var radios = jQuery(document).data('radioshack');
    //step thru each object element and trigger a click on it's corresponding radio button
    for(key in radios){
        jQuery('input[name="'+key+'"]').filter('[value="'+radios[key]+'"]').trigger('click');
    }
    // unbind the event listener on .wrap  (prevents clicks on inputs from triggering function)
    jQuery('.wrap').unbind('mouseup');
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-12-01T22:44:34.763

作为 Randy，我发现的最佳解决方案是将选中的属性存储在另一个属性中，然后在移动后将选中的属性返回到无线电输入。我以一种更简单的方式做到了这一点，使用可排序的开始和停止参数，如下所示。

```
// First, create a function to store the properties.

// Store the checked radio properties
    function gravaSelecoes() {
      $("tbody.linhasConf").find("input:radio").each(function () {
        if ($(this).prop("checked"))
          $(this).attr("data-checked", "true");
        else
          $(this).attr("data-checked", "false");
      });
    }

// Then, create a function that restore the properties

// Restore the checked radio properties
    function atualizaSelecoes() {
      $("tbody.linhasConf").find("input:radio").each(function () {
        if ($(this).attr("data-checked") == "true")
          $(this).prop("checked", true);
        else
          $(this).prop("checked", false);
      });
    }

// And when declaring sortables, refer to those functions

    $('tbody.linhasConf').sortable({
      start: gravaSelecoes,
      stop: atualizaSelecoes
    }).disableSelection(); 
```

罗德里戈

# java - Log4j 记录到共享日志文件

> ID：285081
> 
> 赞同：7
> 
> 时间：2008-11-12T19:39:07.313
> 
> 标签：java, log4j

有没有办法将 log4j 日志记录事件写入也被其他应用程序写入的日志文件。其他应用程序可以是非 Java 应用程序。有什么缺点？锁定问题？格式化？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-12T19:53:56.037

Log4j 有一个 SocketAppender，它将向服务发送事件，您可以自己实现或使用与 Log4j 捆绑的简单实现。

它还支持 syslogd 和 Windows 事件日志，这在尝试将日志输出与来自非 Java 应用程序的事件统一时可能很有用。

如果性能是一个问题，您需要一个单独的服务来写入日志文件，而不是尝试在不同的日志应用程序之间协调一致的锁定策略。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-12T19:47:00.853

您最好的选择可能是让每个应用程序单独记录，然后安排一个计划的作业以根据时间将文件“压缩”在一起。如果您确实需要对完整日志的最新访问，您可以每小时运行一次。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-12T20:29:18.553

我有以下两种方法的经验：

1.  使用数据库而不是纯文本文件进行日志记录 - 由于性能问题可能会令人望而却步，另一方面，分析日志和创建报告非常容易。数据库负责处理所有并发问题。
2.  另一种方法涉及使用 JBoss 服务器，它可用于从其他来源读取日志信息。JBoss 可以在最小配置下运行，并且由于它非常轻量级（启动时间为 2 秒）。可以在此处找到详细信息[http://docs.jboss.org/process-guide/en/html/logging.html](http://docs.jboss.org/process-guide/en/html/logging.html)（登录到单独的服务器）。Log4J 负责所有锁定/并发问题。

如果您不打算使用 JBoss，您可以使用第二种方法作为您自己的日志记录解决方案的基础。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-09T18:15:43.377

我认为默认的 log4j 附加程序不会执行任何文件锁定或同步。如果没有这种锁定，您可能会丢失日志消息或收到损坏的日志消息。

我不确定在 Java 中进行文件锁定有多容易，但要直接进行这项工作，我认为您需要继承适当的 Appender 并覆盖日志记录方法，并使用锁定和解锁文件的同步代码包装它. 这可能会影响性能，具体取决于您的系统负载。

Log4perl 有一个同步的 Appender，Log::Log4perl::Appender::Synchronized，它包装了一个 Appender 并完成了这个，并且似乎在它的 Log::Log4perl::Appender::File 中提供了一个标志来防止交叉行。您可能会查看它们所做的事情，看看它是否可以在 Java 中复制。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-11-12T19:52:11.703

Log4j 足够灵活，您可以以与文件中已有记录兼容的格式创建日志条目。只需查看附加程序以了解如何格式化特定数据字段。

您主要关心的是锁定，很可能是其他应用程序。确保所有应用程序都没有对文件的排他锁，你应该没问题。

# java - 是否可以在 jsp 2.0 自定义标签中获取调用页面名称？

> ID：285083
> 
> 赞同：0
> 
> 时间：2008-11-12T19:39:15.783
> 
> 标签：java, jsp, jsp-tags

我正在使用 JSP 2 标记文件编写自定义 JSP 标记。在我的标签内，我想知道哪个页面调用了标签以构建 URL。如果不通过属性，这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-13T21:42:47.840

事实证明，请求对象实际上是可用的，但仅在标签的 EL 部分中。所以这会起作用：

```
<form action="${pageContext.request.requestURI}"> 
```

但不是这个：

```
<form action="<%=request.requestURI%>"> 
```

或这个：

```
<form action="<%=pageContext.request.requestURI%>"> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-13T03:41:16.077

我认为在标记代码中，您可以检查请求对象及其 url，并从中确定页面。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-13T22:05:50.757

可以通过`pageContext`成员变量从标记文件中访问请求。

```
public class YourTag extends TagSupport {
    public int doStartTag() throws JspException {
        HttpServletRequest req = (HttpServletRequest) pageContext.getRequest();
        String pathInfo = req.getPathInfo(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-14T05:45:55.057

请求对象在标签中可用。使用类还是标签文件都没有关系。在标记文件中，它在 Java scriptlet 和 EL 中都可用。但是，它可以作为 ServletRequest 对象而不是 HttpServletRequest 对象使用（在 EL 中，对象的类无关紧要，但在 scriptlet 中确实如此）。

此外，在您的 scriptlet 中，您需要访问完整的方法，而不仅仅是属性名称。所以你的代码应该是：

```
<form action="<%= pageContext.getRequest().getRequestURI() %>"> 
```

但即使这样也行不通，因为 getRequestURI() 是 HttpServletRequest [1] 的方法，而不是 ServletRequest 的方法。因此，要么使用 EL，要么在标记文件中使用更长的 scriptlet 并转换请求对象。

[1] [http://java.sun.com/javaee/5/docs/api/javax/servlet/http/HttpServletRequest.html#getRequestURI()](http://java.sun.com/javaee/5/docs/api/javax/servlet/http/HttpServletRequest.html#getRequestURI())

# linq - LINQ to Objects：可以使用多个 LIKE 条件（OR 或 AND）进行查询？

> ID：285087
> 
> 赞同：4
> 
> 时间：2008-11-12T19:41:27.310
> 
> 标签：linq, linq-to-objects

我们有一个表单，允许用户通过在文本框中输入来过滤列表。我们需要根据两个字段过滤列表。FundName 和 CompanyName。当表单加载时，我将初始 LINQ to SQL 结果放入一个列表中，这样对于每个后续操作（过滤器），数据库都不会被命中。这显着加快了处理速度（从大约 400 毫秒到每个过滤器操作不到 6 毫秒，例如键入一个字符）并减少了 DB 喋喋不休。

问题是当我们决定对两个字段进行过滤条件搜索时，LINQ to Object 查询不起作用。我**可以**有一个具有多个条件的查询，而**不是**多个 LIKE（或 .Contains 或 .Endswith 等评估为 SQL LIKE 语句的方法）。该查询确实对 LINQtoSQL 起作用，但对对象不起作用。这是一些示例代码：

```
Dim db As New BenchmarkLINQtoSQLDataContext()

Dim fundList = From FundShort In db.FundShorts _
Select FundShort _
Order By FundShort.IRBB

Dim linqFundShortList As New List(Of FundShort)
linqFundShortList = fundList.ToList()

Dim filterText = "aka"

'This works
Dim successQuery = From fs In fundList _
        Where fs.FundName.ToLower.Contains(filterText) _
        Or fs.CompanyName.ToLower.Contains(filterText) _
        Select fs

FundBindingSource.DataSource = successQuery

'This also works 
Dim successQuery2 = From fs In linqFundShortList _
         Where fs.FundName.ToLower.Contains(filterText) _
         Select fs

FundBindingSource.DataSource = successQuery2

'This does not
Dim failQuery = From fs In linqFundShortList _
         Where (fs.FundName.ToLower.Contains(filterText) _
         Or fs.CompanyName.ToLower.Contains(filterText)) _
         Select fs

FundBindingSource.DataSource = failQuery 
```

例外是“对象引用未设置为对象的实例”。- 堆栈跟踪是：

```
 at Benchmark.BPRMS.FundsMain._Closure$__1._Lambda$__3(FundShort fs) in
     C:\Projects\BPRMS\Trunk\BPRMS\Forms\FundsMain.vb:line 72
   at System.Linq.Enumerable.WhereSelectListIterator`2.MoveNext()
   at System.Linq.SystemCore_EnumerableDebugView`1.get_Items() 
```

任何和所有的帮助和建议将不胜感激。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-12T19:47:03.867

如果您收到 NullReferenceException，听起来 FundName 或 CompanyName 为 null（无）。尝试：

```
Dim failQuery = From fs In linqFundShortList _
     Where (((Not fs.FundName Is Nothing) AndAlso fs.FundName.ToLower.Contains(Me.filterText))_
     OrElse ((Not fs.CompanyName Is Nothing) AndAlso fs.CompanyName.ToLower.Contains(Me.filterText))) _
     Select fs 
```

（语法可能有点偏离，但希望你能明白要点。）

# algorithm - 计算一周中某一天的日期

> ID：285095
> 
> 赞同：1
> 
> 时间：2008-11-12T19:45:21.327
> 
> 标签：algorithm, tsql, datetime, pseudocode

给定一个工作日（1-7），我如何计算该工作日的最后日期是什么？

**示例：**今天是2008 年 11 月 12**日星期三**，我想知道上**周五的**日期。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-12T19:53:05.757

一般来说？请参阅[日历计算](http://emr.cs.uiuc.edu/home/reingold/calendar-book/index.shtml)。

在前一周的这个较窄的情况下？找出天数的差异（星期五 = 5，星期三 = 3）。以周为单位查找差异（上周 = -7 天）。当您找到以天+周为单位的偏移量时，将该偏移量应用于日历日期。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-12T19:50:50.050

如果`today`是星期几，那么你可以使用类似的东西：

```
days_since_friday = (((today - 1) + 7) - (6 - 1)) % 7 
```

这假定星期五由一周中的第 6 天表示（即 1 代表星期日）。然后从当前日期中减去`days_since_friday`，您将得到上周末的日期。

上面的表达式比它需要的稍微复杂一些。如果您的星期几从周日的 0 开始，则它简化为：

```
days_since_friday = ((today + 7) - 5) % 7 
```

或者

```
days_since_friday = (today + 2) % 7 
```

# database - 将数据库复制到其他系统的最佳方法

> ID：285098
> 
> 赞同：2
> 
> 时间：2008-11-12T19:46:49.997
> 
> 标签：database, oracle, replication, enterprise

将更新流复制到大型（6TB）oracle db 到另一个非 DBMS 系统的最佳方法是什么？我不需要“批量加载”oracle db，而只想将所有更新近乎实时地流入另一个本土系统（10 秒或更短的延迟）。更新以 150 行/秒的速率发生，代表每秒 10 兆字节。

为了清楚起见，让我强调我不是从一个数据库复制到另一个数据库。这是一个应用程序集成问题：我需要从数据库复制到内部的非数据库应用程序。我曾想过使用企业服务总线，但这似乎不合适。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-12T20:35:37.903

所以你想要实现一个基于日志的复制方案，只是将事务日志抽到不同的文件系统？有许多商业产品可以让你做到这一点，比较知名的是[SharePlex](http://www.quest.com/shareplex-for-oracle/)和[GoldenGate ，甚至还有一个名为](http://www.goldengate.com/technology/tdm.html)[Zizzy](http://sourceforge.net/projects/zizzy)的开源产品，但我不能说我已经尝试过。

***编辑 1：****如果您不想将更新馈送到另一个数据库，[GoldenGate 的事件驱动架构](http://www.goldengate.com/solutions/eda.html)提供了一种将复制连接到 JMS 消息总线的方法。对于应用程序集成，这是我会选择的选项。*

***编辑 2：****如果使用消息总线不是您想要的方式，我能看到的唯一其他明智的选择是让您的手变脏并使用 Oracle 的[LogMiner](http://www.oracle.com/technology/deploy/availability/htdocs/LogMinerOverview.htm) API。IIRC，这是 Oracle 用于 Streams 和 DataGuard 等特性的东西，它可能是大多数变更数据捕获解决方案所基于的底层。*

# sql-server - Sql 2008 不允许我对表进行更改

> ID：285104
> 
> 赞同：1
> 
> 时间：2008-11-12T19:48:13.113
> 
> 标签：sql-server, sql-server-2008

出于某种原因，sql server 2008 不允许我将列添加到现有表中。

顺便说一句，桌子是空的。

是否有阻止修改 sql 2008 中的表的设置？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-12T19:51:25.153

是的，您可以更改设置以停止此操作。详情[在这里](http://www.west-wind.com/weblog/posts/455560.aspx)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-02-12T00:29:38.137

当您使用 SSMS 在数据库中设计表，然后尝试对表结构进行更改（例如添加不在末尾的列）时，必须重新创建表。默认设置是不允许您保存任何需要重新创建的更改。

你可以：

1.  转到工具 | 选项 | 设计师 | 表和设计器并取消选中*阻止保存需要重新创建表的更改*选项。
2.  编写更改脚本并自己运行。

**警告**

请注意，将其设置为默认值的原因是，在生产数据库中重新创建表可能非常有害，并且在某些极端情况下，自动脚本可能会出错。如果您在具有数十亿行的多个文件组上有一个非常复杂的分区表怎么办？假设您实际上拥有两个表副本以及一个绝对庞大的事务日志所需的巨大空间，这将破坏您的整个数据库数小时，并且可能会弄乱最终结果。或者，如果您的新表无法插入（例如在没有默认值的情况下添加非空列的情况），那么脚本可能会在没有正确恢复的情况下使插入步骤失败，并且您最终会得到一个空的桌子。

思路：先备份！

如果您不了解风险，请不要做任何事情。

**丢失数据示例**

这是[某人](https://stackoverflow.com/q/17244518/57611)通过使用此选项丢失数据的完美示例。别说我没警告过你。

# vb6 - VB6 中 Directory.CreateDirectory() 的等价物

> ID：285107
> 
> 赞同：5
> 
> 时间：2008-11-12T19:48:56.717
> 
> 标签：vb6

尝试一次创建几层文件夹 C:\pie\applepie\recipies\ 而不使用几个不同的命令，有没有类似于 Directory.CreateDirectory() 的简单方法

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-12T19:57:17.683

这是我在一个项目中使用的一些代码。它需要将文件系统对象的引用添加到项目中。

首先，单击 Project -> References，向下滚动到“Microsoft Scripting Runtime”并选择它。然后你可以使用这个功能：

```
Public Sub MakePath(ByVal Folder As String)

    Dim arTemp() As String
    Dim i As Long
    Dim FSO As Scripting.FileSystemObject
    Dim cFolder As String

    Set FSO = New Scripting.FileSystemObject

    arTemp = Split(Folder, "\")
    For i = LBound(arTemp) To UBound(arTemp)
        cFolder = cFolder & arTemp(i) & "\"
        If Not FSO.FolderExists(cFolder) Then
            Call FSO.CreateFolder(cFolder)
        End If
    Next

End Sub 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-03-11T17:02:44.257

'无需引用FileSystemObject

```
Public Sub MkPath(ByVal sPath As String)
  Dim Splits() As String, CurFolder As String
  Dim i As Long
  Splits = Split(sPath, "\")
  For i = LBound(Splits) To UBound(Splits)
    CurFolder = CurFolder & Splits(i) & "\"
    If Dir(CurFolder, vbDirectory) = "" Then MkDir CurFolder
  Next i
End Sub 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-14T16:40:25.217

作为替代方案，这是我编写的一个函数，它采用包含驱动器号（如果需要）作为参数的完整路径。然后它遍历路径并捕获 VB 错误号 76（未找到路径）。当错误处理程序捕获错误 76 时，它会创建导致错误的文件夹并继续遍历路径。

```
    公共函数 Check_Path(rsPath As String) 作为布尔值
        将 dPath 调暗为字符串
        将 i 调暗为整数
        将 sProductName 调暗为字符串

        出错时转到 Check_Path_Error

        If Left$(UCase$(rsPath), 2) Left$(UCase$(CurDir), 2) 那么
            ChDrive 左 $(rsPath, 2)
        万一

        我 = 3
        Do While InStr(i + 1, rsPath, "\") > 0
            dPath = Left$(rsPath, InStr(i + 1, rsPath, "\") - 1)
            i = InStr(i + 1, rsPath, "\")
            ChDir dPath
        环形
        dPath = rsPath
        ChDir dPath

        Check_Path = True

    退出函数

    Check_Path_Error：
        If Err.Number = 76 Then 'path not found'
            MkDir dPath '创建文件夹'
        恢复
    别的
        sProductName = IIf(Len(App.ProductName) = 0, App.EXEName, App.ProductName)
        MsgBox "验证/创建目录时出现意外错误。" _
              & vbCrLf & vbCrLf & "错误: " & CStr(Err.Number) & ", " & Err.Description & ".", _
            vbOKOnly + vbCritical、sProductName &“ - 创建文件时出错”
        Check_Path = False
    万一

    结束功能

```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-12-19T17:23:30.670

然而，另一种简单的方法是：

```
Public Sub MakePath(ByVal Path As String)
    On Error Resume Next
    Shell "cmd /c mkdir """ & Path & """"
End Sub 
```

# windows-mobile - 如何将按钮添加到紧凑的框架 DataGrid？

> ID：285111
> 
> 赞同：5
> 
> 时间：2008-11-12T19:50:29.380
> 
> 标签：windows-mobile, compact-framework

是否可以为紧凑框架的 DataGrid 中的列添加按钮？到目前为止，我唯一能找到的是您可以添加文本框，仅此而已。什么是可以允许其他控件的 DataGrid 的一个很好的替代方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-13T01:00:08.600

您可以使用 DataGrid 的

```
public Rectangle GetCellBounds(int row, int col); 
```

和

```
public event EventHandler CurrentCellChanged;
public DataGridCell CurrentCell { get; set; } 
```

或者

```
public event MouseEventHandler MouseMove;
public HitTestInfo HitTest(int x, int y); 
```

在选定的单元格上显示一个按钮（或另一个控件）。

问候，坦伯格

# asp.net - 在 .NET 中上传大文件

> ID：285120
> 
> 赞同：11
> 
> 时间：2008-11-12T19:53:25.723
> 
> 标签：asp.net, ajax, file-upload, httphandler, large-files

我做了很多研究，找到了一个 .NET 的上传组件，我可以用它来上传大文件，有一个进度条，并且可以恢复大文件的上传。我遇到过一些组件，例如[AjaxUploader](http://ajaxuploader.com)、[SlickUpload](http://krystalware.com/products/slickupload/Default.aspx)和[PowUpload](http://www.element-it.com/PowUpload.ASPX)，仅举几例。这些选项中的每一个都需要花钱，并且只有 PowUpload 进行可恢复上传，但它使用 java 小程序来完成。我愿意为能很好地完成这些事情的组件付费，但如果我能自己编写它，那将是最好的。

我有两个问题：

1.  是否可以在不使用 flash/java/Silverlight 的情况下在客户端恢复文件上传？
2.  有没有人有一些代码或文章的链接来解释如何编写一个允许流式上传和 ajax 进度条的 .NET HTTPHandler？

谢谢你，
奥斯汀

**[编辑]**

我意识到我确实需要能够为我的项目进行可恢复的文件上传，对可以做到这一点的组件有什么建议吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-12T20:35:43.737

> 1) 是否可以在不使用 flash/java/Silverlight 的情况下在客户端恢复文件上传？

不。实际的 HTTP 协议本身不支持恢复部分上传，因此即使您确实使用了 flash 或 silverlight，您仍然需要在服务器上使用其他东西，例如 FTP。
过去，我通过用 C# 编写自定义客户端应用程序“解决”了这个问题，该应用程序将文件分解成小块（2meg），分别传输它们，然后服务器将它们组合在一起。

> 2) 有没有人有一些代码或文章的链接来解释如何编写一个允许流式上传和 ajax 进度条的 .NET HTTPHandler？

虽然这并不能解决“恢复”问题，但我在客户端使用了[SWFUpload](http://swfupload.org/)并且效果非常好。它提供了一个智能文件浏览器（您可以在其中仅提示用户输入 jpeg 文件等）和上传进度跟踪，所有这些都无需修改您的服务器。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-12T20:12:14.737

无法使用标准 HTML 文件输入控件恢复上传，因为整个文件是通过 HTTP 请求提交的。

我过去使用过[NeatUpload](http://www.brettle.com/neatupload)，它为您提供了一个进度条。它在 LGPL 许可下，因此您无需为此付费，而且它是开源的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-13T16:45:45.177

没有更多关于简历问题的补充。我使用（并继续使用）telerik radUpload，我对它非常满意（它甚至可以用于中等信任模式，这对我来说非常重要）。我遇到的唯一问题（并且无法解决）是上传大于 2GB 的文件......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-23T02:52:13.377

[SlickUpload](http://krystalware.com/Company/ClientList.aspx)非常可靠，很多大公司都在使用它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-06-18T10:23:41.560

This is probably too late for your project, but POW Upload have now implemented auto resume upload in their new version. We're about to implement it on our site.

# apache-flex - 在 Flex 3 模块中使用复选框/单选按钮/进度条

> ID：285125
> 
> 赞同：0
> 
> 时间：2008-11-12T19:54:20.327
> 
> 标签：apache-flex, flex3, module

在我的项目环境中，我有 2 个项目。

我的应用程序和我的模块

MyApp 加载 MyModule。当它加载时，它会尝试获取一个 DisplayObject 类型的类并将其添加到自身的容器中。

当我尝试使用复选框/单选按钮/进度条时出现问题。

复选框和单选按钮看起来与普通按钮完全一样，进度条崩溃：

“尝试在非构造函数上实例化。”

ProgressBar.as 中的第 958 行

```
if (!_barMask)
        {
            if (FlexVersion.compatibilityVersion >= FlexVersion.VERSION_3_0)
            {
                var barMaskClass:Class = getStyle("maskSkin");
                _barMask = new barMaskClass(); // CRASH!!
            }
            else
            {
                _barMask = new UIComponent();
            }    

            _barMask.visible = true;
            _bar.addChild(DisplayObject(_barMask));
            UIComponent(_bar).mask = DisplayObject(_barMask);
        } 
```

有谁知道如何正确使用模块中的控件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-13T08:44:51.190

答案在这里：

[http://tech.groups.yahoo.com/group/flexcoders/message/130211](http://tech.groups.yahoo.com/group/flexcoders/message/130211)

该模块需要加载到应用程序域中。

# c# - 接口 C# 和 Java 的最佳方式是什么？

> ID：285126
> 
> 赞同：6
> 
> 时间：2008-11-12T19:54:50.777
> 
> 标签：c#, java

假设您有两种产品，一种是用 Java 编写的，另一种是用 C# 编写的。您喜欢基于 Java 的后端（非用户可见部分），但想使用 C# (WPF) 前端。将它们连接起来的最佳方法是什么？

请注意，后端必须能够在服务器或本地计算机上运行，​​并且前端应该能够连接到任何一个。

我的第一个想法是使用[Ice](http://www.zeroc.com)之类的东西，或者可能是 web 服务。

去！

**编辑**

转换代码或在各种中性 VM (IKVM) 中运行它不是一种选择。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-12T20:04:51.100

Web 服务应该是您的默认选择，因为在该领域有很多围绕互操作性的工作。

如果您不介意紧密耦合，并且必须做出基于性能的决策，那么我遇到的两个解决方案是：

*   [J-Integra](http://j-integra.intrinsyc.com/)
*   [剑网](http://www.codemesh.com/products/juggernet/)

我确定还有其他人。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-12T20:32:58.890

虽然 Web 服务 (WS-*)*可能*是正确的解决方案，但让堆栈进行互操作可能很麻烦。

对于 HTTP + (POX | JSON) 和 REST-ian 架构，有很多话要说。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-12T19:58:53.187

在 java 后端公开一个 web 服务，并让 C# 前端与 java web 服务对话。查看 WCF（Windows 通信基础），它可能会使与 Java Web 服务的对话更容易。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-12T20:00:05.057

您可以使用网络服务。

或者，您可以使用 IVKM 将 java 代码直接嵌入到 .NET 程序集中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-12T20:00:25.103

我在 C# 富客户端的 java 后端工作过。他们通过网络服务进行通信。我们真正遇到的唯一问题是继承层次结构，Web 服务 WSDL 会删除这些继承层次结构。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-12T20:40:55.037

我确实相信跨 Java/.NET 平台使用 Web 服务存在一些互操作性问题。例如，同时使用 Axis2 和 .net 会出现一些问题。在大多数情况下，存在变通方法。

不过，我听说过一些关于使用 REST-ian 架构的好评论。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-10-05T12:31:57.280

有几种方法可以创建/获得 java 和 .net 系统之间的互操作性。

*   **网页服务**
*   **视觉J#**
*   **Java 本机接口 (JNI)**
*   **字节码翻译**
*   **运行时桥**

Web 服务是最常用的。Web 服务大多使用基于 SOAP 的通信机制，它可能天生就比其他二进制通信机制慢。Web 服务也不适合在 Java 和 .NET 之间传递自定义对象作为参数和返回值。

这篇文章对什么是什么给出了很好的概述：

[http://www.devx.com/interop/Article/19945](http://www.devx.com/interop/Article/19945)

# python - 您使用哪种 IDE（如果有）构建 python GUI 项目？

> ID：285132
> 
> 赞同：3
> 
> 时间：2008-11-12T19:57:25.110
> 
> 标签：python, user-interface, ide

是否有任何 IDE（如 VS）具有拖放支持以构建 python GUI、连接到 dbs 等？尽管我是一个 emacs 人，但我发现使用 VS 创建 GUI 要容易得多。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-12T20:09:06.987

最简洁的答案是不”。没有像 IDE 这样的瑞士军刀，它既是全功能的 Python 代码编辑器又是全功能的 WYSIWYG GUI 编辑器。但是，有几个独立的工具可以让创建 GUI 变得更容易，并且有无数的代码编辑器，所以如果你可以处理打开两个窗口，那么你就可以完成你想要做的事情。

至于独立的 GUI 编辑器，您选择的将取决于您选择用于开发 GUI 的库。我建议使用[GTK+](http://www.gtk.org/)，它通过[PyGtk](http://www.pygtk.org/)绑定到 Python并具有[Glade](http://glade.gnome.org/) GUI 设计器。我相信还有其他用于 Python 的 GUI 库具有 WYSIWYG 设计器（Qt、Tkinter、wxWindows 等），但 GTK+ 是我最有经验的库，所以我将把其他的留给其他评论员。

但是请注意，这种情况下的设计器完全不依赖于语言。它只是吐出一个 .glade 文件，该文件可以加载到任何具有 GTK+ 绑定的语言中。如果您正在寻找生成原始 Python 代码的设计器（例如 VS.Net 使用的 Code-Behind 模型），那么我不知道。

至于一般的代码编辑 IDE（不包括 GUI 设计器），有[很多](http://wiki.python.org/moin/IntegratedDevelopmentEnvironments)，其中[PyDev](http://pydev.sourceforge.net/) / [Eclipse](http://www.eclipse.org/)可能是最类似于 Visual Studio 的。

（为清楚起见进行了修订。）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-12T20:12:28.510

仅对于 GUI，我发现 VisualWx ( [http://visualwx.altervista.org/](http://visualwx.altervista.org/) ) 非常适合在 Windows 下设计 wxPython 应用程序。

对于 GUI + 数据库，dabo ( [http://dabodev.com/](http://dabodev.com/) ) 可能是一个很好的答案。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-12T21:45:11.180

同样对于 PyGTK，还有[Gazpacho](http://gazpacho.sicem.biz/)，它是纯 python，可以更轻松地添加您自己的自定义小部件，并且已经支持 gtkbuilder。

几个月前我接手了该项目的维护工作，我们计划在[PIDA IDE](http://pida.co.uk/)的保护下发布它，采用更类似于 Visual Studio 的设置。补丁接受！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-12T21:53:29.990

我并不是真正的 Pythonista，但我*是*Mac 用户，我很欣赏我编写和使用的应用程序中的良好原生界面。因此，如果我要在 Mac 上使用 Python 作为 GUI 应用程序，我会使用带有 Interface Builder 和 Xcode 的 PyObjC，而不是跨平台解决方案。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-13T00:20:38.900

如果你进入 QT [EricIDE](http://die-offenbachs.de/eric/index.html)是一个不错的选择

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-12T20:04:11.070

[Eclipse](http://www.eclipse.org/)有 python 支持。

还有[IDLE](http://www.python.org/idle/doc/idle2.html)或[Wingware](http://www.wingware.com/)，虽然我不确定他们的 GUI 支持。

我敢肯定，一个好的[谷歌搜索](http://www.google.com/search?q=python+ide)会出现更多。

但最后，我对此表示怀疑。Python 依赖于第三方小部件集，如 Qt、Tk、Gtk、wxWidgets 等，以提供 GUI 支持。每个人都有自己的布局系统。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-12T20:09:16.287

你可以试试[Boa Constructor](http://boa-constructor.sourceforge.net/)或[Dabo](http://www.dabodev.com/)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-12T21:30:59.523

我是一个 GNOME 人，所以我更喜欢 PyGTK。标准的 GUI 构建器是[Glade Interface Designer](http://glade.gnome.org/)（直到它转换为 GtkBuilder）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-12T20:22:39.660

对于[wxPython](http://wxpython.org/)，我使用[xrced](http://xrced.sourceforge.net/)将 GUI 定义包含在 xml 文件中，我发现这种方式优雅且可扩展。

[wxformbuilder](http://wxformbuilder.org/)也不错。

至于 IDE，我是[WingIDE](http://www.wingware.com/)的粉丝。

# testing - 非开发人员测试 (QA)

> ID：285136
> 
> 赞同：4
> 
> 时间：2008-11-12T19:58:59.800
> 
> 标签：testing, qa

在自动化测试方面，我们有一个处于起步阶段的 QA 人员。目前，当他们测试我们的 Web 应用程序（主要是 .NET）时，他们会遵循他们多年来编写的测试脚本，通过浏览器手动访问测试环境并遵循他们的测试脚本。

工作人员由不精通脚本的个人组成，是否有任何工具可以提供更精简的学习曲线来自动化此类测试。他们通常通过 Web 界面执行操作，然后手动查询数据存储以查看他们执行的操作是否与他们期望的数据一致。

显然，这看起来很陈旧，但它完成了工作，尽管速度很慢。有没有人对他们可以断奶使用的工具有任何建议？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-12T20:07:29.863

我会推荐 selenium，它是免费的，并且有一个不错的 Firefox 插件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-03-21T18:07:25.523

可能有用的是使用划分自动化工作的框架。

看看
[http://www.amazon.com/Software-Test-Automation-Mark-Fewster/dp/0201331403](https://rads.stackoverflow.com/amzn/click/com/0201331403)

作者描述了如何从高级脚本中分离出低级代码。它允许测试人员开发自动化测试，而不必成为软件开发人员。

这种方法要求开发人员实现测试人员在其脚本中使用的底层“关键字”。这是一种协作方法，可以充分利用相关人员的各自才能。

有几种工具支持这种方法。我目前最喜欢的是机器人框架（[http://code.google.com/p/robotframework/](http://code.google.com/p/robotframework/)）。但是还有很多其他的，例如黄瓜（[http://cukes.info/](http://cukes.info/)）和健身（[http://fitnesse.org/](http://fitnesse.org/)）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-07-04T14:07:31.983

现在有一种专门的类型——无代码自动化测试系统。看看[Mabl](https://www.mabl.com)、[Test Cafe Studio](https://www.devexpress.com/products/testcafestudio/)、 [Testcraft](https://www.testcraft.io/)、[Testim](https://www.testim.io/)以及免费的[Puppetry](https://puppetry.app)。不需要任何编码技能，只需启动/加载工具并按照 GUI

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-12T20:11:31.587

最好让开发人员编写和运行单元测试，并使用（可能进行）集成/功能/系统测试进行 QA。首先，因为单元测试是他们的工作，其次，因为 QA 可能很难为无法测试的代码编写单元测试。

[Selenium](http://selenium.openqa.org/)可用于自动化 Web 应用程序。它可以记录浏览操作，也可以编写脚本。它是开源的（Apache 许可证）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-12T20:46:37.507

我使用了 QuickTest Pro。它的优点是记录功能非常好，但是你也可以做非常复杂的脚本。因此，随着 QA 人员变得更好，他们可以编写更复杂的测试。它有一个非常好的可视化脚本界面以及用 VB 编写脚本的能力。

不过它并不便宜。对我们来说，我们选择它的原因是很多免费工具不能很好地与 ActiveX 配合使用。因此，对于您的目的来说，这可能是矫枉过正。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-03-14T22:34:17.657

嘿。
。网？使用 MSVS2010。编码的 UI 测试是要走的路。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-06-25T11:34:51.517

7 年过去了，Selenium 似乎仍然很受欢迎。

可以在[此 Wiki 页面上找到一个很好的自动化工具列表](https://en.wikipedia.org/wiki/List_of_GUI_testing_tools)

对于网络：

1) **Selenium IDE（记录点击和重播）** ——非常适合初学者，因为用户可以记录点击，然后将其作为脚本**导出**到多种语言之一（python、ruby、Java）并从中学习。**仅建议作为过渡步骤，然后再继续**：

2) **[Selenium WebDriver](http://docs.seleniumhq.org/)** - 实际上自己编写 Selenium IDE 生成的代码 - 但更精简、不那么脆弱、更易于维护。

3）最近，[**Ranorex**](http://www.ranorex.com/)（商业）受到了很多关注。它将记录的动作转换`C#`为`VB.NET`代码

4) 我也听说过[**Robot framework**](http://robotframework.org/)和[**Watir**](https://watir.com/)的好消息。

但我只有使用 Selenium 的经验，而且我对它所提供的一切都很满意，除了它如何处理禁用元素。

# javascript - 在字段中显示“幻影”示例文本，然后将其清除 onblur

> ID：285139
> 
> 赞同：1
> 
> 时间：2008-11-12T19:59:48.567
> 
> 标签：javascript, jquery, html, forms, field

我正在尝试复制 Firefox 搜索框中使用的效果，如果搜索字段没有焦点（用户没有在其中单击），它只会以灰色文本显示*Google*。然后，当用户在框中单击时，文本被删除，他们可以填写他们的搜索词。

我想用它来为 Web 表单提供示例字段数据。

JQuery 语法比纯 javascript 更可取，但纯 JS 也可以。

非常感谢蜂巢思维！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-12T20:09:03.040

```
<style type='text/css'>
      input #ghost { color: #CCC; }
      input #normal { color: #OOO; }
</style>

<script type='text/javascript'> 
    function addTextHint(elem, hintText)
    {       
        if (elem.value == '')   
        {       
            elem.value = hintText;
            elem.style.className = 'ghost';
        }

        elem.onfocus = function ()
        {           
            if (elem.value == hintText)         
            {
                elem.value = '';
                elem.className = 'normal';
            }
        }

        elem.onblur = function ()
        {
            if (elem.value == '')
            {
                elem.value = hintText;
                elem.className = 'ghost';
            }
        }           
    }

    addTextHint(document.getElementById('foobar'),'Google');
</script> 
```

刚刚为你准备了这个。我敢肯定，jQuery 会使它变小，但我不使用它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-02-04T11:52:23.910

这种技术非常常用，现在 HTML 规范通过输入标记的占位符属性明确支持它：
[HTML 占位符属性](http://www.w3schools.com/tags/att_input_placeholder.asp)

[大多数浏览器已经支持它](http://caniuse.com/input-placeholder)，对于较旧的浏览器，有一个提供 shim 实现的 jquery 插件，可以在[此处](https://github.com/mathiasbynens/jquery-placeholder)找到。

有关占位符文本的样式，请参阅此（包括实时示例）：
[HTML5 Placeholder Styling with CSS](http://davidwalsh.name/html5-placeholder-css)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-12T20:15:03.403

另一种方法是使用一些 CSS，使用您想要的背景文本创建一个图像，并将其设置为文本框的背景图像，然后当文本框获得焦点时，您可以切换样式以删除该背景图像。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-18T17:38:07.797

jQuery实现

```
<input type="text" id = "textField" value="Google" class="RegularText GhostText" />

<style>
.GhostText{color:#DDD}
.RegularText{color:#CCC}
</style>

<script type="text/javascript" language="javascript">
$("#textField").blur(function(e){
    if ($.trim(e.target.value) == "") {
        e.target.value = e.target.defaultValue;
        e.target.toggleClass("GhostText");
    }
});
$("#textField").focus(function(e){
    if ($.trim(e.target.value) == e.target.defaultValue) {
        e.target.value = "";
        e.target.toggleClass("GhostText");
    }
});
</script> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-01-20T18:44:12.530

为什么要自己滚动？使用[这个插件](http://plugins.jquery.com/project/updnWatermark)。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2008-11-12T20:06:03.080

```
  $(选择器).text('谷歌');
  $(选择器).click(函数(){
    $(this).text('');
  });

```

可能有一种更优雅的方法可以做到这一点，但这假设您的框在页面加载时没有文本。如果是这样，您可以删除第一行。

我没有对此进行测试，但它应该可以工作。

# struts - Struts 瓦片 - 每个瓦片是异步的吗？

> ID：285142
> 
> 赞同：1
> 
> 时间：2008-11-12T20:00:43.480
> 
> 标签：struts, tiles

我有使用支柱的经验，并简要地尝试过瓷砖。我知道在布局中，每个图块都是一个单独的 jsp 页面。假设我在四个磁贴中的每一个上点击了一个按钮，并且每个磁贴都（间接地）调用了不同的 Web 服务。当结果在不同时间出现时，图块会异步刷新吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-22T07:37:23.237

瓷砖只是一个 html 页面的片段。除非您手动添加，否则没有 ajax 的概念。因此：在一个页面上按 4 个按钮将与在任何 html 页面上单击 4 个链接相同。浏览器将向服务器发送适当的请求。当服务器响应很快时，您甚至没有时间按下第二个按钮。当它足够慢时，第一个请求（浏览器到服务器）将被取消，第二个（第三个，第四个）将被发送（并在按下下一个按钮时取消）。

其余的取决于后端实现：在某个时间点，服务器会注意到它无法为 4 个请求中的 3 个发回数据。最后（打开）响应中将提供/显示的内容还取决于您的实施。如果有一些服务器端状态持有 Web 服务响应，则可能会显示所有 4 个结果。如果一项 Web 服务尚未返回，则可能只显示 3 个结果和一个旧磁贴。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-12T20:37:38.630

我认为这将取决于后台的代码。您说磁贴间接调用 Web 服务。我认为它会异步刷新，除非您在代码中指定不这样做。假设你按下按钮 1，然后按下按钮 2。动作 1 回来了，你的代码说屏幕需要更新，页面将刷新。一旦操作 2 返回，您的代码将再次更新屏幕。我相信这就是它的工作原理，但从未尝试过，我无法确定。

为什么不把两个平铺的带有按钮的测试页面放在一起并尝试一下。那应该会给你一个明确的答案。

# java - Java 对 WPF 的回答是什么？

> ID：285147
> 
> 赞同：45
> 
> 时间：2008-11-12T20:01:39.843
> 
> 标签：java, .net, wpf

目前我主要是一个 .Net 人，但我最近一直在玩 Java —— 探索那里有什么。

现在我正在寻找 WPF 的 Java 等价物。我知道我可以在那里找到一两个 OpenGL 库，但这并不像 WPF 系统那样丰富或简单。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2008-11-12T20:10:06.877

我认为 JavaFX、Swing、Java2D 和 Java 的基于浏览器的 JRE 的组合构成了 WPF 提供的解决方案：

*   JavaFX 应用程序（实际上是任何 Java 应用程序）可以在浏览器或桌面上运行
*   JavaFX 提供高端视频支持
*   JavaFX 提供脚本动画和视觉特效
*   Swing 提供 UI 能力，可以在 Java 和 JavaFX 中使用
*   Java2D 为所有绘图任务（包括 Swing）提供基础，利用硬件加速和 DirectX 支持
*   桌面或浏览器上的 JRE 使 Java 应用程序能够部署到多个环境（包括其他屏幕，如机顶盒或电话）

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2013-01-16T19:08:02.190

我编写了 Aqua、Macintosh Quick Draw、Windows GDI 和 GDI+、Qt 和 .NET Winforms，而 WPF 是迄今为止我使用过的最复杂的 API。尽管它有一个相当强大的功能集，比之前的技术（如 swing）要好，但它无法与 WPF 匹敌。它解决了困扰图形编程的一些主要问题。如果您来自 HTML/JS 世界，它很容易学习，但如果您来自传统图形编程世界，那么这是一个重大的范式转变。无论如何，它比 CSS/HTML/JS 更容易学习。它与困扰其他图形编程环境的遗留概念彻底决裂。

WPF 的最大优势在于它独立于分辨率。它可以在几乎没有修改的情况下跨设备扩展。只需很少的工作即可获取绘图的屏幕版本并将其输出到高分辨率打印机而不会​​丢失分辨率。

它还支持事件触发。UI 元素可以响应其他 UI 元素的事件或您的应用程序代码，从而使动态界面成为可能。它使您的代码与 UI 分离变得很容易，即使是 HTML/JS 也无法实现。元素可以广播和监听事件并做出相应的响应。

另一个优势是其高度面向对象和声明能力的 API。使用 XAML，您只需几行代码即可轻松快速高效地构建工作界面。与 HTML/JS 不同，它更容易学习，而且它的输出更加可预测和高效。您甚至可以完全在代码中对 WPF 进行编程，但这通常不值得轻微的性能提升。更好的方法是将 Xaml 编译成 .NET 代码。

此外，与 JavaFX 相比，WPF 可用的工具非常广泛。有很多工具，包括可用的 Expression Blend。还有许多工具可以将矢量图形格式（如 SVG 和 Adob​​e Illustrator）转换为 XAML。现在，设计师和程序员可以以以前很难做到的方式在桌面出版上进行协作。

总之，WPF 是如此全面，以至于 Mono 团队选择不将其移植到 Mono 代码库。他们声称要完全实现一个合理的功能集需要很多年。如果存在 WPF 的 Mono 兼容版本，它将使 .NET 成为事实上的跨平台应用程序框架。事实上，它甚至可能取代 HTML/CSS，因为它更强大，更容易理解。不幸的是，微软没有看到支持跨平台的 WPF 的商业案例。这就是 SilverLight/WPF 输给 HTML5/JS 的原因。由于这个错误，他们现在不仅不得不将 Web 和桌面的一部分交给 HTML 5/JS。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2010-09-03T16:50:00.547

功能方面的 WPF 比任何 JavaFX、Swing、AWT 或 Java2D 都更全面。毕竟，这就是设计目标，将与演示相关的所有内容都放在一个库中。在性能方面，它们大致相同，除了 Java 是一个[饥饿的猪的内存使用情况](http://www.codeproject.com/KB/dotnet/RuntimePerformance.aspx)

# ruby-on-rails - 我的非模型/非控制器代码应该放在哪里？

> ID：285148
> 
> 赞同：13
> 
> 时间：2008-11-12T20:02:11.043
> 
> 标签：ruby-on-rails, ruby, rake

我编写了一个遵循常规目录结构的 Rails 应用程序（模型中的模型代码，控制器中的控制器代码）。

但我现在正在开发一项新功能，为此我编写了一些（我称之为）“服务”代码。
新功能是将一些数据导入系统，目前导入是两个类，但可以扩展到更多。

我不相信新代码属于模型，因为它没有对任何对象进行建模（它也没有与任何单个对象直接相关。我当然不认为它属于控制器，因为它不是表示逻辑。

所以，我创建了一个“app/services”目录并把它放在那里。我还创建了一个“测试/服务”目录，我在其中放置了我的测试。

我认为一切都很好，但是当我运行“rake:test”或“autotest”时，我的新服务测试没有运行。
现在我希望有一种方法可以让 rake 捡起它们，但这是我做错了什么的警告标志吗？
代码是否应该存在其他地方，或者我是否以某种方式没有以“Rails 方式”做事？

通常，每当我遇到这样的问题之前，我通常会发现 rails 已经有了解决方案，但我不知道这个约定。这是其中一种情况吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-11-12T20:04:45.873

这就是“lib”文件夹的用途。

lib 文件夹位于自动查找的路径中，因此您可以拥有

```
class MyFoo
end 
```

进去`lib/my_foo.rb`，然后打电话

```
MyFoo.new 
```

从控制器将加载代码，而您不需要`require 'my_foo'`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-12T20:07:20.237

./lib 绝对是个好去处。

另一个放置它的地方是 config 下的 initializers 目录，这取决于你在做什么。你也可以考虑把整个东西做成一个插件，但如果它是少量的功能，它可能不值得。

# javascript - 访问 jQuery Datapicker 中的选项

> ID：285154
> 
> 赞同：2
> 
> 时间：2008-11-12T20:05:03.643
> 
> 标签：javascript, jquery

如何访问我在 jQuery Datepicker 中设置的选项？

```
$("#testDatePicker").datepicker({
    minDate: new Date(2005, 0, 26),
    showOn: 'button',
    buttonImage: 'js/themes/default/images/calendar.gif',
    buttonImageOnly: true
    });
var minDate = $("#testDatePicker").?????; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-12T20:46:08.613

将选项存储在命名变量而不是匿名对象中怎么样？

```
var dpOptions = {minDate: new Date(2005, 0, 26), ...};
$('#testDatePicker').datepicker(dpOptions);
.
.
.
var minDate = dpOptions.minDate; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-13T17:25:40.353

如果您没有足够的 @mausch 解决方案，则设置存储在这里：

```
 $.data($('#testDatePicker')[0], 'datepicker').settings 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-12T20:08:53.353

我会看一下代码。我看过的大多数插件都有一个选项或配置变量，它们会根据您传入的内容进行扩展。

您可以快速检查并尝试执行类似 $.datepicker.buttonImageOnly = false; 的操作。然后看看这是否真的改变了什么。

当然，这可能行不通。我没看过插件。我只是根据我使用过的插件的典型行为（tablesorter 等）进行操作

# sql - 如何在 PL/SQL 中查询会话变量的状态？

> ID：285162
> 
> 赞同：1
> 
> 时间：2008-11-12T20:07:16.057
> 
> 标签：sql, oracle, plsql

我看到在 PL/SQL 中，可以在会话生命周期的剩余时间内设置特定变量的会话状态。例如：

```
ALTER SESSION SET CURRENT_SCHEMA=<schema> 
```

如何查询此架构的当前状态，以便在执行其他一些语句后恢复到它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-12T20:11:00.683

```
SELECT SYS_CONTEXT( 'USERENV', 'CURRENT_SCHEMA' ) FROM dual; 
```

# sql-server - 在 SQL 2000 中打开一个 .BAS DTS 包？

> ID：285170
> 
> 赞同：3
> 
> 时间：2008-11-12T20:08:10.873
> 
> 标签：sql-server, dts

您可以将 SQL Server 2000 DTS 包保存为 VB .BAS 文件。是否可以在 SQL Server 企业管理器（或其他方式）中打开 .BAS 文件以将 DTS 包添加到服务器？最初，SQL Server 似乎只允许您导入 .DTS 文件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-27T16:16:14.620

实际上，这是可能的，尽管它很繁琐：

[运行另存为 Visual Basic 文件的 DTS 包](http://msdn.microsoft.com/en-us/library/aa176248(SQL.80).aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-12T20:19:34.220

不，这是不可能的。保存到 .BAS 文件仅是一种方式。但是，您可以使用 VB6 编译该文件并将其作为来自另一个 DTS 包的可执行文件运行。您也可以修改它，也许添加 CL 选项以将其用作独立程序。

编辑：Ben（下）[在 MSDN 网站上](http://msdn.microsoft.com/en-us/library/aa176248)找到了一个描述此过程的链接。+1。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-10-28T16:00:44.993

是的，有可能，请按照先前答案中的链接进行操作。只是另一件小事...当您取消注释 goPackage.SaveToSQLServer 时，您可以使用 flags 参数指定受信任的连接，如下所示：

goPackage.SaveToSQLServer "(本地)", , , DTSSQLStgFlag_UseTrustedConnection

这样您就不必在代码中公开密码。

# asp.net - 你能买到的最像 Word 的 ASP.NET 自定义控件是什么？

> ID：285171
> 
> 赞同：2
> 
> 时间：2008-11-12T20:08:51.920
> 
> 标签：asp.net

我们希望在 ASP.NET 应用程序中实现富文本框，并且我们的要求是针对使用 Microsoft Word 的“跟踪更改”功能的。我们在 Telerik 的 RadEditor 中找到的最接近的东西。这是一个很好的控件，它有一个“跟踪更改”按钮，让您能够跟踪从框中的文本到现在的更改。它不允许您跟踪对前两个版本的更改。

我们过去使用过 CVSWeb，显示效果不是很好，但它确实能够（在网页中）区分两个不同版本的文本（在本例中为源代码）。

有没有人有任何经验或知道任何基于 Web 的差异工具可以很好地与 Web 中的富文本编辑器配合使用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-12T20:41:57.950

我本来打算推荐 Telerik，但显然你已经看到了。另一个不错的（至少在流畅的 UI 方面）是 ComponnentOne。

[http://www.componentone.com/SuperProducts/WebEditorASPNET/](http://www.componentone.com/SuperProducts/WebEditorASPNET/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-12T20:10:26.423

您也许可以将[FreeTextBox](http://freetextbox.com/)之类的东西破解到 wiki 后端。这将提供一些等效的功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-12T21:09:34.620

你不会想使用freetextbox。

我们已经在工作中使用了它，并且对该组件的支持很少。另外，还有一堆标签索引问题。我一直在推动我的公司使用 Telerik（我在家里使用）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-03-23T17:41:12.400

ComponentOne 有一个新的[富文本编辑器，带有用于 ASP.NET 的 Ribbon UI](http://demo.componentone.com/aspnet/controlexplorer/C1Editor/SpellChecking.aspx)。它非常适合在 CMS 应用程序中使用。它还具有内置的拼写检查和 DOM 选择功能。

# java - 如何在 Java 中从另一个构造函数调用一个构造函数？

> ID：285177
> 
> 赞同：2513
> 
> 时间：2008-11-12T20:10:19.577
> 
> 标签：java, constructor

是否可以从另一个（在同一个类中，而不是从子类中）调用构造函数？如果是怎么办？调用另一个构造函数的最佳方法是什么（如果有几种方法可以做到）？

* * *

## 回答 #1

> 赞同：3249
> 
> 时间：2008-11-12T20:12:14.610

是的，有可能：

```
public class Foo {
    private int x;

    public Foo() {
        this(1);
    }

    public Foo(int x) {
        this.x = x;
    }
} 
```

要链接到特定的超类构造函数而不是同一类中的构造函数，请使用`super`代替`this`. 请注意，**您只能链接到一个构造函数**，并且**它必须是构造函数主体中的第一条语句**。

另请参阅[此相关问题](https://stackoverflow.com/questions/284896)，该问题与 C# 有关，但适用相同的原则。

* * *

## 回答 #2

> 赞同：278
> 
> 时间：2008-11-12T20:13:22.893

使用`this(args)`. 首选模式是从最小的构造函数到最大的构造函数。

```
public class Cons {

    public Cons() {
        // A no arguments constructor that sends default values to the largest
        this(madeUpArg1Value,madeUpArg2Value,madeUpArg3Value);
    }

    public Cons(int arg1, int arg2) {
       // An example of a partial constructor that uses the passed in arguments
        // and sends a hidden default value to the largest
        this(arg1,arg2, madeUpArg3Value);
    }

    // Largest constructor that does the work
    public Cons(int arg1, int arg2, int arg3) {
        this.arg1 = arg1;
        this.arg2 = arg2;
        this.arg3 = arg3;
    }
} 
```

You can also use a more recently advocated approach of valueOf or just "of":

```
public class Cons {
    public static Cons newCons(int arg1,...) {
        // This function is commonly called valueOf, like Integer.valueOf(..)
        // More recently called "of", like EnumSet.of(..)
        Cons c = new Cons(...);
        c.setArg1(....);
        return c;
    }
} 
```

To call a super class, use `super(someValue)`. The call to super must be the first call in the constructor or you will get a compiler error.

* * *

## 回答 #3

> 赞同：232
> 
> 时间：2013-03-11T20:33:12.427

[*Note: I just want to add one aspect, which I did not see in the other answers: how to overcome limitations of the requirement that this() has to be on the first line).*]

In Java another constructor of the same class can be called from a constructor via `this()`. Note however that `this` has to be on the first line.

```
public class MyClass {

  public MyClass(double argument1, double argument2) {
    this(argument1, argument2, 0.0);
  }

  public MyClass(double argument1, double argument2, double argument3) {
    this.argument1 = argument1;
    this.argument2 = argument2;
    this.argument3 = argument3;
  }
} 
```

That `this` has to appear on the first line looks like a big limitation, but you can construct the arguments of other constructors via static methods. For example:

```
public class MyClass {

  public MyClass(double argument1, double argument2) {
    this(argument1, argument2, getDefaultArg3(argument1, argument2));
  }

  public MyClass(double argument1, double argument2, double argument3) {
    this.argument1 = argument1;
    this.argument2 = argument2;
    this.argument3 = argument3;
  }

  private static double getDefaultArg3(double argument1, double argument2) {
    double argument3 = 0;

    // Calculate argument3 here if you like.

    return argument3;

  }

} 
```

* * *

## 回答 #4

> 赞同：41
> 
> 时间：2013-04-23T23:12:24.103

When I need to call another constructor from inside the code (not on the first line), I usually use a helper method like this:

```
class MyClass {
   int field;

   MyClass() {
      init(0);
   } 
   MyClass(int value) {
      if (value<0) {
          init(0);
      } 
      else { 
          init(value);
      }
   }
   void init(int x) {
      field = x;
   }
} 
```

But most often I try to do it the other way around by calling the more complex constructors from the simpler ones on the first line, to the extent possible. For the above example

```
class MyClass {
   int field;

   MyClass(int value) {
      if (value<0)
         field = 0;
      else
         field = value;
   }
   MyClass() {
      this(0);
   }
} 
```

* * *

## 回答 #5

> 赞同：30
> 
> 时间：2015-05-26T15:09:17.273

Within a constructor, you can use the `this` keyword to invoke another constructor in the same class. Doing so is called an **explicit constructor invocation**.

Here's another Rectangle class, with a different implementation from the one in the Objects section.

```
public class Rectangle {
    private int x, y;
    private int width, height;

    public Rectangle() {
        this(1, 1);
    }
    public Rectangle(int width, int height) {
        this( 0,0,width, height);
    }
    public Rectangle(int x, int y, int width, int height) {
        this.x = x;
        this.y = y;
        this.width = width;
        this.height = height;
    }

} 
```

This class contains a set of constructors. Each constructor initializes some or all of the rectangle's member variables.

* * *

## 回答 #6

> 赞同：18
> 
> 时间：2015-05-07T22:52:03.147

As everybody already have said, you use `this(…)`, which is called an *explicit constructor invocation*.

**However, keep in mind that** within such an explicit constructor invocation statement **you may not refer to**

*   any *instance variables* or
*   any *instance methods* or
*   any *inner classes* declared in this class or any superclass, or
*   `this` or
*   `super`.

As stated in JLS (§8.8.7.1).

* * *

## 回答 #7

> 赞同：14
> 
> 时间：2016-11-16T16:14:17.193

Yes, any number of constructors can be present in a class and they can be called by another constructor using `this()` [Please do not confuse `this()` constructor call with `this` keyword]. `this()` or `this(args)` should be the first line in the constructor.

Example:

```
Class Test {
    Test() {
        this(10); // calls the constructor with integer args, Test(int a)
    }
    Test(int a) {
        this(10.5); // call the constructor with double arg, Test(double a)
    }
    Test(double a) {
        System.out.println("I am a double arg constructor");
    }
} 
```

This is known as constructor overloading.
Please note that for constructor, only overloading concept is applicable and not inheritance or overriding.

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2017-01-07T13:21:18.490

Yes it is possible to call one constructor from another. But there is a rule to it. If a call is made from one constructor to another, then

> *that new constructor call must be the first statement in the current constructor*

```
public class Product {
     private int productId;
     private String productName;
     private double productPrice;
     private String category;

    public Product(int id, String name) {
        this(id,name,1.0);
    }

    public Product(int id, String name, double price) {
        this(id,name,price,"DEFAULT");
    }

    public Product(int id,String name,double price, String category){
        this.productId=id;
        this.productName=name;
        this.productPrice=price;
        this.category=category;
    }
} 
```

So, something like below will not work.

```
public Product(int id, String name, double price) {
    System.out.println("Calling constructor with price");
    this(id,name,price,"DEFAULT");
} 
```

Also, in the case of inheritance, when sub-class's object is created, the super class constructor is first called.

```
public class SuperClass {
    public SuperClass() {
       System.out.println("Inside super class constructor");
    }
}
public class SubClass extends SuperClass {
    public SubClass () {
       //Even if we do not add, Java adds the call to super class's constructor like 
       // super();
       System.out.println("Inside sub class constructor");
    }
} 
```

Thus, in this case also another constructor call is first declared before any other statements.

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2016-11-21T13:14:34.080

**I will tell you an easy way**

There are **two** types of constructors:

1.  **Default constructor**
2.  **Parameterized constructor**

I will explain in one Example

```
class ConstructorDemo 
{
      ConstructorDemo()//Default Constructor
      {
         System.out.println("D.constructor ");
      }

      ConstructorDemo(int k)//Parameterized constructor
      {
         this();//-------------(1)
         System.out.println("P.Constructor ="+k);       
      }

      public static void main(String[] args) 
      {
         //this(); error because "must be first statement in constructor
         new ConstructorDemo();//-------(2)
         ConstructorDemo g=new ConstructorDemo(3);---(3)    
       }
   } 
```

In the above example I showed 3 types of calling

1.  this() call to this must be first statement in constructor
2.  This is Name less Object. this automatically calls the default constructor. 3.This calls the Parameterized constructor.

Note: **this must be the first statement in the constructor.**

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2015-11-27T19:01:24.790

You can a constructor from another constructor of same class by using "this" keyword. Example -

```
class This1
{
    This1()
    {
        this("Hello");
        System.out.println("Default constructor..");
    }
    This1(int a)
    {
        this();
        System.out.println("int as arg constructor.."); 
    }
    This1(String s)
    {
        System.out.println("string as arg constructor..");  
    }

    public static void main(String args[])
    {
        new This1(100);
    }
} 
```

Output - string as arg constructor.. Default constructor.. int as arg constructor..

* * *

## 回答 #11

> 赞同：8
> 
> 时间：2017-03-03T09:27:30.993

Calling constructor from another constructor

```
class MyConstructorDemo extends ConstructorDemo
{
    MyConstructorDemo()
    {
        this("calling another constructor");
    }
    MyConstructorDemo(String arg)
    {
        System.out.print("This is passed String by another constructor :"+arg);
    }
} 
```

Also you can call parent constructor by using `super()` call

* * *

## 回答 #12

> 赞同：8
> 
> 时间：2017-11-21T14:03:51.003

Pretty simple

```
public class SomeClass{

    private int number;
    private String someString;

    public SomeClass(){
        number = 0;
        someString = new String();
    }

    public SomeClass(int number){
        this(); //set the class to 0
        this.setNumber(number); 
    }

    public SomeClass(int number, String someString){
        this(number); //call public SomeClass( int number )
        this.setString(someString);
    }

    public void setNumber(int number){
        this.number = number;
    }
    public void setString(String someString){
        this.someString = someString;
    }
    //.... add some accessors
} 
```

now here is some small extra credit:

```
public SomeOtherClass extends SomeClass {
    public SomeOtherClass(int number, String someString){
         super(number, someString); //calls public SomeClass(int number, String someString)
    }
    //.... Some other code.
} 
```

Hope this helps.

* * *

## 回答 #13

> 赞同：8
> 
> 时间：2021-01-16T02:12:55.367

Using this keyword we can call one constructor in another constructor within same class.

Example :-

```
 public class Example {

      private String name;

      public Example() {
          this("Mahesh");
      }

      public Example(String name) {
          this.name = name;
      }

 } 
```

* * *

## 回答 #14

> 赞同：7
> 
> 时间：2016-09-13T05:48:26.047

Yes it is possible to call one constructor from another with use of `this()`

```
class Example{
   private int a = 1;
   Example(){
        this(5); //here another constructor called based on constructor argument
        System.out.println("number a is "+a);   
   }
   Example(int b){
        System.out.println("number b is "+b);
   } 
```

* * *

## 回答 #15

> 赞同：6
> 
> 时间：2017-03-14T23:53:16.330

The keyword ***this*** can be used to call a constructor from a constructor, when writing several constructor for a class, there are times when you'd like to call one constructor from another to avoid duplicate code.

Bellow is a link that I explain other topic about constructor and getters() and setters() and I used a class with two constructors. I hope the explanations and examples help you.

[Setter methods or constructors](https://stackoverflow.com/questions/19359548/setter-methods-or-constructors/42798426#42798426)

* * *

## 回答 #16

> 赞同：6
> 
> 时间：2017-11-13T23:01:22.520

There are design patterns that cover the need for complex construction - if it can't be done succinctly, create a factory method or a factory class.

With the latest java and the addition of lambdas, it is easy to create a constructor which can accept any initialization code you desire.

```
class LambdaInitedClass {

   public LamdaInitedClass(Consumer<LambdaInitedClass> init) {
       init.accept(this);
   }
} 
```

Call it with...

```
 new LambdaInitedClass(l -> { // init l any way you want }); 
```

* * *

## 回答 #17

> 赞同：4
> 
> 时间：2018-01-24T05:45:57.280

I know there are so many examples of this question but what I found I am putting here to share my Idea. there are two ways to chain constructor. In Same class you can use this keyword. in Inheritance, you need to use super keyword.

```
 import java.util.*;
    import java.lang.*;

    class Test
    {  
        public static void main(String args[])
        {
            Dog d = new Dog(); // Both Calling Same Constructor of Parent Class i.e. 0 args Constructor.
            Dog cs = new Dog("Bite"); // Both Calling Same Constructor of Parent Class i.e. 0 args Constructor.

            // You need to Explicitly tell the java compiler to use Argument constructor so you need to use "super" key word
            System.out.println("------------------------------");
            Cat c = new Cat();
            Cat caty = new Cat("10");

            System.out.println("------------------------------");
            // Self s = new Self();
            Self ss = new Self("self");
        }
    }

    class Animal
    {
        String i;

        public Animal()
        {
            i = "10";
            System.out.println("Animal Constructor :" +i);
        }
        public Animal(String h)
        {
            i = "20";
            System.out.println("Animal Constructor Habit :"+ i);
        }
    }

    class Dog extends Animal
    {
        public Dog()
        {
            System.out.println("Dog Constructor");
        }
        public Dog(String h)
        {
            System.out.println("Dog Constructor with habit");
        }
    }

    class Cat extends Animal
    {
        public Cat()
        {
            System.out.println("Cat Constructor");
        }
        public Cat(String i)
        {
            super(i); // Calling Super Class Paremetrize Constructor.
            System.out.println("Cat Constructor with habit");
        }
    }

    class Self
    {
        public Self()
        {
            System.out.println("Self Constructor");
        }
        public Self(String h)
        {
            this(); // Explicitly calling 0 args constructor. 
            System.out.println("Slef Constructor with value");
        }
    } 
```

* * *

## 回答 #18

> 赞同：4
> 
> 时间：2018-06-06T19:36:32.643

It is called Telescoping Constructor anti-pattern or constructor chaining. Yes, you can definitely do. I see many examples above and I want to add by saying that if you know that you need only two or three constructor, it might be ok. But if you need more, please try to use different design pattern like Builder pattern. As for example:

```
 public Omar(){};
 public Omar(a){};
 public Omar(a,b){};
 public Omar(a,b,c){};
 public Omar(a,b,c,d){};
 ... 
```

You may need more. Builder pattern would be a great solution in this case. Here is an article, it might be helpful [https://medium.com/@modestofiguereo/design-patterns-2-the-builder-pattern-and-the-telescoping-constructor-anti-pattern-60a33de7522e](https://medium.com/@modestofiguereo/design-patterns-2-the-builder-pattern-and-the-telescoping-constructor-anti-pattern-60a33de7522e)

* * *

## 回答 #19

> 赞同：4
> 
> 时间：2018-07-29T01:14:04.977

You can call another constructor via the [`this(...)`](https://docs.oracle.com/javase/tutorial/java/javaOO/thiskey.html) keyword (when you need to call a constructor from the same class) or the [`super(...)`](https://docs.oracle.com/javase/tutorial/java/IandI/super.html) keyword (when you need to call a constructor from a superclass).

However, such a call must be the **first** statement of your constructor. To **overcome** this limitation, use [this answer](https://stackoverflow.com/a/51571736/9772691).

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2019-08-01T17:35:25.997

Yes, you can call constructors from another constructor. For example:

```
public class Animal {
    private int animalType;

    public Animal() {
        this(1); //here this(1) internally make call to Animal(1);
    }

    public Animal(int animalType) {
        this.animalType = animalType;
    }
} 
```

you can also read in details from [Constructor Chaining in Java](https://beginnersbook.com/2013/12/java-constructor-chaining-with-example/)

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2019-04-09T00:30:59.357

Originally from an anser by Mirko Klemm, slightly modified to address the question:

Just for completeness: There is also the [Instance initialization block](https://stackoverflow.com/questions/3987428/what-is-an-initialization-block) that gets executed always and before any other constructor is called. It consists simply of a block of statements "{ ... }" somewhere in the body of your class definition. You can even have more than one. You can't call them, but they're like "shared constructor" code if you want to reuse some code across constructors, similar to calling methods.

So in your case

```
{ 
  System.out.println("this is shared constructor code executed before the constructor");
  field1 = 3;
} 
```

There is also a "static" version of this to initialize static members: "static { ... }"

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2019-06-19T08:38:36.010

I prefer this way:

```
 class User {
        private long id;
        private String username;
        private int imageRes;

    public User() {
        init(defaultID,defaultUsername,defaultRes);
    }
    public User(String username) {
        init(defaultID,username, defaultRes());
    }

    public User(String username, int imageRes) {
        init(defaultID,username, imageRes);
    }

    public User(long id, String username, int imageRes) {
        init(id,username, imageRes);

    }

    private void init(long id, String username, int imageRes) {
        this.id=id;
        this.username = username;
        this.imageRes = imageRes;
    }
} 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2021-07-07T18:04:35.730

It is called constructor chaining. Constructor chaining is the process of calling one constructor from another constructor with respect to the current object. Constructor chaining can be done in two ways:

1.Within the same class: It can be done using this() keyword for constructors in the same class 2.From base class: by using the super() keyword to call a constructor from the base class.

# database - 在 .NET 2.0/3.5 中显示表格结果的最快方法

> ID：285197
> 
> 赞同：3
> 
> 时间：2008-11-12T20:19:03.583
> 
> 标签：database, gridview, datagridview

我有一个要查看数据的数据库表（sql server 2008），显示这些数据的最快方法是什么？

（如果它可以有分页，那将是完美的）。

是gridview还是？

查询：从 testData 中选择 *

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-12T20:20:17.357

如果您使用的是 .NET 3.5，则可以使用 ASP.NET 动态数据：

[http://www.asp.net/dynamicdata/](http://www.asp.net/dynamicdata/)

希望这可以帮助！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-12T20:20:50.787

通过 ADO.NET 将您的数据放入 DataSet 或 DataTable。

然后：

```
gridview.DataSource = yourDataTable;
gridview.DataBind(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-12T20:38:35.167

如果它是一个 web 应用程序，gridview 控制并使用缓存对象来保存数据集......每次连接到数据库都很耗时......

优点：性能缺点：除非您有服务器内存来处理它，否则无法处理大型表。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-12T20:22:00.177

使用 LinqToSql 并将结果绑定到网格视图。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-12T20:25:52.103

Gridview 将是一个完美的解决方案

您可以仅通过属性 AllowPaging="true" PageSize="##" AllowSorting="true" 进行分页和排序，如果您想要所有数据而不仅仅是特定行，您可以执行 AutoGenerateColumns="true"

# c++ - Boost Spirit可以用来解析字节流数据吗？

> ID：285200
> 
> 赞同：9
> 
> 时间：2008-11-12T20:19:47.187
> 
> 标签：c++, parsing, stream, boost-spirit

Spirit（Boost C++ 库的一部分）可以用来解析来自流的二进制数据吗？例如，它能否用于将来自套接字的数据解析为结构、字节和单个位标志？谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-12T22:30:54.097

Boost Spirit 允许使用带有[模板元编程](http://en.wikipedia.org/wiki/Template_metaprogramming)[的 Extended Backus-Naur Form (EBNF)](http://en.wikipedia.org/wiki/Extended_Backus%E2%80%93Naur_form)语法来定义解析器。它非常灵活，在解析过程的所有阶段都使用抽象类，可以自定义。为了处理二进制数据流，您需要实现自定义扫描器类，因为默认类型是为文本输入量身定制的。您可以在[Spirit 用户指南](http://spirit.sourceforge.net/distrib/spirit_1_8_5/libs/spirit/index.html)[的扫描器和解析](http://spirit.sourceforge.net/distrib/spirit_1_8_5/libs/spirit/doc/scanner.html)部分进一步阅读。

在我看来，二进制数据流最好使用手动序列化代码来处理。Spirit 更适合格式良好的语法，例如标记或脚本语言。例如，EBNF 中提供[了 Lua 的完整语法。](http://www.lua.org/manual/5.1/manual.html#8)因此，使用 Spirit 构建自定义解析器可能是有意义的。另一方面，带有同步字节和 CRC 括号消息的专有串行数据链路将需要更多的工作来定义 EBNF，如果它甚至存在[上下文无关语法的话。](http://en.wikipedia.org/wiki/Context-free_grammar)

**附录**

[最新版本的 Boost Spirit 包括处理二进制数据的功能。](http://www.boost.org/doc/libs/1_41_0/libs/spirit/doc/html/spirit/qi/reference/binary.html)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-11-19T16:09:24.747

Spirit2 刚刚发布，具有解析二进制文件的功能。[看看这个](http://www.boost.org/doc/libs/1_41_0/libs/spirit/doc/html/spirit/qi/reference/binary.html)。

# .net - 验证电子邮件地址组件或服务 - .NET

> ID：285205
> 
> 赞同：2
> 
> 时间：2008-11-12T20:21:51.300
> 
> 标签：.net, validation, email

我们希望通过首先防止虚假电子邮件进入来改进我们的营销电子邮件列表。我们想确认一个电子邮件地址存在（并且该电子邮件地址实际上有一个邮箱）。

有谁知道验证电子邮件地址的任何服务或组件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-12T20:27:45.437

自己做这件事很简单。

1.  创建一个网络表单，用户可以在其中输入他们的电子邮件地址。您可以使用验证码保护它，以防止机器人攻击它。

2.  提交时，将电子邮件地址连同 GUID、DateTime 时间戳和 IsActivated 位一起保存到数据库。GUID 唯一标识此订阅。时间戳表示必须确认电子邮件地址的到期时间。

3.  向其中包含 URL 的电子邮件地址发送电子邮件。

    [http://www.example.com/validate.aspx?g=GUID-GOES-HERE](http://www.example.com/validate.aspx?g=GUID-GOES-HERE)

4.  如果用户在其收件箱中收到电子邮件并在该 GUID/电子邮件的时间戳过期之前单击验证链接，那么您将激活他们的帐户。

5.  您可以定期执行一项作业，从表中删除激活窗口已过期的从未激活过的行。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-12T20:29:55.137

如果不向其发送消息，您就无法真正验证电子邮件地址，甚至可能不会（您可能会或可能不会收到错误响应或错误消息）。

如果您要发送一封电子邮件来验证它，您可能会激怒您的收件人，除非您在该电子邮件中增加价值。

这样做的正常方法是向您提供的地址发送一封电子邮件，其中包含一个唯一链接，当用户访问它时，确认用户已收到电子邮件并且（可能）将来真的想要您的电子邮件。这是您的意思，还是您真的想在不向用户发送电子邮件的情况下验证消息？

如果是，那么有任意数量的列表管理器可以做到这一点（例如，Gnu mailman）。搜索“电子邮件列表管理器”会显示更多信息，包括将为您管理列表的公司。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-12T20:51:57.340

这是一篇关于我们想要做什么的文章：http: [//www.coveryourasp.com/ValidateEmail.asp](http://www.coveryourasp.com/ValidateEmail.asp)

我们想做 DNS 验证和 SMTP 验证。我们已经有了简单的验证。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-12T20:26:43.240

以下正则表达式是一个示例，说明如何验证电子邮件地址是否采用正确的一般格式：

```
(\w+@[a-zA-Z_]+?\.[a-zA-Z]{2,6}) 
```

出于安全原因，很少有电子邮件服务器提供远程验证邮箱是否存在的功能，因此服务不太可能以任何可靠性提供此信息。

希望这可以帮助！

亚当

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-12T21:11:35.037

我找到了这两个组件：

*   Hexillion - [http://hexillion.com/email_validation/](http://hexillion.com/email_validation/)
*   来自 Advanced Intellect 的 aspNetMx - [http://www.advancedintellect.com/product.aspx?mx](http://www.advancedintellect.com/product.aspx?mx)

我们很可能会选择其中之一。可能与 Advanced Intellect 的 aspNetMx 一起使用（至少那是我现在倾向于的地方）。[http://www.aspnetmx.com/demo.aspx](http://www.aspnetmx.com/demo.aspx)上的示例测试适用于我的电子邮件地址（有效和无效）。

并且可能只使用 DNS 验证而不是 SMTP 验证，因为一些评论表明 SMTP 验证不是 100% 准确的，而且 SMTP 验证发生的延迟量也是如此。

-杰夫

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-05-08T22:27:16.927

[从UEmail Validator](http://www.componentsoft.net/component/emailvalidator.net/)查看此代码示例：

 `````
   // Create a new instance of the EmailValidator class.
   EmailValidator em = new EmailValidator();
   em.MessageLogging += em_MessageLogging;
   em.EmailValidated += em_EmailValidationCompleted;
   try
   {
       string[] list = new string[3] { "test1@testdomain.com", "test2@testdomain.com", "test3@testdomain.com" };
       em.ValidateEmails(list);
   }
   catch (EmailValidatorException exc2)
   {
       Console.WriteLine("EmailValidatorException: " + exc2.Message);
   }

````  `* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2008-11-12T20:33:10.090

有几个级别的电子邮件验证，我有资源来完成所有这些。但是，我鄙视您的业务，并且永远不会与您分享...

澄清一下——我并不鄙视你，杰夫……只是你的业务范围。

# mootools - Mootools 向后兼容性有多好？

> ID：285211
> 
> 赞同：0
> 
> 时间：2008-11-12T20:23:16.930
> 
> 标签：mootools, backwards-compatibility

我的一位同事对 Mootools 向后兼容有疑问，我想知道是否有其他人注意到这一点？他说他的主要问题是在尝试使用旧版本中提供的拖放功能时。我自己从来没有真正研究过它，但是当我在为 JQuery 提出同样的问题时提到它时，其他人似乎没有同样的问题。

那么 Stackoverflow 你有没有注意到 Mootools 向后兼容性的问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-19T21:50:45.027

Mootools 1.2 不完全向后兼容 Mootools 1.11。您可以在[Mootools Wiki](http://github.com/mootools/mootools-core/wikis/conversion-from-1-11-to-1-2)中找到有关更改内容的一些信息，我还发现[Siafoo 关于升级到 1.2 的文章](http://www.siafoo.net/article/62)在过去非常有用。

升级旧脚本通常是查找已弃用的方法引用并用新的方法替换它们；很简单，只是轻微的疼痛。

# internet-explorer - Internet Explorer 控件使用 IE7 自己的 ClearType 和字体大小设置，我可以覆盖它们吗？

> ID：285214
> 
> 赞同：2
> 
> 时间：2008-11-12T20:23:49.173
> 
> 标签：internet-explorer, internet-explorer-7, controls, cleartype, embedded-control

我正在将 IE 控件嵌入到我的 C++ 应用程序中。问题是，尽管在系统范围内禁用了 ClearType，但 IE7 有自己的单独设置，除非我也特别禁用它，否则 IE 控件内的文本将被抗锯齿，而应用程序的其余部分则不会。

IE7 的字体大小设置也是如此。

相应地设置 IE7 对我来说不是问题，但它会影响我的应用程序用户的体验。IE控件的cleartype使用和字体大小可以通过程序控制吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-12T20:33:21.963

IE 控件使用用户设置，所以简短的回答是否定的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-12T23:32:07.920

根据文档，您可以在 OLE 客户端站点上实现 IDocHostUIHandler 并从 IDocHostUIHandler::GetOptionKeyPath 返回注册表路径。将使用此注册表路径中的设置而不是用户的设置。

参考：

*   [IDocHostUIHandler::GetOptionKeyPath 方法](http://msdn.microsoft.com/en-us/library/aa753258(VS.85).aspx)
*   [IDocHostUIHandler 接口](http://msdn.microsoft.com/en-us/library/aa753260(VS.85).aspx)

# python - 我可以使用哪些 Python 工具与网站的 API 交互？

> ID：285226
> 
> 赞同：6
> 
> 时间：2008-11-12T20:28:55.403
> 
> 标签：python, web-services, twitter

假设我想为 Twitter 之类的网站制作一个 python 脚本界面。

我会用什么来做到这一点？我习惯使用 bash 中的 curl/wget，但 Python 似乎更好用。什么是等价物？

（这不是从网络服务器运行的 Python，而是通过命令行在本地运行）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-12T21:27:20.840

对于 Twitter 之类的东西，您无需重新发明轮子，就可以为自己节省大量时间。尝试像[python-twitter](http://code.google.com/p/python-twitter/)这样的库。这样，您可以编写与 Twitter 接口的脚本，甚至是完整的应用程序，而不必关心实现细节。

如果你想推出自己的接口库，你将不得不熟悉[urllib](https://docs.python.org/library/urllib.html)并根据它们提供结果的格式，或者[lxml](http://lxml.de/)（或其他一些 xml 解析器）或[simplejson](http://undefined.org/python/#simplejson)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-12T20:42:01.460

Python 有 urllib2，它是用于打开 URL 的可扩展库

功能齐全且易于使用的库。

[https://docs.python.org/library/urllib2.html](https://docs.python.org/library/urllib2.html)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-12T20:36:57.057

我全心全意地推荐[mechanize](http://wwwsearch.sourceforge.net/mechanize/) for python。它完全是一个可编程的网络浏览器，您可以从 python 中使用它，它也可以处理表单和 cookie！它使任何类型的网站都变得轻而易举。

查看该链接上的示例，看看它可以做什么。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-12T20:35:12.613

Python 有一个非常好的 httplib 模块和一个 url 模块，它们一起可能会完成您需要的大部分功能（至少在 wget 功能方面）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-13T20:27:38.833

如果您习惯于处理 cURL，请考虑[PycURL](http://pycurl.sourceforge.net/)。

# sql-server - SQL Server 2000：查询分析器中的服务器内存/CPU 参数

> ID：285227
> 
> 赞同：1
> 
> 时间：2008-11-12T20:28:56.043
> 
> 标签：sql-server, memory, cpu-usage, query-analyzer

**SQL Server 2000：**有没有办法在查询分析器中找出服务器内存/CPU 参数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-19T03:04:58.810

从 sysperfinfo 中选择 *

它拥有 perfmon 所拥有的一切。还要确保通过运行 sp_configure 检查所有 sql 配置参数。还运行 xp_msver 显示了有关 sql server 实例的更多信息。

在这三个之间，我不知道您还想知道什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-12T23:25:36.733

从来没听说过。你得进去看看`perfmon`。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-11-12T23:29:43.650

尝试：

```
SELECT *
FROM sys.dm_os_sys_info 
```

对不起，那只是 2005 年的。在 2000 中，您可以`xp_cmdshell`通过外部工具或使用 COM 对象`sp_OA`。

# java - 如何在 Java 中将 UTF-8 转换为 US-Ascii

> ID：285228
> 
> 赞同：27
> 
> 时间：2008-11-12T20:29:03.390
> 
> 标签：java, utf-8, ascii

我们有一个系统，客户（主要是欧洲人）输入文本（UTF-8）必须分发到不同的系统，其中大多数接受 UTF-8，但现在我们还必须将文本分发到仅接受美国的美国系统-ASCII 7 位

所以现在我们需要将所有欧洲字符翻译成最近的 US-Ascii。是否有任何 Java 库可以帮助完成这项任务？

现在我们刚刚开始添加一个翻译表，其中 Å (瑞典语 AA)->A 等等，我们没有找到任何匹配输入字符的地方，我们将记录它并用问号替换并尝试在下一个版本中修复它，但它似乎效率很低，而且之前肯定有人做过类似的事情。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2010-03-09T22:51:51.323

您可以使用以下方法执行此操作（来自[本核心 Java 技术技术提示](http://web.archive.org/web/20070917051642/http://java.sun.com/mailers/techtips/corejava/2007/tt0207.html#1)中的 NFD 示例）：

```
public static String decompose(String s) {
    return java.text.Normalizer.normalize(s, java.text.Normalizer.Form.NFD).replaceAll("\\p{InCombiningDiacriticalMarks}+","");
} 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-11-12T20:44:26.450

uni2ascii程序是用 C[语言](http://billposer.org/Software/uni2ascii.html)编写的，但您可以毫不费力地将其转换为 Java。它包含一个大的近似值表（隐含在 switch-case 语句中）。

请注意，没有普遍接受的近似值：德国人希望您将 Ä 替换为 AE，芬兰人和瑞典人更喜欢 A。您的[Å](http://en.wikipedia.org/wiki/%C3%85)示例也不明显：瑞典人可能只是放弃戒指并使用 A，但丹麦人和瑞典人挪威人可能更喜欢历史上更正确的 AA。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-12T23:24:45.113

您可以将文本转换为规范化形式 D，而不是创建自己的表格，其中字符表示为基本字符加上变音符号（例如，“á”将替换为“a”，后跟一个组合的重音符号）。然后，您可以剥离所有不是 ASCII 字母的内容。

这些表仍然存在，但现在是来自 Unicode 标准的表。

您也可以尝试使用 NFKD 而不是 NFD，以捕获更多病例。

参考：

*   [http://unicode.org/reports/tr15/](http://unicode.org/reports/tr15/)
*   [http://www.siao2.com/2005/02/19/376617.aspx](http://www.siao2.com/2005/02/19/376617.aspx)
*   [http://www.siao2.com/2007/05/14/2629747.aspx](http://www.siao2.com/2007/05/14/2629747.aspx)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-11-02T19:04:40.447

响应[Joe Liversedge 给出的答案](https://stackoverflow.com/a/285890/892420)，引用的 Lucene [ISOLatin1AccentFilter](http://lucene.apache.org/core/2_2_0/api/index.html?org/apache/lucene/analysis/ISOLatin1AccentFilter.html) **不再存在**：

它已被[org.apache.lucene.analysis.ASCIIFoldingFilter](http://lucene.apache.org/core/old_versioned_docs/versions/3_0_0/api/all/org/apache/lucene/analysis/ASCIIFoldingFilter.html)取代：

> *此类将不在前 127 个 ASCII 字符（“基本拉丁语”Unicode 块）中的字母、数字和符号 Unicode 字符转换为它们的 ASCII 等效字符（如果存在）。转换以下 Unicode 块中的字符；但是，只有那些具有合理 ASCII 替代项的字符才会被转换。*

供参考 -

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-13T00:09:40.623

这在搜索应用程序中通常很有用。请参阅相应的 Lucene [ISOLatin1AccentFilter](http://lucene.apache.org/java/2_2_0/api/index.html?org/apache/lucene/analysis/ISOLatin1AccentFilter.html)实现。这并不是真正为插入随机本地实现而设计的，但可以解决问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-12T20:34:09.950

有一些内置函数可以做到这一点。涉及的主要类是[`CharsetEncoder`](http://java.sun.com/javase/6/docs/api/java/nio/charset/CharsetEncoder.html)，它是`nio`包的一部分。一种更简单的方法是[`String.getBytes(Charset)`](http://java.sun.com/javase/6/docs/api/java/lang/String.html#getBytes(java.nio.charset.Charset))可以发送到[`ByteArrayOutputStream`](http://java.sun.com/javase/6/docs/api/java/io/ByteArrayOutputStream.html).

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2011-06-24T18:02:27.363

新字符串（“½”.getBytes（“US-ASCII”））

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2011-03-15T13:58:11.027

这就是我使用的：

```
<?php
function remove_accent($str)  {
#   http://www.php.net/manual/en/function.preg-replace.php#96586
$a = array('À', 'Á', 'Â', 'Ã', 'Ä', 'Å', 'Æ', 'Ç', 'È', 'É', 'Ê', 'Ë', 'Ì', 'Í', 'Î', 'Ï', 'Ð', 'Ñ', 'Ò', 'Ó', 'Ô', 'Õ', 'Ö', 'Ø', 'Ù', 'Ú', 'Û', 'Ü', 'Ý', 'ß', 'à', 'á', 'â', 'ã', 'ä', 'å', 'æ', 'ç', 'è', 'é', 'ê', 'ë', 'ì', 'í', 'î', 'ï', 'ñ', 'ò', 'ó', 'ô', 'õ', 'ö', 'ø', 'ù', 'ú', 'û', 'ü', 'ý', 'ÿ', 'Ā', 'ā', 'Ă', 'ă', 'Ą', 'ą', 'Ć', 'ć', 'Ĉ', 'ĉ', 'Ċ', 'ċ', 'Č', 'č', 'Ď', 'ď', 'Đ', 'đ', 'Ē', 'ē', 'Ĕ', 'ĕ', 'Ė', 'ė', 'Ę', 'ę', 'Ě', 'ě', 'Ĝ', 'ĝ', 'Ğ', 'ğ', 'Ġ', 'ġ', 'Ģ', 'ģ', 'Ĥ', 'ĥ', 'Ħ', 'ħ', 'Ĩ', 'ĩ', 'Ī', 'ī', 'Ĭ', 'ĭ', 'Į', 'į', 'İ', 'ı', 'Ĳ', 'ĳ', 'Ĵ', 'ĵ', 'Ķ', 'ķ', 'Ĺ', 'ĺ', 'Ļ', 'ļ', 'Ľ', 'ľ', 'Ŀ', 'ŀ', 'Ł', 'ł', 'Ń', 'ń', 'Ņ', 'ņ', 'Ň', 'ň', 'ŉ', 'Ō', 'ō', 'Ŏ', 'ŏ', 'Ő', 'ő', 'Œ', 'œ', 'Ŕ', 'ŕ', 'Ŗ', 'ŗ', 'Ř', 'ř', 'Ś', 'ś', 'Ŝ', 'ŝ', 'Ş', 'ş', 'Š', 'š', 'Ţ', 'ţ', 'Ť', 'ť', 'Ŧ', 'ŧ', 'Ũ', 'ũ', 'Ū', 'ū', 'Ŭ', 'ŭ', 'Ů', 'ů', 'Ű', 'ű', 'Ų', 'ų', 'Ŵ', 'ŵ', 'Ŷ', 'ŷ', 'Ÿ', 'Ź', 'ź', 'Ż', 'ż', 'Ž', 'ž', 'ſ', 'ƒ', 'Ơ', 'ơ', 'Ư', 'ư', 'Ǎ', 'ǎ', 'Ǐ', 'ǐ', 'Ǒ', 'ǒ', 'Ǔ', 'ǔ', 'Ǖ', 'ǖ', 'Ǘ', 'ǘ', 'Ǚ', 'ǚ', 'Ǜ', 'ǜ', 'Ǻ', 'ǻ', 'Ǽ', 'ǽ', 'Ǿ', 'ǿ'); 
$b = array('A', 'A', 'A', 'A', 'A', 'A', 'AE', 'C', 'E', 'E', 'E', 'E', 'I', 'I', 'I', 'I', 'D', 'N', 'O', 'O', 'O', 'O', 'O', 'O', 'U', 'U', 'U', 'U', 'Y', 's', 'a', 'a', 'a', 'a', 'a', 'a', 'ae', 'c', 'e', 'e', 'e', 'e', 'i', 'i', 'i', 'i', 'n', 'o', 'o', 'o', 'o', 'o', 'o', 'u', 'u', 'u', 'u', 'y', 'y', 'A', 'a', 'A', 'a', 'A', 'a', 'C', 'c', 'C', 'c', 'C', 'c', 'C', 'c', 'D', 'd', 'D', 'd', 'E', 'e', 'E', 'e', 'E', 'e', 'E', 'e', 'E', 'e', 'G', 'g', 'G', 'g', 'G', 'g', 'G', 'g', 'H', 'h', 'H', 'h', 'I', 'i', 'I', 'i', 'I', 'i', 'I', 'i', 'I', 'i', 'IJ', 'ij', 'J', 'j', 'K', 'k', 'L', 'l', 'L', 'l', 'L', 'l', 'L', 'l', 'l', 'l', 'N', 'n', 'N', 'n', 'N', 'n', 'n', 'O', 'o', 'O', 'o', 'O', 'o', 'OE', 'oe', 'R', 'r', 'R', 'r', 'R', 'r', 'S', 's', 'S', 's', 'S', 's', 'S', 's', 'T', 't', 'T', 't', 'T', 't', 'U', 'u', 'U', 'u', 'U', 'u', 'U', 'u', 'U', 'u', 'U', 'u', 'W', 'w', 'Y', 'y', 'Y', 'Z', 'z', 'Z', 'z', 'Z', 'z', 's', 'f', 'O', 'o', 'U', 'u', 'A', 'a', 'I', 'i', 'O', 'o', 'U', 'u', 'U', 'u', 'U', 'u', 'U', 'u', 'U', 'u', 'A', 'a', 'AE', 'ae', 'O', 'o'); 
return str_replace($a, $b, $str); 
}

function SEOify($i){
#   http://php.ca/manual/en/function.preg-replace.php#90316
$o          = $i;
$o          = html_entity_decode($o,ENT_COMPAT,'UTF-8');
$o          = remove_accent(trim($o)); 
$patterns   = array( "([\40])" , "([^a-zA-Z0-9_-])", "(-{2,})" ); 
$replacers  = array("-", "", "-"); 
$o          = preg_replace($patterns, $replacers, $o);
return $o;
}
?> 
```

* * *

## 回答 #9

> 赞同：-14
> 
> 时间：2009-09-27T07:50:43.610

这似乎有效：

```
private synchronized static String utftoasci(String s){
  final StringBuffer sb = new StringBuffer( s.length() * 2 );

  final StringCharacterIterator iterator = new StringCharacterIterator( s );

  char ch = iterator.current();

  while( ch != StringCharacterIterator.DONE ){
   if(Character.getNumericValue(ch)>0){
    sb.append( ch );
   }else{
    boolean f=false;
    if(Character.toString(ch).equals("Ê")){sb.append("E");f=true;}
    if(Character.toString(ch).equals("È")){sb.append("E");f=true;}
    if(Character.toString(ch).equals("ë")){sb.append("e");f=true;}
    if(Character.toString(ch).equals("é")){sb.append("e");f=true;}
    if(Character.toString(ch).equals("è")){sb.append("e");f=true;}
    if(Character.toString(ch).equals("è")){sb.append("e");f=true;}
    if(Character.toString(ch).equals("Â")){sb.append("A");f=true;}
    if(Character.toString(ch).equals("ä")){sb.append("a");f=true;}
    if(Character.toString(ch).equals("ß")){sb.append("ss");f=true;}
    if(Character.toString(ch).equals("Ç")){sb.append("C");f=true;}
    if(Character.toString(ch).equals("Ö")){sb.append("O");f=true;}
    if(Character.toString(ch).equals("º")){sb.append("");f=true;}
    if(Character.toString(ch).equals("Ó")){sb.append("O");f=true;}
    if(Character.toString(ch).equals("ª")){sb.append("");f=true;}
    if(Character.toString(ch).equals("º")){sb.append("");f=true;}
    if(Character.toString(ch).equals("Ñ")){sb.append("N");f=true;}
    if(Character.toString(ch).equals("É")){sb.append("E");f=true;}
    if(Character.toString(ch).equals("Ä")){sb.append("A");f=true;}
    if(Character.toString(ch).equals("Å")){sb.append("A");f=true;}
    if(Character.toString(ch).equals("ä")){sb.append("a");f=true;}
    if(Character.toString(ch).equals("Ü")){sb.append("U");f=true;}
    if(Character.toString(ch).equals("ö")){sb.append("o");f=true;}
    if(Character.toString(ch).equals("ü")){sb.append("u");f=true;}
    if(Character.toString(ch).equals("á")){sb.append("a");f=true;}
    if(Character.toString(ch).equals("Ó")){sb.append("O");f=true;}
    if(Character.toString(ch).equals("É")){sb.append("E");f=true;}
    if(!f){
     sb.append("?");
    }
   }
   ch = iterator.next();
  }
  return sb.toString();
 } 
```

# java - 是否存在 Javascriptable FTP 上传 Java/Flash 小程序？

> ID：285237
> 
> 赞同：6
> 
> 时间：2008-11-12T20:30:54.777
> 
> 标签：java, javascript, flash, ftp, applet

为了能够将大文件从 HTML 页面上传到 FTP 服务器，我正在寻找一个 Java/Flash FTP 上传小程序。

我真的很喜欢[dhtmlxVault](http://www.dhtmlx.com/docs/products/dhtmlxVault/index.shtml)的工作方式，但我需要将它上传到 FTP 服务器，而不是上传 HTTP 文件。

如果 applet 没有自己的 GUI，那将是非常好的，而是使用 Javascript 完全可编写脚本，因此我可以使用 HTML/CSS 来显示它。

我希望查看[Yahoo! 的 YUI Uploader](http://developer.yahoo.com/yui/uploader/)，因为它需要 Flash，但文档只提到了 HTTP 上传而没有 FTP 上传。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-13T10:45:53.240

我尝试了[ZUpload](http://sourceforge.net/projects/zupload/) Java 小程序。

专业人士：

*   用户界面就像我希望的那样简单。
*   它是一个带有自己的 GUI 的 Java 小程序，但我能够在其中实现一些 Javascript 回调来更新 HTML 中的进度信息。我将能够进一步最小化 GUI。

缺点：

*   当上传失败时（当 FTP 服务器告诉它它很忙，请稍后重试）它认为上传成功并继续下一个文件。我试图捕捉异常但由于小程序中使用 j-ftp 的方式或我自己缺乏知识而无法这样做。
*   该项目似乎自 2003 年以来就已经死了，所以我不希望有任何更新。

所以我的结论是它还没有准备好在生产环境中使用。我仍然需要更好的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-05T12:08:24.303

这正是[IntegralFTP](http://www.enterprisedt.com/products/integralftp/overview.html)的本质——一个由 Javascript 封装的 Java 小程序。GUI 全部用 Javascript 实现，因此您可以随意更改它。

它支持 SFTP、FTP 和 FTPS。

[您可以从http://www.integralftp.com](http://www.integralftp.com)使用 IntegralFTP ，或者从[这里](http://www.enterprisedt.com/products/integralftp/purchase.html)购买。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-19T21:04:38.957

从技术上讲，如果您可以访问代码，任何 Swing 应用程序都只需进行少量修改即可工作。如果您准备提供一个小程序，也许您甚至可以使用 java web start（需要更少的更改）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-06-09T19:02:25.397

这个（似乎是开源的）怎么样？ [http://jupload.sourceforge.net/applet-basic-picture.html](http://jupload.sourceforge.net/applet-basic-picture.html)

# java - 如何更改 Java 中派生类的成员函数的签名

> ID：285238
> 
> 赞同：3
> 
> 时间：2008-11-12T20:32:02.247
> 
> 标签：java, derived-class

首先，我正在扩展现有的类结构，并且不能更改原始类结构，但需要注意的是：

我想这样做：

```
class a
{
   int val;

   ... // usual constructor, etc...

   public int displayAlteredValue(int inp)
   {
     return (val*inp);
   }
}

class b extends a
{
   ... // usual constructor, etc...

   public in displayAlteredValue(int inp1, int inp2)
   {
     return (val*inp1*inp2);
   }
} 
```

正如我之前所说，我无法更改`class a`，我想保留函数名称`displayAlteredValue`而不是创建一个新函数。如果可以做到这一点，我只需将 的几个实例更改`a`为`b`. 我不想花很多时间替换对`displayAlteredValue`. （是的，我确实意识到存在诸如搜索和替换之类的事情，但是由于其他原因，这样做会有问题）。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-12T20:44:53.280

您可以重载派生类中的函数。所以你上面指定的应该工作。刚刚写了一个快速测试，它工作。

```
public class DerivedOverload {

    /**
     * @param args
     */
    public static void main(String[] args) {
        A classA = new A(); 

        B classB = new B();

        System.out.println("DerivedOverload.main() classA.displayAlteredValue(2) : " + classA.displayAlteredValue(2));

        System.out.println("DerivedOverload.main() classA.displayAlteredValue(2) : " + classB.displayAlteredValue(2,2));
    }

}

class A
{
   int val = 2;

   A(){

   }

   public int displayAlteredValue(int inp)
   {
     return (val*inp);
   }
}

class B extends A
{
   B(){

   }

   public int displayAlteredValue(int inp1, int inp2)
   {
     return (val*inp1*inp2);
   }
} 
```

系统出。DerivedOverload.main() classA.displayAlteredValue(2) : 4 DerivedOverload.main() classA.displayAlteredValue(2) : 8

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-12T20:46:13.607

我不清楚问题是什么。您绝对可以创建一个具有相同名称但不同签名的方法的子类 b。

您可能遇到的一个可能问题是编译器需要知道对象的类型是 b，而不是 a，才能调用仅存在于 b 中的方法。

所以这样的代码不起作用：

```
// this works because b is a subclass of a
a anObject = new b();

// this will not compile because the declared type of anObject is a
int x = anObject.getValue( 1, 2 ); 
```

您必须将变量的声明更改为类型 b，或者在您想要调用 2-argument 方法时将其强制转换为 b。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-12T20:36:07.213

如果你把它添加到你的派生类怎么办

```
public int displayAlteredValue(int inp)
{
  return super.displayAlteredValue(inp);
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-12T20:45:43.357

您编写的代码按原样编译。您基本上只是重载了该方法。您发布的代码没有完成什么，您*想要*完成什么？您是否试图阻止人们使用单个参数调用 b.displayAlteredValue ？如果是这样，你不能这样做（在编译时），因为它会违反 Liskov 的可替代性原则。

你可以抛出一个异常，但这不会非常好。

或者，您可以使用组合而不是继承 - 但实际上我们需要更多地了解这种情况才能知道这是否合适。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-12T20:45:51.797

你所拥有的对我来说看起来不错。

b 类的实例可以访问该方法的两个版本。对 1 参数版本的调用将自动路由到 a 类。对 2-arg 版本的调用将转到 b 类。

a 类的实例虽然只能访问 1-arg 版本，但我认为没有办法解决这个问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-12T21:02:44.120

或者，您可以考虑使用组合而不是继承，因为您要扩展的类来自不同的包。

[http://www.artima.com/lejava/articles/designprinciples4.html](http://www.artima.com/lejava/articles/designprinciples4.html)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-12T20:56:41.807

您可以在 B 类中编写代码，如下所示：

```
public int displayAlteredValue(int inp) 
{
    return -1;
} 
```

并在函数上指出 -1 是错误返回。对于 int 这实际上不起作用，但如果您返回一个类，如果他们调用该方法的单参数版本，您可以返回 null。

# svn - 在 subversion 中自动创建标签

> ID：285251
> 
> 赞同：6
> 
> 时间：2008-11-12T20:35:02.100
> 
> 标签：svn

我在我的公司维护构建系统，该公司目前正在使用 CVS。此构建系统用于多个项目和多个 CVS 存储库。

每当我们有发布里程碑时，我们都会创建一个标签。在 CVS 中，这很容易：

```
$ cvs tag TAG_NAME 
```

无论 CVS 模块或存储库如何，只要它在 CVS 工作目录中执行，该命令就可以工作。

不过，为了在颠覆中做同样的事情，看起来我首先必须解析 的输出`svn info`以获取存储库根目录。然后我可以创建标签：

```
svn cp . $REPO_ROOT/tags/TAG_NAME -m"Created tag TAG_NAME" 
```

这当然假设 svn 存储库具有推荐的“主干、标签、分支”目录结构。所以为了安全起见，我可能需要先验证这一点。

将修订号映射到符号名称似乎需要做很多工作。有没有更好的办法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-12T21:14:35.373

我几乎完全从命令行使用 svn，而且我很快就厌倦了输入怪物 URL。我终于写了一个脚本`svnurl`，我在 shell 中使用它。它的运作假设“项目”具有以下形式：

```
.../PROJECTNAME/trunk
                tags
                branches 
```

假设您位于 PROJECTNAME/branches/foo 的工作副本中：

```
svnurl -tl  # gives a list of tags for the current project 
svnurl -tlu # the same as full urls
svnurl -t 1.1 # the url for the tag 1.1 of the current project
# analagous functions for branches
svnurl -ru  # the url of the "root" of the current working copy
            # eg  svn://.../PROJECTNAME/branches/foo
svnurl -T   # the url of the trunk of the current project
svnurl -pn  # the name of the current project, `PROJECTNAME`
# ... 
```

用法如下所示：

```
$ svn cp $(svnurl -T) $(svnurl -t 1.1.1)  # tag trunk as 1.1.1 
```

代码并不漂亮，但它为我节省了很多击键次数，并且以我没想到的方式发挥了作用。如果你有兴趣，我愿意分享。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-12T22:29:42.400

您错过了 Subversion 的核心原则：修订号*就是*标签。当你用 svn cp “标记”它时，你只是用一个更长的名字来复制那个特定的版本。与 CVS 标签不同，您（或其他开发人员）可以继续在该“标签”上进行持续开发。它不是像 CVS 标签那样的静态实体（好吧，公平地说，您可以在单个 CVS 文件上移动标签，从而有效地“更改”它）。

大多数 svn 用户按照 CVS 呈现标签的方式处理标签。而且（至少在 Apache 下）您可以将 DAV 服务器配置为不允许在任何标记目录下写入/签入。我还没有尝试过，它可能会阻止您使用 http URL 来创建标签（您必须使用主机上 shell 的文件路径）。但是出于所有实际目的，您的发布过程应该对特定的修订号更感兴趣，而不是对一些任意的文本字符串。后者可以在发布后更改；前者应该[*] 在您每次签出时始终让您访问完全相同的文件集。

[*] 总有办法在幕后摆弄文件，事后...当我需要修复评论等时，我曾经用 vi 手动编辑 RCS 和 CVS 文件。但没有一些严肃的 svn-聪明，给定的修订号应该是相当恒定的。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-05T18:20:55.117

以下是我的实现方式，以防有人好奇：

```
<!-- First, we need to get the svn repository root URL by parsing
the output of 'svn info'. -->
<exec executable="svn" failonerror="yes">
    <arg line="info"/>

    <redirector outputproperty="svninfo.out" errorproperty="svninfo.err">
        <outputfilterchain>
            <linecontains>
                <contains value="Repository Root: "/>
            </linecontains>

            <tokenfilter>
                <replacestring from="Repository Root: " to=""/>
            </tokenfilter>
        </outputfilterchain>
    </redirector>
</exec>

<echo level="verbose" message="Root from svn info: ${svninfo.out}"/>

<!-- Set the svn.root property from the svn info output, and append
the module prefix if it exists. The module prefix allows multiple
projects to use the same repository root. -->
<condition property="svn.root" value="${svninfo.out}/${svn.module.prefix}">
    <isset property="svn.module.prefix"/>
</condition>
<!-- Note that the next line will have no effect if the property was
set in the condition above, since ant properties are immutable. The
effect is an "else", if the condition above is NOT true. -->
<property name="svn.root" value="${svninfo.out}"/>
<echo level="verbose" message="Root: ${svn.root}"/>

<!-- Verify the tags directory exists. -->
<exec executable="svn"
      failonerror="no"
      outputproperty="null"
      errorproperty="svn.ls.error">
    <arg line="ls ${svn.root}/tags"/>
</exec>
<fail>
Cannot find 'tags' subdirectory.

${svn.ls.error}

The subversion repository is expected to have 'trunk', 'branches', and 'tags'
subdirectories. The tag '${tag}' will need to be manually created.
    <condition>
        <not>
            <equals arg1="${svn.ls.error}" arg2="" trim="yes"/>
        </not>
    </condition>
</fail>

<!-- Finally, do the actual tag (copy in subversion). -->
<exec executable="svn" failonerror="yes">
    <arg line="cp . ${svn.root}/tags/${tag} -m 'Created tag ${tag}'"/>
</exec> 
```

我还想指出，我知道 CVS 和 subversion 在标记方面的区别，并且从所有实际目的来看，subversion 修订版等同于标记。不幸的是，这并不重要。我的用户想要一个由模块名称和（不同的）版本号组成的符号名称。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-12T20:52:24.623

与 CVS 不同，标签不仅仅是 subversion 中的符号名称，这就是重点。我们创建了一个标签，实际上是在创建一个分支。如果您还没有，我建议您阅读：http: [//svnbook.red-bean.com/](http://svnbook.red-bean.com/)

# vbscript - 将 JAL 转换为 VBScript

> ID：285253
> 
> 赞同：0
> 
> 时间：2008-11-12T20:35:17.123
> 
> 标签：vbscript

SoftTree Technologies 的 24x7 可以使用 JAL 和 VBScript 来编写脚本。有谁知道是否有将 JAL 转换为 VBScript 的转换器？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-03-04T20:52:00.303

似乎没有这样的事情。您可以将 JAL 转换为 Javascript，但不能将 JAL 转换为 VBScript。

# iis-7 - x64 Windows 2008 服务器上的 32 位应用程序池

> ID：285269
> 
> 赞同：1
> 
> 时间：2008-11-12T20:40:11.013
> 
> 标签：iis-7, 64-bit, pool

在 x64 机器上的 IIS7 下的网站应用程序池中启用和禁用“启用 32 位应用程序”有什么区别？

大多数情况下，我正在考虑内存使用情况。

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-14T03:42:17.393

我相信像这样托管的当前“趋势”是让每个站点都有自己的应用程序池，并且每个应用程序池以 32 位运行。这启用了应用程序池隔离，并允许每个站点/应用程序池限制为 4GB 内存，在 60% 内存阈值的情况下，在 asp.net 回收之前基本上可以达到大约 2.4GB。

如果您有一个需要更多内存的单个站点，您可以将该应用程序池更改为 x64，从而允许更大的应用程序池。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-17T20:59:31.840

32 位应用程序池允许运行基于 32 位 ISAPI .DLL 的应用程序，例如使用 ATL 服务器构建的应用程序。它们不能加载到 64 位应用程序池中。

# php - 致命错误：..中不支持的操作数类型？

> ID：285271
> 
> 赞同：6
> 
> 时间：2008-11-12T20:40:20.030
> 
> 标签：php, mysql, message

调用此错误的行是：

> $celkova_suma=mysql_result($c_res, 0, 0)+mysql_result($d_res, 0, 0)-$zlava_suma+$arr[$_POST['sp_platby']];

有人可以告诉我我应该寻找什么吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-11-12T20:42:41.227

在方程的每个部分上使用 ` [var_dump()](http://www.php.net/var_dump)，您可能会发现其中一个是数组或对象，而不是字符串或整数。

# sap - SAP HR 关系模型

> ID：285276
> 
> 赞同：3
> 
> 时间：2008-11-12T20:41:30.620
> 
> 标签：sap, novell-idm

SAP HR 显然有几个模型来描述职位 (S)、工作 (C)、组织 (O) 和人员 (P) 对象之间的关系，组织管理 (OM) 模块用于维护这些对象。

P（人）对象通常是职位持有者（S）。

有 SS 关系模型，我被告知称为监督模型。也就是说，每个职位都向另一个职位报告，其中一个职位被视为经理。

还有另一个模型，我试图找到它的名称，其中组织报告的结构首先位于 O 对象之间，在树结构中。在每个节点上，S 对象属于 O 对象，其中一个被标记为 Manager。

毫无疑问，还有其他模型，如果您知道它们的名称以及它们的工作原理，那将非常有用！

我对这个问题的看法是，尝试将来自 SAP HR 的 Novell Identity Manager 驱动程序实施到 eDirectory 身份库中，从那里将用户配置到 Active Directory 和 Lotus Notes。

该项目的关键驱动因素之一是经理和 directReports 结构，因此可以识别所有经理，并使报告结构可视化。由此可见 SAP HR 关系建模的重要性。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-29T11:10:29.150

没有固定的组织模型，因为您可以创建自己的对象和/或对象之间的关系。OM 本身就是一个模块，所以这里给出的信息只是一个非常简短的介绍。

最简单的组织模型是 OOSP ：

*   OO 关系 (A/B 002) 是结构单元的分层关系
*   操作系统关系是
    *   A/B 003（属于），用于标准位置
    *   A/B 012（管理）为单位经理职位（也可以有B003到单位或其他单位）
*   SP 关系为 (A/B 008) 是**持仓**人

这些关系是标准关系，并且已被我工作过/合作过的所有客户使用。但是，根据需要，可以使用具有其他关系的其他对象（F：函数，T：任务）。如前所述，可以创建新的对象类型或新的关系。我知道快速查看用于组织的关系的唯一方法是检查表格：

对象存在于 HRP1000 表中（对象的基本信息）。与给定人员关联的对象 ID 可以在信息类型 0001（事务 pa20）中轻松找到：对象 O 的 ID 是 PA0001-ORGEH，S 是 PA0001-PLANS，F 是 PA0001-STELL。当然 P 是 PA0001-PERNR（员工 ID）。

对象之间的关系在 HRP1001 表中。要搜索给定的关系，您需要提供（关系）源 ID 和类型，以及目标类型和 ID。例如，要让所有职位管理一个单位（即所有经理职位），您可以这样做

```
SELECT * from HRP1001 where OTYPE = 'S' 
                        AND RELAT = '012' 
                        and RSIGN = 'A' 
                        and begda <= sy-datum 
                        and endda >= sy-datum 
                        and sclass = 'O'.
... 
```

然后字段 OBJID 和 SOBID 将包含位置和单位的 id。

事务**ooaw**允许管理评估路径，即递归遵循一组关系以获得一组对象。您可以将它们与函数一起使用 `'RH_STRUC_GET'`（字段 wegid 是评估路径）。这可能比使用一组选择更容易。因此，如果您想获得给定单位下的所有单位和人员，您可以使用深度为 0（即一直向下）的“O_S_P”评估路径，或者如果您还想要函数 w，则可以使用“ORGCHART” （描述）职位。

希望这对您有所帮助。问候

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-26T15:19:41.170

HRP1001 表 (HRP1001-RELAT) 中使用的关系存储在表 T778V 中。它们的文本存储在表 T777V 中。

```
相关文本 RINVT
  001 是一个细分 是细分成
  002 报告（线）给是线主管
  003 属于 Incorporates

```

# delphi - 在哪里存储程序设置而不是 HKEY_LOCAL_MACHINE？

> ID：285277
> 
> 赞同：12
> 
> 时间：2008-11-12T20:41:37.280
> 
> 标签：delphi, registry

我有一些当前存储在 HKEY_LOCAL_MACHINE 中的程序设置。由于 Vista 和锁定用户，一些用户没有 HKEY_LOCAL_MACHINE 的权限，而且这些值也不真正属于 HKEY_LOCAL_USER（它必须对所有用户都相同），存储这些的最佳替代位置是什么？

大多数设置已经存储在数据库中，但是在连接到数据库之前程序需要了解一些设置。理想情况下，我会喜欢一种无需检查正在运行的操作系统即可实现此功能的方法。

这是一个用 Delphi 编写的桌面应用程序。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2008-11-13T01:30:38.900

你应该把：

*   `HKEY_CURRENT_USER` 注册表`CSIDL_APPDATA`或文件夹中的个人设置（如窗口位置和次要首选项）`CSIDL_LOCAL_APPDATA`；
*   `HKEY_LOCAL_MACHINE`注册表或应用程序文件夹中的重要应用程序设置（如用​​户不应修改的固定路径） 。在安装时设置它们，当管理员权限可用时；
*   `CSIDL_COMMON_APPDATA`文件夹中的共享数据（所有用户都应该读取和写入的数据，例如简单的数据库） 。

使用[SHGetFolderPath](http://msdn.microsoft.com/en-us/library/bb762181.aspx)查找[`CSIDL_*`](http://msdn.microsoft.com/en-us/library/bb762494.aspx)文件夹的位置。

根据您的需要，您可能希望同时实现所有三个选项。它不会有任何问题。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-11-12T20:43:44.657

可能是注册表中放置它们的好地方，我不知道，但为什么不在 C:\Documents and Settings\All Users\Application Data\yourApp 中添加一个ini文件

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-12T20:54:08.753

@uli所说的，除了一个例外 [。](https://stackoverflow.com/questions/285277/where-to-store-program-settings-instead-of-hkeylocalmachine#285291)

永远不会更改或只能由管理员更改的设置可以——应该，甚至——保存在与应用程序相同的文件夹中，以帮助防止篡改。

数据库的连接信息听起来像是在没有管理员干预的情况下不应该更改的东西。因此，在这种情况下，您的应用程序文件夹可能没问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-13T01:06:38.103

您提到了 HKEY_LOCAL_USER，但我没有在注册表的顶层看到它。我猜你一定是指 HKEY_CURRENT_USER。

我将用户设置放在 HKEY_CURRENT_USER/Software/my-program 下。我发现这在 Vista 下可以正常工作。

但是，既然您说您有适用于 HKEY_CURRENT_USER 下不想要的所有用户的设置，那么您可以尝试：

> HKEY_USERS/.DEFAULT/Software/your-program

或者

> HKEY_CURRENT_CONFIG/软件/你的程序

恐怕我不使用这些位置中的任何一个，所以我无法告诉您它们是否可以在 Vista 上运行，但我确实看到一些软件供应商已经在那里添加了注册表项。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-13T01:23:31.317

将内容保存在 %APPDATA% 或 %LOCALAPPDATA%

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-14T18:33:59.737

问问自己你的设置是否真的适用于所有用户。真的适合所有用户吗*？*

仔细想想这个问题：

**该软件如何在 Windows XP 下作为标准用户运行？**

*   软件只是崩溃了吗？
*   是否禁用了配置选项？
*   您是否告诉您的客户他们必须以管理员身份运行，如果他们拒绝，那么您将不支持它？

因为如果您的软件*绝对要求*您成为管理员，那么只需将清单添加到可执行文件中，说明它需要以管理员身份运行：

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<assembly xmlns="urn:schemas-microsoft-com:asm.v1" manifestVersion="1.0"> 
   <assemblyIdentity 
      version="1.0.0.0"
      processorArchitecture="X86"
      name="IsUserAdmin"
      type="win32"/> 

   <description>Description of your application</description> 

   <!-- Identify the application security requirements. -->
   <trustInfo xmlns="urn:schemas-microsoft-com:asm.v3">
      <security>
         <requestedPrivileges>
                <requestedExecutionLevel
               level="requireAdministrator"
               uiAccess="false"/>
         </requestedPrivileges>
      </security>
   </trustInfo>
</assembly> 
```

而且，您是管理员。

* * *

但我不认为你真的*需要*成为管理员。唯一**需要**本地计算机设置的情况是，如果您要让用户通过多个登录或会话使用该软件。如果它真的适用于每个用户，安装程序不应该设置它吗？

我们在这里提出了同样的问题。监控系统需要配置软件将使用哪个捕获设备。您可以说所有监视操作员都将使用相同的捕获设备，因此一旦选择它，该设置对所有操作员都是全局的。但这在实践中是不正确的。可能只有一次捕获设备，而且它是我们使用的那个。如果有多个，则用户可以简单地选择另一个设备。

* * *

但是有几种方法可以处理这个

i) 将设置保存在注册表中，并让安装程序在密钥上设置 ACL，让所有用户*完全控制*。

ii) 将设置保存在

> %APPDATA%\Surveillance\settings.ini

文件。让安装程序创建设置文件，并对其进行 ACL 以允许所有用户拥有*完全控制权*

iii) 将设置存储在上述注册表项或 ini 文件中，并使用

*   [Button_SetElevationRequiredState 宏](http://msdn.microsoft.com/en-us/library/bb761865(VS.85).aspx)或
*   图标**IDI_SHIELD**

将 UAC Shield 添加到您的**保存**/**确定**/**应用**按钮。当用户按下按钮时，您重新启动提升的应用程序（使用[RunAsAdmin](http://msdn.microsoft.com/en-us/library/bb759784(VS.85).aspx)），传递命令行参数指示您要更改的内容。

iv) 与 3 相同，但在他们进入用于编辑值的屏幕之前执行此操作。

v) 执行与 4 相同的操作，但初始值为只读，如果他们想要更改它们，则必须提升。

vi) 如果用户作为标准用户运行，并且如果他们想要更改它们，请禁用这些选项：右键单击可执行文件并选择

> 以管理员身份运行

* * *

如果这是一个用户可以随时更改的选项（当您在 Windows XP 上运行并且用户是管理员时），那么用户能够随意编辑该值似乎是可以接受的。

在这种情况下，您可以让用户输入服务器的名称，就像他们之前允许的那样。如果用户有权写入 HKLM，则将选项保存在那里。否则将其保存在 HKCU 中。读取要使用的服务器时，从 HKCU 开始，如果 HKCU 值不存在，则移至 HKLM。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-12-04T05:52:27.653

重新使用 ini 文件 - 请注意项目似乎有`2048 byte`限制。

由于这个原因，我陷入了困境 - 编码的许可证信息徘徊在（当时未知的）限制附近以及当他们过去时似乎总是“神秘地”打破的东西......

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-12T20:44:32.893

您能否制作一个 .msi 文件，该文件可用于通过组策略将注册表设置推送出去？

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-13T14:17:43.010

总是有老式的 INI 文件。它们比注册表设置更便携。另一种选择是 XML 文件。

但是不要将它们存储在 Program Files 目录中——Vista 不会喜欢这样。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-11-17T22:15:28.503

我在这里阅读了所有答案以及其他地方的内容，答案似乎是......不要使用注册表！这真的是微软希望我们对适用于所有用户的程序配置数据做的事情吗！？

# algorithm - 合并具有未知排序函数的数据

> ID：285286
> 
> 赞同：4
> 
> 时间：2008-11-12T20:42:50.320
> 
> 标签：algorithm

我有许多字符串数组。根据相同的标准，每个数组中的字符串都以相同的方式排序。但是，某些数组中可能缺少某些字符串，并且可能没有具有完整字符串集的数组。此外，我无法使用用于比较字符串的标准：在数组的上下文之外，我无法判断哪个字符串应该在另一个之前。

我需要一种方法来生成一整套正确排序的字符串。或者当阵列没有足够的信息让我这样做时失败。

有没有人熟悉这种问题？什么是正确的算法？

例子：

```
A B D
A C D 
```

无法正确排序，无法决定B和C的顺序

```
A B D
A B C
A C D 
```

这有足够的信息来正确订购 ABCD。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-12T21:29:40.197

我能想到的一种可能的方法，虽然可能不是最有效的：

我将用你的例子来解释：

```
A B D
A B C
A C D 
```

创建一个唯一字符数组，因此您将获得（例如）：

```
A B D C 
```

此外，您可能应该有一个枚举来描述可能的关系

```
enum Type
{
    Unknown = 0,
    Greater = 1,
    Equal = 2,
    Less = 3,
} 
```

现在，创建一个维度与上述数组相同的方阵，默认一切为 Type.Unknown。

```
0 0 0 0
0 0 0 0
0 0 0 0
0 0 0 0 
```

当您确定排序时，您的数组将用作矩阵的索引。要了解我的意思，请看这里：

```
 A B D C
A 0 0 0 0
B 0 0 0 0
D 0 0 0 0
C 0 0 0 0 
```

通过并将对角线设为 Type.Equal

```
2 0 0 0
0 2 0 0
0 0 2 0
0 0 0 2 
```

现在您需要填充矩阵，遍历每个输入数组并获取每个字符及其后的字符。使用这 2 个字符，为每个字符在矩阵中找到索引（使用您的数组）并更新矩阵。

```
for(int i=0; i<len(arr)-1; i++)
{
    char c1 = arr[i], c2 = arr[i+1];
    int i1,i2;
    //get indices of characters in array and put in i1, and i2 respectively
    matrix[i1][i2] = Type.Less;
    matrix[i2][i1] = Type.Greater
} 
```

您每次在网格中分配 2 个位置，因为当一个字符小于另一个字符时，也意味着第二个字符大于第一个字符。

现在您只需将字符一次插入一个数组（链接列表将是最简单的，您将在一秒钟内了解原因）

每次插入 char 时，您将从返回数组的开头开始，并遍历，查找第一个数组中的索引，并检查矩阵中的 Type.Greater 或 Type.Less（取决于哪种方式您正在比较，将 curr char 与数组或数组与当前 char 进行比较，如果遇到与预期不同的值，则将其插入。

如果您在插入过程中在 matix 中点击 Type.Unknown，则您知道您没有足够的信息来对这些数组进行排序，如果您点击 Type.Equal，则可以忽略插入此字符（假设您不希望重复在你的结果中。）

然后你会输出你的返回数组

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-12T21:35:15.550

[这听起来像是拓扑排序](http://en.wikipedia.org/wiki/Topological_sort)问题的一个特例。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-12T21:46:16.807

1）对数据进行排序。如果偏序不一致，就会出现循环，tsort 会失败。否则你有一个序列 s(0) ... s(n-1)。

2) 对于每一对s(i)、s(i+1)，在部分序列中搜索出现彼此相邻的同一对。如果你在其中一个中找到它，那么继续下一个 i。如果找不到，则失败，因为部分序列不排序 s(i) 和 s(i+1)。

为什么不？因为如果他们确实订购了它们，但它们没有出现在彼此旁边，那么“它们之间”肯定有什么东西。但是，如果在部分序列中它们之间有一些东西，但在你从 tsort 中得到的完整序列中没有，那么整个序列中的闯入者必须在 s(i) 之前或 s(i+1) 之后。这与 tsort 已经证明的完整序列与部分序列的一致性相矛盾。

第 2 步是 O(n*m)，其中 n 是要排序的元素数，m 是所有部分序列的总长度。您可能可以做得更好，但这非常简单，因为您可以从第 1 步的货架上拿一个 tsort，而第 2 步显然是一堆嵌套循环。请注意，如果您找到 s(i) （或 s(i+1) ），您可以停止搜索每个部分序列，因为它肯定不会再次出现。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-12T20:59:13.580

你会有多少套？如果它们不太稀疏，可能会起作用的是：

1.  遍历所有数组的第一个元素，计算每个字符串的常见程度。
2.  选择最常见的元素。
3.  检查所有数组的每个元素是否有所述字符串。
4.  如果它存在于数组的第一个元素以外的任何元素中，则选择其父数组的第一个元素并转到步骤 3。
5.  从所有数组/树的第一个元素中删除所选元素并将其添加到输出列表的末尾。
6.  转到 1，直到所有元素都被删除。

如果您将数组转储到[b 树](http://en.wikipedia.org/wiki/B-tree)中，则元素搜索可能会非常快。您还可以通过使用数组的顺序来进一步加快第 3 步。我还在考虑这个。

如果数组非常稀疏，我唯一能想到的就是使用某种监督机器学习来尝试确定正确的排序方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-12T21:08:31.457

这与经典的[diff/merge 算法](http://en.wikipedia.org/wiki/Diff)有何不同？只要两个数组都是“排序的”，不管它们的排序机制如何。它们是相互比较的，因此您应该能够使用相似性来合并差异。在那之后，它基本上是任意的。

如果你想将 [A] 与 [B, C, D] 合并，那么你不知道 A 会去哪里（前端？后端？在 C 和 D 之间？你不知道）。在这些情况下，您只需要提出一个约定（总是在前面，总是在最后，类似的东西）。

如果要将 [Q, X, Y, A, B] 与 [Q, X, W, B, D] 合并，则需要确定“W”是在“Y”之前还是在“Y”之后，一种”。所以，[Q, X, Y, A, W, B, D] 是正确的还是 [Q, X, W, Y, A, B, D] 是正确的。坦率地说，你只需要打电话并顺其自然。根本没有足够的信息。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-12T21:34:26.240

主要问题是，给定一些数据，您需要确定排序函数。之后它只是列表排序。

生成所有数组的第一个元素的列表。删除重复项。所以这：

```
A B
A C
B C
C C
C D 
```

变成（A，B，C）。然后，我们需要一组对来表示我们知道的每个值都小于其他值。（（A，B），（A，C），（B，C））对于这个例子。

现在，对于我们可以在数组开头找到的每个值，将以该值开头的所有数组作为一个组。删除他们的第一个元素。这让我们：

```
B
C 
```

,

```
C 
```

和

```
C
D 
```

对这些数组列表中的每一个进行递归。

一旦我们完成了对所有子集的递归，我们将生成的对合并到我们最初提出的内容中。我们应该以 ((A,B),(A,C),(B,C),(C,D)) 结束。根据您的值的属性，您可以将其扩展为 ((A,B), (A,C), (A,D), (B,C), (B,D), (C,D) ）。

您的小于函数现在只是查看要比较的值是否在此集合中。如果是这样，那就对了。否则为假。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-12T21:54:11.083

道格麦克林获胜。跳入我脑海的短语是分层，这导致了网络搜索的死胡同。（例如，在逻辑编程中，谈论分层程序很有用；这些程序可以可视化为一堆层，每一层包含一个或多个谓词，每个谓词都是外延的（底层）或跟随的仅来自其下层中的谓词。理想情况下，您需要一种这种形式，其中每一层最多有一个字符串。）

您对拓扑排序算法的变体将让您构建一个 DAG（您暗示保证了非循环性），可能会在您进行时跟踪具有零传入边的节点（一个简单的优化）。如果完成后，您有多个“根”节点，那么您就完成了，因为您知道您没有第一个节点。否则，你只有一个；从 DAG 中删除它，检查它的每个子节点现在是否是“根”节点；并继续进行，直到您获得多个根节点（失败）或用完节点（成功）。

我上面勾勒的算法在字符串的数量上应该是线性的（基本上，通过它们进行两次迭代）。它可以说与字符串数量的平方成正比，如果每个节点有很多子节点，这意味着每个字符串在您的列表列表中出现很多次，每个字符串后面紧跟着一个不同的字符串。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-12T22:38:29.697

我很想说，为了有足够的信息来完成合并，在最终合并数组中彼此相邻的每一对 x,y 必须存在于输入数组中的某个位置。换句话说，传递性可能根本不会出现。有人能举出反例吗？

如果您愿意，您可以在答案中执行此操作。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-12T23:31:26.627

一个简单的递归例程怎么样？

使用你的第二个例子：

```
A B D
A B C
A C D 
```

创建所有唯一排序的哈希表：

```
table = {A -> B, C
         B -> C, D
         C -> D} 
```

计算所有唯一值

```
countUnique = 4 
```

使用堆栈，计算所有可能的路径。当堆栈长度与唯一字符串的数量匹配时，您知道您有一个解决方案。如果您找到多个解决方案，那么您在某处有一个循环引用。 *请原谅我有问题的伪代码。*

```
main()
{
  foreach (s in table.keys)
  {
    stack.push(s)
    searchForPath()
    stack.pop()
  }
}

searchForPath()
{
  if (table.hasKey(stack.peek))
  {
    // we're not at the end yet
    foreach (s in table[stack.peek])
    {
      // avoid infinite recursion
      if (stack.contains(s)
        continue

      stack.push(s)
      searchForPath()
      stack.pop()
    }
  }
  else
  {
    if (stack.size == countUnique)
    {
      // solution found
      captureSolution()
    }
  }
} 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2008-11-12T21:15:30.990

部分解决方案：

您需要确定订单。您可以通过让您的数据“投票”确定一个符号在另一个符号之前的次数来做到这一点。您将需要一个大小等于符号数量的方阵。将其初始化为全零，然后扫描所有输入字符串，为每个连续对 (a,b) 将 1 添加到 M(a,b)。然后，您需要清除这些数据，因此您得到一个传递顺序（如果 A 在 B 之前并且 be 在 C 之前，A 也必须在 C 之前）。为此，您需要遍历所有不同符号的三元组，并“协调”各自的不等式三元组，因此它们尊重传递性。

如果您的数据不是太嘈杂，这应该只需要通过一次。如果数据太嘈杂，您可能需要运行多次遍历直到收敛，或者采用一些贪婪的方法：不是以随机顺序遍历所有符号，而是按投票数递减的顺序遍历所有不等式三元组.

# python - Python中的退出代码

> ID：285289
> 
> 赞同：279
> 
> 时间：2008-11-12T20:43:08.510
> 
> 标签：python, exit-code

我收到一条消息说`script xyz.py returned exit code 0`。这是什么意思？

Python中的退出代码是什么意思？那里有多少？哪些是重要的？

* * *

## 回答 #1

> 赞同：290
> 
> 时间：2008-11-12T20:50:48.060

您正在寻找[`sys.exit()`](https://docs.python.org/2/library/sys.html#sys.exit)脚本中的调用。该方法的参数作为退出代码返回给环境。

脚本很可能从不调用*exit*方法，而 0 是默认退出代码。

* * *

## 回答 #2

> 赞同：123
> 
> 时间：2008-11-12T21:31:23.093

从文档中[`sys.exit`](https://docs.python.org/2/library/sys.html#sys.exit)：

> 可选参数 arg 可以是给出退出状态的整数（默认为零），也可以是其他类型的对象。如果它是一个整数，则零被认为是“成功终止”，任何非零值都被 shell 等视为“异常终止”。大多数系统要求它在 0-127 范围内，否则会产生未定义的结果。一些系统有为特定退出代码分配特定含义的约定，但这些通常不发达；Unix 程序通常使用 2 表示命令行语法错误，使用 1 表示所有其他类型的错误。

使用退出代码的一个示例是在 shell 脚本中。在 Bash 中，您可以检查`$?`最后退出状态的特殊变量：

```
me@mini:~$ python -c ""; echo $?
0
me@mini:~$ python -c "import sys; sys.exit(0)"; echo $?
0
me@mini:~$ python -c "import sys; sys.exit(43)"; echo $?
43 
```

我个人尝试使用我在`/usr/include/asm-generic/errno.h`（在 Linux 系统上）找到的退出代码，但我不知道这是否是正确的做法。

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2015-06-11T08:53:44.873

[作为记录，您可以使用此处](https://docs.python.org/2/library/os.html#process-management)定义的 POSIX 标准退出代码。

例子：

```
import sys, os

try:
    config()
except:
    sys.exit(os.EX_CONFIG) 
try:
    do_stuff()
except:
    sys.exit(os.EX_SOFTWARE)
sys.exit(os.EX_OK) # code 0, all ok 
```

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2008-11-13T07:32:08.153

有一个[`errno`](http://docs.python.org/library/errno.html)定义标准退出代码的模块：

例如，**Permission denied**是错误代码**13**：

```
import errno, sys

if can_access_resource():
    do_something()
else:
    sys.exit(errno.EACCES) 
```

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2008-11-12T20:46:28.643

退出代码 0 通常意味着“这里没有问题”。但是，如果脚本的程序员没有遵循约定，您可能必须查阅源代码以了解其含义。通常一个非零值作为错误代码返回。

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2017-01-24T18:22:58.250

答案是“取决于退出代码零的含义”。

但是，在大多数情况下，这意味着“一切正常”。

* * *

我喜欢 POSIX：

所以，在 shell 中，我会输入：

```
python script.py && echo 'OK' || echo 'Not OK' 
```

如果我的 Python 脚本调用`sys.exit(0)`，shell 返回“OK”

如果我的 Python 脚本调用`sys.exit(1)`（或任何非零整数），shell 将返回“Not OK”。

您的工作是精通 shell，并阅读脚本的文档（或源代码）以了解退出代码的含义。

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2020-07-02T12:06:31.807

遵循[Unix 退出代码](https://shapeshed.com/unix-exit-codes/) **0** - 成功/正常，**1** - 不成功/错误。您可以简单地使用`exit(0)`或`exit(1)`调用而不导入`sys`模块。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2016-06-10T21:17:29.103

如果您想便携地使用[标准 POSIX 退出代码](https://www.gnu.org/software/libc/manual/html_node/Exit-Status.html)，请参阅[`exitstatus`](https://pypi.python.org/pypi/exitstatus/)PyPI 上的包。

安装包：

```
$ pip install exitstatus 
```

在您的代码中使用：

```
import sys
from exitstatus import ExitStatus

sys.exit(ExitStatus.success) 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2008-11-12T23:12:15.247

操作系统命令具有退出代码。查找[Linux 退出代码](http://steve-parker.org/sh/exitcodes.shtml)以查看有关此的一些材料。shell 使用退出代码来决定程序是否工作、有问题或失败。有一些努力来创建标准（或至少是常用的）退出代码。请参阅此[Advanced Shell Script](http://www.linuxtopia.org/online_books/advanced_bash_scripting_guide/exitcodes.html)发布。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2018-02-12T14:41:00.493

> 我建议使用内置的 exit(0) 彻底关闭，而不是使用 sys.exit()

我不确定这是否是个好建议。

[提到的文档](https://docs.python.org/3/library/constants.html#constants-added-by-the-site-module)内容如下：

> 站点模块（在启动期间自动导入，除非给出 -S 命令行选项）将几个常量添加到内置命名空间。它们对交互式解释器 shell 很有用，**不应在程序中使用**。

然后：

> 退出（代码=无）
> 
> 打印时打印消息的对象，例如“使用 quit() 或 Ctrl-D（即 EOF）退出”，并在调用时使用指定的退出代码引发 SystemExit。

如果我们将它与[sys.exit()](https://docs.python.org/2/library/sys.html#sys.exit)文档进行比较，它使用的机制与引发`SystemExit`异常的机制相同。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2008-11-12T20:46:50.813

退出代码仅具有脚本作者指定的含义。Unix 的传统是退出代码 0 表示“成功”，其他都是失败。确定给定脚本的退出代码含义的唯一方法是检查脚本本身。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-11-12T20:48:04.303

许多编程语言的退出代码由程序员决定。所以你必须查看你的程序源代码（或手册）。零通常意味着“一切顺利”。

* * *

## 回答 #13

> 赞同：-3
> 
> 时间：2017-03-10T13:12:44.133

为了允许异常处理程序和其他事情执行，我建议使用内置的干净关闭[`exit(0)`](https://docs.python.org/3/library/constants.html#exit)而不是使用`sys.exit()`它突然终止进程。

# actionscript-3 - 尝试通过套接字发送 HTTP 请求

> ID：285290
> 
> 赞同：1
> 
> 时间：2008-11-12T20:43:17.090
> 
> 标签：actionscript-3, http, sockets

我无法使用 Actionscript 3 的 Socket() 对象发送一个简单的 HTTP 请求。我的 onConnect 监听器如下：

```
function sConnect(e:Event):void {
    trace('connected');
    s.writeUTFBytes('GET /outernet/client/rss/reddit-feeds HTTP/1.1\r\n');
    s.writeUTFBytes('Host: 208.43.71.50:8080\r\n');
    s.writeUTFBytes('Connection: Keep-alive\r\n');
    s.flush();
} 
```

使用数据包嗅探器，我可以看到请求确​​实被发送到服务器，但是数据包嗅探器不会像处理其他 HTTP 服务那样将协议识别为 HTTP。当我运行它时，服务器最终会断开我的连接。我尝试连接到其他简单的 Apache 服务器，却得到一个格式错误的请求错误。

我在这里想念什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-12T20:57:05.207

您必须在刷新之前向流中写入另一个“\r\n”，以告知 HTTP 服务器您已完成发送标头。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-12T20:57:18.247

事实证明，在我请求之后，我没有向 HTTP 服务器发送空行。原始作品的以下小调整：

```
function sConnect(e:Event):void {
    trace('connected');
    s.writeUTFBytes('GET /outernet/client/rss/reddit-feeds HTTP/1.1\r\n');
    s.writeUTFBytes('Host: 208.43.71.50:8080\r\n');
    s.writeUTFBytes('Connection: Keep-alive\r\n\r\n');
    s.flush();
} 
```

请注意最后一个 writeUTFBytes 之后的额外 \r\n。无论如何，谢谢布赖恩。

编辑：谢谢格雷姆。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-12T20:45:10.723

尝试使用 ANSI/ASCII，而不是使用 UTF。编码可能是问题的原因。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-04T17:37:28.590

我只是浪费了很多时间来追踪 Flash 10 和 Linux 与 writeMultiByte() 的某些组合中显然是一个严重的错误。我会非常怀疑使用 writeMultiByte()。

我希望这可以帮助你。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-07-05T07:53:31.483

可能是错误的，不支持“ascii”编码（请参阅[http://www.adobe.com/livedocs/flash/9.0/ActionScriptLangRefV3/charset-codes.html](http://www.adobe.com/livedocs/flash/9.0/ActionScriptLangRefV3/charset-codes.html)） - 使用“us-ascii”

# architecture - 扩展方法的使用——这不是糟糕的设计吗？

> ID：285292
> 
> 赞同：4
> 
> 时间：2008-11-12T20:43:53.673
> 
> 标签：architecture, .net-3.5, extension-methods

我刚刚开始研究 .NET 3.5，所以如果之前有人问过这类问题，请原谅我。我正在为扩展方法的体面使用而苦苦挣扎，因为我刚刚下载了 suteki shop 一个 MVC 电子商务产品。在这个项目中，有一个非常标准的存储库模式，它扩展了 IRepository。

为了扩展此接口公开的基本功能，使用了扩展方法，即：

```
public static class CategoryRepositoryExtensions
{
    public static Category GetRootCategory(this IRepository<Category> categoryRepository)
    {
     return categoryRepository.GetById(1);
    }
} 
```

现在这一切都很好，但是就我而言，接口充当实现它们的对象的契约。

存储库已被接口的事实表明尝试采用与数据层无关的方法。也就是说，如果我要创建自己的数据层，我会很困惑我必须创建哪些扩展方法来确保我已经满足了对实现我的存储库类的类的合同要求。

似乎创建 IRepository 然后扩展的旧方法可以更好地了解所需内容，例如

```
ICategoryRepoitory : IRepository<Category>
{
     Category GetRootCategory();
} 
```

所以我想我的问题是这种使用扩展方法对其他人来说似乎是错误的吗？如果不是，为什么？我不应该为此抱怨吗？

编辑：

上面的例子似乎是一个很好的例子，说明了为什么扩展方法非常有用。

我想我的问题是数据访问特定实现是否卡在数据访问机制程序集中的扩展方法中。

这样，如果我要将它换成另一种机制，我将不得不在该程序集中创建一个类似的扩展方法。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-12T21:01:52.297

关键是，如果您已经`IRepository<T>`适当地实现了所有内容，那么您（作为数据层实现者）根本不需要了解根类别。对于此扩展方法的范围，假设任何类别的*存储库*都将具有 ID 1 的根类别。这可能是一个完全合理的假设，也是一个有用的假设：没有人必须构建派生类（它可能是不切实际的——数据层可能有工厂等，这使得从实现中派生变得很棘手）。

现在，扩展方法仅在其范围合适的情况下才适用——如果它位于命名空间（或密切相关的命名空间）中，关于根类别的假设将是有效的。

我不认为“旧”方式真的是一个接口扩展`IRepository<Category>`——它是一个普通的静态方法`IRepository<Category>`。这就是扩展方法让生活更愉快的地方。如果您真的会使用继承，那么现在也可以这样做。不幸的是，我们对您的系统架构的了解还不够，无法肯定地说。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-10-09T07:13:43.790

正如一些作者所说，扩展方法概念只是语法糖。它使代码更易读，但更难理解。最终，扩展方法只是静态的，它们是程序范式的遗产。它们使代码紧密耦合，内聚性降低，更难测试和重用。

我对 C# 编程语言的这种趋势有偏见。这个特性很吸引人，但它没有带来任何好处，相反它增加了代码的复杂性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-12T21:03:02.667

这不是一回事。扩展方法只是一种语法便利，仅此而已，当然也不是合同要求。您不会在自己的课程中“实施”它们。对于上面的示例：

```
using CategoryRepositoryExtensions;
...
Category c = r.GetRootCategory(); 
```

与以下内容*完全相同*：

```
Category c = CategoryRepositoryExtensions.GetRootCategory(r); 
```

因此对接口的实现者没有额外的要求。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-12T21:31:22.500

是的，在您提到的示例中，它看起来确实违反直觉，原因是因为您在单个级别上处理单个对象。我发现在使用 IQueryable / IEnumerable 集合时扩展方法最有用。

例如。让我们考虑两种情况：

*   场景1：获取包含产品x的所有订单列表

*   场景 2：获取包含产品 x 并已运送到邮政编码 y 的所有订单的列表

如果您使用的是传统/接口驱动的方法，您可能会定义 2 来定义 2 个不同的接口。如果你使用扩展方法，你可以使用类似下面的东西

方案 1

```
<IEnumerable> orders1Enumerable = OrderRepository.GetAllOrders()
                                     .ContainingProductCode(x); 
```

方案 2

```
<IEnumerable> orders2Enumerable = OrderRepository.GetAllOrders()
                                     .ContainingProductCode(x)
                                     .WithShippingZipCode(y); 
```

执行此操作时，框架会通过链接这些扩展方法动态创建适当的 SQL

希望这可以帮助

# database - 几乎唯一的字段应该有索引

> ID：285313
> 
> 赞同：2
> 
> 时间：2008-11-12T20:48:46.567
> 
> 标签：database, database-design, indexing, unique-index

我在数据库中有一个字段几乎是唯一的：98% 的时间值是唯一的，但它可能有一些重复。我不会在这个领域做很多搜索；一个月说两次。该表目前有约 5000 条记录，每月将增加约 150 条记录。

这个字段应该有索引吗？

我正在使用 MySQL。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-12T20:56:04.850

我认为“几乎独一无二”可能是一个红鲱鱼。数据要么是唯一的，要么不是唯一的，但这并不能确定您是否出于性能原因对其进行索引。

### 回答：

5000条记录真的不多，不管有没有索引，搜索还是很快的。以这样的插入速度，你需要 3 年才能获得 10000 条记录，这仍然不多。
我个人不会费心添加索引，但如果你这样做也没关系。

### 解释：

在决定添加索引时，您必须考虑的是插入速度和选择速度之间的权衡。

如果没有索引，`select`在该字段上执行操作意味着 MySQL 必须遍历每一行并读取每个字段。添加索引可以防止这种情况。

索引的缺点是每次插入数据时，除了添加数据之外，数据库还必须更新索引。这通常是一个很小的开销，但如果您有大量索引并且正在执行大量写入，您会真正注意到它。

当您在数据库中获得这么多行时，无论如何您都需要一个索引，否则您的选择将花费一整天的时间，但这只是需要注意的事情，这样您就不会最终在字段上添加索引“只是以防我需要”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-12T20:55:04.853

那根本不是很多记录。我不会费心在该表上创建任何索引。该字段的相对唯一性无关紧要 - 即使在多年前的商品硬件上，我希望对该表的查询只需几分之一秒。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-12T20:55:42.010

您可以使用一般的经验法则：当它成为问题时进行优化。只是在您发现需要索引之前不要使用索引。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-12T20:54:43.463

从您所说的来看，这听起来并不像索引是必要的。经验法则是 SELECTS 中大量使用索引字段来加速搜索，这反过来（可以）减慢 INSERTS 和 UPDATES。

在像你这样小的记录集上，我认为无论哪种方式你都不会看到太多真实世界。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-12T20:56:25.020

如果您每月只对其进行两次搜索并且它只有几行，那么我会说不要索引它。它几乎没有用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-12T20:57:08.420

这真的是一个判断电话。有了这么小的表，你可以在没有索引的情况下快速搜索，所以你可以不用它。

另一方面，创建您并不真正需要的索引的成本非常低，因此不这样做并不会为自己节省太多。

此外，如果您确实创建了索引，那么如果您突然开始每周获得 1000 条新记录，那么您将获得保障。可能您对这种情况有足够的了解，可以肯定地说这永远不会发生，但是在您最不期望的时候，需求确实有一种改变的方式。

编辑：就不断变化的需求而言，要考虑的是：如果数据库确实增长并且您稍后发现您确实需要索引，您可以简单地创建索引并完成吗？或者您是否还需要更改大量代码以使用新索引？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-12T20:57:16.003

不，记录不多，不会经常查询。无需索引。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-13T14:24:02.980

It depends. As others have responded, there's a trade off between table update speed and selection speed. Table update includes inserts, updates, and deletes on the table.

One question you didn't address. Does the table have a primary key, and a corresponding index? A table with no indexes usually benefits form having at least one index. The most common way of getting that index is to declare a primary key, and rely on the DBMS to generate an index accordingly.

If a table has no candidates for primary key, that usually indicates a serious flaw in table design. That's a separate issue and should get a spearate discussion.

# ruby - 在使用 TestRunner 运行之前将参数/对象传递给 ruby 单元/测试

> ID：285314
> 
> 赞同：3
> 
> 时间：2008-11-12T20:49:07.033
> 
> 标签：ruby, unit-testing, automation, testunit

我正在构建一个自动化流程的工具，然后对它自己的结果运行一些测试，然后去做一些其他的事情。

在尝试清理我的代码时，我创建了一个单独的文件，其中只有测试用例类。现在，在我可以运行这些测试之前，我必须先向类传递几个参数/对象，然后才能运行它们。现在的问题是我似乎找不到将参数/对象传递给测试类的方法。

现在我正在考虑生成一个 Yaml 文件并在测试类中读取它，但是为此使用临时文件感觉“错误”。如果有人有更好的解决方案，那就太好了！

**************编辑************

我现在正在做的示例代码：

```
#!/usr/bin/ruby
require 'test/unit/ui/console/testrunner'
require 'yaml'
require 'TS_SampleTestSuite'

automatingSomething()
importantInfo = getImportantInfo()

File.open('filename.yml', 'w') do |f|
    f.puts importantInfo.to_yaml
end

Test::Unit::UI::Console::TestRunner.run(TS_SampleTestSuite) 
```

现在在上面的例子中 TS_SampleTestSuite 需要重要信息，所以第一个“测试用例”是一个方法，它只是从 Yaml 文件 filname.yml 中读取信息。

我希望这能消除一些困惑。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-01T19:19:33.687

首先，我同意 Cameron 的观点，这段代码肯定不符合 Ruby 的方式，尽管我现在也会回避它。

启动和运行它的**最快**方法，特别是如果这个数据几乎是不可变的（也就是说，你的测试无论如何都不会改变它），就是将值分配给一个常量。因此，与其命名变量`importantInfo`，不如命名它`IMPORTANT_INFO`。然后它将在您的测试中提供给您。这绝对不是一个很好的解决方案，我认为它甚至可以被认为是一种测试气味，你需要那种全局设置，但它就在那里。

或者，您可以查看 stubbing `importantInfo`，我实际上认为这将提供更清洁和更具可读性的测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-14T00:06:19.857

总体而言，看起来您并没有真正以非常红宝石的方式使用单元测试，但我将把它放在一边。

您的基本问题是您需要在测试运行之前进行一些设置。执行此操作的正常方法是使用测试单元案例本身中的设置方法。

```
class UserTest < TestUnit::TestCase

  def setup
    # do your important calculation
  end

  def test_success
    #.. assert some things
  end
end 
```

我会考虑一下您实际上在这里测试的是什么代码，看看您是否可以分解它并以更细化的方式对其进行测试，并进行更多测试。

# asp.net - 将纯文本转换为可点击链接或链接到 asp.net 中的纯文本

> ID：285320
> 
> 赞同：0
> 
> 时间：2008-11-12T20:50:04.690
> 
> 标签：asp.net, html

我需要您的建议，将纯文本转换为 URL。

场景将是这样的：用户将选择一些条目，然后单击“转换为链接”按钮。

用户选择的条目文本将转换为`(link: selected_text)`. 我用 JavaScript 来做。之后，当他单击“保存”按钮保存他的所有条目时，我不知道如何将其存储`(link: selected_text)`在数据库中。

URL 将如下所示：`www.mysite.aspx?t=selected_text`.

我可以`(link: selected_text)`通过在代码隐藏中使用替换功能进行转换。但是后来我不知道如何将用户显示为可点击并且不显示`<a href="www.mysite.aspx?t=selected_text">`

这可能很难理解，因此我将展示我的一些代码来解释。

```
Private Sub Save(ByVal Entry As String) ' Entry Comes from entry textbox '

  Dim elected As String
  selected = Entry.Replace("(link: ", "<a href http://www.mysite.com?link=")
  selected = Entry.Replace(")", ">")

  ' then here starts save but not necessary to show '

End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-13T07:41:33.080

如果您出于某种原因必须保存已处理的输入

```
(link: here) 
```

必须转换为

```
(link: <a href="http://www.mysite.com?t=here">here</a>) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-13T07:38:28.547

不要将其保存为 www.mysite.com?t=here。只需在用户键入时保存条目。稍后向用户显示时，将“（链接：此处）”转换为链接并显示。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-13T07:43:06.587

保存用户写的帖子。这将使以后更容易编辑帖子。当您呈现消息时，您应该使用正则表达式将其替换为真实链接。你永远不应该用“>”替换所有的“）”。如果我写“你好（世界）”会发生什么？

结果：你好（世界>

你可以在这里找到很棒的正则表达式： [http ://regexlib.com](http://regexlib.com)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-12T21:44:48.557

要存储在数据库中，您必须以某种方式单独跟踪更改并将它们发布回服务器。我建议使用 HiddenInput 控件。

# c# - 最佳实践：如何公开只读 ICollection

> ID：285323
> 
> 赞同：10
> 
> 时间：2008-11-12T20:50:27.310
> 
> 标签：c#, collections, c#-2.0

我的课堂上有一个`ICollection<T>`电话`foos`，我想将其公开为只读（请参阅[此问题](https://stackoverflow.com/questions/284090/how-to-get-a-readonlycollectiont-of-the-keys-in-a-dictionaryt-s)）。我看到接口定义了一个属性，这似乎很合适......我的问题是：我如何让只读`.IsReadOnly`类的消费者显而易见？`foos`

我不想依赖他们`.IsReadOnly`在尝试未实现的方法（例如`.Add()`. 理想情况下，我想公开`foos`为`ReadOnlyCollection<T>`，但它没有实现`IList<T>`. `foo`例如，我应该通过一个名为的方法`GetReadOnlyFooCollection`而不是通过一个属性来公开吗？如果是这样，这不会让那些期待 a 的人感到困惑`ReadOnlyCollection<T>`吗？

这是 C# 2.0，所以像这样的扩展方法`ToList()`不可用......

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-12T21:00:04.983

您可以像这样使“foos”成为 ReadOnlyCollection：

```
ReadOnlyCollection<T> readOnlyCollection = foos.ToList<T>().AsReadOnly(); 
```

然后你可以将它作为你的类的属性公开。

编辑：

```
 class FooContainer
    {
        private ICollection<Foo> foos;
        public ReadOnlyCollection<Foo> ReadOnlyFoos { get { return foos.ToList<Foo>().AsReadOnly();} }

    } 
```

注意：您应该记住，一旦您获得 ReadOnlyFoos 集合，就不再与您的 foos ICollection“同步”。请参阅[您引用的线程](https://stackoverflow.com/questions/284090/how-to-get-a-readonlycollectiont-of-the-keys-in-a-dictionaryt-s)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-12T21:01:06.617

我的建议是直接为场景返回使用 ReadOnlyCollection<T>。这使得调用用户的使用明确。

通常我会建议使用适当的界面。但鉴于 .NET Framework 当前没有合适的 IReadOnlyCollection，您必须使用 ReadOnlyCollection 类型。

使用 ReadOnlyCollection 时也必须注意，因为它实际上不是只读的：[Immutability 和 ReadOnlyCollection](http://blogs.msdn.com/jaredpar/archive/2008/04/22/api-design-readonlycollection-t.aspx)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-09-20T19:34:04.480

自从写了问题，.NET 4.0 就增加了一个`IReadOnlyCollection<T>`接口；将其用作声明的返回类型可能会很好。

然而，这确实留下了返回什么类型的*实例的问题。*一种方法是克隆原始集合中的所有项目。另一种方法是始终返回只读包装器。第三种方法是返回原始集合（如果实现`IReadOnlyCollection<T>`）。每种方法在某些情况下都是最好的，但在其他情况下会不太理想（或者可能是彻头彻尾的可怕）。不幸的是，微软没有提供标准的方法来提出两个非常重要的问题：

1.  你是否承诺永远和永远包含与你现在一样的物品？

2.  您能否安全地直接接触不应修改内容的代码。

哪种包装方式是合适的取决于客户端代码期望对其接收到的东西做什么。一些需要避免的场景：

1.  提供的对象具有客户端将识别为不可变的类型，但不是直接返回，而是使用客户端不识别为不可变的类型进行复制。因此，客户端被迫再次复制该集合。

2.  提供了一个对象，其类型为客户端会识别为不可变，但在返回之前，它被包装成客户端无法判断集合是否不可变，因此被迫复制。

3.  一个不应该被改变的可变类型的对象由客户端提供（转换为只读接口）。然后它直接暴露给另一个客户端，该客户端确定它是可变类型并继续对其进行修改。

4.  接收到对可变集合的引用并将其封装在只读包装器中，然后再返回给需要不可变对象的客户端。返回集合的方法承诺它是不可变的，因此客户端拒绝制作自己的防御性副本。然后，客户对集合可能发生变化的可能性准备不足。

对于从某些客户端接收并需要向其他客户端公开的集合，对象实际上并没有任何特别“安全”的操作过程。在许多情况下，总是复制所有内容是最安全的做法，但它很容易导致根本不需要复制的集合最终被复制数百或数千次的情况。返回接收到的引用通常是最有效的方法，但它在语义上也可能是危险的。

我希望微软能添加一种标准方法，通过该方法可以向集合询问上述问题，或者更好的是，要求它们生成其当前状态的不可变快照。不可变集合可以非常便宜地返回其当前状态的不可变快照（仅返回自身），甚至某些可变集合类型也可以返回不可变快照，其成本远低于完整枚举的成本（例如，a`List<T>`可能由两个支持`T[][]`数组，其中一个包含对 256 个项目的可共享不可变数组的引用，另一个包含对 256 个项目的不可共享可变数组的引用。制作列表的快照只需要克隆包含自上次快照以来已修改的项目的内部数组 - 可能比克隆整个列表便宜得多。不幸的是，由于没有标准的“制作不可变快照”接口[注意这`ICloneable`不算，因为可变列表的克隆是可变的；虽然可以通过将可变克隆封装在只读包装器中来制作不可变快照，但这仅适用于可克隆的事物，甚至不可克隆的类型仍应支持“可变快照”功能。]

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-11T20:42:19.813

有时您可能想要使用接口，可能是因为您想在单元测试期间模拟集合。请参阅我的[博客条目](http://nicksdotnet.blogspot.com/2009/01/interfacing-readonlycollection.html)，了解如何使用适配器将您自己的接口添加到 ReadonlyCollection。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-11T20:54:40.797

我通常返回一个`IEnumerable<T>`.

一旦您将集合设为只读（这样的方法，例如`Add`,`Remove`并且`Clear`不再起作用），集合支持的可枚举不支持的所剩无几 - 我相信只有`Count`and `Contains`。

如果你的类的消费者真的需要像对待集合中的元素一样对待元素，传递一个`IEnumerable`to`List<T>`的构造函数就很容易了。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-07-30T06:50:48.130

我似乎已经决定返回 IEnumerable**并克隆对象。**

```
public IEnumerable<Foose> GetFooseList() {
   foreach(var foos in Collection) {
     yield return foos.Clone();
   }
} 
```

*   需要 Foos 上的克隆方法。

这不允许在集合中进行任何更改。请记住，ReadonlyCollection 是“泄漏的”，因为其中的对象可以更改，如另一篇文章中的链接中所述。

* * *

## 回答 #7

> 赞同：-4
> 
> 时间：2008-11-12T21:07:34.797

返回一个 T[]：

```
private ICollection<T> items;

public T[] Items
{
    get { return new List<T>(items).ToArray(); }
} 
```

# linux - 将安全消息添加到 RHEL 5 登录屏幕

> ID：285325
> 
> 赞同：1
> 
> 时间：2008-11-12T20:50:33.987
> 
> 标签：linux

配置 Red Hat Enterprise Linux 5 的登录屏幕显示大段文字的步骤是什么？

背景信息：该文本是我工作的公司要求在所有用户登录之前呈现给他们的安全警告。他们必须能够在登录之前阅读该文本。

我们正在使用 GDM，默认情况下它不会读取 /etc/issue。我在 /etc/gdm/custom.conf 的 [greeter] 部分下放置了一份文本副本。问题是文本显示在一行上并跑出屏幕。

有没有办法以纯文本形式呈现整个段落，而不必使用文本的渲染背景图像，例如这位 DOE 员工的做法？

使用图片示例：[http ://cc.jlab.org/docs/security/banners/linux-graphical-banner.html](http://cc.jlab.org/docs/security/banners/linux-graphical-banner.html)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-12T21:38:26.387

将文本放入文件中，并将 InfoMsgFile 指向该文件。

```
[greater]
InfoMsgFile=/etc/motd 
```

# sql - 插入语句中的问号

> ID：285343
> 
> 赞同：2
> 
> 时间：2008-11-12T20:56:09.560
> 
> 标签：sql, sql-server

我有一个如下所示的 SQL 查询：

```
INSERT INTO DB..incident
( 
    incident_number        --nvarchar(10)
)
VALUES 
(
    N'I?'
) 
```

有什么作用？在价值声明中做什么？

编辑:: 事实证明，通过插入时发生的触发器和自定义数据类型有一些有趣的事情（我们的数据库有点混乱。）给定正常设置，我已经适当地标记了答案。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-12T21:01:31.127

冒着听起来轻率的风险......没什么......它放了一个我？进入现场...试试这个...

```
DECLARE @TestTable TABLE (test NVARCHAR(10))

INSERT INTO @TestTable (
    test
) VALUES ( 
    N'I?' ) 

SELECT * 
FROM  @TestTable 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-12T21:09:36.447

当我读到这篇文章时，我脑海中的问题是，N 有什么作用？

在 Oracle 中，字符串文字前的 N 表示字符串应该以国家（即本地化）字符集编码，而不是数据库的默认字符集。

因此，正如其他人所说，您要插入字符串“我？” 入列。但是，它可能使用不同的字符集进行编码（尽管由于这些字符在标准 ASCII 范围内，结果可能是相同的）。

# c# - 底层连接被关闭：连接被意外关闭

> ID：285345
> 
> 赞同：16
> 
> 时间：2008-11-12T20:56:28.407
> 
> 标签：c#, asp.net, web-services, .net-3.5

在 SOAP 请求上始终抛出此异常，该请求需要将近三分钟才能接收，大小为 2.25 兆。

在网上搜索时，我发现各种帖子似乎都是关于在请求上设置标头，有些人希望我不发送“Expect：”标头，有些人希望我发送“Keep-Alive：”标头，但是不管我发送的标题如何，我仍然会收到这个讨厌的错误。我不相信设置任何标头是我的答案，因为*我可以使用“curl”重新创建完全相同的请求，并且响应最终会毫无问题地返回 what-so-ever*。

我的`<httpRuntime maxRequestLength="409600" executionTimeout="900"/>`.

我觉得好像我的选择已经不多了。如果有人可以提供任何帮助，我将不胜感激。其他一些需要注意的事情是，我从中请求数据的服务器不在我的控制范围内，这些请求也是通过 https 进行的，而其他响应较小的请求可以完美地工作。

谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-12T22:05:28.360

您将帖子标记为 .NET35，那么您在使用 WCF 吗？

如果是这样，以下是我们用于大型数据集的 App.config 示例：

```
<system.serviceModel>
    <bindings>
      <basicHttpBinding>
        <binding name="BasicHttpBinding" maxBufferSize="2147483647" maxReceivedMessageSize="2147483647">
          <readerQuotas maxDepth="32" maxStringContentLength="8388608" maxArrayLength="16384" maxBytesPerRead="4096" maxNameTableCharCount="16384" />
        </binding>
      </basicHttpBinding>
    </bindings>
    <client>
      <endpoint address="http://localhost:1602/EndPoint.svc" binding="basicHttpBinding" bindingConfiguration="BasicHttpBinding" contract="IEndPointContract" name="EndPoint" behaviorConfiguration="EndpointBehaviour" />     
    </client>
    <behaviors>
      <endpointBehaviors>
        <behavior name="EndpointBehaviour">
          <dataContractSerializer maxItemsInObjectGraph="2147483647" />
        </behavior>
      </endpointBehaviors>
    </behaviors>
  </system.serviceModel> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-16T21:04:46.097

I hope it's not too late for answering this question.

Try adding the following attribute on the definition of your contract interface:

```
[ServiceKnownType(typeof(ReturnClass))]
```

For more generic solution that allows returning polymorphic classes please refer to this post: [](http://www.goeleven.com/blog/entryDetail.aspx?entry=45)[http://www.goeleven.com/blog/entryDetail.aspx?entry=45](http://www.goeleven.com/blog/entryDetail.aspx?entry=45)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-11-19T09:15:11.540

如果您使用 dbml 而不是 edmx，您将得到这个（底层连接已关闭：连接已意外关闭。）因为 dbml 不会返回它需要数据合同的可序列化数据，因此请转到 dbml 文件的属性并将序列化模式更改为单向.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-08-02T09:16:46.230

我有同样的问题，经过深入调查，我发现了这篇文章：

[Merrick Chaffer 的博客](http://consultingblogs.emc.com/merrickchaffer/archive/2007/09/19/WCF-System.Net.WebException_3A00_-The-underlying-connection-was-closed_3A00_-The-connection-was-closed-unexpectedly.aspx)

这一切都与为客户端和服务器设置“dataContractSerializer”有关。希望这会有所帮助。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-06-26T13:17:44.287

尝试了几种方法来消除此错误消息，直到我找到此解决方案：http: [//kiranpatils.wordpress.com/2008/09/22/the-underlying-connection-was-closed-the-connection-was-closed-从 wcf 服务返回数据表时意外地/](http://kiranpatils.wordpress.com/2008/09/22/the-underlying-connection-was-closed-the-connection-was-closed-unexpectedly-while-returning-data-table-from-wcf-service/)

您可以将 List<> 更改为 DataSet。我怀疑 DataSet 可以处理比 List<> 更多的数据。

希望能帮助到你。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-01-14T14:38:47.307

我收到此错误是因为我的 datatransfereobjects 以递归方式相互引用。

例如：

客户->（有）->评级评级->（属于）->客户

所以你必须删除循环。

```
[DataContract]
public class Rating
{
    private Customer _customer;
    //[DataMember] // <-  EITHER HERE 
    public Customer Customer
    {
        get { return _customer; }
        set { _customer = value; }
    }
}

[DataContract]
public class Customer
{
    private long _customerID;
    [DataMember]
    public long CustomerID
    {
        get { return _customerID; }
        set { _customerID = value; }
    }

    [DataMember] // <- OR HERE
    public Rating Rating
    {
        get { return _rating; }
        set { _rating = value; }
    }
} 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-11-12T21:03:29.780

您是否尝试过[此博客文章](http://weblogs.asp.net/jan/archive/2004/01/28/63771.aspx)的建议？问题很可能在于 .NET 的 TCP/HTTP 堆栈实现。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2011-09-20T08:21:03.070

我添加了另一个字段，但该属性没有设置。那是我对相同错误的解决方案。

```
[DataMember]
public bool HasValue
{
    get { return true; }
    set { }//adding this line made the solution.
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-07-15T11:45:24.820

如果存在内部错误，这是一个一般错误。

尝试在此处添加跟踪：http: [//msdn.microsoft.com/en-us/library/ms732023 (v=vs.110).aspx](http://msdn.microsoft.com/en-us/library/ms732023(v=vs.110).aspx)

然后您将看到完整的日志。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-11-27T18:53:35.073

对于带有 EF 的 WCF，只需在上下文类中添加以下代码。

base.Configuration.ProxyCreationEnabled = false;

# events - VB6 Combo box events

> ID：285359
> 
> 赞同：10
> 
> 时间：2008-11-12T20:59:41.737
> 
> 标签：events, vb6, combobox

I have a form in VB6 with two combo boxes (cboCustomer and cboItemNumber). When someone selects a value from cboCustomer, I want to populate cboItemNumber with a list of item numbers relevent to the customer selected. What event does VB6 offer that I can use? I've tried _Change and _LostFocus and neither are doing what I need. I find it hard to believe that I'm having such a difficult time finding a list of possible events.

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-11-12T21:02:38.020

Try the _Click event. This event fires even if the control is't actually clicked on. For example, if you tab in to it and use the up/down arrow keys to change the selected item, the click event still fires.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-13T09:32:45.073

As G Mastros says, the _Click event is the one to use, since it fires when the selection is changed via either keyboard or mouse.

If you want to see a list of all the events, then use the Object Browser (F2), and search for or browse to ComboBox. Events are shown with yellow lightning bolts in the Members pane.

# c++ - 如何为 Microsoft Excel 创建过滤器？

> ID：285367
> 
> 赞同：1
> 
> 时间：2008-11-12T21:01:49.143
> 
> 标签：c++, excel

我想在 Excel 的“打开”对话框中添加文件类型扩展名（如果可能，2003、2007，如果需要，仅 2007）。

当用户打开我的文件类型（即 myfile.myx）时，我希望我的应用程序以我自己定义的方式读取文件并将文件粘贴到 Excel 中（通过使用互操作）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-27T09:56:34.747

我认为你在这里不走运。没有使用自定义导入过滤器扩展 Excel 的记录方法（据我所知）。这样的转换器接口仅适用于 Word ( [http://support.microsoft.com/kb/111716](http://support.microsoft.com/kb/111716) )。

如果要修改文件打开对话框，可以尝试对对话框进行子类化。这适用于 Windows 通用对话框（有关示例，请参见[http://www.codeproject.com/KB/dialog/customize_dialog.aspx](http://www.codeproject.com/KB/dialog/customize_dialog.aspx)），但我认为 Office 对话框使用不同的消息，可能不允许您执行此操作。

# c++ - 自动类模板？

> ID：285372
> 
> 赞同：3
> 
> 时间：2008-11-12T21:02:38.533
> 
> 标签：c++, templates

有没有办法让编译自动推导出模板参数？

```
template<class T> 
struct TestA 
{
    TestA(T v) {} 
};
template<class T>
void TestB(T v)
{
}
int main()
{
    TestB (5);
} 
```

测试 B 工作正常，但是当我将其更改为 TestA 时，它不会编译并出现错误“使用类模板需要模板参数列表”

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-12T21:04:52.367

不，没有。永远不会推导出类模板。通常的模式是有一个`make_`自由函数：

```
template<class T> TestA<T> make_TestA(T v)
{
    return TestA<T>(v);
} 
```

参见`std::pair`和`std::make_pair`，例如。

在 C++0x 中，你将能够做到

```
auto someVariable = make_TestA(5); 
```

以避免必须指定局部变量的类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-12T22:03:41.717

Sunlight 是对的，但如果我可以问你一个问题：这真的是你的代码中的一个问题。我是说：

```
TestA(5); 
```

会成为

```
TestA<int>(5); 
```

只要它只是一个模板参数，它就不是那么糟糕，恕我直言。在大多数情况下，您无法一次输入类型。

# apache - 如何让 mod_rewrite 抑制处理更多规则？

> ID：285383
> 
> 赞同：4
> 
> 时间：2008-11-12T21:05:38.670
> 
> 标签：apache, .htaccess, mod-rewrite

鉴于我当前的 .htaccess 文件，我将如何修改它以检查额外的 URL 路径，如“/src/pub/ *”并将其重写为“/* ”而不影响当前的重写？

这是原始的 .htaccess 文件：

```
RewriteEngine on

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d

RewriteRule ^(.*)$ index.php?route=$1 [L,QSA] 
```

这是我最近的尝试（不起作用）：

```
RewriteEngine on

RewriteRule ^/src/pub/(.*)$ /$1 [R]

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d

RewriteRule ^(.*)$ index.php?route=$1 [L,QSA] 
```

**编辑：**以下是我想要完成的一些示例：

新的附加规则：

```
From:  http://www.mysite.com/src/pub/validfile.php
To:    http://www.mysite.com/validfile.php

From:  http://www.mysite.com/src/pub/user/detail/testuser
To:    http://www.mysite.com/user/detail/testuser 
```

现有规则（已经生效）：

```
From:  http://www.mysite.com/user/detail/testuser
To:    http://www.mysite.com/index.php?route=user/detail/testuser 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-12T21:20:20.090

我猜测问题在于 URL 正在被第一条规则重写，然后又被第二条规则重写。

解决方案是在第一条规则中添加“last”标志，如下所示：

```
RewriteRule ^/src/pub/(.*)$ /$1 [R,L] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-12T21:25:02.123

在 .htaccess 文件中，改用它：

```
RewriteRule ^src/pub/(.*)$ /$1 [R] 
```

如果您希望停止处理进一步的规则，则前导“/”将在 .htaccess 内**不**`httpd.conf`匹配，仅在（[src](http://httpd.apache.org/docs/2.0/mod/mod_rewrite.html#rewriterule)`L` - 页面底部）内匹配，然后添加标志：

```
RewriteRule ^src/pub/(.*)$ /$1 [L,R] 
```

重写日志比较（.htaccess 上下文）：

```
// using ^/src/pub/(.*)$ - leading slash will not work in .htaccess context!
(1) pass through /home/test/src

// using ^src/pub/(.*)$
(2) rewrite 'src/pub/testme' -> '/testme'
(2) explicitly forcing redirect with http://test/testme
(1) escaping http://test/testme for redirect
(1) redirect to http://test/testme [REDIRECT/302] 
```

# c# - Web服务内存泄漏的原因

> ID：285392
> 
> 赞同：2
> 
> 时间：2008-11-12T21:08:17.710
> 
> 标签：c#, web-services, .net-3.5, memory-leaks

我们有一个 Web 服务，它使用越来越多的私有字节，直到该应用程序停止响应。托管堆（主要是 Gen2）将显示大约 200-250 MB，而私有字节显示超过 1GB。托管堆外内存泄漏的可能原因是什么？

我已经检查了以下内容：

1.  多产的动态程序集（Xml 序列化、正则表达式等）
2.  会话状态（关闭）
3.  System.Policy.Evidence 内存泄漏（已安装 SP1）
4.  线程死锁（不使用Join，只使用锁）
5.  SQLOLEDB的使用（使用SqlClient）

我可以检查哪些其他来源？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-12T21:15:24.623

确保您的应用在发布模式下符合要求。如果您在调试模式下编译并部署它，只需实例化一个定义了事件的类（甚至不需要引发事件），将导致一小块内存泄漏。在足够长的时间内实例化足够多的这些对象将导致所有内存都被使用。我见过 Web 应用程序会在几个小时内耗尽所有内存，这仅仅是因为使用了调试版本。立即编译为发布版本并永久修复了该问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T20:28:47.143

直到由于可用内存不足而拒绝内存请求时，垃圾收集才会运行。当一个人不在时，这通常会使事情看起来像内存泄漏。

服务中是否有任何事件和事件处理程序？服务通常有静态变量，如果你从静态实例创建事件处理程序，连接到非静态实例对象，静态将永远持有对实例的引用，这将阻止它释放。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-12T22:01:23.593

同时寻找：

*   正在加载的 COM 程序集
*   数据库连接未关闭
*   缓存和状态（会话、应用程序）

尝试强制垃圾收集器 (GC) 运行（编写一个在加载时执行此操作的页面）或尝试检测，但根据我的经验，这有点命中注定。另一件事是让它保持运行，看看它是否内存不足。

可能发生的情况是内存充足，而 Windows 没有发出要清理您的应用程序的信号。这导致应用程序看起来使用越来越多的内存，因为它可以，而实际上系统可以在需要时回收内存。SQL Server 和 Exchange 经常这样做。这个想法是为什么在有大量资源时导致不必要的清理。

抢

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-12T22:20:51.077

我建议您在不同时间查看堆栈的快照，并查看哪些内容正在耗尽内存。如果您的应用程序使用 Java，那么 jmap 工作得非常好——您只需为其提供 java 进程的 PID。

如果使用其他东西，请尝试 Lambda Probe ( [http://www.lambdaprobe.org/d/index.htm](http://www.lambdaprobe.org/d/index.htm) )。它没有显示太多细节，但至少会显示内存使用情况。

我的 JDBC 代码中存在严重的内存泄漏，最终被追踪到几年前我错过的 JDBC 规范的更改（关于关闭语句等）。它结合了 Lamdba Probe 和 jmap 来定位问题，足以解决它。

干杯，

-R

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-11T14:22:57.663

仔细检查是否未启用跟踪。我已经看到跟踪实例缓慢消耗内存，直到应用程序达到其应用程序池限制。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-01-15T06:59:13.723

对于它的价值，我的问题不在于服务，而在于调用它的 HttpClient。

客户端未正确处理，因此它保持连接打开并锁定内存。

处理客户端后，服务按预期释放内存。

# sql - ORACLE SQL：一个语句中的多个 SUMS 依赖于 CODE

> ID：285394
> 
> 赞同：1
> 
> 时间：2008-11-12T21:09:01.767
> 
> 标签：sql, oracle, plsql, oracle10g

我相信有一种方法可以做到这一点，但我不像许多其他人那样熟悉 ORACLE 10g。这是场景：

我目前正在将经典 ASP 页面转换为 ASP.net 2.0。我有一个正在创建报告的查询。它报告销售额与以前的销售额。目前正在发生的事情是，一个查询将发送到数据库并获取销售我们产品的位置的完整列表。然后，它遍历位置的每一行，并在 SQL 中运行一些求和操作。

它输出到其他几个表，汇总销售数量，然后将总和添加到表行等。由于位置查询返回大量结果，因此查询需要 2-3 分钟。

我的问题是如何将所有这些整合到一个查询中。

地点查询：

```
SELECT DISTINCT t.location, 
  l.city, 
  f.year, 
  f.customer FROM loc t, 
location l, father_table f 
WHERE f.number = t.number(+) 
AND f.code = '0001' 
AND f.c_code = '01' 
AND t.location= l.code(+) 
AND t.code IN ('C', 'S') 
AND t.co_code IN ('G', 'V', 'A', 'D') 
AND t.year = '2008' 
ORDER BY l.city, f.year 
```

上述查询中每一行的总和查询如下：

```
SELECT SUM(nvl(t.sale_quantity,0)) sale_quantity 
FROM loc t, father_table f  
WHERE f.number = t.number(+) 
AND f.code = '0001' 
AND f.c_code = '01'
AND f.year = '2008' 
AND t.code = 'C' 
AND t.location = '1566' <----- EACH ROW'S t.location VALUE
AND t.co_code IN ('G', 'V', 'A', 'D') 
GROUP BY t.location, t.code, f.year 
```

不是循环遍历原始查询的每条记录，有没有一种方法可以组合查询并在 Location 的查询中使用 SUM。这里的关键是第二个查询仅在 t.code = 'C' 而不是 'C' & 'S' 时获取销售 SUM

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-12T21:15:41.440

我认为这可以满足您的要求。如果不完全正确，我认为您需要了解的关键是 CASE 表达式；这是一种在 SUM 函数中进行过滤的方法。

```
SELECT t.location, 
  l.city, 
  f.year, 
  f.customer,
  SUM( NVL( CASE WHEN t.code ='C' THEN t.sale_quantity ELSE 0 END, 0)) sale_quantity
FROM loc t, location l, father_table f 
WHERE f.number = t.number(+) 
AND f.code = '0001' 
AND f.c_code = '01' 
AND t.location= l.code(+) 
AND t.code IN ('C', 'S') 
AND t.co_code IN ('G', 'V', 'A', 'D') 
AND t.year = '2008' 
GROUP BY t.location, l.city, f.year
ORDER BY l.city, f.year 
```

# security - Win32：如何从标准用户使用 RegisterTypeLib API

> ID：285400
> 
> 赞同：6
> 
> 时间：2008-11-12T21:09:40.127
> 
> 标签：security, winapi

Win32 API 调用[RegisterTypeLib()](http://msdn.microsoft.com/en-us/library/ms221570.aspx)用于创建注册类型库所需的注册表项。

不幸的是，在 Windows XP 上，它会尝试将这些注册表项写入

```
HKEY_CLASSES_ROOT\TypeLib 
```

而不是

```
HKEY_CURRENT_USER\Software\Classes\TypeLib 
```

这意味着标准用户将无法运行 ActiveX。

2008 年 5 月，Microsoft 发布了[针对 Vista 的修补程序](http://support.microsoft.com/kb/935200)以纠正此问题 - 但问题仍然存在于 Windows XP 中。

标准用户友好的开发人员应该做什么？

* * *

## 答案 1

使用为其设计的 API 调用：

[RegisterTypeLibraryForUser()](http://msdn.microsoft.com/en-us/library/ms221504.aspx)

## 答案 2

如果您无法修复它，请破解它：

```
//begin hack
HKEY key;
RegOpenKeyW(HKEY_CURRENT_USER, @"Software\Classes", out key);
RegOverridePredefKey(HKEY_CLASSES_ROOT, key);

//do original work
RegisterTypeLibrary(...)

//stop hacking
RegOverridePredefKey(HKEY_CLASSES_ROOT, null);
RegCloseKey(key); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-12T21:31:27.510

看看我写的这篇博文。它将使用 RegOverridePredefKey 将 ATL COM 对象注册到 HKCU 而不是 HKCR。您可以使用相同的技术调用 RegisterTypeLib 并让它在 HKCU 下正确注册

[将 ATL 注册为普通用户](http://blogs.msdn.com/jaredpar/archive/2005/05/29/423000.aspx)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-12T21:32:02.750

您可以使用`RegOverridePredefKey()`API 将`HKEY_CLASSES_ROOT`regtree 映射到`HKEY_CURRENT_USER\Software\Classes`：

*   [`http://msdn.microsoft.com/en-us/library/ms724901.aspx`](http://msdn.microsoft.com/en-us/library/ms724901.aspx)

# c# - 检测应用程序焦点更改/挂钩 HWND 更改？

> ID：285406
> 
> 赞同：4
> 
> 时间：2008-11-12T21:10:58.970
> 
> 标签：c#, focus, hwnd

我如何检测任何应用程序何时失去焦点？是否有任何系统挂钩可以使用？当一个新应用程序成为焦点或丢失一个应用程序时，我想接听。即使拥有用户的“当前” HWND 也会很好。

我正在使用 C#，但是，我确信它都是赢 api 的东西......所以任何信息都会很棒。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-12T22:04:31.483

用于`SetWindowsHookEx`设置一个`WH_CALLWNDPROC`或`WH_CALLWNDPROCRET`全局挂钩，并查找`WM_SETFOCUS`和或`WM_KILLFOCUS`消息。

# python - Python模块从字符串中提取可能的日期？

> ID：285408
> 
> 赞同：13
> 
> 时间：2008-11-12T21:11:25.553
> 
> 标签：python

我正在寻找一个 Python 模块，它可以接收任意文本块，在其中搜索看起来像日期字符串的内容，然后从中构建一个 DateTime 对象。Perl 中的[Date::Extract](http://search.cpan.org/~sartak/Date-Extract-0.03/lib/Date/Extract.pm)之类的东西

先感谢您。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-12T22:46:58.947

最接近的等价物可能是[dateutil](http://labix.org/python-dateutil)模块。用法是：

```
>>> from dateutil.parser import parse
>>> parse("Wed, Nov 12")
datetime.datetime(2008, 11, 12, 0, 0) 
```

使用模糊参数应该忽略无关的文本。IE

```
>>> parse("the date was the 1st of December 2006 2:30pm", fuzzy=True)
datetime.datetime(2006, 12, 1, 14, 30) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-12T23:02:35.517

为什么不尝试[parsedatetime](http://code.google.com/p/parsedatetime/)？

# nunit - 运行 NUnit 时获取 2.0 版本不是兼容版本

> ID：285418
> 
> 赞同：1
> 
> 时间：2008-11-12T21:17:57.380
> 
> 标签：nunit

我正在尝试运行[NUnit](http://en.wikipedia.org/wiki/NUnit)的示例测试，但出现错误。我将`supportedRuntime`版本设置为 v1.0.3705 到 v2.0.50727。我将`requiredRuntime`版本设置为 v2.0.50727。这是错误的设置吗？

以下是显示的错误：

> 无法打开元数据文件“c:\Program Files\NUnit 2.4.8\bin\nunit.framework.dll”——“2.0 版不是兼容版本。”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-10T17:44:22.000

我在 VS2005“开箱即用”的 2.4.8 中的 CSharp 示例中遇到了同样的问题。这是我的解决方案。

在 nunit.exe.config 中，以下块默认被注释掉。放回去。

```
 <startup>
  <supportedRuntime version="v2.0.50727" />
  <supportedRuntime version="v2.0.50215" />
  <supportedRuntime version="v2.0.40607" />
  <supportedRuntime version="v1.1.4322" />
  <supportedRuntime version="v1.0.3705" />

  <requiredRuntime version="v1.0.3705" />

  </startup> 
```

听起来您这样做了，但是将 requiredRuntime 从默认的 v1.0.3705 更改为 v2.0.50727

之后，我在VS2005中打开了CSharp项目并进行了转换。nunit.framework 引用都有一个图标，表明它们是错误的。所以我从所有 4 个项目中删除了 nunit.framework 引用： cs-failures cs-money cs-money-port cs-syntax

然后我添加了对 C:\Program Files\NUnit 2.4.8\bin\nunit.framework.dll 的新引用来替换它们。

之后，项目构建良好。

# html - 样式 html 文本输入大小以匹配其内容

> ID：285421
> 
> 赞同：2
> 
> 时间：2008-11-12T21:20:21.743
> 
> 标签：html, css, printing

我在这里问了一些关于这个系统的[其他问题](https://stackoverflow.com/questions/150513/html-input-style-to-hide-the-box-but-show-the-contents)，所以我会尽量避免重复很多细节。

简短的版本是我有许多 html 页面，每个页面都有一个接受输入的表单，但从不将输入保存在任何地方——它们只被打印出来用于邮寄。一位从未听说过的以前的开发人员`@media print`对其中的大多数进行了初步工作，因此他想出了一些......*奇怪*的解决方案来隐藏打印页面上丑陋的文本框，通常会导致两个完全独立的副本几乎相同的html。不幸的是，这在很多情况下都破坏了后退按钮，所以现在我必须回去修复它们。

* * *

在某些情况下，这些 html 表单实际上是套用信函，在文本中间有文本输入。我可以设置文本输入的样式，使框不显示，但它们的大小仍然错误。这会导致一堆不属于它的额外丑陋的空白。如何使输入适合用户输入的文本？

目前我能想到的最好的方法是在每个输入旁边有一个隐藏的 <span> ，它的样式是在打印时显示而不是输入，并使用 javascript 保持同步。但这很丑陋。我正在寻找更好的东西。

**更新：**
我们的大多数用户仍在使用 IE6，但我们有一些 IE7 和 Firefox。

**Update2：**
我重新考虑了一下使用标签而不是跨度。我将使用标签的`for`属性来维护这种关系。请参阅[此问题](https://stackoverflow.com/questions/285522/find-html-label-associated-with-a-given-input)以获取我的最终代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-12T21:25:52.497

跨度的想法还不错。使用像[jquery](http://jquery.com)这样的 Javascript 库，一个 1-2 行的 Javascript 函数可以动态地将所有适当的`<input>`标签替换为`<span>..</span>`. 您不必自己输入任何跨度。

在带有 jquery 的非常粗糙的伪 JavaScript 代码中，它将类似于：

```
function replaceInputsOnSomeButtonClick() {
 // Find all inputs, wrap value with span tag, remove the input tag
 $("input").text().wrap("<span>").remove();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-12T23:42:05.717

CSS对此没有答案。输入是“被替换的元素”——CSS 中的一个黑盒子。

`input {content:attr(value)}`仅适用于 HTML 中的初始值，不会反映任何以后的更改。

所以你能得到的最好的就是不那么丑陋的 Javascript。

```
for(var i=0; i < form.elements.length; i++)
{
   var input = form.elements[i]; 
   if (input.type != 'text') continue;

   var span = document.createElement('span');
   input.parentNode.insertBefore(span,input);

   span.className = 'show-in-print';
   input.className = 'hide-in-print';

   input.onchange = (function(span){ // trick to preserve current value of span
      return function()
      {
         if (span.firstChild) span.removeChild(span.firstChild);
         span.appendChild(document.createTextNode(this.value));
      }
   })(span);
} 
```

# c# - Visual Studio C# 语句崩溃

> ID：285422
> 
> 赞同：182
> 
> 时间：2008-11-12T21:20:35.097
> 
> 标签：c#, visual-studio

在编辑非常长的代码块时（无论如何都应该重构，但这超出了这个问题的范围），我经常渴望能够像折叠功能块一样折叠语句块。也就是说，如果减号图标出现在大括号中的所有内容的代码大纲上，那就太好了。它似乎出现在函数、类、区域、命名空间、使用中，但不适用于条件或迭代块。如果我可以折叠 ifs、switches、foreaches 之类的东西，那就太棒了！

谷歌搜索了一下，我发现显然 VS 中的 C++ 大纲允许这样做，但 VS 中的 C# 大纲不允许。我真的不明白为什么。如果我选择 C# 格式，即使记事本 ++ 也会崩溃，所以我不明白为什么 Visual Studio 不这样做。

有谁知道可以启用此行为的 VS2008 插件？还是某种隐藏的设置？

编辑添加：插入区域当然是一个选项，它确实已经发生在我身上，但坦率地说，我不应该将东西包裹在已经包裹在大括号中的区域中......如果我要编辑现有代码，无论如何我都会重构它以更好地分离关注点。（用新方法而不是区域“包装”；）

* * *

## 回答 #1

> 赞同：269
> 
> 时间：2011-03-04T09:59:22.973

从 Visual Studio 2017 开始，语句折叠是内置的。

从 VS 2010 版本开始，有几个扩展可以为 2017 之前的 VS 版本执行此任务：

*   [C# 大纲](http://visualstudiogallery.msdn.microsoft.com/4d7e74d7-3d71-4ee5-9ac8-04b76e411ea8)
*   [C# 大纲 2012 (@MSDN)](https://visualstudiogallery.msdn.microsoft.com/bc07ec7e-abfa-425f-bb65-2411a260b926)
*   [C# 大纲 2013 (@MSDN)](https://visualstudiogallery.msdn.microsoft.com/6c3c5dec-1534-4c42-81b1-cfd4615fd0e9)
*   [C# 大纲 2015 (@MSDN)](https://visualstudiogallery.msdn.microsoft.com/9390e08c-d0aa-42f1-b3d2-5134aabf3b9a)
*   [Visual Basic 和 C# 大纲](https://visualstudiogallery.msdn.microsoft.com/699ecb9d-bd8f-4f6b-b290-05c42407b43e)

最后一个扩展只支持 VS 2015 和 VS 2017，但它是最强大的。
它支持折叠块内的语法着色，更容错和优化。

> 如果在您使用浏览器下载后似乎没有安装扩展，请尝试使用内置的 Visual Studio 扩展管理器。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2008-11-12T21:23:22.813

我不知道加载项，但你提到了区域，我认为做这样的事情没有错......

```
foreach (Item i in Items)
{
  #region something big happening here
  ...
  #endregion

  #region something big happening here too
  ...
  #endregion

  #region something big happening here also
  ...
  #endregion
} 
```

编辑：回答问题的编辑：你是对的，到处粘贴一堆区域并不理想，重构可能是要走的路。但是您似乎正在寻找可以为您“组织”代码的神奇东西，而我认为这不存在。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2008-11-12T21:44:14.800

您可以在 Visual Studio 中折叠特定的文本块，但您必须关闭自动大纲。

右键单击您的代码窗口并选择（大纲|停止大纲）

然后，选择一些文本，右键单击并选择（大纲|隐藏选择）

当您再次打开自动大纲时，您的自定义“区域”将不再折叠。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-12T21:27:34.413

只要您将它们保持在相同的代码层次级别，Visual Studio 2008 就支持函数内部的区域

```
#region Won't work
for(int i = 0; i<Count; i++)
{
//do something
#endregion
}

for(int i=0; i<Count; i++)
{
#region Works fine
//do lots of stuff
#endregion
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-04-11T07:06:37.310

让我说点不同的：按`(ctrl+m,ctrl+h)`或在编辑>大纲>隐藏选择中非常有用。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-07-19T20:14:57.210

此功能已添加到 Visual Studio 2010 的 C# 编辑器中。我找不到验证它实际被放入的源，但我记得在 Dev 10 团队成员的一个博客上看到它谈论自 Beta 1 或其他东西以来的变化。[作为安慰，这里有一条微软评论暗示他们想要添加它。](http://social.msdn.microsoft.com/Forums/en-US/vs2010ctpcpp/thread/6f3d4fed-55fd-4280-9a9b-62f0be1e462d)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-12T22:13:10.107

我将在这里补充一点，在 VS 2010 中，Microsoft 使用托管可扩展性框架 (MEF) 添加了 WPF 装饰器功能，这将允许我们扩展源代码编辑器以更好地组织它们，使其更具可读性和可访问性。

例如，[Scott Gu 在 PDC 2008 上演示](http://channel9.msdn.com/pdc2008/KYN02/)的 Summary Comments 可视化器。

所以期待开发者的美好明天:)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-08-05T21:26:39.780

Coderush 将为您概述所有代码块。不确定它是否允许您展开/折叠块，但大纲是下一个最好的事情。我使用 resharper 而不是 coderush，据我所知，它也不提供块折叠:(

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-08-26T21:42:36.557

我为 Visual Studio 2013 找到了这个，发现它很有帮助。即使您使用 { ..... } 在代码周围放置简单的大括号，它也可以工作

分享后我发现其他人也提到了这个链接。我的投票也支持这个工具。

[Visual Studio 2013 的 C# 大纲工具](http://visualstudiogallery.msdn.microsoft.com/6c3c5dec-1534-4c42-81b1-cfd4615fd0e9)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-01-19T16:11:42.910

在VS2017中可以高亮一段代码，右键，大纲>隐藏选择。这将折叠代码并提供一个切换到突出显示的部分。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-10-25T05:46:01.860

在 Visual Studio 2019 中，如果要折叠`catch`&中的大括号`finally`，请折叠、折叠`switch`、`case`折叠`default`多行`comments`等。

尝试使用[C# 大纲 2019](https://marketplace.visualstudio.com/items?itemName=Coutline2019.xyz0835-coutline2019)

* * *

## 回答 #12

> 赞同：-2
> 
> 时间：2009-07-18T03:03:30.207

# region ,#endregion 是明智的选择。

# events - 是否有在 webcontrol 呈现事件之后运行的页面事件？

> ID：285423
> 
> 赞同：0
> 
> 时间：2008-11-12T21:20:42.383
> 
> 标签：events, rendering

我已经尝试过 PreRenderComplete 并且卸载为时已晚

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-12T21:24:08.117

通常，控件的“渲染”之后的唯一事件是“卸载”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-12T22:04:34.290

受保护的覆盖无效渲染（HtmlTextWriter writer）{base.Render（writer）;

....在这里放置代码

# javascript - 如何仅在提交时显示 jQuery 验证错误容器

> ID：285428
> 
> 赞同：15
> 
> 时间：2008-11-12T21:23:04.967
> 
> 标签：javascript, jquery

我正在尝试使[验证插件](http://docs.jquery.com/Plugins/Validation)工作。它适用于单个字段，但是当我尝试包含包含所有错误的错误容器的演示代码时，我遇到了问题。问题是，当我在所有字段中时，它会显示包含所有错误的容器，但我只想在用户按下提交按钮时显示错误容器（但在失去焦点时仍会在控件旁边显示内联错误）。

问题是容器中的消息。当我按照下面的容器答案中提到的代码删除代码时，容器输出仅以纯文本形式显示错误数量。

获取详细错误消息列表的技巧是什么？我想要的是当用户按下选项卡按钮时错误地在控件旁边显示“错误”，并在他按下提交时对所有内容进行总结。那可能吗？

**来自此处的所有输入的代码：**

```
 $().ready(function() {
        var container = $('div.containererreurtotal');

        // validate signup form on keyup and submit
        $("#frmEnregistrer").bind("invalid-form.validate", function(e, validator) {
          var err = validator.numberOfInvalids();
          if (err) {
            container.html("THERE ARE "+ err + " ERRORS IN THE FORM")
            container.show();
          } else {
            container.hide();
          }
        }).validate({
                    rules: {
                            nickname_in: {
                                    required: true,
                                    minLength: 4
                            },
                            prenom_in: {
                                    required: true,
                                    minLength: 4
                            },
                            nom_in: {
                                    required: true,
                                    minLength: 4
                            },
                            password_in: {
                                    required: true,
                                    minLength: 4
                            },
                            courriel_in: {
                                    required: true,
                                    email: true
                            },
                            userdigit: {
                                    required: true
                            }
                    },
                    messages: {
                            nickname_in: "ERROR",
                            prenom_in: "ERROR",
                            nom_in: "ERROR",
                            password_in: "ERROR",
                            courriel_in: "ERROR",
                            userdigit: "ERROR"
                    }

                    ,errorPlacement: function(error, element){
                            container.append(error.clone());
                            error.insertAfter(element);
                    }

            });
    }); 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-06-04T22:22:35.847

首先，您的容器应该使用 ID 而不是类..（我将假设 ID 是“containererreurtotal”）

然后试试这个..

```
 $().ready(function() {

        $('div#containererreurtotal').hide();

        // validate signup form on keyup and submit
        $("#frmEnregistrer").validate({
            errorLabelContainer: "#containererreurtotal",
            wrapper: "p",
            errorClass: "error",
            rules: {
                nickname_in: { required: true, minLength: 4 },
                prenom_in: { required: true, minLength: 4 },
                nom_in: { required: true, minLength: 4 },
                password_in: { required: true, minLength: 4 },
                courriel_in: { required: true,  email: true },
                userdigit: { required: true }
            },
            messages: { 
                nickname_in: { required: "Nickname required!", minLength: "Nickname too short!" },
                prenom_in: { required: "Prenom required!", minLength: "Prenom too short!" },
                nom_in: { required: "Nom required!", minLength: "Nom too short!" },
                password_in: { required: "Password required!", minLength: "Password too short!" },
                courriel_in: { required: "Courriel required!", email: "Courriel must be an Email" },
                userdigit: { required: "UserDigit required!" }
            },
            invalidHandler: function(form, validator) {
                $("#containererreurtotal").show();
            },
            unhighlight: function(element, errorClass) {
                if (this.numberOfInvalids() == 0) {
                    $("#containererreurtotal").hide();
                }
                $(element).removeClass(errorClass);
            }    

        });
    }); 
```

我在这里假设您希望在每个单独的错误周围都有一个 <p> 标记。通常我对实际容器使用 <ul> 容器（而不是您使用的名为 'containererreurtotal' 的 div）和每个错误的 <li> （此元素在“包装器”行中指定）

如果您指定 #containererreurtotal 作为 display: none; 在你的CSS中，那么你不需要准备函数中的第一行（ $('div#containererreurtotal').hide(); ）

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-11-13T10:46:07.780

您将在[http://docs.jquery.com/Plugins/Validation/validate#toptions中找到 meta 选项的文档](http://docs.jquery.com/Plugins/Validation/validate#toptions)

如果要在输入旁边**和**单独的错误容器中显示错误，则需要覆盖`errorPlacement`回调。

从你的例子：

```
...
                    courriel_in: "ERROR",
                    userdigit: "ERROR"
            }
            ,errorContainer: container

            ,errorPlacement: function(error, element){
                var errorClone = error.clone();
                container.append(errorClone);
                error.insertAfter(element)              
            }

            // We don't need this options
            //,errorLabelContainer: $("ol", container)
            //,wrapper: 'li'
            //,meta: "validate"
    });
 ... 
```

`error`参数是一个包含`<label>`标签的jQuery 对象。该`element`参数是验证失败的输入。

# 更新评论

使用上面的代码，错误容器不会清除错误，因为它包含一个克隆副本。如果 jQuery 提供了一个“隐藏”事件，这很容易解决，但它并不存在。让我们添加一个隐藏事件！

1.  首先我们需要[AOP 插件](http://plugins.jquery.com/project/AOP)
2.  我们为 hide 方法添加一个建议：

    ```
     jQuery.aop.before({target: jQuery.fn, method: "hide"},
                    function(){
                        this.trigger("hide");
                    }); 
    ```

3.  我们绑定 hide 事件来隐藏克隆的错误：

    ```
     ...
            ,errorPlacement: function(error, element){
                var errorClone = error.clone();
                container.append(errorClone);
                error.insertAfter(element).bind("hide", function(){
                    errorClone.hide();
                });
            }
            ... 
    ```

试试看

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-13T01:32:44.107

我会删除errorContainer，然后在回发时拦截验证，并在那里手动添加一个容器错误，如下所示：

```
$("#frmEnregistrer").bind("invalid-form.validate", function(e, validator) {
  var err = validator.numberOfInvalids();
  if (err) {
    container.html("THERE ARE "+ err + " ERRORS IN THE FORM")
    container.show();
  } else {
    container.hide();
  }
}).validate({ ... }) 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-03-17T13:23:26.497

我有一个稍微不同的解决方案：

```
jQuery(document).ready(function() {
  var submitted = false;
  var validator = jQuery("#emailForm").validate({ 
      showErrors: function(errorMap, errorList) {
          if (submitted) {
              var summary = "";
              jQuery.each(errorList, function() {
              summary += "<li><label for='"+ this.element.name;
              summery += "' class='formError'>" + this.message + "</label></li>"; });
              jQuery("#errorMessageHeader").show();
              jQuery("#errorMessageHeader").children().after().html(summary);
              submitted = false;
          }
          this.defaultShowErrors();
      },          
      invalidHandler: function(form, validator) { submitted = true; },
      onfocusout: function(element) { this.element(element); },
      errorClass: "formError",
      rules: { 
          //some validation rules 
      },
      messages: { 
          //error messages to be displayed
      }           
  }); 
}); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-12-01T12:42:24.247

我用以下短代码解决了这个问题：

```
errorElement: "td",
errorPlacement: function (error, element) {
     error.insertAfter(element.parent());
} 
```

我的结构如下：

```
<table>
   <tr>
      <td>Name:</td>
      <td><input type="text" name="name"></td>
   </tr>
</table> 
```

所以我的错误现在将直接显示在`<td>`我的后面`<input>`

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-11-12T23:26:22.550

我不知道验证插件是否为此提供了一个选项，但您可能可以使用标准 jQuery 来实现您想要的。通过将显示样式设置为无，确保您的容器最初是隐藏的：

```
<div id="container" style="display:none;"></div> 
```

然后，您可以将 onsubmit 事件连接到表单，这将使容器在尝试提交表单后立即可见：

```
jQuery('#formId').onsubmit(function() {
    // This will be called before the form is submitted
    jQuery('#container').show();
}); 
```

希望将其与您现有的代码结合起来应该可以解决问题。

# vb.net - 终端服务：以管理员身份运行时获取客户端名称

> ID：285429
> 
> 赞同：3
> 
> 时间：2008-11-12T21:23:13.110
> 
> 标签：vb.net, environment-variables, terminal-services

在正常情况下，我的一个 VB.NET 应用程序可以检查 ClientName 环境变量以获取用户正在连接的工作站的名称。

因此，当 WorkstationX RDP 进入 ServerA 时：

*   计算机名=服务器 A
*   客户端名称=工作站X

这很好用。

如果我右键单击应用程序并选择以管理员身份运行，则未设置 ClientName 变量。

有没有人知道一种轻松获取连接到终端服务器的客户端的工作站名称的方法，即使应用程序是通过“以管理员身份运行”启动的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-09T02:22:31.697

如果你不想自己处理 P/Invoke 业务，你可以使用[Cassia](http://cassia.googlecode.com/)，它为你包装了它：

```
New Cassia.TerminalServicesManager().CurrentSession.ClientName 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-14T04:15:01.027

[终端服务 API](http://msdn.microsoft.com/en-us/library/aa383468(VS.85).aspx)可能是您的答案。我在 VB.NET 应用程序中使用它来注销给定服务器上的用户会话，并检索连接到这些会话的工作站的名称。我拥有的代码有很多 p-invoke 的东西，而且相当笨拙，但如果你愿意，我可以发布它。

# .net - Compact Framework - Image.FromStream (Stream, Boolean, Boolean) 的任何实现？

> ID：285440
> 
> 赞同：4
> 
> 时间：2008-11-12T21:27:37.720
> 
> 标签：.net, image, compact-framework, bitmap

在我编写的 .NET CF 应用程序中，功能之一是从远程摄像机获取帧。帧以单个 jpeg 图像的形式获取，并在可用时显示在屏幕上。

这是一个足够好的解决方案，但我不喜欢使用构造函数将流转换为`Image`对象所需的时间*远远大于*下载流所需的时间。`Bitmap()`

 *当我浏览一些博客搜索这个问题时，我发现一些开发人员正在使用带有一个似乎控制一些验证代码`Image.FromStream()`的标志的方法。`validateImageData`当`validateImageData`为 false 时，转换会显着加快。

很好，我想....但是 Compact Framework 没有实现这个方法！

任何人都知道如何绕过它，或者至少如何将流转换为`Image`没有不必要的延迟？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-12T23:38:33.930

如果 JPEG 的尺寸很大（例如 1200 x 1600 或其他东西），那么您在使用 Bitmap 构造函数的设备上遇到的速度问题之一是必须在内存中创建位图的大小（位图将也是 1200 x 1600，即使它随后显示在 240 X 320 屏幕上）。如果您可以检索到 320 X 240 的已经大小的 JPEG 而不是全尺寸的，则位图创建时间应该少得多。

除了 Bitmap 构造函数之外，我找不到缺失的 FromStream 方法的任何替代方法。如果您熟悉 JPEG 格式，我认为编写自己的 JPEG 到 BMP 转换器不会太难，但我猜它不会比 Bitmap() 快。

编辑：对不起，我的意思是你自己的转换器在将 240 X 320 JPEG 转换为 240 X 320 位图时不会更快。我认为它可以更快地将更大的 JPEG 转换为 240 X 320 位图，因为它可以跳过首先创建全尺寸位图的步骤。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-01T23:43:36.080

不确定这是否会有所帮助，但 OpenNETCF.Drawing.Imaging 具有从流中读取图像的类，但它们是 IImage 包装的 com 对象。然后，您可以使用 IImage.Draw 将其绘制到您的位图上。它还有一个 GetThumbnail 方法，我用它来获取设备上大型 jpeg 的缩放图像。

[这](http://blog.opennetcf.com/afeinman/CommentView,guid,8fb585db-bd44-42fe-afa9-07b116c6d2ba.aspx)是来自 Alex Feinman 的一篇博客文章。

# c# - Base64 字符串可以包含制表符吗？

> ID：285445
> 
> 赞同：6
> 
> 时间：2008-11-12T21:29:01.990
> 
> 标签：c#, .net, base64

简单的是或否问题，我 90% 确定它不是……但我不确定。

Base64 字符串可以包含制表符吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-11-12T21:40:46.087

这取决于你在问什么。如果您询问制表符是否可以使用 base-64 编码，那么答案是“是”，因为它们可以被视为与任何其他 ASCII 字符相同。

但是，如果您询问 base-64 输出是否可以包含制表符，那么答案是否定的。以下链接是一篇详细介绍 base-64 的文章，包括哪些字符被认为是有效的：

[http://en.wikipedia.org/wiki/Base64](http://en.wikipedia.org/wiki/Base64)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-12T21:36:09.137

简短的回答是否定的——但 Base64 也不能包含回车。

这就是为什么，如果你有多行 Base64，你去掉任何回车、换行和任何不在 Base64 字母表中的东西

这包括标签。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-12T21:43:05.690

来自[wikipedia.com：](http://en.wikipedia.org/wiki/Base64)

> 当前版本的 PEM（在 RFC 1421 中指定）使用 64 个字符的字母表，由大写和小写罗马字母字符（A-Z、a-z）、数字 (0-9) 和“+ " 和 "/" 符号。“=”符号也用作特殊的后缀代码。原始规范 RFC 989 还使用“*”符号来分隔输出流中编码但未加密的数据。

如您所见，制表符不包括在内。但是，您当然可以将制表符编码为 base64 字符串。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-12T21:33:20.080

当然。Tab 只是 ASCII 字符 9，它与任何其他整数一样具有 base64 表示。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-12T21:44:01.307

Base64 规范 ( [RFC 4648](https://www.rfc-editor.org/rfc/rfc4648#section-3.1) ) 在[第 3.3 节](https://www.rfc-editor.org/rfc/rfc4648#section-3.3)中声明，除非另一个规范明确允许，否则应拒绝任何遇到的非字母字符：

> 在解释基本编码数据时，如果编码数据包含基本字母表之外的字符，则实现必须拒绝编码
> 数据，除非引用本文档的规范另有明确说明。此类规范可能会像 MIME 所做的那样声明，在解释数据时应该简单地忽略基本编码字母表之外的字符（“在你接受的内容上保持自由”）。请注意，这意味着任何相邻的回车/换行 (CRLF) 字符构成“非字母字符”并被忽略。

PEM ( [RFC 1421](https://www.rfc-editor.org/rfc/rfc1421) ) 和 MIME ( [RFC 2045](https://www.rfc-editor.org/rfc/rfc2045#section-6.8) ) 等规范指定 Base64 字符串可以由空格分隔。根据引用的[RFC 822](https://www.rfc-editor.org/rfc/rfc822#section-3.3)，制表符 (HTAB) 被视为空白字符。

因此，当在 MIME 或 PEM（可能还有其他类似规范）的上下文中使用 Base64 时，应在解码编码内容时处理（去除）空格，包括制表符。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-12T21:53:19.540

哈哈，从回复中可以看出，这其实不是一个简单的yes no 答案。

转换后生成的 Base64 字符串不能包含制表符，但在我看来，您不是在问这个问题，在我看来，您在问是否可以表示一个包含 Base64 制表符的字符串（转换前），以及答案是的。

我要补充的是，您真正应该做的是确保您注意保留字符串的编码，即将其转换为具有正确编码（Unicode、UTF-8 等）的字节数组，然后将该数组转换为字节到 base64。

编辑：一个简单的测试。

```
private void button2_Click(object sender, EventArgs e)
{
  StringBuilder sb = new StringBuilder();
  string test = "The rain in spain falls \t mainly on the plain";
  sb.AppendLine(test);
  UTF8Encoding enc = new UTF8Encoding();
  byte[] b = enc.GetBytes(test);
  string cvtd = Convert.ToBase64String(b);
  sb.AppendLine(cvtd);
  byte[] c = Convert.FromBase64String(cvtd);
  string backAgain = enc.GetString(c);
  sb.AppendLine(backAgain);
  MessageBox.Show(sb.ToString());
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-12T21:32:29.847

`Convert.FromBase64String()`在 .NET 框架中似乎并不介意它们。我相信字符串中的所有空格都会被忽略。

```
string xxx = "ABCD\tDEFG";   //simulated Base64 encoded string w/added tab
Console.WriteLine(xxx);
byte[] xx = Convert.FromBase64String(xxx); // convert string back to binary
Console.WriteLine(BitConverter.ToString(xx)); 
```

输出：

```
ABCD    DEFG
00-10-83-0C-41-46 
```

[RFC-2045](https://www.rfc-editor.org/rfc/rfc2045) (6:8)的相关条款

> 编码的输出流必须以每行不超过 76 个字符的形式表示。 解码软件**必须忽略表 1 中未找到的所有换行符或其他字符。**在 base64 数据中，表 1 中的字符以外的字符、**换行符和其他空格**可能表示传输错误，在某些情况下可能适合发出警告消息甚至消息拒绝。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-31T00:23:08.757

是的！

Base64 用于使用一组安全字符将任何 8 位值（十进制 0 到 255）编码为字符串。TAB 是十进制的 9。

Base 64 使用以下字符集之一：

```
Data: ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/
URLs: ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_ 
```

文本中的二进制附件（例如：电子邮件）也使用该系统进行编码。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-02T18:29:21.010

这里似乎有很多混乱；令人惊讶的是，大多数答案都是“否”。我认为这不是一个很好的规范答案。造成混淆的原因可能是 Base64 没有严格规定；存在多种实际实现和解释。您可以查看[链接文本](http://en.wikipedia.org/wiki/Base64)以进行更多讨论。

然而，一般来说，符合 base64 的编解码器应该理解换行符，因为它们是由一些 base64 定义（76 个字符段，然后是换行符等）强制要求的。正因为如此，大多数解码器还允许缩进空白，以及非常常见的 4 字符“三元组”之间的任何空白（如此命名，因为它们编码 3 个字节）。

所以很有可能在实践中你可以使用制表符和其他空白。

但是，如果生成发送到服务的 base64 内容，我不会自己添加标签——对你发送的内容要保守，在你收到的内容上（更）自由。

# c# - 更改 ListBox 选择会更改其他 ListBox 的选择。这是怎么回事？

> ID：285446
> 
> 赞同：1
> 
> 时间：2008-11-12T21:29:12.317
> 
> 标签：c#, .net, winforms, data-binding

我有一个 Windows 窗体应用程序，在同一个窗体上有两个 ListBox 控件。它们都将其 SelectionMode 设置为“MultiExtended”。

当我更改一个的选择时，另一个的选择会发生变化。

现在我认为我对我的 SelectedIndexChanged 处理程序做了一些愚蠢的事情，所以我删除了它们并从头开始重新编写它们，并遇到了问题。

所以我创建了一个全新的 WinForms 应用程序并将两个 ListBoxes 拖到表单表面上。

在构造函数中，我用以下内容填充了它们。

```
List<Thing> data = new List<Thing>();

for ( int i = 0; i < 50; i++ ) {
        Thing temp = new Thing();
        temp.Letters = "abc " + i.ToString();
        temp.Id = i;
        data.Add(temp);
}

listBox1.DataSource = data;
listBox1.DisplayMember = "Letters";
listBox1.ValueMember = "Id";

List<Thing> data2 = new List<Thing>();

for ( int i = 0; i < 50; i++ ) {
    Thing temp = new Thing();
    temp.Letters = "abc " + i.ToString();
    temp.Id = i;
    data2.Add(temp);
}

listBox2.DataSource = data2;
listBox2.DisplayMember = "Letters";
listBox2.ValueMember = "Id"; 
```

然后我构建并运行了该应用程序。

开始选择一些值以查看症状是否存在。他们是！

这实际上是我添加到表单中的所有代码，我没有添加任何事件处理程序，我已经尝试将 SelectionMode 设置为“One”和“MultiExtended”。

谁能给我一个关于为什么会发生这种情况的线索。

干杯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-14T09:14:07.943

它不是存储当前位置的*列表*- 它是`CurrencyManager`. 与a具有*相同引用*的任何控件（具有相同的`BindingContext`）都将共享 a 。通过使用不同的列表实例，您可以获得不同的实例，从而获得不同的位置。*`DataSource``CurrencyManager``CurrencyManager`*

 *您可以通过使用`.ToList()`或创建`List<T>`具有相同内容的新内容（根据您的原始帖子）或通过将新内容分配`BindingContext`给其中一个控件来实现相同的目的：

```
control.BindingContext = new BindingContext(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-12T21:38:14.407

我相信您的两个控件共享一个 CurrencyManager。我不确定究竟是为什么。
作为一种解决方法，您可以尝试使用简单的字符串填充列表框。或者您可能想尝试创建 BindingSource 组件的单独实例，并绑定到这些实例。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-12T21:37:02.397

当我在两个列表框上使用相同的数据源时，我遇到了同样的情况，但是创建两个相等的数据源为我解决了这个问题。我看不出你的代码有什么问题。Thing 类有什么特别之处吗？还是只包含两个成员 Letters 和 Id ？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-14T09:07:51.950

和更多...

我终于明白了。

我将两个 ListBox 绑定到同一个列表。通过将代码更改为

```
theListBox.DataSource = _contacts.Take(_contacts.Count).ToList(); 
```

这个问题被取消了。

似乎对它存储的 List 的引用还将任何绑定或选择信息转移到另一个 ListBox。

当心。;)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-12T21:44:13.100

我创建了一个新的 win forms 应用程序，上面有两个列表框。他们的行为和我预期的一样。你能发布完整的代码吗？这是我的代码。

```
public partial class Form1 : Form
{
public Form1()
{
  InitializeComponent();
}

private class Thing
{
  public String Letters { get; set; }
  public Int32 Id { get; set; }
}
private void Form1_Load(object sender, EventArgs e)
{
  List<Thing> data = new List<Thing>();

  for (int i = 0; i < 50; i++)
  {
    Thing temp = new Thing();
    temp.Letters = "abc " + i.ToString();
    temp.Id = i;
    data.Add(temp);
  }

  listBox1.DataSource = data;
  listBox1.DisplayMember = "Letters";
  listBox1.ValueMember = "Id";

  List<Thing> data2 = new List<Thing>();

  for (int i = 0; i < 50; i++)
  {
    Thing temp = new Thing();
    temp.Letters = "abc " + i.ToString();
    temp.Id = i;
    data2.Add(temp);
  }

  listBox2.DataSource = data2;
  listBox2.DisplayMember = "Letters";
  listBox2.ValueMember = "Id";
} 
```

}

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-12T22:25:07.243

我试图在我自己的机器上复制此行为，但无法仅运行您提供的代码。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-12T22:43:07.880

我站得更正了。

在全新解决方案中的另一个 VS 实例中，这按预期工作。

上帝只知道我做了什么让它做它正在做的事情

# python - 如何从 C 访问 Python 全局变量？

> ID：285455
> 
> 赞同：10
> 
> 时间：2008-11-12T21:32:08.863
> 
> 标签：python, c

我在 Python 脚本中有一些全局变量。该脚本中的某些函数调用 C - 是否可以在 C 中设置这些变量之一，如果可以，如何设置？

我很欣赏这首先不是一个很好的设计，但是我需要对现有代码进行一些小的更改，我不想着手对现有脚本进行重大重构。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-12T21:46:13.517

我不是 python 大师，但我发现这个问题很有趣，所以我四处搜索。[这](https://mail.python.org/pipermail/python-list/2007-September/427041.html)是“python 嵌入 API”的第一次成功——它有帮助吗？

> 如果属性属于模块的全局范围，那么您可以使用“PyImport_AddModule”来获取模块对象的句柄。例如，如果您想在名为“foobar”的**主** 模块中获取整数的值，您可以执行以下操作：
> 
> ```
> PyObject *m = PyImport_AddModule("__main__");
> PyObject *v = PyObject_GetAttrString(m,"foobar");
> 
> int foobar = PyInt_AsLong(v);
> 
> Py_DECREF(v); 
> ```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-09-18T07:47:54.517

对于从 Google 来到这里的任何人，这是直接的方法：

```
PyObject* PyEval_GetGlobals() 
```

[https://docs.python.org/2/c-api/reflection.html](https://docs.python.org/2/c-api/reflection.html)

[https://docs.python.org/3/c-api/reflection.html](https://docs.python.org/3/c-api/reflection.html)

返回值作为字典访问。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-12T22:23:27.530

我建议使用[`pyrex`](http://www.cosc.canterbury.ac.nz/greg.ewing/python/Pyrex/)来制作一个扩展模块，您可以将值存储在 python 中，并 cdef 一堆可以从 C 调用以返回值的函数。

否则，很大程度上取决于您尝试传输的值的类型。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-13T17:55:12.277

你愿意*稍微*修改一下 API吗？

*   您可以让 C 函数返回全局的新值，然后像这样调用它：

    `my_global = my_c_func(...)`

*   如果您直接使用[Robin](http://robin.python-hosting.com/)或 Python C API，则可以将 globals 字典作为附加参数传递并对其进行修改

*   如果你的全局总是在同一个模块中，Sherm 的解决方案看起来很棒

# ruby-on-rails - 使用多对多关系时如何插入行

> ID：285456
> 
> 赞同：5
> 
> 时间：2008-11-12T21:32:26.010
> 
> 标签：ruby-on-rails, model, schema, insert

鉴于以下情况，我如何在我的数据库中插入行？（或者我应该在我的模式中更正什么？）

楷模：

```
class Item < ActiveRecord::Base
    has_many                            :tran_items
    has_many :transactions, :through => :tran_items
end
class TranItem < ActiveRecord::Base
    belongs_to :item
    belongs_to :transaction
end
class Transaction < ActiveRecord::Base #answer: rename Transaction
    has_many                            :tran_items
    has_many :items, :through =>        :tran_items
end 
```

架构：

```
create_table :items do |t|
  t.references :tran_items #answer: remove this line
  t.string     :name
end
create_table :tran_items do |t|
  t.belongs_to :items,  :transactions,  :null => false #answer: unpluralize
  t.integer    :quantity
end
create_table :transactions do |t|
  t.references :tran_items #answer: remove this line
  t.decimal    :profit
end 
```

我浪费了几个小时试图插入记录，使用 rails 控制台来测试。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-13T00:03:47.047

（编辑：由于 ActiveRecord::Transactions，模型名称“Transaction”可能会给您带来一些问题。[有一个灯塔票](https://rails.lighthouseapp.com/projects/8994/tickets/993-having-column-named-transaction-in-a-model-leads-to-weird-behavior)。）

您的架构设置不正确。“references”是“belongs_to”的别名。项目和交易不**属于_to_trans_items**，它们每个都有**_many** trans_items（根据您的模型）

```
create_table :items do |t|
  t.string     :name
end
create_table :tran_items do |t|
  t.belongs_to :item, :transaction, :null    => false
  t.integer    :quantity
end
create_table :transactions do |t|
  t.decimal    :profit,  :default => 0
end 
```

（编辑：将belongs_to设为单数）

您是否删除了数据库并重新运行迁移以构建新架构？

rake db:drop && rake db:create && rake db:migrate

这是我在控制台中得到的：

```
>> i = Item.create(:name => 'My Item')    
=> #<Item id: 2, name: "My Item">
>> t = Transaction.create(:profit => 100)
=> #<Transaction id: 2, profit: #<BigDecimal:2411d2c,'0.1E3',4(8)>>
>> t.tran_items.create(:item => i)
=> #<TranItem id: nil, item_id: 2, transaction_id: 2, quantity: nil> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-13T20:01:47.760

此架构应该为您提供您正在寻找的结果：

```
 create_table :items do |t|
      t.string     :name
    end
    create_table :purchase_items do |t|
      t.belongs_to :item, :purchase, :null    => false
      t.integer    :quantity
    end
    create_table :purchases do |t|
      t.decimal    :profit,                :default => 0
    end 
```

以下是模型：

```
class Purchase < ActiveRecord::Base
    has_many                            :purchase_items
    has_many :items, :through =>        :purchase_items
end   

class Item < ActiveRecord::Base
    has_many                            :purchase_items
    has_many :purchases, :through => :purchase_items
end

class PurchaseItem < ActiveRecord::Base
    belongs_to :item
    belongs_to :purchase
end 
```

现在使用控制台：

```
>> i = Item.create(:name => 'Item One')
=> #<Item id: 1, name: "Item One">
>> p = Purchase.create(:profit => 100)
=> #<Purchase id: 1, profit: #<BigDecimal:2458cf4,'0.1E3',4(8)>>
>> p.purchase_items.create(:item => i)
=> #<PurchaseItem id: 1, item_id: 1, purchase_id: 1, quantity: nil> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-12T21:38:20.630

如果我理解正确。

```
item = Item.new(:name => "item")
item.transactions.build(:name => "transaction")
item.save! 
```

# php - 正则表达式从 html 标签中去除属性和值

> ID：285465
> 
> 赞同：0
> 
> 时间：2008-11-12T21:36:50.603
> 
> 标签：php, regex, preg-replace

嗨，伙计们，我对正则表达式很陌生，你能帮我解决这个问题吗？

我有一个像这样的字符串`"<input attribute='value' >"`，`attribute='value'`可以是任何东西，我想做一个`preg_replace`得到只是`<input />`

如何指定通配符来替换 srting 中任意数量的任意字符？

像这样？`preg_replace("/<input.*>/",$replacement,$string);`

非常感谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-12T21:40:50.827

你有什么：

```
.* 
```

将匹配“任何字符，并且尽可能多。

你的*意思*是

```
[^>]+ 
```

翻译为“任何字符，那不是“>”，并且必须至少有一个

或者，

```
.*? 
```

这意味着“任何字符，但仅足以使此规则生效”

# 但不要

用正则表达式解析 HTML 很**糟糕**

使用任何现有的 html 解析器、DOM 库、任何东西，只是不是 NAïVE REGEX

例如：

```
 <foo attr=">"> 
```

将被正则表达式错误地抓住为

```
'<foo attr=" ' with following text of '">' 
```

这将引导你到这个正则表达式：

```
 `<[a-zA-Z]+( [a-zA-Z]+=['"][^"']['"])*)>  etc etc 
```

在这一点上，你会发现这个可爱的宝石：

```
 <foo attr="'>\'\""> 
```

你的头会爆炸。

（语法荧光笔验证了我的观点，并且错误地认为我已经结束了标签。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-12T22:32:21.940

有些人很接近......但不是100％：

这个：

```
preg_replace("<input[^>]*>", $replacement, $string); 
```

应该是这样的：

```
preg_replace("<input[^>]*?>", $replacement, $string); 
```

你不希望这是一场贪婪的比赛。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-13T16:55:21.803

如果我正确理解了这个问题，你有代码：

```
preg_replace("/<input.*>/",$replacement,$string); 
```

并且您希望我们告诉您应该使用 $replacement 来删除与 .* 匹配的内容

你必须反其道而行之。使用捕获组来捕获您想要保留的内容，并将其重新插入替换中。例如：

```
preg_replace("/(<input).*(>)/","$1$2",$string); 
```

当然，您实际上并不需要在这里捕获组，因为您只是重新插入文字文本。打赌上面显示了该技术，以防您想在标签可能变化的情况下执行此操作。这是一个更好的解决方案：

```
preg_replace("/<input [^>]*>/","<input />",$string); 
```

否定字符类比点更具体。如果字符串中有两个 HTML 标记，则此正则表达式将起作用。你原来的正则表达式不会。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-12T21:41:39.220

```
preg_replace("<input[^>]*>", $replacement, $string); 
// [^>] means "any character except the greater than symbol / right tag bracket" 
```

这真的是*基本*的东西，你应该[赶上一些阅读](http://www.regular-expressions.info/php.html)。:-)

# c# - 合并 2 个数据表并存储在一个新的数据表中

> ID：285474
> 
> 赞同：58
> 
> 时间：2008-11-12T21:39:33.920
> 
> 标签：c#, datatable

如果我有 2 个数据表（dtOne 和 dtTwo）并且我想合并它们并将它们放在另一个数据表（dtAll）中。我怎样才能在 C# 中做到这一点？我在数据表上尝试了 Merge 语句，但这返回无效。合并是否保留数据？例如，如果我这样做：

```
 dtOne.Merge(dtTwo); 
```

dtOne 是否更改或 dtTwo 是否更改，如果其中任何一个更改，更改是否保留？

我知道我不能这样做，因为 Merge 返回 void，但我希望能够将 dtOne 和 dtTwo 的 Merger 存储在 dtAll 中：

```
//Will Not work, How do I do this
dtAll = dtOne.Merge(dtTwo); 
```

* * *

## 回答 #1

> 赞同：106
> 
> 时间：2008-11-12T21:46:24.000

该`Merge`方法从第二个表中获取值并将它们与第一个表合并，因此第一个表现在将保存两个表中的值。

如果要保留两个原始表，可以先复制原始表，然后合并：

```
dtAll = dtOne.Copy();
dtAll.Merge(dtTwo); 
```

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2013-01-18T11:22:04.773

而不是`dtAll = dtOne.Copy();`在[杰罗米欧文的回答](https://stackoverflow.com/a/285500/979621)中，您可以从一个空的开始`DataTable`并迭代地一个接一个地合并：

```
dtAll = new DataTable();
...
dtAll.Merge(dtOne);
dtAll.Merge(dtTwo);
dtAll.Merge(dtThree);
... 
```

等等。

此技术在您想要迭代合并数据表的循环中很有用：

```
DataTable dtAllItems = new DataTable();

foreach(var item in items)
{
    DataTable dtItem = getDataTable(item); // some function that returns a data table
    dtAllItems.Merge(dtItem);
} 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-01-18T01:25:25.867

```
dtAll = dtOne.Copy();
dtAll.Merge(dtTwo,true); 
```

参数 TRUE 保留更改。

有关详细信息，请参阅[MSDN](http://msdn.microsoft.com/en-us/library/wkk7s5zk.aspx)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-01-11T15:27:32.320

```
DataTable dtAll = new DataTable();
DataTable dt= new DataTable();
foreach (int id in lst)
{
    dt.Merge(GetDataTableByID(id)); // Get Data Methode return DataTable
}
dtAll = dt; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-08-30T07:53:56.690

这就是我为合并两个数据表并将最终结果绑定到 gridview 所做的

```
 DataTable dtTemp=new DataTable();
        for (int k = 0; k < GridView2.Rows.Count; k++)
        {
            string roomno = GridView2.Rows[k].Cells[1].Text;
            DataTable dtx = GetRoomDetails(chk, roomno, out msg);
            if (dtx.Rows.Count > 0)
            {
                dtTemp.Merge(dtx);
                dtTemp.AcceptChanges();

            }
        } 
```

# sql - 选择具有与条件匹配的最新时间戳的行的最佳方法

> ID：285477
> 
> 赞同：12
> 
> 时间：2008-11-12T21:40:45.697
> 
> 标签：sql, oracle

这是经常出现的事情，我几乎停止思考它，但我几乎可以肯定我不是以最好的方式做到这一点。

问题：假设您有下表

```
CREATE TABLE TEST_TABLE
(
  ID          INTEGER,
  TEST_VALUE  NUMBER,
  UPDATED     DATE,
  FOREIGN_KEY INTEGER
); 
```

选择与 FOREIGN_KEY = 10 的最近更新行关联的 TEST_VALUE 的最佳方法是什么？

**编辑：**让我们让这更有趣，因为下面的答案只是使用我的排序方法，然后选择第一行。不错，但对于大额回报，订单会扼杀性能。所以加分：如何以可扩展的方式进行（即没有不必要的顺序）。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-12T22:16:28.197

分析函数是你的朋友

```
SQL> select * from test_table;

        ID TEST_VALUE UPDATED   FOREIGN_KEY
---------- ---------- --------- -----------
         1         10 12-NOV-08          10
         2         20 11-NOV-08          10

SQL> ed
Wrote file afiedt.buf

  1* select * from test_table
SQL> ed
Wrote file afiedt.buf

  1  select max( test_value ) keep (dense_rank last order by updated)
  2  from test_table
  3* where foreign_key = 10
SQL> /

MAX(TEST_VALUE)KEEP(DENSE_RANKLASTORDERBYUPDATED)
-------------------------------------------------
                                               10 
```

您还可以扩展它以获取整行的信息

```
SQL> ed
Wrote file afiedt.buf

  1  select max( id ) keep (dense_rank last order by updated) id,
  2         max( test_value ) keep (dense_rank last order by updated) test_value
,
  3         max( updated) keep (dense_rank last order by updated) updated
  4  from test_table
  5* where foreign_key = 10
SQL> /

        ID TEST_VALUE UPDATED
---------- ---------- ---------
         1         10 12-NOV-08 
```

分析方法通常非常有效。

我还应该指出，分析函数相对较新，所以如果您使用的是 9.0.1 之前的版本，这可能不起作用。这不再是一个庞大的人口，但总是有一些人坚持旧版本。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-12T21:44:13.567

要么使用子查询

```
WHERE updated = (SELECT MAX(updated) ...) 
```

或选择 TOP 1 记录

```
ORDER BY updated DESC 
```

在 Oracle 语法中，这将是：

```
SELECT 
  * 
FROM 
(
  SELECT * FROM test_table
  ORDER BY updated DESC
)
WHERE 
  ROWNUM = 1 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-12T23:29:26.257

首先，您将始终需要查看具有该外键的所有行，并找到具有最高 UPDATED 值的行……这意味着 MAX 或 ORDER BY。比较的效率部分取决于优化器，因此取决于您的 Oracle 版本。但是，您的数据结构可能会对实际性能产生更大的影响。FOREIGN_KEY、UPDATED DESC、TEST_VALUE 上的索引可能会为查询提供最具可扩展性的解决方案，因为 Oracle 通常只需访问单个叶块即可给出答案。由于必须将新记录插入到该结构中，因此可能会对插入产生不利影响。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-12T21:43:12.460

我目前做这样的事情的可能较差的方式是

```
SELECT TEST_VALUE
FROM TEST_TABLE
WHERE ID = (
  SELECT ID
  FROM (
    SELECT ID
    FROM TEST_TABLE
    WHERE FOREIGN_KEY = 10
    ORDER BY UPDATED DESC
  )
  WHERE ROWNUM = 1
) 
```

但请 StackOverflow Geniuses 教我一些技巧

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-13T18:07:33.733

```
选择 TEST_VALUE
  FROM TEST_TABLE
 更新的地方=（选择最大（更新）
                          FROM TEST_TABLE
                         其中 FOREIGN_KEY = 10 )
   和外键 = 10
   AND ROWNUM = 1 -- 以防记录具有相同的更新日期

```

而是拿第一条记录，您可以打破与最高 ID 或最小/最大 TEST_VALUE 的平局。

FOREIGN_KEY, UPDATED 的索引将有助于查询性能。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-02-06T20:35:23.367

在我阅读 Justin Cave 的答案之前，我一直使用以下模式来获取最新的记录。

```
WITH test_table_ranked AS (
    SELECT
        test_table.*,
        ROW_NUMBER() OVER (
            PARTITION BY foreign_key ORDER BY updated DESC
        ) AS most_recent
    FROM
        test_table
)
SELECT *
FROM test_table_ranked
WHERE most_recent = 1
-- AND foreign_key = 10 
```

此查询查找表中每个外键的最新更新。虽然当密钥已知时 Justin 的回答会更快，但此查询也适用于 SQL Server。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-12T23:51:16.120

性能将取决于索引的内容。这是一个方法。

```
WITH 
ten AS
(
    SELECT *
    FROM TEST_TABLE
    WHERE FOREIGH_KEY = 10
)
SELECT TEST_VALUE 
FROM ten
WHERE UPDATED = 
(
    SELECT MAX(DATE)
    FROM ten
) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-12T23:58:18.790

这里有一个 oracle SQL 常见问题解答可以帮助您：

[http://www.orafaq.com/wiki/SQL_FAQ](http://www.orafaq.com/wiki/SQL_FAQ)

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-11-12T21:49:17.660

```
select test_value
from
(
  select test_value 
  from test_table
  where foreign_key=10
  order by updated desc
)
where rownum = 1 
```

Oracle 足够聪明，它意识到它只需要来自内部选择的一行，并且它会有效地做到这一点。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2008-11-12T21:54:28.303

这行不通：

```
SELECT TOP 1 ID
FROM test_table
WHERE FOREIGN_KEY = 10
ORDER BY UPDATED DESC 
```

不需要子查询...

# c++ - 在 Vista x64 上使用 PrintDlg 不起作用，在 32 位和 XP 上工作正常

> ID：285482
> 
> 赞同：2
> 
> 时间：2008-11-12T21:41:27.660
> 
> 标签：c++, visual-studio-2008, printing, vista64

我们有一个应用程序，其中包含一些我们仍在使用`[PrintDlg](http://msdn.microsoft.com/en-us/library/ms646940(VS.85).aspx)`的旧打印机“设置”代码。我们使用自定义模板允许用户选择用于各种类型打印任务（例如报告或图纸）的打印机以及方向和纸张尺寸/来源。

它可以在 XP 和 32 位 Vista 上运行，但在 Vista x64 上它可以`CDERR_MEMLOCKFAILURE`通过`CommDlgExtendedError()`. 我尝试仅使用`PRINTDLG`结构中的基本输入来运行它，但如果参数包含`PD_PRINTSETUP`or `PD_RETURNDEFAULT`，我会收到该错误。

由于打印机选择/页面设置已拆分为`[PageSetupDlg](http://msdn.microsoft.com/en-us/library/ms646937(VS.85).aspx)`和`[PrintDlgEx](http://msdn.microsoft.com/en-us/library/ms646942(VS.85).aspx)`，因此如果不更改大量代码和/或完全更改我们向用户呈现打印和打印机设置的方式，就没有明显的简单转换。

有没有人在 64 位 Vista 上看到过这个问题，你有没有找到任何解决方法？

**注意：**
由于其他限制，应用程序以管理员身份运行

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-17T16:52:11.153

我在微软论坛上找到了一个相关的帖子：[在 Vista x64 上，DocumentProperties failed from UAC-elevated process](http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=2677398&SiteID=1)

我已经用一个示例程序验证了 PrintDlg 以非管理员身份运行的工作原理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-17T16:48:30.380

我在 Quicken 社区论坛上找到了一个帖子：[Vista 64 Quicken 2008 打印问题的解决方案](http://www.quickencommunity.com/webx/Forums/Quicken%20Personal%20Finance%20Software%20Forum%20for%20Windows/Printing%20in%20Quicken/531/26?5)，以及相关的常见问题解答：[如果我无法打印或收到“与打印机通信时出错”怎么办？](https://quicken.custhelp.com/cgi-bin/quicken.cfg/php/enduser/std_adp.php?p_faqid=5893)以及使用仿真打印机的建议。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-17T15:53:58.513

我刚刚在我的应用程序中添加打印时遇到了这个问题。我正在使用 PrintDialog 类，如果它被编译为 32 位应用程序，它工作得很好，但在 64 位模式下编译时甚至不会弹出。没有错误消息，什么都没有。对 ShowDialog 的调用立即返回。（请注意，我运行的是 64 位 Vista。）

我尝试使用 PrintDlg，但也有同样的问题。我在网上查了一下，发现很多人都遇到了类似的问题，但显然不是每个拥有 64 位 Vista 的人都能看到这一点。无论如何，我最终决定编写自己的 PrintDialog 版本（借用在线代码），但这有点棘手（因为一些在线代码有错误），因为我从来没有在网上找到一个完整的例子，我想我会在这里发布我的解决方案。

请注意，我的版本在对话框中留下了一些内容，例如“打印范围”、“副本”和“打印到文件”。这应该很容易添加，但我的应用不需要它们。我也无法弄清楚“类型：”字段显示的是什么，所以我也将其省略了。

对话框如下所示：

[替代文字 http://www.geocities.com/deancooper2000/PrintDialog64.jpg](http://www.geocities.com/deancooper2000/PrintDialog64.jpg)

这是我的代码（我已经将设计器代码省略了，因为它应该很容易重新创建）：

```
using System;
using System.Collections.Generic;
using System.Drawing;
using System.Drawing.Printing;
using System.Printing;
using System.Runtime.InteropServices;
using System.Windows.Forms;
using Zemetrics.Diagnostics;

namespace Utils
{
/// <summary>
/// The PrintDialog64 class replaces the standard PrintDialog with one that works in Vista x64
/// </summary>
public partial class PrintDialog64 : Form
{
    #region Private members 
    [DllImport("winspool.drv", EntryPoint="DocumentPropertiesW")]
    private static extern int DocumentProperties(IntPtr hWnd,IntPtr hPrinter,[MarshalAs(UnmanagedType.LPWStr)] string pDeviceName,IntPtr pDevMode,IntPtr devModeIn,int fMode);

    [DllImport("winspool.drv")] private static extern int    OpenPrinter(string pPrinterName,out IntPtr hPrinter,IntPtr pDefault);
    [DllImport("winspool.drv")] private static extern int    ClosePrinter(IntPtr phPrinter);
    [DllImport("kernel32.dll")] private static extern IntPtr GlobalLock(IntPtr hMem);
    [DllImport("kernel32.dll")] private static extern int    GlobalUnlock(IntPtr hMem);
    [DllImport("kernel32.dll")] private static extern int    GlobalFree(IntPtr hMem);

    private const int DM_PROMPT     = 4;
    private const int DM_OUT_BUFFER = 2;
    private const int DM_IN_BUFFER  = 8;

    private List<PrinterItem> printers;
    private string            printerName;
    private string            originalName;
    private IntPtr            hDevMode = IntPtr.Zero;
    #endregion

    /// <summary>
    /// Gets or sets the printer that prints the document       
    /// </summary>
    public PrinterSettings PrinterSettings { get; set; }

    /// <summary>
    /// Gets or sets a value indicating the PrintDocument used to obtain PrinterSettings.       
    /// </summary>
    public PrintDocument Document { get; set; }

    /// <summary>
    /// Constructs a replacement for the standard PrintDialog with one that works in Vista x64
    /// </summary>
    public PrintDialog64()
    {
        InitializeComponent();
    }

    #region PrinterItem class
    /// <summary>
    /// The PrinterItem class holds a reference to a PrintQueue and allows us to sort a list based on printer name
    /// </summary>
    private class PrinterItem : IComparable<PrinterItem>
    {
        #region Private members
        private PrinterItem() {}
        #endregion

        /// <summary>
        /// Construct a PrinterItem by supplying a reference to the printer's PrintQueue class
        /// </summary>
        ///
        /// \param[in]  printer Reference to PrintQueue class for this printer
        public PrinterItem(PrintQueue printer)
        {
            Printer = printer;
        }

        /// <summary>
        /// Reference to PrintQueue class for this printer
        /// </summary>
        public PrintQueue Printer { get; set; }

        /// <summary>
        /// The string for this class is simply the FullName of the printer
        /// </summary>
        public override string ToString()
        {
            return Printer.FullName;
        }

        #region IComparable<PrinterItem> Members
        /// <summary>
        /// Implements IComparable interface to allow sorting of PrinterItem classes (based on printer name)
        /// </summary>
        ///
        /// \param[in]  other The other PrinterItem class that we are to compare this one to
        public int CompareTo(PrinterItem other)
        {
            return other.Printer.FullName.CompareTo(this.Printer.FullName);
        }
        #endregion
    }
    #endregion

    private List<PrinterItem> GetPrinters()
    {
        List<PrinterItem> printers = new List<PrinterItem>();

        EnumeratedPrintQueueTypes[] Queue_types = {EnumeratedPrintQueueTypes.Local,EnumeratedPrintQueueTypes.Connections};

        try {
            using (LocalPrintServer server = new LocalPrintServer())
                foreach (PrintQueue printer in server.GetPrintQueues(Queue_types))
                    printers.Add(new PrinterItem(printer));                 
            } catch {}

        printers.Sort();
        return printers;                
    }

    private void PrintDialog64_Shown(object sender, EventArgs e)
    {
        originalName = Document.PrinterSettings.PrinterName;
        printers     = GetPrinters();
        int index=0, i=0;

        foreach(PrinterItem printer in printers) {
            nameComboBox.Items.Add(printer.ToString());

            if (printer.ToString() == originalName) index = i;
            i++;
            }

        nameComboBox.SelectedIndex = index;
    }

    private void nameComboBox_Leave(object sender, EventArgs e)
    {
        string text = nameComboBox.Text;

        foreach(Object field in nameComboBox.Items)
            if (((string) field).ToLower().StartsWith(text.ToLower())) nameComboBox.SelectedItem = field;

        if (nameComboBox.SelectedIndex < 0)
            nameComboBox.SelectedIndex = 0;
    }

    private void nameComboBox_SelectedIndexChanged(object sender, EventArgs e)
    {
        PrintQueue printer = printers[nameComboBox.SelectedIndex].Printer;

        if (hDevMode!=IntPtr.Zero) GlobalFree(hDevMode);

        PrinterSettings.PrinterName = printerName = printer.FullName;
        hDevMode                    = PrinterSettings.GetHdevmode(Document.DefaultPageSettings);            

        statusValue .Text = printer.QueueStatus.ToString()=="None" ? "Ready" : printer.QueueStatus.ToString();
        whereValue  .Text = printer.Location=="" ? printer.QueuePort.Name : printer.Location;
        commentValue.Text = printer.Comment;
    }

    private void propertiesButton_Click(object sender, EventArgs e)
    {
        IntPtr handle;
        OpenPrinter(printerName, out handle, IntPtr.Zero);

        IntPtr pDevMode = GlobalLock( hDevMode );
        DocumentProperties(this.Handle, handle, printerName, pDevMode, pDevMode, DM_IN_BUFFER | DM_PROMPT | DM_OUT_BUFFER);
        GlobalUnlock( hDevMode );

        PrinterSettings.SetHdevmode( hDevMode );
        PrinterSettings.DefaultPageSettings.SetHdevmode( hDevMode );
        ClosePrinter(handle);
    }

    private void pageDefaultsButton_Click(object sender, EventArgs e)
    {
        PageSetupDialog setup = new PageSetupDialog(); 
        setup.PageSettings = Document.DefaultPageSettings;

        if (setup.ShowDialog() == DialogResult.OK) {
            if (hDevMode!=IntPtr.Zero) GlobalFree(hDevMode);

            hDevMode = PrinterSettings.GetHdevmode( Document.DefaultPageSettings = setup.PageSettings );
            }
    }

    private void okButton_Click(object sender, EventArgs e)
    {
        if (hDevMode!=IntPtr.Zero) GlobalFree(hDevMode);
    }

    private void cancelButton_Click(object sender, EventArgs e)
    {
        if (hDevMode!=IntPtr.Zero) GlobalFree(hDevMode);

        PrinterSettings.PrinterName = originalName;
    }
}
} 
```

# unicode - 即使使用 /U 开关，Windows cmd 管道也不是 unicode

> ID：285486
> 
> 赞同：9
> 
> 时间：2008-11-12T21:43:48.873
> 
> 标签：unicode, text, cmd, pipe

我有一个小的 c# 控制台程序，它使用 Console.WriteLine 输出一些文本。然后，我将此输出通过管道传输到一个文本文件中，例如：

`c:myprogram > textfile.txt`

但是，该文件始终是 ansi 文本文件，即使我使用 /u 开关启动 cmd 也是如此。命令/？说 /u 开关：

> /U 使管道或文件的内部命令输出为 Unicode

当我做一个

`c:echo "foo" > text.txt`

text.txt 是 unicode（没有 BOM）

我想知道为什么将我的控制台程序的输出通过管道传输到一个新文件中不会同样创建一个 unicode 文件，我该如何改变它？

我只是使用 Windows Power Shell（它会生成一个带有正确 BOM 的 unicode 文件），但我仍然想知道如何使用 cmd 来完成它。

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-12T21:49:15.897

正如文档所说，/U 开关会影响*内部*命令是否生成 Unicode 输出。您的程序不是 cmd.exe 的内部命令之一，因此 /U 选项不会影响它。

要创建 Unicode 文本文件，您需要确保您的程序正在生成 Unicode 文本。

不过，即使这样可能还不够。我看到[了张俊峰的这篇博客，](http://blogs.msdn.com/junfeng/archive/2004/02/25/79621.aspx)描述了如何在控制台程序中编写 Unicode 文本。它检查标准输出句柄的文件类型。对于字符文件（控制台或 LPT 端口），它调用 WriteFileW。对于所有其他类型的句柄（包括磁盘文件和管道），它将输出字符串转换为控制台的当前代码页。不过，恐怕我不知道这如何转化为 .Net 术语。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-12T22:09:23.830

我查看了 mscorlib 如何实现 Console.WriteLine，它似乎根据对[GetConsoleOutPutCP](http://msdn.microsoft.com/en-us/library/ms683169(VS.85).aspx)的调用来决定使用哪种文本输出编码。所以我猜测（但尚未确认）返回的代码页对于 PS 控制台与 cmd 控制台不同，因此我的程序确实只在从 cmd 运行时输出 ansi。

# sharepoint - SharePoint list.items.GetDataTable 列名与字段名不匹配

> ID：285495
> 
> 赞同：2
> 
> 时间：2008-11-12T21:45:16.297
> 
> 标签：sharepoint, datatable, dataview

我将一个 SPGridView 绑定到一个 SPList。正如代码示例所建议的那样，我正在使用以下代码来创建基于列表的数据视图。

```
dim data as DataView = myList.Items.GetDataTable.DefaultView
grid.DataSource = data
etc... 
```

我发现结果数据视图中的列名并不总是与 SPList 中定义的源字段匹配。例如，我有名为

*   描述
*   报告项目
*   报告状态

    这些显示在结果数据视图中，列名如下

*   报告类型0
*   报告状态1

这使我认为我定义了重复的字段名称，但似乎并非如此。

好像我在这里遗漏了一些基本的东西？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-12T22:19:41.017

该`GetDataTable`方法返回的是列的`internalName`（或者`staticName`——我不记得是哪个，但它们经常是相同的）表示，而不是`Title`您在 Web 界面中看到的表示。我相信`GetDataTable`会在幕后进行 CAML 查询，您必须将其`internalName`用于 CAML 中的字段引用。

这个[博客](http://blog.thekid.me.uk/archive/2007/03/12/wss-columns-specify-internal-name.aspx)更详细地讨论了它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-22T17:52:04.570

所以我在我的博客上发布了这个，但是我写了一个你可以使用的小实用方法，在你得到数据表之后，它基本上将 DataTable 中的列名重新映射到它们的友好名称。

```
DataTable table = list.GetItems(list.DefaultView).GetDataTable();
foreach(DataColumn column in table.Columns)
{
   column.ColumnName = list.Fields.GetFieldByInternalName(column.ColumnName).Title;
} 
```

希望有帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-09T13:22:38.143

您还可以做的（如果您使用的是 .NET 3.5）是使用匿名类型并对其进行绑定。如果您这样做，您可能还想使用 Linq 数据源。我已经发了一个帖子来解释这个[here](http://johanleino.spaces.live.com/blog/cns!6BE273C70C45B5D1!328.entry)。

# jquery - jQuery Safari/Chrome 与可拖动的包含属性不兼容

> ID：285502
> 
> 赞同：12
> 
> 时间：2008-11-12T21:46:49.583
> 
> 标签：jquery, jquery-ui, safari, google-chrome, draggable

此代码适用于 Firefox、Internet Explorer，而不适用于 Safari/Chrome：

```
<head>
    <script type="text/javascript" src="jquery.js"></script>
    <script type="text/javascript" src="jquery-ui.js"></script>
    <script>
        function newDiv() {
            var div = $('<div id="divNew" style="width: 50px; height: 50px; border: solid 1px; background: Red"></div>');
            $('#divParent').append(div);
            div.draggable(
            {
                containment: 'parent'
            });
        }
    </script>
</head>
<body>
    <a href="javascript:;" onclick="newDiv()">new div</a>
    <div id="divParent" style="width: 500px; height: 500px; border: solid 1px;"></div>
</body> 
```

在 Safari/Chrome 中，divNew 只能垂直移动。jQuery的这个功能目前不兼容？我使用的是 1.5.2 稳定版。可以在这里找到[jQuery 1.5.2](http://jquery-ui.googlecode.com/files/jquery.ui-1.5.2.zip)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2011-03-12T11:01:16.447

我找到的解决方案是设置元素`position: absolute !important`，:)）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-08T20:36:59.673

anjalis 是对的，

```
position: absolute !important; 
```

非常适合我。当您释放并单击元素时，我遇到了一个可拖动元素从容器中略微弹出的小问题。它会轻微抵消。with`position: absolute !important`和它的父元素`position: relative;`就像一个魅力。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-23T21:23:15.597

尝试用另一个 div 包装 divParent div，然后在将 div 包装 divParent 注入 divParent 时将其设置为包含。这对我有用：

```
 <script>
        function newDiv() {
            var divs = 
              $(unescape('%3Cdiv class="divNew" style=""%3E&nbsp;%3C/div%3E'));
            divs.draggable(
            {
             containment: $('#a')
            });
            $('#divParent').append(divs);
       }
   </script>
</head>
<body>
    <style>
    .divNew {width: 50px; height: 50px;border: solid 1px; background: Red;}
    #divParent {width: 500px; height: 500px; border: solid 1px;};
    </style>
    <a href="javascript:;" onclick="newDiv()">new div</a>
    <div id="a">
      <div id="divParent" style=""> <!--<div class="divNew"></div>-->
      </div>       
    </div>
</body> 
```

**编辑：我刚刚意识到这并不完全有效。您应该检查浏览器是否基于 webkit，然后将容器设置为 1000 像素而不是 500 像素。显然，该错误似乎与正确计算宽度有关。**

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-08-25T14:45:35.517

I had some kind of similar problem, where my draggable elements were absolutely positionned, and became relatively positionned in Chrome and Safari. Adding !important to the style position:absolute made the trick.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-12-02T05:51:50.360

Jquery UI Draggable 方法不会在 Safari 和 MAC OS X 环境中以任何方式工作。因此，在编写代码时，请考虑类似：

```
if(!($browser.safari && navigator.appVersion.indexOf('Mac')!= -1)) {
    $('div.urid').draggable({
        helper: 'clone',
        opacity: 0.4
    });
} 
```

当您实现拖放时，请考虑相同...

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-19T19:17:35.273

尝试用 dom 对象替换 'parent'... 即 $("#divParent") 并查看是否可行。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-10-05T14:59:05.220

要解决此问题，您必须定义不同于透明的 WMODE。我只是设置了 wmode=window ，这在所有浏览器中都可以正常工作。

# svn - Lotus Notes/Domino 开发的版本控制最佳实践

> ID：285503
> 
> 赞同：8
> 
> 时间：2008-11-12T21:47:17.383
> 
> 标签：svn, version-control, lotus-notes, lotus-domino, lotus

请分享您如何为 Lotus Notes/Domino 开发进行版本控制。

我想将所有脚本、视图、自定义表单、脚本库等放入我们的 SVN 存储库。

半自动化的方法也被接受（即，如果我找到一种方法将表单的所有事件脚本放在一个文件中，并能够将其作为整个文件放回 Notes Designer 中）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-29T14:38:46.817

openntf 项目设计目录可用于版本控制。它使用了 kerr 提到的 dxl 技术。www.openntf.org/projects/pmt.nsf/ProjectLookup/DesignCatalog

在 lotusphere，lotus911 的人提到他们将设计目录与 Trigger Happy 结合使用。www.openntf.org/projects/pmt.nsf/ProjectLookup/Trigger%20Happy

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-20T17:56:57.430

简短的回答是，您将无法以自动化或半自动化的方式可靠地执行此操作。如果 DXL 具有完整的保真度和完整的往返能力，那么您将能够将设计元素的 DXL 导出存储在 SVN 中，但有些地方 DXL 不够好。

您将获得的唯一真正的版本控制是通过像[TeamStudio 的 CIAO](http://www.teamstudio.com/solutions/product-detail.html)产品这样的第三方供应商。

更新：

有些人报告说成功地以编码二进制格式导出元素，该格式在导入时保持完全保真度。这使得出于版本控制目的的往返行程成为可能。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-08-15T17:06:37.730

我想我可以分享一下我们是如何进行修订控制的——我们尝试了 CIAO，但是当我们不得不每天多次“重新编译所有 LotusScript”时，不断的签入/签出变得很麻烦。

我们当前的解决方案使用三个模板：**Dev**、**Test**和**Prod**。还有一个小型内部开发的实用程序数据库...

*   **可以制作开发**模板的“快照”（完整副本），并跟踪这些。
*   用我们选择的快照替换**Test**和**Prod的设计。**

此实用程序数据库的最新添加是在创建快照时*删除设计元素继承的能力。*这使我们有可能在 Dev 环境中利用设计级别继承，但保留 Test 和 Prod 模板而不会出现令人讨厌的意外（除了内置在客户端中的模板......）。

我们还进行了一些健全性检查——检查“副本”和“另一个副本”元素——猜测可以在此处添加更多功能。

我想有可能开发一个类似的解决方案，使用 SVN 作为快照文件的存储。

**编辑**

快照由[NotesDatabase.CreateCopy](http://publib.boulder.ibm.com/infocenter/domhelp/v8r0/index.jsp?topic=/com.ibm.designer.domino.main.doc/H_CREATECOPY_METHOD.html)创建。在新副本中，我们然后执行以下操作：

*   设置默认的自由 ACL。
*   [清晰的设计继承](https://stackoverflow.com/questions/1255549/remove-lotus-notes-design-element-inheritance-programatically)。
*   禁用所有代理
*   设置生成的模板名称（使用 Davide Varottos [DatabaseProperties](http://www.openntf.org/projects/codebin/codebin.nsf/0/0A43C22F85C611D686256EC1002566B5)库）
*   紧凑和标志。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-08-12T12:18:13.623

正如 Kerr 所说，Domino 的唯一完整版本控制系统（而且成本很高）是 Teamstudio CIAO！

Eclipse 中的 Domino Designer（“DDE”）构成了 Domino 工具集的一部分，从 8.5 版开始，人们谈到了添加更多主流版本控制功能。这部分取决于版本控制系统处理虚拟文件系统的能力——Notes 数据库中的设计元素都作为离散组件驻留在“NSF”文件（Notes 数据库）中，而不是磁盘上的简单平面文件（这显然适用于 Subversion、CVS 等）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-12-11T09:05:45.513

它必须是 Team Studio CIAO，是的，它不是共享软件，而且价格不便宜，但是如果您添加用于查找对象和代码（并在必要时查找和替换）的配置器和 Delta 以将模板或数据库与模板进行比较，它会付出代价本身多次。

我会定期对设计进行快照，如果您认真对待良好的版本控制，那么签入签出过程就不会那么繁琐。如果他们有内部开发人员，我将其列为我的客户必备的工具。

您只需要在开发环境中使用它，因为您不应该在 UAT 或现场进行任何代码更改！我还将代码片段和有用/可重用的功能存储在 Lotus Notes 数据库中，如果您想重用它，您可以将其剪切并粘贴到其他地方。

通过与团队工作室人员的交谈，我了解到 8.5 版本将更全面地与设计器客户端集成，因此更易于使用，尽管尚未看到它的实际应用。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-06-15T10:24:46.740

我偶然发现了这个问题。事情发生了变化，[（openntf）GIT](http://www.openntf.org/internal/home.nsf/project.xsp?action=openDocument&name=EGit%20for%20IBM%20Domino%20Designer)现在可以使用了。和/或[源代码启用 SVN/CVS](http://www.openntf.org/internal/home.nsf/project.xsp?action=openDocument&name=Source%20Control%20Enablement%20for%20Designer)。8.5.3 应该包括源代码启用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-12-27T04:47:25.130

Teamstudio 是市场上最好的产品。我用过它们，没有任何问题。它们并不便宜，但如果您正在做一些需要多个开发人员或需要控制发布过程进行更改的事情，您需要获得 CIAO。

[http://www.teamstudio.com](http://www.teamstudio.com)

注意：我没有为此背书付费/赞助。

# sql-server - sql2008中trusted_connection用的是什么用户帐号？

> ID：285504
> 
> 赞同：0
> 
> 时间：2008-11-12T21:47:51.017
> 
> 标签：sql-server, web-config

当我在 web.config 中设置 trust connection = yes 时，它使用什么用户帐户？

它是“NT AUTHORITY\NETWORK SERVICE”吗？

因为我在 Sql 管理中处于安全状态，所以我看到：NtAuthority/System only??

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-12T21:49:10.983

它使用您的应用程序池正在运行的用户，默认为“NT AUTHORITY\NETWORK SERVICE”

问题的标题应该是“当我使用trusted___connection 连接到SQL Server 时，ASP.NET 将使用什么用户帐户”。Trusted_connection 使用当前进程的（或模拟的）凭据。

您的 .NET 代码在应用程序池中运行。您可以在 IIS 配置中配置运行应用程序池的用户帐户。最佳实践是在受限用户帐户下运行应用程序池，并授予该用户登录数据库的权限。

不要将此与 IIS 匿名用户默认帐户、运行 IIS 服务的帐户或网站设置上的 IIS 安全选项卡相混淆。您可以将 Web 应用程序设置为模拟（运行为）IIS 对其进行身份验证的用户（请参阅 ASP.NET 文档中的模拟）。

抢

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-12T21:48:40.813

它将使用当前登录用户的凭据。您看到 NETWORK Service 的原因是因为 IIS 应用程序池（默认情况下）以该帐户运行。

# java - Java代码中的“持有属性值”

> ID：285506
> 
> 赞同：0
> 
> 时间：2008-11-12T21:48:42.513
> 
> 标签：java, code-generation, comments

我得到了一些带有该标题的遗留代码，几乎在每个领域都以注释的形式展开。也出现了“ `Setter for property xyz`”。

只是出于好奇，哪个 Java 工具生成了这个存根？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-12T21:51:05.237

Netbeans，如果我没记错的话。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-02T19:47:28.643

此[链接指向](https://svn.atlassian.com/svn/public/contrib/tools/javacvs/trunk/src/org/netbeans/modules/javacvs/FsLog.java)NetBeans cvs 日志模块的源文件。它包含与旧代码中相同的标题和注释。我假设他们使用 NetBeans 本身来编写这个外围模块。所以我想答案是 NetBeans。

# asp.net - 有没有办法在 Visual Studio 2008 中从 IntelliSense 中“隐藏”一个 JavaScript 文件？

> ID：285512
> 
> 赞同：3
> 
> 时间：2008-11-12T21:50:52.617
> 
> 标签：asp.net, javascript, jquery, intellisense

我有一个第三方 JavaScript 插件，但包括该文件会破坏 IntelliSense for jQuery 等。让 IntelliSense 重新使用 jQuery 的唯一方法是注释掉插件。有没有办法可以从 IntelliSense 解析器中隐藏插件文件？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-13T00:59:12.300

Service Pack 1 添加了以下功能：

如果“anyfile.js”和“anyfile-vsdoc.js”在同一个目录中，那么任何对“anyfile.js”的引用都会在后台自动转换为对“anyfile-vsdoc.js”的引用。

在插件旁边添加一个空文件，并在文件名后附加“-vsdoc”。这应该从外部 javascript 处理器“隐藏”插件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-12T22:19:10.720

您总是可以从您的代码隐藏而不是您的 aspx/master 中的脚本管理器加载它。这样 IntelliSense 就不会知道它的存在。使用 ScriptManager.RegisterClientScriptInclude(..)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-12T22:20:18.610

可能是您使用的第三方 JavaScript 插件有一些错误。
我会检查[JSLint](http://www.jslint.com/)中的代码并将这个问题指向插件的作者。
至于问题本身：如果它是项目的一部分，我认为您不能排除它，但请[查看 MSDN：使用 IntelliSense](http://msdn.microsoft.com/en-us/library/hcw1s69b(VS.71).aspx)来证明它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-24T00:18:09.747

由于您提到了 jQuery，您还可以在运行时加载麻烦的脚本。

$.getScript("XXX.js");

# c# - SQL DB 中的 Asp.net 会话变量

> ID：285517
> 
> 赞同：2
> 
> 时间：2008-11-12T21:53:55.623
> 
> 标签：c#, asp.net

我使用表单身份验证创建了一个自定义登录页面，并使用 SQL DB 来存储用户数据。我能够从用户名创建一个会话变量，但想知道是否可以提取一个单独的字段并基于该字段创建一个会话变量。我希望会话变量基于 SalesNumber 一个 5 位十进制字段。请给我任何意见或建议。

```
cmd = new SqlCommand("Select pwd,SalesNumber from users where uname=@userName", conn);
cmd.Parameters.Add("@userName", System.Data.SqlDbType.VarChar, 25);
cmd.Parameters["@userName"].Value = userName;
Session["userName"] = userName; 
```

谢谢....

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-13T00:44:18.290

当您从数据库查询中获取 SalesNumber 时，只需使用

```
Session["SalesNumber"] = <the value of the SalesNumber column from the query> 
```

还是我在问题中遗漏了其他东西......？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-13T01:25:48.550

在您的 DAL 中，只需创建您的登录序列，例如：

```
public bool LoginUser(String username, String password)
{ 
    bool r = false;
    using (SqlConnection cn = new SqlConnection(ConfigurationManager.ConnectionStrings["DBConn"].ConnectionString))
    {
        using(SqlCommand cm = new SqlCommand())
        {
            cm.Connection = cn;
            cm.CommandType = CommandType.Text;
            cm.CommandText = "SELECT Name, SalesNumber FROM users WHERE uname = @username AND pwd = @password;";
            cm.Parameters.AddWithValue("@username", username);
            cm.Parameters.AddWithValue("@password", password);

            cn.Open();
            SqlDataReader dr = cm.ExecuteReader();

            if (dr.HasRows)
            {
                // user exists
                HttpContext.Current.Session["SalesNumber"] = dr["SalesNumber"].ToString();
                HttpContext.Current.Session["Username"] = username;
                HttpContext.Current.Session["Name"] = dr["Name"].ToString();

                r = true;
            }
            else
            { 
                // Clear all sessions
                HttpContext.Current.Session["SalesNumber"] = "";
                HttpContext.Current.Session["Username"] = "";
                HttpContext.Current.Session["Name"] = "";
            }
        }
    }
    return r;
} 
```

从您的代码中，在登录按钮单击事件中添加

```
if (dalLogin.LoginUser(TextBoxUsername.Text.Trim(), TextBoxPassword.text.Trim()))
{
    // User logged in sucessfuly
    // all sessions are available
    Response.Redirect("homepage.aspx");
}
else
{ 
    // Username and password did not match! show error
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-13T02:13:43.400

另请记住，您可以在会话中存储整个对象而不是单独的变量：

```
UserObject user = DAL.GetUserObject(userName);
Session["CurrentUser"] = user;
// Later...
UserObject user = Session["CurrentUser"] as UserObject;
// ... 
```

要添加，您可以将其包装在一个不错的属性中：

```
private UserObject CurrentUser
{
     get
     {
          return this.Session["CurrentUser"] as UserObject;
     }
     set
     {
          this.Session["CurrentUser"] = value;
     }
} 
```

# apache-flex - 如何在 actionscript / flex 中创建“全局事件”？

> ID：285520
> 
> 赞同：1
> 
> 时间：2008-11-12T21:54:31.753
> 
> 标签：apache-flex, actionscript, events, globalevent

在 flex/actionscript 中创建“全局事件”的最佳方法是什么 - 最好使用静态类？

我想引发一个事件来指示样式表已加载，以便显示需要该样式表的组件。所以我希望应用程序的每个部分都需要样式表中的样式来监听一个事件，告诉它样式都已加载。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-13T09:08:53.997

制作一个[Singleton](http://en.wikipedia.org/wiki/Singleton_pattern)并为其添加侦听器，既美观又简单。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-03-14T07:28:05.990

使用[**robotlegs**](http://www.robotlegs.org/)，简单且[**无Singleton**](http://googletesting.blogspot.com/2008/08/root-cause-of-singletons.html)！

# .net - 如何延长客户端发布 .NET Web 服务帖子的超时时间？

> ID：285521
> 
> 赞同：2
> 
> 时间：2008-11-12T21:54:48.710
> 
> 标签：.net, asp.net, web-services

我正在从 .NET 控制台应用程序向 .NET Web 服务发布帖子。我知道服务器端的超时时间是 20 分钟，但是如果我的客户端花费超过 100 秒的时间将我的数据发布到该服务，那么我会收到超时异常。我如何告诉我的客户等待可用的 20 分钟超时？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-12T22:04:04.150

在客户端，您的 web 服务对象有一个超时值。通过以下方式设置应该很容易：

```
myServiceInstance.Timeout = 1200000 
```

20分钟

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-12T22:09:41.003

您需要验证 <httpRuntime executionTimeout="1200"/> 是否存在于 web 服务本身的 web.config 中，以确认您的 20 分钟。

您的控制台应用程序中的服务代理类实例也需要设置。需要设置一个 Timeout 属性（以毫秒为单位），因此您可以执行以下操作：

MyServiceClass myService = new MyServiceClass(); myService.Timeout = 1200000;

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-12T22:06:42.617

是的，`ServiceInstance.Timeout`是要设置的属性。

我在这里写了博客 [http://stackpanel.com/blog/2008/10/client-timeout-accessing-asmx-web-service/](http://stackpanel.com/blog/2008/10/client-timeout-accessing-asmx-web-service/)

# javascript - 查找与给定输入关联的 html 标签

> ID：285522
> 
> 赞同：125
> 
> 时间：2008-11-12T21:55:09.910
> 
> 标签：javascript, html, label

假设我有一个 html 表单。每个 input/select/textarea 都会有一个对应`<label>`的属性，该`for`属性设置为它的同伴的 id。在这种情况下，我知道每个输入将只有一个标签。

给定 javascript 中的输入元素——例如，通过 onkeyup 事件——找到它的关联标签的最佳方法是什么？

* * *

## 回答 #1

> 赞同：109
> 
> 时间：2008-11-12T22:12:12.763

如果你使用 jQuery，你可以做这样的事情

```
$('label[for="foo"]').hide (); 
```

如果您不使用 jQuery，则必须搜索标签。这是一个将元素作为参数并返回关联标签的函数

```
function findLableForControl(el) {
   var idVal = el.id;
   labels = document.getElementsByTagName('label');
   for( var i = 0; i < labels.length; i++ ) {
      if (labels[i].htmlFor == idVal)
           return labels[i];
   }
} 
```

* * *

## 回答 #2

> 赞同：96
> 
> 时间：2008-11-12T22:24:05.750

首先，扫描页面中的标签，并从实际的表单元素中分配对标签的引用：

```
var labels = document.getElementsByTagName('LABEL');
for (var i = 0; i < labels.length; i++) {
    if (labels[i].htmlFor != '') {
         var elem = document.getElementById(labels[i].htmlFor);
         if (elem)
            elem.label = labels[i];         
    }
} 
```

然后，你可以简单地去：

```
document.getElementById('MyFormElem').label.innerHTML = 'Look ma this works!'; 
```

不需要查找数组:)

* * *

## 回答 #3

> 赞同：41
> 
> 时间：2013-02-25T06:16:12.090

[HTML5 标准](http://www.w3.org/TR/2012/WD-html5-20121025/the-label-element.html#dom-lfe-labels)中有一个`labels`属性指向与输入元素关联的标签。

所以你可以使用这样的东西（支持本机`labels`属性，但在浏览器不支持的情况下检索标签有一个后备）......

```
var getLabelsForInputElement = function(element) {
    var labels = [];
    var id = element.id;

    if (element.labels) {
        return element.labels;
    }

    id && Array.prototype.push
        .apply(labels, document.querySelector("label[for='" + id + "']"));

    while (element = element.parentNode) {
        if (element.tagName.toLowerCase() == "label") {
            labels.push(element);
        }  
    }

    return labels;
};

// ES6
var getLabelsForInputElement = (element) => {
    let labels;
    let id = element.id;

    if (element.labels) {
        return element.labels;
    }

    if (id) {
        labels = Array.from(document.querySelector(`label[for='${id}']`)));
    }

    while (element = element.parentNode) {
        if (element.tagName.toLowerCase() == "label") {
            labels.push(element);
        }  
    }

    return labels;
}; 
```

如果你使用 jQuery，那就更容易了……

```
var getLabelsForInputElement = function(element) {
    var labels = $();
    var id = element.id;

    if (element.labels) {
        return element.labels;
    }

    id && (labels = $("label[for='" + id  + "']")));

    labels = labels.add($(element).parents("label"));

    return labels;
}; 
```

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2012-01-18T15:46:43.000

我有点惊讶，似乎没有人知道你[完全可以](http://www.w3.org/TR/html401/interact/forms.html#h-17.9.1)这样做：

```
<label>Put your stuff here: <input value="Stuff"></label> 
```

任何建议的答案都不会选择它，但**会**正确标记输入。

这是一些考虑到这种情况的代码：

```
$.fn.getLabels = function() {
    return this.map(function() {
        var labels = $(this).parents('label');
        if (this.id) {
            labels.add('label[for="' + this.id + '"]');
        }
        return labels.get();
    });
}; 
```

用法：

```
$('#myfancyinput').getLabels(); 
```

一些注意事项：

*   编写代码是为了清晰，而不是为了性能。可能会提供更多性能更好的替代方案。
*   此代码支持一次性获取多个项目的标签。如果那不是您想要的，请根据需要进行调整。
*   这仍然不能解决[`aria-labelledby`](http://www.w3.org/TR/wai-aria/states_and_properties#aria-labelledby)您是否要使用它（留给读者作为练习）之类的事情。
*   当涉及到支持不同的用户代理和辅助技术时，使用多个标签是一项棘手的工作，因此请做好测试并自行承担使用风险等。
*   是的，您也可以在不使用 jQuery 的情况下实现这一点。:-)

* * *

## 回答 #5

> 赞同：22
> 
> 时间：2017-07-20T07:16:32.273

document.querySelector("label[for=" + vHtmlInputElement.id + "]");

这以最简单和最精简的方式回答了这个问题。这使用 vanilla javascript 并适用于所有主流适当的浏览器。

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2008-11-12T22:10:19.520

早些时候...

```
var labels = document.getElementsByTagName("LABEL"),
    lookup = {},
    i, label;

for (i = 0; i < labels.length; i++) {
    label = labels[i];
    if (document.getElementById(label.htmlFor)) {
        lookup[label.htmlFor] = label;
    }
} 
```

之后...

```
var myLabel = lookup[myInput.id]; 
```

尖刻评论：是的，你也可以用 JQuery 来做。:-)

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2017-11-14T02:24:07.897

所有其他答案都**非常**过时！

你所要做的就是：

```
input.labels 
```

多年来，所有主要浏览器都支持 HTML5。绝对没有理由您必须自己从头开始制作或填充它！从字面上看，只需使用`input.labels`它就可以解决您的所有问题。

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2008-11-12T22:15:04.550

使用 jquery 你可以做类似的事情

```
var nameOfLabel = someInput.attr('id');
var label = $("label[for='" + nameOfLabel + "']"); 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2015-08-11T12:25:45.763

如果您愿意使用[querySelector](http://caniuse.com/#search=queryselector)（您可以，甚至可以使用 IE9，有时甚至可以使用 IE8！），另一种方法变得可行。

如果你的表单域有一个 ID，并且你使用标签的`for`属性，这在现代 JavaScript 中变得非常简单：

```
var form = document.querySelector('.sample-form');
var formFields = form.querySelectorAll('.form-field');

[].forEach.call(formFields, function (formField) {
    var inputId = formField.id;
    var label = form.querySelector('label[for=' + inputId + ']');
    console.log(label.textContent);
}); 
```

有些人注意到多个标签；如果它们都对属性使用相同的值`for`，只需使用`querySelectorAll`而不是`querySelector`并循环获取所需的一切。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2011-09-05T06:24:58.960

```
$("label[for='inputId']").text() 
```

这帮助我使用其 ID 获取输入元素的标签。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2012-10-24T10:48:37.477

Gijs 的回答对我来说最有价值，但不幸的是扩展不起作用。

这是一个有效的重写扩展，它可能对某人有所帮助：

```
jQuery.fn.getLabels = function () {
    return this.map(function () {
        var parentLabels = $(this).parents('label').get();
        var associatedLabels = this.id ? associatedLabels = $("label[for='" + this.id + "']").get() : [];
        return parentLabels.concat(associatedLabels);
    });
}; 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2018-05-03T00:20:39.270

使用 ES6 特性（如解构和隐式返回）将其变成方便的单行列的一个非常简洁的解决方案是：

```
const getLabels = ({ labels, id }) => labels || document.querySelectorAll(`label[for=${id}]`) 
```

或者简单地获得一个标签，而不是 NodeList：

```
const getFirstLabel = ({ labels, id }) => labels && labels[0] || document.querySelector(`label[for=${id}]`) 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2021-08-12T21:34:10.440

## 解决方案一`<label>`：一`<input>`

使用[HTML 5.2 参考](https://www.w3.org/TR/html52/sec-forms.html#the-label-element) 考虑到using的`<label>`指向，*labels*元素将是一个非空数组，并充当元素的链接，访问它的所有属性，包括它的.`<input>``for=`*`<label>``id=`*

 *```
function myFunction() {
  document.getElementById("p1").innerHTML = "The first label associated with input: <b>" + document.getElementById("input4").labels[0].id + "</b>";

}
```

```
<form>
  <label id="theLabel" for="input4">my id is "theLabel"</label>
  <input name="name1" id="input4" value="my id is input4">
  <br>
</form>

<p>Click the "click me" button to see the label properties</p>

<button onclick="myFunction()">click me</button>

<p id="p1"></p>
```

* * *

## 解决方案多`<label>`：一个`<input>`

使用多个`<label>`using`for=`时，您可以创建一个循环来显示所有这些，如下所示：

```
function myFunction2() {

var x = document.getElementById("input7").labels;
let text = "";
for (let i = 0; i < x.length; i++) {
  text += x[i].id + "<br>";
}
document.getElementById("p7").innerHTML = text;
}
```

```
<b>Three labels for one input</b><br>
<br>
<form>
  <label id="theLabel2" for="input7">my id is "theLabel2</label><br>
  <label id="theLabel3" for="input7">my id is "theLabel3</label><br>
  <label id="theLabel4" for="input7">my id is "theLabel4</label><br>
  <input name="name1" id="input7" value="my id is input7">
  <br>
</form>

<p>Click the "click me" button to see the label properties</p>
<button onclick="myFunction2()">click me2</button>

<p id="p7"></p>
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2013-11-26T18:29:34.783

实际上，在表单本身的标签中添加 id 要容易得多，例如：

```
<label for="firstName" id="firstNameLabel">FirstName:</label>

<input type="text" id="firstName" name="firstName" class="input_Field" 
       pattern="^[a-zA-Z\s\-]{2,25}$" maxlength="25"
       title="Alphabetic, Space, Dash Only, 2-25 Characters Long" 
       autocomplete="on" required
/> 
```

然后，你可以简单地使用这样的东西：

```
if (myvariableforpagelang == 'es') {
   // set field label to spanish
   document.getElementById("firstNameLabel").innerHTML = "Primer Nombre:";
   // set field tooltip (title to spanish
   document.getElementById("firstName").title = "Alfabética, espacio, guión Sólo, 2-25 caracteres de longitud";
} 
```

javascript 必须在 body onload 函数中才能工作。

只是一个想法，对我来说很好用。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2013-12-17T11:23:11.020

正如已经提到的，（当前）评价最高的答案没有考虑在标签中嵌入输入的可能性。

由于没有人发布无 JQuery 的答案，这是我的：

```
var labels = form.getElementsByTagName ('label');
var input_label = {};
for (var i = 0 ; i != labels.length ; i++)
{
    var label = labels[i];
    var input = label.htmlFor
              ? document.getElementById(label.htmlFor)
              : label.getElementsByTagName('input')[0];
    input_label[input.outerHTML] = 
        (label.innerText || label.textContent); // innerText for IE8-
} 
```

在此示例中，为简单起见，查找表直接由输入的 HTML 元素索引。这几乎没有效率，你可以随心所欲地调整它。

如果您想一次获取多个表单的标签，您可以使用表单作为基本元素，或者整个文档。

不检查不正确的 HTML（标签内有多个或缺少输入，缺少相应 htmlFor id 的输入等），但可以随意添加它们。

您可能想要修剪标签文本，因为当输入嵌入标签时，通常会出现尾随空格。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2018-07-14T01:43:27.287

最佳答案工作得很好，但在大多数情况下，循环遍历所有`label`元素是过度的和低效的。

这是一个获取`label`元素的有效函数`input`：

```
function getLabelForInput(id)
{
    var el = document.getElementById(id);
    if (!el)
        return null;
    var elPrev = el.previousElementSibling;
    var elNext = el.nextElementSibling;
    while (elPrev || elNext)
    {
        if (elPrev)
        {
            if (elPrev.htmlFor === id)
                return elPrev;
            elPrev = elPrev.previousElementSibling;
        }
        if (elNext)
        {
            if (elNext.htmlFor === id)
                return elNext;
            elNext = elNext.nextElementSibling;
        }
    }
    return null;
} 
```

对我来说，这一行代码就足够了：

```
el = document.getElementById(id).previousElementSibling; 
```

在大多数情况下，`label`将非常接近或靠近输入，这意味着上述函数中的循环只需要迭代非常少的次数。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2011-04-12T20:11:35.277

使用 JQuery 选择器：

```
$("label[for="+inputElement.id+"]") 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2011-08-19T12:56:08.700

对于未来的搜索者......以下是 FlySwat 接受的答案的 jQuery 化版本：

```
var labels = $("label");
for (var i = 0; i < labels.length; i++) {
    var fieldId = labels[i].htmlFor;
    if (fieldId != "") {
        var elem = $("#" + fieldId);
        if (elem.length != 0) {
            elem.data("label", $(labels[i]));   
        }
    }
} 
```

使用：

```
$("#myFormElemId").data("label").css("border","3px solid red"); 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2014-05-21T18:07:29.867

我知道这已经过时了，但是我在一些解决方案上遇到了麻烦，并将其拼凑在一起。我已经在 Windows（Chrome、Firefox 和 MSIE）和 OS X（Chrome 和 Safari）上对此进行了测试，并相信这是最简单的解决方案。它适用于这三种附加标签的方式。

```
<label><input type="checkbox" class="c123" id="cb1" name="item1">item1</label>

<input type="checkbox" class="c123" id="cb2" name="item2">item2</input>

<input type="checkbox" class="c123" id="cb3" name="item3"><label for="cb3">item3</label> 
```

使用 jQuery：

```
$(".c123").click(function() {
    $cb = $(this);
    $lb = $(this).parent();
    alert( $cb.attr('id') + ' = ' + $lb.text() );
}); 
```

我的 JSFiddle：http: [//jsfiddle.net/pnosko/6PQCw/](http://jsfiddle.net/pnosko/6PQCw/)

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2014-11-26T22:53:07.417

我为自己的需要而做的，可能对某人有用：[JSFIDDLE](http://jsfiddle.net/itsazzad/pq8w1e9p/1/)

```
$("input").each(function () {
    if ($.trim($(this).prev('label').text()) != "") {
        console.log("\nprev>children:");
        console.log($.trim($(this).prev('label').text()));
    } else {
        if ($.trim($(this).parent('label').text()) != "") {
            console.log("\nparent>children:");
            console.log($.trim($(this).parent('label').text()));
        } else {
            if ($.trim($(this).parent().prev('label').text()) != "") {
                console.log("\nparent>prev>children:");
                console.log($.trim($(this).parent().prev('label').text()));
            } else {
                console.log("NOTFOUND! So set your own condition now");
            }
        }
    }
}); 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2017-01-20T05:47:23.967

我有点惊讶没有人建议使用 CSS 关系方法？

在样式表中，您可以从元素选择器中引用标签：

```
<style>

//for input element with class 'YYY'
input.YYY + label {}

</style> 
```

如果复选框的 id 为“XXX”，则可以通过 jQuery 通过以下方式找到该标签：

```
$('#XXX + label'); 
```

您还可以应用 .find('+ label') 从 jQuery 复选框元素返回标签，即在循环时很有用：

```
$('input[type=checkbox]').each( function(){
   $(this).find('+ label');
}); 
```

# java - java中增强for循环的最后一次迭代

> ID：285523
> 
> 赞同：146
> 
> 时间：2008-11-12T21:56:23.683
> 
> 标签：java, for-loop, foreach, conditional-execution

有没有办法确定循环是否最后一次迭代。我的代码看起来像这样：

```
int[] array = {1, 2, 3...};
StringBuilder builder = new StringBuilder();

for(int i : array)
{
    builder.append("" + i);
    if(!lastiteration)
        builder.append(",");
} 
```

现在问题是我不想在最后一次迭代中附加逗号。现在有办法确定它是最后一次迭代，还是我坚持使用 for 循环或使用外部计数器来跟踪。

* * *

## 回答 #1

> 赞同：224
> 
> 时间：2008-11-12T22:06:01.480

另一种选择是在附加 i 之前附加逗号，而不是在*第一次*迭代中。（顺便说一下，请不要使用`"" + i`- 你真的不想在这里连接，而且 StringBuilder 有一个非常好的 append(int) 重载。）

```
int[] array = {1, 2, 3...};
StringBuilder builder = new StringBuilder();

for (int i : array) {
    if (builder.length() != 0) {
        builder.append(",");
    }
    builder.append(i);
} 
```

这样做的好处是它可以与任何东西一起使用`Iterable`——你不能总是索引东西。（当您真正使用 StringBuilder 时，“添加逗号然后在末尾删除它”是一个不错的建议 - 但它不适用于写入流之类的事情。不过，这可能是解决这个确切问题的最佳方法。 )

* * *

## 回答 #2

> 赞同：147
> 
> 时间：2008-11-12T22:30:04.957

另一种方法：

```
String delim = "";
for (int i : ints) {
    sb.append(delim).append(i);
    delim = ",";
} 
```

更新：对于 Java 8，您现在拥有[收集器](http://docs.oracle.com/javase/8/docs/api/java/util/stream/Collectors.html)

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2008-11-12T22:01:49.273

总是追加可能更容易。然后，当您完成循环后，只需删除最后一个字符。这样也少了很多条件。

您可以将`StringBuilder`'s`deleteCharAt(int index)`与索引一起使用`length() - 1`

* * *

## 回答 #4

> 赞同：33
> 
> 时间：2008-11-12T22:13:29.623

也许您为工作使用了错误的工具。

这比你正在做的更手动，但它在某种程度上更优雅，如果不是有点“老派”

```
 StringBuffer buffer = new StringBuffer();
 Iterator iter = s.iterator();
 while (iter.hasNext()) {
      buffer.append(iter.next());
      if (iter.hasNext()) {
            buffer.append(delimiter);
      }
 } 
```

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2009-03-21T12:35:06.300

这几乎是[这个 StackOverflow 问题](https://stackoverflow.com/questions/187676/string-operations-in-java/187738#187738)的重复。你想要的是**StringUtils**，并调用**join**方法。

```
StringUtils.join(strArr, ','); 
```

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2008-11-12T22:20:05.040

另一种解决方案（也许是最有效的）

```
 int[] array = {1, 2, 3};
    StringBuilder builder = new StringBuilder();

    if (array.length != 0) {
        builder.append(array[0]);
        for (int i = 1; i < array.length; i++ )
        {
            builder.append(",");
            builder.append(array[i]);
        }
    } 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2008-11-12T22:04:06.133

保持简单并使用标准 for 循环：

```
for(int i = 0 ; i < array.length ; i ++ ){
    builder.append(array[i]);
    if( i != array.length - 1 ){
        builder.append(',');
    }
} 
```

或者只使用 apache [commons-lang StringUtils.join()](http://commons.apache.org/lang/api-release/org/apache/commons/lang/StringUtils.html#join(java.lang.Object[],%20char))

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2008-11-12T22:05:33.320

显式循环总是比隐式循环更好。

```
builder.append( "" + array[0] );
for( int i = 1; i != array.length; i += 1 ) {
   builder.append( ", " + array[i] );
} 
```

您应该将整个内容包装在一个 if 语句中，以防万一您正在处理一个零长度数组。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2008-11-12T22:03:45.510

如果将其转换为经典的索引循环，是的。

或者您可以在完成后删除最后一个逗号。像这样：

```
int[] array = {1, 2, 3...};
StringBuilder

builder = new StringBuilder();

for(int i : array)
{
    builder.append(i + ",");
}

if(builder.charAt((builder.length() - 1) == ','))
    builder.deleteCharAt(builder.length() - 1); 
```

我，我只是使用[`StringUtils.join()`](http://commons.apache.org/lang/api-release/org/apache/commons/lang/StringUtils.html#join(java.util.Collection,%20char))commons [-lang](http://commons.apache.org/lang/)。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2016-11-11T01:24:50.937

正如工具包所提到的，在 Java 8 中，我们现在有了[Collectors](http://docs.oracle.com/javase/8/docs/api/java/util/stream/Collectors.html)。下面是代码的样子：

```
String joined = array.stream().map(Object::toString).collect(Collectors.joining(", ")); 
```

我认为这正是您正在寻找的，这是一种您可以用于许多其他事情的模式。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2008-11-14T10:00:00.410

你需要[类分隔符](http://ssdl-wiki.cs.technion.ac.il/wiki/index.php/Class_Separator)。

```
Separator s = new Separator(", ");
for(int i : array)
{
     builder.append(s).append(i);
} 
```

类的实现`Separator`是直截了当的。它包装了一个字符串，该字符串在每次调用时都返回，`toString()`但第一次调用除外，第一次调用返回一个空字符串。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2009-03-21T12:13:06.120

基于 java.util.AbstractCollection.toString()，它提前退出以避免分隔符。

```
StringBuffer buffer = new StringBuffer();
Iterator iter = s.iterator();
for (;;) {
  buffer.append(iter.next());
  if (! iter.hasNext())
    break;
  buffer.append(delimiter);
} 
```

它高效而优雅，但不像其他一些答案那样不言而喻。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2008-11-12T22:06:54.643

这是一个解决方案：

```
int[] array = {1, 2, 3...};
StringBuilder builder = new StringBuilder();
bool firstiteration=true;

for(int i : array)
{
    if(!firstiteration)
        builder.append(",");

    builder.append("" + i);
    firstiteration=false;
} 
```

寻找第一次迭代:)  

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-03-21T19:23:01.467

恕我直言，这里描述的许多解决方案都有些过头了，尤其是那些依赖外部库的解决方案。有一个很好的干净、清晰的习惯用法来实现我一直使用的逗号分隔列表。它依赖于条件 (?) 运算符：

**编辑**：原始解决方案正确，但根据评论不是最佳的。第二次尝试：

```
 int[] array = {1, 2, 3};
    StringBuilder builder = new StringBuilder();
    for (int i = 0 ;  i < array.length; i++)
           builder.append(i == 0 ? "" : ",").append(array[i]); 
```

就这样，在 4 行代码中，包括数组的声明和 StringBuilder。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-03-21T12:25:45.027

又一个选择。

```
StringBuilder builder = new StringBuilder();
for(int i : array)
    builder.append(',').append(i);
String text = builder.toString();
if (text.startsWith(",")) text=text.substring(1); 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2014-08-01T14:58:26.127

这是我运行的 SSCCE 基准测试（与我必须实施的相关），结果如下：

```
elapsed time with checks at every iteration: 12055(ms)
elapsed time with deletion at the end: 11977(ms) 
```

至少在我的示例中，在每次迭代时跳过检查并没有明显更快，特别是对于正常的数据量，但它**更快**。

```
import java.util.ArrayList;
import java.util.List;

public class TestCommas {

  public static String GetUrlsIn(int aProjectID, List<String> aUrls, boolean aPreferChecks)
  {

    if (aPreferChecks) {

      StringBuffer sql = new StringBuffer("select * from mytable_" + aProjectID + " WHERE hash IN ");

      StringBuffer inHashes = new StringBuffer("(");
      StringBuffer inURLs = new StringBuffer("(");

      if (aUrls.size() > 0)
      {

      for (String url : aUrls)
      {

        if (inHashes.length() > 0) {
        inHashes.append(",");
        inURLs.append(",");
        }

        inHashes.append(url.hashCode());

        inURLs.append("\"").append(url.replace("\"", "\\\"")).append("\"");//.append(",");

      }

      }

      inHashes.append(")");
      inURLs.append(")");

      return sql.append(inHashes).append(" AND url IN ").append(inURLs).toString();
    }

    else {

      StringBuffer sql = new StringBuffer("select * from mytable" + aProjectID + " WHERE hash IN ");

      StringBuffer inHashes = new StringBuffer("(");
      StringBuffer inURLs = new StringBuffer("(");

      if (aUrls.size() > 0)
      {

      for (String url : aUrls)
      {
        inHashes.append(url.hashCode()).append(","); 

        inURLs.append("\"").append(url.replace("\"", "\\\"")).append("\"").append(",");
      }

      }

      inHashes.deleteCharAt(inHashes.length()-1);
      inURLs.deleteCharAt(inURLs.length()-1);

      inHashes.append(")");
      inURLs.append(")");

      return sql.append(inHashes).append(" AND url IN ").append(inURLs).toString();
    }

  }

  public static void main(String[] args) { 
        List<String> urls = new ArrayList<String>();

    for (int i = 0; i < 10000; i++) {
      urls.add("http://www.google.com/" + System.currentTimeMillis());
      urls.add("http://www.yahoo.com/" + System.currentTimeMillis());
      urls.add("http://www.bing.com/" + System.currentTimeMillis());
    }

    long startTime = System.currentTimeMillis();
    for (int i = 0; i < 300; i++) {
      GetUrlsIn(5, urls, true);
    }
    long endTime = System.currentTimeMillis();
    System.out.println("elapsed time with checks at every iteration: " + (endTime-startTime) + "(ms)");

    startTime = System.currentTimeMillis();
    for (int i = 0; i < 300; i++) {
      GetUrlsIn(5, urls, false);
    }
    endTime = System.currentTimeMillis();
    System.out.println("elapsed time with deletion at the end: " + (endTime-startTime) + "(ms)");
  }
} 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-11-12T22:06:10.030

另一种方法是将数组的长度（如果可用）存储在一个单独的变量中（比每次重新检查长度更有效）。然后，您可以将索引与该长度进行比较，以确定是否添加最后一个逗号。

编辑：另一个考虑因素是权衡删除最终字符（可能导致字符串复制）与在每次迭代中检查条件的性能成本。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-11-12T22:08:03.113

这里有两条替代路径：

1：[Apache Commons 字符串实用程序](https://commons.apache.org/proper/commons-lang/javadocs/api-release/org/apache/commons/lang3/StringUtils.html#join(java.lang.Object[],%20char))

2：保持一个名为 的布尔值`first`，设置为真。在每次迭代中，如果`first`为假，请附加逗号；之后，设置`first`为假。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-11-12T22:44:58.983

如果您只是将数组转换为逗号分隔的数组，那么许多语言都有专门的连接函数。它将一个数组变成一个字符串，每个元素之间都有一个分隔符。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2011-05-24T06:58:48.717

在这种情况下，真的不需要知道它是否是最后一次重复。我们有很多方法可以解决这个问题。一种方法是：

```
String del = null;
for(int i : array)
{
    if (del != null)
       builder.append(del);
    else
       del = ",";
    builder.append(i);
} 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2017-06-15T02:55:50.353

由于它是一个固定数组，因此更容易避免增强 for... 如果 Object 是一个集合，则迭代器会更容易。

```
int nums[] = getNumbersArray();
StringBuilder builder = new StringBuilder();

// non enhanced version
for(int i = 0; i < nums.length; i++){
   builder.append(nums[i]);
   if(i < nums.length - 1){
       builder.append(",");
   }   
}

//using iterator
Iterator<int> numIter = Arrays.asList(nums).iterator();

while(numIter.hasNext()){
   int num = numIter.next();
   builder.append(num);
   if(numIter.hasNext()){
      builder.append(",");
   }
} 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2021-11-10T10:50:53.767

您可以使用[StringJoiner](https://self-learning-java-tutorial.blogspot.com/2015/12/stringjoiner-class.html)。

```
int[] array = { 1, 2, 3 };
StringJoiner stringJoiner = new StringJoiner(",");

for (int i : array) {
    stringJoiner.add(String.valueOf(i));
}

System.out.println(stringJoiner); 
```

# vb.net - 如何防止在 XML Literals (VB.NET) 中嵌入表达式的 HTML 编码？

> ID：285524
> 
> 赞同：7
> 
> 时间：2008-11-12T21:56:40.033
> 
> 标签：vb.net, xml-literals

使用以下代码：

```
Dim x As System.Xml.Linq.XElement = _
<div>
<%= message.ToString() %>
</div>
Dim m = x.ToString() 
```

...如果消息是 HTML，则 < 和 > 字符将转换为`&lt;`and `&rt;`。

如何强制它跳过此编码？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-30T06:14:25.697

你的`message`变量是什么类型的？如果`message`是`XElement`，那么只需`.ToString`像这样停止通话：

```
Dim x As System.Xml.Linq.XElement = _
    <div>
        <%= message %>
    </div>
Dim m = x.ToString() 
```

如果`message`是其他类型（如`StringBuilder`），则执行以下操作：

```
Dim x As System.Xml.Linq.XElement = _
    <div>
        <%= XElement.Parse(message.ToString()) %>
    </div>
Dim m = x.ToString() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-13T01:48:54.243

您需要将 HTML 片段作为 XML 文档打开，并将文档节点附加到您正在创建的 Div 节点。

如果您想将 XML（或 HTML）添加到现有的 XML 文档中，那么您必须将其添加为 XML 而不是文本（因为会被编码）。

# c# - 从桌面开发转向 Web 开发

> ID：285541
> 
> 赞同：10
> 
> 时间：2008-11-12T22:05:06.270
> 
> 标签：c#, asp.net, ruby-on-rails, ruby

到目前为止，我所有的编程经验都是桌面开发（主要是使用 OpenGL/DirectX 的 C/C++），但我有兴趣尝试一些 Web 开发。

我正在考虑的两个方向是 Ruby on Rails 和 ASP.net。

哪个应用最广泛？

拥有哪种技能更有市场价值？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-12T22:23:27.873

PHP、Ruby On Rails、ASP.Net 或 Java。

这是一个宗教选择，这取决于你问谁。

你问的每个人都会给你不同的答案。

你应该问问自己你想如何工作，PHP java 和 ASP 都允许你编写代码，这些代码中穿插着代码或为你编写代码的代码。

老实说，这是主观的，没有人能给你一个直接的答案。

鉴于您的两种选择，尽管 ASP 可能是行业的更好选择，但其中有很多钱，而且 C# 与 C/C++ 足够接近，因此可读。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-13T06:17:55.527

为什么不花几天或一周的时间来试验 Rails，只是为了好玩？您可能会像以前的许多其他开发人员一样，真正喜欢它并“爱上” Ruby 并重新激发您对编程的兴趣。如果不是，您只需拥抱 ASP.net，无论如何您都会感觉更自然。

其他评论者没有提到 Ruby 和 Rails 的第一大优势是“编程的乐趣”。

Alsa 现在非常需要有才华的 Ruby 程序员。需求远大于供应。您可以根据收入潜力进行数学计算。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-12T22:31:06.327

我将大部分时间都花在了 ASP.NET 开发上，最近由于难以真正测试我的应用程序，我转而反对它。就像上面概述的 lubos hasko 一样，有了 ASP.NET MVC、LINQ 和 C# 中的新功能，甚至能够编写可供 Silverlight 使用的 .NET Web 服务，我再次对此感到兴奋，并认为你可以做得很好进去。就是说，我对 Ruby 没有经验，但是在对这里的一些评论之后，我想我会看看它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-12T22:10:26.713

学习 Ruby 将帮助您学习一种不同的编程思维方式。即使您确定它不是适合您的语言，它也会帮助您成为更好的程序员。这同样适用于其他几种语言（包括 Python）。Ruby 开发人员的工作机会较少。

ASP.Net 是一种相当普通的方式来开发相当普通的 web 应用程序，它并没有真正挑战你作为程序员的想法。工作和咨询机会更为常见。

从这一点开始，这是你的电话。六年前我选择了 Ruby。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-12T22:16:34.110

如果您打算进行企业业务开发，那么 ASP.NET 会胜出（恕我直言）。

如果没有，RoR 肯定会增加您的知识广度。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-13T08:48:32.323

我建议在做出决定之前先看看[Rails for .NET Developers](http://pragprog.com/titles/cerailn/rails-for-net-developers)这本书。至少，浏览一下[Softies on Rails](http://www.softiesonrails.com/2005/9/30/welcome)博客。

请注意“周围有更多 .NET 作业”的说法。这可能是真的，但在困难时期（即现在和未来一两年），您可能会看到越来越多的.NET 开发人员争夺越来越少的工作。好时代的大量工作等同于坏时代的大量竞争。因此，值得[扩展](http://www.tbray.org/ongoing/When/200x/2008/10/24/No-Tech-Religion)并学习新的东西。就适销性而言，关键是[保持敏捷](http://www.tbray.org/ongoing/When/200x/2008/10/12/Tough-Times-Agility)而不是虔诚地坚持一种技术。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-12T22:18:57.413

.NET 平台，毫无疑问。

选择 RoR 作为辅助。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-13T00:17:49.077

作为一个 C++，你可能不会喜欢 Ruby 的性质和特性。你甚至可能讨厌它。对于大多数 C/C++ 程序员来说，类型安全和严格性是一个重要的问题。如果您进入像 Ruby 这样的无类型、“在运行时动态可塑性”的环境，它会感觉非常草率。

从语言和思维过程的角度来看，C# 会更容易。我不再推荐进行经典的 ASP.NET 开发。所谓的 WebForms 正在迅速变得过时和过时。微软 MVC 框架的第 4 版在几天前刚刚发布，非常棒。这是要走的路。

那么为什么不直接使用 Ruby on Rails 呢？为什么使用微软 MVC？你应该有很好的理由。

1.  严格类型安全的编译器
2.  完全编译的代码可以提高速度。您的所有代码在运行之前都已完全转换为 X86 机器代码，
3.  高性能。C# 非常非常快。Ruby 非常非常慢。C# 接近 C++ 级别的性能。Ruby 比 Perl、Python 和 Lua 慢。性能差距非常大。
4.  您将获得一个丰富的 IDE。我个人不能忍受 RoR 的事情是，你大多停留在纯文本编辑器和命令行控制台中。ASP.NET MVC 意味着访问 Visual Studio 的强大功能
5.  RoR 无法扩展。微软 MVC 可以。
6.  我喜欢 Microsoft Test 的简单性
7.  我还没有走多远，但 Unity 似乎是一个不错的 AOP IOC。与 Spring 或 Windsor 相比，我使用它已经走得更远了。

# memory-management - 大树：何时在 RIA 中发布数据

> ID：285545
> 
> 赞同：2
> 
> 时间：2008-11-12T22:06:09.483
> 
> 标签：memory-management, treeview, tree, ria, jtree

这个问题是关于 Java JTree 或 Window .Net 树 (Winforms) 或 Adob​​e Flex 树。

在客户端-服务器应用程序中（对于 Flex，它实际上是 Web），我有一个带有分层数据的树（在 Windows 资源管理器类型的界面中）。现在，当用户从服务器请求更多数据时，我会懒惰地加载树。这很好，最多可以运行大约 750K 个节点（在 .Net Winforms 和 Adob​​e Flex 上进行了经验测试），但之后它变得迟缓。但是数据库增长很快（主要是因为用户可以粘贴大量节点），拥有 2000 万个节点的数据库并非不可能。

当分支折叠时我应该从树中释放数据以便垃圾收集器可以释放内存吗？这很好，但是如果用户没有效率并且不折叠分支怎么办？我应该做一个内存管理模块来关闭一段时间未触及的分支吗？

这一切似乎都需要做很多工作，以免内存不足。

**编辑：**我应该发布节点崩溃的数据吗？如果有，什么时候？弱对象缓存的想法很好，但我是否应该继续填充 UI 直到它崩溃（也许这不是一个坏主意）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-12T22:34:20.080

在我见过的大多数框架中，树结构本身是相当有效的，但是如果你在每个树叶上都有一个不平凡的对象，它会很快添加。

最简单的方法是不在树叶上存储任何东西，而是在渲染/绘制/更新/任何方法上，从弱引用缓存中选择你的对象。如果不存在，请从服务器加载。诀窍是不保留对对象的任何其他引用，只保留缓存中的弱引用。这样，它仍然可用，但在必要时收集。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-12T22:43:38.127

如果用户不折叠分支，那么我猜他们将滚动 750K 到 20M 个节点，对吧？从用户 POV 看来，对我来说效率很低。所以，问题很可能是自我执行的。

# c++ - 如何向我的 C++ 应用程序添加一个简单的 API 以供 LabView 访问？

> ID：285551
> 
> 赞同：6
> 
> 时间：2008-11-12T22:08:00.710
> 
> 标签：c++, windows, api, labview

我有一个用 C++ (Visual Studio 6.0) 编写的数据采集程序。一些客户希望通过他们自己的定制软件或 LabView 来控制软件。我想提出一个带有 dll 的简单 API，我可以将其分发给他们，并且想要一些关于如何开始的提示。这将是非常基本的，可能是 4 或 5 个命令。我的 DAQ 程序仍将在同一台机器上的自己的窗口中运行，我只想将其设置为由另一个程序控制。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-12T22:14:03.727

您使用 DLL 走在正确的轨道上。听起来，真正的诀窍在于决定您要使用哪种类型的进程间通信 (IPC)。选项有：套接字、管道、共享内存、同步对象（事件等）、文件、注册表等。

一旦你决定了，然后在你的可执行文件中实现一个监听器来等待来自任何使用你的 DLL 的软件的传入 IPC 消息。

就 API 而言，您可以像您想要的那样保持简单。让 DLL 公开您的 4 或 5 个函数（确保您只使用本机数据类型，如 char* 和 long，以避免模块边界问题），然后这些将使用您的 IPC 机制与您正在执行的应用程序进行通信。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-12T22:18:34.667

像这样开始简单的事情会随着时间的推移而成长，所以你最好先做更多的工作，并使用一种会随着你成长的技术。

为您的程序实现 COM 接口将使客户在如何与它的接口方面有很大的自由，并且您不必担心 IPC 的机制等，因为 COM 旨在对您隐藏所有这些。

将来，COM 已经为诸如脚本语言很好支持的事件之类的事情定义了良好的习惯用法，等等，如果您需要它们。

**更新**：有很多实现 COM 的方法。您可以在一本好的 COM 书籍的指导下从第一个原则开始构建它，或者使用 ATL 之类的框架来节省一些样板。有很多很好的示例，例如参见[MSDN](http://msdn.microsoft.com/en-us/library/wc9s55de(VS.71).aspx)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-13T10:23:10.883

COM 的最大优点是您不需要 DLL！您说，您的应用程序将始终运行。这意味着它可以充当 COM 对象创建者（“本地服务器”）。

如果有人想要一个“ `stdcall`” DLL，你可以给他们一个 DLL，它在内部只是将所有调用转发到 COM 接口。写它会很简单。你说，你只有 5 个功能。这表明您有一个带有这 5 种方法的 COM 接口。当包装 DLL 加载时，它会要求您的 EXE 创建它的 COM 对象。DLL 依次公开 5 个 stdcall 方法，每个方法调用 COM 对象上的一个方法。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-13T10:58:22.763

你*可以*使用一个dll。我会考虑的。但我也会考虑创建一个简单的基于 http 的 API，最好是 RESTful。

优点：易于移植。可以用任何语言轻松编写客户端应用程序。可以跨网络工作。测试变得更容易（使用脚本语言或浏览器）。

缺点：性能会变慢。在 C++ 中设置它需要更多的管道。我不确定 LabView 是否可以进行 http 调用。

就像是：

> [http://xxx/data](http://xxx/data) [GET，也许是 POST 用于测试]
> 
> [http://xxx/data/start](http://xxx/data/start) [POST]
> 
> [http://xxx/data/stop](http://xxx/data/stop) [POST]
> 
> [http://xxx/data/parameters](http://xxx/data/parameters) [POST]

鉴于您的要求，它*可能*有点矫枉过正，但也许不是。我工作过的许多应用程序都必须移植，如果我们可以使用更快的开发语言来测试和扩展它，那么扩展速度会更快。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-01-06T16:34:49.870

LabVIEW 支持进行 DLL 调用，但这是 LabVIEW 开发中的弱点之一。如果操作不当，可能会导致应用程序更容易崩溃。作为一名 LabVIEW 开发人员，我喜欢 MattyT 关于创建 HTTP 服务的建议。每个平台上可以创建 TCP/IP 端口的每种语言都可以访问它。我认为您可以使用自己的自定义 TCP/IP 协议而不是完整的 HTTP，但无论哪种方式都解决了兼容性问题。

如果您确实使用 DLL，这里有一些提示。不要在函数调用参数列表中使用结构或指向结构的指针。不要在 DLL 中分配内存以传回 LabVIEW。LabVIEW 内置了内存管理，无法与其他人很好地配合使用。这可能适用于具有内存管理的其他语言，例如 Java。如果 LabVIEW 分配内存并将指针传递给 DLL，它会更好地工作。尽可能避免使用指针、数组和字符串。LabVIEW 可以将这些传递给 DLL，但它是一个高级主题，并且当 LabVIEW 开发人员也了解 C 语言时效果最好，但情况并非总是如此。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-12T23:57:23.313

这里有一个[相关的问题](https://stackoverflow.com/questions/227329/labview-driver-getting-started)。我不想最终得到特定于 LabView 的东西，而且如果[LabView 使用 stdcall ，它们似乎可以访问 dll](http://zone.ni.com/reference/en-XX/help/371361B-01/lvexcodeconcepts/shared_libraries_dlls/)。像这样的 dll 也可以从 VB 或其他 Windows 软件中调用，这也是我所追求的。

我不确定它是否能够访问 COM 接口，但希望能更详细地了解我的应用程序的外观。

# java - Java/MySQL 中没有时间或时区组件的日期

> ID：285553
> 
> 赞同：7
> 
> 时间：2008-11-12T22:08:15.233
> 
> 标签：java, sql, date, timezone, java-time

我需要能够存储没有时间成分的日期（年/月/日）。这是日期的抽象概念，例如生日 - 我需要表示一年中的日期，而不是特定的时刻。

我正在使用 Java 从一些输入文本中解析日期，并且需要存储在 MySQL 数据库中。无论数据库、应用程序或任何客户端位于哪个时区，它们都应该看到相同的年/月/日。

我的应用程序将在与数据库服务器具有不同系统时区的机器上运行，我也无法控制。有没有人有一个优雅的解决方案来确保我正确存储日期？

我能想到这些解决方案，但都不是很好：

*   查询我的 MySQL 连接的时区并解析该时区的输入日期
*   将日期完全处理为字符串 yyyy-MM-dd

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2021-05-12T14:01:14.820

**java.time**

在 JSR-310 被合并到 Java SE 8 之前，这确实是`java.util`日期时间 API 的一个问题。该`java.util.Date`对象不像[现代日期时间类型](https://docs.oracle.com/javase/tutorial/datetime/iso/overview.html)那样是真正的日期时间对象；相反，它表示自称为“纪元” `January 1, 1970, 00:00:00 GMT`（或 UTC）的标准基准时间以来的毫秒数。当您打印 的对象时`java.util.Date`，其`toString`方法会返回 JVM 时区中的日期时间，根据此毫秒值计算得出。

您所描述的问题已通过[现代日期时间 API](https://www.oracle.com/technical-resources/articles/java/jf14-date-time.html) ^*得到解决，我们拥有`LocalDate`的只是一个日期。在下面的句子中，[Oracle 教程](https://docs.oracle.com/javase/tutorial/datetime/iso/overview.html)很好地描述了它的目的：

> 例如，您可以使用 LocalDate 对象来表示出生日期，因为大多数人在同一天庆祝他们的生日，无论他们是在他们的出生城市还是在国际日期变更线的另一边的全球。

[几页后](https://docs.oracle.com/javase/tutorial/datetime/iso/date.html)，它再次描述如下：

> LocalDate 表示 ISO 日历中的年月日，可用于表示没有时间的日期。您可以使用 LocalDate 来跟踪重要事件，例如出生日期或结婚日期。

## 我应该使用哪种数据类型`LocalDate`？

它映射为`DATE`ANSI SQL 类型。ANSI SQL 类型与类型的映射在[Oracle 的文章](https://www.oracle.com/technical-resources/articles/java/jf14-date-time.html)`java.time`中描述如下：

| ANSI SQL | Java SE 8 |
| --- | --- |
| 日期 | 本地日期 |
| 时间 | 当地时间 |
| 时间戳 | 本地日期时间 |
| 时区时间 | 偏移时间 |
| 带有时区的时间戳 | 偏移日期时间 |

## 如何在 JDBC 中使用它？

`LocalDate`下面给出了一个插入a 的示例代码`columnfoo`（它是`DATE`类型）：

```
LocalDate localDate = LocalDate.now();
PreparedStatement st = conn.prepareStatement("INSERT INTO mytable (columnfoo) VALUES (?)");
st.setObject(1, localDate);
st.executeUpdate();
st.close(); 
```

`LocalDate`下面给出了从检索 a 的示例代码`columnfoo`：

```
Statement st = conn.createStatement();
ResultSet rs = st.executeQuery("SELECT * FROM mytable WHERE <some condition>");
while (rs.next()) {
    // Assuming the column index of columnfoo is 1
    LocalDate localDate = rs.getObject(1, LocalDate.class));
    System.out.println(localDate);
}
rs.close();
st.close(); 
```

从**[Trail: Date Time](https://docs.oracle.com/javase/tutorial/datetime/index.html)**了解有关[现代日期时间 API](https://www.oracle.com/technical-resources/articles/java/jf14-date-time.html) ^*的更多信息。

* * *

^(* 出于任何原因，如果您必须坚持使用 Java 6 或 Java 7，则可以使用[***ThreeTen-Backport，***](http://www.threeten.org/threetenbp/)它将大部分*java.time*功能向后移植到 Java 6 和 7。如果您正在为 Android 项目和 Android API 工作level 仍然不符合 Java-8，请检查[Java 8+ APIs available through desugaring](https://developer.android.com/studio/write/java8-support-table)和[How to use ThreeTenABP in Android Project](https://stackoverflow.com/questions/38922754/how-to-use-threetenabp-in-android-project)。)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-12T22:39:23.003

您可以将所有时间/时区的内容归零：

```
public static Date truncateDate(Date date)
    {
        GregorianCalendar cal = getGregorianCalendar();
        cal.set(Calendar.ZONE_OFFSET, 0); // UTC
        cal.set(Calendar.DST_OFFSET, 0); // We don't want DST to get in the way.

        cal.setTime(date);
        cal.set(Calendar.MILLISECOND, 0);
        cal.set(Calendar.SECOND, 0);
        cal.set(Calendar.MINUTE, 0);
        cal.set(Calendar.HOUR, 0);
        cal.set(Calendar.AM_PM, Calendar.AM);

        return cal.getTime();
    } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-14T21:42:40.023

我得出的结论是，在我当前的应用程序（一个直接使用 jdbc 的简单实用程序）中，最好的方法是直接作为字符串插入。对于更大的 Hibernate 应用程序，我可能会费心编写自己的用户类型。不敢相信有人还没有在一些公开可用的代码中解决这个问题......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-12T22:50:43.370

难道你不能只`DATE`在你的表中使用 MySQL 类型，然后在你的插入语句中使用格式化的字符串吗？我认为这样的事情可以避免任何时区调整。

```
INSERT INTO time_table(dt) VALUES('2008-12-31') 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-15T01:07:22.200

由于您指定您的服务器和数据库位于不同的时区，因此在我看来您的解释有问题。如果您将日期归零，或者存储为 MM-dd-YYYY，这相当于同一件事，您是存储服务器日期还是数据库日期？如果服务器上是晚上 11:00，数据库上是第二天凌晨 1 点，那么哪个日期是“正确的”？当您查看一年后的日期时，您会记得日期所依赖的机器时区吗？

这些考虑可能有点矫枉过正。但是，为什么不将日期存储在 GMT 中（如果您愿意，可以将秒数归零）？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-08T15:11:06.450

该类`java.sql.Date`正是出于这个原因而存在，不幸的是它使用起来非常不方便，因为它只是扩展`java.util.Date`并且您必须手动将时间部分设置为零。

# c# - 如何实现完全自定义的可拖动控件？

> ID：285562
> 
> 赞同：0
> 
> 时间：2008-11-12T22:10:46.370
> 
> 标签：c#, .net, custom-controls

我在一个需要一些花哨的自定义控件的应用程序上工作。从 .net Control 类继承导致了各种问题，并且随着时间的推移使事情变得更加困难。我不会在这里详细介绍，但我正在创建自己的轻量级控制架构以避免其中一些问题。一切都很好，但我需要在我的架构中添加拖放功能。

到目前为止，我提出的所有方法似乎都很混乱且容易出错。我在很多方面都在模仿 .net Control 类，并且使用 .net 反射器获得了很大的好处，但是我在弄清楚如何使我的拖动事件触发（DragDrop、DragEnter、DragLeave）时遇到了问题。

我只是想不出一种干净的方法来触发这些事件。有没有人有任何想法？

* * *

到目前为止，我想出的最好的方法是实现 IDropTarget 接口并*希望*我的事件能够触发。他们不。

* * *

@tamberg：我通读了那篇文章，这并不是我真正想要的（不过谢谢）。我的问题是我不知道如何实现事件系统。例如，我如何知道数据对象何时被拖到我的自定义控件类上？如何引发这些事件（DragOver、DragDrop 等）？

示例中的所有控件都继承自 System.Windows.Forms.Control，这是我要避免的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-13T00:37:09.613

只是一个猜测：

Windows 窗体，自定义控件第 1 部分：掌握 DragDrop ( [http://www.codeproject.com/KB/miscctrl/LANDragDrop.aspx](http://www.codeproject.com/KB/miscctrl/LANDragDrop.aspx) )

问候，坦伯格

# language-agnostic - iTunes COM 接口 - 获取添加到库中的歌曲？

> ID：285568
> 
> 赞同：6
> 
> 时间：2008-11-12T22:12:57.083
> 
> 标签：language-agnostic, itunes

这与特定语言无关，而与 iTunes COM 接口有关。

我设法用 将一个文件添加到库中`.AddFile()`，但是现在该文件在那里，我想阅读一些有关它的详细信息，例如艺术家、歌曲和专辑。由于这首歌不会自动播放，我真的不能用`CurrentTrack()`这个。

有没有办法添加最后一个文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-14T17:13:11.237

AddFiles 的“返回值”（实际上是最后一个参数，因为这是我们正在谈论的 COM）是一个 IITOperationStatus 接口指针。这是找出发生了什么的关键。

您应该在此接口上调用 InProgress() 方法以确保操作已完成。（如果 iTunes 必须复制文件，它可能会异步进行）。

完成后，您可以使用此界面上的 Tracks 属性来获取表示您刚刚添加的轨道的 IITrackCollection。

（我会超链接所有这些接口和方法名称，但苹果似乎没有以可链接的形式在线发布 iTunes COM SDK 文档。有关详细信息，请参阅随 SDK 获得的 iTunesCOM.chm 文件）。

# powershell - PowerShell 在紧密循环中屈服于操作系统

> ID：285572
> 
> 赞同：3
> 
> 时间：2008-11-12T22:13:31.603
> 
> 标签：powershell

我之前遇到过调用 System.Threading.Thread.Sleep(0); 的建议。在 C# 中的紧身衣循环中以防止 CPU 占用并使用它来获得良好的效果。

我有一个 PowerShell 脚本，它有一个紧密的循环，我想知道我是否应该调用 [Thread]::Sleep(0) 或 Start-Sleep 0 或者 PS 引擎是否偶尔会为我屈服。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-13T21:47:13.523

当您只是确保它不会接管处理器时，我发现通过 .Sleep() 或其他方式显式产生线程存在一些问题。第一个是它只会让你的代码看起来很糟糕，因为它洒满了 Thread.Sleep(0)。您可以评论每个实例，但看起来不太好。

下一个问题是您只能生成您控制的代码。如果长时间运行的脚本的一部分调用了您无法控制的长时间运行的函数，这根本没有帮助。

相反，我会在长时间运行的操作期间将 ThreadPriority 更改为低于正常或最低。这将解决这两个问题，并且可能会更有效，因为操作系统现在可以做出更明智的决定，决定何时将您退出。

```
[Thread]::CurrentThread.ThreadPriority = System.Threading.ThreadPriority.Lowest 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-12T23:38:20.123

我建议使用 Thread.SpinWait(20)。它在英特尔 HT 盒子上运行良好。高级方法是检查 CPU 的数量并调用 Sleep(0) 用于单个 CPU 或 SpitWait(20) 否则

# windows-installer - Windows Installer 属性中可以存储的最大字符数是多少

> ID：285573
> 
> 赞同：7
> 
> 时间：2008-11-12T22:13:57.110
> 
> 标签：windows-installer

我已经google了很多，我找不到答案。那么在一个 Windows Installer 属性值中可以存储多少个字符。如果你给出答案，你能提供答案的来源吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-22T02:33:26.797

我问 Windows Installer 团队，在将数据从即时的 CustomAction 编组到延迟的 CustomAction 时，Property 可以有多大，我被告知我只是受到机器上内存量的限制。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-13T02:17:51.127

属性名称的长度可以是 72 个字符，并且对属性值的大小没有限制。

我通过使用 InstallShield 编辑我的 MSI 并检查属性表的字段大小来得到这个。（导出表格给出以下标题>

```
Property    Value   ISComments
s72      L0          S255 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-13T01:40:51.937

MSI 只是一个数据库，属性存储在`Property`由两列组成的表中；`Property`和`Value`

该`Value`列属于`Text`根据 MSI.CHM 未验证的类型。按照这种逻辑，属性中的字符数没有限制。我希望您可以用字节或千字节（或更大）而不是字符来考虑它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-12T22:20:37.550

MSDN 文档对此不是很清楚，但确实提供了一些提示。例如，本文提到可以将属性值写入注册表，这意味着注册表值限制适用：http: [//msdn.microsoft.com/en-us/library/aa372432%28VS.85%29.aspx](http://msdn.microsoft.com/en-us/library/aa372432%28VS.85%29.aspx)

这是一篇详细介绍注册表值限制的文章：http: [//support.microsoft.com/kb/256986](http://support.microsoft.com/kb/256986)

因此，我最多会使用注册表值限制作为指导（并且仍然尽量保持低于该值）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-08-25T22:27:23.113

如果您正在编写 InstallScript，请注意，虽然 MSI 属性可以设置为任意长度，但有一个技巧可以获取“长”值。参考：[字符串太长，MsiGetProperty 和 Installshield Installscript](https://stackoverflow.com/questions/16690206/string-too-long-with-msigetproperty-with-installshield-installscript/32214859#32214859)

# c# - C# String.Replace 双引号和文字

> ID：285579
> 
> 赞同：16
> 
> 时间：2008-11-12T22:17:21.207
> 
> 标签：c#, xml

我对 c# 相当陌生，所以这就是我在这里问这个的原因。

我正在使用一个返回一长串 XML 值的 Web 服务。因为这是一个字符串，所以所有属性都转义了双引号

```
string xmlSample = "<root><item att1=\"value\" att2=\"value2\" /></root>" 
```

这是我的问题。我想做一个简单的string.replace。如果我在 PHP 中工作，我只需运行 strip_slashes()。

但是，我在 C# 中，我一生都无法弄清楚。我无法写出我的表达式来替换双引号（“），因为它终止了字符串。如果我转义它，那么它的结果不正确。我做错了什么？

```
 string search = "\\\"";
    string replace = "\"";
    Regex rgx = new Regex(search);
    string strip = rgx.Replace(xmlSample, replace);

    //Actual Result  <root><item att1=value att2=value2 /></root>
    //Desired Result <root><item att1="value" att2="value2" /></root> 
```

> MizardX：要在原始字符串中包含引号，您需要将其加倍。

这是重要的信息，现在尝试这种方法......也没有运气这里有双引号。你们都建议的概念是可靠的，但这里的问题是处理双引号，看起来我需要做一些额外的研究来解决这个问题。如果有人想出一些东西，请发布答案。

```
string newC = xmlSample.Replace("\\\"", "\"");
//Result <root><item att=\"value\" att2=\"value2\" /></root> 

string newC = xmlSample.Replace("\"", "'");
//Result newC   "<root><item att='value' att2='value2' /></root>" 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-11-13T02:02:43.013

C# 中的以下语句

```
string xmlSample = "<root><item att1=\"value\" att2=\"value2\" /></root>" 
```

实际上会存储值

```
<root><item att1="value" att2="value2" /></root> 
```

然而

```
string xmlSample = @"<root><item att1=\""value\"" att2=\""value2\"" /></root>"; 
```

有

```
<root><item att1=\"value\" att2=\"value2\" /></root> 
```

对于第二种情况，您需要将斜杠 () 替换为空字符串，如下所示

```
string test = xmlSample.Replace(@"\", string.Empty); 
```

结果将是

```
<root><item att1="value" att2="value2" /></root> 
```

附言

1.  斜杠 ( `\`) 是 C# 中的默认转义字符
2.  要忽略斜杠，请在字符串开头使用 @
3.  如果使用@，则转义字符为双引号 (")

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-12T22:28:05.430

根本没有理由使用正则表达式……这比您需要的要重得多。

```
string xmlSample = "blah blah blah";

xmlSample = xmlSample.Replace("\\\", "\""); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-12T22:22:41.040

字符串和正则表达式都`\`用于转义。正则表达式将看到`\`后跟的字符`"`，并认为这是文字转义。试试这个：

```
Regex rgx = new Regex("\\\\\"");
string strip = rgx.Replace(xmlSample, "\""); 
```

您还可以在 C# 中使用原始字符串（也称为验证字符串）。它们以 为前缀`@`，并且所有反斜杠都被视为普通字符。要在原始字符串中包含引号，您需要将其加倍。

> `Regex rgx = new Regex(@"\""")`
> `string strip = rgx.Replace(xmlSample, @"""");`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-13T00:50:32.350

如果您正在获取 XML 字符串，为什么不使用 XML 代替字符串？

您将可以访问所有元素和属性，如果使用 System.Xml 命名空间，这将变得更加容易和极快

在您的示例中，您将获得以下字符串：

```
string xmlSample = "<root><item att1=\"value\" att2=\"value2\" /></root>"; 
```

您需要做的就是将该字符串转换为 XML 文档并使用它，例如：

```
System.Xml.XmlDocument xml = new System.Xml.XmlDocument();
xml.LoadXml(xmlSample);

System.Xml.XmlElement _root = xml.DocumentElement;

foreach (System.Xml.XmlNode _node in _root)
{
    Literal1.Text = "<hr/>" + _node.Name + "<br/>";
    for (int iAtt = 0; iAtt < _node.Attributes.Count; iAtt++)
        Literal1.Text += _node.Attributes[iAtt].Name + " = " + _node.Attributes[iAtt].Value + "<br/>";
} 
```

在 ASP.NET 中，这将输出到 Literal1，如下所示：

```
item
att1 = value
att2 = value2 
```

一旦您在 XmlElement 中拥有该元素，就很容易搜索并获取该元素中内容的值和名称。

试一试，我在检索 WebServices 响应以及将某些内容存储在 XML 文件中作为小型应用程序的设置时经常使用它。

# infrastructure - 服务器场关闭

> ID：285581
> 
> 赞同：2
> 
> 时间：2008-11-12T22:17:24.157
> 
> 标签：infrastructure

大型服务器场如何优雅地关闭所有或部分服务器场？我正在考虑计划内和计划外的情况，例如：

*   “我们需要关闭 Rack 42”
*   “我们需要对整个街区的供电进行工作”
*   “停电！UPS 的果汁快用完了！啊！”
*   “空调下降，空气温度为 125F 并且正在攀升”

我感兴趣的问题是人们如何处理测序，以及如何启动整个事情。我还想到，这很容易与启动和关闭服务以及软件升级系统混为一谈。

（在这一点上，我更多是出于好奇而询问。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-12T23:06:41.763

计算机重新联机时比运行时使用的电量要多得多，因为它们必须让所有的盘片和风扇都旋转，通常有大量的 CPU 活动来启动所有应用程序，等等。大多数商店都会有一套让初创公司错开的顺序，所以他们不会把赛道弄得筋疲力尽，而必须重新开始。如果您有一堆希望与数据库通信的应用程序，或者一堆需要与应用程序服务器通信的 Web 服务器，这一点也很重要。您通常从下往上开始，将启动错开 30 秒到一分钟，具体取决于您的电路中有多少个盒子。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-13T01:45:03.177

啊，现在我更清楚地理解了你的问题。

dataprobe 的[iBootBar](http://www.dataprobe.com/)等产品允许您监控和管理远程设备的电源。智能系统可以监控每个设备的电流消耗，以验证其是否在标称限制内运行。如果没有，它可以使设备离线并在线更换备用设备，观察初始浪涌并等待电源稳定后再打开下一个设备。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-12T22:38:37.810

一种方法是在临时热交换上镜像实时机器，并假设通过网络访问，通过重新配置路由器将流量转移到镜像来进行切换。对于计划外的中断，此过程可以自动化。

对于计划内的维护，有些人只是简单地通知他们的用户系统将在某个窗口期间不可用。

冗余电源和燃气发电机可处理大多数与电力相关的问题，同样具有自动故障转移功能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-03-06T15:18:23.863

请记住，“大型服务器场”旨在永远不会关闭，除非他们有义务这样做。这意味着这是一个可能的但很遥远的事件，当它发生时，你真的很着急。所有其他用例，例如关闭机架或在电源线上工作，都将尽可能提前计划。

当事情真的出错时，你实际上会很着急。

例如发电机用完燃料（通常他们会保留至少一整天的储备，并有合同及时补充，所以我们在这里谈论的是大灾难）或类似事件，你会知道的将有数小时的时间来关闭事物。或者 HVAC 系统完全失效，那么您只有几分钟的时间在温度升高太多之前关闭所有设备。

我不是这里的专家，在路障的另一边（数据中心的客户），但我认为他们将有系统来命令关闭他们控制的所有系统，他们只会切断电源客户的系统，他们无法控制并正确关闭。

当所有系统重新上线并准备好满负荷运行时（UPS、发电机、HVAC 等），农场最终将一次重新启动一个区域，一次一个机架。当他们完全控制系统（即，不是客户系统，而是私人农场）时，他们通常会逐渐将交流电引入所有电路，并且服务器将自动启动（如果配置为这样做，许多服务器甚至可以设置例如“在最多 X 分钟的随机时间后开机”），或者它们将被命令通过 IPMI 或类似系统等熄灯管理来开机。

# asp.net - OCIEnvCreate 失败错误 - 访问 .aspx 页面时

> ID：285584
> 
> 赞同：6
> 
> 时间：2008-11-12T22:18:38.990
> 
> 标签：asp.net, oracle10g

我目前在尝试通过 localhost 访问 .aspx 页面时遇到 ASP.NET 错误。这是错误：

**OCIEnvCreate 失败，返回代码 -1，但错误消息文本不可用。**

**说明**：执行当前 Web 请求期间发生未处理的异常。请查看堆栈跟踪以获取有关错误及其源自代码的位置的更多信息。

**异常详细信息**：System.Exception：OCIEnvCreate 失败，返回代码为 -1，但错误消息文本不可用。

**堆栈跟踪：**

```
[Exception: OCIEnvCreate failed with return code -1 but error message text was not available.]
   System.Data.OracleClient.OciHandle..ctor(OciHandle parentHandle, HTYPE handleType, MODE ocimode, HANDLEFLAG handleflags) +363
   System.Data.OracleClient.OciEnvironmentHandle..ctor(MODE environmentMode, Boolean unicode) +23
   System.Data.OracleClient.OracleInternalConnection.OpenOnLocalTransaction(String userName, String password, String serverName, Boolean integratedSecurity, Boolean unicode, Boolean omitOracleConnectionName) +122
   System.Data.OracleClient.OracleInternalConnection..ctor(OracleConnectionString connectionOptions) +135
   System.Data.OracleClient.OracleConnectionFactory.CreateConnection(DbConnectionOptions options, Object poolGroupProviderInfo, DbConnectionPool pool, DbConnection owningObject) +36
   System.Data.ProviderBase.DbConnectionFactory.CreatePooledConnection(DbConnection owningConnection, DbConnectionPool pool, DbConnectionOptions options) +28
   System.Data.ProviderBase.DbConnectionPool.CreateObject(DbConnection owningObject) +424
   System.Data.ProviderBase.DbConnectionPool.UserCreateRequest(DbConnection owningObject) +68
   System.Data.ProviderBase.DbConnectionPool.GetConnection(DbConnection owningObject) +519
   System.Data.ProviderBase.DbConnectionFactory.GetConnection(DbConnection owningConnection) +82
   System.Data.ProviderBase.DbConnectionClosed.OpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory) +104
   System.Data.OracleClient.OracleConnection.Open() +37
   Wilson.ORMapper.Internals.Connection..ctor(String connectString, CustomProvider customProvider) +287

[ORMapperException: ObjectSpace: Connection String is Invalid - OCIEnvCreate failed with return code -1 but error message text was not available.]
   Wilson.ORMapper.Internals.Connection..ctor(String connectString, CustomProvider customProvider) +357
   Wilson.ORMapper.Internals.Context.Init(XmlDocument xmlMappings, String connectString, CustomProvider customProvider, Int32 sessionMinutes, Int32 cleanupMinutes) +92
   Wilson.ORMapper.Internals.Context..ctor(Stream mappingStream, String connectString, CustomProvider customProvider, Int32 sessionMinutes, Int32 cleanupMinutes) +171
   Wilson.ORMapper.ObjectSpace..ctor(Stream mappingStream, String connectString, Provider providerType, Int32 sessionMinutes, Int32 cleanupMinutes) +66
   zedi.DataManager.GetDefaultInstance() in C:\projects\FINE Application Interface\Production\On-site Backlog\Source\Code\DataAccess\ORClasses\Data\DataManager.cs:155
   zedi.DataManager.get_ObjectSpaceGlobal() in C:\projects\FINE Application Interface\Production\On-site Backlog\Source\Code\DataAccess\ORClasses\Data\DataManager.cs:105
   zedi.DataManager.get_ObjectSpace() in C:\projects\FINE Application Interface\Production\On-site Backlog\Source\Code\DataAccess\ORClasses\Data\DataManager.cs:129
   zedi.DataObjects.CompanyBase.RetrieveQuery(ObjectQuery query) in C:\projects\FINE Application Interface\Production\On-site Backlog\Source\Code\DataAccess\ORClasses\DataObjects\Base\CompanyBase.cs:279
   zedi.DataObjects.CompanyBase.RetrieveAll(String sortClause) in C:\projects\FINE Application Interface\Production\On-site Backlog\Source\Code\DataAccess\ORClasses\DataObjects\Base\CompanyBase.cs:78
   maint_inetpub.siteTemplates.updateDeviceTemplate.Page_Load(Object sender, EventArgs e) in c:\projects\FINE Application Interface\Production\On-site Backlog\Source\Code\Websites\maint-inetpub\siteTemplates\updateDeviceTemplate.aspx.cs:47
   System.Web.Util.CalliHelper.EventArgFunctionCaller(IntPtr fp, Object o, Object t, EventArgs e) +15
   System.Web.Util.CalliEventHandlerDelegateProxy.Callback(Object sender, EventArgs e) +33
   System.Web.UI.Control.OnLoad(EventArgs e) +99
   System.Web.UI.Control.LoadRecursive() +47
   System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +1436 
```

我注意到它说我有一个无效的连接字符串，但我已经对其进行了测试并且它可以工作。我目前安装了 Oracle 10g Express，在此之前我安装了 Oracle 8i 客户端。在我安装 10g Express 之前它可以工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T15:14:31.137

我在 oracle 10g 上遇到了同样的问题，从我读到的这个错误似乎意味着 .Net oracle 驱动程序找不到 oracle 客户端。

有各种建议可以解决这个问题，包括检查 PATH 和 ORACLE_HOME 环境变量；如果默认位置 (C:\oracle) 不存在，则在默认位置 (C:\oracle) 重新安装 oracle 客户端；或使用 oracle 的 Oracle Data Provider for .NET (ODP.NET) 而不是 Microsoft oracle 驱动程序 (System.Data.OracleClient)。

然而，以上都没有解决我的问题，所以如果有人有更多的建议，他们将不胜感激！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-10-06T15:11:15.967

我们最近也遇到了这个问题；在我们的例子中，恢复 ORACLE_HOME 环境变量就可以解决问题（OMS10G 的安装不完整，导致系统处于不一致的状态，环境变量注册为 null）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-07-02T09:34:33.213

我在 Windows 7 机器上体验过。添加 ORACLE_HOME 环境变量并以“windows xp sp3”兼容模式（文件/属性/兼容性）运行使用 oracle 客户端的可执行文件为我解决了这个问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-08-09T06:40:13.673

虽然这个问题有点古老，但我会投入我的五分钱。从我在互联网上阅读的内容来看，即使在调用者（登录到 Windows 的用户）没有读取/执行 Oracle 二进制文件的权限时一直配置的环境中也会发生这种情况。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-03-29T17:08:52.267

只需从中删除 System.Data.OracleClient.dll `\Program Files (x86)\Reference Assemblies\Microsoft\Framework\.NETFramework\v4.5`

**确保先备份，以防出现任何其他错误**

这对我有用。

`System.Data.OracleClient.dll`或从以下文件夹 替换`Windows\Microsoft.NET\assembly\GAC_32\System.Data.OracleClient\v4.0_4.0.0.0__b77a5c561934e089`

# process - FreeBSD 中的无限循环

> ID：285586
> 
> 赞同：1
> 
> 时间：2008-11-12T22:18:58.317
> 
> 标签：process, monitoring, segmentation-fault, freebsd, watchdog

我有一个不断出现段错误的脚本——因为段错误我无法解决的问题是在 python libxml 绑定中——没有写这些。好的，所以在 Linux 中，我曾经运行过一个 inf.loop，这样当脚本终止时 - 它会重新启动，如下所示：

```
#!/bin/bash
while [ 1 ]
do
nice -n 19 python server.py
sleep 1
done 
```

好吧，我似乎在 FreeBSD 中找不到 /bin/bash ，所以这不起作用。

有任何想法吗？考虑到 cron 不是一个选项 - 允许的停机时间是几秒钟。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-12T22:24:13.813

/bin/sh 几乎肯定存在，但如果你真的需要 bash：

```
cd /usr/ports/*/bash
make install 
```

我相信应该在 /usr/local/bin/bash 中安装 bash

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-12T22:24:07.747

系统上会有一些 shell 程序，该脚本看起来几乎可以在任何 shell 中运行。

键入`type bash`以查看 bash 在哪里。如果没有，请尝试 sh。它应该在那里，并且应该可以工作。取`type bash`or的结果`type sh`，用 in 代替 /bin/bash。或者，查看 /etc/passwd，查找您的帐户，并注意 shell 是什么。我相信这是最后一个字段，它会说 /bin/sh 或 /usr/bin/bash 之类的东西。使用它代替 /bin/bash。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-12T22:22:53.957

不确定 FreeBSD 默认使用什么 shell，但它可能带有一些。您使用的任何 shell 的手册页都应该告诉您该 shell 的循环语法。它可能非常相似。

# winapi - WS_VSCROLL，CreateWindow 样式有效，SetWindowLong 无效

> ID：285587
> 
> 赞同：6
> 
> 时间：2008-11-12T22:19:04.543
> 
> 标签：winapi, controls, scrollbar, styles

当我做

```
wnd = CreateWindow("EDIT", 0,
    WS_CHILD | WS_VISIBLE | WS_VSCROLL | WS_HSCROLL | ES_MULTILINE | 
    ES_AUTOVSCROLL | ES_AUTOHSCROLL | ES_WANTRETURN,
    x, y, w, h,
    parentWnd,
    NULL, NULL, NULL); 
```

一切都很好，但是如果我删除 WS_VSCROLL 和 WS_HSCROLL 然后执行以下操作，我不会得到它们，因此窗口不正确。为什么？如果 WS_VSCROLL 和 WS_HSCROLL 都丢失，我不仅会得到一个不正确的窗口，而且它是不可用的

```
style = WS_CHILD | WS_VISIBLE | WS_VSCROLL | WS_HSCROLL | ES_MULTILINE |
    ES_AUTOVSCROLL | ES_AUTOHSCROLL | ES_WANTRETURN;
SetWindowLong(wnd, GWL_STYLE, style); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-12T23:13:33.963

某些控件样式在窗口创建后无法更改。ES_AUTOHSCROLL 样式（本质上控制自动换行）就是其中之一；[MSDN 的Edit Control Styles](http://msdn.microsoft.com/en-us/library/bb775464.aspx)部分（有些间接地）说明了这一点。您可以使用 SetWindowLong() 设置这些位，但控件将忽略它们或行为异常。

干净利落地执行此操作的唯一方法是使用所需样式重新创建编辑控件。这实际上是当您切换“自动换行”设置时记事本所做的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-03-18T23:28:39.230

您可以使用 ShowScrollBar() 函数来完成。如果您想启用/禁用窗口的滚动条，您可能还会对 EnableScrollBar() 函数感兴趣。最好的祝福。

# iis - 黑莓 HTTP 标头

> ID：285589
> 
> 赞同：0
> 
> 时间：2008-11-12T22:19:18.690
> 
> 标签：iis, browser, blackberry

我正在尝试访问需要 Windows 身份验证的内部网站。我尝试在我的 Blackberry 上访问该网站，但收到以下错误：

> 您无权查看此页面。
> 
> 您无权使用您提供的凭据查看此目录或页面，因为您的 Web 浏览器正在发送 Web 服务器未配置为接受的 WWW-authenticate 标头字段

那么如何更改浏览器以发送不同的标头字段，或者如何使 Web 服务器接受 Blackberry 标头？

这几乎是我的头，所以不要接触技术。告诉我是否需要提供更多信息。

我在 IIS 服务器上运行它

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-19T16:56:25.637

找出 BlackBerry 发送的 WWW-Authenticate 标头中的内容（检查 Web 服务器请求日志或嗅探 HTTP 流量）。可能是 BlackBerry 正在尝试使用“基本”HTTP 身份验证方案进行身份验证，而 Web 服务器拒绝此方案，例如，因为它非常不安全。

# objective-c - 在 Objective-C 中使用 GCC __unused 属性

> ID：285591
> 
> 赞同：15
> 
> 时间：2008-11-12T22:19:58.597
> 
> 标签：objective-c, gcc

是否可以在 Objective-C 对象方法参数上使用 __unused 属性宏？我尝试将它放置在参数声明周围的不同位置，但它要么导致编译错误，要么似乎被忽略（即，编译器在使用 -Wall -Wextra 编译时仍会生成未使用的参数警告）。

有没有人能够使用这个？Objective-C 不支持它吗？作为参考，我目前正在使用 Apple 构建的 GCC 4.0.1。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-11-12T23:11:06.917

好的，我找到了答案……这似乎是 Apple 的 gcc 4.0 实现的一个错误。使用 gcc 4.2 它可以按预期工作，正确的位置如下：

```
-(void)someMethod:(id) __unused someParam; 
```

如果有人感兴趣，它会记录在 Objective-C 发行说明中：http: [//developer.apple.com/releasenotes/Cocoa/RN-ObjectiveC/index.html#//apple_ref/doc/uid/TP40004309-DontLinkElementID_6](http://developer.apple.com/releasenotes/Cocoa/RN-ObjectiveC/index.html#//apple_ref/doc/uid/TP40004309-DontLinkElementID_6)

作为一个注释，你的答案将编译，路易斯，但正如我在我的问题中所说，它实际上不会做任何事情或抑制编译器发出的未使用的警告。

[编辑：我为此rdar://6366051](http://rdar://6366051)向苹果提交了一份错误报告。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-12T23:11:51.690

我认为您可以使用#pragma used 将参数标记为未使用。未经测试，但你可以尝试类似

```
- (NSString *)test:(NSString *)test {
#pragma unused (test);
  return nil;
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-12T23:22:14.883

一个常见的习惯用法是使用以下内容：

```
#define UNUSED(x) (void)x
void SomeFunction(int param1, int param2)
{
  UNUSED(param2);
  // do stuff with param1
}
```

该`UNUSED(param2)`语句不生成任何目标代码，消除有关未使用变量的警告，并清楚地将代码记录为未使用该变量。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-12T22:55:12.723

我可以很好地编译以下内容：

```
- (NSString *) test:(__unused NSString *)test {
    return nil;
} 
```

编辑：实际上，这可能不是严格意义上的拱门：

```
Phoenix-VI:CouchPusher louis$ cc -c Pusher.m -Wall -Werror
Phoenix-VI:CouchPusher louis$ cc -c Pusher.m -Wall -Werror  -Wunused-parameter
cc1obj: warnings being treated as errors
Pusher.m:40: warning: unused parameter ‘test’
Phoenix-VI:CouchPusher louis$ 
```

所以 -Wall 不包括不包括 -Wunused-parameter....

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-12-07T23:46:55.447

在与#pragma 斗争了一段时间后，我发现它是

```
+ (NSString*) runQuery:(id)query name:(NSString*)name options:(NSDictionary*)options
{
#pragma unused(name)
 ...

} 
```

# language-agnostic - 最大化数据，最小化代码——限制和问题是什么？

> ID：285593
> 
> 赞同：1
> 
> 时间：2008-11-12T22:20:15.367
> 
> 标签：language-agnostic, programming-languages

我想设计具有客户端（可能是 C# gui）和服务器组件（Java、C++、Perl）的非常高可用性（永远不要关闭服务器、推出功能而不重启等）应用程序。

我从（[minimize-code-maximize-data.html](http://database-programmer.blogspot.com/2008/05/minimize-code-maximize-data.html)和[Yegge](http://steve-yegge.blogspot.com/2007/01/pinocchio-problem.html)）那里得到了一些建议，我想让大多数逻辑从数据库中动态读取，以便所有配置（包括所有 GUI 配置、文本翻译等、业务规则以及data) 将驻留在服务器上的数据库中，而不是驻留在需要重新启动才能读入可执行内存的代码中。

我希望能够在不重新启动客户端或服务器的情况下自定义应用程序的任何方面，并让应用程序以尽可能短的延迟反映更改（动态类加载等）。

设计这样一个“永不杀死”系统的性能和其他限制是什么？有没有人设法创建这样的应用程序？主要的教训是什么？什么时候这不符合成本效益并且需要更传统的构建、发布、质量保证、几个小时的停机时间方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-12T22:24:19.103

我在一个 MUD 游戏服务器上工作，它对脚本进行动态编译，这样游戏中的几乎所有东西都可以在运行时更改和重新编译，而无需断开任何用户的连接。

也许我从那个项目中学到的最大的教训是，**当你编写的代码如此灵活以至于它可以做任何事情时，它实际上什么都不做。**

最终，系统的用户不再输入数据——他们正在编写一种神秘的代码语言，这是我的系统所独有的。

警惕灵活性——为代码增加灵活性就像在手臂上增加肘部。有几个关节可以到达你想去的地方很好，但如果你的肘部太多，它就会变得虚弱且难以指挥。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-12T22:28:02.607

在脚本解释器（如 Rhino）周围使用高度静态且小型的代码库，这与考虑并没有太大的不同：

[http://www.mozilla.org/rhino/ScriptingJava.html](http://www.mozilla.org/rhino/ScriptingJava.html)

这样，所有逻辑和数据都可以放入可重新加载的脚本中，程序的唯一核心部分是脚本运行器和类似 shell 的部分。

这绝对不利于性能，我认为这是理所当然的。

如果我没记错的话，耶格曾经在他的博客上发布过类似的东西，所以如果你再次和他交谈，可能会问他这个问题。

# sql-server - 如何删除 MS SQL 2005 中除最新的 20,000 条记录之外的所有记录？

> ID：285614
> 
> 赞同：6
> 
> 时间：2008-11-12T22:24:38.930
> 
> 标签：sql-server, sql-server-2005

每天晚上我都需要整理一张表，使其仅包含最新的 20,000 条记录。我可以使用子查询：

```
delete from table WHERE id NOT IN (select TOP 20000 ID from table ORDER BY date_added DESC) 
```

但这似乎效率低下，特别是如果我们后来决定保留 50,000 条记录。我正在使用 SQL 2005，并认为我可以使用 ROW_NUMBER() OVER 以某种方式做到这一点？订购它们并删除所有 ROW_NUMBER 大于 20,000 的？但我无法让它工作。子查询是我最好的选择还是有更好的方法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-12T22:27:09.487

如果它*看起来*效率低下，我会在我开始吠叫错误的树之前确保它是低效的。

测量时间、cpu 使用率、磁盘 I/O 等，看看它的性能如何。我想你会发现它的表现比你想象的要好。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-12T23:45:35.710

当然，你的里程会有所不同——这取决于你从这张表的底部刮掉了多少真实记录，但这里有一个替代方案。

旁注：由于您有一个“Date_Added”字段，是否值得考虑简单地保留上次运行的日期时间并在 where 子句中使用它来过滤要删除的记录？现在，在日志中允许 X 天而不是 20,000 条记录......只是一个想法......

* * *

-- 获取我们想要保存的记录到一个临时文件中。
-- 您可以根据需要对守门员进行分类。

```
select top 20000 * into #myTempTable from MyTable ORDER BY DateAdded DESC 
```

-- 使用 truncate 不会破坏我们的日志文件并且使用更少的 sys 资源...

```
truncate table MyTable 
```

-- 将我们的“保留”记录重新放入折叠中...
-- 这假设您没有使用身份列 -- 如果您使用了，您应该
-- 指定字段名称而不是使用 '*' 并执行类似于
-- SET IDENTITY_INSERT MyTable ON
-- insert into MyTable select field1,field2,field3 from #myTempTable
--（我认为这是正确的）

```
insert into MyTable select * from #myTempTable 
```

——做一个好公民。

```
drop table #myTempTable 
```

* * *

希望能帮助到你 -

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-13T00:21:44.513

```
DECLARE @limit INT
SELECT @limit = min(id) FROM
   (SELECT TOP 20000 id FROM your_table ORDER BY id DESC)x
DELETE FROM your_table where id < @limit 
```

关键是要避免嵌套查询，我可能会也可能不会优化（对不起，不是 sql guru。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-16T18:43:27.460

将 20000 插入临时表，然后从主表中删除所有记录，然后再次将 20000 记录从临时表插入主表..，

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-12T22:37:36.860

当然，这是包装成一个过程并使用两个 sql 语句的主要情况——第一个选择最新的 ID 并减去 20,000，然后第二个删除 ID 低于此值的所有行。

然而，从表面上看，这听起来像你会用这种方法结束很多碎片，这可能是创建一个新表的一个很好的论据，将最新的 20,000 条记录插入其中，删除旧的一个并重命名新的。甚至可能值得将表放在不同的数据库中并从主数据库创建视图以方便访问。我自己通常倾向于使用用于数据加载和审计的表来执行此操作。

在不知道您的实际数据量和行为的情况下很难判断，但很可能在全球范围内，您的效率低下将更多地来自于此，而不是您使用的删除方法。如果您每天只收集一千个或更少的记录，那么删除可能与运行数据优化维护计划相结合，但更多，我会考虑更激进的方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-13T00:55:54.007

您的问题意味着您正在修剪以从桌子上获得更好的白天表现。您是否对白天的查询进行表扫描？更好的索引不是答案吗？或者您是否处于陷入“糟糕架构”的境地？

或者确实有一些非常奇怪的情况，您确实需要清除旧记录？20,000 是一个硬性的数字吗？或者日期时间可以工作吗？然后在日期时间列上建立索引将使修剪更容易一些。

# asp.net - 如何从 ASP.NET 进行 SVN 更新？

> ID：285617
> 
> 赞同：2
> 
> 时间：2008-11-12T22:25:29.023
> 
> 标签：asp.net, svn

我想从 asp.net 页面调用 svn，以便人们可以点击该页面来更新存储库。（顺便说一句：我正在使用不允许提交后挂钩的 Beanstalk.com svn 托管，这就是我这样做的原因）。

看看我在下面得到了什么。该进程启动（它显示在任务管理器的进程中）并在几秒钟后退出，没有输出消息（至少没有输出到页面）。存储库不会更新。但它确实对存储库做了一些事情，因为下次我尝试从命令行手动更新它时，它说存储库已锁定。我必须运行 svn cleanup 才能更新它。

想法？

```
Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs)
    startInfo = New System.Diagnostics.ProcessStartInfo("svn")
    startInfo.RedirectStandardOutput = True     
    startInfo.UseShellExecute = False
    startInfo.Arguments = "up " & Request.QueryString("path")

    pStart.StartInfo = startInfo
    pStart.Start()
    pStart.WaitForExit()

    Response.Write(pStart.StandardOutput.ReadToEnd())
End Sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-13T14:22:16.107

您还可以使用 Ankh SVN 附带的 Subversion 库。我在一个项目中使用它来管理 Subversion 存储库中的文件，它运行良好。

如果您坚持使用命令行客户端，请确保检查 StandardError 输出是否有任何错误消息。还要确保您运行该进程的用户具有适当的权限。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-13T04:26:40.760

通过使用 .net SVN 包装器或像这样的库，您可能能够更有效地做到这[一点](http://www.softec.st/en/OpenSource/ClrProjects/SubversionSharp/SubversionSharp.html)。我敢肯定还有其他人会支持beantalk的局限性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-13T14:04:00.980

使用[SharpSvn](http://sharpsvn.net/)：

```
using(SvnClient client = new SvnClient())
{
   client.Update(Request["path"]);
} 
```

但出于安全原因，我建议不要直接使用用户传递的变量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-03-22T17:00:03.313

我对此进行了详细调查。一种很有效的方法是使用 Windows 消息子系统（Windows 事件日志 - 您创建自己的日志并向其写入消息）。Asp.Net 创建一条消息。然后你需要编写一个 Windows 服务，它每 3 秒左右读取一次消息。遇到“请更新 svn 消息”的那一刻，您从新创建的 Windows 服务运行 cmd.exe /c svn.exe blah blah ...它运行良好，但需要大量工作...然后有 SharpSVN 库，但它需要一些设置，你可能会遇到问题。最后，大多数人似乎都在尝试使用 ProcessStartInfo 类，但似乎很少有人能做到这一点......是的，它并不容易，而且还有很长的路要走，但这里是代码......这里是运行 svn 的代码。为您执行exe并将所有屏幕输出记录到输出缓冲区....

```
 private static int lineCount = 0;
    private static StringBuilder outputBuffer = new StringBuilder();
    private void SvnOutputHandler(object sendingProcess,
                                  DataReceivedEventArgs e)
    {
        Process p = sendingProcess as Process;

        // Save the output lines here
        // Prepend line numbers to each line of the output.
        if (!String.IsNullOrEmpty(e.Data))
        {
            lineCount++;
            outputBuffer.Append("\n[" + lineCount + "]: " + e.Data);
        }
    }

    private void RunSVNCommand()
    {
        ProcessStartInfo psi = new ProcessStartInfo("cmd.exe",
                                                    string.Format("/c svn.exe --config-dir=%APPDATA%\\Subversion --username=yrname --password=yrpassword --trust-server-cert --non-interactive   update d:\\inetpub\\wwwroot\\yourpath"));

        psi.UseShellExecute = false;
        psi.CreateNoWindow = true;

        // Redirect the standard output of the sort command.  
        // This stream is read asynchronously using an event handler.
        psi.RedirectStandardOutput = true;
        psi.RedirectStandardError = true;

        Process p = new Process();

        // Set our event handler to asynchronously read the sort output.
        p.OutputDataReceived += SvnOutputHandler;
        p.ErrorDataReceived += SvnOutputHandler;
        p.StartInfo = psi;

        p.Start();

        p.BeginOutputReadLine();
        p.BeginErrorReadLine();

        p.WaitForExit();
    } 
```

关于 svn.exe 参数的快速解释以及我们为什么这样做...您需要将 config-dir 指定给已签出 svn 目录的任何帐户。IIS 在不同的帐户下运行。如果找不到 svn 的配置文件，您将收到一条停止消息。--Non-interactive 和 --trust-server-certificate 基本上是跳过提示接受安全挑战。最后，您将需要指定用户名和密码，因为由于某种原因不会发送（无论如何使用我的 svn.exe 版本）。现在，最重要的是，通过 https 连接到 svn 服务器给了我错误，因为 IIS 报告的主机名与桌面主机名不同（ssl 证书不匹配），因此它不喜欢配置文件中的主机名 - 去图. 所以，我想，如果我将代理从 http 反向到 https（所以现在我在一台服务器上有两个网站，一个是 reversesvn.domain.com:80 代理到 svn.domain.com:8443）这将跳过所有证书问题，这是拼图的最后一块。以下是如何做到这一点 - 简单：[https://blog.ligos.net/2016-11-14/Reverse-Proxy-With-IIS-And-Lets-Encrypt.html](https://blog.ligos.net/2016-11-14/Reverse-Proxy-With-IIS-And-Lets-Encrypt.html)。

# firefox - 在 Firefox（2 或 3）中，“由未知机构认证的网站”XUL 对话框的 chrome:// 路径是什么？

> ID：285618
> 
> 赞同：2
> 
> 时间：2008-11-12T22:25:47.260
> 
> 标签：firefox, google-chrome

另一个角度：如何浏览给定 chrome 路径的所有 XUL，例如

[http://kb.mozillazine.org/Dev_:_Firefox_Chrome_URLs](http://kb.mozillazine.org/Dev_:_Firefox_Chrome_URLs)有一个列表，但似乎已经过时了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-31T05:43:08.923

至少在 Firefox 3 中，`chrome://global/content/netError.xhtml?e=nssBadCert&u=`这是您正在寻找的。 `netError.xhtml`处理各种连接问题，并根据实际错误进行自我修改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-24T22:24:09.917

Mozilla [`chrome://`URL](https://developer.mozilla.org/en/XUL_Tutorial/The_Chrome_URL)指的是位于某些定义明确的位置的 .jar 文件中的实际文件。

主浏览器 (chrome://browser/content/...) 本身：

```
{where you installed Firefox}/chrome/browser.jar 
```

火狐插件：

```
{your profile directory}/extensions/{extension id}/chrome/content/... 
```

，`{your profile directory}`至少在 Windows XP 上，是

```
c:\Documents and Settings\{your username}\Application Data\Mozilla\Firefox\Profiles\{your profile name, usually ends in .default} 
```

# java - 如何检测字符串中是否存在 URL

> ID：285619
> 
> 赞同：31
> 
> 时间：2008-11-12T22:25:54.513
> 
> 标签：java, url

我有一个输入字符串说`Please go to http://stackoverflow.com`。检测到字符串的 url 部分，`<a href=""></a>`许多浏览器/IDE/应用​​程序会自动添加一个锚点。于是就变成了`Please go to <a href='http://stackoverflow.com'>http://stackoverflow.com</a>`。

我需要使用 Java 做同样的事情。

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2008-11-13T00:02:19.687

## 使用 java.net.URL ！

嘿，为什么不为这个“java.net.URL”使用java中的核心类并让它验证URL。

虽然以下代码违反了“仅在异常情况下使用异常”的黄金原则，但尝试为 Java 平台上非常成熟的东西重新发明轮子对我来说是没有意义的。

这是代码：

```
import java.net.URL;
import java.net.MalformedURLException;

// Replaces URLs with html hrefs codes
public class URLInString {
    public static void main(String[] args) {
        String s = args[0];
        // separate input by spaces ( URLs don't have spaces )
        String [] parts = s.split("\\s+");

        // Attempt to convert each item into an URL.   
        for( String item : parts ) try {
            URL url = new URL(item);
            // If possible then replace with anchor...
            System.out.print("<a href=\"" + url + "\">"+ url + "</a> " );    
        } catch (MalformedURLException e) {
            // If there was an URL that was not it!...
            System.out.print( item + " " );
        }

        System.out.println();
    }
} 
```

使用以下输入：

```
"Please go to http://stackoverflow.com and then mailto:oscarreyes@wordpress.com to download a file from    ftp://user:pass@someserver/someFile.txt" 
```

产生以下输出：

```
Please go to <a href="http://stackoverflow.com">http://stackoverflow.com</a> and then <a href="mailto:oscarreyes@wordpress.com">mailto:oscarreyes@wordpress.com</a> to download a file from    <a href="ftp://user:pass@someserver/someFile.txt">ftp://user:pass@someserver/someFile.txt</a> 
```

当然，可以以不同的方式处理不同的协议。例如，您可以使用 URL 类的 getter 获取所有信息

```
 url.getProtocol(); 
```

或其他属性：spec、port、file、query、ref 等

[http://java.sun.com/javase/6/docs/api/java/net/URL.html](http://java.sun.com/javase/6/docs/api/java/net/URL.html)

处理所有协议（至少所有这些 java 平台都知道），并且作为额外的好处，如果有任何 java 当前无法识别的 URL 并最终被合并到 URL 类中（通过库更新），你会得到透明的！

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-11-12T23:54:31.980

虽然它不是 Java 特定的，但 Jeff Atwood 最近发布了一篇文章，介绍了在尝试定位和匹配任意文本中的 URL 时可能遇到的陷阱：

[URL 的问题](http://blog.codinghorror.com/the-problem-with-urls/)

它提供了一个很好的正则表达式，可以与您需要用来正确（或多或少）处理括号的代码片段一起使用。

正则表达式：

```
\(?\bhttp://[-A-Za-z0-9+&@#/%?=~_()|!:,.;]*[-A-Za-z0-9+&@#/%=~_()|] 
```

括号清理：

```
if (s.StartsWith("(") && s.EndsWith(")"))
{
    return s.Substring(1, s.Length - 2);
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-12T22:44:36.207

你可以做这样的事情（调整正则表达式以满足你的需要）：

```
String originalString = "Please go to http://www.stackoverflow.com";
String newString = originalString.replaceAll("http://.+?(com|net|org)/{0,1}", "<a href=\"$0\">$0</a>"); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-03-07T13:58:59.493

The following code makes these modifications to the "Atwood Approach":

1.  Detects https in addition to http (adding other schemes is trivial)
2.  The CASE_INSENSTIVE flag is used since HtTpS:// is valid.
3.  Matching sets of parentheses are peeled off (they can be nested to any level). Further, any remaining unmatched left parentheses are stripped, but trailing right parentheses are left intact (to respect wikipedia-style URLs)
4.  The URL is HTML Encoded in the link text.
5.  The target attribute is passed in via method parameter. Other attributes can be added as desired.
6.  It does not use \b to identify a word break before matching a URL. URLs can begin with a left parenthesis or http[s]:// with no other requirement.

Notes:

*   Apache Commons Lang's StringUtils are used in the code below
*   The call to HtmlUtil.encode() below is a util which ultimately calls some Tomahawk code to HTML-encode the link text, but any similar utility will do.
*   See the method comment for a usage in JSF or other environments where output is HTML Encoded by default.

This was written in response to our client's requirements and we feel it represents a reasonable compromise between the allowable characters from the RFC and common usage. It is offered here in the hopes that it will be useful to others.

Further expansion could be made which would allow for any Unicode characters to be entered (i.e. not escaped with %XX (two digit hex) and hyperlinked, but that would require accepting all Unicode letters plus limited punctuation and then splitting on the "acceptable" delimiters (eg. .,%,|,#, etc.), URL-encoding each part and then gluing back together. For example, [http://en.wikipedia.org/wiki](http://en.wikipedia.org/wiki)/Björn_Andrésen (which the Stack Overflow generator does not detect) would be "http://en.wikipedia.org/wiki/Bj%C3%B6rn_Andr%C3%A9sen" in the href, but would contain Björn_Andrésen in the linked text on the page.

```
// NOTES:   1) \w includes 0-9, a-z, A-Z, _
//          2) The leading '-' is the '-' character. It must go first in character class expression
private static final String VALID_CHARS = "-\\w+&@#/%=~()|";
private static final String VALID_NON_TERMINAL = "?!:,.;";

// Notes on the expression:
//  1) Any number of leading '(' (left parenthesis) accepted.  Will be dealt with.  
//  2) s? ==> the s is optional so either [http, https] accepted as scheme
//  3) All valid chars accepted and then one or more
//  4) Case insensitive so that the scheme can be hTtPs (for example) if desired
private static final Pattern URI_FINDER_PATTERN = Pattern.compile("\\(*https?://["+ VALID_CHARS + VALID_NON_TERMINAL + "]*[" +VALID_CHARS + "]", Pattern.CASE_INSENSITIVE );

/**
 * <p>
 * Finds all "URL"s in the given _rawText, wraps them in 
 * HTML link tags and returns the result (with the rest of the text
 * html encoded).
 * </p>
 * <p>
 * We employ the procedure described at:
 * http://www.codinghorror.com/blog/2008/10/the-problem-with-urls.html
 * which is a <b>must-read</b>.
 * </p>
 * Basically, we allow any number of left parenthesis (which will get stripped away)
 * followed by http:// or https://.  Then any number of permitted URL characters
 * (based on http://www.ietf.org/rfc/rfc1738.txt) followed by a single character
 * of that set (basically, those minus typical punctuation).  We remove all sets of 
 * matching left & right parentheses which surround the URL.
 *</p>
 * <p>
 * This method *must* be called from a tag/component which will NOT
 * end up escaping the output.  For example:
 * <PRE>
 * <h:outputText ... escape="false" value="#{core:hyperlinkText(textThatMayHaveURLs, '_blank')}"/>
 * </pre>
 * </p>
 * <p>
 * Reason: we are adding <code>&lt;a href="..."&gt;</code> tags to the output *and*
 * encoding the rest of the string.  So, encoding the outupt will result in
 * double-encoding data which was already encoded - and encoding the <code>a href</code>
 * (which will render it useless).
 * </p>
 * <p>
 * 
 * @param   _rawText  - if <code>null</code>, returns <code>""</code> (empty string).
 * @param   _target   - if not <code>null</code> or <code>""</code>, adds a target attributed to the generated link, using _target as the attribute value.
 */
public static final String hyperlinkText( final String _rawText, final String _target ) {

    String returnValue = null;

    if ( !StringUtils.isBlank( _rawText ) ) {

        final Matcher matcher = URI_FINDER_PATTERN.matcher( _rawText );

        if ( matcher.find() ) {

            final int originalLength    =   _rawText.length();

            final String targetText = ( StringUtils.isBlank( _target ) ) ? "" :  " target=\"" + _target.trim() + "\"";
            final int targetLength      =   targetText.length();

            // Counted 15 characters aside from the target + 2 of the URL (max if the whole string is URL)
            // Rough guess, but should keep us from expanding the Builder too many times.
            final StringBuilder returnBuffer = new StringBuilder( originalLength * 2 + targetLength + 15 );

            int currentStart;
            int currentEnd;
            int lastEnd     = 0;

            String currentURL;

            do {
                currentStart = matcher.start();
                currentEnd = matcher.end();
                currentURL = matcher.group();

                // Adjust for URLs wrapped in ()'s ... move start/end markers
                //      and substring the _rawText for new URL value.
                while ( currentURL.startsWith( "(" ) && currentURL.endsWith( ")" ) ) {
                    currentStart = currentStart + 1;
                    currentEnd = currentEnd - 1;

                    currentURL = _rawText.substring( currentStart, currentEnd );
                }

                while ( currentURL.startsWith( "(" ) ) {
                    currentStart = currentStart + 1;

                    currentURL = _rawText.substring( currentStart, currentEnd );
                }

                // Text since last match
                returnBuffer.append( HtmlUtil.encode( _rawText.substring( lastEnd, currentStart ) ) );

                // Wrap matched URL
                returnBuffer.append( "<a href=\"" + currentURL + "\"" + targetText + ">" + currentURL + "</a>" );

                lastEnd = currentEnd;

            } while ( matcher.find() );

            if ( lastEnd < originalLength ) {
                returnBuffer.append( HtmlUtil.encode( _rawText.substring( lastEnd ) ) );
            }

            returnValue = returnBuffer.toString();
        }
    } 

    if ( returnValue == null ) {
        returnValue = HtmlUtil.encode( _rawText );
    }

    return returnValue;

} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-06-14T13:10:08.370

我做了一个小型图书馆，正是这样做的：

[https://github.com/robinst/autolink-java](https://github.com/robinst/autolink-java)

一些棘手的示例及其检测到的链接：

*   `http://example.com.`→ [http://example.com](http://example.com)。
*   `http://example.com,`→ [http://example.com](http://example.com) ,
*   `(http://example.com)`→ ( [http://example.com](http://example.com) )
*   `(... (see http://example.com))`→ (... (参见[http://example.com](http://example.com) ))
*   `https://en.wikipedia.org/wiki/Link_(The_Legend_of_Zelda)`→ [https://en.wikipedia.org/wiki/Link_(The_Legend_of_Zelda)](https://en.wikipedia.org/wiki/Link_(The_Legend_of_Zelda))
*   `http://üñîçøðé.com/`→ [http://üñîçøðé​​.com/](http://example.com)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-12T22:52:08.797

原始：

```
String msg = "Please go to http://stackoverflow.com";
String withURL = msg.replaceAll("(?:https?|ftps?)://[\\w/%.-]+", "<a href='$0'>$0</a>");
System.out.println(withURL); 
```

这需要改进，以匹配正确的 URL，尤其是 GET 参数 (?foo=bar&x=25)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-12T23:29:56.427

你在问两个不同的问题。

1.  识别字符串中的 URL 的最佳方法是什么？看到[这个线程](https://stackoverflow.com/questions/161738/what-is-the-best-regular-expression-to-check-if-a-string-is-a-valid-url)
2.  如何用 Java 编写上述解决方案？其他说明`String.replaceAll`使用情况的回答已经解决了这个问题

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-08-19T13:18:50.483

对 PhiLho 的回答的一个很好的改进是： `msg.replaceAll("(?:https?|ftps?)://[\w/%.-][/\??\w=?\w?/%.-]?[/\?&\w=?\w?/%.-]*", "$0");`

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-09-08T12:32:58.603

我编写了自己的 URI/URL 提取器，并认为有人可能会觉得它很有用，因为恕我直言，它比其他答案更好，因为：

*   它基于 Stream，可用于大型文档
*   其可扩展为通过策略链处理各种[“Atwood Paren”问题。](https://blog.codinghorror.com/the-problem-with-urls/)

由于代码对于一篇文章来说有点长（尽管只有一个 Java 文件），所以我把它放在了[**gist github 上**](https://gist.github.com/3674391)。

这是调用它的主要方法之一的签名，以显示其上述要点：

```
public static Iterator<ExtractedURI> extractURIs(
    final Reader reader,
    final Iterable<ToURIStrategy> strategies,
    String ... schemes); 
```

有一个默认的策略链可以处理大多数 Atwood 问题。

```
public static List<ToURIStrategy> DEFAULT_STRATEGY_CHAIN = ImmutableList.of(
    new RemoveSurroundsWithToURIStrategy("'"),
    new RemoveSurroundsWithToURIStrategy("\""),
    new RemoveSurroundsWithToURIStrategy("(", ")"),
    new RemoveEndsWithToURIStrategy("."),
    DEFAULT_STRATEGY,
    REMOVE_LAST_STRATEGY); 
```

享受！

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2022-02-20T21:28:17.943

```
 public static List<String> extractURL(String text) {
    List<String> list = new ArrayList<>();
    Pattern pattern = Pattern
            .compile(
                    "(http://|https://){1}[\\w\\.\\-/:\\#\\?\\=\\&\\;\\%\\~\\+]+",
                    Pattern.CASE_INSENSITIVE);
    Matcher matcher = pattern.matcher(text);
    while (matcher.find()) {
        list.add(matcher.group());
    }
    return list;
} 
```

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2017-03-27T04:00:06.593

建议在 2017 年做一个更方便的方法：

```
<TextView
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:autoLink="web"
    android:linksClickable="true"/> 
```

或`android:autoLink="all"`用于各种链接。

* * *

## 回答 #12

> 赞同：-4
> 
> 时间：2012-07-09T13:12:34.160

要检测一个 URL，你只需要这个：

```
if (yourtextview.getText().toString().contains("www") || yourtextview.getText().toString().contains("http://"){ your code here if contains URL;} 
```

# asp.net - 负载测试 asp.net 站点（回发/视图状态）

> ID：285621
> 
> 赞同：1
> 
> 时间：2008-11-12T22:26:56.040
> 
> 标签：asp.net, viewstate, load-testing

对严重依赖于具有视图状态的帖子的应用程序进行负载测试的最佳方法是什么（相同的帖子不能发送两次，所以简单的记录/重播不会做）？

我可以生成要在帖子中使用的视图状态吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-12T22:52:08.627

最好的（但昂贵的）解决方案是使用[Visual Studio Team Test Edition](http://msdn.microsoft.com/en-us/vsts2008/products/bb933754.aspx)。它允许您[使用 .Net 代码创建和运行负载测试](http://msdn.microsoft.com/en-us/library/ms364082.aspx)。它非常健壮，允许您在服务器场上运行测试并收集所有性能指标等。

# visual-studio-2008 - SharePoint Designer 有什么好的替代品吗？

> ID：285630
> 
> 赞同：1
> 
> 时间：2008-11-12T22:30:36.423
> 
> 标签：visual-studio-2008, sharepoint, sharepoint-2007, add-in, sharepoint-designer

如果您曾经使用过 SharePoint Designer，您就会知道它很糟糕。特别糟糕。

有什么好的替代品吗？如果我想构建自己的 Visual Studio 加载项连接器以连接到它，是否有任何必须考虑的因素？

你知道我应该注意什么吗？

我只是讨厌缓慢和 SPD (SharePoint Designer) 只是不断地重新整理我所有的东西的方式。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-12T22:44:51.557

您可以获得用于 Visual Studio 的 Sharepoint Explorer 加载项，它允许您浏览站点：

[http://blog.thekid.me.uk/archive/2007/10/29/vs-net-developer-add-in-for-sharepoint-available-for-download.aspx](http://blog.thekid.me.uk/archive/2007/10/29/vs-net-developer-add-in-for-sharepoint-available-for-download.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-14T17:58:55.480

这取决于你想做什么。正如[Cruiser](https://stackoverflow.com/questions/285630/is-there-any-good-replacement-for-sharepoint-designer#285669)所提到的，有用于探索 SharePoint 场或网站集的 SharePoint Explorer 等选项。然而，有很多东西是无法替代的，例如 SP Designer 工作流程、编辑页面布局等......

# asp.net - 不要将 Response.Write 与 AJAX 混合，但 UI.HtmlTextWriter 呢？

> ID：285637
> 
> 赞同：0
> 
> 时间：2008-11-12T22:33:54.403
> 
> 标签：asp.net, ajax

[从错误消息创建者的博客中](http://weblogs.asp.net/leftslipper/archive/2007/02/26/sys-webforms-pagerequestmanagerparsererrorexception-what-it-is-and-how-to-avoid-it.aspx)，如果您将 Response.Write（以及其他内容）与 UpdatePanel 混合使用，您可能会收到 PageRequestManagerParserErrorException 错误。我想知道，***混合 UI.HtmlTextWriter 和 UpdatePanels 可以吗？***我的猜测是它不会好，但我不确定。到目前为止，我所做的测试有限，似乎还可以。有人确定吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-12T23:41:55.170

HtmlTextWriter 是每个控件通过 Render 方法写入其输出的方式，所以，是的，这很好。否则不会呈现任何控件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T10:11:34.530

我建议将动态 response.write 代码隔离到您的代码隐藏中并将其注入占位符。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-20T08:48:44.777

在 Ra-Ajax 中，我们有一个“特殊流”，您可以在其中写入内容。虽然这个“东西”需要是 JavaScript 才能在客户端上执行。我不确定 ASP.NET AJAX 是否有类似的东西......

# asp.net - 您可以“分配”ASP.NET GridView 的 PageCount 属性吗？

> ID：285649
> 
> 赞同：1
> 
> 时间：2008-11-12T22:37:46.923
> 
> 标签：asp.net, gridview, pagination

我有一个 Web 应用程序正在使用具有自己的内置分页的数据存储。PagedResult 类告诉我总页数。我想做什么（绑定我的 ASP.NET GridView 之后）这样做：

```
MyGridView.PageCount = thePageCount; 
```

然后让 GridView 神奇地构建分页链接，就像它自己做事情一样。

问题是“PageCount”是一个只读属性......那么，我怎样才能简单地做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-12T23:37:00.953

要使用内置分页，GridView 与数据源进行交互。GridView 有一个可设置的 PageSize 属性。

如果使用 ObjectDataSource，则同时配置 SelectMethod 和 SelectCountMethod。您可以修改 PagedResult 类以返回记录计数而不是页计数，或者将 PagedResult 调用包装在将页计数转换为记录计数 (PageCount * PageSize) 的方法中。

如果您的 PagedResult 类仅用于支持 Web 应用程序，则应考虑将其修改为更像典型的分页数据源。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-12T23:09:36.717

您可以创建自己的类来扩展 GridView 并覆盖 PageCount getter 方法以从 PagedResult 类返回值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-12T23:38:45.707

使用 ObjectDataSource 控件，将其绑定到您的 GridView，并为 SelectCoutnMethod 属性设置处理程序。您可能必须为您的类编写小的包装对象，以检索与 ObjectDataSource 控件接口的数据。

一些可以帮助您的链接：

[ObjectDataSource Web 服务器控件概述](http://msdn.microsoft.com/en-us/library/9a4kyhcx.aspx)
[ObjectDataSource 类](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.objectdatasource.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-12T20:12:06.010

```
 Dim myCount as Integer = 1 'this sets the page count to 1 
       While (oreader.Read())
            myCount += 1 'increments once for everytime a item is counted
            'this sets an array for the items to go into
            idFname = oreader.GetOrdinal("workCenter")
            'this retrieves the values at those indices
            fName = oreader.GetValue(idFname)
            BulletedList1.Items.Add(fName)
        End While

    Catch ex As Exception
        BulletedList1.Items.Add("No Workcenters Found")
    Finally
        oreader.Close()
        oconn.Close()
    End Try
End If
Me.insertItemForm.PagerSettings.PageButtonCount = myCount 'sets the page count to number of items in gridview or formview etc. 
```

# freebsd - 在 FreeBSD 下以不同用户身份运行

> ID：285658
> 
> 赞同：20
> 
> 时间：2008-11-12T22:40:38.307
> 
> 标签：freebsd

FreeBSD 中有没有办法（作为 root）以非特权用户身份运行命令，就像没人一样？有点像 sudo 的反面。哦，考虑到 'nobody' 有 /usr/sbin/nologin 作为 shell - 所以**su**不是一个选项。

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2010-07-13T04:50:35.073

如果您使用该选项，您可以使用 shell 注册`su`一个帐户。`nologin``-m`

例子：

```
su -m cthulhu -c '/usr/bin/scorpion-stare' 
```

将以用户身份运行 SCORPION STARE 命令行实用程序`cthulhu`。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2008-11-12T22:52:29.640

sudo 将允许您以另一个用户身份运行命令。

```
sudo -u nobody <command> 
```

将作为没人运行，即使他们的登录 shell 不可用。

# search - 自动包装 I-search？

> ID：285660
> 
> 赞同：26
> 
> 时间：2008-11-12T22:41:00.893
> 
> 标签：search, emacs

在 Vim 中`:set wrapscan`，当我进行增量搜索时，无论第一个匹配是在光标上方还是下方，光标都会跳转到第一个匹配项。

在 Emacs 中，如果我通过 开始搜索，如果第一个匹配项位于光标上方`C-s`，则搜索失败并显示*Failing I-search 。*如果我`C-s`再次点击它然后包装搜索，说*Wrapped I-search*。我如何像在 Vim 中一样默认包装和跳转光标，而不必`C-s`第二次？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-11-13T14:27:43.740

最简单的方法是使用以下默认建议：

```
(defadvice isearch-repeat (after isearch-no-fail activate)
  (unless isearch-success
    (ad-disable-advice 'isearch-repeat 'after 'isearch-no-fail)
    (ad-activate 'isearch-repeat)
    (isearch-repeat (if isearch-forward 'forward))
    (ad-enable-advice 'isearch-repeat 'after 'isearch-no-fail)
    (ad-activate 'isearch-repeat))) 
```

当 Isearch 失败时，它会立即重新尝试换行。请注意，当没有匹配项时，暂时禁用此默认提示以防止无限循环非常重要。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-04-19T01:39:40.490

尤尔塔的回答大部分都在那里。这是想要的行为：

```
;; Prevents issue where you have to press backspace twice when
;; trying to remove the first character that fails a search
(define-key isearch-mode-map [remap isearch-delete-char] 'isearch-del-char)

(defadvice isearch-search (after isearch-no-fail activate)
  (unless isearch-success
    (ad-disable-advice 'isearch-search 'after 'isearch-no-fail)
    (ad-activate 'isearch-search)
    (isearch-repeat (if isearch-forward 'forward))
    (ad-enable-advice 'isearch-search 'after 'isearch-no-fail)
    (ad-activate 'isearch-search))) 
```

# coding-style - 排队运营商是一种有价值的风格吗？

> ID：285662
> 
> 赞同：3
> 
> 时间：2008-11-12T22:42:14.307
> 
> 标签：coding-style

```
some_var = foo()
another_var = bar() 
```

或者

```
some_var    = foo()
another_var = bar() 
```

包括在添加或删除行时更改空格以保持它们对齐。这真的好看吗？是否值得破坏差异？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-12T22:49:51.110

我不认为这是一种好的风格，因为它很难做出改变（你必须做所有重新排列它们的工作），而且对我来说，没有额外的空格它是完全可读的。

尤其令人讨厌的是，当您更改比所有其他行都长的行的左侧部分时，您需要重新排列所有其他行。

例子：

```
some_var    = foo()
another_var = bar() 
```

现在我想添加一个名为`another_another_var`：

```
some_var    = foo()
another_var = bar()
another_another_var = baz() 
```

现在我必须再次排列它们：

```
some_var            = foo()
another_var         = bar()
another_another_var = baz() 
```

很烦人。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-12T22:45:21.587

从我作为 VCS 管理员的那段时间开始，几乎没有文体问题值得解决差异。我们有一个开发者通过他的变性程序改名，而她的新名字没有相同的首字母。然后，每当她在一个程序上工作时，她都会将她以前的首字母缩写为新的，这让我很烦恼。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-12T22:53:26.423

使用 Perl，您可以设置您的偏好并时不时地对您的代码运行 perl-tidy。

它在正确的上下文中提供了对齐的 = 的优点，无需担心需要考虑如何最好地对齐它们并记住自己做。

此外，无论您在项目中使用了何种编码风格，都应该积极维护它。

风格越一致和严格执行，就越容易在代码中发现奇怪和编程错误。

此外，对编码风格的一些强制措施通过强制执行良好的换行规则，从长远来看*减少了基于差异冲突的问题。*

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-12T22:47:36.340

不，除非变量之间存在某种垂直关系，例如：

```
some_var[  1] = "foo";
some_var[100] = "bar"; 
```

但是我这样做的情况很少见，尤其是当我只有几个变量时。这在 SQL 中更为常见，我可能在一行中包含参数名称、类型和默认值（三部分），但即使在那里我也尽量避免它——这不值得麻烦。

```
@some_var varchar(25) = NULL
@another_var varchar(1000) = ''
@one_more int = 0 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-12T22:52:02.073

不。

虽然有些人觉得这种风格很讨人喜欢，但带有语法突出显示的现代 IDE 以这种方式对齐变量是浪费时间，包括在重构或修改代码时重新格式化它们所花费的时间。

此外，我坚信将变量声明为接近需要它们的范围。这很少会导致甚至需要对齐的变量声明块。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-12T23:01:33.193

像这样的样式会导致眼睛垂直移动；但是，代码应该是水平阅读的。编码风格应该补充眼睛所做的事情，而不是与之抗衡。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-12T23:10:27.730

此外，在极端情况下，由于差距很大，很难随便看出哪个作业去哪里。这是我在头文件中经常看到的东西。

```
...
some_important_number                                             = 348273;
initial_message_prefix                                            = "foo";
another_important_number                                          = 348711;
max_bucket_sz                                                     = 456;
... 
```

有几十个这些在一个块中，它变得难以阅读。

# c# - 在 C# 中管理无线网络连接

> ID：285665
> 
> 赞同：13
> 
> 时间：2008-11-12T22:43:59.080
> 
> 标签：c#, .net, networking, wireless

我们有一个用 C# 编写的 WinForms 应用程序，它有一个非常自定义的 GUI。不允许用户运行任何其他应用程序，用户根本无法进入操作系统（WinXP Pro）。我们计划允许用户连接到可用的无线网络。我们将不得不创建一个显示可用网络（通过 SSID）并允许用户连接的配置屏幕。连接后，我们要显示信号强度。

是否有任何现有组件提供此功能？[除了这个](http://sysnet.ucsd.edu/pawn/wrapi/)，我什么都没找到。

我可以使用 WMI 设置 TCP/IP 设置，但我需要指导的是无线设备。

非常感谢！

马特

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-12T22:53:38.280

[托管 Wifi API](http://www.codeplex.com/managedwifi)应该可以工作。

这可能并不理想——你有 XP，这很好，但你必须部署一个修补程序。我会去做，因为我处理过的所有 wifi 代码（对于 Compact Framework）都是可怕的。这段代码尽可能简单。

不过，他们的示例代码不包括读取信号强度，而且我不确定 Native wifi API 是否提供该功能。我编写了获取无线信号强度的 C# 代码，但它通过 PInvoking 到仅在其设备上可用的制造商特定 DLL 来实现这一点。可能您必须执行类似的操作才能从 PC 的无线卡中获取无线强度（这可能是通用 API 中不提供该功能的原因）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-11-11T02:55:12.013

可以使用本机 wifi 连接可用的无线网络。

[http://www.codeproject.com/KB/gadgets/SignalStrenghth.aspx](http://www.codeproject.com/KB/gadgets/SignalStrenghth.aspx)

检查链接，这是由我开发的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-03-05T17:55:11.947

我写了一个库，它是Managed Wifi之上的一个抽象层，使用起来更方便一些。你可以[在 GitHub 上找到它](https://github.com/DigiExam/simplewifi)。

# sql - 如何为不返回行的查询设置默认行？

> ID：285666
> 
> 赞同：48
> 
> 时间：2008-11-12T22:44:01.450
> 
> 标签：sql, sql-server

如果表中不存在行，我需要知道如何返回默认行。最好的方法是什么？我只从这个特定的表中返回一个列来获取它的值。

编辑：这将是 SQL Server。

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2008-11-12T22:55:05.123

Oracle 的一种方法：

```
SELECT val
FROM myTable
UNION ALL
SELECT 'DEFAULT'
FROM dual
WHERE NOT EXISTS (SELECT * FROM myTable) 
```

或者在 Oracle 中：

```
SELECT NVL(MIN(val), 'DEFAULT')
FROM myTable 
```

或者在 SqlServer 中：

```
SELECT ISNULL(MIN(val), 'DEFAULT')
FROM myTable 
```

这些使用在没有行时`MIN()`返回的事实。`NULL`

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-11-13T20:33:25.170

如果您的基本查询预计只返回一行，那么您可以使用这个技巧：

```
select NVL( MIN(rate), 0 ) AS rate 
from d_payment_index
where fy = 2007
  and payment_year = 2008
  and program_id = 18 
```

（Oracle 代码，不确定 NVL 是否适合 SQL Server。）

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-11-12T23:35:51.313

这将消除选择查询运行两次，并提高性能：

```
Declare @rate int

select 
    @rate = rate 
from 
    d_payment_index
where 
    fy = 2007
    and payment_year = 2008
    and program_id = 18

IF @@rowcount = 0
    Set @rate = 0

Select @rate 'rate' 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-02-10T20:57:02.110

这个怎么样：

```
SELECT DEF.Rate, ACTUAL.Rate, COALESCE(ACTUAL.Rate, DEF.Rate) AS UseThisRate
FROM 
  (SELECT 0) DEF (Rate) -- This is your default rate
LEFT JOIN (
  select rate 
  from d_payment_index
  --WHERE 1=2   -- Uncomment this line to simulate a missing value

  --...HERE IF YOUR ACTUAL WHERE CLAUSE. Removed for testing purposes...
  --where fy = 2007
  -- and payment_year = 2008
  --  and program_id = 18
) ACTUAL (Rate) ON 1=1 
```

**结果**

*有效汇率存在*

```
Rate        Rate        UseThisRate
----------- ----------- -----------
0           1           1 
```

*使用的默认费率*

```
Rate        Rate        UseThisRate
----------- ----------- -----------
0           NULL        0 
```

**测试 DDL**

```
CREATE TABLE d_payment_index (rate int NOT NULL)
INSERT INTO d_payment_index VALUES (1) 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2018-07-03T17:40:09.797

此代码段使用公用表表达式来减少冗余代码并提高可读性。这是约翰鲍曼答案的变体。

该语法适用于 SQL Server。

```
WITH products AS (
            SELECT prod_name,
                   price
              FROM Products_Table
             WHERE prod_name LIKE '%foo%'
     ),
     defaults AS (
            SELECT '-' AS prod_name,
                   0   AS price
     )

SELECT * FROM products
UNION ALL
SELECT * FROM defaults
 WHERE NOT EXISTS ( SELECT * FROM products ); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-12T23:01:16.780

我想通了，它也应该适用于其他系统。这是WW答案的变体。

```
select rate 
from d_payment_index
where fy = 2007
  and payment_year = 2008
  and program_id = 18
union
select 0 as rate 
from d_payment_index 
where not exists( select rate 
                  from d_payment_index
                  where fy = 2007
                    and payment_year = 2008
                    and program_id = 18 ) 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-12T23:56:39.633

一种使用从默认值到实际值的左连接的表扫描方法：

```
CREATE TABLE [stackoverflow-285666] (k int, val varchar(255))

INSERT  INTO [stackoverflow-285666]
VALUES  (1, '1-1')
INSERT  INTO [stackoverflow-285666]
VALUES  (1, '1-2')
INSERT  INTO [stackoverflow-285666]
VALUES  (1, '1-3')
INSERT  INTO [stackoverflow-285666]
VALUES  (2, '2-1')
INSERT  INTO [stackoverflow-285666]
VALUES  (2, '2-2')

DECLARE @k AS int
SET @k = 0

WHILE @k < 3
    BEGIN
        SELECT  @k AS k
               ,COALESCE(ActualValue, DefaultValue) AS [Value]
        FROM    (
                 SELECT 'DefaultValue' AS DefaultValue
                ) AS Defaults
        LEFT JOIN (
                   SELECT   val AS ActualValue
                   FROM     [stackoverflow-285666]
                   WHERE    k = @k
                  ) AS [Values]
                ON 1 = 1

        SET @k = @k + 1
    END

DROP TABLE [stackoverflow-285666] 
```

给出输出：

```
k           Value
----------- ------------
0           DefaultValue

k           Value
----------- ------------
1           1-1
1           1-2
1           1-3

k           Value
----------- ------------
2           2-1
2           2-2 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2020-06-19T11:30:48.723

*SQL解决方案

假设您有一个具有主键“id”的评论表。

```
SELECT * FROM review WHERE id = 1555
UNION ALL
SELECT * FROM review WHERE NOT EXISTS ( SELECT * FROM review where id = 1555 ) AND id = 1 
```

如果表没有 1555 id 的评论，则此查询将提供 id 1 的评论。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2020-07-30T13:30:58.710

假设列上有一个`config`具有唯一索引的表`config_code`：

```
CONFIG_CODE     PARAM1   PARAM2
--------------- -------- --------
default_config  def      000
config1         abc      123
config2         def      456 
```

此查询返回`config1`值的行，因为它存在于表中：

```
SELECT *
  FROM (SELECT *
          FROM config
         WHERE config_code = 'config1'
            OR config_code = 'default_config'
         ORDER BY CASE config_code WHEN 'default_config' THEN 999 ELSE 1 END)
 WHERE rownum = 1; 
```

```
CONFIG_CODE     PARAM1   PARAM2
--------------- -------- --------
config1         abc      123 
```

这个返回默认记录，因为`config3`表中不存在：

```
SELECT *
  FROM (SELECT *
          FROM config
         WHERE config_code = 'config3'
            OR config_code = 'default_config'
         ORDER BY CASE config_code WHEN 'default_config' THEN 999 ELSE 1 END)
 WHERE rownum = 1; 
```

```
CONFIG_CODE     PARAM1   PARAM2
--------------- -------- --------
default_config  def      000 
```

与其他解决方案相比，这一解决方案`config`只查询一次表。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-11-12T22:54:08.793

你想返回一整行吗？默认行是否需要具有默认值或可以是空行？您是否希望默认行具有与相关表相同的列结构？

根据您的要求，您可以执行以下操作：

1）运行查询并将结果放入临时表（或表变量）中 2）检查临时表是否有结果 3）如果没有，则通过执行类似于此的选择语句返回一个空行（在 SQL Server 中） ：

```
select '' as columnA, '' as columnB, '' as columnC from #tempTable 
```

其中 columnA、columnB 和 columnC 是您的实际列名。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-05-26T08:03:00.437

将您的默认值插入到表变量中，然后使用您的实际表中的匹配项更新此 tableVar 的单行。如果找到一行，tableVar 将被更新；如果不是，则保留默认值。返回表变量。

```
 ---=== The table & its data
    CREATE TABLE dbo.Rates (
        PkId int,
        name varchar(10),
        rate decimal(10,2)
    )
    INSERT INTO dbo.Rates(PkId, name, rate) VALUES (1, 'Schedule 1', 0.1)
    INSERT INTO dbo.Rates(PkId, name, rate) VALUES (2, 'Schedule 2', 0.2) 
```

这是解决方案：

```
---=== The solution 
CREATE PROCEDURE dbo.GetRate 
  @PkId int
AS
BEGIN
  DECLARE @tempTable TABLE (
    PkId int, 
    name varchar(10), 
    rate decimal(10,2)
 )

 --- [1] Insert default values into @tempTable. PkId=0 is dummy value  
 INSERT INTO @tempTable(PkId, name, rate) VALUES (0, 'DEFAULT', 0.00)

 --- [2] Update the single row in @tempTable with the actual value.
 ---     This only happens if a match is found
 UPDATE @tempTable
    SET t.PkId=x.PkId, t.name=x.name, t.rate = x.rate
    FROM @tempTable t INNER JOIN dbo.Rates x
    ON t.PkId = 0
    WHERE x.PkId = @PkId

 SELECT * FROM @tempTable
END 
```

测试代码：

```
EXEC dbo.GetRate @PkId=1     --- returns values for PkId=1
EXEC dbo.GetRate @PkId=12314 --- returns default values 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-08-02T10:13:58.720

如果没有值存在，这就是我用来获取默认值的方法。

```
select if ((select count(*) from `tbs`.`replication_status`) > 0, (select rs.`last_replication_end_date` from `tbs`.`replication_status` 
          rs where rs.`last_replication_start_date` is not null and rs.`last_replication_end_date` 
          is not null and rs.`table` = '%s' order by id desc limit 1), (select CAST(unix_timestamp(CURRENT_TIMESTAMP(6)) as UNSIGNED))) as ts; 
```

# jquery - IE中的jQuery验证格式问题

> ID：285674
> 
> 赞同：0
> 
> 时间：2008-11-12T22:45:32.693
> 
> 标签：jquery, internet-explorer, validation

在 Firefox 中，错误消息按应有的方式显示。就在要验证的元素的右侧。在 IE 中。无论我如何处理标签/元素/错误的大小，错误总是发布在元素下方，导致所有其他元素都被向下推。

```
<p>
   <label for="handle"><strong>User Name</strong></label>
   <INPUT NAME="handle" id="handle" VALUE="#attributes.getUser.handle#">
</p>                
<p>
   <label for="password"><strong>Password</strong></label>
   <INPUT TYPE="TEXT" id="password" NAME="password"
          MAXLENGTH=50 VALUE="#attributes.getUser.password#">
</p>

<p>
    <label for="confirmPassword"><strong>Confirm Password</strong></label>
    <INPUT TYPE="TEXT" id="confirmPassword" NAME="confirmPassword"
           MAXLENGTH=50 VALUE="#attributes.getUser.password#">
</p> 
```

如果其他人遇到此问题，我将非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-12T23:06:52.947

您是否尝试过关闭**<input>**元素？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-12T23:16:48.373

如果您还没有，您可能需要确保页面是有效的 XHTML（我使用[HTML Validator](http://users.skynet.be/mgueury/mozilla/)）。这应该确保您的所有元素都正确关闭和嵌套。

另外，您是否尝试过对元素使用 CSS 定位，例如将显示设置为内联？

没有看到代码很难说。如果是定位问题，[Firebug](https://addons.mozilla.org/en-US/firefox/addon/1843)通常会很有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-09T15:16:47.887

我在这些输入元素上设置了“margin-bottom：16px”样式。

删除它（经过数小时的反复试验和搜索）解决了问题。

希望可以节省一些时间。;^)

# java - 用 Java 表示货币价值

> ID：285680
> 
> 赞同：94
> 
> 时间：2008-11-12T22:49:22.157
> 
> 标签：java, currency, bigdecimal

我知道 BigDecimal 是在 Java 中表示货币价值的推荐最佳实践。你用什么？有没有你更喜欢使用的更好的库？

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2008-11-12T22:57:18.460

`BigDecimal`一路走来。我听说有些人创建了他们自己的`Cash`或`Money`用货币封装现金价值的类，但在皮肤下它仍然是一个`BigDecimal`，可能是[`BigDecimal.ROUND_HALF_EVEN`](http://java.sun.com/j2se/1.5.0/docs/api/java/math/BigDecimal.html#ROUND_HALF_EVEN)四舍五入。

**编辑：**正如 Don 在[他的回答中提到的那样，有一些像](https://stackoverflow.com/questions/285680/representing-monetary-values-in-java#286228)[timeandmoney](http://timeandmoney.sourceforge.net/)这样的开源项目，虽然我赞扬他们试图阻止开发人员重新发明轮子，但我对使用 pre-alpha 库没有足够的信心它在生产环境中。此外，如果您在引擎盖下四处挖掘，您会发现[他们也`BigDecimal`使用](http://timeandmoney.svn.sourceforge.net/viewvc/timeandmoney/timeandmoney/trunk/src/main/java/com/domainlanguage/money/Money.java?view=markup).

* * *

## 回答 #2

> 赞同：52
> 
> 时间：2010-01-27T11:13:03.150

通过搜索引擎到达这里以了解 JodaMoney 的人们可能会很有用：http: [//www.joda.org/joda-money/](http://www.joda.org/joda-money/)。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2011-10-11T21:34:12.970

我不是在这里表达我的观点，但是有很多反对 BigDecimal 的很好的论据，有人可能应该扔掉：

[http://lemnik.wordpress.com/2011/03/25/bigdecimal-and-your-money/](http://lemnik.wordpress.com/2011/03/25/bigdecimal-and-your-money/)

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2011-09-20T21:48:53.563

我之前遇到的一个方便的库是[Joda-Money](http://www.joda.org/joda-money/)库。它的实现之一确实基于 BigDecimal。它基于[ISO-4217](http://en.wikipedia.org/wiki/ISO_4217)货币规范，可以支持自定义货币列表（通过 CVS 加载）。

这个库有少量文件，如果需要修改，可以快速浏览。Joda-Money 在 Apache 2.0 许可下发布。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-11-12T22:58:48.190

如果您只使用美元和美分，我会使用 long（偏移 2 个小数位）。如果您需要更多细节，大十进制可能是要走的路。

无论哪种方式，我可能会扩展该类以拥有一个使用正确格式的 .toString() ，并作为放置可能出现的其他方法的地方（如果小数是很长的，乘法和除法会出错没有调整）

此外，如果您使用定义自己的类和接口，那么您可以随意替换实现。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-11-12T22:57:40.080

`BigDecimal`或另一种定点表示通常是金钱所需要的。

浮点 ( `Double`, `Float`) 表示和计算不精确，导致错误结果。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-13T00:34:13.130

在处理时间和金钱时，你必须非常小心。

当您使用金钱时，我希望每个人都应该知道永远不要使用浮点数或双精度数。

但我不确定 BigDecimal。

在大多数情况下，如果您只跟踪 int 或 long 中的美分，就可以了。这样你永远不会处理小数位。

您仅在打印时显示美元。始终使用整数使用 cents internal。如果需要除法或需要使用 Math.abs()，这可能会很棘手。

但是，您可能会关心半分钱，甚至百分之一分钱。我不知道有什么好方法可以做到这一点。您可能只需要处理千分之一美分并使用多头。或者你可能会被迫使用 BigDecimal

我会对此做更多的阅读，但忽略所有开始谈论使用浮点数或双精度数来代表金钱的人。他们只是自找麻烦。

我觉得我的建议不完整，所以请多加补充。您正在处理危险类型！

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-11-13T03:27:00.350

创建一个 Money 类是要走的路。在下面使用 BigDecimal（甚至是 int）。然后使用 Currency 类来定义舍入约定。

不幸的是，没有运算符重载，Java 使得创建这样的基本类型变得非常不愉快。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-11-13T04:01:07.877

有一个更好的图书馆，[timeandmoney](http://timeandmoney.sourceforge.net/)。IMO，它远远优于 JDK 提供的用于表示这两个概念的库。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-11-13T12:43:51.687

绝对不是 BigDecimal。舍入和表示有很多特殊规则，您必须担心。

Martin Fowler 建议实现一个专门的[Money](http://martinfowler.com/eaaCatalog/money.html)类来表示货币金额，并且它还实现了货币转换的规则。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2011-03-14T21:39:27.143

嘿，这是一篇关于 BigDecimal 的非常有趣的文章，以及为什么有时使用它而不是双精度数的说明性示例。[BigDecimal 教程](http://www.opentaps.org/docs/index.php/How_to_Use_Java_BigDecimal:_A_Tutorial)。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-11-13T15:40:57.507

最终显示货币值时，您可以使用 DecimalFormat 类。它提供本地化支持并且非常可扩展。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-07-16T13:19:41.397

我会将 BigDecimal 封装在 Money 类中，就像上面提到的那样，它也有货币。重要的是你要进行大量的单元测试，尤其是在使用不同的货币时。此外，如果您添加一个方便的构造函数，该构造函数接受一个字符串或一个执行相同操作的工厂方法，这样您就可以编写类似这样的测试，这也是一个好主意：

```
 assertEquals(Money.create("100.0 USD").add("10 GBP"),Money.create("116 USD")); 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2013-07-23T17:09:29.987

总是有限制和细节。任何没有足够经验来理解以下文章中概述的微妙问题的人都应该在处理真实世界的财务数据之前认真重新考虑：

[http://lemnik.wordpress.com/2011/03/25/bigdecimal-and-your-money](http://lemnik.wordpress.com/2011/03/25/bigdecimal-and-your-money)

BigDecimal 并不是唯一正确的表示或唯一的拼图。在特定条件下，使用由存储为整数的美分支持的 Money 类可能就足够了，并且比 BigDecimal 快得多。是的，这意味着使用美元作为货币并限制金额，但这种限制对于许多用例来说是完全可以接受的，而且所有货币都有四舍五入和小面额的特殊情况，因此没有“通用”解决方案。

# sql - SQL多对多房地产表，但唯一的整体

> ID：285685
> 
> 赞同：2
> 
> 时间：2008-11-12T22:51:19.673
> 
> 标签：sql

这是给你们的一个不错的低手吊球。

所以基本上我的内容表具有唯一的主键 ID，我的标签表具有唯一的主键 ID。

我有一个表，其中有一个标识列作为主键，但另外两个列是 contentID 和 tagID。我需要对表做些什么来确保我只有一次相同的 contentID 和 tagID 组合。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-12T22:53:39.793

您对 contentID、tagID 设置了唯一约束。

对于 SQL 服务器

```
ALTER TABLE ContentTag ADD CONSTRAINT
    IX_ContentID_TagID_Unique UNIQUE NONCLUSTERED ( contentID,  tagID ) 
GO 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-12T23:48:04.847

在多对多连接表上有一个数字（代理）键是有原因的......也就是说，当有其他子派生表需要外键返回到该表中的记录时......即，假设您有表 PetStores w/StoreId、表 Breeds w/BreedId 和多对多连接表 StoreBreeds，其中每个 store=breed 组合都有一行...然后假设您要跟踪价格，并且每个商店的每个品种的商店折扣，因为它随着时间的推移而变化，所以您需要另一个表格来记录每个商店每个品种的价格，有效的开始和结束日期反映价格生效的日期范围那家商店的品种..

如果您对于多对多连接表只有一个有意义的复合键，那么子表中的 FK 也必须是复合的，基于 StoreId 和 BreedId... 为了提高性能，添加一个无意义的整数代理键连接表允许您将其用作派生子表中的 FK，从而提高连接的性能以检索这些子记录......

在简单的情况下，这***可能***不是那么重要，但在更复杂的情况下，复合键由 4 个或更多列组成，影响可能很大。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-12T23:05:47.007

从数据建模的角度来看，没有理由需要映射表中的标识列。主键约束应该是 , 上的两列`contentID`约束`tagID`。

一些框架（例如 Rails）要求*每个*表都有一个名为 的代理键`id`，即使它对实体关系没有意义。这很遗憾，但显然这种约定在其他地方给了他们一些效率。

除了代理键列上的表主键之外，您始终可以在 上创建`UNIQUE`约束。`contentID``tagID`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T14:01:35.820

考虑这个问题：

表 A 有 2 个子表（ B 和 C ）

B 和 C 的 PK 是一个身份，他们都有一个 FK 回到表 A。

我有一个表 D，它是 B 和 C 上的连接表

表 D 有一个身份的 PK 和 FK 的背对 B 和 C。

A .....两行... A1和A2

B ... 两排 ... B1（FK 到 A1）和 B2（FK 到 A2）

C ... 两排 .... C1（FK 到 A1）和 C2（FK 到 A2）

D .....我可以将以下内容添加到 D .... FK 到 B1 和 FK 到 C1 .....这是错误的。

我想确保在 D 中引用的任何 B 和 C 都指向同一个 A ！！！

使用复合键这是可能的....但是我看不到如何在数据库中以身份为用户的方式完成它。

艾伦

# emacs - 扩展 XHTML 的 RelaxNG (rnc) 模式

> ID：285687
> 
> 赞同：3
> 
> 时间：2008-11-12T22:51:41.373
> 
> 标签：emacs, xhtml, xsd, relaxng

我想使用 Emacs 的[nxml-mode](http://www.emacswiki.org/emacs/NxmlMode)编辑 XHTML 文件，它可以使用[rnc](http://infohost.nmt.edu/tcc/help/pubs/rnc/)模式进行动态验证。这些都内置在较新的 Emacs 版本中。

但是，我的 XHTML 文件包含来自另一个模式的元素。所以 <foo:foo> 标签是有效的，但只在文档的 <xhtml:head> 内。

目前，nxml 抱怨是因为它使用的 XHTML 模式没有描述 foo 标记。如何创建一个描述与现有 XHTML 模式相关的 foo 标记的新模式，以及如何使用schemas.xml 文件中的[模式定位规则自动应用该模式？](http://www.dpawson.co.uk/relaxng/nxml/schemaloc.html)

即：我想同时使用两种模式来验证文档：内置的 XHTML 规则和一些添加某些命名空间标签的自定义规则。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-12T23:03:07.557

[Validator.nu](http://validator.nu/)有一个[预设的模式](http://s.validator.nu/xhtml1-rdf-svg-mathml.rnc)，该模式是从最初由 James Clark 开发的 XHTML 模式集修改而来的，其中一个补充是 rdf:RDF in head，因此该模式可能对研究有用。

（我没有处理 nxml 模式模式位置问题的经验。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-05-29T04:50:06.433

W3C 就是这样。例如，这里是 XHTML+RDFa 的 rng：

```
<?xml version="1.0" encoding="iso-8859-1"?>
<!-- XHTML+RDFa 1.0 -->

<grammar ns="http://www.w3.org/1999/xhtml"
         xmlns="http://relaxng.org/ns/structure/1.0"
         datatypeLibrary="http://www.w3.org/2001/XMLSchema-datatypes">

<include href="xhtml-datatypes-1.rng"/>
<include href="xhtml-attribs-1.rng"/>
<include href="xhtml-text-1.rng"/>
<include href="xhtml-list-1.rng"/>
<include href="xhtml-object-1.rng"/>
<include href="xhtml-pres-1.rng"/>
<include href="xhtml-edit-1.rng"/>
<include href="xhtml-bdo-1.rng"/>
<include href="xhtml-form-1.rng"/>
<include href="xhtml-table-1.rng"/>
<include href="xhtml-image-1.rng"/>
<include href="xhtml-ssismap-1.rng"/>
<include href="xhtml-events-1.rng"/>
<include href="xhtml-inlstyle-1.rng"/>
<include href="xhtml-base-1.rng"/>
<include href="xhtml-ruby-1.rng"/>
<include href="xhtml-metaAttributes-1.rng"/>

<define name="xhtml.Common.attrib" combine="interleave">
  <optional>
    <attribute name="href">
      <ref name="xhtml.URI.datatype"/>
    </attribute>
  </optional>
  <ref name="xhtml.Metainformation.attrib"/>
</define>

<include href="xhtml-hypertext-1.rng">
    <define name="xhtml.a.attlist">
      <ref name="xhtml.Common.attrib"/>
      <optional>
        <attribute name="charset">
          <ref name="xhtml.Charset.datatype"/>
        </attribute>
      </optional>
      <optional>
        <attribute name="type">
          <ref name="xhtml.ContentType.datatype"/>
        </attribute>
      </optional>
      <optional>
        <attribute name="hreflang">
          <ref name="xhtml.LanguageCode.datatype"/>
        </attribute>
      </optional>
      <optional>
        <attribute name="accesskey">
          <ref name="xhtml.Character.datatype"/>
        </attribute>
      </optional>
      <optional>
        <attribute name="tabindex">
          <ref name="xhtml.Number.datatype"/>
        </attribute>
      </optional>
    </define>
</include>

<include href="xhtml-link-1.rng">
    <define name="xhtml.link.attlist">
      <ref name="xhtml.Common.attrib"/>
      <optional>
        <attribute name="charset">
          <ref name="xhtml.Charset.datatype"/>
        </attribute>
      </optional>
      <optional>
        <attribute name="hreflang">
          <ref name="xhtml.LanguageCode.datatype"/>
        </attribute>
      </optional>
      <optional>
        <attribute name="type">
          <ref name="xhtml.ContentType.datatype"/>
        </attribute>
      </optional>
      <optional>
        <attribute name="media">
          <ref name="xhtml.MediaDesc.datatype"/>
        </attribute>
      </optional>
    </define>
</include>

<include href="xhtml-meta-1.rng">
    <define name="xhtml.meta.attlist">
      <ref name="xhtml.Common.attrib"/>
      <optional>
        <attribute name="http-equiv">
          <data type="NMTOKEN"/>
        </attribute>
      </optional>
      <optional>
        <attribute name="name">
          <data type="NMTOKEN"/>
        </attribute>
      </optional>
      <optional>
        <attribute name="scheme">
          <text/>
        </attribute>
      </optional>
    </define>
</include>

<include href="xhtml-script-1.rng">
    <define name="xhtml.script.attlist">
      <ref name="xhtml.id.attrib"/>
      <ref name="xhtml.Metainformation.attrib"/>
      <optional>
        <attribute name="href">
          <ref name="xhtml.URI.datatype"/>
        </attribute>
      </optional>
      <optional>
        <attribute name="charset">
          <ref name="xhtml.Charset.datatype"/>
        </attribute>
      </optional>
      <attribute name="type">
        <ref name="xhtml.ContentType.datatype"/>
      </attribute>
      <optional>
        <attribute name="src">
          <ref name="xhtml.URI.datatype"/>
        </attribute>
      </optional>
      <optional>
        <attribute name="defer">
          <value>defer</value>
        </attribute>
      </optional>
      <optional>
        <attribute name="xml:space">
          <value>preserve</value>
        </attribute>
      </optional>
    </define>
</include>

<include href="xhtml-style-1.rng">
    <define name="xhtml.style.attlist">
      <ref name="xhtml.title.attrib"/>
      <ref name="xhtml.I18n.attrib"/>
      <ref name="xhtml.id.attrib"/>
      <ref name="xhtml.Metainformation.attrib"/>
      <optional>
        <attribute name="href">
          <ref name="xhtml.URI.datatype"/>
        </attribute>
      </optional>
      <attribute name="type">
        <ref name="xhtml.ContentType.datatype"/>
      </attribute>
      <optional>
        <attribute name="media">
          <ref name="xhtml.MediaDesc.datatype"/>
        </attribute>
      </optional>
      <!-- <optional>
        <attribute name="xml:space">
          <value>preserve</value>
        </attribute>
      </optional> -->
    </define>
</include>

<include href="xhtml-csismap-1.rng">
    <define name="xhtml.area.attlist">
      <ref name="xhtml.Common.attrib"/>
      <ref name="xhtml.shape.attrib"/>
      <ref name="xhtml.coords.attrib"/>
      <optional>
        <attribute name="nohref">
          <value>nohref</value>
        </attribute>
      </optional>
      <attribute name="alt">
        <ref name="xhtml.Text.datatype"/>
      </attribute>
      <optional>
        <attribute name="tabindex">
          <ref name="xhtml.Number.datatype"/>
        </attribute>
      </optional>
      <optional>
        <attribute name="accesskey">
          <ref name="xhtml.Character.datatype"/>
        </attribute>
      </optional>
    </define>
</include>

<include href="xhtml-param-1.rng">
    <define name="xhtml.param.attlist">
      <ref name="xhtml.id.attrib"/>
      <ref name="xhtml.Metainformation.attrib"/>
      <optional>
        <attribute name="href">
          <ref name="xhtml.URI.datatype"/>
        </attribute>
      </optional>
      <attribute name="name"/>
      <optional>
        <attribute name="value"/>
      </optional>
      <optional>
        <attribute name="valuetype">
          <choice>
        <value>data</value>
        <value>ref</value>
        <value>object</value>
          </choice>
        </attribute>
      </optional>
      <optional>
        <attribute name="type">
          <ref name="xhtml.ContentType.datatype"/>
        </attribute>
      </optional>
    </define>
</include>

<include href="xhtml-struct-1.rng">
    <define name="xhtml.title.attlist">
      <ref name="xhtml.Common.attrib"/>
    </define>

    <define name="xhtml.head.attlist">
      <ref name="xhtml.Common.attrib"/>
      <ref name="xhtml.profile.attlist"/>
    </define>

    <define name="xhtml.html.attlist">
      <ref name="xhtml.XHTML.version.attrib"/>
      <ref name="xhtml.Common.attrib"/>
    </define>
</include>

</grammar> 
```

**参考**

*   [RelaxNG 的 XHTML 模块化：使用 RelaxNG 定义和扩展 XHTML 的技术](http://www.w3.org/MarkUp/2010/xhtml-m12n-relaxng-20101216/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-06-20T19:18:12.497

问题 1：我相信您在这里不想要两个模式，而是一个“包含”另一个模式，并结合[了 RelaxNG 教程](http://www.relaxng.org/compact-tutorial-20030326.html)第 9.2 节中描述的覆盖/组合规则。我自己也在为此苦苦挣扎。

问题2：第二个问题我可以给你更好的答案；nxml-mode 在多个位置之一中查找“schemas.xml”文件，该文件执行模式匹配以将文件与模式相关联。对于最简单的映射，我将此文件放在与 xml 文件相同的目录中：

```
<?xml version='1.0'?>
<locatingRules xmlns="http://thaiopensource.com/ns/locating-rules/1.0">
  <uri resource="auto.xml" uri="lab.rnc"/>
</locatingRules> 
```

该文件将“auto.xml”文件与“lab.rnc”规范相关联。

# ms-word - 在不使用 ole 自动化的情况下以编程方式将 word docx 转换为 doc

> ID：285700
> 
> 赞同：8
> 
> 时间：2008-11-12T22:54:49.820
> 
> 标签：ms-word, ms-office

我正在寻找一种在不使用 ole 自动化的情况下以编程方式将 docx 格式的 word 文档转换为 doc 格式的方法。我已经有一个可以执行此操作的 Windows 服务，但这意味着在服务器上安装 Office，它有点不可靠且不受支持。我知道 aspose.words 产品，我会尝试一下，但是有没有人建议如何尽可能简单、可靠和便宜地做到这一点？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-26T14:25:57.170

不使用 OLE 自动化的一种选择是包装兼容包附带的转换器 dll，以便在不自动化 Office 的情况下从 docx 转换为 doc。

这只需要在机器上安装 Office 的兼容包。

Office 转换器 dll 使用接口 ForeignToRtf/RtfToForeign 从它们支持的文档格式转换为 RTF 和/或从 RTF 转换为其文档格式。您可以根据需要链接转换器，从一种格式转换为另一种格式，例如进行转换 DOCX -> RTF -> DOC。

您可以[从 Microsoft 获取 SDK](http://support.microsoft.com/?scid=kb%3Ben-us%3B111716&x=16&y=7)，其中包含一些关于如何使用现有转换器的示例。如果我没记错的话，已经包含了一个命令行包装示例。一切都是 C/C++ 的东西。

您可以通过查看以下注册表项找出哪些转换器 dll 负责 OpenXML 转换：

```
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Shared Tools\Text Converters\Import\Word12 
```

如果您需要更多详细信息，请告诉我。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-27T02:06:31.507

You could use [docx4j](http://dev.plutext.org) (or indeed, just poi) to read the docx, and poi to write it out as a .doc

# validation - 约束与验证？

> ID：285704
> 
> 赞同：1
> 
> 时间：2008-11-12T22:55:20.880
> 
> 标签：validation, data-binding, oop, constraints

我正在使用 Windows 窗体数据绑定，实现类似`IDataErrorInfo`. 为了使其工作，域（或业务）对象被允许处于无效状态。实际上，域对象需要在用户输入时保留无效值`IDataErrorInfo`才能正常工作。只要对象不处于无效状态，我们就可以了。

但是，正如主题行所暗示的那样，我想知道约束和验证之间是否存在差异。前者会阻止用户进行更改，后者是我上面描述的验证类型。

让我解释一下——如果你有一个集合`Person`并且`Person`有一个`SSN`属性。是`PersonCollection`keyed on `SSN`，意思是在集合中，不能有两个`Persons`相同的`SSN`。如果我们在 上允许临时无效状态，我们会引入一种情况，即集合`Person`中有两个`Persons`重复的情况，尽管是暂时的。`SSN`这可能导致另一个对象使用`PersonCollection`，寻找`Person`具有重复对象的对象`SSN`，获取两个对象的问题。

所以，对我来说，似乎某些类型的验证需要是约束而不是（更改后）验证。

想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-09-07T14:26:30.393

以您为例，您对 的验证的一部分`Person`应该是检查其`SSN`是否不重复的规则（顺便说一句：在重复的情况下，您怎么知道哪个是正确的？）。

如果您遇到麻烦，因为您`PersonCollection`实际上是`IDictionary`由 s 键入`SSN`的，请等到 a`Person`被验证后再将其添加到集合中。一个对象应该是暂时无效的，足以让你这样做。

有关验证的更多信息，请查看我对[Business Objects, Validation And Exceptions](https://stackoverflow.com/questions/88541/business-objects-validation-and-exceptions)[的回答](https://stackoverflow.com/questions/88541/business-objects-validation-and-exceptions/133045#133045)。

# c++ - What techniques can you use to profile your code

> ID：285710
> 
> 赞同：2
> 
> 时间：2008-11-12T22:58:44.773
> 
> 标签：c++, profile, profiler, homebrew

Some of the platforms that I develop on, don't have profiling tools. I am looking for suggestions/techniques that you have personally used to help you identify hotspots, without the use of a profiler.

The target language is C++.

I am interested in what you have personally used.

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-13T00:40:24.757

No joke: In addition to dumping timings to std::cout and other text/data oriented approaches I also use the Beep() function. There's something about hearing the gap of silence between two "Beep" checkpoints that makes a different kind of impression.

It's like the difference between looking at a written sheet music, and actually HEARING the music. It's like the difference between reading rgb(255,0,0) and seeing fire-engine red.

So, right now, I have a client/server app and with Beeps of different frequencies, marking where the client sends the message, where the server starts its reply, finishes its reply, where reply first enters the client, etc, I can very naturally get a feel for where the time is spent.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-13T00:31:31.327

I've found the following quite useful:

```
#ifdef PROFILING
# define PROFILE_CALL(x) do{ \
    const DWORD t1 = timeGetTime(); \
    x; \
    const DWORD t2 = timeGetTime(); \
    std::cout << "Call to '" << #x << "' took " << (t2 - t1) << " ms.\n"; \
  }while(false)
#else
# define PROFILE_CALL(x) x
#endif 
```

Which can be used in the calling function as such:

```
PROFILE_CALL(renderSlow(world));
int r = 0;
PROFILE_CALL(r = readPacketSize()); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-12T23:04:46.370

In essence, if a profiling tool is not available, you emulate what a profiler would have done. You insert counters into functions you think are interesting and count how many times, and potentially with what size/sort of arguments they're called.

If you have access to any timers on your platform, you may start/stop these at the beginning/end of said functions to get execution time information as well, if this is unclear from the code. This is going to give you the biggest bang for your buck in complex code, as there will usually be too many functions to instrument them all. Instead, you can obtain the time spent in certain sections of code by dedicating a timer to each one.

These two techniques in tandem can form an iterative approach, where you find the broad section of code that consumes the majority of your cycles using timers, then instrument individual functions at a finer granularity to hone in on the problem.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-12T23:16:11.540

If it is something sufficiently long in duration (e.g. a minute or more), I run the software in a debugger then break a few times and see where the debugger breaks, this gives a very rough idea of what the software is up to (e.g. if you break 10 times and they are all in the same place, this tells you something interesting!). Very rough and ready but doesn't require any tools, instrumentation etc.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-13T03:51:04.590

I'm not sure what platforms you had in mind, but on embedded microcontrollers, it's sometimes helpful to twiddle a spare digital output line and measure the pulse width using an oscilloscope, counter/timer, or logic analyzer.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-13T00:42:38.683

I would use the 80/20 rule and put timers around hotspots or interesting call paths. You should have a general idea where the bottlenecks will be (or at least a majority of the execution paths) and use the appropriate platform dependent high resolution timer (QueryPerformanceCounters, gettimeofday, etc.).

I usually don't bother with anything at startup or shutdown (unless needed) and will have well defined "choke points", usually message passing or some sort of algorithmic calculation. I've generally found that message sinks/srcs (sinks moreso), queues, mutexes, and just plain mess-ups (algorithms, loops) usually account for most of the latency in an execution path.

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-14T03:34:36.147

Are you using Visual Studio?

The you can use the /Gh and /GH switches. [Here's an example involving stack inspection](http://www.codeproject.com/KB/tips/stackdumper.aspx)

These flags allow you, by a file-by-file basis, to register undecorated functions that are called every time a method is entered and/or left in runtime.

You can then register all times of profiling information, not just timing information. Stack-dumps, calling address, return address, etc. Which is important, because you may want to know that 'function X used Y time under function Z' and not just the total time spent in function X.

# java - Java：将文件读入数组

> ID：285712
> 
> 赞同：31
> 
> 时间：2008-11-12T22:58:52.170
> 
> 标签：java, arrays

我有一个文件（称为“number.txt”），我想将其读取到 Java 中的数组中。我该怎么做呢？它是一个简单的“一维”文件，包含 100 个数字。

问题是我每次都会遇到异常。显然它找不到它（我确信它的拼写正确）。在查看代码示例时，它没有指定文件的整个文件路径，只指定文件本身的名称。如果有必要，我将如何去做？

另外，在读取文件时，数组会自动包含文件的所有行，还是我必须创建一个循环，将每一行复制到相应的下标 i？

我听说过 BufferedReader 类，它的用途是什么，它与读取输入有何关联？

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2008-11-12T23:09:22.443

以下是一些示例代码，可帮助您入门：

```
package com.acme;

import java.io.BufferedReader;
import java.io.FileReader;
import java.io.IOException;
import java.util.ArrayList;
import java.util.List;

public class FileArrayProvider {

    public String[] readLines(String filename) throws IOException {
        FileReader fileReader = new FileReader(filename);
        BufferedReader bufferedReader = new BufferedReader(fileReader);
        List<String> lines = new ArrayList<String>();
        String line = null;
        while ((line = bufferedReader.readLine()) != null) {
            lines.add(line);
        }
        bufferedReader.close();
        return lines.toArray(new String[lines.size()]);
    }
} 
```

还有一个示例单元测试：

```
package com.acme;

import java.io.IOException;

import org.junit.Test;

public class FileArrayProviderTest {

    @Test
    public void testFileArrayProvider() throws IOException {
        FileArrayProvider fap = new FileArrayProvider();
        String[] lines = fap
                .readLines("src/main/java/com/acme/FileArrayProvider.java");
        for (String line : lines) {
            System.out.println(line);
        }
    }
} 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2012-09-26T00:08:09.753

```
import java.io.File;

import java.nio.charset.Charset;
import java.nio.file.Files;
import java.nio.file.Path;

import java.util.List;

// ...

Path filePath = new File("fileName").toPath();
Charset charset = Charset.defaultCharset();        
List<String> stringList = Files.readAllLines(filePath, charset);
String[] stringArray = stringList.toArray(new String[]{}); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-05-19T20:48:50.907

Apache Commons I/O 提供 FileUtils#readLines()，除了大文件外，它应该适用于所有文件：[http](http://commons.apache.org/io/api-release/index.html) ://commons.apache.org/io/api-release/index.html 。2.1 发行版包括 FileUtils.lineIterator()，它适用于大文件。Google 的 Guava 库包含类似的实用程序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-12T23:17:44.127

您应该能够在 Java 中使用正斜杠来引用文件位置。

BufferedReader 类用于包装其他读取方法可能效率不高的文件读取器。更详细的描述可以在[Java APIs](http://java.sun.com/javase/6/docs/api/java/io/BufferedReader.html)中找到。

Toolkit 对 BufferedReader 的使用可能正是您所需要的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-09-21T14:24:07.833

为了完整起见，另一种读取文件¹的所有行的方法`String[]`是使用 Java 8+`BufferedReader.lines()`方法。像这样：

```
BufferedReader br ...
String[] lines = br.lines().toArray(String[]::new); 
```

请注意，由于`lines()`流无法提前告诉下游方法会有多少行，因此`String`需要创建一些临时数组。但是，该实现旨在避免不必要的复制。

* * *

^(1 - 您可以将此方法与任何可以用`BufferedReader`.)

# c# - 使用 ASP.NET 自动化 Excel

> ID：285715
> 
> 赞同：2
> 
> 时间：2008-11-12T22:59:04.960
> 
> 标签：c#, asp.net, excel, interop, pia

## 背景

我们正在使用 ASP.NET 2.0 开发一些内部实用程序。其中之一是从数据库中提取一些信息并构建一个 Excel 工作簿，其中包含许多电子表格，其中包含基于对数据库的查询的数据。

## 问题

概念验证原型（一个简单的 ASP.NET 页面，从数据库中查询单个项目并打开 Excel 以将数据添加到工作表）在开发机器上本地运行时运行良好，可以愉快地创建和显示 Excel 电子表格按照要求。但是，当在我们的服务器上运行时，我们在尝试实例化 Excel 时收到以下错误。

无法将类型为“Microsoft.Office.Interop.Excel.ApplicationClass”的 COM 对象转换为接口类型“Microsoft.Office.Interop.Excel._Application”。此操作失败，因为 IID 为“{000208D5-0000-0000-C000-000000000046}”的接口的 COM 组件上的 QueryInterface 调用因以下错误而失败：不支持此类接口（来自 HRESULT 的异常：0x80004002 (E_NOINTERFACE)） .

## 解决方案？

我们正在使用 PIA for Excel 2003，并且我们在服务器上安装了 Excel 2003 和 PIA。谁能解释为什么这不起作用或给我们一些关于如何追踪问题的提示？

感谢您提供的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-12T23:08:38.857

运行 ASP.NET 应用程序池的用户可以访问应用程序吗？尝试以该用户身份登录（或将应用程序池更改为以该用户身份运行）并打开 Excel。如果可行，请尝试在服务器上以该用户身份使用失败的代码运行 WinForms 应用程序。

不确定，但我认为 PIA 程序集可能需要通过 regsvr32 注册。

我怀疑如果您作为网络​​服务运行，您将无法启动 Excel（没有交互式登录、受限帐户等）。您的 ASP.NET 代码在应用程序池中运行。您可以通过 IIS 管理器更改应用程序池运行的用户。如果您想检查您的代码当前正在运行什么，请在任务管理器中查找 w3wp 进程。

为了进行测试，请将应用程序池更改为以您知道的使用 Excel 的用户身份运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-12T23:21:56.100

我们使用 Aspose（商业）。服务器上的办公并不好玩。

*   您必须小心许可。
*   偶尔你需要杀死一个挂起的进程。
*   获得正确的权利需要一些努力。

它被称为 PI(t)A 是有原因的……

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-12T23:54:23.087

考虑使用**XLSX 文件**（Office 2007 中的新功能，但有一个适用于 Office 2003 的插件），它们只是包含 XML 文件的 ZIP 文件，您可以在不需要 Excel 的情况下对其进行操作。（基于 XML 的）SpreadsheetML 有很好的文档记录，编程起来也不太复杂（您甚至可以在网络上的某个地方找到一个 LINQ to SpreadsheetML）。

如上所述，Excel 并不是真正的服务器产品，在服务器上使用它时可能会遇到各种问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-13T00:14:30.177

我认为问题在于，一旦将应用程序部署到 IIS，就会突然在 MTA COM 单元内运行。我相信 Excel 是一个 STA 组件，因此不能在 MTA 中创建。您需要在您正在使用的页面中设置 aspcompat 选项

```
<%@ page aspcompat=true %> 
```

[更多信息在这里](http://aspnetfaq.com/default.aspx?FaqId=139&CategoryId=48)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-18T14:07:52.013

来自[Microsoft](http://support.microsoft.com/kb/257757)，（强调原始来源）：

> **Microsoft 目前不推荐也不支持任何无人值守、非交互式客户端应用程序或组件（包括 ASP、ASP.NET、DCOM 和 NT 服务）的 Microsoft Office 应用程序自动化，因为 Office 可能表现出不稳定的行为和/或在此环境中运行 Office 时出现死锁。**

列出你不应该这样做的原因：

> *   ... 许多服务在没有用户配置文件的帐户下运行（例如 SYSTEM 帐户或 IWAM_[servername] 帐户）。因此，Office 可能无法在启动时正确初始化。在这种情况下，Office 在 CreateObject 函数或 CoCreateInstance 函数上返回错误。即使可以启动 Office 应用程序，如果不存在用户配置文件，其他功能也可能无法正常工作。
> *   如果发生意外错误，或者需要未指定的参数来完成某项功能，Office 旨在通过一个模式对话框提示用户，询问用户想要做什么。无法关闭非交互式桌面上的模式对话框。因此，该线程无限期地停止响应（挂起）。尽管某些编码实践可以帮助降低出现此问题的可能性，但这些实践并不能完全防止该问题。**仅这一事实就使得从服务器端环境运行 Office 应用程序存在风险且不受支持。**
> *   服务器端组件需要是高度可重入、多线程的 COM 组件，对多个客户端具有最小的开销和高吞吐量。Office 应用程序几乎在所有方面都完全相反。Office 应用程序是不可重入的、基于 STA 的自动化服务器，旨在为单个客户端提供多样化但资源密集型的功能。

您的代码可能会引发以下错误：

*   `CoCreateInstance`

    *   运行时错误“429”：ActiveX 组件无法创建对象
    *   运行时错误“70”：权限被拒绝
    *   CO_E_SERVER_EXEC_FAILURE (0x80080005)：服务器执行失败
    *   E_ACCESSDENIED (0x80070005)：访问被拒绝
    *   挂起
    *   返回没有错误，但没有工作

最后：

> 由于 Office 设计的限制，对 Office 配置的更改不足以解决所有问题。**Microsoft 强烈建议使用一些不需要在服务器端安装 Office 并且可以比自动化更高效、更快速地执行大多数常见任务的替代方案。**在将 Office 作为服务器端组件加入项目之前，请考虑替代方案。

# linux - 在（ubuntu）linux中捕获第二个键盘输入

> ID：285716
> 
> 赞同：13
> 
> 时间：2008-11-12T22:59:16.707
> 
> 标签：linux, input, barcode

我编写了一个程序，该程序从第二个 USB 键盘（实际上是条形码扫描仪）获取输入。问题是，如果另一个窗口处于活动状态，则数据是在那里输入的，而不是在我的程序中。有人可以就我做错了什么给我建议吗？

```
#include <stdio.h>
#include <string.h>

int main(int argc, char * argv[]){
   FILE * fp_in;
   char * data;
   fp_in = fopen("/dev/input/by-id/usb-04d9_1400-event-kbd","r");

   if(fp_in == NULL){
      fprintf(stderr,"Failed to open input by id\n");
   }

   fp_in = fopen("/dev/input/by-path/pci-0000:00:1d.1-usb-0:2:1.0-event-kbd","r");

   if(fp_in == NULL){
      fprintf(stderr,"Failed to open input by path\n");
      return 1;
   }

  while(1){
      fscanf(fp_in,data,"%s");
      fprintf(stderr,"%s",data);
  }
  return 0;
} 
```

谢谢

* * *

如果我可以大胆地代表 Confuzzled 重新表述这个问题：

如何在 Linux 下编写一个将自身附加到输入设备（在本例中为条形码扫描仪）的程序，以便输入不会转到具有键盘焦点的程序？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-02-17T01:49:04.483

我试图做同样的事情，我所做的是使用 xinput “浮动”该设备。就我而言，`xinput list`节目（除其他外）

`HID Keyboard Device HID Keyboard Device id=13 [slave keyboard (3)]`

这是与条形码扫描仪对应的设备。然后你可以简单地输入

`xinput float 13`

进入一个终端。来自扫描仪的击键将不再进入焦点窗口，但仍可以从设备文件中读取。但是，您需要对从文件中读取的事件进行解码，以获得所需的信息（条形码）。查看[/dev/input/event* 的格式？](https://stackoverflow.com/questions/5060710/format-of-dev-input-event)有关如何执行此操作的一些信息。

最后，要在没有 root 权限的情况下读取设备文件，只需为扫描仪添加 udev 规则即可。对我来说，它是这样的：

`SUBSYSTEM=="input", ATTRS{idVendor}=="1d57", ATTRS{idProduct}=="001c" MODE="0644"`

扫描仪的 idVendor 和 idProduct 可以通过检查`dmesg`插入扫描仪后的输出来找到。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-01-12T13:01:59.293

自从提出这个问题以来已经有一段时间了 :) 无论如何，我认为您应该做的是使用 linux 输入设备子系统 API。

[http://www.linuxjournal.com/article/6429](http://www.linuxjournal.com/article/6429)这里有一个很好的介绍。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-12T23:58:20.910

我将从围绕您的任务的常见问题列表开始，我没有答案，但我至少可以提供一些关于您遇到问题的原因**。**

1.  出于明显的安全原因，键盘设备对其具有访问控制限制。出于显而易见的原因，如果任意应用程序可以在未经正确许可的情况下嗅探/挂钩键盘，则可能会产生致命后果，AKA：键盘记录器。

2.  有时，当一个应用程序（在您的情况下为 X ）获得了输入设备的控制权时，它会吃掉所有发送给它的字节。因此，如果您设法解决了权限问题，您仍然会遇到一些其他软件正在使用您之前的数据流的问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-10-23T16:14:06.697

如果我正确理解了您的问题，则可能存在与您想要做的事情相对应的一些问题。

1) 为了从 /dev 文件夹中的这些文件中读取，您需要具有 root 权限。

2）（我对此不太确定）但我相信这些是特殊文件，因此您无法像普通文件一样阅读它们。

假设你解决了这两个问题，它仍然不能解决你的问题，因为 X 事件是由 X 服务器处理的，你可以认为它是同时读取同一个文件。它是捕获这些事件并通过调用相关事件处理程序（如果有）为最顶部活动窗口中的特定事件相应地处理它们的事件。所有的窗口都与 X 服务器对话，它会告诉您是否输入了某些内容。因此，即使您打开了一个正在运行程序的终端窗口，X 服务器首先必须告诉窗口有关按键的信息，然后将这些按键传递给终端中运行的程序。

可以在[此处](http://www.thelinuxdaily.com/2010/05/grab-raw-keyboard-input-from-event-device-node-devinputevent/ "这里")找到另一个执行类似工作的代码。

# ruby-on-rails - rails 的 cron 工作：最佳实践？

> ID：285717
> 
> 赞同：305
> 
> 时间：2008-11-12T22:59:50.530
> 
> 标签：ruby-on-rails, rake, daemon, cron, runner

在 Rails 环境中运行计划任务的最佳方式是什么？脚本/跑步者？耙？我想每隔几分钟运行一次任务。

* * *

## 回答 #1

> 赞同：265
> 
> 时间：2011-06-16T20:01:28.603

我在严重依赖计划任务的项目中使用了非常流行的[每当，它很棒。](https://github.com/javan/whenever)它为您提供了一个很好的 DSL 来定义您的计划任务，而不必处理 crontab 格式。从自述文件：

> When 是一个 Ruby gem，它为编写和部署 cron 作业提供了清晰的语法。

自述文件中的示例：

```
every 3.hours do
  runner "MyModel.some_process"       
  rake "my:rake:task"                 
  command "/usr/bin/my_great_command"
end

every 1.day, :at => '4:30 am' do 
  runner "MyModel.task_to_run_at_four_thirty_in_the_morning"
end 
```

* * *

## 回答 #2

> 赞同：114
> 
> 时间：2009-06-15T11:40:50.423

我正在使用 rake 方法（由[heroku](https://devcenter.heroku.com/articles/scheduler)支持）

使用名为 lib/tasks/cron.rake 的文件 ..

```
task :cron => :environment do
  puts "Pulling new requests..."
  EdiListener.process_new_messages
  puts "done."
end 
```

要从命令行执行，这只是“rake cron”。然后可以根据需要将此命令放在操作系统 cron/task 调度程序上。

**更新**这是一个相当古老的问题和答案！一些新信息：

*   我引用的 heroku cron 服务已被[Heroku Scheduler取代](https://devcenter.heroku.com/articles/scheduler)
*   对于频繁的任务（尤其是您想避免 Rails 环境启动成本的地方），我首选的方法是使用系统 cron 调用脚本，该脚本将（a）戳一个安全/私有 webhook API 以在后台调用所需的任务或 (b) 直接在您选择的排队系统中加入任务

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2013-08-10T06:23:37.550

在我们的项目中，我们首先使用了 gem，但是遇到了一些问题。

然后我们切换到**[RUFUS SCHEDULER](https://github.com/jmettraux/rufus-scheduler)** gem，结果证明它在 Rails 中调度任务非常简单可靠。

我们用它来发送每周和每天的邮件，甚至用于运行一些周期性的 rake 任务或任何方法。

这里使用的代码如下：

```
 require 'rufus-scheduler'

    scheduler = Rufus::Scheduler.new

    scheduler.in '10d' do
      # do something in 10 days
    end

    scheduler.at '2030/12/12 23:30:00' do
      # do something at a given point in time
    end

    scheduler.every '3h' do
      # do something every 3 hours
    end

    scheduler.cron '5 0 * * *' do
      # do something every day, five minutes after midnight
      # (see "man 5 crontab" in your terminal)
    end 
```

要了解更多信息：[https ://github.com/jmettraux/rufus-scheduler](https://github.com/jmettraux/rufus-scheduler)

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2008-11-12T23:56:38.153

假设您的任务不会花费太长时间来完成，只需为每个任务创建一个带有操作的新控制器。将任务的逻辑实现为控制器代码，然后在操作系统级别设置一个 cronjob，使用 wget 以适当的时间间隔调用此控制器的 URL 和操作。这种方法的优点是你：

1.  就像在普通控制器中一样，可以完全访问所有 Rails 对象。
2.  可以像您进行正常操作一样进行开发和测试。
3.  还可以从一个简单的网页临时调用您的任务。
4.  不要通过启动额外的 ruby​​/rails 进程来消耗更多的内存。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2013-02-21T22:04:17.857

每当（和 cron）的问题是它每次执行时都会重新加载 rails 环境，当您的任务很频繁或有很多初始化工作要做时，这是一个真正的问题。因此，我在生产中遇到了问题，必须警告您。

Rufus 调度程序为我做这件事（[https://github.com/jmettraux/rufus-scheduler](https://github.com/jmettraux/rufus-scheduler)）

当我有很长的工作要运行时，我将它与 delay_job ( [https://github.com/collectiveidea/delayed_job](https://github.com/collectiveidea/delayed_job) )一起使用

我希望这有帮助！

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2008-11-13T14:43:53.347

script/runner 和 rake 任务非常适合作为 cron 作业运行。

这是运行 cron 作业时必须记住的一件非常重要的事情。它们可能不会从您的应用程序的根目录中调用。这意味着您对文件（而不是库）的所有需求都应使用显式路径完成：例如 File.dirname(__FILE__) + "/other_file"。这也意味着您必须知道如何从另一个目录显式调用它们:-)

检查您的代码是否支持从另一个目录运行

```
# from ~
/path/to/ruby /path/to/app/script/runner -e development "MyClass.class_method"
/path/to/ruby /path/to/rake -f /path/to/app/Rakefile rake:task RAILS_ENV=development 
```

此外，cron 作业可能不会像您一样运行，因此不要依赖您在 .bashrc 中放置的任何快捷方式。但这只是一个标准的 cron 提示；-)

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2013-06-11T04:43:25.447

[我是resque](https://github.com/resque/resque) / [resque scheduler](https://github.com/bvandenbos/resque-scheduler)的忠实粉丝。您不仅可以运行重复的类似 cron 的任务，还可以在特定时间运行任务。缺点是，它需要一个 Redis 服务器。

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2015-10-13T15:44:30.500

有趣的是，没有人提到[Sidetiq](https://github.com/tobiassvn/sidetiq)。如果您已经在使用 Sidekiq，这是很好的补充。

> Sidetiq 提供了一个简单的 API 来为 Sidekiq 定义循环工作者。

作业将如下所示：

```
class MyWorker
  include Sidekiq::Worker
  include Sidetiq::Schedulable

  recurrence { hourly.minute_of_hour(15, 45) }

  def perform
    # do stuff ...
  end
end 
```

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2008-11-14T18:19:17.063

两者都可以正常工作。我通常使用脚本/跑步者。

这是一个例子：

`0 6 * * * cd /var/www/apps/your_app/current; ./script/runner --environment production 'EmailSubscription.send_email_subscriptions' >> /var/www/apps/your_app/shared/log/send_email_subscriptions.log 2>&1`

如果您加载正确的配置文件以连接到您的数据库，您也可以编写一个纯 Ruby 脚本来执行此操作。

如果内存很宝贵，要记住的一件事是脚本/运行程序（或依赖于“环境”的 Rake 任务）将加载整个 Rails 环境。如果您只需要在数据库中插入一些记录，这将使用您实际上不需要的内存。如果您编写自己的脚本，则可以避免这种情况。我实际上还不需要这样做，但我正在考虑。

* * *

## 回答 #10

> 赞同：9
> 
> 时间：2008-12-28T21:11:22.933

使用[Craken](http://dougmcinnes.com/2008/07/14/craken/)（以 rake 为中心的 cron 作业）

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2008-11-13T00:12:04.080

我使用背景。

[http://backgroundrb.rubyforge.org/](http://backgroundrb.rubyforge.org/)

我使用它来运行计划任务以及对于正常的客户端/服务器关系而言耗时过长的任务。

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2014-10-24T20:20:07.157

使用 Sidekiq 或 Resque 是更强大的解决方案。它们都支持重试作业、具有 REDIS 锁的排他性、监控和调度。

请记住，Resque 是一个死项目（没有积极维护），所以 Sidekiq 是一个更好的选择。它还具有更高的性能：Sidekiq 在单个多线程进程中运行多个工作者，而 Resque 在单独的进程中运行每个工作者。

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2009-01-26T15:54:15.780

这是我设置 cron 任务的方式。我有一个用于 SQL 数据库的每日备份（使用 rake），另一个用于每月一次过期缓存。任何输出都记录在文件 log/cron_log 中。我的 crontab 看起来像这样：

```
crontab -l # command to print all cron tasks
crontab -e # command to edit/add cron tasks

# Contents of crontab
0 1 * * * cd /home/lenart/izziv. whiskas.si/current; /bin/sh cron_tasks >> log/cron_log 2>&1
0 0 1 * * cd /home/lenart/izziv.whiskas.si/current; /usr/bin/env /usr/local/bin/ruby script/runner -e production lib/monthly_cron.rb >> log/cron_log 2>&1 
```

第一个 cron 任务每天进行数据库备份。cron_tasks 的内容如下：

```
/usr/local/bin/rake db:backup RAILS_ENV=production; date; echo "END OF OUTPUT ----"; 
```

第二个任务是稍后设置的，并使用脚本/运行器每月一次过期缓存（lib/monthly_cron.rb）：

```
#!/usr/local/bin/ruby
# Expire challenge cache
Challenge.force_expire_cache
puts "Expired cache for Challenges (Challenge.force_expire_cache) #{Time.now}" 
```

我想我可以通过其他方式备份数据库，但到目前为止它对我有用:)

rake 和 ruby​​ 的**路径在不同的服务器上可能会有所不同。**您可以使用以下命令查看它们的位置：

```
whereis ruby # -> ruby: /usr/local/bin/ruby
whereis rake # -> rake: /usr/local/bin/rake 
```

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2014-08-26T18:10:29.577

您可以使用`resque`和`resque-schedular`gem 来创建 cron，这很容易做到。

[https://github.com/resque/resque](https://github.com/resque/resque)

[https://github.com/resque/resque-scheduler](https://github.com/resque/resque-scheduler)

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2015-11-05T09:35:20.157

我最近为我一直从事的项目创建了一些 cron 工作。

我发现宝石**发条**非常有用。

```
require 'clockwork'

module Clockwork
  every(10.seconds, 'frequent.job')
end 
```

你甚至可以使用这个 gem 来安排你的后台工作。有关文档和进一步帮助，请参阅[https://github.com/Rykian/clockwork](https://github.com/Rykian/clockwork)

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2014-04-01T20:07:14.527

曾经我不得不做出同样的决定，今天我对这个决定感到非常高兴。使用**resque 调度**器，因为不仅一个单独的 redis 会从你的数据库中取出负载，你还可以访问许多插件，比如 resque-web，它提供了一个很好的用户界面。随着系统的发展，您将有越来越多的任务要安排，因此您将能够从一个地方控制它们。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2013-02-14T20:17:35.890

可能最好的方法是使用 rake 编写您需要的任务，然后通过命令行执行它。

[您可以在 railscasts](http://railscasts.com/episodes/66-custom-rake-tasks)看到一个非常有用的视频

另请查看其他资源：

*   [Rails Rake 教程](http://www.railsenvy.com/2007/6/11/ruby-on-rails-rake-tutorial)

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2014-07-03T02:33:28.420

我使用了[发条](https://github.com/tomykaira/clockwork)宝石，它对我来说效果很好。还有`clockworkd`允许脚本作为守护进程运行的 gem。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2008-11-13T08:11:20.727

我不太确定，我想这取决于任务：运行频率、复杂程度以及需要与 Rails 项目进行多少直接通信等。我想是否只有*“一种最佳方式”*来做某事，不会有这么多不同的方法来做到这一点。

在我在 Rails 项目中的最后一份工作中，我们需要制作一个批量邀请邮件（调查邀请，而不是垃圾邮件），它应该在服务器有时间时发送计划的邮件。我想我们将使用[守护程序工具](http://en.wikipedia.org/wiki/Daemontools)来运行我创建的 rake 任务。

不幸的是，我们公司出现了一些资金问题，被主要竞争对手“收购”，因此项目从未完成，所以我不知道我们最终会用什么。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2017-09-21T10:27:45.837

我使用脚本运行 cron，这是运行 cron 的最佳方式。这是 cron 的一些示例，

打开 CronTab —> sudo crontab -e

并粘贴波纹管线：

00 00 * * * wget [https://your_host/some_API_end_point](https://your_host/some_API_end_point)

这是一些cron格式，对您有帮助

```
::CRON FORMAT:: 
```

[![cron 格式表](https://i.stack.imgur.com/ut6wO.png)](https://i.stack.imgur.com/ut6wO.png)

```
Examples Of crontab Entries
15 6 2 1 * /home/melissa/backup.sh
Run the shell script /home/melissa/backup.sh on January 2 at 6:15 A.M.

15 06 02 Jan * /home/melissa/backup.sh
Same as the above entry. Zeroes can be added at the beginning of a number for legibility, without changing their value.

0 9-18 * * * /home/carl/hourly-archive.sh
Run /home/carl/hourly-archive.sh every hour, on the hour, from 9 A.M. through 6 P.M., every day.

0 9,18 * * Mon /home/wendy/script.sh
Run /home/wendy/script.sh every Monday, at 9 A.M. and 6 P.M.

30 22 * * Mon,Tue,Wed,Thu,Fri /usr/local/bin/backup
Run /usr/local/bin/backup at 10:30 P.M., every weekday. 
```

希望对你有帮助 ：）

# email - 如何找出我的主机为我安装的邮件服务器？

> ID：285718
> 
> 赞同：5
> 
> 时间：2008-11-12T23:00:06.770
> 
> 标签：email, mediatemple

我正在使用 MediaTemple 的 (dv) 托管服务。如何确定安装了哪些邮件服务器？我应该使用外壳吗？如果是这样，将使用什么命令？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-11-12T23:07:25.507

转到 shell 并键入以下命令：

```
telnet <hostname> 25 
```

这将返回如下一行：

```
220 example.com ESMTP Exim 4.69 Thu, 13 Nov 2008 10:06:01 +1100 
```

如您所见，此服务器正在运行 EXIM。

然后键入 QUIT 退出回 shell。

* * *

**更新：**一些主机使用不同的地址作为他们的电子邮件服务器，如果你在 Linux 上，你可以键入以下命令来获取给定域的邮件服务器列表：

```
dig -t MX example.com 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-13T00:28:30.443

尝试

```
$ nmap -p 25 -A -T polite <hostname> 
```

来自安装了 nmap 的 Linux 机器。

# c++ - 面向 C# 开发人员的 C++

> ID：285723
> 
> 赞同：61
> 
> 时间：2008-11-12T23:01:17.170
> 
> 标签：c++

我是一名 .NET 开发人员，在此之前使用过 VB6。我已经非常熟悉这些环境，并且在垃圾收集语言的上下文中工作。然而，我现在想用原生 C++ 来增强我的技能，发现自己有点不知所措。具有讽刺意味的是，这并不是我想象的初学者通常的绊脚石，因为我觉得我已经很好地掌握了指针和内存管理。对我来说有点困惑的事情更像是：

*   引用/使用其他库
*   公开*我的*库供其他人使用
*   字符串处理
*   数据类型转换
*   良好的项目结构
*   要使用的数据结构（即，在 C# 中，我使用`List<T>`了很多，我在 C++ 中使用什么类似？）

几乎感觉就像取决于您使用的 IDE，指南是不同的，所以我真的在寻找可能更通用的东西。或者在最坏的情况下，专注于使用微软的编译器/IDE。另外，为了清楚起见，我并不是在寻找有关一般编程实践（设计模式、代码完成等）的任何内容，因为我觉得我非常精通这些主题。

* * *

## 回答 #1

> 赞同：202
> 
> 时间：2008-11-12T23:34:18.680

我知道你说你已经很好地掌握了指针和内存管理，但我仍然想解释一个重要的技巧。作为一般经验法则，*永远不要*在您的用户代码中添加新/删除。

每个资源获取（无论是同步锁、数据库连接还是内存块或其他任何必须获取和释放的东西）都应该包装在一个对象中，以便构造函数执行获取，而析构函数释放资源。该技术被称为[RAII](http://en.wikipedia.org/wiki/Resource_Acquisition_Is_Initialization)，基本上*是*避免内存泄漏的方法。习惯它。C++ 标准库显然广泛使用了这一点，因此您可以了解它是如何工作的。稍微跳一下你的问题，相当于`List<T>`is `std::vector<T>`，它使用 RAII 来管理它的内存。你会像这样使用它：

```
void foo() {

  // declare a vector *without* using new. We want it allocated on the stack, not
  // the heap. The vector can allocate data on the heap if and when it feels like
  // it internally. We just don't need to see it in our user code
  std::vector<int> v;
  v.push_back(4);
  v.push_back(42); // Add a few numbers to it

  // And that is all. When we leave the scope of this function, the destructors 
  // of all local variables, in this case our vector, are called - regardless of
  // *how* we leave the function. Even if an exception is thrown, v still goes 
  // out of scope, so its destructor is called, and it cleans up nicely. That's 
  // also why C++ doesn't have a finally clause for exception handling, but only 
  // try/catch. Anything that would otherwise go in the finally clause can be put
  // in the destructor of a local object.
} 
```

如果我必须选择一个 C++ 程序员必须学习和接受的单一原则，那就是上面的。让作用域规则和析构函数为您工作。它们提供了编写安全代码所需的所有保证。

## 字符串处理：

`std::string`你的朋友在那儿吗？在 C 语言中，您会使用 char（或 char 指针）数组，但这些很讨厌，因为它们的行为不像字符串。在 C++ 中，您有一个 std::string 类，它的行为与您期望的一样。唯一要记住的是“hello world”的类型是 char[12] 而不是 std::string。（为了 C 兼容性），因此有时您必须将字符串文字（用引号括起来的内容，例如“hello world”）显式转换为 std::string 以获得您想要的行为：您仍然可以编写

```
std::string s = "hello world"; 
```

因为 C 风格的字符串（比如文字，比如 "hello world"）可以隐式转换为 std::string，但它并不总是有效： "hello" + "world" 不会编译，因为 + 运算符是'没有为两个指针定义。"hello worl" + 'd' 然而，*会*编译，但它不会做任何明智的事情。它不会将 char 附加到字符串，而是采用 char 的整数值（它被提升为 int），并将其添加到指针的值中。

std::string("hello worl") + "d" 会按照您的预期执行，因为左侧已经是 std::string，并且加法运算符已重载，以便 std::string 执行您的操作'会期望，即使右侧是 char* 或单个字符。

关于字符串的最后一点说明：std::string 使用 char，它是一种单字节数据类型。也就是说，它不适用于 unicode 文本。C++ 提供了宽字符类型 wchar_t，它是 2 或 4 个字节，具体取决于平台，通常用于 unicode 文本（尽管在这两种情况下，C++ 标准都没有真正指定字符集）。一串 wchar_t 被称为 std::wstring。

## 图书馆：

从根本上说，它们不存在。C++ 语言没有库的概念，这需要一些时间来适应。它允许您#include 另一个文件（通常是扩展名为 .h 或 .hpp 的头文件），但这只是逐字复制/粘贴。预处理器简单地将这两个文件组合成所谓的翻译单元。多个源文件通常包含相同的标头，并且仅在某些特定情况下有效，因此这一位是理解 C++ 编译模型的关键，这是出了名的古怪。不像 C# 编译器那样编译一堆单独的模块，并在它们之间交换某种元数据，每个翻译单元都是独立编译的，

当然，有一些特定于平台的方法来编写库。在 Windows 上，您可以创建 .dll 或 .lib，不同之处在于 .lib 链接到您的应用程序中，而 .dll 是一个单独的文件，您必须与您的应用程序捆绑在一起，就像在 .NET 中一样。在 Linux 上，等效的文件类型是 .so 和 .a，在所有情况下，您还必须提供相关的头文件，以便人们能够针对您的库进行开发。

## 数据类型转换：

我不确定您到底在寻找什么，但我认为重要的一点是，如下所示的“传统”演员阵容很糟糕：

```
int i = (int)42.0f; 
```

有几个原因。首先，它尝试按顺序执行几种不同类型的强制转换，您可能会对编译器最终应用哪种类型感到惊讶。第二，在搜索中很难找到，第三，它不够丑。通常最好避免强制转换，并且在 C++ 中，为了提醒您这一点，它们变得有点难看。;)

```
// The most common cast, when the types are known at compile-time. That is, if 
// inheritance isn't involved, this is generally the one to use
static_cast<U>(T); 

// The equivalent for polymorphic types. Does the same as above, but performs a 
// runtime typecheck to ensure that the cast is actually valid
dynamic_cast<U>(T); 

// Is mainly used for converting pointer types. Basically, it says "don't perform
// an actual conversion of the data (like from 42.0f to 42), but simply take the
// same bit pattern and reinterpret it as if it had been something else). It is
// usually not portable, and in fact, guarantees less than I just said.
reinterpret_cast<U>(T); 

// For adding or removing const-ness. You can't call a non-const member function
// of a const object, but with a const-cast you can remove the const-ness from 
// the object. Generally a bad idea, but can be necessary.
const_cast<U>(T); 
```

正如您将注意到的，这些类型转换更加具体，这意味着如果类型转换无效，编译器会给您一个错误（与传统语法不同，它只会尝试上述任何类型类型转换，直到找到一个有效的类型)，它又大又冗长，让您可以搜索它，并提醒您应尽可能避免使用它们。;)

## 标准库：

最后，回到数据结构，花一些精力去理解标准库。它虽小，但用途广泛，一旦你学会了如何使用它，你就会处于一个更好的位置。

标准库由几个非常不同的构建块组成（该库随着时间的推移而积累起来。它的一部分是从 C 移植的。I/O 流库是从一个地方采用的，容器类及其相关功能也被采用来自一个完全不同的库，并且设计明显不同。后者是通常被称为 STL（标准模板库）的一部分。严格来说，这是库的名称，稍作修改，就被采用了C++ 标准库。

STL 是理解“现代 C++”的关键。它由三个支柱，容器，迭代器和算法组成。简而言之，容器暴露了迭代器，算法在迭代器对上工作。

下面的示例采用一个 int 向量，将每个元素加 1，然后将其复制到链表中，仅作为示例：

```
int add1(int i) { return i+1; } // The function we wish to apply

void foo() {
  std::vector<int> v;
  v.push_back(1);
  v.push_back(2);
  v.push_back(3);
  v.push_back(4);
  v.push_back(5); // Add the numbers 1-5 to the vector

  std::list<int> l;

  // Transform is an algorithm which applies some transformation to every element
  // in an iterator range, and stores the output to a separate iterator
  std::transform ( 
  v.begin(),
  v.end(), // Get an iterator range spanning the entire vector
  // Create a special iterator which, when you move it forward, adds a new 
  // element to the container it points to. The output will be assigned to this
  std::back_inserter(l) 
  add1); // And finally, the function we wish to apply to each element
} 
```

上述风格需要一些时间来适应，但它非常强大和简洁。因为转换函数是模板化的，所以它可以接受*任何*类型作为输入，只要它们表现为迭代器。这意味着该函数可用于组合任何类型的容器，甚至是流或任何其他可以迭代的东西，只要迭代器被设计为与 STL 兼容。我们也不必使用开始/结束对。我们可以传递一个指向第三个元素的迭代器，而不是结束迭代器，然后算法就会停在那里。或者我们可以编写自定义迭代器来跳过所有其他元素，或者我们喜欢的任何其他元素。以上是三个支柱中每一个支柱的基本示例。我们使用容器来存储我们的数据，但我们用来处理它的算法实际上并不需要知道容器。它只需要知道它必须工作的迭代器范围。

从某种意义上说，这与 LINQ 非常相似，所以既然您来自 .NET，您可能会看到一些类比。STL 对应物更灵活一些，但代价是语法稍微奇怪。:) （正如评论中提到的，它也更有效。一般来说， STL 算法的开销*为零*，它们可以与手动编码循环一样高效。这通常令人惊讶，但这是可能的，因为所有相关类型都是在编译时已知（这是模板工作的要求），并且 C++ 编译器倾向于积极内联。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-12T23:12:22.267

你有一些可用的工具包。例如，有被认为是行业标准的 STL（标准模板库）和 Boost/TR1（STL 的扩展）（好吧，至少是 STL）。它们提供列表、映射、集合、共享指针、字符串、流和各种其他方便的工具。最重要的是，它们在编译器中得到广泛支持。

至于数据转换，您可以进行强制转换或创建显式转换器函数。

库 - 您可以创建静态库（融入最终的可执行文件）或 DLL（您已经熟悉这些）。MSDN 是一个很棒的 DLL 资源。静态库取决于您的构建环境。

总的来说，这是我的建议： - 非常了解您选择的 IDE - 购买 Herbert Schildt 的“C++ The Complete Reference”，我认为这是一本关于所有 C++（包括 STL）的优秀著作

考虑到你的背景，一旦你做到了这两点，你就应该做好准备。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-12T23:54:17.097

我不会重复其他人所说的关于库等的内容，但如果您对 C++ 很认真，请帮自己一个忙，并拿起 Bjarne Stroustrup 的“C++ 编程语言”。

我花了多年的 C++ 工作才终于拿到了一份副本，一旦我拿到了，我花了一个下午拍着我的额头说“当然！我应该意识到！等等。”

（具有讽刺意味的是，我对 K&R 的“C 编程语言”有完全相同的体验。总有一天，我会学会在第一天就去拿“书”。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-12T23:12:41.407

引用和使用其他库，如果您包含源代码，只需通过#include 库的头文件到您需要它们的任何 .cpp 文件中来完成（然后将库的源代码与您的项目一起编译）。然而，大多数时候，您可能会使用 .lib（静态库）或 .dll（动态库）。大多数（全部？）DLL 都带有一个 .lib 文件，因此两种类型的过程是相同的：在需要它们的地方包含适当的头文件，然后在链接步骤中添加关联的 .lib 文件（在 Visual Studio 中，我认为您可以将文件添加到项目中）。

自从我创建自己的库供其他人使用以来已经有很长时间了，所以我会让其他人回答这部分。或者我明天会回来编辑这个答案，因为我明天必须为工作创建一个 .lib :)

字符串的东西通常是用 std::string 完成的。在特殊情况下，您还可以使用旧的 C 风格的 sprintf() 函数，但通常不鼓励这样做。

至于您要查找的数据结构，请查看 STL（标准模板库）。它包括您应该熟悉的List、Vector、Map、String等。我不确定您所说的类型转换是什么意思...我假设您知道强制转换，因此您的意思一定比这更复杂，在这种情况下，它可能特定于您要转换的类型。也许其他人可以提供更多信息。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-19T03:23:45.577

*回应“引用/使用其他库”*

有关在 C/C++ 中为 windows 和 linux 显式加载 DLL 的信息包括...

**视窗：**

[Windows DLL 教程](http://www.codeguru.com/cpp/cpp/cpp_mfc/tutorials/article.php/c9855#more)

函数：*LoadLibrary、GetProcAddress、FreeLibrary*

**Linux：**

函数：*dlopen、dlsym、dlerror、dlclose*

[Linux DLL 教程](http://www.ibm.com/developerworks/library/l-dll.html)

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-01-28T14:52:15.343

我为这样的程序员[写了小备忘单](http://khason.net/blog/pinvoke-cheat-sheet/)。您也可能对更复杂的情况感兴趣，例如[可变参数](http://khason.net/blog/how-to-pinvoke-varargs-variable-arguments-in-c-or-hidden-junk-in-clr/)

# wpf - WPF 绑定到网格列宽

> ID：285730
> 
> 赞同：10
> 
> 时间：2008-11-12T23:04:24.420
> 
> 标签：wpf, grid

我正在尝试将`DependancyProperty`我的一个用户控件中的 a 绑定到a中的 a的`Width`属性。`Column``Grid`

我有类似这样的代码：

```
<Grid x:Name="MyGridName">
    <Grid.ColumnDefinitions>
        <ColumnDefinition x:Name="TitleSection" Width="100" />
        <ColumnDefinition Width="*" />
    </Grid.ColumnDefinitions>

    <Grid.RowDefinitions>...</Grid.RowDefinitions>

    <GridSplitter x:Name="MyGridSplitter" Grid.Row="0" Grid.Column="0" ... />
</Grid> 
```

在一个单独的用户控件中，我`DependancyProperty`定义了以下内容。

```
public static readonly DependencyProperty TitleWidthProperty = DependencyProperty.Register("TitleWidth", typeof(int), typeof(MyUserControl));

public int TitleWidth
{
    get { return (int)base.GetValue(TitleWidthProperty); }
    set { base.SetValue(TitleWidthProperty, value); }
} 
```

我正在代码中创建 Usercontrol 的实例，因此我有一个类似于此的绑定语句：

```
MyUserControl Cntrl = new MyUserControl(/* Construction Params */);
BindingOperations.SetBinding(Cntrl , MyUserControl.AnotherProperty, new Binding { ElementName = "objZoomSlider", Path = new PropertyPath("Value"), Mode = BindingMode.OneWay });
BindingOperations.SetBinding(Cntrl , MyUserControl.TitleWidthProperty, new Binding { ElementName = "TitleSection", Path = new PropertyPath("ActualWidth"), Mode = BindingMode.OneWay });
/* Other operations on Cntrl */ 
```

定义的第一个绑定非常有效，尽管它绑定到实际的 UIElement（在本例中为 Slider），但绑定到“TitleSection”（即 Grid 中定义的 ColumnDefinition）失败。在代码中放置断点并监视“TitleSection”会返回预期的对象。

我开始怀疑不能绑定 ax:Name'd ColumnDefinition 。**谁能建议我如何能够绑定到网格中第一列的不断变化的宽度？**

**编辑＃1 - 回答评论**

数据绑定“失败”是因为在`TitleWidth`属性的设置器上设置了断点，并使用 GridSplitter 控件调整第一列的大小，断点永远不会被命中。`TitleWidth`此外，当 DependancyProperty更改未执行时，我希望触发的代码。

正在创建用户控件并将其添加到函数中 Grid 内的 Stackpanel `Window_Loaded`。我希望在构建用户控件时已经呈现了网格。当然，x:Name'd 元素`TitleSection`是可观察的，并且具有`100`构建它们的时间/绑定发生之前的值。

**编辑#2 - 可能与此有关？**

我一直在对 Grid ColumnDefinition 文档的 MSDN 页面进行嗅探，并且遇到了[GridLength()](http://msdn.microsoft.com/en-us/library/system.windows.gridlength.aspx)但我无法理解如何在绑定表达式中使用它。我不能在绑定代码中使用关联的 GridLengthConverter 作为转换器，因为它不是从 IValueConverter 派生的。

我倾向于以某种方式绑定到 Grid 对象中一个单元格的 ActualWidth 属性。它似乎不像绑定到列定义那样干净，但目前我无法让它工作。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-13T10:20:22.060

好吧，我有些杂乱无章，我将为后代解释一下：

本质上，我有一个 2 列、多行网格，其拆分器在第一列中右对齐，因此如果它包含的内容需要更多空间，用户可以调整它的大小。为了使事情复杂化，我有一个用户控件以编程方式加载到一些行中，这些行的 columnSpan 为 2 用于呈现目的（内容从一个单元格“渗入”到下一个单元格）。

调整第一列的大小时，我需要将其反映在用户控件中。首先，我尝试绑定到 ColumnDefinition ，但它真的不是在玩球。

**我是如何修复/混淆它的**

在第一列的备用单元格中，我添加了`<Label>`带有 x:Name 的 a 以使其可访问。因为它在一个单元格中，所以它具有“拉伸”的默认属性并完全填充单元格。随着使用拆分器调整列的大小，它会调整大小。绑定到标签的`ActualWidth`属性意味着对列大小的更改将正确传达给我的 columnSpanned 用户控件中的 DependancyProperty。

**想法**

显然，尽管 ColumnDefinition 在更改时具有`ActualWidth`属性，但它似乎不会在`PropertyChanged`内部触发事件（或者这是我的最佳猜测）。这可能是一个错误，或者是设计使然，但对我来说，这意味着我不得不使用一个不太干净的解决方案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-13T09:56:04.103

您是否尝试过在 xaml 中设置绑定，以下内容应该适合您。

```
<ColumnDefinition 
    x:Name="TitleSection" 
    Width="{Binding 
                Path=TitleWidth, 
                RelativeSource={RelativeSource AncestorType=MyUserControl}}" 
    /> 
```

否则，查看您提供的绑定代码，它看起来对我来说是错误的，绑定的目标应该是网格列，源应该是您的依赖属性。

上述 xaml 的等效代码是

```
BindingOperations.SetBinding(TitleSection, ColumnDefinition.WidthProperty,
    new Binding()
    {
        RelativeSource= new RelativeSource(RelativeSourceMode.FindAncestor, typeof(MyUserControl),1),
        Path = new PropertyPath("TitleWidth"),
    }); 
```

在相关说明中，使用 GridSplitter 和绑定 Width 属性是互斥的。使用拆分器调整列大小后，您的绑定将被拆分器中的值替换。

这类似于您通过更新作为绑定目标的任何属性所遇到的情况。当您直接在代码中设置目标值时，您实际上是将绑定对象替换为您提供的值。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-11-06T17:17:51.127

ColumnDefinition.Width 不是整数 - 它是 GridLength。您不能将 GridLength 直接绑定到 Integer，您需要一个转换器。

这也是为什么不能在没有转换器的情况下将任何 Control 的 Width 属性 (double) 绑定到 ColumnDefinition 的 Width 属性 (GridLength) 的原因。

# c - 从两个不同的 C DLL 调用具有相同名称的两个函数

> ID：285731
> 
> 赞同：11
> 
> 时间：2008-11-12T23:04:27.040
> 
> 标签：c, windows, visual-studio-2008, dll

我有两个需要在同一个可执行文件中访问的 C DLL。我有两个库的头文件和 .LIB 文件。不幸的是，我需要访问的部分功能具有完全相同的名称。到目前为止，我能够提出的最佳解决方案是使用 LoadLibrary 加载其中一个 DLL，并使用 GetProcAddress 显式调用其方法。有没有办法让我隐式加载这两个库并以某种方式给编译器一个提示，在一种情况下我想在 DLL A 中调用 OpenApi，而在另一种情况下我想在 DLL B 中调用 OpenApi？

我正在使用 Visual Studio 2008 和相应的 C 运行时库 (msvcr90.dll) 在 C++ 中开发我的可执行文件。

[编辑]

评论者 Ilya 在下面询问我不喜欢 GetProcAddress 解决方案的哪些方面。我不喜欢它有两个原因：

1.  它使代码更复杂。将调用函数的一行代码替换为三行代码，一行定义函数签名，一行调用GetProcAddress，另一行实际调用函数。
2.  它更容易出现运行时错误。如果我拼错了函数名称或弄乱了签名，我直到运行时才看到错误。假设我决定集成新版本的 dll 并且其中一个方法名称已更改，它将编译得很好，并且在实际调用 GetProcAddress 之前不会出现问题，这甚至可能在测试通过时被遗漏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-12T23:14:04.713

过去，您可以使用链接器 .def 文件“重命名”导入的符号。您可能仍然可以，但是自从 .def 文件被广泛使用以来已经很长时间了，很难找到文档。

当前的 MSDN 文档将 IMPORTS 指令列为“保留关键字”。我不确定这是否意味着他们删除了该功能，或者他们只是不想再支持它。

这是描述 IMPORTS 指令的页面：

[http://www.digitalmars.com/ctg/ctgDefFiles.html#imports](http://www.digitalmars.com/ctg/ctgDefFiles.html#imports)

其他笨拙的替代品是：

1.  为冲突的 API 创建包装函数。这些功能可以`LoadLibrary()/GetProcAddress()`跳舞。所有其他不冲突的函数都可以像往常一样隐式链接。实际上，这个解决方案可能是这个答案中 3 个中最不笨拙的一个。

2.  创建 2 个包装 DLL，以便每个 DLL 仅链接到名称冲突的一个或另一个库。在包装 DLL 中使用不同的名称，这些名称只是简单地转移到真实的库中。请注意，包装库不需要包装所有 API - 它们只需要包装冲突的 API。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-12T23:26:37.963

您可以构建新的导入库文件，重命名相关函数，然后使用这些新的导入库隐式链接两个 DLL 模块。这是描述该过程的 Microsoft 知识库文章：[如何在没有 .OBJ 或 Source 的情况下创建 32 位导入库](http://support.microsoft.com/kb/131313)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-13T00:39:59.000

在我对此事进行了更多思考之后，我设法得出了迈克 B 的笨拙替代方案＃2（或者如果您计算原始建议，则为＃3）。

*对于我的具体情况*，这是三者中我最喜欢的，因为它似乎需要最少的工作量，并且对于新看代码的人来说可能是最容易破译的。我相信我可以按照以下步骤启动并运行：

1.  使用一些正则表达式魔术并查找/替换将带有函数调用的头文件转换为包装头文件和包装器实现文件。（包装器 dll 中的每个方法都通过名称中的一些常见新元素来区分，从而节省了我解决冲突的时间）因此 FunctionCall() 在每个相应的包装器 dll 中变为 WrapperOneFunctionCall() 和 WrapperTwoFunctionCall()。
2.  将包装器 dll 链接到其相应的基本 dll。
3.  将我的可执行文件链接到包装 dll，删除指向基本 dll 的链接，但仍包括不需要从基本 dll 解析的常量、枚举和结构定义（因为我的包装函数仍然采用相同的参数类型）

如果有人仍在阅读此线程，我的后续问题将是：“此解决方案有什么问题吗？”

感谢响应者的帮助。

# sql - 如何更改 PostgreSQL 数据库表中列的位置？

> ID：285733
> 
> 赞同：157
> 
> 时间：2008-11-12T23:05:34.153
> 
> 标签：sql, database, postgresql, alter-table

我尝试了以下方法，但没有成功：

```
ALTER TABLE person ALTER COLUMN dob POSITION 37; 
```

* * *

## 回答 #1

> 赞同：149
> 
> 时间：2008-11-12T23:08:27.017

PostgreSQL Wiki 中的“[更改列位置”说：](http://wiki.postgresql.org/wiki/Alter_column_position)

> PostgreSQL 目前根据表的`attnum`列定义列顺序`pg_attribute`。更改列顺序的唯一方法是重新创建表，或者添加列并旋转数据，直到达到所需的布局。

这很弱，但在他们的辩护中，在标准 SQL 中，也没有重新定位列的解决方案。支持更改列序号位置的数据库品牌正在定义 SQL 语法的扩展。

我想到了另一个想法：您可以定义 a`VIEW`来指定您喜欢的列顺序，而无需更改列在基表中的物理位置。

* * *

## 回答 #2

> 赞同：98
> 
> 时间：2016-09-29T22:44:49.340

在 PostgreSQL 中，当添加一个字段时，它会被添加到表的末尾。如果我们需要插入特定位置，那么

```
 alter table tablename rename to oldtable;
    create table tablename (column defs go here); ### with all the constraints
    insert into tablename (col1, col2, col3) select col1, col2, col3 from oldtable; 
```

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2014-01-09T19:01:55.997

这篇文章很旧并且可能已解决，但我遇到了同样的问题。我通过创建指定新列顺序的原始表的视图来解决它。

从这里我可以使用视图或从视图创建一个新表。

```
    创建视图 original_tab_vw AS
    选择 a.col1、a.col3、a.col4、a.col2
    FROM original_tab 一个
    WHERE a.col1 IS NOT NULL -- 或其他

```

```
    从 original_tab_vw 中选择 * INTO new_table

```

重命名或删除原始表并将新表的名称设置为旧表。

* * *

## 回答 #4

> 赞同：26
> 
> 时间：2015-12-22T08:56:36.797

一个，尽管当必须绝对更改列顺序并且使用外键时重新排列列的笨拙选项是首先转储整个数据库的数据，然后只转储模式（`pg_dump -s databasename > databasename_schema.sql`）。接下来编辑模式文件以根据需要重新排列列，然后从模式重新创建数据库，最后将数据恢复到新创建的数据库中。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2008-11-12T23:09:42.333

我认为您目前不能：请参阅[Postgresql wiki 上的这篇文章](http://wiki.postgresql.org/wiki/Alter_column_position)。

本文中的三个解决方法是：

1.  重新创建表
2.  添加列和移动数据
3.  用视图隐藏差异。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2015-01-11T10:56:29.483

在 PGAdmin 中打开表并在底部的 SQL 窗格中复制 SQL Create Table 语句。然后打开查询工具并粘贴。如果表有数据，将表名改为'new_name'，如果没有，删除Drop Table行中的注释“--”。根据需要编辑列顺序。请注意最后一列中缺少/多余的逗号，以防您移动了它。执行新的 SQL 创建表命令。刷新和...瞧。

对于设计阶段的空表，这种方法非常实用。

如果表有数据，我们也需要重新排列数据的列顺序。这很简单：使用`INSERT`以下命令将旧表导入新版本：

```
INSERT INTO new ( c2, c3, c1 ) SELECT * from old; 
```

... 其中`c2`, `c3`,`c1`是旧表的列`c1`, `c2`,`c3`处于新位置。请注意，在这种情况下，您必须为已编辑的“旧”表**使用“新”名称，否则****您将丢失数据**。如果列名很多、长和/或复杂，请使用与上述相同的方法将新表结构复制到文本编辑器中，并在将新列列表复制到`INSERT`语句之前在那里创建新列列表。

检查一切正常后，`DROP`使用旧表并将“新”名称更改为“旧” `ALTER TABLE new RENAME TO old;`，您就完成了。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2020-05-20T23:09:34.897

我正在对很多表进行重新排序，并且不想一遍又一遍地编写相同的查询，所以我编写了一个脚本来为我完成这一切。本质上，它：

1.  获取建表SQL`pg_dump`
2.  从转储中获取所有可用列
3.  将列按所需顺序放置
4.  修改原始`pg_dump`查询以创建包含数据的重新排序表
5.  丢弃旧表
6.  重命名新表以匹配旧表

可以通过运行以下简单命令来使用它：

```
./reorder.py -n schema -d database table \
    first_col second_col ... penultimate_col ultimate_col --migrate 
```

它打印出 sql，以便您可以验证和测试它，这是我基于它的一个重要原因`pg_dump`。你可以在[这里找到 github repo](https://github.com/TriangleCommunications/reorder-table-columns)。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-08-16T06:10:57.053

我使用 Django，如果您不想头疼，它需要每个表中的 id 列。不幸的是，我很粗心，我的表 bp.geo_location_vague 没有包含这个字段。我初始化了小技巧。第1步：

```
CREATE VIEW bp.geo_location_vague_vw AS
    SELECT 
        a.id, -- I change order of id column here. 
        a.in_date,
        etc
    FROM bp.geo_location_vague a 
```

第 2 步：（不创建表 - 表将自动创建！）

```
SELECT * into bp.geo_location_vague_cp2 FROM bp.geo_location_vague_vw 
```

第 3 步：

```
CREATE SEQUENCE bp.tbl_tbl_id_seq;
ALTER TABLE bp.geo_location_vague_cp2 ALTER COLUMN id SET DEFAULT nextval('tbl_tbl_id_seq');
ALTER SEQUENCE bp.tbl_tbl_id_seq OWNED BY bp.geo_location_vague_cp2.id;
SELECT setval('tbl_tbl_id_seq', COALESCE(max(id), 0)) FROM bp.geo_location_vague_cp2; 
```

因为我需要在表中有 bigserial 伪类型。在 SELECT * into pg 之后会创建 bigint 类型的 insetad bigserial。

第 4 步：现在我们可以删除视图、删除源表并以旧名称重命名新表。戏法顺利结束。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-02-18T09:34:07.040

有一些解决方法可以使其成为可能：

1.  重新创建整个表

2.  在当前表中创建新列

3.  创建视图

[https://tableplus.com/blog/2018/09/postgresql-is-it-possible-to-alter-column-order-position-in-a-table.html](https://tableplus.com/blog/2018/09/postgresql-is-it-possible-to-alter-column-order-position-in-a-table.html)

# java - Java：使用泛型实现对不同类型数字进行操作的类

> ID：285754
> 
> 赞同：3
> 
> 时间：2008-11-12T23:12:36.260
> 
> 标签：java, generics

所以，假设我想编写一个对不同类型的数字进行操作的类，但我不知道我将在哪些类型的数字（即整数、双精度数等）上进行操作。

我想使用泛型为这种情况创建一个通用类。就像是：

```
 Adder<Double> adder = new Adder<Double>();
 adder.add(10.0d, 10.0d);   // = 20.0d 
```

但是，我无法实例化传递给 Adder 类的泛型类型！那么该怎么办？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-12T23:18:28.697

哦哦——泛型不是 C++ 模板。由于类型擦除，`Double`您的示例中的 甚至不会显示给运行时系统。

在您的特定情况下，如果您只想能够将各种类型添加在一起，我可以建议方法重载吗？例如, `double add(double, double)`, `float add(float, fload)`,`BigDecimal add(BigDecimal, BigDecimal)`等。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-12T23:30:54.443

我*认为*你可以做你想做的事，但我不确定，鉴于你提供的信息。听起来好像您想要以下内容的一些变体：

```
public class Foob<T extends Number> {

    public T doSomething(T t1, T t2) {
        return null;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-13T00:27:46.280

如果您不知道您将操作哪种类型的数字，那么您可能不会使用自己的实例变量。在这种情况下，您可以编写静态方法，而无需实例化您的类。

如果您确实需要自己的中间变量，那么您可能需要为您正在使用的每一类用户变量以不同的方式定义它们。例如，如果有人试图使用您的类对**BigDecimal**变量进行操作，您可能不会将**int**变量用于中间结果。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-13T00:29:02.017

我不确定泛型是你想要的。java中的泛型用于强制**编译时**约束，而不是运行时多态性。我认为你真正想要的是使用重载。使用泛型，你会得到类似的东西：

```
interface Adder<T> {
   T add(T arg1, arg3);
} 
```

和一堆：

```
class DoubleAdder implements Adder<Double> {
   Double add(Double arg1, Double arg2) {
      return arg1.add(arg2);
   }
} 
```

然后是一堆：

```
if (arg1 instanceof Double) {
   Adder<Double> adder = new DoubleAdder();
} 
```

使用泛型不会为您节省任何费用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-13T17:31:26.380

我同意拉普利的观点。重载对你有帮助。使用泛型最接近的是这样的：

公共类 NumericOps
{
  public T add(T n1, T n2) {
    //n1.add(n2);
    //这是不可能的，因为 Number 没有 add 方法，因此
    //你必须确定 n1 的类型。
    //我们无法确定 U 的类型，因为它在运行时不存在
    //由于类型擦除
    if(n1 instanceof Integer) {
      //添加整数...
    }
    else if(n1 instanceof Double) {
      //添加双打
    }
    返回空值；
  }
}

但这并没有太大帮助，因为使用泛型没有任何好处。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-08-11T16:57:51.580

如果您可以忍受将所有内容转换为双精度进行计算，则可以使用多态性

```
Number someNumberFunction(Number n1, Number n2) 
{
  double
      d1 = n1.doubleValue(),
      d2 = n2.doubleValue();

  /* perform computations on d1 & d2 */
} 
```

不幸的是，这不适用于 BigInteger 或 BigDecimal

# c# - 如何在 .NET 中生成进程并捕获其 STDOUT？

> ID：285760
> 
> 赞同：163
> 
> 时间：2008-11-12T23:14:39.767
> 
> 标签：c#, .net, process, spawning

我需要生成一个作为控制台应用程序的子进程，并捕获其输出。

我为方法编写了以下代码：

```
string retMessage = String.Empty;
ProcessStartInfo startInfo = new ProcessStartInfo();
Process p = new Process();

startInfo.CreateNoWindow = true;
startInfo.RedirectStandardOutput = true;
startInfo.RedirectStandardInput = true;

startInfo.UseShellExecute = false;
startInfo.Arguments = command;
startInfo.FileName = exec;

p.StartInfo = startInfo;
p.Start();

p.OutputDataReceived += new DataReceivedEventHandler
(
    delegate(object sender, DataReceivedEventArgs e)
    {
        using (StreamReader output = p.StandardOutput)
        {
            retMessage = output.ReadToEnd();
        }
    }
);

p.WaitForExit();

return retMessage; 
```

但是，这不会返回任何内容。我不相信`OutputDataReceived`事件被回调，或者`WaitForExit()`命令可能阻塞线程，所以它永远不会回调。

有什么建议吗？

**编辑：**看起来我对回调太努力了。正在做：

```
return p.StandardOutput.ReadToEnd(); 
```

似乎工作正常。

* * *

## 回答 #1

> 赞同：178
> 
> 时间：2008-11-12T23:40:46.017

这是我已经验证可以工作的代码。我用它来生成 MSBuild 并监听它的输出：

```
process.StartInfo.UseShellExecute = false;
process.StartInfo.RedirectStandardOutput = true;
process.OutputDataReceived += (sender, args) => Console.WriteLine("received output: {0}", args.Data);
process.Start();
process.BeginOutputReadLine(); 
```

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2012-03-16T01:03:45.390

我刚刚尝试了这件事，以下对我有用：

```
StringBuilder outputBuilder;
ProcessStartInfo processStartInfo;
Process process;

outputBuilder = new StringBuilder();

processStartInfo = new ProcessStartInfo();
processStartInfo.CreateNoWindow = true;
processStartInfo.RedirectStandardOutput = true;
processStartInfo.RedirectStandardInput = true;
processStartInfo.UseShellExecute = false;
processStartInfo.Arguments = "<insert command line arguments here>";
processStartInfo.FileName = "<insert tool path here>";

process = new Process();
process.StartInfo = processStartInfo;
// enable raising events because Process does not raise events by default
process.EnableRaisingEvents = true;
// attach the event handler for OutputDataReceived before starting the process
process.OutputDataReceived += new DataReceivedEventHandler
(
    delegate(object sender, DataReceivedEventArgs e)
    {
        // append the new data to the data already read-in
        outputBuilder.Append(e.Data);
    }
);
// start the process
// then begin asynchronously reading the output
// then wait for the process to exit
// then cancel asynchronously reading the output
process.Start();
process.BeginOutputReadLine();
process.WaitForExit();
process.CancelOutputRead();

// use the output
string output = outputBuilder.ToString(); 
```

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2013-08-30T09:46:09.900

这是一些完整而简单的代码来执行此操作。当我使用它时，它工作得很好。

```
var processStartInfo = new ProcessStartInfo
{
    FileName = @"C:\SomeProgram",
    Arguments = "Arguments",
    RedirectStandardOutput = true,
    UseShellExecute = false
};
var process = Process.Start(processStartInfo);
var output = process.StandardOutput.ReadToEnd();
process.WaitForExit(); 
```

请注意，这仅捕获标准*输出*；它不捕获标准*错误*。如果两者都需要，请对每个流使用[此技术](https://stackoverflow.com/a/285841/238753)。

* * *

## 回答 #4

> 赞同：27
> 
> 时间：2015-07-29T14:09:13.710

我需要同时捕获 stdout 和 stderr 并在进程未按预期退出时让它超时。我想出了这个：

```
Process process = new Process();
StringBuilder outputStringBuilder = new StringBuilder();

try
{
process.StartInfo.FileName = exeFileName;
process.StartInfo.WorkingDirectory = args.ExeDirectory;
process.StartInfo.Arguments = args;
process.StartInfo.RedirectStandardError = true;
process.StartInfo.RedirectStandardOutput = true;
process.StartInfo.WindowStyle = ProcessWindowStyle.Hidden;
process.StartInfo.CreateNoWindow = true;
process.StartInfo.UseShellExecute = false;
process.EnableRaisingEvents = false;
process.OutputDataReceived += (sender, eventArgs) => outputStringBuilder.AppendLine(eventArgs.Data);
process.ErrorDataReceived += (sender, eventArgs) => outputStringBuilder.AppendLine(eventArgs.Data);
process.Start();
process.BeginOutputReadLine();
process.BeginErrorReadLine();
var processExited = process.WaitForExit(PROCESS_TIMEOUT);

if (processExited == false) // we timed out...
{
    process.Kill();
    throw new Exception("ERROR: Process took too long to finish");
}
else if (process.ExitCode != 0)
{
    var output = outputStringBuilder.ToString();
    var prefixMessage = "";

    throw new Exception("Process exited with non-zero exit code of: " + process.ExitCode + Environment.NewLine + 
    "Output from process: " + outputStringBuilder.ToString());
}
}
finally
{                
process.Close();
} 
```

我将 stdout 和 stderr 管道传输到同一个字符串中，但如果需要，您可以将其分开。它使用事件，所以它应该在它们到来时处理它们（我相信）。我已经成功运行了它，很快就会对其进行批量测试。

* * *

## 回答 #5

> 赞同：21
> 
> 时间：2008-11-13T00:34:06.190

看起来你的两条线有问题。在设置事件处理程序以捕获输出之前启动该过程。在添加事件处理程序之前，该过程可能刚刚完成。

像这样换行。

```
p.OutputDataReceived += ...
p.Start(); 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-11-12T23:23:27.063

设置 StartInfo 后，您需要调用 p.Start() 来实际运行该过程。实际上，您的函数可能挂在 WaitForExit() 调用上，因为该过程实际上从未启动过。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2014-01-31T14:29:45.893

重定向流是异步的，并且可能会在进程终止后继续。Umar 提到在进程终止后取消`process.CancelOutputRead()`。但是，这具有数据丢失的可能性。

这对我来说很可靠：

```
process.WaitForExit(...);
...
while (process.StandardOutput.EndOfStream == false)
{
    Thread.Sleep(100);
} 
```

我没有尝试这种方法，但我喜欢 Sly 的建议：

```
if (process.WaitForExit(timeout))
{
    process.WaitForExit();
} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2015-11-09T13:24:32.790

来自犹大的答案对我不起作用（或不完整），因为应用程序在第一次之后退出`BeginOutputReadLine();`

这对我来说是一个完整的片段，读取 ping 的恒定输出：

```
 var process = new Process();
        process.StartInfo.FileName = "ping";
        process.StartInfo.Arguments = "google.com -t";
        process.StartInfo.RedirectStandardOutput = true;
        process.StartInfo.UseShellExecute = false;
        process.OutputDataReceived += (sender, a) => Console.WriteLine(a.Data);
        process.Start();
        process.BeginOutputReadLine();
        process.WaitForExit(); 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2013-02-18T08:35:13.070

这是我用来运行进程并获取其输出和错误的方法：

```
public static string ShellExecute(this string path, string command, TextWriter writer, params string[] arguments)
    {
        using (var process = Process.Start(new ProcessStartInfo { WorkingDirectory = path, FileName = command, Arguments = string.Join(" ", arguments), UseShellExecute = false, RedirectStandardOutput = true, RedirectStandardError = true }))
        {
            using (process.StandardOutput)
            {
                writer.WriteLine(process.StandardOutput.ReadToEnd());
            }
            using (process.StandardError)
            {
                writer.WriteLine(process.StandardError.ReadToEnd());
            }
        }

        return path;
    } 
```

例如 ：

```
@"E:\Temp\MyWorkingDirectory".ShellExecute(@"C:\Program Files\Microsoft SDKs\Windows\v6.0A\Bin\svcutil.exe", Console.Out); 
```

# php - 如何在 PHP 中检查字符串在 UTF8 中是否只有国际字母和空格？

> ID：285763
> 
> 赞同：3
> 
> 时间：2008-11-12T23:15:57.937
> 
> 标签：php, utf-8, utf

在 Python 中，我可以将其转换为 Unicode 并执行 '(?u)^[\w ]+$' 正则表达式搜索，但 PHP 似乎不理解国际 \w，或者是吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-12T23:28:30.610

虽然我没有测试过自己，但查看[http://us3.php.net/manual/en/reference.pcre.pattern.syntax.php](http://us3.php.net/manual/en/reference.pcre.pattern.syntax.php)建议以下内容：'/^[\p{L}]+$/ u' 会起作用 - \p{L} 将匹配任何 unicode 字母。此外，您显然可以在没有大括号的情况下编写此代码 - '/^[\pL ]+$/u'。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-12T23:29:17.927

afaik PHP 不知道 utf8，这意味着 php 本身将无法按字节处理它。

PHP 相信一切都是 latin1，但是有一些扩展可能对你有用，比如 mbstring。

[http://se.php.net/mbstring](http://se.php.net/mbstring)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-12T23:34:42.020

使 UNICODE 在代码库中的任何地方都能正常工作是 PHP6 的“大”特性之一。

在此之前，建议您**不要**在 php 中使用 UNICODE，因为它可能会引发许多安全问题。

很多代码都不是 UNICODE 感知的，因此不安全，漏洞利用可以以非常不愉快的方式通过它。

# .net - 使用 MSBuild 发布 Web 服务

> ID：285769
> 
> 赞同：0
> 
> 时间：2008-11-12T23:17:19.683
> 
> 标签：.net, web-services, msbuild

如何使用 MSBuild 将 Web 服务发布到服务器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-12T23:41:01.943

看看[Web 部署项目](http://www.microsoft.com/downloads/details.aspx?familyId=0AA30AE8-C73B-4BDD-BB1B-FE697256C459&displaylang=en)。它基本上是一个 msbuild 文件，它使执行部署步骤变得很麻烦。我将它与[MSBuild 社区任务](http://msbuildtasks.tigris.org/)结合使用，这些任务具有用于压缩文件的 msbuild 任务、从 subversion 存储库分配程序集版本号和其他常用操作。

另外，微软的[MSDeploy](http://blogs.iis.net/msdeploy/archive/2008/01/22/welcome-to-the-web-deployment-team-blog.aspx)工具支持​​命令行部署和IIS配置等，很容易插入部署项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-12T23:25:31.350

发布 ASP.NET 应用程序的方式不一样吗？

# sql - 如何处理看起来像 SQL 关键字的 SQL 列名？

> ID：285775
> 
> 赞同：273
> 
> 时间：2008-11-12T23:18:47.010
> 
> 标签：sql, sql-server

我的专栏之一叫做`from`. 我不能改名字，因为我没有成功。我是否可以做类似的事情，`SELECT from FROM TableName`或者是否有特殊的语法来避免 SQL Server 被混淆？

* * *

## 回答 #1

> 赞同：410
> 
> 时间：2008-11-12T23:19:52.000

像这样将列名括在括号中，`from`变成 [from]。

```
select [from] from table; 
```

也可以使用以下内容（在查询多个表时很有用）：

```
select table.[from] from table; 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2008-11-15T20:21:54.333

如果它在 PostgreSQL 中，请在名称周围使用双引号，例如：

```
select "from" from "table"; 
```

注意：内部 PostgreSQL 自动将所有未加引号的命令和参数转换为小写。这具有命令和标识符不区分大小写的效果。**从表中选择 *；**被解释为**select * from table；**. 但是，双引号内的参数按原样使用，因此区分大小写：**select * from "table";** 并**从“表”中选择 *；**从两个不同的表中获取结果。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2008-11-12T23:25:15.860

当您这样做时 - 将其别名为其他东西（或者更好的是，使用视图或 SP 并弃用旧的直接访问方法）。

```
SELECT [from] AS TransferFrom -- Or something else more suitable
FROM TableName 
```

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2015-04-03T23:56:34.307

这是两种方法：

1.  在这里使用反引号：

> 从表名中选择“来自”

2.  您可以将表名提及为：

> `SELECT TableName.from FROM TableName`

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2008-11-13T00:21:26.620

您的问题似乎在这里得到了很好的回答，但我只想对此主题再添加一条评论。

那些设计数据库的人应该很清楚保留关键字并避免使用它们。如果您发现有人使用它，请告知他们（以礼貌的方式）。这里的关键字是*保留*字。

更多信息：

> “保留关键字不应用作对象名称。从早期版本的 SQL Server 升级的数据库可能包含标识符，其中包含早期版本中未保留的字词，但这些字词是当前版本 SQL Server 的保留字词。您可以参考对象通过使用分隔标识符，直到名称可以更改。” [http://msdn.microsoft.com/en-us/library/ms176027.aspx](http://msdn.microsoft.com/en-us/library/ms176027.aspx)

和

> “如果您的数据库确实包含与保留关键字匹配的名称，则在引用这些对象时必须使用分隔标识符。有关更多信息，请参阅标识符 (DMX)。” [http://msdn.microsoft.com/en-us/library/ms132178.aspx](http://msdn.microsoft.com/en-us/library/ms132178.aspx)

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2016-04-01T10:40:39.010

在 Apache Drill 中，使用反引号：

```
select `from` from table; 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2008-11-12T23:21:48.223

如果您使用的是 SQL Server，则只需将方括号括在列或表名周围即可。

```
select [select]
from [table] 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2013-11-10T15:39:50.273

我也遇到过这个问题。解决方案是将 [Column_Name] 像这样放在查询中。

```
string query= "Select [Name],[Email] from Person"; 
```

所以它会很好地工作。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2012-09-09T15:13:34.457

嗨，我在完全符合 ANSI 的 Teradata 系统上工作。使用双引号“”来命名这些列。

eg`type`是 SQL 保留关键字，当在引号中使用时，`type`被视为用户指定的名称。

请参见下面的代码示例：

```
CREATE TABLE alpha1
AS
(
SEL
product1
type_of_product AS "type"
FROM beta1
) WITH DATA
PRIMARY INDEX (product1)

--type is a SQL reserved keyword

TYPE

--see? now to retrieve the column you would use:

SEL "type" FROM alpha1 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2012-09-10T15:04:49.260

尝试**更新**名称为**关键字**的列时，我遇到了同样的问题。上面的解决方案对我没有帮助。我通过简单地指定表的名称来解决它，如下所示：

```
UPDATE `survey`
SET survey.values='yes,no'
WHERE (question='Did you agree?') 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2014-07-02T13:13:56.737

以下将完美运行：

```
SELECT DISTINCT table.from AS a FROM table 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2012-01-15T16:20:15.243

您可以将列名放在括号中，例如：

```
Select  [from] from < ur_tablename> 
```

或者

放入临时表，然后随意使用。
例子：

```
Declare @temp_table table(temp_from varchar(max))

Insert into @temp_table
Select * from your_tablename 
```

这里我只是假设 your_tablename 只包含一列（即来自）。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2017-05-24T15:12:26.507

在 MySQL 中，除了使用反引号 (`) 之外，您还可以使用 UI 来更改列名。右键单击表 > 更改表 > 编辑包含 sql 关键字的列名 > 提交。

```
select [from] from <table> 
```

注意，以上在 MySQL 中不起作用

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2018-02-08T20:31:01.470

从这里的答案和我自己的经验来看。唯一可以接受的答案是，如果您打算移植，请不要对表、列或其他名称使用 SQL 关键字。

所有这些答案都适用于各种数据库，但显然很多不支持 ANSI 解决方案。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-08-24T18:59:42.563

在 Oracle SQL Developer pl/sql 中，您可以使用双引号来执行此操作，但如果使用双引号，则必须以大写形式键入列名。例如，从 MY_TABLE 中选择“FROM”

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2022-02-18T17:23:29.490

简单的解决方案

假设列名**来自**; 所以查询中的列名可以通过表别名来引用

```
Select * from user u where u.from="US" 
```

# git - Git 推荐的工作流程

> ID：285782
> 
> 赞同：3
> 
> 时间：2008-11-12T23:21:46.240
> 
> 标签：git

在一个自己开发的项目中，我已经使用 git 几个月了。我有一个本地存储库，并定期将其推送到 github 以进行备份。

我想为这个项目添加另一个开发人员，但是我将负责整合整个项目。

推荐的工作流程是什么？

我们是否需要为每个开发人员提供一个私有和公共存储库？

如果 github 存储库是主要存储库，其他开发人员是否必须克隆此存储库或我计算机中的存储库？

他应该有权推入我的存储库还是我应该从他的存储库中提取？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-12T23:24:47.593

Git 倾向于*拉*，而不是推。理想情况下，其他开发人员会从您在 Github 上的*公共存储库中克隆；*然后，当他完成更改后，您可以从他提供给您的 repo 中提取，或者将他的更改与他通过电子邮件发送给您的补丁集成。无论哪种方式，您都可以将更改拉入*您计算机上的**私人*仓库，修复合并导致的任何错误，然后将他的更改推送到您的公共仓库（Github 上的那个）。

 *当然，让他提交访问您的 Github 存储库也没有错。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-12T23:28:48.707

他可以为您的 github 存储库创建自己的分支，当他觉得自己准备好集成时，他可以向您发送拉取请求（您可以将他的 repos 公共 URL 作为远程地址），或者他可以向您发送`git format-patch`集合。

通常在这种工作流程中，他的责任主要在于确保他的补丁干净地适用于您的公共主人。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-13T22:04:37.403

一个忠告......确保你们都清楚哪些 git 操作将重写历史。重置分支指针、变基、追加提交等将重写历史记录，这没关系，但仅适用于私有分支。对于您正在共享的分支（推入或拉出），您应该避免重写历史记录。

这是一篇关于[使用 Git 打包软件](http://www.golden-gryphon.com/software/misc/packaging.html)的文章，很好读。它面向进行大规模集成（如构建 linux 发行版）的人，但原则通常适用。

# c - c中令人讨厌的select（）行为

> ID：285790
> 
> 赞同：5
> 
> 时间：2008-11-12T23:24:44.817
> 
> 标签：c, sockets, select, timeout

```
while (xxx) {
    timeout.tv_sec=TIMEOUT;
    timeout.tv_usec=0;
    FD_ZERO(&set); 
    FD_SET(sd,&set);

    switch (select(FD_SETSIZE,&set,NULL,NULL,&timeout))
    xxxxx
} 
```

工作正常，但是

```
FD_ZERO(&set); 
FD_SET(sd,&set);

while (xxx) {
    timeout.tv_sec=TIMEOUT;
    timeout.tv_usec=0;

    switch (select(FD_SETSIZE,&set,NULL,NULL,&timeout))
    xxxxx
} 
```

没有。它第一次工作，但下一次运行 while 循环时，即使 sd 套接字接收到数据，它也会超时。在我看来，每次都必须清空和填充集是浪费资源。

任何人都有一个很好的解释为什么会这样，甚至更好，也许是一个如何避免它的建议？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-13T04:03:04.067

select 修改它的参数。您确实必须每次都重新初始化它。

如果您担心开销，在内核中处理完整 FD_SET 的成本比 FD_ZERO 的成本要高一些。您只想传递最大 fd，而不是 FD_SETSZIZE，以最小化内核处理。在您的示例中：

```
switch (select((sd + 1),&set,NULL,NULL,&timeout)) 
```

对于具有多个 fd 的更复杂的情况，您通常最终会维护一个 max 变量：

```
FD_SET(sd,&set);
if (sd > max) max = sd;
... repeat many times...

switch (select((max + 1),&set,NULL,NULL,&timeout)) 
```

如果您将拥有大量文件描述符并且担心使用它们的开销，那么您应该查看一些 select() 的替代方法。您没有提及您正在使用的操作系统，但对于类 Unix 操作系统，有一些：

*   对于 Linux，epoll()
*   对于 FreeBSD/NetBSD/OpenBSD/MacOS X，kqueue()
*   对于 Solaris，/dev/poll

API 是不同的，但它们本质上都是一个有状态的内核接口，用于维护一组活动文件描述。一旦将 fd 添加到集合中，您将收到有关该 fd 上的事件的通知，而无需再次继续传递它。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-12T23:28:22.220

阅读选择手册页。返回的集合只是准备好使用的文件描述符。您应该使用 FD_ISSET 检查每一个是否已设置。

始终在使用 fd_set 之前对其进行初始化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-12T23:29:49.687

这就是选择的工作方式。如果您有多个插槽，它的效果最好，并且更有意义。这就是重点：您在许多套接字中进行选择。如果您想从一个套接字读取，只需读取或接收它。

# java - 什么是 serialVersionUID，我为什么要使用它？

> ID：285793
> 
> 赞同：3266
> 
> 时间：2008-11-12T23:24:56.797
> 
> 标签：java, serialization, serialversionuid

`serialVersionUID`缺少 a 时 Eclipse 会发出警告。

> 可序列化类 Foo 未声明 long 类型的静态最终 serialVersionUID 字段

什么是`serialVersionUID`它以及为什么它很重要？请展示一个缺少`serialVersionUID`会导致问题的示例。

* * *

## 回答 #1

> 赞同：2476
> 
> 时间：2008-11-12T23:30:15.710

的文档[`java.io.Serializable`](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/io/Serializable.html)可能与您得到的解释一样好：

> 序列化运行时将版本号与每个可序列化类相关联，称为 a `serialVersionUID`，在反序列化期间使用该版本号来验证序列化对象的发送方和接收方是否已为该对象加载了与序列化兼容的类。如果接收者为对象加载了一个`serialVersionUID`与相应发送者的类不同的类，则反序列化将导致 [`InvalidClassException`](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/io/InvalidClassException.html). 可序列化的类可以通过声明一个必须是 static、final 和 type`serialVersionUID`的字段来显式声明自己的：`serialVersionUID``long`

> ```
> ANY-ACCESS-MODIFIER static final long serialVersionUID = 42L; 
> ```

> 如果可序列化类没有显式声明 a `serialVersionUID`，则序列化运行时将根据`serialVersionUID`类的各个方面为该类计算默认值，如 Java(TM) 对象序列化规范中所述。但是，*强烈建议*所有可序列化类显式声明`serialVersionUID`值，因为默认`serialVersionUID`计算对类细节高度敏感，这些细节可能因编译器实现而异，因此可能会`InvalidClassExceptions`在反序列化期间导致意外。因此，为了保证`serialVersionUID`不同 java 编译器实现的值一致，可序列化类必须声明一个显式`serialVersionUID`值。还强烈建议明确`serialVersionUID`声明尽可能使用 private 修饰符，因为此类声明仅适用于立即声明的类——`serialVersionUID`字段作为继承成员没有用。

* * *

## 回答 #2

> 赞同：501
> 
> 时间：2008-11-13T04:24:57.923

如果您只是因为为了实现而必须序列化而进行序列化（谁在乎您是否为`HTTPSession`.`de-serializing`忽略这个。

如果您实际上正在使用序列化，那么只有当您计划直接使用序列化存储和检索对象时才重要。代表您的`serialVersionUID`课程版本，如果您的课程的当前版本与其以前的版本不向后兼容，您应该增加它。

大多数时候，您可能不会直接使用序列化。如果是这种情况，请通过单击快速修复选项生成默认值`SerialVersionUID`，不要担心。

* * *

## 回答 #3

> 赞同：338
> 
> 时间：2008-11-12T23:37:18.830

我不能错过这个插入 Josh Bloch 的书[Effective Java](https://rads.stackoverflow.com/amzn/click/com/0321356683) (2nd Edition) 的机会。第 10 章是 Java 序列化不可或缺的资源。

根据 Josh，自动生成的 UID 是根据类名、实现的接口以及所有公共和受保护成员生成的。以任何方式更改其中任何一项都会更改`serialVersionUID`. 因此，只有当您确定不会超过一个版本的类被序列化（跨进程或稍后从存储中检索）时，您才需要弄乱它们。

如果你暂时忽略它们，然后发现你需要以某种方式更改类但要保持与旧版本的类的兼容性，你可以使用 JDK 工具**serialver**`serialVersionUID`在*旧*类上生成，并显式设置在新课上。（根据您的更改，您可能还需要通过添加`writeObject`和`readObject`方法来实现自定义序列化 - 请参阅`Serializable`javadoc 或前面提到的第 10 章。）

* * *

## 回答 #4

> 赞同：142
> 
> 时间：2008-11-13T01:17:00.953

您可以告诉 Eclipse 忽略这些 serialVersionUID 警告：

> 窗口 > 首选项 > Java > 编译器 > 错误/警告 > 潜在的编程问题

如果您不知道，您可以在本节中启用许多其他警告（甚至将一些警告报告为错误），其中许多非常有用：

*   潜在的编程问题：可能的意外布尔赋值
*   潜在的编程问题：空指针访问
*   不必要的代码：从不读取局部变量
*   不必要的代码：冗余空检查
*   不必要的代码：不必要的强制转换或“instanceof”

还有很多。

* * *

## 回答 #5

> 赞同：122
> 
> 时间：2012-10-03T06:05:45.110

`serialVersionUID`便于序列化数据的版本控制。它的值在序列化时与数据一起存储。反序列化时，会检查相同的版本以查看序列化数据与当前代码的匹配情况。

如果要对数据进行版本化，通常从`serialVersionUID`0 开始，并随着类的每次结构更改而改变序列化数据（添加或删除非瞬态字段）。

内置的反序列化机制 ( `in.defaultReadObject()`) 将拒绝从旧版本的数据中反序列化。但是如果你愿意，你可以定义你自己的[readObject()](http://docs.oracle.com/javase/1.5.0/docs/guide/serialization/spec/input.html#2971)函数，它可以读回旧数据。然后，此自定义代码可以检查`serialVersionUID`以了解数据所在的版本并决定如何对其进行反序列化。如果您存储在多个版本的代码中存在的序列化数据，则此版本控制技术很有用。

但是将序列化数据存储这么长的时间跨度并不常见。使用序列化机制将数据临时写入缓存或通过网络将其发送到具有相同版本代码库相关部分的另一个程序更为常见。

在这种情况下，您对保持向后兼容性不感兴趣。您只关心确保正在通信的代码库确实具有相同版本的相关类。为了便于进行此类检查，您必须保持与`serialVersionUID`以前一样，并且在更改类时不要忘记对其进行更新。

如果您确实忘记更新该字段，您最终可能会得到一个具有不同结构但具有相同`serialVersionUID`. 如果发生这种情况，默认机制 ( `in.defaultReadObject()`) 将不会检测到任何差异，并尝试反序列化不兼容的数据。现在您可能会遇到一个神秘的运行时错误或静默失败（空字段）。这些类型的错误可能很难找到。

因此，为了帮助这个用例，Java 平台为您提供了不`serialVersionUID`手动设置的选择。相反，类结构的哈希将在编译时生成并用作 id。这种机制将确保您永远不会有具有相同 id 的不同类结构，因此您不会遇到上面提到的这些难以跟踪的运行时序列化故障。

但是自动生成的 id 策略有一个缺点。也就是说，为同一类生成的 id 可能在编译器之间有所不同（如上面 Jon Skeet 所述）。因此，如果您在使用不同编译器编译的代码之间传递序列化数据，建议还是手动维护 id。

如果您像提到的第一个用例那样向后兼容您的数据，您可能还想自己维护 id。这是为了获得可读的 id 并更好地控制它们何时以及如何更改。

* * *

## 回答 #6

> 赞同：79
> 
> 时间：2013-10-17T04:28:23.880

> 什么是**serialVersionUID**，我为什么要使用它？

`SerialVersionUID`是每个类的唯一标识符，`JVM`使用它来比较类的版本，确保在反序列化期间加载序列化期间使用的相同类。

指定一个可以提供更多控制，但如果您不指定，JVM 会生成一个。生成的值在不同的编译器之间可能不同。此外，有时您出于某种原因只想禁止对旧的序列化对象 [ `backward incompatibility`] 进行反序列化，在这种情况下，您只需更改 serialVersionUID。

**的[javadocs`Serializable`](https://docs.oracle.com/javase/7/docs/api/java/io/Serializable.html)说**：

> 默认的 serialVersionUID 计算对类细节高度敏感，这些细节可能因编译器实现而异，因此可能`InvalidClassException`在反序列化期间导致意外的 s。

**因此，您必须声明 serialVersionUID，因为它给了我们更多的控制权**。

[这篇文章](http://www.javapractices.com/topic/TopicAction.do?Id=45)有一些关于这个话题的好观点。

* * *

## 回答 #7

> 赞同：63
> 
> 时间：2013-04-07T10:43:27.890

最初的问题是询问“为什么它很重要”和“示例”，这`Serial Version ID`将是有用的。好吧，我找到了一个。

假设您创建了一个`Car`类，将其实例化，然后将其写入对象流。扁平化的汽车对象在文件系统中存在一段时间。同时，如果`Car`通过添加新字段来修改类。稍后，当您尝试读取（即反序列化）展平`Car`对象时，您会得到`java.io.InvalidClassException`- 因为所有可序列化的类都自动被赋予一个唯一标识符。当类的标识符不等于展平对象的标识符时，将引发此异常。如果你真的想一想，抛出异常是因为添加了新字段。您可以通过声明显式的 serialVersionUID 自行控制版本控制来避免引发此异常。显式声明您的`serialVersionUID`（因为不必计算）。因此，最佳实践是在您创建 Serializable 类后立即将您自己的 serialVersionUID 添加到您的 Serializable 类中，如下所示：

```
public class Car {
    static final long serialVersionUID = 1L; //assign a long value
} 
```

* * *

## 回答 #8

> 赞同：54
> 
> 时间：2018-01-22T04:27:40.490

首先我需要解释一下什么是序列化。

**序列化**允许将对象转换为流，以便通过网络发送该对象或保存到文件或保存到数据库中以供字母使用。

***序列化有一些规则***。

*   一个对象只有在其类或其超类实现了 Serializable 接口时才可序列化

*   一个对象是可序列化的（它本身实现了 Serializable 接口），即使它的超类不是。然而，可序列化类的层次结构中的第一个超类，没有实现可序列化接口，必须有一个无参数的构造函数。如果违反，readObject() 将在运行时产生 java.io.InvalidClassException

*   所有原始类型都是可序列化的。

*   瞬态字段（带有瞬态修饰符）未序列化（即未保存或恢复）。实现 Serializable 的类必须标记不支持序列化的类的瞬态字段（例如，文件流）。

*   静态字段（带有 static 修饰符）未序列化。

当`Object`被序列化时，Java 运行时关联序列版本号，即`serialVersionID`.

***我们需要serialVersionID的地方：***

在反序列化期间验证发送方和接收方在序列化方面是否兼容。如果接收器加载了不同的类，`serialVersionID`则反序列化将以`InvalidClassCastException`. 可序列化的类可以通过声明一个名为的字段来显式
声明自己，该字段必须是静态的、最终的和长类型的。`serialVersionUID``serialVersionUID`

让我们用一个例子来试试这个。

```
import java.io.Serializable;

public class Employee implements Serializable {
    private static final long serialVersionUID = 1L;
    private String empname;
    private byte empage;

    public String getEmpName() {
        return name;
    }

    public void setEmpName(String empname) {
        this.empname = empname;
    }

    public byte getEmpAge() {
        return empage;
    }

    public void setEmpAge(byte empage) {
        this.empage = empage;
    }

    public String whoIsThis() {
        return getEmpName() + " is " + getEmpAge() + "years old";
    }
} 
```

创建序列化对象

```
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.ObjectOutputStream;

public class Writer {
    public static void main(String[] args) throws IOException {
        Employee employee = new Employee();
        employee.setEmpName("Jagdish");
        employee.setEmpAge((byte) 30);

        FileOutputStream fout = new
                FileOutputStream("/users/Jagdish.vala/employee.obj");
        ObjectOutputStream oos = new ObjectOutputStream(fout);
        oos.writeObject(employee);
        oos.close();
        System.out.println("Process complete");
    }
} 
```

反序列化对象

```
import java.io.FileInputStream;
import java.io.IOException;
import java.io.ObjectInputStream;

public class Reader {
    public static void main(String[] args) throws ClassNotFoundException, IOException {
        Employee employee = new Employee();
        FileInputStream fin = new FileInputStream("/users/Jagdish.vala/employee.obj");
        ObjectInputStream ois = new ObjectInputStream(fin);
        employee = (Employee) ois.readObject();
        ois.close();
        System.out.println(employee.whoIsThis());
    }
} 
```

注意：现在更改 Employee 类的 serialVersionUID 并保存：

```
private static final long serialVersionUID = 4L; 
```

并执行 Reader 类。不执行 Writer 类，你会得到异常。

```
Exception in thread "main" java.io.InvalidClassException: 
com.jagdish.vala.java.serialVersion.Employee; local class incompatible: 
stream classdesc serialVersionUID = 1, local class serialVersionUID = 4
at java.io.ObjectStreamClass.initNonProxy(ObjectStreamClass.java:616)
at java.io.ObjectInputStream.readNonProxyDesc(ObjectInputStream.java:1623)
at java.io.ObjectInputStream.readClassDesc(ObjectInputStream.java:1518)
at java.io.ObjectInputStream.readOrdinaryObject(ObjectInputStream.java:1774)
at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1351)
at java.io.ObjectInputStream.readObject(ObjectInputStream.java:371)
at com.krishantha.sample.java.serialVersion.Reader.main(Reader.java:14) 
```

* * *

## 回答 #9

> 赞同：41
> 
> 时间：2008-11-12T23:30:30.233

如果您永远不需要将对象序列化为字节数组并发送/存储它们，那么您无需担心。如果这样做，那么您必须考虑您的 serialVersionUID，因为对象的反序列化器会将其与其类加载器所具有的对象版本相匹配。在 Java 语言规范中阅读有关它的更多信息。

* * *

## 回答 #10

> 赞同：35
> 
> 时间：2011-02-03T00:32:03.213

如果您在从未考虑过序列化的类上收到此警告，并且您没有声明自己`implements Serializable`，这通常是因为您从实现 Serializable 的超类继承。通常，委托给这样的对象而不是使用继承会更好。

所以，而不是

```
public class MyExample extends ArrayList<String> {

    public MyExample() {
        super();
    }
    ...
} 
```

做

```
public class MyExample {
    private List<String> myList;

    public MyExample() {
         this.myList = new ArrayList<String>();
    }
    ...
} 
```

并在相关方法中调用`myList.foo()`而不是`this.foo()`（或`super.foo()`）。（这并不适用于所有情况，但仍然很常见。）

我经常看到人们扩展 JFrame 之类的东西，而他们真的只需要委托这个。（这也有助于在 IDE 中自动完成，因为 JFrame 有数百种方法，当您想在类上调用自定义方法时不需要这些方法。）

警告（或serialVersionUID）不可避免的一种情况是当您从AbstractAction 扩展时，通常在匿名类中，只添加actionPerformed 方法。我认为在这种情况下不应该有警告（因为您通常不能可靠地序列化和反序列化此类匿名类，无论如何跨类的不同版本），但我不确定编译器如何识别这一点。

* * *

## 回答 #11

> 赞同：22
> 
> 时间：2013-06-02T06:20:31.203

要了解字段 serialVersionUID 的意义，应该了解序列化/反序列化的工作原理。

当 Serializable 类对象被序列化时，Java 运行时将序列版本号（称为 serialVersionUID）与该序列化对象相关联。在您反序列化此序列化对象时，Java Runtime 将序列化对象的 serialVersionUID 与类的 serialVersionUID 匹配。如果两者相等，则只有它继续进行进一步的反序列化过程，否则抛出 InvalidClassException。

因此我们得出结论，要使序列化/反序列化过程成功，序列化对象的serialVersionUID必须等于类的serialVersionUID。如果程序员在程序中明确指定 serialVersionUID 值，那么相同的值将与序列化对象和类相关联，而与序列化和反序列化平台无关（例如，序列化可能在 windows 等平台上使用 sun 或MS JVM 和反序列化可能在使用 Zing JVM 的不同平台 Linux 上）。

但是如果程序员没有指定serialVersionUID，那么在对任何对象进行序列化\反序列化时，Java运行时会使用自己的算法来计算它。这个serialVersionUID 计算算法因一个JRE 而异。也有可能对象被序列化的环境是使用一个 JRE（例如：SUN JVM），而反序列化的环境是使用 Linux Jvm(zing)。在这种情况下，与序列化对象关联的 serialVersionUID 将不同于在反序列化环境中计算的类的 serialVersionUID。反过来反序列化也不会成功。因此，为了避免这种情况/问题，程序员必须始终指定 Serializable 类的 serialVersionUID。

* * *

## 回答 #12

> 赞同：20
> 
> 时间：2013-05-20T19:32:37.583

至于缺少 serialVersionUID 可能导致问题的示例：

我正在开发这个由使用`EJB`模块的 Web 模块组成的 Java EE 应用程序。Web 模块`EJB`远程调用该模块并传递一个作为参数`POJO`实现的。`Serializable`

这个`POJO's`类被打包在 EJB jar 和它自己的 jar 在 web 模块的 WEB-INF/lib 中。它们实际上是同一个类，但是当我打包 EJB 模块时，我解压了这个 POJO 的 jar 以将它与 EJB 模块打包在一起。

调用`EJB`失败并出现下面的异常，因为我没有声明它`serialVersionUID`：

```
Caused by: java.io.IOException: Mismatched serialization UIDs : Source
 (Rep.
 IDRMI:com.hordine.pedra.softbudget.domain.Budget:5CF7CE11E6810A36:04A3FEBED5DA4588)
 = 04A3FEBED5DA4588 whereas Target (Rep. ID RMI:com.hordine.pedra.softbudget.domain.Budget:7AF5ED7A7CFDFF31:6227F23FA74A9A52)
 = 6227F23FA74A9A52 
```

* * *

## 回答 #13

> 赞同：17
> 
> 时间：2012-04-29T15:59:41.077

不要打扰，默认计算非常好，足以满足 99,9999% 的情况。如果您遇到问题，您可以 - 如前所述 - 在需要时引入 UID（这是极不可能的）

* * *

## 回答 #14

> 赞同：16
> 
> 时间：2014-03-04T16:17:48.520

我通常`serialVersionUID`在一个上下文中使用：当我知道它将离开 Java VM 的上下文时。

当我使用我的应用程序或者我知道我使用的库/框架将使用它时`ObjectInputStream`，我会知道这一点。`ObjectOutputStream`serialVersionID 确保不同版本或供应商的不同 Java VM 将正确互操作，或者如果它在 VM 外部存储和检索，例如`HttpSession`即使在应用程序服务器重新启动和升级期间会话数据也可以保留。

对于所有其他情况，我使用

```
@SuppressWarnings("serial") 
```

因为大多数时候默认`serialVersionUID`就足够了。这包括`Exception`, `HttpServlet`。

* * *

## 回答 #15

> 赞同：14
> 
> 时间：2013-03-13T14:26:53.937

字段数据表示存储在类中的一些信息。类实现了`Serializable`接口，所以eclipse自动提供声明`serialVersionUID`字段。让我们从那里设置的值 1 开始。

如果您不希望出现该警告，请使用以下命令：

```
@SuppressWarnings("serial") 
```

* * *

## 回答 #16

> 赞同：12
> 
> 时间：2015-03-25T21:08:11.297

SerialVersionUID 用于对象的版本控制。您也可以在类文件中指定 serialVersionUID。不指定 serialVersionUID 的后果是，当您在类中添加或修改任何字段时，已经序列化的类将无法恢复，因为为新类和旧序列化对象生成的 serialVersionUID 将不同。Java 序列化过程依赖于正确的 serialVersionUID 来恢复序列化对象的状态，并在 serialVersionUID 不匹配的情况下抛出 java.io.InvalidClassException

阅读更多：http: [//javarevisited.blogspot.com/2011/04/top-10-java-serialization-interview.html#ixzz3VQxnpOPZ](http://javarevisited.blogspot.com/2011/04/top-10-java-serialization-interview.html#ixzz3VQxnpOPZ)

* * *

## 回答 #17

> 赞同：12
> 
> 时间：2017-03-07T05:48:02.947

**为什么在 Java 中使用`SerialVersionUID`内部类？`Serializable`**

在 期间`serialization`，Java 运行时会为一个类创建一个版本号，以便以后可以对其进行反序列化。`SerialVersionUID`这个版本号在 Java中被称为。

`SerialVersionUID`用于版本化序列化数据。如果类`SerialVersionUID`与序列化实例匹配，则只能反序列化。当我们不在`SerialVersionUID`类中声明时，Java 运行时会为我们生成它，但不建议这样做。建议声明`SerialVersionUID`为`private static final long`变量以避免默认机制。

当您`Serializable`通过实现标记接口声明一个类`java.io.Serializable`时，Java 运行时使用默认的序列化机制将该类的实例持久保存到磁盘中，前提是您没有使用`Externalizable`接口自定义进程。

另请参阅[为什么在 Java 中的 Serializable 类中使用 SerialVersionUID](http://javarevisited.blogspot.com/2014/05/why-use-serialversionuid-inside-serializable-class-in-java.html)

* * *

## 回答 #18

> 赞同：11
> 
> 时间：2008-12-03T14:44:33.713

如果 CheckStyle 可以验证实现 Serializable 的类上的 serialVersionUID 是否具有良好的值，那就太好了，即它与串行版本 id 生成器将产生的相匹配。例如，如果您有一个具有大量可序列化 DTO 的项目，请记住删除现有的 serialVersionUID 并重新生成它是一件痛苦的事情，而目前（据我所知）验证这一点的唯一方法是为每个类重新生成并比较旧的。这是非常非常痛苦的。

* * *

## 回答 #19

> 赞同：8
> 
> 时间：2015-06-27T12:36:07.687

如果您想修改大量没有设置 serialVersionUID 的类，同时保持与旧类的兼容性，那么 IntelliJ Idea、Eclipse 等工具会因为它们生成随机数并且不适用于一堆文件而不足一气呵成。我提出了以下 bash 脚本（对于 Windows 用户，我很抱歉，请考虑购买 Mac 或转换为 Linux）来轻松修改 serialVersionUID 问题：

```
base_dir=$(pwd)                                                                  
src_dir=$base_dir/src/main/java                                                  
ic_api_cp=$base_dir/target/classes                                               

while read f                                                                     
do                                                                               
    clazz=${f//\//.}                                                             
    clazz=${clazz/%.java/}                                                       
    seruidstr=$(serialver -classpath $ic_api_cp $clazz | cut -d ':' -f 2 | sed -e 's/^\s\+//')
    perl -ni.bak -e "print $_; printf qq{%s\n}, q{    private $seruidstr} if /public class/" $src_dir/$f
done 
```

你保存这个脚本，对你说 add_serialVersionUID.sh ~/bin。然后在 Maven 或 Gradle 项目的根目录中运行它，例如：

```
add_serialVersionUID.sh < myJavaToAmend.lst 
```

此 .lst 包含用于添加 serialVersionUID 的 java 文件列表，格式如下：

```
com/abc/ic/api/model/domain/item/BizOrderTransDO.java
com/abc/ic/api/model/domain/item/CardPassFeature.java
com/abc/ic/api/model/domain/item/CategoryFeature.java
com/abc/ic/api/model/domain/item/GoodsFeature.java
com/abc/ic/api/model/domain/item/ItemFeature.java
com/abc/ic/api/model/domain/item/ItemPicUrls.java
com/abc/ic/api/model/domain/item/ItemSkuDO.java
com/abc/ic/api/model/domain/serve/ServeCategoryFeature.java
com/abc/ic/api/model/domain/serve/ServeFeature.java
com/abc/ic/api/model/param/depot/DepotItemDTO.java
com/abc/ic/api/model/param/depot/DepotItemQueryDTO.java
com/abc/ic/api/model/param/depot/InDepotDTO.java
com/abc/ic/api/model/param/depot/OutDepotDTO.java 
```

此脚本在后台使用 JDK serialVer 工具。因此，请确保您的 $JAVA_HOME/bin 在 PATH 中。

* * *

## 回答 #20

> 赞同：6
> 
> 时间：2015-08-03T19:41:31.070

Joshua Bloch 在 Effective Java 中很好地记录了这个问题。一本非常好的书，必须阅读。我将概述以下一些原因：

序列化运行时为每个可序列化类提供一个称为序列版本的数字。这个数字称为serialVersionUID。现在这个数字后面有一些数学，它是根据类中定义的字段/方法得出的。对于同一个类，每次都会生成相同的版本。在反序列化期间使用此数字来验证序列化对象的发送方和接收方是否已加载该对象的与序列化兼容的类。如果接收者为对象加载了一个类，该对象的 serialVersionUID 与相应发送者的类不同，则反序列化将导致 InvalidClassException。

如果该类是可序列化的，您还可以通过声明一个名为“serialVersionUID”的字段来显式声明您自己的serialVersionUID，该字段必须是静态的、最终的且类型为long。像 Eclipse 这样的大多数 IDE 可以帮助您生成那个长字符串。

* * *

## 回答 #21

> 赞同：6
> 
> 时间：2016-04-17T19:42:31.100

每次对对象进行序列化时，该对象都会被标记为对象类的版本 ID 号。此 ID 称为[serialVersionUID](https://stackoverflow.com/q/285793/1387612)，它是根据有关类结构的信息计算得出的。假设您创建了一个 Employee 类并且它的版本 id #333（由 JVM 分配），现在当您序列化该类的对象（假设 Employee 对象）时，JVM 会将 UID 分配给它作为 #333。

考虑一种情况 - 将来您需要编辑或更改您的类，在这种情况下，当您修改它时，JVM 将为它分配一个新的 UID（假设 #444）。现在，当您尝试反序列化员工对象时，JVM 会将序列化对象（员工对象）的版本 ID（#333）与类的版本 ID（即 #444）进行比较（因为它已更改）。比较 JVM 会发现两个版本的 UID 不同，因此反序列化会失败。因此，如果每个类的 serialVersionID 是由程序员自己定义的。即使类在未来发生演变，它也将是相同的，因此即使类发生了变化，JVM 也会始终发现该类与序列化对象兼容。有关更多信息，您可以参考 HEAD FIRST JAVA 的第 14 章。

* * *

## 回答 #22

> 赞同：3
> 
> 时间：2019-01-16T23:29:01.183

一个简单的解释：

1.  你在序列化数据吗？

    序列化基本上是将类数据写入文件/流/等。反序列化是将数据读回类。

2.  你打算投入生产吗？

    如果您只是用不重要/假数据测试某些东西，那么不要担心（除非您直接测试序列化）。

3.  这是第一个版本吗？

    如果是这样，设置`serialVersionUID=1L`.

4.  这是第二个、第三个等产品版本吗？

    现在您需要担心`serialVersionUID`，并且应该深入研究它。

基本上，如果在更新需要写入/读取的类时没有正确更新版本，则在尝试读取旧数据时会出错。

* * *

## 回答 #23

> 赞同：3
> 
> 时间：2020-01-20T15:14:59.203

'serialVersionUID' 是一个 64 位数字，用于在反序列化过程中唯一标识一个类。当您序列化一个对象时，该类的serialVersionUID 也会写入文件。每当您反序列化此对象时，java 运行时都会从序列化数据中提取此 serialVersionUID 值，并比较与该类关联的相同值。如果两者都不匹配，则会抛出“java.io.InvalidClassException”。

如果可序列化类没有显式声明 serialVersionUID，则序列化运行时将根据类的各个方面（如字段、方法等）计算该类的 serialVersionUID 值，您可以参考此[链接](https://self-learning-java-tutorial.blogspot.com/2014/09/serialversionuid.html)以获取演示应用程序。

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2019-04-29T05:06:22.230

首先回答你的问题，当我们没有在我们的类中声明 SerialVersionUID 时，Java 运行时会为我们生成它，但是该过程对许多类元数据很敏感，包括字段数、字段类型、字段的访问修饰符、实现的接口按类等。因此建议自己声明它，Eclipse 也会警告你。

序列化：我们经常使用状态（对象变量中的数据）非常重要的重要对象，以至于在将对象状态发送给其他人的情况下，我们不能冒因电源/系统故障（或）网络故障而丢失它的风险机器。这个问题的解决方案被命名为“持久性”，它仅仅意味着持久化（保存/保存）数据。序列化是实现持久性的许多其他方法之一（通过将数据保存到磁盘/内存）。保存对象的状态时，重要的是为对象创建一个标识，以便能够正确地读回它（反序列化）。这个唯一标识是 ID 是 SerialVersionUID。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2019-04-15T16:55:03.613

长话短说，该字段用于检查序列化数据是否可以正确反序列化。序列化和反序列化通常由程序的不同副本进行 - 例如服务器将对象转换为字符串，客户端将接收到的字符串转换为对象。该字段表明两者都以关于该对象是什么的相同想法进行操作。此字段在以下情况下有帮助：

*   您在不同的地方有许多不同的程序副本（例如 1 个服务器和 100 个客户端）。如果您要更改对象，更改版本号并忘记更新此客户端，它将知道他无法反序列化

*   您已将数据存储在某个文件中，稍后您尝试使用已修改对象的程序的更新版本打开它 - 如果您保持版本正确，您将知道该文件不兼容

什么时候重要？

最明显 - 如果您向对象添加一些字段，旧版本将无法使用它们，因为它们的对象结构中没有这些字段。

不太明显 - 当您反序列化对象时，字符串中不存在的字段将保留为 NULL。如果您从对象中删除了字段，旧版本会将此字段保留为 allways-NULL，如果旧版本依赖此字段中的数据，这可能会导致行为不端（无论如何，您创建它是为了某事，而不仅仅是为了好玩 :-)）

最不明显 - 有时你会改变你在某些领域的含义的想法。例如，当您 12 岁时，您的意思是“自行车”下的“自行车”，但当您 18 岁时，您的意思是“摩托车”——如果您的朋友邀请您“骑自行车穿越城市”，那么您将是唯一一个骑自行车，你会明白跨领域保持相同含义的重要性:-)

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2019-11-15T16:06:05.990

什么是 SerialVersionUID？回答： - 假设有两个人，一个来自总部，另一个来自 ODC，他们都将分别执行序列化和反序列化。在这种情况下，为了验证 ODC 中的接收者是经过身份验证的人，JVM 创建了一个唯一 ID，称为 SerialVersionUID。

这是基于场景的一个很好的解释，

为什么选择 SerialVersionUID？

**序列化**：在序列化的时候，每个对象发送方JVM都会保存一个唯一标识符。JVM 负责根据发送方系统中存在的相应 .class 文件生成该唯一 ID。

**反序列化**：在反序列化时，接收方 JVM 会将与对象关联的唯一 ID 与本地类唯一 ID 进行比较，即 JVM 还将根据接收方系统中存在的相应 .class 文件创建一个唯一 ID。如果两个唯一 ID 匹配，则仅执行反序列化。否则我们会得到运行时异常，说 InvalidClassException。这个唯一标识符不过是 SerialVersionUID

# list - 如何自动创建 LaTeX 文档中使用的项目列表？

> ID：285816
> 
> 赞同：13
> 
> 时间：2008-11-12T23:32:48.857
> 
> 标签：list, latex, automation, tex

我想在 LaTeX 文档中添加项目。例如，我想向文档添加提示。我创建了一个命令，所以我可以调用类似这样的东西：

```
\hint{foocareful}{Be careful with foo!}{foo is a very precious item and can easily be broken. Be careful, especially don't throw foo.} 
```

这将以特殊方式格式化，以使读者容易将其识别为提示。它有一个标签，可以在示例中使用“foocareful”引用。

在附录中，我想添加所有提示的列表以及对它们的引用。就像是：

```
\begin{enumerate}
   ...
   \item Be careful with foo! (\pageref{foocareful})
   ...
\end{enumerate} 
```

但我自然不想手动维护这个列表。如何自动创建这样的列表？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-13T03:19:52.877

一种方法是使用`float`包。我认为，至少，`floatrow`包也可以做你想做的，而且可能也更灵活。不过，再见。

这是您尝试使用的示例`float`：

```
\documentclass{article}
\usepackage{float}

\floatstyle{boxed}
\newfloat{hintbox}{H}{hnt}
\floatname{hintbox}{Hint}

\newcommand\hint[2]{%
  \begin{hintbox}
    #2
    \caption{#1}
  \end{hintbox}}

\begin{document}
\section{Hello}

\hint{Be careful with foo!\label{foocareful}}{%
  foo is a very precious item and can easily be broken. 
  Be careful, especially don't throw foo.}

\hint{Don't worry about bar!\label{foocareful}}{%
  Unlike foo, bar is pretty easily to get along with.}

\section{End}

\listof{hintbox}{List of Hints}

\end{document} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-13T01:13:14.770

多年来没有这样做，但我会查看 \tableofcontents 和 \listoffigures 的 LaTeX 源代码。我认为该机制是通用的，您可以将其扩展为包含您自己的列表。

# java - Java，向 Date 添加分钟，奇怪的异常

> ID：285818
> 
> 赞同：12
> 
> 时间：2008-11-12T23:33:46.357
> 
> 标签：java, date

在 Windows 和 Ubuntu Linux 上使用 Java 版本 1.5.0_06：

每当我在日期 "2008/10/05 00:00:00" 中添加分钟时，似乎错误地添加了一个额外的小时。

即：将 360 分钟添加到 2008/10/05 00:00:00 午夜应该到达 2008/10/05 06:00:00

但它到达 2008/10/05 07:00:00

完全令人困惑的是，这只**发生**在 2008 年 10 月 5 日这一天，我尝试正确执行分钟添加的所有其他日子。

我要疯了还是这是Java中的错误？

```
 SimpleDateFormat sdf = new SimpleDateFormat("yyyy/MM/dd HH:mm:ss");

    try {
        String date = "2008/10/05 00:00:00";
        int minutesToAdd = 360;  // 6 hrs

        Calendar cal = Calendar.getInstance();
        cal.setTime(sdf.parse(date));
        cal.add(Calendar.MINUTE, minutesToAdd);
        System.out.println(cal.getTime());

    } catch (ParseException e) {} 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-11-12T23:35:21.753

那天有一个夏令时的交叉点。

你在新西兰吗？如果是这样，这意味着您的时区文件已过时。最好去Java下载站点下载新的；寻找“JDK DST 时区更新工具”。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-12T23:36:38.643

这会是夏令时开始吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-13T08:15:43.167

看看[Joda-Time](http://joda-time.sourceforge.net/)。

从文档：

*“创建 Joda-Time 是为了从根本上改变 Java 中的日期和时间处理方式。JDK 类 Date 和 Calendar 的设计非常糟糕，存在大量错误并且具有奇怪的性能影响。”*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-08-28T11:08:23.900

## java.time

我建议您使用现代 Java 日期和时间 API java.time 进行日期和时间工作（您在 2008 年报告使用 Java 1.5，在 java.time 出现之前，但我希望您不再使用）。java.time 可以被认为是 Willi aus Rohr 在他的回答中提到的 Joda-Time 库的继承者。

让我们首先定义一个用于解析的格式化程序：

```
private static final DateTimeFormatter PARSER
        = DateTimeFormatter.ofPattern("yyyy/MM/dd HH:mm:ss", Locale.ROOT); 
```

现在解析您的字符串并添加 360 分钟：

```
 String date = "2008/10/05 00:00:00";
    int minutesToAdd = 360;  // 6 hrs

    ZonedDateTime originalTime = LocalDateTime.parse(date, PARSER)
            .atZone(ZoneId.of("Pacific/Auckland"));
    ZonedDateTime newTime = originalTime.plusMinutes(minutesToAdd);

    System.out.println(newTime); 
```

我的 Java 11 上的输出：

> 2008-10-05T06:00+13:00[太平洋/奥克兰]

已正确添加 6 小时。您注意到 a`ZonedDateTime`还打印了其 UTC 偏移量，此处为 +13:00，因此如果您的 Java 安装中有一个过期的时区数据库，您也有机会看到偏移量与预期不符。

如果您想添加整个小时数，请选择该`plusHours`方法而不是`plusMinutes`.

## 关联

[Oracle 教程：日期时间](https://docs.oracle.com/javase/tutorial/datetime/)解释如何使用 java.time。

# mysql - 用于 mysql 的开源 ER 图表工具

> ID：285828
> 
> 赞同：8
> 
> 时间：2008-11-12T23:37:23.743
> 
> 标签：mysql, reverse-engineering, er-diagrams

我想对我拥有的数据库的数据库定义转储进行反向工程（导入图表形式），然后由于在这个特定数据库中没有定义外键，我希望能够手动创建表到表的键映射（使用 crow如果可能，英尺符号）。

我查看了 MySQL Workbench，它让我完成了 85% 的工作。漂亮的小关系线不会出现，而且自动排列很糟糕。快速搜索谷歌会发现其他几个选项，所以我*可以*自己评估这些，但是：

我可以从你们那里得到一些反馈，您最喜欢在这种情况下使用哪些工具？你为什么喜欢那个（你的）特定工具？

我的预期目的是获取一个遗留数据库，并训练 jr。工程师对数据库的组织。视觉辅助工具很漂亮。我的后备选项是手动重新创建 ER 图。250 多张桌子不好玩。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-11-13T02:30:10.917

您可以查看 DBDesigner ...

现在称为 MySQL Workbench

[http://dev.mysql.com/downloads/workbench/5.0.html](http://dev.mysql.com/downloads/workbench/5.0.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-08-27T17:37:56.200

[SchemaCrawler](http://www.schemacrawler.com)是一个免费的开源工具，可以在 GraphViz 的帮助下生成 ER 图。您可以使用正则表达式来选择要显示的表和列。关系是从常用的命名约定中推断出来的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-13T02:11:44.400

我使用两种商业（但相对便宜！）工具取得了一些成功——但经过几个月的寻找，我仍然没有找到任何真正可靠的开源工具。

*   [MyEclipseIDE](http://www.myeclipseide.com/)是一个订阅产品，我认为每年大约 60 美元。这是一组用于 Eclipse 的捆绑插件，其中一个是运行良好的 ERD 分析器。如果您使用 Java（或其他 Eclipse 支持的语言）进行编程，这可能是值得的。
*   [SQLMaestro for MySQL](http://www.sqlmaestro.com/products/mysql/maestro/)：这个有点贵，非商业版 99 美元/单座许可证 179 美元。它生成的 ERD 要好得多，并且它提供了其他工具，可以更轻松地管理和维护更复杂的模式。

我的理解是 MySQL Workbench 仍在积极开发中，但他们已经在它上面敲打了很长时间而没有真正结束它。也许现在 Sun 拥有了它们，他们会聚在一起。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-04-12T16:44:52.060

查看[Vertabelo](http://www.vertabelo.com/)。

它是一个在 Chrome 浏览器下工作的在线数据库建模器。

它为您提供：

*   数据库模型版本控制和验证，
*   为特定数据库生成 SQL 脚本，
*   支持协作 - 允许与团队的其他成员共享数据库模型，
*   [支持逆向工程](http://www.vertabelo.com/blog/reverse-engineering)。

而且它是免费的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-08-20T13:58:04.650

使用 PHPMyAdmin 生成 ERD 也是一个更好的选择。PHPMyadmin 从 3.4 版添加了此功能

生成 ERD 的详细步骤：http: [//goo.gl/0z3vFE](http://goo.gl/0z3vFE)

您可以参考 PHPMyAdmin 文档了解更多信息：[http ://www.phpmyadmin.net/documentation/#pmadb](http://www.phpmyadmin.net/documentation/#pmadb)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-10-15T06:05:40.613

我正在使用 Mysql Workbench 6.1。默认情况下，对于大量表格，图表看起来会很复杂，因此很难弄清楚表格之间的关系。许多表将覆盖在其他表上。这是因为，默认布局尺寸很小。

在菜单中，转到模型>>“图表属性和大小”。

将宽度和大小更改为一些大的东西（例如宽度 23 和高度 5） -![在此处输入图像描述](https://i.stack.imgur.com/pvIhM.png)

然后在菜单中，转到排列>>自动布局。

现在我们应该看到一个包含所有关系的干净图表。现在我们可以重新调整宽度和高度，更有意义

# .net - DataGridView：如何聚焦整行而不是单个单元格？

> ID：285829
> 
> 赞同：31
> 
> 时间：2008-11-12T23:38:00.700
> 
> 标签：.net, winforms, datagridview

我想将 DataGridView 控件用作带有列的列表。有点像详细模式下的 ListView，但我想保持 DataGridView 的灵活性。

**ListView**（启用*Details*视图和*FullRowSelect*）突出显示整行并在整行周围显示焦点标记：
![ListView 控件中的选定行](https://i361.photobucket.com/albums/oo51/Stark3000/ListView_row.png)

**DataGridView**（使用*SelectionMode* = *FullRowSelect*）仅在单个单元格周围显示焦点标记：
![DataGridView 中的选定行](https://i361.photobucket.com/albums/oo51/Stark3000/DataGridView_row.png)

那么，有没有人知道一些（理想情况下）使 DataGridView 行选择看起来像 ListView 的简单方法？
我不是在寻找控件的更改行为 - 我只希望它看起来相同。
理想情况下，不要弄乱进行实际绘画的方法。

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2008-12-01T16:56:52.077

将此代码放入表单的构造函数中，或使用 IDE将其设置在 datagridview 的*属性中。*

```
dgv.SelectionMode = DataGridViewSelectionMode.FullRowSelect;
dgv.MultiSelect = false;
dgv.RowPrePaint +=new DataGridViewRowPrePaintEventHandler(dgv_RowPrePaint); 
```

然后将以下事件粘贴到表单代码中：

```
private void dgv_RowPrePaint(object sender, DataGridViewRowPrePaintEventArgs e)
{
    e.PaintParts &= ~DataGridViewPaintParts.Focus;
} 
```

它有效！:-)

“dgv”是有问题的*DataGridView*，“form”是包含它的*表单。*

请注意，此解决方案不会在整行周围显示虚线矩形。相反，它完全移除了焦点。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2011-11-29T01:00:23.837

怎么样

```
SelectionMode == FullRowSelect 
```

和

```
ReadOnly == true 
```

这个对我有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-04-28T16:37:17.517

如果您希望焦点矩形围绕整行而不是单个单元格，您可以使用以下代码。它假定您的 DataGridView 被命名为 gvMain，并且它的 SelectionMode 设置为 FullRowSelect 并且 MultiSelect 设置为 False。

```
private void gvMain_RowPostPaint(object sender, DataGridViewRowPostPaintEventArgs e)
{
    // Draw our own focus rectangle around the entire row
    if (gvMain.Rows[e.RowIndex].Selected && gvMain.Focused) 
        ControlPaint.DrawFocusRectangle(e.Graphics, e.RowBounds, Color.Empty, gvMain.DefaultCellStyle.SelectionBackColor);
}

private void gvMain_RowPrePaint(object sender, DataGridViewRowPrePaintEventArgs e)
{
    // Disable the original focus rectangle around the cell
    e.PaintParts &= ~DataGridViewPaintParts.Focus;
}

private void gvMain_LeaveAndEnter(object sender, EventArgs e)
{
    // Redraw our focus rectangle every time our DataGridView receives and looses focus (same event handler for both events)
    gvMain.InvalidateRow(gvMain.CurrentRow.Index);
} 
```

# bug-tracking - 识别错误跟踪的重复异常

> ID：285835
> 
> 赞同：1
> 
> 时间：2008-11-12T23:39:13.897
> 
> 标签：bug-tracking

我开发了一个“概念证明”应用程序，它将应用程序中未处理的异常记录到错误跟踪系统（在本例中为 Team Foundation Server，但它可以是任何错误跟踪系统）。这个想法的一个限制是我不希望每次抛出相同的异常时都打开重复的错误项（例如，许多用户遇到异常 - 它仍然是一个“错误”）。

我的第一次尝试是将异常类型、消息和堆栈跟踪作为字段存储在错误跟踪系统中。然后，日志记录组件将对错误“存储”进行查询，以查看是否存在具有相同信息的打开错误。（这个例子是.NET - 但我认为这个概念是平台独立的）。

问题显然是这些字段可能非常大（尤其是堆栈跟踪） - 并且需要“全文”类型的实现来存储它们并且搜索非常昂贵。

我想知道为这个问题定义了哪些方法。例如，我听说 FogBugz 有这样一个自动错误跟踪功能，我很好奇它是如何实现的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-13T01:21:08.543

如果您有堆栈跟踪，您可以在堆栈跟踪中找到最后一条语句并将其与已记录的语句进行比较。如果包含符号，您还将获得行号。所以，现在你有两件事要比较，实际的错误号和失败的语句，可能还有实际的行号。如果已经记录了所有这些内容，那么很可能（当然不是 100%）是同一个问题。

事实上，您可以使用“at”字样解析堆栈跟踪，因为堆栈跟踪中的每一行都以“at”开头。因此，查找最后一个“at”，获取该行，将其与存储的堆栈跟踪的最后一个“at”行进行比较，您可能实际上有一些东西。

！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-13T01:13:42.957

您可以创建堆栈跟踪的校验和哈希并将其存储为索引列。这样，对 Bug Store 的查询将非常快，以避免插入时出现重复。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-27T22:08:49.250

您可以查看聚合异常的现有开源解决方案之一的源代码。

例如：[https ://github.com/getsentry/sentry/tree/master/src/sentry](https://github.com/getsentry/sentry/tree/master/src/sentry)

这不是一个简单的问题，并且有复杂的启发式方法（例如，相同的异常在不同的浏览器上以不同的方式报告，例如由浏览器扩展引起的异常很常见但很少重要）。

# cocoa - 新出的mac应用是否需要支持10.4，能不能既支持10.4又准备64bit？

> ID：285837
> 
> 赞同：1
> 
> 时间：2008-11-12T23:39:51.447
> 
> 标签：cocoa, macos, 64-bit

我的公司正在从头开始重写我们的软件，我是重写Mac客户端的大部分工作的人（我们软件的核心是基于Windows的，Mac客户端与它通过网络服务）。

这不是一个真正繁重的应用程序，主要是做一些后台工作跟踪的东西和用户输入信息的 UI 组件。

我正在尝试决定我应该为放弃对 10.4 的支持并使用纯 10.5+/Obj-C 2.0 代码而争论不休。

我这样做的主要动机是：

*   编码会更容易，我可以使用 Obj-C 2.0 的所有功能，例如综合属性和快速枚举。

*   它可以让我访问 10.4 中不存在的多个类和现有类中的方法（只是在模拟 UI 时，我遇到了 NSPathControl 和 NSTreeNode，否则我会很乐意使用它们。

*   准备在 Snow Leopard 中转换为 64 位。似乎大多数[准备迁移到 64 位](http://developer.apple.com/documentation/Cocoa/Conceptual/Cocoa64BitGuide/64BitChangesCocoa/chapter_3_section_2.html#//apple_ref/doc/uid/TP40004247-CH4-DontLinkElementID_1)的技术（NSInteger 等）仅在 10.5+ 中可用，如果为 10.4 编写，则无法使用这些技术。

当然，不利的一面是我们将不再支持仅过时一年的操作系统。

我的老板自己也支持这一举措，但我们的客户当然要考虑，并且不想给他们造成任何超出合理范围的问题。支持总监想支持10.4。我怀疑其他高管起初会略微反对它，只是因为无法支持某些客户的事情。每个人都愿意接受任何一方的好论据。

我正在尝试与一些支持人员交谈，并了解我们有多少客户实际上仍在使用 10.4，但我还没有这些数据。

某种混合解决方案可能是可能的，例如重写旧客户端的一部分以使用新的 Web 服务，或者在 10.5 中编写客户端并在有足够多的人大惊小怪时将其反向移植到 10.4，但坦率地说，这些听起来像是可能比放弃 10.5 的特性并开始在 10.4 中编写代码更麻烦。

所以我想我的问题如下：

1.  鉴于上述信息，您认为仅采用 10.5+ 是正确的做法吗？对于如何积极地向公司其他人介绍这件事，您有什么建议吗？

2.  我对即将到来的 64 位转换了解不多。是否有人对不同之处有任何很好的参考，您认为仅支持 10.5+ 会使我们更轻松地进行过渡吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-12T23:51:55.713

如果是我进行更新，我会以 10.5 为目标，尤其是因为 10.6 指日可待，而且 10.5 确实带来了很多很棒的新东西（尤其是 Objective-c 2.0）。但是，我认为您确实需要根据您认为目标客户群将使用的内容来回答这个问题。如果他们采用新技术的速度很慢，则可能是您必须支持 10.4，否则可能会失去部分客户群。

另一方面，您实际上可以针对 10.4 并使用 10.5 SDK 进行编写。这样您就可以充分利用所有为 64 位添加到 SDK 的准备工作。您只需确保不使用 10.4 中不存在的框架的任何类或功能。您还可以对 10.5 框架进行弱链接，并以编程方式决定是否可以使用新功能（虽然这是一些额外的前期工作，但您可以在未来轻松地从您的代码中移除 10.4 支持并充分利用对于实际运行 10.5 的用户而言，10.5 改进的优势）。

有很多关于在网络上做跨平台的东西的博客和文章。要记住的另一件事是，如果您的目标是 10.4，请确保您有一台 10.4 机器可用于进行大量测试（特别是如果您从 10.5 SDK 编译以利用 64 位就绪功能）。还要检查扩展坞，了解您可能想要从 10.5 SDK 使用的任何功能。许多功能实际上在 10.4 中可用，但未记录在案，新文档通常会说明在部署到 10.4 时可以安全使用哪些功能

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-12T23:58:29.973

你*需要*64位吗？除非您的应用程序占用大量 CPU 资源，否则它不会产生任何影响。

Tiger*可以*运行 64 位应用程序，但没有 GUI。如果您需要 64 位，您可以创建 64 位 CLI 可执行文件来完成繁重的工作并为其提供 32 位字体结尾（使用`NSTask`和`NSPipe`）。

您还可`.nib`以为 Leopard 和 Tiger 提供单独的文件：

```
-(id)init
{
  BOOL tiger = floor(NSAppKitVersionNumber) <= NSAppKitVersionNumber10_4; 
  NSString nibname = (tiger ? @"WindowTiger" : @"WindowLeopard");
  if (self = [super initWithWindowNibName:nibname]) 
  … 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-13T08:21:40.333

您确实需要了解您的客户正在使用什么，而支持人员或产品经理可能最适合了解。也就是说，即使您 90% 以上的用户群是 Leopard 之前的用户，现在明确技术论点也没有错；这样，问题就会被知晓（并希望被理解），因此随着环境的变化，您将获得更多支持。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-12T23:58:25.090

我从未在 Objective-C 中编写过生产代码，而且很难跟上，但据我所知，NSInteger 和朋友们在 10.4 中，只是 Cocoa 在 10.4 中不是 64 位，而在 10.5 中大部分是（所以在 32 位 UI 下不再需要单独的 64 位工作进程）。

我不知道您的产品是什么，也不知道您的客户是谁，但根据我的经验，Mac 用户是早期采用者（相对而言）我从未使用过超过两周的 OS X 版本，在我的圈子里，我是一个较晚的采用者。当然，我不仅仅是一个商业 Mac 用户，这很可能会产生很大的不同。

是什么让 64 位成为您代码中的要求？没有什么理由不编译一个包含尽可能多架构的通用二进制文件，让一个二进制文件在 G4、G5、IA32 和 IA64 上运行没问题，并让它在所有这些上都是本机的。如果你只是因为你可以做 64 位，那么没有理由（我可以想象）不继续支持 32 位，但是如果你想要像 CoreAnimation 这样的东西，你没有太多选择。

我不认为要求 10.5 进行新开发是错误的，但是仅仅为了继续使用现有产品而强制客户使用全新的操作系统并没有太大的商业意义。因此，如果可以，请保持兼容，也许可以暂时向后移植您的新功能/补丁。在版本控制中分叉是有充分理由的，可能就是这样。

编辑-

自从我发布这篇文章后，我了解到我错了，NSInteger 在 10.5 之前不存在。我想我之前假设太多使用了类似的类型（如 NSDecimal）。

# c# - UTC 是否有任何功能可以将特定日期时间转换为 UTC 日期时间

> ID：285846
> 
> 赞同：0
> 
> 时间：2008-11-12T23:41:55.373
> 
> 标签：c#

例如，我想将特定日期 12-11-2008 11:33:04.510 转换为 UTC 日期时间。任何人都可以帮助我如何做到这一点。我想在 c# 编码中做到这一点。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-12T23:43:14.293

只需使用[DateTime.ToUniversalTime](http://msdn.microsoft.com/en-us/library/system.datetime.touniversaltime.aspx)，假设它目前在您计算机的本地时区。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-13T00:01:51.653

DateTime 不支持时区。它可以被视为当地时间或 UTC 时间，正如 Jon Skeet 所说，DateTime.ToUniversalTime 可以在它们之间转换。

在 .NET3.5 中还有 TimeZoneInfo 类，它允许在任意时区之间转换 DateTime，但对于您的需要，前者可能已经足够了。还有一个 DateTimeOffset 类，它的工作方式与 DateTime 类似，只是它还存储与 UTC 的偏移量，如果您必须处理多个时区，它会更加健壮。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-13T17:24:02.603

如果您希望将 DateTime 标识为 UTC，您还可以为其分配一个 DateTimeKind，

日期时间保存 = 日期时间。现在；日期时间 myDt; myDt = DateTime.SpecifyKind(saveNow, DateTimeKind.Utc);

或者，如果您知道它是本地的： string formattedDate = "12-11-2008 11:33:04.510"; DateTime localDt = DateTime.Parse(formattedDate, null, DateTimeStyles.AssumeLocal);

或者，如果您知道它是 UTC： string formattedDate = "12-11-2008 11:33:04.510"; DateTime localDt = DateTime.Parse(formattedDate, null, DateTimeStyles.AssumeUniversal);

# functional-programming - 函数式编程是自然语言编程的下一步吗？

> ID：285848
> 
> 赞同：4
> 
> 时间：2008-11-12T23:43:05.607
> 
> 标签：functional-programming, nlp

这是我的第一个问题，所以我有点紧张，因为我不确定我是否理解得足够好。无论如何，我们走吧......

每当达到编程的新里程碑时，似乎他们总是有一个共同目标：让程序员更容易编程。

机器语言、操作码/助记符、过程/函数、结构、类 (OOP) 等总是有助于以更自然、更易于理解和更好维护的方式规划、构造和编码程序。

当然，函数式编程绝不是新鲜事物，但近年来它似乎经历了某种复兴。我也相信，当微软将 F# 添加到他们的主流编程语言中时，FP 将得到巨大的推动。

回到我最初的问题，我相信最终编程将使用自然语言（英语）完成，几乎没有限制或规则。编译器将成为 AI/NLP 系统的一部分，该系统从代码中提取信息，或者我应该说文本并将其转换为编译器可以编译的中间语言。

那么，FP 是让编程更接近自然语言编程，还是它是一个障碍，主流 OOP 会引导我们更快地走向自然语言编程？

这个问题不应该用来讨论自然语言编程的可用性或可行性，因为只有未来才能证明。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-11-12T23:49:24.407

对不起，我完全不同意。代码最终是制作事物（对象）的蓝图，因此它*必须*非常精确且受规则支配才能可靠地运行。自然语言不会比在餐巾纸上画草图取代机械工程更早取代编程。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-12T23:51:08.257

我个人得出的结论是自然语言编程有些破解。

英语并不完全适合完全作为一门编程语言使用，太多的抽象词在编程中没有相关性，比如情感术语和其他在编程中没有地位的抽象概念，所以说编程永远是“自然的”语言”将随之而来，“自然语言”可能是编程，但事实并非如此。

现在，虽然我明白你在说什么，但问题是英语有太多废话和相同事物的重复名称，所以我们将使用甚至不是特定于编程领域的东西，因为编程的任务。

我认为它更适合人们理解编程实际上是一种高度专业化的语言，并用他们的大脑学习用一种语言进行编码，这种语言简单，声明性并且具有一致的定义，不像英语的定义是高度主观的.

一旦你了解了一种语言的来龙去脉，并了解了它的原理图和行为，你就可以将它们结合起来做新的事情。

以 Perl 为例，每个人都痛斥它是线路噪音，但是当你了解许多编程语言时，一旦你克服了“OMG LINE NOISE”的最初障碍，它就会有一定程度的直观性，你可以在其中编造你从未读过的东西about 然后看到它像你预期的那样神奇地工作。

恕我直言，在有针对性的问题解决方面，特定领域的语言胜过口语。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-12T23:56:59.167

“那么，FP 是让编程更接近自然语言编程，还是它是一个障碍，主流 OOP 会引导我们更快地走向自然语言编程？”

两者都不。两者都遵循相同的原则，即您必须具体说明您希望计算机做什么。不能有*不*确定性的余地，这两种范式*都*与自然语言无关。他们解决了一个完全不同的问题：管理和构建复杂代码和大型代码库。

自然语言的最大障碍是解析。明确地解析自然语言是不可能的。如果没有大量的上下文信息（面部表情、语调），即使是人类也无法做到这一点，即便如此，我们仍然经常会出错。

OOP 和 FP 只是关于解析*后发生的事情。*一旦识别和解析了每个语义元素，它的含义就会被分配。

也许有一天我们能够用自然语言进行编程。我怀疑它会在未来几十年内发生，但它可能有一天会发生。但是今天的编程范式既不会加速这个过程，也不会延迟它。他们根本与它无关，也无助于解决解析问题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-12T23:55:51.773

我不认为函数式编程比 OO 编程更接近自然语言编程。函数式编程具有非常面向动词的语法。当您使用 Lisp 或 Scheme 进行编程时，您会花费大量时间来考虑函数以及您希望对数据执行哪些操作。在 OO 编程中，您大部分时间都在考虑对象，因此它看起来非常面向名词。但是，在 Smalltalk、C++ 和 Java 中，您也有一些方法，可以让您将动词应用于所有名词（可以这么说）。

我不认为 OO 编程一定会引导我们走向自然语言编程，但从我的角度来看，它比函数式编程更接近一点。对我来说，函数式编程似乎更接近于数学而不是自然语言。这并不是一件坏事，因为也许数学是我们在编程时应该考虑的语言。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-13T06:08:13.800

仅供参考，[Inform 7](http://www.inform-fiction.org/I7/Inform%207.html)可能是最接近自然语言编程的人。它是一种针对特定领域的语言：编写交互式小说，一种以“冒险游戏”开始的软件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-13T01:28:30.120

当前对函数式编程的兴趣激增主要是由于 C# 3.0 的酷炫新特性基本上是启用并行性并表示向多核计算的转变。恕我直言，我认为我们不能将其视为“自然语言编程”的下一步

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-13T03:21:30.080

如果您正在寻找编程语言的下一次发展，我会寻找 DSL。DSL 允许高度定制的语言，使复杂的商务用户能够配置系统，而不必担心编码细节，如数据类型、线程和 UI 小部件。

函数式语言将在“高度并行处理”领域占有一席之地。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-13T04:04:43.237

您是否认为主观问题会在此处将“Windows Internals the 5th Element”订单添加到数据库并运送到我的地址？如果是这样，自然语言编程将非常接近函数式编程，因为我以某种函数式的方式提出了我的问题。如果不是，那么自然语言编程不会让我的订单发货，是吗？函数式编程可以工作，因为它仍然与自然语言无关。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-13T05:50:49.140

不会。函数式编程将使我们更接近于证明编译器。那是编译器可以证明有关您的代码的更多断言。编译器可以为我们证明的越多，软件开发就越接近工程而不是艺术。

NLP 编程语言可能更像是一种“按我的意思做，而不是按我说的做”风格的语言。这可能与函数式语言的发展方向相反。

“所有编程语言都在向 LISP 汇聚。”

# java - 如何以编程方式测试 HTTP 连接？

> ID：285860
> 
> 赞同：22
> 
> 时间：2008-11-12T23:52:23.760
> 
> 标签：java, http, url, httpconnection

使用 Java，如何测试 URL 是否可联系并返回有效响应？

```
http://stackoverflow.com/about 
```

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2008-11-12T23:53:44.710

作为单元测试的解决方案：

```
public void testURL() throws Exception {
    String strUrl = "http://stackoverflow.com/about";

    try {
        URL url = new URL(strUrl);
        HttpURLConnection urlConn = (HttpURLConnection) url.openConnection();
        urlConn.connect();

        assertEquals(HttpURLConnection.HTTP_OK, urlConn.getResponseCode());
    } catch (IOException e) {
        System.err.println("Error creating HTTP connection");
        e.printStackTrace();
        throw e;
    }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-12T23:56:52.380

如果我记得的话，从 java 5 开始，InetAdress 类包含一个名为 isReachable(); 的方法。所以你可以用它在java中做一个ping实现。您还可以为此方法指定超时。这只是上面发布的单元测试方法的另一种替代方法，它可能更有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-05-07T10:15:06.803

```
System.out.println(new InetSocketAddress("http://stackoverflow.com/about", 80).isUnresolved()); 
```

如果页面可达，则返回 false，这是一个先决条件*。*

为了完全涵盖最初的问题，您需要实现*http get*或*post*。

* * *

## 回答 #4

> 赞同：-10
> 
> 时间：2011-06-23T09:42:01.820

```
import org.apache.commons.validator.UrlValidator;

public class ValidateUrlExample {

    public static void main(String[] args) {

        UrlValidator urlValidator = new UrlValidator();

        //valid URL
        if (urlValidator.isValid("http://www.mkyong.com")) {
            System.out.println("url is valid");
        } else {
            System.out.println("url is invalid");
        }

        //invalid URL
        if (urlValidator.isValid("http://invalidURL^$&%$&^")) {
            System.out.println("url is valid");
        } else {
            System.out.println("url is invalid");
        }
    }
} 
```

输出：

```
网址有效
网址无效

```

来源：[http ://www.mkyong.com/java/how-to-validate-url-in-java/](http://www.mkyong.com/java/how-to-validate-url-in-java/)

# xml - 我可以在运行时查找文件并将其导入到 Ant 构建文件中吗？

> ID：285866
> 
> 赞同：1
> 
> 时间：2008-11-12T23:55:02.850
> 
> 标签：xml, plugins, ant, build-automation

我想创建一个 Ant 构建文件，其中包含一些文件作为一种插件。

因此，如果我想激活项目中的一个功能——比如 pmd-checking——我将一个 pmd.xml 复制到一个目录中，并且 build.xml 开始了这个想法，即 pmd.xml 存在并导入它，这样新的目标可用于构建。

但是“导入”任务只能用作顶级任务，所以我不知道如何实现这个功能。Ant可以做到这一点，如果可以，我该怎么做？

编辑：我更喜欢一种解决方案，它允许新目标出现在`ant -p`.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-13T00:44:53.810

您可以使用[**ant**](http://ant.apache.org/manual/Tasks/ant.html)任务，甚至可以参数化目标名称。这是一个例子：

```
<ant antfile="plugins/pmd.xml" target="${pmd-target}"/> 
```

如果你想要更多的灵活性，我建议检查[gant](http://gant.codehaus.org/)或[gradle](http://www.gradle.org/)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-13T02:42:12.560

在[导入](http://ant.apache.org/manual/Tasks/import.html)任务的文档中，记下该`optional`属性。将此设置为`true`并且缺少包含不会破坏构建。

如果找到，则包含so `pmd.xml`，但如果不是，则不会破坏构建。

`ant -p`未经测试，因此如果找到导入文件中的目标，我不肯定。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-01-09T14:45:27.743

导入任务文档中没有明确说明，但该任务接受文件集作为单个文件的替代方案。因此，在顶层，这应该可以解决问题，并且创建的目标按以下方式列出`ant -p`：

```
<property name="plugins.dir" value="plugins" />
<fileset id="plugin.modules" dir="${plugins.dir}">
    <include name="**/*.xml" />
</fileset>

<import>
    <fileset refid="plugin.modules" />
</import> 
```

一个问题是'plugins'目录中必须至少有一个插件，否则导入将失败。您可以只创建一个占位符文件 - 比如说`empty.xml`：

```
 <project /> 
```

一旦那里，您只需将任何新插件放在插件目录中，它们将被未来的构建导入。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-13T01:19:06.333

我不确定你想要的在概念上是否可行。命令行`-p`参数不执行任何任务，它只是解析文件。你想要的东西需要被执行。

但是，我想看看[ant-contrib](http://ant-contrib.sourceforge.net/)项目。它有一个条件[`<if>`](http://ant-contrib.sourceforge.net/tasks/tasks/if.html)任务，它可能使顶级导入仅在您需要时才起作用。

# python - Windows 上的 WX Python 和原始输入 (WM_INPUT)

> ID：285869
> 
> 赞同：4
> 
> 时间：2008-11-12T23:56:24.877
> 
> 标签：python, windows, wxpython, raw-input

有谁知道如何通过WX Python 应用程序在 Windows 上使用[Raw Input工具？](http://msdn.microsoft.com/en-us/library/ms645543(VS.85).aspx)

我需要做的是能够区分来自多个键盘的输入。因此，如果有另一种方法可以实现这一目标，那也可以。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-20T22:03:01.820

您是否尝试过使用 ctypes？

```
>>> import ctypes
>>> ctypes.windll.user32.RegisterRawInputDevices
<_FuncPtr object at 0x01FCFDC8> 
```

设置必要结构的 Python 版本需要一些工作，但您可以通过这种方式直接查询 Win32 API，而无需通过 wxPython。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-22T01:05:21.887

这里有一个漂亮的图书馆 [http://code.google.com/p/pymultimouse/](http://code.google.com/p/pymultimouse/)

它不是 wx-python 特定的——但它确实在 python 中使用了 ctypes 的原始输入（并且在我的测试中使用了 2 只老鼠）

# c++ - 在 C++ 中你可以有一个指向函数的指针，你也可以有一个指向类的指针吗？

> ID：285886
> 
> 赞同：8
> 
> 时间：2008-11-13T00:06:01.253
> 
> 标签：c++, class, pointers

我不是在谈论指向实例的指针，我想要一个指向类本身的指针。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-11-13T00:10:27.827

在 C++ 中，类不是“[第一类对象](http://en.wikipedia.org/wiki/First-class_object)”。您可以获得的最接近的是指向其`type_info`实例的指针。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-13T00:07:40.063

不，指针是运行时计算机内存中某物的地址。一个类只是给编译器的一组指令。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-13T00:31:19.877

正如其他人已经说过的那样，不可能有一个指向类的指针。

但是，如果重点是从运行时选择的某个类创建一个新实例，您可能需要查看工厂方法（或抽象工厂）设计模式。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-13T00:09:57.017

是和否。这取决于您要达到的目标的背景。如果您只是想要一个指向**类型**的指针，那么没有办法。就指针而言，**类型**并不存在于内存中。

我说是的原因是有些人会认为虚拟表是指向类型的指针。由于虚拟表确实存在于内存中，并且可以通过一些技巧来调用虚拟方法，因此可以获得此指针是可能的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-13T00:14:32.577

与真正的基于对象的语言不同，类在 C++ 中不是对象，更可惜的是。最接近“类指针”的是 RTTI：

const std::type_info &info = typeid(对象表达式);

type_info 有 name() 成员函数，它们可以相互比较。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-13T00:20:15.843

“类”不存在。您唯一可以指出的是数据。

“类”的其余部分实际上是一个调度表。对于类中的每个方法，调度表都有一个指针。这样，无论当前转换为哪种类型，该类都指向您的类的正确方法。这将是无用的访问。

类中的方法（调度表指向的东西）实际上只是在类数据指针中传递的“函数”。方法的定义几乎就是一个将类数据作为参数的函数。在大多数 C 风格的语言中，该数据指针是隐藏的，但称为“this”。

您的类的方法可能遍布整个代码库。由于父类，您甚至不可能发现这些方法彼此相邻。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-13T00:32:07.800

您不能拥有指向类的（运行时）指针，但 C++ 确实具有类似的编译时概念：[模板参数](http://en.wikipedia.org/wiki/Template_(programming))。 [Boost](http://www.boost.org)有一个专门用于操作它们的库和一个[用于](http://www.boost.org/doc/libs/1_37_0/libs/mpl/doc/index.html)获取类信息的[特征库。](http://www.boost.org/doc/libs/1_37_0/libs/type_traits/doc/html/index.html)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-13T03:31:10.747

根据您对指针的看法，您可以拥有一个指向类的“指针”，如果指针是指某个整数值。Boost 允许您注册类型并为您注册的每种类型分配一个唯一的整数。如果您注册的类型都是类，那么您可以在运行时查找创建所需类型的对象所需的代码，只要您具有所需类型的值。但一般来说，类不是语言中的第一类对象，你能希望的最好的就是模拟你想要的行为。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-13T03:44:25.167

诚然，C++ 中不支持反射/内省，但是有许多库将添加许多例如 java 的 Class 功能，并允许程序员获取表示类的对象、创建实例等. 谷歌 C++ 反射。

# php - php：写入文件

> ID：285889
> 
> 赞同：1
> 
> 时间：2008-11-13T00:08:58.923
> 
> 标签：php, file-io

我想在 PHP 中动态地在网络服务器上创建一个文件。

首先，我创建一个目录来存储文件。这行得通

```
// create the users directory and index page
$dirToCreate = "..".$_SESSION['s_USER_URL'];
mkdir($dirToCreate, 0777, TRUE); // create the directory for the user 
```

现在我想创建一个名为 index.php 的文件并将一些内容写入其中。

我在尝试：

```
$ourFileName = $_SESSION['s_USER_URL']."/"."index.php";
$ourFileHandle = fopen($ourFileName, 'x') or die("can't open file");
fclose($ourFileHandle);

// append data to it
$ourFileHandle = fopen($ourFileName, 'a') or die("can't write to file");

$stringData = "Hi";

fwrite($ourFileHandle, $stringData); 
```

但它永远不会超过`$ourFileHandle = fopen($ourFileName, 'x') or die("can't open file");`说文件不存在，但这就是重点。我想创建它。

我做了一些回声，路径（/people/jason）存在，我正在尝试写入 /people/jason/index.php

有人对我做错了什么有任何想法吗？

我相信 Linux 服务器上的 PHP 5。

-杰森

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-13T00:15:20.377

首先你做：

```
$dirToCreate = "..".$_SESSION['s_USER_URL']; 
```

但是您尝试写入的文件名没有以'..'为前缀，因此请尝试更改

```
$ourFileName = $_SESSION['s_USER_URL']."/"."index.php"; 
```

到

```
$ourFileName = '..' . $_SESSION['s_USER_URL'] . '/index.php'; 
```

或者可能更整洁：

```
$ourFileName = $dirToCreate . '/index.php'; 
```

您可能会收到警告，因为您尝试将文件写入的目录不存在

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-13T00:12:48.820

这可能是您的 php ini 设置之一，或者可能是 apache 安全设置的结果。

尝试将目录创建为仅 rwxr-x--- 并查看情况如何。

我记得一个共享主机设置，其中编译了“安全模式”，并且这种行为往往会发生，基本上，如果文件/目录可被太多人写入，它们会神奇地停止访问。

它可能在 php 中记录，但我必须检查。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-13T00:17:37.283

为什么不使用：

```
file_put_contents( $filename, $content ) 
```

或者您可以`touch`在写入文件之前先写入文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-13T00:18:16.627

文件'index.php'是否已经存在？当您使用 'x' 模式打开 fopen 时，如果文件存在 fopen 将返回 FALSE 并触发警告。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-13T02:47:22.380

我首先注意到的是您正在树中创建一个更高的目录，然后尝试在当前文件夹中创建 php 文件。如果我错了，请纠正我，但是您不是要在新创建的文件夹中创建文件吗？如果我没记错 php（请原谅我已经有一段时间了，我可能会在这里添加另一种语言的东西，而不是注意到）这里对于初学者来说是一种更容易理解的方式，当然相应地更改值，这只是一个目录并制作一个文件然后设置权限。

```
<?php

$path = "..".$_SESSION['s_USER_URL'];   
// may want to add a tilde (~) to user directory
// path, unixy thing to do ;D

mkdir($path, 0777); // make directory, set perms.

$file = "index.php"; // declare a file name

/* here you could use the chdir() command, if you wanted to go to the 
directory where you created the file, this will help you understand the 
rest of your code as you will have to perform less concatenation on
 directories such as below */

$handle = fopen($path."/".$file, 'w') or die("can't open file");
// open file for writing, create if it doesn't exist

$info = "Stack Overflow was here!";  // string to input

fwrite($handle, $info);   // perform the write operation

fclose($handle);  // close the handle

?> 
```

# sql - numeric(38,0) 作为主键列；好，坏，谁在乎？

> ID：285899
> 
> 赞同：14
> 
> 时间：2008-11-13T00:12:27.357
> 
> 标签：sql, sql-server, sql-server-2005, primary-key

在我当前的项目中，我遇到了我们的主数据库脚本。仔细看一下，我注意到我们所有的原始主键的数据类型都是**numeric(38,0)** 我们目前正在运行 SQL Server 2005 作为我们的主要数据库平台。

对于一点上下文，我们支持 Oracle 和 SQL Server 作为我们的后端。在 Oracle 中，我们的主键的数据类型为**number(38,0)。**

有人知道这种实施可能产生的副作用和性能影响吗？我一直提倡并实现*int*或*bigint*作为主键，并且很想知道 numeric(38,0) 是否是更好的选择。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-13T01:31:48.677

好吧，您*正在*花费更多数据来存储您永远无法真正达到的数字。

bigint 在 8 个字节内上升到 9,223,372,036,854,775,807

int 在 4 个字节中上升到 2,147,483,647

如果我做对了，一个 NUMERIC(38,0) 将占用 17 个字节。

差别不大，但是：较小的数据类型 = 内存中的更多行（或相同行数的更少页面）= 更少的磁盘 I/O 进行查找（索引或数据页面查找）。复制、日志页面等也是如此。

对于 SQL Server：INT 是 IEEE 标准，因此 CPU 比较容易比较，因此使用 INT 与 NUMERIC（压缩十进制格式）相比，性能略有提高。（注意在 Oracle 中，如果当前版本与我长大的旧版本相匹配，所有数据类型都会被打包，因此内部的 INT 与 NUMERIC(x,0) 几乎相同，因此没有性能差异）

所以，从总体上来说——如果你有很多磁盘、RAM 和备用 I/O，那么就使用你想要的任何数据类型。如果您想获得更多性能，请保守一点。

否则在这一点上，我会保持原样。没有必要改变事情。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-13T00:41:05.240

除非考虑到存储方面的考虑和未来 DBA 的一些初步困惑，否则我认为 NUMERIC(38,0) 不是一个坏主意。您的表中最多允许 9.99 x 10^38 条记录，您肯定永远无法达到。我快速深入研究并没有发现任何不使用它的明显理由。我怀疑您唯一的潜在问题将是它所消耗的存储空间，但鉴于存储空间如此便宜，这应该不是问题。

我在 Oracle 数据库中看到过很多次，因为它是一个相当大的默认值，您在创建表时不需要考虑它，类似于在 SQL Server 中默认使用 INT 或 BIGINT。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-13T01:32:55.260

这太大了，因为您永远不会有那么多行。更大的尺寸将导致更多的存储空间。这本身并不是什么大问题，但也意味着更多的磁盘读取以从表或索引中检索数据。这将意味着更少的行将适合数据库服务器上的内存。

我认为它的损坏程度不足以修复它。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-13T02:46:41.663

You'd be better off using a GUID. Really. The normal reason not to use one is that an integer performs better. But GUID is smaller than numeric(38), and has the added benefit of making it a little easier to do thing like let disconnected users create and sync new records.

# open-source - 如何自动化发布开源软件的任务？

> ID：285904
> 
> 赞同：3
> 
> 时间：2008-11-13T00:15:16.680
> 
> 标签：open-source, automation, version, release, versions

每个管理开源软件的人都会遇到问题，随着时间的推移，发布新版本的过程会变得越来越多。您必须在版本控制中标记发布，创建发行版（使用自动构建应该很容易），将它们上传到您的网站和/或开源主机。您必须在选定的网络论坛、sourceforge 上的新闻系统、邮件列表以及您的博客或网站上以几乎相同的信息宣布新版本。你必须更新你的软件在freshmeat上的入口。可能需要为发布完成更多任务。

您是否开发了一些技术来自动化其中一些任务？是否存在支持您的软件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-13T00:24:06.613

对于我的 Perl 内容，我编写了[Module::Release](http://search.cpan.org/dist/Module-Release)。在顶级目录中，我键入一个命令：

```
% release 
```

如果检查几件事，如果有任何问题就死掉。如果一切顺利，它会上传分发。

它使我的整个过程自动化：

*   针对多个版本的 Perl 进行测试
*   测试分发文件
*   检查源代码控制的状态
*   检查代码和分发质量指标
*   更新更改文件
*   确定新版本号
*   将代码发布到多个地方
*   使用新版本号标记源代码控制

不过，每个人似乎都在编写自己的发布自动化程序。大多数人喜欢他们的过程，他们喜欢他们的过程，所以一般的解决方案在社会上并不那么有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-13T00:29:13.093

[Pragmatic Project Automation](http://pragprog.com/titles/auto/pragmatic-project-automation)展示了如何做到这一切。他们几乎将[Ant](http://ant.apache.org/)用于本书中的所有内容，因此如果您了解 Ant，您可以创建不同的目标来执行构建-发布周期中的任何步骤。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-13T01:37:15.203

Brad Fitzpatrick 拥有[ShipIt](http://search.cpan.org/~bradfitz/ShipIt/)，它是一个用于自动发布的 Perl 程序。[他的原始公告](http://brad.livejournal.com/2312693.html)中包含更多信息。

# java - 我错过了什么，还是 varargs 破坏了 Arrays.asList？

> ID：285928
> 
> 赞同：3
> 
> 时间：2008-11-13T00:32:57.813
> 
> 标签：java, generics, variadic-functions

```
 private void activateRecords(long[] stuff) {
    ...
    api.activateRecords(Arrays.asList(specIdsToActivate));
  } 
```

这个对 Arrays.asList 的调用不应该返回一个`Long`s 列表吗？相反，它返回一个`List<long[]>`

```
public static <T> List<T> asList(T... a) 
```

方法签名与结果一致，可变参数将整个数组扔到列表中。它`new ArrayList(); list.add(myArray)` 与 是的，我知道它应该像这样使用：`Arrays.asList(T t1, T t2, T t3)`

我想我得到的是，而不是可变参数形式，为什么我不能只使用我的旧 asList 方法（至少我认为这是它过去的工作方式），它将获取内容并将它们单独放入一个列表？还有其他**干净**的方法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-13T00:42:57.793

那是因为 long[] 和 Long[] 是不同的类型。

在第一种情况下，T 是 long[]，在第二种情况下，T 是 Long。

如何解决这个问题？首先不要使用 long[] 吗？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-13T00:55:58.890

无法对数组进行自动装箱。您可以这样做：

```
private List<Long> array(final long[] lngs) {
    List<Long> list = new ArrayList<Long>();
    for (long l : lngs) {
        list.add(l);
    }
    return list;
} 
```

或者

```
private List<Long> array(final long[] lngs) {
    List<Long> list = new ArrayList<Long>();
    for (Long l : lngs) {
        list.add(l);
    }
    return list;
} 
```

（注意可迭代类型不同）

例如

```
Long l = 1l; 
```

但不是

```
Long[] ls = new long[]{1l} 
```

# python - 在 Python 中使用 Regex Plus 函数进行编码和替换

> ID：285931
> 
> 赞同：0
> 
> 时间：2008-11-13T00:34:43.800
> 
> 标签：python, regex

我正在尝试在 python 中的字符串中替换某些内容，但遇到了一些麻烦。这就是我想做的。

对于我的帖子中的给定评论：

```
"here are some great sites that i will do cool things with! https://stackoverflow.com/it's a pig & http://google.com" 
```

我想用python来制作这样的字符串：

```
"here are some great sites that i will do cool things with! <a href="http://stackoverflow.com">http%3A//stackoverflow.com</a> &amp; <a href="http://google.com">http%3A//google.com</a> 
```

这是我到目前为止所拥有的...

```
import re
import urllib

def getExpandedURL(url)
    encoded_url = urllib.quote(url)
    return "<a href=\"<a href="+url+"\">"+encoded_url+"</a>"

text = '<text from above>'
url_pattern = re.compile('(http.+?[^ ]+', re.I | re.S | re.M)
url_iterator = url_pattern.finditer(text)
for matched_url in url_iterator:
    getExpandedURL(matched_url.groups(1)[0]) 
```

但这就是我卡住的地方。我以前在这里看到过这样的事情：[Regular Expressions but for Writing in the Match](https://stackoverflow.com/questions/140182/regular-expressions-but-for-writing-in-the-match#142188)但肯定有比遍历每个匹配并对其进行位置替换更好的方法。这里的困难在于它不是直接替换，但我需要在替换之前对每场比赛做一些具体的事情。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-13T00:41:36.937

我想你想要`url_pattern.sub(getExpandedURL, text)`。

> re.sub（模式，repl，字符串，count=0）
> 
> 返回通过替换 repl 替换 string 中模式的最左侧非重叠出现而获得的字符串。repl 可以是字符串或可调用对象；如果是可调用的，则传递匹配对象并且必须返回要使用的替换字符串。

# project-management - 您如何将 Scrum 应用于维护和遗留代码改进？

> ID：285933
> 
> 赞同：26
> 
> 时间：2008-11-13T00:35:21.973
> 
> 标签：project-management, scrum

正如标题所暗示的......我如何将scrum流程应用于任何不适用于新代码并且可以在某种程度上进行估计的东西？

当我仍然想计划做事时，如何将 scrum 流程应用于维护和紧急修复（可能需要 5 分钟到 2 周才能修复）类型的环境？

基本上，我如何克服计划外的任务和用 Scrum 流程很难估计的任务？还是我只是在这个环境中应用了错误的过程？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-11-13T06:58:44.027

> 基本上，我如何克服计划外的任务和用 Scrum 流程很难估计的任务？还是我只是在这个环境中应用了错误的过程？

您为此环境使用了错误的过程。您需要的是与您计划/估计的 SCRUM 开发流程分开的堆栈/队列管理流程。

原因很简单，有两个方面：

1.  正如您在帖子中提到的，估计维护任务通常非常困难，尤其是在涉及遗留系统的情况下。一般的维护任务和遗留系统特别倾向于涉及“卷曲”问题，或者有很长的“尾巴”，其中一个看似简单的修复需要对另一个组件进行稍微困难的更改，这反过来又需要对操作进行大修一些子系统，这反过来......你明白了。

2.  很多时候在处理维护任务时，*当您完成估算时，您也已经解决了问题*。这使得估计过程作为规划工具变得多余。那些坚持将估计与解决维护任务的问题分开的人只是增加了不必要的开销。

简而言之，您需要一个排队系统。它将具有以下组件：

*   已被确定为需要注意的任务“池”。新提出的项目应该总是进入池，而不是队列。
*   将这些任务移出池并进入队列的过程。通常需要业务/技术知识的组合。
*   明确排序的任务队列，以便负责为队列提供服务的开发人员可以简单地从队列前面挑选。
*   一种在队列中移动项目的方法（重新划分优先级）。允许为关键/紧急项目“插队”。
*   一种交付已完成项目的方法，不会中断队列的服务。这很重要，因为交付维护项目的开销通常明显低于开发工作。您不希望您的维护团队在每次交付错误修复时都坐等构建和测试团队批准。

队列管理还有其他细微差别，但将这些放在适当的位置应该会让您走上正确的道路。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-11-13T01:12:31.557

如果您的环境中有这么多的流失，那么您的关键将是更短的迭代。我听说过团队进行每日迭代。您还可以转向看板类型样式，其中您有一个具有固定限制（通常非常低，如 2 或 3 个项目）的队列，并且在完成之前不能添加更多项目。

我要做的是尝试一周的迭代，包括每日站立、积压优先级和“完成，完成”。然后在 5 或 6 周后重新评估，看看有什么可以改进的。不要害怕按原样尝试这个过程——一旦你尝试过，不要害怕根据你的环境对其进行调整。

还有一个名为[Agile for Support and Operations in 5 minutes](http://blog.crisp.se/mattiasskarin/files/agileforsupport/kanban_for_support_and_operations.pdf)的 PDF ，最近发布到Yahoo!的[Scrum Development 列表中。](http://groups.yahoo.com/group/scrumdevelopment)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-13T03:42:17.947

没有人说积压项目必须是新代码。维护工作，无论是错误修复、增强还是数据修复，都可以放入产品待办列表中，进行估计和优先排序。这实际上是使用 Scrum 的最大好处之一——不再与用户争论某事是修复错误还是增强。

有了 Waterfall，就有一种默契，即 bug 是开发人员的责任。不知何故，他们有责任在不影响新代码和功能的开发的情况下修复它们。因此，它们对用户来说是“免费的”，但给开发人员带来了巨大的不便。

在 Scrum 中，您认识到所有工作都需要时间。没有“免费”。因此开发人员可以自由地接受某些东西是错误，但它仍然会进入产品待办列表。然后由客户决定修复错误是否比添加新功能更重要。有一些你可以忍受的错误。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-13T08:14:08.163

> 正如标题所暗示的......我如何将scrum流程应用于任何不适用于新代码并且可以在某种程度上进行估计的东西？

相反，我听说团队发现在维护阶段更容易采用 Scrum。因为更改较小（没有大的设计更改），因此更容易估计。任何新的变更请求都会添加到产品积压中，由开发人员估计，然后由产品所有者确定优先级。

> 当我仍然想计划做事时，如何将 scrum 流程应用于维护和紧急修复（可能需要 5 分钟到 2 周才能修复）类型的环境？

如果您暗示灭火类型的活动，请为此类活动保留一部分迭代工作配额。根据历史趋势/活动，您应该可以说，例如，我们每次迭代的速度为 10 个故事点（4 人团队 5 天迭代）。我们每个人每周花大约一天时间应对紧急情况。所以我们应该只为下一次迭代选择 8 点的 backlog 项目是现实的。如果我们没有紧急问题，我们将从优先积压中挑选下一个最重要的项目。
CoryFoy 在他的回复中提到了一种更动态/实时的方法，其中包含看板便利贴。

> 基本上，我如何克服计划外的任务和用 Scrum 流程很难估计的任务？还是我只是在这个环境中应用了错误的过程？

AFAIR Scrum 不强制使用估算技术。使用团队最熟悉的技术。工时/故事点等。我相信，在估算方面做得更好的唯一方法是实践和经验。同一组人坐在一起估计新任务的次数越多，他们的估计就越好。在维护类型的环境中，我会假设它更容易估计，因为该系统或多或少为团队所熟知。如果没有，请安排/使用尖峰以获得更多清晰度。

我感觉你想在这里吃一头大象。我建议以下几口

*   [有效地使用遗留代码](https://rads.stackoverflow.com/amzn/click/com/0131177052)
*   [敏捷估计和计划](https://rads.stackoverflow.com/amzn/click/com/0131479415)
*   [使用 Scrum 进行敏捷项目开发](https://rads.stackoverflow.com/amzn/click/com/0130676349)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-13T00:48:27.750

将所有修复和改进视为单独的故事并进行相应的估计。我个人的观点是，那些需要不到 10 到 15 分钟才能解决的事情应该立即完成。对于那些需要更长的时间，它们成为当前“修复和改进”迭代周期的一部分。与估计常规需求一样，您作为一个团队进行最佳猜测。随着更多信息的曝光，以及估计值的调整，迭代和即将到来的冲刺。

很难将迭代周期应用于修复和改进，因为它们往往会阻止系统按应有的方式工作，并且“业务”会施加压力让它们尽快上线。在这一点上，它可能会更好地转移到一个非常短的迭代周期，比如一两个星期。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-13T01:02:43.323

将所有没有故事的“错误修复”视为新代码。估计它们，并照常工作。通过将它们视为新故事，您将建立一个故事和测试库。只有这样，您才能开始*固定*应用程序的行为。

看看Michael Feathers的*《有效地使用遗留代码》 。*这是一个摘录的链接。[http://www.objectmentor.com/resources/articles/WorkingEffectivelyWithLegacyCode.pdf](http://www.objectmentor.com/resources/articles/WorkingEffectivelyWithLegacyCode.pdf)

-杰森

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-13T01:05:48.263

您询问如何使用流程应对紧急情况。尝试为需要在生产环境中破解代码并同时连接用户的事情保留“紧急”一词。否则，利益相关者可能会滥用这个词，并对他们想要快速处理的任何事情发出紧急情况。缺乏流程并不意味着失控：必须有人负责宣布紧急情况，有人（最佳实践是其他人）必须授权正常流程之外的更改，然后对其负责。

除此之外，使用每次迭代来完成一些修复和改进的建议可能是最好的方法。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-13T01:15:15.077

这在很大程度上取决于应用程序的生命周期。如果这是一个很快就会重试的“日落”应用程序，当然，重点只会放在修复最优先的错误上。

如果产品“成熟”并且有路线图并且正在继续发展，那么您将需要修复和增强功能。通过重构保持设计清洁和发展有很多动力。这可能意味着定期的次要和主要版本 [eFixes - 紧急修复程序/热修复程序除外]。您可以尽情享受敏捷的实践，因为增强和修复可以被载入故事板并成为您的 Sprint 待办事项的一部分。整个列表将成为您的产品待办列表。

底线：如果你想重构并保持你的应用程序设计干净[如果专注于错误修复，程序员往往会走捷径]，它只能发生在一个“活”的应用程序中。一种进化和更新的。敏捷是天作之合。

即使您只有修复（它是图灵完备的；）或 Sunset 应用程序），如果它们都可以被卷入一个 sprint 并在每个 sprint 的生产端卷入，它也会有所帮助。如果修复需要在修复后立即投入生产，那么应用 Scrum 会困难得多。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-13T06:12:14.947

我们在这种情况下应用了 scrum。

一些成功的关键。
1\. 企业中的每个人都购买 Scrum 理念（这对成功**至关重要**
） 2\. 大约 2 周的 Sprint（我们的 2-3 个第一次 sprint 需要 1 周的时间来了解流程）
3\. 在任何情况下都不能加分到当前 sprint 4\. 如果出现真正的紧急情况，停止 sprint，进行回顾并开始新的 sprint。
5\. 花时间进行回顾（有时间分享关于上一个 sprint 并对其进行分析）
6\. 在 sprint 中插入至少一项任务以改进流程（通常添加到回顾中的积压工作中）；这对部队士气有好处，最终你会减少紧急情况。
7\. TIME BOXED 每日站立会议

对于估计，通常你估计得越多，你就会变得越精确。Scrum 的优点是每个程序员都可以选择自己的任务，如果他认为这不切实际，可以设置一个新的估计。如果您在估算方面仍有问题，请让您的团队找到解决方案……您可能会对他们提供的内容感到惊讶。

对于 2 周的修复。如果是原始估计，请将其切成小块。如果你做了一个更乐观的估计（比如说 2-3 天），这个问题应该会成为站立会议中的障碍。也许其他人对如何解决它有想法。您可以决定进行一些结对编程以找到解决方案。有时，只是向其他程序员描述错误对调试有很大帮助。您也可以在 sprint 中的其他任务之后延迟它。这个想法是交付功能齐全的任务。如果你没有时间完全修复它并展示它，即使你完成了 90%（是的！我们知道这意味着什么），你认为它没有在 sprint 中完成。在下一个 sprint 中，您将能够通过正确的时间估计来解决它。

最后，据我了解，Scrum 更多的是关于拥有“工具”来改进您的流程。你从简单的事情开始。你做小迭代。在每次迭代中，您都有一个**FIX TARGET**完成而不是无限的错误列表。因为您从计划中的列表中选择您的任务（反对分配它们），您变得更加投入交付它。通过站立会议，您每天都会看到您的待办事项清单……您希望尊重前一天的参与。通过迭代，您可以花时间互相交谈，并确定哪些方面进展顺利，哪些方面应该改进。您还采取行动改进它并继续做有效的事情。不要害怕改变任何东西，即使是我所说的 ;) / 甚至是 Scrum 本身的任何基础......真正的关键是让 Scrum 适应你的团队需要快乐和高效的东西。一次迭代后您将看不到它，但其中很多......

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-11-13T18:44:12.207

我强烈建议您查看冲刺/迭代会给您带来什么价值。当有足够多的任务需要优先处理，并且当您的利益相关者需要大致了解何时完成某事时，应用它们是有意义的。

在这种情况下，我强烈建议结合三种方法：

*   尽早为下一次迭代安排尽可能多的传入任务
*   使用[昨天的天气](http://agilesoftwaredevelopment.com/blog/pbielicki/predicting-team-velocity-yesterday-weather-method)计划您需要计划多少缓冲区来处理必须立即处理的任务
*   使用非常短的 sprint，以便最大化可以等到至少下一次迭代开始的任务数量

事实上，对于*每个*敏捷/Scrum 项目都是如此，因为它们处于维护模式——添加到现有的工作系统——从迭代 2 开始。

如果迭代不能提供足够的价值，您可能想看看[看板](http://finance.groups.yahoo.com/group/kanbandev/)/排队系统。基本上，当您完成一项任务时，只需从优先任务队列中拉出下一个任务。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-06-23T20:44:01.160

在我看来，这取决于你多久发布一次“真正的”版本。在我们的特定情况下，我们每年发布一个主要版本，并在一年中发布一些次要版本。

这意味着当 sprint 完成时，它不会立即部署到我们的生产服务器上。大多数时候，在我们完成完整的“项目”之前会进行一些冲刺。当然，我们演示了我们的 sprint，并在我们的测试服务器上部署了我们的 sprint。整个“项目”将经历一些端到端的测试，最终将部署到我们的生产服务器 -> 这是一个小版本。我们可能会决定我们不会立即将它部署到我们的生产服务器，例如当它依赖于需要首先升级的其他产品/项目时。然后我们在我们的主要版本中部署它。

但是，当我们的生产服务器出现问题时，可能需要立即采取行动。因此，没有时间向产品所有者询问目标或重要性（如果我们甚至有一个用于解决问题），因为它会阻止我们的客户使用我们的应用程序。在如此紧急的情况下，这类问题不会被放入 Product Backlog 或 sprint 中，而是作为一个单独的项目尽快解决、测试和部署的纯维护任务。

我们如何将它与我们的 Sprint 结合起来？为了让我们的团队成员专注于冲刺，我们决定让我们的员工“选择加入 - 选择退出”团队。这意味着一个或多个人不会成为某个 Sprint 团队的一员，而是可以专注于其他工作，例如这些紧急修复。在下一个 Sprint 中，此人将再次成为团队的一员，其他人将负责紧急呼叫。

另一种选择可能是，我们预计 Sprint 中有 20% 的时间用于“计划外任务”，但这会错误地表明我们可以在 Sprint 中完成的工作量（我们不会有相同数量的紧急修复）每个冲刺）。我们还希望我们的团队成员专注于 Sprint，在 Sprint 中进行这些紧急修复会分散我们的团队成员的注意力。“上下文切换”也意味着时间损失，我们试图避免这种情况。

这完全取决于您的“环境”以及解决紧急问题的速度。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2011-10-21T15:13:29.553

通过认识到 Sprint 的某些部分由需要解决的那些计划外的“火灾”组成，我取得了一些成功。即使在短暂的冲刺中，这些也可能发生。如果开发团队有这些责任，那么在 sprint 计划期间，只有故事被提交给 sprint，为这些其他计划外活动的发生和处理留出足够的空间。如果在 sprint 期间，没有“火”点燃，那么 tam 可以从 backlog 的顶部提取故事。在许多方面，它变成了一个队列。

优点是对积压有承诺。缺点是存在这个能力漏洞，可以作为将团队拖入非关键任务的机会进行交流。如果容量差距被未跟踪的计划外工作所填补，速度也会有很大差异。

我解决部分问题的一种方法是创建一个“支持”故事，用代表团队可以分配给支持活动的可用时间的任务来填充该容量的其余部分。当支持情况进入无法推迟到积压工作的 sprint 时，就会创建一个带有任务的新故事，并重新估计占位符支持故事和任务以解释新的注入。如果支持事件没有进入 sprint，那么随着积压项目的出现以填补未使用的容量，这个支持故事就会减少。

结果是 sprint 保留了一些所需的流程，并且人们觉得当他们需要承担支持工作时他们不会被烧毁。速度更一致，燃尽跟踪正常，但也有每个冲刺发生的支持注入的记录。然后在 sprint 回顾期间，我们可以评估计划内和计划外的工作，如果下一个 sprint 需要采取不同的行动，我们可以这样做。如果这意味着新的 sprint 持续时间，或者与组织中的某人进行有针对性的对话，那么我们就有数据来支持新的决策。

# php - 是否可以插入一行，但前提是值不存在？

> ID：285937
> 
> 赞同：16
> 
> 时间：2008-11-13T00:38:38.927
> 
> 标签：php, mysql

是否可以插入一行，但前提是表中已有的值之一不存在？

我正在为电子商务系统创建一个带有推荐点的*告诉朋友*，我需要将朋友的电子邮件插入到数据库表中，但前提是它不存在于表中。这是因为一旦新客户注册并购买了东西，我不希望超过 1 人获得推荐积分。因此，我只想要一封电子邮件在表格中。

我正在使用 PHP 4 和 MySql 4.1。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2008-11-13T00:58:59.353

如果您在列上有唯一索引或主键（此示例中为 EmailAddr），则此方法有效：

```
INSERT IGNORE INTO Table (EmailAddr) VALUES ('test@test.com') 
```

如果该电子邮件的记录已经存在（重复键违规）而不是错误，则使用此语句，该语句将失败并且没有插入任何内容。

有关更多信息，请参阅[MySql 文档](http://dev.mysql.com/doc/refman/4.1/en/insert.html)。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2008-11-13T00:47:19.547

如果列是主键或唯一索引：

```
INSERT INTO table (email) VALUES (email_address) ON DUPLICATE KEY UPDATE
email=email_address 
```

知道我的运气有一个更好的方法来做到这一点。AFAIK 在 MySQL 中没有相当于“ON DUPLICATE KEY DO NOTHING”的东西。我不确定 email=email_Address 位，您可以玩一下，看看它是否有效，而无需指定操作。正如上面有人所说，如果它有独特的限制，无论如何都不会发生。如果您希望表中的所有电子邮件地址都是唯一的，则没有理由在列定义中将其指定为唯一。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-13T00:52:23.453

很可能是这样的：

```
IF NOT EXISTS(SELECT * FROM myTable WHERE Email=@Email) THEN INSERT INTO blah blah 
```

这可以整合到一个数据库查询中。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-24T03:27:13.280

对 naeblis 的回答稍作修改/补充：

```
INSERT INTO table (email) VALUES (email_address)
ON DUPLICATE KEY UPDATE id=LAST_INSERT_ID(id) 
```

这样你就不必`email=email_address`在那里投入，如果语句更新**，**你会得到正确的值。`LAST_INSERT_ID()`

*来源：* MySQL 文档：12.2.5.3

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-13T00:45:37.710

我不确定我是否得到它，但是一个

```
try {
  mysql_query($sql);
}
catch(Exception $e) {

} 
```

结合 MySQL 中的唯一字段索引？

如果它引发异常，那么您知道您有一个重复的字段。对不起，如果那不能回答你的问题..

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-13T14:22:53.217

MySQL 提供[REPLACE INTO http://dev.mysql.com/doc/refman/5.0/en/replace.html](http://dev.mysql.com/doc/refman/5.0/en/replace.html)：

> REPLACE 的工作方式与 INSERT 完全相同，只是如果表中的旧行与 PRIMARY KEY 或 UNIQUE 索引的新行具有相同的值，则在插入新行之前删除旧行。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-13T00:45:57.897

如果电子邮件字段是主键，则表上的约束将阻止输入重复项。

# python - 分解 HTML 以链接文本和目标

> ID：285938
> 
> 赞同：5
> 
> 时间：2008-11-13T00:38:56.070
> 
> 标签：python, html, regex, beautifulsoup

给定一个 HTML 链接，例如

```
<a href="urltxt" class="someclass" close="true">texttxt</a> 
```

如何隔离 url 和文本？

**更新**

我正在使用 Beautiful Soup，但无法弄清楚如何做到这一点。

我做了

```
soup = BeautifulSoup.BeautifulSoup(urllib.urlopen(url))

links = soup.findAll('a')

for link in links:
    print "link content:", link.content," and attr:",link.attrs 
```

我明白了

```
*link content: None  and attr: [(u'href', u'_redirectGeneric.asp?genericURL=/root    /support.asp')]*  ...
... 
```

为什么我缺少内容？

编辑：按照建议详细说明“卡住”:)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-13T00:40:29.483

使用[美丽的汤](http://crummy.com/software/BeautifulSoup)。自己做比看起来更难，最好使用久经考验的模块。

**编辑：**

我想你想要：

```
soup = BeautifulSoup.BeautifulSoup(urllib.urlopen(url).read()) 
```

顺便说一句，尝试在那里打开 URL 是个坏主意，好像它出错了可能会变得丑陋。

**编辑2：**

这应该向您显示页面中的所有链接：

```
import urlparse, urllib
from BeautifulSoup import BeautifulSoup

url = "http://www.example.com/index.html"
source = urllib.urlopen(url).read()

soup = BeautifulSoup(source)

for item in soup.fetchall('a'):
    try:
        link =  urlparse.urlparse(item['href'].lower())
    except:
        # Not a valid link
        pass
    else:
        print link 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-13T00:48:43.150

这是一个代码示例，显示了获取链接的属性和内容：

```
soup = BeautifulSoup.BeautifulSoup(urllib.urlopen(url))
for link in soup.findAll('a'):
    print link.attrs, link.contents 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-13T01:23:56.947

看起来你有两个问题：

1.  link.content **s**，而不是 link.content
2.  attrs is a dictionary, not a string. It holds key value pairs for each attribute in an HTML element. link.attrs['href'] will get you what you appear to be looking for, but you'd want to wrap that in a check in case you come across an a tag without an href attribute.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-13T00:51:54.530

尽管我认为其他人*可能*正确地指出您使用 Beautiful Soup，但他们*可能*不是，并且使用外部库可能会大大超出您的目的。这是一个正则表达式，可以满足您的要求。

```
/<a\s+[^>]*?href="([^"]*)".*?>(.*?)<\/a>/ 
```

这是它的匹配项：

```
'<a href="url" close="true">text</a>'
// Parts: "url", "text"

'<a href="url" close="true">text<span>something</span></a>'
// Parts: "url", "text<span>something</span>" 
```

*如果您*只想获取文本（例如：上面第二个示例中的“textsomething”），我只需在其上运行另一个正则表达式以去除尖括号之间的任何内容。

# nhibernate - 使用带有输出参数的 NHibernate

> ID：285952
> 
> 赞同：6
> 
> 时间：2008-11-13T00:45:34.090
> 
> 标签：nhibernate, stored-procedures

有谁知道 NHibernate 是否支持从存储过程返回输出参数？我已经在文档中进行了搜索，但实际上找不到任何可以确认的内容。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-18T19:52:39.773

我面临着同样的问题。NHibernate 不允许您以这种方式使用存储过程。但它确实允许使用普通的旧 ADO.NET API 进行调用。这是一个例子 -

[http://refactoringaspnet.blogspot.com/2009/06/how-to-use-legacy-stored-procedures-in.html](http://refactoringaspnet.blogspot.com/2009/06/how-to-use-legacy-stored-procedures-in.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-28T02:29:49.303

我无法正式为您*确认*，但据我所知，不能直接确认。NHibernate 中使用的存储过程非常特定于执行标准 CRUD。

如果您想获取输出参数（这不是 INSERT、UPDATE 和 DELETE 的标准行计数输出参数），您可以回退到另一个（或标准）数据库访问工具，让您可以直接访问 SQL 和结果集。（假设您可以绕过 NHibernate 的缓存。您需要确保在运行查询之前刷新 NHibernate，等等。）

# java - Java - 获取目录中的最新文件？

> ID：285955
> 
> 赞同：48
> 
> 时间：2008-11-13T00:46:06.040
> 
> 标签：java, file-io, filesystems

是否有人拥有可以返回目录中最新文件的 Java 片段（或了解简化此类事情的库）？

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2008-11-13T01:13:52.240

以下代码返回最后修改的文件或文件夹：

```
public static File getLastModified(String directoryFilePath)
{
    File directory = new File(directoryFilePath);
    File[] files = directory.listFiles(File::isFile);
    long lastModifiedTime = Long.MIN_VALUE;
    File chosenFile = null;

    if (files != null)
    {
        for (File file : files)
        {
            if (file.lastModified() > lastModifiedTime)
            {
                chosenFile = file;
                lastModifiedTime = file.lastModified();
            }
        }
    }

    return chosenFile;
} 
```

请注意，`Java 8`由于 lambda 表达式，它需要或更新。

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2015-06-17T13:24:24.070

在 Java 8 中：

```
Path dir = Paths.get("./path/somewhere");  // specify your directory

Optional<Path> lastFilePath = Files.list(dir)    // here we get the stream with full directory listing
    .filter(f -> !Files.isDirectory(f))  // exclude subdirectories from listing
    .max(Comparator.comparingLong(f -> f.toFile().lastModified()));  // finally get the last file using simple comparator by lastModified field

if ( lastFilePath.isPresent() ) // your folder may be empty
{
    // do your code here, lastFilePath contains all you need
} 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2012-09-09T08:21:03.770

这对我来说非常好：

```
import org.apache.commons.io.FileUtils;
import org.apache.commons.io.comparator.LastModifiedFileComparator;
import org.apache.commons.io.filefilter.WildcardFileFilter;

...

/* Get the newest file for a specific extension */
public File getTheNewestFile(String filePath, String ext) {
    File theNewestFile = null;
    File dir = new File(filePath);
    FileFilter fileFilter = new WildcardFileFilter("*." + ext);
    File[] files = dir.listFiles(fileFilter);

    if (files.length > 0) {
        /** The newest file comes first **/
        Arrays.sort(files, LastModifiedFileComparator.LASTMODIFIED_REVERSE);
        theNewestFile = files[0];
    }

    return theNewestFile;
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-08-16T10:51:48.783

```
private File getLatestFilefromDir(String dirPath){
    File dir = new File(dirPath);
    File[] files = dir.listFiles();
    if (files == null || files.length == 0) {
        return null;
    }

    File lastModifiedFile = files[0];
    for (int i = 1; i < files.length; i++) {
       if (lastModifiedFile.lastModified() < files[i].lastModified()) {
           lastModifiedFile = files[i];
       }
    }
    return lastModifiedFile;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-13T01:05:20.620

就像是：

```
import java.io.File;
import java.util.Arrays;
import java.util.Comparator;

public class Newest {
    public static void main(String[] args) {
        File dir = new File("C:\\your\\dir");
        File [] files  = dir.listFiles();
        Arrays.sort(files, new Comparator(){
            public int compare(Object o1, Object o2) {
                return compare( (File)o1, (File)o2);
            }
            private int compare( File f1, File f2){
                long result = f2.lastModified() - f1.lastModified();
                if( result > 0 ){
                    return 1;
                } else if( result < 0 ){
                    return -1;
                } else {
                    return 0;
                }
            }
        });
        System.out.println( Arrays.asList(files ));
    }
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-09-01T09:12:15.877

```
public File getLastDownloadedFile() {
    File choice = null;
    try {
        File fl = new File("C:/Users/" + System.getProperty("user.name")
                + "/Downloads/");
        File[] files = fl.listFiles(new FileFilter() {
            public boolean accept(File file) {
                return file.isFile();
            }
        });
//Sleep to download file if not required can be removed
        Thread.sleep(30000);
        long lastMod = Long.MIN_VALUE;

        for (File file : files) {
            if (file.lastModified() > lastMod) {
                choice = file;
                lastMod = file.lastModified();
            }
        }
    } catch (Exception e) {
        System.out.println("Exception while getting the last download file :"
                + e.getMessage());
    }
    System.out.println("The last downloaded file is " + choice.getPath());
    System.out.println("The last downloaded file is " + choice.getPath(),true);
    return choice;
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-04-07T17:40:41.517

这将返回最近创建的文件，我这样做是因为在某些情况下创建文件时，它可能并不总是具有正确的修改日期。

```
import java.nio.file.Files;
import java.nio.file.attribute.BasicFileAttributes;
import java.nio.file.attribute.FileTime;

private File lastFileCreated(String dir) {
    File fl = new File(dir);
    File[] files = fl.listFiles(new FileFilter() {
        public boolean accept(File file) {
            return true;
        }
    });

    FileTime lastCreated = null;
    File choice = null;

    for (File file : files) {
        BasicFileAttributes attr=null;
        try {
            attr = Files.readAttributes(file.toPath(), BasicFileAttributes.class);
        }catch (Exception e){
            System.out.println(e);
        }

        if(lastCreated ==null)
            lastCreated = attr.creationTime();

        if (attr!=null&&attr.creationTime().compareTo(lastCreated)==0) {
            choice = file;
        }
    }
    return choice;
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-07-13T17:40:31.970

这是对 Jose 代码的一个小修改，可确保文件夹中至少有 1 个文件。在我的应用程序中工作很棒！

```
public static File lastFileModified(String dir) {
        File fl = new File(dir);
        File choice = null;
        if (fl.listFiles().length>0) {
            File[] files = fl.listFiles(new FileFilter() {
                public boolean accept(File file) {
                    return file.isFile();
                }
            });
            long lastMod = Long.MIN_VALUE;

            for (File file : files) {
                if (file.lastModified() > lastMod) {
                    choice = file;
                    lastMod = file.lastModified();
                }
            }
        }
        return choice;
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-05-31T22:47:19.420

这段代码很适合我：

```
public String pickLatestFileFromDownloads() {

        String currentUsersHomeDir = System.getProperty("user.home");

        String downloadFolder = currentUsersHomeDir + File.separator + "Downloads" + File.separator;

        File dir = new File(downloadFolder);
        File[] files = dir.listFiles();
        if (files == null || files.length == 0) {
            testLogger.info("There is no file in the folder");
        }

        File lastModifiedFile = files[0];
        for (int i = 1; i < files.length; i++) {
            if (lastModifiedFile.lastModified() < files[i].lastModified()) {
                lastModifiedFile = files[i];
            }
        }
        String k = lastModifiedFile.toString();

        System.out.println(lastModifiedFile);
        Path p = Paths.get(k);
        String file = p.getFileName().toString();
        return file;

    }

//PostedBy: saurabh Gupta Aricent-provar 
```

# java - 如何避免，那个 URL.equals 需要在 Java 中访问互联网？

> ID：285960
> 
> 赞同：12
> 
> 时间：2008-11-13T00:49:00.963
> 
> 标签：java, url, dns, equals, equality

`equals()`Java 类库中 URL 类的方法发出 DNS 请求以获取主机名的 IP，以检查两个 IP 是否相等。即使是从相同的`String`. 有没有办法避免这种互联网访问？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-11-13T00:58:13.973

使用[java.net.URI](http://docs.oracle.com/javase/8/docs/api/java/net/URI.html)而不是 URL。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-13T00:58:01.553

如果您只想比较 url 字符串，请尝试

```
url1.toString().equals(url2.toString()) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-13T00:53:17.210

不要使用 URL.equals。正如文件所说，

> 注意：已知定义的行为`equals`与 HTTP 中的虚拟主机不一致。

# iis - 如何在 IIS 中续订 SSL 证书数年？

> ID：285971
> 
> 赞同：0
> 
> 时间：2008-11-13T00:56:18.657
> 
> 标签：iis, ssl

续订向导似乎没有要求续订期。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-13T01:41:05.850

我认为证书供应商设置了更新期限。因此，这取决于您购买的证书类型（或您的认证服务的设置）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-13T05:48:21.203

您购买/创建的证书的到期日期将定义

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-12-14T16:42:15.550

最后，我检查了尝试使用任何有效期超过一年的证书都会导致客户拒绝它。

# xml - 通过构造对象模型解析 XML 文件

> ID：285972
> 
> 赞同：0
> 
> 时间：2008-11-13T00:56:55.660
> 
> 标签：xml, code-generation, xsd, xsd.exe

我一直更喜欢使用 XSD.exe/VS.Net 生成架构，生成架构外的类，将 xml 文件反序列化为对象树以解析 XML 文件。[嗯，到目前为止，我的大部分要求都使它成为一个完美的选择]。

不过我有一个婴儿床：XSD.exe 生成的类名很奇怪——这意味着 XSD.exe 努力通过连接所有前面的祖先标记名来保持它们的唯一性。

有没有办法可以自定义这个？或者也许是在此之上运行的工具？

我的动机是保持*自动生成的*代码不受侵犯。

想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-13T01:39:44.513

听起来好像是自动生成的架构导致了问题。我已经使用了 XSD.exe 的类生成部分，并且该类通常很好。

如果模式是自动生成的，那么它可能需要手动进行一些调整以更正疯狂的节点名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-07-27T14:04:28.647

我真的开始希望有一种简单的方法来改变 xsd.exe 的输出，而无需求助于黑客代码......似乎只是一个“需要发生”的项目......

# python - 通过 XPath 解析 HTML

> ID：285990
> 
> 赞同：28
> 
> 时间：2008-11-13T01:05:59.930
> 
> 标签：python, html, ruby, xpath, parsing

在 .Net 中，我发现了这个很棒的库[HtmlAgilityPack](http://www.codeplex.com/htmlagilitypack)，它允许您使用 XPath 轻松解析格式不正确的 HTML。我已经在我的 .Net 站点中使用了几年，但我不得不为我的 Python、Ruby 和其他项目适应更痛苦的库。有人知道其他语言的类似库吗？

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2011-01-20T12:24:30.303

我很惊讶没有提到lxml。它速度极快，可以在任何允许 CPython 库的环境中工作。

以下是[使用 lxml 通过 XPATH 解析 HTML](http://codespeak.net/lxml/xpathxslt.html)的方法。

```
>>> from lxml import etree
>>> doc = '<foo><bar></bar></foo>'
>>> tree = etree.HTML(doc)

>>> r = tree.xpath('/foo/bar')
>>> len(r)
1
>>> r[0].tag
'bar'

>>> r = tree.xpath('bar')
>>> r[0].tag
'bar' 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-14T03:37:03.740

在 python 中，[ElementTidy](http://pypi.python.org/pypi/elementtidy/1.0-20050212)解析标签汤并生成一个元素树，它允许使用 XPath 进行查询：

```
>>> from elementtidy.TidyHTMLTreeBuilder import TidyHTMLTreeBuilder as TB
>>> tb = TB()
>>> tb.feed("<p>Hello world")
>>> e= tb.close()
>>> e.find(".//{http://www.w3.org/1999/xhtml}p")
<Element {http://www.w3.org/1999/xhtml}p at 264eb8> 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-02-25T04:17:56.950

我得到的最稳定的结果是使用lxml.html 的soupparser。您需要安装 python-lxml 和 python-beautifulsoup，然后您可以执行以下操作：

```
from lxml.html.soupparser import fromstring
tree = fromstring('<mal form="ed"><html/>here!')
matches = tree.xpath("./mal[@form=ed]") 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-13T02:32:56.667

[BeautifulSoup](http://www.crummy.com/software/BeautifulSoup/)是一个很好的 Python 库，用于以简洁的方式处理混乱的 HTML。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-13T03:57:23.003

似乎这个问题可以更准确地表述为“*如何将 HTML 转换为 XML，以便可以针对它评估 XPath 表达式*”。

这里有两个很好的工具：

1.  [**TagSoup**](http://home.ccil.org/~cowan/XML/tagsoup/)是一个开源程序，是一个基于 Java 和 SAX 的工具，由[**John Cowan**](http://home.ccil.org/~cowan/)开发。这是一个用 Java 编写的符合 SAX 的解析器，它不是解析格式良好或有效的 XML，而是解析在野外发现的 HTML：糟糕、肮脏和野蛮，尽管通常很不短。TagSoup 是为那些必须使用某种看似合理的应用程序设计来处理这些东西的人设计的。通过提供 SAX 接口，它允许将标准 XML 工具应用于甚至最糟糕的 HTML。TagSoup 还包括一个命令行处理器，它可以读取 HTML 文件，并且可以生成干净的 HTML 或与 XHTML 非常接近的格式良好的 XML。
    [Taggle](http://www.jezuk.co.uk/arabica/log?id=3591)是 TagSoup 的商业 C++ 端口。

2.  [**SgmlReader**](http://code.msdn.microsoft.com/SgmlReader)是微软的[**Chris Lovett**](http://www.lovettsoftware.com/)开发的一个工具。
    SgmlReader 是任何 SGML 文档（包括对 HTML 的内置支持）的 XmlReader API。还提供了一个命令行实用程序，用于输出格式良好的 XML 结果。
    下载包含独立可执行文件和完整源代码的 zip 文件： [**SgmlReader.zip**](http://code.msdn.microsoft.com/SgmlReader/Release/ProjectReleases.aspx?ReleaseId=1442)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-14T01:31:31.807

对于 Ruby，我强烈推荐 Jb Evain 指出的 Hpricot。如果您正在寻找更快的基于 libxml 的竞争对手，Nokogiri（参见[http://tenderlovemaking.com/2008/10/30/nokogiri-is-released/](http://tenderlovemaking.com/2008/10/30/nokogiri-is-released/)）也非常好（它支持 XPath 和 CSS 搜索，例如Hpricot 但更快）。有一个基本的[wiki](http://github.com/tenderlove/nokogiri/wikis)和一些[基准](http://gist.github.com/22176)。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-14T01:42:04.783

有一个用于 XML 的免费 C 实现，称为 libxml2，它有一些用于 XPath 的 api 位，我已经非常成功地使用了这些位，您可以将 HTML 指定为正在加载的文档。这对我来说适用于一些不太完美的 HTML 文档..

在大多数情况下，当入站 HTML 编码正确并且可以“像 xml 文档”一样阅读时，XPath 最有用。您可能需要考虑使用专门用于此目的的实用程序来清理 HTML 文档。这是一个例子：[http ://tidy.sourceforge.net/](http://tidy.sourceforge.net/)

就这些 XPath 工具而言，您可能会发现大多数实现实际上是基于预先存在的 C 或 C++ 库，例如 libxml2。

# c# - 开发 WPF 应用程序 - 任何方式来优化 .NET 安装？

> ID：285997
> 
> 赞同：3
> 
> 时间：2008-11-13T01:12:38.857
> 
> 标签：c#, .net

我很想将 WPF 用于消费者应用程序。然而，一些现实世界的测试并不是很令人鼓舞。在我测试过的几台高端计算机上，.NET 3.5 安装需要 15-20 分钟才能完成。我看过网上的报道提到50分钟。

当 Vista 的市场份额达到 70% 时，这个话题就没有实际意义了。在那之前，现实情况是大多数消费者都在使用 XP 并且需要安装 .NET 3.5。为消费者应用程序的安装增加 15-20 分钟（最多）是完全不可接受的。

1) .NET 安装程序需要这么长时间是为了什么？

2) 有没有办法优化.NET 安装？

哦，我知道 .NET 客户端配置文件。情况并没有太大改善。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-13T01:28:43.583

.Net 框架会在 PC 上安装大量文件，如果您使用的是在线版本，其中许多文件都是从 Internet 下载的。您应该做的是为您的程序提供完整的 .Net 框架安装程序。如果您在 CD 上分发它，那么 197 MB 的文件应该不是什么大问题。

这个文件应该在 3-4 分钟内安装框架，因为它不需要下载任何东西。这是文件的链接：http: [//download.microsoft.com/download/6/0/f/60fc5854-3cb8-4892-b6db-bd4f42510f28/dotnetfx35.exe](http://download.microsoft.com/download/6/0/f/60fc5854-3cb8-4892-b6db-bd4f42510f28/dotnetfx35.exe)

我认为您无法更改基本安装时间（无论是 1 分钟还是 10 分钟）。如果您真的想做某事，那么只有一种选择（据我所知）。购买一个将在可执行文件中包含 .Net 的 EXE 打包程序，并创建一个虚拟环境。有一个叫做 Xenocode ( [http://www.xenocode.com/](http://www.xenocode.com/) )，可以做到这一点。

希望这有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-13T01:19:45.333

我相信客户档案是最好的。我很惊讶听到它没有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-13T01:19:38.297

1.  它很大。
2.  使用 MS 提供的网络安装是最好的，因为它只安装它需要的东西（但那仍然很大）

唯一的选择是只检测它不存在并警告用户并要求他们安装它。只有第一个 3.5 应用程序受到影响。所有其他人都会很快。

显然，随着时间的推移，所有受支持的操作系统都将使用 Windows 更新和服务包等推出。

# visual-studio-2008 - Vista 下 Visual Studio 2008 的 Permission Denied 错误

> ID：285999
> 
> 赞同：1
> 
> 时间：2008-11-13T01:13:19.543
> 
> 标签：visual-studio-2008, windows-vista, file-permissions

我已经冒险从 WinXP 升级（或者降级了？！）到 Vista。

一切似乎都正常，除了今天早上我启动机器并在 Visual Studio 中打开我的 C# 应用程序时，我收到了一些“加载属性‘OutputPath’失败。输入的路径不是有效的输出路径”错误。

我尝试重建应用程序，发现由于某种神秘的原因，我无法访问 Visual Studio 创建的可执行文件。解决方案中的其他所有内容仍然是我的，但编译结果不是。在某些情况下，“管理员”拥有它们，在某些情况下，我仍然拥有它们，但没有任何权利。

我以管理员身份运行，因此被拒绝访问我自己创建的自己的文件有点令人恼火。

我是否错过了 Visual Studio 和 Vista 一起玩的方式，或者我擦机并再烧两天重新安装 WinXP？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-13T01:31:51.937

在我的头顶上：

1.  禁用用户访问控制。
2.  确保您没有将可执行文件签入源代码管理（它们可能是只读的）:)

编辑：我的 Vista x64 机器上的一些问题也让我感到困惑[我也以管理员身份运行]。禁用 UAC 摆脱了这个“管理员”，但不是管理员问题：D

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-26T08:49:13.963

打开您的 .csproj 文件并确保您的输出路径 C:\test\ 正确，以便再检查一个位置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-13T01:23:54.530

哦..这是一个很酷的=D

您是否尝试过更改输出路径？

好吧，在“解决方案资源管理器”中单击您项目上的右键。继续属性，在 Build 选项卡中。在那里你可以尝试解决一些问题..

VS2008是个很奇怪的东西，因为它是为了在Vista中运行而开发的！=D

祝你好运！****``