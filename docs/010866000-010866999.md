# StackOverflow 问答 10866000-10866999

# java - 如何在android中恢复到sms.db的sms备份

> ID：10866001
> 
> 赞同：1
> 
> 时间：2012-06-02T21:14:25.113
> 
> 标签：java, android

我已经备份了收件箱中的所有短信。之后，我将备份以 JSON 格式存储在 SD 卡中，创建了一个文件 SMSJSON.txt。现在我正在从 SD 卡读取文件并成功解析数据，但是如何将这些数据再次写入 sms.db 。请指导我。提前致谢...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T19:40:42.217

```
public boolean restoreSms(Sms obj) {
    boolean ret = false;
    try {
        ContentValues values = new ContentValues();
        values.put("address", obj.getAddress());
        values.put("body", obj.getMsg());
        values.put("read", obj.getReadState());
        values.put("date", obj.getTime());
        Uri temp_sms = mActivity.getContentResolver().insert(
                Uri.parse("content://sms/" + obj.getFolderName()), values);
        ret = true;
    } catch (Exception ex) {
        ret = false;
    }
    return ret;
} 
```

在 AndroidManifest 中使用此权限

```
<uses-permission android:name="android.permission.WRITE_SMS"/> 
```

# python - pygame.Rect 围绕圆圈

> ID：10866003
> 
> 赞同：1
> 
> 时间：2012-06-02T21:14:49.157
> 
> 标签：python, pygame

我正在尝试在 pygame 中制作乒乓球游戏，但我不知道如何制作一个球圈，我可以使用 pygame.draw.circle 创建一个 pygame.Rect 对象，这样我就可以使用 colliderect 函数和操纵球的位置。例如，对于矩形，我可以这样做：

```
rect = pygame.Rect(255, 255, 100, 100)
pygame.draw.rect(screen, yellow, rect) 
```

然后当我改变 pygame.Rect 对象位置时，绘图图元的位置也会改变。当我想画一个圆形而不是一个矩形时，如何达到同样的效果？谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-02T22:53:32.297

[http://pygame.org/docs/ref/draw.html#pygame.draw.circle](http://pygame.org/docs/ref/draw.html#pygame.draw.circle)

"**`pygame.draw.circle`**

*围绕一个点画一个圆*

`pygame.draw.circle(Surface, color, pos, radius, width=0): return Rect`"

如果你这样做：

```
circleRect = pygame.draw.circle(windowSurface, (0,0,0), (10, 10), 5) 
```

Pygame 会给你圆所在的矩形，你可以操纵它。

我希望这对您有所帮助，并祝您好运。

# linux - 如何预填充命令行输入

> ID：10866005
> 
> 赞同：8
> 
> 时间：2012-06-02T21:15:27.190
> 
> 标签：linux, bash

我正在运行一个 bash 脚本，我想在执行脚本后用一些命令预填充命令行。唯一的条件是脚本当时不能运行。

我需要的是...

1.  运行脚本
2.  脚本停止后在我的命令行中预填充了文本

甚至可能吗？我所尝试的只是使用模拟 bash 脚本

```
read -e -i "$comm" -p "[$USER@$HOSTNAME $PWD]$ " input
command $input 
```

但我正在寻找更直接的东西。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-02T21:30:29.473

您需要使用 TIOCSTI ioctl。这是一个示例 C 程序，它显示了它是如何工作的：

```
#include <sys/ioctl.h>

main()
{
    char buf[] = "date";
    int i;
    for (i = 0; i < sizeof buf - 1; i++)
      ioctl(0, TIOCSTI, &buf[i]);
    return 0;
} 
```

编译并运行它，“日期”将作为输入缓冲到标准输入，程序退出后你的 shell 将读取它。您可以将其汇总为一个命令，该命令允许您将任何内容填充到输入流中，并在您的 bash 脚本中使用该命令。

# internet-explorer - IE 剥离锚标记的问题

> ID：10866006
> 
> 赞同：1
> 
> 时间：2012-06-02T21:15:31.413
> 
> 标签：internet-explorer, url, rewrite, anchor

我正在构建一个包含带有子菜单项的菜单的站点。我的两个子菜单项链接到我的一个页面中的锚标记。在 FF 和 Chrome 中，它们按预期工作，但在任何版本的 IE 中，锚标记都被从 URL 中剥离，因此我的 javascript 失败了。我正在使用锚标记来确定应该打开哪个手风琴列表。

例如，假设我有[http](http://www.sellingsickness.com/about/#organizers) ://www. sellsickness.com/about/#organizers ，IE 将其呈现为[http:](http://www.sellingsickness.com/about/) //www. sellsickness.com/about/ 。

该网站的链接是[http](http://www.sellingsickness.com/) ://www. sellsickness.com/，主播位于关于：组织者和指导委员会。

这是一个使用 postname rewrite 的 wordpress 网站。

在 .htaccess 我有：

```
# BEGIN WordPress
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f 
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule>

# END WordPress 
```

和我的 HTML：

jQuery 根据锚标签打开适当的手风琴：

```
<script type="text/javascript">
jQuery(document).ready(function($) {
 var currentHref = window.location.href;
 var anchorLink = currentHref.split("#");
 var accId = anchorLink[1];
  $("div#"+accId+"").parent().addClass('su-spoiler-open');
 document.getElementById(accId).style.display = "block"; 
 });
</script> 
```

# c# - 如何用链接服务器连接两个表

> ID：10866013
> 
> 赞同：0
> 
> 时间：2012-06-02T21:16:39.647
> 
> 标签：c#, mysql, database

我需要连接来自 2 个不同服务器的 2 个表。

我怎么能在 C# 中做到这一点？

这是我到目前为止所拥有的：

```
cmd = new MySqlCommand(String.Format("INSERT INTO {0} (a,b,c,d) SELECT (a,b,c,d) FROM {1}", ConfigSettings.ReadSetting("main_table"), ConfigSettings.ReadSetting("main_table")), con); 
```

`ConfigSettings.ReadSetting("main_table")`因为他们两个是一样的。

```
 con.ConnectionString = ConfigurationManager.ConnectionStrings["con1"].ConnectionString;
 con2.ConnectionString = ConfigurationManager.ConnectionStrings["con2"].ConnectionString 
```

如何使此 cmd 与 2 个不同的连接字符串和表的相同名称一起工作。表名会改变，这就是它保存在配置中的原因。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-02T21:24:12.840

`MySQL`无法动态链接服务器。

如果要在数据库之间直接复制，则需要`FEDERATED`在目标服务器上创建一个指向源服务器的表，然后发出以下命令：

```
INSERT
INTO    main_table (a, b, c, d)
SELECT  a, b, c, d
FROM    federated_main_table 
```

在目标服务器上。

如果您有多个源服务器和/或表，您应该为它们中的每一个创建一个联合表。

另一种选择是将源服务器中的所有数据选择到客户端（放入数组、持久记录集等），然后将缓存在客户端上的数据插入目标服务器上的表中。

# android - 在 SQLite 中查找记录时的 FC

> ID：10866014
> 
> 赞同：1
> 
> 时间：2012-06-02T21:16:49.620
> 
> 标签：android, sqlite

我有几种方法可以在我的应用程序中获取记录
但出于某种原因，这个方法一直给我 FC ！我正在使用以下方法来获取 Cursor ：

```
Cursor c=helper.getRecordById(num); 
```

其实现如下：

```
public Cursor getRecordById(int rowId) {
    String rowIDs=""+rowId;
    String SelectById = "SELECT id, OrderName, OrderLink, DateYear, DateMonth, DateDay, OrderPrice FROM Orders WHERE id=?";
    String[] args={rowIDs};
    return(getReadableDatabase().rawQuery(SelectById, args));
} 
```

我也尝试过不将 Int 转换为 String 但我只是这样离开它.. 两种方式都会出现相同的错误。

每当我到达以下行时：

```
String name=c.getString(c.getColumnIndexOrThrow("OrderName")); 
```

我得到了FC。GetColumnIndex 工作得很好......我已经专门测试过它。但是 getString 会引发错误。：

```
06-02 21:07:13.656: W/KeyCharacterMap(4329): Using default keymap: /system/usr/keychars/qwerty.kcm.bin
06-02 21:07:16.006: D/AndroidRuntime(4329): Shutting down VM
06-02 21:07:16.006: W/dalvikvm(4329): threadid=1: thread exiting with uncaught exception (group=0x4001d800)
06-02 21:07:16.026: E/AndroidRuntime(4329): FATAL EXCEPTION: main
06-02 21:07:16.026: E/AndroidRuntime(4329): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.Sagi.MyOrders/com.Sagi.MyOrders.DisplayRecord}: android.database.CursorIndexOutOfBoundsException: Index -1 requested, with a size of 0
06-02 21:07:16.026: E/AndroidRuntime(4329):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2663)
06-02 21:07:16.026: E/AndroidRuntime(4329):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
06-02 21:07:16.026: E/AndroidRuntime(4329):     at android.app.ActivityThread.access$2300(ActivityThread.java:125)
06-02 21:07:16.026: E/AndroidRuntime(4329):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
06-02 21:07:16.026: E/AndroidRuntime(4329):     at android.os.Handler.dispatchMessage(Handler.java:99)
06-02 21:07:16.026: E/AndroidRuntime(4329):     at android.os.Looper.loop(Looper.java:123)
06-02 21:07:16.026: E/AndroidRuntime(4329):     at android.app.ActivityThread.main(ActivityThread.java:4627)
06-02 21:07:16.026: E/AndroidRuntime(4329):     at java.lang.reflect.Method.invokeNative(Native Method)
06-02 21:07:16.026: E/AndroidRuntime(4329):     at java.lang.reflect.Method.invoke(Method.java:521)
06-02 21:07:16.026: E/AndroidRuntime(4329):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
06-02 21:07:16.026: E/AndroidRuntime(4329):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
06-02 21:07:16.026: E/AndroidRuntime(4329):     at dalvik.system.NativeStart.main(Native Method)
06-02 21:07:16.026: E/AndroidRuntime(4329): Caused by: android.database.CursorIndexOutOfBoundsException: Index -1 requested, with a size of 0
06-02 21:07:16.026: E/AndroidRuntime(4329):     at android.database.AbstractCursor.checkPosition(AbstractCursor.java:580)
06-02 21:07:16.026: E/AndroidRuntime(4329):     at android.database.AbstractWindowedCursor.checkPosition(AbstractWindowedCursor.java:214)
06-02 21:07:16.026: E/AndroidRuntime(4329):     at android.database.AbstractWindowedCursor.getString(AbstractWindowedCursor.java:41)
06-02 21:07:16.026: E/AndroidRuntime(4329):     at com.Sagi.MyOrders.DisplayRecord.onCreate(DisplayRecord.java:48)
06-02 21:07:16.026: E/AndroidRuntime(4329):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
06-02 21:07:16.026: E/AndroidRuntime(4329):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2627)
06-02 21:07:16.026: E/AndroidRuntime(4329):     ... 11 more
06-02 21:12:16.126: I/Process(4329): Sending signal. PID: 4329 SIG: 9 
```

**有趣的是我复制了我在另一个地方使用的完全相同的查找方法，它工作得很好！我什至尝试给它一个常量来查找我知道存在的只是为了检查。但什么都没有。一遍又一遍的错误！**

**谢谢 ！！！**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-02T21:21:07.467

A`Cursor`最初指向开始前的一条记录，以允许这种代码：

```
final Cursor cursor = /* get cursor */;
while(cursor.moveToNext()) {
    /* do something with cursor */
} 
```

如果您只期待一条记录，并且您确定会有一条记录，那么在访问之前`Cursor`：

```
cursor.moveToNext(); 
```

或者：

```
cursor.moveToFirst(); 
```

# c# - 将行添加到数据库中，获取 id 并填充第二个表

> ID：10866016
> 
> 赞同：3
> 
> 时间：2012-06-02T21:16:50.627
> 
> 标签：c#, asp.net, sql-server-2008, insert

我不擅长 .NET，但正在学习（至少尝试学习！;)）。但是，我正在编写的这段代码让我感到困惑。我想要做的是在名为 的 SQL Server 2008 数据库表`Comment`中插入一行，然后使用此插入行的 id`CommentOtherAuthor`用新的数据行填充第二个表 ( )。基本上，一条评论可以有多个作者。

这是代码：

```
public static Comment MakeNew(int parentNodeId, string firstname, string surname, string occupation, string affiliation, string title, string email, bool publishemail, bool competinginterests, string competingintereststext, string[] otherfirstname, string[] othersurname, string[] otheroccupation, string[] otheraffiliation, string[] otheremail, bool approved, bool spam, DateTime created, string commentText, int statusId)
{
        var c = new Comment
            {
                ParentNodeId = parentNodeId,
                FirstName = firstname,
                Surname = surname,
                Occupation = occupation,
                Affiliation = affiliation,
                Title = title,
                Email = email,
                PublishEmail = publishemail,
                CompetingInterests = competinginterests,
                CompetingInterestsText = competingintereststext,
                OtherFirstName = otherfirstname,
                OtherSurname = othersurname,
                OtherOccupation = otheroccupation,
                OtherAffiliation = otheraffiliation,
                OtherEmail = otheremail,
                Approved = approved,
                Spam = spam,
                Created = created,
                CommenText = commentText,
                StatusId = statusId
            };

        var sqlHelper = DataLayerHelper.CreateSqlHelper(umbraco.GlobalSettings.DbDSN);

        c.Id = sqlHelper.ExecuteScalar<int>(
            @"insert into Comment(mainid,nodeid,firstname,surname,occupation,affiliation,title,email,publishemail,competinginterests,competingintereststext,comment,approved,spam,created,statusid) 
                values(@mainid,@nodeid,@firstname,@surname,@occupation,@affiliation,@title,@email,@publishemail,@competinginterests,@competingintereststext,@comment,@approved,@spam,@created,@statusid)",
            sqlHelper.CreateParameter("@mainid", -1),
            sqlHelper.CreateParameter("@nodeid", c.ParentNodeId),
            sqlHelper.CreateParameter("@firstname", c.FirstName),
            sqlHelper.CreateParameter("@surname", c.Surname),
            sqlHelper.CreateParameter("@occupation", c.Occupation),
            sqlHelper.CreateParameter("@affiliation", c.Affiliation),
            sqlHelper.CreateParameter("@title", c.Title),
            sqlHelper.CreateParameter("@email", c.Email),
            sqlHelper.CreateParameter("@publishemail", c.PublishEmail),
            sqlHelper.CreateParameter("@competinginterests", c.CompetingInterests),
            sqlHelper.CreateParameter("@competingintereststext", c.CompetingInterestsText),
            sqlHelper.CreateParameter("@comment", c.CommenText),
            sqlHelper.CreateParameter("@approved", c.Approved),
            sqlHelper.CreateParameter("@spam", c.Spam),
            sqlHelper.CreateParameter("@created", c.Created),
            sqlHelper.CreateParameter("@statusid", c.StatusId));

        c.OnCommentCreated(EventArgs.Empty);

        for (int x = 0; x < otherfirstname.Length; x++)
        {
            sqlHelper.ExecuteScalar<int>(
                @"insert into CommentOtherAuthor(firstname,surname,occupation,affiliation,email,commentid) values(@firstname,@surname,@occupation,@affiliation,@email,@commentid)",
                sqlHelper.CreateParameter("@firstname", otherfirstname[x]),
                sqlHelper.CreateParameter("@surname", othersurname[x]),
                sqlHelper.CreateParameter("@occupation", otheroccupation[x]),
                sqlHelper.CreateParameter("@affiliation", otheraffiliation[x]),
                sqlHelper.CreateParameter("@email", otheremail[x]),
                sqlHelper.CreateParameter("@commentid", 123)
            );
        }

        if (c.Spam)
        {
            c.OnCommentSpam(EventArgs.Empty);
        }

        if (c.Approved)
        {
            c.OnCommentApproved(EventArgs.Empty);
        }

        return c;
    } 
```

关键线是：

```
sqlHelper.CreateParameter("@commentid", 123) 
```

目前，我只是将评论的 id 硬编码为 123，但实际上我需要它是刚刚插入评论表的记录的 id。

我只是不太明白如何在不执行新操作的情况下从表 Comment 中获取最后一个插入

```
SELECT TOP 1 id FROM Comment ORDER BY id DESC 
```

这并没有让我觉得这是做到这一点的最佳方式。

谁能建议如何使它工作？

非常感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-02T21:24:00.447

在负载下的系统中，该`SELECT TOP 1 id ...`查询很可能不会给您正确的结果。如果您有 20 或 50 个客户同时插入评论，那么当您再次查询该表时，您很有可能会得到其他人的`id`...

我认为最好的方法是：

*   在原始插入中添加一个`OUTPUT`子句并捕获新插入的`ID`
*   使用该 ID 进行第二次插入

类似于以下内容：

```
c.Id = sqlHelper.ExecuteScalar<int>(
        @"insert into Comment(......) 
          output Inserted.ID                
          values(.............)", 
```

使用这种方法，您的`c.Id`值现在应该是新插入的`ID`-在您的下一个插入语句中使用**它！**（*注意：现在，您可能总是会得到`1`回报 - 受您的语句影响的行数......*）

这种方法假定您的表`Comment`有一个类型的列，`INT IDENTITY`当您在其中插入新行时会自动设置该列。

```
for (int x = 0; x < otherfirstname.Length; x++)
{
        sqlHelper.ExecuteScalar<int>(
            @"insert into CommentOtherAuthor(.....) values(.....)",
            sqlHelper.CreateParameter("@firstname", otherfirstname[x]),
            sqlHelper.CreateParameter("@surname", othersurname[x]),
            sqlHelper.CreateParameter("@occupation", otheroccupation[x]),
            sqlHelper.CreateParameter("@affiliation", otheraffiliation[x]),
            sqlHelper.CreateParameter("@email", otheremail[x]),
            sqlHelper.CreateParameter("@commentid", c.Id)  <<=== use that value you got back!
        );
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-02T21:39:47.630

假设您使用的是 Microsoft SQL Server，您可以设计您的表*Comment*，以便*Id*列的属性*Identity*设置为 true。这样，每次将行插入表中时，数据库都会生成并自动增加 id。

您必须在 SQL 请求中使用以下行：

输出插入.Id

为了在执行请求时将此 ID 返回给您的 C# 代码。

# javascript - 如何在javascript中构建这个正则表达式匹配

> ID：10866018
> 
> 赞同：0
> 
> 时间：2012-06-02T21:17:21.867
> 
> 标签：javascript, regex

我有这个字符串

```
[X=(any number)] (any character, include space) [/X] 
```

示例：[X=5]测试字符串[/X]

我测试`/(\[)(X=)(\d+\])(\w\s\.)(\[/X\])/gi`但它不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-02T21:21:29.323

```
var myregexp = /\[X=(\d+)\]([^[]*)\[\/X\]/g; 
```

对我有用，包括测试字符串是否为多行。使用[RegexBuddy测试](http://www.regexbuddy.com)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-02T21:21:36.960

问题是也`/`需要转义。此外，对常量匹配进行分组也不是很有用。最后，您正在匹配`(\w\s.)`，但这仅允许按此顺序使用一个单词字符、一个空格字符和一个任意类型的字符。我看不出那有什么用。尝试：

```
/\[X=(\d+)\](.+)\[\/X\]/gi 
```

这将对两个可变部分进行分组。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-02T21:22:04.250

使用这个`regex`：

```
/\[X=\d+\].+\[\/X\]/gi 
```

**它检查给定的字符串是否是所需的格式。**

# python - 如何在循环结束时访问函数内部的 np.array 的值？

> ID：10866020
> 
> 赞同：0
> 
> 时间：2012-06-02T21:17:38.850
> 
> 标签：python, function, numpy

循环结束后如何将 Q 数组写入 excel？或者循环结束后如何查看存储在 Q 中的数据？

```
Nlayers=23
N=365

def main_loop(Z,z,Areat0,Areat1,TempLake,i,HSR,TD,FW,wind):
    Q=np.zeros(len(rad))
    Q[0]=0
    Q[i+1]=Qn(HSR,TD,FW,TempLake[0])
    Q0=Q[i]
    Q1=Q[i+1]
    n=TempLake.size
    var00=Imp_scheme(Q0,Q1,z,Areat0,Areat1,Z,TempLake,wind)
    var01=fix_profile(n,var00,Areat0)
    return var01

TempLake=np.zeros((N,Nlayers))
TempLake[0]=T0

for i in xrange(N-1):
    TempLake[i+1]=main_loop(Z,z,Areat0,Areat1,TempLake[i],i,HSR[i],TD[i],FW[i],wind[i]) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-02T21:50:48.513

简短的回答是，你不能没有 a) 返回它，b) 将它传入并修改它，或者 c) 将它声明为全局或等效的东西。在大多数情况下`a`是最好的。在函数的最后一行，你可以这样做：

```
return var01, Q 
```

在主`for`循环中：

```
for i in xrange(N-1):
    result, Q = main_loop(...)
    TempLake[i + 1] = result
do_something_with(Q) 
```

但在您的情况下，这是一个相当尴尬的设计，因为您要返回`Q` `N`时间，但只使用一次。可能有更好的方法，但我无法从您的示例代码中看出您真正在做什么，所以我无法弄清楚它可能是什么。

# tfs - Team Foundation Server 使用自定义字段而不是系统字段

> ID：10866021
> 
> 赞同：0
> 
> 时间：2012-06-02T21:17:42.660
> 
> 标签：tfs, tfs-workitem

我正在我们公司介绍 TFS 2010。经过大量的项目自定义工作后，我正在考虑将自定义字段用作一些系统字段。

一个例子...

我对“System.priority”字段有一些管理要求。该字段应设置为“REQUIRED”，因此每个人都必须对错误或任务的优先级进行估计。

创建自定义 mypriority 字段并使用它是否存在任何众所周知的问题？（除了基本报告之后的整个定制......）我知道我不能删除系统字段，但我可以从布局选项卡中删除 system.priority 的引用，然后我将使用我自己定制的..

这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-03T19:28:09.863

当默认字段可以达到目的时，请避免创建自定义字段。例如：在需要时使用**[REQUIRED](http://msdn.microsoft.com/en-us/library/ms404861)**规则：

```
<FIELD name="Priority" refname="Microsoft.VSTS.Common.Priority" type="Integer" reportable="dimension">
  <REQUIRED />    
</FIELD> 
```

# c++ - math_3d.h 与 opengl

> ID：10866026
> 
> 赞同：1
> 
> 时间：2012-06-02T21:18:47.593
> 
> 标签：c++, opengl, g++

所以，我正在阅读[http://ogldev.atspace.co.uk/www/tutorial02/tutorial02.html](http://ogldev.atspace.co.uk/www/tutorial02/tutorial02.html)，它说我需要针对 Vector3f 的 math_3d.h。

我试图包括它：

```
#include <stdio.h>

#include "GL/glew.h"
#include "GL/gl.h"
#include "GL/freeglut.h"

#include "math_3d.h"

void render() {
  glClearColor(0.0, 0.0, 0.0, 0.0);
  glClear(GL_COLOR_BUFFER_BIT);
  glutSwapBuffers();

  glFlush();
}

int main(int argc, char** argv) {
  glutInit(&argc, argv);
  glutInitDisplayMode(GLUT_DOUBLE | GLUT_RGBA);
  glutInitWindowSize(800, 600);
  glutInitWindowPosition(100, 100);
  glutCreateWindow("OpenGL - First window demo");

  /* Set  */
  GLenum res = glewInit();
  if (res != GLEW_OK) {
    fprintf(stderr, "Error: '%s'\n", glewGetErrorString(res));
    return 1;
  }

  Vector3f vertices[1];

  glutDisplayFunc(render);
  glutMainLoop();

  return 0;
} 
```

G++ 说“main.cpp:7:21：致命错误：math_3d.h：没有这样的文件或目录”。我为它寻找了一个 Arch Linux 包，但我一无所获。

我在这里找到了文件：

[http://ogldev.googlecode.com/svn-history/r75/trunk/tutorial36/math_3d.h](http://ogldev.googlecode.com/svn-history/r75/trunk/tutorial36/math_3d.h)

我应该下载该文件并将其放在我的项目目录中，还是有更清洁的方法？

另外，如果我确实将它包含在我的目录中，我怎样才能将它添加到 g++ 行？

```
gcc main.cpp -o main -lGLEW -lglut -lGL 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-02T21:23:27.277

> 我应该下载该文件并将其放在我的项目目录中吗？

是的

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-02T21:24:47.330

下载目录中的文件就足够了。不需要将其添加到 gcc 命令行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-04-16T16:54:58.470

是的，您必须下载它，如果您在多个项目中需要此库，您可以将其保存在 /usr/include 中并将其用作 C 库`#include <math_3d.h>`，避免将其复制到每个项目的目录中。

# mongodb - 初学者解释mongodb特定字段的平均值做mapreduce或group有什么区别

> ID：10866027
> 
> 赞同：0
> 
> 时间：2012-06-02T21:18:59.800
> 
> 标签：mongodb, mapreduce

在参考文章中，我找到了答案，但我是 MongoDB 的初学者，对于初学者来说，他们的文档并没有得到很好的解释。我也在读克里斯蒂娜的书，所以我在做我的功课。我认为这篇文章可能会帮助其他试图解决这个问题的用户，而不是传统的，我有一个问题，有人发布了一个代码示例，但他们从来没有真正理解发生了什么。

话虽如此，我在下面列出的一些相互关联的事情上遇到了非常艰难的时光，我发现了另一个关于这个问题的好问题和答案，但这只是一些代码，对于 mongo 的初学者来说并没有得到很好的解释。该代码也对我不起作用（http://stackoverflow.com/questions/6414312/fastest-way-to-get-the-average-of-a-specific-field-in-mongodb）。：/

我有一些像这样的文件：

```
{ "_id" : ObjectId("4fc7e9138c8b0f0d5200000f"), "memtotal" : 996, "swaptotal" : 2015, "swapfree" : 2015, "memfree" : 464, "time" : 1338501393 }
{ "_id" : ObjectId("4fc7e9518c8b0f0d52000015"), "memtotal" : 996, "swaptotal" : 2015, "swapfree" : 2015, "memfree" : 464, "time" : 1338501455 }
{ "_id" : ObjectId("4fc7e98f8c8b0f0d5200001b"), "memtotal" : 996, "swaptotal" : 2015, "swapfree" : 2015, "memfree" : 463, "time" : 1338501517 }
{ "_id" : ObjectId("4fc7e9cd8c8b0f0d52000021"), "memtotal" : 996, "swaptotal" : 2015, "swapfree" : 2015, "memfree" : 464, "time" : 1338501579 }
{ "_id" : ObjectId("4fc7ea0b8c8b0f0d52000027"), "memtotal" : 996, "swaptotal" : 2015, "swapfree" : 2015, "memfree" : 446, "time" : 1338501641 }
{ "_id" : ObjectId("4fc7ea498c8b0f0d5200002d"), "memtotal" : 996, "swaptotal" : 2015, "swapfree" : 2015, "memfree" : 424, "time" : 1338501703 } 
```

我正在尝试获取所有 memfree 元素，然后计算平均值。我尝试根据上面引用的链接复制/粘贴对代码进行编程，首先它在一定程度上是有意义的，其次，它实际上并没有工作。

第 2 行）第一行是有道理的，非常不言自明的第 3 行）第二行计数：0，总计：0 - 这些是真/假开关吗？第 4 行）这是从 mapReduce() 函数调用相同的 reduce 吗？是 doc 和 out 关键字，还是我们任意定义它们？其他）代码还是失败了，为什么？

最后一个子问题：我可以使用 mapReduce 做同样的事情吗？为什么我要使用 mapReduce 函数而不是一个组，如果我有碎片，我还需要计算平均值？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-04T00:16:19.677

这主要包含在[group 函数的文档中](http://www.mongodb.org/display/DOCS/Aggregation#Aggregation-Group)。

让我们分解一下：

`db.test.group(`
- 对测试集合和组结果运行此查询。
`{ cond: {"status": 1}`
- 我只关心满足这个条件的文档，所以过滤我的结果。
`, initial: {count: 0, total:0}`
- 我要跟踪两个变量，count 和 total，让我们在输出文档中将它们初始化为零。
`, reduce: function(doc, out){ out.count++; out.total += doc.views }`
- 对于每个满足条件的文档，应用此函数（它将计数加一，并将我们文档中的视图总数增加 'out'
`, finalize: function(out){ out.avg = out.total / out.count }`
- 当我们浏览完所有文档后，运行此函数，它将通过将总视图除以文档数来计算平均视图，并将其放入我的“输出”文档中。
`} );`

还有另一行不需要在引用的示例`key`中，如果您想按特定字段进行分组，则需要该行。没有它，您将获得整个集合的平均值。有了它，您可以获得“key”的每个不同值的单独平均值。

是的，reduce 与您可能在 map/reduce 中编写的函数相同。“组”的限制是您只能获得与您的条件匹配的“文档”。在 map reduce 中，您可以使用“map”函数根据输入文档发出任意文档。

我询问您使用的是哪个版本的原因是[聚合框架](http://docs.mongodb.org/manual/applications/aggregation/)，该框架现在在开发版本 (2.1) 中可用，并将在 2.2 中发布用于生产，极大地简化了对 MongoDB 集合的聚合查询。

希望这会有所帮助。

# java - 如何解决“Keystrokes 不是抽象的，不会覆盖 ab.method”

> ID：10866028
> 
> 赞同：0
> 
> 时间：2012-06-02T21:19:27.087
> 
> 标签：java, io

我是一名学习 Java 编程的人，正在尝试从一本书中编译以下代码。当我尝试编译代码时出现此错误

```
Keystrokes is not abstract and does not override abstract method 
    keyTyped (java.awt.event.KeyEvent) in java.awt.event.KeyListener. 
```

另外，我认为这无关紧要，但本书还告诉我将这部分代码添加到源代码中（某处？）：

```
pnl.add ( field) ;
pnl.add (txtArea); 
```

当我这样做时，我得到一个标识符“预期错误”。

程序代码：

```
import javax.swing.*;
import java.awt.event.*;

  class Keystrokes extends JFrame implements KeyListener
  {
   JPanel pnl = new JPanel(); 

  public static void main (String[ ] args){
      Keystrokes gui = new Keystrokes();
    }

    JTextField field = new JTextField ( 38 );
    JTextArea txtArea = new JTextArea (5, 38);

 public Keystrokes()
    {
     super( "Swing window");
     setSize( 500,200);
     setDefaultCloseOperation( EXIT_ON_CLOSE );
     add(pnl);
     field.addKeyListener (this );

     setVisible( true );
    }

    public void keyPressed(KeyEvent event )
    {
        txtArea.setText("Key Pressed");
        throw new UnsupportedOperationException("Not supported yet.");
    }

    public void KeyTyped (KeyEvent event ) {
        throw new UnsupportedOperationException("Not supported yet.");
        txtArea.append("\nCharacter : " + event.getKeyChar() );
    }

    public void keyReleased ( KeyEvent event) 
    {
        int keyCode = event.getKeyCode();
       txtArea.append("\nKey Code : " + event.getKeyCode() );
       textArea.append("\nKey Text : " + event.getKeyText(keyCode));
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-02T21:23:01.170

你的方法`KeyTyped`应该是`keyTyped`. 资本化问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-02T21:23:03.620

```
Keystrokes is not abstract and does not override abstract method keyTyped (java.awt.event.KeyEvent) in java.awt.event.KeyListener. 
```

这意味着`KeyListener`您的`Keystrokes`类声称实现的接口有一些其他方法必须实现，但您没有这样做。实现该`keyTyped`方法并查看 javadocs 以了解您是否遗漏了其他任何方法。

这应该让你解决下一个问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-02T21:33:59.213

Java 区分大小写；您将方法命名为 KeyTyped 而不是基类中所需的 keyTyped。

# javascript - 通过 Button/type='submit' 行为恢复默认表单提交

> ID：10866030
> 
> 赞同：0
> 
> 时间：2012-06-02T21:20:05.060
> 
> 标签：javascript, facebook-graph-api, jquery, jquery-mobile

我在 jquery 移动表单中有一个按钮，它定义了发布操作属性。

```
<form id="form1" enctype="multipart/form-data" data-ajax="false" method="POST" target="uploadTarget" action="https://graph.facebook.com/me/photos?access_token="...">

<input id="source" name="source" type="file">
<input id="message" name="message" type="text">

<button id="upload" type="submit" name="upload">Upload Photo</button>
</form> 
```

当我单击样式按钮时，不会调用表单上的 post 方法。

**如果我使用data-role="none"**，则会在表单上调用方法 'post'

 **```
<button data-role="none" id="upload" type="submit" name="upload">Upload Photo</button> 
```

但按钮显然失去了移动风格。

如图所示，我在表单级别有 data-ajax="false" （感谢 CBroe！），但这无济于事。

是否有任何选项可以在按钮上获取 jquery 移动样式，但保留默认的表单事件和提交/发布行为。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-02T21:29:46.107

> 我已经尝试过 data-ajax="false"，但这无济于事。

你把它放在哪里了——在按钮元素上，还是在表单元素上？（它应该在表格上设置。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-03T00:56:48.027

问题是移动css文件。我使用的是旧版本。包括最新版本后：

```
<link rel="stylesheet" href="http://code.jquery.com/mobile/1.1.0/jquery.mobile.min.css" /> 
```

它似乎工作。**

# assembly - 可以在同一代码路径中混合旧版 SSE 编码指令和 VEX 编码指令吗？

> ID：10866041
> 
> 赞同：11
> 
> 时间：2012-06-02T21:21:41.913
> 
> 标签：assembly, x86, sse, avx

随着 AVX 的推出，Intel 将 VEX 编码方案引入了 Intel 64 和 IA-32 架构。这种编码方案主要用于 AVX 指令。我想知道混合 VEX 编码指令和现在称为“旧 SSE”指令是否可以。

我问这个问题的主要原因是代码大小。考虑这两个指令：

```
shufps xmm0, xmm0, 0
vshufps xmm0, xmm0, xmm0, 0 
```

我通常使用第一个将标量值“广播”到 XMM 寄存器中的所有位置。现在，指令集说这两者（在这种情况下）之间的唯一区别是 VEX 编码的指令清除了 YMM 寄存器的较高（>=128）位。假设我不需要那个，在这种情况下使用 VEX 编码的版本有什么好处？第一条指令占用 4 个字节 ( `0FC6C000`)，第二条指令占用 5 个字节 ( `C5F8C6C000`)。

提前感谢所有答案。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-02T22:07:45.323

在当前实现中，如果（至少）上半部分已被重置（VZEROUPPER 或 VZEROALL），则使用旧版 SSE 指令不会受到任何惩罚。

[如Agner Fog](http://www.agner.org/optimize/optimizing_assembly.pdf)第 128 页所述：优化汇编中的子例程，在使用（某些）上半部分时使用旧版 SSE 指令会带来性能损失。这种惩罚在进入 YMM 寄存器在中间分裂的状态时发生一次，在离开该状态时再次发生。

混合使用 VEX 编码的 128 位指令和传统 SSE 指令不是问题。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2017-01-13T01:21:21.377

这不安全。根据[英特尔的软件开发人员手册](https://software.intel.com/sites/default/files/managed/a4/60/325383-sdm-vol-2abcd.pdf)，`VEX.128`版本将 YMM 寄存器的上半部分归零，而传统 SSE 版本则不会。最糟糕的事情：一些汇编器（如gas）可能会在创建目标文件时转换`SHUFPS`成`VSHUFPS`（当`-mavx`应用标志时）。我发现使用程序集文件时存在完全相同的问题。

# java - 有关 Intellij 中的基本类，请参阅 Javadocs

> ID：10866045
> 
> 赞同：2
> 
> 时间：2012-06-02T21:22:22.903
> 
> 标签：java, intellij-idea

有没有办法在 IntelliJ 中查看/附加基本类（如字符串）的 Javadocs 和/或源代码？

我正在使用 IntelliJ 社区版 11.1

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-02T21:45:07.690

添加新的**JSDK**时，会自动配置源：

![JSDK 源码路径](../Images/4cf721e6cbc34d9c6521b68389cd010c.png)

如果您的 JDK 安装缺少源，则需要手动下载和配置它们。Mac 用户应该参考[这个答案](https://stackoverflow.com/a/4147499/104891)。

当您将源附加到 JSDK 配置时，导航到该类将打开源代码而不是反编译的存根，您还可以使用`View`| `Quick Documentation`基于源文件中的 javadoc。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-02T21:25:15.803

看看生产力提示：

[http://www.jetbrains.com/idea/documentation/tips/index.html](http://www.jetbrains.com/idea/documentation/tips/index.html)

# r - 抖动 geom_line()

> ID：10866047
> 
> 赞同：28
> 
> 时间：2012-06-02T21:22:37.677
> 
> 标签：r, plot, ggplot2

有没有办法让线条抖动`geom_line()`？我知道这有点违背这个情节的目的，但如果你的情节很少，并且希望它们都显示出来，它可能会很方便。也许其他解决方案可以解决这个*可见性*问题。

请参阅下面的代码， ![抖动 geom_line](../Images/5cd361d6b94e5a63ea2061fda4e00c86.png)

```
A  <- c(1,2,3,5,1)
B  <- c(3,4,1,2,3)
id <- 1:5
df <- data.frame(id, A, B)

# install.packages(reshape2)
require(reshape2) # for melt
dfm <- melt(df, id=c("id"))

# install.packages(ggplot2)
require(ggplot2)
p1 <- ggplot(data = dfm, aes(x = variable, y = value, group = id, 
color= as.factor(id))) + geom_line() + labs(x = "id # 1 is hardly 
visible as it is covered by id # 5") + scale_colour_manual(values = 
c('red','blue', 'green', 'yellow', 'black')) 

p2 <- ggplot(subset(dfm, id != 5), aes(x = variable, y = value, 
group = id, color= as.factor(id))) + geom_line() + labs(x = "id # 
5 removed, id # 1 is visible") + scale_colour_manual(values = 
c('red','blue', 'green', 'yellow', 'black')) 

# install.packages(RODBC)
require(gridExtra)

grid.arrange(p1, p2) 
```

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-06-02T21:40:00.327

你可以试试

```
geom_line(position=position_jitter(w=0.02, h=0)) 
```

看看这是否运作良好。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2016-04-18T13:24:11.147

如果您只是想防止两条线完全重叠，现在有一种更好的方法：[position_dodge()](http://docs.ggplot2.org/current/position_dodge.html)，它“通过将重叠躲避到一边来调整位置”。这比向任何线路添加抖动要好，即使在不需要时也是如此。

## 使用 position_dodge() 避免 ggplot2 线完全重叠

代码示例：

```
df<-data.frame(x=1:10,y=1:10,z=1:10);
df.m <- melt(df, id.vars = "x");
ggplot(df.m, aes(x=x,y=value,group=variable,colour=variable)) 
    + geom_line(position=position_dodge(width=0.2)); 
```

多亏了`position_dodge()`，我们现在可以看到图中有两条线恰好恰好重合：

[![使用 position_doge 防止 ggplot 中的线重叠](../Images/261fa116cbc6427179352f2f81ff7836.png)](https://i.stack.imgur.com/MAn09.png)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-02T21:30:08.073

我倾向于使用不同的线条样式，例如，一条蓝色实线“穿过”其顶部的一条红色虚线。再说一次，它确实取决于你想向读者传达什么。首先要记住，*数据*应该是点和*理论*线，除非这会使事情变得混乱。除非 y*和*x 值相同，否则会更容易看到这些点。（或者您可以将现有`jitter`函数应用于 x 值）接下来，如果您只想显示哪些运行在“捆绑”中，哪些是异常值，重叠并不重要，因为两个异常值不太可能接近-平等的。

如果您想显示一堆几乎相等的运行，您可能更喜欢（也就是说，您的读者会更好地理解）将增量与平均值而不是实际值进行对比。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-12-31T22:52:17.723

我想提出一个与描述不同的问题的解决方案，其中 Y 轴是一个因素，所以 position_dodge 什么都不做。

[![在此处输入图像描述](../Images/b024b4a949b9489a2f9381cbe54f438b.png)](https://i.stack.imgur.com/mXtbA.png)

代码：

```
library(tidyverse)

time_raw <- tibble(year=1900:1909,
            person_A=c(rep("Rome",2),rep("Jerusalem",8)),
            person_B=c(rep("Jerusalem",5),rep("Rome",5)))

achivments <- tribble(~year,~who,~what,
                  1900,"person_A","born",
                  1900,"person_B","born",
                  1909,"person_A","died",
                  1909,"person_B","died",
                  1905,"person_A","super star",
                  1905,"person_B","super star")

SCALE=0.5

jitter_locations <- time_raw %>%
  pivot_longer(-year,names_to="who",values_to="place") %>%
  distinct(place)%>%
  filter(!is.na(place)) %>% 
  mutate(y_place=seq_along(place)) 

jitter_lines <- time_raw %>%
  pivot_longer(-year,names_to="who",values_to="place") %>%
  distinct(who) %>%
  mutate(y_jitter=scale(seq_along(who))*0.015)

data_for_plot <- time_raw %>% 
 pivot_longer(-year,names_to="who",values_to="place") %>% 
 filter(!is.na(place)) %>% 
 left_join(achivments) %>% 
 left_join(jitter_locations) %>% 
 left_join(jitter_lines)

 data_for_plot %>% 
   ggplot(aes(x=year,y=y_place+y_jitter,color=who,group=who))+
   geom_line(size=2)+
   geom_hline(aes(yintercept=y_place),size=50,alpha=0.1)+
   geom_point(data = . %>% filter(!is.na(what)),size=5)+
   geom_label(aes(label=what),size=3,nudge_y = -0.025)+
   theme_bw()+
   coord_cartesian(ylim = c(min(jitter_locations$y_place)-0.5*SCALE,
                       max(jitter_locations$y_place)+0.5*SCALE))+
   scale_y_continuous(breaks = 
   min(jitter_locations$y_place):max(jitter_locations$y_place),
                 labels = jitter_locations$place)+
   scale_x_continuous(breaks =  
   min(data_for_plot$year):max(data_for_plot$year))+

   ylab("Place") 
```

# iphone - 如何判断 Core Data 轻量级迁移已经成功

> ID：10866051
> 
> 赞同：2
> 
> 时间：2012-06-02T21:23:05.717
> 
> 标签：iphone, ios, ipad, core-data, icloud

背景：

我目前在应用商店中有一个使用核心数据数据存储的应用 - 与 iCloud。

我已将字段添加到实体和新实体。

我已经设置了自动迁移，我认为这一切都有效。（没有崩溃）

有没有办法告诉它100％有效？我认为这是应对这种微小变化的最佳方法？我不想发布一些用户会崩溃的机会。

实现自动迁移的代码如下：

```
NSURL *storeUrl = [NSURL fileURLWithPath:storePath];
// this needs to match the entitlements and provisioning profile
NSURL *cloudURL = [fileManager URLForUbiquityContainerIdentifier:nil];
NSString* coreDataCloudContent = [[cloudURL path] stringByAppendingPathComponent:@"iLearn_LessonPlans"];
cloudURL = [NSURL fileURLWithPath:coreDataCloudContent];

//  The API to turn on Core Data iCloud support here.
NSDictionary* options = [NSDictionary dictionaryWithObjectsAndKeys:@"com.danielanderton.iLearn_LessonPlans.1",    NSPersistentStoreUbiquitousContentNameKey, cloudURL, NSPersistentStoreUbiquitousContentURLKey, [NSNumber numberWithBool:YES], NSMigratePersistentStoresAutomaticallyOption, [NSNumber numberWithBool:YES], NSInferMappingModelAutomaticallyOption,nil];

NSError *error = nil;

[psc lock];
if (![psc addPersistentStoreWithType:NSSQLiteStoreType configuration:nil URL:storeUrl options:options error:&error]) {
              NSLog(@"error");
}
[psc unlock]; 
```

# javascript - 在 Google 脚本中，按函数名称调用函数，并在字符串中给出函数名称

> ID：10866054
> 
> 赞同：4
> 
> 时间：2012-06-02T21:23:22.700
> 
> 标签：javascript, google-apps-script

我已经尝试了在“stackoverflow”站点上找到的代码示例，这些示例与从字符串调用函数有关。它们似乎不适用于 Google App Script。我收到一个错误，将该“窗口”作为未定义的对象。

这是我要解决的情况。我有一个电子表格，它将有许多不同的工作表。其中一些工作表将具有在我编写代码时已知的名称。其他工作表的名称在我编写代码时并不确切（例如基于动态数据）。

当前文档告诉我“onEdit”事件处理程序的名称是“onEdit”。由于你的名字是独一无二的，我的结论是，在电子表格应用程序中只能有一个具有这个名字的例程。

由于这种情况（上图），我想降低“onEdit”函数的复杂性。我想编写“onEdit”例程，根据发生编辑事件的“工作表”的名称，对使用限定名称的子函数进行“动态”调用。

这是我想要纠正的“onEdit”例程的伪代码示例。

```
 function onEdit(src)
  {
     var act_sheet = src.getActiveSheet();
     var sheet_name = act_sheet.getName();
     var rtn_name = "onEdit_sheet_".sheet_name;

     if ( function_exists(rtn_name) )
     {
         window[rtn_name](srv)
     }
  } 
```

我实际上尝试过类似的代码。在 google 环境中，“window”对象被标记为未知对象。

我应该使用的环境中是否还有其他“对象”名称？这在 Google Apps 脚本环境中是否可行？

* * *

另外，我知道“function_exists”例程的编写也是一个挑战。那将是我的下一个问题。我知道“typeof”操作，当我编码时它返回“string”

```
 "if ( typeof rtn_name == function" ) .. " 
```

给定字符串中包含的名称，有没有办法测试例程是否存在？

* * *

我知道我可以在“onEdit”例程中使用“静态”名称并对其进行硬编码。但是我想编写一次例程，而不必为我编写的每个新电子表格修改它。我不想编写非常复杂的“onEdit”例程，而是专注于为单个工作表编写和测试“onEdit”函数。

我了解浏览器环境中的 Javascript。Google 应用程序脚本环境对我来说更加神秘。我发现文档非常简洁，需要更全面的解释。有关 Google 应用程序脚本环境中存在哪些对象的任何其他信息都会有所帮助。

* * *

当然，我的第三步可能是编写一个“onEdit”例程，该例程根据与 Edit 事件关联的当前“范围”调度正确的子函数。

* * *

我是 Google Apps 脚本的新手。我正在寻找脚本解决方案。它可能可以在“Java”中完成，但这超出了我想要编码的范围。

* * *

我也是“stackoverflow”环境的新手。其中大部分对我来说似乎是个谜。（例如，我如何指定哪些标签应该与这个问题相关联？我怎么知道哪些标签可以分配给这个问题？如何将我的搜索限制在某些标签上？-我目前对“谷歌”感兴趣应用程序脚本”，当我在右栏中选择“javascript”按钮时，它会将我带到可能不适用于 google 脚本环境的 javascript 答案。在下面了解如何“分配”标签。我怎么知道哪些标签是无需猜测即可获得？

感谢所有和任何帮助。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-02T22:10:05.093

我知道有两种方法可以在 Apps 脚本中使用其名称来调用该函数。

```
function onEdit(e) {
  var func = 'test';
  this[func]();
  //eval(func+'()'); //msgBox and eval don't play nice together
  Browser.msgBox('finished');
}

function test() {
  Browser.msgBox('test');
} 
```

当然，在使用该`this`方法时，您不应该处于另一个范围内，例如来自名为 using 的函数`new`。但是我发布的这个确切的完整代码可以正常工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-04-03T08:22:04.693

对于 ES8：

```
var GoogleAppsScrip = this;
function onEdit(e) {
  var func = 'test';
  GoogleAppsScrip[func]();
  Browser.msgBox('finished');
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-02T21:42:35.680

如果您知道函数的存储位置，则可以进行标准 if 检查。

```
if(window.myFunction){//then do something};

      function someFunction(){

        if(this.florida.miami.beach.girls.boobs > 'b')
        {
                alert('Get Plane Ticket!');
        }
         else{
               console.log('improvise')};
        };

        if(window.someFunction){

        window.someFunction.call(new USA());
        }; 
```

# c# - 页面未采用母版设计

> ID：10866057
> 
> 赞同：1
> 
> 时间：2012-06-02T21:23:35.297
> 
> 标签：c#, asp.net, webforms

```
 <%@ Master Language="C#" AutoEventWireup="true" CodeFile="The_Saloon.master.cs" Inherits="The_Saloon" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Organic Company Template</title>
    <asp:ContentPlaceHolder ID="head" runat="server" EnableViewState="true">
        <link href="App_Themes/maintheme/css/style.css" rel="stylesheet" type="text/css" />
        <!--[if lte IE 7]><link href="App_Themes/maintheme/css/iehacks.css" rel="stylesheet" type="text/css" /><![endif]-->
        <script type="text/javascript" src="App_Themes/maintheme/js/jquery.js"></script>
        <!--[if IE 6]>
  <script type="text/javascript" src="App_Themes/maintheme/js/ie6pngfix.js"></script>
  <script type="text/javascript">
    DD_belatedPNG.fix('img, ul, ol, li, div, p, a, h1, h2, h3, h4, h5, h6');
  </script>
  <![endif]-->
    </asp:ContentPlaceHolder>
</head>
<body id="page">
    <div class="rapidxwpr floatholder">
        <div id="middle">
            <div id="left" class="clearingfix">
                <a href="App_Themes/maintheme/index.html">
                    <img id="logo" class="correct-png" src="App_Themes/maintheme/images/logo.png" alt="Home"
                        title="Home" /></a>
                <div class="menu">
                    <ul>
                        <li><a href="" class="home">Home</a></li>
                        <li><a href="" class="gallery">Picture Gallery</a></li>
                        <li><a href="" class="events">Upcoming Events</a></li>
                        <li><a href="" class="contact">Contact Us</a></li>
                    </ul>
                </div>
            </div>
            <div id="main">
                <div id="main_container" class="clearingfix">
                    <div id="mainmiddle" class="floatbox withright">
                        <div class="why-organic">
                            <form id="form1" runat="server">
                            <asp:ContentPlaceHolder ID="ContentPlaceHolder1" runat="server" EnableViewState="true">
                                <p>
                                    "Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor
                                    incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud
                                    exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute
                                    irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla
                                    pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia
                                    deserunt mollit anim id est laborum." Section 1.10.32 of "de Finibus Bonorum et
                                    Malorum", written by Cicero in 45 BC "Sed ut perspiciatis unde omnis iste natus
                                    error sit voluptatem accusantium doloremque laudantium, totam rem aperiam, eaque
                                    ipsa quae ab illo inventore veritatis et quasi architecto beatae vitae dicta sunt
                                    explicabo. Nemo enim ipsam voluptatem quia voluptas sit aspernatur aut odit aut
                                    fugit, sed quia consequuntur magni dolores eos qui ratione voluptatem sequi nesciunt.
                                    Neque porro quisquam est, qui dolorem ipsum quia dolor sit amet, consectetur, adipisci
                                    velit, sed quia non numquam eius modi tempora incidunt ut labore et dolore magnam
                                    aliquam quaerat voluptatem. Ut enim ad minima veniam, quis nostrum exercitationem
                                    ullam corporis suscipit laboriosam, nisi ut aliquid ex ea commodi consequatur? Quis
                                    autem vel eum iure reprehenderit qui in ea voluptate velit esse quam nihil molestiae
                                    consequatur, vel illum qui dolorem eum fugiat quo voluptas nulla pariatur?" 1914
                                    translation by H. Rackham "But I must explain to you how all this mistaken idea
                                    of denouncing pleasure and praising pain was born and I will give you a complete
                                    account of the system, and expound the actual teachings of the great explorer of
                                    the truth, the master-builder of human happiness. No one rejects, dislikes, or avoids
                                    pleasure itself, because it is pleasure, but because those who do not know how to
                                    pursue pleasure rationally encounter consequences that are extremely painful. Nor
                                    again is there anyone who loves or pursues or desires to obtain pain of itself,
                                    because it is pain, but because occasionally circumstances occur in which toil and
                                    pain can procure him some great pleasure. To take a trivial example, which of us
                                    ever undertakes laborious physical exercise, except to obtain some advantage from
                                    it? But who has any right to find fault with a man who chooses to enjoy a pleasure
                                    that has no annoying consequences, or one who avoids a pain that produces no resultant
                                    pleasure?" Section 1.10.33 of "de Finibus Bonorum et Malorum", written by Cicero
                                    in 45 BC "At vero eos et accusamus et iusto odio dignissimos ducimus qui blanditiis
                                    praesentium voluptatum deleniti atque corrupti quos dolores et quas molestias excepturi
                                    sint occaecati cupiditate non provident, similique sunt in culpa qui officia deserunt
                                    mollitia animi, id est laborum et dolorum fuga. Et harum quidem rerum facilis est
                                    et expedita distinctio. Nam libero tempore, cum soluta nobis est eligendi optio
                                    cumque nihil impedit quo minus id quod maxime placeat facere possimus, omnis voluptas
                                    assumenda est, omnis dolor repellendus. Temporibus autem quibusdam et aut officiis
                                    debitis aut rerum necessitatibus saepe eveniet ut et voluptates repudiandae sint
                                    et molestiae non recusandae. Itaque earum rerum hic tenetur a sapiente delectus,
                                    ut aut reiciendis voluptatibus maiores alias consequatur aut perferendis doloribus
                                    asperiores repellat." 1914 translation by H. Rackham "On the other hand, we denounce
                                    with righteous indignation and dislike men who are so beguiled and demoralized by
                                    the charms of pleasure of the moment, so blinded by desire, that they cannot foresee
                                    the pain and trouble that are bound to ensue; and equal blame belongs to those who
                                    fail in their duty through weakness of will, which is the same as saying through
                                    shrinking from toil and pain. These cases are perfectly simple and easy to distinguish.
                                    In a free hour, when our power of choice is untrammelled and when nothing prevents
                                    our being able to do what we like best, every pleasure is to be welcomed and every
                                    pain avoided. But in certain circumstances and owing to the claims of duty or the
                                    obligations of business it will frequently occur that pleasures have to be repudiated
                                    and annoyances accepted. The wise man therefore always holds in these matters to
                                    this principle of selection: he rejects pleasures to secure other greater pleasures,
                                    or else he endures pains to avoid worse pains."</p>
                            </asp:ContentPlaceHolder>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div id="footer">
            &copy; The Saloon 2012
        </div>
    </div>
</body>
</html> 
```

嗨，我添加了我的母版页，也许我在 contentplaceholders 上做错了，我不确定。但我的问题是，当我使用母版页制作新的 Web 表单时，唯一显示的是背景图像，仅此而已。所以我不知道怎么了

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-02T21:28:45.153

可能是因为您在 `<asp:ContentPlaceHolder`使用此母版页并定义此内容 ID 的页面上删除了此内容中的内容。

认为里面的内容`<asp:ContentPlaceHolder> ... </asp:ContentPlaceHolder>`是默认内容，当在下一页您没有为此特定内容设置任何内容时。

所以对我来说，我会留下你页面的这部分内容，至少在你抱怨没有得到风格的标题上。

例如将头部写为：

```
<head>
    <title>Organic Company Template</title>
    <asp:ContentPlaceHolder ID="head" runat="server" EnableViewState="true">
    </asp:ContentPlaceHolder>

        <link href="App_Themes/maintheme/css/style.css" rel="stylesheet" type="text/css" />
        <!--[if lte IE 7]><link href="App_Themes/maintheme/css/iehacks.css" rel="stylesheet" type="text/css" /><![endif]-->
        <script type="text/javascript" src="App_Themes/maintheme/js/jquery.js"></script>
        <!--[if IE 6]>
  <script type="text/javascript" src="App_Themes/maintheme/js/ie6pngfix.js"></script>
  <script type="text/javascript">
    DD_belatedPNG.fix('img, ul, ol, li, div, p, a, h1, h2, h3, h4, h5, h6');
  </script>
  <![endif]-->

</head> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-02T22:00:33.383

创建母版页时，内容占位符是继承母版页的页面放置自己的内容的部分。您不应将内容放在母版页的此部分中。

当您在页面中引用此 ContentPlaceHolder 时，您在母版页中分配的内容将被覆盖。

//页面.aspx

```
<asp:Content ContentPlaceHolderID="MainContent"></asp:Content> 
```

该语句之间没有任何内容，替换母版页中的内容

要实现您想要的，请执行此操作

//MasterPage.aspx 把你的文字移出

```
<div>
   My default content to show on every page
   <asp:ContentPlaceHolder ID="MainContent"> <!-- child pages content goes here -->
   </asp:ContentPlaceHolder>
</div> 
```

看到我已将文本移出 ContentPlaceHolder。试试这个，你的内容不会消失了

# java - Apache CXF 文档功能

> ID：10866058
> 
> 赞同：3
> 
> 时间：2012-06-02T21:23:44.080
> 
> 标签：java, web-services, cxf

[Enunciate](http://enunciate.codehaus.org/index.html)有一个文档模式，当你编译你的代码时，***你会得到一个 Web 服务的文档页面***（它是自动生成的，不需要编写任何其他文档注释来添加文档注释。我知道 Apache CXF 有类似的东西。我需要一个自动文档生成器，例如 Enunciate 项目）。

***Apache CXF 是否具有相同的功能？***

**PS：**我在我的应用程序中使用 Spring。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-12-20T10:57:44.583

2015 年 12 月更新：有几个选项可以生成文档，说明是迄今为止最好的 OSS 选项。CXF 没有此功能的任何插件。然而最好的文档功能，还有一个 Maven 插件是一个商业产品：[http](http://www.filigris.com/docflex-xml/wsdldoc/) ://www.filigris.com/docflex-xml/wsdldoc/ 。

# python - Reactor.run 冻结循环

> ID：10866067
> 
> 赞同：2
> 
> 时间：2012-06-02T21:24:36.410
> 
> 标签：python, twisted

我有一个 Twisted 套接字，我试图在多个端口上运行。以下代码以前对我有用，但那是大约 1 个月前，因为如果我没记错的话，我从那以后就没有接触过代码。现在，在我的 Twisted 程序中重新输入代码后，它不再工作了。

```
class Socket(Protocol):
    table = Table()

    def connectionMade(self):
        #self.transport.write("""connected""")
        self.factory.clients.append(self)
        print "Clients are ", self.factory.clients

    def connectionLost(self, reason):
        self.factory.clients.remove(self)

    def dataReceived(self, data):
        #print "data is ", data
        a = data.split(':')
        if len(a) > 1:
            command = a[0]
            content = a[1]

            if command == "Number_of_Players":
                msg = table.numberOfPlayers

        print msg

        for c in self.factory.clients:
                c.message(msg)

    def message(self, message):
        self.transport.write(message)

NUM_TABLES = 10

factories = [ ]
for i in range(0, NUM_TABLES):
    print i
    factory = Factory()
    factory.protocol = Socket
    factory.clients = []
    factories.append(factory)
    reactor.listenTCP(1025+i, factory)
    #print "Blackjack server started"
    reactor.run() 
```

它通常会在我设置的范围内打印 Blackjack 服务器启动的次数，但现在不会。为了测试它是否循环，我开始打印 i，但它只打印了 0。由于某种原因，for 循环只循环了 1 次。

有什么建议么？谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-02T22:13:21.037

扭曲的程序通常只`reactor`运行一个。请记住，当您启动 ( `.run()`) 反应器时，执行会在反应器循环内部进行（并且您在代码中定义的各种事件，如`connectionMade()`、`connectionLost()`、`dataReceived()`等在相应的操作发生时被触发）。之后的任何代码都`reactor.run()`只会**在 reactor 停止后**执行。

因此，您的代码永远不会通过`for`循环的第一次迭代。

尝试移出`reactor.run()`循环：

```
NUM_TABLES = 10

factories = [ ]
for i in range(0, NUM_TABLES):
    print i
    factory = Factory()
    factory.protocol = Socket
    factory.clients = []
    factories.append(factory)
    reactor.listenTCP(1025+i, factory)

# print "Blackjack server started"

reactor.run()

# whatever code you put here, is executed only **after reactor has stopped** 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-02T21:30:07.797

您是否收到任何类型的错误消息？您的基本循环没有任何问题。我建议注释掉下面的所有行`print i`，然后有选择地添加它们直到循环停止 - 这会告诉你是什么导致了问题（显然第二次打印不是问题）

也许`listenTCP()`正在挂起等待连接？

或者，您正在调用的某个函数中可能存在某种无限循环。确定没有看到其他代码的唯一方法是通过注释掉可疑代码并将其重新添加来消除可能的问题。

**更新**：根据您的新信息，问题显然出在`reactor.run()`. 如果代码足够独立，您可以将其发布以供检查。

中的两个潜在问题`reactor.code()`，一个*无限*循环，或者程序正在*等待*某种*事件/输入*。

循环可能是无限的，即编码不正确，因此它开始但从不终止。这看起来好像程序正在暂停/停止（即使 CPU 疯狂地运转）。或者，如果程序正在等待某个输入/事件，它可能会暂停。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-02T21:30:18.120

在您到达调试打印之前引发了异常。

通过用`try: ... except`.

```
try:
       reactor.listenTCP(1025+i, factory)
except IOError as (errno, strerror):
    print "I/O error({0}): {1}".format(errno, strerror)
except:
    print "something else happened" 
```

# macros - 带有 C/C++ 风格宏的 Fortran 90（例如 #define SUBNAME(x) s ## x）

> ID：10866075
> 
> 赞同：1
> 
> 时间：2012-06-02T21:25:16.887
> 
> 标签：macros, preprocessor, fortran90, gfortran

我最近正在处理一个 F90 代码项目。我正在使用 gfortran (linux 和 MinGW) 来编译它。loct.F90 文件中有一些有趣的东西。

```
#  define TYPE real(4)
#  define SUBNAME(x) s ## x
#  include "loct_inc.F90"
#  undef SUBNAME
#  undef TYPE

#  define TYPE real(8)
#  define SUBNAME(x) d ## x
#  include "loct_inc.F90"
#  undef SUBNAME
#  undef TYPE
... 
```

loct_inc.F90 文件如下所示：

```
subroutine SUBNAME(loct_pointer_copy_1)(o, i)
...
end subroutine SUBNAME(loct_pointer_copy_1)

subroutine SUBNAME(loct_pointer_copy_2)(o, i)
...
end subroutine SUBNAME(loct_pointer_copy_2)

... 
```

我认为在文件 loct.F90 中作者使用了宏集（C/C++ 风格）。每个集合用于定义一种数据类型（例如 real(4)、real(8)、character 等）。loct_inc.F90 文件提供了一组函数，除了变量的类型外，它们是相同的。在我看来，这两个文件作为 c++ 的模板一起工作。

最后应该有一组子程序：

```
sloct_pointer_copy_1(o, i)
sloct_pointer_copy_2(o, i)
...

dloct_pointer_copy_1(o, i)
dloct_pointer_copy_2(o, i)
... 
```

但是当我尝试编译 loct.F90 (gfortran -c loct.F90) 时，我得到了一些错误。

> basic/loct_inc.F90:21.13：包含在 basic/loct.F90:256：
> 
> subroutine s ## loct_pointer_copy_1(o, i) 1 错误： (1) 处的 SUBROUTINE 语句中的语法错误

似乎 gfortran 将 SUBNAME(loct_pointer_copy_1)(o, i) 替换为 s ## loct_pointer_copy_1(o, i)。但是根据 c++ 宏，正确的替换应该是 sloct_pointer_copy_1(o, i)。

谁能告诉我为什么会这样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-03T09:07:07.033

GNU Fortran 在*传统模式下*使用 GNU C 预处理器，在这种模式下，宏粘贴运算符`##`不可用。这就是为什么使用 GNU 工具链编译的 Fortran 项目在其他 Makefile 目标中执行显式预处理，例如`*.F90`，首先将所有项目预处理为然后编译`cpp`的临时`.f90`文件。

# python - wxPython ,改变 StyledTextCtrl 的背景颜色

> ID：10866078
> 
> 赞同：4
> 
> 时间：2012-06-02T21:26:01.177
> 
> 标签：python, wxpython, wxwidgets

我试过（但没有任何反应）

```
 self.txt.SetBackgroundColour ((255,0,0)) 
```

正如标题中所说，我正在尝试更改背景颜色 StyledTextCtrl。有谁知道可以使用的方法？我检查了 API 文档，但似乎找不到，[http://wxpython.org/docs/api/wx.stc.StyledTextCtrl-class.html](http://wxpython.org/docs/api/wx.stc.StyledTextCtrl-class.html)

（当然，背景颜色是指整个书写区域）

有谁知道我可以做到这一点的方法？

编辑：

以下代码中的背景没有改变

```
import wx
import wx.stc

app = wx.App(redirect=True)
top = wx.Frame(None, title="StyledTXTCtrl", size=(300,200))
txt=wx.stc.StyledTextCtrl(top)
txt.SetBackgroundColour((255,255,0))
txt.Refresh()
top.Show()
app.MainLoop() 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-03T01:51:58.757

我的第一反应是打电话`txt.Refresh()`，因为我在使用 wx.TextCtrl 时也有类似的经历，其中背景颜色没有更新并且`Refresh()`调用强制重绘。但是，这种方法似乎是不正确的。

在查看[StyledTextCtrl API](http://wxpython.org/docs/api/wx.stc.StyledTextCtrl-class.html)之后，似乎`SetBackground()`不是您想要的功能。我的理解是，因为 STC 可以在同一个框中有多种样式，所以单个文本样式优先于 STC 的设置。

经过一番研究，我发现了[StyleSetBackground()](http://wxpython.org/docs/api/wx.stc.StyledTextCtrl-class.html#StyleSetBackground)函数。这会修改默认样式，使背景变为红色，从而有效地将背景设置为红色。你需要这样称呼它：

```
txt.StyleSetBackground(wx.stc.STC_STYLE_DEFAULT, (255,0,0)) 
```

请记住，如果您使用多种样式，您可能需要为每个样式调用此方法。

---编辑---
我忘记通过输入一些文本来检查我的代码。事实证明，如果你所做的只是`SyleSetBackground()`像我上面建议的那样调用，当你输入文本时，输入文本的背景仍然是白色，而不是预期的红色。

进行更多研究，我发现这很容易通过在设置背景颜色后调用以下代码来解决：

```
txt.StyleClearAll() 
```

我的猜测是，当您创建 StyledTextCtrl 时，它会将文本样式设置为等于`wx.stc.STC_STYLE_DEFAULT`. 到现在为止还挺好。但是，在这一点之后，我们更改了默认样式的值（通过使背景变为红色），所以现在文本样式和默认样式不同了。因此，我们需要调用[StyleClearAll()](http://wxpython.org/docs/api/wx.stc.StyledTextCtrl-class.html#StyleClearAll)将所有样式重置为默认样式（现在具有红色背景）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-02T23:35:38.480

这在我的电脑上工作得很好

```
self.txt.SetBackgroundColour((255,0,0)) 
```

你的操作系统是什么？

# c++ - 成员变量和方法的部分特化

> ID：10866081
> 
> 赞同：0
> 
> 时间：2012-06-02T21:26:35.570
> 
> 标签：c++, templates, code-organization, template-specialization

我正在编写一个既适用于 2D 又适用于 3D 的模拟。现在我得到了应该修改表面的对象。在 3D 中，表面是一个二维数组，而在 2D 中，它是一维的。我使用模板参数来指示我使用的维度空间。但是，当我专门研究数组的类型时，我无法专门修改修改函数，因为它应该在指定的类中。然后我必须将所有成员复制到专业类中。

```
template <class VectorType> class SimulationObject {
    void operateOnSurface();
};

template<> class SimulationObject<Vector2D> {
    char* surface;
 // Declaration of operateOnSurface expected here
};

template<> class SimulationObject<Vector3D> {
    char** surface;
// Declaration of operateOnSurface expected here
};

template<> void A<Vector2D>::operateOnSurface() {
}

template<> void A<Vector3D>::operateOnSurface() {
} 
```

但我仍然想避免复制 2d 和 3d 的代码，因为我的表面数组和修改函数是唯一指定它的成员。那么还有其他方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-02T22:03:30.933

如果您可以访问 Vector2D 和 Vector3D，则可以为`static const int dimensions;`它们添加一个变量并使用`VectorType::dimensions`.

# c++ - 在 lambda 中没有按值分配副本

> ID：10866087
> 
> 赞同：3
> 
> 时间：2012-06-02T21:27:59.850
> 
> 标签：c++, lambda, c++11, clang

有人可以向我解释为什么以下内容不起作用（`test`在`const`里面`blub`）。由于`test`是按我假设的值复制的，因此我可以设置它，因为它是本地函子。

```
#include <memory>

int main()
{
    std::shared_ptr<bool> test;
    auto blub = [test]() {
        test = std::make_shared<bool>(false);
    };

    return 0;
} 
```

为了使它工作，首先我必须引入一个新的`shared_ptr`，分配`test`，然后我可以正常分配另一个`shared_ptr`。顺便说一句：我正在使用 clang 3.1

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-02T21:32:45.500

因为`operator()`lambdas 是`const`默认的。您需要使用`mutable`关键字使其成为非常量：

```
auto blub = [test]() mutable {
    test = std::make_shared<bool>(false);
}; 
```

# asp.net-mvc-3 - 视图文件夹中 web.config 的目的是什么？

> ID：10866088
> 
> 赞同：2
> 
> 时间：2012-06-02T21:28:11.567
> 
> 标签：asp.net-mvc-3, model-view-controller, web-config

> **可能重复：**
> [web.config 文件在 MVC 项目的 views 文件夹中做了什么](https://stackoverflow.com/questions/6204341/what-does-the-web-config-file-do-in-the-views-folder-of-a-mvc-project)

在一个 mvc 3 项目中，我看到两个 web.config 文件，一个在根级别，一个在视图中。

视图中的用途是什么？

该 web.config 的一些用例是什么？

# c - 最小/最大/平均语言：c

> ID：10866089
> 
> 赞同：0
> 
> 时间：2012-06-02T21:28:14.343
> 
> 标签：c

我正在尝试编写执行以下操作的程序：

用户必须输入 10 个数字，但也可以选择停止。

然后程序应该输出他输入的数字的最小/最大/平均值。

有人告诉我使用 do/while 循环。

我在代码中，完全卡住了。有人可以给我扔骨头吗？

```
#include <stdio.h>
main(void){
    int n;
    int nummin=5;
    int nummax=5;

    printf("Plese input a number between 1-10: ");
    scanf("%d", &n);
    while (n < 10 || n > 10) {
        printf("Please keep the number between 1-10, try again: "); 
        scanf("%d", &n); 
        }

    if n < nummin 
        n=nummin;
    else if n > nummax
        n=nummax; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-02T21:37:58.597

尝试这个：

```
#include <stdio.h>

int main() {
    int n, i = 0, min = 11, max = -1, sum = 0;

    do {
        printf("Enter a number between 1 and 10, or anything else to stop: ");
        scanf("%d", &n);
        if(max < n) max = n;
        else if(min > n) min = n;
        sum += n;
        i++;
    } while(n <= 10 && n >= 1);

    printf("Min: %d\n", min);
    printf("Max: %d\n", max);
    printf("Avg: %f\n", (float)sum / i);
} 
```

# gwt - 在 Maven 中运行配置

> ID：10866090
> 
> 赞同：1
> 
> 时间：2012-06-02T21:28:17.643
> 
> 标签：gwt, maven, jetty

我想使用 maven 在测试模式下运行我的应用程序。我有一个使用 gwt 的多模块项目。要调试我的应用程序，我想执行以下操作：

*   在展开的目录中运行码头
*   使用 -noserver 选项在托管模式下运行 gwt

现在我必须在 IDE 中手动执行此操作。有没有办法从 Maven 自动执行此操作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-02T23:58:21.667

使用 Maven，您可以使用来在您的*服务器*模块[`jetty-maven-plugin`](http://wiki.eclipse.org/Jetty/Feature/Jetty_Maven_Plugin)中运行 Jetty （使用or目标），并使用来启动 GWT 的 DevMode（使用or目标）。*`start``run`[`gwt-maven-plugin`](http://mojo.codehaus.org/gwt-maven-plugin/)`run``debug`*

 *据我所知，你不能用一个 Maven 命令来做到这一点。

查看[https://github.com/tbroyer/gwt-maven-archetypes](https://github.com/tbroyer/gwt-maven-archetypes)了解此类多模块 GWT 项目的示例配置。*

# jquery - 带有 json 的 jquery 更改 html 部分

> ID：10866092
> 
> 赞同：1
> 
> 时间：2012-06-02T21:29:13.087
> 
> 标签：jquery, json

我有一个 jquery 函数，它返回购物车的总值。该函数如下所示：

```
 function bakVormTotals(targetClass){

      $.getJSON('http://shop.com/cart/?format=json', function(data){

           $.each(data.cart, function(index, totals){
                $('<strong/>').html('€' + totals.grand_total + '').appendTo(targetClass); // the   grand total price
           });
      });
  } 
```

一切正常，除了 totals.grand_total 的结果是

```
€undefined€undefined€undefined€undefined€undefined€undefined€2404.00 
```

其中 €2404.00 是正确的值。可能我必须摆脱 html 部分，因为这会不断返回值。这个对吗？有没有办法解决这个问题？

如果这可能有帮助，我的 json 看起来像这样（缩小）。

```
"totals":{"sub_total":"2020.17","taxes":[{"percentage":"0.1900","amount":383.83}],"grand_total":"2404.00"}} 
```

任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-02T21:31:49.013

你应该这样做`totals.totals.grand_total`：

```
 $('<strong/>').html('€' + totals.totals.grand_total + '').appendTo(targetClass); 
```

# android - 创建我自己的闹钟活动

> ID：10866094
> 
> 赞同：-1
> 
> 时间：2012-06-02T21:29:22.073
> 
> 标签：android, android-alarms

我试图创建一个闹钟应用程序，一旦闹钟响起，它就会执行特定的操作，并且遇到了一些麻烦：

首先，我在玩 AlarmClock() 类，我可以设置的值很少

```
Intent i = new Intent(AlarmClock.ACTION_SET_ALARM);
        i.putExtra(AlarmClock.EXTRA_HOUR, tpSetClock.getCurrentHour());
        i.putExtra(AlarmClock.EXTRA_MINUTES, tpSetClock.getCurrentMinute());
        i.putExtra(AlarmClock.EXTRA_SKIP_UI, true);
        startActivity(i); 
```

我也想修改闹钟的重复和铃声，可以通过AlarmClock()设置吗？

现在跳过闹钟的 UI 后，我想在闹钟触发后启动自己的 Activity，我该怎么做？

在此先感谢，yotam。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-02T21:57:18.533

使用 an`AlarmManager`来显示您自己的活动或执行任何其他操作。这个[问题](https://stackoverflow.com/questions/1082437/android-alarmmanager)包含一堆用法示例。

# c# - 如何使用 AE.Net.Mail 获取纯文本或 Html 文本？

> ID：10866096
> 
> 赞同：1
> 
> 时间：2012-06-02T21:29:24.233
> 
> 标签：c#, email, pop3

我正在尝试使用 AE.Net.Mail 获取电子邮件的纯文本或 HTML 文本。我找不到任何文件。

```
using (Pop3Client pop3 = new AE.Net.Mail.Pop3Client("pop3Server", "login", "pwd", 995, true))
{
   for (var i = pop3.GetMessageCount() - 1; i >= 0; i--)
   {
      MailMessage Msg = pop3.GetMessage(i);
      string HtmlText = Msg.??????
      string PlainText = Msg.??????                
   }
} 
```

编辑：我找到了这个解决方案

```
 IList<Attachment> iList;
   string HtmlText = "", PlainText = "";

   for (var i = pop3.GetMessageCount() - 1; i >= 0; i--)
   {
      MailMessage msg = pop3.GetMessage(i);
      TextBody = msg.Body;
      iList = msg.AlternateViews as IList<Attachment>;
      if (iList.Count == 0) iList = msg.Attachments as IList<Attachment>;
      if (iList.Count > 0)
      {
           TextBody = iList[0].Body;
           HtmlBody = iList[1].Body;
      }
   } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-01T10:44:17.580

我用这种方法解决了这个问题：

首先创建一个类：

```
 class BodyContent
  {
    public string ContentType { get; set; }
    public string Body { get; set; }
  } 
```

比：

```
List<BodyContent> bodies = new List<BodyContent>();
  foreach (AE.Net.Mail.Attachment item in mail.AlternateViews)
  {
    bodies.Add(new BodyContent
    {
      ContentType = item.ContentType,
      Body = item.Body
    });
  } 
```

并且检查有“text/html”：

```
string body="";
      BodyContent bodyTemp= bodies.Find(x => x.ContentType == "text/html");
      if (bodyTemp== null)
        body = mail.Body;
      else
        body = bodyTemp.Body; 
```

如果有“text/html”，则正文格式为 html，否则正文格式为普通格式

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-11-04T13:28:42.260

Body = e.Value.AlternateViews.GetHtmlView().Body,

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-02T21:32:13.780

如果您`MailMessage`是其中`System.Net.Mail`一个，您可以从[`Body`](http://msdn.microsoft.com/en-us/library/system.net.mail.mailmessage.body)属性中获取消息正文。根据`IsBodyHtml`属性，它可以是 HTML 或纯文本。该`AlternateViews`属性还可以包含消息正文的替代形式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-01T12:38:46.860

您必须**仅将标头**设置为**false**

![邮件样本](../Images/cebce4fa288da6a642d8c28e5373bb1b.png)

```
 foreach (var item in mm)
            {
                Email myM = new Email();

                myM.Date = item.Date;

                myM.Body = item.Body; 
```

# javascript - Google Maps InfoBubble pixelOffset（从标记上方的默认位置移动）

> ID：10866098
> 
> 赞同：14
> 
> 时间：2012-06-02T21:29:38.407
> 
> 标签：javascript, google-maps, google-maps-api-3, infobubble

我正在尝试实现一个自定义 infoBubble，它的框打开到标记的一侧，而不是顶部的默认位置。事实证明，这比预期的要难。

使用普通的 infoWindow，您可以使用 pixelOffset。[有关文档](https://developers.google.com/maps/documentation/javascript/reference#InfoWindowOptions)，请参见此处

使用 infoBubble 似乎并非如此。无论如何在 infoBubble 中使用 pixelOffset，或者可以做同样的事情？

我发现这很难搜索，因为使用这样的谷歌搜索不会返回任何相关结果[谷歌搜索](https://www.google.co.uk/search?sugexp=chrome,mod=10&sourceid=chrome&ie=UTF-8&q=google%20maps%20infoBubble%20documentation)

以下是我一直在使用的所有资源。

*   [这里](http://google-maps-utility-library-v3.googlecode.com/svn/trunk/infobubble/examples/example.html?compiled)是 infoBubble 的示例。

*   [我的 JavaScript 在这里](http://jsfiddle.net/ssrP9/5/)设置地图和 infoBubble 。

现在我的 javascript 在这里，以防 jsfiddle 链接损坏。

```
<script type="text/javascript">

    $(document).ready(function () {
        init();
    });

    function init() {

        //Setup the map
        var googleMapOptions = {
            center: new google.maps.LatLng(53.5167, -1.1333),
            zoom: 13,
            mapTypeId: google.maps.MapTypeId.ROADMAP
        };

        //Start the map
        var map = new google.maps.Map(document.getElementById("map_canvas"),
        googleMapOptions);

        var marker = new google.maps.Marker({
            position: new google.maps.LatLng(53.5267, -1.1333),
            title: "Just a test"
        });

        marker.setMap(map);

        infoBubble = new InfoBubble({
            map: map,
            content: '<div class="phoneytext">Some label</div>',
            //position: new google.maps.LatLng(-35, 151),
            shadowStyle: 1,
            padding: '10px',
            //backgroundColor: 'rgb(57,57,57)',
            borderRadius: 5,
            minWidth: 200,
            arrowSize: 10,
            borderWidth: 1,
            borderColor: '#2c2c2c',
            disableAutoPan: true,
            hideCloseButton: false,
            arrowPosition: 7,
            backgroundClassName: 'phoney',
            pixelOffset: new google.maps.Size(130, 120),
            arrowStyle: 2
        });
        infoBubble.open(map, marker);

    }
</script> 
```

**更新**

~~为了帮助回答这个问题，我在这里~~整理了一个测试用例。重要的行是第 38 和 39 行，它们应该指定放置标签的位置。

**更新 2**

为了获得赏金，我需要查看一个 infoBubble 的示例，该示例的位置远离标记上方的默认位置。最好在标记的右手边。

**更新 3**

我已从更新 1 中删除了测试用例，因为它托管在我旧公司的服务器上。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-19T05:48:24.543

这是我的解决方案。

在`InfoBubble`图书馆

代替

整个`InfoBubble.prototype.draw` 方法

和

```
/*
 * Sets InfoBubble Position
 * */
InfoBubble.prototype.setBubbleOffset = function(xOffset, yOffset) {
  this.bubbleOffsetX = parseInt(xOffset);
  this.bubbleOffsetY = parseInt(yOffset);
}

/*
 * Gets InfoBubble Position
 * */
InfoBubble.prototype.getBubbleOffset = function() {
  return {
    x: this.bubbleOffsetX || 0,
    y: this.bubbleOffsetY || 0
  }
}

/**
 * Draw the InfoBubble
 * Implementing the OverlayView interface
 */
InfoBubble.prototype.draw = function() {
  var projection = this.getProjection();

  if (!projection) {
    // The map projection is not ready yet so do nothing
    return;
  }

  var latLng = /** @type {google.maps.LatLng} */ (this.get('position'));

  if (!latLng) {
    this.close();
    return;
  }

  var tabHeight = 0;

  if (this.activeTab_) {
    tabHeight = this.activeTab_.offsetHeight;
  }

  var anchorHeight = this.getAnchorHeight_();
  var arrowSize = this.getArrowSize_();
  var arrowPosition = this.getArrowPosition_();

  arrowPosition = arrowPosition / 100;

  var pos = projection.fromLatLngToDivPixel(latLng);
  var width = this.contentContainer_.offsetWidth;
  var height = this.bubble_.offsetHeight;

  if (!width) {
    return;
  }

  // Adjust for the height of the info bubble
  var top = pos.y - (height + arrowSize) + this.getBubbleOffset().y;

  if (anchorHeight) {
    // If there is an anchor then include the height
    top -= anchorHeight;
  }

  var left = pos.x - (width * arrowPosition) + this.getBubbleOffset().x;

  this.bubble_.style['top'] = this.px(top);
  this.bubble_.style['left'] = this.px(left);

  var shadowStyle = parseInt(this.get('shadowStyle'), 10);

  switch (shadowStyle) {
    case 1:
      // Shadow is behind
      this.bubbleShadow_.style['top'] = this.px(top + tabHeight - 1);
      this.bubbleShadow_.style['left'] = this.px(left);
      this.bubbleShadow_.style['width'] = this.px(width);
      this.bubbleShadow_.style['height'] =
        this.px(this.contentContainer_.offsetHeight - arrowSize);
      break;
    case 2:
      // Shadow is below
      width = width * 0.8;
      if (anchorHeight) {
        this.bubbleShadow_.style['top'] = this.px(pos.y);
      } else {
        this.bubbleShadow_.style['top'] = this.px(pos.y + arrowSize);
      }
      this.bubbleShadow_.style['left'] = this.px(pos.x - width * arrowPosition);

      this.bubbleShadow_.style['width'] = this.px(width);
      this.bubbleShadow_.style['height'] = this.px(2);
      break;
  }
}; 
```

然后你可以使用它

```
var infoBubble = new InfoBubble({
  map: map,
  content: "My Content",
  position: new google.maps.LatLng(1, 1),
  shadowStyle: 1,
  padding: 0,
  backgroundColor: 'transparent',
  borderRadius: 7,
  arrowSize: 10,
  borderWidth: 1,
  borderColor: '#2c2c2c',
  disableAutoPan: true,
  hideCloseButton: true,
  arrowPosition: 50,
  backgroundClassName: 'infoBubbleBackground',
  arrowStyle: 2

}); 
```

然后最后我们必须使用这个方法`setBubbleOffset(x,y);`来设置 InfoBubble 位置

```
infoBubble.setBubbleOffset(0,-32); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-06-05T21:09:58.883

似乎 infoBubble 库本身默认将气泡定位在它所绑定的标记上方。看看他们包含在库中的示例文件：[http](http://code.google.com/p/google-maps-utility-library-v3/source/browse/trunk/infobubble/examples/example.html) ://code.google.com/p/google-maps-utility-library-v3/source/browse/trunk/infobubble/examples/example.html 。特别注意从第 99 行到第 122 行以及两个信息气泡的使用。第一个绑定到标记，但是第二个是独立的，因此如果您看到第 106 行，您可以为其定义一个位置。现在，基于这种理解，我在这个小提琴[http://jsfiddle.net/pDFc3/](http://jsfiddle.net/pDFc3/)中为您创建了一个示例。infoBubble 位于标记的右侧。

这很奇怪，因为 infoBubble js 库有一个 setPosition 函数（[http://code.google.com/p/google-maps-utility-library-v3/source/browse/trunk/infobubble/src/infobubble.js? r=206](http://code.google.com/p/google-maps-utility-library-v3/source/browse/trunk/infobubble/src/infobubble.js?r=206)）见第 1027 行。但由于某种原因，在我等待 DOM 加载并尝试通过 go 更改位置后，`infoBubble.setPosition(newLatLng);`我无法工作。相反，`infoBubble.getPosition();`在 DOM 加载后声明会给我 infoBubble 绑定到的标记的当前位置。所以 setPosition() 可能在 js 库中有一个错误，因为我相信它仍在处理中（我可能是错的，也许它只是错误）。

* * *

我已经修复了我的 jsFiddle 以解决您在放大和缩小时的问题，并相应地定位 infoBubble ( [http://jsfiddle.net/pDFc3/](http://jsfiddle.net/pDFc3/) )。我先解释一下逻辑。首先，谷歌地图上道路地图类型的最大缩放级别是 21 - 这个值与卫星图像不一致，但用户可以去的最大缩放是 21。从 21 开始，每次缩小两点之间的差异可以是基于以下逻辑保持一致的“屏幕上”：

```
consitent_screen_dist = initial_dist * (2 ^ (21 - zoomlevel)) 
```

在我们的例子中，初始距离的合理值是 0.00003 度（在标记和 infoBubble 之间）。因此，基于这个逻辑，我添加了以下部分来查找标记和 infoBubble 之间的初始纵向距离：

```
var newlong = marker.getPosition().lng() + (0.00003 * Math.pow(2, (21 - map.getZoom()))); 
```

同样，为了确保每次缩放级别更改时的距离保持一致，我们只需在侦听缩放级别的更改时声明一个新的经度：

```
 google.maps.event.addListener(map, "zoom_changed", function() {
        newlong = marker.getPosition().lng() + (0.00003 * Math.pow(2, (21 - map.getZoom())));
        infoBubble.setPosition(new google.maps.LatLng(marker.getPosition().lat(), newlong));                
    }); 
```

请记住，您可以通过为 marker.getPosition 声明变量和通过方法调用的其他值来提高此代码的效率。这样就不会重复调用方法并减慢您的代码速度。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-04T15:52:26.093

不幸的是，InfoBubble 中没有像 pixelOffset 这样的选项。但是，如果您只想在示例中将 Bubble 向上移动到标记上方，则不应在气泡初始化时设置**map参数。**考虑以下小提琴（我为你修好了）：

[http://jsfiddle.net/ssrP9/5/](http://jsfiddle.net/ssrP9/5/)

* * *

PS您的小提琴不起作用，因为您没有正确添加资源 [http://doc.jsfiddle.net/basic/introduction.html#add-resources](http://doc.jsfiddle.net/basic/introduction.html#add-resources)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-17T14:40:06.820

我刚刚遇到完全相同的问题，但在任何地方都找不到答案。通过一些试验和错误，我解决了这个问题。

您将使用“infoBubble”的 Google JS 文件。进入该文件并搜索...

```
InfoBubble.prototype.buildDom_ = function() { 
```

对我来说，这是在第 203 行（但这可能是之前改组和编辑的结果）。

在该函数中，您将看到位置“绝对”声明。在新行上，您可以添加 marginTop、marginRight、marginBottom 和 marginLeft。这会将气泡从其默认位置轻推（这也取决于配置中的箭头位置声明）...

这是我在气泡 JS 文件中的代码调整，它将气泡定位在标记的顶部（由于设计特性）...

```
var bubble = this.bubble_ = document.createElement('DIV');
bubble.style['position'] = 'absolute';
bubble.style['marginTop'] = this.px(21);
bubble.style['marginLeft'] = this.px(1);
bubble.style['zIndex'] = this.baseZIndex_; 
```

希望有帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-05T17:39:58.843

您还可以使用定义的锚高度；

```
var anchorHeight = YOURNUMBER; 
```

第 874 行 infobubble.js

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-12-15T12:31:47.833

在 InfoBubble buildDom 函数中，添加：

```
bubble.className = 'bubble-container'; 
```

现在每个 InfoBubble 都有一个 CSS 类，您可以使用 CSS 边距移动它。

# php - 设置 cookie 并调用它后收到错误

> ID：10866101
> 
> 赞同：0
> 
> 时间：2012-06-02T21:30:06.953
> 
> 标签：php, cookies, multilingual

> **可能重复：**
> [在 setcookie() 之后立即访问 $_COOKIE](https://stackoverflow.com/questions/3230133/accessing-cookie-immediately-after-setcookie)

所以我使用下面的代码向我的网站添加多语言功能：

```
if(isset($_GET['lang']) && $_GET['lang'] != ""){
setcookie("lang", $lang, time()+360*360*3600);
}elseif(!isset($_COOKIE["lang"]) || $_COOKIE["lang"] == ""){
setcookie("lang", "en", time()+360*360*3600);
}
include 'lang/'.$_COOKIE["lang"].'.php'; 
```

现在，当此代码第一次执行时，它找不到 `$_COOKIE["lang"] 并因此无法打开文件，但是当我刷新页面后，它加载得很好。我想知道我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-02T21:36:22.067

cookie 仅在您发出请求时设置。

这就是它的工作原理（它随每个请求一起发送）。而且由于您仍在同一个请求中，因此它根本不存在。

但是你可以自己设置：

```
if (isset($_GET['lang']) && $_GET['lang'] != "") {
    $_COOKIE['lang'] = $lang;
    setcookie("lang", $lang, time()+360*360*3600);
} elseif ... 
```

这也许就是您正在寻找的解决方法。

# javascript - 在 HTML5 的画布元素中使用 Zigfu (kinect)

> ID：10866110
> 
> 赞同：0
> 
> 时间：2012-06-02T21:31:45.380
> 
> 标签：javascript, html, kinect

我浏览了 Zigfu 网站上制作用户雷达的初始教程。我无法让这个雷达在画布元素中工作。

我想在画布中使用绘图方法，所以我不希望它在容器中。

这是我到目前为止直接取自教程的代码。非常感谢您的阅读！

```
function loaded() {

   var radardiv = document.getElementById('container');

   var radar = {
      onuserfound: function (user) {
        var userdiv = document.createElement('div');
        userdiv.className = 'user';
        user.radarelement = userdiv;
        radardiv.appendChild(user.radarelement);
      },
      onuserlost: function (user) {
        radardiv.removeChild(user.radarelement);
      },
      ondataupdate: function (zigdata){
        for (var userid in zigdata.users){
            var user = zigdata.users[userid];
            var pos = user.position;
          //console.log(pos);
            var el = user.radarelement;
            var parentElement = el.parentNode;
            var zrange = 2000;
            var xrange = 700;
            var pixelwidth = parentElement.offsetWidth;
            var pixelheight = parentElement.offsetHeight;
            var heightscale = pixelheight / zrange;
            var widthscale = pixelwidth / xrange;
            el.style.left = (((pos[0] / xrange) + 0.5) * pixelwidth - (el.offsetWidth / 2)) + "px";
            el.style.top = ((pos[2] / zrange) * pixelheight - (el.offsetHeight / 2)) - 150 + "px";
        }

      }
   };

   zig.addListener(radar);
}
document.addEventListener('DOMContentLoaded', loaded, false);

<body>

<div id = 'container'></div>
</body>
</html>

<style>
div#container {
width: 800px;
height: 600px;
border: 1px solid black;
overflow: hidden;
 }
 div.user {
position: relative;
width: 10px;
height: 10px;
background-color: red;
  } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T04:09:01.100

本教程中使用的雷达使用 DOM div 放置和定位。
不幸的是，这不能在画布元素中使用。

有多种方法可以覆盖画布和其他解决方法。请参阅：[在 <canvas> 中放置 <div>](https://stackoverflow.com/questions/5763911/placing-a-div-within-a-canvas)

您也可以直接从插件中获取数据并自己绘制到画布上。这是一个使用 three.js 和 zigfu 将骨架绘制到画布上的演示： [http ://blog.kinect.tonkworks.com/post/30569123887/kinect-online-app-javascript-dev-tutorial-1](http://blog.kinect.tonkworks.com/post/30569123887/kinect-online-app-javascript-dev-tutorial-1)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-03T15:31:42.053

似乎您缺少`javascript 周围的标签，以及一些用于用户雷达的 css。另外-您的“容器” div 缺少 >`

 `[尝试从http://zigfu.com/en/zdk/tutorials/](http://zigfu.com/en/zdk/tutorials/)底部复制代码，或者 - 查看[http://zigfu.com/en/zdk/recipes/#omercy16](http://zigfu.com/en/zdk/recipes/#omercy16)以获得更简洁的用户实现雷达。`

# excel - 如果 Excel 单元格不在范围之间，则格式化多行

> ID：10866112
> 
> 赞同：0
> 
> 时间：2012-06-02T21:31:50.977
> 
> 标签：excel, vba, formatting, conditional

我分别在 A 列和 B 列中有一个低数字和一个高数字。在 C 到 ZI 列中有数字。

此模式重复许多行，每行具有不同的低和高。

我正在尝试有条件地格式化列 C 到 Z 中的任何单元格，如果它们落在两个数字之外......然后移动到下一行并对新的低值和高值执行相同的操作。

我尝试使用 Excel 2010 中的条件格式功能，但当我尝试对低列和高列使用锚点时，它似乎不起作用。有没有办法用 VBA 做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-02T21:58:17.463

你不应该需要 VBA - 试试这个：

选择列 C 到 Z

条件格式 > 新规则 > 使用公式确定要格式化的单元格 > 在公式框中键入此公式

`=AND(C1<>"",OR(C1<$A1,C1>$B1))`

选择所需的格式 > 确定

这应该是您所需要的 - 确保公式与上面完全相同，包括 $ 符号

# ios - 核心数据多个 managedObjectContexts

> ID：10866114
> 
> 赞同：1
> 
> 时间：2012-06-02T21:32:03.393
> 
> 标签：ios, core-data

更新：请注意，这里的实际问题更多不是核心数据，而是我的错误属性声明​​ - 强/弱 - 导致对象在新视图的 viewWillLoad 和 viewDidLoad 之间被释放。

我正在阅读 Tim Isted 关于 iOS 中的核心数据的书，到目前为止一直做得很好。我正在尝试遵循新的 viewController 如何使用第二个 managedObjectContext - 下面的 editingContext - 在保存之前捕获文本字段中的更改。

```
- (void)setCurrentPerson:(AWPerson *)aPerson {
    if( !aPerson )
    {
        aPerson = [AWPerson randomPersonInManagedObjectContext:self.editingContext];
    }
    else if( [aPerson managedObjectContext] != self.editingContext ) {
        self.title = @"Edit person";
        aPerson = (id)[self.editingContext objectWithID:[aPerson objectID]];
    }
    [...]
} 
```

此时： `aPerson = (id)[self.editingContext objectWithID:[aPerson objectID]];` 当我在调试器中为 aPerson 打印描述时，我应该得到

```
<AWPerson: 0x6b5de70> (entity: Person; id: 0x6b5bb60 <x-coredata://A6EC85F2-81A8-488F-B2E3-F82687C252A2/Person/p1> ; data: {
    dateOfBirth = "1973-11-03 12:53:58 +0000";
    eyeColor = "(...not nil..)";
    firstName = Peter;
    lastName = Dickens;
    yearOfBirth = 1973; 
```

相反，我得到以下`<fault>`替换值的地方

```
<AWPerson: 0x6b609d0> (entity: Person; id: 0x6b5bb60 <x-coredata:
//A6EC85F2-81A8-488F-B2E3-F82687C252A2/Person/p1> ; data: <fault>) 
```

我真的看不到发生了什么。在 aPerson 行之前有值，在行之后，它们被替换。任何帮助将不胜感激。

谢谢，史蒂夫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-02T22:38:28.617

我没有那本书，但我会尽力帮助...

但是，在我看来并没有错。它看起来正是我所期望的（假设在调用 setCurrentPerson 时 aPerson 生活在不同的上下文中）。我将尝试浏览您发布的代码。也许我可以确定您的问题是什么，并在此过程中以某种方式提供答案。我的评论作为评论包含在代码中。

```
- (void)setCurrentPerson:(AWPerson *)aPerson {
    if( !aPerson )
    {
        // The aPerson object we were given is nil, so get one in the
        // current editingContext.
        aPerson = [AWPerson randomPersonInManagedObjectContext:self.editingContext];
    }
    else if( [aPerson managedObjectContext] != self.editingContext ) {
        // The aPerson object does not live in editingContext.  However, apparently
        // we want to make sure it lives in the editingContext.  Remember, each managed
        // that has been saved will have a permanent object-id.  Any context can use
        // the object-id to fetch an object into its own ManagedObjectContext.
        self.title = @"Edit person";
        aPerson = (id)[self.editingContext objectWithID:[aPerson objectID]];

        // Now, aPerson will point to an object that lives in the MOC editingContext.
        // However, if it was not previously registered in that MOC, it will be returned
        // as a fault.  This does not mean the object is not there, but this MOC has
        // not loaded its data.  As soon as you cal a method that needs the data,
        // it will be faulted into memory.

        // One way, is to access any of its properties.
        NSLog(@"firstName = %@", [aPerson valueForKey:@"firstName"]);

        // You can query an object to see if it is a fault.  NO means it's
        // not a fault, and the properties should all be in memory.  YES, does not mean
        // the data is NOT in memory though... it could be in a cache...

        // You can manually fault the object into memory, but I would
        // suggest you read all the documentation before using this, because it has
        // side effects.  Consider...
        if ([aPerson isFault]) {
            [self.editingContext refreshObject:aPerson mergeChanges:YES];
        }

        // NOTE: In general, you just want the object management system itself
        // to manage faults.  However, if you really want to see that your objects
        // are what they are supposed to be, you can do any of this to examine them.
    }
    [...]
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-02T23:11:27.577

您的代码没有任何问题。

A`fault`是 CoreData 表示指向存储中存在但尚未获取的对象的指针的方式。

这主要是出于性能原因，并且一旦您访问 Person 对象的任何属性，即`firstName`等`lastName`。Coredata 将从存储中搜索并检索该实体，然后您的 NSLog 描述将匹配您在第一个示例中看到的内容.

# jquery - 如何使用数据库值填充 JQuery 数组

> ID：10866115
> 
> 赞同：1
> 
> 时间：2012-06-02T21:32:05.527
> 
> 标签：jquery, ruby-on-rails

我正在使用 JQuery 和 Rails 开发一个自动完成表单。但是我不知道如何将值从我的数据库中提取到 JQuery（我相信这必须通过 Rails 完成）。

这是我在 jQuery 中的自动完成功能

```
<script>
  $(document).ready(function() {
    $( "#BOOKSEARCH" ).autocomplete({
        source: programmingLang
    });
});
var programmingLang = ["ActionScript","AppleScript","Asp","BASIC","C","C++",
    "Clojure","COBOL","ColdFusion","Erlang","Fortran","Groovy","Haskell",
    "Java","JavaScript","Lisp","Perl","PHP","Python","Ruby","Scala","Scheme"];
</script> 
```

然而，目前自动完成从硬编码数组中填充。如何用 Rails 中的数据值填充这个数组？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-02T21:41:30.117

试试这个：

```
 var programmingLang = <%= Language.all.map(&:name).to_json.html_safe %>; 
```

假设您有一个具有名称列的模型语言

*确保您没有数千个或记录，因为这会减慢甚至可能引发超时错误。在这种情况下，您应该使用 ajax。有几个答案可以解释 ajax 的事情。*

或者

```
 var programmingLang = <%= ruby_array.to_json.html_safe %>; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-02T21:41:16.230

您可以通过对返回此数组的操作的简单 AJAX 请求来做到这一点：

```
$(document).ready(function() {
  $.get('path-to-json', function(data){
    $( "#BOOKSEARCH" ).autocomplete({
      source: data
    });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-02T21:43:02.527

您的 Rails 控制器需要返回一个包含这些值的数组（或 json 对象，取决于您的 js 要求）。
您可以通过简单的[ajax](http://api.jquery.com/jQuery.ajax/)调用调用此控制器来检索数据。
一旦你有了数据，你就可以用同样的方式填充它。[您可以在此处](http://net.tutsplus.com/tutorials/javascript-ajax/using-unobtrusive-javascript-and-ajax-with-rails-3/)
找到有关 rails ajax 的更多信息。

# android - 如何根据本地 xml 文件时间值创建 android 通知？

> ID：10866118
> 
> 赞同：0
> 
> 时间：2012-06-02T21:32:15.317
> 
> 标签：android, notifications

如何在 android 应用程序上实现通知功能，其中在 xml 上找到的设定时间，应用程序将显示通知？

假设一个本地 xml 文件的值是 notifyat=5:00pm，所以我希望应用程序每天都根据该值显示通知？

我一直在阅读本教程[http://www.vogella.com/articles/AndroidNotifications/article.html](http://www.vogella.com/articles/AndroidNotifications/article.html)

如何让应用程序每天自动读取 xml 文件并在指定时间向我显示通知？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-02T22:03:16.557

为了做这样的事情，您将需要使用 AlarmManager。以下是在此特定时间运行代码的示例：

```
 // create intent
    launchIntent = new Intent(this, MyAlarmReceiver.class);
    pendingIntent = PendingIntent.getBroadcast(this, 0, launchIntent, 0);

    AlarmManager alarmManager = (AlarmManager) getSystemService(Context.ALARM_SERVICE);
    long interval = TimeUnit.DAYS.toMillis(1); // the interval is one day
    long firstTime = 0;

    // create a Calendar object to set the real time at which the alarm
    // should go off
    Calendar alarmTime = Calendar.getInstance();
    alarmTime.set(Calendar.HOUR_OF_DAY, 17);
    alarmTime.set(Calendar.MINUTE, 0);
    alarmTime.set(Calendar.SECOND, 0);

    Calendar now = Calendar.getInstance();
    // set the alarm for today at 5pm if it is not yet 5pm
    if (now.before(alarmTime)) {
        firstTime = alarmTime.getTimeInMillis();
    } else {
        // set the alarm for the next day at 5pm if it is past 5pm
        alarmTime.add(Calendar.DATE, 1);
        firstTime = alarmTime.getTimeInMillis();
    }
    // Repeat every day at 5pm
    alarmManager.setRepeating(AlarmManager.RTC_WAKEUP, firstTime, interval,
            pendingIntent); 
```

“MyAlarmReceiver”类是您放置启动通知的代码的地方。确保在 AndroidManifest 中声明您的 BroadcastReceiver 类。

# bit-shift - 使用位移求整数平方根的最快方法是什么？

> ID：10866119
> 
> 赞同：6
> 
> 时间：2012-06-02T21:32:23.950
> 
> 标签：bit-shift, memory-efficient, square-root

我正在寻找计算数字（整数）平方根（整数）的最快方法。我在维基百科中遇到了这个解决方案，它找到一个数字的平方根（如果它是一个完美的平方）或它最近的下完美平方的平方根（如果给定的数字不是一个完美的平方：

```
short isqrt(short num) {
    short res = 0;
    short bit = 1 << 14; // The second-to-top bit is set: 1L<<30 for long
    // "bit" starts at the highest power of four <= the argument.
    while (bit > num)
        bit >>= 2;
    while (bit != 0) {
        if (num >= res + bit) {
            num -= res + bit;
            res = (res >> 1) + bit;
        }
        else
            res >>= 1;
        bit >>= 2;
    }
    return res;
} 
```

我尝试了很多测试运行来跟踪算法，但我似乎不理解里面的部分`while(bit!=0)`。有人可以向我解释这部分吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-30T00:37:01.250

我也追踪了一些小例子，我想我明白了。据我了解，该算法一次建立一个二进制数字的答案，从最高位到最低位。

让“num_init”是函数开头的 num 的值。假设在某个迭代中，我们有 bit = 4^x 并且 num 等于某个值“num_curr”（快速浏览一下，直到 bit 为 0，它始终是 4 的幂）。那么 res 的形式为 y*2^(x+1)，其中 y^2 + num_curr = num_init，并且 y 小于实际答案，但在 2^x 之内。

这个关于 num、res 和 bit 值的不变量将是关键。在代码中完成的方式是

```
while (bit != 0) {
    ....
} 
```

正在将我们的假想指针从左向右移动，并且在每一步我们都确定该位是 0 还是 1。

转到第一个 if 语句，假设我们想象的“累积”整数等于 y，我们正在查看 2^x 位。然后，如果 num 的原始值至少为 (y + 2^x)^2 = y^2 + y*2^(x+1) + 4^x，则该位为 1。换句话说，如果 num 在该点的值至少为 y*2^(x+1) + 4^x，则该位为 1（因为我们有 num 的值下降 y^2 的不变量） . 很方便，res = y*2^(x+1) 和 bit = 4^x。然后我们得到后面的点

```
if (num >= res + bit) {
    num -= res + bit;
    res = (res >> 1) + bit;
}
else 
    res >>= 1; 
```

如有必要，它会在我们的虚构位置添加 1 位，然后更新 res 和 num 以保持不变。最后

```
bit >>= 2; 
```

更新位并一步一步移动所有内容。

# php - 找不到 Symfony2 身份验证“login_check”路径

> ID：10866123
> 
> 赞同：2
> 
> 时间：2012-06-02T21:32:57.570
> 
> 标签：php, security, symfony

我是 Symfony2 的新手，我正在尝试创建一个基本的注册 + 登录系统。因此，在 Symfony2 文档的帮助下，我创建了这个 security.yml：

```
security:
    encoders:
        TestCompany\InternetBundle\Entity\Member:
            algorithm:        sha1
            encode_as_base64: false
            iterations:       1

    role_hierarchy:
        ROLE_ADMIN:       ROLE_USER
        ROLE_SUPER_ADMIN: [ ROLE_USER, ROLE_ADMIN, ROLE_ALLOWED_TO_SWITCH ]

    providers:
        administrators:
            entity: { class: TestCompanyInternetBundle:Member, property: username }

    firewalls:
        admin_area:
            pattern:    ^/admin
            anonymous: ~
            form_login:
                login_path:  /login
                check_path:  /login_check

    access_control:
        - { path: ^/admin, roles: ROLE_ADMIN } 
```

我为此使用了此路由：

```
login_check:
    pattern:   /login_check
login:
    pattern:  /login
    defaults: { _controller: TestCompanyInternetBundle:Admin:login } 
```

根据[http://symfony.com/doc/current/book/security.html#using-a-traditional-login-form](http://symfony.com/doc/current/book/security.html#using-a-traditional-login-form)我不需要为 login_check 路由实现控制器。然而，Symfony 将这个错误返回给我：

```
Unable to find the controller for path "/login_check". Maybe you forgot to add the matching route in your routing configuration? 
```

你看到我在这里做错了什么吗？登录页面几乎与文档中使用的页面完全相同。错误发生在页面：`http://localhost/SymfonyTest/web/app_dev.php/login_check`，这是我使用登录表单后发送到的页面。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T16:06:49.727

[http://symfony.com/doc/current/book/security.html#using-a-traditional-login-form](http://symfony.com/doc/current/book/security.html#using-a-traditional-login-form)

确保`/login_check`在防火墙后面。

**因此，在您的示例中，您为安全区域指定了 /admin 前缀，因此您的登录检查路由也应该具有该前缀，例如 /admin/login_check**

接下来，确保您的 check_path URL（例如 /login_check）位于您用于表单登录的防火墙之后（在此示例中，单个防火墙匹配所有 URL，包括 /login_check）。如果 /login_check 不匹配任何防火墙，您将收到 Unable to find the controller for path "/login_check" 异常。

示例`security.yml`配置：

```
firewalls:
    dev:
        pattern:  ^/(_(profiler|wdt)|css|images|js)/
        security: false

    secured_area:
        pattern:    ^/
        form_login:
            login_path: /login
            check_path: /login_check
        logout:
            path:   /demo/secured/logout
            target: /demo/
        anonymous: ~

    ....

    access_control:
        - { path: ^/admin, roles: ROLE_ADMIN } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-04T13:40:54.640

我建议您使用 FOSUserBundle，因为这似乎是执行您想做的最快的方法：[FOSUserBundle](https://github.com/FriendsOfSymfony/FOSUserBundle)

安装非常简单，可以让您在很短的时间内让您的应用程序运行。祝你好运！

编辑：

你能发布你的控制器 TestCompanyInternetBundle:Admin:login 吗？您的控制器是否完全扩展了安全控制器？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T00:21:53.907

您还应该包含您的 security.yml。确保你有：

```
firewalls:
    login_firewall:
        pattern:    ^/login$
        anonymous:  ~ 
```

在你的 security.yml 中。这是一个常见的陷阱。

# c - 在字符串 S 中找到包含字符串 T 的所有字符的最小窗口

> ID：10866124
> 
> 赞同：2
> 
> 时间：2012-06-02T21:33:36.407
> 
> 标签：c, string, algorithm

> 给定一个字符串 S 和一个字符串 T，找到 S 中包含 T 中所有字符的最小窗口，复杂度为 O(n)。

例如，

```
S = "ADOBECODEBANC"
T = "ABC" 
```

最小窗口为`"BANC"`。

```
void getstring(char str1[],char str2[],char hash[])
{

    int len=strlen(str1);
    int i=0,j;              //i keeps the previous index
    int min=INT_MAX;
    int cnt=0;  
    for(j=0;j<len;j++)
        {
            if(hash[str1[j]]==-1)   //means uninitialized, will be checked for first time only
            {

                cnt++;              
                hash[str1[j]]=j;                    

                if(cnt==1)
                i=j;

                int y=check(hash,str2); //checking for the characters
                //printf("y=%d",y);
                if(y)       //means all the characters are present
                {
                    if( (j-i+1)<min)
                    {
                    min=j-i+1;
                    I=i;
                    J=j;
                    }               

                }

               }
                else if(hash[str1[j]]>=0)
                {

                    hash[str1[j]]=j;

                    if(check(hash,str2) )
                    {                   

                    if( hash[str1[i]]==hash[str1[j]] )      //it means that we are moving the first
                    {                       //index only
                    i=getmin(hash,str2);    //get minimum index of the element              

                        if( (j-i+1)<min)
                        {
                            min=j-i+1;
                            I=i;
                            J=j;
                        }

                    }
                    //else
                    }
                    else
                    {
                    if( hash[str1[i]]==hash[str1[j]] )
                    i=hash[str1[i]];                        
                    }

                }//end of else-if
                }//end of for    
} 
```

我已经使用哈希为其编写了代码，即我将字符串 T 的字符的索引值保留在哈希中并使用两个索引，只要我前面的任何字符与较低索引处的字符相同，我首先检查长度，然后更新索引。

这种方法在最坏的情况下需要 O(nk)。

```
n - is the number of characters in S
k - is the number of characters in T 
```

有没有什么方法需要`O(n)`时间来解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-02T22:12:42.627

因此，通过 S 记录您最后一次看到 T 中的每个字母的时间。

在每个点，最后看到的字母中最远的一个将界定窗口的左边缘（当前点是右边缘）。

在这些窗口中，只需跟踪迄今为止看到的最小的一个。在算法结束时，这将是整体上最小的窗口。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-06T08:10:05.367

这是我通过所有测试用例的java代码。我希望它也能帮助你。

```
public class Solution {
    public String minWindow(String s, String t) {

         if(t.length()>s.length()) 
        return "";
    String result = "";

     HashMap <Character, Integer> shouldFind = new HashMap<Character, Integer>();
     HashMap <Character, Integer> hasFound = new HashMap<Character, Integer>();
     int count =0, j=0,  minWindow = s.length()+1, start=0, finish =0;

     Integer sLength = s.length();
     Integer tLength = t.length();

     for(int i = 0 ; i < tLength ; i++)
     {
         char tChar = t.charAt(i);
         if(!shouldFind.containsKey(tChar))
         shouldFind.put(tChar,1);
         else 
         shouldFind.put (tChar ,shouldFind.get(tChar)+1);

     }

     for (int i =0; i <sLength; i ++)
     {
         char sChar = s.charAt(i);

         if(shouldFind.containsKey(sChar))
         {
             if(!hasFound.containsKey(sChar)){
             hasFound.put(sChar, 1);
             count++;
             }
             else {
                 if(hasFound.get(sChar) < shouldFind.get(sChar) )
                 count ++;

             hasFound.put(sChar, hasFound.get(sChar) +1);

             }
         }

        if(count == tLength)
        {
            char ch = s.charAt(j);

          while (!hasFound.containsKey(ch) || hasFound.get(ch) > shouldFind.get(ch))
          {
              if(hasFound.containsKey(ch) && hasFound.get(ch)>shouldFind.get(ch))
              hasFound.put(ch , hasFound.get(ch) -1);

              j++;
              ch = s.charAt(j);
          }

            //lets find the minimum window
            if(minWindow > (i-j+1) )
            {
                minWindow = i - j + 1;
                start = j;
                finish = i+1;
                result = s.substring(start, finish);

            }

        }}

        return result;
    }} 
```

# c# - 内部声明变量的 T-SQL 参数化查询？

> ID：10866127
> 
> 赞同：3
> 
> 时间：2012-06-02T21:34:09.450
> 
> 标签：c#, .net, tsql, ado.net

这是我正在尝试执行的代码：

```
const string Script = @"
DECLARE @AccountKey Int
SELECT @AccountKey = AccountKey FROM dbo.CREAccount WHERE AccountId = @AccountId 
INSERT dbo.CREException (CreatedOn, Message, Source, StackTrace, AccountKey, Category, Priority)
VALUES(GETUTCDATE(), @Message, @Source, @StackTrace, @AccountKey, @Category, @Priority)";

using (var command = new SqlCommand(Script, connection))
{
    var message = ex.Message;
    if (message.Length > 250) message = message.Substring(0, 250);

    command.Parameters.Add(new SqlParameter("@Message", message));
    command.Parameters.Add(new SqlParameter("@Source", ex.Source ?? string.Empty));
    command.Parameters.Add(new SqlParameter("@StackTrace", ex.StackTrace ?? string.Empty));
    command.Parameters.Add(new SqlParameter("@AccountId", accountId));
    command.Parameters.Add(new SqlParameter("@Category", category));
    command.Parameters.Add(new SqlParameter("@Priority", priority));

    command.ExecuteNonQuery();
} 
```

正如预期的那样——它失败了，因为@AccountKey 没有在代码中指定——它是 T_SQL 本身的一个参数。使用参数时如何实现我想要的？`accountId`参数可以是`null`- 这就是我分解查找并插入 2 个查询的原因

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-02T21:41:04.663

难道你不能把你的 T-SQL 重写为：

```
INSERT INTO 
   dbo.CREException(CreatedOn, Message, Source, StackTrace, AccountKey, Category, Priority)
   SELECT       
      GETUTCDATE(), @Message, @Source, @StackTrace, 
      AccountKey, @Category, @Priority
   FROM 
      dbo.CREAccount 
   WHERE 
      AccountId = @AccountId 
```

您仍然拥有所有参数，并且您正在`AccountKey`从`dbo.CREAccount`表中确定值，如您的示例中所示。

也许您需要考虑提供一个“默认”值`AccountKey`，以防在表中找不到值...

或者如果由于某种原因这不起作用，那么我可能只是将这两个或三个 T-SQL 语句包装到一个存储过程中，您可以使用参数调用该存储过程，并让该过程处理您可能需要的所有额外步骤……

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-02T22:03:53.977

您是否尝试将 @AccountKey 作为 sqlparmae​​ter 包含在内，但将其方向更改为输出？这样，您仍然应该能够在其中选择一个值

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-02T22:49:09.943

根据对 marc_s 答案的反馈，您总是可以让您的 sql 看起来像这样。

```
INSERT dbo.CREException (CreatedOn, Message, Source, StackTrace, AccountKey, Category, Priority)
VALUES(GETUTCDATE(), @Message, @Source, @StackTrace
,(SELECT AccountKey FROM dbo.CREAccount WHERE AccountId = @AccountId)
, @Category, @Priority) 
```

如果您想要帐户密钥的默认值，则很容易合并结果

# html - IE 类：活动图像不工作

> ID：10866128
> 
> 赞同：0
> 
> 时间：2012-06-02T21:34:24.830
> 
> 标签：html, css, internet-explorer

我在 Internet Explorer 中遇到问题。Chrome 和 Firefox 都可以。

问题是当我有一个按钮时：即使我将按钮和图像悬停在 IE 中，悬停效果也有效，但是如果我单击图像中的 (:active) 则不起作用。如果是文本或 div，也会发生同样的情况。

有转机吗？

这是一个[示例](http://jsfiddle.net/7mwHe/1/)，只需尝试单击 facebook 图标，它应该在 IE 上变为红色，但似乎没有单击，只有在我单击黄色区域时才有效。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-03T04:21:27.820

试试这个例子：http: [//jsfiddle.net/7mwHe/4/](http://jsfiddle.net/7mwHe/4/)

我已将图标制作成（base64 编码的）背景图像（并从 512x512px 缩小到 20x20px！）

在 Internet Explorer、Firefox、Chrome 和 Opera 上测试。

# xcode - 将文档保存到 Internet，以便其他用户共享

> ID：10866130
> 
> 赞同：0
> 
> 时间：2012-06-02T21:34:44.560
> 
> 标签：xcode, cocoa, ftp, web, nsurl

我有一个工作的 Cocoa 应用程序，它创建一个数据库文件并将其存储在本地。我想做的是将该文件存储在删除服务器上，以便我的应用程序在不同位置的不同用户共享同一个文件。我的想法是将文件存储在网站或 ftp 服务器上，例如 www.mydomain.com/mydatafile。

暂时忘记两个用户尝试同时访问该文件的问题，有人可以给我举个例子，说明如何构造要使用的 URL 吗？

我认为这应该是一个相当简单的过程，有两部分，第一部分是可可 NSURL 问题，第二部分实际上更像是 w3 问题：

1.  创建文件本身的 URL，然后
2.  附加登录 FTP 站点所需的用户名和密码。

任何朝着正确方向的轻推将不胜感激！

*** 编辑 ***

我应该提一下，我想由多个用户共享的文件，基本上是几个自定义对象存储为 NSKeyedArchiver 的文件......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-02T21:49:46.930

我建议您将您的应用程序与一些基于云的文档存储、共享、编辑服务（如 Google docs/drive）集成。

直到并且除非您要为您的应用程序提供非常特定的文件格式并且正在做一些不寻常的事情。

使用这样的东西可以节省您的时间，并且用户不必再创建另一个登录 ID。

# python - Django表单不产生输出

> ID：10866131
> 
> 赞同：0
> 
> 时间：2012-06-02T21:34:47.977
> 
> 标签：python, django, forms, python-2.6

所以我尝试在我的views.py 文件中创建一个表单，在模板中呈现时没有显示。我尝试在 manage.py shell 中这样做：

```
>>> from django import forms
>>> class Test(forms.Form):
...     about = forms.CharField(max_length=250)
...     animal = forms.CharField(max_length=50)
...     email = forms.EmailField()
... 
>>> form = Test()
>>> form.as_p
<bound method Test.as_p of <Test object at 0xa9e446c>>
>>> 
```

据我所知，`form.as_p`应该给我表格，但它会返回上面的输出。我假设 shell 中发生的事情就是我的视图和模板中发生的事情。表单也不会使用绑定数据呈现。

知道是什么导致了这种行为吗？我相信我已经密切关注[表单上的 Django 文档。](https://docs.djangoproject.com/en/dev/topics/forms/)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-02T21:36:26.337

`as_p`是一种方法，所以如果你想在解释器中使用它，你应该使用`as_p()`. 方法查找和调用由模板渲染器自动完成，因此您不需要模板中的括号。

# html - 将导航栏项目扩展到盒子阴影的整个宽度？

> ID：10866133
> 
> 赞同：0
> 
> 时间：2012-06-02T21:35:30.913
> 
> 标签：html, css

这是我正在做的事情： [www.buymaengdakratom.com](http://www.buymaengdakratom.com)

我试图让导航栏项目扩展盒子阴影的整个宽度，以便盒子阴影的白色背景不显示。

这是我正在使用的**CSS 和 HTML** [http://jsfiddle.net/Abijah/DJsKk/](http://jsfiddle.net/Abijah/DJsKk/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-03T03:16:01.013

这对我有用：

设置`width: 970px;`和`padding: 0;`为`#appleNav`。

在这里查看：http: [//jsfiddle.net/DJsKk/2/](http://jsfiddle.net/DJsKk/2/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-02T21:49:59.777

这是一种方法。删除上的填充`<ul>`并将显示设置为表格。然后在列表项上，将它们的显示设置为表格单元格。一定要从列表项中删除 float:left 。

添加了 CSS：

```
ul {
    padding:0;
    display:table;
}
li {
    display:table-cell;
} 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/DJsKk/1/)**。

这适用于所有现代浏览器以及 IE8+。

# python - 如何防止迭代器耗尽？

> ID：10866134
> 
> 赞同：9
> 
> 时间：2012-06-02T21:35:53.660
> 
> 标签：python, python-3.x

如果我创建两个列表并压缩它们

```
a=[1,2,3]
b=[7,8,9]
z=zip(a,b) 
```

然后我将 z 类型转换为两个列表

```
l1=list(z)
l2=list(z) 
```

然后 l1 的内容变成了 [(1,7),(2,8),(3,9)]，但 l2 的内容只是 []。

我想这是 python 在迭代方面的一般行为。但是作为一个从 C 家族迁移出来的新手程序员，这对我来说没有意义。为什么它会以这种方式表现？有没有办法解决这个问题？

我的意思是，是的，在这个特定的例子中，我可以将 l1 复制到 l2 中，但一般来说，有没有办法在我迭代一次之后“重置”Python 用来迭代“z”的任何东西？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-02T21:41:04.010

没有办法“重置”发电机。但是，您*可以*使用`itertools.tee`“复制”迭代器。

```
>>> z = zip(a, b)
>>> zip1, zip2 = itertools.tee(z)
>>> list(zip1)
[(1, 7), (2, 8), (3, 9)]
>>> list(zip2)
[(1, 7), (2, 8), (3, 9)] 
```

这涉及缓存值，因此仅当您以大致相同的速率迭代两个可迭代对象时才有意义。（换句话说，不要像我这里那样使用它！）

另一种方法是传递生成器函数，并在您想要迭代它时调用它。

```
def gen(x):
    for i in range(x):
        yield i ** 2

def make_two_lists(gen):
    return list(gen()), list(gen()) 
```

但是现在您必须在传递参数时将参数绑定到生成器函数。你可以使用`lambda`它，但很多人觉得`lambda`丑陋。（但不是我！YMMV。）

```
>>> make_two_lists(lambda: gen(10))
([0, 1, 4, 9, 16, 25, 36, 49, 64, 81], [0, 1, 4, 9, 16, 25, 36, 49, 64, 81]) 
```

我希望不用说，在大多数情况下，最好只是列出并复制它。

此外，作为解释这种行为的更一般的方式，请考虑这一点。生成器的目的是产生一系列值，同时在迭代之间保持某种状态。现在，有时，您可能想要执行以下操作，而不是简单地迭代生成器：

```
z = zip(a, b)
while some_condition():
    fst = next(z, None)
    snd = next(z, None)
    do_some_things(fst, snd)
    if fst is None and snd is None:
        do_some_other_things() 
```

假设这个循环*可能会*也*可能不会*用尽`z`。现在我们有一个处于不确定状态的生成器！因此，在这一点上，以明确定义的方式限制生成器的行为是很重要的。尽管我们不知道生成器在其输出中的位置，但我们知道 a) 所有后续访问都将在系列中生成*后面*的值，并且 b) 一旦它为“空”，我们就准确地获得了系列中的所有项目一次。我们操纵 的状态的能力越强`z`，推理它的难度就越大，所以我们最好避免违反这两个承诺的情况。

当然，正如 Joel Cornett 在下面指出的那样，*可以*编写一个通过该`send`方法接受消息的生成器；并且可以编写一个可以使用`send`. 但请注意，在这种情况下，*我们所能做的就是发送一条消息*。我们不能直接操纵生成器的状态，因此对生成器状态的所有更改都是明确定义的（由生成器本身 - 假设它是正确编写的！）。`send`真的是为了实现[coroutines](http://www.python.org/dev/peps/pep-0342/)，所以我不会为此目的使用它。日常生成器几乎从不使用发送给它们的值做任何事情——我认为这正是我上面给出的原因。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-03T07:13:05.357

如果您需要两个列表副本，如果您需要修改它们，那么我建议您制作一次列表，然后复制它：

```
a=[1,2,3]
b=[7,8,9]
l1 = list(zip(a,b))
l2 = l1[:] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-02T21:39:23.230

只需使用一次从迭代器中创建一个列表`list()`，然后再使用它。

只是碰巧`zip`返回了一个**生成器**，它是一个只能迭代一次的**迭代器。**

您可以根据需要多次迭代列表。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-02T21:38:21.630

不，没有办法“重置它们”。

生成器根据需要*一次*一个地生成它们的输出，然后在输出耗尽时完成。

把它们想象成读取一个文件，一旦你读完，如果你想再次读取数据，就必须重新启动。

如果您需要保留生成器的输出，请考虑将其存储在例如列表中，然后根据需要经常重复使用它。（有点类似于指导使用的决定`xrange()`，一个生成器 vs`range()`在 v2 中创建了一个完整的内存项目列表）

更新：更正的术语，暂时的大脑中断......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-03T09:15:58.317

还有另一种解释。作为程序员，您可能了解类与实例（即对象）之间的区别。据说`zip()`是一个*内置函数*（在官方文档中）。实际上，它是一个*内置的**生成器**函数*。这意味着它更像是类。您甚至可以在交互模式下尝试：

```
>>> zip
<class 'zip'> 
```

类是类型。因此，以下内容也应该清楚：

```
>>> type(zip)
<class 'type'> 
```

你`z`是类的实例，你可以考虑`zip()`调用类的构造函数：

```
>>> a = [1, 2, 3]
>>> b = [7, 8, 9]
>>> z = zip(a, b)
>>> z
<zip object at 0x0000000002342AC8>
>>> type(z)
<class 'zip'> 
```

The`z`是一个迭代器（对象），它保留在 and 的迭代器`a`中`b`。由于它的通用实现，`z`（或`zip`类）没有办法通过`a`or`b`或任何序列重置迭代器。正因为如此，没有办法重置`z`. 解决您的具体问题的最干净的方法是复制列表（正如您在问题中提到的和[Lennart Regebro 建议](https://stackoverflow.com/a/10868567/1346705)的那样）。另一种可以理解的方法是使用`zip(a, b)`两次，从而构造两个`z`类似的迭代器，它们从一开始就以相同的方式运行：

```
>>> lst1 = list(zip(a, b))
>>> lst2 = list(zip(a, b)) 
```

但是，这通常不能用于*相同的结果*。考虑`a`或`b`成为基于某些当前条件（例如从多个温度计读取的温度）生成的独特序列。

# iphone - iPhone - 进入前台后如何恢复帧大小？

> ID：10866140
> 
> 赞同：1
> 
> 时间：2012-06-02T21:36:44.747
> 
> 标签：iphone, objective-c, ios, xcode, cocoa-touch

我`UINavigationBar`通过改变它的框架来改变它的高度。但是如果我将应用程序发送到后台然后再次打开它，它的高度就会恢复到原来的大小。我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-02T21:59:21.550

您可以将框架写入资源文件，如 plist 或 XML 文件。`-(void)applicationWillEnterForeground:(UIApplication *)application' or`然后在-(void)applicationDidBecomeActive:(UIApplication *)application`的应用程序委托文件中加载 plist 。我相信你也可以使用 NSUserDefaults：

```
NSUserDefaults *frameSize = [NSUserDefaults standardUserDefaults];

//Put frame size into defaults
[sharedDefaults setObject:navigationBar.frame forKey:@"frame"];
[sharedDefaults synchronize]; 
```

然后在前面提到的 App Delegate 方法中，您可以执行以下操作：

```
self.viewController.navigationController.frame = [sharedDefaults objectForKey:@"frame"]; 
```

希望这会有所帮助，如果有帮助，请记得投票。

- - - - - -编辑 - - - - - -

如果您查看这个问题[iOS selected tab](https://stackoverflow.com/questions/10608669/ios-selected-tab)，它会告诉您如何确定选择了哪个选项卡。他们基本上说的是首先添加`self.tabController.delegate = self`应用程序委托，并确保应用程序委托和带有标签栏的视图控制器符合 UITabBarControllerDelegate 协议。然后在带有标签栏的 View Controller 文件中，您可以使用协议中定义的此方法：

```
- (void)tabBarController:(UITabBarController *)tabBarController didSelectViewController:(UIViewController *)viewController {
    if (tabBarController.selectedIndex == 0) { 
    //The 0 is the first tab, but you can replace that with any other tab's index

         //Here you say that when said tab is selected, the navigation controller's frame is the stored length.
         self.navigationController.frame = [sharedDefaults objectForKey:@"frame"]; 
    }
    else{
         self.navigationController.frame = CGRectMake(frame, for, other, tabs);
    }
} 
```

# ios - UITapGestureRecognizer 不响应父视图外的子视图区域

> ID：10866142
> 
> 赞同：5
> 
> 时间：2012-06-02T21:37:05.967
> 
> 标签：ios, uiview, uigesturerecognizer, subview, uitapgesturerecognizer

我有一个名为 view1 的 UIView。view1 有一个名为 subview 的子视图。我添加`UITapGestureRecognizer`到子视图如下：

```
UITapGestureRecognizer *recognizer = [[UITapGestureRecognizer alloc]initWithTarget:self action:@selector(handleTap:)];
[subview addGestureRecognizer:recognizer]; 
```

如果我点击了 subview 和 view1 之间重叠的区域，则调用了 handleTap 方法。但是，如果我在 view1 之外的子视图上点击了一个区域，那么 handleTap 永远不会被调用。这种行为对吗？如果没有，有什么建议我应该检查什么？

顺便说一句： UIPanGestureRecognizer 工作正常。它不表现出上述行为。

![在此处输入图像描述](../Images/35782d08f6c1cded4e3c4e9b7e9f940a.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-02T22:13:45.873

这是 UiView 的默认行为，子视图应该在父视图范围内。如果您想要不同的东西更好，您可以创建顶视图的自定义子类并覆盖`(BOOL)pointInside:(CGPoint)point withEvent:(UIEvent *)event`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-02T22:11:44.907

您需要自定义父视图并更改它处理触摸的方式。有关更多详细信息，请参阅[此问题](https://stackoverflow.com/questions/7622770/how-access-an-uiview-subview-partially-outside-of-his-parent-uiview)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-08-18T00:34:32.290

我发现关于覆盖 pointInside:withEvent: 的答案缺乏解释或实施的细节。在最初的问题中，当用户点击黑色的未标记区域/视图（我们将其称为 view2）时，事件框架只会触发 hitTest:withEvent: 主窗口向下穿过 view2（及其直接子视图） ，并且永远不会为 view1 命中它，因为在 pointInside:point 中测试的点超出了 view1 的框架范围。为了让 subview1 注册手势，您应该覆盖 view2 的 hitTest:withEvent 实现以包括对 subview 的 pointInside:point 的检查

```
//This presumes view2 has a reference to view1 (since they're nested in the example).
//In scenarios where you don't have access, you'd need to implement this
//in a higher level in the view hierachy

//In view2
override func hitTest(_ point: CGPoint, with event: UIEvent?) -> UIView? {

        let ptRelativeToSubviewBounds = convert(point, to: view1.subview)
        if view1.subview.point(inside:ptRelativeToSubviewBounds, with:event){
            return view1.subview
        }
        else{
            return super.hitTest(point, with: event)
        } 
```

# php - 如何在 onFlush 事件侦听器中更新实体的 manyToMany 集合？

> ID：10866143
> 
> 赞同：6
> 
> 时间：2012-06-02T21:37:15.290
> 
> 标签：php, symfony, doctrine-orm

我有这个实体：

```
<?php

namespace Comakai\MyBundle\Entity;

use Doctrine\ORM\Mapping as ORM,
    Symfony\Component\Validator\Constraints as Assert;

/**
 * @ORM\Entity
 */
class Stuff {

    /**
     * @ORM\Id
     * @ORM\Column(type="integer")
     * @ORM\GeneratedValue(strategy="IDENTITY")
     */
    private $id;

    /**
     * @ORM\Column(type="text")
     * @Assert\NotBlank()
     */
    private $content;

    /**
     * @ORM\ManyToMany(targetEntity="Apple", cascade={"persist"})
     */
    private $apples;

    /**
     * @ORM\ManyToMany(targetEntity="Pig")
     */
    private $pigs;

    public function __construct() {
        $this->apples = new \Doctrine\Common\Collections\ArrayCollection();
        $this->pigs = new \Doctrine\Common\Collections\ArrayCollection();
    }

    public function setApples($apples) {

        $this->getApples()->clear();

        foreach ($apples as $apple) {

            $this->addApple($apple);
        }
    }

    public function setPigs($pigs) {

        $this->getPigs()->clear();

        foreach ($pigs as $pig) {

            $this->addPig($pig);
        }
    }

    /**
     * Get id
     *
     * @return integer 
     */
    public function getId() {
        return $this->id;
    }

    /**
     * Set content
     *
     * @param text $content
     */
    public function setContent($content) {
        $this->content = $content;
    }

    /**
     * Get content
     *
     * @return text 
     */
    public function getContent() {
        return $this->content;
    }

    /**
     * Add apples
     *
     * @param Comakai\MyBundle\Entity\Apple $apples
     */
    public function addApple(\Comakai\MyBundle\Entity\Apple $apples) {
        $this->apples[] = $apples;
    }

    /**
     * Get apples
     *
     * @return Doctrine\Common\Collections\Collection 
     */
    public function getApples() {
        return $this->apples;
    }

    /**
    * Add pigs
    *
    * @param Comakai\MyBundle\Entity\Pig $pigs
    */
    public function addPig(\Comakai\MyBundle\Entity\Pig $pigs) {
        $this->pigs[] = $pigs;
    }

    /**
    * Get pigs
    *
    * @return Doctrine\Common\Collections\Collection 
    */
    public function getPigs() {
        return $this->pigs;
    }
} 
```

和这个听众：

```
<?php

namespace Comakai\MyBundle\Listener;

use Comakai\MyBundle\Util\SluggerParser
    Doctrine\ORM\Event\OnFlushEventArgs,
    Comakai\MyBundle\Entity\Stuff,
    Comakai\MyBundle\Entity\Apple,
    Comakai\MyBundle\Entity\Pig;

class Listener {

    /**
     * @param \Doctrine\ORM\Event\OnFlushEventArgs $ea
     */
    public function onFlush(OnFlushEventArgs $ea) {

        $em = $ea->getEntityManager();
        $uow = $em->getUnitOfWork();

        foreach ($uow->getScheduledEntityInsertions() AS $entity) {

            $this->save($entity, $em, $uow);

        }

        foreach ($uow->getScheduledEntityUpdates() AS $entity) {

            $this->save($entity, $em, $uow);

        }
    }

    public function save($entity, $em, $uow) {

        if ($entity instanceof Stuff) {

            $pigRepository = $em->getRepository('Comakai\MyBundle\Entity\Pig');
            $content = $entity->getContent();

            preg_match_all('/@@ pig:(\d+) @@/i', $content, $matches);
            $entity->getPigs()->clear();

            foreach($matches[1] as $pigID) {

                $pig = $pigRepository->find($pigID);

                if(!empty($pig)) {

                    $entity->addPig($pig);

                }

            }

            $entity->setContent($content);

            $meta = $em->getClassMetadata(get_class($entity));
            $uow->recomputeSingleEntityChangeSet($meta, $entity);
            $uow->computeChangeSet($meta, $entity);

        }
    }

} 
```

如果苹果的集合是空的，它工作正常，但如果它有一些项目，我会得到一个重复错误。

我如何告诉 UnitOfWork 我只想重新计算猪的收藏？

**更新**

有一个新的 preFlush 事件（[https://github.com/doctrine/doctrine2/pull/169](https://github.com/doctrine/doctrine2/pull/169)），我认为这种事情可以在那里完成。那个 PR 不在我正在使用的分支中，但让我们试试吧！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-07T02:55:01.583

*在侦听器的onFlush*事件期间更新实体时，您需要调用的是`computeChangeSet()`：

```
// make changes to entity
$entity->field = 'value';

// or assign an existing entity to an assocation
$entity->user = $myExistingUserEntity;
$entity->tags->add($myExistingTagEntity);

$meta = $em->getClassMetadata(get_class($entity));
$uow->computeChangeSet($meta, $entity); 
```

如果您还要创建其他实体，则需要先持久化它们并计算它们的更改！

```
$myNewUserEntity = new Entity\User;
$myNewTagEntity = new Entity\Tag;

$entity->user = $myNewUserEntity;
// make sure you call add() on the owning side for *ToMany associations
$entity->tags->add($myNewTagEntity);

$em->persist($myNewUserEntity);
$em->persist($myNewTagEntity);

$metaUser = $em->getClassMetadata(get_class($myNewUserEntity));
$uow->computeChangeSet($metaUser, $myNewUserEntity);

$metaTag = $em->getClassMetadata(get_class($myNewTagEntity));
$uow->computeChangeSet($metaTag, $myNewTagEntity);

$meta = $em->getClassMetadata(get_class($entity));
$uow->computeChangeSet($meta, $entity); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-10T19:13:32.430

这可以通过新的 preFlush 事件（Symfony 2.1）来完成。

为事件添加一个监听器（注入整个服务容器是一种不好的做法，但[有时是要走的路](https://stackoverflow.com/questions/8708822/circular-reference-when-injecting-security-context-into-entity-listener-class)）：

```
services:
    mybundle.updater.listener:
        class: Foo\MyBundle\Listener\UpdaterListener
        arguments: ["@service_container"]
        tags:
            - { name: doctrine.event_listener, event: preFlush } 
```

听众应该是这样的：

```
<?php

namespace Foo\MyBundle\Listener;

use Doctrine\ORM\Event\PreFlushEventArgs;
use Foo\MyBundle\SomeInterface;

class UpdaterListener
{
    /**
     * @param \Doctrine\ORM\Event\PreFlushEventArgs $ea
     */
    public function preFlush(PreFlushEventArgs $ea)
    {
        /* @var $em \Doctrine\ORM\EntityManager */
        $em = $ea->getEntityManager();
        /* @var $uow \Doctrine\ORM\UnitOfWork */
        $uow = $em->getUnitOfWork();

        foreach ($uow->getScheduledEntityInsertions() as $entity) {

            if($entity instanceof SomeInterface) {

               /*
                * do your stuff here and don't worry because
                * it'll execute before the flush
                */

            }

        }

    }

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-17T14:51:32.983

当想要更新您发送到的当前实体`onFlush`并创建与该实体的关联时

（对于这个例子，我将使用`Parent`对象和`child`对象）

假设当我将父对象属性“强调”更改为`1`我还想`child`在我的方法中将一个全新的对象关联到父对象时`onflush`，它看起来像这样：

```
public function onFlush(onFlushEventArgs $args)
{
    ....

    $child = $this->createChild($em, $entity); // return the new object. just the object.
    $uow->persist($child);
    $childMeta = $em->getMetadataFactory()->getMetadataFor('AcmeFamilyTreeBundle:Child');
    $uow->computeChangeSet($childMeta, $child)

    $parent->setStressed(1);
    $parentMeta = $em->getMetadataFactory()->getMetadataFor('AcmeFamilyTreeBundle:Parent');
    $uow->recomputeSingleEntityChangeSet($parentMeta, $parent)
} 
```

所以你看到了：

1.  你需要使用`$uow->persist()` **not来持久化你的子对象** `$em->persist()`
2.  `computeChangeSet`在子对象上。
3.  `recomputeSingleEntityChangeSet`在父对象上

* * *

For help with creating the onFlush method, please see [the documentation](http://docs.doctrine-project.org/en/latest/reference/events.html#onflush)

# php - phpmyadmin 和 mysql pdo lastInsertId()

> ID：10866151
> 
> 赞同：0
> 
> 时间：2012-06-02T21:39:22.707
> 
> 标签：php, mysql, pdo, phpmyadmin, lastinsertid

我有这个

```
$query = "INSERT INTO players VALUES (
                    UUID(),
                    :firstname,
                    :lastname,
                    :age,
                    :birthplace,
                    :height,
                    :weight,
                    :bats,
                    :throws,
                    :position,
                    :jersey,
                    :status,
                    :team,
                    :image_path
                )";
    $sth = $db->prepare($query);
    $sth->execute(array(
        ':firstname' => $firstname,
        ':lastname' => $lastname,
        ':age' => $age,
        ':birthplace' => $birthplace,
        ':height' => $height,
        ':weight' => $weight,
        ':bats' => $bats,
        ':throws' => $throws,
        ':position' => $position,
        ':jersey' => $jersey,
        ':status' => $status,
        ':team' => $team,
        ':image_path' => $image_path
    ));

    $id = $db->lastInsertId();
    return $id; 
```

我正在尝试返回插入的最后一个 ID，而我得到的只是返回的 0。非常感谢任何帮助谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-02T21:45:49.250

`LAST_INSERT_ID()`和朋友只适用于通过`AUTO_INCREMENT`列创建的整数 ID。您需要运行两个查询 - 首先

```
SELECT UUID() AS newuuid; 
```

然后获取并存储此结果（例如 in `$uuid`），然后

```
"INSERT INTO players VALUES (
                    :uuid,
                    :firstname,
                    :lastname,
...
execute(array(
        ':uuid' => $uuid,
        ':firstname' => $firstname,
        ':lastname' => $lastname,
        ':age' => $age, 
```

给你留下`$uuid`仍然有效的。

# java - 应用程序中的android空指针异常

> ID：10866153
> 
> 赞同：-3
> 
> 时间：2012-06-02T21:39:27.043
> 
> 标签：java, android

我有一个初始化我的应用程序类（AppVariables）的变量的活动：

```
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    app = (AppVariables) getApplicationContext();
} 
```

当使用此 if 条件检查可绘制对象是否为空时，由于某种原因，我得到空指针异常：

```
 if (app.getFacebookCurrentUser().getProfilePicture() != null) 
```

无法真正理解为什么..我正在检查它是否为空..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-02T21:42:43.470

抱歉，这是个愚蠢的问题，但至少让我们从中学习......我应该检查 app.getFacebookCurrentUser() 是否为空。正确的条件是：

if (app.getFacebookCurrentUser() != null && app.getFacebookCurrentUser().getProfilePicture() != null)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-02T21:42:18.217

您收到异常，因为`app.getFacebookCurrentUser()`已返回 null。像这样检查它：

```
if (app.getFacebookCurrentUser() != null && app.getFacebookCurrentUser().getProfilePicture() != null) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-02T21:42:55.497

您正在检查 getProfilePicture() 是否为空。如果 getFacebookCurrentUser() 返回的 app 或当前 facebook 用户为 null 怎么办？

在其中任何一个上调用方法都可能导致 NULL 指针异常。

# jquery - 使用 phonegap 构建放大 android 应用程序

> ID：10866158
> 
> 赞同：0
> 
> 时间：2012-06-02T21:40:01.930
> 
> 标签：jquery, android, mobile, cordova

我正在使用 jQuery Mobile 和 Phonegap 构建一个 Android 应用程序，我希望用户能够放大和缩小页面以更详细地查看图像。我试过搜索这个问题，但给出的答案都不适合我，所以我非常感谢任何帮助。这是我在页面顶部的内容：

```
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" /> 
```

有什么办法可以改变这个让用户能够放大和缩小？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T13:26:12.820

无法使用 PhoneGap Build 在 Android 上启用缩放 - 请参阅我关于在 Phonegap Android 应用程序中启用视口捏合缩放对如何在桌面 PhoneGap 中执行此操作[没有影响的答案。](https://stackoverflow.com/questions/9965396/enbaling-viewport-pinch-zoom-in-phonegap-android-application-has-no-effect)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T05:08:20.717

默认情况下，缩放是禁用的，因为以下元标记由 jQuery Mobile 动态注入到您的文档中：

为这个元标记写出的实际 @content 值由 $.mobile.metaViewportContent 属性控制。它的默认值为：

```
 metaViewportContent: "width=device-width, minimum-scale=1, maximum-scale=1" 
```

如果要恢复缩放功能，则必须覆盖指定的比例值，以便最大比例大于最小值，或者从 metaViewportContent 中删除比例属性以获得默认行为。

要设置该属性，您必须绑定到 mobileinit 事件，以便您可以根据自己的喜好设置该属性。就像是：

```
$(document).bind("mobileinit", function(){
      $.mobile.metaViewportContent = "width=device-width, minimum-scale=1,
       maximum-scale=2";
}); 
```

或删除比例值：

```
$(document).bind("mobileinit", function(){
      $.mobile.metaViewportContent = "width=device-width";
}); 
```

# jquery - jQuery Mobile onSelect ... 选择单选按钮时加载对话框

> ID：10866159
> 
> 赞同：0
> 
> 时间：2012-06-02T21:40:05.420
> 
> 标签：jquery, jquery-mobile

选择单选按钮时，如何在 jQuery Mobile 中启动 onselect？当用户选择一个单选按钮时，我希望 page30.html（一个对话框 msgbox）自动加载。

```
<div data-role="page" id="page29">
<div data-theme="a" data-role="header" data-position="fixed">
    <a data-role="button" data-rel="back" data-theme="b" data-icon="arrow-l" data-iconpos="left">
        Back
    </a>
</div>
<div data-role="content">
    <div data-role="fieldcontain" class="no-field-separator">
        <fieldset data-role="controlgroup" data-type="vertical">
            <legend>
            </legend>
            <input name="radiobuttons4" id="radio11" value="radio1" type="radio" />
            <label for="radio11">
                <span class="f_13">1 - </span>
            </label>
            <input name="radiobuttons4" id="radio13" value="radio13" type="radio" />
            <label for="radio13">
                <span class="f_13">2 - </span>
            </label>
        </fieldset>
    </div>
</div>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-02T22:26:55.453

尝试添加`data-role="dialog"`到 page30 的页面容器。IE

```
<div data-role="dialog" id="page30">
    ...
</div> 
```

然后在你的 javascript 中使用它。

```
$(document).on('change', '#radio11', function() {
    $.mobile.changePage('page30.html');
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-02T21:44:58.243

试试这个：

```
$('input:radio').change(function(){
   if($(this).val() == 'radio1') {
        $('#somewhere').load('path/to/page30.html')
   }
}) 
```

# iphone - 如何使用按钮舍入浮点值

> ID：10866160
> 
> 赞同：0
> 
> 时间：2012-06-02T21:40:44.810
> 
> 标签：iphone, xcode, cocoa, xcode4

好的，所以我正在尝试使用 IBAction 将我的值四舍五入到最接近的整数。

```
So 1.88 -> 2.00 ,  
11.40 -> 12.00 ,   
111.01 -> 112.00, etc. 
```

-

```
-(IBAction)roundUp:(id)sender   
{   
    float floatRoundValue=lblTotalRound.text floatValue];
    ceilf(floatRoundValue);
    NSString *stringRoundValue = [NSString stringWithFormat:@"%1.0f", floatRoundValue];
    lblTotalRound.text=stringRoundValue;
} 
```

这就是我得到的。但它仍然四舍五入低于 0.5 和最接近的整数

```
(Ex. 1.19 -> 1 , i need 1.19 -> 2.00). 
```

我试过 %1.2f 但值根本没有改变。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-02T21:44:01.327

`ceilf`不会修改您传入的值。它*返回*修改后的值。

```
floatRoundValue = ceilf(floatRoundValue); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-02T21:47:56.877

ceilf 是一个返回值的函数 (https://developer.apple.com/library/mac/#documentation/Darwin/Reference/Manpages/man3/ceil.3.html)，您只需将该行更改为下列的。

```
floatRoundValue = ceilf(floatRoundValue); 
```

因此，在您的情况下，完整的代码将是这样的。

```
-(IBAction)roundUp:(id)sender   
{   
    float floatRoundValue=lblTotalRound.text floatValue];
    floatRoundValue = ceilf(floatRoundValue);
    NSString *stringRoundValue = [NSString stringWithFormat:@"%1.0f", floatRoundValue];
    lblTotalRound.text=stringRoundValue;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-02T22:50:50.390

如果您需要在之前有一个 $ 符号：

```
-(IBAction)roundUp:(id)sender   
{   
    float floatRoundValue=(lblTotalRound.text floatValue]; 
    floatRoundValue = ceilf(floatRoundValue);
    NSString *stringRoundValue = [NSString stringWithFormat:@"$%1.0f", floatRoundValue];
    lblTotalRound.text=stringRoundValue;
} 
```

[NSString 类参考](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSString_Class/Reference/NSString.html)

# core-plot - 核心图 - 网格线的自定义图像

> ID：10866166
> 
> 赞同：0
> 
> 时间：2012-06-02T21:41:39.860
> 
> 标签：core-plot

是否可以在核心图中将自定义图像作为轴的网格线？

我想为我的要求设置一个 2 像素高度的自定义图像。

使用图像作为图案为网格线设置颜色不会产生像图像一样的效果。

*   巴拉吉·R。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-03T00:12:37.720

现在有一个`lineFill`属性是线条样式的一部分。您可以使用图像创建填充。我猜您还想将`tiled`图像的属性设置为`YES`.

该`lineFill`属性是在 1.0 版本之后添加的，因此在下一个版本之前，您需要使用 Mercurial 提取最新代码才能获得此功能。

# perl - 如果 $h 是一个对象，如何“键 %h”？

> ID：10866172
> 
> 赞同：0
> 
> 时间：2012-06-02T21:42:19.950
> 
> 标签：perl

`$h`下面是一个对象，但它只包含一个常规哈希。

```
my $h = YAML::Syck::LoadFile('have_seen.yaml'); 
```

如果它是一个普通的散列，那么键的数量就是`keys $h`.

**问题**

当哈希在对象中时如何获取键的数量？

**更新**

这是代码

```
#!/usr/bin/perl

use strict;
use YAML::Syck;

my $h = YAML::Syck::LoadFile('h.yaml');

my $links = 100;

print $links - keys $h . "\n"; 
```

yaml 文件包含

```
--- 
010711: 1
--- 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-02T22:11:29.880

`$h`不是一个对象，而是一个普通的 hashref。这实际上是一个运算符优先级问题。使用括号将参数绑定到`keys`函数紧密。

```
print $links - keys($h) . "\n"; 
```

正如 Greg Bacon 所指出的，在旧的 Perls 上，有必要首先使用`%$h`or手动取消引用`%{ $h }`（这是更好的样式）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-02T21:44:27.970

使用`keys`运算符，如

```
print scalar keys %$h; 
```

大多数时候，显式`scalar`是不必要的，*例如*，

```
my $n = keys %$h; 
```

但深入研究对象的内部通常是个坏主意。请改用公共接口。你为什么要这样做？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-04T18:28:26.097

我的代码也产生了同样的错误`Type of argument to keys on reference must be unblessed hashref or arrayref`，但不同之处在于哈希是从我自己的对象产生的。

```
sub getAttributes {
  my $self = shift;
  return $self->{ATTRIBUTES};
} 
```

我尝试了几种方法来`keys`取消引用返回的内容，`$instance->getAttributes()`但似乎一旦得到祝福，键功能就不想知道了。

# opencv - OpenCV：比较差异很小的简单图像

> ID：10866173
> 
> 赞同：4
> 
> 时间：2012-06-02T21:42:31.937
> 
> 标签：opencv

我有一堆“简单”的图像，我想比较它们是否相似。我使用模板匹配 ( ) 将它们相互比较`cv::matchTemplate`，结果非常好。

现在我想微调我的程序，但我遇到了一个问题。例如，我有两张看起来非常相似的图像。他们唯一的区别是另一个有更粗的线和项目的数字前面不同。当两幅图像都很小时，线条粗细的一个像素差异会在进行模板匹配时产生很大的结果差异。当线条粗细相同并且唯一的区别是前面的数字时，我会得到类似于匹配成功时`0.98`的模板匹配结果。`CV_TM_CCORR_NORMED`当线条粗细不同时，匹配结果类似于 0.95。

我不能将阈值降低到 0.98 以下，因为其他一些类似的图像具有相同的线条粗细。

以下是示例图像：

![在此处输入图像描述](../Images/099b2ed27f761bab4164d5adbed667c3.png) ![在此处输入图像描述](../Images/3803353ae14a04aa067275db8fec0667.png)

那么我有什么选择呢？

我努力了：

*   扩大原件和模板
*   侵蚀也两者
*   形态学前两者
*   计算关键点并进行比较
*   寻找角落

但还没有大的成功。这些图像是否太简单以至于难以检测“好的特征”？

任何帮助都非常受欢迎。

谢谢！

**编辑：**

这是其他一些示例图像。我的程序认为相似的内容放在同一个 zip 文件夹中。 [压缩](https://dl.dropbox.com/u/20334635/ims.zip)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-03T02:49:34.580

一种可能的方法可能是细化两个图像，以便每条线都有一个像素宽度，因为不同的厚度会导致您出现相似性的主要问题。

该过程将首先对图像进行二值化/阈值化，然后对两个图像应用细化操作，因此两者现在都具有相同的 1 px 厚度。然后使用您之前使用的常用模板匹配，效果很好。

如果您想了解有关二值图像细化/骨架化的更多详细信息，请参阅各种讨论论坛和 OpenCV 群组上发布的一些 OpenCV 实现：

1.  [用于细化的 OpenCV 代码](http://opencv-users.1802565.n2.nabble.com/Morphological-thinning-operation-from-Z-Guo-and-R-W-Hall-quot-Parallel-Thinn-td4225544.html)（Guo 和 Hall 算法，适用于 CvMat 输入）
2.  使用 OpenCV[的 JR Parker 实现](http://permalink.gmane.org/gmane.comp.lib.opencv/36588)
3.  [这里](http://www.eml.ele.cst.nihon-u.ac.jp/~momma/wiki/wiki.cgi/OpenCV/%E7%B4%B0%E7%B7%9A%E5%8C%96.html)的代码可能更高效（大量使用 OpenCV 优化的访问方法，但是大部分页面都是日文的！）
4.  最后，如果您有兴趣，请[简要概述变薄。](http://www.inf.u-szeged.hu/~palagyi/skel/skel.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-25T21:25:46.010

你需要一些更基本的东西，没有太多理由去寻找花哨的方法。你的数字已经是二进制的，它们的形状总体上非常相似。

一个初步的想法：考虑某个图像中的上点和下点，并形成上壳和下壳（只是一个壳，而不是凸壳或其他任何东西）。如果给定 column `i`，它是从图像顶部（底部）开始的第一个点，而不是背景点`i`. 此外，您的图像主要是一个单一的连接组件（在某些情况下，垂直条分开，但这很好），因此您可以轻松丢弃小组件。这一步对您的情况很重要，因为我看到有些数字带有某种形式的噪声，与图像的其余部分无关。考虑到少于 100 个点的连接组件很小，这些是您为问题中包含的各个图像获得的外壳：

![在此处输入图像描述](../Images/d4265d8cfacd8a2a2df9c0a7e2ce9355.png)

![在此处输入图像描述](../Images/72571fceb3b1cc9a23e5660764f944d7.png)

蓝线表示上层船体，绿线表示下层船体。如果不明显，当我们考虑这些船体的区域最大值和区域最小值时，我们会在两者中获得相同的数量。`y`此外，除了轴上的一些位移外，它们都非常接近。如果我们考虑极值的平均`x`位置并将两个图像的线绘制在一起，我们会得到下图。在这种情况下，蓝色和绿色的线条用于第二张图像，红色和青色的线条用于第一张图像。红点位于`x`某些区域最小值的平均坐标中，蓝点相同，但区域最大值（这些是我们的兴趣点）。（下图已调整大小以获得更好的可视化效果）

![在此处输入图像描述](../Images/c9021f1b5cfd0bc60488e0220982d763.png)

如您所见，您无需执行任何操作即可获得许多几乎重叠的点。如果我们做得更少，即甚至不关心这种重叠，并继续以微不足道的方式对图像进行分类：如果一个图像`a`和另一个图像`b`在上层外壳中具有相同数量的区域最大值，则相同数量的区域最小值在上船体，下船体的区域最大值相同，底船体的区域最小值相同，则`a`和`b`属于同一类。对所有图像执行此操作，所有图像都正确分组，但以下情况除外：

![在此处输入图像描述](../Images/f980b67eed5391bc79f115c72ac3c72a.png)

![在此处输入图像描述](../Images/4693fabfd777f4e3db5216ba27165081.png)

在这种情况下，第一张图像中的上层船体只有 3 个最大值和 3 个最小值，而第二张图像有 4 个最大值和 4 个最小值。在您看到船体和获得的兴趣点的图之后：

![在此处输入图像描述](../Images/c2da1680e1f382a81c9e0af0ea5ea7e0.png) ![在此处输入图像描述](../Images/ee3afb1d67f499c862a1c458d0627c56.png)

如您所见，在第二个上层船体中有两个非常接近的极值。平滑这条曲线消除了两个极值，使图像通过简单的方法匹配。另外，请注意，如果您在图像周围绘制一个矩形，那么此方法将告诉它们都是相等的。在这种情况下，您将需要比较多个船体，丢弃当前船体中的点并构建其他船体。尽管如此，这种方法能够正确地对所有图像进行分组，因为它们都非常简单并且几乎没有噪音。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-03T09:05:44.127

据我所知，困难在于形状相同，只是大小不同。一个简单的破解方法可能是： - 减去图像，然后腐蚀。如果形状相同但稍大一点，则减法将只留下边缘，边缘会变薄并消失，并带有侵蚀作为噪声。

更正式一些，将是采用轮廓，然后是近似多边形并进行不变量比较（[Hu Moments](http://opencv.itseez.com/modules/imgproc/doc/structural_analysis_and_shape_descriptors.html?highlight=hu#void%20HuMoments%28const%20Moments&%20moments,%20double%20hu%5B7%5D%29)等）

# php - 运行 php 文件时，如何从 MYSQL 服务器中的表中打印行

> ID：10866184
> 
> 赞同：0
> 
> 时间：2012-06-02T21:44:02.267
> 
> 标签：php, mysql

运行 php 文件时，如何从 MYSQL 服务器中的表中打印行？我已经使用 prepare 语句来准备查询。我不确定如何输出该查询的结果。我的代码如下：

```
// Check connection 
if (mysqli_connect_errno()) {
    printf("Connect failed: %s\n", mysqli_connect_error());
    exit();
}

putenv("ODBCINI=/etc/dwwdwd.ini");
putenv("NZ_ODBC_INI_PATH=/etc/");
putenv("LD_LIBRARY_PATH=/export/home/joadf/netezza/lib64");
echo "Whats up";

$lvar = $coni->prepare(
    'SELECT * FROM TABLE A limit 10');
$lvar->execute();
$lvar->fetch();
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-02T21:51:53.927

您将使用`bind_result()` [Doc](http://php.net/manual/en/mysqli-stmt.bind-result.php)。该页面上有示例。基本上，您使用绑定结果来设置存储查询数据的变量，然后以这种方式读取它们。您应该将 fetch 部分放在`while`循环中，以便可以迭代结果

`bind_result()`根据您想要从数据库中获得多少列，您将在语句中拥有 n 个变量。

如果从 db 请求 3 cols 的示例 `$lvar->bind_result($a, $b, $c);`

现在 $a, $b, $c 包含第一行的数据，按照 cols 在调用后列出的顺序`$lvar->fetch()`。

每次调用`$lvar->fetch()`变量都会更新，直到没有更多行，在这种情况下 fetch 语句返回`false`

这段代码应该可以解决问题

```
$lvar = $coni->prepare(
'SELECT * FROM TABLE A limit 10');
$lvar->execute();
$lvar->bind_result($a, $b, $c);
while($lvar->fetch()) {
    echo $a . $b . $c;
} 
```

# android - google play 关键字搜索问题

> ID：10866194
> 
> 赞同：4
> 
> 时间：2012-06-02T21:46:05.193
> 
> 标签：android, google-play

几个月前，我在google play提交了一个android应用程序，出于某种原因，即使描述和标题中到处都提到了我的公司名称，但在google play搜索窗口中搜索时，它从来没有出现过。

我在这里错过了什么吗？有没有像苹果应用商店这样的关键字的地方，我错过了？顺便说一句，我的促销文本字段是空的，也许这就是问题所在？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T23:24:32.157

我建议您向他们的开发者计划发送电子邮件或在他们的 Google 群组上发布问题。

# go - Go 中结构的堆栈与堆分配，以及它们与垃圾收集的关系

> ID：10866195
> 
> 赞同：217
> 
> 时间：2012-06-02T21:46:14.180
> 
> 标签：go, heap-memory, stack-memory

我是 Go 新手，我在 C 风格的基于堆栈的编程（其中自动变量位于堆栈上，分配的内存位于堆上）与 Python 风格的基于堆栈的编程之间存在一些认知失调，其中唯一的存在于堆栈上的东西是指向堆上对象的引用/指针。

据我所知，以下两个函数给出相同的输出：

```
func myFunction() (*MyStructType, error) {
    var chunk *MyStructType = new(HeaderChunk)

    ...

    return chunk, nil
}

func myFunction() (*MyStructType, error) {
    var chunk MyStructType

    ...

    return &chunk, nil
} 
```

即，分配一个新结构并返回它。

如果我用 C 语言编写，第一个会将对象放在堆上，第二个会将它放在堆栈上。第一个将返回一个指向堆的指针，第二个将返回一个指向堆栈的指针，在函数返回时它会消失，这将是一件坏事。

如果我用 Python（或除 C# 之外的许多其他现代语言）编写它，示例 2 将是不可能的。

我知道 Go 垃圾会收集这两个值，所以上述两种形式都很好。

去引用：

> 请注意，与 C 不同，返回局部变量的地址是完全可以的；与变量关联的存储在函数返回后仍然存在。事实上，获取复合文字的地址会在每次评估时分配一个新实例，因此我们可以将最后两行组合起来。
> 
> [http://golang.org/doc/effective_go.html#functions](http://golang.org/doc/effective_go.html#functions)

但它提出了几个问题。

1.  在示例 1 中，结构是在堆上声明的。例子2呢？是在堆栈上以与在 C 中相同的方式声明还是在堆上进行声明？

2.  如果示例 2 在堆栈上声明，那么它在函数返回后如何保持可用？

3.  如果示例 2 实际上是在堆上声明的，那么结构是如何通过值而不是通过引用传递的？在这种情况下，指针的意义何在？

* * *

## 回答 #1

> 赞同：214
> 
> 时间：2012-06-03T00:01:15.370

It's worth noting that the words "stack" and "heap" do not appear anywhere in the language spec. Your question is worded with "...is declared on the stack," and "...declared on the heap," but note that Go declaration syntax says nothing about stack or heap.

That technically makes the answer to all of your questions implementation dependent. In actuality of course, there is a stack (per goroutine!) and a heap and some things go on the stack and some on the heap. In some cases the compiler follows rigid rules (like "`new` always allocates on the heap") and in others the compiler does "escape analysis" to decide if an object can live on the stack or if it must be allocated on the heap.

In your example 2, escape analysis would show the pointer to the struct escaping and so the compiler would have to allocate the struct. I think the current implementation of Go follows a rigid rule in this case however, which is that if the address is taken of any part of a struct, the struct goes on the heap.

For question 3, we risk getting confused about terminology. Everything in Go is passed by value, there is no pass by reference. Here you are returning a pointer value. What's the point of pointers? Consider the following modification of your example:

```
type MyStructType struct{}

func myFunction1() (*MyStructType, error) {
    var chunk *MyStructType = new(MyStructType)
    // ...
    return chunk, nil
}

func myFunction2() (MyStructType, error) {
    var chunk MyStructType
    // ...
    return chunk, nil
}

type bigStruct struct {
    lots [1e6]float64
}

func myFunction3() (bigStruct, error) {
    var chunk bigStruct
    // ...
    return chunk, nil
} 
```

I modified myFunction2 to return the struct rather than the address of the struct. Compare the assembly output of myFunction1 and myFunction2 now,

```
--- prog list "myFunction1" ---
0000 (s.go:5) TEXT    myFunction1+0(SB),$16-24
0001 (s.go:6) MOVQ    $type."".MyStructType+0(SB),(SP)
0002 (s.go:6) CALL    ,runtime.new+0(SB)
0003 (s.go:6) MOVQ    8(SP),AX
0004 (s.go:8) MOVQ    AX,.noname+0(FP)
0005 (s.go:8) MOVQ    $0,.noname+8(FP)
0006 (s.go:8) MOVQ    $0,.noname+16(FP)
0007 (s.go:8) RET     ,

--- prog list "myFunction2" ---
0008 (s.go:11) TEXT    myFunction2+0(SB),$0-16
0009 (s.go:12) LEAQ    chunk+0(SP),DI
0010 (s.go:12) MOVQ    $0,AX
0011 (s.go:14) LEAQ    .noname+0(FP),BX
0012 (s.go:14) LEAQ    chunk+0(SP),BX
0013 (s.go:14) MOVQ    $0,.noname+0(FP)
0014 (s.go:14) MOVQ    $0,.noname+8(FP)
0015 (s.go:14) RET     , 
```

Don't worry that myFunction1 output here is different than in peterSO's (excellent) answer. We're obviously running different compilers. Otherwise, see that I modfied myFunction2 to return myStructType rather than *myStructType. The call to runtime.new is gone, which in some cases would be a good thing. Hold on though, here's myFunction3,

```
--- prog list "myFunction3" ---
0016 (s.go:21) TEXT    myFunction3+0(SB),$8000000-8000016
0017 (s.go:22) LEAQ    chunk+-8000000(SP),DI
0018 (s.go:22) MOVQ    $0,AX
0019 (s.go:22) MOVQ    $1000000,CX
0020 (s.go:22) REP     ,
0021 (s.go:22) STOSQ   ,
0022 (s.go:24) LEAQ    chunk+-8000000(SP),SI
0023 (s.go:24) LEAQ    .noname+0(FP),DI
0024 (s.go:24) MOVQ    $1000000,CX
0025 (s.go:24) REP     ,
0026 (s.go:24) MOVSQ   ,
0027 (s.go:24) MOVQ    $0,.noname+8000000(FP)
0028 (s.go:24) MOVQ    $0,.noname+8000008(FP)
0029 (s.go:24) RET     , 
```

Still no call to runtime.new, and yes it really works to return an 8MB object by value. It works, but you usually wouldn't want to. The point of a pointer here would be to avoid pushing around 8MB objects.

* * *

## 回答 #2

> 赞同：71
> 
> 时间：2012-06-02T22:53:45.393

```
type MyStructType struct{}

func myFunction1() (*MyStructType, error) {
    var chunk *MyStructType = new(MyStructType)
    // ...
    return chunk, nil
}

func myFunction2() (*MyStructType, error) {
    var chunk MyStructType
    // ...
    return &chunk, nil
} 
```

在这两种情况下，Go 的当前实现都会为堆上`struct`的类型分配内存并返回其地址。`MyStructType`功能是等价的；编译器 asm 源是相同的。

```
--- prog list "myFunction1" ---
0000 (temp.go:9) TEXT    myFunction1+0(SB),$8-12
0001 (temp.go:10) MOVL    $type."".MyStructType+0(SB),(SP)
0002 (temp.go:10) CALL    ,runtime.new+0(SB)
0003 (temp.go:10) MOVL    4(SP),BX
0004 (temp.go:12) MOVL    BX,.noname+0(FP)
0005 (temp.go:12) MOVL    $0,AX
0006 (temp.go:12) LEAL    .noname+4(FP),DI
0007 (temp.go:12) STOSL   ,
0008 (temp.go:12) STOSL   ,
0009 (temp.go:12) RET     ,

--- prog list "myFunction2" ---
0010 (temp.go:15) TEXT    myFunction2+0(SB),$8-12
0011 (temp.go:16) MOVL    $type."".MyStructType+0(SB),(SP)
0012 (temp.go:16) CALL    ,runtime.new+0(SB)
0013 (temp.go:16) MOVL    4(SP),BX
0014 (temp.go:18) MOVL    BX,.noname+0(FP)
0015 (temp.go:18) MOVL    $0,AX
0016 (temp.go:18) LEAL    .noname+4(FP),DI
0017 (temp.go:18) STOSL   ,
0018 (temp.go:18) STOSL   ,
0019 (temp.go:18) RET     , 
```

> [来电](http://golang.org/ref/spec#Calls)
> 
> 在函数调用中，函数值和参数按通常的顺序计算。在它们被评估之后，调用的参数按值传递给函数，被调用的函数开始执行。函数的返回参数在函数返回时按值传回调用函数。

所有函数和返回参数都是按值传递的。带类型的返回参数值`*MyStructType`是一个地址。

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2015-09-29T18:07:03.840

根据[Go 的常见问题解答](https://golang.org/doc/faq#stack_or_heap)：

> 如果编译器在函数返回后无法证明该变量未被引用，则编译器必须在垃圾回收堆上分配该变量以避免悬空指针错误。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2015-11-21T12:50:15.477

> 您并不总是知道您的变量是分配在堆栈还是堆上。
> ...
> 如果您需要知道变量的分配位置，请将“-m”gc 标志传递给“go build”或“go run”（例如，`go run -gcflags -m app.go`）。

[来源：[http ://devs.cloudimmunity.com/gotchas-and-common-mistakes-in-go-golang/index.html#stack_heap_vars](http://devs.cloudimmunity.com/gotchas-and-common-mistakes-in-go-golang/index.html#stack_heap_vars)]

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-08-17T02:36:47.230

```
func Function1() (*MyStructType, error) {
    var chunk *MyStructType = new(HeaderChunk)

    ...

    return chunk, nil
}

func Function2() (*MyStructType, error) {
    var chunk MyStructType

    ...

    return &chunk, nil
} 
```

Function1 和 Function2 可能是内联函数。并且返回变量不会逃逸。不必在堆上分配变量。

我的示例代码：

```
 package main

   type S struct {
           x int
   }

   func main() {
           F1()
           F2()
          F3()
  }

  func F1() *S {
          s := new(S)
          return s
  }

  func F2() *S {
          s := S{x: 10}
          return &s
  }

  func F3() S {
          s := S{x: 9}
          return s
  } 
```

根据cmd的输出：

```
go run -gcflags -m test.go 
```

输出：

```
# command-line-arguments
./test.go:13:6: can inline F1
./test.go:18:6: can inline F2
./test.go:23:6: can inline F3
./test.go:7:6: can inline main
./test.go:8:4: inlining call to F1
./test.go:9:4: inlining call to F2
./test.go:10:4: inlining call to F3
/var/folders/nr/lxtqsz6x1x1gfbyp1p0jy4p00000gn/T/go-build333003258/b001/_gomod_.go:6:6: can inline init.0
./test.go:8:4: main new(S) does not escape
./test.go:9:4: main &s does not escape
./test.go:14:10: new(S) escapes to heap
./test.go:20:9: &s escapes to heap
./test.go:19:2: moved to heap: s 
```

如果编译器足够聪明，*F1()* *F2()* *F3()*可能不会被调用。因为它没有办法。

不要关心变量是分配在堆上还是栈上，只要使用它。如有必要，通过互斥锁或通道保护它。

# python - 如何使用 pip 将 Python 包从 vcs 可编辑安装到特定目录？

> ID：10866199
> 
> 赞同：9
> 
> 时间：2012-06-02T21:46:59.753
> 
> 标签：python, version-control, pip

默认情况下，pip 将*可编辑*的包安装到`src`Python 安装目录的子目录中。

我想将版本控制中的包安装到我选择的目录中，使用 pip 支持从源代码控制中检出包，例如：

```
pip install -e git+https://github.com/kennethreitz/requests.git@355b97165c#egg=requests-org 
```

这可能吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-13T13:45:56.377

`pip help install`说：

```
--src=DIR, --source=DIR, --source-dir=DIR, --source-directory=DIR
                      Check out --editable packages into DIR 
```

例如：

```
pip install -e git+https://github.com/kennethreitz/requests.git@355b97165c#egg=requests-org --source-directory=/tmp 
```

将请求源安装在`/tmp/requests-org`

# silverlight - 如何将浏览器内的 silverlight 客户端连接到 ACS - Azure - WIF - 实体框架（公共和私有 DB 模型）

> ID：10866200
> 
> 赞同：1
> 
> 时间：2012-06-02T21:47:00.097
> 
> 标签：silverlight, entity-framework, azure, wif, acs

您好亲爱的贡献者！

我又拖延了，我已经研究了一个教程或一些关于如何改编这个精彩教程的方向：

[http://msdn.microsoft.com/en-us/WAZPlatformTrainingCourse_ACSAndWindowsPhone7](http://msdn.microsoft.com/en-us/WAZPlatformTrainingCourse_ACSAndWindowsPhone7)

到浏览器中的 silverlight 应用程序而不是 windows 手机？我想保留当前的模型，包括公共和私人数据库，并在理想情况下将 silverlight 应用程序插入 azure 社交游戏包：

[https://github.com/WindowsAzure-Toolkits/wa-toolkit-games](https://github.com/WindowsAzure-Toolkits/wa-toolkit-games)

它使用类似的 ACS 模式，我需要的方向是关于 Oauth2 的客户端处理。

提前感谢您在此问题上的任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-03T14:48:53.890

如果它是浏览器内的 silverlight 应用程序，为什么不将其视为常规网站？流程将类似于

1.  用户浏览您的应用
2.  在您发送 XAP 之前，您的网站会显示身份提供者列表。用户选择一个并被重定向到登录。
3.  用户登录后，您将收到一个发布到您的应用程序（即社交游戏工具包）的令牌。好消息是社交游戏工具包已经在网站上提供了与 ACS 的集成，因此无需做太多工作。用户将获得由 Windows Identity Foundation 生成的 cookie，其中包含声明（目前不涉及 Silverlight）。
4.  现在您发送 XAP 并加载 Silverlight 应用程序
5.  从现在开始，从 XAP 到您的应用程序（将具有社交游戏工具包）的每个请求都将填充 Principal，因为 WIF cookie 会在每个请求中发送。

如果您想稍微改变用户体验，而不是在常规的 HTML/asp.net 页面中显示身份提供者列表，您想从 Silverlight 应用程序（如 Windows Phone 实验室显示）中完成。然后，您只需要使用 ACS JSON 端点，该端点列出了您的 Silverlight 应用程序中的身份提供者。

该工具包已经在这样做了，您可以从以下内容中提取基本思想：

[https://github.com/WindowsAzure-Toolkits/wa-toolkit-games/blob/master/code/SocialGames.Web/Services/AuthService.cs#L29](https://github.com/WindowsAzure-Toolkits/wa-toolkit-games/blob/master/code/SocialGames.Web/Services/AuthService.cs#L29)

以 JSON 格式获取身份提供者列表的请求如下所示：

[https://your_servicenamespace.accesscontrol.windows.net/v2/metadata/IdentityProviders.js?protocol=wsfederation&realm=your_application_realm&version=1.0&context=some_contextual_data_youwanttokeepacrossredirects](https://your_servicenamespace.accesscontrol.windows.net/v2/metadata/IdentityProviders.js?protocol=wsfederation&realm=your_application_realm&version=1.0&context=some_contextual_data_youwanttokeepacrossredirects) "

最后，这个实验室也应该对你有所帮助

[http://msdn.microsoft.com/en-us/IdentityTrainingCourse_SilverligthAndIdentity2010](http://msdn.microsoft.com/en-us/IdentityTrainingCourse_SilverligthAndIdentity2010)

FWIW，Windows Phone 的工作方式是使用 ACS 中的 JavaScript 通知端点，这与我上面描述的不同。

流程类似于

1.  手机显示登录选项（Facebook、LiveID 等）
2.  用户点击其中之一
3.  用户被重定向到 ACS，然后被重定向到选择的身份提供者
4.  用户登录并将某种令牌发送回 ACS（取决于身份提供者）
5.  此时 ACS 将使用一些 JavaScript 渲染一个 HTML 页面。这将指示浏览器（托管在您的 Windows Phone 中）发送带有有效负载（在本例中为令牌）的外部信号。 `window.external.Notify('THE_TOKEN');`
6.  手机应用程序将检测到通知并获取令牌

我不确定 JavaScript 通知机制将如何在 Silverlight 浏览器内应用程序上工作，因为您已经在浏览器中。但是，如果您尝试这样做，请随时通知我们。

马蒂亚斯

# ios - 这个 Core Data 崩溃的可能原因是什么

> ID：10866204
> 
> 赞同：3
> 
> 时间：2012-06-02T21:47:59.397
> 
> 标签：ios, core-data, nsfetchedresultscontroller

首先，很抱歉我无法为这个问题找到更好的标题。

这是一个我无法重复自己但多次发生在用户身上的崩溃。我正在使用 HockeyApp( [QuincyKit](https://github.com/TheRealKerni/QuincyKit/) ) 收集崩溃报告。所以无法调试这个问题，只能读取调用堆栈。但是读完之后我不知道出了什么问题。我在中间省略了几个不相关的函数调用。

对于 UI 部分，我`NSFetchedResultsController`用来填充`UITableView`.

对于核心数据部分，我使用 iOS 5 新引入的父子 MOC：父 MOC 用于主队列，子 MOC 用于资源获取队列。我在处理其中获取的数据后保存子 MOC。一旦我保存子 MOC，Core Data 会自动将更改推送到父 MOC，FRC 应该通过其委托查看更改并更新表视图。然后我回调主线程以进行额外的 UI 更新。

具体来说，我可以理解如何`[UITableView indexPathForRowAtPoint:]`调用`[NSFetchedResultsController objectAtIndexPath:]`，但我不明白为什么它最终会调用我的实体`initWithEntity:insertIntoManagedObjectContext:`以及为什么`initWithEntity:insertIntoManagedObjectContext:`会导致未实现的错误。我认为`[NSFetchedResultsController objectAtIndexPath:]`应该这样做`fetch`，但它确实`insert`在这里。

```
Exception Type:  SIGABRT
Exception Codes: #0 at 0x35e7e32c
Crashed Thread:  0

Application Specific Information:
*** Terminating app due to uncaught exception 'NSObjectInaccessibleException', reason: 'CoreData could not fulfill a fault for '0xe62bdc0 <x-coredata://327F5799-CAB1-4086-8E75-0E87F0E19BF0/Status/p385>''

Last Exception Backtrace:
0   CoreFoundation                      0x355c888f __exceptionPreprocess + 162
1   libobjc.A.dylib                     0x3796f259 objc_exception_throw + 32
2   CoreData                            0x35f124f3 _PFFaultHandlerLookupRow + 1098
3   CoreData                            0x35f11d5b _PF_FulfillDeferredFault + 194
4   CoreData                            0x35f11c0b _sharedIMPL_pvfk_core + 38    
5   XXX                                0x0008a5c3 -[Tweet initWithEntity:insertIntoManagedObjectContext:] (Tweet.m:125)
6   XXX                                0x0003fd1b -[Status initWithEntity:insertIntoManagedObjectContext:] (Status.m:333)
7   CoreData                            0x35f0eded -[NSManagedObject(_NSInternalMethods) _initWithEntity:withID:withHandler:withContext:] + 164
8   CoreData                            0x35f0de07 -[NSManagedObjectContext(_NSInternalAdditions) _retainedObjectWithID:optionalHandler:withInlineStorage:] + 134
9   CoreData                            0x35f6b6eb _PFRetainedObjectIDCore + 330
10  CoreData                            0x35f67065 -[NSManagedObjectContext objectWithID:] + 88
11  CoreData                            0x35f32c09 _faultBatchAtIndex + 1352
12  CoreData                            0x35f31e73 -[_PFBatchFaultingArray objectAtIndex:] + 42
13  CoreData                            0x35f30a87 -[_PFMutableProxyArray objectAtIndex:] + 82
14  CoreData                            0x35fdd81d -[NSFetchedResultsController objectAtIndexPath:] + 204
16  XXX                                0x0009ebab -[TweetsViewController tableView:heightForRowAtIndexPath:] (TweetsViewController.m:581)
17  UIKit                               0x3304dab5 -[UISectionRowData refreshWithSection:tableView:tableViewRowData:] + 2548
18  UIKit                               0x33067c3b -[UITableViewRowData rectForSection:] + 302
19  UIKit                               0x33125981 -[UITableViewRowData indexPathsForRowsInRect:] + 136
20  UIKit                               0x331258f1 -[UITableView indexPathsForRowsInRect:] + 52
21  UIKit                               0x33125889 -[UITableView indexPathForRowAtPoint:] + 28
22  XXX                                0x0009c193 -[TweetsViewController updateUI] (TweetsViewController.m:211)
25  XXX                                0x00111a6f __block_global_1 (ResourceFetcher.m:68)
26  libdispatch.dylib                   0x34458b87 _dispatch_barrier_sync_f_slow_invoke + 82
27  libdispatch.dylib                   0x34457ee7 _dispatch_main_queue_callback_4CF$VARIANT$mp + 194
28  CoreFoundation                      0x3559b2ad __CFRunLoopRun + 1268
29  CoreFoundation                      0x3551e4a5 CFRunLoopRunSpecific + 300
30  CoreFoundation                      0x3551e36d CFRunLoopRunInMode + 104
31  GraphicsServices                    0x371ba439 GSEventRunModal + 136
32  UIKit                               0x3302acd5 UIApplicationMain + 1080
33  XXX                                0x000044ff main (main.m:16)
34  XXX                                0x00003c50 start + 40 
```

有这种崩溃问题的用户通常会在崩溃前突然看到表格视图从充满单元格变为空。我认为这是一个重要的提示，但我想不出所有数据突然消失的任何原因——我没有移动或删除数据库文件的代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-02T23:34:56.647

首先，在查找错误时，没有不相关的函数调用，因此您可能应该使用整个调用堆栈进行编辑...

看起来您正在请求一个对象（请参阅 objectWithID 调用），但是当托管对象上下文去获取它时，它找不到它。

当您有一个单独的线程正在删除对象并且您没有正确管理更改时，通常会发生这种情况。

那么，您是否有任何其他线程正在改变您的核心数据存储的状态？如果是这样，那可能是你的罪魁祸首。

Core Data 并不难……但它确实有几条规则，如果你不遵守，你就会遇到麻烦。

首先，确保您没有从多个线程访问 MOC。

其次，如果多个线程正在更改底层存储，请确保您与所有 MOCS 正确同步 - 使用父/子上下文或查看 DidSave 通知。

**编辑**

你评论说：

> 是的，我也怀疑存在一些删除使用中的问题。但首先，你知道为什么这里会调用 initWithEntity:insertIntoManagedObjectContext: 吗？

是的......它需要实例化对象。查看您的调用堆栈，您可以看到它...

您的 UI 正在尝试在主线程上更新...

```
22  XXX  0x0009c193 -[TweetsViewController updateUI] (TweetsViewController.m:211) 
```

因此，UIKit 会做它的事情，并向您的控制器发出委托回调......

```
16  XXX  0x0009ebab -[TweetsViewController tableView:heightForRowAtIndexPath:] (TweetsViewController.m:581) 
```

这会导致您正在谈论的 FRC 呼叫...

```
14  CoreData  0x35fdd81d -[NSFetchedResultsController objectAtIndexPath:] + 204 
```

然后，需要该对象，因此将其取出...

```
10  CoreData  0x35f67065 -[NSManagedObjectContext objectWithID:] + 88 
```

好吧，即使是 Core Data 也必须实例化该对象。它没有一些神奇的界面。它调用用于创建托管对象的普通 API……显然您正在请求“状态”类型的对象

```
6   XXX  0x0003fd1b -[Status initWithEntity:insertIntoManagedObjectContext:] (Status.m:333) 
```

反过来，这个对象需要一个“Tweet”类型的对象......

```
5   XXX  0x0008a5c3 -[Tweet initWithEntity:insertIntoManagedObjectContext:] (Tweet.m:125) 
```

然后，当它必须实例化那个对象时......它失败了，因为它找不到它。因此，我再次打赌，您的同步中存在逻辑错误。您正在删除一个对象并且没有正确通知其他上下文，因此它们仍在引用已删除的对象......或者您正在引用一个没有真正保存的对象......或者您已经更改了关系，但没有正确通知其他情况。

无论哪种方式，我认为如果您跟踪更改数据库的方式，您将违反一些用于在多个线程中更新的标准协议，这是一个不错的选择。

事实上，你甚至可以看到你是如何到达那里的......

从 GCD 调度队列调用 updateUI。最有可能的是，在 ResourceFetcher 中，您正在调用主线程。在该代码中，请确保您已正确保存上下文并发出所有通知，然后再要求主线程自行更新。

你最好听听来自其他 MOC 的 DidSave 事件，然后在从那个上下文更新之后，调用你的 UI 来更新自己。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-11T20:03:01.950

最后，我想我已经修复了崩溃，尽管我不确定这是我的错误还是 Core Data 的错误。

首先，它与 MOC 之间的同步无关。

其次，是的，`initWithEntity:insertIntoManagedObjectContext:`当对象第一次在 moc 中实例化时调用，无论它们是新创建的还是通过请求获取的。因此，该文档似乎具有误导性：

> 如果 context 不是 nil，则此方法调用 [context insertObject:self]（这会导致调用 awakeFromInsert）。

如果调用它来获取，`awakeFromFetch`则调用它。

正如您在回溯中看到的那样，崩溃发生在我被覆盖的`initWithEntity:insertIntoManagedObjectContext:`. 足够合理，`initWithEntity:insertIntoManagedObjectContext:`原来是坠机的原因。但我不认为我在这件事上做错了什么。我只是使用了一些持久化属性来初始化一些非持久化属性：

```
- (id)initWithEntity:(NSEntityDescription *)entity insertIntoManagedObjectContext:(NSManagedObjectContext *)context {
    self = [super initWithEntity:entity insertIntoManagedObjectContext:context];
    if (self) {
        // xxx_ is a persistent attribute while _xxx is the corresponding non-persistent attribute as its cache in memory only to reduce reading cost.
        _xxx = self.xxx_.unsignedIntegerValue;
    }
    return self;
} 
```

有时，当我阅读第一个持久属性时，会抛出无法实现的异常。

我一直都知道

> 不鼓励您重写此方法——您应该重写 awakeFromInsert 和/或 awakeFromFetch（如果这些方法有共同的逻辑，则应将其分解为从两者调用的第三个方法）。如果您确实在此方法中执行自定义初始化，则可能会导致撤消和重做操作出现问题。

但我不知道这会导致无法实现的异常。它是核心数据错误吗？否则，我的代码有什么问题？

# java - 二维数组列表

> ID：10866205
> 
> 赞同：58
> 
> 时间：2012-06-02T21:48:18.827
> 
> 标签：java

我听说过使用这样的二维数组：

```
String[][] strArr; 
```

但是有没有办法用一个列表来做到这一点？

也许是这样的？

```
ArrayList<String><String> strList; 
```

并使用这样的东西来添加它？

```
strList.add("hey", "hey"); 
```

有什么办法可以做这样的事情吗？任何帮助表示赞赏。

如果有的话会很好，因为我目前正在将字符串成对地放入两个不同的 ArrayList 中。

* * *

## 回答 #1

> 赞同：89
> 
> 时间：2012-06-02T21:49:05.643

你会用

```
List<List<String>> listOfLists = new ArrayList<List<String>>(); 
```

然后当您需要添加新的“行”时，您将添加列表：

```
listOfLists.add(new ArrayList<String>()); 
```

当我想在 GUI 中保存对多个 Point 列表的引用时，我主要使用它，这样我就可以绘制多条曲线。它运作良好。

例如：

```
import java.awt.BasicStroke;
import java.awt.Color;
import java.awt.Dimension;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.Point;
import java.awt.RenderingHints;
import java.awt.Stroke;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;
import java.util.ArrayList;
import java.util.List;
import javax.swing.*;

@SuppressWarnings("serial")
public class DrawStuff extends JPanel {
   private static final int PREF_W = 400;
   private static final int PREF_H = PREF_W;
   private static final Color POINTS_COLOR = Color.red;
   private static final Color CURRENT_POINTS_COLOR = Color.blue;
   private static final Stroke STROKE = new BasicStroke(4f);
   private List<List<Point>> pointsList = new ArrayList<List<Point>>();
   private List<Point> currentPointList = null;

   public DrawStuff() {
      MyMouseAdapter myMouseAdapter = new MyMouseAdapter();
      addMouseListener(myMouseAdapter);
      addMouseMotionListener(myMouseAdapter);
   }

   @Override
   public Dimension getPreferredSize() {
      return new Dimension(PREF_W, PREF_H);
   }

   @Override
   protected void paintComponent(Graphics g) {
      super.paintComponent(g);
      Graphics2D g2 = (Graphics2D) g;
      g2.setRenderingHint(RenderingHints.KEY_ANTIALIASING, 
            RenderingHints.VALUE_ANTIALIAS_ON);
      g2.setStroke(STROKE);
      g.setColor(POINTS_COLOR);
      for (List<Point> pointList : pointsList) {
         if (pointList.size() > 1) {
            Point p1 = pointList.get(0);
            for (int i = 1; i < pointList.size(); i++) {
               Point p2 = pointList.get(i);
               int x1 = p1.x;
               int y1 = p1.y;
               int x2 = p2.x;
               int y2 = p2.y;
               g.drawLine(x1, y1, x2, y2);
               p1 = p2;
            }
         }
      }
      g.setColor(CURRENT_POINTS_COLOR);
      if (currentPointList != null && currentPointList.size() > 1) {
         Point p1 = currentPointList.get(0);
         for (int i = 1; i < currentPointList.size(); i++) {
            Point p2 = currentPointList.get(i);
            int x1 = p1.x;
            int y1 = p1.y;
            int x2 = p2.x;
            int y2 = p2.y;
            g.drawLine(x1, y1, x2, y2);
            p1 = p2;
         }
      }
   }

   private class MyMouseAdapter extends MouseAdapter {
      @Override
      public void mousePressed(MouseEvent mEvt) {
         currentPointList = new ArrayList<Point>();
         currentPointList.add(mEvt.getPoint());
         repaint();
      }

      @Override
      public void mouseDragged(MouseEvent mEvt) {
         currentPointList.add(mEvt.getPoint());
         repaint();
      }

      @Override
      public void mouseReleased(MouseEvent mEvt) {
         currentPointList.add(mEvt.getPoint());
         pointsList.add(currentPointList);
         currentPointList = null;
         repaint();
      }
   }

   private static void createAndShowGui() {
      JFrame frame = new JFrame("DrawStuff");
      frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
      frame.getContentPane().add(new DrawStuff());
      frame.pack();
      frame.setLocationRelativeTo(null);
      frame.setVisible(true);
   }

   public static void main(String[] args) {
      SwingUtilities.invokeLater(new Runnable() {
         public void run() {
            createAndShowGui();
         }
      });
   }
} 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2014-07-04T06:20:39.453

您可以创建一个列表，

```
ArrayList<String[]> outerArr = new ArrayList<String[]>(); 
```

并向其中添加其他列表，如下所示：

```
String[] myString1= {"hey","hey","hey","hey"};  
outerArr .add(myString1);
String[] myString2= {"you","you","you","you"};
outerArr .add(myString2); 
```

现在您可以使用下面的双循环来显示所有列表中的所有内容

```
for(int i=0;i<outerArr.size();i++){

   String[] myString= new String[4]; 
   myString=outerArr.get(i);
   for(int j=0;j<myString.length;j++){
      System.out.print(myString[j]); 
   }
   System.out.print("\n");

} 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-06-02T21:49:58.110

二维数组只是一个数组数组。列表的类比只是 a `List`of `List`s。

```
ArrayList<ArrayList<String>> myList = new ArrayList<ArrayList<String>>(); 
```

我承认，这不是一个很好的解决方案，特别是如果您选择 3 维或更多维结构。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2019-06-19T04:14:23.060

声明一个二维 ArrayList：

```
ArrayList<ArrayList<String>> rows = new ArrayList<String>(); 
```

或者

```
ArrayList<ArrayList<String>> rows = new ArrayList<>(); 
```

或者

```
ArrayList<ArrayList<String>> rows = new ArrayList<ArrayList<String>>(); 
```

以上都是二维 ArrayList 的有效声明！

现在，声明一个一维 ArrayList：

```
ArrayList<String> row = new ArrayList<>(); 
```

在二维 ArrayList 中插入值：

```
for(int i=0; i<5; i++){
    ArrayList<String> row = new ArrayList<>();
    for(int j=0; j<5; j++){
        row.add("Add values here"); 
    }
    rows.add(row); 
} 
```

从二维 ArrayList 中获取值：

```
for(int i=0; i<5; i++){
    for(int j=0; j<5; j++){
        System.out.print(rows.get(i).get(j)+" ");
     }
     System.out.println("");
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-06-02T22:02:18.207

如果您的平台矩阵支持 Java 7，那么您可以像下面这样使用

```
List<List<String>> myList = new ArrayList<>(); 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2015-08-06T17:33:56.327

事实上，二维数组是列表的列表`X`，其中`X`是您的数据结构之一，从典型的数据结构到用户定义的数据结构。作为以下快照代码，我将逐行添加到数组`triangle`中。为了创建每一行，我使用`add`手动添加元素的方法或`asList`从数据带创建列表的方法。

```
package algorithms;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;

public class RunDemo {

/**
 * @param args
 */
public static void main(String[] args) {
    // Get n
    List<List<Integer>> triangle = new ArrayList<List<Integer>>();

    List<Integer> row1 = new ArrayList<Integer>(1);
    row1.add(2);
    triangle.add(row1);

    List<Integer> row2 = new ArrayList<Integer>(2);
    row2.add(3);row2.add(4);
    triangle.add(row2);

    triangle.add(Arrays.asList(6,5,7));
    triangle.add(Arrays.asList(4,1,8,3));

    System.out.println("Size = "+ triangle.size());
    for (int i=0; i<triangle.size();i++)
        System.out.println(triangle.get(i));

}
} 
```

运行示例，它会生成输出：

```
Size = 4
[2]
[3, 4]
[6, 5, 7]
[4, 1, 8, 3] 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-05-04T00:37:39.047

我知道这是一个很好答案的老问题，但我相信我可以加我的 2 美分。

对我有用的最简单和最灵活的方法就是使用几乎“普通和旧 Java 对象”类 2D 来创建数组的每个“行”。

下面的例子有一些解释并且是可执行的（你可以复制粘贴它，但记得检查包名）：

```
package my2darraylist;

import java.util.ArrayList;
import java.util.List;
import javax.swing.JPanel;

public class My2DArrayList
{
    public static void main(String[] args)
    {
        // This is your "2D" ArrayList
        // 
        List<Box> boxes = new ArrayList<>();

        // Add your stuff
        //
        Box stuff = new Box();
        stuff.setAString( "This is my stuff");
        stuff.addString("My Stuff 01");
        stuff.addInteger( 1 );
        boxes.add( stuff );

        // Add other stuff
        //
        Box otherStuff = new Box();
        otherStuff.setAString( "This is my other stuff");
        otherStuff.addString("My Other Stuff 01");
        otherStuff.addInteger( 1 );
        otherStuff.addString("My Other Stuff 02");
        otherStuff.addInteger( 2 );
        boxes.add( otherStuff );

        // List the whole thing
        for ( Box box : boxes)
        {
            System.out.println( box.getAString() );
            System.out.println( box.getMyStrings().size() );
            System.out.println( box.getMyIntegers().size() );
        }
    }

}

class Box
{
    // Each attribute is a "Column" in you array
    //    
    private String aString;
    private List<String> myStrings = new ArrayList<>() ;
    private List<Integer> myIntegers = new ArrayList<>();
    // Use your imagination...
    //
    private JPanel jpanel;

    public void addString( String s )
    {
        myStrings.add( s );
    }

    public void addInteger( int i )
    {
        myIntegers.add( i );
    }

    // Getters & Setters

    public String getAString()
    {
        return aString;
    }

    public void setAString(String aString)
    {
        this.aString = aString;
    }

    public List<String> getMyStrings()
    {
        return myStrings;
    }

    public void setMyStrings(List<String> myStrings)
    {
        this.myStrings = myStrings;
    }

    public List<Integer> getMyIntegers()
    {
        return myIntegers;
    }

    public void setMyIntegers(List<Integer> myIntegers)
    {
        this.myIntegers = myIntegers;
    }

    public JPanel getJpanel()
    {
        return jpanel;
    }

    public void setJpanel(JPanel jpanel)
    {
        this.jpanel = jpanel;
    }
} 
```

**更新**- 为了回答@Mohammed Akhtar Zuberi 的问题，我创建了程序的简化版本，以便更容易地显示结果。

```
import java.util.ArrayList;

public class My2DArrayListSimplified
{

    public static void main(String[] args)
    {
        ArrayList<Row> rows = new ArrayList<>();
        Row row;
        // Insert the columns for each row
        //             First Name, Last Name, Age
        row = new Row("John",      "Doe",     30);
        rows.add(row);
        row = new Row("Jane",      "Doe",     29);
        rows.add(row);
        row = new Row("Mary",      "Doe",      1);
        rows.add(row);

        // Show the Array
        //
        System.out.println("First\t Last\tAge");
        System.out.println("----------------------");
        for (Row printRow : rows)
        {
            System.out.println(
                    printRow.getFirstName() + "\t " +
                    printRow.getLastName() + "\t" +
                    printRow.getAge());

        }
    }

}

class Row
{

    // REMEMBER: each attribute is a column
    //
    private final String firstName;
    private final String lastName;
    private final int age;

    public Row(String firstName, String lastName, int age)
    {
        this.firstName = firstName;
        this.lastName = lastName;
        this.age = age;
    }

    public String getFirstName()
    {
        return firstName;
    }

    public String getLastName()
    {
        return lastName;
    }

    public int getAge()
    {
        return age;
    }

} 
```

上面的代码产生以下结果（我在 NetBeans 上运行它）：

```
run:
First    Last   Age
----------------------
John     Doe    30
Jane     Doe    29
Mary     Doe    1
BUILD SUCCESSFUL (total time: 0 seconds) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-11-02T05:29:29.367

以下是使用 ArrayList 对象制作和打印二维多维数组的方法。

```
import java.util.ArrayList;

public class TwoD_ArrayListExample {
    static public ArrayList<ArrayList<String>> gameBoard = new ArrayList<ArrayList<String>>();

    public static void main(String[] args) {
        insertObjects();
        printTable(gameBoard);
    }

    public static void insertObjects() {
        for (int rowNum = 0; rowNum != 8; rowNum++) {
            ArrayList<String> oneRow = new ArrayList<String>();
            gameBoard.add(rowNum, oneRow);

            for (int columnNum = 0; columnNum != 8; columnNum++) {
                String description= "Description of Objects: row= "+ rowNum + ", column= "+ columnNum;
                    oneRow.add(columnNum, description);
            }
        }
    }

    // The printTable method prints the table to the console
    private static void printTable(ArrayList<ArrayList<String>> table) {
        for (int row = 0; row != 8; row++) {
            for (int col = 0; col != 8; col++) {
                System.out.println("Printing:               row= "+ row+ ", column= "+ col);
                System.out.println(table.get(row).get(col).toString());
            }
        }
        System.out.println("\n");
    }
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-06-25T03:26:34.043

```
for (Project project : listOfLists) {
    String nama_project = project.getNama_project();
    if (project.getModelproject().size() > 1) {
        for (int i = 1; i < project.getModelproject().size(); i++) {
            DataModel model = project.getModelproject().get(i);
            int id_laporan = model.getId();
            String detail_pekerjaan = model.getAlamat();
        }
    }
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-10-19T08:54:23.850

```
ArrayList<ArrayList<String>> ar = new ArrayList<>();
ArrayList<String> arr = new ArrayList<>();
arr.add("data1");
arr.add("data2");
ar.add(arr);
System.out.println(ar.get(0).get(0));
// Output data1 
```

这么简单

# java - 为什么我的小程序的paint方法会抛出ConcurrentModificationException

> ID：10866207
> 
> 赞同：0
> 
> 时间：2012-06-02T21:49:00.330
> 
> 标签：java, concurrency, applet, awt

这是我的小程序类：

```
package DavidPackages.Prototypes.Samples.BubblesV2SSCCE;

import java.applet.Applet;
import java.awt.*;
import java.awt.geom.Ellipse2D;
import java.util.ArrayList;
import java.util.Random;

public class BubbleAppletV2SSCCE extends Applet implements Runnable{

    private Thread thread;
    private ArrayList<Ellipse2D> circles;

    public void init(){
        //Initialize bubbles with one entry so that we have a bubble to start out with
        Random r = new Random();
        circles = new ArrayList<Ellipse2D>();
        circles.add(new Ellipse2D.Float(5, 5, 15, 15));

        thread = new Thread(this);
        thread.start();
    }

    public void run(){
        while(true){

            update();
            repaint();

            try{
                Thread.sleep(10);
            }catch(InterruptedException ie){
                ie.printStackTrace();
            }
        }
    }

    private void update(){
        circles.add(new Ellipse2D.Float(5, 5, 15, 15));
    }

    public void paint(Graphics graphics){
        for(Ellipse2D circle : circles){
           ((Graphics2D) graphics).draw(circle);
        }
    }

    public void stop(){}
} 
```

这是堆栈跟踪：

```
Exception in thread "AWT-EventQueue-1" java.util.ConcurrentModificationException
at java.util.AbstractList$Itr.checkForComodification(AbstractList.java:449)
at java.util.AbstractList$Itr.next(AbstractList.java:420)
at DavidPackages.Prototypes.Samples.BubblesV2SSCCE.BubbleAppletV2SSCCE.paint(BubbleAppletV2SSCCE.java:43)
at sun.awt.RepaintArea.paintComponent(RepaintArea.java:276)
at sun.awt.RepaintArea.paint(RepaintArea.java:241)
at apple.awt.ComponentModel.handleEvent(ComponentModel.java:268)
at java.awt.Component.dispatchEventImpl(Component.java:4159)
at java.awt.Container.dispatchEventImpl(Container.java:2068)
at java.awt.Component.dispatchEvent(Component.java:3918)
at java.awt.EventQueue.dispatchEventImpl(EventQueue.java:501)
at java.awt.EventQueue.access$000(EventQueue.java:80)
at java.awt.EventQueue$1.run(EventQueue.java:462)
at java.awt.EventQueue$1.run(EventQueue.java:461)
at java.security.AccessController.doPrivileged(Native Method)
at java.security.AccessControlContext$1.doIntersectionPrivilege(AccessControlContext.java:84)
at java.security.AccessControlContext$1.doIntersectionPrivilege(AccessControlContext.java:95)
at java.awt.EventQueue$2.run(EventQueue.java:476)
at java.awt.EventQueue$2.run(EventQueue.java:475)
at java.security.AccessController.doPrivileged(Native Method)
at java.security.AccessControlContext$1.doIntersectionPrivilege(AccessControlContext.java:84)
at java.awt.EventQueue.dispatchEvent(EventQueue.java:473)
at java.awt.EventDispatchThread.pumpOneEventForHierarchy(EventDispatchThread.java:269)
at java.awt.EventDispatchThread.pumpEventsForHierarchy(EventDispatchThread.java:190)
at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:184)
at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:176)
at java.awt.EventDispatchThread.run(EventDispatchThread.java:110) 
```

我的代码中唯一的调用是：

```
 at DavidPackages.Prototypes.Samples.BubblesV2SSCCE.BubbleAppletV2SSCCE.paint(BubbleAppletV2SSCCE.java:43) 
```

这是这一行：

```
 for(Ellipse2D circle : circles){ 
```

更多细节：

*   我在 IntelliJ IDEA 10.5.4 中运行它
*   我在运行 OSX 10.5.8 的 Mac 上运行它
*   当气泡中有更多的 Bubble 实例时，更有可能抛出异常
*   小程序的多个实例运行时更有可能抛出异常

我很困惑，因为我看不到在控制位于 for 循环中时如何修改气泡的内容。

有没有人有任何想法？

奖金问题：

*   我的目的是最终创建一个在某人的机器上运行的游戏，而不是在网络浏览器中运行。除了小程序，我应该使用什么？
*   我应该使用什么来代替 AWT？

关于那里的第二个奖金问题。我发现[这篇文章](http://www.ibm.com/developerworks/grid/library/os-swingswt/)说：

> AWT 提供了丰富的图形环境，尤其是在 Java V1.2 及更高版本中。通过 Graphics2D 对象以及 Java2D 和 Java3D 服务，可以创建许多强大的图形应用程序，例如绘图和图表包，以及与 JavaSound 相结合的竞技互动游戏。

这让我相信 AWT 确实适合我。还是作者搞错了？这篇文章是 2006 年的，所以有点过时了，但不多。

更新（原始帖子中没有的东西）：

*   删除了长块注释掉的代码
*   更新了我的例子
*   添加了奖金问题
*   从比较 AWT 和 Swing 和 SWT 的文章中添加了引用

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-02T22:18:57.953

您不是在paint 方法中更改气泡的内容，而是在run 方法中更改它们，并且该方法在单独的线程中执行。这就解释了为什么你并不总是得到那个异常，它只发生在你正在更改另一个线程中的列表气泡的同时恰好执行绘制时。

# c - C中的输入法

> ID：10866211
> 
> 赞同：1
> 
> 时间：2012-06-02T21:49:55.130
> 
> 标签：c

如何从文本文件中提供输入，我的意思是当我以以下形式执行它时：

```
./a.out input.txt 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-02T21:51:20.267

在您的 C 程序中，您收到`"input.txt"`一个字符串并打开文件。

例如：

```
#include <stdio.h>

int main(int argc, char *argv[])
{
    FILE *fp = fopen(argv[1], "r");

    /* Do stuff with file */

    fclose(fp);
    return 0;
} 
```

您还必须添加检查以查看参数是否存在以及文件是否正确打开。这个例子只是基本概念。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-02T21:53:41.197

当您使用 ./a.out < input.txt 时，您的标准输入会从文件中获取输入数据。例如`scanf()`，现在将从 input.txt 中获取输入数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-02T21:59:06.747

用于从命令行执行的 C 程序通常在其`main()`函数中至少包含两个参数：参数的数量和包含参数的数组：

```
int main(int argc, char *argv[]) 
```

你通常做的第一件事就是解释论点。在您提供的示例中，有两个：程序本身的名称和文件名“input.txt”。此时，您可以打开“input.txt”并开始阅读、写作或其他任何事情。

# php - 使用 javascript 从 textarea 获取原始文本并将其发送到 PHP

> ID：10866216
> 
> 赞同：0
> 
> 时间：2012-06-02T21:50:36.690
> 
> 标签：php, javascript, ajax

我有一个文本区域，我在其中放置了一些 C++ 代码，然后我使用 javascript 获取该代码并通过 AJAX 将其发送到 PHP 脚本进行处理。问题是代码被破坏了。

这是我的代码：

```
function showResult()
{
  var code  = document.getElementById('code').value;
  var input = document.getElementById('input').value;

  if (code != '') {
    var xmlhttp;
    if (window.XMLHttpRequest) {
      xmlhttp = new XMLHttpRequest();
    }

    xmlhttp.onreadystatechange = function() {
      if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
        document.getElementById('result').innerHTML = xmlhttp.responseText;
      }
    }

    xmlhttp.open('GET', 'ideone.php?code=' + code + '&input=' + input, true);
    xmlhttp.send();
  }

} 
```

PHP：

```
<?php
    echo 'Code: '.$_GET['code']; // Empty string
?> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-02T21:54:04.473

您需要引用您的查询字符串：

```
xmlhttp.open('GET', 'ideone.php?code=' + encodeURIComponent(code) + '&input=' + encodeURIComponent(input), true); 
```

# iphone - 我的代码在使用核心数据时因“超出范围的索引”错误而崩溃

> ID：10866223
> 
> 赞同：2
> 
> 时间：2012-06-02T21:51:54.707
> 
> 标签：iphone, objective-c, ios, core-data

我不知道如何解决这个问题。每次用户滚动并在 UITableView 中显示时，此代码都会在每个单元格中运行：

```
self.isFinishedProcessing = NO;

    [self setNeedsDisplay];

    [self.mediaArray removeAllObjects];
    self.mediaArray = [[NSMutableArray alloc] init];

    dispatch_queue_t queue = dispatch_queue_create("setup_cell", NULL);

    NSManagedObjectID *objectID = [self.entry objectID];
    dispatch_async(queue, ^{

        CoreDataStore *customStore = [CoreDataStore createStore];

        Entry *entry = (Entry *)[customStore.context objectWithID:objectID];

        if (self.cellInfo.numberOfMediaItems > 0) {

            int i = 0;

            int numberOfThumbnails = MIN(self.cellInfo.numberOfMediaItems, 3);

            while (i < numberOfThumbnails) {
                Media *media = [entry.media objectAtIndex:i];

                UIImage *image = [media getThumbnail];
                [self.mediaArray addObject:image];

                i++;
            }
        }

        dispatch_async(dispatch_get_main_queue(), ^{

            self.isFinishedProcessing = YES;
            [self setNeedsDisplay];
        });

    }); 
```

核心数据存储将作为核心数据类的条目与媒体一起放入它自己的上下文中。

我还没有弄清楚滚动时这段代码何时崩溃，但它在上下滚动几次时会发生。

编辑：“索引对象”之前的 NSLog 表示计数为 3。可以肯定的是，我实际上为此做了 entry.media.count。

这是完整的错误：

```
*** Terminating app due to uncaught exception 'NSRangeException', reason: '*** -[__NSArrayM objectAtIndex:]: index 1 beyond bounds [0 .. 0]' 
```

编辑2：

还没有解决这个问题。我在最后添加了这个：

```
 if (self.mediaArray.count != self.entry.media.count) {
        NSLog(@"INCORRECT BECAUSE.... media array count: %i, entry media count: %i number of media items: %i", self.mediaArray.count, self.entry.media.count, self.cellInfo.numberOfMediaItems);
        } 
```

它经常在一个像这样的单元格之后崩溃：

```
INCORRECT BECAUSE.... media array count: 1, entry media count: 3 number of media items: 3 
```

不确定媒体数组计数如何可能是错误的，如果它是根据 self.cellInfo.numberOfMediaItems 创建的。

还值得注意的是，这只发生在单独的线程中。永远不会在主线程中崩溃。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-02T22:56:20.153

您违反了具有多个线程的 Core Data**规则 #1**。

您不得在线程中使用 MOC，除非它是在该线程中创建的。

您创建一个队列来为您运行一些工作......

```
dispatch_queue_t queue = dispatch_queue_create("setup_cell", NULL); 
```

然后在那个块中，您使用的是不是在那里创建的 MOC ......

```
Entry *entry = (Entry *)[customStore.context objectWithID:objectID]; 
```

如果你想和 MOC 一起工作，你*必须*遵守规则。我将总结**规则#1**，因为它有几个子句。

*   如果您使用 创建 MOC `NSConfinementConcurrencyType`，则无法调用`performBlock`该上下文。您**只能**在创建它的线程中使用它。

*   如果使用`NSMainQueueConcurrencyType`，则**必须**从主线程内访问 MOC，或通过`[moc performBlock]`.

*   如果您使用`NSPrivateQueueConcurrencyType`，则**必须**仅通过 使用它`[moc performBlock]`。

**编辑**

您的项目不同步。您应该只依靠数据实际告诉您的内容。显然，您指望来自 self.cellInfo.numberOfMediaItems 的计数，但它与您的实际数据不同步。

从多个线程更新数据时必须非常小心。您的代码“迷失了”实际发生的事情。可能是因为您尚未将内容保存到从中提取数据的上下文中。

阅读有关 Core Data 并发的文档。确保在没有通知所有其他上下文的情况下没有更改另一个线程中的任何内容。您应该使用父/子上下文和/或处理 DidSave 通知以保持数据同步。

# objective-c - Objective-C，如何将 char[] 传递给方法？

> ID：10866225
> 
> 赞同：1
> 
> 时间：2012-06-02T21:52:03.850
> 
> 标签：objective-c, cocoa, class

我有这个方法可以调用另一个方法。如何将 char[] 传递给它而不是在其中包含 char[]？

```
- (IBAction)goThere(id)sender {

   // char hex[] = {0xFF, 0xFF, 0x15}; <-- this is what I want to pass to elseWhere
   // NSString *text = "some string";  <-- it would be cool to send other things too.

    [self elseWhere];
}

- (void)elseWhere {

char hex[] = {0xDA, 0xFF, 0x15};

...

} 
```

理想情况下，我将能够从 goThere 发送 char[]，能够根据需要重新使用 char[]，不幸的是我在这方面并不先进。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-02T21:57:52.317

试试这个：

```
-(IBAction)goThere:(id)sender {
    char hex[] = {0xFF, 0xFF, 0x15};
    [self elseWhereWithData:hex length:3];
}

-(void)elseWhereWithData:(char*)array length:(int)length {
    // array is a char array with a length of length.
    // Do stuff....strong text
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-02T21:55:15.687

像这样：

```
-(void)method:(char[])array {
    //do something with array
} 
```

?

# winapi - 正确使用 GetRawInputBuffer

> ID：10866226
> 
> 赞同：2
> 
> 时间：2012-06-02T21:52:15.800
> 
> 标签：winapi, raw-input

[我正在尝试使用 Win32 Raw Input API 以更高的精度收集原始鼠标数据，但我似乎](http://msdn.microsoft.com/en-us/library/windows/desktop/ms645595%28v=vs.85%29.aspx)根本无法理解`GetRawInputBuffer`.

当我的鼠标悬停在窗口上时，似乎什么也没发生。当我在窗口的标题栏上单击或释放时，我似乎只获得缓冲数据，即使这样，我也大多获得 0 移动值并且*从未*收到鼠标按钮更改。我已经尽可能地密切关注样本，并且在网上搜索时运气不佳。

下面是一个非常简化的示例的窗口过程和主要问题。

```
LRESULT CALLBACK MessageHandler(HWND WindowHandle, UINT Message, WPARAM wParameter, LPARAM lParameter)
{
    switch(Message)
    {
    case WM_DESTROY:
        {
            PostQuitMessage(0);
            return 0;
        }
        break;
    case WM_CLOSE:
        {
            DestroyWindow(WindowHandle);
            return 0;
        }
        break;
    case WM_INPUT: 
        {
            UINT RawInputSize;
            UINT Result;

            Result = GetRawInputBuffer(NULL, &(RawInputSize), sizeof(RAWINPUTHEADER));
            if(Result == -1)
            {
                DWORD ErrorCode = GetLastError();
                std::cout << "GetRawInputBuffer returned error code" << ErrorCode << std::endl;
            }
            else if(Result == 0 && RawInputSize != 0)
            {
                UINT AllocatedBufferByteCount = RawInputSize * 16;
                RAWINPUT* RawInputBuffer = reinterpret_cast<RAWINPUT*>(malloc(AllocatedBufferByteCount));

                UINT AllocatedBufferByteCountTwo = AllocatedBufferByteCount;
                Result = GetRawInputBuffer(RawInputBuffer, &(AllocatedBufferByteCountTwo), sizeof(RAWINPUTHEADER));
                if(Result == -1)
                {
                    DWORD ErrorCode = GetLastError();
                    std::cout << "GetRawInputBuffer returned error code" << ErrorCode << std::endl;
                }
                else if(Result != 0)
                {
                    UINT RawInputCount = Result;

                    DWORD MouseDeltaX = 0;
                    DWORD MouseDeltaY = 0;

                    bool ButtonsPressed[2] = {false, false};

                    RAWINPUT* RawInput = RawInputBuffer;
                    for(unsigned int i = 0; i < RawInputCount; ++i)
                    {
                        switch(RawInput->header.dwType) 
                        {
                        // Raw mouse movement data for high-resolution mice. 
                        case RIM_TYPEMOUSE:
                            {
                                MouseDeltaX += RawInput->data.mouse.lLastX;
                                MouseDeltaY += RawInput->data.mouse.lLastY;

                                ButtonsPressed[0] = ((RawInput->data.mouse.usButtonFlags & RI_MOUSE_LEFT_BUTTON_DOWN) == RI_MOUSE_LEFT_BUTTON_DOWN);
                                ButtonsPressed[1] = ((RawInput->data.mouse.usButtonFlags & RI_MOUSE_RIGHT_BUTTON_DOWN) == RI_MOUSE_RIGHT_BUTTON_DOWN);
                            }
                            break;
                        }

                        RawInput = NEXTRAWINPUTBLOCK(RawInput);
                    }
                    DefRawInputProc(&(RawInputBuffer), RawInputCount, sizeof(RAWINPUTHEADER));
                    std::cout << "Mouse moved (" << MouseDeltaX << ", " << MouseDeltaY << ")." << std::endl;

                    if(ButtonsPressed[0])
                    {
                        std::cout << "LMB pressed." << std::endl;
                    }
                    if(ButtonsPressed[1])
                    {
                        std::cout << "RMB pressed." << std::endl;
                    }
                }

                free(RawInputBuffer);
            }
            return 0;
        }
        break;
    default:
        {
            return DefWindowProc(WindowHandle, Message, wParameter, lParameter);
        }
        break;
    }
}

int WINAPI WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nShowCmd)
{
    // Initialize window strings.
    wchar_t WindowClassName[] = L"DominionWindowClass";
    wchar_t WindowCaption[] = L"Test Window";

    // Create the window class.
    WNDCLASSEX WindowClass;
    WindowClass.cbSize = sizeof(WindowClass);
    WindowClass.style = CS_OWNDC | CS_HREDRAW | CS_VREDRAW;
    WindowClass.lpfnWndProc = &(MessageHandler);
    WindowClass.cbClsExtra = 0;
    WindowClass.cbWndExtra = 0;
    WindowClass.hInstance = hInstance;
    WindowClass.hIcon = LoadIcon(hInstance, IDI_APPLICATION);
    WindowClass.hIconSm = LoadIcon(hInstance, IDI_APPLICATION);
    WindowClass.hCursor = LoadCursor(NULL, IDC_ARROW);
    WindowClass.hbrBackground = NULL;
    WindowClass.lpszMenuName = NULL; 
    WindowClass.lpszClassName = WindowClassName;

    // Register window class.
    RegisterClassEx(&WindowClass);

    // Setup window style flags.
    DWORD WindowStyles = WS_VISIBLE | WS_OVERLAPPED | WS_CAPTION | WS_SYSMENU;
    DWORD ExWindowStyles = WS_EX_APPWINDOW;

    // Setup window rectangle area.
    RECT WindowArea;
    WindowArea.left = 0;
    WindowArea.top = 0;
    WindowArea.right = 1024;
    WindowArea.bottom = 768;

    AdjustWindowRectEx(&(WindowArea), WindowStyles, false, ExWindowStyles);

    // Window creation.
    HWND WindowHandle = CreateWindowEx(ExWindowStyles, WindowClass.lpszClassName, WindowCaption, WindowStyles, CW_USEDEFAULT, CW_USEDEFAULT, (WindowArea.right - WindowArea.left), (WindowArea.bottom - WindowArea.top), NULL, NULL, hInstance, NULL);

    // Display the window.
    ShowWindow(WindowHandle, SW_SHOWDEFAULT);
    UpdateWindow(WindowHandle);

    // Register devices for raw input.
    const unsigned int RawInputDeviceCount = 1;
    RAWINPUTDEVICE RawInputDevices[RawInputDeviceCount];

    memset(RawInputDevices, 0, RawInputDeviceCount * sizeof(RAWINPUTDEVICE));

    RAWINPUTDEVICE* MouseRawInputDevice;

    MouseRawInputDevice = RawInputDevices;
    MouseRawInputDevice->usUsagePage = 1;
    MouseRawInputDevice->usUsage = 2;
    MouseRawInputDevice->hwndTarget = WindowHandle;

    BOOL SuccessfullyRegisteredInput = RegisterRawInputDevices(RawInputDevices, RawInputDeviceCount, sizeof(RAWINPUTDEVICE));

    // Core loop.
    MSG Message;
    for(;;)
    {
        while(PeekMessage(&Message, NULL, 0, 0, PM_REMOVE))
        {
            TranslateMessage(&Message);
            DispatchMessage(&Message);
            if(Message.message == WM_QUIT)
            {
                break;
            }
        }

        if(Message.message == WM_QUIT)
        {
            break;
        }
    }

    // Unregister devices for raw input.
    memset(RawInputDevices, 0, RawInputDeviceCount * sizeof(RAWINPUTDEVICE));
    MouseRawInputDevice = RawInputDevices;
    MouseRawInputDevice->usUsagePage = 1;
    MouseRawInputDevice->usUsage = 2;
    MouseRawInputDevice->dwFlags = RIDEV_REMOVE;
    MouseRawInputDevice->hwndTarget = NULL;

    BOOL SuccessfullyUnregisteredInput = RegisterRawInputDevices(RawInputDevices, RawInputDeviceCount, sizeof(RAWINPUTDEVICE));

    return Message.wParam;
} 
```

我想不出更简单的方法来试验原始输入 API。想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-11-12T00:53:54.917

很晚的答案，但`GetRawInputBuffer`似乎用于在消息处理循环之外进行轮询。`GetRawInputData`在`WM_INPUT`处理内使用或在`GetRawInputBuffer`消息处理循环外使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T16:38:10.553

我猜使用 GetRawInputBuffer() 你只能读取 HID 数据。这意味着只有 RAWINPUT 结构的数据部分中的 hid 结构被输入数据填充。我能够使用 RAWHID 的 bRawData 成员从我的键盘读取输入，但我认为那没用，因为这些值因键盘而异。所以我切换回 GetRawInputData....

# objective-c - 保存 ABAddressBook 时出现奇怪的 SyncServices / iSync 控制台消息

> ID：10866228
> 
> 赞同：1
> 
> 时间：2012-06-02T21:52:45.190
> 
> 标签：objective-c, xcode4.2, abaddressbook, abperson

我正在使用 ABPersonView 显示和编辑 ABPerson。我这样做是这样的：

```
ABPerson *person = (ABPerson *)[_addressBook recordForUniqueId:[curDict valueForKey:@"id"]];
[_personView setPerson:person];
[_personView setEditing:YES]; 
```

其中 _personView 是我的 ABPersonView。当我使用 ABPersonView 编辑 ABPerson 并保存地址簿时：

```
[ABAddressBook addressBook] save]; 
```

它确实保存并且在 AddressBook 应用程序中我可以看到它的值已更改，但我在 Xcode 和控制台中收到以下错误消息：

我首先得到这个：

```
sandboxd: ([3082]) AddressBookSync(3082) deny file-read-data /Users/xcodeuser/Library/Developer/Xcode/DerivedData/CompanyName-asdxadsafadfqmwqxaagdsfgafguge/Build/Products/Debug 
```

紧随其后的是很多这样的：

```
sandboxd: ([3035]) AddressBookSync(3035) deny mach-lookup com.apple.syncservices.SyncServer 
```

并以此结束：

```
AddressBookSync[3035:707] [0x10011ba50] |ISyncManager|Warning| SyncServer is unavailable: timed out trying to connect
AddressBookSync[3035:707] AddressBookSync (client id: com.apple.AddressBook) error: Exception running AddressBookSync: Timed out waiting for the sync server
AddressBookSync exited with 2 
```

我的应用程序是沙盒的，并且我集成了 iCloud。

我已经搜索但找不到任何有同样问题的人，我试过这个：

*   使用`[[ABAddressBook] sharedAddressBook]`而不是，`[[ABAddressBook] addressBook]`但随后我从 ABPersonView 收到一个错误，说 ABPersonView 不推荐使用 sharedAddressBook。

*   我添加了 SyncServices 框架，没有帮助

该代码确实有效，至少在我的 iCloud 帐户中是这样。有人知道为什么我会收到这些错误吗？值得尝试使用 Xcode 4.3 和 10.8 吗？我目前正在使用 Lion 运行 4.2.1。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T03:07:24.673

我已经看到了完全相同的问题。我相信您在 Apple 框架中看到了一个错误。

# serialization - 是否可以在包含对 C 函数的引用的 lua 字节码字符串上调用 loadstring？

> ID：10866232
> 
> 赞同：7
> 
> 时间：2012-06-02T21:53:04.340
> 
> 标签：serialization, lua, binary-data, love2d

我们正在使用向 Lua 公开图形 API 的 Love2d Lua 游戏引擎。我们正在尝试序列化一个包含游戏世界所有保存游戏数据的巨型哈希表。这个散列包括一些函数，其中一些函数调用 Love2d C 函数。

为了序列化散列中的函数，我们使用 string.dump，并使用 loadstring 将它们重新加载。这适用于纯 Lua 函数，但是当我们尝试序列化然后加载回调用包装 C 函数的函数（例如 Love2d api 中的函数）时，loadstring 返回 nil。

考虑以下通过 Love2d 的图形引擎在屏幕上绘制“hello, world”的简单程序：

```
function love.load()
    draw = function()
        love.graphics.print('hello, world', 10, 10)
    end
end
function love.draw()
    draw()
end 
```

我们希望能够做到这一点：

```
function love.load()
    draw_before_serialize = function()
        love.graphics.print('hello, world', 10, 10)
    end

    out = io.open("serialized.lua", "wb")
    out:write('draw = load([[' .. string.dump(draw_before_serialize) .. ']])')
    out:close()

    require "serialized"
end
function love.draw()
    draw()
end 
```

这样做会写入磁盘上的 Lua 文件，该文件包含未编译的 Lua 和 Lua 字节码的混合，如下所示：

```
draw = load([[^[LJ^A^@      
       @main.lua2^@^@^B^@^B^@^D^E^B^B4^@^@^@%^A^A^@>^@^B^AG^@^A^@^Qhello, world 
       print^A^A^A^B^@^@]]) 
```

此方法适用于不调用 C 模块的 Lua 函数。我们认为这是问题所在，因为此示例确实有效：

```
function love.load()
    draw_before_serialize = function()
        print('hello, world')
    end

    out = io.open("serialized.lua", "wb")
    out:write('draw = load([[' .. string.dump(draw_before_serialize) .. ']])')
    out:close()

    require "serialized"
end
function love.draw()
    draw()
end 
```

它不调用 Love2d 图形方法，而是打印到控制台。

经过更多的测试，我们困惑地发现这个例子确实有效：

```
function love.load()
    draw_before_serialize = function()
        love.graphics.print('hello, world', 10, 10)
    end

    draw = load(string.dump(draw_before_serialize))
end
function love.draw()
    draw()
end 
```

在这里，我们实际上并没有将函数写到磁盘上，而是直接转储它，然后立即将其加载回来。`"wb"`我们认为罪魁祸首可能是没有设置二进制写入模式标志（

有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-08T22:24:31.487

我认为问题在于字符串的格式。Nicol Bolas 对围绕字节码转储的 [[]] 引号可能是正确的，但这指出了一个更大的问题；字节码实际上可以是任何东西，但您将其视为可以写入和读取文本文件的普通字符串。您的上一个演示演示了此问题，您在其中加载转储的字符串而无需将其写入文件。

[我认为，包含函数的表的序列化程序的这种](http://lua-users.org/lists/lua-l/2009-11/msg00533.html)实现可以满足您的需求，但我也认为它已损坏（好吧，无论如何我都无法使其正常工作……）。无论如何，它在正确的轨道上。您需要格式化字节码，*然后*将其写入文件。

我敢肯定有更好的方法来做到这一点，但这有效：

```
1\.    binary = string.dump(some_function)
2\.    formatted_binary = ""
3\.    for i = 1, string.len(binary) do
4\.        dec, _ = ("\\%3d"):format(binary:sub(i, i):byte()):gsub(' ', '0')
5\.        formatted_binary = formatted_binary .. dec
6\.    end 
```

这将遍历字节码中的每个字符，将它们格式化为转义字节（每个都是包含类似“\097”的代码的字符串，在插值时会转义为“a”）。

这个示例的第 4 行有点密集，所以我将其分解。第一的，

```
binary:sub(i, i) 
```

从字符串中拉出第 i 个字符。然后

```
binary:sub(i, i):byte() 
```

返回第 i 个字符的 ascii 整数表示。然后我们格式化它

```
("\\%3d"):format(binary:sub(i, i):byte()) 
```

这给了我们一个像“\ 97”这样的字符串，例如，如果字符是“a”。但这不会正确转义，因为我们需要“\097”，所以我们用“0”替换“”。gsub 返回结果字符串和执行的替换次数，所以我们只取第一个返回值并将其放入“dec”中。我不确定为什么默认情况下“%3d”格式不会用“0”替换空格......哦，好吧。

然后为了执行格式化的二进制字符串，我们需要对其进行转义并将结果传递给“load”。Lua 中的怪异 [[]] 引号不会像 "" 那样进行转义......事实上，我不确定他们是否会进行任何转义。因此，为了创建一个可执行的 Lua 字符串，该字符串将返回一个函数，该函数将执行“some_function”中的任何操作，我们这样做：

```
executable_string = 'load("' .. formatted_binary .. '")' 
```

好的 - 把所有这些放在一起，我认为我们可以让你的测试用例像这样工作：

```
 1 function love.load()
  2     draw_before_serialize = function()
  3         love.graphics.print('hello, world', 10, 10)
  4     end
  5 
  6     binary = string.dump(draw_before_serialize)
  7     formatted_binary = ""
  8     for i = 1, string.len(binary) do
  9         dec, _ = ("\\%3d"):format(binary:sub(i, i):byte()):gsub(' ', '0')
 10         formatted_binary = formatted_binary .. dec
 11     end
 12     
 13     out = io.open("serialized.lua", "wb")
 14     out:write('draw = load("' .. formatted_binary .. '")')
 15     out:close()
 16     
 17     require "serialized"
 18 end 
 19 function love.draw()
 20     draw()
 21 end 
```

当我用 Love 运行它时，我得到一个 OpenGL 屏幕，角落里印有“hello world”。生成的文件“serialized.lua”包含以下内容：

```
draw = load("\027\076\074\001\000\009\064\109\097\105\110\046\108\117\097\084\000\000\004\000\004\000\008\009\002\002\052\000\000\000\055\000\001\000\055\000\002\000\037\001\003\000\039\002\010\000\039\003\010\000\062\000\004\001\071\000\001\000\017\104\101\108\108\111\044\032\119\111\114\108\100\010\112\114\105\110\116\013\103\114\097\112\104\105\099\115\009\108\111\118\101\001\001\001\001\001\001\001\002\000\000") 
```

# mysql - mysql多列查找

> ID：10866236
> 
> 赞同：1
> 
> 时间：2012-06-02T21:53:47.380
> 
> 标签：mysql

试图从这里的几个表中构建一个查询，并在最终确定它时遇到困难：

表 1（电路）

```
t1.circuit_id
t1.circuit_name 
```

（样本数据）

```
1234, test1
1235, test2
1236, test3 
```

表 2（账户）

```
t2.account_id
t2.account_username 
```

（样本数据）

```
100, user1
101, user2
102, user3 
```

表 3（作业）

```
t3.circuit_id
t3.assignment1 (references table 2 (account_id))
t3.assignment2 (references table 2 (account_id))
t3.assignment3 (references table 2 (account_id)) 
```

（样本数据）

```
1234, 100, 101, 102
1235, 101, 101, 101
1236, 102, 102, 102 
```

我所追求的结果如下：

```
t1.circuit_id, t3.assignment1, t2.account_username, t3.assignment2, t2.account_username, t3.assignment3, t2.account_username.

1234, 100, user01, 101, user02, 102, user03
1235, 101, user02, 101, user02, 101, user02
1236, 102, user03, 102, user03, 102, user03 
```

非常感谢，--a

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-02T21:57:23.977

```
SELECT  t3.circuit_id, t3.assignment1, t21.account_username, t3.assignment2, t22.account_username, t3.assignment3, t23.account_username
FROM    t3
LEFT JOIN
        t2 t21
ON      t21.account_id = t3.assigment1
LEFT JOIN
        t2 t22
ON      t22.account_id = t3.assigment2
LEFT JOIN 
        t2 t23
ON      t23.account_id = t3.assigment3 
```

# pdf - CP1252 中标准 PDF 字体的 Adob e Font Metrics

> ID：10866240
> 
> 赞同：2
> 
> 时间：2012-06-02T21:55:23.893
> 
> 标签：pdf, fonts, iso-8859-1, cp1252

我需要 14 种标准 PDF 字体的指标。

我从 Adob​​e 下载了以下内容，但它似乎使用 ISO-8859-1 编码，而不是 CP1252： [https ://partners.adobe.com/public/developer/en/pdf/Core14_AFMs.zip](https://partners.adobe.com/public/developer/en/pdf/Core14_AFMs.zip)

所以它缺少代码点 127 到 142（例如，省略号字符）。

我在哪里可以下载这些 Type1 字体的 CP1252 版本？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-03T00:43:10.467

“Core 14”PDF 字体不知道“CP1252”编码（也不知道“ISO-8859-1”）。

他们使用自己的编码和编码名称，称为：*StandardEncoding*、*MacRomanEncoding*、*WinAnsiEncoding*和*PDFDocEncoding*（其中*WinAnsiEncoding*主要映射到 CP1252）。

您链接到的字体度量文件都用于*扩展罗马*字符集（除了两个符号字体*Symbol*和*ZapfDingbats*，它们使用“特殊”字符集）和*Adob​​eStandardEncoding*编码方案（同样除了前面提到的两种字体，它们使用每个字体特定方案）。

省略号字符的度量***不是 MISSING***，但它包含在这 14 个***AFM***文件中的 12 个中（同样，这两个符号字体不包含此字形，因此也不列出其度量）。

要了解有关 14 种核心 PDF 字体使用的编码和字符集的更多信息，请参阅[**PDF-1.7 规范**](http://wwwimages.adobe.com/www.adobe.com/content/dam/Adobe/en/devnet/pdf/pdfs/PDF32000_2008.pdf)的*附件 D（规范性）*，标题为*“字符集和编码”*。[](http://wwwimages.adobe.com/www.adobe.com/content/dam/Adobe/en/devnet/pdf/pdfs/PDF32000_2008.pdf)

# android - mac和windows关于android SDK的区别是什么

> ID：10866241
> 
> 赞同：6
> 
> 时间：2012-06-02T21:55:26.367
> 
> 标签：android, windows, macos, sdk

如问题所述。我打算将 android SDK 库从我的 microsoft windows pc 复制到我的新 Mac PC。我应该下载mac版本的sdk还是将目录从windows复制到mac就足够了？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-02T22:06:40.003

SDK（Java 部分）是相同的，但 NDK（也可以称为 SDK 的一部分）包含预构建的 Windows/Linux/Mac 版本的 GCC 编译器，用于生成 ARM/MIPS/x86 Android 可执行文件。

要在 Mac 上编译本机本机代码，您需要不同的预构建 GCC 工具链（包含在 NDK 中）。那部分当然不能从 Windows 复制。

要构建 Java，只需确保您的 Mac 不是太旧（如 PowerPC）并支持 Android SDK 和官方 JDK 来运行 Ant 构建脚本。

直接复制可能有一个问题：CLASSPATH 变量将指向您的旧 Windows 路径，而不是 Mac 路径。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-02T21:58:14.773

没有太大区别，但您需要重新下载 SDK。这是因为并非所有内容都是 Java，其中一些是本机代码，无法在来自 Windows 的 Mac 上运行。但在功能上，它是相同的。

# java - 如何将视频文件加载到发送到 youtube 的请求中？

> ID：10866243
> 
> 赞同：0
> 
> 时间：2012-06-02T21:56:10.163
> 
> 标签：java, android, youtube-api

我正在尝试将视频文件从设备上传到 YouTube api。我有授权部分工作，但他们的[文档](https://developers.google.com/youtube/2.0/developers_guide_protocol#Sending_a_Browser_Upload_API_Request)让我将视频数据直接嵌入到 XML 有效负载中（在多部分请求实体代码之间），我并不完全清楚读取文件的正确方法是什么，对其进行编码，并将其打印回请求。我的假设是我需要将它加载到一个 byte[] 中，然后在对其进行编码时将其吐回字符串，但我宁愿有一些权威的指导，也不愿在黑暗中玩试错游戏。

TIA

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-03T14:09:50.320

我想你想这样做

```
InputStreamBody metadata = new InputStreamBody(xmlMetadata, "application/atom+xml; charset=UTF-8");
FileBody content = new FileBody(new File("video.mp4"), "application/octet-stream");
MultipartEntity reqEntity = new MultipartEntity();
reqEntity.addPart("metadata", metadata);
reqEntity.addPart("content", content);
post.setEntity(reqEntity);
client.execute(post); 
```

# android - 在 ListView 中显示列表中的变量

> ID：10866246
> 
> 赞同：0
> 
> 时间：2012-06-02T21:57:39.587
> 
> 标签：android, list, listview, arraylist

我有一个位置列表

```
ArrayList<Location> locationList; 
```

每个位置都包含名称、地址、描述等信息……我只想在每一行中显示名称，以便您可以选择要在新意图中接收更多信息的位置。

我设法使用以下代码在 ListView 中显示字符串：

```
 locationNames= new String[]{"I","am", "a", "ListView"};

    setListAdapter(new ArrayAdapter<String>(this, R.layout.singleitem,
            locationNames));
    ListView locationListview;
    locationListview = getListView();
    locationListview.setTextFilterEnabled(true); 
```

到目前为止，这有效，但我无法在此 listView 中显示列表的内容，也无法询问有关单击行的更多信息。

我考虑读取列表的第一个元素以将它们保存在字符串数组中。当您想要单击它们以获取更多信息时，这将导致问题。

做这个的最好方式是什么？

真诚的，沃尔芬

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-02T22:28:08.887

我不确定这是你要求的。

将位置的名称放在字符串数组中，如下所示：

```
String names[] = new String[locationList.size()];

int i=0;
for( Location loc:locationList )
{
    names[i] = loc.name;
    i++;
} 
```

然后在你的适配器中使用这个数组`names`而不是：`locationNames`

```
setListAdapter(new ArrayAdapter<String>(this, R.layout.singleitem, names)); 
```

最后为您的列表设置一个侦听器以获取项目单击事件：

```
 locationListview.setOnItemClickListener( new OnItemClickListener() {

        @Override
        public void onItemClick(AdapterView<?> parent, View view, int position, long id) 
        {
            // Read your location information using the position parameter
            Location l = locationList.get( position );

            // Show the rest of the location info ...

        }               
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-03T00:01:27.417

像这样的东西：

```
Location[] locationArray = new Location[locationList.size()];
locationList.toArray(locationArray); 
setListAdapter(new ArrayAdapter<Location>(this, R.layout.singleitem,
locationArray)); 
```

并覆盖 Location 的**toString()**方法以返回位置的名称。如果您没有自己创建 Location 类，则需要创建一个子类来覆盖 toString() 方法。

# java - JProfiler 无法启动

> ID：10866247
> 
> 赞同：0
> 
> 时间：2012-06-02T21:57:40.850
> 
> 标签：java, port, jprofiler, weblogic8.x

我将 JProfiler 7 配置为与本地运行的 Weblogic 8.1 集成。

使用 JProfiler 生成的脚本（名为 startWebLogic_jprofiler.cmd）似乎 weblogic 启动得很好

```
CLASSPATH=C:\bea;C:\J2SDK1~1.2_1\lib\tools.jar;C:\bea\WEBLOG~1\server\lib\weblogic_sp.jar;C:\bea\WEBLOG~1\server\lib\weblogic.jar;C:\bea\user_projects\domains\mydomain\lib\sqljdbc-1.2.jar;;C:\bea\WEBLOG~1\common\eval\pointbase\lib\pbserver44.jar;C:\bea\WEBLOG~1\common\eval\pointbase\lib\pbclient44.jar;C:\J2SDK1~1.2_1\jre\lib\rt.jar;C:\bea\WEBLOG~1\server\lib\webservices.jar;;C:\bea\user_projects\domains\mydomain\lib\wlstartup.jar;C:\bea\user_projects\domains\mydomain\lib\SpectrumRealmUtils.jar
.
PATH=C:\bea\WEBLOG~1\server\bin;C:\J2SDK1~1.2_1\jre\bin;C:\J2SDK1~1.2_1\bin;C:\Program Files\jprofiler7\bin\..\lib;C:\Program Files\jprofiler7\bin\windows;C:\Program Files\YourKit Java Profiler 7.5.11\bin\win32;C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;C:\Windows\System32\WindowsPowerShell\v1.0\;c:\Program Files\Microsoft SQL Server\100\Tools\Binn\;c:\Program Files\Microsoft SQL Server\100\DTS\Binn\;c:\Program Files\Microsoft SQL Server\100\Tools\Binn\VSShell\Common7\IDE\;c:\tptp\bin;;c:\program files\jprofiler7\jre\bin;C:\bea\WEBLOG~1\server\bin\oci920_8
.
***************************************************
*  To start WebLogic Server, use a username and   *
*  password assigned to an admin-level user.  For *
*  server administration, use the WebLogic Server *
*  console at http:\\[hostname]:[port]\console    *
***************************************************
JProfiler> Protocol version 35
JProfiler> Using JVMPI
JProfiler> 32-bit library
JProfiler> Listening on port: 8849.
JProfiler> Native library initialized
JProfiler> If output stops here, please remove -Xdebug from the command line
java.lang.ClassFormatError: Incompatible magic value in .class file
    at java.lang.ref.Reference$ReferenceHandler.run(Reference.java:122)
<Jun 2, 2012 2:45:45 PM PDT> <Info> <WebLogicServer> <BEA-000377> <Starting WebLogic Server with Java HotSpot(TM) Client VM Version 1.4.2_19-b04 from Sun Microsystems Inc.> 
<Jun 2, 2012 2:45:45 PM PDT> <Info> <Configuration Management> <BEA-150016> <This server is being started as the administration server.> 
<Jun 2, 2012 2:45:45 PM PDT> <Info> <Management> <BEA-141107> <Version: WebLogic Server 8.1 SP6  Wed Jun 21 08:18:55 PDT 2006 781680 
WebLogic XMLX Module 8.1 SP6  Wed Jun 21 08:18:55 PDT 2006 781680 > 
<Jun 2, 2012 2:45:45 PM PDT> <Notice> <Management> <BEA-140005> <Loading domain configuration from configuration repository at C:\bea\user_projects\domains\mydomain\.\config.xml.> 
<Jun 2, 2012 2:45:46 PM PDT> <Notice> <Log Management> <BEA-170019> <The server log file C:\bea\user_projects\domains\mydomain\myserver\myserver.log is opened. All server side log events will be written to this file.> 
SpectrumAuthenticationProviderImpl.initialize
SpectrumAuthenticationProviderImpl.initialize-after mbean 
```

然而，jprofiler 部分会出错并显示以下消息（分析永远不会发生）：

```
Could not connect to 127.0.0.1:8849.Please make sure that the remote address is correct, the remote program is started properly and the netword route allows socket connections. 
```

我为 PATH 添加了以下内容：

> 路径 = C:\Program Files\jprofiler7\bin\windows；

并修改了我的 startWeblogic.cmd（JProfiler 7 从中衍生出自己的脚本）

> 设置 JAVA_VM=-agentpath:C:\Program Files\jprofiler7\bin\windows\jprofilerti.dll=port=8849,nowait,id=117,config=C:\Users\resmed.jprofiler7\config.xml

我进入 Windows 7 防火墙并添加了一个打开端口 8849 的新规则——但这并没有帮助。

令人恼火的是，我可以使用 JProfiler 生成的脚本调出 weblogic 的管理控制台（127.0.0.1:7001/console）——但我无法让 JProfiler 实际探测！？！？！

有什么建议么 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T11:27:30.933

您使用的是 1.4 JVM，因此 VM 参数

```
-agentpath:C:\Program Files\jprofiler7\bin\windows\jprofilerti.dll=port=8849,nowait,id=117,config=C:\Users\resmed.jprofiler7\config.xml 
```

行不通，因为那适用于 Java 1.5+ 和新的分析接口 JVMTI。

尝试

```
-Xrunjprofiler:port=8849,nowait,id=117,config=C:\Users\resmed.jprofiler7\config.xml 
```

你必须添加

```
C:\Program Files\jprofiler7\bin\windows 
```

到`PATH`Java 1.4 的环境变量。

# objective-c - 使用 NSSavePanel 后应用程序未关闭

> ID：10866248
> 
> 赞同：2
> 
> 时间：2012-06-02T21:57:43.400
> 
> 标签：objective-c, nssavepanel

使用 NSSavePanel 后，我在关闭我的应用程序时遇到问题...如果我打开应用程序，使用它然后关闭它，它会以正确的方式关闭...我在 appdelegate 中有这段代码可以让我的应用关闭

```
- (BOOL)applicationShouldTerminateAfterLastWindowClosed:(NSApplication *)sender
 {
   return YES;
 } 
```

但是如果我只是打开面板来保存一个 txt 文件......使用 NSSavePanel......如果我只是打开它而不使用它......点击“取消”按钮，我的应用程序不再关闭...如果我单击红色 x 关闭应用程序，窗口会消失，但应用程序仍处于活动状态，并且无法恢复主窗口。我用来保存我的 txt 文件的代码是这样的：

```
NSSavePanel *save = [NSSavePanel savePanel];

if (nomePartita != nil) 
{
    [save setNameFieldStringValue:nomePartita];
}

[save setAllowedFileTypes:[NSArray arrayWithObject:@"dat"]];
[save setAllowsOtherFileTypes:NO];

NSInteger result = [save runModal];    

if (result == NSOKButton)
{
 // code to save the file here.....
 } 
```

问题必须在这一行中，因为仅此（我的意思是没有用于创建和保存 txt 文件的其余代码）我遇到了这个问题...任何人都知道为什么会发生这种情况？任何提示将不胜感激！非常感谢，和平，马西

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T15:18:46.793

尝试这个：

```
 NSSavePanel*    panel = [NSSavePanel savePanel];
   [panel setNameFieldStringValue:newName];
   [panel beginSheetModalForWindow:[self window] completionHandler:^(NSInteger result){
        if (result == NSFileHandlingPanelOKButton)
        {
            NSURL*  theFile = [panel URL];
            // Write the contents in the new format.
        }
}]; 
```

我遇到了同样的问题，这解决了它。对于窗口，您也可以使用 [NSApp keyWindow]

[Apple 沙盒指南](http://developer.apple.com/library/ios/documentation/FileManagement/Conceptual/FileSystemProgrammingGUide/FileSystemProgrammingGuide.pdf)。

# azure - Windows Azure 中的并行编程

> ID：10866249
> 
> 赞同：0
> 
> 时间：2012-06-02T21:57:51.957
> 
> 标签：azure, parallel-processing

我制作了 wcf 服务，我在 azure 中以 Web 角色托管。角色的实例特别大（它只是一个实例），它有 8 个核心。我在服务中有两个方法。方法是计算矩阵乘法，一种是顺序编程，另一种是并行（使用Parallel.For），结果是顺序编程比并行快。难道我做错了什么？我正在监视处理器工作，当我开始并行计算时，所有内核都被使用，但结果并不好......这是并行编程矩阵乘法的代码

```
ParallelOptions p = new ParallelOptions();
            p.MaxDegreeOfParallelism=8; 
 Parallel.For(0, n,p, i =>
                {
                    for (int j = 0; j < n; j++)
                    {

                        suma = 0;

                        for (int k = 0; k < n; k++)
                        {

                            suma = (matricaA[i, k] * matricaB[k, j]);

                        }
                        proizvod[i, j] = suma;

                    }
                } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-04T02:42:24.980

我不知道问题的确切原因。但我的建议是：使用远程桌面登录云机。创建一个并行执行矩阵计算的控制台应用程序。然后在云机器上运行控制台应用程序。使用资源监视器检查 CPU 使用率。如果 CPU 使用率经常接近 100%，那么您可以确信代码逻辑是正确的。

由于您使用的是 WCF，请注意默认情况下 WCF 可以同时使用多个线程处理多个请求。因此，您的服务器可能同时计算多个矩阵，而不是使用多个线程计算单个矩阵。通常计算繁重的工作是在没有 WCF 的工作角色上完成的，它们是在其中一个一个地执行的。

# spring - Spring 3.1 + Hibernate 4.1 JPA，Entity manager factory注册两次

> ID：10866263
> 
> 赞同：10
> 
> 时间：2012-06-02T22:00:46.230
> 
> 标签：spring, hibernate, jpa, hibernate-entitymanager

我使用 Spring Framework 3.1 和 Hibernate 4.1 作为 JPA 提供程序，并且我有一个功能齐全的设置，但是每次启动 Web 应用程序时，我都会看到以下警告消息：

```
14:28:12,725  WARN pool-2-thread-12 internal.EntityManagerFactoryRegistry:80 - HHH000436: Entity manager factory name (something) is already registered.  If entity manager will be clustered or passivated, specify a unique value for property 'hibernate.ejb.entitymanager_factory_name' 
```

应用程序运行良好，但像这样的警告消息让我很困扰，数小时的搜索、调整和试验让我无处可去。我尝试更改工厂名称并添加和省略配置块，但均无济于事。似乎 Spring 或 Hibernate 中的某些东西只是将实体管理器工厂初始化了两次。

仅供参考，我正在使用 LocalContainerEntityManagerFactoryBean 的 packagesToScan 功能来配置没有 persistence.xml 文件的实体管理器。

我已将我的 spring 上下文 XML 缩减为以下内容，但问题仍然存在：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:context="http://www.springframework.org/schema/context"
       xsi:schemaLocation="
           http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd
           http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">

  <context:property-placeholder location="classpath:jdbc.properties"/>
  <bean id="dataSource" class="org.apache.tomcat.jdbc.pool.DataSource" destroy-method="close">
    <property name="driverClassName" value="${jdbc.nightsword.driverClassName}"/>
    <property name="url" value="${jdbc.nightsword.url}"/>
    <property name="username" value="${jdbc.nightsword.username}"/>
    <property name="password" value="${jdbc.nightsword.password}"/>
  </bean>

  <bean id="entityManagerFactory" class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
    <property name="jpaVendorAdapter">
      <bean class="org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter"/>
    </property>
    <property name="dataSource" ref="dataSource"/>
    <property name="packagesToScan" value="x.y"/>
  </bean>
</beans> 
```

为了完整起见，这里是 hibernate.properties：

```
hibernate.dialect=org.hibernate.dialect.MySQL5Dialect
hibernate.ejb.entitymanager_factory_name=something 
```

这里是 org.springframework.orm 和 org.hibernate 的调试级日志输出的摘录。您可以在 14:40:06,911 看到 EntityManagerFactory 是如何从第一次注册的，随后 LocalContainerEntityManagerFactoryBean 似乎从头开始重新开始。嗯。

```
INFO: Deploying web application archive /opt/local/share/java/tomcat7/webapps/nightsword.war
14:40:06,149  INFO pool-2-thread-13 jpa.LocalContainerEntityManagerFactoryBean:264 - Building JPA container EntityManagerFactory for persistence unit 'default'
14:40:06,219 DEBUG pool-2-thread-13 type.BasicTypeRegistry:143 - Adding type registration boolean -> org.hibernate.type.BooleanType@4cb91eff

...

14:40:06,882 DEBUG pool-2-thread-13 internal.SessionFactoryRegistry:62 - Initializing SessionFactoryRegistry : org.hibernate.internal.SessionFactoryRegistry@161bb7fe
14:40:06,882 DEBUG pool-2-thread-13 internal.SessionFactoryRegistry:75 - Registering SessionFactory: a3219dd8-7d59-45ac-9a5a-0d13e38dbb04 (<unnamed>)
14:40:06,882 DEBUG pool-2-thread-13 internal.SessionFactoryRegistry:82 - Not binding SessionFactory to JNDI, no JNDI name configured
14:40:06,882 DEBUG pool-2-thread-13 internal.SessionFactoryImpl:487 - Instantiated session factory
14:40:06,882 DEBUG pool-2-thread-13 internal.SessionFactoryImpl:1119 - Checking 0 named HQL queries
14:40:06,883 DEBUG pool-2-thread-13 internal.SessionFactoryImpl:1142 - Checking 0 named SQL queries
14:40:06,887 DEBUG pool-2-thread-13 internal.StatisticsInitiator:110 - Statistics initialized [enabled=false]
14:40:06,910 DEBUG pool-2-thread-13 internal.EntityManagerFactoryRegistry:56 - Initializing EntityManagerFactoryRegistry : org.hibernate.ejb.internal.EntityManagerFactoryRegistry@75cc9008
14:40:06,911 DEBUG pool-2-thread-13 internal.EntityManagerFactoryRegistry:66 - Registering EntityManagerFactory: something 
14:40:06,967  INFO pool-2-thread-13 jpa.LocalContainerEntityManagerFactoryBean:264 - Building JPA container EntityManagerFactory for persistence unit 'default'
14:40:06,967 DEBUG pool-2-thread-13 type.BasicTypeRegistry:143 - Adding type registration boolean -> org.hibernate.type.BooleanType@4cb91eff

...

14:40:07,128 DEBUG pool-2-thread-13 internal.SessionFactoryRegistry:75 - Registering SessionFactory: 81a9b5a6-83aa-46ee-be68-d642e6fda584 (<unnamed>)
14:40:07,128 DEBUG pool-2-thread-13 internal.SessionFactoryRegistry:82 - Not binding SessionFactory to JNDI, no JNDI name configured
14:40:07,129 DEBUG pool-2-thread-13 internal.SessionFactoryImpl:487 - Instantiated session factory
14:40:07,129 DEBUG pool-2-thread-13 internal.SessionFactoryImpl:1119 - Checking 0 named HQL queries
14:40:07,129 DEBUG pool-2-thread-13 internal.SessionFactoryImpl:1142 - Checking 0 named SQL queries
14:40:07,129 DEBUG pool-2-thread-13 internal.StatisticsInitiator:110 - Statistics initialized [enabled=false]
14:40:07,130 DEBUG pool-2-thread-13 internal.EntityManagerFactoryRegistry:66 - Registering EntityManagerFactory: something 
14:40:07,130  WARN pool-2-thread-13 internal.EntityManagerFactoryRegistry:80 - HHH000436: Entity manager factory name (something) is already registered.  If entity manager will be clustered or passivated, specify a unique value for property 'hibernate.ejb.entitymanager_factory_name' 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-24T13:40:32.477

我遇到了同样的问题，但在不同的情况下。在从我的 IDE 启动的同一次运行（即同一个 JVM）中执行多个测试时，`EntityManagerFactoryRegistry`会产生相同的警告。`HHH000436`

如果*至少有两个*测试类使用`SpringJUnit4ClassRunner`加载*不同*的Spring 测试应用程序上下文，每个包含一个`EntityManagerFactory`.

根本原因是 Hibernate 维护了一个实例的静态注册表`EntityManagerFactory`，其中第二个实例的创建可能会导致日志消息所涉及的冲突。那么为什么在第一个测试完成执行后第一个实例没有被注销呢？它通常会在包含该`EntityManagerFactory`实例的应用程序上下文被破坏时发生。在测试执行期间它不会发生的原因是 Spring 测试上下文框架缓存了所有加载的上下文，以避免重新加载多个测试可能需要的完全相同的上下文。结果，这些上下文中的 bean 直到最后一个测试完成执行后才会被销毁，并且 Hibernate 将只收集`EntityManagerFactory`曾经创建的所有实例。

这确实不是问题，但如果有人真的对警告消息感到恼火，有几种可能的方法可以避免看到它：

1.  确保`EntityManagerFactory`实例获得不同的名称（它们在注册表中按名称键入）。`EntityManagerFactoryImpl`检查名称的派生方式的构造函数。
2.  `@DirtiesContext`在测试类上使用`SpringJUnit4ClassRunner`可在执行测试类后立即关闭上下文并将其从其上下文缓存中删除。
3.  只需将日志级别设置`EntityManagerFactoryRegistry`为错误...

希望这可以帮助某人。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-06-06T09:28:14.230

你是如何初始化你的 Spring 应用程序上下文的？你在使用 Spring MVC 吗？

我有时会看到导入其他应用程序的 Spring MVC XML 配置。上下文 XML，导致一些 bean 实例化两次，因为它们是在应用程序上下文和 Web 应用程序上下文中声明的。

# python - 是否可以在不编写生成器函数的情况下从链表中进行迭代？

> ID：10866264
> 
> 赞同：2
> 
> 时间：2012-06-02T22:01:17.650
> 
> 标签：python, generator

在我正在编写的 Python 程序中，我使用字典构建了一个链表，该字典将每个节点映射到其后继节点（最后一个节点映射为 None）。

（实际上，字典包含 Wikipedia 告诉我的称为[spaghetti stack](http://en.wikipedia.org/wiki/Spaghetti_stack)的东西，它是一棵树，其中每个节点都链接到其父节点而不是其子节点。这意味着从叶节点到根节点有许多部分重叠的路径.我只关心其中一个路径，从特定的叶节点开始。这对于这个问题并不重要，除了排除任何涉及迭代字典中所有元素的解决方案。）

我需要将此列表作为可迭代对象传递给另一个函数。我知道我可以使用生成器函数（见下面的代码）来做到这一点，但似乎应该有一个内置函数来使我需要的迭代器在一行中（或者可能是一个生成器表达式）。我已经对文档进行了一些搜索，但是 itertools 或 functools 模块中似乎没有任何内容适用，而且我不确定在哪里可以查看。

这是我现在拥有的生成器功能。可以消除外部函数（内联），但内部生成器似乎是使数据可迭代的唯一简单方法：

```
def makeListGenerator(nextDict, start):
    def gen(node):
        while node:
            yield node
            node = nextDict[node]
    return gen(start) 
```

这种生成器似乎应该有一个模式，但我不确定它会被称为什么。这是一个通用版本：

```
def makeGenericGenerator(nextFunc, continueFunc, start):
    def gen(value):
         while continueFunc(value):
             yield value
             value = nextFunc(value)
    return gen(start) 
```

我可以使用这个调用来实现特定版本：

```
makeGenericGenerator(lambda v: nextDict[v], bool, start) 
```

Python标准库中是否已经存在类似的东西？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-02T22:28:07.577

您面临的基本问题是，每次从您的可迭代对象中获取另一个值时，您的可迭代对象都必须*记住*该值，以便它知道如何生成下一个值。换句话说，您的可迭代对象需要维护自己的*状态*。

这意味着，无论您的问题是否有一个好的答案，使用生成器可能是正确的解决方案——因为这正是生成器的用途！生成器的全部意义在于它们在调用它们的`next`方法之间保存它们的状态，而这正是你所需要的。

另一方面，生成器表达式更适合无状态转换。很多人试图将状态硬塞进他们，这通常有点丑陋。实际上，我花了一点时间尝试为您的情况做这件事，但无法让生成器表达式工作。我终于找到了一些这样*的*作品。这使用鲜为人知的`callable_iterator`版本`iter`：

```
>>> d = {1:2, 2:3, 3:4, 4:5, 5:None}
>>> list(iter(lambda st=[1]: st.__setitem__(0, d[st[0]]) or st[0], None))
[2, 3, 4, 5] 
```

我提出这个不是作为答案，而是为了说明为什么这不能很好地工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-02T22:55:30.127

```
nodes = {
    'A':'B',
    'B':'C',
    'C':'D',
    'D':None
}

print (lambda f: lambda g: f(f,g)) (lambda f,x: [x] + f(f, nodes[x]) if x else [])('A')
# ['A', 'B', 'C', 'D'] 
```

# jquery - jQuery / Coffeescript - 如果有条件

> ID：10866265
> 
> 赞同：1
> 
> 时间：2012-06-02T22:01:47.760
> 
> 标签：jquery, coffeescript

使用jQuery和coffeescript，我想在用户按下回车时更新一个html元素。我的代码如下所示：

```
$ ->
  $('p span').live 'keypress', (e) ->      
    if e.keyCode == 13        
      $('div.sidebar-nav ul li a.active').html $(this).attr 'value' 
```

Coffeescript 编译没有任何错误，但代码不工作。出于某种原因，如果我添加更改代码以遵循它的工作原理：

```
$ ->
  $('p span').live 'keypress', (e) ->      
    if e.keyCode == 13
      alert 'some string'
      $('.sidebar-nav a.active').html $(this).attr 'value' 
```

我花了最后几个小时试图解决这个问题，但仍然没有。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-02T22:05:28.770

```
$('.sidebar-nav a.active') 
```

不同于...

```
$('div.sidebar-nav ul li a.active') 
```

在第一种情况下，`a.active`是 的后代`.sidebar-nav`，并且其下的结构`.sidebar-nav`可以是任何东西（列表、文章、跨度、选框，只要它在某处即可）。在第二个中，它是一个曾孙，在一个列表中。我们需要查看您的 HTML 以确定，但它看起来像错误的选择器......

# java - Java KeyEvent 和 KeyListener

> ID：10866266
> 
> 赞同：0
> 
> 时间：2012-06-02T22:01:48.630
> 
> 标签：java, keylistener, keyevent

Java KeyListener 是否普遍意味着它适用于我输入的任何应用程序？

如果没有，我怎样才能让它通用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-02T22:12:22.643

它不是通用的。它仅在您为其注册的组件具有焦点时才有效。您可以使用[键盘挂钩](http://www.codeproject.com/Articles/1264/KeyBoard-Hooks)使其通用，但您必须使用[JNI](http://java.sun.com/developer/onlineTraining/Programming/JDCBook/jni.html)或[JNA](https://github.com/twall/jna#readme)来集成本机代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-02T22:12:39.073

请定义“通用”。你的意思是它可以作为键盘记录器工作吗？答案：没有。为此，您需要编写一个插入操作系统的键盘挂钩，这可以通过 JNI 或 JNA 使用 Java 完成，但 Java 不太适合。

# php - 使用 .htaccess 制作包含各种字符的精美 URL

> ID：10866267
> 
> 赞同：0
> 
> 时间：2012-06-02T22:01:58.093
> 
> 标签：php, .htaccess

我想让一个 URL 看起来赏心悦目。

```
from 
    /index.php?a=grapes
to
    /grapes 
```

虽然，我遇到了一些问题。我想`a`拥有更多种类的角色，例如`a-z A-Z 0-9 / _ - . [ ]`.

```
from
    /index.php?a=Grapes.Are.Green/Red[W4t3r-M3l0n_B1G_Gr4p3]
to
    /Grapes.Are.Green/Red[W4t3r-M3l0n_B1G_Gr4p3] 
```

在 index.php 文件中我有

```
<?php
    $a = $_GET["a"];
    echo $a;
?> 
```

只是为了测试 URL 是否正常工作。

现在我在 .htaccess 中有什么

```
RewriteEngine On
RewriteRule ^([a-zA-Z0-9/_]+)?$ index.php?a=$1 
```

只接受`a-z A-Z 0-9 / _`.

*   如果我添加`-`到方括号中并将其作为`a`等于的字符之一，我会得到 404 错误。
*   如果我添加`.`到方括号中，我会得到`index.php`输出。
*   如果我添加`[`或`]`收到 404 错误。

如果有人有解决方案，我很乐意看到它。另外，如果有人有时间，请您解释一下 RewriteRule 的每个部分，说明该部分的作用。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-02T22:12:29.260

问题是你的某些角色是“特殊的”：

特殊的角色：

```
(full stop) - match any character
* (asterix) - match zero or more of the previous symbol
+ (plus) - match one or more of the previous symbol
? (question) - match zero or one of the previous symbol
\? (backslash-something) - match special characters
^ (caret) - match the start of a string
$ (dollar) - match the end of a string
[set] - match any one of the symbols inside the square braces.
(pattern) - grouping, remember what the pattern matched as a special variable 
```

因此，如果您想在 url 中使用它们，则必须对它们进行转义。

例如 .s?html? 匹配“.htm”、“.shtm”、“.html”或“.shtml”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-02T23:56:22.300

```
RewriteEngine On
RewriteRule ^(.*)$ index.php?a=$1 [QSA] 
```

最后`[QSA]`是什么使它起作用:) 感谢 jedwards 建议使用`^(.*)$`which 接受所有字符。

# c++ - 为什么 std string == 会崩溃？

> ID：10866268
> 
> 赞同：-1
> 
> 时间：2012-06-02T22:02:09.753
> 
> 标签：c++

当我在调试模式下运行我的应用程序时，有时我会在此函数中遇到运行时错误：

```
void ChatListHandler::seatOccupancyChanged( const std::string& userName, bool occupied, bool isSelf, bool isSelfTable, int tableNo, int seatNo, int numPlayersAtTable )
{
    if(!isSelf && (isInGroup(userName,IN_GAME_GROUP) || isInGroup(userName,IN_LOBBY_GROUP)))
    {
        if(occupied)
        {
            movePlayer(userName,IN_GAME_GROUP);
        }
        else
        {
            movePlayer(userName,IN_LOBBY_GROUP);
        }
    }
}

bool ChatListHandler::isInGroup( const std::string& name, GroupTypeEnum group )
{
    for(size_t i = 0; i < m_groups.size(); ++i)
    {
        if(m_groups[i].second == group)
        {
            if(m_groups[i].first->getList())
            {
                for(agui::ListItem::iterator it = 
                    m_groups[i].first->getList()->getItemsBegin(); it !=
                    m_groups[i].first->getList()->getItemsEnd(); ++it)
                {
                    if((*it).first.text == name)
                    {
                        return true;
                    }
                }
            }

            break;
        }
    }

    return false;

    m_list->repositionGroups();
} 
```

它崩溃：

```
if((*it).first.text == name) 
```

我得到：

```
Unhandled exception at 0x5fd1942c (msvcp90d.dll) in my.exe: 0xC0000005: Access violation reading location 0x00000040. 
```

调用堆栈如下所示： ![在此处输入图像描述](../Images/2959beed2862c958b2b5d915f3d90b18.png)

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-02T22:05:16.917

如果不查看所有代码，我无法确定，但我的猜测是这些行与错误有关：

```
for(agui::ListItem::iterator it =
                m_groups[i].first->getList()->getItemsBegin(); it !=
                m_groups[i].first->getList()->getItemsEnd(); ++it) 
```

除非您的调用`getList()`每次总是返回完全相同的列表（即指向同一个列表的指针，而不是副本），否则您可能会在不同的列表上获取迭代器。这意味着检查`it != m_groups[i].first->getList()->getItemsEnd()`将始终为`false`，因为迭代器来自不同的列表。在这种情况下，您的迭代器可能会离开列表的末尾，因此取消引用会导致崩溃。

希望这可以帮助！

# java - 创建新的 Bufferstrategy 时出现非法状态异常

> ID：10866269
> 
> 赞同：8
> 
> 时间：2012-06-02T22:02:16.150
> 
> 标签：java, buffer, illegalstateexception

当我试图弄清楚如何使用缓冲策略时，总体上只是改进我编写代码和清理东西的方式。当我运行以下代码时，当我“createBufferStrategy(3)”时出现错误

```
 package Game1Test;

import java.awt.Canvas;
import java.awt.Color;
import java.awt.Graphics;
import java.awt.image.BufferStrategy;
import java.io.IOException;

import javax.swing.*;

public class Base extends Canvas implements Runnable{

    private static final long serialVersionUID = 1L;
    private boolean running = false;
    int ticks = 0;

    public Base(JFrame f) {
        setSize(f.getWidth(),f.getHeight());
        start();
    }

    public void start(){
        running = true;
        new Thread(this).start();
    }
    public void stop(){

    }
    public void run(){
        while(running){
            ticks++;
            System.out.println(ticks);
            render();

                try {
                    Thread.sleep(2);
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
        }
    }
    public void render(){
        BufferStrategy bs = getBufferStrategy();
        Graphics g;
        if(bs == null){
            createBufferStrategy(3);
            requestFocus();
            return;
        }
        bs.show();
    }

} 
```

然后添加基础：

```
package Game1Test;

import java.awt.*;

import javax.swing.JFrame;

public class Screen extends JFrame{

    public final int GAME_WIDTH = 400;
    public final int GAME_HEIGHT = 400;
    public Dimension gameDim = new Dimension(GAME_WIDTH,GAME_HEIGHT);
    final String gameName = "Test";

    public Screen(){
        setSize(gameDim);
        setTitle(gameName);
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        setResizable(false);
        setLayout(new GridLayout());
        setVisible(true);
        setLocationRelativeTo(null);
    }
    public static void main(String[] args){
        Screen s = new Screen();
        s.add(new Base(s));
    }
} 
```

我收到以下错误：

```
Exception in thread "Thread-2" java.lang.IllegalStateException: Component must have a valid peer
    at java.awt.Component$FlipBufferStrategy.createBuffers(Unknown Source)
    at java.awt.Component$FlipBufferStrategy.<init>(Unknown Source)
    at java.awt.Component$FlipSubRegionBufferStrategy.<init>(Unknown Source)
    at java.awt.Component.createBufferStrategy(Unknown Source)
    at java.awt.Canvas.createBufferStrategy(Unknown Source)
    at java.awt.Component.createBufferStrategy(Unknown Source)
    at java.awt.Canvas.createBufferStrategy(Unknown Source)
    at Game1Test.Base.render(Base.java:46)
    at Game1Test.Base.run(Base.java:33)
    at java.lang.Thread.run(Unknown Source) 
```

有人可以告诉我为什么会这样吗？也许可以解决这个问题？

谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-02T22:22:57.053

查看[API](http://docs.oracle.com/javase/7/docs/api/java/awt/Canvas.html#createBufferStrategy%28int%29)，如果组件不可显示，则会引发此异常。在这种情况下，那是什么`Canvas.peer`时候`null`。看看这个`peer`领域就会发现

> 当`Component`添加到同样是对等点的容器时设置对等点

由于您是从组件的构造函数启动更新线程，`render`因此可以在将组件添加到另一个容器之前调用它，这意味着`peer`is `null`，然后`IllegalStateException`会抛出 an 。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-14T00:47:17.033

根据我对这个错误的经验以及您编写的代码，您缺少一个框架函数。

添加框架所在的位置（例如：）`frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);`并添加功能`frame.add(game);`

在这个例子中，我的是，`Display game = new Display();`但取决于新显示器的变量是什么，它可能会有所不同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-02-02T16:37:14.327

我有完全相同的异常，但我发现这是因为我的 JFrame 可见性被意外设置为 false。

所以放入 setVisible(true); 修复。

# c# - 如何表示具有相同行为的不同实体？

> ID：10866271
> 
> 赞同：7
> 
> 时间：2012-06-02T22:02:19.280
> 
> 标签：c#

我的域模型中有几个不同的实体（比如说动物物种），每个实体都有一些属性。实体是只读的（它们在应用程序生命周期内不会更改状态）并且它们具有相同的行为（仅在属性值上有所不同）。

**如何在代码中实现这些实体？**

## 不成功的尝试：

### 枚举

我尝试了这样的枚举：

```
enum Animals {
    Frog,
    Duck,
    Otter,
    Fish  
} 
```

其他代码将打开枚举。然而，这会导致难看的切换代码，分散逻辑和[组合框的问题](https://stackoverflow.com/questions/58743/databinding-an-enum-property-to-a-combobox-in-wpf)。没有漂亮的方法可以列出所有可能的动物。序列化虽然效果很好。

## 子类

我还考虑了每种动物类型在哪里是公共基础抽象类的子类。**但是，所有 Animals**的 Swim() 的实现都是相同的，所以它没有什么意义，而且可序列化现在是一个大问题。因为我们代表一种动物*类型*（物种，如果你愿意的话），每个应用程序应该有一个子类的实例，当我们使用序列化时，维护起来既困难又奇怪。

```
public abstract class AnimalBase {
    string Name { get; set; } // user-readable
    double Weight { get; set; }
    Habitat Habitat { get; set; }
    public void Swim(); { /* swim implementation; the same for all animals but depends                  uses the value of Weight */ }
}

public class Otter: AnimalBase{
    public Otter() {
        Name = "Otter";
        Weight = 10;
        Habitat = "North America";
    }
}

// ... and so on 
```

简直太可怕了。

## 静态字段

[这篇博](http://kijanawoodard.com/why-enums-suck/)文为我提供了一个解决方案的想法，其中每个选项都是类型内的静态定义字段，如下所示：

```
public class Animal {
   public static readonly Animal Otter = 
       new Animal 
       { Name="Otter", Weight = 10, Habitat = "North America"}
   // the rest of the animals...

   public string Name { get; set; } // user-readable
   public double Weight { get; set; }
   public Habitat Habitat { get; set; }

   public void Swim(); 
```

}

那太好了：你可以像 enums ( `AnimalType = Animal.Otter`) 一样使用它，你可以轻松地添加所有已定义动物的静态列表，你有一个明智的地方来实现`Swim()`。可以通过保护属性设置器来实现不变性。但是有一个主要问题：它破坏了可序列化性。一个序列化的 Animal 必须保存它的所有属性，并且在反序列化时它会创建一个 Animal 的新实例，这是我想避免的。

有没有一种简单的方法可以使第三次尝试成功？对于实施这样的模型还有什么建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-02T23:01:47.863

我会用子类来实现它，但是子类的实例不存储任何数据，如下所示：

```
public abstract class AnimalBase {
    public abstract string Name { get; } // user-readable
    public abstract double Weight { get; }
    public abstract Habitat Habitat { get; }
    public void Swim(); { /* swim implementation; the same for all animals but uses the value of Weight */ }

    // ensure that two instances of the same type are equal
    public override bool Equals(object o)
    {
        return o != null && o.GetType() == this.GetType();
    }
    public override int GetHashCode()
    {
        return this.GetType().GetHashCode();
    }
}

// subclasses store no data; they differ only in what their properties return
public class Otter : AnimalBase
{
    public override string Name { return "Otter"; }
    public override double Weight { return 10; }
    // here we use a private static member to hold an instance of a class
    // that we only want to create once
    private static readonly Habitat habitat = new Habitat("North America");
    public override Habitat Habitat { return habitat; }
} 
```

现在，您拥有多个“实例”并不重要，因为每个实例仅包含其类型信息（没有实际数据）。在基类上覆盖`Equals`and`GetHashCode`意味着同一类的不同实例将被视为相等。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-02T22:37:04.950

如果您遇到序列化问题，您始终可以将应用程序代码与序列化代码分开。也就是说，放置转换到/从您的序列化状态的转换类。序列化的实例可以公开任何所需的空构造函数和属性，它们唯一的工作就是序列化状态。同时，您的应用程序逻辑适用于不可序列化的不可变对象。这样，您就不会将序列化问题与逻辑问题混为一谈，这会带来许多不利因素，正如您所发现的那样。

编辑：这是一些示例代码：

```
public class Animal 
{
    public string Name { get; private set; }
    public double Weight { get; private set; }
    public Habitat Habitat { get; private set; }

    internal Animal(string name, double weight, Habitat habitat)
    {
        this.Name = name;
        this.Weight = weight;
        this.Habitat = habitat;
    }

    public void Swim();
}

public class SerializableAnimal
{
    public string Name { get; set; }
    public double Weight { get; set; }
    public SerializableHabitat Habitat { get; set; } //assuming the "Habitat" class is also immutable
}

public static class AnimalSerializer
{
    public static SerializableAnimal CreateSerializable(Animal animal)
    {
        return new SerializableAnimal {Name=animal.Name, Weight=animal.Weight, Habitat=HabitatSerializer.CreateSerializable(animal.Habitat)};
    }

    public static Animal CreateFromSerialized(SerializableAnimal serialized)
    {
        return new Animal(serialized.Name, serialized.Weight, HabitatSerializer.CreateFromSerialized(serialized.Habitat));
    }

    //or if you're using your "Static fields" design, you can switch/case on the name
    public static Animal CreateFromSerialized(SerializableAnimal serialized)
    {
        switch (serialized.Name)
        {
            case "Otter" :
                return Animal.Otter
        }

        return null; //or throw exception
    }
} 
```

然后，您的序列化应用程序逻辑可能类似于：

```
Animal myAnimal = new Animal("Otter", 10, "North America");
Animal myOtherAnimal = Animal.Duck; //static fields example

SerializableAnimal serializable = AnimalSerializer.CreateSerializable(myAnimal);
string xml = XmlSerialize(serializable);
SerializableAnimal deserialized = XmlDeserializer<SerializableAnimal>(xml);

Animal myAnimal = AnimalSerializer.CreateFromSerialized(deserialized); 
```

重申一下，SerializableAnimal 类和用法*仅*用于需要序列化/反序列化的应用程序的最后一层。 *其他一切*都对你不可变的 Animal 类起作用。

EDITx2：这种托管分离的另一个主要好处是您可以处理代码中的遗留更改。例如，您有一个`Fish`非常广泛的类型。也许您将其拆分为稍后`Shark`并决定应考虑`Goldfish`所有旧类型。通过这种序列化分离，您现在可以检查任何旧 Fish 并将它们转换为 Goldfish，而直接序列化会导致异常，因为 Fish 不再存在。`Fish``Goldfish`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-02T22:49:43.573

在我看来，您正在寻找适合您需求的正确[创建模式。](http://en.wikipedia.org/wiki/Creational_pattern)您的第一个选项类似于[factory method](http://en.wikipedia.org/wiki/Factory_method_pattern)。第二个看起来像一个带有可选[抽象工厂](http://en.wikipedia.org/wiki/Abstract_factory_pattern)的类型层次结构。第三个是[单例](http://en.wikipedia.org/wiki/Singleton_pattern)。

看来您唯一的问题是序列化。我们在谈论什么样的序列化：二进制还是 XML？如果它是二进制的，你看过[自定义序列化](http://msdn.microsoft.com/en-us/library/ty01x675.aspx)吗？如果是 XML，您应该坚持使用第二个选项，也使用自定义序列化或将序列化逻辑委托给您的类之外。

我个人认为后者是架构上最合理的解决方案。混合对象创建和序列化是一个坏主意。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-05T08:12:44.573

我会选择第三个选项（对象！），但有点扭曲。

关键是：您有一组具有某些特定模式的对象...

```
public class Animal {

   public string Name { get; set; } // user-readable
   public double Weight { get; set; }
   public Habitat Habitat { get; set; }

   public void Swim();
} 
```

但是您希望它们是预定义的。问题是：**如果你序列化这样的对象，你不想让它的字段序列化**。初始化字段是应用程序的责任，而您想要在序列化版本中实际拥有的唯一东西是动物的“类型”。这将允许您将“Otter”更改为“Sea Otter”并保持数据一致。

因此，您需要一些“动物类型”的表示 -**这是您唯一想要序列化的东西。**在反序列化时，您希望读取类型标识符并基于它初始化所有字段。

哦，还有一个问题——在反序列化时，你不想创建一个新对象！您想要读取 ID（和仅 ID）并检索预定义对象之一（对应于此 ID）。

* * *

代码可能如下所示：

```
public class Animal {

   public static Animal Otter;
   public static Animal Narwhal;

   // returns one of the static objects
   public static Animal GetAnimalById(int id) {...}

   // this is here only for serialization,
   // also it's the only thing that needs to be serialized
   public int ID { get; set; } 
   public string Name { get; set; }
   public double Weight { get; set; }
   public Habitat Habitat { get; set; }

   public void Swim();
} 
```

到目前为止，一切都很好。如果存在禁止您将实例设为静态的依赖项，您可以对所有 Animal 对象进行一些**延迟初始化**。

Animal 类开始有点像“几个单身人士在一个地方”。

现在如何将它挂接到 .NET 的序列化机制（BinarySerializer 或 DataContractSerializer）。我们希望在反序列化时使用序列化程序`GetAnimalById`而不是构造函数，并且在序列化时只存储 ID。

根据您的序列化 API，您可以使用 ISerializationSurrogate 或 IDataContractSurrogate 执行此操作。这是一个例子：

```
class Surrogate : IDataContractSurrogate {

    public Type GetDataContractType(Type type) {
        if (typeof(Animal).IsAssignableFrom(type)) return typeof(int);
        return type;
    }

    public object GetObjectToSerialize(object obj, Type targetType) {
        // map any animal to its ID
        if (obj is Animal) return ((Animal)obj).ID;
        return obj;
    }

    public object GetDeserializedObject(object obj, Type targetType) {
        // use the static accessor instead of a constructor!
        if (targetType == typeof(Animal)) return Animal.GetAnimalById((int)obj);
    }
} 
```

顺便说一句：DataContacts 似乎有一个错误（或者它是一个功能？），当替代类型是基本类型时，它会导致它们行为怪异。我在将对象序列化为字符串时遇到了这样的问题 - 反序列化它们时从未触发 GetDeserializedObject 方法。如果遇到这种行为，请在代理项中的单个 int 字段周围使用包装类或结构。

# google-chrome - 链接悬停导致 background-size: cover; 在 Chrome 中切换

> ID：10866272
> 
> 赞同：6
> 
> 时间：2012-06-02T22:02:53.813
> 
> 标签：google-chrome, css, background, hover, css-transitions

使用 CSS3，我将背景图片设置为封面。首次在 Chrome 中加载页面并将鼠标悬停在链接上时，文本周围的背景会发生轻微变化（但非常明显）。我正在为悬停使用过渡，但背景偏移也会随着过渡的移除而发生。

我的猜测是背景在悬停期间正在调整大小，但我不确定如何防止这种情况发生。移动后，您可以毫无问题地翻转其他链接。刷新页面后，问题依旧。

网站在这里：[http ://tylerbritt.com/](http://tylerbritt.com/)

造型是这样的：

```
body{
    text-align: center;
    margin: 0 auto;
    color: white;
    font: bold 80pt 'Economica', sans-serif;

    background: url(bg2.jpg) no-repeat  center center scroll;
    -webkit-background-size: cover;
    -moz-background-size: cover;
    -o-background-size: cover;
    background-size: cover; 
}

a {
    color: white;
    text-decoration: none;
    -webkit-transition: text-shadow 0.3s ease-out;
    -moz-transition: text-shadow 0.3s ease-out;
    -o-transition: text-shadow 0.3s ease-out;
    -ms-transition: text-shadow 0.3s ease-out;
    transition: text-shadow 0.3s ease-out;
}

  a:hover { 
        text-shadow: 0 0 6px #1c00f6;
    } 
```

我的问题非常类似于：[悬停时不透明度发生变化时 Google Chrome 中的背景偏移](https://stackoverflow.com/questions/10297930/background-shift-in-google-chrome-when-opacity-changes-on-hover)；jfriend00 的建议很有帮助，但我的问题有所不同，因为它纯粹是文本链接而不是 img。

我使用的是 Chrome 版本 19.0.1084.52。不存在的问题是Safari。任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T14:09:09.760

嘿，我注意到了完全相同的问题。绝对是镀铬的东西。以下是我提交给铬项目的一个[问题：](http://code.google.com/p/chromium/issues/detail?id=150006)

```
Chrome Version       : 21.0.1180.89
OS Version: 6.1 (Windows 7, Windows Server 2008 R2)
URLs (if applicable): http://jsfiddle.net/9vvy6/62/
                      http://castlelaw-kc.fosterwebmarketing.com/
Other browsers tested:
Add OK or FAIL after other browsers where you have tested this issue:
     Safari 5/6:OK
  Firefox 14.0.1:OK
     IE 9:OK
     Chrome:FAIL 
```

**哪些步骤将重现该问题？**

1.  背景尺寸的背景图片：封面
2.  具有悬停效果的叠加元素（使用 div 和 a 标签测试）
3.  为获得最佳效果，请在大视口中使用，其中 bg 图像被拉伸很多，并且消音最明显

**预期的结果是什么？**

当使用激活悬停效果（如下划线、边距更改等）时，背景图像应保持一致（并且在迄今为止测试的所有其他浏览器上都是如此）

**相反会发生什么？**

当使用鼠标激活悬停效果时，背景图像会奇怪地扭曲。在元素周围的区域中，背景图像出现了几个像素。

**请在下面提供任何附加信息。如果可能，请附上屏幕截图。**

在上面链接的 JSFiddle 中，它使用 ul/li 作为示例。我们确定将 ul 的显示更改为 inline-block 可以解决问题。

**重要提示：它非常微妙，因此您可能需要将鼠标扫过相关元素几次才能注意到**

> UserAgentString: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/21.0.1180.89 Safari/537.1

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T16:09:29.983

可能是一个错误，我不知道这是否可行，但尝试`background-attachment: fixed;`

# c++ - C++ 中的重载运算符和取消引用

> ID：10866275
> 
> 赞同：5
> 
> 时间：2012-06-02T22:03:10.503
> 
> 标签：c++, operator-overloading

我现在正在练习 C++ 中的重载运算符，但遇到了问题。我创建了 String 类，它只有字段一个是字符数组，另一个是长度。我有一个字符串“爱丽丝有一只猫”，当我打电话时

```
cout<<moj[2]; 
```

我想得到'i'，但现在我得到 moj + 16u 地址的 moj + 2 sizeof(String) 当我打电话时

```
 cout<<(*moj)[2]; 
```

它可以正常工作，但我想在重载的运算符定义中取消引用它。我尝试了很多东西，但我找不到解决方案。请纠正我。

```
char & operator[](int el) {return napis[el];}
const char & operator[](int el) const {return napis[el];} 
```

和整个代码，重要的事情都在页面下方。它正在编译和工作。

```
 #include <iostream>
   #include <cstdio>
   #include <stdio.h>
   #include <cstring>
  using namespace std;

 class String{
public:

//THIS IS  UNIMPORTANT------------------------------------------------------------------------------
char* napis;
int dlugosc;
   String(char* napis){
   this->napis = new char[20];
   //this->napis = napis;
   memcpy(this->napis,napis,12);
   this->dlugosc = this->length();
}

   String(const String& obiekt){
   int wrt = obiekt.dlugosc*sizeof(char);
   //cout<<"before memcpy"<<endl;
   this->napis = new char[wrt];
   memcpy(this->napis,obiekt.napis,wrt);

   //cout<<"after memcpy"<<endl;
   this->dlugosc = wrt/sizeof(char);
  }

   ~String(){
   delete[] this->napis;
   }

   int length(){
   int i = 0;
   while(napis[i] != '\0'){
       i++;
   }
   return i;
  }
        void show(){
      cout<<napis<<" dlugosc = "<<dlugosc<<endl;
 }

//THIS IS IMPORTANT
    char & operator[](int el) {return napis[el];}
    const char & operator[](int el) const {return napis[el];}
};

   int main()
   {

   String* moj = new String("Alice has a cat");
  cout<<(*moj)[2]; // IT WORKS BUI
 //  cout<<moj[2]; //I WOULD LIKE TO USE THIS ONE

   return 0;
   } 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-02T22:06:05.510

```
String* moj = new String("Alice has a cat");
cout<<(*moj)[2]; // IT WORKS BUI
//  cout<<moj[2]; //I WOULD LIKE TO USE THIS ONE 
```

那是做不到的，后一种情况下的下标运算符应用于指针。只有当至少一个参数是用户定义类型（或对它的引用，但不是指针）时，才可能重载运算符；在这种特殊情况下，参数是`String*`和`2`，都是基本类型。

你可以做的是完全放弃指针，我不明白你为什么需要它：

```
String moj("Alice has a cat");
// cout<<(*moj)[2]; <-- now this doesn't work
cout<<moj[2]; // <-- but this does 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-02T22:10:05.827

`String *`表示指向 a 的指针`String`，如果你想`String`对它本身做任何事情，你必须用`*moj`. 你可以做的是：

```
String moj = String("Alice has a cat"); // note lack of * and new
cout << moj[2]; 
```

另请注意，您分配的任何内容都`new`需要在以下情况后删除：

```
String *x = new String("foo");

// code

delete x; 
```

# python - Python 排序字符串以数字开头

> ID：10866277
> 
> 赞同：0
> 
> 时间：2012-06-02T22:03:21.827
> 
> 标签：python

我有下一个清单：

```
a = ['1th Word', 'Another Word', '10th Word']
print a.sort()
>>> ['10th Word', '1th Word', 'Another Word'] 
```

但是我需要：

```
['1th Word', '10th Word','Another Word'] 
```

是否有捷径可寻？

我试过：

```
r = re.compile(r'(\d+)')
def sort_by_number(s):
    m = r.match(s)
    return m.group(0)

x.sort(key=sort_by_number) 
```

但是有些字符串没有数字，这会导致错误。谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-02T22:10:24.637

这通常称为“自然排序”。

请参阅[Python 是否具有用于字符串自然排序的内置函数？](https://stackoverflow.com/questions/4836710/does-python-have-a-built-in-function-for-string-natural-sort)和[natsort 函数的 Python 模拟（使用“自然顺序”算法对列表进行排序）](https://stackoverflow.com/questions/2545532/python-analog-of-natsort-function-sort-a-list-using-a-natural-order-algorithm)；还有[http://code.activestate.com/recipes/285264-natural-string-sorting/](http://code.activestate.com/recipes/285264-natural-string-sorting/)和[http://www.codinghorror.com/blog/2007/12/sorting-for-humans-natural-sort-order。 .html](http://www.codinghorror.com/blog/2007/12/sorting-for-humans-natural-sort-order.html) _

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-02T22:20:19.690

这是一个适用于一般情况的函数

```
import re
def natkey(s):
    return [int(p) if p else q for p, q in re.findall(r'(\d+)|(\D+)', s)]

x = ['1th Word', 'Another Word 2x', 'Another Word 20x', '10th Word 10', '2nd Word']

print sorted(x)
print sorted(x, key=natkey) 
```

结果：

```
['10th Word 10', '1th Word', '2nd Word', 'Another Word 20x', 'Another Word 2x']
['1th Word', '2nd Word', '10th Word 10', 'Another Word 2x', 'Another Word 20x'] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-02T22:13:08.837

```
r = re.compile(r'(\d+)')
def sort_by_number(s):
    m = r.match(s)
    return m and m.group(0) or s

x.sort(key=sort_by_number) 
```

关键是如果没有匹配，则按原样返回字符串

# .net - 使用 T4 从另一个 dll 中存在的 dbml 文件生成 Autometadata

> ID：10866283
> 
> 赞同：1
> 
> 时间：2012-06-02T22:04:31.483
> 
> 标签：.net, asp.net-mvc, t4

我有两个 DLL

1.  BLL：业务层包含实体框架文件的 EDMX 文件
2.  MVC3 : 包含 asp.net mvc 应用程序

目前我将 Autometadata.tt 文件放在 BLL 中，这样我就可以根据 EDMX 文件生成 AutoMetaData 类。但我想在 MVC3 应用程序中有 AutoMetaData 文件，并且仍然根据 BLL dll 中存在的 EDMX 文件生成文件

我们可以这样做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T17:56:16.300

是的，我们可以做到。

您需要做的就是使用来自其他程序集的反射检索重要数据并根据它生成类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T23:59:56.117

如果您只是从模板中引用 edmx 文件，那么您只需使用用于加载 edmx 文件的路径即可跨越项目之间的相对路径，例如：

```
var inputFile = @"..\..\BLLsFolder\Bll1Project\BLL1Model.edmx"; 
```

显然，这有点令人讨厌的耦合，但它通常应该可以工作。

或者，j.salawa 的解决方案也应该没问题 - 您可能想查看以下问题以获取有关该方法的更多信息： [Q11371641](https://stackoverflow.com/questions/11371641/an-academic-query-about-t4-templates)

# c# - 如何在 ASP.NET MVC 项目中生成用于淘汰赛的客户端视图模型？

> ID：10866285
> 
> 赞同：11
> 
> 时间：2012-06-02T22:04:44.833
> 
> 标签：c#, javascript, asp.net-mvc, mvvm, knockout.js

我目前正在研究一个 ASP.NET MVC 解决方案，并且最近引入了 Knockout（一个 MVVM JS 库）和 Wijmo（一组 jQuery UI 小部件）。

随着 Knockout 的引入，我还需要在客户端拥有模型，因此为此我将 C# ViewModel 序列化并使用`data-model="@Model.ToJson()"`. 这允许我从 JS 中检索模型并将一些客户端的爱应用于所有内容。

但是，淘汰赛需要一切都是可观察的，所以我需要声明一个单独的客户端 ViewModel 并映射来自数据模型对象的所有内容。这感觉就像重复的努力，我想以某种方式避免它。

我希望有人可以分享一种工具或技术，让我可以直接从服务器渲染淘汰赛 ViewModel。可能的解决方案可能包括：

*   自定义 JSON 序列化以将可观察视图模型直接呈现到 data-model 属性中的输出。
*   自动客户端转换（我听说过 ko-autobind，但不确定它是否是推荐的路径或它有多稳定/完整）
*   我没有想到的东西

我希望解决方案是通用的和自动的，因为我目前手动输入可观察客户端视图模型的方法太低效，不可行。

你是如何解决这个问题的？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-02T22:11:33.953

根据他们的教程，这只是一个简单的`.map`功能

如果这是 ViewModel

```
function Task(data) {
    this.title = ko.observable(data.title);
    this.isDone = ko.observable(data.isDone);
} 
```

此函数从服务器获取数据，它使用该`.map`函数将服务器数据直接注入虚拟机

```
// Data
var self = this;
self.tasks = ko.observableArray([]);

// Load initial state from server, convert it to Task instances, then populate self.tasks
$.getJSON("/tasks", function(allData) {
    var mappedTasks = $.map(allData, function(item) {
        return new Task(item)
    });
    self.tasks(mappedTasks);
}); 
```

对于 ko 映射 [http://knockoutjs.com/documentation/plugins-mapping.html](http://knockoutjs.com/documentation/plugins-mapping.html)

对于自动绑定，这是一个示例

[https://groups.google.com/forum/#!msg/knockoutjs/IJTx37UXQVw/UTrWdEK1C-oJ](https://groups.google.com/forum/#!msg/knockoutjs/IJTx37UXQVw/UTrWdEK1C-oJ)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-10-24T12:27:47.560

试试这个 Visual Studio [插件 http://visualstudiogallery.msdn.microsoft.com/32c15a80-1c54-4e96-a83f-7cd57573a5d2](http://visualstudiogallery.msdn.microsoft.com/32c15a80-1c54-4e96-a83f-7cd57573a5d2)

# php - PHP If 块只使用最后一个块

> ID：10866287
> 
> 赞同：0
> 
> 时间：2012-06-02T22:05:11.777
> 
> 标签：php, if-statement, statements

我的代码如下所示：

```
if ($first == 1); {
$q1 = "1";
$q2 = "2";
$q3 = "3";
}

if ($first == 2); {
$q1 = "1a";
$q2 = "2a";
$q3 = "3a";
}

if ($first == 3); {
$q1 = "1b";
$q2 = "2b";
$q3 = "3b";
} 
```

变量 $first 来自之前排序的数组。这是该数组中的一个键值。

在本例中，变量为 2，但代码始终采用最后一个块，而不管其他任何内容。所以它会报告 3 块的答案，而不是 2 块。

也就是说，为 $first 获取值 1、2 或 3 将始终为 $q1 返回 1b。

有谁知道为什么？这让我发疯了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-02T22:07:20.997

首先，从您的条件周围的括号中删除分号。

其次，您应该使用`if()`and `else if()`：

```
if($first == 1) {
    $q1 = "1";
    $q2 = "2";
    $q3 = "3";
} else if($first == 2) {
    $q1 = "1a";
    $q2 = "2a";
    $q3 = "3a";
} else if($first == 3) {
    $q1 = "1b";
    $q2 = "2b";
    $q3 = "3b";
} 
```

但是，如果您要比较 3 个以上的状态，则应该使用`switch()`语句来生成更清晰的代码，如下所示：

```
switch($first) {
    case 1:
        $q1 = "1";
        $q2 = "2";
        $q3 = "3";
    break;
    case 2:
        $q1 = "1a";
        $q2 = "2a";
        $q3 = "3a";
    break;
    case 3:
        $q1 = "1b";
        $q2 = "2b";
        $q3 = "3b";
    break;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-02T22:06:19.380

你不应该`;`在你的 if 语句的末尾。即改成`if ($first == 1); {`这个`if ($first == 1) {`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-02T22:10:44.160

您还可以使用 switch 语句：

```
switch($first) 
{
    case 1:
       $q1 = "1";
       $q2 = "2";
       $q3 = "3";
       break;
    case 2:
       $q1 = "1a";
       $q2 = "2a";
       $q3 = "3a";
       break;
    case 3:
       $q1 = "1b";
       $q2 = "2b";
       $q3 = "3b";
       break;
    default:
} 
```

# javascript - 将 li 输入值数据转换为 JSON

> ID：10866291
> 
> 赞同：1
> 
> 时间：2012-06-02T22:05:32.447
> 
> 标签：javascript, jquery, ajax, yii

您好，我需要使用 ajax 保存多个值并更新数据库。我正在研究 Yii 框架。

首先，我需要使用 ajax 作为 json 发送数据，但结果有误。

实时代码：http: [//jsfiddle.net/kxJwp/2/](http://jsfiddle.net/kxJwp/2/)

我的 JavaScript 代码是：

```
$("#save").live('click', function(){
    var showtimes = [];
    var values = {};
    $('li inputs').each(function() {
        values[$(this).attr('name')] = $(this).val();
    });
    $('li').each(function(i) {
        showtimes[i]=values;
    });
    alert(JSON.stringify(showtimes));
}); 
```

**Javascript 输出：**

*它输出最后一个 li 值 x li 的数量*

**输入：**

```
<li>
    <input name="show_id" class="show_id att" type="hidden" value="" />
    <input name="movie_id" class="movie_id att" type="hidden" value="" />
    <input name="cinema_id" class="cinema_id att" type="hidden" value="" />
    <input name="status" class="status att" type="hidden" value="" />
    <input name="times" class="timesArray att" type="hidden" value="" />
<li>
<li>
    <input name="show_id" class="show_id att" type="hidden" value="" />
    <input name="movie_id" class="movie_id att" type="hidden" value="" />
    <input name="cinema_id" class="cinema_id att" type="hidden" value="" />
    <input name="status" class="status att" type="hidden" value="" />
    <input name="times" class="timesArray att" type="hidden" value="" />
<li> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T20:28:35.590

您只看到一行，因为您只有一个对象，而您需要一个对象数组，因此首先声明一个数组，然后继续向其中添加对象。像这样的东西：

```
$("#save").live('click', function(){
  var showtimes = [];    // Create empty javascript array
  var objec={};
  $("li").find("input").each(function(index) {           // Iterate over inputs

    objec=new Object; // to create a new object for every matched element

    objec[$(this).attr('name')]=$(this).val()+'avla';
    showtimes[index]=objec;  // Add object to array
  });

  var json = JSON.stringify(showtimes);
  alert(json);
}); 
```

代码说明：使用 的内置[索引`each()`](http://api.jquery.com/each/ "http://api.jquery.com/each/")，通过将索引传递给函数，例如：`function(index){...}`.

编辑：`objec=new Object;`需要避免重复值，因为每次将相同的对象添加到数组中，但是使用 new 时，每次都会创建一个新对象并将其添加到数组中。

**更新：**选择 s 的更好方法`li`是使用选择器，例如 :`$("li:has(input)")`然后循环遍历子项：

```
$("#save").live('click', function(){
    var showtimes = [];
    var values = {};
    $("li:has(input)").each(function(i){
        values = new Object;
        $(this).children().each(function(){
            values[$(this).attr('name')]=$(this).val();
        });
        showtimes.push(values);
    });
    alert(JSON.stringify(showtimes));
}); 
```

编辑：上述两个示例中的输出（形成的数组）是不同的。

代码示例 1 的输出：

```
json=[{"show_id":"1avla"},{"movie_id":"2avla"},{"cinema_id":"3avla"},{"status":"4avla"},{"times":"5avla"},{"show_id":"6avla"},{"movie_id":"7avla"},{"cinema_id":"8avla"},{"status":"9avla"},{"times":"0avla"}] 
```

代码示例 2 的输出：

```
json=[{"show_id":"1","movie_id":"2","cinema_id":"3","status":"4","times":"5"},{"show_id":"6","movie_id":"7","cinema_id":"8","status":"9","times":"0"}] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-03T05:40:44.510

您的原始 js 代码显示

```
$("tr").find("input.att").each(function() { 
```

但是您的视图代码显示您正在使用`<li>`而不是`<tr>`

所以不应该`$("ul") or $("li")`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T08:52:47.760

您可以使用另一种替代方法。您应该进行的更改是将`li`s 和`input'`s 放在表单下，并通过 ajax 提交表单。此外，您应该根据[此](http://www.php.net/manual/en/faq.html.php#faq.html.arrays)更改输入的名称，即添加方括号，以便您可以在 PHP 中将其作为数组检索。不需要json所以

```
 <form id="myform" action="action.php">
    .....
    <li>
        <input name="show_id[]" class="show_id att" type="hidden" value="" />
        <input name="movie_id[]" class="movie_id att" type="hidden" value="" />
        <input name="cinema_id[]" class="cinema_id att" type="hidden" value="" />
        <input name="status[]" class="status att" type="hidden" value="" />
        <input name="times[]" class="timesArray att" type="hidden" value="" />
    <li>
    <li>
        <input name="show_id[]" class="show_id att" type="hidden" value="" />
        <input name="movie_id[]" class="movie_id att" type="hidden" value="" />
        <input name="cinema_id[]" class="cinema_id att" type="hidden" value="" />
        <input name="status[]" class="status att" type="hidden" value="" />
        <input name="times[]" class="timesArray att" type="hidden" value="" />
    <li>

    ....

</form> 
```

和 ajax 的 javascript

```
$("#save").live('click', function(){
    var form = $('#myform');
    $.ajax( {
      type: "POST",
      url: form.attr( 'action' ),
      data: form.serialize(),
      success: function( response ) {
        console.log( response );
      }
    } );

}); 
```

然后在您的控制器中，您将获得提交的数据作为**数组**

```
print_r($_POST['show_id']);
print_r($_POST['movie_id']); 
```

等等等等

# objective-c - 终止可可应用程序中的所有方法并重新初始化

> ID：10866292
> 
> 赞同：0
> 
> 时间：2012-06-02T22:05:34.513
> 
> 标签：objective-c, cocoa

我想终止所有当前调用的方法，然后简单地重新初始化我当前的对象。所以当用户点击开始按钮时，我会调用一堆方法......开始做一些事情。然后当用户点击取消时，我需要简单地停止所有正在运行的任务/方法并重新初始化。

我不希望应用程序本身终止。所以不能使用 [NSApp terminate:nil]。我只需要停止所有当前功能，然后我可以调用 [self init]; 提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-02T22:17:29.367

首先，您必须设置一些标志并禁用您的用户界面，直到所有方法都完成。例如，`self.cancelled = YES`。

接下来，如果设置了该标志，则应调整每个方法以返回：

```
- (void)doSomething
{
    if (self.cancelled) return;
    // ...
    for (/* ... */) {
        // ...
        if (self.cancelled) return;
        // ...
    }
    // etc...

} 
```

然后，您需要一种机制来跟踪您的所有方法。最有可能的是，您将使用`NSOperationQueue`or `dispatch_queue_t`。查看文档以了解如何在队列变空时获得通知。

最后，重置`self.cancelled`标志并取消阻止您的用户界面。

# ruby-on-rails - 防止 before_create 方法在 false 或 nil 时保存

> ID：10866293
> 
> 赞同：1
> 
> 时间：2012-06-02T22:05:34.967
> 
> 标签：ruby-on-rails

我有一个`:before_create`方法可以执行一些检查并返回`false`or `true`。

```
def create_subscription_on_gateway 
  gateway = self.keyword.shortcode.provider
  create_subscription = gateway.classify.constantize.new.create_subscription(self.phone,self.keyword_keyword,self.shortcode_shortcode,self.country)
  errors[:base] << "An error has occurred when finding gateway." if gateway.nil?
  errors[:base] << "No gateway found for this shortcode." if create_subscription.nil?
  errors[:base] << "Subscription could not be made." if create_subscription == false
end 
```

现在，如果方法返回`false`，或者`nil`我可以在表单页面上看到错误，那没关系。问题是对象已保存到数据库中。

当对象上仍然存在相关错误时，如何防止对象被保存？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-01-06T15:18:04.050

您可以引发 ActiveRecord::RecordInvalid 异常，它会阻止模型被保存并且不会中断保存流程。

```
if error?
 errors[:base] << "error"    
 raise ActiveRecord::RecordInvalid.new(self)
end 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-02T23:32:36.350

怎么样，而不是 before_create，你使用验证。然后将您的 create_subscription_on_gateway 更改为 before_validation

```
validate :gateway_presence
validate :gateway_found
validate :create_subscription

def gateway_presence
  if # ...your code here
    errors.add(:gateway, "An error has occured..."
  end
end

def gateway_found
  if # ...your code here
    errors.add(:gateway, "An error has occured..."
  end
end 
```

等等...

# ios5 - iOS MapKit 在一定距离内显示最近的注释

> ID：10866297
> 
> 赞同：2
> 
> 时间：2012-06-02T22:06:21.947
> 
> 标签：ios5, mapkit, xcode4.3, mkannotation

目前我正在为 iPhone/iPad 开发基于位置的应用程序。我的 MapKit 中有几个注释，我想做的是跟踪用户的位置并显示 3km 内的注释。有人可以给我一个开始吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T00:26:55.423

抱歉延迟回复......这个问题刚刚从我的雷达上消失了。

我将假设您有一个方法可以返回一组 NSValue 包装的`CLLocationCoordinate2D`结构（无论您的内部数据表示是什么，基本方法都是相同的）。然后，您可以使用类似于以下的方法过滤列表（警告：在浏览器中键入）：

```
NSSet *locations = ...;
CLLocation centerLocation = ...; // Reference location for comparison, maybe from CLLocationManager
CLLocationDistance radius = 3000.; // Radius in meters
NSSet *nearbyLocations = [locations objectsPassingTest:^(id obj, BOOL *stop) {
        CLLocationCoordinate2D testCoordinate;
        [obj getValue:&testCoordinate];
        CLLocation *testLocation = [[CLLocation alloc] initWithLatitude:testCoordinate.latitude
                                                              longitude:testCoordinate.longitude];
        BOOL returnValue = ([centerLocation distanceFromLocation:testLocation] <= radius);
        [testLocation release];
        return returnValue;
    }
]; 
```

使用过滤后的坐标集，您可以创建`MKAnnotation`实例并以通常的方式将它们添加到地图中，如[Apple 文档](http://developer.apple.com/library/ios/#DOCUMENTATION/UserExperience/Conceptual/LocationAwarenessPG/AnnotatingMaps/AnnotatingMaps.html)中所述。

如果您有数千个测试位置，那么我认为这种方法可能会开始引发性能问题。然后，您可能希望切换使用点存储方法，例如[四叉树](http://blog.notdot.net/2009/11/Damn-Cool-Algorithms-Spatial-indexing-with-Quadtrees-and-Hilbert-Curves)，以减少需要精确过滤的点数。但不要过早优化！

希望有帮助！

# ios - MonoTouch：图标下未显示捆绑名称

> ID：10866300
> 
> 赞同：0
> 
> 时间：2012-06-02T22:06:43.443
> 
> 标签：ios, xamarin.ios, bundle

我想使用我的应用程序名称的较短版本来显示在图标下。我已经读到 Bundle Name 是显示这个缩短名称的值。我将 Bundle Name (CFBundleName) 添加到我的 info.plist，但我的应用程序名称仍根据 Bundle 显示名称 (CFBundleDisplayName) 显示。我在这里错过了什么吗？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-04T08:08:49.567

尝试使用 metadata->title 键：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
    <key>items</key>
    <array>
        <dict>
            <key>assets</key>
            <array>
                <dict>
                    <key>kind</key>
                    <string>software-package</string>
                    <key>url</key>
                    <string>http://www.example.es/YourAppBundle.ipa</string>
                </dict>
            </array>
            <key>metadata</key>
            <dict>
                <key>bundle-identifier</key>
                <string>XXXXXXXXXX</string>
                <key>kind</key>
                <string>software</string>
                <key>title</key>
                <string>YourAppName</string>
            </dict>
        </dict>
    </array>
</dict>
</plist> 
```

# php - 在字符串中执行 PHP 代码

> ID：10866301
> 
> 赞同：9
> 
> 时间：2012-06-02T22:06:47.070
> 
> 标签：php, eval

我将页面内容保存在数据库中，并希望执行字符串中的任何 php 代码。所以如果我的字符串是：

```
<h1>Welcome</h1><?php echo $motto?><br/> 
```

我只想执行`echo $motto`. 使用 eval() 将尝试执行`<h1>Welcome</h1>`.

有什么办法可以做到这一点？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-06-02T22:25:26.553

不用说你应该尽快找到另一个解决方案。与此同时，您可以像这样评估代码：

```
$str = '<h1>Welcome</h1><?php echo $motto?><br/>'; // Your DB content

eval("?> $str <?php "); 
```

演示：[http ://codepad.org/ao2PPHN7](http://codepad.org/ao2PPHN7)

我怎么强调都不为过：eval 是危险的，应用程序代码不应该在数据库中。尝试使用[Smarty](http://www.smarty.net/)、[Dwoo](http://wiki.dwoo.org)或我最喜欢的模板解析器：[Twig](http://twig.sensiolabs.org/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-02T22:16:55.700

你**真的**不应该这样做，但如果你绝对必须这样做，你可以使用这个类来做到这一点：

```
class PhpStringParser
{
    protected $variables;

    public function __construct($variables = array())
    {
        $this->variables = $variables;
    }

    protected function eval_block($matches)
    {
        if( is_array($this->variables) && count($this->variables) )
        {
            foreach($this->variables as $var_name => $var_value)
            {
                $$var_name = $var_value;
            }
        }

        $eval_end = '';

        if( $matches[1] == '<?=' || $matches[1] == '<?php=' )
        {
            if( $matches[2][count($matches[2]-1)] !== ';' )
            {
                $eval_end = ';';
            }
        }

        $return_block = '';

        eval('$return_block = ' . $matches[2] . $eval_end);

        return $return_block;
    }

    public function parse($string)
    {
        return preg_replace_callback('/(\<\?=|\<\?php=|\<\?php)(.*?)\?\>/', array(&$this, 'eval_block'), $string);
    }
} 
```

像这样称呼它：

```
$p = new PhpStringParser();
echo $p->parse($string); 
```

^(*来源：[http ://www.php.net/manual/en/function.eval.php#108091](http://www.php.net/manual/en/function.eval.php#108091)*)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-05-29T14:01:43.627

要使用内部变量回显字符串：

```
echo "<h1>Welcome</h1>$motto<br/>" 
```

甚至：

```
echo sprintf('<h1>Welcome</h1>%s<br/>', $motto) 
```

这是一个演示[http://codepad.org/f6aALD6w](http://codepad.org/f6aALD6w)

# javascript - jqplot堆积条形图缩放颜色丢失

> ID：10866303
> 
> 赞同：2
> 
> 时间：2012-06-02T22:06:56.913
> 
> 标签：javascript, jquery, jqplot

我已经实现了一个以 DateTime 作为 X 轴的堆叠条形图，并希望能够对其进行缩放。原始图表如下所示： ![原始图像](../Images/9c8b0269ad45c3208613e3f41bf06705.png)

当我尝试放大时（这次是围绕紫色线），它看起来像这样： ![缩放尝试](../Images/2c7735c09ef73e8b88f45fba3f5da072.png)

看起来实际的缩放工作正常，但条形图的排列正在丢失。

如何保持不同的条形图并仍然放大日期范围？

代码：

```
var plot2 = '';
var full_canvas_id = 'full-canvas';
var plot_options = {
    cursor:{ 
    show: true,
    zoom:true, 
},
    seriesColors: [ "#fffdf6","#c5b47f", "#579575", "#EAA228"],
    stackSeries: true,
    seriesDefaults: {
        renderer:$.jqplot.BarRenderer,
        shadowAngle: 135,
        rendererOptions: {
        barMargin: '65',
        barDirection: 'horizontal',
    },
    pointLabels: {show: false}
}, axes: {
    yaxis: {
        pad:1.05,
        renderer: $.jqplot.CategoryAxisRenderer,
        ticks:["Machine 521","Machine 358","Machine 415","Machine 1350","Machine 265","Machine 1126"]       
    }, xaxis: {
        min:'2012-05-01 0:00',
        max:'2012-06-15 17:50',
        renderer:$.jqplot.DateAxisRenderer,
        tickOptions:{
            formatString:'%b&nbsp;%#d, %y'
        }
    }
}, legend: {
    labels:  ['Not Scheduled','Completed','Material','No Material'],
    show: true,
    location: 'e',
    placement: 'outside'
}, canvasOverlay: {
    show: true,
    objects: [
        {verticalLine: {
            name: 'Current Time',
            x: 1338674277000,
            lineWidth: 1,
            color: 'rgb(100, 55, 124)',
            shadow: false,
            lineCap: 'butt',
            xOffset: 0
        }}
        ]
    }         
};

var tooltip_request;

function build_tooltip(part_lot_id, column, start_date, end_date) {
    if(column == 0) $('div.tooltip').hide();
    tooltip_request = $.getJSON('/?fn=material_schedule&a=get_graph_tooltip&pli='+part_lot_id+'&col='+column,function(j) {
    $('div.tooltip div.wrapper').html(j.title + '<br>Start:' + make_full_date(start_date) + '<br>End:' + make_full_date(end_date) + '<br>' + j.html);
    });
}

$(document).ready(function(){
plot2 = $.jqplot(full_canvas_id, [[["2012-05-01 0:00",1,"1"],["2012-05-07 0:00",2,"1"],["2012-05-01 0:00",3,"3"],["2012-05-06 0:00",4,"3"],["2012-05-08 0:00",5,"3"],["2012-06-05 0:00",6,"4"]],[["2012-06-02 15:57",1,"1"],["2012-06-02 15:57",2,"1"],["2012-06-02 15:57",3,"3"],["2012-06-02 15:57",4,"3"],["2012-06-02 15:57",5,"3"],["2012-06-05 0:00",6,"4"]],[["2012-06-06 16:17",1,"1"],["2012-06-06 16:17",2,"1"],["2012-06-04 18:54",3,"3"],["2012-06-04 18:54",4,"3"],["2012-06-04 18:54",5,"3"],["2012-06-06 16:17",6,"4"]],[["2012-06-07 3:20",1,"1"],["2012-06-07 3:20",2,"1"],["2012-06-13 17:50",3,"3"],["2012-06-13 17:50",4,"3"],["2012-06-13 17:50",5,"3"],["2012-06-08 17:39",6,"4"]]], plot_options);
$('#'+full_canvas_id).bind('jqplotDataHighlight', function (ev, seriesIndex, pointIndex, data ) {
    if($('div.tooltip').length == 0) {
        $('body').append($('<div></div>').addClass('tooltip'));
        $('div.tooltip').append($('<div></div>').addClass('wrapper'));
    }
    clearTimeout($('div.tooltip').data('timeout'));
    console.log(plot2);
    var t_x = (plot2.axes.xaxis.u2p(data[0])*1) + ($('#'+full_canvas_id).offset().left * 1);
    var t_y = (plot2.axes.yaxis.u2p(data[1])*1) + ($('#'+full_canvas_id).offset().top * 1);
    $('div.tooltip').css({'left' : t_x + 'px','top' : t_y + 'px'}).stop(true,true).show();

    if(seriesIndex == 0) var start_date = plot2.axes.xaxis.min;
    else var start_date = plot2.series[seriesIndex-1].data[pointIndex][0];
    build_tooltip(plot2.series[seriesIndex].data[pointIndex][2], seriesIndex, start_date, plot2.series[seriesIndex].data[pointIndex][0]);
    clearTimeout($('div.tooltip').data('timeout'));
    $('div.tooltip, div.tooltip .wrapper').unbind('mouseenter mouseleave').mouseenter(function() {
        clearTimeout($('div.tooltip').data('timeout'));
        $(this).stop(true,true).show();
    }).mouseleave(function() {
            var tt = this;
            clearTimeout($('div.tooltip').data('timeout'));
            $('div.tooltip').data('timeout',setTimeout(function() {
                $(tt).hide();
                },'200'));
            });
        });
        $('#'+full_canvas_id).bind('jqplotDataUnhighlight', function (ev,seriesIndex, pointIndex, data) {
        clearTimeout($('div.tooltip').data('timeout'));
        $('div.tooltip').data('timeout',setTimeout(function() {
            $('div.tooltip').stop(true,true).hide();
        },'200'));
    });
});

function make_full_date(timestamp) {
var months = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
    var end_date = new Date(timestamp);
    var hour = end_date.getHours();
    var min = end_date.getMinutes();
    if(min < 10) min = '0' + min;
    return months[end_date.getMonth()] + ' ' + end_date.getDate() + ', ' + end_date.getFullYear() + '@' + hour + ':' + min;
} 
```

# vim - 从不是活动缓冲区的缓冲区中拉出行

> ID：10866304
> 
> 赞同：7
> 
> 时间：2012-06-02T22:07:08.700
> 
> 标签：vim

假设有两个加载的缓冲区/文件，它们都通过拆分窗口显示，行号被启用并且因此是已知的。

有没有办法留在一个缓冲区中，指定另一个缓冲区的一行并将其拉出以便可以将其放入活动缓冲区中？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-02T23:56:27.790

```
:let @ 0 = join ( getbufline ( *'#'* , *42* ), "\n") 。"\n"

```

（替换`#`为另一个缓冲区的名称和另一个缓冲区`42`中的行号。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-02T23:09:41.520

如果两个缓冲区都已保存到磁盘，并且您的系统上有*sed*可用，则可以使用它。

```
:r !sed -n -e 42p # 
```

将 42 替换为要从备用缓冲区复制的行。

此命令将`:read`输出`!sed`（*sed*程序）的输出，该程序已被指示仅（`-n`）打印“其他”文件中的`p`行。内容插入到当前 ( ) 缓冲区中的当前行下方。`42``#``%`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-03T00:56:07.933

你在比较/编辑类似的文件吗？也许

```
:vert diffsplit otherfilename 
```

或（如果缓冲区已经打开）

```
:windo diffthis 
```

会是合理的。在 diffmode 中，有命令

```
:diffput
:diffget 
```

以及它们的正常命令等效项 ( `d``p`, `d``o`(_obtain)) 以从另一个缓冲区中获取和插入/替换行。

# .net - 为什么.net 异常没有被捕获？

> ID：10866307
> 
> 赞同：10
> 
> 时间：2012-06-02T22:07:23.147
> 
> 标签：.net, exception, exception-handling, code-contracts

考虑以下“安全”程序：

```
internal class Safe
{
    public static void SafeMethodWillNeverThrow()
    {
        try
        {
            var something = ThrowsNewException();
            Func<int, string> x = p => something.ToString();
        }
        catch (Exception)
        {
        }
    }

    private static object ThrowsNewException() 
    {
        throw new Exception();
    }

    public static void Main()
    {
        SafeMethodWillNeverThrow();
    }
} 
```

它永远不应该以异常完成。但是为什么我运行它时它会失败？为什么 SafeMethodWillNeverThrow() 会抛出异常？

在测试此代码之前，请阅读下面的答案。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-06-02T22:07:23.490

这是因为您在使用发布配置的项目属性中启用了代码合同运行时合同检查。如果你是，你的 SafeMethodWillNeverThrow() 方法会在 Code Contracts 重写器的帮助下转换为以下内容：

```
public static void SafeMethodWillNeverThrow()
{
    object something = ThrowsNewException();
    try
    {
        Func<int, string> func1 = p => something.ToString();
    }
    catch (Exception)
    {
    }
} 
```

哎哟!

结论：不要相信你所看到的——阅读 IL :)。

该问题可通过以下代码合同版本重现：

1.  1.4.50327.0

2.  1.4.50126.1

    我正在使用代码合同，并希望尽快修复错误。我已将其发布到[代码合同论坛](http://social.msdn.microsoft.com/Forums/en-US/codecontracts/thread/e2b9b734-2d6e-432b-9735-b3a2b6316c8c)。尽快修复它的唯一方法是吸引足够的注意力。所以请投票，尤其是在 Code Contracts 论坛上

2016 年 5 月更新：

版本 1.9.10714.2 给出了不同的异常未处理异常：System.InvalidProgramException：公共语言运行时检测到无效程序。

# c++ - GetMessage 超时

> ID：10866311
> 
> 赞同：17
> 
> 时间：2012-06-02T22:08:01.343
> 
> 标签：c++, windows, winapi

我有一个应用程序，第二个线程`GetMessage()`在循环中调用。在某些时候，第一个线程意识到用户想要退出应用程序并通知第二个线程它应该终止。由于第二个线程被卡住`GetMessage()`，程序永远不会退出。有没有办法等待超时消息？我也对其他想法持开放态度。

**编辑：（**附加解释）

第二个线程运行该代码片段：

```
while ( !m_quit && GetMessage( &msg, NULL, 0, 0 ) )
{
    TranslateMessage( &msg );
    DispatchMessage( &msg );
} 
```

第一个线程设置`m_quit`为 true。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-06-02T22:37:02.890

未经测试，但您可以在没有任何对象的情况下尝试函数[MsgWaitForMultipleObjects 。](http://msdn.microsoft.com/en-us/library/windows/desktop/ms684242%28v=vs.85%29.aspx)

```
MsgWaitForMultipleObjects(0, NULL, FALSE, timeout, QS_ALLINPUT); 
```

如果如果返回`WAIT_TIMEOUT`它是一个超时，但如果它返回`WAIT_OBJECT_0`你可以 `GetMessage`保证不被阻塞调用。

但请注意以下几点：

> 如果线程调用函数检查队列后消息队列中存在指定类型的未读输入，则 MsgWaitForMultipleObjects 不会返回。

因此，您必须确保上次调用任何消息函数时队列中没有消息，否则您将遇到一种竞争条件。

可能您最好的选择是替换`GetMessage`为：

```
if (MsgWaitForMultipleObjects(0, NULL, FALSE, timeout, QS_ALLINPUT) == WAIT_OBJECT_0)
{
    while (PeekMessage(&msg, 0, 0, 0, PM_REMOVE))
    {
        //dispatch the message
    }
} 
```

但正如我之前所说，我没有测试它，所以我不能确定它是否会起作用。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2012-06-02T22:11:57.240

最简单的方法是在调用`UINT_PTR timerId=SetTimer(NULL, NULL, 1000, NULL)`之前先调用`GetMessage`。它会`WM_TIMER`每秒向调用线程发送一条消息，因此`GetMessage`会立即返回。然后，打电话`KillTimer(NULL, timerId)`取消它。

**更新**示例代码：

```
BOOL GetMessageWithTimeout(MSG *msg, UINT to)
{
    BOOL res;
    UINT_PTR timerId = SetTimer(NULL, NULL, to, NULL);
    res = GetMessage(msg);
    KillTimer(NULL, timerId);
    if (!res)
        return FALSE;
    if (msg->message == WM_TIMER && msg->hwnd == NULL && msg->wParam == timerId)
        return FALSE; //TIMEOUT! You could call SetLastError() or something...
    return TRUE;
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-02T22:17:29.577

您总是可以做的一件事就是向被阻塞的线程发送一条用户定义的消息，使其唤醒，处理消息，然后返回到循环的顶部。事实上，完全删除`m_quit`变量可能是最简单的，而是只向主线程发送一条消息，说“你现在需要退出”。

希望这可以帮助！

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-06-02T22:33:52.423

您应该能够将退出消息发布到第二个线程`PostThreadMessage`。

例如

```
PostThreadMessage(threadid, WM_QUIT, 0, 0); 
```

您不需要`m_quit`在第二个线程中读取变量，但您应该检查错误`GetMessage`以及返回值，`FALSE/0`如果下一条消息是退出消息，则返回值。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-06-02T22:10:38.113

是的。试试`PeekMessage()`吧。但我认为这不会完全解决问题。

# facebook - Facebook 是否将 oauth2 用于其 FB 原生 iOS 应用程序？

> ID：10866312
> 
> 赞同：0
> 
> 时间：2012-06-02T22:08:45.400
> 
> 标签：facebook, oauth-2.0

我知道 Facebook 为他的 API 提供了 oauth2 访问。

我的问题更集中于了解 Facebook 原生 iOS 应用程序是否通过 https 使用 oauth2 或 digest/basic/other 身份验证？

因为 Facebook 是框架的“所有者”，所以它不太适应 oauth（更适合代表某人执行请求/登录）。

有人可以澄清我的观点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T14:02:11.923

如果您真的有兴趣 - 将其安装在模拟器上，使用帐户登录并使用 Wireshark 之类的工具在主机上跟踪所有这些操作。

# c - 瓦尔格林 | 大小为 8 的无效读取 | 地址 0x7a41270 在大小为 4 的块内是 0 个字节，已分配

> ID：10866314
> 
> 赞同：7
> 
> 时间：2012-06-02T22:09:06.717
> 
> 标签：c, memory, valgrind

几天以来，我试图在我的软件中找到一个内存错误。
它相当复杂，但结构和格式都很好（在我看来）。
该错误出现在运行 Debian GNU/Linux 的 64 位机器上。
（...不在我的 32 位机器上—— void*/int mixup？）
如果你能帮助我，我会很高兴的。

源代码片段在此消息的末尾。
如果这还不够，您可能需要检查所有来源：
[http ://savannah.nongnu.org/svn/?group=cybop](http://savannah.nongnu.org/svn/?group=cybop)

按照安装文件的说明编译运行。

按以下方式运行软件可以正常工作：

`enter code here`christian@deneb:/home/project/cybop/examples$ ../src/controller/cyboi

使用选项运行它会在 valgrind 中带来 memcheck 错误：
christian@deneb:/home/project/cybop/examples$ ../src/controller/cyboi --help

我已经使用这个命令行运行了 memcheck：
christian@deneb:/home/project/cybop/examples$ valgrind --log-file=memcheck.log --tool=memcheck --read-var-info=yes --track -origins=yes ../src/controller/cyboi --help

这是内存检查输出：

```
==20072== Memcheck, a memory error detector
==20072== Copyright (C) 2002-2011, and GNU GPL'd, by Julian Seward et al.
==20072== Using Valgrind-3.7.0 and LibVEX; rerun with -h for copyright info
==20072== Command: ../src/controller/cyboi --help
==20072== Parent PID: 18978
==20072== 
==20072== Invalid read of size 8
==20072==    at 0x40AF0E: decode_utf_8 (utf_8_decoder.c:298)
==20072==    by 0x42A53D: optionalise_argument (argument_optionaliser.c:110)
==20072==    by 0x42A786: optionalise (optionaliser.c:107)
==20072==    by 0x401507: main (cyboi.c:168)
==20072==  Address 0x7a41270 is 0 bytes inside a block of size 4 alloc'd
==20072==    at 0x402894D: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==20072==    by 0x404C52: allocate_array (array_allocator.c:66)
==20072==    by 0x40A0FC: allocate_item (item_allocator.c:62)
==20072==    by 0x42A4D2: optionalise_argument (argument_optionaliser.c:85)
==20072==    by 0x42A786: optionalise (optionaliser.c:107)
==20072==    by 0x401507: main (cyboi.c:168)
==20072== 
==20072== Invalid read of size 8
==20072==    at 0x40AF31: decode_utf_8 (utf_8_decoder.c:300)
==20072==    by 0x42A53D: optionalise_argument (argument_optionaliser.c:110)
==20072==    by 0x42A786: optionalise (optionaliser.c:107)
==20072==    by 0x401507: main (cyboi.c:168)
==20072==  Address 0x7a41270 is 0 bytes inside a block of size 4 alloc'd
==20072==    at 0x402894D: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==20072==    by 0x404C52: allocate_array (array_allocator.c:66)
==20072==    by 0x40A0FC: allocate_item (item_allocator.c:62)
==20072==    by 0x42A4D2: optionalise_argument (argument_optionaliser.c:85)
==20072==    by 0x42A786: optionalise (optionaliser.c:107)
==20072==    by 0x401507: main (cyboi.c:168)
==20072== 
==20072== 
==20072== HEAP SUMMARY:
==20072==     in use at exit: 0 bytes in 0 blocks
==20072==   total heap usage: 34 allocs, 34 frees, 8,232 bytes allocated
==20072== 
==20072== All heap blocks were freed -- no leaks are possible
==20072== 
==20072== For counts of detected and suppressed errors, rerun with: -v
==20072== ERROR SUMMARY: 2 errors from 2 contexts (suppressed: 4 from 4) 
```

运行软件如下：
christian@deneb:/home/project/cybop/examples$ ../src/controller/cyboi --knowledge ui_control/run.cybol

...产生这些错误：

> cyboi: malloc.c:3096: sSYSMALLOc: 断言`(old_top == (((mbinptr) (((char *) &((av)->bins[((1) - 1) * 2])) - __builtin_offsetof (struct malloc_chunk, fd)))) && old_size == 0) || ((unsigned long) (old_size)
> 
> > = (unsigned long)((((__builtin_offsetof (struct malloc_chunk, fd_nextsize))+((2 * (sizeof(size_t))) - 1)) & ~((2 * (sizeof(size_t))) - 1)) ) && ((old_top)->size & 0x1) && ((unsigned long)old_end & pagemask) == 0)' 失败。中止

任何帮助将非常感激。我真的不知道在哪个地方调试了。

源代码如下：

```
//
// cyboi.c
//

// The cybol knowledge file path item.
void* k = *NULL_POINTER_STATE_CYBOI_MODEL;

// Allocate cybol knowledge file path item.
allocate_item((void*) &k, (void*) NUMBER_0_INTEGER_STATE_CYBOI_MODEL, (void*) WIDE_CHARACTER_TEXT_STATE_CYBOI_TYPE);

// Optionalise command line argument options.
optionalise((void*) &m, k, (void*) LOG_LEVEL, (void*) LOG_OUTPUT, (void*) p1, (void*) &p0);

//
// optionaliser.c
//

while (*TRUE_BOOLEAN_STATE_CYBOI_MODEL) {

    compare_integer_greater_or_equal((void*) &b, (void*) &j, p5);

    if (b != *FALSE_BOOLEAN_STATE_CYBOI_MODEL) {

        break;
    }

    optionalise_argument(p0, p1, p2, p3, p4, p5, (void*) &j);

    // Increment loop variable.
    j++;
}

//
// argument_optionaliser.c
//

// The command line argument option as multibyte character array.
void* od = *NULL_POINTER_STATE_CYBOI_MODEL;
int oc = *NUMBER_0_INTEGER_STATE_CYBOI_MODEL;
// The option, value as wide character item.
void* ow = *NULL_POINTER_STATE_CYBOI_MODEL;
// The option, value as wide character item data, count.
void* owd = *NULL_POINTER_STATE_CYBOI_MODEL;
void* owc = *NULL_POINTER_STATE_CYBOI_MODEL;

// Allocate option, value wide character item.
allocate_item((void*) &ow, (void*) NUMBER_0_INTEGER_STATE_CYBOI_MODEL, (void*) WIDE_CHARACTER_TEXT_STATE_CYBOI_TYPE);

// Get command line argument option.
// Example: "--loglevel"
copy_array_forward((void*) &od, p4, (void*) POINTER_STATE_CYBOI_TYPE, (void*) PRIMITIVE_STATE_CYBOI_MODEL_COUNT, (void*) VALUE_PRIMITIVE_STATE_CYBOI_NAME, p6);

if (od != *NULL_POINTER_STATE_CYBOI_MODEL) {

    // Get command line argument option count (number of characters).
    oc = strlen((char*) od);

    // Decode multibyte character option into wide character.
    decode_utf_8(ow, od, (void*) &oc);

} else {

    log_write((void*) stdout, L"Error: Could not optionalise command line argument. The command line argument option is null.\n");
}

//
// utf_8_decoder.c
//

// The destination item data, count, size.
void* dd = *NULL_POINTER_STATE_CYBOI_MODEL;
void* dc = *NULL_POINTER_STATE_CYBOI_MODEL;
void* ds = *NULL_POINTER_STATE_CYBOI_MODEL;
// The new destination size.
int nds = *NUMBER_0_INTEGER_STATE_CYBOI_MODEL;

// Get destination item count, size.
copy_array_forward((void*) &dc, p0, (void*) POINTER_STATE_CYBOI_TYPE, (void*) PRIMITIVE_STATE_CYBOI_MODEL_COUNT, (void*) VALUE_PRIMITIVE_STATE_CYBOI_NAME, (void*) COUNT_ITEM_STATE_CYBOI_NAME);
copy_array_forward((void*) &ds, p0, (void*) POINTER_STATE_CYBOI_TYPE, (void*) PRIMITIVE_STATE_CYBOI_MODEL_COUNT, (void*) VALUE_PRIMITIVE_STATE_CYBOI_NAME, (void*) SIZE_ITEM_STATE_CYBOI_NAME);

// Initialise new destination size.
calculate_integer_add((void*) &nds, p2);

// Reallocate destination item.
reallocate_item(p0, (void*) &nds, (void*) WIDE_CHARACTER_TEXT_STATE_CYBOI_TYPE);

// Set locale.
// CAUTION! This setting IS NECESSARY for UTF-8 character conversion
// with restartable multibyte conversion functions like "mbsnrtowcs"
// and "wcsnrtombs" to work correctly.
// The return value is not used; this is a global setting.
char* loc = setlocale(LC_CTYPE, "");

// Get destination item data.
copy_array_forward((void*) &dd, p0, (void*) POINTER_STATE_CYBOI_TYPE, (void*) PRIMITIVE_STATE_CYBOI_MODEL_COUNT, (void*) VALUE_PRIMITIVE_STATE_CYBOI_NAME, (void*) DATA_ITEM_STATE_CYBOI_NAME);

// Initialise error number.
// It is a global variable/ function and other operations
// may have set some value that is not wanted here.
//
// CAUTION! Initialise the error number BEFORE calling the function
// that might cause an error.
errno = *NUMBER_0_INTEGER_STATE_CYBOI_MODEL;

// Converts the multibyte character string into a wide character string.
// Returns the number of wide characters
// successfully converted, except in the case of an encoding error.
//
// CAUTION! The multibyte source character string does NOT need to be
// null-terminated, since the third parametre already indicates its count.
//
// CAUTION! Hand over the NEW destination size as fourth parametre,
// since it indicates the maximum number of characters to be converted
// and conversion would break too early if that parametre was too small.
//
// CAUTION! The fifth parametre may be NULL. In this case, a static
// anonymous state only known to the function internally is used instead.
// It just indicates where conversion is started.
int n = mbsnrtowcs((wchar_t*) dd, (const char**) &sd, *((size_t*) sc), *((size_t*) ds), (mbstate_t*) *NULL_POINTER_STATE_CYBOI_MODEL);

if (n >= *NUMBER_0_INTEGER_STATE_CYBOI_MODEL) {

    // Set destination count to the number of WIDE characters converted.
    copy_integer(dc, (void*) &n);

} else {

    if (errno == EILSEQ) {

        fwprintf(stdout, L"TEST ERROR EILSEQ errno: %i\n", errno);
        log_message_terminated((void*) ERROR_LEVEL_LOG_CYBOI_MODEL, (void*) L"Could not decode utf-8\. The input string contains an invalid multibyte sequence.");

    } else {

        fwprintf(stdout, L"TEST ERROR UNKNOWN errno: %i\n", errno);
        log_message_terminated((void*) ERROR_LEVEL_LOG_CYBOI_MODEL, (void*) L"Could not decode utf-8\. An unknown error occured.");
    }
}

//
// item_allocator.c
//

/**
 * Allocates the item.
 *
 * @param p0 the item (pointer reference)
 * @param p1 the size
 * @param p2 the type
 */
void allocate_item(void* p0, void* p1, void* p2) {

    if (p0 != *NULL_POINTER_STATE_CYBOI_MODEL) {

        void** i = (void**) p0;

        log_message_terminated((void*) DEBUG_LEVEL_LOG_CYBOI_MODEL, (void*) L"Allocate item.");

        // Allocate item.
        allocate_array(p0, (void*) ITEM_STATE_CYBOI_MODEL_COUNT, (void*) POINTER_STATE_CYBOI_TYPE);

        // The data, count, size.
        void* d = *NULL_POINTER_STATE_CYBOI_MODEL;
        void* c = *NULL_POINTER_STATE_CYBOI_MODEL;
        void* s = *NULL_POINTER_STATE_CYBOI_MODEL;

        // Allocate data, count, size.
        allocate_array((void*) &d, p1, p2);
        allocate_array((void*) &c, (void*) PRIMITIVE_STATE_CYBOI_MODEL_COUNT, (void*) INTEGER_NUMBER_STATE_CYBOI_TYPE);
        allocate_array((void*) &s, (void*) PRIMITIVE_STATE_CYBOI_MODEL_COUNT, (void*) INTEGER_NUMBER_STATE_CYBOI_TYPE);

        // Initialise count, size.
        // The data does NOT have to be initialised and remains empty.
        // The count is set to zero, since the model does not contain any elements yet.
        // The size is set to the value that was handed over as argument.
        copy_integer(c, (void*) NUMBER_0_INTEGER_STATE_CYBOI_MODEL);
        copy_integer(s, p1);

        // Set data, count, size.
        copy_array_forward(*i, (void*) &d, (void*) POINTER_STATE_CYBOI_TYPE, (void*) PRIMITIVE_STATE_CYBOI_MODEL_COUNT, (void*) DATA_ITEM_STATE_CYBOI_NAME, (void*) VALUE_PRIMITIVE_STATE_CYBOI_NAME);
        copy_array_forward(*i, (void*) &c, (void*) POINTER_STATE_CYBOI_TYPE, (void*) PRIMITIVE_STATE_CYBOI_MODEL_COUNT, (void*) COUNT_ITEM_STATE_CYBOI_NAME, (void*) VALUE_PRIMITIVE_STATE_CYBOI_NAME);
        copy_array_forward(*i, (void*) &s, (void*) POINTER_STATE_CYBOI_TYPE, (void*) PRIMITIVE_STATE_CYBOI_MODEL_COUNT, (void*) SIZE_ITEM_STATE_CYBOI_NAME, (void*) VALUE_PRIMITIVE_STATE_CYBOI_NAME);

    } else {

        log_message_terminated((void*) ERROR_LEVEL_LOG_CYBOI_MODEL, (void*) L"Could not allocate item. The item is null.");
    }
}

//
// array_allocator.c
//

/**
 * Allocates the array.
 *
 * @param p0 the array (pointer reference)
 * @param p1 the size
 * @param p2 the type
 */
void allocate_array(void* p0, void* p1, void* p2) {

    if (p0 != *NULL_POINTER_STATE_CYBOI_MODEL) {

        void** a = (void**) p0;

        log_message_terminated((void*) DEBUG_LEVEL_LOG_CYBOI_MODEL, (void*) L"Allocate array.");

        // The memory area.
        size_t ma = *NUMBER_0_INTEGER_STATE_CYBOI_MODEL;

        // Determine type (type) size.
        determine_size((void*) &ma, p2);

        // Calculate memory area.
        calculate_integer_multiply((void*) &ma, p1);

        // A minimal space in memory is always allocated,
        // even if the requested size is zero.
        // In other words, a handle to the new instance is always returned.
        *a = malloc(ma);

        // Initialise array elements with null pointer.
        //
        // CAUTION! Initialising with zero is essential, since cyboi
        // frequently tests variables for null pointer values.
        memset(*a, *NUMBER_0_INTEGER_STATE_CYBOI_MODEL, ma);

    } else {

        log_message_terminated((void*) ERROR_LEVEL_LOG_CYBOI_MODEL, (void*) L"Could not allocate array. The array is null.");
    }
}

//
// size_determiner.c
//

/**
 * Determines the size of the given type.
 *
 * @param p0 the size
 * @param p1 the type
 */
void determine_size(void* p0, void* p1) {

    if (p1 != *NULL_POINTER_STATE_CYBOI_MODEL) {

        int* t = (int*) p1;

        // CAUTION! Do NOT call the logger here.
        // It uses functions causing circular references.
        // log_message_terminated((void*) DEBUG_LEVEL_LOG_CYBOI_MODEL, (void*) L"Determine size.");

        //
        // datetime
        //

        if (*t == *DATETIME_STATE_CYBOI_TYPE) {

            // CAUTION! This type IS NEEDED, e.g. when DEEP copying a part.
            // It is actually a pointer array, of which each
            // pointer references a structure element.
            copy_integer(p0, (void*) POINTER_TYPE_SIZE);

        //
        // element
        //

        } else if (*t == *PART_ELEMENT_STATE_CYBOI_TYPE) {

            // CAUTION! This type IS NEEDED, e.g. when DEEP copying a part
            // or when setting the references of a part
            // for rubbish (garbage) collection.
            // It is actually a pointer array, of which each
            // pointer references a structure element.
            copy_integer(p0, (void*) POINTER_TYPE_SIZE);

        //
        // logicvalue
        //

        } else if (*t == *BOOLEAN_LOGICVALUE_STATE_CYBOI_TYPE) {

            copy_integer(p0, (void*) SIGNED_INTEGER_INTEGRAL_TYPE_SIZE);

        //
        // number
        //

        } else if (*t == *COMPLEX_NUMBER_STATE_CYBOI_TYPE) {

            // CAUTION! This type IS NEEDED, e.g. when DEEP copying a part.
            // It is actually a pointer array, of which each
            // pointer references a structure element.
            copy_integer(p0, (void*) POINTER_TYPE_SIZE);

        } else if (*t == *DOUBLE_NUMBER_STATE_CYBOI_TYPE) {

            copy_integer(p0, (void*) DOUBLE_REAL_TYPE_SIZE);

        } else if (*t == *FRACTION_NUMBER_STATE_CYBOI_TYPE) {

            // CAUTION! This type IS NEEDED, e.g. when DEEP copying a part.
            // It is actually a pointer array, of which each
            // pointer references a structure element.
            copy_integer(p0, (void*) POINTER_TYPE_SIZE);

        } else if (*t == *INTEGER_NUMBER_STATE_CYBOI_TYPE) {

            copy_integer(p0, (void*) SIGNED_INTEGER_INTEGRAL_TYPE_SIZE);

        } else if (*t == *UNSIGNED_LONG_NUMBER_STATE_CYBOI_TYPE) {

            copy_integer(p0, (void*) UNSIGNED_LONG_INTEGER_INTEGRAL_TYPE_SIZE);

        //
        // pointer
        //

        } else if (*t == *POINTER_STATE_CYBOI_TYPE) {

            copy_integer(p0, (void*) POINTER_TYPE_SIZE);

        //
        // text
        //

        } else if (*t == *CHARACTER_TEXT_STATE_CYBOI_TYPE) {

            copy_integer(p0, (void*) SIGNED_CHARACTER_INTEGRAL_TYPE_SIZE);

        } else if (*t == *WIDE_CHARACTER_TEXT_STATE_CYBOI_TYPE) {

            copy_integer(p0, (void*) WIDE_CHARACTER_INTEGRAL_TYPE_SIZE);

        } else {

            // CAUTION! Do NOT call the logger here.
            // It uses functions causing circular references.
            // log_message_terminated((void*) WARNING_LEVEL_LOG_CYBOI_MODEL, (void*) L"Could not determine size. The type is unknown.");
        }

    } else {

        // CAUTION! Do NOT call the logger here.
        // It uses functions causing circular references.
        // log_message_terminated((void*) ERROR_LEVEL_LOG_CYBOI_MODEL, (void*) L"Could not determine size. The type is null.");
    }
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-02T22:30:34.500

在 utf_8_decoder.c 的第 201 行，你有

```
fwprintf(stdout, L"TEST decoder *ds: %i\n", *((int*) ds)); 
```

所以你把`ds`它当作一个`int*`并且效果很好。但是在 valgrind 指示的第 298 和 300 行，

```
fwprintf(stdout, L"TEST decoder *ds pre mbsnrtowcs as size_t: %i\n", *((size_t*) ds));

int n = mbsnrtowcs((wchar_t*) dd, (const char**) &sd, *((size_t*) sc), *((size_t*) ds), (mbstate_t*) *NULL_POINTER_STATE_CYBOI_MODEL); 
```

你把`ds`它当作一个`size_t*`. An`int`通常有四个字节，但`size_t`在任何自尊的 64 位系统上 a 有八个字节。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-02T22:29:38.700

该例程`decode_utf_8`试图在您仅分配 4 个字节的位置读取 8 个字节。由于您还说这只发生在 64 位机器上并且在 32 位机器上工作正常，这表明您对某处整数或指针类型的大小。你没有给我们看`decode_utf_8`，所以说更多的东西纯粹是猜测。

# regex - 在 python 正则表达式的集合中使用 *

> ID：10866316
> 
> 赞同：4
> 
> 时间：2012-06-02T22:09:43.927
> 
> 标签：regex, python-3.x

在 python 3.2.2 中，当我尝试在正则表达式模式中使用 * 时遇到了奇怪的错误。当* stads 之后/ 一切正常。但是当我尝试从模式中删除 / 时，此代码会出现错误：**sre_constants.error: bad character range**

```
import re
foo = re.search("[^123+-/*]", "123+-/*w")
if foo:
    print("foo")
else:
    print("doo") 
```

在 python 文档中，我发现使用 * 是可以接受的，没有任何反斜杠或其他东西。然而，这样的代码问题仍然存在。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-02T22:14:53.720

您的问题不是`*`，而是连字符减号，它表示字符类中的范围，在这种情况下，所有字符都介于`+`( `/`)`+,-./`之间。出现无效范围是因为`*`出现*在 之前* `/`。

如果要在字符类中包含文字连字符，则必须对其进行转义或将其放在末尾或开头：

```
[^123+/*-] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-02T22:15:31.893

减号导致最后一个字符被解释为字符范围。`[+-/]`acutally 表示“任何一个`+,-./`”（参见 ASCII 表）。当您替换`/`by`*`时，您正在创建无效范围`[+-*]`，因为星号 42 的 ASCII 代码小于加号 43 的 ASCII 代码。

解决方案只是逃避减号（然后它不再是一个范围）。

# sql-server - 引用代理键

> ID：10866317
> 
> 赞同：2
> 
> 时间：2012-06-02T22:09:59.910
> 
> 标签：sql-server, database, foreign-keys

我有一个具有自动增量代理键的表。我想用它作为我另一个表的外键。问题是，我不知道如何将它引用到该表，因为几乎不可能确定我必须引用什么（代理键的实际值）。

请注意，我要做的是通过我的程序（在 dbms 之外）添加一个元组/记录。过程是：

1.  在 Table1 中添加一条新记录并生成一个自增键。更新

2.  在 Table2 中添加一条新记录，并将其外键引用到 Table1 的主键。更新

我的问题是：如果我不知道外键是什么，我该如何存储它？

**编辑：**

很抱歉没有指定数据库和冗长的回复。我使用微软的 sql 服务器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-02T22:23:08.317

由于您没有提到数据库软件的名称，并且您的问题似乎不是如何声明代理键，您可以：

1.  将表 1 中的表 2 的外键设置为可为空，以便在确定表 2 中记录的键后对其进行更新。
2.  先保存表 2 中的记录，然后将引用新保存的表 2 记录的表 1 中的记录保存。这样，您不必将表 1 中的表 2 的外键声明为可为空，并且会是执行此操作的首选方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-02T22:30:21.433

如果您的 DBMS 支持序列（大多数现代 DBMS 支持），只需为 table1 生成 PK 值，然后使用 DBMS 的“currval”功能引用该 FK 值。

类似于（PostgreSQL 语法，但其他支持 DBMS 的序列具有非常相似的功能）：

```
INSERT INTO table1 (id, col1, col2) 
VALUES (nextval('id_sequence'), 'foo', 'bar');

INSERT INTO table2 (t1_id, col1)
VALUES (currval('id_sequence'), 'foobar'); 
```

另一种选择是简单地获取程序中的 ID 值，然后在两个插入中使用该值。

如果您必须处理不支持序列的 DBMS（例如 2012 年之前的 MySQL 或 SQL Server），通常有一个函数（例如`@@IDENTITY`SQL Server）可以让您在第二个 INSERT 语句中引用 table1 生成的 ID 值（而不是的currval呼叫）

# matlab - 在 Matlab 中使用 Bar 符号显示值的平均值

> ID：10866323
> 
> 赞同：1
> 
> 时间：2012-06-02T22:11:13.230
> 
> 标签：matlab, plot, label

我想使用条形符号（变量上方的一条线）来显示变量的平均值。我找到了这段代码：

```
plot(randn(100,1)); 
ylabel('$\bar{ABCDEFG}-T5$','interpreter','latex') 
```

但这条线很小。有没有办法使它与变量的长度相同？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-02T22:16:31.607

怎么样：

```
ylabel('$\overline{ABCDEFG}-T5$', 'interpreter','latex') 
```

![截屏](../Images/213299e51fe61c58a00a5788adae3c1b.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-02T22:30:39.773

我发现在传说中使用它我们应该说

```
legend({'$\overline{ABCDEFG}-T5$'},'interpreter','latex'); 
```

# codeigniter - 如何保存用户语言

> ID：10866325
> 
> 赞同：0
> 
> 时间：2012-06-02T22:11:31.797
> 
> 标签：codeigniter, session, session-timeout

我将用户语言选择保存到这样的会话中：

```
$this->session->set_userdata('language', $language); 
```

然后我根据会话数据设置语言（并将 English 作为默认语言）。

```
if ( !$language = $CI->session->userdata('language') )
{
    $language = "english";
}

$CI->config->set_item('language', $language); 
```

它运作良好，但用户选择的语言仅持续约。2 小时 - 然后用户必须再次选择语言。所以问题是，我怎样才能延长会话时间以过期（或仅在用户清理浏览器数据的情况下使其过期）。我无法将用户选择保存在数据库中，因为我还需要处理我网站上的访客。

我知道我可以在 CI 的配置中延长会话时间，但我只希望它仅在语言选择的情况下发生，而不是例如帐户会话。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-02T22:17:09.423

这是同一个会话，它要么过期，要么不过期。您不能让身份验证部分过期，但不能让语言选择过期。CI 无法轻松管理多个会话，这使得将身份验证存储在一个短期会话中并将语言偏好存储在一个长期会话中成为可能。事实上，将语言偏好直接存储在 cookie 中可能更容易；请记住，您必须在每个请求上再次设置 cookie，否则即使用户正在积极使用该网站，它也不会在用户活动时自动刷新并且会过期。

# macos - Mac OS X Lion 上的 FreeGLUT

> ID：10866331
> 
> 赞同：12
> 
> 时间：2012-06-02T22:12:25.460
> 
> 标签：macos, opengl, freeglut

一些上下文：我正在阅读有关使用 OpenGL的[教程。](http://openglbook.com/)本教程需要几个库才能工作。其中一个库是 FreeGLUT。我在 OS X 上使用 Lion。

我已经下载了 FreeGLUT 并按照安装[说明](http://freeglut.sourceforge.net/docs/install.php)进行操作，但是当我运行“make all”命令时出现此错误：

```
error: GL/gl.h: No such file or directory
error: GL/glu.h: No such file or directory 
```

我已经在互联网上搜索了一个解决方案，我能从中了解到的是编译器在定位这些文件时遇到了问题，并且编译器使用的路径需要更改。

**编辑：**好的，我发现它不是编译器，而是由于某种原因这些文件不存在。去尝试找出他们为什么不在那里。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-06-02T22:28:05.600

在 Mac 上，这些头文件的位置与 Linux 上的不同。所以在代码中，替换这个：

```
#include <GL/gl.h>
#include <GL/glu.h> 
```

有了这个：

```
#include <OpenGL/gl.h>
#include <OpenGL/glu.h> 
```

那应该可以解决您的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T05:02:04.303

该教程 OpenGLBook.com 基于 OpenGL 4.0 核心上下文，并以 3.3 核心上下文作为替代方案。充其量在 OS X（使用 Mountain Lion）上，您将获得与 3.3 足够相似的 3.2 核心上下文 - 但不幸的是，这与 GLUT 不兼容 - OS X 包括原始的 GLUT（由于许可问题未修改），这需要很多在 3.2 核心上下文中不可用的过时 OpenGL 函数。

如果您想在 OS X（10.6.3 或更高版本）上完成本教程，而无需处理许多烦人的不兼容问题，并且使用面向未来的 OpenGL，我建议安装最新版本的 XQuartz（2.7.2 或更高版本），它包括 FreeGLUT（从 2.8.0 开始）。

[https://dl.bintray.com/xquartz/downloads/XQuartz-2.7.11.dmg](https://dl.bintray.com/xquartz/downloads/XQuartz-2.7.11.dmg)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-01T13:21:56.513

install freeglut via macports, modify premake4.lua so that it builds the Unofficial OpenGL SDK in the glsdk apart from freeglut. manually copy and paste the lib and include folders of the freeglut (via macports) and modify #include_GL/freeglut.h> inside framework.cpp (framework folder) so that it finds the header. also fill the blanks in folder names, e.g. Tut 13 Impostors -> Tut_13_Impostors

it works for me

more details [here](https://stackoverflow.com/questions/12229211/issues-with-freeglut-on-mac-os-snow-leopard-it-builds-fine-via-macports/12283617#12283617)

# android - Android：如何使用加速度计旋转我的位图？

> ID：10866333
> 
> 赞同：0
> 
> 时间：2012-06-02T22:12:29.867
> 
> 标签：android, bitmap, accelerometer, image-rotation

我想旋转我的位图 img，它是使用一个加速度计轴的汽车转向。我不知道如何将它与矩阵一起使用或在其他类中调用 sensorchanged 方法。我的应用程序处于横向模式，我有两个类，一个用于传感器，一个用于位图。我完全迷路了。

```
 public class CustomDrawableView extends View {

    AnimationSteeringActivity sens = new AnimationSteeringActivity();

    public CustomDrawableView(Context context) {
        // TODO Auto-generated constructor stub

        super(context);

    }

    @Override
    public void onDraw(Canvas canvas) {
        Bitmap bmp = BitmapFactory.decodeResource(getResources(),
                R.drawable.steering);

        int canvasWidth = canvas.getWidth();
        int canvasHeight = canvas.getHeight();
        int bitmapWidth = bmp.getWidth();
        int bitmapHeight = bmp.getHeight();

        int centreX = (canvasWidth - bitmapWidth) / 2;

        int centreY = (canvasWidth - bitmapHeight) / 2;

        canvas.drawColor(Color.WHITE);

        canvas.drawBitmap(bmp, centreX, centreY, null); 
```

和

```
public class AnimationSteeringActivity extends Activity implements
    SensorEventListener {
/** Called when the activity is first created. */

/** Called when the activity is first created. */
CustomDrawableView mCustomDrawableView = null;
ShapeDrawable mDrawable = new ShapeDrawable();
public static int x;
public static int y;

private SensorManager sensorManager = null;

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {

    super.onCreate(savedInstanceState);
    // Get a reference to a SensorManager
    sensorManager = (SensorManager) getSystemService(SENSOR_SERVICE);
    mCustomDrawableView = new CustomDrawableView(this);
    setContentView(mCustomDrawableView);
    // setContentView(R.layout.main);

}

// This method will update the UI on new sensor events
public void onSensorChanged(SensorEvent sensorEvent) {
    {
        if (sensorEvent.sensor.getType() == Sensor.TYPE_ACCELEROMETER) {
            // the values you were calculating originally here were over
            // 10000!
            x = (int) Math.pow(sensorEvent.values[1], 2);
            y = (int) Math.pow(sensorEvent.values[2], 2);

        }

        if (sensorEvent.sensor.getType() == Sensor.TYPE_ORIENTATION) {

        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-03T00:30:21.263

在此链接上寻找实际旋转

[旋转位图](http://eventuallyconsistent.net/2011/07/21/rotating-a-bitmap-in-android/)

因此，在 onSensorChanged 方法中，您将根据需要使用所需的 x 或 y 值进行旋转

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T07:14:32.453

```
Bitmap myBitmap = BitmapFactory.decodeStream(downloadImageFromWeb());

Bitmap myBitmap = BitmapFactory.decodeResource(getResources(), R.drawable.android1);

Display d = getWindowManager().getDefaultDisplay();

int x = d.getWidth();

int y = d.getHeight();

ImageView img1 = (ImageView)findViewById(R.id.img1);

Bitmap scaledBitmap = Bitmap.createScaledBitmap(myBitmap, y, x, true);

Matrix matrix = new Matrix();

matrix.postRotate(-90);

Bitmap rotatedBitmap = Bitmap.createBitmap(scaledBitmap , 0, 0, scaledBitmap .getWidth(), scaledBitmap .getHeight(), matrix, true);

img1.setImageBitmap(rotatedBitmap); 
```

# facebook - 使用 facebook 好友列表开发新应用

> ID：10866336
> 
> 赞同：0
> 
> 时间：2012-06-02T22:12:51.880
> 
> 标签：facebook

我正在考虑开发一个可以利用 Facebook 的应用程序并有一个问题。为了让应用程序正常工作，它不仅需要访问用户的好友列表，还需要访问用户好友的好友列表等。它只会访问也注册了该应用程序的用户。提前感谢萨米

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-02T22:30:25.407

你的问题是……？:-) 如果你想知道是否有可能获得这些信息——好吧，只要朋友们授权了你的应用程序，应该没有问题，即使超过几个“级别”的朋友。

# python - 在多个端口上运行 Reactor.run

> ID：10866343
> 
> 赞同：1
> 
> 时间：2012-06-02T22:13:55.420
> 
> 标签：python, twisted

我有以下代码。我试图让反应堆在从 1025 + NUM_TABLES 开始的端口上运行。问题是当我在循环中调用 reactor.run() 时，循环会冻结。当它被注释时，循环从 0 计数到 9，但是当它被取消注释时，它只打印 0。

```
NUM_TABLES = 10

factories = [ ]
for i in range(0, NUM_TABLES):
    print i
    factory = Factory()
    factory.protocol = Socket
    factory.clients = []
    factories.append(factory)
    reactor.listenTCP(1025+i, factory)
    #print "Blackjack server started"
    reactor.run() 
```

在不同的港口经营新工厂需要什么？为什么反应堆停在0？以前有效，为什么现在无效？谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-02T22:17:46.837

`reactor.run()`在创建并注册所有听众之前不要打电话。这应该是您直接从主脚本中进行的最后一次调用；之后的一切都是回调。

为了澄清，只需将最后一行取消缩进一级。

# css - 两列 html，如何移动列？

> ID：10866345
> 
> 赞同：1
> 
> 时间：2012-06-02T22:14:01.747
> 
> 标签：css, html, stylesheet

我有两列，左右浮动，如下所示：

```
<div style="float: left;">
text1
</div>
<div style="float: right;">
text 2
</div> 
```

但是我怎样才能将右列向左移动一点？用“填充”？如何？

或者如果我使用它，我怎样才能将右侧的列向右移动一点？

```
<div style="float: left;">
text1
</div>
<div style="float: left;">
text 2
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-02T22:16:31.420

您可以更改 css 样式来尝试以下操作

```
<div style="float: left; position: relative; left: 30px"> 
```

这会将定位更改为相对，然后您根据其原始位置移动框。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-02T22:19:00.457

你可以试试这个：

```
<div style="float:left; padding-right:-30px;"> 
```

或者

```
<div style="float:left; padding-right:30px;"> 
```

希望能帮助到你！

# iphone - 返回方法对象 c 的释放对象

> ID：10866352
> 
> 赞同：0
> 
> 时间：2012-06-02T22:15:45.670
> 
> 标签：iphone, ios, memory-leaks

在使用分析构建运行应用程序时，Xcode 发现我有很多内存泄漏，特别是有一个我不知道如何解决它：

```
- (UIView *) tableView:(UITableView *)tableView 
viewForHeaderInSection:(NSInteger)section {

UIImageView *sectionImage = [[UIImageView alloc] init];
if (section == 0)sectionImage.image = [UIImage imageNamed:@"myImage.png"];

return sectionImage;
} 
```

所以我的问题是，我怎样才能发布这个sectionImage？if 是方法的返回？

**编辑：**

我有另一个问题，分析给我另一个内存泄漏，我有这个：

.h @property (nonatomic, 保留) NSIndexPath *directCellPath;

.m

@synthesize directCellPath = _directCellPath;

```
- (id)init{
if ((self = [super initWithNibName:@"MyViewController" bundle:nil])) {

    self.directCellPath = [[NSIndexPath alloc] init];

}
return self;
} 
```

然后在代码中我使用它，最后在 dealloc 中我这样做：

```
- (void)dealloc {

[_directCellPath release];

[super dealloc];
} 
```

并在这条线上给我一个内存泄漏：

```
self.directCellPath = [[NSIndexPath alloc] init]; 
```

为什么如果我在 dealloc 中释放了它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-02T22:17:42.300

你必须使用这样的自动释放

UIImageView *sectionImage = [[[UIImageView alloc] init] autorelease];

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-02T22:36:24.763

为了回答您的第二个问题，您发布了`_directCellPath`，而不是`directCellPath`。它们是有区别的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-02T22:50:05.467

你必须这样做

```
@synthesize directCellPath 
```

和这个

```
 - (void)dealloc 
{

self.directCellPath = nil;

[directCellPath release];
[super dealloc];

} 
```

# ajax - 下拉菜单表单我想添加链接以使用我的 ajax 脚本？

> ID：10866354
> 
> 赞同：-2
> 
> 时间：2012-06-02T22:15:51.287
> 
> 标签：ajax, drop-down-menu

我的网站是：[http ://server1.bioprotege-inc.net/permanent_Files/digichat_admin_panel/#Home](http://server1.bioprotege-inc.net/permanent_Files/digichat_admin_panel/#Home)

显示“主页”的链接会下拉我指定 id 喜欢做什么但无法开始工作的内容是使用下拉菜单上的选项之一来删除与主页链接相同的内容，但我无法得到它像那样工作和建议？

```
// JavaScript Document

$(document).ready(function(){

    $("#Home").click(function(){
                Load_ajax_page("Content_Files/Home.html");
    });

    $("#Chat").click(function(){
                Load_ajax_page("Content_Files/Chat.html");
    });

    $("#Rules_List").click(function(){
                Load_ajax_page("Content_Files/Rules_List.html");
    });

    $("#The_Team").click(function(){
                Load_ajax_page("Content_Files/The_Team.html");
    });

    $("#Forums").click(function(){
                Load_ajax_page("Content_Files/Forums.html");
    });

});

function Load_ajax_page(url){

    //this is a jquery method to make a ajax request
    $.post(url,"",function (data){
        //this is the place where the data is returned by the request
        //remove loading and add the data
        $("#response").html(data);
    });

}

HTML CODE NOW FOR DROPDOWN MENU:

<form onclick="">
<select onchange="window.open(this.options[this.selectedIndex].value,'_top')" style="width:582px; height:25px;">
<option value="#">Enter Free Hosted Sites:</option>
<option value="#"></option>
<option value="#Home">Hosted1 - Shadow Hunters</option>
<option value="http://www.google.com">Hosted2</option>
<option>Hosted3</option>
<option>Hosted4</option>
</select>
</form>

<br />

<div id="response"></div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-02T23:44:35.597

您可以使用以下代码：

```
<script type="text/javascript">
try{
xmlhttp = new XMLHttpRequest();
}
catch(ee){
try{
xmlhttp = new ActiveXObject("Msxml2.XMLHTTP");
}
catch(e){
try{
xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
}
catch(E){
xmlhttp = false;
}
}
}
div_base = "";
valor = 0;
function abre(arquivo,metodo,div){
div_base = div;
valor++;
xmlhttp.open(metodo,arquivo+"?valor="+valor);
xmlhttp.onreadystatechange=response
xmlhttp.send(null)
}
function response() {
nova_div = div_base;
document.getElementById(nova_div).innerHTML="<div style='top:50%;left:50%;position:absolute;'>Loading...</div>"
if (xmlhttp.readyState==4){
document.getElementById(nova_div).innerHTML=xmlhttp.responseText
}
}
</script>

<form>
<select name="menu">
<option onclick="javascript: abre('Content_Files/Home.html','GET','response');">Home</option>
<option onclick="javascript: abre('Content_Files/Chat.html','GET','response');">Chat</option>
<option onclick="javascript: abre('Content_Files/Rules_List.html','GET','response');">Rules_List</option>
<option onclick="javascript: abre('Content_Files/The_Team.html','GET','response');">The_Team</option>
<option onclick="javascript: abre('Content_Files/Forums.html','GET','response');">Forums</option>
</select>
</form>
<br /><br />
<div id="response"></div> 
```

# c# - 如何在 C# 中为 ID3 标签编码字符串

> ID：10866358
> 
> 赞同：1
> 
> 时间：2012-06-02T22:16:22.387
> 
> 标签：c#, encoding, id3

我在 ID3 标签中编码时遇到问题。我查询一个 web 服务，它返回一些 XML，包括一个节点，如下所示：

```
<name>Blue Öyster Cult</name> 
```

然后我使用这些信息来更新我的 ID3 标签。问题是标签被更新为：

```
Blue Ã–yster Cult 
```

我知道这是一个编码问题，但我正在努力弄清楚如何让它工作。我的理解是 ID3 标签需要编码为 ISO-8859-1。

我写了这段代码，但没有区别：

```
Encoding newEncoding = Encoding.GetEncoding("ISO-8859-1");
Encoding utf8 = Encoding.UTF8;
byte[] utfBytes = Encoding.UTF8.GetBytes(newArtistName);
byte[] asciBytes = Encoding.Convert(utf8, newEncoding, utfBytes);
string encodedArtistName = newEncoding.GetString(asciBytes); 
```

这是在正确的方向吗？

非常感谢任何建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-02T22:21:12.987

# ID3 v2

文本帧用编码字节标记。

```
$00 – ISO-8859-1 (ASCII).
$01 – UCS-2 (UTF-16 encoded Unicode with BOM), in ID3v2.2 and ID3v2.3.
$02 – UTF-16BE encoded Unicode without BOM, in ID3v2.4.
$03 – UTF-8 encoded Unicode, in ID3v2.4. 
```

详细规范可以在[http://id3.org/id3v2-00](http://id3.org/id3v2-00)找到。

* * *

另请参阅[查看/编辑 MP3 文件的 ID3 数据](https://stackoverflow.com/questions/68283/view-edit-id3-data-for-mp3-files)- 发布类似问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-03T11:52:41.900

我遇到的问题实际上是在保存到 ID3 标签之前。我收到的 XML 设置为 UTF-8，但请求页面的 WebClient 没有。添加此处显示的第二行解决了该问题。

```
WebClient client = new WebClient();    
client.Encoding = Encoding.UTF8;
String htmlCode = client.DownloadString(requestURL); 
```

当从这个 XML 中提取值时，它具有正确的编码以保存到文件 ID3 标记中。

# c# - 如何编写 php 脚本来更新文件列表？

> ID：10866364
> 
> 赞同：-3
> 
> 时间：2012-06-02T22:17:01.963
> 
> 标签：c#, php

我有一个程序可以从我的网站更新一些文件，我做了所有的工作，但我在 update.php 脚本中有问题

我的应用程序端更新代码是（在 C# 中）：

```
 public string[] NeededFiles = { "teknomw3.dll" };
    public string HomePageUrl = "http://se7enclan.ir";
    public string NewsUrl = "http://se7enclan.ir/news";
    public string DownloadUrl = "http://se7enclan.ir/";
    public string UpdateList = "http://se7enclan.ir/update.php?action=list";
    public string UpdateBaseUrl = "http://se7enclan.ir/Update/"; 
```

如您所见，以及我网站上的更新目录（所有文件都在这里。）：

[http://se7enclan.ir/Update/](http://se7enclan.ir/Update/)

所以我可以在update.php中使用什么脚本：“update.php?action=list”

这个 update.php 脚本必须像这个网站一样工作： [http ://mw3luncher.netai.net/update.php?action=list](http://mw3luncher.netai.net/update.php?action=list)

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-02T22:47:49.647

我理解你的问题人。这是一个解决方案：

```
<?PHP
  function getFileList($dir)
  {
    // array to hold return value
    $retval = array();

    // add trailing slash if missing
    if(substr($dir, -1) != "/") $dir .= "/";

    // open pointer to directory and read list of files
    $d = @dir($dir) or die("getFileList: Failed opening directory $dir for reading");
    while(false !== ($entry = $d->read())) {
      // skip hidden files
      if($entry[0] == ".") continue;
      if(is_dir("$dir$entry")) {
        $retval[] = array(
          "name" => "$dir$entry/",
          "type" => filetype("$dir$entry"),
          "size" => 0,
          "lastmod" => filemtime("$dir$entry")
        );
      } elseif(is_readable("$dir$entry")) {
       $retval[] = array(
          "name" => "$dir$entry",
          "type" => mime_content_type("$dir$entry"),
          "size" => filesize("$dir$entry"),
          "lastmod" => filemtime("$dir$entry")
        );
      }
   }
    $d->close();

    return $retval;
  }
?> 
```

您可以按如下方式使用此功能：

```
<?PHP
  // examples for scanning the current directory
  $dirlist = getFileList(".");
  $dirlist = getFileList("./");
?> 
```

为了将结果输出到 HTML 页面，我们只需遍历返回的数组：

```
<?PHP
  // output file list as HTML table
  echo "<table border="1">\n";
  echo "<tr><th>Name</th><th>Type</th><th>Size</th><th>Last Mod.</th></tr>\n";
  foreach($dirlist as $file) {
    echo "<tr>\n";
    echo "<td>{$file['name']}</td>\n";
    echo "<td>{$file['type']}</td>\n";
    echo "<td>{$file['size']}</td>\n";
    echo "<td>",date('r', $file['lastmod']),"</td>\n";
    echo "</tr>\n";
  }
  echo "</table>\n\n";
?> 
```

希望能帮助到你！

# visual-studio-2010 - TFS 重新添加 Visual Studio 2010 项目

> ID：10866365
> 
> 赞同：0
> 
> 时间：2012-06-02T22:17:06.293
> 
> 标签：visual-studio-2010, version-control, tfs

我有一个使用 TFS 进行源代码控制的项目。不幸的是，我在笔记本电脑上进行了一些编码，不幸的是，我的计算机崩溃了，我最终不得不重新安装 Windows。我担心我所有的代码都会丢失，但幸运的是我能够恢复代码文件。

我的问题是现在我需要将更改提交到 TFS。目前，这些项目没有任何源绑定。我无法覆盖当前的代码库，因为自其他开发人员崩溃以来已经完成了一些工作。

如何添加对 TFS 所做的更改？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-02T22:30:27.683

我做这样的事情的方式有点骇人听闻，但我通常做的是从 TFS 获取最新信息到我的笔记本电脑上，然后检查相关项目中的所有代码。然后我将更改的代码复制到该文件夹​​中，将其签入。TFS 应该足够聪明，只真正影响已更改的实际代码项。您可以在历史记录中看到确实更改过的实际文件。

如果您知道需要更新的确切文件，那么这将使事情变得更容易，因为您可以执行上述步骤，然后只需检查您知道的特定文件。您可以将它们与您的新代码进行比较，以确保您不会覆盖其他程序员所做的任何事情。再次，hackish，但我不知道有任何简化的方法来做到这一点。

您可能需要确保下载 TFS Visual Studio 扩展，因为这将为您提供回滚功能。

# javascript - 可以依靠 javascript 进行菜单布局吗？

> ID：10866371
> 
> 赞同：2
> 
> 时间：2012-06-02T22:18:16.137
> 
> 标签：javascript, jquery, css, layout

我有一个网站模板，我不知道菜单项的数量或所需的菜单项的大小。下面的 js 完全按照我想要的方式工作，但是这是我写过的最多的 js。由于我是 js 初学者，我不知道这种方法有什么缺点或潜在问题吗？我目前正在为每个站点手动设置填充。谢谢！

```
var width_of_text = 0; 
var number_of_li = 0;

// measure the width of each <li> and add it to the total with, increment li counter
$('li').each(function() {
    width_of_text += $(this).width();
    number_of_li++;
});

// calculate the space between <li>'s so the space is equal
var padding = Math.floor((900 - width_of_text)/(number_of_li - 1));

// add the padding the all but the first <li>
$('li').each(function(index) {
    if (index !== 0)
    {
        $(this).css("padding-left", padding);
    }
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-02T22:39:52.573

您可以在 CSS 中使用`display: inline-block`, 和`text-align: justify`

```
<ul>
    <li>thing</li>
    <li>thing2</li>
    <li>thing3</li>
    <li>thing4</li>
    <li class="hack"></li>
</ul> 
```

进而：

```
ul { text-align: justify }
li { display: inline-block }
li.hack { width: 100% } /* force the justified text to wrap */ 
```

[演示](http://jsfiddle.net/JXmYD/)

​</p>

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-02T22:32:53.493

是的，使用 JS 进行格式化也有缺点。

强烈建议避免使用 JS 进行格式化和定位，尽可能使用 CSS。

Javascript 的解释和运行因浏览器而异，从操作系统到操作系统，从操作系统/浏览器版本到版本。

CSS 渲染是原生浏览器引擎功能，其渲染优先级高于 JS。

CSS 渲染比 JS 快得多。

等等。

你现在在做什么我永远不会建议这样做。恕我直言，这是一种非常错误的方法。在这种情况下，JS 绝对被滥用。你必须使用 CSS 来完成这个任务，我建议发布一个关于如何正确使用 CSS 来完成这个任务的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-02T22:34:10.177

我建议在它们之间设置一个默认间距，不会将它们推出容器。使它们能够平均分配空间的额外 javascript 应该只是一种增强。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-02T22:35:28.367

我认为你的问题的答案是，如果它有效，那么它有效（并将继续有效），但这并不意味着这是处理它的最佳方式。如果您*关心最好的方法，那么请研究如何主要（甚至完全）使用 CSS 来改进您的方法。如果您只是想完成工作，并且它正在发挥作用，那么您就可以开始了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-02T22:59:08.083

根据您的网站访问者，大约 3% 的访问者会在禁用 JS 的情况下访问您。并且您希望该网站为他们工作。也许不是站点中不重要的部分，但您希望关键部分正常工作。导航是网站最重要的部分之一。

确保导航在没有 JS 的情况下也能正常工作（不必像 JS 那样花哨），然后您可以使用 JS 进行一些改进。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-03T04:39:39.037

您不需要 JavaScript，只要您可以依赖一种使宽度适应其内容的 CSS 算法：**表格布局**算法 :)

有关示例，请参见我[之前的答案中的](https://stackoverflow.com/questions/10525744/css-table-cell-equal-width/10526275#10526275)[http://jsfiddle.net/r9yrM/1/ 。](http://jsfiddle.net/r9yrM/1/)

不要忘记在每个“单元格”上都有一个最小的填充，粘在边框上的文本不是很可读（而且很难看）。您可能还需要`text-align: center`单元格（最后的 CSS 规则）。

使用 JS，您可以决定选项卡的最大数量（或最小的“合理”宽度）以及高于（低于）该数量，在父级上添加一个类，该类将触发每个选项卡呈现为`float: left`和`block`不再呈现`table-cell`。然后它将占据 2 行或更多行（如Firefox 上的扩展*Tab Mix Plus ）*

注意：table 至少有 2 种算法：with 和 without `table-layout: fixed`，这取决于在适应时留给浏览器的自由度。

请注意上面的 jQuery 代码：“除第一个之外的每个 li”可以表示为`$('li + li')`（第一个前面没有 a `li`）

# .htaccess - 使用 .htaccess/RewriteCond 专门匹配字符串中的多个单词

> ID：10866372
> 
> 赞同：0
> 
> 时间：2012-06-02T22:18:28.740
> 
> 标签：.htaccess, mod-rewrite

（我尽我所能用我的帖子标题，但它可能无法正确解释我的问题。）

为简单起见，假设我要定位的 3 个用户代理字符串是：

```
Blue V1.0 | Red V1.0 Lite | Green V1.0 
```

我可以用这个重写条件来做到这一点：

```
RewriteCond %{HTTP_USER_AGENT} "blue|red|green" [NC] 
```

但我只想匹配“红色”用户代理，如果它稍后在字符串中**还包含单词“Lite”。**如果用户代理包含“Red”，但不包含“Lite”，我想忽略它。

我希望我可以使用这样的东西：

```
RewriteCond %{HTTP_USER_AGENT} "blue|red+lite|green" [NC] 
```

这可能吗？谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-04T19:46:43.097

```
RewriteCond %{HTTP_USER_AGENT} "blue|red.*lite|green" [NC] 
```

`red`仅当它**后跟**.时才会匹配`lite`。

# oracle - 带有重音符号的 Oracle 查询

> ID：10866376
> 
> 赞同：1
> 
> 时间：2012-06-02T22:19:19.263
> 
> 标签：oracle

这是我的问题，我有一个 ISO-8859-1 的数据库，我的网页是 UTF-8，我想从我的查询中删除重音我能够找到没有重音的名字，但如果他们有他们我'我找不到他们（在下面我有一个带口音的名字，我找不到名字）求救，我快死了……我有这个：

```
$el=array();     //<----------------------------------------------------vowels to remove
$el[]=iconv('UTF-8','ISO-8859-1','á');
$el[]=iconv('UTF-8','ISO-8859-1','é');
$el[]=iconv('UTF-8','ISO-8859-1','í');
$el[]=iconv('UTF-8','ISO-8859-1','ó');
$el[]=iconv('UTF-8','ISO-8859-1','ú'); 

$string='Francisco Gutiérrez';      //<----------------------------------------target

$string=strtolower($string);     ///<----------------------------------string to iso 
$string=iconv('UTF-8','ISO-8859-1',
                    $string);

$tem3="SELECT  nom||' '||app||' '||apm as NAME 
       FROM STUDENTS 
       where 

      (
       upper(
            replace(
            replace(
            replace(
            replace(
            replace(
         lower(NAME),'".$el[0]."','a'),
                       '".$el[1]."','e'),
                       '".$el[2]."','i'),
                       '".$el[3]."','o'),
                       '".$el[4]."','u')
            ) 

       like '%'||
        upper(
            replace(
            replace(
            replace(
            replace(
            replace(
         '".$string."','".$el[0]."','a'),
                       '".$el[1]."','e'),
                       '".$el[2]."','i'),
                       '".$el[3]."','o'),
                       '".$el[4]."','u')
             )||'%'
     )"; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-02T22:43:59.587

您可以执行 SQL CONVERT(string, destination_encoding, source_encoding)，它提供`?`了不可转换的字符，您可以通过替换删除。

如果你这样做

```
$string = iconv('UTF-8','ASCII//TRANSLIT', $string);

SELECT CONVERT(nom, 'US7ASCII', 'WE8ISO8859P1') 
FROM STUDENTS LIKE ... $string ... ; 
```

你回退到 ASCII 应该做得很好。

ISO-8859-1 也可以。

# java - 如何查找远程服务器 URL 的基础或上下文

> ID：10866378
> 
> 赞同：0
> 
> 时间：2012-06-02T22:19:29.140
> 
> 标签：java, url, base, contextpath

我试图弄清楚如何在远程应用程序或服务器上找出 URL 的基础。例如，网址可以是： [http ://www.server.com/app/something/else/page.html](http://www.server.com/app/something/else/page.html)

现在绝对基础可以是 www.server.com、www.server.com/app 或任何小于 page.html 的内容。基础取决于应用程序在 web.xml 中的配置方式以及它是否通过例如 apache 代理。

我需要知道这些信息，因为我正在以客户端的身份阅读 url 内容，并且我需要知道如何处理从页面中找到的各种相关内容。

任何提示将不胜感激...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-02T22:47:41.887

作为客户端，这是不可能确定的，因为您对服务器的唯一了解就是 URL，服务器可以在内部以多种方式配置，与返回给您的请求的 HTML 内容无关。

如果您需要像浏览器一样抓取网站，您应该遵循与遇到相对链接时相同的规则。作为客户端，您不能假设服务器没有告诉您的服务器的任何事情。

# javascript - 尝试用 jquery 制作 CSS 类

> ID：10866387
> 
> 赞同：0
> 
> 时间：2012-06-02T22:21:33.700
> 
> 标签：javascript, jquery, html, css

我正在尝试使用以下内容创建一个 CSS 类：

```
var not_cursor = $('<style>#NOT_CURSOR { CURSOR: NONE; BACKGROUND: URL("images/NOT1.png") NO-REPEAT LEFT TOP; 
                  POSITION: ABSOLUTE;
                  DISPLAY: NONE;
                  TOP: 0;
                  LEFT: 0;
                  Z-INDEX: 10000;}</style>');
$('html > head').append(not_cursor); 
```

然后在另一个文件中我尝试访问 $('#NOT_CURSOR') 但我收到一个错误 -

```
Uncaught SyntaxError: Unexpected token ILLEGAL 
```

它告诉我这发生在第 1 行。有什么帮助吗？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-02T22:24:34.460

尝试将其全部放在一行上或连接单独的行块。

**[jsFiddle 示例](http://jsfiddle.net/j08691/XuWge/)**。

或者，使用多行转义技巧：**[jsFiddle 示例](http://jsfiddle.net/j08691/eUXpq/)**。

```
var not_cursor = $('<style>#NOT_CURSOR { CURSOR: NONE; BACKGROUND: URL("images/NOT1.png") NO-REPEAT LEFT TOP; \
                  POSITION: ABSOLUTE; \
                  DISPLAY: NONE; \
                  TOP: 0; \
                  LEFT: 0; \
                  Z-INDEX: 10000;}</style>');
$('html > head').append(not_cursor); 
```

​</p>

# jsf - JSF：从另一个库（jar 文件）获取托管 bean 实例（war 文件）

> ID：10866388
> 
> 赞同：0
> 
> 时间：2012-06-02T22:22:04.050
> 
> 标签：jsf, javabeans, instance, managed

我有以下结构：

**罐子文件**

*   `SecureTagHandler`：我需要获取用户凭据以进行检查的组件。
*   `UserSession`: 抽象类

**战争文件（Jar 依赖）**

*   `UserSessionBean`: 扩展到UserSession，用`@Named`and注解`@SessionScoped`，存储用户名、凭证等。

我需要一个解决方案来获取`UserSessionBean`Jar 文件中的引用/实例，我需要使用存储在其中的用户凭据`UserSessionBean`来使用我的`SecureTagHandler`. 我不想在 JAR 文件中使用注释。我无法注入，`UserSessionBean`因为可以更改类名。

**用户会话**

```
public abstract class UserSession implements Serializable {

    private static UserSession userSession;

    @PostConstruct
    private void init() {
        UserSession.userSession = this;
    }

    public static UserSession getUserSession() {
        return userSession;
    }
} 
```

# javascript - 更改链中的 css 属性 - JavaScript

> ID：10866389
> 
> 赞同：2
> 
> 时间：2012-06-02T22:22:13.973
> 
> 标签：javascript, css, mootools

我正在使用 MooTools 1.4.5，我想在调用需要一些时间的函数之前更改光标，在完成相同的函数后将光标设置为默认值。我没有成功。

之后，我做了一个简单的例子，通过纯 JavaScript（没有 jQuery 或 MooTools 插件）更改背景颜色，但我还是没有成功。

这是我的代码。

```
<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>
</head>
<body>
    <form id="form1" runat="server">
    <div>

    </div>
    </form>
</body>
    <script type="text/javascript">
    <!--
        document.body.style.background = 'red';
        setTimeout(function () {  }, 1250);
        document.body.style.background = 'yellow';
    //-->    
    </script>
</html> 
```

首先，我将背景颜色设置为红色，延迟后设置为黄色。我假设背景颜色将设置为红色，延迟后设置为黄色。它不起作用。加载页面时，背景颜色为黄色（最后一行）。如果我在设置背景颜色的行中间插入警报功能，一切正常（背景颜色为红色，单击消息框，背景颜色为黄色）。为什么会这样？只有最后更改的样式受到影响。在调用需要 10 秒的函数并在函数完成后将光标设置为默认值之前，我需要类似的东西来更改指针。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-02T22:24:27.450

[`setTimeout`](https://developer.mozilla.org/en/DOM/window.setTimeout)并不意味着“等待”。它会调用你稍后给它的函数。执行流程立即继续：

```
document.body.style.background = 'red';
setTimeout(function () {
    document.body.style.background = 'yellow';
}, 1250); 
```

因此，这也有效：

```
setTimeout(function () {
    document.body.style.background = 'yellow';
}, 1250);
document.body.style.background = 'red'; 
```

* * *

对于游标，只需`.background = 'red'`用`.cursor = 'wait'`和`.background = 'yellow'`替换`.cursor = 'default'`。

```
document.body.style.cursor = 'wait';
setTimeout(function() {
    doSomethingExpensive();
    document.body.style.cursor = 'default';
}, 10); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-02T22:26:27.000

的第一个参数`setTimeout()`是一个回调函数，延迟后会被调用，你应该使用这样的代码：

```
document.body.style.background = 'red';
document.body.style.cursor = 'wait';
setTimeout(function(){ 
   document.body.style.background = 'yellow'; 
   document.body.style.cursor = 'default';
}, 1250);
```

```
body { 
    width: 100%;
    height: 100%;
}
```

```
Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed non risus. Suspendisse lectus tortor, dignissim sit amet, adipiscing nec, ultricies sed, dolor. Cras elementum ultrices diam. Maecenas ligula massa, varius a, semper congue, euismod non, mi. Proin porttitor, orci nec nonummy molestie, enim est eleifend mi, non fermentum diam nisl sit amet erat. Duis semper. Duis arcu massa, scelerisque vitae, consequat in, pretium a, enim. Pellentesque congue. Ut in risus volutpat libero pharetra tempor. Cras vestibulum bibendum augue. Praesent egestas leo in pede. Praesent blandit odio eu enim. Pellentesque sed dui ut augue blandit sodales. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Aliquam nibh. Mauris ac mauris sed pede pellentesque fermentum. Maecenas adipiscing ante non diam sodales hendrerit. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed non risus. Suspendisse lectus tortor, dignissim sit amet, adipiscing nec, ultricies sed, dolor. Cras elementum ultrices diam. Maecenas ligula massa, varius a, semper congue, euismod non, mi. Proin porttitor, orci nec nonummy molestie, enim est eleifend mi, non fermentum diam nisl sit amet erat. Duis semper. Duis arcu massa, scelerisque vitae, consequat in, pretium a, enim. Pellentesque congue. Ut in risus volutpat libero pharetra tempor. Cras vestibulum bibendum augue. Praesent egestas leo in pede. Praesent blandit odio eu enim. Pellentesque sed dui ut augue blandit sodales. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Aliquam nibh. Mauris ac mauris sed pede pellentesque fermentum. Maecenas adipiscing ante non diam sodales hendrerit. Lorem ipsum.
```

[在此处](https://developer.mozilla.org/en/DOM/window.setTimeout)查看有关 setTimeout的更多信息

# sql - 重写统计用户提供的SQL

> ID：10866393
> 
> 赞同：0
> 
> 时间：2012-06-02T22:24:19.877
> 
> 标签：sql, performance, join, count

我有两张桌子 Cargo 和 Offer。我只想列出所有货物以及特定用户提供的有效报价的数量。表结构如下：

**Cargo - 表**
CargoId
CargoTime
..

**Offer - 表**
OfferId
CargoId
UserId
OfferStatu
..

在此系统中，用户可以为货物提供多个报价，但最新报价将被视为对特定用户有效。因此，如果 OfferStatu 为 1，则这指的是特定用户的先前优惠。

我编写SQL如下假设：

```
SELECT cargo.CargoId,cargo.CargoTime,COUNT(offer.OfferId) 
FROM cargo INNER join offer on offer.CargoId=cargo.CargoId
WHERE cargo.CargoId in
(
    select c.CargoId from cargo as c inner  join offer as o 
    on o.CargoId=c.CargoId
    WHERE o.UserId=12  
)
and offer.OfferStatu<>1
GROUP BY cargo.CargoId 
```

但是这个查询在大约 1 秒内执行，这对我来说太多了。我知道有一种更有效的写作方式，但我现在正在苦苦挣扎。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-03T01:02:24.453

从您的问题中很难判断，但我假设您正在寻找与货物相关的*所有*报价的计数，即使它们不是由您正在搜索的特定用户提供的。（例如，如果货物有来自用户 10 和 12 的报价，那么计数将为 2，即使我们只搜索用户 12）

试试这个：

```
SELECT
  cargo.CargoId,
  cargo.CargoTime,
  COUNT(offer.OfferId) AS OfferCount
FROM
    cargo
  INNER JOIN
    offer
  ON
    offer.CargoId = cargo.CargoId
WHERE
  offer.OfferStatu <> 1
GROUP BY
  cargo.CargoId,
  cargo.CargoTime
HAVING
  SUM(CASE offer.UserId WHEN 12 THEN 1 ELSE 0 END) <> 0; 
```

（[SQL 小提琴](http://sqlfiddle.com/#!3/e66c4/1)）

至于这是否会比您目前拥有的更有效，这通常取决于您的具体情况，您必须进行测试才能确定。人们会期望这个查询更有效，因为只有一次对 cargo 和 offer 表的访问，但这确实取决于。

# java - 在Java中的MySql数据库中查找使用相同IP的玩家列表

> ID：10866396
> 
> 赞同：0
> 
> 时间：2012-06-02T22:24:54.510
> 
> 标签：java, sql, search

我在 Mysql DB 的服务器上记录来自玩家的连接，有一个名为 IPDataBase 的表。我想检查用户是否使用具有相同 IP 的多个帐户。

该表看起来或多或少像这样：

```
PlayerName       |    IP

Player1          |    0.0.0.0

Player2          |    0.0.0.1

Player1          |    0.0.0.2 
```

当然使用非真实示例。我想说的是，相同的玩家名称可以在其中但具有不同的 IP。因此，一旦玩家连接它，它就会检查同一玩家是否已经使用相同的 ip 登录，如果不是这样，它将插入一条新线路。

我现在有一个布尔方法，它应该返回是否存在具有相同 ip 的玩家。到目前为止，我的代码是：

注意：因为它是一个 Bukkit 插件，所以类型 Player 是一个 Player 并且字符串 Playername 是通过 player.getName() 获得的

```
public boolean checksameip(Player player, String IP){
    boolean ret = false;
    String playername = player.getName();
    try{
        Connection con = DriverManager.getConnection("jdbc:mysql://localhost:3306/WebCom", "root", "MyPW");

        Statement stmt = (Statement) con.createStatement();

        ResultSet rs = stmt.executeQuery("SELECT PlayerName FROM IPDataBase WHERE IP='"+IP+"'");

        if(rs.next()){
        //there are results

            //have no clue what to put here :S

        }else{

            ret = false;
        }

        con.close();

    }catch(Exception e){

        logm("Could Not Send Data To MYSQL DATABASE SERVER");
    }

    return ret;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-02T23:01:33.317

据我了解，您想获得所有共享相同IP的玩家吗？像这样做：

```
public String[] getPlayersWithIP(String ip) {
    try{
        Connection con = DriverManager.getConnection("jdbc:mysql://localhost:3306/WebCom", "root", "MyPW");
        Statement stmt = (Statement) con.createStatement();
        ResultSet rs = stmt.executeQuery("SELECT PlayerName FROM IPDataBase WHERE IP='"+ip+"'");
        HashSet<String> result = new HashSet<String>();
        int i=0;
        while(rs.next()){
            result.add(getString("PlayerName"));
        }
        con.close();
        return result.toArray(new String[0]);
    }catch(Exception e){
        logm("Could Not Send Data To MYSQL DATABASE SERVER");
        return new String[0];
    }
} 
```

返回一个`String`数组，其中包含玩家拥有 IP 的所有不同玩家名称`ip`。如果数据库中没有具有该 IP 的玩家或抛出异常，则返回一个空数组。如果返回数组的大小大于 1，则两个或更多具有相同 IP 的人登录到您的服务器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-02T23:01:47.183

将数据库返回的玩家名称与传入方法的玩家名称进行比较呢？如果除了传递给方法的用户之外还有其他用户，则多个 a/c 已与相同的 IP 一起使用。

# c# - 在运行时在代码中生成 c# 项目

> ID：10866397
> 
> 赞同：0
> 
> 时间：2012-06-02T22:25:07.547
> 
> 标签：c#, visual-studio-2010

我正在开发一个开发 C# 生成器，我需要创建一个类，但我不明白如何制作 .csproj 文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-02T23:20:04.603

这些只是文本文件。

cs proj 是一个 msbuild 文件。而cs文件只是一个普通的代码文件。

最好的办法是使用示例 .csproj 和 .cs 文件并使用*搜索和替换*将正确的值放入其中。这会让你开始。

当您理解了理论后，您可以继续使用更好的模板引擎，例如 RAZOR 或 T4。然后是[在运行时生成程序集的更好技术。](https://stackoverflow.com/questions/604501/generating-dll-assembly-dynamically-at-run-time)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-04T08:18:06.043

创建一个空解决方案并将其保存在某个位置。然后将项目添加到该解决方案并将解决方案保存到其他位置。使用文本编辑器打开这两个解决方案并比较文件，这样您就可以看到如果您将项目添加到解决方案中，解决方案文件会发生怎样的变化。同样，如果您想以编程方式将项目添加到该解决方案，只需使用 textreader 读取解决方案文件，编辑解决方案文件文本并将其写回同一个解决方案文件。

希望能帮助到你。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-07-13T22:17:48.020

尝试以下批处理代码，这需要`dotnet`命令可用。这会生成您的`.cs`程序、`.csproj`文件、`bin`文件夹和`obj`文件夹。

```
cd Projects
set /p user_in=Enter the new folder name: 
dotnet new console -o "%user_in%"
cd "%user_in%"
dotnet restore 
```

# actionscript-3 - Starling 框架中的计时器

> ID：10866399
> 
> 赞同：2
> 
> 时间：2012-06-02T22:25:18.217
> 
> 标签：actionscript-3, flash, flash-builder, starling-framework

大家好，我正在与八哥一起开发游戏，我想设置一个计时器，例如每 2 秒我想要一些事情发生。我使用了 juggler elapsed 道具，但我想知道是否有更有效的方法来做到这一点

谢谢你，

哈立德

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-05T19:14:33.347

或者，您可以使用“DelayedCall”类。很容易错过！;-)

```
var delayedCall:DelayedCall = new DelayedCall(method, 2.0);
delayedCall.repeatCount = int.MAX_VALUE;
Starling.juggler.add(delayedCall);

function method():void
{
    trace("ping");
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-03T00:19:43.163

如果这与动画无关，建议对非动画内容使用 Timer。

计时器实现将比输入帧处理程序上的额外时间计算具有更高的性能。

如果您正在推进 Starling Jugglers，您可以将 Juggler 的帧速率设置为每 2 秒。

`delayCall`如果你的仿函数冗余调用 delayCall，杂耍者也可以每 2 秒无限循环一次：

```
juggler.delayCall(functor, 2.0); 
```

为了配合 Starlings 帧/渲染生命周期，您可以测试自上次调用以来的时间。

```
private var lastCallTime:int

protected function frameHandler():void
{
    var now:int = getTimer();
    var ellapsed:int = now - lastCallTime;
    if(ellapsed >= 2000)
    {
        /* execute implementation */
        lastCallTime = now;
    }
} 
```

# java - java-使用set-hashmap时如何避免并发等错误

> ID：10866401
> 
> 赞同：1
> 
> 时间：2012-06-02T22:25:28.393
> 
> 标签：java, hashmap

我正在使用以下代码遍历 hashmap- hashmap variable='context' 的名称

```
 Iterator iter = context.keySet().iterator();

            while(iter.hasNext())
            {
                String keystring = (String)iter.next();
                String varname= keystring.substring(0, keystring.indexOf("~"));
                String level= keystring.substring(keystring.indexOf("~")+1);
                    Integer levelno= Integer.parseInt(level);

                if(levelno==curr_level+1)
                {
                    iter.remove();
                    //we have found a variable of current level... this has to be removed from hashmap...
                    //context.remove(keystring);
                    //also the same variable has to be removed from the script engine as well...
                    scriptEngine.removeVariable(varname);

                }

            } 
```

上面的代码是否正确，尤其是关于从哈希图中删除数据？因为当我运行程序时，在哈希图中的不同（随机）值处会生成一条错误消息，指出找不到特定值（在哈希图中）（该代码是单独的并与上述代码结合使用）。参考上面的代码，我必须记住什么，以避免从哈希图中删除数据时出错？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-02T22:33:17.517

是的，这是在不破坏迭代器的情况下删除值的正确方法。

但是，这并不意味着整个应用程序中不会出现逻辑错误，除了已经显示的代码。

# shared-libraries - 如何控制 Linux 上的共享库版本问题？

> ID：10866402
> 
> 赞同：4
> 
> 时间：2012-06-02T22:25:47.927
> 
> 标签：shared-libraries

例如，我创建了一个名为**libXXX.so.0.0.0**的共享库，其 soname 为**libXXX.so.0**。那么，我是否需要创建一个名为**libXXX.so.0**的符号链接并让它指向真正的共享库？还是我只需要创建一个名为**libXXX.so**的符号链接？

此外，如果我将库更新为**libXXX.so.0.0.1**怎么办？

1.  如果我在系统库路径上安装共享库，例如 `/lib`or `/usr/lib`，如何更新符号链接？使用 ***ldconfig***？

2.  如果我在当前本地文件夹上安装共享库，如何更新符号链接？

顺便说一句，如何控制 Makefile 中的版本问题？我的意思是我需要添加一些命令，例如***ln -s***或***ldconfig***吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-03T01:12:35.343

是的，创建一个名为`libXXX.so.0`指向的符号链接`libXXX.so.0.0.0`。

如果您希望人们能够构建链接到该库的程序，那么还要创建一个名为`libXXX.so`指向`libXXX.so.0`.

libXXX.so.0 符号链接将被程序加载器使用，因为这是程序将要查找的 soname。

链接器在构建程序时将`libXXX.so`使用符号链接，因为按照历史惯例，这就是链接器的工作方式。

> 此外，如果我将库更新为 libXXX.so.0.0.1 会怎样？

然后重新制作`libXXX.so.0`符号链接，使其指向`libXXX.so.0.0.1`. 没有其他东西需要改变。由于`libXXX.so`指向`libXXX.so.0`它的符号链接也会自动指向新库。

> 如何更新符号链接？

如果您使用某些打包系统（RPM，...）安装新库，则使用打包系统提供的任何功能来管理符号链接。如果您只是使用脚本或 Makefile 节，那么只需`rm -f`使用旧的符号链接和`ln -s`新的符号链接。

# ios - 使用json从本地文件传递数据

> ID：10866403
> 
> 赞同：17
> 
> 时间：2012-06-02T22:26:08.420
> 
> 标签：ios, json, nsdictionary

我试图将数据从我的 JSON 文件传递​​到一个简单的 ViewController 上的标签，但我不知道在哪里实际传递该数据。我可以只添加到我的`setDataToJson`方法中还是将数据添加到我的`viewDidLoad`方法中？

这是我的代码

```
@interface NSDictionary(JSONCategories)
+(NSDictionary*)dictionaryWithContentsOfJSONString:(NSString*)fileLocation;
@end

@implementation NSDictionary(JSONCategories)

+(NSDictionary*)dictionaryWithContentsOfJSONString:(NSString*)fileLocation{
    NSData* data = [NSData dataWithContentsOfFile:fileLocation];
    __autoreleasing NSError* error = nil;
    id result = [NSJSONSerialization JSONObjectWithData:data 
                                                options:kNilOptions error:&error];
    if (error != nil) return nil;
    return result;
}
@end

@implementation ViewController
@synthesize name;

- (void)viewDidLoad
{
    [super viewDidLoad];

}

-(void)setDataToJson{

    NSDictionary *infomation = [NSDictionary dictionaryWithContentsOfJSONString:@"Test.json"];
    name.text = [infomation objectForKey:@"AnimalName"];//does not pass data
} 
```

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-06-03T08:40:46.037

问题是您尝试检索文件的方式。为了做到这一点，您应该首先在包中找到它的路径。尝试这样的事情：

```
+(NSDictionary*)dictionaryWithContentsOfJSONString:(NSString*)fileLocation{
    NSString *filePath = [[NSBundle mainBundle] pathForResource:[fileLocation stringByDeletingPathExtension] ofType:[fileLocation pathExtension]];
    NSData* data = [NSData dataWithContentsOfFile:filePath];
    __autoreleasing NSError* error = nil;
    id result = [NSJSONSerialization JSONObjectWithData:data 
                                                options:kNilOptions error:&error];
    // Be careful here. You add this as a category to NSDictionary
    // but you get an id back, which means that result
    // might be an NSArray as well!
    if (error != nil) return nil;
    return result;
} 
```

之后，一旦你的视图被加载，你应该能够通过检索 json 来设置你的标签，如下所示：

```
-(void)setDataToJson{
    NSDictionary *infomation = [NSDictionary dictionaryWithContentsOfJSONString:@"Test.json"];
    self.name.text = [infomation objectForKey:@"AnimalName"];
}

- (void)viewDidLoad
{
    [super viewDidLoad];
    [self setDataToJson];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-03T05:02:28.357

应该是`valueForKey`。

例子：

```
name.text = [infomation valueForKey:@"AnimalName"]; 
```

# image - Matlab将图像恢复为其原始颜色

> ID：10866404
> 
> 赞同：2
> 
> 时间：2012-06-02T22:26:21.950
> 
> 标签：image, matlab, image-processing, colors, color-management

我想拍一些东西。

图片中的颜色与我眼中的颜色不一样。

所以为了解决这个问题，我决定放一张红纸（带RGB：）`[255 0 0]`，然后拍一张包含这张纸的照片。

如果我看到纸张的RGB发生了变化（例如`[243 15 7]`），我将通过下一个方式将图片中的所有RGB都更改：

*   **R**（红色），它将按值添加`12`。
*   **G**（绿色），它会减去 value `15`。
*   **B**（蓝色），它将减去 value `7`。

通过这种方式，我的论文将更改为正确的RGB `[255 0 0]`，然后我可以确定所有其余图片的RGB都更改为原始颜色。

你怎么看这种方式？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-03T07:15:32.277

您要做的就是所谓的色彩管理/色彩校正。

我有几点意见：

*   首先，您必须确保您的显示器已校准。如果未校准，则进行目视检查是没有意义的。如果您有一个标准的消费者显示器，您可能根本无法对其进行校准。
*   为什么假设论文的RGB是[255,0,0]？它可能更绿或更蓝。您应该使用已知目标，例如[Macbeth ColorChecker](http://www.ae5d.com/macbeth.html)
*   如果光量发生变化，您正在使用的偏移转换将不起作用。相反，它应该是乘法的，以保持光照强度不变。查看颜色校正的标准方法，[颜色校正矩阵](http://www.imatest.com/docs/colormatrix/)。
*   您将需要不止一种已知颜色。三是校准矩阵的绝对最小值。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-04T08:08:55.663

您可以尝试使用白纸而不是红色。通过这样做，您将获得有关三种颜色的信息，而不仅仅是红色。在完美的情况下，白纸的 RGB 值将相等，例如，您得到 (197,197,197)。但如果它们不相等，例如 (190, 204, 203)，您可以通过乘以某个数字来更改每个像素的它们：

```
mean = (190 + 204 + 203) / 3
red_new = red * mean / 190
green_new = green * mean / 204
blue_new = blue * mean / 203 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-02T23:06:02.650

我读到了可能适用于您的情况的颜色校正的迭代过程：

[Helen Bradley 的 7 个简单步骤使用 Photoshop 进行校正](http://digital-photography-school.com/color-correction-photoshop)，

尽管如此，请确认它按预期工作

祝你好运

# sql - ORDER BY CASE 不起作用？

> ID：10866406
> 
> 赞同：1
> 
> 时间：2012-06-02T22:26:43.293
> 
> 标签：sql, db2, sql-order-by

嗨，我在 DB2 中有 SQL 语句，它正在工作。

```
select  distinct 'IN' as STATUS,
    (select count(*) from table.......)
from table

UNION ALL

select  distinct 'OUT',
   (select count(*) from table.......)
from table

UNION ALL

select  distinct 'FINISHED',
   (select count(*) from table.......)
from table

order by status 
```

但是如果我将最后一行更改为

```
order by 
 case STATUS
 when 'IN' then 1
 when 'OUT' then 2
 when 'FINISHED' then 3
end 
```

我的查询不起作用。有人可以告诉我如何解决这个问题吗？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-02T22:51:13.313

尝试将 UNION 包装到派生表中并对其进行排序：

```
select *
from ( 
   .... here goes your statement ...
) t
order by 
   case STATUS
      when 'IN' then 1
      when 'OUT' then 2
      when 'FINISHED' then 3
   end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-02T23:00:24.073

您可以随时将排序 # 添加到状态：

```
select  distinct '1-IN' as STATUS,
    (select count(*) from table.......)
from table

UNION ALL

select  distinct '2-OUT',
   (select count(*) from table.......)
from table

UNION ALL

select  distinct '3-FINISHED',
   (select count(*) from table.......)
from table

order by status 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-02T22:44:46.997

你好，如果我没记错的话，试试这个应该可以

```
 order by 
     case 
      when STATUS='IN' then 1
      when STATUS='OUT' then 2
      when STATUS='FINISHED' then 3
     end 
```

您也可以在结束时将其命名为 field_name

# python - Django ORM - 行上的 update() 乘以 Decimal()

> ID：10866410
> 
> 赞同：1
> 
> 时间：2012-06-02T22:27:18.987
> 
> 标签：python, sql, django, orm, decimal

我需要`UPDATE sometable SET total_cost=cost*sec/60.0`通过 Django ORM 执行查询。查询将产生一些类似于[此](https://code.djangoproject.com/ticket/13666)票证中描述的问题的警告。

```
new_records = Service.objects.filter(upd='U')

print new_records.update(
    total_cost=F('cost')*F('billsec')/Decimal('60.0')
) 
```

（`cost`&&`sec`字段是 DECIMAL(10,4) 类型）。结果：

```
Traceback (most recent call last):
File "./test.py", line 15, in <module>
    total_cost=F('cost')*F('billsec')/Decimal('60.0')
File "/usr/lib/python2.7/dist-packages/django/db/models/query.py", line 533, in update
    rows = query.get_compiler(self.db).execute_sql(None)
File "/usr/lib/python2.7/dist-packages/django/db/models/sql/compiler.py", line 986, in execute_sql
    cursor = super(SQLUpdateCompiler, self).execute_sql(result_type)
File "/usr/lib/python2.7/dist-packages/django/db/models/sql/compiler.py", line 818, in execute_sql
    cursor.execute(sql, params)
File "/usr/lib/python2.7/dist-packages/django/db/backends/util.py", line 40, in execute
    return self.cursor.execute(sql, params)
File "/usr/lib/python2.7/dist-packages/django/db/backends/mysql/base.py", line 114, in execute
    return self.cursor.execute(query, args)
File "/usr/lib/python2.7/dist-packages/MySQLdb/cursors.py", line 176, in execute
    if not self._defer_warnings: self._warning_check()
File "/usr/lib/python2.7/dist-packages/MySQLdb/cursors.py", line 92, in _warning_check
    warn(w[-1], self.Warning, 3)
_mysql_exceptions.Warning: Data truncated for column 'total_cost' at row 1 
```

如果我`Decimal()`从过滤器查询中删除，它将正常工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-17T13:04:25.617

请参阅此 Django 票 [https://code.djangoproject.com/ticket/13666](https://code.djangoproject.com/ticket/13666)

据说这是MySQL错误处理十进制字符串的问题。有人说将小数转换为浮点数，即 float(Decimal('60.0')) 应该可以解决问题。

# python - 在 Python 'for' 中计算项目编号？

> ID：10866411
> 
> 赞同：1
> 
> 时间：2012-06-02T22:27:40.797
> 
> 标签：python

> **可能重复：**
> [对于 x in y，在 python 中键入迭代。我可以找出我目前正在进行的迭代吗？](https://stackoverflow.com/questions/2894323/for-x-in-y-type-iteration-in-python-can-i-find-out-what-iteration-im-currentl)
> [python中的迭代次数？](https://stackoverflow.com/questions/8590810/iteration-count-in-python)

有点难以解释，但是当我运行这样的事情时：

```
fruits = ['apple', 'orange', 'banana', 'strawberry', 'kiwi']

for fruit in fruits:
    print fruit.capitalize() 
```

正如预期的那样，它给了我这个：

```
Apple
Orange
Banana
Strawberry
Kiwi 
```

我将如何编辑该代码，以便它“计算”它执行的次数`for`，并打印它？

```
1 Apple
2 Orange
3 Banana
4 Strawberry
5 Kiwi 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-02T22:28:27.363

```
for i,fruit in enumerate(fruits, 1):
    print i, fruit.capitalize() 
```

会做你想做的事并打印：

```
1 Apple
2 Orange
3 Banana
4 Strawberry
5 Kiwi 
```

默认情况下，如果未指定[enumerate()](http://docs.python.org/library/functions.html#enumerate)将使用 0 开始生成索引，但您可以指定起始值，如图所示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-02T22:30:09.853

忽略`enumerate(iterable)`，您可以算自己：

```
i = 0
for fruit in fruits:
    i += 1
    print i, fruit.capitalize() 
```

# ruby-on-rails - 我如何运行一个 ruby 脚本，我把它放在我的 Rails 应用程序的 /lib/tasks/ 目录中，一次？

> ID：10866421
> 
> 赞同：1
> 
> 时间：2012-06-02T22:29:26.287
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

最终我想把它设置为一个 Rake 任务并做一个 cron 工作，但是现在......我想做的就是把我曾经作为独立脚本工作的 ruby​​ 脚本让它在其中工作我的 Rails 应用程序。

我将文件重命名为 is`.rake`而不是`.rb`并尝试`rake my_script`在命令行中执行，但这给了我这个错误消息：

```
rake aborted!
Don't know how to build task 'my_script'

(See full trace by running task with --trace) 
```

如何在我的 Rails 环境中运行此脚本？

这是我第一次做这样的事情，所以任何帮助将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-02T22:36:47.530

我认为您正在寻找的是rails runner。我知道在 Rails 2.3.x 中你会这样做

```
ruby script/runner <your file> 
```

在 Rails 3 中可能会略有不同。

[http://guides.rubyonrails.org/command_line.html#rails-runner](http://guides.rubyonrails.org/command_line.html#rails-runner)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-02T23:15:35.797

runner 和 rake 任务之间的主要区别是：runner 会启动 rails 而 rake 任务不会（你可以告诉它这样做）。

由于 rake 两者都可以（启动/不启动），所以 rails-3 中不再有 runner 的概念。

因此，创建一个 rake 任务：`whatever_name.rake`

例子：

```
desc "This task does awesome stuff"
  task :do_awesome_stuff do
  awesome_method
end

def awesome_method
  #put your ruby code here
end 
```

现在从您的命令提示符处，键入`rake do_awesome_stuff`以执行此 rake 任务。

要使其启动 Rails，请将任务定义更改为：

```
task :do_awesome_stuff => :environment do 
```

# c# - ListView 绑定中的 SelectedItem

> ID：10866423
> 
> 赞同：4
> 
> 时间：2012-06-02T22:30:00.163
> 
> 标签：c#, wpf, xaml, data-binding

我是 WPF 的新手。在我的示例应用程序中，我使用 ListView 来显示属性的内容。我不知道如何将 ListView 中的 SelectedItem 绑定到属性，然后绑定到 TextBlock。

**窗口.xaml**

```
<Window x:Class="Exec.App"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Main window" Height="446" Width="475" >

    <Grid>
        <ListView Name="ListViewPersonDetails" Margin="15,12,29,196" ItemsSource="{Binding Persons}" SelectedItem="{Binding CurrentSelectedPerson}">
            <ListView.View>
                <GridView>
                    <GridViewColumn Header="First name" DisplayMemberBinding="{Binding FirstName}"/>
                    <GridViewColumn Header="Last name" DisplayMemberBinding="{Binding LastName}"/>
                    <GridViewColumn Header="Address" DisplayMemberBinding="{Binding Address}"/>
                </GridView>
            </ListView.View>
        </ListView>

        <TextBlock Height="23" Name="textFirstNameBlock" FontSize="12" Margin="97,240,155,144">
                <Run Text="Name: " />
                <Run Text="{Binding CurrentSelectedPerson.FirstName}" FontWeight="Bold" />
        </TextBlock>

        <TextBlock Height="23" Name="textLastNameBlock" FontSize="12" Margin="97,263,155,121">
                <Run Text="Branch: " />
                <Run Text="{Binding CurrentSelectedPerson.LastName}" FontWeight="Bold" />
        </TextBlock>

        <TextBlock Height="23" Name="textAddressBlock" FontSize="12" Margin="0,281,155,103" HorizontalAlignment="Right" Width="138">
                <Run Text="City: " />
                <Run Text="{Binding CurrentSelectedPerson.Address}" FontWeight="Bold" />
        </TextBlock>

    </Grid>
</Window> 
```

**主窗口.xaml.cs**

```
Tman manager = new Tman();

        private List<Person> persons;
        public List<Person> Persons
        {
            get
            {
                return this.persons;
            }

            set
            {
                if (value != null)
                {
                    this.persons = value;
                }

            }
        }

        private Person currentSelectedPerson;
        public Person CurrentSelectedPerson
        {
            get
            {
                return currentSelectedPerson;
            }
            set
            {
                this.currentSelectedPerson = value;
            }
        }

        private void Window_Loaded(object sender, RoutedEventArgs e){   
            ListViewPersonDetails.ItemsSource= manager.GetPersons();

        } 
```

**个人.cs**

```
class Person
    {
        public string FirstName
        {
            get;
            set;
        }

        public string LastName
        {
            get;
            set;
        }

        public string Address
        {
            get;
            set;
        }

    } 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-02T22:37:21.400

```
private void Window_Loaded(object sender, RoutedEventArgs e){
    ListViewPersonDetails.ItemsSource= manager.GetPersons();
} 
```

这可能是您的问题，您不必像这样设置 itemssource。换成这条线就行了...

```
this.DataContext = this; 
```

这就是将您的属性绑定到 UI 的内容，因此所有这些绑定语句都具有任何意义。

您还需要更新文本块上的绑定以实际匹配 Person 类中的属性名称。

```
<TextBlock Height="23" Name="textFirstNameBlock" FontSize="12" Margin="97,240,155,144">
    <Run Text="Name: " />
    <Run Text="{Binding CurrentSelectedPerson.FirstName}" FontWeight="Bold" />
</TextBlock>

<TextBlock Height="23" Name="textLastNameBlock" FontSize="12" Margin="97,263,155,121">
    <Run Text="Branch: " />
    <Run Text="{Binding CurrentSelectedPerson.LastName}" FontWeight="Bold" />
</TextBlock>

<TextBlock Height="23" Name="textAddressBlock" FontSize="12" Margin="0,281,155,103" HorizontalAlignment="Right" Width="138">
    <Run Text="City: " />
    <Run Text="{Binding CurrentSelectedPerson.Address}" FontWeight="Bold" />
</TextBlock> 
```

编辑：

在 VS 中测试，您还需要 1 个小东西，在 CurrentSelectedPerson 属性上实现 INotifyPropertyChanged ...

```
private Person currentSelectedPerson;
public Person CurrentSelectedPerson 
{
    get { return currentSelectedPerson; }
    set 
    {
        currentSelectedPerson = value;
        if (PropertyChanged != null) PropertyChanged(this, new PropertyChangedEventArgs("CurrentSelectedPerson"));
    }
} 
```

作为替代方案，这也可以，更简单一些......

```
<TextBlock Height="23" Name="textFirstNameBlock" FontSize="12" Margin="97,240,155,144">
    <Run Text="Name: " />
    <Run Text="{Binding ElementName=ListViewPersonDetails, Path=SelectedItem.FirstName}" FontWeight="Bold" />
</TextBlock> 
```

（对其他文本框重复类似的逻辑）

# java - Android Activity ClassNotFoundException - 尝试了一切

> ID：10866431
> 
> 赞同：84
> 
> 时间：2012-06-02T22:30:37.653
> 
> 标签：java, android, android-fragments, classnotfoundexception, android-library

我刚刚将一个应用程序重构为一个框架库和一个应用程序，但是现在当我尝试在模拟器中启动应用程序时，我得到以下错误堆栈跟踪：

```
06-02 18:22:35.529: E/AndroidRuntime(586): FATAL EXCEPTION: main
06-02 18:22:35.529: E/AndroidRuntime(586): java.lang.RuntimeException: Unable to instantiate activity ComponentInfo{com.matthewrathbone.eastersays/com.matthewrathbone.eastersays.EasterSimonSaysActivity}: java.lang.ClassNotFoundException: com.matthewrathbone.eastersays.EasterSimonSaysActivity in loader dalvik.system.PathClassLoader[/data/app/com.matthewrathbone.eastersays-1.apk]
06-02 18:22:35.529: E/AndroidRuntime(586):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2585)
06-02 18:22:35.529: E/AndroidRuntime(586):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
06-02 18:22:35.529: E/AndroidRuntime(586):  at android.app.ActivityThread.access$2300(ActivityThread.java:125)
06-02 18:22:35.529: E/AndroidRuntime(586):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
06-02 18:22:35.529: E/AndroidRuntime(586):  at android.os.Handler.dispatchMessage(Handler.java:99)
06-02 18:22:35.529: E/AndroidRuntime(586):  at android.os.Looper.loop(Looper.java:123)
06-02 18:22:35.529: E/AndroidRuntime(586):  at android.app.ActivityThread.main(ActivityThread.java:4627)
06-02 18:22:35.529: E/AndroidRuntime(586):  at java.lang.reflect.Method.invokeNative(Native Method)
06-02 18:22:35.529: E/AndroidRuntime(586):  at java.lang.reflect.Method.invoke(Method.java:521)
06-02 18:22:35.529: E/AndroidRuntime(586):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
06-02 18:22:35.529: E/AndroidRuntime(586):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
06-02 18:22:35.529: E/AndroidRuntime(586):  at dalvik.system.NativeStart.main(Native Method)
06-02 18:22:35.529: E/AndroidRuntime(586): Caused by: java.lang.ClassNotFoundException: com.matthewrathbone.eastersays.EasterSimonSaysActivity in loader dalvik.system.PathClassLoader[/data/app/com.matthewrathbone.eastersays-1.apk]
06-02 18:22:35.529: E/AndroidRuntime(586):  at dalvik.system.PathClassLoader.findClass(PathClassLoader.java:243)
06-02 18:22:35.529: E/AndroidRuntime(586):  at java.lang.ClassLoader.loadClass(ClassLoader.java:573)
06-02 18:22:35.529: E/AndroidRuntime(586):  at java.lang.ClassLoader.loadClass(ClassLoader.java:532)
06-02 18:22:35.529: E/AndroidRuntime(586):  at android.app.Instrumentation.newActivity(Instrumentation.java:1021)
06-02 18:22:35.529: E/AndroidRuntime(586):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2577)
06-02 18:22:35.529: E/AndroidRuntime(586):  ... 11 more 
```

通常这意味着清单文件在某种程度上是错误的，但我已经仔细检查了我能想到的所有内容。

这是我的活动课：

```
package com.matthewrathbone.eastersays;

import android.os.Bundle;

import com.rathboma.simonsays.Assets.Season;
import com.rathboma.simonsays.SeasonPicker;
import com.rathboma.simonsays.SimonSaysActivity;

    public class EasterSimonSaysActivity extends SimonSaysActivity {

      @Override
      protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
      }

      @Override
      protected void onDestroy() {
        // TODO Auto-generated method stub
        super.onDestroy();
      }

      @Override
      public SeasonPicker getSeasonPicker() {
       return new SeasonPicker(){
        @Override
        public Season getSeason() {
          // TODO Auto-generated method stub
          return Season.EASTER;
        }
       };
      }
    } 
```

如您所见，它在清单中正确列出：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.matthewrathbone.eastersays"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk android:minSdkVersion="7" android:targetSdkVersion="15" />

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name" >
        <activity
            android:name=".EasterSimonSaysActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>

</manifest> 
```

我不知道如何解决这个问题，并希望得到任何帮助。我已经扫描了许多关于 SO 的类似问题，但没有看到这种特殊行为。

更多信息：

*   我检查了生成的 APK，并且该类在 classes.dex 文件中有一个条目
*   我已经尝试在 Eclipse 中清理/构建项目
*   我尝试使用一个全新的设备映像，该映像上还没有 APK 的副本
*   我已经把库项目改成了普通的java，然后又改回了android项目，没区别
*   将抽象的 SimonSaysActivity 添加到清单中没有任何区别。
*   我试过让每个依赖项都成为一个 android 库项目，并同步他们需要的 android 版本，但没有帮助

找到了解决方案（见下文）。致所有发布答案/评论的人：你们都摇滚，感谢帮助我解决问题！

看起来这是由 SDK 工具升级引入的。感谢@Nick 在此链接的评论中：http: [//iqadd.com/item/noclassdeffounderror-adt-fix](http://iqadd.com/item/noclassdeffounderror-adt-fix)

* * *

## 回答 #1

> 赞同：148
> 
> 时间：2012-06-09T23:42:58.517

我花了一些时间玩自己的项目，在尝试运行我的主项目时，我能够复制您的问题并获得完全相同的异常堆栈跟踪，所以我认为这可能是原因：

和我想的一样，就是在Android主项目中如何引用你的Android库项目，一个简单的Eclipse配置设置。

**错误的方法：**
右键主项目，选择`Properties -> Java Build Path -> Projects -> Add...`，这会将Android库项目作为依赖项目添加到Android主项目的构建路径中，这不起作用。如果在主项目中定义了所有必需的 Android 相关资源，则在编译时不会出现任何错误，但在运行应用程序时，会出现问题中描述的异常。

**正确方法：**
右键主项目，选择`Properties -> Android`，在Library部分，在这里添加你的Android库项目。查看官方开发指南[Referenceing a library project](http://developer.android.com/guide/developing/projects/projects-eclipse.html#ReferencingLibraryProject)。这应该可以解决您的所有问题。另请注意，您必须使用相对路径引用实际的 Android 库项目，如[库项目 - 开发注意事项](http://developer.android.com/guide/developing/projects/index.html#considerations)中所述。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-02T22:58:43.467

我已经测试了您提供的代码，它工作正常。尝试将“扩展 SimonSaysActivity”更改为简单的“扩展 Activity”，并亲自查看它是否有效。

它不起作用的原因是 SimonSaysActivity 没有扩展 Activity （我认为你没有犯这个错误），或者构建路径的顺序是错误的。

要转到构建路径的顺序，请转到：

```
project->properties->Java build path->order and export . 
```

我的基本顺序是：项目 src、项目 gen、android 4.0.3、android 依赖项。

当您使用库时，通常会出现此问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-09T18:44:25.933

> 我刚刚将一个应用程序重构为一个框架库和一个应用程序。

我不完全确定您在这里要说什么，但是您在这里使用“重构”一词的事实使我相信您误解了库项目的概念。

* * *

### 什么图书馆项目*是*：

库项目是包含共享源代码和资源的开发项目。其他 Android 项目可以引用该库项目，并在编译时将其编译后的源代码包含在其 .apk 文件中。

### 什么图书馆项目*不是*：

库项目与标准 Android 项目的不同之处在于，您不能将其直接编译为单个`.apk`文件并在 Android 设备上运行。您不能将一个 Android 项目用作库项目，然后让另一个 Android 项目*扩展*该库项目。它不是那样工作的。

* * *

也就是说，我会调查您的图书馆项目的结构并确保您已[正确设置它](http://developer.android.com/guide/developing/projects/index.html#LibraryProjects)。使用您的库来存储共享代码/资源是可以的，但如果您的库试图表现得好像它是`.apk`库项目本身中的一个单独的，那么您可能做错了什么。`ClassNotFoundException`如果是这种情况，我相信会被抛出。为了解决这个问题，我只是从头开始构建库项目，而不是尝试将 Android 项目转换为库项目。这将防止你遇到微小的、烦人的错误。

如果您仍然遇到问题，请随时发布更多代码。您还应该详细说明您的图书馆项目的结构（和目的）......为什么决定使用它，如何创建它等等。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-10-18T23:27:12.550

对于 Eclipse Kepler(Mac)：Control-click 项目 -> Android 工具 -> 添加支持库

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-05-22T23:00:33.813

尽管我的情况不同，但我正在从事的一个项目遇到了这个问题。如果那里的任何人仍然找不到解决问题的方法，请尝试检查：

**在 Eclipse 中：**

```
Project properties -> Java Build Path -> Source tab 
```

在里面，您会找到一个列表，其中包含要编译的所有源文件夹，并每次将其放入生成的 apk 以构建您的项目（和*/gen*）。典型地：

```
>MyProject/gen
>MyProject/src 
```

您需要确定的是，在您的每个源文件夹中（不包括*/gen* ，因此在这种情况下只有*/src*`Output folder` ）该项目指向默认输出文件夹，即`MyProject/bin/classes`. 通过选择输出文件夹并从右侧按钮组中单击删除来执行此操作（这将使其指向默认文件夹）。

*如果您看不到子项输出文件夹，请选中列表下方的“允许源文件夹的输出文件夹”*

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-09-23T12:31:33.047

如果您遵循所有提示（检查私人图书馆等）并且仍然有错误。在应用程序标签中检查您的清单中的这行代码

```
 android:hasCode="false" 
```

删除它并快乐。（我终于）:)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-04-16T12:35:01.333

> Java 中的 classNotFoundException 是 java.lang.Exception 的子类，当 Java 虚拟机尝试加载特定类并且在类路径中找不到请求的类时出现。

阅读更多：http: [//javarevisited.blogspot.com/2011/08/classnotfoundexception-in-java-example.html#ixzz3yX3WBeFA](http://javarevisited.blogspot.com/2011/08/classnotfoundexception-in-java-example.html#ixzz3yX3WBeFA)

尝试转到**`Project -> Properties -> Java Build Path -> Order & Export`**并确认已为您的项目以及您在应用程序中使用的所有其他库项目检查**Android 私有库。**

**如何处理 ClassNotFoundException**

1.  验证请求的类的名称是否正确，并且 在您的*类路径中存在***适当的 .jar**文件。如果没有，您必须将其显式添加到应用程序的类路径中。
**   如果指定的 .jar 文件存在于您的类路径中，那么您的应用程序的类路径将被覆盖，您必须找到应用程序使用的确切类路径。*   如果异常是由第三方类引起的，您必须确定引发异常的类，然后在您的*类路径中添加丢失的***.jar**文件。*

 *** * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-02-25T14:21:52.377

虽然这不适用于所有人，但我最近遇到了这个问题，因为我的项目无法与设备上存在的共享库链接。我忘记[在我的清单](https://developer.android.com/guide/topics/manifest/uses-library-element.html)中指定我的应用程序`<uses-library>`.

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2017-01-26T07:06:53.743

从 bin 中删除 classes.dex 并重建项目

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-06-02T23:02:59.733

SimonSaysActivity 使用/扩展了哪些接口或父类，它们在您使用的 Android 版本上可用吗？我已经看到了类似的问题，我的活动实现了一个在我使用的 Android 版本上不可用的 API 接口。

在我的情况下，我的活动实现了仅在 API 14 中可用的接口 PopupMenu.OnDismissListener 但是当我在我的 2.3 设备上运行应用程序时，我收到了活动的 java.lang.NoClassDefFoundError 异常。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-09-19T01:40:16.453

我遇到了同样的问题，并且浪费了一天的大部分时间尝试各种事情。该应用程序在从一台 pc 部署时运行 find ，但不在这台 pc 上。最后，它最终成为了一种缺失的 java 特性！奇怪的是它如何向我展示了 java 构建路径、订单/导出和所有这些，但还没有 java 特性。:(希望这可以节省其他人很多时间

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-06-24T09:50:34.763

@yorkw 提供的解决方案是绝对正确的。我还有一个问题，在其中一个布局文件中，我错误地提到了绝对名称。应该是

```
<android.support.v4.view.ViewPager xmlns:android="... 
```

而是我把它

```
<android.support.v4.app.view.ViewPager xmlns:android="... 
```

解决这些后，效果很好。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2015-05-07T23:06:54.227

信不信由你，对我来说，解决方法是在尝试了至少 4 小时后，从我的项目中删除了旧版本 (2.0) 的谷歌分析库。当然，这个库的更新也可能是解决方案。所以它可能是一个依赖 jar 版本控制问题。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2020-07-14T11:03:28.100

I was getting these type of error and i have tried everything but didn't get the solution. then i figured out if you are using library as aar file then you have to add all dependencies of your aar library to your app gradle.build file. if someone didn't figure out solution then try this!

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2014-02-11T09:31:28.760

我遇到了同样的问题。但后来我检查了应用程序的当前结构。我发现较旧的应用程序结构（我不知道它被android框架开发人员更改的时间）有一个文件夹名称`"lib"`，它是 now `"libs"`。我将所有 jar 文件迁移到“libs”中，错误消失了。我希望这可能对某人有所帮助:)**

# java - AddAllAttributes 方法 spring mvc

> ID：10866433
> 
> 赞同：3
> 
> 时间：2012-06-02T22:30:56.373
> 
> 标签：java, spring, spring-mvc

我有两个清单

```
List<User> list_of_users=new ArrayList<User>();
List<String> list_of_attributes=new ArrayList<String>(); 
```

当我尝试使用以下代码行时：

```
model.addAttribute("takeattributes",list_of_users);
model.addAttribute("takeattributes",list_of_attributes); 
```

我意识到它只保留第二个列表（list_of_attributes）和第一个删除。我想知道如何将这两个列表都保留在模型中。这可能发生吗？我需要 AddAllAttributes 方法吗？如果是的话，谁能解释一下 AddAllAttributes 方法是如何工作的。我看看 spring mvc 文档但我真的不明白。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-02T22:35:38.260

该模型本质上是`Map`具有唯一键的。你真的应该定义两个唯一的键：

```
model.addAttribute("users", list_of_users);
model.addAttribute("attributes", list_of_attributes); 
```

第一个参数用作标识符，您可以在 GUI 中引用每个相应的列表。

# javascript - 在 IE9 中解析 xml/json 响应

> ID：10866439
> 
> 赞同：1
> 
> 时间：2012-06-02T22:32:09.180
> 
> 标签：javascript, xml, jquery-plugins, xml-parsing, internet-explorer-9

我以为这个问题[已经解决](https://stackoverflow.com/questions/9746515/ie9-refuses-to-process-xml-response)了，但不幸的是它没有解决，尽管这次似乎是一个不同的问题。

我想通过跨域 XHR 使用 imgur API 照片共享服务，显然，它工作正常。我开始一个请求，他们发送一个 xml，我需要做的就是处理它。但是，尽管有多个建议（适用于 Chrome、Firefox），但我无法在 Internet Explorer 9 中正确执行此操作。这是我尝试过的最简单的代码：

HTML：

```
<!DOCTYPE html>
  <html>
    <body>
    <form id="uploadForm" action="http://api.imgur.com/2/upload.xml" method="POST" enctype="multipart/form-data">
    <input type="hidden" name="key" value="00ced2f13cf6435ae8faec5d498cbbfe"/>
    File: <input type="file" name="image"/>
    Return Type: <select id="uploadResponseType" name="mimetype">
    <option value="xml">xml</option>
    </select>
    <input type="submit" value="Submit 1" name="uploadSubmitter1"/>
    </form>
    <div id="uploadOutput"></div>
    </body>
  </html> 
```

在那里您可以看到 Imgur API 的密钥（如果需要，您可以使用它......它仅用于测试目的，但我不认为收到的 xml 响应有任何问题）。

我正在使用[Jquery Form Plugin](http://malsup.com/jquery/form/#file-upload)来管理文件上传。

**XML:**

* * *

这是我测试过的最简单的一段代码。通常，我们需要帮助 Internet Explorer 独立解析 xml，这就是我有 parseXml 的原因。

Javascript：

```
function parseXml(xml) {  
  if (jQuery.browser.msie) {  
    var xmlDoc = new ActiveXObject("Microsoft.XMLDOM");  
    xmlDoc.loadXML(xml);  
    xml = xmlDoc;  
  }  
  return xml;  
} 

$('#uploadForm').ajaxForm({
    dataType: ($.browser.msie) ? "text" : "xml",
    accepts: {
        xml: "text/xml",
        text: "text/xml"
    },
    // has been received
    success: function(data) {
        $('#uploadOutput').html('Submitting...');
        data = parseXml(data);
        console.log(data);
        alert(data);
    },
    complete: function(data) {
        $('#uploadOutput').html('Complete...');
     }
}); 
```

`dataType: ($.browser.msie) ? "text" : "xml"`据说告诉 IE 返回一个文本响应。尽管有所有这些保证，`Content Type`但响应是`application/xml`（有人告诉我这不是问题）。作为一个 xml 我收到这个：

```
<?xml version="1.0" encoding="utf-8"?>
<upload><image><name/><title/><caption/><hash>087Y0</hash><deletehash>gUcgywjXoJyAJp6</deletehash><datetime>2012-06-02 21:59:35</datetime><type>image/jpeg</type><animated>false</animated><width>1024</width><height>768</height><size>297623</size><views>0</views><bandwidth>0</bandwidth></image><links><original>http://i.imgur.com/087Y0.jpg</original><imgur_page>http://imgur.com/087Y0</imgur_page><delete_page>http://imgur.com/delete/gUcgywjXoJyAJp6</delete_page><small_square>http://i.imgur.com/087Y0s.jpg</small_square><large_thumbnail>http://i.imgur.com/087Y0l.jpg</large_thumbnail></links></upload> 
```

我认为它看起来不错，我可以在其他浏览器中使用类似的东西解析它`$($.parseXml(xml)).find('original').text()`，但不能在 IE9 中解析。所以基本上，我收到了回复，但我无法解析那个 xml，尽管当我试图弄清楚我在 IE 中得到了什么时，看起来我什么也没得到。

此外，`success`甚至没有触发，这是 IE9 无法解析 xml 的信号。`complete`正在射击，但它没有收到任何内容`data`。那么我做错了什么？

在这里你可以有一个[小提琴](http://jsfiddle.net/7sYF2/)（包括 Jquery Form Plugin）。

**更新：**

**JSON**

* * *

为了将来参考，在这种情况下，JSON 将无法使用 Jquery Form Plugin。从文档中：

```
The iframe element is used as the target of the form's submit operation 
which means that the server response is written to the iframe. This is fine 
if the response type is HTML or XML, but doesn't work as well if the response 
type is script or JSON, both of which often contain characters that need to 
be repesented using entity references when found in HTML markup. To account 
for the challenges of script and JSON responses when using the iframe mode, 
the Form Plugin allows these responses to be embedded in a textarea element 
and it is recommended that you do so for these response types when used in 
conjuction with file uploads and older browsers. 
```

想法？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-03T03:42:14.733

这是由于跨域安全性，称为同源策略。

如果浏览器实现了这个插件（例如在 Chrome 中），这个插件就会使用 File API，如果没有，它会使用一个巧妙的技巧来创建一个隐藏的 iframe 并将数据发布到它。如果地址在另一个域上，插件无法从 iframe 中获取数据，因此会失败。

尝试使用：启用插件的调试模式，`$.fn.ajaxSubmit.debug = true;`您将看到幕后发生的事情。

~~不幸的是，上传的唯一方法是在您的 HTML 中使用隐藏的 iframe，而不是由脚本添加，并通过`iframeTarget`使用此 iframe 的选择器传递参数来强制发布到它，但您将无法获取响应，由于上面提到的问题（我不知道为什么插件生成的iframe不发布数据）：~~

**JS：**

```
$('#uploadForm').ajaxForm({
    iframeTarget: ($.browser.msie) ? "#iframeTarget" : false,
    ... 
```

**HTML：**

```
<iframe name="iframeTarget" id="iframeTarget">This iframe can be hidden with CSS</iframe> 
```

您还可以使用条件注释来隐藏 iframe 对其他浏览器：

```
<!--[if IE]>
<iframe name="iframeTarget" id="iframeTarget">This iframe can be hidden with CSS</iframe>
<![endif]--> 
```

~~需要注意的是`success`回调不会触发。~~

**编辑：**

您正在与此站点通信的`JSON`响应选项吗？

如果有，您可以将`jsonp`其用作`dataType`参数，添加`?callback=someFunction`到 url 的末尾并编写`someFunction(data){}`接收数据并以与`success`回调相同的方式解析它的内容。

# node.js - 向nodejs添加一个内置函数

> ID：10866440
> 
> 赞同：0
> 
> 时间：2012-06-02T22:32:29.310
> 
> 标签：node.js, require, built-in

我想将我们广泛使用的几个函数添加到 nodejs 中，使它们始终可用，就像内置函数一样，如日期、数组、对象等。因此，无需执行“要求”。这可能吗？

克，

科恩。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-02T22:46:18.597

您可以破解node.js 所基于的[v8 源代码。](https://code.google.com/p/v8/wiki/Source)

# php - 使用自定义异常处理程序 (set_exception_handler) 时不会自动记录异常

> ID：10866441
> 
> 赞同：0
> 
> 时间：2012-06-02T22:32:42.037
> 
> 标签：php

我想使用自定义异常处理程序（使用[`set_exception_handler()`](http://php.net/set_exception_handler)函数设置）来控制发生未处理异常时向用户打印的内容。

不幸的是，在这种情况下，异常不会记录到 php 错误日志中，我不想编写自己的日志记录代码，因为自动异常记录对我来说绝对没问题。

问题是：
如果执行了自定义异常处理程序，是否有办法使 PHP 日志异常（默认情况下）？如果没有，有没有办法登录到主 php 错误日志文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-02T22:55:24.557

> 如果执行了自定义异常处理程序，有没有办法使 PHP 日志异常（默认情况下）？

不，不是来自 PHP 提供的（例如`FALSE`在回调中返回）。

> 如果没有，有没有办法登录到主 php 错误日志文件？

是的，您可以为此使用[`error_log`^(*Docs*)](http://php.net/function.error_log)功能。[`Exception`^(*文档*)](http://php.net/Exception)应包含消息以及文​​件名和行号。我手头没有任何代码，否则我已经添加/链接了它。

一个或多或少的肮脏技巧（但我不确定它是否保留原始文件名和行号）是创建一个始终保留在内存中的异常捕获对象。如果它捕获到一个未捕获的异常，它将处理它并存储它。在破坏的情况下（在过程结束时），它可以重新抛出它。然后 PHP 需要处理它并可能记录它。但是我会认为这是实验性的。

# c - 命令行错误消息的“POSIX 定义格式”是什么？哪个标准？

> ID：10866443
> 
> 赞同：9
> 
> 时间：2012-06-02T22:33:10.677
> 
> 标签：c, ruby, standards, posix, getopt

在 ruby​​-doc.org[页面上](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/getoptlong/rdoc/GetoptLong.html#method-c-new) ，我发现以下关于命令行选项/参数解析（getopt 库）的内容：

> 以 POSIX 定义的格式返回相应的错误消息。如果没有发生错误，则返回 nil。

命令行错误消息的 POSIX 定义格式是什么？它是哪个 POSIX 标准？

**编辑：**

我必须澄清我在解析命令行参数/选项时对标准/推荐的错误消息感兴趣。

在下面的链接（答案）中，我发现只提到了 getopt 的这种错误格式：

```
"%s: illegal option -- %c\n", <program name>, <option character>

"%s: option requires an argument -- %c\n", <program name>, <option character> 
```

一切都是为了它吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-02T22:52:22.060

是 IEEE 标准 1003.1。请参阅[`errno.h`](http://pubs.opengroup.org/onlinepubs/009695399/basedefs/errno.h.html)，[错误编号](http://pubs.opengroup.org/onlinepubs/009695399/functions/xsh_chap02_03.html)。也称为 POSIX.1-2008 和更早的修订版（有关章节、年份等的更多详细信息，请参见[wiki](http://en.wikipedia.org/wiki/POSIX)）。

请注意，系统可能具有扩展的错误编号集和与之关联的消息。例如，Linux 支持 C99 定义的错误编号。也可能存在特定于实现的错误。这是Linux[`errno.h`](http://www.kernel.org/doc/man-pages/online/pages/man3/errno.3.html)供参考。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-03T01:08:14.067

由于您的问题是关于`getopt()`函数的，因此您可能正在寻找[`getopt()`](http://pubs.opengroup.org/onlinepubs/9699919799/functions/getopt.html)函数的 POSIX 规范。其规范取决于[`getopts`](http://pubs.opengroup.org/onlinepubs/9699919799/utilities/getopts.html)它可以产生的错误消息的实用程序。该`getopts`实用程序的基本原理部分描述了某些现有实现中某些错误消息的格式，但不强制要求它们。

您还应该查看[实用程序约定](http://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap12.html)规范以了解 POSIX 实用程序通常遵守的规则。（与约定存在偏差，通常是因为历史悠久的先例。通常，定义的变体与 POSIX 约定相匹配。）

# javascript - 过滤文本字段数值的正确方法是什么？

> ID：10866444
> 
> 赞同：4
> 
> 时间：2012-06-02T22:33:13.413
> 
> 标签：javascript, jquery, validation, recommendation-engine

我正在处理一个文本字段，它使用一种不允许您输入数值以外的验证。因此，我的初始代码看起来非常简单，类似于：

```
$(textField).onKeyPress(function(e) {
    if (e.which < 48 && e.which > 57)
        e.preventDefault();
}); 
```

这是相当简单的，但事实证明（在所有浏览器的最新版本中）Firefox 将使用箭头键和删除/退格键阻止移动，而其他浏览器则不会。

环顾四周，我发现我还需要检查这些键，并检查`e`事件引用中公开的不同属性。

我的最终代码如下所示：

```
$(textField).onKeyPress(function(e) {
    var code = e.which || e.keyCode;
    if (code > 31  // is not a control key
        && (code < 37 || code > 40) // is not an arrow key
        && (code < 48 || code > 57) // is not numeric
        && (code != 46) // is not the delete key
    )
        e.preventDefault();
}); 
```

然而，这感觉对于解决一个相当简单的问题来说太过分了，因为只是防止了非数字。

**我究竟做错了什么？就这种验证而言，哪个是最佳实践？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-02T22:38:20.730

我们将响应按键和模糊事件。当有人按下一个键时，我们检查输入的键是否是一个数字。如果是，我们允许。否则，我们会阻止它。

如果该字段是模糊的，我们会删除所有非数值，以及随后的所有这些值。这将防止用户粘贴非数字字符串：

```
$("#textfield").on("keypress blur", function(e){
    if ( e.type === "keypress" )
        return !!String.fromCharCode(e.which).match(/^\d$/);
    this.value = this.value.replace(/[^\d].+/, "");
}); 
```

演示：http: [//jsfiddle.net/jonathansampson/S7VhV/5/](http://jsfiddle.net/jonathansampson/S7VhV/5/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-02T22:52:39.660

**工作演示** [http://jsfiddle.net/Pb2eR/23/](http://jsfiddle.net/Pb2eR/23/) **更新**了复制/粘贴演示：http: [//jsfiddle.net/Pb2eR/47/](http://jsfiddle.net/Pb2eR/47/)（在这个演示中，您可以复制粘贴字符串和不允许的字符将允许复制粘贴数字：在 safari 中测试）

**箭头键的演示** [http://jsfiddle.net/gpAUf/](http://jsfiddle.net/gpAUf/)

这将对您有所帮助。

注意：在这个版本中，即使你复制粘贴它也会将其设置为空输入框，在 safari lion osx 中测试:)

好的链接：[1][如何使用 jQuery 在 HTML 输入框中只允许数字（0-9）？](https://stackoverflow.com/questions/995183/how-to-allow-only-numeric-0-9-in-html-inputbox-using-jquery)

**代码**

```
$(".hulk").keyup(function(){    
    this.value = this.value.replace(/[^0-9\.]/g,'');    
});
​ 
```

**html**

```
<input type="text" class="hulk" value="" />
​ 
```

**复制粘贴**内容的更新

```
$(".hulk").keyup(function(){

    this.value = this.value.replace(/[^0-9\.]/g,'');

});

$(".hulk").bind('input propertychange', function() {

     this.value = this.value.replace(/[^0-9\.]/g,'');
});​ 
```

**来自另一个演示的代码**

```
$(".hulk").bind('input propertychange', function(event) {
         if( !(event.keyCode == 8    // backspace
        || event.keyCode == 46      // delete
        || (event.keyCode >= 35 && event.keyCode <= 40)     // arrow keys/home/end
        || (event.keyCode >= 48 && event.keyCode <= 57)     // numbers on keyboard
        || (event.keyCode >= 96 && event.keyCode <= 105))   // number on keypad
        ) {
            event.preventDefault();     // Prevent character input
    }
     this.value = this.value.replace(/[^0-9\.]/g,'');
});

​ 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-02T23:00:33.633

这将允许两个int。如果用户使用鼠标复制和粘贴，它也会删除文本。

```
$(document).ready(function () {
    $('#textfield').bind('keyup blur', function (e) {
        if (e.type == 'keyup') {
            if (parseInt($(this).val()) != $(this).val()) {
                $(this).val($(this).val().slice(0, $(this).val().length - 1));
            }
        } else if (e.type == 'blur') {
            $(this).val('');
        }
    });
}); 
```

# google-maps - 谷歌地图 KML 解决方案验证

> ID：10866452
> 
> 赞同：0
> 
> 时间：2012-06-02T22:35:24.170
> 
> 标签：google-maps, kml

Google Maps 新手（GIS 新手），我正在寻找一种在 Google 地图上绘制叠加层（多边形数量）的解决方案，并想知道使用 KML 文件是否是一个可行的解决方案？

基本上，我有一些地址（地址数据），我将传递给我们的内部 GIS 系统，GIS 系统将一个 KML 文件（一个包含多个不同位置的文件）交给我，然后我使用 KML 绘制多边形分层选项：

[https://developers.google.com/maps/documentation/javascript/layers](https://developers.google.com/maps/documentation/javascript/layers)

听起来像是一个可行的解决方案？

干杯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-03T16:31:41.193

是的，这是一个可行的解决方案。使用 KML 图层显示 kml 将导致数据呈现为瓦片。您还可以将您的 kml 导入 FusionTables 并使用 FusionTablesLayer。

# java - 从CSV加载数据到mySQL数据库Java+hibernate+spring

> ID：10866454
> 
> 赞同：3
> 
> 时间：2012-06-02T22:35:33.943
> 
> 标签：java, mysql, spring, hibernate, hql

我正在尝试使用 Java+Hibernate+Spring 将 CSV 文件加载到 mySQL 数据库中。我在 DAO 中使用以下查询来帮助我加载到数据库中：

```
entityManager.createQuery("LOAD DATA INFILE :fileName INTO TABLE test").setParameter("fileName", "C:\\samples\\test\\abcd.csv").executeUpdate(); 
```

我从[http://dev.mysql.com/doc/refman/5.1/en/load-data.html](http://dev.mysql.com/doc/refman/5.1/en/load-data.html)得到了一些使用它的想法，以及[如何将 csv 文件从 hibernate+spring 应用程序导入到 mysql 中？](https://stackoverflow.com/questions/6499440/how-to-import-a-csv-file-into-a-mysql-from-an-hibernatespring-application)

但我收到错误：

```
java.lang.IllegalArgumentException: node to traverse cannot be null! 
```

请帮忙！谢谢

**编辑**：这是堆栈跟踪

```
 SEVERE: Servlet.service() for servlet [Faces Servlet] in context with path [/EMS] threw exception [/pages/upload.xhtml at line 82 and column 108 action="#{uploadBean.upload}": java.lang.IllegalArgumentException: node to traverse cannot be null!] with root cause
java.lang.IllegalArgumentException: node to traverse cannot be null!
    at org.hibernate.hql.ast.util.NodeTraverser.traverseDepthFirst(NodeTraverser.java:63)
    at org.hibernate.hql.ast.QueryTranslatorImpl.parse(QueryTranslatorImpl.java:280)
    at org.hibernate.hql.ast.QueryTranslatorImpl.doCompile(QueryTranslatorImpl.java:182)
    at org.hibernate.hql.ast.QueryTranslatorImpl.compile(QueryTranslatorImpl.java:136)
    at org.hibernate.engine.query.HQLQueryPlan.<init>(HQLQueryPlan.java:101)
    at org.hibernate.engine.query.HQLQueryPlan.<init>(HQLQueryPlan.java:80)
    at org.hibernate.engine.query.QueryPlanCache.getHQLQueryPlan(QueryPlanCache.java:124)
    at org.hibernate.impl.AbstractSessionImpl.getHQLQueryPlan(AbstractSessionImpl.java:156)
    at org.hibernate.impl.AbstractSessionImpl.createQuery(AbstractSessionImpl.java:135)
    at org.hibernate.impl.SessionImpl.createQuery(SessionImpl.java:1770)
    at org.hibernate.ejb.AbstractEntityManagerImpl.createQuery(AbstractEntityManagerImpl.java:272)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:240)
    at $Proxy19.createQuery(Unknown Source)
    at com.repositories.impl.UploadDAOImpl.upload(UploadDAOImpl.java:33)
    at com.services.impl.UploadServiceImpl.upload(UploadServiceImpl.java:25)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:309)
    at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:183)
    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:150)
    at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:110)
    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)
    at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:202)
    at $Proxy26.upload(Unknown Source)
    at com.managedbeans.UploadBean.uploadData(UploadBean.java:40)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.apache.el.parser.AstValue.invoke(AstValue.java:262)
    at org.apache.el.MethodExpressionImpl.invoke(MethodExpressionImpl.java:278)
    at org.apache.myfaces.view.facelets.el.TagMethodExpression.invoke(TagMethodExpression.java:83)
    at javax.faces.component._MethodExpressionToMethodBinding.invoke(_MethodExpressionToMethodBinding.java:88)
    at org.apache.myfaces.application.ActionListenerImpl.processAction(ActionListenerImpl.java:100)
    at javax.faces.component.UICommand.broadcast(UICommand.java:120)
    at javax.faces.component.UIViewRoot._broadcastAll(UIViewRoot.java:890)
    at javax.faces.component.UIViewRoot.broadcastEvents(UIViewRoot.java:234)
    at javax.faces.component.UIViewRoot._process(UIViewRoot.java:1202)
    at javax.faces.component.UIViewRoot.processApplication(UIViewRoot.java:623)
    at org.apache.myfaces.lifecycle.InvokeApplicationExecutor.execute(InvokeApplicationExecutor.java:35)
    at org.apache.myfaces.lifecycle.LifecycleImpl.executePhase(LifecycleImpl.java:143)
    at org.apache.myfaces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:93)
    at javax.faces.webapp.FacesServlet.service(FacesServlet.java:189)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:304)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:343)
    at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:109)
    at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:83)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:355)
    at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:97)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:355)
    at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:100)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:355)
    at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:78)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:355)
    at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:54)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:355)
    at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:35)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:355)
    at org.springframework.security.web.authentication.www.BasicAuthenticationFilter.doFilter(BasicAuthenticationFilter.java:177)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:355)
    at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:187)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:355)
    at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:105)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:355)
    at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:79)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:355)
    at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:149)
    at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:237)
    at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:167)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.primefaces.webapp.filter.FileUploadFilter.doFilter(FileUploadFilter.java:77)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:224)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:169)
    at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:100)
    at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:929)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:405)
    at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:964)
    at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:515)
    at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:304)
    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
    at java.lang.Thread.run(Thread.java:662) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-02T22:47:47.737

因为，它是一个本机查询。

试试：`entityManager.createNativeQuery`。

而不是：`entityManager.createQuery`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-08-11T06:06:03.840

```
 Query query = sessionFactory.getCurrentSession().createSQLQuery("LOAD DATA INFILE :filename INTO TABLE TestTable FIELDS TERMINATED BY ',' LINES TERMINATED BY '\n' (txn_amount,card_number,terminal_id)").setString("filename", "E:/amol.csv");
    int rowCount = query.executeUpdate(); 
```

# algorithm - 在屏幕上均匀分布项目

> ID：10866457
> 
> 赞同：0
> 
> 时间：2012-06-02T22:35:44.810
> 
> 标签：algorithm, layout

我正在尝试解决这个小难题（算法）：我有 N 个图像图标，我想将它们均匀地分布在用户屏幕上。说，我把它们放在一张桌子上。如果有一个图像，则表格中将有一个单元格。如果两 - 一行两列，如果三 - 一行三列，如果四 - 两行，两列......等等，直到行空间消失，从那时起，表格应该只在列中增长而不添加额外的行。

我正在尝试为此制定一个算法，也许这已经在某处有解决方案？

到目前为止，我的尝试是这样的：

```
obtain_max_rows()
obtain_visible_columns()
if (number_of_pictures > max_rows*max_columns)
{
columns = roundup(number_of_pictures/max_rows)
for(max_rows){generate row;for columns{generate column}}
}
else
{
**here comes to trouble...**
} 
```

不过这个逻辑有点傻——它不知何故需要考虑第一个屏幕上有 12 张图片和另一个屏幕上有 2 张图片试图平衡它的情况，比如 8/6 或类似的情况。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-03T02:43:50.900

我想我找到了你的答案：

```
 typedef struct{int width, height;} rectangle;

    ...

    rectangle findOptimalDivision(int numberOfCuts){

        int x = numberOfCuts, y = (int)sqrt(numberOfCuts);
        while (x%y) { // when y = 1 it will always exit out (anything can be divided by 1)
            y--;
        }

        return (rectangle){y,numberOfCuts/y};
    } 
```

`rectangle`这应该以单元格的形式为您提供表格（或）的高度和宽度。我用 1 - 100 作为参数对此进行了测试，它似乎给出了正确的输出。

如果您有任何问题，请给我留言。

# spring - 我如何在 spring security acl 中检查我的对象权限而不是使用 hasPermission 注释

> ID：10866458
> 
> 赞同：3
> 
> 时间：2012-06-02T22:35:49.070
> 
> 标签：spring, spring-security, acl

有没有办法直接从我的代码中检查我的类对象权限，而不是使用注释模型，

```
@PostAuthorize("hasPermission(returnObject, 'WRITE')")
public BaseData getSingle(Long id); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-04T01:35:44.837

假设您打算使用 ACL 模块，则表达式在[`AclPermissionEvaluator`](https://github.com/SpringSource/spring-security/blob/master/acl/src/main/java/org/springframework/security/acls/AclPermissionEvaluator.java). 因此，您可以将其实例与 连接起来`AclService`，将其注入需要它的类并`hasPermission`直接调用该方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T11:14:38.337

最后经过几次尝试，我可以得到解决方案，以下是代码

acl-conf.xml

```
...
<bean class="org.springframework.security.acls.AclPermissionEvaluator" id="permissionEvaluator">
        <constructor-arg ref="aclService"/>
</bean>
... 
```

示例控制器.java

```
 @Autowired
    private PermissionEvaluator permissionEvaluator ;

    Permission permission = BasePermission.WRITE;
   permissionEvaluator.hasPermission(authentication,aclObject,permission);
.... 
```

希望这会有所帮助。

# wpf - 如何将数组绑定到 WPF 数据网格中的列

> ID：10866459
> 
> 赞同：3
> 
> 时间：2012-06-02T22:36:01.520
> 
> 标签：wpf, arrays, binding, datagrid

我有一个包含 Curve 对象列表的 Log 对象。每条曲线都有一个 Name 属性和一个双精度数组。我希望名称位于列标题及其下方的数据中。我有一个带有 datagid 的用户控件。这是 XAML；

```
<UserControl x:Class="WellLab.UI.LogViewer"
         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
         xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
         xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
         mc:Ignorable="d" 
         d:DesignHeight="500" d:DesignWidth="500">
<Grid>
    <StackPanel Height="Auto" HorizontalAlignment="Stretch" Margin="0" Name="stackPanel1" VerticalAlignment="Stretch" Width="Auto">
        <ToolBarTray Height="26" Name="toolBarTray1" Width="Auto" />
        <ScrollViewer Height="Auto" Name="scrollViewer1" Width="Auto" HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Visible" CanContentScroll="True" Background="#E6ABA4A4">
            <DataGrid AutoGenerateColumns="True" Height="Auto" Name="logDataGrid" Width="Auto" ItemsSource="{Binding}" HorizontalAlignment="Left">
            </DataGrid>
        </ScrollViewer>
    </StackPanel>
</Grid> 
```

在后面的代码中，我已经弄清楚了如何创建列并命名它们，但我还没有弄清楚如何绑定数据。

```
public partial class LogViewer
{
    public LogViewer(Log log)
    {
        InitializeComponent();

        foreach (var curve in log.Curves)
        {
            var data = curve.GetData();
            var col = new DataGridTextColumn { Header = curve.Name };
            logDataGrid.Columns.Add(col);
        }
    }
} 
```

我什至不会显示我试图用来绑定数组“数据”的代码，因为甚至没有任何东西接近。我确信我错过了一些简单的东西，但是在网上搜索了几个小时之后，我不得不来乞求答案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-03T14:51:33.850

您需要将日志数据转换为一个集合，`RowDataItem`其中每一行包含一个 double 值集合，每个`Curve`. 同时可以提取列名。所以数据最终会是这样。

```
public class PivotedLogData : ViewModelBase
{
    public PivotedLogData(Log log)
    {
        ColumnNames = log.Curves.Select(c => c.Name).ToList();

        int numRows = log.Curves.Max(c => c.Values.Count);

        var items = new List<RowDataItem>(numRows);

        for (int i = 0; i < numRows; i++)
        {
            items.Add(new RowDataItem(
                          log.Curves.Select(
                              curve => curve.Values.Count > i
                                           ? curve.Values[i]
                                           : (double?) null).ToList()));
        }

        Items = items;
    }

    public IList<string> ColumnNames { get; private set; }
    public IEnumerable<RowDataItem> Items { get; private set; }
}

public class RowDataItem
{
    public RowDataItem(IList<double?> values)
    {
        Values = values;
    }

    public IList<double?> Values { get; private set; }
} 
```

然后你会`DataGridTextColumn`像上面一样创建项目，但要使用合适的绑定

```
var pivoted = new PivotedLogData(log);

int columnIndex = 0;

foreach (var name in pivoted .ColumnName)
{
    dataGrid.Columns.Add(
        new DataGridTextColumn
            {
                Header = name,
                Binding = new Binding(string.Format("Values[{0}]", columnIndex++))
            });
} 
```

现在将数据绑定到网格

```
dataGrid.ItemsSource = pivoted.Items; 
```

# amazon-s3 - 使用 amazon s3 和 cloudfront 作为 CDN

> ID：10866461
> 
> 赞同：2
> 
> 时间：2012-06-02T22:36:16.790
> 
> 标签：amazon-s3, cdn, amazon-cloudfront

我想从 CDN 提供用户上传的内容（图片、视频和其他文件）。将 Amazon S3 与 Cloudfront 结合使用似乎是一种合理的方式。我唯一的问题是关于文件系统的速度。我的计划是使用以下 uri 托管用户媒体。`cdn.mycompany.com/u/u/i/d/uuid.jpg`.

我之前没有任何使用 S3 或 CDN 的经验，我只是想知道这种策略是否可以很好地扩展以处理大量用户上传的内容。如果可能有另一种传统的方式来实现这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-03T23:50:18.950

在 CloudFront 上处理规模永远不会有问题。这是一个企业级的野兽。

免责声明：如果您是 Google，则不会。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-04T16:28:23.797

这是一个绝佳的选择。特别是对于流式视频和音频，CloudFront 是无价的。我的客户使用我的插件来显示私人流媒体视频和音频，其中一位甚至在一个存储桶中拥有 8,000 个视频而没有问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-03T16:49:36.713

我的问题源于对 S3 存储桶作为传统文件系统的误解。我担心在同一目录中破解太多文件会在查找文件时产生开销。然而，事实证明，S3 存储桶的实现更像是哈希图，因此这种开销实际上并不存在。有关详细信息，请参见此处：[S3 中每个目录的最大文件数](https://stackoverflow.com/questions/394198/max-files-per-directory-in-s3)

# javascript - JavaScript如何将鼠标光标更改为图像？

> ID：10866471
> 
> 赞同：16
> 
> 时间：2012-06-02T22:37:52.023
> 
> 标签：javascript, jquery, html, image, mouse

我已经看到了一些示例，您可以将其更改为操作系统具有的预设图像；例子：

```
$('body').css('cursor', 'wait'); 
```

但是我自己的 /img/my_image.png 呢？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-06-02T22:41:47.550

您可以通过在 CSS 中指定一个 url：

```
div {
    cursor: url(smiley.gif), url(myBall.cur), auto;
} 
```

见[http://www.w3schools.com/cssref/pr_class_cursor.asp](http://www.w3schools.com/cssref/pr_class_cursor.asp)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-04-11T06:06:00.753

设置自定义光标（或默认光标作为后备）的 Jquery 方式：

```
$('selector').css({'cursor': 'url(/cursors/customMoveCursor.cur), default'}); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-03T05:08:20.247

我通常不链接外部文章，但这篇文章涵盖了您的需求。我在这里复制了相关的东西以保持持久性。

```
#dragMe {
    cursor: url('../cursors/customMoveCursor.cur'),     /* Modern browsers    */
            url('cursors/customMoveCursor.cur'),        /* Internet Explorer  */
            move;                                       /* Older browsers     */
} 
```

信用：[http ://www.useragentman.com/blog/2011/12/21/cross-browser-css-cursor-images-in-depth/](http://www.useragentman.com/blog/2011/12/21/cross-browser-css-cursor-images-in-depth/)

在制作自定义光标时不要忘记考虑可访问性！干杯:)

# git - git clone 在 Mac OS X 上的 Hudson 上失败

> ID：10866472
> 
> 赞同：2
> 
> 时间：2012-06-02T22:38:15.143
> 
> 标签：git, hudson

我在 Mac OS X 上使用带有 git 插件的 Hudson。我的 git 存储库在我自己的服务器上，可以通过 SSH 访问。我已经正确配置了密钥。我使用默认的 Winstone 服务器从命令行启动 Hudson。从命令行进行克隆工作，并且在 Hudson 的一切工作正常之前，有一天我想强迫 Hudson 在构建之前清除存储库。所以我在*高级项目选项*组中*构建之前检查了清理工作区。*从现在开始，每个构建都会失败并显示以下消息：

 *```
Started by user anonymous
Cleaning the workspace because project is configured to clean the workspace before each build.
Checkout:workspace / /Users/mczenko/.hudson/jobs/My Project/workspace - hudson.remoting.LocalChannel@592e4ff9
Using strategy: Default
Last Built Revision: Revision fc233689562bf464b08d7406a382d4bee0209c04 (origin/master)
Checkout:workspace / /Users/user/.hudson/jobs/My Project/workspace - hudson.remoting.LocalChannel@592e4ff9
Cloning the remote Git repository
Cloning repository origin
ERROR: Error cloning remote repo 'origin' : Could not clone git@myserver.com:git/MyProject.git
ERROR: Cause: Exception caught during execution of fetch command
Trying next repository
ERROR: Could not clone repository
FATAL: Could not clone
hudson.plugins.git.GitException: Could not clone
    at hudson.plugins.git.GitSCM$3.invoke(GitSCM.java:913)
    at hudson.plugins.git.GitSCM$3.invoke(GitSCM.java:845)
    at hudson.FilePath.act(FilePath.java:758)
    at hudson.FilePath.act(FilePath.java:740)
    at hudson.plugins.git.GitSCM.gerRevisionToBuild(GitSCM.java:845)
    at hudson.plugins.git.GitSCM.checkout(GitSCM.java:622)
    at hudson.model.AbstractProject.checkout(AbstractProject.java:1483)
    at hudson.model.AbstractBuild$AbstractRunner.checkout(AbstractBuild.java:507)
    at hudson.model.AbstractBuild$AbstractRunner.run(AbstractBuild.java:424)
    at hudson.model.Run.run(Run.java:1366)
    at hudson.model.FreeStyleBuild.run(FreeStyleBuild.java:46)
    at hudson.model.ResourceController.execute(ResourceController.java:88)
    at hudson.model.Executor.run(Executor.java:145) 
```

最初我认为我的 ssh 配置有问题，并且可能有一些特定于我的服务器安装的问题。但后来我检查了我的一个 GitHub 存储库，问题仍然存在。有许多与此问题相关的类似问题，其中大多数是指 ssh 的配置 - 结果证明在我的系统上正确完成。我还在[http://wiki.hudson-ci.org/display/HUDSON/Git+Plugin](http://wiki.hudson-ci.org/display/HUDSON/Git+Plugin)找到了这条消息，表明此失败可能是由 git 可执行文件的路径问题引起的。我当然检查了，正如预期的那样，它对我的​​系统没有任何影响。这里报告了更严重的问题：[Hudson git clone error](https://stackoverflow.com/questions/1177292/hudson-git-clone-error) where Rob Segal 说：

> 这正是我一直遇到的问题。如果我首先在命令行上克隆到 hudson 将工作的工作区，那么未来的构建工作正常。最初的克隆过程显然出了问题，但我现在不能说到底是什么。毫无疑问，调试 Git 插件代码可以准确地找出问题所在。如果我有空闲时间，我打算这样做。

到目前为止，我还没有找到任何关于我所遇到的情况的参考，其中克隆失败似乎与在构建选项*之前启用清洁工作区有关。*

Git 插件有自己的选项*Wipe out workspace before build*，似乎和上面提到的*Clean workspace before build*选项功能一样。它对克隆具有相同的效果：启用它后，克隆失败并显示上述消息。

一旦我注意到这个问题，解决方法似乎是*在构建选项之前不使用清理工作区，*并且不使用 git 插件进行新构建（并在构建步骤中执行 git clone），但我不确定这是否真的问题。也许有人有同样的问题，可以指出一些解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T09:26:35.757

请记住，hudson/jenkins 用户将发出克隆请求。您需要为运行 hudson 的用户配置 ssh 密钥，并赋予该用户对存储库的读取权限。*

# c++ - 未解析的外部符号（OpenGL 和 c++）

> ID：10866474
> 
> 赞同：3
> 
> 时间：2012-06-02T22:38:25.627
> 
> 标签：c++, opengl, linker

好的，所以我正在写一个小项目，没什么复杂的，它只有几个类。顾名思义，它使用 OpenGL。目前，没有“真正的”主要功能。我在使用 gl* 函数调用的任何地方都包含了 glew.h，并添加到链接器输入 glew32.lib。

然而，它给了我这个：

> 错误 2 错误 LNK2019：未解析的外部符号 _ *imp* _glBindTexture@8 在函数“public: void __thiscall Texture2D::Bind(unsigned int)”(?Bind@Texture2D@@QAEXI@Z) Texture.obj Licenta 中引用

...以及有关 OpenGL 纹理函数的许多其他未解决的外部符号错误。但它并没有抱怨这一点：

```
glBindVertexArray(m_VAO);
        glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, m_Buffers[INDEX_BUFFER]);
        glBufferData(GL_ELEMENT_ARRAY_BUFFER, sizeof(Indices[0]) * Indices.size(), &Indices[0], GL_STATIC_DRAW); 
```

或这个：

```
glDrawElementsBaseVertex(GL_TRIANGLES, 
                             m_Entries[i].NumIndices, 
                             GL_UNSIGNED_INT, 
                             (void*)(sizeof(unsigned int) * m_Entries[i].BaseIndex), 
                             m_Entries[i].BaseVertex); 
```

那么，有什么关系呢？如果一个 gl* 函数调用链接失败，难道不是全部都必须失败吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-02T22:42:01.933

glBindTexture 是一个“核心”OpenGL 功能。此函数位于 opengl32.dll 中，因此只需将 opengl32.lib 添加到链接器输入即可。

glDrawElementsBaseVertex 和 glBindVertexArray 是扩展，GLEW 将它们定义为函数指针（在运行时完成动态后期绑定），因此不会出现“未解析符号”错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-02T22:47:03.573

您需要在链接器输入中包含该库。

对于 VS：

1.  将库的文件放在解决方案的根文件夹中。（对于某些库，您通常不必这样做）
2.  在 Visual Studios 菜单中，转到 Project --> [SolutionName] 属性。
3.  将打开一个对话框。导航到配置属性 --> 链接器 --> 输入
4.  在“附加依赖项”中添加库的名称。（可能是*** .lib）

# php - php回合时间，保持字符串格式

> ID：10866476
> 
> 赞同：0
> 
> 时间：2012-06-02T22:38:45.090
> 
> 标签：php, datetime, date, time

我使用以下方法将时间四舍五入到一分钟：

```
$mytime = mdate("H:i:s", $time_in_seconds);   

$rounded_time = date('H:i:s', round(strtotime($mytime)/60)*60); 
```

输出例如：`01:09:00`from not rounded `01:08:34`。

如何使用代码但保持秒格式而不是更改日期？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-02T22:48:05.403

怎么用

```
$rounded_time = date('H:i:0'); 
```

?

# lua - 当 Lua 文件都在同一个文件夹中时，LuaEdit 找不到模块

> ID：10866477
> 
> 赞同：4
> 
> 时间：2012-06-02T22:38:47.513
> 
> 标签：lua

我下载了 LuaEdit 以用作 IDE 和调试工具，但是即使是最简单的事情我也无法使用它。我创建了一个包含 2 个文件的解决方案，所有这些文件都存储在同一个文件夹中。我的文件如下：

```
--startup.lua

require("foo")

test("Testing", "testing", "one, two, three")

--foo.lua

foo = {}

print("In foo.lua")

function test(a,b,c) print(a,b,c) end 
```

这在我的 C++ 编译器中通过一些嵌入代码访问时工作正常，但是当我尝试在 LuaEdit 中使用相同的代码时，它在第 3 行崩溃`require("foo")`并显示错误：

```
module 'foo' not found:
no field package.preload['foo']
no file 'C:\Program Files (x86)\LuaEdit 2010\lua\foo.lua'
no file 'C:\Program Files (x86)\LuaEdit 2010\lua\foo\init.lua'
no file 'C:\Program Files (x86)\LuaEdit 2010\foo.lua'
no file 'C:\Program Files (x86)\LuaEdit 2010\foo\init.lua'
no file '.\foo.lua'
no file 'C:\Program Files (x86)\LuaEdit 2010\foo.dll'
no file 'C:\Program Files (x86)\LuaEdit 2010\loadall.dll'
no file '.\battle.dll' 
```

我还尝试在将这些文件添加到解决方案之前创建这些文件，但仍然出现相同的错误。我缺少一些设置吗？拥有一个 IDE/调试器会很棒，但如果它不能运行链接函数，它对我来说毫无用处。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-03T10:36:34.363

The issue is probably that your Lua files are not on the path in `package.path` (for C files this is `package.cpath`).

My guess is that the LuaEdit program is not launched in the directory you have your files in, and hence does not have a match for eg `.\foo.lua`.

You have 3 simple solutions to this (from dumb to smarter):

*   Find out what path LuaEdit considers as ./ and put your files there.
*   Open up a terminal in the right directory (the one containing your files), and run LuaEdit from there.
*   Add the path the files are on to [`package.path`](http://www.lua.org/manual/5.1/manual.html#pdf-package.path) and [`package.cpath`](http://www.lua.org/manual/5.1/manual.html#pdf-package.cpath) before doing any `require`'s

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-10T03:38:52.337

您可能需要输入：

`lua package.path = package.path..";c:/path/to/my/files/?.lua"`

在任何要求之前的文件开头（如 jpjacobs 所示）。我找不到任何方法从 LuaEdit 本身提供这个。它似乎使用其完整路径运行脚本，但将其当前目录设置为 IDE 启动时的任何设置。*如果您使用应用程序文件夹中的**完整*路径运行 LuaEdit ，即使没有更改也应该可以正常工作。*`package.path`*

 *虽然 IDE 本身可以与自己的模块/库一起正常工作，但这并不意味着它可以让它们运行的​​应用程序使用它们。

（无耻的插件）如果你仍然对 LuaEdit 不满意，我会提供[ZeroBrane Studio Lua IDE](http://studio.zerobrane.com/)作为替代方案，它基于相同的 wxLua 框架，但提供更多功能并且没有这个特殊问题重新面对。它还支持远程调试，因此您应该能够直接从您的应用程序中调试您的 Lua 脚本。*

# utf-8 - 如何让 quicklisp 在 slime 中加载 rfc2388？

> ID：10866478
> 
> 赞同：5
> 
> 时间：2012-06-02T22:38:49.387
> 
> 标签：utf-8, common-lisp, slime, sbcl, quicklisp

我正在尝试通过[quicklisp](http://www.quicklisp.org/)在[slime中加载](http://common-lisp.net/project/slime/)[hunchentoot](http://weitz.de/hunchentoot/)，并收到以下错误：

```
READ error during COMPILE-FILE:

  :ASCII stream decoding error on
  #<SB-SYS:FD-STREAM
    for "file [redacted]/dists/quicklisp/software/rfc2388-20120107-http/rfc2388.asd"
    {100607B723}>:

    the octet sequence #(196) cannot be decoded.

  (in form starting at line: 29, column: 29,
  file-position: 1615)
[Condition of type ASDF:LOAD-SYSTEM-DEFINITION-ERROR] 
```

我在尝试运行时得到这个：

```
(ql:quickload "hunchentoot") 
```

或者简单地说：

```
(ql:quickload "rfc2388") 
```

似乎其他人也[得到了](http://paste.lisp.org/display/128224) [这个](http://pastebin.com/af7AF9Bk)。我发现了一个可能答案的[提示](http://groups.google.com/group/quicklisp/browse_thread/thread/8fe99c95ae248bdc)，说：

```
The system file is encoded as UTF-8\. 
I'm not sure how to configure things so that SBCL on Windows starts with 
UTF-8 as its default encoding for loading sources, but that's what you 
need to do. 
```

从那里，我尝试过（基于例如 [this] 将以下内容添加到我的 emacs 配置中：

```
(set-language-environment "UTF-8")
(setq slime-lisp-implementations
      '((sbcl ("/opt/local/bin/sbcl") :coding-system utf-8-unix)))
(setq slime-net-coding-system 'utf-8-unix) 
```

但是......即使在完全重新启动 emacs 之后，我仍然会遇到同样的错误，以确保我有一个正在读取上述配置的新 Slime。

那么，我错过了什么，和/或我怎样才能加载它？

提前致谢！（更感谢您的成功回答。;）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-04T01:03:19.073

你检查过你的语言环境设置吗？Emacs 配置只告诉它为 SLIME 和 SWANK 之间的通信设置什么编码系统。

您可以使用 /usr/bin/locale 检查区域设置，例如：

```
navi ~ » locale
LANG=pl_PL.UTF-8
LC_CTYPE=pl_PL.UTF-8
LC_NUMERIC=pl_PL.UTF-8
LC_TIME=pl_PL.UTF-8
LC_COLLATE="pl_PL.UTF-8"
LC_MONETARY=pl_PL.UTF-8
LC_MESSAGES=C
LC_PAPER=pl_PL.UTF-8
LC_NAME="pl_PL.UTF-8"
LC_ADDRESS="pl_PL.UTF-8"
LC_TELEPHONE="pl_PL.UTF-8"
LC_MEASUREMENT=pl_PL.UTF-8
LC_IDENTIFICATION=pl_PL.UTF-8
LC_ALL=
navi ~ » 
```

如您所见，除了显示“C”消息外，我的所有地方都设置了 UTF-8。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T14:16:34.767

试试这个：

切换到 .../quicklisp/dists/quicklisp/software/rfc2388* 目录并将 rfc2388.asd 加载到文本编辑器中。向下移动到 defsystem 表单的 :author 参数。用文件顶部给出的名称替换作者的姓名。使用 ASCII 编码存储文件。

当然，当库的新版本发布时，解决方法就会丢失。或者将修改后的项目存储在本地项目中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T14:29:27.080

在原始 UTF-8 编码仍然有效的情况下，调试器应该提供一个 INPUT-REPLACEMENT 选项来用替换字符串替换有问题的输入字符。选择该选项，键入“？” 或“x”或您喜欢的任何字符串，然后按 ENTER。然后加载完成。当然，这不是你每次都想做的事情。

所以最好的办法可能是给作者发一封邮件，要求提供一个用于 quicklisp 的 ascii 版本。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-06-04T11:06:39.090

您的 HOME 中应该有一个 .cache 目录，其中包含所有 fasl 文件。有时，当编译出现问题时，删除那些旧的 fasl 文件似乎对我有用。

# ios - GetCurrentProcess() 上的 Monotouch 崩溃

> ID：10866479
> 
> 赞同：1
> 
> 时间：2012-06-02T22:38:58.787
> 
> 标签：ios, xamarin.ios

当我的应用调用 System.Diagnostics.Process.GetCurrentProcess() 时，它会引发此错误并使我的应用崩溃：未注册的 icall 'System.Diagnostics.Process:GetPid_internal()'</p>

有解决办法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-04T09:26:56.323

MonoTouch 不支持 System.Diagnostics.Process.GetCurrentProcess，它可能一开始就不应该可用。

解决方法是不调用 Process.GetCurrentProcess （甚至更好：根本不使用 Process 类）。

# sql - 如何在sql中选择不同的选择？

> ID：10866480
> 
> 赞同：1
> 
> 时间：2012-06-02T22:38:59.397
> 
> 标签：sql, ssis

> **可能重复：**
> [如何选择在 sql 中插入具有相同 id 的行？](https://stackoverflow.com/questions/10842634/how-to-choose-which-row-to-insert-with-same-id-in-sql)

我有一个名为“table_1”的表：

```
ID   Index          STATUS          TIME        DESCRIPTION
1     15          pending           1:00       Started Pending
1     16          pending           1:05       still in request
1     17          pending           1:10       still in request
1     18          complete          1:20       Transaction has been completed
2     19          pending           2:25       request has been started
2     20          pending           2:30       in progress
2     21          pending           2:35       in progess still
2     22          pending           2:40       still pending
2     23          complete          2:45       Transaction Compeleted 
```

我需要将这些数据插入到我的第二个表“table_2”中，其中只包括开始时间和完成时间，所以我的“table_2”应该是这样的：

```
ID   Index   STATUS          TIME          DESCRIPTION
1     15     pending         1:00          Started Pending
1     18     complete        1:20          Transaction has been completed
2     19     pending         2:25          request has been started
2     23     complete        2:45          Transaction Completed 
```

这是我已经拥有的一些代码，我无法获得正确的关联描述，因为它没有出现在`GROUP BY`子句中。

```
INSERT INTO myTable2 (ID, STATUS, TIME)
SELECT ID, STATUS, MIN(TIME) FROM myTable1 t1top
WHERE EXISTS(SELECT * FROM myTable1 WHERE ID=t1top.ID AND STATUS='Complete')
GROUP BY ID, STATUS
ORDER BY ID  ASC, STATUS DESC 
```

如果有人可以帮助我为此编写 sql 查询，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-02T23:12:18.990

```
INSERT INTO myTable2 (ID, STATUS, TIME, DESCRIPTION)
SELECT t1.ID, t1.STATUS, t1.TIME, t1.DESCRIPTION FROM table_1 as t1 
WHERE STATUS = 'complete' 
OR TIME = (SELECT min(TIME) FROM table_1 WHERE ID = t1.ID) 
ORDER BY ID asc, STATUS desc 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-02T22:48:07.193

假设时间戳是唯一的，您可以自行加入表并从中进行选择。（如果不是，说明不是由您的数据唯一定义的）。

```
INSERT INTO myTable2 (ID, STATUS, TIME, DESCRIPTION)
SELECT t1top.ID, t1top.STATUS, MIN(t1top.TIME), t1Copy.DESCRIPTION
FROM myTable1 t1top
    JOIN myTable1 t1Copy ON t1top.ID = t1Copy.ID
WHERE EXISTS(SELECT * FROM myTable1 WHERE ID=t1top.ID AND STATUS='Complete')
    AND MIN(t1top.TIME) = t1Copy.TIME
GROUP BY ID, STATUS
ORDER BY ID ASC, STATUS DESC 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-02T22:50:01.667

尝试这样的事情：

```
SELECT * FROM myTable1 WHERE DESCRIPTION = '%started%' OR DESCRIPTION = '%complete%' ORDER BY ID, STATUS 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-02T22:55:30.970

您可以为此使用分区函数：

```
SELECT a.ID, a.Index, a.STATUS, a.TIME, a.DESCRIPTION FROM
(
    SELECT ID, Index, STATUS, TIME, DESCRIPTION, 
    MIN(Index) OVER (PARTITION BY ID) AS first_index,
    MAX(CASE WHEN STATUS = 'complete' then 1 else 0 end) OVER (PARTITION BY ID) AS is_complete
   FROM myTable1
) a
WHERE a.is_complete = 1 AND (a.status = 'complete' OR a.index = a.first_index) 
```

换句话说，选择第一行和最后一行已经完成的事件。

# android - OnCreate 中的 NoClassDefFoundError - 仅偶尔发生一次

> ID：10866488
> 
> 赞同：1
> 
> 时间：2012-06-02T22:41:51.667
> 
> 标签：android, noclassdeffounderror

出于某种奇怪的原因，在我自己的 Android 库（即我自己的代码，而不是第 3 方库代码）中创建类的实例时，我得到了 NoClassDefFoundError。这种情况*很少*发生，所以这不是无效类路径或其他问题。而且由于它是我自己的类被实例化，所以这不是某些 Android 版本中未定义的类的问题。

有什么想法吗？

谢谢

# c++ - 为什么 gcc 不能推断数组参数的模板大小？(C++11)

> ID：10866489
> 
> 赞同：10
> 
> 时间：2012-06-02T22:41:54.907
> 
> 标签：c++, templates, gcc, c++11

**以下代码给出了编译器错误（gcc-4.7 run with `-std=c++11`）：**

```
#include <iostream>
#include <array>

template <typename T, int N>
std::ostream & operator <<(std::ostream & os, const std::array<T, N> & arr) {
  int i;
  for (i=0; i<N-1; ++i)
    os << arr[i] << " ";
  os << arr[i];
  return os;
}

int main() {
  std::array<double, 2> lower{1.0, 1.0};
  std::cout << lower << std::endl;
  return 0;
} 
```

**错误信息：**

> tmp6.cpp：在函数“int main()”中：tmp6.cpp:16:16：错误：无法将
> “std::ostream {aka std::basic_ostream}”左值绑定到
> “std::basic_ostream&&”在包含的文件中
> /usr/include/c++/4.7/iostream:40:0，
> 来自 tmp6.cpp:1: /usr/include/c++/4.7/ostream:600:5: 错误：初始化 'std::basic_ostream<_CharT 的参数 1 ,
> _Traits>& std::operator<<(std::basic_ostream<_CharT, _Traits>&&, const _Tp&) [with _CharT = char; _Traits = std::char_traits; _Tp = std::array]'<br>

当我摆脱模板函数声明并替换`T`为`double`和`N`替换时`2`，它编译得很好（**编辑：离开`T`并替换`N`为 2 工作，但指定`N=2`为默认参数`N`不起作用。**）。

1.  有谁知道为什么 gcc 不能自动绑定这个？
2.  ~~`<<`使用显式指定的模板参数调用运算符的语法是什么？~~

**回答问题 2：** `operator<<<double, 2>(std::cout, lower);`

**编辑：**以下函数也是如此，它仅以数组大小为模板：

```
template <int N>
void print(const std::array<double, N> & arr) {
  std::cout << "print array here" << std::endl;
}

int main() {
  std::array<double, 2> lower{1.0, 1.0};
  print<2>(lower); // this works
  print(lower);    // this does NOT work
  return 0;
} 
```

非常感谢你的帮助。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-02T23:08:01.863

考虑您的声明：

```
template <typename T, int N>
std::ostream & operator <<(std::ostream & os, const std::array<T, N> & arr) { 
```

的定义`std::array`是：

```
template<typename T, std::size_t N> class array {...}; 
```

您正在使用`int`而不是`std::size_t`，这就是它不*匹配*的原因。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-02T22:56:38.457

您可以`operator<<`以这种不那么美观的方式使用指定的模板参数进行调用：

```
operator<< <double,2>(std::cout, lower) << std::endl; 
```

# objective-c - NSStatusBar 项目在 Xcode 上没有发光图像的发光

> ID：10866491
> 
> 赞同：0
> 
> 时间：2012-06-02T22:42:36.707
> 
> 标签：objective-c, xcode, macos, nsstatusitem, nsstatusbar

我怎样才能在状态栏项目上制作像这样的光芒？
![在此处输入图像描述](../Images/f0adca3f3dcbb67b866db2f80f076be2.png)

我知道我可以用另一个 png 来做到这一点，但我见过一些其他应用程序，它们只有状态栏的黑色图标，没有发光。
我怎样才能做到这一点？
谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-02T22:45:11.507

只需在自定义视图中使用白色阴影（一些模糊半径，无偏移）绘制您的图像。[`NSShadow`](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/ApplicationKit/Classes/NSShadow_Class/Reference/Reference.html)使这很容易做到。

# java - 在 Java 中，创建支持不同分辨率/显示模式的应用程序

> ID：10866493
> 
> 赞同：1
> 
> 时间：2012-06-02T22:43:32.167
> 
> 标签：java, image, io, resolution

我是一名初学者，正在学习用 JAVA 编写游戏。

在我正在编写的游戏中，我试图让它支持多种显示模式。首先让我告诉你一些关于我如何设置显示设置的信息。

在代码的开头，我列出了我希望支持的显示模式

```
//List of supported display modes
private static DisplayMode modes[] = {
    new DisplayMode(640, 480, 32, 0),
    new DisplayMode(1024, 768, 32, 0),
}; 
```

然后我从显卡中获取支持的显示模式列表，比较列表并使用第一个匹配的显示模式。

```
/////////////////////////////////////////////
////Variable Declaration
/////////////////////////////////////////////
private GraphicsDevice vc;

/////////////////////////////////////////////   
//Give Video Card Access to Monitor Screen
/////////////////////////////////////////////
public ScreenManager(){
    GraphicsEnvironment e = GraphicsEnvironment.getLocalGraphicsEnvironment();
    vc = e.getDefaultScreenDevice();
}
/////////////////////////////////////////////
//Find Compatible display mode
/////////////////////////////////////////////
//Compare Display mode supported by the application and display modes supported by the video card
//Use the first matching display mode;
public DisplayMode findFirstCompatibleMode(DisplayMode modes[]){
    DisplayMode goodModes[] = vc.getDisplayModes();
    for(int x=0; x<modes.length; x++){
        for(int y=0; y<goodModes.length; y++){
            if (displayModesMatch(modes[x], goodModes[y])){
                return modes[x];
            }
        }
    }
    return null;
}

/////////////////////////////////////////////   
//Checks if two Display Modes match each other
/////////////////////////////////////////////
public boolean displayModesMatch(DisplayMode m1, DisplayMode m2){

    //Test Resolution
    if (m1.getWidth() != m2.getWidth() || m1.getHeight() != m2.getHeight()){
        return false;
    }

    //Test BitDepth
    if (m1.getBitDepth() != DisplayMode.BIT_DEPTH_MULTI && m2.getBitDepth() != DisplayMode.BIT_DEPTH_MULTI
            && m1.getBitDepth() != m2.getBitDepth()){
        return false;
    }

    //Test Refresh Rate
    if (m1.getRefreshRate() != DisplayMode.REFRESH_RATE_UNKNOWN &&
            m2.getRefreshRate() != DisplayMode.REFRESH_RATE_UNKNOWN &&
            m1.getRefreshRate() != m2.getRefreshRate()){
        return false;
    }

    return true;
} 
```

目前，我只支持两种分辨率，640x480 和 1024x768。

为了让我的游戏的每一个元素都可以在两种分辨率下使用，首先我找到屏幕调整了多少，并将这个值存储在一个名为 resizeRatio 的变量中

```
private void getResizeRatio(){
    resizeRatio = (double)1024/(double)s.getWidth();
    //s.getWidth() returns the current width of the screen.
} 
```

对于我导入的每张图像，我都会将图像的高度和宽度除以这个 resizeRatio。

```
/////////////////////////////////////////////
//Scale the image to the right proportion for the resolution
/////////////////////////////////////////////
protected Image scaleImage(Image in){
    Image out = in.getScaledInstance((int)(in.getWidth(null)/resizeRatio), (int)(in.getHeight(null)/resizeRatio), Image.SCALE_SMOOTH);
    return out;
} 
```

这一切都很好，直到我的应用程序变得越来越大。很快我意识到我忘了调整一些图标的大小，当分辨率为 640x480 时，它们都在错误的位置。

此外，我意识到我必须缩放，不仅是所有图像的大小，还包括所有移动速度和所有位置，因为让我的角色在每次刷新时移动 5px 会使他在以 640x480 显示时移动得比在以 1024x768 显示

所以我的问题是，不是单独缩放每个图像、每个图标和每个动作，有没有办法一次缩放所有内容？或者更确切地说，必须有另一种方式来做到这一点，所以有人可以告诉我吗？

感谢您的阅读，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-02T22:56:24.853

在`paintComponent(Graphics g)`or`paint`方法中，您可以使用[Graphics2D.scale](http://docs.oracle.com/javase/7/docs/api/java/awt/Graphics2D.html#scale%28double,%20double%29)：

```
private double scale = 0.75;

@override
public void paintComponent(Graphics g) {
    Graphics2D g2 = (Graphics2D)g; // The newer more ellaborate child class.
    g2.scale(scale, scale);
    ...
    g2.scale(1/scale, 1/scale);
} 
```

# c++ - 提升库和 dll

> ID：10866497
> 
> 赞同：0
> 
> 时间：2012-06-02T22:44:15.373
> 
> 标签：c++, boost

我已经下载了boost包，现在我想从源代码中制作dll文件和库，但是在网上没有解释如何做到这一点？另外，我不确定如何构建它以获取包含文件或来自它的任何内容。如果有人告诉我如何为 Windows 平台设置 boost 的知识，那就太好了。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-02T22:50:31.560

我刚刚写了一个包含库[的答案：](https://stackoverflow.com/a/10866511/825637)

> 您需要在链接器输入中包含该库。
> 
> 对于 VS：
> 
> 1.  将库的文件放在解决方案的根文件夹中。（对于某些库，您通常不必这样做）
> 2.  在 Visual Studios 菜单中，转到 Project --> [SolutionName] 属性。
> 3.  将打开一个对话框。导航到配置属性 --> 链接器 --> 输入
> 4.  在“附加依赖项”中添加库的名称。（可能是 *.lib）

# java - 将 Arrow Keylistener 添加到实现 ActionListener 的 Jframe

> ID：10866501
> 
> 赞同：2
> 
> 时间：2012-06-02T22:45:24.203
> 
> 标签：java, swing, events, jframe, keylistener

我正在开发一个 java 应用程序。我想在箭头键上实现一个 KeyListener。我有一个扩展 JFrame 并实现 ActionListener 的类

```
public class MyClass extends JFrame implements ActionListener{
} 
```

如何在此框架中的箭头键上添加键盘侦听器？

我尝试在构造函数中执行以下操作，但没有成功：

```
 this.addKeyListener(new KeyListener() {

        @Override
        public void keyPressed(KeyEvent e) {
            if(e.getKeyCode() == KeyEvent.VK_UP)
            {
               //DO Some things
            }
        }

        @Override
        public void keyTyped(KeyEvent e) {

        }

        @Override
        public void keyReleased(KeyEvent e) {

        }

    }); 
```

任何帮助是极大的赞赏。谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-02T22:49:52.783

这可以通过在使 JFrame 可聚焦后为其提供焦点来解决，但是一旦失去焦点，KeyListener 将无法工作。我的主要建议是不要使用 KeyListener 而是使用 Key Bindings，因为这些函数是更高级别的构造，并且可以很好地与 Swing 应用程序配合使用，尤其是在获得和失去焦点方面。关于这个主题有很多类似的帖子，如果你坚持下去，我会给你一些链接。

*   [Key Bindings Tutorial](http://docs.oracle.com/javase/tutorial/uiswing/misc/keybinding.html)
*   A Key Bindings example that uses arrow keys can be found here: [java keylistener not registering arrow keys](https://stackoverflow.com/questions/8961938)
*   Another example: [java keylistener not called](https://stackoverflow.com/questions/8482268/java-keylistener-not-called)

# couchbase - 在沙发库中分离数据的正确方法是什么

> ID：10866505
> 
> 赞同：5
> 
> 时间：2012-06-02T22:45:56.467
> 
> 标签：couchbase

我正在考虑为我的下一个 Web 应用程序使用 couchbase，我想知道我的数据应该如何构建，特别是存储桶的使用。例如，假设每个用户都将拥有很多独特的数据，是否应该为每个用户创建一个单独的存储桶（甚至可能为不同类别的数据）？另外我想知道使用存储桶分离数据是否有任何真正的优势/劣势（除了明显的组织优势），而不是简单地将所有内容存储在一个存储桶中。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-03T04:54:14.797

使用更多或更少的存储桶不会获得任何性能提升。Couchbase 有存储桶的原因是它可以是多租户的。我能想到的使用多个存储桶的最佳用例是，如果您是托管服务提供商，并且您希望不同的用户使用同一数据库服务器。存储桶可以受密码保护，并且会阻止一个用户访问另一个用户的数据。

有些人出于组织目的创建多个存储桶。也许您正在运行两个不同的应用程序，并且您希望数据是分开的，或者正如您所提到的，您可能希望按类别拆分数据。

在管理方面，尽管最好为您的应用程序创建尽可能少的存储桶，因为它会通过减少您需要从 Web 层（客户端）到 Couchbase 的连接数量来简化您的客户端逻辑。对于您拥有的每个存储桶，您必须创建一个单独的客户端连接。

# android - DownloadManager 在完成时删除文件

> ID：10866508
> 
> 赞同：4
> 
> 时间：2012-06-02T22:46:54.743
> 
> 标签：android, download-manager

我有一个应用程序，它使用 Android 的[DownloadManager](http://developer.android.com/reference/android/app/DownloadManager.html)将文件下载到外部文件存储（SD 卡）上的文件夹中。这通常可以正常工作，但有一些来源会导致 DownloadManager 在完成下载文件时将其丢弃。源文件的一个很好的例子是：

[http://traffic.libsyn.com/hdtvpodcast/HDTV-2012-06-01.mp3](http://traffic.libsyn.com/hdtvpodcast/HDTV-2012-06-01.mp3)

看起来问题可能只是来自 libsyn.com 的文件，但我并不肯定。我四处寻找改变 DownloadManager 处理文件保存方式的方法，但在类中找不到任何选项。

这是我将 URL 排入队列以供下载的位置：

```
request = new Request(Uri.parse(currUrl));
external = Uri.fromFile(externalFile);
request.setDestinationUri(external);
request.setVisibleInDownloadsUi(false);
request.setNotificationVisibility(
    DownloadManager.Request.VISIBILITY_HIDDEN);
currDownloadId = dm.enqueue(request); 
```

使用以下命令创建文件位置：

```
Environment.getExternalStorageDirectory().getAbsolutePath() + 
    File.separator + "Podcatcher" + File.separator + "Feeds" + File.separator + 
    [int] + File.separator + [int] + [string extension]; 
```

当我从 DownloadManager 查询 DownloadManager.COLUMN_LOCAL_FILENAME 列时，结果是这样的：

```
/mnt/sdcard/Podcatcher/Feeds/19/225.mp3 
```

大多数文件都很好并且在下载后仍然存在，但在这种情况下不是。关于如何在下载文件后强制 DownloadManager 离开文件的任何想法？

编辑：我没有提到，当我从浏览器下载此文件时使用独立的下载管理器时，它在下载结束时报告失败。也许我唯一的解决方案是从头开始下载它，而不使用 DownloadManager？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T09:07:23.550

请尝试遵循代码 - 为我工作：

```
request.setMimeType(application/octet-stream); 
```

# objective-c - 什么时候创建视图？

> ID：10866518
> 
> 赞同：0
> 
> 时间：2012-06-02T22:48:48.830
> 
> 标签：objective-c, ios, uiwebview

我提前为 n00b 问题道歉。我刚刚开始使用 iOS！

我正在尝试将 webViewController 推送到导航控制器上。

```
mudWebViewController *webViewController = [[mudWebViewController alloc] initWithNibName:nil bundle:nil];
[[webViewController webView] setDelegate:webViewController];
[[self navigationController] pushViewController:webViewController animated:YES]; 
```

但这似乎不起作用，因为我在委托消息中看不到任何日志。

如果我在 viewDidLoad: 方法中设置委托，它工作正常。

我猜当时 webView 实际上并不存在，但为什么呢？如果我初始化控制器，webView不应该也被初始化吗？

viewDidLoad: 是设置这些东西的正确位置吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-02T23:03:11.630

initWithNibName 不应该是 nil，因为您显然正在使用 nib 文件来构建视图，否则您必须在代码中创建视图，而您不需要

```
mudWebViewController *webViewController = [[mudWebViewController alloc] initWithNibName:@"webViewController" bundle:nil];
[[self navigationController] pushViewController:webViewController animated:YES]; 
```

此外，任何委托都应该从 Interface builder 或 viewDidLoad 委托中的视图本身设置，而不是从前一个类设置，因为该对象可能尚未在代码中初始化，因此可能无法正确设置委托。

# ios - iOS 5.0 的 iOS setting.bundle 问题

> ID：10866520
> 
> 赞同：0
> 
> 时间：2012-06-02T22:49:18.783
> 
> 标签：ios

与 iOS 4.3 相比，iOS 5.0 中的 settings.bundle 和 NSUserDefeauts 有什么变化吗？

我的问题如下。如果我有一个工具开关和一个默认值为 no。然后我启动设置应用程序并向下滚动到我的应用程序并点击它。NSUserDetaults 被设置为默认值 NO。这发生在 iOS 5.0 中。我不认为这发生在 iOS 4.3 上。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-03T03:33:25.213

Plists 永远不会完全越过管道。清理，清理构建文件夹，如果一切都失败了，请转到管理器并删除项目的派生数据。尽你所能让 Xcode 必须在你的沙箱中重建文件层次结构，它会复制 plist。我发现，如果您在 Settings.app 中点击不同的选项卡，然后在启动新版本之前将其关闭，这也会有所帮助，因为可能正在进行某种缓存。

# browser - 我正在尝试使用 webclient 检索网页 html 并在 C# 中使用 webbrowser 显示它

> ID：10866522
> 
> 赞同：2
> 
> 时间：2012-06-02T22:49:48.080
> 
> 标签：browser, webclient

我有以下代码片段：

```
WebClient client = new WebClient();
String htmlCode = client.DownloadString(newurl);
webBrowser1.DocumentText = htmlCode; 
```

顺便说一句，webBrowser1 在程序的其他地方全局定义。同样，“newurl”是在其他地方全局定义的有效 url。

WebClient 获取我使用 DocumentText 传递给 webbrowser1 的完整 html。

此结果是各种链接、语法、远程 javascript 和其他错误，就好像 html 已损坏一样。但是，如果我使用

```
webbrowser1.Navigate(newurl); 
```

目标页面显示得很好。

我正在获取源 html，因此我可以在显示它之前进行更改。

显然我错过了一些东西。

有什么想法吗？

问候，吉姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-02T23:09:41.423

`webBrowser1.DocumentText = htmlCode;`将仅设置 HTML，但不会加载任何链接的资源，例如 JS、图像、CSS、...。

如果你想做，你似乎想做，你可以例如通过 a 加载 HTML `WebClient`，重写它（这包括将相对路径更改为绝对路径或设置基本 url），将其写入文件，然后`webbrowser1.Navigate("file://path/to/file");`

# jquery-mobile - KnockoutJS 嵌套的 foreach 未定义

> ID：10866534
> 
> 赞同：1
> 
> 时间：2012-06-02T22:52:02.590
> 
> 标签：jquery-mobile, knockout.js, knockout-2.0

我会保持简短。我的视图模型如下所示：

```
var ViewModel = {
    Cameras: ko.observableArray(),
    Current: ko.observableArray()
}; 
```

我想做这样的事情：

```
<!-- ko foreach: Cameras -->
    <div data-role="collapsible">
        <h3 data-bind="text: CameraName"></h3>
        <!-- ko foreach: Current -->
            <img data-bind="attr: { src: URL }" />
        <!-- /ko -->
    </div>
<!-- /ko --> 
```

CameraName 属性来自 Cameras 数组，而 URL 属性来自 Current 数组，但是当我这样做时，我得到“当前未定义”。我已经研究过嵌套的 foreach ，但一定有一些我不能正确理解的东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-02T22:54:04.543

`Current`必须是 中项目的属性`Cameras`。

像这样...

```
var Camera = function() {
    this.Current = ...
} 
```

你可以试试 Knockout 2.1 的`$parent`。

```
<!-- ko foreach: Cameras -->
    <div data-role="collapsible">
        <h3 data-bind="text: CameraName"></h3>
        <!-- ko foreach: $parent.Current -->
            <img data-bind="attr: { src: URL }" />
        <!-- /ko -->
    </div>
<!-- /ko --> 
```

# uitableview - 为什么 cellForRowAtIndexPath 有时会添加一个 gradientLayer？

> ID：10866537
> 
> 赞同：0
> 
> 时间：2012-06-02T22:52:36.993
> 
> 标签：uitableview

我有一个看起来像这样的函数：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
// instantiate the cell

if(indexPath.row >=4 && indexPath.row <=5)
{
[CustomTableCell addGradient];
}
} 
```

所以基本上，只有第 4 行和第 5 行应该有渐变背景。当 tableview 首次加载时，只有第 0 到 4 行是可见的，并且没有完美的渐变背景。当我向下滚动一点以查看第 4 行和第 5 行时，渐变出现在它们上面，这再次很棒。但是当我向上滚动到第一行时，突然间我在第一行看到了一个渐变！！！但我从未要求第 0 行有渐变！此外，当我向下滚动一点时，我看到渐变应用于某些行而不是其他行。为什么会这样？

这是有用的 addGradient 函数：

```
- (void) addGradient
{
    if([self.layer.sublayers count] >0)
    {
        if([[self.layer.sublayers objectAtIndex:0] isKindOfClass:[CAGradientLayer class]])
            return;
    }

    CAGradientLayer *gradient = [CAGradientLayer layer];
    gradient.frame = self.bounds;

    gradient.colors = [NSArray arrayWithObjects:(id)[UIColor blueColor].CGColor, (id)[UIColor redColor].CGColor, nil];

    [self.layer insertSublayer:gradient atIndex:0];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-03T09:54:54.280

我刚刚意识到 iPhone/cocoa 实际上是在为 cellForRowAtIndexpath 重新使用内存中的现有单元格来绘制出现在屏幕上的单元格。所以这就是为什么单元格仍然有一个我之前设置的渐变层。因此，我使用以下代码更新了我的 stylecell 函数以删除层（如果存在）：

```
- (void) styleCell
{
    if([self.layer.sublayers count] >0)
    {
        if([[self.layer.sublayers objectAtIndex:0] isKindOfClass:[CAGradientLayer class]])
        {
            [[self.layer.sublayers objectAtIndex:0] removeFromSuperlayer];
//            return;
        }
    }

    CAGradientLayer *gradient = [CAGradientLayer layer];
    gradient.frame = self.bounds;

    gradient.colors = [NSArray arrayWithObjects:(id)[UIColor blueColor].CGColor, (id)[UIColor redColor].CGColor, nil];

    [self.layer insertSublayer:gradient atIndex:0];
}
@end 
```

# php - codeigniter 控制器索引函数调用需要它的名字

> ID：10866540
> 
> 赞同：1
> 
> 时间：2012-06-02T22:53:23.153
> 
> 标签：php, function, codeigniter, controller, call

我有一个名为 Categories 的控制器和一个名为 index 的函数，带有 1 个参数 $cat_id

所以它看起来像这样：

```
<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed');

class categories extends CI_Controller {

    function __construct(){
        parent::__construct();
    }

    public function index($cat_id = null){

    }
} 
```

当我从浏览器调用它时问题就来了......我用这个：

```
http://www.mysite.dev/categories/12311323 
```

但返回 404 错误页面

相反，如果我使用

```
http://www.mysite.dev/categories/index/12313131 
```

会正常工作...

我如何确保它不需要索引功能的 URL 中的索引？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-02T23:05:02.160

默认的 CodeIgniter 路由是 /controller/function/argument。为了指定参数，您需要首先指定函数。如果要指定不带函数的参数，则需要定义自定义路由。将此行添加到您的路由配置文件应该可以满足您的需求。

```
$route['categories/(:num)'] = "categories/index/$1"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-02T23:01:48.990

您描述的是 CI 的默认（预配置）路由。您可以定义自己的模式，以使您在问题中描述的模式起作用。请参阅：[URI 路由](http://codeigniter.com/user_guide/general/routing.html)

# javascript - 如何使用图像 DOM 元素作为 jCanvas 中源属性的值？

> ID：10866544
> 
> 赞同：0
> 
> 时间：2012-06-02T22:54:03.687
> 
> 标签：javascript, jquery, jcanvas

我想测试这个例子：[http ://calebevans.me/projects/jcanvas/sandbox.php#%24%28%22canvas%22%29.drawImage%28%7B%0A%20%20source%3A%20% 24%28%27%23image-fish%27%29%5B0%5D%2C%0A%20%20x%3A%2050%2C%20y%3A%2050%2C%0A%20%20width%3A%20100% 2C%0A%20%20fromCenter%3A%20false%0A%7D%29%3B](http://calebevans.me/projects/jcanvas/sandbox.php#%24%28%22canvas%22%29.drawImage%28%7B%0A%20%20source%3A%20%24%28%27%23image-fish%27%29%5B0%5D%2C%0A%20%20x%3A%2050%2C%20y%3A%2050%2C%0A%20%20width%3A%20100%2C%0A%20%20fromCenter%3A%20false%0A%7D%29%3B)

但我在浏览器中看不到任何结果，除了默认的图像“img src”。请有人帮助我。我怎样才能使用这个功能？

```
 <!doctype html>
    <html>
      <head>
        <meta charset="utf-8">
        <title>Demo</title> 
        <canvas width="500" height="250"></canvas> 
      </head>
        <script src="jquery.js"></script>
        <script src="jcanvas.js"></script>
        <script>

        $("canvas").drawImage({
        source: $('#draggable')[0],
        x: 50, y: 50,
        width: 60,
        fromCenter: false
        });

        </script>            
         <body>
            <img src="../image/0.jpg" class="drag-image" id="draggable"/>
        </div>
      </body>
    </html> 
```

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-04T18:34:41.647

设置画布标签的源时，图像标签未完全加载。结果， $('#draggable')[0] 返回未定义。尝试在加载文档时调用 drawImage。以下应该可以解决您的问题。

```
 <!doctype html>
    <html>
      <head>
        <meta charset="utf-8">
        <title>Demo</title> 
        <canvas width="500" height="250"></canvas> 
      </head>
        <script src="jquery.js"></script>
        <script src="jcanvas.js"></script>
        <script>

        $(document).ready(function(){
            $("canvas").drawImage({
                 source: $('#draggable')[0],
                 x: 50, y: 50,
                 width: 60,
                 fromCenter: false
              });
         });

        </script>            
         <body>
            <img src="../image/0.jpg" class="drag-image" id="draggable"/>
        </div>
      </body>
    </html> 
```

# sql-server - 触发器不在生产中触发，但在非生产中触发

> ID：10866548
> 
> 赞同：0
> 
> 时间：2012-06-02T22:55:22.570
> 
> 标签：sql-server, tsql, triggers, sql-server-2008-r2

我有一个触发器在非生产环境中触发，但相同的代码在生产环境中无法触发。我已经确认它没有被禁用，并且我已经进行了跟踪以查看它甚至没有在生产中执行。我检查了相关`OBJECTPROPERTY`元素并且它们是相同的。我已经确认代码是相同的。我已经确认相同的插入来自应用程序。下面是这个触发器的代码：

```
/****** 
  Object:  Trigger [dbo].[tr_trigger_ins]    
  Script Date: 06/02/2012 16:51:51 
******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER OFF
GO

CREATE TRIGGER [dbo].[tr_trigger_ins] ON [dbo].[table_1]
FOR INSERT
AS
BEGIN
  UPDATE table_2
    SET col_1 =
      CASE 
        WHEN i.col_2 = '0' THEN 0 ELSE 1
      END
  FROM INSERTED i
  INNER JOIN table_3 pa 
    ON i.col_3 = pa.col_3 AND pa.col_4 = 'ispublic'
  INNER JOIN table_4 pp  
    ON i.col_5 = pp.col_5
  INNER JOIN table_2 cs
    ON pp.col_6 = cs.col_6
END
GO 
```

下面是一个触发器，它是在两个环境中执行的同一个表上的插入而不是插入：

```
/****** 
  Object:  Trigger [dbo].[tr_trigger_before_ins]    
  Script Date: 06/02/2012 16:55:52 
******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER OFF
GO

CREATE TRIGGER [dbo].[tr_trigger_before_ins] ON [dbo].[table_1]
INSTEAD OF INSERT
AS
BEGIN
  INSERT INTO table_1
    SELECT * FROM INSERTED
    WHERE col_3 in (73, 199)
END
GO 
```

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-02T23:13:49.287

首先确保触发器没有被禁用：

```
ENABLE Trigger tr_trigger_ins ON dbo.table_1;
GO 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T13:40:14.037

最终归结为复制问题。交易以与预期不同的顺序流动。一旦我们在触发逻辑中适应了这一点，它就会运行良好。

# javascript - Javascript 事件处理程序和 While 循环混淆

> ID：10866549
> 
> 赞同：0
> 
> 时间：2012-06-02T22:55:24.043
> 
> 标签：javascript, ajax

我正在阅读 Head First AJAX，当我在第 7 章中遇到一些代码时变得有点困惑。本章构建了一个应用程序，该应用程序随机生成用户用来创建单词的字母板。创建单词后，用户单击提交，然后对该单词进行评分。下面是为单词提交设置事件处理程序的代码：

```
function initPage() {
  randomizeTiles();
  var submitDiv = document.getElementById("submit");
  while (a.nodeName == "#text") {
    a = a.nextSibling;
  }
  a.onclick = function() { 
    alert("Please click tiles to add letters and create a word."); 
  };
} 
```

这是提交按钮的html：

```
<div id="submit"><a href="#">Submit Word</a></div> 
```

我对设置事件处理程序时使用的 while 循环感到困惑。根据我的理解，while 循环查看标签中是否有文本。如果有，它将获得下一个兄弟姐妹。但是，下一个兄弟姐妹是什么？标签内只有一个节点，即文本。那里会有什么吗？为什么这里有一个while循环，为什么它不只是一个if语句？

应用程序演示： [http](http://www.headfirstlabs.com/books/hfajax/ch07/woggle-puzzle.html#) ://www.headfirstlabs.com/books/hfajax/ch07/woggle-puzzle.html# 应用程序文件： [http ://www.headfirstlabs.com/books/hfajax/ch07/](http://www.headfirstlabs.com/books/hfajax/ch07/)

任何和所有输入将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-02T23:17:04.923

该代码处理您将在 div 元素中放入其他内容的情况，例如空格字符：

```
<div id="submit">
  <a href="#">Submit Word</a>
</div> 
```

这将在某些浏览器中的链接之前生成一个文本节点。

为什么有一个`while`而不只是一个`if`可能只是为了谨慎。如果某些浏览器将文本节点放在那里，则某些浏览器可能会使其超过一个文本节点。

# android - Android：以编程方式在布局中的视图上绘制形状

> ID：10866551
> 
> 赞同：0
> 
> 时间：2012-06-02T22:55:29.763
> 
> 标签：android, layout, dynamic, view, shape

关于此的文档确实令人困惑。我只需要将矩形添加到我在 main.xml 布局文件中定义的视图中。这将是布局的一小部分。

我想要实现的是，我想在房间中添加架子，但由于房间形状和架子发生了变化，我需要以编程方式添加它们。

下面是我的 main.xml 文件的一小部分，你可以看到我定义的视图：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout
    android:id="@+id/relativeLayout2"
    android:layout_width="600dp"
    android:layout_height="650dp"
    android:layout_marginTop="70dp"
    android:layout_marginLeft="30dp"
    android:layout_toRightOf="@+id/relativeLayout1" >

    <TextView
        android:id="@+id/textView3"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerHorizontal="true"
        android:text="@string/getDirections"
        android:textSize="20dp"
        android:textStyle="bold" />

    <View
        android:id="@+id/roomplan"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
            android:layout_below="@+id/textView3"
        android:layout_marginTop="40dp"
        android:background="@android:color/white" />

</RelativeLayout> 
```

这是我为处理动态更改而创建的自定义 View 类：

```
public class CustomView extends View {
    ShapeDrawable roomFrame;
    ArrayList<ShapeDrawable> shelfFrames;

    public CustomView(Context context) {
        super(context);
        // TODO Auto-generated constructor stub
    }

    @Override
    protected void onDraw(Canvas canvas){
        super.onDraw(canvas);
        roomFrame.draw(canvas);
        for (ShapeDrawable shelfFrame : shelfFrames){
            shelfFrame.draw(canvas);
        }
    }

    public void setRoom(Stage stage){
        roomFrame = new ShapeDrawable(new RectShape());
        roomFrame.getPaint().setColor(0xff74AC23);   
        roomFrame.setBounds(10, 10, stage.getWidth(), stage.getHeight());
    }

    public void setShelves(ArrayList<Shelf> shelves){
        shelfFrames = new ArrayList<ShapeDrawable>();
        for(int i = 0; i<shelves.size(); i++){
            ShapeDrawable shelfFrame = new ShapeDrawable(new RectShape());
            shelfFrame.getPaint().setColor(0xff74AC23);
            shelfFrame.setBounds(shelves.get(i).getXPosition(), shelves.get(i).getYPosition(), shelves.get(i).getWidth(), shelves.get(i).getHeight());
            shelfFrames.add(shelfFrame);
        }
    }
} 
```

现在简单地说，当询问新房间计划时，我试图将此类分配给 xml 布局中的 View 对象：

```
public void loadRoomPlan(Room room, ArrayList<Shelf> shelves){
    CustomView asdsView = (CustomView)findViewById(R.id.roomplan);
    asdsView.setRoom(room);
    asdsView.setShelves(shelves);
    asdsView.invalidate();
} 
```

我总是得到

> 引起：java.lang.ClassCastException: android.view.View 无法转换为 org.example.myproject.CustomView

错误。

可能我这样做非常非常错误，不是吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-02T23:06:37.917

错误似乎在这一行：

```
CustomView asdsView = (CustomView)findViewById(R.id.shopplan); 
```

What is `shopplan`? In case it is a mistake and you meant `R.id.roomplan` try to subtitute the View in your layout for your Custom view:

```
<org.example.myproject.CustomView
    android:id="@+id/roomplan"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_below="@+id/textView3"
    android:layout_marginTop="40dp"
    android:background="@android:color/white" /> 
```

**UPDATE:**

Try adding the other two constructors to your `CustomView` class:

```
public CustomView(Context context, AttributeSet attrs) {
    super(context, attrs);
}

public CustomView(Context context, AttributeSet attrs, int defStyle) {
    super(context, attrs, defStyle);
} 
```

When you use a custom view in an xml layout, your view has to deal with the layout attributes (the constructor AttributeSet param).

# performance - Cocoa OpenGL 解锁帧率

> ID：10866561
> 
> 赞同：2
> 
> 时间：2012-06-02T22:58:24.923
> 
> 标签：performance, macos, cocoa, opengl, frame-rate

我希望能够在没有锁定帧速率（当前为 60 fps）的情况下运行我的游戏。我发现运行动画的唯一方法是使用 NSTimer。有没有办法在 Cocoa 中拥有不受限制的帧速率。如果是这样，链接或代码片段将有很大帮助。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-04T12:37:26.980

如果你真的想这样做，你可能需要使用[CGL](https://developer.apple.com/library/mac/#documentation/graphicsimaging/reference/CGL_OpenGL/Reference/reference.html)接口。在有效的 GL 上下文中，`CGLGetCurrentContext`返回一个（不透明的）上下文对象。`CGLSetParameter`可用于设置`kCGLCPSwapInterval`参数的值。值`(0)`禁用等待垂直同步。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-09-05T04:13:38.753

这使我能够在我的 MacBook Pro 上获得大约每秒 700 帧

*   [下载 Xcode 图形工具 - 2014 年 8 月下旬](https://developer.apple.com/downloads/index.action?q=graphics)
*   安装或仅安装**图形工具**
*   打开**石英调试**
*   转到工具 -> 显示光束同步工具
*   选择禁用光束同步

它也不是永久性的，非常适合测试/基准测试。

[来源](https://discussions.apple.com/message/2962693#discussion-2959446)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-12-10T07:30:43.457

Xcode 11（4.2 版）中的 Quartz 调试器将其移至：

工具->石英调试设置->启用垂直同步

# java - 加载 bufferedImage 会禁用 JPanel 的 paintCompontent 方法

> ID：10866562
> 
> 赞同：2
> 
> 时间：2012-06-02T22:58:33.410
> 
> 标签：java, swing, jpanel, bufferedimage

我对 BufferedImage 和 JPanel 有一点问题。我正在创建一个带有一些 2d 动画的游戏。

基本上我有一个动画处理程序，它将遍历图片，并且根据旋转也将正确显示它。但问题是 - 当我加载图片时，我的 Jpanel 不会画任何东西。如果我注释掉自定义绘制方法并不重要——paintComponent 方法不会绘制任何东西，而且它似乎跳过了paintCompontent 方法。即使游戏没有崩溃并且计时器仍在运行 - 它不会在扩展的 JPanel 中使用 paintComponent 方法。

包含计时器的类 - 通过 JPanel.repaint() 调用 JPanel；

这是 loadImg 方法

```
/**
 * Test method to check animationHandler and bufferedImgs
 */
private void loadImages() {
    BufferedImage b_1;
    BufferedImage b_2;
    BufferedImage b_3;
    BufferedImage b_4;
    BufferedImage b_5;

    BufferedImage[] imgs = new BufferedImage[5];
    try {
        b_1 = ImageIO.read(new File("warlock1.png"));
        b_2 = ImageIO.read(new File("warlock2.png"));
        b_3 = ImageIO.read(new File("warlock3.png"));
        b_4 = ImageIO.read(new File("warlock4.png"));
        b_5 = ImageIO.read(new File("warlock5.png"));

        imgs[0] = b_1;
        imgs[1] = b_2;
        imgs[2] = b_3;
        imgs[3] = b_4;
        imgs[4] = b_5;

        animationHandler.addAnimation(imgs);
    } catch (Exception e) {
        e.printStackTrace();
    }
} 
```

干杯!

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-02T23:01:59.387

您可能正在 Swing 事件线程或 EDT（事件调度线程）上加载图像，并且由于 EDT 负责所有 Swing 图形和用户交互，这将冻结您的 Swing 应用程序，直到加载完成。解决方案：在后台线程上加载图像，例如可以从 SwingWorker 对象获取。有关此主题的更多信息，请查看[Swing 中的并发](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/index.html)教程。

此外，如果可能，并且如果图像不是太大，通常最好加载一次图像，然后保存对它们或 ImageIcon 的引用。

最后，无论你做什么，都不要在`paintComponent(...)`方法中加载图像。这种方法必须精益求精——尽可能快，它应该*只*关注绘画，不关注其他。否则，您的程序的响应速度可能会变得非常缓慢。

另外，关于：

> 它不会在扩展的 JPanel 中使用paintComponent 方法。

您可能想向我们展示此代码。

# c++ - 如何在win32 C++项目visual studio 2010中使用ActiveX dll

> ID：10866567
> 
> 赞同：2
> 
> 时间：2012-06-02T22:59:14.057
> 
> 标签：c++, visual-studio-2010, winapi, dll, activex

背景：供应商为我提供了 ActiveX Dll，没有头文件或 .tlb 文件或任何类似的东西。我正在使用 Visual Stdio 2010 并使用 win32 C++。

我面临的问题是如何加载或引用 dll？

我无法通过解决方案资源管理器引用 dll，因为它是非托管项目。当我尝试使用#import 时，它给了我编译错误，提示找不到 XXX.tlb 文件。但我没有 .tlb 类型的文件。我尝试的另一个选项是使用 OLE 查看器打开 dll 并复制 dll 定义，然后粘贴到我使用 Visual Studio 创建的 .idl 扩展名文件中。然后我在 idl 文件上执行 midl 以创建 .h 文件，但这也无济于事。当我尝试使用这些类时，它给了我“无法使用或引用抽象类”错误。

还有其他关于此事的问题，但不是直截了当的，答案没有标记为已回答或赞成。

我想知道在 Visual Studio 2010 的 win32 C++ 项目中加载 ActiveX dll 有哪些不同的方法，什么时候应该首选哪一种？如果有一个线程实际上解决了我的问题，请指出我。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-03T06:06:53.990

如果您能够使用 OLE View 查看接口定义，则表示类型库已嵌入到 dll 资源中。因此，如果您使用`#import "YourActiveX.dll"`它应该可以工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-02T23:16:38.083

你需要

1.  使用 regsvr32 在 windows 中注册 COM (Active X) 组件：`regsvr32 my_dll.dll`
2.  然后使用 COM 与组件进行交互。这[是一个很好的教程](http://www.codeproject.com/Articles/633/Introduction-to-COM-What-It-Is-and-How-to-Use-It)。

# networking - 没有给出 ping 时如何确定数据链路容量？

> ID：10866569
> 
> 赞同：0
> 
> 时间：2012-06-02T22:59:30.543
> 
> 标签：networking

这是我的网络图的链接[http://i48.tinypic.com/dcev0y.png](http://i48.tinypic.com/dcev0y.png)

我正在尝试自己学习如何设置网络，在混合网络部分我很困惑，如何计算像上面链接的图片这样的情况所需的最小数据链路数量。

英语不是我的主要语言，所以我很难找到合适的关键词。任何帮助都将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-02T23:31:26.890

如果可能的话，询问网络提供商每条路由有多少可用[带宽](http://en.wikipedia.org/wiki/Bandwidth_%28computing%29)以及当前正在使用多少带宽会很有用。

如果您的组织中有网络管理员，您应该先与他们交谈。

这将是了解图中网络拓扑的最简单方法。但是您需要对网络管理员通常非常忙碌且承受压力这一事实保持敏感，因此如果您要求他们的时间，请记住这一点。

如果您需要自己解决这个问题，您需要研究和了解**基本的网络监控工具**

以下是您应该研究和理解的概念和工具列表。 [端口](http://en.wikipedia.org/wiki/Network_port) [ping](http://en.wikipedia.org/wiki/Ping)、[traceroute](http://en.wikipedia.org/wiki/Traceroute)、[nslookup](http://en.wikipedia.org/wiki/Nslookup)和[telnet](http://en.wikipedia.org/wiki/Telnet)

您可能需要研究[TCP/IP](http://en.wikipedia.org/wiki/TCP/IP)、[网络地址](http://en.wikipedia.org/wiki/Network_address)和[子网划分](http://en.wikipedia.org/wiki/Subnetting)

此外，您还需要了解[网络接口控制器](http://en.wikipedia.org/wiki/Network_interface_controller)、多宿主 IP 地址、面向公共和私有 IP 地址的知识。

# c# - 如何使用 UIElement 依赖属性实现 WPF 用户控件？

> ID：10866570
> 
> 赞同：1
> 
> 时间：2012-06-02T22:59:33.457
> 
> 标签：c#, wpf, mvvm, dependency-properties, uielement

我有一个用户控件，后面有这段代码：

```
/// <summary>
/// The text to use for the header.
/// </summary>
public UIElement HeaderText
{
    get { return (UIElement) GetValue(HeaderTextProperty); }
    set { SetValue(HeaderTextProperty, value); }
}

public static DependencyProperty HeaderTextProperty =
    DependencyProperty.Register("HeaderText",
                                typeof(UIElement),
                                typeof(Panel),
                                new PropertyMetadata(null, new PropertyChangedCallback(HeaderTextPropertyChanged)));

private static void HeaderTextPropertyChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
{
    var control = d as Panel;
    if (control != null)
    {
        control.HeaderText = (UIElement) e.NewValue;
    }
} 
```

而这个 XAML：

```
<TextBlock Text="{TemplateBinding local:CustomPanel.HeaderText}" /> 
```

我正在尝试像这样使用用户控件：

```
<controls:CustomPanel>
    <controls:CustomPanel.HeaderText>
        <TextBlock Text="Foo " />
        <TextBlock Text="{Binding Bar}" />
        <TextBlock Text=" baz." />
    </controls:CustomPanel.HeaderText>
</controls:CustomPanel> 
```

但是，我得到的是空白/空文本。

`UIElement`如果我更改为`string`in code-behind，我可以让它工作，但**我想接受这两者`string`，`TextBlock`**以及几乎任何`UIElement`对文本有意义的东西。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-02T23:02:01.017

不要`TextBlock`在您的控件中使用 a 而是 a `ContentPresenter`（并绑定`Content`），它可以托管任何东西。制作属性类型`object`并将名称更改为以`Header`保持一致性。

（作为旁注：通常你有额外的属性`Header`，即 a`HeaderTemplate`和 a `HeaderTemplateSelector`。如果在模板中，你可以通过设置to`ContentPresenter`使其绑定到所有三个属性）[`ContentSource`](http://msdn.microsoft.com/en-us/library/system.windows.controls.contentpresenter.contentsource.aspx)`"Header"`

# symfony - 创建适用于所有捆绑软件的 Symfony2 助手类的正确方法

> ID：10866575
> 
> 赞同：3
> 
> 时间：2012-06-02T23:00:38.427
> 
> 标签：symfony

我正在为我的模型实现 ACL 系统，并且我想将公共代码提取到一个公共 Helper 类中。我找不到任何有关如何正确执行此类操作的示例，但我不断发现需要这样做。

例如，假设在我的控制器中我有一段代码（直接取自文档）：

```
 // creating the ACL
      $aclProvider = $this->get('security.acl.provider');
      $objectIdentity = ObjectIdentity::fromDomainObject($asset);
      $acl = $aclProvider->createAcl($objectIdentity);

      // retrieving the security identity of the currently logged-in user
      $securityContext = $this->get('security.context');
      $user = $securityContext->getToken()->getUser();
      $securityIdentity = UserSecurityIdentity::fromAccount($user);

      // grant owner access
      $acl->insertObjectAce($securityIdentity, MaskBuilder::MASK_OWNER);
      $aclProvider->updateAcl($acl); 
```

我宁愿拥有以下内容：

```
 $this->get('my_helpers')->bindUserToObject($asset, MaskBuilder::MASK_OWNER); 
```

我应该如何实施“my_helpers”服务？我很确定这将是一项服务，但我仍然发现“服务”的概念有点令人困惑。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-03T00:15:19.447

好的，由于某种原因，在这里定义我的问题的过程帮助我解决了如何做到这一点。我确实创建了一项服务。

```
class AclHelper {

protected $aclProvider;
protected $securityContext;
protected $logger;

    public function __construct(MutableAclProvider $aclProvider, $securityContext, $logger) {
      $this->aclProvider = $aclProvider;
      $this->securityContext = $securityContext;
      $this->logger = $logger;
    }   

    public function bindUserToObject($object, $mask) {
      // creating the ACL
      $objectIdentity = ObjectIdentity::fromDomainObject($object);
      $acl = $aclProvider->createAcl($objectIdentity);

      // retrieving the security identity of the currently logged-in user
      $user = $this->securityContext->getToken()->getUser();
      $securityIdentity = UserSecurityIdentity::fromAccount($user);

      // grant owner access
      $acl->insertObjectAce($securityIdentity, $mask);
      $aclProvider->updateAcl($acl); 
    }
} 
```

然后我将它添加到我的 services.yml 文件中：

```
parameters:
    acl_helper.class: GC\DashboardBundle\Services\AclHelper

services:
  acl_helper:
    class:  %acl_helper.class%
    arguments: [@security.acl.provider, @security.context, @logger] 
```

现在在我的控制器中，我所要做的就是：

```
$this->get('acl_helper')->bindUserToObject($object, MaskBuilder::MASK_OWNER); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-03T07:44:52.153

有一个[捆绑包](https://github.com/Problematic/ProblematicAclManagerBundle):)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-02T23:46:34.260

你是对的，你必须创建一个服务。[您可以在官方文档](http://symfony.com/doc/current/book/service_container.html)
中找到有关服务和服务容器的更多信息。

# ios - “打开方式...”移动 Safari 与邮件或其他 iOS 应用程序

> ID：10866579
> 
> 赞同：1
> 
> 时间：2012-06-02T23:01:20.107
> 
> 标签：ios, xcode, mobile-safari, openurl

我有一个应用程序可以识别在我的 iOS 应用程序中创建的文件的扩展名。

当我向自己发送电子邮件时，我创建并使用 Mail 中的“打开方式”，或者如果我从 Dropbox 应用程序中“打开方式”，一切都按计划进行。如果我在 Mobile Safari 中访问文件的 Dropbox 网页，就会出现问题。在这里，灰色屏幕使用“打开方式”选项加载，当我点击按钮时它会加载我的应用程序，我什至在我的应用程序中获得了一个可以使用的 URL，但最终我的应用程序无法加载从 Mobile Safari 发送的数据. 我相信这是因为移动 Safari 更改了数据，因为来自 Mail 或 Dropbox 应用程序的 NSData 的字节长度为 916,406，而来自 Mobile Safari 的字节长度为 925,519。

有谁知道 Mobile Safari 在将数据发送到与 Mail 或 Dropbox 应用程序不同的其他 iOS 应用程序时对数据做了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T04:31:41.863

我弄清楚发生了什么事。我下载到我的应用程序中的数据是使用 gzip 压缩的。事实证明，当 Mobile Safari 将文件发送到我的应用程序时，它会发送未压缩的文件，而如果我从 Mail 或 Dropbox 应用程序打开文件，它会发送压缩文件。

所以现在我只检查数据是否来自 Mobile Safari，如果是，我不解压缩它。希望这可以帮助其他人。

# clojure - 是否可以从 lein-repl 调用 lein-plugin 函数？

> ID：10866581
> 
> 赞同：4
> 
> 时间：2012-06-02T23:01:23.150
> 
> 标签：clojure, leiningen

我想从我的 lein repl 控制一些 lein 插件（lein-cljs build、lein-aws、lein-beanstalk）。有没有办法做到这一点？

例如，我希望能够调用

插件/src/leiningen/cljsbuild.clj：一次

从 repl - 但是，我显然不能（需要'leiningen.cljsbuild）进入我的 lein repl。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-03T02:54:40.013

我不确定这是否解决了您实际尝试做的事情，但是您知道 lein 交互模式吗？编辑：由于新版本的 lein 中不存在 lein interactive ，因此解决方案可能是使用[jark](http://icylisper.in/jark/started.html "摇晃")。Jark 有一个交互模式和一个使用 lein 的插件，因此可以发出 lein 命令并从单个交互提示符调用 clojure 函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-08-01T13:19:24.130

Vinyasa库[声称](https://github.com/zcaudate/vinyasa)提供此功能。在撰写本文时，它`vinyasa.lein`已[损坏](https://github.com/zcaudate/vinyasa/issues/28)，但可能会在不久的将来修复。

# php - php和boost库IPC如何通信？

> ID：10866587
> 
> 赞同：20
> 
> 时间：2012-06-02T23:02:00.877
> 
> 标签：php, ipc, shared-memory, boost-interprocess

我在 php 中有客户端和服务器通过共享内存进行通信，现在我想使用 Boost.Interprocess 访问这个碎片内存对象，我该如何访问它？服务器.php：

```
 function create_image($str){
  // Create a blank image and add some text
  $im = imagecreatetruecolor(300, 20);
  $text_color = imagecolorallocate($im, 233, 14, 91);
  $stringBanner=exec("date").$str;
  imagestring($im, 1, 5, 5,  $stringBanner , $text_color);

  ob_start();
   imagejpeg($im);
  $i = ob_get_contents();
  ob_get_clean(); 
  imagedestroy($im);
   return $i; 
  }  
  echo "\n".__FILE__."\n";
  $shm_key = ftok(__FILE__, 't');
  echo $shm_key."\n";

  $shm_id = shmop_open($shm_key, "a", 0, 0); 
 if ($shm_id) {
  //it is already created
  shmop_delete($shm_id);
  shmop_close($shm_id); 
 } 
 //you need to create it with shmop_open using "c" only
 echo "try to create\n";
 if(!$shm_id = shmop_open($shm_key, "c", 0777, 1024*4))exit(-1);

 echo "ID ".$shm_id."\n";
 $i=0;
 for(;;){
 sleep(1);
 $s="i=".$i++;
 $str=$i;
 $im=serialize(create_image($str));

 $data=serialize(strlen($im));
 $shm_bytes_written = shmop_write($shm_id, $data, 0);
 $shm_bytes_written = shmop_write($shm_id, $im, 32);
 echo $shm_bytes_written." bytes  is written: ".$s." ID = $shm_id\n";
} 
```

客户端.php

```
<?php
$shm_key =1946222626;// ftok(__FILE__, 't');
$shm_id = shmop_open(
         $shm_key, "a", 
         0644,1024*4
         );

 $s=shmop_size($shm_id);
 $data = unserialize(
        shmop_read( $shm_id, 0, 
            31)
       );

 $im =  unserialize(
       shmop_read( $shm_id, 32, 
               $data)
       );
  // Set the content type header - in this case image/jpeg
 header('Content-Type: image/jpeg');
// Output the image
echo $im; 
```

我应该向 Boost 提供什么样的密钥来获取这个内存区域？

boost_client.cpp

```
#include <boost/interprocess/shared_memory_object.hpp> 
#include <iostream> 
#include "sys/msg.h"

int main() 
{ 
    int msqid;
    key_t key;
    char f[]="??????";
    int mid;

    //key = ftok(, 't');
    //msqid = msgget(key, 0666 | IPC_CREAT);

    std::cout<<msqid<<std::endl;
    boost::interprocess::shared_memory_object 
    shdmem(boost::interprocess::open_or_create, 
           f,//"shmem_server", 
           boost::interprocess::read_write); 
    shdmem.truncate(1024); 
    std::cout << shdmem.get_name() << std::endl; 
    boost::interprocess::offset_t size; 
    if (shdmem.get_size(size)) 
    std::cout << size << std::endl; 
} 
```

**编辑：**

好吧，我在 Boost IPC library Docs 中找到了解决方案：

[来自 boost Docs 的基于 XSI_KEY 的示例](http://www.boost.org/doc/libs/1_49_0/doc/html/interprocess/sharedmemorybetweenprocesses.html#interprocess.sharedmemorybetweenprocesses.sharedmemory.xsi_shared_memory)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-23T09:59:34.760

我不是你在做什么的专家，但根据我在你的问题和我的知识中读到的内容，我会放弃那个纯粹的 IPC 东西并将它包装到[ZMQ 中](http://www.zeromq.org/ "零MQ")（你会发现你需要的每种语言的包装器）。它旨在解决这类问题并提供可以在 IPC 或更常见的 TCP 套接字上运行的单一 API。

# iphone - 防止文件夹的 iCloud 备份

> ID：10866590
> 
> 赞同：2
> 
> 时间：2012-06-02T23:02:06.317
> 
> 标签：iphone, ios, xcode, backup, icloud

我最近因为我的 NSLibraryDirectory 将错误类型的数据备份到 iCloud 而被拒绝。我试图阻止整个目录备份到 iCloud，因为这个目录只包含下载的内容。AppDelegate.m 中的这段代码可以工作吗？

```
- (NSString *)applicationDocumentsDirectory {
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSLibraryDirectory, NSUserDomainMask, YES);

NSString *documentsDirectory = [paths objectAtIndex:0];

   NSURL *pathURL= [NSURL fileURLWithPath:documentsDirectory];
[self addSkipBackupAttributeToItemAtURL:pathURL];
return documentsDirectory;

}

- (BOOL)addSkipBackupAttributeToItemAtURL:(NSURL *)URL

{ if (NSURLIsExcludedFromBackupKey) {
assert([[NSFileManager defaultManager] fileExistsAtPath: [URL path]]);

NSError *error = nil;

BOOL success = [URL setResourceValue: [NSNumber numberWithBool: YES]

                              forKey: NSURLIsExcludedFromBackupKey error: &error];

if(!success){

    NSLog(@"Error excluding %@ from backup %@", [URL lastPathComponent], error);

}

return success;
}
else {
assert([[NSFileManager defaultManager] fileExistsAtPath: [URL path]]);

const char* filePath = [[URL path] fileSystemRepresentation];

const char* attrName = "com.apple.MobileBackup";

u_int8_t attrValue = 1;

int result = setxattr(filePath, attrName, &attrValue, sizeof(attrValue), 0, 0);

return result == 0;
}

} 
```

# wso2 - 将 Web 服务连接到 wso2 身份服务器

> ID：10866591
> 
> 赞同：0
> 
> 时间：2012-06-02T23:02:32.563
> 
> 标签：wso2, identity, wso2is

我已经在我的计算机上安装了一个 wso2 身份服务器，现在我希望让它充当我的应用程序的 pdp 和 pep，这将是一个网站或数据库服务器。我已经知道如何创建策略，问题是我似乎找不到关于如何将服务连接到身份服务器的教程。我想要的是一个教程，从简单的基本内容开始，然后我将能够从那里继续前进。谢谢您的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T12:03:30.213

我认为您想将 Identity Server 用作 PDP。您在 tomcat 上运行的应用程序使用此 PDP 进行授权查询。因此，您希望使用您的应用程序创建 PEP 组件。PEP 可以对 WSO2IS PDP 进行 Web 服务调用。实际使用可以使用与上述博文中描述的相同的 PEP 客户端源。您可以轻松地将其与您的网络应用程序集成。但是，有一个示例 Web 应用程序充当 PEP。请参考[此处](http://xacmlinfo.com/2012/03/06/xacml-sample-for-health-care/)的示例。此 Web 应用程序的源代码也可以在[此处](https://svn.wso2.org/repos/wso2/people/asela/xacml-samples/medi.com/webapp/medi_com_webapp/)找到。如果您只是浏览源代码，您会发现它是如何实现的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T08:48:48.543

[您可以从此处](http://xacmlinfo.com/2012/06/14/pep-client-for-wso2is-pdp/)找到用于访问 WSO2 Identity Server 的 PDP 的基于 SOAP 的 PEP 客户端。此外，如果您想了解与 WSO2 身份服务器相关的 PDP PED 通信的更多详细信息，请从[此处](http://xacmlinfo.com/2012/06/13/pdp-pep-communication-wso2is/)查找。

# iphone - iPhone - 隐式声明错误

> ID：10866599
> 
> 赞同：1
> 
> 时间：2012-06-02T23:04:13.260
> 
> 标签：iphone, opengl-es

我正在使用像

```
glPushMatrix(); 
```

在我的 iPhone 应用程序上并收到此错误：

函数 glPushMatrix 的隐式声明在 C99 中无效。

如何让 Xcode 停止抱怨？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-02T23:09:21.237

编译器认为该`glPushMatrix()`命令是您创建的函数。你有没有`#import`-ed`OpenGL`框架。如果你有，那么它可能没有链接。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-02-09T10:51:28.313

对于 glPushMatrix() 和 glPopMatrix() 您应该使用 OpenGLES/ES1 文件夹，而不是 ES2 或 ES3：

```
#import <OpenGLES/ES1/glext.h> 
```

# php - jQuery for HTML to PHP - 函数错误

> ID：10866600
> 
> 赞同：0
> 
> 时间：2012-06-02T23:04:16.953
> 
> 标签：php, javascript, jquery

我刚刚购买了“Tonic Gallery”，我的客户认为它非常适合他的网站。困难在于它对 HTML 非常有效，但对于“.php”，它甚至无法加载。

为了给你一个更好的主意，这里有两个链接：

补品画廊链接：[http ://codecanyon.net/item/tonic-gal...gallery/120710](http://codecanyon.net/item/tonic-gal...gallery/120710)

LincHospitality.com：http://linchospitality.com/ [_](http://linchospitality.com/)

这被输入到“投资组合”选项卡中。按照说明，我在“head”（header.php）中输入了以下内容：

```
<link rel="stylesheet" type="text/css" href="styles/tonic_gallery.css"/>
<link rel="stylesheet" type="text/css" href="styles/demo_styles.css"/>
<link rel="stylesheet" type="text/css" href="styles/prettyPhoto.css"/>

<script type="text/javascript" src="script/jquery-1.4.js"></script>
<script type="text/javascript" src="script/jquery-easing.js"></script>
<script type="text/javascript" src="script/jquery.prettyPhoto.js"></script>
<script type="text/javascript" src="script/portfolio-setter.js"></script>
<script type="text/javascript">
  $(function(){
        // init the portfolio functionality
        $('#portfolio_wavy').portfolioSetter({xmlSource:'portfolio.xml', wavyAnimation:true});

  });
</script> 
```

然后，我使用插件所需的输入创建了“portfolio.php”页面：

```
<?php $page = "portfolio";?> 
<?php include("header.php"); ?> 

  <div role="main"> 
    <div class="wrapper" id="subPagesWrap"> 
    <div id="portfolio_wavy"></div> 
    </div><!-- wrapper --> 
  </div> <!-- end main --> 

<?php include("footer.php"); ?> 
```

在直接的“.html”文件中，它完美地工作！但是由于我已经放入了“header.php”和“portfolio.php”，我得到了以下错误：

```
$("#portfolio_wavy").portfolioSetter is not a function 
```

这是“.html”文件的链接，说明它是如何工作的。相同的功能，相同的根文件夹只是不能在“.php”中工作。

linchospitality "/" 画廊 [点] html

我该如何克服这个功能错误？有什么简单的方法吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-02T23:20:30.150

您需要在加载后运行该函数。您可以通过在文档就绪事件上运行它来确保这一点。我不确定您使用的语法，但只需确保它在文档准备就绪后运行。

# google-maps-api-3 - MarkerClustererPlus：标记在集群中显示/隐藏时的事件？

> ID：10866607
> 
> 赞同：1
> 
> 时间：2012-06-02T23:06:16.783
> 
> 标签：google-maps-api-3

使用 MarkerClustererPlus 时 - 我想在某个事件上挂起一些代码，该事件是由 markerClusterer 显示/隐藏集群中的标记时触发的。

MC+ Doco 似乎没有表示这样的事件。

查看 MC+ 代码，集群器似乎使用 marker.setMap() 并且标记没有“map_changed”事件。

我可以向集群器添加代码以在调用 marker.setMap 时触发事件，但我不想更改运行良好的代码 - 不想在更新 markerClustererPlus 时创建配置管理问题。

有什么建议么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-02T23:27:32.593

发布问题后不久，我发现我可以在标记“map_changed”上挂起一个事件。

```
google.maps.event.addListener(myMarker, 'map_changed',
function() { do stuff }); 
```

我认为这是一个 MVC 状态更改事件，而不是一个显式标记事件（即它没有在文档中定义为标记事件）。 [（请参阅此处的 Google 事件文档）](https://developers.google.com/maps/documentation/javascript/events#EventsOverview)和此处的[Google 标记事件文档](https://developers.google.com/maps/documentation/javascript/reference#Marker)

剩下的唯一问题是 - 最好验证这是一个 MVC 状态更改事件，而不是一个可能中断或消失的未记录/不受支持的标记事件 - 我该怎么做？

# java - 如何使用 JSTL 增加循环变量？

> ID：10866608
> 
> 赞同：8
> 
> 时间：2012-06-02T23:06:29.397
> 
> 标签：java, jsp, jstl

我想用jstl做这样的事情：

```
int i=0;
int j=0;

<c:forEach items="${commentNames}" var="comment">     

     <c:forEach items="${rates}" var="rate">

        <c:if test="${i==j}">

          int i++

        </c:if> 

     </c:forEach> 

  int j++;

</c:forEach> 
```

这对 jstl 可行吗？当我尝试这个时，它击中了我的错误，我想知道是否有正确的方法来编写它

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-02T23:17:27.980

不是直接的，但您可以使用`varStatus`将 的实例[`LoopTagStatus`](http://docs.oracle.com/javaee/6/api/javax/servlet/jsp/jstl/core/LoopTagStatus.html)放在 的范围内`<c:forEach>`。它提供了几个 getter 来计算循环[索引](http://docs.oracle.com/javaee/6/api/javax/servlet/jsp/jstl/core/LoopTagStatus.html#getIndex%28%29)以及它是循环的第[一次](http://docs.oracle.com/javaee/6/api/javax/servlet/jsp/jstl/core/LoopTagStatus.html#isFirst%28%29)还是[最后](http://docs.oracle.com/javaee/6/api/javax/servlet/jsp/jstl/core/LoopTagStatus.html#isLast%28%29)一次迭代。

我只是不确定你的`<c:if>`意思是什么，但我认为你实际上有两个大小相同的列表，其中包含评论名称和评论率，并且你只需要显示与评论​​相同索引的比率。

```
<c:forEach items="${commentNames}" var="comment" varStatus="commentLoop">     
    ${comment}
    <c:forEach items="${rates}" var="rate" varStatus="rateLoop">
        <c:if test="${commentLoop.index == rateLoop.index}">
            ${rate}
        </c:if>
    </c:forEach> 
</c:forEach> 
```

然而，这很笨拙。您可以直接按索引更好地获取费率。

```
<c:forEach items="${commentNames}" var="comment" varStatus="commentLoop">     
    ${comment}
    ${rates[commentLoop.index]}
</c:forEach> 
```

更好的是创建一个`Comment`具有`name`and`rate`属性的对象。

```
public class Comment {

    private String name;
    private Integer rate;

    // Add/autogenerate getters/setters.
} 
```

这样您就可以按如下方式使用它：

```
<c:forEach items="${comments}" var="comment">
    ${comment.name}
    ${comment.rate}
</c:forEach> 
```

### 也可以看看：

*   [使用JavaBeans的地方？](https://stackoverflow.com/questions/1727603/places-where-javabeans-are-used)

# php - 从关联数组中选择 2 个随机元素

> ID：10866611
> 
> 赞同：1
> 
> 时间：2012-06-02T23:07:00.133
> 
> 标签：php, arrays, random

所以我有一个关联数组，我想从中返回 2 个随机值。此代码仅返回 1 个数组值，即随机 4 个数字中的任何一个。

```
$array = array('a' => 1, 'b' => 2, 'c' => 3, 'd' => 4);
$key = array_rand($array); //array_rand($array,2); Putting 2 returns Illegal offset type
$value = $array[$key];
print_r($value); //prints a single random value (ex. 3) 
```

如何仅从数组值中返回 2 个逗号分隔值？3,4之类的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-02T23:11:23.567

`array_rand`接受一个额外的可选参数，该参数指定您想要从数组中取出多少个随机条目。

```
$input_array = array('a' => 1, 'b' => 2, 'c' => 3, 'd' => 4);
$rand_keys = array_rand($input_array, 2);
echo $input_array[$rand_keys[0]] . ',' . $input_array[$rand_keys[1]]; 
```

[在此处](http://php.net/manual/en/function.array-rand.php)查看 array_rand 的 PHP 文档。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-02T23:09:15.467

用 抓取数组中[`array_keys()`](http://www.php.net/array_keys)的键[`shuffle()`](http://www.php.net/shuffle)，用 打乱键，并打印出与打乱的键数组中的前两个键对应的值，如下所示：

```
$array = array('a' => 1, 'b' => 2, 'c' => 3, 'd' => 4);
$keys = array_keys( $array);
shuffle( $keys);
echo $array[ $keys[0] ] . ',' . $array[ $keys[1] ]; 
```

[演示](http://codepad.viper-7.com/E54w0u)

或者，您可以使用[`array_rand()`](http://www.php.net/array_rand)的第二个参数来获取两个键，如下所示：

```
$array = array('a' => 1, 'b' => 2, 'c' => 3, 'd' => 4);
$keys = array_rand( $array, 2);
echo $array[ $keys[0] ] . ',' . $array[ $keys[1] ]; 
```

[演示](http://codepad.viper-7.com/qDFoff)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-02-01T12:33:20.267

有一种更有效的方法可以保留键和值。

```
function shuffle_assoc(&$array) {
        $keys = array_keys($array);

        shuffle($keys);

        foreach($keys as $key) {
            $new[$key] = $array[$key];
        }

        $array = $new;

        return true;
    } 
```

[在此处](https://www.php.net/manual/en/function.shuffle.php#94697)查看文档

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-06-02T23:12:42.173

```
$a=rand(0,sizeof($array));
$b=$a;
while ($a==$b) $b=rand(0,sizeof($array));

$ar=array_values($array);
$element1=$ar[$a];
$element2=$ar[$b]; 
```

`shuffle()`如果数组很大，应该比和 freinds 更有效。

# css - Chrome css 和 iframe 的问题

> ID：10866612
> 
> 赞同：0
> 
> 时间：2012-06-02T23:07:59.623
> 
> 标签：css, google-chrome, iframe

我正在管理这个网站：（不是开玩笑）

[http://www.orgasmatrix.fr/webcams](http://www.orgasmatrix.fr/webcams)

如您所见，当您将鼠标放在“类别”上时，菜单会出现在名为“chat_”的 iframe 下方。我已经搜索过了。我已经阅读并测试了“位置：绝对”和“z-index：-999”，但没办法。我发现了另一个使用 iframe embenbed 的技巧，并尝试将“?wmode=transparent”或“?wmode=opaque”作为参数。我也用 , 以及属性 allowtransparency="true" 进行了测试。但没办法，iframe 总是出现在“类别”菜单上方。

有什么帮助吗？我将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-02T23:27:11.930

The problem isn't with your code, but deeper - in very nested iframe (I have counted 3) with that chat element:

```
<object type="application/x-shockwave-flash" data="http://img.media-rendering2.com/market2/livecams/chat_coquin/chat_v2.swf" wmode="transparent" width="300" height="405" id="chatCoquinTac" style="visibility: visible; "><param name="menu" value="false"><param name="quality" value="high"><param name="allowScriptAccess" value="always"><param name="wmode" value="transparent"><param name="flashvars" value="url_acces=&amp;url_image=http%3A%2F%2Fimg.media-rendering2.com%2Fmarket2%2Flivecams%2Fchat_coquin%2F&amp;sexe=h&amp;langue=fr&amp;webcam=7&amp;pseudo=Julia&amp;ville=Warsaw&amp;format=2&amp;temps=1338679111"></object> 
```

As you can see I have added (with developer tools) `<param name="wmode" value="transparent">` and `wmode="transparent"` to `<object>` and it worked as it should (Chrome 19) - your categories menu appears above chat window.

# android - 从android应用程序中抓取网页的最佳方法是什么

> ID：10866614
> 
> 赞同：0
> 
> 时间：2012-06-02T23:08:25.590
> 
> 标签：android

我正在开发 android 应用程序以从 html 网页获取一些数据并解析它以在应用程序中使用。我尝试使用 Web-harvest，但它似乎与 android 不完全兼容。应用程序应该获取网页，解析它，获取所需的数据，并在应用程序中使用它。那么在android中抓取html页面的标准和推荐方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-02T23:35:11.273

我很高兴使用 TagSoup 和 XOM 来解析 Android 上的网页。两者都在您的类路径中，您可以执行以下操作：

```
XMLReader tagsoup = XMLReaderFactory.createXMLReader("org.ccil.cowan.tagsoup.Parser");
Builder bob = new Builder(tagsoup);
Document html = bob.build("http://www.yahoo.com");
Nodes images = html.query("//img");

for (int index = 0; index < images.size(); index++) {
    Element image = (Element) images.get(index);
    String src = image.getAttribute("src").getValue();
    // do something with it...
} 
```

如果您要抓取的 HTML 具有命名空间，则可以改为执行以下操作：

```
XPathContext context = new XPathContext("html", "http://www.w3.org/1999/xhtml");
Nodes images = html.query("//html:img", context); 
```

链接：

XOM --> [http://www.xom.nu](http://www.xom.nu)

TagSoup --> [http://ccil.org/~cowan/XML/tagsoup/](http://ccil.org/~cowan/XML/tagsoup/)

当然，在从 Web 页面构建 XML 文档时，您必须捕获可能的异常。

# javascript - Google Maps api v3 - “信息窗口未定义”错误

> ID：10866615
> 
> 赞同：2
> 
> 时间：2012-06-02T23:08:27.047
> 
> 标签：javascript, google-maps-api-3

地图出现，点出现。我的标题也出现了。但是，只要我单击标记以获取信息，什么都不会出现。Firebug 信息如下。

信息是通过数据库引入的，并且有多个项目；地图上应显示多个标记。

任何帮助将不胜感激。谢谢..

萤火虫点信息：

```
MarkLat[i] = xx.xxxxxxxxxxxxxx;
MarkLong[i] = -xx.xxxxxxxxxxxxxx;
MarkerTitle[i] = 'Title 1';
Display[i] = '<table><tr><td>Title 1</td></tr><tr><td>Title 1 Address<br />Title 1 City, State Zip</td></tr><tr><td>Title 1 Phone</td></tr><tr><td>Title 1 Email</td></tr><tr><td>Title 1 URL</td></tr></table>'; 
```

Firebug 错误：未定义 infowindow infowindow.open(map,marker);

代码：

```
<script type="text/javascript">
  var i = -1;
  var MarkLat=new Array();
  var MarkLong=new Array();
  var MarkerTitle=new Array();
  var Display=new Array();
  var MapCenter = new google.maps.LatLng(xx.xxxxxxxxxxxxxx,-xx.xxxxxxxxxxxxxx)
</script>

<script type="text/javascript">
  var i = i + 1;
  MarkLat[i] = [[Lat]];
  MarkLong[i] = [[Long]];
  MarkerTitle[i] = '[[Title]]';
  Display[i] = '<table><tr><td>[[Title]]</td></tr><tr><td>[[Address]]<br />[[City]], [[State]] [[Zip]]</td></tr><tr><td>[[Phone]]</td></tr><tr><td>[[Email]]</td></tr><tr><td>[[WebURL]]</td></tr></table>';
</script>

<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?sensor=false"></script>
<script type="text/javascript">
  function initialize() {
    var myOptions = {
      zoom: 12,
      center: MapCenter,
      zoomControl: true,
      zoomControlOptions: {
        position: google.maps.ControlPosition.TOP_RIGHT,
        style: google.maps.ZoomControlStyle.SMALL
      },
      mapTypeControl: true,
      mapTypeControlOptions: {
        style: google.maps.MapTypeControlStyle.DROPDOWN_MENU
      },
      scaleControl: true,
      scaleControlOptions: {
        position: google.maps.ControlPosition.TOP_CENTER
      },
      mapTypeId: google.maps.MapTypeId.ROADMAP,
    };

    var map = new google.maps.Map(document.getElementById('map_canvas'),myOptions);

    for (var i = 0, length = 50; i < length; i++) {
      var latLng = new google.maps.LatLng(MarkLat[i],MarkLong[i]);
      var infoWindow = new google.maps.InfoWindow(Display[i]);

      // Creating a marker and putting it on the map
      var marker = new google.maps.Marker({
        position: latLng,
        map: map,
        title: MarkerTitle[i]
      });

      google.maps.event.addDomListener(marker, 'click', function() {
        infowindow.open(map,marker);
      });
    }
  }

  google.maps.event.addDomListener(window, 'load', initialize);
</script> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-02T23:52:50.240

更改为大写 W 对我来说还不够。只有一个地点被打开。我用两点测试了你的代码：

```
MarkLat = [];
MarkLong = [];
Display = [];
MarkerTitle= [];

MarkLat[0] = 0;
MarkLong[0] = 0;
Display[0] = { content: "hi" };
MarkerTitle[0] = "hello";

MarkLat[1] = 10;
MarkLong[1] = 10;
Display[1] = { content: "hi 2" };
MarkerTitle[1] = "hello 2"; 
```

我猜您在任何给定时间都只希望屏幕上有一个 InfoWindow。然后，应声明一个 InfoWindow，其内容保留在标记内，并在单击标记时更改内容。

```
var infoWindow = new google.maps.InfoWindow();
for (var i = 0, length = Display.length; i < length; i++) {
  var latLng = new google.maps.LatLng(MarkLat[i],MarkLong[i]);

  // Creating a marker and putting it on the map
  var marker = new google.maps.Marker({
    position: latLng,
    map: map,
    title: MarkerTitle[i],
    infoWindowContent: Display[i]
  });

  // Notice I used the 'this' keyword inside the listener
  google.maps.event.addListener(marker, 'click', function() {
    infoWindow.setContent(this.infoWindowContent.content);
    infoWindow.open(map,this);
  });
} 
```

另一种方法是弹出许多 InfoWindow，需要更改单击侦听器，以便保留对每个单独 InfoWindow 的引用。这个效果是通过一个围绕 infoWindow.open 函数的匿名函数来实现的（创建了一个新的函数范围）。

```
for (var i = 0, length = Display.length; i < length; i++) {
  var latLng = new google.maps.LatLng(MarkLat[i],MarkLong[i]);
  var infoWindow = new google.maps.InfoWindow(Display[i]);

  // Creating a marker and putting it on the map
  var marker = new google.maps.Marker({
    position: latLng,
    map: map,
    title: MarkerTitle[i] 
  });

  google.maps.event.addListener(marker, 'click', (function(infoWindow) {
    return function() {
      infoWindow.open(map,this);
    }
  })(infoWindow));
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-02T23:18:02.340

信息窗口！= 信息窗口

你刚刚用大写声明它，试图在没有的情况下使用它

# objective-c - 根据值和键对 NSMutableDictionary 进行排序？

> ID：10866616
> 
> 赞同：1
> 
> 时间：2012-06-02T23:08:30.537
> 
> 标签：objective-c, ios, nsarray, nsmutabledictionary

我试图先按值排序和 NSMutableDictionary，然后按键。我使用以下代码按值排序：

```
 NSMutableDictionary *dict = [[NSMutableDictionary alloc]initWithCapacity:10];
        [dict setObject:[NSNumber numberWithInt:5] forKey:@"eblk"];
        [dict setObject:[NSNumber numberWithInt:2] forKey:@"dstl"];
        [dict setObject:[NSNumber numberWithInt:4] forKey:@"cast"];
        [dict setObject:[NSNumber numberWithInt:4] forKey:@"breb"];
        [dict setObject:[NSNumber numberWithInt:5] forKey:@"apts"];

         NSArray *sortedKeys = [dict keysSortedByValueUsingComparator: ^(id obj1, id obj2) 
        {
          if ([obj1 integerValue] < [obj2 integerValue]) {
              return (NSComparisonResult)NSOrderedDescending;
          }
          if ([obj1 integerValue] > [obj2 integerValue]) {
              return (NSComparisonResult)NSOrderedAscending;
          }
          return (NSComparisonResult)NSOrderedSame;
        }]; 
```

然后我想根据键再次排序，所以我最终得到了一个这样的键数组：

sortedKeys : dict中对应的值

“适合”：5

“eblk”：5

“布雷布”：4

“演员”：4

“dstl”：2

我有第一个关于价值工作的排序，我只是不确定如何开始基于键的二级排序。

我尝试先按键排序，然后按值排序，但这不起作用。

任何帮助，将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-03T02:35:39.273

你想要做的是一个两键排序。对于任何 n 键排序，您按顺序比较键，如果当前对不相等则返回结果，否则移动到下一对键并重复。

您的两个键的轮廓草图：

1.  获取一个键数组，以便您对它们进行排序
2.  使用两键排序对该数组进行排序：

    *   通过查找来获取值
    *   比较值，如果不相等则返回
    *   比较键；

代码草图：

```
NSArray *allKeys = [dict allKeys];
NSArray *sortedKeys = [allKeys sortedArrayUsingComparator:^(id obj1, id obj2)
{
   NSInteger value1 = [[dict objectForKey:obj1] integerValue];
   NSInteger value2 = [[dict objectForKey:obj2] integerValue];

   if (value1 < value2) 
      return (NSComparisonResult)NSOrderedDescending;
   if (value1 > value2) 
      return (NSComparisonResult)NSOrderedAscending;
   // values are equal, compare keys...         
   return [obj1 compare:obj2];
}]; 
```

# python - django set_test_cookie 设置 cookie 失败

> ID：10866617
> 
> 赞同：5
> 
> 时间：2012-06-02T23:08:46.330
> 
> 标签：python, django

# 问题

在 django 视图中使用[`set_test_cookie`](https://docs.djangoproject.com/en/dev/topics/http/sessions/#setting-test-cookies)无法实际设置测试 cookie，我不知道为什么。

## 重现步骤

实际项目比这复杂得多，但是，在一个几乎空的项目中，错误是可以重现的。

### 壳

```
$ virtualenv venv
$ source venv/bin/activate
(venv)$ pip install django
(venv)$ django-admin.py startproject hellodjango .
(venv)$ python manage.py startapp polls 
```

### 设置.py

```
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.sqlite3', # Add 'postgresql_psycopg2', 'mysql', 'sqlite3' or 'oracle'.
        'NAME': 'database.db',                      # Or path to database file if using sqlite3.
        'USER': '',                      # Not used with sqlite3.
        'PASSWORD': '',                  # Not used with sqlite3.
        'HOST': '',                      # Set to empty string for localhost. Not used with sqlite3.
        'PORT': '',                      # Set to empty string for default. Not used with sqlite3.
    }
} 
```

### 网址.py

```
from django.conf.urls import patterns, include, url

urlpatterns = patterns('',
    url(r'^login/$', 'hellodjango.polls.views.login'),
) 
```

### 民意调查/views.py

```
from django.shortcuts import render_to_response
from django.http import HttpResponse

def login(request):
    if request.method == 'POST':
        if request.session.test_cookie_worked():
            request.session.delete_test_cookie()
            return HttpResponse("You're logged in.")
        else:
            return HttpResponse("Please enable cookies and try again.")
    request.session.set_test_cookie()
    return HttpResponse("Look ma, no cookies!") 
```

### 壳

```
(venv)$python manage.py runserver 
```

### 浏览器

转到 localhost:8000/login/ 并注意您的 get 请求没有显示响应 cookie，其名称`testcookie`和值`worked`与`set_test_cookie` [source](https://github.com/django/django/blob/master/django/contrib/sessions/backends/base.py#L64)一致。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-02T23:29:40.400

Actually, it works! You might want to visit your website with cookies disabled and see for yourself.

### Anyway, here's the explanation:

If you look at the source for `set_test_cookie`, you'll notice that it actually sets a variable in the current session, not a cookie or anything (at least, not directly).

Here's how it works:

1.  You call `set_test_cookie`, a key of `TEST_COOKIE_NAME` and of value `TEST_COOKIE_VALUE` is added to your current session.
2.  You current session was modified (check the `__setitem__` method), so [a sessionid (1) cookie will be sent](https://docs.djangoproject.com/en/dev/topics/http/sessions/#when-sessions-are-saved) (2)
3.  When you `POST` data in your next request, django checks whether the key `TEST_COOKIE_NAME` happens to be in your session data and has the right value.

If it does, it means we were able to retrieve your session from your request, so that the sessionid cookie we used to identify you was sent back (lest we wouldn't have been able to retrieve your session), so you must support cookies.

Hope this makes things clearer to you; if it doesn't, I think you should look into the details of how HTTP works.

### Notes

(1) Or whatever the `SESSION_COOKIE_NAME` setting sets.
(2) Actually, a sessionid cookie will be sent even if the session was not altered if the `SESSION_SAVE_EVERY_REQUEST` setting is true

# android - Android 创建自定义菜单（和自定义 res/menu 文件夹，没有 res/menu 文件夹）

> ID：10866618
> 
> 赞同：2
> 
> 时间：2012-06-02T23:09:10.707
> 
> 标签：android, android-layout

我应该在 Eclipse 中构建的 Android 项目中创建自己的自定义菜单文件夹吗？例如，我想创建一种出现在所有活动中的标题。我知道菜单应该在 res/menu 文件夹中的 XML 文件中定义，但我没有 res/menu 文件夹。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T06:08:35.663

它很简单，只需创建名为“Menu”的文件夹并添加一个 XML 文件名为“menu.xml”。在此文件中，您可以创建您的设计。

```
<item android:id="@+id/add"
    android:icon="@drawable/icon" />
<item android:id="@+id/compare"
    android:icon="@drawable/icon" />
<item android:id="@+id/close"
    android:icon="@drawable/icon" /> 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-06-02T23:09:10.833

答案是

“通过选择 File → New → Other，在 Eclipse 中创建一个新的 Android XML 文件，然后选择“Android XML File”。选择资源类型“菜单”，并将文件保存为 main.xml。Eclipse 将自动创建一个文件夹 res/menu，您的菜单 XML 文件将存储在其中。

[我在这里](http://coding.smashingmagazine.com/2011/03/28/get-started-developing-for-android-with-eclipse-reloaded/)找到了答案，希望对您有所帮助:)

# objective-c - 按钮单击在后续启动时会出现不同的错误

> ID：10866625
> 
> 赞同：1
> 
> 时间：2012-06-02T23:10:27.120
> 
> 标签：objective-c, macos, nsviewcontroller

我以前从未见过这种响应，在同一应用程序的不同运行中，相同的操作会引发不同的错误。

我在 NSViewController 子类中有一个按钮（仅记录发送者）的 IBAction，它在单击按钮时引发错误（这是一个 OSX 应用程序）。我得到了这些（到目前为止）：

```
-[NSArrayM buttonClick:]: unrecognized selector sent to instance
-[__NSCFDictionary buttonClick:]: unrecognized selector sent to instance
-[__NSCFSet buttonClick:]: unrecognized selector sent to instance
-[NSRunLoop buttonClick:]: unrecognized selector sent to instance 
```

还有，可怕的 EXC_BAD_ACCESS。

此测试应用程序中唯一的代码是应用程序委托中用于实例化视图控制器的代码：

```
- (void)applicationDidFinishLaunching:(NSNotification *)aNotification {
    TestController *controller = [[TestController alloc] initWithNibName:@"TestController" bundle:nil];
    [self.window.contentView addSubview:controller.view];
} 
```

而视图控制器子类中的这个 IBAction：

```
-(IBAction)buttonClick:(id)sender {
    NSLog(@"%@",sender);
} 
```

在视图控制器中实现的 IBAction 在 IB 中（通过文件所有者）连接到其视图中的按钮。

我不明白我怎么能在这么简单的程序中得到这么多不同的错误信息。这可能是视图控制器不在响应者链中的问题吗？如果是这样，为什么它应该抛出错误，消息不应该被发送到链上然后被丢弃？

我尝试让控制器的视图将控制器设置为下一个响应者（使用 [controller.view setNextResponder:controller];），但这只会在启动时给我 EXC_BAD_ACCESS 错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-03T02:57:35.997

好的，我用来自 MacScripter 的 Shane Stanley 的指针解决了这个问题（我在 ApplescriptObjC 中制作了另一个版本来问那里的问题，但那个版本有效）。这是内存管理的问题——在使用 ARC 时很容易忘记这一点。在我向它发送 IBAction 之前，TestController 实例被释放了。这解释了可变错误消息，因为向已释放对象发送消息可以指向任何内容。通过为 TestController 实例控制器声明一个属性（作为保留）解决了该问题。

# java - 使用 Java 上的 Sockets 在服务器之间进行时钟同步

> ID：10866626
> 
> 赞同：-3
> 
> 时间：2012-06-02T23:10:28.507
> 
> 标签：java, web-services, sockets

我需要使用 Sockets 在 java 上使用 web 服务来同步我构建的服务器。你能给我任何建议吗？我打算使用对称时间模型，但即使我知道它的逻辑，我也无法实现它。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-03T00:03:28.810

Suggestions:

*   The best idea (IMO) is to deploy (or configure) NTP on the servers and synchronize them all to a reliable network time source. See the answers to your previous question!

*   If you do *have to* implement your own time synchronization, you'll need to figure out how to implement some time model. Asking someone else how to do it is not going to help, because it is not something that people do. (Why would they bother? NTP does the job ...)

*   The simpler alternative is to set up a simple server on one of the machines (designated the "time master" or "time lord" or something), that tells a client what its time clock says. Then the clients just get the time from the client, and set their clock to it. (The snag is that things can go wrong if the "time lord" machine's clock drifts or if gets set to a bogus value somehow.)

# macos - Firefox openURL：OSX 命令行

> ID：10866628
> 
> 赞同：23
> 
> 时间：2012-06-02T23:10:44.147
> 
> 标签：macos, firefox

## 语境

我想从命令行打开一个 Firefox 浏览器并将其转到 youtube.com

我试过：打开 /Applications/Firefox.app --args -remote "openURL(www.youtube.com, new-tab)"

它成功打开了 Firefox，但没有导航到 youtube.com

## 问题：

我该如何解决？

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2012-06-02T23:13:34.043

`open -a Firefox 'http://www.youtube.com/'`

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-06-02T23:13:42.843

如果 Firefox 是您的默认浏览器，您可以简单地使用：`open 'http://www.youtube.com'`

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2014-04-04T08:45:52.113

也许你可以附加两个别名，编辑 ~/.bash_profile，在下面附加代码：

```
open_by_browser(){ open -a $1 $2}
alias firefox='open_by_browser firefox'
alias chrome='open_by_browser "Google Chrome"' 
```

然后你可以用火狐打开html文件

```
firefox xxx.html 
```

或通过 Chrome

```
chrome xxx.html 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-06-02T23:15:48.620

顺便说一句，其他人的答案是有效的，但是您可以这样做的另一种方法是：

```
/Applications/Firefox.app/Contents/MacOS/firefox "youtube.com" 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-10-23T14:36:20.957

如果需要，您可以打开 Firefox 到特定的 url 并传递参数。注意：kiosk 模式是仅在 Firefox 71 beta 中支持的示例。

```
open -a /Applications/Firefox.app "https://stackoverflow.com" --args --kiosk 
```

# actionscript-3 - Actionscript 3 - 导入 SVG 文件

> ID：10866636
> 
> 赞同：7
> 
> 时间：2012-06-02T23:13:30.940
> 
> 标签：actionscript-3, svg, augmented-reality

有谁知道任何用于将 SVG 文件动态导入到 actionscript 的库或工具？我需要能够将 SVG 文件导入 Flash 并将其转换为影片剪辑或最好是平面 3d 对象。这里的最终目标是实现一个带有增强现实的矢量文件。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-13T08:52:34.497

可以在这里下载一个很棒的库：[http](http://code.google.com/p/as3svgrendererlib/) ://code.google.com/p/as3svgrendererlib/ 它易于实现且可靠。请注意，有两种方法可以实现代码。我更喜欢以下内容，因为它可以为您提供更多控制权：

```
 private function loadSVG(url:String):void {
        ProcessExecutor.instance.initialize(stage);
        ProcessExecutor.instance.percentFrameProcessingTime = 0.9;

        loader = new URLLoader();
        loader.dataFormat = URLLoaderDataFormat.TEXT;
        loader.addEventListener(Event.COMPLETE, svgLoaded, false, 0, true);

        try {
            loader.load(new URLRequest(url));
        } catch (error:Error) {
            trace(error);
        }
    }   
    private function svgLoaded(e:Event):void {
        var svgString:String = loader.data as String;
        var svgDocument:SVGDocument = new SVGDocument();
        svgDocument.parse(svgString);

        this.addChild(svgDocument);
    } 
```

另一种方法更短，当您只需要加载一个小型 SVG 或仅加载几个时，这可能是一种可行的方法。

```
public function loadSVG(url:String) {
        ProcessExecutor.instance.initialize(stage);
        ProcessExecutor.instance.percentFrameProcessingTime = 0.9;

        var svgDocument:SVGDocument = new SVGDocument();
        svgDocument.load(url);
        addChild(svgDocument);
    } 
```

两个重要说明： 1\. 我似乎无法捕获 SVG 的宽度或高度，并且在加载 SVG 后父 Sprite 的宽度和高度为 0。我通过在将所有 SVG 加载到 AS3 之前使它们的大小相同来解决这个问题。之后我知道了我使用 ScaleX 和 scaleY 来调整加载的 SVG 的尺寸。2\. 阶段必须存在才能使用此代码。添加以下代码将确保您不会遇到问题：`yourDisplayClass.addEventListener(Event.ADDED_TO_STAGE, loadYourSVGs);`

现在如何将其转换为平面 3D 对象取决于您的 3D 库。我曾与 Away3D 合作过，您可以在 Sprite3D 上使用位图材质。Sprite3D 类将是要使用的对象。我希望您的 3D 库支持使用 MovieClip，以便您可以将它们添加到您的 3D 对象中。否则，您将不得不使用从影片剪辑中提取 bitmapMaterial，就像我在以下示例中所做的那样：

```
public function movieClipToBitmapMaterial(mc:MovieClip):BitmapMaterial {
        var bmData:BitmapData = new BitmapData(mc.width, mc.height, true, 0xFFFFFF);
        bmData.draw(displayObject);
        return new BitmapMaterial(bmData);
    } 
```

您在上述函数中的输入将是您已加载 SVG 的影片剪辑。

我不确定这一点，但我认为通过使用此功能，您将失去在不损失质量的情况下随心所欲地扩展的能力。

我希望我的意见能有所帮助！祝你好运

PS：不要忘记将 SWC 从链接添加到您的项目并查看提供的示例。请注意 shaunhusain 对您最初问题的出色评论。您可能不必使用 3D 库。

* * *

## 回答 #2

> 赞同：-4
> 
> 时间：2013-07-03T13:52:18.070

萨拉姆，

这很容易：

1.  在 illustrator 中打开“name.svg”文件。
2.  将其另存为“name.ai”
3.  将其导入flash中的舞台，仅此而已。

# list - Scala 中 Seq 和 List 的区别

> ID：10866639
> 
> 赞同：353
> 
> 时间：2012-06-02T23:13:48.910
> 
> 标签：list, scala, collections, seq

我在许多示例中看​​到，有时使用 Seq，而其他时候使用 List ...

除了前者是 Scala 类型和 List 来自 Java 之外，有什么区别吗？

* * *

## 回答 #1

> 赞同：469
> 
> 时间：2012-06-02T23:48:11.797

在 Java 术语中，Scala 的`Seq`将是 Java 的`List`，Scala 的`List`将是 Java 的`LinkedList`。

请注意，`Seq`是 a `trait`，它相当于 Java 的`interface`，但相当于新兴的防御者方法。Scala`List`是一个抽象类，由`Nil`和扩展`::`，它们是`List`.

所以，Java`List`是一个`interface`.，Scala`List`是一个实现。

除此之外，Scala`List`是不可变的，而`LinkedList`. 事实上，Java 没有不可变集合的等价物（只读的东西只保证新对象不能更改，但您仍然可以更改旧对象，因此，“只读”对象）。

Scala`List`通过编译器和库进行了高度优化，它是函数式编程中的基本数据类型。但是，它有局限性，不足以进行并行编程。这些天来，`Vector`是比 更好的选择`List`，但习惯很难改掉。

`Seq`是序列的一个很好的概括，所以如果你编程到接口，你应该使用它。请注意，实际上有三个：`collection.Seq`，`collection.mutable.Seq`和`collection.immutable.Seq`，而后者是导入范围的“默认”。

还有`GenSeq`和`ParSeq`。后一种方法在可能的情况下并行运行，而前者是两者的父级`Seq`和`ParSeq`，当代码的并行性无关紧要时，它是一个合适的概括。它们都是相对较新引入的，因此人们还没有太多使用它们。

* * *

## 回答 #2

> 赞同：116
> 
> 时间：2017-04-17T18:33:52.270

[Seq](http://www.scala-lang.org/api/current/scala/collection/Seq.html)是具有定义的元素顺序的 Iterable 。序列提供了一种`apply()`索引方法，范围从 0 到序列的长度。Seq 有许多子类，包括 Queue、Range、List、Stack 和 LinkedList。

[List](http://www.scala-lang.org/api/current/scala/collection/immutable/List.html)是作为不可变链表实现的 Seq 。它最适用于具有后进先出 (LIFO) 访问模式的情况。

这是[Scala FAQ](https://docs.scala-lang.org/tutorials/FAQ/collections.html)中完整的集合类层次结构：

[![在此处输入图像描述](../Images/8b311164770e5c55f1903333b6f43ab3.png)](https://i.stack.imgur.com/2fjoA.png)

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2017-06-27T18:54:54.133

`Seq`是`List`实现的特征。

如果将容器定义为`Seq`，则可以使用任何实现`Seq`trait 的容器。

```
scala> def sumUp(s: Seq[Int]): Int = { s.sum }
sumUp: (s: Seq[Int])Int

scala> sumUp(List(1,2,3))
res41: Int = 6

scala> sumUp(Vector(1,2,3))
res42: Int = 6

scala> sumUp(Seq(1,2,3))
res44: Int = 6 
```

注意

```
scala> val a = Seq(1,2,3)
a: Seq[Int] = List(1, 2, 3) 
```

只是一个简写：

```
scala> val a: Seq[Int] = List(1,2,3)
a: Seq[Int] = List(1, 2, 3) 
```

如果未指定容器类型，则底层数据结构默认为`List`.

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2012-06-02T23:21:52.563

在 Scala 中，List 继承自 Seq，但实现了[Product](http://www.scala-lang.org/api/current/scala/Product.html)；这是[List](http://www.scala-lang.org/api/current/scala/collection/immutable/List.html)的正确定义：

```
sealed abstract class List[+A] extends AbstractSeq[A] with Product with ... 
```

[注意：为了适应和利用 Scala 非常强大的集合框架[，*实际*的定义](https://github.com/scala/scala/blob/v2.11.2/src/library/scala/collection/immutable/List.scala#L83)有点复杂。]

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-08-11T19:07:08.057

正如@daniel-c-sobral 所说，List 扩展了 trait Seq 并且是由`scala.collection.immutable.$colon$colon`（或`::`简称）实现的抽象类，但抛开技术问题不谈，请注意，我们使用的大多数列表和 seq 都以`Seq(1, 2, 3)`或`List(1, 2, 3)`两者都返回的形式初始化`scala.collection.immutable.$colon$colon`，因此可以写：

```
var x: scala.collection.immutable.$colon$colon[Int] = null
x = Seq(1, 2, 3).asInstanceOf[scala.collection.immutable.$colon$colon[Int]]
x = List(1, 2, 3).asInstanceOf[scala.collection.immutable.$colon$colon[Int]] 
```

因此，我认为唯一重要的是您要公开的方法，例如，在您可以使用`::`List 之前添加我认为与`+:`from Seq 多余的方法，并且我个人默认坚持使用 Seq。

# ember.js - 在 Ember.Select 视图中，如何在绑定项更改后显示提示？

> ID：10866641
> 
> 赞同：2
> 
> 时间：2012-06-02T23:13:53.147
> 
> 标签：ember.js

使用 Ember.Select 视图，例如：

```
{{view Ember.Select viewName="select"
    contentBinding="view.noseNames"
    prompt="Add a Nose:"
    selectionBinding="view.noseToAdd" 
}} 
```

当用户选择要添加的鼻子时，我想将 Ember.Select 重置回提示。我怎么做？我试过 set('noseToAdd' null)，但它只是将 Select 设置为一个空白项。

显示问题的完整 JSFiddle：

[http://jsfiddle.net/tyH8L/4/](http://jsfiddle.net/tyH8L/4/)

* * *

**车把**：

```
<script type="text/x-handlebars">
    {{#view App.PickANose}}                    
        {{view Ember.Select
            contentBinding="view.noseNames"
            prompt="Add a Nose:"
            selectionBinding="view.noseToAdd" 
        }}
    {{/view}}

    Picked Noses:
    {{#each App.noses}}{{this}}, {{/each}}
</script> 
```

​</p>

**JavaScript**：

```
App = Ember.Application.create({
    noses: []
});

App.PickANose = Ember.View.extend({
    noseNames: ['broken', 'roman', 'hawkish', 'aquiline'],
    noseToAdd: null,
    aNoseWasPicked: function () {
        if (Ember.none(this.get('noseToAdd'))) return;

        var noseToAdd = this.get('noseToAdd');
        App.get('noses').pushObject(noseToAdd);

        // HERE IS THE QUESTION:
        // How do I return the select back to "Add a nose:" ?
        // The following doesn't work in the latest EmberJS
        this.set('noseToAdd', null);                
    }.observes('noseToAdd')
});​ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-02T23:38:44.540

你试过设置`selection`吗`null`？

**更新：**

这是一个已修复的错误：[https ://github.com/emberjs/ember.js/commit/7a2a14b81aa7adf46c76c272f93c8aff31749582](https://github.com/emberjs/ember.js/commit/7a2a14b81aa7adf46c76c272f93c8aff31749582)

# php - 如何从 php 脚本增加 sql DB

> ID：10866648
> 
> 赞同：1
> 
> 时间：2012-06-02T23:16:18.880
> 
> 标签：php, mysql

我有一个 SQL DB，它只是一个表，其中一行我想从我的 iphone 中增加，只是为了测试与服务器的通信。

我以前用手机做过这个，但我从来没有在服务器端做过这些东西，我想学习。

到目前为止，我已经创建了如上所述的 sql 数据库。差不多就是这样。

```
CREATE TABLE workers
(
id SMALLINT NOT NULL AUTO_INCREMENT
) 
```

这可能有点错误..我花了几次才让它在服务器上工作，我现在只是从内存中写出来的。

但是现在我想弄清楚如何让它从我服务器上的 php 脚本中增加......到目前为止，对于脚本，我已经完成了基本的工作来让它检查数据库连接，所以它看起来像这样的小东西。。

```
<?PHP
$con = mysql_connect("db.url.com","pass","username");
if (!$con){die('Could not connect: ' . mysql_error());}
mysql_select_db("db", $con);

?> 
```

我不知道现在该怎么办..我猜它是某种类型的插入语句，但我不确定这一点，因为我在那行使用自动增量...

任何帮助将不胜感激..希望一旦我得到帮助解决这个问题，我将能够继续前进并自己做更复杂的事情:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-02T23:24:09.903

If you want to have just one row in the table, with a value increasing on every call, do

```
CREATE TABLE workers (id INT);
INSERT INTO workers SET id=0; -- or whatever start value you want 
```

Then for each increment run

```
UPDATE workers SET id=id+1; 
```

If you want to have more than one row, with ever increasing `id` field, use

```
CREATE TABLE workers (id INT AUTO_INCREMENT PRIMARY KEY); -- and other needed cols 
```

And for every row do

```
INSERT INTO workers SET id=0; -- again and other fields 
```

MySQL will not really set the field to 0, but to a new increased value.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-02T23:24:45.573

The mysql connection:

```
<?php 
$hostname = "yourhostname";
$database = "yourdatabase";
$username = "youusername";
$password = "yourpasword@";
$conn = mysql_pconnect($hostname,$username,$password) or die();
mysql_select_db($database,$conn) or die(“ERROR ”.mysql_error());
?> 
```

Then the INSERT:

```
<?php
mysql_query("INSERT INTO workers (id) VALUES (null)");
?> 
```

Hope it helps! =D

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-02T23:21:42.897

您可以忽略该列。例如对于这个表结构

```
CREATE TABLE workers
(
id SMALLINT NOT NULL AUTO_INCREMENT,
name varchar(30) NOT NULL
) 
```

你会这样做：

```
mysql_query("INSERT INTO workers(name) VALUES('John Peters')"); 
```

它会自动添加该列。此外，对于每个具有 NULL 可用或已定义值集的列，您也可以跳过它们，它会自动分别分配 NULL 和默认值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-02T23:22:18.953

AUTO_INCREMENT means each successive row you insert has an incrementally higher id. All you should need is a primary key on the id column.

```
INSERT INTO `workers` (`id`) VALUES (1) ON DUPLICATE KEY UPDATE `id` = `id` + 1 
```

This will insert a row if there are no rows, but if you've already inserted a row, increments the id.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-02T23:23:31.923

Try:

```
INSERT INTO `workers` VALUES (NULL) 
```

or

```
INSERT INTO `workers` (id) VALUES (NULL) 
```

# php - CodeIgniter 分页：uri 段

> ID：10866652
> 
> 赞同：-2
> 
> 时间：2012-06-02T23:17:14.913
> 
> 标签：php, codeigniter, pagination

我认为向用户展示 CI 文档似乎并不容易。
我花了很多时间来发现问题和问题。框架 php 应该很容易而且做得很快吧？这就是它们存在的原因？

这是我的代码：

```
$config['base_url'] = site_url('admin/index/page/');
$config['uri_segment'] = 4; 
```

Mysql Sql 结果：

```
SELECT b.*, a.adCampaignTitle FROM ads a, sms b WHERE b.`smsAd_ID`=a.ad_ID LIMIT 4, 20 
```

从 sql 输出中可以看出，uri_segment 就像一个整数值。而已。并且任何创建的分页页面，sql输出都是一样的！当我尝试时：

```
$offset = $this->uri->segment(4); 
```

SQL 工作正常，但分页（创建链接）不能正常工作。第一页的链接在每个页码中都消失了（只是）。

***请发帖，如果您真的对此问题有所了解。我真的像 Anastacia 一样又病又累....

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-12-19T12:41:16.290

这个问题是2岁。我有一个类似的问题，并用谷歌搜索到这个页面。看到了，还没有回答，以防万一有人遇到类似问题。您可以使用

```
$config['uri_segment'] = $this->uri->total_segments(); 
```

解决您的分页“链接”（Prev,1,2,3,4,Next）错误，如上所述，您的第一页分页将无法正常工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-02T23:45:54.327

我不能确定这是您的问题，但我相信您还需要说明有多少行，以便分页正常工作。

所以添加：`$config["total_rows"] = /*total number of records returned by the query, without the limit */`看看是否有帮助。

另请阅读[本文](http://www.dijexi.com/2009/08/how-to-use-codeigniter-pagination-class-with-database/)，了解有关如何正确设置的一些想法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-28T23:44:19.953

我正在使用 HMVC，但我在分页工作时遇到了同样的问题。但是我设法通过使用段 3 使用 HMVC 或仅使用 CI 中的 MVC 使其工作。当我使用段 4 时，它不起作用。我不知道为什么。这也是我的大问题，因为我真的需要使用 4 号段。我家这个 bug 可以在 CI 的下一个版本中解决。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-07-21T22:01:07.097

HMVC 使用：segment diffrent 问题

链接：[域].com/admin/logs/log_list/10/1

解决了：

```
$config['uri_segment'] = 5; 
```

完整代码：

```
public function data_count($sql){

    $query  = $this->db->query($sql);
    return $query->num_rows();

}

public function get_list($sql,$url,$show,$page){

    $list = array();
    $this->load->library('pagination');
    $this->load->helper('url');
    $total = $this->data_count($sql);

    $config = array(
        'base_url'          => $url,
        'total_rows'        => $total,
        'per_page'          => $show,
        'num_links'         => 5,
        'use_page_numbers'  => true,
        'page_query_string' => false,
        'uri_segment'       => 5,
        'full_tag_open'     => '<ul class="pagination pull-right">',
        'full_tag_close'    => '</ul>',
        'first_link'        => '<<',
        'first_tag_open'    => '<li>',
        'first_tag_close'   => '</li>',
        'last_link'         => '>>',
        'last_tag_open'     => '<li>',
        'last_tag_close'    => '</li>',
        'next_link'         => '>',
        'next_tag_open'     => '<li>',
        'next_tag_close'    => '</li>',
        'prev_link'         => '<',
        'prev_tag_open'     => '<li>',
        'prev_tag_close'    => '</li>',
        'cur_tag_open'      => '<li class="active"><a>',
        'cur_tag_close'     => '</a></li>',
        'num_tag_open'      => '<li>',
        'num_tag_close'     => '</li>'
    );

    $this->pagination->initialize($config);
    $pagination = $this->pagination->create_links();
    $list["pagination"] =$pagination;

    if(!empty($page)){ $start = ($page*$show)-$show; } else { $start = 0; } 

    $query  = $this->db->query($sql." limit ".$start." , ".$show);

    if($query->num_rows()>0){
        $list["list"] = $query->result_array();
    }
    else{
        $list["list"] = "";
    }

    $list["total"] = $total;

    return $list;

} 
```

# php - 扩展类时出错

> ID：10866653
> 
> 赞同：1
> 
> 时间：2012-06-02T23:17:18.387
> 
> 标签：php, class, this, parent, extend

我在扩展类时遇到问题。

这就是我想要做的：

```
class Core
{
    protected $db;

    public function __construct()
    {
            $this->set_db_class();
    }

    private function set_db_class ()
    {
        include_once ( './classes/Database.php' );
        $this->db   = new Database();
    }
}

class Functions extends Core
{
    public function __construct()
    {
                parent::__construct();
    }

    public static function create_user ()
    {
        $this->db->query ( "INSERT ..." );
    }
} 
```

所以，这就是结构，但我的问题是我收到以下错误：

致命错误：在第 10 行的 /Applications/XAMPP/xamppfiles/htdocs/own/newsite/classes/class.Functions.php 的对象上下文中使用 $this

我能做些什么来解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-02T23:20:51.030

声明`create_user`为非静态并从实例中调用它，否则（如错误消息所述）您无法访问 $this，因为 $this 始终是对当前实例的引用。在静态上下文中，没有一个。

```
$functions = new Functions();
$functions->create_user(); 
```

代替

```
Functions::create_user(); 
```

If you want to bundle functions that are not logically related to each other, use a namespace and not a class. You *can* go with an all-static class (every tiny property and method is static so that you don't need an instance at any time), but that's a horrible solution and not what classes should be used for.

# asp.net-mvc-4 - 从 beta 升级后的 Autofac / MVC4 / WebApi (RC) 依赖注入问题

> ID：10866655
> 
> 赞同：14
> 
> 时间：2012-06-02T23:17:30.033
> 
> 标签：asp.net-mvc-4, autofac

```
var resolver = new AutofacWebApiDependencyResolver(container);
configuration.ServiceResolver.SetResolver(resolver); 
```

更新到 ASP.NET MVC4 (RC) 后，我收到以下错误：

> “System.Web.Http.HttpConfiguration”不包含“ServiceResolver”的定义，并且找不到接受“System.Web.Http.HttpConfiguration”类型的第一个参数的扩展方法“ServiceResolver”（您是否缺少 using 指令还是汇编参考？）

看完这篇（http://www.asp.net/web-api/overview/extensibility/using-the-web-api-dependency-resolver）我意识到这些接口已经改变了，但我不知道如何应用这改变了我使用 Autofac 的方式。

我需要等待 Autofac 的新版本还是有其他方法可以解决这个问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-03T12:12:18.320

**编辑：** 正如 James Bradt 在下面的帖子中提到的那样，Autofac 软件包现已更新以解决此问题，因此将来遇到此线程的任何人都应该先尝试新软件包 :)

基本上，使用新包，您只需要在 global.asax.cs 中执行此操作：

```
GlobalConfiguration.Configuration.DependencyResolver = new Autofac.Integration.WebApi.AutofacWebApiDependencyResolver(container); 
```

**/编辑**

我刚刚遇到了同样的问题——我可以通过创建一个简单的 IDependencyResolver 实现来解决这个问题，该实现包含现有的 AutofacDependencyResolver。

正如类名所暗示的，我将此视为临时解决方案 - BeginScope 和 Dispose 方法需要一些工作，并且显然不适合生产环境，但这允许我继续开发，直到出现适当的解决方案。

因此，有了这些警告，IDependencyResolver 实现看起来像这样：

```
public class TemporaryDependencyResolver : IDependencyResolver
{
    private readonly AutofacDependencyResolver _autofacDependencyResolver;

    public TemporaryDependencyResolver(AutofacDependencyResolver autofacDependencyResolver)
    {
        _autofacDependencyResolver = autofacDependencyResolver;
    }

    public void Dispose()
    {
    }

    public object GetService(Type serviceType)
    {
        return _autofacDependencyResolver.GetService(serviceType);
    }

    public IEnumerable<object> GetServices(Type serviceType)
    {
        return _autofacDependencyResolver.GetServices(serviceType);
    }

    public IDependencyScope BeginScope()
    {
        return this;
    }
} 
```

我在 Global.asax.cs 中这样设置：

```
var container = builder.Build();
var resolver = new AutofacDependencyResolver(container);
GlobalConfiguration.Configuration.DependencyResolver = new TemporaryDependencyResolver(resolver); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-07T14:42:11.927

AutoFac.WebApi 包已更新至 (RC) - 版本 2.6.2.859

这似乎已针对 RC 和 Beta 之间的依赖关系的变化进行了调整

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-04-07T10:40:40.263

我尝试了上述解决方案，但对我没有用。删除并重新安装这两个特定的软件包为我解决了这个问题。

```
Microsoft.AspNet.WebApi.Tracing
Microsoft.AspNet.WebApi.OData 
```

# javascript - javascript函数不返回任何结果

> ID：10866658
> 
> 赞同：-1
> 
> 时间：2012-06-02T23:18:15.937
> 
> 标签：javascript

我有一个javascript函数

```
<head>
    <title>
        Test
    </title>
    <script type="text/javascript">
        function GetResult()
        {
            count = 0;
            for(var i=0;i<10;i++){
                for(var j=1;j<4;j++){
                    if (document.getElementById("label"+i+j).checked){
                        count +=1;
                    }
                }
            }
            if (count!=10)
                alert("Please answer all the questions");
            else alert(count);
        }
    </script> 
```

在代码中有很多单选按钮。看起来像

```
<input type="radio" name="q1" value="1" id="label01"/> 
```

但我的 javascript 函数从不显示警报。应该调用函数的按钮是

```
<input type="button" value="Result" onclick="GetResult()"/> 
```

也许按钮不调用`GetResult`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-02T23:30:09.520

试试这个：

```
 function GetResult() {
        var count = 0;
        for (var i = 0; i < 10; i++){
            for (var j = 1; j < 4; j++){
                var label = document.getElementById("label" + i + j);
                if (label && label.checked) {
                    count +=1;
                }
            }
        }

        if (count != 10) {
            alert("Не все отвечено");
        } else {
            alert(count);
        }
    } 
```

*   添加`var`到`count`声明中。
*   修正了一些一般格式。
*   `document.getElementById()`重要的一点：在检查该值的`checked`属性之前检查是否返回了一个值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-02T23:30:26.313

详细说明 Felix 已经说过的内容：这是检查是否`document.getElementById`找到指定元素的方法（如果失败，它将返回 null）。

```
for (var i = 0; i < 10; i++) {
    for (var j = 1; j < 4; j++) {
        // Store the result in a local variable
        var label = document.getElementById("label"+i+j);

        // Include a check whether "null" got returned
        if (label && label.checked) {
            count +=1;
        }
    }
} 
```

# php - PHP中的多页发票/文档

> ID：10866659
> 
> 赞同：3
> 
> 时间：2012-06-02T23:18:22.037
> 
> 标签：php, pdf, invoice

**TL;DR：** PHP 生成总页数超过 1 页的 PDF 时遇到问题。

* * *

再一次问好。我的目标是创建一个脚本，它基本上可以获取所有重要数据，并创建一个 A4 格式的 PDF 发票/文档，用于打印/邮寄/存档。只要文档不溢出，生成 PDF 文档就可以了。

我希望发票页面带有边框，它应该包含：

*   发票有效所需的材料
*   计费产品/其他信息
*   供应商/客户签名和盖章或其他数据的地方

所有页面都必须包含页眉和页脚（公司徽标）和页脚（第 # 页，共 # 页 - 发票/文档 ID - 日期和时间 - 办公室 ID - 打印机 ID、指定人员、任何人可以询问的内容），以及周围的边框文档正文（页眉下方，页脚上方）。

**只要**文档大小不大于

```
$pageSize-$pageMargins-$header-$footer-$invoiceDataBlock-$signaturesBlock 
```

这基本上就像实际发票项目的 10 厘米。如果文档更大，我实际上是使用电子表格编辑器手动为发票创建附件。

*问题*是：我可以做些什么来创建一个没有问题的多页 PDF 文档，例如覆盖页眉/页脚的发票项目？我需要知道何时继续下一页。我怎么知道这个？完成这项任务的最佳方法是什么？

先感谢您！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-03T02:49:53.090

我已经使用 FPDF 和 TCPDF 来生成多页发票文件。它们的工作方式大致相同。（我从 FPDF 开始，然后在需要包含 Unicode 字符时切换到 TCPDF，当时 FPDF 不支持。）

正如 Eugen 所建议的，与使用 FPDF 或 TCPPDF 中内置的函数相比，您可以更轻松地手动滚动自己的页眉和页脚。

我确保不覆盖页脚的策略只是小心发票中包含的数据。添加新 SKU 时，我会测试长名称以确保它们适合发票 PDF 中的字段。对于*必须*是可变长度的项目，我将未知内容放在自己的行中以减少可能的影响：

> 域名注册（2 年）
> ↳ *example.com*

当我生成发票的每一页时，我会跟踪我使用了多少行。我知道我可以安全地放 20 行项目，并且我知道我的最大单个项目是 2 行，然后当我达到 20 行时，我开始一个新的页面。15 项表示 1 页。25 项意味着两页。项目计数器上升，每次我达到 20 行限制时，它都会生成下一页并重置页面项目计数器。

请注意，我没有在此答案中包含任何代码，因为您的问题中没有包含任何代码。如果您需要实施方面的帮助，我怀疑这将成为另一个问题的理由。:-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-02T23:27:31.573

Use TCPDF. It has a very handy `SetY() / GetY()` pair of functions, that allows you to know, where on the page you are. You can use this to know when to do a page break.

Hint: Do not use the Header/Footer capabilities - they are clunky. Draw your own headers/footers.

**Edit**

As from discussion below, here are some details: To avoid overlaying you have 2 possibilities

1.  Use `getStringHeight()` and calculate
2.  Use Transactions

The first version draws its rationale from the fact, that of all objects you typically use in generating a PDF a text-flow is the only one, of which you cannot tell beforehand the height it will use. `getStringHeight()` provides you with a good enough estimate, so you know before adding the element, if it will fit on the page (leaving enough room on the bottom for the footer). So basically you extend your drawing loop to calculate the height of each element and test, if you need to start a new page first. This allows also for some sort of keeptogether, e.g. if the remaining space after a section title is too low, start a new page before, to keep section title and section body together.

The second version is even easier: In TCPDF you can use transactions simialr to a Database: Start a transaction, draw, if the result is not to your liking roll back, else commit. We found this to be quite a performance hog, ultimately deciding against it for long textual reports, but a 2-page invoice is a very different beast.

# python - 如何在 python 中安全地存储 LWPCookieJar 对象？

> ID：10866660
> 
> 赞同：2
> 
> 时间：2012-06-02T23:19:22.767
> 
> 标签：python, cookielib

我`cookielib.LWPCookieJar`在 Python 2.6 中使用一个对象来保存 cookie 并在将来调用我的脚本时重新加载它们。该`save()`方法生成具有默认权限的文件 - 也就是说，我系统上的其他用户可以读取（并且可能随后使用）我以这种方式保存的 cookie。

在我看来，为了安全起见，持久性 cookie 通常应该保存在用户只读文件（umask 077）中。`save()`有没有办法在我自己的子类中重新实现该方法的情况下做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T16:05:26.917

我同意这很重要——会话 ID 通常保存为 cookie。

将cookie保存到只有用户可以访问的目录中的文件就足够了吗？

```
os.mkdir( myTmpDir, 0700 )
// Now save the CookieJar in there... 
```

# javascript - 从菜单中点击链接时在 jquery 中加载 Ajax

> ID：10866663
> 
> 赞同：0
> 
> 时间：2012-06-02T23:20:28.633
> 
> 标签：javascript, ajax, jquery

我是 Jquery 和 Ajax 的新手，现在已经尝试解决一个问题超过 1 小时。

您可以在此处查看该页面：http: [//smartcreations.se/test/test.html](http://smartcreations.se/test/test.html)（如果您单击绿色区域，它具有我想要的效果。）

几乎所有东西都按我的意愿工作，除了我不能使用顶部的菜单来让框像单击绿色 div 时那样填充和加载内容。

所以我想从你们那里得到一些关于我如何解决这个问题的意见，另一种观点。

```
$(window).load(function(){
$(".box").click(function(){
$(this).animate({
top: '-50%'
}, 500, function() {
$(this).css('top', '150%');
$(this).appendTo('#container');             
$(".loadinghere").load($(this).attr('name'));
});
$(this).next().animate({
top: '50%'
}, 500);
});
}); 
```

这是我得到的最接近的，但链接根本不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-03T00:05:30.393

You can just fake the click on the box by using e. g.

```
$("#box1").click(); 
```

but I would do it completely different:

```
<a href="107.html?nr=2" class="show">About me!</a>
<a href="108.html?nr=2" class="show">Portraits</a>
<a href="107.html?nr=2" class="show">Weddings</a>
<a href="109a.html?nr=2" class="show">Action</a>

<script type='text/javascript'> 
$(document).load(function(){
    $("a.show").on("click", function(e){
        e.preventDefault();
        var click=$(this);
        var link=click.attr("href")+"#box";
        $("#box").after("<div id='box2' />").load(link, function(){
            $(this).animate({
                // your effect and stuff
            });
            // Rename the new box and throw out the old one
            // Make sure, it is not visible
            $("#box").remove();
            $("#box2").attr("id","box");
        });
    });
}); 
</script> 
```

The idea is, to use full html and extract just the html out of `#box` and insert it on your current page. You can also use the newer history api or anchors for this. The main advantage is, that you can still use your page if JS is turned of. (Miss)using name or other html attributes for this is a really bad practice. If you need to, use the data attribute.

(The code is untested and the quick and dirty way just to give you an idea.)

# regex - 正则表达式 - 分组？

> ID：10866666
> 
> 赞同：0
> 
> 时间：2012-06-02T23:20:52.010
> 
> 标签：regex

我真的可以使用一些帮助。我有以下两行。

```
<TD noWrap>Data: <B><SPAN class="TableBody clsBold">4</SPAN></B></TD>
<TD noWrap>Format: <B><SPAN class="TableBody clsBold">9</SPAN>/<SPAN class=TableBody> </SPAN></B></TD> 
```

我需要抓取标签之间的文本（分别为 4 和 9）

我正在使用以下正则表达式语句：

```
(\s)*(<B>)*<(?<SPAN>\w*)(?:.*)>(?:.*)</\k<SPAN>> 
```

这对于第一行非常有效，如下所示：

```
Data: (\s)*(<B>)*<(?<SPAN>\w*)(?:.*)>(?:.*)</\k<SPAN>> 
```

但不适用于

```
Format: (\s)*(<B>)*<(?<SPAN>\w*)(?:.*)>(?:.*)</\k<SPAN>> 
```

因为它在我需要的部分之后抓住了 SPAN，所以我在第 4 组中没有得到 9。

如何使用具有不同前缀的相同正则表达式行获得我需要的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-02T23:28:20.253

我会在正则表达式中准确指定我要查找的内容。话虽这么说，这样的事情就足够了：

```
<TD noWrap>([A-Za-z]+:)\s*<B><SPAN class="TableBody clsBold">(\d+)</SPAN> 
```

它只使用两个捕获组，所以你应该得到 match `("Data", "4")`，并且`("Format", "9")`

# ruby-on-rails - 设计使用用户名而不是电子邮件进行身份验证

> ID：10866667
> 
> 赞同：19
> 
> 时间：2012-06-02T23:21:00.057
> 
> 标签：ruby-on-rails, devise

我是 Devise 的新手，通过使用电子邮件地址作为身份验证密钥，它可以正常工作。但是，我有一个需要用户名的用例，但我似乎无法让它工作。

我在 users 表中添加了一个字符串列“username”，将登录表单中的字段从 :email 更改为 :username ，并在我去的时候将 devise.rb 中的身份验证密钥更改为 :username登录 我遇到了这个提示：“请输入电子邮件地址”。

我究竟做错了什么？

```
**new.html.erb**

  <div><%= f.label :username %><br />
  <%= f.email_field :username %></div>

**User.rb**
class User < ActiveRecord::Base
  # Include default devise modules. Others available are:
  # :token_authenticatable, :encryptable, :confirmable, :lockable, :timeoutable and :omniauthable
  devise :database_authenticatable, :registerable,
         :recoverable, :rememberable, :trackable, :validatable, :authentication_keys => [:username]

  # Setup accessible (or protected) attributes for your model
  attr_accessible :email, :password, :password_confirmation, :remember_me, :username
  # attr_accessible :title, :body
end

**devise.rb**
 config.authentication_keys = [ :username ] 
```

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-06-02T23:28:17.990

在您的 config/initializers/devise.rb 取消注释`config.authentication_keys = [ :email]`并将其更改为`config.authentication_keys = [ :username ]`

**更新：**
您的表格不正确。
更改`f.email_field`为`f.text_field`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-03T04:35:24.030

*   首先，确保运行迁移。

`bundle exec rake db:migrate`

*   为 Devise 生成视图，否则 Devise 将使用默认值。

`rails generate devise:views`

*   根据需要更改设计/视图（将电子邮件字段替换为用户名字段）

*   重启网络服务器

希望能帮助到你！

# iphone - 从 void Xcode 启用和禁用点击手势识别器

> ID：10866668
> 
> 赞同：2
> 
> 时间：2012-06-02T23:21:15.967
> 
> 标签：iphone, objective-c, ios, xcode, uigesturerecognizer

我想标题说得最多，但这里有一些具体细节

我有一个文本框，当我单击它时，它会打开一个键盘，可以帮助您在文本框上输入数字

我把tapgesture识别器关闭了键盘，它可以工作，但我把它放到了ViewDidLoad方法中。我想在打开键盘时启用 GestureRecognizer 并在我关闭键盘时禁用自身。我需要这个，因为点击识别器会延迟屏幕上的触摸。

在`ViewDidLoad`我调用方法中使用

```
[self gestureenablingvoid];
and in the gestureenablingvoid I use this
    if (textfield.isEditing) {
     //code that generates tapgesture
    } 
```

但它不像我想要的那样工作。

所以感谢您的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-02T23:40:05.123

我建议使用`touchesBegan:withEvent:`而不是手势识别器来获得更简单的解决方案：

```
-(void) touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event{
    [yourUITextFieldName resignFirstResponder];
} 
```

将此方法添加到您的 ViewController 后，当您触摸它外部时，键盘应该会消失。

# haskell - 如何在 Haskell 中编写 Data.Vector.Unboxed 实例？

> ID：10866676
> 
> 赞同：17
> 
> 时间：2012-06-02T23:22:07.437
> 
> 标签：haskell, typeclass, unboxing

我有一个数字应用程序，它对概率的负对数做了很多工作，它（因为概率范围从零到一）取正双精度值或负无穷大（如果基础概率为零）。

我将这些与新类型一起使用`Score`，如下所示：

```
newtype Score = Score Double
  deriving (Eq, Ord)
 -- ^ A "score" is the negated logarithm of a probability

negLogZero :: Score -- ^ Stands in for - log 0
negLogZero = Score 10e1024

negLogOne :: Score -- ^ - log 1
negLogOne = Score 0.0

unScore :: Score -> Double
unScore (Score x) = x

instance Show Score where
  show (Score x) = show x 
```

现在，在 Viterbi 算法的一个实现中，我已经使用`Data.Vector`了很多，而且确实有一些`Data.Vector`s `Score`。在尝试进行一些性能调整时，我决定尝试使用`Data.Vector.Unboxed`. 但是，我需要为 编写一个`Unbox`不能派生的实例，而且我不太清楚我需要做什么（特别是类型类的契约是什么`Unbox`）。由于`Score`确实`Double`具有一些有用的构造函数和语义，我认为这应该是可能的。据我所知，我需要能够判断s`Data.Vector.Unboxed`向量中的每个插槽`Score`必须有多大，并且我猜如何读取和写入它们（但见鬼，它们很像`Double`s）。

那么，我该怎么办？谢谢！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-02T23:29:41.963

`Unbox`类型类没有任何方法——它只是`Vector`和`MVector`类型类的简写。派生这些，`Unbox`课程是免费的（通过派生或只是`instance U.Unbox Score`在某处写在自己的行上）。

```
{-# LANGUAGE GeneralizedNewtypeDeriving #-}
import Data.Vector.Generic.Base
import Data.Vector.Generic.Mutable
import qualified Data.Vector.Unboxed as U
newtype Score = Score Double deriving (Vector U.Vector, MVector U.MVector, U.Unbox) 
```

# javascript - Redefining a RequireJS module -- is it possible?

> ID：10866679
> 
> 赞同：3
> 
> 时间：2012-06-02T23:23:30.777
> 
> 标签：javascript, google-chrome, requirejs, userscripts

Basically, there is a page that I visit that uses [RequireJS](http://requirejs.org/). I want to make adjustments to this page, so I went the route of a userscript. While looking at the client-side code I see that there is a module defined as so:

```
define("settings", [], function() {
    return {
    SETTINGA: "100",
    SETTINGB: "200",
    etc.
    }
}) 
```

I want to add my own item to the settings array, as well as change some settings without having to redefine the module in my userscript (with the changes) and then removing/readding it. Is it possible to just make adjustments to this module?

* * *

P.S. I'm using the [Script Injection](https://stackoverflow.com/a/5006952/347172) technique to get my userscript to interact with other javascript in the original page.

Also, doing `require("settings")` in the Javascript console returns an object (not an array), so I can't do things like `require("settings")[0]` or `require("settings").push(...)`, however I can access the settings by doing `require("settings").SETTINGA`. So, I'm not sure how to add/redefine settings to this since it is not an array?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-02T23:43:13.827

用这个：

```
require('settings').new_property = 'new value'; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-03-27T19:29:45.820

您无法检索或将设置添加到“设置数组”的原因是您没有创建一个数组开始。`{foo:bar}`是一个*对象字面*量，而不是一个数组字面量 ( `[foo,bar]`)。

# jquery - Firefox not honoring must-revalidate cache headers returned by jQuery.ajax() request

> ID：10866685
> 
> 赞同：0
> 
> 时间：2012-06-02T23:24:48.313
> 
> 标签：jquery, http, firefox

**UPDATE 1**: Judging by [this thread](https://bugzilla.mozilla.org/show_bug.cgi?id=751753) I am not the only one having this problem in FF 12 and only in 12.

**UPDATE 2**: The problem does not seem to be limited to Ajax requests. From the looks of it everything that makes it into Firefox 12's cache will be fetched from there. No matter what. The server can specify cache control headers all day long. Bummer!

What I'm trying to achieve is the following behavior:

1.  Browser may cache the response without revalidating for up to 5 minutes
2.  I don't care if the browser revalidates on every request (Both Chrome and IE9 do for example)
3.  When the expiration is up the browser MUST revalidate (which in my case will result in fresh data)

Chrome and IE9 exhibit the desired behavior when issuing a jquery.ajax() request with ifModified: true and cache: true while Firefox 12 **never** revalidates, which poses a serious problem.

These are the actual response headers:

```
HTTP/1.1 200 OK
Server: nginx
Date: Sun, 03 Jun 2012 07:13:43 GMT
Content-Type: text/javascript; charset=UTF-8
Transfer-Encoding: chunked
Connection: keep-alive
Vary: Accept-Encoding
Cache-Control: private, must-revalidate, max-age=300
Last-Modified: Sun, 03 Jun 2012 07:07:13 GMT
Content-Encoding: gzip 
```

Any suggestions?

# css - How can I get the height of my website to accommodate for various sized iframe pages?

> ID：10866687
> 
> 赞同：2
> 
> 时间：2012-06-02T23:24:57.763
> 
> 标签：css, iframe, html, size

It's such a simple issue blocking me from accomplishment and happiness.

The Parent Div of my site: Must *not* be an exact height.

```
#Container {
    position:relative;
    margin-right: auto;
    margin-left: auto;
    width: 993px;
    **height: 100%;**
} 
```

The iFrame_Holder Div: Also must not be an exact height.

```
#iframe_holder {
    position: relative;
    width: 993px;
    height: 100%;
} 
```

The HTML: (Src .html pages will be relatively positioned with various page heights.)

```
<html>
    <body>
        <div id="Container">
            <div id="iframe_holder">
                <iframe width="933" height="100%"frameborder="0" Scrolling="no" src="About.html"> </iframe>
            </div>
        </div>
    </body>
</html> 
```

Now if the parent div must have a specific hight rather than percentage how will my Iframe's various sized pages get displayed without awkward extra space or being cut off?

What the trick and thanks for your help.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T11:20:39.260

您可以使用 css3 媒体查询：

```
@media screen and (height: 640px){
  #iframe_holder{height:120px;}
} 
```

另一种解决方案是替换：height:inherit for iframe

另一个解决方案是使用 JavaScript 来获取窗口的高度。

# iphone - 确定 iOS 版本

> ID：10866690
> 
> 赞同：0
> 
> 时间：2012-06-02T23:25:21.440
> 
> 标签：iphone, ios, xcode

> **可能重复：**
> [检查 iPhone iOS 版本](https://stackoverflow.com/questions/3339722/check-iphone-ios-version)

我正在尝试设置一些在 iOS 5.0.1 上与 iOS 5.1 及更高版本不同的代码。是否有 if 语句来确定它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-02T23:27:25.160

```
float version = [[[UIDevice currentDevice] systemVersion] floatValue]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-02T23:28:06.430

```
 if ( [[[UIDevice currentDevice] systemVersion] floatValue] == 5.0)
{
// Do something
}

else if ( [[[UIDevice currentDevice] systemVersion] floatValue] == 5.1)
{
// Do something
}
else
{
// Do something
} 
```

# visual-studio-2012 - Error getting to Test Window in VS 2012 RC

> ID：10866691
> 
> 赞同：3
> 
> 时间：2012-06-02T23:25:24.637
> 
> 标签：visual-studio-2012

I have been using the customer preview of Visual Studio 2012 up until day before yesterday when the Release Candidate became available. After I installed the Release Candidate, I can't get to the Test Window (Test / Windows / Test Explorer).

I get the following lengthy error which I've copied manually here. (Since this is my first question, I couldn't post the picture, and the screen would not allow me to copy the text to the clipboard. Hopefully there are no typos.)

```
The composition produced a single composition error. The root cause is provided below.  Review the CompositionException.Errors property for more detailed information.

1) Value cannot be null.
Parameter name: testPlatform

Resulting in: An exception occurred while trying to create an instance of type 'Microsoft.VisualStudio.TestWindow.Model.ReqeustConfigurationFactory'.

Resulting in: Cannot activate part
'Microsoft.VisualStudio.TestWindow.Model.ReqeustConfigurationFactory'.
Element: Microsoft.VisualStudio.TestWindow.Model.ReqeustConfigurationFactory -->
Microsoft.VisualStudio.TestWindow.Model.ReqeustConfigurationFactory --> CachedAssemblyCatalog

Resulting in: Cannot get export
Microsoft.VisualStudio.TestWindow.Model.ReqeustConfigurationFactory
(ContractName="Microsoft.VisualStudio.TestWindow.Model.RequestConfigurationFactory")' from part
'Microsoft.VisualStudio.TestWindow.Model.ReqeustConfigurationFactory'.
Element:
Microsoft.VisualStudio.TestWindow.Model.ReqeustConfigurationFactory
(ContractName="Microsoft.VisualStudio.TestWindow.Model.RequestConfigurationFactory") --> CachedAssemblyCatalog 
```

The error occurs regardless of whether I have opened a solution or not. A second attempt to open the window yields "Cannot create the tool window." After restarting Visual Studio, and attempting to get to the Test Window, I get the long message again.

At the time I upgraded Visual Studio to the Release Candidate, I had installed:

*   NUnit
*   SpecFlow
*   ReSharper (Beta)
*   Code Contracts -- the last thing I had installed before upgrading Visual Studio. I cannot guarantee that the test window was working after I installed this.

I have searched the web for key phrases out of the error message, but found no help.

I have also:

*   Repaired Visual Studio (which solved a problem I was having getting to the Extension Manager, but not the Test Window problem)
*   Uninstalled Visual Studio and reinstalled it
*   Uninstalled each of the Extensions/packages listed above (NUnit, SpecFlow, ReSharper, Code Contracts). Uninstalling didn't seem to help, so I have re-installed all of them, one at a time. I've also confirmed that I can run tests in the ReSharper test window.
*   Deleted the currentsettings.vssettings file from C:\Users\\Documents\Visual Studio 11\Settings, hoping it contained the problem and would be recreated correctly. I got a message that "The IDE will use your most recent settings for this session". I don't know where to find those...
*   Reset settings from the Import and Export Settings option.

None of these actions has helped.

It looks to me like a config file somewhere is missing an element for testPlatform, but I have no idea where that would be (or in what format, or what Options page entry would set it.)

Any help would GREATLY be appreciated.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-04T10:28:28.243

我没有弄清楚究竟是什么导致了错误，但我确实修复了它。这就是最终奏效的方法

我又安装了所有 VS 2012 以及扩展，然后寻找卸载可能留下的位。在重新安装之前，我发现并删除了以下内容：

*   `C:\Users\<my id>\Documents\Visual Studio`
*   `C:\Users\<my id>\AppData\Roaming\Microsoft\VisualStudio`
*   `C:\Users\<my id>\AppData\Local\Microsoft`
*   注册表：`HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft`

重新安装 Visual Studio 2012 RC 后，原来的问题就解决了。重新安装扩展也成功。

# php - Simple contact form mailer

> ID：10866694
> 
> 赞同：0
> 
> 时间：2012-06-02T23:26:12.080
> 
> 标签：php, html, css, forms

Well I'm working on my first PHP code, in the way of a simple form mailer. I can't seem to see why its generating the error

> We are very sorry, but there were error(s) found with the form you submitted. These errors appear below.
> 
> We are sorry, but there appears to be a problem with the form you submitted.
> 
> Please go back and fix these errors.

If anyone well versed in PHP sees the issue, I'd appreciate any guidance you can give.

The HTML

```
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>untitled</title>
</head>

<body>
<form action="send_form_email.php" method="post">
<fieldset>
<legend> Error Report:</legend>
<p><input name="name" type="text" placeholder="Your Name" autofocus></p>
<p><input name="email" type="text" placeholder="email@domain.com"></p>
<p><textarea name="descpirtion" placeholder="Give a description of the error."></textarea></p>
<p><label>What internet browser were you using when the error occured?</label></p>
<p><select name="browser"><option>Internet Explorer</option><option>Chrome</option><option>Safari</option><option>Firefox</option></select></p>
<p><input type="submit" value="Submit"> <input type="reset" value="Cancel"></p>
</fieldset>
</form>

</body>
</html> 
```

the CSS

```
body {background: #222; padding: 1em; margin: 0; font-size: 16px; color: #777;}
     body * {margin: 0; padding: 0; font-family: helvetica, sans-serif;}
     p {margin: 0 0 1em; font-size: 14px;}

    input, textarea, select {
     border: 1px solid #111;
     border-radius: 5px;
     padding: 0.5em;
     font-size: 15px;
     line-height: 1.2em;
     width: 80%;
     background: #444;
     color: #999;
     font-family: helvetica, sans-serif;
     background: -webkit-gradient(linear, left top, left bottom, from(#222), to(#444));
     -webkit-appearance: none;
       -webkit-box-shadow: 1px 1px 1px #333;
     }

     input:focus, textarea:focus, select:focus {outline-color: #FC0;}

   textarea {
       color: #999;
       border-radius: 5px;
       height: 55px;
       background: -webkit-gradient(linear, left top, left bottom, color-stop(0, #222), color-stop(0.05, #333));
   }

   select {
       color: #999;
       border-radius: 5px;
       padding: 0.5em 1em 0.5em 0.75em;
       background: -webkit-gradient(linear, left top, left bottom, color-stop(0, #222), color-stop(0.05, #333));
}

     input[type=text] {
     color: #999;
     border-radius: 5px;
     background: -webkit-gradient(linear, left top, left bottom, color-stop(0, #222), color-stop(0.12, #333));
   }

   input[type=submit] {
     color:#FFF;
     border-radius: 5px;
     width: auto;
     padding: 0.25em 1em;
     line-height: 1.5em;
     background: -webkit-gradient(linear, left top, left bottom, from(#FC0), to(#FF0));
     border: 2px solid #FC0;
     text-shadow: 0 0 2px #300;
     font-weight: bold;
     -webkit-box-shadow: 1px 1px 3px #000;
     margin-right: 0.5em;
   }

   input[type=reset] {
      border-radius: 5px;
      width: auto;
      padding: 0.25em 1em;
      line-height: 1.5em;
      background: -webkit-gradient(linear, left top, left bottom, from(#333), to(#222));
      border: 2px solid #444;
      text-shadow: 0 0 2px #300;
      font-weight: bold;
      color: #999;
      -webkit-box-shadow: 1px 1px 3px #000;
    }
label{
    color: #999;
}

leged{
    padding: 5px;
    margin: 5px;
} 
```

the PHP

```
<?php
if(isset($_POST['email'])) {

    // EDIT THE 2 LINES BELOW AS REQUIRED
    $email_to = "webmaster@canyonlakemma.com";
    $email_subject = "Website Error Report";

    function died($error) {
        // your error code can go here
        echo "We are very sorry, but there were error(s) found with the form you submitted. ";
        echo "These errors appear below.<br /><br />";
        echo $error."<br /><br />";
        echo "Please go back and fix these errors.<br /><br />";
        die();
    }

    // validation expected data exists
    if(!isset($_POST['first_name']) ||
        !isset($_POST['email']) ||
        !isset($_POST['description']) ||
        !isset($_POST['browser'])) {
        died('We are sorry, but there appears to be a problem with the form you submitted.');       
    }

    $name = $_POST['name']; // required
    $email_from = $_POST['email']; // required
    $description = $_POST['description']; // required
    $browser = $_POST['browser']; // required

    $error_message = "";
    $email_exp = '/^[A-Za-z0-9._%-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,4}$/';
  if(!preg_match($email_exp,$email_from)) {
    $error_message .= 'The Email Address you entered does not appear to be valid.<br />';
  }
    $string_exp = "/^[A-Za-z .'-]+$/";
  if(!preg_match($string_exp,$name)) {
    $error_message .= 'Be sure to include your name.<br />';
  }
  if(strlen($description) < 2) {
    $error_message .= 'Please include a description of the error.<br />';
  }
  if(strlen($browser) < 2) {
    $error_message .= 'Please select your browser.<br />';
  }
  if(strlen($error_message) > 0) {
    died($error_message);
  }
    $email_message = "Form details below.\n\n";

    function clean_string($string) {
      $bad = array("content-type","bcc:","to:","cc:","href");
      return str_replace($bad,"",$string);
    }

    $email_message .= "Name: ".clean_string($first_name)."\n";
    $email_message .= "Email: ".clean_string($email_from)."\n";
    $email_message .= "Description: ".clean_string($description)."\n";
    $email_message .= "Browser: ".clean_string($broswer)."\n";

// create email headers
$headers = 'From: '.$email_from."\r\n".
'Reply-To: '.$email_from."\r\n" .
'X-Mailer: PHP/' . phpversion();
@mail($email_to, $email_subject, $email_message, $headers);  
?>

<!-- include your own success html here -->

Thank you for contacting us. We will be in touch with you very soon.

<?php
}
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-02T23:46:12.003

`!isset($_POST['description'])`不使用相同的 id`<textarea name="descpirtion"`

描述 ;)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-03T00:45:53.950

上面的答案是正确的，但更具体地说，您在此处的 HTML textarea 表单字段的“名称”值中拼错了“描述”：

```
<p><textarea name="***descpirtion***" placeholder=".... 
```

它需要在这里匹配脚本中的行：

```
$description = $_POST['description']; // required
!isset($_POST['description']) || 
```

昨天我自己做了同样的事情，当它是一个简单的错字时，我花了一个小时或更长时间调试我的 PHP。

# c# - Using MVC3 with folder structure like regular ASP.NET

> ID：10866695
> 
> 赞同：0
> 
> 时间：2012-06-02T23:26:19.427
> 
> 标签：c#, asp.net, asp.net-mvc

So I am reading about building MVC3 projects and there is one thing that seriously bugs me. The folder structure of the project in no way corresponds to the path of the HTTP request. There is a bunch of things I like and would want to use, but having a flat folder structure is not one of them.

Why is this a problem? Well, I see it becoming a problem when building a site with a heavy mix of content pages and various forms/dynamic pages (most of our sites are like that), which would typically be done by different people. It seem it would be too complicated for client-side developers to follow routing rules of dynamic pages and/or creating new ones.

What I would like to understand is if there is way to configure MVC3 application in such a way that:

1.  it follows directory structure for finding controllers without explicit route map for each one
2.  views live in the same folder as corresponding controller
3.  routing magic still works for actions and parameters

For instance I'd like to have a request `/fus/ro/dah/` to try to find `DahController` in the `\webroot\fus\ro\dah\` folder and execute its `Index` action. If not found it would look for `RoController` with `Dah` action in the `\webroot\fus\ro\` folder, etc.

It is entirely possible that MVC was not meant to be working this way at all and I am just trying to force a square peg into a round hole.

**UPDATE:** Looks like I can drop a view file into the desired folder structure, and it will be executed. However layout would not work apparently because it is expecting a controller. Does this mean I have to create a controller for pure content pages? That is a pretty crappy design...

**UPDATE 2:** Main issue right now is that creating "fus" folder means that MVC will not even attempt to look for `FusController`... not under "fus" folder, nor anywhere else. Is it possible to get around that?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-03T03:51:47.677

> 例如，我想要一个请求 /fus/ro/dah/ 尝试在 \webroot\fus\ro\dah\ 文件夹中找到 DahController 并执行其索引操作。如果未找到，它将在 \webroot\fus\ro\ 文件夹等中查找具有 Dah 操作的 RoController。

MVC 不是为这样的特定需求而设计的，它是使用*模型-视图-控制器*模式构建应用程序的通用框架。

**如果你不能为框架弯曲应用程序，你可以为应用程序弯曲框架**，老实说，MVC 是非常可定制的。[作为证明，在我正在工作的当前项目（从 ASP 到 MVC 的迁移）中，我们有 xml 格式的模型并且没有类，我们也使用 XSLT 进行渲染。通过一些工作，我们创建了自定义组件，如自定义视图引擎、自定义验证提供程序、自定义模型绑定器......以使框架最适合应用程序，并且确实如此]

**MVC 不是设计的，也不是强制使用它**，您可以根据需要自定义/扩展。在您的情况下，您可能需要创建一个

*自定义控制器工厂*（因为您要自定义选择控制器的方式），

*自定义视图引擎*（因为您想自定义放置视图的位置）

并且可能是其他人。

对于自定义控制器工厂，您必须扩展`DefaultControllerFactory`类。您可以通过 Google 找到很多关于如何创建自定义控制器工厂的文章。

根据您使用的视图引擎，您必须扩展相应的视图引擎。例如。如果您使用的是 web 表单，那么您必须扩展`WebFormsViewEngine`它，然后剃须刀`RazorViewEngine`。

了解更多信息。检查这个链接

[http://codeclimber.net.nz/archive/2009/04/08/13-asp.net-mvc-extensibility-points-you-have-to-know.aspx](http://codeclimber.net.nz/archive/2009/04/08/13-asp.net-mvc-extensibility-points-you-have-to-know.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-03T01:40:34.340

你可以混合 Asp.net 和 Asp.net MVC。正如 LukLed 所说，MVC 是约定优于配置模式。如果你遵守约定。你不需要配置。您可以查看此链接以将 asp.net 内容与 MVC3 混合

[混合 Asp.net 和 Razor](http://www.hanselman.com/blog/MixingRazorViewsAndWebFormsMasterPagesWithASPNETMVC3.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-03T01:54:10.223

也考虑使用区域。我认为这帮助我诚实地克服了 MVC 的文件夹结构问题。所以我可以使用基本文件夹作为我的主页详细信息，然后我可以有一个“管理”区域，它是一个单独的文件夹，诸如此类。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-03T01:35:01.487

我相信 ASP.NET MVC 不应该以这种方式使用。虽然您可以配置 MVC 来执行此操作，但最好保持标准`/controller/action/parameters`URL 格式。如果您有具有许多不同功能的复杂网站，那么这些区域可能会有所帮助[http://msdn.microsoft.com/en-us/library/ee671793.aspx](http://msdn.microsoft.com/en-us/library/ee671793.aspx)。每个区域都有自己的一组控制器、模型和视图，因此在网站不同部分工作的团队不会互相干扰。

虽然听起来很方便，但该框架首先搜索 DahController 并执行 Index 操作，然后再搜索另一个，我觉得这不是一个好主意。URL 应该明确定义，并且带有 Ro 动作的 Fus 控制器不应该只是停止工作，因为有人创建了带有 Index 动作的 RoController。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-03T04:52:03.200

您希望它有多*“常规 ASP.net”*？如果您想将“传统”ASP.Net Web 表单与 MVC 混合，您当然可以 - re：将 MVC 与“基于文件的 aspx”混合 - 也称为“混合”。归根结底，都是 ASP.Net。

这是由 Visual Studio 生成的标准 MVC 应用程序。我添加了一个文件夹`somedirectory`，我想在其中使用旧`folder/file.ext`范式并拥有一个`default.aspx`Web 表单文件：

![VS 用物理目录搭建 MVC 脚手架](../Images/dfb8474ea79efc16fc2b907a4bc7ce78.png)

*   我可以通过导航到它`http://foo.com/somedirectory`吗？**是**的。
*   我也可以使用“漂亮的网址”吗？**是的**

VS生成的香草`Global.asax`，刚刚添加`MapPageRoute`：

```
....

public static void RegisterRoutes(RouteCollection routes)
{
    routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

    //using "pretty urls" - ordering your routes matter.
    routes.MapPageRoute("theWebForm", "legacy", "~/somedirectory/default.aspx");

    routes.MapRoute(
        "Default", 
        "{controller}/{action}/{id}", 
        new { controller = "Home", action = "Index", id = UrlParameter.Optional }
        );
} 
```

*   所以现在我可以通过`http://foo.com/legacy`

只需检查您的路线顺序，并可能计划您的命名约定，这样您就不会遇到“冲突”......

嗯……

# login - phpMyAdmin 的登录名是什么？

> ID：10866696
> 
> 赞同：15
> 
> 时间：2012-06-02T23:26:21.677
> 
> 标签：login, passwords, phpmyadmin, xampp

我下载了最新版本的 XAMPP (v.1.7.7) 并决定启动一个数据库。当我打开 phpMyAdmin 时，它提醒我有一个新版本的 phpMyAdmin 可用。我从网上下载了它，我删除了旧版本的phpMyAdmin并用当前版本（v.3.5.1）替换它。我打开它，它出现了一个登录屏幕。我在没有密码的情况下输入了“root”，但它提醒我我需要一个。我不知道任何密码，也不知道任何其他登录方式。我将如何登录进入 phpMyAdmin？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-06-02T23:39:00.373

### 启用无密码登录，使其与以前一样工作

您需要更改配置文件。打开您的 XAMPP 安装目录，浏览到该文件夹`phpmyadmin`​​，然后查找一个名为`config.inc.php`. 如果还没有，您首先需要复制`config.sample.inc.php`到`config.inc.php`. 然后，只需打开`config.inc.php`并找到这一行：

```
$cfg['Servers'][$i]['AllowNoPassword'] = false; 
```

将其更改为：

```
$cfg['Servers'][$i]['AllowNoPassword'] = **true**;
```

### 或者，只需添加密码

打开命令提示符并键入以下内容，然后输入`Enter`：

```
mysqladmin -u root -p pass 
```

当它要求您输入当前密码时，只需`Enter`再次按下即可。然后设置新密码，并使用该密码登录 phpMyAdmin。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2016-05-30T09:51:15.387

默认为：

```
Username: root

Password: (just leave it blank) 
```

在某些版本中，密码设置为“密码”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-06-09T07:30:29.920

在新版本中，请注意您必须将代码更改为：

```
mysqli_connect($mysql_hostname, $mysql_username, $mysql_password, $mysql_dbname); 
```

更多看这个：
[致命错误：未捕获的错误：调用未定义的函数mysql_connect（）](https://stackoverflow.com/questions/34579099/fatal-error-uncaught-error-call-to-undefined-function-mysql-connect)

# java - Android ListView - 将意图分配给 Listview 中的字符串

> ID：10866703
> 
> 赞同：0
> 
> 时间：2012-06-02T23:27:31.183
> 
> 标签：java, android, arrays, onclick, android-listview

我有一个足球队名称的 ListView，使用下面的代码将其添加到列表视图中。

```
public final String[] teamnames = { "Arsenal", "Chelsea", "Man United" };

protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    ArrayAdapter<String> adapter = new ArrayAdapter<String>(this,android.R.layout.simple_list_item_1,teamnames);
    setListAdapter(adapter);

} 
```

我需要一些关于 onListItemClick 方法的帮助。

对于列表视图中的每个足球队，我想为其分配一个意图。因此，Arsenal 将开设一个名为 ars.java 的课堂活动。

这需要为 20 个团队完成。

如果我设置了一个类名数组，我如何遍历列表视图并将相应的类名分配给每个团队名？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-03T00:03:05.757

当您设置意图时（在您开始活动之前），您添加了一个额外的内容，如下所示：

```
Intent myIntent = new Intent(ListActivity.this, TeamActivity.class);
myIntent.putExtra("TeamName", teamname);
ListActivity.this.startActivity(myIntent); 
```

然后你在你调用的活动中检索它，如下所示：

```
Bundle extras = getIntent().getExtras();
String team = extras.getString("TeamName"); 
```

这会将您的团队名称放入`team`字符串变量中，供您根据需要使用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-03T00:03:29.653

是的，我也建议使用`intent.putExtra`这是一个示例实现：

```
 public void onListItemClick(ListView l, View v, int position, long id) {
        teamName = teamNames[position]; // Assuming the order is the same
        Intent intent = new Intent().setClass(getActivity(), ShowDetail.class);
        intent.putExtra("team", teamName);
        startActivity(intent);
    } 
```

这`ShowDetail.class`是您要启动的活动，它传递了一个包含团队名称的额外内容。要获得团队的名称`ShowDetail`，您可以致电

```
 String team = getIntent().getStringExtra("team"); 
```

在`onCreate`方法中。

# c# - Mapping Many to Many Relationship w/ Foreign Key Reference

> ID：10866706
> 
> 赞同：6
> 
> 时间：2012-06-02T23:27:50.300
> 
> 标签：c#, .net, sql-server, entity-framework, relational-database

This should be a simple question for the well versed EF user.

I have the following schema (in my head) of how the relationships between the tables should look.

```
[FooBar]      [Foo]          [Bar]

FooId PK,FK   Id PK          Id PK
BarId PK,FK   BarId FK       Name
IsRead        Name           Description
              Description 
```

Though, when I try to *generate* the schema using EF code-first it fails to interpret the relationships between the entities as I've interpreted them (adds foreign key `FooId` to the `[bar]` table) and fails to fully create the `[FooBar]` bridge table.

If someone could guide me on how to achieve the above schema using EF4 code-first I'd appreciate it. Whether the solution involves attributes on my POCO models, fluent configurations or a hybrid of both doesn't matter much - as long as the desired database schema is created.

* * *

**POCO Models:**

```
public class Foo
{
    public int Id { get; set; }
    public string Text { get; set; }
    public string Description { get; set; }
    public int BarId { get; set; }

    public Bar Bar { get; set; } /* bar entity */

    public virtual ICollection<Bar> BridgedBars { get; set; }

    public Foo()
    {
        Bars = new List<Bar>();
    }
}

public class Bar
{
    public int Id { get; set; }
    public string Text { get; set; }
    public string Description { get; set; }

    public virtual ICollection<Foo> Foos { get; set; }
    public virtual ICollection<Foo> BridgedFoos { get; set; }

    public Bar()
    {
        Foos = new List<Foo>();
        BridgedFoos = new List<Foo>();
    }
}

public class FooBar
{
    public int FooId { get; set; }
    public int BarId { get; set; }

    public virtual Foo Foo { get; set; }
    public virtual Bar Bar { get; set; }

    public bool IsRead { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-03T12:06:48.120

您的模型确实会`FooId`在`Bar`属于定义的关系中创建一个外键`Foo.BrideBars`。EF 不会将此导航属性与其中的一个`ICollection<Foo>`属性相关联，`Bar`因为其中有*两个*，并且 EF 无法唯一确定哪个是正确的对。结果，它`Foo.BrideBars`在另一端创建了一个没有导航属性的关系。可以这么说，有一个不可见的`Bar.Foo`属性导致了外键。

您要映射到模型的数据库模式并不真正表示多对多关系，而是与中间“桥”实体的两个一对多关系`FooBar`。您必须在导航属性中使用此类来定义正确的关系。它看起来像这样：

```
public class Foo
{
    public int Id { get; set; }
    public string Text { get; set; }
    public string Description { get; set; }

    public int BarId { get; set; }
    public Bar Bar { get; set; }

    public virtual ICollection<FooBar> FooBars { get; set; }
}

public class Bar
{
    public int Id { get; set; }
    public string Text { get; set; }
    public string Description { get; set; }

    public virtual ICollection<Foo> Foos { get; set; }
    public virtual ICollection<FooBar> FooBars { get; set; }

}

public class FooBar
{
    [Key, Column(Order = 0)]
    public int FooId { get; set; }
    [Key, Column(Order = 1)]
    public int BarId { get; set; }

    public virtual Foo Foo { get; set; }
    public virtual Bar Bar { get; set; }

    public bool IsRead { get; set; }
} 
```

正确的关系将通过此模型中的命名约定来检测。仅对于`FooBar`实体，才需要显式定义键，因为属性名称不符合约定（无`Id`和无`FooBarId`属性）。在这个模型中，使用复合键是有意义的`FooBar`。

我猜，您真正的类和属性没有名称`Foo`and `Bar`。如果您的真实姓名不遵循约定，您可能必须使用注释或 Fluent API 指定关系：

```
modelBuilder.Entity<Foo>()
    .HasRequired(f => f.Bar)
    .WithMany(b => b.Foos)
    .HasForeignKey(f => f.BarId);

modelBuilder.Entity<FooBar>()
    .HasKey(fb => new { fb.FooId, fb.BarId }); // replaces the [Key] annotations

modelBuilder.Entity<FooBar>()
    .HasRequired(fb => fb.Foo)
    .WithMany(f => f.FooBars)
    .HasForeignKey(fb => fb.FooId);

modelBuilder.Entity<FooBar>()
    .HasRequired(fb => fb.Bar)
    .WithMany(b => b.FooBars)
    .HasForeignKey(fb => fb.BarId); 
```

在您的数据库模式中，该`FooBar`表将具有一个复合主键：

```
[FooBar]       [Foo]          [Bar]

FooId PK,FK    Id PK          Id PK
BarId PK,FK    BarId FK       Name
IsRead         Name           Description
               Description 
```

但是有一个 PK`FooBar`是必要的，因为 EF 模型中的每个实体都必须定义一个键属性 - 单个或复合 - 它映射到数据库表中的主键。

在这个问题中——[首先创建代码，多对多，关联表中的附加字段](https://stackoverflow.com/a/7053393/270591)——更详细地说明了如何使用这种类型的关系。*（有时人们也称其为“与有效负载*的多对多关系”（该`IsRead`属性是示例模型中的“有效负载”），但实际上它不是多对多。）

# scala - 使用带有 Scala "for" 语法的 Eithers

> ID：10866710
> 
> 赞同：42
> 
> 时间：2012-06-02T23:28:16.167
> 
> 标签：scala, monads, typeclass, for-comprehension, either

据我了解，Scala 的“for”语法与 Haskell 的一元“do”语法极为相似。在 Scala 中，“for”语法通常用于`List`s 和`Option`s。我想将它与`Either`s 一起使用，但默认导入中不存在必要的方法。

```
for {
  foo <- Right(1)
  bar <- Left("nope")
} yield (foo + bar)

// expected result: Left("nope")
// instead I get "error: value flatMap is not a member..." 
```

是否可以通过某些导入获得此功能？

有一个小问题：

```
for {
  foo <- Right(1)
  if foo > 3
} yield foo
// expected result: Left(???) 
```

对于列表，它将是`List()`. 因为`Option`，它会`None`。Scala 标准库是否为此提供了解决方案？（或者也许`scalaz`？）如何？假设我想为 Either 提供我自己的“monad 实例”，我该怎么做呢？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2012-06-02T23:56:05.940

*它在 scala 2.11 及更早版本*中不起作用，因为`Either`它不是 monad。虽然有人说它是右偏，但你不能在理解中使用它：你必须得到一个`LeftProject`or `RightProjection`，如下所示：

```
for {
  foo <- Right[String,Int](1).right
  bar <- Left[String,Int]("nope").right
} yield (foo + bar) 
```

顺便说一句，返回`Left("nope")`。

在 Scalaz 上，您将替换`Either`为`Validation`. 有趣的事实：`Either`的原作者是 Scalaz 的作者之一 Tony Morris。他想做出`Either`正确的偏见，但被同事说服了。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-06-03T04:43:43.090

> 是否可以通过某些导入获得此功能？

是的，但是通过第三方导入：Scalaz`Monad`为`Either`.

```
import scalaz._, Scalaz._

scala> for {
     |   foo <- 1.right[String]
     |   bar <- "nope".left[Int]
     | } yield (foo.toString + bar)
res39: Either[String,java.lang.String] = Left(nope) 
```

现在`if`-guard 不是一元操作。因此，如果您尝试使用`if`-guard，则会按预期导致编译器错误。

```
scala> for {
     |   foo <- 1.right[String]
     |   if foo > 3
     | } yield foo
<console>:18: error: value withFilter is not a member of Either[String,Int]
                foo <- 1.right[String]
                              ^ 
```

上面使用的便捷方法 -`.right`和`.left`- 也来自 Scalaz。

**编辑：**

我错过了你的这个问题。

> 假设我想为 Either 提供我自己的“monad 实例”，我该怎么做呢？

Scala 推导式`for`被简单地转换为`.map`, `.flatMap`, `.withFilter`, 并调用所涉及的对象。[（您可以在此处](https://stackoverflow.com/a/3754568/192247)找到完整的翻译方案。）因此，如果某些类没有所需的方法，您可以使用隐式转换*将*它们添加到类中。~~`.filter`~~ `.foreach`

 *下面是一个新的 REPL 会话。

```
scala> implicit def eitherW[A, B](e: Either[A, B]) = new {
     |   def map[B1](f: B => B1) = e.right map f
     |   def flatMap[B1](f: B => Either[A, B1]) = e.right flatMap f
     | }
eitherW: [A, B](e: Either[A,B])java.lang.Object{def map[B1](f: B => B1): Product 
with Either[A,B1] with Serializable; def flatMap[B1](f: B => Either[A,B1]):
Either[A,B1]}

scala> for {
     |   foo <- Right(1): Either[String, Int]
     |   bar <- Left("nope") : Either[String, Int]
     | } yield (foo.toString + bar)
res0: Either[String,java.lang.String] = Left(nope) 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2017-06-25T20:17:50.203

从 Scala 2.12 开始，现在`Either`是[正确的](https://github.com/typelevel/cats/issues/1192)

从[文档](http://www.scala-lang.org/api/2.12.0/scala/util/Either.html)中：

> 由于 Either 定义了方法 map 和 flatMap，它也可以用于理解：
> 
> ```
> val right1: Right[Double, Int] = Right(1)
> val right2                     = Right(2)
> val right3                     = Right(3)
> val left23: Left[Double, Int]  = Left(23.0)
> val left42                     = Left(42.0)
> 
> for (
>   a <- right1;
>   b <- right2;
>   c <- right3
> ) yield a + b + c // Right(6)
> 
> for (
>   a <- right1;
>   b <- right2;
>   c <- left23
> ) yield a + b + c // Left(23.0)
> 
> for (
>   a <- right1;
>   b <- left23;
>   c <- right2
> ) yield a + b + c // Left(23.0)
> 
> // It is advisable to provide the type of the “missing” value (especially the right value for `Left`)
> // as otherwise that type might be infered as `Nothing` without context:
> for (
>   a <- left23;
>   b <- right1;
>   c <- left42  // type at this position: Either[Double, Nothing]
> ) yield a + b + c
> //            ^
> // error: ambiguous reference to overloaded definition,
> // both method + in class Int of type (x: Char)Int
> // and  method + in class Int of type (x: Byte)Int
> // match argument types (Nothing) 
> ```*

# objective-c - Getting the world's contactListener in Box2D

> ID：10866715
> 
> 赞同：0
> 
> 时间：2012-06-02T23:29:06.023
> 
> 标签：objective-c, macos, cocos2d-iphone, box2d, objective-c++

I'm writing a game for Mac OS using cocos2D and Box2D. I've added a `b2ContactListener` subclass to my world as follows:

```
contactListener = new ContactListener();
world->SetContactListener(contactListener); 
```

This works perfectly, but I am unsure of the best/accepted way to access the contact listener from other classes that don't currently have a direct reference to the contact listener.

I know I can pass a reference to other classes that need it, but what I was wondering is if there is a better way. More specifically, although I can't find a method to do this, is there some equivalent of this:

```
world->GetContactListener(); 
```

in Box2D?

The reason I am trying to do this is simply because I would prefer to move some game logic (i.e. whether a body is able to jump based on information from the contact listener) to the relevant classes themselves, rather than putting everything in the main gameplay class.

Thanks!

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-05T16:47:28.123

联系侦听器仅作为 BeginContact、EndContact、PreSolve 和 PostSolve 四个函数的入口点。通常它没有成员变量，所以没有理由得到它，因为没有任何东西可以从中得到。

当在世界步骤期间调用其中一个函数时，您可以记下哪两件事触摸/停止触摸等，但您不应该立即更改世界中的任何内容，直到时间步骤完成。

我认为这个问题的症结在于用于“记录”哪些事情被触及的方法，但这真的取决于你，取决于你需要什么样的信息。例如，如果您只对 BeginContact 感兴趣，那么绝对最简单的方法可能是将接触到的两个固定装置存储为对列表：

```
std::vector< std::pair<b2Fixture*, b2Fixture*> > thingsThatTouched;

//in BeginContact
thingsThatTouched.push_back( make_pair(contact->GetFixtureA(), contact->GetFixtureB()) );

//after the time step
for (int i = 0; i < thingsThatTouched.size(); i++) {
    b2Fixture* fixtureA = thingsThatTouched[i].first;
    b2Fixture* fixtureB = thingsThatTouched[i].second;
    // ... do something clever ...
}
thingsThatTouched.clear(); //important!! 
```

为此，您需要使 thingsThatTouched 列表在联系侦听器函数中可见，因此它可以是全局变量，也可以在联系侦听器类中设置指向它的指针，或者可能有一个全局函数返回一个指向列表的指针。

如果您需要跟踪更多信息，例如*停止*触摸的事物，或者在时间步之后根据事物触摸时的影响程度等做某事，则需要更多的工作并且变得更加具体。您可能会发现这些教程很有用：

这个使用 BeginContact/EndContact 更新身体正在触摸的其他东西的列表，并使用它来决定玩家是否可以在任何给定时间跳跃： [http ://www.iforce2d.net/b2dtut/jumpability](http://www.iforce2d.net/b2dtut/jumpability)

这个使用类似的方法来查看当前汽车轮胎下方的表面类型，以确定表面的摩擦力： [http ://www.iforce2d.net/b2dtut/top-down-car](http://www.iforce2d.net/b2dtut/top-down-car)

这个使用 PreSolve 根据撞击的速度来决定两个物体（箭头和目标）在碰撞时是否应该粘在一起。实际的“粘在一起”处理是在时间步完成后完成的： [http ://www.iforce2d.net/b2dtut/sticky-projectiles](http://www.iforce2d.net/b2dtut/sticky-projectiles)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-03T09:35:04.837

`GetContactList`如果您需要在其他地方进行操作，我认为您只需调用并使用迭代器处理所有联系人

# perl - Perl index function to extract a certain substring

> ID：10866716
> 
> 赞同：0
> 
> 时间：2012-06-02T23:29:22.047
> 
> 标签：perl

Given a certain sequence A stored in an array, I have to find if a larger sequence B contains sequence A.

I am stuck at the index part... and i'm getting an error that argument *"TGACCA"* isn't numeric in array element in line *69* which is:

`if (index($record_r1[1], $r2_seq[$check]) != -1)`

* * *

The code is:

```
foreach my $check (@r2_seq)
{
  if (index($record_r1[1], $r2_seq[$check]) != -1)
  {
     $matches= $matches + 1;
     print "Matched";
  }
  else
  {
  }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-02T23:39:04.070

```
foreach my $check (@r2_seq) 
```

`$check`取 中每个元素的值`@r2_seq`。它不是索引。

```
$r2_seq[$check] 
```

这是尝试将 的元素`@r2_seq`用作 的索引`@r2_seq`。这不太可能是您想要的。更有可能，您想使用

```
$check 
```

如在

```
if (index($record_r1[1], $check) != -1) 
```

.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-02T23:49:04.277

我相信您想`$check`成为**index**，因此请使用以下代码：

```
foreach my $index (0..$#r2_seq)
{
  if (index($record_r1[1], $r2_seq[$index]) != -1)
  {
     $matches= $matches + 1;
     print "Matched";
  }
  else
  {
  }
} 
```

# c# - 使用固定关键字固定一个长度为零的数组

> ID：10866721
> 
> 赞同：1
> 
> 时间：2012-06-02T23:30:02.210
> 
> 标签：c#, unsafe

我有一些`unsafe`C# 代码无法更改，并且公开了如下方法：

```
static unsafe void Foo(
    byte* a, int aLength,
    byte* b, int bLength,
    byte* c, int cLength,
    byte* d, int dLength,
    byte* e, int eLength); 
```

我这样称呼这些方法：

```
static void Bar(
    byte[] a, int aOffset, int aLength,
    byte[] b, int bOffset, int bLength,
    byte[] c, int cOffset, int cLength,
    byte[] d, int dOffset, int dLength,
    byte[] e, int eOffset, int eLength)
{
    fixed (byte* a_ = &a[aOffset])
    fixed (byte* b_ = &b[bOffset])
    fixed (byte* c_ = &c[cOffset])
    fixed (byte* d_ = &d[dOffset])
    fixed (byte* e_ = &e[eOffset])
    {
        Foo(a_, aLength,
            b_, bLength,
            c_, cLength,
            d_, dLength,
            e_, eLength);
    }
} 
```

（为简洁起见，省略了参数验证。）

除非其中一个字节数组的长度为零，否则这很有效。在这种情况下，我得到一个 IndexOutOfRangeException。

> 指数数组的边界之外。

如何防止异常，最好不要编写大量样板代码，也不要切换`fixed`到其他东西？

不安全的方法不会读取或写入长度为零的参数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-02T23:36:35.187

您无法访问空数组中的任何元素，因此将任何空数组替换为包含您可以访问的元素的虚拟数组：

```
if (aLength == 0) a = new int[1];
if (bLength == 0) b = new int[1];
if (cLength == 0) c = new int[1];
if (dLength == 0) d = new int[1];
if (eLength == 0) e = new int[1]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-02T23:38:20.380

是

```
static void Bar( ... )
{
  byte[] dummy = new byte[1];
  fixed (byte* a_ = a.Lenght>0 ? &a[aOffset] : &dummy[0])
  ...
} 
```

太笨重？

**编辑：**

仅出于历史原因保留上述内容，`?`操作员将无法工作。

所以你需要在没有`fixed`关键字的情况下做一些类似的事情

```
public unsafe struct UnsafePointerStruct
{
    public GCHandle gch;
    public byte* addr;
}

static unsafe UnsafePointerStruct GetUnsafePointer(Array a, int ai)
{
    UnsafePointerStruct ups=new UnsafePointerStruct();
    ups.gch=GCHandle.Alloc(a,GCHandleType.Pinned);
    if (a.Length<=ai) ups.addr=(byte*)IntPtr.Zero;
    ups.addr=(byte*)Marshal.UnsafeAddrOfPinnedArrayElement(a,ai);
    return ups;
}

static unsafe void Bar(
    byte[] a, int aOffset, int aLength,
    byte[] b, int bOffset, int bLength,
    byte[] c, int cOffset, int cLength,
    byte[] d, int dOffset, int dLength,
    byte[] e, int eOffset, int eLength)
{
    UnsafePointerStruct upsa=GetUnsafePointer(a,aOffset);
    UnsafePointerStruct upsb=GetUnsafePointer(b,bOffset);
    UnsafePointerStruct upsc=GetUnsafePointer(c,cOffset);
    UnsafePointerStruct upsd=GetUnsafePointer(d,dOffset);
    UnsafePointerStruct upse=GetUnsafePointer(e,eOffset);

    Foo(upsa.addr, aLength,
        upsb.addr, bLength,
        upsc.addr, cLength,
        upsd.addr, dLength,
        upse.addr, eLength);

    upsa.gch.Free();
    upsb.gch.Free();
    upsc.gch.Free();
    upsd.gch.Free();
    upse.gch.Free();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-02T23:41:50.667

由于它不会读取或写入长度为零的数组，因此您可以更改

```
fixed (byte* a_ = &a[aOffset])
fixed (byte* b_ = &b[bOffset])
fixed (byte* c_ = &c[cOffset])
fixed (byte* d_ = &d[dOffset])
fixed (byte* e_ = &e[eOffset]) 
```

至

```
fixed (byte* a_ = (a.Length == 0 ? (byte*)IntPtr.Zero : &a[aOffset]))
fixed (byte* b_ = (b.Length == 0 ? (byte*)IntPtr.Zero : &b[aOffset]))
fixed (byte* c_ = (c.Length == 0 ? (byte*)IntPtr.Zero : &c[aOffset]))
fixed (byte* d_ = (d.Length == 0 ? (byte*)IntPtr.Zero : &d[aOffset]))
fixed (byte* e_ = (e.Length == 0 ? (byte*)IntPtr.Zero : &e[aOffset])) 
```

但是，如果您这样做然后尝试读取或写入其中一个空数组，您将得到一个空指针异常。

# javascript - 如何实现 Node.js 广播到多个客户端

> ID：10866725
> 
> 赞同：1
> 
> 时间：2012-06-02T23:30:52.167
> 
> 标签：javascript, node.js

我正在构建一个 node.js 应用程序。当用户连接时，他们将其状态传输为在线。当他们断开连接时，状态将切换为离线。此外，当用户连接时，他会获得他的连接列表，以及这些朋友的状态（在线或离线）。好的，很好，这个没问题。

但是我遇到的麻烦是如何在我登录时动态发送用户朋友的状态。所以，步骤如下：

1.  我登录。
2.  我得到了我所有朋友的列表：user1、user2、user3
3.  我得到所有用户的状态列表： user1:online, user2:online user3:offline
4.  用户 1 注销
5.  如何动态获取用户 1 的状态变化？

请记住，这些用户没有相互连接，并且还请记住，用户的状态需要传输给所有以他为朋友的其他用户。假设 user1 有 100 个朋友，我就是其中之一。我（连同其他 99 人）需要收到 user1 现在离线的通知。另请注意，这些人可能不在同一台物理服务器上（多台服务器分别处理 X 个连接）。解决这个问题的最佳理论方法是什么？

我能想出的唯一答案是我将状态保存在数据库中，该节点将查询数据库，当状态发生变化时，它会更新。但是节点必须监视无法扩展的数据库更改似乎很疯狂。必须有更好的方法来做到这一点 - 也许它是一个显而易见的方法，我错过了它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-03T01:02:07.377

正如 ebohlman 在评论中所暗示的那样，发布/订阅模式（也称为“发布/订阅”）听起来适用于您的问题。在发布/订阅体系结构中，发布者不是向特定客户端发送消息，而是发布者向某个中央发布/订阅服务器发送消息。订阅者将他们感兴趣的消息类型或“主题”通知此服务器。关键是发布者和订阅者从不知道，甚至不关心彼此，这使得该模式非常可扩展（可以有任意数量的发布者或订阅者）。

![发布/订阅模式](../Images/6973cb8fa22194121d54b7c04729b705.png)

在您的情况下，处理用户登录/注销的每个服务器都可能订阅“login_changed”主题。每当用户登录或注销时，处理更改的服务器都会向发布/订阅服务器发送一条主题为“login_changed”的消息以及一些指示发生在谁身上的数据（例如，使用 JSON 编码的字符串）。每个订阅了“login_changed”主题的服务器都将收到该消息，并且它们可以各自确定它们是否负责跟踪相关用户。

有几种常用工具可用于管理 pub/sub 模式。[Redis](http://redis.io/)是一种常见的键值存储，[支持 pub/sub](http://redis.io/topics/pubsub)，是我个人最喜欢的任务工具。[AMQP](http://en.wikipedia.org/wiki/Advanced_Message_Queuing_Protocol)是一个开放标准，包含了多种与消息相关的行为，包括 pub/sub，并且有[很多实现](http://en.wikipedia.org/wiki/Advanced_Message_Queuing_Protocol#Implementations)，其中最常见的可能是[RabbitMQ](http://www.rabbitmq.com/)。如果您对通过 HTTP 连接 Web 客户端感兴趣，您可能会对[Faye](http://faye.jcoglan.com/)之类的东西感兴趣。有很多关于这个主题的文献，以及许多语言的许多实现；谷歌搜索应该带你走得很远。

# php - PHP Mail() 失败并显示“用户 ", 很好" "

> ID：10866729
> 
> 赞同：0
> 
> 时间：2012-06-02T23:31:22.287
> 
> 标签：php, email, rfc2822

问题始于 Magento 不发送邮件，而在调试时我遇到了这个问题：

使用 PHP 邮件功能时，如果 $to 包含名称则失败。

```
<?php
 $to = '<myname@gmail.com>'; //Works fine
 $to = 'myname@gmail.com'; //Works fine

 $to = 'Myname <myname@gmail.com>'; // This doesn't work! No mail and getting "delivery failed";

 $subject = "Test";
 $body = "How are you?";

 if (mail($to, $subject, $body)) {
   echo("Message successfully sent!");
 } else {
  echo("Message delivery failed...");
 }
?> 
```

这是一个托管帐户，因此我无权访问 sendmail 或任何其他配置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-03T00:19:54.230

尚未找到此特定问题的解决方案，但找到了 Magento 插件，该插件使用 SMTP/Google Mail/Apps 。工作正常，发邮件。

[http://www.magentocommerce.com/magento-connect/aschroder-com-smtp-pro-email-free-and-easy-magento-email-for-smtp-gmail-or-google-apps-email.html](http://www.magentocommerce.com/magento-connect/aschroder-com-smtp-pro-email-free-and-easy-magento-emailing-for-smtp-gmail-or-google-apps-email.html)

# c# - 更新 Direct3D 网格顶点缓冲区的最快方法？

> ID：10866732
> 
> 赞同：0
> 
> 时间：2012-06-02T23:31:46.227
> 
> 标签：c#, .net, directx, direct3d, mesh

我有一个地形网格，每帧只需要更新每个顶点的 Z 值。我当前的方法如下所示：

```
int stepping = CustomVertex.PositionNormalTextured.StrideSize / 4;

//ZPtr points to the Z value of the first PositionNormalTextured in the mesh.  
//This way we don't have to dereference ->Z for each vertex.
float* ZPtr = &(((CustomVertex.PositionNormalTextured*)
    TerrainMesh.LockVertexBuffer(LockFlags.NoOverwrite).InternalDataPointer)->Z);

float* DPtr = TerrainHeight; //point to begin scanning result
float* EndPtr = DPtr + TerrainMesh.NumberVertices; //point to stop scanning result

do { *ZPtr = *DPtr; ZPtr += stepping; } while (++DPtr < EndPtr); //copy data
TerrainMesh.UnlockVertexBuffer(); //unlock 
```

这里，TerrainHeight 是一个使用 Marshal.AllocHGlobal 创建的浮点数组，表示地形高度。基本上，它扫描整个 TerrainHeight 数组并将每个值复制到网格中相应 PositionNormalTextured 的 Z 值。我使用 LockFlags.NoOverwrite 来避免创建数组的新副本，尽管这似乎并不比 LockFlags.Discard 快。

更新网格所需的时间与在 CPU 中计算新地形所需的时间一样长或更长，这让我相信应该有更快的方法。我一直无法在 Google 上找到有关此的信息。有没有更好的方法来更新顶点缓冲区？如果重要的话，网格的大小是用户设置的，可能包括超过一百万个顶点（这是通过多个网格完成的），但默认设置是 32k 顶点，这是单个 D3D 网格的最大值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-23T00:43:34.463

看来您不了解`Discard`和`NoOverwrite`标志的后果。阅读DirectX SDK 帮助中**性能优化**下的*使用动态顶点和索引缓冲区部分。*假设您使用的是动态顶点缓冲区，则意味着“我正在替换整个缓冲区”并且意味着“我正在写入缓冲区的未使用部分，并且我保证不会更改我已经使用的任何部分”。**`Discard``NoOverwrite`**

 **使用任一标志，您都必须编写地形顶点的每个组件，即使是在新框架中未更改的组件。

如果您不使用动态顶点缓冲区，那么当您尝试锁定下一帧的顶点缓冲区时，如果您的 GPU 仍在使用它，您可能会遇到停顿。在这种情况下，您将需要使用多个顶点缓冲区，并在地形高度发生变化的每一帧中使用不同的缓冲区进行锁定、更新、解锁和渲染。您还必须使用所有地形顶点数据初始化所有这些缓冲区。

我建议将网格的 z 值分离到它们自己的顶点缓冲区中——假设你没有更新 x 和 y 的位置、你的法线（如果 z 改变可能不正确）或你的纹理坐标。这样你就可以使用你的`PositionNormalTextured`（没有位置 z 的）顶点缓冲区，每帧都保持不变，并从头开始使用`Discard`标志填充你的动态 z 位置缓冲区，而不需要跨到每个 Z 值。由于步幅消失了，您可以使用平面内存副本来做到这一点。

您将为顶点着色器提供 z 位置值`SetStreamSource( 1, ZPositionVB, ... )`。您需要调整顶点声明以从流 1 中读取 z 位置值，并调整顶点着色器以在转换之前组合 z 位置值。

如果其中一些不适合 C#，我们深表歉意。**

# python - Python 检查 __init__ 参数

> ID：10866738
> 
> 赞同：5
> 
> 时间：2012-06-02T23:33:01.420
> 
> 标签：python, class, parameters, init

在过去的几个小时里，我一直在努力解决这个问题，我即将放弃。

您如何确保在 python 中只有匹配的特定条件才能创建对象？

例如，假设我想创建一个对象 Hand，并且只有在初始化程序中有足够的 Fingers 时才初始化 Hand？（请仅以此作为类比）

说，

```
class Hand:
  def __init__(self, fingers):
    # make sure len(fingers)==5, and 
    #only thumb, index, middle, ring, pinky are allowed in fingers
    pass 
```

谢谢。

这些是我发现的最接近的问题，但一个是 C++，另一个没有回答我的问题。

[检查构造函数参数](https://stackoverflow.com/questions/7361077/checking-of-constructor-parameter)

[如何根据参数类型重载 __init__ 方法？](https://stackoverflow.com/questions/141545/overloading-init-in-python)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-02T23:38:11.947

您必须为此定义`__new__`：

```
class Foo(object):
    def __new__(cls, arg):
        if arg > 10: #error!
            return None 
        return super(Foo, cls).__new__(cls)

print Foo(1)    # <__main__.Foo object at 0x10c903410>
print Foo(100)  # None 
```

也就是说，`__init__`在无效参数上使用和引发异常通常要好得多：

```
class Foo(object):
    def __init__(self, arg):
        if arg > 10: #error!
            raise ValueError("invalid argument!") 
        # do stuff 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-02T23:37:39.653

尝试断言：

```
class Hand(object):
    def __init__(self,fingers):
        assert len(fingers) == 5
        for fing in ("thumb","index","middle","ring","pinky"):
            assert fingers.has_key(fing) 
```

# javascript - 使用 RequireJS 2.0.1 和 shim 加载 jQuery、Underscore 和 Backbone

> ID：10866740
> 
> 赞同：31
> 
> 时间：2012-06-02T23:33:21.077
> 
> 标签：javascript, requirejs, shim

我正在对 RequireJS ***2.0.1***进行一些试验。我的目标是正确加载 jQuery、Underscore 和 Backbone。从最初的[RequireJS 文档](http://requirejs.org/)中，我发现作者 J. Burke（在这个新版本中）添加了一个[名为 shim 的新配置选项](https://github.com/jrburke/requirejs/wiki/Upgrading-to-RequireJS-2.0#wiki-shim)。

然后我把这些东西写在这里：

`index.html`

```
<!DOCTYPE html>
<html>
    <head>
        <title>Testing time</title>
        <script data-main="scripts/main" src="scripts/require.js"></script>
    </head>
    <body>
        <h1>Testing time</h1>
    </body>
</html> 
```

`scripts/main.js`

```
requirejs.config({
    shim: {
        'libs/jquery': {
            exports: '$'
        },
        'libs/underscore': {
            exports: '_'
        },
        'libs/backbone': {
            deps: ['libs/underscore', 'libs/jquery'],
            exports: 'Backbone'
        }
    }
});

define(
    ['libs/jquery', 'libs/underscore', 'libs/backbone'],

    function (jQueryLocal, underscoreLocal, backboneLocal) {
        console.log('local', jQueryLocal);
        console.log('local', underscoreLocal);
        console.log('local', backboneLocal);
        console.log('global', $);
        console.log('global', _);
        console.log('global', Backbone);
    }
); 
```

一切似乎都很好，但我觉得我错过了一些东西，我知道有AMD 版本的 jQuery 和*Underscore*但如果设置如此简单，我不明白为什么我应该使用它们。

那么，这个设置是正确的还是我错过了什么？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-06-03T22:54:41.537

如果库尚未调用`define()`声明模块，则只需要使用“shim”配置。jQuery 已经这样做了，因此您可以从 shim 配置中删除它。上面的代码将按原样工作，但 jQuery 的导出 shim 配置将被忽略，因为 jQuery 将`define()`在 shim 工作完成之前调用。

shim 与使用脚本调用`define()`来定义模块的缺点：

1.  它的可移植性/可靠性较差：每个开发人员都需要进行 shim 配置，并跟踪库更改。如果库作者在库中内联，每个人都能更有效地获得收益。[umdjs/umd](https://github.com/umdjs/umd)中的代码模板可以帮助进行代码更改。

2.  不太理想的代码加载：shim 配置通过在加载实际库之前加载 shim deps 来工作。所以它比并行加载更多。如果所有脚本都可以并行加载会更快，这在`define()`使用时是可能的。如果您为最终部署进行构建/优化并将所有脚本组合到一个脚本中，那么这并不是真正的缺点。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-03T23:18:12.903

您所做的是正确的，但 jQuery 不需要在 shim 配置中，因为它导出了一个[AMD](https://github.com/amdjs/amdjs-api/wiki/AMD)（异步模块定义）模块。Underscore 在添加后迅速删除了对 AMD / Require.js 的支持，请参阅：[为什么 underscore.js 删除了对 AMD 的支持](https://stackoverflow.com/questions/9009510/why-underscore-js-removed-support-for-amd)

Shim 旨在方便使用不导出 AMD 模块的库。如果您使用的库确实支持 AMD，或者有 2 个版本（一个支持 AMD，一个是全局变量），您应该使用 AMD 版本。您应该使用 AMD 版本的原因与您首先使用 AMD 的原因相同，而且该库可能在​​其源代码中包含 require.js （或[Almond](https://github.com/jrburke/almond)），并且会为您的项目添加不必要的文件大小。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-02T00:03:23.310

你真的可以避免在原始示例中“填充”jquery（jquery 的路径设置为“libs/jquery”），因为 jquery 在其 amd 模块定义中添加了名称“jquery”吗？

定义（“ **jquery** ”，[]，函数（）{返回jQuery；}）；

我的经验是，您需要将 jquery.js 放在 baseurl 目录中以获取按预期定义的 jquery amd 模块，或者像原始示例中那样“填充”它。

# c++ - 如何计算图像像素

> ID：10866741
> 
> 赞同：-3
> 
> 时间：2012-06-02T23:33:33.790
> 
> 标签：c++, image, image-processing, opencv

我想知道如何应用这个“水平位置，从图像的左边缘计算像素，最小矩形框的中心，可以在框内绘制所有“开”像素。” 请注意，框==图像

使用opencv代码

任何帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-03T15:14:39.070

我不确定我是否理解正确，但这是我对图像中像素进行计数的建议。

我在下面使用的 Mat 图像是灰度图像，如果要计算 3 通道 RGB 图像上的像素，则需要拆分其通道并单独处理。

```
Mat image= imread( "C:\\1.jpg" );// load your image by giving the path here.
Mat grayscale_image;

cvtColor(image,grayscale_image,CV_RGB2GRAY);/* this converts "image" to 
"grayscale_image" which is a one channel image.*/

//Now you can play with its pixels

 int sumPixels=0;

                     for(int i=0; i<image.rows; i++)
                     {
                         for(int j=0;j<image.cols;j++)

                                sumPixels+=image.at<uchar>(i,j);                            

                     }

/* value of a pixel on a gray scale image(if it is a 8 bit image) varies between 
   0 and 255\. "sumPixels" variable will contain the total pixel values of image.*/ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-03T16:22:39.377

此代码尝试通过对每一列的所有白色像素求和来找到每一行的白色像素。

```
 int sum_of_x = 0;
    for(int i = 0; i < height; i++)
    {
        for(int j = 0; j < width; j++)
        { 
            if(data[i*step + j]==255)
                sum_of_x = sum_of_x + 1;
        }
        cout<<"Row No #"<<i<<", White Pixel at each ROW = "<<sum_of_x<<endl;
    } 
```

干杯。

# crystal-reports - 水晶报表 - 显示最后一页

> ID：10866743
> 
> 赞同：0
> 
> 时间：2012-06-02T23:34:14.103
> 
> 标签：crystal-reports, report

我的应用程序中有一个水晶报告。我的报告有大约 100 页。从我的应用程序中打开报告后，我需要立即查看最后一页。

所以我正在使用`crystalreportviewer.showlastpage`.

我的报告在顶部显示第 100 页，但它显示第 1 页，共 100 页。如果我在除 100 之外的顶部框上按 Enter 键，它会显示第 100 页，共 100 页。请帮助我解决此问题。

我需要直接查看第 100 页，共 100 页。

我不应该使用顶部的最后一页按钮作为我的要求的一部分

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-02T23:55:46.963

表单加载时是否调用 showlastpage 方法？如果从按钮（在 Crystalreportviewer 控件之外）调用它是否有效？如果是这样，您可能需要延迟调用该方法，直到加载表单之后（尝试线程或计时器）。

# google-app-engine - Restlet AppEngine 和杰克逊的 NoClassDefFoundError

> ID：10866744
> 
> 赞同：1
> 
> 时间：2012-06-02T23:34:26.630
> 
> 标签：google-app-engine, restlet

我使用带有 Google App Engine 和 GWT 的 Restlet 得到 NoClassDefFoundError。

我正在尝试获取我的对象的 Json 表示。我得到的错误是：

```
java.lang.NoClassDefFoundError: org/codehaus/jackson/JsonGenerator$Feature 
```

我得到错误的方法的基本框架是：

```
@Get("json")
public Representation getProduct() {

    Product product = new Product("whatever");

    return new JacksonRepresentation<Product>(MediaType.APPLICATION_JSON, product);
} 
```

`JsonFactory`最初，当仅使用 Restlet 提供的 JAR 时，我得到了一个类错误。然后我下载了“jackson-all-1.9.7.jar”。此后，该错误已被此新错误所取代。

知道发生了什么吗？也许我错过了一些图书馆，但我可以弄清楚哪些图书馆。

**编辑：**包括堆栈跟踪。我删除了所有库，然后运行了 Restlet `org.restlet.ext.jackson`JAR。此外，为了检查该类在编译时是否可用，如下面的答案所暗示的那样，我尝试在 Eclipse 中检查类和包的自动完成功能，但它没有显示任何内容。我假设这意味着它在编译时也不可用。

```
java.lang.NoClassDefFoundError: org/codehaus/jackson/JsonFactory
at org.restlet.ext.jackson.JacksonRepresentation.createObjectMapper(JacksonRepresentation.java:118)
at org.restlet.ext.jackson.JacksonRepresentation.getObjectMapper(JacksonRepresentation.java:164)
at org.restlet.ext.jackson.JacksonRepresentation.write(JacksonRepresentation.java:205)
at org.restlet.representation.WriterRepresentation.write(WriterRepresentation.java:104)
at org.restlet.engine.http.ServerCall.writeResponseBody(ServerCall.java:550)
at org.restlet.engine.http.ServerCall.sendResponse(ServerCall.java:488)
at org.restlet.ext.servlet.internal.ServletCall.sendResponse(ServletCall.java:492)
at org.restlet.engine.http.adapter.ServerAdapter.commit(ServerAdapter.java:197)
at org.restlet.engine.http.HttpServerHelper.handle(HttpServerHelper.java:151)
at org.restlet.ext.servlet.ServerServlet.service(ServerServlet.java:1028)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:511)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1166)
at com.google.appengine.tools.development.HeaderVerificationFilter.doFilter(HeaderVerificationFilter.java:35)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
at com.google.appengine.api.blobstore.dev.ServeBlobFilter.doFilter(ServeBlobFilter.java:60)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
at com.google.apphosting.utils.servlet.TransactionCleanupFilter.doFilter(TransactionCleanupFilter.java:43)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
at com.google.appengine.tools.development.StaticFileFilter.doFilter(StaticFileFilter.java:122)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
at com.google.appengine.tools.development.BackendServersFilter.doFilter(BackendServersFilter.java:97)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:388)
at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)
at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:182)
at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:765)
at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:418)
at com.google.appengine.tools.development.DevAppEngineWebAppContext.handle(DevAppEngineWebAppContext.java:78)
at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
at com.google.appengine.tools.development.JettyContainerService$ApiProxyHandler.handle(JettyContainerService.java:369)
at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
at org.mortbay.jetty.Server.handle(Server.java:326)
at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:542)
at org.mortbay.jetty.HttpConnection$RequestHandler.headerComplete(HttpConnection.java:923)
at org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:547)
at org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:212)
at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:404)
at org.mortbay.io.nio.SelectChannelEndPoint.run(SelectChannelEndPoint.java:409)
at org.mortbay.thread.QueuedThreadPool$PoolThread.run(QueuedThreadPool.java:582)
Caused by: java.lang.ClassNotFoundException: org.codehaus.jackson.JsonFactory
at java.net.URLClassLoader$1.run(Unknown Source)
at java.security.AccessController.doPrivileged(Native Method)
at java.net.URLClassLoader.findClass(Unknown Source)
at java.lang.ClassLoader.loadClass(Unknown Source)
at com.google.appengine.tools.development.IsolatedAppClassLoader.loadClass(IsolatedAppClassLoader.java:176)
at java.lang.ClassLoader.loadClass(Unknown Source)
... 40 more 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-04T16:18:46.937

此外，如果您查看您下载的 Restlet 版本的 lib 目录，您会看到一个 readme.txt，它会告诉您在使用各种 Restlet Extensions 时需要包含的一些 jar。例如，readme.txt 应该有如下内容：

## org.restlet.ext.jackson（Restlet 扩展 - 杰克逊）

*   org.codehaus.jackson.core_1.9
*   org.codehaus.jackson.mapper_1.9

因此，如果您将 Jackson 与 Restlet (org.restlet.ext.jackson.jar) 一起使用，您还需要包括下面列出的另外两个 jar。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-03T05:46:34.190

这与这里的问题类似：[Objectify NoClassDefFoundError](https://stackoverflow.com/questions/10759366/objectify-noclassdeffounderror/10763093#10763093)

您需要将 jar 文件放在 WEB-INF/lib/ 下，并确保在构建路径中包含该库。对于线索，NoClassDefFound 意味着该库在编译时可用，但在运行时不可用

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-03T13:53:55.783

我更新到 Restlet 2.0.14 并使用了它提供的 org.codehaus.jackson 库而不是网站上的库。

这似乎解决了问题，尽管我不知道这两个动作中的哪一个实际上做到了这一点。

# javascript - 如何从 HTML 5 画布动画链接

> ID：10866745
> 
> 赞同：1
> 
> 时间：2012-06-02T23:34:33.440
> 
> 标签：javascript, html, html5-canvas

我正在尝试从 HTML 5 画布动画创建链接。如何使画布中的特定图像也成为链接？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-02T23:53:11.637

Canvas 标记没有链接功能，但是您可以使用 javascript 编码手动链接到新页面。只需添加一个触发链接的 onclick 事件。

此外，画布不会知道您的图像在哪里。因此，如果图像仅占据画布的一部分，则需要检查鼠标位置以确保直接单击图像。

# r - 在 R 中创建与以下相关的新变量

> ID：10866747
> 
> 赞同：1
> 
> 时间：2012-06-02T23:34:57.060
> 
> 标签：r

我在导入到 R 的 excel 电子表格中有 7 个不同的变量。它们都是大小为 3331 的列。它们是：

```
'Tribe' - there are 8 of them
'Month' - when the sampling was carried out
'Year' - the year when the sampling was carried out
'ID" - an identifier for each snail
'Weight' - weight of a snail in grams
'Length' - length of a snail shell in millimetres
'Width' - width of a snail shell in millimetres 
```

这是一个案例，要求 8 个不同的部落记录疑似濒临灭绝的蜗牛物种的数据，以查看它们是否变得越来越稀有，或者大小或重量是否发生变化。这发生在 1993 年至 1998 年间的不同频率。

我想知道如何能够为数据创建一个新变量，以便如果我输入名称（蜗牛）# 那么它会列出 7 个给定变量以及我拥有的任何添加的变量。

数据集仅限于我想添加新变量的地方。例如，了解任何给定月份中每月的蜗牛数量。

这将取决于我使用 - 部落、月份、年份和 ID。如果根据任何给定月份的费率列出了 ID（蜗牛标识符），那么我将能够将它们相加以查看计数是否有任何变化。我努力了：

```
count=c(Tribe,Year,Month,ID)
count 
```

但是，在做完这样的事情之后，R 只是有一个大列表，其大小是数据集大小的 4 倍。我希望能够创建一个列大小为 n=3331 的给定新变量。

或者，也许我想创建一个更简单的变量，以便查看某个部落是否在任何给定月份收集。我不知道我该怎么做。

我查看了其他论坛并进行了搜索，但是在我的情况下，我看不到任何对我有帮助的东西。我很感激任何帮助。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-03T01:07:33.353

我猜您需要将变量组织在一个结构中，例如`data.frame`. 请参阅`?data.frame`帮助文件。

为了让您开始，您可以执行以下操作：

```
snails <- data.frame(Tribe,Year,Month,ID)
snails
# or for just the first few rows
head(snails) 
```

然后这将使您的数据看起来类似于您的 Excel 文件，例如：

```
 Tribe Year Month ID
1      1    1     1  a
2      2    2     2  b
3      3    3     3  c
<<etc>> 
```

然后，如果您这样做`names(snails)`，它将列出您的列名。

您可以通过直接从 Excel 导入您的 Excel 文件或先保存为`csv`（逗号分隔值）文件然后使用`read.csv("name_of_your_file.csv")` 参见[http://www.statmethods.net/input/importingdata.html](http://www.statmethods.net/input/importingdata.html)有关此的更多细节。

要将数据制成表格，您可以执行以下操作...

```
table(snails$Tribe) 
```

...查看每个部落收集的蜗牛记录的数量。或者...

```
table(snails$Tribe,snails$Year) 
```

...查看每个部落每年的趋势。该`$`字符将允许您以与当前使用自由浮动变量相同的方式访问 data.frame 中的命名变量（列）。最初这似乎需要更多的工作，但当您需要进行一些更复杂的分析时，它会带来很大的回报。

举个例子，如果你只想分析部落“1”的权重，你可以这样做：

```
snails$Weight[snails$Tribe==1]
# mean of these weights
mean(snails$Weight[snails$Tribe==1]) 
```

我可以解释更多的事情，但你可能会更好地阅读一个像 Quick-R 这样的优秀网站：http: [//www.statmethods.net/management/index.html](http://www.statmethods.net/management/index.html)让你做一些更高级的分析和绘图。

# php - PHP $_POST 来自动态生成的表单

> ID：10866751
> 
> 赞同：0
> 
> 时间：2012-06-02T23:35:26.597
> 
> 标签：php, arrays, forms, post, multidimensional-array

我正在根据用户选择的 $node_number 创建一个表单......所以表单看起来像：

```
function createForm($node_number) {
            echo "<form id=\"form\" name=\"form\" action=\"molecule_display.php\" method=\"post\">";
           for ($n = 1; $n <= $node_number; $n++) {
                echo "<fieldset class=\"step\">
                            <input id=\"node_title" . $n . "\" name=\"node_title" . $n . "\" />
                            <input id=\"node_comment" . $n . "\" name=\"node_comment" . $n . "\" type=\"textarea\"  />
                     </fieldset>";
                            }
            echo "<input type=\"hidden\" name=\"node_number\" value=\"" . $node_number . "\">
                    <button id=\"submit_node\" type=\"submit\">Submit</button>"
            echo "</form>";
            } 
```

这将创建该表单元素的 $node_number 个版本。我的问题是如何动态命名表单元素，以便在处理它们时更容易管理它们。我现在这样做的方式，通过将 $n 迭代器添加到 name 属性，我认为并不理想。

我知道我可以将 name="" 属性声明为像 name[]="" ... 这样的数组，以便为​​较大形式的每个子元素提供一个唯一的名称。

我猜我想要一个单独的表单段的多维数组......只是不确定如何最好地处理表单和 $_POST 变量中的那些。

有没有人有什么建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-02T23:46:05.260

我认为你可以这样做：

```
function createForm($node_number) {
    echo '<form id="form" name="form" action="molecule_display.php" method="post">';
    for ($n = 1; $n <= $node_number; $n++) {
        echo '<fieldset class="step">
        <input id="node_title'.$n.'" name="nodes['.$n.'][node_title]" />
        <input id="node_comment'.$n.'" name="nodes['.$n.'][node_comment]" type="textarea"  />
        <button id="submit_node" type="submit">Submit</button></p>
        </fieldset>';
    }
    echo '</form>';
} 
```

然后得到`$_POST['nodes']`哪个是多维数组，你可以用`foreach`. 你会得到`$_POST['nodes'][1] = array('node_title'=>... , 'node_comment'=>...);`等等。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-02T23:46:05.373

如果您像您在帖子中所说的那样使用数组，您应该能够很容易地访问它们。

```
function createForm($node_number) {
    echo "<form id=\"form\" name=\"form\" action=\"molecule_display.php\" method=\"post\">";
    for ($n = 1; $n <= $node_number; $n++) {
        echo "<fieldset class=\"step\">
                  <input id=\"node_title_" . $n . "\" name=\"node_title[" . $n . "]\" />
                  <input id=\"node_comment_" . $n . "\" name=\"node_comment[" . $n . "]\" type=\"textarea\"  />
                  <button name=\"submit_node[" . $n . "]\" type=\"submit\">Submit</button></p>
              </fieldset>";
     }
     echo "</form>";
} 
```

我还将 submit_node 更改为一个名称并给它一个数组值，因为 ID 必须是唯一的，如果您在某处引用它会导致错误。

您可以像这样遍历结果：

```
foreach ($_POST['node_title'] as $key => $response) {
    $title = $response;
    $comment = (!empty($_POST['node_comment'][$key])) ? $_POST['node_comment'][$key] : "";
    // Save title / comment here.
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-02T23:42:33.890

由于每个表单都有自己的提交按钮，因此没有什么能阻止您 `name="node_title"`在所有表单中使用。如果您现在`<input type="hidden" name="index" value="$n">`先添加并阅读此内容，您的逻辑将变得非常简单。

# ruby-on-rails - Ruby on rails 服务器不刷新

> ID：10866755
> 
> 赞同：0
> 
> 时间：2012-06-02T23:35:46.700
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord

在我更新到 Rails 3.2.4 之后，发生了一些非常奇怪的事情。

我创建了一个新应用程序，并使用脚手架生成了一个名为 FOO 的模型。使用本地服务，我可以创建一个新的 FOO，但是在 FOO 的 index.html 中，新的 FOO 不会出现。只有在我重新启动本地服务器后才会这样做。

当我推动 heroku 时，也会出现同样的行为。

这真的很奇怪，因为如果我将 /FOOs/1 放在 URL 中，我可以看到新创建的 FOO 的显示页面（我的意思是在重新启动服务器之前）。所以记录在那里，但它没有在 index.html 中列出。后者只是做些微不足道的事

```
<% @foos.each do |foo| %>
   ...
<% end %> 
```

这里发生了什么？

Rails 版本是 3.2.4

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T14:17:49.363

升级到 3.2.5 解决了这个问题！

# c# - 两个排序整数数组的快速交集

> ID：10866756
> 
> 赞同：11
> 
> 时间：2012-06-02T23:36:27.953
> 
> 标签：c#, .net, assembly

我需要找到两个已排序整数数组的交集并快速完成。

现在，我正在使用以下代码：

```
int i = 0, j = 0;

while (i < arr1.Count && j < arr2.Count)
{
    if (arr1[i] < arr2[j])
    {
        i++;
    }
    else
    {
        if (arr2[j] < arr1[i])
        {
            j++;
        }
        else 
        {
            intersect.Add(arr2[j]);
            j++;
            i++;
        }
    }
} 
```

不幸的是，完成所有工作可能需要几个小时。

如何更快地做到这一点？我发现[这篇文章](http://www.adms-conf.org/p1-SCHLEGEL.pdf)使用了 SIMD 指令。是否可以在 .NET 中使用 SIMD？

你有什么想法：

[http://docs.go-mono.com/index.aspx?link=N:Mono.Simd](http://docs.go-mono.com/index.aspx?link=N:Mono.Simd) Mono.SIMD

[http://netasm.codeplex.com/](http://netasm.codeplex.com/) NetASM（将 asm 代码注入托管）

和类似[http://www.atrevido.net/blog/PermaLink.aspx?guid=ac03f447-d487-45a6-8119-dc4fa1e932e1](http://www.atrevido.net/blog/PermaLink.aspx?guid=ac03f447-d487-45a6-8119-dc4fa1e932e1)

编辑：

当我说数千时，我的意思是跟随（在代码​​中）

```
for(var i=0;i<arrCollection1.Count-1;i++)
{
    for(var j=i+1;j<arrCollection2.Count;j++)
    {
        Intersect(arrCollection1[i],arrCollection2[j])  
    }
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-03T00:21:27.340

**更新**

> 我得到的最快的是 200 毫秒，数组大小为 10 百万，不安全版本（最后一段代码）。

我做过的测试：

```
var arr1 = new int[10000000];
var arr2 = new int[10000000];

for (var i = 0; i < 10000000; i++)
{
    arr1[i] = i;
    arr2[i] = i * 2;
}

var sw = Stopwatch.StartNew();

var result = arr1.IntersectSorted(arr2);

sw.Stop();

Console.WriteLine(sw.Elapsed); // 00:00:00.1926156 
```

**全文：**

我已经测试了各种方法来做到这一点，发现这非常好：

```
public static List<int> IntersectSorted(this int[] source, int[] target)
{
    // Set initial capacity to a "full-intersection" size
    // This prevents multiple re-allocations
    var ints = new List<int>(Math.Min(source.Length, target.Length));

    var i = 0;
    var j = 0;

    while (i < source.Length && j < target.Length)
    {
        // Compare only once and let compiler optimize the switch-case
        switch (source[i].CompareTo(target[j]))
        {
            case -1:
                i++;

                // Saves us a JMP instruction
                continue;
            case 1:
                j++;

                // Saves us a JMP instruction
                continue;
            default:
                ints.Add(source[i++]);
                j++;

                // Saves us a JMP instruction
                continue;
        }
    }

    // Free unused memory (sets capacity to actual count)
    ints.TrimExcess();

    return ints;
} 
```

为了进一步改进，您可以删除`ints.TrimExcess();`，这也会产生很大的不同，但您应该考虑是否需要该内存。

此外，如果您知道可能会中断使用交叉点的循环，并且您不必将结果作为数组/列表，您应该将实现更改为迭代器：

```
public static IEnumerable<int> IntersectSorted(this int[] source, int[] target)
{
    var i = 0;
    var j = 0;

    while (i < source.Length && j < target.Length)
    {
        // Compare only once and let compiler optimize the switch-case
        switch (source[i].CompareTo(target[j]))
        {
            case -1:
                i++;

                // Saves us a JMP instruction
                continue;
            case 1:
                j++;

                // Saves us a JMP instruction
                continue;
            default:
                yield return source[i++];
                j++;

                // Saves us a JMP instruction
                continue;
        }
    }
} 
```

另一个改进是使用不安全的代码：

```
public static unsafe List<int> IntersectSorted(this int[] source, int[] target)
{
    var ints = new List<int>(Math.Min(source.Length, target.Length));

    fixed (int* ptSrc = source)
    {
        var maxSrcAdr = ptSrc + source.Length;

        fixed (int* ptTar = target)
        {
            var maxTarAdr = ptTar + target.Length;

            var currSrc = ptSrc;
            var currTar = ptTar;

            while (currSrc < maxSrcAdr && currTar < maxTarAdr)
            {
                switch ((*currSrc).CompareTo(*currTar))
                {
                    case -1:
                        currSrc++;
                        continue;
                    case 1:
                        currTar++;
                        continue;
                    default:
                        ints.Add(*currSrc);
                        currSrc++;
                        currTar++;
                        continue;
                }
            }
        }
    }

    ints.TrimExcess();
    return ints;
} 
```

**总之**，对性能影响最大的是 if-else。把它变成一个开关盒有很大的不同（大约快 2 倍）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-03T00:48:02.070

你有没有尝试过这样简单的事情：

```
var a = Enumerable.Range(1, int.MaxValue/100).ToList();
var b = Enumerable.Range(50, int.MaxValue/100 - 50).ToList();

//var c = a.Intersect(b).ToList();
List<int> c = new List<int>();

var t1 = DateTime.Now;

foreach (var item in a)
{
    if (b.BinarySearch(item) >= 0)
        c.Add(item);
}

var t2 = DateTime.Now;

var tres = t2 - t1; 
```

这段代码需要 1 个包含**21,474,836 个**元素的数组，另一个包含**21,474,786个元素**

如果我使用`var c = a.Intersect(b).ToList();`我会得到一个`OutOfMemoryException`

结果产品将是使用嵌套 foreach的**461,167,507,485,096次迭代**

但是使用这个简单的代码，交集发生在**TotalSeconds = 7.3960529**（使用一个核心）

现在我仍然不开心，所以我试图通过并行打破它来提高性能，一旦我完成我会发布它

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-10-20T14:27:52.210

Yorye Nathan 给了我两个数组与最后一个“不安全代码”方法的最快交集。不幸的是，它对我来说仍然太慢了，我需要组合数组交叉点，最多 2^32 个组合，几乎没有？我进行了以下修改和调整，时间缩短到 2.6 倍。您需要在之前进行一些预优化，以确保您可以以某种方式做到这一点。我只使用索引而不是实际的对象或 ID 或其他一些抽象比较。因此，例如，如果您必须像这样与大数字相交

**Arr1：** 103344、234566、789900、1947890、 **Arr2：** 150034、234566、845465、23849854

将所有内容放入数组中

**Arr1：** 103344、234566、789900、1947890、150034、845465、23849854

并使用结果数组的有序索引作为交集

**Arr1Index：** 0、1、2、3 Arr2Index ： **1、4、5、6**

现在我们有了更小的数字，我们可以用它们来构建其他一些不错的数组。在从 Yorye 获取方法之后，我使用 Arr2Index 并将其扩展为理论上的布尔数组，实际上是字节数组，因为内存大小的含义，如下：

**Arr2IndexCheck: 0, 1, 0, 0, 1, 1 ,1**

这或多或少是一本字典，它告诉我第二个数组是否包含任何索引。下一步我没有使用同样需要时间的内存分配，而是在调用方法之前预先创建了结果数组，因此在查找我的组合的过程中我从不实例化任何东西。当然你必须单独处理这个数组的长度，所以也许你需要把它存储在某个地方。

最后代码如下所示：

```
 public static unsafe int IntersectSorted2(int[] arr1, byte[] arr2Check, int[] result)
    {
        int length;

        fixed (int* pArr1 = arr1, pResult = result)
        fixed (byte* pArr2Check = arr2Check)
        {
            int* maxArr1Adr = pArr1 + arr1.Length;
            int* arr1Value = pArr1;
            int* resultValue = pResult;

            while (arr1Value < maxArr1Adr)
            {
                if (*(pArr2Check + *arr1Value) == 1)
                {
                    *resultValue = *arr1Value;
                    resultValue++;
                }

                arr1Value++;
            }

            length = (int)(resultValue - pResult);
        }

        return length;
    } 
```

你可以看到函数返回的结果数组大小，然后你做你想做的事情（调整它的大小，保留它）。显然，结果数组必须至少具有 arr1 和 arr2 的最小大小。

最大的改进是我只遍历第一个数组，最好是比第二个数组的大小更小，这样你的迭代次数就会更少。更少的迭代意味着更少的 CPU 周期，对吗？

So here is the really fast intersection of two ordered arrays, that if you need a reaaaaalllyy high performance ;).

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-03T00:15:51.417

是整数数组`arrCollection1`的`arrCollection2`集合吗？在这种情况下，您应该通过开始第二个循环`i+1`而不是`0`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-03T00:17:27.593

C# 不支持 SIMD。此外，我还没有弄清楚为什么，使用 SSE 的 DLL 在从 C# 调用时并不比非 SSE 等效函数快。此外，我所知道的所有 SIMD 扩展都不适用于分支，即您的“if”语句。

如果您使用的是 .net 4.0，如果您有多个内核，则可以使用 Parallel For 来提高速度。否则，如果您拥有 .net 3.5 或更低版本，则可以编写多线程版本。

这是一个类似于你的方法：

```
 IList<int> intersect(int[] arr1, int[] arr2)
    {
        IList<int> intersect = new List<int>();
        int i = 0, j = 0;
        int iMax = arr1.Length - 1, jMax = arr2.Length - 1;
        while (i < iMax && j < jMax)
        {
            while (i < iMax && arr1[i] < arr2[j]) i++;
            if (arr1[i] == arr2[j]) intersect.Add(arr1[i]);
            while (i < iMax && arr1[i] == arr2[j]) i++; //prevent reduntant entries
            while (j < jMax && arr2[j] < arr1[i]) j++;
            if (arr1[i] == arr2[j]) intersect.Add(arr1[i]);
            while (j < jMax && arr2[j] == arr1[i]) j++; //prevent redundant entries
        }
        return intersect;
    } 
```

这还可以防止任何条目出现两次。使用 2 个大小为 1000 万的排序数组，它在大约一秒钟内完成。如果您在 For 语句中使用 array.Length ，编译器应该删除数组边界检查，但我不知道这是否适用于 while 语句。

# java - 使用覆盖 getPreferredSize() 而不是 setPreferredSize() 用于固定大小的组件

> ID：10866762
> 
> 赞同：15
> 
> 时间：2012-06-02T23:38:36.763
> 
> 标签：java, swing, layout-manager

我在这里读了一些帖子，然后开始了为什么有些人这样做

```
@Override
public Dimension getPreferredSize() {
    return new Dimension(500, 500);
} 
```

代替

```
setPreferredSize(new Dimension(500, 500)); 
```

第二个不是更好吗，因为它只创建一个`Dimension`对象，而第一个可能创建多个对象（即使它没有那么多浪费的内存）？还是我错了？有什么区别吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-03T06:51:53.473

一个很大的区别是值如何随时间变化，因此您选择的值应该取决于您想要对代码执行的操作。

如果您只是简单地调用`setPreferredSize(new Dimension(500, 500));`您的代码，它会按照您的预期执行 - 它将首选尺寸设置为 500x500。但是，应用程序中的其他代码可能会用新值覆盖此值 - 任何东西都可以调用`setPreferredSize()`，最后一次调用此方法将是最终结果。

但是，如果您`getPreferredSize()`在代码中覆盖该方法，它将*始终*返回 500x500。您的任何代码是否调用该`setPreferredSize()`方法都没有关系，因为它们实际上被忽略了。如果您还覆盖`getMinimumSize()`and `getMaximumSize()`，则可以在组件上强制固定大小，无论窗口和其他组件的大小如何，该大小都不应更改。

但是，正如@Andrew Thompson 在评论中提到的那样，这并不能保证，因为某些布局管理器可以选择忽略这些，特别是如果您正在编写自己的布局管理器，并且向某些父容器添加自定义组件也会忽略这些方法，取决于组件的使用位置/方式。无论如何，它仍然比调用更严格，调用`setPreferredSize()`很容易被其他代码调用并被完全覆盖。

我还为我的任何自定义组件覆盖了`getPreferredSize()`方法（加号`getMinimumSize()`和`getMaximumSize()`），例如需要具有特定尺寸才能正确绘制组件的颜色选择器。在不覆盖这些方法的情况下，Swing 布局管理器不了解如何根据`JFrame`or的大小来适当地定位和调整您的自定义组件`JPanel`。

# asp.net - asp.net 删除 cookie

> ID：10866764
> 
> 赞同：0
> 
> 时间：2012-06-02T23:38:49.430
> 
> 标签：asp.net, authentication, cookies

我正在使用包含用于身份验证的加密密钥的 cookie。我需要的是在注销时删除此 cookie。根据 msdn，无法从客户端的浏览器中删除 cookie，因此我尝试设置 expiry date `HttpContext.Current.Request.Cookies["CAuthCookie"].Expires = DateTime.Now.AddDays(-1);`，但 cookie 仍然存在。还有其他想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-03T04:31:52.580

试试这个：（把它放在你的注销代码中）

```
HttpCookie cookie = new HttpCookie("CAuthCookie", "");
cookie.Expires = DateTime.Now.AddDays(-1);
HttpContext.Current.Response.Cookies.Set(cookie); 
```

# c++ - 是否可以在 C++ 中使用编译时断言

> ID：10866767
> 
> 赞同：1
> 
> 时间：2012-06-02T23:39:04.813
> 
> 标签：c++, assert

我想使用模板进行一些数据处理，但我需要代码在移植时或多或少是安全的。

如果变量的大小超出预期值，这可能是一个问题，所以我想在编译时断言一些假设仍然有效。

例如，`sizeof(long)>sizeof(int)`如果这个假设失败，我可以破坏构建。

我知道标准要求`long>=int`，但这只是一个例子，不要专注于变量类型。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-02T23:40:58.980

C++11 有`static_assert`：

```
static_assert(sizeof(long) > sizeof(int), "long must be greater than int"); 
```

在较旧的编译器上，您可以使用[Boost.StaticAssert](http://www.boost.org/doc/libs/1_49_0/doc/html/boost_staticassert.html)。

```
BOOST_STATIC_ASSERT(sizeof(long) > sizeof(int)); 
```

# drupal - Drupal 内容访问限制

> ID：10866768
> 
> 赞同：0
> 
> 时间：2012-06-02T23:39:10.117
> 
> 标签：drupal

我正在使用 Drupal 和 IMCE 将文件上传到私有文件系统。问题是，每当我尝试访问其中的文件时，都会收到“禁止访问”错误。这是使用用户 1，管理员。谁能建议如何正确设置内容访问限制？我已经在使用“内容访问”模块，但我想我不知道如何正确使用它。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-03T14:59:58.573

尝试使用文件的私有/系统 url 而不是直接站点/默认/文件/文件名路径

[http://api.drupal.org/api/drupal/includes%21file.inc/function/file_create_url/6访问它](http://api.drupal.org/api/drupal/includes%21file.inc/function/file_create_url/6)

# python - 为什么这段代码在 NULL 句柄上调用 CloseHandle？

> ID：10866771
> 
> 赞同：0
> 
> 时间：2012-06-02T23:39:33.943
> 
> 标签：python, c, winapi

我正在尝试使用 ctypes 重新创建在 psutil 项目（https://code.google.com/p/psutil/）上找到的一些功能。使用 psutil 对于我想要的东西来说太过分了，这只是检查给定的 pid 当前是否正在运行。

我试图重新创建的代码片段是[pid_is_running 函数](http://code.google.com/searchframe#Dnjw9wRLlM4/trunk/psutil/arch/mswindows/process_info.c&q=pid_is_running%20package%3apsutil%5C.googlecode%5C.com&l=150)。

```
int
pid_is_running(DWORD pid)
{
    HANDLE hProcess;
    DWORD exitCode;

    // Special case for PID 0 System Idle Process
    if (pid == 0) {
        return 1;
    }

    if (pid < 0) {
        return 0;
    }

    hProcess = OpenProcess(PROCESS_QUERY_INFORMATION | PROCESS_VM_READ,
                           FALSE, pid);
    if (NULL == hProcess) {
        // invalid parameter is no such process
        if (GetLastError() == ERROR_INVALID_PARAMETER) {
            CloseHandle(hProcess);
            return 0;
        }

        // access denied obviously means there's a process to deny access to...
        if (GetLastError() == ERROR_ACCESS_DENIED) {
            CloseHandle(hProcess);
            return 1;
        }

        CloseHandle(hProcess);
        PyErr_SetFromWindowsErr(0);
        return -1;
    }

    if (GetExitCodeProcess(hProcess, &exitCode)) {
        CloseHandle(hProcess);
        return (exitCode == STILL_ACTIVE);
    }

    // access denied means there's a process there so we'll assume it's running
    if (GetLastError() == ERROR_ACCESS_DENIED) {
        CloseHandle(hProcess);
        return 1;
    }

    PyErr_SetFromWindowsErr(0);
    CloseHandle(hProcess);
    return -1;
} 
```

我不明白为什么代码要关闭 NULL 句柄。这真的有必要吗？它是错误的还是可能导致错误？

我也很感激任何关于我到目前为止能想出的意见

```
import os
import shlex
import subprocess
import ctypes as c
import ctypes.wintypes as w

PROCESS_QUERY_INFORMATION   = 0x0400L
PROCESS_VM_READ             = 0x0010L             
ERROR_INVALID_PARAMETER     = 0x57L
ERROR_ACCESS_DENIED         = 0x5L
STILL_ACTIVE                = 0x103L
FALSE                       = 0L

def start(cmd):
    l = shlex.split(cmd)
    return subprocess.Popen(l).pid

def get_pid(hProcess):
    pid = w.DWORD()
    return c.windll.kernel32.GetProcessId(hProcess);

def pid_is_running(pid):
    # adapted from psutil library 
    # http://code.google.com/searchframe#Dnjw9wRLlM4/trunk/psutil/arch/mswindows/process_info.c&q=pid_is_running%20package:psutil\.googlecode\.com&l=150

    pid         = w.DWORD(pid)
    hProcess    = w.HANDLE()

    if pid.value == 0L:
        return True

    if pid.value < 0L:
        return False

    flags = PROCESS_QUERY_INFORMATION | PROCESS_VM_READ
    hProcess = c.windll.kernel32.OpenProcess(flags, FALSE, pid)
    try:
        if 0 == hProcess:
            # invalid parameter is no such process
            last_error = c.windll.kernel32.GetLastError()
            if last_error == ERROR_INVALID_PARAMETER:
                return False

            # access denied obviously means there's a process to deny access to...
            if last_error == ERROR_ACCESS_DENIED:
                return True
            #return -1 #  Error? Should I throw an exception
            raise Exception('Could not find process and an error occurred')
        else:
            exitCode = w.DWORD()    
            if c.windll.kernel32.GetExitCodeProcess(hProcess, c.byref(exitCode)):
                return exitCode.value == STILL_ACTIVE

            # access denied means there's a process there so we'll assume it's running
            if c.windll.kernel32.GetLastError() == ERROR_ACCESS_DENIED:
                return True
            #return -1 #  Error? Should I throw an exception
            raise Exception('Process found and an error occurred')
    finally:
        if hProcess != 0:
            c.windll.kernel32.CloseHandle(hProcess) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-02T23:47:11.173

它可能是自动生成的，以在每个返回路径上关闭它。甚至 C 程序员也不会愚蠢到在每条路径上释放资源，而是使用基于 goto 的清理习惯用法。

当然，

> 针对 API 中未公开的 ntdll 函数进行编译

可能表明该代码使用了内部 NT API 函数，这些函数必然会在将来的任何时候更改和破坏您的代码。

# php - 按照用户的样式将用户输入插入 mysql 数据库（带换行符）

> ID：10866776
> 
> 赞同：1
> 
> 时间：2012-06-02T23:41:09.370
> 
> 标签：php, mysql

我希望将用户的输入从 textarea 插入 mysql 数据库。截至目前，如果用户键入以下内容：

```
"Hello.

hello." 
```

它将被插入到数据库中而没有换行符。我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-02T23:45:03.077

您可能正在使用 phpMyAdmin 来判断不存在换行符。如果是这样的话，那就是在骗你。phpMyAdmin 将内容显示为 HTML，并且换行符转换为单个空格。

即使您只是输出值而不使用 phpMyAdmin，您的 HTML 仍然会折叠空白区域。要保留格式，请在`<pre>`标签之间或以 css 样式输出它`white-space: pre`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-02T23:49:49.430

实际上换行符已插入数据库中，您只是看不到它们，因为它们是`"\r\n"`，这是*换行符*和*回车符，请*[在此处](http://en.wikipedia.org/wiki/Carriage_return)阅读有关它们的更多信息

我相信您应该像这样存储数据：没有进行转换，当您将内容写入 HTML 时，您只需要做一个`nl2br($content)`.

而且它也很容易编辑，因为当将该内容输出到 textarea 标签时，它会自动识别`"\r\n"`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-02T23:43:47.417

如果使用 PHP，我建议使用`$message = nl2br($message);`

这将为您将换行符变成 br。

# node.js - 多语言快递应用

> ID：10866778
> 
> 赞同：25
> 
> 时间：2012-06-02T23:41:23.287
> 
> 标签：node.js, express, pug

我想知道在 express 中以相同布局实现相同内容的多个版本/语言的最佳方法是什么。

我应该这样做吗？

```
app.get("/", function(req, res) {
    res.render(language + "/index");
}); 
```

还是有更聪明/更好的方法？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-06-02T23:50:02.950

我建议只保留一个模板，就好像您对每种语言使用一个模板一样，它会很快失控，更不用说复制大量内容（以及您也会在模板中放入少量“逻辑”）。许多应用程序使用名为 gettext 的工具来完成国际化。[在https://github.com/DanielBaulig/node-gettext](https://github.com/DanielBaulig/node-gettext)有一个 node.js 库

或者还有[i18n-node](https://github.com/mashpie/i18n-node)。它似乎与 express js 有更多的集成。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2016-08-17T19:09:15.777

[i18n-node](https://github.com/mashpie/i18n-node)是您应该使用的最简单和最强大的模块。您可以直接在 Javascript 代码中使用，也可以使用带有 express js 的 Jade/Handlebar 模板。

为什么要使用 i18n？

*   根据您的设置，通过标头、cookie 或查询参数从浏览器自动检测区域设置。
*   它也带有示例。
*   `en.json`它默认在里面自动生成一个`./locales/`. 这充当您开始构建新翻译的主文件。
*   支持单数和复数形式
*   支持参数：`__('Hello %s', 'Marcus')`返回`Hallo Marcus`

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2015-08-11T17:51:21.363

我认为我们可以在 lang 文件夹中定义 json 对象，例如 en.js 、 fr.js ，并且这个 json 文件包含键值对，而不是根据用户的语言设置渲染到模板，lang 设置可以进入数据库。

我们可以将此 fr.js 或其他任何内容保存到 res.locals 以调用每个模板。

这合适吗？

# c++ - 函数指针和返回类型转换

> ID：10866779
> 
> 赞同：5
> 
> 时间：2012-06-02T23:41:33.657
> 
> 标签：c++, templates, c++11, type-conversion, function-pointers

假设我有一个函数执行一些副作用，然后返回一个答案：

```
int foo()
{
    perform_some_side_effect();
    return 42;
} 
```

我想绑定`foo`到一个函数指针，但我对答案不感兴趣，只是副作用：

```
void (*bar)() = foo; 
```

但是，这似乎是一个类型错误：

```
error: invalid conversion from ‘int (*)()’ to ‘void (*)()’ 
```

该错误背后的原因是什么？为什么类型系统不允许我忽略答案？

* * *

附带说明一下，如果我将函数指针包装在 a 中，它会起作用`std::function`：

```
std::function<void()> baz = foo; 
```

（显然）如何`std::function`设法规避类型系统中的这种限制？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-03T01:22:47.540

> 该错误背后的原因是什么？为什么类型系统不允许我忽略答案？

原因是类型不同，调用处（通过函数指针）生成的代码不同。考虑一个调用约定，其中所有参数都写入堆栈，返回值的空间也保留在堆栈中。如果调用通过 a `void (*)()`，则堆栈中不会为返回值保留空间，但函数（不知道它是如何被调用的）仍会将 a 写入`42`调用者应该保留空间的位置。

> std::function （显然）如何设法规避类型系统中的这种限制？

它不是。它创建一个函数对象，将调用包装到实际函数中。它将包含一个成员，例如：

```
void operator()() const {
   foo();
} 
```

现在，当编译器处理对它的调用时，`foo`它知道*调用*返回 an 的函数必须做什么，`int`并且它将根据调用约定执行此操作。因为模板没有返回，它只会忽略实际返回的值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-03T11:19:17.260

除了其他人所说的，调用者还需要返回类型来知道它应该对结果调用什么析构函数（返回值可能是临时的）。

* * *

~~不幸的是，这并不像~~

```
auto (*bar)() = foo; 
```

尽管 GCC 和 Clang 接受了这一点。我需要重新检查规范，看看这是否真的正确。

更新：规范说

> auto*类型说明符*表示被声明的变量的类型应从其初始化程序中推导出来，或者函数声明符应包含*尾随返回类型。*

这在快速阅读时可能会产生误导，但这是由 GCC 和 clang 实现的，仅适用于顶级声明符。在我们的例子中，这是一个指针声明符。嵌套在其中的声明符是一个函数声明符。所以只需替换`auto`，`void`然后编译器将为您推断类型。

* * *

顺便说一句，您总是可以手动完成这项工作，但要使其工作需要一些技巧

```
template<typename FunctionType>
struct Params; 

template<typename ...Params>
struct Params<void(Params...)> {
  template<typename T>
  using Identity = T;

  template<typename R>
  static Identity<R(Params...)> *get(R f(Params...)) {
    return f;
  }
};

// now it's easy
auto bar = Params<void()>::get(foo); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-02T23:45:05.743

`std::function`只需要与源代码兼容——也就是说，它可以生成一个新类，该类会生成忽略结果的新校准代码。函数指针必须是二进制兼容的，并且不能完成这项工作`void(*)()`——并且`int(*)()`指向完全相同的代码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-02T23:46:24.620

您可以考虑`std::function<>`针对您的特定情况执行此操作：

```
void __func_void()
{
    foo();
} 
```

它实际上比这要复杂一些，但关键是它会生成模板代码和*类型擦除*，而不关心细节。

# c# - udp 数据包到 nat 后面的机器

> ID：10866780
> 
> 赞同：0
> 
> 时间：2012-06-02T23:41:44.300
> 
> 标签：c#, udp

首先对我的英语感到抱歉。我的问题是我在压机上有电子电路。该电路将数据发送到我的服务器没有问题。收到数据后，我需要向电路发送命令。在局域网中它的工作就像一个魅力。但是在局域网之外，并没有以某种方式收到我的命令。知道如何将 udp 发送到 NAT 后面的机器吗？我的代码如下，请提供任何帮助。

```
 private void ReceiveMessage()
        {
            while (true)
            {
                try
                {
                    var remoteIpEndPoint = new IPEndPoint(IPAddress.Any, 0);
                    var content = _udpClient.Receive(ref remoteIpEndPoint);
                    if (content.Length > 0)
                    {
                        var message = Encoding.ASCII.GetString(content);
                        var smsg = message.Split('|');
                        var pin1 = int.Parse(smsg[13]);
                        var pin2 = int.Parse(smsg[14]);

                        var isChanged = CheckChanges(smsg[1]);
                        if (isChanged == 1)
                        {

                            **var recvpt = new IPEndPoint(remoteIpEndPoint.Address, remoteIpEndPoint.Port);
                            var client = new UdpClient();
                            var cmd1 = "CP1S" + _pin1Time + "F";
                            var cmd2 = "CP2S" + _pin2Time + "F";
                            var senddata1 = Encoding.UTF8.GetBytes(cmd1);
                            var senddata2 = Encoding.UTF8.GetBytes(cmd2);
                            client.Send(senddata1, senddata1.Length, recvpt);
                            client.Send(senddata2, senddata2.Length, recvpt);
                            client.Close();**
                            //  UpdateChanges(smsg[1]);
                        }
                }
                catch (Exception ex)
                {

                    MessageBox.Show(ex.ToStrin<wbr ></wbr>g());
                }
            }
        }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-03T01:17:36.777

不能从远程网络直接访问位于 NAT 路由器后面的计算机。需要在您的防火墙/路由器上设置规则以将此流量路由到远程计算机。有关明确指示，请参阅您的 WAN/LAN 管理员。如果您没有，您可以尝试在[Server Fault](https://serverfault.com/)上询问有关您的网络的更多信息。

# google-apps-script - 静态地图和图像的问题

> ID：10866784
> 
> 赞同：0
> 
> 时间：2012-06-02T23:43:11.047
> 
> 标签：google-apps-script

我正在尝试将地图图像添加到 Google Apps 脚本中的面板。每次我加载 UI 时，都会看到以下图像：

![](../Images/04b97e3b376347114177a4b7e048a898.png)

这是超出配额的 Google 图片。好吧，我以前从未使用过地图功能。我在两个不同的域/不同的帐户上得到了相同的结果。我没有理由超过任何限制。

这是一个损坏的简单脚本：

```
function main() {
  var app = UiApp.createApplication();
  var sheet = SpreadsheetApp.getActiveSpreadsheet();
  var panel = app.createVerticalPanel();

  var map = Maps.newStaticMap()
      .setCenter("1600 Pennsylvania Ave, Washington D.C.")
      .setZoom(14);

  var mapUrl = map.getMapUrl();

  var image = app.createImage(mapUrl);
  panel.add(image);

  // add a label with the URL string
  var labelUrl = app.createLabel(mapUrl);
  app.add(labelUrl);  

  app.add(panel);

  sheet.show(app);
} 
```

实际上，在编写这个示例时，我发现它有时会起作用，而其他时候则不起作用。我真的很困惑。

在上面的示例中，URL 也被写入 UI 上的标签。如果我手动将其复制并粘贴到我的网络浏览器中，则查看地图没有问题。

还有其他人遇到这种情况吗？有一些提示吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-03T17:10:52.760

如果您 100% 确定您没有达到配额限制，我建议您在问题跟踪器上提出问题。（回想一下，如果您还有任何其他可能占用您配额的触发器脚本）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-05T17:54:53.427

我在其他任何地方都没有看到的一种可能性是您的**API Key 可能被 IP 锁定了**。令人沮丧的是，无论您超出配额还是 IP 被阻止，Google 都会为您提供相同的图像。

在[Google Developers Console](https://console.developers.google.com/)中，检查 API & Auth -> Credentials 并点击“Edit Allowed IP's”。小心打开它，因为任何人都可以获取您的 API 密钥并坚持使用。

# java - 无法在线程的构造函数中初始化 PrintWriter 字段

> ID：10866786
> 
> 赞同：0
> 
> 时间：2012-06-02T23:43:24.397
> 
> 标签：java

需要为每个连接创建一个新线程。线程应该具有写入套接字的功能，即使它在 run() 等待客户端输入：`String clientCommand = in.readLine()`。该函数`update`应满足此要求并且能够使用`PrintWriter outWr`但它似乎是写入套接字`null`，即使在线程构造函数中设置它也是如此。无法`PrintWriter outWr`在构造函数中初始化。待`try`施工后。如何解决？`outWr``null`

* * *

```
public class Server {
    public static void main(String[] args) { 
        ...
        ClientServiceThread cliThread = new ClientServiceThread(clientSocket, id++, auction);
        ...
} 
```

* * *

```
public class ClientServiceThread extends Thread  {
private PrintWriter outWr;

ClientServiceThread(Socket s, int clientID, Auction a) {
        try {
            PrintWriter outWr = new PrintWriter(new OutputStreamWriter(
                    m_clientSocket.getOutputStream()));
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
public void run() {....; String clientCommand = in.readLine(); ... }
public void update(String msg){outWr.println(msg);} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-02T23:50:23.963

看看这段代码

```
public class ClientServiceThread extends Thread  {
private PrintWriter outWr;

ClientServiceThread(Socket s, int clientID, Auction a) {
        try {
            PrintWriter outWr = new PrintWriter(new OutputStreamWriter( 
```

在构造函数中，您不初始化类字段，而是初始化本地引用`PrintWriter outWr`

将其更改为

```
 try {
            outWr = new PrintWriter(new OutputStreamWriter( 
```

# c - 提高我的 C 列表 push_back 函数的性能

> ID：10866791
> 
> 赞同：2
> 
> 时间：2012-06-02T23:44:57.030
> 
> 标签：c, performance, list, push-back

我有我的 C 列表，我实现了这个`push_back`功能：

```
bool_t push_back_clist(clist_ptr pList, void* item)
{
    if(pList)
    {
        node_ptr pNode = new_node(item, pList->sizeof_item);
        if(!pNode) return FALSE;

        if(!pList->head)
            pList->head = pList->tail = pNode;
        else
        {
            pList->tail->next = pNode;
            pNode->prev = pList->tail;
            pList->tail = pNode;
        }

        pList->size++;
        return TRUE;
    }

    return FALSE;
}

static node_ptr new_node(void* data, size_t sizeof_item)
{
    node_ptr pNode = (node_ptr) malloc(sizeof(node_t));
    if(!pNode) return NULL;

     pNode->data = malloc(sizeof_item);

     if(!pNode->data)
     {
         free(pNode);
         return NULL;
     }

     memcpy(pNode->data, data, sizeof_item);
     pNode->next = pNode->prev = NULL;
     return pNode;
} 
```

它有效，但是当我将我的`push_back_clist`函数与`std::list.push_back`方法进行比较时，我注意到我的函数需要大约两倍的时间。为什么？我怎样才能提高我的功能的性能？谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-02T23:57:14.147

您可以一次性分配数据和节点，以节省`malloc`调用次数。

```
char* mem = malloc(sizeof(node_t)+sizeof_item);
// Check alloc here...
node_ptr pNode = (node_ptr)mem;
pNode->data = mem+sizeof(node_t); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-03T07:30:47.253

我认为您不应该像 dasblinkenlight 建议的那样使用单一分配，因为这是接口的隐式更改，此外很难记录：这样分配的项目不能用于存储不同的数据和删除在他们身上找到的数据。

对于可能的优化，我认为在您的版本中，控制流可能过于复杂并抑制了一些优化。通过直接向分配函数提供`prev`and字段，尝试仅触摸新分配的项目一次。`next`然后简化该分配功能的控制流程：

```
static node_ptr new_node(void* data, size_t sizeof_item, node_ptr prev, node_ptr next)
{
     void * cdata = malloc(sizeof_item);
     if(!cdata) return NULL;
     memcpy(cdata, data, sizeof_item);

     node_ptr pNode = malloc(sizeof *pNode);
     if(pNode)
       *pNode = (struct node){ .data = cdata, .prev = prev, .next = next, };
     return pNode;
} 
```

只有当你有一个兼容 C99 的编译器时，它才能正常工作。如果您不这样做，请重新考虑获得一个 :) 或将复合文字的使用更改为一系列赋值。

一些挑剔：

*   C 现在有自己的布尔类型（自 13 年以来），如果`bool`包含.c 应该可以很好地工作。`true``false``stdbool.h`
*   不要投回`malloc`
*   `typedef`的指针类型被 C 社区中的许多人认为是不好的风格

**编辑：**通过使用不同的版本，我发现以下内容可以使用我的设置（x86_64、linux、gcc 或 clang）生成最好的汇编程序

```
node_ptr new_node1(void* data, size_t sizeof_item, node_ptr next, node_ptr prev)
{
  node_ptr ret = NULL;
  void * nData = malloc(sizeof_item);
  if (!nData) return ret;
  struct node const nNode = {
    /* memcpy is unavoidable since nothing is known about the type of
       the data. But we can save a register by using the return value
       of memcpy. */
    memcpy(nData, data, sizeof_item),
    next,
    prev
  };
  /* Allocate the return value last so it may stay in the same return
     register */
  ret = malloc(sizeof *ret);
  if (!ret) return ret;
  /* Assignment is better than memcpy since this can just use "ret" as
     target address with offsets. */
  *ret = nNode;
  return ret;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-03T08:02:10.247

就像人们在这里所说的那样，您的列表速度慢了一倍，因为您每次插入执行 2 个堆操作（分配）。

从性能的角度来看，对节点 + 数据进行单一分配更为可取。此外，如果您的整体性能受到堆的显着影响，您可以（并且应该）使用替代堆。这样做可以将性能提高 100 倍甚至更多，这并不是一个高估。

# javascript - 简单的谷歌浏览器扩展来检测网页上的点击 - 没有显示警报（错误）

> ID：10866792
> 
> 赞同：1
> 
> 时间：2012-06-02T23:44:58.497
> 
> 标签：javascript, jquery, google-chrome-extension

这是我在名为“detectclicks.js”的内容脚本中放入的 js 代码，用于检测在浏览器中打开的网页的任何部分的点击 - 它使用 Jquery --- 但是没有显示警报......

```
$('body').on('click', '*', function(event) {
     window.alert(' ID of element- testing'); 
    window.alert(' ID of element=' + $(this).attr('id'));  // Get ID attribute
    window.alert(' ID of Parent element=' + $(this).parent()..attr('id'));
}); 
```

这是我的 manifest.json——

```
{
  "name": "My First Extension",
  "version": "1.0",
  "manifest_version": 2,
  "content_scripts": [
      {
        "matches": ["<all_urls>"],
        "js": ["jquery1.7.2.js", "detectclicks.js"]
      }
   ],
   "description": "The first extension that I made.",
   "browser_action": {
   "default_icon": "icon.png",
   "default_popup": "popup.html"
    } 
} 
```

当我将此扩展程序加载到谷歌浏览器并访问网页时，没有显示任何警报..单击页面的任何部分...我在这里做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-02T23:51:29.657

正如评论中所讨论的，检查它不应该是这一行中的双点：

```
window.alert('ID of Parent element=' + $(this).parent().attr('id')); 
```

留心！;)

# css - 将 ColdFusion Flash 表单居中的 CSS 代码在 Safari 中失败

> ID：10866797
> 
> 赞同：0
> 
> 时间：2012-06-02T23:46:02.390
> 
> 标签：css, flash, coldfusion

我的（非常简单的）测试代码在 Chrome 和 Firefox（[http://i.imgur.com/5vCoV.png](http://i.imgur.com/5vCoV.png)）中正确居中，但在 Safari 中显示不正确。相反，它看起来像这样：http: [//i.imgur.com/qDq9M.png](http://i.imgur.com/qDq9M.png)

我只在 Mac 上测试过。

这是我的代码：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Untitled Document</title>

<style type="text/css">
    @charset "utf-8";

body {
    background-color: #ccc;
    font-family: Verdana, Geneva, sans-serif;
    height: auto;
    width: auto;
    font-size: 80%;
    margin: 0;
    padding: 0;
}

#main {
    text-align: center;
}

</style>

</head>

<body>

<CFIF NOT ISDEFINED("FORM.SUBMIT")>
    <div id="main">
        <cfform format="flash" action="" skin="haloorange" width="798" height="540" style="background-color: ##999999; margin-top:8px; margin-left: 38px;">
        <cfformgroup type="panel" label="APPLICATION" width="790" style="background-color:##DDDDDD">
                <CFINPUT label="First Name" TYPE="Text" NAME="fname" MESSAGE="First Name required." value="Ahmed" REQUIRED="Yes" tooltip="Enter your first name." width="298">
                <CFINPUT label="Last Name" TYPE="Text" NAME="lname" MESSAGE="Last Name required." value="Osman" REQUIRED="Yes" tooltip="Enter your last name." width="298">
                <CFINPUT TYPE="submit" width="49" NAME="submit" value="Submit" tooltip="Save your name.">
            </cfformgroup>
        </cfform>
    </div>
<CFELSE>
    <cfdump var="#FORM#">
</CFIF>

</body>
</html> 
```

编辑：

这是渲染的 HTML 代码，感谢 reiso：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head><script type="text/javascript" src="/CFIDE/scripts/cfform.js"></script>
<script type="text/javascript" src="/CFIDE/scripts/masks.js"></script>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Untitled Document</title>

<style type="text/css">
    @charset "utf-8";

    body {
        background-color: #ccc;
        font-family: Verdana, Geneva, sans-serif;
    height: auto;
    width: auto;
    font-size: 80%;
    margin: 0;
    padding: 0;
}

#main {
    padding: 0;
    width: 100%;
    text-align: center;
    }

</style>

</head>

<body>

<div id="main">
<script type="text/javascript" charset='utf-8' src='/CFIDE/scripts/cfformhistory.js'>   </script>
<noscript>
<object classid='clsid:D27CDB6E-AE6D-11cf-96B8-444553540000'
 id='CFForm_1'
 codebase='http://www.macromedia.com/go/getflashplayer#version=7,0,14,0'
 width='798'
 height='540'>
  <param name='wMode' value='Window'/>
  <param name='src' value='/zip/1613302191.mxml.cfswf'/>
  <param name='flashVars'   value='%5F%5FCFForm%5F1%5Fcacheid=ED542456%2DBAD9%2DED93%2DE8B94655D75F224D'/>
<embed pluginspage='http://www.macromedia.com/go/getflashplayer' id='CFForm_1' src='/zip/1613302191.mxml.cfswf' width='798' height='540' wMode='Window' flashVars='%5F%5FCFForm%5F1%5Fcacheid=ED542456%2DBAD9%2DED93%2DE8B94655D75F224D' ></embed>  </object>
</noscript>
<script type="text/javascript" charset='utf-8' src='/CFIDE/scripts/CF_RunActiveContent.js'></script>
<script type="text/javascript" charset='utf-8'>
CF_RunContent('<object classid=\'clsid:D27CDB6E-AE6D-11cf-96B8-444553540000\'  codebase=\'http://www.macromedia.com/go/getflashplayer#version=7,0,14,0\' width=\'798\'  height=\'540\'>\n  <param name=\'src\' value=\'/zip/1613302191.mxml.cfswf\'/>\n    <param  name=\'wMode\' value=\'Window\'/>\n    <param name=\'flashVars\'  value=\'historyUrl=%2FCFIDE%2Fscriptscfformhistory%2Ecfm%3F&lconid=" + lc_id  +"&%5F%5FCFForm%5F1%5Fcacheid=ED542456%2DBAD9%2DED93%2DE8B94655D75F224D\'/>\n<embed pluginspage=\'http://www.macromedia.com/go/getflashplayer\' \n   id=\'CFForm_1\' \n   src=\'/zip/1613302191.mxml.cfswf\' \n   width=\'798\' \n   height=\'540\' \n   wMode=\'Window\' \n   flashVars=\'historyUrl=%2FCFIDE%2Fscriptscfformhistory%2Ecfm%3F&lconid=" + lc_id +"&%5F%5FCFForm%5F1%5Fcacheid=ED542456%2DBAD9%2DED93%2DE8B94655D75F224D\'  >\n</embed>\n</object>\n');
</script>
<script type="text/javascript" charset='utf-8'>
    document.write("<br><iframe src='/CFIDE/scripts/cfformhistory.cfm' name='_history'  frameborder='0' scrolling='no' width='22' height='0'></iframe></br> ");
</script>

</div>

</body>
</html> 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-04T05:51:30.833

尚未对其进行测试，但请尝试将此作为您的#main 样式：

```
#main {
 width: 798px; /* same as your cfform's width value */
 padding: 0;
 margin: 0 auto; /* this shoudl center the container on the page */
} 
```

并从cfform 标记中的*style属性中***删除**所有*margin-**声明

# mysql - 在 Mac OSX Lion 上为 unixODBC/isql 添加数据源

> ID：10866803
> 
> 赞同：3
> 
> 时间：2012-06-02T23:46:38.217
> 
> 标签：mysql, macos, osx-lion, unixodbc, isql

我已经从源代码安装了 unixODBC，并从 Mac OSX Lion 上的 .dmg 安装程序安装了[mysql-odbc 连接器。](http://dev.mysql.com/downloads/connector/odbc/)这是前一阵子做的，当时我成功安装了一个数据源（姑且称之为`foo`）。现在我正在尝试添加另一个数据源（DSN）。我已经通过[ODBC 管理器](http://www.odbcmanager.net/)和命令行工具 myodbc-installer 完成了这项工作，该工具由 mysql 网站上的 mysql-odbc 连接器的 tar 包提供。中显示一个条目`/Library/ODBC/odbc.ini`，如下所示：

```
[ODBC Data Sources]
bar = MySQL ODBC 5.1 Driver

[ODBC]
Trace         = 0
TraceAutoStop = 0
TraceFile     = 
TraceLibrary  = 

[myodbc]
Driver = /usr/local/lib/libmyodbc5.so
SERVER = localhost
PORT   = 3306

[bar]
Driver      = /usr/local/lib/libmyodbc5.so
Description = 
DATABASE    = bar 
```

但是，isql 找不到它：

```
anitya:Preferences neil$ isql bar bar bar -v
[IM002][unixODBC][Driver Manager]Data source name not found, and no default driver specified
[ISQL]ERROR: Could not SQLConnect 
```

奇怪的是，`foo`在 /Library/ODBC/odbc.ini 或 /etc/odbc.ini 中看不到的旧 DSN 可以正常工作：

```
anitya:Preferences neil$ isql foo foo foo
+---------------------------------------+
| Connected!                            |
|                                       |
| sql-statement                         |
| help [tablename]                      |
| quit                                  |
|                                       |
+---------------------------------------+
SQL> 
```

我对需要在 OSX Lion 上输入 DSN 条目以供 isql 查找的位置感到恼火。在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-03T01:43:59.547

找到了，odbc.ini 在 /usr/local/etc

# jquery - JQuery Datepicker Validation 不适用于 MVC 的多个日期

> ID：10866804
> 
> 赞同：0
> 
> 时间：2012-06-02T23:47:02.553
> 
> 标签：jquery, asp.net-mvc, validation, data-annotations, jquery-ui-datepicker

我没有使用 jquery.ui 的日期选择器，因为我需要选择多个日期，所以我在 EditorTemplate 中为我的日期字段使用[Keith Wood 的日期选择器：](http://keith-wood.name/datepick.html)

```
 @model Nullable<DateTime>
    @{
        string name = ViewData.TemplateInfo.HtmlFieldPrefix;
        string id = name.Replace(".", "_");
        string dt = Model.HasValue ? String.Format("{0:d}",(string)Model.Value.ToShortDateString()) : string.Empty;
    }        
    @Html.Hidden("", dt, new { @class = "datefield", @type = "date", @id = id, style = "display:none;" })
    <script type="text/javascript">
        $(document).ready(function () {
            $('#@id').datepick({
                renderer: $.datepick.themeRollerRenderer,
                multiSelect: 31,
                onSelect: function (dates) {
                    var value = '';
                    for (var i = 0; i < dates.length; i++) {
                        value += (i == 0 ? '' : ',') + $.datepick.formatDate(dates[i]);
                    }
                    $('#@name').val(value)
                    var form = $(this).parents().find('form')[0];
                    // form.validate(); // this causes error (Object doesn't support property or method 'validate') whats up with that?
                }
            });
        });    
    </script> 
```

这是我的 ViewModel 继承的数据类中 DateTime 字段的定义：

```
 [Required]
    [DataType(DataType.Date)]
    public Nullable<DateTime> StartDate { get; set; } 
```

这是返回无效状态的客户端验证片段：

```
 form.validate({ 
        rules:{
            StartDate: { 
                required: true
                ,dpDate: true 
            }
        },
        messages: {
            StartDate: 'Please choose at least one date'
        }
    });

    if (form.valid()) { // never reached } 
```

所以现在我正在完成对这个内联日期选择器的最后一点验证。如您所见，我有一个由日期选择器填充的隐藏字段，它包含有效日期，但以逗号分隔，并且不会转换为日期时间。当我只选择一个日期时它是有效的。是否有将分隔数据验证为类型的通用解决方案？

我基本上是使用多个日期循环数据库调用，但仍想验证分隔数据是否为 ​​DateTime 类型。

问候，

布兰登

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T14:52:26.713

jQuery 插件需要一个 jQuery 对象。

如果您的表单 ID 是**myForm**，您将使用如下插件：

`$('#myForm').validate({ ... });`

`$('#myForm').valid();`

# javascript - jQuery 插件：如果我想调用类似 $('selector').plugin.group.method() 的东西，我该如何实现呢？

> ID：10866806
> 
> 赞同：1
> 
> 时间：2012-06-02T23:47:18.840
> 
> 标签：javascript, jquery

我写了一些相对简单的 jQuery 插件，但我正在考虑写一些更高级的东西，以保持网站上常用的方法易于访问和干燥

例如，我可能有这样的结构：

```
插入
- 弹出窗口
- 元素
...

=== 弹出窗口 ===
- 登录
- 产品
...

=== 元素 ===
- 购物车
- 登录状态
...

```

因此，要绑定弹出登录弹出事件，我希望能够这样做： $('#login_button').plugin.popup.login();

最好的方法是什么？有没有更好的方法来实现我想做的事情？

干杯，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T23:56:42.687

```
jQuery.fn.messagePlugin = function(){
    var selectedObjects = this;
    return {
         saySomething : function(message){
                          $(selectedObjects).each(function(){
                            $(this).html(message);
                          });
                          return selectedObjects; // Preserve the jQuery chainability 
                        },
         anotherAction : function(){
                        //...
                        return selectedObjects;
                        }
           };
} 
```

我们像这样使用它：

```
$('p').messagePlugin().saySomething('I am a Paragraph').css('color', 'red'); 
```

选定的对象存储在 messagePlugin 闭包中，该函数返回一个包含与插件关联的函数的对象，在每个函数中，您可以对当前选定的对象执行所需的操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T23:21:06.240

farhan Ahmad 的做法非常正确......它只需要更深层次来满足您的需求，您的实现将如下所示：

```
jQuery.fn.plugin = function(){
  //"community" (global to local methods) vars here.
  var selectedObjects = this; //-- save scope so you can use it later

  // return the objects so you can call them as necessary
  return {  
            popup: { //plugin.popup
                    login: function(){ //plugin.popup.login
                         //selectedObjects contains the original scope
                         console.log(selectedObjects);
                    },
                    product: function(){} //plugin.popup.product
            },
            element: { //plugin.element
                    shoppingCart: function() {}, //plugin.element.shoppingCart
                    loginStatus: function() {} //plugin.element.loginStatus
            }
         }
} 
```

所以现在如果你打电话： `$("#someDiv").plugin.login();`结果将如预期的那样。我希望这有帮助。

# xcode - 在 XCode 中将单元格添加到表视图 (UITableView)

> ID：10866813
> 
> 赞同：4
> 
> 时间：2012-06-02T23:49:23.997
> 
> 标签：xcode, uitableview, cell

我是 X-Code 的新手，刚刚开始开发我的第一个应用程序。我正在使用故事板。在导航控制器场景中，我添加了一个带有两个单元格的 MasterViewController，这导致两个 DetailViewControllers（Detail1 和 Detail 2）。

*   列数 = 1
*   列中的行数 = 2

我在属性检查器中为单元格添加了重用指示器，并在情节提要中建立了连接。

但是当我运行应用程序时，我只能看到第一个单元格 x2。

当我查看 MasterViewController.m 时，我可以看到第一个单元格的代码，但我不明白如何插入第二个单元格等！

我知道解决方案很简单，我一直在寻找答案 3 天了，我觉得很愚蠢，但我现在真的需要一些帮助，，

有人可以帮助我了解如何在代码中添加更多单元格，并且可能更多地了解表格视图代码吗？

到目前为止，这是表格视图的代码：

```
#pragma mark - Table view data source

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
// Return the number of sections.
return 1;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
// Return the number of rows in the section.
return 2;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
static NSString *CellIdentifier = @"Formal";
UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

// Configure the cell...

return cell;
}

/*
// Override to support conditional editing of the table view.
- (BOOL)tableView:(UITableView *)tableView canEditRowAtIndexPath:(NSIndexPath *)indexPath
{
// Return NO if you do not want the specified item to be editable.
return YES;
}
*/

/*
// Override to support editing the table view.
- (void)tableView:(UITableView *)tableView commitEditingStyle:(UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath
{
if (editingStyle == UITableViewCellEditingStyleDelete) {
    // Delete the row from the data source
    [tableView deleteRowsAtIndexPaths:[NSArray arrayWithObject:indexPath][withRowAnimation:UITableViewRowAnimationFade];
}   
else if (editingStyle == UITableViewCellEditingStyleInsert) {
    // Create a new instance of the appropriate class, insert it into the array, and add a new row to the table view
}   
}
*/

/*
// Override to support rearranging the table view.
- (void)tableView:(UITableView *)tableView moveRowAtIndexPath:(NSIndexPath *)fromIndexPath toIndexPath:(NSIndexPath *)toIndexPath
{
}
*/

/*
// Override to support conditional rearranging of the table view.
- (BOOL)tableView:(UITableView *)tableView canMoveRowAtIndexPath:(NSIndexPath *)indexPath
{
// Return NO if you do not want the item to be re-orderable.
return YES;
}
*/

#pragma mark - Table view delegate

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
// Navigation logic may go here. Create and push another view controller.
/*
 <#DetailViewController#> *detailViewController = [[<#DetailViewController#> alloc] initWithNibName:@"<#Nib name#>" bundle:nil];
 // ...
 // Pass the selected object to the new view controller.
 [self.navigationController pushViewController:detailViewController animated:YES];
 */
}

@end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-03T00:39:05.173

假设您有一个名为 arr 的数组。

然后，当调用 numberOfRowsInSection 时，您必须返回数组中的对象数。

```
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    // Return the number of rows in the section.
    return [arr count];
} 
```

您的 cellForRowAtIndexPath 委托方法应该像这样打印出数组中的字符串。

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {

static NSString *CellIdentifier = @"Formal";

UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
if (cell == nil) {
    cell = [[[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle 
                                   reuseIdentifier:CellIdentifier] autorelease];
}

// Configure the cell.

cell.textLabel.text = [arr objectAtIndex:indexPath.row];

    return cell;
} 
```

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T00:45:29.513

# 我的代码现在看起来像这样：

```
- (void)viewDidLoad
{
[super viewDidLoad];

omMeny = [[NSMutableArray alloc] init];

//Add items
[omMeny addObject:@"Formålet med guiden"];
[omMeny addObject:@"Aromahjulet"];
[omMeny addObject:@"Fagterm"];

//Set the title
self.navigationItem.title = @"Om Rødvin";
}

//dealloc method declared in RootViewController.m
- (void)dealloc {

[omMeny release];
[super dealloc];
}

// Uncomment the following line to preserve selection between presentations.
// self.clearsSelectionOnViewWillAppear = NO;

// Uncomment the following line to display an Edit button in the navigation bar for this view controller.
// self.navigationItem.rightBarButtonItem = self.editButtonItem;

- (void)viewDidUnload
{
[super viewDidUnload];
// Release any retained subviews of the main view.
// e.g. self.myOutlet = nil;
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
return (interfaceOrientation == UIInterfaceOrientationPortrait);
}

#pragma mark - Table view data source

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
// Return the number of sections.
return 1;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
// Return the number of rows in the section.
// return 2;
return [omMeny count];
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
static NSString *CellIdentifier = @"Om";
UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
if (cell == nil) {
    cell = [[[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier] autorelease];
}

// Set up the cell...
NSString *cellValue = [omMeny objectAtIndex:indexPath.row];
cell.textLabel.text = cellValue;

// Configure the cell...

return cell;
}

#pragma mark - Table view delegate

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
// Navigation logic may go here. Create and push another view controller.
/*
 <#DetailViewController#> *detailViewController = [[<#DetailViewController#> alloc] initWithNibName:@"<#Nib name#>" bundle:nil];
 // ...
 // Pass the selected object to the new view controller.
 [self.navigationController pushViewController:detailViewController animated:YES];
 */
}

@end 
```

在 .h 中有这个

```
@interface OmMasterViewController : UITableViewController {

NSMutableArray *omMeny;
} 
```

# titanium - Appcelerator：如何创建正确的后退按钮图像？

> ID：10866814
> 
> 赞同：0
> 
> 时间：2012-06-02T23:49:27.850
> 
> 标签：titanium, appcelerator, titanium-mobile, appcelerator-mobile

我从 AppVaultDesign 购买了一个主题，它带有一个后退按钮图像，看起来像这样[http://cl.ly/2h3x0j0p2v262k0k2U0e](http://cl.ly/2h3x0j0p2v262k0k2U0e)

但是，当我将它添加到代码中时，对齐看起来是错误的。文本太靠近按钮。[http://cl.ly/393s2D0f0v3P0m3H150O](http://cl.ly/393s2D0f0v3P0m3H150O)

当我尝试使用`textAlign: 'right'`时，它看起来像这样[http://cl.ly/0Z2d1Y0f3q1O100c0b3f](http://cl.ly/0Z2d1Y0f3q1O100c0b3f)不知道为什么会这样。令人沮丧。`textAlign: 'center'`当我做或时它不会上升`textAlign: 'left'`。

所以这是我正在使用的代码。有什么帮助吗？

```
var backButton = Ti.UI.createButton({
    backgroundImage: 'images/back.png',
    font: { fontSize: 13, fontWeight: 'bold' },
    height: 28,
    title: "Back",
    width: 51
});
backButton.addEventListener('click', function(){
    navGroup.close(self);
});
self.leftNavButton = backButton; 
```

我认为这应该是一件容易的事。令人沮丧的是我无法让它正常工作。如果有人可以向我发布按钮和图像的工作代码，将不胜感激。这样，我也可以尝试看看哪里出了问题。

非常感谢，米奇

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-02T23:55:58.827

最简单的方法可能是在之前添加一个空格`" Back"`

```
var backButton = Ti.UI.createButton({
    backgroundImage: 'images/back.png',
    font: { fontSize: 13, fontWeight: 'bold' },
    height: 28,
    title: " Back",
    width: 51
}); 
```

# php - 拉入关系数据库字段

> ID：10866816
> 
> 赞同：0
> 
> 时间：2012-06-02T23:49:41.563
> 
> 标签：php, mysql, relational

所以这是我的问题。我有三张桌子：

人表

`person_id, name`

事件表

`event_id, event_name, event_date`

比赛表

`match_id, person_a, person_b, winner, event`

所以在matches表中，person_a、person_b和winner是对应Person表中person_id的整数。

如果我从 Matches 表中拉入一行，结果会是这样的：

`1, 1, 2, 1, Chess Tournament #33`

如何使用 Person 表查找这 3 个字段（person_a、person_b 和 Winner）以提取他们的实际姓名，以便得到结果？

`1, John, Steven, John, Chess Tournament #33`

我考虑加入这两个表，但这没有意义，因为我不能只做 ON id=id 或 WHERE id=id。我很感激任何帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-02T23:55:41.543

```
SELECT
  Matches.match_id AS match_id,
  PersA.name AS persa_name,
  PersB.name AS persb_name,
  IF(winner=person_a,PersA.name,PersB.name) AS winner_name,
  Events.event_name AS event_name
FROM
  Matches
  INNER JOIN Person AS PersA ON Matches.person_a=PersA.person_id
  INNER JOIN Person AS PersB ON Matches.person_b=PersB.person_id
  INNER JOIN Events ON Matches.event=Events.event_id
WHERE
  -- whatever 
```

# java - 如何在给定号码的情况下查询联系人内容提供者

> ID：10866823
> 
> 赞同：1
> 
> 时间：2012-06-02T23:51:02.917
> 
> 标签：java, android, android-contacts

我想用给定的号码查询 android 中的联系人提供程序。

我有这样的东西

```
 String queryString= "NUMBER='" + msgs[i].getOriginatingAddress() + "'"; 
            Uri contacts = ContactsContract.CommonDataKinds.Phone.CONTENT_URI ;

            Cursor cursor = context.getContentResolver().query(
                       contacts,
                       null, queryString, null,
                       null
                       ); 
```

那我怎么去第一排呢？像这样？

```
cursor.getString(<how do i reference to the first row?>); 
```

对？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-03T00:11:53.097

试试这个 ：

```
 String strNumber= "7777777777"; 
 String queryString= "NUMBER='" + strNumber + "'"; 
 Uri contacts = ContactsContract.CommonDataKinds.Phone.CONTENT_URI ;

 Cursor cursor = context.getContentResolver().query(
            contacts,
            null, queryString, null,
            null
            ); 
```

希望这有帮助！

# ruby-on-rails - 迁移次要 Rails 版本

> ID：10866825
> 
> 赞同：13
> 
> 时间：2012-06-02T23:51:39.990
> 
> 标签：ruby-on-rails, ruby-on-rails-3

几周前，我使用 3.2.3 开始了一个新的 Rails 项目。今天我注意到 rails 3.2.4 和 3.2.5 已经发布了。我不想落后，那么将我的应用程序更新到 3.2.5 的最佳方法是什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-06-02T23:53:18.273

*   阅读发行说明。
*   编辑您的 Gemfile 并运行`bundle update`.
*   更新您的`.rvmrc`文件。*（选修的）*
*   运行你的测试。
*   根据需要重复。

需要注意的是，如果您没有在 Gemfile 中明确指定 gem 版本，您可能会更新 gem 并引入重大更改；由于我的 Gemfile 懒惰，我被这个咬了。

# ruby-on-rails - Ruby 中的日期选择

> ID：10866833
> 
> 赞同：0
> 
> 时间：2012-06-02T23:54:31.200
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我有在数据库中存储日期的要求。但我只想允许用户更改选择日期的日期。

就像他们只能选择 Monday ， Tuesday 等，并且基于此我想调整数据库中的日期。

为了满足要求，我正在尝试以下代码，但它正在抛出错误

```
<%= f.datetime_select :published_at.to_time.strftime("%a") %> 
```

以下是错误信息：

```
NoMethodError in Articles#new 

Showing C:/Users/huzaifa.gain/My Documents/Aptana Studio 3 Workspace/blog/app/views/articles/_form.html.erb where line #32 raised: 
undefined method `to_time' for :published_at:Symbol 

Extracted source (around line #32): 
29:   </div>
30:   <div class="field">
31:     <%= f.label :published_at %><br />
32:     <%= f.datetime_select :published_at.to_time.strftime("%a") %>
33:     <%= f.select :published_at, Date::DAYNAMES.zip((0..6).to_a) %> 
34: 
35: 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-03T03:37:13.917

尝试：

```
<%= f.datetime_select :published_at.to_strftime("%a") %> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T14:16:15.943

datetime_select 和其他表单助手是 formbuilder 对象上的方法。你需要考虑这个助手有什么选择。它似乎不支持 strftime。有关选项，请参阅[api 参考](http://api.rubyonrails.org/classes/ActionView/Helpers/DateHelper.html#method-i-datetime_select)。

# javascript - jQuery：新的临时 DOM 元素的内存管理

> ID：10866834
> 
> 赞同：0
> 
> 时间：2012-06-02T23:54:34.383
> 
> 标签：javascript, jquery, html, dom, garbage-collection

[假设我使用$(' *some html* ')](http://api.jquery.com/jQuery/#jQuery2)创建一个元素，如下所示：

```
var imgSrc = determineImageURL();
var myImg = $('<img>', { src: imgSrc })[0]; // Creates a new <img>. 
```

我的问题是：

*   谁是新元素的父元素？**文件**？**窗户**？没有任何？这对所有浏览器都一样吗？
*   假设我需要多次运行该代码，并且每次计算一个可能不同的**imgSrc**。当**myImg**更改或当前函数返回时，新元素是否会变成垃圾（并且可能会被收集）？或者我必须保留一个 <img> 并且只更改**src**属性？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-03T00:13:11.940

的父级`myImg`取决于您将其附加到的位置。仅给出您引用的代码，它没有。

如果您没有将节点附加到函数中的父节点，则新元素在函数返回时被垃圾收集。

声明的变量`var`只能在函数范围内生存，除非您创建对它的其他引用（附加到父级或在闭包中引用）。

# python - 如何防止错误的 StopIteration 被抓到？

> ID：10866838
> 
> 赞同：0
> 
> 时间：2012-06-02T23:55:32.750
> 
> 标签：python, iterator

有没有办法防止`StopIteration`不相关的代码抛出异常（无需手动捕获它们）？

示例：`loop_all`想要遍历`myiter`迭代器并在这个迭代器完成后继续前进。除非`some_dangerous_method`或任何其他代码`myiter`引发`StopIteration`.

```
def loop_all():
    myiter = myiter()
    try:
        while True:
            next(myiter) # <- I want exactly the StopIteration from this next method
    except StopIteration:
        pass

def myiter():
    some_dangerous_method() # what if this also raises a StopIteration?
    for i in some_other_iter():
        # here may be more code
        yield 
```

有没有办法明确`StopIteration`代码应该对哪个做出反应？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-03T00:02:46.633

如果您正在调用的函数正在调用 next(iter)，并且没有处理`StopIteration`，那么该函数有错误。修理它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-03T16:41:21.660

也许我错过了一些东西，但为什么不简单地这样做：

```
def myiter():
    try:
        some_dangerous_method()
    except StopIteration:
        pass # or raise a different exception
    for i in some_other_iter():
        # here may be more code
        yield 
```

# php - preg_replace 正则表达式标签未被替换

> ID：10866839
> 
> 赞同：1
> 
> 时间：2012-06-02T23:55:33.227
> 
> 标签：php, regex, preg-replace

希望你能提供帮助。正则表达式很新，虽然我写了这个正则表达式，但它似乎不匹配。我没有收到错误消息，所以我假设语法是正确的，但它只是没有被应用？

我希望正则表达式替换内容

> ***{foo}bar{/foo}*** 与 ***bar***

这是我的代码：

```
$regex = "#([{].*?[}])(.*?)([{]/.*?[}])#e";
$return = preg_replace($regex,"('$2')",$return); 
```

希望有人可以提供帮助。不知道为什么它似乎不起作用。

谢谢阅读。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-03T00:04:33.660

您的正则表达式[确实有效](http://codepad.org/bRjHx0u1)，但是它不够聪明，无法知道结束标记必须与开始标记相同。我会改用这个。我也简化了一点：

```
$regex = '#{([^}]*)}(.*?)\{/\\1}#';

echo preg_replace('{foo}bar{/foo}', '$2', $str); // outputs "bar" 
```

[**键盘**](http://codepad.org/rpWf0JDy)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-03T00:01:15.637

参考我上面的评论：

```
#(?:[{](.*?)[}])(.*?)(?:[{]/\1[}])# 
```

使用反向引用来保持标签相等。此外，我使用非捕获括号将无用的组排除在外：`$1`将是标签名称，`$2`将是标签内容。

请注意，如果您的标签可以嵌套，则必须多次应用替换。

# c# - Linq to SQL 检索单条记录的最快方法

> ID：10866849
> 
> 赞同：0
> 
> 时间：2012-06-02T23:56:48.583
> 
> 标签：c#, .net, linq-to-sql

以下两个查询之间是否存在性能差异？

```
CustomerProduct customerProduct = db.CustomerProducts.SingleOrDefault(p => object.Equals(p.Customer, this));

CustomerProduct customerProduct = (from p in db.CustomerProducts where object.Equals(p.Customer, this) select p).SingleOrDefault(); 
```

也许还有另一种，甚至更快？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-03T01:35:19.920

在编译方面，应该编译成相同的代码；Linq 只是编译器将为您解释的语法糖。话虽如此，并非所有 linq 查询都会按照您期望的方式编译，并且无论如何您都应该始终使用`ObjectQuery`cast +`ToTraceString`方法检查生成的 sql。

# javascript - 如何在Jquery中获取复选框的ID

> ID：10866850
> 
> 赞同：1
> 
> 时间：2012-06-02T23:56:56.173
> 
> 标签：javascript, jquery

我需要从每个选中的复选框中获取 id。现在我能够得到很好的总和，但我似乎无法得到每个 ID。

```
<input name="pay" class="pay_me" id="4" type="checkbox" value="6.00" />
<input name="pay" class="pay_me" id="5" type="checkbox" value="9.00" />
<input name="pay" class="pay_me" id="6" type="checkbox" value="3.00" />
<input name="pay" class="pay_me" id="9" type="checkbox" value="23.00" /> 
```

jQuery

```
$(document).ready(function() {
    $('.pay_me').change(

    function() {
        var t_payme = 0;
        $('.pay_me:checked').each(function() {
            t_payme += parseFloat($(this).val());
        });
        t_payme = parseFloat(t_payme).toFixed(2);
        $('#to_payme').val(t_payme);
    });
});​ 
```

有了这个我可以总结到我的文本框

```
<input name="to_payme" id="to_payme" type="text" value="0.00" /> 
```

我还需要在一个附加的文本框中像这样 4|6|9 的已检查 ID 号

```
<input name="ids_to_update" id="ids_to_update" type="text" value="" /> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-02T23:59:57.377

`this.id`您可以使用（或）获取元素 ID `$(this).prop("id")`。使用数组来存储 ID，如下所示：

```
$(document).ready(function() {
    $('.pay_me').change(function() {
        var t_payme = 0, checked = [];
        $('.pay_me:checked').each(function() {
            t_payme += parseFloat($(this).val());
            checked.push(this.id);
        });
        t_payme = t_payme.toFixed(2);
        $('#to_payme').val(t_payme);
        $('#ids_to_update').val(checked.join("|"));
    });
});​ 
```

**演示：http:** [//jsfiddle.net/rA5cv/](http://jsfiddle.net/rA5cv/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-03T00:00:22.087

干得好：

```
$(document).ready(function() {
    $('.pay_me').change(function() {
        var t_payme = 0, ids = [];
        $('.pay_me:checked').each(function() {
            ids.push(this.id);
            t_payme += parseFloat($(this).val());
        });
        t_payme = parseFloat(t_payme).toFixed(2);
        $('#to_payme').val(t_payme);
        $('#ids_to_update').val(ids.join('|'));
    });
}); 
```

[在 jsFiddle 上](http://jsfiddle.net/karalamalar/yyVDB/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-03T00:00:23.437

跟踪数组中的 ID：

```
var ids = [];
$('.pay_me:checked').each(function () { 
    t_payme += parseFloat($(this).val()); 
    ids.push($(this).attr("id"));
});

//now do something with the array of IDs... 
```

# python - 访问没有自我的实例

> ID：10866851
> 
> 赞同：-1
> 
> 时间：2012-06-02T23:57:02.797
> 
> 标签：python, twisted, self

我有以下代码。在 dataReceived 方法中，我试图访问表，但出现错误。如果我使用 self 并完成所有这些工作，它会起作用，但我不想使用 self。使用 self 对我的目的不起作用。我如何在不使用 self 的情况下仍然可以访问 table？

谢谢！

```
class Table:
    def __init__(self):
        self.players = []
        self.positions = []
        self.id = 0
        self.numberOfPlayers = 0

    def setID(self, _id):
        self.id = _id

    def setActivePlayer(self, player):
        player.countdown = 20
        while player.count > 0:
            print player.countdown
            time.sleep(1)
            player.countdown -= 1

            if player.countdown == 0:
                print "Out of time"

                moves.surrender(player)

class Socket(Protocol):
    table = Table()

    def connectionMade(self):
        #self.transport.write("""connected""")
        self.factory.clients.append(self)
        print "Clients are ", self.factory.clients

    def connectionLost(self, reason):
        self.factory.clients.remove(self)

    def dataReceived(self, data):
        #print "data is ", data
        a = data.split(':')
        if len(a) > 1:
            command = a[0]
            content = a[1]

            b = content.split(';')
            _UDID = b[0].replace('\n', '')

            if command == "Number_of_Players":
                if Socket.table.numberOfPlayers == 0:
                    msg = "%s:TableFound" % _UDID
                elif Socket.table.numberOfPlayers == 1:
                    msg = "%s:Table_Not_Found" % _UDID

        print msg

        for c in self.factory.clients:
                c.message(msg)

    def message(self, message):
        self.transport.write(message)

NUM_TABLES = 10

factories = [ ]
for i in range(0, NUM_TABLES):
    print i
    factory = Factory()
    factory.protocol = Socket
    factory.clients = []
    factories.append(factory)
    reactor.listenTCP(1025+i, factory)
    #print "Blackjack server started"

reactor.run() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-03T00:00:22.470

Try using `Socket.table` instead of `self.table` --

By the way: If the method is meant to be static, you can decorate it:

```
@staticmethod
def dataReceived(data): 
```

[EDIT]: According to the comment section below...

If you want the exact oppssite, you may move the line `table = Table()` to a newly introduced constructor in the `Socket` class:

```
def __init__(self, *args, **kwargs):
    self.table = Table()
    return super(Socket, self).__init__(*args, **kwargs) 
```

After that, you can safely use `self.table` in the `dataReceived` method. By the way, the `return super(Socket, self).__init__(*args, **kwargs)` line just ensures that any constructor of any ancestor class (e.g. `Protocol`) is called also.

# objective-c - 为什么我不能更新核心数据实体属性的布尔值？

> ID：10866852
> 
> 赞同：6
> 
> 时间：2012-06-02T23:57:06.930
> 
> 标签：objective-c, core-data, attributes, boolean

这真的让我很烦。在 Objective-C 中，我有一个`Item`带有布尔属性的实体`Deleted`。我希望能够将 的值设置`Deleted`为 YES 或 1。

这是我的代码：

```
NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] init];
NSEntityDescription *entity = [NSEntityDescription entityForName:@"Item" inManagedObjectContext:managedObjectContext];
[fetchRequest setEntity:entity];

NSString *itemID = [[fetchedObjects objectAtIndex:(int)[currentTable selectedRow]] valueForKey:@"ItemID"];
NSPredicate *predicate = [NSPredicate predicateWithFormat:@"ItemID = %@", itemID];
[fetchRequest setPredicate:predicate];

NSError *error = nil;
Item *objectToDelete = [[managedObjectContext executeFetchRequest:fetchRequest error:&error] objectAtIndex:0];
if (objectToDelete == nil) {
    NSLog(@"ERROR");
}

[fetchRequest release];

[objectToDelete setValue:[NSNumber numberWithBool:YES] forKey:@"Deleted"];

[managedObjectContext save:&error]; 
```

需要注意的是，我能够成功更改不同的属性；例如：我将字符串 -DEL 添加到`Item`的属性`Code`和`Name`. 当我查看数据表时，这些值的字符串会相应更新，但值`Deleted`仍然为 0。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-03T19:12:09.917

我强烈强烈建议为此属性使用不同的名称。`NSManagedObject`已经有与此名称密切相关的方法（特别是`-isDeleted`），这可能会导致与您的自定义属性名称发生冲突。正如[文档](http://developer.apple.com/library/mac/#documentation/Cocoa/Reference/CoreDataFramework/Classes/NSPropertyDescription_Class/NSPropertyDescription.html#//apple_ref/occ/cl/NSPropertyDescription)`NSPropertyDescription`所说：

> 请注意，属性名称不能与 NSObject 或 NSManagedObject 的任何无参数方法名称相同。例如，您不能为属性命名为“description”。NSObject 上有数百个方法可能与属性名称冲突——而且这个列表可能会在没有来自框架或其他库的警告的情况下增长。您应该避免使用非常笼统的词（例如“字体”和“颜色”）以及与 Cocoa 范例重叠的词或短语（例如“isEditing”和“objectSpecifier”）。

如果您将属性名称更改为不太可能与任何其他属性/方法名称冲突的名称，您的代码是否有效？

# javascript - JavaScript：在不重新加载页面的情况下更改语言

> ID：10866853
> 
> 赞同：2
> 
> 时间：2012-06-02T23:57:09.723
> 
> 标签：javascript

我正在我的网页中实现多语言支持。我想尽量减少页面重新加载引起的页面闪烁，我想在不强制重新加载整个页面的情况下更改页面语言。为了实现这一点，我想到的唯一可能的方法是使用 JavaScript：

1.  我用适当的翻译动态加载适当的语言 .js 文件
2.  我手动浏览页面上的每个文本对象并通过重新发送适当的新文本值来更新它

为了向您提供示例代码，我粘贴了一个仅更新提交按钮的代码。在语言更改时，我调用了一个动态加载适当的 .js 语言文件的函数。

```
var fileRef = LoadJsCssFile("Language/svk.js", "js", UpdateLanguage); 
```

语言 .js 文件完全加载后，我调用更新网页上每个包含文本的元素的函数：

```
function UpdateLanguage()
{
    var buttons = document.getElementsByClassName("submit_button");
    for (buttonID in buttons)
    {           
            buttons[buttonID].innerHTML = lang.SUBMIT;
    }                   
}; 
```

手动更新网页中的每个文本对象是复杂且容易出错的。由于我对 JavaScript 还不是很有经验，所以我在想，是否有一种方法可以用一个 JavaScript 命令简单地刷新网页中的所有关键元素，而不用让网页闪烁？

如果您有任何其他想法，如何在不闪烁页面的情况下有效地实现语言更改，我很想知道。:-)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T11:32:49.823

I found a solution on my own:

1.  I prepare several javascript language files containing strings per every keyword
2.  On language selection button, I import appropriate language file for the language I wish to use
3.  I manually update every text on the webpage through javascript.

The above solution is suitable for smaller sites. for large ones, that would be a lot of work, to update every single text string through javascript.

# javascript - 如何从 Chrome 扩展程序中读取 console.log

> ID：10866859
> 
> 赞同：0
> 
> 时间：2012-06-02T23:58:59.037
> 
> 标签：javascript, google-chrome, google-chrome-extension

我正在制作一个调试工具，其中一部分是 Chrome 扩展，它应该捕获 console.log 调用并通过 WebSocket 发送输出。

如何在内容页面中包装 console.log 以便将消息发送到后台脚本？以下不起作用：

```
function requestContent() {
    var code = [
        "var __console_log = window.console.log;",
        "function __sendSublime(msg) {",
            "chrome.extension.sendRequest(null, {",
                "method: 'send',",
                "data: msg",
            "});",
            "__console_log(msg);",
        "}",
        "window.console.log = __sendSublime;"].join('');
    chrome.tabs.executeScript(null, {code: code});
} 
```

我从后台脚本调用这个函数。

# sql - SQL从联合结果合并行并计算

> ID：10866860
> 
> 赞同：2
> 
> 时间：2012-06-02T23:59:08.623
> 
> 标签：sql, group-by, union

我对 SQl 很陌生这是我的要求。

```
TableA 
operation route measurement
A         No    200
A         Yes   300
B         No    400
B         Yes   500 
```

我想要这个**结果**

```
Operation MeasurementNo  MeasurementYes  MeasureDifference
A         200            300             100
B         400            500             100 
```

所以必须对操作字段进行分组。同时，操作测量的两个值必须合并到一行。

`The MeasureDifference = MeasurementYes - MeasurementNo`.

用SQL实现它看起来并不难，但我只是一个新手。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-03T00:08:23.697

或者使用分组和条件聚合：

```
SELECT
  operation,
  SUM(CASE route WHEN 'No'  THEN measurement END) AS MeasurementNo,
  SUM(CASE route WHEN 'Yes' THEN measurement END) AS MeasurementYes,
  SUM(CASE route WHEN 'Yes' THEN measurement END)
  - SUM(CASE route WHEN 'No'  THEN measurement END) AS MeasurementDifference
FROM atable t
GROUP BY
  operation 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-03T00:03:38.223

使用连接：

```
SELECT
    MNo.operation AS Operation,
    MNo.measurement AS MeasurementNo,
    MYes.measurement AS MeasurementYes,
    MYes.measurement - MNo.measurement AS MeasureDifference
FROM TableA AS MNo
JOIN TableA AS MYes
ON MNo.operation = MYes.operation
AND MNo.route = 'No'
WHERE MYes.route = 'Yes' 
```

# java - 在 C++ 或 Java 中有没有办法获得 CPU 使用率？

> ID：10866861
> 
> 赞同：0
> 
> 时间：2012-06-02T23:59:10.557
> 
> 标签：java, c++, cpu-usage

我想编写一个小程序，以将 CPU 使用率显示为百分比，就像任务管理器一样。我知道中级 C++ 和 Java。有没有办法用这两种语言做到这一点？如果是这样，也许是一个简短的例子？我看到了一些 C++ 命令的页面，但我无法理解它。

我在一台计算机上使用 Windows 7，在另一台计算机上使用 XP。至于多核响应，我只想像任务管理器一样显示 CPU 使用百分比，即使是多核处理器。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-03T00:18:24.707

```
double sysLoad = ManagementFactory.
                         getOperatingSystemMXBean().
                                 getSystemLoadAverage(); 
```

*   不适用于每个平台，
*   返回过去一分钟的平均负载

编辑：最近发现了这个

[http://sellmic.com/blog/2011/07/21/hidden-java-7-features-cpu-load-monitoring/](http://sellmic.com/blog/2011/07/21/hidden-java-7-features-cpu-load-monitoring/)

在 Java 7 中，您可以使用**com.sun.management**包来获取进程负载或系统负载。

用法：

```
OperatingSystemMXBean osBean = ManagementFactory
        .getPlatformMXBean(com.sun.management.OperatingSystemMXBean.class);  

// What % CPU load this current JVM is taking, from 0.0-1.0  
System.out.println(osBean.getProcessCpuLoad());  

// What % load the overall system is at, from 0.0-1.0  
System.out.println(osBean.getSystemCpuLoad()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-03T00:12:42.860

“windows.h”中提供了一些系统调用函数，如GetProcessorInfo()、CallNTPowerInformation()、GetTickCount()、QueryPerformanceFrequency()、QueryPerformanceCounter()等。你可以用谷歌搜索它们，或者在 MSDN 中找到它们。我希望这个答案可以帮助你。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-03T00:16:36.977

答案将是特定于平台的，并且在 Java 和 C++ 案例之间有所不同。在某种程度上，您需要与特定于操作系统的 API 交互以提取统计信息。有四种可能的方法：

*   调用适当的外部系统监控命令（特定于系统）并“抓取”命令的输出。您可以从 Java 或 C++ 执行此操作。

*   在 C++ 中（或在 Java 中使用 JNI / JNA ...

*   在 Java 中，使用一些现有的 3rd-party 库来处理系统特定的 JNI/JNA 内容。可能的例子包括 JavaSysMon 和 SIGAR ......虽然我不能提出具体的建议。

*   您可以使用 Java 监控 API……但它们没有提供足够的信息。您可以获取有关*此*进程资源使用情况和总体平均负载的信息，但无法获取有关*其他*进程的信息。

现在上述所有问题（可能除了最后一个）的问题是移植到新平台需要工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-03T00:11:02.153

CPU 使用率是操作系统属性，而不是语言属性。检索它的方式将特定于您正在使用的操作系统（您无法识别）。

此外，“CPU 使用率”不再是一个非常模糊的术语，具有多个内核等。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-03T00:11:14.373

在 Java 中，您可以使用[JavaSysMon](https://github.com/jezhumble/javasysmon/wiki)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-03T03:52:46.007

假设您使用的是 Windows 系统，则可以使用 Windows Management Instrumentation (WMI)。一旦你开始工作，它就很强大。我从来没有用Java做过。当然，使用 C# .NET 会更容易。一个好的链接是[WMI 信息](http://www.vijaykandy.com/2009/09/windows-management-instrumentation-wmi-from-java/)

如果你试试这个，请告诉我。我可能有兴趣帮助你，因为这也是我的兴趣。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-06-03T03:58:42.043

如果您使用的是 Linux 系统，请考虑使用 shell 脚本，例如 bash。原因是 shell 脚本对于操作系统调用非常强大，例如获取进程 ID 和使用情况（pid 命令）。与 Java 或 C++ 相比，IT 技术人员更喜欢使用 bash 脚本。

# javascript - 函数不读取对象

> ID：10866862
> 
> 赞同：0
> 
> 时间：2012-06-02T23:59:40.863
> 
> 标签：javascript, jquery, json, object

有人可以告诉我如何让发送函数从下一个代码中读取电子邮件对象吗？

```
var email = {
    to: 'google@gmail.com',
    subject: 'new email',
    text: 'helloWorld'
}

function send() {
    var sendMe = new email();
    console.log(sendMe.subject);

}
send();​ 
```

我收到此错误我还尝试将电子邮件声明如下：

```
var email = new object(); 
```

它没有用

```
Uncaught TypeError: object is not a function 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-03T00:03:31.213

You are either trying to do this:

```
var email = { to: 'google@gmail.com', subject: 'new email', text: 'helloWorld' }

function send()
{
    console.log(email.subject);
}

send(); 
```

Or this

```
function email()
{
    this.to = 'google@gmail.com';
    this.subject = 'new email';
    this.text = 'helloworld';
}

function send()
{
    var sendMe = new email();
    console.log(sendMe.subject);
}

send(); 
```

I'm not sure which, so I made an example of both. Cheers

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-03T00:03:21.770

It sounds like you want `sendMe` to point at the same data `email` is holding:

```
var email = { ...} ;
function send() {
   var sendMe = email;
   console.log(sendMe.subject);
} 
```

But if this is the case, you might as well skip the extra variable and just use `email` directly:

```
var email = { ...} ;
function send() {
   console.log(email.subject);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-03T00:04:02.730

You can't use an identifier as an object constructor unless it's a function.

If you want a reference to the object that you created, just copy it from the variable:

```
var sendMe = email; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-03T00:04:18.903

You have to return object:

```
var email = function() {
    return {
        to: 'google@gmail.com',
        subject: 'new email',
        text: 'helloWorld'
    }
}; 
```

and then

```
function send() {
    var sendMe = new email();
    console.log(sendMe.subject);
} 
```

should work.

# clojure - what is noir.server/start option :ns for?

> ID：10866863
> 
> 赞同：3
> 
> 时间：2012-06-02T23:59:43.357
> 
> 标签：clojure, noir

What is the `:ns` key for the option map supplied to `noir.server/start` used for? I see that if you leave out `:ns` a randomly generated symbol is used. From looking through the Noir source I could not find anywhere where this symbol is used. Does anyone know if this is currently being used for something / if there are plans for this key?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-03T07:12:12.283

在 Noir 源代码中查看[此文件。](https://github.com/ibdknox/noir/blob/master/src/noir/exception.clj)这提供了一个处理异常的中间件 -`wrap-exceptions`此文件中的代码使用`:ns`选项来解析异常并在具有此`:ns`键的映射对象中获取堆栈跟踪数据。

# php - 在 url 中隐藏值

> ID：10866874
> 
> 赞同：0
> 
> 时间：2012-06-03T00:01:48.307
> 
> 标签：php, parameter-passing, captcha

我需要将值 'key' 传递给 securitycode.php 文件。这是我当前的代码。

```
http://mydomain.com/securitycode.php?key=12345678 
```

但我不希望通过 url 访问键值（它通过浏览器的“查看页面源”功能可见，这意味着垃圾邮件机器人也可以轻松访问它）。既然是为了安全，那它就毫无意义了。（用于验证码。）

如何在不使用 url 的情况下传递值？

我不能将 post 方法与 form 一起使用，因为它已经是另一种形式了。我想我可以将值保存在会话中，但我想知道是否有其他更简单的方法不使用会话。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-03T00:04:55.917

如果您正在使用验证码，则密钥应存储在会话变量中，并且根本不与浏览器共享。

```
session_start();
// ...
$_SESSION['key'] = "123456789"; 
```

# .net - Verify data in a sqlite database hasn't been modified by anyone else (i.e sign the data)

> ID：10866875
> 
> 赞同：2
> 
> 时间：2012-06-03T00:01:50.563
> 
> 标签：.net, sqlite, system.data.sqlite

I am using a SqlLite database, and I would like to ensure that the data has not been modified outside the application. (sign the data)

Does sqlite keep a last modified date of the data?

I was thinking about using the Windows last modified file date, but that is my second choice. I was hoping sqlite would have a way to tell me either a hash of the data or a timestamp of the last data modified.

One option is to calculate a hash of all the contents of the bytes of the database file, this would allow me to guarantee that the file hasn't been modified by anyone. But this is expensive and I am hoping to find a better way to verify no external sources modified the database.

Another option is to encrypt the database, but this is not ideal because we want 3rd parties to be able to read the data, just not to modify it.

Note that I am accessing the database using System.Data.Sqlite in a WPF .net client application on Windows 7.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-03T01:33:08.847

我认为您对此无能为力。在第一道防线中，您可以放置​​一些触发器

```
CREATE TRIGGER before_ins_on_table1 BEFORE INSERT ON table1
BEGIN SELECT RAISE( FAIL, 'Not allowed.' ) ; END;

CREATE TRIGGER before_del_on_table1 BEFORE DELETE ON table1
BEGIN SELECT RAISE( FAIL, 'Not allowed.' ) ; END;

CREATE TRIGGER before_upd_on_table1 BEFORE UPDATE ON table1
BEGIN SELECT RAISE( FAIL, 'Not allowed.' ) ; END; 
```

但...

您可以对数据库进行数字签名或在程序中嵌入 SHA1 哈希，如果哈希不匹配，则使其拒绝使用数据库，但这通常是无用的。

简而言之，如果数据库是可读的，那么您无法阻止有足够动机篡改它的人。攻击者可以简单地转储然后在新数据库中恢复数据而不受限制。

# statechart - Automatic scxml code synthesis for statechart models

> ID：10866876
> 
> 赞同：2
> 
> 时间：2012-06-03T00:01:51.847
> 
> 标签：statechart, scxml

Can the [w3c scxml specs](http://www.w3.org/TR/scxml/) be considered under model driven development? i.e statecharts as models for scxml which can be autogenerated using a tool instead of hand coding them. I'm looking for such a tool for tablet GUI interactions.

David Harel's tools generated c/c++ code from statechart of system behavior. IBM Statemate(ilogix Statemate Magnum) for hardware statecharts and IBM Rhapsody for embedded software statecharts.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-23T00:45:06.623

这可能很合适：[https ://github.com/jbeard4/SCION](https://github.com/jbeard4/SCION)

它是 JavaScript 中的 SCXML 实现。它可以用于 Web UI 开发（这是它的最初目的），或者嵌入到许多其他编程语言/运行时。

免责声明：我是作者。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-03T10:57:45.213

您可以尝试 QT 状态图编辑器，您可以在其中设计状态并添加自定义 java 脚本代码。QT 框架具有状态图执行引擎，您可以通过它在 c++ 应用程序中运行状态图，而无需任何特定的状态图/模型代码。

我正在寻找相同工具的替代品，但用于 c# 集成。

[http://doc.qt.nokia.com/4.7-snapshot/statemachine-api.html](http://doc.qt.nokia.com/4.7-snapshot/statemachine-api.html)

# php - preg_match_all 匹配锚链接中的字符串，不包括“<”和“>”字符

> ID：10866877
> 
> 赞同：0
> 
> 时间：2012-06-03T00:01:58.723
> 
> 标签：php, regex, preg-match-all

我需要 preg_match_all 来匹配如下内容：

```
<a href="cart.php?Stock=11.482&qty=1">Buy</a> 
```

我正在使用的代码：

```
preg_match_all("'Stock=[^><]&qty=1\">Buy</a>'si", $source, $matches); 
```

我需要它来匹配之前`&qty=1">Buy</a>`和之后的所有内容`<a href="cart.php?Stock=`，*除了`<`or`>`字符*。但是，以下代码不起作用。有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-03T00:09:45.743

在你的正则表达式上进一步构建你只需要在字符类之后添加一个 *

```
Stock=[^><]*&qty=1\">Buy</a> 
```

如果要匹配数字 11.482 添加括号，以便组 1 包含此数字

```
Stock=([^><]*)&qty=1\">Buy</a> 
```

# google-app-engine - 谷歌应用引擎中self.response.write和self.response.out.write的区别

> ID：10866879
> 
> 赞同：15
> 
> 时间：2012-06-03T00:02:33.283
> 
> 标签：google-app-engine

google app engine`self.response.write`和in有什么区别？`self.response.out.write`

谢谢

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-06-03T14:39:53.950

没有区别。出于兼容性原因，
webapp 使用`self.response.out.write`和 webapp2`self.response.write`保留。 这里是类的实现：[http ://code.google.com/p/webapp-improved/source/browse/webapp2.py#365](http://code.google.com/p/webapp-improved/source/browse/webapp2.py#365)`out`
`Response`

# iphone - Dropbox Display File Modification Date

> ID：10866883
> 
> 赞同：0
> 
> 时间：2012-06-03T00:03:09.957
> 
> 标签：iphone, ios, ipad, dropbox, dropbox-api

I have an iOS app where I am trying to display a list images found in a Dropbox folder, along with their modification date, in a table. The result would look something like this: ![Dropbox file list with modification date](../Images/5dcb3dce7b5495e22631843edd955822.png)

The following is successful in retrieving the file list, but I am stuck on getting file attributes as described in the [Dropbox metadata API](https://www.dropbox.com/developers/start/files#python). I've tried several different ways to get this, as well as different properties. I get an error even before building.: Property 'modified' not found on object of type 'DBMetadata *'

```
- (void)restClient:(DBRestClient*)client loadedMetadata:(DBMetadata*)metadata {
    NSArray* validExtensions = [NSArray arrayWithObjects:@"jpg", @"jpeg", nil];
    NSMutableArray* newPhotoPaths = [NSMutableArray new];
    NSMutableArray* fileModified = [[NSMutableArray alloc] init];
    for (DBMetadata* child in metadata.contents)
    {
        NSString* extension = [[child.path pathExtension] lowercaseString];
        if (!child.isDirectory && [validExtensions indexOfObject:extension] != NSNotFound)
        {
            [newPhotoPaths addObject:child.path];
            NSLog(@"\t%@", newPhotoPaths);
            //[fileModified addObject:child.modified]; // Error
            //NSLog(@"%@", fileModified)
        }
    }
} 
```

Suggestions greatly appreciated. Thanks.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-03T04:45:08.260

我相信是的`lastModifiedDate`。

# c++ - Why is the recursive version of this function faster?

> ID：10866889
> 
> 赞同：7
> 
> 时间：2012-06-03T00:03:49.220
> 
> 标签：c++, c++11, compiler-optimization

Here is a simple class for iterating over a multidimensional numeric range:

```
#include <array>
#include <limits>

template <int N>
class NumericRange
{
public:
  //  typedef std::vector<double>::const_iterator const_iterator;
  NumericRange() {
    _lower.fill(std::numeric_limits<double>::quiet_NaN());
    _upper.fill(std::numeric_limits<double>::quiet_NaN());
    _delta.fill(std::numeric_limits<double>::quiet_NaN());
  }
  NumericRange(const std::array<double, N> & lower, const std::array<double, N> & upper, const std::array<double, N> & delta):
    _lower(lower), _upper(upper), _delta(delta) {
    _state.fill(std::numeric_limits<double>::quiet_NaN());
    _next_index_to_advance = 0;
  }

  const std::array<double, N> & get_state() const {
    return _state;
  }

  void start() {
    _state = _lower;
  }

  bool in_range(int index_to_advance = N-1) const {
    return ( _state[ index_to_advance ] - _upper[ index_to_advance ] ) < _delta[ index_to_advance ];
  }

  void advance(int index_to_advance = 0) {
    _state[ index_to_advance ] += _delta[ index_to_advance ];
    if ( ! in_range(index_to_advance) ) {
      if (index_to_advance < N-1) {
    // restart index_to_advance
    _state[index_to_advance] = _lower[index_to_advance];

    // carry
    index_to_advance;
    advance(index_to_advance+1);
      }
    }
  }

private:
  std::array<double, N> _lower, _upper, _delta, _state;
  int _next_index_to_advance;
};

int main() {
  std::array<double, 7> lower{0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0};
  std::array<double, 7> upper{1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0};
  std::array<double, 7> delta{0.03, 0.06, 0.03, 0.06, 0.03, 0.06, 0.03};

  NumericRange<7> nr(lower, upper, delta);
  int c = 0;
  for (nr.start(); nr.in_range(); nr.advance()) {
    const std::array<double, 7> & st = nr.get_state();
    ++c;
  }
  std::cout << "took " << c << " steps" << std::endl;

  return 0;
} 
```

When I replace the `advance` function with a non-recursive variant, the runtime *increases*:

```
void advance(int index_to_advance = 0) {
  bool carry;
  do {
    carry = false;
    _state[ index_to_advance ] += _delta[ index_to_advance ];
    if ( ! in_range(index_to_advance) ) {
      if (index_to_advance < N-1) {
    // restart index_to_advance
    _state[index_to_advance] = _lower[index_to_advance];

    // carry
    ++index_to_advance;
    carry = true;
    //    advance(index_to_advance);
      }
    }
  } while (carry);
} 
```

Runtimes were taken using unix user time via the command `time`. The code was compiled using gcc-4.7 with options `-std=c++11 -O3` (but I think it should work with `c++0x` on gcc-4.6). The recursive version took 13s and the iterative version took 30s. Both require the same number of `advance` calls to terminate (and if you print the `nr.get_state()` array inside the `for(ns.start()...)` loop, both do the same thing).

This is a fun riddle! Help me figure out why recursive would be more efficient / more optimizable.

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-03T01:10:26.017

递归版本是*尾递归*的一个例子，这意味着编译器可以将递归转换为迭代。现在，一旦执行了转换，递归函数将如下所示：

```
void advance(int index_to_advance = 0) {
    _state[ index_to_advance ] += _delta[ index_to_advance ];
    while ( !in_range(index_to_advance) && index_to_advance < N-1 ) {
        // restart index_to_advance
        _state[index_to_advance] = _lower[index_to_advance];

        // carry
        ++index_to_advance;
        _state[ index_to_advance ] += _delta[ index_to_advance ];
    }
  } 
```

如您所见，您的版本包含一个额外的测试和条件变量。循环，如果你仔细观察，相当于

```
for( ; index_to_advance < N-1 && !in_range(index_to_advance);++index_to_advance) 
```

（最后删除`++index_to_advance`），优化器可能有更好的机会展开它。

话虽如此，我认为这并不能解释巨大的时间差异，尽管它确实解释了为什么递归版本并不比迭代版本慢很多。检查生成的程序集以查看编译器实际做了什么。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-03T01:22:44.387

只是为大卫罗德里格斯所说的添加更多细节：

通过尾递归优化，函数变为：

```
 void advance(int index_to_advance = 0) {
  top:
  _state[ index_to_advance ] += _delta[ index_to_advance ];
  if ( ! in_range(index_to_advance) ) {
    if (index_to_advance < N-1) {
      // restart index_to_advance
      _state[index_to_advance] = _lower[index_to_advance];

      // carry
      ++index_to_advance;
      goto top;
    }
  }
} 
```

这确实与我系统上的递归版本具有相同的性能（g++ 4.6.3 -std=c++0x）

# c++ - 关于 c++ 函数重载的困惑

> ID：10866895
> 
> 赞同：1
> 
> 时间：2012-06-03T00:04:59.353
> 
> 标签：c++, function, overloading, default, arguments

我通过编译以下代码在 C++ 中尝试了默认参数值和函数重载，我对以下输出感到惊讶：

```
Line 19: error: call of overloaded 'add()' is ambiguous 
```

我编译的代码是：

```
#include <iostream>

using namespace std;

void add(int a=1, int b=1){

cout<<a+b;
}

void add(){

int a =2, b=2;
cout<<a+b;
}

int main(){

add();

return 0;
} 
```

任何解释为什么它是模棱两可的？提前谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-03T00:05:37.710

因为两个签名都匹配调用。

```
add(); 
```

可以解释为`add(1,1)`或`add()`。当你写的时候`void add(int a=1, int b=1)`，你是在告诉编译器—— *“听着，如果我`add`不带参数调用，我希望你把它们默认为`1`”*

最重要的是，当您不带参数调用时，**您**期望发生什么？`add()`

*   如果您希望它打印`2`，请删除不带参数的版本。

*   如果您希望它打印`4`，请从第一个版本中删除默认参数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-03T00:11:57.230

```
void add(int a, int b);
void add(); 
```

你不应该给出`a`默认`b`值。使用默认值，编译器无法知道调用是否`add()`应该使用第一个或第二个函数。

您是否有理由需要提供`a`默认`b`值？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-03T01:55:32.727

重载解决方案由 C++ 标准（至少[C++03](http://en.wikipedia.org/wiki/C++03)和[C++11](http://en.wikipedia.org/wiki/C++11)）的第 13.3 节定义。分为三个部分：

1.  确定候选函数，
2.  从候选函数中确定可行函数，
3.  选择最佳可行函数。

## 候选函数

由于`add`命名了一个函数（而不是一个对象），第 13.3.1.1.1 节定义了如何确定候选函数。由于`add`不合格（不包含`.`或`->`运算符），适用第 3 条（取自C++11 的[n3337 草案）：](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2012/n3337.pdf)

> 在不合格的函数调用中，名称不是由 -> 或 限定的。运算符，并且具有更一般的主表达式形式。按照函数调用中名称查找的常规规则 (3.4) 在函数调用的上下文中查找名称。通过该查找找到的函数声明构成候选函数集。由于名称查找的规则，候选函数集由 (1) 完全由非成员函数或 (2) 完全由某个类 T 的成员函数组成。在情况 (1) 中，参数列表与调用中的表达式列表。[...]

简而言之，候选函数是在函数调用上下文中通过标准名称查找找到的函数。名称查找在第 3.4 节中定义。通常，第 3.4.2 节（与参数相关的名称查找）会找到额外的候选函数，但所讨论的函数调用中没有参数，因此只有第 3.4.1 节很重要。特别是第 6 条：

> *在函数的declarator-id*之后的函数定义中使用的名称是命名空间 N 的成员（其中，仅出于说明的目的，N 可以表示全局范围）应在其用于其中的块之前声明它被使用或在其封闭块之一（6.3）中使用，或者应在其在命名空间 N 中使用之前声明，或者，如果 N 是嵌套命名空间，则应在其在 N 的封闭命名空间之一中使用之前声明。

简而言之，搜索当前命名空间和任何父命名空间，并且只考虑已经声明的函数。在示例代码中，之前`main`在全局命名空间中声明的名称为 的任何函数`add`都是候选函数：`add(int, int)`和`add()`。如果您要在`add(float, float)`之后声明（例如）一个函数`main`，它就不是候选函数。

## 可行的功能

§ 13.3.2：

> 2 首先，要成为一个可行的函数，候选函数应有足够的参数以在数量上与列表中的参数一致。
> 
> *   如果列表中有 m 个参数，则所有具有恰好 m 个参数的候选函数都是可行的。
> *   具有少于 m 个参数的候选函数只有在其参数列表中有省略号时才可行（8.3.5）。出于重载决议的目的，任何没有相应参数的参数都被认为是“匹配省略号”（13.3.3.1.3）。
> *   仅当 (m+1)-st 参数具有默认参数 (8.3.6) 时，具有多于 m 个参数的候选函数才是可行的。出于重载决议的目的，参数列表在右侧被截断，因此正好有 m 个参数。
> 
> 3 其次，为了使 F 成为一个可行的函数，每个参数都应存在一个*隐式转换序列*(13.3.3.1)，将该参数转换为 F 的相应参数。如果参数具有引用类型，则隐式转换序列包括绑定引用的操作，以及对非 const 的左值引用不能绑定到右值以及右值引用不能绑定到左值的事实会影响函数的可行性（参见 13.3.3.1.4）。

参数列表有 0 个参数。`add()`有 0 个参数，所以它是可行的。`add(int, int)`有 2 个参数，但第一个有一个默认参数，所以它是可行的。由于调用中没有参数，因此第 3 条中的转换不会起作用，但了解该子句很重要，特别是当它指出声明为的函数`int foo(int&)`不能绑定到函数调用时`foo(0)`，因为[非常量引用](https://stackoverflow.com/q/710807/90527)（例如`int&`）不能绑定到右值（例如文字 0）。但是，`int foo(const int&)`可以绑定到`foo(0)`.

## 最佳功能

[§ 13.3.3](http://en.wikipedia.org/wiki/Partially_ordered_set)定义了一个函数在名称解析方面如何被认为比另一个函数“更好” ：

1.  某些转换比其他转换“更好”（第 13.3.3.2 节），使用更好的参数转换的函数是更好的函数。
2.  如果 1 不能确定更好的函数，则非模板函数优于模板函数。
3.  如果 2 不能确定更好的函数，那么一个比另一个更特化的函数模板特化更好（“更特化”是第 14.5.6.2 节中定义的偏序）。

由于没有参数，因此不能使用标准 1。也不`add()`是`add(int,int)`模板，所以 2 和 3 都不能使用。简而言之，没有一个功能比另一个更好。

最后，§ 13.3.3 2 确定最终结果：

> 如果恰好有一个可行函数比所有其他可行函数更好，那么它就是重载决议选择的那个；否则调用格式不正确。

由于示例代码中有两个可行的函数，因此调用格式不正确。

# ruby-on-rails - Heroku：推送被拒绝 - 无法通过捆绑器安装 gem

> ID：10866900
> 
> 赞同：6
> 
> 时间：2012-06-03T00:06:01.383
> 
> 标签：ruby-on-rails, heroku

我尝试以与以往相同的方式将应用程序推送到 Heroku。我正在使用 Ruby 1.9.2 和 Rails 3.2.1。但是，现在我收到此错误消息。我做了它推荐的

```
make sure that `gem install sqlite3 -v '1.3.5'` succeeds before bundling. 
```

请注意，即使我在我的 gemfile 中这样做了，它也会这样做

```
group :development, :test do
  gem 'sqlite3'
end
group :production do
  gem 'pg'
end 
```

但`gem install sqlite3 -v '1.3.5'`在终端做，但推送仍然被拒绝。我不确定如何检查它在 tmp 目录中引用的 Gem 文件，但即使我这样做了，我也不会理解它们

有什么建议么？

```
Gem files will remain installed in /tmp/build_1timyd7o5k59l/vendor/bundle/ruby/1.9.1/gems/sqlite3-1.3.5 for inspection.
       Results logged to /tmp/build_1timyd7o5k59l/vendor/bundle/ruby/1.9.1/gems/sqlite3-1.3.5/ext/sqlite3/gem_make.out
       An error occurred while installing sqlite3 (1.3.5), and Bundler cannot continue.
       Make sure that `gem install sqlite3 -v '1.3.5'` succeeds before bundling.
 !
 !     Failed to install gems via Bundler.
 !
 !     Heroku push rejected, failed to compile Ruby/rails app 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-03T03:16:12.227

我总是只注释掉 SQLite3 gem，它对我很有效，所以当我推送到 heroku 时，我的 gemfile 看起来像这样：

```
# Development Database
#gem 'sqlite3'
# Production Database
gem 'pg' 
```

编辑：

上述解决方案有效，如果您出于某种原因不想更新 gem，这很容易。解决此问题的更好的长期解决方案是执行以下操作：

```
group :development, :test do
  gem 'sqlite3'
end
group :production do
  gem 'pg'
end 
```

然后删除你的`gemfile.lock`文件。您需要生成一个`gemfile.lock`反映您的更改的新文件。在终端运行：

```
bundle update 
```

最后，通过在终端中执行以下操作来更新您的存储库并推送到 heroku：

```
git add .
git commit -m "commit message"
git push heroku 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-22T03:36:14.427

实际上，如果您想在本地使用 sqlite3，那么您的初始 Gemfile 代码是正确的。就像你展示的那样，你把它放在 gem 文件中：

```
group :development, :test do
  gem 'sqlite3'
end
group :production do
  gem 'pg'
end 
```

那么你必须删除你本地的 Gemfile.lock，然后运行：

```
bundle update 
```

重新构建 .lock 文件。然后添加并重新提交 Gemfile：

```
git add Gemfile
git commit -m "Gemfile commit message" 
```

然后将新的 Gemfile 推送到 repo：

```
git push master 
```

当然，相应地更改 GIT 详细信息，但你明白了。这都是关于添加/提交/推送 Gemfile 的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-03T00:26:32.363

据我所知，Heroku 不支持 sqlite3，而是使用 PostgreSQL 数据库。你需要修改你的 Gemfile 和你的 database.yml。因此，对于您的生产组，在您的 Gemfile 中，您需要：

[https://devcenter.heroku.com/articles/rails3](https://devcenter.heroku.com/articles/rails3)

编辑：

这里似乎有更详细的答案，所以这可能是重复的：[Pushing Rails with SQLite3 to Heroku failed](https://stackoverflow.com/questions/3747002/heroku-rails-3-and-sqlite3)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-02-06T15:33:59.420

您必须将更新的 Gemfile.lock 添加到 git 并尝试 git push heroku master ...它对我有用，并且肯定对您也有用

并且不要忘记添加 `config.action_controller.perform_caching = true`

# delphi - How do I retrieve a complete HTTP response from a web server including response body using an Indy TIdTCPClient instance?

> ID：10866902
> 
> 赞同：3
> 
> 时间：2012-06-03T00:06:39.073
> 
> 标签：delphi, http, sockets, indy, rfc

I have a Delphi 6 application that uses an Indy **TIdTCPClient** instance to communicate with a web server. The reason I am not using an HTTP client directly is because the the server is an image streaming server that uses the *same* socket connection for receiving the command to start streaming as it does to start "pushing" images back to you. In other words, after you send it a typical HTTP POST request, it replies with an HTTP response, and immediately after that it starts sending out a stream of JPEG images.

I already know how to craft a proper POST request and send it using the TIdTCPClient **WriteBuffer()** method and then use the **ReadBuffer()** method to receive reply data. What I'd like to do instead is to send a POST request and then ask Indy to wait for a typical HTTP response including retrieving all the bytes in the response body if there is a **Content-Length** header variable. I of course want it to leave the JPEG frames intact that may have piled in after the HTTP response in the receive queue until I start requesting them (that is, I don't want it including any of the JPEG frames in the HTTP response to my streaming request command until I ask for them using a successive read call).

Is there a method that I can call on a TIdTCPClient that will retrieve completely a typical HTTP response with body content, and nothing else? I thought about using **SendCmd()** and checking the **LastCmdResult** property (type: *TIdRFCReply*) for the response, but I can't tell from the Indy documentation if it retrieves the response body content too if there is a **Content-Length** header variable as part of the response it returns, nor can I tell if it leaves the rest of the receive queue after the response intact.

What is the best way to accomplish this mixed mode interaction with an HTTP web server that pushes out a stream of JPEG frames right after you make the HTTP request to start streaming?

Also, if there is a clever way to have Indy split the frames using the JPEG frame WINBONDBOUDARY delimiting string, rather than accumulating blocks of data and parsing them out myself, please share that technique.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T00:55:11.907

读取 HTTP 响应的**正确**方法是首先逐行读取以 CRLF 分隔的响应标头，直到遇到空行，即 CRLF+CRLF 序列，然后您可以使用这些标头来决定如何读取剩余的响应数据。标头不仅会告诉您正在发送哪种流（通过`Content-Type`标头），还会告诉您数据是如何被构建的（`Content-Length`, `Transfer-Encoding: chunked`，特定于特定的东西`Content-Type`等）。

要接收标头，您可以使用连接的`Capture()`方法，将其`ADelim`参数设置为空字符串。

之后如何读取剩余数据取决于流的实际格式/框架。在不确切知道您正在接收什么样的流的情况下，没有办法建议您如何最好地阅读它，因为 HTTP 服务器使用了几种不同类型的流协议，其中大多数都没有标准化。提供该信息，然后我/我们可以向您展示如何使用 Indy 实现它。

您不能使用`SendCmd()`HTTP 协议，因为它没有以与该方法兼容的方式格式化其响应。

# debugging - How to debug test in vows nodejs?

> ID：10866903
> 
> 赞同：4
> 
> 时间：2012-06-03T00:06:39.760
> 
> 标签：debugging, testing, vows

How to debug vows test?

I was thinking to make an html reporter for the tests and run tests in the browser, but I really don't know how and where to start.

If there are better workarounds I'm happy to hear, thanks ;) code from my reporter

```
this.print = function (str) {
    util.print(str);
};

function removeCircularSuite(obj, suite) {
    var result = {};

    if (typeof obj !== 'object' || obj === null) return obj;

    Object.keys(obj).forEach(function(key) {
        if (obj[key] === suite) {
            result[key] = {};
        } else {
            result[key] = removeCircularSuite(obj[key], suite || obj.suite);
        }
    });

    return result;
};

this.report = function (obj) {
    this.i++;
    console2.log(this.i);
    puts(JSON.stringify(removeCircularSuite(obj)));
}; 
```

but this is ran twice so the output it's:

```
1
1
{"0":"subject","1":"insert worker"}
2
{"0":"subject","1":"insert worker"}
{"0":"context","1":"insertWorker"}
2
{"0":"context","1":"insertWorker"}
3
{"0":"vow","1":{"title":"find worker in the database","context":"insertWorker","status":"broken","exception":"\u001b[33mfound multiple records with the same _id\u001b[39m\u001b[90m // services.insertWorker.test.js:25\u001b[39m"}}
3
{"0":"vow","1":{"title":"find worker in the database","context":"insertWorker","status":"broken","exception":"\u001b[33mfound multiple records with the same _id\u001b[39m\u001b[90m // services.insertWorker.test.js:25\u001b[39m"}}
4
{"0":"end"}
5
4
{"0":"finish","1":{"honored":0,"broken":1,"errored":0,"pending":0,"total":1,"time":0.005}}
{"0":"end"}
5
{"0":"finish","1":{"honored":0,"broken":1,"errored":0,"pending":0,"total":1,"time":0.005}} 
```

# c++ - 将 c++ (.cpp) 与 Objective-c (.m) 一起使用

> ID：10866904
> 
> 赞同：0
> 
> 时间：2012-06-03T00:07:00.257
> 
> 标签：c++, objective-c, ios, xcode

对不起我的英语不好。我正在尝试在我的 iOS 项目中使用纯 C++ 代码，但我遇到了下一个问题：

我创建一个新文件product.cpp + product.h，我创建了他自己的方法和属性，我想在我的viewcontroller.m中使用这个类但不运行，我将viewcontroller.m的扩展名更改为viewcontroller.mm但不要运行，但如果我将 appDelegate.m 的扩展名更改为 appDelegate.mm，则可以运行。

我的问题是，如果我想使用 .cpp，我总是必须将 mi 文件更改为 .mm？

：/

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-03T00:15:45.823

通常是的，.mm 的文件扩展名告诉 Xcode 调用 Objective-C++ 编译器，而 .m 告诉编译器调用 Objective-C 编译器。您可以使用右侧的文件设置窗格在每个文件的基础上设置编译器类型（因此您可以强制对 .m 文件进行 Objective-C++ 编译），但这并不直观，并且可能会混淆未来的维护者.

如果您愿意考虑来自长期 C++ 和 Objective-C 用户的一些建议，我已经对两者进行了很多混合，随着时间的推移，它的麻烦多于它的价值。如果纯粹坚持使用 Objective-C，你会好得多，如果你有一些 C++ 库，你只*需要*集成，然后为它制作一个 C 包装器。

过去，Xcode 分析器仅适用于 Objective-C 文件，而不适用于 Objective-C++，因此通过编写 Objective-C++ 文件，您将失去该工具提供的很多价值。我不确定自从我上次编写任何 Objective-C++ 以来，Apple 是否在一年左右的时间里改变了它，但我想他们没有太多理由这样做。如果可以，请坚持使用 Objective-C，因为 Analyzer 非常有用。

# php - WP adding extra menu button on refres

> ID：10866905
> 
> 赞同：0
> 
> 时间：2012-06-03T00:07:09.993
> 
> 标签：php, html, css, wordpress

I've added a menu to my custom WP theme, which all is good with. However, when I refresh the page, SOMETIMES an extra blank title in the menu shows up before all of them. Is there a fix to this? Did I do something wrong?

Here is a image of what I am talking about:

[![](../Images/0315f6a3b97dc09e807c7704820d19b1.png)](https://i.stack.imgur.com/1cD6u.jpg)

```
<div id="navbar">
    <?php wp_nav_menu( array( 'menu' => 'Primary Menu', 'container' => false,'menu_id' => 'main-nav','depth'=>'2')); ?>
        <div id="login" >
    <?php if (!(current_user_can('level_0'))){ ?>               
    <form name="loginform" id="loginform" action="<?php echo get_option('siteurl'); ?>/wp-login.php" method="post">

        <input value="Username" class="input" type="text" tabindex="10" name="log" id="user_login" style="padding-left: 2px;" onfocus="if (this.value == 'Username') {this.value = '';}" onblur="if (this.value == '') {this.value = 'Username';}" />
        <input value="Password" class="input" type="password" tabindex="20" name="pwd" id="user_pass" style="padding-left: 2px;" onfocus="if (this.value == 'Password') {this.value = '';}" onblur="if (this.value == '') {this.value = 'Password';}" />
        <input name="wp-submit" id="wp-submit" tabindex="100" value=" " type="submit" class="loginbutton" >
        <input name="redirect_to" value="<?php echo get_option('siteurl'); ?>" type="hidden">
        <input name="testcookie" value="1" type="hidden">

</form>
            <a class="helpbutton" href="<?php echo get_option('home'); ?>/wp-login.php?action=lostpassword"></a>
    <?php } else { ?>
    <ul class="admin_box">
                <li><a href="<?php echo get_option('home'); ?>/wp-admin/">Dashboard</a></li>
                <li><a href="<?php echo get_option('home'); ?>/wp-admin/post-new.php">Write New Post</a></li>
                <li><a href="<?php echo get_option('home'); ?>/forums">Forums</a></li>
                <li><a href="<?php echo wp_logout_url('$index.php'); ?>">Log out</a></li>
        </ul>
    <?php }?>
        </div>
    </div>
</div> 
```

# android - 选中/取消选中所有首选项？

> ID：10866910
> 
> 赞同：0
> 
> 时间：2012-06-03T00:07:31.677
> 
> 标签：android, sharedpreferences, checkboxpreference

我试图通过在首选项中为用户提供“全选”和“取消全选”选项来提高应用程序的用户友好性。一切似乎都在工作，除了一个主要缺陷：我正在使用 SharedPreferences.getAll() 来检索所有复选框，以便我可以迭代它们并选中/取消选中它们。但似乎 getAll() 并没有辜负它的名字。它不会返回所有首选项，而只会返回用户先前更改过的首选项。

那么，有没有办法检索所有的偏好？

我目前正在使用的代码：

```
public class ADRpreferences extends PreferenceActivity {

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    addPreferencesFromResource(R.xml.preferences);

    ((Preference) findPreference("searchresult_select_all")).
        setOnPreferenceClickListener(new OnPreferenceClickListener() {
             public boolean onPreferenceClick(Preference preference) {
                 setCheckState("searchresult", true);
                 return true;
             }
    });        

    ((Preference) findPreference("searchresult_deselect_all")).
    setOnPreferenceClickListener(new OnPreferenceClickListener() {
         public boolean onPreferenceClick(Preference preference) {
             setCheckState("searchresult", false);
             return true;
         }
    });        
}

private void setCheckState(String prefix, Boolean state) {
    SharedPreferences settings = PreferenceManager.getDefaultSharedPreferences(this);

    @SuppressWarnings("unchecked")
    Map<String, Boolean> categories = (Map<String, Boolean>) settings.getAll();

    for (String s : categories.keySet()) {
        Preference pref = findPreference(s);
        if( s.startsWith(prefix) && (pref instanceof CheckBoxPreference) ){             
            ((CheckBoxPreference) pref).setChecked(state);
        }
    }

}
} 
```

**编辑**

好的，现在我将使用 MH 的解决方案。我将复选框首选项的所有 ID 放入 arrays.xml 中，并将使用这些值遍历所有复选框（如果您想知道为什么我不硬编码 ID，那么其中有 44 个）。效果很好，当然将来如果我更改首选项，我将不得不记住在数组中添加/删除 ID。这是新的 setCheckState()：

```
private void setCheckState(String category, Boolean state) {
    String[] arr = null;

    if( category.equals("loadlist") ){
        arr = getResources().getStringArray(R.array.array_loadlist_checkboxes);
    }
    else if( category.equals("searchresult") ){
        arr = getResources().getStringArray(R.array.array_searchresult_checkboxes);
    }
    else{
        return;
    }

    for( String s : arr ){
        Preference pref = findPreference(s);
        if( pref instanceof CheckBoxPreference ){
            ((CheckBoxPreference) pref).setChecked(state);
        }
    }
} 
```

# c++ - std::is_const 将 const 指针标识为非常量

> ID：10866913
> 
> 赞同：7
> 
> 时间：2012-06-03T00:08:33.860
> 
> 标签：c++, templates, c++11

我对`std::is_const`将指针标识`const`为非`const`. 我自己的实现`is_const`完全一样。我不确定为什么要`<T>`在版本上选择更通用的模板结构`<const T>`。gcc4.7 和 clang3.1-svn 都表现出相同的行为。谁能解释发生了什么？代码如下：

```
#include <iostream>
#include <sstream>
#include <type_traits>

class CEmptyClass {}; 

namespace jbc 
{
  template <typename T>
  struct is_const : std::false_type {}; 

  template <typename T>
  struct is_const<const T> : std::true_type {}; 
}

int main(int argc, char* argv[])
{
  std::cout << "Is 'const CEmptyClass*' constant according to std lib : " 
    << std::is_const<const CEmptyClass*>::value << std::endl;
  std::cout << "Is 'const CEmptyClass*' constant according to jbc : " 
    << jbc::is_const<const CEmptyClass*>::value << std::endl;
} 
```

在这两种情况下都`is_const<const CEmptyClass*>::value`返回`0`

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-06-03T00:11:21.910

没有参考之类的东西`const`，参考永远是`const`。这样的代码无法编译：

```
int& const i; 
```

现在，如果您要删除参考，它会起作用。如果您要放置`const`在右侧（语义上是相同的），然后向后读取类型

```
CEmptyClass const& 
```

它将读取对*const* *CEmptyClass的**引用*，**而不是**对*CEmptyClass*的*const**引用*。

 *******更新：**现在您更改了对指针的引用，同样的错误构造仍然存在：

```
const CEmptyClass*
CEmptyClass const* 
```

两者都是相同的，指向 const CEmptyClass的**非常量指针**

```
CEmptyClass* const 
```

是一个指向 CEmptyClass的**const指针**

和

```
const CEmptyClass* const
CEmptyClass const* const 
```

是指向 const CEmptyClass的**const指针。*******

# jquery - jQuery插件有问题

> ID：10866926
> 
> 赞同：0
> 
> 时间：2012-06-03T00:11:19.570
> 
> 标签：jquery, jquery-plugins

我正在将一些 jQuery 变成一个插件，但我想出了错误。这是正常的 jQuery 代码。

```
var current = ($("#gallery a.show")? $("#gallery a.show") : $("#gallery a:first")); 
```

这是jQuery插件代码

```
var current = ($(this).find("a.show")? $(this).find("a.show") : $(this).find("a:first")); 
```

帮助将不胜感激。

这是**所有**jQuery 插件代码。

```
$(window).load(function(){
    $("#gallery").csstubeslider();
}); 
```

```
$.fn.csstubeslider = function(){
    $(this).animate({'opacity': '1'}, 500);
    $(this).find(".caption").css("opacity", 0.7);

    $(this).find("a").css("opacity", "0");
    $(this).find("a.show").css("opacity", "1");

    var hasplayed = false;
    if(hasplayed == false){
        setTimeout(function hello(){
            $(this).find(".caption").animate({"height": 0, "opacity": 0}, 500);
            hasplayed == true;
        }, 4500);
    }

    setInterval(function(){
        var current = ($(this).find("a.show")? $(this).find("a.show") : $(this).find("a:first"));
        var next = ((current.next())? (current.next().hasClass("caption"))? $(this).find("a:first") : current.next() : $(this).find("a:first"));
        var content = next.find("img").attr("rel");

        next.addClass("show").animate({"opacity": "1.0"}, 500);
        current.removeClass('show').animate({"opacity": "0"}, 500);

        setTimeout(function(){
            $(this).find(".caption").animate({"height": 0, "opacity": 0}, 500);
        }, 4500);
        $(this).find(".content").html(content);
    }, 1000);
} 
```

这是jQuery代码。

```
$(window).load(function(){
    $("#gallery").animate({'opacity': '100'}, 5000);
    $("#gallery .caption").css("opacity", 0.8);
    slideshow();
});

function slideshow(){
    $("#gallery a").css("opacity", "0");
    $("#gallery a.show").css("opacity", "1");

    var content = $("#gallery a.show").find("img").attr("rel");
    $("#gallery .content").html(content);

    var hasplayed = false;

    if(hasplayed == false){
        setTimeout(function hello(){
            $("#gallery .caption").animate({"height": 0, "opacity": 0}, 500);
            hasplayed == true;
        }, 4500);
    }

    setInterval("playimages()", 5500);
}

function playimages(){
    var current = ($("#gallery a.show")? $("#gallery a.show") : $("#gallery a:first"));
    var next = ((current.next())? (current.next().hasClass("caption"))? $("#gallery a:first") : current.next() : $("#gallery a:first"));
    var content = next.find("img").attr("rel");

    next.addClass("show").animate({"opacity": "1.0"}, 500);
    current.removeClass('show').animate({"opacity": "0"}, 2000);
    $("#gallery .caption").css("height", 0).animate({"height": 60, "opacity": 0.8}, 500);
    setTimeout(function hello(){
        $("#gallery .caption").animate({"height": 0, "opacity": 0}, 500);
    }, 4500);

    $("#gallery .content").html(content);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-03T00:45:00.970

这不符合您的预期：

```
var current = ($("#gallery a.show")? $("#gallery a.show") : $("#gallery a:first")); 
```

这相当于`var current = $('#gallery a.show');`因为`$(x)`永远不会是假的，它的长度可能为零，但它不会是假的。这意味着您的插件也不符合您的预期，您需要检查长度：

```
var current = $(this).find("a.show").length ? $(this).find("a.show") : $(this).find("a:first"); 
```

或更好：

```
// This avoids a double `find('a.show')`.
var current = $(this).find('a.show');
if(current.length == 0)
    current = $(this).find('a:first'); 
```

您的下一个问题是，这`this`不是您期望它在[`setInterval`](https://developer.mozilla.org/en/DOM/window.setInterval)和[`setTimeout`](https://developer.mozilla.org/en/DOM/window.setTimeout)回调中的样子，`this`可能是`window`在触发回调时。你想做这样的事情：

```
var _this = this;
setTimeout(function hello(){
    // Use '_this' instead of 'this' in here.
}, ...); 
```

以上也适用于您的`setInterval`电话。

此外，在您的插件内部，`this`已经是一个 jQuery 对象，所以您不需要`$(this)`，只需`this`要做。而且您的插件不可链接，但您可以通过简单的方式解决该问题`return this;`：

```
$.fn.csstubeslider = function() {
    //...
    return this;
}; 
```

如果您尝试一次将插件绑定到多个事物，您可能会遇到麻烦，通常的模式是这样的：

```
$.fn.csstubeslider = function() {
    return this.each(function() {
        // 'this' in here is just one matching element so
        // we wrap some jQuery around it and use '$this'
        // inside here.
        var $this = $(this); 

        // The rest of your plugin code goes here, you can
        // use '$this' in here to avoid multiple calls to $().
        // You'll also be able to use '$this' inside your
        // 'setTimeout' and 'setInterval' callbacks too.
    });
}; 
```

# python - Python - 对目录中的文件进行排序并在代码中使用最新文件

> ID：10866928
> 
> 赞同：2
> 
> 时间：2012-06-03T00:11:34.850
> 
> 标签：python

长期读者，第一次海报。我对 python 很陌生，我会尝试正确地提出我的问题。

我在下面发布了我正在使用的 .py 代码片段。我正在尝试获取当前目录中要列出的最新修改文件，然后稍后在代码中传递它。

这是我尝试运行文件时在日志文件中遇到的错误：

```
WindowsError: [Error 2] The system cannot find the file specified: '05-30-2012_1500.wav' 
```

所以看起来它实际上是从目录中提取一个文件，但仅此而已。实际上，它提取的文件不是该目录中最近修改的文件。

```
latest_page = max(os.listdir("/"), key=os.path.getmtime)

cause = channel.FilePlayer.play(latest_page) 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-03T00:13:39.013

`os.listdir`返回文件的名称，而不是这些文件的完整路径。通常，当您使用 时`os.listdir(SOME_DIR)`，您需要`os.path.join(SOME_DIR, fname)`获取可用于处理文件的路径。

这可能对您有用：

```
files = [os.path.join("/", fname) for fname in os.listdir("/")]
latest = max(files, key=os.path.getmtime)
cause = channel.FilePlayer.play(latest) 
```

# java - 通过 Google Feed API v0 或 v1 获取发布或接收日期

> ID：10866933
> 
> 赞同：1
> 
> 时间：2012-06-03T00:11:57.543
> 
> 标签：java, json, rss, rss-reader, google-feed-api

啊啊啊我的第一篇文章...

我正在使用 Google Feed API-v1 (https://developers.google.com/feed/v1/) 并且有一些 RSS 提要，其中“publishedDate”为空白，即 - “:”，这意味着 RSS 发布者是没有将文章日期传递到他们的 RSS 提要中。例如，我从[http://www.globest.com/index.xml](http://www.globest.com/index.xml)提取文章，而他们的提要没有“publishedDate”或“pubDate”；但是，当我将 www.globest.com/index.xml 放入 Google 阅读器时，标题旁边会出现文章日期。我了解 Google 阅读器中文章旁边显示的日期是“收到”或“发布”日期。Google 在此处解释术语[http://support.google.com/reader/bin/answer.py?hl=en&answer=78728](http://support.google.com/reader/bin/answer.py?hl=en&answer=78728)

所以我的问题.... Google Feed API v1 中是否有一种方法可以获取“收到”或“发布”日期？如果是，如何。如果没有，大约 v0？

我正在使用 Java 和 JSON，我的代码如下：

```
 import java.io.BufferedReader;
    import java.io.IOException;
    import java.io.InputStreamReader;
    import java.net.URL;
    import java.net.URLConnection;
    import net.sf.json.JSONObject;

    public class FeedTester 
    {

        public static void main(String[] args) throws IOException 
        {
            String loadBaseURL = "https://ajax.googleapis.com/ajax/services/feed/load";
            String googleRSSURL = "?v=1.0&q=";
            String testRSSURL = "http://www.globest.com/index.xml";
            String extra = "&callback=CB1&num=10";

            URL url = new URL(loadBaseURL+googleRSSURL+testRSSURL+extra);
            URLConnection connection = url.openConnection();
            connection.addRequestProperty("Referer", "www.YOURSITE.com");

            String line;
            StringBuilder builder = new StringBuilder();
            BufferedReader reader = new BufferedReader(new InputStreamReader(connection.getInputStream()));
            while((line = reader.readLine()) != null)
            {
                    builder.append(line);
            }

            JSONObject json = new JSONObject();
            json.put("values", builder.toString());

            System.out.println(json.get("values"));
        }//end main
    }//end FeedTester 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-03T03:50:41.993

我不确定 Java，但在 Python 中，您可以访问下面的发布日期。结果是来自谷歌的 json 响应。

```
for entries in results['responseData']['feed']['entries']:  
    print entries['publishedDate'] 
```

希望有帮助。

# php - 确定当前日期时间是否在 PHP 中用户设置的日期和时间范围内的函数

> ID：10866934
> 
> 赞同：1
> 
> 时间：2012-06-03T00:12:07.993
> 
> 标签：php, function, datetime, foreach

在过去的几天里，我一直在断断续续地处理这段代码，但无法弄清楚。

我需要做的是从函数返回 0 或 1，具体取决于当前时间是否在用户设置的时间范围内。如果时间和日期在用户设置的4值数组内，则返回1，否则返回0。用户可以设置多个数组，用于多个时间段。

我一直在尝试使用此代码一段时间：

函数.php：

```
function determineWoE($woe) {
  $curDayWeek = date('N');
  $curTime = date('H:i');
  $amountWoE = count($woe['WoEDayTimes']); // Determine how many WoE times we have.
  if ( $amountWoE == 0 ) {
    return 0; // There are no WoE's set! WoE can't be on!
  }
  for ( $i=0; $i < $amountWoE; $i++ ) {
    if ( $woe['WoEDayTimes'][$i][0] == $curDayWeek && $woe['WoEDayTimes'][$i][2] == $curDayWeek ) { // Check the day of the week.
      if ( $woe['WoEDayTimes'][$i][1] >= $curTime && $woe['WoEDayTimes'][$i][3] <= $curTime ) { // Check current time of day.
        // WoE is active
        return 1;
      }
      else {
        // WoE is not active
        return 0;
      }
    }
    else {
      // WoE is not active
      return 0;
    }
  }
} 
```

并且...用户可以根据需要为该功能设置任意多的时间段：

```
$woe = array( // Configuration options for WoE and times.
  // -- WoE days and times --
  // First parameter: Starding day 1=Monday / 2=Tuesday / 3=Wednesday / 4=Thursday / 5=Friday / 6=Saturday / 7=Sunday
  // Second parameter: Starting hour in 24-hr format.
  // Third paramter: Ending day (possible value is same or different as starting day).
  // Fourth (final) parameter: Ending hour in 24-hr format.
  'WoEDayTimes'   => array(
    array(6, '18:00', 6, '19:00'), // Example: Starts Saturday 6:00 PM and ends Saturday 7:00 PM
    array(3, '14:00', 3, '15:00')  // Example: Starts Wednesday 2:00 PM and ends Wednesday 3:00 PM
  ),
); 
```

但是，无论我做什么......函数determineWoE总是返回0。

我是否需要在函数中使用 foreach 而不是 for？如果时间在用户可设置的时间内，我如何让确定WoE 返回 1？

尝试将 for 更改为 foreach：

```
foreach ( $woe['WoEDayTimes'] as $i ) { 
```

现在我收到错误：警告：第 76 行 /var/www/jemstuff.com/htdocs/ero/functions.php 中的非法偏移类型

...我不知道为什么会收到该错误。第 76 行是：

```
if ( $woe['WoEDayTimes'][$i][0] == $curDayWeek && $woe['WoEDayTimes'][$i][2] == $curDayWeek ) { // Check the day of the week. 
```

在functions.php中

var_dump($woe)

```
array(2) { ["WhoOnline"]=> string(2) "no" ["WoEDayTimes"]=> array(2) { [0]=> array(4) { [0]=> int(6) [1]=> string(5) "18:00" [2]=> int(6) [3]=> string(5) "19:00" } [1]=> array(4) { [0]=> int(3) [1]=> string(5) "14:00" [2]=> int(3) [3]=> string(5) "15:00" } } } 
```

感谢您提供给我的任何帮助。:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-03T01:29:31.053

几个小点：

*   `foreach`循环和`for`循环都可以正常工作，但您可能会发现更`foreach`方便，因为您不必`count()`检查几天/时间。

*   您应该返回布尔值`true`或`false`而不是 1 或 0。

我不确定您为什么会收到该错误，但我看到的**更大**问题是您如何比较**时间**。您将字符串时间转换为数字类型，并且不会像您想象的那样完全转换。例如...

```
"14:00" < "14:59" 
```

...将是错误的，因为它将两个字符串都转换为 14。因此，第一个字符串实际上**等于**第二个。

您最好将字符串转换为 Unix 时间戳（即自 1970 年 1 月 1 日以来的秒数），然后进行比较。

这是我将如何做到的一个粗略的想法：

```
// Function to help get a timestamp, when only given a day and a time
// $today is the current integer day
// $str should be 'last <day>', 'next <day>', or 'today'
// $time should be a time in the form of hh:mm
function specialStrtotime($today, $day, $time) {

    // An array to turn integer days into textual days
    static $days = array(
        1 => 'Monday',
        2 => 'Tuesday',
        3 => 'Wednesday',
        4 => 'Thursday',
        5 => 'Friday',
        6 => 'Saturday',
        7 => 'Sunday'
    );

    // Determine if the day (this week) is in the past, future, or today
    if ($day < $today) {
        $str = 'last ' . $days[$day];
    } else if ($day > $today) {
        $str = 'next ' . $days[$day];
    } else {
        $str = 'today';
    }

    // Get the day, at 00:00
    $r = strtotime($str);

    // Add the amount of seconds the time represents
    $time = explode(':', $time);
    $r += ($time[0] * 3600) + ($time[1] * 60);

    // Return the timestamp
    return $;
}

// Your function, modified
function determineWoE($timeNow, $woe) {
    $dayNow = (int) date('N', $timeNow);
    foreach ($woe as $a) {
        // Determine current day

        // Determine the first timestamp
        $timeFirst = specialStrtotime($dayNow, $a[0], $a[1]);

        // Determine the second timestamp
        $timeSecond = specialStrtotime($dayNow, $a[2], $a[3]);

        // See if current time is within the two timestamps
        if ($timeNow > $timeFirst && $timeNow < $timeSecond) {
            return true;
        }
    }
    return false;
}

// Example of usage
$timeNow = time();
if (determineWoE($timeNow, $woe['WoEDayTimes'])) {
    echo 'Yes!';
} else {
    echo 'No!';
} 
```

祝你好运！

# java - 查找对象的最快方法

> ID：10866935
> 
> 赞同：1
> 
> 时间：2012-06-03T00:12:08.837
> 
> 标签：java, algorithm, software-design, object-oriented-analysis, object-oriented-database

假设您有一个 Sunglasses 对象列表，其中有...

1.  4个属性，颜色，形状，款式和品牌。
2.  没有相同的；4个属性的组合总是不同的

检索它们的最快方法是什么？

我认为：

1.  覆盖 Sunglasses 类中的 hashcode() 方法（应该是唯一的，因为它们都不相同）。
2.  然后以每个对象的hashcode为key，对象本身为value，放入一个Hashmap

假设我确切地记得我想要得到的玻璃杯的颜色形状、款式和品牌，

1.  我将它们与我实现的哈希码方法一起应用。
2.  然后从哈希图中获取它，这应该给我时间 O(1) 检索。

**问题是如果我只知道颜色怎么办。如何获得所有具有相同颜色的眼镜的列表？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-03T02:55:33.493

`HashMap<Color,Collection<Glasses>>`除了您的其他数据结构之外，还构建一个。

该映射本质上是作为属性*索引*的服务器。`Color`

每当您从其他数据结构中添加或删除眼镜时，请确保也更新此颜色索引。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-03T05:04:38.317

1.  创建一个值类来保存 4 个属性，并创建使用所有字段的 hashcode 和 equals 方法。
2.  将类用作太阳镜的字段，而不是使用单独的字段（这样，如果您将其更改为添加另一个字段，它会随处更改）
3.  使用值类的哈希图 --> 太阳镜，并在查询时在使用 map.get(value) 处构建一个值对象

# iphone - UISearchBar setSearchFieldBackgroundImage 问题

> ID：10866937
> 
> 赞同：1
> 
> 时间：2012-06-03T00:12:35.390
> 
> 标签：iphone, objective-c, ios, ipad

因此，我正在尝试使用以下代码为我的 UISearchField 图像设置自定义图像：

```
 UISearchBar * searchBar = [[UISearchBar alloc] initWithFrame:CGRectMake(0, 0, 300, 44)];
    searchBar.placeholder = @"Search for a tag";
    searchBar.delegate = self;
    [searchBar setSearchFieldBackgroundImage:[UIImage imageNamed:@"search-bg.png"] forState:UIControlStateNormal];
    UITextField *searchField = [searchBar valueForKey:@"_searchField"];
    searchField.textColor = [UIColor whiteColor]; 
```

但是我的放大镜有问题。结果如下：

![在此处输入图像描述](../Images/753ebe3884e2d4e713d728bcdb521ed3.png)

如果你仔细观察，放大镜实际上是透明的，而不是白色的。在图像中，我将其设置为白色。任何想法为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T16:08:51.560

我不知道这里发生了什么，但您可以提供自己的放大镜图像：

```
[self setImage:[UIImage imageNamed:@"glassImage"] forSearchBarIcon:UISearchBarIconSearch state:UIControlStateNormal]; 
```

# c - 如何读取子进程的输出？

> ID：10866944
> 
> 赞同：6
> 
> 时间：2012-06-03T00:13:38.370
> 
> 标签：c, windows, winapi, pipe

我编写了一个函数，试图通过管道读取子进程的命令行输出。这应该是[MSDN Creating a Child Process with Redirected Input and Output 文章的](http://msdn.microsoft.com/en-us/library/ms682499%28VS.85%29.aspx)一个简单子集，但我显然犯了某种错误。

无论我将它放置在 WaitForSingleObject(...) 调用之前还是之后，下面的 ReadFile(...) 调用都将永远阻塞，这应该标志着子进程的结束。

我已经阅读了所有建议“使用异步 ReadFile”的答案，如果有人能给我一些想法如何在管道上完成，我愿意接受这个建议。虽然我不明白为什么这种情况需要异步 I/O。

```
#include "stdafx.h"
#include <string>
#include <windows.h>

unsigned int launch( const std::string & cmdline );

int _tmain(int argc, _TCHAR* argv[])
{
    launch( std::string("C:/windows/system32/help.exe") );  
    return 0;
}

void print_error( unsigned int err )
{
    char* msg = NULL;
    FormatMessageA(
        FORMAT_MESSAGE_ALLOCATE_BUFFER | 
        FORMAT_MESSAGE_FROM_SYSTEM |
        FORMAT_MESSAGE_IGNORE_INSERTS,
        NULL,
        err,
        MAKELANGID(LANG_NEUTRAL, SUBLANG_DEFAULT),
        (LPSTR)&msg,
        0, NULL );
    std::cout << "------ Begin Error Msg ------" << std::endl;
    std::cout << msg << std::endl;
    std::cout << "------  End Error Msg  ------" << std::endl;

    LocalFree( msg );
}

unsigned int launch( const std::string & cmdline )
{
    TCHAR cl[_MAX_PATH*sizeof(TCHAR)]; 
    memset( cl, 0, sizeof(cl) );
    cmdline.copy( cl, (_MAX_PATH*sizeof(TCHAR)) - 1);    

    HANDLE stdoutReadHandle = NULL;
    HANDLE stdoutWriteHandle = NULL;

    SECURITY_ATTRIBUTES saAttr; 
    memset( &saAttr, 0, sizeof(saAttr) ); 
    saAttr.nLength = sizeof(SECURITY_ATTRIBUTES); 
    saAttr.bInheritHandle = TRUE; 
    saAttr.lpSecurityDescriptor = NULL; 

    // Create a pipe for the child process's STDOUT. 
    if ( ! CreatePipe(&stdoutReadHandle, &stdoutWriteHandle, &saAttr, 5000) )      
        throw std::runtime_error( "StdoutRd CreatePipe" ); 
    // Ensure the read handle to the pipe for STDOUT is not inherited.
    if ( ! SetHandleInformation(stdoutReadHandle, HANDLE_FLAG_INHERIT, 0) )
        throw std::runtime_error( "Stdout SetHandleInformation" ); 

    STARTUPINFO startupInfo; 
    memset( &startupInfo, 0, sizeof(startupInfo) ); 
    startupInfo.cb = sizeof(startupInfo);
    startupInfo.hStdError = stdoutWriteHandle;
    startupInfo.hStdOutput = stdoutWriteHandle;
    startupInfo.hStdInput = GetStdHandle(STD_INPUT_HANDLE);
    startupInfo.dwFlags |= STARTF_USESTDHANDLES;

    char* rawEnvVars = GetEnvironmentStringsA();

    //__asm _emit 0xcc;

    PROCESS_INFORMATION processInfo;
    memset( &processInfo, 0, sizeof(processInfo) );

    std::cout << "Start [" << cmdline << "]" << std::endl;
    if ( CreateProcessA( 0, &cl[0], 0, 0, false, 
        CREATE_NO_WINDOW | CREATE_UNICODE_ENVIRONMENT, 
        rawEnvVars, 0, &startupInfo, &processInfo ) )
    {       
        //CloseHandle( stdoutWriteHandle );
        DWORD wordsRead;
        char tBuf[257] = {'\0'};
        bool success = true;
        std::string outBuf("");
        unsigned int t;
        while(success) {
            //__asm _emit 0xcc;
            std::cout << "Just before ReadFile(...)" << std::endl;
            success = ReadFile( stdoutReadHandle, tBuf, 256, &wordsRead, NULL);
            (t=GetLastError())?print_error(t):t=t;
            std::cout << "Just after ReadFile(...) | read " << wordsRead<< std::endl;
            std::cout << ".";
            if( success == false ) break;
            outBuf += tBuf;
            tBuf[0] = '\0';
        }
        std::cout << "output = [" << outBuf << "]" << std::endl;

        if ( WaitForSingleObject( processInfo.hProcess, INFINITE ) == WAIT_OBJECT_0 )
        {
            unsigned int exitcode = 0;
            GetExitCodeProcess( processInfo.hProcess, (LPDWORD)&exitcode );                
            std::cout << "exitcode = [" << exitcode << "]" << std::endl;

            //__asm _emit 0xcc;
            CloseHandle( processInfo.hProcess );
            CloseHandle( processInfo.hThread );

            return exitcode;
        }
    }
    else
    {
        DWORD procErr = GetLastError();
        std::cout << "FAILED TO CREATE PROCESS!" << std::endl;
        print_error( procErr );
    }
    return -1;
} // end launch() 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-04T21:33:39.010

您的代码中有一些错误，但最重要的是您已`FALSE`为. 如果新进程没有继承它的句柄，它就不能使用管道。为了继承句柄，参数必须是*并且*句柄必须启用继承。`bInheritHandles``CreateProcess``bInheritHandles``TRUE`

 *其他问题：

*   您正在指定`CREATE_UNICODE_ENVIRONMENT`但传递了一个 ANSI 环境块。请注意，传递并让系统为您复制环境块`NULL`更容易。`lpEnvironment`如文档中所述，您仍应`CREATE_UNICODE_ENVIRONMENT`在这种情况下指定，因为您的环境块可能包含 Unicode 字符。

*   同样，如果您调用 CreateProcessA，您应该使用 STARTUPINFOA。

*   您不会`tBuf`在循环中每次都以零结尾，因此您会在输出缓冲区中获得虚假的额外字符。

*   您需要`stdoutWriteHandle`在进入读取循环之前关闭，否则您将不知道子进程何时退出。（或者您可以使用异步 IO 并显式检查进程退出。）

*   `GetLastError()`如果 API 函数成功，则未定义，因此您应该仅在`ReadFile`返回时调用它`FALSE`。（当然，在这种情况下，这纯粹是装饰性的，因为您没有对错误代码采取行动。）

作为参考，这是我对您的代码的更正版本。我已经把它变成了普通的 C（对不起！），因为那是我所熟悉的。我在 Unicode 模式下编译和测试，但我认为它也应该在 ANSI 模式下无需修改即可工作。

```
#define _WIN32_WINNT _WIN32_WINNT_WIN7
#include <windows.h>
#include <stdio.h>

void launch(const char * cmdline_in)
{
    PROCESS_INFORMATION processInfo;
    STARTUPINFOA startupInfo; 
    SECURITY_ATTRIBUTES saAttr; 

    HANDLE stdoutReadHandle = NULL;
    HANDLE stdoutWriteHandle = NULL;

    char cmdline[256];
    char outbuf[32768];
    DWORD bytes_read;
    char tBuf[257];

    DWORD exitcode;

    strcpy_s(cmdline, sizeof(cmdline), cmdline_in);

    memset(&saAttr, 0, sizeof(saAttr));
    saAttr.nLength = sizeof(SECURITY_ATTRIBUTES); 
    saAttr.bInheritHandle = TRUE; 
    saAttr.lpSecurityDescriptor = NULL; 

    // Create a pipe for the child process's STDOUT. 
    if (!CreatePipe(&stdoutReadHandle, &stdoutWriteHandle, &saAttr, 5000))
    {
        printf("CreatePipe: %u\n", GetLastError());
        return;
    }

    // Ensure the read handle to the pipe for STDOUT is not inherited.
    if (!SetHandleInformation(stdoutReadHandle, HANDLE_FLAG_INHERIT, 0))
    {
        printf("SetHandleInformation: %u\n", GetLastError());
        return;
    }

    memset(&startupInfo, 0, sizeof(startupInfo));
    startupInfo.cb = sizeof(startupInfo);
    startupInfo.hStdError = stdoutWriteHandle;
    startupInfo.hStdOutput = stdoutWriteHandle;
    startupInfo.hStdInput = GetStdHandle(STD_INPUT_HANDLE);
    startupInfo.dwFlags |= STARTF_USESTDHANDLES;

    // memset(&processInfo, 0, sizeof(processInfo));  // Not actually necessary

    printf("Starting.\n");

    if (!CreateProcessA(NULL, cmdline, NULL, NULL, TRUE,
        CREATE_NO_WINDOW | CREATE_UNICODE_ENVIRONMENT, NULL, 0, &startupInfo, &processInfo))
    {
        printf("CreateProcessA: %u\n", GetLastError());
        return;
    }

    CloseHandle(stdoutWriteHandle);

    strcpy_s(outbuf, sizeof(outbuf), "");

    for (;;) {
        printf("Just before ReadFile(...)\n");
        if (!ReadFile(stdoutReadHandle, tBuf, 256, &bytes_read, NULL))
        {
            printf("ReadFile: %u\n", GetLastError());
            break;
        }
        printf("Just after ReadFile, read %u byte(s)\n", bytes_read);
        if (bytes_read > 0)
        {
            tBuf[bytes_read] = '\0';
            strcat_s(outbuf, sizeof(outbuf), tBuf);
        }
    }

    printf("Output: %s\n", outbuf);

    if (WaitForSingleObject(processInfo.hProcess, INFINITE) != WAIT_OBJECT_0)
    {
        printf("WaitForSingleObject: %u\n", GetLastError());
        return;
    }

    if (!GetExitCodeProcess(processInfo.hProcess, &exitcode))
    {
        printf("GetExitCodeProcess: %u\n", GetLastError());
        return;
    }

    printf("Exit code: %u\n", exitcode);

    CloseHandle( processInfo.hProcess );
    CloseHandle( processInfo.hThread );

    return;
}

int main(int argc, char** argv)
{
    launch("C:\\windows\\system32\\help.exe");
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-03T07:05:34.520

ReadFile() 有一个“LPOVERLAPPED lpOverlapped”参数，您已将其设置为 NULL。看起来唯一的方法是允许在管道上重叠 I/O，然后将 WaitForSingleObject() 用于“overlapped.hEvent”。

另一种方法是使用[ConnectNamedPipe](http://msdn.microsoft.com/en-us/library/aa365146%28v=vs.85%29.aspx)函数并为管道创建 OVERLAPPED 结构。*

# javascript - 如何使用 Capybara 和 ChromeDriver 在输入字段中模拟输入？

> ID：10866946
> 
> 赞同：69
> 
> 时间：2012-06-03T00:13:51.247
> 
> 标签：javascript, jquery, ruby-on-rails, capybara, selenium-chromedriver

我有以下帮助方法将字符串输入到输入字段并按回车键，但似乎从未按下回车键。我看到输入字段中输入了字符串，但是在输入时发生的事件从未发生过。

我已经在一个实际的浏览器中测试了 enter 键正确地触发了预期的事件。我不确定我错过了什么。

```
def fill_and_trigger_enter_keypress(selector, value)
  page.execute_script %Q(
                          var input = $('#{selector}');
                          input.val('#{value}');
                          input.trigger("keypress", [13]);
                         )
end 
```

编辑：

我也尝试了以下无济于事：

```
find('#q_name').native.send_keys(:return)
find('#q_name').native.send_keys(:enter) 
```

它们不会导致任何错误，但仍然没有按下回车键。

* * *

## 回答 #1

> 赞同：89
> 
> 时间：2012-07-25T23:28:59.143

```
find('#q_name').native.send_keys(:return) 
```

为我工作。我的字段没有名称或 ID，但类型是输入的，所以我使用了类似的东西

```
find('.myselector_name>input').native.send_keys(:return) 
```

工作得很好！

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2016-12-23T16:21:54.860

这些天（Capybara 2.5+ 版）您可以`<enter>`通过以下方式模拟密钥：

```
find('.selector').set("text\n") 
```

（`\n`新行）是这里非常重要的一点。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-06-03T01:26:32.653

通常，当您运行 page.execute_script 时，您会得到与在页面控制台中运行相同的结果。尝试在控制台中手动运行它，看看是否得到预期的结果。这通常是我所做的.. 在浏览器控制台窗口中制作所需的 js 代码，并在它工作时使用 execute_script 将其粘贴到 capybara 代码中。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-06-03T00:45:08.583

Capybara 没有对 send_keys 类型事件的原生支持。您可能可以使用 selenium 来执行此操作，或者您可以尝试这个 gem [https://github.com/markgandolfo/send-keys](https://github.com/markgandolfo/send-keys)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-02-04T09:49:22.093

这个对我有用

```
page.execute_script("$('form.css-class/#form_id').submit()") 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-08-09T13:47:23.070

`@Page.selector.send_keys :return`

这对我有用，`selector`页面对象元素中的元素在哪里`:selector, '<css selector>'`

# java - Google AppEngine JSONArrayProvider$App，无法实例化

> ID：10866947
> 
> 赞同：2
> 
> 时间：2012-06-03T00:15:14.053
> 
> 标签：java, google-app-engine, jersey, jackson

我正在运行 Java REST Web 服务 Google AppEngine。它在我的本地 Google Plugin for Eclipse 开发服务器上运行良好。但是，在将其部署到 AppEngine Cloud 后，我收到以下错误，每 4 毫秒重复记录一次：

```
 com.sun.jersey.core.spi.component.ProviderFactory __getComponentProvider: The provider class, class com.sun.jersey.json.impl.provider.entity.JSONArrayProvider$General, could not be instantiated. Processing will continue but the class will not be utilized 
```

这与以下问题相同：

[Google App Engine 上的泽西岛错误](https://stackoverflow.com/questions/6130328/jersey-error-on-google-app-engine)

但是，到达那里的解决方案对我不起作用。解决方案是“添加 jackson*.jar 库，问题就消失了。” 我确实将所有杰克逊罐子添加为 $ECLIPSE_PROJECT_HOME/war/WEB-INF/lib/jackson-all-1.9.7.jar ，但我仍然收到错误消息。我了解问题的性质（Jackson 没有被 Jersey 检测为提供者），但我发现有趣的是，此错误仅在部署后发生，而不是在开发中发生。

也许我会尝试杰克逊的新 2.0.0 系列...

我是否需要在我的 $ECLIPSE_PROJECT_HOME/war/WEB-INF/web.xml 文件中添加任何提及 Jackson 的内容？现在，我有：

```
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" version="2.5" xmlns="http://java.sun.com/xml/ns/javaee">
    <servlet>
        <servlet-name>jerseywebapp</servlet-name>
        <servlet-class>com.sun.jersey.spi.container.servlet.ServletContainer</servlet-class>
        <init-param>
            <param-name>com.sun.jersey.config.property.packages</param-name>
<param-value>org.pathways.openciss.rest.impl</param-value>
        </init-param>
        <init-param>
            <param-name>com.sun.jersey.api.json.POJOMappingFeature</param-name>
            <param-value>true</param-value>
        </init-param>
        <init-param> 
            <param-name>com.sun.jersey.config.property.classnames</param-name> 
            <param-value>org.codehaus.jackson.jaxrs.JacksonJsonProvider</param-value> 
        </init-param>
        <load-on-startup>1</load-on-startup>
    </servlet>
    <servlet-mapping>
        <servlet-name>Jersey Web Application</servlet-name>
        <url-pattern>/resources/*</url-pattern>
    </servlet-mapping>
    <servlet-mapping>
        <servlet-name>jerseywebapp</servlet-name>
        <url-pattern>/*</url-pattern>
    </servlet-mapping>
    <welcome-file-list>
        <welcome-file>OpenCISS.html</welcome-file>
    </welcome-file-list>
</web-app> 
```

我已经尝试过打开和关闭 POJOMappingFeature 和 JacksonJsonProvider 参数，但无济于事......

提前感谢您的任何建议。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-03T13:23:48.710

解决了。我使用的是未与 Jersey 捆绑的 Jackson 库。我删除了 Jackson 库，并从以下位置安装了包含 Jackson 的 Jersey 档案：

[http://maven.java.net/service/local/artifact/maven/redirect?r=releases&g=com.sun.jersey&a=jersey-archive&v=1.12&e=zip](http://maven.java.net/service/local/artifact/maven/redirect?r=releases&g=com.sun.jersey&a=jersey-archive&v=1.12&e=zip)

...链接到网站外：

[http://jersey.java.net/nonav/documentation/latest/chapter_deps.html](http://jersey.java.net/nonav/documentation/latest/chapter_deps.html)

Jersey 存档（当前版本为 1.12）效果很好。一旦我在它的文件夹中添加了所有的罐子`/lib`，错误就消失了，正如另一张海报所看到的那样。我不明白的是应该*只*使用泽西档案，而不是泽西和杰克逊网站的罐子混合，因为泽西档案包含杰克逊罐。

# notepad++ - Filezilla 自动上传热键 (AutoHotkey)

> ID：10866957
> 
> 赞同：2
> 
> 时间：2012-06-03T00:17:42.070
> 
> 标签：notepad++, autohotkey, filezilla

这是我的第一篇文章，所以请温柔。
我发现我经常不断地保存文件，然后将它们上传到网络服务器来测试它们。这变得相当烦人，所以我试图创建一个自动热键脚本，当我在记事本++中保存文件时，它会使用 filezilla 自动将文件上传到服务器。

目前我有这个：

```
loop {
  IfWinExist, File has changed
  {
    WinActivate
    Send, !y
  }
  Sleep, 1000
} 
```

这在一定程度上有效。它将保存的文件上传到服务器，但它不考虑目录，所以我最终将大量 js 和 css 文件上传到主站点目录而不是它们各自的目录，这显然是一个问题。

我对 AutoHotkey 还很陌生，我真的不知道我在做什么，所以我不确定如何解决这个问题。

**我的想法（不确定是否可能）**
我的所有网站在我的计算机上都有类似的文件结构：

```
*sitename* / root / css / *css files*
                     js / *js files*
                    img / *image files* 
```

然后是根文件夹内的站点目录和页面。这意味着我可以在 FileZilla 中打开站点根文件夹并将所有文件复制到服务器上的 public_html 文件夹。

我想知道是否可以获取已保存文件的文件路径，例如： `'d://files/Website_name/root/css/styles.css'`
并在 root 之前删除内容以保留“css/styles.css”。然后导航到网络服务器上的 css 目录，然后传输文件。这将需要与多个目录一起使用，比如“about/info/index.php”，这需要更改为“about”目录，然后是“info”目录，然后上传文件。

如果在任何时候该目录不存在，我希望该进程停止运行并返回到起始目录。它也应该在上传文件后执行此操作，以便为下一次上传做好准备。

我真的不明白为什么这还不是 FileZilla 功能的一部分，因为许多其他 FTP 程序会自动上传文件。如果有人可以帮助我修改我的脚本或向我展示使用 FileZilla 自动上传文件的另一种（免费）方式，我将不胜感激。

吉米

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-03T06:49:56.383

不是您所要求的，但是一旦您使用 Notepad++ 进行编辑，为什么不使用它的 FTP 插件呢？它与 N++ 本身一起提供，并且易于配置。如果您想要一种具有更多可能性的方法，那么您应该尝试[WinSCP](http://winscp.net)并将 Notepad++ 设置为其默认编辑器。一旦保存在 N++ 中，这两种方法都会自动上传您的更改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-03-03T15:12:00.383

我重新制作了 AutoHotKey**脚本**，所以如果有人对此感兴趣：

```
loop {
  IfWinExist, Datei wurde geändert ;original -> File has changed
  {
    WinGetTitle, windowBefore, A
    WinActivate
    ;Send, !y (wont work at me)
    Send, {Enter}
    WinActivate, %windowBefore%
  }
  Sleep, 1000
} 
```

# jquery - 如何从 Capybara 和 ChromeDriver 中拖动 jQuery 滑块句柄？

> ID：10866960
> 
> 赞同：9
> 
> 时间：2012-06-03T00:18:14.267
> 
> 标签：jquery, jquery-ui, capybara, selenium-chromedriver

我可以执行以下代码来移动滑块句柄，但是在浏览器中触发的事件没有发生。

```
page.execute_script(%Q($('#slider_handicap').slider('values',1,30))) 
```

这正确地将右手柄设置为 30，但我需要它表现得好像我实际上是在使用鼠标并将手柄拖动到 30 然后释放。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-04-18T19:28:11.460

重新同步已从 Capybara 2.0 中删除，因此 user853088 对 Selenium 的回答现在看起来像这样：

```
module CapybaraSeleniumExtension
  def drag_by(right_by, down_by)
    driver.browser.action.drag_and_drop_by(native, right_by, down_by).perform
  end
end 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-06-03T08:18:21.823

我之前加长水豚拖。
它可以将元素移动给定的偏移量。

你可以试试

```
module CapybaraExtension
  def drag_by(right_by, down_by)
    base.drag_by(right_by, down_by)
  end
end

module CapybaraSeleniumExtension
  def drag_by(right_by, down_by)
    resynchronize { driver.browser.action.drag_and_drop_by(native, right_by, down_by).perform }
  end
end

::Capybara::Selenium::Node.send :include, CapybaraSeleniumExtension
::Capybara::Node::Element.send :include, CapybaraExtension 
```

进而

```
page.find('#slider_handicap').drag_by(30, 0) 
```

但它可能不适合滑块的比例。

原来是

*   [Capybara::Node::Element#drag_to](https://github.com/jnicklas/capybara/blob/master/lib/capybara/node/element.rb)
*   [Capybara::Selenium::Node#drag_to](https://github.com/jnicklas/capybara/blob/master/lib/capybara/selenium/node.rb)
*   Selenium::WebDriver::ActionBuilder drag_and_drop 和 drag_and_drop_by

有几句话要小心。

*   此扩展可能取决于驱动程序的类型和驱动程序的版本。
*   这种拖拽测试会导致维护困难。

# iphone - 表视图返回有趣的错误

> ID：10866961
> 
> 赞同：-4
> 
> 时间：2012-06-03T00:18:19.020
> 
> 标签：iphone, objective-c, ios, xcode, cocoa-touch

好的，我正在使用目标 c 创建表视图，但数据源无法正常工作......

**我的错误：**

```
2012-06-02 20:14:39.891 Dot Golf Scoring[195:707] *** Assertion failure in -[UITableView _createPreparedCellForGlobalRow:withIndexPath:], /SourceCache/UIKit/UIKit-1914.85/UITableView.m:6061
2012-06-02 20:14:39.895 Dot Golf Scoring[195:707] *** Terminating app due to uncaught exception 'NSInternalInconsistencyException', reason: 'UITableView dataSource must return a cell from tableView:cellForRowAtIndexPath:' 
```

**我的代码：**

```
-(NSInteger) numberOfSectionsInTableView:(UITableView *)tableView {
    return 1;
}

-(NSInteger) tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {
    return 16;
}

-(NSString *)tableView:(UITableView *)tableView titleForHeaderInSection:(NSInteger)section {
    return @"Comments On Your Round";
}

-(UITableViewCell *) tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:@"Cell"];

    cell.textLabel.text = @"Text Label";

    return cell;
} 
```

***为什么表格视图没有被这些假数据填满？？？***

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-03T00:30:42.010

您永远不会初始化单元格。使用此代码：

```
 - (UITableViewCell *)tableView:(UITableView *)tableView2 cellForRowAtIndexPath:(NSIndexPath *)indexPath 

{

    UITableViewCell *cell = [tableView
                             dequeueReusableCellWithIdentifier:@"UITableViewCell"];

    if (cell == nil) {

        cell = [[[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault
                                       reuseIdentifier:@"UITableViewCell"]
                autorelease];

        cell.textLabel.text = nil;                

    }

    if (cell) {

        //customization 
        cell.textLabel.text = @"Text Label";
    }

    return cell;
} 
```

你说你是菜鸟....让我解释一下首先尝试拿起书：

大书呆子牧场指南

你在想的是出队基本上是初始化对吗？不！出队基本上是清除任何不可见的单元格，也就是滚动过去。因此，`cell == nil`可能会在四种情况下调用（我能想到的）：

1.  当我们第一次设置表格视图时（单元格将为零）
2.  当我们重新加载数据时
3.  每当我们可能到达这个班级
4.  当单元格从表格视图中变得不可见时

因此，出队的标识符就像一个 ID。然后在看if `cell`is的语句中`nil`，我们初始化`cell`，可以看到被覆盖的`init`方法：`initWithStyle`。这就是`cell`存在的类型，您可以自定义具有不同变量的不同类型。我向你展示了默认值。然后我们使用`reuseIdentifier`我们之前所说的出列标识符。他们必须匹配！我 nil`textLabel`只是为了更好的结构，在这种情况下，每个单元格都有相同的文本，所以这并不重要。它使出队的单元格以您实施的正确自定义返回。然后一旦单元格实际有效，我们就可以自定义。

此外，您对每个单元格使用相同的文本。如果您确实想为每个单元格设置不同的文本，请熟悉`NSArray`. 然后你可以提供数组，然后做这样的`count`事情`numberOfRowsForSection`：

```
cell.textLabel.text = [array objectAtIndex: [indexPath row]]; 
```

`indexPath`方法中提供的`NSIndexPath`参数在哪里`cellForRowAtIndexPath`。`row`变量是数字，`row`所以一切都合适！

哇，有很多东西要接受！现在不要再做一个客观的菜鸟了，开始读一些书吧！

欲了解更多信息，请阅读：

[表查看 Apple 文档](http://developer.apple.com/library/ios/#documentation/userexperience/conceptual/tableview_iphone/AboutTableViewsiPhone/AboutTableViewsiPhone.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-03T00:33:13.777

我认为您没有阅读[Table View Programming Guide](http://developer.apple.com/library/ios/#documentation/userexperience/conceptual/tableview_iphone/AboutTableViewsiPhone/AboutTableViewsiPhone.html)或了解 UITableViews 的重用机制；）

**UITableViews 中的单元格被重用/回收**，以避免每次需要单元格时重新分配 UITableViewCell 类的实例。这是因为 UITableView 需要大量的响应性，尤其是在滚动 tableview 时，因为滚动需要快速，并且每次分配一个新的 UITableViewCell 实例会使 tableview 在创建实例时挂起一秒钟。

**所以 UITableViewCell 重用机制背后的想法是**分配最少数量的单元格，并且每次您需要一个单元格时，尝试重用/回收以前分配但不再是用户的单元格（因为它在您滚动后就在屏幕外）。 **但是如果没有可以重复使用的单元格，您需要自己分配一个！**. 您忘记在代码中执行此部分，这就是您最终返回一个`nil`单元格的原因，这会引发异常。

* * *

因此，执行此操作的典型代码是：

```
static NSString* kCellId = @"Cell";
// First, try to reuse a cell that was previously allocated
UITableViewCell* cell = [tableView dequeueReusableCellWithIdentifier:kCellId];

// here, if a cell is returned, that means that we have an old cell
// that was used before but is no longer onscreen (so we can recycle it
// and just actualize its content)
// but if cell is nil, this means the UITableView didn't have a cell available to reuse
// so we need to create a new one
if (cell == nil)
{
   // So if we didn't have a old cell ready to reuse that have been returned, create one
   cell = [[[UITableViewCell alloc] initWithReusableIdentifier:kCellId] autorelease];
   // And configure every properties of the cell that will be common to every cell
   // and won't change even if the cell is recycled, eg:
   cell.textLabel.textColor = [UIColor redColor];
   cell.textLabel.font = [UIFont boldSystemFontOfSize:12];
   // etc
}
// And at this point, we have a cell, either newly created or that have been recycled
// So we configure every property that is row-dependant and change for each row, eg:
cell.textLabel.text = [myTextsArray objectAtIndex:indexPath.row]; 
```

*注意：我从未使用过故事板，但 AFAIK，当您使用故事板时，您不需要使用“if”语句并在没有可重复使用的单元格可用时创建单元格，因为故事板将使用您的单元格设计为您创建它故事板。但这是唯一不需要自己分配单元的情况。*

# jquery - jQuery图像选择

> ID：10866963
> 
> 赞同：1
> 
> 时间：2012-06-03T00:18:31.210
> 
> 标签：jquery, css

这应该是不言自明的，非常感谢任何帮助！

jQuery代码

```
 $("#larrow img").hide();
    $("#rarrow img").hide();

    $("#rarrow").hover(arrowIn,arrowOut);
    $("#larrow").hover(arrowIn,arrowOut);

    function arrowIn()
    {
    $(this+" img").show()
    }
    function arrowOut()
    {
    $(this+" img").hide()
    } 
```

我也尝试过以img为背景

```
 $("#larrow").css('visibility','hidden');
    $("#rarrow").css('visibility','hidden');

    $("#rarrow").hover(arrowIn,arrowOut);
    $("#larrow").hover(arrowIn,arrowOut);

    function arrowIn()
    {
    $(this).css('visibility','visible')
    }
    function arrowOut()
    {
    $(this).css('visibility','hidden')
    } 
```

显然无济于事，提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-03T00:22:13.607

您不能`this`与`img`选择器连接。无论如何，这段代码可能会更短：

```
function arrow() {
    $("img", this).toggle();
}

$("#larrow img, #rarrow img").hide();
$("#rarrow, #larrow").hover(arrow); 
```

**演示：http:** [//jsfiddle.net/4fHL3/](http://jsfiddle.net/4fHL3/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-03T00:20:24.380

由于您没有发布 Html，您可以尝试以下操作：

```
function arrowIn()
{
    $(this).show();
}
function arrowOut()
{
    $(this).hide();
} 
```

或者

```
function arrowIn()
{
    $('img', this).show();
}
function arrowOut()
{
    $('img', this).hide();
} 
```

# segmentation-fault - 虚拟 istream 和函数返回语句的段错误

> ID：10866964
> 
> 赞同：1
> 
> 时间：2012-06-03T00:19:17.070
> 
> 标签：segmentation-fault, virtual, istream

在`main()`我有标题：iostream、fstream、iomanip、MyClass.h

```
char temp;
MyClass *class1;
ifstream inf("file")
while(inf >> temp)
{ 
    if(temp == 'A') class1 = new Myclass();
    inf >> *class1; 
} 
```

在 Myclass.h 中：

```
class MyClass{
  int num;
protected:
  virtual istream& read(istream &is)
  { /* char temp; is >> temp >> num; */ 
    return is; //seg faults on this line I believe
  } 
public:
  friend istream& operator >> (istream &is, MyClass &class1) {return class1.read(is);}
}; 
```

程序应该读取一个文件，查看它是否以 开头`'a'`，然后创建一个类，并将信息解析到其中。然后`MyClass`将 istream 传递给 read 函数，这就是我遇到段错误的地方。程序段错误就像它进入 while 循环一样。如果我删除虚拟读取功能，它不会出现段错误。gdb 只是指向 0x000000001 ??

这是一个家庭作业问题，我需要为`read()`（和其他）函数编写正文。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-03T23:09:35.427

现在问题解决了！暂时我在声明中没有使用“虚拟”的那些函数。当我从 MyClass 派生子类时，我将“虚拟”放回原处，一切正常！

# java - 计算字符串中的特定字符（Java）

> ID：10866965
> 
> 赞同：8
> 
> 时间：2012-06-03T00:19:24.877
> 
> 标签：java, string, char, histogram

我有一个家庭作业来计算字符串中的特定字符。

例如：`string = "America"`

输出应该是 =`a appear 2 times, m appear 1 time, e appear 1 time, r appear 1 time, i appear 1 time and c appear 1 time`

```
public class switchbobo {

/**
 * @param args
 */     // TODO Auto-generated method stub
  public static void main(String[] args){
    String s = "BUNANA";
    String lower = s.toLowerCase();
    char[] c = lower.toCharArray(); // converting to a char array
    int freq =0, freq2 = 0,freq3 = 0,freq4=0,freq5 = 0;

    for(int i = 0; i< c.length;i++) {
        if(c[i]=='a') // looking for 'a' only
          freq++;
        if(c[i]=='b')
          freq2++;
        if (c[i]=='c') {
          freq3++;
        }

        if (c[i]=='d') {
          freq4++;
        }       
    }
    System.out.println("Total chars "+c.length);
    if (freq > 0) {
      System.out.println("Number of 'a' are "+freq);
    }
  }
} 
```

上面的代码是我所做的，但我认为拥有 26 个变量（每个字母一个）是没有意义的。你们有替代结果吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-03T00:25:18.643

显然，您对每个字母都有一个变量的直觉是正确的。

问题是你没有任何自动化的方法来对不同的变量做同样的工作，你没有任何简单的语法可以帮助你为 26 个不同的变量做同样的工作（计算单个字符频率）。

那你能做什么？我将向您提示两种解决方案：

*   您可以使用数组（但您必须找到一种将字符映射`a-z`到索引的方法`0-25`，这在某种程度上是微不足道的，因为您对 ASCII 编码的原因是）
*   您可以使用一个[`HashMap<Character, Integer>`](http://docs.oracle.com/javase/6/docs/api/java/util/HashMap.html)关联容器，在这种情况下，它允许您将数字映射到特定字符，因此它完全符合您的需求

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-03T00:25:31.697

您可以使用`HashMap`字符键和整数值。

```
HashMap<Character,Integer> 
```

遍历字符串

```
-if the character exists in the map get the Integer value and increment it.
-if not then insert it to map and set the integer value for 0 
```

这是一个伪代码，您必须尝试对其进行编码

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-09T20:47:31.917

我正在使用 HashMap 作为解决方案。

```
import java.util.*;

public class Sample2 {

/**
 * @param args
 */
public static void main(String[] args) 
 {
    HashMap<Character, Integer> map = new HashMap<Character, Integer>();
    String test = "BUNANA";
    char[] chars = test.toCharArray();

    for(int i=0; i<chars.length;i++)
    {
        if(!map.containsKey(chars[i]))
        {
            map.put(chars[i], 1);
        }
        map.put(chars[i], map.get(chars[i])+1);
    }

    System.out.println(map.toString());
 }

} 
```

产出 - {U=2, A=3, B=2, N=3}

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-03T05:27:54.543

继续杰克的回答，以下代码可能是您的解决方案。它使用一个数组来存储字符的频率。

```
public class SwitchBobo 
{
   public static void main(String[] args)
   {
      String s = "BUNANA";
      String lower = s.toLowerCase();
      char[] c = lower.toCharArray();
      int[] freq = new int[26];
      for(int i = 0; i< c.length;i++) 
      {
         if(c[i] <= 122)
         {
            if(c[i] >= 97)
            {
               freq[(c[i]-97)]++;
            }
         }        
      }
      System.out.println("Total chars " + c.length);
      for(int i = 0; i < 26; i++)
      {
         if(freq[i] != 0)   
            System.out.println(((char)(i+97)) + "\t" + freq[i]);
      }      
   }
} 
```

它将给出以下输出：

```
Total chars 6
a       2
b       1
n       2
u       1 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-28T15:43:37.210

```
int a[]=new int[26];//default with count as 0
for each chars at string
if (String having uppercase)
  a[chars-'A' ]++
if lowercase 
then a[chars-'a']++ 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-26T20:12:22.507

```
public class TestCharCount {
    public static void main(String args[]) {
        String s = "america";
        int len = s.length();
        char[] c = s.toCharArray();
        int ct = 0;
        for (int i = 0; i < len; i++) {
            ct = 1;
            for (int j = i + 1; j < len; j++) {
                if (c[i] == ' ')
                    break;
                if (c[i] == c[j]) {
                    ct++;
                    c[j] = ' ';
                }

            }
            if (c[i] != ' ')
                System.out.println("number of occurance(s) of " + c[i] + ":"
                        + ct);

        }
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-02-19T06:02:54.487

也许你可以用这个

```
public static int CountInstanceOfChar(String text, char character   ) {
    char[] listOfChars = text.toCharArray();
    int total = 0 ;
    for(int charIndex = 0 ; charIndex < listOfChars.length ; charIndex++)
        if(listOfChars[charIndex] == character)
            total++;
    return total;
} 
```

例如：

```
String text = "america";
char charToFind = 'a';
System.out.println(charToFind +" appear " + CountInstanceOfChar(text,charToFind) +" times"); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-08-04T07:21:08.390

计算字符串中的 char 'l'。

```
 String test = "Hello";
  int count=0;
  for(int i=0;i<test.length();i++){
   if(test.charAt(i)== 'l'){
       count++;
        }
    } 
```

或者

```
int count=  StringUtils.countMatches("Hello", "l"); 
```

# mysql - 具有一对多关系的 SQL 连接 - 将多个组合成一行？

> ID：10866966
> 
> 赞同：1
> 
> 时间：2012-06-03T00:19:26.077
> 
> 标签：mysql, sql

我有一个产品表和一个价格表，其中一个产品可以有多个价格行。是否可以执行一个 JOIN 语句，该语句返回每个产品的一行，其中产品等于产品 ID 的每个价格行的价格列？

现在我有这个：

```
SELECT PT.*, PR.* 
FROM `products` AS PT 
RIGHT JOIN `prices` PR 
    ON PR.`product` = PT.`ID` 
```

如果一种产品有 4 行价格，我会得到 4 行作为响应。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-03T00:37:26.710

查找 wizzbang GROUP_CONCAT 函数，它可以很好地完成您想要的操作（制作一个分隔符分隔的字符串）。

[http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html#function_group-concat](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html#function_group-concat)

```
SELECT pt.`id`, 
       group_concat(pr.`price` separator ',') 
  FROM `products` AS PT  
  LEFT JOIN `prices` PR ON PR.`product` = PT.`ID`
  GROUP BY pt.`id` 
```

# android - Android - 读取/写入内部存储的问题

> ID：10866970
> 
> 赞同：0
> 
> 时间：2012-06-03T00:20:46.703
> 
> 标签：android, file, input

我正在开发一款安卓游戏。我有一个扩展 View 的 Game 类和一个 Main Activity 类。

我正在尝试从内部存储中加载高分。我希望它在 onCreate() 中加载并保存在 onDestroy() 中。

```
Game game;
FileOutputStream fos;
FileInputStream fis;

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    game = new Game(this);

    String collected = null;

    try {
        File file = getBaseContext().getFileStreamPath(Game.FILE_NAME);
        if(!file.exists()){
            file.createNewFile();
        }

        fis = openFileInput(Game.FILE_NAME);
        byte[] dataArray = new byte[fis.available()];
        while (fis.read(dataArray) != -1){
            collected = new String(dataArray);
        }
    } catch (FileNotFoundException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    } finally{
        try {
            fis.close();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    if(collected != null) game.setHighScore(Integer.parseInt(collected));
    else game.setHighScore(0);
    setContentView(game);
    }

protected void onDestroy() {
    super.onDestroy();

    try {
        fos = openFileOutput(Game.FILE_NAME, Context.MODE_PRIVATE);
        String data = "" + game.highScore;
        fos.write(data.getBytes());
    } catch (FileNotFoundException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    } finally{
        try {
            fos.close();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}

} 
```

我正在我的 DroidX 上测试该应用程序。它在尝试读取文件时在启动时崩溃。如果我注释掉该部分以阅读它，该应用程序将运行良好并按应有的方式写入数据。如果我在保存数据时再次运行，它会正确加载。

在尝试加载文件之前如何检查文件是否存在？

提前感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-03T01:58:06.213

切换到使用[SharedPreferences](http://developer.android.com/reference/android/content/SharedPreferences.html)，它是为这个用例设计的。

这是一个例子来说明它是多么容易：

```
public class Example extends Activity {
    public static final String PREFS_NAME = "MyPrefsFile";

    @Override
    protected void onCreate(Bundle state){
       super.onCreate(state);
       . . .

       // Restore preferences
       SharedPreferences settings = getSharedPreferences(PREFS_NAME, 0);
       // Get highScore if it exists, otherwise default to zero
       int highScore = settings.getInt("highScore", 0);
       setHighScore(highScore);
    }

    @Override
    protected void onStop(){
       super.onStop();

      // We need an Editor object to make preference changes.
      // All objects are from android.context.Context
      SharedPreferences settings = getSharedPreferences(PREFS_NAME, 0);
      SharedPreferences.Editor editor = settings.edit();
      editor.putInt("highScore", mHighScore);

      // Commit the edits!
      editor.commit();
    }
} 
```

# amazon-web-services - 自定义亚马逊 SES - 删除 amazonses.com

> ID：10866971
> 
> 赞同：17
> 
> 时间：2012-06-03T00:21:24.230
> 
> 标签：amazon-web-services, amazon-ec2, amazon-ses

我终于让 SES 工作了，但现在我遇到了另一个问题
发送的电子邮件`amazonses.com`在**from**和**mailed-by**字段中留下了像这样的
我目前正在沙箱访问

```
from:    name@myDomain.com via amazonses.com 
to:  john@aol.com
date:    Sat, Jun 2, 2012 at 3:30 PM
subject:     Subject message
mailed-by:   amazonses.com 
```

**问题**：如何`amazonses.com`从这 2 个文件中删除并将“邮寄者”字段替换为我公司的电子邮件地址？

这是我的php

```
function sendMail($to, $subject, $message, $from ) {
    require_once('sdk-1.5.6.2/sdk.class.php');

    $AWS_KEY = "********************";
    $AWS_SECRET_KEY = "****************************************";

    $amazonSes = new AmazonSES(array( "key" => $AWS_KEY, "secret" => $AWS_SECRET_KEY ));

    $response = $amazonSes->send_email(
        $from,
        array('ToAddresses' => array($to)),
        array(
            'Subject.Data' => $subject,
            'Body.Html.Data' => $message,
        )
    );

    if (!$response->isOK()) {
        return false;
    }else {
        return true;
    }
    return false;
}
sendMail('john@aol.com', "Body message", "Subject message", "name@myDomain.com" ); 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-08-19T08:10:08.640

自2012 年[7 月](http://aws.amazon.com/about-aws/whats-new/2012/07/17/easily-dkim-sign-your-emails-with-amazon-ses/)以来，通过 SES 本身签署外发邮件很容易。

[说明](http://docs.aws.amazon.com/ses/latest/DeveloperGuide/easy-dkim.html)简单明了。

ps：对不起nekroposting，但这个问题是我尝试做同样事情时弹出的问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-20T07:37:15.217

你得到这个的原因是默认情况下鼓励你使用亚马逊自己的[DKIM](http://en.wikipedia.org/wiki/DomainKeys_Identified_Mail)设置。

要删除“via amazonses.com”文本，您需要按照[与这些类似的](http://br0sk.blogspot.co.uk/2012/03/dkim-email-delivery-using-amazon-ses.html)说明设置您自己的 DKIM 密钥。

请注意，我自己还没有对此进行测试。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-07-28T13:58:28.957

**将从亚马逊 ses 获得的MX**和**SPF**记录设置到您发送电子邮件的子域中。

eg: 假设amazon ses上的已验证域为：**domain.com** 然后将点击已验证域时获得的**MX**和**SPF**记录添加到子域 **-abc.domain.com**

它会将您的邮寄地址更改为**abc.domain.com**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-03T12:43:00.270

我不相信你可以。SES 仅允许从您的域（或其他经过验证的地址）发送，并且始终带有 ses 标记。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-01-15T09:55:25.663

即使您的 php 邮件的发件人地址不是来自 SES 的经过验证的电子邮件，它也会通过 SES，但会显示通过 amazonses。但是，如果发件人地址是经过 SES 验证的电子邮件，则不会显示通过地址。所以不要显示通过地址最好更改发送邮件的php脚本。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-06-13T13:57:49.657

您可以替换`mailed-by`为您公司的电子邮件地址。为此，您必须创建一个`custom MAIL FROM domain`带有子域的域，例如`sub.example.com`.

下面是您如何创建自定义 MAIL FROM 域`sub.example.com`。

单击域`example.com`。

[![在此处输入图像描述](../Images/3a16363a9d467e39f650960070c15ad9.png)](https://i.stack.imgur.com/0yDrv.png)

* * *

然后，显示细节。

[![在此处输入图像描述](../Images/d224b22515cbec915b130f75450eada1.png)](https://i.stack.imgur.com/M4CWz.png)

* * *

然后，点击`MAIL FROM Domain`显示`Set MAIL FROM Domain`按钮。

[![在此处输入图像描述](../Images/efc3405f015f861e1d075c952ff4d6bc.png)](https://i.stack.imgur.com/AF7VY.png)

* * *

然后，单击`Set MAIL FROM Domain`按钮，窗口打开。

[![在此处输入图像描述](../Images/57e55cc2ea2b322c25dd783eb622c624.png)](https://i.stack.imgur.com/6OMxI.png)

* * *

然后，将子域“sub”放入该字段并单击`Set MAIL FROM Domain`按钮。

[![在此处输入图像描述](../Images/741b44a31fac2e826d1e912cd5421638.png)](https://i.stack.imgur.com/YkVXD.png)

* * *

然后，`MX Record`和`SPF Record`被显示。除了域的记录之外，您还必须添加`MX Record`和`SPF Record`来验证自定义的 MAIL FROM 域。`Route 53``example.com``sub.example.com`

[![在此处输入图像描述](../Images/e3eba225f5e31e1be42fb695a1d24cfd.png)](https://i.stack.imgur.com/jmS5z.png)

* * *

最后，检查自定义的 MAIL FROM 域`sub.example.com`是否在部分下得到验证`MAIL FROM domain`。

[![在此处输入图像描述](../Images/5d71598bf70c65ea515adb3665735c33.png)](https://i.stack.imgur.com/obt52.png)

* * *

如果`MAIL FROM domain status`仍然是`pending verification`，请单击`retry`蓝色。

[![在此处输入图像描述](../Images/be89dc45ef6db8374a2d7ce3a552766b.png)](https://i.stack.imgur.com/ojSR7.png)

* * *

然后，它将被验证。

[![在此处输入图像描述](../Images/03a47283b0888ddf969f0951bc4ed15a.png)](https://i.stack.imgur.com/w25A3.png)

* * *

验证自定义 MAIL FROM 域后，您`mailed-by`是否 使用或`sub.example.com`发送电子邮件以及您的帐户是否在沙箱中。`example.com``sub.example.com`

# ruby-on-rails - 如何从 Rails 3 应用程序的 /lib/ 文件夹中的 ruby 脚本访问我的模型之一？

> ID：10866973
> 
> 赞同：0
> 
> 时间：2012-06-03T00:21:40.103
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我尝试将我的脚本放在从我的模型继承的类中，如下所示：

```
class ScriptName < MyModel 
```

但是当我`rake my_script`在命令行运行时，我得到了这个错误：

```
rake aborted!
uninitialized constant MyModel 
```

我究竟做错了什么？

另外，我应该命名我的文件`my_script.rb`还是`my_script.rake`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-03T00:30:27.657

只需要文件。我在我的一项 rake 任务（我命名`my_script.rake`）中执行此操作

```
require "#{Rails.root.to_s}/app/models/my_model.rb" 
```

这是一个完整的例子

```
# lib/tasks/my_script.rake

require "#{Rails.root.to_s}/app/models/video.rb"

class Vid2 < Video
  def self.say_hello
    "Hello I am vid2"
  end
end

namespace :stuff do
  desc "hello"
  task :hello => :environment do
    puts "saying hello..."
    puts Vid2.say_hello
    puts "Finished!"
  end
end 
```

但更好的设计是让 rake 任务简单地调用一个辅助方法。好处是更容易扫描可用的 rake 任务，更容易调试，并且 rake 任务运行的代码变得非常可测试。例如，您可以添加一个`rake_helper_spec.rb`文件。

```
# /lib/rake_helper.rb
class Vid2 < Video
  def self.say_hello
    "Hello I am vid2"
  end
end

# lib/tasks/myscript.rake
namespace :stuff do
  desc "hello"
  task :hello => :environment do
    Vid2.say_hello
  end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-03T03:43:31.877

我要做的就是把我的要求放在任务规范之上，然后`:environment`像这样声明标志：

```
task :my_script => :environment do
 #some code here
end 
```

仅仅通过这样做，我就可以访问我所有的模型。我不需要，`require 'active_record'`甚至`require`我的模型。

只需指定环境，我的所有模型都可以访问。

我也遇到了 Nokogiri 的问题，我所做的只是将它从文件顶部删除为 a`require`并将其添加到我的 Gemfile 中。

# android - 画布上的鼠标单击（或触摸）事件导致使用 HTML5、Phonegap 和 Android 进行选择

> ID：10866976
> 
> 赞同：13
> 
> 时间：2012-06-03T00:22:08.027
> 
> 标签：android, html, cordova, easeljs

我正在使用 easlejs + phonegap 开发 HTML5 游戏，并且遇到了每次在画布上单击/触摸/鼠标按下时屏幕闪烁的问题。

下面是我创建的用于测试问题并查看它是否与 easlejs 相关的非常简单的代码。正如您从代码中看到的那样，它与 easlejs 无关，只是一个 html5/phonegap 问题。

你可以看到我也尝试了没有选择的 CSS 样式，但没有运气。

![在画布上按住鼠标（第一张图片）然后释放它（第二张图片）时显示橙色边框的屏幕截图](../Images/e1815a2c195233f89bd075d142dce541.png)

```
<!doctype html>
<html>
<head>
    <title></title>
    <style type="text/css">
        #canvas
        {
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
        }
    </style>
</head>
<body>
    <canvas  id="canvas" width="320" height="480"></canvas>
    <script type="text/javascript">
        var canvas = document.getElementById("canvas");

        canvas.addEventListener("mousedown", function(e)
        {
            var ctx = canvas.getContext("2d");
            var x = Math.random() * 320;
            var y = Math.random() * 480;
            var w = Math.random() * 100;
            var h = Math.random() * 100;

            ctx.fillStyle = "#FF0000";

            ctx.fillRect(x,y,w,h);
        }, false);
    </script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-06-03T13:36:28.627

编辑：原来 EaselJS 仍然存在触摸显示选择的错误。为了解决这个问题，我在阅读本文后向画布添加了一个 CSS 属性：[https ://stackoverflow.com/a/7981302/66044](https://stackoverflow.com/a/7981302/66044)

解决方法是： `-webkit-tap-highlight-color: transparent;`

* * *

能够在这篇文章的帮助下解决这个问题： [Prevent page scroll on drag in IOS and Android](https://stackoverflow.com/questions/9251590/how-to-handle-touch-events-in-ios-and-android)

这是工作代码。修复是处理 touchstart/end 事件以处理点击。不再体验橙色选择阶段。

在 2.2 模拟器和我的设备中测试了这个（运行 Cyanogenmod ICS 的三星 Captivate）

```
<!doctype html>
<html>
<head>
    <title></title>
</head>
<body>
    <canvas  id="canvas" width="320" height="480"></canvas>
    <script type="text/javascript" src="cordova-1.7.0.js"></script>
    <script type="text/javascript">
        var canvas = document.getElementById("canvas");

        // FIX: Cancel touch end event and handle click via touchstart
        document.addEventListener("touchend", function(e) { e.preventDefault(); }, false);
        canvas.addEventListener("touchstart", function(e)
        {
            var ctx = canvas.getContext("2d");
            var x = Math.random() * 320;
            var y = Math.random() * 480;
            var w = Math.random() * 100;
            var h = Math.random() * 100;

            ctx.fillStyle = "#FF0000";

            ctx.fillRect(x,y,w,h);

            // FIX: Cancel the event
            e.preventDefault();
        }, false);
    </script>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-09T01:52:33.220

-webkit-tap-highlight-color: rgba(0,0,0,0); /* 进行透明链接选择，调整最后一个值 opacity 0 到 1.0 */

见：[https ://github.com/phonegap/phonegap-start/blob/master/www/css/index.css](https://github.com/phonegap/phonegap-start/blob/master/www/css/index.css)

# security - 静态类与私有实例 - 优点/缺点 - 阅读以获取更多信息

> ID：10866978
> 
> 赞同：1
> 
> 时间：2012-06-03T00:22:36.163
> 
> 标签：security, static, singleton, instance, private

我试图找出设计游戏结构的最佳方式。

目前我在任何地方都存储类实例，但我更喜欢直接使用静态访问。

例如，我有一个名为“ **GameSaveSystem.cs** ”的类

此类处理获取所有当前播放器的 StorageDevice 和所有存储相关信息。

所以我目前的策略如下

----------------MainClass.cs

```
public static void Main(string[] args) {
      new Main();
} 
```

----------------Main.cs

```
public Main() {
    GameSaveSystem save_system = new GameSaveSystem();
    singlePlayer = new SinglePlayer(save_system);
    multiPlayer = new MultiPlayer(save_system);
} 
```

----------------SinglePlayer.cs

```
SinglePlayer(GameSaveSystem save_system) {
  this.save_system = save_system;
} 
```

----------------MultiPlayer.cs

```
MultiPlayer(GameSaveSystem save_system) {
  this.save_system = save_system;
} 
```

我这样做的原因是因为在 Java 中我可以创建一个新的 .Java 文件并让它调用“ **MainClass.main(args);** ”

因此，在那个额外的类中，我可以访问存储在整个类文件中的任何静态类成员或公共静态实例。

所以我想知道的是使用实例会更安全吗？或者对于这种情况，我应该只使用静态类吗？我希望游戏对此类问题具有某种安全性。

下面是我见过的获取课程访问权限的 3 种方法

**静态访问——这个人是否可以随时随地访问这个类（这是我首选的易于使用的策略）。**

```
 ClassB.DoSomething(); 
```

**随处存储的实例 - 每个类都将存储一个类的创建实例，因此他们可以随时访问它。类拥有它们需要存储的所有实例，仅此而已。**

```
public class A(ClassB classB) {
      this.classB = classB;
}

classB.DoSomething(); 
```

**存储在一个类中的实例 - 1 个类创建所有类的单个实例，通常只创建一个实例。然后您创建这个类的一个实例并将其存储到所有需要访问先前创建的实例的类中。只有存储主实例的类才能访问其他实例。**

```
 public class A(Main main) {
       this.main = main;
  }
  main.getInstanceB().DoSomething(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-03T00:28:51.107

[在我看来，你会从这](http://en.wikipedia.org/wiki/Software_design_pattern)方面的阅读中受益。

本质上，你选择哪一个更多的是个人选择。当然，每种方法都有性能考虑，但语义也很重要。作为软件工程师，您可以决定什么是最好的。

# c# - WCF 客户端产生我不知道的错误

> ID：10866980
> 
> 赞同：0
> 
> 时间：2012-06-03T00:23:34.970
> 
> 标签：c#, wcf, web-services

我正在处理一项任务，我收到了这个我不明白的错误。我正在为工作服务编写 WCF 客户端。有谁可以帮我离开这里吗？

此行抛出错误：

```
MyComplex sumcplx = proxy.complex_sum(one,two); 
```

我得到的错误

> 错误：“NETProxyWCFClient.ProxyTypes.CalculatorClient.complex_sum(NETProxyWCFClient.ProxyTpes.MyComplex,NETProxyWCFClient.ProxyTpes.MyComplex)”的最佳重载方法匹配有一些无效参数

我的程序的代码

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.ServiceModel;
using System.Runtime.Serialization;
using System.ServiceModel.Description;

namespace NETProxyWCFClient
{
    [DataContract]
    public class MyComplex
    {
        int real;
        [DataMember]
        public int Real
        {
            get { return real; }
            set { real = value; }
        }
        [DataMember]
        int im;
        public int Im
        {
            get { return im; }
            set { im = value; }
        }

    }
    [ServiceContract]
    interface ICalculator
    {
        [OperationContract]
        int mult(int a, int b);

        [OperationContract]
        List<int> fib(int n);

        [OperationContract]
        MyComplex complex_sum(MyComplex a, MyComplex b);
    }
    class Program
    {
        static void Main(string[] args)
        {
            Console.WriteLine("Enter in 2 numbers");
            string read = Console.ReadLine();
            string[] numbers = read.Split(' ');
            int m = int.Parse(numbers[0]);
            int n = int.Parse(numbers[1]);

            ProxyTypes.CalculatorClient proxy = new ProxyTypes.CalculatorClient();

            //Multiplcation
            int sum = proxy.mult(m, n);
            Console.WriteLine(sum.ToString());

            //Mycomplex
            MyComplex one = new MyComplex();
            one.Im = m;
            one.Real = n;

            MyComplex two = new MyComplex();
            two.Im = n;
            two.Real = m;

            MyComplex sumcplx = proxy.complex_sum(one,two);
            Console.WriteLine(sumcplx.Im + " , " + sumcplx.Real);

            //fib one
            int[] listM = proxy.fib(m);
            foreach (int listItem in listM)
            {
                Console.Write(listItem.ToString() + " ");
            }
            Console.WriteLine("");

            //fib 2
            int[] listN = proxy.fib(n);
            foreach (int listItem in listN)
            {
                Console.Write(listItem.ToString() + " ");
            }

            Console.ReadLine();

        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-03T00:54:23.643

如果您在测试程序中添加了服务引用，则会为您生成一个 proxt 类，因此如果您明确定义了 ICalculator（您编写的代码），请将其删除。它已经在您的项目中，位于 NETProxyWCFClient.ProxyTpes.MyComplex,NETProxyWCFClient.ProxyTpes 命名空间下。

# javascript - 更改图像和标题

> ID：10866982
> 
> 赞同：0
> 
> 时间：2012-06-03T00:24:17.573
> 
> 标签：javascript, html, css

我正在尝试找出一种方法来更改与使用 javascript 更改的图像一起出现的文本...

```
var x = 0;
var images = new Array(".jpg", ".jpg", ".jpg", ".jpg", ".jpg");
var i = setInterval(auto, 10000);

function auto() {
    x++;
    if (x == images.length) x = 0;
    document.getElementById('bigImage').src = images[x];
}

function changeImage(img, imagetitle) {
    document.getElementById('bigImage').src = img;
    /* document.getElementById('mainimagetitle').innerHtml = imagetitle; */
}​​​ 
```

评论部分是我想我可能如何更改图像附带的文本。我如何编码html。我应该使用带有 id mainimagetitle 的 a 吗？如果是这样，我在哪里以及如何添加我想要显示和隐藏的不同文本？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-03T00:39:55.057

正如我从您的帖子中看到的那样，这应该可以完成工作。

```
<img id="bigImage" src="img1.jpg" alt="" />
<div id="mainimagetitle"></div> 
```

一定要添加一个（填充的）src 标签，否则你会在 IE 中得到奇怪的结果。当您从第二张图像（更改前的 x++）开始时，这将没有问题。我想快乐的意外。;-)

// 编辑：当然，只要您使用正确的 id，任何元素都可以。但是您没有告诉我们您使用的是什么 html (xhtml/html5/...)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-03T00:41:25.073

您可能有另一个数组来存储每个图像的标题

```
var captions = ['Caption 1', 'Caption 2', ...]; 
```

假设`mainimagetitle`是一个`<p>`元素的 id，你可以这样做：

```
function changeImage(img, imagetitle) {
     document.getElementById('bigImage').src = img;
     document.getElementById('mainimagetitle').innerText = imagetitle;
}​​​ 
```

[您可以在此处查看](http://jsfiddle.net/vCwWJ/)基于您的代码的完整示例。

# c# - Windows形式的可点击图像网格？

> ID：10866984
> 
> 赞同：1
> 
> 时间：2012-06-03T00:24:52.403
> 
> 标签：c#, winforms, image-gallery

如果这是一个愚蠢的问题，请原谅我。我有少量的 C# 经验，但还没有达到这个程度。

我有一系列图像，我想将它们放入一个网格中，每个图像周围都有空间，还有它们下面的文本，我希望它们是可点击的，所以当它们被点击时，它们会出现，双击会运行一个事件。我最好的例子是程序的用户界面`ACDSee`。我已经用谷歌搜索了几个小时，但没有提出任何适用的。这是困难的还是简单的？谁能给我一个例子，或者指出我正确的方向？

干杯。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-03T01:02:24.060

这似乎不是很困难。我建议采取以下步骤：

1.  为您的项目添加新的“用户控件”以获取图像缩略图。它的底部可以包含一个停靠`PictureBox`的和一个`Label`或。`LinkLabel`
2.  对于每个缩略图周围的空间，只需使用`Padding`用户控件的属性即可。
3.  对于将要保存缩略图的所谓网格，使用 a `FlowLayoutPanel`，并简单地将上述用户控件的实例添加到此面板。
4.  对于被选中的可视化表示，将用户控件实例的背景颜色更改为蓝色（例如），并在取消选择时返回控制面。`IsSelected`建议也为用户控件实现一个属性。
5.  要模拟缩略图选择，请处理`Click`用户控件的事件并将所有缩略图实例的事件分配给*单个事件处理程序方法*。存储对已选择缩略图的全局引用，将其命名为例如，`SelectedThumbnail`初始化为 null。在事件处理程序主体中，将`sender`与 global进行比较`SelectedThumbnail`，并在需要时对其进行更新。如果与 关联的用户控件`sender`未被选中（即，它的背景不是蓝色的，或者`IsSelected`是`false`），则使其被选中，或者改变它的背景。否则将背景更改为其默认颜色（例如，控制面）。

事件`Click`处理程序主体看起来像这样：

```
MyThumbnailControl ctrl = sender as MyThumbnailControl;
if(ctrl == null) return;
if(ctrl == SelectedThumbnail) return; // selected again
if(ctrl != SelectedThumbnail)
{
    ctrl.IsSelected = true;
    ctrl.BackColor = Color.Blue; 
    // it's better to set the back-color in the IsSelected property setter, not here
    SelectedThumbnail.IsSelected = false;
    SelectedThumbnail.BackColor = Color.Control;
    SelectedThumbnail = ctrl; // important part
} 
```

还建议将要添加到所谓网格的所有缩略图实例也在单独的数组中引用。因此，通过简单的索引计算可以使用箭头键更改选择。

* * *

进一步说明：我假设要创建的用户控件名为`MyThumbnailControl`，只是一个随机名称来引用该控件。当您创建一个新的用户控件时，向导会为您生成一个具有您想要的名称（例如，`MyThumbnailControl`）的类，您可以在其中定义一个名为的属性`IsSelected`并实现它的 getter 和 setter。请参阅[此](http://msdn.microsoft.com/en-us/library/a6h7e207%28v=vs.71%29.aspx)获取教程。定义用户控件后，您可以从其相应的类中实例化实例。同样通过全局引用，我的意思是表单（或任何父控件）级别的变量。为简单起见，我们可以在将保存网格和缩略图的表单中添加所选缩略图的引用：`MyThumbnailControl selectedThumb = null;`或者在表单正文中添加类似的内容。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-03T02:37:26.207

这里有东西，我刚刚修好了你。

创建一个 C# 项目名称**CreateImageList**并在 Form1 中添加以下 5 个默认名称的控件，即 Panel1、PictureBox1、Label1、Button1、Button2：

![在此处输入图像描述](../Images/45ed996f22f2fa8329562d5c00dbd938.png)

这个怎么运作：

1.  当页面加载时，它会创建一个 imageList 对象并从您提供的文件夹中加载所有 .jpg 图像
2.  ImageList 图像被设置到 PictureBox 控件中，当用户单击“Button1”时，图片框显示 ImageList 中的下一个图像，当用户单击“Button2”时，PictureBox 显示 ImageList 中的上一个图像。
3.  Label1 显示来自 ImageList Arrage 的 currentImage 计数器。如果你想写一些特定的东西，你可以创建一个文本数组并与你的图像计数器同步。
4.  当用户单击 PictureBox 时，将创建一个边框以显示突出显示的图片
5.  当用户双击 PictureBox 时，会出现一个 MessageBox，显示 DoubleClick 事件。

现在，您可以使用以下代码：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.IO;

namespace CreateImageList
{
public partial class Form1 : Form
{
    private int currentImage = 0;
    protected Graphics myGraphics;
    ImageList iPicList = new ImageList();

    public Form1()
    {
        InitializeComponent();
        DirectoryInfo dirImages = new DirectoryInfo("C:\\2012");
        iPicList.ImageSize = new Size(255, 255);
        iPicList.TransparentColor = Color.White;
        myGraphics = Graphics.FromHwnd(panel1.Handle);

        foreach (FileInfo file in dirImages.GetFiles())
        {
            if (file.Extension == ".jpg")
            {
                Image myImage = Image.FromFile(file.FullName);
                iPicList.Images.Add(myImage);
            }
        }

        if (iPicList.Images.Empty != true)
        {
            panel1.Refresh();
            currentImage = 0;
            // Draw the image in the panel.
            iPicList.Draw(myGraphics, 1, 1, currentImage);
            // Show the image in the PictureBox.
            pictureBox1.Image = iPicList.Images[currentImage];
            label1.Text = "Image #" + currentImage;
        }

    }

    private void showImage(int imgIndex)
    {
        // Draw the image in the panel.
        iPicList.Draw(myGraphics, 1, 1, currentImage);
        // Show the image in the PictureBox.
        pictureBox1.Image = iPicList.Images[currentImage];
        label1.Text = "image #" + currentImage;
        panel1.Refresh();
    }

    private void button1_Click(object sender, EventArgs e)
    {
        if (iPicList.Images.Count - 1 > currentImage)
        {
            currentImage++;
        }
        else
        {
            currentImage = 0;
        }
        showImage(currentImage);
    }

    private void button2_Click(object sender, EventArgs e)
    {
        if (iPicList.Images.Count - 1 >= currentImage)
        {
            if (currentImage == 0)
                currentImage = iPicList.Images.Count-1;
            else
                currentImage--;
        }
        else
        {
            currentImage = iPicList.Images.Count;
        }
        showImage(currentImage);
    }

    private void pictureBox1_DoubleClick(object sender, EventArgs e)
    {
        MessageBox.Show("Picture Box Double clicked");
    }

    private void pictureBox1_Click(object sender, EventArgs e)
    {
        panel1.Refresh();
        myGraphics.DrawRectangle(Pens.Black, 0, 0, iPicList.Images[currentImage].Width + 1, iPicList.Images[currentImage].Height + 1);
        pictureBox1.Image = iPicList.Images[currentImage];
    }
}
} 
```

您需要的更改是：

将以下文件夹更改为您有很多 jpg 的地方：

```
DirectoryInfo dirImages = new DirectoryInfo("C:\\2012"); 
```

此外，如果您正在处理其他类型的图像，请在此处进行更改：

```
if (file.Extension == ".jpg") // Change it to your image type. 
```

如果您不想使用按钮上下移动，您还有其他几个选项可以在可滚动面板或列表或其他内容中托管 PictureBox 控件。

# python - 此消息总是指索引问题？IndexError：索引超出范围

> ID：10866985
> 
> 赞同：3
> 
> 时间：2012-06-03T00:25:11.200
> 
> 标签：python, numpy

为什么我会收到此消息？

```
 Traceback (most recent call last):
  File "C:\EclipseWorkspaces\csse120\Lake2\Mainloop2.py", line 46, in <module>

Q[i+1]=Qn(HSR[i],TD[i],FW[i],TempLake[i][0])

IndexError: index out of bounds

Nlayers=23
N=365

HSR=Hsr(rad)
TD=Td(air,neb)
FW=Fw(wind)

def main_loop(Z,z,Areat0,Areat1,TempLake,wind,Q0,Q1):
    n=TempLake.size
    var00=Imp_scheme(Q0,Q1,z,Areat0,Areat1,Z,TempLake,wind)
    var01=fix_profile(n,var00,Areat0)
    return var01

TempLake=np.zeros((N,Nlayers))
TempLake[0]=T0

Q=np.zeros(N)
Q[0]=0.0
for i in xrange(N):
    Q[i+1]=Qn(HSR[i],TD[i],FW[i],TempLake[i][0])
    TempLake[i+1]=main_loop(Z,z,Areat0,Areat1,TempLake[i],wind[i],Q[i],Q[i+1]) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-03T00:28:35.917

`xrange(N)`为您提供从 0 到 N-1 的值。您正在向其中添加一个，因此您可以`Q`从索引 1 到 N 访问。但`Q`只有 N 个元素，因此 N 比最高索引 N-1 多一。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-03T00:28:21.777

在 for 循环的最后一次迭代中，程序尝试访问 Q[i+1]，即 Q[N]。Q 的大小为 N，但索引从 0 开始，Q[N-1] 实际上是最后一项。

# java - java不能引用非final变量

> ID：10866987
> 
> 赞同：3
> 
> 时间：2012-06-03T00:25:29.680
> 
> 标签：java, class, gwt

以下代码继续给我：

> 无法在不同的方法 Login.java /ChurchWebLogin/src/com/gwt/churchweb/churchweblogin/client 第 61 行定义的内部类中引用非最终变量 textBoxPassword

```
package com.gwt.churchweb.churchweblogin.client;

import com.google.gwt.user.client.ui.Composite;
import com.google.gwt.user.client.ui.VerticalPanel;
import com.google.gwt.user.client.ui.Label;
import com.google.gwt.user.client.ui.FlexTable;
import com.google.gwt.user.client.ui.TextBox;
import com.google.gwt.user.client.ui.HasHorizontalAlignment;
import com.google.gwt.user.client.ui.CheckBox;
import com.google.gwt.user.client.ui.Button;
import com.google.gwt.event.dom.client.ClickHandler;
import com.google.gwt.event.dom.client.ClickEvent;
import com.google.gwt.user.client.Window;

public class Login extends Composite {

    public Login() {

        VerticalPanel verticalPanel = new VerticalPanel();
        initWidget(verticalPanel);
        verticalPanel.setSize("329px", "186px");

        Label lblNewLabel = new Label("Sign into your account");
        lblNewLabel.setStyleName("gwt-Login-SigninLabel");
        verticalPanel.add(lblNewLabel);

        FlexTable flexTable = new FlexTable();
        verticalPanel.add(flexTable);
        flexTable.setWidth("308px");

        Label lblNewLabel_1 = new Label("Username:");
        lblNewLabel_1.setStyleName("gwt-Label-Login");
        flexTable.setWidget(0, 0, lblNewLabel_1);
        lblNewLabel_1.setWidth("72px");

        TextBox textboxUsername = new TextBox();
        textboxUsername.setStyleName("gwt-LoginTextBox");
        flexTable.setWidget(0, 1, textboxUsername);
        textboxUsername.setWidth("204px");

        Label lblNewLabel_2 = new Label("Password:");
        lblNewLabel_2.setStyleName("gwt-Label-Login");
        flexTable.setWidget(1, 0, lblNewLabel_2);
        lblNewLabel_2.setWidth("66px");

        TextBox textBoxPassword = new TextBox();
        textBoxPassword.setStyleName("gwt-LoginTextBox");
        flexTable.setWidget(1, 1, textBoxPassword);
        textBoxPassword.setWidth("204px");
        flexTable.getCellFormatter().setHorizontalAlignment(0, 0, HasHorizontalAlignment.ALIGN_LEFT);
        flexTable.getCellFormatter().setHorizontalAlignment(1, 0, HasHorizontalAlignment.ALIGN_LEFT);

        CheckBox chckbxRememberMeOn = new CheckBox("Remember me on this computer");
        chckbxRememberMeOn.setStyleName("gwt-Checkbox-Login");
        flexTable.setWidget(2, 1, chckbxRememberMeOn);

        Button btnSignIn = new Button("Sign In");
        btnSignIn.addClickHandler(new ClickHandler() {
            public void onClick(ClickEvent event) {
                if (textboxUsername.getText().length() == 0
                        || textBoxPassword.getText().length() == 0) {
                        Window.alert("Username or password is empty."); 
                    }
            }
        });

        btnSignIn.setStyleName("gwt-Login-SigninButton");
        flexTable.setWidget(3, 1, btnSignIn);

    }

} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-03T00:29:31.877

```
final TextBox textboxUsername = new TextBox(); 
```

和

```
final TextBox textBoxPassword = new TextBox(); 
```

应该修复它。

Java 要求对来自内部类的变量的引用是`final`变量（我想是出于并发管理的原因）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-03T00:34:14.847

如果在内部类中使用局部变量，则必须声明`final`它们。你应该写：

```
final TextBox textBoxPassword = new TextBox(); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-17T11:55:00.990

匿名类实例应该能够访问周围作用域的局部变量和参数。然而，一个实例可能比它被构想的方法寿命更长（作为将实例的引用存储在一个字段中的结果），并尝试访问方法返回后不再存在的局部变量和参数。

因为 Java 不能允许这种非法访问，这很可能会使虚拟机崩溃，所以它只允许匿名类实例访问声明为 final 的局部变量和参数。在匿名类实例中遇到最终的局部变量/参数名称时，编译器会执行以下两项操作之一：

*   如果变量的类型是原始类型（例如 int 或 double），编译器会将其名称替换为变量的只读值。
*   如果变量的类型是引用（例如字符串），编译器会在类文件中引入合成变量（制造变量）和将局部变量/参数的引用存储在合成变量中的代码。

# python - Django 多标签字段

> ID：10866990
> 
> 赞同：3
> 
> 时间：2012-06-03T00:26:13.143
> 
> 标签：python, django, tags, manytomanyfield

我正在尝试为 django 如何在模型中创建多个标签找到一个很好的教程。

例如：

```
class Tag(models.Model):
   name = models.CharField()

class Sample(models.Model):
   name = models.CharField()
   urlA  = models.CharField()
   urlB  = models.CharField()
   tagA = models.ManyToManyField(Tag)
   tagB = models.ManyToManyField(Tag) 
```

我想将标签显示为输入字段并用“，”分隔并在保存方法中拆分。所以我想看到 2 标签字段的 2 个不同的输入。

如果您有简单的方法或知道一个好的教程，请告诉我！:)

感谢你们！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-03T08:33:07.153

编辑：您不必覆盖实际的表格集。您可以生成任何您想要在视图中添加的查询集。您的 url conf 可以设置为显示来自多个 url 的详细视图。如果我仍然不理解，请完善您的问题。

对于拥有多个任何标签的类别，您可以选择 m21 或 m2m。因此，当您创建标签时，您可以一一添加它们。你熟悉 Django ORM 提供的一些管理功能吗？请仔细阅读文档。你解决这个问题的方法一点也不合理。不要试图以错误的方式摩擦你，我不是天才。你会做这样的事情。

```
class Tag(models.Model):
    title = models.CharField(max_length=250, blank=True)
    slug = models.SlugField(blank=True

    class Meta:
        verbose_name = "tag"
        verbose_name_plural = "tags"
        ordering = ['title']

    @models.permalink
    def get_absolute_url(self):
     return "/tags/%s/" % self.slug

class Entry(models.Model):
    title = models.CharField(max_length=250, blank=True)
    body = models.TextField()
    tags = models.ManyToMany('Tag')
    slug = models.SlugField()

    @models.permalink
    def get_absolute_url(self):
        return "/blog/%s/" % self.slug 
```

对于 EntryAdmin 和 TagAdmin 模型还有一些代码要做，还有许多其他的事情可以做。如果您可以更清楚，我不确定您要达到什么目的？谢谢，以上是我如何处理它的粗略说明。

# iphone - 带有按钮的 UISegmentedControl

> ID：10866994
> 
> 赞同：0
> 
> 时间：2012-06-03T00:27:00.513
> 
> 标签：iphone, objective-c, ios, ipad, uisegmentedcontrol

所以我有一个带有自定义 backgroundImage 的 UISegmentedControl。这是我设置它的方法：

```
UISegmentedControl * segmentedCtrl = [[UISegmentedControl alloc] initWithFrame:CGRectMake(0, 0, 178, 30)];
[segmentedCtrl setSegmentedControlStyle:UISegmentedControlStyleBar];
[segmentedCtrl setTintColor:[UIColor clearColor]];

[segmentedCtrl setSegmentedControlStyle:UISegmentedControlStyleBezeled];
[segmentedCtrl insertSegmentWithImage:[UIImage imageNamed:@"btn-home-down.png"] atIndex:0 animated:NO];
.....
 [segmentedControl setImage:[UIImage imageNamed:@"btn-home.png"]  forSegmentAtIndex:0];
    [segmentedControl setImage:[UIImage imageNamed:@"btn-popular.png"] forSegmentAtIndex:1];
    [segmentedControl setImage:[UIImage imageNamed:@"btn-my-photos.png"] forSegmentAtIndex:2];
    [segmentedControl setImage:[UIImage imageNamed:@"btn-places.png"] forSegmentAtIndex:3];
    [segmentedControl setImage:[UIImage imageNamed:@"btn-my-likes"] forSegmentAtIndex:4]; 
```

现在问题是这样的：

![在此处输入图像描述](../Images/3b4b0ba6bf103fa246ed876959ccc36f.png)

如果您在分段图像之间仔细观察，在底部的分隔线上我有点像有一个白点。我所有的图像都设置为正方形。为什么会这样，我该如何消除？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-03T00:34:27.233

也许你可以得到一个 UIImageView，它只有一个像素，颜色应该是白色像素。然后你可以把它放在白色像素的顶部。这可能不是最好的方法，但它确实有效。

希望这可以帮助。

# javascript - js/jquery/other 库插件来转换 HTML->XML

> ID：10866997
> 
> 赞同：0
> 
> 时间：2012-06-03T00:28:29.273
> 
> 标签：javascript, jquery, html, xml

你知道任何转换 HTML->XML 的 JS 库吗？

不仅是干净的 HTML，还有格式不正确（或“脏”）的真实世界 HTML？

这样的库在 JS 中可用还是我必须进入服务器端库（如 Java 等）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-03T00:53:32.310

有几个针对 Node 的宽容的 HTML 解析 JS 库，但如果你真的需要，它们应该可以在浏览器中工作。

*   [html解析器](https://github.com/tautologistics/node-htmlparser)
*   [htmlparser2](https://github.com/fb55/node-htmlparser)
*   [HTML5 解析器](https://github.com/aredridel/html5)

您可以将其中之一与从 JS 对象输出 XML 的[东西结合起来。](https://github.com/soldair/node-jsontoxml)

# ruby-on-rails-3 - rails 3中对象数组的助手

> ID：10866999
> 
> 赞同：0
> 
> 时间：2012-06-03T00:28:49.017
> 
> 标签：ruby-on-rails-3

我有一个 rails 3 辅助功能。这个函数只接受一个对象数组并根据每个对象中的 url 返回图像。出于某种原因，我似乎无法打印图像……我只是取回了数组。

例如：

```
def my_helper(items)
 items.each do |item|
   image_tag(item)
 end
end 
```

这将返回数组。我试过分配给一个变量并输出，但没有运气。我见过人们说只是使用`item.join('<br/>')`，但我没有让它发挥作用。

帮助赞赏

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T14:02:58.513

这应该有效：

```
def my_helper(items)
  items.map do |item|
    image_tag(item)
  end.join('<br/>')
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-03T00:40:03.487

该[`each`](http://ruby-doc.org/core-1.9.3/Array.html#method-i-each)方法返回它迭代的原始列表（在您的示例中，`items`）。要得到你想要的，你可以使用[`map`](http://ruby-doc.org/core-1.9.3/Array.html#method-i-map)：

```
def my_helper(items)
  items.map do |item|
    image_tag(item)
  end
end 
```