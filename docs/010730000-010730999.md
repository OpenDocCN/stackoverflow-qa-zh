# StackOverflow 问答 10730000-10730999

# xml - 什么意思 在 xsl：变量中？

> ID：10730003
> 
> 赞同：2
> 
> 时间：2012-05-24T01:24:41.413
> 
> 标签：xml, xslt, xslt-2.0

我对“步入”一无所知`xsl:variable`。如果有人能解释“步骤”，我将不胜感激。

以下 XSLT 仅在根元素中包含 2 个元素。

`xsl:output`定义输出格式； `xsl:variable`定义变量；

如何解析这段代码？这段代码代表什么？

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
  xmlns:saxon="http://saxon.sf.net/"
  version="2.0"
  extension-element-prefixes="saxon">

  <xsl:output method="html" omit-xml-declaration="yes"
    encoding="utf-8" indent="no"/>

  <!-- <xsl:output method="xml" omit-xml-declaration="no"
    encoding="utf-8" indent="no"/> -->

  <xsl:variable name="processes">
    <!-- exclude elements with @specific-use='print-only' -->
    <step>prep/jpub3-webfilter.xsl</step>
    <!-- format citations in NLM/PMC format -->
    <step>citations-prep/jpub3-PMCcit.xsl</step>
    <!-- convert into HTML for display -->
    <step>main/jpub3-html.xsl</step>
  </xsl:variable>

  <xsl:include href="main/shell-utility.xsl"/>

</xsl:stylesheet> 
```

补充“shell-utility.xsl”

```
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
  xmlns:saxon="http://saxon.sf.net/"
  version="2.0"
  extension-element-prefixes="saxon">

  <!-- This stylesheet does not stand alone! It is a component
       to be called into XSLT 2.0 shell stylesheets. -->

  <xsl:variable name="document" select="/" saxon:assignable="yes"/>

  <xsl:param name="runtime-params">
    <base-dir>
      <xsl:value-of
        select="replace(base-uri(/), '/[^/]+$','')"/>     
    </base-dir>
  </xsl:param>

  <xsl:template match="/">
    <xsl:for-each select="$processes/step/concat('../',.)">
      <xsl:message>
        <xsl:text>&#xA;... Applying </xsl:text>
        <xsl:value-of select="."/>
      </xsl:message>
      <saxon:assign name="document"
        select="saxon:transform(
                  saxon:compile-stylesheet(doc(.)),
                  $document,
                  $runtime-params/* )"/>
      <!-- A third argument to saxon:transform could specify
           runtime parameters for any (or all) steps -->
    </xsl:for-each>
    <xsl:sequence select="$document"/>
    <xsl:message>&#xA;... Done</xsl:message>
  </xsl:template>

</xsl:stylesheet> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T01:33:24.310

代码只是创建了一个名为的变量，并为其分配了一个包含三个元素`processes`的节点列表。就 XSL 解析器而言，`<step>`这些元素本身没有任何意义。`<step>`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T03:48:44.450

> 这段代码代表什么？
> 
> ```
>  <xsl:variable name="processes">     
>   <!-- exclude elements with @specific-use='print-only' -->     
>   <step>prep/jpub3-webfilter.xsl</step>     
>   <!-- format citations in NLM/PMC format -->     
>   <step>citations-prep/jpub3-PMCcit.xsl</step>     
>   <!-- convert into HTML for display -->     
>   <step>main/jpub3-html.xsl</step>   
>  </xsl:variable> 
> ```

这是一个名为`processes`和类型的全局变量的定义`document-node()`——它的值是一个临时树，其中包含三个`step`元素，这些元素是文档节点的子节点。

如何使用此变量取决于包含的样式表模块的代码，该模块位于： `main/shell-utility.xsl`. 由于未提供此代码，因此无法说明该`processes`变量的实际用法。

# c++ - 确定用于呈现文本的字符的 y 位置

> ID：10730004
> 
> 赞同：5
> 
> 时间：2012-05-24T01:24:46.907
> 
> 标签：c++, winapi, text, typography, bitmap-fonts

我一直在研究自己的位图字体渲染器，虽然我相信我的字符间距可能正确，但我不确定如何确定字符的 y 位置。例如，如果字母 'a' 的位置为 0，那么 '*' 或 ',' 会有什么？我一直在使用 winapi 函数`GetCharABCWidthsFloatW`来确定字符之间的间距，还有其他函数可以用来确定某种 y 偏移量吗？

我的位图图像最适合我，所以它们的大小并不总是相同。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T07:29:36.387

每个字符本身都应该通过文本呈现 API 正确地在 y 方向偏移（`TextOut`、`DrawText`等），因此您应该有一个恒定的偏移量。我总是使用字符串“Ag”`GetTextExtentPoint32`的指标来获取一般指标，此外您可以尝试[GetTextMetrics](http://msdn.microsoft.com/en-us/library/dd144941%28v=vs.85%29.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T03:08:02.633

GetTextMetrics 是正确的答案。但demorge 可能想说，您需要用于 Y 坐标的字段是 tmAscent（查看结构。）

总高度为 tmHeight。tmAscent 是从顶部到基线的距离。而 tmDescent 是基线和字体底部之间的距离。

因此，在大多数情况下，如果 (x, y) 坐标参考文本的左上角，则需要添加 tmAscent。如果 y 坐标是底部，则减去 tmDescent（+ 或 - 也取决于您是否反转视口，但您可以测试并查看您得到的结果。）

无论您写“a”、“*”还是“j”，该信息都有效。所有字符的基线都是相同的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-30T18:17:58.440

**一般字体信息：**

您正在寻找的是如何将文本放置标准化为“基线”或“原点”（相同的概念）。您可以根据您的坐标系使用上升（上升）或下降（下降）来执行此操作。

[http://www.freetype.org/freetype2/docs/tutorial/step2.html](http://www.freetype.org/freetype2/docs/tutorial/step2.html)

这提供了一组非常好的与排版相关的示例图像。

**一般位图字体信息：**

现在，关于位图图像，确保它们都正确排列的最简单方法是在您的 sprite 表中为每个字符的位图表示具有相同的高度（宽度应该根据实际字符宽度而有所不同）。如果您这样做，那么您可以简单地根据该共享高度排列所有内容。

但是，如果要剪裁字符周围多余的空白，则需要将剪裁的值与字形一起存储在某些结构中，以便确定偏移量。如果 API 为您执行此操作，则它们可能具有上升/下降、原点/基线或行高类型的方法，您可以在其中基于字符获取完整尺寸，以便正确执行此操作。

**Api 特定信息**
编辑：根据其他答案，这里是您的 API 特定问题的相关链接：

GetTextMetrics： http:
[//msdn.microsoft.com/en-us/library/dd144941 (v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/dd144941(v=vs.85).aspx)

TEXTMETRIC 结构： http:
[//msdn.microsoft.com/en-us/library/dd145132 (v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/dd145132(v=vs.85).aspx)

tmAscent 或 tmDescent 可用于帮助偏移您的 y 坐标。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-28T16:34:42.820

如果我理解正确：每个字形的位图最初的高度相同。然后修剪每个字形周围的所有空闲空间，为每个字符创建一个最小的位图。

在这种情况下，答案很简单。创建修剪位图时，请记住从左侧和顶部（或左侧和底部，取决于您定位字形的方式）移除了多少像素。绘制位图时，您可以使用保存的值调整坐标。

但是，如果您尝试使用字体度量来确定从每个位图中修剪多少，则不能。

# tomcat - 如何对来自 Tomcat 服务器的下载请求进行带宽控制

> ID：10730013
> 
> 赞同：1
> 
> 时间：2012-05-24T01:25:53.277
> 
> 标签：tomcat, scalability

我有一个将位于 Amazon EC2 实例的 tomcat 服务器。它将为大约 10000 个客户端的文件下载请求提供服务。

```
Each client will follow the steps to download some files:
(1) Send request to Tomcat to check if need to update files
(2) Tomcat will send the file list to client if any
(3) Client will download the file list via HTTP servlet. 
```

基本上我们希望在Tomcat服务器高负载时实现目标（由于带宽/会话限制等），Tomcat会向客户端请求返回一个INTERVAL，然后客户端将等待INTERVAL时间重新发送下载请求。有没有什么好的方法来设计这样的风景？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T04:03:00.977

您应该查看 HTTP Cache 控件和 Range 标头来帮助管理它。这对于你想做的事情来说几乎是死气沉沉的。

如果您使用的是静态文件（即 Tomcat 将直接提供服务的文件与通过 Servlet 或其他类似事物生成的一些动态内容），那么 Tomcat 将自动为您提供 Range 标头。

游戏是，您的客户端必须发出实际使用 Range 标头的 HTTP 请求，并且客户端必须是限制连接的客户端。

如果您的客户愿意承担这个责任，那么开箱即用的 Tomcat 应该可以正常工作，只需通过服务器发布文件系统目录即可。开箱即用，它将显示目录中文件的列表，然后您可以使用 Caching 标头来确定发生了什么变化，并使用 Range 标头来打包内容。

# bdd - 如何使用不同的参数多次运行故事

> ID：10730015
> 
> 赞同：1
> 
> 时间：2012-05-24T01:26:40.640
> 
> 标签：bdd, jbehave

1.  我开发了一个 jBehave 故事来测试我们系统中实现的一些工作流程。假设这个故事叫做 customer_registration.story

2.  这个故事是我们系统支持的其他一些更复杂的工作流程的起点。不同的故事也涵盖了那些更复杂的工作流程。假设我们有一个由 customer_login.story 覆盖的更复杂的工作流程

所以 customer_login.story 看起来像下面这样：

```
Story: Customer Login

Narrative:

In order to access ABC application
As a registered customer
I want to login into the application

Scenario: Successfully login into the application

GivenStories: customer_registration.story

Given I am at the login page
When I type a valid password
Then I am able to see the application main menu 
```

一切都很完美，我对此很满意。

3.上面第1点的故事（客户注册）是我需要在不同的数据集上运行的东西。假设我们的系统支持 i18n，我们需要检查所有支持的语言的客户注册故事是否运行正常，假设我们想测试我们的客户注册在 en-gb 和 zh-tw 上都可以正常运行

所以我需要实现一个 multi_language_customer_registration.story 看起来像这样：

```
Story: Multi language customer registration

Narrative:

In order to access ABC application
As a potential customer
I want to register for using the application

Scenario: Successfully customer registration using different supported languages

GivenStories: customer_registration.story

Then some clean up step so the customer registration story can run again

Examples:
|language|
|en-gb   |
|zh-tw   | 
```

关于如何实现这一目标的任何想法？请注意，下面的内容不是一个选项，因为我确实需要在运行之间运行清理步骤。

```
GivenStories:  customer_registration.story#{0},customer_registration.story#{1} 
```

在客户注册故事中移动清理步骤也不是一种选择，因为登录故事将停止工作。

提前致谢。

PS 正如您在现实中可能猜到的那样，我们创建的故事更复杂，重构它们并非易事，但我很高兴这样做以获得真正的收益。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T17:34:17.290

从战术的角度来看，我会这样做：

在您的 .story 文件中

```
Given I set my language to {language}
When I type a valid password {pass}
Then I am able to see the application main menu

Examples:
|language|pass|
|en-gb   |password1|
|zh-tw   |kpassword2| 
```

然后在你的Java文件中，

```
@Given ("I set my language to $lang")
@Alias ("I set my language to {language}") 
```

// 方法在这里

```
@When ("I type a valid password $pwrd")
@Alias ("I type a valid password {pass}") 
```

// 方法在这里

```
@Then ("I am able to see the application main menu") 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-30T20:03:22.477

首先，BDD 与测试不同。我不会在每一个 i18n 场景中都使用它。相反，隔离处理 i18n 的位并对其进行单元测试，手动测试一对并将其称为完成。如果你真的需要更彻底，那么将它与几种语言一起使用，但不要对所有语言都这样做 - 只是足够的例子给你一些安全。

现在与客户交流一下。首先，登录和注册真的那么有趣吗？一旦你让它们工作，你有可能改变它们吗？登录或注册对于您的业务有什么特别之处吗？如果没有，请尝试将这些东西*排除*在场景之外——维护起来比它的价值更痛苦，如果它永远不会改变，你可以手动测试一次。

显示用户登录内容的场景*通常*对企业来说更有吸引力和有趣[（您*正在*与企业进行对话，对吗？）](https://stackoverflow.com/a/4248991/363592)。

否则，您可以通过以下三种方式设置上下文（给定）：

*   通过破解数据（因此直接访问数据库）
*   通过 UI（或控制器，如果您从该级别自动化）
*   通过使用现有数据。

您还可以查看数据是否存在，如果不存在，请进行设置。因此，例如，如果您的客户已注册并且您不希望他注册，您可以删除他的注册作为设置上下文的一部分（运行 Given 步骤）；或者如果你需要他注册而他没有，你可以通过 UI 来注册他。

最后，JBehave 有一个[`@AfterScenario`](http://jbehave.org/reference/stable/annotations.html)注释，您可以使用它来表示该场景的清理步骤。步骤是可重用的 - 您可以从代码中的另一个步骤中调用场景的步骤，而不是使用 JBehave 的机制（这在 IMO 中更易于维护），这将允许您在登录时避免清除注册。

希望这些选项之一对您有用！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T06:12:21.400

大多数单元测试框架都支持这一点。

看看 mstest 如何指定 DataSource，nunit 类似 [https://github.com/leblancmeneses/RobustHaven.IntegrationTests](https://github.com/leblancmeneses/RobustHaven.IntegrationTests)

不幸的是，我见过的一些 bdd 框架试图替换现有的单元测试框架，而它应该一起工作以重用基础设施。

[https://github.com/leblancmeneses/BddIsTddDoneRight](https://github.com/leblancmeneses/BddIsTddDoneRight) 是流利的 bdd 语法，可以与 mstest/nunit 一起使用并与现有的测试运行程序一起使用。

# ruby-on-rails - Rails 片段缓存渲染的液体模板

> ID：10730017
> 
> 赞同：9
> 
> 时间：2012-05-24T01:26:58.760
> 
> 标签：ruby-on-rails, memcached, liquid

使用 ERB，您可以在列表视图中分段缓存单个记录，如下所示：

```
<% @items.each do |item| %>
  <% cache item do %>
    <%= item.name %>
  <% end %>
<% end %> 
```

因此，第二次查看列表时，将从缓存中加载每个呈现的项目。使用 Liquid 模板时是否可以使用相同的方法？该模板可能类似于：

```
{% for item in items %}
  {{ item.name }}
{% endfor %} 
```

并呈现：

```
template = Liquid::Template.parse(template)
template.render('items' => @items) 
```

当它遍历项目时，我希望能够对每个项目进行分段缓存。任何指针？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-28T07:48:34.990

您可以在液体中定义自定义标签，例如，如果您将其放入初始化程序中

```
class Cacher < Liquid::Block
  def initialize(tag_name, markup, tokens)
     super
    @key= markup.to_s
  end

  def render(context)
    Rails.cache.fetch(@key) do
      super
    end
  end
end

Liquid::Template.register_tag('cache', Cacher) 
```

然后你可以做

```
{% cache "some_key" %}
  ...
{% endcache %} 
```

构造缓存键的方式要*非常*小心。您当然希望避免冲突，但您也可能不希望人们能够从您的 memcache 存储中读取任意键（这段代码就是这样做的）。这有多重要取决于谁可以在您的应用程序中访问它。一种策略是命名空间缓存键。

# c++ - jsoncpp - 由于类型不完整，无法定义 Json::Reader

> ID：10730019
> 
> 赞同：2
> 
> 时间：2012-05-24T01:27:21.460
> 
> 标签：c++, json, jsoncpp

当我遵循 jsoncpp 中的简单代码示例时出现此错误，基本上就像

`Json::Reader reader;`

如何解决这个问题？该类型对我来说看起来很完整，但它不像 g++ 足以告诉我缺少什么或任何东西。

`error: aggregate Json::Reader reader has incomplete type and cannot be defined`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T01:30:06.200

应该是`#include <json.h>`，而不是我需要的个别课程，每`README.txt`.

# objective-c - 在 IBOutletCollection 中为单个实例设置默认值？

> ID：10730022
> 
> 赞同：0
> 
> 时间：2012-05-24T01:27:51.877
> 
> 标签：objective-c, ios

我有一个 IBOutletCollection，它加载从我的 ViewController.m 实例化的自定义 UI 控件。然后将控件复制到 .xib 中。唯一的问题是它们都具有相同的默认值。有没有办法解决 IBOutletCollection 数组中的单个索引并设置默认值？

# java - 光栅格式异常 (Java)

> ID：10730028
> 
> 赞同：0
> 
> 时间：2012-05-24T01:29:12.113
> 
> 标签：java

我正在尝试使用一些代码，例如在另一个问题的答案中看到的：[https ://stackoverflow.com/a/621849/1044984](https://stackoverflow.com/a/621849/1044984)

使用它时，我收到以下错误：

```
Exception in thread "AWT-EventQueue-0" java.awt.image.RasterFormatException: (y + height) is outside of Raster
    at sun.awt.image.ByteInterleavedRaster.createWritableChild(Unknown Source)
    at java.awt.image.BufferedImage.getSubimage(Unknown Source)
    at main.Grid.paintComponent(Grid.java:111)
    at javax.swing.JComponent.paint(Unknown Source)
    at javax.swing.JComponent.paintChildren(Unknown Source)
    at javax.swing.JComponent.paint(Unknown Source)
    at javax.swing.JComponent.paintChildren(Unknown Source)
    at javax.swing.JComponent.paint(Unknown Source)
    at javax.swing.JLayeredPane.paint(Unknown Source)
    at javax.swing.JComponent.paintChildren(Unknown Source)
    at javax.swing.JComponent.paintToOffscreen(Unknown Source)
    at javax.swing.RepaintManager$PaintManager.paintDoubleBuffered(Unknown Source)
    at javax.swing.RepaintManager$PaintManager.paint(Unknown Source)
    at javax.swing.RepaintManager.paint(Unknown Source)
    at javax.swing.JComponent.paint(Unknown Source)
    at java.awt.GraphicsCallback$PaintCallback.run(Unknown Source)
    at sun.awt.SunGraphicsCallback.runOneComponent(Unknown Source)
    at sun.awt.SunGraphicsCallback.runComponents(Unknown Source)
    at java.awt.Container.paint(Unknown Source)
    at java.awt.Window.paint(Unknown Source)
    at javax.swing.RepaintManager.paintDirtyRegions(Unknown Source)
    at javax.swing.RepaintManager.paintDirtyRegions(Unknown Source)
    at javax.swing.RepaintManager.seqPaintDirtyRegions(Unknown Source)
    at javax.swing.SystemEventQueueUtilities$ComponentWorkRequest.run(Unknown Source)
    at java.awt.event.InvocationEvent.dispatch(Unknown Source)
    at java.awt.EventQueue.dispatchEventImpl(Unknown Source)
    at java.awt.EventQueue.access$000(Unknown Source)
    at java.awt.EventQueue$1.run(Unknown Source)
    at java.awt.EventQueue$1.run(Unknown Source)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.AccessControlContext$1.doIntersectionPrivilege(Unknown Source)
    at java.awt.EventQueue.dispatchEvent(Unknown Source)
    at java.awt.EventDispatchThread.pumpOneEventForFilters(Unknown Source)
    at java.awt.EventDispatchThread.pumpEventsForFilter(Unknown Source)
    at java.awt.EventDispatchThread.pumpEventsForHierarchy(Unknown Source)
    at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
    at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
    at java.awt.EventDispatchThread.run(Unknown Source) 
```

这是与此错误相关的代码：

```
try {

            tileSheetBig = ImageIO.read(new File("sprites/tiles.png"));
            charSheetBig = ImageIO.read(new File("sprites/player.png"));

        } catch (IOException e) {
            e.printStackTrace();
        }

        final int tileWidth = 64;
        final int tileHeight = 64;
        final int tileRows = 1;
        final int tileCols = 11;
        tileSheet = new BufferedImage[tileRows * tileCols];

        for (int i = 0; i < tileRows; i++) {
            for (int j = 0; j < tileCols; j++) {
                tileSheet[(i * tileCols) + j] = tileSheetBig.getSubimage(i
                        * tileWidth, j * tileHeight, tileWidth, tileHeight);
            }
        }

        final int charWidth = 16;
        final int charHeight = 23;
        final int charRows = 2;
        final int charCols = 3;
        charSheet = new BufferedImage[charRows * charCols];

        for (int i = 0; i < charRows; i++) {
            for (int j = 0; j < charCols; j++) {
                charSheet[(i * charCols) + j] = charSheetBig.getSubimage(i
                        * charWidth, j * charHeight, charWidth, charHeight);
            }
        } 
```

由于答案中提供的代码没有太大变化，我看不出问题可能是什么。我试图用谷歌搜索该错误，但与我的问题相关的答案并不多。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T01:40:06.480

当[ x,y : x+width, y+height] 指定的区域不包含在该区域内时，会`RasterFormatException`抛出[该](http://docs.oracle.com/javase/7/docs/api/java/awt/image/BufferedImage.html#getSubimage%28int,%20int,%20int,%20int%29)区域。`getSubImage()``BufferedImage`

~~检查您的 tiles.png 图像是否至少为 704x64 像素（宽度*列，高度*行），同样，player.png 至少为 48x46 像素。~~

编辑：对不起，我乍一看没有注意到；player.png 必须为 32x69 像素，tiles.png 必须为 64x704 像素

编辑 2：这可以在不编辑精灵的情况下修复您的播放器代码；对瓷砖做同样的事情

```
final int charWidth = 64;
final int charHeight = 64;
final int charCols = 11;
final int charRows = 1;
for (int i = 0; i < charCols; i++) {
    for (int j = 0; j < charRows; j++) {
        charSheet[i * charRows + j] = charSheetBig
          .getSubimage(i * charWidth, j * charHeight, charWidth, charHeight);
    }
 } 
```

# php - 在 PHP 中匹配来自 SOAP XML 响应的两个数组

> ID：10730030
> 
> 赞同：1
> 
> 时间：2012-05-24T01:29:26.637
> 
> 标签：php, xml, soap

前两天在网上搜了一下，没有找到解决问题的办法，

我正在制作一个使用 PHP 与 SOAP Web 服务通信的 Web 应用程序，当我得到 Web 服务的响应时，我将结果输出到几个数组中，所以现在我想将 1 个数组与另一个数组匹配，

例如，我有`$company`一个包含 5 个公司位置列表的数组，然后我有另一个`$rates`包含 37 个价格和价格列表的数组，但我必须匹配它所属位置的每个价格，我不知道如何去做。

很抱歉，我试图尽可能缩短这个冗长的例子，但我希望你能理解我的意思

```
 Array
    (
        [0] => SimpleXMLElement Object
            (
                [Car_AvailabilityReply] => SimpleXMLElement Object
                    (
                        [availabilityDetails] => SimpleXMLElement Object
                            (
                                [computeMarkups] => SimpleXMLElement Object
                                    (
                                        [actionRequestCode] => N
                                    )

                                [rateClass] => SimpleXMLElement Object
                                    (
                                        [criteriaSetType] => COR
                                    )

                                [companyLocationInfo] => Array
                                    (
                                        [0] => SimpleXMLElement Object
                                            (
                                                [carCompanyData] => SimpleXMLElement Object
                                                    (
                                                        [companyName] => AVIS
                                                    )

                                                [rentalLocation] => SimpleXMLElement Object
                                                    (
                                                        [address] => SimpleXMLElement Object
                                                            (
                                                                [addressDetails] => SimpleXMLElement Object
                                                                    (
                                                                        [line1] => 420 EAST 90TH STREET
                                                                    )
                                                                [locationDetails] => SimpleXMLElement Object
                                                                    (
                                                                        [name] => NYCC07
                                                                    )

                                                            )

                                                    )

                                            )

                                        [1] => SimpleXMLElement Object
                                            (
                                                [carCompanyData] => SimpleXMLElement Object
                                                    (
                                                        [companyName] => AVIS
                                                    )

                                                [rentalLocation] => SimpleXMLElement Object
                                                    (
                                                        [address] => SimpleXMLElement Object
                                                            (
                                                                [addressDetails] => SimpleXMLElement Object
                                                                    (
                                                                        [line1] => 310 EAST 64TH STREET
                                                                    )

                                                                [locationDetails] => SimpleXMLElement Object
                                                                    (
                                                                        [name] => NYCC06
                                                                    )

                                                            )

                                                    )

                                            )

                                        [2] => SimpleXMLElement Object
                                            (
                                                [carCompanyData] => SimpleXMLElement Object
                                                    (
                                                        [companyName] => AVIS
                                                    )

                                                [rentalLocation] => SimpleXMLElement Object
                                                    (
                                                        [address] => SimpleXMLElement Object
                                                            (
                                                                [addressDetails] => SimpleXMLElement Object
                                                                    (
                                                                        [line1] => 68 EAST 11TH STREET
                                                                    )

                                                                [locationDetails] => SimpleXMLElement Object
                                                                    (
                                                                        [name] => NYCC03
                                                                    )

                                                            )

                                                    )

                                            )

                                    )

                                [rates] => Array
                                    (
                                        [0] => SimpleXMLElement Object
                                            (
                                                [vehicleTypeInfo] => SimpleXMLElement Object
                                                    (
                                                        [vehicleCharacteristic] => SimpleXMLElement Object
                                                            (
                                                                [vehicleRentalPrefType] => CCAR
                                                            )

                                                    )

                                                [carCompanyData] => SimpleXMLElement Object
                                                    (
                                                        [companyName] => AVIS
                                                    )

                                                [pickupDropoffLocations] => Array
                                                    (
                                                        [0] => SimpleXMLElement Object
                                                            (
                                                                [locationType] => PUP
                                                                [locationDescription] => SimpleXMLElement Object
                                                                    (
                                                                        [name] => NYCC07
                                                                    )

                                                            )

                                                        [1] => SimpleXMLElement Object
                                                            (
                                                                [locationType] => DOL
                                                                [locationDescription] => SimpleXMLElement Object
                                                                    (
                                                                        [name] => NYCC07
                                                                    )

                                                            )

                                                    )

                                                [rateDetailsInfo] => SimpleXMLElement Object
                                                    (
                                                        [tariffInfo] => Array
                                                            (
                                                                [0] => SimpleXMLElement Object
                                                                    (
                                                                        [rateAmount] => 83.99
                                                                        [rateCurrency] => USD
                                                                    )

                                                                [1] => SimpleXMLElement Object
                                                                    (
                                                                        [rateAmount] => 100.68
                                                                        [rateCurrency] => USD
                                                                    )

                                                            )

                                                    )

                                            )

                                        [1] => SimpleXMLElement Object
                                            (
                                                [vehicleTypeInfo] => SimpleXMLElement Object
                                                    (
                                                        [vehicleCharacteristic] => SimpleXMLElement Object
                                                            (
                                                                [vehicleRentalPrefType] => CCAR
                                                            )

                                                    )

                                                [carCompanyData] => SimpleXMLElement Object
                                                    (
                                                        [companyName] => AVIS
                                                    )

                                                [pickupDropoffLocations] => Array
                                                    (
                                                        [0] => SimpleXMLElement Object
                                                            (
                                                                [locationType] => PUP
                                                                [locationDescription] => SimpleXMLElement Object
                                                                    (
                                                                        [name] => NYCC06
                                                                    )

                                                            )

                                                        [1] => SimpleXMLElement Object
                                                            (
                                                                [locationType] => DOL
                                                                [locationDescription] => SimpleXMLElement Object
                                                                    (
                                                                        [name] => NYCC06
                                                                    )

                                                            )

                                                    )

                                                [rateDetailsInfo] => SimpleXMLElement Object
                                                    (
                                                        [tariffInfo] => Array
                                                            (
                                                                [0] => SimpleXMLElement Object
                                                                    (
                                                                        [rateAmount] => 83.99
                                                                        [rateCurrency] => USD
                                                                    )

                                                                [1] => SimpleXMLElement Object
                                                                    (
                                                                        [rateAmount] => 100.68
                                                                        [rateCurrency] => USD
                                                                    )

                                                            )

                                                    )

                                            )

                                        [2] => SimpleXMLElement Object
                                            (
                                                [vehicleTypeInfo] => SimpleXMLElement Object
                                                    (
                                                        [vehicleCharacteristic] => SimpleXMLElement Object
                                                            (
                                                                [vehicleRentalPrefType] => CCAR
                                                            )

                                                    )

                                                [carCompanyData] => SimpleXMLElement Object
                                                    (
                                                        [companyName] => AVIS
                                                    )

                                                [pickupDropoffLocations] => Array
                                                    (
                                                        [0] => SimpleXMLElement Object
                                                            (
                                                                [locationType] => PUP
                                                                [locationDescription] => SimpleXMLElement Object
                                                                    (
                                                                        [name] => NYCC03
                                                                    )

                                                            )

                                                        [1] => SimpleXMLElement Object
                                                            (
                                                                [locationType] => DOL
                                                                [locationDescription] => SimpleXMLElement Object
                                                                    (
                                                                        [name] => NYCC03
                                                                    )

                                                            )

                                                    )

                                                [rateDetailsInfo] => SimpleXMLElement Object
                                                    (
                                                        [tariffInfo] => Array
                                                            (
                                                                [0] => SimpleXMLElement Object
                                                                    (
                                                                        [rateAmount] => 83.99
                                                                        [rateCurrency] => USD
                                                                    )

                                                                [1] => SimpleXMLElement Object
                                                                    (
                                                                        [rateAmount] => 100.68
                                                                        [rateCurrency] => USD
                                                                    )

                                                            )

                                                    )

                                            )

                                        [3] => SimpleXMLElement Object
                                            (
                                                [vehicleTypeInfo] => SimpleXMLElement Object
                                                    (
                                                        [vehicleCharacteristic] => SimpleXMLElement Object
                                                            (
                                                                [vehicleRentalPrefType] => EDAR
                                                            )

                                                    )

                                                [carCompanyData] => SimpleXMLElement Object
                                                    (
                                                        [companyName] => AVIS
                                                    )

                                                [pickupDropoffLocations] => Array
                                                    (
                                                        [0] => SimpleXMLElement Object
                                                            (
                                                                [locationType] => PUP
                                                                [locationDescription] => SimpleXMLElement Object
                                                                    (
                                                                        [name] => NYCC03
                                                                    )

                                                            )

                                                        [1] => SimpleXMLElement Object
                                                            (
                                                                [locationType] => DOL
                                                                [locationDescription] => SimpleXMLElement Object
                                                                    (
                                                                        [name] => NYCC03
                                                                    )

                                                            )

                                                    )

                                                [rateDetailsInfo] => SimpleXMLElement Object
                                                    (
                                                        [tariffInfo] => Array
                                                            (
                                                                [0] => SimpleXMLElement Object
                                                                    (
                                                                        [rateAmount] => 83.99
                                                                        [rateCurrency] => USD
                                                                    )

                                                                [1] => SimpleXMLElement Object
                                                                    (
                                                                        [rateAmount] => 100.68
                                                                        [rateCurrency] => USD
                                                                    )

                                                            )

                                                    )

                                            )

                                        [4] => SimpleXMLElement Object
                                            (
                                                [vehicleTypeInfo] => SimpleXMLElement Object
                                                    (
                                                        [vehicleCharacteristic] => SimpleXMLElement Object
                                                            (
                                                                [vehicleRentalPrefType] => EDAR
                                                            )

                                                    )

                                                [carCompanyData] => SimpleXMLElement Object
                                                    (
                                                        [companyName] => AVIS
                                                    )

                                                [pickupDropoffLocations] => Array
                                                    (
                                                        [0] => SimpleXMLElement Object
                                                            (
                                                                [locationType] => PUP
                                                                [locationDescription] => SimpleXMLElement Object
                                                                    (
                                                                        [name] => NYCC06
                                                                    )

                                                            )

                                                        [1] => SimpleXMLElement Object
                                                            (
                                                                [locationType] => DOL
                                                                [locationDescription] => SimpleXMLElement Object
                                                                    (
                                                                        [name] => NYCC06
                                                                    )

                                                            )

                                                    )

                                                [rateDetailsInfo] => SimpleXMLElement Object
                                                    (
                                                        [tariffInfo] => Array
                                                            (
                                                                [0] => SimpleXMLElement Object
                                                                    (
                                                                        [rateAmount] => 83.99
                                                                        [rateCurrency] => USD
                                                                    )

                                                                [1] => SimpleXMLElement Object
                                                                    (
                                                                        [rateAmount] => 100.68
                                                                        [rateCurrency] => USD
                                                                    )

                                                            )

                                                    )

                                            )

                                     )

                            )

                    )

            )

    ) 
```

如果你理解你可以看到有两种类型的数组，前 3 个是位置，第二个是有价格的汽车，我必须把每辆车放在正确的位置。

如果您需要更多解释，请告诉我。

请帮我解决这个问题，谢谢。

# emacs - 如何使用 etag 只跳转到确切的函数名称？

> ID：10730031
> 
> 赞同：1
> 
> 时间：2012-05-24T01:30:00.037
> 
> 标签：emacs, etag

我想用 etags 找到以下函数：

```
dt() 
```

但是当我浏览标签表时，我一直在用`dt`他们的名字点击函数，比如

```
widthThing1()
widthThing2()
... 
```

使得定义`dt()`极难找到。

有什么方法可以*只*搜索我用 etags 搜索的确切功能吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-24T02:32:18.060

打开您的 TAGS 文件并查看它实际索引的内容（当然，这会因语言而异）。

例如，如果相关条目如下所示：

```
function ds(^?6140,232332 
```

然后您可以使用`function ds(`（或可能只是`ds(`）作为您的搜索词，以确保您没有匹配其他功能。

您可以省略其中的“功能”部分，除了`SPC`在`find-tag`提示符处键入将调用 TAG 完成。您可以通过键入`C-q``SPC`来避免这种情况，或者使用没有完成绑定的绑定`find-tag-regexp`。`C-M-.`

所以`C-M-.``SPC` `ds(` `RET`可能很方便。

您可能还想查看`etags-select`库和绑定`M-.`到`etags-select-find-tag`，我发现它提供了更好的界面。

你可以从 EmacsWiki 或 Marmalade 获得它：

*   [http://www.emacswiki.org/emacs/EtagsSelect](http://www.emacswiki.org/emacs/EtagsSelect)
*   [http://marmalade-repo.org/packages/etags-select](http://marmalade-repo.org/packages/etags-select)

Icicles 和 Helm 等软件包也提供了替代接口。[您可以从http://emacswiki.org/emacs/EmacsTags](http://emacswiki.org/emacs/EmacsTags)开始阅读

# asp.net - Visual Studio 2010 sp1 找不到类型或命名空间名称“xxx”（您是否缺少 using 指令或程序集引用？）

> ID：10730033
> 
> 赞同：2
> 
> 时间：2012-05-24T01:30:12.987
> 
> 标签：asp.net, visual-studio-2010

我对 VS 2010 pro sp1 有一个奇怪的问题，我的自定义类（都在同一个命名空间中）都没有出现在智能感知中。我在所有变量声明下都看到了红色的 swiggley 行，如果我将鼠标悬停在它们上面，我会得到 - 找不到类型或命名空间名称“xxx”（您是否缺少 using 指令或程序集引用？）。

奇怪的是，我有正确的 using 语句，一切都是正确的，项目甚至可以正确编译和运行，在我开发这些页面时，我的自定义类没有智能感知，这很烦人。需要注意的是，这是一个网站项目而不是网站应用程序项目。我已经多次重新安装了 Visual Studio，之前我可以通过重新创建一个新的解决方案文件来解决该问题，但此后不久问题又出现了，我不想一直这样做。有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T06:15:29.760

抱歉“闯入”您的帖子 - 也许转换为 Web 应用程序解决了您的问题，但是.....

**澄清**：

> “网站”项目中没有“命名空间”这样的概念。

不确定上述内容是如何开始的，但它**不准确**- 您当然可以在 ASP.Net 网站中拥有命名空间（并且您**将**获得 Intellisense）。这与哪种范式“更好”无关——只是希望在这成为*“公认的事实”*之前得到澄清。

该`App_Code`文件夹是您的朋友（如果您添加项目，VS 会询问您`Class`：

![网站文件夹结构](../Images/371a623a679304b3687f454c97ad12c5.png)

Namespaced.vb 完整源代码：

```
Imports Microsoft.VisualBasic

Namespace EdSFNS
    Public Class foo
        Public Property someInt As Integer
        Public Property someString As String
        Public Sub New()
        ...
        End Sub
    End Class
End Namespace 
```

另一个命名空间（namespaced2.vb）：

```
Imports Microsoft.VisualBasic

Namespace StackOverFlowNS
    Public Class foo
        Public Property someInt As Integer
        Public Property someString As String
        Public Sub New()
        End Sub
    End Class
End Namespace 
```

Razor 页面中的智能感知：

![智能感知工作 1](../Images/86e4f5ce21d5333584ac0cf1fb810753.png) ![智能感知工作 3](../Images/2f978e7d65b0ab3d2177a0944eefab01.png)

![智能感知工作 2](../Images/a6ba72f6d588d4cdffb0d6a5af456adf.png)

* * *

## 结果：

![网站中的命名空间工作得很好](../Images/125934390f5e7571a3f586975c6b1bc4.png)

* * *

HTH...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-24T03:07:56.957

切换到 Web 应用程序项目模板。我在网站模板中一次又一次地看到这种情况；它们不能很好地与库配合使用，尤其是在涉及用户控件的情况下。搜索 Google 或 SO，你会发现很多关于这个主题的类似问题。

# javascript - 我可以在 RichFace 中为文件上传实现多个文件选择，或者使用 javascript 实现自定义标签吗？

> ID：10730040
> 
> 赞同：2
> 
> 时间：2012-05-24T01:31:33.827
> 
> 标签：javascript, file-upload, richfaces

我想在 RichFace 中实现文件上传的多文件选择，我在[这里找到了一个演示](http://livedemo.exadel.com/richfaces-demo/richfaces/fileUpload.jsf;jsessionid=BCE786DE9AEFB9699010A8F8AE9C628C?c=fileUpload&tab=usage)。

但是如果我可以像在 Windows 上正常那样实现多个文件选择，那对用户来说将是一个很好的体验。

如果 RichFace 不支持此功能，我如何使用 javascript 实现自定义标签？

你能评论一下你的想法和建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-27T18:27:57.860

RichFaces v4.5.0.Alpha1 中似乎已修复此问题：[https](https://issues.jboss.org/browse/RF-12224) ://issues.jboss.org/browse/RF-12224 但目前可用的 RichFaces 版本为 4.3.4.Final，因此此功能尚不可用.

# asp.net-mvc - 如何使用反射获取操作的 http 动词属性 - ASP.NET Web API

> ID：10730041
> 
> 赞同：8
> 
> 时间：2012-05-24T01:32:00.363
> 
> 标签：asp.net-mvc, reflection, asp.net-web-api, custom-attributes

我有一个 ASP.NET Web API 项目。使用反射，如何获得`[HttpGet]`装饰我的操作方法的 Http 动词（在下面的示例中）属性？

```
[HttpGet]
public ActionResult Index(int id) { ... } 
```

假设我的控制器中有上述操作方法。到目前为止，通过使用反射，我已经能够获得`Index`我存​​储在一个名为的变量中的操作方法的 MethodInfo 对象`methodInfo`

我尝试使用以下方法获取 http 动词，但它不起作用 - 返回 null：

```
var httpVerb = methodInfo.GetCustomAttributes(typeof (AcceptVerbsAttribute), false).Cast<AcceptVerbsAttribute>().SingleOrDefault(); 
```

* * *

我注意到的一件事：

我上面的示例来自我正在处理的 ASP.NET Web API 项目。

似乎`[HttpGet]`是一个 System.Web.Http.HttpGetAttribute

但在常规 ASP.NET MVC 项目中，`[HttpGet]`它是 System.Web.Mvc.HttpGetAttribute

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-24T02:07:02.297

```
var methodInfo = MethodBase.GetCurrentMethod();
var attribute = methodInfo.GetCustomAttributes(typeof(ActionMethodSelectorAttribute), true).Cast<ActionMethodSelectorAttribute>().FirstOrDefault(); 
```

你很亲近...

不同之处在于所有“动词”属性都继承自“ ***ActionMethodSelectorAttribute*** ”，包括“ ***AcceptVerbsAttribute*** ”属性。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-07-13T18:08:36.403

我只是需要这个，由于没有解决 Web Api 属性的实际要求的答案，我已经发布了我的答案。

Web Api 属性如下：

*   System.Web.Http.HttpGetAttribute
*   System.Web.Http.HttpPutAttribute
*   System.Web.Http.HttpPostAttribute
*   System.Web.Http.HttpDeleteAttribute

与它们的 Mvc 对应物不同，它们不从基本属性类型继承，而是直接从 System.Attribute 继承。因此，您需要单独手动检查每种特定类型。

我做了一个小的扩展方法，像这样扩展 MethodInfo 类：

```
 public static IEnumerable<Attribute> GetWebApiMethodAttributes(this MethodInfo methodInfo)
    {
        return methodInfo.GetCustomAttributes().Where(attr =>
            attr.GetType() == typeof(HttpGetAttribute)
            || attr.GetType() == typeof(HttpPutAttribute)
            || attr.GetType() == typeof(HttpPostAttribute)
            || attr.GetType() == typeof(HttpDeleteAttribute)
            ).AsEnumerable();
    } 
```

通过反射获得控制器操作方法的 MethodInfo 对象后，调用上述扩展方法将为您获取当前在该方法上的所有操作方法属性：

```
 var webApiMethodAttributes = methodInfo.GetWebApiMethodAttributes(); 
```

# c++ - 查找字符串中的相邻字符

> ID：10730042
> 
> 赞同：-1
> 
> 时间：2012-05-24T01:32:02.487
> 
> 标签：c++, string, char, duplicates

如何在一个字符串中找到两个相邻的字符？我对相邻字符的搜索应该只考虑我定义的一组字符。

我使用此功能解决了我的问题：

```
unsigned checkField (myset string, char mychar)
 {
  unsigned counter;

  for (counter = 0; counter <= myset.length () - 1; counter + +)
    if (myset [counter] == mychar)
     return 1;

  return 0; / * NOT FOUND * /
 } 
```

将来可能对某人有用

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T01:39:13.017

如果可以使用[boost](http://www.boost.org)，并且您不需要极致的效率，那么最简单的方法可能是使用正则表达式，例如`"([abcd])\\1"`. 有关使用 boost regexp 匹配字符串的详细信息，请参阅[boost regex 文档](http://www.boost.org/doc/libs/1_49_0/libs/regex/doc/html/index.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T02:00:21.183

一些快速代码：

```
#include <cstdio>
#include <cstdlib>
#include <cstring>

const char* find_adjacent_string(const char* str, const char* set)
{
    const char* loc = NULL;

    if(set != NULL)
    {
        int size = strlen(set);

        char adj[3];
        adj[2] = '\0';

        for(int i = 0; i + 1 < size; i++)
        {
            adj[0] = set[i];
            adj[1] = set[i + 1];
            loc = strstr(str, adj);
            if(loc != NULL)
            {
                break;
            }
        }
    }

    return loc;
}

int main()
{
    const char* myset = "pl";
    const char* mystr = "apple";

    printf("found at %i\n", find_adjacent_string(mystr, myset) - mystr);

    return 0;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T01:57:09.680

我想您在某个时候分别存储方程式的每个部分？例如。"55" "+" "hh" "+" "bc" ? 在这种情况下，仅仅检查 sizeof 是否为 1 是否足够，如果不是则发送错误？对不起，如果我遗漏了什么！否则，爱德华建议的正则表达式 (+1) 似乎最合适。

编辑：当然，很容易检查这些字符是/不是您在顶部指定的字符。

# java - Jena/arq 请求没有结果

> ID：10730043
> 
> 赞同：0
> 
> 时间：2012-05-24T01:32:11.207
> 
> 标签：java, semantic-web, jena, arq

我正在编写一个语义 Web 应用程序，但 Jena 遇到了一些问题。我想执行一个参数化查询并且没有结果。

以下代码显示了我的查询：

```
public ArrayList getPieceByContrName(String n){
    Property pr= infModel.getProperty(namespace+"NomPiecePreparer");
    ArrayList ef=new ArrayList();
    Query query = null;
    QueryExecution qe = null;
    String sql= "PREFIX supply: <http://www.semanticweb.org/ontologies/2012//Ontology1334514742253.owl#>"+
              " SELECT ?y " +
              " WHERE {" +
              " ?x supply:NomSControle \""+n+"\"." +
              "?x supply:controle ?y"+"." +
                         " }";

    com.hp.hpl.jena.query.ResultSet results = null;
    try{
    query=QueryFactory.create(sql);
     qe= QueryExecutionFactory.create(query,infModel);
     results =  qe.execSelect();
     System.out.println("rrrrr");

   } catch (Exception e) {
        e.printStackTrace();
   }
 while(results.hasNext()){
     System.out.println("hhhhh");
PiecePrepare pp = new PiecePrepare();
           QuerySolution soln = results.next() ;
         Resource r=  soln.get("y").asResource();
         System.out.println(r.getProperty(pr).getString());

 }

    qe.close();

} 
```

* * *

这是我本体的一部分：

```
 <!-- http://www.semanticweb.org/ontologies/2012/3/Ontology1334514742253.owl#controle -->

    <owl:ObjectProperty rdf:about="&Ontology1334514742253;controle">
        <rdf:type rdf:resource="&owl;FunctionalProperty"/>
        <rdfs:domain rdf:resource="&Ontology1334514742253;EntiteControle"/>
        <rdfs:range rdf:resource="&Ontology1334514742253;PiecePrepare"/>
        <owl:inverseOf rdf:resource="&Ontology1334514742253;estControlee"/>
    </owl:ObjectProperty>

    <!-- http://www.semanticweb.org/ontologies/2012/3/Ontology1334514742253.owl#distribue -->

    <owl:ObjectProperty rdf:about="&Ontology1334514742253;distribue">
        <rdf:type rdf:resource="&owl;FunctionalProperty"/>
        <rdfs:domain rdf:resource="&Ontology1334514742253;EntiteDistributeur"/>
        <rdfs:range rdf:resource="&Ontology1334514742253;EntiteMarketing"/>
    </owl:ObjectProperty>

    <!-- http://www.semanticweb.org/ontologies/2012/3/Ontology1334514742253.owl#estControlee -->

    <owl:ObjectProperty rdf:about="&Ontology1334514742253;estControlee">
        <rdfs:domain rdf:resource="&Ontology1334514742253;EntiteAssemblage"/>
        <rdfs:range rdf:resource="&Ontology1334514742253;EntiteControle"/>
    </owl:ObjectProperty>

    <!-- http://www.semanticweb.org/ontologies/2012/3/Ontology1334514742253.owl#NomPieceControle -->

    <owl:DatatypeProperty rdf:about="&Ontology1334514742253;NomPieceControle"/>

    <!-- http://www.semanticweb.org/ontologies/2012/3/Ontology1334514742253.owl#NomPiecePreparer -->

    <owl:DatatypeProperty rdf:about="&Ontology1334514742253;NomPiecePreparer"/>

    <!-- http://www.semanticweb.org/ontologies/2012/3/Ontology1334514742253.owl#NomSControle -->

    <owl:DatatypeProperty rdf:about="&Ontology1334514742253;NomSControle"/>

    <!-- http://www.semanticweb.org/ontologies/2012/3/Ontology1334514742253.owl#NombrePieceControle -->

    <owl:DatatypeProperty rdf:about="&Ontology1334514742253;NombrePieceControle"/>

    <!-- http://www.semanticweb.org/ontologies/2012/3/Ontology1334514742253.owl#NombreProd -->

    <owl:DatatypeProperty rdf:about="&Ontology1334514742253;NombreProd"/>

    <!-- http://www.semanticweb.org/ontologies/2012/3/Ontology1334514742253.owl#NombredePiecePrepa -->

    <owl:DatatypeProperty rdf:about="&Ontology1334514742253;NombredePiecePrepa"/>

    <!-- http://www.semanticweb.org/ontologies/2012/3/Ontology1334514742253.owl#Nomprodfinal -->

    <owl:DatatypeProperty rdf:about="&Ontology1334514742253;Nomprodfinal"/>

    <!-- http://www.semanticweb.org/ontologies/2012/3/Ontology1334514742253.owl#Pays -->

    <owl:DatatypeProperty rdf:about="&Ontology1334514742253;Pays"/>

    <!-- http://www.semanticweb.org/ontologies/2012/3/Ontology1334514742253.owl#PaysAssemb -->

    <owl:DatatypeProperty rdf:about="&Ontology1334514742253;PaysAssemb"/>

    <!-- http://www.semanticweb.org/ontologies/2012/3/Ontology1334514742253.owl#Typematiere -->

    <owl:DatatypeProperty rdf:about="&Ontology1334514742253;Typematiere"/>

    <!-- http://www.semanticweb.org/ontologies/2012/3/Ontology1334514742253.owl#Ville -->

    <owl:DatatypeProperty rdf:about="&Ontology1334514742253;Ville"/>

    <!-- http://www.semanticweb.org/ontologies/2012/3/Ontology1334514742253.owl#VilleAssemb -->

    <owl:DatatypeProperty rdf:about="&Ontology1334514742253;VilleAssemb"/>

    <!-- http://www.semanticweb.org/ontologies/2012/3/Ontology1334514742253.owl#VilleControle -->

    <owl:DatatypeProperty rdf:about="&Ontology1334514742253;VilleControle"/>

    <!-- http://www.semanticweb.org/ontologies/2012/3/Ontology1334514742253.owl#VilleDistr -->

    <owl:DatatypeProperty rdf:about="&Ontology1334514742253;VilleDistr"/>

    <!-- http://www.semanticweb.org/ontologies/2012/3/Ontology1334514742253.owl#VilleFab -->

    <owl:DatatypeProperty rdf:about="&Ontology1334514742253;VilleFab"/>

    <!-- http://www.semanticweb.org/ontologies/2012/3/Ontology1334514742253.owl#VilleMarketing -->

    <owl:DatatypeProperty rdf:about="&Ontology1334514742253;VilleMarketing"/>

    <!-- 
    ///////////////////////////////////////////////////////////////////////////////////////
    //
    // Classes
    //
    ///////////////////////////////////////////////////////////////////////////////////////
     -->

    <!-- http://www.semanticweb.org/ontologies/2012/3/Ontology1334514742253.owl#DistributeurProduitFinaux -->

    <owl:Class rdf:about="&Ontology1334514742253;DistributeurProduitFinaux">
        <owl:equivalentClass>
            <owl:Class>
                <owl:intersectionOf rdf:parseType="Collection">
                    <rdf:Description rdf:about="&Ontology1334514742253;EntiteDistributeur"/>
                    <owl:Restriction>
                        <owl:onProperty rdf:resource="&Ontology1334514742253;distribue"/>
                        <owl:someValuesFrom rdf:resource="&Ontology1334514742253;ProduitFinalCommercial"/>
                    </owl:Restriction>
                </owl:intersectionOf>
            </owl:Class>
        </owl:equivalentClass>
        <rdfs:subClassOf rdf:resource="&Ontology1334514742253;EntiteDistributeur"/>
    </owl:Class>

    <!-- http://www.semanticweb.org/ontologies/2012/3/Ontology1334514742253.owl#EntiteAssemblage -->

    <owl:Class rdf:about="&Ontology1334514742253;EntiteAssemblage">
        <rdfs:subClassOf>
            <owl:Restriction>
                <owl:onProperty rdf:resource="&Ontology1334514742253;NomAssemb"/>
                <owl:allValuesFrom rdf:resource="&rdfs;Literal"/>
            </owl:Restriction>
        </rdfs:subClassOf>
        <rdfs:subClassOf>
            <owl:Restriction>
                <owl:onProperty rdf:resource="&Ontology1334514742253;PaysAssemb"/>
                <owl:allValuesFrom rdf:resource="&rdfs;Literal"/>
            </owl:Restriction>
        </rdfs:subClassOf>
        <rdfs:subClassOf>
            <owl:Restriction>
                <owl:onProperty rdf:resource="&Ontology1334514742253;VilleAssemb"/>
                <owl:allValuesFrom rdf:resource="&rdfs;Literal"/>
            </owl:Restriction>
        </rdfs:subClassOf>
        <rdfs:subClassOf>
            <owl:Restriction>
                <owl:onProperty rdf:resource="&Ontology1334514742253;AdresseAssemb"/>
                <owl:allValuesFrom rdf:resource="&rdfs;Literal"/>
            </owl:Restriction>
        </rdfs:subClassOf>
        <rdfs:comment>cette phase définit l&#39;assemblage des pièces automobile pour fomer le produit final à savoir une automobile(voiture)</rdfs:comment>
    </owl:Class>

    <!-- http://www.semanticweb.org/ontologies/2012/3/Ontology1334514742253.owl#EntiteAssemblageControle -->

    <owl:Class rdf:about="&Ontology1334514742253;EntiteAssemblageControle">
        <owl:equivalentClass>
            <owl:Class>
                <owl:intersectionOf rdf:parseType="Collection">
                    <rdf:Description rdf:about="&Ontology1334514742253;EntiteControle"/>
                    <owl:Restriction>
                        <owl:onProperty rdf:resource="&Ontology1334514742253;controle"/>
                        <owl:someValuesFrom rdf:resource="&Ontology1334514742253;PiecePrepare"/>
                    </owl:Restriction>
                </owl:intersectionOf>
            </owl:Class>
        </owl:equivalentClass>
        <rdfs:subClassOf rdf:resource="&Ontology1334514742253;EntiteControle"/>
    </owl:Class>

    <!-- http://www.semanticweb.org/ontologies/2012/3/Ontology1334514742253.owl#EntiteAssemblagePiece -->

    <owl:Class rdf:about="&Ontology1334514742253;EntiteAssemblagePiece">
        <owl:equivalentClass>
            <owl:Class>
                <owl:intersectionOf rdf:parseType="Collection">
                    <rdf:Description rdf:about="&Ontology1334514742253;EntiteAssemblage"/>
                    <owl:Restriction>
                        <owl:onProperty rdf:resource="&Ontology1334514742253;assemble"/>
                        <owl:someValuesFrom rdf:resource="&Ontology1334514742253;PiecePrepare"/>
                    </owl:Restriction>
                </owl:intersectionOf>
            </owl:Class>
        </owl:equivalentClass>
        <rdfs:subClassOf rdf:resource="&Ontology1334514742253;EntiteAssemblage"/>
    </owl:Class>

    <!-- http://www.semanticweb.org/ontologies/2012/3/Ontology1334514742253.owl#EntiteControle -->

    <owl:Class rdf:about="&Ontology1334514742253;EntiteControle">
        <rdfs:subClassOf>
            <owl:Restriction>
                <owl:onProperty rdf:resource="&Ontology1334514742253;VilleControle"/>
                <owl:allValuesFrom rdf:resource="&rdfs;Literal"/>
            </owl:Restriction>
        </rdfs:subClassOf>
        <rdfs:subClassOf>
            <owl:Restriction>
                <owl:onProperty rdf:resource="&Ontology1334514742253;AdresseControle"/>
                <owl:allValuesFrom rdf:resource="&rdfs;Literal"/>
            </owl:Restriction>
        </rdfs:subClassOf>
        <rdfs:subClassOf>
            <owl:Restriction>
                <owl:onProperty rdf:resource="&Ontology1334514742253;NomSControle"/>
                <owl:allValuesFrom rdf:resource="&rdfs;Literal"/>
            </owl:Restriction>
        </rdfs:subClassOf>
        <rdfs:subClassOf>
            <owl:Restriction>
                <owl:onProperty rdf:resource="&Ontology1334514742253;PaysControle"/>
                <owl:allValuesFrom rdf:resource="&rdfs;Literal"/>
            </owl:Restriction>
        </rdfs:subClassOf>
    </owl:Class>

    <!-- http://www.semanticweb.org/ontologies/2012/3/Ontology1334514742253.owl#EntiteDistributeur -->

    <owl:Class rdf:about="&Ontology1334514742253;EntiteDistributeur">
        <rdfs:subClassOf>
            <owl:Restriction>
                <owl:onProperty rdf:resource="&Ontology1334514742253;AdresseDistr"/>
                <owl:allValuesFrom rdf:resource="&rdfs;Literal"/>
            </owl:Restriction>
        </rdfs:subClassOf>
        <rdfs:subClassOf>
            <owl:Restriction>
                <owl:onProperty rdf:resource="&Ontology1334514742253;NomDistr"/>
                <owl:allValuesFrom rdf:resource="&rdfs;Literal"/>
            </owl:Restriction>
        </rdfs:subClassOf>
        <rdfs:subClassOf>
            <owl:Restriction>
                <owl:onProperty rdf:resource="&Ontology1334514742253;PaysDistr"/>
                <owl:allValuesFrom rdf:resource="&rdfs;Literal"/>
            </owl:Restriction>
        </rdfs:subClassOf>
        <rdfs:subClassOf>
            <owl:Restriction>
                <owl:onProperty rdf:resource="&Ontology1334514742253;VilleDistr"/>
                <owl:allValuesFrom rdf:resource="&rdfs;Literal"/>
            </owl:Restriction>
        </rdfs:subClassOf>
    </owl:Class>

    <!-- http://www.semanticweb.org/ontologies/2012/3/Ontology1334514742253.owl#EntiteFabLiv -->

    <owl:Class rdf:about="&Ontology1334514742253;EntiteFabLiv">
        <owl:equivalentClass>
            <owl:Class>
                <owl:intersectionOf rdf:parseType="Collection">
                    <rdf:Description rdf:about="&Ontology1334514742253;EntiteFabrication"/>
                    <owl:Restriction>
                        <owl:onProperty rdf:resource="&Ontology1334514742253;prepare"/>
                        <owl:someValuesFrom rdf:resource="&Ontology1334514742253;PiecePrepare"/>
                    </owl:Restriction>
                </owl:intersectionOf>
            </owl:Class>
        </owl:equivalentClass>
        <rdfs:subClassOf rdf:resource="&Ontology1334514742253;EntiteFabrication"/>
    </owl:Class>

    <!-- http://www.semanticweb.org/ontologies/2012/3/Ontology1334514742253.owl#EntiteFabMatiere -->

    <owl:Class rdf:about="&Ontology1334514742253;EntiteFabMatiere">
        <owl:equivalentClass>
            <owl:Class>
                <owl:intersectionOf rdf:parseType="Collection">
                    <rdf:Description rdf:about="&Ontology1334514742253;EntiteFabrication"/>
                    <owl:Restriction>
                        <owl:onProperty rdf:resource="&Ontology1334514742253;reçoit"/>
                        <owl:onClass rdf:resource="&Ontology1334514742253;MatiereFourni"/>
                        <owl:qualifiedCardinality rdf:datatype="&xsd;nonNegativeInteger">1</owl:qualifiedCardinality>
                    </owl:Restriction>
                </owl:intersectionOf>
            </owl:Class>
        </owl:equivalentClass>
        <rdfs:subClassOf rdf:resource="&Ontology1334514742253;EntiteFabrication"/>
    </owl:Class>

    <!-- http://www.semanticweb.org/ontologies/2012/3/Ontology1334514742253.owl#EntiteFabrication -->

    <owl:Class rdf:about="&Ontology1334514742253;EntiteFabrication">
        <rdfs:subClassOf>
            <owl:Restriction>
                <owl:onProperty rdf:resource="&Ontology1334514742253;VilleFab"/>
                <owl:allValuesFrom rdf:resource="&rdfs;Literal"/>
            </owl:Restriction>
        </rdfs:subClassOf>
        <rdfs:subClassOf>
            <owl:Restriction>
                <owl:onProperty rdf:resource="&Ontology1334514742253;NomFab"/>
                <owl:allValuesFrom rdf:resource="&rdfs;Literal"/>
            </owl:Restriction>
        </rdfs:subClassOf>
        <rdfs:subClassOf>
            <owl:Restriction>
                <owl:onProperty rdf:resource="&Ontology1334514742253;PaysFab"/>
                <owl:allValuesFrom rdf:resource="&rdfs;Literal"/>
            </owl:Restriction>
        </rdfs:subClassOf>
        <rdfs:subClassOf>
            <owl:Restriction>
                <owl:onProperty rdf:resource="&Ontology1334514742253;AdresseFab"/>
                <owl:allValuesFrom rdf:resource="&rdfs;Literal"/>
            </owl:Restriction>
        </rdfs:subClassOf>
    </owl:Class>

    <!-- http://www.semanticweb.org/ontologies/2012/3/Ontology1334514742253.owl#EntiteMarketing -->

    <owl:Class rdf:about="&Ontology1334514742253;EntiteMarketing">
        <rdfs:subClassOf>
            <owl:Restriction>
                <owl:onProperty rdf:resource="&Ontology1334514742253;NomMarketing"/>
                <owl:allValuesFrom rdf:resource="&rdfs;Literal"/>
            </owl:Restriction>
        </rdfs:subClassOf>
        <rdfs:subClassOf>
            <owl:Restriction>
                <owl:onProperty rdf:resource="&Ontology1334514742253;AdresseMarketing"/>
                <owl:allValuesFrom rdf:resource="&rdfs;Literal"/>
            </owl:Restriction>
        </rdfs:subClassOf>
        <rdfs:subClassOf>
            <owl:Restriction>
                <owl:onProperty rdf:resource="&Ontology1334514742253;VilleMarketing"/>
                <owl:someValuesFrom rdf:resource="&rdfs;Literal"/>
            </owl:Restriction>
        </rdfs:subClassOf>
        <rdfs:subClassOf>
            <owl:Restriction>
                <owl:onProperty rdf:resource="&Ontology1334514742253;PaysMarketing"/>
                <owl:allValuesFrom rdf:resource="&rdfs;Literal"/>
            </owl:Restriction>
        </rdfs:subClassOf>
    </owl:Class>

    <!-- http://www.semanticweb.org/ontologies/2012/3/Ontology1334514742253.owl#PiecePrepare -->

    <owl:Class rdf:about="&Ontology1334514742253;PiecePrepare">
        <rdfs:subClassOf>
            <owl:Restriction>
                <owl:onProperty rdf:resource="&Ontology1334514742253;NomPiecePreparer"/>
                <owl:allValuesFrom rdf:resource="&xsd;string"/>
            </owl:Restriction>
        </rdfs:subClassOf>
    </owl:Class>

    <!-- http://www.semanticweb.org/ontologies/2012/3/Ontology1334514742253.owl#ProduitFinalCommercial -->

    <owl:Class rdf:about="&Ontology1334514742253;ProduitFinalCommercial">
        <rdfs:subClassOf>
            <owl:Restriction>
                <owl:onProperty rdf:resource="&Ontology1334514742253;Nomprodfinal"/>
                <owl:allValuesFrom rdf:resource="&rdfs;Literal"/>
            </owl:Restriction>
        </rdfs:subClassOf>
        <rdfs:subClassOf>
            <owl:Restriction>
                <owl:onProperty rdf:resource="&Ontology1334514742253;DesignationProdFinal"/>
                <owl:allValuesFrom rdf:resource="&rdfs;Literal"/>
            </owl:Restriction>
        </rdfs:subClassOf>
    </owl:Class>

    <!-- http://www.semanticweb.org/ontologies/2012/3/Ontology1334514742253.owl#EntProduction2 -->

    <owl:NamedIndividual rdf:about="&Ontology1334514742253;EntProduction2">
        <rdf:type rdf:resource="&Ontology1334514742253;EntiteProduction"/>
        <Produit rdf:resource="&Ontology1334514742253;ProdFini3"/>
    </owl:NamedIndividual>

    <!-- http://www.semanticweb.org/ontologies/2012/3/Ontology1334514742253.owl#EntitFabLiv1 -->

    <owl:NamedIndividual rdf:about="&Ontology1334514742253;EntitFabLiv1">
        <rdf:type rdf:resource="&Ontology1334514742253;EntiteFabLiv"/>
        <rdf:type rdf:resource="&Ontology1334514742253;EntiteFabMatiere"/>
        <rdf:type rdf:resource="&Ontology1334514742253;EntiteFabrication"/>
        <owl:sameAs rdf:resource="&Ontology1334514742253;FabEntite1"/>
        <prepare rdf:resource="&Ontology1334514742253;PiecePrepa1"/>
        <prepare rdf:resource="&Ontology1334514742253;PiecePrepa3"/>
    </owl:NamedIndividual>

    <!-- http://www.semanticweb.org/ontologies/2012/3/Ontology1334514742253.owl#EntitFabLiv2 -->

    <owl:NamedIndividual rdf:about="&Ontology1334514742253;EntitFabLiv2">
        <rdf:type rdf:resource="&Ontology1334514742253;EntiteFabLiv"/>
        <rdf:type rdf:resource="&Ontology1334514742253;EntiteFabMatiere"/>
        <rdf:type rdf:resource="&Ontology1334514742253;EntiteFabrication"/>
        <owl:sameAs rdf:resource="&Ontology1334514742253;FabEntite2"/>
        <prepare rdf:resource="&Ontology1334514742253;PiecePrepa2"/>
        <prepare rdf:resource="&Ontology1334514742253;PiecePrepa4"/>
    </owl:NamedIndividual>

    <!-- http://www.semanticweb.org/ontologies/2012/3/Ontology1334514742253.owl#EntiteAssemCont1 -->

    <owl:NamedIndividual rdf:about="&Ontology1334514742253;EntiteAssemCont1">
        <rdf:type rdf:resource="&Ontology1334514742253;EntiteAssemblageControle"/>
        <rdf:type rdf:resource="&Ontology1334514742253;EntiteControle"/>
        <owl:sameAs rdf:resource="&Ontology1334514742253;EntiteContr1"/>
        <controle rdf:resource="&Ontology1334514742253;PiecePrepa1"/>
        <controle rdf:resource="&Ontology1334514742253;PiecePrepa2"/>
    </owl:NamedIndividual>

    <!-- http://www.semanticweb.org/ontologies/2012/3/Ontology1334514742253.owl#EntiteAssemblageCont2 -->

    <owl:NamedIndividual rdf:about="&Ontology1334514742253;EntiteAssemblageCont2">
        <rdf:type rdf:resource="&Ontology1334514742253;EntiteAssemblageControle"/>
        <rdf:type rdf:resource="&Ontology1334514742253;EntiteControle"/>
        <owl:sameAs rdf:resource="&Ontology1334514742253;EntiteContr2"/>
        <controle rdf:resource="&Ontology1334514742253;PiecePrepa3"/>
        <controle rdf:resource="&Ontology1334514742253;PiecePrepa4"/>
    </owl:NamedIndividual>

    <!-- http://www.semanticweb.org/ontologies/2012/3/Ontology1334514742253.owl#EntiteContr1 -->

    <owl:NamedIndividual rdf:about="&Ontology1334514742253;EntiteContr1">
        <rdf:type rdf:resource="&Ontology1334514742253;EntiteAssemblageControle"/>
        <rdf:type rdf:resource="&Ontology1334514742253;EntiteControle"/>
        <NomSControle>VSC</NomSControle>
        <AdresseControle>rue sidi maarouf rue 40</AdresseControle>
        <VilleControle>Casablanca</VilleControle>
        <PaysControle>Maroc</PaysControle>
    </owl:NamedIndividual>

    <!-- http://www.semanticweb.org/ontologies/2012/3/Ontology1334514742253.owl#EntiteContr2 -->

    <owl:NamedIndividual rdf:about="&Ontology1334514742253;EntiteContr2">
        <rdf:type rdf:resource="&Ontology1334514742253;EntiteAssemblageControle"/>
        <rdf:type rdf:resource="&Ontology1334514742253;EntiteControle"/>
        <VilleControle>Casablanca</VilleControle>
        <PaysControle>maroc</PaysControle>
        <NomSControle>C.A</NomSControle>
        <AdresseControle>bouskoura bloc C numéros 4</AdresseControle>
    </owl:NamedIndividual> 
```

# linux - 在没有ROOT权限的linux上安装OpenCL(AMD SDK kit)

> ID：10730044
> 
> 赞同：4
> 
> 时间：2012-05-24T01:32:30.597
> 
> 标签：linux, installation, gpu, opencl, amd-gpu

我正在尝试在 linux 上安装 OpenCL(AMD)，但我被困在最后一步（安装 ICD）

似乎 ICD*必须*安装在 /etc/OpenCL/vendor 中，但我没有对计算机的 root 访问权限。

有什么方法可以在不安装 ICD 的情况下使 OpenCL 工作？（或者可能通过环境变量添加 ICD 文件的搜索路径？）

当 ICD 文件路径被硬编码时，对于像我们这样的人来说似乎真的很不方便。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-27T21:53:27.813

将 ICD 文件放在 /some/path/icd 中，然后像这样导出路径：

```
export OPENCL_VENDOR_PATH=/some/path/icd 
```

它至少在以前的版本中可以工作。如果他们改变它，我会感到惊讶。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-07T01:19:46.853

以下是如何在没有管理员权限的情况下进行 AMD OpenCL SDK 的“用户”或“本地”安装的草图。步骤 9 还提供了一种使用 AMD OpenCL 平台以及在系统范围内安装的选定平台的方法。

`/local/install/path`只需修改安装目录和当前 SDK 版本以适应即可。

1.  下载 AMD OpenCL SDK 64 位。

2.  `$ tar -xvzf AMD-APP-SDK-v2.8-RC-lnx64.tgz`

3.  `$ tar -xvzf icd-registration.tgz`

4.  `$ cd AMD-APP-SDK-v2.8-RC-lnx64`

5.  `$ mkdir /local/install/path`

6.  `$ cp -r lib /local/install/path`

7.  `$ cp -r include /local/install/path`

8.  `$ cp -r ../etc /local/install/path`

9.  可选：为所需的系统安装平台创建符号链接： `$ ln -s /etc/OpenCL/vendors/nvidia.icd /local/install/path/etc/vendors/nvidia.icd`

10.  `$ export OPENCL_VENDOR_PATH=/local/install/path/etc/vendors`

11.  `$ export LD_LIBRARY_PATH=/local/install/path/lib/x86_64:$LD_LIBRARY_PATH`

12.  `$ cc -I/local/install/path/include -L/local/install/path/lib/x86_64 -lOpenCL demo.c`

13.  `$ ./a.out`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-12-07T18:52:44.303

只是对此的更新，因为我突然发现自己（再次）遇到了同样的问题。我不得不禁用错误的 Mesa icd，它显然在非 root 运行下崩溃。令人沮丧的是，在列出每个平台时更多的是 API 处理错误的问题，而不是权限或 clinfo 的错误。确保禁用每个平台 icd 以隔离哪个平台有问题。希望这对以后的人有所帮助。

# amazon-ec2 - 我应该如何处理我的 EC2 应急计划？

> ID：10730050
> 
> 赞同：3
> 
> 时间：2012-05-24T01:34:03.030
> 
> 标签：amazon-ec2, amazon-web-services, amazon-ebs

我浏览了关于 SO 上有关备份 EC2 的其他问题，它为我提供了良好的基础，但我仍然对如何处理我的解决方案和制定应急计划感到有些困惑。大多数问题都是相当具体的，但我有一个非常普通的设置，我认为这些信息将对未来的用户有益。让我提供我的基本设置：

*   基础小实例
*   将文件推送到 S3
*   运行 MongoDB
*   运行 nginx

现在，由于 EC2 的短暂性，很明显我需要将我的 EC2 实例绑定到 EBS 以确保持久存储。我试图制定应急计划的原因是我担心我的实例可能随时消失（由于中断等）。如果我的实例消失了，我担心我必须启动一个新实例并重新安装我的所有应用程序，然后才能让一切重新运行。几个问题：

*   如何备份我的实例以确保如果它消失，我可以快速恢复它（最好不必重新安装所有以前的软件）？我不需要一系列备份，只需要前几天（或几周）的备份，以确保存在可以快速启动的以前的工作版本。
*   如果我使用 EBS 而不是实例存储，它基本上可以代替我的硬盘驱动器，对吗？因此，如果我安装了 MongoDB，我假设它正在写入放置在 EBS 上的 cab 的数据库？
*   如果我使用具有 160 GB 存储空间的小型实例并使用 EBS，我是否需要一开始就分配 160 GB 的 EBS，还是仅 160 GB 的实例存储空间？

因此，总而言之，我想要一个解决方案（手动或自动），它可以创建我的 EC2 实例的快照，以确保如果它消失，可以重建它，而无需花费时间手动重建所有内容。

在一个理想的世界中，如果我的实例消失了，我可以启动我的实例的一个版本，并且一切都完好无损（达到备份的程度）。有什么资源或建议吗？提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T11:00:14.113

OK, here we go:

For backups:

1.  Create your instance from one of the stock AWS images. Make sure it is an EBS-backed VM - depending on the size of the VM you pick, you'll get a volume assigned with 'n' GB of space, attached as the boot volume (/dev/sda1).

2.  Configure the VM with whatever software you need, apply patches, tune for disk fragmentation, CPU consumption (task priorities, etc), and any other configuration you need that makes the VM tailored to your requirements.

3.  Stop the VM and take a snapshot of the EBS volume, then restart it (re-assigning the Elastic IP is there is one). This is your backup snapshot - repeat as desired at whatever frequency you like. Remember to stop the VM when you snap it to prevent the OS writing to the volume whilst you're taking a copy of it.

For recovery:

1.  Your VM will fail, eventually. You'll break something and render it damaged or inoperative, or the hardware it's running on will suffer a fault. It will happen.

2.  When it does, terminate it (if it didn't self-terminate) and spin-up a new VM of the same type from the AWS stock list. Wait until it shows as 'Running', and then stop it.

3.  Detach its EBS volume and delete it.

4.  Create a new EBS volume from whichever backup snapshot you last created, and attach that new volume to the VM as /dev/sda1.

5.  Start the VM and assign your EIP if appropriate.

About EBS storage:

1.  It's a chunk of storage space. If you format it to look like a standard disk, you can use it exactly as you would a physical disk. Install stuff on it, point software at it for use as storage space, whatever.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T01:50:39.630

你有两个选择：（但不完全是你想要的；（）

1- 将“外部”EBS 附加到您的 EC2 实例中，然后手动（您可以通过 cronjobs 自动完成），从中制作快照！但这不是你想要的，为什么？如果您的 EC2 实例消失，您将需要重新创建所有环境并重新附加您的 EBS...所以这是在 EC2 上备份大量数据的好方法，但您的环境已被破坏...

2-最好的方法，但不是那么完美，是在您完成配置 EC2 后，从中创建一个私有 AMI，因此您可以随时从该 AMI 启动更多类似的实例，因此所有内容都被克隆......但最糟糕的部分是，每次您从实例更改配置时，您仍然需要创建一个新的 AMI，并且每次创建一个新的 AMI 时，您都需要重新启动实例以授予新实例上的数据完整性私人AMI！

我建议您仔细研究 RESERVED EC2 实例，它比普通实例具有更好的稳定性。但是您仍然可以将硬件灾难作为正常情况...

# c# - FileUpload 控件不接受 0kb 文件？

> ID：10730051
> 
> 赞同：5
> 
> 时间：2012-05-24T01:34:06.197
> 
> 标签：c#, asp.net, file-upload, web-controls

我正在使用空白文本文件来运行一些测试，并且因为 FileUpload1.HasFile 总是返回错误，即使它显然有一个文件，我也快疯了。然后我将测试文件切换到 0 kb 以上的文件（即其中包含文本的 txt 文件），然后它就可以工作了。

**据我所知，您不能上传 0 kb 的内容。这是真的？** 我在 MSDN 上阅读了有关 FileUpload 类的信息，但没有注意到任何说 0 kb 的文件将被忽略/视为不是文件的内容。

实际上，我认为这不是什么大问题（你为什么要上传一个空白文件？），但我可以想象某种罕见的情况，我可能想为不存在的东西保留空间'还没有内容，比如一个空白的文本文件供用户在他/她有时间的时候填写。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-24T01:43:34.537

您可以使用[`FileUpload.PostedFile Property`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.fileupload.postedfile.aspx)，即使内容是`0`字节，您也可以访问该文件

# javascript - 如何获取链接中#符号后的文本？

> ID：10730055
> 
> 赞同：0
> 
> 时间：2012-05-24T01:34:32.627
> 
> 标签：javascript, jquery

我有一个带有主题标签的简单链接。IE：

```
<a class="page_navigation" href="#something">click</a> 
```

单击此按钮后，我只想在 var 中得到“某物”部分（减去哈希）。

到目前为止我有

```
$('.page_navigation').click(function(e)
{
    e.preventDefault();
    var href = $(this).attr('href');
}); 
```

显然我只是在我的href var中用上面的代码结束了'#something'，我知道我可以做某种正则表达式（还不确定如何）来去除#，但我想知道是否有更简单的方法来访问我不知道的这部分 href，而无需通过一些查找和替换代码。

有任何想法吗？

注意：我也知道我可以将“某物”存储在数据标签中，但我正试图让这段代码尽可能干燥。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T01:36:12.530

如果你知道它有一个`#`，你可以使用这个：

```
$('.page_navigation').click(function(e)
{
    e.preventDefault();
    var hash = this.href.replace(/^.*#/, "");
}); 
```

如果你不知道它是否有一个它，你可以使用这个：

```
$('.page_navigation').click(function(e)
{
    e.preventDefault();
    var hash = "";
    if (this.href.indexOf("#") {
        hash = this.href.replace(/^.*#/, "");
    }
}); 
```

在[HTML5](https://developer.mozilla.org/en/DOM/HTMLAnchorElement)中，您可以使用：

```
this.hash 
```

但这仅适用于最新的浏览器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T01:40:30.640

```
var theHash = $(this).prop("hash").substr(1); 
```

另一个问题的[相关回答](https://stackoverflow.com/questions/1420881/javascript-jquery-method-to-find-base-url-from-a-string/1421037#1421037)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T01:37:46.430

您不需要正则表达式。你可以简单地做

```
var fragment;

if (window.location.hash) {
    fragment = window.location.hash;
} 
```

请注意，这也会选择 # 符号。所以，

`fragment = "#something"`

如果您不想要 # 符号，请`substring`像这样使用：

```
fragment = window.location.hash.substring(1) 
```

如果你想从一个锚标签中挑选出散列片段，你可以这样做：

```
var link = $('#yourAnchor').attr('href');
var fragment;
if (link.indexOf("#") !== -1) {
    fragment = link.substr(link.indexOf("#") + 1);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-24T01:41:11.277

**演示** [http://jsfiddle.net/UR3XN/](http://jsfiddle.net/UR3XN/)

**代码**

```
$('.page_navigation').click(function(e)
{
    e.preventDefault();
    var href = $(this).attr('href');
    var equalPosition = href.indexOf('#'); //Get the position of '#'
    var withouthash = href.substring(equalPosition + 1); 
    alert(withouthash);
});​ 
```

# wolfram-mathematica - 在 Mathematica 中评估三个变量的函数的导数

> ID：10730058
> 
> 赞同：1
> 
> 时间：2012-05-24T01:34:42.110
> 
> 标签：wolfram-mathematica

我正在尝试在 Mathematica 中的点 (3,5,1) 评估函数的导数。所以，这就是我的输入：

```
 In[120]:= D[Sqrt[(z + x)/(y - 1)] - z^2, x]
   Out[121]= 1/(2 (-1 + y) Sqrt[(x + z)/(-1 + y)])
   In[122]:= f[x_, y_, z_] := %
   In[123]:= x = 3
             y = 5
             z = 1
             f[x, y, z]
   Out[124]= (1/8)[3, 5, 1] 
```

如您所见，我得到了一些奇怪的输出。请在 (3,5,1) 处评估该导数的任何提示？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-24T02:44:49.923

你得到的结果让`Out[124]`我相信`f`以前的定义没有被清除。特别是，它似乎有所谓的[`OwnValue`](http://reference.wolfram.com/mathematica/ref/OwnValues.html)由形式的表达式设置的

```
f = 1/8 
```

（请注意缺少冒号。）您可以通过执行来验证这一点

```
g = 5;
OwnValues[g] 
```

返回

```
 {HoldPattern[g] :> 5} 
```

不幸的是，`OwnValues` [取代](https://mathematica.stackexchange.com/a/127/52)任何其他定义，如函数定义（称为 a[`DownValue`](http://reference.wolfram.com/mathematica/ref/DownValues.html)或其变体 an [`UpValue`](http://reference.wolfram.com/mathematica/ref/UpValues.html)）。所以，定义

```
g[x_] := x^2 
```

将导致`g[5]`评估为`5[5]`; 显然不是你想要的。因此，[`Clear`](http://reference.wolfram.com/mathematica/ref/Clear.html)您打算在定义之前用作函数的任何符号。也就是说，您的定义`f`仍然会遇到问题。

有问题的是，您[`SetDelayed`](http://reference.wolfram.com/mathematica/ref/SetDelayed.html)在`:=`定义`f`. 这可以防止赋值的右侧取值，直到`f`稍后执行。例如，

```
D[x^2 + x y, x]
f[x_, y_] := %

x = 5
y = 6
f[x, y] 
```

而是返回`6`。发生这种情况是因为`6`生成了最后一个结果，并且`f`实际上是[`%`](http://reference.wolfram.com/mathematica/ref/Out.html). 有两种方法可以解决这个问题，要么使用`Set`( `=`)

```
Clear[f, x, y]
D[x^2 + x y, x];
f[x_, y_] = %

f[5, 6] 
```

它`16`按预期返回，或者确保在得到它`%`之前被它的值替换，`SetDelayed`

```
Clear[f, x, y]
D[x^2 + x y, x];
f[x_, y_] := Evaluate[%] 
```

# javascript - .net on JS 后台调用按钮点击事件

> ID：10730059
> 
> 赞同：0
> 
> 时间：2012-05-24T01:34:45.900
> 
> 标签：javascript, .net

问题是.Net on JS调用按钮点击事件没有进入后台，报错。

C＃

```
 <asp:Button ID="btnDelete" runat="server" Text="Delete" CssClass="btn" 
    OnClientClick="return dgvCheckhasChoiced();"/> 
    <asp:Button ID="btnTest" runat="server" Text="Test"  
    CssClass="btn" OnClick="btnDelete_Click"/> 
```

JS代码

```
 if (canDelete) {
        alert(document.getElementById("<%=btnTest.ClientID %>").value);//Here has reutn
        document.getElementById("<%=btnTest.ClientID %>").click();
    //this code is run,but don't int the background 
    //经过此代码却没有进入后台方法点击事件
        msgboxShow('alert','Is Delete？',"alert('123');
        document.getElementById('<%=btnTest.ClientID %>').click();",1,1,'Warning');
        //return alert“123”，Move to next step can't  find the method
        //弹出了提示框“123”，进入到下一步却报找不到该方法
        //return confirm('确认删除？');//To simulate confirm effect 要模拟的confirm效果
        }
        else {
        msgboxShow('BeCareful','Please select at least one need to delete records!','',null,0,'Warning');
        //alert("Please select at least one need to delete records!");
         return false; 
```

# r - 在 ggplot2 中自定义轮廓标签

> ID：10730062
> 
> 赞同：2
> 
> 时间：2012-05-24T01:35:23.777
> 
> 标签：r, label, ggplot2, contour

我对 ggplot2 比较陌生，在为我的轮廓添加适当的标签时遇到了麻烦。我希望能够在没有 directlabels 包的情况下添加标签，但我还没有找到一种方法，所以如果你知道一种在没有 directlabels 的情况下自定义标签的方法，我很乐意在这里。

使用经典的火山示例，我可以通过以下方式使用 directlabels 数据包将标签添加到默认等值线图：

```
library(plyr)
library(ggplot2)
library(directlabels)
library(reshape)
volcano<-melt(volcano)
v<-ggplot(volcano, aes(x,y,z=z))
e<-v + stat_contour(aes(colour=..level..))
direct.label(e) 
```

在上面的例子中，标签被适当地添加了，但是如果我尝试为轮廓指定我自己的断点，事情会变得更加复杂：

```
e<-v + stat_contour(aes(breaks=c(160, 170, 180), colour=..level..))
direct.label(e) 
```

现在，轮廓由我提供的中断指定，但所有默认轮廓仍然显示标签。如何仅绘制图形轮廓的标签？

一个相关的问题，我将如何绘制不包含在默认值中的等高线级别的标签？说休息165：

```
e<-v + stat_contour(aes(breaks=c(165), colour=..level..))
direct.label(e) 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-07-23T11:00:27.860

当前的开发版本（带有 ggplot2_0.9.3.1 的 directlabels_2013.6.15）应该可以解决您的问题（正如 directlabels 包的作者向我解释的那样）。您可以使用以下方式安装它：

```
install.packages("directlabels", repos="http://r-forge.r-project.org") 
```

接着：

```
library(plyr)
library(ggplot2)
library(directlabels)
library(reshape)
volcano<-melt(volcano)
v<-ggplot(volcano, aes(X1,X2,z=value))
e<-v + stat_contour(aes(colour=..level..), breaks=c(165))
direct.label(e) 
```

我通过简单的解决方法注意到了其他几个限制：

*   第一个`ggplot`电话必须包含`z`审美
*   这仅适用于`stat_contour`（而不适用于`geom_contour`）
*   `colour`美学必须在调用中定义并`stat_contour`设置为`..level..`

最后，如果您想控制标签和轮廓线的颜色（例如黑色标签和蓝色轮廓线），您可以通过以下方式实现：

```
e<-v + stat_contour(aes(colour=..level..), colour = "blue", breaks=c(165))
e<-e + scale_colour_continuous(low = "#FF0000", high = "#FF0000")
direct.label(e) 
```

# bash - Bash - 内存使用情况

> ID：10730066
> 
> 赞同：0
> 
> 时间：2012-05-24T01:36:38.113
> 
> 标签：bash, memory

我有一个我无法解决的问题，所以我来找你。

我需要编写一个程序来读取所有进程，并且程序必须按用户对它们进行排序，并且对于每个用户，它必须显示使用了多少内存。

例如：

用户1 ：120MB 用户2
：300MB用户3
：50MB
总计：470MB

我正在考虑使用 ps aux 命令执行此操作，然后使用 awk 命令退出 pid 和用户。然后使用 pmap 我只需要获取进程的总内存使用量。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T03:34:42.567

试试这个脚本，它可能会解决你的问题：

```
#!/bin/bash
function mem_per_user {
    # take username as only parameter
    local user=$1
    # get all pid's of a specific user
    # you may elaborate the if statement in awk obey your own rules
    pids=`ps aux | awk -v username=$user '{if ($1 == username) {print $2}}'`

    local totalmem=0
    for pid in $pids
    do
        mem=`pmap $pid | tail -1 | \
            awk '{pos = match($2, /([0-9]*)K/, mem); if (pos > 0) print mem[1]}'`
        # when variable properly set
        if [ ! -z $mem ]
        then
            totalmem=$(( totalmem + $mem))
        fi
    done

    echo $totalmem
}

total_mem=0
for i in `seq 1 $#`
do
    per_user_memory=0
    eval username=\$$i
    per_user_memory=$(mem_per_user $username)
    total_mem=$(( $total_mem + $per_user_memory))

    echo "$username: $per_user_memory KB"
done
echo "Total: $total_mem KB" 
```

最好的祝福！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T20:04:59.563

这只是一个小更新，用户被自动选择

```
#!/bin/bash
function mem_per_user {
    # take username as only parameter
    local user=$1
    # get all pid's of a specific user
    # you may elaborate the if statement in awk obey your own rules
    pids=`ps aux | awk -v username=$user '{if ($1 == username) {print $2}}'`

    local totalmem=0
    for pid in $pids
    do
        mem=`pmap $pid | tail -1 | \
            awk '{pos = match($2, /([0-9]*)K/, mem); if (pos > 0) print mem[1]}'`
        # when variable properly set
        if [ ! -z $mem ]
        then
            totalmem=$(( totalmem + $mem))
        fi
    done

    echo $totalmem
}

total_mem=0
for username in `ps aux | awk '{ print $1 }' | tail -n +2 | sort | uniq`
do
    per_user_memory=0
    per_user_memory=$(mem_per_user $username)
    if [ "$per_user_memory" -gt 0 ]
    then
       total_mem=$(( $total_mem + $per_user_memory))

       echo "$username: $per_user_memory KB"
    fi
done
echo "Total: $total_mem KB" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T02:00:32.227

您可以使用 subprocess 模块在 python 中访问 shell 命令。它允许您生成子进程并连接到 out/in/error。您可以执行`ps -aux`命令并在 python 中解析输出。

[在这里查看文档](http://docs.python.org/library/subprocess.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-31T02:51:47.897

这是我的版本。我认为 Tim 的版本不能正常工作，KB 中的值太大了。我认为应该使用 pmap -x 命令中的 RSS 列来提供更准确的值。但请注意，您不能总是获得正确的值，因为进程可以共享内存。阅读本文[一种确定进程“真实”内存使用情况的方法，即私有脏 RSS？](https://stackoverflow.com/questions/118307/a-way-to-determine-a-processs-real-memory-usage-i-e-private-dirty-rss)

```
#!/bin/bash
 if [ "$(id -u)" != "0" ]; then
 echo "WARNING: you have to run as root if you want to see all users"
 fi
echo "Printing only users that current memmory usage > 0 Kilobytes "
all=0
for username in `ps aux | awk '{ print $1 }' | tail -n +2 | sort | uniq`
do
 pids=`ps aux | grep $username | awk -F" " '{print $2}'`
 total_memory=0
 for pid in $pids
 do
  process_mem=`pmap -x $pid | tail -1 | awk -F" " '{print $4}'`

  if [ ! -z $process_mem ] 
  then #don't try to add if string has no length
   total_memory=$((total_memory+$process_mem))
  fi
 done
#print only those that use any memmory
if [ $total_memory -gt 0 ]
then
 total_memory=$((total_memory/(1024)))
 echo "$username : $total_memory MB"
 all=$((all+$total_memory))
 fi
done
echo "----------------------------------------"
echo "Total: $all MB"
echo "WARNING: Use at your own risk" 
```

# python - 词法分析python

> ID：10730071
> 
> 赞同：0
> 
> 时间：2012-05-24T01:38:05.850
> 
> 标签：python, string, escaping, quotes, lexical-analysis

最近我做了以下观察：

```
>>> x= "\'"
>>> x
"'"
>>> y="'"
>>> y
"'"
>>> print x
'
>>> print y
' 
```

谁能解释一下为什么会这样。我正在使用 python 2.7.x。我很了解转义序列。

我想做以下事情：我有一个带单引号的字符串，我必须在数据库中输入它，所以我需要用反斜杠替换单引号（'）的实例，后跟单引号（\'） . 我怎样才能做到这一点。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-24T01:40:38.457

在一对 中`""`，您不需要转义`'`字符。当然可以，但正如您所见，这是不必要的，也没有任何效果。

如果您要写 a `'`inside a pair`''`或 a `"`inside a pair ，则必须转义`""`：

```
x = '\''
y = "\"" 
```

**编辑 ：**

关于问题的最后一部分，在编辑后添加：

> 我有一个带单引号的字符串，我必须将它输入数据库，所以我需要用反斜杠替换单引号（'）的实例，后跟单引号（\'）。我怎样才能做到这一点

以下任何一种方法都可以，请注意使用[原始字符串](http://docs.python.org/reference/lexical_analysis.html#string-literals)来避免转义特殊字符：

```
v = "\\'"
w = '\\\''
x = r'\''
y = r"\'"

print v, w, x, y
> \' \' \' \' 
```

# winapi - 调用 VerQueryValue 时出现错误 1813

> ID：10730077
> 
> 赞同：1
> 
> 时间：2012-05-24T01:39:59.750
> 
> 标签：winapi

我想获取 dll 或 exe 的版本信息。为此，我调用函数 VerQueryValue。

这是我的代码：

```
 UINT  dwBytes;

    DWORD  dwSize = GetFileVersionInfoSizeA(pszFile, (DWORD*)&dwBytes);
    if( dwSize == 0)
        return;

    struct LANGANDCODEPAGE {
        WORD wLanguage;
        WORD wCodePage;
    } *lpTranslate;

    UINT cbTranslate;

    LPVOID lpData = (LPVOID)malloc(dwSize);
    ZeroMemory(lpData, dwSize);       
    if(GetFileVersionInfoA(pszFile, 0, dwSize, lpData) )
    {       
        VerQueryValueA(lpData, 
            "\\VarFileInfo\\Translation",
            (LPVOID*)&lpTranslate,
            &cbTranslate);

        // Read the file description for each language and code page.
        char    strSubBlock[MAX_PATH] = {0};
        char* lpBuffer;

        for(int i=0; i < (cbTranslate/sizeof(struct LANGANDCODEPAGE)); i++ )
        {
            sprintf(strSubBlock, 
                "\\StringFileInfo\\%04x%04x\\FileDescription",
                lpTranslate[i].wLanguage,
                lpTranslate[i].wCodePage);

            // Retrieve file description for language and code page "i". 
            VerQueryValueA(lpData, 
                strSubBlock, 
                (void**)&lpBuffer, 
                &dwBytes); 
        }
    }
    free( lpData ); 
```

调用 VerQueryValueA 时出现 1813 错误。此代码与 url [http://msdn.microsoft.com/zh-cn/library/ms647464%28v=vs.85%29](http://msdn.microsoft.com/zh-cn/library/ms647464%28v=vs.85%29)几乎相同。

我已经在vc++6和vc++2005下测试过代码，得到了同样的错误。我的windows是win7。

我应该如何解决它？提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T09:46:06.103

根据[MSDN](http://msdn.microsoft.com/en-us/library/windows/desktop/ms681386%28v=vs.85%29.aspx)，此错误代码映射到 ERROR_RESOURCE_TYPE_NOT_FOUND。因此，我会得出结论，图像文件中不存在您要查找的资源 (FileDescription)。

# mysql - 需要帮助以使我的 mysql 查询更快

> ID：10730078
> 
> 赞同：0
> 
> 时间：2012-05-24T01:40:00.017
> 
> 标签：mysql, query-optimization

有人可以帮助我或向我解释如何使我的查询更快吗？这个查询需要将近 10 秒（在我的本地机器上），数据量接近 1GB。

这是我的解释和解释结果

```
 explain select p.delivery_date, p.delivery_hour, p.resource_id, p.participant_id, p.price, p.date_posted, hour(p.date_posted) as hour_date_posted, date(p.date_posted) as date_date_posted
    ,s.mw
from prices_report as p
left join schedules_report s
on s.delivery_date = p.delivery_date
                    AND s.type_id = p.type_id
            and s.delivery_hour = p.delivery_hour
                    and s.resource_id = p.resource_id
                    and s.participant_id = p.participant_id
                    and hour(s.date_posted) = hour(p.date_posted)
                    and date(s.date_posted) = date(p.date_posted)
WHERE p.delivery_date = '2012-05-22'
AND p.type_id = 'GEN'
ORDER BY p.delivery_date, p.resource_id, p.delivery_hour, p.participant_id, p.type_id, p.date_posted 
```

![在此处输入图像描述](../Images/f827369a6c338a31e4f5955a97c2061b.png)

***解释结果：***
id：1
选择类型：简单
表：p
类型：参考
可能的键：idx1
键：idx1
key_len：4
参考：const
行：40258
额外：使用 where

id：1
选择类型：简单
表：s
类型：参考
可能的键：idx1
键：idx1
key_len：63
参考：const，APC_DB.p.delivery_hour，APC_DB.p.participant_id，APC_DB.p.resource_id，const
行：99
额外：

**表结构：**

```
 CREATE TABLE `prices_report` (
  `id` int(11) NOT NULL auto_increment,
  `delivery_date` date default NULL,
  `delivery_hour` int(2) default NULL,
  `participant_id` varchar(10) default NULL,
  `resource_id` varchar(15) default NULL,
  `type_id` varchar(10) default NULL,
  `price` float default NULL,
  `date_posted` datetime NOT NULL,
  `date_created` timestamp NOT NULL default CURRENT_TIMESTAMP on update CURRENT_TIMESTAMP,
  PRIMARY KEY  (`id`),
  UNIQUE KEY `IDX1` USING BTREE (`delivery_date`,`resource_id`,`delivery_hour`,`participant_id`,`type_id`,`date_posted`)
) ENGINE=MyISAM AUTO_INCREMENT=5261441 DEFAULT CHARSET=latin1 ROW_FORMAT=DYNAMIC;

CREATE TABLE `schedules_report` (
  `id` int(11) NOT NULL auto_increment,
  `delivery_date` date default NULL,
  `delivery_hour` int(2) default NULL,
  `participant_id` varchar(15) default NULL,
  `resource_id` varchar(20) default NULL,
  `type_id` varchar(10) default NULL,
  `mw` float default NULL,
  `loss_factor` float default NULL,
  `date_posted` datetime NOT NULL,
  `date_created` timestamp NOT NULL default CURRENT_TIMESTAMP on update CURRENT_TIMESTAMP,
  PRIMARY KEY  (`id`),
  UNIQUE KEY `IDX1` USING BTREE (`delivery_date`,`delivery_hour`,`participant_id`,`resource_id`,`type_id`,`date_posted`)
) ENGINE=MyISAM AUTO_INCREMENT=43369 DEFAULT CHARSET=latin1 ROW_FORMAT=DYNAMIC; 
```

百万谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T02:00:40.707

问题似乎是“模糊匹配”：

```
LEFT JOIN ... ON ...
and hour(s.date_posted) = hour(p.date_posted)
and date(s.date_posted) = date(p.date_posted) 
```

每次碰到 p 中的一行时，强制 MySQL 计算s`hour(s.date_posted)`中的所有行。`date(s.date_posted)`

试试这个：

```
and s.date_posted
  BETWEEN DATE_SUB(p.date_posted, INTERVAL TIME_TO_SEC(MAKETIME(0,MINUTE(p.date_posted),SECOND(p.date_posted))) SECOND)
  AND DATE_ADD(DATE_SUB(p.date_posted, INTERVAL TIME_TO_SEC(MAKETIME(0,MINUTE(p.date_posted),SECOND(p.date_posted))) SECOND), INTERVAL 1 HOUR) 
```

**编辑：**

如果您可以忍受错误计算的闰秒，则可以将其写成更易于阅读

```
and s.date_posted
  BETWEEN DATE_SUB(p.date_posted, INTERVAL 60*MINUTE(p.date_posted)+SECOND(p.date_posted) SECOND)
  AND DATE_ADD(DATE_SUB(p.date_posted, INTERVAL 60*MINUTE(p.date_posted)+SECOND(p.date_posted) SECOND), INTERVAL 1 HOUR) 
```

**编辑2：** 重复部分计算值的上限`BETWEEN`是故意的：MySQL只会计算一次。

**编辑 3：** 现在看到你的`SHOW CREATE TABLE`，我知道你在 date_posted 上没有单独的索引，而只是一个组合索引。你可能想试试

```
ALTER TABLE `schedules_report` ADD INDEX(date_posted) 
```

# c# - 使用 C# 扩展方法处理事件

> ID：10730082
> 
> 赞同：6
> 
> 时间：2012-05-24T01:40:08.330
> 
> 标签：c#, windows, events, lambda, extension-methods

我最近了解了如何使用 C# 扩展方法来更轻松地调用事件，并且我越来越多地使用它们。我最近遇到了一个我不明白的奇怪问题，我想知道是否有人可以解释一下。

尝试将事件处理程序扩展方法设置为另一个事件的事件处理程序时会出现此问题。这是我正在做的一个例子：

```
public static class EventHandlerExtensions
{
    public static void Raise<TEventArgs>(
        this EventHandler<TEventArgs> eventHandler, 
        object sender, TEventArgs args)  where TEventArgs:EventArgs
    {
        if (eventHandler != null)
        {
            eventHandler(sender, args);
        }
    }
}

public class Test
{
    private event EventHandler<EventArgs> EventA;
    private event EventHandler<EventArgs> EventB;

    public Test()
    {
        Console.WriteLine("::Start");
        EventB += EventA.Raise;
        EventA += (s, a) => Console.WriteLine("Event A raised");
        EventB.Raise(this, EventArgs.Empty);
        Console.WriteLine("::End");
    }
} 
```

在此示例中，应触发 EventA 作为触发 EventB 的结果。但是，当我运行此代码时，EventB 会触发，但 A 上的扩展方法没有找到任何侦听器。

如果我改变顺序，一切正常：

```
Console.WriteLine("::Start");
EventA += (s, a) => Console.WriteLine("Event A raised");
EventB += EventA.Raise;
EventB.Raise(this, EventArgs.Empty);
Console.WriteLine("::End"); 
```

此外，从 lambda 调用 EventA.Raise 可以正常工作：

```
Console.WriteLine("::Start");
EventB += (s, a) => EventA.Raise(s, a);
EventA += (s, a) => Console.WriteLine("Event A raised");
EventB.Raise(this, EventArgs.Empty);
Console.WriteLine("::End"); 
```

这只是一个简单的示例，但我正在尝试创建一个类，该类可以以最简洁的方式重新调度添加到其中的事件源的事件。我不想创建命名方法只是为了重新分派相同的事件，我也不想存储以后可以从事件处理程序中取消挂钩的 lambda 函数列表。大多数情况下，我只是好奇为什么会这样？

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T01:54:44.970

您可以通过 Raise 函数将 EventA 的旧值捕获到闭包中。因为后来你使用 += 它改变了 EventA 的值，但你的闭包仍然有一个旧值。

你编码：

```
EventB += EventA.Raise;
EventA += (s, a) => Console.WriteLine("Event A raised"); 
```

可以扩展为等效代码，这清楚地说明了为什么你会得到旧的委托：

```
var oldEventA = EventA;
EventB += oldEventA.Raise; // captures old value here
// now EventA changed to new value 
EventA = oldEventA + ((s, a) => Console.WriteLine("Event A raised");) 
```

您可以在之前添加以下内容以`EventB += EventA.Raise`验证代码是否确实为 A 引发了旧事件：

```
EventA += (s, a) => Console.WriteLine("Old Event A raised"); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-24T02:16:07.580

委托对象是*不可变*的。很像弦乐。因此，当您分配 EventA 时，您会创建一个*新*对象。EventB 仍然以旧的为目标，即尚未分配任何事件处理程序的那个。您必须交换这两个语句才能解决问题。

# asp.net-mvc - Asp.Net Mvc 上的控制器继承

> ID：10730086
> 
> 赞同：0
> 
> 时间：2012-05-24T01:40:50.890
> 
> 标签：asp.net-mvc, frameworks

样本：

我有两节课

X 和 Y:X

我有两个控制器

XController 和 YController：XController

```
public class XController:Controller
{
    public virtual PartialViewResult Detail(X model)
    {
    }
} 
```

但是由于签名不同，我无法覆盖 Detail 方法。

我在其他视图的 7 个地方有 RenderAction(p=>p.Detail(y)) 代码。当我在 YController 中覆盖 Detail 方法时，一切都必须没问题。

我必须编写 CustomControllerResolver 吗？

[显示模板不用于界面](https://stackoverflow.com/questions/9127772/using-mvc3-razor-and-display-templates-with-interfaces)

上面的解决方案对我来说还不够。因为我不想改变其他任何东西。只有我覆盖了 YController 上的 Detail Action。

我可以用一点 DRY 来做。如何从 Action 的另一个区域调用 View ？喜欢

```
return View("AnotherArea.Detail",model); 
```

# java - 在 java 中制作基于文本的操作系统时，我应该使用线程吗？

> ID：10730095
> 
> 赞同：-2
> 
> 时间：2012-05-24T01:42:07.053
> 
> 标签：java, multithreading, text-based

我正在用java制作基于文本的操作系统，我想知道我是否应该使用线程。它有一个图形用户界面，但您可以键入命令并按一个按钮来输入它们。然后它在 textArea 中吐出文本。我应该什么时候使用线程以及如何使用它们？我需要使用线程吗？我真的不知道如何使用它们以及何时使用它们！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T01:46:09.227

当您不希望 GUI 锁定时使用线程。例如，如果您有（或预见到）“取消似乎卡住的正在进行的操作”按钮，那么该操作最好在单独的线程中进行，否则您的取消按钮将成为卡住的一部分。

此外，在某些环境（例如智能手机）中，如果 Java 程序的 GUI 锁定，操作系统将终止该程序。

要了解 Java 中的线程，请查看[并发](http://docs.oracle.com/javase/tutorial/essential/concurrency/)教程。

# linux - 如何在 Gentoo Linux 中自动加载内核模块？

> ID：10730096
> 
> 赞同：6
> 
> 时间：2012-05-24T01:42:09.187
> 
> 标签：linux, kernel-module, gentoo

我想在启动时自动加载一些内核模块。我已经阅读了手册，但无能为力。现在我要自动加载`vboxdrv` `vboxnetadp` `vboxpci` `vboxnetflt`的模块是，模块目录是`/lib/modules/3.0.6-gentoo/`，配置文件目录是`/etc/modules.autoload.d/kernel-3.0.6`，在这个文件中，模块都包含在内。现在我重新启动它后，使用`lsmod`，我看不到这些模块已加载。有什么问题？

```
thinkpad walle # ls -l /boot/
总用量 17068
lrwxrwxrwx 1 root root       1  1月 10 01:22 boot -> .
drwxr-xr-x 2 root root    4096  4月 27 10:55 grub
-rw-r--r-- 1 root root 5771120  3月 23 09:27 kernel-3.0.6
-rw-r--r-- 1 root root 5771120  4月 26 17:48 kernel-3.0.6-n5
-rw-r--r-- 1 root root 5876784  4月 27 10:55 kernel-3.0.6-n6
drwx------ 2 root root   16384  1月 17 15:47 lost+found 
```

现在我`kernel-3.0.6-n6`用作我的引导内核。

```
thinkpad walle # cat /etc/modules.autoload.d/kernel-3.0.6 
xt_mark
test_nx
scsi_wait_scan
wlagn
ext2
vboxdrv
vboxnetadp
vboxpci
vboxnetflt 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-24T05:38:37.577

`/etc/conf.d/modules`根据[http://www.gentoo.org/doc/en/handbook/handbook-x86.xml?part=1&chap=7#doc_chap5](http://www.gentoo.org/doc/en/handbook/handbook-x86.xml?part=1&chap=7#doc_chap5)指定自动加载的模块

该`/etc/init.d/modules`脚本读取`/etc/conf.d/modules`文件并加载模块。它应该已经在启动运行级别，但如果不是，请运行`rc-update add modules boot`以在启动时加载它们。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-24T07:06:57.990

/etc/conf.d/modules 现在不使用了。Systemd 使用自己的结构

将你的模块列表文件放在 /etc/modules-load.d/ man modules-load.d

把你的模块选项文件放在 /etc/modprobe.d/ man modprobe.d

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-21T08:48:17.613

好吧，编辑 /etc/conf.d/modules 不是自动加载，因为你需要在每次内核重建后编辑这个文件。

**关于自动加载硬件**内核模块 的主要思想在这里描述：http: [//doc.opensuse.org/documentation/html/openSUSE/opensuse-reference/cha.udev.html](http://doc.opensuse.org/documentation/html/openSUSE/opensuse-reference/cha.udev.html) 和 [http://wiki.gentoo.org/wiki/乌德夫](http://wiki.gentoo.org/wiki/Udev)

简而言之：udev 正在管理您的硬件，每次出现新硬件时（内核在 /dev 中创建链接），udev 都会搜索适当的内核模块，如果找到则加载它。所有设备信息均由 sysfs 提供。

# java - 向服务器发出 POST 请求并从响应中获取特定的 cookie

> ID：10730097
> 
> 赞同：1
> 
> 时间：2012-05-24T01:42:09.520
> 
> 标签：java, android, vb.net

我正在尝试将旧的 VB.NET 应用程序移植到 Android 应用程序，但由于我缺乏 Java 经验，我无法找到这个应用程序。我尝试了多种解决方案，但无济于事。

这个想法基本上是向“http://login.vk.com/”发出 POST 请求并获取响应 cookie。如果有人能给我关于如何在 Android 上使用 cookie 的提示，我将非常感激。

原始代码

```
 Public Sub Login(ByVal Username As String, ByVal Password As String)
    Try

        ' Make request
        Dim cont As New CookieContainer
        Dim request As HttpWebRequest
        request = WebRequest.Create("http://login.vk.com/")
        request.Method = "POST"
        request.CookieContainer = cont

        ' Create POST content and send
        Dim postdata As String = "act=login&success_url=&fail_url=&try_to_login=1&to=&vk=&al_test=3&email=" & HttpUtility.UrlEncode(Username) & "&pass=" & HttpUtility.UrlEncode(Password) & "&expire="
        Dim postbytes() As Byte = System.Text.Encoding.UTF8.GetBytes(postdata)
        request.ContentType = "application/x-www-form-urlencoded"
        request.ContentLength = postbytes.Length
        Dim requestStream As Stream = request.GetRequestStream
        requestStream.Write(postbytes, 0, postbytes.Length)
        requestStream.Close()

        ' Get response and login cookie
        Dim response As HttpWebResponse = request.GetResponse
        Dim cookies As CookieCollection = request.CookieContainer.GetCookies(New Uri("http://pirate.vk.com"))
        For Each myCookie As Cookie In cookies
            If myCookie.Name = "remixsid" Then
                Me.Guid = myCookie.Value
            End If
        Next
        response.Close()

        ' Throw error if cookie not found
        If Not IsLoggedIn Then Throw New Exception("Invalid login guid")

    Catch ex As Exception
        Throw New Exception("Error at custom login", ex)
    End Try
End Sub 
```

目前写的代码：

```
 HttpClient httpclient = new DefaultHttpClient();
            HttpPost httppost = new HttpPost("http://login.vk.com/");

            try {
                List<NameValuePair> postData = new ArrayList<NameValuePair>(); 
                postData.add(new BasicNameValuePair("act", "login"));
                postData.add(new BasicNameValuePair("success_url", ""));
                postData.add(new BasicNameValuePair("fail_url", ""));
                postData.add(new BasicNameValuePair("try_to_login", "1"));
                postData.add(new BasicNameValuePair("to", ""));
                postData.add(new BasicNameValuePair("vk", ""));
                postData.add(new BasicNameValuePair("al_test", ""));
                postData.add(new BasicNameValuePair("email", URLEncoder.encode(username, "UTF-8")));
                postData.add(new BasicNameValuePair("pass", URLEncoder.encode(password, "UTF-8")));
                postData.add(new BasicNameValuePair("expire", ""));
                httppost.setEntity(new UrlEncodedFormEntity(postData));

                HttpResponse response = httpclient.execute(httppost);

            } catch(Exception e) {

            } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T02:31:28.083

尝试以这种方式获取 cookie 作为响应：

```
private static HttpParams params;
params = new BasicHttpParams();
HttpClientParams.setRedirecting(params, false);
HttpClientParams.setCookiePolicy(params, CookiePolicy.BROWSER_COMPATIBILITY);
HttpClient httpclient = new DefaultHttpClient(params);

HttpPost httppost = new HttpPost("http://login.vk.com/");

            try {
                List<NameValuePair> postData = new ArrayList<NameValuePair>(); 
                postData.add(new BasicNameValuePair("act", "login"));
                postData.add(new BasicNameValuePair("success_url", ""));
                postData.add(new BasicNameValuePair("fail_url", ""));
                postData.add(new BasicNameValuePair("try_to_login", "1"));
                postData.add(new BasicNameValuePair("to", ""));
                postData.add(new BasicNameValuePair("vk", ""));
                postData.add(new BasicNameValuePair("al_test", ""));
                postData.add(new BasicNameValuePair("email", URLEncoder.encode(username, "UTF-8")));
                postData.add(new BasicNameValuePair("pass", URLEncoder.encode(password, "UTF-8")));
                postData.add(new BasicNameValuePair("expire", ""));
                httppost.setEntity(new UrlEncodedFormEntity(postData));

                HttpResponse response = httpclient.execute(httppost);
                List<Cookie> cookies = ((DefaultHttpClient)httpclient).getCookieStore().getCookies();
                for(Cookie cookie : cookies){
                Log.i("Cookie", cookie.toString());
             }

            } catch(Exception e) {

            } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T02:01:04.310

希望这对您有所帮助：

```
 HttpURLConnection urlConn = null;
//edit String data as what you want
    String data = "act=login&success_url=&fail_url=&try_to_login=1&to=&vk=&al_test=3&email=" & URLEncoder.encode(username, "UTF-8")) & "&pass=" & URLEncoder.encode(password, "UTF-8")) & "&expire="
        URL mUrl;
        StringBuffer response = new StringBuffer(); 
        try {               
            mUrl = new URL("http://login.vk.com/");
            urlConn = (HttpURLConnection) mUrl.openConnection();
            urlConn.setRequestMethod("POST");
            //query is your body
            urlConn.setRequestProperty("Content-Type", "application/x-www-form-urlencoded");            
            urlConn.setRequestProperty("Content-Length", Integer.toString(data.length()));
            urlConn.setUseCaches (false);
            urlConn.setDoInput(true);
            urlConn.setDoOutput(true);

            //send request
            DataOutputStream wr = new DataOutputStream (
                    urlConn.getOutputStream ());
            wr.write(data.getBytes("UTF8"));
            wr.flush ();
            wr.close ();

            //Get Response  
            InputStream is = urlConn.getInputStream();
            BufferedReader rd = new BufferedReader(new InputStreamReader(is));
            String line;            
            while((line = rd.readLine()) != null) {
              response.append(line);
              response.append('\r');
            }
            rd.close();
            String result = response.toString();
            return result;
        } catch (MalformedURLException e1) {
            // TODO Auto-generated catch block
            e1.printStackTrace();
        } catch (UnsupportedEncodingException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }  catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }finally {

              if(urlConn != null) {
                  urlConn.disconnect(); 
              }
        } 
```

# java - Spring config xml文件管理，数据库连接信息

> ID：10730108
> 
> 赞同：0
> 
> 时间：2012-05-24T01:44:03.957
> 
> 标签：java, spring, spring-mvc, intellij-idea

Maven 模块弹簧应用程序。

1个模块是一个spring mvc应用程序，另一个是一个非web但spring托管的应用程序。

在我的项目根目录中，我有：

```
/src/main/conf 
```

此文件夹包含我的非 Web 托管 spring xml 配置。我将此文件夹添加到我在 intellij 中的类路径中。

1.  IntelliJ 没有正确拾取文件，这意味着我没有得到代码完成或任何东西（分配的名称等以粗体红色表示，即 intellij 告诉我有问题）。这可以以某种方式解决吗？我将 spring mvc 配置文件保存在其模块中（而不是 conf 文件夹中），因为代码完成不起作用，并且在没有 IDE 帮助的情况下使用起来很痛苦。但它使部署期间的管理变得更加困难。

2.  在我的两个 Spring 配置文件（对于 Web 应用程序和非 Web 应用程序）中，我的数据源设置硬编码在文件中，我想以某种方式将其提取到属性文件中，我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T10:27:07.883

1 - 您可以在同一个文件夹中拥有不同的弹簧配置文件，只是您需要使用不同的名称。因此，我将使用 src/main/resources 在 maven 项目结构中创建一个新文件夹。你会避免问题。

2-两个文件中的数据源？为什么？如果您已经有两个 spring 配置文件，我将创建第三个（application-context-dao.xml）并共享数据源。如何将属性移动到配置文件？[见](https://stackoverflow.com/a/10735405/980472)。

# c++ - std::reference_wrapper 是否应该包含默认比较器“<”运算符？

> ID：10730111
> 
> 赞同：9
> 
> 时间：2012-05-24T01:44:45.577
> 
> 标签：c++, stl, c++11, reference-wrapper

STL 使用“小于”作为默认比较器。即使基础类定义了“<”运算符，对使用 reference_wrapper<> 包装的对象的 STL 比较器调用[也不会编译。](https://stackoverflow.com/q/9139748/1408646)

看来，这是因为当*LHS.operator<(RHS)*是成员函数时，没有在*LHS*上执行[隐式转换。](https://stackoverflow.com/a/9139979/1408646)我已经验证了[使用免费版本](https://stackoverflow.com/a/10717235/1408646)作为比较器的工作原理。

 **但是，如果 reference_wrapper 提供了“<”运算符，它在底层调用“<”，则无需使用 free 函数。

我在 reference_wrapper 的代码中添加了以下内容（取自 VS11 Beta xrefwrap.h），并且可以将 std::map 与包装在我的 reference_wrapper<> 版本中的类一起使用，该版本定义了“<”运算符。

```
 bool operator <(reference_wrapper<_Ty> const rhs) const {
    return this->get() < rhs.get();
} 
```

稍后添加：如果我理解正确，reference_wrapper<> 提供了与许多库所需的 ptr 相关的复制/分配语义，同时隐藏了与 ptr 相关的语法。这允许使用引用类型语法，而没有本地副本的开销。将它与使用 ptrs 的示例进行比较完全错过了 reference_wrappers 的要点之一：***您****要避免使用 ptr 类型语法。*

现在的情况是，直接作用于对象的代码在对象被包装在 reference_wrappers 中时会中断。不用说，“<”是默认的比较器，确实使它特别；在现有代码的很大一部分中，对象将定义这些以消除对特殊比较器的需要。

稍后添加 #2：此功能的历史表明，避免使用 ptr 语法并不是最初的意图。然而，自从它首次在 boost 中引入以来已经有十年了。随着大量新程序员“指导”[避免使用基于 ptr 的语法](https://stackoverflow.com/a/9149473/1408646)（无疑受到 ptr 自由语言的影响），如果它可以更无缝地工作，特别是在处理在 STL 容器中存储对象的遗留代码时，此功能将变得越来越有用，并且价值复制遍地。

**稍后添加 #3：以最少的代码更改改进遗留代码** 随着时间的推移，瘦类变得繁重，容器中对象的大小增加。提高性能的一种快速方法是通过包装对象避免复制。这将提供“C ptr”类型的性能，而无需对代码进行最小更改的额外副本。

```
std::map<const Object, string> objTable;
// can be rewritten as to avoid object copies using the
// __myOwn::reference_wrapper which contains the '<' operator
std::map<__myOwn::reference_wrapper<const Object>, string> rwTable_myOwn;

// which works with out any non-member free comparator functions
rwTable_myOwn[a]="One"; // Compiles and works

// When using the table with the std::reference_wrapper
std::map<std::reference_wrapper<const Object>, string> rwTable_std;
//the map does not work
rwTable_std[a]="One"; // Fails to compile it needs the custom non-member comparator 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-24T02:34:48.780

不，不应该。*除了将引用*包装为值之外，它`reference_wrapper`不做任何事情。

 *如果您需要比较两个`reference_wrapper<T>`（这*不是*对 的引用`T`），那么您的工作就是完成这项工作。出于同样的原因`std::set<T*>`，默认情况下不会将比较定义为`std::less<T>(*x, *y)`，您的情况也不应如此。包装器只是一个非空指针。

为什么要停在单个比较运算符或所有比较运算符上？为什么不为*所有*标准函数重载引用包装器？因为当解决方案如此简单时，它不值得。***

# database - 使用 MVC 3 和 Razor 在 TreeView 中填充部分树（一次一层）

> ID：10730112
> 
> 赞同：1
> 
> 时间：2012-05-24T01:44:51.733
> 
> 标签：database, asp.net-mvc-3, treeview

有人知道您是否可以使用 Microsoft ASP.NET/MVC TreeView 一次填充一个层次结构级别？换句话说，我希望一开始只能填充顶层，当用户单击它时，会从数据库中提取下一层，依此类推，直到达到最底层。如果可能的话，我想避免一次将整个树加载到基于对象的模型中。这是一个相当大的基于数据库的树，所以我需要一次只做一个级别。

我会很感激一些示例代码，甚至只是指出我正确的方向。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T02:31:48.823

看看那里的一些 jQuery 树视图实现。它们中的大多数可以使用 Ajax 按需填充。例如[http://www.jstree.com/](http://www.jstree.com/)

# java - 多个选项卡请求

> ID：10730113
> 
> 赞同：0
> 
> 时间：2012-05-24T01:45:22.160
> 
> 标签：java, spring, jakarta-ee

我有一个 Spring，ibatis 应用程序在哪里

1) 将向用户显示广告系列列表

2) 用户选择一个特定的活动，并在多个页面中执行有关该活动的活动

3) 用户打开另一个选项卡并选择不同的活动并进行一些其他活动

在这种情况下，我如何传播广告系列 ID？将其存储在会话中将不起作用，因为每个选项卡中的广告系列 ID 都不同。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T10:26:53.527

在这种情况下，您应该在 url 中将活动 ID 作为路径变量传递，并使用在路径变量中获得的活动 ID 在不同的窗口中执行不同的操作。

希望这对您有所帮助。

干杯。

# javascript - 有没有办法查看（匿名）函数的内部？

> ID：10730116
> 
> 赞同：1
> 
> 时间：2012-05-24T01:46:16.370
> 
> 标签：javascript, functional-programming, anonymous-function

在 JavaScript 中，假设您有：

```
function doSomething(callback) {
    if (callback instanceof Function) callback();
}

doSomething(function() {
    alert('hello world');
}); 
```

有没有办法检查“回调”内部的内容（例如，被调用的事实`alert()`）`doSomething()`？就像是：

```
function doSomething(callback) {
    alert(callback.innards().indexOf('alert('));
} 
```

我只是好奇

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T01:53:44.833

[Function.prototype.toString()](http://es5.github.com/#x15.3.4.2)给出一个`implementation-dependent representation of the function`. 然而，内置函数将返回如下内容：

```
function Array() {
   /* [native code] */
} 
```

宿主方法可以返回任何东西，甚至抛出错误。所以严格的答案是肯定的，也许。但在实际意义上，它是不可靠的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T01:50:24.317

一些浏览器支持函数上的[toString()](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Function/toString)。

```
function doSomething(callback) {
    console.log( callback.toString().indexOf('alert(') )
    if (callback instanceof Function) callback();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T01:51:06.843

你应该可以说：

```
alert( callback.toString().indexOf('alert(') ); 
```

但是，如果它恰好在字符串文字中，则不会区分 function`alert(`的开头， function 的开头`myspecialalert(`和文本- 所以你可能需要做一些解析。`"alert("`

不确定这是如何跨浏览器的，但在 Firefox 中至少`.toString()`返回函数的整个文本，包括单词“function”和参数列表。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-24T01:52:24.597

```
callback.toString().indexOf('alert('); 
```

或者做一个正则表达式匹配，如：

```
/alert *\(/.test(callback.toString()); 
```

# c# - WCF 发送 Object[] 而不添加 KnownTypeAttributes

> ID：10730123
> 
> 赞同：1
> 
> 时间：2012-05-24T01:47:31.613
> 
> 标签：c#, .net, wcf, reflection, wcf-client

问题：我有一个 WCF 服务，它通过反射调用方法并发送结果。像这样：

`[OperationContract] Object InvokeMemberByReflection(string typeName, string name, BindingFlags invokeAttr, Binder binder, Object target, Object[] args);`

我这样做是因为我有一个想要调用的现有 API X。我不想为所有方法编写包装器。

我也不使用显式 DataContracts，因为服务器和客户端都引用同一组 dll。

但是，对于上面的 InvokeMemberByReflection 方法，由于我将方法参数作为类型对象的数组发送，看起来我必须将 API X 的所有可能的方法签名添加为 KnownTypeAttributes 才能使 DataContractSerializer 工作。

有解决办法吗？CLR 基本上知道对象数组中包含的元素的类型。它不能基于此进行序列化/反序列化（假设它是不同的类型）？

我也很欣赏解决此类问题的任何其他模式。由于显而易见的原因，反射太慢了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T02:07:16.650

如果客户端和服务器使用相同的 DLL（即类型完全相同），那么您可以使用`NetDataContractSerializer`不需要已知类型属性的 （它在序列化时发出 CLR 类型信息）。[这篇文章](http://theburningmonk.com/2010/08/wcf-using-the-netdatacontractserializer-to-share-your-type/)有一个关于如何使用该序列化程序的示例。

# terminal - URL 的 Grep 页面源

> ID：10730124
> 
> 赞同：0
> 
> 时间：2012-05-24T01:48:01.477
> 
> 标签：terminal, grep

我在文本文档中有一个网页源，有几行如下：

```
"rid" : 'http://web.site/urlhere', 
```

如何使用 Linux/终端 grep 只是该`http://web.site/urlhere`部分？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T01:53:24.660

您可以将*-o*选项传递给 grep 以告诉它仅显示匹配的模式。

```
grep -o http://web.site/urlhere somefile.txt 
```

假设您正在寻找通用 URL，您可以从以下内容开始（并可能对其进行改进）：

```
grep -o "'http.*'" someFile.txt | sed "s/'//g" 
```

这将在单引号后搜索文本*http*并将包括该行中的所有字符，直到最后一个单引号。然后它将结果（仅匹配模式）传递给 sed 并删除单引号。

注意：如果您在 url 后面有更多单引号，您可能会遇到麻烦（但您的问题没有提及）...

由于您的问题非常不具体，因此可能还有许多其他输入条件可能会导致问题，但以上应该是一个很好的起点。

有关 grep 的更多信息： [http ://unixhelp.ed.ac.uk/CGI/man-cgi?grep](http://unixhelp.ed.ac.uk/CGI/man-cgi?grep)

# jquery - 检测输入值，如果无效则修改值

> ID：10730127
> 
> 赞同：0
> 
> 时间：2012-05-24T01:48:40.427
> 
> 标签：jquery, jquery-validate, forms, html-input

我认为这是一个简单的问题，但是，我找不到解决方案。

我有一个由 jQuery Validator 验证的表单。我有一个 html 输入类型，它是 url，并使用 jQuery 来验证它是一个 url。我想编写一个脚本来检测输入的值是否以 http:// 或 https:// 开头，如果不以其中任何一个开头，则自动将 http:// 添加到开头价值。另外，我希望脚本检测表单值是否为空，如果为空，则不添加 http://

```
<input name="Website" type="url" id="Website" > 
```

谢谢你，CampSoup1988

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T03:07:26.300

试试这个...

[http://jsfiddle.net/KMc8x/4/](http://jsfiddle.net/KMc8x/4/)

```
$(document).ready(function () {

        $('input#Website').bind('change',function() {
               addhttp();
        });

        $('input#Website').keyup(function() {
               addhttp();
        });    
});

function addhttp () {
    // if user has entered 4 or more characters
    if ($("input#Website").val().length >= 4) {

        // if user's first 4 characters are not http
        if ($("input#Website").val().indexOf("http") == -1) {
            $("input#Website").val('http://' + $("input#Website").val());
        }

    // if user has entered 1-4 characters
    } else if ($("input#Website").val().length > 0 && $("input#Website").val().length < 5) {

        // if user's first 4 characters do not have h
        if ($("input#Website").val().indexOf("h") == -1) {
            $("input#Website").val('http://' + $("input#Website").val());
        }
    }

} 
```

# iphone - Cloudant / CouchDB 将 600 多个文档“拉”复制到 iPhone

> ID：10730128
> 
> 赞同：0
> 
> 时间：2012-05-24T01:48:44.100
> 
> 标签：iphone, couchdb, cloudant, couchcocoa

我正在使用 Cloudant，我正在努力将 600 个文档从服务器提取/复制到我的 iPhone。首先，它非常慢，因为它必须一次处理一个文档，并且 Second Cloudant 在第 100 个左右的 REST 请求之后给了我“超时”。（我有一张 Cloudant 的票，因为这是不可接受的！）

我想知道是否有人在拉动时找到了“批量”复制的方法/黑客。我在想，也许可以“压缩”所有更改，将它们发送到一个文件中，然后将 iPhone 数据库快进到最后一个更改序列。

任何帮助都很棒——谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T14:03:32.500

你不能点击 _all_docs?include_docs=true 来一次性搞定一切吗？[http://wiki.apache.org/couchdb/HTTP_Document_API#all_docs](http://wiki.apache.org/couchdb/HTTP_Document_API#all_docs)

我不知道 couchcoccoa 但它看起来像 API 支持这个：[http ://couchbaselabs.github.com/CouchCocoa/docs/interfaceCouchDatabase.html#a49d0904f438587b988860891e8049885](http://couchbaselabs.github.com/CouchCocoa/docs/interfaceCouchDatabase.html#a49d0904f438587b988860891e8049885)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-03T15:15:30.147

其实，为什么不做一个视图。创建一个视图，为您提供您的列表，并确保您的 id 在那里。使用您的 ID，您可以转到文档并获取所需的所有其余信息，以便在需要时对其进行更新。

您确实没有理由需要单独点击每个文档。他们对此有意见和search2.0。请记住，您使用的是基于云的技术。这些东西不在你的地下室里，你不能在几秒钟内每台设备点击一百万次，然后期望任何人都不会注意到和/或不高兴（夸大其词，是的，我知道）。

我不明白的是你正试图将它复制到 iPhone 上？你在你的应用程序中运行 apache 和 couchdb 吗？为什么不直接读取 JSON 数据并将其放入数据库中。或者如果它更新那么多并继续覆盖它，就把它扔到一个文件中。有这么多的选择完全不那么混乱。

# c# - 如何跨多个帐户使用 Outlook 插件捕获已发送的项目？

> ID：10730129
> 
> 赞同：4
> 
> 时间：2012-05-24T01:49:26.783
> 
> 标签：c#, outlook, add-in

我已经使用 C# 构建了一个 Outlook 2010 插件。我创建了一个 Inspector 包装器，并使用它来捕获将项目添加到 Sent Items 文件夹的时间。

然后，我捕获有关该项目的一些详细信息并对其进行处理。

它一直运行良好，但我最近遇到有人在 Outlook 中拥有多个电子邮件帐户。我的插件似乎只从 1 个已发送项目文件夹中捕获项目。

```
sentfolder = this.Application.Session.GetDefaultFolder(Outlook.OlDefaultFolders.olFolderSentMail);
sentitems = sentfolder.Items;
sentitems.ItemAdd += new Outlook.ItemsEvents_ItemAddEventHandler(sentitems_ItemAdd);

_wrappedInspectors = new Dictionary<Guid, InspectorWrapper>();
_inspectors = Globals.ThisAddIn.Application.Inspectors;
_inspectors.NewInspector += new Outlook.InspectorsEvents_NewInspectorEventHandler(WrapInspector); 
```

显然，我只需要遍历不同帐户的文件夹并识别每个已发送的项目文件夹，但我不确定如何实现。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T13:14:08.220

如果用户有多个电子邮件帐户，[`Session.Stores`](http://msdn.microsoft.com/en-us/library/bb176787%28v=office.12%29.aspx)或者`Session.Accounts`应该提供对他们使用的其他共享邮箱的访问权限。

请参阅[有关如何访问共享邮箱的相关 SO 帖子](https://stackoverflow.com/a/9231786/175679)。

# ruby-on-rails - act_as_taggable_on 的 tagged_with 方法的奇怪行为

> ID：10730130
> 
> 赞同：0
> 
> 时间：2012-05-24T01:49:30.397
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我试图找到与当前查看的记录具有相似标签的所有记录。我的控制器有：

```
 def show
    @tattoo =Tattoo.find(params[:id])
    tags = @tattoo.style_list.join(", ")
    @tattoos = Tattoo.tagged_with(tags, :any => true).limit(6)
  end 
```

（如果有人能告诉我如何随机化数组中记录的顺序，则加分）我的视图只是循环遍历数组。

无论如何，它几乎一直有效，但我注意到它偶尔会中断，在故障排除时我发现它在我使用时会中断，`tagged_with("jesse smith", :any => true)`但在我尝试`tagged_with("jason stephan", :any => true)`或`tagged_with("black ink", :any => true)`

所以每个术语都有一个空格，但无论出于何种原因，“杰西史密斯”都会扼杀行动。

我的控制台显示我也有路由错误：

```
ActionView::Template::Error (No route matches {:action=>"show", :controller=>"tattoos", :member_id=>nil, :id=>#<Tattoo id: 170, description: "", status: "approved", member_id: nil, created_at: "2011-10-25 23:08:17", updated_at: "2011-11-17 16:56:55", file_file_name: "starry-eyed-rabid-squirrelweb.jpg", file_content_type: "image/jpeg", file_file_size: 294782, file_updated_at: "2011-10-25 23:08:17", album_id: nil, position: 116, favorite_count: 0, share_count: 1, file_remote_url: "http://www.jessesmithtattoos.com/wp-content/gallery...">}):
    22:    <ol class="small_tattoos">
    23:     <% @tattoos.each do |t| %>
    24:       <li>
    25:       <%= link_to image_tag(t.file.url(:tiny),:alt=>"#{t.style_list}, rtattoos, tattoos"), member_tattoo_path(t.member, t) %>
    26:       </li>
    27:     <% end %>
    28:    </ol>
  app/views/index/show.html.erb:25:in `block (2 levels) in _app_views_index_show_html_erb___1839804211534816245_69842632179360__4333294961394575926'
  app/views/index/show.html.erb:23:in `block in _app_views_index_show_html_erb___1839804211534816245_69842632179360__4333294961394575926'
  app/views/index/show.html.erb:11:in `_app_views_index_show_html_erb___1839804211534816245_69842632179360__4333294961394575926' 
```

那么为什么一个术语会导致路由错误而不是其他术语呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T02:42:53.690

我猜你对路径助手有问题：

```
member_tattoo_path(t.member, t) 
```

我在您的错误描述中看到

```
:member_id=>nil 
```

所以原来用 jesse smith 标记的纹身与名称“成员”没有对应的关联，并且需要有效 id 的路径助手抛出异常。

# python - 在 PyQt 中创建动态按钮

> ID：10730131
> 
> 赞同：7
> 
> 时间：2012-05-24T01:49:30.397
> 
> 标签：python, qt, pyqt

我尝试在 PyQt 类中添加一个函数，但它总是返回一个错误。

```
# Error: TypeError: connect() slot argument should be a callable or a signal, not 'NoneType' # 
```

```
def commander (self, arg):
    exec arg    

def aButton (self, layout, **kwargs):
    name = kwargs.pop("name","Button")
    command = kwargs.pop("command", "" )
    button = QtGui.QPushButton(name)
    button.clicked.connect(self.commander(command))
    layout.addWidget(button)
    return button 
```

可能有人可以帮我解决这个问题：'）谢谢！

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-05-24T02:03:12.003

你需要一个函数：

```
button.clicked.connect(lambda: self.commander(command)) 
```

注意 lambda 将避免函数调用的评估，所以它`self.commander(command)`只会在单击时调用

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-24T02:00:11.823

似乎在

```
button.clicked.connect(self.commander(command)) 
```

`self.commander(command)`正在返回`None`而不是信号或可调用对象。

# mootools - 使用 mootools 的响应式网站的平滑过渡 div 高度

> ID：10730133
> 
> 赞同：1
> 
> 时间：2012-05-24T01:50:20.620
> 
> 标签：mootools, responsive-design

目前致力于响应式网页设计，标记已完全完成，并且在所有浏览器宽度下都可以正常工作。但我不能不管它。试图用一些平滑的过渡而不是急速下降来调整新闻持有 div 的高度。

我为任何想帮助解决这个问题的人设置了一个 jsfiddle，我相信它对任何使用响应式网页设计的人都会派上用场。 [http://jsfiddle.net/rYQtb/10/](http://jsfiddle.net/rYQtb/10/)

很多thnx！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T07:33:39.053

我认为对于你想要做的事情，你需要一个 resize 事件的监听器，所以我添加了一个。

我在这里尝试了一些从你的小提琴开始的东西：http: [//jsfiddle.net/rYQtb/15/](http://jsfiddle.net/rYQtb/15/)
我已经更新了 JavaScript 和 CSS（添加了一个溢出值）。但是您是否希望将高度固定在全局 div（如小提琴）或每个“新闻”div 上？

希望它会有所帮助！

# javascript - 使用 JavaScript 定位时元素的位置不在预期位置

> ID：10730136
> 
> 赞同：2
> 
> 时间：2012-05-24T01:50:28.500
> 
> 标签：javascript, jquery, css

我正在做一个轨道模拟，我有行星在运行，但是如果你看里面的 3 颗行星，然后从轨道的虚线移动。在轨道的底部，行星低于这条线。在轨道的顶部，行星位于虚线之上或之上。

[您可以在此处](http://jsfiddle.net/jzaun/Pe87m/)查看一个工作示例。

我认为这与没有考虑边框宽度有关，但我试图纠正这个问题的一切都没有奏效。我目前正在使用 outerWidth() 和 outerHeight() ，但这似乎并没有起到作用。

这是相关的代码：

```
var width = parseFloat($(this).parent().outerWidth()) / 2;
var height = parseFloat($(this).parent().outerHeight()) / 2;
var point = getPoint(width, height, angle * (Math.PI / 180));

$(this).css('left', point[0] + ($(this).parent().outerWidth() / 2) + 'px');
$(this).css('top', point[1] + ($(this).parent().outerHeight() / 2) + 'px'); 
```

`getPoint`功能是：

```
function getPoint(width, height, angle)
{
    var x = parseFloat(width) * Math.cos(angle);
    var y = parseFloat(height) * Math.sin(angle);
    return [x, y];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T02:35:18.070

你是对的 - 这是边框大小。我检查了 CSS，它看起来不错，但是较小的行星明显偏离了中心。

为了解决这个问题，我所做的就是改变这些行：

```
 'margin-top'  : '-' + ($(this).outerHeight() / 2) + 'px',
    'margin-left' : '-' + ($(this).outerWidth() / 2) + 'px' 
```

为此（在划分之前添加了两个）：

```
 'margin-top'  : '-' + (($(this).outerHeight() + 2) / 2) + 'px',
    'margin-left' : '-' + (($(this).outerWidth() + 2) / 2) + 'px' 
```

[您可以在此处](http://jsfiddle.net/Pe87m/16/)更新的小提琴中看到一个工作示例。

`UPDATE`- 似乎这并不能完全解决问题 - 当行星绕到轨道的 RHS 时，它们开始移动到外缘。不过，从好的方面来说，你知道修复是在这两行中......你只需要以适当的数量补偿位置，我相信这最终可能是动态的或基于行星位置的东西。

# ios - 使用 iOS 和 Django 访问共享数据库

> ID：10730139
> 
> 赞同：1
> 
> 时间：2012-05-24T01:51:10.040
> 
> 标签：ios, django

我刚刚开始学习 iOS 开发，我认为最好的入门方法是构建一个简单（但不平凡）的应用程序。我的想法是：有一个网络界面，用户可以在其中创建调查，然后通过应用程序访问这些调查并将响应发送回服务器。网页设计部分可能不会很困难——我以前用 Django 做过类似的事情。需要学习/努力的部分是 iPhone 应用程序。

我有足够的Objective-C，数据结构（模型）不会很难编码，UI（视图，控制器）部分也不应该是坏的。不过，我预测网络和电话之间的界面会很困难。特别是，我如何才能通过手机访问服务器上的数据库？我想要一个网络和电话应用程序都使用的数据库。

我真正想要的是一个笼统的、粗略的描述，说明我需要做什么才能让这一切正常运行。我是否相信网络将是最难的部分？还有其他可能的障碍吗？任何建议或指向有关该主题的良好资源的指针，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T01:57:01.820

网络可能不是这里最难的部分，你只是在猜测，因为这方面你不熟悉。例如，您可以使用[NSURLConnection](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/nsurlconnection_Class/Reference/Reference.html)来处理服务器连接的几乎所有细节。您可以使用[NSJSONSerialization](https://developer.apple.com/library/ios/#documentation/Foundation/Reference/NSJSONSerialization_Class/Reference/Reference.html)将数据转换为适合通过网络发送的格式。

基本上你可能会做的是：

*   移动应用程序向服务器发送 HTTP GET 请求以获取调查信息。
*   服务器以调查的 JSON 描述响应。
*   用户填写调查。
*   完成后，应用程序会将响应以 JSON 格式作为 HTTP POST 发送回服务器。
*   服务器将结果存储在数据库中。

这里的关键点之一是手机上的应用程序*不会*尝试直接访问数据库。所有请求都通过您的 Django Web 应用程序。

# row - 在 jsoup 中查找选定行元素的行索引

> ID：10730141
> 
> 赞同：0
> 
> 时间：2012-05-24T01:51:46.550
> 
> 标签：row, jsoup

```
static public void main( String[] args ) {
   Document playerpage =
      Jsoup.connect("http://en.wikipedia.org/wiki/Diego_Forl%C3%A1n").get();
   Elements table = playerpage.getElementsByTag("table").select("table.infobox");
   Elements ind = table.select("tr:contains(Club information)"); 
```

如您所见，我成功选择了包含文本的表格行：`Club information`。

当我想使用该数字进行下一次搜索时，如何返回该元素的行索引？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T12:30:07.210

```
 Document playerpage = Jsoup.connect("http://en.wikipedia.org/wiki/Diego_Forl%C3%A1n").get();
    Elements table = playerpage.select("table.infobox > tbody > tr");
    int rowCount = 0;
    for (Element e : table) {
        if (e.text().contains("Club information")) {
            System.out.println("Row: " + rowCount);
            System.out.println(e);
        }
        rowCount++;
    } 
```

# ruby-on-rails-3 - 今年 Rails3 记录

> ID：10730144
> 
> 赞同：2
> 
> 时间：2012-05-24T01:53:00.773
> 
> 标签：ruby-on-rails-3, date, where

在 Rails3 中，如何检索所有日期为今年的记录？我想检索今年“日期”所在的所有“项目”。

我怀疑它会类似于：

```
@projects_this_year = Project.where(:date.Time.year == Time.now.year)
or
@projects_this_year = Project.where(:date >= ?, Time.now.year) 
```

我正在阅读文档，但还没有完全弄清楚这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T01:57:47.590

你可以做这样的事情（假设一个 MySQL DB）：

`@projects_this_year = Project.where("year(date) = ?", Time.now.year)`

或更好：

`@projects_this_year = Project.where("year(date) = year(utc_timetamp())")`

这不需要加载时间库。

供参考：[http ://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html)

编辑

* * *

如果您希望它独立于数据库，那么您可以执行以下操作：

`@projects_this_year = Project.where("date >= ?", Time.now.at_beginning_of_year)`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T21:11:45.293

如果您经常需要特定的月份或年份，或者通过扩展@David 的答案，您也可以在模型中使这种动态变化：

```
def self.get_year(date)
    # sanitize if params
    safe = ['2011', '2012', '2013']
    if safe.include?(date)
         where("year(created_at) = ?", Time.parse("#{date}-01-01 11:11:11 -0500").year)
    else
         scoped
    end
end 
```

前任：

```
Product.get_year('2012') 
```

*注意要让它在heroku上工作，请更改以下内容：*

```
where("date_part('year', created_at) = ?", Time.parse("#{date}-01-01 11:11:11 -0500").year 
```

[http://www.java2s.com/Code/PostgreSQL/Date-Timezone/datepartyeardate.htm](http://www.java2s.com/Code/PostgreSQL/Date-Timezone/datepartyeardate.htm)

# ruby-on-rails - 在控制器中使用日期数据的简单方法？

> ID：10730145
> 
> 赞同：0
> 
> 时间：2012-05-24T01:53:09.993
> 
> 标签：ruby-on-rails, ruby

正在加载从 datetime_select 帮助程序提交的日期时间值，因此我可以将其与现有保存的数据进行比较。

我正在使用以下代码，但感觉有点麻烦。

```
DateTime.parse("#{params['start_date(1i)'].to_i}-#{params['start_date(2i)'].to_i}-#{params['start_date(3i)'].to_i} #{params['start_date(4i)'].to_i}:#{params['start_date(5i)'].to_i} -500") 
```

有没有更简单的方法来构建日期时间对象？

编辑：

这是我的表单代码：

```
= form_for(@charity) do |f|
  - if @charity.errors.any?
    #error_explanation
      %h2
        = pluralize(@charity.errors.count, "error")
        prohibited this charity from being saved:
      %ul
        - @charity.errors.full_messages.each do |msg|
          %li= msg
  .field
    = f.label :name, 'Name *'
    = f.text_field :name

  %fieldset
    %legend Dates in Eastern Standard Time
    .field
      = f.label :start_date, 'Start Date *'
      = f.datetime_select :start_date, :default => DateTime.now
    .field
      = f.label :end_date, 'End Date *'
      = f.datetime_select :end_date, :default => DateTime.now
    .field
      = f.label :percentage, 'Percentage of sales to be donated *'
      = f.text_field :percentage
    .field
      = f.label :charity_number, 'The identification number for your charity *'
      = f.text_field :charity_number
    .field
      Donation options: 
      %span{ title: "Dollar amounts that you wish to allow people to donate on top of their order.", class: "tooltip_hover" }= image_tag "question.png"
      - DonationOption.all.each do |option|
        = f.label option.id, number_to_currency(option.amount, unit: "$"), class: "donation_label"
        = check_box_tag "charity[donation_option_ids][]", option.id, @charity.donation_option_ids.include?(option.id), class: "donation_check"
      .actions
        = f.submit nil, class: "btn-primary" 
```

控制器：

```
def update
  @charity = Charity.find(params[:id])
  respond_to do |format|
    if @charity.update_values(params[:charity])
      format.html { redirect_to @charity, notice: 'Charity was successfully updated.', :charity => @charity }
      format.json { head :ok }
    else
      format.html { render action: "edit" }
      format.json { render json: @charity.errors, status: :unprocessable_entity }
    end
  end
end 
```

update_values 方法：

```
def update_values(attributes)
  s_date = DateTime.parse("#{attributes['start_date(1i)'].to_i}-#{attributes['start_date(2i)'].to_i}-#{attributes['start_date(3i)'].to_i} #{attributes['start_date(4i)'].to_i}:#{attributes['start_date(5i)'].to_i} -500")
  attributes.delete('start_date(1i)')
  attributes.delete('start_date(2i)')
  attributes.delete('start_date(3i)')
  attributes.delete('start_date(4i)')
  attributes.delete('start_date(5i)')
  # if the charity has not started yet
  if DateTime.now.utc < self.start_date.utc
    self.start_date = s_date
    attributes.merge!(reset_create_job)
  end

  e_date = DateTime.parse("#{attributes['end_date(1i)'].to_i}-#{attributes['end_date(2i)'].to_i}-#{attributes['end_date(3i)'].to_i} #{attributes['end_date(4i)'].to_i}:#{attributes['end_date(5i)'].to_i} -500")
  attributes.delete('end_date(1i)')
  attributes.delete('end_date(2i)')
  attributes.delete('end_date(3i)')
  attributes.delete('end_date(4i)')
  attributes.delete('end_date(5i)')
  if DateTime.now.utc < self.end_date.utc
    self.end_date = e_date
    attributes.merge!(reset_delete_job)
  end

  self.update_attributes(attributes)
end 
```

# jquery - 附加了 JQuery 的颜色框

> ID：10730148
> 
> 赞同：0
> 
> 时间：2012-05-24T01:53:40.620
> 
> 标签：jquery, colorbox

我正在尝试使用`Colorbox`从 facebook 填充的照片，这对于页面加载时填充的图像效果很好。但是当我使用`.getJSON`加载 25 个以上的图像并将它们附加到我的表时，颜色框不再起作用。我已经看到提到使用该`.live`命令，但我想我没有遵循该做什么......

这是我的jQuery代码

```
$(function () {

    $(".photos1").colorbox({
        rel: 'photos1',
        transition: "fade"
    });

    var loading = '<img src="images/ajax-loader.gif" /> <b>LOADING</b>';

    $('#get_albums').click(function () {
        $('#ld_ck').html(loading);
        $('#get_albums').html('');
        load_albums();
    });

    $('#get_photos').click(function () {
        $('#ld_ck').html(loading);
        $('#get_photos').html('');
        load_photos();
    });

    function load_photos() {
        var after = $('#photos_next').val();
        var offset = $('#photos_offset').val();
        var gallery_id = $('#g_id').val();
        $.getJSON('get_photos.php?gallery_id=' + gallery_id + '&after=' + after + '&offset=' + offset, function (json) {
            $.each(json, function (key, val) {
                if (key == "photos") {
                    $('#photos').append(val);
                }
                if (key == "after") {
                    $('#photos_next').val(val);
                }
                if (key == "offset") {
                    $('#photos_offset').val(val);
                }
                if (key == "count") {
                    if (val == "25") {
                        $('#get_photos').html('<b>SEE MORE</b>');
                    }
                }
            });
            $('#ld_ck').html('');
        });
    }

}); 
```

`get_photos.php`将`json`一串表行返回到 jquery。

这里只是基本 html 表的一行，但最初有 5 行，并且`get_photos.php`一次添加另外 5行

```
<table width="99%" border="0" cellspacing="5" cellpadding="0" id="photos" class="photos">
  <tr>
    <td align="center" class="photos" style="padding-top:10px; height:140px; width:140px; border:1px solid #7B7B7B; background:#E9E9E9;"><a class="photos1" href="fb_photo.jpg"> <img src="fb_thumb.jpg" alt="fb_photo" border="0" /> </a> </td>
    <td align="center" class="photos" style="padding-top:10px; height:140px; width:140px; border:1px solid #7B7B7B; background:#E9E9E9;"><a class="photos1" href="fb_photo.jpg"> <img src="fb_thumb.jpg" alt="fb_photo" border="0" /> </a> </td>
    <td align="center" class="photos" style="padding-top:10px; height:140px; width:140px; border:1px solid #7B7B7B; background:#E9E9E9;"><a class="photos1" href="fb_photo.jpg"> <img src="fb_thumb.jpg" alt="fb_photo" border="0" /> </a> </td>
    <td align="center" class="photos" style="padding-top:10px; height:140px; width:140px; border:1px solid #7B7B7B; background:#E9E9E9;"><a class="photos1" href="fb_photo.jpg"> <img src="fb_thumb.jpg" alt="fb_photo" border="0" /> </a> </td>
    <td align="center" class="photos" style="padding-top:10px; height:140px; width:140px; border:1px solid #7B7B7B; background:#E9E9E9;"><a class="photos1" href="fb_photo.jpg"> <img src="fb_thumb.jpg" alt="fb_photo" border="0" /> </a> </td>
  </tr>
</table>
<div style="width:99%; text-align:center;" id="see_more">
  <input name="photos_next" id="photos_next" type="hidden" value="xxxxxxxxxxxx" />
  <input name="photos_offset" id="photos_offset" type="hidden" value="25" />
  <input name="g_id" id="g_id" type="hidden" value="xxxxxxxx" />
  <a id="get_photos"><b>SEE MORE</b></a></div>
<div id="ld_ck" class="loader" style="width:99%; text-align:center;" ></div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T04:02:48.560

你必须绑定一个`live`点击处理程序来实现你想要的

```
$('.photos').on('click','.photos1', function() {
    $.fn.colorbox({href:$(this).attr('href'), open:true,
                   rel: 'photos1',transition: "fade"});
    return false;
} 
```

[$.on](http://api.jquery.com/on/)的文档

[工作小提琴](http://jsfiddle.net/joycse06/4vuDC/151/)

根据 URL 更新：

你`get_photos.php`是这样输出`td`的

```
<td align=\"center\" class=\"photos\" style=\"padding-top:10px; height:140px; width:140px; border:1px solid #7B7B7B; background:#E9E9E9;\">
  <a id=\"photos1\" href=\"http:\/\/sphotos.xx.fbcdn.net\/hphotos-ash4\/s720x720\/398601_355232294489552_174042505941866_1396720_1688100724_n.jpg\"><img src=\"http:\/\/photos-b.ak.fbcdn.net\/hphotos-ak-ash4\/398601_355232294489552_174042505941866_1396720_1688100724_s.jpg\" alt=\"355232294489552\" border=\"0\">
  <\/a>
<\/td> 
```

当我们在类中使用类时更改`id=\"photos1\"`为`class=\"photos1\"`on`a`标签并像这样更改调用`photos1``$.on``$.on`

```
$('table#photos').on('click','.photos1', function() {
    $.fn.colorbox({href:$(this).attr('href'), open:true,
                   rel: 'photos1',transition: "fade"});
    return false;
} 
```

它应该可以正常工作。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T05:06:23.863

这真的可以解决`.live()`吗？添加新照片后，似乎更多的是重新初始化 colorBox 的问题。

我看到您已经接受了乔伊的回答，但如果仅在简化代码方面，您可能需要考虑以下一些想法。

```
$(function () {
    var colorboxSettings = ({
        rel: 'photos1',
        transition: "fade"
    }
    $(".photos1").colorbox(colorboxSettings);

    var loading = '<img src="images/ajax-loader.gif" /> <b>LOADING</b>';

    $('#get_albums').on('click', load_albums);
    $('#get_photos').on('click', load_photos);

    function load_photos() {
        $('#ld_ck').html(loading);
        $('#get_photos').html('');
        var data = {
            after: $('#photos_next').val(),
            offset: $('#photos_offset').val(),
            gallery_id: $('#g_id').val()
        };
        $.getJSON('get_photos.php', data, function(json) {
            if(json.photos && json.after && json.offset && json.count) {//or similar
                $('#photos').append(json.photos);
                $('#photos_next').val(json.after);
                $('#photos_offset').val(json.offset);
                if (Number(json.count) == 25) { $('#get_photos').html('SEE MORE'); }
                $.colorbox.remove();//maybe?
                $(".photos1").colorbox(colorboxSettings);//or is it $(".photos") ?
            }
            $('#ld_ck').html('');
        });
    }
}); 
```

如您所见，存在一些不确定性，但没有什么是您无法解决的。

# actionscript-3 - AS3 Telnet 示例未读取响应

> ID：10730154
> 
> 赞同：0
> 
> 时间：2012-05-24T01:54:34.207
> 
> 标签：actionscript-3, flash, apache-flex, air, adobe

我正在测试我从 adobe 获得的样本 TelnetSocket 样本。这是代码：

**TelnetSocket.mxml：**

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml"
    layout="vertical">

    <mx:Script>
        <![CDATA[
            import com.example.programmingas3.socket.Telnet;
            private var telnetClient:Telnet;
            private function connect():void {
                telnetClient = new Telnet(serverName.text, int(portNumber.text), output);
                console.title = "Connecting to " + serverName.text + ":" + portNumber.text;
                console.enabled = true;
            }
            private function sendCommand():void {
                var ba:ByteArray = new ByteArray();
                ba.writeMultiByte(command.text + "\n", "UTF-8");
                telnetClient.writeBytesToSocket(ba);
                command.text = "";
            }
        ]]>
    </mx:Script>

    <mx:Label id="title" text="Telnet Socket Example" fontSize="24" fontStyle="italic" />
    <mx:Label id="subtitle" text="From Programming ActionScript 3.0, Chapter 22: Networking and communication" fontSize="12" />

    <mx:ApplicationControlBar width="100%">
        <mx:Label text="Server:" />
        <mx:TextInput id="serverName" width="100%" />
        <mx:Spacer />
        <mx:Label text="Port:" />
        <mx:TextInput id="portNumber" text="23" textAlign="right" maxChars="5" restrict="0-9" />
        <mx:Spacer />
        <mx:Button label="Login" click="connect();" />
    </mx:ApplicationControlBar>

    <mx:Spacer />

    <mx:Panel id="console" enabled="false" width="100%" height="100%" paddingTop="10" paddingBottom="10" paddingLeft="10" paddingRight="10">
        <mx:TextArea id="output" editable="false" width="100%" height="100%" fontFamily="Courier New" />
        <mx:ControlBar>
            <mx:Label text="Command:" />
            <mx:TextInput id="command" width="100%" enter="sendCommand();" />
            <mx:Button label="Send" click="sendCommand();" />
        </mx:ControlBar>
    </mx:Panel>

</mx:Application> 
```

**com\example\programmingas3\socket\Telnet.as：**

```
package com.example.programmingas3.socket {
    import flash.events.*;
    import flash.net.Socket;
    import flash.system.Security;
    import flash.utils.ByteArray;
    import flash.utils.setTimeout;

    import mx.controls.TextArea;
    import mx.core.UIComponent;

    public class Telnet extends UIComponent{
        private const CR:int = 13; // Carriage Return (CR)
        private const WILL:int = 0xFB; // 251 - WILL (option code)
        private const WONT:int = 0xFC; // 252 - WON'T (option code)
        private const DO:int   = 0xFD; // 253 - DO (option code)
        private const DONT:int = 0xFE; // 254 - DON'T (option code)
        private const IAC:int  = 0xFF; // 255 - Interpret as Command (IAC)

        private var serverURL:String;
        private var portNumber:int;
        private var socket:Socket;
        private var ta:TextArea;
        private var state:int = 0;

        public function Telnet(server:String, port:int, output:TextArea) {
            // set class variables to the values passed to the constructor.
            serverURL = server;
            portNumber = port;
            ta = output;

            // Create a new Socket object and assign event listeners.
            socket = new Socket();
            socket.addEventListener(Event.CONNECT, connectHandler);
            socket.addEventListener(Event.CLOSE, closeHandler);
            socket.addEventListener(ErrorEvent.ERROR, errorHandler);
            socket.addEventListener(IOErrorEvent.IO_ERROR, ioErrorHandler);
            socket.addEventListener(ProgressEvent.SOCKET_DATA, dataHandler);

            // Load policy file from remote server.
            Security.loadPolicyFile("http://" + serverURL + "/crossdomain.xml");
            // Attempt to connect to remote socket server.
            try {
                msg("Trying to connect to " + serverURL + ":" + portNumber + "\n");
                socket.connect(serverURL, portNumber);
            } catch (error:Error) {
                /*
                    Unable to connect to remote server, display error 
                    message and close connection.
                */
                msg(error.message + "\n");
                socket.close();
            }
        }

        /**
         * This method is called if the socket encounters an ioError event.
         */
        public function ioErrorHandler(event:IOErrorEvent):void {
            msg("Unable to connect: socket error.\n");
        }

        /**
         * This method is called by our application and is used to send data
         * to the server.
         */
        public function writeBytesToSocket(ba:ByteArray):void {
            socket.writeBytes(ba);
            socket.flush();
        }

        private function connectHandler(event:Event):void {
            if (socket.connected) {
                msg("connected...\n");
            } else {
                msg("unable to connect\n");
            }
        }

        /**
         * This method is called when the socket connection is closed by 
         * the server.
         */
        private function closeHandler(event:Event):void {
            msg("closed...\n");
        }

        /**
         * This method is called if the socket throws an error.
         */
        private function errorHandler(event:ErrorEvent):void {
            msg(event.text + "\n");
        }

        /**
         * This method is called when the socket receives data from the server.
         */
        private function dataHandler(event:ProgressEvent):void {
            var n:int = socket.bytesAvailable;
            // Loop through each available byte returned from the socket connection.
            while (--n >= 0) {
                // Read next available byte.
                var b:int = socket.readUnsignedByte();
                switch (state) {
                    case 0:
                        // If the current byte is the "Interpret as Command" code, set the state to 1.
                        if (b == IAC) {
                            state = 1;
                        // Else, if the byte is not a carriage return, display the character using the msg() method.
                        } else if (b != CR) {
                            msg(String.fromCharCode(b));
                        }
                        break;
                    case 1:
                        // If the current byte is the "DO" code, set the state to 2.
                        if (b == DO) {
                            state = 2;
                        } else {
                            state = 0;
                        }
                        break;
                    // Blindly reject the option.
                    case 2:
                        /*
                            Write the "Interpret as Command" code, "WONT" code, 
                            and current byte to the socket and send the contents 
                            to the server by calling the flush() method.
                        */
                        socket.writeByte(IAC);
                        socket.writeByte(WONT);
                        socket.writeByte(b);
                        socket.flush();
                        state = 0;
                        break;
                }
            }
        }

        /**
         * Append message to the TextArea component on the display list.
         * After appending text, call the setScroll() method which controls
         * the scrolling of the TextArea.
         */
        private function msg(value:String):void {
            ta.text += value;
            ta.dispatchEvent(new Event(Event.CHANGE));
            setTimeout(setScroll, 100);
        }

        /**
         * Scroll the TextArea component to its maximum vertical scroll 
         * position so that the TextArea always shows the last line returned
         * from the server.
         */
        public function setScroll():void {
            ta.verticalScrollPosition = ta.maxVerticalScrollPosition;
        }
    }
} 
```

我用 mxmlc path\to\file\TelnetSocket.mxml 编译它并且编译得很好，但是当我测试它时，它只是说：“尝试连接到......”并留在那里。我尝试连接到公共 telnet BBS 服务器，例如“telnet://fix.no”，然后打开了 wireshark，当我单击 swf 上的“登录”按钮时，日志显示“正在尝试连接到...”并保持不动在那里，但在 Wireshark 上，我可以看到远程登录响应，如果从控制台远程登录，我会看到。

我测试了多台服务器，结果都一样。

**那么会发生什么导致它无法读取服务器的响应呢？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T06:56:40.863

该示例工作正常。它必须是客户端（您的计算机）或服务器（telnet 服务器）上的防火墙相关问题。

# android - 如何制作一个基本的 App Engine Connected Android 项目？

> ID：10730158
> 
> 赞同：3
> 
> 时间：2012-05-24T01:55:03.793
> 
> 标签：android, google-app-engine

我是新手，所以请多多包涵。我只是想让基本的 App Engine Connected Android 项目在 Eclipse 中工作。

我首先下载了 Eclipse 3.7 和 Android SDK。我通过eclipse安装了ADT插件。我将eclipse配置为指向sdk并创建了一个android项目。我添加了一些小部件，弄乱了 SMS 消息，然后在我的手机上运行它。像魅力一样工作。

然后我决定是时候使用应用引擎了。[我使用此链接http://dl.google.com/eclipse/plugin/3.7](http://dl.google.com/eclipse/plugin/3.7)从 eclipse 中下载了 eclipse 的 Google 插件。我还从该链接下载了 Google App Engine Java SDK。

好的，这就是它变得更有趣的地方。我创建了一个新的应用引擎连接的 android 项目并将其命名为“TestProjectThree”。然后我单击“调试为->本地应用程序引擎连接的android项目”。在控制台上我得到了一个网址，但在我的手机上我得到了一个黑屏。然后我注意到 android/gen 文件夹中没有任何内容，所以我对两个项目进行了干净的构建。突然，它给了我 10 个警告。

> “由于域类型 com.testprojectthree.server.HelloWorldService 不可用，因此无法完全验证上下文。
> 
> 您必须在服务器构建过程中运行 ValidationTool。”

我搜索了这个问题并找到了这个链接[http://code.google.com/p/google-web-toolkit/wiki/RequestFactoryInterfaceValidation](http://code.google.com/p/google-web-toolkit/wiki/RequestFactoryInterfaceValidation)。

我开始按照说明进行操作。我尝试启用注释处理，但它已经启用。我尝试将 requestfactory-apt.jar 添加到工厂路径，但它也已经在那里了。

显然现在我需要运行一个叫做注释处理器的东西。我以前从未使用过 Maven，但我右键单击我的 android 项目->配置->转换为 Maven 项目。我做了一个干净的构建，然后出现了一个 POM 文件。然后，我将该链接中的所有 XML 复制到 POM 文件中 /project 行正上方的行。我也复制第二位，因为我使用的是靛蓝。清理并重新构建。新错误。

> “/TestProjectThree-Android/gen 已存在但不是源文件夹。转换为源文件夹或重命名。”

也不知道那是什么意思，但我看到右键单击 gen->build path->convert to source 文件夹，所以我也单击它。清理并重新构建。没有错误！耶耶耶！！！

调试为本地应用引擎连接的 android 项目。手机出现黑屏，eclipse出现某种错误。“找不到来源”。寻找更详细的错误消息，但控制台上只有应用引擎 url，logcat 看起来是空的。

我回到有关验证工具的链接并阅读了所有评论。很多人似乎很困惑。我不知道我是否做对了，或者其中任何一个都做对了，现在我很迷茫。请请帮帮我！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T12:59:49.967

这听起来与我遇到的问题非常相似，尽管不完全一样。

我认为由 Android 项目使用的 AppEngine 项目生成的代码要么没有正确生成，要么需要刷新......而 clean 不会这样做。

试试这个：

首先，确保 requestfactory-apt.jar 在 Project Properties 的“Java Compiler”部分的“Annotation Processing”的“Factory Path”中。

在 AppEngine 项目中。属性-> Java 构建路径，源部分。选择“.apt_generated”条目，然后“编辑...”并重命名它，方法是在名称（或其他）末尾添加“1”。项目 -> 清理

然后在 Android Project Properties-> Java Build Path，Source 部分。选择链接到 AppEngine 项目中的“.apt_generated”源文件夹的“apt_generated”源文件夹。“编辑...”，然后在第一行“链接文件夹位置”中导航到 AppEngine 项目中新命名的文件夹（末尾带有“1”的文件夹……）然后项目 -> 清理

然后构建并运行你的 Android 项目，它现在应该有从 AppEngine 项目新生成的 RequestFactory 代码，并在运行时验证 OK。

可能还需要关闭和打开项目和清理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-24T18:42:07.273

使用解析。我尝试将 AppEnging 用于我的应用程序的后端，但 parse 似乎处理了很多后端工作并使生活变得非常轻松[https://parse.com](https://parse.com)

# php - PHP从构造函数获取返回值

> ID：10730160
> 
> 赞同：0
> 
> 时间：2012-05-24T01:55:16.200
> 
> 标签：php, class, constructor

我很困惑，我有一个带有构造函数的 PHP 类：

```
class Test {
   public function __construct() {
      return "some text";
   }
} 
```

然后我实例化一个对象：

```
$t = new Test(); 
```

我希望 $t 的内容是“一些文本”：

```
print_r($t); 
```

但它是：

```
Test Object
(
) 
```

如何`"some text"`从构造函数中获取返回值？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T01:58:37.393

你不能`return`从构造函数中得到任何东西。关键字总是会产生一个新`new`对象，不管你`return`从构造函数中得到什么。

# google-apps-script - 在 GoogleDocs 应用程序中，google 文件的文件大小始终为 0（零）（但 MS Word/Excel 等非本机文件的大小不为零

> ID：10730165
> 
> 赞同：1
> 
> 时间：2012-05-24T01:56:22.120
> 
> 标签：google-apps-script

var files = DocsList.getFolderById(release[index]).getFiles();

```
 for(i in files){
    /*** Title field ***/
     var title = "<a href=\""+files[i].getUrl()+"\">"+ files[i].getName() +"</a>";
    /*** Size field ***/
     var size = files[i].getSize();
    /*** Owner field ***/
     var owner = files[i].getOwner().toString().substring(0,files[i].getOwner().toString().indexOf('@')); 
```

对于 google 文件（文档、演示文稿、电子表格），getSize 始终返回零 (0)。但是从 Google Drive Resources 菜单中，我可以找到字数、字符数……对于非 Google 文件（即 Word 或 Excel），会出现大小。

这是方法语法（https://developers.google.com/apps-script/class_file#getSize）。大小是否需要某种子字符串或 tostring？我还需要添加什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T22:11:46.100

正如尼克约翰逊在评论中所说，这是按预期工作的。在 Google Drive UI 中，如果您按“使用配额”排序，您会看到 Google 文档和电子表格没有文件大小。

# sql - SQL Server 连接不相关的表

> ID：10730177
> 
> 赞同：2
> 
> 时间：2012-05-24T01:57:45.547
> 
> 标签：sql, sql-server, tsql, sql-server-2005

我有两个不相关的表：

人表：

```
 ID | NAME | AGE
    ------------
   1  | DAVE | 43
   1  | ANNE | 25
   1  | MIKE | 58 
```

地方表：

```
ID | COUNTRY | TOWN
------------------
1  |   USA    | WILMINGTON
1  |   GER    | BERLIN
1  |   POR    | LISBON
1  |   JPN    | KYOTO 
```

我想要这样的结果：

```
NAME | AGE | COUNTRY | TOWN
-----------------------------
ANNE |  25 | GER     | BERLIN
DAVE |  43 | JPN     | KYOTO
MIKE |  58 | POR     | LISBON
           | USA     | WILMINGTON 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T02:23:40.720

让我试一试：

```
SELECT COALESCE(a.Name, '') Name,
       COALESCE(a.Age, '') Age,
       b.Country,
       b.Town
FROM
    (SELECT ROW_NUMBER() OVER (ORDER BY [Name]) AS RowNum, Name, Age
     FROM   People) a Right Join 
    (SELECT ROW_NUMBER() OVER (ORDER BY [Country]) AS RowNum, Country, Town
     FROM   Places) b ON a.RowNum = b.RowNum 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T02:19:20.993

我完全不推荐这个！！！但我发现这是一个很好的挑战。我强烈建议您按照 Sean 的建议使用钥匙。

无论如何，此查询将在不更改架构的情况下准确地为您提供您所要求的内容（它还假设您的数据被准确表示）。

示例：[http ://www.sqlfiddle.com/#!3/a0486/8](http://www.sqlfiddle.com/#!3/a0486/8)

```
Select Distinct
  case when town = 'Wilmington' Then NULL else Name end as Name, 
  case when town = 'Wilmington' Then NULL else Age end as Age,
  Country, 
  Town
FROM People, Places
Where 
     (Name = 'Anne' AND Town = 'Berlin')
  OR (Name = 'Dave' AND Town = 'Kyoto')
  OR (Name = 'Mike' AND Town = 'Lisbon')
  OR (Town = 'Wilmington')
Order By Country Asc 
```

**编辑**

为了完成我的回答并提供更合适的解决方案，我建议您将 PlaceID 添加到两个表中，然后在其上添加左连接。

示例：[http ://www.sqlfiddle.com/#!3/d5ee8/3](http://www.sqlfiddle.com/#!3/d5ee8/3)

```
Create Table People(
  Name varchar(255),
  Age int,
  PlaceID int
)

Create Table Places(
  PlaceID int,
  Country varchar(255),
  Town varchar(255)
)

Insert Into People Values ('Dave', 43, 2)
Insert Into People Values ('Anne', 25, 1)
Insert Into People Values ('Mike', 58, 3)

Insert Into Places Values (1, 'Ger', 'Berlin')
Insert Into Places Values (2, 'Jpn', 'Kyoto')
Insert Into Places Values (3, 'Por', 'Lisbon')
Insert Into Places Values (4, 'USA', 'Wilmington')

Select 
  Name, Age, Country, Town 
FROM 
  Places
  Left Join People On Places.PlaceID = People.PlaceID 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T02:20:59.440

我猜你希望这些按字母顺序加入，但这并没有多大意义......

```
WITH x AS (SELECT *, rn = ROW_NUMBER() OVER (ORDER BY NAME) FROM People),
     y AS (SELECT *, rn = ROW_NUMBER() OVER (ORDER BY COUNTRY) FROM Places)
SELECT * FROM x FULL OUTER JOIN y ON x.rn = y.rn; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-24T02:08:58.487

您需要在每个表中至少有一条数据来连接。通常这是通过主键/外键关系处理的。您可以在 PLACES 表中创建一个主键（例如 1=USA、2=GER、3=POR、4=JPN），然后将外键放置在 PEOPLE 表的列中，以匹配每个人的适当位置（例如，2=ANNE，4=DAVE，3=MIKE）。

# c# - WebClient().DownloadString() 在 C# 中挂起

> ID：10730184
> 
> 赞同：-1
> 
> 时间：2012-05-24T01:59:03.737
> 
> 标签：c#, mono, osx-lion

我是一名 PHP 开发人员，正在尝试自学 C#。我有以下测试代码：

```
//longbow.cs

using System;
using System.Net;

public class LongbowCore {
    //version of the software
    public static string version = "0.1";

    //Text displayed during startup
    public static string init_text = "Longbow v"+LongbowCore.version;

    //API URL base for sessions
    public static string api_url = "http://dev.phyre.im";

    public static void Main(string[] args){

        Console.WriteLine(LongbowCore.init_text);
        var fetch = new WebClient();
        var data = fetch.DownloadString(api_url);
        Console.WriteLine(api_url + " Data: " + data);
    }

} 
```

运行时，之后的任何内容都`fetch.DownloadString(api_url)`无法显示。我不相信它在做任何事情。注释掉该行（并从 Console.WriteLine 中删除该字符串）允许它继续。我究竟做错了什么？

如果它是相关的，我正在 OSX Lion 上用 Mono 编译。

* * *

道歉！所以，很抱歉——显然我的 VPS 主机出现了网络中断——我的一半机器都停机了，包括我的 DNS。我没有意识到。投票结束我的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T02:06:12.763

没有错……只是那个网站 dev.phyre.im 花了很长时间。继续等待，你会得到一个超时异常

# perl - 将角色组合到 Moose 类中不起作用

> ID：10730190
> 
> 赞同：5
> 
> 时间：2012-05-24T02:00:11.600
> 
> 标签：perl, oop, moose

啊哈！

我有一个角色，我正忙于在名为 Authable 的 Moose 类中定义该角色，该类本质上组合成任何将来可能需要某种形式的身份验证的类；这是一个相当简单的角色，这是全部内容：

```
package Trello::API::Roles::Authable;

use Moose::Role;

#authentication information
has key => (
    is => "rw",
    isa => "Str",
);

has token => (
    is => "rw",
    isa => "Str",
);

1; 
```

无论出于何种原因，当我尝试使用多个不同的语句将其组合成一个类时，即使用 "Trello::API::Roles::Authable"; 或使用“Roles::Authable”；

我一直收到同样的错误信息：`You can only consume roles, Roles::Authable is not a Moose role.`

知道为什么会发生这种情况吗？

编辑！

顺便说一句，我检查了 Moose::Role 的实际来源，并看到了这一点：

```
 unless ($meta && $meta->isa('Moose::Meta::Role') ) {
        require Moose;
        Moose->throw_error( "You can only consume roles, "
                . $role->[0]
                . " is not a Moose role" );
    } 
```

这似乎是发生错误的地方，所以似乎出于某种原因，我正在实施的角色并没有说明它是元类中的角色。虽然我可能弄错了！任何帮助，将不胜感激。

另一个方便的编辑！

奖励：调用 with 例程的代码上下文。

```
package Trello::API::Resource;

use Moose;
use URI::Escape;
use LWP::UserAgent;

with 'Roles::Authable'; 
```

当我这样做时，它智能地知道尝试使用 Roles/Authable.pm 但无论出于何种原因，它都无法运行！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T18:03:59.647

首先，我必须同意 Piers 的观​​点，从技术上讲，您确实应该将其称为`with 'Trello::API::Roles::Authable'`.

所以，你要求的是一些我没有发现在基本 Moose 中实现的东西。我之前使用过通用命名空间池的想法。它们是一种通用名称空间，您可以向其提供半匿名服务——无需锁定固定名称空间。我在 Moose（真的*`MOP`*）支持下完善了命名空间池的基本概念。

在 Perl 的狂野西部时代，您所要做的就是将一个 stash 分配给另一个符号，如下所示：

```
{   no strict 'refs'; 
    *{$short_pkg_name.'::'} = \*{$full_pkg_name.'::'};
}; 
```

而且，这两个包是一模一样的东西！

但是现在，我们更多地使用词汇来保护我们的数据。而且因为 Class::MOP 小心翼翼地在词汇散列中保护它的元对象，所以你必须添加其他东西：

```
Class::MOP::store_metaclass_by_name( 
       $short_pkg_name
     , Class::MOP::get_metaclass_by_name( $full_pkg_name )
     ); 
```

现在它们对于 Perl 和 MOP 来说是完全一样的。

因此，您可以创建只是其他包的命名空间存储库的包——*现在有了`MOP`支持！*

```
package Namespace::Pool;
use strict;
use warnings;
use Params::Util qw<_POSINT>;

sub import { 
    shift; # It's just me.
    my $full_pkg_name = caller();
    Carp::croak( "'$full_pkg_name' is short enough!" ) 
        unless my $pool_name 
            = shift // [ split /::/, $full_pkg_name ]->[-2]
            ;
    Carp::croak( "'::$pool_name\::' not found in '$full_pkg_name'" ) 
        unless (  _POSINT( my $pos = rindex( $full_pkg_name, "::$pool_name\::" ))
               or my $is_short = _POSINT( index( $pool_name, '::' ))
               ); 
    my $short_pkg_name 
        = $is_short ? $poll_name 
        :             substr( $full_pkg_name, $pos + 2 )
        ;
    {   no strict 'refs'; 
        if ( %{$short_pkg_name.'::'} ) { 
            Carp::croak( "You have already defined $short_pkg_name!" );
        }
        *{$short_pkg_name.'::'} = \*{$full_pkg_name.'::'};
    };

    if ( my $meta = Class::MOP::get_metaclass_by_name( $full_pkg_name )) { 
        Class::MOP::store_metaclass_by_name( $short_pkg_name, $meta );
    }
    return;
} 
```

因此，在您的角色包中，您可以执行以下操作：

```
package Trello::API::Roles::Authable;
use strict;
use warnings;
use Moose::Role;
use Namespace::Pool 'Roles';
... 
```

并且知道它将在“角色”的命名空间中可用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-23T05:49:19.203

就我而言，我只是不小心将我的角色命名为“Test”，但我的系统上已经安装了一个名为“Test”的模块，因此 Moose 认为我想使用该模块而不是我创建的新 Moose 角色。一旦我按角色重命名为“可测试”，一切正常。

# backbone.js - Backbone.js - 后退按钮后持久化数据

> ID：10730198
> 
> 赞同：2
> 
> 时间：2012-05-24T02:00:46.667
> 
> 标签：backbone.js

我正在学习backbone.js 为现有的网络应用程序添加一些交互性。在初始页面加载时，我使用[文档中建议](http://documentcloud.github.com/backbone/#FAQ-bootstrap)`reset()`的方法将一些初始数据引导到页面中。这很好用。我还可以创建新的模型实例，视图会按照我的预期处理它们；它们与初始数据一起出现，一切都很好。（新数据也可以很好地访问数据库。）

但是，如果我点击一个指向不同页面的链接（不使用主干路由或其他任何东西，只是一个普通链接）然后点击浏览器的后退按钮，我之前创建的新模型就消失了；只显示旧的初始数据。我做了一些调试，发现`reset()`每次加载页面时都会运行该方法，所以大概这就是我添加的额外数据的原因。（但是，如果我真的*刷新*页面，新数据将再次显示，因为现在它也被引导了。）

我知道我可以`fetch()`用来获取新添加的数据（以及旧数据），但我试图避免这种情况，因为（a）这是每次加载页面时的额外请求，以及（b）因为文档说这并不理想。

那么，我应该怎么做才能使用后退按钮不会使东西（暂时）消失？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T05:45:26.623

页面加载模型、视图、集合和路由器。页面集通过`reset`（引导）建立集合。用户单击链接导航到另一个页面，单击后退按钮。现在发生了一件有趣的事，

*   路由器在页面加载之前匹配 url（单击后退按钮时）。在此匹配期间，您必须验证集合是否包含新数据，然后执行`collection.fetch()`。
*   这将使您始终获得最新信息并且只访问服务器一次（您的集合为空或不包含新数据）

# linux - Linux 昨天修改的文件夹的所有文件

> ID：10730199
> 
> 赞同：21
> 
> 时间：2012-05-24T02:00:59.153
> 
> 标签：linux, command, last-modified

我已经修改了我的 webroot 中各种文件夹中的一些文件。这是开发环境。现在我必须找到昨天修改的所有文件才能迁移到产品中。

有什么方法（Linux 命令）只列出我的 webroot 树中昨天修改的那些文件吗？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-05-24T02:14:53.713

`find ./ -mtime -1`

查找所有内容，即最近 24 小时在当前目录中修改的内容。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2016-06-21T22:38:53.457

```
find . -daystart -mtime 1 -print 
```

这仅获取昨天修改的文件 - 即：今天是 6 月 21 日，仅找到 6 月 20 日的文件。

（-mtime 采用“-”、“+”或明确的确切天数）。

如果您想要长列表，请替换

```
-exec ls -ld \; 
```

为了

```
-print. 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-05-24T02:02:21.617

```
find . -mtime +2 -prune -o -mtime +1 -print 
```

这会查找但排除超过两天前修改的任何内容，然后查找超过一天前修改的任何内容。

# javascript - 在 JQuery 中调用 JS 函数（并传递参数）异步

> ID：10730206
> 
> 赞同：0
> 
> 时间：2012-05-24T02:02:28.307
> 
> 标签：javascript, jquery

我有以下代码，我在其中获取 xml 文件，并将其转换为 JSON：

```
showLoading();
$.get(data_file_path, {}, function(content, textStatus, jqXHR){
        data_object = jqXHR;
        jsonObject = xml2json.parser(data_object.responseText);         
        hideLoading();
    }); 
```

其中 data_file_path 是一个 .xml 文件。使用此当前代码，加载 .gif 不会旋转，因为 xml2json.parser() 调用没有异步执行。这只是一个 JavaScript 函数。不多也不少。我怎样才能使这个调用也异步，以便加载 .gif 保持旋转，然后在解析 jsonObject 时正常隐藏？！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T02:05:02.033

AJAX 首先是异步的唯一原因是因为您不必在从服务器获取数据时不断运行代码，脚本可以只说“好的，完成后，执行此操作”。

但是，`xml2json.parser`是一个JS脚本。它一直在运行代码，直到它完成，所以它不能重绘。

解决此问题的唯一方法是手动编写您自己的版本，以便在计时器上逐个加载。

# c# - 访问 Windows Phone 必应搜索的确切 URL？

> ID：10730210
> 
> 赞同：1
> 
> 时间：2012-05-24T02:03:14.280
> 
> 标签：c#, silverlight, windows-phone-7

我想通过创建一个 WebBroswerTask 来访问 Bing 搜索，然后输入一个 URL，该 URL 将重定向到手机上可用的 Bing 服务。

我注意到，如果您没有留下 URL 并输入一个常用短语，您将被重定向到 WP7 上 IE 中的 Bing 服务。

现在我想在我的应用程序上执行此操作。访问此功能的 URL 是什么。

如果没有，还有其他选择吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T02:05:59.130

看来您实际上是要使用`SearchTask`. [如何搜索和浏览网页](http://www.windowsphonegeek.com/articles/4-how-to-search-and-browse-the-web-in-a-wp7-app)

# javascript - 在 Chrome 上使用 display:none 重置 GIF 动画的正确方法

> ID：10730212
> 
> 赞同：23
> 
> 时间：2012-05-24T02:04:11.017
> 
> 标签：javascript, jquery, html, google-chrome, animated-gif

标题是不言自明的，但我将提供有关此事的逐步视图。希望我不是第一个在 Webkit/Chrome 上注意到这个（显然）错误的人。

我想重置 GIF 动画。到目前为止，我看到的所有示例要么简单地将`src`图像的 设置为自身，要么将其设置为空字符串，然后`src`再次设置原始字符串。

看看这个**[JSFiddle](http://jsfiddle.net/ult_combo/Fuy9w/3/)**以供参考。GIF 在 IE、Firefox 和 Chrome 上重置得非常好。

我遇到的问题是图像仅`display:none`在**Google Chrome**上。

检查这个**[JSFiddle](http://jsfiddle.net/ult_combo/F8Q44/3/)**。GIF 在显示在页面中之前在 IE 和 Firefox 上可以很好地重置，但 Chrome 只是拒绝重置其动画！

**到目前为止我已经尝试过：**

*   像在 Fiddle 中一样设置`src`自身，在 Chrome 中不起作用。
*   将 设置`src`为空字符串并将其恢复为默认值也不起作用。
*   在图像周围放置一个包装器，清空容器`.html('')`并将图像放回其中，也不起作用。
*   通过或在设置之前更改`display`图像的也不起作用。`.show()``.fadeIn()``src`

到目前为止，我发现的**唯一**解决方法是将图像保持为默认值，并在需要模拟行为时`display`通过`.animate()`ing 和ing 不透明度、高度和可见性对其进行操作。`.css()``display:none`

这个问题的主要原因（上下文）是我想在页面中淡入之前重置一个 ajax 加载器 GIF。

所以我的问题是，是否有正确的方法来重置 GIF 图像的动画（避免 Chrome 的`display:none`“错误”）或者它实际上是一个错误？

（ps。您可以更改小提琴中的 GIF 以获得更合适/更长的动画 gif 以进行测试）

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-05-24T02:08:26.727

“重置” GIF 最可靠的方法是附加一个随机查询字符串。但是，这确实意味着每次都会重新下载 GIF，因此请确保它是一个小文件。

```
// reset a gif:
img.src = img.src.replace(/\?.*$/,"")+"?x="+Math.random(); 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2014-01-14T02:13:07.167

Chrome 处理样式更改的方式与其他浏览器不同。

在 Chrome 中，当您`.show()`不带参数调用时，该元素实际上不会立即显示在您调用它的位置。相反，Chrome在评估当前的 JavaScript 块*后*，将新样式的应用程序*排队等待执行；*而其他浏览器会立即应用新的样式更改。但是，不会排队。因此，您实际上是在尝试根据 Chrome 设置元素仍然不可见的时间，而当原始元素和新元素相同时，Chrome 不会对其执行任何操作。*`.attr()``src``src``src`*

 *相反，您需要做的是确保 jQuery 设置`src` *after* `display:block`被应用。你可以利用`setTimeout`来实现这个效果：

```
var src = 'http://i.imgur.com/JfkmXjG.gif';
$(document).ready(function(){
    var $img = $('img');
    $('#target').toggle(
        function(){
            var timeout = 0; // no delay
            $img.show();
            setTimeout(function() {
                $img.attr('src', src);
            }, timeout);
        },
        function(){
            $img.hide();
        }
    );
}); 
```

这确保了在应用于元素*之后*`src`设置。 *`display:block`*

 *这样做的原因是因为 setTimeout 将函数排队等待*稍后*执行（不管多久*之后*），所以该函数不再被认为是 JavaScript 当前“块”的一部分，它为 Chrome 呈现和应用提供了一个间隙第`display:block`一个，从而使元素在其`src`属性设置之前可见。

演示：http: [//jsfiddle.net/F8Q44/19/](http://jsfiddle.net/F8Q44/19/)

感谢 freenode IRC 的 #jquery 中的 shoky 提供了一个更简单的答案。

* * *

或者，您可以强制重绘以刷新批量样式更改。例如，这可以通过访问元素的`offsetHeight`属性来完成：

```
$('img').show().each(function() {
    this.offsetHeight;
}).prop('src', 'image src'); 
```

演示：http: [//jsfiddle.net/F8Q44/266/](http://jsfiddle.net/F8Q44/266/)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-02-24T15:21:20.873

只是因为我仍然时不时需要这个，所以我认为我使用的纯 JS 函数可能对其他人有帮助。这是一种重新启动动画 gif 的纯 JS 方式，无需重新加载。您可以从链接和/或文档加载事件中调用它。

```
<img id="img3" src="../_Images/animated.gif">

<a onClick="resetGif('img3')">reset gif3</a>

<script type="text/javascript">

// reset an animated gif to start at first image without reloading it from server.
// Note: if you have the same image on the page more than ones, they all reset.
function resetGif(id) {
    var img = document.getElementById(id);
    var imageUrl = img.src;
    img.src = "";
    img.src = imageUrl;
};

</script> 
```

在某些浏览器上，您只需要将 img.src 重置为自身，它就可以正常工作。在 IE 上，您需要在重置之前清除它。这个 resetGif() 从图像 id 中选择图像名称。如果您曾经更改给定 id 的实际图像链接，这很方便，因为您不必记住更改 resetGiF() 调用。

——尼科

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-11-19T12:27:06.987

此[解决方案](https://stackoverflow.com/questions/3191922/restart-an-animated-gif-from-javascript-without-reloading-the-image)预加载 gif 并将其从 dom 中取出，然后返回 src（从而避免再次下载）

我刚刚使用 jquery 对其进行了测试以删除该属性，并且效果很好。

例子：

```
<html>
<head>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js" type="text/javascript"></script>

<script>

$(function() {

    $('.reset').click(resetGif);

    function resetGif() 
    {
        $('.img1').removeAttr('src', '');
    }
});

</script>

</head>

<body>
    <img class="img1" src="1.gif" />
    <a href="#" class="reset">reset gif</a>
</body>
</html> 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-04-14T15:02:50.830

这似乎在 Chrome 中对我有用，它每次在我淡入图像并清除然后重新填充 src 之前运行，我的动画现在每次都从头开始。

```
var imgsrc = $('#my_image').attr('src');
$('#my_image').attr('src', '');
$('#my_image').attr('src', imgsrc); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-01-25T15:26:36.843

这是我对背景图像的破解：

```
$(document).on('mouseenter', '.logo', function() {
  window.logo = (window.logocount || 0) + 1;
  var img = new Image();
  var url = "/img/mylogimagename.gif?v=" + window.logocount;
var that = this;
  $(img).load(function(){

     $(that ).css('background-image','url(' + url + ')');
  });
  img.src = url;
}); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-08-30T17:23:36.913

我有一个带有动画无循环图像的按钮。我只是用一些 jquery 重新加载图像，这似乎对我有用。

```
var asdf = $(".settings-button img").attr("src");
$(".settings-button img").attr("src", "").attr("src", asdf); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-06-13T08:42:46.693

我在上述所有解决方案中都遇到了问题。最终起作用的是用透明的 1px gif 临时替换 src：

```
var transparent1PxGif = 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7';
var reloadGif = function(img) {
    var src = img.src;
    img.src = transparent1PxGif;
    img.offsetHeight; // triggers browser redraw
    img.src = src;
}; 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-10-30T03:16:58.910

在搜索了许多其他线程后，我遇到了这个线程。David Bell 的帖子让我找到了我需要的解决方案。

我想我会发布我的经验，以防它对任何试图完成我所追求的事情的人有用。这是一个 HTML5/JavaScript/jQuery Web 应用程序，它将通过 PhoneGap 成为 iPhone 应用程序。在 Chrome 中测试。

**目标：**

1.  当用户点击/单击按钮 A 时，会出现并播放一个动画 gif。
2.  当用户点击/单击按钮 B 时，gif 消失。
3.  当用户再次点击/单击按钮 A 时，在点击/单击按钮 B 后，动画 gif 应该重新出现并从头开始播放。

**问题：**

*   在点击/单击按钮 A 时，我将 gif 附加到现有 div。它会玩得很好。
*   然后，在点击/单击按钮 B 时，我隐藏了容器 div，然后将 gif 的 img src 设置为空字符串 ('')。同样，没问题（也就是说，问题还不明显。）
*   **然后，在点击/单击按钮 A 时，在点击/单击按钮 B 后，我将 gif 的路径重新添加为 src。**

    *-**这不起作用。**gif 将显示在按钮 A 的后续点击/点击中......但是，我点击/点击按钮 A 的次数越多，gif 加载和重新开始的次数就越多。也就是说，如果我来回点击/单击按钮 A 然后按钮 B 3 次，gif 会出现，然后启动/停止/启动 3 次......我的整个应用程序开始突突。我猜 gif 被多次加载，即使我在点击/单击按钮 B 时将 src 设置为空字符串。*

**解决方案：**

看了大卫贝尔的帖子后，我得到了答案。

1.  我定义了一个全局变量（我们称之为 myVar），其中包含容器 div 和图像（带有源路径）。
2.  在按钮 A 的点击/单击功能上，我将该容器 div 附加到 dom 中现有的父 div。
3.  在那个函数中，我创建了一个新变量来保存 gif 的 src 路径。

就像大卫建议的那样，我这样做了（加上一个附加）：

```
$('#mainParent').append(myVar);
var imgsrc = $('#my_image').attr('src');
$('#my_image').attr('src', '');
$('#my_image').attr('src', imgsrc); 
```

然后，在按钮 B 的函数中，我将 src 设置为空字符串，然后删除包含 gif 的 div：

```
$('#my_image').attr('src', '');
$('#mainParent').find('#my_image').remove(); 
```

现在，我可以整天点击/单击按钮 A，然后是按钮 B，然后是按钮 A，等等。gif 在点击/单击按钮 A 时加载和播放，然后在点击/单击按钮 B 时隐藏，然后在每次点击按钮 A 时从头开始加载和播放，没有任何问题。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-06-27T22:02:28.053

我为这个问题制定了一个完整的解决方案。可以在这里找到：[https ://stackoverflow.com/a/31093916/1520422](https://stackoverflow.com/a/31093916/1520422)

我的解决方案在不从网络重新加载图像数据的情况下重新启动动画。

它还强制图像重新绘制以修复发生的一些绘画伪影（在 chrome 中）。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-07-05T15:15:15.977

已经好几年了，我决定重新审视这一点，因为我们有许多新的选择可供我们使用。

[我之前回答](https://stackoverflow.com/a/10730240/507674)的问题是，每次您想重新启动它时，它都会强制重新下载 GIF。虽然这对于小文件来说很好，但如果可能的话，它仍然是最好避免的开销。

考虑到这一点，我有了一个新的解决方案，它使用 AJAX 下载 GIF 一次，然后将其转换为数据 URL（通过 FileReader）并将其用作附加随机查询字符串的源。

这样，浏览器只下载一次图像，甚至可以正确缓存它，并且“重置”从该预下载资源中提取。

当然，唯一的问题是您必须确保它已正确加载，然后才能使用它。

演示：[http ://adamhaskell.net/misc/numbers/numbers.html](http://adamhaskell.net/misc/numbers/numbers.html)

相关代码：

```
var url = "something.gif"; // fallback until the FileReader is done
function setup() {
    var xhr = new XMLHttpRequest();
    xhr.open("GET",url,true);
    xhr.responseType = "blob";
    xhr.onreadystatechange = function() {
        if( this.readyState == 4) {
            var fr = new FileReader();
            fr.onload = function() {
                url = this.result; // overwrite URL with the data one
            };
            fr.readAsDataURL(this.response);
        }
    };
    xhr.send();
}
function getGIF() {
    return url+"?x="+Math.random();
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-08-26T07:30:25.423

# 重置 gif 动画

当浏览器渲染时，属性中`img`指定的源被缓存到内存中以供将来重用。`src`这可以提高页面加载/重新加载的速度，并减少网络上的负载。这种行为几乎适合所有人，因为实际上，这是最理想和最需要的选择。

但是，与往常一样，也有例外。我想出了一个基于 dataUrl 的动画更新选项，它解决了几个问题。

## 解决的问题：

1.  需要显示带有动画的**gif图像，没有循环 (** *loop = 1* )，可能具有相同的`src`. 但是当出现这样一张图片时，它必须播放动画而不改变其他相同图片的动画`src`。同一张图片应该只从服务器加载一次。[堆栈溢出](https://stackoverflow.com/questions/68917982/how-can-you-instantiate-a-gif-file-in-a-react-app/68918284)

2.  重置 gif 动画。

3.  悬停时开始动画

## 重置 src 属性

如果我们使用清除`src`图像属性的解决方案，那么所有具有相同来源的图像都会重播它们的动画。不幸的是，我仍然不完全理解为什么会发生这种情况，但它会干扰正确的工作。

### 缺点

*   重置具有相同 src 的所有图像的动画。
*   [移动设备](https://stackoverflow.com/questions/19831319/restart-a-gif-animation-without-reloading-the-file#comment118113914_24810221)存在问题

### 优点

*   简单快捷

## 使用随机查询修改 url

该解决方案包括在`src`属性末尾添加一个随机查询参数，以便所有图像都有不同的来源，因此它们将相互独立地进行动画处理。有一个很大的**NO**：这将导致向服务器不断请求下载图片，因此它们将不再被缓存。而如果我们需要展示 100 张相同的图片，那么就会有 100 个请求向服务器发送。粗糙而艰难，但它总是有效的。

### 缺点

*   每张具有唯一查询的图片都将从服务器重新加载。

### 优点

*   简单快捷

## 修改dataUrl（建议解决方案）

> 数据 URL，以 data: 为前缀的 URL 方案，允许内容创建者在文档中嵌入小文件。在 WHATWG 停用该名称之前，它们以前被称为“数据 URI”。 [MDN](https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/Data_URIs)

本文档中的 dataUrl 结构：

```
data:[<mediatype>][;base64],<data> 
```

这就是[规范](https://datatracker.ietf.org/doc/html/rfc2397)中的指示：

```
dataurl    := "data:" [ mediatype ] [ ";base64" ] "," data
mediatype  := [ type "/" subtype ] *( ";" parameter )
data       := *urlchar
parameter  := attribute "=" value 
```

如果您仔细查看 的描述`mediatype`，就会发现那里有些奇怪 `parameter`。但是，还有一个[规范](https://datatracker.ietf.org/doc/html/rfc2045#section-5.1)：

```
 attribute := token
                  ; Matching of attributes
                  ; is ALWAYS case-insensitive.

     value := token / quoted-string

     token := 1*<any (US-ASCII) CHAR except SPACE, CTLs, or tspecials>

     tspecials :=  "(" / ")" / "<" / ">" / "@" /
                   "," / ";" / ":" / "\" / <">
                   "/" / "[" / "]" / "?" / "="
                   ; Must be in quoted-string,
                   ; to use within parameter values 
```

可以看出，我们可以指定任何参数，主要是它满足上面提出的要求！因此，我们可以在 mediatype 中嵌入一个额外的属性，它不会对图片产生任何影响，但数据 url 会与同一张图片不同。

### 广义算法：

1.  我们通过常规请求加载图像，并从 blob 创建的 dataUrl 中删除元数据。

```
fetch("https://cdn140.picsart.com/330970106009201.gif").then(async (res) => {
  const blob = await res.blob();
  const reader = new FileReader();
  reader.onload = (ev) => {
    // It would be reasonable to remove metadata to the point!
    // But for simplicity, I'm using this implementation.
    const dataUrl = ev.currentTarget.result.replace(
      "data:image/gif;base64",
      ""
    );
  };
  reader.readAsDataURL(blob);
}); 
```

2.  使用属性创建/编辑`img`元素`src``"src=data:image/gif;base64;${Math.random()}${dataUrl}"`

3.  就这些！

### 示例 Vanila JS

```
const url = "https://cdn140.picsart.com/330970106009201.gif";

function loadImage(src) {
  fetch(src)
    .then((res) => res.blob())
    .then(async(blob) => {
      const reader = new FileReader();
      reader.onload = (ev) => {
        const dataUrl = ev.currentTarget.result.replace("data:image/gif;base64", "")
        const container = document.getElementById("container");
        while (container.firstChild) {
          container.firstChild.remove()
        }
        for (let i = 0; i < 6; i++) {
          const img = document.createElement("img");
          img.setAttribute("src", `data:image/gif;base64;gif-id=${Date.now()}${dataUrl}`)
          container.appendChild(img);
          img.addEventListener('click', ev => {
            img.setAttribute("src", `data:image/gif;base64;gif-id=${Date.now()}${dataUrl}`)
          })
        }
      };
      reader.readAsDataURL(blob);
    });
}

loadImage(url);

function updateImage() {
  const newSrc = document.getElementById("image-src");
  loadImage(document.getElementById("image-src").value);
}
```

```
#main {
  display: flex;
  flex-direction: column;
  gap: 5px;
}

img {
  width: 128px;
  height: 128px;
  padding: 5px;
}
```

```
<div id="main">
  <label>Change gif url if current will become unavailable </label>
  <input id="image-src" value="https://cdn140.picsart.com/330970106009201.gif"></input>
  <button onclick="updateImage()">Update image source attribute</button>
  <span>Click to reset!</span>
  <div id="container">
  </div>
</div>
```

### 示例反应

```
import React, { useState, useRef } from "react";

function App() {
  const [stars, setStars] = useState(0);
  const [data, setData] = useState(null);

  const ref = useRef(null);

  React.useEffect(() => {
    fetch("https://cdn140.picsart.com/330970106009201.gif")
      .then((res) => res.blob())
      .then(async (text) => {
        const reader = new FileReader();
        reader.onload = (ev) => {
          setData(ev.currentTarget.result.replace("data:image/gif;base64", ""));
        };
        reader.readAsDataURL(text);
      });
  }, []);

  return (
    <React.Fragment>
      <p onClick={() => setStars((s) => s + 1)}>+</p>
      {data &&
        new Array(stars).fill().map((s, ind) => {
          return <Star src={data} key={ind}></Star>;
        })}
      <p onClick={() => setStars((s) => (s === 0 ? 0 : s - 1))}>-</p>
    </React.Fragment>
  );
}

export function Star(props) {
  const [id] = useState(Math.random());

  return (
    <img
      className="icon"
      src={`data:image/gif;base64;gif-id=${id}` + props.src}
      alt="animated star"
    />
  );
}

export default App; 
```**

# operating-system - 操作系统如何与声卡/视频卡等外围设备交互

> ID：10730213
> 
> 赞同：4
> 
> 时间：2012-05-24T02:04:42.877
> 
> 标签：operating-system, hardware, processor, instruction-set, bus

据我了解，任何程序都会被编译成一系列针对其运行架构的汇编指令。我不明白的是操作系统如何与显卡等外围设备交互。驱动程序本身不就是CPU的一系列汇编指令吗？

我能想到的唯一一件事是它使用内存区域，然后由外围设备监视，或者它使用 BUS 来通信操作并接收结果。这个过程有没有简单的解释。

抱歉，如果这个问题太笼统，这一直困扰着我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T02:14:17.597

有简单的解释，也有真实的解释 - 选择一个！

我会尝试一个简单的：根据汇编指令，有一些专门用于与外围设备通信。硬件不是通过例如在寄存器中添加值或将某些内容写入 RAM 来解释它们，而是通过将一些数据从寄存器或 RAM 中的区域移动到外围设备（或相反）。

在操作系统内部，例如声音驱动程序负责将一些声音数据和一些命令数据组装到RAM中，然后操作系统调用总线驱动程序发出这些特殊指令以将命令和数据移动到声卡。声卡硬件将（希望）理解命令并将数据解释为它应该播放的声音。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-24T02:14:38.877

你的猜测基本上是对的。根据 CPU 架构，外设可能会响应“内存映射 I/O”（它们监视对特定内存地址的读取和写入）或其他特定 I/O 指令（例如 x86 IN 和 OUT 指令） .

设备驱动程序是特定于操作系统的软件，并提供操作系统和硬件之间的接口。

特定的物理设备要么拥有知道如何响应来自它所监视的 CPU 的任何信号的硬件，要么拥有自己的 CPU 和通常称为*固件*的软件。设备的固件不特定于任何操作系统，并且通常存储在设备上的持久内存中，即使在设备关闭后也是如此。但是，某些外围设备可能具有在操作系统启动时*由设备驱动程序*加载的固件。

# perl - Perl 服务器端跨域检测

> ID：10730215
> 
> 赞同：4
> 
> 时间：2012-05-24T02:05:13.180
> 
> 标签：perl, apache, cross-domain, mod-perl

我正在编写一个 perl 服务器脚本。在我的脚本中，我想检测请求是否来自我网站域之外的网页。例如，如果有人在博客或谷歌上单击指向我的脚本的链接，我想检测并处理它，而不是有人从我自己的网页向我的脚本发出请求。我可以访问一个 mod perl apache 对象，但是通读[文档](http://search.cpan.org/~gozer/mod_perl-1.31/Apache/Apache.pm)我不确定它是否有能力做我需要的事情。谁能告诉我如何检测到这个？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-24T02:07:52.390

在服务器端，您可以做到这一点的唯一方法是使用[HTTP Referer 标头](https://en.wikipedia.org/wiki/HTTP_referer)。浏览器通常配置为发送此标头并且不对引用者撒谎，但您应该知道，任何想要这样做的人都可以轻易地欺骗引用者。

# jquery - 使用 jQuery，使用 $.when().then() 将内容 div 滑入和滑出同一区域

> ID：10730217
> 
> 赞同：2
> 
> 时间：2012-05-24T02:05:33.157
> 
> 标签：jquery, jquery-ui, menu, panel

使用此[stackoverflow 线程](https://stackoverflow.com/a/2546389/693706)中的一些代码，我正在尝试开发一个类似于此[Web 模板上的内容滑块](http://www.templatemonster.com/demo/38395.html)

这是我工作的 [jsfiddle](http://jsfiddle.net/broncozr/ZJYV8/)。

您单击链接以显示内容；之前显示的内容在此之前被隐藏。如果某些内容正在显示，可以通过单击手动隐藏它。

使用链接的 ID（A、B 等），我们得到`<div>`要显示的内容的 ID ( )。当一个元素被显示时，它被赋予类，“elementEnabled”，以便稍后识别它。

在我滑入新内容之前，我希望隐藏的内容不碍事。我如何有条不紊地做到这一点？我`.delay()`有`.show()`一个很好的方法来做到这一点吗？

有没有更优雅的方式（在 jQuery 中）系统地隐藏显示的内容，然后显示适当的内容？有没有比使用更好的方法 `$.when().then(function(){})`？？？将这么多代码放在回调函数中（如下所示）是一种好习惯，还是应该将代码的“显示”部分拆分为单独的函数？

感谢您的任何建议。

的HTML：

```
<div id="links">
<a href="#" id="a-link">A</a>
<a href="#" id="b-link">B</a>
</div>
<div id="wrap">
<div class="start-content" id="a">
content here
</div>    
<div class="content" id="b">
content here
</div>
</div> 
```

这是javascript：

```
$("#links a").click(function() {

//  having to do this for the callback function below
var park_this = $(this);

//  which ID is currently shown?
id_enabled = $('.enabledElement').attr("id").replace('-link', '');           

//hide previously displayed content
$.when($('#' + id_enabled).stop().hide("slide", 
    { direction: "left" }, 400)).then( function(){ // callback 

// remove any instances of special class
$('.enabledElement').removeClass('enabledElement');

// add special class to clicked element 
park_this.addClass('enabledElement');

// using the link ID, get the ID of the content to show
var id = park_this.attr("id").replace('-link', ''); //matching id

//show what's clicked on
$('#' + id).stop().delay(initial_pause).show("slide", 
    { direction: "left" }, 1000 );    

});  // close when/then callback function

} // close "click" function 
```

# php - 从 php 中重写的 url 获取 mysql 查询的值

> ID：10730218
> 
> 赞同：0
> 
> 时间：2012-05-24T02:05:36.243
> 
> 标签：php, mysql, url, variables

我有一个重写的网址，显示为：

[http://www.coverforce.com.au/insurance-news/news/start-your-own-business-insurance/800479715/](http://www.coverforce.com.au/insurance-news/news/start-your-own-business-insurance/800479715/)

最后的数字是我需要在 mySQL 查询中使用以允许用户阅读这篇文章的 URL 变量 - 有没有办法使用 $_GET 或爆炸来获取这个数字，所以我可以用它来调出我的 mySQL 数据库中的文章正确吗？

这是我尝试过的，但它不起作用：

```
<?php require_once('../Connections/newsDBconnection.php'); ?>
<?php
if (!function_exists("GetSQLValueString")) {
function GetSQLValueString($theValue, $theType, $theDefinedValue = "", $theNotDefinedValue = "") 
{
  if (PHP_VERSION < 6) {
    $theValue = get_magic_quotes_gpc() ? stripslashes($theValue) : $theValue;
  }

  $theValue = function_exists("mysql_real_escape_string") ? mysql_real_escape_string($theValue) : mysql_escape_string($theValue);

  switch ($theType) {
    case "text":
      $theValue = ($theValue != "") ? "'" . $theValue . "'" : "NULL";
      break;    
    case "long":
    case "int":
      $theValue = ($theValue != "") ? intval($theValue) : "NULL";
      break;
    case "double":
      $theValue = ($theValue != "") ? doubleval($theValue) : "NULL";
      break;
    case "date":
      $theValue = ($theValue != "") ? "'" . $theValue . "'" : "NULL";
      break;
    case "defined":
      $theValue = ($theValue != "") ? $theDefinedValue : $theNotDefinedValue;
      break;
  }
  return $theValue;
}
}

$totalRows_variablearticles = "-1";
if (isset($_GET['id'])) {
  $totalRows_variablearticles = $_GET['id'];
}
mysql_select_db($database_newsDBconnection, $newsDBconnection);
$query_variablearticles = sprintf("SELECT * FROM NewsArticles, NewsArticleCategories, NewsArticlePhotos, NewsPhotos, NewsCategories WHERE NewsArticles.id = %s AND NewsArticles.id = NewsArticleCategories.newsArticleID AND NewsArticles.id = NewsArticlePhotos.newsArticleID AND NewsArticlePhotos.newsPhotoID = NewsPhotos.id AND NewsArticleCategories.newsCategoryID = NewsCategories.id", GetSQLValueString($totalRows_variablearticles, "int"));
$variablearticles = mysql_query($query_variablearticles, $newsDBconnection) or die(mysql_error());
$row_variablearticles = mysql_fetch_assoc($variablearticles);
$totalRows_variablearticles = mysql_num_rows($variablearticles);
?> 
```

我的网站目前正在运行，文章无法正常工作，因此您可以提供的任何帮助都非常棒！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T05:51:39.627

```
<?php

$Path = 'http://DomainName/news/articles/8008280';

//To get the innermost value  your id '8008280'

$Innermost = basename(rtrim($Path, '/'));

echo $Innermost; //will display '8008280'

// you can use article no for your query

// but make sure that article no is within the range of article no's in DB 

?> 
```

# ruby-on-rails - 访问 RABL 模板中的子实例

> ID：10730223
> 
> 赞同：4
> 
> 时间：2012-05-24T02:06:19.710
> 
> 标签：ruby-on-rails, ruby, rabl

我有一个如下所示的 RABL 模板

```
object @user
attributes :name
child :contacts do
  # does not work
  if contact.is_foo?
    attributes :a1, :a2
  else
    attributes :a3, :a4
  end
end 
```

如何访问模`Contact`板块中的对象`child`？我需要对子实例执行一些条件逻辑。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-24T06:24:27.323

您可以通过声明块参数来访问当前对象。

```
object @user
attributes :name
child :contacts do |contact|
  if contact.is_foo?
    attributes :a1, :a2
  else
    attributes :a3, :a4
  end
end 
```

### 旧答案

我最终使用了`root_object` [方法](https://github.com/nesquena/rabl/blob/master/lib/rabl/engine.rb#L112)，它返回给定上下文中的数据对象。

```
object @user
attributes :name
child :contacts do
  if root_object.is_foo?
    attributes :a1, :a2
  else
    attributes :a3, :a4
  end
end 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-21T00:54:27.620

另一种保持干燥的方法：

**联系人/show.json.rabl**

```
object @contact
node do |contact|
    if contact.is_foo?
        {:a1 => contact.a1, :a2 => contact.a2}
    else
        {:a3 => contact.a3, :a4 => contact.a4}
    end
end 
```

**用户/show.json.rabl**

```
object @user
attributes :name
child :contacts do
    extends 'contacts/show'
end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T02:13:12.683

这是一种方法：

```
child :contacts do
  node(:a1, :if => lambda { |c| c.is_foo? }
  node(:a2, :if => lambda { |c| c.is_foo? }

  node(:a3, :unless => lambda { |c| c.is_foo? }
  node(:a4, :unless => lambda { |c| c.is_foo? }
end 
```

不完全相同，但一种可能性，另一种是：

```
node :contacts do |u|
  u.contacts.map do |c|
    if contact.is_foo?
      partial("contacta", :object => c)
      # or { :a1 => "foo", :a2 => "bar" }
    else
      partial("contactb", :object => c)
      # or { :a3 => "foo", :a4 => "bar" }
    end
  end
end 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-01-29T08:06:20.053

我知道这是一个迟到的回复，但遇到了类似的问题，所以想回答。

它更像是一个黑客，但有效。

当两个变量用作块参数contact和一个随机变量x时，contact指的是集合的一个对象

在块参数中使用一个变量时，它会呈现集合对象

```
object @user
attributes :name
child :contacts do |contact, x|
  if contact.is_foo?
    attributes :a1, :a2
  else
    attributes :a3, :a4
  end
end 
```

# image - PyGTK FileChooserDialog 不断出现错误

> ID：10730226
> 
> 赞同：-1
> 
> 时间：2012-05-24T02:06:43.570
> 
> 标签：image, view, pygtk

现在我最初为 Windows 制作了[WidgetArea](http://mikethedj4.deviantart.com/art/WidgetArea-Use-Images-On-Your-HD-As-A-Widget-300769639)，但主要是 Linux 用户。我也想为 Linux 制作它，但主要是为了更多地了解 PyGTK 中的文件对话框。因此，我查看了[本](http://developer.gnome.org/gnome-devel-demos/stable/image-viewer.py.html.en)教程以更好地理解它，同时处理这个简单而小型的应用程序，因为这对我来说更容易学习和通过实验来理解。

所以这是我的源代码。

```
#!/usr/bin/env python

import sys, os
import pygtk, gtk, gobject
import pygst
pygst.require("0.10")
import gst

class WidgetArea(gtk.Window):

   def addwidget(self, w):
    self.win = gtk.Window(gtk.WINDOW_TOPLEVEL)
    self.win.set_title("Widget")
    self.win.set_decorated(False)
    self.win.set_has_frame(False)
    self.win.set_resizable(False)
    self.win.set_keep_above(True)
    self.win.set_property('skip-taskbar-hint', True)
    self.previewimage = gtk.Image()
    self.win.add(self.previewimage)
    self.win.show_all()

   def pinning(self, checkbox):
    if checkbox.get_active():
     self.set_keep_above(True)
    else:
     self.set_keep_above(False)

   def change_size(self, w):
     width = int(self.entryw.get_text())
     height = int(self.entryh.get_text())
     self.win.set_size_request(width,height)

   def __init__(self):
    super(WidgetArea, self).__init__()
    self.set_position(gtk.WIN_POS_CENTER)
    self.set_title("WidgetArea")
    self.set_resizable(False)
    self.set_keep_above(True)
    self.set_property('skip-taskbar-hint', True)
    self.connect("destroy", gtk.main_quit, "WM destroy")
    vbox = gtk.VBox(spacing=0)
    hbox = gtk.HBox(spacing=0)
    hbox2 = gtk.HBox(spacing=0)
    hbox3 = gtk.HBox(spacing=0)
    hbox4 = gtk.HBox(spacing=0)

    self.widgetsize = gtk.Label("Widget Size:")
    self.widgetsize.set_size_request(100, 30)

    self.entryw = gtk.Entry()
    self.entryh = gtk.Entry()
    self.entryw.set_text("270")
    self.entryw.set_size_request(75, 30)
    labelcoma = gtk.Label(",")
    labelcoma.set_size_request(10, 30)
    self.entryh.set_text("221")
    self.entryh.set_size_request(75, 30)
    labelspac1 = gtk.Label(" ")
    labelspac1.set_size_request(10, 30)
    hbox.pack_start(self.widgetsize)
    hbox.pack_start(self.entryw)
    hbox.pack_start(labelcoma)
    hbox.pack_start(self.entryh)
    hbox.pack_start(labelspac1, 0, 0, 10)

    check = gtk.CheckButton("Pin This Window")
    check.set_active(True)
    check.connect("clicked", self.pinning)
    hbox.pack_start(check, 0, 0, 10)

    labelspac2 = gtk.Label(" ")
    labelspac2.set_size_request(250, 15)
    hbox2.pack_start(labelspac2)

    filefilter = gtk.FileFilter()
    filefilter.set_name("Images")
    filefilter.add_mime_type("image/png")
    filefilter.add_mime_type("image/jpeg")
    filefilter.add_mime_type("image/gif")
    filefilter.add_mime_type("image/tiff")
    filefilter.add_mime_type("image/svg+xml")
    filefilter.add_pattern("*.jpg")

    self.ref_file_button = gtk.FileChooserButton('Add Widget')
    self.ref_file_button.set_current_folder("/".join([self.rootdir,"pics"]))
    self.ref_file_button.set_filter(filefilter)
    self.ref_file_button.connect("file-set", self.on_open_clicked)
    hbox3.pack_start(self.ref_file_button, 150, 150, 10)

    labelspac5 = gtk.Label(" ")
    labelspac5.set_size_request(0, 10)
    hbox4.pack_start(labelspac5)

    vbox.pack_start(hbox)
    vbox.pack_start(hbox2)
    vbox.pack_start(hbox3)
    vbox.pack_start(hbox4)
    self.add(vbox)
    self.show_all()

   def on_open_clicked(self, widget, data=None):
    ref_image_path = widget.get_filename()
    self.previewimage.set_from_file(ref_image_path)
    self.addwidg.connect("clicked", self.addwidget)
    self.addwidg.connect("clicked", self.change_size)
    ref_image_path.destroy()

WidgetArea()
gtk.gdk.threads_init()
gtk.main() 
```

由于以下错误（第 2 次），我删除了以下代码（第 1 次）。

```
self.ref_file_button.set_current_folder("/".join([self.rootdir,"pics"]))

Traceback (most recent call last):
  File "./widgetarea.py", line 109, in <module>
    WidgetArea()
  File "./widgetarea.py", line 86, in __init__
    self.ref_file_button.set_current_folder("/".join([self.rootdir,"pics"]))
AttributeError: 'WidgetArea' object has no attribute 'rootdir' 
```

现在这不是什么大问题。我的主要目标是让图像显示在新窗口中。所以在我删除了上面的代码之后，由于那个错误我得到了另一个。

```
Traceback (most recent call last):
  File "./widgetarea.py", line 103, in on_open_clicked
    self.previewimage.set_from_file(ref_image_path)
AttributeError: 'WidgetArea' object has no attribute 'previewimage' 
```

我遇到的所有问题是当您浏览以选择我想要选择的图像的图像时，当按下 OK 启动作为在该窗口中显示所选图像的新窗口时，如上所述。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T09:54:21.663

要更正第一个错误，请使用`gtk.FILE_CHOOSER_ACTION_OPEN`而不是`gtk.FileChooserAction.OPEN`.

第二个问题是因为您的代码中没有`image`在该点命名的变量（第 116 行）。也许您来自 C++ 或 Java 背景，`image`可以通过查看封闭类的属性来解析类似的名称，即`this.image`？

在 Python 中你不能这样做。您必须`self.image`在您的`addwidget()`方法中明确分配给。否则，该名称将`image`保留在该方法的本地，并且在该`addwidget()`方法之外不可用。

这引发了一个不同的问题，每次单击并`addwidget()`调用按钮时会发生什么？`self.win`并被`self.image`覆盖。这可能是你想要的，但我只是提醒你注意——这对我来说似乎有点奇怪。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T21:11:48.920

我在我的一个项目中使用了类似的东西。它在 Linux 中对我来说运行良好。

```
def __init__(self):
    # Define all the widgets   
    image_filter = gtk.FileFilter()
    image_filter.set_name("Images")
    image_filter.add_mime_type("image/png")
    image_filter.add_mime_type("image/jpeg")
    image_filter.add_mime_type("image/gif")
    image_filter.add_mime_type("image/tiff")
    image_filter.add_mime_type("image/svg+xml")
    image_filter.add_pattern("*.jpg")

    self.ref_file_button = gtk.FileChooserButton('Select Image')
    self.ref_file_button.set_size_request(100,30)
    self.ref_file_button.set_current_folder("/".join([self.rootdir,"pics"])) # set directory path
    self.ref_file_button.set_filter(image_filter)
    self.ref_file_button.set_tooltip_text('Select Image')
    self.ref_file_button.connect("file-set", self.ref_image_selected)

def ref_image_selected(self,widget,data=None):
    ref_image_path = widget.get_filename()
    print ref_image_path 
```

获取图片的路径后，可以使用 gtk.Image 加载

**编辑：**

你的代码有点错误。您永远不会调用函数 addwidget()，因此未定义 self.previewimage。所以它给出了AttributeError。

```
def __init__(self):
    # your code
    self.add(vbox)
    self.addwidget(200)   # I don't know what 'w' is. so I took a random number.
    self.show_all()

def  on_open_clicked(self, widget, data=None):
    ref_image_path = widget.get_filename()
    self.previewimage.set_from_file(ref_image_path)
    self.addwidg.connect("clicked", self.addwidget)
    self.addwidg.connect("clicked", self.change_size)
    ref_image_path.destroy() 
```

什么是**self.addwidg**？

我现在可以查看图像了。

# validation - 布尔验证检查 cakephp 不起作用

> ID：10730232
> 
> 赞同：0
> 
> 时间：2012-05-24T02:07:39.300
> 
> 标签：validation, cakephp, boolean

嘿，试图在一个名为“已激活”的布尔字段上进行验证检查。基本上，如果布尔值为 1，则该帐户处于活动状态，这意味着他们可以登录。如果是其他任何内容，则用户无法登录。

这是我对用户模型的检查：

```
public $checkActive = array(
        'activated'=>array(
                'rule'=>array('equalTo', '1'),
                'message'=>'The account must be activated, please check your email.'
            )); 
```

不幸的是，用户可以在他们不应该登录的时候登录。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T04:01:11.750

我相信模型中的验证仅在保存数据时进行测试。

如果您正在使用身份验证组件，您可以定义一个“范围”，这是一个必须等​​于 true 才能使用户获得身份验证的条件。

```
'scope' => array('User.activated' => 1) 
```

更多信息和示例：[http](http://book.cakephp.org/2.0/en/core-libraries/components/authentication.html) ://book.cakephp.org/2.0/en/core-libraries/components/authentication.html ）

如果您编写了自己的身份验证，则可以将条件添加到当前的 find 语句中。

```
$this->User->find('all', array('conditions' => array('username' => $username, 'password' => $password, 'activated' =>1); 
```

希望这能回答你的问题。

# css - CSS 条形图 - 非常简单

> ID：10730233
> 
> 赞同：7
> 
> 时间：2012-05-24T02:07:40.470
> 
> 标签：css, charts

我有一些非常基本的代码，它可以工作，除了所有内容都与顶部对齐......理想情况下，条形将与底部对齐。我想我可以使用固定定位，因为尺寸是 50 像素乘 50 像素的平方，但我更喜欢不那么“固定”的东西。

```
 <div style="border: 1px solid #aeaeae; background-color: #eaeaea; width: 50px; height: 50px;">
        <div style="position: relative; bottom: 0; float: left; width: 8px; height: 22px; background-color: #aeaeae; margin: 1px;"></div>
        <div style="position: relative; bottom: 0; float: left; width: 8px; height: 11px; background-color: #aeaeae; margin: 1px;"></div>
        <div style="position: relative; bottom: 0; float: left; width: 8px; height: 6px; background-color: #aeaeae; margin: 1px;"></div>
        <div style="position: relative; bottom: 0; float: left; width: 8px; height: 49px; background-color: #aeaeae; margin: 1px;"></div>
        <div style="position: relative; bottom: 0; float: left; width: 8px; height: 28px; background-color: #aeaeae; margin: 1px;"></div>
      </div> 
```

我不想使用库或 JS 插件。保持这种轻量级是关键任务。

此外，我更喜欢这些条是垂直的。有任何 CSS 大师关心我似乎缺少的一点点吗？我用谷歌搜索过，大多数例子都非常复杂/复杂，

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-05-24T02:23:33.387

首先，将 CSS 与 HTML 分开。当您可以为您的内部 div 使用 bar 类时，您重复了太多代码。

`bottom: 0`相对定位的 div 不会改变任何东西。

如果你想使用相对定位，去掉 float 和 bottom 并使用`display: inline-block`and `vertical-align: baseline;`。此外，在这种情况下，您需要去掉 HTML 中内部 div 之间的任何空格（换行符）。

[像这样（您可以在http://dabblet.com/gist/2779082](http://dabblet.com/gist/2779082)看到演示）：

**HTML**

```
<div class="graph">
        <div style="height: 22px;" class="bar"></div><!--
        --><div style="height: 11px;" class="bar"></div><!--
        --><div style="height: 6px;" class="bar"></div><!--
        --><div style="height: 49px;" class="bar"></div><!--
        --><div style="height: 28px;" class="bar"></div>
</div> 
```

**CSS**

```
.graph {
    width: 50px;
    height: 50px;
    border: 1px solid #aeaeae;
    background-color: #eaeaea;
}
.bar {
    width: 8px;
    margin: 1px;
    display: inline-block;
    position: relative;
    background-color: #aeaeae;
    vertical-align: baseline;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-24T03:05:47.900

我个人会避免在每个元素上显式设置 xpos，这会降低可维护性。在某些情况下，基于百分比的值转储也更合适。考虑到这一点，一个 imo 更具可扩展性和语义正确的方法已被模拟为[fiddle](http://fiddle.jshell.net/ovfiddle/6jzxM/)。HTML：

```
<ul class="graph">
    <li><span style="height:45%"></span></li>
    <li><span style="height:12%"></span></li>
    <!--as many more items as you want !-->
</ul> 
```

和 CSS：

```
.graph {
    border: 1px solid #aeaeae; background-color: #eaeaea;/*"canvas" styling*/
    float:left; /*should be clearfix'd instead, but this is OK for a demo*/
}
.graph li {
    width:8px; height:50px; /*set a bar width and a full height*/
    float:left; /*to have bars "left-aligned"*/
    position:relative; /*needed for the actual bar fill element*/
    margin:2px;
 }
 .graph li+li {
    margin-left:0; /*avoid margin double-up between bars as they don't collapse*/
 }
 .graph span {
    position:absolute;right:0;bottom:0;left:0; /*"bottom-align" the bars,
                                                  widths will be set inline*/
    background-color: #aeaeae;
 } 
```

这也使您有可能变得非常花哨 - 条形可能包含带有负文本缩进的语义值的内容，或者`<span>`可以完全放弃元素以支持伪元素。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-24T02:46:23.767

Kolink 的回答是正确的。每个bar div的宽度是8px，加上margin-left和margin-right，8+1+1=10px。所以我建议，将左值设置为 0px、10px、20px ...

```
<div class="wrapper">
    <div style=" left:0px;height:22px;"></div>
    <div style="left:10px;height:11px;"></div>
    <div style="left:20px;height:6px;"></div>
    <div style="left:30px;height:49px;"></div>
    <div style="left:40px;height:28px;"></div>
</div> 
```

css 应该如下所示（我将一些通用 css 规则分组）：

```
.wrapper{
  border: 1px solid #aeaeae; 
  background-color: #eaeaea; 
  width: 50px; 
  height: 50px;
  position : relative;

}

.wrapper > div{
  bottom: 0px;
  width: 8px;
  position : absolute;
  background-color: #aeaeae; 
  margin: 1px;
  display : inline-block; 

 } 
```

你可以查看这个链接： http: [//jsfiddle.net/zhujy_8833/AFbt4/](http://jsfiddle.net/zhujy_8833/AFbt4/)查看上面代码的结果。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-02-26T21:14:13.783

如果给 parent `position: relative`，那么您可以使用`position: absolute`for child`div`通过设置`left`, `top`, `right`, `bottom`,将它们放置在精确的坐标中`width`，`height`您可以精确控制条形图在条形图中的位置。

```
.graph {
    position: relative;
    width: 54px;
    height: 54px;
    border: 1px solid blue;
    background-color: lightgrey;
}

.bar {
    position: absolute;
    border: 1px solid blue;
    background-color: yellow;
}
```

```
<div class="graph">
  <div style="position:absolute; left: 1px; top: 1px; right: 1px; bottom: 1px">
    <div class="bar" style="bottom: 0; left: 0; width: 8px; height: 22px"></div>
    <div class="bar" style="bottom: 0; left: 10px; width: 8px; height: 11px"></div>
    <div class="bar" style="bottom: 0; left: 20px; width: 8px; height: 6px"></div>
    <div class="bar" style="bottom: 0; left: 30px; width: 8px; height: 49px"></div>
    <div class="bar" style="bottom: 0; left: 40px; width: 8px; height: 28px"></div>
  </div>
</div>

<p></p>

<div class="graph">
  <div style="position:absolute; left: 1px; top: 1px; right: 1px; bottom: 1px">
    <div class="bar" style="left: 0; top: 0; height: 8px; width: 22px"></div>
    <div class="bar" style="left: 0; top: 10px; height: 8px; width: 11px"></div>
    <div class="bar" style="left: 0; top: 20px; height: 8px; width: 6px"></div>
    <div class="bar" style="left: 0; top: 30px; height: 8px; width: 49px"></div>
    <div class="bar" style="left: 0; top: 40px; height: 8px; width: 28px"></div>
  </div>
</div>
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-24T02:09:22.437

使用`position: absolute`, 代替`float:left;`使用`left: 0px;`,`8px`等等`16px`。
也添加`position: relative`到容器中。

# sockets - Apache Web 服务器套接字绑定

> ID：10730235
> 
> 赞同：0
> 
> 时间：2012-05-24T02:08:15.590
> 
> 标签：sockets, binding

我刚开始阅读一些Apache HTTP Server 的[绑定文档](http://httpd.apache.org/docs/2.0/bind.html)。而第一行“**默认情况下，它侦听机器上的所有地址。** ”，我发现这句话很混乱。“监听所有地址”是什么意思？他们肯定不会打开所有 64000 个端口来监听。他们想从中传达什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T02:11:33.933

在这种情况下，*地址*指的是 IP 地址，而不是端口。它不会侦听所有端口，它会绑定（默认情况下）并侦听主机上的所有 IP 地址。

# facebook - 群组页面未显示来自 Graph API 的某些成员名称

> ID：10730236
> 
> 赞同：1
> 
> 时间：2012-05-24T02:08:15.927
> 
> 标签：facebook, facebook-graph-api, facebook-group

有人可以向我解释为什么我的群组页面中的一些成员的姓名数据为空白，但他们的 Facebook ID 显示得很好？

我正在谈论的一个例子是：

```
<user>
<id>xxxxxxxx</id>
<name>Bobby Bushay</name>
</user> 
```

那些显示 fb id 但不显示名称的看起来像这样：

```
<user>
<id>xxxxxxxxxxxx</id>
<name> </name>
</user> 
```

所以我认为这可能与他们的隐私设置有关？如果是这样，我需要在哪里指导他们以更改该隐私设置以便可以阅读？奇怪的是，当我使用 Facebook Graph API Explorer 并单击他们的 ID 时，它会为我提供他们的所有信息，**包括**他们的名字和姓氏？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T11:11:36.073

如果您转到用户的个人资料页面会发生什么？例如 facebook.com/{profile_id}

可能是这些用户阻止将他们的信息共享给组/或其成员。

要求用户编辑`How people bring your info to apps they use`其帐户的设置，可在`Privacy Settings`>下找到`Apps, games and websites`。也许这会有所作为。特别是，检查`Bio`复选框是否被选中。

# php - 你能测试没有功能的模型吗？

> ID：10730241
> 
> 赞同：2
> 
> 时间：2012-05-24T02:08:32.423
> 
> 标签：php, unit-testing, cakephp, phpunit, cakephp-2.0

这不是我要问的问题，因为有些东西坏了。它更像是我想知道在这种情况下该怎么做。

如果我写了以下模型，

```
class Amenity extends AppModel {

    var $name = 'Amenity';
     /**
     * Behaviors used by the Model
     *
     * @var array
     * @access public
     */

    var $hasAndBelongsToMany = array(
            'RoomFlat' =>
                array(
                     'className'              => 'RoomFlat',
                     'joinTable'              => 'amenities_room_flats',
                     'foreignKey'             => 'amenity_id',
                     'associationForeignKey'  => 'room_flat_id',

                )
        ); 

    var $actsAs = array(        
        'Multivalidatable'
    );  
    /**
     * Custom validation rulesets
     */ 
    var $validationSets = array(
       'admin'=>array(
          'name'=>array(                        
             'notEmpty'=>array(
                        'rule'=>'notEmpty',
                        'message'=>'This  is required'        
                        ),
             'isUnique'=>array(
                        'rule'=>'isUnique',
                        'message'=>'This already exists.'
                        )   
            ),
        )
    );
} 
```

我还写了以下夹具

```
class AmenityFixture extends CakeTestFixture {
    public $fields = array(
        'id' => array('type' => 'integer', 'key' => 'primary'),
        'name' => array('type' => 'text', 'null' => 'false'),
        'status' => array('type' => 'tinyint', 'null' => 'false'),
        'created' => array('type' => 'datetime', 'null' => 'false'),
        'modified' => array('type' => 'datetime', 'null' => 'false')
    );

    public function init(){ 
        $this->records = array(
            array('id' => 1, 'name' => 'amenity fixture 1', 'status'=>'1', 'created' => date('Y-m-d H:i:s'), 'modified' => date('Y-m-d H:i:s')),
            array('id' => 2, 'name' => 'amenity fixture 2', 'status'=>'0', 'created' => date('Y-m-d H:i:s'), 'modified' => date('Y-m-d H:i:s')),
            array('id' => 3, 'name' => 'amenity fixture 3', 'status'=>'1', 'created' => date('Y-m-d H:i:s'), 'modified' => date('Y-m-d H:i:s')),
            array('id' => 4, 'name' => 'amenity fixture 4', 'status'=>'0', 'created' => date('Y-m-d H:i:s'), 'modified' => date('Y-m-d H:i:s')),
            array('id' => 5, 'name' => 'amenity fixture 5', 'status'=>'1', 'created' => date('Y-m-d H:i:s'), 'modified' => date('Y-m-d H:i:s')),
        );
        parent::init();
    }

} 
```

测试它的最佳方法是什么？我在模型中真的没有要测试的功能吗？这是一种你真的不会对任何东西进行单元测试的情况吗？如果你让我为此编写一个测试套件，你会让我怎么做？

我也在使用 cakePHP，是的，我已经阅读了有关测试的页面（http://book.cakephp.org/2.0/en/development/testing.html）。但我真的很想理解为什么做某事而不是如何做。如果有人可以推荐任何好书或文章，那也会有所帮助。

如果我需要发布任何其他详细信息，请告诉我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T08:41:11.813

您的问题在评论中得到了很好的回答，但为了清楚起见，这里有一个答案。

这是您的模型没有任何测试的情况。大多数时候，你只需要测试一个对象的公共方法，而这里没有。如果你有这样的方法：

```
class Amenity extends AppModel
{
    public function doSomething($one, $two, $three)
    {
        // ...
    }
} 
```

然后，您需要使用 和 的不同组合编写`$one`测试。但是测试诸如method之类的模型函数是没有意义的，因为它们被蛋糕自己的测试覆盖了。`$two``$three``Model::find()`

最后，我将从评论中引用[deceze](https://stackoverflow.com/users/476/deceze)：

> 您所有的业务逻辑都应该表示为模型方法。

这是一个非常重要的概念，无论是为了测试还是为了清晰。

有关更多信息，请阅读以下内容：[胖模型](http://bitfluxx.com/2008/01/23/cakephp-best-practices-fat-models-and-skinny-controllers.html)、[瘦控制器](http://www.littlehart.net/atthekeyboard/2007/04/27/fat-models-skinny-controllers/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T08:38:42.127

当然，您可以测试这些模型。因为实际上，他们确实有方法（他们的父模型）。

但是只有在那时（读/写）涵盖基础知识才有意义。断言表已正确设置等 - 所以也许是一些 save() 和 find() 测试。您还可以测试正确设置的关系（在您的情况下为 HABTM）或您的验证规则。

蛋糕测试可能已经涵盖了其他所有内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T08:41:38.787

对于 Cakephp，可以/应该对其他两个方面进行单元测试：

*   验证规则
*   模特关系

**为什么 ？***因为如果模型中的任何字段名称或类型发生更改*，它将检测代码回归。

我特别关注**输入**和**命名**assert() 因为回归当然会发生（多个开发人员，多个版本），否则您将很难检测到这一点。

希望这可以帮助 ！

# c# - 我如何制作一个带引号的字符串？

> ID：10730245
> 
> 赞同：2
> 
> 时间：2012-05-24T02:09:18.617
> 
> 标签：c#

我在函数的顶部有这个：

```
string n = "";
string test = "T256=" + n; 
```

但是测试只是“T256 =”

如果在字符串 n 我正在做 n = "\"";

那么 test 是 "T256=\" 但 \ 是否意味着引号？

如果我有，我怎么能取出一个空字符串：

T256="Hello" 所以我只能取出 Hello 但如果我有 T256="" 是什么意思？由于我的程序正在跳过一个空字符串“”

但我需要使用它。

例如在我的文件中是这样的：

```
T256="hello"

T256=""

T256=""

T256="hi" 
```

那么我如何记住这两个 T256="" ？如果我不这样做，它会将下一个单词放在第一个空的 T256="" 中，它会像：

```
T256="hello"

T256="hi" 
```

它不是它应该的方式。它应该是这种格式，这是好的格式：

```
T256="hello"

T256=""

T256=""

T256=hello" 
```

所以这是我的代码，我在其中取出了文本，但由于某种原因，它没有取出两个标签之间没有文本的地方。

字符串 startTag = "T256=\""; 字符串 endTag = "\"";

如果这两个标签之间有文本，它将把它取出，但如果这个标签之间没有文本，它将跳到标签之间有文本的下一行。

我需要用 T256="" 取任何一行，即使它在 "" 之间是空的

所以在文本文件中我会看到一个空格或“”，例如文本文件应该如下所示：

```
Hello

""

Hi

""

""

Hello 
```

或者，如果不是“”，则为空，当我放回文本时，它也应该放回空格或空字符串。

这是我取出文本的代码：

```
private void parseText(string originalFile, BackgroundWorker worker)
        {
            FormText("Parsing Text");
            int lineNumber = 0;
            string startTag = "T256=\"";
            string endTag = "\"";
            int index = 0;
            int startTagWidth = startTag.Length;
            int endTagWidth = endTag.Length;
            int fileLength = originalFile.Length;
            w = new StreamWriter(@"d:\testingdeponias.txt");
            while (true)
            {
                if (index > originalFile.LastIndexOf(startTag))
                {
                    break;
                }
                int startTagIndex = originalFile.IndexOf(startTag, index);
                int stringIndex = startTagIndex + startTagWidth;
                index = stringIndex;

                int endTagIndex = originalFile.IndexOf(endTag, index);
                int stringLength = endTagIndex - stringIndex;
                if (stringLength == 0)
                {
                }
                else
                {
                    //worker.ReportProgress(20);
                    string test = originalFile.Substring(stringIndex, stringLength);
                    if (test == "")
                    {
                        MessageBox.Show(test);
                    } 
```

但是测试永远不是“”我在那里使用断点并且它永远不会到达 MessageBox

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T03:00:08.947

`"\""`意味着`\"`。

在 .NET[C#] 中，我们不能简单地编写`"`，因为这`Char`在语言中具有一些特殊功能。

所以我们必须编写 Char 的转义序列`"`。

Escape 序列以实际的 Char 开头`\`。

*例如：*`\` is的转义序列`\\`。

所以在你的情况下，`"`将被写成`\"`并对其进行字符串化，`\"`变为`"\""`

代码 ：

```
string n = "\"\"";
string test = "T256=" + n; // same as string test = "T256=\"\"" 
```

[阅读更多关于`Escape Sequence`](http://msdn.microsoft.com/en-us/library/h21280bw%28v=vs.100%29.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T02:14:09.343

它非常简单。

简单地测试

*   字符串化引号：" -> 带有转义字符 \" -> 字符串化 "\""
*   字符串化两个引号："" -> 带有转义字符 \"\" -> 字符串化 "\"\""

串针 = "256TT=\"\"";

等于 256TT=""

并且每当程序找到它时，只需打印出您的消息框或您想要做的任何事情：在您的文本文件中放置一个空格或放置两个引号，如 \"\"

就是这样。

# actionscript-3 - 处理库中的许多影片剪辑并将它们放入对象中

> ID：10730249
> 
> 赞同：0
> 
> 时间：2012-05-24T02:09:47.427
> 
> 标签：actionscript-3, flash

我创建了一个 Shortcuts 类，它接收一个影片剪辑，并在有人翻过它时为图标添加一个高亮。

chromeshortcut 是movieclip 的类名，但是看看会有几个图标，有没有更优雅的方法可以将这些mc 从库中检索到我的快捷方式类中？

我正在考虑存储所有 mc 类名的数组，但是否可以使用变量动态实例化对象？因此，new myclassname();，myclassname 是从数组中检索的变量。

```
import com.Shortcuts;

var aName:MovieClip = new chromeshortcut();

var shortcut:Shortcuts = new Shortcuts(aName);

shortcut.x = 200;
shortcut.y = 200;
addChild(shortcut); 
```

快捷方式类：

```
 package com{

                import flash.display.*;
                import flash.events.*;
                import 

flash.net.*;

        public class Shortcuts extends MovieClip{

            private var highlight:MovieClip;

            public function Shortcuts(icon:MovieClip){

                highlight = new shortcuthighlight();

                highlight.x = highlight.x - highlight.width/2;
                highlight.y = highlight.y - highlight.height/2;
                highlight.visible = false;
                addChild(highlight);

                icon.x = icon.x - icon.width/2;
                icon.y = icon.y - icon.height/2;
                addChild(icon);

                this.addEventListener(MouseEvent.ROLL_OVER, addHighlight);
                this.addEventListener(MouseEvent.ROLL_OUT, removeHighlight);
            }

            public function addHighlight(evt:MouseEvent){

                highlight.visible = true;

            }

            public function removeHighlight(evt:MouseEvent){

                highlight.visible = false;

            }

        }

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T02:17:28.067

我认为您以错误的方式解决此问题 - 而不是将 MovieClips 传递到 Shortcuts 类中，您应该让 MovieClips 扩展 Shortcuts 类。

# javascript - 使浮动 div 居中

> ID：10730259
> 
> 赞同：3
> 
> 时间：2012-05-24T02:12:17.863
> 
> 标签：javascript, jquery, css, image, addthis

我被困住了。这就是我正在做的事情，我在网页上的主图像旁边有一个 AddThis 共享小部件。图像会改变大小，我需要 AddThis 来动态改变图像的位置。我在[另一个问题](https://stackoverflow.com/questions/10691304/fluid-spacing-for-a-div)中提出了这个问题，并通过另一个论坛获得了一些帮助。现在 AddThis 和图像正确对齐，一切似乎都朝着正确的方向发展，但是图像不再居中。我需要这个图像在页面上居中，但我无法弄清楚如何做到这一点，因为我必须浮动包含图像和 AddThis 的 div。这是HTML：

```
<div class="feature-container">
<div style="min-height:100px; min-width:100px; position:relative; float:left; ">
<div style="text-align:center;"><img class="feature-image" 
     src="/Images/test.jpg" width="300px;" alt="test" /></div>
<div style="position:absolute; bottom:0px; right:-40px;">
    <div class="addthis_toolbox addthis_floating_style addthis_16x16_style">
        <a class="addthis_button_facebook"></a>
        <a class="addthis_button_twitter"></a>
        <a class="addthis_button_email"></a>
        <a class="addthis_button_compact"></a>
        </div>
    <script type="text/javascript" src="http://s7.addthis.com/js/300
                 /addthis_widget.js"></script>
</div>
</div>
</div> 
```

任何想法如何居中？我可以使用直接的 CSS 解决方案或使用 jQuery 和 CSS 的解决方案。请提供例子。

这是[页面的 JSFIDDLE](http://jsfiddle.net/Lynda333/WY9YX/18/)。

[这是一个](http://www.ubhape2.com/test-placement.html)包含我正在尝试的最新代码的页面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T03:59:49.293

试试这个：

```
var pos = $('.center').width() - $('img').width();
$('.center').css('margin-left', pos); 
```

[http://jsfiddle.net/WY9YX/4/](http://jsfiddle.net/WY9YX/4/)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-24T02:36:33.110

我不确定你*的 'im-center'*的内容，因为我添加了一个内联样式（text-align:center;），如下所示，测试它并在 ie 8 上运行良好。

```
<div class="img-center" style="text-align:center;">
  <img src="test.jpg" alt="test" />
</div> 
```

为中心 div 定义一个固定宽度就可以了，如果这不需要固定宽度，@Raminson 的 jquery 解决方案会更好。我真的很想知道我们是否可以用纯 css 来实现它

```
<div id="top" class="wrap_fullwidth">
    <div class="center" style="width:400px;">
<div style="min-height:100px; min-width:100px; position:relative; float:left; ">
    <div style="text-align:center;"><img src="http://www.ubhape2.com/Images/test.jpg" alt="test" /></div>
    <div style="position:absolute; bottom:0px; right:-40px;">
        <div class="addthis_toolbox addthis_floating_style addthis_16x16_style">
            <a class="addthis_button_facebook"></a>
            <a class="addthis_button_twitter"></a>
            <a class="addthis_button_email"></a>
            <a class="addthis_button_compact"></a>
            </div>
        <script type="text/javascript" src="http://s7.addthis.com/js/300/addthis_widget.js"></script>
    </div>
</div>
</div>

</div>​​​ 
```

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2012-05-24T02:47:44.477

尝试将`margin: 0 auto;`CSS 规则应用于 div。

# database - 100M行表的性能（Oracle 11g）

> ID：10730261
> 
> 赞同：3
> 
> 时间：2012-05-24T02:12:31.950
> 
> 标签：database, oracle, database-design

我们正在设计一个用于临时分析的表格，该表格将随着时间的推移为收到的索赔捕获无数的值字段。表结构本质上是（伪代码）：

```
 table_huge (
     claim_key int not null,
     valuation_date_key int not null,
     value_1 some_number_type,
     value_2 some_number_type,
     [etc...],
     constraint pk_huge primary key (claim_key, valuation_date_key)
   ); 
```

所有值字段都是数字。要求是： 该表应至少包含最近 12 年（希望更多）的已受理索赔。每项索赔都应在索赔开始和当前日期之间的每个月末都有一个估价日期。典型的索赔起始量为每年 50k-100k。

将所有这些加起来，我预测了一个行数约为 1 亿的表，并且根据业务需求，可能会在几年内增长到多达 5 亿。该表将每月重建。消费者只会选择。除了每月刷新外，不会发生更新、插入或删除。

我是从业务（消费者）方面来的，但我有兴趣在降低 IT 成本的同时保留此表的分析价值。我们并不太关心表格的快速返回，但偶尔需要向它抛出几十个查询并在一三天内获得所有结果。

为了论证的缘故，让我们假设技术堆栈是，我不知道，在现代硬件的 80% 中。

我的问题是：

*   考虑到对大容量表的查询频率较低，索引的成本效益是否会变得过高？
*   SO 社区是否有使用 +100M 行表的经验并且可以提供有关如何管理的提示？
*   我是否应该将数据库技术问题留给 IT 部门来解决，还是应该认真考虑限制业务需求（为什么？）？

我知道这些都是一些软性问题，我希望读者明白这不是我可以在构建之前测试的命题。

如果需要任何澄清，请告诉我。谢谢阅读！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-24T02:50:14.180

首先：如果将技术问题留给 IT 部门，预计这将“正常工作”——尤其是如果您的预算允许“当前 80%”的硬件水平。

我确实有在入门级和过时硬件上使用 MySQL 中超过 200M 行的经验，我总是很惊讶。

一些提示：

*   在每月刷新时，加载没有非主索引的表，然后创建它们。寻找最佳点，并行创建多少索引效果最好。在日期少得多（约 10M）的项目中，与天真的“创建表，然后加载数据”方法相比，这减少了 70% 的加载时间

*   尝试掌握并发查询的数量和复杂性：这会影响您的硬件决策（更少的并发=更少的 IO，更多的 CPU）

*   假设您有 20 个每个 64 位的数字字段，乘以 200M 行：如果我能正确计算，这是 32GB 的有效负载。用 64G RAM 换便宜的磁盘，永远不会遇到 IO 瓶颈。

*   确保将表空间设置为只读

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-25T13:34:38.207

您可以考虑仅存储更改的[**锚建模方法。**](http://www.anchormodeling.com)

考虑到有这么多预期的重复行，大约 95%——将行数从 100M 减少到只有 5M，消除了您的大部分顾虑。

此时主要是缓存考虑，如果整个表可以以某种方式放入缓存，事情发生得相当快。

对于“低”数据量，以下结构的查询速度比普通表慢；在某一时刻（随着数据量的增长）它变得更快。这一点取决于几个因素，但它可能很容易测试。看看这份[**关于锚建模的白皮书**](http://www.anchormodeling.com/wp-content/uploads/2010/08/Anchor_Modeling_ER09_Presentation.pdf)——参见第 10 页的图表。

![在此处输入图像描述](../Images/c6a0e1c4d29c9c86ff56d06f4e885f29.png)

就anchor-modeling而言，它相当于

![在此处输入图像描述](../Images/4ab8125416290abdd57d22a422c45d48.png)

该建模工具具有**自动代码生成**功能，但目前似乎完全支持 MS SQL 服务器，尽管下拉菜单中也有 ORACLE。它仍然可以用作代码助手。

在支持代码方面，您将需要（最少）

1.  最新透视图（自动生成）

2.  时间点函数（自动生成）

3.  将从中加载此结构的临时表（请参阅数据仓库加载[**教程）**](http://www.anchormodeling.com/?page_id=186)

4.  加载函数，从临时表到结构

5.  每个属性的修剪函数，以删除任何重复值

通过遵循自动生成的代码模式很容易创建所有这些。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T02:41:53.207

在没有持续更新/插入的情况下，索引永远不会产生负面的性能影响，只会产生积极的影响（对于这种大小的表来说是很多数量级）。

更关键的是，该模式存在严重缺陷。你想要的是

```
Claim
    claim_key
    valuation_date

ClaimValue
    claim_key (fk->Claim.claim_key)
    value_key
    value 
```

这更加节省空间，因为它只存储您实际拥有的值，并且当单行的值数量超过您分配的列数时，不需要更改架构。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-03-27T20:38:34.980

使用分区概念并在您执行的每个查询上应用分区键将节省更多的性能改进。

在我们公司，我们用分区概念解决了大量的性能问题。

另一种设计解决方案是，如果我们知道表格将非常大，请尽量不要在执行之前对表格应用更多约束并在逻辑中处理并且表格上没有很多列以避免行链接问题。

# actionscript-3 - 从 Flash (AS3) 使用 RESTful API 的简单教程？

> ID：10730266
> 
> 赞同：0
> 
> 时间：2012-05-24T02:13:27.287
> 
> 标签：actionscript-3, flash, api, rest

我为游戏开发人员构建了一个简单的 RESTful API 来执行诸如针对我们的用户存储进行身份验证、发布分数和获取排行榜等操作。它并不完美，但它有很好的文档记录，并且对于 50% 的游戏开发者来说运行良好。

其他 50% 似乎是 Flash 开发人员，他们只是不明白 RESTful API 的概念。我真的不想为这些开发人员构建一个包装器——我不是 Flash 开发人员，对成为一名开发人员没有兴趣，并且真的想保持与我们的 API 技术无关的所有内容。

谁能推荐一个关于如何为 Flash 开发人员使用 RESTful API 的好教程？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T02:33:04.640

鉴于我对这个问题的经验，我怀疑这可能与开发人员不了解 API 的事实有关，而更多地与 Flash 播放器的限制有关：它根本不支持全范围的 HTTP您可能在 RESTful API 实现中使用过的方法（至少，不是没有代理）（例如 PUT 和 DELETE）。

Flash 仅支持 GET 和 POST。

如果这确实是问题所在，您将需要为缺少的 HTTP 动词提供替代方案。我过去曾通过使用 POST 并在查询字符串中添加一个 'method=http_method' 参数来解决这个问题。

另一个问题可能是您缺少[crossdomain.xml](http://curtismorley.com/2007/09/01/flash-flex-tutorial-how-to-create-a-crossdomainxml-file/)文件。

# java-7 - 我可以在 Java 7 中创建多少个 newWatchService？

> ID：10730274
> 
> 赞同：2
> 
> 时间：2012-05-24T02:14:53.027
> 
> 标签：java-7, watchservice

我可以制作多少个 newWatchService ？

```
try{
    for(Path path : PathList) {
        watcher = path.getFileSystem().newWatchService();
    } catch (IOException e) {
        log.error(e);
    }
} 
```

--> 结果：IOExeption：打开的文件太多...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-07-20T18:17:45.023

我认为您应该只创建一个观察者服务，但要注册 [m] 任何路径。

根据 Oracle 文档 ( [https://docs.oracle.com/javase/tutorial/essential/io/walk.html](https://docs.oracle.com/javase/tutorial/essential/io/walk.html) ) 给出的示例，只创建了一个监视服务，作为 WatchDir 类的成员变量。注意“this.watcher”

```
public class WatchDir {

    private final WatchService watcher; 
```

班上的其他地方……

```
 /**
 * Creates a WatchService and registers the given directory
  */
WatchDir(Path dir, boolean recursive) throws IOException {
    this.watcher = FileSystems.getDefault().newWatchService(); 
```

相同的服务用于递归地注册给定文件夹内的所有路径。

最后，注册发生在这里......

```
/**
 * Register the given directory with the WatchService
 */
private void register(Path dir) throws IOException {
    WatchKey key = dir.register(watcher, ENTRY_CREATE, ENTRY_DELETE, ENTRY_MODIFY); 
```

# c# - 如何将列数据与 GridView 中的字符串进行比较

> ID：10730277
> 
> 赞同：1
> 
> 时间：2012-05-24T02:15:24.523
> 
> 标签：c#, asp.net, gridview

我需要根据将列的数据与字符串进行比较来隐藏列的内容。我喜欢在 Page 本身做（Page 没有后面的代码）

由于某种原因，我不能使用 Eval 或 Bind 来检索列的数据。我正在寻找类似的东西，

```
<asp:GridView  ID="GridView1" runat="server" >
  <Columns>
    <asp:TemplateField>
      <%
        if ([data from row] == aVarContainingDataToCompare){
          Response.Write("Hidden");
        } else {
          Response.Write([data from row]);
        }
      %>
    </asp:TemplateField>
    <asp:TemplateField>
      <ItemTemplate><%# Eval("AnotherData") %></ItemTemplate>
    </asp:TemplateField>
  </Columns>
</asp:GridView> 
```

我可以在不使用代码的情况下做到这一点吗

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T02:44:49.443

可以改用following吗？请注意`#`开头的标志

```
<asp:GridView ID="GridView1" runat="server">
   <Columns>
     <asp:TemplateField>
       <%# (Eval("TheColumn").ToString() == aVarContainingDataToCompare ? "Hidden": Eval("TheColumn")) %>
     </asp:TemplateField>
       ...
   </Columns>
 </asp:GridView> 
```

# delphi - 拖动模式 = 自动时无法更改行

> ID：10730278
> 
> 赞同：2
> 
> 时间：2012-05-24T02:15:32.810
> 
> 标签：delphi, drag-and-drop

我正在制作非常简单的测试应用程序，只是为了看看拖放是如何工作的。

基本上我有两个字符串网格，源和目标，并且想将一个单元格从源的选择行拖到目标，在我放下它时为其创建一个新行。

为了使事情尽可能简单，我使用拖动模式 = 自动，以便不必编写手动拖动模式处理程序。

只需几行代码，我就可以拖放，*但*只能从源代码的第一行开始。当我尝试单击不同的行以将其用作源时， OnClick 事件处理程序甚至不会触发。

简短的问题......当使用拖动模式=自动时，我可以做我想要的（拖放和更改源行）吗？

丢弃处理程序看起来像这样......

```
DestinationStringGrid.RowCount := DestinationStringGrid.RowCount + 1;
DestinationStringGrid.Cells[0, DestinationStringGrid.RowCount - 1] :=
    SourceStringGrid.Cells[0, SourceStringGrid.Row]; 
```

所以，显然，我希望能够`SourceStringGrid.Row`在点击时进行更改`SourceStringGrid`

如果问题不清楚，请告诉我。在此先感谢您的帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T02:40:53.700

您可以使用该`OnStartDrag`事件来确定拖动开始的鼠标位置：

```
procedure TForm1.StringGrid1StartDrag(Sender: TObject;
  var DragObject: TDragObject);
var
  Pt: TPoint;
  C, R: Integer;
begin
  Pt := StringGrid1.ScreenToClient(Mouse.CursorPos);
  StringGrid1.MouseToCell(Pt.X, Pt.Y, C, R);
  if (R > 0) and (R < StringGrid1.RowCount) then
    StringGrid1.Row := R;
end; 
```

# php - 通过 PHP 文件查询的表单条目和使用 JQuery AJAX 输出 PHP 文件的结果

> ID：10730280
> 
> 赞同：1
> 
> 时间：2012-05-24T02:16:14.023
> 
> 标签：php, javascript, jquery, html, ajax

这是我的带有两个文本输入的简单 html 表单：

```
 <div id="content">
      <div id="options">
        <form id="form1">
          <table>
            <tr>
              <td>Date:</td>
              <td><input name="date" type="text" id="datepicker" /></td>
            </tr>
            <tr>
              <td>Size:</td>
              <td><input name="size" type="text" /></td>
            </tr>
            <tr>
              <td colspan="2"><input name="submit" type="submit" value="Submit"/></td>
            </tr>
          </table>
        </form>
      </div>
      <div id="result"> </div>
    </div> 
```

我试图在提交时获取此表单的结果以查询 MySQL 数据库“/details.php”，然后将 PHP 文件的结果输出到 DIV“结果”中。我正在努力将变量传递给 PHP 文件并将结果输出到 DIV 中。我知道我必须使用一些 JQuery AJAX，但我正在努力让它工作。

这是我当前的 AJAX 脚本：

```
 <script>
    $('#form1').submit(function(e) {
        e.preventDefault(); // stops form from submitting naturally
        $.ajax({
            data: $(this).serialize(),
            url: '/details.php',
            success: function(response) {
                $('#result').html(response); 
            }
        });
    });
    </script> 
```

在我的 PHP 文件中，我试图通过以下方式获取变量：

```
 $date=$_GET['date'];
     $size=$_GET['size']; 
```

然后我通过 SQL 查询连接到数据库并回显结果。任何关于我可能出错的地方的建议。谢谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T02:23:01.273

**编辑**

您*必须*将 jQuery 代码包装在 domReady 事件处理程序中，如下所示：

```
$(function() {
    // all your jQuery code goes here!
}); 
```

这是一个适用于您现有代码的小提琴：http: [//jsfiddle.net/89A2m/](http://jsfiddle.net/89A2m/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T02:27:40.830

改变：

```
<form id="form1"> 
```

至

```
<form id="form1" onsubmit="return false;"> 
```

那么你在jquery ajax的“成功”中使用javascript吗

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T02:31:38.837

尝试在完成任何操作之前在 php 文件中添加回显，以确保您正在访问页面并添加

```
if (window.console != undefined) {
    console.log(response);
} 
```

就在这`$('#result').html(response);`条线下，看看 php 有什么恶意。您还可以 `console.log('whatever')`在函数的最后一行添加另一个内容，`$('#form1').submit(function(e) {`以帮助缩小范围。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-24T02:24:59.230

尝试使用回调或更改为 POST。

回调：[简单的 jQuery、PHP 和 JSONP 示例？](https://stackoverflow.com/questions/6809053/simple-jquery-php-and-jsonp-example)

使用 post... HTML

```
<form id="form1" method="POST">
          <table>
            <tr>
              <td>Date:</td>
              <td><input name="date" type="text" id="datepicker" /></td>
            </tr>
            <tr>
              <td>Size:</td>
              <td><input name="size" type="text" /></td>
            </tr>
            <tr>
              <td colspan="2"><input name="submit" type="submit" value="Submit"/></td>
            </tr>
          </table>
        </form> 
```

JS

```
<script>
$('#form1').submit(function(e) {
    e.preventDefault(); // stops form from submitting naturally
    $.ajax({
        data: $(this).serialize(),
        url: 'details.php',
        method: 'POST',
        success: function(response) {
            $('#result').html(response); 
        }
    });
});
</script> 
```

在你的 PHP 中

```
$date=$_POST['date'];
$size=$_POST['size']; 
```

# python - 使用 Django 作为 iOS 应用程序的 API 后端？

> ID：10730281
> 
> 赞同：1
> 
> 时间：2012-05-24T02:16:15.227
> 
> 标签：python, django, security

我有一个需要为其编写 API 的 iOS 应用程序，并且我想使用 Django 作为后端。但是，我不断遇到各种我不想禁用或忽略的安全功能，例如接受 POST 请求时的反 CSRF 措施。

有没有关于使用 Django 作为 API 后端的文献？一般而言，API 安全性如何？这甚至是个好主意吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T03:47:40.403

您可能想查看[django-piston](https://bitbucket.org/jespern/django-piston/wiki/Home)。它是一个不错的 django 框架，用于创建 RESTful API。

# java - Java - 如何在gridLayout中将图像从一个点平滑地动画到另一个点？

> ID：10730282
> 
> 赞同：2
> 
> 时间：2012-05-24T02:17:00.157
> 
> 标签：java, swing, animation

我正在为我的国际象棋游戏制作一个 gui，我希望这些棋子（图像）的动作具有动画效果。我希望它是一个流畅的动画，所以它开始缓慢，加速，然后减速到终点停止。现在，我的棋盘有一个带有 GridLayout 的 JFrame，以及网格中的棋子图像。是否可以在没有太多麻烦的情况下做到这一点？我是否必须研究类似openGL的东西（以前从未使用过）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T02:21:09.093

您不需要 OpenGL，因为基本的 Swing 动画可以很好地处理这个问题。只需将持有 JLabel 的棋子从使用 GridLayout 的容器提升到 glasspane，在 glasspane 上对其进行动画处理，使其移动到目标容器上方，然后将其从 glasspane 放到目标容器上（可能您的 GridLayout 包含 JPanel，所以目的地将是一个JPanel）。Swing Timer 应该可以很好地运行动画循环。

所以更准确地说，你的逻辑可能是这样的：

*   用户点击棋子，该棋子的引用存储在变量中
*   用户点击目标位置。
*   国际象棋逻辑引擎检查以确保这是用户的实际回合并且这是有效的移动
*   禁用用户在动画发生时进行任何移动的能力（关闭 MouseListener）
*   从当前的 JPanel 容器中删除 JLabel 片段，并将其放置在玻璃窗格上的相同屏幕位置
*   启动 Swing Timer 做动画，从当前容器的位置移动到新的位置。
*   计时器将调用 setLocation 将其从 A 移动到 B
*   计时器完成后，从玻璃板上取出一块并放入新容器中
*   告诉国际象棋引擎OK让下一个玩家移动。

说了这么多，我自己的偏好是简单地允许用户将 JLabel 从源拖动到目的地，并让他的拖动成为动画。我有代码显示如何在这个站点的某个地方执行此操作。对我来说，这是用户移动棋子的一种更自然的方式。稍等，我去找我的链接。

链接在这里：[does-adding-a-jlabel-to-a-jpanel-hide-the-jpanel](https://stackoverflow.com/a/4687759/522444)

# mkmapview - 在 Titanium 中的地图视图上禁用缩放控件

> ID：10730283
> 
> 赞同：0
> 
> 时间：2012-05-24T02:17:02.307
> 
> 标签：mkmapview, titanium, android-mapview, titanium-mobile

我正在使用 Titanium 中的地图视图，并且我想禁用缩放控件，我应该修改哪个属性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T08:45:29.680

如果您不让用户与地图交互，那么我猜 Mapview 不是正确的选择。你想要的可能是一个带有 StaticMap 文件的 ImageView。-> [https://developers.google.com/maps/documentation/staticmaps/?hl=de](https://developers.google.com/maps/documentation/staticmaps/?hl=de)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-18T00:14:14.020

只需在其前面放置一个透明视图，它将拦截任何触摸手势。

# iphone - 切换视图控制器，但旧屏幕留在后面

> ID：10730293
> 
> 赞同：0
> 
> 时间：2012-05-24T02:19:16.600
> 
> 标签：iphone, ios, uiview

我有这种通常有效的方法，但最近它给我带来了麻烦。

我想做的是在没有任何动画的情况下切换视图。出于某种原因，每当我切换视图时，旧屏幕都会留下一些东西，例如按钮或文本字段。

每次切换视图时如何让它们消失？

这是我到目前为止所拥有的

。H

```
@class HighScoreViewController;

@interface StartUpScreen : UIViewController {
    HighScoreViewController *highScoreViewController;
@property (nonatomic, retain) HighScoreViewController *highScoreViewController;
@end 
```

.m

```
#import "HighScoreViewController.h"

@implementation StartUpScreen

-(void) viewDidLoad {
    UIButton *highScoreButton = [UIButton buttonWithType:UIButtonTypeRoundedRect];
    highScoreButton.frame = CGRectMake(219, 0, 99, 55);
    [highScoreButton addTarget:self
                        action:@selector(goToHighScoresViewController)
              forControlEvents:UIControlEventTouchDown];
    [self.view addSubview:highScoreButton];
}

-(void)goToHighScoresViewController {
    HighScoreViewController *highScore = [[HighScoreViewController alloc] initWithNibName:@"HighScoreViewController" bundle:nil];
    self.highScoreViewController = highScore;

    //[self presentModalViewController:highScore animated:YES];

    [self.view insertSubview:highScore.view atIndex:0];
    [highScore release];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T04:06:17.653

取消注释

```
[self presentModalViewController:highScore animated:NO]; 
```

并注释掉：

```
[self.view insertSubview:highScore.view atIndex:0]; 
```

线条和一切都会很好，花花公子。

# vba - 使用 VBA 代码（宏）连接引用（工具>引用）

> ID：10730300
> 
> 赞同：3
> 
> 时间：2012-05-24T02:20:56.583
> 
> 标签：vba, reference, connect

我想使用 VBA 代码以编程方式将一些引用连接到我的 VBA 项目，即无需使用工具>引用手动设置引用。这可能吗？例如 Microsoft office 12.0 对象库。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-24T07:29:47.187

您没有提到 Office 应用程序。在 MS Access 中，您可以使用：

```
ReferenceFromFile "C:\Program Files\Common Files\Microsoft Shared\OFFICE14\MSO.DLL" 
```

也就是说，为您要添加的引用提供完整路径。

来自：[http ://wiki.lessthandot.com/index.php/Add,_Remove,_Check_References](http://wiki.lessthandot.com/index.php/Add,_Remove,_Check_References)

同样，在 Excel 中：

```
ActiveWorkbook.VBProject.References.AddFromFile "C:\Program Files\Common Files\Microsoft Shared\OFFICE14\MSO.DLL" 
```

要在 Excel 中列出引用：Dim ref As Reference

```
For Each ref In ActiveWorkbook.VBProject.References
    Debug.Print ref.Description; " -- "; ref.FullPath
Next 
```

这将在我的机器上的一个特定工作簿上返回以下内容：

```
Visual Basic For Applications -- C:\PROGRA~1\COMMON~1\MICROS~1\VBA\VBA7\VBE7.DLL
Microsoft Excel 14.0 Object Library -- C:\Program Files\Microsoft Office\Office14\EXCEL.EXE
OLE Automation -- C:\Windows\system32\stdole2.tlb
Microsoft Forms 2.0 Object Library -- C:\Windows\system32\FM20.DLL
Microsoft ActiveX Data Objects 6.0 Library -- C:\Program Files\Common Files\System\ado\msado15.dll
Microsoft XML, v6.0 -- C:\Windows\System32\msxml6.dll
Microsoft Office 14.0 Access database engine Object Library -- C:\Program Files\Common Files\Microsoft Shared\OFFICE14\ACEDAO.DLL
Microsoft Visual Basic for Applications Extensibility 5.3 -- C:\Program Files (x86)\Common Files\Microsoft Shared\VBA\VBA6\VBE6EXT.OLB
Microsoft Office 14.0 Object Library -- C:\Program Files\Common Files\Microsoft Shared\OFFICE14\MSO.DLL 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-09-23T01:36:03.823

引用完整路径充满危险，并且当代码在不同计算机或不同版本中使用时会给您带来问题。

最好使用在大多数（但不是所有情况下）对于不同版本的应用程序保持相同的 GUID。

这很有帮助，特别是如果您为 Excel 2010 编写了需要在 Excel 2010 和 Excel 2013 中使用的代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-05-22T15:45:34.313

在另一个位置可以找到 MSO.dll 文件：

> C:\Program Files (x86)\Common Files\microsoft shared\oFFICE11

只需将 Tool > References >Browse 设置到上述路径并找到 MSO.dll

# r - 如何在R中绘制多条线

> ID：10730303
> 
> 赞同：11
> 
> 时间：2012-05-24T02:21:14.633
> 
> 标签：r, plot

我有一个看起来像这样的数据：

```
#d  TRUE    FALSE   Cutoff
4   28198   0   0.1
4   28198   0   0.2
4   28198   0   0.3
4   28198   13  0.4
4   28251   611 0.5
4   28251   611 0.6
4   28251   611 0.7
4   28251   611 0.8
4   28251   611 0.9
4   28251   611 1
6   19630   0   0
6   19630   0   0.1
6   19630   0   0.2
6   19630   0   0.3
6   19630   0   0.4
6   19636   56  0.5
6   19636   56  0.6
6   19636   56  0.7
6   19636   56  0.8
6   19636   56  0.9
6   19636   56  1 
```

所以我想根据真（Y 轴）和假（X 轴）绘制它们。

这是我希望它大致出现的方式。 ![这是我希望它大致出现的方式](../Images/cd3c1c70be04966b3bcb0bc88fdbfcce.png)

正确的方法是什么？我下面的代码失败

```
dat<-read.table("mydat.txt", header=F);
dis     <- c(4,6);
linecols <-c("red","blue");
plot(dat$V2 ~ dat$V3, data = dat,  xlim = c(0,611),ylim =c(0,28251), type="l")

for (i in 1:length(dis)){
datax <- subset(dat, dat$V1==dis[i], select = c(dat$V2,dat$V3))
lines(datax,lty=1,type="l",col=linecols[i]);
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-24T02:38:06.510

由于您的数据已经是长格式并且无论如何我都喜欢 ggplot 图形，因此我建议使用该路径。在读取您的数据后（注意`TRUE`和`FALSE`不是有效名称，因此 R 将 a 附加`.`到列名），以下应该有效：

```
require(ggplot2)
ggplot(dat, aes(FALSE., TRUE., colour = as.factor(d), group = as.factor(d))) + 
  geom_line() 
```

ggplot2网站[充满](http://had.co.nz/ggplot2/)了很好的技巧。还要注意[这个关于 SO 的搜索查询，](https://stackoverflow.com/search?q=[r]+add+multiple+lines+plot)以获取有关相关主题的许多其他好的提示。

![在此处输入图像描述](../Images/6de8850fcdca176182c545ad4a3a6ad1.png)

为了记录在案，这是我在修改原始代码时解决问题的方法：

```
colnames(dat)[2:3] <- c("T", "F")

dis <- unique(dat$d)

plot(NA, xlim = c(0, max(dat$F)), ylim = c(0, max(dat$T)))
for (i in seq_along(dis)){
  subdat <- subset(dat, d == dis[i])
  with(subdat, lines(F,T, col = linecols[i]))
}
legend("bottomright", legend=dis, fill=linecols) 
```

![在此处输入图像描述](../Images/ac19cb75bbb93a12b7b1d377264ee7dc.png)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-24T02:59:08.043

`dat`这是一个基本的 R 方法，假设在此示例中调用了您的数据：

```
plot(1:max(dat$false), xlim = c(0,611),ylim =c(19000,28251), type="n")

apply(
rbind(unique(dat$d),1:2),
#the 1:2 here are your chosen colours
2,
function(x) lines(dat$false[dat$d==x[1]],dat$true[dat$d==x[1]],col=x[2])
) 
```

结果：

![在此处输入图像描述](../Images/605c867239625d182ff0fa86201212fe.png)

编辑 - 虽然接受使用小写 true/false 作为变量名，但它可能仍然不是最好的编码实践。

# remember-me - Kohana 3.2 Auth ORM：我似乎无法使用“记住我”选项集保持登录状态

> ID：10730304
> 
> 赞同：3
> 
> 时间：2012-05-24T02:21:17.890
> 
> 标签：remember-me, kohana-auth, kohana-3.2

我在使用 Auth / ORM 和 auto_login 时遇到问题。我将生命周期设置为两周，但无论浏览器是否关闭，我都会在大约一个小时后注销。事实上，它是基于时间的，因为会话确实保持不变，即使在浏览器关闭时也是如此。

我已经设置了这样的东西（任何帮助将不胜感激！！！）：

引导程序.php

```
Cookie::$salt = 'some random string here'; 
```

配置/auth.php

```
<?php defined('SYSPATH') or die('No direct access allowed.');

return array(

'driver'       => 'ORM',
'hash_method'  => 'sha256',
'hash_key'     => '<another random string>',
'lifetime'     => 1209600, // TWO WEEKS, NO?
'session_type' => Session::$default,
'session_key'  => 'auth_user',

// Username/password combinations for the Auth File driver
'users' => array(
),

); 
```

类/控制器/auth.php

```
public function action_login() { // Check to make sure the user isn't already logged in... if (Auth::instance()->logged_in() || Auth::instance()->auto_login()) {
$this->request->redirect($this->request->referrer()); }

$referrer = base64_encode($this->request->referrer());

$post = $this->request->post();
if (!empty($post))
{
    $remember = isset($post['remember']); // <-- This value has been verified
    Auth::instance()->login(Arr::get($post, 'email'), Arr::get($post, 'password'), $remember);

    if (Auth::instance()->logged_in())
    {
        $this->request->redirect(base64_decode(Arr::get($post, 'referrer')));
    }
    else
    {
        $this->view->set('error', true);
    }

    if (isset($post['referrer']))
    {
        $referrer = Arr::get($post, 'referrer');
    }
}

$this->view = Template::factory('auth/login');
$this->view->set('referrer', $referrer);

} 
```

类/控制器/website.php

```
class Controller_Website extends Controller { 
    public function before()
    {
        $parent_before = parent::before();

        if (Auth::instance()->logged_in() || Auth::instance()->auto_login()) //<-- isn't this where the magic is supposed to be happening?!?!
        {
            $this->user = Auth::instance()->get_user();
        }
        elseif ($this->require_auth && !in_array($this->request->action(), $this->auth_allow_actions))
        {
            $this->request->redirect('/auth/login');
        }

        return $parent_before;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T15:17:00.777

尝试像这样设置 $remember：

```
$remember = array_key_exists('remember', $this->request->post()) ? (bool) $this->request->post('remember') : FALSE; 
```

# c# - 为什么在尝试注册 WPF/C# 中的所有事件时出现构建错误？

> ID：10730307
> 
> 赞同：0
> 
> 时间：2012-05-24T02:21:49.750
> 
> 标签：c#, wpf, delegates, event-handling, compiler-errors

下面是我窗口中的构造函数和事件处理程序。

```
 public MyWindow() {
        InitializeComponent();

        foreach (RoutedEvent routedEvent in EventManager.GetRoutedEvents())
        {
            EventManager.RegisterClassHandler(typeof(TestUnbuggerWindow), routedEvent, OnRoutedEvent, true);
        }
    }

    public void OnRoutedEvent(Object sender, RoutedEventArgs args)
    {
    } 
```

我正在尝试预览*所有*事件，因为我正在学习 WPF，我认为这可能会暴露一些看不见的情况。无论如何，我收到以下构建错误：

```
Error   1   The best overloaded method match for 'System.Windows.EventManager.RegisterClassHandler(System.Type, System.Windows.RoutedEvent, System.Delegate, bool)' has some invalid arguments
Error   2   Argument 3: cannot convert from 'method group' to 'System.Delegate' 
```

[我得到了从这个网站](http://blog.pixelingene.com/2008/08/techniques-for-ui-auditing-on-wpf-apps/)注册所有事件的循环。

我相信问题是由方法签名不匹配引起的，但我不确定。有人可以为我解释一下吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T02:37:18.507

您需要明确使用处理程序

```
EventManager.RegisterClassHandler(typeof(TestUnbuggerWindow), 
     routedEvent, new RoutedEventHandler(OnRoutedEvent), true); 
```

这是因为您的编译器需要知道您想要什么类型的处理程序，并且由于签名采用一种`Delegate`类型，因此它无法推断出您想要的类型`RoutedEventHandler`。

# javascript - 查找 HTML 页面中的所有文本节点

> ID：10730309
> 
> 赞同：60
> 
> 时间：2012-05-24T02:22:04.600
> 
> 标签：javascript, html

对于[这个问题](https://stackoverflow.com/questions/10729983/highlight-word-in-html-text-but-not-markup/10730063#10730063)，我需要找到特定节点下的所有文本节点。我*可以*这样做：

```
function textNodesUnder(root){
  var textNodes = [];
  addTextNodes(root);
  [].forEach.call(root.querySelectorAll('*'),addTextNodes);
  return textNodes;

  function addTextNodes(el){
    textNodes = textNodes.concat(
      [].filter.call(el.childNodes,function(k){
        return k.nodeType==Node.TEXT_NODE;
      })
    );
  }
} 
```

然而，鉴于使用 XPath 可以简单地查询`.//text()`并完成这一事实，这似乎并不优雅。

**在 IE9+、Safari5+、Chrome19+、Firefox12+、Opera11+ 上获取 HTML 文档中特定元素下的所有文本节点的最简单方法是什么？**

*“最简单”被粗略地定义为“高效且简短，无需打高尔夫球”。*

* * *

## 回答 #1

> 赞同：165
> 
> 时间：2012-05-24T03:32:34.033

*基于@kennebec 的回答，相同逻辑的稍微更严格的实现：*

```
function textNodesUnder(node){
  var all = [];
  for (node=node.firstChild;node;node=node.nextSibling){
    if (node.nodeType==3) all.push(node);
    else all = all.concat(textNodesUnder(node));
  }
  return all;
} 
```

*但是，使用更快、更紧凑、更优雅的方法是[`createTreeWalker`](https://developer.mozilla.org/en/DOM/document.createTreeWalker)浏览器会为您过滤掉除文本节点之外的所有内容：*

```
function textNodesUnder(el){
  var n, a=[], walk=document.createTreeWalker(el,NodeFilter.SHOW_TEXT,null,false);
  while(n=walk.nextNode()) a.push(n);
  return a;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-24T02:31:11.033

```
function deepText(node){
    var A= [];
    if(node){
        node= node.firstChild;
        while(node!= null){
            if(node.nodeType== 3) A[A.length]=node;
            else A= A.concat(deepText(node));
            node= node.nextSibling;
        }
    }
    return A;
} 
```

# python - Amazon EMR 上的 Pydoop

> ID：10730311
> 
> 赞同：8
> 
> 时间：2012-05-24T02:22:13.740
> 
> 标签：python, amazon-web-services, hadoop, amazon-emr

如何在 Amazon EMR 上使用[Pydoop ？](https://crs4.github.io/pydoop/)

我试着用谷歌搜索这个话题无济于事：这有可能吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-04T22:15:41.397

我终于得到了这个工作。一切都发生在主节点上...作为用户 hadoop ssh 到该节点

你需要一些包：

```
sudo easy_install argparse importlib
sudo apt-get update
sudo apt-get install libboost-python-dev 
```

构建东西：

```
wget http://apache.mirrors.pair.com/hadoop/common/hadoop-0.20.205.0/hadoop-0.20.205.0.tar.gz
wget http://sourceforge.net/projects/pydoop/files/Pydoop-0.6/pydoop-0.6.0.tar.gz
tar xvf hadoop-0.20.205.0.tar.gz
tar xvf pydoop-0.6.0.tar.gz

export JAVA_HOME=/usr/lib/jvm/java-6-sun 
export JVM_ARCH=64 # I assume that 32 works for 32-bit systems
export HADOOP_HOME=/home/hadoop
export HADOOP_CPP_SRC=/home/hadoop/hadoop-0.20.205.0/src/c++/
export HADOOP_VERSION=0.20.205
export HDFS_LINK=/home/hadoop/hadoop-0.20.205.0/src/c++/libhdfs/

cd ~/hadoop-0.20.205.0/src/c++/libhdfs
sh ./configure
make
make install
cd ../install
tar cvfz ~/libhdfs.tar.gz lib
sudo tar xvf ~/libhdfs.tar.gz -C /usr

cd ~/pydoop-0.6.0
python setup.py bdist
cp dist/pydoop-0.6.0.linux-x86_64.tar.gz ~/
sudo tar xvf ~/pydoop-0.6.0.linux-x86_64.tar.gz -C / 
```

保存这两个压缩包，以后可以跳过构建部分，只需执行以下操作即可安装（需要弄清楚如何执行此操作，这是在多节点集群上安装的 boostrap 选项）

```
sudo tar xvf ~/libhdfs.tar.gz -C /usr
sudo tar xvf ~/pydoop-0.6.0.linux-x86_64.tar.gz -C / 
```

然后，我能够使用[成熟的 Hadoop API](http://pydoop.sourceforge.net/docs/index.html "成熟的 Hadoop API")运行示例程序 （在修复了构造函数中的错误以便它调用之后`super(WordCountMapper, self)`）。

```
#!/usr/bin/python

import pydoop.pipes as pp

class WordCountMapper(pp.Mapper):

  def __init__(self, context):
    super(WordCountMapper, self).__init__(context)
    context.setStatus("initializing")
    self.input_words = context.getCounter("WORDCOUNT", "INPUT_WORDS")

  def map(self, context):
    words = context.getInputValue().split()
    for w in words:
      context.emit(w, "1")
    context.incrementCounter(self.input_words, len(words))

class WordCountReducer(pp.Reducer):

  def reduce(self, context):
    s = 0
    while context.nextValue():
      s += int(context.getInputValue())
    context.emit(context.getInputKey(), str(s))

pp.runTask(pp.Factory(WordCountMapper, WordCountReducer)) 
```

我将该程序上传到存储桶并调用它运行。然后我使用了以下 conf.xml：

```
<?xml version="1.0"?>
<configuration>

<property>
  <name>hadoop.pipes.executable</name>
  <value>s3://<my bucket>/run</value>
</property>

<property>
  <name>mapred.job.name</name>
  <value>myjobname</value>
</property>

<property>
  <name>hadoop.pipes.java.recordreader</name>
  <value>true</value>
</property>

<property>
  <name>hadoop.pipes.java.recordwriter</name>
  <value>true</value>
</property>

</configuration> 
```

最后，我使用了以下命令行：

```
hadoop pipes -conf conf.xml -input s3://elasticmapreduce/samples/wordcount/input -output s3://tmp.nou/asdf 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-06-10T05:43:38.403

给出的答案只是部分正确，但解决方案比这样做更简单：

将此代码复制到您在计算机上创建的 bash 文件中：

## 引导程序.sh：

```
#!/bin/bash
pip install pydoop 
```

完成写入此文件后，将其上传到 s3 存储桶。

然后您可以在 emr 添加引导操作：
选择“自定义操作”为您的 s3 存储桶提供路径。而且，您的 emr 集群中安装了一个 pydoop。

# java - 如何在不暂停程序的情况下获取角色

> ID：10730314
> 
> 赞同：2
> 
> 时间：2012-05-24T02:22:29.310
> 
> 标签：java, methods, char

我正在为我的计算机课制作一个类似 pac man 的程序，这就是我到目前为止所拥有的......我想在程序中添加幽灵。但我不知道如何做到这一点，以便程序不会停止一切并等待用户输入。就像我使用 c.getchar() 时一样，它会停止程序并等待用户输入。还有什么我可以使用的不会停止程序的东西，所以鬼可能会追逐吃豆人……请帮忙！

```
// The "Pac_man" class.
import java.awt.*;
import hsa.Console;

public class Pac_man
{
    static Console c;           // The output console

    public static void main (String[] args)
    {
        c = new Console ();

        int outline_x = 189, outline_y = 99, body_x = 190, body_y = 100, eye_x = 208, eye_y = 106, outline_position_x = 26;
        int body_position_x = 30, p = 1, point_x = 0, point_y = 0, run_time = 0, score = 0, random_number, life = 3;
        char key_entered;

        background();
        redraw (score, outline_x, outline_y, outline_position_x, body_x, body_y, body_position_x, life);
        c.fillOval (eye_x, eye_y, 4, 4); // eye

        do 
        {
            key_entered = c.getChar();

            if (key_entered == 'd' || key_entered == 'D')
            {
                outline_x = outline_x + 10;
                body_x = body_x + 10;
                eye_x = eye_x + 10;
                outline_position_x = 26;
                body_position_x = 30;

                redraw (score, outline_x, outline_y, outline_position_x, body_x, body_y, body_position_x, life);
                c.fillOval (eye_x, eye_y-1, 4, 4); // eye
            }

             if (key_entered == 'a' || key_entered == 'A')
            {
                outline_x = outline_x - 10;
                body_x = body_x - 10;
                eye_x = eye_x - 10;
                outline_position_x = 206;
                body_position_x = 210;

                redraw (score, outline_x, outline_y, outline_position_x, body_x, body_y, body_position_x, life);
                c.fillOval (eye_x-6, eye_y, 4, 4); // eye

            }

            if (key_entered == 'w' || key_entered == 'W')
            {
                outline_y = outline_y - 10;
                body_y = body_y - 10;
                eye_y = eye_y - 10;
                outline_position_x = 116;
                body_position_x = 120;

                redraw (score, outline_x, outline_y, outline_position_x, body_x, body_y, body_position_x, life);
                c.fillOval (eye_x+2, eye_y+2, 4, 4); // eye
            }

            if (key_entered == 's' || key_entered == 'S')
            {
                outline_y = outline_y + 10;
                body_y = body_y + 10;
                eye_y = eye_y + 10;
                outline_position_x = 296;
                body_position_x = 300;

                redraw (score, outline_x, outline_y, outline_position_x, body_x, body_y, body_position_x, life);
                c.fillOval (eye_x+3, eye_y+8, 4, 4); // eye
            }

            if (key_entered == 'p' || key_entered == 'P')
            {   
                c.setColor (Color.blue);
                Font f2 = new Font ("Freestyle Script", Font.BOLD, 56);
                c.setFont (f2);
                c.drawString ("GAME PAUSED", 173, 250);

                for (int i = 1; p == i ; i++)
                {
                    key_entered = c.getChar();
                    p++;

                    if (key_entered == 'p' || key_entered == 'P')
                    {
                        p = 0;
                        background();
                        redraw (score, outline_x, outline_y, outline_position_x, body_x, body_y, body_position_x, life);
                        c.fillOval (eye_x, eye_y, 4, 4); // eye
                    }
                    c.setColor (Color.black);
                }
                p = 1;
            }
            random_number = (int) (Math.random()* 100)+1;

            //point start
            if (run_time == score)
            {
            do
            {
                point_x = (int)(Math.random() * 1000) + 1;
            }

            while (point_x < 65 || point_x > 546);

            do
            {
                point_y = (int)(Math.random() * 1000) + 1;
            }

            while (point_y < 90 || point_y > 430);

            run_time ++;

            }
            c.setColor (Color.green);
            c.fillOval (point_x, point_y, 8, 8);
            // point end

            if (outline_x  > (point_x-32) && outline_x < (point_x+4) && outline_y > (point_y-29) && outline_y < (point_y+7))
            {
                score = score + 1;
            }

            if (outline_x < 59)
            {
                outline_x = 548;
                body_x = 548;
                eye_x = 569;
            }

            if (outline_x > 549)
            {
                outline_x = 60;
                body_x = 60;
                eye_x = 78;
            }

            if (outline_y < 89)
            {
                outline_y = 419;
                body_y = 419;
                eye_y = 425;
            }

            if (outline_y > 420)
            {
                outline_y = 90;
                body_y = 90;
                eye_y = 98;
            }

        }

        while (1 == 1);

    } // main method

    public static void background ()
    {
        c.setColor (new Color (0, 0, 0));
        c.fillRect (0, 0, 640, 500);
        c.setColor (new Color (35, 47, 210)); 
        Font f3 = new Font ("Footlight MT Light", Font.BOLD, 16);
        c.setFont (f3);
        c.drawString ("a = move left", 10, 485);
        c.drawString ("d = move right", 125, 485);
        c.drawString ("s = move down", 255, 485);
        c.drawString ("w = move up", 385, 485);
        c.drawString ("p = pause game", 500, 485);

    }

    public static void redraw (int score, int outline_x, int outline_y, int outline_position_x, int body_x, int body_y, int body_position_x, int life)
    {   
        c.setColor (new Color (0, 0, 0));
        c.fillRect (50, 50, 10, 400); // left border
        c.fillRect (580, 50, 12, 400); // right border
        c.fillRect (50, 450, 540, 15); // bottom border
        c.fillRect (50, 40, 540, 10); // top border
        c.setColor (new Color (35, 47, 210));
        Font f2 = new Font ("Footlight MT Light", Font.BOLD, 45);
        c.setFont (f2);
        c.drawString ("Welcome to Pac-Man", 100, 37);
        c.setColor (new Color (125, 23, 137)); 
        c.fillRect (60, 50, 520, 400);
        Font f3 = new Font ("Footlight MT Light", Font.BOLD, 24);
        c.setFont (f3);
        c.setColor (new Color (0, 0, 0));
        c.drawString("SCORE : " + score, 61, 75);
        c.drawString ("Lives :", 380, 75);
        lives (life);
        c.fillRect (50, 85, 550, 5);// line
        c.setColor (Color.black);// pac man drawing begins
        c.fillArc (outline_x, outline_y, 35, 35, outline_position_x, 320); // outline
        c.setColor (Color.yellow);
        c.fillArc (body_x, body_y, 32, 32, body_position_x, 310); // body
        c.setColor (Color.black);// pac man drawing ends
    }

    public static int lives (int life)
    {
        int x1 = 470;

        for (int i = 1; i <= life; i++)
        {
            c.setColor (Color.black);// pac man drawing begins
            c.fillArc (x1, 55, 30, 30, 26, 320); // outline
            c.setColor (Color.yellow);
            c.fillArc (x1, 55, 28, 28, 30, 310); // body
            c.setColor (Color.black);// pac man drawing begins
            c.fillOval (x1+15, 59, 4, 4); // eye

            x1+=35;
        }
        return life;   
    }

} // Pac_man class 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T02:25:06.367

我没有阅读您的代码（将其缩短到相关部分以使其更具可读性），但我觉得您以错误的方式处理此问题。您可能想要使用[KeyListener](http://docs.oracle.com/javase/tutorial/uiswing/events/keylistener.html)。这将允许您在程序运行时“监听”同时按下的键。

```
public class KeyEventDemo implements KeyListener {
        typingArea = new JTextField(20);
        typingArea.addKeyListener(this);

    /** Handle the key typed event from the text field. */
    public void keyTyped(KeyEvent e) {
        // snip
    }

    /** Handle the key-pressed event from the text field. */
    public void keyPressed(KeyEvent e) {
        // snip
    }

    /** Handle the key-released event from the text field. */
    public void keyReleased(KeyEvent e) {
        // snip
    } 
```

如果您有焦点问题，我建议您还阅读[如何使用键绑定](http://docs.oracle.com/javase/tutorial/uiswing/misc/keybinding.html)来替代 KeyListener。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T02:34:57.527

看起来您的老师制作了一个自定义控制台类，您用它来绘制吃豆人游戏？

我用谷歌搜索了“hsa.Console”并找到了一些Javadoc。所以假设我是你正在使用的控制台类：[http ://www.brentwoodhigh.com/apcs/holt/hsa-javadoc/Console.html](http://www.brentwoodhigh.com/apcs/holt/hsa-javadoc/Console.html)

根据您老师的 Javadoc，[控制台](http://www.brentwoodhigh.com/apcs/holt/hsa-javadoc/Console.html)实现了[KeyListener](http://docs.oracle.com/javase/1.5.0/docs/api/java/awt/event/KeyListener.html)，因此您可以使用自己的控制台子类化他的控制台并在那里监听关键事件。

例子：

```
class MyConsole extends Console {
   public void keyPressed(KeyEvent e) {
      super.keyPressed(e); // Call your teacher's code in case he does something
      // set some shared variable with the key that was typed
      // you'll read this shared variable in your main loop
   }
} 
```

KeyEvent javadoc：[http ://docs.oracle.com/javase/1.5.0/docs/api/java/awt/event/KeyEvent.html](http://docs.oracle.com/javase/1.5.0/docs/api/java/awt/event/KeyEvent.html)

在你的主要你会做：

```
c = new MyConsole(); 
```

代替

```
c = new Console(); 
```

在您的主循环中，您将要轮询输入的最后一个键...从技术上讲，您需要一个共享`volatile`变量，但我猜您的老师要么不知道，要么很早就向您介绍了线程。

您的文件将类似于：

```
// The "Pac_man" class.
import java.awt.*;
import hsa.Console;

public class Pac_man {
   public static volatile char lastChar;
   static Console c;
   public static void main(String [] args) {
       c = new MyConsole();
       do {
          // read whatever character may have been set
          // by the console
          char key = lastChar;
          ...your event loop logic...
       } while (running);
   }
}
static class MyConsole extends Console {
   // this method is called by the system whenever a key has been pressed
   public void keyPressed(KeyEvent e) {
      // call your prof's version of keyPressed
      super.keyPressed(e); 

      // set the shared lastChar variable
      Pac_man.lastChar = e.getKeyChar();
   }
} 
```

当然，无法访问您老师制作的图书馆，我只能对可行的方法进行有根据的猜测。

# ruby - gsub 时在 ruby 中分配内存（NoMemoryError）

> ID：10730315
> 
> 赞同：0
> 
> 时间：2012-05-24T02:22:32.273
> 
> 标签：ruby, regex, out-of-memory, gsub

我有一个 js 文件，它使用了一些变量替换，现在我想反过来替换它们。

由于该文件已经包含用于替换的“键值”，所以我想先提取它们然后进行替换。

这是文件（仅作为示例）：

```
.......
//mapperstart
var pj = "shape", qj = "version", rj = "toFixed";  //this line is what I want to find
//mapperend
function (){
    //32[rj](10);
}
......
//mapperstart
var kl = ll = "moveend", ml = "move", nl = "movestart"; //this line is what I want to find
//mapperend
...... 
```

我在“键值”行之前和之后添加注释，然后使用以下 ruby​​ 代码进行替换：

```
def replaceVariable(fname)
    content=IO.read(fname);
    key_value={};

    if(matchData=content.scan(/\/\/mapperstart(.+?)\/\/mapperend/m))
        matchData.each do |md|
            md=md[0].gsub(/\s+var\s+/,'').gsub(';','');
            md_ary=md.split(',');
            if(md_ary && md_ary.length>0)
                md_ary.each do |kv|
                    if(kv.include?('='))
                        kv_pair=kv.split('=');
                        key=kv_pair[0].strip;
                        value=kv_pair[1].strip;
                        if(key_value.has_key?(key))
                            puts 'repeat key:'+key
                        else
                        key_value[key]=value
                        end
                    end
                end
            end
        end

        key_value.each do |key,value|
            pattern=Regexp.new('['+key+']');
            content.gsub!(pattern,value);
            puts 'replace:'+key
        end

        ext_name=File.extname(fname);
        puts ext_name
        File.open(fname.gsub(ext_name,'')+"_fix"+ext_name,'aw') do |f|
            f.puts content
        end
    end
end

replaceVariable('../file.js'); 
```

但是我总是得到`in 'gsub!': failed to allocate memory (NoMemoryError)`错误。

如何解决？

# ios - 关联链接到 iTunes 商店中不存在的应用程序

> ID：10730317
> 
> 赞同：1
> 
> 时间：2012-05-24T02:22:35.910
> 
> 标签：ios, affiliate

我查看了一些回答相关问题的问题（包括[这个](https://stackoverflow.com/questions/8548984/make-an-affiliate-link-to-the-itunes-store-without-redirects)问题），但并不完全相同。是否可以链接到 iTunes 商店中尚不存在的应用程序并使用附属链接？[我知道可以使用http://itunes.com/apps/amazon](http://itunes.com/apps/amazon)之类的链接链接到应用程序，但这些链接不使用附属链接。而且我知道我可以通过链接共享生成链接来生成附属链接，但这不适用于尚未上线的应用程序。

有没有办法做到这两点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T05:33:54.227

是的，您基本上可以对任何 iTunes 链接进行附属编码。有两种方法可以做到这一点。

手动 - 使用 Link Maker 中的“批量”工具（请务必从您选择的附属网络访问 Link Maker，否则不会传递适当的附属跟踪参数）。

以编程方式 - 遵循此处列出的说明 - [http://www.apple.com/itunes/affiliates/resources/documentation/linking-to-the-itunes-music-store.html#AddingAffiliateTracking](http://www.apple.com/itunes/affiliates/resources/documentation/linking-to-the-itunes-music-store.html#AddingAffiliateTracking)

# ruby-on-rails - 向 Ruby 中的现有类添加静态方法

> ID：10730329
> 
> 赞同：0
> 
> 时间：2012-05-24T02:24:12.320
> 
> 标签：ruby-on-rails, ruby

我的文件包含：

```
module BlahA
   module BlahB
      class Note
         def some_method
         end
      end
   end
end 
```

我想向 Note 类添加一个静态方法，所以我将以下内容添加到另一个文件中

```
module BlahA
   module BlahB
      class Note
         def self.some_static_method
         end
      end
   end
end 
```

当我尝试称它为

```
BlahA::BlahB::Note.some_static_method 
```

我明白了

```
undefined method `some_static_method' for BlahA::BlahB::Note:Class 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T02:26:05.893

要创建静态方法，您可以将其定义为

```
def self.some_static_method
  #something
end 
```

并确保`some_file.rb`在您的文件中是必需的。

# javascript - CRM Javascript 上的空 XML

> ID：10730331
> 
> 赞同：0
> 
> 时间：2012-05-24T02:24:17.530
> 
> 标签：javascript, crm

我想从另一个实体获取值，所以我可以用它来验证。但是当我尝试调试 javascript 时，XML 返回错误，我不知道为什么。我尝试使用调试器，但它在`var xHReq = new ActiveXObject("Msxml2.XMLHTTP");`. 返回正确的第一个 XML `var xml = "<?xml version='1.0' encoding='utf-8'?>" +`，但是当我继续时`var xHReq = new ActiveXObject("Msxml2.XMLHTTP");`，它返回空。检查这个链接，希望你能帮助我完成这个..谢谢。

[http://pastebin.com/jxhU2WgJ](http://pastebin.com/jxhU2WgJ)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T12:15:33.113

认为我发现了问题。不知道为什么你的调试建议它`xml`为空 - 我在我的系统上尝试过它，它很好（这很有意义 - 你的代码中没有任何东西会重置`xml`变量）。

线索在错误消息中： `...Instance validation error: \'eq\' is not a valid value for ConditionOperator`

**解析度**

```
"<q1:Operator>eq</q1:Operator>" + 
```

对此：

```
"<q1:Operator>Equal</q1:Operator>" + 
```

# hadoop - EMR 作业中的自定义 RecordReader

> ID：10730334
> 
> 赞同：0
> 
> 时间：2012-05-24T02:24:37.000
> 
> 标签：hadoop, amazon-web-services, emr

如何指定`RecordReader`要在 Amazon EMR 上的作业流中使用的自定义项？

**注意：**这里是 Hadoop 新手。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T04:42:59.120

您在驱动程序类中指定输入格式（该类包含作业的“主要”。记录阅读器是您的输入格式的逻辑部分，它实际上将其返回给映射任务。
我认为这不是 EMR 特有的东西。

# java - 运行我的 Java 代码，没有任何反应

> ID：10730337
> 
> 赞同：2
> 
> 时间：2012-05-24T02:25:00.370
> 
> 标签：java, swing, jbutton

```
public class Start {

public static void main(String[] args) {
    JFrame j = new JFrame();
    final Graphics g = j.getGraphics();
    JButton jb = new JButton("Start");
    j.add(jb);
    jb.addActionListener(new ActionListener() {

        @Override
        public void actionPerformed(ActionEvent arg0) {
            HeavenlyBiome.spread(g);

        }
    });

}

 }
 ...
 public class HeavenlyBiome {
static Random r = new Random();
public static void spread(Graphics g){
g.setColor(Color.yellow);
int spread = r.nextInt(2)+1;
if (spread==1){
    g.fillRect(0,600,10,10);
} 
```

所以我运行它，一切都正确编译，没有错误，但问题是没有出现窗口！如果它有帮助，这一切都来自一个非默认包，当你使用一个新包时，也许你需要做一些特别的事情？我不知道，因为我是一个新的编码员，所以任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T02:28:23.247

尝试调用`setVisible(true)`您的`JFrame`实例。

```
JFrame j = new JFrame();
JButton jb = new JButton("Start");
j.add(jb);

j.setVisible(true); 
```

并阅读：[http ://docs.oracle.com/javase/tutorial/uiswing/components/frame.html](http://docs.oracle.com/javase/tutorial/uiswing/components/frame.html)

# arduino - 使用 Arduino 上的红外传感器进行计数

> ID：10730339
> 
> 赞同：0
> 
> 时间：2012-05-24T02:25:02.513
> 
> 标签：arduino

我要制造一种自主船只，它可以收集碎片（乒乓球）作为小组任务的一部分。我认为跟踪船只捕获的碎片可能很有用。它基本上是一种双体船设计，球在其下方流动并进入网。一个想法是在下面设置一个红外传感器来跟踪有多少球流入，唯一的问题是如果一个球流出它只会增加计数。我们折腾了一个想法，即拥有两个红外传感器，可以判断球的行进方向，即如果第一个然后第二个传感器被触发，它就会进入，反之亦然。船只下方只有一个球宽的空间。使用两个传感器在 Arduino 上编程球数的最佳方法可能是什么？或者应该如何设置传感器；一个接一个，

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T06:00:27.850

这里公认的做法是提出更具体的问题，但是我在工业自动化和业余爱好编程方面做了很多工作，所以我会看看能否帮助您入门。

要确定经过 2 个传感器的物体的方向，您应该放置传感器，使它们比一个球宽。您可以通过查看哪个传感器先开启来判断物体的前进方向。

您还需要抓住几个边界线情况：如果一个球触发了一个传感器，那么就原路返回（等待第二个传感器可能不会发生）。您可以同时接住 2 个球，因为两个传感器都将保持开启状态。

希望这能让你开始。

# github - 如何访问 GitHub 私人项目 RSS 提要？

> ID：10730341
> 
> 赞同：14
> 
> 时间：2012-05-24T02:25:06.877
> 
> 标签：github, rss, atom-feed

是否可以读取 GitHub 私有存储库及其分支的活动？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-25T09:43:40.677

当然，只需按照以下步骤操作：

1.  在您的浏览器中，登录到您在 GitHub 上的私有存储库。
2.  选择您感兴趣的分支。
3.  单击“提交”选项卡。
4.  您会在“提交历史”字样旁边找到一个 RSS 图标。
5.  复制链接或单击图标以将 URL 添加到您的 feedreader。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-07-02T06:58:13.373

请注意，[自 2013 年 7 月起，您可以通过](http://developer.github.com/changes/2013-07-01-feeds-api/)[Feeds API](http://developer.github.com/v3/activity/feeds/)列出 GitHub 提要，但是：

> [仅当通过基本身份验证进行身份验证](http://developer.github.com/v3/#basic-authentication)时才会返回私有提要，因为当前提要 URI 使用较旧的、不可撤销的身份验证令牌。

# c# - 在 Windows Mobile 7 中为 ListBoxItem 设置 id 值

> ID：10730342
> 
> 赞同：1
> 
> 时间：2012-05-24T02:25:12.397
> 
> 标签：c#, windows-phone-7, listbox

我正在尝试从 Linq 创建一个选择列表框，但是，我在设置每个列表框项的 id 值时遇到问题，该列表框项的 id 具有保存在本地数据库中的相应 id。我有以下代码：

```
public void display_Tips()
    {
       //commented out to try MrMDavidson's approach.
       // listBoxTipHistory.Items.Clear();
       // IList<Tips> tips = this.get_Tips();
       // foreach (Tips tip in tips)
       // {
       //     ListBoxItem li1 = new ListBoxItem();
       //     li1.Content = tip.date.Day + "-" + tip.date.Month + "-" + 
       //                       tip.date.Year + "-" + tip.date.Hour + ":" +
       //                       tip.date.Minute + " - " + tip.resturant + " - $" +
       //                       tip.tip_amount + " - $" + tip.billTotal;
       //     listBoxTipHistory.Items.Add(li1);
       // }
        if (listBoxTipHistory.Items.Count > 0)
        {
            listBoxTipHistory.Items.Clear();
        }
        listBoxTipHistory.ItemsSource = get_Tips();
}

public IList<Tips> get_Tips()
    {
        IList<Tips> tips = null;
        using (TipContext context = new TipContext(conString))
        {
            IQueryable<Tips> query =
                (from c in context.TipTable
                 orderby c.date descending
                 select c);
            tips = query.ToList();
        }
        return tips;
    } 
```

本地数据库表：

```
[Table]
public class Tips
{
    [Column(IsPrimaryKey = true, IsDbGenerated = true)]
    public int tip_ID
    {
        get;
        set;
    }
    [Column(CanBeNull = false)]
    public float tip_amount
    {
        get;
        set;
    }
    [Column]
    public string resturant
    {
        get;
        set;
    }
    [Column(CanBeNull = false)]
    public DateTime date
    {
        get;
        set;
    }
  } 
```

Xml代码：

```
 <ListBox SelectionChanged="showTipDetails" x:Name="listBoxTipHistory" Margin="6,3,0,0">
                    <DataTemplate>
                      <StackPanel>
                        <TextBlock Text="{Binding resturant}" />
                        <TextBlock Text="{Binding date}" />
                        <TextBlock Text="{Binding tip_amount}" />
                      </StackPanel>
                    </DataTemplate>
                </ListBox > 
```

我现在正在尝试重新编码以使用 MrMDavidson 的建议，但是，使用此当前代码会导致列表显示“AppName.Tips”而不是实际的列数据。我已经尝试在谷歌上搜索演练和教程，但是，我一直无法提出解决方案。

此外，是否有特殊的方法来处理日期和时间？

任何建议，将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T02:48:40.063

听起来您正试图从 WinForms / CF.Net 风格的方法中做到这一点。虽然您可能可以这样做，但我建议您不要这样做，因为您真的没有得到 Silverlight 的价值。假设您的`Tips`班级看起来像；

```
public class Tip {
  public int Id { get; set; }
  public string Title { get; set; }
  public string Restaurant { get; set; }
} 
```

然后，您可以将这些列表绑定到`ListBox`;

```
listBoxTipHistory.ItemsSource = get_Tips() 
```

您`XAML`用于描述这些项目的显示方式；

```
<ListBox x:Name="listBoxTipHistory">
  <ListBox.ItemTemplate>
    <DataTemplate>
      <StackPanel>
        <TextBlock Text="{Binding Title}" />
        <TextBlock Text="{Binding Restaurant}" />
      </StackPanel>
    </DataTemplate>
  </ListBox.ItemTemplate>
</ListBox> 
```

`SelectedItem`on将`ListBox`是当前选择的`Tip`（作为`object`），而不是实际`ListBoxItem`选择的。所以要获取选中的ID `Tip`；

```
Tip selectedTip = listBoxTipHistory.SelectedItem as Tip;
if (selectedTip != null) {
  Console.WriteLine("The selected Tip is {0}", selectedTip.Id);
} 
```

进一步的建议是让您查看[INotifyPropertyChanged](http://msdn.microsoft.com/en-us/library/system.componentmodel.inotifypropertychanged.aspx "INotifyPropertyChanged")接口，该接口将允许对模型的更改自动在 UI 中更新

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T04:44:24.233

我同意@MrMDavidson 的观点，即您从老派的角度来处理这个问题，我也同意使用 ViewModel / Binding 方法会更好，但我会给出一个不需要您重写的答案到目前为止已经完成了。

将`DataContext`for设置为`ListItem`tip 对象：

```
foreach (Tips tip in tips)
{
    ListBoxItem li1 = new ListBoxItem();
    li1.Content = tip.date.Day + "-" // etc    
    li1.DataContext = tip;

    listBoxTipHistory.Items.Add(li1);
} 
```

将`DataContext`视为包含对象的控件 ( `ListItem`) 后面的容器。理想情况下，您应该`ListItem`从其 DataContext 中检索数据并填充其内容，但那是另一天的事了。现在只需将其设想为一个容器，您可以使用它来存储与该控件相关的数据。

现在，当您选择一个项目或用户按下提交时，您可以轻松检索该项目：

```
foreach (var item in listBoxTipHistory.SelectedItems)
{
    var tip = (Tip)item.DataContext;
    var tipId = tip.tip_ID; // or whatever you need to do
} 
```

# visual-studio-2010 - Visual Studio 文本编辑器：如何更改 Log 语句的颜色？

> ID：10730343
> 
> 赞同：4
> 
> 时间：2012-05-24T02:25:24.237
> 
> 标签：visual-studio-2010

我正在使用 VS2010，我的代码中有很多日志（log4net）语句。

```
if(Logger.IsDebugEnabled)
{
    Logger.DebugFormat("varX = {0}", varX);
} 
```

我不想添加#regions，因为此类日志记录块的数量非常大。有没有办法将这些行的颜色更改为“灰色”以将它们与普通代码区分开来？

最好的问候，扎克

# ajax - 在嵌套匿名函数中找不到具有 id 的 div

> ID：10730348
> 
> 赞同：0
> 
> 时间：2012-05-24T02:26:59.373
> 
> 标签：ajax, jquery, partial-views

我在另一个匿名函数中有一个 ajax 调用。我遇到的问题是它的长度为零。

```
//data_ajax_target equals '#partial_f_Picture'
Debug.Log($(data_ajax_target).length); // equal zero. 
```

这可以防止从 ajax 调用返回的 html 替换 div 的内容。

这是我的 div

```
<div id="#partial_f_Picture">
    <div id="fileuploader-small-f_Picture" 
        data-ajax-uploadurl="...omitted..."
        data-ajax-target="#partial_f_Picture">
    </div>
</div> 
```

这是我简化的 javascript

```
$(function ()
{
    FileUploaderSmallReady();
}); 
```

...

```
function FileUploaderSmallReady()
{
    var uploaderDiv = $('[id^="fileuploader-small"]').each(function ()
    {
        var data_ajax_uploadurl = $(this).attr('data-ajax-uploadurl');
        var data_ajax_target = $(this).attr('data-ajax-target');

        var uploadersmall = new qq.FileUploader({
            element: document.getElementById($(this).attr('id')),
            action: data_ajax_uploadurl,
            onComplete: function (file, response, responseJSON)
            {
                var data_ajax_url = responseJSON['data_ajax_url'];
                if (typeof data_ajax_url != 'undefined')
                {
                    $.ajax(
                        {
                            type: "GET",
                            url: data_ajax_url,
                            beforeSend: AjaxBegin(),
                            success: function (html)
                            {
                                Debug.Log(data_ajax_target);
                                //== #partial_f_Picture

                                Debug.Log($(data_ajax_target).length);
                                //== 0
                                $(data_ajax_target).html(html);
                            }
                        });
                }
            }
        });});} //moved braces up to prevent code from being in a scroll window. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T03:18:10.577

更改`<div id="#partial_f_Picture">`为`<div id="partial_f_Picture">`。选择器`#`中的 the 表示“它是一个 id”（与它相反的`.`意思是“它是一个类”和缺少前缀的意思是“它是一个 dom 标签”（`p`,`div`等））。

# python - 在纸牌游戏中拆分和附加列表

> ID：10730350
> 
> 赞同：2
> 
> 时间：2012-05-24T02:27:11.173
> 
> 标签：python, list, split, sequence, playing-cards

我正在尝试从预定的顺子手牌中生成一个潜在的牌“出牌”列表（在这个游戏中，顺子被定义为 3 张以上的牌 - 例如`[3,4,5]`）。困难在于找到一种方法来获取已识别顺子列表（可能包括多个未连接的顺子 - ）并将它们**及其**包含在其中的子顺子`['2D','3D','4D','5D','6D','8D','9D','10D']`附加到播放列表中（对于给定的手，理想情况下输出是）**`[['2D','3D','4D'],['3D','4D','5D'],['4D','5D','6D'],['2D','3D','4D','5D'],['3D','4D','5D','6D'],['8D','9D','10D']]`**

 **以下是当前的尝试；

```
seq = ['1D','2D','3D','4D', '6D', '7D','8D', '10D', '11D', '12D']
plays = []
for card in seq:
    ind = seq.index(card)+1
    try:
        if int(seq[ind][0:len(seq[ind])-1]) - int(card[0:len(card)-1]) == 2:
            for num in xrange(len(seq[0:ind])):
                if len(seq[0:(ind-num)]) > 3:
                    plays.append(seq[0:(ind-num)])
                    plays.append(seq[num+1:ind])
                elif len(seq[0:(ind-num)]) == 3:
                    plays.append(seq[0:(ind-num)])
            print plays #debug
except IndexError:
    print 'error'
    #append from the last appended chunk up until last element?
    #arises from final element 
```

[['1D', '2D', '3D', '4D'], ['2D', '3D', '4D'], ['1D', '2D', '3D']]

[['1D', '2D', '3D', '4D'], ['2D', '3D', '4D'], ['1D', '2D', '3D'], **['1D' ', '2D', '3D', '4D', '6D', '7D', '8D']** , **['2D', '3D', '4D', '6D', '7D', '8D' ']** , **['1D', '2D', '3D', '4D', '6D', '7D']** , **['3D', '4D', '6D', '7D', '8D']** , **['1D', '2D', '3D', '4D', '6D'],** ****['4D', '6D', '7D', '8D']**** , **['1D', '2D', '3D', '4D** '], ['6D', '7D', '8D' ], **['1D', '2D', '3D']** ]**

 **错误

粗体输出表示不需要的元素（重复或单独直线的结合）。感谢您的输入！

### 编辑 1：添加第 10-12 行

### 编辑2：添加@Steve Tjoa 提供的解决方案

（假设卡片是一系列整数）卡片 = [1, 2, 3, 4, 6, 7, 8, 10, 11, 12]

```
def f(cards):
    for i in range(len(cards)):
        for j in range(i+3, len(cards)+1):
            if cards[i:j] == range(cards[i], cards[i]+j-i):
                plays.append(cards[i:j])
            print plays 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T02:45:22.637

这有帮助吗？

```
In [34]: def f(cards):
   ....:     return [cards[i:j]
   ....:             for i in range(len(cards))
   ....:             for j in range(i+3, len(cards)+1)
   ....:             if cards[i:j] == range(cards[i], cards[i]+j-i)]
   ....: 

In [35]: f([1, 2, 3, 4, 6, 7, 8, 10, 11, 12])
Out[35]: [[1, 2, 3], [1, 2, 3, 4], [2, 3, 4], [6, 7, 8], [10, 11, 12]]

In [36]: f([2, 3, 4, 5, 6, 8, 9, 10])
Out[36]: 
[[2, 3, 4],
 [2, 3, 4, 5],
 [2, 3, 4, 5, 6],
 [3, 4, 5],
 [3, 4, 5, 6],
 [4, 5, 6],
 [8, 9, 10]] 
```

推理：`cards[i]`是顺子的第一张牌；`cards[j-1]`是最后一张牌。`range`返回连续整数。`j-i`是直线的长度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T03:51:39.900

如果您想同时显示排名和套件，这是获取播放列表的另一种方法。

```
plays = []
hand = ['AD','2D','3D','4D', '6D', '7D','8D', 'TD', 'JD', 'QD']
ranks = sorted([('-A23456789TJQK'.index(r), r+s) for r, s in hand], reverse = True)
for j in range(3, len(hand)):
    for i,r in enumerate(ranks):
        rnk = [x[0] for x in ranks[i:i+j]]
        if (max(rnk)-min(rnk) == j-1) and len(set(rnk)) == j:
            plays.append([x[1] for x in ranks[i:i+j]])

print plays 
```****

# eclipse - Eclipse EE - 为什么我的 Web 项目中的 JSP 看不到我的 EJB 项目中的类？

> ID：10730352
> 
> 赞同：0
> 
> 时间：2012-05-24T02:27:26.043
> 
> 标签：eclipse, jakarta-ee, glassfish, ejb, ear

我正在使用 Eclipse (Indigo) 和 GlassFish 3.1.2。

我有一个用于 EJB 和 JPA 类的项目，名为`sbwEJBJPA`.

我有一个 EAR 项目，名为`sbwEAR`.

我有一个带有 JSP 和 Servlet 的动态 Web 项目，名为`sbw`.

当我从 EAR 项目中导出 EAR 文件时，EAR 文件同时包含 sbw.war 和 sbwEJBJPA.jar。

我的`sbw/WebContent/META-INF/MANIFEST.MF`文件如下所示：

```
Manifest-Version: 1.0
Class-Path: sbwEJBJPA.jar 
```

问题是，当我运行这个简单的 JSP 文件时：

```
<%@page import="sbw.domain.Website"%>
<% Website w = new Website(); %>
<%= new String("Hello from test.jsp") %> 
```

它爆炸了，因为它在 sbwEJBJPA.jar 中看不到 Website.java 类，这是错误：

```
org.apache.jasper.JasperException: PWC6033: Error in Javac compilation for JSP

PWC6199: Generated servlet error:
string:///test_jsp.java:6: package sbw.domain does not exist

PWC6197: An error occurred at line: 3 in the jsp file: /test.jsp
PWC6199: Generated servlet error:
string:///test_jsp.java:48: cannot find symbol
symbol  : class Website
location: class org.apache.jsp.test_jsp

PWC6197: An error occurred at line: 3 in the jsp file: /test.jsp
PWC6199: Generated servlet error:
string:///test_jsp.java:48: cannot find symbol
symbol  : class Website
location: class org.apache.jsp.test_jsp 
```

任何想法为什么这不起作用？任何帮助是极大的赞赏！

抢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T05:42:01.213

仅当值与清单文件位于同一存档中时，Class-Path 标头才有效。sbwEJBJAP.jar 不在 swb 战争文件中。删除该清单，转到 Web 项目的 Deployment Assembly 属性页面，并将其标记为需要 sbwEJBJPA 项目。

# optimization - 创建一个大的 Set - 需要减少花费在 GC 上的时间

> ID：10730357
> 
> 赞同：3
> 
> 时间：2012-05-24T02:28:14.737
> 
> 标签：optimization, haskell, garbage-collection, set, ghc

该程序创建了一个非常大的集合来查找哈希函数冲突。有没有办法减少花在 GC 上的时间？+RTS -s 报告 40+% 的时间花在 GC 上。

示例用法：

```
./program 0 1000000 +RTS -s
./program 145168473 10200000 +RTS -s 
```

我可以使用更好的算法或数据结构吗？

```
{-# LANGUAGE OverloadedStrings #-}

import System.Environment
import Control.Monad
import Crypto.Hash.SHA256

import qualified Data.ByteString.Char8 as B
import qualified Data.ByteString.Lazy.Char8 as BL
import Data.Char
import Data.Int
import Data.Bits
import Data.Binary
import Data.Set as Set
import Data.List
import Numeric

str2int :: (Integral a) => B.ByteString -> a
str2int bs = B.foldl (\a w -> (a * 256)+(fromIntegral $ ord w)) 0 bs

t50 :: Int64 -> Int64
t50 i = let h = hash $ B.concat $ BL.toChunks $ encode i
        in
          (str2int $ B.drop 25 h) .&. 0x3ffffffffffff

sha256 :: Int64 -> B.ByteString
sha256 i = hash $ B.concat $ BL.toChunks $ encode i

-- firstCollision :: Ord b => (a -> b) -> [a] -> Maybe a
firstCollision f xs = go f Set.empty xs
  where
    -- go :: Ord b => (a -> b) -> Set b -> [a] -> Maybe a
    go _ _ []     = Nothing
    go f s (x:xs) = let y = f x
                    in
                      if y `Set.member` s
                        then Just x
                        else go f (Set.insert y s) xs

showHex2 i
  | i < 16    = "0" ++ (showHex i "")
  | otherwise = showHex i ""

prettyPrint :: B.ByteString -> String
prettyPrint = concat . (Data.List.map showHex2) . (Data.List.map ord) . B.unpack

showhash inp =
  let  h = sha256 inp
       x = B.concat $ BL.toChunks $ encode inp
   in do putStrLn $ "  - input: " ++ (prettyPrint x) ++ " -- " ++ (show inp)
         putStrLn $ "  -  hash: " ++ (prettyPrint h)

main = do
         args <- getArgs
         let a = (read $ args !! 0) :: Int64
             b = (read $ args !! 1) :: Int64
             c = firstCollision t [a..(a+b)]
             t = t50
         case c of
           Nothing -> putStrLn "No collision found"
           Just x  -> do let h = t x
                         putStrLn $ "Found collision at " ++ (show x)
                         showhash x
                         let first = find (\x -> (t x) == h) [a..(a+b)]
                          in case first of
                               Nothing -> putStrLn "oops -- failed to find hash"
                               Just x0 -> do putStrLn $ "first instance at " ++ (show x0)
                                             showhash x0 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T12:17:19.037

如您所见，GC 统计数据报告生产力低下：

```
 44,184,375,988 bytes allocated in the heap
   1,244,120,552 bytes copied during GC
      39,315,612 bytes maximum residency (42 sample(s))
         545,688 bytes maximum slop
             109 MB total memory in use (0 MB lost due to fragmentation)

                                    Tot time (elapsed)  Avg pause  Max pause
  Gen  0     81400 colls,     0 par    2.47s    2.40s     0.0000s    0.0003s
  Gen  1        42 colls,     0 par    1.06s    1.08s     0.0258s    0.1203s

  INIT    time    0.00s  (  0.00s elapsed)
  MUT     time    4.58s  (  4.63s elapsed)
  GC      time    3.53s  (  3.48s elapsed)
  EXIT    time    0.00s  (  0.00s elapsed)
  Total   time    8.11s  (  8.11s elapsed)

  %GC     time      43.5%  (42.9% elapsed)

  Alloc rate    9,651,194,755 bytes per MUT second

  Productivity  56.5% of total user, 56.4% of total elapsed 
```

最明显的第一步是增加 GC 默认区域以尝试消除调整大小的需要。例如，一个技巧[是增加 -A 区域](https://stackoverflow.com/questions/3171922/ghcs-rts-options-for-garbage-collection/3172704#3172704)（您可以使用[GC tune 等](http://donsbot.wordpress.com/2010/07/05/ghc-gc-tune-tuning-haskell-gc-settings-for-fun-and-profit/)工具为您的程序找到正确的设置）。

```
 $ ./A ... +RTS -s -A200M

  Total   time    7.89s  (  7.87s elapsed)

  %GC     time      26.1%  (26.5% elapsed)

  Alloc rate    7,581,233,460 bytes per MUT second

  Productivity  73.9% of total user, 74.1% of total elapsed 
```

所以我们减少了四分之一秒的时间，但将生产力提高到了 75%。现在我们应该看看堆配置文件：

![在此处输入图像描述](../Images/5559bf55183e5a940285ce6367b30b56.png)

这显示了集合及其 Int 值的线性增长。不过，这是您的算法指定的，因此只要您保留所有结果，我看不到您可以做很多事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-24T17:59:23.637

您经常做的一件事是通过使用包来构建`ByteString`s （如果您想避免与惰性块之间发生这种情况，可以顺便使用）。如果您深入了解他们使用的 monad 的内部结构，您会发现它的默认初始大小约为 32k。出于您的目的，考虑到您只需要 8 个字节，这可能会给垃圾收集器带来比所需更大的压力。`binary``cereal``Builder`

由于您实际上只是`binary`用于编码，因此您可以自己使用以下方法：

```
encodeInt64 :: Int64 -> B.ByteString
encodeInt64 x = 
  let 
    go :: Int -> Maybe (Word8, Int)
    go i 
      | i < 0     = Nothing
      | otherwise = 
        let 
          w :: Word8
          w = fromIntegral (x `shiftR` i)
        in Just (w, i-8)
  in fst $ B.unfoldrN 8 go 56 
```

我会冒险你甚至可以做得更好，也许将字节直接插入缓冲区。

以上是一回事，另一个与 GC 无关的点是您使用的是标准实现，您可以使用from`Data.Set`找到更好的性能。`Data.HashSet``unordered-containers`

最后一点，Don 也提到的是，您可以请求更大的分配区域`-A200M`（或附近）。

通过上述所有修改（您自己的编码器，使用`Data.HashSet`和`-A200M`），您的代码在我的机器上的运行时间从 7.397 秒变为 3.474 秒，%GC 时间分别为 52.9% 和 21.2%。

因此，在您的方法的 Big-O 意义上，您没有做错任何事情，但是您可以稍微降低一些常数！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T06:18:32.473

我不知道。但是，这里有一些分析器输出，以防有人可以从中构造出真正的答案：

这是堆配置文件（来自运行`+RTS -hT`）

![堆配置文件](../Images/ba1cc38b6912db0394f6d7fb2162288c.png)

我认为`firstCollision`由于对`Set.insert`. 但是，内存分配的绝对值是如此之小，以至于我不确定它是否是真正的罪魁祸首——见下文。

以下是分析器的输出（使用 编译`-prof -fprof-auto`，使用 运行`+RTS -p`）：

```
COST CENTRE         MODULE  %time %alloc

firstCollision.go   Main     49.4    2.2
t50.h               Main     39.5   97.5
str2int             Main      5.4    0.0
firstCollision.go.y Main      3.4    0.0
t50                 Main      1.1    0.0 
```

基本上所有的内存分配都来自本地等效`h`的序列化/散列管道`sha256`，其中似乎有很多中间数据结构构造正在进行。

有经验的人能更准确地查明问题吗？

# javascript - 按名称获取 cookie

> ID：10730362
> 
> 赞同：470
> 
> 时间：2012-05-24T02:29:16.920
> 
> 标签：javascript, cookies

我有一个 getter 从 cookie 中获取值。

现在我有 2 个名称`shares=`和名称的cookie `obligations=`。

我想让这个 getter 只是为了从义务 cookie 中获取值。

我该怎么做呢？因此，`for`将数据拆分为单独的值并将其放入数组中。

```
 function getCookie1() {
    // What do I have to add here to look only in the "obligations=" cookie? 
    // Because now it searches all the cookies.

    var elements = document.cookie.split('=');
    var obligations= elements[1].split('%');
    for (var i = 0; i < obligations.length - 1; i++) {
        var tmp = obligations[i].split('$');
        addProduct1(tmp[0], tmp[1], tmp[2], tmp[3]);
    }
 } 
```

* * *

## 回答 #1

> 赞同：604
> 
> 时间：2013-03-30T22:40:12.903

一种避免迭代数组的方法是：

```
function getCookie(name) {
  const value = `; ${document.cookie}`;
  const parts = value.split(`; ${name}=`);
  if (parts.length === 2) return parts.pop().split(';').shift();
} 
```

**演练**

通过标记拆分字符串将生成一个具有一个字符串（相同值）的数组，以防字符串中不存在标记，或者生成具有两个字符串的数组，以防在字符串中找到标记。

第一个（左）元素是令牌之前的字符串，第二个（右）是令牌之后的字符串。

（注意：如果字符串以标记开头，则第一个元素是空字符串）

考虑到 cookie 的存储方式如下：

```
"{name}={value}; {name}={value}; ..." 
```

为了检索特定的 cookie 值，我们只需要获取 "; {name}=" 之后和下一个 ";" 之前的字符串。在我们进行任何处理之前，我们在 cookie 字符串前面加上“;”，这样每个 cookie 名称，包括第一个，都用“;”和“=”括起来：

```
"; {name}={value}; {name}={value}; ..." 
```

现在，我们可以先用 "; {name}=" 分割，如果在 cookie 字符串中找到 token（即我们有两个元素），我们最终会得到第二个元素，它是以我们的 cookie 值开头的字符串。然后我们从一个数组中取出它（即pop），并重复相同的过程，但现在使用“;” 作为令牌，但这次拉出左侧字符串（即移位）以获得实际令牌值。

* * *

## 回答 #2

> 赞同：217
> 
> 时间：2014-01-14T22:13:12.390

我更喜欢在 cookie 上使用单个正则表达式匹配：

```
window.getCookie = function(name) {
  var match = document.cookie.match(new RegExp('(^| )' + name + '=([^;]+)'));
  if (match) return match[2];
} 
```

或者我们也可以作为一个函数使用，检查下面的代码。

```
function check_cookie_name(name) 
    {
      var match = document.cookie.match(new RegExp('(^| )' + name + '=([^;]+)'));
      if (match) {
        console.log(match[2]);
      }
      else{
           console.log('--something went wrong---');
      }
   } 
```

感谢 Scott Jungwirth 在评论中的改进。

* * *

## 回答 #3

> 赞同：63
> 
> 时间：2014-03-20T10:02:58.367

如果你使用 jQuery，我推荐你使用这个插件：

[https://github.com/carhartl/jquery-cookie](https://github.com/carhartl/jquery-cookie)
[https://github.com/carhartl/jquery-cookie/blob/master/jquery.cookie.js](https://github.com/carhartl/jquery-cookie/blob/master/jquery.cookie.js)

```
<script type="text/javascript"
 src="//cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"> 
```

所以你可以像这样读取cookie：

```
var value = $.cookie("obligations"); 
```

你也可以写cookie：

```
$.cookie('obligations', 'new_value');
$.cookie('obligations', 'new_value', { expires: 14, path: '/' }); 
```

删除 cookie：

```
$.removeCookie('obligations'); 
```

* * *

## 回答 #4

> 赞同：61
> 
> 时间：2014-08-17T04:59:35.060

其他一些使用正则表达式的答案中的方法并不涵盖所有情况，特别是：

1.  当 cookie 是最后一个 cookie 时。在这种情况下，cookie 值后面不会有分号。
2.  当另一个 cookie 名称以正在查找的名称结尾时。例如，您正在寻找名为“one”的 cookie，并且有一个名为“done”的 cookie。
3.  当 cookie 名称包含在正则表达式中使用时不被解释为自身的字符时，除非它们前面有反斜杠。

以下方法处理这些情况：

```
function getCookie(name) {
    function escape(s) { return s.replace(/([.*+?\^$(){}|\[\]\/\\])/g, '\\$1'); }
    var match = document.cookie.match(RegExp('(?:^|;\\s*)' + escape(name) + '=([^;]*)'));
    return match ? match[1] : null;
} 
```

`null`如果未找到 cookie，这将返回。如果 cookie 的值为空，它将返回一个空字符串。

笔记：

1.  此函数假定[cookie 名称区分大小写](https://stackoverflow.com/questions/11311893/is-the-name-of-a-cookie-case-sensitive)。
2.  [`document.cookie`](https://developer.mozilla.org/en-US/docs/Web/API/document.cookie)- 当它出现在分配的右侧时，它表示一个包含以分号分隔的 cookie 列表的字符串，这些 cookie 又是`name=value`对的。每个分号后似乎有一个空格。
3.  [`String.prototype.match()`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/match)-`null`未找到匹配项时返回。找到匹配时返回一个数组，索引`[1]`处的元素是第一个匹配组的值。

正则表达式注释：

1.  `(?:xxxx)`- 形成一个不匹配的组。
2.  `^`- 匹配字符串的开头。
3.  `|`- 为组分离替代模式。
4.  `;\\s*`- 匹配一个分号，后跟零个或多个空白字符。
5.  `=`- 匹配一个等号。
6.  `(xxxx)`- 形成一个匹配组。
7.  `[^;]*`- 匹配零个或多个分号以外的字符。这意味着它将匹配最多但不包括分号或字符串末尾的字符。

* * *

## 回答 #5

> 赞同：38
> 
> 时间：2018-03-11T20:19:27.540

4 年后，ES6 方式更简单的版本。

```
function getCookie(name) {
  let cookie = {};
  document.cookie.split(';').forEach(function(el) {
    let [k,v] = el.split('=');
    cookie[k.trim()] = v;
  })
  return cookie[name];
} 
```

我还创建了一个[要点](https://gist.github.com/allenhwkim/19c2f36a7afa6f0c507008613e966d1b)以将其用作`Cookie`对象。例如，`Cookie.set(name,value)`和`Cookie.get(name)`

这会读取所有 cookie 而不是扫描。少量饼干没关系。

* * *

## 回答 #6

> 赞同：36
> 
> 时间：2020-01-05T18:41:44.483

这是一个无需任何外部库即可获得具有特定名称的 cookie 值的方法：

```
const value = ('; '+document.cookie).split(`; COOKIE_NAME=`).pop().split(';')[0]; 
```

这个答案基于[kirlich 的出色解决方案](https://stackoverflow.com/questions/10730362/get-cookie-by-name/15724300#15724300)。此解决方案的唯一妥协是，当 cookie 不存在时，您将得到一个空字符串。不过，在大多数情况下，这不应该是一个交易破坏者。

* * *

## 回答 #7

> 赞同：25
> 
> 时间：2014-01-15T15:36:02.797

我已经修改了 Jonathan 在这里提供的函数，通过使用正则表达式，您可以通过其名称获取 cookie 值，如下所示：

```
function getCookie(name){
    var pattern = RegExp(name + "=.[^;]*")
    var matched = document.cookie.match(pattern)
    if(matched){
        var cookie = matched[0].split('=')
        return cookie[1]
    }
    return false
} 
```

如果返回空字符串，则表示 cookie 存在但没有值，如果返回 false，则表示 cookie 不存在。我希望这有帮助。

* * *

## 回答 #8

> 赞同：14
> 
> 时间：2018-08-21T11:31:12.647

您可以使用**js-cookie**库来获取和设置 JavaScript cookie。

包含到您的 HTML 中：

```
<script src="https://cdn.jsdelivr.net/npm/js-cookie@2/src/js.cookie.min.js"></script> 
```

要创建 Cookie：

```
Cookies.set('name', 'value'); 
```

要读取 Cookie：

```
Cookies.get('name'); // => 'value' 
```

* * *

## 回答 #9

> 赞同：13
> 
> 时间：2016-11-24T12:24:20.527

这是一个很短的版本

```
 function getCookie(n) {
    let a = `; ${document.cookie}`.match(`;\\s*${n}=([^;]+)`);
    return a ? a[1] : '';
} 
```

请注意，我使用 ES6 的模板字符串来组成正则表达式。

* * *

## 回答 #10

> 赞同：12
> 
> 时间：2014-10-07T11:29:13.980

我知道这是一个老问题，但我也遇到了这个问题。[仅作记录，开发人员Mozilla 网页](https://developer.mozilla.org/en-US/docs/Web/API/document.cookie)中有一个小 API 。

Yoy 可以仅使用 JS 按名称获取任何 cookie。恕我直言，代码也更干净（除了长线，我相信你可以轻松修复）。

```
function getCookie(sKey) {
    if (!sKey) { return null; }
    return decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*" + encodeURIComponent(sKey).replace(/[\-\.\+\*]/g, "\\$&") + "\\s*\\=\\s*([^;]*).*$)|^.*$"), "$1")) || null;
} 
```

如评论中所述，请注意，此方法假定键和值是使用 encodeURIComponent() 编码的。如果 cookie 的键和值未编码，则删除 decode & encodeURIComponent()。

* * *

## 回答 #11

> 赞同：11
> 
> 时间：2020-06-11T05:27:10.420

我的一个线性函数通过它的键来获取值 cookie。

```
cookie = key=>((new RegExp((key || '=')+'=(.*?); ','gm')).exec(document.cookie+'; ') ||['',null])[1] 
```

> 调用 cookie 函数为

```
cookie('some-key') 
```

* * *

## 回答 #12

> 赞同：10
> 
> 时间：2017-03-26T19:00:58.253

```
function getCookie(name) {
    var pair = document.cookie.split('; ').find(x => x.startsWith(name+'='));
    if (pair)
       return pair.split('=')[1]
} 
```

* * *

## 回答 #13

> 赞同：8
> 
> 时间：2020-10-21T22:26:50.510

一种将 cookie 转换为 JavaScript 对象或地图的衬垫

```
Object.fromEntries(document.cookie.split('; ').map(v=>v.split('=').map(decodeURIComponent))) 
```

```
new Map(document.cookie.split('; ').map(v=>v.split('=').map(decodeURIComponent))) 
```

* * *

## 回答 #14

> 赞同：7
> 
> 时间：2016-01-16T06:41:25.117

## 利用`object.defineProperty`

有了这个，您可以轻松访问 cookie

```
Object.defineProperty(window, "Cookies", {
    get: function() {
        return document.cookie.split(';').reduce(function(cookies, cookie) {
            cookies[cookie.split("=")[0]] = unescape(cookie.split("=")[1]);
            return cookies
        }, {});
    }
}); 
```

从现在开始，您可以这样做：

```
alert( Cookies.obligations ); 
```

这也会自动更新，所以如果你改变了一个 cookie，它`Cookies`也会改变。

* * *

## 回答 #15

> 赞同：7
> 
> 时间：2016-11-08T01:12:18.450

**kirlich**给出了一个很好的解决方案。但是，当有两个具有相似名称的 cookie 值时，它会失败，这是针对这种情况的简单修复：

```
function getCookie(name) {
  var value = "; " + document.cookie;
  var parts = value.split("; " + name + "=");
  if (parts.length >= 2) return parts.pop().split(";").shift();
} 
```

* * *

## 回答 #16

> 赞同：6
> 
> 时间：2012-05-24T02:47:39.470

在我看来，您可以将 cookie 键值对拆分为一个数组，并以此为基础进行搜索：

```
var obligations = getCookieData("obligations"); 
```

运行以下内容：

```
function getCookieData( name ) {
    var pairs = document.cookie.split("; "),
        count = pairs.length, parts; 
    while ( count-- ) {
        parts = pairs[count].split("=");
        if ( parts[0] === name )
            return parts[1];
    }
    return false;
} 
```

小提琴：http: [//jsfiddle.net/qFmPc/](http://jsfiddle.net/qFmPc/)

甚至可能是以下内容：

```
function getCookieData( name ) {
    var patrn = new RegExp( "^" + name + "=(.*?);" ),
        patr2 = new RegExp( " " + name + "=(.*?);" );
    if ( match = (document.cookie.match(patrn) || document.cookie.match(patr2)) )
        return match[1];
    return false;
} 
```

* * *

## 回答 #17

> 赞同：6
> 
> 时间：2015-03-13T16:52:59.597

总是运作良好：

```
function getCookie(cname) {
    var name = cname + "=",
        ca = document.cookie.split(';'),
        i,
        c,
        ca_length = ca.length;
    for (i = 0; i < ca_length; i += 1) {
        c = ca[i];
        while (c.charAt(0) === ' ') {
            c = c.substring(1);
        }
        if (c.indexOf(name) !== -1) {
            return c.substring(name.length, c.length);
        }
    }
    return "";
}

function setCookie(variable, value, expires_seconds) {
    var d = new Date();
    d = new Date(d.getTime() + 1000 * expires_seconds);
    document.cookie = variable + '=' + value + '; expires=' + d.toGMTString() + ';';
} 
```

**对 jQuery 或任何东西没有要求。纯旧的好 JavaScript。**

* * *

## 回答 #18

> 赞同：6
> 
> 时间：2018-05-11T02:33:08.977

显然，MDN 从未听说过 word-boundary 正则表达式字符类`\b`，它匹配`\w+`在任一侧有界的连续`\W+`：

```
getCookie = function(name) {
    var r = document.cookie.match("\\b" + name + "=([^;]*)\\b");
    return r ? r[1] : null;
};

var obligations = getCookie('obligations'); 
```

* * *

## 回答 #19

> 赞同：6
> 
> 时间：2017-07-04T20:15:49.243

使用 cookie 名称获取 cookie 的简单函数：

```
function getCookie(cn) {
    var name = cn+"=";
    var allCookie = decodeURIComponent(document.cookie).split(';');
    var cval = [];
    for(var i=0; i < allCookie.length; i++) {
        if (allCookie[i].trim().indexOf(name) == 0) {
            cval = allCookie[i].trim().split("=");
        }   
    }
    return (cval.length > 0) ? cval[1] : "";
} 
```

* * *

## 回答 #20

> 赞同：5
> 
> 时间：2013-11-14T07:02:42.377

在我的项目中，我使用以下功能按名称访问 cookie

```
function getCookie(cookie) {
    return document.cookie.split(';').reduce(function(prev, c) {
        var arr = c.split('=');
        return (arr[0].trim() === cookie) ? arr[1] : prev;
    }, undefined);
} 
```

* * *

## 回答 #21

> 赞同：5
> 
> 时间：2021-11-03T14:04:50.763

一个简单的方法:)

```
const cookieObj = new URLSearchParams(document.cookie.replaceAll("; ","&"))
cookieObj.get("your-cookie-name") 
```

* * *

## 回答 #22

> 赞同：3
> 
> 时间：2021-02-04T09:57:55.570

```
function getCookie(cname) {
  var name = cname + "=";
  var ca = document.cookie.split(';');
  for(var i = 0; i < ca.length; i++) {
    var c = ca[i];
    while (c.charAt(0) == ' ') {
      c = c.substring(1);
    }
    if (c.indexOf(name) == 0) {
      return c.substring(name.length, c.length);
    }
  }
  return "";
} 
```

将 cookie 名称传递给 getCookie() 函数以获取其值

* * *

## 回答 #23

> 赞同：3
> 
> 时间：2017-03-28T08:24:48.617

由javascript设置

```
document.cookie = 'cookiename=tesing'; 
```

使用[jquery-cookie 插件获取 jquery](https://github.com/carhartl/jquery-cookie)

```
var value = $.cookie("cookiename");

alert(value); 
```

* * *

## 回答 #24

> 赞同：3
> 
> 时间：2017-04-11T19:31:01.487

这里已经有很好的获取 cookie 的答案，但是这里是我自己的解决方案：

```
function getcookie(cookiename){
var cookiestring  = document.cookie;
var cookiearray = cookiestring.split(';');
for(var i =0 ; i < cookiearray.length ; ++i){ 
    if(cookiearray[i].trim().match('^'+cookiename+'=')){ 
        return cookiearray[i].replace(`${cookiename}=`,'').trim();
    }
} return null;
} 
```

用法：`

```
 getcookie('session_id');
   // gets cookie with name session_id 
```

* * *

## 回答 #25

> 赞同：3
> 
> 时间：2018-09-20T07:36:57.837

参考：[https ://developer.mozilla.org/en-US/docs/Web/API/Document/cookie](https://developer.mozilla.org/en-US/docs/Web/API/Document/cookie)

```
document.cookie = "test1=Hello";
document.cookie = "test2=World";

var cookieValue = document.cookie.replace(/(?:(?:^|.*;\s*)test2\s*\=\s*([^;]*).*$)|^.*$/, "$1");

  alert(cookieValue); 
```

* * *

## 回答 #26

> 赞同：2
> 
> 时间：2020-07-16T19:19:52.097

我写了一些可能易于使用的东西，如果有人要添加一些东西，请随时这样做。

```
function getcookie(name = '') {
    let cookies = document.cookie;
    let cookiestore = {};

    cookies = cookies.split(";");

    if (cookies[0] == "" && cookies[0][0] == undefined) {
        return undefined;
    }

    cookies.forEach(function(cookie) {
        cookie = cookie.split(/=(.+)/);
        if (cookie[0].substr(0, 1) == ' ') {
            cookie[0] = cookie[0].substr(1);
        }
        cookiestore[cookie[0]] = cookie[1];
    });

    return (name !== '' ? cookiestore[name] : cookiestore);
} 
```

* * *

## 用法

`getcookie()`- 返回一个包含网页上所有 cookie 的对象。

`getcookie('myCookie')`- 从 cookie 对象返回 cookie myCookie 的值，否则如果 cookie 为空或未设置，则返回 undefined。

* * *

## 例子

```
// Have some cookies :-)
document.cookie = "myCookies=delicious";
document.cookie = "myComputer=good";
document.cookie = "myBrowser=RAM hungry";

// Read them
console.log( "My cookies are " + getcookie('myCookie') );
// Outputs: My cookies are delicious

console.log( "My computer is " + getcookie('myComputer') );
// Outputs: My computer is good

console.log( "My browser is " + getcookie('myBrowser') );
// Outputs: My browser is RAM hungry

console.log( getcookie() );
// Outputs: {myCookie: "delicious", myComputer: "good", myBrowser: "RAM hungry"}

// (does cookie exist?)
if (getcookie('hidden_cookie')) {
    console.log('Hidden cookie was found!');
} else {
    console.log('Still no cookie :-(');
}

// (do any cookies exist?)
if (getcookie()) {
    console.log("You've got cookies to eat!");
} else {
    console.log('No cookies for today :-(');
} 
```

* * *

## 回答 #27

> 赞同：2
> 
> 时间：2017-11-26T11:16:07.810

我已经这样做了。这样我就可以访问一个对象来分离这些值。有了这个你可以将cookie传递给父级，然后你可以通过像这样的键访问你的值

```
var cookies=getCookieVal(mycookie);
alert(cookies.mykey);
function getCookieVal(parent) {
            var cookievalue = $.cookie(parent).split('&');
            var obj = {};
            $.each(cookievalue, function (i, v) {
                var key = v.substr(0, v.indexOf("="));
                var val = v.substr(v.indexOf("=") + 1, v.length);

                obj[key] = val;

            });
            return obj;
        } 
```

* * *

## 回答 #28

> 赞同：2
> 
> 时间：2016-01-19T19:31:44.020

我的解决方案是这样的：

```
function getCookieValue(cookieName) {
    var ca = document.cookie.split('; ');
    return _.find(ca, function (cookie) {
        return cookie.indexOf(cookieName) === 0;
    });
} 
```

此函数使用 Underscorejs _.find 函数。如果 cookie 名称不存在，则返回 undefined

* * *

## 回答 #29

> 赞同：2
> 
> 时间：2020-02-09T11:07:51.183

只需使用以下函数（纯 javascript 代码）

```
const getCookie = (name) => {
 const cookies = Object.assign({}, ...document.cookie.split('; ').map(cookie => {
    const name = cookie.split('=')[0];
    const value = cookie.split('=')[1];

    return {[name]: value};
  }));

  return cookies[name];
}; 
```

* * *

## 回答 #30

> 赞同：1
> 
> 时间：2020-05-30T09:29:49.830

按名称获取 cookie 只需将 cookie 的名称传递给下面的函数

```
function getCookie(cname) {
  var name = cname + "=";
  var decodedCookie = decodeURIComponent(document.cookie);
  var ca = decodedCookie.split(';');
  for(var i = 0; i <ca.length; i++) {
    var c = ca[i];
    while (c.charAt(0) == ' ') {
      c = c.substring(1);
    }
    if (c.indexOf(name) == 0) {
      return c.substring(name.length, c.length);
    }
  }
  return "";
} 
```

* * *

## 回答 #31

> 赞同：1
> 
> 时间：2021-11-08T07:23:50.257

在 JS 中设置 Cookie

```
document.cookie = 'fb-event-id=15648779++'; 
```

按名称获取 Cookie 函数

```
function getCookie(name) {
    // Split cookie string and get all individual name=value pairs in an array
    var cookieArr = document.cookie.split(";");
    // Loop through the array elements
    for(var i = 0; i < cookieArr.length; i++) {
        var cookiePair = cookieArr[i].split("=");
        /* Removing whitespace at the beginning of the cookie name
        and compare it with the given string */
        if(name == cookiePair[0].trim()) {
            // Decode the cookie value and return
            return decodeURIComponent(cookiePair[1]);
        }
    } 
    // Return null if not found
    return null;
} 
```

这是如何使用 getCookie 函数

```
var eventID = getCookie('fb-event-id') 
```

* * *

## 回答 #32

> 赞同：1
> 
> 时间：2017-04-23T06:28:37.850

一种查找现有 cookie 的实用方法。它返回一个数组，因此它支持同名的多次出现。它不支持部分键匹配，但是用正则表达式替换过滤器中的 === 很简单。

```
function getCookie(needle) {
    return document.cookie.split(';').map(function(cookiestring) {
        cs = cookiestring.trim().split('=');

        if(cs.length === 2) {
            return {'name' : cs[0], 'value' : cs[1]};
        } else {
            return {'name' : '', 'value' : ''};
        }
    })
    .filter(function(cookieObject) { 
        return (cookieObject.name === needle);
    });
} 
```

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2021-09-22T21:26:24.380

这对我来说很完美（假设 cookie 名称是唯一的）：

```
function getCookie(name) {
    var cookies = document.cookie;
    var parts = cookies.split(name + "=");
    var cookieValue = '';
    if (parts.length == 2) {
        cookieValue = parts.pop().split(";").shift();
    }
    return cookieValue;
} 
```

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2016-04-07T17:15:47.520

我喜欢使用闭包按名称获取 cookie 值。下面的闭包将允许您按名称获取 cookie 值，但仅在 cookie 字符串已更新时才对其进行解析。

您可以使用以下内容检索 cookie 的值：

```
var foo = cookies.get( "bar" ); 
```

代码：

```
var cookies = ( function() {
    var cookieString = null;
    var cookieArray = [];

    function getValOf( name ) {
        if ( newCookies() ) {
            parseCookieString()
        }
        return cookieArray[ name ];
    }

    // Check if new cookies have been added
    function newCookies() {
        return cookieString === document.cookie;
    }

    function parseCookieString() {
        cookieString = document.cookie;

        // Separate cookies
        var cookies = cookieString.split( ";" );

        // Empty previous cookies
        cookieArray = [];

        // Update cookieArray with new name-value pairs
        for ( var i in cookies ) {

            // Separate name and value
            var nameVal = cookies[ i ].split( "=" );
            var name = nameVal[ 0 ].trim();
            var value = nameVal[ 1 ].trim();

            // Add cookie name value pair to dictionary
            cookieArray[ name ] = value;
        }
    }

    return {

        /**
         * Returns value or undefined
         */
        get: function( name ) {
            return getValOf( name );
        }  
    };
})(); 
```

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2018-05-09T08:11:36.383

只是为了给这个响应添加一个“官方”答案，我复制/粘贴解决方案来设置和检索来自[MDN](https://developer.mozilla.org/en-US/docs/Web/API/document/cookie#Example_2_Get_a_sample_cookie_named_test2 "MDN")的 cookie （这里是[JSfiddle](https://jsfiddle.net/t9wmtahh/ "JSfiddle")

```
 document.cookie = "test1=Hello";
    document.cookie = "test2=World";

    var cookieValue = document.cookie.replace(/(?:(?:^|.*;\s*)test2\s*\=\s*([^;]*).*$)|^.*$/, "$1");

    function alertCookieValue() {
      alert(cookieValue);
    } 
```

在您的特定情况下，您将使用以下功能

```
 function getCookieValue() {
      return document.cookie.replace(/(?:(?:^|.*;\s*)obligations\s*\=\s*([^;]*).*$)|^.*$/, "$1");
    } 
```

请注意，我仅将示例中的“test2”替换为“义务”。

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2019-11-26T12:29:48.133

[Document.cookie](https://developer.mozilla.org/en-US/docs/Web/API/Document/cookie) Document 属性 cookie 允许您读取和写入与文档关联的 cookie。它充当 cookie 实际值的 getter 和 setter。

```
var c = 'Yash' + '=' + 'Yash-777';
document.cookie = c; // Set the value: "Yash=Yash-777"
document.cookie      // Get the value:"Yash=Yash-777" 
```

来自 Google GWT 项目[`Cookies.java`](https://github.com/Yash-777/gwt/blob/master/user/src/com/google/gwt/user/client/Cookies.java)类的原生代码。我准备了以下函数来对 Cookie 执行操作。

将所有 cookie 列表作为 JSON 对象获取的函数。

```
var uriEncoding = false;
function loadCookiesList() {
    var json = new Object();
    if (typeof document === 'undefined') {
        return json;
    }

    var docCookie = document.cookie;
    if (docCookie && docCookie != '') {
      var crumbs = docCookie.split('; ');
      for (var i = crumbs.length - 1; i >= 0; --i) {
        var name, value;
        var eqIdx = crumbs[i].indexOf('=');
        if (eqIdx == -1) {
          name = crumbs[i];
          value = '';
        } else {
          name = crumbs[i].substring(0, eqIdx);
          value = crumbs[i].substring(eqIdx + 1);
        }
        if (uriEncoding) {
          try {
            name = decodeURIComponent(name);
          } catch (e) {
            // ignore error, keep undecoded name
          }
          try {
            value = decodeURIComponent(value);
          } catch (e) {
            // ignore error, keep undecoded value
          }
        }
        json[name] = value;
      }
    }
    return json;
 } 
```

设置和获取具有特定名称的 Cookie。

```
function getCookieValue(name) {
    var json = loadCookiesList();
    return json[name];
}

function setCookie(name, value, expires, domain, path, isSecure) {
    var c = name + '=' + value;
    if ( expires != null) {
        if (typeof expires === 'number') {
            // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/now
            var timeInMs = Date.now();
            if (expires > timeInMs ) {
                console.log("Seting Cookie with provided expire time.");
                c += ';expires=' + (new Date(expires)).toGMTString();
            } else if (expires < timeInMs) {
                console.log("Seting Cookie with Old expire time, which is in Expired State.");
                timeInMs = new Date(timeInMs + 1000 * expires);
                c += ';expires=' + (new Date(timeInMs)).toGMTString();
            }
        } else if (expires instanceof window.Date) {
            c += ';expires=' + expires.toGMTString();
        }
    }

    if (domain != null && typeof domain == 'string')
      c += ';domain=' + domain;
    if (path != null && typeof path == 'string')
      c += ';path=' + path;
    if (isSecure != null && typeof path == 'boolean')
      c += ';secure';

    if (uriEncoding) {
        encodeURIComponent(String(name))
            .replace(/%(23|24|26|2B|5E|60|7C)/g, decodeURIComponent)
            .replace(/[\(\)]/g, escape);
        encodeURIComponent(String(value))
            .replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g, decodeURIComponent);

    }
    document.cookie = c;
}

function removeCookie(name) {
    document.cookie = name + "=;expires=Fri, 02-Jan-1970 00:00:00 GMT"; 
}
function removeCookie(name, path) {
    document.cookie = name + "=;path=" + path + ";expires=Fri, 02-Jan-1970 00:00:00 GMT";
} 
```

检查 cookie 名称是否有效：不能包含`'=', ';', ',', or whitespace`. 不能以 开头`$`。

```
function isValidCookieName(name) {
    if (uriEncoding) {
      // check not necessary
      return true;
    } else if (name.includes("=") || name.includes(";") || name.includes(",") || name.startsWith("$") || spacesCheck(name) ) {
      return false;
    } else {
      return true;
    }
}
// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp/test
function spacesCheck(name) {
    var whitespace = new RegExp('.*\\s+.*');
    var result = whitespace.test(name);
    console.log("Name:isContainSpace = ", name, ":", result);
    return result;
} 
```

检查上述功能的测试步骤：

```
setCookie("yash1", "Yash-777");
setCookie("yash2", "Yash-Date.now()", Date.now() + 1000 * 30);
setCookie("yash3", "Yash-Sec-Feature", 30);
setCookie("yash4", "Yash-Date", new Date('November 30, 2020 23:15:30'));

getCookieValue("yash4"); // Yash-Date
getCookieValue("unknownkey"); // undefined

var t1 = "Yash", t2 = "Y    ash", t3 = "Yash\n";
spacesCheck(t1); // False
spacesCheck(t2); // True
spacesCheck(t3); // True 
```

* * *

## 回答 #37

> 赞同：0
> 
> 时间：2022-01-24T11:55:42.213

这种方法开箱即用

```
function getCookie(cname) {
  var cookies = ` ${document.cookie}`.split(";");
  var val = "";
  for (var i = 0; i < cookies.length; i++) {
    var cookie = cookies[i].split("=");
    if (cookie[0] == ` ${cname}`) {
      return cookie[1];
    }
  }
  return "";
} 
```

* * *

## 回答 #38

> 赞同：0
> 
> 时间：2016-01-12T15:54:11.770

Cookie 示例：[示例](http://www.goo.gl/7KWXYJ) JS：

```
document.cookies = {
   create : function(key, value, time){
     if (time) {
         var date = new Date();
         date.setTime(date.getTime()+(time*24*60*60*1000));
         var expires = "; expires="+date.toGMTString();
     }
     else var expires = "";
     document.cookie = key+"="+value+expires+"; path=/";
   },
   erase : function(key){
     this.create(key,"",-1);
   },
   read : function(key){
     var keyX = key + "=";
     var ca = document.cookie.split(';');
     for(var i=0;i < ca.length; i++) {
        var c = ca[i];
        while (c.charAt(0)==' ') c = c.substring(1,c.length);
          if (c.indexOf(keyX) == 0) return   c.substring(keyX.length,c.length);
     }
     return null;
   }
} 
```

使用 json 或 xml 存储数组和对象

* * *

## 回答 #39

> 赞同：0
> 
> 时间：2021-03-23T02:16:39.900

```
const cookies = 'key1=chocolate; key2=iceCream; key3=cookies;';

// convert string into array with split
const arrCookies = cookies.split('; '); // [ 'key1=chocolate', 'key2=iceCream', 'key3=cookies' ]

// split key value by equal sign
const arrArrCookiesKeyValue = arrCookies.map(cookie => [cookie.split('=')]);  // [[['key1', 'chocolate']], ...']

// make an object with key value
const objectKeyValueCookies = {}; // { key1: 'chocolate', key2: 'iceCream', key3: 'cookies;' }
for (let arr of arrArrCookiesKeyValue) {
    objectKeyValueCookies[arr[0][0]] = arr[0][1];
}

// find the key in object
const findValueByKey = (key = null, objectCookies) => objectCookies[key];
console.log(findValueByKey('key2', objectKeyValueCookies)); // chocolate 
```

* * *

## 回答 #40

> 赞同：0
> 
> 时间：2016-01-11T07:29:48.290

以下函数将返回一`key-value`对所需的 cookie，其中`key`cookie 名称和 cookie`value`值在哪里。

```
/**
 * Returns cookie key-value pair
 */
var getCookieByName = function(name) {
    var result = ['-1','-1'];
    if(name) {
        var cookieList = document.cookie.split(';');
        result = $.grep(cookieList,function(cookie) { 
            cookie = cookie.split('=')[0];
            return cookie == name;
        });
    }
    return result;
}; 
```

* * *

## 回答 #41

> 赞同：0
> 
> 时间：2018-09-26T06:57:56.223

现在，当您以数组格式存储 cookie 时，您可以让 cookie 作为数组返回。例如你的 cookie 是 array[35]=Khóa; 数组[36]=Tử; 数组[37]=Cửa; 这段代码也带有utf8。当您的 cookie 名称内容 [] 在其中并且您存储的 cookie 不在数组中时，有一件事无法正常工作。

```
function getCookie(cname) {

            var ca = decodeURIComponent(document.cookie).split(';');

            if (cname.indexOf('[]') > 0) {
                var returnVAlue = [];
                var nameArray = cname.replace("[]", "");

                for(var i = 0; i < ca.length; i++) {
                    var c = ca[i];
                   // console.log(c);
                    while (c.charAt(0) == ' ') {
                        c = c.substring(1);
                    }

                    if (c.indexOf(nameArray) >= 0) {
                        var valueString = c.substr(nameArray.length, c.length);

                        var valueStringSlit = valueString.split('=');
                        valueStringSlit[0] = valueStringSlit[0].substr(1,(valueStringSlit[0].length - 2));
                    //    console.log(valueStringSlit);

                        returnVAlue.push(valueStringSlit);
                    }
                }
            } else {
                var returnVAlue = '';
                var name = cname + "=";

                for(var i = 0; i < ca.length; i++) {
                    var c = ca[i];
                   // console.log(c);
                    while (c.charAt(0) == ' ') {
                        c = c.substring(1);
                    }
                    if (c.indexOf(name) == 0) {
                        returnVAlue = c.substr(name.length, c.length);
                    } 
                }
            }

            if (returnVAlue != ''){
                return returnVAlue;
            } 
            return "";
        }

       // console.log(decodeURIComponent(document.cookie));

        console.log(getCookie('array[]')); 
```

* * *

## 回答 #42

> 赞同：0
> 
> 时间：2016-01-15T15:39:40.637

我会做这样的事情：

```
function getCookie(cookie){
  return cookie
    .trim()
    .split(';')
    .map(function(line){return line.split(',');})
    .reduce(function(props,line) {
      var name = line[0].slice(0,line[0].search('='));
      var value = line[0].slice(line[0].search('='));
      props[name] = value;
      return props;
    },{})
} 
```

这会将您的 cookie 作为对象返回。

然后你可以这样称呼它：

```
getCookie(document.cookie)['shares'] 
```

* * *

## 回答 #43

> 赞同：-2
> 
> 时间：2019-04-07T10:54:30.937

```
function GetCookieValue(name) {
    var found = document.cookie.split(';').filter(c => c.trim().split("=")[0] === name);
    return found.length > 0 ? found[0].split("=")[1] : null;
} 
```

# google-apps-script - 我的谷歌应用程序脚本在提交表单后发送电子邮件没有处理底层电子表格中的数组公式

> ID：10730363
> 
> 赞同：0
> 
> 时间：2012-05-24T02:30:06.167
> 
> 标签：google-apps-script

我一直在寻找没有任何运气的答案，所以我希望比我更聪明的人以前见过这个。这是我的问题：

I. 我有一个绑定到电子表格的 Google 表单来捕获订单数据。该电子表格在一个单元格中有一个数组公式，用于根据表单 (SubTotal) 中的选择计算美元金额。

二、我创建了一个 GAS 以根据表单数据向订购方发送确认电子邮件并复制其他相关方。它有一个 OnFormSubmit 的触发事件。

三、一切都很好，除了字段 SubTotal 的值在脚本生成的电子邮件中显示为“未定义”。

这是 GAS 代码：

```
function orderconfemail(e) {
  var timestamp = e.values[0];
  var playerLastName = e.values[1];
  var playerFirstName = e.values[2];
  var jerseyNumber = e.values[3];
  var ageGroup = e.values[5];
  var parentLastName = e.values[6];
  var parentFirstName = e.values[7];
  var toAddress = e.values[8];
  var ccAddress = e.values[17];
  var teamName = e.values[13];
  var coachName = e.values[14];
  var mgrName = e.values[16];
  var homeSize = e.values[20];
  var homeQty = e.values[21];
  var awayOrdered = e.values[22];
  var awaySize = e.values[23];
  var awayQty = e.values[24];
  var shortSize = e.values[26];
  var shortQty = e.values[27];
  var jcktOrdered = e.values[28];
  var jcktSize = e.values[29];
  var jcktQty = e.values[30];
  var pntsOrdered = e.values[31];
  var pntsSize = e.values[32];
  var pntsQty = e.values[33];
  var bagOrdered = e.values[34];
  var bagQty = e.values[35];
  var orderTotal = e.values[36];
  var subject = "Futura FC Uniform Order Confirmation for " + playerFirstName + " " + playerLastName;
  var htmlBody = "Thank you for your uniform order, " + parentFirstName + "! Your order date / time was: " + timestamp + "." + 
      "<br/>&nbsp;</br>Your order details are as follows: " +
      "<br/>&nbsp;<br/><b>Player Name:</b> " + playerFirstName + " " + playerLastName +
      "<br/><b>Jersey Number:</b> " + jerseyNumber +
      "<br/><b>Age Goup:</b> " + ageGroup +
      "<br/><b>Team:</b> " + teamName +
      "<br/><b>Coach:</b> " + coachName +
      "<br/><b>Manager:</b> " + mgrName +
      "<br/><b>Home Jersey Size:</b> " + homeSize + 
      "<br/><b>Home Jersey Qty:</b> " + homeQty +
      "<br/><b>Away Jersey Ordered?</b> " + awayOrdered +
      "<br/><b>Away Jersey Size:</b> " + awaySize +
      "<br/><b>Away Jersey Qty:</b> " + awayQty +
      "<br/><b>Short Size:</b> " + shortSize +
      "<br/><b>Short Qty:</b> " + shortQty +
      "<br/><b>Warm Up Jacket Ordered?</b> " + jcktOrdered +
      "<br/><b>Jacket Size:</b> " + jcktSize +
      "<br/><b>Jacket Qty:</b> " + jcktQty +
      "<br/><b>Warm Up Pants Ordered?</b> " + pntsOrdered +
      "<br/><b>Pants Size:</b> " + pntsSize +
      "<br/><b>Pants Qty:</b> " + pntsQty +
      "<br/><b>Backpack Ordered?</b> " + bagOrdered +
      "<br/><b>Backpack Qty:</b> " + bagQty +
      "<br/>&nbsp;<br/><b>Your Order Total:</b> " + orderTotal;
  var optAdvancedArgs = {cc: ccAddress, bcc: "someone@aol.com,someone@embarqmail.com", htmlBody: htmlBody};
  MailApp.sendEmail(toAddress, subject, "Message Body", optAdvancedArgs);
} 
```

这就是它在我的电子邮件中的显示方式（为了空间，我删除了除小计之外的所有内容）。

> 谢谢你的制服订单，家长！您的订单日期/时间是：5/23/2012 20:10:23。
> 
> **您的订单总额：未定义**

电子表格确实显示了正确的计算小计，但电子邮件没有。我可以吗：

I. 计算 GAS 中的小计？

二、强制脚本在发送电子邮件之前将行写入电子表格？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T05:16:47.970

同意恩里克。最好的办法是计算 GAS 脚本中的总数。代替

var orderTotal = e.values[36];

你可以有

var orderTotal = // 在这里进行计算。但是，请确保您有 parseInt(e.values[x])，因为 e.values 中的所有参数都是字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T03:30:33.023

> 二、强制脚本在发送电子邮件之前将行写入电子表格？

在触发函数之前，数据已经在电子表格中（因此，无法强制执行）。

问题是您正在获取事件参数中传递的值，这些值是在表单中发送的（所有字符串），而不是电子表格上的值，如您所想。

不幸的是，识别实际表单值被保存的行（以便您可以获取它们）并不像我们想要的那么容易。请查看[第 128](http://code.google.com/p/google-apps-script-issues/issues/detail?id=128)期了解更多信息。

`orderTotal`无论如何，在您的情况下，我认为在脚本本身中计算要容易得多。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T05:03:57.957

Henrique 和 Srik 都非常有助于为我指明正确的方向。我能够创建另一个变量，将每个数量解析为一个整数，然后做一些简单的数学运算来进行计算。这是我正常运行的 GAS 脚本现在的样子：

```
function orderconfemail(e) {
  var timestamp = e.values[0];
  var playerLastName = e.values[1];
  var playerFirstName = e.values[2];
  var jerseyNumber = e.values[3];
  var ageGroup = e.values[5];
  var parentLastName = e.values[6];
  var parentFirstName = e.values[7];
  var toAddress = e.values[8];
  var ccAddress = e.values[17];
  var teamName = e.values[13];
  var coachName = e.values[14];
  var mgrName = e.values[16];
  var homeSize = e.values[20];
  var homeQty = e.values[21];
  var homeQtyInt = parseInt(e.values[21]);
  var awayOrdered = e.values[22];
  var awaySize = e.values[23];
  var awayQty = e.values[24];
  var awayQtyInt = parseInt(e.values[24]);
  var shortSize = e.values[26];
  var shortQty = e.values[27];
  var shortQtyInt = parseInt(e.values[27]);
  var jcktOrdered = e.values[28];
  var jcktSize = e.values[29];
  var jcktQty = e.values[30];
  var jcktQtyInt = parseInt(e.values[30]);
  var pntsOrdered = e.values[31];
  var pntsSize = e.values[32];
  var pntsQty = e.values[33];
  var pntsQtyInt = parseInt(e.values[33]);
  var bagOrdered = e.values[34];
  var bagQty = e.values[35];
  var bagQtyInt = parseInt(e.values[35]);
  var orderTotal = ((homeQtyInt*40.50)+(awayQtyInt*25)+(shortQtyInt*24)+(jcktQtyInt*50)+(pntsQtyInt*32.50)+(bagQtyInt*40));
  var subject = "TEST! Futura FC Uniform Order Confirmation for " + playerFirstName + " " + playerLastName;
  var htmlBody = "Thank you for your uniform order, " + parentFirstName + "! Your order date / time was: " + timestamp + "." + 
      "<br/>&nbsp;</br>Your order details are as follows: " +
      "<br/>&nbsp;<br/><b>Player Name:</b> " + playerFirstName + " " + playerLastName +
      "<br/><b>Jersey Number:</b> " + jerseyNumber +
      "<br/><b>Age Goup:</b> " + ageGroup +
      "<br/><b>Team:</b> " + teamName +
      "<br/><b>Coach:</b> " + coachName +
      "<br/><b>Manager:</b> " + mgrName +
      "<br/><b>Home Jersey Size:</b> " + homeSize + 
      "<br/><b>Home Jersey Qty:</b> " + homeQty +
      "<br/><b>Away Jersey Ordered?</b> " + awayOrdered +
      "<br/><b>Away Jersey Size:</b> " + awaySize +
      "<br/><b>Away Jersey Qty:</b> " + awayQty +
      "<br/><b>Short Size:</b> " + shortSize +
      "<br/><b>Short Qty:</b> " + shortQty +
      "<br/><b>Warm Up Jacket Ordered?</b> " + jcktOrdered +
      "<br/><b>Jacket Size:</b> " + jcktSize +
      "<br/><b>Jacket Qty:</b> " + jcktQty +
      "<br/><b>Warm Up Pants Ordered?</b> " + pntsOrdered +
      "<br/><b>Pants Size:</b> " + pntsSize +
      "<br/><b>Pants Qty:</b> " + pntsQty +
      "<br/><b>Backpack Ordered?</b> " + bagOrdered +
      "<br/><b>Backpack Qty:</b> " + bagQty +
      "<br/>&nbsp;<br/><b>Your Order Total:</b> " + orderTotal;
  var optAdvancedArgs = {cc: ccAddress, bcc: "mmcgriggs@aol.com,futurauniforms@embarqmail.com", htmlBody: htmlBody};
  MailApp.sendEmail(toAddress, subject, "Message Body", optAdvancedArgs);
} 
```

我也遇到了另一个“陷阱”。我的表单有一些允许 NULL 值的 Qty 字段。遇到该值时，OrderTotal 将在电子邮件中报告为“NaN”。我只是返回并将 0 作为我所有数量字段的默认值来纠正这个问题。谢谢大家！

# sql - 在 Oracle SQL 中构建临时表

> ID：10730364
> 
> 赞同：1
> 
> 时间：2012-05-24T02:30:13.783
> 
> 标签：sql, oracle, temp-tables

我正在尝试制作一个在两个值之间“存储”解码的子表，因为我需要多次使用该解码。假设这些是我的表：

```
Table Person
Name    Number_name
Jeremy  One
Thomas  Two
Stephen Three 
```

我当前的 SQL 如下所示：

```
SELECT
    decode (number_name,
    'one',1,
    'two',2,
    'three',3,
    'four',4)
    num
    FROM person where name = 'Jeremy'
    and (some other condition)
UNION SELECT
    decode (number_name,
    'one',1,
    'two',2,
    'three',3,
    'four,4)
    num
    FROM Person
    where Name <> "Jeremy"
    and (some other condition) 
```

我想做的是这样的：

```
SELECT num from my_temp_table where name = "Jeremy" and (some other condition)
union select num from my_temp_table where name <> "Jeremy" and (some other condition)
... 
```

在该查询期间构造 my_temp_table 的位置（当查询完成运行时它不再存在）并且看起来像

```
Table my_temp_table
Name  num
One   1
Two   2
Three 3
Four  4 
```

并且希望我可以在没有“选择一个名称，1 个来自双重联合的所有...”的情况下做到这一点

这是可行的吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-24T02:43:08.583

该`WITH`条款听起来与您所描述的最接近。但这需要您以某种方式生成数据。选择`DUAL`可能是最简单的选择

```
WITH my_temp_table AS (
  SELECT 'One' name, 1 num from dual union all
  SELECT 'Two', 2 from dual union all
  SELECT 'Three', 3 from dual union all
  SELECT 'Four', 4 from dual
)
SELECT *
  FROM my_temp_table 
       JOIN person ON (<<some join condition>>)
 WHERE <<some predicate>> 
```

由于您不想合并一堆查询，因此您可以执行类似的操作

```
WITH my_temp_table AS (
  select level num,
         initcap( to_char( to_date( level, 'J' ),
                           'JSP' )) name
    from dual
 connect by level <= 4
)
... 
```

# ruby-on-rails - RoR 错误：SQLite3::SQLException：没有这样的列：comments.micropost_id: SELECT "comments".* FROM "comments" WHERE "comments"."micropost_id" = 2

> ID：10730366
> 
> 赞同：0
> 
> 时间：2012-05-24T02:31:08.463
> 
> 标签：ruby-on-rails, ruby-on-rails-3.2

我正在与用户一起开发一个应用程序，他们每个人的页面上都显示了一组微博。我正在尝试为这些微博添加评论。每次访问 localhost:3000/users/(user_id_#)。标题中给出的错误中的 user_id 为 2。

SQLite3::SQLException：没有这样的列：comments.micropost_id: SELECT "comments".* FROM "comments" WHERE "comments"."micropost_id" = 2

仅当用户要显示微博时才会出现此错误。否则它只会显示他们的空白页。错误来自此视图 app/views/users/show.html.erb 此视图呈现此部分，错误发生在第 13 行。

```
<li>
  <span class="content"><%= micropost.content %></span>
  <span class="timestamp">
    Posted <%= time_ago_in_words(micropost.created_at) %> ago.
  </span>
  <% if current_user?(micropost.user) %>
    <%= link_to "delete", micropost, method:  :delete,
                                     confirm: "You sure?",
                                     title:   micropost.content %>
  <% end %>

  <h2>Comments</h2>
  <% micropost.comments.each do |comment| %>
    <p>
      <b>Commenter:</b>
      <%= comment.commenter %>
    </p>

    <p>
      <b>Comment:</b>
      <%= comment.body %>
    </p>
  <% end %>

  <h3>Add a comment:</h3>
  <%= form_for([micropost, micropost.comments.build]) do |f| %>
    <div class="field">
      <%= f.label :commenter %><br />
      <%= f.text_field :commenter %>
    </div>
    <div class="field">
      <%= f.label :body %><br />
      <%= f.text_area :body %>
    </div>
    <div class="actions">
      <%= f.submit %>
    </div>
  <% end %>
</li> 
```

这是我的comment.rb 文件

```
class Comment < ActiveRecord::Base
  belongs_to :micropost
  attr_accessible :body, :user_id

end 
```

和我的 micropost.rb 文件

```
class Micropost < ActiveRecord::Base
  attr_accessible :content
  belongs_to :user
  has_many :comments

  validates :content, presence: true, length: { maximum: 140 }
  validates :user_id, presence: true
end 
```

和我的comments_controller.rb

```
class CommentsController < ApplicationController
  def create
    @micropost = Micropost.find(params[:micropost_id])
    @comment = @micropost.comments.create(params[:comment])
    redirect_to micropost_path(@micropost)
  end

end 
```

最后是我的 microposts_controller.rb

```
class MicropostsController < ApplicationController
  before_filter :signed_in_user
  before_filter :correct_user,   only: :destroy

  def create
    @micropost = current_user.microposts.build(params[:micropost])
    if @micropost.save
      flash[:success] = "Micropost created!"
      redirect_to root_path
    else
      @feed_items = []
      render 'static_pages/home'
    end
  end

  def new
    @micropost = Micropost.new(params[:micropost])
  end

  def show

    @micropost = Micropost.find(params[:id])

  end

  def destroy
    @micropost.destroy
    redirect_back_or root_path
  end

  private

    def correct_user
      @micropost = current_user.microposts.find_by_id(params[:id])
      redirect_to root_path if @micropost.nil?
    end
end

    class CommentsController < ApplicationController
      def create
        @micropost = Micropost.find(params[:micropost_id])
        @comment = @micropost.comments.create(params[:comment])
        redirect_to micropost_path(@micropost)
      end

    end 
```

这里也是 users_controller.rb

```
class UsersController < ApplicationController
  before_filter :signed_in_user, 
                only: [:index, :edit, :update, :destroy, :following, :followers]
  before_filter :correct_user,   only: [:edit, :update]
  before_filter :admin_user,     only: :destroy

  def index
    @users = User.paginate(page: params[:page])
  end

  def show
    @user = User.find(params[:id])
    @microposts = @user.microposts.paginate(page: params[:page])

  end

  def new
    @user = User.new
  end

  def create
    @user = User.new(params[:user])
    if @user.save
      sign_in @user
      flash[:success] = "Welcome to the Sample App!"
      redirect_to @user
    else
      render 'new'
    end
  end

  def edit
  end

  def update
    if @user.update_attributes(params[:user])
      flash[:success] = "Profile updated"
      sign_in @user
      redirect_to @user
    else
      render 'edit'
    end
  end

  def destroy
    User.find(params[:id]).destroy
    flash[:success] = "User destroyed."
    redirect_to users_path
  end

  def following
    @title = "Following"
    @user = User.find(params[:id])
    @users = @user.followed_users.paginate(page: params[:page])
    render 'show_follow'
  end

  def followers
    @title = "Followers"
    @user = User.find(params[:id])
    @users = @user.followers.paginate(page: params[:page])
    render 'show_follow'
  end

  private

    def correct_user
      @user = User.find(params[:id])
      redirect_to(root_path) unless current_user?(@user)
    end

    def admin_user
      redirect_to(root_path) unless current_user.admin?
    end
end 
```

从错误看来，@micropost 没有在 def show 下的 microposts_controller.rb 文件中初始化。但我认为是？我究竟做错了什么？谢谢

这里也是 app/views/users/show.html.erb

```
<% provide(:title, @user.name) %>
<div class="row">
  <aside class="span4">
    <section>
      <h1>
        <%= gravatar_for @user %>
        <%= @user.name %>
      </h1>
    </section>
  </aside>
  <div class="span8">
    <%= render 'follow_form' if signed_in? %>
    <% if @user.microposts.any? %>
      <h3>Microposts (<%= @user.microposts.count %>)</h3>
      <ol class="microposts">
        <%= render @microposts %>
      </ol>
      <%= will_paginate @microposts %>
    <% end %>
  </div>
</div> 
```

这是创建评论迁移

```
class CreateComments < ActiveRecord::Migration
  def change
    create_table :comments do |t|
      t.string :user_id
      t.text :body
      t.references :micropost_id

      t.timestamps
    end
    add_index :comments, :micropost_id
  end
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T02:36:42.033

该错误听起来好像您没有进行迁移以将 micropost_id 添加到评论并迁移数据库，所以我将从那里开始。

您的迁移表明您正在使用

```
t.references :micropost_id 
```

但是 t.references 接受模型名称，而不是foreign_key，因此将其更改为

```
t.references :micropost 
```

或者更改对 micropost_id 的整数的引用，或者应该给你你想要的结果。

修复迁移后，您可能需要将`rake db:reset`所有内容恢复到您想要的位置。

# r - 合并数据框中的行

> ID：10730368
> 
> 赞同：16
> 
> 时间：2012-05-24T02:31:15.107
> 
> 标签：r, plyr, data.table

我有一个关系数据集，我正在寻找二元信息。

我有 4 列。发送者、接收者、属性、边缘

我正在寻找重复的 Sender -- Receiver 计数并将它们转换为附加边缘。

```
df <- data.frame(sender = c(1,1,1,1,3,5), receiver = c(1,2,2,2,4,5), 
                attribute = c(12,12,12,12,13,13), edge = c(0,1,1,1,1,0))

   sender receiver attribute edge
1       1        1        12    0
2       1        2        12    1
3       1        2        12    1
4       1        2        12    1
5       3        4        13    1 
```

我希望最终结果如下所示：

```
 sender receiver attribute edge
1      1        1        12    0
2      1        2        12    3
3      3        4        13    1 
```

其中重复的发送方-接收方之间的关系已经合并，并且重复的数量包含在边数中。

任何输入将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-05-24T03:14:35.137

为了好玩，这里有两个其他选项，第一个使用基本函数`aggregate()`，第二个使用`data.table`包：

```
> aggregate(edge ~ sender + receiver + attribute, FUN = "sum", data = df)
  sender receiver attribute edge
1      1        1        12    0
2      1        2        12    3
3      3        4        13    1
4      5        5        13    0
> require(data.table)
> dt <- data.table(df)
> dt[, list(sumedge = sum(edge)), by = "sender, receiver, attribute"]
     sender receiver attribute sumedge
[1,]      1        1        12       0
[2,]      1        2        12       3
[3,]      3        4        13       1
[4,]      5        5        13       0 
```

为了记录，这个问题已经被问了很多很多次，仔细阅读[我自己的答案](https://stackoverflow.com/search?q=user:415635+[plyr])会产生几个答案，这些答案将为您指明正确的道路。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-24T02:35:10.707

`plyr`是你的朋友 - 虽然我认为你的最终结果并不完全正确给定输入数据。

```
library(plyr)

ddply(df, .(sender, receiver, attribute), summarize, edge = sum(edge)) 
```

退货

```
 sender receiver attribute edge
1      1        1        12    0
2      1        2        12    3
3      3        4        13    1
4      5        5        13    0 
```

# python - 如何在正则表达式中包含特殊部分以使用 python re.findall 查找英文名称？

> ID：10730370
> 
> 赞同：0
> 
> 时间：2012-05-24T02:31:28.557
> 
> 标签：python, regex

我有一个如下的 python 代码来搜索所有的英文名称：

```
a = "Bonds met Susann (&quot;Sun&quot;) Margreth Branco, the mother of his first two children, in {{city-state|Montreal|Quebec}} in August 1987\. They eloped in {{city-state|Las Vegas|Nevada}} Barry Bonds"

re.findall("(?:[A-Z][a-z'.]+\s*){1,4}",a) 
```

我希望它返回：

```
['Bonds', 'Susann (&quot;Sun&quot;) Margreth Branco', 'Montreal', 'Quebec', 'August', 'They', 'Las Vegas','Nevada','Barry Bonds'] 
```

我的代码无法得到我想要的，如何修改正则表达式来实现我的目标？

我想补充一点，我使用了另一个正则表达式，`(?:(([A-Z][a-z'.]+)|(\(&quot.*&quot;\)))\s*){1,4}`. 我在[regexpal.com](http://regexpal.com)上对其进行了测试，它在该测试网站上找到了我想要的东西，但是在 Python 中，它只是不返回我想要的东西，而是分别返回我`Susan`and`(&quot;Sun&quot;) Margreth`和`Branco`三个，但我想要`Susan (&quot;Sun&quot;) Margreth Branco`在我的结果中

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T03:44:08.743

正如您所提到的，带有“&quto”的字符串也看起来像分隔符：

```
re.findall("[A-Z][a-z]*(?:(?:\\S*&quot\\S*|\\s)+[A-Z][a-z]*){0,3}", "Bonds met Susann (&quot;Sun&quot;) Margreth Branco, the mother of his first two children, in {{city-state|Montreal|Quebec}} in August 1987\. They eloped in {{city-state|Las Vegas|Nevada}} Barry Bonds") 
```

输出：

```
['Bonds', 'Susann (&quot;Sun&quot;) Margreth Branco', 'Montreal', 'Quebec', 'August', 'They', 'Las Vegas', 'Nevada', 'Barry Bonds'] 
```

# symfony - 教义听众与订阅者

> ID：10730377
> 
> 赞同：82
> 
> 时间：2012-05-24T02:32:01.550
> 
> 标签：symfony, doctrine-orm

我在 Symfony2 框架中工作，想知道什么时候会使用 Doctrine 订阅者而不是侦听器。Doctrine 的听众[文档](http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/reference/events.html)非常清晰，但订阅者却被掩盖了。Symfony 的[食谱条目](http://symfony.com/doc/current/cookbook/doctrine/event_listeners_subscribers.html)是类似的。

* * *

## 回答 #1

> 赞同：97
> 
> 时间：2012-06-14T10:46:14.917

在我看来，只有一个主要区别：

*   侦听器已注册，指定它侦听的事件。
*   订阅者有一个方法告诉调度者它正在监听什么事件

这可能看起来没什么大区别，但如果你仔细想想，在某些情况下你想使用一个而不是另一个：

*   您可以将一个侦听器分配给具有不同事件的多个调度程序，因为它们是在注册时设置的。您只需要确保每个方法都在侦听器中就位
*   您可以更改订阅者在运行时注册的事件，甚至在注册订阅者之后通过更改返回值`getSubscribedEvents`（想想有一次您收听一个非常嘈杂的事件并且您只想执行一次）

可能还有其他我不知道的差异！

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2014-04-15T10:31:34.673

不知道这是意外还是故意..但订阅者的优先级高于听众 - [https://github.com/symfony/symfony/blob/master/src/Symfony/Bridge/Doctrine/DependencyInjection/CompilerPass/RegisterEventListenersAndSubscribersPass .php#L73-L98](https://github.com/symfony/symfony/blob/master/src/Symfony/Bridge/Doctrine/DependencyInjection/CompilerPass/RegisterEventListenersAndSubscribersPass.php#L73-L98)

从学说方面，它不在乎它是什么（监听器或订阅者），最终两者都注册为监听器 - [https://github.com/doctrine/common/blob/master/lib/Doctrine/Common/EventManager.php #L137-L140](https://github.com/doctrine/common/blob/master/lib/Doctrine/Common/EventManager.php#L137-L140)

这是我发现的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-11-21T16:09:29.197

当你想在一个类中处理多个事件时，你应该使用事件订阅者，例如在这个[symfony2 文档页面文章中](http://symfony.com/doc/current/cookbook/doctrine/event_listeners_subscribers.html)，人们可能会注意到事件监听器只能管理一个事件，但是假设你想为一个实体处理多个事件，prePersist、preUpdate、postPersist 等......如果你使用事件监听器，你将不得不编写几个事件监听器，每个事件一个，但是如果您使用事件订阅者，您只需为事件订阅者编写一个类，看看使用事件订阅者您可以在一个类中管理多个事件，这就是我使用它的方式，我更喜欢要专注于模型业务需要的代码，一个示例可能是您只想为一组实体在全局范围内处理多个生命周期事件，为此您可以编写父类并在其中定义这些全局方法，然后让您的实体继承该类，然后在您的事件订阅者中订阅您想要的每个事件，prePersist，preUpdate、postPersist 等......然后请求该父类并执行这些全局方法。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-03-11T16:55:29.273

另一件重要的事情：Doctrine EventSubscribers 不允许您设置优先级。

[在此处](https://github.com/symfony/symfony/issues/6979)阅读有关此问题的更多信息

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-05-24T15:58:44.397

两者都允许您在特定事件前/后持久等上执行某些操作。

然而，监听器只允许你执行封装在你的实体中的行为。因此，一个示例可能是更新“date_edited”时间戳。

如果您需要移出实体的上下文，那么您将需要一个订阅者。一个很好的例子可能是调用外部 API，或者如果您需要使用/检查与您的实体不直接相关的数据。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2018-03-19T11:46:54.643

这是文档在 4.1 中所说的内容。由于这在全球范围内适用于事件，我想它对 Doctrine 也有效（不是 100% 肯定）。

> 听众或订阅者
> 
> 侦听器和订阅者可以在同一个应用程序中模糊地使用。使用其中任何一个的决定通常取决于个人喜好。但是，它们每个都有一些小优点：
> 
> *   订阅者更容易重用，因为事件的知识保存在类中而不是服务定义中。这就是 Symfony 在内部使用订阅者的原因。
> *   侦听器更灵活，因为捆绑可以根据某些配置值有条件地启用或禁用每个侦听器。

[http://symfony.com/doc/master/event_dispatcher.html#listeners-or-subscribers](http://symfony.com/doc/master/event_dispatcher.html#listeners-or-subscribers)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-09-26T10:10:06.320

从文档中：

> 侦听事件的最常见方法是向调度程序注册事件侦听器。此侦听器可以侦听一个或多个事件，并在每次调度这些事件时收到通知。
> 
> 另一种监听事件的方法是通过事件订阅者。事件订阅者是一个 PHP 类，它能够准确地告诉调度程序它应该订阅哪些事件。它实现了 EventSubscriberInterface 接口，该接口需要一个名为 getSubscribedEvents() 的静态方法。

请参阅此处的示例：

[https://symfony.com/doc/3.3/components/event_dispatcher.html](https://symfony.com/doc/3.3/components/event_dispatcher.html)

# css - 如何更改 a:hover 背景图像的默认矩形视图？

> ID：10730380
> 
> 赞同：1
> 
> 时间：2012-05-24T02:32:56.713
> 
> 标签：css

例如，

```
a:hover {
    color: black;
    background:url("images/nav-hm.png");
} 
```

悬停时显示的背景图像始终包含在链接周围的矩形框中，即使图像不是矩形。

有没有办法去掉长方形的盒子外壳？

提前致谢

**更新**

我打算用于背景图像的内容 -[图像](http://i418.photobucket.com/albums/pp270/ravenoz_bucket/Untitled-2-1.png) 该图像实际上是裁剪后的云图像。我希望云在悬停时完全显示。

即使将背景图像的宽度和高度设置为匹配，它也不会完全显示。这就是所显示的。 [图片2](http://i418.photobucket.com/albums/pp270/ravenoz_bucket/zzzzzzzzzzz.png)

调整宽度和高度以匹配使用的实际图像后的代码

```
a:hover {
  color: black;
  background:url("images/Untitled-2-2.png");
  width:337px;
  height:292px;
  } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T03:21:34.150

如果`a`元素是矩形的（或类似矩形的，想想它如何包裹多行），那么它的背景是矩形的。根据您所追求的形状，您可以使用 更改其外观`border-radius`，或者可以选择加入 a 的某些特定渲染`text-shadow`。如果您提供了您正在尝试完成的模型，将会有所帮助。

哦，顺便说一句。图像*是*矩形的 :) 即使某些区域是完全透明的，位图，或者至少是网络上使用的那些，也不能有不同的形状。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T03:47:01.310

这是一个完整的跨浏览器边界半径示例

```
a{
  padding-left:5px;
  padding-right:5px;
  width:337px;
  height:292px;
}

a:hover {
  color: black;
  background:url("images/Untitled-2-2.png");
 /* Add border radius */    
  -moz-border-radius: 4px;
  -webkit-border-radius: 4px;
  -khtml-border-radius: 4px;
  border-radius: 4px;
} 
```

# jquery - 为什么“jQuery-Rails”经常在资产组之外

> ID：10730386
> 
> 赞同：13
> 
> 时间：2012-05-24T02:33:42.500
> 
> 标签：jquery, ruby-on-rails-3, gemfile

为什么经常`gem 'jquery-rails`在群外看到`:assets`？

```
group :assets do
  gem 'sass-rails', " ~> 3.1.0"
  gem 'coffee-rails', " ~> 3.1.0"
  gem 'uglifier'
end

gem 'jquery-rails' 
```

如果我把它放在里面会有错误的行为吗？

谢谢！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-13T12:37:55.567

gem 还提供了`jquery-rails`一些测试助手。因此，也许出于这个原因，人们更愿意将其置于`:assets`群体之外。

但是，该`:assets`组包含在开发和测试环境中，因此如果您愿意，您应该完全安全地放入`jquery-rails`您的`:assets`组中。

只需确保在部署应用程序之前预编译资产。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-06-14T09:49:08.700

真正的答案是，这`gem 'jquery-rails'`通常会在生产中中断，除了从一开始就初始化 gem 本身之外，没有标准的方法可以解决这个问题。我在heroku上看到过这个问题。

解决这个问题的方法是把组放在`jquery-rails`外面`:assets`，这样你就可以确定它不会解散。

即使这个问题是一个老问题，我想确保这就是原因，你可能需要把`'jquery-rails'` **OUTSIDE** `:assets`组。

# iphone - Core Data 中的高级 NSPredicate 语句（字符串比较）

> ID：10730387
> 
> 赞同：0
> 
> 时间：2012-05-24T02:33:44.403
> 
> 标签：iphone, objective-c, cocoa-touch, core-data, nspredicate

我现在正在尝试使用以下方法过滤项目：

我的托管对象是这样的：

```
@interface MyManagedObject:NSManagedObject

@property (nonatomic, retain) NSString *name;

@end 
```

例如，对象的名称是“ABCDEF GHIJKL 公司”

当我使用字符串“BCD IJK pan”或“BCD pan”等进行搜索时，

（BCD是ABCDEF的子串，IJK是GHIJKL的子串，pan是company的子串）

它应该能够找到对象。

我不知道如何用这个写一个谓词。我尝试使用 predicateWithBlock：但 Core Data 不支持 predicateWithBlock 中的谓词：

我还尝试先获取所有对象并使用谓词块过滤结果。但它非常慢，因为我在核心数据中有大约 10M 对象。

所以我想问我可以在一个谓词语句中做到这一点吗？非常感谢！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T02:55:21.243

`LIKE`如果您包含通配符，您可以这样做`*`。所以如果你用`self LIKE %@, @"*BCD*IJK*pan*`它搜索就会找到它

# java - 在 Java / Android 中循环数月

> ID：10730388
> 
> 赞同：0
> 
> 时间：2012-05-24T02:34:12.190
> 
> 标签：java, android, date, loops

我想遍历一年中的几个月并打印出来。

例如：

01/2012 02/2012 03/2012 04/2012 等等...

这是我的代码：

```
 Calendar myDate = Calendar.getInstance();

 for (int i = 0; i < totalMonths; i++) {
        TableRow row = new TableRow(this);
        myDate.add(Calendar.MONTH, i);
        FinalDate = df.format(myDate.getTime());
        TextView tvNum = new TextView(this);
        tvNum.setText("      " + FinalDate);
        row.addView(tvNum);
        table.addView(row);
    }
} 
```

它在 int 中打印出来

1 2 3 4 5

但是，当我将其转换为日期字符串时，如上面的代码所示，它会这样做：

05/2012 06/2012 08/2012 11/2012 03/2013 08/2013

基本上，月的间隔是 1，然后是 2，然后是 3，然后是 4 等等......我的计算是否错误？（显示 1,2,3,4 等 int 列表正在做它应该做的事情）还是有更好的方法来打印几个月？

我只是想让它走

今天的日期 + 1 个月 今天的日期 + 2 个月等...这个 m

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T02:38:53.847

您`i`每次都将月份添加到当前日期。

因此，第三次迭代将`2`月份添加到前一个日期，第四次添加`3`，依此类推。

您应该`1`每次只添加一个月。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T02:39:12.473

你在哪里定义 myDate？在循环之外，我假设？如果是这样，那么您第一次添加 0+0，第二次添加 (0+0)+1，第三次添加 (0+0+1)+2，依此类推。

要解决此问题，您必须在循环内定义 myDate。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T02:39:19.333

代替 ：

```
myDate.add(Calendar.MONTH, i); 
```

放

```
myDate.add(Calendar.MONTH, 1); 
```

否则每次都创建一个新日期。目前您正在操作您的实际 myDate 对象。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2019-01-16T12:15:32.633

## java.time 通过脱糖

我想贡献现代的答案，现代的方式来获得你的结果。我建议这些天您使用现代 Java 日期和时间 API java.time 来进行日期工作。其他人已经很好地解释了为什么您的代码给出了意外的输出，我不再重复了。

```
 int noOfMonths = 13;
    YearMonth current = YearMonth.now(ZoneId.of("Africa/Tunis"));
    for (int i = 0; i < noOfMonths; i++) {
        System.out.println(current);
        current = current.plusMonths(1);
    } 
```

当我今天运行这个片段时，输出是：

```
2019-01
2019-02
2019-03
2019-04
2019-05
2019-06
2019-07
2019-08
2019-09
2019-10
2019-11
2019-12
2020-01 
```

如果您想要月份名称，请使用格式化程序：

```
 DateTimeFormatter monthFormatter = DateTimeFormatter.ofPattern("MMMM u", Locale.ENGLISH);
    int noOfMonths = 13;
    YearMonth current = YearMonth.now(ZoneId.of("Africa/Tunis"));
    for (int i = 0; i < noOfMonths; i++) {
        System.out.println(current.format(monthFormatter));
        current = current.plusMonths(1);
    } 
```

输出：

```
January 2019
February 2019
March 2019
April 2019
May 2019
June 2019
July 2019
August 2019
September 2019
October 2019
November 2019
December 2019
January 2020 
```

当这个问题在将近 7 年前被问到时，`Calendar`是我们为这样的任务准备的课程，也是当它设计不佳且使用起来很麻烦的时候。不再是：java.time 在几年后推出了 Java 8，并且也被向后移植到了 Java 6 和 7。

## 问题：java.time 不需要 Android API 级别 26 吗？

java.time 在较旧和较新的 Android 设备上都能很好地工作。它只需要至少**Java 6**。

*   在 Java 8 及更高版本以及更新的 Android 设备（从 API 级别 26 开始）中，现代 API 是内置的。
*   在非 Android Java 6 和 7 中获得 ThreeTen Backport，现代类的后向端口（ThreeTen 用于 JSR 310；请参阅底部的链接）。
*   在较旧的 Android 上，要么使用脱糖，要么使用 ThreeTen Backport 的 Android 版本。它被称为 ThreeTenABP。在后一种情况下，请确保您从`org.threeten.bp`子包中导入日期和时间类。

## 链接

*   [Oracle 教程：日期时间](https://docs.oracle.com/javase/tutorial/datetime/)解释如何使用 java.time。
*   [Java 规范请求 (JSR) 310](https://jcp.org/en/jsr/detail?id=310)，`java.time`第一次描述的地方。
*   [ThreeTen Backport 项目](http://www.threeten.org/threetenbp/)，`java.time`Java 6 和 7 的反向移植（ThreeTen for JSR-310）。
*   [可通过脱糖获得 Java 8+ API](https://developer.android.com/studio/write/java8-support-table)
*   [ThreeTenABP](https://github.com/JakeWharton/ThreeTenABP) , ThreeTen Backport 的 Android 版
*   [问题：如何在Android项目中使用ThreeTenABP](https://stackoverflow.com/questions/38922754/how-to-use-threetenabp-in-android-project)，有非常详尽的解释。

# php - 如何在 PHP 中获取重载对象中的变量名？

> ID：10730393
> 
> 赞同：0
> 
> 时间：2012-05-24T02:34:53.750
> 
> 标签：php, mongodb, object, overloading, document-oriented-db

我正在使用 PHP 的重载，我想要做的是；当我调用对象时，它看起来像这样。

```
$obj->person->name->function(); 
```

为此，我使用 __get 和 __call 函数。它们看起来像这样：

```
function __get($field){
    return $this;
} 
```

但是，我想知道 person 和 name 的变量名，因为它可以随时改变。我试着这样做：

```
function __get($field){
    $array[] = $field;
    return new object($array);
} 
```

他们被保存了，但是当我添加另一行时，它只是将它添加到数组中。调用函数后它不会清理。我试图在 __call 处清空数组，但这没有帮助。我想谷歌这个，但到目前为止..我不走运。

**PHP中是否有本机函数？**

> ——阅读太多？停在这里，剩下的只是更多的解释——

但是 __call 发送数组并将您发送到另一个处理真实函数的类。

**原因：** 我有 5 个程序员习惯了 mongoDB 类，我们正在将大型代码库从 MongoDB 更改为另一个 DB。通过此修复，我们将能够一次更改整个代码库的数据库，而无需麻烦地构建查询。我们只是在函数类中进行查询。（调用 __call 时访问）。但是，今天的数据库查询的典型行如下所示：

```
$this->db->accounts->update(<array>); 
```

这条线连接到一个数据库，在该数据库内它连接到帐户。但是，我们有一些“特殊”变量，例如 $core。它看起来像这样：

```
$this->db->core->accounts->update(<array>); 
```

那个不连接到同一个数据库。

我们需要的是能够在对象内部构建一行对象，这是动态的。它需要找到所调用的名称，因此我们可以将它们放入查询中。仅适用于一条线路，而不是所有线路。它基本上是基于密钥的数据库上的基于文档的基础架构，有很多黑客攻击。:-D

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T03:15:54.043

您需要在访问该属性时返回一个不同的对象。

```
class TempObj{
  public $table;

  public $db;

  public function __call($name,$arguments){
    switch($name){
      case "update":
        $this->db->query("UPDATE ......");
      break;
    }
  }
} 
```

在你的`DB`课上

```
public function __get($name){
  $obj = new TempObj;
  $obj->table = $name;
  $obj->db =& $this;
  return $obj;
} 
```

这样，当您这样做时`$this->db->accounts`，它将返回可以处理`__call`此重载属性的方法的对象。

# iphone - ShareKit Facebook/Twitter 注销未完全正常工作

> ID：10730400
> 
> 赞同：1
> 
> 时间：2012-05-24T02:35:26.543
> 
> 标签：iphone, facebook, twitter

这是一个亟待快速回答的问题。我正在开发 iPhone 应用程序以将图像分享到社交网络。我正在使用 ShareKit 2.0 库来实现共享功能。我可以使用它完美地实现共享功能，我建议使用 ShareKit 库在您的应用程序上实现共享。

问题仅在 Facebook/Twitter 注销时出现。当我想从他们注销时，我使用了如下代码。

```
[SHKFacebook logout];
[SHKTwitter logout]; 
```

或者我用过

```
[SHK logoutOfAll]; 
```

但是我无法完全退出他们，当我试图与他们分享图像时，他们说“你正在以 XXX 身份登录这个应用程序”，并且只要求确认这一点。而当我从 iPhone/iPad 上删除该应用程序时，他们需要邮件地址和密码才能再次登录。

我认为这对于经验丰富且才华横溢的开发人员来说不是什么大问题。请帮我。我在等你的建议。

谢谢。裴。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T08:39:49.323

facebook 无法注销，因为 facebook 的所有 cookie 都没有在注销方法中删除。

在 facebook.m 文件中更改 invalidateSession 方法，如下所示：

```
- (void)invalidateSession {
     self.accessToken = nil;
     self.expirationDate = nil;

     NSHTTPCookieStorage* cookies = [NSHTTPCookieStorage sharedHTTPCookieStorage];

    for (NSHTTPCookie* cookie in cookies.cookies){
        if([cookie.domain rangeOfString:@"facebook"].location != NSNotFound){
            [cookies deleteCookie:cookie];
        }
   }

   // setting to nil also terminates any active request for whitelist
   [_frictionlessRequestSettings updateRecipientCacheWithRecipients:nil]; 
} 
```

它将删除 facebook.and 的所有 cookie。注销将起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T04:10:05.233

在 ShareKit 2.0 中，您必须通过 facebook 页面注销，因为它适用于单次登录。这意味着您只有一次登录，并且在您从 iphone 的 facebook 页面注销之前一直保持登录状态。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T15:52:27.797

经过艰苦的研究，我找到了解决方案。问题出在 ShareKit 库的 Facebook.m 的授权方法上。

```
- (void)authorize:(NSArray *)permissions {
    self.permissions = permissions;

    [self authorizeWithFBAppAuth:YES safariAuth:NO];
} 
```

以上表示将授权 Facebook 不使用 Safari。当用户从 Facebook 注销时，它不会完全清除 Safari 的 cookie。这样就可以不使用 Safari 身份验证方法。这导致 Facebook 登录是在应用程序本身而不是 safari 上。

关于 twitter，ShareKit 2.0 使用 iOS 标准 Twitter 框架从 Twitter 登录/注销。用户可以在 iPhone 的设置应用程序上使用他们的帐户登录 Twitter。当用户在他们的应用程序上连接到 Twitter 时，它只使用注册帐户，用户可以从列表中选择他们的帐户。

这些问题还有其他解决方案吗？我想知道他们，如果有的话。

谢谢你和大家。裴。

# ios - Apple iTunes Connect 应用程序状态，等待上传

> ID：10730404
> 
> 赞同：5
> 
> 时间：2012-05-24T02:36:18.273
> 
> 标签：ios, app-store-connect

我通过 Xcode 成功将我的应用提交到 Apple 应用商店，但在 iTunes Connect 中我的应用的状态仍然是“等待上传”。我需要采取行动吗？我的提交截止日期快到了...

谢谢阅读。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T09:17:23.007

上传应用程序的过程在第一次（几次！）时可能有点令人生畏......

1.  在 iTunesConnect 上创建应用程序
2.  填写有关应用程序的所有元数据
3.  在 iTunesConnect 中按该编辑屏幕右上角的“上传二进制文件”按钮。您应该会收到一封确认邮件
4.  进入 XCode。
5.  通过转到产品 > 存档来存档应用程序。（如果这是灰色的，您需要从模拟器将目标更改为 iOS 设备。
6.  按照向导中的步骤将应用程序分发到 App Store。您通过 XCode 将应用程序上传到 iTunesConnect。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-18T05:21:10.330

![](../Images/cb55c56aa3944993f7f9dd27edd5e0d6.png)

在“应用程序摘要”页面的 iTunes Connect 中，您需要点击此按钮才能通过 Xcode 上传任何内容。

# android - Android - 处理 glSurfaceView 上下文的最佳方法在方向更改后在 onPause 中被丢弃

> ID：10730407
> 
> 赞同：1
> 
> 时间：2012-05-24T02:37:00.940
> 
> 标签：android, opengl-es, orientation, glsurfaceview

在我的应用程序中，我有一个 glsurfaceview，它在以前的版本中表现良好，但在最新版本中，我允许更改方向并杀死视图。我可以在 logcat 中看到它重新启动并且我的所有灯光和所有内容都被重新创建，但视图不会渲染任何对象。

那么，在从方向更改调用 onPause 后，如何让我的 glsurfaceview 再次开始绘图。我整天都在研究这个，除了一个解释如何重建我绝对不想做的 glsurfaceview 类的链接之外，没有真正好的线索。我不在乎我是怎么做的，即使这意味着在我的 onResume 中重建整个视图，但不管它看起来如何，onPause 只会杀死我的视图上下文。

# matlab - Matlab 筛选关键点多张图像，显示在一张图像上

> ID：10730408
> 
> 赞同：0
> 
> 时间：2012-05-24T02:37:01.260
> 
> 标签：matlab, computer-vision, matlab-figure, sift

我正在尝试将 4 个并发视频帧中的筛选关键点显示到一个图像上。我已经能够确定每个图像的关键点，但是我想在最后一张图像上显示所有这些关键点集，而不是 4 个单独的图像，以跟踪正在显示的卡车的运动。我写的代码如下：

```
I1 = imread('6.jpg');     
g = rgb2gray(I1);    
imwrite(g, '10.png','PNG');    
[I1, D, L] = sift('C:\Users\Xaiver\Documents\MATLAB\10.png');    
showkeys(I1, L)    
I2 = imread('7.jpg');    
g = rgb2gray(I2);    
imwrite(g, '11.png','PNG');    
[I2, D, L] = sift('C:\Users\Xaiver\Documents\MATLAB\11.png');    
showkeys(I2, L)    
I3 = imread('8.jpg');    
g = rgb2gray(I3);    
imwrite(g, '12.png','PNG');    
[I3, D, L] = sift('C:\Users\Xaiver\Documents\MATLAB\12.png');    
showkeys(I3, L)    
I4 = imread('9.jpg');    
g = rgb2gray(I4);    
imwrite(g, '13.png','PNG');    
[I4, D, L] = sift('C:\Users\Xaiver\Documents\MATLAB\13.png');    
showkeys(I4, L) 
```

如何从仅在图像 I4 上显示的图像 I1、I2、I3 和 I4 中获取 SIFT 关键点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T07:05:40.157

好吧，我不知道`showkeys`程序是如何工作的，因为你没有提供代码，但是有些东西告诉我你可以`hold on`在调用之间使用它并且它会起作用：

```
[I1, D, L1] = sift('C:\Users\Xaiver\Documents\MATLAB\10.png');
[I2, D, L2] = sift('C:\Users\Xaiver\Documents\MATLAB\11.png');
[I3, D, L3] = sift('C:\Users\Xaiver\Documents\MATLAB\12.png');
[I4, D, L4] = sift('C:\Users\Xaiver\Documents\MATLAB\13.png');
showkeys(I1, L1);
hold on;
showkeys(I2, L1);
showkeys(I3, L1);
showkeys(I4, L1); 
```

# java - 在文件上使用 BufferedReader 时出现 FileNotFoundException

> ID：10730413
> 
> 赞同：2
> 
> 时间：2012-05-24T02:37:25.533
> 
> 标签：java, file, bufferedreader, ioexception, filenotfoundexception

我对让基本文件读取与 Java 一起工作感到非常困惑。很多混合信号。

我已经尝试了几种不同的方法，但每次我总是得到一个未找到的异常。我已经检查了设置为当前路径的文件对象以打印当前目录，并且我确实在我要打开的文件所在的目录中。权限已设置，因此每个人都可以阅读。我不确定发生了什么：

```
BufferedReader infixLines = new BufferedReader ( new FileReader ( "input.infix" )); 
```

这是引发错误的行，因此使用 infixLines 的每个连续行也会引发错误。

我也尝试过使用 FileInputStream 并得到同样的错误。

话虽这么说只是在做

```
File file = new File("input.infix");
if ( file.exists() )
    System.out.println( "Exists" ); 
```

确实有效。

很迷茫。

编辑：（堆栈跟踪？）

```
ParseInfix.java:13: unreported exception java.io.FileNotFoundException; must be
            BufferedReader infixLines = new BufferedReader(new FileReader (n
                                                           ^
ParseInfix.java:15: unreported exception java.io.IOException; must be caught or
            while ( ( line = infixLines.readLine()) != null ) 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-24T02:53:29.700

异常跟踪是说你的代码......

```
BufferedReader infixLines = new BufferedReader ( new FileReader ( "input.infix" )); 
```

如果文件不存在，可能会抛出一个或一个，所以它希望你做一些事情来处理*这种*可能性`FileNotFoundException`。`IOException`

最简单的方法是将文件读取代码包装在这样的`try-catch`块中......

```
try {
    BufferedReader infixLines = new BufferedReader ( new FileReader ( "input.infix" ));
    // other reading code here
}
catch (FileNotFoundException e){
    System.out.println(e);
}
catch (IOException e){
    System.out.println(e);
} 
```

异常并不是说找不到文件，只是说*如果*文件不存在，您的代码将如何处理这种情况。

最终，在`catch`街区你想做的不仅仅是`System.out.println()`. 例如，在 GUI 程序中，您可能会显示一条弹出消息，告诉用户该文件不存在。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T02:56:59.917

这条线

```
BufferedReader infixLines = new BufferedReader (new FileReader("input.infix")); 
```

搜索 File: `input.infix`，如果没有找到则返回`FileNotFoundException`异常。确保它`input.infix`位于与`java file`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T03:00:03.507

它是**编译错误**，而不是运行时异常。

您需要将与 File 相关的调用包装在 try-catch 块中并处理`FileNotFounceException`和`IOException`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-02-16T15:06:43.317

试试这个

```
String fileName = "input.infix";
File fil = new File(fileName);
String filePath = fil.getAbsolutePath();
BufferedReader infixLines = new BufferedReader(new FileReader(filePath)); 
```

# java - 从java中的包加载log4j属性

> ID：10730415
> 
> 赞同：10
> 
> 时间：2012-05-24T02:37:35.763
> 
> 标签：java, properties, log4j

在我的 java swing 应用程序中，我从存储在应用程序包中的属性文件中加载 log4j 属性，然后将该属性文件加载为，

```
try {                            
     PropertyConfigurator.configure("conf/log4j.properties");
     logger.info("Starting the system.");                           

} catch (Exception e) {
     e.printStackTrace();

} 
```

然后在应用程序启动时出现以下错误，

```
log4j:ERROR Could not read configuration file [conf/log4j.properties].
java.io.FileNotFoundException: conf/log4j.properties (No such file or directory)
        at java.io.FileInputStream.open(Native Method)
        at java.io.FileInputStream.<init>(FileInputStream.java:138)
        at java.io.FileInputStream.<init>(FileInputStream.java:97)
        at org.apache.log4j.PropertyConfigurator.doConfigure(PropertyConfigurator.java:297)
        at org.apache.log4j.PropertyConfigurator.configure(PropertyConfigurator.java:315)
        at com.bio.ofm.mnu.views.SplashScreen$1.run(SplashScreen.java:70)
        at java.lang.Thread.run(Thread.java:722)
log4j:ERROR Ignoring configuration file [conf/log4j.properties].
log4j:WARN No appenders could be found for logger (com.bio.ofm.mnu.views.SplashScreen).
log4j:WARN Please initialize the log4j system properly. 
```

这种加载属性文件的方式是错误的吗？请帮忙。

**我构建了一个 .jar 文件并使用该 jar 运行应用程序****

 *** * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-05-24T03:04:47.420

如果 conf 是您可以使用的源文件夹：

```
PropertyConfigurator.configure("classpath:conf/log4j.properties"); 
```

否则你可以试试这个：

```
PropertyConfigurator.configure(this.getClass().getClassLoader().getResource("conf/log4j.properties")); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-24T04:03:50.777

自动类将`LogManager`寻找一个名为`log4j.properties`or的文件`log4j.xml`，**`classpath`**用于加载 log4j 类。直到 1.2.6 版本，log4j 只会`log4j.properties`在类路径中查找文件。从 1.2.7 版开始，log4j 在类路径中查找`log4j.properties`和`log4j.xml`。

只需将 log4j 文件放在默认包中。您还应该确保该文件位于`.class`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T04:49:07.927

我经常使用 Rachel Java 库[http://rachel.sourceforge.net/](http://rachel.sourceforge.net/)来处理这类东西

下载 lib 并将其添加到您的类路径中。然后，您可以像这样使用它从 JAR 文件/包中加载任何文件，并且在使用 JNLP 部署的应用程序时它也可以工作。他们有很多很好的教程可供阅读，以了解加载文件的最佳方式。我通常喜欢将它们加载为输入流。**

# java - JSlider getX(), getY()

> ID：10730418
> 
> 赞同：1
> 
> 时间：2012-05-24T02:37:49.043
> 
> 标签：java, user-interface, applet, components, init

何时设置 GUI 组件的位置、宽度和高度？如果正在使用布局管理器，这些字段如何影响？我有一个包含两个滑块的面板，我想在其中一个旁边绘制一个矩形。这是我的代码，用于初始化我的 GUI 组件并在其中一个滑块旁边用矩形绘制它们：

```
public PhotoSliders() 
{
    initComponents();    //from the netbeans GUI designer
}

public void setColorRect()   //initialize a colored rectangle
{
    colorRect = new ColorRect(Color.RED, (double)(emSlider.getX())/getWidth(), (double)(emSlider.getY())/getHeight());
}

public void paintComponent(Graphics g)
{
    super.paintComponent(g);

    colorRect.paintColorRect(g, getWidth(), getHeight());
} 
```

我发现 emSlider.getX()、emSlider.getY()、getWidth() 和 getHeight() 最初都是 0。当我调整我的小程序的大小并因此导致它被重新绘制时，这些字段不再为零。为什么它们最初都是零？这是我的小程序类中的代码：

```
public void init()                               //initialize the Applet Class
{
   setLayout(new BorderLayout());
   slidersPanel = new PhotoSliders();
   JPanel north = new JPanel(new BorderLayout());

   north.add(slidersPanel, BorderLayout.WEST);
   add(north, BorderLayout.NORTH);
   add(photoEffect, BorderLayout.CENTER);      

   slidersPanel.setColorRect(); 
```

}

```
 public void paint(Graphics g)                   //paint the photoEffect
   {     
      super.paint(g);
      slidersPanel.setColorRect();
   } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T02:50:20.513

渲染 GUI 时设置组件的位置和大小，在此之前它们是默认值，`0`. 对于桌面应用程序，当`pack()`在顶层窗口上调用时，或者在`setVisible(true)`顶层窗口上调用时，或者在组件本身上调用时，如果在所有渲染后将其添加到 GUI，则会发生这种情况。

如果它是一个小程序，那么它是在呈现小程序时——在幕后完成的事情。您可以使用其中一个 Swing 侦听器来侦听此内容。我必须查找哪一个，可能是[AncestorListener](http://docs.oracle.com/javase/7/docs/api/javax/swing/event/AncestorListener.html) .... 编辑，是的，我认为这是正确的，尝试使用 AncestorListener。

考虑购买[Filthy Rich Clients](http://filthyrichclients.org/)以获得一本深入了解 Swing 图形的精彩书籍。

# php - 创建唯一数组

> ID：10730425
> 
> 赞同：1
> 
> 时间：2012-05-24T02:39:13.843
> 
> 标签：php, arrays

我有一个多维数组，例如

```
Array
(
    [0] => Array
        (
            [id] => 1355698
            [comment] => hello
        )

    [1] => Array
        (
            [id] => 1355699
            [comment] => hey
        )

    [2] => Array
        (
            [id] => 1355700
            [comment] => hello
        )

) 
```

将`id`始终是唯一的，因此元素的唯一性将基于子数组的值`comment`。在这种情况下，`array[0]`有一个重复的`array[2]`. （我想知道是否有更好的方式来表达这个解释）。

`array_unique()`在这种情况下将不起作用。有替代方案吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T02:41:09.473

创建一个新数组，其中 id 和注释为 key=>value 对，然后`array_unique()`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T02:55:08.420

```
$uniqueArray = array();
foreach ($nonUniqueArray as $i) {
    $uniqueArray[$i['comment']] = $i;
}

// optionally:
// $uniqueArray = array_values($uniqueArray);

var_dump($uniqueArray); 
```

# c - C中的数独求解器。程序在某些情况下停止，我不知道为什么

> ID：10730426
> 
> 赞同：0
> 
> 时间：2012-05-24T02:39:14.590
> 
> 标签：c, sudoku, backtracking, solver

我正在为一个解决数独难题的课程编写一个 c 程序。我们应该实现三种方法，首先它在每个只有一个可能选择的方格中放置正确的数字，重复直到找不到任何选择。接下来，它使用蛮力，在每个方格中放置尽可能小的数字。我有这两种方法工作。最后一种方法是带有回溯的蛮力，它是蛮力功能的一部分。它的工作方式与常规蛮力相同，只是它到达一个无法放置数字的方格，它会移动到前一个方格并放置下一个最高数字。一旦实现这一点，这应该可以解决所有给定的数独难题，但这是我遇到麻烦的地方。

我已经实现了所有这三种方法，并且给了我们不同的数独谜题示例，有些可以仅使用第一个“单选”方法解决，有些可以仅使用“单选”和“暴力破解”解决回溯”和其他使用“单一选择”和“带有回溯的蛮力”的人。我的程序既适用于“单选”谜题，也适用于“单选”和“没有回溯的蛮力”谜题。但是，它不适用于“单一选择”和“带有回溯的蛮力”难题。

虽然我不明白的奇怪部分是，对于回溯谜题，程序在蛮力函数被调用之前就停止了工作。

这是我的主要功能：

```
#include <stdio.h>
#include "sudokusolver.h"
int main()
{
   int puzzle[9][9], i, j, count, attempts=0, backTracks=0;
   readSudoku(puzzle);
   printf("a\n");
   do
   {
      count=0;
      for(i=0;i<9;i++)
      {
         for(j=0;j<9;j++)
         {
            if(singleCandidate(puzzle, i, j)==1)
               count++;
         }
      }
   }while(count!=0);
   bruteForce(puzzle, &attempts, &backTracks);
   printSudoku(puzzle);
   return 0;
} 
```

我使用"printf("a\n")" 来显示程序停止工作的位置。

这是一个有效的输出示例。这是一个使用“单选”方法和“无回溯的蛮力”工作的数独游戏示例。请注意，零代表拼图中的空格。：

```
Enter line 1: 010042000
Enter line 2: 008053010
Enter line 3: 900071560
Enter line 4: 400700600
Enter line 5: 067205130
Enter line 6: 002004005
Enter line 7: 080430001
Enter line 8: 030120700
Enter line 9: 000580090
a
315|642|987
678|953|412
924|871|563
-----------
453|718|629
867|295|134
192|364|875
-----------
786|439|251
539|126|748
241|587|396 
```

这是一个不起作用的输出示例。这是一个必须使用“单选”和“回溯蛮力”解决的示例难题：

```
Enter line 1: 300910750
Enter line 2: 100570009
Enter line 3: 009000000
Enter line 4: 020740090
Enter line 5: 900000003
Enter line 6: 010069020
Enter line 7: 000000300
Enter line 8: 700085006
Enter line 9: 098034002
^C 
```

程序继续运行，就好像它处于无限循环中，而 ^C 是我退出程序。如您所见，该程序甚至从未到达它在数独谜题中读取的正下方的 printf("a")，甚至在它调用“带有回溯的蛮力”函数之前，这很奇怪，因为它只是谜题这需要蛮力和不工作的回溯。

这是似乎卡在上面的 readSudoku 函数：

```
void readSudoku(int puzzle[][9])
{
   int i, j;
   for(i=0;i<9;i++)
   {
      printf("Enter line %d: ", i+1);
      for(j=0;j<9;j++)
      {
         scanf("%1d", &puzzle[i][j]);
      }
   }
} 
```

这是实施了回溯的蛮力功能

```
void bruteForce(int puzzle[][9], int *attempt, int *backtracks)
{
   int stable[9][9], i, j, k, found=0, temp=0;
   for(i=0;i<9;i++)
   {
      for(j=0;j<9;j++)
      {
         if(puzzle[i][j]==0)
            stable[i][j]=0;
         else
            stable[i][j]=1;
      }
   }
   for(i=0;i<9;i++)
   {
      for(j=0;j<9;j++)
      {
         for(k=0;k<9;k++)
         {
            if(checkValid(puzzle, i, j, k+1)==1)
            {
               puzzle[i][j]=k+1;
               break;
            }
            if(k==8)
               break;
         }

         while(puzzle[i][j]==0)
         {
            found=0;
            temp=j-1;
            for(j=temp;j>=0;j--)
            {
               if(stable[i][j]==0)
               {
                  found=1;
                  break;
               }
            }
            temp=i-1;
            if(found==0)
            {
               for(i=temp;i>=0;i--)
               {
                  for(j=8;j>=0;j--)
                  {
                     if(stable[i][j]==0)
                     {
                        found=1;
                        break;
                     }
                  }
               if(found==1)
                  break;
               }
            }
            found=0;
            temp=puzzle[i][j]+1;
            for(k=temp;k<9;k++)
            {
               if(checkValid(puzzle, i, j, k+1)==1)
               {
                  found=1;
                  puzzle[i][j]=k+1;
                  break;
               }
            }
            if(found==0)
               puzzle[i][j]=0;
         }
      }
   }
} 
```

这是一个非常奇怪的问题，对我来说完全没有意义，任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T06:25:41.477

我猜问题可能出在`singleCandidate()`. 我看不到它的来源，但您应该验证它在不改变拼图时不会返回 1，因为这会导致无限循环。

还要检查当你得到一个无效输入时它的行为（即当数独没有解决方案时）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T19:34:27.087

在你的`bruteForce`，你有

```
/* No legal guess found, so backtrack */
while(puzzle[i][j]==0)
{
    /* Find previous guessed position */
    /* the last guess was as puzzle[i][j] */
    temp=puzzle[i][j]+1;
    for(k=temp;k<9;k++)
    {
        if(checkValid(puzzle, i, j, k+1)==1)
        {
            found=1;
            puzzle[i][j]=k+1;
            break;
        }
    }
    if(found==0)
       puzzle[i][j]=0;
} 
```

因此，您将 的起始值设置为`k`比之前的猜测大一。**但是您尝试将单元格设置为`k+1`**，因此您从不尝试将其设置为`old_guess + 1`。

因此，如果你猜到了`correct_value - 1`，你永远不会尝试`correct_value`。对于需要回溯的谜题，极有可能在某个时候发生这种情况。

所以，既然`found == 0`，你设置`puzzle[i][j] = 0`并继续回溯，寻找下一个猜测的位置。

但如果你已经处于第一个猜测的位置，

```
found=0;
temp=j-1;
for(j=temp;j>=0;j--)
{
    if(stable[i][j]==0)
    {
        found=1;
        break;
    }
}
// Here, j == -1
 temp=i-1;
 if(found==0)
 {
     // if i == 0
     for(i=temp;i>=0;i--)
     {
     // i is set to -1 and the loop ends right now, with i == -1 and j == -1
     // if i was > 0, j is decremented from 8 to -1 for all i down to 0 in the inner loop
         for(j=8;j>=0;j--)
         {
             if(stable[i][j]==0)
             {
                 found=1;
                 break;
             }
         }
         if(found==1)
             break;
         // i is finally set to -1, with j still -1
     }
 }
 found=0;
 temp=puzzle[i][j]+1; 
```

然后您正在访问`puzzle[-1][-1]`，调用未定义的行为。

如果您很不幸，该无效的内存访问不会导致崩溃（似乎是这种情况），可能会`checkValid(-1,-1,k+1)`返回`1`some `k`，那么您开始尝试再次解决难题，导致进入相同的循环。

诚然，如果终端设置为正常缓冲模式，`printf("a\n");`应该打印出来`a`，但我认为打印缓冲区没有被刷新的可能性大于`readSudoku`神奇地检测到需要回溯并拒绝处理它们的谜题。

# node.js - 如何在 node.js 中获取子进程内存使用情况？

> ID：10730429
> 
> 赞同：12
> 
> 时间：2012-05-24T02:39:45.750
> 
> 标签：node.js, memory-management, child-process

我知道有一个 api process.memoryUsage() 来获取当前进程中的内存使用情况。

但是如果我通过 child_process.spawn(command, [args], [options]) 启动一个新的子进程并且我得到一个 ChildProcess 对象，那么我怎样才能获得新进程的内存使用情况？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2018-07-02T18:20:28.107

获取孩子的 memoryUsage 最简单的方法是安装 pidusage

链接：[https ://www.npmjs.com/package/pidusage](https://www.npmjs.com/package/pidusage)

在控制台中写这个来安装它：

在 Windows 命令中：npm i pidusage --save
在 Mac 命令中：sudo npm i pidusage --save

```
let pidusage = require('pidusage');

const cp = require("child_process");

const child = cp.spawn('ls', ['-lh', '/usr']);

pidusage(child.pid, function (err, stats) {

console.log(stats);

});
/*
Output: 
{
   cpu: 10.0,            // percentage (from 0 to 100*vcore)
   memory: 357306368,    // bytes
   ppid: 312,            // PPID
   pid: 727,             // PID
   ctime: 867000,        // ms user + system time
   elapsed: 6650000,     // ms since the start of the process
   timestamp: 864000000  // ms since epoch
}
*/ 
```

如果您想获得多个孩子的 memoryUsage，您需要更改 child.pid for and array [child.pid,child2.pid], function (err, stats) ...

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-01-30T06:04:02.270

我们可以使用 nodejs ipc 协议获得**多平台解决方案。**您只需要设置事件以从父进程请求内存使用，然后`process.memoryUsage()`从生成的子进程发送。

父.js

```
var ChildProcess = require('child_process'),
    child = ChildProcess.fork('./child.js');

child.on('message', function(payload){
    console.log(payload.memUsage);
});

child.send('get_mem_usage'); 
```

它`child.js`可能看起来像这样

```
process.on('message', function(msg){
    if(msg === 'get_mem_usage'){
         process.send({memUsage: process.memoryUsage()});
    }
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-20T08:58:17.570

如果您在 unix 环境中，您可以使用`ps`（使用底层）。`/proc/<pid>/stat`这是一个例子：

```
// Spawn a node process
var child_process = require('child_process');
var child = child_process.spawn('node');

// Now get its pid.
child_process.exec('ps -p' + child.pid + ' -o vsize=',  function (err, stdout, stderr) {
  err = err || stderr;
  if (err) {
      return console.log('BAD Luck buddy: ', err);
  }
  console.log('YOU\'ve done it', parseInt(stdout, 10));
}); 
```

这是用 ubuntu 12.04 和 OS X lion 测试的。虽然不认为它会在 Windows 中工作。

# java - 追加 char 数组以创建字符串

> ID：10730430
> 
> 赞同：1
> 
> 时间：2012-05-24T02:40:05.793
> 
> 标签：java, string, split, arrays

如何添加所有 charAcro[] 来创建字符串？例如 charAcro[0] = a, charAcro[1] = b, charAcro[2] = c, 使得字符串 abc

```
 while(resultSet.next()){
                    String Name = rs.getString(1);
                    String Acro=Name;
                    String delimiterAcro = " ";
                    String[] temp =null;
                    char[] charAcro = null;
                    temp = Name.split(delimiterAcro);
                    for(int i = 0;i<temp.length;++i){
                    charAcro[i] = temp[i].charAt(0);
                    //SOME CODE HERE?
                    }

      } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-24T02:42:01.333

有一个`String`可用的构造函数接受一个`char`数组，

```
char data[] = {'a', 'b', 'c'};
String str = new String(data); 
```

在此过程中，请查看[Java Naming Conventions](http://www.oracle.com/technetwork/java/javase/documentation/codeconventions-135099.html#367)。类名应该是名词，大小写混合，每个内部单词的首字母大写。而变量是混合大小写的，首字母小写。内部单词以大写字母开头。

例如，在您的代码片段中，

```
String Name = rs.getString(1); 
```

这很糟糕，如果不是错的话。

此外，您可能会遇到 NullPointerException，

```
charAcro[i] = temp[i].charAt(0); 
```

因为您没有初始化数组。下面是应该为您工作的代码。

```
String name = rs.getString(1);
String[] temp = name.split(" ");
char[] charAcro = new char[temp.length];
for (int i = 0; i < temp.length; ++i) {
    charAcro[i] = temp[i].charAt(0);
}
System.out.println(new String(charAcro)); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-24T02:43:57.757

有一个 String 的构造函数接受一个 char 数组，所以只需：

```
String string = new String(charAcro); 
```

# ios - 带有 contentInset 的 UIScrollView 打破 UISearchBar “自动对焦”

> ID：10730431
> 
> 赞同：0
> 
> 时间：2012-05-24T02:40:21.783
> 
> 标签：ios, uiscrollview

我在 UIScrollView 内有一个 UISearchBar（准确地说是一个 AQGridView）。现在 searchBar 最初应该是隐藏的（例如你在 Music 应用中看到的）。由于 UIScrollViews 没有标题视图，我将它放在 UIScrollView 的框架之外 -40 点，并将 contentInset 设置为 40 点。

```
searchBar = [[UISearchBar alloc] initWithFrame:CGRectMake(0.f, -40.f, 320.f, 40.f)];
gridView.contentInset = UIEdgeInsetsMake(0.f, 40.f, 0.f, 0.f); 
```

现在从外观和一般行为来看，这几乎完全符合我的要求。搜索栏是隐藏的，但我可以向上滚动以显示它。

现在事情是这样的：

当我触摸 searchBar 以使其获得焦点并输入一些文本时，一切正常，**除非**searchBar 不完全可见。在这种情况下， UIScrollView 会尝试自动滚动它以完成可见性。但是，它朝错误的方向滚动。

因此，当搜索栏顶部的 10 个点被隐藏时，滚动视图会向下滚动**而**不是向上滚动。

这可能是一个有点模糊的问题，但也许有人可以在这里说出我的错误......我在这里能找到的唯一线程是这个：[uitableview contentInset issue](https://stackoverflow.com/questions/6780730/uitableview-contentinset-issue)，但这似乎也没有帮助我的情况。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-12T11:40:25.287

我遇到了几乎同样的问题，而 CodaFi 的解决方案无法解决我的问题。所以我有点怀疑这个解决方案是正确的答案。

这是我的情况和问题的描述：我想将 UINavigationBar 添加到 UIScrollView 的 ContentInset 区域和 UIWebView 的 ContentSize 区域，以便 UINavigationBar 可以在向下滚动时与屏幕顶部之外的 Web 内容一起消失。在 UINavigationBar 中，我添加了一个 UITextField 和一个 UISearchBar（是的，就像 Safari 一样）。在设置代码部分之后（在 viewDidLoad: 方法中）：

```
navigationBar = [[UINavigationBar alloc] initWithFrame:CGRectMake(0, -64, 320, 64);
textfield = [[UITextField alloc] initWithFrame:CGRectMake(5, 23, 150, 30)];
[navigationBar addSubview:textfield];
searchbar = [[UISearchBar alloc] initWithFrame:CGRectMake(200, 23, 100, 30)];
[navigationBar addSubview:searchbar];
[self.webView.scrollView setContentInset:UIEdgeInsetsMake(64, 0, 0, 0)];
[self.webView.scrollView setContentOffset:CGPointMake(0, -64) animated:NO];
[self.webView.scrollView addSubview:navigationBar]; 
```

问题是当我单击文本字段或搜索栏时，导航栏（实际上是整个视图）在屏幕中下降：文本字段为 41 点，搜索栏为 42 点（奇怪！）。所以它在屏幕上方留下了一个从 0 到 41（或 42）点的整个神秘空白。另一个奇怪的事情是它只发生一次！在我用手指滚动屏幕后，当我第二次单击文本字段或搜索栏时，它会消失并且再也不会出现。我相信我的问题的本质就像丹尼斯的一样。

在网上搜索了两天，不幸的是，我找不到解决这个问题本质的完美解决方案（实际上我什至不太确定问题的本质......）。

但正如我实验和观察的那样，我的假设是文本字段向下移动的 41 个点可能是因为它在导航栏上设置的相对位置（-64 + 23 = -41）。当它被用户点击时，系统（iOS）检查它的位置（虽然我已经在viewDidLoad中将contentOffset设置为-64：）并发现它不在用户的范围内并强制滚动视图向下滚动直到它出现了（向下 41 点）。如果我们（开发人员）设置内容插入区域并与之交互，我无法理解滚动视图的行为。很少有文档和参考资料在谈论它。我希望我的假设是错误的，将来有人可以纠正我并帮助我们找到真相。

最后，虽然我找不到“真正的”答案，但实际上我找到了解决这个问题的方法（比如治愈症状的药物）。这是代码：

```
- (void) scrollViewDidScroll:(UIScrollView *)scrollView {
    if (scrollView.contentOffset.y < -64) {    // if it is beyond the contentInset area
        if (!scrollView.dragging && !scrollView.decelerating) {    // scrollView is operated by system
            [scrollView setContentOffset:CGPointMake(0, -64) animated:NO];  // freeze the screen at (0, -64) position
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T04:13:23.907

要么 要么`-scrollToVisibleRect:animated:`停止大多数错误滚动`-setContentOffset:animated:`。`-searchBarTextDidBeginEditing`

# c - double 到 int 的转换

> ID：10730439
> 
> 赞同：2
> 
> 时间：2012-05-24T02:41:53.440
> 
> 标签：c, floating-point

以下代码是否有任何问题（潜在的未定义行为），是否将浮点值分配给 long int ？

```
struct timespec t; 
t.tv_nsec = (some float value < 1) * 1E9 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-24T02:51:27.377

转换将在编译时完成。您可能会收到编译器的警告，但代码实际上并没有什么“错误”，因为使用浮点常量初始化整数是非常传统的做法。

* * *

> 我给出的初始化只是为了保持简单。在代码中，它将类似于：
> 
> ```
> struct timespec t; t.tv_nsec = (some float value < 1) * 1E9; 
> ```

纳秒到`tv_nsec`; 有趣，但不应该有任何重大问题。实际上，double 具有足够的精度，您不会遇到太多麻烦，尽管您可能偶尔会得到与预期不同的值，因为分数在您不期望的情况下被截断。可能值得检查一下；这取决于它对您的重要性。

我做了一个快速程序，看看是否有问题。请记住，这是运行时计算而不是编译时计算，但结果可能与您相似：

```
#include <stdio.h>

int main(void)
{
    for (long l = 0; l < 1000000000; l++)
    {
        double d = l / 1.0E9;
        long r = d * 1E9;
        if (r != l)
            printf("%.9ld: %12.9f != %ld\n", l, d, r);
    }
    return 0;
} 
```

它打印出小数值与整数值不匹配的值。一些大量输出的一小部分是：

```
031890838:  0.031890838 != 31890837
031890839:  0.031890839 != 31890838
031890840:  0.031890840 != 31890839
031890851:  0.031890851 != 31890850
031890852:  0.031890852 != 31890851
031890853:  0.031890853 != 31890852
031890864:  0.031890864 != 31890863
031890865:  0.031890865 != 31890864
031890866:  0.031890866 != 31890865
031890877:  0.031890877 != 31890876
031890878:  0.031890878 != 31890877
031890879:  0.031890879 != 31890878
031890890:  0.031890890 != 31890889 
```

虽然绝不是每个值都有问题，但我`wc -l`在 1,000,000,000 个值（或大约 1.7% 的值）中记录了（用 ）17,075,957 个存在差异。那是在 Mac OS X 10.7.4（由 Apple 提供）上使用 GCC 4.1.2。我使用 GCC 4.7.0 得到了相同的结果。生成数据大约需要 30 秒。

Kernighan 和 Plauger 的“编程风格的要素”中我最喜欢的一句话是：

*   一位聪明的程序员曾经说过，'浮点数就像一小堆沙子。每次你移动一个，你会失去一点沙子并捡起一点泥土。

这很好地说明了这个问题。

* * *

请注意，一个微不足道的更改会将错误率降低到 0：

```
long r = d * 1E9 + 0.5; 
```

也许你应该使用宏：

```
#define NANOSECONDS(x) ((x) * 1E9 + 0.5)

long r = NANOSECONDS(d); 
```

您可以使用较小的附加常数；0.1 也将错误率降低到 0。

# css - 无法向右浮动 google plusone 按钮并使其正常工作

> ID：10730442
> 
> 赞同：0
> 
> 时间：2012-05-24T02:42:03.237
> 
> 标签：css, google-plus-one

我有一个 div，其中包含 Facebook Like 按钮、Google plusone 和一个电子邮件按钮。我用 float:right 浮动了 div，但是 Google plusone 不再可点击。Facebook 按钮可在按钮的 2/3 处单击。

当我从 BookContain 类中删除 float:right 时，它可以正常工作（仅在左侧）。我试过删除 float:right 并将其替换为相对定位，但 Google plusone 再次不喜欢它。

这是一个例子...... [http://www.giftsthatthrill.com.au/gifts/skydiving-experiences/Coolum_Beach/AD9788](http://www.giftsthatthrill.com.au/gifts/skydiving-experiences/Coolum_Beach/AD9788)

块的 CSS 是

```
.bookcontain {
margin-top:5px;
float:right;
}
.bookcontain ul {
text-align:left;
list-style:none;
margin:0;
padding:0;
}
.bookcontain ul li{
text-align:left;
display:inline-block;
padding:0 2px 2px 0;
margin:0 0 0 5px;

}
 .bookcontain ul li.google {
vertical-align:top; 

} 
```

我还发现 Firefox 在块中显示 Google plusone 较低……这可能与上述问题有关。

任何想法将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T04:01:50.917

在您的文件中进行以下更改。

关闭分区`<div style="clear:both;"></div>`后放置。`socialBookMarks`

`vertical-align: top;`从 CSS5.css 中删除第 22行

这些更改将使您的按钮保持在右侧，可点击并正确对齐。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T04:07:56.180

这些按钮不可点击，因为它们被选项卡 div 隐藏。

这是一个快速的解决方法...

添加此 CSS 以将按钮放在选项卡 div 上方：

```
#socialBookMarks{
    position: relative;
    z-index: 9;
} 
```

这会将 Google+ 按钮向上移动：

```
.google{
    position: relative;
    top: -13px;
} 
```

我将很快用 CSS 更新以修复按钮的位置......

# python - 循环列表列表而不嵌套太多

> ID：10730444
> 
> 赞同：1
> 
> 时间：2012-05-24T02:42:20.393
> 
> 标签：python, list, indexing

所以我有一个名为 a 的列表列表，我想将该列表中的项目的索引保存在一个元组中。例如，如果`a[0][0] = 1`，那么我想保存`(0,0)`并保存到该列表中。

现在我有ff代码：

```
z = []
for i in range(0, len(a)):
    for j in range(0, len(a)):
        if a[i][j] == '.':
            y = (i, j)
            z.append(y) 
```

这非常有效，但我想摆脱嵌套，所以我想知道是否有另一种方法可以做到这一点而不会嵌套太深。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T03:00:14.080

```
from itertools import product
for i,j in product(range(len(a)), repeat=2):
    ... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T02:53:50.463

您可以使用列表理解：

```
z = [(ii, jj) for ii, nested in enumerate(a) for jj, val in enumerate(nested) if val == '.'] 
```

但是，我认为您对 for 循环的使用更加清楚。

**编辑**：此外，`range`默认情况下从 0 开始。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T02:52:49.810

像这样的一些bs：

```
 z = ((i,j) for i in range(0, len(a)) for j in range(0, len(a)) if a[i][j] == '.') 
```

我可能把这个搞砸了——家里没有 python，但想法是你想要一个带有 if 的嵌套列表理解

# android - 如何在Android中将标题添加到列表视图

> ID：10730445
> 
> 赞同：6
> 
> 时间：2012-05-24T02:42:30.460
> 
> 标签：android, header, views

正如标题...我是新人。谁能给我一些简单的例子，谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-24T03:33:13.457

有很多方法可以将**标题**添加到列表视图

1.  对于 Sticky Header，请检查[此](http://blog.maxaller.name/2010/05/attaching-a-sticky-headerfooter-to-an-android-listview/).

2.  对于带有标题的 Android Categorized listview，请选中[this](https://stackoverflow.com/questions/5539480/android-categorized-listview-with-heading)。

3.  [你可以在这里](http://www.filefactory.com/file/b3g5g1b/n/TestSectionedHeaderList.zip)找到源代码

4.  对于 android-amazing-listview，检查[这个](http://code.google.com/p/android-amazing-listview/)

这些是不同类型的列表视图的示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T05:37:55.100

一些例子是：

1.  [Android 列表视图示例](http://www.mkyong.com/android/android-listview-example/)

2.  [ListView 上面部分的标题](https://stackoverflow.com/questions/2394514/how-to-generate-a-listview-with-headers-above-some-sections)

并且首先阅读[API](http://developer.android.com/reference/android/widget/ListView.html)很重要。

如果你想再举一个例子，一个简单的谷歌搜索就可以了。:)

# c++ - C++“迷宫”作业

> ID：10730447
> 
> 赞同：3
> 
> 时间：2012-05-24T02:42:53.860
> 
> 标签：c++, maze

小程序应该打印出通过迷宫的所有可能路线，其中入口/起点总是从左上角向下一个，所有可能的出口总是在右墙上。它从文本文件中检索迷宫。

迷宫实际上只是一堆文字。迷宫由一个 nxn 网格组成，该网格由作为墙壁的“#”符号和代表可步行区域/路径的各种字母 [a...z] 组成。字母可以重复，但永远不能并排。

迷宫是 15x15。

大写的 S 始终标记入口，位于第二高点的左墙上。一条可能的路径只能通过字母 - 你不能在 # 符号上行走。右边墙上的任何字母都代表出口。

例如，

```
######
Sa#hln
#bdp##
##e#ko
#gfij#
###### 
```

是一个可能的迷宫。我的小程序应该在读取实际包含迷宫的文本文件后打印出所有可能的路线。

对该程序的调用将在屏幕上生成以下输出：

```
Path 1: S,a,b,d,e,f,i,j,k,o
Path 2: S,a,b,d,p,h,l,n
2 total paths 
```

我会怎么做？我不需要完整的代码答案，我只需要一些有关如何解决此问题的指导。

到目前为止，除了递归检查相邻方块以查看您是否可以在它们上行走的实际算法本身之外，我已经完成了所有工作，而且我不知道如何在多条路径上工作。

这是我到目前为止所拥有的（我知道我的路径检查是错误的，但我不知道还能做什么）：

```
 #include <iostream>
#include <fstream>
#include <string>
#include <vector>
#include <sstream>
#include <cstdio>
using namespace std;

ifstream file("maze.txt");
vector<char> vec(istreambuf_iterator<char>(file), (istreambuf_iterator<char>())); // Imports characters from file
vector<char> path;                      // Declares path as the vector storing the characters from the file
int x = 18;                             // Declaring x as 18 so I can use it with recursion below
char entrance = vec.at(16);             // 'S', the entrance to the maze
char firstsquare = vec.at(17);          // For the first walkable square next to the entrance
vector<char> visited;                   // Squares that we've walked over already

int main()
{
    if (file) {
        path.push_back(entrance);               // Store 'S', the entrance character, into vector 'path'
        path.push_back(firstsquare);            // Store the character of the square to the right of the entrance
                                                // into vector 'path'.

        while (isalpha(vec.at(x)))
        {
            path.push_back(vec.at(x));
            x++;
        }

        cout << "Path is: ";                    // Printing to screen the first part of our statement

        // This loop to print to the screen all the contents of the vector 'path'.
        for(vector<char>::const_iterator i = path.begin(); i != path.end(); ++i)  // 
        {
        std::cout << *i << ' ';
        }

        cout << endl;
        system ("pause");                       // Keeps the black box that pops up, open, so we can see results.
        return 0;
        }
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T03:27:44.460

通常的方法（特别是对于学校作业）是递归地处理它。从指定的起点出发。从那里递归地尝试每个可能的正方形（上、右、下）。

唯一真正的“技巧”是跟踪您已经访问过哪些广场。一种可能性是在输入时将值保存在一个正方形中，然后在递归搜索其他正方形之前，将其设置为其他未使用的值（例如，'.' 应该适用于您的情况）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-24T02:52:59.573

您需要做一些事情才能开始：

1.  一种在内存中表示迷宫的方式——一种适合像迷宫这样的网格的“数据结构”
2.  访问和操作迷宫的方法
3.  一种绘制迷宫的方法——也许是打印出一个迷宫
4.  一种跟踪进度的方法
5.  解决手头问题的算法

考虑从一个小得多的迷宫开始——也许是一个 3x3 大小的迷宫——其路径直接穿过地图。你的程序应该能够解决这个问题。然后将路径更改为弯曲一点。然后把地图变大。让路更难走。在路径上放置一些“红鲱鱼”分支。

较小的地图，复杂性增加，应该使调试工作更容易。（如果你不知道如何使用调试器，那么从一个小问题开始会更容易学习调试器。）

祝你好运！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T02:49:23.540

我首先要做的当然是读入文件并将其放入数据结构中，以便您可以实际使用它。如果这是家庭作业，那么该作业很可能让您学习寻路算法，尝试查找 Dijkstra 的算法，这应该可以帮助您入门。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-25T21:04:06.867

将符号加载到数组中。然后递归检查每个位置：它可以上，下，左，右吗？从那里，您可以将这些布尔答案作为 0 或 1 保存在一个单独的数组中，并使用它继续...根据您的副本数组是否表示您可以或不能在某个方向上继续。

另外，一定要制作一些新方法……我通常会尝试在主要方法中包含很少的内容……

希望对你有帮助，希望我有时间看更多...

-P

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-24T02:51:17.047

一个非常高级的方法：

创建一棵树，描述您可以通过迷宫的路径。打印出在右侧结束的那些。

您将如何检测环绕自身的路径？（或者你的迷宫不会有这个问题？）

# asp.net-mvc-3 - 如何通过 MVC3 中的会话获取值

> ID：10730449
> 
> 赞同：0
> 
> 时间：2012-05-24T02:43:26.303
> 
> 标签：asp.net-mvc-3, session

我遇到了一个非常奇怪的问题。

我在第一页上有一个下拉列表，所以我从下拉列表中选择一个值并单击一个按钮。
单击时，我移至另一个页面，因此在该页面上我使用它并从第一页的下拉列表中获取所选值：

```
 int hobbyid = Convert.ToInt32(formcollection["Hobby"]); 
```

现在的问题是新页面位于标签下。

因此，单击第一页上的按钮时，它会移动到此选项卡，但是如果我转到其他页面，然后通过单击其选项卡返回此页面。现在 formcollection 方法不会给我带来任何价值。我应该如何解决这个问题?
我可以使用会话解决这个问题吗？
但我不知道如何使用它。请帮助我

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T02:54:51.493

如果您想在导航中保留爱好，则必须将其保留在某个地方。一种方法是保留查询字符串。即：当您移动到第一个选项卡时，将 hobbyid 作为 qyerystring 的一部分传递，然后在该页面中读取它并将其设置为所有相关链接（指向您想要 hobbyid 的页面）的 qyerystring 部分。 . 如果 formcollection["hobby"] 为空，那么您应该从查询字符串中读取值。

另一种方法是使用会话。因此，每当使用从 dropdwon 中选择一个项目并提交时，将其设置在会话变量上并从那里访问它。

```
Session["selectedHobby"]="some value read from the form"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T04:48:08.663

您可以使用 ASP.net TempData。

TempData 仅可用于用户的会话，并且仅在我们读取它之前一直存在，然后在请求结束时将其清除。当数据需要在两个请求或重定向场景之间持久存在时，可以使用 TempData。

店铺：

```
[HttpPost]
  public ActionResult MyAction(UserInfo user) {

   TempData["Hobby"] = User.Hobby;//In USerInfo view model Hobby property is of type string or int depends on what you need)

 return RedirectToAction("Index");

} 
```

在视图中检索它：

```
<div>
 @if (TempData["Hobby"] != null) {

 <p>Hobby: @TempData["Hobby"]</p>

 }
</div> 
```

# android - Android 设备信息 - 应用程序在创建时崩溃

> ID：10730452
> 
> 赞同：0
> 
> 时间：2012-05-24T02:43:56.740
> 
> 标签：android, network-programming

当我运行我的应用程序时，它崩溃了，任何人都可以帮助我并指导我朝着正确的方向使这段代码工作吗？

```
public class DeviceInfoActivity extends Activity {

        private static final String APP_NAME = "SignalLevelSample";
        private static final int EXCELLENT_LEVEL = 75;
        private static final int GOOD_LEVEL = 50;
        private static final int MODERATE_LEVEL = 25;
        private static final int WEAK_LEVEL = 0;

        private static final int INFO_SERVICE_STATE_INDEX = 0;
        private static final int INFO_CELL_LOCATION_INDEX = 1;
        private static final int INFO_CALL_STATE_INDEX = 2;
        private static final int INFO_CONNECTION_STATE_INDEX = 3;
        private static final int INFO_SIGNAL_LEVEL_INDEX = 4;
        private static final int INFO_SIGNAL_LEVEL_INFO_INDEX = 5;
        private static final int INFO_DATA_DIRECTION_INDEX = 6;
        private static final int INFO_DEVICE_INFO_INDEX = 7;

        private static final int[] info_ids= {
                R.id.serviceState_info,
                R.id.cellLocation_info,
                R.id.callState_info,
                R.id.connectionState_info,
                R.id.signalLevel,
                R.id.signalLevelInfo,
                R.id.dataDirection,
                R.id.device_info
        };

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        startSignalLevelListener();
        displayTelephonyInfo();
    }

    @Override
        protected void onPause()
        {
                super.onPause();

                stopListening();
        }

        @Override
        protected void onResume()
        {
                super.onResume();

                startSignalLevelListener();
        }

        @Override
        protected void onDestroy()
        {
                stopListening();

                super.onDestroy();
        }

        private void setTextViewText(int id,String text) {
                ((TextView)findViewById(id)).setText(text);
        }

        private void setSignalLevel(int id,int infoid,int level){
                int progress = (int) ((((float)level)/31.0) * 100);
                String signalLevelString = getSignalLevelString(progress);

                ((ProgressBar)findViewById(id)).setProgress(progress);
                ((TextView)findViewById(infoid)).setText(signalLevelString);

                Log.i("signalLevel ","" + progress);
        }

        private String getSignalLevelString(int level) {
                String signalLevelString = "Weak";

                if(level > EXCELLENT_LEVEL)             signalLevelString = "Excellent";
                else if(level > GOOD_LEVEL)             signalLevelString = "Good";
                else if(level > MODERATE_LEVEL) signalLevelString = "Moderate";
                else if(level > WEAK_LEVEL)             signalLevelString = "Weak";

                return signalLevelString;
        }

        private void stopListening(){
                TelephonyManager tm = (TelephonyManager) getSystemService(TELEPHONY_SERVICE);

                tm.listen(phoneStateListener, PhoneStateListener.LISTEN_NONE);
        }

        private void setDataDirection(int id, int direction){
                int resid = getDataDirectionRes(direction);

                ((ImageView)findViewById(id)).setImageResource(resid);
        }

        private int getDataDirectionRes(int direction){
                int resid = R.drawable.ic_launcher;

                switch(direction)
                {
                        case TelephonyManager.DATA_ACTIVITY_IN:         resid = R.drawable.ic_launcher; break;
                        case TelephonyManager.DATA_ACTIVITY_OUT:        resid = R.drawable.ic_launcher; break;
                        case TelephonyManager.DATA_ACTIVITY_INOUT:      resid = R.drawable.ic_launcher; break;
                        case TelephonyManager.DATA_ACTIVITY_NONE:       resid = R.drawable.ic_launcher; break;
                        default:                                        resid = R.drawable.ic_launcher; break;
                }

                return resid;
        }

        private void startSignalLevelListener() {
        TelephonyManager tm = (TelephonyManager) getSystemService(TELEPHONY_SERVICE);
        int events = PhoneStateListener.LISTEN_SIGNAL_STRENGTH | 
                                 PhoneStateListener.LISTEN_DATA_ACTIVITY | 
                                 PhoneStateListener.LISTEN_CELL_LOCATION |
                                 PhoneStateListener.LISTEN_CALL_STATE |
                                 PhoneStateListener.LISTEN_CALL_FORWARDING_INDICATOR |
                                 PhoneStateListener.LISTEN_DATA_CONNECTION_STATE |
                                 PhoneStateListener.LISTEN_MESSAGE_WAITING_INDICATOR |
                                 PhoneStateListener.LISTEN_SERVICE_STATE;

        tm.listen(phoneStateListener, events);
    }

        private void displayTelephonyInfo(){
                TelephonyManager tm = (TelephonyManager) getSystemService(TELEPHONY_SERVICE);
                GsmCellLocation loc = (GsmCellLocation) tm.getCellLocation();

                int cellid = loc.getCid();
                int lac = loc.getLac();

                String deviceid = tm.getDeviceId();
                String phonenumber = tm.getLine1Number();
                String softwareversion = tm.getDeviceSoftwareVersion();
                String operatorname = tm.getNetworkOperatorName();
                String simcountrycode = tm.getSimCountryIso();
                String simoperator = tm.getSimOperatorName();
                String simserialno = tm.getSimSerialNumber();
                String subscriberid = tm.getSubscriberId();
                String networktype = getNetworkTypeString(tm.getNetworkType());
                String phonetype = getPhoneTypeString(tm.getPhoneType());

                logString("CellID: " + cellid);
                logString("LAC: " + lac);
                logString("Device ID: " + deviceid);
                logString("Phone Number: " + phonenumber);
                logString("Software Version: " + softwareversion);
                logString("Operator Name: " + operatorname);
                logString("SIM Country Code: " + simcountrycode);
                logString("SIM Operator: " + simoperator);
                logString("SIM Serial No.: " + simserialno);
                logString("Sibscriber ID: " + subscriberid);

                String deviceinfo = "";

                deviceinfo += ("CellID: " + cellid + "\n");
                deviceinfo += ("LAC: " + lac + "\n");
                deviceinfo += ("Device ID: " + deviceid + "\n");
                deviceinfo += ("Phone Number: " + phonenumber + "\n");
                deviceinfo += ("Software Version: " + softwareversion + "\n");
                deviceinfo += ("Operator Name: " + operatorname + "\n");
                deviceinfo += ("SIM Country Code: " + simcountrycode + "\n");
                deviceinfo += ("SIM Operator: " + simoperator + "\n");
                deviceinfo += ("SIM Serial No.: " + simserialno + "\n");
                deviceinfo += ("Subscriber ID: " + subscriberid + "\n");
                deviceinfo += ("Network Type: " + networktype + "\n");
                deviceinfo += ("Phone Type: " + phonetype + "\n");

                List<NeighboringCellInfo> cellinfo = tm.getNeighboringCellInfo();

                if(null != cellinfo){
                        for(NeighboringCellInfo info: cellinfo){
                                deviceinfo += ("\tCellID: " + info.getCid() + ", RSSI: " + info.getRssi() + "\n");
                        }
                }

                setTextViewText(info_ids[INFO_DEVICE_INFO_INDEX],deviceinfo);
        }

        private String getNetworkTypeString(int type){
                String typeString = "Unknown";

                switch(type)
                {
                        case TelephonyManager.NETWORK_TYPE_EDGE:        typeString = "EDGE"; break;
                        case TelephonyManager.NETWORK_TYPE_GPRS:        typeString = "GPRS"; break;
                        case TelephonyManager.NETWORK_TYPE_UMTS:        typeString = "UMTS"; break;
                        default:                                                                        typeString = "UNKNOWN"; break;
                }

                return typeString;
        }

        private String getPhoneTypeString(int type){
                String typeString = "Unknown";

                switch(type)
                {
                        case TelephonyManager.PHONE_TYPE_GSM:   typeString = "GSM"; break;
                        case TelephonyManager.PHONE_TYPE_NONE:  typeString = "UNKNOWN"; break;
                        default:                                                                typeString = "UNKNOWN"; break;
                }

                return typeString;
        }

        private int logString(String message) {
                return Log.i(APP_NAME,message);
        }

    private final PhoneStateListener phoneStateListener = new PhoneStateListener(){

                @Override
                public void onCallForwardingIndicatorChanged(boolean cfi)
                {
                        Log.i(APP_NAME, "onCallForwardingIndicatorChanged " + cfi);

                        super.onCallForwardingIndicatorChanged(cfi);
                }

                @Override
                public void onCallStateChanged(int state, String incomingNumber)
                {
                        String callState = "UNKNOWN";

                        switch(state)
                        {
                                case TelephonyManager.CALL_STATE_IDLE:          callState = "IDLE"; break;
                                case TelephonyManager.CALL_STATE_RINGING:       callState = "Ringing (" + incomingNumber + ")"; break;
                                case TelephonyManager.CALL_STATE_OFFHOOK:       callState = "Offhook"; break;
                        }

                        setTextViewText(info_ids[INFO_CALL_STATE_INDEX],callState);

                        Log.i(APP_NAME, "onCallStateChanged " + callState);

                        super.onCallStateChanged(state, incomingNumber);
                }

                @Override
                public void onCellLocationChanged(CellLocation location)
                {
                        String locationString = location.toString();

                        setTextViewText(info_ids[INFO_CELL_LOCATION_INDEX],locationString);

                        Log.i(APP_NAME, "onCellLocationChanged " + locationString);

                        super.onCellLocationChanged(location);
                }

                @Override
                public void onDataActivity(int direction)
                {
                        String directionString = "none";

                        switch(direction)
                        {
                                case TelephonyManager.DATA_ACTIVITY_IN:         directionString = "IN"; break;
                                case TelephonyManager.DATA_ACTIVITY_OUT:        directionString = "OUT"; break;
                                case TelephonyManager.DATA_ACTIVITY_INOUT:      directionString = "INOUT"; break;
                                case TelephonyManager.DATA_ACTIVITY_NONE:       directionString = "NONE"; break;
                                default:                                                                        directionString = "UNKNOWN: " + direction; break;
                        }

                        setDataDirection(info_ids[INFO_DATA_DIRECTION_INDEX],direction);

                        Log.i(APP_NAME, "onDataActivity " + directionString);

                        super.onDataActivity(direction);
                }

                @Override
                public void onDataConnectionStateChanged(int state)
                {
                        String connectionState = "Unknown";

                        switch(state)
                        {
                                case TelephonyManager.DATA_CONNECTED:           connectionState = "Connected"; break;
                                case TelephonyManager.DATA_CONNECTING:          connectionState = "Connecting"; break;
                                case TelephonyManager.DATA_DISCONNECTED:        connectionState = "Disconnected"; break;
                                case TelephonyManager.DATA_SUSPENDED:           connectionState = "Suspended"; break;
                                default:                                                                        connectionState = "Unknown: " + state; break;
                        }

                        setTextViewText(info_ids[INFO_CONNECTION_STATE_INDEX],connectionState);

                        Log.i(APP_NAME, "onDataConnectionStateChanged " + connectionState);

                        super.onDataConnectionStateChanged(state);
                }

                @Override
                public void onMessageWaitingIndicatorChanged(boolean mwi)
                {
                        Log.i(APP_NAME, "onMessageWaitingIndicatorChanged " + mwi);

                        super.onMessageWaitingIndicatorChanged(mwi);
                }

                @Override
                public void onServiceStateChanged(ServiceState serviceState)
                {
                        String serviceStateString = "UNKNOWN";

                        switch(serviceState.getState())
                        {
                                case ServiceState.STATE_IN_SERVICE:             serviceStateString = "IN SERVICE"; break;
                                case ServiceState.STATE_EMERGENCY_ONLY:         serviceStateString = "EMERGENCY ONLY"; break;
                                case ServiceState.STATE_OUT_OF_SERVICE:         serviceStateString = "OUT OF SERVICE"; break;
                                case ServiceState.STATE_POWER_OFF:                      serviceStateString = "POWER OFF"; break;
                                default:                                                                        serviceStateString = "UNKNOWN"; break;
                        }

                        setTextViewText(info_ids[INFO_SERVICE_STATE_INDEX],serviceStateString);

                        Log.i(APP_NAME, "onServiceStateChanged " + serviceStateString);

                        super.onServiceStateChanged(serviceState);
                }

                @Override
                public void onSignalStrengthChanged(int asu)
                {
                        Log.i(APP_NAME, "onSignalStrengthChanged " + asu);

                        setSignalLevel(info_ids[INFO_SIGNAL_LEVEL_INDEX],info_ids[INFO_SIGNAL_LEVEL_INFO_INDEX],asu);

                        super.onSignalStrengthChanged(asu);
                }
    };
} 
```

//========================= xml

```
<?xml version="1.0" encoding="utf-8"?>

<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:orientation="vertical"
        android:scrollbarStyle="insideOverlay"
        android:scrollbarAlwaysDrawVerticalTrack="false">

        <LinearLayout 
        android:orientation="vertical"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent">

                <LinearLayout
                        android:layout_width="fill_parent"
                        android:layout_height="wrap_content"
                        android:orientation="horizontal">

                        <TextView android:text="Serivice State" style="@style/labelStyleRight"/>
                        <TextView android:id="@+id/serviceState_info" style="@style/textStyle"/>
                </LinearLayout>

                <LinearLayout
                        android:layout_width="fill_parent"
                        android:layout_height="wrap_content"
                        android:orientation="horizontal">

                        <TextView android:text="Cell Location" style="@style/labelStyleRight"/>
                        <TextView android:id="@+id/cellLocation_info" style="@style/textStyle"/>
                </LinearLayout>

                <LinearLayout
                        android:layout_width="fill_parent"
                        android:layout_height="wrap_content"
                        android:orientation="horizontal">

                        <TextView android:text="Call State" style="@style/labelStyleRight"/>
                        <TextView android:id="@+id/callState_info" style="@style/textStyle"/>
                </LinearLayout>

                <LinearLayout
                        android:layout_width="fill_parent"
                        android:layout_height="wrap_content"
                        android:orientation="horizontal">

                        <TextView android:text="Connection State" style="@style/labelStyleRight"/>
                        <TextView android:id="@+id/connectionState_info" style="@style/textStyle"/>
                </LinearLayout>

                <LinearLayout
                        android:layout_width="fill_parent"
                        android:layout_height="wrap_content"
                        android:orientation="horizontal">

                        <TextView android:text="Signal Level" style="@style/labelStyleRight"/>

                        <LinearLayout
                                android:layout_width="fill_parent"
                                android:layout_height="wrap_content"
                                android:layout_weight="0.5"
                                android:orientation="horizontal">

                                <ProgressBar android:id="@+id/signalLevel" style="@style/progressStyle"/>
                                <TextView android:id="@+id/signalLevelInfo" style="@style/textSmallStyle"/>
                        </LinearLayout>
                </LinearLayout>

                <LinearLayout
                        android:layout_width="fill_parent"
                        android:layout_height="wrap_content"
                        android:orientation="horizontal">

                        <TextView android:text="Data" style="@style/labelStyleRight"/>
                        <ImageView android:id="@+id/dataDirection" style="@style/imageStyle"/>
                </LinearLayout>

                <TextView android:id="@+id/device_info" style="@style/labelStyleLeft"/>
        </LinearLayout>
</ScrollView> 
```

//==================

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="sirisak.phone"
    android:versionCode="1"
    android:versionName="1.0" >
    <uses-sdk android:minSdkVersion="8" />
    <application android:icon="@drawable/ic_launcher" android:label="@string/app_name">
        <activity android:name=".DeviceInfoActivity "
                  android:label="@string/app_name">
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>

    </application>
        <uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION"></uses-permission>
        <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE"></uses-permission>
        <uses-permission android:name="android.permission.CHANGE_NETWORK_STATE"></uses-permission>
        <uses-permission android:name="android.permission.READ_PHONE_STATE"></uses-permission>
        <uses-permission android:name="android.permission.ACCESS_COARSE_UPDATES"></uses-permission>
</manifest> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T03:16:00.320

您需要添加：

```
android:name="android.app.Application" 
```

到`application`标签中`AndroidManifest.xml`。

这是因为您有一个 ClassCastException。请参阅：[活动启动时的 android classcastexception](https://stackoverflow.com/questions/3838640/android-classcastexception-on-activity-startup)

# ruby-on-rails - 在请求之间重新加载资产

> ID：10730454
> 
> 赞同：0
> 
> 时间：2012-05-24T02:43:59.193
> 
> 标签：ruby-on-rails, ruby-on-rails-3, heroku, asset-pipeline

部署到 Heroku Cedar 堆栈上的 Rails 应用程序。

我想在运行时的给定点将资产重新加载到管道中。

我很熟悉`config.cache_classes = false`。但是，在生产中，修改资产后不会重新加载资产。关于此异常原因的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T09:28:08.083

检查以下内容。

确保您的 production.rb 设置包括：

1 - 您的生产配置可能不正确。如果您从早期的 3.1 候选版本开始，并且一直在更新，那么这种情况尤其可能发生。production.rb 的建议选项在 rc4 和 3.1.0 版本之间发生了很大变化。

```
 #Disable Rails's static asset server (Apache or nginx will already do this)
  config.serve_static_assets = false
  #Don't fallback to assets pipeline if a precompiled asset is missed
  config.assets.compile = false
  #Generate digests for assets URLs
  config.assets.digest = true 
```

2 - 您可能忘记了预编译资产
RAILS_ENV=production rake assets:precompile
3 - 您可能忘记重新启动 Web 服务器以获取 production.rb 中的更改

# c# - 为什么我必须将枚举参数重新转换为其声明的类型？

> ID：10730455
> 
> 赞同：1
> 
> 时间：2012-05-24T02:44:01.647
> 
> 标签：c#, casting, enums

我有一个定义为短的枚举，但是当将其中一个元素作为参数传递时，计算机拒绝接受枚举*已经*是短的并且让我重铸它。我的问题是为什么？

即枚举设置：短{val1，val2，val3}；

```
public void function (short param) 
{
    // ...
}

function(settings.val1); // will not compile

function((short)settings.val1); // will parse. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T03:14:57.800

将您的方法调用修改为`public void function (settings param) { }`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T03:15:32.910

在这种情况下，`:`不是继承运算符。相反，它只定义了支持数据类型。不幸的是，它看起来像继承。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T02:47:54.353

因为 settings.val1 是设置类型不短并且不支持隐式转换。Enum : short 只是说它的字段存储在 short 类型的内存区域中。枚举项的默认类型是 Int32

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-24T02:53:49.420

您有一个名为 的枚举类型`settings`。该枚举的支持类型恰好是`short`，但就编译器而言，该类型仍然是`settings`。

由于`settings`没有隐式转换为`short`，因此需要显式转换。

# asp.net-mvc - 在 MVC 中的 Action Method 调用的函数中，我可以找到用户是否处于角色中吗？

> ID：10730456
> 
> 赞同：0
> 
> 时间：2012-05-24T02:44:20.080
> 
> 标签：asp.net-mvc, asp.net-mvc-3, asp.net-mvc-2, razor

我的代码在操作方法中有以下内容：

```
 catch (Exception e)
        {
            log(e);
            return Content(ExceptionExtensions.GetFormattedErrorMessage(e));
        } 
```

在`ExceptionExtensions.GetFormattedErrorMessage(e)`函数中，我希望能够返回不同的消息，具体取决于它是“Guest”角色还是“Admin”角色的用户。我是否能够在该函数中执行此操作，或者我是否需要以某种方式找出用户在控制器中是否处于角色中，然后将该信息传递给另一个函数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T02:47:37.923

`Roles.IsUserInRoles`如果您使用 .NET 的开箱即用的角色提供程序，您将使用该方法：

```
if(Roles.IsUserInRoles(HttpContext.Current.User.Identity.Name, "SomeRoleName"))
{
    // do stuff ...
} 
```

[http://msdn.microsoft.com/en-us/library/4z6b5d42.aspx](http://msdn.microsoft.com/en-us/library/4z6b5d42.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T02:49:53.760

您将需要访问 HTTPContext 并且我认为它在包含您的操作方法的类中不可用，解决此问题的一种方法是将 HttpContext 传递给函数本身，或者您可以验证用户是否是管理员或现场用户，然后将其传递给您的函数..

要验证角色，您可以使用以下方法：

```
HttpContext.User.IsInRole("Admin");   //returns bool 
```

还要检查您是否有权访问方法中的 HttpContext。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T04:01:46.673

如果`ExceptionExtensions`该类在同一个**MVC 项目**`FormatErrorMessage`中，您可以使用函数从函数中访问角色信息`HttpContext.User.IsInRole()`，如果该函数在不同的程序集中，那么您需要使用`System.Web`程序集进行引用。

*将角色信息从控制器传递到该函数还是从该函数中检索？*

如果该函数位于不同的程序集中，那么我建议您从控制器传递信息，这样您就可以避免与`System.Web`.

# c++ - 尝试“重写”字符数组的 C++ 错误

> ID：10730461
> 
> 赞同：1
> 
> 时间：2012-05-24T02:45:12.047
> 
> 标签：c++, string, pointers, toupper

我正在尝试使用以下代码将字符串转换为全部大写：

```
int client::get_upper(char*item_in)
{
    int k ;
    char * temp_str;
    int length = strlen(item_in);
    temp_str = new char [length+1];
    for(k = 0; k < length; ++k)
        temp_str[k] = toupper(item_in[k]);
    temp_str[k] = '\0';
    for(k = 0; k < length; ++k)
        item_in[k] = temp_str[k];
    return 0;
} 
```

然而，当我尝试这样做时，我收到了来自 Visual Studio 的访问冲突写入位置 xxxxxxxx。这是一个类，所以我被限制使用实际的字符串。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T03:16:18.863

如果使用得当，您的代码可以工作（最简单的方法是像这样简单地传递一个本地 cstring）：

```
char test[] = "stackoverflow.com";
client::get_upper(test); // client interpreted as a namespace 
```

现在，您的函数充满了不好的方法，即未托管的冗余副本（内存泄漏）。

稍微改写一下：

```
int client::get_upper(char *item_in)
{
    unsigned int length = strlen(item_in);
    for(int i = 0; i < length; ++k)
        item_in[i] = toupper(item_in[i]);

    return 0;
} 
```

如果你想尝试一下，这里给你一些东西，只是为了好玩：

```
int client::get_upper(char *item_in)
{
    int length = strlen(item_in);
    for(int i = 0; i < length; ++i)
        if((item_in[i] >= 97 && item_in[i] <= 122))
            item_in[i] = (int)item_in[i] - 32; 

    return 0;
} 
```

您的错误很可能来自您试图推送一个您可能没有真正考虑过的动态字符数组。只需使用本地字符串，即简单的以空字符结尾的数组。你并没有真正付出太多，所以这只是猜测工作。我能做的就是帮你简化你的表达方式。由于返回值什么都不做，请考虑将其应用于某事或切换到`void`.

希望能帮助到你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T03:36:04.330

不允许您使用标准字符串类这一事实并不意味着您必须将其编写为一个整体函数。

我会编写一个简单的函数来就地进行转换。然后，如果您需要支持处理只读字符串，请编写另一个复制输入的函数（使用第三个函数），然后对副本进行就地转换。

```
char *duplicate(char const *input);

char *upper_str(char *input); // does in-place transformation

char *upper_str(char const *input); // duplicates, then transforms the duplicate 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T02:52:59.137

假设您正确调用该代码，我认为您在 temp_str[k] = '\0';

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-24T02:56:04.147

调用 get_upper 时，是否传递了字符串文字？例如，您的调用代码是这样的：

```
char *mystr = "stackoverflow.com";
client.get_upper(mystr)? 
```

这很可能会在 Visual Studio 中触发访问冲突。

如果是这种情况，您可以将 mystr 的定义更改为：

```
char mystr[] = "stackoverflow.com"; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-24T02:57:50.323

如果不查看函数是如何被调用的，我们就无法判断为什么会出现错误。

我怀疑该错误与调用上下文以及 item_in 实际指向的内容有关。

Jeremy Friesner 的评论很准确——你有泄漏，如果目标是破坏性的，你就不需要中间缓冲区。

# python - Pygame：奇怪的 blitting bug

> ID：10730464
> 
> 赞同：2
> 
> 时间：2012-05-24T02:46:03.860
> 
> 标签：python, pygame

我一直在研究 Python 3.1 和 PyGame 2.7 中的简单主菜单。当鼠标光标在某个区域内时，屏幕上的文本应变为白色。我正在使用功能来blit屏幕。第一个函数正常地对主菜单进行 blit，另外两个函数在菜单中突出显示一些文本。以下是功能：

```
def draw_main_menu(): #draw main menu normally
    screen.fill(BLACK) #clears screen

    #set up text
    new_text = menu_font.render('NEW GAME', 1, (100, 100, 100))
    load_text = menu_font.render('LOAD GAME', 1, (100, 100, 100))
    options_text = menu_font.render('OPTIONS', 1, (100, 100, 100))
    quit_text = menu_font.render('QUIT', 1,  (100, 100, 100))

    #blit text
    screen.blit(new_text, (340, 425))
    screen.blit(load_text, (335, 455))
    screen.blit(options_text, (350, 485))
    screen.blit(quit_text, (373, 515))

def draw_main_menu_ng(): #draw main menu with new game text in white
    screen.fill(BLACK)

    new_text = menu_font.render('NEW GAME', 1, (255, 255, 255))
    load_text = menu_font.render('LOAD GAME', 1, (100, 100, 100))
    options_text = menu_font.render('OPTIONS', 1, (100, 100, 100))
    quit_text = menu_font.render('QUIT', 1,  (100, 100, 100))

    screen.blit(new_text, (340, 425))
    screen.blit(load_text, (335, 455))
    screen.blit(options_text, (350, 485))
    screen.blit(quit_text, (373, 515))

def draw_main_menu_lg(): #draw main menu with load game text in white
    screen.fill(BLACK)

    new_text = menu_font.render('NEW GAME', 1, (100, 100, 100))
    load_text = menu_font.render('LOAD GAME', 1, (255, 255, 255))
    options_text = menu_font.render('OPTIONS', 1, (100, 100, 100))
    quit_text = menu_font.render('QUIT', 1,  (100, 100, 100))

    screen.blit(new_text, (340, 425))
    screen.blit(load_text, (335, 455))
    screen.blit(options_text, (350, 485))
    screen.blit(quit_text, (373, 515)) 
```

下面，我使用变量 x 和 y 来检查鼠标是否悬停在按钮上。第一组两个数字是 x 坐标的范围，第二组两个数字是 y 坐标的范围。

```
x,y = pygame.mouse.get_pos()
#set up new game mouse positions
if x >= 340 and x <= 465:
    new_game_x_pos = True
if x < 340  or x > 465:
    new_game_x_pos = False

if y >= 425 and y <= 445:
    new_game_y_pos = True
if y < 425 or y > 445:
    new_game_y_pos = False

if new_game_x_pos == True and new_game_y_pos == True:
    draw_main_menu_ng()
if new_game_x_pos == False or new_game_y_pos == False:
    draw_main_menu()

#set up load game mouse positions
if x >= 335 and x <= 470:
    load_game_x_pos = True
if x < 335 or x > 470:
    load_game_x_pos = False

if y >= 455 and y <= 475:
    load_game_y_pos = True
if y < 455 or y > 475:
    load_game_y_pos = False

if load_game_x_pos == True and load_game_y_pos == True:
    draw_main_menu_lg()
if load_game_x_pos == False or load_game_y_pos == False:
    draw_main_menu() 
```

出于某种原因，当鼠标悬停在“新游戏”上时，它不会改变颜色。当鼠标悬停在“加载游戏”上时，它会改变颜色。在我添加加载游戏的东西之前，它会改变颜色，但现在只有加载游戏会。关于为什么它不起作用的任何想法？

顺便说一句，我在游戏循环中确实有更新屏幕的代码。我也有设置字体的代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T03:07:11.610

菜单被绘制了两次。当鼠标检查代码评估光标在*NEW GAME*上时，`draw_main_menu_ng` *正在*调用。但是，检查继续进行，并且当它评估游标*未*超过*LOAD GAME*时，它还会调用`draw_main_menu`，从而否定调用的效果`draw_main_menu_ng`。

一个最小的解决方案是`return`一旦光标在一个选项内：

```
if new_game_x_pos == True and new_game_y_pos == True:
    draw_main_menu_ng()
    return 
```

* * *

## 替代解决方案

我添加[了一个完整示例，说明如何制作可突出显示的菜单](https://gist.github.com/2802185)。我意识到这比您要问的要多得多，但是如果您只是`return`在代码中添加了一条语句，那么之后您可能会遇到其他问题。我制作了完整的示例，因此您可以看到避免使用文字和几乎相同的语句的好方法。我觉得发布它很舒服，因为你必须理解它才能将它集成到游戏中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T14:01:18.077

代替所有的 if 语句，在文本周围制作一个矩形并使用函数 rect.collidepoint((x, y)) （返回布尔值）会容易得多。它将使您的代码更短，并且可能更快。

# tsql - TSQL 版本 2008-R2 - 递归选择

> ID：10730466
> 
> 赞同：1
> 
> 时间：2012-05-24T02:46:27.210
> 
> 标签：tsql, sql-server-2008-r2

```
DECLARE @MAIN TABLE
(
  MainID INT NOT NULL, 
  Name VARCHAR(20) NOT NULL,
  [Deleted] BIT NOT NULL
);

DECLARE @ITEMS TABLE
(
  ItemID INT NOT NULL, 
  ParentItemID INT NULL,
  MainID INT NOT NULL, 
  Data VARCHAR(100) NOT NULL
);

INSERT INTO @MAIN (MainID, Name, [Deleted]) VALUES  (1, 'Tool 1', 0)
INSERT INTO @MAIN (MainID, Name, [Deleted]) VALUES  (2, 'Tool 2', 0)

INSERT INTO @ITEMS (ItemID, ParentItemID, MainID, Data) VALUES (1, NULL, 1, 'Level 1')
INSERT INTO @ITEMS (ItemID, ParentItemID, MainID, Data) VALUES (2, NULL, 1, 'Level 2')
INSERT INTO @ITEMS (ItemID, ParentItemID, MainID, Data) VALUES (3, NULL, 2, 'Level 1 - Irrelevant')
INSERT INTO @ITEMS (ItemID, ParentItemID, MainID, Data) VALUES (4, NULL, 1, 'Level 3')

INSERT INTO @ITEMS (ItemID, ParentItemID, MainID, Data) VALUES (5, 1, 1, 'Item 1-A')
INSERT INTO @ITEMS (ItemID, ParentItemID, MainID, Data) VALUES (6, 4, 1, 'Item 2-C')
INSERT INTO @ITEMS (ItemID, ParentItemID, MainID, Data) VALUES (7, 7, 2, 'Item Irrelevant 1')
INSERT INTO @ITEMS (ItemID, ParentItemID, MainID, Data) VALUES (8, 10, 1, 'Item 3-E')

INSERT INTO @ITEMS (ItemID, ParentItemID, MainID, Data) VALUES (9, 1, 1, 'Item 1-B')
INSERT INTO @ITEMS (ItemID, ParentItemID, MainID, Data) VALUES (10, 4, 1, 'Item 2-D')
INSERT INTO @ITEMS (ItemID, ParentItemID, MainID, Data) VALUES (11, 7, 2, 'Item Irrelevant 2')
INSERT INTO @ITEMS (ItemID, ParentItemID, MainID, Data) VALUES (12, 10, 1, 'Item 3-F')

INSERT INTO @ITEMS (ItemID, ParentItemID, MainID, Data) VALUES (13, 5, 1, 'Item 1-A-1')
INSERT INTO @ITEMS (ItemID, ParentItemID, MainID, Data) VALUES (14, 8, 1, 'Item 2-C-1')
INSERT INTO @ITEMS (ItemID, ParentItemID, MainID, Data) VALUES (15, 5, 2, 'Item 1-A-2')
INSERT INTO @ITEMS (ItemID, ParentItemID, MainID, Data) VALUES (16, 9, 1, 'Item 1-B-1')

SELECT * FROM @MAIN
SELECT * FROM @ITEMS 
```

问题 1：
检索属于**ItemID = 1**的所有记录的最简单方法是什么，所有记录都是**递归**子项目并按 ParentHood 排序。

问题 2：通过 ParentHood
检索**所有记录顺序的最简单方法是什么。**

非常感谢..在先进！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T02:55:04.740

您需要的是使用一个公用表表达式，它可以让您执行分层查询。

```
;With AllItems As
    (
    Select I.ItemId, Null As ParentItemId, M.MainId, M.Name, M.[Deleted]
    From @Items As I
        Join @Main As M
            On M.MainID = I.MainID
    Where ParentItemId Is Null
    Union All
    Select I.ItemId, I.ParentItemId, M.MainId, M.Name, M.[Deleted]
    From @Items As I
        Join AllItems As P
            On P.ItemId = I.ParentItemId
        Join @Main As M
            On M.MainID = I.MainID
    )
Select *
From AllItems 
```

[WITH common_table_expression (Transact-SQL)](http://msdn.microsoft.com/en-us/library/ms175972.aspx)

[SQL 小提琴示例](http://www.sqlfiddle.com/#!3/30cda/1)

# python - 什么是区分旧式和新式 python 类或对象的简单实用程序函数

> ID：10730468
> 
> 赞同：0
> 
> 时间：2012-05-24T02:46:40.207
> 
> 标签：python, new-style-class

什么是区分旧式和新式 python 类或对象的简单实用函数？

以下是否正确/完整：

```
isNewStyle1 = lambda o: isinstance(hasattr(o, '__class__') and o.__class__ or o, type)
isNewStyle2 = lambda o: hasattr(o, '__class__') and type(o) == o.__class__ or False 
```

如果没有，那么您能否提供解决方案。如果是这样，有没有更好的方法来进行检查？

使用上述方法，我没有遇到任何问题，但我没有 100% 的信心认为它适用于作为参数提供的所有对象。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T04:06:04.033

怎么样：

```
class A: pass

class B(object): pass

def is_new(myclass):
    try: myclass.__class__.__class__
    except AttributeError: return False
    return True

>>> is_new(A)
False
>>> is_new(B)
True
>>> is_new(A())
False
>>> is_new(B())
True
>>> is_new(list())
True 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T02:53:10.060

为什么不只是

```
type(my_class) is type 
```

`True`新式课程，`False`经典课程

您可以像这样支持具有不同元类的类（只要元类是子类类型）

```
issublass(type(myclass), type) 
```

# android - 如何在没有外部硬件的情况下以编程方式捕获 Android 的视频？

> ID：10730470
> 
> 赞同：4
> 
> 时间：2012-05-24T02:47:03.473
> 
> 标签：android, unity3d, video-capture

我知道这个问题已经在这里和许多其他地方被问过很多次，但所提供的答案都不能满足我的要求。基本上，我希望能够在**没有**外部硬件的情况下以 30 fps 的速度实时执行我的应用程序的屏幕视频录制，类似于 Fraps，但它是在 Android 上。我的应用程序是一个 Unity Android 应用程序，我找到了一个插件（AV Pro Movie Capture），它完全符合我的要求，但它只适用于 Windows。

还有其他人表示，仅使用已安装的应用程序或 Android SDK 功能，**无法**直接实时“Fraps”Android 设备（[http://forum.unity3d.com/threads/89821-How-do-i- quot-Fraps-quot-my-game-on-iOS-or-Android , 2nd post](http://forum.unity3d.com/threads/89821-How-do-i-quot-Fraps-quot-my-game-on-iOS-or-Android?p=581249&viewfull=1#post581249) )，而是建议使用外部硬件设置，例如将视频信号从 Android 设备转移到 PC 显示器。我有一种感觉，因为屏幕视频录制是处理器密集型的，而且 Android 设备在其规格中显然不如 PC 快。

如果上述陈述属实，是否有人对此有任何可靠的技术答案/证据？我的老板多次要求这个功能，但当我告诉他由于处理器速度而“Fraps”Android 设备非常困难时，他并不相信；他的理由是“就像将输出的视频显示信号反馈给摄像头一样简单，它的计算强度如何？” 我需要更多的东西来说服他。

更新：我找到了 LunarG 的这个免费 SDK SeeMeGaming，它与我在 Android 设备上所做的非常接近 ( [http://www.lunarg.com/see-me-gaming/](http://www.lunarg.com/see-me-gaming/) )。这里有人用过吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-04-23T09:13:43.190

您可以尝试使用 INDE 媒体包：[https ://software.intel.com/en-us/articles/intel-inde-media-pack-for-android-tutorials-video-capturing-for-unity3d-applications](https://software.intel.com/en-us/articles/intel-inde-media-pack-for-android-tutorials-video-capturing-for-unity3d-applications)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T20:05:31.113

[Android 堆栈交换答案](https://android.stackexchange.com/questions/10811/how-to-capture-video-stream-from-android-phone-screen-and-show-it-on-laptop)

[使用 Unity 的相机拍摄场景](http://www.unifycommunity.com/wiki/index.php?title=TakeScreenshot)：需要您使用自己的代码将 png 拼接在一起。不知道这实际上运行得有多快。

[另一个带有其他一些应用程序的随机帖子](http://androidcommunity.com/samsung-galaxy-s-ii-built-in-screen-capture-no-root-required-20110514/)

上次我尝试做类似的事情时，大多数帖子都表明我需要一个有根设备。当时有几个应用程序也需要有根设备，所以我放弃了那个计划，坚持将 Unity 的主相机屏幕转储到一个文件夹中。

# sql - 我们可以将动态查询的结果存储到一个变量中并在 if 块中使用它吗？

> ID：10730473
> 
> 赞同：1
> 
> 时间：2012-05-24T02:47:32.153
> 
> 标签：sql, plsql, plsqldeveloper

```
Declare
v_count number 
v_sql varchar2(1000);

begin 

v_count :='select count(*) from table_name';

 Execute Immediate v_count;

if(v_count <>0) then 

v_sql :='delete table_name where x=X' ;

Execute Immediate v_sql ;

End if ;

end; 
```

任务是我们必须使用动态查询来访问表。上述查询是否有效？它给了我一些类型转换错误..

或者是否有任何替代方法来存储动态 sql 查询的结果

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T07:35:43.060

尝试这个：

```
Declare
v_statement varchar2(32767);
v_count number; 
v_sql varchar2(1000);

begin 

 v_statement :='select count(*) from table_name';

 Execute Immediate l_statement into v_count;

  if v_count >0 then 
   ...
  end if ;

end; 
```

# java - 从 PHP 执行带有套接字和 jdbc 的 Java 应用程序

> ID：10730477
> 
> 赞同：0
> 
> 时间：2012-05-24T02:47:42.967
> 
> 标签：java, mysql, sockets, jdbc, sudo

使用 sudo 启动 Java 应用程序时，我无法使其正常运行。我的应用程序使用套接字进行客户端连接并建立数据库连接。如果我正常启动应用程序：

```
java myApp 
```

一切都很完美。但是，我试图让它能够从网站在后台启动。所以我创建了一个 PHP 来使用 exec() 或 passthru() 来启动它。起初，这似乎可行，但我很快发现套接字实际上并没有连接。进一步的试验和错误使我得出结论，这是因为当我这样做时`java myApp`，我以 root 身份登录，但 PHP 没有以 root 身份执行，因此存在安全问题。

所以我写了一个脚本，设置SUDOERS允许脚本在没有密码的情况下运行。该脚本只有一行，`java myApp`. 如果我运行脚本：

```
bash myScript 
```

套接字将无法连接。（也就是说小程序客户端在尝试连接时挂起。）如果我尝试：

```
sudo bash myScript 
```

找不到 jdbc MySql 驱动程序。我尝试了各种方法来解决这个问题，包括弄乱类路径，包括在编译和/或运行时使用 -classpath 并将 jdbc jar 的副本放在不同的地方但没有运气。显然，sudo 环境与以 root 身份登录的环境有一些微妙的不同，这会导致 Java 无法找到 jdbc 驱动程序。

`sudo bash myScript`需要明确的是，当我以root 身份登录 时尝试运行时，我得到了 jdbc ClassPathNotFound（或没有合适的驱动程序错误，具体取决于我尝试连接的方式） 。`bash myScript`在以 root 身份登录的所有计数上都可以正常工作。当我尝试从 PHP 脚本运行时，我的客户端小程序无法连接，这可能是套接字或 jdbc。我没有使用任何类型的 IDE，只是使用文本编辑器进行编辑并使用 javac 进行编译。

任何建议，将不胜感激。

更新：

如果有帮助，服务器正在运行 CentOS。我认为 -E 是环境问题（并且猜测环境损失是原因，但我发现的 sudo 文档并没有帮助我找出解决方案）。我已经尝试过`passthru('sudo -i bash /path/to/myScript.sh');`，但 java 应用程序仍然无法启动。通过 passthru，浏览器中没有显示任何内容。该脚本现在显示：

```
cd /path/to/app
java myApp 
```

我自己还在玩弄它；我知道我即将完成这项工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T04:25:41.467

在通过我理解的评论进行讨论后，这`sudo -E`有效（适用于您的用户名） - 这似乎是对正在发生的事情的赠品：

您的交互式登录设置了许多环境变量，其中一些是执行 Java 应用程序所必需的。

通常，`sudo`在切换用户之前会“清理”您的环境 - 因此它将删除必要的环境变量，但`sudo -E`会保持环境完整，使其适合您。

现在网络服务器用户（例如 Ubuntu 中的 www-data）没有设置环境，导致`sudo -E`环境存在缺陷。

有几种方法可以解决这个问题，最简单的是使用`sudo -i`- 这将运行目标用户的 shell，就像在登录时一样。

# exchangewebservices - “请求失败。基础连接已关闭：发送时发生意外错误”在使用 EWS 创建日历约会期间

> ID：10730481
> 
> 赞同：1
> 
> 时间：2012-05-24T02:48:23.087
> 
> 标签：exchangewebservices, exchange-server-2010

使用：EWS 1.1、Exchange server 2010 SP1、VB.Net

我正在使用 EWS 通过 Windows 服务为我公司的 2000 多个用户创建日历约会，我开发了一个 Windows 服务，当用户在我们自己的公司企业应用程序中创建或更新他们的约会时，该服务将为他们创建或更新约会。我安装了 Windows 服务，该服务由在 Exchange server 2010 上具有模拟权限的服务帐户启动。该服务将调用 DLL 为用户在 Exchange 中创建或更新约会。

> 1.  使用版本 Exchange2010_SP1 初始化 ExchangeService
> 2.  UseDefaultCredentials=True（登录的用户有模拟权限）
> 3.  使用 ImpersonatedUserId 模拟我要创建日历约会的用户
> 4.  初始化一个 Appointment 对象（appointment = new Microsoft.Exchange.WebServices.Data.Appointment）
> 5.  使用值填充 Appointment 对象（例如，属性 Start、End、IsAllDayEvent、Body、Sensitivity、Subject、Location）
> 6.  使用 Appointment.Save(WellKnownFolderName.Calendar, SendInvitationsMode.SendToNone) 创建约会
> 7.  当用户在我们的企业应用程序中更新他们的约会时，我使用 Appointment.Update(ConflictResolutionMode.AlwaysOverwrite, SendInvitationsOrCancellationsMode.SendToNone)

以下是一些代码片段：

```
Try
    'Initialize the Exchange service
    exchangeService = New ExchangeService(ExchangeVersion.Exchange2010_SP1)
    impersonationContext = CType(System.Web.HttpContext.Current.User.Identity, System.Security.Principal.WindowsIdentity).Impersonate

    exchangeService.UseDefaultCredentials = True
    exchangeService.ImpersonatedUserId = New ImpersonatedUserId(ConnectingIdType.SmtpAddress, "user1@domain.com")

    System.Net.ServicePointManager.ServerCertificateValidationCallback = New System.Net.Security.RemoteCertificateValidationCallback(AddressOf ValidateCertificate)

    exchangeService.Url = New Uri("https://server/ews/Exchange.asmx")

    'Create or Update appointment
    If newAppointment Then
        appointment = New Appointment(exchangeService)
    Else
        appointment = Appointment.Bind(exchangeService, New ItemId(appointmentId))
    End If

    With appointment
        .Subject = *subject*
        .Start = *start date*
        .End = *end date*
        .Body = *msgbody*
        .Location = *location*

        If newAppointment Then
            .Save(WellKnownFolderName.Calendar, SendInvitationsMode.SendToNone)
        Else
            .Update(ConflictResolutionMode.AlwaysOverwrite, SendInvitationsOrCancellationsMode.SendToNone)
        End If
    End With
Catch ex As Exception
    'Throw exception here
Finally
    If Not impersonationContext Is Nothing Then
        impersonationContext.Undo()
    End If
End Try 
```

模拟是因为当从 Windows 服务调用时，当前的 WindowsIdentity 是 IIS AppPool，所以我需要模拟服务帐户，然后才能初始化交换服务并创建/更新约会。

每次需要创建或更新约会时，都会创建新的交换服务。

大多数情况下该过程进展顺利，但有时我会收到一个我不知道为什么以及导致它的原因的 ServiceRequestException：

> Microsoft.Exchange.WebServices.Data.ServiceRequestException：请求失败。底层连接已关闭：发送时发生意外错误。---> System.Net.WebException：底层连接已关闭：发送时发生意外错误。---> System.ObjectDisposedException: Safe handle has been closed at System.Security.Principal.Win32.ImpersonateLoggedOnUser(SafeTokenHandle hToken) at System.Security.Principal.WindowsIdentity.SafeImpersonate(SafeTokenHandle userToken, WindowsIdentity wi, StackCrawlMark& stackMark) at System. Security.Principal.WindowsIdentity.Impersonate(StackCrawlMark& stackMark) 在 System.Security.SecurityContext.SetSecurityContext(SecurityContext sc, SecurityContext prevSecurityContext, StackCrawlMark& stackMark) 在 System.Threading.ExecutionContext。

# c# - 在没有用户名/密码的情况下访问 AD 以进行只读访问

> ID：10730486
> 
> 赞同：0
> 
> 时间：2012-05-24T02:49:24.553
> 
> 标签：c#, active-directory

我使用以下代码访问 AD 没有问题：

> DirectoryEntry ldapConnection = 新的 DirectoryEntry (ldap, ldapUser, ldapPassword);

有没有办法通过 DirectoryEntry 访问 AD 而无需提供用户名/密码。在这种特殊情况下，我只需要读取一些属性。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T02:59:44.113

是的你可以

```
 String strPath="LDAP://DC=onecity,DC=corp,DC=fabrikam,DC=com";

  // Create a new DirectoryEntry with the given path.
  DirectoryEntry  objDE=new DirectoryEntry(strPath);

  foreach(DirectoryEntry objChildDE in objDE.Children)
    Console.WriteLine(objChildDE.Path); 
```

检查[DirectoryEntry 类](http://msdn.microsoft.com/en-us/library/system.directoryservices.directoryentry.aspx)构造函数部分，您也可以找到一些其他方法。

对您的 AD 启用匿名访问，检查[此](http://social.technet.microsoft.com/Forums/da-DK/winserverManagement/thread/78376104-f892-47a8-99ba-626a3b4d7ba2)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T03:03:48.073

默认情况下，Server 2003 及更高版本不允许对 AD 进行匿名查询（大部分情况下）。确保您的 AD 服务器已正确配置为允许匿名访问。

如何修复（适用于 Win 2k8）： [http ://technet.microsoft.com/en-us/library/cc816788(v=ws.10).aspx](http://technet.microsoft.com/en-us/library/cc816788(v=ws.10).aspx)

# python - 如何通过 API 创建标题 Imgur 相册？

> ID：10730487
> 
> 赞同：3
> 
> 时间：2012-05-24T02:49:30.623
> 
> 标签：python, api, imgur, python-requests

我可以创建相册，使用`requests`and`oauth-hook`模块就好了，但我似乎无法让名称正常工作。在此处查看文档：http: [//api.imgur.com/resources_auth#account_albums](http://api.imgur.com/resources_auth#account_albums)。我正在使用 Windows7x64 Python2.7，`requests`版本 0.21.1 和`oauth-hook`版本 0.4.0

奇怪的是，当我上传图像时使用相同的方法命名图像，脚本工作得很好。以下是相关代码：

```
client = requests.session(hooks={'pre_request': authorizedHook})

url = r'http://api.imgur.com/2/account/albums.json'

parameters = {'title': 'ALBUMTITLEHERE'}

r = client.post(url, data=parameters) 
```

一旦我将它加载到`json`：

```
 Created Album data:
    {u'albums': {u'anonymous_link': u'http://imgur.com/a/i3Gal',
                 u'cover': u'',
                 u'datetime': u'2012-05-24 02:34:42',
                 u'description': u'',
                 u'id': u'i3Gal',
                 u'layout': u'blog',
                 u'link': u'http://tankorsmash.imgur.com/1B498',
                 u'order': 0,
                 u'privacy': u'public',
                 u'title': u''}} 
```

我期待的是一个名为的画廊`ALBUMTITLEHERE`。而是创建了一个无标题的。我究竟做错了什么？

不相关：Stats API 似乎根本没有为我返回任何东西，但我不确定这是否相关。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-26T14:03:04.287

编辑：

我自己已经尝试了很长一段时间，尝试了几乎所有可能的作为 http url 参数发送的参数组合，post（json，urlencoded，甚至 xml）......甚至分析了wireshark中的原始请求 - 一切正常。

但没有运气，它不起作用。

我很确定这是 API 本身的一个错误。更改现有专辑的标题也是不可能的。

所以我之前的回答不适用。

# asp.net - url中的某些字符导致错误500

> ID：10730489
> 
> 赞同：0
> 
> 时间：2012-05-24T02:49:51.123
> 
> 标签：asp.net, redirect

对网站进行安全扫描后，这两个字符**<a**会导致 500

[http://domain.com/default.aspx](http://domain.com/default.aspx)？**<一个**

该错误在 Application_Error 中处理以重定向到 error.aspx 页面。

```
Application_Error()  
{  
 Response.Redirect("/error.aspx?asperrorpath=" + Context.Request.RawUrl);  
} 
```

但是 RawUrl 并不仅仅作为参数 asperrorpath 的值出现，Redirect 将导致另一个 500，并且会发生无限重定向循环。

避免重定向循环的唯一解决方案是对 RawUrl 进行编码，但我们希望看到用户请求的真实 URL，编码可能会导致一些信息丢失。还有其他解决方案吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T03:14:43.327

```
HttpUtility.UrlEncode(Context.Request.RawUrl); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T02:56:31.557

不确定这是否符合您的目的。也许你可以更换它们

```
Application_Error()  
{  
   Response.Redirect("/error.aspx?asperrorpath=" + String.Replace(Context.Request.RawUrl,"<a","^^$$^^");  
} 
```

因此，如果您看到该模式，您可以假设它是“< a”...选择您的组合，这样它就不会发生。

# jboss5.x - Cargo:ContainerException: 服务器端口 8080 在 JBoss EAP 5.1 的超时时间内没有关闭

> ID：10730491
> 
> 赞同：1
> 
> 时间：2012-05-24T02:50:10.150
> 
> 标签：jboss5.x, cargo

在 JBoss EAP 5.1 上，我无法停止容器。当我执行 container.stop 时，端口状态是这样的：

```
 TCP    127.0.0.1:2927         127.0.0.1:8080         TIME_WAIT
 TCP    127.0.0.1:2928         127.0.0.1:8080         TIME_WAIT
 TCP    127.0.0.1:2929         127.0.0.1:8080         TIME_WAIT
 TCP    127.0.0.1:2930         127.0.0.1:8080         TIME_WAIT
 TCP    127.0.0.1:2931         127.0.0.1:8080         TIME_WAIT
 TCP    127.0.0.1:2932         127.0.0.1:8080         TIME_WAIT
 TCP    127.0.0.1:2933         127.0.0.1:8080         TIME_WAIT
 TCP    127.0.0.1:2934         127.0.0.1:8080         TIME_WAIT
 TCP    127.0.0.1:2935         127.0.0.1:8080         TIME_WAIT
 TCP    127.0.0.1:2936         127.0.0.1:8080         TIME_WAIT
 TCP    127.0.0.1:2937         127.0.0.1:8080         TIME_WAIT
 TCP    127.0.0.1:2938         127.0.0.1:8080         TIME_WAIT
 TCP    127.0.0.1:2939         127.0.0.1:8080         TIME_WAIT
 TCP    127.0.0.1:2940         127.0.0.1:8080         TIME_WAIT
 TCP    127.0.0.1:2941         127.0.0.1:8080         TIME_WAIT
 TCP    127.0.0.1:2942         127.0.0.1:8080         TIME_WAIT
 TCP    127.0.0.1:2943         127.0.0.1:8080         TIME_WAIT
 TCP    127.0.0.1:2944         127.0.0.1:8080         TIME_WAIT 
```

并有以下例外：

```
Caused by: org.codehaus.cargo.container.ContainerException: Server port 8080 did not shutdown within the timeout period [120000]
    at org.codehaus.cargo.container.spi.AbstractLocalContainer.waitForPortShutdown(AbstractLocalContainer.java:390)
    at org.codehaus.cargo.container.spi.AbstractLocalContainer.waitForPortShutdown(AbstractLocalContainer.java:301)
    at org.codehaus.cargo.container.jboss.internal.AbstractJBossInstalledLocalContainer.waitForCompletion(AbstractJBossInstalledLocalContainer.java:154)
    at org.codehaus.cargo.container.spi.AbstractLocalContainer.stop(AbstractLocalContainer.java:214)
    ... 33 more
org.codehaus.cargo.container.ContainerException: Server port 8080 did not shutdown within the timeout period [120000]
    at org.codehaus.cargo.container.spi.AbstractLocalContainer.waitForPortShutdown(AbstractLocalContainer.java:390)
    at org.codehaus.cargo.container.spi.AbstractLocalContainer.waitForPortShutdown(AbstractLocalContainer.java:301)
    at org.codehaus.cargo.container.jboss.internal.AbstractJBossInstalledLocalContainer.waitForCompletion(AbstractJBossInstalledLocalContainer.java:154)
    at org.codehaus.cargo.container.spi.AbstractLocalContainer.stop(AbstractLocalContainer.java:214)
    at jp.co.nri.kinshasa.util.server.JBossServerImpl.stopContainer(JBossServerImpl.java:151) 
```

我的代码就像我使用 JBoss51xInstalledLocalContainer：

```
 private void prepareJBoss() {
        ConfigurationFactory configurationFactory = new DefaultConfigurationFactory();

        localConfiguration = (StandaloneLocalConfiguration) configurationFactory
                .createConfiguration("jboss51x", ContainerType.INSTALLED,
                        ConfigurationType.STANDALONE, WORK_HOME);

        localConfiguration.setProperty(JBossPropertySet.JBOSS_USER, "admin");
        localConfiguration
                .setProperty(JBossPropertySet.JBOSS_PASSWORD, "admin");
        localConfiguration.setProperty(GeneralPropertySet.JVMARGS,
                "-Xms512m -Xmx512m");
    }

    private void startContainer() {
        container = new JBoss51xInstalledLocalContainer(localConfiguration);
        container.setHome(JBOSS_HOME);
        container.setExtraClasspath(new String[] {
                PROJECT_PATH + "/target/external/kss/apl_conf",
                PROJECT_PATH + "/target/external/kss/kiban_conf" });
        container.start();

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-11-28T14:33:31.320

如果你关机，你需要让你的环境正确。

您用于`shutdown --server=localhost:1099 --user=admin --password=admin`关闭服务器。

但是在您的环境中，您忘记输入管理员用户`/conf/props/jmx-console-users.properties`

# ipad - iPad 3：如何在 uiwebview 中下载视网膜图像

> ID：10730495
> 
> 赞同：0
> 
> 时间：2012-05-24T02:50:43.240
> 
> 标签：ipad, uiwebview, resolution, retina-display, highdpi

我有一个混合 iPad 应用程序在 web 视图中加载 html 和 javascript。

所有图像在 ipad 1 和 2s 中都可以，但在 ipad 3 中模糊。

我正在考虑一些可能的解决方案：

1.  提供 2x 图像并在低分辨率 ipad 中以 50% 的比例显示它们。
2.  检测视网膜显示并提供不同的图像

您将如何管理不同设备中的不同分辨率和图像加载？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T06:25:00.460

您可以使用 Javascript 将 LowRes 图像交换为 HiRes 设备上的 HiRes 图像。有一个[JQuery 插件](http://troymcilvena.com/post/998277515/jquery-retina)可以做到这一点。Apple 正在为自己的页面使用这种方法（不是 JQuery 插件），所以应该不会太糟糕。

如果您可以将内联更改`<img>`为 CSS 背景图像，则可以使用另一种方法。然后，您可以使用媒体查询将 HiRes 图像提供给 HiRes 设备：

```
#yourImageConteainer {
   background-image: url('image.png');
}    

@media all and (-webkit-min-device-pixel-ratio : 1.5) {
    #yourImageContainer {
        background-image: url('image@2x.png');
        background-size: 100px 100px;
    }
} 
```

我已经用 iOS`@2x`后缀命名了 HiRes 图像，尽管这不是必需的。

我不会为 LowRes 设备提供全分辨率图像，因为这会增加图像的大小，从而增加 LowRes 设备的加载时间而没有任何好处。

如果您可以在服务器端检测到 HiRes 设备，然后为请求设备提供最佳分辨率图像，那么恕我直言，这将是最好的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T12:25:15.963

不要为 iPad3/New iPad 过度放大图像。Safari 缩小高分辨率图像 [http://www.tomshardware.com/reviews/ipad-3-benchmark-review,3156-5.html](http://www.tomshardware.com/reviews/ipad-3-benchmark-review,3156-5.html)。以 iPad3 全分辨率查看 Web 图像的唯一方法是保存它们并在 Safari 之外查看它们。

编辑：

对于新的视网膜显示 macbook，此评论可能不再适用。未来，拥有高分辨率版本的网络图形可能会变得越来越重要。

# c# - 在 IEEE 十进制 (BCD) 和 Microsoft System.Decimal 之间转换

> ID：10730498
> 
> 赞同：1
> 
> 时间：2012-05-24T02:51:23.227
> 
> 标签：c#, decimal

有谁知道在 IEEE 十进制（最好是 BCD 格式）和 System.Decimal 之间转换的例程？

我正在寻找比转换为字符串和从字符串转换更好的东西，并且不希望手动编写解决方案。

到目前为止，我什至无法找到 Microsoft 的[System.Decimal](http://msdn.microsoft.com/en-us/library/system.decimal.aspx "System.Decimal")的明确描述，但链接的描述足以说明格式不一样。

# validation - 在 RelaxNG 模式中允许任意顺序的元素

> ID：10730501
> 
> 赞同：2
> 
> 时间：2012-05-24T02:51:50.607
> 
> 标签：validation, xsd, relaxng

我有一个看起来很像这样的 RelaxNG 模式：

```
<grammar xmlns="http://relaxng.org/ns/structure/1.0">
  <start>
    <element name="xml">
      <zeroOrMore>
        <element name="multi">
          <data type="string"/>
        </element>
      </zeroOrMore>
      <optional>
        <element name="optional">
          <data type="string"/>
        </element>
      </optional>
    </element>
  </start>
</grammar> 
```

我想允许 0-N`multi`标签，但 0-1 `optional`。只要 multis 在可选之前就可以正常工作，但是由于[RNG 中的相对顺序很重要，](http://relaxng.org/tutorial-20011203.html#IDA0FYR)如果它们在之后出现，它将失败：

有效的：

```
<xml>
  <optional/>
</xml>

<xml>
  <multi/>
  <multi/>
  <optional/>
</xml> 
```

无效的：

```
<xml>
  <optional/>
  <multi/>
  <multi/>
</xml> 
```

那么我怎样才能允许任意顺序但保留约束呢？我尝试将整个东西包装在一个`<zeroOrMore><choice>`块中，这允许任意顺序，但也允许任意数量的可选标签通过。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T10:08:26.660

如果我正确理解了您的问题，那么您要实现的目标是通过使用以下`<interleave/>`模式来完成的：

```
<?xml version="1.0" encoding="UTF-8"?>
<grammar xmlns="http://relaxng.org/ns/structure/1.0">
    <start>
        <element name="xml">
            <interleave>
                <zeroOrMore>
                    <element name="multi">
                        <data type="string"/>
                    </element>
                </zeroOrMore>
                <optional>
                    <element name="optional">
                        <data type="string"/>
                    </element>
                </optional>                
            </interleave>
        </element>
    </start>
</grammar> 
```

这将验证任何序列或零或一个`optional`元素以及零个或多个`multi`元素，包括您的示例。

# python - pywin32开头词崩溃

> ID：10730505
> 
> 赞同：2
> 
> 时间：2012-05-24T02:52:16.100
> 
> 标签：python, ms-word, win32com

我正在尝试使用 python 的`win32com`库来修改现有的 word 文件。

word文件保存为97-2003格式，我的电脑上安装了office 2010，

这是我的代码：

```
import win32com
from win32com.client import Dispatch, constants

msword = Dispatch('Word.Application')
doc = msword.Documents.Open(FileName = "Template.doc")

msword.Quit() 
```

并且程序在打开时就崩溃了`Template.doc`

```
D:\DongleMaker>DongleMaker.py
Traceback (most recent call last):
  File "D:\DongleMaker\DongleMaker.py", line 18, in <module>
    doc = msword.Documents.Open(FileName = "Template.doc")
  File "C:\Python27\lib\site-packages\win32com\gen_py\00020905-0000-0000-C000-000000000046x0x8x5\Documents.py", line 96, in Open
    , Visible, OpenAndRepair, DocumentDirection, NoEncodingDialog, XMLTransform
pywintypes.com_error: (-2147352567, 'Exception occurred.', (0, u'Microsoft Word', u'This file could not be found.\r ("C:\\...\\My Documents\\Template.doc")', u'
wdmain11.chm', 24654, -2146823114), None)

D:\DongleMaker> 
```

这是因为`win32com`不支持office 2010吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T03:09:56.900

这是因为 Word 在“我的文档”目录中查找您的 .doc 文件。只需提供 Template.doc 的完整路径（我相信它位于 DongleMaker 目录中），Word 就会成功启动。我的刚刚做了。

# iphone - iTunes Connect：带有特殊字符“✡”的应用程序名称

> ID：10730517
> 
> 赞同：1
> 
> 时间：2012-05-24T02:53:53.400
> 
> 标签：iphone, ios, app-store, app-store-connect

我想在 iTunes Connect 中将特殊字符“✡”添加到应用程序名称，但 iTunes Connect 听起来是不允许的，然后我尝试了这个：“⬉”，但它在摘要视图中以纯文本显示。并且“⬉”在应用描述中正确显示为“✡”。我能做些什么？

# asp.net - WCF 服务与 ASP.NET Web Api

> ID：10730519
> 
> 赞同：10
> 
> 时间：2012-05-24T02:54:04.550
> 
> 标签：asp.net, wcf, asp.net-web-api

任何人都可以分享 WCF 服务和 ASP.NET Web Api 之间的实际区别吗？在哪种情况下我们必须使用 WCF 服务和 ASP.NET Web Api。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-24T03:25:47.920

WCF Web API 是微软的下一代服务框架。

WCF 服务最初设计为具有通道体系结构，允许自定义用于在系统之间进行通信的协议和传输。虽然这为架构师/开发人员构建可互操作的应用程序提供了极大的灵活性，但其代价是复杂性。配置 WCF 从未如此简单 (IMO)。

最流行的用例 (IMO) 是使用 WCF 服务通过来自浏览器的 ajax 请求为 Web 应用程序提供支持以获取更多数据。此外，自从最初引入 WCF 以来，应用程序使用 http 提供 API 已变得很普遍。

因此，新的 WCF Web API 试图简化服务基础结构并采用 http 传输协议。

如果您正在构建一个新的 Web 应用程序，我会使用新的 Web API。如果我需要使用其他 http 与另一个系统进行通信，我只会考虑使用 WCF 服务。

* * *

WCF 通道架构

[http://msdn.microsoft.com/en-us/library/ms729840.aspx](http://msdn.microsoft.com/en-us/library/ms729840.aspx)

WCF Web API

[http://www.asp.net/web-api](http://www.asp.net/web-api)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-05-24T14:00:16.867

来自[http://mattmilner.com/Milner/Blog/post/2012/02/28/WebAPI-or-WCF.aspx](http://mattmilner.com/Milner/Blog/post/2012/02/28/WebAPI-or-WCF.aspx)，关于这个问题的一篇很棒的帖子：“WCF 仍然是构建服务的框架，您关心传输灵活性. Web API 是构建您关心 HTTP 的服务的框架。”

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-01-21T05:56:32.217

**网络服务**

它基于 SOAP 并以 XML 形式返回数据。它只支持 HTTP 协议。它不是开源的，但可以被任何理解 xml 的客户端使用。它只能托管在 IIS 上。

**WCF**

它也是基于 SOAP 并以 XML 形式返回数据。它是 Web 服务 (ASMX) 的演进，支持 TCP、HTTP、HTTPS、命名管道、MSMQ 等各种协议。WCF 的主要问题是其繁琐且广泛的配置。它不是开源的，但可以被任何理解 xml 的客户端使用。它可以托管在应用程序或 IIS 上或使用窗口服务。

**WCF 休息**

要将 WCF 用作 WCF Rest 服务，您必须启用 webHttpBindings。它分别通过 [WebGet] 和 [WebInvoke] 属性支持 HTTP GET 和 POST 动词。要启用其他 HTTP 谓词，您必须在 IIS 中进行一些配置，以接受对 .svc 文件的特定谓词的请求。使用 WebGet 通过参数传递数据需要配置。必须指定 UriTemplate 它支持 XML、JSON 和 ATOM 数据格式。

**网络 API**

这是以简单的方式构建 HTTP 服务的新框架。Web API 是开源的，是在 .NET Framework 上构建 REST-ful 服务的理想平台。与 WCF Rest 服务不同，它使用 HTTP 的全部功能（如 URI、请求/响应标头、缓存、版本控制、各种内容格式）它还支持 MVC 功能，如路由、控制器、动作结果、过滤器、模型绑定器、IOC容器或依赖注入，单元测试使其更加简单和健壮。它可以托管在应用程序或 IIS 上。它是轻量级架构，适用于智能手机等带宽有限的设备。响应由 Web API 的 MediaTypeFormatter 格式化为 JSON、XML 或您想要添加为 MediaTypeFormatter 的任何格式。

**由谁在 WCF 或 WEB API 之间进行选择**

当您想要创建一个应该支持特殊场景（例如单向消息传递、消息队列、双工通信等）的服务时选择 WCF。当您想要创建一个可以使用快速传输通道（例如 TCP、命名）的服务时选择 WCF管道，甚至可能是 UDP（在 WCF 4.5 中），并且您还希望在所有其他传输通道不可用时支持 HTTP。如果您想通过 HTTP 创建面向资源的服务，可以使用 HTTP 的全部功能（如 URI、请求/响应标头、缓存、版本控制、各种内容格式），请选择 Web API。如果您希望将服务公开给包括浏览器、手机、iphone 和平板电脑在内的广泛客户端，请选择 Web API。

# android - 解码流返回空

> ID：10730520
> 
> 赞同：3
> 
> 时间：2012-05-24T02:54:07.563
> 
> 标签：android, bitmap, android-image

我正在尝试采用[位图调整大小](http://developer.android.com/training/displaying-bitmaps/load-bitmap.html)教程 - 唯一的区别是我使用 decodeStream 而不是 decodeResource。这很奇怪，但没有任何操作的 decodeStream 给了我一个位图 obj，但是当我通过 decodeSampledBitmapFromStream 时，由于某种原因它返回 null。我如何解决它 ？

这是我使用的代码：

```
protected Handler _onPromoBlocksLoad = new Handler() {
        @Override
        public void dispatchMessage(Message msg) {
            PromoBlocksContainer c = (PromoBlocksContainer) _promoBlocksFactory.getResponse();
            HttpRequest request = new HttpRequest(c.getPromoBlocks().get(0).getSmallThumbnail());

            BitmapFactory.Options options = new BitmapFactory.Options();
            options.inJustDecodeBounds = true;
            InputStream stream;
            ImageView v = (ImageView) findViewById(R.id.banner);
            try {
                stream = request.getStream();

                //v.setImageBitmap(BitmapFactory.decodeStream(stream)); Works fine
                Bitmap img = decodeSampledBitmapFromStream(stream, v.getWidth(), v.getHeight());
                v.setImageBitmap(img);
            } catch (IOException e1) {
                // TODO Auto-generated catch block
                e1.printStackTrace();
            }
        }
    };

    public static int calculateInSampleSize(BitmapFactory.Options options, int reqWidth, int reqHeight) {
        final int height = options.outHeight;
        final int width = options.outWidth;
        int inSampleSize = 1;

        if (height > reqHeight || width > reqWidth) {
            if (width > height) {
                inSampleSize = Math.round((float)height / (float)reqHeight);
            } else {
                inSampleSize = Math.round((float)width / (float)reqWidth);
            }
        }
        return inSampleSize;
    }

    public static Bitmap decodeSampledBitmapFromStream(InputStream res, int reqWidth, int reqHeight) {
        BitmapFactory.Options options = new BitmapFactory.Options();
        options.inJustDecodeBounds = true;
        BitmapFactory.decodeStream(res, null, options);
        options.inSampleSize = calculateInSampleSize(options, reqWidth, reqHeight);
        options.inJustDecodeBounds = false;
        Bitmap img =  BitmapFactory.decodeStream(res, null, options); // Gives  null 
        return img;
    } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-09T10:01:04.517

由于 InputStream 对象只能被消费一次，当你想从 HttpUrlConnection 的 inputStream 中调整位图大小时，你必须对 InputStream 对象进行深拷贝，否则**decodeStream**将返回 null。这是一种可能的解决方案：

```
 HttpURLConnection urlConnection = null;
         InputStream in = null;
         InputStream in2 = null;
         try {
             final URL imgUrl = new URL(url);
             urlConnection = (HttpURLConnection) imgUrl.openConnection();
             in = urlConnection.getInputStream();

             ByteArrayOutputStream out = new ByteArrayOutputStream();
             copy(in,out);
             in2 = new ByteArrayInputStream(out.toByteArray());

             // resize the bitmap
             bitmap = decodeSampledBitmapFromInputStream(in,in2);                

         } catch (Exception e) {
             Log.e(TAG, "Error in down and process Bitmap - " + e);
         } finally {
             if (urlConnection != null) {
                 urlConnection.disconnect();
             }
             try {
                 if (in != null) {
                     in.close();
                 }
                 if (in2 != null){
                     in2.close();
                 }
             } catch (final IOException e) {
             Log.e(TAG, "Error in when close the inputstream." + e);
             }
         }
     } 
```

Method **copy**的源码如下：

```
public static int copy(InputStream input, OutputStream output) throws IOException{

     byte[] buffer = new byte[IO_BUFFER_SIZE];

     int count = 0;

     int n = 0;

     while (-1 != (n = input.read(buffer))) {

         output.write(buffer, 0, n);

         count += n;

     }

     return count;
 } 
```

Method **decodeSampledBitmapFromInputStream**的源代码如下：

```
public static Bitmap decodeSampledBitmapFromInputStream(InputStream in,
InputStream copyOfin, int reqWidth, int reqHeight) {

    // First decode with inJustDecodeBounds=true to check dimensions
    final BitmapFactory.Options options = new BitmapFactory.Options();
    options.inJustDecodeBounds = true;
    BitmapFactory.decodeStream(in, null, options);

    // Calculate inSampleSize
    options.inSampleSize = calculateInSampleSize(options, reqWidth, reqHeight);

    // Decode bitmap with inSampleSize set
    options.inJustDecodeBounds = false;
    return BitmapFactory.decodeStream(copyOfin, null, options);
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-24T04:12:48.650

问题是，一旦您使用了来自 HttpUrlConnection 的 InputStream，**您就不能倒带并再次使用相同的 InputStream**。因此，您必须为图像的实际采样创建一个新的 InputStream。否则我们必须中止 http 请求。

```
request.abort(); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-12T04:52:52.123

# android - 还有一个“无法加载属性文件”

> ID：10730524
> 
> 赞同：1
> 
> 时间：2012-05-24T02:55:05.163
> 
> 标签：android, eclipse

...加上**每个**项目都有“项目没有 default.properties 文件！编辑项目属性以设置一个。”

我刚从 AnDevConIII 返回时启动了适用于 Android 的 Eclipse 3.72 (Indigo) 开发环境 (Windows XP)，我的工作区中的 20 个项目中的每一个都显示 *无法加载项目*(xxxxxx) 的属性文件。

在 StackOverflow 和其他地方已经有上百万个关于这个问题的问题，但我还没有看到明确的答案。

给定项目的属性文件**究竟**是什么？它在哪里，它叫什么，它是如何创建的？

我已经删除了我的调试密钥库文件，完成了完整的清理和构建，并重新启动了 Eclipse。据我所知，我没有对我的环境进行升级更改。

帮助！提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T06:04:34.360

> 给定项目的属性文件？它在哪里，它叫什么，它是如何创建的？

属性文件是项目的主文件，它*提供诸如 Build Project Target 和 Library Dependencies 等信息*。

当您为项目指定任何 API 级别时，会*自动生成*此文件。

*根据该文件“default.properties”*和*“project.properties”*的ADT级别，有两个不同的名称

 *您可以直接在项目文件夹下看到此文件。

> 必须检查

在 Eclipse 中有一个视图，*当您尝试构建/运行项目时*`Window-Show View-Problems`，会明确指出问题是什么，实际错误是什么，如果您发现任何错误，则将其粘贴到您的问题中（也给出尝试goole）

 *> 还要检查

如果您的项目中存在具有当前 ADT 级别的适当名称的文件。

> 常见解决方案但建议先检查问题

*   重新生成你的`debug.keystore`文件
*   从工作空间中删除项目并再次导入
*   右键单击项目文件夹和`Android Tools-Fix project properties`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T22:42:58.727

对我来说，遵循 MKJParekh 的想法是成功的

我删除了我的 %USERPROFILE% 文件夹中的 debug.keystone！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T16:09:31.063

`project.properties`您需要在 Eclipse 中的项目根目录下 有一个名为的文件。

例如，您应该看到`AndroidManifest.xml`, 和它的正下方`project.properties`。这两个加上更多的文件可能。

这是我的内容：

```
# This file is automatically generated by Android Tools.
# Do not modify this file -- YOUR CHANGES WILL BE ERASED!
#
# This file must be checked in Version Control Systems.
#
# To customize properties used by the Ant build system edit
# "ant.properties", and override values to adapt the script to your
# project structure.
#
# To enable ProGuard to shrink and obfuscate your code, uncomment this (available   properties: sdk.dir, user.home):
#proguard.config=${sdk.dir}/tools/proguard/proguard-android.txt:proguard-project.txt

# Project target.
target=android-8 
```

请注意，唯一没有被注释掉的行是`target=android-8`

希望有帮助。

编辑：

刚刚意识到为什么会发生这种情况——您最近升级了 ADT 吗？AFAIK 这个 project.properties 要求相对较新，可能在 v14 左右。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-07T16:28:46.620

嘿，您可以删除目录下的调试证书，例如

> %USERPROFILE%/.androidon。

然后您可能需要清理然后构建以生成证书。**

# jquery - jquery ajax 错误

> ID：10730534
> 
> 赞同：0
> 
> 时间：2012-05-24T02:57:03.863
> 
> 标签：jquery, ajax

我正在使用 jquery ajax 来检索一些数据，但它失败了，下面是代码：

```
 $.Webpic_Init = function(){
        var type = 'default';
        $.ajax({
            url:SITE_PATH+"services/service.php?m=share&a=uploadwebpic&photo_type="+type,
            type: "POST",
            data:{ name: "John", location: "Boston" },
            cache:false,
            dataType: "json",
            success:function(result){
                alert(result);
            },
            error:function(){
                alert('error');
            }
        });
    } 
```

这会提醒“错误”。但是，如果我将 url 参数更改为 'SITE_PATH+"services/service.php"'，则会调度 'success' 事件。那么，如果我不想更改 url 参数，我该怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T06:39:45.350

```
 var type = 'default';
        $.ajax({
            url: 'services/service.php',
            type: "POST", dataType: "json",
            data: { 'm': 'share', 'a': 'uploadwebpic', 'photo_type': type, 'typename': "John", 'location': "Boston" },
            //contentType: "application/json; charset=utf-8",
            cache: false,           
            success: function (data) {
                alert(result);
            }
        }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T04:40:35.567

在url`/`中添加而不是添加`SITE_PATH`. 这将使 URL 相对于域，即相对于`www.your-domain.com/`. 如果`services`在某个子文件夹中，您可以这样做`/sub_folder_name/services/your_path_continue`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-28T13:36:39.893

只是一个建议，尝试使用[$.ajaxSetup()](http://api.jquery.com/jQuery.ajaxSetup/)来获得正确的错误，如下所示：

```
$(function() {
    $.ajaxSetup({
        error: function(jqXHR, exception) {
            if (jqXHR.status === 0) {
                alert('Not connect.\n Verify Network.');
            } else if (jqXHR.status == 404) {
                alert('Requested page not found. [404]');
            } else if (jqXHR.status == 500) {
                alert('Internal Server Error [500].');
            } else if (exception === 'parsererror') {
                alert('Requested JSON parse failed.');
            } else if (exception === 'timeout') {
                alert('Time out error.');
            } else if (exception === 'abort') {
                alert('Ajax request aborted.');
            } else {
                alert('Uncaught Error.\n' + jqXHR.responseText);
            }
        }
    });
}); 
```

这将帮助您正确处理 Ajax 错误并获得在进行 ajax 调用时发生的确切错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-24T03:54:18.957

您正在发出 POST 请求，您的所有字段都应该像您所做的那样位于数据对象中。

```
data:{ name: "John", location: "Boston" } 
```

你不应该在 url 上放任何东西。那是 GET 请求。

# c# - 以编程方式绑定 ComboBox ItemSource 和 Selected Value

> ID：10730535
> 
> 赞同：3
> 
> 时间：2012-05-24T02:57:14.630
> 
> 标签：c#, wpf, xaml

在下面的代码中，我试图将组合框的 ItemsSource 和 SelectedValue 绑定到模型上的两个不同属性。TickerList 是一个 Dictionary[string, string>。该列表显示正常，当我进行选择时，SelectedValue 已正确填充。但是，当我将 ViewModel.SelectedTicker 属性设置为字典的值之一时，组合框中的选定项目不会改变。我对这种类型的绑定印象深刻，如果我在模型上设置值，控件将反映该更改。关于我可能做错了什么的任何想法？（注意：我故意显示字典键并将字典的值用作 selectedValePath，这也是我在 viewmodel.SelectedTicker 属性上设置的值..这是设计使然）。

```
 //bind to list of TickerList
        Binding listBinding = new Binding() { Source = ViewModel.TickerList };
        cbPriceSource.DisplayMemberPath = "Key";
        cbPriceSource.SelectedValuePath = "Value";
        cbPriceSource.SetBinding(ComboBox.ItemsSourceProperty, listBinding);

        //bind selection to ViewModel.SelectedTicker
        cbPriceSource.DataContext = ViewModel;
        Binding selectedItemBinding = new Binding() { Source = ViewModel, Path = new PropertyPath("SelectedTicker"), Mode = BindingMode.TwoWay };
        cbPriceSource.SetBinding(ComboBox.SelectedValueProperty, selectedItemBinding); 
```

# apple-push-notifications - 加载 p12 证书时 Geoloqi 网站出错

> ID：10730537
> 
> 赞同：1
> 
> 时间：2012-05-24T02:57:25.517
> 
> 标签：apple-push-notifications, pkcs#12

我正在尝试通过上传 p12 开发和实时证书在 Geoloqi 网站上为我的 Geoloqi 应用程序配置 Apple 推送通知。不幸的是，当我单击“更新”时，网站不断通知我“编辑您的应用程序时出现问题。请在下面查看。然而，它也“隐藏”了配置 Apple 推送通知区域。这意味着不显示错误消息。我知道我的应用程序的 P12 证书可以正常工作，因为我已将它用于 Urban Airship，没有任何问题。我还在 Safari、Chrome 和 Internet Explorer 上尝试过这个过程，希望该网站可以为这些浏览器中的至少一个提供错误消息。在这种情况下提供的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T15:26:30.570

我解决了今天早上网站上没有出现错误消息的问题。感谢您对此的耐心等待。

您是否尝试过从 Keychain 重新导出 p12 证书？（https://developers.geoloqi.com/ios/push-notifications）我会尝试作为下一步。我已向我们的 CTO 发送了一封电子邮件，希望您能尽快收到回复。

谢谢你的耐心，

帕特里克·阿尔特·吉洛奇

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T18:24:32.177

请尝试再次上传证书。我们刚刚添加了密码字段，因此如果您使用密码导出证书，则必须在此处输入。如果这仍然不起作用，请通过 support@geoloqi.com 与我们联系。

# udp - Skype 和 Google Talk 怎么能大部分是点对点的呢？

> ID：10730538
> 
> 赞同：2
> 
> 时间：2012-05-24T02:57:38.343
> 
> 标签：udp, xmpp, skype, google-talk

我已经阅读了很多关于这个主题的内容，包括很多关于 SO 的内容。所以虽然不完全是一个编程问题，但希望可以在这里问。我是一名程序员，正在构建一个包含语音聊天的应用程序，如果有帮助的话。

我试图了解 UDP 转发如何通过 NAT 工作，特别是对于 Skype 和 Google Talk 语音聊天 (VOIP) 等系统。

我认为路由器正确路由 UDP 流量的唯一方法是，如果回复来自它发送数据包的相同 IP/端口组合。或者换句话说，客户端无法从服务器获取UDP数据包，除非它首先发送一个，否则路由器不知道将数据包发送到哪个客户端。

因此，如果我理解正确的话，Skype 和 Google Talk 等服务会进行一些初始设置以帮助对等方定位彼此，但之后通信变为对等通信。如果路由器不期望来自客户端 IP 的任何流量，那么来自客户端的第一个数据包如何直接到达另一个客户端？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T04:33:04.460

我正在研究它，因为我正在制作游戏（大学工作）P2P。

1 如何进行 NAT？当客户端发出请求时，NAT 会通过一扇门转发可用（注意此端口与发送它的计算机上的端口无关），并将源 ip 更改为您的 ip（路由器的公共 IP）。现在来了魔术：它在与该请求关联的 ip 和端口以及他用来发送消息的路由的门中存储了一个表。因此，当路由器收到请求时，它会查看什么是门和表以查看谁应该发送请求，而不管发出请求的 ip 或端口是什么。

2 如何为“远程客户端”配置 NAT？不可能的。但是客户端可以间接设置“你的”NAT。需要一个服务器来调解连接的启动。* Client1 cliente2 并连接到服务器，服务器发送到cliente2 的IP 和端口（NAT）。* client1 现在有数据连接到 cliente2，所以他发送相同的连接到服务器，接收数据 cliente2 与数据服务器相同。

注意1：TCP 不工作的原因很明显，即必须是UDP。Note2：数据在NAT表中存在多长时间，如何防止“超时”？好问题，正如我所说，我正在研究它，如果有人知道的话，请放在这里。

费利皮厘米

# php - PHP file_get_contents 返回错误

> ID：10730542
> 
> 赞同：3
> 
> 时间：2012-05-24T02:58:08.200
> 
> 标签：php, file-get-contents

我想知道是否有可能有这样的 if 语句：

```
if file_get_contents() returns error code xxx OR xxx
    die(); 
```

我不确定如何检查是否`file_get_contents()`返回错误。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-24T03:01:36.187

您似乎正在寻找 HTTP 状态代码。在这种情况下，您需要从这里阅读它：

```
$http_response_header 
```

[http://php.net/manual/en/reserved.variables.httpresponseheader.php](http://php.net/manual/en/reserved.variables.httpresponseheader.php)

否则，如果您想要一般错误，请按照 deceze 的说明进行操作。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-24T03:00:32.377

> [http://php.net/file_get_contents](http://php.net/file_get_contents)
> 
> 该函数返回读取的数据或失败时返回 FALSE。

它要么有效，要么无效，例如：

```
$file = file_get_contents(...);
if ($file === false) {
    die();
} 
```

* * *

PS：当然，在上面的答案中，我希望您使用`file_get_contents`来获取本地文件的内容。如果您尝试获取远程 URL 的 HTTP 状态代码，我建议您使用[cURL](http://php.net/curl)或类似的专用 HTTP 库并解析响应标头。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T03:01:31.240

正如[php 文档](http://at2.php.net/manual/en/function.file-get-contents.php)所述，`file_get_contents()`将返回`false`所有错误，所以你所能做的就是

```
if ($content=file_get_contents($filename)===false) die("Error reading file $filename"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-24T03:02:00.480

你可以这样称呼它：

```
$data = file_get_contents("http://site.com/that.php");
if ($data !== FALSE) {
   // analyze data
} 
```

# android - SDK或ADT如何为Android应用包的资源生成SHA1-Digest

> ID：10730543
> 
> 赞同：1
> 
> 时间：2012-05-24T02:58:20.227
> 
> 标签：android, message-digest

在已签名的 apk 中，会有一个*META-INF/MANIFEST.MF*文件。在这个文件中，我们可以找到这样的摘要：

> 名称：res/layout/main.xml SHA1-摘要：NJ1YLN3mBEKTPibVXbFO8eRCAr8=
> 
> 名称：AndroidManifest.xml SHA1-摘要：BlnC6ZBDtQYWeJNiespsQve82wY=
> 
> 名称：res/drawable-mdpi/ic_launcher.png SHA1-摘要：4ss2KZ3FzkmfE6HAAsVu0aJKx1U=

我找到了一种在 java 中生成摘要的方法，如下所示：

```
public static void main(String[] args) throws NoSuchAlgorithmException, Exception {
    MessageDigest md = MessageDigest.getInstance("sha-1");
    FileInputStream in =  new FileInputStream("./ic_launcher.png");
    int bytes = 0;
    while ((bytes = in.read()) != -1) {
        md.update((byte)bytes);
    }
    in.close();
    byte[] thedigest = md.digest();
    System.out.println(Base64Encoder.encode(thedigest));
} 
```

为了测试，我使用这个简单的代码生成了一些摘要，这些摘要与 apk 中的*META-INF/MANIFEST.MF*的摘要大部分相同，并且仍然有少量异常。像这个PNG文件：![在此处输入图像描述](../Images/a7eca399cb7ccfe7a0c36c95ff93e546.png)

在 apk 中，此 png 文件的摘要为*4ss2KZ3FzkmfE6HAAsVu0aJKx1U=* ，这与我上面的代码生成的*sjmKOs4BYDXg7COdeTc8tIfPBR0=*非常不同。

但是如何解释我的代码生成的几乎有20个摘要与apk中的摘要相同，而只有这个Png的摘要不同？

您能否告诉我 SDK 或 ADT 如何为 Android 应用程序包的资源生成 SHA1-Digest，或者与我的代码有什么不同？

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T09:00:01.320

创建 APK 文件的 aapt Android 工具对其输入进行一些处理。除了将 XML 资源转换为二进制形式外，它还优化了 PNG 文件。您很可能会获取原始 PNG 文件的哈希值，而 APK 中的 PNG 文件经过某种处理（压缩等），它的哈希值（摘要）是不同的。如果您解压缩导出的 APK 并获取包内 PNG 的哈希值，您应该得到相同的哈希值。

# c# - 为什么我的外部 C# 函数的参数列表中有一个“this”？

> ID：10730547
> 
> 赞同：2
> 
> 时间：2012-05-24T02:59:25.160
> 
> 标签：c#

我的代码在操作方法中有以下内容：

```
 catch (Exception e)
    {
        log(e);
        return Content(ExceptionExtensions.GetFormattedErrorMessage(e));
    } 
```

调用的函数如下所示：

```
public static class ExceptionExtensions
{
    public static string GetFormattedErrorMessage(this Exception e)

            if (e == null)
        {
            throw new ArgumentNullException("e");
        } 
```

有人可以解释为什么参数列表的开头有一个“this”吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-24T03:02:59.183

这是扩展方法的签名。它们是在 .NET3.5(C#3) 中引入的。没有`this`编译器会将其作为静态方法签名。在以下代码中：

```
public class Foo
{
    public void FooBar()
    {

    }
}
public static class FooEx
{
    public static void Bar(this Foo f)
    {
        f.FooBar();
    }
    public static void StaticBar(Foo f)
    {
        f.FooBar();
    }
} 
```

您可以像这样调用静态方法：

```
FooEx.StaticBar(new Foo()); 
```

和这样的扩展方法：

```
new Foo().Bar(); 
```

以及作为静态方法的扩展方法：

```
FooBar.Bar(new Foo()); 
```

因此，要将扩展方法转换为静态方法，您所要做的就是`this`从签名中删除关键字。但是，如果要将静态方法转换为扩展方法，则必须：

1.  将`this`关键字添加到签名中
2.  将方法放入非嵌套`public static`类
3.  制作方法的访问修饰符`public`

[Scott Hanselman 有一篇很好的文章](http://www.hanselman.com/blog/HowDoExtensionMethodsWorkAndWhyWasANewCLRNotRequired.aspx)，介绍了语法的选择以及它如何适应现有的 CLR，只需对编译器进行最小的更改。

综上所述，他得出的结论是，编译后生成的静态方法的 IL 代码和扩展方法的代码没有区别。关键字用于指示编译器在`this`扩展方法周围放置一些元数据。

我的猜测是，他们选择了`this`关键字，因为 1\. 它已经存在 2\. 与其他现有关键字相比，它的现有含义最适合扩展方法的上下文。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-24T03:04:55.497

因为这就是您定义“扩展”方法的方式。它让编译器知道应该允许直接在对象上调用此特定方法，它让您可以编写如下代码：

```
GetFormattedErrorMessage(e); 
```

而不是：

```
e.GetFormattedErrorMessage(); 
```

我不确定您发布的代码为什么以这种方式调用该函数。您应该能够直接在异常对象上调用该函数。扩展方法本质上是扩展内置类/类型行为的方法，否则您将无法修改。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-24T03:06:28.617

扩展方法如前所述，一些链接：

*   [扩展方法 (MSDN)](http://msdn.microsoft.com/en-us/library/bb383977.aspx)
*   [如何：实现和调用自定义扩展方法（C# 编程指南）](http://msdn.microsoft.com/en-us/library/bb311042.aspx)
*   [一个教程](http://csharp.net-tutorials.com/csharp-3.0/extension-methods/)

加上通常来自 Google 的数十篇博客文章和其他文档。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-05-24T03:02:26.073

“this”是传递给 Exception 方法的错误，类似于在函数中使用“this”。它只是指正在传递的异常。

# encryption - 这套VB6加密函数能破解吗？

> ID：10730548
> 
> 赞同：2
> 
> 时间：2012-05-24T02:59:34.957
> 
> 标签：encryption, vb6, cryptography

```
 Public Function EncryptString(theString As String, TheKey As String) As String
    Dim X As Long
    Dim eKey As Byte, eChr As Byte, oChr As Byte, tmp$
    For i = 1 To Len(TheKey)
         'generate a key
          eKey = Asc(Mid$(TheKey, i, 1)) Xor eKey
    Next

    'reset random function
    Rnd -1
    'initilize our key as the random seed
    Randomize eKey
    'generate a pseudo old char
    oChr = Int(Rnd * 256)
    'start encryption
    For X = 1 To Len(theString)
        pp = pp + 1
        If pp > Len(TheKey) Then pp = 1
        eChr = Asc(Mid$(theString, X, 1)) Xor _
                   Int(Rnd * 256) Xor Asc(Mid$(TheKey, pp, 1)) Xor oChr
        tmp$ = tmp$ & Chr(eChr)
        oChr = eChr
    Next
    EncryptString = AsctoHex(tmp$)    

End Function

Public Function DecryptString(theString As String, TheKey As String) As String

Dim X As Long
Dim eKey As Byte, eChr As Byte, oChr As Byte, tmp$
For i = 1 To Len(TheKey)
     'generate a key
     eKey = Asc(Mid$(TheKey, i, 1)) Xor eKey
Next
'reset random function
Rnd -1
'initilize our key as the random seed
Randomize eKey
'generate a pseudo old char
oChr = Int(Rnd * 256)
'start decryption
tmp$ = HexToAsc(theString)
    DecryptString = ""
    For X = 1 To Len(tmp$)
    pp = pp + 1
    If pp > Len(TheKey) Then pp = 1
    If X > 1 Then oChr = Asc(Mid$(tmp$, X - 1, 1))
    eChr = Asc(Mid$(tmp$, X, 1)) Xor Int(Rnd * 256) Xor _
           Asc(Mid$(TheKey, pp, 1)) Xor oChr
        DecryptString = DecryptString & Chr$(eChr)
Next

End Function

Private Function AsctoHex(ByVal astr As String)

For X = 1 To Len(astr)
hc = Hex$(Asc(Mid$(astr, X, 1)))
nstr = nstr & String(2 - Len(hc), "0") & hc
Next
AsctoHex = nstr

End Function 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-24T03:12:12.547

您永远不应该尝试自己实施这样的加密。正确地做到这一点非常困难，而且很容易意外地构建漏洞。

找到一个已被证明有效且经过大量测试的现有解决方案会更容易、更安全。[这](http://support.microsoft.com/kb/821762)可能是一个更好的解决方案。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-24T03:13:13.263

这有几个缺陷：

如果您想在与加密位置不同的系统上解密（或者如果您更新系统，......），您将遇到麻烦：`Randomize eKey`使用以下一组调用`Rnd`不能保证在重新启动后返回相同的序列。它肯定不会在不同的系统上返回相同的序列。

您将密码减少到单个 8 位值 (eKey)，因此您的加密具有 8 位的实际密钥长度。

简而言之：任何有权访问与您的系统足够相似的系统（即，您的解密实际上会产生明文的系统）只需要克隆您的`DecryptString`函数并使用 eKey=0..255 运行它。

**算了，用有用的东西吧。阅读[关于自制加密的 Schneier](http://www.schneier.com/blog/archives/2011/04/schneiers_law.html)。**

# button - 转到该其他应用程序，然后单击升级，但看不到升级按钮

> ID：10730553
> 
> 赞同：1
> 
> 时间：2012-05-24T03:00:07.200
> 
> 标签：button, upgrade

我创建了我的第一个 Android 应用程序，名为 3 Lil Letters。我在制作签名的 APK 时遇到问题。我找到了一个显示这些步骤的网络链接。那很棒。但是当我在最后一步时，我遇到了关于重复键的错误。它确实创建了 apk，所以我将它上传到 Google Play。然后我决定我应该尝试重新创建 apk，这样它就不会出现这个错误。我能够做到这一点，所以现在我有一个想要覆盖现有 APK 的 APK。当我尝试上传时，它说 apk 已经存在，我需要按下 UPGRADE 按钮。我只能看到上传按钮。

我尝试了 IE 和 FireFox 浏览器并遇到了同样的问题。我找不到升级按钮。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T03:01:14.440

上传`.apk`到 Google Play 后，您必须在构建中*增加版本号*才能上传另一个。您不能有两个`.apk`具有相同版本号的不同文件。您也无法`.apk`在上传后删除它，即使已知它以某种方式损坏。

# php - PHP ssh2_connect() 实现超时

> ID：10730556
> 
> 赞同：8
> 
> 时间：2012-05-24T03:00:16.560
> 
> 标签：php, libssh2

我正在使用 PHP`ssh2`库，并且只是在做：

```
$ssh = ssh2_connect($hostname, $port); 
```

问题是我想设置一个超时，即 5 秒后停止尝试连接。据我所知，ssh2 库不支持本机连接超时。如何实现超时包装器？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2017-09-14T08:54:11.920

我知道这是一个旧线程，但问题仍然存在。所以，这里是它的解决方案。

`ssh2_connect()`使用`socket_connect()`. `socket_connect`依赖于`default_socket_timeout`默认设置为 60 秒的 php ini 配置参数（[http://php.net/manual/en/filesystem.configuration.php#ini.default-socket-timeout](http://php.net/manual/en/filesystem.configuration.php#ini.default-socket-timeout)）

因此，解决我们问题的最简单方法是在运行时将 ini 设置更改为我们想要的值，然后再改回 ini 文件中设置的值，这样我们就可以避免影响软件的其他部分。在下面的示例中，新值设置为 2 秒。

```
 $originalConnectionTimeout = ini_get('default_socket_timeout');
    ini_set('default_socket_timeout', 2);

    $connection = ssh2_connect('1.1.1.1');

    ini_set('default_socket_timeout', $originalConnectionTimeout); 
```

[您可以通过阅读 libssh2 的源代码 ( https://github.com/libssh2/libssh2](https://github.com/libssh2/libssh2) )找到有关 ssh2 for php 工作原理的更多详细信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-20T21:49:34.943

我一直在为同样的问题苦苦挣扎一段时间。事实上，只要目标服务器的最大连接时间限制，尝试使用 ssh2 连接到“死”或无响应的服务器将使您的应用程序停止。

预先检测您的实例是否会在插入实例时给您带来麻烦的简单方法是对其进行 ping 操作（查看它是否有响应）。

```
function getPing($addr) 
{
    //First try a direct ping
    $exec = exec("ping -c 3 -s 64 -t 64 ".$addr);
    $array = explode("/", end(explode("=", $exec )) );
    if(isset($pingVal[1]))
    {
        //There was a succesful ping response.
        $pingVal = ceil($array[1]);
    }
    else
    {
        //A ping could not be sent, maybe the server is blocking them, we'll try a generic request.
        $pingVal = callTarget($addr);
    }

    echo intval($pingVal)."ms";
    if($pingVal > ["threshold"])
    {
        return false;
    }
    return true;
}

function callTarget($target)
{
    $before = microtime();
    $ch = curl_init();
    curl_setopt($ch, CURLOPT_URL, $target);
    curl_setopt($ch, CURLOPT_NOBODY, true);
    if (curl_exec($ch))
    {
        curl_close($ch);
        return (microtime()-$before)*1000;
    }
    else
    {
        curl_close($ch);
        return 9999;
    }
} 
```

这种方法可以让您更快地响应服务器的状态，因此您知道是否要浪费时间 ssh-ing 到它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-11T08:05:36.813

libssh2库[本身](http://www.libssh2.org/)不会执行 connect()，因此它不必为此提供超时。但是，libssh2 确实为其提供的功能提供*超时*...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-08-09T11:54:29.837

如果远程端的防火墙阻止 ping 数据包，使用 ping 执行可能会导致问题。此外，这可能会导致不同环境出现问题，或者可能存在其他障碍，因为访问限制执行命令。

您可以将 ini_get、ini_set aprroach 用于“default_socket_timeout”，正如 Patkos Csaba 之前所说的那样。但从我的角度来看，最好使用指定超时的测试套接字连接：

```
function sock_online_test($ip, $timeout=0.1, $port='22') {
    $fp = @fsockopen($ip, $port, $errno, $errstr, $timeout);
    if (!$fp) {
        return false;
    } else {
        fclose($fp);
        return true;
    }
}

$online = sock_online_test('192.168.1.1', 5);
// even domain may works
$online = sock_online_test('myserver.com', 5); 
```

# javascript - 在 Nodejs 中，如何在 MongoDB 调用返回之前停止 FOR 循环

> ID：10730561
> 
> 赞同：8
> 
> 时间：2012-05-24T03:00:36.030
> 
> 标签：javascript, node.js, mongodb, express

我正在处理下面的代码片段。我有一个名为“stuObjList”的 JSON 对象数组。我想遍历数组以查找具有特定标志集的特定 JSON 对象，然后进行数据库调用以检索更多数据。

当然，FOR 循环不会等待数据库调用返回，而是以 j == length 结束。并且当数据库调用返回时，索引“j”超出了数组索引。我了解 node.js 的工作原理，这是预期的行为。

这里的解决方法是什么？我怎样才能实现我想要实现的目标？

```
...............
...............
...............
else
{
  console.log("stuObjList.length: " + stuObjList.length);
  var j = 0;
  for(j = 0; j < stuObjList.length; j++)
  {
    if(stuObjList[j]['honor_student'] != null)
    {     
      db.collection("students").findOne({'_id' : stuObjList[j]['_id'];}, function(err, origStuObj)
      {
        var marker = stuObjList[j]['_id'];
        var major = stuObjList[j]['major'];
      });
    }

    if(j == stuObjList.length)
    {
      process.nextTick(function()
      {
        callback(stuObjList);
      });
    }
  }
}
}); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-24T12:26:15.193

“ [async](https://github.com/caolan/async) ” 是一个非常流行的模块，用于抽象出异步循环并使您的代码更易于阅读/维护。例如：

```
var async = require('async');

function getHonorStudentsFrom(stuObjList, callback) {

    var honorStudents = [];

    // The 'async.forEach()' function will call 'iteratorFcn' for each element in
    // stuObjList, passing a student object as the first param and a callback
    // function as the second param. Run the callback to indicate that you're
    // done working with the current student object. Anything you pass to done()
    // is interpreted as an error. In that scenario, the iterating will stop and
    // the error will be passed to the 'doneIteratingFcn' function defined below.
    var iteratorFcn = function(stuObj, done) {

        // If the current student object doesn't have the 'honor_student' property
        // then move on to the next iteration.
        if( !stuObj.honor_student ) {
            done();
            return; // The return statement ensures that no further code in this
                    // function is executed after the call to done(). This allows
                    // us to avoid writing an 'else' block.
        }

        db.collection("students").findOne({'_id' : stuObj._id}, function(err, honorStudent)
        {
            if(err) {
                done(err);
                return;
            }

            honorStudents.push(honorStudent);
            done();
            return;
        });
    };

    var doneIteratingFcn = function(err) {
        // In your 'callback' implementation, check to see if err is null/undefined
        // to know if something went wrong.
        callback(err, honorStudents);
    };

    // iteratorFcn will be called for each element in stuObjList.
    async.forEach(stuObjList, iteratorFcn, doneIteratingFcn);
} 
```

所以你可以像这样使用它：

```
getHonorStudentsFrom(studentObjs, function(err, honorStudents) {
    if(err) {
      // Handle the error
      return;
    }

    // Do something with honroStudents
}); 
```

请注意，[.forEach()](https://github.com/caolan/async#forEach)将为 stuObjList 中的每个元素“并行”调用迭代器函数（即，它不会等待一个迭代器函数完成对一个数组元素的调用，然后再在下一个数组元素上调用它）。这意味着您无法真正预测迭代器函数（或更重要的是，数据库调用）的运行顺序。最终结果：不可预测的荣誉学生顺序。如果顺序很重要，请使用[.forEachSeries()](https://github.com/caolan/async#forEachSeries)函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T03:07:58.087

啊，异步思考的美丽和挫败感。试试这个：

```
...............
...............
...............
else
{
  console.log("stuObjList.length: " + stuObjList.length);
  var j = 0, found = false, step;
  for(j = 0; j < stuObjList.length; j++)
  {
    if(stuObjList[j]['honor_student'] != null)
    {     
      found = true;
      step = j;
      db.collection("students").findOne({'_id' : stuObjList[j]['_id'];}, function(err, origStuObj)
      {
        var marker = stuObjList[step]['_id']; // because j's loop has moved on
        var major = stuObjList[step]['major'];
        process.nextTick(function()
        {
          callback(stuObjList);
        });
      });
    }

  }
  if (!found) {
    process.nextTick(function()
    {
      callback(stuObjList);
    });
  }
}
}); 
```

如果您发现“当我完成”步骤变得复杂，请将它们提取到另一个函数，然后从每个位置调用它。在这种情况下，因为它只有 2 行，所以复制似乎是公平的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T08:04:00.520

给定要求，您还可以使用下划线的“过滤器”方法[http://documentcloud.github.com/underscore/#filter](http://documentcloud.github.com/underscore/#filter)

```
var honor_students = _.filter(stuObjList, function(stud) { return stu['honor_student'] != null });
if (honor_students.length === 0) {
  process.nextTick(function() { callback(stuObjList); });
} else {
  var honor_students_with_more_data = [];
  for (var i = 0; i < honor_students.length; i++) {
    db.collection("students").findOne({'_id' : honor_students[i]['_id'];}, function(err, origStuObj) {
      // do something with retrieved data
      honor_students_with_more_data.push(student_with_more_data);
      if (honor_students_with_more_data.length === honor_students.length) {
        process.nextTick(function() { callback(stuObjList); });
      }
    }
  }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-12-31T15:09:00.147

```
And when the db call returns, the index 'j' is beyond the array index. 
```

在我看来，您需要在每次循环迭代时获取 j 的“副本”。你可以用闭包来做到这一点。

```
if(stuObjList[j]['honor_student'] != null)
{

    (function(j_copy){
        db.collection("students").findOne({'_id' : stuObjList[j_copy]['_id'];}, function(err, origStuObj)
        {
            var marker = stuObjList[j_copy]['_id'];
            var major = stuObjList[j_copy]['major'];
        });
    })(j)

} 
```

这样您就可以在每次迭代中保存 j 的状态。此状态保存在每个 IIFE 中。您将拥有与 for 循环一样多的已保存状态。当数据库返回时：

```
var marker = stuObjList[j_copy]['_id']; 
```

j_copy 将保留原始 j 的值，它在

```
if(stuObjList[j]['honor_student'] != null) 
```

我知道我的解释能力很差，但我希望你能明白我的意思。

编辑：这种方式我们使用立即调用的函数及其范围来保留 j 的单独私有副本。在每次迭代中，都会使用自己的私有范围创建新的 IIFE。在这个范围内 - 在每次迭代中，我们执行 j_copy = j。并且这个 j_copy 可以在 IIFE 中使用，而不会每次都被 for 循环覆盖。

# c - 从 rs232 读取多个字节到 uart (avr atmega16)

> ID：10730563
> 
> 赞同：1
> 
> 时间：2012-05-24T03:00:53.130
> 
> 标签：c, avr, uart, atmega16

我正在从我的 PC 向我的 atmega16 串行发送 4 个字节的数据。我使用UART。一种技术是使用数据表中给出的函数，但它们在使用轮询时会阻止其余代码。所以我正在使用一个while循环。但是当while循环开始时我无法理解代码的结构..请帮助我。谢谢

```
#include <avr/io.h>
#define FOSC 1843200// Clock Speed
#define BAUD 9600
#define MYUBRR FOSC/16/BAUD-1

void UART_Init( unsigned int ubrr)
{
/* Set baud rate */
UBRRH = (unsigned char)(ubrr>>8);
UBRRL = (unsigned char)ubrr;
/* Enable receiver and transmitter */
UCSRB = (1<<RXEN);
/* Set frame format: 8data, 2stop bit */
UCSRC = (1<<URSEL)|(1<<USBS)|(3<<UCSZ0);
}

int main( void )
{   
int i = 0;
unsigned char my_data [4];

UART_Init ( MYUBRR );

while (1)
{   
    if (UCSRA & (1<<RXC)) 
    {
        my_data[i] = UDR;
    }
    i++;

    if (i == 3)
    {
        /*my next code here and once thats done, its again in uart receive mode*/
    i = 0;
    }
}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T07:45:59.920

我已经使用了 while 循环并在它们旁边放了评论，所以希望你能理解它:)

```
while (1)
{   
    if (UCSRA & (1<<RXC)) //If Usart control and status register A and Receive complete flag are true (Comparing the register with the value of RXC, which is a bit in the register)
    {
        my_data[i] = UDR; //Read Usart Data Register, which is 1 byte
        i++; //Like Joachim Pileborg said, this should be in the if statement
    }

    if (i == 3) //If received your 4 bytes.
    {
        /*my next code here and once thats done, its again in uart receive mode*/
        //Do something with the data
        i = 0;
    }
} 
```

我希望现在很清楚！顺便说一句：你现在也在不断地轮询数据，所以这和我想的没有什么不同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T09:29:25.823

如果您不想使用阻塞轮询，则需要对传入数据进行中断驱动处理。基本上，你会用你的代码编写一个 RX-Complete-ISR：

```
 my_data[i] = UDR; //Read Usart Data Register, which is 1 byte
    i++; //Like Joachim Pileborg said, this should be in the if statement 
```

（当然，您通常需要打开中断 ( `sei();`) 并且 USART 接收到完整的中断，然后才能接收任何数据。）

然后，在您的主循环中，您可以执行其他任务并通过

```
if (i == 3) //If received your 4 bytes.
{
    /*my next code here and once thats done, its again in uart receive mode*/
    //Do something with the data
    i = 0;
} 
```

如果您的 ISR 已收到所有字节。

您可能需要注意一些同步问题，例如将 i 声明为`volatile`，但这是以最高效的方式完成的。

# android - 如何从计算机获取字符串数组到 android 应用程序

> ID：10730564
> 
> 赞同：0
> 
> 时间：2012-05-24T03:00:55.283
> 
> 标签：android, web-services

我在我的计算机上编写了一个 Java 程序，它在网上搜索并根据它找到的内容更新一个字符串数组。该程序将不断运行以保持准确的数据。

我需要做的是使用 Internet 将这个字符串数组从我的计算机获取到一个 android 应用程序。我试图通过 google docs api 做到这一点，但考虑到它如此简单的数据，我不确定那是最好的路线。

我是 android 新手并与网络交互，所以我想我会问是否有人知道实现此目的的简单方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T03:48:26.173

我会考虑使用 Google 的 Appengine 和/或 Android C2DM（云到设备消息传递）。要么在本地机器上设置服务器并使用 C2DM，要么让 Android 应用程序轮询服务器，但这似乎是一个真正的 PITA，很可能是矫枉过正。

# javascript - 使提交输入不可点击

> ID：10730568
> 
> 赞同：9
> 
> 时间：2012-05-24T03:01:20.463
> 
> 标签：javascript, jquery

我有以下输入：

```
<input type="submit" name="next" value="Next"> 
```

如何通过 jQuery 使该项目不可点击？（即，只有在满足某些验证条件**后**才能单击它）？

这是此问题的后续内容：[在满足验证后使提交可点击](https://stackoverflow.com/q/10730633/651174)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-24T03:04:20.813

2 演示[**演示 1 点击此处：**](http://jsfiddle.net/JbsfQ/) **或** [**演示 2 点击此处：**](http://jsfiddle.net/JbsfQ/2/)

所以你只需要检查验证是否正确完成。

即`if (notValid)`夹在下面的代码中，这将禁用按钮。**或者**更好的是从禁用`next`按钮开始。

为了使您可以将属性设置为false，我相信您有一个好主意，否则提供更多代码；我很乐意为您提供进一步的帮助。B-)

希望这可以帮助！

```
$("#submit").prop('disabled', true);​ 
```

**或者**

```
$("input[type='submit']").prop('disabled', true);​ 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-24T03:03:20.717

```
$('input[name="next"]').prop('disabled', true); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-24T03:07:37.410

您可以使用：

```
$("input[type=submit][name='next']").attr("disabled", "disabled");  // unclickable

$("input[type=submit][name='next']").removeAttr("disabled");    // clickable 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-24T03:14:14.747

禁用输入元素并不能始终阻止点击事件或其在浏览器中的进一步传播。

无论如何，如果验证失败，则简单地返回是合适`false`的，这样就不会执行操作（即表单提交）。这将阻止提交表单，并且由于单击处理程序仍在执行，您将能够向用户提供有关提交失败原因的详细信息：

```
$("#submit").click(function(){
    var isValid = true;
    /*perform validation checks, changing isValid value to false when needed*/
    return isValid; //will return false if validation fails etc.
}); 
```

# c# - 如何在我的 WP7 的 XNA 项目中包含一个 .c 文件

> ID：10730569
> 
> 赞同：0
> 
> 时间：2012-05-24T03:01:28.437
> 
> 标签：c#, windows-phone-7

我正在使用 XNA 框架为 Windows Phone 开发游戏。我想在我的项目中添加一个 .c 文件，但我没有得到解决方案。谁能告诉我如何添加/访问它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T11:39:32.970

显而易见的选择是在 C#（或 VB.Net，如果您愿意）中重新实现 C 方法并像这样调用它。Windows Phone 上的应用程序是沙盒的，不能运行任何“本机”代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T11:46:52.053

此时，您必须使用任何可以编译为 .Net CF IL（C#、VB.Net、F# 等）的语言来实现 C 代码。或者你可以等待大约 5 个月的 WP8，它很可能会运行一些 C/C++ 代码。

# ruby-on-rails - rails habtm 和 belongs_to :through

> ID：10730574
> 
> 赞同：0
> 
> 时间：2012-05-24T03:02:01.350
> 
> 标签：ruby-on-rails

我如何建立belongs_to :through（我知道这是无效的）关系？例如：一家公司有很多部门。一个部门有很多团队。有些团队是跨职能的，因此他们可以跨越许多部门（habtm）。

```
class Company < ActiveRecord::Base
  has_many :departments
  has_many :teams, through: :departments
end

class Department < ActiveRecord::Base
  belongs_to :company;
  has_and_belongs_to_many :teams
end

class Team < ActiveRecord::Base
  has_and_belongs_to_many :departments
end 
```

我如何从团队中获得公司。有什么好方法可以做到这一点？第一个应该有效，但我可以或应该尝试在模型中作为一种关系来做吗？

```
class Team < ActiveRecord::Base
  has_and_belongs_to_many :departments

  def company 
    departments.first.company
  end

end 
```

或者

```
class Team < ActiveRecord::Base
  has_and_belongs_to_many: departments

  has_one :company, through: departments  (<-- is this valid?, seems like this should be has_many but that's not right!)
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T03:05:55.997

你想要的关系已经存在。如果你知道所有部门都属于同一家公司，你可以这样做

```
my_team.departments.first.company 
```

# java - 在 testng 类中 Spring 的 @ContextConfiguration 测试配置只为每个测试类创建一次 bean，而不是每个测试

> ID：10730576
> 
> 赞同：2
> 
> 时间：2012-05-24T03:02:23.110
> 
> 标签：java, spring, unit-testing, testng

给定一个使用 spring 的测试实用程序注释 ContextConfiguration 来创建 bean 的 testng 类，bean 在测试类的生命周期内只创建一次。

在使用它之前，我总是使用 @BeforeMethod 在每个 @Test 方法之前重建所有内容。

我的问题：有没有办法让spring为每个@Test方法重建bean？

```
//The beans are unfortunately created only once for the life of the class.
@ContextConfiguration( locations = { "/path/to/my/test/beans.xml"})
public class Foo {

    @BeforeMethod
    public void setUp() throws Exception {
        //I am run for every test in the class
    }

    @AfterMethod
    public void tearDown() throws Exception {
        //I am run for every test in the class
    }

    @Test
    public void testNiceTest1() throws Exception {    }

    @Test
    public void testNiceTest2() throws Exception {    }

} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-22T16:00:41.140

如果您希望在每次测试运行时重新加载上下文，那么您应该扩展 AbstractTestNGSpringContextTests 并使用 @DiritesContext 注释以及 @ContextConfiguration。一个例子：

```
@ContextConfiguration(locations = {
        "classpath:yourconfig.xml"
})
@DirtiesContext(classMode = DirtiesContext.ClassMode.AFTER_EACH_TEST_METHOD)
public class YourTestClass extends AbstractTestNGSpringContextTests {
 //magic
} 
```

Context.ClassMode.AFTER_EACH_TEST_METHOD 的 classmode 将导致 spring 在调用每个测试方法后重新加载上下文。您还可以使用 DirtiesContext.ClassMode.AFTER_CLASS 在每个测试类之前重新加载上下文（对于所有启用 spring 的测试类的超类很有用）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T03:26:08.547

您的旧 @BeforeMethod 可能是正确的方法。

@ContextConfiguration 旨在在类级别注入 bean - 换句话说，它完全按照设计工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-11-11T23:54:27.567

另一种可能性是使用原型范围的 bean。每次实例化测试类时，都会实例化和连接原型范围的 bean。

请注意，JUnit 和 TestNG 对于何时实例化测试类使用不同的逻辑。JUnit 为每个方法创建一个新实例，TestNG 重用测试实例。鉴于问题是关于 TestNG 的，您需要将您的测试分解为许多测试类以实现整体效果。

# ruby-on-rails - Aptana 3 和 ruby 调试

> ID：10730578
> 
> 赞同：3
> 
> 时间：2012-05-24T03:02:46.590
> 
> 标签：ruby-on-rails, ruby, aptana3, ruby-debug

如何在 ruby​​ 中将手表设置为变量。我正在使用 Aptana 作为 IDE。我是为 .NET 而来的，并且习惯于通过将鼠标悬停在变量上来查看变量值。

在 aptana 3 中，我找不到查看当前状态和变量值的方法。我看到 self 对象有太多信息并且很难找到我正在寻找的变量的值？

![在此处输入图像描述](../Images/71ab8e04fc94c3d1a6a40a7f11891ebc.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T08:16:13.097

[This answer](https://stackoverflow.com/questions/8351604/ruby-debug-not-working/9260206#9260206) to a very similar question包括关于让ruby-debug-ide与Aptana 3一起工作的分步说明。它是从OS X的角度编写的，但你应该能够很容易地将它应用到你自己的设置中（采取特殊的注意阅读 RVM/非 RVM 注释）。

# java - Java StringTokenizer 仅尊重五个空白字符，仅此而已

> ID：10730582
> 
> 赞同：3
> 
> 时间：2012-05-24T03:03:27.700
> 
> 标签：java, guava

以下是什么意思：

> ...并且 StringTokenizer 仅尊重五个空白字符，仅此而已。

[http://code.google.com/p/guava-libraries/wiki/StringsExplained#Splitter](http://code.google.com/p/guava-libraries/wiki/StringsExplained#Splitter)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-24T03:06:21.210

大概这意味着默认情况下`StringTokenizer`会在`\n`, `\r`, space, TAB 和 formfeed 上中断。从最简单的构造函数的源代码：

```
this(str, " \t\n\r\f", false); 
```

您会看到那里列出的五个空白字符。不过，这并不是什么大问题，因为您可以使用其他构造函数之一指定自己的分隔符。`StringTokenizer`还有很多其他问题；默认的空白字符集是最不用担心的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-24T03:07:12.687

我猜这是指 a 的默认分隔符集`StringTokenizer`，它们是空格、`\n`、和.`\r``\t``\f`

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-24T11:30:50.080

我认为这里更重要的一点是 Java API 在其中一些字符串问题上的意外行为，尤其是关于空格和拆分的问题。默认`StringTokenizer`使用空格作为分隔符，但在一个非常独特的空格定义下（例如，Java API 中的每个其他定义似乎都包括行制表，而默认`StringTokenizer`才不是。在最终意识到，哎呀，这是一个不间断的空间，在整个网络上广泛使用之前，人们可能会合理地混淆为什么从用户传入的字符串确实有空格，但没有被拆分。是的，如果您仔细检查请求，您会发现这一点，如果您深入研究 Javadoc，您会发现这是默认行为，是的，您可以在构造时指定一组不同的字符你的`StringTokenizer`，但这并没有让它不那么烦人。

但我认为在这种情况下，番石榴论点的扩展范围甚至比意外行为还要广泛。一般来说，Java API 在定义空格的方式上完全不一致，这就是他们创建`CharMatcher.WHITESPACE`. [在这里](https://spreadsheets.google.com/pub?key=pd8dAQyHbdewRsnE5x5GzKQ)查看所有不同的定义，由 Guava 作者 Kevin Bourrillion 编译

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-24T03:12:56.917

我假设它们所指的“五个空白字符”是：空格、\t、\r、\n 和 \f。

# iphone - 键盘不能消失，表格单元格中的文本字段

> ID：10730587
> 
> 赞同：0
> 
> 时间：2012-05-24T03:04:28.477
> 
> 标签：iphone, uitextfield

我想要做的是将信息填充到我的表格的单元格中，并从包含 UILabel 和 UITextField 的 nib 文件中加载一个单元格，如下所示

![在此处输入图像描述](../Images/4b8661520fe72cce39219621e32f696c.png)

将信息提供给表格视图后，我有

![在此处输入图像描述](../Images/dcc8b5acdf2ff52b944d8a5cf3d31be8.png)

每当我单击文本字段时，都会弹出一个键盘。但是，如果我单击任何不属于文本字段的区域，键盘毕竟不会消失。

我实现了 UITextFieldDelegate 的代表之一，如下所示

```
-(void) touchesBegan :(NSSet *) touches withEvent:(UIEvent *)event
{
    [firstName resignFirstResponder];
    [lastName resignFirstResponder];
    [email1 resignFirstResponder];
    [email2 resignFirstResponder];
    [super touchesBegan:touches withEvent:event ];
} 
```

**我的问题是**：我怎样才能让键盘消失。

请就这个问题给我建议。欢迎任何意见在这里。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T03:08:44.390

试试这个：

```
- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event 
{
    [txt_1 resignFirstResponder];
    [txt_2 resignFirstResponder];
    // add more if needed
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T03:58:51.650

您可以通过以下方式完成此操作：声明另一个文本字段的属性，例如 currField；每当您触摸任何地方时，请在触摸委托方法中退出您的键盘。

如果您仍然遇到任何问题，请告诉我。

塔伦

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T05:08:46.523

您在哪个班级处理触摸事件？您可以在自定义单元格类中处理触摸事件。在那里，您只需为与该单元格关联的 singleTextField 调用 resignFirstResponder 即可。

# sencha-touch - 在 Sencha Touch 2 中屏蔽 Flash 内容

> ID：10730588
> 
> 赞同：0
> 
> 时间：2012-05-24T03:04:33.970
> 
> 标签：sencha-touch, extjs, sencha-touch-2

我知道你真的不应该在 Sencha Touch 项目中使用 Flash 和 SWF。但我在一个项目中使用它，我们将在 Chrome 中使用 HTML5 Web 应用程序。

[http://kachipun.se/sandbox/touch/](http://kachipun.se/sandbox/touch/)

现在我遇到的问题是我在菜单中使用幻灯片，就像 Facebook 在他们的应用程序中使用的那样。而当你点击左上角显示菜单的时候，啊半透明的蒙版覆盖了主要内容。现在，在列表中的第二个菜单项下，我有一个带有 SWF 的 tabPanel。这个 SWF 现在不能交互了，因为主面板上有一个无敌的面具。但有趣的是，SWF 中的所有悬停效果都按预期工作，您只是无法通过单击前进..

那么我如何在不破坏菜单的情况下摆脱这个面具，或者它是我将主面板带到面具上的一种方式？我尝试了各种 z-index hack，但似乎没有任何效果！

我希望我已经把自己说清楚了，我感谢我能得到的所有帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T09:53:01.353

您应该手动移除遮罩。

如果它在视口中，请使用：

```
Ext.Viewport.setMasked(false); 
```

如果它位于 id 为 my-id 的容器中，请使用：

```
Ext.getCmp('my-id').setMasked(false); 
```

# gridview - GridView 大列表按字母分页

> ID：10730590
> 
> 赞同：0
> 
> 时间：2012-05-24T03:04:48.977
> 
> 标签：gridview

我需要在一个 webpart 中显示所有员工。我通过遍历 SharePoint 中的所有用户创建了 gridview 并附加了数据。之后他们要求我添加分页，我在底部添加了我们的正常分页。现在他们希望按字母顺序分页..

单击“A”时，我需要显示从“A”开始的所有用户名等等...我需要添加字母分页和数字分页...

我通过谷歌搜索但无济于事..有人可以帮我吗？是否是 javascript/code 背后...以及如何合并搜索功能....

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T13:30:20.277

```
Method 1: Create Pager with Alphabets from A-Z 

**Aspx Page**

Open an aspx page in your Visual Studio, add a DataList and a GridView control into it. The DataList control is the Pager control, used to display the Page Numbers, in our terms Paging Alphabets and the GridView control is used to display the list of customers from the SQL Server database. First, in the Item Template section of the DataList, add a LinkButton and name it as lnkbtnPaging. Bind the Text and CommandArgument property of the LinkButton with the value as PageText and PageIndex respectively. PageText and PageIndex are the two columns from the DataTable, which we are going to create in the code-behind section to bind with this DataList. This DataTable will have values used for paging. Note that both PageText and PageIndex will have the same value. Then design the GridView control to display columns from the Employee table. 

 <asp:DataList ID="DataList1" OnItemCommand="DataList1_ItemCommand"
            OnItemDataBound="DataList1_ItemDataBound" RepeatDirection="Horizontal" runat="server">

        <SeparatorTemplate>

            </SeparatorTemplate>
            <ItemTemplate>
                <asp:LinkButton ID="lnkbtnPaging" runat="server" CommandArgument='<%# Bind("PageIndex") %>'
                    Text='<%# Bind("PageText") %>'></asp:LinkButton>
            </ItemTemplate>
        </asp:DataList>

        <br />

        <asp:GridView ID="GridView1" runat="server" EmptyDataText="No Records Found">
        </asp:GridView>

**Aspx.cs file**

The first method is to create an alphabetical paging control with alphabets from A to Z. For this we have to loop through 65 to 90, and convert the value to its equivalent character, which is from A to Z. Then store each value into a DataTable row and bind it with the DataList control. The code for this method is given below

 private void CreateAlphaPagings()
    {
        DataTable dt = new DataTable();
        dt.Columns.Add("PageIndex");
        dt.Columns.Add("PageText");
        if (this.ViewState["Paging"] == null)
        {
            for (int i = 65; i <= 90; i++)
            {
                DataRow dr = dt.NewRow();
                dr[0] = Char.ConvertFromUtf32(i);
                dr[1] = Char.ConvertFromUtf32(i);
                dt.Rows.Add(dr);
            }
            DataRow drNew = dt.NewRow();
            drNew["PageIndex"] = "All";
            drNew["PageText"] = "All";
            dt.Rows.Add(drNew);
            this.ViewState["Paging"] = dt;
        }
        else
            dt = (DataTable)this.ViewState["Paging"];
        DataList1.DataSource = dt;
        DataList1.DataBind();
    }

The above method creates a DataTable with two columns PageIndex and PageText. We loop through 65 to 90, whose ASCII character equivalent is from A to Z. We are using Char.ConvertFromUtf32 method to convert the number to alphabets. After conversion we assign the value to the PageIndex and PageText columns of the DataTable. Sometimes, the user needs to view all the data in a single page. To provide this option we have added another DataRow with value “All”. We have also used a ViewState variable in this method, in order to avoid the for-loop being executed every time this method is called. So for the first time, when the page loads, the ViewState is empty or null, thus execute the for-loop to create the rows for the DataTable, then the DataTable created will be stored in the ViewState called “Paging”. When this method is called subsequently, the ViewState “Paging” it will supply the alphabetical paging DataTable rows. Finally we bind the DataList is bind with the paging DataTable

**Bind the GridView control** 

To display the Customer information in a GridView control, we create a method called BindGrid, which takes a parameter called StartAlpha. This parameter is responsible to filter the customer records before binding it with the GridView control. If the parameter value is “All”, then all records will be displayed in the GridView control. The BindGrid method is given below.

  private void BindGrid(string StartAlpha)
    {
        string sql = "";
        if (StartAlpha == "All")
            sql = "Select ecode,firstName from sales_employee Order By Ecode Desc";
        else
            sql = "Select ecode,firstName from sales_employee Where firstName Like '" + StartAlpha
                + "%' Order By Ecode Desc ";

        string strConnection = "Your Connection String";

        con.ConnectionString = strConnection;

             con.Open();
            SqlDataAdapter adp = new SqlDataAdapter(sql,con);
            DataSet ds = new DataSet();
            adp.Fill(ds);
            GridView1.DataSource = ds;
            GridView1.DataBind();

    }

**Page Load Event** 

  protected void Page_Load(object sender, EventArgs e)
    {
        if (!IsPostBack)
        {
            this.ViewState["SelectedText"] = "All";
            CreateAlphaPagings();
            BindGrid(this.ViewState["SelectedText"].ToString());
        } 

    }
**DataList ItemCommand Event** 

    protected void DataList1_ItemCommand(object source, DataListCommandEventArgs e)
    {
        LinkButton lbkbtnPaging = (LinkButton)e.CommandSource;
        BindGrid(e.CommandArgument.ToString());
        this.ViewState["SelectedText"] = e.CommandArgument.ToString();
        CreateAlphaPagings();
    }

**DataList ItemDataBound Event** 

protected void DataList1_ItemDataBound(object sender, DataListItemEventArgs e)
    {
        if (e.Item.ItemType == ListItemType.AlternatingItem
          || e.Item.ItemType == ListItemType.Item)
        {
            if (this.ViewState["SelectedText"] != null)
            {
                LinkButton lbkbtnPaging = (LinkButton)e.Item.FindControl("lnkbtnPaging");
                if (this.ViewState["SelectedText"].ToString() == lbkbtnPaging.Text)
                    lbkbtnPaging.Enabled = false;
            }
        }
    } 
```

# oracle - 使用 select 在其他模式 oracle 中创建表

> ID：10730596
> 
> 赞同：2
> 
> 时间：2012-05-24T03:05:38.510
> 
> 标签：oracle, oracle11g

如何使用链接数据库在本地数据库的不同模式中创建表？

```
create table schema1.table1 select * from  schema.table@LinkedDB; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T03:15:00.603

你很亲密 - 使用：

```
CREATE TABLE schema1.table1 AS (SELECT * FROM SCHEMA.table@LinkedDB); 
```

你可以[在这里阅读更多关于它的信息](http://www.techonthenet.com/sql/tables/create_table2.php)。

# android - UI线程内的定期更新

> ID：10730604
> 
> 赞同：0
> 
> 时间：2012-05-24T03:06:50.303
> 
> 标签：android, multithreading, maps, overlays

对于 Android 中的一个新项目，我从服务器接收来自不同用户的位置，然后我需要将其作为覆盖放在谷歌地图上。现在这一切都很完美，但我似乎不可能定期更改叠加层的位置。我不能使用计时器，因为当我再次删除并显示覆盖时它会抛出 ConcurrentModificationException （我理解它为什么这样做，你不能在另一个线程中修改覆盖）。接收新位置时我也不能这样做，因为我使用 websockets 来检索它们，这也适用于不同的线程。

现在有什么方法可以让我在 UI 线程中定期更新 UI，这样就可以删除覆盖层（只需移动覆盖层也可以，但我猜这仍然需要定期更新......）？

这似乎是一个如此简单的问题，但我一直在寻找它几个小时，找不到任何解决方案......

任何有关如何完成此操作的帮助将不胜感激！

问候！

E.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T03:13:48.867

在您的 UI 线程上创建一个`Handler`并将其存储在一个类变量中。然后，在您的计时器上，或在您的 websocket 线程中，使用该处理程序`Runnable`将更新代码发布回 UI 线程。

# c# - 在 c# Visual Studio 中使用文本框或标签（如按钮）

> ID：10730608
> 
> 赞同：3
> 
> 时间：2012-05-24T03:07:26.713
> 
> 标签：c#

是否可以像在 ac#visual studio 文档中使用按钮一样使用标签或文本框？

即它可以被选中并产生类似于单击按钮的结果吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T03:24:32.477

最好使用链接标签。这样，每当鼠标悬停在它上面时，这个人就知道点击它会导致一个动作。

```
 private void linkLabel1_LinkClicked(object sender, LinkLabelLinkClickedEventArgs e)
      {
        MessageBox.Show("you have clicked a link label");
        //or whatever action you want it to do.
      } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-24T03:53:20.717

## 对于`Click`事件：

您可以使用[`Label.Click`](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.click.aspx)事件或[`TextBox.Click`](http://msdn.microsoft.com/en-us/library/system.windows.forms.textboxbase.click.aspx)事件

* * *

## 对于在 中选择某些文本时的事件`TextBox`：

尽管对此没有特殊事件，但您可以[`TextBox.MouseUp`](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.mouseup.aspx)像这样利用事件：

```
private void txtBox_MouseUp(object sender, System.Windows.Forms.MouseEventArgs e) 
{
    TextBox txtbx = sender as TextBox;
    if (txtbx != null)
    {
        if (txtbx.SelectionLength > 0)
        {
            string seltxt = txtbx.SelectedText;
            //Do Work Here with 'seltxt' variable!
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T03:12:28.170

我想如果你愿意，你可以使用任何东西作为按钮，但你为什么要而不是使用按钮呢？

[http://msdn.microsoft.com/en-us/library/system.windows.forms.label_events](http://msdn.microsoft.com/en-us/library/system.windows.forms.label_events)

WinForms 中的所有控件对象都有一个可以使用的“单击”事件。使用自定义方法订阅该事件并在该事件中执行您想要执行的操作。如果您希望标签具有按钮外观，我建议放置边框和悬停，使用适当的事件按下和释放装饰。

希望这可以帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-24T03:10:19.833

他们也有[`Click`](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.click.aspx)活动。

# service - 视觉泄漏检测器可以排除误报内存泄漏吗？

> ID：10730614
> 
> 赞同：2
> 
> 时间：2012-05-24T03:08:09.320
> 
> 标签：service, memory-leaks, visual-leak-detector

比如说，我现在正在使用 Visual Leak Detector (VLD) 来检查我们的服务应用程序中的内存泄漏。而且，由于大量内存分配发生在静态对象中，所以我只是想知道，VLD 可以排除那些误报内存泄漏（它不应该被视为真正的内存泄漏）

非常感激

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T03:11:31.757

经过一番调查，我发现这个 VLD 无法排除那些误报内存泄漏（例如静态对象中的 new），因为它还在其 vld.dll 中使用了全局静态对象，并且其 dtor 将报告可能的内存泄漏。由于您无法确保它们的析构函数顺序，因此您无法使用 VLD 来检测静态对象中的内存泄漏。

但是，我还找到了一个绕过解决方案，因为您可以修改此工具的源代码，您可以使用 atexit 在您的 ctor 中注册 reportMemoryLeak 函数，以确保在 dtor 之后调用此方法。

坦率地说，这真的不是那么直接，所以看看这个 [http://cfc.kizzx2.com/index.php/detecting-memory-leaks-with-windbg-the-modern-and-free-way/](http://cfc.kizzx2.com/index.php/detecting-memory-leaks-with-windbg-the-modern-and-free-way/) 使用windbg+DebugCRT堆没问题！

# html - CSS 媒体查询和 Photoshop “切片和切块”表

> ID：10730615
> 
> 赞同：-2
> 
> 时间：2012-05-24T03:08:30.580
> 
> 标签：html, css, dreamweaver, photoshop

对的人，这里有一点讨论——

我正在创建一个带有 div 和 HTML5 标准的网站。但是，由于我的屏幕分辨率，我的网页只适合 1440x900。我必须使用 CSS 媒体查询来调整页面大小以适应 800 x 600 桌面分辨率，但这里有一个想法：

1.  Photoshop 也可以调整大小，但使用切片和切块表，无需其他代码或 CSS 调整。当表格可以帮助您自动调整每个分辨率（即使对于移动网站）的大小时，表格真的那么糟糕吗？

2.  如果您的 CSS 媒体查询遇到一个拥有窗口浏览器屏幕的人，例如用户拥有 768 x 560 而不是全屏 800 x 600 分辨率浏览器，该怎么办？这是否意味着您的 CSS 媒体查询需要定义该分辨率以适应窗口大小？（我在这里想说的是，我的媒体查询只适合定义大小为 320 像素、480 像素、600 像素、768 像素、1024 像素、1400 像素的浏览器，除此之外，这些值使屏幕正确显示。）

3.  我目前正在使用 CSS3 媒体查询，但我必须定义很多分辨率大小（从 320 像素、480 像素、600 像素、768 像素、1024 像素、1400 像素的宽度）。这真的有必要吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T03:45:22.983

1.  Photoshop 不会帮助您“在每个分辨率上自动”调整网站设计的大小。事实上，随着这些天的发展——几乎不可能知道未来任何设备上的分辨率是多少。我相信 Android 操作系统现在有超过 100 种不同的分辨率。还要记住，Photoshop 确实是一个图形程序。

2.  虽然媒体查询利用了断点的概念，但它们最好与流体设计的概念结合使用（使用百分比而不是固定宽度/大小）。您实际上不需要定义媒体查询来适应每个常见的监视器宽度。最好使用流畅设计的原则，然后当事物在某个点或宽度变得过于拥挤/间隔开时，使用媒体查询（断点）来更改布局/设计以适应屏幕/浏览器窗口的物理尺寸.

3.  这可能是必要的，也可能不是。同样，这取决于您是否想在某个时候更改您的设计。也许尝试设计一个只有百分比的网站只是为了看看有什么可能，然后当事情变得丑陋或在视觉上不能很好地浮动时，在这些断点处放置一些媒体查询并调整浮动和比例以满足您的需求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T07:10:23.573

Photoshop 不允许重新调整您必须手动执行的页面大小.. 以及您的其他点媒体查询我设计了很多带有 1 个 css 的网站只需应用 css 之类的

```
<body style="width:100%">
<div style="width:200px;"></div>
<div style="width:200px;"></div>
<div style="width:200px;"></div>
<div style="width:200px;"></div>
</body> 
```

这将自动调整所有设备桌面和移动设备中的所有内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T13:44:51.683

当您开发基于不同设备的应用程序时。看 [960.gs](http://960.gs/)真的很好，而不是依赖于 css 媒体查询。即使它涉及一两天的学习曲线，它也让我们的生活更轻松。

# javascript - 适合初学者的简单 Javascript 循环查询

> ID：10730617
> 
> 赞同：1
> 
> 时间：2012-05-24T03:08:45.560
> 
> 标签：javascript, facebook, dom-events

请问我这个问题已经有2天了..我无法解决它..我知道这是基本的但我似乎无法解决它..

我需要从 Facebook 查询所有朋友，我只需要发布性别==男性的朋友。

我这样做了，它只返回一个结果.. 而我有 50 多个男性朋友..

帮我

```
 FB.api('/me/friends?fields=name,first_name,gender', function(response) {
        console.log(response);
        var divContainer=$('.facebook-friends');
        var testdiv = document.getElementById("test");
        var i=0;

        while (i<response.data.length && response.data[i].gender=='male'){
            testdiv.innerHTML +=  response.data[i].first_name + '<br/>' ;
            i++;
        } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T03:13:45.143

问题在于您的循环条件。

你用那个循环说的是：只要这个人存在并且是男性，就继续循环。因此，每当您的循环遇到女性朋友时，它都会返回 false 并停止循环。

我还建议您`for`为此使用循环而不是`while`循环，如下所示：

```
for(var i=0; i<response.data.length; i++){
    if(response.data[i].gender == 'male'){
         testdiv.innerHTML += response.data[i].first_name + '<br />';
    }
} 
```

# javascript - socket.io 服务器在注册客户端断开连接时非常延迟

> ID：10730618
> 
> 赞同：2
> 
> 时间：2012-05-24T03:08:52.697
> 
> 标签：javascript, node.js, socket.io, long-polling

我有一个使用 xhr 作为其唯一传输的 socket.io 连接。当我在浏览器中加载应用程序（在 chrome 和 ff 中测试）时，套接字连接并且一切正常，直到我离开页面。如果我重新加载浏览器，我可以看到客户端发出了“断开连接”事件，但服务器断开连接事件在很长一段时间内都不会触发（可能是客户端心跳超时时）。这是一个问题，因为当客户端断开连接时，我在服务器中进行了一些清理工作。如果客户端重新加载，我会在断开连接之前收到多个连接事件。我也尝试在窗口的“beforeunload”事件中手动从客户端发出断开消息，但无济于事。有任何想法吗？

我调试了 socket.io 服务器，我可以确认 Manager.prototype.onClientDisconnect 只是因为“关闭超时”的原因而受到打击。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T19:37:39.937

经过更多调试后，我注意到 socket.io Manager 对象中有以下配置：

```
blacklist : ['disconnect'] 
```

这会导致 namespace.js 中的这个分支不处理事件：

```
case 'event':
  // check if the emitted event is not blacklisted
  if (-~manager.get('blacklist').indexOf(packet.name)) {
    this.log.debug('ignoring blacklisted event `' + packet.name + '`');
  } else {
    var params = [packet.name].concat(packet.args);

    if (dataAck) {
      params.push(ack);
    }

    socket.$emit.apply(socket, params);
} 
```

此拉取请求中详细说明了更改[https://github.com/LearnBoost/socket.io/pull/569](https://github.com/LearnBoost/socket.io/pull/569)。我理解 XHR 为何如此，因为任何人都可以发送带有随机会话 ID 的 HTTP 请求，试图断开其他用户与服务器的连接。

我打算做的是检查每个新连接是否存在服务器中的现有会话 ID，并确保在继续连接逻辑之前运行我的断开逻辑。

# zend-framework - 使用 Zend_Dom_Query 获取第一个元素

> ID：10730620
> 
> 赞同：2
> 
> 时间：2012-05-24T03:09:06.537
> 
> 标签：zend-framework, zend-dom-query

我想使用 Zend_Dom_Query 示例获取第一个元素我在文档中有 2 个表单：

```
<html><form/><form/></html> 
```

我怎样才能得到第一个表格？我试过这个：`$dom->query('form:eq(1)')`像jQuery选择器但没有成功。你能帮助我吗？非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T03:21:45.850

Zend_Dom_Query 有一些有限但相当不错的 CSS 选择器集。`:eq`不过，它是一个特定于 jQuery 的扩展，而不是一个实际的 CSS 选择器。

您可以改用 Zend_Dom_Query 的 XPath 支持，例如：

```
$dom->queryXpath('//form[1]'); 
```

# c++ - 管理指向派生对象的指针集合的最佳方法

> ID：10730624
> 
> 赞同：3
> 
> 时间：2012-05-24T03:09:28.587
> 
> 标签：c++, oop, c++11

我是来自 c# 的 c++ 新手。以下代码不起作用，我不确定它需要什么。任何有助于我理解为什么它不起作用以及它应该有哪些适当的改变的见解将不胜感激。

```
// GamePlayScreen derives from ScreenBase
std::unique_ptr<GameplayScreen> m_game(new GameplayScreen());

// MenuScreen derives from ScreenBase
std::unique_ptr<MenuScreen> m_menu(new MenuScreen());

// PauseScreen derives from ScreenBase
std::unique_ptr<PauseScreen> m_pause(new PauseScreen());        

std::vector<std::unique_ptr<ScreenBase>*> screens;

screens.push_back(&m_game); // this gets the error 
```

我得到编译错误：

> C2284“无法将参数 1 从 'std::unique_ptr<_Ty> *' 转换为 'std::unique_ptr<_Ty> *&&'

如果我注释掉最后一行，它编译得很好。

基本上，我想要一个派生项目的集合（或者更确切地说是指向它们的指针）。我尝试了各种“指向和/或引用”参数的方法以及建立 T in 的各种方法，`vector<T>`但解决方案让我望而却步。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T03:44:10.253

没有编译器可以在这里验证，但我相信你可以：

```
// GamePlayScreen derives from ScreenBase
std::shared_ptr<GameplayScreen> m_game(new GameplayScreen());

// MenuScreen derives from ScreenBase
std::shared_ptr<MenuScreen> m_menu(new MenuScreen());

// PauseScreen derives from ScreenBase
std::shared_ptr<PauseScreen> m_pause(new PauseScreen());        

std::vector<std::shared_ptr<ScreenBase>> screens;

screens.push_back( m_game ); 
```

就像@cheers-and-hth-alf 所说，您可能需要共享指针。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-24T14:09:29.990

我读了很多：

> ...您可能想要 shared_ptrs ...

我会鼓励人们`unique_ptr`在不确定时默认。在`shared_ptr`没有内存所有权设计的情况下崩溃正是导致循环内存泄漏的原因。

是的，您也可以创建循环内存泄漏`unique_ptr`。然而，我的经验是，当`unique_ptr`使用它时，它会鼓励设计人员了解随着设计的发展谁拥有什么，从而降低循环内存泄漏的可能性，并且在发生时更容易调试。

如果在这个设计过程中，设计者发现共享所有权语义实际上是需要的，那么一定要努力`shared_ptr`（并且可能`weak_ptr`也打破这些循环）。

最后，尽快将原始指针绑定到智能指针。以下是遵循最佳实践的 OP 问题的可编译草图：

```
#include <type_traits>
#include <utility>
#include <memory>
#include <vector>

// A general purpose factory function for unique_ptrs
// Feel free to make this factory function more specific to your domain
template <class T, class ...Args>
typename std::enable_if
<
    !std::is_array<T>::value,
    std::unique_ptr<T>
>::type
make_ScreenParts(Args&& ...args)
{
    return std::unique_ptr<T>(new T(std::forward<Args>(args)...));
}

// Your class hierarchy
struct ScreenBase
{
    // Don't forget to make your destructors virtual
    virtual ~ScreenBase() = default;
};

// Future-proof your code with typedef's
// If / when you need to switch smart pointer types
//  or container types, you'll thank yourself
typedef std::unique_ptr<ScreenBase> ScreenPtr;
typedef std::vector<ScreenPtr> ScreenContainer;

struct GameplayScreen
    : public ScreenBase
{
};

struct MenuScreen
    : public ScreenBase
{
};

struct PauseScreen
    : public ScreenBase
{
};

int main()
{
    // raw pointers never exposed here...
    ScreenContainer screens;
    screens.push_back(make_ScreenParts<GameplayScreen>());
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-24T03:20:15.820

尝试如下更改最后两行：

```
std::vector<std::unique_ptr<ScreenBase>> screens;

screens.push_back(std::move(m_game)); 
```

我删除了星号，因为您可能想要一个 的向量`unique_ptr`，而不是指向 a 的指针向量`unique_ptr`。此外，`unique_ptr`顾名思义，这意味着一次`unique_ptr`只能拥有一个所有权，因此您需要明确说明`std::move`它以转移所有权。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-24T03:14:36.257

使用`shared_ptr`而不是`unique_ptr`，因为您将从许多地方引用这些屏幕对象。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-24T03:27:24.130

听起来您有这样一种情况，您想管理具有特定类型的各种屏幕，但还要有另一个屏幕列表作为基本类型，这样您就可以在所有屏幕上进行某些操作而不必知道详细信息特定类型的屏幕。

我认为在这种情况下，您只需要一个原始指针：

```
// GamePlayScreen derives from ScreenBase
std::unique_ptr<GameplayScreen> m_game(new GameplayScreen());

// MenuScreen derives from ScreenBase
std::unique_ptr<MenuScreen> m_menu(new MenuScreen());

// PauseScreen derives from ScreenBase
std::unique_ptr<PauseScreen> m_pause(new PauseScreen());        

std::vector<ScreenBase*> screens;

screens.push_back(&*m_game); 
```

如果您破坏屏幕，您只需要小心不要让屏幕中的指针悬空。

# objective-c - 可可中的copyItemAtURL

> ID：10730626
> 
> 赞同：1
> 
> 时间：2012-05-24T03:09:50.533
> 
> 标签：objective-c, cocoa, nsfilemanager

我正在尝试使用用户界面制作一个非常简单的 rsync 程序。我所需要的只是能够拖放两个文件路径，以便将一个复制到另一个。现在我只是想把我桌面上的一个文件复制到桌面上的一个文件夹中，这甚至行不通。我正在使用标题为“源”和“目标”的文本字段来删除我拖入其中的文件路径。我有以下代码：

```
#import "AppController.h"

@implementation AppController

@synthesize source = _source, destination = _destination;

-(IBAction)sync:(id)sender
{
 NSFileManager *manager = [[NSFileManager alloc] init];
    //NSURL *source = [NSURL fileURLWithPath:@"/Users/crashprophet/Desktop/Time Out Tot Schedule.doc"];
  //  NSURL *destination = [NSURL fileURLWithPath:@"/Users/crashprophet/Desktop/untitled f     older 2"];
NSURL *source = [NSURL URLWithString:self.source.stringValue];
NSURL *destination = [NSURL URLWithString:self.destination.stringValue];

[manager copyItemAtURL:source toURL:destination error:nil];
NSLog(@"The source path is %@ and the destation path is %@",source, destination);
NSLog(@"Got here!");
}

@end 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T03:29:44.333

您需要使用 fileURLWithPath: 如果您的字符串看起来像您评论中的字符串。此外，目标路径不能只是一个文件夹，它的末尾需要一个文件名——您可以使用与原始文件名相同的文件名，也可以给它一个新的文件名。从您正在使用的复制方法的文档中：

“dstURL 放置 srcURL 副本的 URL。此参数中的 URL 不能是文件引用 URL，并且必须在其新位置包含文件的名称。此参数不能为 nil。”

# java - 使用字符串拆分 Java 重建字符串

> ID：10730632
> 
> 赞同：0
> 
> 时间：2012-05-24T03:10:21.987
> 
> 标签：java, string, split

我正在编写一个程序，它将采用活页乐谱（歌词上方的和弦）并移调键。我选择拆分歌曲字符串，操作和弦名称并构建一个新字符串。我的方法是将歌曲分成几行`String[] holder = song.split("\\n+");` 然后，取每一行并根据空格分割`String[] oneLine = s.split("\\s");`

在构建新字符串时，保持原始间距绝对至关重要。我的问题是，通过拆分 //s 我失去了所有间距的历史。谁能建议我的问题的解决方案？

这是一首示例歌曲

```
String song = "G   Em  C   D\nSome Lyrics Go Here\nG   C   D\nOther Lyrics Go Here"; 
```

目前我的转置歌曲看起来像这样......

```
AF#mDE
Some Lyrics Go Here
ADE
Other Lyrics Go Here 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T03:15:44.400

如果您使用 a`StringTokenizer`来拆分字符串，则可以将其配置为保留并返回分隔符。这样，您可以保持空格数。

请参阅[`StringTokenizer(String,String,boolean)`](http://docs.oracle.com/javase/6/docs/api/java/util/StringTokenizer.html#StringTokenizer%28java.lang.String,%20java.lang.String,%20boolean%29)构造函数。

> **公共 StringTokenizer(String str, String delim, boolean returnDelims)**
> 
> 为指定的字符串构造一个字符串标记器。参数中的所有字符`delim`都是分隔标记的分隔符。
> 
> 如果`returnDelims`标志为真，则分隔符也作为标记返回。每个分隔符都作为长度为 1 的字符串返回。如果标志为假，则跳过分隔符，仅用作标记之间的分隔符。
> 
> 请注意，如果`delim`为 null，则此构造函数不会引发异常。但是，尝试在生成的 StringTokenizer 上调用其他方法可能会导致 NullPointerException。
> 
> **参数：**
> `str` - 要解析的字符串。
> `delim`- 分隔符。
> `returnDelims`- 指示是否将分隔符作为标记返回的标志。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T03:13:12.983

正如您已经注意到的那样，您不需要使用`String.split()`which 会丢弃您的间距，而是需要使用其他一些技术。您可以简单地在循环中一次处理一个字符，将处理后的每个字符附加到 a `StringBuilder`，这样您最终会得到相同数量的字符。

# javascript - 满足验证后使提交可点击

> ID：10730633
> 
> 赞同：0
> 
> 时间：2012-05-24T03:10:26.870
> 
> 标签：javascript, jquery

我有以下html：

```
<p>Genre: {{ create_production_form.genre }}</p>
<p>Privacy: {{ create_production_form.privacy }}</p>
<p><input type="submit" name="next" value="Next" disabled="disabled"></p> 
```

`next`仅在填写类型和隐私后，如何使按钮可点击？例如，类似：

```
if ($("id_genre").val() && $("id_privacy").val()) {
    $("input[name=next]").attr("disabled","")
} 
```

唯一的问题是，它需要是“实时的”，因此它可以检测到所有这些字段何时都已填写。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T03:14:56.600

呜？“事件”处理委托，因此“事件处理程序”需要具有`live()`或`on()`取决于您使用的 jQuery 版本。这意味着等式的一个重要部分被遗漏了。

我所说的“事件”方法是`submit`,`change`或`click`. 您必须使用上述`live()`或`on()`方法将代码委托给这些事件之一。

否则，如果您只是想在数据已填满的情况下启用它们。

```
$('form :input').change(function(){
  if ($("id_genre").val() && $("id_privacy").val()) {
    $("input[name=next]").attr("disabled","")
  }
}); 
```

这将检查表单以查看输入是否更改，如果更改，它将测试值并且您将获得结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T03:14:06.570

假设它们都是文本输入，您可以验证 on `keyup`，否则验证 on`change`也可以。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T03:18:31.707

尝试在悬停时使用，因为用户必须在单击之前将鼠标悬停在按钮上，希望对您有所帮助

```
$("input[name=next]").hover(function() {

    if ($("id_genre").val()!="" && $("id_privacy").val()!="") {
        $("input[name=next]").removeAttr("disabled")
    }
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-24T03:20:38.283

```
 $('form').change(function() {
    if ($("id_genre").val().length > 0 && $("id_privacy").val().length > 0) {
        $("input[type='submit']").prop("disabled", false)
    }
  }) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-24T03:23:41.920

**演示** [http://jsfiddle.net/8AtAz/1/](http://jsfiddle.net/8AtAz/1/)

在演示中，当您单击有效按钮时，它将启用下一个按钮：请让我知道我是否错过了任何一点。

**代码**

```
$("input[type='submit']").prop('disabled', true);
$("#valid").click(function() {

    $("input[type='submit']").prop('disabled', false);
})​ 
```

**或者**在你的情况下

```
 if ($("id_genre").val() != "" && $("id_privacy").val() != "") {
        $("input[type='submit']").prop("disabled", false)
    } 
```

# database - 应该是无限的主键的类型/值应该是什么

> ID：10730635
> 
> 赞同：0
> 
> 时间：2012-05-24T03:10:52.300
> 
> 标签：database, database-design, types, primary-key

我正在制作一个消息传递系统，其中经过身份验证和未经身份验证的用户都应该能够使用。消息的每个索引都应该是唯一的。我正在考虑使用 bigint，但它的限制约为 18446744073709551615（未签名），如果我想记录所有消息，这对我来说并不理想。另外，我正在考虑时间戳，但有可能不止一个用户会同时发布一条消息。因此，创建的时间戳将与其他时间戳发生冲突。

你们知道应该在这里做什么吗？

先感谢您。:D

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T03:19:44.667

严重地？如果每秒发布 100 条消息，BigInt 将为您提供足够的 id，根据我的粗略计算，60 亿年。到那时，您可能可以归档一些消息并重新开始序列。

# android - 集成引出线通知广告

> ID：10730636
> 
> 赞同：1
> 
> 时间：2012-05-24T03:11:19.003
> 
> 标签：android, leadbolt

我在编程方面非常新手。我正在尝试将引线通知广告集成到我的 android 应用程序中。我按照他们的指示并被卡住了。指令是

添加通知服务注册代码：这是通过在 onCreate() 函数中（或您希望触发通知的函数中）添加以下代码来实现的。

```
 AdController myController = new AdController(getApplicationContext(),
    "MY_LEADBOLT_SECTION_ID");
    myController.loadNotification(); 
```

我到底在哪里添加它？我把它放在template.java下吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T05:53:00.293

请在主 Activity java 类的 onCreate() 函数中添加代码。

# java - 有没有办法阻止 Hibernate 破坏 @Where 注释中的布尔文字？

> ID：10730640
> 
> 赞同：7
> 
> 时间：2012-05-24T03:12:19.210
> 
> 标签：java, hibernate, boolean, hsqldb

我想`@Where`在 Hibernate 中使用注释来删除已被该对象上的布尔属性标记为“已删除”的对象。例如，以下内容应防止 Hibernate 加载任何已删除的地址：

```
@OneToMany(mappedBy="contact")
@Where(clause="deleted=FALSE")
private Set<Address> addresses; 
```

但是，当我使用像`deleted=FALSE`then 这样的子句时，Hibernate 会通过在布尔文字前面加上表名来破坏布尔文字，这会导致查询失败。例如：

```
select ... from address address0_ where  ( address0_.deleted=address0_.FALSE)  and address0_.contact_id=? 
```

我所期望的是类似于`(address0_.deleted=FALSE)`而不是`(address0_.deleted=address0_.FALSE)`.

有没有办法指定 @Where 子句或配置 Hibernate 以正确输出布尔值？

* * *

*PS。*请注意，*某些*数据库可以将布尔值指定为字符串文字，如下所示：

```
@Where(clause="deleted='FALSE'") 
```

这将被转换为`(address0_.deleted='FALSE')`在例如 PostgreSQL 中运行良好的。但是我在这个项目中使用 HSQLDB，而 HSQLDB 似乎不支持布尔字符串文字。在 HSQL 上，使用时出现以下异常`deleted='FALSE'`：

`org.hsqldb.HsqlException: data exception: invalid character value for cast`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-24T05:07:08.157

我发现了关于这个问题的错误报告，这些错误报告已经六年多没有解决了！Hibernate 问题跟踪器在该问题上有[HHH-1587](https://hibernate.atlassian.net/browse/HHH-1587)、[HHH-2775](https://hibernate.atlassian.net/browse/HHH-2775)和[ANN-647](https://hibernate.atlassian.net/browse/ANN-647)。

解决方案是创建一个自定义的方言类，它注册`true`,`false`并`unknown`作为关键字（这些是 SQL 规范中的官方布尔文字）。这会导致 Hibernate 将它们识别为关键字，从而停止为它们添加前缀，就好像它们是列一样。

这是我的自定义方言类，它为我解决了这个问题：

```
public class ImprovedHSQLDialect extends HSQLDialect {

    public ImprovedHSQLDialect() {
        super();
        registerKeyword("true");
        registerKeyword("false");
        registerKeyword("unknown");
    }
} 
```

一旦使用此方言，就`@Where(clause="deleted=FALSE")`可以正常工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-24T10:00:36.830

在表定义中将列创建为 BOOLEAN 时，最新的 HSQLDB 支持`WHERE active = TRUE`,`WHERE active = 'TRUE'`以及`WHERE active`.

Hibernate 可能正在创建一个 BIT 列，在这种情况下`WHERE active = TRUE`，`WHERE active = B'1'`或`WHERE active = 1`将起作用。

请为这些功能使用 2.2.8 或更高版本。

# php - 从多维 php 数组中请求日期

> ID：10730641
> 
> 赞同：2
> 
> 时间：2012-05-24T03:12:27.723
> 
> 标签：php, arrays

我有一个这样的数组：

```
$tmb = Array(
             [xThis] => 12400
             [fThat] => 7
             [cMore] => Array(
                    [236] => Array(
                        [acting_person] => "Test info"
                        [tThings] => "history"
                        )
                    )
               )
          ) 
```

我知道如何调用 xThis(like $tmb['xThis'] 但是如何在这样的语句中调用 [acting_person] ？

```
$new = $tmb['xThis'] . $tmb['fThat'] . ?????????????????? 
```

对不起，如果这是基本的，我对 PHP 真的很陌生。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T03:17:14.877

您可以像这样*访问*（而不是“调用”）子数组：

```
$tmb['cMore'][236]['acting_person'] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T03:16:33.980

要访问Acting_person 项，您需要指定所有acting_person 的父键。（当然，理论上你可以在多维数组中有多个 actuator_person 键。）

```
$new = $tmb['xThis'] . $tmb['fThat'] . $tmb['cMore'][236]['acting_person']; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T09:46:28.687

访问数组任何维度的值很简单

```
 $tmb['1st dimension'][2nd dimensin]['3rd dimension'][..][...][..] 
```

更只需提供密钥 [key]

# android - 为什么几乎总是应该通过 onCreateDialog 显示警报对话框

> ID：10730645
> 
> 赞同：0
> 
> 时间：2012-05-24T03:13:05.323
> 
> 标签：android, android-alertdialog

几天前，我问了一个关于警报对话框的问题[AlertDialog 这是一个错误吗？](https://stackoverflow.com/questions/10669948/alertdialog-is-this-a-bug)在问这个问题之前，我浏览了一些关于警报对话框的帖子。在我阅读的所有问题上，都使用 show() 来显示对话框。我不知道提问者是否真的在他们的应用程序上使用了发布的代码。如果是这样，除非活动只是纵向或横向，否则他们应该使用 showDialog(int id) 显示对话框。原因是操作系统只会在使用 showDialog 时为您处理方向更改。这在下面的代码中进行了说明。只需单击按钮，然后旋转您的设备，看看会发生什么。

**布局**

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <Button
        android:id="@+id/with_show_btn"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" 
        android:layout_alignParentBottom="true"
        android:clickable = "true"
        android:text="With Show"
    />

    <Button
        android:id="@+id/no_show_btn"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" 
        android:layout_toRightOf="@id/with_show_btn"
        android:layout_alignParentBottom="true"
        android:clickable = "true"
        android:text="No Show"
    />

    <Button
        android:id="@+id/no_on_create_btn"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" 
        android:layout_toRightOf="@id/no_show_btn"
        android:layout_alignParentBottom="true"
        android:clickable = "true"
        android:text="Not Using onCreateDialog"
    />

</RelativeLayout> 
```

**代码**

```
public class AlertAndShowActivity extends Activity implements OnClickListener
{
    static final int DIALOG_SHOW_ID = 1;
    static final int DIALOG_NO_SHOW_ID = 2;
    static final int DIALOG_NOT_USING_ONCREATEDIALOG_ID = 3;

    @Override
    public void onCreate(Bundle savedInstanceState) 
    {
        super.onCreate(savedInstanceState);

        setContentView(R.layout.main);

        Button showBtn = (Button) findViewById(R.id.with_show_btn);
        showBtn.setOnClickListener(this);

        Button noShowBtn = (Button) findViewById(R.id.no_show_btn);
        noShowBtn.setOnClickListener(this);

        Button notUsingOnCreateDialogBtn = (Button) findViewById(R.id.no_on_create_btn);
        notUsingOnCreateDialogBtn.setOnClickListener(this);
    }

    protected AlertDialog createDialog(final int id)
    {       
        AlertDialog.Builder builder = new AlertDialog.Builder(this);
        builder.setTitle("Dismiss is not enough");

        builder.setPositiveButton("Cancel", new DialogInterface.OnClickListener()
        {

            @Override
            public void onClick(DialogInterface dialog, int which)
            {
                // When dialog is showing through showDialog(int id)
                // and show() is called, then calling cancel will dismiss 
                // the dialog but it will reappear on orientation change.
                // When you run this, chick WithShow and then click Cancel 
                // and rotate your device to see what I mean.
                dialog.cancel();
            }
        });

        builder.setNegativeButton("OK", new DialogInterface.OnClickListener()
        {

            @Override
            public void onClick(DialogInterface dialog, int which)
            {
                // system will automatically call dismiss
                // see also remark for the cancel case above.
            }
        });

        builder.setNeutralButton("Good", new DialogInterface.OnClickListener()
        {
                        @Override
            public void onClick(DialogInterface dialog, int which)
            {
                // This will produce the behavior that one wants when show() 
                // is used in the code. That is the dialog will not reappear
                // on orientation change.
                removeDialog(id);   
            }
        });

        return builder.create();
    }

    protected AlertDialog createDialogWithShow(int id)
    {   
        AlertDialog alertDlg = createDialog(id);
        // Only call show if you want to disable a button.
        // You can only disable a button after calling show(),
        // otherwise you will get null pointer exception.
        alertDlg.show();
        //alertDlg.getButton(DialogInterface.BUTTON_POSITIVE).setEnabled(false);

        return alertDlg;
    }

    @Override
    public void onClick(View v)
    {
        switch (v.getId())
        {
            // notUsingOnCreateDialogBtn 
            case R.id.no_on_create_btn:
                // this will create the dialog and show it on the UI
                // but if one rotates the device it will not be
                // automatically recreated.
                createDialogWithShow(DIALOG_NOT_USING_ONCREATEDIALOG_ID);
                break;

            // withShowBtn
            case R.id.with_show_btn:
                // OS will recreate the dialog on orientation change.
                showDialog(DIALOG_SHOW_ID);
                break;

            case R.id.no_show_btn:
                showDialog(DIALOG_NO_SHOW_ID);
        }
    }

    @Override
    protected Dialog onCreateDialog(int id)
    {
        // no case here for DIALOG_NOT_USING_ONCREATEDIALOG_ID
        // since it is not shown using showDialog
        switch (id)
        {
            case DIALOG_NO_SHOW_ID:
                return createDialog(id);

            case DIALOG_SHOW_ID:
                return createDialogWithShow(DIALOG_SHOW_ID);

            default:
                return super.onCreateDialog(id);
        }       
    }

} 
```

# css - Twitter Bootstrap：当我给 btn-group 一个背景时，额外的 2px 填充？

> ID：10730650
> 
> 赞同：0
> 
> 时间：2012-05-24T03:13:47.540
> 
> 标签：css, twitter-bootstrap

我正在尝试为按钮组（恰好有 4 个元素并且应该填满其容器的宽度）提供渐变边框，但是当我向其添加背景/填充时，它会获得 2 个像素的额外填充。

示例：http: [//jsfiddle.net/wjA2U/](http://jsfiddle.net/wjA2U/)

有什么建议可以解决这个问题吗？我是否必须求助于根本不使用这些课程？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T03:39:07.883

看起来引导程序在每个按钮上放置了 -1 px 的左边距。容器是子元素宽度的总和，因此您需要删除子按钮上的负边距，或者在容器上设置固定宽度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T03:47:53.170

问题出在您的宽度规则中。你已经给出了以 % 为单位的宽度。`Placeholder`宽度为 80%，每个`.btn`宽度为 25%。这不适合您的按钮。

CSS的变化：

```
.btn-group .btn {
    width: 25.2%;
}​ 
```

[工作演示](http://jsfiddle.net/libinvbabu/wjA2U/1/)

**注意：**最好使用固定宽度。

# ajax - 使用 Jquery Ajax 从 Orchard 控制器返回 Json 数据

> ID：10730653
> 
> 赞同：2
> 
> 时间：2012-05-24T03:13:52.200
> 
> 标签：ajax, orchardcms

我一直在尝试让 jquery ajax 函数从果园控制器返回数据，但到目前为止我还没有成功。我在控制器上设置了一个断点，但代码永远不会到达控制器。这是JQuery函数

```
<table id="tblResults" class="tablesorter">
    <thead>
       ...
    </thead>
    <tbody>
        @foreach (dynamic item in Result)
        {
          <tr>...</tr>
                }
    </tbody>
</table> 
<input id="__requesttoken" type="hidden" value="@Html.AntiForgeryTokenValueOrchard()" />

@using (Script.Foot())
{
    <script type="text/javascript">
        //<![CDATA[
        $(function () {
            $("#tblResults").tablesorter();
            setInterval(update, 20000);
        });
        function update() {
            $.ajax({
                type: 'POST',
                url: '@Url.Action("GetResults", "ResultsController", new { area = "Orchard.App" })',
                data: { token: $("#__requesttoken").val() },
                success: function (response) {
                    alert(response);
                },
                error: function () {
                    alert('error');
                }
            });
        }
        //]]>
    </script>
} 
```

对于 ResultsController 我只有这个

```
[OutputCache(Duration = 0)]
public JsonResult GetResults()
{
   var json = DateTime.Now.ToString();
   return Json(json, JsonRequestBehavior.AllowGet);
} 
```

注意：Ajax 调用执行得很好，但是它永远不会达到在“GetResults”设置的断点，并且我看到的 http post url 是“http://localhost:30320/OrchardLocal/”另外，我得到的响应是整个 HTML 页面。提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T04:27:47.650

结果后删除控制器：“结果”，而不是“结果控制器”。此外，您需要在该帖子中包含防伪令牌。哦，setInterval 是邪恶的。

# ruby-on-rails - 找出要安装的 gem

> ID：10730659
> 
> 赞同：0
> 
> 时间：2012-05-24T03:14:38.537
> 
> 标签：ruby-on-rails, rubygems

如何找出需要放入 Gemfile 的 gem？我知道你可以运行 bundle show，但这只会显示下一个要安装的 gem。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T03:20:17.737

您的 gemfile 只是您的软件所依赖的库的列表。运行 bundled 会生成一个 Gemfile.lock，它进一步指定了您安装的每个 gem 的版本。无论您身在何处，无论您的团队有多大，都可以轻松地重新创建您的应用程序环境。

至于放什么，无论你的项目需要什么。一个 rails 项目包括 rails、SQLite、jquery 等。你可以做任何你需要的广告

需要认证吗？设计或 Authlogic 会做。前端工具包？Twitter-bootstrap-rails 会做到这一点。测试？Rspec-rails 或 cucumber-rails 将帮助您

# scala - List[Map[String,A]] 到 scalaquery 中的数据库表

> ID：10730661
> 
> 赞同：1
> 
> 时间：2012-05-24T03:14:52.437
> 
> 标签：scala, collections, relational-algebra, scalaquery, database-table

我昨天刚刚了解了 scalaquery，它似乎很有用。我想将 List[Map[String,A]] （其中 A 是原始类型 - Int、Float、String 等，并且每个映射中的键集相同）转换为数据库表。我在 scalaquery 中找不到动态表创建的示例（列数，即键数是动态的）。

基本上，我有兴趣在这个（和相关的）集合上做一些关系代数。想通 scalaquery 将是要走的路。如果没有，请提出替代方案。

# grails - 保护 Grails 插件控制器

> ID：10730663
> 
> 赞同：0
> 
> 时间：2012-05-24T03:14:54.807
> 
> 标签：grails, spring-security

使用 Grails 2.0.x 和带有默认 @Secured 注释的 spring 安全插件，我如何将它们应用到诸如 Groovy 控制台插件之类的插件中的安全控制器和操作？

鉴于您不能混合使用保护方法（即我不能将注释与 Config.groovy 中的 interceptUrlMap 混合），我能想到的唯一方法是以某种方式对注释进行元编程，但我认为这也行不通？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T03:32:48.390

[请参阅http://grails-plugins.github.com/grails-spring-security-core/docs/manual/](http://grails-plugins.github.com/grails-spring-security-core/docs/manual/)第 5 节中的 controllerAnnotations.staticRules

# php - 为什么 db2_fetch_assoc 不能始终如一地找到结果？MySQL->DB2 转换

> ID：10730679
> 
> 赞同：0
> 
> 时间：2012-05-24T03:16:51.653
> 
> 标签：php, db2

我正在将 PHP 应用程序从 MySQL 转换为 DB2，IBM_DB2 和 MySQL PHP 扩展之间似乎存在一些我无法理解或解决的不同之处。

`db2_fetch_array()``db2_connect()`如果我在包含and的函数之外调用它，似乎无法从记录集中返回一行`db2_exec()`，即使返回的记录集存储为对象属性并且在稍后调用时仍返回资源 ID 号。

谁能看到为什么对`getNextRow()`下面方法的调用无法返回记录集中的下一行？这在 MySQL 中运行良好。

```
class TestClass
{
//Properties
public $result; //Holds the record set returned from a query
public $sql; //Holds the value of the last sql query sent

    function goQuery($sql)
    {
        $this->sql = $sql;

        if($con = db2_connect("MASTER", "DB2USER", "DB2PASSWORD"))
        {
            echo "<li>Connected to master database</li>";   
        }

        if($this->result = db2_exec($con, $sql))
        {
            echo "<li>SQL Query ran successfully</li>"; 
        }

        //Just proving some data can be returned as this point
        $row = db2_fetch_assoc($this->result);
        if(sizeof($row) > 0)
        {
            echo "<li>db2_fetch_assoc returned a record in the resultset (Resource ID: " . $this->result . ") that has " . sizeof($row) . " fields</li>";   
        }

        //Just proving some data can be returned as this point
        $row = $this->getNextRow();
        if(sizeof($row) > 0)
        {
            echo "<li>getNextRow() returned a record in the resultset (Resource ID: " . $this->result . ") the has " . sizeof($row) . " fields</li>";   
        }
    }

    function getNextRow()
    {
        if($row = db2_fetch_assoc($this->result))
        {
            return $row;    
        }
            else
        {
            echo "<li>No results found in " . $this->result . "</li>";  
        }
    }
}

$q = new TestClass();

echo "<h2>Running query TestClass->goQuery()</h2>";
echo "<ul>";
$q->goQuery("SELECT * FROM users");
echo "</ul>";

echo "<h2>Trying to fetch a result using TestClass->getNextRow()</h2>";
echo "<ul>";
$row = $q->getNextRow();
echo "</ul>"; 
```

这当前产生此输出：

```
Running query TestClass->goQuery()

Connected to master database
SQL Query ran successfully
db2_fetch_assoc returned a record in the resultset (Resource ID: Resource id #12) that has 25 fields
getNextRow() returned a record in the resultset (Resource ID: Resource id #12) the has 25 fields
Trying to fetch a result using TestClass->getNextRow()

No results found in Resource id #12 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T02:12:40.820

我能够通过使用持久连接来解决：

```
$con = db2_pconnect("MASTER", "USER", "PASSWORD") 
```

看起来 DB2 连接和所有返回的资源在调用它们的函数结束时停止存在 - 除非使用持久连接。

这是 DB2 独有的，因为我发现在 MySQL 中实现这一点不需要持久连接。

# c++ - std::function 的复制构造函数是否要求模板类型的参数类型是完整类型？

> ID：10730682
> 
> 赞同：6
> 
> 时间：2012-05-24T03:17:22.123
> 
> 标签：c++, boost, c++11, tr1

鉴于：

```
#include <functional>
class world_building_gun;
class tile_bounding_box;
typedef std::function<void (world_building_gun, tile_bounding_box)> worldgen_function_t;
void foo() {
    worldgen_function_t v;
    worldgen_function_t w(v);
} 
```

这应该编译吗？我的编译器说：

是：GCC/stdlibc++（在 GCC 和 Clang 中 boost::function 也是是的）

否：Clang/libc++ ( [http://libcxx.llvm.org/](http://libcxx.llvm.org/) , Clang 3.0, libc++ SVN 截至今天)

（如果“否”是正确答案，我将修复我的真实代码以将完整类型放入更多标题或使用 boost::function。）

编辑：这是 Clang 错误消息：

```
In file included from foo.cpp:2:
In file included from /usr/include/c++/v1/functional:462:
/usr/include/c++/v1/type_traits:2766:19: error: invalid appli
    static_assert(sizeof(_Tp) > 0, "Type must be complete.");
                  ^~~~~~~~~~~
/usr/include/c++/v1/type_traits:2752:15: note: in instantiation of template class 'std::__1::__check_complete<world_buildin
    : private __check_complete<_Hp>,
              ^
/usr/include/c++/v1/type_traits:2753:15: note: in instantiation of template class 'std::__1::__check_complete<world_buildin
      private __check_complete<_T0, _Tp...>
              ^
/usr/include/c++/v1/type_traits:2919:15: note: in instantiation of template class 'std::__1::__check_complete<std::__1::fun
      world_building_gun, tile_bounding_box>' requested here
    : private __check_complete<_Fp, _Args...>
              ^
/usr/include/c++/v1/type_traits:2930:11: note: in instantiation of template class 'std::__1::__invokable_imp<std::__1::func
      world_building_gun, tile_bounding_box>' requested here
          __invokable_imp<_Fp, _Args...>::value>
          ^
/usr/include/c++/v1/functional:1115:33: note: in instantiation of template class 'std::__1::__invokable<std::__1::function<
      world_building_gun, tile_bounding_box>' requested here
    template <class _Fp, bool = __invokable<_Fp&, _ArgTypes...>::value>
                                ^
/usr/include/c++/v1/functional:1141:35: note: in instantiation of default argument for '__callable<std::__1::function<void (world_building_gun, tile_bounding_box)> >' required here
              typename enable_if<__callable<_Fp>::value>::type* = 0);
                                  ^~~~~~~~~~~~~~~
/usr/include/c++/v1/functional:1140:7: note: while substituting deduced template arguments into function template 'function' [with _Fp = std::__1::function<void
      (world_building_gun, tile_bounding_box)>]
      function(_Fp,
      ^
foo.cpp:4:7: note: forward declaration of 'world_building_gun'
class world_building_gun;
      ^
In file included from foo.cpp:2:
In file included from /usr/include/c++/v1/functional:462:
/usr/include/c++/v1/type_traits:2766:19: error: invalid application of 'sizeof' to an incomplete type 'tile_bounding_box'
    static_assert(sizeof(_Tp) > 0, "Type must be complete.");
                  ^~~~~~~~~~~
/usr/include/c++/v1/type_traits:2753:15: note: in instantiation of template class 'std::__1::__check_complete<tile_bounding_box>' requested here
      private __check_complete<_T0, _Tp...>
              ^
/usr/include/c++/v1/type_traits:2753:15: note: in instantiation of template class 'std::__1::__check_complete<world_building_gun, tile_bounding_box>' requested here
      private __check_complete<_T0, _Tp...>
              ^
/usr/include/c++/v1/type_traits:2919:15: note: in instantiation of template class 'std::__1::__check_complete<std::__1::function<void (world_building_gun, tile_bounding_box)> &,
      world_building_gun, tile_bounding_box>' requested here
    : private __check_complete<_Fp, _Args...>
              ^
/usr/include/c++/v1/type_traits:2930:11: note: in instantiation of template class 'std::__1::__invokable_imp<std::__1::function<void (world_building_gun, tile_bounding_box)> &,
      world_building_gun, tile_bounding_box>' requested here
          __invokable_imp<_Fp, _Args...>::value>
          ^
/usr/include/c++/v1/functional:1115:33: note: in instantiation of template class 'std::__1::__invokable<std::__1::function<void (world_building_gun, tile_bounding_box)> &,
      world_building_gun, tile_bounding_box>' requested here
    template <class _Fp, bool = __invokable<_Fp&, _ArgTypes...>::value>
                                ^
/usr/include/c++/v1/functional:1141:35: note: in instantiation of default argument for '__callable<std::__1::function<void (world_building_gun, tile_bounding_box)> >' required here
              typename enable_if<__callable<_Fp>::value>::type* = 0);
                                  ^~~~~~~~~~~~~~~
/usr/include/c++/v1/functional:1140:7: note: while substituting deduced template arguments into function template 'function' [with _Fp = std::__1::function<void
      (world_building_gun, tile_bounding_box)>]
      function(_Fp,
      ^
foo.cpp:5:7: note: forward declaration of 'tile_bounding_box'
class tile_bounding_box;
      ^
2 errors generated. 
```

如果我删除“worldgen_function_t w(v);”行，Clang+libc++ 编译成功 或者如果我让课程完成类型。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T05:45:30.007

**编辑：** [显然](https://stackoverflow.com/a/11508479/500104)，这个问题现在已经解决了，所以下面的文字可以看作是历史。:)

* * *

这个问题确实（正如我所预测的那样）是 libc++ 在模板化 ctor 中的 SFINAE 检查（为了推理，请检查[这个问题](https://stackoverflow.com/q/5931214/500104)）。它检查以下（例如）是否有效，并在*施工*现场而不是在内部深处给出一个漂亮而干净的错误（尝试使用[libstd++](http://ideone.com/JwfFT)或 MSVC`std::function`的以下示例......*不寒而栗*）：

 *```
#include <functional>

void f(int* p){}

int main(){
  std::function<void(int)> fun(f);
} 
```

libc++ 将导致编译器按照“没有找到与参数列表匹配的构造函数”的行吐出一些东西`void (*)(int*)`，因为唯一适用的（模板化的 ctor）会被 SFINAE 淘汰。

但是，为了使`__callable`and`__invoke_imp`检查起作用，参数和返回类型需要完整，否则此处不会考虑隐式转换。

甚至查看模板化 ctor 的原因是在考虑最佳匹配之前枚举了所有 ctor（在本例中为复制 ctor）。

* * *

`std::function`现在，标准非常明确，从可调用对象（也就是调用模板化 ctor）构造对象时，参数和返回类型需要完整：

`§20.8.11.2.1 [func.wrap.func.con] p7`

```
template <class F> function(F f);
template <class F, class A> function(allocator_arg_t, const A& a, F f); 
```

> *要求：* `F`应`CopyConstructible`。对于参数类型和返回类型**`f`应为 Callable** (20.8.11.2) 。[...]`ArgTypes``R`

（注意：“要求”针对的是功能的*用户*，而不是实现者。）

`§20.8.11.2 [func.wrap.func] p2`

> 如果表达式被视为未计算的操作数（第 5 条），**格式**正确（20.8.2） ，则`f`类型的可*调用*对象对于参数类型和返回类型`F`都是可调用的。*`ArgTypes``R`*`INVOKE`*`(f, declval<ArgTypes>()..., R)`*

 ***`§20.8.2 [func.req]`

> p1 定义如下：*`INVOKE`*`(f, t1, t2, ..., tN)`
> 
> *   `(t1.*f)(t2, ..., tN)`when`f`是指向类的成员函数的指针，`T`并且`t1`是类型对象`T`或对类型对象的`T`引用或对派生于的类型对象的引用`T`；
> *   `((*t1).*f)(t2, ..., tN)`when`f`是指向类的成员函数的指针，`T`并且`t1`不是上一项中描述的类型之一；
> *   [...]
> *   `f(t1, t2, ..., tN)`在所有其他情况下。
> 
> p2 定义为隐式转换为.*`INVOKE`*`(f, t1, t2, ..., tN, R)`*`INVOKE`*`(f, t1, t2, ..., tN)``R`

因此，libc++ 当然有权在模板化 ctor 中进行 SFINAE 检查，因为类型需要完整，否则您将获得未定义的行为。但是，即使从不需要实际的 SFINAE 检查（因为总是会调用复制 ctor），完整类型的安全检查也会触发，这可能有点不幸，并且被认为是一个缺陷。这可以通过使`callable`检查变得懒惰来缓解，例如

```
template<bool Copy, class F>
struct lazy_callable{
  static bool const value = callable<F>::value;
};

template<class F>
struct lazy_callable<true, F>{
  static bool const value = false;
};

template<class F>
function(F f, typename enable_if<lazy_callable<!std::is_same<F,function>::value>::type* = 0); 
```

这应该只触发`callable`SFINAE 检查是否`F`实际上不是`std::function<...>`。

伙计，最后我*可能*跑题了...

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-16T16:25:31.843

我已经提交了对 libc++ 的修复，以便这个示例现在可以编译，提交修订版 160285。

I believe libc++ was being overly aggressive in checking the argument list for complete types.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-24T06:06:15.277

我会说不。从 20.8.11.2 类模板函数 [func.wrap.func] 开始，我们有：

> 3`function`类模板是一个调用包装器 (20.8.1)，其调用签名 (20.8.1) 为`R(ArgTypes...)`.

在 20.8.1 定义 [func.def] 中，我们得到以下关于什么构成调用包装器类型、调用包装器和调用签名的定义：

> 2 调用签名是返回类型的名称，后跟用括号括起来的逗号分隔的零个或多个参数类型列表。
> 
> 5 调用包装器类型是一种保存可调用对象并支持转发到该对象的调用操作的类型。
> 
> 6 调用包装器是调用包装器类型的对象。

注意第 2 段没有提到类型的完整性。

简而言之（涉及很多定义），这里的“可调用对象”的含义是指函子（熟悉的概念，即可以像函数一样使用的东西）或指向成员的指针。此外，该标准还在20.8.11.2 第 2 段中描述了*Callable概念：*

> 如果表达式*INVOKE*被视为未计算的操作数（第 5 条），格式正确（20.8.2），则`f`类型的可*调用*对象对于参数类型和返回类型`F`都是可调用的。*`ArgTypes``R`*`(f, declval<ArgTypes>()..., R)`**

 **（*INVOKE*位是一个虚构的函数，标准使用它来定义函数和指向成员的指针是如何被调用的。）

我认为最重要的结论是以下要求：

*   给定一个可调用的对象，它是*Callable* with signature `R(A...)`，然后`R`和`A...`是完整的（或可能`R`是`void`）凭借*INVOKE*表达式（即否则它不会是格式良好的，请注意使用`declval<ArgTypes>()...`）

我的论点现在依赖于调用包装器定义中的“[the] call operation that forwards to that object”，我认为它是故意含糊不清的，以免过度限制。在`std::function<Sig>`涉及一些不完整类型的情况下，`Sig`我们可以将此操作定义为“首先完成类型，*然后*将`std::function<Sig>`其视为调用签名的可调用对象类型`Sig`”。

鉴于此，以下是我论证的要点：

*   `std::function`未被描述为可调用对象或*可调用*任何签名
*   调用 an`std::function`是根据 INVOKE 完成的*（* 20.8.11.2.4 函数调用 [func.wrap.func.inv]）
*   `std::function`从可调用对象构造一个可调用对象的*调用*签名为`std::function`（20.8.11.2.1 函数构造/复制/销毁 [func.wrap.func.con] 第 7 段）
*   根据*Callable*调用`target`成员，调用签名为(20.8.11.2.5 function target access [func.wrap.func.targ])`std::function`*`std::function`*
**   的所有其他操作`std::function`都没有根据 callable object(*) 、*Callable*、*INVOKE*进行描述，或者以其他方式要求 的调用签名`std::function`涉及完整类型*

 *`f`(*) 除非一个构造函数的描述包含“如果的目标是通过传递的可调用对象`reference_wrapper`或函数指针，则不应抛出异常”。我认为在上下文中很明显这不会影响论点。对于它的价值，这个构造函数不涉及 OP 的片段。

所以我想说，除非你确实使用了间接要求签名涉及完整类型的那些操作之一，否则你很高兴。

* * *

分析标准规定的内容很好，但考虑标准的*意图*也很重要。`std::function`在这种情况下，我认为不需要调用签名的类型是完整的，这是非常可取和预期的。考虑以下：

```
// in a_fwd.hpp
struct incomplete;
using callback_type = std::function<void(incomplete)>;
callback_type make_callback();

// in b.hpp; depends on a_fwd.hpp
#include "a_fwd.hpp"
void eat_callback(callback_type); 
```

然后不要求不相关的TU，我们称它为C，即B的客户端可以这样做：

```
// in c.cpp
#include "b.hpp"

// somewhere in e.g. a function body
eat_callback(make_callback()); 
```

这是类型安全的，并且最小化了耦合，因为只有翻译单元 B 需要知道翻译单元 A 的细节。

此外，Boost.Function 和 libstdc++ 都证明了`std::function`无需这样的要求也可以实现。*******

# r - 可以使用 read.zoo() 从 R 中的 html 读取未索引的时间序列吗？

> ID：10730685
> 
> 赞同：1
> 
> 时间：2012-05-24T03:17:56.413
> 
> 标签：r, time-series, zoo

我正在寻找一个像这里包含的数据系列：

[http://robjhyndman.com/tsdldata/roberts/beards.dat](http://robjhyndman.com/tsdldata/roberts/beards.dat)

...并将其加载到 R 中的动物园时间序列对象中。没有日期信息表，但它列出了它是常规的、年度的，并且从 y=1866 开始。这就是我正在尝试的...

```
beard <- read.zoo('http://robjhyndman.com/tsdldata/roberts/beards.dat', 
header=FALSE, 
index.column=0,
start="1866-01-01",
format="%Y", 
skip=4) 
```

它主要工作，但忽略了 zooreg 的“开始”参数。

所以，我有一个很好的解决方案来读取这个，然后像这样更改索引......

```
index(beard) <- as.Date(paste(seq(1866,1911, by=1),'-01-01',sep=''), format="%Y-%m-%d") 
```

...但是如果有一个论点`read.zoo()`让我在一个电话中做到这一点，这将更加巧妙。我错过了它，还是一个两步问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-24T03:38:32.097

像这样指定一个自定义`FUN=`：

```
URL <- 'http://robjhyndman.com/tsdldata/roberts/beards.dat'
toDate <- function(x) as.Date(as.yearmon(x) + 1865)
beard <- read.zoo(URL, index = 0, skip = 4, FUN = toDate) 
```

# algebra - 代数到 JavaScript

> ID：10730688
> 
> 赞同：-1
> 
> 时间：2012-05-24T03:18:20.437
> 
> 标签：algebra, javascript

我是 JavaScript 新手，需要将我的代数表达式转换为 JavaScript 函数，只是一个函数。我正在自学 JavaScript。

这是我的表情...我无法发布图片，所以必须这样做，对不起！

```
30* ( a*b - pi * ( ( C/2 ) ^2 ) ) + 20 * pi ( ( C/2 ) ^2 ) 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T03:20:19.547

```
function blah(a,b,C) {
    return 30* ( a*b - Math.PI * ( ( C/2 ) * ( C/2 )) ) + 20 * Math.PI ( ( C/2 ) * ( C/2 ) );
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-24T03:35:46.560

我们可以将计算简化为：

```
var exp = function (a, b, c) {
    var x1 = Math.PI * Math.pow(c/2, 2);
    return 30 * (a * b - x1) + 20 * x1;
}; 
```

您可以像这样调用函数：

```
exp(2, 1, 0); 
```

# c# - JSON 对象中“count”属性的返回值

> ID：10730691
> 
> 赞同：0
> 
> 时间：2012-05-24T03:19:15.960
> 
> 标签：c#, vb.net, facebook-graph-api

我有一个来自 facebook api 的 json 对象

```
"comments": {
        "count": 2
     },
 "updated_time": "2012-05-24T02:46:36+0000" 
```

整个 json 对象是一个动态对象。

我可以通过以下方式轻松读取 updated_time 的值：

```
 post.updated_time 
```

但是，这会返回集合中项目的计数，而不是 json 对象中“count”属性的值。

```
 post.comments.count 
```

是否可以在没有使用“count”关键字的情况下获取 post.comments.count 的值？

我应该注意到 JSON 比这大得多。如果确实有评论，则会有另一个实际评论的集合，因此 post.count(0) 之类的东西在这种情况下不起作用。

![观察窗口](../Images/bdf81280b0ecea0c535e6893a0cb0dae.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T12:01:25.300

~~我猜`count`是 C# 中的保留字。~~

`count`在 C# 中不保留。但你仍然可以，

尝试这个，

```
post.comments.@count 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T03:28:34.413

如果您尝试获取问题中 JSON 示例的 count 属性的值，则必须像这样访问它：

```
post.comments.count 
```

由于“count”属性是作为“comments”属性值的对象的一部分

访问对象的另一种方法是：

```
post["comments"]["count"] 
```

但我认为第一个更具可读性（第二个在某些情况下可能有用）

# messagebroker - 如何将字符串转换为blob？在 ESQL 中？

> ID：10730693
> 
> 赞同：2
> 
> 时间：2012-05-24T03:19:39.283
> 
> 标签：messagebroker, ibm-integration-bus, extended-sql

所以我正在从流的请求注释中读取一个 XML 文件。并且需要将 XML 数据转换为 blob。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T14:30:46.993

尝试这样的事情：

```
CAST( MYLITTLESTRING AS BLOB CCSID InputRoot.Properties.CodedCharSetId) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-02T03:54:03.133

如果您从基于 ASCII 和 EBCDIC 的平台接收消息，您应该包括一个 CCSID，通常基于入站消息 CodedCharSetId。

```
DECLARE StaticValueBlob BLOB CAST('StaticValue' AS BLOB CCSID InputRoot.Properties.CodedCharSetId); 
```

如果您希望将整个 XML 文档作为 BLOB 获取，那么您将需要改用 ResetContentDescriptor 节点。

# objective-c - newlineCharacterSet 返回 5 行而不是 3

> ID：10730695
> 
> 赞同：1
> 
> 时间：2012-05-24T03:19:51.500
> 
> 标签：objective-c, ios

我下载了一个包含 3 行的文件，其中包含 3 行，但我的数组似乎每组都跳过一行。在我的数组中，有形的结果出现在位置：0、2 和 4，而不是位置 0、1 和 2。

另外，这会在几秒钟后超时吗？我只看到一个间隔，是超时吗？

```
 NSTimeInterval timeStamp = [[NSDate date] timeIntervalSince1970];
        NSNumber *timeStampObj = [NSNumber numberWithDouble: timeStamp];
        NSURL* url = [NSURL URLWithString:[NSString stringWithFormat:@"http://192.168.1.30/ios/info.php?a=APP1&s=%i",timeStampObj]];
        NSURLRequest* request = [NSURLRequest requestWithURL:url cachePolicy:0 timeoutInterval:5];
        NSURLResponse* response=nil;
        NSError* error=nil;
        NSData* data=[NSURLConnection sendSynchronousRequest:request returningResponse:&response error:&error];
        NSString* fileContents = [[[NSString alloc] initWithData:data encoding:NSUTF8StringEncoding] autorelease];
        if ([fileContents length] == 0) return;

        NSArray* allLinedStrings = [fileContents componentsSeparatedByCharactersInSet:[NSCharacterSet newlineCharacterSet]];

        if ([allLinedStrings count] == 0) {

        } else {
            NSString* Title = [allLinedStrings objectAtIndex:0];
            NSString* Description = [allLinedStrings objectAtIndex:2];
            NSString* Url = [allLinedStrings objectAtIndex:4];

        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T05:48:49.180

如果文件被“\r\n”可靠地分隔，那么`-componentsSeparatedByString:`应该适合你。

```
 NSArray* allLinedStrings = [fileContents componentsSeparatedByString:@"\r\n"]; 
```

# css - Firefox browser.xul chrome：在工具栏和 HTML 内容之间添加了灰线

> ID：10730699
> 
> 赞同：1
> 
> 时间：2012-05-24T03:20:30.890
> 
> 标签：css, firefox, xul, user-customization

很长一段时间以来，我一直被 Firefox 在浏览器工具栏和 HTML 内容区域之间插入的 1 像素水平灰线所困扰（如果我没记错的话，是最新版本和自 4 以来的几乎所有版本），所以我我最近开始深入研究`browser.xul`chrome 文件并尝试使用`userChrome.css`. 但是，我一直无法正确定位或修改它。它似乎没有完全遵守 CSS 样式的规则，好像（我猜）它被硬编码在浏览器的某个地方，而不是可定制布局的一部分。

这是标准操作期间显示线条的屏幕截图（注意：为了清楚起见，我在此处使用“黑色马赛克”外观，但该线条以任何外观呈现，包括默认外观，并且不是当前页面 HTML 的一部分） .

![火狐灰线](../Images/548cabccd7a70c578bab590064696fea.png)

现在这是使用以下 CSS 的外观`userChrome.css`：

```
toolbox#navigator-toolbox {
    border: 2px solid red !important;
    padding: 12px !important;
}
toolbox#navigator-toolbox > * {
    border: 1px dashed #b0d0f0 !important;
    margin: 4px;
} 
```

![修改后的火狐浏览器](../Images/5b976da24606ac51f63566599e468d25.png)

灰线响应 的 12 像素填充`#navigator-toolbox`，但它没有获得自己的边框作为 的子元素`#navigator-toolbox`。如果我尝试像这样隐藏所有子元素，我会得到以下结果：

```
toolbox#navigator-toolbox {
    border: 2px solid red !important;
    padding: 12px !important;
}
toolbox#navigator-toolbox > * {
    display: none !important;
} 
```

![隐藏的 Firefox 工具栏镶边](../Images/3cb4ed801e2bd27c3169cffb78d485b0.png)

我还尝试检查它是否是工具栏附近涉及的其他元素的背景颜色或边框颜色，并且我也尝试设置所有`<hr>`元素的样式（它似乎也不是其中之一）。我是在做完全错误的事情并在这里调查错误的小巷，还是这是 Firefox 的错误/已知奇怪行为？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T05:50:25.403

这是一个棘手的问题，即使使用[DOM Inspector](https://addons.mozilla.org/addon/dom-inspector-6622/)我也很难弄清楚这条线的来源。但是，如果我将工具箱元素的 ID 更改为不同的 ID 并添加`style="-moz-appearance: none"`（此样式通常应用于导航器工具箱），则该行消失了 - 所以它必须是某种应用于`#navigator-toolbox`. 然后我直接看了一下`browser.css`，马上就找到[了问题的根源](http://hg.mozilla.org/mozilla-central/file/f43e8d300f21/browser/themes/winstripe/browser.css#l48)：

```
#navigator-toolbox::after {
  content: "";
  display: -moz-box;
  -moz-box-ordinal-group: 101; /* tabs toolbar is 100 */
  height: 1px;
  background-color: ThreeDShadow;
} 
```

所以 - 是的，这不是工具箱的子元素，它是一个伪元素（因此在 DOM Inspector 中不可见）。像这样的用户样式应该删除该行：

```
#navigator-toolbox::after {
  display: none !important;
} 
```

如果关闭“顶部选项卡”，默认主题已经应用此样式。

# java - 编辑代码时如何告诉 Eclipse 实时更新 Jetty 代码

> ID：10730701
> 
> 赞同：0
> 
> 时间：2012-05-24T03:20:41.797
> 
> 标签：java, eclipse, jetty

当我在 Eclipse 中使用 Tomcat 并让我的 Web 应用程序通过 Eclipse 运行时，对 Java 类或 JSP 页面的任何更改似乎都会直接推送到 tomcat 中，而无需重新启动 tomcat 或应用程序。

有没有办法在 Eclipse 下配置 Jetty 以使其工作方式相同？到目前为止，我似乎所能做的就是更改代码，然后手动重新启动码头。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T04:09:28.950

配置 jetty.xml 以使用启用“热部署”的 ContextDeployer。这可能已经默认配置。本质上，Jetty 会以预定的时间间隔扫描 contexts 文件夹。如果它检测到 WAR 文件或 war 目录已更改，则它会自动重新加载上下文。

在下面的示例中，${jetty.home}/contexts 文件夹被配置为查找上下文 XML 文件，这些文件告诉 Jetty 要监控哪些 Web 应用程序。scanInterval 设置为 5 毫秒，这意味着 Jetty 每 5 毫秒检查一次更改。您将在 jetty.xml 中找到此配置：

```
<!-- =========================================================== -->
<!-- Configure the context deployer                              -->
<!-- A context deployer will deploy contexts described in        -->
<!-- configuration files discovered in a directory.              -->
<!-- The configuration directory can be scanned for hot          -->
<!-- deployments at the configured scanInterval.                 -->
<!--                                                             -->
<!-- This deployer is configured to deploy contexts configured   -->
<!-- in the $JETTY_HOME/contexts directory                       -->
<!--                                                             -->
<!-- =========================================================== -->
<Call name="addLifeCycle">
  <Arg>
    <New class="org.mortbay.jetty.deployer.ContextDeployer">
      <!-- the ContextHandlerCollection to modify once a webapp is added or removed (Allows Hot Deployment) -->
      <Set name="contexts"><Ref id="Contexts"/></Set>

      <!-- the directory which will contain your context.xml files -->
      <Set name="configurationDir"><SystemProperty name="jetty.home" default="."/>/contexts</Set>

      <!-- the interval in milliseconds to periodically scan the configurationDir -->
      <Set name="scanInterval">5</Set>
    </New>
  </Arg>
</Call> 
```

您还需要创建一个 WebAppContext 条目。将它放在一个名为 test.xml 的文件中，并将该文件放在 /contexts 目录中：

```
<?xml version="1.0"  encoding="ISO-8859-1"?>
<!DOCTYPE Configure PUBLIC "-//Mort Bay Consulting//DTD Configure//EN" "http://jetty.mortbay.org/configure.dtd">
<Configure class="org.mortbay.jetty.webapp.WebAppContext">
  <Set name="contextPath">/test</Set>
  <Set name="war"><SystemProperty name="jetty.home" default="."/>/webapps/test</Set>
</Configure> 
```

请注意，`<Set name="war">`指的是实际文件夹，*而不是 WAR 文件。*此文件夹应包含应用程序的根目录，例如 /WEB-INF 文件夹和所有其他文件。

如果您希望立即识别 JSP 和其他页面，则需要将 webapps 文件夹中的 Web 应用程序配置为从展开的 WAR 而非 WAR 文件本身运行。之后，您需要将 Eclipse 指向该位置，这样您就可以直接从 webapps/test 文件夹修改和编译文件。

总之，您并不清楚您正在运行哪个版本的 Jetty。然而，虽然不同版本的 Jetty 配置可能会有很大差异，但这应该可以帮助您入门。有关 Jetty 配置和故障排除的更多文档，请参阅[Jetty 网站](http://docs.codehaus.org/display/JETTY/Walkthrough+jetty.xml)或[Webtide 网站](https://www.webtide.com/)。

一旦一切配置正确，您就可以直接从该文件夹修改和编译代码，而无需重新启动 Jetty。

该规则的唯一例外是修改 web.xml 的情况。如果您修改 web.xml，您很可能需要重新启动 Jetty。

最后要注意的是，请确保不要在 webapps 文件夹中部署任何名为 test.war 的 WAR 文件，除非您首先禁用了 WAR 文件的爆炸。您最终可能会覆盖您的代码！

如果您需要更多指导，您可能会发现[ContextDeployers 上的 Jetty 文档](http://docs.codehaus.org/display/JETTY/ContextDeployer)以及[Deploying a Webapp to Jetty](http://www.enavigo.com/2008/08/29/deploying-a-web-application-to-jetty/)很有帮助。祝你好运！

# android - Galaxy Note 分辨率

> ID：10730702
> 
> 赞同：0
> 
> 时间：2012-05-24T03:20:45.103
> 
> 标签：android, resolution, galaxy

我说的是设备分辨率而不是屏幕尺寸。

我看到了很多以前的问题的答案，比如 320 x480，我认为这是屏幕尺寸。如果我错了，请纠正我。

例如，三星 Galaxy Note 分辨率为 1280 x 800 像素。

我如何在java编程中获得这个值？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T03:26:19.123

尝试这个

```
Display display = getWindowManager().getDefaultDisplay(); 
            int width = display.getWidth();  // deprecated
            int height = display.getHeight();  // deprecated
            Log.d("hai",width+"");
            Log.d("hai",height+"");
            DisplayMetrics dm = new DisplayMetrics();
            getWindowManager().getDefaultDisplay().getMetrics(dm);
            double x = Math.pow(width/dm.xdpi,2);
            double y = Math.pow(height/dm.ydpi,2);
            double screenInches = Math.sqrt(x+y);
            Log.d("hai","Screen inches : " + screenInches+""); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T03:24:31.917

800x1280px 是根据[http://www.phonegg.com/compare/27/Samsung-I9100-Galaxy-S-II-vs-Samsung-Galaxy-Note.html的分辨率](http://www.phonegg.com/compare/27/Samsung-I9100-Galaxy-S-II-vs-Samsung-Galaxy-Note.html)

这个问题应该告诉您如何获得解决方案。 [以像素为单位获取屏幕尺寸](https://stackoverflow.com/questions/1016896/android-how-to-get-screen-dimensions)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T04:03:53.400

使用这个简单的代码来获得分辨率。

```
Display display = getWindowManager().getDefaultDisplay(); 
        int  width = display.getWidth();
        int height= display.getHeight();
        TextView w=(TextView)findViewById(R.id.textView2);
        w.setText(""+width);
        TextView h=(TextView)findViewById(R.id.textView4);
        h.setText(""+height); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-24T04:48:17.087

试试[这个](http://android-er.blogspot.com/2009/08/exercise-get-screen-resolution-using.html)例子，了解如何获取有关设备显示的信息。

# c# - 会话变量是否在不同浏览器之间共享？

> ID：10730707
> 
> 赞同：2
> 
> 时间：2012-05-24T03:21:54.310
> 
> 标签：c#, asp.net, vb.net, visual-studio

会话变量是否在不同浏览器之间共享？如果没有，我可以在浏览器之间共享信息，类似于缓存的功能，但范围更广。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T03:27:15.620

这取决于您的会话实现所支持的内容。默认情况下，会话对于一个浏览器来说是唯一的，因为它是由您的浏览器发出的会话 cookie 标识的。只有发出 cookie 的浏览器会话才能识别服务器上的会话。

还有其他不基于会话 cookie（url、sql server 支持）的实现，它们允许您跨浏览器共享

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T03:27:22.510

不。会话变量与会话标识符相关联，该标识符仅由启动会话的浏览器实例知道（或者在最近的 IE 版本更复杂的情况下，由底层引擎知道，但它仍然是所有 IE）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T03:30:49.990

会话特定于用户的会话 ID（通常存储在名为 的 cookie 中`ASP.NET_SessionID`），在多个浏览器中不会相同（除非[出现问题](http://en.wikipedia.org/wiki/Session_hijacking)）。

要跨多个浏览器持久保存数据，您将不得不以某种其他格式（可能是数据库）将数据存储在服务器端。如果数据需要特定于某些个人，您可能需要设置身份验证方案以正确地将数据限制为适当的用户。

# perl - 哪个 Perl ssh 模块支持 kerberos 身份验证？

> ID：10730708
> 
> 赞同：4
> 
> 时间：2012-05-24T03:21:55.800
> 
> 标签：perl, ssh, kerberos, gssapi

我的 Linux 服务器组使用 Kerberos 身份验证。当我尝试使用[Net::SSH2](http://p3rl.org/Net%3a%3aSSH2)连接到其中一台服务器时，[`auth_list()`](https://metacpan.org/module/Net%3a%3aSSH2#auth_list-username-)返回`gssapi-keyex`和`gssapi-with-mic`. 但是，[`auth()`](https://metacpan.org/module/Net%3a%3aSSH2#auth-...-)也不支持。

是否有一个 Perl 模块天真地（例如，不使用 Expect.pm）支持通过 SSH 的[GSSAPI身份验证？](http://en.wikipedia.org/wiki/GSSAPI)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T03:38:40.393

也许给这个模块一个镜头？

[http://metacpan.org/pod/LWP::Authen::Negotiate](http://metacpan.org/pod/LWP::Authen::Negotiate)

或者可能还有这个......

[http://metacpan.org/pod/Authen::Simple::Kerberos](http://metacpan.org/pod/Authen::Simple::Kerberos)

# php - 具有相同 URL 的自定义 404 错误页面

> ID：10730711
> 
> 赞同：3
> 
> 时间：2012-05-24T03:22:14.583
> 
> 标签：php, http, error-code

如何在 404 请求上启用自定义 404 页面，同时在地址栏中保留相同的 URL，而不是看起来像`http://yourwebsite.com/error.html`.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T03:26:24.087

只需将以下行添加到您的 Web 根目录中的 htaccess 文件中：

```
ErrorDocument 404 /404page.html 
```

然后 make`404page.html`包含您希望向用户显示的任何文本。

# csv - 以 CSV 格式下载未发布的 Google 电子表格

> ID：10730712
> 
> 赞同：21
> 
> 时间：2012-05-24T03:22:33.370
> 
> 标签：csv, google-sheets

我有一个尚未公开的 Google 电子表格，但任何拥有访问链接的人都可以使用。虽然即使我没有登录我的 Google 帐户（即允许匿名访问），我也可以从浏览器访问 CSV 格式的数据，但我无法使用 wget 从命令行下载数据，例如. 我找到了几个网页，其中包含一些创建下载 URL 的说明，但到目前为止我还没有成功。有没有一种简单、直接的方法可以做到这一点，还是我必须使用一些谷歌数据库来访问这些数据？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-06-02T05:50:41.173

也许我没有正确理解你想要做什么，但我[在这篇文章](http://softwarebuzzer.com/how-to-download-shared-google-documents-spreadsheets/)中找到了一个对我来说很好的解决方案。

在文章中，作者将电子表格的下载链接创建为 XLS 文件（使用“&output=xls”），但我尝试了“&output=csv”并成功下载了正确的 CSV 文件。

这是我的“下载测试电子表格”的下载链接，按照文章作者建议的方式构建，但用“csv”代替了“xls”：

[https://docs.google.com/spreadsheet/ccc?key=0At2sqNEgxTf3dEt5SXBTemZZM1gzQy1vLVFNRnludHc&output=csv](https://docs.google.com/spreadsheet/ccc?key=0At2sqNEgxTf3dEt5SXBTemZZM1gzQy1vLVFNRnludHc&output=csv)

该链接是匿名的（即“任何拥有该链接的人都可以查看”），我下载它时没有登录我的 Google 帐户。我承认我没有使用 wget 来做到这一点（我只是使用了浏览器——我没有安装 wget），但我想不出 wget 不能正常工作的原因。

实际上，我只是抓取了一份 wget 并尝试了它，它也正确下载了文件：

```
% wget --no-check-certificate --output-document=test.csv 'https://docs.google.com/spreadsheet/ccc?key=0At2sqNEgxTf3dEt5SXBTemZZM1gzQy1vLVFNRnludHc&output=csv'

< bla bla bla, reams of output from wget >

% cat test.csv
Foo,Bar,Baz
1,2,3
4,5,6 
```

所以你去...

* * *

**2018 年更新**

正如@AndyMortimer 评论的那样，新的*下载 URL* 是可以从*导航的 URL*获得的
  `https://docs.google.com/spreadsheets/d/<KEY>/export?gid=<GID>&format=csv`
位置`<KEY>`，`<GID>` *`https://docs.google.com/spreadsheets/d/<KEY>/edit#gid=<GID>`*

 *PS：电子表格可能有多个工作簿，*GID*是所需的工作簿 ID。一个工作簿电子表格通常具有`gid=0`，但如果您添加更多，它们将具有随机数（即使更改制表符顺序也会保留*GID ）。*

因此，使用`wget`相同的电子表格，

```
 wget --no-check-certificate -O test.csv \
    'https://docs.google.com/spreadsheets/d/0At2sqNEgxTf3dEt5SXBTemZZM1gzQy1vLVFNRnludHc/export?gid=0&format=csv' 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2015-05-21T11:30:58.020

我能够`wget`从如下所示的公共电子表格 URL 中获取一个可用的 URL：

```
https://docs.google.com/spreadsheets/d/LONG_ID_STRING/edit?usp=sharing 
```

通过将它们更改为如下所示：

```
https://docs.google.com/spreadsheets/d/LONG_ID_STRING/export?format=csv 
```

这样我的 wget 命令看起来像：

```
$ wget "https://docs.google.com/spreadsheets/d/LONG_ID_STRING/export?format=csv" 
```

确保首先使用右上角的蓝色“共享”按钮共享电子表格，然后使用“获取共享链接”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-02-23T06:44:34.910

要访问其他选项卡，您需要单击并获取该选项卡的 gid，因此：

`https://docs.google.com/spreadsheets/d/1GxmL3bbejjGx-Ji7kzsnZLzkSaMrfX5WwgRAvvqfqpw/pubhtml?widget=true&amp%3Bheaders=false#gid=2120833204`

变成：

`https://docs.google.com/spreadsheets/d/1GxmL3bbejjGx-Ji7kzsnZLzkSaMrfX5WwgRAvvqfqpw/export?format=csv&id=1GxmL3bbejjGx-Ji7kzsnZLzkSaMrfX5WwgRAvvqfqpw&gid=2120833204`

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2015-05-14T17:39:54.183

现在我可以回答问题了，所以我会一直回答它（粘贴我之前的评论）。

我的问题是我没有正确存储 cookie。当时，我正在使用 Python 程序尝试下载它。这解决了我报告的问题：

```
# Cookie management 
opener = urllib2.build_opener(urllib2.HTTPCookieProcessor(CookieJar())) 
csv_data =  csv.reader(opener.open(url)) 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2017-02-08T23:36:59.673

遇到这个问题并尝试了一些解决方案。没有一个工作完美，所以我写了这个 curl 似乎可以完成这项工作。您需要与知道链接的任何人共享您的 google 电子表格以使其正常工作

`curl -o /path/to/file/you/want/csv/to/go.csv 'https://docs.google.com/spreadsheet/ccc?key=[the-id-of-your-spreadsheet]&output=csv' -L`

这`-L`是这里的技巧，谷歌经常移动 csv，但会向您发送重定向链接。`-L`告诉`curl`跟随重定向，直到它落在文件上。

您可以`id`通过在谷歌驱动器中打开它并查看 url 来找到您的电子表格

`https://docs.google.com/spreadsheets/d/[idwillbehere]/edit#gid=0`*

# jquery - 如何使用 ActiveRecord 排列图像

> ID：10730713
> 
> 赞同：0
> 
> 时间：2012-05-24T03:22:38.610
> 
> 标签：jquery, ruby-on-rails, jquery-ui, activerecord, rubygems

我正在使用 Rails 为一个美容项目销售网站实现以下效果 ![在此处输入图像描述](../Images/19fbd5ae3e67718bd75de2ae1384720b.png)

假设我将信息存储在数据库中，我如何生成或显示如图所示的项目，同时让用户可以选择单击“下一步”并继续查看其他项目。这有宝石吗？

另外，我想实现单击“添加到篮子”的相同效果，然后将其更改为两侧带有 - + 的数量文本字段。

有任何图书馆/宝石吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T04:01:35.940

显示一个 8 列的产品网格对于 gem 来说有点特殊。您的问题与 ActiveRecord 没有任何关系，这是一个视图问题。

如果您需要前端的起点，我建议您查看 twitter bootstrap。它有一个非常灵活的网格系统。

至于增量减量按钮，您只需要使用 jquery 来更新文本字段，具体取决于单击哪个。

# symfony - Symfony2：基于语言环境的日期时间格式

> ID：10730716
> 
> 赞同：0
> 
> 时间：2012-05-24T03:22:41.767
> 
> 标签：symfony, datetime-format

我有一个国际化（英语/西班牙语）的应用程序，但我在日期方面遇到了一些问题。我在表单中的日期字段：

```
 $builder->add('begin_date', 'date', array('required' => false, 'widget' => 'single_text')) 
```

默认情况下基于语言环境的日期格式：'es' => 23/05/2012 'en' => 2012 年 5 月 23 日

但是当我的控制器中的 locale='es' 时我不能这样做：

```
$my_datetime = new \DateTime($request->get('begin_date') 
```

我有一个 datetime 构造函数错误，因为传递的日期格式为 dd/MM/YY，应该是 MM/dd/YY

我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T07:12:41.370

只有用户端（所以 html）是国际化的。

数据输入应该映射到您应该从表单中请求的 DateTime 对象：

$form->bindRequest($this->getRequest()); $myDateTime = $form->get('BeginDate');

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-08-23T13:41:50.203

尝试使用[DateTime::createFromFormat()](http://php.net/manual/en/datetime.createfromformat.php)。将导致如下所示：

```
$formats    = array('en' => 'F d, Y', 'es' => 'd/m/Y');
$myDateTime = DateTime::createFromFormat($formats[$request->getLocale()], $request->get('begin_date')); 
```

# c# - 如何保持asp.net开发服务器仍在运行？

> ID：10730718
> 
> 赞同：1
> 
> 时间：2012-05-24T03:23:15.273
> 
> 标签：c#, asp.net, web

如何保持asp.net开发服务器仍在运行？

我正在开发一个 asp.net mvc 项目。在我卸载 Resharp 之后。服务器将仅在调试时启动。

有什么方法可以让它继续运行，这样我可以重新编译更有效。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T03:26:27.243

出于同样的原因，我遇到了类似的问题。我重新加载了设置，一切都很好。 [http://msdn.microsoft.com/en-us/library/ms247075(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/ms247075(v=vs.100).aspx)

# google-chrome-extension - 是否有旧版 Chrome 扩展程序的存档？

> ID：10730721
> 
> 赞同：28
> 
> 时间：2012-05-24T03:23:43.857
> 
> 标签：google-chrome-extension, chrome-web-store

我想知道是否有一种既定方法可以在 Chrome Web Store 中获取旧版本的扩展。Google 是否保留类似于 Mozilla 的存档，或者一旦有新版本可用，旧版本就永远消失了？

谢谢你。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2016-04-25T16:24:22.633

有一个网站在做：[crx4chrome.com](http://www.crx4chrome.com/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-24T20:09:33.513

永远消失了。版本更改时，扩展文件的链接始终保持不变。获取某个扩展的旧版本的最佳方法是从 github/bitbucket/etc 获取它（如果那里有源代码），或者只是要求扩展作者向您发送旧版本的代码。然后，您可以使用扩展页面上的“加载解压扩展...”功能运行代码（请务必先选中“开发人员模式”复选框）。

# function - 通过 powershell 中的多个函数进行流水线化

> ID：10730729
> 
> 赞同：0
> 
> 时间：2012-05-24T03:25:15.987
> 
> 标签：function, powershell, pipelining

用户启动一个名为 wrapper.ps1 的脚本

```
param(
  [string]$command,
  [string]$item=''
  etc
) 
```

然后我用

```
switch -wildcard ($command) {
  "command1" {function1 $item;}
  "command2" {function2 $item;} 
  etc. 
 } 
```

然后我有一个function1，例如：

```
function function1 {
   param([string] $itemname =''}
   #etc...then:
   $summary = @{blah1 = $blah1; blah2= $blah2; blah3= $blah3; }
   return $summary 
```

$blah# 是简单的字符串。问题是我如何通过 wrapper.ps1 管道到 function1？我想这样称呼这个脚本：

wrapper.ps1 命令1 文件名|ft blah1,blah3

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T04:26:33.740

您选择返回一个哈希表，以便您可以从管道中利用它

```
wrapper.ps1  "command1" "item" | select -ExpandProperty values 
```

或者

```
wrapper.ps1 "command1" "item" | % {foreach ($hash in $_.keys){write-host "the key is $hash the value is $($_[$hash])"}} 
```

# bash - 如何在 bash 脚本中设置使用另一个变量的变量？

> ID：10730732
> 
> 赞同：0
> 
> 时间：2012-05-24T03:26:10.030
> 
> 标签：bash

我正在尝试设置一个在 bash 脚本中使用另一个变量的变量：

```
echo "Enter server IP:"
read serverIP

ssh="ssh $serverIP"

$ssh cp ...
$ssh mv ...
$ssh rm ... 
```

但是，这不起作用。在这种情况下，正确的语法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T03:37:34.780

您可以使用

```
SERVER_IP="127.0.0.1"
alias ssh="ssh $SERVER_IP" 
```

你可以走了

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T12:23:35.657

如果你想[通过 SSH 运行远程命令](http://mywiki.wooledge.org/BashFAQ/096)，唯一安全的方法是使用[数组](http://mywiki.wooledge.org/BashGuide/Arrays)和参数转义。

首先，使用一个数组来存储命令、选项、标志、参数等。例如：

```
remote_cmd=(touch -- "path with spaces")
echo "${remote_cmd[2]}" # path with spaces 
```

您需要转义这些参数以通过 SSH 运行：

```
for arg in "${remote_cmd[@]}"
do
    remote_cmd_escaped+=("$(printf %q "$arg")")
done
echo "${remote_cmd_escaped[2]}" # path\ with\ spaces 
```

然后你应该为 SSH 命令本身使用另一个数组：

```
ssh_cmd=(ssh "localhost" "${remote_cmd_escaped[@]}") 
```

现在您可以毫无问题地运行它：

```
"${ssh_cmd[@]}" 
```

验证文件是用空格创建的：

```
ls "$HOME/path with spaces" 
```

成功！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T03:32:36.793

尝试

```
 eval $ssh cp ... 
```

我不认为设置 serverIP 和 ssh 是引用值的问题。

Eval 推迟命令从 shell 到系统的最终提交，允许再次通过。在第一遍中，`$ssh`扩展了，在第二遍和最后一遍（eval）中，现在 shell 可以看到 $ssh 的真正含义`ssh 10.10.10.10`（例如）。

Eval 被认为是邪恶的，用户有可能通过执行的 serverIP 变量提交正确的 sytnax `/bin/rm -rf /*`。所以要小心你如何使用它。

最后一点琐事，在一行上使用超过 1 个 eval 传递是可能的，但几乎不是每一个实际操作，即`eval eval eval... \$${ssh} ....`.

我希望这有帮助。

# android - 使用 Android 应用程序为 facebook 登录创建新的访问令牌

> ID：10730733
> 
> 赞同：0
> 
> 时间：2012-05-24T03:26:15.930
> 
> 标签：android, facebook, facebook-access-token

我正在实现一个应用程序，需要使用新的访问令牌登录 facebook 帐户。
我需要的是，从特定的 Facebook 帐户获取数据。
我能够找到一些关于访问令牌的编码，但他们都在 facebook 中使用现有的访问令牌用于 android 应用程序。这不是我需要的。
帮助我，，，这是一个拯救生命的尝试。希望你们都理解我的要求... 谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T06:27:15.183

如果设备安装了 facebook 应用程序，则调用 SSO 将使用该应用程序，并且登录到该应用程序的用户将是使用的用户。

您可以避免使用 SSO：[How to disable Facebook single sign on for android - Facebook-android-sdk](https://stackoverflow.com/questions/4521013/how-to-disable-facebook-single-sign-on-for-android-facebook-android-sdk)这将导致 SDK 使用其自己的对话框，用户可以在其中输入他的电子邮件密码。

# javascript - 骨干js的设置方法无法工作

> ID：10730738
> 
> 赞同：0
> 
> 时间：2012-05-24T03:26:28.467
> 
> 标签：javascript, backbone.js, set, backbone-events

我已经定义了一个模型使用主干：

```
window.ResourceModel = Backbone.Model.extend({

        default:{
            'relativeurl':'unknow',
            'type': "unkonw"
        },

        initialize: function(){

            this.bind("change:relativeurl", function () {
                console.log('change!',this.relativeurl);
            });

            this.bind("change:type", function () {

            });
        },

        setRelativeURL: function (url) {
             console.log('pass in',url);//this have value
             this.set({"relativeurl": url});//this's value is undefined!
        },

        delResource: function () {
            console.log("this.url",this.relativeurl);
            resourceMasterView.delResourceItem(this.url);
        }
    }); 
```

然后我想调用这个方法

```
window.resourceModel = new ResourceModel();
resourceModel.setRelativeURL(url);
resourceModel.setType(type); 
```

但只是我在上面评论，即使我已经调用了 set 方法，“relativeurl”结果仍然是未定义的！

我的代码有什么问题？我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T03:42:36.383

要访问`relativeurl`Backbone 模型的属性，你说[`m.get('relativeurl')`](http://backbonejs.org/#Model-get)；该属性未存储为模型的属性，因此：

```
console.log('change!', this.relativeurl); 
```

将始终`undefined`为`this.relativeurl`. 你应该说：

```
console.log('change!', this.get('relativeurl')); 
```

演示：http: [//jsfiddle.net/ambiguous/VBQ5h/](http://jsfiddle.net/ambiguous/VBQ5h/)

您也可以直接通过以下方式访问该属性，[`this.attributes`](http://backbonejs.org/#Model-attributes)但通常应该不理会`attributes`：

```
console.log('change!', this.attributes.relativeurl); 
```

演示：http: [//jsfiddle.net/ambiguous/y3Q6b/](http://jsfiddle.net/ambiguous/y3Q6b/)

您真正的问题可能是*对象属性*和*Backbone 属性*之间的混淆。属性是对象的字段，可以作为`o.some_property`或访问`o['some_property']`。主干模型主要处理存储在模型属性中的属性，并通过（当然还有、和）[`attributes`](http://backbonejs.org/#Model-attributes)访问[`get`](http://backbonejs.org/#Model-get)和修改。骨干模型对任意对象属性一无所知。[`set`](http://backbonejs.org/#Model-set)[`fetch`](http://backbonejs.org/#Model-fetch)[`unset`](http://backbonejs.org/#Model-unset)[`clear`](http://backbonejs.org/#Model-clear)

# c# - 将绑定列表转换为通用列表

> ID：10730739
> 
> 赞同：1
> 
> 时间：2012-05-24T03:26:42.803
> 
> 标签：c#, list, generics, unity-container

我需要将绑定的（UnityEngine.Component）列表转换为通用（T）列表，这可能吗？如何？

我正在使用 Unity 和 C#，但我想大致了解如何做到这一点。

```
 List<Component> compList = new List<Component>();
        foreach(GameObject obj in objects)   // objects is List<GameObject>
        {
            var retrievedComp = obj.GetComponent(typeof(T));
            if(retrievedComp != null)
                compList.Add(retrievedComp);
        }

        List<T> newList = new List<T>(compList as IEnumerable<T>); // ERROR HERE

        foreach(T n in newList)
            Debug.Log(n); 
```

谢谢！

我认为这是问题所在，我收到了这个运行时错误......

```
ArgumentNullException: Argument cannot be null.
Parameter name: collection
System.Collections.Generic.List`1[TestPopulateClass].CheckCollection (IEnumerable`1 collection)
System.Collections.Generic.List`1[TestPopulateClass]..ctor (IEnumerable`1 collection)
DoPopulate.AddObjectsToList[TestPopulate] (System.Reflection.FieldInfo target) (at Assets/Editor/ListPopulate/DoPopulate.cs:201)
System.Reflection.MonoMethod.Invoke (System.Object obj, BindingFlags invokeAttr, System.Reflection.Binder binder, System.Object[] parameters, System.Globalization.CultureInfo culture)
Rethrow as TargetInvocationException: Exception has been thrown by the target of an invocation.
System.Reflection.MonoMethod.Invoke (System.Object obj, BindingFlags invokeAttr, System.Reflection.Binder binder, System.Object[] parameters, System.Globalization.CultureInfo culture)
System.Reflection.MethodBase.Invoke (System.Object obj, System.Object[] parameters)
DoPopulate.OnGUI () (at Assets/Editor/ListPopulate/DoPopulate.cs:150)
System.Reflection.MonoMethod.Invoke (System.Object obj, BindingFlags invokeAttr, System.Reflection.Binder binder, System.Object[] parameters, System.Globalization.CultureInfo culture) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T03:56:41.150

你有没有尝试过

```
 List<T> newList = compList.OfType<T>().Select(x=>x).ToList() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T03:56:57.987

最可能的情况是 T 和 Component 是不同的类型：`List<Component> compList`and `compList as IEnumerable<T>`（这个将是 null 因为 compList`IEnumerable<Component>`不是`IEnumerable<T>`）。

我想你想要：

```
 List<T> compList = new List<T>(); // +++ T instead of GameObject
    foreach(GameObject obj in objects)   // objects is List<GameObject> 
    { 
        // ++++ explict cast to T if GetComponent does not return T
        var retrievedComp = (T)obj.GetComponent(typeof(T)); 
        if(retrievedComp != null) 
            compList.Add(retrievedComp); 
    } 

    List<T> newList = new List<T>(compList as IEnumerable<T>); // ERROR HERE 

    foreach(T n in newList) 
        Debug.Log(n); 
```

# asp.net - 在Repeater中运行脚本并显示结果

> ID：10730740
> 
> 赞同：0
> 
> 时间：2012-05-24T03:26:59.153
> 
> 标签：asp.net, repeater

我的页面上有一个中继器，我想运行一段特定于每个项目的脚本。

到目前为止，这是我的代码

```
 <asp:Repeater ID="topicView" runat="server">
    <HeaderTemplate>
        <table width="925px" cellpadding="0" cellspacing="0">
            <tr>
                <td style="text-align:left;" class="topic-header-home"><strong>Topic Title</strong></td>
                <td width="10%" class="topic-header-home"><strong>Posts</strong></td>
                <td width="20%" class="topic-header-home"><strong>Started By</strong></td>
            </tr>
    </HeaderTemplate>
    <ItemTemplate>        
        <tr>
            <td style="text-align:left;" class="topic-cont-home">
                <p><a href='view.aspx?topicID=<%#DataBinder.Eval(Container.DataItem, "TopicID")%>'><strong><%#DataBinder.Eval(Container.DataItem, "TopicName")%></strong></a></p>
            </td>
            <td class="topic-cont-home">
                <script type="text/C#">
                    // Define the select statement.
                    // All information is needed
                    string selectPostCount = "select count(*) from Posts WHERE TopicID=@topicID";
                    // Define the ADO.NET Objects
                    using (SqlConnection con = new SqlConnection(connectionString))
                    {
                        SqlCommand pccmd = new SqlCommand(selectPostCount, con);
                        pccmd.Parameters.AddWithValue("@topicID", <%#DataBinder.Eval(Container.DataItem, "TopicID")%>);
                        con.Open();
                        int numrows = (int)pccmd.ExecuteScalar();
                        string posts = numrows.ToString();
                        con.Close();
                        posts.InnerHTML = posts;
                    }
                </script>
                <p id="posts" runat="server"></p>
            </td>
            <td class="topic-cont-home">
                <p><strong><%#DataBinder.Eval(Container.DataItem, "Username")%></strong></p>
            </td>
        </tr>
    </ItemTemplate>
    <FooterTemplate>
        </table>
    </FooterTemplate>
</asp:Repeater> 
```

谁能告诉我如何让它工作？

到目前为止，它并没有说我有任何错误，但它也不起作用。

这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T04:13:06.477

您是否尝试在代码隐藏中将脚本块包装在受保护的方法中，然后执行以下操作： GetNumberOfRows 将在后面的代码中定义

```
 <asp:Repeater runat="server" ID="repeater">
    <ItemTemplate>

        <p id="posts" runat="server"><%#GetNumberOfRows((int)DataBinder.Eval(Container.DataItem, "TopicID"))%></p>
    </ItemTemplate>
   </asp:Repeater>

protected int GetNumberOfRows(int topicId)
    {
       //Run query and return result

    } 
```

# c# - 我正在尝试使用绘制图像方法，但无法使其正常工作

> ID：10730748
> 
> 赞同：1
> 
> 时间：2012-05-24T03:27:46.533
> 
> 标签：c#, oop, drawimage

我试图在我的表单上绘制一个图像，在一个图片框的顶部，该图片框有一个用户选择的背景。根据我的研究，我认为使用这种方法是在表单的任何位置绘制图像的最佳方法。我是使用这种方法的新手，这就是我所拥有的：

```
private void button3_Click(object sender, PaintEventArgs e)
    {
        // Create image.
        Image newImage =  Image.FromFile(@"C:\Users\Administrator\Documents\logoGreyHybridText.png");

        // Create coordinates for upper-left corner.

        // of image and for size of image.
        int x = 100;
        int y = 100;
        int width = 450;
        int height = 150;

        // Draw image to screen.
        e.Graphics.DrawImage(newImage, x, y, width, height);

    } 
```

如果有人有一些建议，或者如果我完全使用了这个错误，请随时响起，因为我只有一个学期的 OOP。（我们仍在课堂上使用控制台应用程序；-]）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T04:14:29.007

正如汉斯所说 - 你似乎有一个奇怪的说法，你将点击事件与绘画事件混为一谈。

如果您将此方法连接到点击事件：

```
button3.Click += button3_Click; 
```

您对 button3_Click 的方法参数将是

```
private void button3_Click(object sender, EventArgs e) { // code here // } 
```

我不清楚你实际上想要做什么。（即，您是否要在图片框中绘制的图像上绘制此图像？100、100 的 x,y 坐标是相对于图片框或其他控件对象的位置的吗？）

尽管如此，试试下面的代码，与现在相比，它会让你走上更好的轨道。

假设您使用的是我上面描述的单击事件，而不是绘制事件，您的代码将如下所示：

我将向您展示两种方法 - 首先是“错误的方法”，但这更接近您上面的方法。

```
private void button3_Click(object sender, EventArgs e)
{
    // If this is only an exercise this is acceptable, otherwise you should
    // store the image as a resource
    Image newImage = Image.FromFile(@"C:\Users\Administrator\Documents\logoGreyHybridText.png");

    Graphics graphics = controlToDrawOver.CreateGraphics();

    // Note rectangle x,y coordinates are relative to 
    // the 'controlToDrawOver' object.
    Rectangle rectangleAreaToDrawImage = new Rectangle(100, 100, 450, 150);
    graphics.DrawImage(newImage, rectangleAreaToDrawImage);

} 
```

*** 重要说明 *** 无论上面的代码如何，您都应该在控件绘制事件处理程序中进行绘制，而不是在您的代码显示的控件单击事件处理程序中进行绘制。每次重新绘制控件时，您的更改都会丢失。

因此 - 这是“更好的方法”：

如果您必须等待按钮被点击，您可以执行以下操作：

```
private void button3_Click(object sender, EventArgs e)
{
    controlToDrawOver.Paint -= ControlPaintEventHandler;
    controlToDrawOver.Paint += ControlPaintEventHandler;
}

private void ControlPaintEventHandler(object sender, PaintEventArgs e)
{
    // If this is only an exercise this is acceptable, otherwise you should
    // store the image as a resource
    Image newImage = Image.FromFile(@"C:\Users\Administrator\Documents\logoGreyHybridText.png");

    // Note rectangle x,y coordinates are relative to 
    // the 'controlToDrawOver' object.
    Rectangle rectangleAreaToDrawImage = new Rectangle(100, 100, 450, 150);
    e.Graphics.DrawImage(newImage, rectangleAreaToDrawImage);

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T04:15:12.733

将处理程序添加到 PictruBox.Paint 事件并尝试在其中绘制。您也可以直接将图像设置为 PictureBox.Image 属性，它会在图片框上绘制图像。

通过您的代码，请提供完整的表单代码。我认为主要错误 - 你在表单坐标系中绘制图片，所以你可能会从 PictureBox 中绘制你的图像。还有什么事件可以处理您的方法？

# c# - Xaml 错误消息

> ID：10730749
> 
> 赞同：0
> 
> 时间：2012-05-24T03:27:49.200
> 
> 标签：c#, .net, wpf, xaml

我在 XAML 标记部分的开头收到错误消息

在“System.Windows.StaticResourceExtension”上提供值引发了异常。行号“8”和行位置“9”。

```
<Window x:Class="prj.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:s="clr-namespace:prj"
    xmlns:c="clr-namespace:prj.Controls"
    WindowStartupLocation="CenterOwner"
    Title="MainWindow" 
    Height="850" Width="1000"> 
```

任何帮助表示赞赏。

问候， 阿米特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T08:47:14.640

这个错误可能是由以下原因引起的： 对于静态资源，你应该在引用它之前定义它（动态资源没有这个限制）。有关详细信息，请参阅： [http ://social.msdn.microsoft.com/Forums/en/wpf/thread/f76fdf5d-a9cd-4f42-b2a0-ad560744a39f](http://social.msdn.microsoft.com/Forums/en/wpf/thread/f76fdf5d-a9cd-4f42-b2a0-ad560744a39f)

**也许它没有用，但首先仔细检查你的代码。**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T07:41:30.980

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T07:35:04.633

行号和位置可能引用了`InitializeComponent()`后面代码中的方法。我会接受大多数建议。在使用它之前，请确保您的静态资源可用。

您是否在该 XAML 文件中的任何位置使用静态引用？如果是这样，请找到定义它的字典并确保它在 XAML 文件之前加载。最简单的方法是将资源字典添加到您的应用程序[合并字典](http://msdn.microsoft.com/en-us/library/aa350178.aspx)中。您可以[在此处](http://msdn.microsoft.com/en-us/library/ms750950.aspx)刷新您对静态资源的了解。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-25T07:00:03.043

行号和列号在这里不相关。在这种类型的例外中，它们可能没有实际意义。

挖掘内部异常并寻找它找不到的关键。然后在整个解决方案中搜索该键以查看它的使用位置。对于每次使用，请确保资源可用。

通常，当有一个用户控件 (UC1) 具有在 UC1 的主体中使用的资源时，就会发生这种情况。然后，另一个开发人员将 UC1 的一部分复制到 UC2 而不复制资源。在窗口中使用 UC2 时，会显示这种类型的神秘消息。

# javascript - 如何在 node.js 中分配并行任务

> ID：10730750
> 
> 赞同：3
> 
> 时间：2012-05-24T03:28:11.680
> 
> 标签：javascript, node.js, parallel-processing, socket.io

如何做到这一点，以便我的服务器不会在执行 for 循环时卡住并可以处理其他请求？如果我可以在我的服务器执行其他操作的同时并行执行 for 循环，那就太好了。

```
 socket.on('drawing', function() {  
      for (var i = 0; i < x.length-1; i++)
      {
        //do stuff
      }  
    }); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T05:12:14.970

[Async.js](https://github.com/caolan/async)有一堆帮助函数，比如[foreach](https://github.com/caolan/async#forEach)，[而](https://github.com/caolan/async#whilst)这正是你在这里所要求的。

编辑：

这是一个完整的例子：

```
async = require('async');

var i = 0

async.whilst(
    // test
    function() { return i < 5; },
    // loop
    function(callback) {
        i++;
        console.log('doing stuff.');
        process.nextTick(callback);
    },
    // done
    function (err) {
        console.log('done!');
    }
); 
```

哪个输出：

```
doing stuff.
doing stuff.
doing stuff.
doing stuff.
done! 
```

编辑 2：将命名函数更改为注释以避免混淆。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-24T03:38:20.303

您可以使用`process.nextTick`将功能移开，但它不会真正并行，Node.js 是一种事件驱动语言，因此它并不真正执行线程。[这是](http://howtonode.org/understanding-process-next-tick)使用的概述`process.nextTick`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T05:55:05.480

根据@Slace 的回答，您可以使用异步递归。

```
socket.on('drawing', function {
  var i = 0;
  (function someFunction() {
    if (i < x.length - 1) {
      i++;

      // Do stuff.

      process.nextTick(someFunction)
    } else {
      // Do something else.
    }
  }());  
}); 
```

# spring - 在 Spring 上下文中使用 Maven settings.xml 属性

> ID：10730755
> 
> 赞同：7
> 
> 时间：2012-05-24T03:28:51.010
> 
> 标签：spring, maven

我的目录中有一个 Maven`settings.xml`文件`~/.m2`；它看起来像这样：

```
<settings>
    <profiles>
        <profile>
            <id>mike</id>
            <properties>
                <db.driver>org.postgresql.Driver</db.driver>
                <db.type>postgresql</db.type>
                <db.host>localhost</db.host>
                <db.port>5432</db.port>
                <db.url>jdbc:${db.type}://${db.host}:${db.port}/dbname</db.url>
            </properties>
        </profile>
    </profiles>
    <activeProfiles>
        <activeProfile>mike</activeProfile>
    </activeProfiles>
    <servers>
        <server>
            <id>server_id</id>
            <username>mike</username>
            <password>{some_encrypted_password}</password>
        </server>
    </servers>
</settings> 
```

我想使用这些属性两次

*   一旦进入 Maven`integration-test`阶段，就可以设置和拆除我的数据库。使用 Maven 过滤，这是完美的工作。
*   第二次运行我的 Spring 应用程序时，这意味着我需要`servlet-context.xml`在 Maven`resources:resources`阶段将这些属性替换到我的文件中。对于 上部的属性`settings.xml`，例如`${db.url}`，这工作正常。 **我不知道如何将我的数据库用户名和（解密的）密码替换为 Spring`servlet-context.xml`文件。**

`servlet-context.xml`我的文件的相关部分如下所示：

```
<bean id="myDataSource" class="org.apache.commons.dbcp.BasicDataSource" destroy-method="close">
    <property name="driverClassName"><value>${db.driver}</value></property>
    <property name="url"><value>${db.url}</value></property>
    <property name="username"><value>${username}</value></property>
    <property name="password"><value>${password}</value></property>
</bean> 
```

这里的最终目标是让每个开发人员拥有自己的 Maven 设置（以及在他们自己的机器上用于集成测试的数据库）......以及 Jenkins 服务器上的类似设置。我们不想共享一个共同的用户名/密码/等。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T06:22:25.377

有一种方法可以通过配置 Maven War Plugin 来过滤 Web 资源。查看官方插件文档[中](http://maven.apache.org/plugins/maven-war-plugin/examples/adding-filtering-webresources.html)的片段。

顺便说一句，我强烈建议重新考虑这种基于过滤的方式，以便在构建时提供事实上的运行时配置。请注意，您必须**重新构建相同的代码**才能为另一个环境准备包（或者编辑包内容）。您可以为此使用应用程序服务器的特定内容（至少 JBoss 有一个）或使用 AFAIR 也可以像这样配置的 Spring。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T10:11:40.560

我建议您在中间使用属性文件。我的意思是：Spring 应用程序将使用来自属性文件的属性值加载`context:property-placeholder`，而 Maven 将使用来自 settings.xml 的值使用过滤替换 ${...} 变量。

您的财产文件：

```
db.driver=${db.driver}
db.url=${db.url}
username=${username}
password=${password} 
```

你的`servlet-context.xml`档案

```
<context:property-placeholder location="classpath:your-property-file.properties" />

<bean id="myDataSource" class="org.apache.commons.dbcp.BasicDataSource" destroy-method="close">
    <property name="driverClassName"><value>${db.driver}</value></property>
    <property name="url"><value>${db.url}</value></property>
    <property name="username"><value>${username}</value></property>
    <property name="password"><value>${password}</value></property>
</bean> 
```

在你的 pom.xml

```
<resources>
    ...
    <resource>
        <directory>src/main/resources</directory>
        <filtering>true</filtering>
    </resource>
    ...
</resources> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T11:22:24.000

我还没有尝试过，但是根据这个[maven wiki page](http://docs.codehaus.org/display/MAVENUSER/MavenPropertiesGuide)，您应该能够在`settings.xml`使用`settings.`前缀时引用属性。所以`${settings.servers.server.username}`理想情况下应该返回`username`in `settings.xml`。

# macos - Growl 1.3 在沙盒化 Cocoa 应用程序中的使用

> ID：10730756
> 
> 赞同：1
> 
> 时间：2012-05-24T03:29:04.147
> 
> 标签：macos, cocoa, sandbox, growl

您如何在沙盒化的 Cocoa 应用程序中与 Growl 1.3 通信？是否有任何示例代码？当应用程序没有被沙盒化时，Growl 可以正常工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T14:50:53.200

如果[growl.info](http://growl.info/documentation/developer/implementing-growl.php#sandboxinginyourapp)上的文档没有涵盖您需要做的事情，请告诉我们。要点是：您运行采用模板咆哮 xpc 的脚本，将其重命名以匹配您的应用程序的捆绑包 id 域，将其复制到您的应用捆绑包中并使用您的代码签名身份对其进行签名。然后`-(BOOL) hasNetworkClientEntitlement`，您在应用程序中指定为 GrowlApplicationBridge 委托的类中实现，以让咆哮框架知道您的主应用程序是否为自己声明了网络权利。

[BeepHammer](http://code.google.com/p/growl/source/browse/#hg/Developer%20Tools/BeepHammer)是如何将其集成到 Xcode 构建过程中的一个示例，您需要特别注意运行包含的 ruby​​ 脚本以进行重新识别/签名/复制的 shell 脚本构建阶段。

# python - Matplotlib 3D 震源图，从 .txt 文件中读取 xyz 值

> ID：10730757
> 
> 赞同：3
> 
> 时间：2012-05-24T03:29:19.997
> 
> 标签：python, arrays, list, matplotlib

我正在尝试边做边学python。对于从 M 0.1 到 2.0 的大约 500,000 次地震（震源），我有真实世界的 xy（lat long dd）坐标和 z（地表以下公里）值。我在一个 .txt 制表符分隔的表中将数据缩减为 10 行 xyz 值。我想在 matplotlib 的 3d 散点图可旋转框中绘制数据。我可以使用基本命令来读取数据并且格式看起来不错。我不清楚是否需要将数据读入列表或数组中，以便 mpl 读取和绘制数据。我需要创建一个数组吗？

然后我想绘制油井的地下位置，给定沿井筒（大约 40 个位置）的顶点的 xyz 坐标，我是否需要创建折线？该数据与一些震中具有相同的一般坐标（有待进一步评估）。哪组数据应该是情节，哪组数据应该是子情节？另外，我不清楚在给定 he xy lat long 坐标的 6 到 7 位小数和 2 位小数 z 坐标的情况下我需要的“浮点数”。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T15:41:24.323

实际上，Matplotlib 是一个糟糕的选择。它不允许真正的 3D 绘图，也无法处理您需要的复杂性（或 3D 中的点数）。看看[mayavi 吧](http://docs.enthought.com/mayavi/mayavi/mlab.html)。

顺便说一句，听起来你在做微震？（我也是一名地球物理学家，不管它值多少钱。）

举个简单的例子：

```
from enthought.mayavi import mlab
import numpy as np

# Generate some random hypocenters
x, y, z, mag = np.random.random((4, 500))

# Make a curved well bore...
wellx, welly, wellz = 3 * [np.linspace(0, 1.5, 10)]
wellz =  wellz**2

# Plot the hypocenters, colored and scaled by magnitude
mlab.points3d(x, y, z, mag)

# Plot the wellbore
mlab.plot3d(wellx, welly, wellz, tube_radius=0.1)

mlab.show() 
```

![在此处输入图像描述](../Images/d846717772c3f8f89ac22e36ee4cfbae.png)

就读取数据而言，听起来应该很简单：

```
x, y, z = np.loadtxt('data.txt').T 
```

你遇到了什么问题？

# perl - 在 Moose::Role 中访问 MooseX::ClassAttribute

> ID：10730759
> 
> 赞同：3
> 
> 时间：2012-05-24T03:29:34.397
> 
> 标签：perl, moose

这是难题。我使用 Moose::Role 作为接口，其中具体类必须实现角色定义的所需属性构建器。该角色还定义了一些对属性执行逻辑的方法。这是我正在尝试做的精简版。

```
package Parent;
use Moose::Role;
requires '_build_permission_level';

has 'permission_level' => (
    is => 'ro',
    isa => Int,
    lazy_build => 1,
);

use constant {
    LEVEL1 = 1,
    LEVEL2 = 2,
    LEVEL3 = 3,
};

sub can_do_action {
    my $self = shift;
    return $self->permission_level() >= LEVEL2;
}

package Child;
use Moose;
with 'Parent';

sub _build_permission_level { return Parent->LEVEL3; } 
```

显然我有很多子类，具有不同的权限级别。现在这行得通，但效率极低。所有子实例将始终具有相同的权限级别，但我必须实例化它只是为了询问它是否可以执行操作。当批量运行 10,000 次时，你就明白了。

所以相反，我想让 permission_level 成为一个类属性。以 Moose-y 方式解决效率问题。注意permission_level 不再需要$self。

```
package Parent;
use Moose::Role;
use MooseX::ClassAttribute;
requires '_build_permission_level';

class_has 'permission_level' => (
    is => 'ro',
    isa => Int,
    builder => '_build_permission_level',
);

use constant {
    LEVEL1 = 1,
    LEVEL2 = 2,
    LEVEL3 = 3,
};

sub can_do_action {
    return permission_level() >= LEVEL2;
}

package Child;
use Moose;
with 'Parent';

sub _build_permission_level { return Parent->LEVEL3; } 
```

这会因未定义的子例程错误而死，找不到 Parent::permission_level。所以父母不知道permission_level。真的吗？我很困惑它如何无法访问自己的类属性。我一定错过了一些非常简单的东西。但更根本的是，我应该如何让 Parent 为 Child 提供的类属性提供逻辑？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T07:15:33.757

该错误表明在编译时不存在 sub `Parent::permission_level`。这是真的： `has`并且`class_has`是运行时构造；`can_do_action`编译调用时尚未创建子。

真正的问题是您在调用类方法时使用了错误的语法。改写`can_do_action`如下：

```
sub can_do_action {
    my ($class) = @_;

    return $class->permission_level >= LEVEL2;
} 
```

它应该可以正常工作。与普通函数调用不同，方法调用直到运行时才被解析，此时`Parent::permission_level`将存在。

# java - 如何在非参与者上下文中获取参与者调用的期货

> ID：10730761
> 
> 赞同：0
> 
> 时间：2012-05-24T03:30:03.707
> 
> 标签：java, akka, future

我正在将 Akka 集成到现有软件中，主要是为了在不应该同步的地方使事情异步。

我有一个正在进行一些数据库调用的服务，目前，一切都是同步的，调用线程只是坐在这里等待结果......

我的想法是替换 DAO 接口以将`Future<T>`（Akka）作为结果而不是实际结果类型，因此，我的 DAO 实现实际上是在消息中转换这些调用并将它们路由到适当的参与者（本地和/或远程）。

`Future<T>`现在当我打电话给演员时如何返回a时，我有点困惑。除了使用还有其他方法`Patterns.ask()`吗？它是性能方面的最佳解决方案（无需使用演员重写所有内容）吗？

使用`Patterns.ask()`，如何在不等待超时的情况下返回错误？如果我调用的演员只是简单地告诉错误，当我想触发失败时，它会触发成功。

**编辑**

我正在使用 Java。

现在，我想出了一个类似下面的构造，但是，这意味着我的演员必须`tell()`将异常返回给发送者。

```
final Future<Object> f = Patterns.ask(..., ..., ...);
f.flatMap(new Mapper<Object, Future<List<Element>>>() {
    public Future<List<Element>> apply(Object response) {
        if (response instanceof SuccessfulResult) { 
            return Futures.successful(response, f.executor());
        } else if (response instanceof Throwable) {
            return Futures.failed((Throwable) response, f.executor());
        } else {
            return Futures.failed(..., f.executor());
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T07:33:59.210

要区分成功或失败，您将使用[scala.Either](http://www.scala-lang.org/api/current/scala/Either.html)。所以答案类型可能看起来像这样：

```
type Result = Future[Either[SQLException, MyDataType]] 
```

# android - 从android中的apk文件中分离图像

> ID：10730763
> 
> 赞同：0
> 
> 时间：2012-05-24T03:30:17.040
> 
> 标签：android, apk

我正在编写一个包含大量图像的 android 应用程序。

我不想将这些图像保留为我的 apk 文件的一部分，因为这会使 apk 文件的大小非常大。我已经编写了应用程序，它在运行时从某个预定义位置的 sdcard 加载这些图像。现在我的问题是我如何将这些图像提供给想要安装我的应用程序的用户。由于图像不是项目的一部分（即不存在于任何可绘制文件夹中），因此它们不会成为我提供的 APK 文件的一部分。

甚至有可能在Android中做这样的事情吗？或者有人可以建议我现在拥有的更好的解决方案。任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T03:39:00.787

有一种官方方法可以实现您想要的：[**APK扩展文件**](http://developer.android.com/guide/market/expansion-files.html)

# javascript - 如何在单击时使用 jQuery 查找兄弟元素的值

> ID：10730765
> 
> 赞同：3
> 
> 时间：2012-05-24T03:30:47.437
> 
> 标签：javascript, jquery

我正在尝试使用以下 jQuery 代码在以下 HTML 中查找用户 ID 和密码的值，但它不返回任何值。我究竟做错了什么？

```
<div id='mainpane'>
    <form id='login' method='post' action='#'>
        <p>User Id:<input id='userid' type='text' name='userid'></input></p>
        <p>Password:<input id='password' type='text' name='password'></input></p>
        <p><input id='submit' type='submit' name='Submit' value='Submit'></input></p>           
    </form>
    <div id="message"></div>
    <p>Not a member? <a href="user-signup.html">Signup</a></p>
</div> 
```

这是jQuery代码：

```
$(document).ready(function() {
    $('#login').delegate('input#submit','click',function(){
        alert('user id is: '+$(this).parent().parent().find('#userid').html());
        var request = $.ajax({
            type:"POST",
            url:"/login",
            data: {userid:$('#userid').text(), password:$('#password').text}
            });

        }); 
```

警报返回一个空数据。感谢任何关于我做错了什么的指示。

谢谢，卡利安。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T03:32:41.380

用于`.val()`检索输入的值。

```
var userid = $("#userid").val();
var pass   = $("#password").val(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-24T03:32:51.317

做就是了：

```
$.post('/login', $('#login').serialize(), function() {}); 
```

代替您的`$.ajax`电话:)，`.serialize()`获取所有表单输入的值并将它们传递给服务器，并为您编码:)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-24T03:36:32.050

你有很多问题，所以这里是带有注释的更正代码：

jQuery

```
$(function() {
// same as document.ready
    $('#login').submit(function(event){            
    // runs whenever the form is submitted - either enter or submit button is clicked
        event.PreventDefault();
        // since the form is submitted via ajax you wil want to keep the page from changing
        alert('user id is: '+$('#userid').val());
        // no need to reach back through the DOM with .parent() use the ID its the fastest, also you get input values with .val()
        $.ajax({
            type:"POST",
            url:"/login",
            data: $('#login').serialize()
            // serialize() creates an object of all the form data based on the name attribute and values - very clean
        });
    });
}); 
```

HTML

```
<div id='mainpane'>
    <form id='login' method='post' action=''>
        <p>User Id:<input id='userid' type='text' name='userid'/></p>
        <p>Password:<input id='password' type='text' name='password'/></p>
        <p><input id='submit' type='submit' name='Submit' value='Submit'/></p>           
    </form>
    <div id="message"></div>
    <p>Not a member? <a href="user-signup.html">Signup</a></p>
</div> 
```

输入是自闭合的。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-05-24T03:38:48.337

你试试这个代码

```
 $(document).ready(function() {
        $('#login').delegate('input#submit','click',function(){

            alert('user id is: '+$(this).parent().parent().find('#userid').val());
            var request = $.ajax({
                type:"POST",
                url:"/login",
                data: {userid:$('#userid').val(), password:$('#password').val()}
                });

            });
        }); 
```

# excel - 基于单元格值保存文件名的 Excel 2003 模板

> ID：10730767
> 
> 赞同：0
> 
> 时间：2012-05-24T03:30:56.940
> 
> 标签：excel, vba

我需要制作一个 Excel 2003 模板以用于客户订单输入表单，当用户保存文件时，它将自动以单元格 B2（客户 ID）的值作为前缀和当前日期的文件名保存为后缀例如“2001XC_5-24-12”。我不知道VBA。非常感谢你，纳撒尼尔

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T09:48:10.567

您可以使用`BeforeSave`事件处理程序来执行此操作。

将此代码放入`ThisWorkbook`模块中

```
Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)
    Application.EnableEvents = False
    ThisWorkbook.SaveAs [B2] & "_" & Format(Date, "m-d-yy")
    Cancel = True
    Application.EnableEvents = True
End Sub 
```

笔记：

*   您需要考虑要从哪个工作表中获取单元格`B2`，因此请使用以下内容：

    ```
    ThisWorkbook.SaveAs ThisWorkbook.Worksheets("Sheet Name Here").Cells(2,2) ... 
    ```

*   在创建带日期的文件名时，我建议您使用 formay`yyyymmdd`以便它们按时间顺序排序

# android - PhysicsHandler 无法按预期工作 - AndEngine

> ID：10730768
> 
> 赞同：1
> 
> 时间：2012-05-24T03:31:06.143
> 
> 标签：android, andengine

伙计们是 AndEngine 的新手。我想使用物理处理程序并浏览了andengine的示例。所以在我的例子中，我有一个“球”精灵，我可以通过触摸来移动它，还有一个“方形”动画精灵，我希望它会在墙壁上反弹。但它只是离开屏幕。帮帮我...

```
 package com.Escapo;

    import org.anddev.andengine.engine.Engine;
    import org.anddev.andengine.engine.camera.Camera;
    import org.anddev.andengine.engine.handler.physics.PhysicsHandler;
    import org.anddev.andengine.engine.options.EngineOptions;
    import org.anddev.andengine.engine.options.EngineOptions.ScreenOrientation;
    import org.anddev.andengine.engine.options.resolutionpolicy.RatioResolutionPolicy;
    import org.anddev.andengine.entity.scene.Scene;
    import org.anddev.andengine.entity.scene.Scene.IOnSceneTouchListener;
    import org.anddev.andengine.entity.scene.background.ColorBackground;
    import org.anddev.andengine.entity.sprite.AnimatedSprite;
    import org.anddev.andengine.entity.sprite.Sprite;
    import org.anddev.andengine.entity.util.FPSLogger;
    import org.anddev.andengine.input.touch.TouchEvent;
    import org.anddev.andengine.opengl.texture.TextureOptions;
    import org.anddev.andengine.opengl.texture.atlas.bitmap.BitmapTextureAtlas;
    import    org.anddev.andengine.opengl.texture.atlas.bitmap.BitmapTextureAtlasTextureRegionFactory;
    import org.anddev.andengine.opengl.texture.region.TextureRegion;
    import org.anddev.andengine.opengl.texture.region.TiledTextureRegion;
    import org.anddev.andengine.ui.activity.BaseGameActivity;

    import android.view.Display;

    public class EscapoActivity extends BaseGameActivity {

private Camera mCamera;
private Scene mMainScene;

//main ball variables
private BitmapTextureAtlas mBitmapTextureAtlas;
private TextureRegion mPlayerTextureRegion;
private Sprite player;
//square
private BitmapTextureAtlas mBitmapTextureAtlas2;
private static final float DEMO_VELOCITY = 100.0f;
private TiledTextureRegion mFaceTextureRegion;
private static int cameraWidth;
private static int cameraHeight;
private Sprite square;
@Override
public void onLoadComplete() {

}

@Override
public Engine onLoadEngine() {

    final Display display = getWindowManager().getDefaultDisplay();

        cameraWidth = display.getWidth();

        cameraHeight = display.getHeight();

        mCamera = new Camera(0, 0, cameraWidth, cameraHeight);

        return new Engine(new EngineOptions(true, ScreenOrientation.LANDSCAPE,

            new RatioResolutionPolicy(cameraWidth, cameraHeight), mCamera));

}

@Override
public void onLoadResources() {

            mBitmapTextureAtlas = new BitmapTextureAtlas(512, 512,

                TextureOptions.BILINEAR_PREMULTIPLYALPHA);

            //square
            mBitmapTextureAtlas2 = new BitmapTextureAtlas(512, 512,

                    TextureOptions.BILINEAR_PREMULTIPLYALPHA);

            BitmapTextureAtlasTextureRegionFactory.setAssetBasePath("gfx/");

            mPlayerTextureRegion = BitmapTextureAtlasTextureRegionFactory

                .createFromAsset(this.mBitmapTextureAtlas, this, "ball.png",

                0, 0);

            //square
            this.mFaceTextureRegion = BitmapTextureAtlasTextureRegionFactory.createTiledFromAsset(this.mBitmapTextureAtlas2, this, "square.png", 0, 0, 1, 1);

            mEngine.getTextureManager().loadTextures(mBitmapTextureAtlas,mBitmapTextureAtlas2);

}

@Override
public Scene onLoadScene() {

     mEngine.registerUpdateHandler(new FPSLogger());

         mMainScene = new Scene();

         mMainScene

             .setBackground(new ColorBackground(0.09804f, 0.6274f, 0.8784f));

         final int PlayerX =(int) ((mCamera.getWidth() - mPlayerTextureRegion

                 .getWidth()) / 2);
         final int PlayerY = (int) ((mCamera.getHeight() - mPlayerTextureRegion

             .getHeight()) / 2);

         player = new Sprite(PlayerX, PlayerY, mPlayerTextureRegion) {

                 public boolean onAreaTouched(TouchEvent pSceneTouchEvent,float pTouchAreaLocalX, float pTouchAreaLocalY) {

                    this.setPosition(pSceneTouchEvent.getX()- this.getWidth() / 2, pSceneTouchEvent.getY()- this.getHeight() / 2);

                     return true;

                 }

             };
             mMainScene.registerTouchArea(player);

                mMainScene.setTouchAreaBindingEnabled(true);

         mMainScene.attachChild(player);
         //square
         final Ball ball = new Ball(2, 2, this.mFaceTextureRegion);
         final PhysicsHandler physicsHandler = new PhysicsHandler(ball);
         ball.registerUpdateHandler(physicsHandler);
         physicsHandler.setVelocity(DEMO_VELOCITY, DEMO_VELOCITY);

         mMainScene.getLastChild().attachChild(ball);

         return mMainScene;

}

private static class Ball extends AnimatedSprite {
    private final PhysicsHandler mPhysicsHandler;

    public Ball(final float pX, final float pY, final TiledTextureRegion pTextureRegion) {
            super(pX, pY, pTextureRegion);
            this.mPhysicsHandler = new PhysicsHandler(this);
            this.registerUpdateHandler(this.mPhysicsHandler);
    }

    @Override
    protected void onManagedUpdate(final float pSecondsElapsed) {
            if(this.mX < 0) {
                    this.mPhysicsHandler.setVelocityX(DEMO_VELOCITY);
            } else if(this.mX + this.getWidth() > cameraWidth) {
                    this.mPhysicsHandler.setVelocityX(-DEMO_VELOCITY);
            }

            if(this.mY < 0) {
                    this.mPhysicsHandler.setVelocityY(DEMO_VELOCITY);
            } else if(this.mY + this.getHeight() > cameraHeight) {
                    this.mPhysicsHandler.setVelocityY(-DEMO_VELOCITY);
            }

            super.onManagedUpdate(pSecondsElapsed);
    }
 }

 } 
```

我刚刚尝试集成移动球示例[http://code.google.com/p/andengineexamples/source/browse/src/org/anddev/andengine/examples/MovingBallExample.java](http://code.google.com/p/andengineexamples/source/browse/src/org/anddev/andengine/examples/MovingBallExample.java) 我哪里出错了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T16:39:46.523

我不确定 PhysicsHandler 会解决您的问题，因为我认为它只是应该帮助您移动实体。

尝试对 AndEngine 的 Box2d 扩展。

从 AndEngine 示例中，有 PhysicsJumpExample.java （在启动器中称为“组合物理和触摸”），如果你触摸它，它基本上会使对象跳跃，所以我想它接近你想要的。

这是该文件中的一些代码，用于制作墙壁：

```
//onCreateScene
    final VertexBufferObjectManager vertexBufferObjectManager = this.getVertexBufferObjectManager();
    final Rectangle ground = new Rectangle(0, CAMERA_HEIGHT - 2, CAMERA_WIDTH, 2, vertexBufferObjectManager);
    final Rectangle roof = new Rectangle(0, 0, CAMERA_WIDTH, 2, vertexBufferObjectManager);
    final Rectangle left = new Rectangle(0, 0, 2, CAMERA_HEIGHT, vertexBufferObjectManager);
    final Rectangle right = new Rectangle(CAMERA_WIDTH - 2, 0, 2, CAMERA_HEIGHT, vertexBufferObjectManager);

    final FixtureDef wallFixtureDef = PhysicsFactory.createFixtureDef(0, 0.5f, 0.5f);
    PhysicsFactory.createBoxBody(this.mPhysicsWorld, ground, BodyType.StaticBody, wallFixtureDef);
    PhysicsFactory.createBoxBody(this.mPhysicsWorld, roof, BodyType.StaticBody, wallFixtureDef);
    PhysicsFactory.createBoxBody(this.mPhysicsWorld, left, BodyType.StaticBody, wallFixtureDef);
    PhysicsFactory.createBoxBody(this.mPhysicsWorld, right, BodyType.StaticBody, wallFixtureDef);

    this.mScene.attachChild(ground);
    this.mScene.attachChild(roof);
    this.mScene.attachChild(left);
    this.mScene.attachChild(right); 
```

要使物体跳跃，只需将速度设置为负重力。最终达到 0 后，重力将其拉回：

```
final Vector2 velocity = Vector2Pool.obtain(this.mGravityX * -50, this.mGravityY * -50);
    faceBody.setLinearVelocity(velocity);
    Vector2Pool.recycle(velocity); 
```

# android - 将谷歌地图添加到android，android平台与google api之间的区别？

> ID：10730769
> 
> 赞同：0
> 
> 时间：2012-05-24T03:31:09.073
> 
> 标签：android, google-maps, android-maps

如果我已经启动了一个 Android 2.3.3 平台并且我有很多代码，如何将谷歌地图添加到我的应用程序中？我真的需要 Google API 吗？有什么区别？

我已将此添加到我的清单中

```
<uses-library android:name="com.google.android.maps" /> 
```

这够了吗？我尝试扩展我的课程`MapActivity`但没有用。

我什至需要这个吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T05:48:10.460

简单地说，是的，您需要 Google API 版本。原因是现有的 Android API 不具备 Google Maps 等功能（以及其他功能，但我目前想不出任何功能）。这就是为什么即使您添加了对库的引用，您的项目也无法编译的原因。它根本无法找到该库，因为它是 Google API 的一部分。

只需将构建目标更改为 2.3.3 的 Google API 版本，就可以了。它包含所有其他 Android 功能以及其他一些有用的东西，因此默认使用 Google API 版本始终是一个明智的决定。至少在我看来，如果这样做有缺点，请纠正我。

# c# - 读取括号内的字符 ()

> ID：10730774
> 
> 赞同：1
> 
> 时间：2012-05-24T03:32:20.823
> 
> 标签：c#, javascript

我已经编写了 ac# 代码来读取括号“（）”内的字符串值

```
 string s = "Hello (World) This is (Working)";
            int i = 0;
            while ((i = s.IndexOf('(', i)) != -1)
            {
                int stop = s.Substring(i+1).IndexOf(')');
                string output = s.Substring(i + 1, stop);
                Console.WriteLine(output);

                i++;
            }

            Console.ReadLine(); 
```

有了这段代码，我得到了

> 世界工作

我想在 JavaScript 中实现这个所以我尝试了这个

```
function myFunction()
{
var s = "Hello (World) This is (Working)";
            var i = 0;
            while ((i = s.indexOf('(', i)) != -1)
            {
                var stop = s.substring(i+1).indexOf(')');
                var output = s.substring(i+1, stop);
                document.write(output);
                i++;
            }
} 
```

但它有不同的输出

> ss (

我不擅长javaScript，请帮我在这种方法中找到解决方案我不想使用正则表达式

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T03:45:33.030

尽管名称相似，但它们实际上并未使用等效方法（注意第二个参数）：

*   C＃ - [`Substring(int index, int length)`](http://msdn.microsoft.com/en-us/library/aka44szs.aspx)
*   JS——[`substring(int indexA, int indexB)`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String/substring)

尝试`substr`使用 JavaScript -- [`substr(int index, int length)`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String/substr)：

```
function myFunction()
{
    var s = "Hello (World) This is (Working)";
    var i = 0;
    while ((i = s.indexOf('(', i)) != -1)
    {
        var stop = s.substr(i+1).indexOf(')');
        var output = s.substr(i+1, stop);
        document.write(output);
        i++;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T03:35:08.557

对于简单的控制逻辑，最好使用转换器。

您可以尝试[使用 SharpKit](http://sharpkit.net/)将 c# 代码转换为 javascript。它可以免费用于小型或开源项目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T03:44:07.540

尝试这个。这不是最好的代码，但它会按照你的要求做：

```
var thestring = 'Hello (World) This is (Working)';
var words = thestring.match(/(\([A-Za-z]+\))/g);
words = words.join('-').replace(/[\(\)]/g,'').split('-'); 
```

**更新**。我没有读过“我不想使用正则表达式”的部分，但也许你应该读。我不太了解正则表达式，但我尽我所能并尝试更多地了解那个……世界。:|

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-24T03:48:23.753

这就是你想要的？

```
function myFunction() {
    var s = "Hello (World) This is (Working)";
    var i = 0;
    var outputs = [];
    while ((i = s.indexOf('(', i)) != -1) {
        var stop = s.indexOf(')', i);
        outputs.push(s.slice(i + 1, stop));
        i++;
    }
    document.write(outputs.join(' ')); // World Working
} 
```

**[演示](http://jsfiddle.net/t6PBp/)**

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-24T04:06:06.000

我发现 for 循环更具可读性。这是我的看法。

```
function myFunction() {
    var s = "Hello (World) This is (Working)";
    var output = false;
    for (i = 0; i <= s.length; i++) {
        if (s[i] == ')') {
            if (i != s.length) document.write(' ');
            output = false
        }
        if (output) document.write(s[i]);
        if (s[i] == '(') output = true;
    }
} 
```

[jsFiddle](http://jsfiddle.net/H6YBQ/)

# emacs - emacs 创建键修饰符

> ID：10730775
> 
> 赞同：4
> 
> 时间：2012-05-24T03:32:30.947
> 
> 标签：emacs, modifier-key

我在 mac os 上使用 emacs。我想将修饰符（Meta，Control，...）映射到一个简单的键。基本上这就是我需要的：`(global-set-key (kbd "a") 'hyper)` 这里 a 只是一个键，没有 Control-a 或其他什么，只有“a”，没有修饰符。例如，我希望“a”变得超级，但我找不到解决方案。

有人有线索吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-24T05:55:47.400

This approach won't make a modifier key in the sense that you press another key with the modifier held down, but it lets you use hyper bindings nevertheless.

By default you can utilise the additional modifier keys via the `C-x``@` prefix. See `C-x``@``C-h` for the full list.

These bindings are in `function-key-map`, and you can use the same method to get your own OS-independent bindings. e.g.:

```
(define-key function-key-map (kbd "C-c H") 'event-apply-hyper-modifier) 
```

`function-key-map` is the parent for all `local-function-key-map` instances. Note carefully:

> Entries in `local-function-key-map' are ignored if they conflict with bindings made in the minor mode, local, or global keymaps. I.e. the remapping only applies if the original key sequence would otherwise not have any binding.

`C-h``i``g` `(elisp) Translation Keymaps` `RET`

So ensure that you use a key sequence with no existing bindings. (In theory that's quite limiting, but YMMV.)

**Edit:** To clarify, this gives you a way to access any existing 'hyper' bindings when you are using a machine without a hyper modifier key, but does not actually create a new modifier key. If you have no existing bindings to access, this technique has no advantages over a regular prefix binding.

I believe it's the case that, as Peter commented, creating a genuine modifier key is an OS-level task. AFAIK when you press a modifier key on its own, Emacs does not receive any input, and when you press a non-modifier with a modifier, Emacs receives the (modified) input. Conversely when you press/hold a non-modifier key, Emacs receives input immediately, and has no way to combine that input with some other input and treat it all as a single (modified) event.

IIRC, `xmodmap` would be the typical mechanism for achieving this in Unix systems, so that may well be the case for OSX. The following links may help:

*   [http://computing.fnal.gov/docs/products/xemacs/v21_1/xemacs.info,.SuperandHyperKeys.html](http://computing.fnal.gov/docs/products/xemacs/v21_1/xemacs.info,.SuperandHyperKeys.html)
*   [http://www.emacswiki.org/emacs/XModMap](http://www.emacswiki.org/emacs/XModMap)
*   [http://www.emacswiki.org/emacs/MetaKeyProblems](http://www.emacswiki.org/emacs/MetaKeyProblems)

# java - 从属性文件中读取目录路径

> ID：10730776
> 
> 赞同：1
> 
> 时间：2012-05-24T03:32:31.787
> 
> 标签：java, file, properties

我需要知道如何从 java 中的 .properties 文件中读取目录路径。例如，

```
class clazz
{
string filename="d:/file.txt";
public void somemethod()
{
FileWriter f=new FileWriter(filename, true);
// etc
} 
```

我想从 .properties 文件而不是从变量中读取文件名。怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T03:42:27.150

查看[`Properties`类](http://docs.oracle.com/javase/6/docs/api/java/util/Properties.html) `load()`方法。它读入一个文件（以通用属性格式），然后您可以根据其名称查询属性的值

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T03:49:15.243

一个相当简单的方法是通过[`ResourceBundle`](http://docs.oracle.com/javase/7/docs/api/java/util/ResourceBundle.html)类使用资源文件。

```
ResourceBundle bundle = ResourceBundle.getBundle("com/file"); 
```

包里`com/file`在哪里**`file.properties`**。`com`

这个文件可能有这样的一行：

```
file.name=C:\dir\file.txt 
```

获取此特定数据。

```
String filename = bundle.getString("file.name"); 
```

我希望这可以帮助你。祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T03:54:16.933

如果属性文件在您的类路径中，请执行以下操作：

```
Properties prop = new Properties();
prop.load(this.getClass().getClassLoader().getResourceAsStream("file.txt"));
Sting fileName = prop.get("fileName"); 
```

# ruby-on-rails-3 - 茧，link_to_remove_association 与确认？

> ID：10730780
> 
> 赞同：4
> 
> 时间：2012-05-24T03:32:43.470
> 
> 标签：ruby-on-rails-3, cocoon-gem

有没有一种简单的方法可以添加当用户单击 link_to_remove_association 时会出现的确认对话框？

茧宝石真的很棒，我想知道它是否有这样一个现成的选择？？如果没有，我可以使用 jQuery 取消或放开事件吗？

谢谢，

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-02T06:47:44.380

你应该可以简单`<%= link_to_remove_association 'Remove', f, data: { confirm: 'Are you sure that you want to remove these nested fields?' } %>`，不是吗？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-02-15T19:31:13.550

```
 = link_to_remove_association "remove item", f,  data: {confirm: 'Are you sure?'} 
```

测试工作:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-29T19:42:51.067

我向删除链接添加了一个点击处理程序，并通过返回 false 来阻止事件传播。

```
$(".container").on('click',"a.remove_fields",function(){
  return confirm("Do you want to delete this?") ;
}); 
```

# gcc - 如何在配置中添加 -fvisibility=hidden

> ID：10730783
> 
> 赞同：0
> 
> 时间：2012-05-24T03:32:54.440
> 
> 标签：gcc, makefile, configure

在编译opencv项目时，我需要隐藏它们所有的接口，所以在为opencv生成Makefile时需要添加一个编译选项“-fvisibility=hidden”来配置。

问题是，如何添加编译选项来配置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T14:02:34.267

您是否尝试过设置 CFLAG，例如：

```
CFLAGS="-fvisibility=hidden" ./configure 
```

# c# - Visual Studio 2010 在调试时填充 ListBox 时速度极慢

> ID：10730784
> 
> 赞同：0
> 
> 时间：2012-05-24T03:32:56.297
> 
> 标签：c#, visual-studio-2010, visual-studio-debugging

在 VS2010 中进行调试时，程序的运行速度自然会比其他程序慢很多。

但是，如果我更新 ListBox 的值，最近我的程序运行速度非常慢。（其他控件也可能会受到影响，我不确定……但 ListBox 是肯定的）。

在调试器之外在几分之一秒内发生的操作，例如向 ListBox 添加 100 个元素，在 VS 中可能需要 3 到 5 分钟。

显然，这不是正常行为。

我不确定这从何时开始，但并非总是如此。它开始发生在几个月前。也许当我安装服务包时？我不确定。

当我查看进程时，msvsmon.exe 正在通过 CPU 咀嚼。

如果在某个地方我可能已经改变了导致这种情况的某些选项，有什么想法吗？我正在尝试使用包含 8,000 个元素的 ListBox 来调试某些东西，这完全是不可能的。

Windows 7 x64、4GB 内存、VS2010-SP1

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T03:55:47.410

> 是的，我可以在输出窗口中看到很多 System.InvalidCastExceptions

这就是导致速度变慢的原因，调试器在处理异常时会做很多工作。尤其是您现在使用的远程调试器，因为您的项目的平台目标是 AnyCPU，所以需要将通知消息添加到输出窗口并不便宜。

你不能忽视这个问题，它不仅仅是一个调试器神器。Debug + Exceptions，勾选 CLR Exceptions 的 Throw 框。抛出异常时，调试器现在将停止。您需要修复该代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T03:47:09.300

问题可能出在 VS2010 处理断点的方式上。看看这个链接：

*   [VS2010 Debug入口很慢](https://stackoverflow.com/questions/3249449/vs2010-debug-entry-very-slow)

两个有趣的注释：

> *   在调试开始时搜索符号通常很慢，特别是如果您配置了远程符号选项之一，并且没有在 MS 服务器上没有符号的各种 DLL 上设置“忽略”。

...

> *   是的，调试 64 位程序时将使用 msvsmon.exe。由于 Visual Studio 完全是 32 位的，因此需要远程调试器来弥补差距。... 可能会努力查找和加载 .pdb 文件。或者意外打开了混合模式调试选项，因此调试器还可以看到所有非托管 DLL 加载并为它们查找符号。这些当然只是猜测。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T03:53:44.507

另一个导致速度变慢的原因 - 条件断点，因为需要在每次命中断点时评估条件。在长循环中设置条件为“假”的断点会显着减慢调试速度。

# ios - iPhone Messages App 类似的收件人列表视图

> ID：10730785
> 
> 赞同：4
> 
> 时间：2012-05-24T03:33:12.897
> 
> 标签：ios, xcode

我正在尝试在 iOS 上创建一个消息编辑器视图，其中包括一个收件人列表，就像 iPhone 内置消息应用程序中的那样：

![在此处输入图像描述](../Images/8ea6394a0991d16cf89a3cae3403ecb2.png)

它看起来就像一个 UITextView，但是当您输入姓名或数字时，它会尝试匹配地址簿中的数据，一旦匹配，输入的文本将变为地址簿中的名称，并具有浅蓝色圆角矩形背景。

我已经检查了[weiSMS](http://code.google.com/p/weisms/)，但我担心源代码太旧而无法为 iOS 4/5 构建，只是想知道是否有任何框架/组件我可以重用，或者我可以学习如何做的任何其他资源从头开始。请给我一些指示，并在此先感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T03:37:05.967

当然！为什么，就在今天早些时候，我在 CocoaControls.com 上发现了这个[控件。](http://cocoacontrols.com/platforms/ios/controls/titokenfield)是的，这很粗糙，但我敢肯定，只要稍加调整，您就可以摆脱令牌的令人讨厌的浅蓝色默认背景。

# opencv - JavaCV-OpenCV MacOSX 10.7.4 x64

> ID：10730789
> 
> 赞同：1
> 
> 时间：2012-05-24T03:33:33.393
> 
> 标签：opencv, javacv

我已经尽一切可能解决这个错误，我能够在 Windows x86 中运行，但我无法在我的 MacOSX x64 中编译任何东西。

我已经使用 Xcode 和 port -v opencv +python27 选项安装了 OpenCV，所有链接路径都是正确的。我发现不同的一件事是在代码内部

```
public static final String genericIncludepath    = "/opt/local/include/";
public static final String genericLinkpath       = "/opt/local/lib/:/opt/local/lib64/:/usr/local/lib/:/usr/local/lib64/"; 
```

MacOSX 的 genericLinkpath 不包含 lib64。

哪些步骤将重现该问题？1\. 尝试运行 HoughLines 或任何示例

什么是预期的输出？你看到了什么呢？

线程“主”java.lang.UnsatisfiedLinkError 中的异常：/private/var/folders/qr/j3rwh4h15fncfqgff8__qvcw0000gn/T/libjniopencv_core2612287037709553365.dylib：库未加载：lib/libopencv_core.2.4.dylib 引用自：/private/var/folders/ qr/j3rwh4h15fncfqgff8__qvcw0000gn/T/libjniopencv_core2612287037709553365.dylib 原因：在 java.lang.ClassLoader$NativeLibrary.load(Native Method) at java.lang.ClassLoader.loadLibrary0(ClassLoader.java:1827) at java.lang.ClassLoader 找不到图像。 loadLibrary(ClassLoader.java:1703) 在 java.lang.Runtime.load0(Runtime.java:770) 在 java.lang.System.load(System.java:1020) 在 com.googlecode.javacpp.Loader.loadLibrary(Loader .java:403) 在 com.googlecode.javacpp.Loader.load(Loader.java:342) 在 com.googlecode.javacpp.Loader.load(Loader.java:316) 在 com.googlecode。javacv.cpp.opencv_core.(opencv_core.java:131) at java.lang.Class.forName0(Native Method) at java.lang.Class.forName(Class.java:247) at com.googlecode.javacpp.Loader.load (Loader.java:335) 在 com.googlecode.javacv.cpp.opencv_imgproc.(opencv_imgproc.java:96) 在 java.lang.Class.forName0(Native Method) 在 java.lang.Class.forName(Class.java: 247) 在 com.googlecode.javacpp.Loader.load(Loader.java:335) 在 com.googlecode.javacv.cpp.opencv_highgui.(opencv_highgui.java:91) 在 com.javacv.HoughLines.main(HoughLines.java: 32)forName0(Native Method) at java.lang.Class.forName(Class.java:247) at com.googlecode.javacpp.Loader.load(Loader.java:335) at com.googlecode.javacv.cpp.opencv_highgui.(opencv_highgui .java:91) 在 com.javacv.HoughLines.main(HoughLines.java:32)forName0(Native Method) at java.lang.Class.forName(Class.java:247) at com.googlecode.javacpp.Loader.load(Loader.java:335) at com.googlecode.javacv.cpp.opencv_highgui.(opencv_highgui .java:91) 在 com.javacv.HoughLines.main(HoughLines.java:32)

您使用的是什么版本的产品？在什么操作系统上？macOS X 10.7.4

$ java -version java version "1.6.0_31" Java(TM) SE Runtime Environment (build 1.6.0_31-b04-415-11M3646) Java HotSpot(TM) 64-Bit Server VM (build 20.6-b01-415, 混合模式) )

JAVACV——javacv-bin-20120512

echo $PATH /opt/local/include:/opt/local/bin:/opt/local/sbin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/usr/ X11/箱

$ ls | grep opencv opencv_createsamples opencv_haartraining opencv_performance opencv_traincascade

$ ls | grep opencv libopencv_calib3d.2.4.0.dylib libopencv_calib3d.2.4.dylib libopencv_calib3d.dylib libopencv_contrib.2.4.0.dylib libopencv_contrib.2.4.dylib libopencv_contrib.dylib libopencv_core.2.4.0.dylib libopencv_core.2.4.dylib libopencv_core.dylib libopencv_features2d .0.dylib libopencv_features2d.2.4.dylib libopencv_features2d.dylib libopencv_flann.2.4.0.dylib libopencv_flann.2.4.dylib libopencv_flann.dylib libopencv_gpu.2.4.0.dylib libopencv_gpu.2.4.dylib libopencv_gpu.dylib libopencv_highgui.2.4.0.dylib libopencv_high .2.4.dylib libopencv_highgui.dylib libopencv_imgproc.2.4.0.dylib libopencv_imgproc.2.4.dylib libopencv_imgproc.dylib libopencv_legacy.2.4.0.dylib libopencv_legacy.2.4.dylib libopencv_legacy.dylib libopencv_ml.2.4.0.dylib libopencv_ml.2.4.dylib libopencv_ml .dylib libopencv_nonfree.2.4.0.dylib libopencv_nonfree.2.4。

```
 System.out.println(System.getProperty("os.arch"));  x86_64
System.out.println(System.getProperty("sun.arch.data.model")); 64 
```

# asp.net - 网页中的 ASP.NET Excel 宏

> ID：10730790
> 
> 赞同：0
> 
> 时间：2012-05-24T03:33:42.303
> 
> 标签：asp.net, excel

我正在尝试从我的 ASP.NET 应用程序访问 Excel 宏。当我尝试在 Visual Studio 中本地运行它时，它工作得很好，但是一旦我将它部署到我的 IIS 网络服务器上，我就会收到以下错误：

![ASP.NET 错误](../Images/7d67dd8680d9dfaebedb5de8df6598b1.png)

我正在使用 Interop.Microsoft.Office.Interop.Excel.dll 类来访问 Excel 文件并像这样运行宏：

```
 // Create an instance of Microsoft Excel, make it visible, and open AquaticChemistry
    Excel.ApplicationClass oExcel = new Excel.ApplicationClass();
    oExcel.Visible = true;
    Excel.Workbooks oBooks = oExcel.Workbooks;
    Excel._Workbook oBook = null;

    String excelFile = Server.MapPath("AquaticChemistry_DrinkingWater.xlsm");

    oBook = oBooks.Open(excelFile, oMissing, oMissing,
        oMissing, oMissing, oMissing, oMissing, oMissing, oMissing, 
        oMissing, oMissing, oMissing, oMissing, oMissing, oMissing);

    // Run the macro Phreeqc
    RunMacro(oExcel, new Object[] { "RunPhreeqc", Server.MapPath("phreeqc_wt.dat") });

    // Save and quit Excel and clean up
    oBook.Save();
    oBook.Close(false, oMissing, oMissing); 
```

我试图让网络服务帐户访问 Excel 文件，但没有帮助。有什么建议么？

# html - 外部容器/内容图像的高度问题

> ID：10730792
> 
> 赞同：1
> 
> 时间：2012-05-24T03:33:52.007
> 
> 标签：html, css

嗨，我正在修改 Wordpress 主题，但在定位为内容中间部分提供边框的外部容器图像时遇到了一些问题。问题是背景图像没有随内容扩展，而是停在浏览器屏幕的底部。该网站位于：[http ://www.richmindonline.com/test](http://www.richmindonline.com/test)

我以前从未以这种方式构建背景图像，所以我为我对这个问题的幼稚表示歉意。

这是背景图像结构的 CSS id：

```
 #main {border:1px solid blue; width:900px; display:block; margin:0px auto;}

#container {
        width: 600px;
    float:left;
    border:0px solid red;
}

#content-before {
    border:0px solid yellow;
    content:"";
    position:absolute;
    display:block;
    top:150px;
    left:185px;
    bottom:0px;
    width:20px; 
    height:auto;
    background:url('/test/wp-content/themes/basic/assets/images/main-boxed-light.png') 0px 0px repeat-y;

}

#content {
width:590px;
    border:0px solid green;
    }

#primary {
float:right;
overflow: hidden;
width: 250px;
    border:1px solid brown;
}

#content-after {
    border:0px solid yellow;
    content:"";
    float:left;
    position:absolute;
    display:block;
    top:150px;
    left:1145px;
    bottom:0px; 
    width:20px; 
    height:auto;
    background:url('/test/wp-content/themes/basic/assets/images/main-boxed-light.png') -20px 0px repeat-y;
}

#footer {
clear: both;
width: 100%;
} 
```

这是我的 index.php HTML div 结构：

```
<?php get_header(); ?>

<div id="container">

  <div id="content-before"></div><!-- #content-before-->
         <div id="content">

             <?php /* Top post navigation */ ?>
             <?php global $wp_query; $total_pages = $wp_query->max_num_pages; if ( $total_pages > 1 ) { ?>
                <div id="nav-above" class="navigation">
                   <div class="nav-previous"><?php next_posts_link(__( '<span class="meta-nav">&laquo;</span> Older posts', 'your-theme' )) ?></div>
                   <div class="nav-next"><?php previous_posts_link(__( 'Newer posts <span class="meta-nav">&raquo;</span>', 'your-theme' )) ?></div>
                </div><!-- #nav-above --><?php } ?>

             <?php /* The Loop — with comments! */ ?>
             <?php while ( have_posts() ) : the_post() ?>
             <?php /* Create a div with a unique ID thanks to the_ID() and semantic classes with post_class() */ ?>
                <div id="post-<?php the_ID(); ?>" 
                    <?php post_class(); ?>>
                    <?php /* an h2 title */ ?>
                <h2 class="entry-title">
                    <a href="<?php the_permalink(); ?>" title="<?php printf( __('Permalink to %s', 'your-theme'), the_title_attribute('echo=0') ); ?>" rel="bookmark"><?php the_title(); ?></a>
                </h2> 

                     <?php /* Microformatted, translatable post meta */ ?>
                <div class="entry-meta">
                    <span class="meta-prep meta-prep-author"><?php _e('By ', 'your-theme'); ?></span>
                    <span class="author vcard"><a class="url fn n" href="<?php echo get_author_link( false, $authordata->ID, $authordata->user_nicename ); ?>" title="<?php printf( __( 'View all posts by %s', 'your-theme' ), $authordata->display_name ); ?>"><?php the_author(); ?></a></span>
                    <span class="meta-sep"> | </span>
                    <span class="meta-prep meta-prep-entry-date">
                          <?php _e('Published ', 'your-theme'); ?></span>
                    <span class="entry-date"><abbr class="published" title="<?php the_time('Y-m-d\TH:i:sO') ?>"><?php the_time( get_option( 'date_format' ) ); ?></abbr></span>
                          <?php edit_post_link( __( 'Edit', 'your-theme' ), "<span class=\"meta-sep\">|</span>\n\t\t\t\t\t\t<span class=\"edit-link\">", "</span>\n\t\t\t\t\t" ) ?>
                </div><!-- .entry-meta --> 

                          <?php /* The entry content */ ?>

                                 <div class="entry-content">
                                    <?php the_content( __( 'Continue reading <span class="meta-nav">&raquo;</span>', 'your-theme' )  ); ?>
                                    <?php wp_link_pages('before=<div class="page-link">' . __( 'Pages:', 'your-theme' ) . '&after=</div>');?>                                    </div><!-- .entry-content --> 

                                    <?php /* Microformatted category and tag links along with a comments link */ ?>

                <div class="entry-utility">
                    <span class="cat-links"><span class="entry-utility-prep entry-utility-prep-cat-links">
                        <?php _e( 'Posted in ', 'your-theme' ); ?></span><?php echo get_the_category_list(', '); ?>
                    </span>                        

                    <span class="meta-sep"> | </span>

                        <?php the_tags( '<span class="tag-links"><span class="entry-utility-prep entry-utility-prep-tag-links">' . __('Tagged ', 'your-theme' ) . '</span>', ", ", "</span>\n\t\t\t\t\t\t<span class=\"meta-sep\">|</span>\n" ) ?>
                    <span class="comments-link"><?php comments_popup_link( __( 'Leave a comment', 'your-theme' ), __( '1 Comment', 'your-theme' ), __( '% Comments', 'your-theme' ) ) ?></span>                

                        <?php edit_post_link( __( 'Edit', 'your-theme' ), "<span class=\"meta-sep\">|</span>\n\t\t\t\t\t\t<span class=\"edit-link\">", "</span>\n\t\t\t\t\t\n" ) ?>
                </div><!-- #entry-utility -->

            </div><!-- #post-<?php the_ID(); ?> --> <?php /* Close up the post div and then end the loop with endwhile */ ?>
   <?php endwhile; ?>

         <?php /* Bottom post navigation */ ?>
         <?php global $wp_query; $total_pages = $wp_query->max_num_pages; if ( $total_pages > 1 ) { ?>
            <div id="nav-below" class="navigation">
                <div class="nav-previous"><?php next_posts_link(__( '<span class="meta-nav">&laquo;</span> Older posts', 'your-theme' )) ?></div>
                <div class="nav-next"><?php previous_posts_link(__( 'Newer posts <span class="meta-nav">&raquo;</span>', 'your-theme' )) ?></div>
            </div><!-- #nav-below --><?php } ?>

         </div><!-- #content --> 

      <div id="content-after"></div>

    </div><!-- #container -->

     <div id="primary" class="widget-area">
    </div><!-- #primary .widget-area -->

<?php get_sidebar(); ?>
<div style="clear:both"></div>

<?php get_footer(); ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T05:23:07.430

您用于尝试将外部列拉伸到页面全长的 100% 的最小高度值不起作用，因为它返回浏览器窗口高度。

也许发布您的模板文件的代码以便我们可以轻松地查看您的 div 结构将有助于提供解决方案。

# arrays - Excel VBA：无法在数据透视表中设置数据透视表“（空白）”位置属性

> ID：10730793
> 
> 赞同：0
> 
> 时间：2012-05-24T03:34:18.497
> 
> 标签：arrays, excel, vba, pivot-table

Excel 数据透视表在 VBA 中编码是一件令人头疼的事情！

我想要一个循环遍历每个数据透视表的 VBA 代码，然后是数据透视字段，并且对于每个“（空白）”数据透视项目，将其移动到位置 1 或最后一个位置。

谢谢你的帮助！

```
For Each pt In ws.PivotTables

pt.RefreshTable
pt.PivotCache.MissingItemsLimit = xlMissingItemsNone

For Each pf In pt.PivotFields

For Each pi In pf.PivotItems

If pi.Caption = "(blank)" Then

pi.position = 1 ' <-- Error 2024, not available? 

If pi.Visible = True Then
pi.Visible = False
End if 

Exit For
End If

Next pi 
Next pf
Next pt 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T05:06:41.713

在我有限的测试中，这是没有错误的并且有效：

```
Sub HideAndMoveTheBlanks()

Dim pt As Excel.PivotTable
Dim pf As Excel.PivotField
Dim pi As Excel.PivotItem

For Each pt In ws.PivotTables
    pt.RefreshTable
    pt.PivotCache.MissingItemsLimit = xlMissingItemsNone
    For Each pf In pt.PivotFields
        On Error Resume Next
        Set pi = pf.PivotItems("(blank)")
        On Error GoTo 0
        If Not pi Is Nothing Then
            pi.Position = 1
            pi.Visible = False
            Set pi = Nothing
            Exit For
        End If
    Next pf
Next pt
End Sub 
```

# opencv - Having some difficulty in image stitching using OpenCV

> ID：10730794
> 
> 赞同：1
> 
> 时间：2012-05-24T03:34:20.180
> 
> 标签：opencv, homography, image-stitching

I'm currently working on Image stitching using OpenCV 2.3.1 on Visual Studio 2010, but I'm having some trouble.

**Problem Description** I'm trying to write a code for stitching multiple images derived from a few cameras(about 3~4), i,e, the code should keep executing image stitching until I ask it to stop.

The following is what I've done so far: (For simplification, I'll replace some part of the code with just a few words)

```
 1.Reading frames(images) from 2 cameras (Currently I'm just working on 2 cameras.)
     2.Feature detection, descriptor calculation (SURF)
     3.Feature matching using FlannBasedMatcher
     4.Removing outliers and calculate the Homography with inliers using RANSAC.
     5.Warp one of both images. 
```

For step 5., I followed the answer in the following thread and just changed some parameters: [Stitching 2 images in opencv](https://stackoverflow.com/questions/8205835/stitching-2-images-in-opencv)

However, the result is terrible though. I just uploaded the result onto youtube and of course only those who have the link will be able to see it.

[http://youtu.be/Oy5z_7LeaMk](http://youtu.be/Oy5z_7LeaMk)

My code is shown below: (Only crucial parts are shown)

```
VideoCapture cam1, cam2;
cam1.open(0);
cam2.open(1);

while(1)
{
    Mat frm1, frm2;

    cam1 >> frm1;
    cam2 >> frm2;

   //(SURF detection, descriptor calculation 
   //and matching using FlannBasedMatcher)

    double max_dist = 0; double min_dist = 100;

    //-- Quick calculation of max and min distances between keypoints
    for( int i = 0; i < descriptors_1.rows; i++ )
    { 
        double dist = matches[i].distance;
        if( dist < min_dist ) min_dist = dist;
        if( dist > max_dist ) max_dist = dist;
    }

    (Draw only "good" matches 
    (i.e. whose distance is less than 3*min_dist ))            

    vector<Point2f> frame1;
    vector<Point2f> frame2;

    for( int i = 0; i < good_matches.size(); i++ )
    {
      //-- Get the keypoints from the good matches
      frame1.push_back( keypoints_1[ good_matches[i].queryIdx ].pt );
      frame2.push_back( keypoints_2[ good_matches[i].trainIdx ].pt ); 
    }
    Mat H = findHomography( Mat(frame1), Mat(frame2), CV_RANSAC );
    cout << "Homography: " << H << endl;

    /* warp the image */
    Mat warpImage2;
    warpPerspective(frm2, warpImage2, 
    H, Size(frm2.cols, frm2.rows), INTER_CUBIC); 

    Mat final(Size(frm2.cols*3 + frm1.cols, frm2.rows),CV_8UC3); 

    Mat roi1(final, Rect(frm1.cols, 0, frm1.cols, frm1.rows)); 
    Mat roi2(final, Rect(2*frm1.cols, 0, frm2.cols, frm2.rows)); 

    warpImage2.copyTo(roi2); 
    frm1.copyTo(roi1); 
    imshow("final", final); 
```

What else should I do to make the stitching better?

Besides, is it reasonable to make the Homography matrix fixed instead of keeping computing it ? What I mean is to specify the angle and the displacement between the 2 cameras by myself so as to derive a Homography matrix that satisfies what I want.

Thanks. :)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T07:36:03.730

It sounds like you are going about this sensibly, but if you have access to both of the cameras, and they will remain stationary with respect to each other, then calibrating offline, and simply applying the transformation online will make your application more efficient.

One point to note is, you say you are using the [findHomography](http://opencv.itseez.com/modules/calib3d/doc/camera_calibration_and_3d_reconstruction.html#findhomography) function from OpenCV. From the documentation, this function:

```
Finds a perspective transformation between two planes. 
```

However, your points are not restricted to a specific plane as they are imaging a 3D scene. If you wanted to calibrate offline, you could image a chessboard with both cameras, and the detected corners could be used in this function.

Alternatively, you may like to investigate the Fundamental matrix, which can be calculated with a [similar function](http://opencv.itseez.com/modules/calib3d/doc/camera_calibration_and_3d_reconstruction.html#findfundamentalmat). This matrix describes the relative position of the cameras, but some work (and a good textbook) will be required to extract them.

If you can find it, I would strongly recommend having a look at Part II: "Two-View Geometry" in the book "Multiple View Geometry in computer vision", by Richard Hartley and Andrew Zisserman, which goes through the process in detail.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T09:06:12.063

I have been working lately on image registration. My algorithm takes two images, calculates the SURF features, find correspondences, find homography matrix and then stitch both images together, I did it with the next code:

```
void stich(Mat base, Mat target,Mat homography, Mat& panorama){

Mat corners1(1, 4,CV_32F);
Mat corners2(1,4,CV_32F);
Mat corners(1,4,CV_32F);
vector<Mat> planes;
/* compute corners 
of warped image
*/
corners1.at<float>(0,0)=0;
corners2.at<float>(0,0)=0;
corners1.at<float>(0,1)=0;
corners2.at<float>(0,1)=target.rows;
corners1.at<float>(0,2)=target.cols;
corners2.at<float>(0,2)=0;
corners1.at<float>(0,3)=target.cols;
corners2.at<float>(0,3)=target.rows;

planes.push_back(corners1);
planes.push_back(corners2);

merge(planes,corners);

perspectiveTransform(corners, corners, homography);

/* compute size of resulting 
image and allocate memory
*/
double x_start = min( min( (double)corners.at<Vec2f>(0,0)[0], (double)corners.at<Vec2f> (0,1)[0]),0.0);
double x_end   = max( max( (double)corners.at<Vec2f>(0,2)[0], (double)corners.at<Vec2f>(0,3)[0]), (double)base.cols);
double y_start = min( min( (double)corners.at<Vec2f>(0,0)[1], (double)corners.at<Vec2f>(0,2)[1]), 0.0);
double y_end   = max( max( (double)corners.at<Vec2f>(0,1)[1], (double)corners.at<Vec2f>(0,3)[1]), (double)base.rows);

/*Creating image
with same channels, depth
as target
and proper size
*/
panorama.create(Size(x_end - x_start + 1, y_end - y_start + 1), target.depth());

planes.clear();

/*Planes should
have same n.channels
as target
*/
for (int i=0;i<target.channels();i++){
planes.push_back(panorama);
}

merge(planes,panorama);
    // create translation matrix in order to copy both images to correct places
Mat T;
T=Mat::zeros(3,3,CV_64F);
T.at<double>(0,0)=1;
T.at<double>(1,1)=1;
T.at<double>(2,2)=1;
T.at<double>(0,2)=-x_start;
T.at<double>(1,2)=-y_start;

// copy base image to correct position within output image

 warpPerspective(base, panorama, T,panorama.size(),INTER_LINEAR| CV_WARP_FILL_OUTLIERS);
 // change homography to take necessary translation into account
gemm(T, homography,1,T,0,T);
    // warp second image and copy it to output image
warpPerspective(target,panorama, T, panorama.size(),INTER_LINEAR);
 //tidy
corners.release();
T.release();

} 
```

Any question I will try

# python - 外部库包到 python 项目

> ID：10730795
> 
> 赞同：0
> 
> 时间：2012-05-24T03:34:32.020
> 
> 标签：python, svn

我正在尝试使用 SVN 来管理我的 python 项目。我在计算机A上安装了许多外部库（路径如下：）`"C:\Python27\Lib\site-packages"`，然后我将项目上传到SVN服务器。然后我使用刚刚安装了python（v2.7）的计算机B。我从SVN服务器结帐

:问题来了..电脑B没有外部库.有没有解决这个问题的方法,我不想再在电脑B上安装外部库了！

提前谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T03:36:33.253

处理这个问题的普通 Python 方法是使用[pip](http://www.pip-installer.org/)和[需求文件](http://www.pip-installer.org/en/latest/requirements.html)。[virtualenv](http://www.virtualenv.org/)也很常用，它允许您安装多组安装包。

例如，如果您有一个项目依赖于[Werkzeug](http://werkzeug.pocoo.org/)[`itsdangerous`](http://packages.python.org/itsdangerous/)的任何版本和0.9 以上的任何版本，您可以拥有以下需求文件：

```
Werkzeug>=0.9
itsdangerous 
```

您通常会将其存储在名为`requirements.txt`. 然后，您将像这样安装软件包：

```
pip install -r requirements.txt 
```

`pip`将找到所有尚未安装的软件包并安装它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T03:45:27.893

您实际上可以将包源代码从站点包复制到您的项目文件夹，并且您的项目文件夹通常比站点包具有更高的优先级。

然后你只需要签入库到你的 svn。

# ios - 我是否必须使用 sdk 5.1 将 xcode 升级到 4.3.2 才能在 ios 5.1 上分发应用程序？

> ID：10730808
> 
> 赞同：2
> 
> 时间：2012-05-24T03:36:15.297
> 
> 标签：ios, xcode

我的 xcode 是 4.2.5。我现在不想升级 xcode，因为我读到 xcode 4.3.2 有一些问题。

我知道有必要升级 xcode 以在 5.1 设备上测试，但我只是想知道 sdk 5.0 编译的发布版本是否可以在 5.1 设备上运行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T03:50:44.130

不，它不能。您必须使用至少与目标相同的版本号进行编译。

*编辑*等等，我应该说它会**运行**，但你将无法调试它。所以我想答案实际上是肯定的，因为我再次阅读了这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T01:19:09.517

如果不升级到最新版本的 XCode（也需要 OSX Lion），您将无法构建到运行 5.1 的设备。

但是，如果您将应用提交到应用商店，运行 5.1 的用户仍然可以下载它。如果代码中有特定于 5.1 的错误，它很可能会崩溃，但用户可以安装它。

# php - PHP文件上传/主机系统

> ID：10730813
> 
> 赞同：1
> 
> 时间：2012-05-24T03:36:39.617
> 
> 标签：php

我目前制作了一个脚本，允许在我们公司内上传文件。我正在寻找改进此脚本以允许在下载链接中隐藏上传文件的目录（真的不希望人们知道目录结构）有没有办法可以对链接进行编码，然后一旦成功上传使我们的客户可以下载屏蔽的 URL。

```
 <?php 
 $target = "upload/"; 
 $target = $target . basename( $_FILES['uploaded']['name']) ; 
 $ok=1; 

 //This is our size condition 
 if ($uploaded_size > 350000) 
 { 
 echo "Your file is too large.<br>"; 
 $ok=0; 
 } 

 //This is our limit file type condition 
 if ($uploaded_type =="text/php") 
 { 
 echo "No PHP files<br>"; 
 $ok=0; 
 } 

 //Here we check that $ok was not set to 0 by an error 
 if ($ok==0) 
 { 
 Echo "Sorry your file was not uploaded"; 
 } 

 //If everything is ok we try to upload it 
 else 
 { 
 if(move_uploaded_file($_FILES['uploaded']['tmp_name'], $target)) 
 { 
 echo "The file ". basename( $_FILES['uploadedfile']['name']). " has been uploaded"; 
 } 
 else 
 { 
 echo "Sorry, there was a problem uploading your file."; 
 } 
 } 
 ?> 
```

多谢你们 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T03:42:31.923

我不会给你代码，但这是我在不泄露位置的情况下实现文件共享的策略。

1.  创建一个将要检索的文件的名称作为参数的文件。它的唯一目的是打开文件并将其流式传输。它应该提前知道如何处理文件，在哪里查找它，以及如何返回它（流）。让我们称之为`getFile($filename)`

2.  在您的主 PHP 文件中，调用该函数并将结果存储在一个变量中：

    $file = getFile($_POST['filename']);

现在将文件发送给用户，他将不知道它的来源。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T03:46:26.493

您可以制作一个文件反弹的脚本。它只接受文件名作为参数。就像是：

下载.php?file=myfile.txt

这样你就不用说你把文件放在哪里了，而且很容易实现。您可以添加标题以实际下载文件。

# ruby-on-rails - 在同一个脚本上运行两个不同的解释器

> ID：10730815
> 
> 赞同：1
> 
> 时间：2012-05-24T03:37:01.693
> 
> 标签：ruby-on-rails, ruby, ironruby

我有一个用 Ironruby 编写的脚本，它使用 C# .dll 来检索哈希。然后，我在其余的 Ruby 代码中使用该哈希。我宁愿不在 Ironruby 解释器上运行我的整个脚本。有没有办法在 IR 解释器上运行一段代码，获取哈希值，然后通过常规的 Ruby 解释器执行其余代码？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T18:55:55.307

一种可能的解决方案是将脚本分成两部分，由 Iron ruby​​ 执行的第一部分必须将其状态保存在 yaml 文件中，然后再将控制权交给将由 ruby​​ 运行的第二部分

这里有一个小演示：

```
C:\devkit\home\demo>demo
"running program:demo_ir.rb"
"the first part of the script running by the iron_ruby interpreter"
"my_hash attributes:"
"attr1: first value"
"attr2: second value"
"attr3: 2012"
"hash_store_filename:temp.yaml"
"running program:demo_ruby.rb"
"hash_store_filename:temp.yaml"
"the second part of the script running by ruby 1.8.x interpreter"
"my_hash attributes:"
"attr1: first value"
"attr2: second value"
"attr3: 2012" 
```

这里是 ironruby (demo_ir.rb) 第一部分的来源：

```
require "yaml"
p "running program:#{$0}"
hash_store_filename = ARGV[0]

my_hash = { attr1: 'first value', attr2: 'second value', attr3: 2012}

p "the first part of the script running by the iron_ruby interpreter" 
p "my_hash attributes:"
p "attr1: #{my_hash[:attr1]}"
p "attr2: #{my_hash[:attr2]}"
p "attr3: #{my_hash[:attr3]}"

# save the state of the script in an array where my_hash is the first element
p "hash_store_filename:#{hash_store_filename}"
File.open( hash_store_filename, 'w' ) do |out|
  YAML.dump( [my_hash], out )
end 
```

这里是 ruby​​ 1.8 (demo_ruby.rb) 第二部分的代码

```
require "yaml"
p "running program:#{$0}"
hash_store_filename = ARGV[0]
p "hash_store_filename:#{hash_store_filename}"
ar = YAML.load_file(hash_store_filename)
my_hash=ar[0]

p "the second part of the script running by ruby 1.8.x interpreter"
p "my_hash attributes:"
p "attr1: #{my_hash[:attr1]}"
p "attr2: #{my_hash[:attr2]}"
p "attr3: #{my_hash[:attr3]}" 
```

和发射器：

```
@ECHO OFF
REM file: demo.bat
SET TEMP_YAML=temp.yaml
ir demo_ir.rb %TEMP_YAML%
ruby demo_ruby.rb %TEMP_YAML%
del %TEMP_YAML% 
```

如果您在并发环境中运行脚本，您可以在 Ironruby 脚本中生成 yaml 文件的唯一临时名称，从而避免两个进程（或线程）尝试写入同一个文件。

如果您愿意，可以使用一些 C# 代码行而不是 .bat 来集成脚本的两个部分，但这有点困难（恕我直言）

我使用以下方法成功测试了此解决方案：

```
C:\devkit\home\demo>ir -v
IronRuby 1.1.3.0 on .NET 4.0.30319.239

C:\devkit\home\demo>ruby -v
ruby 1.8.7 (2011-12-28 patchlevel 357) [i386-mingw32] 
```

询问您是否需要澄清

# ruby - 从 rvm 更新 ruby 1.9.3 时的 configure.log 问题

> ID：10730821
> 
> 赞同：0
> 
> 时间：2012-05-24T03:38:04.313
> 
> 标签：ruby, rvm

我已经安装了最新的 Xcode，但这一直在发生。我该如何解决这个问题？

```
Fetching yaml-0.1.4.tar.gz to /Users/dmonkeys/.rvm/archives
Extracting yaml-0.1.4.tar.gz to /Users/dmonkeys/.rvm/src
Error running 'tar xmzf /Users/dmonkeys/.rvm/archives/yaml-0.1.4.tar.gz -C /Users/dmonkeys/.rvm/src ', please read /Users/dmonkeys/.rvm/log/ruby-1.9.3-p194/yaml/extract.log
Configuring yaml in /Users/dmonkeys/.rvm/src/yaml-0.1.4.
Error running ' ./configure --prefix="/Users/dmonkeys/.rvm/usr"  ', please read /Users/dmonkeys/.rvm/log/ruby-1.9.3-p194/yaml/configure.log
Compiling yaml in /Users/dmonkeys/.rvm/src/yaml-0.1.4.
Error running 'make ', please read /Users/dmonkeys/.rvm/log/ruby-1.9.3-p194/yaml/make.log

Database file /Users/dmonkeys/.rvm/config/packages does not exist.

Installing Ruby from source to: /Users/dmonkeys/.rvm/rubies/ruby-1.9.3-p194, this may take a while depending on your cpu(s)...

ruby-1.9.3-p194 - #fetching 
ruby-1.9.3-p194 - #extracted to /Users/dmonkeys/.rvm/src/ruby-1.9.3-p194 (already extracted)
ruby-1.9.3-p194 - #configuring 
Error running ' ./configure --prefix=/Users/dmonkeys/.rvm/rubies/ruby-1.9.3-p194 --enable-shared --disable-install-doc --with-libyaml --with-opt-dir=/Users/dmonkeys/.rvm/usr ', please read /Users/dmonkeys/.rvm/log/ruby-1.9.3-p194/configure.log
There has been an error while running configure. Halting the installation.
ls: /Users/dmonkeys/.rvm/rubies/*/bin/ruby: No such file or directory 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T07:29:25.697

看起来缺少开发工具，阅读输出（并遵循说明）：

```
rvm requirements 
```

最重要的是，`make`您可以使用 osx-gcc-installer 获得它。

对于全新安装，一个选项也是[OSX 的 RailsInstaller](https://github.com/railsinstaller/railsinstaller-nix/downloads)

# android - Android 开发 - 通过 ADB 连接平板电脑无法识别

> ID：10730825
> 
> 赞同：0
> 
> 时间：2012-05-24T03:38:21.690
> 
> 标签：android, debugging, adb

我有一台新的笔记本电脑进行开发，我一直在尝试设置我的旧 eclipse 开发环境以重新开始（哦，太恐怖了！）。

无论如何，我一直在我的旧笔记本电脑上开发这款特殊的 Asus Transformer 平板电脑，可以进行 USB 调试，但现在我的新笔记本电脑无法识别它。我去 android-sdk/platform-tools，运行“adb devices”却一无所获。

我试过做“adb kill-server”和“adb start-server”，但没有任何区别。

任何人都能够解决这个问题？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T03:41:26.873

您需要变压器的[USB 驱动程序。](http://www.asus.com/Eee/Eee_Pad/Eee_Pad_Transformer_TF101/#download)

# asp.net - 在 ASP.NET Razor 视图中以可配置的顺序呈现字段

> ID：10730829
> 
> 赞同：1
> 
> 时间：2012-05-24T03:38:40.490
> 
> 标签：asp.net, asp.net-mvc-3, razor

我需要允许客户从一组固定的字段（地址、家庭电话、SSN、名字等）中指定以何种顺序绘制哪些字段

对此的最佳做法是什么？我觉得像“DrawField”这样的 HTML 辅助方法是合适的，但是我可以在 HTML 辅助方法的主体中使用 Html.EditorFor 之类的辅助方法吗？当modelstate有错误并且我重新显示表单时，提交的值和错误是否会被填充？

“最安全”的方法似乎是一个丑陋的大循环：

```
foreach( Field f in FieldList)
{
   if(f.Key == FieldKey.FirstName)
   {
       @Html.LabelFor(model => model.FirstName, StringResource("firstNameLabel"))
       @Html.EditorFor(model => model.FirstName)
       @Html.ValidationMessageFor(model => model.FirstName)
       <br />
   }

   if(f.Key == FieldKey.LastName)
   {
      ......
   }
} 
```

一定有更好的办法！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T03:47:35.627

由于字段列表是固定的，我只需在控制器中对其进行排序，并且视图中只有 n 个区域，这些区域将按照字段到达模型的顺序呈现字段。我会构建模型，使其包含相同对象的列表，但每个对象的内容会有所不同（名字、姓氏等）。您可以将所需的任何元数据添加到模型中

```
@Html.LabelFor(model => model.Items[0].Prop, StringResource(model.Items[0].PropName))
@Html.EditorFor(model => model.Items[0].Prop) 
```

……

这样你就不需要任何条件或循环。相反，它是由数据驱动的 n 个通用区域

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T04:12:43.847

虽然我没有尝试过，但您可以尝试为负责对字段进行排序的模型创建自定义编辑器/显示模板。

要了解有关模型模板的基本概念，请查看此链接[http://bradwilson.typepad.com/blog/2009/10/aspnet-mvc-2-templates-part-1-introduction.html](http://bradwilson.typepad.com/blog/2009/10/aspnet-mvc-2-templates-part-1-introduction.html)

**更新：**

我试过一个简单的例子。我们有一个`Person`模型，我想控制`FirstName`and`LastName`的显示顺序。

```
public class Person
{
[Required(ErrorMessage = "The field is required")]
[Display(Name = "First Name:")]
public string FirstName { get; set; }

[Required(ErrorMessage = "The field is required")]
[Display(Name = "Last Name:")]
public string LastName { get; set; }
} 
```

创建自定义编辑器模板`Person.cshtml`并将其放置在`Views/Shared`文件夹中。因此，每当您调用此模板的`EditorFor`方法 时，`Person`都会使用该模板进行渲染。为简单起见，我将它们必须显示为字段数组的顺序传递给`ViewBag`.

```
@model RazorAndJson.Models.Person
@{
  var fields = ViewBag.FieldsOrder != null 
  ? ViewBag.FieldsOrder 
  : new[] { "FirstName", "LastName" };
}
@foreach(string field in fields)
{
    <p>
         @Html.Label(field)
         @Html.Editor(field)
         @Html.ValidationMessage(field)
    </p>
} 
```

# php - 是否可以直接从命令行访问（读取：查询）xml 数据服务提供者（REST 或 SOAP）？如果是这样，怎么做？

> ID：10730831
> 
> 赞同：0
> 
> 时间：2012-05-24T03:38:59.117
> 
> 标签：php, ruby, xml, command-line, dynamic-data

如果这实际上是一个新手问题，请原谅这个问题的新手，也许如果它不存在它可能有朝一日，但已经感谢您的时间。我只是想学习如何访问我的网站的动态数据。

如果这些（命令行可访问）服务确实存在，我认为这是值得怀疑的，我正在寻找动态（外部存储）金融和经济数据提供者。

编辑：啊！伟大的。- 我在不同的计算机上同时运行 mac osx lion 和 windows vista。我喜欢 ruby​​ on rails，而且我正在使用的初创公司使用 php，所以这也没关系。除此之外，就验证过程而言，老实说，我还没有那么远。我将首先尝试访问的数据可能是开源的（出于学术目的免费等），如果有帮助，则来自 Google 或 Bloomberg Open。不过已经谢谢了——Ruby on Rails 在 Windows 上运行速度非常慢，所以我大部分时间都使用 Mac。

编辑：是否有任何 IDE（或 IDE 插件）能够执行 Alexei 所描述的操作？

编辑：我可能会尝试通过我的入门应用程序的 REST API 访问 Google Docs。但我仍然有兴趣尝试通过命令行和/或 IDE 访问它和任何其他 REST 源！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T03:50:09.263

可以通过发出 HTTP 请求来访问 REST/SOAP 服务。在所有操作系统上都有很多工具可以做到这一点。从用于准系统通信的 telnet 到为大多数平台提供解析响应（如 Python/Ruby/JavaScript）的脚本语言，PowerShell 脚本可能是 Windows 环境的最佳选择。

要获得更具体的建议，您需要在问题中获得更多详细信息（操作系统、您喜欢的语言、服务使用的身份验证......）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T07:35:54.867

该`curl`命令将 URL 作为其参数并发出 HTTP GET 以获取该地址处的资源。如果该 HTTP 请求访问 REST Web 服务，那么它会显示来自该服务的响应。您当然可以以此为起点。

# python - 将两个列表（一个作为键，一个作为值）合并到 Python 中的 dict 中

> ID：10730836
> 
> 赞同：5
> 
> 时间：2012-05-24T03:39:58.883
> 
> 标签：python, list, dictionary

Python中是否有任何**内置**函数可以将两个列表合并为一个字典？像：

```
combined_dict = {}

keys = ["key1","key2","key3"] 

values = ["val1","val2","val3"]

for k,v in zip(keys,values):
    combined_dict[k] = v 
```

在哪里：

`keys`充当包含键的列表。

`values`充当包含值的列表

有一个名为[array_combine](http://php.net/manual/en/function.array-combine.php)的函数可以实现这种效果。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-24T03:42:41.220

似乎这应该有效，但我想这不是*一个*单一的功能：

```
dict(zip(["key1","key2","key3"], ["val1","val2","val3"])) 
```

从这里：[如何在 Python 中将两个列表组合成字典？](https://stackoverflow.com/questions/7271385/how-do-i-combine-two-lists-into-a-dictionary-in-python)

# c - 如何从单个流程实例创建多个网络命名空间

> ID：10730838
> 
> 赞同：20
> 
> 时间：2012-05-24T03:40:58.723
> 
> 标签：c, linux, networking, network-programming, linux-namespaces

我正在使用以下 C 函数从**单个流程实例创建****多个网络命名空间**：

 **```
void create_namespace(const char *ns_name)
{
    char ns_path[100];

    snprintf(ns_path, 100, "%s/%s", "/var/run/netns", ns_name);
    close(open(ns_path, O_RDONLY|O_CREAT|O_EXCL, 0));
    unshare(CLONE_NEWNET);
    mount("/proc/self/ns/net", ns_path, "none", MS_BIND , NULL);
} 
```

在我的进程创建了所有命名空间并将一个*tap*接口添加到任何一个网络命名空间（使用`ip link set tap1 netns ns1`命令）之后，我实际上在所有命名空间中都看到了这个接口（大概，这实际上是一个使用不同名称的单个命名空间）。

但是，如果我使用多个进程创建多个命名空间，那么一切正常。

这里有什么问题？我是否必须将任何其他标志传递`unshare()`给 才能从单个流程实例中工作？是否存在单个流程实例不能创建多个网络命名空间的限制？还是调用有问题`mount()`，因为`/proc/self/ns/net`实际挂载了多次？

**更新：** 似乎该`unshare()`函数正确地创建了多个网络命名空间，但`/var/run/netns/`实际上所有挂载点都引用了该目录中挂载的第一个网络命名空间。

**Update2：** 似乎最好的方法是 fork() 另一个进程并从那里执行 create_namespace() 函数。无论如何，我很高兴听到一个不涉及 fork() 调用的更好的解决方案，或者至少得到一个确认，证明不可能从单个进程创建和管理多个网络命名空间。

**Update3：** 我可以使用以下代码使用 unshare() 创建多个命名空间：

```
int  main() {
    create_namespace("a");
    system("ip tuntap add mode tap tapa");
    system("ifconfig -a");//shows lo and tapA interface
    create_namespace("b");
    system("ip tuntap add mode tap tapb");
    system("ifconfig -a");//show lo and tapB interface, but does not show tapA. So this is second namespace created.
} 
```

但是在进程终止并且我执行之后`ip netns exec a ifconfig -a`，`ip netns exec b ifconfig -a`似乎两个命令都突然在命名空间*a*中执行了。所以实际的问题是存储对命名空间的引用（或以正确的方式调用 mount()。但我不确定这是否可能）。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-05-30T09:50:27.877

[根据设计，](http://lwn.net/Articles/239625/)[网络命名空间](http://lwn.net/Articles/219597/)是通过调用**clone**创建的，并且可以在**unshare**之后对其进行修改。请注意，即使您确实使用**unshare**创建了一个新的网络命名空间，实际上您也只是修改了正在运行的进程的网络堆栈。**unshare**无法修改其他进程的网络堆栈，因此您将无法仅使用**unshare**创建另一个。

为了工作，一个新的网络命名空间需要一个新的网络堆栈，因此它需要一个新的进程。就这样。

好消息是它可以使用**clone**变得非常轻量级，[请参阅](http://lxc.sourceforge.net/doc/sigops/appcr.pdf)：

> **Clone()**与 UNIX 中传统的**fork()**系统调用不同，它允许父进程和子进程选择性地共享或复制资源。

您只能在此网络堆栈上转移（并避免内存空间、文件描述符表和信号处理程序表）。您的新网络进程可以更像一个*线程*而不是真正的**分叉**。

您可以使用 C 代码或 Linux 内核和/或 LXC 工具来操作它们。

例如，要将设备添加到新的网络命名空间，它很简单：

```
echo $PID > /sys/class/net/ethX/new_ns_pid 
```

有关可用 CLI 的更多信息，请参阅[此页面。](http://lxc.sourceforge.net/index.php/about/kernel-namespaces/network/)

在 C 端，可以查看 lxc-unshare 实现。如您[所见](http://lxc.git.sourceforge.net/git/gitweb.cgi?p=lxc/lxc;a=blob;f=src/lxc/lxc_unshare.c;h=0baccb007dfa52c1b2f530199fdb176504ebdfb1;hb=00ad19d4dba5c05401125d4217dc8f4e7fd9403a#l202)（lxc_clone is [here](http://lxc.git.sourceforge.net/git/gitweb.cgi?p=lxc/lxc;a=blob;f=src/lxc/namespace.c;h=3e6fc3aad54f842ab16d35bc3d8521c65e973d7b;hb=00ad19d4dba5c05401125d4217dc8f4e7fd9403a#l50)） ，尽管它的名字使用了*clone 。*也可以看[LTP implementation](http://ltp.cvs.sourceforge.net/viewvc/ltp/ltp/testcases/kernel/containers/netns/two_children_ns.c?revision=1.3&content-type=text/plain)，作者选择直接使用fork。

**编辑**：您可以使用一个技巧使它们持久化，但您仍然需要分叉，即使是暂时的。

看看这段[ipsource2](http://kernel.org/pub/linux/utils/net/iproute2/)的代码（为了清楚起见，我删除了错误检查）：

```
snprintf(netns_path, sizeof(netns_path), "%s/%s", NETNS_RUN_DIR, name);

/* Create the base netns directory if it doesn't exist */
mkdir(NETNS_RUN_DIR, S_IRWXU|S_IRGRP|S_IXGRP|S_IROTH|S_IXOTH);

/* Create the filesystem state */
fd = open(netns_path, O_RDONLY|O_CREAT|O_EXCL, 0);
[...]
close(fd);
unshare(CLONE_NEWNET);
/* Bind the netns last so I can watch for it */
mount("/proc/self/ns/net", netns_path, "none", MS_BIND, NULL) 
```

如果您在分叉的进程中执行此代码，您将能够随意创建新的网络命名空间。为了删除它们，您可以简单地卸载并删除此绑定：

```
umount2(netns_path, MNT_DETACH);
if (unlink(netns_path) < 0) [...] 
```

**EDIT2：**另一个（肮脏的）技巧是简单地使用**system**执行“ip netns add ..”cli 。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-06-04T13:10:29.120

`/proc/*/ns/*`如果您需要从另一个进程访问这些命名空间，或者需要获取句柄以便能够在两者之间来回切换，您只需要绑定 mount 。不需要使用来自单个进程的多个命名空间。

*   unshare*确实*创建了新的命名空间。
*   默认情况下，clone 和 fork 不会创建任何新的命名空间。
*   每种类型都有一个“当前”命名空间分配给一个进程。可以通过 unshare 或 setns 更改。一组命名空间（默认情况下）由子进程继承。

每当您执行 open( `/proc/N/ns/net`) 时，它都会为该文件创建 inode，并且所有后续 open() 将返回绑定到同一名称空间的文件。细节在内核目录缓存的深处丢失。

此外，每个进程只有一个`/proc/self/ns/net`文件条目，并且绑定挂载不会创建此 proc 文件的新实例。打开这些挂载的文件与直接打开 文件*完全相同*`/proc/self/ns/net`（它将继续指向它在您第一次打开它时指向的命名空间）。

看来“ `/proc/*/ns`”是这样半生不熟的。

因此，如果您只需要 2 个命名空间，您可以：

*   打开`/proc/1/ns/net`
*   取消分享
*   打开`/proc/self/ns/net`

并在两者之间切换。

对于超过 2，您可能需要`clone()`. `/proc/N/ns/net`似乎没有办法为每个进程创建多个文件。

但是，如果您不需要在运行时在命名空间之间切换，或者与其他进程共享它们，您可以使用许多命名空间，如下所示：

*   打开套接字并为主命名空间运行进程。
*   取消分享
*   打开套接字并为第二个命名空间（netlink、tcp 等）运行进程
*   取消分享
*   ...
*   取消分享
*   打开套接字并为第 N 个命名空间（netlink、tcp 等）运行进程

打开的套接字保持对其网络命名空间的引用，因此在套接字关闭之前不会收集它们。

您还可以使用 netlink 在命名空间之间移动接口，方法是在源命名空间上发送 netlink 命令，并通过 PID 或命名空间 FD 指定 dst 命名空间（后者你没有）。

`/proc`在访问依赖于该命名空间的条目之前，您需要切换进程命名空间。一旦“proc”文件打开，它就会保持对命名空间的引用。**

# python - 填充python ctypes指针

> ID：10730841
> 
> 赞同：2
> 
> 时间：2012-05-24T03:41:27.560
> 
> 标签：python, ctypes

我有一个 C 函数`uint8_t *begin();`，它返回一个指向已分配内存的指针。

这是`ctypes`对它的绑定：

```
begin = mylibrary.begin
begin.argtypes = ()
begin.restype = ctypes.POINTER(ctypes.c_uint8) 
```

我需要用整数数组填充内存。有没有更快的方法来代替这个？

```
buffer = begin()
data = range(10)
for idx, value in enumerate(data):
    buffer[idx] = ctypes.c_uint8(value) 
```

在我看来，迭代整个数组是一种非常快速的方法，因为可迭代数据可以包含很多项目、数百万个整数或类似的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T20:08:41.247

如果您可以添加依赖项，[numpy](http://docs.scipy.org/doc/numpy/reference/routines.ctypeslib.html)会使这更容易。

这是我放在一起的一个例子。

C（注意长度设置为10）

```
#include <stdlib.h>
int *begin(void) {
    return calloc(10, sizeof(int));
} 
```

和蟒蛇

```
import numpy as np
import ctypes
# make the data I want to put into C
data = np.arange(10, dtype=ctypes.c_int)
# setup the ctypes just as you did
mylibrary = ctypes.CDLL('a.out')
begin = mylibrary.begin
begin.argtypes = ()
begin.restype = ctypes.POINTER(ctypes.c_int)
# and do the same memmove that Kirill suggested
ctypes.memmove(buffer, data.ctypes.get_data(), ctypes.sizeof(ctypes.c_int)*len(data))
# and print some out
print buffer[2]
# 2 
```

如果你对 numpy 很聪明，你也可以用这种方式做多维数组。

人们需要考虑一下谁拥有内存以及如何清除它，而不是在接近底层 C 时在任何地方出现段错误（或泄漏）。例如`del buffer`，不会释放创建的缓冲区，这必须在C。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T05:15:19.960

Python 列表具有相应的[C 类型，我猜它具有](http://docs.python.org/c-api/list.html "列表对象")[PyObject](http://docs.python.org/c-api/structures.html#PyObject "PyObject")的内部 C 数组。因此，您必须遍历列表项才能将它们转换为`int`'s 。可能有一些技巧可以将它写在一行中，但我认为越简单越好。

PS考虑使用[数组](http://docs.python.org/library/array.html)模块：

```
>>> import ctypes
>>> from array import array
>>> TenInts = ctypes.c_int * 10
>>> arr = array('i', range(10))
>>> carr = TenInts()
>>> arr_addr, arr_len = arr.buffer_info()[0], len(arr) * arr.itemsize
>>> ctypes.memmove(carr, arr_addr, arr_len)
13893440
>>> print '; '.join(map(str, carr))
0; 1; 2; 3; 4; 5; 6; 7; 8; 9 
```

# android - 通过 Facebook 提要 API 发布的帖子中的空/缺失评论的非决定性行为

> ID：10730844
> 
> 赞同：0
> 
> 时间：2012-05-24T03:41:59.977
> 
> 标签：android

如果评论字符串不为空，则以下 Android/Java 伪代码会导致成功发布墙/时间线。

```
 params.putString("picture", img_url);
    params.putString("message", comment);
    params.putString("link", link_url);
    params.putString("name", name);
    params.putString("caption", caption);

    facebook.request("me/feed", params, "POST"); 
```

如果评论（Java 中的字符串类型）为 null 或空/空字符串，则请求返回成功响应但不会发布到墙上。如果简单地省略消息参数，则会发生相同的行为。

我想我可以很聪明，传递一个注释字符串“”或其他一些空格。但在那种情况下，请求实际上失败了，抱怨“消息参数必须是非空白的”。

这似乎是 API 的一次公然失败，以至于我日复一日地再次尝试它，希望它能在后端得到修复，但到目前为止还没有运气。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-18T16:55:19.287

这里的答案只是等待 Facebook 纠正问题，他们最终做到了。

# iphone - 无效的 IPA 测试飞行

> ID：10730851
> 
> 赞同：4
> 
> 时间：2012-05-24T03:42:51.940
> 
> 标签：iphone, ipa

突然之间，在 testflight 上上传构建时出现以下错误：

> IPA 无效：找不到 Info.plist 中指定的可执行文件 - 检查 CFBundleExecutable 键的值。

我试图上传我已经在 testflight 上上传的以前的构建，即使这样我也得到了同样的错误。可能是什么原因？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T06:50:30.430

我找到了解决这个错误的方法。实际上，在 testflight 上构建了太多具有相同产品名称的版本。我更改了 productName 并再次上传了相同的版本。它上传了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-07T06:45:02.990

我的解决方案：

*   指定架构：armv7；
*   设置部署目标 4.3；
*   存档应用程序；

在这些更改之后，我的包被上传到 testflight

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-07T10:52:12.703

这似乎与 Xcode 4.6 无法再为 armv6 构建有关，因此删除对该架构的任何引用为我修复了它。

# api - Http 状态码 400 与 412

> ID：10730852
> 
> 赞同：31
> 
> 时间：2012-05-24T03:43:17.850
> 
> 标签：api, http, rest, http-status-code-400, http-status-code-412

所以我正在开发一个 Rest API

当创建资源的 POST 并且缺少必填字段时，我应该返回什么？

400 - 错误请求

或者

412 - 前提条件失败

为什么？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-05-24T03:50:58.690

**如果请求参数**错误，请使用 400 。如果,等`If-*`请求**标头**之一错误，请使用 412 。[`If-Match`](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.24)[`If-Modified-Since`](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.25)

为什么？这正是 RFC 所说的。例如，请参阅此[`If-Match`](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.24)规范摘录：

> 如果没有一个实体标签匹配，或者如果给出了“*”并且没有当前实体存在，服务器不能执行请求的方法，并且必须返回一个 412（Precondition Failed）响应。当客户端想要阻止更新方法（例如 PUT）修改自客户端上次检索后已更改的资源时，此行为最有用。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-05-24T03:51:53.147

当您的服务器不满足客户端指定的条件时使用 412。

在您的情况下，您应该使用 400。这只是一个错误的请求。

有关前置条件标头的一些说明，请参阅此[链接。](http://odino.org/don-t-rape-http-if-none-match-the-412-http-status-code/)

> Etag 标头通常是一个字符串，它代表我们在 HTTP 标头中的资源。您请求具有 If-Match is a preconditional HTTP header 的资源。如果它与您发送的代码不匹配，它将发送 412。
> 
> If-None-Match 告诉服务器仅当 Etag 与客户端发送的不同时才处理整个响应。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-03-21T07:13:34.370

您可以使用状态码 422。如果您不想，可以使用 400。

# 3d - 是否可以从 Blender 中的渲染对象创建 UV 贴图

> ID：10730859
> 
> 赞同：0
> 
> 时间：2012-05-24T03:45:18.653
> 
> 标签：3d, blender-2.50, blender-2.61

我想知道是否有可能，如果有，如何从搅拌机中的高细节渲染图像创建 UV 贴图，就像您可以在专业 3D 应用程序和游戏引擎（例如 Maya）中所做的那样。

我希望能够创建一些高细节渲染并将它们映射到低多边形网格。

有谁知道这是否可以做到？

我愿意考虑使用插件或其他 3rd 方应用程序来完成这项任务。不过，我更喜欢免费。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T04:44:20.480

搜索`Texture Baking`或`Render Baking`。以下是 Blender 网站的两个链接。

[渲染烘焙](http://www.blender.org/development/release-logs/blender-243/render-baking/)：

> Blender 的渲染管线也支持渲染到 UV 纹理贴图。这仅适用于分配了纹理面和图像的网格对象。

[烘焙选择激活](http://www.blender.org/development/release-logs/blender-246/render-baking/)：

> 一个典型的用例是制作一个详细的高多边形对象，然后将其法线烘焙到多边形数量较少的对象上。然后可以应用生成的法线贴图以使低多边形对象看起来更详细。

# python - 为什么单击关闭窗口后我无法退出应用程序

> ID：10730863
> 
> 赞同：0
> 
> 时间：2012-05-24T03:45:57.970
> 
> 标签：python, wxpython

该应用程序非常简单，只有两个窗口：当我单击**搜索**按钮时，将显示一个新窗口。但是当我一一关闭子窗口和父窗口时，我发现应用程序根本没有退出（IDLE告诉我还有东西在运行）

```
#coding=utf8
import wx
SearchResult = ""
Name = ""
minPrice = 0
maxPrice = 0

class Output(wx.Frame):
    def __init__(self, parent, title):
        wx.Frame.__init__(self,parent,-1,title,size = (300,600))
        panel2 = wx.Panel(self,-1)
        Result = wx.StaticText(panel2,-1,SearchResult,pos = (20,20),size=(260,560))

        self.Bind(wx.EVT_CLOSE, self.OnAppClose)

    def OnAppClose(self, evt):
        msg = "Hold on there a minute"
        dlg = wx.MessageDialog(None, msg, "Wait ...", 
            wx.YES_NO | wx.ICON_EXCLAMATION)

        if dlg.ShowModal() == wx.ID_YES:
            self.Destroy()
        else:
            return

        dlg.Destroy()

class TextCtrlFrame(wx.Frame):
    def __init__(self):
        wx.Frame.__init__(self,None,-1,u'crawl',size = (600,300))
        panel = wx.Panel(self,-1)
        Label1 = wx.StaticText(panel,-1,u"name",pos = (30,20))
        self.inputText1 = wx.TextCtrl(panel,-1,"",pos = (90,20),size=(150,-1))
        self.inputText1.SetInsertionPoint(0)
        Label2 = wx.StaticText(panel,-1,u"price",pos = (270,20))
        self.inputText2 = wx.TextCtrl(panel,-1,"",pos = (330,20),size=(60,-1))
        Label3 = wx.StaticText(panel,-1,"----",pos = (400,20))
        self.inputText3 = wx.TextCtrl(panel,-1,"",pos = (430,20),size=(60,-1))
        self.button = wx.Button(panel, -1, u"search",pos = (250,230))
        self.Bind(wx.EVT_BUTTON,self.OnClick,self.button)
    def OnClick(self,event):
        Name = self.inputText1.GetValue()
        minPrice = self.inputText2.GetValue()
        maxPrice = self.inputText3.GetValue()
        SearchResult = Name + minPrice + maxPrice

        app2 = wx.App()
        frame2 = Output(self,u'result')
        frame2.Show()
        app2.MainLoop()

if __name__ == "__main__":  
    app = wx.App()
    frame = TextCtrlFrame()
    frame.Show()
    app.MainLoop() 
```

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T07:02:49.177

首先，您在程序中启动了两个 wx.Applications 和 mainLoops。这不是必需的。

调整：

```
 app2 = wx.App()
    frame2 = Output(self,u'result')
    frame2.Show()
    app2.MainLoop() 
```

和

```
 frame2 = Output(self,u'result')
    frame2.Show() 
```

*活死人*似乎是在自己的循环中工作的 MessageDialog 。您可以通过两种方式解决这个讨厌的问题：

1.-不要犹豫，毫不留情地杀死它：

```
 if dlg.ShowModal() == wx.ID_YES:
        dlg.Destroy()
        self.Destroy() 
```

2.- 更好的是，让它成为框架的一个孩子，以便在框架关闭时自动和完全杀死，没有任何令人毛骨悚然的形式复苏的可能性（注意`self`）：

```
 dlg = wx.MessageDialog(self, msg, "Wait ...", wx.YES_NO|wx.ICON_EXCLAMATION) 
```

# encryption - 如果使用以下加密/解密代码，反编译代码会启用解密吗？

> ID：10730864
> 
> 赞同：1
> 
> 时间：2012-05-24T03:45:58.350
> 
> 标签：encryption, vb6, cryptography, decompiling

```
Option Explicit 

Dim sSecretData
sSecretData = "Here is some very secret data." 

' Build up the key
Dim wshNetwork, sComputerName
Set wshNetwork = WScript.CreateObject("WScript.Network") 
sComputerName = wshNetwork.ComputerName

Dim capEData
Set capEData = CreateObject("CAPICOM.EncryptedData")

capEData.Algorithm = 3 'Use 3DES
capEData.SetSecret sComputerName 
capEData.Content = sSecretData

Dim sCipherText
sCipherText = capEData.Encrypt

capEData.Algorithm = 3
capEData.SetSecret sComputerName 
capEData.Decrypt sCipherText

Dim sPlainText
sPlainText = capEData.Content 

MsgBox "Original data: " & sSecretData & chr(13) _ 
  & "Encrypted data: " & sCipherText & chr(13) _ 
  & "Recoverd data: " & sPlainText 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T03:59:11.227

这个更简单：关键就是计算机名，算法是众所周知的。因此，可以找到您的计算机名称的每个人（这包括同一交换机上的每个人，即使他的 PC 被入侵，并且取决于您的邮件系统，您曾经发送过邮件的每个人）都可以无限制地解密。

如果您的 PC 崩溃了，并且您为新安装的设备指定了不同的名称，那么您也将不走运。

**编辑**

正如讨论：拥有**硬编码**密钥，拥有**反编译器**和同时拥有**密钥**是不可能的。

您的方法（使用因计算机而异的东西）非常好，但是您应该依赖一些不能像计算机名称（或 MAC 地址...）那样容易被读取的东西。想到处理器序列号或 Windows 产品 ID - 两者都不容易远程读取，但请记住，如果有人可以访问这台机器，游戏就结束了！

# wpf - 检查固定高度 RichTextBox 是否溢出

> ID：10730867
> 
> 赞同：0
> 
> 时间：2012-05-24T03:46:12.157
> 
> 标签：wpf

我正在为使用 WPF 3.5 的编辑器工作。我正在使用固定高度 RichTextBox。当 rtb 已满或溢出时，我想将 rtb 的高度增加一页。任何人都可以帮助我如何检查 rtb 是否已满或溢出。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T06:02:07.707

我希望它可以帮助您解决问题..检查下面的标签

[在 RichTextBox 控件中测量字符串](https://stackoverflow.com/questions/2364970/measure-string-inside-richtextbox-control)

# objective-c - UITextView setTextColor 更改 UITableViewCell 中的布局

> ID：10730869
> 
> 赞同：0
> 
> 时间：2012-05-24T03:46:15.620
> 
> 标签：objective-c, ios

我正在尝试使用以下页面上的解决方案： [UITextView highlightTextColor 或类似选项？](https://stackoverflow.com/questions/2121759/uitextview-highlightedtextcolor-or-similar-option)

但是，我发现当我在 UITextView 上调用 setTextColor 并将颜色设置为 Color blackColor 以外的任何颜色时，UITextView 中的内容似乎发生了变化，并且我将其设置为的颜色不会。

玩玩，我可以通过在我的 UITableViewCell 中修改以下初始化代码来重复此行为：

```
_notesTextView = [[UITextView alloc] initWithFrame:CGRectZero];
[_notesTextView setFont:[UIFont systemFontOfSize:12.0]];
[_notesTextView setTextColor:[UIColor redColor]];
[_notesTextView setUserInteractionEnabled:NO];
[self.contentView addSubview:_notesTextView]; 
```

与我将颜色保留为默认值或设置为 blackColor 时相比，上面的代码将导致 textView 显示与我期望的偏移量，并且文本也不会显示为红色。

这太奇怪了 - 知道可能出了什么问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T04:13:27.007

不要使用 CGRectZero，因为它会根据情况将帧初始化为您可能知道的某个值，因此如果您创建了自定义 UITableViewCell 然后只需在 init 或

```
-(void)layoutSubViews
{

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T04:20:14.030

我已经确认 textColor 确实改变了文本位置（对我来说是上下移动）。我也用 initWithFrame(50, 20, 250, 31) 尝试过，但仍然遇到同样的问题。

我发现解决此问题的方法是使用属性 textAlignment 并将其设置为以下值之一：UITextAlignmentCenter、UITextAlignmentLeft、UITextAlignmentRight。

# android - OEM/Google 在 Android 中实现 com.android.internal.telephony.Call 类

> ID：10730872
> 
> 赞同：4
> 
> 时间：2012-05-24T03:46:27.467
> 
> 标签：android, telephony, android-source

我一直在研究 Android 电话功能的源代码，但我有点迷茫。我基本上已经收集到，除非您是 Google 或 OEM，否则无法处理 CDMA/GSM 设备。现在我只是想弄清楚 OEM 将处理电话的代码放在哪里，即它们继承/实现了哪些类/接口。

在浏览电话应用程序的`InCallScreen`活动时，我追溯了结束通话按钮的点击处理程序，`PhoneUtils.hangup(CallManager)`最终调用`com.android.internal.telephony.Call.hangup()`. 由于`com.android.internal.telephony.Call`它是一个抽象类并且`com.android.internal.telephony.Call.hangup()`是一个抽象方法，我想知道这是否是 OEM 将重写以提供电话服务的类之一。在黑暗中更多一点是询问是否有人知道此类的任何开源实现，以便我可以更深入地了解幕后发生的事情。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-25T11:41:37.283

你是对的。它确实是`com.android.internal.telephony.Call`OEM 实现的接口。更具体地说，它是`com.android.internal.telephony.Phone`需要实现的接口，它使用`Call`、`Connection`和更多接口。

对于您的第二个问题，Google/ASOP（Android 开源项目）实际上确实为 GSM 和 CDMA 提供了所有这些类的实现。所以在接口的android源码中有一个`GSMPhone`和一个实现。`CDMAPhone``Phone`

`https://android.googlesource.com/platform/frameworks/base`如果您不想克隆整个 Android 源代码，可以克隆 git 。`(frameworks/base)/telephony/java/com/android/internal/telephony/`在`gsm/`or`cdma/`文件夹下查看。在这里，您将找到例如您所询问`GSMCall.java`的接口的实现。`com.android.internal.telephony.Call`

android 电话堆栈看起来大概是这样的：

```
+------------------------------------+
| Phone  |  Contacts |  (other apps) |
+------------------------------------+
|android internal telephony framework|
+------------------------------------+
|    Radio Interface Layer (RIL)     |
+------------------------------------+
|        GSM/CDMA modem              |
+------------------------------------+ 
```

Where the GSM/CDMA modem is usually supplied by some vendor, and the RIL layer needs to be customized for the specific GSM/CDMA modem used. So in practice vendors don't have to modify the existing implementation of the `Call`, `Connection`, `Phone`, etc. interfaces in `com.android.internal.telephony` package unless they want to provide support for something different than a GSM/CDMA Phone.

# mysql - Wordpress 用户和用户元 - 将一个表中的多行连接到另一个表中的一行

> ID：10730873
> 
> 赞同：19
> 
> 时间：2012-05-24T03:46:43.450
> 
> 标签：mysql, wordpress, join, sql-view

我想从 wp_users 和 wp_usermeta 表创建一个视图，以便我可以从外部应用程序查询视图中的行。基本身份验证详细信息存储在 wp_users 中（例如，用户名、密码、电子邮件、id），其他字段存储在 wp_usermeta 表中的键/值对中。

wp_users 表的结构如下：

```
id | login | password | email
-----------------------------
1  | bsmith| abc123   | b@foo.com
2  | jjones| def456   | k@bah.com 
```

wp_usermeta 表的结构如下：

```
id | user_id | meta_key | meta_value
------------------------------------
1  | 1       | firstname| bob
2  | 1       | lastname | smith
3  | 1       | country  | denmark
4  | 2       | firstname| jan
5  | 2       | lastname | jones
6  | 2       | country  | germany 
```

我想以 MYSQL VIEW 的形式得到这样的数据：

```
id | login | password | email    | firstname | lastname | country
-----------------------------------------------------------------
1  | bsmith| abc123   | b@foo.com| bob       | smith    | denmark
2  | jjones| def456   | k@bah.com| jan       | jones    | germany 
```

我知道我至少需要在 wp_users 和 wp_usermeta 之间进行内部连接，但是我还需要在 wp_usermeta 中执行子查询以将这些行连接在一起。

我用于获取用户行的查询当然非常简单：

```
select u1.id, u1.login, u1.password, u1.email from wp_users u1 
```

我将元数据作为一行获取的查询是：

```
select m1.user_id, m1.meta_value as firstname, m2.meta_value as lastname, m3.meta_value as country
from wp_usermeta m1
join wp_usermeta m2 on (m1.user_id = m2.user_id and m2.meta_key = 'last_name')
join wp_usermeta m3 on (m2.user_id = m3.user_id and m3.meta_key = 'country')
where m1.meta_key = 'first_name' 
```

那么如何将这两个查询连接在一起 - u1 的数据和 u1.id = m1.userid 所在的行？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-05-24T04:30:44.100

据我所知，您的做法是正确的，只需将它们放在一起：

```
SELECT
    u1.id,
    u1.login,
    u1.password,
    u1.email,
    m1.meta_value AS firstname,
    m2.meta_value AS lastname,
    m3.meta_value AS country
FROM wp_users u1
JOIN wp_usermeta m1 ON (m1.user_id = u1.id AND m1.meta_key = 'first_name')
JOIN wp_usermeta m2 ON (m2.user_id = u1.id AND m2.meta_key = 'last_name')
JOIN wp_usermeta m3 ON (m3.user_id = u1.id AND m3.meta_key = 'country')
WHERE
    -- CONDITIONS ON the user you want to select based any field 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2017-06-22T18:09:51.647

我发现 Toote 的解决方案有效，但在 MySQL 数据库上执行“select * from users_with_meta_view”需要大约 17 秒的性能。

我用这样的视图将其缩短到 0.0054 秒：

```
CREATE OR REPLACE VIEW users_with_meta_view AS
SELECT
    u.id,
    u.user_login AS login,
    u.user_pass AS password,
    u.user_email AS email,
    (select meta_value from wp_usermeta where user_id = u.id and meta_key = 'first_name' limit 1) as first_name,
    (select meta_value from wp_usermeta where user_id = u.id and meta_key = 'last_name' limit 1) as last_name,
    (select meta_value from wp_usermeta where user_id = u.id and meta_key = 'country' limit 1) as country
FROM wp_users u 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-05-23T13:02:02.713

```
$sql= "SELECT
       u1.parent_id,
       m1.meta_value AS headline,
       m2.meta_value AS profilephoto
       FROM wp_vandor u1
       JOIN wp_usermeta m1 ON (m1.user_id = u1.child_id AND m1.meta_key = 'headline')
       JOIN wp_usermeta m2 ON (m2.user_id = u1.child_id AND m2.meta_key = 'profilephoto')
       WHERE m1.user_id != $currentuser_id";

$classifieds = $wpdb->get_results($sql);

foreach ($classifieds as $classified) { ?>
     <p><?php echo $classified->profilephoto; ?></p>
     <h3><?php echo $classified->headline; ?></h3>
<?php } ?> 
```

# mysql - 当我尝试在 Rails 中使用 mysql 时出现错误

> ID：10730876
> 
> 赞同：-1
> 
> 时间：2012-05-24T03:47:10.127
> 
> 标签：mysql, ruby-on-rails, ruby-on-rails-3, activerecord

我正在尝试使用 mysql 作为我的 rails 应用程序的数据库。

这是我的 database.yml 文件的样子

```
development:
  adapter: mysql2
  encoding: utf8
  database: blog_development
  pool: 5
  username: root
  password:
  socket: /tmp/mysql.sock 
```

这是我尝试 rake db:create 命令时遇到的错误

> hilarl@isa009:~/workspace/blog$ rake db:create rake 中止！请安装 mysql2 适配器：`gem install activerecord-mysql2-adapter` （mysql2 不是捆绑包的一部分。将其添加到 Gemfile。）
> 
> 任务：TOP => db:create（通过使用 --trace 运行任务查看完整跟踪）

当我尝试时，`gem install activerecord-mysql2-adapter`我得到'错误：在任何存储库中找不到有效的 gem'activerecord-mysql2-adaptor'（> = 0）'

我正在使用带有 ruby​​ 1.9.3p194 和 rails 3.2.3 的 ubuntu

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T04:04:04.117

你的 Gemfile 的内容是什么？你应该添加：

```
gem 'mysql2' 
```

在您的 gem 文件中，然后从终端中的目录应用程序中执行**bundle install**

# android - 自动调整 Android Tablerow 列项

> ID：10730877
> 
> 赞同：0
> 
> 时间：2012-05-24T03:47:34.107
> 
> 标签：android, tablerow, items

我正在开发一个使用表格的应用程序。纵向是两列，横向是三列。我知道您可以使用 /res/layout-land 文件夹来更改视图，但未保存的数据会被重置。除了使用 /res/layout-land/mylayout.xml 之外，还有其他选择吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T06:25:35.503

如果您不想使用特定文件夹（如`layout-land`），您可以制作一个`TableLayout`包含三列（全部）的布局文件，然后根据手机的当前方向隐藏/取消隐藏其中一列。`onCreate`如果方向设置为`landscape`/ ，则在该方法中使折叠列出现/消失`portrait`：

```
TableLayout tl = (TableLayout) findViewById(R.id.tableLayout1);
if (getResources().getConfiguration().orientation == Configuration.ORIENTATION_LANDSCAPE) {
    // make the column appear, we're in landscape orientation
    tl.setColumnCollapsed(2, false);
} else {
    tl.setColumnCollapsed(2, true);
} 
```

我不知道你想用这个实现什么，当手机转动时，活动仍然会像往常一样重新创建。

# php - 获取ajax加载的表单输入字段、动态输入字段和静态输入字段的值

> ID：10730880
> 
> 赞同：1
> 
> 时间：2012-05-24T03:47:51.483
> 
> 标签：php, jquery, ajax

这有点复杂，所以我希望我说得对。

我有一个加载选项列表并以一个静态输入开始的表单：

```
<span id="keyword_list_out" class="input"><input class="keys margin-bottom" type="text" name="keywords[]" /> 
```

加载页面时，Ajax 调用会显示属于列表的其他输入字段，例如：

```
<span class="field-wrapper"><input class="keys" type="text" name="keywords[]" value="Option One" /><a class="remove-keyword" href="javascript:void(0);"><img src="images/icons/cross-button-icon.png" /></a></span>
<span class="field-wrapper"><input class="keys" type="text" name="keywords[]" value="Option Two" /><a class="remove-keyword" href="javascript:void(0);"><img src="images/icons/cross-button-icon.png" /></a></span> 
```

这些选项附加在第一个静态输入字段 ID 的顶部：keyword_list_out。

用户可以动态添加更多输入字段，他们可以删除现有字段。

到目前为止，所有这些都运行良好。我的问题是访问输入字段中包含的数据。提交表单后，我需要能够执行三个功能：

1.  如果用户删除了一个选项，我需要从数据库中删除它
2.  如果用户添加了一个字段，我需要将其插入数据库
3.  如果用户更改现有字段的值，我需要在数据库中更新它

我可以通过使用输入名称'keyword_name[]'作为数组来访问输入字段中的数据，然后我可以遍历数组。

但是，这并不涉及具有特定 ID 号的现有选项。我可以为从 Ajax 调用加载的字段分配 ID 号，但是静态字段和用户添加的字段不会有 ID 号，因为这些不是必需的。这些字段将简单地插入到数据库中。

所以我想我的问题是我将如何确定哪个现有选项属于数据库中的哪个 ID 号。我应该补充一点，这些选项不是唯一命名的。

我考虑过一些事情，例如：

1.  仅为 Ajax 加载的字段提供 ID 号
2.  在通过每个输入提交循环并使用用户不会提供的分隔符将 ID 附加到名称值的末尾。IE：选项二---1
3.  使用 PHP 循环遍历数组并在匹配 '---' 的地方分解数组值
4.  如果在 '---' 上找到匹配项，则更新数据库，否则插入数据库

有什么想法吗？

更新

我将输入字段分为两个数组：existing_options[] 和 new_options[]。

在发布之前我的 Jquery 脚本中，我添加了：

```
var existing_options = $('input[name=existing_options]').attr('value');
var new_options = $('input[name=new_options]').attr('value'); 
```

正在发送的 Ajax 数据是：

```
'existing_options[]=' + existing_options + '&new_options[]=' + new_options; 
```

然而 PHP 返回这些值是字符串而不是数组。这里缺少一些东西......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T03:56:50.357

我建议在数据库端使用自动增量 ID。当您加载页面时，将 id 放置在这样的位置，`<span class="field-wrapper" id="$row[id]">`而不是在删除时使用：

```
$('.remove-keyword').on('click', function(){
    var id = $(this).parents('span').attr('id');
    place ajax post here with data sent being this id.
}); 
```

基本上添加关键字是相同的，除了使用 ajax 发布到您的脚本，并`mysql_insert_id();`在您的脚本中用作返回 id，而不是动态创建下一行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T04:04:56.737

当通过 AJAX 加载字段时，为它们分配 ID

```
<input class="keys" type="text" id="keyword_11" name="keywords[]" value="Option Two" />
<input class="keys" type="text" id="keyword_12" name="keywords[]" value="Option Two" /> 
```

单击提交后，然后在 jQUery 中，您可以遍历关键字

```
var new_keywords=Array();
var existing_keywords=Array();
$("input[name^='keywords']").each(function(){
  var id = $(this).attr("id");
  var val=$(this).val();
  if(id=="" && val!="")
  {
   new_keywords.push($(this).val());
  }
  else if(id!="")
  {
    var keyword_id=id.split("_")[1];
    existing_keywords.push({"id":keyword_id,"val":val});
  }
});

 // call AjAX function add new_keywords to database
 // call Ajax function to update existing keywords 
```

**更新 1**

在将 new_keywords 添加到数据库的成功功能中，请通过 AJAX 更新现有 dom，这样如果您添加新关键字，则编辑它并尝试保存它将具有与之关联的 ID。

# android - Android 开发者控制台是否忽略 uses-feature android:glEsVersion？

> ID：10730885
> 
> 赞同：1
> 
> 时间：2012-05-24T03:48:34.247
> 
> 标签：android, opengl-es-2.0

我尝试为我的应用程序加载更新，我已从 OpenGL ES 1.0 切换到 2.0 渲染，并希望为不支持 2.0 的设备保留旧版本。但是，当我尝试同时激活这两个 APK 时，Google Play 开发者控制台告诉我这两个 APK 针对完全相同的设备，因此它们不能同时处于活动状态。

其中一个在清单中有这个，另一个没有：

```
<uses-feature android:glEsVersion="0x00020000" android:required="true" /> 
```

因此，我转到了另一个仅使用 ES 2.0 的应用程序，我注意到在 APK 详细信息下，它列出了我的清单所需的其他功能，但没有列出 glEsVersion。

有谁知道发生了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T01:39:47.097

我想通了。“高级模式”允许您上传多个同时处于活动状态的 APK，但用于比较这些 APK 的唯一过滤器是屏幕尺寸、API 级别和纹理压缩格式。

# javascript - 如何在播放视频时取消绑定点击

> ID：10730887
> 
> 赞同：0
> 
> 时间：2012-05-24T03:48:53.810
> 
> 标签：javascript, jquery, binding, bind, unbind

我在一个数组中有一组按钮，我想要它，这样当您单击一个按钮时，它所链接的视频开始播放，它会解除与`click`按钮的绑定（理想情况下仅适用于您刚刚单击的按钮，但我甚至不能让它为`li`) 工作。我有它作为

```
$("#myVid").bind("playing", function() {
  //some stuff that happens
  $("li", ".thumbs").unbind('playVideo()')
        }); 
```

但它不工作......我在这里做错了什么？（ `playVideo()`是一个已经定义的函数）

更具体地说：
问题是它应该`unbind`只在视频播放时播放，因此`.bind("playing", function()...`. 我可以让它停用列表，但它应该在它之前......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T03:58:28.720

如果您像这样创建事件：

```
$("li", ".thumbs").bind("click", playVideo); 
```

相反的行动是这样做：

```
$("li", ".thumbs").unbind("click", playVideo); 
```

必须使用用于绑定单击事件的相同函数来删除相同的事件。

```
function click() {
    $("#myVid").bind("loadeddata", function() {
    $("#bigPic").addClass("move");
    $("#MyT").fadeOut(750);
            });
    playVideo( $(this).index() );
}

$('li', '.thumbs').bind('touchend click', click);

$("#myVid").bind("playing", function() {
    $('li', '.thumbs').unbind('touchend click', click);
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T03:53:46.363

你看过[`.unbind()`doco](http://api.jquery.com/unbind/)吗？您必须传递要取消绑定的事件的名称（尽管有一个允许您传递事件对象的重载）。尝试：

```
$("li", ".thumbs").unbind('click'); 
```

您可以选择传递对特定处理程序的引用以取消绑定：

```
$("li", ".thumbs").unbind('click',playVideo); 
```

如果您要绑定多个处理程序并且只想取消绑定特定的处理程序，则后者是必要的。

（如果您使用的是 jQuery 1.7 或更高版本，我建议您改用该[`.off()`方法](http://api.jquery.com/off/)。）

# r - 连续非二进制数据的简单匹配相似度矩阵？

> ID：10730888
> 
> 赞同：1
> 
> 时间：2012-05-24T03:49:09.080
> 
> 标签：r, distance, matching, similarity, metric

给定矩阵

```
structure(list(X1 = c(1L, 2L, 3L, 4L, 2L, 5L), X2 = c(2L, 3L, 
4L, 5L, 3L, 6L), X3 = c(3L, 4L, 4L, 5L, 3L, 2L), X4 = c(2L, 4L, 
6L, 5L, 3L, 8L), X5 = c(1L, 3L, 2L, 4L, 6L, 4L)), .Names = c("X1", 
"X2", "X3", "X4", "X5"), class = "data.frame", row.names = c(NA, 
-6L)) 
```

我想创建一个 5 x 5 距离矩阵，其中包含匹配比率和所有列之间的总行数。例如，X4 和 X3 之间的距离应该是 0.5，假设两列匹配 6 次中的 3 次。

我曾尝试使用`dist(test, method="simple matching")`包“代理”，但此方法仅适用于二进制数据。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-24T04:16:42.237

使用`outer`（再次:-)

```
my.dist <- function(x) {
 n <- nrow(x)
 d <- outer(seq.int(ncol(x)), seq.int(ncol(x)),
            Vectorize(function(i,j)sum(x[[i]] == x[[j]]) / n))
 rownames(d) <- names(x)
 colnames(d) <- names(x)
 return(d)
}

my.dist(x)
#           X1        X2  X3  X4        X5
# X1 1.0000000 0.0000000 0.0 0.0 0.3333333
# X2 0.0000000 1.0000000 0.5 0.5 0.1666667
# X3 0.0000000 0.5000000 1.0 0.5 0.0000000
# X4 0.0000000 0.5000000 0.5 1.0 0.0000000
# X5 0.3333333 0.1666667 0.0 0.0 1.0000000 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-24T04:35:54.020

这是一个比其他两个更快的解决方案，虽然有点难看。我假设减速带来自不使用`mean()`，因为它可能比 慢`sum()`，并且只计算输出矩阵的一半，然后手动填充下三角形。该函数目前留`NA`在对角线上，但您可以轻松地将它们设置为一个以完全匹配其他答案`diag(out) <- 1`

```
FUN <- function(m) {
  #compute all the combinations of columns pairs
  combos <- t(combn(ncol(m),2))
  #compute the similarity index based on the criteria defined
  sim <- apply(combos, 1, function(x) sum(m[, x[1]] - m[, x[2]] == 0) / nrow(m))
  combos <- cbind(combos, sim)
  #dimensions of output matrix
  out <- matrix(NA, ncol = ncol(m), nrow = ncol(m))

  for (i in 1:nrow(combos)){
    #upper tri
    out[combos[i, 1], combos[i, 2]] <- combos[i,3]
    #lower tri
    out[combos[i, 2], combos[i, 1]] <- combos[i,3]
  }
  return(out)
} 
```

我拿了另外两个答案，把它们变成了函数，并做了一些基准测试：

```
library(rbenchmark)
benchmark(chase(m), flodel(m), blindJessie(m), 
          replications = 1000,
          order = "elapsed", 
          columns = c("test", "elapsed", "relative"))
#-----
       test elapsed relative
1  chase(m)   1.217 1.000000
2 flodel(m)   1.306 1.073131
3 blindJessie(m)  17.691 14.548520 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-24T04:11:12.223

这是一个镜头（dt 是你的矩阵）：

```
library(reshape)
df = expand.grid(names(dt),names(dt))
df$val=apply(df,1,function(x) mean(dt[x[1]]==dt[x[2]]))
cast(df,Var2~Var1) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-25T02:49:35.270

谢谢大家的建议。根据您的回答，我详细阐述了一个三行解决方案（“测试”是数据集的名称）。

```
require(proxy)
ff <- function(x,y) sum(x == y) / NROW(x)
dist(t(test), ff, upper=TRUE) 
```

这是输出：

```
 X1        X2        X3        X4        X5
X1           0.0000000 0.0000000 0.0000000 0.3333333
X2 0.0000000           0.5000000 0.5000000 0.1666667
X3 0.0000000 0.5000000           0.5000000 0.0000000
X4 0.0000000 0.5000000 0.5000000           0.0000000
X5 0.3333333 0.1666667 0.0000000 0.0000000 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-02-18T14:38:16.260

我得到的答案如下：第一，我对行数据做了一些修改：

```
X1 = c(1L, 2L, 3L, 4L, 2L, 5L)
X2 = c(2L, 3L, 4L, 5L, 3L, 6L)
X3 = c(3L, 4L, 4L, 5L, 3L, 2L)
X4 = c(2L, 4L, 6L, 5L, 3L, 8L)
X5 = c(1L, 3L, 2L, 4L, 6L, 4L)
matrix_cor=rbind(x1,x2,x3,x4,x5)
matrix_cor

   [,1] [,2] [,3] [,4] [,5] [,6]
X1    1    2    3    4    2    5
X2    2    3    4    5    3    6
X3    3    4    4    5    3    2
X4    2    4    6    5    3    8
X5    1    3    2    4    6    4 
```

然后：

```
dist(matrix_cor)

     X1       X2       X3       X4
X2 2.449490                           
X3 4.472136 4.242641                  
X4 5.000000 3.000000 6.403124         
X5 4.358899 4.358899 4.795832 6.633250 
```

# selenium - Jenkins 在启动 Internet Explorer 时停止

> ID：10730893
> 
> 赞同：0
> 
> 时间：2012-05-24T03:50:44.260
> 
> 标签：selenium, continuous-integration, jenkins

我们在项目中使用 Jenkins 作为 CI。我们使用以下命令从命令行运行 CI

```
java -jar C:\\jenkins\\jenkins.war --httpPort=8085 --ajp13Port=8009 
```

由于系统需要频繁重启，我们将CI改为windows服务启动。

现在我们正面临 Selenium 测试用例的问题。在我们将 Jenkins 作为服务之后，Selenium 测试用例没有运行。我们收到以下日志，从那时起没有更多进展

```
18:36:30,718 INFO  [org.openqa.selenium.server.SeleniumDriverResourceHandler] Command request: getNewBrowserSession[*iexploreproxy, http://192.168.132.105:8080/, ] on session null
18:36:30,718 INFO  [org.openqa.selenium.server.BrowserSessionFactory] creating new remote session
18:36:30,796 INFO  [org.openqa.selenium.server.BrowserSessionFactory] Allocated session 80b95d0273ac4ea4a82860c79438f071 for http://192.168.132.105:8080/, launching...
18:36:30,796 INFO  [org.openqa.selenium.server.browserlaunchers.WindowsProxyManager] Modifying registry settings...
18:36:31,781 INFO  [org.openqa.selenium.server.browserlaunchers.InternetExplorerCustomProxyLauncher] Launching Internet Explorer... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T04:13:40.220

根据 hudson wiki，您应该将 Hudson（或 jenkins）作为任务而不是 GUI 测试服务运行。[在这里](http://wiki.hudson-ci.org/display/HUDSON/Tomcat)检查。查看 Windows 中的 GUI 测试部分

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T07:55:50.027

以下更改将解决问题

1.  更新硒版本。
2.  对 IE 使用 *iexploreproxy 或 *piiexplore 而不是 *iehta/*iexplore

# android - 安卓应用的 jQTouch 替代品

> ID：10730896
> 
> 赞同：0
> 
> 时间：2012-05-24T03:51:31.087
> 
> 标签：android, jquery-mobile, cordova, jqtouch

好的，我可能会咬紧牙关，为我试图移植到 Android 的 iPhone 应用程序尝试不同的框架。使用 jQTouch 和 Phonegap 构建，它在 Android 上运行缓慢，存在许多问题，例如在更新的 Android API 级别上的转换不一致和加载问题。

寻找对 Android 更友好的替代框架的选项，重要的是，要尽可能轻松地将我现有的代码适应它，不需要爬太多的山。

作为一个 jQTouch 应用程序，它使用 HTMl5、CSS、jQuery 和 Javascript 构建，具有多个 RSS 提要、固定标签栏、图片库、Phonegap 日历插件。jQuery Mobile 似乎是最明显的选择，但我发现标签栏是不像他们爬升那样固定，（尽管新版本可能有所改善？）。有没有更好的选择？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T14:51:04.803

就像你说的，jQuery Mobile 是最明显的选择。您还可以查看 Sencha Touch、Dojo Mobile、Kendo UI。

# google-app-engine - 使用 Google App Engine / Java 的数据存储位置

> ID：10730901
> 
> 赞同：0
> 
> 时间：2012-05-24T03:52:03.553
> 
> 标签：google-app-engine, google-cloud-datastore, maven-gae-plugin

如何在使用 GAE/J 时自定义数据存储文件的位置。

该选项`--datastore_path`似乎不适用于 GAE/J。

如果可能的话，我在`maven-gae-plugin`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T06:56:08.930

我假设您的意思是在本地运行开发应用程序服务器时。尝试使用以下`--generated_dir`选项`<sdk>/bin/dev_appserver.sh`：
`--generated_dir=dir Set the directory where generated files are created.`

生成的文件包括本地数据存储文件。

# hadoop - nutch hadoop 只有一个奴隶在爬行

> ID：10730903
> 
> 赞同：0
> 
> 时间：2012-05-24T03:52:28.783
> 
> 标签：hadoop, fetch, nutch

我有一个 3 从属 hadoop 集群，我正在一个网站上执行爬网。但是，只有 1 个从站正在执行获取（尽管其他从站仍然活着）。如果只抓取 1 个域，这是正常行为吗？有没有什么办法可以强制其他奴隶去取？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T04:47:08.103

作为任何 Hadoop MR 作业设计的一部分，都会决定如何在映射器之间拆分工作。在您的情况下，nutch 按站点拆分获取过程，因此仅使用一个映射器来获取数据。如果您拥有更多站点，它将分担负载。
下面是对该过程的一个很好的描述：Nutch 如何与 Hadoop 集群一起工作？

# java - NetBeans 测试文件和运行文件差异

> ID：10730906
> 
> 赞同：2
> 
> 时间：2012-05-24T03:53:12.153
> 
> 标签：java, netbeans

在Netbeans中创建程序后想运行一个文件，右击鼠标，启用两个选项，一个是测试文件，另一个是运行文件。有什么区别，因为我困惑了很多次。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T07:26:35.050

在 Netbeans 中，`Run`可能有不同的含义，具体取决于您正在处理的项目类型。

在 Java 项目中，`Run file`绿色箭头表示运行`main`Java 类的方法。您甚至可能会注意到，`Run file`如果类没有`main`方法，该选项会显示为灰色。

在 Web 或企业项目中，这意味着将项目部署到关联的应用程序或 Web 服务器。

该`Test`选项意味着一次为单个文件运行任何测试用例，或者一次为整个项目运行任何测试用例。测试用例通常使用 JUnit 或 TestNG 等单元测试库创建。如果您不知道什么是单元测试，您可能想阅读这篇文章以供[参考](http://en.wikipedia.org/wiki/Unit_testing)。

我希望它有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T07:39:14.133

我从您的问题中猜想您想编写某种`c++`或`java`某种程序并且您想单独运行它们。
所以，我建议你对每一种开发都使用特殊的编辑器。
Netbeans 通常用于大型开发（但你也可以将它用于单个文件），它在许多其他方面都有帮助......（我想你不需要）。

# php - mysql删除然后更新

> ID：10730907
> 
> 赞同：2
> 
> 时间：2012-05-24T03:53:13.447
> 
> 标签：php, mysql

MySQL中是否有任何方法/方法，如果我删除某一行，下一行可能会被更新？为了说明我的意思，例如我这里有一张表：

```
+--------------+
|  id  | order |
+--------------+
|  115 |     1 |
|  116 |     2 |
|  117 |     3 |
|  118 |     1 |
|  119 |     2 |
|  120 |     6 |
|  121 |     7 |
|  122 |     8 |
+--------------+ 
```

我即将 drop `id = 117`，如果动作成功，我希望`id = 118`将其顺序从 1 变为 3 ，这是当前的 drop 顺序`id = 117`。然后让`id = 119`订单 4，然后`id = 120`到 5，依此类推。

我这样做是因为我的 PHP 程序中有某种排序行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T11:02:14.383

在您的情况下，您将必须完全重新填充订单列，因为如果您删除行 id 118 或 119，则需要更改 118,119,120 等直到表末尾

```
 update order1,(select @rownum:=0)dummy set order1 = 
(@rownum =@rownum+1); 
```

所以在这种情况下，如果你删除 118

```
Delete from YourTable where id = 118 
```

运行上面的更新脚本，它可以工作

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T04:25:41.370

你需要有 MySQL 5+。从 MySQL 5 开始，我们有了触发器。触发器是在特定表上发生插入、更新或删除操作时触发或执行的程序。因此，您可以创建一个“ `BEFORE`”“ `DELETE`”触发器，您可以在同一个表上打开一个触发器，该触发器将在where表示已删除行数据表（称为魔术表）`cursor`之后选择具有 ID 的行。然后是简单地发出所需的命令来更新其中的相关行的情况。`OLD.id``OLD``UPDATE`

您可以将删除的行数据称为`OLD.col_name`. 在一个`INSERT`或`UPDATE`触发器中，您还可以访问`NEW.col_name`以引用插入的数据。只有在`UPDATE`触发器中，您才能同时访问 the`NEW`和`OLD`magic 表。

链接： [MySQL 触发](http://dev.mysql.com/doc/refman/5.0/en/triggers.html) [游标](http://dev.mysql.com/doc/refman/5.0/en/cursors.html)

# asp.net - 如何在 aspnetdb 数据库中添加更多用户字段？

> ID：10730917
> 
> 赞同：1
> 
> 时间：2012-05-24T03:55:00.890
> 
> 标签：asp.net, sql-server, visual-studio-2010, aspnetdb

我使用 Aspnet_regsql.exe 在 SQL Server 2008 上为用户、角色和配置文件创建了一个 ASPNETDB 数据库。

但除了那些默认属性（姓名、电子邮件、手机和评论）之外，我想要更多的用户属性，例如邮政编码、地址、电话号码、等级、职位等。而且这些新字段应该在 aspx 中暴露给 CreateNewUserWizard页面设计模式，让新用户注册更多属性。

我试图在 ASPNETDB 数据库的“aspnet_Membership”表中添加新列。但它们并没有被自动拾取。

谁能给我一些帮助？谢谢

干杯，亚历克斯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T04:01:28.407

不要自己接触数据库。请按照此处概述的步骤操作：

[http://weblogs.asp.net/scottgu/archive/2005/10/18/427754.aspx](http://weblogs.asp.net/scottgu/archive/2005/10/18/427754.aspx)

请注意，您需要使用“网站”项目模板。Web 应用程序项目模板不支持开箱即用的配置文件（没有一些自定义）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-24T04:09:47.413

请参考 aspnet_Profile 表

要添加其他属性列，您需要在 web.config 文件中创建配置文件属性并访问此属性并更新当前创建的用户的配置文件。

如果您有关于用户的复杂信息，那么您可以创建您的表并使用外键关系到 aspnet_users 表中的 UserId。

检查此[MSDN 文章](http://www.asp.net/web-forms/tutorials/security/membership/storing-additional-user-information-cs)

如何为配置文件添加[属性](http://msdn.microsoft.com/en-us/library/2y3fs9xs.aspx)

在 StackOverflow 本身的答案之一中解释了在 Asp.net C# 中使用配置文件的完整详细信息，请参阅[how-to-assign-profile-values](https://stackoverflow.com/questions/426609/how-to-assign-profile-values)

# input - 需要根据值修剪字符串

> ID：10730918
> 
> 赞同：1
> 
> 时间：2012-05-24T03:55:02.683
> 
> 标签：input, trim

```
var a = 123456789
var b = 6 
```

基于'b'我需要修剪'a'。例如，如果“a”有 8 位，我需要将“a”修剪到 6 位（123456）。如果 b 为 8，我需要修剪最多 8 位数字。请帮我

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T03:57:23.167

这听起来像做你想做的最简单的方法是：

1.  转换`a`为字符串。
2.  将最左边的数字取到最大值`b`。

这可能比尝试做你在算术上提出的要求更容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T04:11:58.677

我假设你在javascript中？

```
var a = "123456789";
var b = 6;
var n = a.substr(0,b); 
```

# android - 设置手机铃声的问题

> ID：10730919
> 
> 赞同：1
> 
> 时间：2012-05-24T03:55:11.153
> 
> 标签：android, ringtone

我正在尝试让一个 Android 程序设置手机的铃声。当我运行以下代码一次时，铃声设置正确并且工作正常。但是，如果我多次运行代码，铃声就会变为静音。任何帮助解决这个问题将不胜感激。

```
 void setRingtone() {
    //File path = Environment.getExternalStorageDirectory();

    //File file = new File(path, "ringtone.mp3"); 

    File file = new File("/sdcard/", "ringtone.mp3");
    Uri mUri = Uri.parse("android.resource://com.*****.*****/" + R.raw.*****);
    ContentResolver mCr = getContentResolver();

    ContentValues values = new ContentValues();
    values.put(MediaStore.MediaColumns.DATA, file.getAbsolutePath());
    values.put(MediaStore.MediaColumns.TITLE, "my ringtone");
    values.put(MediaStore.MediaColumns.MIME_TYPE, "audio/oog");
    values.put(MediaStore.MediaColumns.SIZE, file.length());
    values.put(MediaStore.Audio.Media.ARTIST, R.string.app_name);
    values.put(MediaStore.Audio.Media.IS_RINGTONE, true);
    values.put(MediaStore.Audio.Media.IS_NOTIFICATION, true);
    values.put(MediaStore.Audio.Media.IS_ALARM, true);
    values.put(MediaStore.Audio.Media.IS_MUSIC, false);

    Uri uri = MediaStore.Audio.Media.getContentUriForPath(file.getAbsolutePath());
    Uri newUri = mCr.insert(uri, values);

    try {
        RingtoneManager.setActualDefaultRingtoneUri(getApplicationContext(), RingtoneManager.TYPE_RINGTONE, newUri);
    } catch (Throwable t) {}

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T23:06:49.087

问题是 RingtoneManager.setActualDefaultRingtoneUri 将文件路径添加到数据库中，并将标识作为铃声。由于文件路径已经在数据库中，因此存在一些错误并且值变为空（如果我理解正确的话）。这就是为什么它只在设置后的第一次工作。要解决此问题，您需要先删除引用。这是执行此操作的代码。

```
getContentResolver().delete(uri, MediaStore.MediaColumns.DATA 
+ "=\"" + file.getAbsolutePath() + "\"", null); 
```

# android - 从资产文件夹复制到 SD 卡

> ID：10730923
> 
> 赞同：2
> 
> 时间：2012-05-24T03:56:20.920
> 
> 标签：android, android-sdcard, android-assets

我不确定这段代码有什么问题？它在 SD 卡中创建了一个文件，但为 0 字节。你们中的一个可以查看它并告诉我这有什么问题吗？

在这里，我试图从资产文件夹中复制一个文件，即代码.db 到 sd 卡。

```
 AssetManager assetManager = getResources().getAssets();
    InputStream in = null;

    OutputStream out = null;
    BufferedInputStream buf = null;
    try {
        in = assetManager.open("codes.db");

    } catch (IOException e) {
        // TODO Auto-generated catch block
        System.out.println("Error jh: " + e.getMessage());
    }
    if (in != null) {
        try {
            out = new FileOutputStream("/sdcard/" + "codes.db");
        } catch (FileNotFoundException e) {
            // TODO Auto-generated catch block
            System.out.println("Error Line : " + e.getLocalizedMessage());
        }
    }

    System.out.println("IN VALUE : " + in);
    System.out.println("OUT VALUE : " + out);

    int chunkBytes = 0;
    byte[] outputByte = new byte[1024];

    if (in != null && out != null) {
        try {

            // while ((chunkBytes = in.read(outputByte, 0, 1024)) != -1) {
            while ((chunkBytes = in.read()) != -1) {
                // write contents to the file
                System.out.println("I m here");
                // out.write(outputByte, 0, (int) chunkBytes);
                out.write(chunkBytes);
                // publish the progress of downloading..
            }
        } catch (Exception e) {
            // TODO Auto-generated catch block
            System.out.println("Error here: "
                    + e.getLocalizedMessage().toString());
        }
    }

    try {
        in.close();
        out.close();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        System.out.println("Error there: " + e.getLocalizedMessage());
    }

} 
```

在所有情况下我都会收到此错误..我确定我设置了权限...sd卡中的code.db是0字节... :(

```
05-24 09:59:34.221: W/System.err(5559): java.io.IOException
05-24 09:59:34.221: W/System.err(5559):     at android.content.res.AssetManager.readAsset(Native Method)
05-24 09:59:34.221: W/System.err(5559):     at android.content.res.AssetManager.access$700(AssetManager.java:36)
05-24 09:59:34.221: W/System.err(5559):     at android.content.res.AssetManager$AssetInputStream.read(AssetManager.java:571)
05-24 09:59:34.221: W/System.err(5559):     at com.bewo.copy.TestCopyActivity.copyStream(TestCopyActivity.java:136)
05-24 09:59:34.221: W/System.err(5559):     at com.bewo.copy.TestCopyActivity.onCreate(TestCopyActivity.java:19)
05-24 09:59:34.221: W/System.err(5559):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
05-24 09:59:34.221: W/System.err(5559):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2635)
05-24 09:59:34.221: W/System.err(5559):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2687)
05-24 09:59:34.221: W/System.err(5559):     at android.app.ActivityThread.access$2300(ActivityThread.java:127)
05-24 09:59:34.221: W/System.err(5559):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2035)
05-24 09:59:34.221: W/System.err(5559):     at android.os.Handler.dispatchMessage(Handler.java:99)
05-24 09:59:34.221: W/System.err(5559):     at android.os.Looper.loop(Looper.java:123)
05-24 09:59:34.221: W/System.err(5559):     at android.app.ActivityThread.main(ActivityThread.java:4635)
05-24 09:59:34.221: W/System.err(5559):     at java.lang.reflect.Method.invokeNative(Native Method)
05-24 09:59:34.221: W/System.err(5559):     at java.lang.reflect.Method.invoke(Method.java:521)
05-24 09:59:34.221: W/System.err(5559):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:860)
05-24 09:59:34.221: W/System.err(5559):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:618)
05-24 09:59:34.221: W/System.err(5559):     at dalvik.system.NativeStart.main(Native 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-17T03:50:46.300

经过多次搜索，我只是想要一个稍后可以在线程中使用的方法，这是我用于我的应用程序的方法：

```
static public void copyFileFromAssets(Context context, String file, String dest) throws Exception 
{
    InputStream in = null;
    OutputStream fout = null;
    int count = 0;

    try
    {
        in = context.getAssets().open(file);
        fout = new FileOutputStream(new File(dest));

        byte data[] = new byte[1024];
        while ((count = in.read(data, 0, 1024)) != -1)
        {
            fout.write(data, 0, count);
        }
    }
    catch (Exception e) 
    {
        e.printStackTrace();
    }   
    finally
    {
        if (in != null)
        {
            try {
                in.close();
            } catch (IOException e) 
            {
            }
        }
        if (fout != null)
        {
            try {
                fout.close();
            } catch (IOException e) {
            }
        }
    }
} 
```

请让我知道这可不可以帮你！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-24T04:28:22.097

我希望下面的代码可以帮助你 -

```
package com.paresh.copyfileassetstoAssets;

import java.io.FileOutputStream;
import java.io.IOException;
import java.io.InputStream;
import java.io.OutputStream;

import android.app.Activity;
import android.content.res.AssetManager;
import android.os.Bundle;
import android.os.Environment;
import android.util.Log;

public class CopyFileAssetsToSDCardActivity extends Activity 
{
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

       CopyAssets();
    }

    private void CopyAssets() {
        AssetManager assetManager = getAssets();
        String[] files = null;
        try {
            files = assetManager.list("Files");
        } catch (IOException e) {
            Log.e("tag", e.getMessage());
        }

        for(String filename : files) {
            System.out.println("File name => "+filename);
            InputStream in = null;
            OutputStream out = null;
            try {
              in = assetManager.open("Files/"+filename);   // if files resides inside the "Files" directory itself
              out = new FileOutputStream(Environment.getExternalStorageDirectory().toString() +"/" + filename);
              copyFile(in, out);
              in.close();
              in = null;
              out.flush();
              out.close();
              out = null;
            } catch(Exception e) {
                Log.e("tag", e.getMessage());
            }
        }
    }
    private void copyFile(InputStream in, OutputStream out) throws IOException {
        byte[] buffer = new byte[1024];
        int read;
        while((read = in.read(buffer)) != -1){
          out.write(buffer, 0, read);
        }
    }
} 
```

将资产文件复制到 sdcard的最佳[博客](http://www.technotalkative.com/android-copy-files-from-assets-to-sd-card/)。并且，还要确保[外部存储所需的权限](http://developer.android.com/reference/android/Manifest.permission.html#WRITE_EXTERNAL_STORAGE)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T04:22:20.390

无论您使用什么，请尝试在 AVD 管理器中增加 SD 卡的大小。我希望它对你有帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-10-31T04:53:10.383

这是我在项目中使用的代码。我觉得对你有用

```
public static void copyAssets(Context context) {
    AssetManager assetManager = context.getAssets();
    String[] files = null;
    try {
        files = assetManager.list("");
    } catch (IOException e) {
        Log.e("tag", "Failed to get asset file list.", e);
    }
    if (files != null) for (String filename : files) {
        InputStream in = null;
        OutputStream out = null;
        try {
            in = assetManager.open(filename);

            out = new FileOutputStream(Environment.getExternalStorageDirectory()+"/www/openrap/" + filename);
            copyFile(in, out);
        } catch(IOException e) {
            Log.e("tag", "Failed to copy asset file: " + filename, e);
        }
        finally {
            if (in != null) {
                try {
                    in.close();
                    in = null;
                } catch (IOException e) {

                }
            }
            if (out != null) {
                try {
                    out.flush();
                    out.close();
                    out = null;
                } catch (IOException e) {

                }
            }
        }
    }
}

public static void copyFile(InputStream in, OutputStream out) throws IOException {
    byte[] buffer = new byte[1024];
    int read;
    while((read = in.read(buffer)) != -1){
        out.write(buffer, 0, read);
    }
} 
```

# sql - 如何编写 oracle 查询以获取未来日期的员工详细信息？

> ID：10730925
> 
> 赞同：0
> 
> 时间：2012-05-24T03:56:31.513
> 
> 标签：sql, oracle

我有一个员工表和员工更新表，如下图所示。员工表始终保存任何员工的当前详细信息。

而员工更新表包含将在未来某个日期发生在员工身上的更新。

例如，员工 james 目前在印度工作，但从 5 月 1 日起，他将被调到德国。因此，从 5 月 1 日起，他所在的地区、国家和城市将发生变化。

我需要拿出一份报告来查看 5 月 10 日的员工详细信息。在这种情况下，所有在 1 日之前更新的员工都应该显示他们的最新值。

![在此处输入图像描述](../Images/12e2956eb4a815db755cc387fde2d329.png)

像 region 、 country 和 city 一样，我几乎没有其他字段可以为员工提供更新。

也有可能一些员工可能没有任何更新，那么应该显示他们当前的记录。

是否可以进行此查询？

我将非常频繁地需要此报告，因此将此查询的结果作为视图然后可以查询报告是否更好？

编辑 ： -

以下是格伦回答的迄今为止我尝试过的查询

```
WITH eff_emps AS ( 
SELECT 
    emp_id, firstname, region_id, country_id, city, effective_date   
FROM 
  bi_employee 

UNION 

SELECT 
  x.employee_id, 
  e.firstname, 
  CAST(MAX(x.region_id) as number) AS region_id, 
  CAST(MAX(x.country_id) as number) AS country_id, 
  MAX(x.city) AS city, 
  x.effective_date   
FROM ( 
      SELECT 
          employee_id, effective_date                ,
          CASE WHEN COLUMN_NAME = 'REGION_ID' THEN NEW_VALUE ELSE NULL END AS region_id               ,
          CASE WHEN COLUMN_NAME = 'COUNTRY_ID' THEN NEW_VALUE ELSE NULL END AS country_id                ,
          CASE WHEN COLUMN_NAME = 'CITY' THEN NEW_VALUE ELSE NULL END AS city            
      FROM bi_employee_update 
) x ,Bi_employee e   

WHERE e.emp_id = x.employee_id   
GROUP BY 
    x.employee_id, e.firstname, x.effective_date 
) 

SELECT *   FROM eff_emps f   
WHERE effective_date = ( 
  SELECT 
      MAX(effective_date)  
  FROM eff_emps 
  WHERE 
    emp_id = f.emp_id 
    AND effective_date <= TO_DATE('2012-09-01', 'YYYY-MM-DD')    ) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T05:41:03.460

**编辑：大幅修改。**

第一个解决方案没有考虑各个领域在不同时间发生变化所产生的问题。它只关心将最新更新应用于原始有效日期值。

这是对该答案的重写，返回，以便单独考虑正在更改的每个字段，而不是联合考虑。

所有 sql 都在 sqlfiddle 演示： [http ://sqlfiddle.com/#!4/ca4f4/6](http://sqlfiddle.com/#!4/ca4f4/6)

* * *

我们首先获取任何单个字段的最新更改。我们可以这样做：

```
select *
  from ( select empid, when, what from updates
  where when <= to_date('2012-05-10', 'yyyy-mm-dd') 
  ) pivot_data
pivot ( max(when)
       for what in ('region' as max_region_date, 
                    'city' as max_city_date, 
                    'country' max_country_date)
); 
```

这会生成一个数据透视表，分别考虑每个字段，并给出小于或等于报告生效日期的最大日期的输出。请注意，由于此数据透视表已添加到较大的查询中，因此它只是嵌入报告日期的位置。

要向您的原始数据集添加更多数据，让我们使用：

```
EMPID   NEW     WHAT    WHEN
1       germany region  May, 01 2012
1       germany country May, 01 2012
1       münchen city    May, 01 2012
2       boston  city    June, 01 2012
2       canada  country July, 01 2012
2       toronto city    July, 01 2012
2       vancouver   city    August, 01 2012 
```

因此，如果您针对 15.August 的报告日期运行上述查询，您会得到：

```
EMPID   MAX_REGION_DATE MAX_CITY_DATE   MAX_COUNTRY_DATE
1       May, 01 2012    May, 01 2012    May, 01 2012 
2       (null)          August, 01 2012 July, 01 2012 
```

(null) 表示 empid = 2 的区域在更新中没有条目。empid = 2 的另外两个日期表示该字段的最近更改日期。

现在，我们需要将其转换`new`为每个字段在该日期的值。这可以通过以下方式完成：

```
select distinct u1.empid,
   (select u2.new from updates u2
    where u2.what = 'region'
      and u2.empid = u1.empid
      and u2.when = max_dates.max_region_date
    ) region, max_dates.max_region_date,
   (select u3.new from updates u3
    where u3.what = 'country'
      and u3.empid = u1.empid
      and u3.when = max_dates.max_country_date
    ) country, max_dates.max_country_date,
   (select u4.new from updates u4
    where u4.what = 'city'
      and u4.empid = u1.empid
      and u4.when = max_dates.max_city_date
    ) city, max_dates.max_city_date
from updates u1
left join 
  (select *
   from ( select empid, when, what from updates
          where when <= to_date('2012-07-15', 'yyyy-mm-dd') 
        ) pivot_data
    pivot ( max(when)
        for what in ('region' as max_region_date, 
                    'city' as max_city_date, 
                    'country' max_country_date)
       )
   ) max_dates on max_dates.empid = u1.empid; 
```

我将上面的数据透视表输出嵌入为派生表，然后单独选择对应于特定日期的每个字段值。

使用 15.August 的报告运行此报告会给出：

```
EMPID REGION    MAX_REGION_DATE    COUNTRY    MAX_COUNTRY_DATE  CITY       MAX_CITY_DATE
2     (null)    (null)             canada     July, 01 2012     vancouver August, 01 2012 
1     germany   May, 01 2012       germany    May, 01 2012      münchen   May, 01 2012 
```

对于员工 2，我们看到该国家/地区的值是加拿大，它在 01.July 更新，而最近的城市温哥华，在 01.August 更新。

现在，我们需要将其与针对员工的查询结合起来：

```
select e.empid, e.name,
  (coalesce( u.region, e.region)) region,
  (coalesce( u.city, e.city)) city,
  (coalesce( u.country, e.country)) country
from employee e
left join (
  select distinct u1.empid,
   (select u2.new from updates u2
    where u2.what = 'region'
      and u2.empid = u1.empid
      and u2.when = max_dates.max_region_date
    ) region, max_dates.max_region_date,
   (select u3.new from updates u3
    where u3.what = 'country'
      and u3.empid = u1.empid
      and u3.when = max_dates.max_country_date
    ) country, max_dates.max_country_date,
   (select u4.new from updates u4
    where u4.what = 'city'
      and u4.empid = u1.empid
      and u4.when = max_dates.max_city_date
    ) city, max_dates.max_city_date
  from updates u1
  left join 
    (select *
     from ( select empid, when, what from updates
            where when <= to_date('2012-08-15', 'yyyy-mm-dd') 
          ) pivot_data
     pivot ( max(when)
       for what in ('region' as max_region_date, 
                    'city' as max_city_date, 
                    'country' max_country_date)
       )
  ) max_dates on max_dates.empid = u1.empid
) u on u.empid = e.empid
order by e.empid; 
```

其中最大的部分是派生表，如前所述。其余的是针对 的连接`employee`，然后是 'coalesce `ing to either take the updated value, or the current value in employee if the update value is`null`。

这导致：

```
EMPID    NAME    REGION    CITY      COUNTRY
1        james   germany   münchen   germany
2        mike    americas  vancouver canada 
```

当使用 15.August 的报告日期时。您可以在上面给出的 sqlfiddle 中根据我的测试数据（或添加您自己的数据）验证其他日期。

现在，最后一个问题。上面假设您有数据完整性约束来验证仅在将来进行更新——一旦将更新应用于员工表（从而更新它的有效日期字段），该行就会从更新表中删除。也就是说，更新仅包含**未应用**的更改。

如果我们想考虑这种情况，我们需要再次在 select 中逐个字段地检查它。将上面的选择修改为：

```
select e.empid, e.name,
  (coalesce( (case 
                when (u.max_region_date > e.effective_date) 
                then u.region
              end),
            e.region)) region,
  (coalesce( (case 
                when (u.max_city_date > e.effective_date) 
                then u.city
              end),
            e.city)) city,
  (coalesce( (case 
                when (u.max_country_date > e.effective_date) 
                then u.country
              end),
            e.country)) country
from . . . . . the from in the previous query above . . . 
```

在我的情况下，您会得到与以前相同的输出。

* * *

我应该补充一点，我同意 Glenn 关于不在您的列名中使用保留字`when`的意见。`new`（虽然我把它们留在了我的样本中。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T04:47:49.497

```
create table employee(emp_id int, name varchar(64), region varchar(64), country varchar(64), city varchar(64), effective_date date)
create table employee_updates(emp_id int, old varchar(64), new varchar(64), effective_date date, what varchar(64))

insert into employee values(1, 'james', 'asia', 'india', 'mumbai',to_date('2012-04-10', 'YYYY-MM-DD'));
insert into employee values(2, 'rick', 'americas', 'us', 'ny',to_date('2012-03-01', 'YYYY-MM-DD'));

insert into employee_updates values(1, 'asia', 'germany', to_date('2012-05-01', 'YYYY-MM-DD'), 'region');
insert into employee_updates values(1, 'india', 'germany', to_date('2012-05-01', 'YYYY-MM-DD'), 'country');
insert into employee_updates values(1, 'mumbai', 'munich', to_date('2012-05-01', 'YYYY-MM-DD'), 'city');

-- <UPDATE 3>
insert into employee values(3, 'jane', 'Europe', 'UK', 'London',to_date('2012-03-01', 'YYYY-MM-DD'));
insert into employee_updates values(3, 'Europe', 'Canada', to_date('2012-05-01', 'YYYY-MM-DD'), 'region');
insert into employee_updates values(3, 'UK', 'Canada', to_date('2012-05-01', 'YYYY-MM-DD'), 'country');
insert into employee_updates values(3, 'London', 'Toronto', to_date('2012-11-01', 'YYYY-MM-DD'), 'city'); 
```

: 希望这更清楚一点。它返回完整的有效日期记录集：

```
 WITH combined_records AS (

   SELECT emp_id, name, region, country, city, effective_date
     FROM employee

   UNION

   -- Union with a set of pseudo employee records generated from the updates table
   -- Any of these new "employee" records could have a NULL value in one of the region/country/city fields

   -- 2\. Compress the sparse matrix to merge records sharing common (emp_id + effective_date)
   SELECT x.emp_id, e.name, MAX(x.region) AS region, MAX(x.country) AS country, MAX(x.city) AS city, x.effective_date
     FROM ( -- 1\. Create a sparse matrix of one row with each record from the updates table
            SELECT emp_id, effective_date
                  ,CASE WHEN WHAT = 'region' THEN NEW ELSE NULL END AS region
                  ,CASE WHEN WHAT = 'country' THEN NEW ELSE NULL END AS country
                  ,CASE WHEN WHAT = 'city' THEN NEW ELSE NULL END AS city
              FROM employee_updates
          ) x
         ,employee e
     WHERE e.emp_id = x.emp_id
     GROUP BY x.emp_id, e.name, x.effective_date

)

SELECT a.emp_id, a.name
      ,COALESCE(a.region, rgn.region) AS region
      ,COALESCE(a.country, cntry.country) AS country
      ,COALESCE(a.city, cty.city) AS city
      ,a.effective_date
  FROM combined_records a
      ,combined_records rgn
      ,combined_records cntry
      ,combined_records cty
  WHERE a.emp_id = rgn.emp_id
    AND rgn.effective_date = ( SELECT MAX(effective_date)
                                 FROM combined_records
                                 WHERE emp_id = a.emp_id
                                   AND region IS NOT NULL
                                   AND effective_date <= a.effective_date )
    AND a.emp_id = cntry.emp_id
    AND cntry.effective_date = ( SELECT MAX(effective_date)
                                 FROM combined_records
                                 WHERE emp_id = a.emp_id
                                   AND country IS NOT NULL
                                   AND effective_date <= a.effective_date )
    AND a.emp_id = cty.emp_id
    AND cty.effective_date = ( SELECT MAX(effective_date)
                                 FROM combined_records
                                 WHERE emp_id = a.emp_id
                                   AND city IS NOT NULL
                                   AND effective_date <= a.effective_date )
  ORDER BY emp_id, effective_date; 
```

输出：

```
 emp_id | name  |  region  | country |  city   | effective_date
--------+-------+----------+---------+---------+----------------
      1 | james | asia     | india   | mumbai  | 2012-04-10
      1 | james | germany  | germany | munich  | 2012-05-01
      2 | rick  | americas | us      | ny      | 2012-03-01
      3 | jane  | Europe   | UK      | London  | 2012-03-01
      3 | jane  | Canada   | Canada  | London  | 2012-05-01
      3 | jane  | Canada   | Canada  | Toronto | 2012-11-01
(6 rows) 
```

顺便说一句，我使用了“effective_date”而不是“when”。您正在使用诸如“何时”和“新”之类的关键字来表示只会令人困惑并导致悲伤的列。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T08:07:44.417

```
CREATE OR REPLACE
PROCEDURE P_GET_EMP_UPDATED(edate date) AS
 emp_rec emp_up%rowtype;
 query VARCHAR2(100);    
CURSOR emp_cur IS SELECT * FROM emp_up WHERE eff_date <= edate and eff_date >= sysdate; 
 BEGIN 
   OPEN emp_cur; 
   LOOP 
   FETCH emp_cur INTO emp_rec; 
   EXIT WHEN emp_cur%NOTFOUND;             
  -- query  := 'update emp set '||emp_rec.what||' =  ''' || emp_rec.new || ''' where empid = '|| emp_rec.empid;    
   --dbms_output.put_line (query); 

    EXECUTE IMMEDIATE  'update emp set '||emp_rec.what||' =  ''' || emp_rec.new || ''' where empid = '|| emp_rec.empid;

 END LOOP;   
 END P_GET_EMP_UPDATED; 
```

此过程将更新 emp 表直到需要的日期。然后将其回滚

```
 SAVEPOINT Emp_modify;
 --call procedure
  execute p_get_emp_updated(to_date('2012-06-03', 'YYYY-MM-DD'));
  select * from emp;  --These rows are from the temprorily updated table
  rollback to SAVEPOINT Emp_modify; 
```

从emp中选择*；//这将给出原始emp表

# perl - 未找到 create_wrapper 命令

> ID：10730927
> 
> 赞同：0
> 
> 时间：2012-05-24T03:56:34.443
> 
> 标签：perl, wrapper, openembedded

我正在尝试使用 OpenEmbedded 配方编译“perl”和“perl-native”。在我的 Linux 机器上，我安装了 perl 5.8.8。当我运行“bitbake perl-native”时，它会导致错误提示“找不到 create_wrapper 命令”。

我遇到了这个网页 [http://manpages.ubuntu.com/manpages/maverick/man3/Bio::Tools::Run::Phylo::Hyphy::Base.3pm.html](http://manpages.ubuntu.com/manpages/maverick/man3/Bio::Tools::Run::Phylo::Hyphy::Base.3pm.html)

它显示了命令。但我不确定如何将它合并到我的构建框架中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T14:46:02.853

我知道这已经很老了，但我遇到了同样的事情。

`create_wrapper(`) 是 oe-meta utils.bbclass 中的一个函数。

我正在使用具有更新的 perl 配方的 MontaVista，并将 create_wrapper() 函数从 oe-meta utils.bbclass 添加到我的 utils.bbclass

# java - 将对象强制转换为 byteArray

> ID：10730929
> 
> 赞同：4
> 
> 时间：2012-05-24T03:56:41.653
> 
> 标签：java

我有一个功能

```
 public static Object receviceSigAndData (Socket s) {
       byte[] data = null;
       try {
            DataInputStream din2 = new DataInputStream(s.getInputStream());
            int sig_len = 0;
            sig_len = din2.readInt();
            byte[] sig = new byte[sig_len];
            din2.readFully(sig);
            int data_len = 0;
            data_len = din2.readInt();
            data = new byte[data_len];     
            dsa.update(data);

       } catch (IOException ioe) {
                ioe.printStackTrace();
       } catch (Exception e) {
                e.printStackTrace();
       }

       return (Object)data;
   } 
```

该函数返回一个对象，如果对象是字节数组，我如何将对象转换为`byte[]`？

```
byte[] b = (?)receviceSigAndData (socket); 
```

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-24T04:01:58.013

通过查看您的代码：

*   你不需要将返回值向上转换为`Object`：因为它是向上转换的，所以它是隐式完成的（a`byte[]`也是静态的`Object`）
*   您可以使用特定的向下转换轻松地将a 转换`Object`为 a ：`byte[]``byte[] a = (byte[])obj`
*   像您这样返回 an 的方法`Object`是完全没有意义的，签名意味着有用且信息丰富。返回 an`Object`是您能做的信息最少的事情。如果您的方法旨在返回 a`byte[]`那么它的返回值应该是`byte[]`类型

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-24T04:55:57.347

这里有 2 个帮助方法，可让您将字节数组序列化和反序列化为对象。

```
public static Object deserializeBytes(byte[] bytes) throws IOException, ClassNotFoundException
{
    ByteArrayInputStream bytesIn = new ByteArrayInputStream(bytes);
    ObjectInputStream ois = new ObjectInputStream(bytesIn);
    Object obj = ois.readObject();
    ois.close();
    return obj;
}

public static byte[] serializeObject(Object obj) throws IOException
{
    ByteArrayOutputStream bytesOut = new ByteArrayOutputStream();
    ObjectOutputStream oos = new ObjectOutputStream(bytesOut);
    oos.writeObject(obj);
    oos.flush();
    byte[] bytes = bytesOut.toByteArray();
    bytesOut.close();
    oos.close();
    return bytes;
} 
```

# javascript - 无法在 EXTJS 多选中加载 JSON

> ID：10730937
> 
> 赞同：0
> 
> 时间：2012-05-24T03:57:36.567
> 
> 标签：javascript, servlets, extjs

我无法在 EXTJS 的多选框中显示条目。这是我的 EXTJS 多选和相应面板的代码：

```
var selectTrain = [{
    bodyStyle: 'padding:10px;',
    items:[{
        xtype: 'multiselect',
        fieldLabel: 'Multiselect',
        name: 'multiselect',
        width: 250,
        height: 200,
        id: 'selectTrain',
        store: new Ext.data.JsonStore({
            type: 'ajax',
            url:'http://abc.com/xyz',
            reader: 'json',
            autoLoad:true      
        }),
        ddReorder: true
    }]
}];

// combine all that into one huge form
var fp = new Ext.FormPanel({
    title: '',
    frame: true,
    labelWidth: 300,
    width: 800,
    renderTo:'report',
    bodyStyle: 'padding:0 10px 0;',
    items: [
        {
            layout: 'column',
            border: false,
            // defaults are applied to all child items unless otherwise specified by child item
            defaults: {
                columnWidth: '1',
                border: false
            },            
            items: [selectTrain]
        },
    ],
    buttons: [{
        text: 'Go',
        handler: function(){}
    },{
        text: 'Reset',
        handler: function(){
            fp.getForm().reset();
        }
    }]
}); 
```

我可以访问作为 servlet 的 URL [http://abc.com/xyz](http://abc.com/xyz)并在 Firebug 控制台上看到以下 JSON：

```
{"54850":"5.1(1t)d1(3)","54852":"5.1(1t)a2(3)","54853":"5.1(1t)l2(1)","54841":"1.2(4)S1(1)","54789":"5.3(1)T","54849":"5.1(1t)s1(2)","54854":"5.1(1t)l2(5)","54855":"5.1(1t)s2(6)","54847":"1.1(12a)SG"} 
```

[http://abc.com/xyz](http://abc.com/xyz)的 servlet 代码是：

```
 PrintWriter out = response.getWriter();
           JSONObject jsonObj=new JSONObject();
           for (Iterator iterator = allRelInfoPools.iterator(); iterator
            .hasNext();) {
               Vector v = (Vector) iterator.next();
               jsonObj.put((String)v.get(0),(String)v.get(1));

    }
           out.println(jsonObj); 
```

请告知，我哪里出错了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T05:31:12.683

您可能正在尝试发出跨域 AJAX 请求（例如，您的应用程序是从[http://def.com/](http://def.com/)加载的，但您正在尝试从[http://abc.com/加载 JSON xyz](http://abc.com/xyz)）。不幸的是，这是不允许的。

但是，您可以执行 JSONP 请求而不是 AJAX 请求。JSONP 所做的是将一个脚本标签注入到 DOM 中，它会强制它下载一个 JavaScript 文件，该文件将在其中保存您的 JSON 数据。然后，您应该能够检索您的数据。

幸运的是，EXTJS 允许您这样做。例如，在*您的*代码中，只需将from的`type`属性更改为。`store``ajax``jsonp`

`jsonObj`此外，更改 servlet 代码以使用基于 GET 查询的 JavaScript 函数调用“填充”变量`callback`（注意，`callback`当通过如下 URL 发出 GET 请求时检索 GET 查询：http: [//abc.com /xyz?callback=someCallbackFunction](http://abc.com/xyz?callback=someCallbackFunction)）。

这是您的最后一行的样子：

```
out.println(callbackParam + "(" + jsonObj + ");"); 
```

其中`callbackParam`是您从`callback`GET 查询的参数中获得的值。

# java - 替换 JAR 文件中的 XML 文件

> ID：10730941
> 
> 赞同：2
> 
> 时间：2012-05-24T03:57:56.433
> 
> 标签：java, xml, exception, file-not-found

我正在尝试在执行 JAR 文件时替换 XML 文件。但目前它带有一个 Java IO File not Found 异常。但我加倍检查路径，它是正确的。我想知道是否可以在 jar 文件中替换 xml 文件。如果是这样，它是如何完成的。谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T04:21:03.497

是的，你可以这么做。在您想尝试以下命令的地方创建目录。转到该目录并尝试：

```
>cd <to_your_dir>
>jar -xvf <jar_file_path_with_name> 
```

这会将罐子提取出来。更改要更改的文件并将其 jar 恢复：

```
>jar -cvf <out_jar_file_name> * 
```

确保您在提取 jar 的文件夹中运行此程序。您可以通过在两个 jar 上运行以下命令来验证内容结构：

```
>jar -tvf <jar_file_name> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-02-14T00:20:36.113

最简单的方法是：

```
# Find the file inside the jar
jar tvf <JarFile> | grep xml | less

# Extract your file
jar xvf <JarFile> <FilePath> 

# Edit your file

# Replace updated file in your jar
jar uvf <JarFile> <UpdatedFileWithSameName> 
```

# php - 致命错误：在非对象上调用成员函数 format()

> ID：10730947
> 
> 赞同：1
> 
> 时间：2012-05-24T03:59:10.327
> 
> 标签：php, function, object, format, member

我有一个包含下表的 html 文件：

```
<form action="wedding-ajax-support.php" method="get" id="wedding-table">
<table border="0"; align="center">
  <tr>
    <th scope="col">Key</th>
    <th scope="col">Value</th>
  </tr>
  <tr>
    <td><label for="date">Select the date on which your party will take place (mm/dd/yyyy): </label></td>

    <td>
      <input name="date" type="text" class="larger" id="date"  size="12" />
    </td>
  </tr>
  <tr>
    <td><label for="catering">Type the catering grade you would like (from 1 to 5) : </label></td>
    <td><input name="catering" type="text" class="larger" id="catering"  size="5" /></td>
  </tr>
  <tr>
    <td><label for="size">Type the number of people you are expecting to attend: </label></td>
    <td><input name="size" type="text" class="larger" id="size"  size="5" /></td>
  </tr>
  <tr>
    <td>Find me available venues, based on my preferences: </td>
    <td><input type="submit" name="submit" id="submit" value="GO!" class="larger" /></td>
  </tr>
</table> 
```

> 这些输入之一是日期。这是我现在唯一关心的事情，以保持简单。
> 
> 在另一个文件中，wedding-ajax-support.php（我在其中组织了我所有的 php 代码）在其他代码中我有这个：

```
$date = DateTime::createFromFormat('m/d/Y', $_GET['date']); 
```

$date = $date->format('Ymd'); // 更改日期的格式，因为用户输入的日期和数据库中的日期格式不同。

> 然后是一个简单的 echo $date; 只是为了测试它。

然后，回到我的主文件，我放了一个

```
<script type="text/javascript"> 
```

$("#wedding-table").load("wedding-ajax-support.php");

通过 jQuery 使用 ajax 将表格替换为更改格式的日期。

所以，当我加载我的网页时，表格应该在哪里，显示一条消息“致命错误：调用 /disks/diskh/zco/cotm2/public_html/wedding/ 中非对象上的成员函数 format() wedding-ajax-support.php 第 23 行调用堆栈：0.0002 333936 1\. {main}() /disks/diskh/zco/cotm2/public_html/wedding/wedding-ajax-support.php:0 "。

> 任何想法/建议将不胜感激，在此先感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T04:20:55.603

当“GET”变量作为 URL 中的查询参数传递时，Web 服务器会为 PHP 设置这些变量。在您的情况下，您将页面加载为`"wedding-ajax-support.php"`，这意味着该`_GET`变量实际上是空的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-14T20:56:34.543

错误告诉你结果

```
$date = DateTime::createFromFormat('m/d/Y', $_GET['date']); 
```

不是一个实例，`DateTime`但很可能`false`是因为正如[DateTime 的 php 文档所述](http://php.net/manual/de/datetime.createfromformat.php)`false`，如果它无法根据给定参数创建实例，则会返回。

所以随着

```
$date = $date->format('Y-m-d'); 
```

您正在尝试调用`format()`on方法`false`，这不是对象。

你应该找出`createFromFormat`失败的原因。可能是`$_GET['date']`它无法解析的格式，或者它只是空的。试着`var_dump($_GET)`找出答案。

正如另一个答案所指出的那样，`$_GET`变量被附加到 url，因此`$_GET['date']`要设置的 url 应该看起来像`wedding-ajax-support.php?date=xyz`例如。

不幸的是，我没有得到你试图用 javascript 做什么来进一步帮助你。

**编辑：哇这个帖子很老了。之前没看到，不好意思。**

# json - 使用 GetSetMethodNormalizer 到 Json 的 Doctrine 实体返回致命错误

> ID：10730949
> 
> 赞同：2
> 
> 时间：2012-05-24T03:59:21.073
> 
> 标签：json, doctrine-orm, entity

几天以来，我一直在使用 Doctrine 2 和 Zend 框架。我正在跨 yaml 文件生成我的实体。现在我遇到了一个问题，将我的实体 Doctrine 转换为 Json 格式（以便通过 AJAX 使用它）。

这是使用的代码：

```
 $doctrineobject = $this->entityManager->getRepository('\Entity\MasterProduct')->find($this->_request->id);
    $serializer = new \Symfony\Component\Serializer\Serializer(array(new Symfony\Component\Serializer\Normalizer\GetSetMethodNormalizer()), array('json' => new Symfony\Component\Serializer\Encoder\JsonEncoder()));

    $reports = $serializer->serialize($doctrineobject, 'json'); 
```

以下是我得到的回报：

致命错误：达到“100”的最大函数嵌套级别，正在中止！在 /Users/Sites/library/Symfony/Component/Serializer/Normalizer/GetSetMethodNormalizer.php 第 185 行

问题似乎与这里相同： [http ://comments.gmane.org/gmane.comp.php.symfony.symfony2/2659](http://comments.gmane.org/gmane.comp.php.symfony.symfony2/2659)

但没有提出适当的解决方案。

知道我该怎么做吗？

干杯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-19T15:24:59.043

我通过编写自己的 GetSetNormalizer 我的课程解决了同样的问题。在类中定义静态变量以进行分支

```
class LimitedRecursiveGetSetMethodNormalizer extends GetSetMethodNormalizer
{ 
public static $limit=2;
/**
 * {@inheritdoc}
 */
public function normalize($object, $format = null)
{
    $reflectionObject = new \ReflectionObject($object);
    $reflectionMethods = $reflectionObject->getMethods(\ReflectionMethod::IS_PUBLIC);

    $attributes = array();
    foreach ($reflectionMethods as $method) {
        if ($this->isGetMethod($method)) {
            $attributeName = strtolower(substr($method->name, 3));
            $attributeValue = $method->invoke($object);
            if (null !== $attributeValue && !is_scalar($attributeValue) && LimitedRecursiveGetSetMethodNormalizer::$limit>0) {
                LimitedRecursiveGetSetMethodNormalizer::$limit--;
                $attributeValue = $this->serializer->normalize($attributeValue, $format);
                LimitedRecursiveGetSetMethodNormalizer::$limit++;
            }

            $attributes[$attributeName] = $attributeValue;
        }
    }

    return $attributes;
}

/**
 * Checks if a method's name is get.* and can be called without parameters.
 *
 * @param ReflectionMethod $method the method to check
 * @return Boolean whether the method is a getter.
 */
private function isGetMethod(\ReflectionMethod $method)
{
    return (
        0 === strpos($method->name, 'get') &&
            3 < strlen($method->name) &&
            0 === $method->getNumberOfRequiredParameters()
    );
  } 
 } 
```

和用法

```
 LimitedRecursiveGetSetMethodNormalizer::$limit=3;
    $serializer = new Serializer(array(new LimitedRecursiveGetSetMethodNormalizer()), array('json' => new
    JsonEncoder()));
    $response =new Response($serializer->serialize($YOUR_OBJECT,'json')); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T05:06:25.723

[JMSSerializerBundle](http://jmsyst.com/bundles/JMSSerializerBundle)似乎可以很好地处理循环引用。

# nuget - 从 NuGet 安装时出现 ServiceStack 错误 - 不支持加密算法

> ID：10730956
> 
> 赞同：2
> 
> 时间：2012-05-24T04:00:11.590
> 
> 标签：nuget, servicestack

尝试通过 Nuget 1.8 将 ServiceStack 添加到控制台应用程序时，我收到以下消息...

> 此平台不支持指定的加密算法。

不幸的是，我坚持使用 WinXP SP3。ServiceStack 现在是否依赖于更新的东西？

**更新** 显然这是 NuGet v1.8 的问题。[根据http://nuget.codeplex.com/workitem/2240](http://nuget.codeplex.com/workitem/2240)，该问题已通过 NuGet v1.8.1 解决

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T12:56:57.373

我们将调查这个问题。同时，您可以从以下链接下载 1.7 vsix：http: [//nuget.codeplex.com/downloads/get/382255](http://nuget.codeplex.com/downloads/get/382255)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-30T09:20:24.597

更新 NuGet，问题将得到解决

# ruby-on-rails - 表单向导上的进度表

> ID：10730962
> 
> 赞同：1
> 
> 时间：2012-05-24T04:01:37.780
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, forms

我正在考虑实施 ryan bates railscast 中讨论的这个多步骤向导。[http://railscasts.com/episodes/346-wizard-forms-with-wicked](http://railscasts.com/episodes/346-wizard-forms-with-wicked)

我想知道如何实现进度表，例如您在 jquery 向导中看到的进度表，例如[http://www.jankoatwarpspeed.com/examples/webform_to_wizard/#](http://www.jankoatwarpspeed.com/examples/webform_to_wizard/#)。

有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T08:26:32.090

有两种主要类型的向导。

**首先。**

这正是 railscasts 中使用的那个。事实上，你将一个大的形式分解成几个较小的形式。也就是说，每个表单都有一个单独的视图。因此，您可以在每个视图中编写当前步骤。在这种情况下，您不需要使用 jQuery 插件。例如，就像在 railscasts 中一样，只需添加：

```
#/app/views/user_steps/personal.html.erb
<p>STEP 1: <b>Tell us a little about yourself</b></p>
<p>STEP 2: Where can we find you?</p>

#/app/views/user_steps/social.html.erb
<p>STEP 1: Tell us a little about yourself</p>
<p>STEP 2: <b>Where can we find you?</b></p> 
```

**第二个。**

这是一个大表格，由几个小表格共享。这就是您作为示例显示的内容。对于这种形式，您不需要使用 wicked，因为 jQuery 插件会自行完成所有工作。在步骤结束时，您只需在服务器上发送这个大表格。

jQuery 向导在表单验证中的问题：您在最后一步发送表单，但在前面的步骤中可能会出现错误。这个问题可以通过客户端验证部分解决：[https ://github.com/bcardarella/client_side_validations](https://github.com/bcardarella/client_side_validations)

# sql - 更改表以更改列名错误

> ID：10730963
> 
> 赞同：4
> 
> 时间：2012-05-24T04:01:39.437
> 
> 标签：sql, sql-server-2008

在这里，我尝试更改表以更改列名，但发生错误。

```
Alter table [dbo].[Users] 
CHANGE
username UserName varchar(50),
password PassWord varchar(50),
state State int,
name Name varchar(50),
license License varchar(50),
lansno LansNo varchar(50) ,
curcuit_no CurcuitNo varchar(50) ,
communism Communism varchar(100) ,
Olduid OldUid int ,
Is_hunter Is_Hunter bit ,
free_text [FreeText] text ,
country Country varchar(50) ,
curcuit Curcuit varchar(50) ,
license_territory LicenseTerritory [varchar](50) ,
forest Forest varchar(50) ,
association Association varchar(50),
hunt_ar Hunt_Ar varchar(50) ,
area Area varchar(50) ,
contract Contract varchar(50) ,
radio_frequency RadioFrequency varchar(50)
) 
```

发生此错误：

> 消息 102，级别 15，状态 1，第 2 行
> “更改”附近的语法不正确。

所以..我在这里尝试更改表更改旧列名新列名数据类型..但在这里我收到错误

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T04:23:34.233

尝试

```
EXEC sp_RENAME 'Users.username', 'UserName', 'Column'
... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T04:21:30.360

仔细看看语法

[更改表 (Transact-SQL)](http://msdn.microsoft.com/en-us/library/ms190273.aspx)

如果我没记错的`ALTER COLUMN`话`CHANGE COLUMN`

此外，您可能应该在这里阅读

[SQL SERVER – 如何重命名列名或表名](http://blog.sqlauthority.com/2008/08/26/sql-server-how-to-rename-a-column-name-or-table-name/)

# java - C99 客户端与 Java 服务器通信

> ID：10730976
> 
> 赞同：1
> 
> 时间：2012-05-24T04:03:25.580
> 
> 标签：java, c, sockets

我正在尝试让 C99 客户端与 Java 服务器进行通信。但是，Java 服务器接收的数据与传输的数据不同。（即@x�@Óf/ú.��@¨������������������Û¢ÁBp'ˇ¡`Ôf/）

我已经考虑过这是一个编码问题，但是我遇到了障碍。我已经尝试测试这两个程序，以得出 Java 服务器能够与 Java 客户端通信而 C 客户端能够与 C 服务器通信的结论。

但是我无法让 Java 服务器与 C 客户端进行通信。

Java代码：

```
serverSocket = new ServerSocket(port);  
Socket sock = serverSocket.accept();                               

BufferedReader in = new BufferedReader(new InputStreamReader(sock.getInputStream()));

String inputString = in.readLine();
System.out.println(inputString); 
```

C代码：

```
struct sockaddr_in sin;
struct hostent *host;

host = gethostbyname(hostname);

bzero(&(sin.sin_zero),8); 
sin.sin_port = htons(port);
sin.sin_addr = *((struct in_addr *)host->h_addr);
sin.sin_family = AF_INET;

sock = socket(AF_INET, SOCK_STREAM, 0);

if(connect(sock, (struct sockaddr *)&sin,sizeof(struct sockaddr_in)) == -1) 
```

...

```
send(sock, &message, strlen(message)+1, 0); 
```

**编辑：我尝试在两台主机之间发送“TEST”这个词，但没有成功。**

**修复：当我传递消息变量时，我在消息变量前面有一个 & 号。**

**本来应该：**

```
send(sock, message, strlen(message)+1, 0); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T04:13:31.317

我不确定 C99 是否提供了编码标准，但我想它是特定于实现的。可以是`US-ASCII`例如。

发生的情况是 Java `InputStreamReader`（或输出）使用在操作系统或 Java 安装（不确定在哪里）中指定的默认字符集，因此与 C 程序使用的字符集相比可能会有所不同。

您可以做的最好的事情是测试各种编码，`InputStreamReader`该类确实提供了一个特定的构造函数：

```
public InputStreamReader(InputStream in, Charset cs) 
```

您可以在其中指定要使用的字符集。在[这里](http://docs.oracle.com/javase/6/docs/api/java/nio/charset/Charset.html)查看可能的字符集。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T04:15:49.460

您还必须查看字节序差异：Java 使用[网络顺序](http://en.wikipedia.org/wiki/Endianness#Endianness_in_networking)，而 C 主机可能不使用。`ByteBuffer`，[在这里](https://stackoverflow.com/a/2212025/230513)说明，可能会有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T06:23:09.727

如果我没记错的话，你有类似的东西：

```
char *message = "Hello"; 
```

当您通过以下方式发送时：

```
send(sock, &message, strlen(message)+1, 0);
           |
           +---- Err. 
```

您发送消息的地址而不是消息本身，进一步将长度设置为消息的长度以及这样的垃圾填充。

如果您改为这样做：

```
send(sock, message, strlen(message)+1, 0); 
```

它应该工作。

或者使用`char message[] = "Hello";`……</p>

* * *

要进一步剖析服务器数据，您可以执行以下操作：

```
 int i = 0;
        for (char ch : inputString.toCharArray()) {
            System.out.printf("%2d: 0x%02X o%03o %3d %c%n",
                i++,
                (int)ch & 0xff,
                (int)ch & 0xff,
                (int)ch & 0xff,
                Character.isISOControl(ch) ? '.' : ch
            );
        } 
```

或者

```
 buf = inputLine.getBytes(/* charset  */);
        for (i = 0; i < buf.length; ++i) { 
```

等等

```
Client siad: Hello
 0: 0x00 o000   0 .
 1: 0x48 o110  72 H
 2: 0x65 o145 101 e
 3: 0x6C o154 108 l
 4: 0x6C o154 108 l
 5: 0x6F o157 111 o 
```

使用 &message:

```
Client said: `�
 0: 0x60 o140  96 `
 1: 0xEF o357 239 ￯
 2: 0xBF o277 191 ﾿
 3: 0xBD o275 189 ﾽ
 4: 0x04 o004   4 .
 5: 0x08 o010   8 . 
```

* * *

另一个可以做的黑客/调试/事情是：

```
 while (true) {
        in.mark(128);
        if ((inputLine = in.readLine()) == null)
            continue;

        System.out.println("Response: " + inputLine);

        in.reset();
        i = 0;
        while (in.ready()) {
            c = in.read();
            System.out.printf("%2d: 0x%02X o%03o %3d %c%n",
                i++,
                c, c, c,
                Character.isISOControl((char) c) ? '.' : (char)c
            );
        }
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-24T04:17:53.793

你的问题看起来像字节对齐

在您的`C`客户端中，您需要将**主机转换为网络字节顺序**。

采用

```
uint32_t htonl(uint32_t hostlong);

uint16_t htons(uint16_t hostshort);

uint32_t ntohl(uint32_t netlong);

uint16_t ntohs(uint16_t netshort); 
```

# android - 是否可以创建一个禁用所有屏幕菜单的儿童安全应用程序？

> ID：10730984
> 
> 赞同：0
> 
> 时间：2012-05-24T04:04:23.440
> 
> 标签：android

我正在尝试开发一个供婴儿/幼儿使用的图形应用程序，它将禁用所有屏幕菜单控件并需要按下其他一些按钮来中断活动。这可能吗？我希望她可以自由地触摸屏幕的任何部分，而不是让它调出菜单或返回活动堆栈。这是一种简单的手指绘画应用程序，但存在屏幕空间需要限制的问题。

谢谢你的时间，BBB

# drupal-7 - 如何显示菜单页面？

> ID：10730988
> 
> 赞同：0
> 
> 时间：2012-05-24T04:05:05.893
> 
> 标签：drupal-7, drupal-views

我建立了我的第一个 drupal 站点，并安装了具有我喜欢的漂亮下拉菜单的企业清洁模板。

测试站点： [http ://hostingindia123.com](http://hostingindia123.com)

如果有人点击菜单链接而不是下拉到他们想要的页面，它将加载空白节点页面，我将其设置为“节点”。而我希望如果有人点击父母链接，那么我希望加载新页面，显示其下的所有子分类术语或节点页面。

例如：如果有人点击我们学校，那么该页面应将历史记录显示为该页面中的链接，类似地，当有人点击历史记录时，历史记录具有子菜单项，它应该将子菜单项显示为历史记录页面的链接，我听说这可以通过使用 VIEWS 来完成，但我不知道我该怎么做......

可能吗？？？

多谢你们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T21:11:47.883

你说的是两种不同的情况。一个显示子页面，一个显示分类。以下是实现这两种场景所需的模块。

这将帮助您将当前**页面**的子页面添加到块中：
菜单块 - [http://drupal.org/project/menu_block](http://drupal.org/project/menu_block)

这将有助于将**分类菜单**添加到块中：
分类菜单 - [http://drupal.org/project/taxonomy_menu](http://drupal.org/project/taxonomy_menu)

# c# - 如何读取与数据混合的位标志？

> ID：10730991
> 
> 赞同：1
> 
> 时间：2012-05-24T04:05:47.093
> 
> 标签：c#, binaryreader, bitflags, flac

我以前从未想过阅读二进制数据。我现在正在尝试学习，并制作一个简单的应用程序来从 FLAC 文件中读取标题数据并以人类可读的格式显示信息。

首先，假设我感兴趣的数据的第一位是 0x10000100，我如何使用 C# 读取第一位 (1)，然后读取存储在后续 7 位中的 int 值？我已经知道如何使用 binaryreader 将字节读入字节数组......只是不知道如何在代码中解析这些数据。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T04:13:19.427

Binray "and" `&`、 "or" `|`、 "not"`~`用于提取位。

这是大概的代码：

```
byte value = 0x84;
bool flag = (value & 0x80) != 0;
var intPart = value & ~0x80; 
```

# function - cakephp 数据检索

> ID：10730996
> 
> 赞同：0
> 
> 时间：2012-05-24T04:06:16.407
> 
> 标签：function, cakephp, information-retrieval

我正在尝试创建一个会吐出用户发票的页面。我在检索特定用户发票时遇到问题。问题在于控制器中的功能和设置 $id。我不确定如何将其设置为当前用户。

这是我函数中的相关代码

```
public function payInvoice(){

    $this->set('title_for_layout', 'Pay Invoice');
    $this->set('stylesheet_used', 'homestyle');
    $this->set('image_used', 'eBOXLogoHome.jpg');   
    $this->layout='home_layout';
    $userid = $this->Auth->user('id');
    $this->set('Invoices', $this->Invoice->findByBiller($userid));
} 
```

这是包含我观点的答案：

```
<table width="100%" border="1">
                <tr>
                    <th>Biller</th>
                    <th>Subject</th>
                    <th>Date</th>
                    <th>Action</th>
                </tr>

                <?php foreach($Invoices as $invoice):?>
                    <tr> 
                        <td align='center'><?php echo $this->Html->link($Invoices['Invoice']['to'], 
                        array('action' => 'viewInvoice', $Invoices['Invoice']['to'])); ;?> </td>
                        <td align='center'><?php echo $Invoices['Invoice']['subject']; ?></td>
                        <td align='center'><?php echo $Invoices['Invoice']['datecreated']; ?></td>
                        <td align='center'><a href="viewinvoice"><button>View Invoice</button></a><a href="disputeinvoice"><button>Dispute Invoice</button></a></td>
                    </tr>
                <?php endforeach; ?>

            </table> 
```

在代码中，我对其进行了硬编码，因此用户 15 可以查看他的所有发票，但我不希望我的系统被硬编码。我希望将其设置为，`$id='currentuser'`但不确定如何对其进行编码。

用户登录功能

```
 public function login() {

    $this->set('title_for_layout', 'Individual Registration');
    $this->set('stylesheet_used', 'style');
    $this->set('image_used', 'eBOXLogo.jpg');

    if ($this->request->is('post')){
    $this->request->data['User']['password'] = 'qazwsx';
   if ($this->Auth->login()) {

       $this->redirect($this->Auth->redirect('eboxs/home'));
       $this->Session->write('Myid',$myid);
    } 
    else {
        $this->Session->setFlash('Username or password is incorrect');
    }
    }else{
    $this->Session->setFlash('Welcome, please login');
    }

} 
```

任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T05:11:11.127

当用户成功登录时，您在会话中设置他的 ID，例如，

```
 $this->Session->write('Myid',$myid); 
```

`$myid`当用户名和密码正确时从数据库中获取

并获取控制器中的任何位置，例如，

```
 $id = $this->Session->read('Myid'); 
```

而且你不需要添加到 app_controller 文件中

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T05:02:36.177

对于当前用户，您需要进行会话，我假设会话包含 user_id。尝试这个

```
public function payInvoice(){
        $id=$this->Session->read('user_id');
        $this->set('title_for_layout', 'Pay Invoice');
        $this->set('stylesheet_used', 'homestyle');
        $this->set('image_used', 'eBOXLogoHome.jpg');   
        $this->layout='home_layout';
        $this->set('Invoices', $this->Invoice->findByBiller($id));
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T04:10:44.327

为什么不分配一个会话 id，其值为 user_id？

# zend-framework - 使用临时 URL 运行 Zend Framework

> ID：10730998
> 
> 赞同：0
> 
> 时间：2012-05-24T04:06:19.107
> 
> 标签：zend-framework, .htaccess

我正在使用 Zen 框架开发应用程序，该应用程序在一台服务器上正常运行，但我必须将其移动到不同的（共享）主机，是否可以使用临时 url 运行 zend 框架？

通过临时网址，我指的是这样的内容：http: [//xx.xxx.xxx.xxx/~username](http://xx.xxx.xxx.xxx/~username)

如果是这样，你能分享一个 .htaccess 使这成为可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T20:04:11.067

您可以使用 mod_rewrite 创建重定向：

```
RewriteEngine On

RewriteRule ^\.htaccess$ - [F]
RewriteCond %{REQUEST_URI} =""
RewriteRule ^.*$ /public/index.php [NC,L]

RewriteCond %{REQUEST_URI} !^/public/.*$
RewriteRule ^(.*)$ /public/$1

RewriteCond %{REQUEST_FILENAME} -f
RewriteRule ^.*$ - [NC,L]

RewriteRule ^public/.*$ /public/index.php [NC,L] 
```

在您的 init 文件夹中创建一个文件：**.htaccess**并将代码放在上面