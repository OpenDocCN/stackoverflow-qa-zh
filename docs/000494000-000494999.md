# StackOverflow 问答 000494000-000494999

# objective-c - 如何添加两个 NSNumber 对象？

> ID：494002
> 
> 赞同：84
> 
> 时间：2009-01-29T23:54:46.207
> 
> 标签：objective-c, math, nsnumber

现在这一定很容易，但是如何将两个相加`NSNumber`呢？就好像：

```
[one floatValue] + [two floatValue] 
```

还是存在更好的方法？

* * *

## 回答 #1

> 赞同：148
> 
> 时间：2009-01-30T00:02:09.377

真的没有更好的方法，但如果你能避免它，你真的不应该这样做。`NSNumber`作为标量数字的包装器存在，因此您可以将它们存储在集合中并与 other 多态地传递它们`NSObjects`。它们并不真正用于在实际数学中存储数字。如果你对它们进行数学运算，它比仅对标量执行操作要慢得多，这可能就是为什么没有方便的方法的原因。

例如：

```
NSNumber *sum = [NSNumber numberWithFloat:([one floatValue] + [two floatValue])]; 
```

在消息发送上至少有 21 条指令，无论这些方法需要多少代码来拆箱和重新装箱值（可能是几百个）来做 1 条指令的数学运算。

因此，如果您需要将数字存储在 dicts 中，请使用 an `NSNumber`，如果您需要将可能是数字或字符串的内容传递给函数，请使用 an `NSNumber`，但如果您只想使用标量 C 类型进行数学运算。

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2011-06-23T19:48:59.490

[NSDecimalNumber](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSDecimalNumber_Class/Reference/Reference.html)（[NSNumber](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSNumber_Class/Reference/Reference.html#//apple_ref/occ/cl/NSNumber)的子类）具有您正在寻找的所有好东西：

```
– decimalNumberByAdding:
– decimalNumberBySubtracting:
– decimalNumberByMultiplyingBy:
– decimalNumberByDividingBy:
– decimalNumberByRaisingToPower: 
```

...

如果对计算性能感兴趣，则转换为 C++ 数组 std::vector 等。

现在我再也不用 C-Arrays 了。使用错误的索引或指针太容易崩溃。将每个新的 [] 与 delete[] 配对非常乏味。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2013-11-14T14:15:03.033

您可以使用

```
NSNumber *sum = @([first integerValue] + [second integerValue]); 
```

编辑：正如*ohho*所观察到的，此示例用于将两个`NSNumber`保存整数值的实例相加。如果您想将两个`NSNumber`保存浮点值的 ' 相加，您应该执行以下操作：

```
NSNumber *sum = @([first floatValue] + [second floatValue]); 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2017-01-17T16:22:47.187

当前[投票最多的答案](https://stackoverflow.com/a/494017/39155)将导致难以诊断的错误和由于使用浮点数而导致的精度损失。如果您对 NSNumber 值进行数字操作，则应先转换为 NSDecimalNumber 并改为对这些对象执行操作。

从[文档](https://developer.apple.com/reference/foundation/nsdecimalnumber?language=objc)中：

> NSDecimalNumber 是 NSNumber 的不可变子类，它提供了一个面向对象的包装器，用于进行 base-10 算术。实例可以表示可以表示为尾数 x 10^exponent 的任何数字，其中尾数是最多 38 位长的十进制整数，指数是从 –128 到 127 的整数。

因此，您应该通过 将您的 NSNumber 实例转换为 NSDecimalNumbers `[NSNumber decimalValue]`，执行您想要的任何算术运算，然后在完成后分配回 NSNumber 。

在 Objective-C 中：

```
NSDecimalNumber *a = [NSDecimalNumber decimalNumberWithDecimal:one.decimalValue]
NSDecimalNumber *b = [NSDecimalNumber decimalNumberWithDecimal:two.decimalValue]
NSNumber *result = [a decimalNumberByAdding:b] 
```

在斯威夫特 3 中：

```
let a = NSDecimalNumber(decimal: one.decimalValue)
let b = NSDecimalNumber(decimal: two.decimalValue)
let result: NSNumber = a.adding(b) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-02-20T08:06:13.507

为什么不使用`NSxEpression`？

```
NSNumber *x = @(4.5), *y = @(-2);

NSExpression *ex = [NSExpression expressionWithFormat:@"(%@ + %@)", x, y];
NSNumber *result = [ex expressionValueWithObject:nil context:nil];

NSLog(@"%@",result); // will print out "2.5" 
```

您还可以构建一个 NSExpression ，它可以被重用以使用不同的参数进行评估，如下所示：

```
NSExpression *expr = [NSExpression expressionWithFormat: @"(X+Y)"];
NSDictionary *parameters = [NSDictionary dictionaryWithObjectsAndKeys:x, @"X", y, @"Y", nil];
NSLog(@"%@", [expr expressionValueWithObject:parameters context:nil]); 
```

例如，我们可以循环评估相同的解析表达式，每次使用不同的“Y”值：

```
 for (float f=20; f<30; f+=2.0) {
    NSDictionary *parameters = [NSDictionary dictionaryWithObjectsAndKeys:x, @"X", @(f), @"Y", nil];
    NSLog(@"%@", [expr expressionValueWithObject:parameters context:nil]);
 } 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2015-05-17T13:09:31.583

在 Swift 中，您可以使用 Bolt_Swift 库[https://github.com/williamFalcon/Bolt_Swift](https://github.com/williamFalcon/Bolt_Swift)获得此功能。

例子：

```
 var num1 = NSNumber(integer: 20)
  var num2 = NSNumber(integer: 25)
  print(num1+num2) //prints 45 
```

# c# - User.Identity.Name 中的全名而不是域 id

> ID：494006
> 
> 赞同：18
> 
> 时间：2009-01-29T23:58:37.323
> 
> 标签：c#, authentication, identity, adsi

该`User.Identity.Name`属性返回域登录 ID。

哪个类/属性公开了实际的用户名？

对于登录到提供 my_domain\jdoe 的 Web 应用程序的用户“John Doe”

```
**User.Identity.Name -** 
Returns : *my_domain\jdoe*

**System.Environment.UserName**
Returns: *jdoe* 
```

哪个类/属性返回？...“约翰·多伊”

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-30T00:10:29.030

如果您正在考虑 Active Directory，则需要找到与给定 samAccountName 对应的 UserPrincipal 并从中获取 DisplayName 属性。请注意，它可能未设置。

```
string fullName = null;
using (PrincipalContext context = new PrincipalContext( ContextType.Domain ))
{
    using (UserPrincipal user
            = UserPrincipal.FindByIdentity( context,
                                            User.Identity.Name ))
    {
        if (user != null)
        {
            fullName = user.DisplayName;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-30T00:09:00.830

听起来您不是登录名，而是 Active Directory 用户帐户的显示名。您可能想要做的是执行 AD 搜索 (DirectorySearcher) 并从搜索结果属性中获取显示名称。

我假设您处于 AD 环境中，因为您标记了问题 adsi。

**注意：**如果您使用的是 .NET 3.5，您可能需要查看 tvanfosson 的帖子。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-30T00:06:13.220

IIdentity 接口是在 User.Identity 上提供 Name 属性的接口。IIdentity 接口可以在任意数量的类上实现，这些类知道如何从数据存储（SQL Server、Active Directory 等）中查找用户。

IIdentity 接口没有提供“John Doe”的属性。如果该信息位于您的数据存储中，那么您将需要使用特定于该数据存储的工具来访问它。

也就是说，User.Identity 返回的对象完全有可能具有包含“John Doe”的属性，您可以通过 IIdentity 之外的其他接口访问该属性（例如，我们的自定义 IIdentity 实现就是这样做的）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-01-19T18:28:56.223

也许我在某个地方犯了一个错误，但是 WinNT://... 对我来说没有为域帐户工作。此外，如果用户与机器不在同一个域中，那么 PrincipalContext 可能找不到想要的元素（因为它在当前上下文中搜索，如果如上所述使用）。

以下内容应将 User.Identity.Name 提供的“友好域名”转换为符合 ldap 的域。使用域的 distinctName 提供所需的 ldap 路径信息（这已经解决了我的跨域问题）：

```
(VB.NET, sorry)
Imports System.DirectoryServices
Imports System.DirectoryServices.AccountManagement
Imports System.DirectoryServices.ActiveDirectory
...

Dim strUserName As String
Dim objDirContext As DirectoryContext
Dim objContext As PrincipalContext
Dim objPrincipal As Principal
Dim strLDAPDomainPath As String
...

// User.Identity.Name delivers domain\account or account@domain
// Split User.Identity.Name in domain and account as specified above
strDomain = "my_domain"
strAccount = "jdoe"

// Get LDAP domain relative path (distinguishName) from short domain name (e.g. my_domain -> us.my_domain.com -> DC=us,DC=my_domain,DC=com)
Try
    objDirContext = New DirectoryContext(DirectoryContextType.Domain, strDomain)
    strLDAPDomainPath = Domain.GetDomain(objDirContext).GetDirectoryEntry.Properties("distinguishedName").Value.ToString
Catch objException As DirectoryServicesCOMException
    Throw New Exception("Couldn't get LDAP domain: " & objException.Message)
End Try

// Find user in LDAP
// Nothing results in using current domain controller
Try
   objContext = New PrincipalContext(ContextType.Domain, Nothing, strLDAPDomainPath)
   objPrincipal = Principal.FindByIdentity(objContext, IdentityType.Name, strAccount)

   If Not IsNothing(objPrincipal) Then
      strUserName = objPrincipal.DisplayName
   End If
Catch objException As Exception
   Throw New Exception("Couldn't get user display name: " & objException.Message)
End Try

// strUserName should now contain the wanted full name 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-30T00:14:57.150

```
using System.DirectoryServices;

public static string GetFullName(string strLogin)
    {
        string str = "";
        string strDomain;
        string strName;

        // Parse the string to check if domain name is present.
        int idx = strLogin.IndexOf('\\');
        if (idx == -1)
        {
            idx = strLogin.IndexOf('@');
        }

        if (idx != -1)
        {
            strDomain = strLogin.Substring(0, idx);
            strName = strLogin.Substring(idx + 1);
        }
        else
        {
            strDomain = Environment.MachineName;
            strName = strLogin;
        }

        DirectoryEntry obDirEntry = null;
        try
        {
            obDirEntry = new DirectoryEntry("WinNT://" + strDomain + "/" + strName);
            System.DirectoryServices.PropertyCollection coll = obDirEntry.Properties;
            object obVal = coll["FullName"].Value;
            str = obVal.ToString();
        }
        catch (Exception ex)
        {
            str = ex.Message;
        }
        return str;
    } 
```

你可以打电话

```
var strJonDoeName = GetFullName(User.Identity.Name) 
```

[代码从这里](http://milanl.blogspot.com/2008/08/retrieve-full-name-from-active.html)模拟它

# lamp - 透明记录下载的最佳方式？

> ID：494016
> 
> 赞同：3
> 
> 时间：2009-01-30T00:01:53.667
> 
> 标签：lamp, download

我有一个个人项目已经上线一段时间了。我一直通过这样做来记录下载量：

*   当用户单击下载链接时，它会点击一个将一些信息写入表的 PHP 脚本。
*   写入数据后，脚本将返回实际文件的路径。
*   然后，用户可以将文件保存到他们的硬盘上，就好像它是任何其他下载一样。

这已经足够好一段时间了。但是，它会阻止用户这样做，`right-click > save target as...`因为他们实际上只会看到`download.php`出现在“文件保存..”对话框中。因此，下载项目的唯一方法是左键单击链接。

我想改进这个过程，以便用户可以使用他/她最舒服的任何方法下载项目。那么，有什么更好的方法可以透明地记录下载而不妨碍用户呢？

**值得**一提的是，这台机器是标准的 LAMP 堆栈，所以这里没有 .NET 选项。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-30T00:18:32.230

这取自[php-documentation](http://www.php.net/header)，但也可以使用不同的脚本语言：

```
<?php
// We'll be outputting a PDF
header('Content-type: application/pdf');

// It will be called downloaded.pdf
header('Content-Disposition: attachment; filename="downloaded.pdf"');

// The PDF source is in original.pdf
readfile('original.pdf');
?> 
```

HTTP-Header Content-Disposition 告诉它将其保存为下载。

另一种选择是定期检查您的日志文件，就像每天使用脚本一样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-30T00:08:12.157

这就是许多网站使用下载链接将您带到另一个页面的原因，该页面将在页面加载时自动开始下载，并为用户提供直接下载的链接。大多数情况下，这是一种获取广告印象页面浏览量的方法，但它也有助于更轻松地跟踪谁在下载他们的文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-30T00:11:55.813

该[答案](https://stackoverflow.com/questions/146/how-do-i-track-file-downloads-with-apache-php/152#152)详细说明了如何使用传输页面记录下载以及在有人单击链接后立即开始下载文件。我最近测试了它的右键单击。

我正在使用 php 中间人来记录文件下载。[格式为http://192.168.1.1/xfer.php?file=Li9zb25ncy9HTE9XX0xlYXZlIFlvdXIgSGF0IE9uLm1wMw](http://192.168.1.1/xfer.php?file=Li9zb25ncy9HTE9XX0xlYXZlIFlvdXIgSGF0IE9uLm1wMw)的 URL会在 Firefox 中生成另存为...和左键单击的文件名。

这是我的 xfer.php

```
<?
$filename = base64_url_decode($_GET['file']);
if ($_GET['file']){
    header("Cache-Control: public");
    header("Content-Description: File Transfer");
    header('Content-disposition: attachment; filename='.str_replace(" ", "_",basename($filename)));
    header("Content-Transfer-Encoding: binary");
    header('Content-Length: '. filesize($filename));
    readfile($filename);
}
$fh = fopen("test.html","a");
fwrite($fh,basename($filename)."\n<br />");
fclose($fh);
function base64_url_decode($input) {
    return base64_decode(strtr($input, '-_,', '+/='));
}
?> 
```

链接到 xfer.php 的页面是

```
$link = "xfer.php?file=".base64_url_encode("./songs/$key"); 
```

是`$key`文件名，`songs`是保存文件名的文件夹。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-30T01:40:19.927

设置谷歌分析？:)

# c# - 如何在 C# 中检测 NTFS 挂载的文件夹？

> ID：494022
> 
> 赞同：2
> 
> 时间：2009-01-30T00:04:46.920
> 
> 标签：c#, directory, ntfs, mount

曾几何时，我读过您如何以编程方式检测已挂载的 NTFS 文件夹（在搜索文件夹时会导致循环递归）。现在我找不到链接..有谁知道该怎么做？

我有兴趣检测的安装是一个文件夹安装到另一个文件夹时。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-30T01:41:06.103

我假设您的意思是[NTFS 连接](http://en.wikipedia.org/wiki/NTFS_junction_point)？有一个[非托管 API](http://msdn.microsoft.com/en-us/library/aa364571(VS.85).aspx)可以获取重解析点，然后您必须[查询](http://msdn.microsoft.com/en-us/library/aa365511(VS.85).aspx)它以查看它是否实际上是一个联结点。当然，这一切都[可以通过 P/Invoke](http://www.codeproject.com/KB/files/JunctionPointsNet.aspx)获得。

但是，大多数人只是（1）在[DirectoryInfo.GetDirectories](http://msdn.microsoft.com/en-us/library/s7xk2b58.aspx)返回的[属性](http://msdn.microsoft.com/en-us/library/system.io.filesysteminfo.attributes.aspx)列表中查找[ReparsePoint](http://msdn.microsoft.com/en-us/library/system.io.fileattributes.aspx)。

(1) 注意 NTFS Junction 是一种*特殊类型的重解析点*，但不是唯一的。符号链接、~~硬链接、~~ (2) 和任何其他用户定义的数据也是重解析点。

(2) 哎呀。硬链接不是重解析点，[它们只是指向同一个文件的标准目录条目](http://technet.microsoft.com/en-us/library/cc781134.aspx)。感谢[鲁本](https://stackoverflow.com/users/41646/reuben)纠正我的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-30T18:30:19.593

通过 WMI 执行此操作。请参阅以下示例： http: [//msdn.microsoft.com/en-us/library/aa393244 (VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa393244(VS.85).aspx)

或尝试使用[WMI Code Creator](http://www.microsoft.com/downloads/details.aspx?familyid=2cc30a64-ea15-4661-8da4-55bbc145c30e&displaylang=en)制作的示例代码：

```
 using System;
using System.Management;
using System.Windows.Forms;

namespace WMISample
{
    public class MyWMIQuery
    {
        public static void Main()
        {
            try
            {
                ManagementObjectSearcher searcher = 
                    new ManagementObjectSearcher("root\\CIMV2", 
                    "SELECT * FROM Win32_DiskPartition"); 

                foreach (ManagementObject queryObj in searcher.Get())
                {
                    Console.WriteLine("-----------------------------------");
                    Console.WriteLine("Win32_DiskPartition instance");
                    Console.WriteLine("-----------------------------------");
                    Console.WriteLine("Type: {0}", queryObj["Type"]);
                }
            }
            catch (ManagementException e)
            {
                MessageBox.Show("An error occurred while querying for WMI data: " + e.Message);
            }
        }
    }
} 
```

# .net - 寻找一个 .NET 库来进行支持多个来源的身份验证

> ID：494026
> 
> 赞同：2
> 
> 时间：2009-01-30T00:08:08.350
> 
> 标签：.net, asp.net, asp.net-mvc, asp.net-membership, membership

我正在寻找一个 .NET 库的建议，它可以让我在 ASP.NET 应用程序中使用，以便我为每个用户拥有一个配置文件，但可以关联来自多个来源的身份验证，包括：基于 ASP.NET 表单的 Windows live id、google、facebook、openid 等...我希望人们访问我的网站并能够关联任何这些凭据，以便他们可以使用一个或多个来源进行身份验证。我专门要求一个 ASP.NET MVC 项目。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-30T00:45:41.287

安德鲁，

您可能很难找到一个（免费的）单一库来与所有提到的提供者交互。查看[Codeplex](http://www.codeplex.com)上 的[Altairis Id Tool kit](http://www.codeplex.com/AltairisIdToolkit)之类的东西，看看你是否可以使用它。否则，我认为您最好的选择是在现有的 Asp.Net 成员提供程序模型之上构建，然后查看[Codeplex](http://www.codeplex.com)以获取您想要插入的不同提供程序。

这里有一些建议...

[打开ID](http://www.codeplex.com/OpenIDMembership)

[Facebook](http://www.codeplex.com/FacebookNET)

[谷歌](http://www.codeplex.com/AltairisIdToolkit)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-02-03T18:56:12.993

Dotnetopenauth 是多个 openid 登录的不错选择[http://www.dotnetopenauth.net/](http://www.dotnetopenauth.net/)

# javascript - 如何在正则表达式中使用变量？

> ID：494035
> 
> 赞同：1690
> 
> 时间：2009-01-30T00:11:05.160
> 
> 标签：javascript, regex

我想`String.replaceAll()`在 JavaScript 中创建一个方法，我认为使用正则表达式是最简洁的方法。但是，我不知道如何将变量传递给正则表达式。我已经可以这样做了，这将替换`"B"`with的所有实例`"A"`。

```
"ABABAB".replace(/B/g, "A"); 
```

但我想做这样的事情：

```
String.prototype.replaceAll = function(replaceThis, withThis) {
    this.replace(/replaceThis/g, withThis);
}; 
```

但显然这只会替换文本`"replaceThis"`......那么我如何将此变量传递给我的正则表达式字符串？

* * *

## 回答 #1

> 赞同：2192
> 
> 时间：2009-01-30T00:15:40.643

`/regex\d/g`您可以构造一个新的[RegExp](https://developer.mozilla.org/en-US/docs/JavaScript/Guide/Regular_Expressions)对象，而不是使用语法：

```
var replace = "regex\\d";
var re = new RegExp(replace,"g"); 
```

您可以通过这种方式动态创建正则表达式对象。然后你会做：

```
"mystring1".replace(re, "newstring"); 
```

* * *

## 回答 #2

> 赞同：248
> 
> 时间：2009-01-30T01:02:03.700

正如 Eric Wendelin 提到的，您可以执行以下操作：

```
str1 = "pattern"
var re = new RegExp(str1, "g");
"pattern matching .".replace(re, "regex"); 
```

这产生`"regex matching ."`. 但是，如果 str1 是 ，它将失败`"."`。您希望结果是`"pattern matching regex"`，用 替换句点`"regex"`，但结果是......

```
regexregexregexregexregexregexregexregexregexregexregexregexregexregexregexregexregexregex 
```

这是因为，虽然`"."`它是一个字符串，但在 RegExp 构造函数中，它仍被解释为正则表达式，表示任何非换行符，表示字符串中的每个字符。为此，以下功能可能有用：

```
 RegExp.quote = function(str) {
     return str.replace(/([.?*+^$[\]\\(){}|-])/g, "\\$1");
 }; 
```

然后你可以这样做：

```
str1 = "."
var re = new RegExp(RegExp.quote(str1), "g");
"pattern matching .".replace(re, "regex"); 
```

屈服`"pattern matching regex"`。

* * *

## 回答 #3

> 赞同：137
> 
> 时间：2009-02-01T03:43:49.100

> `"ABABAB".replace(/B/g, "A");`

与往常一样：除非必须，否则不要使用正则表达式。对于简单的字符串替换，成语是：

```
'ABABAB'.split('B').join('A') 
```

那么您不必担心 Gracenotes 的回答中提到的引用问题。

* * *

## 回答 #4

> 赞同：91
> 
> 时间：2018-06-13T02:52:17.097

如果你想得到*所有*的出现（`g`），不区分大小写（`i`），并使用边界，以便它不是另一个词中的一个词（`\\b`）：

```
re = new RegExp(`\\b${replaceThis}\\b`, 'gi'); 
```

* * *

例子：

```
let inputString = "I'm John, or johnny, but I prefer john.";
let replaceThis = "John";
let re = new RegExp(`\\b${replaceThis}\\b`, 'gi');
console.log(inputString.replace(re, "Jack")); // I'm Jack, or johnny, but I prefer Jack. 
```

* * *

## 回答 #5

> 赞同：37
> 
> 时间：2012-11-28T15:32:33.143

对于希望通过**match**方法使用变量的任何人，这对我有用：

```
var alpha = 'fig';
'food fight'.match(alpha + 'ht')[0]; // fight 
```

* * *

## 回答 #6

> 赞同：36
> 
> 时间：2009-01-30T00:19:19.030

这：

```
var txt=new RegExp(pattern,attributes); 
```

相当于：

```
var txt=/pattern/attributes; 
```

请参阅[http://www.w3schools.com/jsref/jsref_obj_regexp.asp](http://www.w3schools.com/jsref/jsref_obj_regexp.asp)。

* * *

## 回答 #7

> 赞同：31
> 
> 时间：2009-01-30T00:16:39.580

```
this.replace( new RegExp( replaceThis, 'g' ), withThis ); 
```

* * *

## 回答 #8

> 赞同：19
> 
> 时间：2014-09-14T19:55:19.087

您需要动态构建正则表达式，为此**您必须使用`new RegExp(string)`带有转义的构造函数**。

[jQuery UI 自动完成小部件](https://api.jqueryui.com/autocomplete/)中有一个内置功能，称为`$.ui.autocomplete.escapeRegex`：

> 它将采用单个字符串参数并转义所有正则表达式字符，使结果可以安全地传递给`new RegExp()`.

如果您不使用 jQuery UI，您可以[从源代码](https://github.com/jquery/jquery-ui/blob/main/ui/widgets/autocomplete.js)复制其定义：

```
function escapeRegex( value ) {
    return value.replace( /[\-\[\]{}()*+?.,\\\^$|#\s]/g, "\\$&" );
} 
```

并像这样使用它：

```
"[z-a][z-a][z-a]".replace(new RegExp(escapeRegex("[z-a]"), "g"), "[a-z]");
//            escapeRegex("[z-a]")       -> "\[z\-a\]"
// new RegExp(escapeRegex("[z-a]"), "g") -> /\[z\-a\]/g
// end result                            -> "[a-z][a-z][a-z]" 
```

* * *

## 回答 #9

> 赞同：10
> 
> 时间：2009-02-01T09:14:23.940

```
String.prototype.replaceAll = function (replaceThis, withThis) {
   var re = new RegExp(replaceThis,"g"); 
   return this.replace(re, withThis);
};
var aa = "abab54..aba".replaceAll("\\.", "v"); 
```

用这个[工具测试](http://www.pagecolumn.com/tool/regtest.htm)

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2013-08-20T12:35:29.403

```
String.prototype.replaceAll = function(a, b) {
    return this.replace(new RegExp(a.replace(/([.?*+^$[\]\\(){}|-])/ig, "\\$1"), 'ig'), b)
} 
```

像这样测试它：

```
var whatever = 'Some [b]random[/b] text in a [b]sentence.[/b]'

console.log(whatever.replaceAll("[", "<").replaceAll("]", ">")) 
```

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2014-11-25T23:31:18.040

[还有Steven Penny 回答](https://stackoverflow.com/questions/494035/how-do-you-use-a-variable-in-a-regular-expression/13608644#13608644)的 CoffeeScript 版本，因为这是 Google 结果的第 2 位……即使 CoffeeScript 只是删除了很多字符的 JavaScript……；）

```
baz = "foo"
filter = new RegExp(baz + "d")
"food fight".match(filter)[0] // food 
```

在我的特殊情况下：

```
robot.name = hubot
filter = new RegExp(robot.name)
if msg.match.input.match(filter)
  console.log "True!" 
```

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2013-06-05T04:22:42.170

为了满足我将变量/别名/函数插入正则表达式的需要，这就是我想出的：

```
oldre = /xx\(""\)/;
function newre(e){
    return RegExp(e.toString().replace(/\//g,"").replace(/xx/g, yy), "g")
};

String.prototype.replaceAll = this.replace(newre(oldre), "withThis"); 
```

其中“oldre”是我要插入变量的原始正则表达式，“xx”是该变量/别名/函数的占位符，“yy”是实际的变量名称、别名或函数。

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2021-03-22T23:52:46.207

您可以将字符串用作正则表达式。不要忘记使用**新的 RegExp**。

例子：

```
var yourFunction = new RegExp(
        '^-?\\d+(?:\\.\\d{0,' + yourVar + '})?'
      ) 
```

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2013-05-08T10:30:36.653

这是另一个 replaceAll 实现：

```
 String.prototype.replaceAll = function (stringToFind, stringToReplace) {
        if ( stringToFind == stringToReplace) return this;
        var temp = this;
        var index = temp.indexOf(stringToFind);
        while (index != -1) {
            temp = temp.replace(stringToFind, stringToReplace);
            index = temp.indexOf(stringToFind);
        }
        return temp;
    }; 
```

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2013-06-13T11:13:55.260

`$1`如果对您不起作用，您可以使用它：

```
var pattern = new RegExp("amman", "i");
"abc Amman efg".replace(pattern, "<b>" + "abc Amman efg".match(pattern)[0] + "</b>"); 
```

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2009-01-30T01:02:23.780

虽然您可以动态创建正则表达式（根据对这个问题的其他回复），但我会从[类似的帖子中回应我的评论：](https://stackoverflow.com/questions/487509/passing-variable-to-a-regexp-in-javascript/488133#488133) [String.replace()](https://developer.mozilla.org/En/Core_JavaScript_1.5_Reference/Global_Objects/String/Replace)的函数形式非常有用，在许多情况下减少了对动态创建的 RegExp 对象。（这有点痛苦，因为您必须将 RegExp 构造函数的输入表示为字符串，而不是使用斜杠 /[AZ]+/ regexp 文字格式）

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2015-10-27T05:56:54.307

您的解决方案在这里：

*[将变量传递给正则表达式](http://www.mindfiresolutions.com/How-to-use-a-variable-in-replace-function-of-JavaScript-676.php)*

我已经实现的一个是通过从文本字段中获取值，这是您要替换的文本字段，另一个是“替换为”文本字段，从变量中的文本字段获取值并将变量设置为 RegExp功能进一步替换。就我而言，我使用的是 jQuery，但您也可以仅通过 JavaScript 来完成。

JavaScript 代码：

```
 var replace =document.getElementById("replace}"); // getting a value from a text field with I want to replace
  var replace_with = document.getElementById("with"); //Getting the value from another text fields with which I want to replace another string.

  var sRegExInput = new RegExp(replace, "g");
  $("body").children().each(function() {
    $(this).html($(this).html().replace(sRegExInput,replace_with));
  }); 
```

这段代码在按钮的 Onclick 事件上，你可以把它放在一个函数中调用。

所以现在你可以在替换函数中传递一个变量。

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2018-10-18T18:37:43.747

这些答案对我来说都不清楚。我最终在*[如何在 JavaScript 的替换函数中使用变量找到了一个很好的解释](http://burnignorance.com/php-programming-tips/how-to-use-a-variable-in-replace-function-of-javascript/)*

简单的答案是：

```
var search_term = new RegExp(search_term, "g");
text = text.replace(search_term, replace_term); 
```

例如：

```
$("button").click(function() {
  Find_and_replace("Lorem", "Chocolate");
  Find_and_replace("ipsum", "ice-cream");
});

function Find_and_replace(search_term, replace_term) {
  text = $("textbox").html();
  var search_term = new RegExp(search_term, "g");
  text = text.replace(search_term, replace_term);
  $("textbox").html(text);
}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<textbox>
  Lorem ipsum Lorem ipsum Lorem ipsum Lorem ipsum Lorem ipsum Lorem ipsum
</textbox>
<button>Click me</button>
```

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2019-12-16T17:24:35.063

这个自调用函数将使用索引迭代 replacerItems，并在每次传递时全局更改字符串上的 replacerItems[index]。

```
 const replacerItems = ["a", "b", "c"];    

    function replacer(str, index){
          const item = replacerItems[index];
          const regex = new RegExp(`[${item}]`, "g");
          const newStr = str.replace(regex, "z");
          if (index < replacerItems.length - 1) {
            return replacer(newStr, index + 1);
          }
          return newStr;
    }

// console.log(replacer('abcdefg', 0)) will output 'zzzdefg' 
```

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2013-08-16T19:53:34.577

您可以随时`indexOf`重复使用：

```
String.prototype.replaceAll = function(substring, replacement) {
    var result = '';
    var lastIndex = 0;

    while(true) {
        var index = this.indexOf(substring, lastIndex);
        if(index === -1) break;
        result += this.substring(lastIndex, index) + replacement;
        lastIndex = index + substring.length;
    }

    return result + this.substring(lastIndex);
}; 
```

当替换包含匹配项时，这不会进入无限循环。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2019-11-24T01:46:58.033

对于没有正则表达式的多个替换，我使用以下内容：

```
 let str = "I am a cat man. I like cats";
      let find = "cat";
      let replace = "dog";

      // Count how many occurrences there are of the string to find 
      // inside the str to be examined.
      let findCount = str.split(find).length - 1;

      let loopCount = 0;

      while (loopCount < findCount) 
      {
        str = str.replace(find, replace);
        loopCount = loopCount + 1;
      }  

      console.log(str);
      // I am a dog man. I like dogs 
```

[解决方案的重要部分在这里找到](https://stackoverflow.com/a/39422368/4683230)

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2021-03-10T19:29:59.227

作为一个相对的 JavaScript 新手，已注意到/赞赏已接受的答案[https://stackoverflow.com/a/494046/1904943](https://stackoverflow.com/a/494046/1904943)，但它不是很直观。

这是一个更简单的解释，例如（使用[简单的 JavaScript IDE](https://stackoverflow.com/questions/17132593/simple-javascript-ide/66376974#66376974)）。

```
myString = 'apple pie, banana loaf';

console.log(myString.replaceAll(/pie/gi, 'PIE'))
// apple PIE, banana loaf

console.log(myString.replaceAll(/\bpie\b/gi, 'PIE'))
// apple PIE, banana loaf

console.log(myString.replaceAll(/pi/gi, 'PIE'))
// apple PIEe, banana loaf

console.log(myString.replaceAll(/\bpi\b/gi, 'PIE'))
// [NO EFFECT] apple pie, banana loaf

const match_word = 'pie';

console.log(myString.replaceAll(/match_word/gi, '**PIE**'))
// [NO EFFECT] apple pie, banana loaf

console.log(myString.replaceAll(/\b`${bmatch_word}`\b/gi, '**PIE**'))
// [NO EFFECT] apple pie, banana loaf

// ----------------------------------------
// ... new RegExp(): be sure to \-escape your backslashes: \b >> \\b ...

const match_term = 'pie';
const match_re = new RegExp(`(\\b${match_term}\\b)`, 'gi')

console.log(myString.replaceAll(match_re, 'PiE'))
// apple PiE, banana loaf

console.log(myString.replace(match_re, '**PIE**'))
// apple **PIE**, banana loaf

console.log(myString.replaceAll(match_re, '**PIE**'))
// apple **PIE**, banana loaf 
```

**应用**

例如：替换（颜色突出显示）字符串/句子中的单词，[可选地]如果搜索词匹配超过用户定义的匹配词的比例。

注意：匹配词的原始字符大小写被保留。`hl`： 强调; `re`: 正则表达式 | 正则表达式

```
mySentence = "Apple, boOk? BOoks; booKEd. BookMark, 'BookmarkeD', bOOkmarks! bookmakinG, Banana; bE, BeEn, beFore."

function replacer(mySentence, hl_term, hl_re) {
    console.log('mySentence [raw]:', mySentence)
    console.log('hl_term:', hl_term, '| hl_term.length:', hl_term.length)
    cutoff = hl_term.length;
    console.log('cutoff:', cutoff)

    // `.match()` conveniently collects multiple matched items
    // (including partial matches) into an [array]
    const hl_terms  = mySentence.toLowerCase().match(hl_re, hl_term);
    if (hl_terms == null) {
        console.log('No matches to hl_term "' + hl_term + '"; echoing input string then exiting ...')
        return mySentence;
    }
    console.log('hl_terms:', hl_terms)
    for (let i = 0;  i < hl_terms.length; i++) {
        console.log('----------------------------------------')
        console.log('[' + i + ']:', hl_terms[i], '| length:', hl_terms[i].length, '| parseInt(0.7(length)):', parseInt(0.7*hl_terms[i].length))
        // TEST: if (hl_terms[i].length >= cutoff*10) {
        if (cutoff >= parseInt(0.7 * hl_terms[i].length)) {
            var match_term = hl_terms[i].toString();

            console.log('matched term:', match_term, '[cutoff length:', cutoff, '| 0.7(matched term length):', parseInt(0.7 * hl_terms[i].length))

            const match_re = new RegExp(`(\\b${match_term}\\b)`, 'gi')

            mySentence = mySentence.replaceAll(match_re, '<font style="background:#ffe74e">$1</font>');
        }
        else {
            var match_term = hl_terms[i].toString();
            console.log('NO match:', match_term, '[cutoff length:', cutoff, '| 0.7(matched term length):', parseInt(0.7 * hl_terms[i].length))
        }
    }
    return mySentence;
}

// TESTS:
// const hl_term = 'be';
// const hl_term = 'bee';
// const hl_term = 'before';
// const hl_term = 'book';
const hl_term = 'bookma';
// const hl_term = 'Leibniz';

// This regex matches from start of word:
const hl_re = new RegExp(`(\\b${hl_term}[A-z]*)\\b`, 'gi')

mySentence = replacer(mySentence, hl_term, hl_re);
console.log('mySentence [processed]:', mySentence) 
```

**输出**

```
mySentence [raw]: Apple, boOk? BOoks; booKEd. BookMark, 'BookmarkeD',
bOOkmarks! bookmakinG, Banana; bE, BeEn, beFore.

hl_term: bookma | hl_term.length: 6
cutoff: 6
hl_terms: Array(4) [ "bookmark", "bookmarked", "bookmarks", "bookmaking" ]

----------------------------------------
[0]: bookmark | length: 8 | parseInt(0.7(length)): 5
matched term: bookmark [cutoff length: 6 | 0.7(matched term length): 5
----------------------------------------
[1]: bookmarked | length: 10 | parseInt(0.7(length)): 7
NO match: bookmarked [cutoff length: 6 | 0.7(matched term length): 7
----------------------------------------
[2]: bookmarks | length: 9 | parseInt(0.7(length)): 6
matched term: bookmarks [cutoff length: 6 | 0.7(matched term length): 6
----------------------------------------
[3]: bookmaking | length: 10 | parseInt(0.7(length)): 7
NO match: bookmaking [cutoff length: 6 | 0.7(matched term length): 7

mySentence [processed]: Apple, boOk? BOoks; booKEd.
<font style="background:#ffe74e">BookMark</font>, 'BookmarkeD',
<font style="background:#ffe74e">bOOkmarks</font>! bookmakinG,
Banana; bE, BeEn, beFore. 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2021-03-21T15:30:23.033

如果您使用正确的语法传递变量，则可以使用下面的代码执行此操作。

这具有在同一变量中使用标志的额外好处。

此外，当涉及到等时，您不必`\`在正则表达式中双重转义。`\w`

```
var str = 'regexVariable example: This is my example of RegExp replacing with a regexVariable.'
var reVar = /(.*?)(regex\w+?iable)(.+?)/gi;
var resStr = str.replace(new RegExp(reVar), '$1 :) :) :) $2 :) :) :)$3');
console.log(resStr);

// Returns:
// :) :) :) regexVariable :) :) :) example: This is my example of RegExp replacing with a  :) :) :) regexVariable :) :) :).
```

根据 OP 示例的原型版本：

```
var str = 'regexVariable prototype: This is my example of RegExp replacing with a regexVariable.'

String.prototype.regexVariable = function(reFind, reReplace) {
return str.replace(new RegExp(reFind), reReplace);
}

var reVar = /(.*?)(regex\w+?iable)(.+?)/gi;

console.log(str.regexVariable(reVar, '$1 :) :) :) $2 :) :) :)$3'));

// Returns:
// :) :) :) regexVariable :) :) :) prototype: This is my example of replacing with a  :) :) :) regexVariable :) :) :).
```

# asp.net - ASP.NET 可以模拟用户删除性能计数器类别吗？

> ID：494036
> 
> 赞同：1
> 
> 时间：2009-01-30T00:11:24.007
> 
> 标签：asp.net, permissions, impersonation, performancecounter

我相信我在本地机器上运行 ASP.NET 页面时成功地模拟了我自己的用户帐户。

使用[此处](http://www.west-wind.com/WebLog/posts/1572.aspx)描述的方法，我已成功将`WindowsIdentity.GetCurrent().Name`ASPNET 更改为我的域帐户。

我可以成功写入文件系统上只有我的帐户有权访问的文件。但是，当我尝试删除性能计数器类别时，我得到*Access Denied*。
我对注册表的分支进行了审计，它告诉我*MyMachine\ASPNET 在 Object Access 失败*。

这是它失败的代码：

```
if ( PerformanceCounterCategory.Exists ( PerfmonCategory ) )
        PerformanceCounterCategory.Delete ( PerfmonCategory ); 
```

它在删除呼叫上失败。

（我的帐户是管理员，我可以在 ASP.NET 上下文之外成功运行相同的代码）。

我怀疑这个 System.Diagnostics 命名空间调用实际上是在调用一些 COM 进程，并且不知何故因为第二跳而被退回。谁能确认可能发生了什么？

编辑：异常：访问被拒绝描述：在执行当前 Web 请求期间发生未处理的异常。请查看堆栈跟踪以获取有关错误及其源自代码的位置的更多信息。

异常详情：

> System.ComponentModel.Win32Exception：访问被拒绝

在完全信任下运行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-30T00:22:33.000

您可以在自己的应用程序池上运行您的应用程序（总是一件好事），并为它分配适当的服务用户权限，这样您就不需要弄乱模拟了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-30T00:17:29.547

您确实需要成为管理员才能添加或删除性能计数器。

我不确定您为什么要使用 Win32 API 调用来进行模拟 - 自从我弄乱它已经有一段时间了，但我认为您需要做的就是使用

```
WindowsIdentity.GetCurrent().Impersonate() 
```

需要明确的是，您首先需要使用 Windows 身份验证在 Web 应用程序中进行身份验证，然后您应该能够调用 Impersonate()。

[Impersonate() 方法](http://msdn.microsoft.com/en-us/library/w070t6ka.aspx)

# wix - WiX：如何为所有用户创建共享？

> ID：494045
> 
> 赞同：3
> 
> 时间：2009-01-30T00:15:08.693
> 
> 标签：wix

我正在使用*WiX*创建安装程序，并希望在安装过程中共享一个文件夹。我想授予所有用户权限。我正在使用以下片段：

```
<util:FileShare Id="MYSHARE" Name="MyShare" Description="Description of MyShare">
  <util:FileSharePermission GenericRead="yes" Read="yes" ReadAttributes="yes" User="Everyone" />
</util:FileShare> 
```

我收到以下编译时错误：“未解决对‘Product:{MY-GUID}’部分中符号‘User:Everyone’的引用。”

**关于如何为所有用户创建共享的任何建议？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-30T03:11:15.780

您需要有一个 Util:User 元素。FileSharePermission/@User 是对 User/@Id 属性的引用。

不幸的是，有一些与用户属性相关的设计不一致。通常它是对 User/@Id 的引用，但有时它只是用户名......悲伤，是的......但我们还没有修复它。

# python - 如何在 Python 2.4 CSV 阅读器中禁用引用？

> ID：494054
> 
> 赞同：11
> 
> 时间：2009-01-30T00:22:40.660
> 
> 标签：python, csv

我正在编写一个 Python 实用程序，它需要解析一个我无法控制的、定期更新的大型 CSV 文件。该实用程序必须在只有 Python 2.4 可用的服务器上运行。CSV 文件根本不引用字段值，但[csv 库的 Python 2.4 版本](http://www.python.org/doc/2.4.3/lib/csv-fmt-params.html#csv-fmt-params)似乎没有给我任何关闭引用的方法，它只允许我设置引号字符（`dialect.quotechar = '"'`或其他字符）。如果我尝试将引号字符设置为`None`空字符串，则会出现错误。

我可以通过设置一些“稀有”字符来解决这个问题`dialect.quotechar`，但这很脆弱，因为没有 ASCII 字符我可以绝对保证不会出现在字段值中（分隔符除外，但如果我设置`dialect.quotechar = dialect.delimiter`了可以预见的混乱）。

在[Python 2.5 及更高版本](http://docs.python.org/library/csv.html)中，如果我设置`dialect.quoting`为`csv.QUOTE_NONE`，CSV 阅读器会尊重这一点，并且不会将任何字符解释为引号字符。有没有办法在 Python 2.4 中复制这种行为？

**更新**：感谢 Triptych 和 Mark Roddy 帮助缩小问题范围。这是一个最简单的案例演示：

```
>>> import csv
>>> import StringIO
>>> data = """
... 1,2,3,4,"5
... 1,2,3,4,5
... """
>>> reader = csv.reader(StringIO.StringIO(data))
>>> for i in reader: print i
... 
[]
Traceback (most recent call last):
  File "<stdin>", line 1, in ?
_csv.Error: newline inside string 
```

*仅当行的最后*一列中有单个双引号字符时才会出现此问题。不幸的是，这种情况存在于我的数据集中。我接受了 Tanj 的解决方案：手动分配一个非打印字符（`"\x07"`或`BEL`）作为引号字符。这很hacky，但它有效，而且我还没有看到另一个解决方案。这是实际解决方案的演示：

```
>>> import csv
>>> import StringIO
>>> class MyDialect(csv.Dialect):
...     quotechar = '\x07'
...     delimiter = ','
...     lineterminator = '\n'
...     doublequote = False
...     skipinitialspace = False
...     quoting = csv.QUOTE_NONE
...     escapechar = '\\'
... 
>>> dialect = MyDialect()
>>> data = """
... 1,2,3,4,"5
... 1,2,3,4,5
... """
>>> reader = csv.reader(StringIO.StringIO(data), dialect=dialect)
>>> for i in reader: print i
... 
[]
['1', '2', '3', '4', '"5']
['1', '2', '3', '4', '5'] 
```

在 Python 2.5+ 中，将引用设置为 csv.QUOTE_NONE 就足够了，`quotechar`那么 的值将无关紧要。（我实际上是通过 a 获取我的初始方言`csv.Sniffer`，然后覆盖 quotechar 值，而不是通过子类化`csv.Dialect`，但我不希望这会分散真正问题的注意力；以上两个会话表明这`Sniffer`不是问题。 )

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-30T01:05:04.973

我不知道 python 是否愿意/允许它，但您能否使用不可打印的 ascii 代码，例如 BEL 或 BS（退格），我认为这些代码非常罕见。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-30T01:29:25.487

我尝试了几个使用 Python 2.4.3 的示例，它似乎足够聪明，可以检测到这些字段没有被引用。

我知道您已经接受了一个（有点骇人听闻的）答案，但是您是否尝试过只保留`reader.dialect.quotechar`价值？如果你这样做会发生什么？

我们有机会获得示例输入吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-30T19:48:51.837

+1 三联画

确认 csv.reader 自动处理不带引号的 csv 文件：

```
>>> import StringIO
>>> import csv
>>> data="""
... 1,2,3,4,5
... 1,2,3,4,5
... 1,2,3,4,5
... """
>>> reader=csv.reader(StringIO.StringIO(data))
>>> for i in reader:
...     print i
... 
[]
['1', '2', '3', '4', '5']
['1', '2', '3', '4', '5']
['1', '2', '3', '4', '5'] 
```

# c++ - C++ Visual Studio 编译错误

> ID：494064
> 
> 赞同：7
> 
> 时间：2009-01-30T00:27:52.803
> 
> 标签：c++, visual-studio

我收到以下编译错误

致命错误 C1189：#error：错误：使用 C 运行时库内部头文件。

我完全不知道。任何人都可以对此有所了解吗？

完整的错误：

C:\Program Files\Microsoft Visual Studio 8\VC\ce\include\crtdefs.h(100)：致命错误 C1189：#error：错误：使用 C 运行时库内部头文件。生成代码...

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-30T00:38:26.493

您可能已经`crt/src`进入包含目录搜索路径。那里的头文件用于构建 C 运行时 - 它们不打算在用户程序中使用（即使它们可能与打算包含的文件具有相同的名称）。

如果您查看导致问题的标题，您可能会看到如下内容：

```
/* This version of the header files is NOT for user programs.
 * It is intended for use when building the C runtimes ONLY.
 * The version intended for public use will not have this message.
 */ 
```

您需要修复包含搜索路径。

我看到您`ce/include`的包含搜索路径中有 - 您正在构建 WinCE 应用程序吗？如果是这样，则应定义您的构建`_WIN32_WCE`以防止此问题。如果不是，则此目录不应位于包含路径中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-09-28T20:19:00.037

为了增加一点精度，在我的情况下，我只需要更改我使用的一个 .h 文件的包含路径，如下所示。

我从这个包含路径开始：

```
C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\crt\src 
```

然后将其更改为：

```
C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\include 
```

这是正确的头文件所在的位置。

# asp.net - jQuery 和 ASP.NET - 强制按钮单击

> ID：494076
> 
> 赞同：4
> 
> 时间：2009-01-30T00:38:12.033
> 
> 标签：asp.net, javascript, jquery

我有一个 ASP.NET 页面，上面有一个表单。它还有一个搜索表格。搜索位于页面的右上角，因此搜索按钮是第一个添加到控件层次结构的按钮。

当您处理其他表单并按 Enter 时，它将单击搜索按钮。我不希望这样，我希望当您按下输入按钮时单击表单。

我尝试像这样使用 jQuery：

```
$('#textBoxId').keyup(function(e) {
  if(e.keyCode === 13) { 
    $('#buttonId').click();
    e.preventDefault();
  }
}); 
```

但是提交的表单，意味着客户端验证没有运行（即，onclick 事件处理程序没有在按钮上运行）。

实现这一目标的最佳方法是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-30T00:43:43.660

试试这个。

```
$('#textBoxId').keydown(function(e) {
  if(e.keyCode === 13) {
    e.preventDefault(); 
    $('#buttonId').trigger('click');
  }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-01-18T15:31:38.393

此代码适用于 IE 和 FF：

```
$('#textBoxId').keydown(function(event) {
    var e = event || window.event;
    var keyCode = document.all ? e.keyCode : e.which;

    if (keyCode == 13) {
        e.preventDefault();
        $('#buttonId')[0].click();
    }
}); 
```

要记住的重要一点是，对[click()](http://docs.jquery.com/Events/click)的 jQuery 调用仅调用绑定到 click 事件的所有处理程序。它不调用底层 html 对象的 click() 方法。这必须通过根据 if 语句的最后一行从 jQuery 数组中提取元素来手动完成。

# asp.net-mvc - 确保视图存在

> ID：494083
> 
> 赞同：7
> 
> 时间：2009-01-30T00:40:56.193
> 
> 标签：asp.net-mvc, unit-testing

我目前正在研究我必须创建的新应用程序的单元测试。我的基本测试进展顺利（测试 ActionResult 类非常好）。不过，我确实想确保的一件事是，我的解决方案中存在一个视图页面。我不是 100% 确定我的测试是正确的，所以如果有人有建议，请不要犹豫！

这是一个测试，我必须检查我的安全控制器上的登录方法是否正确：

```
[TestMethod]
public void Login()
{
    var authProvider = new Mock<IAuthenticationProvider>();
    var controller = new SecurityController(authProvider.Object);

    var result = controller.Login() as ViewResult;

    Assert.IsNotNull(result, "ActionResult should be of type ViewResult.");
    Assert.AreEqual(result.ViewName, "login", "Does not render login page.");
} 
```

我对测试的解释是：

*   在控制器上调用方法“登录”
*   确认它正在渲染视图（通过检查它是否返回 ViewResult 对象）
*   确认它正在呈现正确的视图（通过检查视图名称）

我想要的是第三个断言，看看要渲染的视图是否真的存在。

我的一些次要问题是：

*   我应该把这个测试分开吗？
*   我应该重命名它（比如，err、LoginRendersCorrectView 什么的）

谢谢！

* * *

注意：我明确地试图避免检查文件系统。我有点希望有一种方法可以使用 ViewEngine 来确认视图确实存在。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-01T00:58:44.970

*   不，我认为您不应该拆分测试，只要它主要是第三个断言而不是更多代码。

*   是的，我认为一个更具描述性的名称会有所帮助。

*   既然您已经验证了它已经具有正确的视图名称，那么不会简单地成功渲染视图来验证它的存在吗？

我认为您正在完成完整的测试覆盖率工作很棒，但是在这里我觉得如果您能够继续验证执行实际特定登录功能的单元的部分，可能会更有效地利用您的时间（例如验证密码哈希或其他）是否正常工作。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-05T14:12:17.393

知道视图存在于解决方案中并不是非常有用。您真正关心的是视图将被部署，因为您的用户（我希望）不会在 Visual Studio 中运行您的站点。换句话说，您要求的不是单元测试，而是集成测试。因此，您应该使用合适的工具来完成这项工作。考虑像[Selenium](http://seleniumhq.org/)这样的 Web 测试框架。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-04T19:34:57.057

我完全同意 Jason 的观点，但我不认为你正在尝试做的事情实际上有助于测试覆盖率。毕竟，渲染它和测试行为已经涵盖了它是否存在。

许多开发人员在第一次被测试驱动的开发错误所困扰时就过火了。他们希望测试失败能够准确地告诉他们出了什么问题，这样他们就不必深入研究和调试。这不是测试的主要目的。测试是为了验证正确的行为，这样你就不会发布糟糕的软件。当出现问题时，您可以调试。没有必要拥有如此具体的测试工具，以使测试引擎确切知道问题所在。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-05T23:46:33.817

您可以尝试使用 ViewResult 中的 ViewEngineCollection 对象的 FindView 方法来检查 MVC 框架是否可以找到 View。

正如其他人所建议的那样，我认为这个 3'rd Assert（视图实际存在）不会为您的测试增加真正的价值，但是，这里是检查存在的代码：

```
var viewEngineResult = result.ViewEngineCollection.FindView(controller, result.ViewName, result.MasterName);
if (viewEngineResult == null)
    ... not found ... 
```

希望这可以帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-30T06:46:22.930

如果您使用的是 beta，您的代码隐藏文件将为视图创建一个类，您可以使用反射检查该类。

否则，您可以检查文件是否存在于正确的位置。

# html - CSS浮动的问题

> ID：494084
> 
> 赞同：3
> 
> 时间：2009-01-30T00:41:07.970
> 
> 标签：html, css

我正在尝试创建一个可以调整大小的动态弹出窗口。但是，由于我无法使用静态宽度，因此在使用浮点数和百分比作为宽度时遇到了问题。

当我为浮动 div 的宽度指定百分比时，它假定我的意思是`100%`包含 div 的宽度。我正在尝试做的是将宽度设置为当前 div 中宽度的剩余部分。如果我使用一张桌子，它会起作用。所以本质上，我需要能够将以下代码用于表格并使用 div 使其工作......

```
<table style="width: 100px;" cellpadding="0" cellspacing="0">
   <tr style="height: 25px;">
      <td style="width: 10px; background-color: Red;"></td>
      <td style="background-color: Blue;"></td>
      <td style="width: 10px; background-color: Black;"></td>
   </tr>
</table> 
```

显示以下内容：

到目前为止，我有以下内容，但它没有按预期工作......

```
<div id="container" style="width: 100px; height: 25px;">
   <div id="left" style="float: left; width: 10px; background-color: Red; height: 100%;"></div>
   <div id="mid" style="float: left; background-color: Blue; height: 100%;"></div>
   <div id="right" style="float: right; width: 10px; background-color: Black; height: 100%;"></div>
</div> 
```

上面的代码显示了以下内容：

无论如何，如果有人可以帮助我将表格方法翻译成可以与 div 一起使用的东西，我将不胜感激。

谢谢，
C

笔记：

我尝试将代码添加到实际帖子中，但似乎该帖子没有解释 html。因此，它说“显示以下内容”的部分实际上并没有这样做。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-30T01:45:35.393

默认情况下，div 是块级元素，因此您无需指定“display: block;”。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-30T00:53:34.670

你可以尝试这样的事情：

```
<div style="width:100px;height:25px;position:relative">
  <div style="width:20px;height:100%;position:absolute;background:red">&nbsp;</div>
  <div style="width:20px;height:100%;position:absolute;right:0;background:black">&nbsp;</div>
  <div style="height:100%;background:blue;padding:0 20px">
    Stuff
  </div>
</div> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-30T01:11:10.237

您可以使用浮点数和无绝对定位来完成任务。

```
<div id="container" style="display: block; width: 700px; height: 100px;">
    <div id="left" style="display: block; float: left; width: 10px; background-color: Red; height: 100%;">Div 1</div>
    <div id="mid" style="display: block; width: 90%; float: left; background-color: Blue; height: 100%;">Div 2</div>
    <div id="right" style="display: block; float: left; width: 10px; background-color: Green; height: 100%;">Div 3</div>
</div> 
```

您缺少的是`display: block`使 div 的行为像块级元素一样的标签，它将按照您指定的方式浮动。另外，由于你不能占用 100% 的父块，我使用了 90%，它在 Firefox 下产生了工作结果，不确定 IE 或 Opera。

预览显示了 Div 1、Div 2、Div 3，但发布时却没有

编辑：添加了工作代码。

# iphone - 关于 Objective-C/Cocoa Key-Value 编码和数组

> ID：494085
> 
> 赞同：2
> 
> 时间：2009-01-30T00:41:40.810
> 
> 标签：iphone, objective-c, cocoa-touch, key-value-coding

我正在尝试找出“正确”的方法来处理使用 iPhone 应用程序的键值编码填充数组。我想出了一些可行的方法，但它相当hackish。基本上，我将 XML 文档解析为一组代码生成的模型。让我们假设 XML 是这种格式：

```
<foo>
    <bar>
        <item name="baz" />
        <item name="bog" />
    </bar>
</foo> 
```

在我生成的代表 Bar 元素的对象上，我为子节点定义了一个 NSMutableArray：

```
@interface Bar : NSObject {
    NSMutableArray *item;
}
@end 
```

因此，默认情况下，当我在 Bar 的实例上调用 setValue:forKey: 时，它最终会用 Item 对象的单个实例覆盖 NSMutableArray 的实例。我目前为使其正常工作所做的工作是它变得很糟糕的地方。我将数组实例变量重命名为别的东西，让我们说名称的复数形式：

```
@interface Bar : NSObject {
    NSMutableArray *items;
}
@end 
```

这会导致 setValue:forKey: 的默认访问器丢失。然后我将此方法添加到 Bar 实现中：

```
- (void)setValue:(id)value forUndefinedKey:(NSString *)key {
    if([key isEqualToString:@"item"]) {
        if(items == nil) {
            items = [[NSMutableArray alloc] init];
            [items retain];         
        }
        [items addObject:value];
    }
} 
```

一切正常！我相信一定有更好的方法来做到这一点！我已经通读了 Key-Value Coding Programming Guide，但我一定遗漏了一些东西，因为我不清楚数组访问器应该如何工作。我已经尝试实现 countOf: 和 objectInAtIndex: 他们 KVC 编程指南似乎表明，但这仍然会导致我的 NSMutableArray 被 Item 类型的实例覆盖。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-30T06:19:22.703

如果你想对数组使用 KVC 属性，你应该查看文档`mutableArrayValueForKey:`

基本上与你的班级：

```
@interface Bar : NSObject {
    NSMutableArray *items;
}
@end 
```

假设您在其他地方初始化了数组，您将至少定义这些方法：

```
- (void)insertObject:(id)object inItemsAtIndex:(NSUInteger)index {
    [items insertObject:object atIndex:index];
}

- (void)removeObjectFromItemsAtIndex:(NSUInteger)index {
    [items removeObjectAtIndex:index];
}

- (NSArray *)items {
    /* depending on how pedantic you want to be
       possibly return [NSArray arrayWithArray:items] */
    return items;
} 
```

一旦你实现了这些方法，你就可以调用`[bar mutableArrayValueForKey:@"items"]`. 它将返回一个`NSMutableArray`代理对象，您可以从中添加和删除对象。该对象将依次生成适当的 KVO 消息并使用您刚刚定义的方法与您的实际数组进行交互。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-30T02:43:46.913

正如 Martin 建议的那样，您不能直接观察数组来查看添加或删除项目的时间。相反，这将被视为 Bar 对象的“多对多”属性，您必须自己处理 KVO 断言。您可以执行以下操作来添加和删除栏中的项目：

```
@interface Bar : NSObject
{
    NSMutableArray *items;
}
-(void)addItem:(id)item;
-(void)removeItem:(id)item;
@end

@implementation Bar
-(id)init
{
    if( (self = [super init]) ) {
        items = [[NSMutableArray alloc] init];
    }
    return self;
}

-(void)addItem:(id)item
{
    NSParameterAssert(item);
    NSIndexSet *iset = [NSIndexSet indexSetWithIndex:[items count]];
    [self willChange:NSKeyValueChangeInsertion valuesAtIndexes:iset forKey:@"items"];
    [items addObject:item];
    [self didChange:NSKeyValueChangeInsertion valuesAtIndexes:iset forKey:@"items"];
}

-(void)removeItem:(id)item
{
    NSParameterAssert(item);
    NSIndexSet *iset = [NSIndexSet indexSetWithIndex:[items indexForObject:item]];
    [self willChange:NSKeyValueChangeRemoval valuesAtIndexes:iset forKey:@"items"];
    [items removeObject:item];
    [self didChange:NSKeyValueChangeRemoval valuesAtIndexes:iset forKey:@"items"];
}
@end 
```

如果您希望能够直接设置/替换项目，您必须自己想出一些方法来做到这一点。通常，我会建议`NSArrayController`这种事情，但由于您使用的是 iPhone，因此您基本上必须自己创建此功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-30T02:05:18.050

好吧，有两种方法可以解决：

1.  在您传入项目的 Bar 类中添加“添加项目”方法
2.  确保在执行 KVC 时传入整个项目数组

我不相信有一种方法可以使用 KVC 将项目添加到数组中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-06-09T18:07:12.770

调用就足够了`valueForKey:@"item"`，结果将是可变的。所以你可以说：

```
NSMutableArray* m = [theBar valueForKey:@"item"];
[item addObject: value]; 
```

除非您正在实现外观（没有可变实例变量的键），否则您不需要这些其他方法。

# ruby-on-rails - 您如何通过 ID 以外的方式获取 RESTful 资源？

> ID：494096
> 
> 赞同：4
> 
> 时间：2009-01-30T00:48:15.647
> 
> 标签：ruby-on-rails, rest

在某些情况下，我需要通过 ID 以外的参数查找对象。什么是正确的 RESTful 方式来做到这一点？

例如，我可能想找到一个`User`by `username`and `password`，所以严格的 RESTful " `GET /users/1`" 不起作用。

根据[Rails 文档](http://guides.rubyonrails.org/routing_outside_in.html#_crud_verbs_and_actions)，这是获取资源所有实例的 URL 模式：“ `GET /users`”。我可以向其中添加参数：“ `GET /users?username=joe&password=topsecret`”，但这会破坏 GET 请求的官方目的。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-30T01:05:07.783

“GET /users?username=joe&password=topsecret”，但这会歪曲 GET 请求的官方目的。”

不，它不会扭曲任何东西。这绝对是正确的 RESTful 方式，并且是在 http 规范中检索动态结果的推荐方式。REST 不关心 URL 中的内容，只关心它是唯一的。该页面的 url 可以是 [http://3f778a9b8a7c778696e](http://3f778a9b8a7c778696e) 对于所有 REST 架构的关心，只要这是到达那里的唯一方法，并且它不会导致其他任何地方。

http 定义了用于返回动态结果的查询字符串协议。鉴于数据库的当前状态，您为应用程序提供的查询字符串应该始终返回相同的结果。然后它将是RESTFUL。URL 美学与 REST 完全不同。

根据 REST 架构，GET 请求的规则是它总是返回相同的结果（或在相当长的时间内保持相同的结果，以便缓存起作用），并且 GET 没有副作用。GET 需要是幂等的（总是返回相同的结果，不管你调用了多少次）并且不会导致系统改变状态。就是*这样*。

当然，您不必使用查询协议。您可以将参数放入正斜杠、分号之间，也可以是 base64 编码的 GUID。这完全取决于你，只要它遵循这些简单的规则。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-30T08:18:38.140

多键不安静，是吗？也许`/users/[username]?password=secret`。此外，您不想在那里使用密码，而是使用某种 API 密钥，因此 url 看起来像这样：

`/users/leethal?secret=da01930adfe82810092`

为了使用用户名而不是 id，请执行以下操作：

```
# controller
@user = User.find_by_username!(params[:id])

# model
def to_param
  username
end 
```

# css - 如何按内容水平增长 div？

> ID：494104
> 
> 赞同：14
> 
> 时间：2009-01-30T00:53:59.583
> 
> 标签：css, html, expand, autogrow

拜托，有人可以向我解释一下，为什么红色 div 没有向右扩展？它在屏幕结束的地方停止。我该怎么做才能让它扩大？

有效的一件事是“显示：表格单元格”红色div，但我想知道是否还有另一种方法以及为什么会发生这种情况......？

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head />
<body>
  <div style="background-color: #f00;">
    <div style="width: 2000px; height: 100px; " />
  </div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-30T01:03:57.410

这确实很奇怪。尝试浮动外部：

```
<div style="background-color: #f00; float:left;">
    <div style="width: 2000px; height: 100px;" />
</div> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-30T00:57:09.157

它包含的 div 小于 2000px。你需要做这样的事情：

```
 <div style="background-color: #f00; width: 2000px;">
    <div style="width: 2000px; height: 100px; " />
  </div> 
```

当然，现在不需要指定内部 div 的宽度，除非它与外部 div 不同。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-03-16T02:43:15.260

放入`overflow: auto;`父母`<div>`​​的风格。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-12-17T05:39:51.293

```
 <div style="background-color: #f00;">
    <div style="width: 2000px; height: 100px; " />
  </div> 
```

像这样关闭 DIV 标签（即自关闭标签）会带来麻烦。

这可能是合法的（[请参阅此 SO Thread](https://stackoverflow.com/questions/97522/what-are-all-the-valid-self-closing-tags-in-xhtml-as-implemented-by-the-major-b)），但根据我的经验，它经常会导致奇怪的行为。

然而，这不是问题。以下代码适用于 Chrome 和 IE9。

```
 <div style="background-color: #f00; display: inline-block; height: 100px;">
    <div style="width: 3000px; background-color: blue; height: 50px;">
        here is some content
      </div>
  </div> 
```

`Display: inline-block;`告诉元素根据需要增长尽可能多（或尽可能少）。

小提琴：http: [//jsfiddle.net/sArvr/](http://jsfiddle.net/sArvr/)

这似乎是违反直觉的行为。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-12-17T05:13:52.667

检查这个。随着文本的继续，它将扩展容器......

```
 <div style="background-color: #f00; height: 100px; display: inline-block;">
      <div style="background-color: blue; height: 50px; white-space:nowrap; display: inline-block;">
        here is some content
      </div>
    </div> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-30T00:57:05.927

根据您使用它的目的，我假设 div 元素将成为页面的主要焦点；如果是这种情况，您可以使用该`width: 2000px;`行并将其应用于主体，而不是直接应用于要拉伸的块级元素：

```
<style>
body
 {
width: 2000px;
 }
</style> 
```

如果此方法由于某种原因对您不起作用，那么创建一个透明像素图像并为其提供您需要的宽度应该也可以正常工作。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-30T00:59:20.087

内部 div 的宽度可以改变，我需要增加外部的宽度，所以我不能为其分配宽度。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-30T01:05:19.403

即使子 div 的宽度超出浏览器屏幕宽度，父 div 的最大宽度似乎**也受到浏览器屏幕宽度的限制。**这是一个奇怪的发现……

我建议在父 div 上使用 float。（参考：[crescentfresh](https://stackoverflow.com/questions/494104/how-to-grow-a-div-by-its-content/494124#494124)）我确定table-cell 不适用于IE6。在我的机器上对 IE7 进行快速测试也不起作用，尽管它应该......

这应该有效。（编辑：这不起作用......）

```
<div style="background-color: #f00; width: auto;">
  <div style="width: 2000px; height: 100px; "></div>
</div> 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-01-12T11:48:24.780

放 `<div style="min-height: 100px; " />`

当你增加内容时，我们的 div 应该会自动增加它的大小。

# parsing - Dotnetnuke 3.0.12 安装站点“无法加载类型 'dotnetnuke.common.global'”

> ID：494105
> 
> 赞同：0
> 
> 时间：2009-01-30T00:55:05.807
> 
> 标签：parsing, dotnetnuke

我收到了一个 zip 文件中的 dotnetnuke 3.0.12 安装，并在 c:\inetpub\wwwroot 下创建了一个网站并复制了这些文件。

当我访问 default.aspx 时，出现错误：

无法加载类型“DotNetNuke.Common.Global”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-30T06:37:17.377

您可能缺少程序集，如果安装有源文件，请尝试在 Visual Studio 中加载项目并单步执行代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-30T15:35:58.883

您是否设置了目录的文件权限？确保 IIS 帐户（Vista/Win 2k3 上的 NETWORK SERVICE，XP/Win 2k 上的 machine-name\ASPNET）在网站上具有修改权限（在这种情况下，请仔细检查 bin 文件夹）。

# asp.net - 应该在哪个项目层筛选 DTO 的存在？

> ID：494109
> 
> 赞同：11
> 
> 时间：2009-01-30T00:57:07.813
> 
> 标签：asp.net, n-tier-architecture, dto, project-structure

我有一个项目，我们使用屏幕 DTO 来封装**服务层**和**表示层**之间的数据。在我们的例子中，表示层是 ASP.Net。

唯一知道 DTO 的类是服务层类和调用这些服务并显示 DTO 的页面/控件。

DTO 几乎总是特定于页面/控制，所以我觉得它们属于表示层，但这意味着服务层必须引用表示层才能使用 DTO。

我几乎认为服务层应该返回更丰富的对象（但不是域实体？），然后表示层可以获取这些对象并将它们映射到每个页面/控制问题的非常具体的 DTO。

这是一个接口声明和一个 DTO，因此您可以看到我在说什么：

```
public interface IBlogTasks
{
    BlogPostDisplayDTO GetBlogEntryByTitleAndDate(int year, int month, string urlFriendlyTitle);
}

public class BlogPostDisplayDTO 
{
    public string Title { get; set; }
    public DateTime PostDate { get; set; }
    public string HtmlContent { get; set; }
    public string ImageUrl { get; set; }        
    public string Author { get; set; }
    public int CommentCount { get; set; }
    public string Permalink { get; set; }
} 
```

**编辑**

这是另一个代码示例，用于描述不涉及域模型的用例。也许这会澄清一些事情。我相信我已经超载了 DTO 的含义。我不是在谈论通过网络传输对象的功能的 DTO。我正在创建 DTO 来正式确定与我的服务层的通信之间的合同。

```
public interface IAuthenticationTasks
{
    bool AuthenticateUser(AuthenticationFormDTO authDTO);
}

public class AuthenticationFormDTO
{
    public string UserName { get; set; }
    public string Password { get; set; }
    public bool persistLogin { get; set; }
} 
```

假设我的身份验证突然需要一个 IP 地址参数。我现在可以将该属性添加到 DTO，而无需更改我的合同接口。

我不想将实体传递给我的表示层。我不希望我的代码后面有能力去`BlogPost.AddComment(new Comment())`

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-30T11:57:29.103

即使认为“DTO”的规范用例是“可以通过网络传递的可序列化对象”，在这种情况下，您实际上更多地指的是“演示传输对象”或“视图模型”。

通常，对于我们的项目来说，这些存在于何处的答案是将 DDD 域模型映射到 PTO 类的“翻译”代码所在的位置。如果那是在 Prensenation 层（也许不是一个很好的答案），那么 pres。layer 是我声明 PTO 的地方。但通常情况下，它是为您进行翻译的“服务”，这意味着“服务”和“演示”层都需要对 PTO 的引用，并且（通常）导致它们在单独的声明中，中立的项目/程序集/命名空间/表示层和服务层都可以引用的任何内容。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-30T01:13:34.147

您是否使用实际服务（Web 或 WCF）？如果是这样，则在服务层中定义 DTO，当您添加服务（或使用旧 ASMX 的 Web）引用时创建的代理将包含所有 DTO 类型。这是最简单的方法，并且只保持 ASP.NET 项目和服务项目之间的松散耦合——在任何一个方向都不需要直接的项目引用。当您更新 DTO 时，您需要做的就是更新您的服务引用，它会通过生成的代理类自动将更新公开给您的 Web 项目。

无论如何，如果您遵循 DDD 方法之类的方法，最好让您的基础架构项目（例如特定于 Web 平台的 UI）引用您的域对象，反之亦然。但是，如果您遵循我上面的建议，您的 Web 项目根本不会直接依赖于该项目，这是一件好事，而且肯定比让您的富域对象依赖于您的 Web 项目更好（如果这甚至一个考虑 - 我意识到你并没有说你正在这样做）。

如果您的 DTO 是特定于视图的，那么我会将它们包含在您的 UI 项目中。确实应该是控制器的工作，以确保视图仅从模型中获取所需的内容-在您的情况下，它是一个仅包含视图所需字段的值对象。

# objective-c - Objective-C：为什么叫'id'？

> ID：494114
> 
> 赞同：27
> 
> 时间：2009-01-30T00:58:52.600
> 
> 标签：objective-c

为什么 Objective-C 对象类型称为“id”？与“对象”相反？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-01-30T01:31:21.287

它之所以被称为 id，是因为从字面上看，它就是所有类型所代表的 - 一个标识符。

引用 Brad Cox 从[Object Oriented Programming: an Evolutionary Approach](https://rads.stackoverflow.com/amzn/click/com/0201548348)（实际上，第一版，我买的第一本 OO 书籍之一）：*一个 id 占用固定数量的空间，其宽度足以识别任何可能存在的尽可能多的对象时间。这个空间和对象本身的私有数据占用的空间是不一样的。对象标识符是固定大小的数字，...*

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-30T02:22:25.910

我想这里没有提到的另一种可能性是 Objective-C 的人是拉丁爱好者，并且基于拉丁代词 id（意思是“它”）的单数主格/宾格（主语/宾语）形式。它是一种针对特定对象的通用词，而 id 是指向通用对象的指针，所以，你永远不知道:)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-30T01:09:37.743

也许这是阶级系统的本我（如弗洛伊德的本我/自我/超我）——考虑到本我是有机体的基本性质，这会有点道理。并不是说我相信任何弗洛伊德的垃圾话:-)。

或者，也许 Obj-C 的开发者来自命名器的 UNIX 学校（使用“ls”或“cd”）而不是 VAX 学校（使用“显示目录”和“设置目录”）。

或者，它可以代表例如数据，这可能更有可能。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-30T01:18:44.277

没有证据的理论：

“身份”怎么样，因为它是指向任何唯一对象的指针。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-30T01:22:30.727

正如 Ryan 所说，它实际上是一个指针：IIRC 它是 NSObject *。

至于命名 - 也许命名器使用 Dvorak 键布局。在这种情况下，'id' 很容易输入（就像在 Qwerty 上输入 'gh'）。

# plot - 如何将列表从 Excel 移动到 Sage？

> ID：494116
> 
> 赞同：0
> 
> 时间：2009-01-30T00:59:56.717
> 
> 标签：plot, modeling

我在 Excel 中有一个列，我需要将其从 Excel 移动到 Sage。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-05T06:44:20.090

1.  使用[OpenOffice](http://www.openoffice.org/)在 Linux 上打开有问题的 Excel 文件
2.  将列保存到文本文件
3.  在 Sage 中打开文本文件（有关在 Sage 中打开文本文件的详细信息，请参阅[此线程](http://groups.google.com/group/sage-support/browse_thread/thread/4600e491955f4960)）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-05T06:23:58.307

你不能轻易。Sage 不能在 Linux Excel 上运行。最好的办法是编写一个 python 脚本将列表导出到一个文件，然后在从 Linux 机器下载后将其导入到 excel 中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-01T21:00:18.330

Sage 是 python 应用程序，安装一个用于读取 xml 文件的模块（有一些），然后就可以了...

# perl - 如何使用 Perl 将文档上传到 SharePoint？

> ID：494120
> 
> 赞同：5
> 
> 时间：2009-01-30T01:01:48.600
> 
> 标签：perl, sharepoint, web-applications, upload

我有一个运行一些 perforce 操作的 Perl 应用程序，最后我希望它将结果上传到 SharePoint 网站。

*   可以完成将文档添加到 SharePoint 的任务的最简单的 Perl 脚本是什么？

该脚本需要在 Solaris 上运行并使用尽可能少的外部库（绝对是纯粹的经典 Perl）在这些 un​​ix 机器上安装任何额外的东西是一件痛苦的事情，并且必须由远程团队完成。

如果这可以使用 wget 轻松完成上传文档，那也很有趣。无论如何，我正在寻找易于理解的 1 或一对夫妇班轮。

基于评论的更新：

*   Perl Mechanize 听起来是个好主意，但由于某种原因我无法进行身份验证，错误 GETing`http://sharepoint Unauthorized ....`

我有这个：

```
my $m = WWW::Mechanize->new(); 
$m->credentials($user => $pass); 
$m->get($url); 
```

但是由于某种原因，mechanize 不会针对 sharepoint 进行身份验证。

*   有人有关于如何通过 perl 从 unix 使用 sharepoint webdav 的链接或示例吗？

我安装并尝试通过“dave”webdav 浏览器打开[我的典型共享点站点](http://www.webdav.org/perldav)，但`** Unauthorized. **`出现错误。

*   如何在 unix 上使用 perl 的 webdav 方法解决它？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-30T01:17:17.227

这听起来像是[WWW::Mechanize](http://search.cpan.org/perldoc?WWW::Mechanize)的工作。它对处理表单有很好的支持。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-02T22:57:36.947

刚刚从 perlmonks 论坛在 windows 上找到了一个简单的方法：

```
http://www.perlmonks.org/?node_id=527182
under Windows, you can access a sharepoint site via a UNC name. The URL:
sharepoint.domain.dom/sites/Roboticus/Test
is accessible via:
\\sharepoint.domain.com\sites\Roboticus\Test 
```

只是作为自己的答案，现在我必须弄清楚如何从 Perl 编写脚本，以及是否有办法从在 unix 上运行的脚本中执行相同的操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-30T01:16:24.390

你可以使用[Webdav](http://webdav.org/perldav/)界面吗？每个 SharePoint 列表都有一个与之关联的 webdav 文件夹。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-12-20T14:47:50.593

要使 NTLM 身份验证在 WWW::Mechanize 中工作，您需要使用此格式

```
use URI;
my $u    = URI->new($url);
my $host = $u->host;
my $port = $u->port;
my $hostport = "$host:$port";

$agent->$self->credentials($hostport, $realm, $user, $password); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-02-22T19:43:40.377

*您可以使用curl*连接到 SharePoint（或任何网站），它能够与 Kerberos/NTLM 进行身份验证和执行协商：

```
curl --ntlm -u domain/userid:passwd -T <file> "http://sharepoint URL" 
```

*   > --ntlm
    > (HTTP) 启用 NTLM 身份验证。NTLM 身份验证方法由 Microsoft 设计，供 IIS Web 服务器使用。它是一个专有协议，由聪明的人进行逆向工程，并根据他们的努力在 curl 中实现。这种行为不应该得到认可，您应该鼓励使用 NTLM 的每个人改用公共和记录的身份验证方法，例如 Digest。
    > 
    > 如果要为代理身份验证启用 NTLM，请使用 --proxy-ntlm。
    > 
    > 此选项需要使用 SSL 支持构建的库。使用 -V, --version 查看你的 curl 是否支持 NTLM。
    > 
    > 如果多次使用此选项，则仅使用第一个。

*   > -u，--用户
    > 
    > 指定用于服务器身份验证的用户名和密码。覆盖 -n、--netrc 和--netrc-optional。
    > 
    > 如果您只是指定用户名，curl 将提示输入密码。
    > 
    > 用户名和密码在第一个冒号上分开，这使得使用此选项无法在用户名中使用冒号。密码还是可以的。
    > 
    > 将 Kerberos V5 与基于 Windows 的服务器一起使用时，您应该在用户名中包含 Windows 域名，以便服务器成功获取 Kerberos 票证。如果您不这样做，那么初始身份验证握手可能会失败。
    > 
    > 使用 NTLM 时，可以将用户名简单地指定为用户名，而无需域，例如，如果您的设置中有单个域和林。
    > 
    > 要指定域名，请使用下级登录名或 UPN（用户主体名称）格式。例如，EXAMPLE\user 和 user@example.com 分别。
    > 
    > 如果您使用启用了 Windows SSPI 的 curl 二进制文件并执行 Kerberos V5、Negotiate、NTLM 或 Digest 身份验证，那么您可以通过使用此选项指定单个冒号来告诉 curl 从您的环境中选择用户名和密码：“-u :” .
    > 
    > 如果多次使用此选项，将使用最后一个。

*   > -T，--上传文件
    > 
    > 这会将指定的本地文件传输到远程 URL。如果指定的 URL 中没有文件部分，Curl 将附加本地文件名。请注意，您必须在最后一个目录上使用尾随 / 才能真正向 Curl 证明没有文件名，否则 curl 会认为您的最后一个目录名是要使用的远程文件名。这很可能会导致上传操作失败。如果在 HTTP(S) 服务器上使用它，将使用 PUT 命令。
    > 
    > 使用文件名“-”（单破折号）来使用标准输入而不是给定文件。或者，文件名“。” （单个句点）可以指定而不是“-”以在非阻塞模式下使用标准输入，以允许在上传标准输入时读取服务器输出。
    > 
    > 您可以在命令行上为每个 URL 指定一个 -T。每个 -T + URL 对指定要上传的内容和上传到的位置。curl 还支持 -T 参数的“globbing”，这意味着您可以使用 URL 中支持的相同 URL globbing 样式将多个文件上传到单个 URL，如下所示：
    > 
    > curl -T "{file1,file2}" [http://www.uploadtothissite.com](http://www.uploadtothissite.com)
    > 
    > 甚至
    > 
    > curl -T "img[1-1000].png" [ftp://ftp.picturemania.com/upload/](ftp://ftp.picturemania.com/upload/)

# firefox - 有人在使用 Firefox XUL IDE 吗？

> ID：494125
> 
> 赞同：14
> 
> 时间：2009-01-30T01:04:33.227
> 
> 标签：firefox, ide, xul

我对 Firebug、XUL 调试器或 JavaScript 编辑器不感兴趣，但对 XUL 表单设计的真正 WYSIWYG IDE 感兴趣。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-30T02:37:25.320

我使用[XUL Explorer](https://developer.mozilla.org/en/XUL_Explorer)对事物进行快速建模或检查我不熟悉的元素。它不是所见即所得，但您可以拖放元素。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-14T01:18:08.713

我只是想指出我使用[ActiveState KomodoEdit](http://www.activestate.com/komodo_edit/)进行 XUL 开发。它没有所见即所得的 XUL gui 设计，但它可以识别 XUL 文件，并且可以为您提供 XUL 命名空间及其相应 JS 文件的代码提示。

请注意，Komodo 也是用 XUL 编写的。它对我来说效果很好:-)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-05-28T10:36:25.003

有一个名为[XUL Gear的所见即所得编辑器](https://addons.mozilla.org/en-US/firefox/addon/162046/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-17T06:31:49.747

Spket IDE 也没有所见即所得。

您可能想在[https://addons.mozilla.org/en-US/firefox/addon/7434](https://addons.mozilla.org/en-US/firefox/addon/7434)尝试 Extension Developer ，这是一个 Firefox 插件。该页面上的一个屏幕截图展示了 WYSIWIG XUL 编辑器。您可以使用 Spket IDE 编辑 XUL 文件并使用此编辑器加载它以检查最终效果。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-09-10T22:16:22.270

这是一个 MozillaWiki 页面，[其中列出了 XUL 集成开发环境](https://wiki.mozilla.org/XUL:IDE)和每个环境的描述。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-16T17:27:15.517

您可能想试试[Songbird](http://getsongbird.com/)的 XUL 布局编辑器。我记得它非常完整且易于使用，并且它附带了许多将每个 XUL 元素放在多个布局场景中的示例。我相信您需要每晚构建或开发版本，您可以从网站轻松获得。

好在除了编辑器之外，它还附带了一些其他花哨且非常有用的 XUL 开发工具。当然，它是一个很棒的 iTunes 替代品；）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-30T01:13:53.537

我认为 Xul 没有可用的 Wysiwyg IDE，但有[Spket IDE](http://www.spket.com/)，它可以帮助你

# sql - 指定从 GORM 类生成的 DDL 中的字段顺序？

> ID：494135
> 
> 赞同：2
> 
> 时间：2009-01-30T01:09:43.827
> 
> 标签：sql, grails, groovy, grails-orm, ddl

我使用 GORM 从 groovy 类生成我的数据库的 DDL。这是伟大的。但是，生成的 SQL 中的字段顺序与类中字段的顺序是不一样的。例如，如果我创建类

```
class Person
{
  String firstName
  String lastName
  String address
  String email
} 
```

生成以下 SQL（对于 MySQL）

```
CREATE TABLE `test` (
  `id` bigint(20) NOT NULL auto_increment,
  `version` bigint(20) NOT NULL,
  `address` varchar(255) NOT NULL,
  `email` varchar(255) NOT NULL,
  `first_name` varchar(255) NOT NULL,
  `last_name` varchar(255) NOT NULL,
  PRIMARY KEY  (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1 
```

这些字段已按*字母*顺序排序（在自动生成的 id 和版本字段之后）。在这种情况下这没问题，但我有一些更广泛的表，其中按字段顺序包含重要的上下文信息。

这是我的问题：如何告诉 GORM 按照 groovy 类中的声明顺序对 SQL 中的字段进行排序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-30T17:52:08.500

我对此并不完全确定，但约束闭包定义了视图中字段的顺序，也许这反映了表上的字段。

```
class Person
{
  String firstName
  String lastName
  String address
  String email
}

static constraints = {
  firstName()
  lastName()
  address()
  email()
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-03T12:47:02.637

似乎没有指定顺序的方法，但您始终可以根据需要创建自己的表并在域类中提供名称映射。您也可以让 GORM 创建表，然后以正确的顺序重新创建表，然后关闭 GORM 中的自动 DDL 内容。如果您使用 GORM 选择的字段和表名称，则无需添加任何映射。

# asp.net - 检查 ASP.NET 表单上具有特定子字符串的所有单选控件

> ID：494140
> 
> 赞同：1
> 
> 时间：2009-01-30T01:12:14.243
> 
> 标签：asp.net, javascript

我正在研究一个由 .NET 提供支持的问卷，其中包含几个转发器控件，其中每一行包含三个单选按钮。我正在尝试编写一个简单的 Javascript 函数来检查页面上在控件名称/id 中包含单词“chkGreen”的所有控件。

该页面如下所示：

```
Repeater 1
Description 1           ( ) Green ( ) Yellow ( ) Red
Description 2           ( ) Green ( ) Yellow ( ) Red
Description 3           ( ) Green ( ) Yellow ( ) Red

Repeater 2
Description 1           ( ) Green ( ) Yellow ( ) Red
Description 2           ( ) Green ( ) Yellow ( ) Red
Description 3           ( ) Green ( ) Yellow ( ) Red 
```

这是到目前为止的功能：

```
 for (i = 0; i < document.Form1.elements.length; i++) {
      var _control = document.Form1.elements[i].id
      if (_control.indexOf("chkGreen") > 0) {
         eval(_control.checked = true);
      }
   } 
```

此功能不起作用。当我在语句中添加 document.write 或 alert() 时，它会正确触发，因此逻辑显然是有效的，只是实际的单选按钮检查代码不起作用。

有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-30T01:20:18.097

您不需要评估 _control.checked 行。

```
for (i = 0; i < document.Form1.elements.length; i++) {
  var _control = document.Form1.elements[i]; // EDIT: you want the element, not the id of the element
  if (_control.indexOf("chkGreen") > 0) {
     _control.checked = true;
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-30T01:36:12.760

感谢您及时的回复。我在不使用 eval() 的情况下尝试了该功能，但它不起作用。我已经通过使用 document.getElementById 获得了该功能：

```
for (i = 0; i < document.form1.elements.length; i++) {
  var _control = document.form1.elements[i].id
  if (_control.indexOf("chkGreen") > 0) {
    var thecontrol = document.getElementById(_control);
    thecontrol.checked = true;
  }
} 
```

# javascript - 使用内置 DOM 方法或 Prototype 从 HTML 字符串创建新的 DOM 元素

> ID：494143
> 
> 赞同：798
> 
> 时间：2009-01-30T01:13:44.520
> 
> 标签：javascript, dom, prototypejs

我有一个表示元素的 HTML 字符串：`'<li>text</li>'`。我想将它附加到 DOM 中的一个元素（`ul`在我的例子中是一个）。如何使用 Prototype 或 DOM 方法做到这一点？

（我知道我可以在 jQuery 中轻松做到这一点，但不幸的是我们没有使用 jQuery。）

* * *

## 回答 #1

> 赞同：981
> 
> 时间：2009-01-30T03:00:25.210

**注意：**大多数当前浏览器都支持 HTML`<template>`元素，这提供了一种更可靠的方式来从字符串创建元素。有关详细信息，请参阅[下面的 Mark Amery 的回答](https://stackoverflow.com/a/35385518/1709587)。

**对于较旧的浏览器和 node/jsdom** :（在撰写本文时还不支持`<template>`元素），请使用以下方法。这与库用来从 HTML 字符串中获取 DOM 元素所做的事情相同（[IE 需要做一些额外的工作](https://stackoverflow.com/questions/1848588/why-does-html-work-and-not-innerhtml-or-appendchild/1849100#1849100)来解决其实现的错误`innerHTML`）：

```
function createElementFromHTML(htmlString) {
  var div = document.createElement('div');
  div.innerHTML = htmlString.trim();

  // Change this to div.childNodes to support multiple top-level nodes.
  return div.firstChild;
} 
```

请注意，与 HTML 模板不同，这*不适*用于某些不能合法成为 a 子级的元素`<div>`，例如`<td>`s。

如果您已经在使用库，我建议您坚持使用库认可的从 HTML 字符串创建元素的方法：

*   [`update()`Prototype 在它的方法](http://prototypejs.org/doc/latest/dom/Element/update/)中内置了这个特性。
*   jQuery 在其[`jQuery(html)`](https://api.jquery.com/jQuery/#jQuery2)和[`jQuery.parseHTML`](https://api.jquery.com/jQuery.parseHTML/)方法中实现了它。

* * *

## 回答 #2

> 赞同：539
> 
> 时间：2016-02-13T21:25:59.517

HTML 5 引入了`<template>`可用于此目的的元素（现在在[WhatWG 规范](https://html.spec.whatwg.org/multipage/scripting.html#the-template-element)和[MDN 文档](https://developer.mozilla.org/en/docs/Web/HTML/Element/template)中进行了描述）。

`<template>`元素用于声明可在脚本中使用的 HTML 片段。该元素在 DOM 中表示为[`HTMLTemplateElement`](https://developer.mozilla.org/en-US/docs/Web/API/HTMLTemplateElement)具有type[`.content`](https://developer.mozilla.org/en-US/docs/Web/API/HTMLTemplateElement/content)属性的a [`DocumentFragment`](https://developer.mozilla.org/en/docs/Web/API/DocumentFragment)，以提供对模板内容的访问。这意味着您可以通过设置元素的 来将 HTML 字符串转换为 DOM 元素[`innerHTML`](https://developer.mozilla.org/en-US/docs/Web/API/Element/innerHTML)，`<template>`然后进入`template`'`.content`属性。

例子：

```
/**
 * @param {String} HTML representing a single element
 * @return {Element}
 */
function htmlToElement(html) {
    var template = document.createElement('template');
    html = html.trim(); // Never return a text node of whitespace as the result
    template.innerHTML = html;
    return template.content.firstChild;
}

var td = htmlToElement('<td>foo</td>'),
    div = htmlToElement('<div><span>nested</span> <span>stuff</span></div>');

/**
 * @param {String} HTML representing any number of sibling elements
 * @return {NodeList} 
 */
function htmlToElements(html) {
    var template = document.createElement('template');
    template.innerHTML = html;
    return template.content.childNodes;
}

var rows = htmlToElements('<tr><td>foo</td></tr><tr><td>bar</td></tr>'); 
```

请注意，[使用不同容器元素（例如 a ）的`div`](https://stackoverflow.com/a/494348/1709587)类似方法不太有效。HTML 对允许哪些元素类型存在于哪些其他元素类型中有限制；例如，您不能将 a`td`作为 a 的直接子级`div`。如果您尝试将`innerHTML`a设置`div`为包含它们，这会导致这些元素消失。由于`<template>`s 对它们的内容没有这样的限制，所以这个缺点在使用模板时不适用。

但是，`template`某些旧浏览器不支持。截至 2021 年 4 月，*Can I use...*估计[全球 96% 的用户正在使用支持`template`s](http://caniuse.com/#feat=template)的浏览器。特别是，没有任何版本的 Internet Explorer 支持它们；微软`template`直到 Edge 发布才实施支持。

如果您有幸编写仅针对现代浏览器用户的代码，请立即使用它们。否则，您可能需要等待一段时间才能让用户赶上。

* * *

## 回答 #3

> 赞同：190
> 
> 时间：2017-10-28T22:03:45.600

使用[insertAdjacentHTML()](https://developer.mozilla.org/en-US/docs/Web/API/Element/insertAdjacentHTML)。它适用于所有当前的浏览器，甚至适用于 IE11。

```
var mylist = document.getElementById('mylist');
mylist.insertAdjacentHTML('beforeend', '<li>third</li>');
```

```
<ul id="mylist">
 <li>first</li>
 <li>second</li>
</ul>
```

* * *

## 回答 #4

> 赞同：42
> 
> 时间：2017-02-24T21:48:41.827

无需任何调整，您有一个原生 API：

```
const toNodes = html =>
    new DOMParser().parseFromString(html, 'text/html').body.childNodes[0] 
```

* * *

## 回答 #5

> 赞同：33
> 
> 时间：2011-09-06T21:53:15.810

较新的 DOM 实现具有[`range.createContextualFragment`](https://developer.mozilla.org/en/DOM/range.createContextualFragment)，它以独立于框架的方式执行您想要的操作。

它得到了广泛的支持。不过可以肯定的是，在同一个 MDN 链接中**检查它的兼容性**，因为它会发生变化。截至 2017 年 5 月，情况如下：

```
Feature         Chrome   Edge   Firefox(Gecko)  Internet Explorer   Opera   Safari
Basic support   (Yes)    (Yes)  (Yes)           11                  15.0    9.1.2 
```

* * *

## 回答 #6

> 赞同：32
> 
> 时间：2015-12-17T11:42:42.367

对于此处其他答案中提到的某些 html 片段`<td>test</td>`，例如 div.innerHTML、DOMParser.parseFromString 和 range.createContextualFragment（没有正确的上下文）解决方案，不会创建`<td>`元素。

jQuery.parseHTML() 可以正确处理它们（我将[jQuery 2 的 parseHTML 函数提取为一个独立的函数](https://gist.github.com/Munawwar/6e6362dbdf77c7865a99)，可以在非 jquery 代码库中使用）。

如果您只支持 Edge 13+，则只使用 HTML5 模板标签会更简单：

```
function parseHTML(html) {
    var t = document.createElement('template');
    t.innerHTML = html;
    return t.content;
}

var documentFragment = parseHTML('<td>Test</td>'); 
```

* * *

## 回答 #7

> 赞同：16
> 
> 时间：2013-05-03T00:02:50.207

这是一个简单的方法：

```
String.prototype.toDOM=function(){
  var d=document
     ,i
     ,a=d.createElement("div")
     ,b=d.createDocumentFragment();
  a.innerHTML=this;
  while(i=a.firstChild)b.appendChild(i);
  return b;
};

var foo="<img src='//placekitten.com/100/100'>foo<i>bar</i>".toDOM();
document.body.appendChild(foo); 
```

* * *

## 回答 #8

> 赞同：14
> 
> 时间：2017-02-28T14:31:14.577

您可以使用以下方法从字符串创建有效的 DOM 节点：

`document.createRange().createContextualFragment()`

以下示例在页面中添加一个按钮元素，该元素从字符串中获取标记：

```
let html = '<button type="button">Click Me!</button>';
let fragmentFromString = function (strHTML) {
  return document.createRange().createContextualFragment(strHTML);
}
let fragment = fragmentFromString(html);
document.body.appendChild(fragment);
```

* * *

## 回答 #9

> 赞同：10
> 
> 时间：2016-06-08T12:39:02.497

我正在使用这种方法（在 IE9+ 中工作），尽管它不会解析`<td>`或其他一些无效的 body 直接子代：

```
function stringToEl(string) {
    var parser = new DOMParser(),
        content = 'text/html',
        DOM = parser.parseFromString(string, content);

    // return element
    return DOM.body.childNodes[0];
}

stringToEl('<li>text</li>'); //OUTPUT: <li>text</li> 
```

* * *

## 回答 #10

> 赞同：9
> 
> 时间：2020-05-22T19:51:40.820

为什么不使用原生 js？

```
 var s="<span class='text-muted' style='font-size:.75em; position:absolute; bottom:3px; left:30px'>From <strong>Dan's Tools</strong></span>"
    var e=document.createElement('div')
    var r=document.createRange();
    r.selectNodeContents(e)
    var f=r.createContextualFragment(s);
    e.appendChild(f);
    e = e.firstElementChild; 
```

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2017-08-20T17:24:20.487

我添加了`Document`一个从字符串创建元素的原型：

```
Document.prototype.createElementFromString = function (str) {
   const element = new DOMParser().parseFromString(str, 'text/html');
   const child = element.documentElement.querySelector('body').firstChild;
   return child;
}; 
```

用法：

```
document.createElementFromString("<h1>Hello World!</h1>"); 
```

* * *

## 回答 #12

> 赞同：7
> 
> 时间：2018-06-17T20:34:37.593

为了进一步增强我们可以在不同地方找到的有用的*.toDOM()*片段，我们现在可以*安全地*使用**反引号**（[模板文字](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Template_literals)）。

所以我们可以在*foo* html 声明中使用单引号和双引号。

对于熟悉该术语的人来说，这就像[heredocs 。](https://en.wikipedia.org/wiki/Here_document)

这可以通过变量进一步增强，以制作复杂的模板：

> 模板文字由反引号 (`)（重音）字符而不是双引号或单引号括起来。模板文字可以包含占位符。这些由美元符号和花括号 (${expression}) 表示。占位符中的表达式和它们之间的文本被传递给一个函数。默认函数只是将部分连接成一个字符串。如果模板文字（此处为标记）之前有一个表达式，则称为“标记模板”。在这种情况下，标签表达式（通常是一个函数）会被处理后的模板文字调用，然后您可以在输出之前对其进行操作。要在模板文字中转义反引号，请在反引号之前放置一个反斜杠 \。

```
String.prototype.toDOM=function(){
  var d=document,i
     ,a=d.createElement("div")
     ,b=d.createDocumentFragment()
  a.innerHTML = this
  while(i=a.firstChild)b.appendChild(i)
  return b
}

// Using template literals
var a = 10, b = 5
var foo=`
<img 
  onclick="alert('The future starts today!')"   
  src='//placekitten.com/100/100'>
foo${a + b}
  <i>bar</i>
    <hr>`.toDOM();
document.body.appendChild(foo);
```

```
img {cursor: crosshair}
```

那么，为什么不直接使用`.innerHTML +=` 呢？通过这样做，浏览器正在重新计算整个 DOM，速度要慢得多。

[https://caniuse.com/template-literals](https://caniuse.com/template-literals)

* * *

## 回答 #13

> 赞同：6
> 
> 时间：2009-02-19T15:13:51.037

以下是使用[PrototypeJS](http://prototypejs.org/)的方法（如 12 年前 OP 最初要求的那样）：

HTML：

```
<ul id="mylist"></ul> 
```

JS：

```
$('mylist').insert('<li>text</li>'); 
```

请注意，**这不是 jQuery！**

* * *

## 回答 #14

> 赞同：6
> 
> 时间：2020-07-12T22:02:35.187

# 回答

*   创建一个`Template`
*   将`Template's`innerHTML 设置为您的`string` `.trim()`
*   创建`Array`一个`Template's`孩子
*   返回`children`, `child`, 或

```
function toElement(s='',c,t=document.createElement('template'),l='length'){
t.innerHTML=s.trim();c=[...t.content.childNodes];return c[l]>1?c:c[0]||'';}

console.log(toElement());
console.log(toElement(''));
console.log(toElement('    '));
console.log(toElement('<td>With td</td>'));
console.log(toElement('<tr><td>With t</td></tr>'));
console.log(toElement('<tr><td>foo</td></tr><tr><td>bar</td></tr>'));
console.log(toElement('<div><span>nested</span> <span>stuff</span></div>'));
```

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2018-05-28T11:45:50.810

# HTML5 和 ES6

`<template>`

演示

```
"use strict";

/**
 *
 * @author xgqfrms
 * @license MIT
 * @copyright xgqfrms
 * @description HTML5 Template
 * @augments
 * @example
 *
 */

/*

<template>
    <h2>Flower</h2>
    <img src="https://www.w3schools.com/tags/img_white_flower.jpg">
</template>

<template>
    <div class="myClass">I like: </div>
</template>

*/

const showContent = () => {
    // let temp = document.getElementsByTagName("template")[0],
    let temp = document.querySelector(`[data-tempalte="tempalte-img"]`),
        clone = temp.content.cloneNode(true);
    document.body.appendChild(clone);
};

const templateGenerator = (datas = [], debug = false) => {
    let result = ``;
    // let temp = document.getElementsByTagName("template")[1],
    let temp = document.querySelector(`[data-tempalte="tempalte-links"]`),
        item = temp.content.querySelector("div");
    for (let i = 0; i < datas.length; i++) {
        let a = document.importNode(item, true);
        a.textContent += datas[i];
        document.body.appendChild(a);
    }
    return result;
};

const arr = ["Audi", "BMW", "Ford", "Honda", "Jaguar", "Nissan"];

if (document.createElement("template").content) {
    console.log("YES! The browser supports the template element");
    templateGenerator(arr);
    setTimeout(() => {
        showContent();
    }, 0);
} else {
    console.error("No! The browser does not support the template element");
}
```

```
@charset "UTf-8";

/* test.css */

:root {
    --cololr: #000;
    --default-cololr: #fff;
    --new-cololr: #0f0;
}

[data-class="links"] {
    color: white;
    background-color: DodgerBlue;
    padding: 20px;
    text-align: center;
    margin: 10px;
}
```

```
<!DOCTYPE html>
<html lang="zh-Hans">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Template Test</title>
    <!--[if lt IE 9]>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.js"></script>
    <![endif]-->
</head>

<body>
    <section>
        <h1>Template Test</h1>
    </section>
    <template data-tempalte="tempalte-img">
        <h3>Flower Image</h3>
        <img src="https://www.w3schools.com/tags/img_white_flower.jpg">
    </template>
    <template data-tempalte="tempalte-links">
        <h3>links</h3>
        <div data-class="links">I like: </div>
    </template>
    <!-- js -->
</body>

</html>
```

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2012-12-13T12:39:13.987

迟到了，但只是作为一个说明；

可以将一个普通元素作为容器添加到目标元素，并在使用后将其删除。

// 在 chrome 23.0、firefox 18.0 即 7-8-9 和 opera 12.11 上测试。

```
<div id="div"></div>

<script>
window.onload = function() {
    var foo, targetElement = document.getElementById('div')
    foo = document.createElement('foo')
    foo.innerHTML = '<a href="#" target="_self">Text of A 1.</a> '+
                    '<a href="#" onclick="return !!alert(this.innerHTML)">Text of <b>A 2</b>.</a> '+
                    '<hr size="1" />'
    // Append 'foo' element to target element
    targetElement.appendChild(foo)

    // Add event
    foo.firstChild.onclick = function() { return !!alert(this.target) }

    while (foo.firstChild) {
        // Also removes child nodes from 'foo'
        targetElement.insertBefore(foo.firstChild, foo)
    }
    // Remove 'foo' element from target element
    targetElement.removeChild(foo)
}
</script> 
```

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2021-04-10T05:21:35.613

您可以使用 DOM 解析器：

```
const parser = new DOMParser();
const htmlString = "<strong>Beware of the leopard</strong>";
const doc3 = parser.parseFromString(htmlString, "text/html"); 
```

[参考](https://developer.mozilla.org/en-US/docs/Web/API/DOMParser)

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2011-05-21T07:40:44.077

这是我的代码，它可以工作：

```
function parseTableHtml(s) { // s is string
    var div = document.createElement('table');
    div.innerHTML = s;

    var tr = div.getElementsByTagName('tr');
    // ...
} 
```

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2020-01-16T12:18:20.567

从字符串渲染 DOM 的最快解决方案：

```
let render = (relEl, tpl, parse = true) => {
  if (!relEl) return;
  const range = document.createRange();
  range.selectNode(relEl);
  const child = range.createContextualFragment(tpl);
  return parse ? relEl.appendChild(child) : {relEl, el};
}; 
```

[在这里](https://jsperf.com/react-vs-raw-dom-manipulation)你可以检查 DOM 操作 React 与原生 JS 的性能

现在你可以简单地使用：

```
let element = render(document.body, `
<div style="font-size:120%;line-height:140%">
  <p class="bold">New DOM</p>
</div>
`); 
```

当然，在不久的将来，你会使用内存中的引用，因为 var "element" 是你在文档中新创建的 DOM。

记住“innerHTML=”非常慢：/

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2013-09-21T03:47:51.940

对于它，我想我会通过我想出的复杂但简单的方法来分享这个......也许有人会发现一些有用的东西。

```
/*Creates a new element - By Jamin Szczesny*/
function _new(args){
    ele = document.createElement(args.node);
    delete args.node;
    for(x in args){ 
        if(typeof ele[x]==='string'){
            ele[x] = args[x];
        }else{
            ele.setAttribute(x, args[x]);
        }
    }
    return ele;
}

/*You would 'simply' use it like this*/

$('body')[0].appendChild(_new({
    node:'div',
    id:'my-div',
    style:'position:absolute; left:100px; top:100px;'+
          'width:100px; height:100px; border:2px solid red;'+
          'cursor:pointer; background-color:HoneyDew',
    innerHTML:'My newly created div element!',
    value:'for example only',
    onclick:"alert('yay')"
})); 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2021-04-26T09:41:44.127

我已经从这篇文章中链接了。^(（[将 HTML 字符串转换为 DOM 元素？](https://stackoverflow.com/q/3103962/)）)

对我来说，我想找到一种将字符串转换为 HTML 元素的方法。如果你也有这个需求，可以试试下面的

```
const frag = document.createRange().createContextualFragment(
`<a href="/link.js">js</a> 
 <a>go</a>
`
) 
const aCollection = frag.querySelectorAll("a")
for (let [key, a] of Object.entries(aCollection)) {
  console.log(a.getAttribute("href"), a.textContent)
}
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2021-10-06T11:38:46.000

我自己对此进行了很多搜索，并遇到了这个简洁的解决方案。

```
const stringToHTML = (str) => {
    var parser = new DOMParser();
    var doc = parser.parseFromString(str, 'text/html');
    return doc.body;
}; 
```

我想转换的字符串：

```
'<iframe src="https://player.vimeo.com/video/578680903?h=ea840f9223&amp;app_id=122963" width="640" height="360" frameborder="0" allow="autoplay; fullscreen; picture-in-picture" allowfullscreen title="Total Body Balance"></iframe>' 
```

结果：

```
<body><iframe src="https://player.vimeo.com/video/578680903?h=ea840f9223&amp;app_id=122963" width="640" height="360" frameborder="0" allow="autoplay; fullscreen; picture-in-picture" allowfullscreen="" title="Total Body Balance"></iframe></body> 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2022-01-21T14:57:47.733

最新 JS 示例：

```
<template id="woof-sd-feature-box">
<div class="woof-sd-feature-box" data-key="__KEY__" data-title="__TITLE__" data-data="__OPTIONS__">
    <h4>__TITLE__</h4>
    <div class="woof-sd-form-item-anchor">
        <img src="img/move.png" alt="">
    </div>
</div>

</template>

<script>
create(example_object) {
        let html = document.getElementById('woof-sd-feature-box').innerHTML;
        html = html.replaceAll('__KEY__', example_object.dataset.key);
        html = html.replaceAll('__TITLE__', example_object.dataset.title);
        html = html.replaceAll('__OPTIONS__', example_object.dataset.data);
        //convertion HTML to DOM element and prepending it into another element
        const dom = (new DOMParser()).parseFromString(html, "text/html");
        this.container.prepend(dom.querySelector('.woof-sd-feature-box'));
    }
</script> 
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2022-03-03T16:11:53.600

访问[https://www.codegrepper.com/code-examples/javascript/convert+a+string+to+html+element+in+js](https://www.codegrepper.com/code-examples/javascript/convert+a+string+to+html+element+in+js)

```
const stringToHtml = function (str) {
    var parser = new DOMParser();
    var doc = parser.parseFromString(str, 'text/html');
    return doc.body;
} 
```

* * *

## 回答 #25

> 赞同：-1
> 
> 时间：2016-02-08T10:59:21.400

```
function domify (str) {
  var el = document.createElement('div');
  el.innerHTML = str;

  var frag = document.createDocumentFragment();
  return frag.appendChild(el.removeChild(el.firstChild));
}

var str = "<div class='foo'>foo</div>";
domify(str); 
```

* * *

## 回答 #26

> 赞同：-2
> 
> 时间：2017-07-11T06:05:22.840

您可以使用以下函数将文本“HTML”转换为元素

```
function htmlToElement(html)
{
  var element = document.createElement('div');
  element.innerHTML = html;
  return(element);
}
var html="<li>text and html</li>";
var e=htmlToElement(html);
```

* * *

## 回答 #27

> 赞同：-3
> 
> 时间：2018-01-08T10:23:19.523

这是我的工作代码

我想将“[文本](http://www.example.com)”字符串转换为 HTML 元素

```
var diva = UWA.createElement('div');
diva.innerHTML = '<a href="http://wwww.example.com">Text</a>';
var aelement = diva.firstChild; 
```

* * *

## 回答 #28

> 赞同：-3
> 
> 时间：2019-05-22T10:11:39.760

var msg = "测试" jQuery.parseHTML(msg)

* * *

## 回答 #29

> 赞同：-4
> 
> 时间：2012-09-25T00:39:23.727

```
var jtag = $j.li({ child:'text' }); // Represents: <li>text</li>
var htmlContent = $('mylist').html();
$('mylist').html(htmlContent + jtag.html()); 
```

使用[发电机](http://jnerator.com/)

* * *

## 回答 #30

> 赞同：-9
> 
> 时间：2012-04-11T22:02:29.660

这也可以：

```
$('<li>').text('hello').appendTo('#mylist'); 
```

感觉更像是一种带有链式函数调用的 jquery 方式。

# asp.net-mvc - System.Web.Mvc.ListItem 是否不再存在于 ASP.NET MVC RC 中？

> ID：494156
> 
> 赞同：2
> 
> 时间：2009-01-30T01:18:20.220
> 
> 标签：asp.net-mvc

尝试创建一个列表以将一些 JSON 数据返回到视图。遵循在测试期间创建的一些网络教程，但在 RC 中似乎代码确实有效。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Mvc;

namespace MvcApplication6.Controllers
{
    [HandleError]
    public class HomeController : Controller
    {
        public JsonResult list()
        {
            List<ListItem> list = new List<ListItem> {
                new ListItem() {Name="value", Something = "more Values"}
            };
            return Json(List);
        }
    }
} 
```

问题是在 System.Web.Mvc 命名空间中找不到 ListItem。我似乎无法让它工作。如果 ListItem 已被删除，您如何在 Release Candidate MVC 中完成此操作？

以下是我尝试使用的教程：

[http://geekswithblogs.net/michelotti/archive/2008/06/28/mvc-json---jsonresult-and-jquery.aspx](http://geekswithblogs.net/michelotti/archive/2008/06/28/mvc-json---jsonresult-and-jquery.aspx) [http://nayyeri.net/blog/using-jsonresult-in-asp-net -mvc-ajax/](http://nayyeri.net/blog/using-jsonresult-in-asp-net-mvc-ajax/)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-30T01:51:57.533

ListItem 在 System.Web.UI.WebControls 中...您可能不想使用它。您可以使用 System.Web.Mvc 命名空间中的 SelectListItem，但您必须更改属性名称（您也必须为 ListItem 执行此操作）。

```
 public JsonResult list()
    {
        List<SelectListItem> list = new List<SelectListItem> {
            new ListItem() { Text="value", Value = "more Values" }
        };
        return Json(List);
    } 
```

我很想用 List<object> 和匿名类型来做到这一点，这样我就可以根据自己的喜好定义属性名称。

```
 public JsonResult list()
    {
        List<object> list = new List<object> {
            new { Name="value", Something = "more Values" }
        };
        return Json(List);
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-18T14:50:41.657

我会选择 MVC 版本。ListItem 遵循 Web 表单模型，向前推进您可能希望分别使用 SelectList 和 SelectListItem。

```
public JSonResult lstResult()
{
   SelectList lst = new SelectList( new List<SelectListItem>() 
   { 
        new SelectListItem { Text = "Text here", Value = "0" }, 
        new SelectListItem { Text="Second Text", Value="1"},
        new SelectListItem { Text="Third Text", Value="2" },
        new SelectListItem { Text="Fourth Text", Value="3"}
    });
        return JSon(lst);
} 
```

# database - 了解 EAV 数据库模型的最佳初学者资源？

> ID：494158
> 
> 赞同：14
> 
> 时间：2009-01-30T01:18:42.827
> 
> 标签：database, database-design, magento, entity-attribute-value

我正在使用 Magento 进行一些自定义工作，它具有基于 EAV 模型的数据库设计，并且我需要一些很好的资源/教程来解释 EAV 数据库模型。请不要将维基百科作为资源提供......我正在寻找以友好方式为初学者教授 EAV 的东西。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-31T05:10:47.677

干得好。一个说明性的故事：[http ://www.simple-talk.com/opinion/opinion-pieces/bad-carma/](http://www.simple-talk.com/opinion/opinion-pieces/bad-carma/)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-30T06:57:42.220

您可以对初学者做的最友好的事情就是教他们 EAV 的缺点。

EAV 的好处是如此诱人，以至于很多新手会在他们意识到之前为自己挖一个非常大的洞。

希望谷歌搜索将揭示至少一些不利的一面。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-31T05:34:51.967

简而言之，EAV 被优化用于获取数据，而不是获取数据。但这可能是一个可以接受的权衡。我管理了一个必须开发通用临床试验数据管理系统的项目。不可能有很多共同的数据元素，因为每个试验都需要收集不同的数据。捕获数据是当务之急；我们不得不在压力下开发数据输入页面。EAV 的报告更难，但它们也不那么紧急，并且通过一些聪明的想法，它们可以简化一点。EAV 为我们提供了很好的服务。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-01-02T16:08:20.740

我发现本指南对 Magento 最有帮助：http: [//alanstorm.com/magento_advanced_orm_entity_attribute_value_part_1](http://alanstorm.com/magento_advanced_orm_entity_attribute_value_part_1)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-05-29T11:37:32.207

我发现这篇文章真的很有帮助，它提供了与 EAV 架构相关的注意事项和后果，并为它在 SQL Server 中的实现提供了一个基本框架。

[http://weblogs.sqlteam.com/davidm/articles/12117.aspx](http://weblogs.sqlteam.com/davidm/articles/12117.aspx)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-03-23T12:55:38.047

您应该查看这篇文章：[数据表示的 EAV/CR 模型](http://ycmi.med.yale.edu/nadkarni/eav_CR_contents.htm)。

它描述了带有类和关系的 EAV，一种更面向对象的方法，而不仅仅是简单的引用键值实现。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-07-05T23:08:51.760

参见 Dinua V 和 Nadkarnia P. 生物医学数据库实体-属性-值建模的有效使用指南。国际医学杂志通知。2007 年；76：769-779。 [http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=2110957](http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=2110957)

# javascript - jQuery：从数组循环中设置点击

> ID：494161
> 
> 赞同：9
> 
> 时间：2009-01-30T01:19:33.790
> 
> 标签：javascript, jquery

我有一系列标题/正文模式的 div，单击标题将显示有问题的正文。

这一切都发生在 .click 在页面就绪时初始化...

而不是这样做（效果很好，但很痛苦）：

```
$('#show_fold_ping').click(function(){ ShowArea('#fold_ping') });
$('#show_fold_http').click(function(){ ShowArea('#fold_http') });
$('#show_fold_smtp').click(function(){ ShowArea('#fold_smtp') });
$('#show_fold_pop3').click(function(){ ShowArea('#fold_pop3') });
... 
```

我正在尝试这样做：

```
var Areas = ['ping','http', 'smtp', 'pop3'];

for( var i in Areas ){
    Area = '#show_fold_'+Areas[i];
    $(Area).click(function(){ alert(Area); /* ShowArea(Area); */ });
} 
```

我遇到的问题是它们似乎都被初始化为最后一个。IE：如果pop3 是最后一个，单击#show_fold_[any] 将提示'#show_fold_pop3'。

这看起来应该很简单。我是否遗漏了一些明显的东西，或者将字符串传递给我不知道的 jQuery 是否存在问题？

**编辑：**

嘿，这些都很棒。我已经阅读了一些关于闭包和自调用函数的内容，并且（kindasorta）明白了。

到目前为止，我有这个，但点击似乎没有正确绑定。区域将使用正确的值发出警报，但没有单击绑定。我是否仍然对 Area 存在范围问题，或者我完全偏离了标准？

```
$(function(){

    Areas = ['ping','http', 'smtp', 'pop3', 'imap', 'ftp', 'dns', 'tcp', 'database', 'seo'];

    for( var i = 0; i < Areas.length; i++ ){
        (function (Area) {
                            alert(Area);
            $("#show_fold_"+Area).click(function(){ alert('x'); });
        })(Areas[i]);
    }
}); 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-30T01:43:24.943

是的，我经常遇到这个问题。`Area`是一个全局变量，因为它`var`之前没有。另外，不要使用 for...in 构造。

但是您可能仍然会遇到类似的问题。天知道我因为一个类似的错误调试了多少脚本。执行以下操作可确保正确的范围界定：

```
var Areas = ['ping','http', 'smtp', 'pop3'];

for( var i = 0; i < Areas.length; i++ ){
  (function(area) {
    $(area).click(function(){ alert(area); /* ShowArea(area); */ });
  })(Areas[i]);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-30T01:29:33.757

这是一个 JavaScript 的东西；它与 jQuery 无关。你正在做的是创建一个闭包，但你没有正确理解它们是如何工作的。

您可能想阅读[http://blog.morrisjohns.com/javascript_closures_for_dummies](http://blog.morrisjohns.com/javascript_closures_for_dummies)，尤其是示例 5、6 和 7。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-30T01:29:18.530

检查“区域”变量的范围。您基本上是在分配一个全局变量，因此最后一次迭代“区域”的范围在循环之外。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-30T01:37:29.417

确保在加载 DOM 后添加了 click 事件处理，您可以将其包含在 head 元素中：

```
var Areas = ['ping','http', 'smtp', 'pop3'];

$(document).ready(function() {
    $.each(Areas, function(i, v){
        var Area = '#show_fold_' + v;
        $(Area).click(function() {
            alert(Area);
        });
    });
} 
```

# c++ - 什么是 PVOID 数据类型？

> ID：494163
> 
> 赞同：15
> 
> 时间：2009-01-30T01:22:10.667
> 
> 标签：c++, pointers, com

有人可以解释一下`PVOID`它是什么以及如何在以下函数中使用它：

```
BOOL DoSomething(PVOID pMemPhy) 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-01-30T01:25:03.297

空指针，同

```
void *pMemPhy 
```

又名“指向某事的指针，但由您自己决定”。

```
BOOL DoSomething ( PVOID pMemPhy )
{
    strcpy((char *)pMemPhy, "I love buffer overflows!");
    return TRUE;
} 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-01-30T01:27:14.447

它是一个**空指针**——一个指向内存地址的指针，没有关于它所指向的值的类型的信息。出于这个原因，您必须将指针转换为诸如`(char *)pMemPhy`或`(int *)pMemPhy`在使用指针之前的类型，以便编译器知道它正在使用多少内存（char 为 1 个字节，int 为 4 个字节等）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-30T02:10:13.580

这个和其他助记符（如 BOOL、LPCTSTR）起源于 Windows，BTW 是在 C 标准存在之前开发的，并且不依赖于使用自己的类型的特定编译器。

您可以查看 Old New Thing 博客，了解有关 Windows 开发历史的更多故事，以及我们仍将保留的奇怪之处 ( [http://blogs.msdn.com/oldnewthing](http://blogs.msdn.com/oldnewthing) )。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-30T01:27:10.687

```
typedef void * PVOID; 
```

如果你的问题是空指针有什么用？最常见的用途是当您将指针传递给并不真正关心类型的内存时。例如，免费（）。

如果一个库导出一个可以采用多种指针类型的函数，但希望支持像 C 这样没有函数重载的语言，那么 void * 可以工作。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-30T01:32:03.157

正如其他人所说，它相当于`void *`.

`void`指针通常用于内存操作（`memcpy`,`memset`等...），因为人们不想假设给定地址处的数据类型。

[来自http://cplusplus.com的](http://cplusplus.com)[这篇](http://www.cplusplus.com/doc/tutorial/pointers.html)文章对指针和 void 指针进行了很好的处理。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-30T01:25:13.920

听起来它只是 void* 的别名（定义或 typedef）。我不知道为什么人们认为这会更好，但我知道一些 API 喜欢使用它，以防将来类型的实现发生变化。

我知道早期版本的 Windows 使用诸如 STDCALL 之类的东西作为许多函数的前缀，并且 STDCALL 的定义可能会根据您编译的 Windows 版本而改变。这是来自记忆（多年后受酒精影响:-)，所以不要把它当作福音。它基本上是正确的，但细节可能会有所不同。

# java - JBPM：从任务节点发出的多个转换

> ID：494171
> 
> 赞同：1
> 
> 时间：2009-01-30T01:26:43.590
> 
> 标签：java, jboss, workflow, jbpm, jboss-tools

在 JBPM 中，我可以（技术上）从任务节点发出多个转换吗？

如果是，这是一个好习惯吗？

任何帮助都会很有用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-30T13:11:55.227

这是可能的，但是如果您通过 callign token.signal() 或 taskInstance.end() 传播您的进程的执行，则选择的转换将是第一个（在 .xml 文件中），无论转换有什么条件. 如果该条件评估为假，将引发异常。

只有开箱即用的决策节点支持通过评估条件来选择转换，并且将选择条件评估为真的第一个转换（或者如果没有条件评估为真，则选择第一个转换）。

但是编写手动传播执行的自定义动作处理程序（token.signal（“transitionname”））并选择正确的转换（tm）非常简单。

对不起我的英语不好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-22T23:59:07.543

我认为他想要的是 Fork，Fork 是一种节点，可以帮助您进行多种转换，更有可能是多流，这种方式的最佳示例是 MC Donald 的，如果您要购买任何东西，他们会同时进行您正在付款，因此当您完成付款时，您就像“加入”一样，因此它可以交付，您可以高兴也可以不高兴。

如果这是问题的重点，请转到“Fork”和“Join”，您可以在 JBPM Docs 中轻松找到答案

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T13:13:46.913

在 BPM 中存在一种可能性。任务可以有两个或多个事务，用户可以选择一个、两个或多个事务（或所有事务）。

但我不知道如何在 jBPM 中实现它......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-30T11:15:50.560

是的，这是可能的。

为什么不。一个过程有两种方式，你不能定义算法方式来选择一种。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-03T06:56:40.730

您必须在任务节点之后使用分叉节点。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-07-26T23:27:31.760

是的，jBPM 中的任务节点可以有多个传出连接，但总的来说，我建议不要将其作为建模最佳实践。原因是通过使用来自一个任务节点的多个传出连接，您隐藏了（在这种情况下是隐式的）网关行为，使其在进程中不可见。

请注意，如果要对任务使用多个传出连接，则必须将 jbpm.enable.multi.con 属性设置为 true，否则引擎会将其标记为无效。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-11-02T09:34:19.967

是的你可以。我们可以利用 jbpm 提供的 FORK-JOIN 功能。您可以使用此链接[https://docs.jboss.org/jbpm/v3/userguide/processmodelling.html](https://docs.jboss.org/jbpm/v3/userguide/processmodelling.html)

# java - Java：如何检查日期是否在一定范围内？

> ID：494180
> 
> 赞同：104
> 
> 时间：2009-01-30T01:31:08.073
> 
> 标签：java, date

我有一系列的开始日期和结束日期。我想检查日期是否在该范围内。

Date.before() 和 Date.after() 似乎使用起来有点尴尬。我真正需要的是这样的伪代码：

```
boolean isWithinRange(Date testDate) {
    return testDate >= startDate && testDate <= endDate;
} 
```

不确定它是否相关，但我从数据库中提取的日期有时间戳。

* * *

## 回答 #1

> 赞同：174
> 
> 时间：2009-01-30T01:38:38.433

```
boolean isWithinRange(Date testDate) {
   return !(testDate.before(startDate) || testDate.after(endDate));
} 
```

对我来说似乎并不尴尬。请注意，我是这样写的，而不是

```
return testDate.after(startDate) && testDate.before(endDate); 
```

所以即使 testDate 完全等于最终情况之一，它也会起作用。

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2016-02-09T19:07:27.273

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2009-01-30T01:40:14.390

这才是正确的方法。日历的工作方式相同。我能给你的最好的（基于你的例子）是这样的：

```
boolean isWithinRange(Date testDate) {
    return testDate.getTime() >= startDate.getTime() &&
             testDate.getTime() <= endDate.getTime();
} 
```

Date.getTime() 返回自 1/1/1970 00:00:00 GMT 以来的毫秒数，并且很长，因此很容易比较。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-01-30T01:45:30.587

考虑使用[Joda Time](http://joda-time.sourceforge.net/quickstart.html)。我喜欢这个库，并希望它能取代现有的 Java Date 和 Calendar 类当前可怕的混乱。这是正确的日期处理。

编辑：现在已经不是 2009 年了，Java 8 已经出现很久了。使用 Java 8 内置的基于 Joda Time 的 java.time 类，正如上面提到的 Basil Bourque。在这种情况下，您将需要 Period 类，这里是[Oracle](http://docs.oracle.com/javase/tutorial/datetime/iso/period.html)关于如何使用它的教程。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-30T01:39:38.883

一种简单的方法是将日期转换为 1970 年 1 月 1 日之后的毫秒数（使用 Date.getTime()），然后比较这些值。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2020-08-02T00:34:58.210

# 自从`Java 8`

注意：除一个之外`Date`的所有构造函数均已弃用。大多数`Date`'s 方法已被弃用。REF：[日期：不推荐使用的方法](https://docs.oracle.com/javase/8/docs/api/java/util/Date.html#i6)。所有，但是`Date::from(Instant)`，静态方法都被弃用了。

因此，由于 java 8 考虑使用`Instant` *（不可变、线程安全、闰秒感知）*类型而不是`Date`. 参考：[即时](https://docs.oracle.com/javase/8/docs/api/java/time/Instant.html)

```
 static final LocalTime MARKETS_OPEN = LocalTime.of(07, 00);
  static final LocalTime MARKETS_CLOSE = LocalTime.of(20, 00);

    // Instant utcTime = testDate.toInstant();
    var bigAppleTime = ZonedDateTime.ofInstant(utcTime, ZoneId.of("America/New_York")); 
```

## 在包含范围内：

```
 return !bigAppleTime.toLocalTime().isBefore(MARKETS_OPEN)
        && !bigAppleTime.toLocalTime().isAfter(MARKETS_CLOSE); 
```

## 在独家范围内：

```
 return bigAppleTime.toLocalTime().isAfter(MARKETS_OPEN)
        && bigAppleTime.toLocalTime().isBefore(MARKETS_CLOSE); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-09-04T22:53:44.650

这对我来说更清楚，

```
// declare calendar outside the scope of isWithinRange() so that we initialize it only once
private Calendar calendar = Calendar.getInstance();

public boolean isWithinRange(Date date, Date startDate, Date endDate) {

    calendar.setTime(startDate);
    int startDayOfYear = calendar.get(Calendar.DAY_OF_YEAR); // first day is 1, last day is 365
    int startYear = calendar.get(Calendar.YEAR);

    calendar.setTime(endDate);
    int endDayOfYear = calendar.get(Calendar.DAY_OF_YEAR);
    int endYear = calendar.get(Calendar.YEAR);

    calendar.setTime(date);
    int dayOfYear = calendar.get(Calendar.DAY_OF_YEAR);
    int year = calendar.get(Calendar.YEAR);

    return (year > startYear && year < endYear) // year is within the range
            || (year == startYear && dayOfYear >= startDayOfYear) // year is same as start year, check day as well
            || (year == endYear && dayOfYear < endDayOfYear); // year is same as end year, check day as well

} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-07-02T14:05:44.197

为了涵盖我的案例-> 我有一个范围开始和结束日期，以及日期列表，可以部分在提供的范围内，也可以完全（重叠）。

包含测试的解决方案：

```
/**
 * Check has any of quote work days in provided range.
 *
 * @param startDate inclusively
 * @param endDate   inclusively
 *
 * @return true if any in provided range inclusively
 */
public boolean hasAnyWorkdaysInRange(LocalDate startDate, LocalDate endDate) {
    if (CollectionUtils.isEmpty(workdays)) {
        return false;
    }

    LocalDate firstWorkDay = getFirstWorkDay().getDate();
    LocalDate lastWorkDay = getLastWorkDay().getDate();

    return (firstWorkDay.isBefore(endDate) || firstWorkDay.equals(endDate))
            && (lastWorkDay.isAfter(startDate) || lastWorkDay.equals(startDate));
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2021-01-08T11:29:18.780

如果您想与`LocalDate`然后使用此代码进行包容性比较。

```
LocalDate from = LocalDate.of(2021,8,1);
LocalDate to = LocalDate.of(2021,8,1);
LocalDate current = LocalDate.of(2021,8,1);

boolean isDateInRage = ( ! (current.isBefore(from.minusDays(1)) && current.isBefore(to.plusDays(1))) ); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-07-07T13:15:15.150

不在乎哪个日期边界是哪个。

```
Math.abs(date1.getTime() - date2.getTime()) == 
    Math.abs(date1.getTime() - dateBetween.getTime()) + Math.abs(dateBetween.getTime() - date2.getTime()); 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-07-25T08:07:25.213

你可以这样使用

```
Interval interval = new Interval(date1.getTime(),date2.getTime());
Interval interval2 = new Interval(date3.getTime(), date4.getTime());
Interval overlap = interval.overlap(interval2);
boolean isOverlap = overlap == null ? false : true 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-06-12T09:19:11.143

```
 public class TestDate {

    public static void main(String[] args) {
    // TODO Auto-generated method stub

    String fromDate = "18-FEB-2018";
    String toDate = "20-FEB-2018";

    String requestDate = "19/02/2018";  
    System.out.println(checkBetween(requestDate,fromDate, toDate));
}

public static boolean checkBetween(String dateToCheck, String startDate, String endDate) {
    boolean res = false;
    SimpleDateFormat fmt1 = new SimpleDateFormat("dd-MMM-yyyy"); //22-05-2013
    SimpleDateFormat fmt2 = new SimpleDateFormat("dd/MM/yyyy"); //22-05-2013
    try {
     Date requestDate = fmt2.parse(dateToCheck);
     Date fromDate = fmt1.parse(startDate);
     Date toDate = fmt1.parse(endDate);
     res = requestDate.compareTo(fromDate) >= 0 && requestDate.compareTo(toDate) <=0;
    }catch(ParseException pex){
        pex.printStackTrace();
    }
    return res;
   }
 } 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2022-01-10T22:08:19.170

如果日期等于开始日期，则添加新解决方案：

```
boolean isWithinRange(Date testDate) {
   return !(testDate.before(startDate) || testDate.after(endDate));
} 
```

解决方案

```
return testDate.equals(startDate) || (testDate.after(startDate) && 
testDate.before(endDate)) || testDate.equals(endDate); 
```

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2017-01-15T13:45:38.757

你的逻辑可以正常工作。正如您提到的，您从数据库中获取的日期在时间戳中，您只需先将时间戳转换为日期，然后使用此逻辑。

也不要忘记检查空日期。

这里 m 分享一点以从时间戳转换为日期。

公共静态日期 convertTimeStamptoDate(String val) 抛出异常 {

```
 DateFormat df = null;
    Date date = null;

    try {
        df = new SimpleDateFormat("yyyy-MM-dd hh:mm:ss");
        date = df.parse(val);
        // System.out.println("Date Converted..");
        return date;
    } catch (Exception ex) {
        System.out.println(ex);
        return convertDate2(val);
    } finally {
        df = null;
        date = null;
    }
} 
```

# c# - 你如何测试采用枚举的方法

> ID：494187
> 
> 赞同：0
> 
> 时间：2009-01-30T01:32:10.503
> 
> 标签：c#, unit-testing, mocking

我已经为此功能设置了测试设置，但我想知道这是否是最好的方法。我有这样的方法：

```
public static string RunTableInfoCommand(IMapinfoWrapper wrapper,
                                         TableInfoEnum infoToReturn)
{
  //pass the int value of infoToReturn to underlying COM object eg wrapper.
} 
```

TableInfoEnum 看起来像这样（缩短版）：

```
public enum TableInfoEnum
{
   TAB_INFO_NAME = 1,
   TAB_INFO_NUM = 2,
   TAB_INFO_TYPE = 3,
   TAB_INFO_NCOLS = 4,
   TAB_INFO_MAPPABLE = 5,
   TAB_INFO_READONLY = 6,
   TAB_INFO_TEMP = 7
 } 
```

当我将枚举传递给 COM 对象时，它将根据枚举值返回不同的字符串结果。例如

```
TAB_INFO_NAME = "Water_Mains"
TAB_INFO_NUM = "1" 
```

COM 对象将始终返回一个字符串，只是基于枚举值的不同值。

我将如何测试我的 RunTableInfoCommand 是否正常工作，到目前为止我有一个这样的测试：

```
public void RunTableInfoCommandPassingTableNumberShouldReturnExpectedName()
{
  string ExpectedCommand = "TableInfo(1,{0})".FormatWith((int)TableInfoEnum.TAB_INFO_NAME);

  mockmapinfo.Expect(m => m.Evaluate(ExpectedCommand))
             .Returns("Water_Mains");

  string name = Table.RunTableInfoCommand(mockmapinfo.Object,
                                                    1,
                                                    TableInfoEnum.TAB_INFO_NAME);

   Assert.AreEqual("Water_Mains", name);
 } 
```

它确实有效，但我只是觉得我错过了一些东西，你如何测试所有不同的枚举类型。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-30T01:53:01.023

如果我理解正确，您的测试方法应该将枚举值传递给 COM 对象并返回 COM 对象返回的字符串。所以测试的目标是确保该方法正确地与 COM 对象对话。

我将模拟 COM 对象以返回每个枚举值的预期字符串，然后将其传递给方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-30T02:24:54.377

好吧，那么也许做一个循环。这将遍历所有枚举并将它们打印出来。如果您希望它完全自动，您必须将所有正确的值放入一个数组中并让计算机进行比较。无论哪种方式，看起来你错过的一个重要部分是一个循环。

```
 public CheckAllEnumValues() {
            // somehow construct mockmapinfo here

            TableInfoEnum[] values = Enum.GetValues(typeof(TableInfoEnum));
            foreach(TableInfoEnum v in values) {
                    string result = RunTableInfoCommand(mockmapinfo.Object, v);
                    Console.WriteLine(Enum.GetName(typeof(TableInfoEnum), v) + ": " + result);
            }
    } 
```

# wpf - 使用自定义扩展名（例如 .custx）编译页面，就像它们是 Visual Studio 中的 .xaml 文件一样

> ID：494205
> 
> 赞同：1
> 
> 时间：2009-01-30T01:40:38.007
> 
> 标签：wpf, visual-studio, xaml, vsx, extensibility

在 VS 包（Visual Studio 可扩展性）中，我使用 XamlLanguageService 注册了一个自定义扩展（例如“.custx”），因此在 Visual Studio 中，当用户打开 .custx 时，它会在 Xaml 设计器/编辑器中打开，就像.xaml 文件。

但是，当我将其编译为“页面”（BuildAction）时，WINFX 目标/编译器会出错并显示以下错误消息。

***MySample\Page1.custx：错误：标记文件无效。指定扩展名为 .xaml 的源标记文件。***

我正在寻找一种解决方案，以便将 .custx 页面编译为页面，就像 WPF 应用程序中的 .xaml 页面一样

任何帮助是极大的赞赏

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T17:37:00.123

我建议简单地重用 XAML 文件扩展名（没有办法在目标中解决此检查）。您是否有理由需要自己的文件扩展名？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-30T16:48:55.097

这个问题的修复非常简单。基本上，我打赌您正在使用自定义构建操作，并使用如下整数设置它：

属性属性 = projectItem.Properties.Item("BuildAction"); 属性.值 = 4; //0-3 是保留的，自定义操作将是 4 或更大。

这些整数值每台机器和每个项目类型都会改变......所以这个错误可能是由 ItemType 设置为 ApplicationDefinition 引起的。

要解决此问题，您需要将 ItemType 设置为您的自定义操作，如下所示：

projectItem.Properties.Item("ItemType").Value = "MyCustomActionName"。

谢谢

——布莱克·涅米斯基

# c# - 如何在运行时在 ASP.NET 中对控件进行排序

> ID：494209
> 
> 赞同：0
> 
> 时间：2009-01-30T01:41:34.933
> 
> 标签：c#, asp.net, vb.net, controls, runtime

例如，如何在 ASP.NET 中在运行时订购控件我的网页中有三个文本框，顺序如下

*   文本框1
*   文本框2
*   文本框3

我希望根据用户偏好更改这些控件的顺序

*   文本框3
*   文本框2
*   文本框1

这只是一个例子，有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-30T07:40:57.453

终于找到了解决办法，我会详细解释

创建一个“面板控件”并将其命名为“myPanel”并放入您想要使用的所有控件

```
<asp:Panel ID="myPanel" runat="server">
        <asp:Panel ID="dock1" runat="server">this is first module</asp:Panel>
        <asp:Panel ID="dock2" runat="server">this is second module</asp:Panel>
        <asp:Panel ID="dock3" runat="server">this is third module</asp:Panel>
</asp:Panel> 
```

输出将如下

这是第一个模块

这是第二个模块

这是第三个模块

所以我应该怎么做才能改变他们的顺序，让我们看看我已经创建了更多三个面板来充当码头的容器我的代码将是这样的

```
<asp:Panel ID="myPanel" runat="server">
        <asp:Panel ID="container1" runat="server"></asp:Panel>
        <asp:Panel ID="container2" runat="server"></asp:Panel>
        <asp:Panel ID="container3" runat="server"></asp:Panel>
        <asp:Panel ID="dock1" runat="server">this is first module</asp:Panel>
        <asp:Panel ID="dock2" runat="server">this is second module</asp:Panel>
        <asp:Panel ID="dock3" runat="server">this is third module</asp:Panel>
</asp:Panel> 
```

在后面的代码中我有这样的东西

这将从 mypanel 中删除 dock1 控件并将其放入 container3

```
 Control myCtrl1 = myPanel.FindControl("dock1");
    Control containerCtrl1 = myPanel.FindControl("container3");
    myCtrl1.Visible = true;
    myPanel.Controls.Remove(myCtrl1);
    containerCtrl1 .Controls.Add(myCtrl1); 
```

您可以根据数据库或 cookie 中的用户偏好来管理这些东西

最好的祝福

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-30T07:15:59.407

jQuery UI 框架可以为您做到这一点。查看此[演示](http://ui.jquery.com/demos/sortable/)和相同的[文档](http://docs.jquery.com/UI/Sortables/sortable)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-30T07:18:37.967

[最简单的方法是使用Telerik](http://www.telerik.com)等第三方控件。更准确地说是 DockZones。
否则，您必须使用此功能创建自己的页面构建器。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-06-24T14:43:06.927

有一个类似的问题并通过使用“.Controls.AddAt”并为您希望它出现的顺序指定一个索引来解决。

所以为了让我的图表首先出现在面板中，我改变了：

```
GraphPanel.Controls.Add(GE.GetChart(t13)); 
```

到：

```
GraphPanel.Controls.AddAt(0, (GE.GetChart(t13))); 
```

并且您以 3、2 然后 1 的顺序对文本框进行排序的示例变为：

```
Panel1.Controls.AddAt(0,(TextBox3));

Panel1.Controls.AddAt(1,(TextBox2));

Panel1.Controls.AddAt(2,(TextBox1)); 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-01-30T02:45:36.830

对于一个非常简单的概念验证，您需要某种后备存储，例如存储 UserID、Ordinal 和 AscxFileName 的数据库表。在 SQL 中，您可以运行如下查询：

```
SELECT AscxFileName FROM tableControls WHERE UserID=@UserID ORDER BY Ordinal 
```

然后使用结果集：

```
while(IDataReader.Read())
{
    Control myControl = Page.LoadControl(IDataReader["AscxFileName"].ToString());
    myPanel.Controls.Add(myControl);
} 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-01-30T03:54:16.600

获取文本框控件的所有 ID 并将它们存储在一个数组中。然后只需进行反向排序：

```
Array.Reverse( mytextboxArray ); 
```

# .net - 加密 .Net 应用程序和程序集

> ID：494211
> 
> 赞同：6
> 
> 时间：2009-01-30T01:43:40.840
> 
> 标签：.net, encryption, dongle

我有一个加密/复制保护问题。

我正在为一家使用加密狗的公司编写应用程序。请不要告诉我软件保护是没有用的，或者我应该让它自由地飞到空中，或者我花在这上面的任何时间都是浪费；这不是关于软件保护有效性的哲学问题，更像是一个方法。

据我了解，破解受加密狗保护的软件的第一步是从代码中删除对加密狗的所有调用（即修补可执行文件）。同样据我了解，我可以在 .NET 中创建“强名称”以保护应用程序和程序集，如[MSDN 文章中所述](http://msdn.microsoft.com/en-us/library/wd40t7ad.aspx)。

强大的命名是否足以确保我的应用程序不容易被修补？还是我需要使用某种加密库？如果我需要使用某个库，是哪一个，或者我可以从哪里获得有关设置它的信息？

当然，下一步是将重要的算法放在加密狗上。我意识到这些只是专用饼干的减速带，但随着我们市场份额的增长，减速带将帮助我们达到不那么敏锐地感受到盗版刺痛的地步（我希望）。

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-30T02:55:14.597

汇编强命名从未设计用于防止控制机器的攻击者。从[延迟签名的 msdn 条目中](http://msdn.microsoft.com/en-us/library/t07a3dye.aspx)：

> 以下示例关闭名为 myAssembly.dll 的程序集的验证。
> 
> `sn –Vr myAssembly.dll`

强名称的设计目标是提供名称唯一性并保护*用户*（而不是发布者）免受攻击。如果用户想要禁用所有强名称检查，或者甚至可能去掉您的签名并用他自己的密钥重新签署程序集，那么从技术上讲，没有什么可以阻止他这样做。

简单地从加密文件加载程序集也不是很有用，因为解密代码本身无法加密，因此很容易成为逆向工程的目标。

正如其他海报所提到的，您正在寻找的是**obfuscation**。您可能已经拥有这样的工具：Visual Studio（至少 2005 和 2008 年）附带 PreEmptive Solutions 的[Dotfuscator 社区版。](http://msdn.microsoft.com/en-us/library/ms227240.aspx)微软也有自己的“[软件许可和保护服务](http://www.microsoft.com/slps/code-protector.aspx)”产品。

然而，混淆有一些技术上的缺点：

*   它可能会使您的构建过程复杂化。您需要一个未混淆和一个混淆构建，因为后者不可调试。
*   我喜欢有一个意外异常的错误对话框，用户可以单击“复制详细信息”并向我发送一封包含一些技术信息的邮件，包括堆栈跟踪。但是，通过混淆，您可以忘记从[Exception.StackTrace](http://msdn.microsoft.com/en-us/library/system.exception.stacktrace.aspx)获取任何有用的信息。
*   如果您的代码使用[反射](http://msdn.microsoft.com/en-us/library/system.reflection.aspx)，那么很可能会在混淆构建中中断，因为内部类型和成员名称没有保留。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-30T02:04:33.233

签署您的程序集将无法在不更改签名的情况下对其进行更改，从而更改其引用。这样做的结果是对程序集的（强命名）引用将无法针对更改的版本进行解析。这可以保证不会出现荒谬的赔率。

但是，这并不能解决您的问题。反正也不完全。例如，如果您将加密狗调用打包到一个强命名的程序集中，然后从您的应用程序中引用该程序集，那么如果没有您未更改的程序集，应用程序将无法运行，因此没有加密狗也无法运行。但是应用程序本身可以更改！

您可以使用的另一种方法是混淆。Visual Studio 附带了一个免费版本的混淆器，可以升级到工业级。混淆使代码在不改变其行为的情况下难以理解，因此对逆向工程构成了真正的障碍。

我想说解决方案在于这两种技术的巧妙结合。

恐怕这就是我的知识范围。其他人将不得不在这里提供实际答案（而且它可能比我的要短得多令人尴尬;-)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-30T02:06:16.770

如果他们正在修补您的可执行文件，则强名称无济于事。但是，它将帮助您确保您引用的 dll 是正确的版本并且没有被篡改。
您可能会检查 [Salamander](http://www.remotesoft.com/salamander/obfuscator.html)或[抢占式](http://www.preemptive.com/dotfuscator.html)混淆。
您可能会看到的加密[Assembly Lockbox](http://alb.gibwo.com/dnn/)、[CodeVeil](http://www.xheo.com/products/sps/default.aspx)或[ThinApp](http://www.thinstall.com/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-25T04:19:42.853

如果您想使用加密狗并加密您的程序，这篇文章可能对您有用： http: [//www.gironsec.com/blog/2012/02/dongles-how-do-they-work/](http://www.gironsec.com/blog/2012/02/dongles-how-do-they-work/)

这是那篇文章的相关引述：

> 有两种方法可以实现加密狗。正确的方式和错误的方式。正确的方法是加密您的程序并将加密密钥存储在加密狗上，并在运行时根据设备是否连接进行解密。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-05-09T05:34:15.623

在某种程度上，混淆可能对您有用。但这不是 100% 安全的方式。事实上，没有任何 100% 安全的方法来保护任何软件模块。在最好的情况下，混淆只会使对程序进行逆向工程变得很耗时。.NET Reflector 是一种逆向工程工具，可从任何 .NET 程序集重新生成源代码。使用 Dotfuscator 将使入侵者难以理解原始源代码，但如果奖励很大，则可以努力对该源代码进行良好的估计。

# c# - 您如何确定两个 HashSet 是否相等（按值，而不是按引用）？

> ID：494224
> 
> 赞同：69
> 
> 时间：2009-01-30T01:49:21.860
> 
> 标签：c#, .net, .net-3.5, set, hashset

我试图确定`HashSet`.NET 3.5 (C#) 中的两个对象是否是相等的集合，*即*包含相同的值。这似乎是一个显然想要做的事情，但所提供的功能似乎都没有为您提供这些信息。

我能想到的方法是检查两组的计数是否相等*，并且*一组是另一组的子集（不正确）。我认为可能发生的唯一方法是它们是相等的集合。示例代码：

```
HashSet<int> set1 = new HashSet<int>();
set1.Add(1);
set1.Add(2);
set1.Add(3);

HashSet<int> set2 = new HashSet<int>();
set2.Add(1);
set2.Add(2);
set2.Add(3);

if(set1.Count == set2.Count && set1.IsSubsetOf(set2))
{
    // do something
} 
```

这会一直有效吗？有没有更好的办法？为什么没有`HashSet`功能 `public bool IsEqualSetWith()`？

* * *

## 回答 #1

> 赞同：121
> 
> 时间：2009-01-30T01:56:06.073

查看方法[SetEquals](https://msdn.microsoft.com/en-us/library/dd412096(v=vs.110).aspx)。

```
my_hashset.SetEquals(other); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-04-24T07:15:13.280

```
IEqualityComparer<HashSet<int>> comp = HashSet<int>.CreateSetComparer();
Console.WriteLine("CreateSetComparer set1 == set2 : {0}", comp.Equals(set1, set2));
// or
bool areEqual = HashSet<int>.CreateSetComparer().Equals(set1, set2); 
```

# javascript - 您如何确定 Javascript 中的媒体类型？

> ID：494235
> 
> 赞同：15
> 
> 时间：2009-01-30T01:53:06.390
> 
> 标签：javascript, stylesheet, media, styles, javascript-framework

我环顾四周，还没有看到这个问题。

**Javascript 中确定页面媒体类型（例如屏幕、打印、手持设备）的可靠方法是什么？**我看过对 的引用`document.styleSheets[0].media`，但我没有运气使用它，要么是因为浏览器支持问题，要么是因为我不理解某些东西。

我问是因为我希望 Javascript 在屏幕视图中隐藏某些内容，而不是在打印视图中。不能依赖媒体相关的样式来执行此操作，因为我正在使用 Prototype 为元素运行切换开关，如果元素被声明为不可见（`display: none`）， Prototype 将不允许将其切换为可见-内联 CSS*。我试图为元素 ( `<div style="@media print { foo: bar; } @media screen { blargh: bfargle; }">`) 设置特定于媒体的内联样式，但据我所知，这不受支持。

我知道我可以循环浏览样式表并检查特定于打印的链接样式表是否处于活动状态，但我目前处于各种特定媒体样式声明都混合在单个链接样式表中的情况，所以这不好。是的，我可以将样式表拆分为不同的媒体类型，但我首先想弄清楚我是否可以使用 Javascript 可靠地将媒体类型从 DOM 中拉出，**完全独立于 CSS**。哦，我已经尝试过“隐藏打印视图的元素，然后检查它是否在 Javascript 中可见”的技巧，但那*尽管*这些元素*是不*可见的。如果有人想了解我在这里谈论的更多细节，我可以在编辑中详细说明。

*这是我不理解并且经常被激怒的东西。任何可以提供任何见解的人都会得到我的大力支持。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-31T01:21:44.287

> `display: none`[..]，如果使用非内联 CSS将元素声明为不可见（），Prototype 将不允许将元素切换为可见。这是我一直不理解并且经常被激怒的东西。任何可以提供任何见解的人都会得到我的大力支持。

您可能已经看到了这一点，但是 eg 的文档[`show`](http://www.prototypejs.org/api/element/show)（还有其他具有相同注释的相关函数）指出：

> `Element.show` *无法*显示通过 CSS 样式表隐藏的元素。请注意，这不是原型限制，而是 CSS`display`属性如何工作的结果。

所以，这是一个已知的问题，他们责怪 CSS。但是，请考虑以下文档（我之前没有使用过 Prototype，所以我不确定这是否是等待 DOM 加载的推荐方式，但它似乎有效）：

```
<!doctype html>
<script src="prototype.js"></script>
<script>
document.observe("dom:loaded", function() {
  $("victim").show();
});
</script>
<style>
p#victim {display:none;}
</style>
<p id="victim">Hello world! 
```

正如您已经知道的那样，这是行不通的。为什么？`display`好吧，当您告诉自己时，Prototype 怎么知道将属性`p#victim`“重置”`show`为什么？（换句话说：`display`如果`display: none`没有在规则集中使用`p#victim`选择器，它如何找出应该是什么值。）答案很简单：它不能。（想一想。如果另一个规则集使用选择器修改我们的规则集中不存在的值怎么`display`办？（即我们不能假设 eg always 应该设置为，其他规则集可能已更改该值。）我们无法删除`display: none``p#victim``p``block``display`样式表中规则集的属性，我们不能删除元素和规则集之间的整个连接，因为它可能包含其他属性等等（即使有可能，恕我直言，不明显找到*使用哪个*规则集执行此操作）。当然，我们可以继续这样做，但是 afaik 这个问题没有已知的解决方案。）

那么为什么内联替代方案有效呢？首先，让我们看看是如何`show`实现的：

```
show: function(element) {
  element = $(element);
  element.style.display = ''; // <-- the important line
  return element;
} 
```

这个函数唯一重要的事情就是设置`element.style.display`一个空字符串 ( `''`)，它`display`从`style`. 伟大的！但是，这是什么意思？为什么我们要删除它？！首先，我们必须找出`element.style`当我们修改它的值时实际代表和修改了什么。

MDC 文档[`element.style`](https://developer.mozilla.org/en/DOM/element.style)说明：

> 返回一个表示元素`style`属性的对象。

注意最后一个词：*属性*。`element.style`≠ 元素的当前“计算”样式，它只是属性中的`style`属性列表（请参阅 MDC 以获得更长/更好的解释）。

考虑以下文档：

```
<!doctype html>
<script src="prototype.js"></script>
<script>
document.observe("dom:loaded", function() {
  $("victim").show();
});
</script>
<p id="victim" style="display:none;">Hello world! 
```

`style="display:none;"`隐藏`p#victim`，但是当 DOM 完成加载时，Prototype 会将其更改为`style=""`，并且浏览器将重新计算该`display`属性的值（在这种情况下，该值来自浏览器的默认样式表）。

*但是*，请考虑以下文档：

```
<!doctype html>
<script src="jquery.js"></script>
<script>
$(document).ready(function(){
  $("#victim").show();
});
</script>
<style>
p#victim {display:none;}
</style>
<p id="victim">Hello world! 
```

jQuery 正确地处理样式表的东西，在这种情况下无论如何！这不像 Prototype 解决方案那样容易解释，而且我现在需要阅读许多令人敬畏的层面，并且在很多情况下 jQuery 无法计算出正确的`display`. （最后一个提示：Firebug ...，但我猜它使用了一些 Firefox 独有的东西或其他东西。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-30T10:56:04.907

编辑：对不起（自我说明：RTFQ Rob，哎呀！）。一个快速的谷歌搜索[把它](http://www.ibloomstudios.com/articles/css_media_targeted_javascript/)和一个[jquery 插件](http://code.google.com/p/jmediatype/)（如果有的话）搞定了。据我所知，它基本上使用@media 规则，但不是内联的，因此您的浏览器支持可能会有所不同，但这是您希望的最好的我认为:(

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-30T19:05:35.340

看看这是否有效......我认为您可以对每种类型执行此操作，只需检查语句是否返回 null 或等效项，然后应用您的规则。

从这个网站：**[http ://www.webdeveloper.com/forum/showthread.php?t=82453](http://www.webdeveloper.com/forum/showthread.php?t=82453)**

> IE：
> 
> `if (document.styleSheets[0].media == 'screen'){...}`
> 
> FF/NS：
> 
> `document.getElementsByTagName ('LINK')[0].getAttribute ('media')`
> 
> 或者
> 
> `document.styleSheets[0].media.mediaText`

和一个在所有浏览器中检查它的脚本（除了一些新浏览器，所以要小心:)）

**[http://student.agh.edu.pl/~marcinw/cssmedia/](http://student.agh.edu.pl/%7Emarcinw/cssmedia/)**

此脚本在 if 语句中作为布尔值 true/false 工作！希望你能得到它的工作！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-30T02:02:55.623

```
document.getElementsByTagName('link').each(function( link )
{
  //do something with link.media
  //hide whatever you need to hide, etc
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-01T10:43:17.730

我已经测试了上面提到的脚本 - 它现在适用于所有新浏览器，包括。IE8 决赛。

脚本移至此处：[http](http://cssmedia.pemor.pl/) ://cssmedia.pemor.pl/ 如果您愿意，请随意使用它。

关于 Marcin Wiazowski

# audio - SoundEngine 点击声音

> ID：494242
> 
> 赞同：0
> 
> 时间：2009-01-30T01:57:47.443
> 
> 标签：audio

我正在使用 CrashLanding 的 SoundEngine 来播放一些声音。

每个声音有 1 秒，在单击按钮时播放。

如果您只单击一个按钮，一切都很好。但是，如果您在第一个声音已经播放时再次单击该按钮，您会听到咔嗒声。

如何解决？

我看到苹果从他们的网站上撤下了 CrashLanding。我读到他们认为 SoundEngine 在某些情况下是不稳定的。

无论如何，它对我来说工作得很好，除了这个烦人的咔嗒声。

有没有办法解决这个问题？顺便说一句，使用 OpenAL 的 SoundEngine 的替代方法是什么？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-16T10:44:21.473

我对 SoundEngine 并不完全熟悉，但是一些一般性的建议可以在这里提供帮助。我怀疑从同一个缓冲区播放相同的声音是一个问题，因为 SoundEngine 可以在不关闭它的情况下将其倒回开始 - 因此会发出“咔哒”声。

1.  在重新开始播放之前停止声音。
2.  对不同的声音实例使用不同的播放缓冲区。

# popup - 如何在 YUI 中显示来自外部文件的弹出窗口？

> ID：494249
> 
> 赞同：1
> 
> 时间：2009-01-30T02:02:50.317
> 
> 标签：popup, yui, containers

我开始在我的应用程序中使用[YUI](http://developer.yahoo.com/yui)的[Container 控件](http://developer.yahoo.com/yui/examples/container/)来显示消息框弹出窗口和其他对话框。

我不清楚创建源自外部 HTML 文件的弹出窗口的推荐/最干净的方法是什么。我说的是一个弹出窗口，显示有关产品的“更多信息”——其中包含文本和图像。

我想做的最接近的[例子是“](http://developer.yahoo.com/yui/examples/container/)[创建模型加载对话框](http://developer.yahoo.com/yui/examples/container/panel-loading.html)”。这会在异步加载外部数据时显示请稍候图形，但在完成后，该数据将显示在页面正文中，而不是在弹出窗口中。

现在我知道我可以使用这个示例来显示“请稍候”对话框，并在完成时显示**另一个**带有返回数据的弹出窗口。

但是我希望有内置功能可以将外部文件加载到弹出窗口中，因为：

> a) 我要做的代码和事件处理会更少
> 
> b）弹出窗口将包含图像，我希望请等待留在屏幕上，直到其中的所有图像都已加载。自己做会更棘手

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-30T02:55:48.683

西蒙，

YUI 容器（面板、对话框、SimpleDialogs）没有加载外部数据的工具。

您可以使用您描述的工作流程（将数据放在新面板中），或者，一旦您通过连接管理器（[http://developer.yahoo.com/yui/connection/](http://developer.yahoo.com/yui/connection/)）获得外部/XHR 数据，插入它进入现有“请稍候”面板的正文，然后调整大小/重新居中。正如您所建议的，后者会更有效，因为您不必创建第二个面板。

使用 setBody 方法将新内容添加到 Panel 的正文 ( [http://developer.yahoo.com/yui/docs/YAHOO.widget.Module.html#method_setBody](http://developer.yahoo.com/yui/docs/YAHOO.widget.Module.html#method_setBody) )。

-埃里克

# flash - Director 11 和 Flash 与 AS 2 通信

> ID：494250
> 
> 赞同：0
> 
> 时间：2009-01-30T02:02:51.113
> 
> 标签：flash, actionscript-2, lingo, adobe-director

我有一个包含 3 个脚本（2 个行为和 1 个电影脚本）的 Director 项目。我的电影脚本中有以下代码：

```
on startRecording ()
  --do stuff
  _movie.script["script2"].passGrade(75, 3, 4)
end 
```

在我的一个行为脚本中，我有以下内容：

```
on passGrade (acc, dur, tim)
  member("Assessment", "Assessment").displayGrade(acc, dur, tim)
end passGrade 
```

其中第二个行为脚本的名称是`script2`，并且舞台上有一个 Flash 对象被调用`Assessment`，该对象具有一个被调用的 ActionScript 方法`displayGrade`，该方法以 3 个数字作为输入。

我有 2 个问题。首先，电话`-movie.script["script2"].passGrade(75, 3, 4)`不起作用，我不知道为什么。我不允许从电影剧本调用行为吗？还是我没有正确执行此操作？第二个问题是如何调用 ActionScript 方法？该脚本被定义为 Flash 对象的一种行为，称为`Assessment`，但 Director 似乎无法找到该方法。

我将 Director 11 与 HotFix 3 一起使用，并且 Flash 对象是为 ActionScript 2 编译的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-11-10T18:25:20.467

调用行为脚本的语法应该是：

script("script2").passGrade(75, 3, 4)

或者，您可以将您的行为附加到 flash sprite（舞台上 flash 的实例），并将调用发送到 sprite：

sendSprite (flashSpriteNumOrNameOrRef, #passGrade, 75, 3, 4)

关于调用 flash sprite 中的函数，您或多或少做相同的事情，但是您将调用发送到 flash sprite，而不是成员：

sprite(flashSpriteNumOrNameOrRef).displayGrade(acc, dur, tim)

如果行为附加到精灵： sprite(me.spriteNum).displayGrade(acc, dur, tim)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-16T11:01:42.590

电影脚本不能调用行为脚本，因为行为脚本可以附加到多个对象，然后呢？

电影剧本是“静态的”，而行为是“动态的”。您应该通过 Flash 对象实例/精灵引用行为函数。

# c# - 创建 AJAX 脚本控件

> ID：494260
> 
> 赞同：1
> 
> 时间：2009-01-30T02:06:21.730
> 
> 标签：c#, asp.net, ajax, scriptcontrol

叫我“n00b”，但我是创建脚本控件的新手。我想创建一个带有 3 个文本框的简单控件。我有一个如下所示的 .cs 文件：

```
 public class SmokingCalc : ScriptControl
    {
        public SmokingCalc()
        {
            Render(htmlWriter);
        }
        protected override void Render(HtmlTextWriter writer)
        {
            costTextbox.RenderControl(writer);
            base.Render(writer);
        }
        protected override IEnumerable<ScriptDescriptor>
                GetScriptDescriptors()
        {
            ScriptControlDescriptor descriptor = new ScriptControlDescriptor("SmokingCalc.SmokingCalc", this.ClientID);
            yield return descriptor;
        }

        // Generate the script reference
        protected override IEnumerable<ScriptReference>
                GetScriptReferences()
        {
            yield return new ScriptReference("SmokingCalc.SmokingCalc.js", this.GetType().Assembly.FullName);
        }

        protected HtmlTextWriter htmlWriter;
        protected TextBox costTextbox;
        protected TextBox amountTextbox;
        protected TextBox yearsTextbox;
        protected Button submitButton;
    }
} 
```

我完全不知道为什么文本框不会呈现？我想我错过了一些东西......

[编辑] 我得到的错误是“对象引用未设置为对象的实例”。

[已回答] 我按如下方式更改了文件，并且至少到目前为止它可以工作。

```
 public class SmokingCalc : ScriptControl
    {
        public SmokingCalc()
        {
        }
        protected override void CreateChildControls()
        {
            base.CreateChildControls();
            costTextbox.ID = "costTextbox";
            amountTextbox.ID = "amountTextbox";
            yearsTextbox.ID = "yearsTextbox";
            submitButton.ID = "submitButton";
            submitButton.Text = "Submit";
            Controls.Add(costTextbox);
            Controls.Add(amountTextbox);
            Controls.Add(yearsTextbox);
            Controls.Add(submitButton);
        }
        protected override IEnumerable<ScriptDescriptor>
                GetScriptDescriptors()
        {
            ScriptControlDescriptor descriptor = new ScriptControlDescriptor("SmokingCalc.SmokingCalc", this.ClientID);
            descriptor.AddProperty("costTextboxID", costTextbox.ClientID);
            descriptor.AddProperty("amountTextboxID", amountTextbox.ClientID);
            descriptor.AddProperty("yearsTextboxID", amountTextbox.ClientID);
            descriptor.AddProperty("submitButtonID", submitButton.ClientID);
            yield return descriptor;
        }

        // Generate the script reference
        protected override IEnumerable<ScriptReference>
                GetScriptReferences()
        {
            yield return new ScriptReference("SmokingCalc.SmokingCalc.js", this.GetType().Assembly.FullName);
        }

        protected TextBox costTextbox = new TextBox();
        protected TextBox amountTextbox = new TextBox();
        protected TextBox yearsTextbox = new TextBox();
        protected Button submitButton = new Button();
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-30T02:14:20.000

你试过[`CreateChildControls`](http://msdn.microsoft.com/en-us/library/system.web.ui.control.createchildcontrols.aspx)吗？：

```
public class SmokingCalc : ScriptControl
{
    protected override void CreateChildControls()
    {
        this.Controls.Add(costTextbox);
    }

    protected override IEnumerable<ScriptDescriptor>
            GetScriptDescriptors()
    {
        ScriptControlDescriptor descriptor = new ScriptControlDescriptor("SmokingCalc.SmokingCalc", this.ClientID);
        yield return descriptor;
    }

    // Generate the script reference
    protected override IEnumerable<ScriptReference>
            GetScriptReferences()
    {
        yield return new ScriptReference("SmokingCalc.SmokingCalc.js", this.GetType().Assembly.FullName);
    }

    protected HtmlTextWriter htmlWriter;
    protected TextBox costTextbox = new TextBox();
    protected TextBox amountTextbox = new TextBox();
    protected TextBox yearsTextbox = new TextBox();
    protected Button submitButton = new Button();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-30T06:07:46.313

您在这里所做的是构建复合控件，而不是脚本控件本身。您真正想要做的是从[CompositeControl](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.compositecontrol.aspx)继承（[并遵循创建复合控件的模型](http://msdn.microsoft.com/en-us/library/3257x3ea.aspx)），并改为实现[IScriptControl 。](http://msdn.microsoft.com/en-us/library/system.web.ui.iscriptcontrol.aspx)您要求以自己的方式进行很多胃灼热（ViewState 和回发问题等）。

# c# - C# 情绪分析

> ID：494276
> 
> 赞同：5
> 
> 时间：2009-01-30T02:15:21.260
> 
> 标签：c#, text-mining

有谁知道（最好是开源的）C# 库，可以用来计算某些给定文本的整体情绪？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-03-07T05:00:49.823

[在https://github.com/amrishdeep/Dragon](https://github.com/amrishdeep/Dragon)了解基于朴素贝叶斯分类的开源情感分析引擎。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-30T02:20:52.280

[http://rapid-i.com/content/view/26/84/](http://rapid-i.com/content/view/26/84/)

也许不是 c#，但我想你可以从 c# 调用它，它会为你完成这项工作吗？

# multithreading - CreateRemoteThread 32->64 和/或 64->32

> ID：494284
> 
> 赞同：4
> 
> 时间：2009-01-30T02:22:04.663
> 
> 标签：multithreading, winapi

我需要一种将 x64 窗口中的 CreateRemoteThread 转换为 64 位和 32 位进程的方法。我已经弄清楚了如何找到目标进程的指令集，如何在目标进程中为装配雪橇分配内存，并且我几乎已经弄清楚了如何处理地址空间随机化。

当它的指令集错误时，我不知道如何在远程进程上实际启动线程。

注意：我不在乎你解决了两个问题中的哪一个。我自己的 exe 可以是 32 位或 64 位（但在我知道目标进程的位数之前，我确实必须做出选择）。

在有人抱怨我真的不应该这样做之前，问问微软为什么我必须先设置`FILE_SHARE_DELETE`所有打开的句柄，然后才能删除正在使用的文件。不，也没有办法删除其他进程打开的文件。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-04T20:17:14.240

CreateRemoteThread 32->64 不起作用。

CreateRemoteThread 64->32 有效。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-28T20:39:09.360

以下源代码执行正常以及 X86->X64 和 X64->X86 注入，具有您需要的所有详细信息：[https ://dev.metasploit.com/redmine/projects/framework/repository/revisions/master /entry/external/source/meterpreter/source/common/arch/win/i386/base_inject.c](https://dev.metasploit.com/redmine/projects/framework/repository/revisions/master/entry/external/source/meterpreter/source/common/arch/win/i386/base_inject.c)

简而言之，它涉及许多特定于体系结构的“未记录”功能，因为您必须在 32 位 WoW 进程中执行 64 位代码才能执行 X86-X64。

但该代码在许多版本的 Windows 中运行良好。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-30T02:42:26.807

作为您陈述的问题的解决方法，如果您需要删除其他进程正在使用的文件，并且其他进程没有为 FILE_SHARE_DELETE 打开它们，您可以并且可能应该使用操作系统提供的重启时延迟删除功能。与使用线程注入修改外部进程中的现有文件句柄相比，它的潜在危险可能要小得多，更不用说可能需要更少的特权。只是一个想法。

如果您设置了远程线程注入，请参阅[MSDN 页面](http://msdn.microsoft.com/en-us/library/ms682437.aspx)上的解决方法；也许那里有一些灵感。您也可以考虑只暴力杀死其他进程（最好首先，必要时强制执行），因为无论如何您都需要管理员访问权限，并且使用它们的内部句柄进行处理可能不会使它们处于良好状态。当安装程序需要在不重新启动的情况下替换打开的文件时，这就是安装程序所做的（或要求用户做的）。

# c# - 为什么在 C# 中将鼠标悬停在 const 变量上时，Visual Studio 2008 不显示它们的值？

> ID：494294
> 
> 赞同：7
> 
> 时间：2009-01-30T02:28:09.767
> 
> 标签：c#, vb.net, visual-studio-2008, debugging

我的问题标题说明了一切。这非常令人沮丧，尤其是在处理大量类似常量时。它适用于 Visual Basic 项目，但不适用于 Visual C#。

一般来说，为什么不同语言的 IDE 看起来如此不同（例如，VB 中的超级智能 Intellisense 而在 C# 中却没有）？对我来说，让两个不同的团队为两种主要的 .NET 语言开发 IDE 对微软来说是没有意义的......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-03T09:23:55.747

你的意思是常数（`const`）？或只读变量？

另外-如果您无法从名称中分辨出该值代表什么，那么您的命名不正确；大多数时候你不需要仔细检查a的实际*值*`const`，因为它不会经常改变；-p

如果你的意思是`const`- 那么根据定义，该值就在它旁边......但即便如此，*当调试*悬停时对我来说效果很好（如果你愿意，我可以发布截图）。不调试时悬停不起作用 - 它仅在调试时显示悬停中的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-23T09:51:52.007

我使用的解决方法：

```
/// <summary>
/// const string (Checkpoint group found.)
/// </summary>
private const string DefaultMessage = "Checkpoint group found."; 
```

# php - 登录脚本问题，它不显示“已登录”

> ID：494297
> 
> 赞同：2
> 
> 时间：2009-01-30T02:31:13.910
> 
> 标签：php

```
if (isset($_POST['login'])) {
$query = mysql_query("
          SELECT id FROM users 
          WHERE username = '".mysql_real_escape_string($_POST['username'])."' 
      AND password = '".mysql_real_escape_string($_POST['password'])."'
");

/* wrong login information? output a message and terminate the script */
if (!mysql_num_rows($query)){
header("Location: error.php");
exit();
}

/* set session with unique index */
$_SESSION['id'] = mysql_result($query, 0, 'id');
mysql_query("UPDATE users SET last_login = NOW(), last_ip = '".$_SERVER['REMOTE_ADDR']."' WHERE id = '{$_SESSION['id']}'");
header("Location: success.php");
exit;
}

/* destroy session */
if (isset($_GET['logout'])){
mysql_query("UPDATE users SET online = '0' WHERE id = '{$_SESSION['id']}'");
session_unset();
session_destroy();
header("Location: index.php");
exit;
} 
```

它有效，它确实让我在正确的信息上成功了 PHP，但这是我想要做的：

```
if (!$_SESSION['id']) { 
    <form method="post" action="./"><p>
     Username: <br />
     <input type="text" name="username" size="22" maxlength="30" />
     <br />
     Password: <br />
     <input type="password" name="password" size="22" maxlength="20" />
     <br />
     <input class="button" type="submit" name="login" value="Login" />
     </form>
    } else { echo "Logged in"; } 
```

它没有显示“登录”，我已经打印了 $_SESSION['id'] 但什么也没有。这一切都在 index.php 中。可能是什么问题？不要担心没有哈希，稍后会修复它

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-30T02:40:34.127

你确定叫[session_start 了](http://uk.php.net/manual/en/session.examples.basic.php)吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-30T02:38:12.913

你还记得调用`session_start()`每个需要访问的 PHP 页面`$_SESSION`吗？

# linq - Linq - 将 IQueryable 转换为 IList 返回 null - 为什么？

> ID：494302
> 
> 赞同：2
> 
> 时间：2009-01-30T02:34:13.953
> 
> 标签：linq, generics, interface

我必须在这里遗漏一些明显的东西。我不明白为什么这种 linq 查询结果的转换返回 null 而不是我请求的类型列表。

```
IList<IMyDataInterface> list = query.ToList() as IList<IMyDataInterface>; 
```

运行它的完整代码如下。这是我需要弥合的知识鸿沟。我已经尝试了各种类型的演员阵容来让它发挥作用。我没有例外，只是一个空值。值得注意的是，Linq 查询正在将其结果选择到我的自定义“MyDataClass”实例中，该实例实现了 IMyDataInterface

```
class Program
{
    static void Main(string[] args)
    {
        IMyFunctionalInterface myObject = new MyClass();

        //myObject.Get() returns null for some reason...
        IList<IMyDataInterface> list = myObject.Get();

        Debug.Assert(list != null, "Cast List is null");
    }
}

public interface IMyFunctionalInterface
{
    IList<IMyDataInterface> Get();
}

public class MyClass : IMyFunctionalInterface
{
    public IList<IMyDataInterface> Get()
    {
        string[] names = { "Tom", "Dick", "Harry", "Mary", "Jay" };

        var query = from n in names
                    where n.Contains("a")
                    select new MyDataClass
                    {
                        Name = n.ToString()
                    };

        //There IS data in the query result
        Debug.Assert(query != null, "result is null");
        //but the cast here makes it return null
        IList<IMyDataInterface> list = query.ToList() as IList<IMyDataInterface>;

        return list;
    }

}
public interface IMyDataInterface
{
    string Name { get; set; }
}

public class MyDataClass : IMyDataInterface
{
    public string Name { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-30T02:53:04.100

这里的问题是**协方差**之一。

首先，你的例子有点太复杂了。我去掉了一些绒毛。此外，我还添加了一些说明问题的诊断程序。

```
class Program
{
    static void Main(string[] args)
    {
        var names = new[] { "Tom", "Dick", "Harry", "Mary", "Jay" };

        var query = from n in names
                    select new C
                    {
                        S = n
                    };

        //There IS data in the query result
        Debug.Assert(query != null, "result is null");

        //but the conversion here makes it return null
        var list = query.ToList() as IList<I>;
        Console.WriteLine(query.ToList().GetType());

        // this assert fires.
        Debug.Assert(list != null, "Cast List is null");
    }
}

interface I
{
    string S { get; set; }
}

class C : I
{
    public string S { get; set; }
} 
```

这个程序的输出是：

```
System.Collections.Generic.List`1[C]

```

请注意，我们正在尝试将 a 强制转换为`List<C>`在`List<I>`C# 3.0 中不起作用的。

在 C# 4.0 中，您应该能够做到这一点，这要归功于泛型接口上类型参数的新协变和反变。

此外，您最初提出`IQueryable`的问题与此处无关：您提供的查询表达式创建了一个`IEnumerable<string>`not an `IQueryable<string>`。

**编辑**：我想指出，您使用`as`运算符的“强制转换”在技术上不是强制转换，而是“类型转换”。如果你使用了演员表，你会得到一个包含有用信息的异常。如果我改为：

```
 var list = (IList<I>)query.ToList(); 
```

我得到一个`InvalidCastException`：

```
附加信息：无法转换类型为“System.Collections.Generic.List 1[C]' to type 'System.Collections.Generic.IList1[I]”的对象。

```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-30T02:48:49.990

试试这个：

```
var query = from n in names
            where n.Contains("a")
            select new MyDataClass
            {
              Name = n.ToString()
            } as IMyDataInterface; 
```

您的问题出在这一行：

```
IList<IMyDataInterface> list = query.ToList() as IList<IMyDataInterface>; 
```

这也可以写成：

```
List<MyDataClass> tmp = query.ToList();
IList<IMyDataInterface> list = tmp as IList<IMyDataInterface>; 
```

不幸的是，在 C# 中，`as`运算符不能按您希望的方式工作。运算符只是将`as`列表对象转换为不同类型的列表；它不会尝试遍历列表并投射每个项目。要将列表转换为其他内容，您需要对其调用 Cast 扩展方法。例如：

```
IList<IMyDataInterface> list = query.ToList().Cast<IMyDataInterface>(); 
```

因此，您的选择是：将查询中的任何项目转换为您想要的界面（我的第一个示例）或在执行查询后转换整个列表（我的第二个示例）。

我建议前者。

# jquery - JQuery 在单击时刷新数据库结果

> ID：494303
> 
> 赞同：1
> 
> 时间：2009-01-30T02:34:25.387
> 
> 标签：jquery

我在 JQuery 中有这段代码：

```
$().ready(function() {
{exp:weblog:entries weblog="locations" show_expired="yes" show_future_entries="yes" orderby="date" sort="desc" limit="5" rdf="off" disable="member_data|trackbacks" status="open|featured|ongoing"}
$('a.Favorites_Trigger_{entry_id}') .click (function() {
$.get(this.href, function(data) {
$('span.favoritesspan_{entry_id}').html(data);
$('dl.favoritesul > dd.entry_{entry_id}').replaceAll('dl.favoritesul > dd.entry_{entry_id}');
});
return false;
}); 
```

我正在尝试做的事情：单击链接时，它当前会更新页面主要部分中的数据库（称为widget.php），现在widget.php也有一个侧栏，我想在其中显示新的结果刚刚发生的触发事件。我点击一个链接说添加或删除这个收藏夹。它基本上是一个“我最喜欢的”php 模块，但是一旦发生数据库更改，一旦单击链接，我似乎无法获得更新的结果，我在硬刷新浏览器时看到了这一点。那么是否有可能让那部分刷新 JQuery 样式？

* * *

感谢苏维特的回答。它实际上是针对表达式引擎模块的，它通过单击文件一和文件二调用添加/删除函数，并在文件二中添加或删除函数。侧栏正在拉出结果，我将把那个文件称为三。谢谢参观。

代码如下：

档案一：

```
{if logged_in}
{exp:favorites:saved entry_id="{entry_id}"}
{if saved}
<span class="favoritesspan_{entry_id}"><em>Saved as a favorite.</em>&nbsp;<a class="Favorites_Trigger_{entry_id}" href="{path='features/favorite-add/'}{entry_id}/delete">Remove from favorites list?</a></span>
{/if}
{if not_saved}
<span class="favoritesspan_{entry_id}"><a class="Favorites_Trigger_{entry_id}" href="{path='features/favorite-add/'}{entry_id}/add">Add this item to your favorites?</a></span>
{/if}
{/exp:favorites:saved}
{/if} 
```

文件二：（处理器）

```
{exp:favorites:save weblog="funxyz"} 
```

文件三：

```
 <dl class="favoritesul">
    {exp:favorites:entries weblog="funxyz" show_expired="yes" show_future_entries="yes" dynamic="off" status="open|featured|ongoing"}
<dd class="entry_{entry_id}">{title}</dd>
{/exp:favorites:entries}
    </dl> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-30T03:18:30.807

您的条目 ID 可能无法按您预期的方式工作，因为您使用的模板标签在发送到客户端之前已在服务器上呈现。这意味着如果您在浏览器中查看源代码，您生成的 JQuery 代码将有一个硬编码值来代替您正在使用的 {entry_id} 标记。这意味着，从理论上讲，JQuery 代码仅适用于第一个或最后一个条目，具体取决于模板的处理方式。

您需要做的是让您的 JQuery 代码更通用。只需让它刷新数据库中的列表，例如，`a.favourites_trigger`单击任何调用的内容。

如果您可以发布一个工作示例，它可能会使事情变得更容易。

# javascript - 是否有任何站点/服务/脚本可以逆转 JS 缩小？

> ID：494314
> 
> 赞同：1
> 
> 时间：2009-01-30T02:41:47.573
> 
> 标签：javascript, minify

我正在寻找一种方法来输入一个缩小的 JavaScript 文件并最终得到一些可读的东西。我知道它不会有原始变量，它们都是单个字母，但至少它会有换行符和可能的制表符。

外面有什么吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-30T02:47:02.460

见[http://elfz.laacz.lv/beautify/](http://elfz.laacz.lv/beautify/)。它会很好地缩进和分隔代码中的所有内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-03-11T22:09:12.907

看看 Pretty Diff 工具。它可以在不损失完整性的情况下缩小和美化代码。

[http://prettydiff.com/](http://prettydiff.com/)

# html - HTML 片段链接与 CSS 定位一起使用？

> ID：494324
> 
> 赞同：0
> 
> 时间：2009-01-30T02:45:37.220
> 
> 标签：html, css

昨晚我决定在我的计算机列表页面中添加 HTML 片段链接。但是，无论链接模式如何，或者我使用哪种浏览器，这些片段链接根本无法导航。

[http://icelava.net/mycomputers.aspx#SEPHIROTH](http://icelava.net/mycomputers.aspx#SEPHIROTH)

[http://icelava.net/mycomputers.aspx#DIABLO](http://icelava.net/mycomputers.aspx#DIABLO)

*回答更新：在我的标签属性错误被突出显示后，链接现在正确地流向片段位置。*

我没有找到任何真正的答案，但从我所阅读的内容来看，有一些提示表明我使用 CSS 定位来形成具有两个 DIV 的两列布局可能会给浏览器在计算片段的垂直位置时带来麻烦链接。

```
#ContentCol
{
   margin-right: 130px;
   padding: 3px;
}

#RightSideCol
{
   background-color: #fff;
   float: right;
   padding: 0px;
   width: 126px;
} 
```

如果是这种情况，允许 HTML 片段链接的适当方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-30T02:54:18.593

为了让这些 url 导航到您的预期目标，您需要命名锚点，而不是页面中的链接锚点。例子：

```
<a name="SEPHIROTH" /> 
```

（没有井号）而不是：

```
<a href="#SEPHIROTH"> #1</a> 
```

最好不要使用命名锚点，您也可以只给要导航`id`属性的元素。

```
<td id="SEPHIROTH">...</td> 
```

另一个例子。试试这个链接：[http://icelava.net/mycomputers.aspx#FooterBanner](http://icelava.net/mycomputers.aspx#FooterBanner) 你看，它向下滚动到你的页脚，因为`id`属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-30T03:13:55.697

如果你的代码，你有，例如：

```
<a href="#SEPHIROTH">#3</a> Dell XPS M1530 
```

您可能需要添加一个`id`属性：

```
<a id="SEPHIROTH" href="#SEPHIROTH">#3</a> Dell XPS M1530 
```

当您单击它时`<a>`，它会“跳”到自己。这是你想要的吗？

# java - JNA 结构和指针映射

> ID：494325
> 
> 赞同：6
> 
> 时间：2009-01-30T02:46:56.330
> 
> 标签：java, jna

如何将下面的函数映射到java？

**VOID WriteToStruct(BOOL *Status, STRUCT_MSG RecBuff)**

此函数
的作用：1) 填充结构 RecBuff
2) 更新状态

如何映射到 Java 中的布尔指针并访问函数更新的结构数据？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-10T23:12:15.423

我正在寻找另一个关于 JNA 和结构的问题，谷歌将我重定向到这里。我希望这有帮助。

来自[JNA API](https://jna.dev.java.net/javadoc/overview-summary.html#byvalue "JNA API")

> 要按值传递结构，首先定义结构，然后从实现 Structure.ByValue 的类中定义一个空类。使用 ByValue 类作为参数或返回类型。
> 
> ```
> // Original C code
> typedef struct _Point {
>   int x, y;
> } Point;
> 
> Point translate(Point pt, int dx, int dy);
> 
> // Equivalent JNA mapping
> class Point extends Structure {
>     public static class ByValue extends Point implements Structure.ByValue { }
>     public int x, y;
> }
> Point.ByValue translate(Point.ByValue pt, int x, int y);
> ...
> Point.ByValue pt = new Point.ByValue();
> Point result = translate(pt, 100, 100); 
> ```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-15T08:19:39.863

您可以使用 ByReference 类通过引用传递值。假设 BOOL 是一个 int，您可以使用 IntegerByReference。

# iphone - 如何检测 iPhone 上的内存泄漏？

> ID：494327
> 
> 赞同：24
> 
> 时间：2009-01-30T02:48:04.423
> 
> 标签：iphone, xcode, memory-leaks

我正在通过 Xcode 使用 Leaks Instruments 功能来（尝试）查找内存泄漏。我还没有弄清楚如何使用这个程序。我在程序中单击 Leaks，当我在模拟器中执行各种操作时，发现内存在增加。我显示了扩展详细信息窗格。扩展详细信息窗格中唯一引用我的应用程序的是 main。与 Xcode 生成的 main 方法一样。其他一切都是 UIKit、Foundations 和其他我没有编写的 SDK 类。我的应用程序没有显示任何内容，我做错了什么？

在我达到 3 分钟之前，有超过 100 次泄漏，总计 2.5k。这很常见吗？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-02-02T15:46:15.007

我写了一篇关于使用 Instruments 跟踪 iPhone 内存泄漏的教程。我不确定它是否会帮助你处理你正在处理的事情......不过，不会受伤。:-)

[http://www.streamingcolour.com/blog/tutorials/tracking-iphone-memory-leaks/](http://www.streamingcolour.com/blog/tutorials/tracking-iphone-memory-leaks/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-30T03:17:42.243

在仪表板上将视图更改为“扩展细节”。这将在您停止记录并选择泄漏对象后向您显示每个泄漏对象的堆栈跟踪。

您确实看到了对 API 的调用，但您感兴趣的是在 API 调用之前找到应用程序的最后一个方法，这就是泄漏所在。

提示：在泄漏视图中打开“收集内存内容”。查看对象值也应该有助于找出问题所在。

你不想要任何泄漏。100 次泄漏并不典型（至少在我的应用程序中）典型应该是 0。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-30T02:55:26.030

我不熟悉如何使用 Leaks，但您始终可以尝试在您的代码上运行 Clang 分析器，看看是否会出现任何问题：[http](http://clang.llvm.org/StaticAnalysis.html) ://clang.llvm.org/StaticAnalysis.html 。它通常可以发现许多可能导致内存泄漏的错误。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-02-22T17:27:40.557

Xcode：运行 -> 从性能工具开始 -> 泄漏

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-02T15:58:21.380

请记住，当设备不会泄漏时，模拟器可能会泄漏。曾经使用 UITableViewController 类遇到过这种情况。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-15T01:29:35.853

使用 LLVM/Clang 静态分析器。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-30T03:56:38.827

另请注意，泄漏工具不会向您显示对象被过度保留并仍然保留的实例。泄漏是应该放开的物体只是闲逛而没有人清理它们的情况。即使您认为它们应该消失，过度保留的对象也会被有效地保留 - 因此泄漏工具无法指出它们，因为它们仍然被引用并且没有办法将它们与仍然应该保留的对象区分开来。

要找到这些，请使用内存报告工具并确保在释放对象后内存使用完全下降。如果你注意到某些东西没有释放内存，你可以先在 dealloc 中放置断点，看看你期望看到的释放是否真的被释放了。

您需要查找这两种情况以保持干净的内存占用。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-07-15T09:39:24.980

```
Run -> Start with Performance Tool -> Leaks 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-08-24T21:32:13.417

要检测内存泄漏，您可以使用 Xcode 的“构建和分析”功能。

只需在 Xcode 菜单中选择**Build -> Build and Analyze 。**

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-09-17T12:09:23.983

对主要的内存泄漏工具做了总结：http: [//bcaccinolo.wordpress.com/2010/09/15/iphone-essential-performance-tools-list/](http://bcaccinolo.wordpress.com/2010/09/15/iphone-essential-performance-tools-list/)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2011-07-15T13:27:56.017

可以在 Xcode 中找到的泄漏应用程序：`run -> Start with Performance Tool -> Leaks`.

Apple 的 Instruments 实用程序可以在`/Developer/Applications/Performance Tools`.

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-11-16T10:58:09.500

查找内存泄漏的最佳方法之一是选择产品-> 分析。左边的 Xcode 显示了您在哪个文件中存在内存泄漏。导致内存泄漏的变量是什么。这是查找内存泄漏的最佳方法之一。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-06-08T07:01:34.990

内存调试器（控制台上方的按钮，视图调试器旁边）也非常有用。它会向您显示泄漏，并且您可以轻松地检查 /filter 对象是否仍在内存中而不应该在内存中。

# .net - NHibernate IList 到列表

> ID：494332
> 
> 赞同：3
> 
> 时间：2009-01-30T02:50:09.567
> 
> 标签：.net, nhibernate, remoting

您好我正在尝试返回建筑域的集合。

```
private long _id;
private string _buildingName;
private IList<BasicRoom> _rooms; 
```

我正在使用 NHibernate 和房间的这个映射

```
<bag name="rooms" table="tb_rooms" lazy="false">
<key column="buildingID"/>
<one-to-many class="Room"/>
</bag> 
```

我这样称呼数据库；

```
Buildings = (List<Building>)session.CreateCriteria(typeof(Building)).AddOrder(Order.Asc("buildingName")).List<Building>(); 
```

问题是我不希望 _rooms 集合成为 IList，但我需要它成为 List。唉，NHibernate 要求我为集合使用一个接口。任何想法如何做到这一点。我是 .Net 的新手，我认为放弃 NHibernate 可能是前进的方向。我只需要将集合类型化为列表，以便继续。非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-01T22:32:43.580

NHibernate 不是这样工作的。您无法告诉它您的域模型对象的具体类型是什么。您只需告诉它基本类型和接口是什么。然后它可以选择如何有效地实现域类型。

例如，NHibernate 使用它自己的内部实现，`IList<T>`它知道如何进行延迟加载。

此外，NHibernate 使用自己`Building`的域模型内部实现。`Building`您将与 NHibernate 一起使用的所有对象不一定都具有，作为它们的具体类型， `Building`. 无论是对象的具体类型，还是对象具体类型的基类型，它们都是`Building`s才是真的。`Building`

但这是*正确的做法*，因为无论如何您都*应该*使用接口和基本类型而不是具体类型。NHibernate 帮助您使用所有正确的编程方法。

现在，你为什么需要一个`List<Building>`本身？为什么会`IList<Building>`不够？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-30T03:01:30.590

为什么你需要一个具体的`List`对象，当你可以做任何你想做的事情时`IList`？

如果它绝对必须是一个具体的列表，你有两个选择。

首先，只需将`IList<Building>`to 转换为`List<Building>`。这仅在基础类型*是*a时才有效`List<Building>`，我个人对此表示怀疑。

其次，在其上调用 ToList() 扩展方法：

```
Buildings = (List<Building>)session.CreateCriteria(typeof(Building)).AddOrder(Order.Asc("buildingName")).List<Building>().ToList(); 
```

我个人建议您两者都不做，而是使用 IList。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-01T22:23:37.327

`List<T>`使用that的构造函数怎么样`IEnumerable<T>`？然后你可以使用：

```
Buildings = new List<Building>(session.CreateCriteria(typeof(Building)).AddOrder(Order.Asc("buildingName")).List<Building>()); 
```

# linq - 如何在 ADO.Net 数据服务的服务操作中使用 ."Include"

> ID：494337
> 
> 赞同：2
> 
> 时间：2009-01-30T02:53:52.057
> 
> 标签：linq, wcf-data-services, service-operations

我正在使用 ADO.Net 数据服务并有一个服务操作，最终将一些 linq 的结果返回到实体语句。作为这些 Linq 语句的一部分，有一个 .Include("NavProp") 来包含一个子对象。运行此服务操作时，它似乎不会返回扩展的包含。有谁知道这是为什么或如何解决？是否可以在对服务操作的调用中添加关键字来扩展该子对象？（我试过 $expand=subObject 但这似乎不起作用 - 错误的请求）。

我想结束： 1.) 服务操作中的 linq 语句的语法，它也返回 .Include （我很确定这是不可能的）

```
something like:
(from c in context.MyObj.Include("SubObj")
select c).ToList()
(this works inside the service operation, but doesn't provide the SubObj on the client side) 
```

或者

2.) 服务操作请求扩展子对象的语法

```
something like: http://localhost/MyDataService/MyDataService.svc/ServiceOp1?param1=234$expand=SubObj (note: this doesn't work) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T00:17:00.070

目前看来这是不可能的（.net 3.5 SP1）。服务操作将只返回原始类型或实体。不能从服务操作返回任何其他类型，包括自定义类型或扩展实体。要处理这个问题，必须只从服务操作中返回项目，然后如果客户端需要包含/扩展，则必须调用“LoadProperty”以进行所需的对象扩展（注意：这意味着每个数据库都会命中另一个LoadProperty 调用）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-22T07:10:27.270

就此问题向 MS 发送电子邮件后，解决方案是在服务操作的 uri 上使用扩展查询选项。例如，

```
.../<ServiceOperationName>.svc?$expand=<Property1Name>,<Property2Name> ...

Service Operation: GetCustomer
Relationship Property to load: Address
Uri: .../<GetCustomer>.svc?$expand=Address 
```

希望这可以帮助。

# asp.net-mvc - 如何从 MY OWN HtmlHelper 中访问 HtmlHelper 方法？

> ID：494345
> 
> 赞同：9
> 
> 时间：2009-01-30T02:58:01.457
> 
> 标签：asp.net-mvc, html-helper

我正在为 ASP.NET MVC 编写自己的 HtmlHelper 扩展：

```
public static string CreateDialogLink (this HtmlHelper htmlHelper, string linkText, 
                                      string contentPath)
        {
            // fix up content path if the user supplied a path beginning with '~'
            contentPath = Url.Content(contentPath);  // doesn't work (see below for why)

            // create the link and return it
            // .....
        }; 
```

我遇到麻烦的地方是尝试`UrlHelper`从我的 HtmlHelper 的定义**中访问。**问题是您通常访问`HtmlHelper`（通过`Html.MethodName(...)` ）的方式是通过视图上的属性。这显然不适用于我自己的扩展类。

这是`ViewMasterPage`（截至 Beta 版）的实际 MVC 源代码 - 它定义`Html`和`Url`.

```
public class ViewMasterPage : MasterPage
    {
        public ViewMasterPage();

        public AjaxHelper Ajax { get; }
        public HtmlHelper Html { get; }
        public object Model { get; }
        public TempDataDictionary TempData { get; }
        public UrlHelper Url { get; }
        public ViewContext ViewContext { get; }
        public ViewDataDictionary ViewData { get; }
        public HtmlTextWriter Writer { get; }
    } 
```

我希望能够在 HtmlHelper 中访问这些属性。

我想出的最好的就是这个（在`CreateDialogLink`方法的开头插入）

```
HtmlHelper Html = new HtmlHelper(htmlHelper.ViewContext, htmlHelper.ViewDataContainer);
UrlHelper Url = new UrlHelper(htmlHelper.ViewContext.RequestContext); 
```

我是否错过了访问现有实例`HtmlHelper`和`UrlHelper`实例的其他方式 - 还是我真的需要创建一个新实例？我敢肯定没有太多开销，但如果可以的话，我更愿意使用预先存在的开销。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-30T04:21:05.313

在问这个问题之前，我已经查看了一些 MVC 源代码，但显然我错过了这一点，这就是他们为 Image helper 所做的。

```
[System.Diagnostics.CodeAnalysis.SuppressMessage("Microsoft.Design", "CA1054:UriParametersShouldNotBeStrings", MessageId = "1#", Justification = "The return value is not a regular URL since it may contain ~/ ASP.NET-specific characters")]
        public static string Image(this HtmlHelper helper, string imageRelativeUrl, string alt, IDictionary<string, object> htmlAttributes) {
            if (String.IsNullOrEmpty(imageRelativeUrl)) {
                throw new ArgumentException(MvcResources.Common_NullOrEmpty, "imageRelativeUrl");
            }

            UrlHelper url = new UrlHelper(helper.ViewContext);
            string imageUrl = url.Content(imageRelativeUrl);
            return Image(imageUrl, alt, htmlAttributes).ToString(TagRenderMode.SelfClosing);
        } 
```

看起来实例化一个新`UrlHelper`的毕竟是正确的方法。这对我来说已经足够好了。

* * *

**更新：来自**[ASP.NET MVC v1.0 源代码](http://aspnet.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=24471)的RTM 代码与评论中指出的略有不同。

文件：MVC\src\MvcFutures\Mvc\ImageExtensions.cs

```
 [System.Diagnostics.CodeAnalysis.SuppressMessage("Microsoft.Design", "CA1054:UriParametersShouldNotBeStrings", MessageId = "1#", Justification = "The return value is not a regular URL since it may contain ~/ ASP.NET-specific characters")]
        public static string Image(this HtmlHelper helper, string imageRelativeUrl, string alt, IDictionary<string, object> htmlAttributes) {
            if (String.IsNullOrEmpty(imageRelativeUrl)) {
                throw new ArgumentException(MvcResources.Common_NullOrEmpty, "imageRelativeUrl");
            }

            UrlHelper url = new UrlHelper(helper.ViewContext.RequestContext);
            string imageUrl = url.Content(imageRelativeUrl);
            return Image(imageUrl, alt, htmlAttributes).ToString(TagRenderMode.SelfClosing);
        } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-30T04:03:38.560

我遇到了类似的问题，并决定在视图中调用 UrlHelper 并将输出传递给我的 HtmlHelper 扩展会更容易。在您的情况下，它看起来像：

```
<%= Html.CreateDialogLink( "text", Url.Content( "~/...path.to.content" ) ) %> 
```

如果您想访问传递给您的类的现有 HtmlHelper 上的扩展方法，您只需要在源代码文件中导入 System.Web.Mvc.Html 就可以访问它们（这就是扩展类的位置被定义）。如果你想要一个 UrlHelper，你需要实例化它，因为你得到的 HtmlHelper 没有它来自的 ViewPage 的句柄。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-08-06T23:55:05.787

如果您需要在实用程序类中创建 UrlHelper，您可以执行以下操作：

字符串 url = "~/content/images/foo.jpg";

```
 var urlHelper = new UrlHelper(new RequestContext(
                  new HttpContextWrapper(HttpContext.Current), 
                  new RouteData()), RouteTable.Routes);

  string absoluteUrl = urlHelper.Content(url); 
```

这允许您在 MVC 上下文之外使用路由或“~扩展”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-30T03:03:30.337

好吧，您总是可以将页面的实例传递给扩展方法。我认为这比在您的方法中创建新实例要好得多。

您还可以在派生自 MasterPage/ViewMasterPage 的类上定义此方法，然后从中派生页面。这样，您就可以访问实例的所有属性，而不必传递它们。

# asp.net - ASP.NET MVC RC 中的 SetAttemptedValue 发生了什么？

> ID：494347
> 
> 赞同：2
> 
> 时间：2009-01-30T02:59:06.867
> 
> 标签：asp.net, asp.net-mvc

不知道用什么代替？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-30T03:37:13.933

看起来它已被 SetModelValue 取代。RC1 的源代码位于[http://www.codeplex.com/aspnet/SourceControl/ListDownloadableCommits.aspx](http://www.codeplex.com/aspnet/SourceControl/ListDownloadableCommits.aspx)

# javascript - 使用 jQuery 突出显示表格中的列

> ID：494362
> 
> 赞同：1
> 
> 时间：2009-01-30T03:15:17.987
> 
> 标签：javascript, jquery

我有一个表，我正在使用 jquery 突出显示表中的备用列

```
$("table.Table22 tr td:nth-child(even)").css("background","blue"); 
```

但是我在最后一行`<table>`里面有另一个。`<tr>`如何避免突出显示内部表格的列`<tr>`？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-30T03:27:10.850

使用`>`后代选择器对其进行限定：

```
$("table.Table22 > tbody > tr > td:nth-child(even)").css("background","blue"); 
```

您也需要`tbody`限定符，因为浏览器会自动插入 a`tbody` **无论您是否在标记中使用它**。

*编辑*：哎呀。谢谢安南。

*编辑2*：强调tbody。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-30T03:22:58.427

未经测试，但也许：[http ://docs.jquery.com/Traversing/not#expr](http://docs.jquery.com/Traversing/not#expr)

```
$("table.Table22 tr td:nth-child(even)").not("table.Table22 tr td table").css("background","blue"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-30T03:27:26.903

这是我用来在表格中突出显示嵌套复选框的一些代码。我需要能够做一个“检查所有/取消检查所有”，但只能在嵌套内的一个级别内；也就是说，我不希望子元素也被选中。

```
var parentTable = $(this).parents("table:first");
var exclusions = parentTable.find("table :checkbox.select");
var checkboxes = parentTable.find(":checkbox.select").not(exclusions); 
```

我会在我所在的当前表上方获得第一个表，在这个新找到的父表*下方*获取所有复选框，然后将它们从我能找到的复选框的完整列表中排除。基本上，我找到了每个复选框，但随后排除了我找到的任何子复选框。

在您的情况下也可以进行调整；用列替换复选框选择。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-30T03:30:30.780

为什么不利用 html 的优势呢？

代替

```
<table>
  <tr>
    <td>
    ...
    </td>
  </tr>
</table> 
```

尝试

```
<table>
  <tfoot>
    <tr>
       <td>
       ...
       </td>
    </tr>
  </tfoot>
  <tbody>
    <tr>
      <td>
      ...
      </td>
    </tr>
  </tbody>
</table> 
```

您也可以使用`<thead>`标签来操作标题。

现在你可以调用选择器

```
$("table.Table22 tbody tr td:nth-child(even)").css("background","blue") 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-30T04:00:32.717

您是否测试了以下内容？

```
$("table.Table22 tr td:nth-child(even):not(:last-child)").css("background","blue") 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-12-15T15:17:03.090

这个页面定义了一个很好的函数来选择一个列 [http://programanddesign.com/js/jquery-select-table-column-or-row/](http://programanddesign.com/js/jquery-select-table-column-or-row/)

# asp.net - 视觉网络开发人员一起调整“所有图像”的大小？

> ID：494371
> 
> 赞同：1
> 
> 时间：2009-01-30T03:22:41.717
> 
> 标签：asp.net, visual-studio, controls, visual-studio-express, visual-web-developer

我对视觉 Web 开发人员中的图像有一个奇怪的问题，

我无法从属性面板更改我的图像属性（我的更改没有生效）并且我网站中的所有图像都具有相同的大小

当我调整一张图像的大小（通过拖动边框）时，所有图像都会获得新的大小？

任何的想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-30T03:29:19.380

不知何故，视觉 Web 开发人员读取 CSS 文件中的图像类而不是控件的属性，因为在我的 CSS 文件中有类似这样的内容：

```
img {
width:260px;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-30T08:23:41.907

是的，基本上 HTML 的 width 和 height 属性`<img />`已经被弃用了一段时间，建议您改用样式。

然后，VS 将这一点发挥到了极致，而不是使用内联样式，而是在默认样式表位置为 . 创建一个新样式`img`，正如您所发现的。

但是，除非您在某处使用全尺寸图像，否则最好在将图像上传到服务器之前调整其大小，从而节省每个人的带宽。

此外，IE 的默认缩放例程做得很差，但您可以通过 css 打开三次采样。

# c - Linux内核如何编译自己？

> ID：494372
> 
> 赞同：89
> 
> 时间：2009-01-30T03:22:54.760
> 
> 标签：c, linux, compiler-construction

在我的机器上安装Linux系统时，我不太了解Linux内核的编译过程。

以下是一些让我感到困惑的事情：

1.  内核是用 C 编写的，但是在没有安装编译器的情况下如何编译内核？
2.  如果在编译内核之前在我的机器上安装了 C 编译器，那么在没有安装编译器的情况下如何编译编译器本身？

这两天很迷茫，谢谢回复。

* * *

## 回答 #1

> 赞同：208
> 
> 时间：2009-01-30T03:34:14.377

你的 Linux 机器的第一轮二进制文件是在其他一些 Linux 机器上构建的（可能）。

第一个 Linux 系统的二进制文件是在*其他*平台上构建的。

该计算机的二进制文件可以将其根追溯到建立在*另一个*平台上的原始系统。

...

将这一点推得足够远，你会发现编译器是用更原始的工具构建的，而这些工具又是在它们的主机之外的机器上构建的。

...

继续往下推，你会发现电脑内置了，可以通过**设置机器前面板上的开关**来输入它们的指令。

很酷的东西。

规则是“构建工具来构建工具来构建工具......”。非常类似于运行我们物理环境的工具。也被称为“自力更生”。

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2009-01-30T10:56:48.867

我认为你应该区分：

**compile** , v：使用编译器处理源代码并生成可执行代码[[1]](http://en.wiktionary.org/wiki/compile)。

和

**install** , v: 连接、设置或准备使用[[2]](http://en.wiktionary.org/wiki/install)。

编译从源代码生成二进制可执行文件。安装只是将这些二进制可执行文件放在正确的位置以便以后运行它们。因此，如果二进制文件可用，则安装和使用不需要编译。相应地考虑“编译”和“安装”，就像“烹饪”和“服务”一样。

现在，你的问题：

> 1.  内核是用 C 编写的，但是在没有安装编译器的情况下如何编译内核？

没有编译器就无法编译内核，但可以从已编译的二进制文件中*安装它。*

通常，当您安装操作系统时，您会安装一个预编译的内核（二进制可执行文件）。是别人编的。只有当你想自己编译内核时，你才需要源代码和编译器，以及所有其他工具。

即使在像 gentoo 这样的“基于源代码”的发行版中，您也可以从运行已编译的二进制文件开始。

所以，你可以一辈子不用编译内核，因为它们是由其他人编译的。

> 2.  如果在编译内核之前在我的机器上安装了 C 编译器，那么在没有安装编译器的情况下如何编译编译器本身？

如果没有内核 (OS)，则无法运行编译器。所以必须安装一个*编译好的*内核来运行编译器，但不需要自己*编译*内核。

同样，最常见的做法是安装编译器的已编译二进制文件，并使用它们编译其他任何东西（包括编译器本身和内核）。

现在，鸡和蛋的问题。第一个二进制文件是由其他人编译的……请参阅 dmckee 的出色回答。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-01-30T10:56:39.133

描述这种现象的术语是[bootstrapping](http://en.wikipedia.org/wiki/Bootstrapping_(compilers))，这是一个有趣的概念。如果您考虑嵌入式开发，就会发现很多需要软件的设备（例如闹钟、微波炉、遥控器）的功能不足以编译它们自己的软件。事实上，这类设备通常没有足够的资源来远程运行像编译器这样复杂的东西。

他们的软件是在台式机上开发的，然后在编译后复制。

如果您对这类事情感兴趣，那么我脑海中浮现的一篇文章是：[对信任信任的思考](http://cm.bell-labs.com/who/ken/trust.html)（[pdf](http://www.ece.cmu.edu/~ganger/712.fall02/papers/p761-thompson.pdf)），这是一本经典且有趣的读物。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-01-30T03:56:45.033

内核不会自行编译——它是由用户空间中的 C 编译器编译的。在大多数 CPU 架构中，CPU 在特殊寄存器中有许多位，这些位表示当前运行的代码具有哪些权限。在 x86 中，这些是*代码段*(CS) 寄存器中的*当前特权级*位 (CPL) 。如果 CPL 位为 00，则称代码在*安全环 0*中运行，也称为*内核模式*。如果 CPL 位为 11，则称该代码在*安全环 3*中运行，也称为*用户模式*。其他两种组合，01 和 10（分别为安全环 1 和 2）很少使用。

 ***关于在用户模式和内核模式下什么代码可以做什么和不可以做什么的规则相当复杂，但可以说，用户模式严重降低了权限。

现在，当人们谈论操作系统的内核时，他们指的是操作系统代码的一部分，这些代码可以在内核模式下以提升的权限运行。通常，出于安全原因，内核作者尝试使内核尽可能小，以便不需要额外特权的代码没有它们。

C 编译器就是这样一个程序的一个例子——它不需要内核模式提供的额外权限，因此它像大多数其他程序一样在用户模式下运行。

对于 Linux，内核由两部分组成：内核源代码和内核编译后的可执行文件。任何带有 C 编译器的机器都可以将内核从源代码编译成二进制映像。那么，问题是如何处理该二进制图像。

在新系统上安装 Linux 时，您安装的是预编译的二进制映像，通常来自物理介质（如 CD DVD）或网络。BIOS 将从媒体或网络加载内核的引导加载程序（二进制映像），然后引导加载程序将内核的（二进制映像）安装到您的硬盘上。然后，当您重新启动时，BIOS 从您的硬盘加载内核的引导加载程序，引导加载程序将内核加载到内存中，然后您就可以关闭并运行了。

如果你想*重新编译*你自己的内核，这有点棘手，但可以做到。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-01-30T05:45:30.073

哪个是第一个？鸡还是鸡蛋？

自恐龙时代以来，鸡蛋就已经存在。

..有些人说鸡实际上是野兽的后代，从而混淆了一切。长话短说：技术（蛋）在当前产品（鸡）之前就已经存在

你需要一个内核来构建一个内核，即你用另一个构建一个内核。

第一个内核可以是你想要的任何东西*（最好是可以创建你想要的最终产品的合理的东西^__^）*

[本教程来自 Bran 的内核开发](http://www.osdever.net/bkerndev/Docs/title.htm)，教您开发和构建一个小型内核，然后您可以使用您选择的虚拟机进行测试。

含义：您在某个地方编写和编译内核，然后在空（无操作系统）虚拟机上读取它。

这些 Linux 安装所发生的事情遵循相同的想法，但增加了复杂性。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2013-09-17T13:51:09.223

一路下来都不是乌龟。就像您说的那样，您无法在运行该操作系统的系统上编译以前从未编译过的操作系统。类似地，至少编译器的第一次构建必须在另一个编译器上完成（通常还有一些后续构建，如果第一次构建还不能编译它自己的源代码）。

我认为最初的 Linux 内核是在 Minix 机器上编译的，尽管我对此不确定。GCC 当时可用。许多操作系统的早期目标之一是运行足够好的编译器来编译它们自己的源代码。更进一步，第一个编译器几乎肯定是用汇编语言编写的。第一个汇编程序是由那些不得不用原始机器代码编写的穷人编写的。

您可能想查看[Linux From Scratch](http://www.linuxfromscratch.org/)项目。您实际上在书中构建了两个系统：一个“临时系统”构建在您自己没有构建的系统上，然后是构建在您的临时系统上的“LFS 系统”。本书目前的写作方式实际上是在另一个 Linux 机器上构建临时系统，但理论上你可以调整它以在完全不同的操作系统上构建临时系统。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-09-17T15:21:44.600

如果我正确理解您的问题。这些天内核并没有“自行编译”。当今大多数 Linux 发行版都通过 linux live cd 提供系统安装。内核从 CD 加载到内存中，并像安装到磁盘一样正常运行。在您的系统上启动并运行 linux 环境后，只需将必要的文件提交到您的磁盘就很容易了。

如果您在谈论引导问题；dmckee 总结得很好。

只是提供另一种*可能性*...

# c# - 从 C DLL 到 .NET 的接口

> ID：494376
> 
> 赞同：3
> 
> 时间：2009-01-30T03:24:34.320
> 
> 标签：c#, .net, dll, unmanaged

我有一个用 C 语言编写的旧版 DLL，我想从 C# .NET 应用程序中调用它。问题是 C DLL 的 DLL 接口相当复杂。是这样的：

```
__declspec(dllexport) void __stdcall ProcessChunk(
    void *p_prochdl,
    const BIG_INPUT_STRC *p_inparams,
    BIG_OUTPUT_STRC *p_outparams
); 
```

BIG_INPUT_STRC/BIG_OUTPUT_STRC 包含各种各样的东西......指向缓冲区数组的指针、枚举参数、整数参数等。总之，它们很复杂。

第一个问题：有没有一种简单的方法可以将 DLL 头文件中包含的所有结构信息都放入 C# 类中，还是需要将所有内容复制并粘贴到 C# 中并重新定义它？这似乎是多余的。

与此相关，将结构从 C# 传递到非托管 DLL 的正确方法是什么？

最后，是否有一个如何将缓冲区数组从 C# 正确传递到非托管 DLL 的示例？或者，如何将二维数组传递到 DLL 中？

谢谢，-格雷格

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-30T03:59:07.917

使用 P/Invoke 在 C# 中做这件事是非常直接的。

我相信您将不得不在 C# 中手动定义数据结构。

我建议您看一下有关该主题的[MSDN 文章](http://msdn.microsoft.com/en-us/library/aa288468.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-30T04:10:41.370

您需要广泛使用[.net marshalling](http://msdn.microsoft.com/en-us/library/aa446536.aspx)。首先，您需要在 C# 代码中重新定义 C 结构，然后确保使用[MarshalAs](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshalasattribute.aspx)属性正确编组所有内容。

如果需要将 C# 中的指向结构的指针传递回 C 函数，则可以使用[Marshal.StructToPtr](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshal.structuretoptr.aspx)函数。

缓冲区数组，假设它们被定义为 byte[] 您可以使用以下技术编组：

```
byte[] buffer = ...;
fixed(byte *pBuffer = buffer)
{
   // do something with the pBuffer
} 
```

固定语句确保缓冲区不会被垃圾收集器移动到内存中，从而使语句中的指针“固定”或“固定”。

至于多维数组，它取决于底层的 C 实现，例如，您可以使用指向数组的指针并根据维数和每个维度中的元素数调整位置，例如：

```
someValue = buffer[(elementsPerDimensions * x) + y]; 
```

从你的描述看来已经很复杂了，你考虑过让你的库对 COM 友好吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-30T04:16:32.513

什么药丸。

1.  我会避免尝试使库 COM 友好。这比它的价值更麻烦。

2.  我将构建第二个本机库，其功能设计为 P/INVOKED 以建立第一个记录并调用它。

或者，您可以制作一个 C++ 本机/托管库来处理封送处理。

# asp.net - Visual Studio 2003 - 打开 ASP.NET 项目 - 收到“操作超时”错误消息

> ID：494381
> 
> 赞同：2
> 
> 时间：2009-01-30T03:27:17.073
> 
> 标签：asp.net, timeout, visual-studio-2003

有时，当我打开一个 Visual Studio 2003 ASP.NET 项目时，它似乎要永远加载，然后最终显示以下错误消息：

“Web 服务器在尝试创建或打开位于以下 URL 的 Web 项目时报告了以下错误： [http://localhost/myprojectname](http://localhost/myprojectname)。操作超时。”

知道为什么会发生这种情况以及如何解决吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-30T03:31:56.847

对我来说，解决方法是取消注册 .net 的重新注册 iis：

打开命令窗口并导航到 C:\windows\microsoft.net\framework\v1.1.4322 输入 aspnet_regiis -u 一旦完成卸载 ASP.NET 输入 apsnet_regiis -i

仅执行 aspnet_regiis -i 本身是行不通的。

仍然不确定为什么会发生这种情况，但可能与在 Eclipse\Java\JBoss 到 VS2003\C#\IIS 之间切换开发环境有关

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-07-06T13:05:15.220

这对我有用...

[http://forums.asp.net/p/1192304/2066860.aspx](http://forums.asp.net/p/1192304/2066860.aspx)

在我的 XP 开发机器上，我转到“C:\Documents and Settings\USERNAME\VSWebCache\USERNAME\”并删除了与我的 VS2003 解决方案名称匹配的文件夹。（实际上我将文件夹移动到 C:\Temp 以防万一）。这很有效，尽管一个设计器文件在没有重新构建的情况下无法加载，并且需要重新标记启动页面。我不明白为什么我的解决方案依赖于这个 VSWebCache （当我重新构建我的解决方案时它重新出现。）任何人都可以解释这种依赖关系吗？这是不安定的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-11-27T09:51:40.333

这对我有用。希望它也对你们有用。

最初，我尝试了很多事情：

1.  打开命令窗口并导航到 C:\windows\microsoft.net\framework \v1.1.4322 输入 aspnet_regiis -u 卸载 ASP.NET 完成后，输入 aspnet_regiis -i （有时但并非总是有效）。

2.  根据一些论坛的答案，我尝试通过清除 Visual Studio 2003 的 vswebcache，但没有成功。

最后，我使用了我自己的技术，它对我有用。我为没有加载的项目使用了旧的 dll，并且我用旧的项目 dll 替换了 dll。之后，我的项目被加载到 Visual Studio 2003 中。将有一个带有项目名称的 dll 和 pnb 文件，有时会损坏，您的项目不会加载到 IDE 中。

因此，如果您遇到类似的问题，那么您有两种选择：

1）用旧的dll替换dll。2）删除带有项目名称的Dll和pnb文件并尝试再次重新加载。（删除dll不会影响您的代码和其他dll）。

希望它也对你有用:)

# c# - 升级安装我的产品时出错

> ID：494385
> 
> 赞同：1
> 
> 时间：2009-01-30T03:29:59.223
> 
> 标签：c#, installshield

我期待这可能是一个非常简单的问题，但我有点卡住了。

尝试在最新的现有版本上安装我们产品的新版本时出现错误。这是错误。

“这台机器上安装了更高版本的“abc”。安装程序无法继续。”

原来安装的版本号是5.0.1.116，新的是5.1.0.138。这是在程序集和 InstallShield 属性中设置的。我没有修改 InstallShield 中的程序代码或升级代码，并且有理由确定我不应该这样做。

在我看来，新版本号在各个方面都更高。第 3 位被提及为用于构建编号的东西，但我通常不这样做。在尝试从 Build 1 到 Build 0 时，这可能是一个问题（也许）。我一直在使用这个版本控制模式一段时间，直到现在没有任何问题，所以我一定是在这个版本中遇到了一些设置。

更多信息。

*   C# .Net 2.0 项目。
*   InstallShield 12 用于安装包。
*   尽管我也尝试过未混淆，但使用了混淆。
*   想不出还有什么好说的。

任何想法都非常受欢迎。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-30T06:13:53.947

我终于有了答案。我在 DirectEditor 下的`ISProductConfigurationPropertyTable-Property=ProductVersion`.

有趣的是，我不知道最初设置它的原因，也没有看到任何其他暴露的地方这样做。我现在可能只是被烧毁了。如果有人知道即兴发挥，请随时告诉我。

这可能是我在下一次构建时忘记的问题:)

# c# - 为什么 Sun 不做 C# 到 Java 字节码编译器？

> ID：494389
> 
> 赞同：46
> 
> 时间：2009-01-30T03:31:21.560
> 
> 标签：c#, java, .net, compiler-construction, jvm

## 我们想在 JVM 上运行我们的 C# 代码

我的公司拥有庞大的 C# 代码库。超过一半的代码是我们创建、读取、修改、计算和编写 Excel 工作簿的核心引擎。我们经常收到来自客户和潜在客户的问题，询问我们是否要构建我们引擎的 Java 版本——他们中的许多人对 UI 根本不感兴趣。我们甚至有一些客户不厌其烦地从他们的 Java 应用程序中使用我们的 .NET 库。

因此，我们希望构建我们核心引擎的 Java 版本，最好不要维护单独的 Java 源代码库。

Eric Sink很好地[描述了这个问题。](http://www.ericsink.com/bos/Geeks_Rule.html)除了我们的软件许可包括免版税部署这一事实之外，我处于类似的位置，这使得 Eric 选择 Mainsoft 对我们来说是不可能的。

几年来，我每隔几个月就在谷歌上搜索[“c# to jvm”之类的东西，但没有任何乐趣。](http://www.google.com/search?hl=en&q=%22c%23+to+jvm%22&aq=f&oq=)我花了大约 7 年时间为 Java 开发类似的软件，我相信我们在核心引擎中使用的 .NET API 可以很容易地封装，并且我们可以使用 Java 库完成我们需要的一切。因此，如果我们只有一个 C# -> JVM 编译器，我们就可以为 Java 构建我们的核心引擎，并且我们不再需要拒绝想要使用它的 Java 开发人员。

我不是问 Sun 不做 C# 编译器的技术原因。我认识到 Java 没有属性或无符号的 64 位长等......为了论证，假设所有这些技术问题都可以通过扩展 JVM 和/或其他方式来处理。

而且我并不是要求就为什么一种语言/堆栈可能比另一种更好进行另一次辩论。我们业务的实际情况是，每个都有大量潜在客户使用。

## Sun 为什么要做 C# 编译器？（当然是国际海事组织）

更容易在 Java 平台上运行 C# 代码意味着更多的开发人员和更多的平台软件。平台的成功还有什么比这更重要的吗？[Jonathan Schwartz](http://en.wikipedia.org/wiki/Jonathan_I._Schwartz)是一名软件专家。我会让比我更聪明的人来决定他是否担任 Sun 总裁兼首席执行官这一不可能的工作，但在乔纳森加入 Sun 后不久与他会面，我的印象是他了解软件以及对大型软件的需求开发人员的基础。

## 那么为什么 Sun 不做 C# 编译器呢？

1.  [美国国立卫生研究院](http://en.wikipedia.org/wiki/Not_Invented_Here)综合症？
2.  [斯科特麦克尼利](http://en.wikipedia.org/wiki/Scott_McNealy)的幽灵？
3.  太多 Java 开发人员不喜欢或不信任与 Microsoft 相关的任何东西？
4.  他们同意不作为[花大价钱的](http://www.internetnews.com/bus-news/article.php/3334991)一部分？
5.  ？？？

一定有充分的理由。我只是无法为我的生活弄清楚它是什么......

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-01-30T03:46:04.027

首先，Sun 在 JVM 上实现 C# 编译器的动机为零，因为它们具有非常相似的东西，称为 Java 编程语言。

它也不像实现编译器那么简单，因为 Java 标准类库与 .net 基类库不同。您最终将不得不将所有 .NET API 调用更改为 Java API 调用。

Micrsoft 有一个名为 J# 的产品，该产品旨在用于 Java 到 .NET 的转换，但最终没有人使用它，因为 API 仅限于 Java 2 之前的 API，所以它几乎没有用。如果 Sun 实现了 .NET BCL 的一部分，情况也是如此，因为只有它的核心部分是标准化的并且是免费的。ASP.NET 和 WPF、WCF 等部分不是 ECMA 标准的一部分，因此 Sun 需要 Microsoft 的许可才能实现这些 API。

如果有足够多的客户想要一个具有商业意义的 Java 版本来将您的应用程序移植到 Java，那么就去做，那么您将永远不会通过 C# 到 JVM 编译器从 Sun 获得任何帮助。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-01-30T03:43:24.797

> 乔·埃里克森写道：
> 
> 更容易在 Java 平台上运行 C# 代码意味着更多的开发人员和更多的平台软件。

这是一个不真实的说法。在 JVM 上运行 C# 代码不会创建 Java 程序员，它会创建可以在 JVM 上执行的 C# 程序员。它只是扩展了 C# 的范围，假设 JVM 还将任何 microsoft 特定调用（即 win32）转换为平台中立的东西。因此，如果 Sun 将 IL 转换为 Java 字节码，那么它所帮助的唯一群体就是：Microsoft。而且，考虑到 Sun 在最初的 C#-Java 分裂/Visual J++ 诉讼中与微软的历史......

另外，无论您愿意与否，您都必须面对技术上的不可行性。字节码的执行方式存在根本差异，这比是否存在无符号长数据类型更为重要。

如果您必须在非 Microsoft 平台上使用 C#，请使用[Mono](http://www.mono-project.com/Main_Page)

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2009-01-30T04:34:54.957

为什么**微软**不做 C# to Java 字节码编译器？**你**为什么不做呢？每边都有开放规格...

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-01-30T06:24:20.523

*“因此，我们希望构建我们核心引擎的 Java 版本，最好不要维护单独的 Java 源代码库。”*

基本上，您希望编译未修改的 C# 代码，并让它在纯 Java 环境中运行。

IKVM*不是*你想要的。 [IKVM](http://www.ikvm.net/)是[三个主要的东西](http://www.ikvm.net/userguide/tools.html)。

一种。ikvm - Java 虚拟机的 CLI 实现（请注意，[这使用~~Classpath~~](http://weblog.ikvm.net/story.aspx/faq)（现在是 OpenJDK）作为 Java 类库）。

湾。ikvmc - 将 java 字节码编译为 CLI 字节码。

C。ikvmstub - 生成调用 CLI 代码的 java 存根类。

请注意，所有这些工具在运行时都依赖于 CLI。你想要的和 IKVM 完全相反，当然是 MVKI (Most Venerable Kompiler Intermediary) :)：

一种。mvki - CLI 虚拟机的 Java 实现（大概这将使用[Mono](http://www.mono-project.com/Main_Page)或[DotGNU](http://www.gnu.org/software/dotgnu/)作为类库）。

湾。mvkic - 将 CLI 字节码编译为 Java 字节码。

C。mvkistub - 生成调用 Java 的 CLI 存根类

请注意，这些都不需要 .NET Framework 在运行时的现有实现，因此它们应该会让您的纯 Java 客户满意。

不幸的是，据我所知 MVKI 不存在，所以你最好做一个手动端口（这将不可避免地更清洁，尽管更多的工作）。

编辑：根据Mainsoft[的描述](http://www.ericsink.com/bos/Geeks_Rule.html)，它似乎类似于 MVKI，但我不确定它们对类库做了什么，而且与 IKVM 不同，它不是 FOSS。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2009-06-17T10:28:34.393

[http://jsc.sourceforge.net/](http://jsc.sourceforge.net/)是 ac# 交叉编译器，可以将 .NET 代码转换为 Java（除其他外）。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-01-30T05:06:35.877

将您的 .NET API 公开为 ASMX Web 服务，您应该一切顺利。

编辑：对于更频繁使用的场景，值得研究 Windows Communication Foundation (WCF)。这具有对安全性、流式传输、不同传输方案（HTTP、TCP/IP、本地命名管道）的内置、可配置支持。您不仅限于 SOAP 消息编码，但这可能是与 Java 互操作的最简单方法。

我不太确定您的确切情况，但是如果您正在处理大文件并且 .NET 代码和 Java 代码都在本地运行，您可以使用 .NET 将文件保存到用户的硬盘驱动器然后获取它来自您的 Java 应用程序。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-29T10:35:35.617

> 一定有充分的理由。我只是无法为我的生活弄清楚它是什么......

很容易相信，公司是非营利组织，以您的利益为重。很容易忘记，上市公司的*唯一*目的是为股东赚钱。这是一项法律义务，如果股东不相信他们没有这样做，董事/行政人员将被解雇/起诉。

Sun 之所以免费提供 Java，是因为它有助于销售他们的硬件，而这正是它通过 Java 赚钱的方式。IBM 免费提供 Java 是因为它可以帮助他们在咨询中赚到更多的钱。

如果 Sun 将钱花在 C# 转换器上，它将如何收回这笔钱并获利。想象一下，您必须说服 Sun 的股东。如果可以，Sun 将制作一个 C# 转换器。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2010-02-01T19:19:15.547

我想知道 Mono 项目是否可以通过针对 JVM 而不是从头开始开发和维护自己的虚拟机来减少自己的工作量。开发工作可能集中在 C# 交叉编译器和将 .NET 库的无尘室实现移植到 JVM 上。有点像 Mainsoft 所做的开源版本。然后，您可以在同一 JVM 中启用 Java 和 C# 代码之间的语言间调用，并部署用 C# 编写的 Applet 和 Java Web Start 应用程序。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2012-01-30T03:15:23.960

我知道这可能不是您想要的，但这里有一些可能的替代方案（如果不是对您而言）可能对其他人有用。

1.  C：你可以尽可能多地移植到 C。现在你可以用 C# 和 Java（以及任何其他可以与 C 通信的语言）制作一个包装器，让它在编程时感觉与他们的语言是原生的。现在的问题是您（或他们，取决于您的许可证）必须为每个平台构建 C 部分。

2.  [Fantom*](http://fantom.org/)：一种编程语言，根据他们的主页，是：

    > *   可移植性：编写可移植到浏览器中的 Java VM、.NET CLR 和 JavaScript 的代码。
    > *   熟悉：语法 Java 和 C# 程序员会对 Fantom 的进化语法感到熟悉。
    > *   面向对象：Obj 的所有子类。需要性能时的值类型。
    > *   函数式：函数和闭包被嵌入。
    > *   静态和动态类型：不喜欢极端 - 走中间路线。

3.  [Haxe](http://haxe.org/) *：（发音为 hex）是编译成其他语言的跨平台语言。很快将支持 C# 和 Java。目前支持：

    > *   **Javascript：**您可以将 Haxe 程序编译为单个 .js 文件。您可以访问具有自动完成支持的类型化浏览器 DOM API，所有依赖项都将在编译时解析。
    >     
    >     
    > *   **Flash：**您可以将 Haxe 程序编译为 .swf 文件。Haxe 与 Flash Player 6 到 10 兼容，具有“旧”Flash 8 API 或最新的 AS3/Flash9+ API。Haxe 提供了非常好的性能和语言特性来开发 Flash 内容。
    >     
    >     
    > *   **NekoVM：**您可以将 Haxe 程序编译为 NekoVM 字节码。这可用于服务器端编程，例如动态网页（使用 mod_neko 用于 Apache），也可用于命令行或桌面应用程序，因为 NekoVM 可以使用其他一些 DLL 嵌入和扩展。
    >     
    >     
    > *   **PHP：**您可以将 Haxe 程序编译为 .php 文件。这将使您能够使用高级严格类型的语言，例如 haXe，同时保持与现有服务器平台和库的完全兼容性。
    >     
    >     
    > *   **C++：**您现在可以使用所需的 Makefile 从您的 Haxe 源代码生成 C++ 代码。这对于创建本地应用程序非常有用，例如在 iPhone 开发中。

    哈希社区。（2011 年 3 月 11 日）。哈克斯介绍。检索于 2011 年 1 月 29 日，来自[http://old.haxe.org/doc/intro](http://old.haxe.org/doc/intro)

    [您可以在此处](http://old.haxe.org/doc/why)了解有关 Haxe 为何有用的更多信息。

*我从来没有使用过这种语言，我不知道它的效果如何。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-04-16T04:00:21.210

我做了一个真正应该是答案的评论：

目前在 JVM 上实现 C# 规范在技术上是不可能的。C# 支持指针、无符号类型、用户定义的值类型、真正的泛型、按引用传递以及其他内容的加载。对于非常类似于 C# 的 JVM 语言，请查看[Stab](http://code.google.com/p/stab-language/)。

[Mainsoft](http://harmon.ie/OtherProducts)伪造它。我相信这需要他们付出巨大的努力。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-30T04:41:05.833

玩得开心。

1.  必须打破已检查的异常。
2.  必须找到一种方法来实现委托（就像在加载时间之前添加的单方法接口）。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-30T04:47:39.753

您**可以**在同一个解释器中运行您的 .NET 代码和 Java 代码！有关示例用例（使用基于 .NET 的 Boo 语言使用 Java 库编写应用程序） ，请参阅基于[IKVM](http://www.ikvm.net/) .NET 的 JVM 和[Boo 和 Java wiki 页面。](http://docs.codehaus.org/display/BOO/Boo+And+Java)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-30T05:01:18.600

乔，我建议你[调查一下 IKVM](http://www.ikvm.net/)。你可能会在那里找到能挠痒痒的东西

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-01-30T08:31:19.287

**我想您会发现[Mainsoft 企业版](http://mainsoft.com/products/vmw_j2ee.aspx)工具允许您在 Java JVM 下运行大部分/可能所有 .NET 代码**……似乎更关注 ASP.NET，但允许 C#。已经有一段时间了，可惜他们没有更好地宣传它！

警告信息如下....

> Mainsoft® 是 Java-.NET 互操作性软件，它使 IT 组织能够迁移到 Linux 等支持 Java 的平台，同时保留对 .NET 代码和技能的现有投资。该软件无缝集成到 Visual Studio® 开发环境中，使 C# 和 Visual Basic 开发人员能够快速开发和维护在 Windows、Java EE 平台或两者上运行的服务器和 Web 应用程序，从而降低应用程序开发和维护成本，缩短开发时间。生产和总拥有成本。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-03-29T02:46:53.060

如果我正在做跨平台跨语言支持之类的事情，我会创建一个“通用 api”，因为这些语言在语法上相似，你可以让翻译器变得足够简单。然后，您无需直接从核心调用 java 或 .net api，而是调用您的“common api”，这将重新实现您需要的 java 和 .net api。如果愿意，您可以通过这种方式创建一个跨语言沙箱。由于 java 和 c# 的主要区别是对象定义，我会通过反映 C# dll 来获得这些，然后重构构造，然后很容易让解释器运行并实现函数体并将属性转换为 getter setter已经知道文件的结构。这当然是假设 .net 2.0，3.0 和 3.5 中的某些功能变得非常困难'

这会很复杂，但可能不如手动在 java 中重建一个核心那么复杂，并且必须有 2 个团队单独工作。如果这个想法激发了一些灵感，我可能会创造一个。我真的宁愿看到一个更简单的稳定单声道安装 mac。

基本上，我认为基于一组常见 api 类的代码级解释器很可能在一两周内与团队一起编写。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-03-29T11:38:36.417

简单的。因为 Sun 宁愿不被微软起诉。虽然我们作为程序员可能认为没有可行的诉讼理由，但请记住，微软是一家比 Sun 大得多的公司，并且有能力控制他们。

不过幸运的是，Sun 比微软更开放。如果存在这样的需求，开源或第三方都可以为 Java 制作这个编译器，Sun 就不必承担责任。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-06-16T17:33:56.427

[JACIL](http://sourceforge.net/projects/jacil/)是一个明显已死的项目，它试图与 IKVM 相反。也许一些有动力的人可以将它作为一个可行的 .Net 到 JVM 编译器的起点。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-06-23T02:20:14.507

我想更好的问题是，如果你想要一个存在的话，你为什么不写一个 C# 到 Java 字节码编译**器**。等待企业霸主做某事是个坏主意。

创建这样一个实现的建议：采用 Mono 或 .GNU 的 C# 前端。不要费心自己写。

# jquery - jQuery的文件大小

> ID：494391
> 
> 赞同：4
> 
> 时间：2009-01-30T03:32:24.600
> 
> 标签：jquery, gzip

在jQuery的官网上，他们说压缩后的文件大小是18k，但是下载后发现是53.9K，我下载后是否需要做一些压缩？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-30T03:34:51.583

该网站声明它是 18k minified 和**gzipped**。因此，您需要设置您的 Web 服务器以压缩 JavaScript 文件以查看该文件的大小。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-30T07:03:04.160

如果您想减少服务器和访问者的带宽，您应该让[Google 为您托管 jQuery](http://code.google.com/intl/nb/apis/ajaxlibs/)。原因（来自[encosia.com](http://encosia.com/2008/12/10/3-reasons-why-you-should-let-google-host-jquery-for-you/)）：

*   降低延迟
*   增加并行度
*   更好的缓存

这是一种方法。（另一种方法是使用*google.load()*，请参见上面的链接）：

```
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.2.6/jquery.min.js"></script>
<script type="text/javascript">
  $(document).ready(function() {
    // Your code here
  });
</script> 
```

# sql - 重构 SQL（解决方法 RIGHT OUTER JOIN）

> ID：494397
> 
> 赞同：2
> 
> 时间：2009-01-30T03:36:14.670
> 
> 标签：sql, sqlite, refactoring, outer-join

由于 SQLite 不支持 RIGHT OUTER JOINS，我提出以下挑战（阅读：邀请为我工作）：

重构此查询，使其不再使用 SQLite 不支持的结构，如 RIGHT/FULL OUTER JOIN。

```
SELECT     strings.*, translations.text
FROM         translations INNER JOIN
                      language ON translations.language_id = language.id RIGHT OUTER JOIN
                      strings ON translations.string_id = strings.id
WHERE     (language.handle = 'english') 
```

我觉得它可以通过子查询或通过旋转表并执行 LEFT OUTER JOIN 来实现，但我的尝试失败了；我的 SQL 不再像以前那样了。

这是显示适用架构的查询构建器大纲：http: [//dl.getdropbox.com/u/264612/sql-refactor.PNG](http://dl.getdropbox.com/u/264612/sql-refactor.PNG)

第一个破解它会得到 dekz 的电子拥抱

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-30T03:48:37.187

以下内容未经测试。

```
select strings.*, translations.text
from strings left outer join translations
     on translations.string_id = strings.id
           and translations.language_id = (select id
                                           from language
                                           where language.handle = 'english') 
```

我认为这将为您提供具有匹配翻译文本的所有字符串，其中存在合适的英文翻译。那是你想要得到的吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-30T03:49:08.497

有趣的是，SQLite 允许左外连接但不允许右外连接。好吧，因为它确实允许左外连接，所以你是对的，你可以重新排列连接顺序：

```
SELECT     strings.*, translations.text
FROM strings LEFT OUTER JOIN (
    translations INNER JOIN language ON translations.language_id = language.id
) tr ON tr.string_id = strings.id
WHERE     (language.handle = 'english') 
```

**[编辑：应用 Blorgbeard 的命名连接表以解析查询的建议——希望它现在可以工作！]**

# wcf - 保持缓存数据在同一台机器上的不同 WPF 应用程序之间共享的最佳方法是什么？

> ID：494412
> 
> 赞同：1
> 
> 时间：2009-01-30T03:42:08.497
> 
> 标签：wcf, dataset

我正在考虑将数据保存在 WCF 托管服务的 DataSet 中，其他应用程序（在同一个盒子上）可以通过命名管道（通过 WCF 服务公开）访问数据。然后，应用程序会在其中保留一份 dataSet 副本，以便除非数据被更改，否则不会从 WCF 重新获取数据。

数据以数据行集合的形式从服务器检索，因此我将其编写为`DataTables`并将其存储为`Dataset`.

数据很少会改变，但当它改变时，我必须通知所有已检索数据的客户端应用程序进行刷新。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-30T06:30:58.157

你的解决方案会奏效。如果您有权访问适当的缓存服务，例如 ScaleOut StateServer、Velocity 或 memcached，则可以根据需要使用它。它将做同样的事情，但您将获得一个经过验证的解决方案，它具有围绕缓存管理的附加功能，以及在需要时扩展到多台机器的能力。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-01T14:59:09.703

我对自己编写的应用程序做了类似的事情。

您可以使用回调轻松让服务在数据更改时更新客户端。当客户端连接到服务时，您需要存储他们的回调信息，并且当数据更新时，您只需将消息发送给每个订阅的客户端。

这是回调的合同：

```
public interface IServiceMessageCallback
{

    [OperationContract(IsOneWay = true)]
    void OnReceivedServiceMessage(ServiceMessage serviceMessage);
} 
```

服务实现了这个接口。该服务有这个私有字段：

```
 /// <summary>
    /// Holds the callback recipients
    /// </summary>
    private List<IServiceMessageCallback> callbackMessages = 
              new List<IServiceMessageCallback>(); 
```

当客户端连接时，请执行以下操作：

```
 IServiceMessageCallback callback = 
       OperationContext.Current.GetCallbackChannel<IServiceMessageCallback>();
    callbackMessages.Add(callback); 
```

最后，无论您使用哪种方法更新服务上的数据，都应该具有以下功能：

```
 Action<IServiceMessageCallback> fire =
         delegate(IServiceMessageCallback callback)
             { callback.OnReceivedServiceMessage(serviceMessage); };

    // loop thru the callback channels and perform the action
    callbackMessages.ForEach(fire); 
```

我从我写的一个相当庞大的服务中将这段代码修补在一起......希望这些片段在上下文中有意义。

# database - 拉入动态 DBF 列

> ID：494414
> 
> 赞同：0
> 
> 时间：2009-01-30T03:45:12.670
> 
> 标签：database, dbf

我被要求拉入用于 Web 应用程序的列。我使用的是 asp.net 和 C#。我正在使用 dataReader 来填充类变量。问题是 dbf 文件可以更改。有时会添加或删除行，因此每次数据源文件更改以表示列时我的类都必须更改有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-30T04:16:51.360

解决此问题的方法有很多，您的问题由称为对象关系映射或 ORM 的一整类解决方案处理。在 Java 和 .Net 世界中，它们的绝对王者是[NHibernate](http://www.hibernate.org/343.html)。不过，这确实需要在每次数据库更改时重新构建，我使用代码生成来解决该问题，直接从数据库构建类和映射文件。然后你进入 TDD 和 CI，以确保你没有破坏任何东西，然后......

但是，如果您想要一些快速而肮脏的东西，您可以在您的类中创建一个字典并在其中存储任何额外的列。完全灵活，但您的类额外列未在类本身中定义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-07T18:18:18.143

我只是使用了一些 try/catch 块来解决这个问题。

# html - 对于现代移动设备，最好使用 WML 还是 HTML？

> ID：494426
> 
> 赞同：2
> 
> 时间：2009-01-30T03:53:07.257
> 
> 标签：html, mobile-website, wml

对于当今的现代手机，是否仍然值得用 WML 对您的网站的移动版本进行编程？

大多数移动浏览器甚至几年前都可以在常规 HTML 中正常运行。使用 WML，您显然可以更好地控制显示的内容和不显示的内容，而不必担心它不能在特定设备上运行，但是今天，随着移动浏览（iPhone、Android 等）的所有进步，真的吗？最好走这条路？

我想知道最好的选择是不是使用 HTML4 文档，它比 WML 可以做的更多花里胡哨，但不是为现代桌面浏览器设计的美化的超壮观的 AJAX 化界面.

是的，我知道，这是客观的，并且与网站受众以及我想扩展支持的程度有很大关系。为了确定这个问题的范围，我在这里主要关心的是，上述用于 HTML 的 WML 是否会破坏我的大量观众并使他们完全陷入困境。

编辑 Dr.Dredel 的观点：该网站不会被 SMS 活动或任何类似活动使用。该网站是一个用于冰球比赛的活动预订网站。一些用户目前在他们的手机上浏览它以注册不同的会话。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-30T05:01:13.610

两者都做。没有理由忽略浏览器字符串并为每个设备显示相同的标记。WML 非常简单，您可以使用模板样式（您应该已经在使用）为您的所有用户提供自定义体验，而不管他们使用什么设备。

那些拥有裸手机的人将获得一个满足他们需求的可用界面，而那些拥有 PDA 手机的人将获得一个更好的界面和更多的选择，而那些拥有 iPhone 的人甚至可能会得到令人眼花缭乱的 iPhonophiles 真正购买他们的手机。

如果您不能这样做，无论出于何种原因，请使用最小的公分母以获得最大的可见性和使用率 - 这就是使您的网站成功和有用的原因，您可以负担得起使用真正的模板系统并朝着理想状态。这很可能是 WML，尽管即使是较旧的手机也可以使用非常简单的 HTML，但它的控制和易用性功能较少。

-亚当

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-30T03:58:52.783

我认为这个问题的主要问题是它无法确定您为用户提供的确切内容是什么，这将指示从人口统计上谁会找到您的网站。

如果您的网站是通过基于 SMS 的链接（通过一些全球营销活动）到达的，那么您需要尝试覆盖尽可能广泛的受众，因为几乎所有手机都允许用户在其 SMS 客户端中单击，然后启动任何浏览器选项在那部手机上。

另一方面，如果您有一个需要手动浏览的站点，那么有一个合理的期望，即大多数简单的人不会打扰他们蹩脚的伪浏览器，因为即使输入 url 的行为也是相当的大麻烦。

我想说的是，如果您正在处理选项 B，那么您只需提供为 Netscape 1.1 之类的浏览器量身定制的体验就非常安全了（只需掸掉您在 1995 年所做的一切，您就可以开始了！:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-01T22:14:44.910

绝大多数手机用户的手机是在过去几年内购买的，任何拥有比这更早的手机的用户都不太可能希望通过手机使用互联网。就我个人而言，我认为您最好制作一个包含所有花里胡哨的高端“AJAXified”网站和一个大多数用户都可以访问的标准 XHTML-MP 网站。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-30T12:26:52.447

您应该将 XHTML-MP 用于网站的移动版本。您将获得更好的非移动版本连续性，并且可以与更多（尤其是较新）设备一起使用

# latex - 使用 \newenvironment 重新定义带参数的命令

> ID：494432
> 
> 赞同：4
> 
> 时间：2009-01-30T03:55:39.013
> 
> 标签：latex, tex

根据这个问题：

[在新环境中重新定义命令](https://stackoverflow.com/questions/486104/redefining-commands-in-a-new-environment)

如何重新定义（或使用定义`\def`）使用参数的宏？我不断收到`illegal parameter definition in \foo`错误消息。因为我需要自定义分隔符，所以我不能使用`\newcommand`or `\renewcommand`。

我的代码的一般形式如下所示：

```
\newenvironment{foo}{% 
    ...spacing stuff and counter defs...
    \def\fooitem#1\. #2\endfooitem{%
        ...stuff...
    }
    \def\endfooitem{endfoo}
}
{...after material (spacing)...} 
```

这一定是可能的。现在我使用的是纯 TeX 定义（正如我在上面的问题中提到的），但我真的很想与 LaTeX 系统保持一致。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-30T04:58:04.410

您需要将每个嵌套定义的 # 字符加倍。在内部，\newcommand 或 \newenvironment 正在调用 \def。

```
\newenvironment{foo}{% 
  ...
  \def\fooitem##1\. ##2\endfooitem{%
    ... 
```

除此之外，这是做你想做的事情的方法；没有纯 LaTeX 方法来定义带有分隔参数的宏。

# java - 假X11显示器？

> ID：494442
> 
> 赞同：15
> 
> 时间：2009-01-30T04:01:02.123
> 
> 标签：java, linux, awt, x11

我有一个使用 AWT 的 Java 程序，我想在无头系统上运行它。该程序的显示除了显示统计信息之外什么都不做。当程序完成时，它退出。显示器上没有用户交互。该程序创建一个我在构建系统中使用的输出文件。

有没有办法让 Java 程序在没有配置 X11 显示器的情况下运行？我可以强制 Java 运行程序而不尝试显示任何内容吗？我无权访问源代码（它只是 .jar 文件），所以我无法对源代码进行修改。

关于如何让它发挥作用的任何想法？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-01-30T04:41:57.720

这里的根本问题是如何在没有 X 服务器的情况下运行 Java 应用程序；提供“假”X 服务器只是一种选择。在 Java 1.4 及更高版本中，您可以执行以下操作：

```
java -Djava.awt.headless=true 
```

这允许使用 AWT 的应用程序在没有 X 服务器的情况下在无头系统上运行。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-01-30T04:09:13.060

Xvfb 可以满足您的要求。我自己没有使用过，但这里有一个维基百科的链接：[http ://en.wikipedia.org/wiki/Xvfb](http://en.wikipedia.org/wiki/Xvfb)

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-01-30T04:30:24.670

您可以使用 vncserver。

```
vncserver :1001
export DISPLAY=localhost:1001
java.. 
```

额外的好处是您实际上可以使用 vncserver '以防万一'查看 gui

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-01-30T04:11:38.653

也可以在低分辨率和颜色深度下运行 Xvnc。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-20T17:02:27.227

正如 Charles Duffy 所提到的，传统的方法是告诉 Java 去无头。

请注意，您始终可以在 Eclipse 中安装 jar 并使用 jad+jadclipse 来查看它的实际作用，如果需要，甚至可以通过在类路径中将另一个类文件放在它的“前面”来覆盖一个类。

如果程序使用 Java2D，可能相关的一个功能是较新的 Java 版本使用 X11 服务器中的优化来更快地呈现。仅此一项可能就是将连接到高性能图形卡的 X11 服务器用于图形处理的原因。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-30T05:24:41.270

我过去使用[PJA](http://www.eteks.com/pja/en/)库取得了巨大的成功，它们似乎不再被维护，但话又说回来，只是想运行......

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-07-28T04:41:51.187

我能够使用命令行参数在 OpenJFX 中获得无头模式

```
-Dglass.platform=Monocle -Dmonocle.platform=Headless -Dprism.order=sw 
```

# c++ - 无法在动态链接库 msvcrt.dll 中找到过程入口点 _wsplitpath_s

> ID：494448
> 
> 赞同：3
> 
> 时间：2009-01-30T04:03:37.843
> 
> 标签：c++, mfc, msvcrt

最近将包含 .NET 程序集的 MFC++ 项目从 Visual Studio 2005 升级到 2008。现在，无论何时安装它都会显示以下消息：

> 无法在动态链接库 msvcrt.dll 中找到过程入口点 _wsplitpath _s

我已经安装了 Microsoft Visual C++ 2008 SP1 Redistributable Package (x86)，仍然没有运气。谷歌也没有证明是很有帮助的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-30T04:34:17.097

您可能对以下 URL 感兴趣...

[http://msdn.microsoft.com/en-us/library/bb166245.aspx](http://msdn.microsoft.com/en-us/library/bb166245.aspx)

[http://blogs.msdn.com/jameslau/archive/2008/02/13/upgrading-vs-2005-packages-to-vs-2008-a-more-advanced-guide.aspx](http://blogs.msdn.com/jameslau/archive/2008/02/13/upgrading-vs-2005-packages-to-vs-2008-a-more-advanced-guide.aspx)

[http://blogs.msdn.com/quanto/archive/2008/02/19/migrating-vs-2005-packages-to-vs-2008.aspx](http://blogs.msdn.com/quanto/archive/2008/02/19/migrating-vs-2005-packages-to-vs-2008.aspx)

[http://blogs.msdn.com/quanto/archive/2008/01/19/migrating-from-vs-2005-to-vs-2008-with-microsoft-visualstudio-shell-references.aspx](http://blogs.msdn.com/quanto/archive/2008/01/19/migrating-from-vs-2005-to-vs-2008-with-microsoft-visualstudio-shell-references.aspx)

# java - 如何在java中获取java进程使用的内存

> ID：494457
> 
> 赞同：2
> 
> 时间：2009-01-30T04:09:26.757
> 
> 标签：java, memory

我正在通过部署自己的类来运行JBOSS服务器。现在我开始对我的应用程序进行一些操作。现在我想知道我的应用程序在执行操作之前和之后使用的内存。请在这方面支持我

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-30T04:18:19.827

通过使用 [MemoryMXBean](https://docs.oracle.com/javase/1.5.0/docs/api/java/lang/management/MemoryMXBean.html) （通过调用 [ManagementFactory.getMemoryMXBean()](https://docs.oracle.com/javase/1.5.0/docs/api/java/lang/management/ManagementFactory.html#getMemoryMXBean())检索）以及 [Runtime.getRuntime()](https://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Runtime.html#getRuntime())的方法： [.totalMemory()](https://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Runtime.html#totalMemory())、 [.maxMemory()](https://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Runtime.html#maxMemory()) 和 [.freeMemory()](https://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Runtime.html#freeMemory())。

请注意，这不是一门精确的艺术：在创建新对象时，可能会分配其他临时对象，这不会为您提供准确的测量结果。正如我们所知，Java 垃圾回收并不能保证，因此您不一定可以这样做来消除死对象。

如果您进行研究，您会发现大多数尝试进行这些测量的代码都会有 Runtime.gc() 调用和休眠等循环，以尝试确保测量准确。这仅适用于某些 JVM 实现......

在应用服务器/已部署的应用程序上，您可能只会在分配堆和触发 gc 时获得总测量/使用变化，但这应该足够了。[我假设您不会实现 gc() 并在生产代码中休眠 :)]

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-30T04:17:26.787

在执行 Runtime.getRuntime().freeMemory() 操作之前获取空闲内存，然后在完成操作后再次获取，您将获得操作使用的内存。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-25T22:13:56.260

你可能会发现你得到的结果是不确定的。GC 将在后台随机点清理已使用的内存，因此您可能会发现，如果您多次运行相同的操作，您会得到不同的结果。您甚至可以在执行操作后似乎有更多可用内存。

# wcf - 将 CCR 与 A同步 WCF 服务一起使用

> ID：494463
> 
> 赞同：2
> 
> 时间：2009-01-30T04:12:27.717
> 
> 标签：wcf, asynchronous, ccr

我正在学习如何将 CCR（并发和协调运行时）与异步 WCF Web 服务结合使用。

这是测试 WCF 服务：

```
 public class Service : IService
    {
        private Accounts.Manager accountManager = new Accounts.Manager();
        public IAsyncResult BeginGetAccount(int id, AsyncCallback callback, object state)
        {
            //How Do I Call the CCR Function without blocking a Thread?
            throw new NotImplementedException();
        }

        public string EndGetAccount(IAsyncResult result)
        {
            //How Do I Finish the Call and Pass back the Result?
            throw new NotImplementedException();
        }
    } 
```

它需要一个 ID 号并返回匹配的帐户名称（如果有）

我编写了一个 CCR 函数，它应该找到匹配的帐户（显然需要大量工作 - 这只是概念证明）这是我遇到的问题。

如何传回结果（全局端口？）更重要的是：如何在不阻塞线程的情况下将 CCR 插入 WCF 异步服务调用？

```
public IEnumerator<ITask> GetAccount(int id)
    {
        SqlDataReader reader = null; 
        SqlConnection connection = new SqlConnection(@"Data Source=.\SQLEXPRESS;Initial Catalog=BizData;Integrated Security=True;Async=True;"); 
        string query = "SELECT * FROM Account WHERE AccountID = @AccountID"; 
        SqlCommand command = new SqlCommand(query, connection);
        SqlParameter accountID = new SqlParameter("AccountID", id);
        command.Parameters.Add(accountID);

        connection.Open(); 
        yield return Arbiter.Choice(SQLAdapter.GetReader(command), 
            delegate(SqlDataReader r) { reader = r; }, 
            delegate(Exception e) { Console.Write("Failed to get SQL data"); }); 

        if (reader == null) yield break;       

        while (reader.Read())       
        {
            Account account = new Account { ID = Convert.ToInt32(reader["AccountID"]), 
                Name = reader["Account"].ToString(), 
                ParkingNo = Convert.ToInt32(reader["ParkingNo"]), 
                Password = reader["Password"].ToString() };
            //Post account?
        }
        connection.Close(); 
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-03T22:43:13.540

好的，我终于找到了所有这些的地方！

首先：您需要一个自定义 AsyncResult 类

```
class AsyncResult : IAsyncResult , IDisposable
    {
        object _state;
        ManualResetEvent _waitHandle = new ManualResetEvent(false);
        bool _isCompleted;

        #region IAsyncResult Members
        public object AsyncState
        {
            get { return _state; }
        }

        public System.Threading.WaitHandle AsyncWaitHandle
        {
            get { return _waitHandle; }
        }

        public bool CompletedSynchronously
        {
            get { return false; }
        }

        public bool IsCompleted
        {
            get { return _isCompleted; }
        }
        #endregion

        Exception _exception;
        internal Exception Exception
        {
            get { return _exception; }
        }

        Accounts.Account _result;
        internal Accounts.Account Result
        {
            get { return _result; }
        }

        internal AsyncResult(PortSet<Accounts.Account, Exception> port, DispatcherQueue queue, AsyncCallback callback, object state)
        {
            _state = state;

            Arbiter.Activate(queue,
                Arbiter.Choice(port,
                    r =>
                    {
                        _result = r;
                        Complete(callback);
                    },
                    e =>
                    {
                        _exception = e;
                        Complete(callback);
                    }
                )
            );
        }

        private void Complete(AsyncCallback callback)
        {
            _isCompleted = true;
            _waitHandle.Set();

            if (callback != null)
            {
                ThreadPool.QueueUserWorkItem(s => callback(this));
            }
        }

        private bool disposedValue = false;

        public void Dispose()
        {
            if (!this.disposedValue)
            {
                _waitHandle.Close();
                _waitHandle = null;
                _state = null;
            }
            this.disposedValue = true;
        }
    } 
```

好的，那么我们需要将其与 Async WCF 方法调用联系起来：

```
public class Service : IService
    {
        private Dispatcher dispatcher;
        private DispatcherQueue dq;

        public Service() 
        {
             dispatcher = new Dispatcher();
             dq = new DispatcherQueue("CCR DispatcherQueue", dispatcher);
        }

        public IAsyncResult BeginGetAccount(int id, AsyncCallback callback, object state)
        {
            PortSet<Accounts.Account, Exception> port = new PortSet<Accounts.Account, Exception>();
            Accounts.Manager manager = new Accounts.Manager();
            manager.GetAccountData(dq, port, id);

            AsyncResult result = new AsyncResult(port, dq, callback, state);
            return result;
        }

        public string EndGetAccount(IAsyncResult result)
        {
            {
                var AccountName = string.Empty;
                if ((result != null))
                {
                    using (Common.AsyncResult asyncResult = result as Common.AsyncResult)
                    {

                        if (asyncResult == null)
                        {
                            throw new NullReferenceException("IAsynchResult Parameter is Null");
                        }

                        asyncResult.AsyncWaitHandle.WaitOne();
                        if (asyncResult.Result != null) 
                        { 
                            AccountName = asyncResult.Result.Name; 
                        }
                    }
                }
                return AccountName;
            }
        }
    } 
```

然后你只需要 IEnumerator 方法将答案发布到端口

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-06T18:35:10.370

有关端到端示例，请参阅此博客：

[使用 CCR 的 WCF 服务的异常处理、排队和 UI 同步](http://thevalerios.net/matt/2008/11/exception-handling-queuing-and-ui-synchronization-for-wcf-services-using-the-ccr/)

# java - 如何从 Java 枚举所有启用的 NIC 卡的 IP 地址？

> ID：494465
> 
> 赞同：46
> 
> 时间：2009-01-30T04:13:36.577
> 
> 标签：java, networking, ip-address

缺少解析的输出`ipconfig`，有没有人有 100% 纯 java 的方式来做到这一点？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-01-30T04:18:33.353

这很容易：

```
try {
  InetAddress localhost = InetAddress.getLocalHost();
  LOG.info(" IP Addr: " + localhost.getHostAddress());
  // Just in case this host has multiple IP addresses....
  InetAddress[] allMyIps = InetAddress.getAllByName(localhost.getCanonicalHostName());
  if (allMyIps != null && allMyIps.length > 1) {
    LOG.info(" Full list of IP addresses:");
    for (int i = 0; i < allMyIps.length; i++) {
      LOG.info("    " + allMyIps[i]);
    }
  }
} catch (UnknownHostException e) {
  LOG.info(" (error retrieving server host name)");
}

try {
  LOG.info("Full list of Network Interfaces:");
  for (Enumeration<NetworkInterface> en = NetworkInterface.getNetworkInterfaces(); en.hasMoreElements();) {
    NetworkInterface intf = en.nextElement();
    LOG.info("    " + intf.getName() + " " + intf.getDisplayName());
    for (Enumeration<InetAddress> enumIpAddr = intf.getInetAddresses(); enumIpAddr.hasMoreElements(); ) {
      LOG.info("        " + enumIpAddr.nextElement().toString());
    }
  }
} catch (SocketException e) {
  LOG.info(" (error retrieving network interface list)");
} 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-01-30T04:38:30.630

其中一些仅适用于 JDK 1.6 及更高版本（该版本中添加了其中一种方法。）

```
List<InetAddress> addrList = new ArrayList<InetAddress>();
for(Enumeration<NetworkInterface> eni = NetworkInterface.getNetworkInterfaces(); eni.hasMoreElements(); ) {
   final NetworkInterface ifc = eni.nextElement();
   if(ifc.isUp()) {
      for(Enumeration<InetAddress> ena = ifc.getInetAddresses(); ena.hasMoreElements(); ) {
        addrList.add(ena.nextElement());
      }
   }
} 
```

在 1.6 之前，这有点困难——直到那时才支持 isUp()。

FWIW：[Javadocs](http://java.sun.com/javase/6/docs/api/java/net/NetworkInterface.html#getNetworkInterfaces())指出，这是获取节点所有 IP 地址的正确方法：

> 注意：可以使用 getNetworkInterfaces()+getInetAddresses() 获取该节点的所有 IP 地址

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-30T13:51:46.080

由于添加了 InterfaceAddress 代码，此代码仅适用于 Java 1.6。

```
 try
  {
     System.out.println("Output of Network Interrogation:");
     System.out.println("********************************\n");

     InetAddress theLocalhost = InetAddress.getLocalHost();
     System.out.println(" LOCALHOST INFO");
     if(theLocalhost != null)
     {
        System.out.println("          host: " + theLocalhost.getHostName());
        System.out.println("         class: " + theLocalhost.getClass().getSimpleName());
        System.out.println("            ip: " + theLocalhost.getHostAddress());
        System.out.println("         chost: " + theLocalhost.getCanonicalHostName());
        System.out.println("      byteaddr: " + toMACAddrString(theLocalhost.getAddress()));
        System.out.println("    sitelocal?: " + theLocalhost.isSiteLocalAddress());
        System.out.println("");
     }
     else
     {
        System.out.println(" localhost was null");
     }

     Enumeration<NetworkInterface> theIntfList = NetworkInterface.getNetworkInterfaces();
     List<InterfaceAddress> theAddrList = null;
     NetworkInterface theIntf = null;
     InetAddress theAddr = null;

     while(theIntfList.hasMoreElements())
     {
        theIntf = theIntfList.nextElement();

        System.out.println("--------------------");
        System.out.println(" " + theIntf.getDisplayName());
        System.out.println("          name: " + theIntf.getName());
        System.out.println("           mac: " + toMACAddrString(theIntf.getHardwareAddress()));
        System.out.println("           mtu: " + theIntf.getMTU());
        System.out.println("        mcast?: " + theIntf.supportsMulticast());
        System.out.println("     loopback?: " + theIntf.isLoopback());
        System.out.println("          ptp?: " + theIntf.isPointToPoint());
        System.out.println("      virtual?: " + theIntf.isVirtual());
        System.out.println("           up?: " + theIntf.isUp());

        theAddrList = theIntf.getInterfaceAddresses();
        System.out.println("     int addrs: " + theAddrList.size() + " total.");
        int addrindex = 0;
        for(InterfaceAddress intAddr : theAddrList)
        {
           addrindex++;
           theAddr = intAddr.getAddress();
           System.out.println("            " + addrindex + ").");
           System.out.println("            host: " + theAddr.getHostName());
           System.out.println("           class: " + theAddr.getClass().getSimpleName());
           System.out.println("              ip: " + theAddr.getHostAddress() + "/" + intAddr.getNetworkPrefixLength());
           System.out.println("           bcast: " + intAddr.getBroadcast().getHostAddress());
           int maskInt = Integer.MIN_VALUE >> (intAddr.getNetworkPrefixLength()-1);
           System.out.println("            mask: " + toIPAddrString(maskInt));
           System.out.println("           chost: " + theAddr.getCanonicalHostName());
           System.out.println("        byteaddr: " + toMACAddrString(theAddr.getAddress()));
           System.out.println("      sitelocal?: " + theAddr.isSiteLocalAddress());
           System.out.println("");
        }
     }
  }
  catch (SocketException e)
  {
     e.printStackTrace();
  }
  catch (UnknownHostException e)
  {
     e.printStackTrace();
  } 
```

“toMACAddrString”方法如下所示：

```
public static String toMACAddrString(byte[] a)
{
  if (a == null)
  {
     return "null";
  }
  int iMax = a.length - 1;

  if (iMax == -1)
  {
     return "[]";
  }

  StringBuilder b = new StringBuilder();
  b.append('[');
  for (int i = 0;; i++)
  {
     b.append(String.format("%1$02x", a[i]));

     if (i == iMax)
     {
        return b.append(']').toString();
     }
     b.append(":");
  }
} 
```

“toIPAddrString”方法在这里：

```
public static String toIPAddrString(int ipa)
{
   StringBuilder b = new StringBuilder();
   b.append(Integer.toString(0x000000ff & (ipa >> 24)));
   b.append(".");
   b.append(Integer.toString(0x000000ff & (ipa >> 16)));
   b.append(".");
   b.append(Integer.toString(0x000000ff & (ipa >> 8)));
   b.append(".");
   b.append(Integer.toString(0x000000ff & (ipa)));
   return b.toString();
} 
```

我在上面的 try/catch 中有第一组代码，在名为 IPConfig 的类中名为 dump() 的方法中。然后我只是在 IPConfig 中放置一个 main 方法来调用 new IPConfig().dump() 以便当我试图找出一些古怪的网络问题时，我可以看到 Java 认为正在发生的事情。我发现我的 Fedora 盒子报告的 LocalHost 信息与 Windows 不同，这导致我的 Java 程序出现了一些问题。

我意识到它与其他答案相似，但它打印出几乎所有有趣的东西，你可以从界面和 ipaddress apis 中获得。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-03-26T15:28:20.687

### 更新以修复 Jared 对 JDK 1.7 的回答。

```
// Get list of IP addresses from all local network interfaces. (JDK1.7)
// -----------------------------------------------------------
public List<InetAddress> getListOfIPsFromNIs(){
    List<InetAddress> addrList           = new ArrayList<InetAddress>();
    Enumeration<NetworkInterface> enumNI = NetworkInterface.getNetworkInterfaces();
    while ( enumNI.hasMoreElements() ){
        NetworkInterface ifc             = enumNI.nextElement();
        if( ifc.isUp() ){
            Enumeration<InetAddress> enumAdds     = ifc.getInetAddresses();
            while ( enumAdds.hasMoreElements() ){
                InetAddress addr                  = enumAdds.nextElement();
                addrList.add(addr);
                System.out.println(addr.getHostAddress());   //<---print IP
            }
        }
    }
    return addrList;
} 
```

正如 Sam Skuce 评论所强调的：

> 这不能在 JDK 1.7 中编译。getNetworkInterfaces 返回一个未实现 Iterable 的枚举。– Sam Skuce 2012 年 7 月 11 日 19:58

### 输出示例：

```
fe80:0:0:0:800:aaaa:aaaa:0%8
192.168.56.1
fe80:0:0:0:227:aaa:aaaa:6b5%2
123.123.123.123
0:0:0:0:0:0:0:1%1
127.0.0.1 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-04-14T09:03:54.523

```
import java.net.*;
import java.util.*;

public class NIC {

public static void main(String args[]) throws Exception {

    List<InetAddress> addrList = new ArrayList<InetAddress>();
    Enumeration<NetworkInterface> interfaces = null;
    try {
        interfaces = NetworkInterface.getNetworkInterfaces();
    } catch (SocketException e) {
        e.printStackTrace();
    }

    InetAddress localhost = null;

    try {
        localhost = InetAddress.getByName("127.0.0.1");
    } catch (UnknownHostException e) {
        e.printStackTrace();
    }

    while (interfaces.hasMoreElements()) {
        NetworkInterface ifc = interfaces.nextElement();
        Enumeration<InetAddress> addressesOfAnInterface = ifc.getInetAddresses();

        while (addressesOfAnInterface.hasMoreElements()) {
            InetAddress address = addressesOfAnInterface.nextElement();

            if (!address.equals(localhost) && !address.toString().contains(":")) {
                addrList.add(address);
                System.out.println("FOUND ADDRESS ON NIC: " + address.getHostAddress());
            }
        }
    }

}
} 
```

# c# - RTF 字符串中使用的两种编码在 RichTextBox 中显示不正确？

> ID：494470
> 
> 赞同：0
> 
> 时间：2009-01-30T04:16:20.907
> 
> 标签：c#, encoding, richtextbox, hex, rtf

我正在尝试解析一些从服务器返回的 RTF。对于我得到的大多数文本，这工作正常（并且使用 RichTextBox 控件可以完成这项工作），但是一些 RTF 似乎包含额外的“编码”并且一些字符被损坏。

原始字符串如下（并包含一些波兰语中使用的字符）：

```
ąćęłńóśźż 
```

发回的带有十六进制编码字符的 RTF 字符串如下所示

```
{\lang1045\langfe1045\f16383 {\'b9\'e6\'ea\'b3{\f7 \'a8\'bd\'a8\'ae}\'9c\'9f\'bf}} 
```

我在解码返回字符串中的**ñó**字符时遇到问题，它们似乎每个都由两个十六进制值表示，而字符串的其余部分（如预期的那样）由单个十六进制值表示。

使用 RichTextBox 控件“解析”RTF 会导致文本损坏（有问题的两个字符显示为四个不同的不需要的字符）。

如果我自己使用预期的代码页（1250，Latin 2，lcid 1045 的 ANSI 代码页）将纯字符串编码为十六进制，我将得到以下信息：

```
\'B9\'E6\'EA\'B3\'F1\'F3\'9C\'9F\'BF 
```

我不知道如何正确解码应该对应于**ńó的返回字符串的****{\f7 \'a8\'bd\'a8\'ae}**部分。

 **请注意，在 RTF 标头中没有**\f7**的字体定义，当直接在服务器上查看时，字符串看起来很好，这意味着字符（如果它们已损坏）在发送前的转换中某处已损坏。

我不确定问题是否出在服务器端（因为我无法控制），但由于服务器用于大量翻译工作，我假设返回的字符串是可以的。

我一直在阅读 RTF 规范，但找不到关于这种类型的编码组合的任何提示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-30T23:58:33.407

我不知道为什么会这样，但编码似乎是[GBK](http://en.wikipedia.org/wiki/GBK)（或类似的东西）。

也许服务器会尝试做一些“聪明”的匹配来查找字符，或者服务器的默认字符编码是 GBK 左右，而这些字符（并且只有那些）也出现在 GBK 中，所以它更喜欢那样。

我通过将有问题的十六进制代码`A8 BD A8 AE`（

```
<html><body>¨½¨®</body></html> 
```

令我惊讶的是，我的浏览器立即提出了“ńó”。

# c# - 如何从 C# 中的字符串名称中获取对控件的引用

> ID：494487
> 
> 赞同：1
> 
> 时间：2009-01-30T04:27:54.067
> 
> 标签：c#, asp.net, visual-studio, controls, visual-web-developer

如何从 C# 中的字符串名称中获取对控件的引用？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-30T04:31:56.257

[`Page.FindControl`](http://msdn.microsoft.com/en-us/library/31hxzsdw.aspx)

如果控件是嵌套的，`Control.FindControl`请从父控件中使用。否则，您必须编写自己的[FindControlRecursive](https://blog.codinghorror.com/recursive-pagefindcontrol/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-04-29T17:54:47.420

```
 private Control FindControlRecursive(Control root, string id)
        {
            return root.ID == id
                       ? root
                       : (root.Controls.Cast<Control>()
                             .Select(c => FindControlRecursive(c, id)))
                             .FirstOrDefault(t => t != null);
        } 
```

# testing - 什么是测试中的软件故障？

> ID：494498
> 
> 赞同：9
> 
> 时间：2009-01-30T04:38:42.360
> 
> 标签：testing

我正在上软件测试的研究生课程，我们花了一整堂课来讨论错误、错误和失败之间的区别。我对测试中软件故障的定义不满意。你的定义是什么？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-01-30T05:11:54.617

您可能对这个[SE Radio](http://www.se-radio.net/podcast/2007-11/episode-77-fault-tolerance-bob-hanmer-pt-1)播客感兴趣，其中 iirc 被描述为：

*   错误：代码中的实际“错误”
*   错误：由故障导致的系统中的不良状态。
*   失败：由于错误导致用户观察到的预期行为的变化。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-30T07:58:03.923

当观察到的行为与预期的行为不同时，就会发生**故障。**请注意，引用是预期的行为，而不是规范，因为即使规范也可能是错误的。

**错误**是系统状态中可能导致故障的部分。

**错误**是错误的原因。软件故障在于软件，硬件故障在于硬件。

[您可以在Dependabilty 及其威胁：分类法](http://rodin.cs.ncl.ac.uk/Publications/avizienis.pdf)中找到对可靠性概念的深入概述，作者为 Algirdas Avižienis、Jean-Claude Laprie 和 Brian Randell。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-30T05:06:01.540

根据 ISQTB，故障就是缺陷。缺陷的定义如下：

**缺陷：**组件或系统中可能导致组件或系统无法执行其所需功能的缺陷，例如不正确的语句或数据定义。如果在执行过程中遇到缺陷，可能会导致组件或系统出现故障。

**失败：**组件或系统与其预期交付、服务或结果的偏差。

基本上，缺陷、错误和错误是相同的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-30T05:18:04.917

实际上，这并不重要。学术论文往往随处可见他们使用的术语。在工业中，更肯定没有一个公认的定义。此外，业内没有人关心可能会有什么不同。故障、错误、失败、错误，它们的处理方式都差不多。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-11-26T12:51:05.680

错误---这可能是人为错误，即对需求和规范的误解

故障----错误导致故障

如果开发人员误解了需求，那么他应该按照他的理解进行编码，这会导致实际代码中的错误。

故障----故障导致故障

如果开发人员编码错误，那么 s/w 应该给出不正确的 o/p，这可能导致应用程序失败。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-22T04:31:54.607

测试中的故障类型有：

*   业务逻辑（B）：与需求相关的故障
*   功能和逻辑（F）：与功能和逻辑相关的故障
*   外观 (L)：与 GUI 相关的故障
*   性能（P）：与性能相关的故障
*   可恢复性 (R)
*   安全性 (S)
*   复制（RL）：与数据复制相关的故障

    不理解

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-02-20T11:10:37.960

错误：计算的、观察的或测量的值或条件与真实的、指定的或理论上正确的值或条件之间的差异。这可能是对软件内部状态的误解、内存管理方面的疏忽、对计算值的正确方法的混淆等等。

失败：系统或组件无法在规定的性能要求内执行其所需的功能。请参阅：错误、崩溃、异常和故障。

错误：程序中的错误导致程序以非预期或未预料的方式执行。请参阅：异常、缺陷、错误、异常和故障。Bug 是 Tester 的术语。

故障：计算机程序中不正确的步骤、过程或数据定义，导致程序以非预期或未预料的方式执行。请参阅：错误、缺陷、错误、异常。

缺陷：通常是指软件产品、其外部行为或内部特性的若干故障。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-07-03T12:52:20.467

错误：程序员犯了一个错误（也称为错误）

缺陷：程序员在代码中引入了一个错误（也称为缺陷）。

错误：测试人员执行包含错误的软件部分。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-02-20T09:37:38.683

**事件**：-当测试人员观察到应用程序中的任何差异时，这将是一个事件。

**错误/缺陷**：-当开发人员确认事件时，这将是一个错误。

**错误**：-当应用程序中存在错误时，它将是错误。

**失败**：-当错误导致系统失败时，它被称为失败。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-04-14T03:25:00.073

软件测试视角意味着将自己视为软件测试员，并且您正在测试现成的软件。首先，您将对其进行测试并发现故障（缺陷）。您将检查与实际预期状态不同的软件状态，这是一个错误。此错误可能会导致您失败。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-07-29T09:25:13.633

软件故障是导致系统无法执行其所需功能的情况。故障是软件故障的基本原因，是常用术语错误的同义词。

# php - 函数与对象最佳实践

> ID：494501
> 
> 赞同：6
> 
> 时间：2009-01-30T04:40:03.607
> 
> 标签：php, function, object

我想知道关于函数和对象的最佳实践是什么。例如，我想执行一个名为 tidy 的操作。它将我的数据作为输入并整理并返回。

现在我可以通过两种方式做到这一点。一个使用简单函数，另一个使用类。

```
Function: $data = tidy($data);
Class:
$tidy = new Tidy();
$data = $tidy->clean($tidy); 
```

现在使它成为一个类的好处是我以前不必加载该类。我可以简单地使用 php 的自动加载功能来做到这一点。

另一个例子是数据库类。现在每个人似乎都在为数据库连接使用单独的类。但是我们通常只有那个类的一个对象。从某种意义上说，这不是与类和对象的定义相反，我们只是使用类来实例化单个对象吗？

我有点不明白何时使用函数以及何时使用类。关于相同的最佳做法是什么？有什么指导方针吗？

谢谢你，亚历克

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-30T07:09:03.400

对于做一件事，而且只做一件事的东西，我只会使用一个函数。任何更复杂的东西，我会考虑使用一个对象。

我花时间浏览了一堆（可以说是丑陋和可怕的）PHP代码，实际上，有些事情本可以*作为*对象完成，但被保留为函数。时间转换和字符串替换。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-30T08:01:15.477

*   函数通常执行一项特定任务。

*   对象表示具有与之关联的任务的事物。（方法）

使用函数`tidy`。干净利落。`;-)`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-30T05:01:43.950

我会亲自制作一个处理数据的“数据”对象，然后在它下面有一个整洁的方法。

这种模式将允许您在数据上执行的任务数量扩大，同时将其全部包含在一个漂亮的小自包含块中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-30T07:28:51.550

对于您的情况，我会将其设为函数，可能是“util”类中的静态函数（该类的唯一目的是充当命名空间 - 它将所有随机有用的方法组合在一起）。根据经验，只有在需要存储一些需要在多个函数调用之间存在的数据时才使用对象。这就是为什么将数据库方法作为对象的一部分，因为它们存储了一个数据库句柄，该句柄在多个函数调用之间使用。是的，只有一个数据库对象，但是将它作为一个对象将所有与数据库相关的东西集中到一个地方，从而更容易维护和保持无错误。

# algorithm - 查找具有特定子集的集合

> ID：494502
> 
> 赞同：4
> 
> 时间：2009-01-30T04:40:09.050
> 
> 标签：algorithm, dataset, set, subset

我是一名物理学研究生，我正在编写一些代码来对数百 GB 的数据进行排序，并在我要求时返回该数据的切片。这是诀窍，我不知道排序和搜索这种数据的好方法。

我的数据本质上由大量的数字组成。这些集合中可以包含 1 到 n 个数字（尽管在 99.9% 的集合中，n 小于 15）并且这些集合中大约有 1.5 到 20 亿个（不幸的是，这个大小排除了蛮力搜索）。

我需要能够指定一个包含 k 个元素的集合，并让每个包含 k+1 个元素或更多元素的集合返回给我。

简单示例：
假设我的数据有以下集合：
(1,2,3)
(1,2,3,4,5)
(4,5,6,7)
(1,3,8,9)
( 5,8,11)

如果我提出请求 (1,3)，我将拥有以下集合：(1,2,3)、(1,2,3,4,5) 和 (1,3,8,9)。
请求 (11) 将返回集合：(5,8,11)。
请求 (1,2,3) 将返回集合：(1,2,3) 和 (1,2,3,4,5)
请求 (50) 将不返回集合：

现在模式应该很清楚了。这个例子和我的数据的主要区别是我的数据的集合更大，集合中每个元素使用的数字从 0 到 16383（14 位），还有很多很多很多的集合。

如果重要的话，我会用 C++ 编写这个程序，尽管我也知道 java、c、一些程序集、一些 fortran 和一些 perl。

有没有人知道如何解决这个问题？

编辑：
回答几个问题并补充几点：

1.) 数据不变。这一切都是在一组很长的运行中完成的（每个运行分为 2 个演出文件）。

2.) 至于存储空间。原始数据占用大约 250 GB。我估计，在处理和剥离了很多我不感兴趣的无关元数据之后，我可以将其降低到 36 到 48 GB 之间，具体取决于我决定保留多少元数据（没有索引）。此外，如果在我对数据的初始处理中遇到足够多的相同集合，我可能能够通过添加重复事件的计数器来进一步压缩数据，而不是简单地一遍又一遍地重复事件。

3.) Each number within a processed set actually contains at LEAST two numbers 14 bits for the data itself (detected energy) and 7 bits for metadata (detector number). So I will need at LEAST three bytes per number.

4.) My "though in 99.9% of the sets, n is less than 15" comment was misleading. In a preliminary glance through some of the chunks of the data I find that I have sets that contain as many as 22 numbers but the median is 5 numbers per set and the average is 6 numbers per set.

5.) While I like the idea of building an index of pointers into files I am a bit leery because for requests involving more than one number I am left with the semi slow task (at least I think it is slow) of finding the set of all pointers common to the lists, ie finding the greatest common subset for a given number of sets.

6.) In terms of resources available to me, I can muster approximately 300 gigs of space after I have the raw data on the system (The remainder of my quota on that system). The system is a dual processor server with 2 quad core amd opterons and 16 gigabytes of ram.

7.) Yes 0 can occur, it is an artifact of the data acquisition system when it does but it can occur.

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-30T05:55:28.790

Your problem is the same as that faced by search engines. "I have a bajillion documents. I need the ones which contain this set of words." You just have (very conveniently), integers instead of words, and smallish documents. The solution is an [inverted index](http://en.wikipedia.org/wiki/Inverted_index). [Introduction to Information Retrieval](http://www-csli.stanford.edu/~hinrich/information-retrieval-book.html) by Manning et al is (at that link) available free online, is very readable, and will go into a lot of detail about how to do this.

You're going to have to pay a price in disk space, but it can be parallelized, and should be more than fast enough to meet your timing requirements, once the index is constructed.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-30T04:58:12.803

Assuming a random distribution of 0-16383, with a consistent 15 elements per set, and two billion sets, each element would appear in approximately 1.8M sets. Have you considered (and do you have the capacity for) building a 16384x~1.8M (30B entries, 4 bytes each) lookup table? Given such a table, you could query which sets contain (1) and (17) and (5555) and then find the intersections of those three ~1.8M-element lists.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-30T05:24:06.887

My guess is as follows.

Assume that each set has a name or ID or address (a 4-byte number will do if there are only 2 billion of them).

Now walk through all the sets once, and create the following output files:

*   A file which contains the IDs of all the sets which contain '1'
*   A file which contains the IDs of all the sets which contain '2'
*   A file which contains the IDs of all the sets which contain '3'
*   ... etc ...

If there are 16 entries per set, then on average each of these 2^16 files will contain the IDs of 2^20 sets; with each ID being 4 bytes, this would require 2^38 bytes (256 GB) of storage.

You'll do the above once, before you process requests.

When you receive requests, use these files as follows:

*   Look at a couple of numbers in the request
*   Open up a couple of the corresponding index files
*   Get the list of all sets which exist in both these files (there's only a million IDs in each file, so this should't be difficult)
*   See which of these few sets satisfy the remainder of the request

My guess is that if you do the above, creating the indexes will be (very) slow and handling requests will be (very) quick.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-09-11T03:37:10.517

I have recently discovered methods that use Space Filling curves to map the multi-dimensional data down to a single dimension. One can then index the data based on its 1D index. Range queries can be easily carried out by finding the segments of the curve that intersect the box that represents the curve and then retrieving those segments.

I believe that this method is far superior to making the insane indexes as suggested because after looking at it, the index would be as large as the data I wished to store, hardly a good thing. A somewhat more detailed explanation of this can be found at:

[http://www.ddj.com/184410998](http://www.ddj.com/184410998)
and
[http://www.dcs.bbk.ac.uk/~jkl/publications.html](http://www.dcs.bbk.ac.uk/~jkl/publications.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-30T16:44:02.443

Make 16383 index files, one for each possible search value. For each value in your input set, write the file position of the start of the set into the corresponding index file. It is important that each of the index files contains the same number for the same set. Now each index file will consist of ascending indexes into the master file.

To search, start reading the index files corresponding to each search value. If you read an index that's lower than the index you read from another file, discard it and read another one. When you get the same index from all of the files, that's a match - obtain the set from the master file, and read a new index from each of the index files. Once you reach the end of any of the index files, you're done.

If your values are evenly distributed, each index file will contain 1/16383 of the input sets. If your average search set consists of 6 values, you will be doing a linear pass over 6/16383 of your original input. It's still an O(n) solution, but your n is a bit smaller now.

P.S. Is zero an impossible result value, or do you really have 1638**4** possibilities?

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-30T05:49:37.740

Just playing devil's advocate for an approach which includes brute force + index lookup :

1.  Create an index with the min , max and no of elements of sets.
2.  Then apply brute force excluding sets where max < max(set being searched) and min > min (set being searched)
3.  In brute force also exclude sets whole element count is less than that of the set being searched.

95% of your searches would really be brute forcing a very smaller subset. Just a thought.

# design-patterns - 处理嵌套的 if then else/嵌套 switch 语句

> ID：494506
> 
> 赞同：11
> 
> 时间：2009-01-30T04:41:30.343
> 
> 标签：design-patterns, nested

是否有任何设计模式/方法/方法来删除嵌套的 if then else 条件/switch 语句？

我记得在一篇谷歌代码博客文章中遇到过谷歌人员使用的一些方法。不过现在好像找不到了

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-30T04:57:29.793

你读过Coding Horror 的扁平化箭头代码吗[？](http://www.codinghorror.com/blog/archives/000486.html)

如果您使用的语言没有例外，则可以将 throw 替换为 return 或 goto。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-30T04:49:46.033

您想使用重构来替换使用多态类的条件。例如. [_](http://www.refactoring.com/catalog/replaceConditionalWithPolymorphism.html)

或者这是另一个[例子](http://sourcemaking.com/refactoring/replace-conditional-with-polymorphism)

本质上，理想非常简单，您创建一个对象层次结构，并将各种行为移动到一个覆盖的方法中。您仍然需要一种方法来创建正确的类，但这可以使用工厂模式来完成。

# 编辑

让我补充一点，这并不是在每种情况下都是完美的解决方案。正如（对不起，我忘记了你的名字）在我的评论中指出的那样，有时这可能会很痛苦，特别是如果你必须创建一个对象模型来做到这一点。如果你有这个，这个重构会很出色：

```
function doWork(object x)
{

   if (x is a type of Apple)
   {
      x.Eat();

   } else if (x is a type of Orange)
   {
      x.Peel();
      x.Eat();
   }

} 
```

在这里，您可以将开关重构为每个水果都可以处理的一些新方法。

# 编辑

正如有人指出你如何创建正确的类型来进入 doWork，有更多的方法可以解决这个问题，然后我可能会列出一些基本的方法。第一个也是最直接的（是的，这与这个问题的本质背道而驰）是一个开关：

```
class FruitFactory
{
   Fruit GetMeMoreFruit(typeOfFruit)
   {
         switch (typeOfFruit)
         ...
         ...
   }
} 
```

这种方法的好处是它很容易编写，通常是我使用的第一种方法。虽然您仍然有一个 switch 语句，但它与一个代码区域隔离，并且非常基本，它返回的只是一个对象。如果您只有几个对象并且它们不更改，则效果很好。

您可以研究的其他更复杂的模式是[Abstract Factory](http://en.wikipedia.org/wiki/Abstract_factory_pattern)。如果您的平台支持，您也可以动态创建 Fruit。您也可以使用[Provider Pattern](http://en.wikipedia.org/wiki/Provider_pattern)之类的东西。这对我来说本质上意味着你配置你的对象，然后你有一个基于配置的工厂和一个你给工厂动态创建正确类的键。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-30T04:58:15.347

实际上，我在 2008 年 4 月的博客中写过如何解决这个问题。看看[这里](http://adotnetdude.blogspot.com/2008/03/refactoring-code-with-too-many.html)，让我知道你的想法。

我推荐你：

1.  使用多态性在没有条件语句的情况下获得所需的正确运行时行为。

2.  获取所有条件语句，并将它们移动到某种“工厂”中，它将在运行时为您提供适当的类型。

3.  你完成了。那不是很容易吗？:)

如果您想查看一些有关如何转换代码的实际代码示例，请访问我的博客。

*PS这不是一次廉价的自我推销尝试；很长时间以来，我一直是 SO 用户，这是我第一次链接到我的博客 - 我这样做只是因为我认为它是相关的。*

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-30T05:00:08.870

你在想 Google 的“ [The Clean Code Talks -- Inheritance, Polymorphism, & Testing](http://www.youtube.com/watch?v=4F72VULWFvc) ”视频吗？它讨论了使用面向对象技术来删除 if/switch 条件的方法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-30T04:56:00.280

你没有说你使用的是什么语言，但如果你使用的是 OO 语言，例如 C++、C# 或 Java，你通常可以使用**虚函数**`switch`来解决与当前使用语句解决相同的问题，并且在一种更可扩展的方式。在 C++ 的情况下，比较：

```
class X {
public:
    int get_type();     /* Or an enum return type or similar */
    ...
};

void eat(X& x) {
    switch (x.get_type()) {
    TYPE_A: eat_A(x); break;
    TYPE_B: eat_B(x); break;
    TYPE_C: eat_C(x); break;
    }
}

void drink(X& x) {
    switch (x.get_type()) {
    TYPE_A: drink_A(x); break;
    TYPE_B: drink_B(x); break;
    TYPE_C: drink_C(x); break;
    }
}

void be_merry(X& x) {
    switch (x.get_type()) {
    TYPE_A: be_merry_A(x); break;
    TYPE_B: be_merry_B(x); break;
    TYPE_C: be_merry_C(x); break;
    }
} 
```

和

```
class Base {
    virtual void eat() = 0;
    virtual void drink() = 0;
    virtual void be_merry() = 0;
    ...
};

class A : public Base {
public:
    virtual void eat() { /* Eat A-specific stuff */ }
    virtual void drink() { /* Drink A-specific stuff */ }
    virtual void be_merry() { /* Be merry in an A-specific way */ }
};

class B : public Base {
public:
    virtual void eat() { /* Eat B-specific stuff */ }
    virtual void drink() { /* Drink B-specific stuff */ }
    virtual void be_merry() { /* Be merry in an B-specific way */ }
};

class C : public Base {
public:
    virtual void eat() { /* Eat C-specific stuff */ }
    virtual void drink() { /* Drink C-specific stuff */ }
    virtual void be_merry() { /* Be merry in a C-specific way */ }
}; 
```

优点是您可以添加新的`Base`派生类`D`、等等，而不必触及任何只处理指针或引用的代码`E`，因此不会像原始语句中的语句那样过时。解决方案。（这种转换在 Java 中看起来非常相似，默认情况下方法是虚拟的，我相信在 C# 中它看起来也很相似。）在一个大型项目中，这是一个*巨大*的可维护性胜利。`F``Base``switch`

 ** * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-30T05:19:36.647

您可能想查看[Strategy Pattern](http://en.wikipedia.org/wiki/Strategy_pattern)，其中不是放置带有链接条件的长链 ifs，而是将每个条件抽象为不同的对象，每个条件定义其特定行为。

定义这些对象的类将实现一个接口，该接口将由父对象调用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-30T19:44:01.720

怎么样：

```
/* Code Block 1... */

if(/* result of some condition or function call */)
{
   /* Code Block 2... */

   if(/* result of some condition or function call */)
   {
      /* Code Block 3... */

      if(/* result of some condition or function call */)
      {
         /* Code Block 4... */
      }
   }
} 
```

变成这样：

```
/* Code Block 1... */
IsOk = /* result of some condition or function call */

if(IsOK)
{
   /* Code Block 2... */
   IsOk = /* result of some condition or function call */
}

if(IsOK)
{
   /* Code Block 3...*/
   IsOk = /* result of some condition or function call */
}

if(IsOK)
{
   /* Code Block 4...*/
   IsOk = /* result of some condition or function call */
}

/* And so on... */ 
```

如果适当的话，如果 IsOk 变为 false，您当然可以返回。

# objective-c - 如何在 InterfaceBuilder 中显示自定义 UIView？

> ID：494520
> 
> 赞同：18
> 
> 时间：2009-01-30T04:56:31.700
> 
> 标签：objective-c, xcode, interface-builder, ibplugin

我似乎喜欢设计新的`UIViews`并`UIControls`实现自己的`-drawRect:`方法。这对我来说效果很好，尤其是在使用`UIViews`Interface *Builder*组合时。

但是在 Interface Builder 中组合它们很烦人，因为它们只是显示为无聊的普通矩形。

如果视图真的像内置控件那样呈现自己，那就太好了。

有什么方法可以构建我的项目，以便 Interface Builder 呈现我的自定义视图？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-01-30T06:40:27.963

为此，您实际上必须为使用您的自定义类的 Interface Builder 创建一个插件。创建并安装插件后，您将能够像任何其他控件一样将类的实例（您的视图）拖放到另一个窗口/视图/任何东西上。要开始创建 IB 插件，请参阅[Interface Builder Plug-In Programming Guide](https://developer.apple.com/legacy/library/documentation/DeveloperTools/Conceptual/IBPlugInGuide/IBPlugInGuide.pdf)。另外，我推荐看看 Aaron Hillegass 的书，*[Cocoa Programming for Mac OS](https://rads.stackoverflow.com/amzn/click/com/0321503619)* X。除了写得很好且易于理解之外，它还有一章是关于创建您自己的 IB Palette 控件的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-02-13T07:49:56.773

这可以通过用 . 标记你的 UIView 子类来实现`@IBDesignable`。完成此操作后，您的自定义视图将在 Interface Builder 中呈现自己。您甚至可以通过将参数标记为 来添加可以配置的参数`@IBInspectable`。这是一个斯威夫特的例子：

```
@IBDesignable class customView: UIView {

    @IBInspectable var count: Int = 0

} 
```

有[一篇关于 NSHipster](http://nshipster.com/ibinspectable-ibdesignable/)的文章提供了更多详细信息。

# mysql - 最安全的 Flash > MySQL 连接

> ID：494521
> 
> 赞同：0
> 
> 时间：2009-01-30T04:57:05.600
> 
> 标签：mysql, stored-procedures, database-connection

目前将 Flash AS2/AS3 连接到 MySQL 数据库的主要方式有：

1.  [Flash **>** PHP **>** MySQL](https://stackoverflow.com/questions/398537/simple-secure-way-for-flash-to-mysql-database) -- PHP 脚本中的“安全代码”
2.  [Flash Asql](http://asql.mooska.pl/)或[Assql](http://code.google.com/p/assql/) **> MySQL --** [MySQL 存储过程](http://en.wikipedia.org/wiki/Stored_procedure)中的“安全代码”

第二种方法较新，但使用[二进制套接字](http://livedocs.adobe.com/flash/9.0/main/00000318.html)和[ByteArrays](http://livedocs.adobe.com/flex/2/langref/flash/utils/ByteArray.html)直接连接到 MySQL DB 。

在哪种情况下，**“安全代码”会更难访问**，因此更安全？

我假设无法通过 FTP 访问存储过程，因此可能更难闯入？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-30T05:02:17.477

似乎 assql 和二进制套接字都是使用套接字连接到数据库的同步链接。这对于 AIR 应用程序可能很好，但对于浏览器应用程序可能会存在很大问题。这确定是你想要的吗？您关于通过存储过程访问的问题让我觉得您对这些东西不太确定。

事实上，正确使用 PHP 可能更容易在您的应用程序（及其主机）和数据库之间构建可靠的抽象和安全间接屏障。

* * *

编辑：

Web 客户端和服务器使用 http 协议进行通信。这被称为“无状态”和“无连接”（这只是有点真实）协议，因为两者之间的连接只持续只要客户端请求所有内容并且服务器发送回所有内容。明显的好处是服务器只在很短的时间内知道每个客户端。

套接字（在这两种协议使用一个的意义上）是客户端和服务器之间永久建立的连接，它一直持续到一端或另一端关闭它（基于连接）；并且双方都知道连接的状态（打开或关闭）。因此，它们会长时间占用每个客户端的大量主机资源，当连接中断时，事情就会变得古怪。差别很大，它不能通过支持网页的端口运行——需要在主机和客户端上提供另一个端口（有时是两个）来支持套接字。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-30T05:13:30.107

我不确定 asql 是否适用于代理背后的用户，所以我不会将它用于网站。中间使用 PHP 的方法似乎更好，您可以（并且应该）为您的应用程序建模与您的数据库结构不同的 api。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-30T10:43:57.020

存储过程只能由具有正确数据库凭据的人访问，因此假设没有人破解您的数据库密码，它们将是安全的。您知道 PHP 代码实际上可能更安全，因为您可以将数据库密码保存在服务器上而不是主机应用程序中。

我想您总是可以反编译 flash 并尝试在主机应用程序中找到密码，因为使用 asql 密码将存储在主机应用程序中，而不是隐藏在 PHP 后面的服务器上

# javadoc - 如何在生成 javadocs 时过滤一些属性/文本？

> ID：494527
> 
> 赞同：1
> 
> 时间：2009-01-30T04:58:38.077
> 
> 标签：javadoc

我想在 javadoc 中有自定义属性，例如“@owner”“@since-version”，我不想包含在 javadocs 中。有没有解决的办法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-30T05:04:24.210

[javadoc 工具文档](http://java.sun.com/j2se/1.5.0/docs/tooldocs/windows/javadoc.html#tag)：

*“一些开发人员将自定义标签放在他们并不总是想要输出的源代码中。在这些情况下，列出源代码中存在的所有标签非常重要，启用您想要输出的标签并禁用那些你不想输出。X 的存在禁用标签，而它的缺席启用标签。“*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-30T05:07:38.230

提供另一种解决方案：

如果您使用 Ant[`javadoc`任务](http://ant.apache.org/manual/Tasks/javadoc.html)生成 javadoc ，您可以添加一个带有“enable=false”属性的嵌套“ `tag`”元素，以确保忽略此标记。

# c++ - 为什么我嵌入 perl 后 MIcroQuill Smartheap 会抛出“mem_bad_pointer”错误？

> ID：494530
> 
> 赞同：2
> 
> 时间：2009-01-30T05:01:13.907
> 
> 标签：c++, perl, memory-management, embed

我将 perl 嵌入到使用[Smartheap](http://www.microquill.com/smartheap/index.html)的 C++ 应用程序中。无论我是编译 perl 以使用它自己的 malloc 还是系统的，我都会收到一堆错误 mem___bad_pointer 对话框。当我单击“确定”并忽略错误时，它似乎工作正常，但显然我需要实际解决问题。

我是否可能需要将 SmartHeap 编译到我的 perl 版本中？这甚至可行吗？

下面是我能找到的关于 mem__bad_pointer 的[唯一文档](http://www.microquill.com/kb/docs/APPENDXB.html)页面，但我离解决问题还差得远。我不明白 perl 和 Smartheap 如何或在何处相互冲突。任何指针表示赞赏。

*   该指针是由 SmartHeap 以外的内存管理器分配的，例如来自另一个 DLL 或 EXE，或者来自编译器运行时库。检查您的映射文件以查看是否链接了 SmartHeap 版本的 malloc、_fmalloc/farmalloc 或 operator new。
*   指针是“野生的”（未初始化的），分配在堆栈上（局部变量），或者是无效的。
*   指针先前已被释放。如果 SmartHeap 释放了最初分配指针的页面，SmartHeap 将无法检测到它是双重释放的。但是，SmartHeap 会报告无效指针。使用 dbgMemDeferFreeing 来捕获此类错误。
*   自分配时间以来，指针递增或递减。
*   对于 16 位 x86，指针在分配后被强制转换为近指针，在这种情况下，指针的段部分已丢失。
*   分配指针的内存池已被释放，或者 SmartHeap 已从任务中注销。
*   分配指针的任务已终止（见 B.4 节）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T21:37:47.410

没有看到代码很难调试问题。也许您正在使用 smartheap 和常规内存管理器来分配内存。当您在没有智能堆的 dll 构建中分配内存时，可能会导致这种情况。

根据您的代码，分配可能没问题，并且您可能在全涂层内存区域之外进行写入。

# java - 学习 Spring MVC 的资源

> ID：494537
> 
> 赞同：24
> 
> 时间：2009-01-30T05:06:30.713
> 
> 标签：java, spring-mvc

我正在寻找一个在线资源来学习 Spring MVC 堆栈。

有人可以指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-01-30T05:24:28.023

我已使用本教程开始。我发现它很有帮助。

[http://static.springframework.org/docs/Spring-MVC-step-by-step/](http://static.springframework.org/docs/Spring-MVC-step-by-step/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-30T05:12:00.500

从 Manning Publications获取[Spring in Action](http://www.manning.com/walls3/)的副本。

很棒的书，有很多很好的例子、理论和实用的部署技巧。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-11T14:37:45.713

如果你想要一个基于网络的交互式培训课程，试试这个： http: [//pluralsight.com/training/Courses/TableOfContents/springmvc-intro](http://pluralsight.com/training/Courses/TableOfContents/springmvc-intro)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-08T10:23:45.167

我可以推荐的最好的一课是好好看看[appfuse 的 spring mvc 构建](http://appfuse.org)。确保您获得了应用程序的完整源代码，以便您可以看到控制器的所有详细信息。

也离线[弹簧 MVC 上的 apress 书](http://apress.com/book/view/9781590595848)也不错。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-12T16:40:07.983

您阅读了我的一些教程，它将帮助您[在此处开始使用 Spring MVC](http://shreymalhotra.me/blog/tutorial/springmvc/spring-mvc-hello-springworld/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-04-21T07:03:17.903

[GONTUSERIES - 我可以向所有人推荐的最佳 youtube Spring MVC 播放列表](https://www.youtube.com/watch?v=iCQspqBpOB0&list=PLBgMUB7xGcO31B2gBmy1igpZn6LK78-CJ)

# php - 大多数专业的 PHP 开发是在 PC 上还是在 Mac 上进行？

> ID：494548
> 
> 赞同：5
> 
> 时间：2009-01-30T05:17:45.730
> 
> 标签：php, windows, macos

我正在尝试确定如果我被聘为 PHP 程序员，我的下一份工作将涉及使用 Mac/PC 的可能性有多大。使用 Rails，大多数商店似乎都是在 Mac 上开发的。我想知道PHP是否也是如此。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-30T20:00:47.710

大多数 PHP 开发公司会让您在模拟生产环境的测试环境中调试和运行代码。这样，您就可以使用您选择的操作系统/编辑器/IDE，并且一切正常。PHP 与其他 Web 服务语言（ASP.net 等）相比的优势之一是它的核心是多平台的。我会更担心他们使用什么版本控制系统以及他们的生产环境是什么样的，而不是你必须使用什么桌面操作系统，因为这些变量在你的桌面机器没有的情况下被锁定在石头上。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-30T05:25:31.407

简单的答案是更多的人使用 PC，因此更多的开发人员在 PC 上开发 PHP。我使用 Linux。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-30T05:33:11.500

他们都可以做得很好，我只想确保您对所有 3 个操作系统都感到满意。我的办公室几乎只做 ASP.net 的开发，而我旁边的人是在 Mac 上开发的！基本上，作为一名专业人士，您需要能够跳上任何事情并能够在其上发展。

当我做 PHP 时，我在 XP 上开发，在 Linux 上部署，FWIW。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-30T17:00:40.537

无关紧要。我使用 Linux 和 Windows，但这并不重要，因为在两者上我都使用相同的编辑器（ActiveState Komodo 和 Zend Studio），它们都可用于 Mac。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-30T22:24:28.357

语言本身没有限制因素。我们是一个纯 PHP 开发环境，我们所有的开发人员都使用 Mac。但是，如果他们中的任何一个使用 Windows 机器或 Linux 机器进行开发，那将不是问题。唯一的问题是公司是否拥有必须在特定平台上运行的开发工具。简短的回答是：这取决于你在哪里找到工作。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-30T05:30:30.727

我看到一些公司在他们的招聘广告中说他们使用 Mac 进行开发。实际上，尽管我认为这只是为了“酷”因素。我敢打赌，只要您的 PHP + Apahce/IIS/任何配置不是，他们将允许您使用您想要开发 PHP 的任何东西距离生产服务器上使用的东西一百万英里。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-30T06:13:00.827

我认为当涉及到 PHP 或 JavaScript 等 Web 脚本编程时，这并不重要，除非您偏爱特定的 IDE 或其他东西。我在记事本编辑器中编写所有 Web 编程代码，但在 Mac 或 Linux 机器甚至黑莓上编写代码似乎并不那么难。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-30T06:33:25.547

我在 Windows XP 上进行所有开发工作。

对于工作中的 PHP 开发，我在 Windows 上使用 Nusphere PHP Ed。它有很多有用的功能，比如调试和代码智能，但我发现它对于花钱的软件来说有点不稳定。尽管如此，如果您不介意它经常死机并想为此付费，那么它是适用于 Windows 的出色 PHP IDE。

我个人最喜欢的是带有 PHP IDE Project 插件的 Eclipse（有几个选项），如果您使用它，那么您使用的操作系统并不重要（它适用于 PC、Mac 和 Linux）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-30T05:29:01.620

我会说 PHP 更多地出现在 Windows 上，因为它的存在时间更长，并且可能传播到更多的开发环境中。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-30T16:50:10.510

我在 Linux 上进行大部分繁重的开发。如果您像我们一样运行 Linux 服务器，并且您的站点使用特定服务，那么最好让您的开发平台尽可能靠近您的目标生产服务器。

我使用 Mac 进行个人开发，但我并不像在 Linux 上那样舒服。

我敢打赌，很多人使用 Windows 进行 Web 开发，因为大多数人使用 Windows 句号，如果这是他们更喜欢的，我看不出有什么不这样做的理由。我不。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-02-22T12:44:46.100

目前，我正在使用 Centos Virtual box 在 macbook 上进行所有 PHP 开发。它很棒，因为您无需在您的实际 Mac 上安装任何东西，除了 Virtual box 作为它的免费。正确设置访客大约需要 1 或 2 个小时，然后您就可以上路了。从那里我使用 Eclipse PHP 进行实际的代码开发。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-05-17T14:04:27.660

我喜欢在 Windows 7 上工作，IDE 是 Sublime Text，这对 Mac 用户也很方便。操作系统对于 PHP 开发来说真的无关紧要，因为它依赖于多操作系统。

**我的 PHP 环境设置：**

*   Windows 7的
*   崇高的文本
*   Xampp 服务器
*   胃肠道

# c# - TransactionScope 如何回滚事务？

> ID：494550
> 
> 赞同：106
> 
> 时间：2009-01-30T05:19:26.490
> 
> 标签：c#, .net, nhibernate, transactions, transactionscope

我正在编写一个集成测试，我将在其中将许多对象插入数据库，然后检查以确保我的方法是否检索到这些对象。

我与数据库的连接是通过 NHibernate...我通常创建这样一个测试的方法是执行以下操作：

```
NHibernateSession.BeginTransaction();

//use nhibernate to insert objects into database
//retrieve objects via my method
//verify actual objects returned are the same as those inserted

NHibernateSession.RollbackTransaction(); 
```

但是，我最近发现了[TransactionScope](http://msdn.microsoft.com/en-us/library/system.transactions.transactionscope.aspx)显然可以用于这个目的......

[我发现](http://dotnetslackers.com/articles/ado_net/Managing_Transactions_using_TransactionScope.aspx)的一些示例代码如下：

```
public static int AddDepartmentWithEmployees(Department dept)
{

    int res = 0;

    DepartmentAdapter deptAdapter = new DepartmentAdapter();
    EmployeeAdapter empAdapter = new EmployeeAdapter();
    using (TransactionScope txScope = new TransactionScope())
    {

        res += deptAdapter.Insert(dept.DepartmentName);
        //Custom method made to return Department ID 
        //after inserting the department "Identity Column"
        dept.DepartmentID = deptAdapter.GetInsertReturnValue();
        foreach(Employee emp in dept.Employees)
        {

            emp.EmployeeDeptID = dept.DepartmentID;
            res += empAdapter.Insert(emp.EmployeeName, emp.EmployeeDeptID);

        }
        txScope.Complete();

    }
    return res;

} 
```

我相信如果我不包括`txScope.Complete()`插入的数据将被回滚的行。但不幸的是，我不明白这怎么可能......`txScope`对象如何跟踪数据库中的`deptAdapter`和`empAdapter`对象及其事务。

我觉得我在这里遗漏了一些信息......我真的能够通过使用包围我的代码来替换我的`BeginTransaction()`and ) 调用吗？`RollbackTransaction(``TransactionScope`

如果不是，那么如何`TransactionScope`回滚事务？

* * *

## 回答 #1

> 赞同：115
> 
> 时间：2009-01-30T05:49:11.797

本质上，TransactionScope 不会跟踪您的适配器，它所做的是跟踪数据库连接。当您打开数据库连接时，连接将查看是否存在环境事务（事务范围），如果有，则加入该事务。注意，如果有多个连接到同一个 SQL 服务器，这将升级为分布式事务。

自从您使用 using 块后会发生什么，您确保即使发生异常也会调用 dispose。因此，如果在 txScope.Complete() 之前调用 dispose，则 TransactionScope 将告诉连接回滚其事务（或 DTC）。

* * *

## 回答 #2

> 赞同：57
> 
> 时间：2009-01-30T05:50:03.043

该类与特定于线程 [的](http://msdn.microsoft.com/en-us/library/system.transactions.transaction.aspx)[`TransactionScope`类一起使用。](http://msdn.microsoft.com/en-us/library/system.transactions.transactionscope.aspx)[`Transaction`](http://msdn.microsoft.com/en-us/library/system.transactions.transaction.aspx)

创建`TransactionScope`时，它会检查是否存在`Transaction`线程；如果存在，则使用它，否则，它会创建一个新的并将其推入堆栈。

如果它使用现有的，那么它只会增加一个释放计数器（因为你必须调用[`Dispose`](http://msdn.microsoft.com/en-us/library/system.transactions.transaction.dispose.aspx)它）。在最后一个版本中，如果`Transaction`未提交，它将回滚所有工作。

至于为什么类似乎神奇地知道事务，这留给那些希望使用这个模型的类作为实现细节。

当您创建`deptAdapter`和`emptAdapter`实例时，它们会检查线程上是否存在当前事务（类上的静态[`Current`属性](http://msdn.microsoft.com/en-us/library/system.transactions.transaction.current.aspx)`Transaction`）。如果有，那么它将自己注册到`Transaction`, 以参与提交/回滚序列（它`Transaction`控制并可能传播到不同的事务协调器，例如内核、分布式等）。

# c# - 为什么 C# 区分大小写？

> ID：494561
> 
> 赞同：10
> 
> 时间：2009-01-30T05:26:11.500
> 
> 标签：c#, case-sensitive

使 C# 区分大小写背后的原因是什么？

我正在考虑从 VB.NET 切换以利用某些语言功能（CCR 和 yield），并且了解这种差异背后的原因可能会使过渡更容易。

[更新]好吧，我三天前冒险了。学习 C# 并不是特别难，但我几乎记不起我在 90 年代后期的 C++ 日子。

区分大小写让我讨厌吗？没有我想的那么多……而且我发现它实际上是有利的。实际上，我对 CCR 作为异步协调编程模型感到非常满意。如果我有更多时间在当前项目上，我会将代码库移植到 C# 中以充分利用。不过对我的客户不公平。

现在评估我当前的项目，我到处都看到阻塞线程！啊啊啊！！！

**[更新]**

好吧，我已经用 C# 编程将近一年了。我真的很喜欢这门语言，我真的很讨厌转用 VB（尤其是在不可避免的情况下！）

还有区分大小写的事情？甚至不是问题

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-01-30T05:30:11.977

C# 区分大小写，因为它采用了所有区分大小写的 C 风格语言。这是从内存这里是一个[MSDN 链接](http://msdn.microsoft.com/en-us/vcsharp/aa336811.aspx)，现在对我不起作用，我无法验证。

我还想指出，这是一个非常有效的用例：

```
public class Child
{
   private Person parent;
   public Person Parent
   {
      get { return parent;}
   }
} 
```

是的，您可以在成员变量上使用前缀来解决这个问题，但有些人不喜欢这样做。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-30T05:30:00.713

他们可能在想“我们不希望人们在一个地方使用 SoMeVaRiAbLe，而在另一个地方使用 SOmEvArIaBlE。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-30T05:56:55.370

考虑以下伪代码中的变量名称：

```
class Foo extends Object { ... }
...
foo = new Foo(); 
```

区分大小写允许使用大小写的约定来分隔类名和实例；这种公约在发展世界中并不少见。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-01-30T06:05:56.973

我认为案例可以传达信息的事实是一个很好的理由。例如，按照约定，类名、公共方法和属性按照约定以大写字母开头。相反，字段和局部变量以小写字母开头。

在使用该语言多年后，我开始真正享受这一点，当您可以简单地从单词的大小写中读取信息时，代码更容易阅读。

这就是为什么人们有时会这样做，这很有意义：

```
Foo foo = new Foo(); 
```

我经常这样做，非常有用。如果您在这样的更有用的情况下考虑它：

```
Image image = Image.LoadFrom(path); 
```

有时将实例称为与类名相同的东西是有意义的，区分它们的唯一方法是大小写。在 C++ 中，区分大小写变得更加有用，但这是另一回事。如果你有兴趣，我可以详细说明。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-30T05:33:51.327

我认为使用区分大小写的标识符可以使代码更具可读性，通过使用命名约定，好吧，即使没有命名约定，区分大小写强制执行的一致性确保您始终以相同的方式编写相同的实体。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-01-30T05:51:33.023

C# 继承了 C 和 Java 的区分大小写，它试图模仿它以使开发人员更容易迁移到 C#

在三年前创建 C 时，可能有一些充分的理由使 C 区分大小写，但似乎没有任何记录说明原因。Jeff Atwood 写了一篇好文章，主张[区分大小写可能不再有意义](http://www.codinghorror.com/blog/archives/000458.html)。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-30T05:29:25.563

可能是从 C、C++、Java 等复制而来，或者可能故意保持相同，以便与其他语言相似。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-30T05:35:37.067

这只是 C# 语言设计团队的品味问题。我敢打赌这是为了与其他 C 家族语言共通。然而，它确实会导致一些糟糕的编程实践，例如私有字段及其关联属性仅在第一个字母的情况下有所不同。

编辑：

为什么这会被认为是坏事。

```
class SomeClass 
{
    private int someField;

    public int SomeField
    {
        get { return SomeField; } 
        // now we have recursion where its not wanted and its 
        // difficult for the eye to pick out and results in a
        // StackOverflowException.
    }
} 
```

使用 _ 或 m 前缀私有字段可能更容易发现。它不是什么大问题，而且我个人仍然会做我刚才所说的不好的事情（所以起诉我！）。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-30T05:34:47.847

对于区分大小写的语言，解析也稍微容易一些。只要没有充分的理由选择不区分大小写的方式，何必呢？

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-30T05:42:06.273

你以一种非常有限的方式看待这个问题——从你的角度来看。语言设计者必须考虑一系列其他因素：文化原因、与其他语言的兼容性、常见的编码实践等

所有现代语言都使用区分大小写：哪些不区分大小写？

作为一个使用 BASIC 多年的人，我非常厌倦开发人员对同一个变量使用不同的情况。这种事情看起来非常令人厌烦，并鼓励草率的编程。如果您懒得理直气壮——还有什么是您懒得做的？

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-14T18:27:20.033

来自 .NET Framework Developer's Guide [Capitalization Conventions](http://msdn.microsoft.com/en-us/library/ms229043.aspx)，区分大小写：

> 大写指南的存在只是为了使标识符更易于阅读和识别。大小写不能用作避免库元素之间名称冲突的方法。
> 
> 不要假设所有编程语言都区分大小写。他们不是。名称不能仅因大小写而异。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2012-08-26T00:53:11.420

关于它为什么区分大小写，我最好的猜测是因为 Unix 是区分大小写的。C 之父 Dennis Ritchie 也是 Unix 的共同编写者，因此他编写的语言与当时可用的环境相吻合是有道理的。C# 只是从它的祖先那里继承了这个。我认为这对微软来说是一个很好的决定，因为 Windows 路径不区分大小写。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-30T15:22:56.960

我假设您希望看到如下代码：

```
SomeField=28;
someField++;
somefield++;
SOMEFIELD++; 
```

编译为好像任何外壳变体中的 SomeField 是相同的变量。

就个人而言，我认为这是一个坏主意。它鼓励懒惰和/或粗心。当它无关紧要时，为什么还要麻烦正确地封装它呢？好吧，当我们这样做的时候，也许编译器应该允许拼写错误，比如`SoemField++`？

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2009-01-30T16:00:39.597

命名。名称很难获得，您不想在谈论类似的事情时创建一个新名称，或者必须使用一些符号来区分它们。

此类场景是您将要分配给字段的构造函数中的字段或参数的属性。

# ios - 设置自定义 UITableViewCells 高度

> ID：494562
> 
> 赞同：232
> 
> 时间：2009-01-30T05:27:27.440
> 
> 标签：ios, objective-c, uitableview, row-height

我正在使用一个自定义的 UITableViewCell，它有一些要显示的标签、按钮和图像视图。单元格中有一个标签，其文本是一个`NSString`对象，字符串的长度可以是可变的。因此，我无法在`UITableView`'`heightForCellAtIndex`方法中为单元格设置恒定高度。单元格的高度取决于标签的高度，可以使用`NSString`'`sizeWithFont`方法确定。我尝试使用它，但看起来我在某个地方出错了。如何修复？

这是用于初始化单元格的代码。

```
if (self = [super initWithFrame:frame reuseIdentifier:reuseIdentifier])
{
    self.selectionStyle = UITableViewCellSelectionStyleNone;
    UIImage *image = [UIImage imageNamed:@"dot.png"];
    imageView = [[UIImageView alloc] initWithImage:image];
    imageView.frame = CGRectMake(45.0,10.0,10,10);

    headingTxt = [[UILabel alloc] initWithFrame:   CGRectMake(60.0,0.0,150.0,post_hdg_ht)];
    [headingTxt setContentMode: UIViewContentModeCenter];
    headingTxt.text = postData.user_f_name;
    headingTxt.font = [UIFont boldSystemFontOfSize:13];
    headingTxt.textAlignment = UITextAlignmentLeft;
    headingTxt.textColor = [UIColor blackColor];

    dateTxt = [[UILabel alloc] initWithFrame:CGRectMake(55.0,23.0,150.0,post_date_ht)];
    dateTxt.text = postData.created_dtm;
    dateTxt.font = [UIFont italicSystemFontOfSize:11];
    dateTxt.textAlignment = UITextAlignmentLeft;
    dateTxt.textColor = [UIColor grayColor];

    NSString * text1 = postData.post_body;
    NSLog(@"text length = %d",[text1 length]);
    CGRect bounds = [UIScreen mainScreen].bounds;
    CGFloat tableViewWidth;
    CGFloat width = 0;
    tableViewWidth = bounds.size.width/2;
    width = tableViewWidth - 40; //fudge factor
    //CGSize textSize = {width, 20000.0f}; //width and height of text area
    CGSize textSize = {245.0, 20000.0f}; //width and height of text area
    CGSize size1 = [text1 sizeWithFont:[UIFont systemFontOfSize:11.0f]
                        constrainedToSize:textSize lineBreakMode:UILineBreakModeWordWrap];

    CGFloat ht = MAX(size1.height, 28);
    textView = [[UILabel alloc] initWithFrame:CGRectMake(55.0,42.0,245.0,ht)];
    textView.text = postData.post_body;
    textView.font = [UIFont systemFontOfSize:11];
    textView.textAlignment = UITextAlignmentLeft;
    textView.textColor = [UIColor blackColor];
    textView.lineBreakMode = UILineBreakModeWordWrap;
    textView.numberOfLines = 3;
    textView.autoresizesSubviews = YES;

    [self.contentView addSubview:imageView];
    [self.contentView addSubview:textView];
    [self.contentView addSubview:webView];
    [self.contentView addSubview:dateTxt];
    [self.contentView addSubview:headingTxt];
    [self.contentView sizeToFit];

    [imageView release];
    [textView release];
    [webView release];
    [dateTxt release];
    [headingTxt release];
} 
```

这是高度和宽度出错的标签：

```
textView = [[UILabel alloc] initWithFrame:CGRectMake(55.0,42.0,245.0,ht)]; 
```

* * *

## 回答 #1

> 赞同：508
> 
> 时间：2009-01-30T22:46:39.700

你`UITableViewDelegate`应该实施`tableView:heightForRowAtIndexPath:`

**Objective-C**

```
- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath
{
    return [indexPath row] * 20;
} 
```

**斯威夫特 5**

```
func tableView(_ tableView: UITableView, heightForRowAt indexPath: IndexPath) -> CGFloat {
    return indexPath.row * 20
} 
```

您可能希望使用`NSString`'s`sizeWithFont:constrainedToSize:lineBreakMode:`方法来计算行高，而不仅仅是在 indexPath 上执行一些愚蠢的数学运算：)

* * *

## 回答 #2

> 赞同：135
> 
> 时间：2011-01-18T23:59:34.687

如果所有行的高度相同，只需设置`rowHeight`UITableView 的属性，而不是实现`heightForRowAtIndexPath`. 苹果文档：

> 使用 tableView:heightForRowAtIndexPath: 代替 rowHeight 会影响性能。每次显示表视图时，它都会在委托上为其每一行调用 tableView:heightForRowAtIndexPath:，这可能会导致具有大量行（大约 1000 或更多）的表视图出现严重的性能问题。

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2010-01-19T13:26:18.187

在自定义 UITableViewCell -控制器中添加这个

```
-(void)layoutSubviews {  

    CGRect newCellSubViewsFrame = CGRectMake(0, 0, self.frame.size.width, self.frame.size.height);
    CGRect newCellViewFrame = CGRectMake(self.frame.origin.x, self.frame.origin.y, self.frame.size.width, self.frame.size.height);

    self.contentView.frame = self.contentView.bounds = self.backgroundView.frame = self.accessoryView.frame = newCellSubViewsFrame;
    self.frame = newCellViewFrame;

    [super layoutSubviews];
} 
```

在 UITableView -controller 添加这个

```
- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath
{
    return [indexPath row] * 1.5; // your dynamic height...
} 
```

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2012-09-19T09:30:28.970

```
#define FONT_SIZE 14.0f
#define CELL_CONTENT_WIDTH 300.0f
#define CELL_CONTENT_MARGIN 10.0f

- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath      *)indexPath;
{
   /// Here you can set also height according to your section and row
   if(indexPath.section==0 && indexPath.row==0)
   {
     text=@"pass here your dynamic data";

     CGSize constraint = CGSizeMake(CELL_CONTENT_WIDTH - (CELL_CONTENT_MARGIN * 2), 20000.0f);

     CGSize size = [text sizeWithFont:[UIFont systemFontOfSize:FONT_SIZE]      constrainedToSize:constraint lineBreakMode:UILineBreakModeWordWrap];

     CGFloat height = MAX(size.height, 44.0f);

     return height + (CELL_CONTENT_MARGIN * 2);
   }
   else
   {
      return 44;
   }
}

- (UITableViewCell *)tableView:(UITableView *)tv cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    UITableViewCell *cell;
    UILabel *label = nil;

    cell = [tv dequeueReusableCellWithIdentifier:@"Cell"];
    if (cell == nil)
    {
       cell = [[UITableViewCell alloc] initWithFrame:CGRectZero reuseIdentifier:@"Cell"];
    }
    ********Here you can set also height according to your section and row*********
    if(indexPath.section==0 && indexPath.row==0)
    {
        label = [[UILabel alloc] initWithFrame:CGRectZero];
        [label setLineBreakMode:UILineBreakModeWordWrap];
        [label setMinimumFontSize:FONT_SIZE];
        [label setNumberOfLines:0];
        label.backgroundColor=[UIColor clearColor];
        [label setFont:[UIFont systemFontOfSize:FONT_SIZE]];
        [label setTag:1];

        // NSString *text1 =[NSString stringWithFormat:@"%@",text];

        CGSize constraint = CGSizeMake(CELL_CONTENT_WIDTH - (CELL_CONTENT_MARGIN * 2), 20000.0f);

        CGSize size = [text sizeWithFont:[UIFont systemFontOfSize:FONT_SIZE] constrainedToSize:constraint lineBreakMode:UILineBreakModeWordWrap];

        if (!label)
        label = (UILabel*)[cell viewWithTag:1];

        label.text=[NSString stringWithFormat:@"%@",text];
        [label setFrame:CGRectMake(CELL_CONTENT_MARGIN, CELL_CONTENT_MARGIN, CELL_CONTENT_WIDTH          - (CELL_CONTENT_MARGIN * 2), MAX(size.height, 44.0f))];
        [cell.contentView addSubview:label];
    }
return cell;
} 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2016-01-26T19:58:03.403

我看到了很多解决方案，但都是错误的或不完整的。你可以用 viewDidLoad 和 autolayout 中的 5 行来解决所有问题。这对于目标 C：

```
_tableView.delegate = self;
_tableView.dataSource = self;
self.tableView.estimatedRowHeight = 80;//the estimatedRowHeight but if is more this autoincremented with autolayout
self.tableView.rowHeight = UITableViewAutomaticDimension;
[self.tableView setNeedsLayout];
[self.tableView layoutIfNeeded];
self.tableView.contentInset = UIEdgeInsetsMake(20, 0, 0, 0) ; 
```

对于 Swift 2.0：

```
 self.tableView.estimatedRowHeight = 80
 self.tableView.rowHeight = UITableViewAutomaticDimension      
 self.tableView.setNeedsLayout()
 self.tableView.layoutIfNeeded()
 self.tableView.contentInset = UIEdgeInsetsMake(20, 0, 0, 0) 
```

现在使用 xib 或在 Storyboard 中的 tableview 中创建单元格有了这个，您无需再实现或覆盖。（不要忘记数字 os 行 0）和底部标签（约束）降级“Content Hugging Priority -- Vertical to 250”

[![在此处输入图像描述](https://i.stack.imgur.com/65038.png)](https://i.stack.imgur.com/65038.png) [![在此处输入图像描述](https://i.stack.imgur.com/UZ6rW.png)](https://i.stack.imgur.com/UZ6rW.png)

您可以在下一个 url 中下载代码： [https ://github.com/jposes22/exampleTableCellCustomHeight](https://github.com/jposes22/exampleTableCellCustomHeight)

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2012-11-18T16:20:40.000

```
- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath;
{
    CGSize constraintSize = {245.0, 20000}
    CGSize neededSize = [ yourText sizeWithFont:[UIfont systemFontOfSize:14.0f] constrainedToSize:constraintSize  lineBreakMode:UILineBreakModeCharacterWrap]
if ( neededSize.height <= 18) 

   return 45
else return neededSize.height + 45 
//18 is the size of your text with the requested font (systemFontOfSize 14). if you change fonts you have a different number to use  
// 45 is what is required to have a nice cell as the neededSize.height is the "text"'s height only
//not the cell.

} 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2018-02-02T15:20:54.290

要设置行高和估计行高的自动尺寸，请确保执行以下步骤，自动尺寸对单元格/行高布局有效。

*   分配和实现tableview dataSource和delegate
*   分配`UITableViewAutomaticDimension`给 rowHeight 和estimatedRowHeight
*   实现委托/数据源方法（即`heightForRowAt`并返回一个值`UITableViewAutomaticDimension`给它）

-

**目标 C：**

```
// in ViewController.h
#import <UIKit/UIKit.h>

@interface ViewController : UIViewController <UITableViewDelegate, UITableViewDataSource>

  @property IBOutlet UITableView * table;

@end

// in ViewController.m

- (void)viewDidLoad {
    [super viewDidLoad];
    self.table.dataSource = self;
    self.table.delegate = self;

    self.table.rowHeight = UITableViewAutomaticDimension;
    self.table.estimatedRowHeight = UITableViewAutomaticDimension;
}

-(CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath {

    return UITableViewAutomaticDimension;
} 
```

**迅速：**

```
@IBOutlet weak var table: UITableView!

override func viewDidLoad() {
    super.viewDidLoad()

    // Don't forget to set dataSource and delegate for table
    table.dataSource = self
    table.delegate = self

    // Set automatic dimensions for row height
    table.rowHeight = UITableViewAutomaticDimension
    table.estimatedRowHeight = UITableViewAutomaticDimension
}

// UITableViewAutomaticDimension calculates height of label contents/text
func tableView(_ tableView: UITableView, heightForRowAt indexPath: IndexPath) -> CGFloat {
    return UITableViewAutomaticDimension
} 
```

对于 UITableviewCell 中的标签实例

*   设置行数 = 0（& 换行模式 = 截断尾部）
*   设置关于其超级视图/单元格容器的所有约束（顶部、底部、左右）。
*   *可选*：设置标签的最小高度，如果你想要标签覆盖的最小垂直区域，即使没有数据。

![在此处输入图像描述](https://i.stack.imgur.com/T354s.png)

**注意**：如果您有多个具有动态长度的标签（UIElements），应根据其内容大小进行调整：为您希望以更高优先级扩展/压缩的标签调整“内容拥抱和压缩阻力优先级”。

在此示例中，我设置了低拥抱和高抗压优先级，这导致为第二个（黄色）标签的内容设置更多优先级/重要性。

![在此处输入图像描述](https://i.stack.imgur.com/vGRDJ.png)

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2012-03-22T20:02:05.000

感谢所有关于这个主题的帖子，有一些非常有用的方法可以调整 UITableViewCell 的 rowHeight。

这是其他人的一些概念的汇编，这些概念在为 iPhone 和 iPad 构建时确实很有帮助。您还可以访问不同的部分并根据不同大小的视图进行调整。

```
- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath {

if (UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPad)
{
    int cellHeight = 0;

    if ([indexPath section] == 0) 
    {
        cellHeight = 16;
        settingsTable.rowHeight = cellHeight;
    }
    else if ([indexPath section] == 1)
    {
        cellHeight = 20;
        settingsTable.rowHeight = cellHeight;
    }

    return cellHeight;
}
else
{
    int cellHeight = 0;

    if ([indexPath section] == 0) 
    {
        cellHeight = 24;
        settingsTable.rowHeight = cellHeight;
    }
    else if ([indexPath section] == 1)
    {
        cellHeight = 40;
        settingsTable.rowHeight = cellHeight;
    }

    return cellHeight;
}
return 0;
} 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2012-08-01T11:07:35.870

要在标签文本增加时动态单元格高度，首先需要计算高度，文本将在`-heightForRowAtIndexPath`委托方法中使用并返回它与其他标签的添加高度，图像（文本的最大高度+其他静态的高度组件）并在单元创建中使用相同的高度。

```
#define FONT_SIZE 14.0f
#define CELL_CONTENT_WIDTH 300.0f  
#define CELL_CONTENT_MARGIN 10.0f

- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath;
{

    if (indexPath.row == 2) {  // the cell you want to be dynamic

        NSString *text = dynamic text for your label;

        CGSize constraint = CGSizeMake(CELL_CONTENT_WIDTH - (CELL_CONTENT_MARGIN * 2), 20000.0f);
        CGSize size = [text sizeWithFont:[UIFont systemFontOfSize:FONT_SIZE] constrainedToSize:constraint lineBreakMode:UILineBreakModeWordWrap];

        CGFloat height = MAX(size.height, 44.0f);

        return height + (CELL_CONTENT_MARGIN * 2);
    }
    else {
        return 44; // return normal cell height
    }
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {

    static NSString *CellIdentifier = @"Cell";

    UILabel *label;

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleValue1 reuseIdentifier:CellIdentifier] ;
    }

    label = [[UILabel alloc] initWithFrame:CGRectMake(10, 5, 280, 34)];

    [label setNumberOfLines:2];

    label.backgroundColor = [UIColor clearColor];

    [label setFont:[UIFont systemFontOfSize:FONT_SIZE]];

    label.adjustsFontSizeToFitWidth = NO;

    [[cell contentView] addSubview:label];

    NSString *text = dynamic text fro your label;

    [label setText:text];

    if (indexPath.row == 2) {// the cell which needs to be dynamic 

        [label setNumberOfLines:0];

        CGSize constraint = CGSizeMake(CELL_CONTENT_WIDTH - (CELL_CONTENT_MARGIN * 2), 20000.0f);

        CGSize size = [text sizeWithFont:[UIFont systemFontOfSize:FONT_SIZE] constrainedToSize:constraint lineBreakMode:UILineBreakModeWordWrap];

        [label setFrame:CGRectMake(CELL_CONTENT_MARGIN, CELL_CONTENT_MARGIN, CELL_CONTENT_WIDTH - (CELL_CONTENT_MARGIN * 2), MAX(size.height, 44.0f))];

    }
    return  cell;
} 
```

# c++ - 控制对象创建

> ID：494571
> 
> 赞同：1
> 
> 时间：2009-01-30T05:33:02.360
> 
> 标签：c++, object

我有一个类，其对象必须在堆上创建。除了这个还有什么更好的方法吗：

```
class A
{
public:
  static A* createInstance(); //Allocate using new and return
  static void deleteInstance(A*); //Free the memory using delete

private:
  //Constructor and destructor are private so that the object can not be created on stack
  A(); 
  ~A();
}; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-30T06:59:49.890

在 C++ FAQ lite 中检查：

[[16.21] 如何强制我的类的对象总是通过 new 而不是本地对象或全局/静态对象创建？](https://isocpp.org/wiki/faq/freestore-mgmt#static-create-methods)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-30T05:50:36.257

我建议只将构造函数设为私有，并将 a 返回`shared_ptr`给对象。

```
class A
{
public:
  static sharedPtr<A> createInstance(); //Allocate using new and return

private:
  //Constructor is private so that the object can not be created on stack
  A(); 
}; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-30T05:42:01.280

这几乎是使对象仅堆的标准模式。

不能真正简化太多，除了您可以将析构函数设为私有而不强制使用工厂方法进行创建。

# c# - 我应该使用模拟测试方法实现吗

> ID：494590
> 
> 赞同：0
> 
> 时间：2009-01-30T05:48:05.560
> 
> 标签：c#, unit-testing, mocking, moq

我在使用 moq 进行一些单元测试时遇到了一些麻烦。

如果我有这样的功能：

```
public string GetName(IMapinfoWrapper wrapper)
{
   return wrapper.Evaluate("My com command");
   ///"My comm command" is the same all the time.
} 
```

然后我有一个测试来检查 GetName 函数的返回值：

```
[Test]
public void Test()
{
  Mock<IMapinfoWrapper> mock = new Mock<IMapinfoWrapper>();
  mock.Expect(mapinfo => mapinfo.Evaluate(It.IsAny<String>()))
      .Returns("TableName");

  Assert.AreEqual("TableName", GetName(mock.object));
} 
```

所以我的问题是应该像这样定义模拟：

```
mock.Expect(mapinfo => mapinfo.Evaluate(It.IsAny<String>()))
    .Returns("TableName"); 
```

或像这样：

```
mock.Expect(mapinfo => mapinfo.Evaluate("My com command")
    .Returns("TableName"); 
```

使用第二种方式的唯一问题是，我觉得我将方法 GetName 的实现绑定为始终在内部使用“My com command”字符串。

这是我应该做的还是我做错了。
我才刚刚开始进行单元测试和模拟，所以我仍然不确定一切应该如何结合在一起。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-30T05:56:00.050

这取决于您实际测试的内容。

如果期望传递给 Evaluate 的任何字符串都将返回“TableName”，则使用对 IsAny 的调用。

否则，如果您期望给定特定输入的特定输出，例如传递“我的 com 命令”的情况，则传递第二个。

似乎您不是在寻找特定的输入，而是（在这种情况下）进行基本的健全性检查，所以我会说前者是正确的举动（在这种情况下也是如此，但如果您有更具体的情况它的用例）。

# licensing - Ext JS 许可选项

> ID：494591
> 
> 赞同：0
> 
> 时间：2009-01-30T05:48:25.027
> 
> 标签：licensing, extjs

如果我在我们内部公司的 CMS 中使用[Ext JS 库的](http://www.sencha.com/products/extjs/)哪些许可选项将适用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-27T14:00:59.057

看看[Planet MySQL - GPL 和 Javascript](http://planet.mysql.com/entry/?id=11940)的这句话：

> [...] 当 GPL 应用于 javascript 库时，整个故事变得有点复杂。当用户使用该库时，他们将下载 HTML、CSS 图像和 javascript 库。首先要意识到的是您正在分发代码。它在您的服务器上，现在在用户的计算机上。这使任何用户都有权查看 javascript 代码并将其重用于另一个项目。这意味着您不能混淆 javascript 代码，人们可以复制/粘贴它以供自己使用。无论如何，这可能是您目前看待 javascript 的方式。但是 HTML、CSS 和图像怎么样，可以公开使用吗？不，它不能。这些项目不是 GPL 许可中定义的代码，它应该被视为数据。因此，GPL 并不与应用程序的那一部分结盟。
> 
> Web 应用程序可能不仅有客户端代码，它还会在服务器上以 PHP（或 JSP、Ruby 或 ..）脚本的形式存在一部分。最大的问题是，我们是否也需要发布该部分（在 GPL 许可下）。尽管我们作为开发人员认为客户端和服务器部分是同一个应用程序的两个部分，但 GPL 不是。使用 AJAX 时，客户端代码与服务器交互。但是，您可以将其与任何其他客户端/服务器应用程序进行比较。这可以解释为两个应用程序之间传输数据，因此两者可能具有不同的许可证。这被称为“ASP 漏洞”，被某些人视为错误。GPLv3 制定时，明确决定不堵住这个漏洞。

至于内部使用是否构成分发，这是来自[GPL 常见问题解答](http://www.gnu.org/licenses/gpl-faq.html#InternalDistribution)：

> 在一个组织或公司内制作和使用多个副本是“分发”吗？不，在这种情况下，组织只是为自己制作副本。因此，公司或其他组织可以开发修改后的版本并通过其自己的设施安装该版本，而无需允许员工将该修改后的版本发布给外部人员。但是，当组织将副本转移给其他组织或个人时，这就是分发。特别是，向承包商提供副本以供异地使用是分发。

所以 IANAL，但我会说你将 GPL 的 javascript 库用于内部系统是非常安全的，即使你开始将它暴露给世界其他地方，唯一适用的限制是，如果你使用GPL 的 javascript 库在您的前端代码中，您必须使您的 javascript 文件的未混淆版本可用。如果您仅将 ExtJS 用于管理区域（并且管理区域仅由您的员工访问），您仍然会清楚 GPL 的分发条款，按照我的理解。

有趣的是，还有另一个版本的 GPL，称为[AGPL](http://en.wikipedia.org/wiki/Affero_General_Public_License)，它试图填补这个“漏洞”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-30T06:16:45.673

除非您购买商业许可证，否则 GPLv3 将适用。也就是说，除非您购买商业许可证，否则您的公司需要同意将软件分发给您向其分发任何部分的副本的任何人（即通过将其发送到他们的浏览器），并以其他方式遵守以下条款GNU GPLv3。

现在，如果这仅供您公司的员工使用，并且您不介意向您的员工提供您的内部软件的副本（并且可能允许个人重新分发相同的软件），您可能不介意被受 GPLv3 约束。向您的律师征求他们的意见，让员工在担任公司代理人时使用该软件是否需要向他们授予一份副本，当他们不担任公司代理人时，他们可以重新分发该副本——我个人的解释是，不需要，但我不是律师，不能提供法律建议，也不是提供法律建议，而且很可能是错的。

底线：如果您根据 GPLv3 许可您的软件并遵守该许可，那么您可以从 Ext 派生；GPL 不要求您将您的源代码分发给您没有将派生工作的任何部分分发给的任何人，所以如果它是真正内部的并且从未泄露（即使通过第三方人员将 javascript 文件的副本下载到他们的网络浏览器），您可能会没事 - 但请了解您的管理层和法律委员会对什么感到满意！

现在，如果您（或您的公司律师）对此不满意（并且对此不满意也不会特别令人惊讶！），您可以购买商业许可证。它们的[价格相当合理](http://extjs.com/store/extjs/)，特别是如果您只为少数人按每个开发人员购买它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-30T06:17:31.367

根据官方许可信息，如果您要从您的 CMS 中获得商业优势，您需要购买适当数量的商业许可，除非您使用 GPL 许可分发您的源代码。换句话说，即使您在 CMS 上获利，您也不需要购买 Ext 的商业许可，只要您在 GPL 许可下提供源代码即可。

[http://extjs.com/products/license.php](http://extjs.com/products/license.php) [http://extjs.com/company/dual.php](http://extjs.com/company/dual.php)

# python - 如何编写斐波那契数列？

> ID：494594
> 
> 赞同：152
> 
> 时间：2009-01-30T05:49:13.387
> 
> 标签：python, fibonacci, sequences

我最初对程序进行了错误的编码。我没有返回一个范围之间的斐波那契数（即 startNumber 1，endNumber 20 应该 = 仅那些介于 1 和 20 之间的数字），而是为程序编写了显示范围之间的所有斐波那契数（即 startNumber 1，endNumber 20显示 = 前 20 个斐波那契数）。我以为我有一个万无一失的代码。我也不明白为什么会这样。

```
startNumber = int(raw_input("Enter the start number here "))
endNumber = int(raw_input("Enter the end number here "))

def fib(n):
    if n < 2:
        return n
    return fib(n-2) + fib(n-1)

print map(fib, range(startNumber, endNumber)) 
```

有人在我的第二部分中指出（由于重复而被关闭 - [https://stackoverflow.com/questions/504193/how-to-write-the-fibonacci-sequence-in-python-part-ii](https://stackoverflow.com/questions/504193/how-to-write-the-fibonacci-sequence-in-python-part-ii)）我需要使用 while 循环通过生成器传递 startNumber 和 endNumber。有人可以指点我如何做到这一点吗？欢迎任何帮助。

* * *

我是一名学习程序员，我遇到了一些混乱。我被要求编写一个程序，该程序将通过用户输入的开始数字和结束数字来计算和显示斐波那契数列（即 startNumber = 20 endNumber = 100，它将只显示该范围之间的数字）。诀窍是包容性地使用它（我不知道如何在 Python 中做到这一点？-我假设这意味着使用包容性范围？）。

到目前为止，我没有实际的编码，而是：

*   将 Fib 序列公式写入无穷大
*   仅从 Fib 序列显示 startNumber 到 endNumber。

我不知道从哪里开始，我正在寻求想法或洞察如何写这个。我也尝试过编写 Fib 序列论坛，但我也迷失了方向。

* * *

## 回答 #1

> 赞同：274
> 
> 时间：2009-01-31T18:01:14.377

[在wikipedia](http://en.wikipedia.org/wiki/Fibonacci_number)和[wolfram](http://mathworld.wolfram.com/FibonacciNumber.html)上有很多关于斐波那契数列的信息。比您可能需要的多得多。无论如何，学习如何使用这些资源来找到（如果可能的话，尽快）你需要的东西是一件好事。

## 将 Fib 序列公式写入无穷大

在数学中，它以递归形式给出：

![来自维基百科的斐波那契](https://upload.wikimedia.org/math/7/6/f/76f99713cf111eb035d908228c351710.png)

在编程中，**无限**是不存在的。您可以使用递归形式直接在您的语言中翻译数学形式，例如在 Python 中它变为：

```
def F(n):
    if n == 0: return 0
    elif n == 1: return 1
    else: return F(n-1)+F(n-2) 
```

用你最喜欢的语言试试看，随着 n 变大，这种形式需要**很多**时间。事实上，这是 O(2 ^n ) 的时间。

继续我链接到你的网站，你会看到这个（在[wolfram](http://mathworld.wolfram.com/images/equations/FibonacciNumber/NumberedEquation6.gif)上）：

[![斐波那契方程](https://i.stack.imgur.com/SPYOU.gif)](https://i.stack.imgur.com/SPYOU.gif)

这个在 Python 中很容易实现并且计算速度非常非常快：

```
from math import sqrt
def F(n):
    return ((1+sqrt(5))**n-(1-sqrt(5))**n)/(2**n*sqrt(5)) 
```

另一种方法是遵循定义（来自[维基百科](http://en.wikipedia.org/wiki/Fibonacci_number)）：

> 序列的第一个数字是 0，第二个数字是 1，随后的每个数字都等于序列本身的前两个数字之和，产生序列 0、1、1、2、3、5、8 ， ETC。

如果您的语言支持迭代器，您可以执行以下操作：

```
def F():
    a,b = 0,1
    while True:
        yield a
        a, b = b, a + b 
```

## 仅从 Fib 序列显示 startNumber 到 endNumber。

一旦您知道如何生成斐波那契数列，您只需要循环遍历这些数字并检查它们是否验证了给定的条件。

假设现在您编写了 af(n)，它返回斐波那契数列的第 n 项（如使用 sqrt(5) 的项）

在大多数语言中，您可以执行以下操作：

```
def SubFib(startNumber, endNumber):
    n = 0
    cur = f(n)
    while cur <= endNumber:
        if startNumber <= cur:
            print cur
        n += 1
        cur = f(n) 
```

在 python 中，我会使用迭代器形式并使用：

```
def SubFib(startNumber, endNumber):
    for cur in F():
        if cur > endNumber: return
        if cur >= startNumber:
            yield cur

for i in SubFib(10, 200):
    print i 
```

我的提示是*学会阅读*你需要的东西。Project Euler（谷歌）会训练你这样做：P祝你好运，玩得开心！

* * *

## 回答 #2

> 赞同：78
> 
> 时间：2014-07-20T02:24:24.543

# 斐波那契数列的高效 Pythonic 生成器

我在尝试获得该序列的最短 Pythonic 生成时发现了这个问题（后来意识到我在[Python Enhancement Proposal](https://www.python.org/dev/peps/pep-0255/)中看到过类似的问题），并且我没有注意到其他人提出了我的具体解决方案（尽管最佳答案很接近，但仍然不那么优雅），所以在这里，带有描述第一次迭代的评论，因为我认为这可能有助于读者理解：

```
def fib():
    a, b = 0, 1
    while True:            # First iteration:
        yield a            # yield 0 to start with and then
        a, b = b, a + b    # a will now be 1, and b will also be 1, (0 + 1) 
```

和用法：

```
for index, fibonacci_number in zip(range(10), fib()):
     print('{i:3}: {f:3}'.format(i=index, f=fibonacci_number)) 
```

印刷：

```
 0:   0
  1:   1
  2:   1
  3:   2
  4:   3
  5:   5
  6:   8
  7:  13
  8:  21
  9:  34
 10:  55 
```

（出于归因的目的，我最近注意到Python 文档中关于模块的[类似实现](https://docs.python.org/2/tutorial/modules.html)`a`，即使使用变量和`b`，我现在记得在写这个答案之前已经看到过。但我认为这个答案展示了更好地使用语言。）

# 递归定义的实现

[整数序列在线百科全书](http://oeis.org/A000045)将斐波那契数列递归定义为

> F(n) = F(n-1) + F(n-2) 其中 F(0) = 0 且 F(1) = 1

在 Python 中简洁地递归定义 this 可以如下完成：

```
def rec_fib(n):
    '''inefficient recursive function as defined, returns Fibonacci number'''
    if n > 1:
        return rec_fib(n-1) + rec_fib(n-2)
    return n 
```

但是这种数学定义的精确表示对于远大于 30 的数字来说是非常低效的，因为每个被计算的数字还必须计算它下面的每个数字。您可以使用以下方法演示它有多慢：

```
for i in range(40):
    print(i, rec_fib(i)) 
```

# 记忆递归提高效率

它可以被记忆以提高速度（这个例子利用了这样一个事实，即每次调用函数时默认关键字参数都是同一个对象，但通常你不会因为这个原因而使用可变的默认参数）：

```
def mem_fib(n, _cache={}):
    '''efficiently memoized recursive function, returns a Fibonacci number'''
    if n in _cache:
        return _cache[n]
    elif n > 1:
        return _cache.setdefault(n, mem_fib(n-1) + mem_fib(n-2))
    return n 
```

你会发现记忆的版本要快得多，并且会在你想起来喝咖啡之前迅速超过你的最大递归深度。通过执行以下操作，您可以直观地看到它的速度有多快：

```
for i in range(40):
    print(i, mem_fib(i)) 
```

（看起来我们可以做下面的事情，但它实际上并没有让我们利用缓存，因为它在调用 setdefault 之前调用了自己。）

```
def mem_fib(n, _cache={}):
    '''don't do this'''
    if n > 1:  
        return _cache.setdefault(n, mem_fib(n-1) + mem_fib(n-2))
    return n 
```

## 递归定义的生成器：

由于我一直在学习 Haskell，我在 Haskell 中遇到了这个实现：

```
fib@(0:tfib) = 0:1: zipWith (+) fib tfib 
```

我认为目前在 Python 中最接近这一点的是：

```
from itertools import tee

def fib():
    yield 0
    yield 1
    # tee required, else with two fib()'s algorithm becomes quadratic
    f, tf = tee(fib()) 
    next(tf)
    for a, b in zip(f, tf):
        yield a + b 
```

这证明了这一点：

```
[f for _, f in zip(range(999), fib())] 
```

但是，它只能达到递归限制。通常是 1000，而 Haskell 版本可以达到数百万，尽管它使用了我笔记本电脑的全部 8 GB 内存来做到这一点：

```
> length $ take 100000000 fib 
100000000 
```

### 使用迭代器获取第 n 个斐波那契数

一位评论者问：

> 基于迭代器的 Fib() 函数的问题：如果你想获得第 n 个，例如第 10 个 fib 编号怎么办？

itertools 文档对此有一个秘诀：

```
from itertools import islice

def nth(iterable, n, default=None):
    "Returns the nth item or a default value"
    return next(islice(iterable, n, None), default) 
```

现在：

```
>>> nth(fib(), 10)
55 
```

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2014-02-11T14:34:53.603

为什么不简单地执行以下操作？

```
x = [1,1]
for i in range(2, 10):  
    x.append(x[-1] + x[-2]) 
print(', '.join(str(y) for y in x)) 
```

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2009-01-30T06:15:45.237

斐波那契数列背后的思想显示在以下 Python 代码中：

```
def fib(n):
   if n == 1:
      return 1
   elif n == 0:   
      return 0            
   else:                      
      return fib(n-1) + fib(n-2) 
```

这意味着 fib 是一个可以做三件事之一的函数。它将 fib(1) == 1、fib(0) == 0 和 fib(n) 定义为：

fib(n-1) + fib(n-2)

其中 n 是任意整数。这意味着例如 fib(2) 扩展为以下算术：

```
fib(2) = fib(1) + fib(0)
fib(1) = 1
fib(0) = 0
# Therefore by substitution:
fib(2) = 1 + 0
fib(2) = 1 
```

我们可以用同样的方法计算 fib(3)，如下所示：

```
fib(3) = fib(2) + fib(1)
fib(2) = fib(1) + fib(0)
fib(2) = 1
fib(1) = 1
fib(0) = 0
# Therefore by substitution:
fib(3) = 1 + 1 + 0 
```

这里要意识到的重要一点是，不计算 fib(2) 就无法计算 fib(3)，而 fib(2) 是通过知道 fib(1) 和 fib(0) 的定义来计算的。像斐波那契函数那样调用自己的函数称为递归，它是编程中的一个重要主题。

这听起来像是一个家庭作业，所以我不会为你做开始/结束部分。尽管如此，Python 是一种极富表现力的语言，所以如果你理解数学，这应该是有意义的，并且希望能教你递归。祝你好运！

编辑：对我的代码的一个潜在批评是它没有使用超级方便的 Python 函数 yield，这使得 fib(n) 函数更短。不过，我的示例更通用一些，因为 Python 之外的许多语言实际上都没有产量。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2014-09-30T10:14:59.723

**时间复杂度：**

缓存功能通过消除斐波那契数列递归树中的重复，将计算斐波那契数列的正常方法从**O(2^n)**减少到**O(n) ：**

![在此处输入图像描述](https://i.stack.imgur.com/59Rpw.png)

**代码 ：**

```
import sys

table = [0]*1000

def FastFib(n):
    if n<=1:
        return n
    else:
        if(table[n-1]==0):
            table[n-1] = FastFib(n-1)
        if(table[n-2]==0):
            table[n-2] = FastFib(n-2)
        table[n] = table[n-1] + table[n-2]
        return table[n]

def main():
    print('Enter a number : ')
    num = int(sys.stdin.readline())
    print(FastFib(num))

if __name__=='__main__':
    main() 
```

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2016-06-02T07:47:03.287

这非常有效，使用 O(log n) 基本算术运算。

```
def fib(n):
    return pow(2 << n, n + 1, (4 << 2*n) - (2 << n) - 1) % (2 << n) 
```

这个使用 O(1) 基本算术运算，但中间结果的大小很大，因此根本没有效率。

```
def fib(n):
    return (4 << n*(3+n)) // ((4 << 2*n) - (2 << n) - 1) & ((2 << n) - 1) 
```

这个计算 X^n 在多项式环 Z[X] / (X^2 - X - 1) 中使用平方取幂。该计算的结果是多项式 Fib(n)X + Fib(n-1)，从中可以读取第 n 个斐波那契数。

同样，这使用 O(log n) 算术运算并且非常有效。

```
def mul(a, b):
        return a[0]*b[1]+a[1]*b[0]+a[0]*b[0], a[0]*b[0]+a[1]*b[1]

def fib(n):
        x, r = (1, 0), (0, 1)
        while n:
                if n & 1: r = mul(r, x)
                x = mul(x, x)
                n >>= 1
        return r[0] 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2014-02-06T15:39:57.527

用于打印斐波那契数列的规范 Python 代码：

```
a,b=1,1
while True:
  print a,
  a,b=b,a+b       # Could also use b=a+b;a=b-a 
```

对于“打印第一个大于 1000 位的斐波那契数”问题：

```
a,b=1,1
i=1
while len(str(a))<=1000:
  i=i+1
  a,b=b,a+b

print i,len(str(a)),a 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2018-01-26T10:45:27.770

我们知道

[![在此处输入图像描述](https://i.stack.imgur.com/0d8vb.gif)](https://i.stack.imgur.com/0d8vb.gif)

该矩阵的 n 次方为我们提供：

[![在此处输入图像描述](https://i.stack.imgur.com/xUDcQ.gif)](https://i.stack.imgur.com/xUDcQ.gif)

所以我们可以实现一个函数，简单地计算该矩阵的 n 次 -1 次幂。

众所周知，a^n 的幂等于

[![在此处输入图像描述](https://i.stack.imgur.com/2Qq5f.png)](https://i.stack.imgur.com/2Qq5f.png)

所以最后斐波那契函数将是 O(n)……如果不是因为我们也知道这一点，那么与更简单的实现没有什么不同，`x^n * x^n = x^2n`因此`x^n`可以用复杂度 O(log n )

这是我使用 swift 编程语言的斐波那契实现：

```
struct Mat {
    var m00: Int
    var m01: Int
    var m10: Int
    var m11: Int
}

func pow(m: Mat, n: Int) -> Mat {
    guard n > 1 else { return m }
    let temp = pow(m: m, n: n/2)

    var result = matMultiply(a: temp, b: temp)
    if n%2 != 0 {
        result = matMultiply(a: result, b: Mat(m00: 1, m01: 1, m10: 1, m11: 0))
    }
    return result
}

func matMultiply(a: Mat, b: Mat) -> Mat {
    let m00 = a.m00 * b.m00 + a.m01 * b.m10
    let m01 = a.m00 * b.m01 + a.m01 * b.m11
    let m10 = a.m10 * b.m00 + a.m11 * b.m10
    let m11 = a.m10 * b.m01 + a.m11 * b.m11

    return Mat(m00: m00, m01: m01, m10: m10, m11: m11)
}

func fibonacciFast(n: Int) -> Int {

    guard n > 0 else { return 0 }
    let m = Mat(m00: 1, m01: 1, m10: 1, m11: 0)

    return pow(m: m, n: n-1).m00
} 
```

这具有复杂性 O( log n )。我们用指数 n-1 计算 Q 的 oì 幂，然后我们取元素 m00 ，它是 Fn+1 ，在幂指数 n-1 处正是我们想要的第 n 个斐波那契数。

一旦你有了快速斐波那契函数，你就可以从开始数和结束数迭代得到你感兴趣的斐波那契数列部分。

```
let sequence = (start...end).map(fibonacciFast) 
```

当然首先对开始和结束进行一些检查，以确保它们可以形成一个有效的范围。

我知道这个问题已经有 8 年的历史了，但无论如何我回答都很开心。:)

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2013-04-11T13:53:43.343

使用递归：

```
def fib(n):
    if n == 0:
        return 0
    elif n == 1:
        return 1
    else:
        return fib(n-1) + fib(n-2)
x=input('which fibonnaci do you want?')
print fib(x) 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2016-03-14T09:33:26.497

斐波那契数列是：`1, 1, 2, 3, 5, 8, ...`.

即`f(1) = 1`, `f(2) = 1`, `f(3) = 2`, `...`, `f(n) = f(n-1) + f(n-2)`。

我最喜欢的实现（与其他实现相比最简单但实现了光速）是这样的：

```
def fibonacci(n):
    a, b = 0, 1
    for _ in range(1, n):
        a, b = b, a + b
    return b 
```

**测试**

```
>>> [fibonacci(i) for i in range(1, 10)]
[1, 1, 2, 3, 5, 8, 13, 21, 34] 
```

**定时**

```
>>> %%time
>>> fibonacci(100**3)
CPU times: user 9.65 s, sys: 9.44 ms, total: 9.66 s
Wall time: 9.66 s 
```

编辑：此实现[的示例可视化。](http://www.pythontutor.com/visualize.html#code=def+fibonacci(n%29%3A%0A++++a,+b+%3D+0,+1%0A++++for+_+in+range(1,+n%29%3A%0A++++++++a,+b+%3D+b,+a+%2B+b%0A++++return+b%0A++++%0Afibonacci(10%29&mode=display&origin=opt-frontend.js&cumulative=false&heapPrimitives=false&textReferences=false&py=3&rawInputLstJSON=%5B%5D&curInstr=0)

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2014-02-07T06:05:27.013

另一种方法：

```
a,n=[0,1],10
map(lambda i: reduce(lambda x,y: a.append(x+y),a[-2:]),range(n-2)) 
```

将列表分配给'a'，将整数分配给'n' Map 和reduce 是python 中三个最强大的函数中的两个。这里的 map 仅用于迭代“n-2”次。a[-2:] 将获取数组的最后两个元素。a.append(x+y) 将添加最后两个元素并将追加到数组

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2019-06-07T14:21:42.760

如果您喜欢递归，您可以使用`lru_cache`装饰器轻松缓存结果（最近最少使用的缓存装饰器）

```
from functools import lru_cache

@lru_cache()
def fib(n):
    if n == 0:
        return 0
    elif n == 1:
        return 1
    else:
        return fib(n-1) + fib(n-2) 
```

如果您需要缓存超过 128 个值，您可以将`maxsize`其作为参数传递给`lru_cache`(例如`lru_cache(maxsize=500)`。如果您设置`maxsize=None`缓存可以无限制地增长。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2014-02-02T04:59:00.810

这些看起来都比他们需要的要复杂一些。我的代码非常简单快速：

```
def fibonacci(x):

    List = []
    f = 1
    List.append(f)
    List.append(f) #because the fibonacci sequence has two 1's at first
    while f<=x:
        f = List[-1] + List[-2]   #says that f = the sum of the last two f's in the series
        List.append(f)
    else:
        List.remove(List[-1])  #because the code lists the fibonacci number one past x. Not necessary, but defines the code better
        for i in range(0, len(List)):
        print List[i]  #prints it in series form instead of list form. Also not necessary 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2015-11-01T04:35:36.870

好的..在厌倦了所有冗长的答案之后，现在找到下面的排序和甜蜜，非常直接的方式来在 python 中实现斐波那契。您可以通过获取参数或获取用户输入以您想要的方式对其进行增强……或将限制从 10000 更改。根据需要……</p>

```
def fibonacci():
    start = 0 
    i = 1 
    lt = []
    lt.append(start)
    while start < 10000:
        start += i
        lt.append(start)
        i = sum(lt[-2:])
        lt.append(i)
    print "The Fibonaccii series: ", lt 
```

这种方法也表现良好。在下面找到运行分析

```
In [10]: %timeit fibonacci
10000000 loops, best of 3: 26.3 ns per loop 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2016-09-01T17:21:27.160

这是对 mathew henry 答案的改进：

```
def fib(n):
    a = 0
    b = 1
    for i in range(1,n+1):
            c = a + b
            print b
            a = b
            b = c 
```

代码应该打印 b 而不是打印 c

输出：1,1,2,3,5 ....

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2016-09-21T09:48:48.033

**有一个非常简单的方法来实现这一点！**

您可以使用[http://www.learnpython.org/在线免费运行此代码](http://www.learnpython.org/)

```
# Set the variable brian on line 3!

def fib(n):
"""This is documentation string for function. It'll be available by fib.__doc__()
Return a list containing the Fibonacci series up to n."""
result = []
a = 0
b = 1
while a < n:
    result.append(a)  # 0 1 1 2 3 5  8  (13) break
    tmp_var = b       # 1 1 2 3 5 8  13
    b = a + b         # 1 2 3 5 8 13 21
    a = tmp_var       # 1 1 2 3 5 8  13
    # print(a)
return result

print(fib(10))
# result should be this: [0, 1, 1, 2, 3, 5, 8] 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2016-11-04T16:11:18.867

使用 for 循环并仅打印结果

```
def fib(n:'upto n number')->int:
    if n==0:
        return 0
    elif n==1:
        return 1
    a=0
    b=1
    for i in range(0,n-1):
        b=a+b
        a=b-a
    return b 
```

结果

```
>>>fib(50)
12586269025
>>>>
>>> fib(100)
354224848179261915075
>>> 
```

打印`list`包含所有数字的

```
def fib(n:'upto n number')->int:
    l=[0,1]
    if n==0:
        return l[0]
    elif n==1:
        return l
    a=0
    b=1
    for i in range(0,n-1):
        b=a+b
        a=b-a
        l.append(b)
    return l 
```

结果

```
>>> fib(10)
[0, 1, 1, 2, 3, 5, 8, 13, 21, 34, 55] 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2016-11-22T04:39:18.090

```
import time
start_time = time.time()

#recursive solution
def fib(x, y, upperLimit):
    return [x] + fib(y, (x+y), upperLimit) if x < upperLimit else [x]

#To test :

print(fib(0,1,40000000000000))
print("run time: " + str(time.time() - start_time)) 
```

结果

[0、1、1、2、3、5、8、13、21、34、55、89、144、233、377、610、987、1597、2584、4181、6765、10946、17711、28657、46368 ，75025，121393，196418，317811，514229，832040，1346269，2178309，3524578，5702887，9227465，14930352，24157817，39088169，63245986，102334155，165580141，267914296，433494437，701408733，1134903170，1836311903，2971215073，4807526976，7778742049 ，12586269025，20365011074，32951280099，53316291173，86267571272，139583862445，225851433717，365435296162，591286729879，956722026041，1548008755920，2504730781961，4052739537881，6557470319842，10610209857723，17167680177565，27777890035288，44945570212853]

运行时间：**0.04298138618469238**

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2018-01-09T06:50:21.163

优化内存查找斐波那契功能

```
def fib(n, a=[0, 1]):
    while n > len(a):
        a.append(a[-1] + a[-2])
    return a[n-1]

print("Fibonacci of 50 - {}".format(fib(50)) 
```

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2019-05-17T11:29:10.500

可以通过以下方式完成。

```
n = 0

数字 = [0]

对于范围内的我（0,11）：
    打印 n,
    numbers.append(n)
    上一页 = 数字[-2]
    如果 n == 0：
        n = 1
    别的：
        n = n + 上一个

```

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2019-11-30T16:24:51.300

只是为了好玩，在 Python 3.8+ 中，您可以在列表理解中使用[赋值表达式](https://www.python.org/dev/peps/pep-0572/)（又名海象运算符），例如：

```
>>> a, b = 0, 1
>>> [a, b] + [b := a + (a := b) for _ in range(8)]  # first 10 Fibonacci numbers
[0, 1, 1, 2, 3, 5, 8, 13, 21, 34] 
```

赋值表达式允许您为变量赋值*并*在同一个表达式中返回它。因此，表达式

```
b := a + (a := b) 
```

相当于执行

```
a, b = b, a + b 
```

并返回 的值`b`。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2021-01-09T19:50:21.163

[![斐波那契](https://i.stack.imgur.com/dGsrZ.gif)](https://i.stack.imgur.com/dGsrZ.gif)

斐波那契数列如果你不知道那基本上是你打印出一个数字，你打印出的每个数字都是前两个数字相加。

```
a, b = 0,1 
for i in range(0, 10):
    print(a)
    a, b = b, a + b 
```

输出：

```
0
1
1
2
3
5
8
13
21
34 
```

所以 0 和 1 如果你把它们加在一起它等于 1 如果你把 1 和 1 加起来它等于 2 如果你把 1 和 2 加起来它等于 3 并且它继续前进并且继续前进。

* * *

我使用生成器编写的斐波那契数列：

```
def fib(num): 
    a, b = 0,1 
    for i in range(0, num):
        yield "{}: {}".format(i+1, a)
        a, b = b, a + b

for item in fib(10):
    print(item) 
```

输出：

```
1: 0
2: 1
3: 1
4: 2
5: 3
6: 5
7: 8
8: 13
9: 21
10: 34 
```

我们之前讨论过的斐波那契数列，除了现在我们在这里有一个函数`yield`s 并且`yield`是让您知道它是生成器的关键字。

*   因此，它会产生您的结果，然后我们可以遍历生成器并打印出每个项目。
*   如果我们运行，那么我们可以看到它仍然像以前一样工作，但是现在我们使用生成器，它比返回列表更有优势，但是有时你不想使用生成器。
*   你需要做你的研究，弄清楚什么时候你真的从发电机那里获得了这些优势，什么时候它们可能不是你的最佳选择。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2011-06-27T20:42:31.413

```
def fib():
    a,b = 1,1
    num=eval(input("Please input what Fib number you want to be calculated: "))
    num_int=int(num-2)
    for i in range (num_int):
        a,b=b,a+b
    print(b) 
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2011-10-24T07:53:33.303

在我学习 Python 时使用的教程 15 分钟后，它要求读者编写一个程序，该程序将根据 3 个输入数字（第一个斐波那契数字、第二个数字和停止序列的数字）计算斐波那契数列。本教程仅涵盖了变量、if/thens 和循环到该点。还没有功能。我想出了以下代码：

```
sum = 0
endingnumber = 1                

print "\n.:Fibonacci sequence:.\n"

firstnumber = input("Enter the first number: ")
secondnumber = input("Enter the second number: ")
endingnumber = input("Enter the number to stop at: ")

if secondnumber < firstnumber:

    print "\nSecond number must be bigger than the first number!!!\n"

else:

while sum <= endingnumber:

    print firstnumber

    if secondnumber > endingnumber:

        break

    else:

        print secondnumber
        sum = firstnumber + secondnumber
        firstnumber = sum
        secondnumber = secondnumber + sum 
```

如您所见，它确实效率低下，但确实有效。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2013-09-12T11:53:24.797

刚刚通过[http://projecteuler.net/problem=2](http://projecteuler.net/problem=2)这是我的看法

```
# Even Fibonacci numbers
# Problem 2

def get_fibonacci(size):
    numbers = [1,2]
    while size > len(numbers):
        next_fibonacci = numbers[-1]+numbers[-2]
        numbers.append(next_fibonacci)

    print numbers

get_fibonacci(20) 
```

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2013-11-24T01:09:50.820

```
def fib(x, y, n):
    if n < 1: 
        return x, y, n
    else: 
        return fib(y, x + y, n - 1)

print fib(0, 1, 4)
(3, 5, 0)

#
def fib(x, y, n):
    if n > 1:
        for item in fib(y, x + y, n - 1):
            yield item
    yield x, y, n

f = fib(0, 1, 12)
f.next()
(89, 144, 1)
f.next()[0]
55 
```

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2014-03-07T19:11:55.797

也许这会有所帮助

```
def fibo(n):
    result = []
    a, b = 0, 1
    while b < n:
            result.append(b)
            a, b = b, b + a
    return result 
```

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2015-02-11T18:01:18.047

基于经典的斐波那契数列，只是为了单线

如果你只需要索引的数量，你可以使用reduce（即使*reduce*不是最适合这个，它也是一个很好的练习）

```
def fibonacci(index):
    return reduce(lambda r,v: r.append(r[-1]+r[-2]) or (r.pop(0) and 0) or r , xrange(index), [0, 1])[1] 
```

要获得完整的数组，只需删除*or (r.pop(0) and 0)*

```
reduce(lambda r,v: r.append(r[-1]+r[-2]) or r , xrange(last_index), [0, 1]) 
```

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2015-02-22T14:58:04.753

这个怎么样？我想它不像其他建议那么花哨，因为它需要先前结果的初始规范才能产生预期的输出，但我觉得这是一个非常易读的选项，即它所做的只是将结果和先前的结果提供给递归。

```
#count the number of recursions
num_rec = 0

def fibonacci(num, prev, num_rec, cycles):

    num_rec = num_rec + 1

    if num == 0 and prev == 0:
        result  = 0;
        num = 1;
    else:
        result = num + prev

    print(result)

    if num_rec == cycles:
        print("done")
    else:
        fibonacci(result, num, num_rec, cycles)

#Run the fibonacci function 10 times
fibonacci(0, 0, num_rec, 10) 
```

这是输出：

```
0
1
1
2
3
5
8
13
21
34
done 
```

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2015-10-22T23:09:13.970

基本上是从 Ruby 翻译过来的：

```
def fib(n):
    a = 0
    b = 1
    for i in range(1,n+1):
            c = a + b
            print c
            a = b
            b = c 
```

...

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2015-11-12T19:29:58.330

```
def fib(lowerbound, upperbound):
    x = 0
    y = 1
    while x <= upperbound:
        if (x >= lowerbound):
            yield x
        x, y = y, x + y

startNumber = 10
endNumber = 100
for fib_sequence in fib(startNumber, endNumber):
    print "And the next number is... %d!" % fib_sequence 
```

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2015-12-17T06:47:27.117

更详细地解释了记忆化如何适用于斐波那契数列。

```
# Fibonacci sequence Memoization

fib_cache = {0:0, 1:1}

def fibonacci(n):
    if n < 0:
        return -1
    if fib_cache.has_key(n):
        print "Fibonacci sequence for %d = %d cached" % (n, fib_cache[n])
        return fib_cache[n]
    else:
        fib_cache[n] = fibonacci(n - 1) + fibonacci(n - 2)
    return fib_cache[n]

if __name__ == "__main__":
    print fibonacci(6)
    print fib_cache
    # fibonacci(7) reuses fibonacci(6) and fibonacci(5)
    print fibonacci(7)
    print fib_cache 
```

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2015-12-31T05:51:31.470

我试图避免使用递归函数来解决这个问题，所以我采用了迭代方法。我最初是在做一个记忆递归函数，但一直在达到最大递归深度。我也有严格的内存目标，所以你会看到我在循环过程中尽可能小地保持数组，只在数组中随时保留 2-3 个值。

```
def fib(n):
    fibs = [1, 1] # my starting array
    for f in range(2, n):
        fibs.append(fibs[-1] + fibs[-2]) # appending the new fib number
        del fibs[0] # removing the oldest number
    return fibs[-1] # returning the newest fib

print(fib(6000000)) 
```

在我的机器上获得第 6 百万个斐波那契数大约需要 282 秒，而 600k 斐波那契数只需要 2.8 秒。我无法使用递归函数获得如此大的斐波那契数，即使是记忆函数也是如此。

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2016-08-29T20:23:11.717

递归增加了时间。要消除循环，首先`import math`. 然后`math.sqrt`在函数中使用和黄金比例：

```
#!/usr/bin/env python3

import math

def fib(n):
    gr = (1 + math.sqrt(5)) / 2
    fib_first = (gr**n - (1 - gr)**n) / math.sqrt(5)
    return int(round(fib_first))

fib_final = fib(100)

print(fib_final) 
```

参考：[Python 中的斐波那契数列](http://mortada.net/fibonacci-numbers-in-python.html)

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2017-05-17T08:24:28.340

这是用于斐波那契数列的 python 中最简单的一个，但通过 append() 在输出数组中调整 [0] 以产生结果列表第二个变量，即`result.append(second)`

```
def fibo(num):
    first = 0
    second = 1
    result = [0]
    print('Fibonacci series is')
    for i in range(0,num):
        third = first + second
        #print(second)
        result.append(second)
        first = second
        second = third
    print(result)
    return
fibo(7) 
```

输出

```
Fibonacci series is
[0, 1, 1, 2, 3, 5, 8, 13] 
```

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2017-09-21T18:57:27.377

使用 append 函数生成前 100 个元素。

```
def generate():
    series = [0, 1]
    for i in range(0, 100):
        series.append(series[i] + series[i+1])

    return series

print(generate()) 
```

* * *

## 回答 #37

> 赞同：0
> 
> 时间：2018-09-01T21:57:38.533

在更短的格式上：

```
def fibbo(range_, a, b):
    if(range_!=0):
        a, b = b, a+b
        print(a)
        return fibbo(range_-1, a, b)
    return

fibbo(11, 1, 0) 
```

* * *

## 回答 #38

> 赞同：0
> 
> 时间：2018-10-10T17:16:04.203

通过调用函数和模块化来做这个解决方案

```
def userInput():
    number = int(input('Please enter the number between 1 - 40 to find out the 
    fibonacci :'))
    return number

def findFibonacci(number):
    if number == 0:
        return 0
    elif number == 1:
        return 1
    else:
        return findFibonacci(number - 1) + findFibonacci (number - 2)

def main():
    userNumber = userInput()
    print(findFibonacci(userNumber))

main() 
```

* * *

## 回答 #39

> 赞同：0
> 
> 时间：2019-01-17T06:01:19.477

简单斐波那契：

```
def fibo(start, count):
    a = [start, start+1]
    for i in range(count-len(a)):
        a.append(a[-1]+a[-2])
    return a
a = fibo(0, 10)
print 'fibo', a 
```

**输出：** `[0, 1, 1, 2, 3, 5, 8, 13, 21, 34]`

斐波那契写成生成器：

```
# fill in this function
def fib():
    a = 1
    b = 1
    yield(a)
    yield(b)
    for i in range(2, 10):
        c = a+b
        a, b = b, c
        yield(c)
    #pass #this is a null statement which does nothing when executed, useful as a placeholder.

# testing code
import types
if type(fib()) == types.GeneratorType:
    print("Good, The fib function is a generator.")

    counter = 0
    for n in fib():
        print(n)
        counter += 1
        if counter == 10:
            break 
```

* * *

## 回答 #40

> 赞同：0
> 
> 时间：2020-05-01T12:14:58.260

好吧，有很多方法。我已经使用列表来解决这个问题。下面是工作代码...如果有任何反馈，请随时发表评论

```
def fib(n):
    if n == 0: #to start fibonacci seraries value must be >= 1
        print('Enter postive integer')
    elif n ==1:
        print(0)
    else:
        li = [0, 1]
        for i in range(2, n): # start the loop from second index as 'li' is assigned for 0th and 1st index
            li.append(li[-1] + li[-2])
            i += 1
        print(*li)  # '*' is used to print elements from list in single line with spaces

n = int(input('Enter the number for which you want to generate fibonacci series\n'))
fib(n) 
```

* * *

## 回答 #41

> 赞同：0
> 
> 时间：2020-08-16T13:43:14.173

```
def fib(n):
    """
    n >= 1, the number of elements in the Fibonacci sequence
    """
    x, y = 0, 1
    for i in range(n):
        yield x
        x, y = y, x + y 
```

* * *

## 回答 #42

> 赞同：0
> 
> 时间：2021-08-02T18:24:12.450

简单的斐波那契数列：

```
def fib(x):
    b = 1
    c = 0
    print(0)
    for i in range(x - 1):
        a = b
        b = c
        c = a + b
        print(c) 
```

* * *

## 回答 #43

> 赞同：-1
> 
> 时间：2017-11-21T03:55:25.220

这与已发布的内容相似，但它干净、快速且易于阅读。

```
def fib(n):
# start with first two fib numbers
fib_list = [0, 1]
i = 0
# Create loop to iterate through n numbers, assuming first two given
while i < n - 2:
    i += 1
    # append sum of last two numbers in list to list
    fib_list.append(fib_list[-2] + fib_list[-1])
return fib_list 
```

* * *

## 回答 #44

> 赞同：-1
> 
> 时间：2018-12-30T03:46:09.273

**简单的定义**——试试这个..

```
def fib(n):
    first = 0
    second = 1
    holder = 0
    array = []
    for i in range(0, n):
      first = second
      second = holder
      holder = first + second
      array.append(holder)
    return array

input -> 10
output -> [1, 1, 2, 3, 5, 8, 13, 21, 34, 55] 
```

* * *

## 回答 #45

> 赞同：-1
> 
> 时间：2019-04-02T15:21:59.183

```
# num is the number up to which your list will go
#first I created a list, and I wanted to code #everything, but obviously, I could have typed l = [0,1]

def fab(num):

    l = []
    for k in range(0,2):
        l.append(k)

    while l[-1]<num:
        x = l[-1]+l[-2]

        if x>=num:
            break
        else:
            l.append(x)

    return l 
```

* * *

## 回答 #46

> 赞同：-2
> 
> 时间：2020-01-10T09:21:17.903

python中的斐波那契数列，通过创建空列表：

```
 inp=int(input())     #size of the series example it is 7
                   n=0
                   n1=1
                   x=[]                 #blank list
                   x.insert(0,0)    #initially insert 0th position 0 element
                   for i in range(0,inp-1):
                    nth=n+n1
                    n=n1                  #swapping the value
                    n1=nth
                    x.append(n)          #append all the values to null list
                   for i in x:        #run this loop so ans is 0 1 1 2 3 5 8
                    print(i,end=" ") 
```

* * *

## 回答 #47

> 赞同：-5
> 
> 时间：2019-05-12T17:39:42.983

你们能看看这个吗，我认为它很棒而且很容易理解。

```
i = 0
First_Value = 0
Second_Value = 1

while(i < Number):
       if(i <= 1):
                  Next = i
       else:
                  Next = First_Value + Second_Value
                  First_Value = Second_Value
                  Second_Value = Next
       print(Next)
       i = i + 1 
```

# c++ - C++ 成员变量别名？

> ID：494597
> 
> 赞同：13
> 
> 时间：2009-01-30T05:50:22.543
> 
> 标签：c++, struct, variables, alias, member

我很确定这是可能的，因为我很确定我已经看到它完成了。我认为这很棒，但我很乐意接受“这是一个糟糕的想法，因为____”这样的答案。

假设我们有一个基本结构。

```
struct vertex
{
    float x, y, z;
}; 
```

现在，我想在这些变量上实现别名。

```
vertex pos;
vertex col;
vertex arr;

pos.x = 0.0f; pos.y = 0.5f; pos.z = 1.0f;
col.r = 0.0f; col.g = 0.5f; col.b = 1.0f;
arr[0] = 0.0f; arr[1] = 0.5f; arr[2] = 1.0f; 
```

理想情况下，第三种语法与数组无法区分。也就是说，如果我将`arr`作为参考参数发送给一个函数，该函数需要一个浮点数组来存储数据（例如许多 OpenGL`glGet`函数），它会正常工作。

你怎么看？可能的？可能但愚蠢？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-01-30T06:12:45.947

我要做的是制作访问器：

```
struct Vertex {
    float& r() { return values[0]; }
    float& g() { return values[1]; }
    float& b() { return values[2]; }

    float& x() { return values[0]; }
    float& y() { return values[1]; }
    float& z() { return values[2]; }

    float  operator [] (unsigned i) const { return this->values_[i]; }
    float& operator [] (unsigned i)       { return this->values_[i]; }
    operator float*() const { return this->values_; }

private:
    float[3] values_;
} 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-01-30T05:59:23.930

使用工会？

```
union vertex
{
    struct { float x, y, z; };
    struct { float r, g, b; };
    float arr[3];
}; 
```

我不会推荐它——它会导致混乱。

* * *

*补充*：

正如 Adrian 在他的回答中所指出的，ISO C++ 不支持这种具有匿名结构成员的联合。它在 GNU G++ 中工作（当您打开 ' ' 时会抱怨不支持`-Wall -ansi -pedantic`）。这让人想起了标准之前的 C 天（K&R 第一版之前），当结构元素名称必须在所有结构中唯一时，您可以使用收缩符号来获得结构内的偏移量，并且您可以使用来自其他结构类型的成员名称 - 一种无政府状态。当我开始使用 C 时（很久以前，但在 K&R1 之后），这已经是历史用法了。

C11 (ISO/IEC 9899:2011) 支持匿名联合成员（对于两个结构）显示的符号，但早期版本的 C 标准不支持。ISO/IEC 14882:2011 (C++11) 的第 9.5 节提供匿名联合，但 GNU `g++`(4.9.1) 不接受用 显示的代码`-pedantic`，标识“ `warning: ISO C++ prohibits anonymous structs [-Wpedantic]`”。

由于这个想法会导致混乱，我并不特别担心它不是标准的。我不会为这项任务使用该机制（即使它是有益的，我也会对在联合中使用匿名结构持谨慎态度）。

* * *

提出了一个担忧：

> 这三个（xyz、rgb 和数组）不一定对齐。

它是一个由三个元素组成的联合体；这三个元素从同一个地址开始。前两个是包含 3 个浮点值的结构。没有继承，也没有虚拟函数来提供不同的布局等。结构将以连续的三个元素进行布局（实际上，即使标准允许填充）。该数组也从相同的地址开始，并且在结构中“无填充”的情况下，元素与两个结构重叠。我真的不认为会有问题。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-01-30T07:12:23.283

联合中的无名嵌套结构不是标准 C++。但是，这应该有效：

```
struct Vertex
{
private:
   typedef float Vertex::* const vert[3];
   static const vert v;

public:
   typedef size_t size_type;
   float x, y, z;

   const float& operator[](size_type i) const {
      return this->*v[i];
   }

   float& operator[](size_type i) {
      return this->*v[i];
   }

};

const Vertex::vert Vertex::v = {&Vertex::x, &Vertex::y, &Vertex::z}; 
```

编辑：更多信息。该结构使用由 3 个指向数据成员的指针组成的数组来访问重载的 [] 运算符中的数据。

“typedef float Vertex::* const vert”这一行意味着 vert 是一个指向 Vertex 结构的 float 成员的指针。[3] 表示它是其中 3 个的数组。在重载的 operator[] 中，该数组被索引，指向数据成员的指针被取消引用并返回值。

此外，无论打包问题如何，此方法都应该有效 - 编译器可以随意填充 Vertex 结构，但它仍然可以正常工作。如果浮动包装不同，匿名联合将遇到问题。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-30T13:05:23.710

参考？

```
template<typename T>
struct vertex {
    vertex() :
        r(data[0]), g(data[1]), b(data[2]),
        x(data[0]), y(data[1]), z(data[2])
    {
    }

    T *operator *() {
        return data;
    }

    const T *operator *() const {
        return data;
    }

    T data[3];
    T &r, &g, &b;
    T &x, &y, &z;
}; 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-30T06:05:20.733

正如其他人所提到的，您可以通过工会获得这个。像这样将颜色和位置重载到相同的结构上可能不是一个好主意（例如，添加两种颜色通常意味着您想要饱和到 1.0，而添加向量是线性发生的），但是在它们之上覆盖一个 float[] 就像这非常好，并且是与 GL/DirectX/等交换数据的公认方法。

不过，我建议您避免在同一函数范围内通过不同别名来引用同一成员，因为这会将您带入一个称为 load-hit-store 的令人讨厌的硬件停顿。如果可以的话，尤其要避免这种情况：

```
vector foo; 
foo.x = 1.0f;
return foo[0] + foo[1]; 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2015-03-24T16:38:04.647

以下结构将具有请求的行为：

```
struct vertex
{
private:
    float data[3];
public:
    float &x, &y, &z;
    float &r, &g, &b;

    vertex() : x(data[0]), y(data[1]), z(data[2]), r(data[0]), g(data[1]), b(data[2]) {
    }

    float& operator [](int i) { 
        return data[i];
    }
}; 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-30T05:59:39.077

我想你可以做一些宏观魔术来得到你想要的。但这看起来很难看。为什么要对 3 种不同类型使用相同的结构和顶点？为什么不能为颜色定义类？还要记住，顶点和颜色是不一样的。如果您将某些内容更改为顶点，那也会影响颜色，如果您对两者都有相同的类。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-30T06:11:22.127

我不确定我是否正确理解了这个问题。但看起来您需要重载 operator[] 以提供类似数组的访问您的结构/类。请参阅此处提到的示例：[运算符重载](http://www.parashift.com/c++-faq-lite/operator-overloading.html#faq-13.4)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-30T13:49:50.250

我认为这是个坏主意，至少对于给出的示例：缺点是，对于任何解决方案，您可能都可以自由地将“rgb”实例分配给/来自“xyz”实例，这可能很少是明智或正确的。即你冒着放弃一些有用的类型安全的风险。

就个人而言，对于您给出的示例，我将 rgb 和 xyz 类型从基类`boost::array<float,3>`或类似类型中子类化。因此它们都继承了 operator[]，可以传递给期望数组的函数，并以更安全的类型传递给期望颜色/坐标的事物。您通常希望将 xyz 或 rgb 视为数组，但很少将 xyz 视为 rgb，反之亦然。（rgb IS-A 数组：OK。xyz IS-A 数组：OK。rgb IS-A xyz ????我不这么认为！）

当然，这意味着对 x,y,z 和 r,g,b 的访问需要通过访问者（转发给适当的`operator[](...)`）而不是直接访问成员。（为此，您需要 C# 的属性）。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-30T10:20:39.113

我在下面有一个模板和两个 Vector 类，一个疯狂，一个理智。该模板实现了一个简单的在编译时固定的值数组。它专为子类化而设计，并使用受保护的数组变量来避免您必须跳过箍来访问数组。（有些人可能不喜欢这样的设计。我说，如果你的子类调用你的重载运算符，耦合可能是个好主意。）

这个疯狂的类允许你拥有名为 x、y、z 的成员变量，它就像一个用于调用 glGetFloatV 的数组。理智的只有访问函数 x()、y()、z() 并且仍然可以与 glGetFloatV 一起使用。您可以使用任一类作为您可能传递给 OpenGL 库的其他矢量对象的基础。尽管下面的类是特定于点的，但显然您可以进行搜索/替换以将它们变成 rgb 颜色类。

疯狂的类是疯狂的，因为语法糖 vec.x 而不是 vec.x() 的成本是 3 个参考变量。在大型应用程序中，这可能会占用大量空间。使用更简单的健全版本。

```
template <typename T, int N>
class FixedVector {
protected:
    T arr[N];
public:
    FixedVector();

    FixedVector(const T* a) {
        for (int i = 0; i < N; ++i) {
            arr[i] = a[i];
        }
    }

    FixedVector(const T& other) {
        for (int i = 0; i < N; ++i) {
            arr[i] = other.arr[i];
        }
    }

    FixedVector& operator=(const T& other) {
        for (int i = 0; i < N; ++i) {
            arr[i] = other.arr[i];
        }
        return *this;
    }

    T* operator&() { return arr; }
    const T* operator&() const { return arr; }

    T& operator[](int ofs) { 
        assert(ofs >= 0 && ofs < N);
        return arr[ofs];
    }
    const T& operator[](int ofs) const { 
        assert(ofs >= 0 && ofs < N);
        return arr[ofs];
    }
};

class CrazyPoint :  public FixedVector<float, 3> {
public:
    float &x, &y, &z;

    CrazyPoint()
      : x(arr[0]), y(arr[1]), z(arr[2])
    { arr[0] = arr[1] = arr[2] = 0.0; }

    CrazyPoint(const float* a)
      : x(arr[0]), y(arr[1]), z(arr[2])
    {
        arr[0] = a[0];
        arr[1] = a[1];
        arr[2] = a[2];
    }

    CrazyPoint(float a, float b, float c) 
      : x(a), y(b), z(c)
    {
        arr[0] = a;
        arr[1] = b;
        arr[2] = c;
    }
};

class SanePoint : public FixedVector<float, 3> {
public:
    float& x() { return arr[0]; }
    float& y() { return arr[1]; }
    float& z() { return arr[2]; }

    SanePoint() { arr[0] = arr[1] = arr[2] = 0.0; }
    SanePoint(float a, float b, float c) 
    {
        arr[0] = a;
        arr[1] = b;
        arr[2] = c;
    }
};

// usage
SanePoint normal;
glGetFloatV(GL_CURRENT_NORMAL, &normal); 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-30T13:07:19.103

您可以尝试添加对变量的引用，如下所示：

```
struct test {
        float x, y, z;
        float &r, &g, &b;

        test() : r(x), g(y), b(z) {}
    }; 
```

但是你的结构变得更大（从 12 字节到 40 字节）。

要在其上使用 []，请使用 operator[] 的重载，如前所述。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-08T16:54:38.270

只是关于使用指向值成员的引用成员的警告。如果您曾经复制过这样的对象（例如按值传输），则需要定义一个复制构造函数（可能还有赋值运算符）。默认的复制构造函数将为您留下一个副本，其引用成员指向原始对象的值成员，而不是新对象的值成员。这当然不是你想要的。

正如已经指出的那样，考虑到您最终还会得到更大的对象，我认为使用访问器方法优于引用成员。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2022-02-18T20:26:46.953

我认为张贴者正在寻找一些非常简单的东西，没有性能开销 - 正如你想要的 3D 矢量类之类的东西。因此，添加虚函数（vtable 间接成本）、额外成员（内存成本）、联合（每个新名称可能需要重新编译所有用户），甚至预处理器魔法（增加程序大小、跨类型等效性）都是不可取的。

现实世界的用例是采用模板化的 Vector3 类（可以是基于双精度或基于浮点的）并以用户友好的方式将其应用于其他场景。它可能是用 [x, y, z] 成员定义的，但如果您想将其用于旋转，您可能需要 [psi, theta, phi]，用于速度 [dx, dy, dz] 等。

对于整个类型，您可以在编译时使用以下命令对其进行别名： using Rotation3 = Vector3;

但是似乎没有什么比为基础变量别名更简单或高效的方法了，对吧？

# continuous-integration - 使用持续集成服务器进行家庭开发

> ID：494599
> 
> 赞同：6
> 
> 时间：2009-01-30T05:51:02.683
> 
> 标签：continuous-integration, cruisecontrol.net, build-automation

[作为我之前的一篇文章“使用版本控制进行家庭开发](https://stackoverflow.com/questions/360887/using-version-control-for-home-development)”的后续工作，我现在询问有关将构建服务器用于宠物项目的意见。

最近我一直在阅读有关“构建服务器”概念的文章，并查看了 Maven 和 CruiseControl.Net 等应用程序。

因此我问，**在我的家庭宠物项目中使用像 CruiseControl.Net 这样的东西有多可行？**

我问的原因是我认为这些构建服务器主要针对团队项目......但话又说回来，我对这个自动构建过程仍然很陌生。

请记住，大多数时候，这些宠物项目只由一个人处理，而不是一个团队。

*那么我应该更多地研究这个概念以便在家中使用，还是应该为了经验而对其进行一些练习？*

**[编辑]**

尽管我感谢大家就 CC.Net 等替代方案的回答，但还没有人真正解决*实施家庭开发构建系统是否可行*的问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-30T16:46:35.167

为您的家庭项目实施构建服务器是完全可行的。我自己为我的家庭项目实施了 CC.Net，即使是第一次这样做也很容易。我会说学习曲线（取决于你的经验）不到一天就可以开始和构建你的第一个项目，尽管当你深入研究一些更有趣的细节时，这条曲线上总是有更长的尾巴。

对我来说，问题更多是对这些项目进行持续集成的动机之一。如果您正在使用与“一次性项目”同义的“家庭项目”，那么除非您专门将其用作 CI 学习练习，否则为 CI 带来麻烦可能没有多大意义。

但是，假设这些不是您正在谈论的一次性项目，我发现（除了自动化的更明显好处之外）实施 CI 有助于减少回到您已经离开的项目所涉及的开销一段时间。当然，在这方面，单元测试是最有价值的资产，但是单元测试与自动化构建/部署过程的结合确实可以让您在设置项目后回到项目时专注于新的和更改的需求一阵子。

此外，正如 mghie 在对此答案的评论中指出的那样，“如果它们相互构建，CI 将为家庭项目带来更大的好处，因此一个项目的更改可能会导致构建中断其他项目。”

我的建议是，只做一次，这样您就可以更清楚地了解所涉及的内容以及您可能获得的好处和可能产生的缺点。然后自己决定是否值得继续做。就像我说的那样，学习曲线相当低，所以你必须进行的投资只是尝试一下不应该成为不这样做的理由。

简而言之：可行 - 是的，适合家庭项目 - 很有可能，值得进一步调查 - 绝对，投资 - 相对较低

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-30T06:01:04.627

作为 CC.Net 的替代品，我建议您看看[TeamCity，](http://www.jetbrains.com/teamcity/)它真的很容易设置并启动和运行。

相关问题：

*   [独立开发人员的最佳持续集成设置 (.NET)](https://stackoverflow.com/questions/264307/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-30T05:55:32.500

我几个月前安装了 CC.net，我花了整整一夜来配置它并创建 xml 配置，我对此并不后悔，它与 SVN、Nunit、Nant 或 Msbuild 顺利集成。只有在获得经验时才应尝试

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-30T06:00:01.477

看看哈德森，它很容易。您只需在 Tomcat 或您使用容器的任何其他 servlet 中进行部署。一旦启动，每个配置都可以使用浏览器完成。Hudson 支持 maven、ant 等，并支持所有主要的 SCM。过去一年我一直在使用 hudson，没有遇到任何麻烦。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-30T12:34:38.280

CC.NET 非常可行，实际上具有免费成本和广泛支持的操作。更不用说因为您可以获得源代码，您可以根据您的需要对其进行修改，我无法想象有更好的选择。我阅读了其他关于设置有多困难的合规性文件，但老实说，我在一个小时内完成了我的第一个简单的 TFS/VS2005 项目。请记住，如果您遇到任何问题或障碍，CC.NET 有一个非常活跃的 google 组供用户和开发人员使用，他们愿意帮助您解决任何问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-30T20:22:37.853

我喜欢 CC.NET，我是 CI 的忠实拥护者，但我不得不问：项目只有一个开发人员，存在哪些集成场景？难道你不只是在 Visual Studio 中构建整个项目，而不需要 CI 吗？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-01-05T21:22:55.787

我同意 CC.NET 是本地/家庭开发的绝佳选择。我想补充一点，它不需要 SCM 工具即可使其工作。有一个文件系统观察[插件](http://www.cruisecontrolnet.org/projects/ccnet/wiki/FileSystem)，它将只监视文件更改。这样您就不必为了执行它而进行签入。此外，您不必等待 CI 周期完成，就像每次都运行 F6 一样，除了 IDE 不会使用它的所有资源，您可以继续编码。如果它坏了，您可以选择调查或忽略。没有一种方法可以进行 CI。

如果您确实创建了单元测试，那么在每次保存时不断地针对您的代码执行该测试肯定在早期问题中具有一些优势。使用 CCTray 可以让您看到它，但不会被打扰。我的 2 美分。

最后，第一次设置它可能有点困难，但您可以调整一个 Visual Studio C# 模板或任何您希望使用用户所需的最少信息自动配置 CI 设置的任何东西。

# .htaccess - .htaccess 重定向

> ID：494616
> 
> 赞同：2
> 
> 时间：2009-01-30T06:01:09.090
> 
> 标签：.htaccess, redirect

如何设置 .htaccess 文件以将请求重定向到另一个域上的另一个文件夹？我不希望链接中断，我只是希望他们去其他地方。假设 mysite.com/image.jpg 将重定向到 site2.com/images/image.jpg。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-30T06:42:33.017

在 .htaccess 中（至少在 Apache 中）：

```
RewriteEngine On
RewriteBase /
RewriteRule ^images/(.*)$ http://www.yahoo.com/blah/$1 [R=302,L] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-30T07:52:31.440

现在，令人惊讶的是，[官方文档](http://httpd.apache.org/docs/2.2/)中有很多[有用的示例](http://httpd.apache.org/docs/2.2/rewrite/rewrite_guide.html)，包括您要查找的内容。是的，谷歌经常宕机真的很糟糕。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-30T14:21:19.890

您可以使用[mod_rewrite](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html)重定向请求。如果要重定向所有内容：

```
RewriteEngine on
RewriteRule ^ http://other.example.com/images%{REQUEST_URI} [L] 
```

如果您只想使用以以下结尾的路径重定向请求`.jpg`：

```
RewriteEngine on
RewriteRule \.jpg$ http://other.example.com/images%{REQUEST_URI} [L] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-30T06:41:07.433

这应该有助于：

重定向 301 / [http://www.example.com/](http://www.example.com/)

# .net-3.5 - 如何在 c#.net 中隐藏 mdi 子窗体？

> ID：494623
> 
> 赞同：0
> 
> 时间：2009-01-30T06:08:17.093
> 
> 标签：.net-3.5

我想要在 MDI 中隐藏多个子窗体的代码。每当我单击子表单时，它必须在前面。其他表单将自动隐藏。我怎样才能做到这一点？请任何人回复我。

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-30T07:05:07.713

如果您观看 MdiChildActivate 事件，您将隐藏所有未激活的 MDI 子项，如下所示：

```
private void MDIMain_MdiChildActivate(Object sender, EventArgs e) {

   foreach(From f in this.MdiChildren)
   {
     if(this.ActiveMdiChild != f)
       f.Hide();
    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-30T06:32:39.243

在 Windows 中，任何时候都只能有一个处于活动状态的表单。因此，当用户单击一个表单时，如果您将其设置为活动状态，那应该会自动完成您的要求。

如果 'frmObj' 是您的子窗体，只需调用 frmObj.Activate() 方法即可。

您也可以尝试将 WindowState 属性 (frmObj.WindowState) 设置为最大化或您喜欢的任何值。

# c++ - 为静态链接构建 Boost (MinGW)

> ID：494629
> 
> 赞同：29
> 
> 时间：2009-01-30T06:12:33.933
> 
> 标签：c++, boost, build, linker, bjam

我正在使用 bjam 为 MinGW 构建 Boost（我正在使用系统和文件系统）：

```
bjam --toolset=gcc stage 
```

它构建得很好，但我希望能够静态链接到它（我必须为最终产品提供一个文件）所以我尝试了：

```
bjam --link=static --toolset=gcc stage 
```

但我得到相同的输出。有任何想法吗？

*连续编辑*第二个问题我在发布后不久就回答了：p 我想我会把这个留给其他人。

```
bjam --build-type=complete --toolset=gcc stage 
```

肯定会建立动态和静态的。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-01-30T12:48:38.550

我认为链接是一种属性，而不是 bjam 的选项。这意味着在它之前不应该有--。

这是我只构建静态库的命令行（虽然是 Visual c++）：

```
bjam install --toolset=msvc variant=release link=static threading=multi runtime-link=static 
```

将其映射到您的原始构建命令我会说它应该看起来像这样：

```
bjam --toolset=gcc link=static stage 
```

也许：

```
bjam stage --toolset=gcc link=static 
```

尝试运行

```
bjam --help 
```

有关 bjam 的属性和选项的更多信息。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2011-02-16T15:06:55.463

只是要注意，随着更新的提升（2011 年 2 月），您现在也需要构建 bjam .. 由于某种原因，当前可下载的 bjam 无法正常工作。

所以首先：

`cd ...\boost_1_45_0\tools\build\v2\engine\src`

`build.bat mingw`

您需要将 bjam 添加到 PATH（从控制面板，而不仅仅是在 cmd 提示符下）。然后

`cd ...\boost_1_45_0\`

`bjam --build-type=complete --toolset=gcc stage`

我的设置是 Vista、Boost 1.45、MinGW 4.5，并从 cmd.exe 而不是 msys 构建。

[http://code-slim-jim.blogspot.com/2011/02/boost-in-vista-using-mingw-and-cmdexe.html](http://code-slim-jim.blogspot.com/2011/02/boost-in-vista-using-mingw-and-cmdexe.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-30T06:21:27.677

我自己没有在 MinGW 中构建它，但我相信您的第一个构建将输出动态和静态库以及第二个仅输出静态库，因此如果您没有在构建之间清理构建目录，它可能看起来相同。

当您写“我必须有一个文件......”时，您的意思是您需要一个包含所有 boost 库的库吗？如果是这样，我怀疑您可能必须自己将它们“组合”在一起。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-30T12:41:32.043

我使用以下命令行来构建 boost 的静态链接和动态链接版本：

```
bjam  "-sBUILD=debug release <runtime-link>static/dynamic <threading>multi" stage 
```

这是通过 windows YMMV 上的 Visual c++ 完成的。

# sql-server - 如何控制 MS-SQL Server 返回日期时间值的格式？

> ID：494640
> 
> 赞同：1
> 
> 时间：2009-01-30T06:18:10.803
> 
> 标签：sql-server, tsql

具体来说，我希望以纯（ISO）格式获取日期格式：

YYYY-MM-DD HH:mm:ss

我正在寻找一个 SET 命令或我可以使用的东西。

我不想依赖服务器的文化设置。

注意：我对返回而不是输入日期的字符串格式感兴趣。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-30T06:34:22.737

要更改默认格式，您需要添加新语言 (sp_addlanguage)，设置它的日期格式，然后设置默认语言。可以在这篇旧的[technet 文章](http://support.microsoft.com/kb/173907)中找到更多详细信息。

如果您不想这样做，那么您可以使用“每个连接”更改它[SET DATEFORMAT](http://technet.microsoft.com/en-us/library/ms189491.aspx)。

如果您不想这样做，那么您可以使用[CONVERT](http://www.sql-server-helper.com/tips/date-formats.aspx)将其转换为每个查询中的相关格式字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-30T06:35:56.930

这是我发现的一篇方便的文章：

[http://www.sqljunkies.ddj.com/Article/6676BEAE-1967-402D-9578-9A1C7FD826E5.scuk](http://www.sqljunkies.ddj.com/Article/6676BEAE-1967-402D-9578-9A1C7FD826E5.scuk)

您正在寻找的是：

```
CONVERT(datetime,'05/08/2004',120) 
```

这将以 yyyy-mm-dd hh:mi:ss(24h) 格式（ODBC 规范，而不是 ISO）格式返回日期。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-30T06:28:34.417

日期时间的格式取决于客户端。您可以使用[convert](http://msdn.microsoft.com/en-us/library/aa226054(SQL.80).aspx)函数以您选择的格式将其显示为字符串。

# xml - 忽略 xs:unique 中的大小写？

> ID：494642
> 
> 赞同：3
> 
> 时间：2009-01-30T06:19:25.387
> 
> 标签：xml

是否可以使用`xs:unique`忽略大小写，即标记为重复的两个仅大小写不同的值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T13:43:18.057

不，不是，请查看[文档](http://msdn.microsoft.com/en-us/library/ms256146.aspx)说明的 MSDN：

> ## xsd：唯一元素
> 
> 指定属性或元素值（或属性或元素值的组合）在指定范围内必须是唯一的。该值必须是唯一的或为零。

在[另一个 Microsoft 站点（性能计数器架构）](http://msdn.microsoft.com/en-us/library/windows/desktop/aa373092%28v=vs.85%29.aspx)上，它*间接*声明以下代码部分中的值**必须区分大小写**：

```
<xs:unique name="uniqueCounterName">
   <xs:annotation>
      <xs:documentation>
         Counter Name must be unique within the Counter Set. The name is
         case-sensitive.
       </xs:documentation>
   </xs:annotation>
   <xs:selector xpath="./man:counter"/>
   <xs:field xpath="@name"/>
</xs:unique> 
```

# javascript - Javascript 强制在浏览器中打开链接

> ID：494644
> 
> 赞同：0
> 
> 时间：2009-01-30T06:20:49.283
> 
> 标签：javascript, html

有没有办法从 JavaScript 进行对象检测并强制在特定浏览器中打开链接？

例如：**在 IE 中打开，在 Firefox 中打开**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-30T06:25:42.050

不，绝对不是没有一些浏览器插件。如果可能的话，这将是一个巨大的安全风险。

# pseudocode - 这个伪代码的输出是什么？

> ID：494646
> 
> 赞同：1
> 
> 时间：2009-01-30T06:21:26.863
> 
> 标签：pseudocode

```
procedure DoSomething(a_1, ... a_n)
 p = a_1
 for i = 2 to n
  temp = p
  for j = 1 to a_i
   p = p * temp

DoSomething(10,2,2,2) 
```

我们得到了喜忧参半的结果。我们中的一个得到 10^7，另一个得到 10^27。

**我想我发现了我的错误......我每次都用 10 代替 p，而不是用新的 temp 值。**

编辑：这是我的工作：

```
{10, 2, 2, 2}
p = 10
i = 2 to 4
 temp = p = 10
 j = 1 to 2
  p = 10 * 10 = 10^2
  p = 10^2 * 10 = 10^3
i = 3 to 4
 temp = 10^3
 j = 1 to 2
  p = 10^3 * 10 = 10^4
  p = 10^4 * 10 = 10^5
i = 4 to 4
 temp = 10^5
 j = 1 to 2
  p = 10^5 * 10 = 10^6
  p = 10^6 * 10 = 10^7 
```

10^7

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-30T06:50:22.000

这是 10^27，如这段 python 代码所示：

```
a = [10,2,2,2]
p = a[0]
for i in range(1,len(a)):
    temp = p
    for j in range(a[i]):
        p *= temp
print p 
```

1,000,000,000,000,000,000,000,000,000

您发布的代码的问题是：

*   在您的 10^7 解决方案中，您总是乘以 10，而不是 temp（在 j 循环之后增加到 p 的最终值）。
*   您在 PHP 代码中将 temp 设置为 arr[i]，而不是 p（我将在此处包含它，因此在您将其从问题中编辑出来后，我的回答仍然有意义 :-)。

    ```
    $arr = array(10, 2, 2, 2);
    $p = $arr[0];
    $temp = 0;
    for($i = 1; $i <= 3; $i++)
    {
        $temp = $arr[$i];
        for($j = 0; $j <= $arr[$i]; $j++)
        {
            $p = $p * $temp;
        }
    }
    echo $p; 
    ```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-30T06:42:42.593

我将程序输入到我的 TI-89 中，得到 p 值的 1e27 答案。

```
t(a)
Func
  Local i,j,p,tmp
  a[1]->p
  For i,2,dim(a)
    p->tmp
    For j,1,a[i]
      p*tmp->p
    EndFor
  EndFor
  Return p
EndFunc

t({10,2,2,2})       1.E27 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-30T06:46:32.897

不是 ((10^3)​​^4)^5 = 10 ^ 60 吗？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-30T06:56:35.343

似乎是一个计算函数

```
 (((a_1^(a_2+1))^(a_3+1))^(a_4+1)... 
```

因此我们得到 ((10^3)​​^3)^3 = 10^(3^3) = 10^27

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-30T06:59:54.807

计算 10^7 时出现错误，请参见下文。正确答案是 10^27 {10, 2, 2, 2}

```
p = 10
i = 2 to 4
 temp = p = 10
 j = 1 to 2
  p = 10 * 10 = 10^2
  p = 10^2 * 10 = 10^3
i = 3 to 4
 temp = 10^3
 j = 1 to 2
  p = 10^3 * 10 = 10^4 -- p=p*temp, p=10^3 and temp=10^3, hence p=10^3 * 10^3.
  p = 10^4 * 10 = 10^5 -- Similarly for other steps.
i = 4 to 4
 temp = 10^5
 j = 1 to 2
  p = 10^5 * 10 = 10^6
  p = 10^6 * 10 = 10^7 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-30T06:39:14.487

人们将 Python 称为“可执行伪代码”是有原因的：

```
>>> def doSomething(*args):
...     args = list(args);
...     p = args.pop(0)
...     for i in range(len(args)):
...         temp = p
...         for j in range(args[i]):
...           p *= temp
...     return p
...
>>> print doSomething(10,2,2,2)
1000000000000000000000000000 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-30T06:53:41.370

## 在 C 中：

```
#include <stdio.h>

double DoSomething(double array[], int count)
{
  double p, temp;
  int i, j;

  p = array[0];

  for(i=1;i<count;i++)
  {
    temp = p;
    for(j=0; j<array[i];j++)
    {
      printf("p=%g, temp=%g\n", p, temp); /* useful to see what's going on */
      p = p * temp;
    }
  }
  return p; /* this isn't specified, but I assume it's the procedure output */
}

double array[4] = {10.0,2.0,2.0,2.0};

int main(void)
{
  printf("%g\n", DoSomething(array, 4));
  return 0;
} 
```

而且，正如其他人所指出的那样，10e27。请注意，上面的伪代码非常冗长 - 它可以通过多种方式进行简化。

我使用了[Tiny C 编译器](http://bellard.org/tcc/)- 非常小、轻巧且易于使用，可以处理像这样的简单内容。

-亚当

# c++ - 如何在非 MFC 项目中使用 TRACE 宏？

> ID：494653
> 
> 赞同：26
> 
> 时间：2009-01-30T06:27:38.660
> 
> 标签：c++, visual-c++, visual-studio-2005

我想在非[MFC C++ 项目中使用 TRACE() 宏在](http://en.wikipedia.org/wiki/Microsoft_Foundation_Class_Library)[Visual Studio 2005](http://en.wikipedia.org/wiki/Microsoft_Visual_Studio#Visual_Studio_2005)的调试窗口中获取输出，但需要哪些额外的头文件或库？

有没有办法将消息放在调试输出窗口中，我该怎么做？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-01-30T11:55:58.407

建立你自己的。

跟踪.cpp：

```
#ifdef _DEBUG
bool _trace(TCHAR *format, ...)
{
   TCHAR buffer[1000];

   va_list argptr;
   va_start(argptr, format);
   wvsprintf(buffer, format, argptr);
   va_end(argptr);

   OutputDebugString(buffer);

   return true;
}
#endif 
```

跟踪.h：

```
#include <windows.h>
#ifdef _DEBUG
bool _trace(TCHAR *format, ...);
#define TRACE _trace
#else
#define TRACE false && _trace
#endif 
```

然后只需#include "trace.h" 就可以了。

免责声明：我只是从个人项目中复制/粘贴了这段代码，并取出了一些项目特定的东西，但没有理由它不应该工作。;-)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-30T06:41:55.433

如果您使用 ATL，您可以尝试 ATLTRACE。

TRACE 在 afx.h 中定义为（至少在 vs 2008 中）：

```
// extern ATL::CTrace TRACE;
#define TRACE ATLTRACE 
```

ATLTRACE 可以在 atltrace.h 中找到

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-30T06:33:56.463

您可以尝试 DebugOutputString 函数。TRACE 仅在调试版本中启用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-11T13:04:59.463

据我了解，wvsprintf 的格式有问题。改用 _vsnprintf （或 thcar 版本 _vsntprintf ）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-30T16:31:48.893

感谢这些答案，我已经修复了我的错误:-)

在这里，我根据 Ferruccio 和热心极客的想法分享我的 C++ 中的 TRACE 宏。

```
#ifdef ENABLE_TRACE
#  ifdef _MSC_VER
#    include <windows.h>
#    include <sstream>
#    define TRACE(x)                           \
     do {  std::stringstream s;  s << (x);     \
           OutputDebugString(s.str().c_str()); \
        } while(0)
#  else
#    include <iostream>
#    define TRACE(x)  std::clog << (x)
#  endif        // or std::cerr << (x) << std::flush
#else
#  define TRACE(x)
#endif 
```

例子：

```
#define ENABLE_TRACE  //can depend on _DEBUG or NDEBUG macros
#include "my_above_trace_header.h"

int main (void)
{
   int     v1 = 123;
   double  v2 = 456.789;
   TRACE ("main() v1="<< v1 <<" v2="<< v2 <<'\n');
} 
```

欢迎任何改进/建议/贡献;-)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-10-05T15:45:32.047

我在网上看到了以下内容： `#define TRACE printf`

稍微开发一下，得出以下结论：

```
#ifdef _DEBUG
#define TRACE printf
#else
#define TRACE 
#endif 
```

# java-me - 为什么使用此代码创建图像时会出现 IllegalArgumentException？

> ID：494658
> 
> 赞同：0
> 
> 时间：2009-01-30T06:29:05.727
> 
> 标签：java-me

我为我的 j2me 项目编写了这段代码：

```
try {
    Image immutableThumb = Image.createImage(temp, 0, temp.length);
} catch (Exception ex) {
    System.out.println(ex);
} 
```

`temp`字节数组在哪里。

当我为 localhost 尝试它时，它可以工作，并且图像被创建。但是当我在 LAN 上尝试它时，它会抛出一个`IllegalArgumentException`，并且没有创建图像。

我怎么解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-30T06:36:07.210

[文档](http://java.sun.com/javame/reference/apis/jsr118/javax/microedition/lcdui/Image.html)说_

> IllegalArgumentException - 如果 imageData 格式不正确或无法解码

所以我会说你得到一个不同的字节数组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-11T17:07:40.533

是在设备上还是在模拟器中出现问题？可能是 url 字符串，也可能是连接问题。

你能发布你所有的源代码吗？

这是一个简单的例子：[如何从网络服务器下载图像。](http://www.java-tips.org/java-me-tips/midp/how-to-download-an-image-from-a-web-server-3.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-03T09:32:01.097

如果您从网络位置获取字节数组，请确保它来自受支持的图像类型。我的意思是，并非所有图像格式都可以在 MIDP 上使用。可以肯定的是，您可以使用 PNG。

# iphone - UIWebView：如何使用 PDF 控制页面显示？

> ID：494677
> 
> 赞同：2
> 
> 时间：2009-01-30T06:39:22.397
> 
> 标签：iphone, uiwebview

我使用 UIWebView 在 iPhone 应用程序中加载了一个 PDF，它在手动滚动页面时显示页码。但是我没有运气弄清楚如何访问这些数字并设置显示的页面。任何建议都会受到欢迎。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-08-30T13:22:41.153

您可以使用 Quartz 来执行此操作，如下所述：http: [//developer.apple.com/iphone/library/documentation/GraphicsImaging/Conceptual/drawingwithquartz2d/dq_pdf/dq_pdf.html](http://developer.apple.com/iphone/library/documentation/GraphicsImaging/Conceptual/drawingwithquartz2d/dq_pdf/dq_pdf.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-05-21T08:51:16.570

您可以使用 Iphone SDK 中的 Quartz Core Api 来执行此操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-02T02:49:11.710

使用 SDK 提供的方法无法做到这一点。如果您确实需要此功能，您可以[提交错误报告](https://bugreport.apple.com/)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-03-27T19:49:00.363

由于您使用的是 uiwebview，因此即使使用 pdf，它也可以解释用于导航的 javascript。确定每个页面的像素大小，理论上您可以计算您在任何给定页面上的位置并相应地导航。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-12-21T06:50:58.863

获取滚动视图内容的长度，然后除以页码。

这会给你每页的长度。有一种方法可以从`uiwebview`.

# mysql - 使用 MySQL 触发器在插入时创建数据库

> ID：494678
> 
> 赞同：0
> 
> 时间：2009-01-30T06:39:45.097
> 
> 标签：mysql, triggers

当一个值插入另一个数据库时，我可以在 MySQL 中使用触发器来创建一个新数据库吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-30T06:47:22.770

为什么要这样做肯定存在设计问题。（在触发器中创建数据库）。事实证明这是不允许的。[这](http://dev.mysql.com/doc/refman/5.1/en/stored-program-restrictions.html)是允许将所有内容放置在触发器中的列表。

# apache-flex - Flex 中继器和事件监听器

> ID：494693
> 
> 赞同：2
> 
> 时间：2009-01-30T06:43:47.943
> 
> 标签：apache-flex, actionscript-3

乍一看，Repeater 控件看起来非常强大，但现在我又重新考虑了。

手头的问题：向孩子添加事件监听器

Repeater 对象绑定到并迭代 ArrayCollection，为每个项目创建新的 Vbox 子项。现在对于每个孩子，Repeater 对象将触发一个“重复”事件，我很想在其中添加事件监听器（用于鼠标事件）。到目前为止没有问题，但是，当 ArrayCollection 发生变化时会发生什么，我应该如何删除所有老孩子的 EventListeners？是否有包含我在文档中跳过的 Vbox 实例的子数组？当事件监听器附加到的对象被销毁时，它们是否被很好地清理了？

-C 编码器在 flex/actionscript 中丢失

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-30T07:01:00.497

我会完全避免使用中继器。从性能的角度来看，它们非常慢，因为这些项目经常被销毁和重新创建。您最好使用基于列表的控件并实现 itemRenderer。

默认情况下，事件侦听器是强引用，因此如果您不删除事件侦听器，它将阻止对象被垃圾收集。您可以在 addEventListener 中使用可选的第 5 个参数，称为“weakReference”，并将值设置为 true 以添加不会阻止 GC 的事件侦听器。

为了更好地处理 itemRender 组件中的事件，您可以实现 IDropInListItemRenderer 接口。这将使您可以访问具有“所有者”属性的“listData”，该属性是实际的 List 对象本身。在您的 itemRenderer 中，通过所有者调度包含必要数据的自定义事件。如果在创建 List 控件后向它添加事件侦听器，则可以在包含该控件的组件中进行事件处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-30T10:14:36.737

好的，似乎我需要给 vbox 一个 id，之后我能够以 vbox 数组的形式访问该 id。添加事件处理程序后，我能够使用事件的 currentTarget.getRepeaterItem() 作为对 ArrayCollection 中对象的引用。

通过循环遍历 vbox 数组并删除处理程序来清理事件处理程序。

不太担心性能，因为项目很少，而且它们很少随着程序运行而改变，尽管这些项目几乎每次运行都会有所不同。除非它不必要地破坏和重建物品，否则它应该不是什么大问题。

# asp.net-mvc - 将 Visual Studio 项目转换为 ASP.NET MVC

> ID：494697
> 
> 赞同：6
> 
> 时间：2009-01-30T06:45:31.277
> 
> 标签：asp.net-mvc, visual-studio, project

我有一个 Visual Studio 项目，它是一个 ASP.NET MVC 项目，但是它在 Visual Studio 中无法识别它，所以我没有通过 Add View 等获得漂亮的下拉菜单。相反，我只是得到一个非常简单的添加文件对话框，其中不包含任何 MVC 文件模板。然而，当我创建一个新的 MVC 项目时，我得到了所有不错的 VS 小工具。那么，有人可以告诉我如何指示 VS 将项目识别为 MVC 项目吗？

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2011-06-08T14:34:01.153

对于 ASP.Net MVC 3，您必须将项目文件中的 ProjectTypeGuids 属性更改为：

```
<ProjectTypeGuids>{E53F8FEA-EAE0-44A6-8774-FFD645390401};{349c5851-65df-11da-9384-00065b846f21};{fae04ec0-301f-11d3-bf4b-00c04f79efbc}</ProjectTypeGuids> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-30T06:52:12.887

好吧，要回答我自己的问题，您必须更改项目文件中的 projecttypeguids。对于 ASP.NET MVC RC1，它们是：

{603c0e0b-db56-11dc-be95-000d561079b0};{349c5851-65df-11da-9384-00065b846f21};{fae04ec0-301f-11d3-bf4b-00c04f79efbc}

当然，这些可能会因您所针对的版本而异。

# wcf - WS 寻址和多个“回复”

> ID：494700
> 
> 赞同：3
> 
> 时间：2009-01-30T06:46:26.313
> 
> 标签：wcf, ws-addressing

请任何人澄清我WCF中的WS寻址是否支持多个ReplyTo？。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-30T06:53:19.343

这将深入回答您的问题[@Microsoft](http://msdn.microsoft.com/en-us/magazine/cc163412.aspx)

...

**多个端点和唯一地址**

您可能希望在特定服务上公开多个端点的原因有几个。一个原因是使用几个不同的绑定来公开相同的合约。例如，您可能有一些消费者只能处理符合 WS-I Basic Profile 1.1 的服务（一个绑定），而其他消费者可以处理全套标准（另一个绑定）。或者您可能有一些内部企业消费者出于性能原因需要二进制 TCP 传输（另一个绑定）。使用不同绑定公开相同合约的能力允许您同时容纳所有这些消费者。当暴露具有不同绑定的多个端点时，每个端点地址必须是唯一的。这是因为每个端点都需要不同的传输侦听器和通道堆栈。考虑图 4 中的服务配置。在此示例中，所有端点都公开相同的合约 (ISimpleMath)，但每个端点都使用不同的绑定，因此每个地址必须是唯一的。如果您修改终结点以使用与其他终结点之一相同的地址，Windows Communication Foundation 将在打开 ServiceHost 时引发异常。

...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-12-08T18:20:33.927

我假设 WCF 符合标准。在这种情况下，最多可以给出一个回复地址。有关详细信息，请参阅[WS-Addressing 核心规范](http://www.w3.org/TR/ws-addr-core/#abstractmaps)的[第 3.1 节](http://www.w3.org/TR/ws-addr-core/#abstractmaps)。

# perl - 你如何计算浮点数的 div 和 mod？

> ID：494711
> 
> 赞同：12
> 
> 时间：2009-01-30T06:52:21.247
> 
> 标签：perl, math, floating-point, division, modulo

在 Perl 中，`%`运算符似乎假定为整数。例如：

```
sub foo {
    my $n1 = shift;
    my $n2 = shift;
    print "perl's mod=" . $n1 % $n2, "\n";
    my $res = $n1 / $n2;
    my $t = int($res);
    print "my div=$t", "\n";
    $res = $res - $t;
    $res = $res * $n2;
    print "my mod=" . $res . "\n\n";
}   

foo( 3044.952963, 7.1 );
foo( 3044.952963, -7.1 );
foo( -3044.952963, 7.1 );
foo( -3044.952963, -7.1 ); 
```

给

```
perl's mod=6
my div=428
my mod=6.15296300000033

perl's mod=-1
my div=-428
my mod=6.15296300000033

perl's mod=1
my div=-428
my mod=-6.15296300000033

perl's mod=-6
my div=428
my mod=-6.15296300000033 
```

现在你可以看到，我已经想出了一个“解决方案”来计算`div`和`mod`。但是，我不明白每个参数的符号应该对结果产生什么影响。不总是积极的，是适合`div`的次数吗？在这种情况下，算法应该如何工作？`n2``n1`

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-01T09:47:33.657

标题提出一个问题，正文提出另一个问题。要回答标题问题，就像在 C 中一样，% 运算符是一个整数模数，但是有一个库例程“fmod”它是一个浮点模数。

```
use POSIX "fmod";

sub foo {
    my $n1 = shift;
    my $n2 = shift;
    print "perl's fmod=" . fmod($n1,$n2), "\n";
    my $res = $n1 / $n2;
    my $t = int($res);
    print "my div=$t", "\n";
    $res = $res - $t;
    $res = $res * $n2;
    print "my mod=" . $res . "\n\n";
}

foo( 3044.952963, 7.1 );
foo( 3044.952963, -7.1 );
foo( -3044.952963, 7.1 );
foo( -3044.952963, -7.1 ); 
```

给

```
perl's fmod=6.15296300000033
my div=428
my mod=6.15296300000033

perl's fmod=6.15296300000033
my div=-428
my mod=6.15296300000033

perl's fmod=-6.15296300000033
my div=-428
my mod=-6.15296300000033

perl's fmod=-6.15296300000033
my div=428
my mod=-6.15296300000033 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-30T07:02:21.197

给定`a = qd + r`，在计算 的负值的余数时存在歧义`d`。

例如：

表达式`−42 ÷ −5`, 可以表示为： `−42 = 9×(−5) + 3`或`−42 = 8×(−5) + (−2)`。

所以余数是 3 或 -2。

欲了解更多信息：[维基百科：余数“余数满足的不等式”](http://en.wikipedia.org/wiki/Remainder#The_inequality_satisfied_by_the_remainder)

此外，在 mod / div 中为负数时的输出取决于软件语言的实现。见[维基百科：模运算](http://en.wikipedia.org/wiki/Modulo_operation)（见右表）

# asp.net - ASP.NET：每条记录中的可编辑数据绑定控件？

> ID：494718
> 
> 赞同：0
> 
> 时间：2009-01-30T06:55:03.270
> 
> 标签：asp.net, listview, databound

我们需要在 ASP.NET 3.5 网页上显示 SQL SELECT 语句的结果。虽然有许多列需要显示，但只有其中一列需要一个可编辑的文本框......但是结果集中的每条记录都需要这个可编辑的文本框。

我知道我可以通过自己构建一个 html 表来手动执行此操作，但我希望有一种方法可以使用数据绑定控件（GridView？或 ListView？）来做到这一点。

作为 ASP.NET 的新手，我希望有人已经做到了这一点。

- 谢谢你的帮助！

进一步澄清......

我们需要所有记录在显示后立即可编辑 - 所以所有记录要么需要同时在编辑模式下显示 - 要么常规显示模式需要有一个可编辑的文本框。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-30T07:01:35.643

GridView BoundFields 具有`ReadOnly`可用于防止字段在编辑模式下被编辑的属性。对于所有不应编辑的列，将其设置为 True。

```
<asp:boundfield datafield="myNonEditableColumn" Readonly="true" Headertext="My Non-Editable Column"/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-30T08:31:29.427

使用 GridView 并将您希望可编辑的列转换为模板。在该字段的 ItemTemplate 中，删除 Label 并添加一个文本框。

在 GridView 外部添加一个额外的“保存”按钮，并迭代 GridRows，找到文本框（在每一行中），并使用它来更新数据库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-30T09:11:14.807

添加模板列，然后添加文本框控件而不是标签控件

# sql - 左连接子查询的前 1

> ID：494720
> 
> 赞同：8
> 
> 时间：2009-01-30T06:56:41.443
> 
> 标签：sql, sql-server

我正在尝试带一个人并展示他们当前的保险以及他们以前的保险。我想有人可能会说我试图平息我对客户或人的看法。我遇到了一个问题，由于我的左连接子查询中存在多条记录，我得到了多条记录。我曾希望我可以通过在子查询中添加“TOP 1”来解决这个问题，但实际上什么也没返回......

有任何想法吗？

```
 SELECT 
    p.person_id AS 'MIRID'
    , p.firstname AS 'FIRST'
    , p.lastname AS 'LAST'
    , pg.name AS 'GROUP'
    , e.name AS 'AOR'
    , p.leaddate AS 'CONTACT DATE'
    , [dbo].[GetPICampaignDisp](p.person_id, '2009') AS 'PI - 2009'
    , [dbo].[GetPICampaignDisp](p.person_id, '2008') AS 'PI - 2008'
    , [dbo].[GetPICampaignDisp](p.person_id, '2007') AS 'PI - 2007'
    , a_disp.name AS 'CURR DISP'
    , a_ins.name AS 'CURR INS'
    , a_prodtype.name AS 'CURR INS TYPE'
    , a_t.date AS 'CURR INS APP DATE'
    , a_t.effdate AS 'CURR INS EFF DATE' 
    , b_disp.name AS 'PREV DISP'
    , b_ins.name AS 'PREV INS'
    , b_prodtype.name AS 'PREV INS TYPE'
    , b_t.date AS 'PREV INS APP DATE'
    , b_t.effdate AS 'PREV INS EFF DATE'
    , b_t.termdate AS 'PREV INS TERM DATE'
FROM 
    [person] p
LEFT OUTER JOIN 
    [employee] e
ON 
    e.employee_id = p.agentofrecord_id
INNER JOIN 
    [dbo].[person_physician] pp
ON 
    p.person_id = pp.person_id
INNER JOIN 
    [dbo].[physician] ph
ON
    ph.physician_id = pp.physician_id
INNER JOIN
    [dbo].[clinic] c
ON 
    c.clinic_id = ph.clinic_id
INNER JOIN
    [dbo].[d_Physgroup] pg
ON
    pg.d_physgroup_id = c.physgroup_id
LEFT OUTER JOIN 
    (
        SELECT
            tr1.*
        FROM 
            [transaction] tr1
        LEFT OUTER JOIN 
            [d_vendor] ins1
        ON 
            ins1.d_vendor_id = tr1.d_vendor_id
        LEFT OUTER JOIN 
            [d_product_type] prodtype1
        ON 
            prodtype1.d_product_type_id = tr1.d_product_type_id
        LEFT OUTER JOIN 
            [d_commission_type] ctype1
        ON 
            ctype1.d_commission_type_id = tr1.d_commission_type_id
        WHERE
            prodtype1.name <> 'Medicare Part D'
            AND tr1.termdate IS NULL
    ) AS a_t
ON
    a_t.person_id = p.person_id
LEFT OUTER JOIN 
    [d_vendor] a_ins
ON 
    a_ins.d_vendor_id = a_t.d_vendor_id
LEFT OUTER JOIN 
    [d_product_type] a_prodtype
ON 
    a_prodtype.d_product_type_id = a_t.d_product_type_id
LEFT OUTER JOIN 
    [d_commission_type] a_ctype
ON 
    a_ctype.d_commission_type_id = a_t.d_commission_type_id
LEFT OUTER JOIN
    [d_disposition] a_disp
ON
    a_disp.d_disposition_id = a_t.d_disposition_id
LEFT OUTER JOIN 
    (
        SELECT
            tr2.*
        FROM 
            [transaction] tr2
        LEFT OUTER JOIN 
            [d_vendor] ins2
        ON 
            ins2.d_vendor_id = tr2.d_vendor_id
        LEFT OUTER JOIN 
            [d_product_type] prodtype2
        ON 
            prodtype2.d_product_type_id = tr2.d_product_type_id
        LEFT OUTER JOIN 
            [d_commission_type] ctype2
        ON 
            ctype2.d_commission_type_id = tr2.d_commission_type_id
        WHERE
            prodtype2.name <> 'Medicare Part D'
            AND tr2.termdate IS NOT NULL
    ) AS b_t
ON
    b_t.person_id = p.person_id
LEFT OUTER JOIN 
    [d_vendor] b_ins
ON 
    b_ins.d_vendor_id = b_t.d_vendor_id
LEFT OUTER JOIN 
    [d_product_type] b_prodtype
ON 
    b_prodtype.d_product_type_id = b_t.d_product_type_id
LEFT OUTER JOIN 
    [d_commission_type] b_ctype
ON 
    b_ctype.d_commission_type_id = b_t.d_commission_type_id
LEFT OUTER JOIN
    [d_disposition] b_disp
ON
    b_disp.d_disposition_id = b_t.d_disposition_id
WHERE
    pg.d_physgroup_id = @PhysGroupID 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2010-11-17T10:02:11.663

在 Sql server 2005 中，您可以使用 OUTER APPLY

```
SELECT p.person_id, s.e.employee_id
FROM person p
OUTER APPLY (SELECT TOP 1 *
             FROM Employee
         WHERE /*JOINCONDITION*/
         ORDER BY /*Something*/ DESC) s 
```

[http://technet.microsoft.com/en-us/library/ms175156.aspx](http://technet.microsoft.com/en-us/library/ms175156.aspx)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-30T07:30:46.333

我通常使用的模式是：

> 从人员
> LEFT JOIN 子表中选择任何内容AS s1
> ON s1.personid = person.personid
> 
> ...
> 
> WHERE NOT EXISTS
> (SELECT 1 FROM subtable
> WHERE personid = person.personid
> AND orderbydate > s1.orderbydate)

这避免了 TOP 1 子句，并且可能使它更清晰一些。

顺便说一句，我喜欢你把这个查询放在一起的方式，除了我会省略括号，假设你有合理命名的表和列；您甚至可以通过列出 tr1 和 tr2 的列而不是“tr1.*”和“tr2.*”来获得一些性能（但至少是优雅）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-30T07:55:33.383

感谢所有的反馈和想法...

用最简单的术语来说，我有一个存储联系信息（如姓名、电子邮件等）的人员表。我还有另一个存储交易的表。每笔交易实际上都是一份保险单，其中包含有关提供商、产品类型、产品名称等的信息。

我想避免为用户提供重复的人员记录，因为这会导致他们在运行邮件合并等之前查找重复项。当有超过 1 个未终止的事务以及更多事务时，我会得到重复项超过 1 个已终止的交易。

其他人建议我考虑使用光标来获取我的不同联系人记录，然后执行子选择以获取当前和以前的保险信息。我不知道我是否想沿着这条路走下去。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-30T07:22:12.547

很难理解你的问题，所以首先我会把它扔在那里：将你的 SELECT 更改为 SELECT DISTINCT 做你想要的吗？

否则，让我直截了当地说，您正在尝试获取客户的当前保险和以前的保险，但他们实际上可能在此之前有很多保险，记录在 [transactions] 表中？我看了你的 SQL 好几分钟，但无法弄清楚这一切意味着什么，所以你能把它减少到只有必要的部分吗？那我再考虑一下。在我看来，您似乎需要一个 GROUP BY，但我还不能完全解决。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-30T07:26:31.117

不能花时间去挖掘你所有的 SQL（真是个野兽！），这里有一个可以让事情更容易处理的想法：

```
select 
 p.person_id, p.name <and other person columns>,
 (select <current policy columns>
  from pol <and other tables for policy>
  where pol.<columns for join> = p.person_id
  and <restrictions for current policy>),
 (select <previous policy columns>
  from pol <and other tables for policy>
  where pol.<columns for join> = p.person_id
  and <restrictions for previouspolicy>),
 <other columns>
from person p <and "directly related" tables> 
```

通过将不同的部分分成它们自己的子选择，这使得语句更易于阅读，并且还可以更容易地添加“Top 1”而不影响语句的其余部分。希望有帮助。

# resources - 编写国际象棋引擎有哪些好的资源？

> ID：494721
> 
> 赞同：85
> 
> 时间：2009-01-30T06:56:46.590
> 
> 标签：resources, chess

我有兴趣编写一个国际象棋引擎（主要作为学习练习），并且会对人们知道的任何可能感兴趣或使用的资源感兴趣，任何真正的东西：论文，书籍，理论，教程，任何可能的东西有用。

* * *

## 回答 #1

> 赞同：134
> 
> 时间：2009-02-02T02:19:22.890

从我的档案：

*   这是一个有用的[国际象棋编程维基](https://www.chessprogramming.org/Main_Page)。
*   这是国际象棋编程的[简单介绍。](http://www.gamedev.net/page/resources/_/technical/artificial-intelligence/chess-programming-part-i-getting-started-r1014)
*   这是一本关于国际象棋算法的（免费）[书籍](https://sites.google.com/view/noah-caplinger-math/chess)。
*   这包含几个简单的循序渐进的[YouTube 教程系列](https://www.youtube.com/user/jonathanwarkentin)，从初级到高级。
*   这是一个[更高级的介绍](http://www.frayn.net/beowulf/theory.html)。
*   这是[Adam Berent 有趣的计算机国际象棋博客](http://www.chessbin.com/)。
*   这是[对 MTD(f) 的一个很好的分析](http://people.csail.mit.edu/plaat/mtdf.html)，一个有趣的搜索算法。
*   这是[验证移动生成](http://mediocrechess.blogspot.com/2007/01/guide-perft-scores.html)的一个很好的指南。
*   这是[关于 Rebel](http://www.top-5000.nl/authors/rebel/chess840.htm)国际象棋引擎的大量有用信息。
*   这是[关于黑暗思想](http://people.csail.mit.edu/heinz/dt/)国际象棋引擎的很多好信息。
*   [季风国际象棋引擎](http://wannabe.guru.org/scott/hobbies/chess/)的良好信息和源代码。
*   这些是[关于国际象棋编程的更多注释](http://www.maths.nott.ac.uk/personal/anw/G13GT1/compch.html)。
*   对旋转位板的合理[介绍](http://www.cis.uab.edu/hyatt/bitmaps.html)。
*   [魔术位板](https://www.chessprogramming.org/Magic_Bitboards)的合理介绍。
*   合理[介绍后期移动减少](http://www.glaurungchess.com/lmr.html)。
*   看看[null-move pruning](https://www.chessprogramming.org/Null_Move_Pruning)。
*   用于测试目的的一[组位置集。](http://www.top-5000.nl/testsets.htm)
*   这是[2 名编写国际象棋程序的学生](http://www.csbruce.com/~csbruce/chess/)的旧报告。
*   一堆[杂七杂八的国际象棋编程链接](http://www.lkessler.com/cclinks.shtml)。
*   最后，这是[维基百科对计算机国际象棋的看法](http://en.wikipedia.org/wiki/Computer_chess)。

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2009-04-14T19:42:22.673

在创建我的国际象棋引擎时，我花了几个月的时间试图收集好的资源，这些资源描述了创建国际象棋游戏的一些困难方面。以下是我认为最有用的列表：

**François Dominic Laramée 的国际象棋编程**

这是让我进入计算机国际象棋的文章，它很好地概述了计算机如何下棋。它非常易于阅读，它将向您介绍所有术语和关键字。

[http://www.gamedev.net/page/resources/_/technical/artificial-intelligence/chess-programming-part-i-getting-started-r1014](http://www.gamedev.net/page/resources/_/technical/artificial-intelligence/chess-programming-part-i-getting-started-r1014)

**计算机国际象棋维基**，这在过去几个月里确实得到了扩展。它是参考资料的极好资源。

[https://www.chessprogramming.org/Main_Page](http://chessprogramming.wikispaces.com/)

**路易斯凯斯勒的电脑国际象棋链接**

浏览完上述资源后，可以在以下链接页面中找到其余资源。

[http://www.lkessler.com/cclinks.shtml](http://www.lkessler.com/cclinks.shtml)

最后但并非最不重要的一点是，我写了一个**计算机国际象棋博客**，它将带您完成从头开始用 C# 编写国际象棋引擎的所有步骤，它包括一个计算机国际象棋链接部分和一个国际象棋游戏入门工具包。

[http://www.chessbin.com](http://www.chessbin.com)

亚当·贝伦特

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-30T07:16:29.123

这基本上是在[人工智能（AI）领域。](http://en.wikipedia.org/wiki/Artificial_intelligence)

让计算机在国际象棋游戏中“思考”的最常见方法是使用[最小最大方法](http://en.wikipedia.org/wiki/Minimax)，在这种方法中，计算机通过分析从当前状态提前做出不同动作的结果来“思考”。

不同动作结果的“好坏”可以通过许多标准来确定，例如得分、剩余敌人数量、获胜状态等。例如，如果您将玩家向右移动并且您赢得了游戏，那么这是一个非常好的状态。但是如果你把它移到左边，你什么也得不到。向右移动是合理的。这个定义“善良”的函数通常称为*启发式函数。*

这个过程在很多回合中递归地完成。转数越多，您需要的时间就越多。转数越多，你的软件就越智能。只考虑一个回合可能只会导致贪婪的选择。智能象棋软件具有很强的启发式功能，多轮思维超前。

附言。mini-max 算法的一些细节我没有在这里解释，但这应该涵盖了基本思想。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-05-08T19:18:59.973

我加入了 Paul Wicks 的同一个联盟（上图），我也想为自己的学习编写一个国际象棋引擎，唯一的限制是我的日常工作（即从事无聊的 Web 服务和其他东西..）但它的价值疼痛。

我决定使用逐层的方法来构建它。我几乎完成了多人游戏部分，即（人类对人类）。

完成此操作后，我很想将 AI 层合并到支持（计算机 vs 人类）播放方案。这是我最担心的部分，我在此线程中找到了非常好的帮助提示，非常感谢你们所有人。

目前我精通的语言是Java，如果性能受到影响，我可能会将它移植到C++。

# java - 在 java web 应用程序中在哪里存储数据库字符串连接？

> ID：494724
> 
> 赞同：5
> 
> 时间：2009-01-30T06:57:43.967
> 
> 标签：java, database, connection-string, database-connection, connection-pooling

我即将开始我的第一个 java 项目

说说我以前是怎么处理这些事情的...

到目前为止，我一直在使用 VB6 制作的 com+ 组件来开发 asp。

该组件是通过 com+ 管理控制台向域用户注册的，例如 my_company_domain\my_app_account

组件从 udl 文件中读取配置，配置为访问具有集成安全性的数据库。

我使用 server.createobject 从 asp 调用组件，组件使用指定的域帐户运行，因此每个数据库访问都使用此帐户运行...

我喜欢这种方法的原因如下：

*   使用集成安全 - 没有 sql 用户

*   无需重新编译任何东西来更改 db（编辑 udl 文件）或域帐户（编辑 com+ 组件配置）

*   池连接（因为我总是使用相同的连接字符串）

*   生产人员无需在文本文件中留下帐户密码即可更改配置

...

好吧，在java上实现这样的事情的最好方法是什么？？？

我已经看到了一些关于 Commons-DBCP 的东西，是否可以使用集成安全性？

多谢...

--

为回应评论而添加

通过集成安全性，我的意思是我只需要配置一个域帐户，仅此而已，我不使用 sql server 帐户，只使用运行 VB6 com+ 组件的帐户。

好吧，也许这不是合适的术语，但我希望你明白......

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-30T07:11:39.463

1.  在应用服务器端配置 DataSource 和 ConnectionPool。
2.  从您的 Web 应用程序的 JNDI 环境中获取 DataSource。

# operating-system - 一个目录应该放多少个子目录

> ID：494730
> 
> 赞同：-1
> 
> 时间：2009-01-30T07:00:42.603
> 
> 标签：operating-system, filesystems

在 SO 有很多关于目录中多少文件是合适的讨论：在较旧的文件系统上保持在几千以下，而在较新的文件系统上保持在几十万以下。通常建议是为每几千个文件创建子目录。

所以下一个问题是：我应该放入一个目录的最大子目录数量是多少？将它们嵌套得太深会破坏 dir 树遍历性能。有没有将它们嵌套到浅层？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-30T07:13:21.423

确实取决于您使用的操作系统，因为目录操作是使用系统调用完成的。对于基于 unix 的操作系统，i-node 查找算法非常高效，目录中的文件和文件夹数量无关紧要。可能这就是为什么在基于 Unix 的系统中没有限制的原因。但是，在 Windows 中，[它因文件系统而异](http://ask-leo.com/is_there_a_limit_to_what_a_single_folder_or_directory_can_hold.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-31T03:08:07.097

从实用性的角度来看，应用程序可能无法很好地处理大型目录条目。例如，Windows 资源管理器被数千个目录条目所困扰（我遇到过 Vista 崩溃，但 XP 似乎处理得更好）。

由于您提到嵌套目录，还请记住，完全限定（带有驱动器指示符和路径）文件名的长度是有限制的[（参见维基百科的“文件名”条目）](http://en.wikipedia.org/wiki/Filename)。这会因操作系统文件系统而异[（参见 Wikipedia 'comparison on file systems' entry）](http://en.wikipedia.org/wiki/Comparison_of_file_systems)。

对于 Windows NTFS，它应该是 255，但是，我遇到了命令和 API 函数的问题，完全限定的文件名大约为 120 个字符。我也遇到了映射网络驱动器上长路径名的问题（至少在 Vista 和 IE Explorer 7 中）。

子目录的嵌套级别也有限制。例如，CD-ROM (ISO 9660) 限制为 8 个目录级别（如果您想将目录结构复制到 CD-ROM 或其他文件系统，请记住这一点）。

所以当你把文件系统推到极端时会有很多不一致的地方（虽然文件系统理论上可能能够处理它，但应用程序和库可能不能）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-30T07:17:56.533

通常现代文件系统（如 NTFS 或 ext3）直接访问文件没有问题（即，如果您试图打开 /foo/bar/baz.dat）。您可能会遇到问题的地方是枚举给定目录中的子目录/文件（即，给我 /foo 中的所有文件/目录）。这可能发生在多种情况下（例如，在调试期间或在备份期间等）。我发现将孩子人数保持在最多几百个给我可以接受的响应时间。

当然，这因情况而异，因此请进行测试:-)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-30T07:40:12.617

我的猜测是尽可能少。

在我工作的 ISP（早在 2003 年），我们有很多用户电子邮件和网络文件。我们使用 md5 散列用户名构建它们，深度为 3 级（即 /home/a/b/c/abcuser）。这导致在第三级目录中可能有多达 100 个用户。

您也可以在浅层结构中使用用户目录进行更深的结构。最好的选择是尝试查看，但目录数越小查找速度越快。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-30T08:54:24.620

我最近也遇到过类似的情况。我们使用文件系统来存储序列化的交易细节。这些只会很少被查看，将它们存储在数据库中是不值得的。

我们发现 Windows 和 Linux 可以处理大约一千个文件，但访问它们的速度确实要慢得多——我们将它们组织在逻辑分组中的子目录中，这解决了问题。

grep 它们也更容易。搜索数千个文件比更改到正确的子目录并搜索几百个文件要慢。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-11T07:22:59.200

在 windows API 中，[最大长度](http://msdn.microsoft.com/en-us/library/aa365247%28VS.85%29.aspx#maxpath)设置为 260 个字符。unicode 函数确实将此限制扩展到 32767 个字符，主要文件系统使用该字符。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-30T23:45:19.830

我发现 UFS2 的限制大约是 2^15 个子目录。因此，虽然 UFS2 和其他现代文件系统在一个目录中处理几十万个文件时可以很好地工作，但它只能处理相对较少的子目录。不明显的错误消息是“无法创建链接”。

虽然我还没有测试过 ext2，但我发现了各种邮件列表的帖子，其中的张贴者在 ext2 文件系统上也有超过 2^15 个文件的问题。

# .net - 我可以在 Express 中打开一个 VS2008 专业项目吗

> ID：494738
> 
> 赞同：2
> 
> 时间：2009-01-30T07:03:05.627
> 
> 标签：.net, visual-studio-2008

我计划在家中对工作项目进行一些额外的编码，而不是试图证明他们给我一份 VS2008 pro 的副本，我是否能够从 C# Express 打开 VS2008 Professional 创建的 C# 项目？

我所做的任何更改，我都会简单地将更改后的 .cs 文件加载到 VSS，因此我不需要将项目保存回有效的 VS2008 格式。

我知道某些功能在 Express 中对我不可用，但主要是我将要做的 POCO 和 ADO 数据库工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-30T07:08:04.337

是的你可以。但是，如果您有混合解决方案，您可能必须安装所有版本的 VS Express 并一点一点地编译项目。

例如：带有 C# 和 C++ 的 VS 解决方案 - 项目。VS Express 将编译 C# 或 C++ 项目。因此，您必须先编译其他项目将依赖的项目，然后再进行切换。

有点尴尬，但仅此而已。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-30T07:09:13.663

简短的回答：“*是的，我们可以*”。

.csproj 文件只是带有 C# 特殊目标的 msbuild 文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-30T07:18:08.607

我认为这取决于项目的类型。我相信智能设备项目或带有 Crystal Reports 的项目可能会给您打开麻烦，因为它们不受快速版本的支持。但如果它的简单项目你不应该有问题

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-30T07:24:22.073

虽然您可以打开项目，但我相信有些文件类型和项目类型是您无法打开的。例如，Express 版本中不提供类图。这可能不适用于您，但如果您正在使用特定的项目类型（如 BizTalk 项目），则这些在 Express 中不可用。

# asp.net-mvc - 使用 ASP.NET 的 SqlMembershipProvider 进行分片？

> ID：494752
> 
> 赞同：2
> 
> 时间：2009-01-30T07:08:20.640
> 
> 标签：asp.net-mvc, asp.net-membership, sqlmembershipprovider, sharding

我正在考虑在 ASP.NET MVC 中编写一个博客托管应用程序。我是 .NET 的新手，但我在 LAMP 世界中相当称职。我的问题涉及用户数据的水平缩放。

每个拥有博客的用户在数据库中都会有 6 个表。我想规划水平扩展，以便 20% 的用户可以在一个数据库服务器上，20% 在另一个数据库服务器上，等等。在 LAMP 世界中，我有一个“字典”表，我首先要查询找出用户在哪个数据库服务器上。然后该应用程序将只与该特定数据库服务器通信。

我看不到如何轻松地对 SqlMembershipProvider 使用的数据库进行分片。有小费吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-30T07:50:12.410

您可以将 asp.net 成员设置为在与站点其余部分不同的数据库上运行。这将允许您将所有用户信息和可能的其他相关信息存储在一个数据库中，同时您可以将其余信息分隔到您需要的任意数量的数据库中。

这不会拆分成员数据库，但它允许您将站点的其余部分拆分为多个数据库。无论如何，会员数据库不太可能是您的用户受到最严重打击的数据库。

# c++ - 什么时候应该从类方法返回对对象的引用

> ID：494756
> 
> 赞同：11
> 
> 时间：2009-01-30T07:09:40.933
> 
> 标签：c++, reference

从类方法返回引用的最佳实践是什么。是不是您想在没有引用的情况下返回基本类型，而您想通过引用返回类对象。您推荐的任何文章、最佳实践文章。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-30T07:38:47.410

我假设你所说的类方法是指成员函数。而“通过引用返回”是指“返回对成员数据的引用”。这主要是与返回对本地的引用相反，这显然是错误的。

**什么时候应该返回对成员数据的引用，什么时候返回数据本身？**

默认情况下，您应该返回数据本身（也称为“按值”）。这避免了返回引用的几个问题：

*   用户存储引用并依赖于您的成员的**生命周期，而不考虑包含对象（您的对象）将存在多长时间。**导致悬空指针。

*   用户代码变得依赖于确切的**返回类型**。例如，您使用`vector<T>`for 实现（这就是您的 getter 返回的内容）。出现“ ”之类的用户代码`vector<T> foo = obj.getItems()`。然后你改变你的实现（和吸气剂）来使用`deque<T>`-- 用户代码中断。如果你一直按值返回，你可以简单地让 getter 创建一个本地向量，从成员 deque 复制数据，然后返回结果。对于小型收藏品来说相当合理。[*]

那么什么时候应该返回一个引用呢？

*   当返回的对象很大（`Image`）或不可复制（`boost::signal`）时，您可以考虑它。但是，与往常一样，您可以选择更多的 OOP 模式，让您的班级**做**一些事情，而不是让事情**挂在上面**。在这种`Image`情况下，您可以提供一个`drawCircle`成员函数，而不是返回`Image&`并让您的用户在其上画一个圆圈。
*   当您的数据在逻辑上归您的用户所有，而您只是为他持有它。考虑 std 集合：`vector<T>::operator[]`返回对 T 的*引用*，因为这就是我想要得到的：我的确切对象，而不是它的副本。

* * *

[*] 有更好的方法来确保代码面向未来。而不是返回一个向量（通过值的引用）返回一对迭代器到你的向量——一个开始和一个结束。这让您的用户可以完成他们通常使用双端队列或向量所做的*一切，但独立于实际实现。*Boost 提供`boost::iterator_pair`了这个目的。作为一个额外的好处，它还重载了 operator[]，所以你甚至可以做“ `int i = obj.getItems()[5]`”而不是“ `int i = obj.getItems().begin()[5]`”。

此解决方案可推广到任何允许您一般处理类型的情况。例如，如果您保留一个`Dog`成员，但您的用户只需要知道它是一个`Animal`（因为他们只调用`eat()`and `sleep()`），则返回一个*Animal*引用/指针，指向您的狗的 freestore 分配的副本。然后当你决定狗是弱者并且你真的需要一只狼来实现时，用户代码不会破坏。

这种*信息隐藏*不仅仅确保了未来的兼容性。它还有助于保持您的设计整洁。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-30T07:19:45.810

重载赋值运算符（如 =、+=、-= 等）是一个很好的例子，其中通过引用返回很有意义。这种方法显然会返回大对象，并且您不想返回指针，因此返回引用是最好的方法。像指针一样工作，看起来像按值返回。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-30T07:15:42.403

引用是变相的指针（所以它在 32 位机器上是 4 个字节，在 64 位机器上是 8 个字节）。所以经验法则是：如果复制对象比返回指针更昂贵，请使用指针（或引用，因为这是同一件事）。

哪些类型的复制成本更高取决于体系结构、编译器、类型本身等。在某些情况下，复制一个 16 字节的对象*可能*比返回一个指向它的指针更快（例如，如果一个对象映射到 SSE 寄存器，或者类似情况）。

现在，当然，返回对局部变量的引用是没有意义的。因为局部变量会在函数退出后消失。所以通常你会返回对成员变量、全局/静态变量或动态分配对象的引用/指针。

在某些情况下，您*不想*返回对对象的指针/引用，即使复制对象的成本很高。大多数情况下，当您不想将调用代码绑定到原始对象的生命周期时。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-30T15:04:27.090

Scott Meyers 的《*Effective C++* 》一书有几项与该主题相关。**我肯定会查看标题为“当您必须**返回对象时不要尝试返回引用”的项目。这是第 1 版或第 2 版中的第 23 条，或第 3 版中的第 21 条。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-30T08:13:58.993

出于与 Iraimbilanja 指出的相同原因，我建议远离返回引用，但在我看来，通过在成员数据上使用共享指针（例如 boost、tr1）并使用它们作为回报，您可以获得非常好的结果。这样您就不必复制对象，但仍然可以管理生命周期问题。

```
class Foo
{
private:
    shared_ptr<Bar> _bar;
public:
    shared_ptr<Bar> getBar() {return _bar;}
}; 
```

通常复制 Bar 的成本大于构建新的 shared_ptrs 的成本，如果不是这种情况，它仍然值得用于生命周期管理。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-08T04:49:56.393

if`NULL`是一个可能的返回值，该方法必须返回一个指针，因为您不能返回对`NULL`.

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-01-30T08:43:03.757

按值返回基本类型，除非您想让调用者访问实际成员。

通过引用返回类对象（甚至 std::string）。

# python - 创建一个运行 python 脚本的跨平台协议助手

> ID：494769
> 
> 赞同：7
> 
> 时间：2009-01-30T07:16:22.197
> 
> 标签：python, url, cross-platform

我想注册一个协议处理程序，例如`"myapp:"`，跨 OS `X`，`Linux`，`Windows`等等，这样当有人在 Web 浏览器中单击一个`URL`喜欢`"myapp://some/params"`时，将调用 Python 脚本并传入这些参数。

显然，这需要在每台机器上安装一些东西来启用它，但只需尝试找出一种方法让它在所有三个平台上都工作。

# events - 我需要一个类比：触发器和事件

> ID：494774
> 
> 赞同：4
> 
> 时间：2009-01-30T07:18:11.493
> 
> 标签：events, triggers

对于另一个问题，我遇到了一个似乎偶尔出现在 SO 的误解。一些提问者似乎认为触发器之于数据库就像事件之于 OOP 一样。

有没有人有一个很好的类比来解释为什么这是一个有缺陷的比较，以及误用它的后果？

* * *

编辑：

Bill K. 正确地击中了它，但也许没有看到事件和让我印象深刻的回调函数之间的关键区别的重要性，无论如何。触发器实际上会导致代码在每次事件发生时执行；回调仅在为事件注册时发生（对于绝大多数事件而言并非如此）；即便如此，在大多数情况下，回调的第一个动作是注销自身（或者至少回调包含一个限定退出，因此它只执行一次。）

如果你写一个触发器，它会在每次事件发生时都执行，因为没有办法注册或取消注册到代码段。

触发器是一种将重复逻辑同步插入执行线程（即同步性）的方法。事件是将逻辑推迟到以后的一种手段（即实现异步）。

这两种情况都有例外和缓解措施，但触发器和回调的基本模式在意图和实现上大多是相反的。通常，这种区别似乎并没有完全体现出来。（恕我直言，YMMV）。:D

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-30T08:15:23.983

它们不是一回事，但它们并非无关。

在这两种情况下，机制可以大致描述如下：

*   一些代码块声明对状态变化的“兴趣”。
*   您的应用程序会影响某些更改。
*   系统运行代码块以响应更改。

也许数据库触发器更像是一个对特定事件感兴趣的回调函数。

这是一个类比：事件是你扔的一个橡皮球。扳机是一只追逐投掷球的狗。

如果您想到的其他一些差异使其“危险”（注意：OP 已经编辑了这个词的选择，这是不可能的）来比较触发器和事件，您可以描述您的意思。

* * *

> 触发器是一种将重复逻辑同步插入执行线程（即同步性）的方法。事件是将逻辑推迟到以后的一种手段（即实现异步）。

好的，我明白你的意思更清楚了。但我认为它在某些方面受制于实施。我不认为事件处理程序必须自行注销。这取决于您使用的系统。例如，一个 UNIX 信号处理程序必须防止自己在处理一个新信号时捕获一个新信号。但是 Tomcat 容器中的 Java servlet 应该是线程安全的，因为它可以被多个线程同时调用。它们都是不同类型的事件处理程序。

事件处理程序可以是同步的或异步的。发布/订阅系统中的处理程序能否读取最近发布但在处理程序注册其兴趣之前发布的消息？还是只有同时发布的消息？

* * *

将触发器视为与事件处理程序不同的另一个重要原因是：我经常建议*不要*在触发器中执行任何影响数据库外部状态的操作。

例如，发送电子邮件、写入文件、发布到 Web 服务或分叉进程在触发器中是不合适的。如果除了产生触发器的事务之外没有其他原因，可能会回滚，但您不能回滚那些外部影响。您甚至可能没有使用显式事务，但假设您在 BEFORE 触发器中发送电子邮件，但由于 NOT NULL 约束或其他原因，操作失败。

相反，在确认 SQL 操作成功并提交事务*之后*，所有这些工作都应该由应用程序中的代码完成。

人们一直试图在触发器内做不适当的工作，这太糟糕了。MySQL 有高级开发人员推广 UDF 在 memcached 中读写数据。哇——我刚刚注意到这些已经[成为 MySQL 6.0 产品](http://dev.mysql.com/doc/refman/6.0/en/ha-memcached-interfaces-mysqludf.html)！震惊！

因此，这是另一个类比的尝试，将触发器和事件与刑事审判的过程进行比较：

*   BEFORE 触发器是一项指控。
*   AFTER 触发器是一种起诉。
*   COMMIT 是有罪判决后的定罪。
*   ROLLBACK 是无罪判决后的无罪释放。

你只想在犯罪者被定罪后把他们关进监狱。

*   而事件本身就是犯罪。

# javascript - 如何将多个参数传递给 javascript 回调函数？

> ID：494779
> 
> 赞同：19
> 
> 时间：2009-01-30T07:19:38.167
> 
> 标签：javascript, callback

Javascript代码：

```
function doSomething(v1,v2){ //blah; }

function SomeClass(callbackFunction,callbackFuncParameters(*Array*))={
   this.callback = callbackFunction;
   this.method = function(){
       this.callback(parameters[0],parameters[1])  // *.*
   }
}

var obj = new SomeClass( doSomething, Array('v1text','v2text') ); 
```

问题是如果我将函数 doSomething 更改为

```
function doSomething(v1,v2,v3){ //blah; } 
```

我必须将相应的行（标记为`//*.*`）更改`SomeClass`为

```
this.callback(parameters[0],parameters[1],parameters[2]); 
```

`(*.*)`无论“doSomething”函数的参数数量如何更改，如何避免更改行？

非常感谢！

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-01-30T07:24:10.107

您可能想使用[apply 方法](http://www.webreference.com/js/column26/apply.html)

```
this.callback.apply(this, parameters); 
```

应用的第一个参数表示回调中“this”的值，可以设置为任何值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-06-29T21:33:19.130

现在可用的另一种方法是使用[扩展语法](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_syntax)。

```
this.callback(...callbackFuncParameters) 
```

这里又是来自 OP 的完整示例：

```
function doSomething(v1,v2) {
    console.log('doing', {v1, v2});
}

function SomeClass(callbackFunction, callbackFuncParameters) {
   this.callback = callbackFunction;
   this.method = function(){
       this.callback(...callbackFuncParameters); // spread!
   }
}

var obj = new SomeClass( doSomething, Array('v1text','v2text') );
obj.method()
// output: doing {v1: "v1text", v2: "v2text"} 
```

# c# - 尝试在 Visual Studio 2008 中编辑 UI 时出现 WPF 设计器异常

> ID：494782
> 
> 赞同：2
> 
> 时间：2009-01-30T07:21:09.770
> 
> 标签：c#, wpf, visual-studio-2008, data-binding, xaml

我的机器上安装了带有 .net 3.5 SP1 的 VS2008，我编写了一个带有两个列表视图和数据绑定的简单应用程序，我的应用程序编译得很好，我可以运行它，但是当我尝试打开设计器来编辑控件时，我得到了以下错误。我不明白为什么会这样。任何想法...请参阅此错误消息下方的 xaml

> 在程序集“PresentationFramework, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35”中键入“MS.Internal.Permissions.UserInitiatedNavigationPermission”未标记为可序列化。在 System.Runtime.Serialization.FormatterServices.InternalGetSerializableMembers(RuntimeType type) 在 System.Runtime.Serialization.FormatterServices.GetSerializableMembers(Type type, StreamingContext context) 在 System.Runtime.Serialization.Formatters.Binary.WriteObjectInfo.InitMemberInfo() 在 System. Runtime.Serialization.Formatters.Binary.WriteObjectInfo.InitSerialize（对象 obj，ISurrogateSelector surrogateSelector，StreamingContext 上下文，SerObjectInfoInit serObjectInfoInit，IFormatterConverter 转换器，ObjectWriter objectWriter）在 System.Runtime.Serialization.Formatters.Binary.WriteObjectInfo。

XAML：

```
<Grid Name="pngrid_Base" Height="auto" Width="auto" Background="Beige">
    <Grid.ColumnDefinitions>
        <ColumnDefinition Width="auto" MinWidth="221"></ColumnDefinition>
        <ColumnDefinition Width="auto" MinWidth="1" MaxWidth="1"></ColumnDefinition>
        <ColumnDefinition Width="auto"></ColumnDefinition>
    </Grid.ColumnDefinitions>
        <Grid Name="pngrid_BaseForAll" Grid.Column="0" Width="auto" HorizontalAlignment="Left" Background="#FFD8E4F8">
     <Grid.RowDefinitions>
        <RowDefinition Height="30*"/>
        <RowDefinition Height="164*" />
        <RowDefinition Height="35*" />
        <RowDefinition Height="164*" />
        <RowDefinition Height="40*" />
    </Grid.RowDefinitions>
        <ListView  Name="lstview_Unack" Grid.Row="1" Margin="2,0,0,0" SelectionMode="Extended"  LostFocus="lstview_Unack_LostFocus" 
                                                                                                MouseRightButtonDown="lstview_Unack_MouseRightButtonDown">

            <ListView.ItemContainerStyle>
                <Style TargetType="ListViewItem">
                    <Setter Property="IsSelected" Value="{Binding Path=IsSelected, Mode=TwoWay}" />
                </Style>
            </ListView.ItemContainerStyle>
        </ListView>
        <Button Grid.Row="2" HorizontalAlignment="Left" Margin="24,14,0,5" Name="btnFreeze">Freeze</Button>
            <Button Grid.Row="2" HorizontalAlignment="Left" Margin="12,7,0,5" Name="btnAcknowledge" Width="96">Acknowledge</Button>
        <ListView  Name = "lstview_Ack" Grid.Row="3" Margin="2,1,0,0" LostFocus="lstview_Ack_LostFocus" SelectionMode="Extended" MouseRightButtonDown="lstview_Ack_MouseRightButtonDown">
            <ListView.ItemContainerStyle>
                <Style TargetType="ListViewItem">
                    <Setter Property="IsSelected" Value="{Binding Path=IsSelected, Mode=TwoWay}" />                            
                </Style>
            </ListView.ItemContainerStyle>
        </ListView>

        <Button Grid.Row="4" HorizontalAlignment="Left" Margin="16,12,0,7" Name="Clear" Width="78">Clear</Button>
    <TextBox Margin="110,6,32,5" Name="FilterText" TextChanged="FilterText_TextChanged" />
    <ComboBox HorizontalAlignment="Left" Margin="14,5,0,4" Name="comboColumnList" Width="94" />
</Grid>
    <GridSplitter Grid.Column="1" Name="gridSplitter1" Width="2" HorizontalContentAlignment="Center" VerticalContentAlignment="Stretch" HorizontalAlignment="Left" Background="Azure" />
    <Grid Name="pnGridForTreeView" Grid.Column="2" Width="200" Grid.ColumnSpan="2">
        <my:TrinityDeviceTree  x:Name ="m_objDeviceTree" Height="auto" Width="auto">

        </my:TrinityDeviceTree>
    </Grid>

</Grid> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-30T09:48:30.893

我已经使用 .NET 3.5 SP1 在 VS2008 中测试了您的代码，如果我删除了 TrinityDeviceTree 的声明，它与设计器一起工作得很好。也许你应该检查那个 UserControl 并在那里寻找错误。还要尝试清理您的项目并重新构建，有时它适用于视觉设计师的问题。

# testing - AIX 上的 LD_PRELOAD

> ID：494789
> 
> 赞同：3
> 
> 时间：2009-01-30T07:24:27.190
> 
> 标签：testing, aix

有人能告诉我最近版本的 AIX 上是否有类似于 LD_PRELOAD 的东西吗？更具体地说，出于测试目的，我需要拦截从我的二进制文件到 time() 的调用，返回一个常量时间。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-08-10T12:34:33.097

AIX 5.3 引入了`LDR_PRELOAD`（对于 32 位程序）和`LDR_PRELOAD64`（对于 64 位程序）变量。它们类似于 Linux 上的 LD_PRELOAD。两者都是以冒号分隔的库列表，并且符号将在其他任何内容之前从列出的共享对象中抢先加载。

例如，如果您有一个共享对象 foo.so：

```
 LDR_PRELOAD=foo.so 
```

如果您使用归档，请使用 AIX 样式来指定归档中的对象：

```
 LDR_PRELOAD="bar.a(shr.so)" 
```

并用冒号分隔多个条目：

```
 LDR_PRELOAD="foo.so:bar.a(shr.so)" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T06:31:30.923

AIX 5L 使用 LDR_PRELOAD 变量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-30T07:43:00.303

不是我知道的。我们做过的最接近的事情（使用 malloc/free 进行调试）是

*   创建一个仅包含所需功能的新库文件（与原始名称相同）。
*   将其放在与原始目录不同的目录中。
*   使我们的库文件依赖于原始文件。
*   更改 LD_LIBRARY_PATH（或 SHLIB_PATH？）以将我们的库放在搜索链的首位。

这样，我们的函数首先被加载器拾取，任何我们没有提供的都是由原始提供的。

这是不久前的事了。AIX 5L 应该更像 Linux（因此是 L），因此它可能能够完全满足您的要求。

或者，如果您有源代码，请使用 mytime() 调用 time() 并提供您的函数。您没有测试**完全相同**的软件，但这种最小更改的差异应该无关紧要。

# c# - F# 中的异步工作流

> ID：494798
> 
> 赞同：4
> 
> 时间：2009-01-30T07:29:49.830
> 
> 标签：c#, f#, asynchronous, async-workflow

我是一名 C# 程序员，但我对 F# 中的异步工作流有疑问。假设我在 C# 类库中有以下类：

```
class File {
 IAsyncResult BeginReadAll(string fileName, AsyncCallback callback, object state){}
 string EndReadAll(IAsyncResult result){}
} 
```

我的理解是，我可以在 F# 中创建一个名为 ReadAllAsync 的函数，我可以像这样调用它：

```
async {  let! rsp = ReadAllAsync() } 
```

并且它不会阻塞调用线程，而是将其释放到线程池中，然后在操作完成时返回另一个线程。我想我了解如何使用 Async.Primitive 在 F# 中对此进行编码，但我的问题是：我可以从 C# 代码中调用这个 ReadAllAsync 函数吗？如果是这样，我如何将 F# 代码打包到类库中以从 C# 访问？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-30T08:17:58.203

这是一篇文章，准确地显示了您的要求：

[http://codebetter.com/blogs/matthew.podwysocki/archive/2008/10/15/functional-c-implementing-async-computations-in-c.aspx](http://codebetter.com/blogs/matthew.podwysocki/archive/2008/10/15/functional-c-implementing-async-computations-in-c.aspx)

但是，您最终会使用 C# 的 monad 语法。由于 LINQ 是为查询而设计的，所以它看起来有点奇怪。此外，不支持 try/catch 或 using for dispose。

如果没有正确的 monad 语法，您从 Async.BuildPrimitive 获得的“ReadAllAsync”不会有同样的魔力。调用它很简单，但真正的实用程序是能够组合它。

不幸的是，您最好只使用 C# 样式，

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-07-23T07:55:28.910

令人高兴的是，当 Beta2 到来时，F# 核心库将在 Async 模块中有这个方法：

```
/// Return three functions that can be used to implement the .NET Asynchronous 
/// Programming Model (APM) for a given asynchronous computation.
/// 
/// The functions should normally be published as members with prefix 'Begin',
/// 'End' and 'Cancel', and can be used within a type definition as follows:
/// <c>
///   let beginAction,endAction,cancelAction = Async.AsBeginEnd computation
///   member x.BeginSomeOperation(callback,state) = beginAction(callback,state)
///   member x.EndSomeOperation(iar) = endAction(iar)
///   member x.CancelSomeOperation(iar) = cancelAction(iar)
/// </c>
///
/// The resulting API will be familiar to programmers in other .NET languages and 
/// is a useful way to publish asynchronous computations in .NET components.
static member AsBeginEnd : computation:Async<'T> ->                     // '
                             // The 'Begin' member
                             (System.AsyncCallback * obj -> System.IAsyncResult) * 
                             // The 'End' member
                             (System.IAsyncResult -> 'T) *              // '
                             // The 'Cancel' member
                             (System.IAsyncResult -> unit) 
```

这将使使用 F# 编写异步代码变得容易，然后使用普通 APM 将其发布回 C# 或 VB。

# opengl - GLSL 版本更改日志？

> ID：494800
> 
> 赞同：5
> 
> 时间：2009-01-30T07:32:46.517
> 
> 标签：opengl, version, glsl

有没有什么地方可以阅读 GLSL 从 1.1 到 1.2 以及从 1.2 到 1.3 所做的更改和添加？
谷歌似乎对此不知所措，我真的不想开始阅读完整的规范。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-30T07:55:43.960

[规范的1.3 版本](http://www.opengl.org/registry/doc/GLSLangSpec.Full.1.30.08.withchanges.pdf)与 1.2 有区别，它还列出了 1.2 的变化。 [1.2 版](http://www.opengl.org/registry/doc/GLSLangSpec.Full.1.20.8.pdf)有一个从 1.1 开始的更改列表。

# perl - 如何在 Class::DBI 中使用 add_to？

> ID：494803
> 
> 赞同：3
> 
> 时间：2009-01-30T07:34:45.000
> 
> 标签：perl, class-dbi

我正在尝试将 Class::DBI 与一个简单的单亲 -> 可能与孩子的关系一起使用：

```
Data::Company->table('Companies');
Data::Company->columns(All => qw/CompanyId Name Url/);
Data::Company->has_many(offers => 'Data::Offer'=>'CompanyId'); # =>'CompanyId' 
```

和

```
Data::Offer->table('Offers');
Data::Offer->columns(All => qw/OfferId CompanyId MonthlyPrice/);
Data::Offer->has_a(company => 'Data::Company'=>'CompanyId'); 
```

我尝试添加新记录：

```
my $company = Data::Company->insert({ Name => 'Test', Url => 'http://url' });
my $offer = $company->add_to_offers({  MonthlyPrice => 100 }); 
```

但我得到：

```
Can't locate object method "add_to_offers" via package "Data::Company" 
```

我查看了古典 Music::CD 示例，但我无法弄清楚我做错了什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-30T12:31:44.683

我同意 Manni 的观点，如果你的包声明在同一个文件中，那么你需要先`has_a()`定义具有关系的类。否则，如果它们位于不同的源文件中，则文档说明：

> Class::DBI 通常应该能够做正确的事情，只要所有类在“使用”任何其他类之前都继承 Class::DBI。

至于三参数形式，你做得很好。第三个参数`has_many()`是外部类中的列，它是该类的外键。也就是说，`Offer`有 a `CompanyId`which 指向`Company`'s `CompanyId`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-30T18:03:33.903

谢谢

好吧，问题实际上不是我的代码，而是我的设置。今天早上打开我的电脑后，我意识到：* 服务器上的 Apache + mod_perl * SMB 挂载

当我对几个文件进行更改时，并非所有更改似乎都由 mod_perl 加载。重新启动 Apache 解决了这个问题。实际上，我过去曾看到过客户端和 SMB 服务器的时间不同步的此类问题。

上面的代码适用于每个模块的 1 个文件。

谢谢

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-30T10:48:36.950

我真的没有太多使用 Class:DBI 的经验，但无论如何我都会试一试：

1.  该[文档](http://search.cpan.org/~tmtm/Class-DBI/lib/Class/DBI.pm#has_many)指出：“必须先定义具有 has_a() 的类，然后再定义具有 has_many() 的类”。
2.  我找不到任何关于您使用 has_a 和 has_many 方式的参考，其中三个参数在您的情况下始终为“CompanyId”。

# ruby-on-rails - Rails 需要 RubyGems >= 0.9.4。请安装 RubyGems

> ID：494804
> 
> 赞同：2
> 
> 时间：2009-01-30T07:34:46.950
> 
> 标签：ruby-on-rails, ruby, deployment, rubygems, cron

[与这篇文章](https://stackoverflow.com/questions/29382/rails-requires-rubygems-0-9-4-please-install-rubygems)有相同的问题，但不幸的是我认为解决方案不一样。

我收到此错误消息：

```
Rails requires RubyGems >= 0.9.4\. Please install RubyGems 
```

当我在 Cron 中运行脚本/运行器作业时，但是当我在同一服务器上的终端中运行它时它工作得非常好。

rails 服务器也运行良好。我只有在 cron 中运行脚本/运行程序时遇到问题。它似乎想要连接一个终端......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-30T07:39:56.097

尝试从您的 cron 作业以及终端中进行`which ruby`。`which gem`您是否在访问不同的二进制文件？您没有提及哪个操作系统和哪个外壳，但是`$PATH`在无头运行时可能会有不同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-30T19:08:00.047

选择的答案是完全正确的，但我建议不要使用脚本/运行器。加载 Rails 应用程序的整个堆栈所需的资源对于定期运行的东西来说是相当密集的。

根据我过去的经验，任何 cron 作业通常只需要处理数据（而不是生成静态文件等）。在这种情况下，您可以非常简单地加载模型，并且由于您以*正确*的方式编写模型（胖模型），因此您可以使用一些模型方法轻松地进行数据处理。

当然，以上所有内容完全取决于您的任务，因此请谨慎对待 :)

我想这是对一个可能不存在的问题的一种回答，在这里没有被问到，但我只是想我会把我的两分钱扔进去；）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-30T07:42:01.973

你不会碰巧在 OSX 上工作吗？您应该在 macports 上安装更新的 ruby​​ rails 和 gems。谷歌的说明...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-30T14:58:03.000

正如之前的帖子所指出的，您的 Cron 正在使用不同的 gem 命令源——也可以尝试`which gem`和`gem -v`. 您可能在您的`.bash_profile`（或类似的外壳配置或可能通过其他方式设置适当的 Ruby/Rails 环境（即 Locomotive 或其他一体化环境）中设置了一个库。

要更新您的 gem 设置：

`gem update --system`

更多信息在这里 - [http://www.rubygems.org/read/book/1](http://www.rubygems.org/read/book/1)

# sql - 使用 ORM 还是普通 SQL？

> ID：494816
> 
> 赞同：277
> 
> 时间：2009-01-30T07:42:18.353
> 
> 标签：sql, language-agnostic, orm

对于我开发的一些应用程序（然后开始忘记），我一直在编写简单的 SQL，主要是为 MySQL 编写的。虽然我在 Python 中使用过 ORM，比如[SQLAlchemy](http://www.sqlalchemy.org/)，但我并没有长时间坚持使用它们。通常是文档或复杂性（从我的角度来看）阻碍了我。

我是这样看的：使用 ORM 来实现可移植性，如果只是使用一种类型的数据库，则使用纯 SQL。在开发需要数据库支持的应用程序时，我真的在寻找关于何时使用 ORM 或 SQL 的建议。

考虑一下，与使用 ORM 相比，使用轻量级包装器来处理数据库不一致要好得多。

* * *

## 回答 #1

> 赞同：278
> 
> 时间：2009-01-30T08:05:03.113

作为一个花了很多时间使用 JPA（Java Persistence API，基本上是 Java/J2EE/EJB 的标准化 ORM API）的人，其中包括 Hibernate、EclipseLink、Toplink、OpenJPA 等，我将分享一些我的观察。

1.  ORM 并不快。它们可能是足够的，并且大多数时候足够是可以的，但是在大容量低延迟环境中，它们是禁忌；
2.  在 Java 和 C# 等通用编程语言中，您需要大量的魔法才能使它们工作（例如 Java 中的加载时编织、仪器等）；
3.  当使用 ORM 时，而不是远离 SQL（这似乎是意图），您会惊讶于您花费了多少时间来调整 XML 和/或注释/属性以使您的 ORM 生成高性能 SQL；
4.  对于复杂的查询，确实没有替代品。就像在 JPA 中一样，有一些在原始 SQL 中根本不可能的查询，当您必须在 JPA 中使用原始 SQL 时，它并不漂亮（C#/.Net 至少有动态类型——var——很多比对象数组更好）；
5.  使用 ORM 时有很多“陷阱”。这包括意外或意外行为，您必须构建对数据库执行 SQL 更新的能力（通过在 JPA 中使用 refresh() 或类似方法，因为 JPA 默认缓存所有内容，因此它不会捕获直接数据库更新——运行直接 SQL 更新是一种常见的生产支持活动）；
6.  对象关系不匹配总是会导致问题。对于任何此类问题，都需要在抽象的复杂性和完整性之间进行权衡。有时我觉得 JPA 走得太远了，遇到了一个真正的收益递减规律，其中复杂性的影响并不能通过抽象来证明是合理的。

还有一个问题需要更多解释。

Web 应用程序的传统模型是有一个持久层和一个表示层（可能在中间有一个服务或其他层，但对于本次讨论来说，这两个是重要的）。ORM 强制从您的持久层到表示层（即您的实体）的严格视图。

对更原始的 SQL 方法的批评之一是，您最终会得到仅由一个查询使用的所有这些 VO（值对象）或 DTO（数据传输对象）。这被吹捧为 ORM 的一个优势，因为你摆脱了它。

问题是这些问题不会随着 ORM 消失，它们只是向上移动到表示层。您无需为查询创建 VO/DTO，而是创建自定义表示对象，通常为每个视图创建一个。这如何更好？恕我直言，它不是。

我在[ORM 或 SQL 中写过这个：我们到了吗？](https://web.archive.org/web/20090528082618/http://www.cforcoding.com/2009/05/orm-or-sql.html).

这些天我选择的持久性技术（在 Java 中）是 ibatis。它是一个围绕 SQL 的非常薄的包装器，它完成了 JPA 可以做的 90% 以上的事情（它甚至可以做关系的延迟加载，尽管它没有很好的文档记录），但开销要少得多（就复杂性和实际代码而言）。

这在去年我正在编写的一个 GWT 应用程序中出现。服务实现中从 EclipseLink 到表示对象的大量转换。如果我们使用的是 ibatis，那么使用 ibatis 创建适当的对象然后在堆栈中上下传递它们会简单得多。一些纯粹主义者可能会认为这是 Bad™。也许是这样（理论上），但我告诉你：它会导致更简单的代码、更简单的堆栈和更高的生产力。

* * *

## 回答 #2

> 赞同：191
> 
> 时间：2009-01-30T08:06:35.810

ORM 有一些不错的特性。他们可以处理将数据库列复制到对象字段的大部分繁琐工作。他们通常处理将语言的日期和时间类型转换为适当的数据库类型。它们通常通过实例化嵌套对象来非常优雅地处理一对多关系。我发现如果您在设计数据库时考虑到 ORM 的优点和缺点，它可以节省大量将数据输入和输出数据库的工作。（如果你需要映射它们，你会想知道它如何处理多态性和多对多关系。正是这两个域提供了大部分的“阻抗不匹配”，这使得一些人将 ORM 称为“计算机科学的越南” .)

对于事务性应用程序，即您发出请求，获取一些对象，遍历它们以获取一些数据并将其呈现在网页上，性能税很小，并且在许多情况下 ORM 可以更快，因为它会缓存对象以前见过，否则会多次查询数据库。

对于报告繁重的应用程序，或者每个请求处理大量数据库行的应用程序，ORM 税要重得多，并且它们所做的缓存变成了巨大的、无用的内存占用负担。在这种情况下，简单的 SQL 映射（LinQ 或 iBatis）或在瘦 DAL 中手动编码的 SQL 查询是可行的方法。

我发现对于任何大型应用程序，您都会发现自己使用这两种方法。（ORM 用于简单的 CRUD，SQL/thin DAL 用于报告）。

* * *

## 回答 #3

> 赞同：56
> 
> 时间：2009-03-31T07:37:33.407

我说用于阅读的普通 SQL *，用于 CUD**的*ORM 。

 *性能是我一直关心的问题，特别是在 Web 应用程序中，还有代码的可维护性和可读性。为了解决这些问题，我编写了[SqlBuilder](http://maxtoroq.github.io/DbExtensions/docs/SqlBuilder.html)。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-01-30T07:48:06.597

ORM 不仅仅是可移植性（就此而言，即使使用 ORM 也很难实现）。它为您提供的基本上是持久存储上的抽象层，当 ORM 工具使您免于编写样板 SQL 查询（通过 PK 或谓词、插入、更新和删除选择）并让您专注于问题域时。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2009-01-30T07:44:48.910

任何可敬的设计都需要对数据库进行一些抽象，以处理阻抗失配。但我希望最简单的第一步（并且对于大多数情况来说已经足够了）是 DAL，而不是重量级的 ORM。您唯一的选择不是那些处于光谱末端的选择。

* * *

编辑回应要求我描述如何区分 DAL 和 ORM 的评论：

DAL 是您自己编写的，可能从一个简单地封装表并将其字段映射到属性的类开始。ORM 是您不为从 dbms 模式的其他属性（主要是 PK 和 FK）推断出的抽象机制编写的代码。（在这里您可以了解自动抽象是否开始泄漏。我更愿意有意地通知他们，但这可能只是我个人的偏好）。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-01-30T08:21:44.750

在现代软件开发场景中，是否使用框架的困境非常普遍。

重要的是要理解每个框架或方法都有其优点和缺点 - 例如，根据我们的经验，我们发现 ORM 在处理事务（即插入/更新/删除操作）时很有用 - 但在获取复杂的数据时结果，评估 ORM 工具的性能和有效性变得很重要。

同样重要的是要了解，选择框架或方法并实施其中的所有内容不是强制性的。我们的意思是我们可以混合使用 ORM 和本地查询语言。许多 ORM 框架为原生 SQL 中的插件提供扩展点。我们应该尽量不要过度使用框架或方法。我们可以结合某些框架或方法，并提供适当的解决方案。

在插入、更新、删除、高并发版本控制方面可以使用 ORM，并且可以使用 Native SQL 生成报告和长列表

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2009-01-30T10:29:16.473

让我真正使用 ORM 的关键是代码生成。我同意 ORM 路线在代码性能方面并不是最快的。但是当你有一个大中型团队时，数据库正在迅速变化，从数据库中重新生成类和映射作为构建过程的一部分的能力是非常值得一看的，尤其是当你使用 CI 时。所以你的代码可能不是最快的，但你的编码会是——我知道在大多数项目中我会采用哪个。

我的建议是在 Schema 仍处于流动状态时使用 ORM 进行开发，使用分析来查找瓶颈，然后使用原始 Sql 调整需要它的那些区域。

另一个想法是，如果以正确的方式使用，Hibernate 中内置的缓存通常可以大大提高性能。不再返回数据库读取参考数据。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2010-11-26T22:43:08.847

每个工具都有其目的和愿景。我创建了[http://www.jooq.org/](http://www.jooq.org/)来完全满足您的需求，尽管 iBatis 对您来说可能也是一个很好的解决方案。

jOOQ 具有基本的 ORM 功能，但它主要关注我猜大多数开发人员最需要的东西，当他们试图找到最适合他们需求的 ORM 时：

*   代码生成
*   变量绑定（这在 JDBC 中很痛苦）
*   SQL 语法抽象（防止语法错误）

但通常它们走得太远并提供了如此多的抽象，您不会认为它们是针对 RDBMS 运行的。另一方面，您选择 RDBMS 正是因为

*   它是一个强大的数据源
*   SQL 可以做很多好的、高性能的事情（嵌套选择、联合、复杂连接等）。通常 ORM 不能做这些事情。
*   您可以自己处理事务和会话
*   你有 UDT 和存储过程

jOOQ 正好解决了这些问题。它的性能与 JDBC 一样好，但没有痛苦。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-02-02T07:53:05.227

没有“一刀切”的解决方案，对于“我应该使用 or/m 还是不使用？'。

我想说：如果你必须编写一个非常“数据”的应用程序/工具，没有太多其他逻辑，那么我会使用纯 SQL，因为 SQL 是这种应用程序的特定领域语言。

另一方面，如果我要编写一个包含大量“域”逻辑的业务/企业应用程序，那么我会编写一个可以用代码表达这个域的富类模型。在这种情况下，OR/M 映射器可能对成功执行此操作非常有帮助，因为它需要大量的管道代码。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-30T07:48:45.173

我开发的其中一个应用程序是一个用 python 编写的 IRC 机器人。它使用的模块在单独的线程中运行，但我还没有想出在使用 sqlite 时处理线程的方法。不过，对于单独的问题，这可能会更好。

我真的应该改写标题**和**实际问题。我以前从未真正使用过任何语言的 DAL。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2013-09-13T20:13:42.940

使用*类似于*SQL 的 ORM，但提供编译时检查和类型安全。喜欢我最喜欢的：[数据知识对象](https://github.com/keredson/DKO)（披露：我写的）

例如：

```
for (Bug bug : Bug.ALL.limit(100)) {
  int id = bug.getId();
  String title = bug.getTitle();
  System.out.println(id +" "+ title);
} 
```

完全流式传输。易于设置（无需定义映射 - 读取您现有的模式）。支持连接、事务、内部查询、聚合等。几乎可以在 SQL 中执行任何操作。并且已经从巨大的数据集（金融时间序列）一直到微不足道的（Android）证明。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2013-10-12T20:38:07.287

我知道这个问题很老了，但我想我会发布一个答案，以防有人像我一样遇到它。ORM 已经走过了漫长的道路。其中一些实际上为您提供了两全其美的优势：提高开发效率并保持性能。

查看 SQL 数据 ( [http://sqldata.codeplex.com](http://sqldata.codeplex.com) )。它是一个非常轻量级的 C# ORM，涵盖了所有基础。

仅供参考，我是 SQL Data 的作者。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2014-07-14T05:37:55.627

我想在“有一个中间立场！”的回复中加入我的声音。

对于应用程序程序员来说，SQL 是你可能想要控制的东西和你几乎肯定不想被打扰控制的东西的混合体。

我一直想要的是一个层（称为 DAL、ORM 或微 ORM，我不介意哪个）负责完全可预测的决策（如何拼写 SQL 关键字，括号的位置，何时发明列别名，为包含两个浮点数和一个整数的类创建哪些列...），同时让我负责 SQL 的更高级别方面，即如何安排 JOIN、服务器端计算、 DISTINCT、GROUP BY、标量子查询等。

所以我写了一些东西：http: [//quince-lib.com/](http://quince-lib.com/)

它适用于 C++：我不知道这是否是您正在使用的语言，但尽管如此，看到这种“中间立场”的样子可能会很有趣。

# c# - 这种模式有多糟糕？

> ID：494820
> 
> 赞同：0
> 
> 时间：2009-01-30T07:44:56.243
> 
> 标签：c#, design-patterns, asynchronous

当我需要控制各种异步操作需要多长时间时，我一直在使用这种模式。我并不是专门针对 WebRequest（我知道您可以设置 timeout 属性），我只是将此作为模式的示例。

```
 var request = WebRequest.Create(someUri);

        WebResponse response = null;
        request.BeginGetResponse(result =>
            {
                var asyncRequest = (WebRequest)result.AsyncState;
                response = asyncRequest.EndGetResponse(result);
            }, request);

        DateTime timeout = DateTime.Now.AddSeconds(10);
        while (response == null && DateTime.Now <= timeout)
        {
            Thread.Sleep(0);
        }
        if (response == null) throw new Exception("Timeout!"); 
```

在我读到 Thread.Sleep() 的任何地方，我都听说这是一件很糟糕的事情，但我并不认为这个用例会滥用它。

我知道它可能会超过 10 秒，但这对我来说并不重要。

那么，这*真的*是完成我正在完成的事情的坏方法吗？如果是，有什么更好的方法呢？

编辑：也许我应该澄清我想要完成的事情。

目的是控制等待呼叫所花费的最长时间。我知道这违背了异步调用的目的，但目的绝不是异步的，我只是将它用作控制何时退出调用的一种手段。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-30T08:04:19.963

WaitHandles 等待方法支持超时，使用它。就像是：

```
 var asyncResult = request.BeginGetResponse(...
  asyncResult.AsyncWaitHandle.WaitOne(TimeSpan.FromSeconds(10)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-30T08:15:42.297

我的代码看起来也很好。`timeout`如果 api 中没有属性，这只是一种支持同步调用属性的方法。虽然我应该说你最好用某种类替换这个等待循环`WaitHandle`，但它会使用更少的资源，而且我相信它看起来会更好。抱歉，由于我不了解 C# 并且它的 API 很好，因此无法提供解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-30T08:09:11.750

为了完整性：为避免阻塞当前线程，请使用 System.Threading.Timer。

# windows - IIS7中不同的域到不同的页面

> ID：494822
> 
> 赞同：5
> 
> 时间：2009-01-30T07:45:51.267
> 
> 标签：windows, configuration, iis-7, hosting, dns

我在 IIS7 的默认网站中有一个*默认网站*和另一个 Web 应用程序（我们称之为*Application2 ）。*

我有 2 个注册域名，比如说*www.example.com*和*www.example.net*。

我想配置当我打开*www.example.com*我得到*Default Web Site*时，当我打开*www.example.net*我得到*Default Web Site/Application2*。

```
www.example.com -> Default Web Site
www.example.net -> Default Web Site/Application2 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-12T13:39:40.023

首先，您需要决定是使用基于名称还是基于 IP 的托管。

IP-Based 使用唯一的 ip 来确定它将服务哪个虚拟主机，而 Name Based 将实际使用客户端浏览器发送的主机标头。

所以让我们看两个场景：

场景 #1（共享一个 IP）

您的服务器只有一个 IP，可以是私有的或公共的，只要您所服务的域在为您提供内部或外部客户端 (NAT) 的 dns 中正确配置。

为了本教程，我建议您停止默认网站。行。

您将在 II7 中设置一个站点并相应地命名它。转到管理器的右侧并在操作菜单下查找“绑定”；确保在左窗格中选择了新站点。现在在“站点绑定”下选择您将在站点之间共享的 IP 地址（基于名称的托管）。在“主机名”下输入域#1“www.example.com”，点击确定。

对其他域或多个域执行上述相同的过程，确保它们具有不同的主机名和相同的 ip。

就是这样。您现在将能够启动这些站点并同时运行它们。

如果您使用“默认站点”，则适用上述相同原则。“默认站点”只是 MS 给默认创建的一个名称。

场景 #2（多个 IP 共享）

如果您有一些私有或公共 ip 可用，或者至少在您进行练习之前，唯一的区别是您将设置站点并且不必为每个站点指定“主机名”，因为这基本上是在 DNS 区域本身中完成。无论如何，这些站点都会响应对端口 80 上的这些 IP 的任何请求。

您什么时候需要使用多个 IP 来服务网站。好吧，这一切都取决于。

一些原因是：网络隔离（安全）、在基于名称的托管下无法正常运行的应用程序、SSL 证书绑定 443（PRE II7）以及对站点的大部分完全控制。当然还有更多的原因，但我也会让其他人写一点。

玩得开心。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-30T08:02:15.287

编辑...经过进一步调查，我发现如果您可以设置多个站点并同时运行它们。只需在设置主机值后停止和启动站点即可使它们同时运行。

原帖：

直接的方法是通过打开 IIS 并右键单击站点然后选择添加网站来添加另一个应用程序。在那里，您可以指定 Application2 的物理路径，并将“主机”设置为“www.example.net”，这将过滤所有对您的第二个站点的请求。任何与“www.example.net”不匹配的请求仍将转到默认网站。

这种方法在使用 IIS 的 Windows Server 上可以正常工作，但在 Vista 的 IIS7 上则行不通，因为一次只能运行一个站点。要启动第二个站点，您首先必须停止默认网站。

# c# - 为什么不能在 .NET 中定义通用索引器？

> ID：494827
> 
> 赞同：55
> 
> 时间：2009-01-30T07:49:24.877
> 
> 标签：c#, .net, generics

为什么不能在 .NET 中创建通用索引器？

以下代码引发编译器错误：

```
public T this<T>[string key]
{
    get => /* Return generic type T. */
} 
```

这是否意味着您不能为通用成员集合创建通用索引器？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2010-02-01T17:42:39.783

这是一个有用的地方。`OptionKey<T>`假设您有一个用于声明选项的强类型。

```
public static class DefaultOptions
{
    public static OptionKey<bool> SomeBooleanOption { get; }
    public static OptionKey<int> SomeIntegerOption { get; }
} 
```

`IOptions`通过界面公开选项的位置：

```
public interface IOptions
{
    /* since options have a default value that can be returned if nothing's
     * been set for the key, it'd be nice to use the property instead of the
     * pair of methods.
     */
    T this<T>[OptionKey<T> key]
    {
        get;
        set;
    }

    T GetOptionValue<T>(OptionKey<T> key);
    void SetOptionValue<T>(OptionKey<T> key, T value);
} 
```

然后代码可以使用通用索引器作为一个很好的强类型选项存储：

```
void Foo()
{
    IOptions o = ...;
    o[DefaultOptions.SomeBooleanOption] = true;
    int integerValue = o[DefaultOptions.SomeIntegerOption];
} 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-01-30T07:58:41.863

我不知道为什么，但索引器只是语法糖。改为编写一个通用方法，您将获得相同的功能。例如：

```
 public T GetItem<T>(string key)
   {
      /* Return generic type T. */
   } 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2009-01-30T08:03:43.337

属性在 C#2.0/3.0 中不能是通用的，因此您不能拥有通用索引器。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-01-30T07:57:12.740

你可以; 只需从您的声明中删除该`<T>`部分，它就会正常工作。IE

```
public T this[string key]
{
   get { /* Return generic type T. */ }
} 
```

（假设您的类是具有名为 的类型参数的泛型`T`）。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-30T08:12:32.133

我能想到的唯一可以使用的是这些方面的东西：

```
var settings = ConfigurationSection.AppSettings;
var connectionString = settings<string>["connectionString"];
var timeout = settings<int>["timeout"]; 
```

但这实际上并没有给你买任何东西。`(int)settings["timeout"]`您刚刚用尖括号替换了圆括号（如），但没有像您可以随意做的那样获得额外的类型安全性

```
var timeout = settings<int>["connectionString"]; 
```

如果你有一些强类型但不是静态类型的东西，你可能想等到 C# 4.0 使用它的*dynamic*关键字。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-09-20T15:39:36.980

我喜欢拥有一个索引器而不直接引用“索引”项目的能力。我在下面写了一个简单的“回调”索引器类......

R = 从索引器返回的类型 P = 传递到索引器的类型

索引器真正做的就是将操作传递给部署者，让他们管理实际发生的事情并返回。

```
public class GeneralIndexer<R,P>
    {
        // Delegates
        public delegate R gen_get(P parm);
        public delegate void gen_set(P parm, R value);
        public delegate P[] key_get();

        // Events
        public event gen_get GetEvent;
        public event gen_set SetEvent;
        public event key_get KeyRequest;

        public R this[P parm]
        {
            get { return GetEvent.Invoke(parm); }
            set { SetEvent.Invoke(parm, value); }
        }

        public P[] Keys
        {
            get
            {
                return KeyRequest.Invoke();
            }
        }

    } 
```

在程序或类中使用它：

```
private GeneralIndexer<TimeSpan, string> TimeIndex = new GeneralIndexer<TimeSpan,string>();

{
            TimeIndex.GetEvent += new GeneralIndexer<TimeSpan, string>.gen_get(TimeIndex_GetEvent);
            TimeIndex.SetEvent += new GeneralIndexer<TimeSpan, string>.gen_set(TimeIndex_SetEvent);
            TimeIndex.KeyRequest += new GeneralIndexer<TimeSpan, string>.key_get(TimeIndex_KeyRequest);

} 
```

像冠军一样工作，特别是如果您想监视对列表的访问或在访问某些内容时执行任何特殊操作。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-04-14T17:15:54.103

在最近的升 C 中，您可以将返回类型声明为“动态”。这与使用“对象”相同，只是 C# 运行时允许您在代码中使用它，就好像它是您认为的类型一样，然后在运行时检查以确保您是正确的......

# algorithm - 如何确定一个链表是否有一个仅使用两个内存位置的循环

> ID：494830
> 
> 赞同：44
> 
> 时间：2009-01-30T07:51:59.223
> 
> 标签：algorithm, loops, linked-list, cycle

有谁知道一种算法来查找链表是否在自身上循环，只使用两个变量来遍历列表。假设您有一个对象的链接列表，那么什么类型的对象都没有关系。我在一个变量中有一个指向链表头部的指针，我只得到另一个变量来遍历列表。

所以我的计划是比较指针值，看看是否有相同的指针。该列表的大小有限，但可能很大。我可以将两个变量都设置为头部，然后用另一个变量遍历列表，总是检查它是否等于另一个变量，但是，如果我确实遇到了一个循环，我将永远无法摆脱它。我认为这与遍历列表和比较指针值的不同速率有关。有什么想法吗？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-01-30T08:01:32.840

我建议使用`Floyd's Cycle-Finding Algorithm` *aka* The `Tortoise and the Hare Algorithm`. 它具有 O(n) 复杂性，我认为它符合您的要求。

示例代码：

```
function boolean hasLoop(Node startNode){
  Node slowNode = Node fastNode1 = Node fastNode2 = startNode;
  while (slowNode && fastNode1 = fastNode2.next() && fastNode2 = fastNode1.next()){
    if (slowNode == fastNode1 || slowNode == fastNode2) return true;
    slowNode = slowNode.next();
  }
  return false;
} 
```

有关 Wikipedia 的更多信息：[Floyd 的循环查找算法](http://en.wikipedia.org/wiki/Floyd%27s_cycle-finding_algorithm#Tortoise_and_hare)。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-01-30T07:55:17.440

您可以使用[海龟和兔子](http://eddii.wordpress.com/2006/11/15/detecting-infinite-loop/)算法。

维基百科也有解释，他们称之为“[弗洛伊德的循环寻找算法](http://en.wikipedia.org/wiki/Floyd%27s_cycle-finding_algorithm#Tortoise_and_hare)”或“龟兔赛跑”

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-01-30T07:55:59.280

绝对地。一种解决方案确实可以使用两个指针遍历列表，其中一个指针的移动速度是另一个指针的两倍。

从指向列表中任何位置的“慢”和“快”指针开始。运行遍历循环。如果“快”指针在任何时候都与慢指针重合，则您有一个循环链表。

```
int *head = list.GetHead();
if (head != null) {
    int *fastPtr = head;
    int *slowPtr = head;

    bool isCircular = true;

    do 
    {
        if (fastPtr->Next == null || fastPtr->Next->Next == null) //List end found
        {
            isCircular = false;
            break;
        }

        fastPtr = fastPtr->Next->Next;
        slowPtr = slowPtr->Next;
    } while (fastPtr != slowPtr);

    //Do whatever you want with the 'isCircular' flag here
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-05T17:52:17.520

我试图自己解决这个问题，并找到了一个不同的（效率较低但仍然是最佳的）解决方案。

这个想法是基于在线性时间内反转一个单链表。这可以通过在迭代列表的每个步骤中进行两次交换来完成。如果 q 是前一个元素（最初为 null）而 p 是当前元素，则 swap(q,p->next) swap(p,q) 将反转链接并同时推进两个指针。可以使用 XOR 来完成交换，以防止不得不使用第三个内存位置。

如果列表有一个循环，那么在迭代过程中的某一时刻，您将到达一个指针已更改的节点。你不知道是哪个节点，但是通过继续迭代，交换一些元素两次，你再次到达列表的头部。

通过两次反转列表，列表的结果保持不变，您可以根据您是否到达列表的原始头部来判断它是否有一个循环。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-05-09T20:21:18.940

```
int isListCircular(ListNode* head){
    if(head==NULL)
        return 0;
    ListNode *fast=head, *slow=head;
    while(fast && fast->next){
        if(fast->next->next==slow)
            return 1;
        fast=fast->next->next;
        slow=slow->next;
    }
    return 0;
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-09-03T14:59:34.923

```
boolean findCircular(Node *head)
{
    Node *slower, * faster;
    slower = head;
    faster = head->next;
    while(true) {
        if ( !faster || !faster->next)
            return false;
        else if (faster == slower || faster->next == slower)
            return true;
        else
            faster = faster->next->next;
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-01-11T20:15:06.650

将这个问题带到下一步将是识别循环（也就是说，不仅循环存在，而且它在列表中的确切位置）。Tortoise 和 Hare 算法可以用于相同的操作，但是，我们需要始终跟踪列表的头部。可以在[此处](http://neelanjanadutta.blogspot.com/2014/01/detect-and-identify-cycle-in-linked-list.html)找到该算法的说明。

# c# - 在 MyClass 中添加通用列表但如何？

> ID：494859
> 
> 赞同：0
> 
> 时间：2009-01-30T08:14:20.193
> 
> 标签：c#, .net, generics

如何在泛型类中添加列表？首先我的通用类是：

```
[可序列化]
    公共类 ScheduleSelectedItems
    {
        私人字符串频率；
        List FrequencyDays = new List();
        私有字符串时间；
        私人字符串开始时间；
        私有字符串结束时间；
        私人字符串开始日期；
        私人字符串结束日期；
        私有字符串名称；

        公共ScheduleSelectedItems（字符串频率，列表频率天，
                                     字符串时间，字符串开始时间，
                                     字符串结束时间，字符串开始日期，
                                     字符串结束日期，字符串名称）
        {
            频率=频率；
            频率天数 = 频率天数；
            时间=时间；
            开始时间 = 开始时间；
            结束时间 = 结束时间；
            开始日期 = 开始日期；
            结束日期 = 结束日期；
            姓名=姓名；
        }
    }

    [可序列化]
    公共类 ScheduleSelectedItemsList
    {
        公共列表项；

        公共 ScheduleSelectedItemsList()
        {
            项目 = 新列表（）；
        }
    }

我想将 ScheduleSelectedItems 添加到 form1.cs 中的 ScheduleSelectedItemsList
Form1.cs 代码在这里：

private void timer1_Tick(对象发送者，EventArgs e)
        {
            字符串 saat = DateTime.Now.ToShortTimeString();
            string bugun = DateTime.Today.ToShortDateString();
            ScheduleMng smgr = new ScheduleMng();
            ScheduleItemsList schlist = smgr.LoadXml();
            列表列表 = 新列表（）；

            for (int i = 0; i = Convert.ToDateTime(schlist.Items[i].StartDate.ToString())
                     && Convert.ToDateTime(bugun)
```

slist.Items.Add(list); ----> 我不使用这些代码。这些错误“包括一些无效的论点”你怎么能帮助我？:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-30T08:34:44.707

这就是你想要的，我认为：

```
List<ScheduleSelectedItems> list = new List<ScheduleSelectedItems>(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-03-15T09:27:15.503

泛型可以通过函数/类末尾的 a 来简化

```
List<T> //generic type 
```

`T`表示一个类型，即`int`（主要类型）或`MyClass`（类）

所以

```
List<MyClass> listOfMyClass = new List<MyClass>(); 
```

是一个`List`类型的项目`MyClass`

在您的情况下，您没有通用类，但我认为您可以通过以下方式使其通用：

```
public class ScheduleSelectedItems<T>
{
    private string frequency;
    List<T> itemsToSchedule = new List<T>();
    //(...)

    public ScheduleSelectedItems(string frequency,List<T> items, /*(...)*/)
    {
        this.frequency = frequency;
        this.itemsToSchedule = items;
        //(...)
    }
} 
```

然后调用它

```
ScheduleSelectedItems<FrequencyDays> myItems = new ScheduleSelectedItems<FrequencyDays>("frequency", new List<FrequencyDays>()) 
```

它使用 List 为您的班级创建一个新对象`FrequencyDays`

[这是一篇解释泛型基础知识的 MSDN 文章](https://msdn.microsoft.com/en-us/library/ms379564(v=vs.80).aspx)

# java - 非 Web 应用程序中的 Java 安全性

> ID：494860
> 
> 赞同：2
> 
> 时间：2009-01-30T08:15:12.517
> 
> 标签：java, database, security

有谁知道一个好的、开源的java安全框架？

我玩过一点 jSecurity，它看起来真的很酷，但是文档太少了，我似乎无法取得任何进展。

Spring security 似乎是面向 web 应用程序的——但我可能错了。

我不反对自己写这个，但似乎以前应该这样做，为什么要重新发明轮子？

所需要做的就是能够在应用程序的每个级别上提供细粒度的安全权限。

示例：App1 具有操作 1、2、3（如“canOpenRemoteFiles”或“canReprocessTransactions”） App2 具有操作 4、5、6、7

我最终需要做类似的事情：

```
// -- the call may not be this declarative
boolean foo = user.getApp1().canReprocessTransactions();
// do something with foo...

// -- or something like this
boolean bar = user.getApp2().canDoAction1();
// do something with bar...

// -- or...
ArrayList < String > dirsCanAccess = user.getApp1().getAccessableDirs(); 
```

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-30T08:47:47.957

上次我查看 Spring-Security 时，它似乎非常基于 Web。

但是...... Spring 的人非常好，我怀疑他们有很多可以从核心 Spring-Security 库中使用的构建块。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-30T08:54:53.933

您可以使用 Acegi Security 框架（基于 Spring）。该框架提供基于 AOP 的安全拦截，即使在 Web 应用程序之外，也可用于控制方法级别的访问。该框架的链接是 http://www.acegisecurity.org/

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-30T14:47:28.667

Why not use [JAAS](http://en.wikipedia.org/wiki/Java_Authentication_and_Authorization_Service)? It's been a standard part of the JRE since 1.4.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-22T22:22:00.437

经过更多的挖掘，jSecurity 是要走的路。它没有很好的文档记录，但使用起来非常简单。

# java - Java中的文件更改侦听器

> ID：494869
> 
> 赞同：110
> 
> 时间：2009-01-30T08:21:09.760
> 
> 标签：java, file, listener

我希望在文件系统中的文件发生更改时收到通知。我只发现了一个轮询 lastModified File 属性的线程，显然这个解决方案不是最佳的。

* * *

## 回答 #1

> 赞同：119
> 
> 时间：2009-01-30T09:28:46.330

之前写过一个日志文件监控器，发现每秒轮询几次单个文件的属性对系统性能的影响其实很小。

作为 NIO.2 的一部分，Java 7 添加了[WatchService API](http://download.oracle.com/javase/tutorial/essential/io/notification.html)

> WatchService API 专为需要通知文件更改事件的应用程序而设计。

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2009-01-30T15:43:16.870

我使用来自 Apache Commons 的 VFS API，下面是一个示例，说明如何在不影响性能的情况下监控文件：

[默认文件监视器](http://commons.apache.org/proper/commons-vfs/commons-vfs2/apidocs/org/apache/commons/vfs2/impl/DefaultFileMonitor.html)

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2009-01-30T09:18:38.723

有一个名为[jnotify](http://jnotify.sourceforge.net/)的库，它在 linux上包装了[inotify](http://en.wikipedia.org/wiki/Inotify)，并且还支持 windows。从未使用过它，我不知道它有多好，但我会说值得一试。

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2009-01-30T08:37:36.200

从 JDK 1.7 开始，通知应用程序文件更改的规范方法是使用[WatchService](https://docs.oracle.com/javase/9/docs/api/java/nio/file/WatchService.html) API。WatchService 是事件驱动的。[官方教程](https://docs.oracle.com/javase/tutorial/essential/io/notification.html)提供了一个例子：

```
/*
 * Copyright (c) 2008, 2010, Oracle and/or its affiliates. All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 *
 *   - Redistributions of source code must retain the above copyright
 *     notice, this list of conditions and the following disclaimer.
 *
 *   - Redistributions in binary form must reproduce the above copyright
 *     notice, this list of conditions and the following disclaimer in the
 *     documentation and/or other materials provided with the distribution.
 *
 *   - Neither the name of Oracle nor the names of its
 *     contributors may be used to endorse or promote products derived
 *     from this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
 * IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
 * THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
 * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR
 * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
 * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
 * PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
 * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
 * LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
 * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

import java.nio.file.*;
import static java.nio.file.StandardWatchEventKinds.*;
import static java.nio.file.LinkOption.*;
import java.nio.file.attribute.*;
import java.io.*;
import java.util.*;

/**
 * Example to watch a directory (or tree) for changes to files.
 */

public class WatchDir {

    private final WatchService watcher;
    private final Map<WatchKey,Path> keys;
    private final boolean recursive;
    private boolean trace = false;

    @SuppressWarnings("unchecked")
    static <T> WatchEvent<T> cast(WatchEvent<?> event) {
        return (WatchEvent<T>)event;
    }

    /**
     * Register the given directory with the WatchService
     */
    private void register(Path dir) throws IOException {
        WatchKey key = dir.register(watcher, ENTRY_CREATE, ENTRY_DELETE, ENTRY_MODIFY);
        if (trace) {
            Path prev = keys.get(key);
            if (prev == null) {
                System.out.format("register: %s\n", dir);
            } else {
                if (!dir.equals(prev)) {
                    System.out.format("update: %s -> %s\n", prev, dir);
                }
            }
        }
        keys.put(key, dir);
    }

    /**
     * Register the given directory, and all its sub-directories, with the
     * WatchService.
     */
    private void registerAll(final Path start) throws IOException {
        // register directory and sub-directories
        Files.walkFileTree(start, new SimpleFileVisitor<Path>() {
            @Override
            public FileVisitResult preVisitDirectory(Path dir, BasicFileAttributes attrs)
                throws IOException
            {
                register(dir);
                return FileVisitResult.CONTINUE;
            }
        });
    }

    /**
     * Creates a WatchService and registers the given directory
     */
    WatchDir(Path dir, boolean recursive) throws IOException {
        this.watcher = FileSystems.getDefault().newWatchService();
        this.keys = new HashMap<WatchKey,Path>();
        this.recursive = recursive;

        if (recursive) {
            System.out.format("Scanning %s ...\n", dir);
            registerAll(dir);
            System.out.println("Done.");
        } else {
            register(dir);
        }

        // enable trace after initial registration
        this.trace = true;
    }

    /**
     * Process all events for keys queued to the watcher
     */
    void processEvents() {
        for (;;) {

            // wait for key to be signalled
            WatchKey key;
            try {
                key = watcher.take();
            } catch (InterruptedException x) {
                return;
            }

            Path dir = keys.get(key);
            if (dir == null) {
                System.err.println("WatchKey not recognized!!");
                continue;
            }

            for (WatchEvent<?> event: key.pollEvents()) {
                WatchEvent.Kind kind = event.kind();

                // TBD - provide example of how OVERFLOW event is handled
                if (kind == OVERFLOW) {
                    continue;
                }

                // Context for directory entry event is the file name of entry
                WatchEvent<Path> ev = cast(event);
                Path name = ev.context();
                Path child = dir.resolve(name);

                // print out event
                System.out.format("%s: %s\n", event.kind().name(), child);

                // if directory is created, and watching recursively, then
                // register it and its sub-directories
                if (recursive && (kind == ENTRY_CREATE)) {
                    try {
                        if (Files.isDirectory(child, NOFOLLOW_LINKS)) {
                            registerAll(child);
                        }
                    } catch (IOException x) {
                        // ignore to keep sample readbale
                    }
                }
            }

            // reset key and remove from set if directory no longer accessible
            boolean valid = key.reset();
            if (!valid) {
                keys.remove(key);

                // all directories are inaccessible
                if (keys.isEmpty()) {
                    break;
                }
            }
        }
    }

    static void usage() {
        System.err.println("usage: java WatchDir [-r] dir");
        System.exit(-1);
    }

    public static void main(String[] args) throws IOException {
        // parse arguments
        if (args.length == 0 || args.length > 2)
            usage();
        boolean recursive = false;
        int dirArg = 0;
        if (args[0].equals("-r")) {
            if (args.length < 2)
                usage();
            recursive = true;
            dirArg++;
        }

        // register directory and process its events
        Path dir = Paths.get(args[dirArg]);
        new WatchDir(dir, recursive).processEvents();
    }
} 
```

对于单个文件，存在各种解决方案，例如：

*   [https://dzone.com/articles/listening-to-fileevents-with-java-nio](https://dzone.com/articles/listening-to-fileevents-with-java-nio)

请注意，Apache VFS 使用轮询算法，尽管它可能提供更强大的功能。另请注意，API 不提供确定文件是否已关闭的方法。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2013-03-17T19:05:17.230

Java commons-io 有一个[FileAlterationObserver](http://commons.apache.org/proper/commons-io//javadocs/api-release/org/apache/commons/io/monitor/FileAlterationObserver.html)。它结合 FileAlterationMonitor 进行轮询。类似于commons VFS。优点是它的依赖性要少得多。

编辑：较少的依赖是不正确的，它们对于 VFS 是可选的。但它使用 java File 而不是 VFS 抽象层。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-01-30T11:14:43.107

“更多 NIO 功能”具有文件监视功能，其实现取决于底层操作系统。应该在JDK7中。

更新：已添加到 Java SE 7。Chris Janicki 提供了[相关 Java 教程的链接](https://docs.oracle.com/javase/tutorial/essential/io/notification.html)。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2013-01-16T01:39:12.930

每次我去读取属性文件时，我都会运行这段代码，只有在我上次读取文件后它被修改过时才会真正读取文件。希望这可以帮助某人。

```
private long timeStamp;
private File file;

private boolean isFileUpdated( File file ) {
  this.file = file;
  this.timeStamp = file.lastModified();

  if( this.timeStamp != timeStamp ) {
    this.timeStamp = timeStamp;
    //Yes, file is updated
    return true;
  }
  //No, file is not updated
  return false;
} 
```

Log4J 中使用了类似的方法[`FileWatchdog`](http://grepcode.com/file/repo1.maven.org/maven2/log4j/log4j/1.2.17/org/apache/log4j/helpers/FileWatchdog.java#74)。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-30T08:59:30.290

如果您愿意花一些钱，JNIWrapper 是一个带有 Winpack 的有用库，您将能够获取某些文件的文件系统事件。不幸的是只有窗户。

请参阅[https://www.teamdev.com/jniwrapper](https://www.teamdev.com/jniwrapper)。

否则，诉诸本机代码并不总是一件坏事，尤其是当提供的最佳方案是针对本机事件的轮询机制时。

我注意到 Java 文件系统操作在某些计算机上可能会很慢，如果处理不当很容易影响应用程序的性能。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2013-07-30T13:17:56.357

您可以使用 FileReader 监听文件更改。请看下面的例子

```
// File content change listener 
private String fname;
private Object lck = new Object();
... 
public void run()
{
    try
    {
        BufferedReader br = new BufferedReader( new FileReader( fname ) );
        String s;
        StringBuilder buf = new StringBuilder();
        while( true )
        {
            s = br.readLine();
            if( s == null )
            {
                synchronized( lck )
                {
                    lck.wait( 500 );
                }
            }
            else
            {
               System.out.println( "s = " + s );
            }

        }
    }
    catch( Exception e )
    {
        e.printStackTrace();
    }
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-18T09:51:28.023

有一个名为 JxFileWatcher 的用于文件和文件夹监视的商业跨桌面库。可以从这里下载： [http ://www.teamdev.com/jxfilewatcher/](http://www.teamdev.com/jxfilewatcher/)

你也可以在网上看到它： [http ://www.teamdev.com/jxfilewatcher/onlinedemo/](http://www.teamdev.com/jxfilewatcher/onlinedemo/)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2010-02-08T22:34:16.673

您还可以考虑 Apache Commons JCI（Java 编译器接口）。尽管这个 API 似乎专注于类的动态编译，但它还在其 API 中包含了用于监视文件更改的类。

示例： [http ://commons.apache.org/jci/usage.html](http://commons.apache.org/jci/usage.html)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2012-05-10T15:29:49.330

Spring Integration 提供了一个很好的机制来查看目录和文件：[http](http://static.springsource.org/spring-integration/reference/htmlsingle/#files) ://static.springsource.org/spring-integration/reference/htmlsingle/#files 。很确定它是跨平台的（我在 mac、linux 和 windows 上使用过）。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2015-10-28T13:46:37.713

轮询最后修改的文件属性是一个简单而有效的解决方案。只需定义一个扩展我的类`FileChangedWatcher`并实现该`onModified()`方法：

```
import java.io.File;

public abstract class FileChangedWatcher
{
    private File file;

    public FileChangedWatcher(String filePath)
    {
        file = new File(filePath);
    }

    public void watch() throws InterruptedException
    {
        long currentModifiedDate = file.lastModified();

        while (true)
        {
            long newModifiedDate = file.lastModified();

            if (newModifiedDate != currentModifiedDate)
            {
                currentModifiedDate = newModifiedDate;
                onModified();
            }

            Thread.sleep(100);
        }
    }

    public String getFilePath()
    {
        return file.getAbsolutePath();
    }

    protected abstract void onModified();
} 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2016-01-06T22:34:12.370

与其他答案类似，这就是我如何使用 File、Timer 和 TimerTask 让它作为后台线程以设定的间隔轮询运行。

```
import java.io.File;
import java.util.Timer;
import java.util.TimerTask;

public class FileModifiedWatcher
{
  private static File file;
  private static int pollingInterval;
  private static Timer fileWatcher;
  private static long lastReadTimeStamp = 0L;

  public static boolean init(String _file, int _pollingInterval)
  {
    file =  new File(_file);
    pollingInterval = _pollingInterval; // In seconds

    watchFile();

    return true;
  }

  private static void watchFile()
  {
    if ( null == fileWatcher )
    {
      System.out.println("START");

      fileWatcher = new Timer();

      fileWatcher.scheduleAtFixedRate(new TimerTask()
      {
        @Override
        public void run()
        {

          if ( file.lastModified() > lastReadTimeStamp )
          {
            System.out.println("File Modified");
          }

          lastReadTimeStamp = System.currentTimeMillis();
        }
      }, 0, 1000 * pollingInterval);
    }

  }
} 
```

# shell - 用于复制文件和创建目录的 Unix Shell 脚本

> ID：494880
> 
> 赞同：2
> 
> 时间：2009-01-30T08:32:02.780
> 
> 标签：shell, scripting, directory, mirroring

我有一个源目录，例如**/my/source/directory/**和一个目标目录，例如**/my/dest/directory/**，我想用一些约束对其进行镜像。

*   我想将满足**find**命令某些条件的文件（例如**-ctime -2**（小于 2 天））复制到 dest 目录以进行镜像
*   我想包含一些前缀，以便我知道它来自哪里，例如 /source/directory
*   我想用绝对路径来做这一切，所以它不依赖于我从哪个目录运行
*   我想没有**cd**命令也是一个好习惯。
*   如果子目录不存在，我希望创建子目录

所以

```
/my/source/directory/1/foo.txt -> /my/dest/directory/source/directory/1/foo.txt
/my/source/directory/2/3/bar.txt -> /my/dest/directory/source/directory/2/3/bar.txt 
```

我已经将以下命令行组合在一起，但看起来有点难看，有人能做得更好吗？

```
find /my/source/directory -ctime -2 -type f -printf "%P\n" | xargs -IFILE rsync -avR /my/./source/directory/FILE /my/dest/directory/ 
```

如果您认为我应该自己添加此命令行作为答案，请发表评论，我不想贪婪地获得声誉。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-30T12:40:12.420

这与一个（封闭的）问题非常相似：[Bash scripting copying files without overwriting](https://stackoverflow.com/questions/363209/bash-scripting-copying-files-without-overwriting/363305#363305)。我给出的答案引用了`find | cpio`其他答案中提到的“”解决方案（减去时间标准，但这是“相似”和“相同”之间的区别），并且还概述了使用 GNU 'tar' 的解决方案。

### 时间

当我在 Solaris 上进行测试时，GNU tar 和 (Solaris) cpio 都无法保留 ctime 设置；实际上，我不确定是否有任何方法可以做到这一点。例如，该`touch`命令可以设置 atime 或 mtime 或两者，但不能设置 ctime。系统`utime()`调用也只取 mtime 或 atime 值；它不处理 ctime。所以，我相信如果你找到了一个保留 ctime 的解决方案，那么这个解决方案很可能是特定于平台的。（奇怪的例子：破解磁盘设备并编辑 inode 中的数据 - 不可移植，需要提升权限。）不过，重读这个问题，我发现“保留 ctime”不是要求的一部分（呸）；它只是文件是否被复制的标准。

### 目录

我认为 ' `cd`' 操作是必要的 - 但是它们可以完全本地化到脚本或命令行，如引用的问题和下面的命令行所示，其中第二个假设是 GNU tar。

```
(cd /my; find source/directory -ctime -2 | cpio -pvdm /my/dest/directory)

(cd /my; find source/directory -ctime -2 | tar -cf - -F - ) |
    (cd /my/dest/directory; tar -xf -) 
```

如果不使用`chdir()`(aka `cd`)，您需要专门的工具或选项来动态处理路径名的操作。

### 带有空格、换行符等的名称

正如 Adam Hawes 所指出的，特定于 GNU 的 ' `find -print0`' 和 ' `xargs -0`' 非常强大和有效。有趣的是，GNU`cpio`有一个选项来处理来自 ' `find -print0`' 的输出，那就是 ' `--null`' 或其缩写形式 ' `-0`'。因此，使用 GNU`find`和 GNU `cpio`，安全命令是：

```
(cd /my; find source/directory -ctime -2 -print0 |
    cpio -pvdm0 /my/dest/directory) 
```

*注意*：这不会覆盖备份目录下的预先存在的文件。`-u`为此添加`cpio`命令。

同样，GNU`tar`支持`--null`（显然没有`-0`短格式），也可以使用：

```
(cd /my; find source/directory -ctime -2 -print0 | tar -cf - -F - --null ) |
    (cd /my/dest/directory; tar -xf -) 
```

GNU 对带有空终止符的文件名的处理非常聪明并且是一项有价值的创新（尽管我最近才意识到它，感谢 SO；它在 GNU tar 中已经存在至少十年了）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-30T08:38:48.770

您可以使用复制传递模式 -p 尝试 cpio。我通常将它与覆盖所有（-u）、创建目录（-d）和维护修改时间（-m）一起使用。

```
find myfiles | cpio -pmud target-dir 
```

请记住， find 应该产生相对路径名，这不符合您的绝对路径标准。这种感冒当然可以用 cd 来“解决”，你也不喜欢（为什么不呢？）

```
(cd mypath; find myfiles | cpio ... ) 
```

括号将生成一个子shell，并将状态更改（即目录切换）保持在本地。您还可以定义一个小程序来抽象出“丑陋”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-30T09:13:25.083

如果您使用 find ，请始终使用 -print0 并通过 xargs -0 管道输出；几乎总是。如果您使用 find 的默认换行符终止符输出，则名称中带有空格的第一个文件将使脚本失效。

我同意所有其他海报 - 如果可以，请使用 cpio 或 tar。它会做你想做的事并省去麻烦。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-30T08:55:22.153

另一种方法是使用 tar, (cd $SOURCE; tar cf - .) | (cd $DESTINATION; 焦油 xf -)

**编辑：** 啊，我错过了关于保留 CTIME 的一点。我相信 tar 的大多数实现都会保留 mtime，但如果保留 ctime 很关键，那么 cpio 确实是唯一的方法。

此外，一些 tar 实现（GNU tar 就是其中之一）可以根据 atime 和 mtime 选择要包含的文件，尽管似乎不是 ctime。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-30T11:23:26.223

```
#!/bin/sh

SRC=/my/source/directory
DST=/my/dest/directory

for i in $(find $SRC -ctime -2 -type f) ; do
    SUBDST=$DST$(dirname $i)
    mkdir -p $SUBDST
    cp -p $i $SUBDST
done 
```

而且我想，既然你想包含“它来自哪里”，那么你将使用不同的源目录。只需将 SRC=/my/source/directory 替换为 SRC=$1 即可修改此脚本以将源目录作为参数

编辑：删除了多余的 if 语句。

当文件名有空格时不起作用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-06T07:29:41.447

# !/usr/bin/sh

# 复制具有相同目录结构的文件的脚本”

echo "请输入源 DIR 的完整路径（以 / 开头，以 / 结尾）：" 读取 spath

echo " 请输入目标位置的完整路径（以 / 开头并以 / 结尾）：" 读取 dpath

si=`echo "$spath" | awk -F/ '{print NF-1}'`

for fname in `find $spath -type f -print` do cdir= `echo $fname | awk -F/ '{ for (i='$si'; i<NF; i++) printf "%s/", $i; printf "\n"; }'` if [ $cdir ]; 那么如果 [ ！-d "$dpath$cdir" ]; 然后 mkdir -p $dpath$cdir fi fi

cp $fname $dpath$cdir

完毕

# python - 在 python 中重构这个字典到 xml 的转换器

> ID：494881
> 
> 赞同：3
> 
> 时间：2009-01-30T08:33:12.650
> 
> 标签：python, xml, dry

这是一件小事，真的：我有这个函数可以将 dict 对象转换为 xml。

这是功能：

```
def dictToXml(d):
    from xml.sax.saxutils import escape

    def unicodify(o):
        if o is None:
            return u'';
        return unicode(o)

    lines = []
    def addDict(node, offset):
        for name, value in node.iteritems():
            if isinstance(value, dict):
                lines.append(offset + u"<%s>" % name)
                addDict(value, offset + u" " * 4)
                lines.append(offset + u"</%s>" % name)
            elif isinstance(value, list):
                for item in value:
                    if isinstance(item, dict):
                        lines.append(offset + u"<%s>" % name)
                        addDict(item, offset + u" " * 4)
                        lines.append(offset + u"</%s>" % name)
                    else:
                        lines.append(offset + u"<%s>%s</%s>" % (name, escape(unicodify(item)), name))
            else:
                lines.append(offset + u"<%s>%s</%s>" % (name, escape(unicodify(value)), name))

    addDict(d, u"")
    lines.append(u"")
    return u"\n".join(lines) 
```

例如，它转换这个字典

```
{ 'site': { 'name': 'stackoverflow', 'blogger': [ 'Jeff', 'Joel' ] } } 
```

到：

```
<site>
    <name>stackoverflow</name>
    <blogger>jeff</blogger>
    <blogger>joel</blogger>
</site> 
```

它有效，但该`addDict`功能看起来有点过于重复。我确信有一种方法可以将它重构为 3 个名为和的协同递归函数`addDict`，但我的大脑卡住了。有什么帮助吗？`addList``addElse`

此外，任何摆脱`offset +`每一行中的东西的方法都会很好。

**注意**：我选择这些语义是因为我试图匹配[org.json中的](http://www.json.org/java/index.html)[json-to-xml 转换器](http://www.json.org/javadoc/org/json/XML.html#toString(java.lang.Object))的行为，我在项目的不同部分中使用了它。如果您只是为了寻找字典到 xml 转换器而进入此页面，那么在某些答案中有一些非常好的选择。（特别是[pyfo](http://foss.cpcc.edu/pyfo/)）。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-30T08:52:10.337

```
>>> from pyfo import pyfo
>>> d = ('site', { 'name': 'stackoverflow', 'blogger': [ 'Jeff', 'Joel' ] } )
>>> result = pyfo(d, pretty=True, prolog=True, encoding='ascii')
>>> print result.encode('ascii', 'xmlcharrefreplace')
<?xml version="1.0" encoding="ascii"?>
<site>
  <blogger>
    Jeff
    Joel
  </blogger>
  <name>stackoverflow</name>
</site> 
```

要安装[pyfo](http://foss.cpcc.edu/pyfo/)：

```
$ easy_install pyfo 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-30T08:48:38.360

我注意到您在添加项目方面有共同点。使用这种共性，我会重构将一个项目添加到一个单独的函数中。

```
def addItem(item, name, offset):
          if isinstance(item, dict):
                lines.append(offset + u"<%s>" % name)
                addDict(item, offset + u" " * 4)
                lines.append(offset + u"</%s>" % name)
          else:
                lines.append(offset + u"<%s>%s</%s>" % (name, escape(unicodify(item)), name))

def addList(value,name, offset):
        for item in value:
            addItem(item, name, offset)

def addDict(node, offset):
        for name, value in node.iteritems():
            if isinstance(value, list):
                addList(value, name, offset)
            else:
                addItem(value, name, offset) 
```

咨询警告：此代码未经实际使用 Python 的任何人测试或编写。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-30T09:13:22.070

摆脱重复的“偏移+”：

```
offset = 0
def addLine(str):
    lines.append(u" " * (offset * 4) + str 
```

然后

```
...
    addLine(u"<%s>" % name)
    offset = offset + 1
    addDict(value)
    offset = offset - 1
    addLine(u"</%s>" % name) 
```

这里没有口译员，所以请谨慎对待:(

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-30T13:40:01.987

您的原始代码会生成格式错误的 XML，并且可以为两个不同的字典生成相同的 XML（不是单*射*的，从数学上讲）。

例如，如果您有一个列表作为字典中唯一键的值：

```
 d = { 'list': [1,2,3] } 
```

我希望你的代码会产生

```
 <list>1</list><list>2</list><list>3</list> 
```

并且没有根元素。任何 XML 都应该只有一个根元素。

然后给定您的代码生成的 XML，不可能说这个 XML

```
 <tag>1</tag> 
```

从`{ 'tag': 1 }` 或 从生产`{ 'tag': [1] }`。

所以，我建议

*   总是从根元素开始
*   表示带有两个特殊标签（例如`<list/>`和`<item/>`）的列表或在属性中将它们标记为这样

然后，在对这些*概念上*的缺陷做出决定之后，我们可以生成正确且明确的 XML。我选择使用属性来标记列表，并使用 ElementTree 自动构建 XML 树。此外，递归有助于（`add_value_to_xml`递归调用）：

```
from xml.etree.ElementTree import Element, SubElement, tostring

def is_scalar(v):
    return isinstance(v,basestring) or isinstance(v,float) \
        or isinstance(v,int) or isinstance(v,bool)

def add_value_to_xml(root,v):
    if type(v) == type({}):
        for k,kv in v.iteritems():
            vx = SubElement(root,unicode(k))
            vx = add_value_to_xml(vx,kv)
    elif type(v) == list:
        root.set('type','list')
        for e in v:
            li = SubElement(root,root.tag)
            li = add_value_to_xml(li,e)
            li.set('type','item')
    elif is_scalar(v):
        root.text = unicode(v)
    else:
        raise Exception("add_value_to_xml: unsuppoted type (%s)"%type(v))
    return root

def dict_to_xml(d,root='dict'):
    x = Element(root)
    x = add_value_to_xml(x,d)
    return x

d = { 'float': 5194.177, 'str': 'eggs', 'int': 42,
        'list': [1,2], 'dict': { 'recursion': True } }
x = dict_to_xml(d)
print tostring(x) 
```

测试dict的转换结果为：

```
<dict><int>42</int><dict><recursion>True</recursion></dict><float>5194.177</float><list type="list"><list type="item">1</list><list type="item">2</list></list><str>eggs</str></dict> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-30T08:43:22.397

这是我的解决方案的简短草图：有一个`addSomething()`根据值的类型分派到`addDict()`或`addList()`的通用函数`addElse()`。这些函数再次递归调用`addSomething()`。

基本上，您正在分解`if`子句中的部分并添加递归调用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-30T12:02:40.153

以下是我在使用 XML 时发现的有用信息。实际上首先创建 XML 节点结构，然后将其渲染为文本。

这将两个不相关的问题分开。

1.  如何将我的 Python 结构转换为 XML 对象模型？

2.  如何格式化该 XML 对象模型？

当你把这两个东西放在一个函数中时，这很难。另一方面，如果你将它们分开，那么你有两件事。首先，您有一个相当简单的函数来“遍历”您的 Python 结构并返回一个 XML 节点。您的 XML 节点可以呈现为应用了一些首选编码和格式规则的文本。

```
from xml.sax.saxutils import escape

class Node( object ):
    def __init__( self, name, *children ):
        self.name= name
        self.children= children
    def toXml( self, indent ):
        if len(self.children) == 0:
            return u"%s<%s/>" % ( indent*4*u' ', self.name )
        elif len(self.children) == 1:
            child= self.children[0].toXml(0)
            return u"%s<%s>%s</%s>" % ( indent*4*u' ', self.name, child, self.name )
        else:
            items = [ u"%s<%s>" % ( indent*4*u' ', self.name ) ]
            items.extend( [ c.toXml(indent+1) for c in self.children ] )
            items.append( u"%s</%s>" % ( indent*4*u' ', self.name ) )
            return u"\n".join( items )

class Text( Node ):
    def __init__( self, value ):
        self.value= value
    def toXml( self, indent ):
        def unicodify(o):
            if o is None:
                return u'';
            return unicode(o)
        return "%s%s" % ( indent*4*u' ', escape( unicodify(self.value) ), )

def dictToXml(d):

    def dictToNodeList(node):
        nodes= []
        for name, value in node.iteritems():
            if isinstance(value, dict):
                n= Node( name, *dictToNodeList( value ) )
                nodes.append( n )
            elif isinstance(value, list):
                for item in value:
                    if isinstance(item, dict):
                        n= Node( name, *dictToNodeList( value ) )
                        nodes.append( n )
                    else:
                        n= Node( name, Text( item ) )
                        nodes.append( n )
            else:
                n= Node( name, Text( value ) )
                nodes.append( n )
        return nodes

    return u"\n".join( [ n.toXml(0) for n in dictToNodeList(d) ] ) 
```

# c# - 继承 Linq to SQL 类并转换 linq 查询的结果

> ID：494884
> 
> 赞同：3
> 
> 时间：2009-01-30T08:35:11.383
> 
> 标签：c#, linq, inheritance, casting, base

我正在编写一个应用程序，我们需要将一个基本实体扩展到许多不同的事物（例如员工、车辆等）。设计是这样的，有一个实体表和一个具有特定类型值的第二个表，例如，员工将有一个 ID 号，但车辆将有一个登记号。

我继承了数据上下文中生成的类实体，但在我的存储库中进行转换时遇到了问题。这样做的正确方法是什么？

```
public class cAccountEmployee : cAccountEntity
{
    public string id_number
    {
        get
        {
            try
            {
                return this.cAccountEntityValues.Single(e => e.type == 1).value;
            }
            catch (Exception)
            {
                return "";
            }
        }

        set
        {
            try
            {
                this.cAccountEntityValues.Single(e => e.type == 1).value = value;
            }
            catch (Exception)
            {
                this.cAccountEntityValues.Add(new cAccountEntityValue()
                                            {
                                                accountentity_id = this.id,
                                                cAccountEntity = this,
                                                type = 1,
                                                value = value
                                            });
            }
        }
    } 
```

}

然后在我的存储库中（不继承任何东西）

```
public IEnumerable<cAccountEmployee> All(int accountholder_id)
    {
        return db.cAccountEntities.Where(e => e.accountholder_id == accountholder_id).OrderBy(a => a.name).Cast<cAccountEmployee>();
    }

    public cAccountEmployee Single(int id)
    {
        return db.cAccountEntities.Single(a => a.id == id) as cAccountEmployee;
    } 
```

强制转换在单一方法中失败，因此我返回 null。我的理解是，您不能从基类定义显式或隐式运算符？如何将基类 Linq 结果转换为继承的 Employee 类，同时仍保持其数据库状态以便我可以提交更改？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-30T09:20:37.470

使用 LINQ-to-SQL，继承可以通过两种方式工作：

*   单个表的鉴别器（不适合，因为您的数据不是同质的）
*   基类/多表（不是说这在 dbml 中不受支持 - 仅当您手动编写类时）

LINQ-to-SQL 不支持多表继承（即具有来自多个表的数据的单个对象）。实体框架可以，但更复杂；您在 EF 中使用`.Cast<T>`and`.OfType<T>`来根据子类型进行转换/过滤。

你可能想看看：

*   [根据 ID 查询](https://stackoverflow.com/questions/156113/linqtosql-and-abstract-base-classes/156365#156365)（结合`GetTable<T>()`）
*   [在 dbml 中指定基类](https://stackoverflow.com/questions/411515/way-to-automatically-add-a-linqtosql-base-class-to-entities)

这里基类的目的是什么？如果它添加了行为，那么您可以编辑 dbml 为您的所有实体指定一个公共基类。如果它具有**数据属性**，那么它会变得更加棘手。

就个人而言，我根本不会这样做......我会为不同类型保留单独的类，并正确使用数据上下文，使用每种类型的单独表：

```
public IEnumerable<Employee> All(int accountholder_id)
{
    return db.Employees.Where(e => e.accountholder_id == accountholder_id)
        .OrderBy(a => a.name);
}

public Employee Single(int id)
{
    return db.Employees.Single(a => a.id == id);
} 
```

那么 - 你能澄清一下这里的`cAccountEntity`作用吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-30T10:34:41.470

感谢您的输入，将查看一些建议...

帐户实体背后的想法是，到目前为止，该站点只需要处理员工，但将来他们可能希望将车辆等添加到系统中，该系统用于将成本分配给实体，因此为此目的，员工是处理方式与车辆相同。

这个想法是员工和车辆需要他处理相同的内容以在数据库等中进行引用，但需要关于它们的稍微不同的信息。这是一个复杂的设计，只是因为他们想稍后添加额外的类型但不需要升级数据库......

但是，在我的代码中，我想谈论的是员工而不是通用实体类型（使控制器、视图等在 mvc 应用程序中更容易）。由于您无法提供从基类到派生类的用户定义转换，我已跳过继承它并改用以下解决方案。有点麻烦，但确实有效......让我知道是否有人能找到更好的方法。

```
public class cAccountEmployee
{
    private cAccountEntity entity;

    public int id
    {
        get
        {
            return this.entity.id;
        }
        set
        {
            this.entity.id = value;
        }
    }

    public string name
    {
        get
        {
            return this.entity.name;
        }
        set
        {
            this.entity.name = value;
        }
    }

    public int accountholder_id
    {
        get
        {
            return this.entity.accountholder_id;
        }
        set
        {
            this.entity.accountholder_id = value;
        }
    }

    public System.Data.Linq.EntitySet<cAccountEntityValue> cAccountEntityValues
    {
        get
        {
            return this.entity.cAccountEntityValues;
        }
    }

    public cAccountHolder cAccountHolder
    {
        get
        {
            return this.entity.cAccountHolder;
        }
    }

    public cAccountEmployee()
    {
        this.entity = new cAccountEntity();
    }

    public cAccountEmployee(cAccountEntity entity)
    {
        this.entity = entity;
    }

    public string id_number
    {
        get
        {
            try
            {
                return this.entity.cAccountEntityValues.Single(e => e.type == 1).value;
            }
            catch (Exception)
            {
                return "";
            }
        }

        set
        {
            try
            {
                this.entity.cAccountEntityValues.Single(e => e.type == 1).value = value;
            }
            catch (Exception)
            {
                this.entity.cAccountEntityValues.Add(new cAccountEntityValue()
                                            {
                                                accountentity_id = this.id,
                                                cAccountEntity = this.entity,
                                                type = 1,
                                                value = value
                                            });
            }
        }
    }
}

//In the repository
public cAccountEmployee Single(int id)
    {
        return new cAccountEmployee(db.cAccountEntities.Single(a => a.id == id));
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-30T20:39:02.110

> 如何将基类 Linq 结果转换为继承的 Employee 类

这不是悲观，是悲观。

我认为您不了解强制转换或可能-实例类型与引用类型。

```
public class Animal { }
public class Zebra : Animal { }

public class Zoo
{
    public void ShowZebraCast()
    {
        Animal a = new Animal();
        Zebra z = (Zebra)a;
    }
} 
```

System.InvalidCastException：无法将“动物”类型的对象转换为“斑马”类型。

同样，您有一个 Entity 实例，您不能对其使用 Employee 引用。

您可以转换类型，但必须提供转换方法。

```
public partial class Animal { }
public class Zebra : Animal { }
//in another file
public partial class Animal{
  public Zebra ToZebra(){
    return new Zebra() { //set Zebra properties here.
    };
  }
}

public class Zoo
{
    public void ShowZebraConvert()
    {
        Animal a = new Animal();
        Zebra z = a.ToZebra();
    }
} 
```

# iphone - 带有 Cocoa Touch 的 XML

> ID：494885
> 
> 赞同：3
> 
> 时间：2009-01-30T08:35:36.967
> 
> 标签：iphone, xml, cocoa-touch

我是Objective-C领域的新手。我想从 iPhone 上的 XML 页面检索数据。可能吗？如果我得到适当的建议或代码，对我会更有帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-30T08:56:24.960

SDK 附带[NSXMLParser](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSXMLParser_Class/Reference/Reference.html)类。有些人更喜欢使用[libxml2](http://xmlsoft.org/)库，因为它比 NSXMLDocument 更快且内存效率更高，但您可能希望使用 Objective C 层包装它，因为它是一个 C API。请参阅此[示例](http://cocoawithlove.com/2008/10/using-libxml2-for-parsing-and-xpath.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-30T17:46:37.683

cocoaFusion 有一个很好的插曲：前几天介绍了 XML 解析的来龙去脉。前往[cocoafusion.net](http://cocoafusion.net/files/category-episodes.html)并查找第 2 集：使用 Web API 和 XML 的介绍。

该剧集的节目说明部分有一些示例代码下载和指向包含更多信息的其他站点的链接（包括此处其他答案中提到的一些链接）。

干杯!

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-30T14:19:22.390

一篇很好的文章，介绍了如何使用 NSXMLParser 翻阅 xml。

[在 Cocoa 中解析 XML](http://weblog.bignerdranch.com/?p=48)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-31T01:39:41.707

查看 Apple 的 iPhone 开发者网站上的 SiesmicXML 教程。它在一个专用线程中使用 XMLParser 在后台进程中解析 XML。

JK

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-30T10:11:43.157

还有一些其他的库：TouchXML、KissXML。

# java - 在 JMX 中设置每个用户或每个组的安全性

> ID：494891
> 
> 赞同：2
> 
> 时间：2009-01-30T08:44:57.760
> 
> 标签：java, jmx

我们是我公司 JMX 的忠实拥护者。我们已经检测了几乎所有东西。

这对于开发人员和支持人员的核心来说非常有用。但它太成功了：我们现在收到其他人的请求以查看 JMX，我们不想让他们访问所有内容。

是否可以使用安全策略设置 JMX，以将用户或用户组限制为有限数量的 bean、属性和操作？

我们正在使用 HtmlAdaptorServer，但如果更合适，可以使用 JConsole 或 VisualVM。始终使用 Java 6。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-30T08:49:35.787

您可以从[http://blogs.oracle.com/lmalventosa/entry/jmx_authentication_authorization开始](http://blogs.oracle.com/lmalventosa/entry/jmx_authentication_authorization)

这是 JMX 安全性的一个很好的起点。针对 JMX 中的不同安全级别讨论了各种用例场景。

# .net - ASP.NET MVC RC 表单参数问题

> ID：494893
> 
> 赞同：1
> 
> 时间：2009-01-30T08:46:12.720
> 
> 标签：.net, asp.net-mvc

在 ASP.NET MVC Beta 中，我能够获取表单参数

```
<input id="addresses[40].City" name="addresses[40].City" type="text" value="City" />
<input id="addresses[40].Country" name="addresses[40].Country" type="text" value="Country" /> 
```

就像`Edit(List<Address> addresses)`在控制器动作中一样。

尽管如此，在新的候选版本中，我无法将值（null）作为参数检索。当我创建一个 FormCollection 参数时，我可以看到这些值，但是将所有键/值对解析为一个对象会很头疼。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-30T14:31:26.453

The scheme for list binding changed in the release candidate. Prior to the release candidate, you would have a hidden field which indicated what the index was (40, in your case). In the release candidate, you no longer need this hidden field, but your index **must be numeric and must start with 0.**

# .net - 在 WCF 中自动重新发送消息

> ID：494906
> 
> 赞同：0
> 
> 时间：2009-01-30T08:52:28.290
> 
> 标签：.net, wcf, web-services

我正在使用 WCF 与 Java Web 服务通信。此 Web 服务有一个称为 Authenticate 的方法，它返回一个会话 ID。对此 Web 服务的每个请求都必须在 SOAP 标头中包含此会话 ID。如果会话超时，调用任何方法都会导致返回 SoapException。我想：

*   拦截对 Web 服务的每个调用，
*   检查此特定异常的响应消息
*   如果找到，再次调用 Authenticate 以获取新的 Session ID，并使用更新的 Session ID 再次发送原始消息

我用谷歌搜索无济于事。我能找到的最接近的事情告诉我，我可能会在通道层完成此操作，但根本没有给出示例代码。

请注意，我想在代理类中执行此操作，而不是在调用代理类的代码中。这样代理类的调用者就不必担心自动重新认证。我从自动生成的代理继承并以编程方式进行 WCF 配置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-06T15:37:59.417

我会尝试为您的 WCF 客户端包装一个“getter”，以便在所有调用之前调用身份验证函数。

```
 public WCFClient GetServiceInstance()
    {
        client.DoAuth();
        return client;
    } 
```

您还可以向此方法添加一个条件，以仅每 1 分钟左右调用一次 DoAuth() 。

# c# - 数据表过滤器表达式中的字符串格式

> ID：494907
> 
> 赞同：1
> 
> 时间：2009-01-30T08:53:33.327
> 
> 标签：c#, .net

这是我的代码：

```
lExpression = @"convert(" + lNewColName + ",'System.Decimal')";
if (pCurrency.ToString() != "Select")
  lExpression += " * convert(" + pCurrency.ToString() + ",'System.Decimal')";
mDtCases.Columns[lColName].Expression = lExpression; 
```

其中 lNewColName 是 ColumnName，pCurrency 是货币组合框，mDtCases 是数据网格。当它运行时，它显示 213.2365。我希望它显示 213.24。

请帮我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-30T10:58:16.430

表达式的语法支持许多简单的函数，包括聚合，但不支持舍入。

但是，您可以通过使用所需的小数位数格式化显示的值。您没有说您使用的是什么 DataGrid，但对于 Web UI，您可以使用例如 BoundColumn.DataFormatString 属性进行格式化，而对于 WinForms UI，您可以使用 DataGridTextBoxColumn.Format 属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-30T09:33:08.567

```
System.Convert.ToDouble(IExpression) 
```

[http://msdn.microsoft.com/en-us/library/w2zyd0fa.aspx](http://msdn.microsoft.com/en-us/library/w2zyd0fa.aspx)

```
Math.Round( double, int ) 
```

[http://msdn.microsoft.com/fr-fr/library/zy06z30k.aspx](http://msdn.microsoft.com/fr-fr/library/zy06z30k.aspx)

# c++ - 在 Visual Studio 中，我可以在断点中绘制我的变量吗？

> ID：494911
> 
> 赞同：6
> 
> 时间：2009-01-30T08:56:10.373
> 
> 标签：c++, visual-studio, visual-studio-2008, debugging

在我的原生 C++ 程序的 Visual Studio 中，我想在调试期间获得一些变量的图。大多数情况下，我通过编辑 autoexp.dat 来使用对象的文本表示。但是对于某些变量，最好有一个图而不是文本形式的值。

到目前为止，我已经使用了一个函数，并从*即时窗口*`plot(const void* address,const char* type)`中调用它，给出变量地址和类型，并在内部将其转换为正确的类型。

 *但是这种方法有两个缺点：

*   首先是，从调试器调用函数时，函数重载几乎永远不会起作用（所以我必须将类型作为第二个参数传递），并且函数调用偶尔会崩溃，尽管从代码中调用它时它可以正常工作。
*   其次，我没有编写用于绘图的 C++ 函数，而是有兴趣拥有一种脚本语言（如 autoexp.dat 或 VBScript）来提供 C++ 对象的内部数据，*而无需编写*任何包装器，这样我就可以使用脚本将数据存储在文件中或绘制它。

一般来说，我有兴趣拥有*Matlab*或*Ch IDE*之类的东西，当程序处于调试中断时，我可以在其中从外部绘制某些变量。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-30T09:38:07.060

自 VS 2005 以来，Visual Studio 已经包含[Visualizers](http://msdn.microsoft.com/en-us/library/zayyhzts.aspx)，它几乎可以专为您的问题而设计。MSDN 比我更好地解释了这个概念：

> 可视化工具是 Visual Studio 调试器用户界面的新组件。可视化工具创建对话框或其他界面，以适合其数据类型的有意义的方式显示变量或对象。例如，HTML 可视化器解释 HTML 字符串并显示结果，就像它会出现在浏览器窗口中一样，位图可视化器解释位图结构并显示它所代表的图形，等等。一些可视化工具允许您编辑和查看数据。

有关如何编写的教程，请参见[此处。](http://msdn.microsoft.com/en-us/library/e2zc529c.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-08T19:37:19.057

[您可以使用NetDebugPlot](http://www.shazbits.com/netdebugplot)和[NetDebugLog](http://www.shazbits.com/netdebuglog)在实时图表中绘制变量。

```
#include "NetDebugLog.h"

NetLog(myvar);
NetLog("test", myvar2); 
```

![网络调试图](https://i.stack.imgur.com/YnBCv.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-06T00:46:45.037

正如其他人所指出的，我不确定您到底想绘制什么。我通常理解，当有人说他想“绘制一些东西”时，他通常指的是一些带有数值的数组。如果您的情况属实，英特尔的[Array Visualizer](https://software.intel.com/en-us/articles/intel-array-visualizer)可能会有所帮助。它可以免费下载，它集成到 Visual Studio 中，您可以通过两种方式使用它：作为独立应用程序或在调试时（“在某个断点中”），以便您可以在“程序运行时”绘制数组值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-30T09:23:41.677

你可以为此使用[gnuplot吗？](http://www.gnuplot.info/)吐出您想要绘制的数据作为调试打印，然后当您坐在断点处时，将其复制到外部文件并通过绘图仪运行它。

# c++ - 如何在 VC++ 中使用资源？

> ID：494916
> 
> 赞同：0
> 
> 时间：2009-01-30T09:06:36.547
> 
> 标签：c++, windows, character-encoding, visual-c++-2008

我正在使用 VC 9，我想为我的应用程序支持俄语。我什至创建了俄语资源字符串。但我的系统有俄语设置。如果不存在，则每个字符都显示垃圾（其代码页为 1251）。我还从俄罗斯资源文件中制作了 DLL。如果我从安装位置在应用程序中运行该 DLL，它工作正常。但是当我将计算机设置更改为英语并从应用程序运行该 DLL 时，对话框和消息框显示垃圾字符。但是应用程序不应该从 DLL 中读取，而不是从计算机语言设置中读取吗？在这里，我面临如何制作独立于语言的 DLL 的问题。有任何代码或设置吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-02T10:14:46.563

到目前为止，最简单的解决方案是坚持使用 Unicode。

Windows 内部是 Unicode。（几乎）每个 API 函数都存在两种变体，FooA 和 FooW。FooA 变体在调用 FooW 之前将 char 转换为 wchar_t。确切的转换由代码页定义。

现在，如果您使用 Unicode，就没有这种转换，也没有代码页。如果用户输入 ж (U+0436, 它被存储为 wchar_t(0x0436) 并且从不转换。如果您的资源包含 Unicode 中的 ж，它也不会被转换。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-09T09:38:47.623

如果您要显示的字符串无法在系统代码页中表示，则唯一的解决方案是 Unicode。

# internet-explorer-8 - IE8 初始化错误（序数 650 未在 iertutil.dll 中建立）

> ID：494918
> 
> 赞同：1
> 
> 时间：2009-01-30T09:09:55.947
> 
> 标签：internet-explorer-8

任何想法为什么从 IE7 升级到 IE8 RC1 后我可能会得到：“序号 650 无法位于动态链接库 iertutil.dll 中。” 错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-26T01:03:16.877

检查是否正确安装了 IE8。转到帮助，关于 IE 并检查版本。在我的情况下，下载了 IE8，出现安装的版本是 IE7。

还有一点：Windows 下载以下更新后总是出现错误消息：Microsoft.NET Framework 3.5 和 Microsoft.NET Framework 3.5 Family Update (KB951847)。如果您的系统下载了上述更新，请尝试系统还原。这对短期解决方案有好处。

请注意，Microsoft 为 IE8 提供免费和免费帮助热线，并且仅限 IE8。您可能想尝试一下。免费电话：1-866-876-4926（仅限美国和加拿大）

祝你好运，

维尼西奥

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-27T18:51:36.710

绝对无法忍受他们如何发布 IE8 ，在这种情况下我的解决方案只是降级到 IE7 并不是真正的解决方案，而是有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-27T00:45:56.233

伙计们，这意味着缺少IE8记录在网上查找

# python - Python中的文件和空间

> ID：494919
> 
> 赞同：-2
> 
> 时间：2009-01-30T09:10:03.623
> 
> 标签：python, file, parsing, spaces

我有一个像这样的文件：

```
<space>
<space>
line1
<space>
column 1    column 2    column 3   ...

.
.
.

<space>
<space> 
```

如何删除这个多余的空格？

我需要提取将打开的标题`line1`。另外，我需要提取`column 1`,`column 2`等`column 3`。

在最后一栏内容的末尾有'\n'。如何摆脱它？

帮我解决这个...

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-30T09:18:37.473

首先打开文件并读取所有行：

```
f = open('filename string');
lines = f.readlines() 
```

然后...

```
# remove empty lines
lines = [l for l in lines if len(l.strip()) > 0]
header = lines[0]
line = lines[1].split(' ')
column1 = line[0]
column2 = line[1]
... 
```

还：

```
total_lines = len(lines)
total_columns = len(line) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-30T09:43:12.963

一个简单的解决方案，[`strip()`](http://docs.python.org/library/stdtypes.html#str.strip)用于删除空格和[`split()`](http://docs.python.org/library/stdtypes.html#str.split)分隔列数据：

```
>>> mylines
[' \n', ' \n', 'line1\n', ' \n', ' \n', 'column1    column2    column3 \n']
>>> def parser(lines):
...     header=""
...     data=[]
...     for x in lines:
...         line = x.strip()
...         if line == "":
...             continue
...         if header == "":
...             header=line
...         else:
...             data.append(line.split())
...     return {"header":header,"data":data}
... 
>>> parser(mylines)
{'header': 'line1', 'data': [['column1', 'column2', 'column3']]}
>>> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-30T11:17:36.860

使用生成器函数处理解析的每个元素

```
def nonEmptyLines( aFile ):
    """Discard empty lines, yield only non-empty lines."""
    for line in aFile:
        if len(line) > 0:
            yield line

def splitFields( aFile ):
    """Split a non-empty line into fields."""
    for line in nonEmptyLines(aFile):
        yield line.split()

def dictReader( aFile ):
    """Turn non-empty lines file with header and data into dictionaries.
    Like the ``csv`` module."""
    iter= iter( splitFields( aFile ) )
    heading= iter.next()
    for line in iter:
        yield dict( zip( heading, line ) )

rdr= dictReader( "myFile", "r" )
for d in rdr:
    print d 
```

# c# - C#中超出基本类型的数字

> ID：494923
> 
> 赞同：4
> 
> 时间：2009-01-30T09:13:13.383
> 
> 标签：c#, .net, math, types

我正在解决[Project Euler](http://projecteuler.net/)中的问题。解决的大部分问题

1.  超过乌龙的大数，

> ```
> Ex : ulong number = 81237146123746237846293567465365862854736263874623654728568263582; 
> ```

2.  非常敏感的十进制数，有效数字超过 30

> 例如：十进制十进制 = 0,3242342543573894756936576474978265726385428569234753964340653；

3.  必须具有超过最大 int 值的索引值的数组。

> 例如：bool[] items = new bool[213192471235494658346583465340673475263842864836]；

我找到了一个名为 IntX 的库来解决这个大数字。但我想知道如何用基本的 .NET 类型解决这个问题？

感谢您的回复！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-30T09:16:14.827

好吧，对于第三个项目，您真的不想使用数组，因为它也需要分配那么大。

让我重新表述一下。

等到你能负担得起并获得这么多内存的时候，大数字问题就会得到解决！

要在那里回答您的最后一个问题，您无法仅使用基本类型来解决此问题，除非您按照 IntX 的制造商所做的那样，实现大数字支持。

我可以建议您为欧拉问题尝试不同的编程语言吗？我对 Python 的运气更好，因为它支持开箱即用的大数字并集成到其他所有东西中。好吧，除了那个数组，这些天你真的不能用任何语言做到这一点。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-30T09:18:37.803

也许这可以为您提供有关如何解决部分问题的想法： [http://www.codeproject.com/csharp/BigInteger.asp](http://www.codeproject.com/csharp/BigInteger.asp)

维基百科也有一篇关于[任意精度数学](http://en.wikipedia.org/wiki/Arbitrary-precision_arithmetic)的好文章，在那篇文章中有一个指向 Codeplex 和[W3b.sine](http://www.codeplex.com/sine)的链接，它是一个任意精度的实数 c# 库。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-30T10:16:29.620

好吧，我建议你看看这个[其他答案](https://stackoverflow.com/questions/377361/sum-of-the-digits-of-the-number-21000/377532#377532)，看看我是如何解决大数字问题的。基本上，您需要以另一种方式表示数字...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-01T15:37:02.240

> 解决的大部分问题
> 
> 1.  超过乌龙的大数，
> 2.  非常敏感的十进制数，有效数字超过 30
> 3.  必须具有超过最大 int 值的索引值的数组。

大多数问题都设计为适合 64 位长度。有一两个需要更大的整数，但并不多。没有我见过需要超过 30 位的十进制数字，并且没有一个需要大于几千个条目的数组。

请记住，问题的正确解决方案最多应在几秒钟内运行，并且填充 213192471235494658346583465340673475263842864836 位的数组将需要 10^30 年。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-30T12:12:20.370

另一个选项可能是使用 F# 中可用的 BigInt 类型：http: [//cs.hubfs.net/forums/thread/887.aspx](http://cs.hubfs.net/forums/thread/887.aspx)

# vba - 右键单击 Excel 中禁用的工作表选项卡

> ID：494926
> 
> 赞同：1
> 
> 时间：2009-01-30T09:14:55.983
> 
> 标签：vba, excel, right-click

我在 ThisWorkbook 模块中使用了这个 vba 代码来禁用 Excel 工作簿中的右键菜单。

```
Private Sub Workbook_Activate()
   With Application.CommandBars.FindControl(ID:=847)
      .Visible = False
   End With
End Sub

Private Sub Workbook_Deactivate()
   With Application.CommandBars.FindControl(ID:=847)
      .Visible = True
   End With
End Sub 
```

奇迹般有效。
问题是，我现在无法访问任何工作簿中选项卡上的右键菜单。我假设，代码的第二部分应该重新打开它？然而事实并非如此。

即使我完全删除了代码，当我在其中一个选项卡上单击鼠标右键时，没有任何工作簿，甚至是新工作簿都没有菜单。

是否有一个“重置”擅长的一般 vba 代码片段？还是一般的“启用所有菜单”？

**修订：此处发布的此代码不会禁用右键菜单，它会从该特定菜单中删除“删除”选项。**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-30T12:05:36.997

我的天啊

```
Application.CommandBars("Ply").Enabled = True 
```

-.-
在最后一次编辑和 BAM 之后开始搜索不同的关键字。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-20T14:57:54.223

像往常一样再次迟到，但今天解决了同样的问题。这是恢复右键单击功能的解决方案：

```
Option Explicit
'
Sub tester()
    '
    Dim cBar As CommandBar
    '
    For Each cBar In CommandBars
        Debug.Print cBar.Name
        If (cBar.Type = msoBarTypePopup) Then cBar.Enabled = True
    Next
End Sub 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-15T21:35:25.457

另请注意，以下内容也存在。工作中的一些宏在我的 Excel 中全部禁用。

```
Application.CommandBars("Cell").Enabled = True
Application.CommandBars("Row").Enabled = True
Application.CommandBars("Column").Enabled = True 
```

# .net - 什么时候需要用于 MSBuild 的 Windows SDK？

> ID：494928
> 
> 赞同：5
> 
> 时间：2009-01-30T09:15:33.533
> 
> 标签：.net, .net-3.5, msbuild, continuous-integration, winapi

我正在为 .NET 3.5 项目设置我的第一个构建服务器，并在成功构建一个简单的测试应用程序后在 MSBuild 日志中发现了这条有趣的行：

> 找不到 Microsoft Windows SDK 的预期版本。查找在注册表项“HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Microsoft SDKs\Windows\v6.0A”的“InstallationFolder”值中指定的位置。如果您的构建过程不需要 SDK，则可以忽略这一点。

您的构建过程究竟何时需要 SDK？如果没有必要，我不想将它安装在构建服务器上，但我也不想通过构建神秘中断来发现我需要它。

目前，我只在服务器上安装了 .NET Framework 3.5 SP1。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-30T09:32:32.923

SDK 有几个附加工具，**有时**使用，具体取决于您的项目的内容 - 例如 (IIRC) 报告编译器。但对于大多数事情，不：您不需要 SDK。我安装在我的构建服务器上只是为了获得干净的输出；-p

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-30T09:23:15.873

如果您需要编译 C 或 C++ 代码 - 据我所知。

# code-analysis - 有没有人为 FxCop/StyleCop 制定了任何很酷的规则？

> ID：494932
> 
> 赞同：9
> 
> 时间：2009-01-30T09:16:05.747
> 
> 标签：code-analysis, fxcop, rules, stylecop

我只是在寻找一些灵感。尤其是在性能和​​安全性方面，命名约定很重要，但并不“酷”；）

即使您的规则仅适用于您的域/项目，但展示了规则的强大功能，请告诉我。

我使用 C#，但我对任何语言的规则都感兴趣。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-30T09:50:47.003

根据我的经验，开始为 FxCop 创建自定义规则集的开发人员通常会在拔掉很多头发后放弃。这似乎是一个好主意，但痛苦是不值得的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-10-19T12:36:08.710

编写 FxCop 自定义规则的混乱的替代方法是使用商业工具 NDepend。使用此工具，可以**在 LINQ 查询** [（即 CQLinq）](http://www.ndepend.com/Features.aspx#CQL)上编写代码规则。*免责声明：我是该工具的开发人员之一*

默认提出超过[200 条代码规则，包括](http://www.ndepend.com/DefaultRules/webframe.html)*命名约定*、*设计*、*架构*、*代码质量*、*代码演化*、*死代码*、*.NET Fx 使用*...

CQLinq 致力于编写可以[在 Visual Studio 中实时验证的](http://www.ndepend.com/Doc_VS_CQL.aspx)代码规则，或者可以[在构建过程中验证并在 HTML/javascript 报告中报告的](http://www.ndepend.com/Doc_CI_Report.aspx#CQLRule)代码规则。

CQLinq 优于 FxCop API 或其他工具的优势在于，**它可以直接编写代码规则**，并*立即*获得结果。建议使用设施来浏览匹配的代码元素。具体来说是这样的：

![CQLinq 代码规则](https://i.stack.imgur.com/OHPhy.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-21T18:32:29.040

到目前为止，我在 fxcop 目录下的 breusable.codeplex.com 上有一个很好的功能基础，有 2[条](http://breusable.codeplex.com)规则

ConfigKeyExistsInConfig（确保对 ConfigurationManager 的任何引用都存在于配置文件中。

NoUnunderscoresInProperties

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using Microsoft.FxCop.Sdk;

namespace RulesByImaginaryDevelopment
{
  public class NoUnderscoresInProperties : BaseRule
  {
    public NoUnderscoresInProperties() : base("NoUnderscoresInProperties") { }

    public override ProblemCollection Check(Member member)
    {
        var prop = member as PropertyNode;
        if(prop==null)
            return Problems;
        if(prop.Name.Name.Contains("_"))
        {
            Problems.Add(new Problem(new Resolution("Remove any '_' from name "+prop.Name.Name)));
        }
        return Problems;
    }
  }
} 
```

还有[http://msdn.microsoft.com/en-us/magazine/cc163930.aspx](http://msdn.microsoft.com/en-us/magazine/cc163930.aspx)

# silverlight - 我可以在 ActiveX 控件中使用 Silverlight 吗？

> ID：494949
> 
> 赞同：3
> 
> 时间：2009-01-30T09:25:21.593
> 
> 标签：silverlight, activex

我想创建一个使用 Silverlight 的 ActiveX 控件。这是可能的/明智的，有没有人有这方面的示例代码？

我在无法直接使用 WPF/Silverlight 控件的旧版（非 Web）系统中工作。但系统可以访问 ActiveX 控件。我们的想法是我们可以在 ActiveX 控件中托管 Silverlight，从而更新我们相当过时的 UI。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-02T15:06:32.810

阅读这篇文章。 [Silverlight COM 参考。](http://msdn.microsoft.com/en-us/library/cc296246(VS.95).aspx)

文章指出'agcore.dll'中的activeX控件在windows上它实际上是通过'npctrl.dll'导入的。

你编译的可能有某种activex控件向导。

**编辑：**话虽如此。在 activeX 控件中托管 IWebBrowser 并通过“xaml”将 silvelight 从本地存储嵌入到浏览器控件中可能同样容易。

# c# - GTK# 常见陷阱

> ID：494951
> 
> 赞同：2
> 
> 时间：2009-01-30T09:26:20.330
> 
> 标签：c#, mono, gtk#

我真的在考虑将我的下一个项目作为 C#/Mono/ [Gtk#](http://en.wikipedia.org/wiki/Gtk_Sharp)组合开始。

过去我从来没有接触过 GTK，因为用 GTK 构建的所有东西看起来都很糟糕，在视觉表现方面我有点强迫症。然而，大量的应用程序（想想[Banshee](http://banshee-project.org/ "女妖项目")，VMWare 控制台）已经清楚地证明了我的偏见观点是错误的，并重新塑造了我对 GTK 的不美观的看法。

我来自 Win32 API，[CreateWindowEx][2s] 有太多 hwnd，GTK# 提供了一个非常好的 API，但是如果我需要更深入地挖掘（扩展控制行为等）怎么办？它对我有用还是对我有用？

我从来没有使用过 Mono 或 GTK，所以“嘿，它在 Linux 和 Mac OS 上运行”的论点就像胶水一样粘在我的头骨上，我希望人们能对我（很可能）过于简化的观点有所了解。

启动时我应该厌倦什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-30T09:50:39.033

既然您提到 Banshee 是一个激发您灵感的项目，而且它是用 C# 编写的，也许从浏览它的源代码开始吧？这将为您提供一种直接的方式来查看 UI 代码的外观，在具有适合您口味的外观和感觉以及“UI 复杂性级别”的应用程序中，使用您已经知道的语言。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-30T10:08:01.190

我遇到的最大问题是缺少良好的画布控件，如果你真的想创建漂亮的 UI，你可能需要它。例如，Banshee 有一大堆由 Aaron Bockover 使用 Cairo 从头开始​​编写的自定义控件。与此解决方案一样灵活，它需要对 Gtk、Cairo 和其他所有相关内容有非常深入的了解。但是，不要把我的意见当作气馁。Gtk+ 和扩展的 Gtk# 是一个了不起的环境，用它很容易快速创建非常具有视觉吸引力的 GUI。

# javascript - 如何本地化 jQuery UI Datepicker？

> ID：494958
> 
> 赞同：126
> 
> 时间：2009-01-30T09:29:30.010
> 
> 标签：javascript, jquery-ui, localization, calendar, jquery-ui-datepicker

我真的需要一个本地化的下拉日历。英文日历并不能在挪威网站上准确传达卓越；-)

我已经尝试过**[jQuery DatePicker](http://ui.jquery.com/demos/datepicker/#localization)**，他们的网站说它可以本地化，但这似乎不起作用。

我正在使用 ASPNET.MVC，我真的很想坚持使用一个 javascript 库。在这种情况下，jQuery。

ajax 工具包日历是可以接受的，只要它也能显示挪威人的名字。

**更新：太棒了！我看到我缺少语言文件，一个不那么小的细节:-)**

* * *

## 回答 #1

> 赞同：191
> 
> 时间：2011-03-02T16:51:28.723

对于那些仍然有问题的人，您必须从这里下载您想要的语言文件：

> [https://github.com/jquery/jquery-ui/tree/master/ui/i18n](https://github.com/jquery/jquery-ui/tree/master/ui/i18n)

然后将其包含在您的页面中，例如（意大利语）：

```
<script type="text/javascript" src="/scripts/jquery.ui.datepicker-it.js"></script> 
```

然后使用[zilverdistel 的代码](https://stackoverflow.com/a/2905411/377384)：D

* * *

## 回答 #2

> 赞同：80
> 
> 时间：2010-05-25T14:08:17.770

我想出了演示并通过以下方式实现它：

```
$.datepicker.setDefaults(
  $.extend(
    {'dateFormat':'dd-mm-yy'},
    $.datepicker.regional['nl']
  )
); 
```

我也需要为 dateformat 设置默认值...

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2015-06-19T12:06:26.047

该字符串`$.datepicker.regional['it']`不会翻译所有单词。

要翻译日期选择器，您必须指定一些变量：

```
$.datepicker.regional['it'] = {
    closeText: 'Chiudi', // set a close button text
    currentText: 'Oggi', // set today text
    monthNames: ['Gennaio','Febbraio','Marzo','Aprile','Maggio','Giugno',   'Luglio','Agosto','Settembre','Ottobre','Novembre','Dicembre'], // set month names
    monthNamesShort: ['Gen','Feb','Mar','Apr','Mag','Giu','Lug','Ago','Set','Ott','Nov','Dic'], // set short month names
    dayNames: ['Domenica','Luned&#236','Marted&#236','Mercoled&#236','Gioved&#236','Venerd&#236','Sabato'], // set days names
    dayNamesShort: ['Dom','Lun','Mar','Mer','Gio','Ven','Sab'], // set short day names
    dayNamesMin: ['Do','Lu','Ma','Me','Gio','Ve','Sa'], // set more short days names
    dateFormat: 'dd/mm/yy' // set format date
};

$.datepicker.setDefaults($.datepicker.regional['it']);

$(".datepicker").datepicker(); 
```

在这种情况下，您的日期选择器已正确翻译。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2016-03-10T03:06:03.450

```
 $.datepicker.setDefaults({
    closeText: "关闭",
    prevText: "&#x3C;上月",
    nextText: "下月&#x3E;",
    currentText: "今天",
    monthNames: [ "一月","二月","三月","四月","五月","六月",
    "七月","八月","九月","十月","十一月","十二月" ],
    monthNamesShort: [ "一月","二月","三月","四月","五月","六月",
    "七月","八月","九月","十月","十一月","十二月" ],
    dayNames: [ "星期日","星期一","星期二","星期三","星期四","星期五","星期六" ],
    dayNamesShort: [ "周日","周一","周二","周三","周四","周五","周六" ],
    dayNamesMin: [ "日","一","二","三","四","五","六" ],
    weekHeader: "周",
    dateFormat: "yy-mm-dd",
    firstDay: 1,
    isRTL: false,
    showMonthAfterYear: true,
    yearSuffix: "年"
  }); 
```

i18n 代码可以从[https://github.com/jquery/jquery-ui/tree/master/ui/i18n复制](https://github.com/jquery/jquery-ui/tree/master/ui/i18n)

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2014-12-28T09:29:53.820

**1.**您需要加载 jQuery UI i18n 文件：

```
<script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/i18n/jquery-ui-i18n.min.js">
</script> 
```

**2.**使用`$.datepicker.setDefaults`函数设置所有日期选择器的默认值。

**3.**如果你想在设置默认值之前覆盖设置，你可以使用这个：

```
var options = $.extend(
    {},                                  // empty object
    $.datepicker.regional["fr"],         // fr regional
    { dateFormat: "d MM, y" /*, ... */ } // your custom options
);
$.datepicker.setDefaults(options); 
```

由于工作方式，参数的顺序很重要[`jQuery.extend`](http://api.jquery.com/jquery.extend/)。两个不正确的例子：

```
/*
 * This overwrites the global variable itself instead of creating a
 * customized copy of french regional settings
 */
$.extend($.datepicker.regional["fr"], { dateFormat: "d MM, y"});

/*
 * The desired dateFormat is overwritten by french regional 
 * settings' date format
 */
$.extend({ dateFormat: "d MM, y"}, $.datepicker.regional["fr"]); 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2016-11-22T12:18:08.840

如果你在同一个项目中使用 jQuery UI 的 datepicker 和 moment.js，你应该使用 moment.js 的 locale 数据：

```
// Finnish. you need to include separate locale file for each locale: https://github.com/moment/moment/tree/develop/locale
moment.locale('fi'); 

// fetch locale data internal structure, so we can shove it inside jQuery UI
var momentLocaleData = moment.localeData(); 

$.datepicker.regional['user'] = {
    monthNames: momentLocaleData._months,
    monthNamesShort: momentLocaleData._monthsShort,
    dayNames: momentLocaleData._weekdays,
    dayNamesShort: momentLocaleData._weekdaysMin,
    dayNamesMin: momentLocaleData._weekdaysMin,
    firstDay: momentLocaleData._week.dow,
    dateFormat: 'yy-mm-dd' // "2016-11-22". date formatting tokens are not easily interchangeable between momentjs and jQuery UI (https://github.com/moment/moment/issues/890)
};

$.datepicker.setDefaults($.datepicker.regional['user']); 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2015-11-07T15:49:29.677

这是一个示例，您如何在没有额外库的情况下进行本地化。

```
jQuery(function($) {
  $('input.datetimepicker').datepicker({
    duration: '',
    changeMonth: false,
    changeYear: false,
    yearRange: '2010:2020',
    showTime: false,
    time24h: true
  });

  $.datepicker.regional['cs'] = {
    closeText: 'Zavřít',
    prevText: '&#x3c;Dříve',
    nextText: 'Později&#x3e;',
    currentText: 'Nyní',
    monthNames: ['leden', 'únor', 'březen', 'duben', 'květen', 'červen', 'červenec', 'srpen',
      'září', 'říjen', 'listopad', 'prosinec'
    ],
    monthNamesShort: ['led', 'úno', 'bře', 'dub', 'kvě', 'čer', 'čvc', 'srp', 'zář', 'říj', 'lis', 'pro'],
    dayNames: ['neděle', 'pondělí', 'úterý', 'středa', 'čtvrtek', 'pátek', 'sobota'],
    dayNamesShort: ['ne', 'po', 'út', 'st', 'čt', 'pá', 'so'],
    dayNamesMin: ['ne', 'po', 'út', 'st', 'čt', 'pá', 'so'],
    weekHeader: 'Týd',
    dateFormat: 'dd/mm/yy',
    firstDay: 1,
    isRTL: false,
    showMonthAfterYear: false,
    yearSuffix: ''
  };

  $.datepicker.setDefaults($.datepicker.regional['cs']);
});
```

```
<!DOCTYPE html>
<html>

<head>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
  <link data-require="jqueryui@*" data-semver="1.10.0" rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/jqueryui/1.10.0/css/smoothness/jquery-ui-1.10.0.custom.min.css" />
  <script data-require="jqueryui@*" data-semver="1.10.0" src="//cdnjs.cloudflare.com/ajax/libs/jqueryui/1.10.0/jquery-ui.js"></script>
  <script src="datepicker-cs.js"></script>
  <script type="text/javascript">
    $(document).ready(function() {
      console.log("test");
      $("#test").datepicker({
        dateFormat: "dd.m.yy",
        minDate: 0,
        showOtherMonths: true,
        firstDay: 1
      });
    });
  </script>
</head>

<body>
  <h1>Here is your datepicker</h1>
  <input id="test" type="text" />
</body>
</html>
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2016-10-09T17:04:46.700

以防万一有人仍然坚持这一点，尽管有其他答案，我解决了这个问题：

```
$.datepicker.setDefaults($.datepicker.regional['en-GB']); 
```

注意额外的“GB”。之后它工作得很好。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2017-12-05T04:41:23.337

此解决方案可能会有所帮助。

```
$(document).ready(function () {
  var userLang = navigator.language || navigator.userLanguage;

  var options = $.extend({},
    $.datepicker.regional["ja"], {
      dateFormat: "yy/mm/dd",
      changeMonth: true,
      changeYear: true,
      highlightWeek: true
    }
  );

  $("#japaneseCalendar").datepicker(options);
});
```

```
#ui-datepicker-div {
  font-size: 14px;
}
```

```
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" type="text/css"
          href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/themes/smoothness/jquery-ui.min.css">
    <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.11.1/i18n/jquery-ui-i18n.min.js"></script>
</head>
<body>
<h3>Japanese JQuery UI Datepicker</h3>
<input type="text" id="japaneseCalendar"/>

</body>
</html>
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2019-10-31T15:51:42.297

我通过添加属性解决了它**`data-date-language="it"`**：

```
$(document).ready(function() {
  $('#TxtDaDataDoc_Val').datepicker();
});
```

```
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
<link rel="stylesheet" href="/resources/demos/style.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>

<div class="form-group col-xs-2 col-sm-2 col-md-2">
    <div class="input-group input-append date form-group" 
        id="TxtDaDataDoc" data-date-language="it">
        <input type="text" class="form-control" name="date" 
               id="TxtDaDataDoc_Val" runat="server" />
        <span class="input-group-addon add-on">
            <span class="glyphicon glyphicon-calendar"></span>
        </span>
    </div>
</div>
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-07-03T07:36:27.503

```
<link rel="stylesheet" href="//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">

<script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script>
<script src=">/js/datepicker-fr.js"></script>
<script>
jQuery(function() {
jQuery( "#datepicker" ).datepicker({minDate: 0 , dateFormat: 'mm/dd/yy'});
});

</script>

<script type="text/javascript">
$(document).ready(function(){
$('#datepicker').datepicker($.datepicker.regional['fr']);
});
</script> 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-11-25T05:00:39.173

$.datepicker.regional["vi-VN"] = { closeText: "Đóng", prevText: "Trước", nextText: "Sau", currentText: "Hôm nay", monthNames: ["Tháng một", "Tháng hai ”、“Tháng ba”、“Tháng tư”、“Tháng năm”、“Tháng sáu”、“Tháng bảy”、“Tháng tám”、“Tháng chín”、“Tháng mười”、“Tháng mười một”、“Tháng mười hai"], monthNamesShort: ["Một", "Hai", "Ba", "Bốn", "Năm", "Sáu", "Bảy", "Tám", "Chín", "Mười", "Mười một", "Mười hai"], dayNames: ["Chủ nhật", "Thứ hai", "Thứ ba", "Thứ tư", "Thứ năm", "Thứ sáu", "Thứ bảy"], dayNamesShort: ["CN", "Hai", "Ba", "Tư", "Năm", "Sáu", "Bảy"], dayNamesMin: ["CN", "T2", "T3", "T4", "T5", "T6", "T7"], weekHeader : "Tuần", dateFormat: "dd/mm/yy", firstDay: 1, isRTL: false, showMonthAfterYear: false, yearSuffix: "" };dayNamesShort: ["CN", "Hai", "Ba", "Tư", "Năm", "Sáu", "Bảy"], dayNamesMin: ["CN", "T2", "T3", "T4" , "T5", "T6", "T7"], weekHeader: "Tuần", dateFormat: "dd/mm/yy", firstDay: 1, isRTL: false, showMonthAfterYear: false, yearSuffix: "" };dayNamesShort: ["CN", "Hai", "Ba", "Tư", "Năm", "Sáu", "Bảy"], dayNamesMin: ["CN", "T2", "T3", "T4" , "T5", "T6", "T7"], weekHeader: "Tuần", dateFormat: "dd/mm/yy", firstDay: 1, isRTL: false, showMonthAfterYear: false, yearSuffix: "" };weekHeader: "Tuần", dateFormat: "dd/mm/yy", firstDay: 1, isRTL: false, showMonthAfterYear: false, yearSuffix: "" };weekHeader: "Tuần", dateFormat: "dd/mm/yy", firstDay: 1, isRTL: false, showMonthAfterYear: false, yearSuffix: "" };

```
 $.datepicker.setDefaults($.datepicker.regional["vi-VN"]); 
```

# javascript - 速度和 JavaScript

> ID：494965
> 
> 赞同：0
> 
> 时间：2009-01-30T09:34:17.693
> 
> 标签：javascript, variables, velocity

我这里有点问题：

```
#foreach($image in $command.lessonLearned.images)

      Image: $image.fileName <input type="submit" onclick="submitForm();setImageToRemove($image.id);setAction('removeImage');" value="REMOVE"/><br/> 
#end 
```

onclick 事件中的 $image.id 不会被评估为速度变量。如何让它写出变量内容而不仅仅是变量名？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-30T09:55:10.583

尝试替换`$image.id`为`${image.id}`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-02T22:36:48.970

你确定 $image.id 有值吗？您应该输入的是 $image.ID 还是 $image.getID()？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-03T14:05:52.947

是的，实际上，你是对的，内森……我们发现问题是一个 o 型……多么典型。

无论如何，感谢您的回答（：

# sql - 限制 SQL JOIN

> ID：494974
> 
> 赞同：30
> 
> 时间：2009-01-30T09:40:35.760
> 
> 标签：sql, database, join, sql-limit

我试图限制以下 SQL 语句。

```
SELECT expense.*, transaction.* FROM expense
INNER JOIN transaction ON expense_id = transaction_expense_id 
```

我想做的是限制“父”行的数量。IE。如果我执行 LIMIT 1，我将只收到一项费用项目，但仍会获得与之相关的所有交易。

这将如何实现？

在这个阶段，如果我做 LIMIT 1，我得到一笔费用，并且只有一笔交易。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-01-30T09:46:10.400

所以假设我们可以排除用户表，它可以重写为：

```
select * from expense, transaction where expense_id = transaction_expense_id 
```

现在如果你想应用一个限制，你可以这样做：

```
select * from expense, transaction where expense_id = transaction_expense_id and 
  expense_id in (select expense_id from expense limit 1) 
```

那会做你想要的吗？显然，您需要谨慎对待您的费用 ID 将返回的顺序，因此您可能想要使用 ORDER BY 任何东西。

编辑：鉴于您在下面的评论中描述的 MySQL 限制，也许这会起作用：

```
select * from (select id from expense order by WHATEVER limit 1) as t1, transaction where expense_id=transaction_expense_id; 
```

本

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-30T09:47:36.527

您必须指定要获取的**费用项目。**最昂贵的？最新的？然后加入一个只返回的子查询：

```
SELECT
    expense.*, transaction.*, user.*
FROM
    (SELECT * FROM expense WHERE ...) AS expense
INNER JOIN
    transaction ON expense_id = transaction_expense_id 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-30T09:55:40.317

由于升级 SQL 服务器不是一种选择，我最终可能会执行两个查询。

```
expenses = SELECT * FROM expense ... LIMIT x
foreach expenses as expense
    expense.transactions = SELECT * FROM transacion WHERE transaction_expense_id = expense.expense_id 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-02-26T17:49:01.420

即使这是旧的......在搜索中遇到这个并认为我会添加一些想法，因为无法在子查询中使用限制......

```
select e.expense_id, transaction.* 
from (select max(expense_id) from expense) e 
    inner join transaction t ON e.expense_id = t.transaction_expense_id 
```

或者如果你想拥有所有列，`expense`而不仅仅是`expense_id`你可以嵌套子查询。

```
select e.*, t.*
from (
     select e1.*
     from expense e1 inner join (select max(expense_id) from expense) e2
        on e1.expense_id = e2.expense_id
     ) e  inner join transaction t on e.expense_id = t.transaction_expense_id 
```

# iphone - UINavigationBar tintColor 带渐变

> ID：494982
> 
> 赞同：10
> 
> 时间：2009-01-30T09:45:19.167
> 
> 标签：iphone, cocoa-touch, interface-builder

我想以编程方式更改`tintColor`UINavigationBar 的，并保持界面生成器中的渐变。

当我`tintColor`在我的代码中更改时，渐变会消失，但是当我`tintColor`在 Interface Builder 中更改时，渐变会被保留。

有任何想法吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-02-26T21:45:44.640

所以这是一个老问题，但是当我在寻找听起来像这个问题但不同的东西时，我偶然发现了它。希望它可以帮助其他人（或者其他人会告诉我更好的方法）......

**如何在 UINavigationBar 上实现自定义渐变？**

首先，让我们以通常的方式获取我们的自定义渐变（作为 CALayer）：

```
- (CALayer *)gradientBGLayerForBounds:(CGRect)bounds
{
    CAGradientLayer * gradientBG = [CAGradientLayer layer];
    gradientBG.frame = bounds;
    gradientBG.colors = @[ (id)[[UIColor redColor] CGColor], (id)[[UIColor purpleColor] CGColor] ];
    return gradientBG;
} 
```

我们开始了，一个看起来像是朋克摇滚乐的可疑化妆选择的渐变，这很好，因为此代码用于假设的应用程序*I Have A Punk-Rocker With Questionable Tastes In My Pocket*。我这个名字有点太长了..

现在我想要我的 UINavigationBar 上的这个层，这应该很容易吧？只需将其添加为子图层，对吗？这里的问题是它会掩盖 UINavigationController 给你的美妙的按钮和东西。那很糟。

相反，让我们看一下我们在 iOS5+ 中用于更改应用程序中所有 UINavigationBar(s) 外观的绝妙便捷方法：

```
[[UINavigationBar appearance] setBackgroundImage:SOME_IMAGE
                                   forBarMetrics:UIBarMetricsDefault]; 
```

这里唯一的问题是我们没有 UIImage，我们有一个 CALayer。朋克摇滚爱好者应该做什么？

```
CALayer * bgGradientLayer = [self gradientBGLayerForBounds:ONE_OF_YOUR_NAV_CONTROLLERS.navigationBar.bounds];
UIGraphicsBeginImageContext(bgGradientLayer.bounds.size);
[bgGradientLayer renderInContext:UIGraphicsGetCurrentContext()];
UIImage * bgAsImage = UIGraphicsGetImageFromCurrentImageContext();
UIGraphicsEndImageContext(); 
```

所以现在我们已经将我们的 CALayer 转换为 UIImage（希望如此），所以剩下的就是设置它：

```
if (bgAsImage != nil)
{
    [[UINavigationBar appearance] setBackgroundImage:bgAsImage
                                       forBarMetrics:UIBarMetricsDefault];
}
else
{
    NSLog(@"Failded to create gradient bg image, user will see standard tint color gradient.");
} 
```

我喜欢这个解决方案的地方是

*   我的应用程序中所有 UINavigationBar(s) 的集中式代码（在 AppDelegate 中）
*   所有 UINavigation 按钮（后退、编辑等）仍将使用 tintColor
*   如果 UIImage 创建失败，我的 UINavigationBar(s) 仍将遵循 tintColor
*   我不必依赖实际的图像资源/易于更新

但我仍然不相信这是最好的方法。所以，如果它对你有帮助，请尽情享受，如果可以的话，让我知道如何改进它。

~ 谢谢

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-02-08T00:32:36.030

将 barStyle 设置为 UIBarStyleBlackTranslucent 像这样设置 tintColor：

```
navigationBar.tintColor = [UIColor colorWithRed:.7 green:.5 blue:.2 alpha:1]; 
```

这将设置适当的渐变。使用您需要的任何组合。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-09-21T13:08:15.240

我只是把它写成 Swift 2.0 的 UIImage 扩展。也许它有点用处。

```
extension UIImage {

    class func convertGradientToImage(colors: [UIColor], frame: CGRect) -> UIImage {

        // start with a CAGradientLayer
        let gradientLayer = CAGradientLayer()
        gradientLayer.frame = frame

        // add colors as CGCologRef to a new array and calculate the distances
        var colorsRef : [CGColorRef] = []
        var locations : [NSNumber] = []

        for i in 0 ... colors.count-1 {
            colorsRef.append(colors[i].CGColor as CGColorRef)
            locations.append(Float(i)/Float(colors.count))
        }

        gradientLayer.colors = colorsRef
        gradientLayer.locations = locations

        // now build a UIImage from the gradient
        UIGraphicsBeginImageContext(gradientLayer.bounds.size)
        gradientLayer.renderInContext(UIGraphicsGetCurrentContext()!)
        let gradientImage = UIGraphicsGetImageFromCurrentImageContext()
        UIGraphicsEndImageContext()

        // return the gradient image
        return gradientImage
    }
} 
```

像这样称呼它：

```
let colors = [
    UIColor.blueColor(),
    UIColor.greenColor()
    // and many more if you wish
]
let gradientImage = UIImage.convertGradientToImage(colors, frame: navigationBar.bounds)
navigationBar.setBackgroundImage(gradientImage, forBarMetrics: .Default) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-03T12:46:22.700

```
navigation.tintColor = [UIColor colorWithRed:0.47f green:0.23f blue:0.61f alpha:1.0f]; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-03-21T07:14:45.790

使用 maskView 的好方法

```
// create gradient view
let gradientView: UIView = UIView(frame: frame)
let gradient: CAGradientLayer = CAGradientLayer()
gradient.frame = gradientView.bounds
gradient.colors = [UIColor.grayColor().CGColor, UIColor.clearColor().CGColor]
gradientView.layer.insertSublayer(gradient, atIndex: 0)

//set appearance 
UINavigationBar.appearance().maskView = gradientView 
```

# tomcat - 邮件/会话资源工厂在 Struts 应用程序中不起作用

> ID：494985
> 
> 赞同：4
> 
> 时间：2009-01-30T09:46:22.287
> 
> 标签：tomcat, email, jndi

我想使用 Tomcat 6.0 提供的标准资源工厂，它为我创建 javax.mail.Sessions 实例。如[JNDI 资源 HOW-TO 教程](http://tomcat.apache.org/tomcat-6.0-doc/jndi-resources-howto.html)中所述。

我的 META-INF/context.xml 看起来像：

```
<?xml version="1.0" encoding="UTF-8"?>
<Context reloadable="true">
    <Resource name="mail/Session" 
          auth="Container" 
          type="javax.mail.Session" 
          mail.smtp.host="smtp.gmail.com"
          mail.smtp.port="587"
          mail.smtp.auth="true"
          mail.smtp.user="someone@gmail.com"
          mail.smtp.password="secretpassword" 
          mail.smtp.starttls.enable="true"/>    
</Context> 
```

我的 WEB-INF/web.xml 中有下一个资源引用，就在 </webapps> 之前。Web.xml 验证。我使用[McDowell 的方式](https://stackoverflow.com/questions/15732/whats-the-best-way-to-validate-an-xml-file-against-an-xsd-file/16054#16055)进行了验证。

```
<resource-ref>
    <description>Resource reference to a factory for javax.mail.Session instances that may be used for sending electronic mail messages, preconfigured
    to connect to the appropiate SMTP server.
    </description>
    <res-ref-name>mail/Session</res-ref-name>
    <res-type>javax.mail.Session</res-type>
    <res-auth>Container</res-auth>
    </resource-ref> 
```

我正在使用下一个代码片段访问我的 javax.mail.Session 对象。

```
Context initCtx = new InitialContext();
Context envCtx = (Context) initCtx.lookup("java:comp/env");
Session session = (Session)envCtx.lookup("mail/Session");
System.out.println("HERE smtp.user: " + session.getProperty("mail.smtp.user")); 
```

我在一个示例应用程序中对其进行了测试，它工作正常。不幸的是，当我将相同的代码移动到一个 struts 应用程序时，我在上面的打印语句中得到了 NULL。我在名为 mailer 的单例类中查找上下文（在我的 WEB-INF/classes 文件夹中定义），但是如果我在 Struts 动作类中查找上下文，我会遇到同样的问题。

我一直在想有什么不同的地方才能找到问题。我的 struts 应用程序 web.xml 比简单应用程序的 web.xml 更复杂。它具有安全约束、过滤器和 Struts Servlet 配置。我将 resource-ref 定位在 servlet 定义之前。似乎资源引用被忽略了。

我还有一个问题。如果我在 myapp/WEB-INF/lib 文件夹中有 javax.mail.Session 所需的 mailapi.jar，我会得到：

java.lang.NoClassDefFoundError: javax/mail/Authenticator

如果我把它放在 $CATALINA_HOME/lib 中就找到了。

有任何想法吗？我使用struts和hibernate。也许与此有关。

## 调试

我试图调试它，将调试属性放在上下文中

```
<Context reloadable="true" debug="99" ... 
```

但我没有看到任何有趣的东西。

```
01-feb-2009 17:39:09 org.apache.catalina.core.ApplicationContext log
INFO: ContextListener: contextInitialized()
01-feb-2009 17:39:09 org.apache.catalina.core.ApplicationContext log
INFO: SessionListener: contextInitialized()
01-feb-2009 17:39:09 org.apache.catalina.core.ApplicationContext log
INFO: ContextListener: contextInitialized()
01-feb-2009 17:39:09 org.apache.catalina.core.ApplicationContext log
INFO: SessionListener: contextInitialized()
01-feb-2009 17:39:09 org.apache.catalina.core.ApplicationContext log
INFO: ContextListener: contextInitialized()
01-feb-2009 17:39:09 org.apache.catalina.core.ApplicationContext log 
```

我试过：

```
Session session = (Session) initCtx.lookup("java:comp/env/mail/Session"); 
```

代替：

```
Context envCtx = (Context) initCtx.lookup("java:comp/env");
Session session = (Session)envCtx.lookup("mail/Session"); 
```

但我仍然得到一个 NULL Session 对象。

## 部分解决方案

当我将 Resource 元素放在 $CATALINA_HOME/conf/context.xml 文件中时，它可以工作。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-01T16:08:04.260

**JNDI 查找代码怪癖**

我已经看到了多个找不到 JNDI 资源的问题。在 Websphere 上（我知道，你不使用它，但很高兴知道......）你会遇到问题

```
上下文 envCtx = (Context) initCtx.lookup("java:comp/env");
会话会话 = (会话)envCtx.lookup("邮件/会话");

```

有效的（在 Websphere 上）是

```
会话会话 = (Session) initCtx.lookup("java:comp/env/mail/Session");

```

从您在另一个答案中所写的内容中，我了解到这不是您的问题-我将其留在这里，以供以后在不同情况下遇到相同问题的人们使用。

**从自生线程中查找 JNDI 资源**

此外，对 JNDI 资源的访问可能*取决于查找*资源的线程。据我记得，在 servlet api（或 Java EE 或相关领域）中没有很好地定义线程。它甚至可能是自愿和明确地未定义的。因此，服务器*在线程中提供 JNDI 资源并不是强制性的你已经产生了自己*（Websphere 再次咬我，我没有在这方面测试过 Tomcat6，早期版本用于为所有线程提供 JNDI 资源）

您已经写过您正在从单例中查找 JNDI 资源。**如果您**在查找资源时**检查堆栈**跟踪（在您的 IDE 中，通过抛出异常或弄乱`Thread.currentThread().getStacktrace()`）：堆栈跟踪中**是否有任何 Tomcat 连接器**，**或者是您自己的 Thread 的 run() 方法之一**堆栈跟踪的**根****？**如果您从 Action 类进行查找，这将回答 Jacks question 背后的问题。（见杰克的回答）

**线程和调用环境第二部分**

创建一个新的 Struts Action 并从那里调用您的 JNDI 查找代码，看看它是否在靠近 struts 并在 http 请求的处理中工作。如果在这里有效，请继续执行上述步骤。

**web.xml 的有效性**

此外，您可能希望查看 web.xml 的架构定义，以确保您的资源引用正确定位。servlet 规范 2.4 可在[jcp.org](http://jcp.org/aboutJava/communityprocess/final/jsr154/index.html)上获得，并且应该足以检查，即使 tomcat 实现 2.5。

毕竟，我相信 tomcat6 会验证 web.xml，因此您可能已经将它放在正确的位置。（不记得了，因为我的 IDE 编辑器在我出错时会抱怨，我是否需要编写 web.xml）

**Tomcat 调试选项**

许多 context.xml 条目尊重属性“调试”。虽然我相信低一位数的值就足够了，但我已经养成了将 'debug="99"' 添加到 'Context' 或其他元素等元素的习惯。您可能想看看这是否会产生一些有用的日志条目。

**确保它不是类路径**

由于您似乎从根本上改变了环境，*请确保您拥有所有必需*的库 - 邮件 api 由几个 jars 组成。下载新副本并将*所有*库解压到 $CATALINA_HOME/lib。一旦它与那里的所有库一起使用，您可能会带走未使用的东西。

**关于您的类路径问题**：

放入 $CATALINA_HOME/lib 时找到类的原因是，连接是由服务器完成的（请记住 - 您已经在 context.xml 中定义了它，服务器会读取它以启动应用程序），因此jar 必须在*服务器*类路径上 - 不仅仅是在应用程序上（有关更多信息，请参阅[tomcat 类加载器 HOWTO ）](http://tomcat.apache.org/tomcat-6.0-doc/class-loader-howto.html)

编辑：

**关于您的部分解决方案**：

$CATALINA_HOME/conf/context.xml 包含全局“默认”上下文元素。这不是您希望应用程序特定配置的位置。

tomcat 的标准位置要么在 webapps META-INF/context.xml 中，要么在 $CATALINA_HOME/conf/Catalina/localhost/ 中的 xml 文件（随意命名，以 .xml 结尾）中。就 META-INF/context.xml 而言，后一种解决方案实际上更受欢迎，因为这样配置独立于应用程序，并且在部署新应用程序时不会被覆盖。

此上下文通常包含附加属性，例如 docBase 和路径：

```
<Context docBase="/location/where/you/deployed/your/application" path="/app">
  ...
</Context> 
```

这样您的应用程序就可以在`http://servername:8080/app`. 如果部署到 $CATALINA_HOME/webapps 目录，则 docBase 值可以相对于 webapp。但请注意竞争条件：Tomcat 将在 $CATALINA_HOME/webapps 中自动部署应用程序，并可能创建上下文文件。此外，删除 webapp 以部署新的可能会导致 tomcat 删除 xml 配置文件。

因此-无论您的问题是什么：尝试放置在 $CATALINA_HOME/conf/Catalina/localhost/app.xml 中时您的上下文定义/应用程序是否工作。我觉得这是一件非常简单的事情，只有最后一点信息丢失才能看到真正的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-01T17:21:12.413

我相信您应该在 META-INF/context.xml 中定义您的上下文，而不是 META-INF/web.xml（尽管这可能只是您原始帖子中的错字）。

当您说您将代码移至 Struts 应用程序时，您能更具体一点吗？您的意思是您现在正在 Action 类中查找上下文吗？

此外，您可能已经知道这一点，但是在您的 Web 应用程序 META-INF/context.xml 中定义您的上下文（JNDI 条目等）在开发人员的环境中是可以接受的，我强烈反对在任何形式的共享环境中使用它，当然不在生产环境中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-03T05:40:01.063

> 你有什么建议？

在 JNDI 中定义它，但在您的 Web 应用程序/WAR 之外。在 Tomcat 中，您可以通过将其放在 ${CATALINA_BASE}/conf/context.xml 文件中来执行此操作。这允许在您的 Web 应用程序之外定义外部资源（邮件、数据库等）配置，从而避免在数据库配置更改时重新打包 WAR，或者例如使用不同的数据库移动到不同的环境。

> 我在称为邮件程序的单例类中查找上下文。

这个邮件类，是在 WEB-INF/classes 中，还是在 WEB-INF/lib 中的 JAR？或者它是否在您的类路径中的其他地方定义？如果是后者，您可能需要考虑将其移至您的应用程序中。

* * *

编辑：根据您的最新发现，您的网络应用程序的 META-INF/context.xml 似乎没有生效。Tomcat 中有几种情况会导致这种情况。我不知道这些细节，但这里有一些我能找到的信息：

每 - [http://tomcat.apache.org/tomcat-5.5-doc/config/host.html](http://tomcat.apache.org/tomcat-5.5-doc/config/host.html)

如果您的 Host 元素中的“deployXML”属性设置为 false（我相信 server.xml）。

> deployXML - 如果要禁用解析嵌入在应用程序中的 context.xml 文件（位于 /META-INF/context.xml），则设置为 false。具有安全意识的环境应将其设置为 false 以防止应用程序与容器的配置进行交互。然后管理员将负责提供一个外部上下文配置文件，并将其放在 $CATALINA_HOME/conf/[enginename]/[hostname]/ 中。该标志的值默认为 true。

每 - [http://tomcat.apache.org/tomcat-5.5-doc/config/context.html](http://tomcat.apache.org/tomcat-5.5-doc/config/context.html)

如果您定义了 $CATALINA_HOME/conf/[enginename]/[hostname]/[context-path].xml 文件。

我敢肯定还有其他的，这些只是我能够快速找到的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-08T10:20:13.163

由于与上述解决方案相比，这是一个完全不同的场景，我选择添加另一个答案而不是编辑前一个答案：

以防万一：确保您的上下文定义中没有错别字*。*将其与 $CATALINA_HOME/conf/context.xml 中的工作版本进行仔细比较

我们不希望“邮件/Sessoin”有所作为……

# .net - 如何在 ASP.NET MVC Beta 1 中对路由进行单元测试？

> ID：494993
> 
> 赞同：2
> 
> 时间：2009-01-30T09:53:16.343
> 
> 标签：.net, asp.net-mvc, unit-testing

[我在 ASP.NET MVC 的早期版本中找到了Stephen Walther](http://www.stephenwalther.com/blog/archive/2008/07/02/asp-net-mvc-tip-13-unit-test-your-custom-routes.aspx)和[Scott Gu](http://weblogs.asp.net/scottgu/archive/2007/12/03/asp-net-mvc-framework-part-2-url-routing.aspx)关于如何对路由进行单元测试的文章，但它在 ASP.NET MVC Beta 1 中不起作用。如果我需要使用模拟框架，我d 更喜欢使用 Rhino Mocks 的解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-30T15:16:13.947

[MvcContrib](http://www.codeplex.com/MVCContrib)中的[Fluent 路由测试器](http://flux88.com/blog/fluent-route-testing-in-asp-net-mvc/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-02T23:52:07.553

我使用 Visual Studio 单元测试，这就是为什么我不能使用开箱即用的 Helper Tim。（需要 NUnit）。无论如何，这篇文章显示了我需要的代码。实际上在“没有人想使用这个丑陋的代码”部分。

```
 RouteCollection routes = new RouteCollection();
        MvcWeb.MvcApplication.RegisterRoutes(routes);

        var httpContext = MockRepository.GenerateStub<HttpContextBase>();

        httpContext.Stub(x => x.Request).Return(MockRepository.GenerateStub<HttpRequestBase>());

        httpContext.Request.Stub(x => x.PathInfo).Return("");

        httpContext.Request.Stub(x => x.AppRelativeCurrentExecutionFilePath).Return("~/foo/bar");

        var routeData = routes.GetRouteData(httpContext);

        Assert.AreEqual(routeData.Values["controller"],"foo"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-02T23:56:20.353

Phil Haack[有一篇关于这个主题的好博文](http://haacked.com/archive/2007/12/17/testing-routes-in-asp.net-mvc.aspx)。

# python - HOWTO：在 python 中的 XML-RPC 动态函数注册？

> ID：494997
> 
> 赞同：1
> 
> 时间：2009-01-30T09:54:23.970
> 
> 标签：python, xml-rpc

我是 XML-RPC 的新手。

```
#client code
import xmlrpclib
proxy = xmlrpclib.ServerProxy("http://localhost:8000/")
x,y = arg1,arg2
print proxy.fun1(x,y)
print proxy.fun2(x,y) 
```

服务器应该做什么：

1.  加载乐趣1
2.  注册乐趣1
3.  返回结果
4.  卸载乐趣1

然后对 fun2 做同样的事情。

做这个的最好方式是什么？

我已经想出了一种方法来做到这一点，但它听起来“笨拙，牵强和不合常规”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-30T10:13:08.847

通常，服务器会继续运行 - 所以在开始时注册这两种方法。我不明白你为什么要注销你的函数。服务器保持正常运行并处理多个请求。您可能需要一个`shutdown()`关闭整个服务器的功能，但我看不到取消注册单个功能。

最简单的方法是使用[SimpleXMLRPCServer](http://docs.python.org/library/simplexmlrpcserver.html)：

```
from SimpleXMLRPCServer import SimpleXMLRPCServer

def fun1(x, y):
    return x + y

def fun2(x, y):
    return x - y

server = SimpleXMLRPCServer(("localhost", 8000))
server.register_function(fun1)
server.register_function(fun2)
server.serve_forever() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-31T20:07:49.690

如果要动态注册，请注册一个对象的实例，然后在该对象上设置属性。`__getattr__`如果需要在运行时确定函数，您可以使用类的方法获得更高级的信息。

```
class dispatcher(object): pass
   def __getattr__(self, name):
     # logic to determine if 'name' is a function, and what
     # function should be returned
     return the_func
server = SimpleXMLRPCServer(("localhost", 8000))
server.register_instance(dispatcher()) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-08-08T11:44:29.677

您可以动态注册函数（在服务器启动后）：

```
#Server side code:
import sys
from SimpleXMLRPCServer import SimpleXMLRPCServer

def dynRegFunc(): #this function will be registered dynamically, from the client
     return True 

def registerFunction(function): #this function will register with the given name
    server.register_function(getattr(sys.modules[__name__], str(function)))

if __name__ == '__main__':
    server = SimpleXMLRPCServer((address, port)), allow_none = True)
    server.register_function(registerFunction)
    server.serve_forever()

#Client side code:

 import xmlrpclib

 if __name__ == '__main__':
     proxy = xmlrpclib.ServerProxy('http://'+str(address)+':'+str(port), allow_none = True)

 #if you'd try to call the function dynRegFunc now, it wouldnt work, since it's not registered -> proxy.dynRegFunc() would fail to execute

 #register function dynamically: 
  proxy.registerFunction("dynRegFunc")
 #call the newly registered function
  proxy.dynRegFunc() #should work now! 
```********