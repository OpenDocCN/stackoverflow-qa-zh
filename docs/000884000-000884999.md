# StackOverflow 问答 000884000-000884999

# php - 从表单/URL 清理 POST/GET 变量的最佳方法？

> ID：884000
> 
> 赞同：0
> 
> 时间：2009-05-19T17:12:48.467
> 
> 标签：php, post, get, sanitization

> **可能重复：**
> [在 PHP 中停止 SQL 注入的最佳方法](https://stackoverflow.com/questions/60174/best-way-to-stop-sql-injection-in-php)

我正在使用 PHP 创建一个网站，该网站使用 MySQL 数据库并处理来自 URL 的表单和变量。这些变量用于动态构造 SQL 查询字符串。所以我需要一个强大的解决方案来确保没有人在尝试 SQL 注入等。我的一个朋友说我真的应该只使用存储过程来访问数据库，但这并不可行，因为我使用的主机没有不允许这些。

这是我正在使用的代码（它是包装数据库命令的类的一部分）：

```
...
public function Sanitize($Variable)
{
    if(is_resource($this->ServerConnection))
    {
        $Variable = str_replace(";", "", $Variable);
        if(get_magic_quotes_gpc())
        {
            if(ini_get('magic_quotes_sybase'))
            {
                $Variable = str_replace("''", "'", $Variable);
            }
            else
            {
                $Variable = stripslashes($Variable);
            }
        }
        return mysql_real_escape_string($Variable, $this->ServerConnection);
    }
    else
    {
        $this->PrintError("The Sanitize function is not available as there is no server connection.");
    }
}
... 
```

这个功能足够强大吗？我应该做其他事情吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-19T17:18:06.790

可能值得一读[这篇文章](https://stackoverflow.com/questions/60174/best-way-to-stop-sql-injection-in-php)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-19T18:02:06.917

> 最好的方法是什么...

没有最好的办法。这取决于上下文。

> .. 清理来自 .. 的 POST/GET 变量

认为数据是好是坏是一种有缺陷的思维模式。数据只是数据。是使用它的上下文决定了它是否是恶意的。如果您在数据库服务器上不加修饰地执行某些单词，它们可能会很糟糕。如果你把它们展示给未成年人，有些词是不好的。这是关于上下文的。

# java - 在 Java 中关闭嵌套流和编写器的正确方法

> ID：884007
> 
> 赞同：96
> 
> 时间：2009-05-19T17:14:31.257
> 
> 标签：java, java-io

**注意：**这个问题及其大部分答案都可以追溯到 Java 7 发布之前。Java 7 提供了[自动资源管理](https://docs.oracle.com/javase/tutorial/essential/exceptions/tryResourceClose.html)功能，可以轻松地做到这一点。如果您使用的是 Java 7 或更高版本，您应该提前[了解 Ross Johnson 的答案](https://stackoverflow.com/a/21723193)。

* * *

什么被认为是在 Java 中关闭嵌套流的最佳、最全面的方法？例如，考虑设置：

```
FileOutputStream fos = new FileOutputStream(...)
BufferedOS bos = new BufferedOS(fos);
ObjectOutputStream oos = new ObjectOutputStream(bos); 
```

我知道关闭操作需要被保险（可能通过使用 finally 子句）。我想知道的是，是否有必要明确确保嵌套流已关闭，或者仅确保关闭外部流（oos）就足够了？

我注意到的一件事，至少在处理这个特定示例时，内部流似乎只抛出 FileNotFoundExceptions。这似乎意味着从技术上讲，如果它们失败，则无需担心关闭它们。

这是同事写的：

* * *

从技术上讲，如果实施得当，关闭最外层流 (oos) 就足够了。但实施似乎有缺陷。

示例：BufferedOutputStream 继承自 FilterOutputStream 的 close()，它定义为：

```
 155       public void close() throws IOException {
 156           try {
 157             flush();
 158           } catch (IOException ignored) {
 159           }
 160           out.close();
 161       } 
```

但是，如果 flush() 出于某种原因抛出运行时异常，则永远不会调用 out.close()。因此，主要担心关闭 FOS 似乎是“最安全的”（但丑陋），这会使文件保持打开状态。

* * *

什么被认为是关闭嵌套流的最佳方法？

是否有任何官方的 Java/Sun 文档可以详细处理这个问题？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-05-19T17:17:45.603

关闭链式流时，只需要关闭最外层的流即可。任何错误都将向上传播并被捕获。

有关详细信息，请参阅[Java I/O 流](http://java.sun.com/developer/technicalArticles/Streams/ProgIOStreams/)。

~~解决问题~~

 ~~> 但是，如果 flush() 出于某种原因抛出运行时异常，则永远不会调用 out.close()。~~ 

~~这是不对的。捕获并忽略该异常后，将在 catch 块之后恢复执行，并`out.close()`执行该语句。~~

**您的同事对运行时**异常提出了很好的观点。如果您绝对需要关闭流，您可以随时尝试从外向内单独关闭每个流，在第一个异常处停止。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2014-02-12T09:06:32.093

在 Java 7 时代，[try-with-resources](http://docs.oracle.com/javase/tutorial/essential/exceptions/tryResourceClose.html)肯定是要走的路。如前几个答案所述，关闭请求从最外层流传播到最内层流。因此，只需一次关闭即可。

```
try (ObjectInputStream ois = new ObjectInputStream(new FileInputStream(f))) {
  // do something with ois
} 
```

然而，这种模式存在一个问题。try-with-resources 不知道内部的 FileInputStream，因此如果 ObjectInputStream 构造函数抛出异常，则 FileInputStream 永远不会关闭（直到垃圾收集器到达它）。解决方案是...

```
try (FileInputStream fis = new FileInputStream(f); ObjectInputStream ois = new ObjectInputStream(fis)) {
  // do something with ois
} 
```

这不是那么优雅，但更健壮。这是否真的是一个问题将取决于在构建外部对象期间可以抛出哪些异常。ObjectInputStream 可以抛出 IOException ，这很可能会被应用程序处理而不会终止。许多流类只抛出未经检查的异常，这很可能导致应用程序终止。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2011-03-16T16:06:26.007

使用 Apache Commons 处理 IO 相关对象是一种很好的做法。

在`finally`子句中使用`IOUtils`

**IOUtils.closeQuietly(bWriter); IOUtils.closeQuietly(oWritter);**

下面的代码片段。

```
BufferedWriter bWriter = null;
OutputStreamWriter oWritter = null;

try {
  oWritter  = new OutputStreamWriter( httpConnection.getOutputStream(), "utf-8" );
  bWriter = new BufferedWriter( oWritter );
  bWriter.write( xml );
}
finally {
  IOUtils.closeQuietly(bWriter);
  IOUtils.closeQuietly(oWritter);
} 
```

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2009-05-19T17:53:50.583

我通常会执行以下操作。首先，定义一个基于模板方法的类来处理 try/catch 混乱

```
import java.io.Closeable;
import java.io.IOException;
import java.util.LinkedList;
import java.util.List;

public abstract class AutoFileCloser {
    // the core action code that the implementer wants to run
    protected abstract void doWork() throws Throwable;

    // track a list of closeable thingies to close when finished
    private List<Closeable> closeables_ = new LinkedList<Closeable>();

    // give the implementer a way to track things to close
    // assumes this is called in order for nested closeables,
    // inner-most to outer-most
    protected final <T extends Closeable> T autoClose(T closeable) {
            closeables_.add(0, closeable);
            return closeable;
    }

    public AutoFileCloser() {
        // a variable to track a "meaningful" exception, in case
        // a close() throws an exception
        Throwable pending = null;

        try {
            doWork(); // do the real work

        } catch (Throwable throwable) {
            pending = throwable;

        } finally {
            // close the watched streams
            for (Closeable closeable : closeables_) {
                if (closeable != null) {
                    try {
                        closeable.close();
                    } catch (Throwable throwable) {
                        if (pending == null) {
                            pending = throwable;
                        }
                    }
                }
            }

            // if we had a pending exception, rethrow it
            // this is necessary b/c the close can throw an
            // exception, which would remove the pending
            // status of any exception thrown in the try block
            if (pending != null) {
                if (pending instanceof RuntimeException) {
                    throw (RuntimeException) pending;
                } else {
                    throw new RuntimeException(pending);
                }
            }
        }
    }
} 
```

请注意“待处理”异常——这会处理关闭期间抛出的异常会掩盖我们可能真正关心的异常的情况。

finally 会首先尝试从任何装饰流的外部关闭，因此如果您有一个包装 FileWriter 的 BufferedWriter，我们会尝试先关闭 BuffereredWriter，如果失败，仍然尝试关闭 FileWriter 本身。（注意 Closeable 的定义调用 close() 如果流已经关闭则忽略该调用）

您可以按如下方式使用上述类：

```
try {
    // ...

    new AutoFileCloser() {
        @Override protected void doWork() throws Throwable {
            // declare variables for the readers and "watch" them
            FileReader fileReader = 
                    autoClose(fileReader = new FileReader("somefile"));
            BufferedReader bufferedReader = 
                    autoClose(bufferedReader = new BufferedReader(fileReader));

            // ... do something with bufferedReader

            // if you need more than one reader or writer
            FileWriter fileWriter = 
                    autoClose(fileWriter = new FileWriter("someOtherFile"));
            BufferedWriter bufferedWriter = 
                    autoClose(bufferedWriter = new BufferedWriter(fileWriter));

            // ... do something with bufferedWriter
        }
    };

    // .. other logic, maybe more AutoFileClosers

} catch (RuntimeException e) {
    // report or log the exception
} 
```

使用这种方法，您永远不必担心 try/catch/finally 会再次处理关闭文件。

如果这对您的使用来说太重了，至少考虑遵循 try/catch 和它使用的“待定”变量方法。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-05-19T17:40:21.053

这位同事提出了一个有趣的观点，无论哪种方式都有理由争论。

就个人而言，我会忽略`RuntimeException`, 因为未经检查的异常表示程序中的错误。如果程序不正确，请修复它。您不能在运行时“处理”坏程序。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-05-19T18:05:47.490

这是一个令人惊讶的尴尬问题。（即使假设`acquire; try { use; } finally { release; }`代码是正确的。）

如果装饰器的构造失败，那么您将不会关闭底层流。因此，您确实需要显式关闭底层流，无论是在最终使用后，还是在成功将资源移交给装饰器后更困难）。

如果异常导致执行失败，你真的要刷新吗？

一些装饰器实际上自己有资源。例如，当前的 Sun 实现`ZipInputStream`分配了非 Java 堆内存。

有人声称（IIRC）Java 库中三分之二的资源使用是以明显不正确的方式实现的。

虽然`BufferedOutputStream`即使在`IOException`from`flush`上也`BufferedWriter`关闭，但正确关闭。

我的建议：尽可能直接关闭资源，不要让它们污染其他代码。OTOH，您可能会在这个问题上花费太多时间 - 如果`OutOfMemoryError`抛出它，表现得很好，但您程序的其他方面可能具有更高的优先级，并且无论如何在这种情况下库代码可能会被破坏。但我总是写：

```
final FileOutputStream rawOut = new FileOutputStream(file);
try {
    OutputStream out = new BufferedOutputStream(rawOut);
    ... write stuff out ...
    out.flush();
} finally {
    rawOut.close();
} 
```

（看：没有抓住！）

也许使用 Execute Around 成语。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-02-07T13:50:35.007

似乎没有提到Java SE 7 [try-with-resources 。](http://docs.oracle.com/javase/tutorial/essential/exceptions/tryResourceClose.html)它消除了完全明确地关闭的需要，我非常喜欢这个想法。

不幸的是，对于 Android 开发，只有使用 Android Studio（我认为）并[针对 Kitkat 及更高](https://www.google.com/url?q=http://tools.android.com/tech-docs/new-build-system/user-guide#TOC-Using-sourceCompatibility-1.7)版本才能获得这种甜蜜。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-02-06T14:18:06.143

此外，您不必关闭所有嵌套流

检查这个 [http://ckarthik17.blogspot.com/2011/02/closing-nested-streams.html](http://ckarthik17.blogspot.com/2011/02/closing-nested-streams.html)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-02-25T10:00:43.803

我习惯像这样关闭流，而不在 finally块**中嵌套 try-catch**

```
public class StreamTest {

public static void main(String[] args) {

    FileOutputStream fos = null;
    BufferedOutputStream bos = null;
    ObjectOutputStream oos = null;

    try {
        fos = new FileOutputStream(new File("..."));
        bos = new BufferedOutputStream(fos);
        oos = new ObjectOutputStream(bos);
    }
    catch (Exception e) {
    }
    finally {
        Stream.close(oos,bos,fos);
    }
  }   
}

class Stream {

public static void close(AutoCloseable... array) {
    for (AutoCloseable c : array) {
        try {c.close();}
        catch (IOException e) {}
        catch (Exception e) {}
    }
  } 
} 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-05-19T18:39:48.493

Sun 的 JavaDocs`RuntimeException`在其文档中包含 s，如 InputStream 的[read(byte[], int, int)](http://java.sun.com/javase/6/docs/api/java/io/InputStream.html#read(byte[],%20int,%20int))方法所示；记录为抛出 NullPointerException 和 IndexOutOfBoundsException。

FilterOutputStream 的[flush()](http://java.sun.com/javase/6/docs/api/java/io/FilterOutputStream.html#flush())仅记录为抛出 IOException，因此它实际上并没有抛出任何`RuntimeException`s。任何可以抛出的东西很可能都被包裹在一个[`IIOException`](http://java.sun.com/javase/6/docs/api/java/io/IOException.html).

它仍然可以抛出一个[`Error`](http://java.sun.com/javase/6/docs/api/java/lang/Error.html)，但是您对此无能为力；Sun 建议您不要试图抓住它们。

# c# - 如何弹出“Windows 无法打开此文件”对话框？

> ID：884012
> 
> 赞同：5
> 
> 时间：2009-05-19T17:16:18.290
> 
> 标签：c#, visual-studio-2005, file-association, process.start

我的用户可以将文档附加到应用程序中的各种实体。当然，如果用户 A 附加了一个 .TIFF 文件，用户 B 可能没有该类型文件的查看器。

所以我希望能够调出这个对话框：

[替代文字 http://www.angryhacker.com/toys/cannotopen.png](http://www.angryhacker.com/toys/cannotopen.png)

我的应用程序是带有 VS2005 的 C#。
目前我做 Process.Start 并传入文件名。如果没有找到关联，则抛出异常。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-10-30T09:57:13.893

```
Process pr = new Process();
pr.StartInfo.FileName = fileTempPath;
pr.StartInfo.ErrorDialog = true; // important
pr.Start(); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-19T17:28:21.363

这应该这样做：

```
System.Diagnostics.Process p = new System.Diagnostics.Process();
p.StartInfo.FileName = "rundll32.exe";
p.StartInfo.Arguments = "shell32.dll,OpenAs_RunDLL " + yourFileFullnameHere;

p.Start(); 
```

# regex - 正则表达式中的可选字符

> ID：884014
> 
> 赞同：7
> 
> 时间：2009-05-19T17:16:24.373
> 
> 标签：regex, optional

这个任务很简单，但我还没有想出一个好的解决方案：一个字符串可以包含数字、破折号和加号，或者只包含数字。

```
^[0-9+-]+$ 
```

完成我需要的大部分工作，除非用户输入像“+-+--+”这样的垃圾

我没有定期向前看的运气，因为破折号和加号可能位于字符串中的任何位置。

有效字符串：

1.  234654
2.  24-3+-2
3.  -234
4.  25485+

无效的：

1.  ++--+

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-19T17:22:40.387

这个怎么样：

```
([+-]?\d[+-]?)+ 
```

这意味着“一个或多个数字，每个数字前面或后面都可以有一个可选的加号或减号”。

这是一个 Python 测试脚本：

```
import re
TESTS = "234654 24-3+-2 -234 25485+ ++--+".split()
for test in TESTS:
    print test, ":", re.match(r'([+-]?\d[+-]?)+', test) is not None 
```

打印这个：

```
234654 : True
24-3+-2 : True
-234 : True
25485+ : True
++--+ : False 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-19T17:20:22.980

怎么样：

```
^[0-9+-]*[0-9][0-9+-]*$ 
```

这确保了字符串中的某处至少有一个数字。（看起来它可能有很多回溯。但另一方面，它没有包含在另一个 + 或 * 中的 + 或 *，我也不喜欢。）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-19T17:21:48.487

```
^([+-]*[0-9]+[+-]*)+$ 
```

另一种解决方案在断言后面使用积极的看法，确保至少有一个数字。

```
^[0-9+-]+$(?<=[0-9][+-]*) 
```

或者使用积极的前瞻性断言。

```
(?=[+-]*[0-9])^[0-9+-]+ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-04-24T21:09:42.373

我喜欢

```
^(?=.*\d)[\d+-]+$ 
```

解决方案，我自己。它准确地说明了您的需求，而无需任何麻烦。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-04-25T00:09:53.557

我会这样做：

```
^[-+]*\d[\d+-]*$ 
```

快就是好！

# xml - XML：哪些处理规则适用于与标签交织的值？

> ID：884016
> 
> 赞同：0
> 
> 时间：2009-05-19T17:16:45.480
> 
> 标签：xml, parsing, pull, well-formed

我已经开始研究一个简单的 XML 拉式解析器，因为我刚刚对 XML 中关于某些字符/序列、可忽略的空格等的正确语法感到困惑（谢谢，[http://www .w3schools.com/xml/xml_elements.asp](http://www.w3schools.com/xml/xml_elements.asp)），我意识到我仍然不知道可以勾勒出以下情况（[Validome](http://www.validome.org/xml/validate/)发现它的格式非常好；请注意，我只想使用 xml用于数据存储的文件，不需要实体、DTD 或模式）：

```
<bookstore>
   <book id="1">
      <author>Kurt Vonnegut Jr.</author>
      <title>Slapstick</title>
   </book>
We drop a pie here.
   <book id="2">Who cares anyway?
      <author>Stephen King</author>
      <title>The Green Mile</title>
   </book>
And another one here.
   <book id="3">
      <author>Next one</author>
      <title>This time with its own title</title>
   </book>
</bookstore> 
```

“我们在这里放一个馅饼。” 和“这里还有一个。” 是“书店”元素的值。“谁在乎呢？” 是与第二个“书”元素相关的值。

如果有的话，这些是如何处理的？威尔“我们在这里丢馅饼。” 和“这里还有一个。” 被连接起来形成“书店”元素的一个值，或者它们被单独处理，存储在某个地方，影响它们所属元素的解析结果，或者......？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-19T17:20:13.713

最简单的方法是使用一些符合标准的解析器对其进行解析并转储输出。

# wpf - 如何将 Wpf DataGridColumn 绑定到对象？

> ID：884017
> 
> 赞同：5
> 
> 时间：2009-05-19T17:16:48.867
> 
> 标签：wpf, datagrid

我想将我的 WPF DataGrid 的列绑定到 Dictionary 中的某些对象，如下所示：

绑定路径=对象[i]

其中 Objects 是我的对象字典，因此每个单元格将代表一个 Object 元素。我怎样才能做到这一点？

我想我需要为我的单元格创建一个模板，我这样做了，但是如何在我的模板中获取列绑定的结果？我知道默认情况下 DataGridCell 的内容是 TextBlock 并且它的 Text 属性是通过列绑定结果设置的，但是如果该结果是一个对象，我想我必须创建一个 ContentTemplate。我该怎么做，因为我尝试过的东西没有显示任何东西。

这是我尝试过的：

```
<Style x:Key="CellStyle" TargetType="{x:Type dg:DataGridCell}">
    <Setter Property="Template"> ---it should realy be ContentTemplate?
      <Setter.Value>
        <ControlTemplate>
          <controls:DataGridCellControl CurrentObject="{Binding }"/> -- I would expect to get the object like this for this column path : Path=Objects[i] but is not working
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style> 
```

所以，为了让自己完全清楚，我想在我的 DataGridCellControl 的 CurrentObject 属性中获取当前对象，如果我在我的数据网格中设置列绑定，就像这个 Path = Objects [i]。

谢谢你的任何建议，

约翰。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-09-02T00:35:51.403

我制作了一些辅助类，以便可以将 DataGrid 用作一种 DataTable。换句话说，我想要 DataGrid 的格式化、排序和优美的外观，而不必事先预制一些类。我想要这个的主要原因是为了一个测试套件，我希望能够在运行时创建任意数量的列。这是我得到的

```
public class DataRow
{
    internal List<object> Items = new List<object>();

    public object this[string value]
    {
        get { return Items[Convert.ToInt32(value)]; }
    }

    public string GetString(int index)
    {
        return Items[index].ToString();
    }

    public object GetObject(int index)
    {
        return Items[index];
    }

    public DataRow(params object[] values)
    {
        if (values == null || values.Length < 1)
            throw new Exception("You must pass in some values");

        Items.AddRange(values);            
    }
}  

public class GridConstructor
{
    public List<DataRow> Rows = new List<DataRow>();
    private DataRow headers;

    public GridConstructor(DataRow head)
    {
        headers = head;
    }

    public void BuildInto(DataGrid grid)
    {
        grid.AutoGenerateColumns = false;
        grid.Columns.Clear();
        int totalCols = 0;

        Type headType = headers.GetType();

        for (int i = 0; i < headers.Items.Count; i++)
        {
            grid.Columns.Add(GetCol(headers.GetString(i), String.Concat("[", i.ToString(),"]")));
            totalCols++;
        }                     

        int finalWidth = totalCols * (int)grid.ColumnWidth.Value + 15;
        grid.Width = finalWidth;

        grid.ItemsSource = Rows;
    }

    private DataGridTextColumn GetCol(string header, string binding)
    {
        DataGridTextColumn col = new DataGridTextColumn();
        col.IsReadOnly = true;            
        col.Header = header;
        col.Binding = new Binding(binding);

        return col;
    }

    public DataGrid Create(int colSize)
    {
        DataGrid grid = new DataGrid();
        grid.ColumnWidth = colSize;
        grid.CanUserAddRows = false;
        grid.AlternationCount = 2;
        BuildInto(grid);
        return grid;
    }
} 
```

放在一起，这是一个示例使用：

```
void SimpleTest_Loaded(object sender, RoutedEventArgs e)
    {            
        DataRow headers = new DataRow("Level", "Weapon Type", "vs None", "vs Leather", "vs Studded", "vs Brigandine");            
        GridConstructor gridConstructor = new GridConstructor(headers);            

        var weaponType = "Slash";
        for (int level = 1; level < 10; level++)
        {
            int damage = DiceCup.RollMulti(8, level);
            int damCloth = damage - DiceCup.RollMulti(2, level);
            int damLeather = damage - DiceCup.RollMulti(3, level);
            int damStudded = damage - DiceCup.RollMulti(4, level);
            int damBrigandine = damage - DiceCup.RollMulti(5, level);

            DataRow row = new DataRow(level, weaponType, damage, damCloth, damLeather, damStudded, damBrigandine);
            gridConstructor.Rows.Add(row);                
        }

        //Create the grid.
        var grid = gridConstructor.Create(100);

        //Create a chart.
        Chart chart = new Chart();
        chart.Height = 200;
        chart.LegendTitle = "Legend";
        chart.Title = "Slash vs Armor Types";                       
        chart.DataContext = gridConstructor.Rows;            

        //Create our series, or lines.
        LineSeries slashVsNone = new LineSeries();
        slashVsNone.Title = "vs None";
        slashVsNone.DependentValueBinding = new Binding("[2]");
        slashVsNone.IndependentValueBinding = new Binding("[0]");
        slashVsNone.ItemsSource = gridConstructor.Rows;            
        chart.Series.Add(slashVsNone);

        //Presentation is a stackpanel on the page.            
        presentation.Children.Add(grid);
        presentation.Children.Add(chart);             
    } 
```

和输出：

[替代文字 http://quiteabnormal.com/images/codeSample.jpg](http://quiteabnormal.com/images/codeSample.jpg "输出")

请注意，网格着色来自页面上设置的通用样式。如果您使用 GridConstructor.BuildInto() 方法，您可以指定一个您已经在 Blend 或类似工具中预先格式化的网格。

只有一件事，GridConstructor 对列的初始设置做了一些假设。如果您愿意，您可以更改课程以使其更具可定制性，但这是我所需要的，所以我希望能够毫不费力地制作它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-19T17:41:37.510

尝试这个：

```
<ListView x:Name="listViewUsers" SelectionMode="Single" 
                              ItemsSource="{Binding ElementName=window1, Path=Users, Mode=TwoWay}" MouseDoubleClick="listViewUsers_MouseDoubleClick">
                        <ListView.View>
                            <GridView x:Name="gridViewUsers" AllowsColumnReorder="False">
                                <GridViewColumn>
                                    <GridViewColumn.CellTemplate>
                                        <DataTemplate>
                                            <Image Source="{Binding Path=IsAdministrator, Converter={StaticResource boolToImage}, ConverterParameter='Images/admin18.gif|Images/user18.gif'}" />
                                        </DataTemplate>
                                    </GridViewColumn.CellTemplate>
                                </GridViewColumn>
                                <GridViewColumn Header="User Name" DisplayMemberBinding="{Binding Path=UserName}" Width="140" />
                                <GridViewColumn Header="Full Name" DisplayMemberBinding="{Binding Path=FullName}" Width="140" />
                                <GridViewColumn Header="Phone Number" DisplayMemberBinding="{Binding Path=PhoneNumber}" Width="110" />
                                <GridViewColumn Header="Access Type" DisplayMemberBinding="{Binding Path=AccessType}" Width="110">
                                </GridViewColumn>
                                <GridViewColumn>
                                    <GridViewColumn.CellTemplate>
                                        <DataTemplate>
                                            <Image Cursor="Hand" ToolTip="Delete User" Stretch="None" Source="Images/trash12.gif" MouseUp="DeleteUser" />
                                        </DataTemplate>
                                    </GridViewColumn.CellTemplate>
                                </GridViewColumn>
                            </GridView>
                        </ListView.View>
                    </ListView> 
```

在 ItemsSource="{Binding ElementName=window1, Path=Users, Mode=TwoWay}"

*   ElementName 是 XAML 中 Window 的名称（只需将 x:Name="window1" 添加到 Window 标记中，就像使用任何其他控件一样。

*   用户是一个列表，应该与字典相同

*   Mode=TwoWay 表示如果网格被修改，列表也会被修改，反之亦然（双向绑定）

**编辑：**

尝试这个：

XAML：

```
<ListView x:Name="listViewTest" ItemsSource="{Binding}">
<ListView.View>
    <GridView x:Name="gridViewTest">

    </GridView>
</ListView.View>
</ListView> 
```

C＃：

```
public class TheClass
    {
        public int Col1, Col2, Col3; 
        public Dictionary<int, OtherColumns> otherColumns = new Dictionary<int,OtherColumns>();
    }

    public class OtherColumns
    {
        public string ColumnName;
        public int Value;
    } 
```

并在 Window_Loaded 下调用此方法：

```
private void PopulateListView()
        {
            TheClass c = new TheClass();

            c.Col1 = 10;
            c.Col2 = 20;
            c.Col3 = 30;

            c.otherColumns.Add(0, new OtherColumns() { ColumnName = "Col4", Value = 40 });
            c.otherColumns.Add(1, new OtherColumns() { ColumnName = "Col5", Value = 50 });
            c.otherColumns.Add(3, new OtherColumns() { ColumnName = "Col6", Value = 60 });

            DataTable table = new DataTable();

// adding regular columns
            table.Columns.Add("Col1", typeof(int));
            table.Columns.Add("Col2", typeof(int));
            table.Columns.Add("Col3", typeof(int));

// adding dynamic columns
            foreach (KeyValuePair<int, OtherColumns> pair in c.otherColumns)
            {
                table.Columns.Add(pair.Value.ColumnName, typeof(int));
            }

            DataRow row = table.NewRow();

// adding regular column values to the DataTable
            row["Col1"] = c.Col1;
            row["Col2"] = c.Col2;
            row["Col3"] = c.Col3;

// adding dynamic column values to the DataTable
            foreach (KeyValuePair<int, OtherColumns> pair in c.otherColumns)
            {
                row[pair.Value.ColumnName] = pair.Value.Value;
            }

            table.Rows.Add(row);

            // Start binding the table.
            gridViewTest.Columns.Clear();

            System.Windows.Controls.GridViewColumn gvc;
            Binding binding;

            foreach (DataColumn column in table.Columns)
            {
                gvc = new System.Windows.Controls.GridViewColumn();
                binding = new System.Windows.Data.Binding();
                binding.Path = new PropertyPath(column.ColumnName);
                binding.Mode = BindingMode.OneWay;
                gvc.Header = column.Caption;
                gvc.DisplayMemberBinding = binding;
                gridViewTest.Columns.Add(gvc);
            }

            listViewTest.DataContext = table;
        } 
```

我并不是说这是最好的解决方案，但它可以提供帮助。让我知道。

# nhibernate - 在 Fluent Nhibernate 中自动映射复合元素

> ID：884028
> 
> 赞同：1
> 
> 时间：2009-05-19T17:18:10.020
> 
> 标签：nhibernate, fluent-nhibernate

我试图让 AutoPersistence 模型映射几个复合元素。但是，似乎要么我最终将它映射为一个实体，要么下降到手动映射，要么它根本不起作用。这是一些演示我的问题的代码：

```
using System;
using System.Collections.Generic;
using FluentNHibernate.AutoMap;
using FluentNHibernate.Cfg;
using FluentNHibernate.Conventions.Helpers;
using NHibernate.Cfg;

namespace Scanner {
    public class Root {
        public int Id { get; set; }
        public string Name { get; set; }
        public ICollection<Component> Components { get; set; }
    }

    public class Component {
        public string Name { get; set; }
    }

    class Example {
        public void DoesntGetComponents()
        {
            Configuration configuration = new Configuration();
            configuration.SetProperty("ConnectionString", "");
            configuration.SetProperty("dialect", "NHibernate.Dialect.MsSql2005Dialect");
            var config = Fluently.Configure(configuration)
                .Mappings(m => m.AutoMappings.Add(AutoMapping))
                .BuildConfiguration();
            var sql2005 = new NHibernate.Dialect.MsSql2005Dialect();
            foreach (var line in config.GenerateSchemaCreationScript(sql2005))
            {
                Console.WriteLine(line);
            }
        }

        static AutoPersistenceModel AutoMapping() {
            AutoPersistenceModel model = new AutoPersistenceModel();
            return model
                .AddEntityAssembly(typeof(Root).Assembly)
                .WithSetup(e => e.IsComponentType = t => t == typeof(Component))
                .Where(t => t == typeof(Root))
                .MergeWithAutoMapsFromAssemblyOf<Root>()
                .ConventionDiscovery.Add(ForeignKey.Format((p, t) => (p == null ? t.Name : p.Name) + "Id"))
                .ConventionDiscovery.Add(Table.Is(t => t.EntityType.Name))
            ;
        }
    }
} 
```

（抱歉，它太长了，但它是演示问题所需的最少代码。这个特定版本的代码根本无法注册组件类型。

那么，我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-06T12:41:09.607

似乎组件本身不是问题，而是组件集合的映射。如果您将组件直接映射到 Root 类，这不会有任何问题。

一种可能的解决方法是使 Component 类成为一个实体（添加一个 ID）并覆盖 Components 到 cascade + auto delete orphans 的映射：

```
AutoPersistenceModel
.ForTypesThatDeriveFrom<Root>(map => map.HasMany(root => root.Components).Cascade.AllDeleteOrphan()) 
```

# javascript - 在包含的 iframe 中触发按钮

> ID：884041
> 
> 赞同：0
> 
> 时间：2009-05-19T17:20:52.980
> 
> 标签：javascript, html, iframe

我有一个在 iframe 中嵌入页面的 HTML + javascript 页面。我希望能够在封闭页面中使用 javascript 在嵌入页面中触发提交按钮（这会导致 POST）。有图书馆已经这样做了吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-19T17:24:19.310

如果`IFRAME`托管一个页面在同一个域中，你可以说

```
// To trigger from the enclosing page
var yourFrame = document.getElementById("iframeId");
if(yourFrame.contentDocument) {    
   yourFrame.contentDocument.getElementById("formId").submit(); // FF, etc
} else {
   yourFrame.contentWindow.document.getElementById("formId").submit(); // IE
}

// To trigger from the enclosed page
document.getElementById("formId").submit(); 
```

... `iframeId`iframe 的 ID 在哪里，是 iframe`formId`内表单的 ID，类似于

文档内部：

```
<iframe id="iframeId" src="/somePage.html" ... > 
```

在“ `somePage.html`”处的文档内：

```
<form id="formId" method="post" action="..."> 
```

请注意，如果`IFRAME`在另一个域中托管页面，那么如果您尝试从封闭页面提交，您可能会收到某种“拒绝访问”错误。这是浏览器为防止恶意脚本而采取的安全预防措施（例如，防止以用户的名义自动提交表单等事情）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-19T17:35:56.550

`iframe`需要在同一个域中，否则你就是 SOL 。

要访问框架中的元素，您需要在不同的浏览器中采取不同的行为。

首先，获取框架：

*   `document.getElementById`总是有效。
*   `window.frames[ frameName ]`也应该没问题，但使用第一个

然后获取文档（这里比较棘手）：

```
var doc = yourFrame.contentDocument ? yourFrame.contentDocument : yourFrame.contentWindow.document 
```

标准浏览器需要使用`contentDocument`; IE（至少在 8 之前）用于`contentWindow.document`获取文档。

最后，您可以获取表单并提交。

```
doc.getElementById('yourForm').submit() 
```

# sql-server - 登录问题 Windows 身份验证

> ID：884047
> 
> 赞同：0
> 
> 时间：2009-05-19T17:23:48.017
> 
> 标签：sql-server, login, connection-string, sqlconnection, jdbc

**重复：[Windows身份验证受信任连接不起作用](https://stackoverflow.com/questions/881928/windows-authentication-trusted-connection-problem)**

**我以“ abc\user1** ”身份登录Windows Server（**机器1**）。Windows Server 机器位于 abc 域中。MSSQL Server 位于机器 1 上的“abc”域中，并且具有混合模式。身份验证。它有帐户“abc\user1”和“abc\user2”。两者都有系统管理员和服务器管理员的角色。

 **我使用“ **abc\user2** ”登录了另一台机器（**机器 2）**。同域。运行连接到 MSSQL Server 的 ant。URL形成如下。

 **jdbc:sqlserver://%DB_IP%:%DB_PORT%;SelectMethod=cursor;integratedSecurity=true;DatabaseName=dbname;

1）从机器 2，如果我使用“abc\user2”凭据进行连接，那么它工作正常。因为integratedSecurity=true。

2) 从机器 2 开始，如果我使用“abc\user1”凭据进行连接，那么它就不行了，因为integratedSecurity=true 并采用系统凭据，即“abc\user2”。 **即使我让 IntegratedSecurity=false**，那么它也不会使用 "abc\user1" 连接

我对来自 Machine2 的“abc\user1”的 URL 进行了哪些更改以进行连接。url中要添加哪些属性？或驱动程序不支持使用另一个域\用户凭据？

需要在 MSSQL Server 上设置什么？

迪帕克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-19T17:39:38.947

当您使用**integratedSecurity=true**时，您不必指定任何凭据，当前登录系统的用户将用于对SQLserver 进行身份验证。

如果**IntegratedSecurity=false**。那么您必须在 connString 中指定 Sql 服务器凭据（用户和密码）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-05-20T12:56:43.243

我认为 Deepak 想要做的基本上是这样的：

数据源=myServerAddress；初始目录=myDataBase；集成安全=SSPI；用户ID=myDomain\myUsername；密码=myPassword；

但是，这只适用于 CE 设备。

在普通机器上，它会命中集成部分并使用当前凭据。

我认为他想指定要使用的域用户，而不是当前登录的用户。

# sql - 您如何为实体的自定义属性建模？

> ID：884050
> 
> 赞同：5
> 
> 时间：2009-05-19T17:24:36.673
> 
> 标签：sql, sql-server, database-design, schema, entity-attribute-value

假设我们有一个应该能够存储各种产品的应用程序。每个产品至少有一个`ID`和一个`Name`，但所有其他属性都可以由用户自己定义。

1.  例如，他可以创建一个产品组*Ipods*，其中包含属性*容量*和*代*
2.  例如，他可以创建具有属性*size*和*color的产品**组 TShirts*
***   我们需要存储产品的定义和具体产品本身。*   我们希望确保可以轻松地按产品属性进行聚合 (GROUP BY)。例如选择每一代ipods的总容量*   该解决方案不得要求架构更改（由于 Bill Karwin 的输入而增加了要求 - 也请参阅他的答案！）**

 **您将如何根据上述要求为您的模式建模？

**注意：**要求 4\. 很重要！

感谢大家贡献和讨论该方法。过去我已经看到了一些解决这个问题的方法，但没有一个让我对分组变得容易:(

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-19T18:16:51.387

我推荐[具体表继承](http://martinfowler.com/eaaCatalog/concreteTableInheritance.html)或[类表继承](http://martinfowler.com/eaaCatalog/classTableInheritance.html)设计。两种设计都满足您的所有四个标准。

在具体表继承中：

1.  Ipod 存储在具有, , ,`product_ipods`列的表中。`ID``Name``Capacity``Generation`
2.  T 恤存储在带有, , ,`product_tshirts`列的表中。`ID``Name``Size``Color`
3.  具体产品类型的定义在 和 的元数据（表定义）`product_ipods`中`product_tshirts`。
4.  `SELECT SUM(Capacity) FROM product_ipods GROUP BY Generation`;

在类表继承中：

1.  通用产品属性存储在`Products`具有列`ID`、的表中`Name`。

    Ipod 存储在`product_ipods`带有列`product_id`（外键到`Products.ID`）、`Capacity`、的表中`Generation`。

2.  Tshirts 存储在`product_tshirts`带有列的表中`product_id`（外键到`Products.ID`）、`Size`、`Color`。

3.  具体产品类型的定义在 、 和 的元数据（表定义）`products`中。`product_ipods``product_tshirts`

4.  `SELECT SUM(Capacity) FROM product_ipods GROUP BY Generation`;

* * *

另请参阅我对“[产品表，多种产品，每种产品都有许多参数](https://stackoverflow.com/questions/695752/product-table-many-kinds-of-product-each-product-has-many-parameters/695860#695860)”的回答，其中我针对您所描述的问题类型描述了几种解决方案。我还详细说明了**EAV 为何是一个损坏的设计。**

* * *

来自@dcolumbus 的重新评论：

> 使用 CTI，product_ipods 的每一行都会是它自己的价格的变化吗？

`products`如果每种类型的产品都有价格，我希望价格列出现在表格中。对于 CTI，产品类型表通常只包含仅与该类型产品相关的属性列。所有产品类型共有的任何属性都会在父表中获取列。

> 此外，在存储订单行项目时，您是否会将 product_ipods 中的行存储为行项目？

`products`在 line-items 表中，存储产品 id，它在表和表中应该是相同的值`product_ipods`。

* * *

来自@dcolumbus 的评论：

> 这对我来说似乎是多余的......在那种情况下，我没有看到子表的意义。但即使子表确实有意义，连接是`id`什么？

子表的重点是存储所有其他产品类型不需要的列。

连接 id 可以是一个自动递增的数字。子类型表不需要自动增加自己的id，因为它可以使用超级表生成的值。

```
CREATE TABLE products (
  product_id INT AUTO_INCREMENT PRIMARY KEY,
  sku VARCHAR(30) NOT NULL,
  name VARCHAR(100) NOT NULL,
  price NUMERIC(9,2) NOT NULL
);

CREATE TABLE product_ipods (
  product_id INT PRIMARY KEY,
  size TINYINT DEFAULT 16,
  color VARCHAR(10) DEFAULT 'silver',
  FOREIGN KEY (product_id) REFERENCES products(product_id)
);

INSERT INTO products (sku, name, price) VALUES ('IPODS1C1', 'iPod Touch', 229.00);
INSERT INTO product_ipods VALUES (LAST_INSERT_ID(), 16, 'silver');
INSERT INTO products (sku, name, price) VALUES ('IPODS1C2', 'iPod Touch', 229.00);
INSERT INTO product_ipods VALUES (LAST_INSERT_ID(), 16, 'black');
INSERT INTO products (sku, name, price) VALUES ('IPODS1C3', 'iPod Touch', 229.00);
INSERT INTO product_ipods VALUES (LAST_INSERT_ID(), 16, 'red');
INSERT INTO products (sku, name, price) VALUES ('IPODS2C1', 'iPod Touch', 299.00);
INSERT INTO product_ipods VALUES (LAST_INSERT_ID(), 32, 'silver');
INSERT INTO products (sku, name, price) VALUES ('IPODS2C2', 'iPod Touch', 299.00);
INSERT INTO product_ipods VALUES (LAST_INSERT_ID(), 32, 'silver');
INSERT INTO products (sku, name, price) VALUES ('IPODS2C3', 'iPod Touch', 299.00);
INSERT INTO product_ipods VALUES (LAST_INSERT_ID(), 32, 'red'); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-19T17:50:54.300

分组并不容易，因为您将在“颜色”上使用什么聚合运算符？请注意，不能在案例 2 上使用您的要求 4。

在任何情况下，聚合只是因为数据类型的变化而变得困难，并且可以通过以更类型安全的方式接近它来缓解 - 知道添加苹果和橙子永远没有意义。

这是经典的 EAV 模型，它在精心设计的数据库中占有一席之地。为了使它更安全一点，我已经看到了将值存储在类型安全表中而不是单个自由格式 varchar 列中的情况。

而不是价值观：

```
EntityID int
,AttributeID int
,Value varchar(255) 
```

您有多个表：

```
EntityID int
,AttributeID int
,ValueMoney money

EntityID int
,AttributeID int
,ValueInt int

etc. 
```

然后获取每代 iPod 容量：

```
SELECT vG.ValueVarChar AS Generation, SUM(vC.ValueDecimal) AS TotalCapacity
FROM Products AS p
INNER JOIN Attributes AS aG
    ON aG.AttributeName = 'generation'
INNER JOIN ValueVarChar AS vG
    ON vG.EntityID = p.ProductID
    AND vG.AttributeID = aG.AttributeID
INNER JOIN Attributes AS aC
    ON aC.AttributeName = 'capacity'
INNER JOIN ValueDecimal AS vC
    ON vC.EntityID = p.ProductID
    AND vC.AttributeID = aC.AttributeID
GROUP BY vG.ValueVarChar 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-19T17:37:23.850

通过在用户执行操作时添加/删除列来为新产品创建表和更改表。使用模式来了解每个产品具有哪些属性。这满足了您的所有四个要求。

您还需要一个表来存储其他表名称或在表前加上您可以针对表的 sysobjects 查询的内容：

```
select [name] from sysobjects where [name] like 'product_%' AND xtype='U' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-19T17:42:50.003

听起来您正在寻找设计产品目录数据库。

我推荐这种方法。 [http://edocs.bea.com/wlp/docs40/catalog/schemcat.htm](http://edocs.bea.com/wlp/docs40/catalog/schemcat.htm)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-11-16T07:43:28.763

我想知道如何克服使用 BLOB 模式代替 EAV 的问题。假设我们可以将实体的所有自定义字段作为字符串存储在一个字段中，例如在 JSON 中类似于 tihis: {customField1: value1, customField2: value2, ..., customFieldN: valueN}

如何克服以下问题： 1\. 如何通过单独的自定义字段进行搜索，例如查找条件为 custField1 = value1 AND customField2 = value2 的实体？2.如何保持数据完整性，例如，如果我们删除实体的自定义字段，如何删除实体中这些自定义字段的所有值。

# .net - Outlook 界面中的表单控件

> ID：884057
> 
> 赞同：1
> 
> 时间：2009-05-19T17:26:37.870
> 
> 标签：.net, winforms, outlook

我想制作一个看起来像 Outlook 的界面。在中心窗格中，Outlook 包含一个样式列表，其中包含多行格式化文本和图标。我将使用什么控件来实现此效果？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-19T17:29:17.337

这个完全可以用谷歌搜索：[http ://www.google.com/search?q=c%23+outlook+style+listview+control](http://www.google.com/search?q=c%23+outlook+style+listview+control)

# outlook - 加载项如何在 Outlook 2007 中添加 NavigationModule？

> ID：884063
> 
> 赞同：0
> 
> 时间：2009-05-19T17:28:05.483
> 
> 标签：outlook

如何将 NavigationModule 连接到 Outlook 2007 导航窗格？我想通过 API 来做，但其他解决方案也很好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-20T10:50:34.403

这不能通过 OOM 完成，您实际上只有表单区域，我猜这可能不符合要求。

它可以通过子类化和挂钩在 win api 级别调整事件大小来完成。

# python - 什么是 Python 中的奇异函数签名？

> ID：884068
> 
> 赞同：3
> 
> 时间：2009-05-19T17:28:52.173
> 
> 标签：python

我最近看到了[对“外来签名”的引用](http://pypi.python.org/pypi/decorator/)以及它们在 2.6 中已被弃用（并在 3.0 中删除）的事实。给出的例子是

```
def exotic_signature((x, y)=(1,2)): return x+y 
```

是什么让它成为“异国情调”的签名？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-19T17:31:20.987

奇怪的是 x 和 y 表示一个函数参数，它被解压缩成两个值…… x 和 y。它相当于：

```
def func(n):
    x, y = n
    ... 
```

这两个函数都需要一个包含两个元素的参数（列表或元组）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-19T17:41:57.400

有关元组参数解包（以及为什么将其删除）的更多信息：http: [//www.python.org/dev/peps/pep-3113/](http://www.python.org/dev/peps/pep-3113/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-19T22:11:11.057

这是一个稍微复杂一点的例子。假设您正在进行某种图形编程，并且您有一个点列表。

```
points = [(1,2), (-3,1), (4,-2), (-1,5), (3,3)] 
```

你想知道它们离原点有多远。你可以定义一个这样的函数：

```
def magnitude((x,y)):
    return (x**2 + y**2)**0.5 
```

然后你可以找到你的点与（0,0）的距离为：

```
map(magnitude, points) 
```

...好吧，至少，你可以在 python 2.x 中:-)

# asp.net - 将域别名映射到 IIS6 中的虚拟文件夹

> ID：884072
> 
> 赞同：0
> 
> 时间：2009-05-19T17:30:30.207
> 
> 标签：asp.net, iis, mod-rewrite

我怎么能去映射一个域别名，例如`domainAlias.co.za`，映射到一个虚拟文件夹，例如`mainDomain.co.za`，以便所有请求`domainAlias.co.za`实际得到服务`mainDomain.co.za/domainAlias`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-15T01:09:21.493

像[IIRF](http://iirf.codeplex.com)这样的 URL 重写器可以让你做到这一点。

规则是：

```
RewriteCond %{HTTP_HOST}  ^(?!mainDomain)([^\.]+)\.co\.za$
RewriteRule ^/(.*)$       /%1/$1   [L] 
```

在英语中，这条规则说：如果主机不是 maindomain.co.za，但仍以 .co.za 结尾，则重写 URL，使其以 /domainAlias/ 开头。使用此规则，您将获得：

```
input                         output
-----                         ------
http://foo.co.za/a.php        http://main.co.za/foo/a.php
http://foo.co.za/a.aspx?r=1   http://main.co.za/foo/a.aspx?r=1 
```

您还可以更进一步，以目录的存在为条件进行重写，如下所示：

```
RewriteCond %{HTTP_HOST}   ^(?!mainDomain)([^\.]+)\.co\.za$
RewriteCond c:\wwwroot\%1  -d
RewriteRule ^/(.*)$        /%1/$1   [L] 
```

这表示：如果主机不是 maindomain.co.za，并且目录 c:\wwwroot\domainAlias 存在，则重写以添加...。

但在这种情况下，您可能想要做相反的事情 - 测试目录是否存在 - 并重定向到 404：

```
RewriteCond %{HTTP_HOST}   ^(?!mainDomain)([^\.]+)\.co\.za$
RewriteCond c:\wwwroot\%1  !-d
RewriteRule ^/(.*)$        -   [NF] 
```

NF = 404

你也可以做 [F] 这是一个 503（禁止）。

IIRF 适用于 IIS5、IIS6 或 IIS7。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-19T17:44:10.110

您可以使用路由。

```
System.Web.Routing 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-19T21:31:52.570

我没用过，但是 IIS 有一个[URL Rewrite Module](http://learn.iis.net/page.aspx/460/using-url-rewrite-module/)可以[导入 Apache mod_rewrite rules](http://learn.iis.net/page.aspx/470/importing-apache-modrewrite-rules/)。还有一个比较[IIS URL Rewriting 和 ASP.NET routing](http://learn.iis.net/page.aspx/496/iis-url-rewriting-and-aspnet-routing/)的文档。通过一些研究，你应该能够让它发挥作用。

# visual-studio-2008 - Visual Studio - 自动实现从接口继承的所有方法

> ID：884075
> 
> 赞同：21
> 
> 时间：2009-05-19T17:32:23.403
> 
> 标签：visual-studio-2008, inheritance, interface

假设我们有一个名为 MyClass 的类。

```
public class MyClass 
```

我们也有一个这样的界面：

```
public interface MyInterface{

public string SomeFunction(int foo, string bar, short baz){}
} 
```

我们希望这个类继承自 MyInterface。

```
public class MyClass: MyInterface 
```

MyInterface 有*n 个*属性和*i*个方法。如何让 Visual Studio 自动实现所有这些方法和属性，而无需开发人员做任何跑腿工作？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2009-05-19T17:36:25.487

对于 C#，您可以右键单击“MyInterface”并从上下文菜单中选择“Implement Interface”。我相信 VB.NET 有一个类似（但略有不同）的快捷方式。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2011-12-07T04:45:02.213

您可以简单地使用快捷键“CTR+”。要做到这一点。将光标放在“public class MyClass: MyInterface”行的 MyInterface 上，然后按“CTR+.”，将出现一个上下文菜单，其中包含“Implement Interface ...”。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-04-02T09:53:38.547

要自动实现从接口继承的所有方法：

C#：只需右键单击接口（前缀为'I'）名称并选择实现接口选项。

VB.NET：只需将光标指向接口（前缀为'I'）名称并按Enter。

享受！！！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-19T17:36:32.727

这是 Visual Studio 中宏的工作。 [这是一个对抽象类执行类似操作的示例。](http://www.codeproject.com/KB/macros/abstractimplementation.aspx) 这应该足以让你继续前进。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-09-07T21:09:03.290

在 Visual Studio 2013 中，您可以右键单击接口并选择“实现接口”。它将使用 NotImplmentedException 为您生成所有方法。

# state-machine - 状态机：如何在没有外部事件（瞬态）的情况下改变状态？

> ID：884081
> 
> 赞同：3
> 
> 时间：2009-05-19T17:34:27.957
> 
> 标签：state-machine

场景：
我有一个简单的状态机：

**快乐之路：**

```
Uninitialized->Initialized->InProgress->Done 
```

**不开心的路：**

```
Uninitialized->Initialized->Error 
```

简而言之，我需要在**没有外部事件/触发器的情况下进行**转换（进入 InProgress 或 Error 状态） 。即初始化状态应立即导致这些状态之一。

问题：

1.  从**Initialized.Enter()**中引起状态转换是否可以？
2.  我可以使用**状态守卫**来做到这一点，但我宁愿在状态守卫中没有非平凡的逻辑（并且初始化很可能很复杂）。
3.  如果不行，我该怎么做？
4.  我是否应该一起从 FSM 中做出这个决定，并让其他一些组件导致适当的过渡？但是，我是否还必须从**Initialized.Enter()**中调用该外部组件？所以它什么也没解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-19T19:25:50.110

在状态机中，下一个状态是输入和当前状态的组合逻辑函数。

在您所描述的情况下，相同的原因（`Initialized`状态）似乎能够触发两种不同的效果（`InProgress`或`Error`状态）。我想有一个隐藏的输入，其值会有所不同。我也猜想这个输入是在从`Uninitialized`到的转换过程中收到的`Initialized`。

因此我会有一个不同的模型：

```
Uninitialized -> Successfully initialized -> InProgress -> Done
             \
              `-> Failed Initialization -> Error 
```

可能`Successfully initialized`与`InProgress`和`Failed initialization`结合`Error`。

* * *

**编辑**：从您的评论中，我了解到隐藏的输入实际上是一个动作的结果（设备初始化）。以您的模型为例，我假设初始化发生在`Initialized`状态（我们称之为`Initializing`）。这样，设备的结果就是您的外部事件，它将触发 to`InProgress`或 to 的转换`Error`。

因此，请保留您的状态机并简单地将结果添加`device.Initialize()`到输入或外部事件列表中。

# c# - 使用 MEF Preview 5 导入带有特定元数据的零件

> ID：884083
> 
> 赞同：3
> 
> 时间：2009-05-19T17:35:07.237
> 
> 标签：c#, mef

我在 MEF 预览版 5 中有如下定义的导出

```
[ExportMetadata("Application", "CheckFolderApplication")]
[Export(typeof(ExtendedArtifactBase))]
public class CheckFolderArtifact2 : ExtendedArtifactBase
{ ... 
```

然后我**只**想要那些带有“Application”“CheckFolderApplication”元数据的导入。为此，我阅读*了所有*导入，然后过滤结果。

```
[Import(typeof(ExtendedApplicationBase))]
private ExportCollection<IApplication> _applications { get; set; }

public IApplication GetApplication(string applicationName)
{
    return _applications.Single(a => a.GetExportedObject().Name == applicationName).GetExportedObject();
 } 
```

这感觉真的很没效率。如果我有数千个插件怎么办？我是否必须通过 MEF 全部阅读它们才能获得一个具有正确元数据的插件？如果是这样，您如何缓存结果？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-19T20:59:38.313

是的，在这种情况下，您必须自己进行过滤。

要缓存结果，您可以将其存储在另一个私有变量中。如果您想支持重组（您必须将导入属性的 AllowRecomposition 属性设置为 true），那么您可以在您的类上实现 IPartImportsSatisfiedNotification，并且只要设置了导入，就会调用接口的 OnImportsSatisfied 方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-04-28T20:34:25.810

我发现自己想做类似的事情。我最终导入了 Lazy 并对元数据进行过滤，希望以此避免提前实例化实际对象。

```
[ImportMany(typeof(MyInterface))]
List<Lazy<MyInterface,MyMetadataType>> MyGuys { get; set; } 
```

（并且使用强类型元数据 - 我还使用了可以创建具有只读获取的接口 MyMetadataType 并传递它而不是设置 TMetadata = IDictionary 的功能）

我想MEF仍然必须至少读取所有“数千个插件”的元数据......

# ruby-on-rails - 脚本/插件应该创建一个 .git 文件夹吗？

> ID：884086
> 
> 赞同：0
> 
> 时间：2009-05-19T17:36:05.317
> 
> 标签：ruby-on-rails, git, plugins

我注意到，如果我执行以下操作：

```
script/plugin install git://github.com/plug-xyz.git 
```

它说它正在创建一个 .git 文件夹：

```
Initialized empty Git repository in /Users/g/Documents/app/vendor/plugins/xyz/.git/ 
```

但是插件安装后，.git 文件夹好像没有了。

我问是因为当我尝试更新插件时，没有任何反应。它说它正在更新，但是当我检查文件时，它们还没有更新到最新版本。然后我删除了插件，重新安装它，它能够获取最新版本。

不能对 git 插件执行脚本/插件更新吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-19T17:42:20.830

您可以在此处查看变更集：http: [//dev.rubyonrails.org/changeset/9049](http://dev.rubyonrails.org/changeset/9049)

它确实删除了 .git 文件夹，大概是为了通过不存储历史记录来节省空间。这对于源代码控制“安装”而不是“签出”或“克隆”命令来说是传统的，尽管它不使用假设的“git install”命令来执行此操作。

`script/plugin update``.svn`在每个插件中查找目录，以便它可以运行`svn update`。`.git`无论文件夹是否已被删除，这显然不适用于 git checkouts 。您应该编辑该脚本并向他们发送补丁以启用 git 版本的更新。这可能是一个非常简单的改变。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-20T12:27:00.047

.git 文件夹已被删除，因此它不会被检入您自己的 SCM。例如，不是每个人都使用 Git 作为他们的 SCM（我是其中之一）并且出于显而易见的原因不想将 .git 存储库签入我自己的存储库。

根据脚本/插件吐出的帮助，-x 选项将添加 SVN 外部。我发现[这](http://panthersoftware.com/articles/view/3/svn-s-svn-externals-to-git-s-submodule-for-rails-plugins) [两篇](http://panthersoftware.com/articles/view/4/git-svn-dcommit-workaround-for-git-submodules)文章解决了这个特定问题，但由于我不使用 .git，所以没有尝试过解决方案

# wxwidgets - 获取 wxTextCtrl 点击事件的简单方法？

> ID：884093
> 
> 赞同：5
> 
> 时间：2009-05-19T17:36:52.867
> 
> 标签：wxwidgets, wxtextctrl

当用户单击 wxTextCtrl 时，是否有一种简单的方法来处理？阅读文档[wxTextCtrl](http://docs.wxwidgets.org/2.8.4/wx_wxtextctrl.html)后，我发现没有单击或双击事件。我知道从问题[wxWidgets: Detecting click event on custom controls](https://stackoverflow.com/questions/98941/wxwidgets-detecting-click-event-on-custom-controls)中 wxWidgets 中没有“点击”事件之类的东西，所以一个简单的鼠标按下事件就可以了。

**示例答案：**

来自：[wx wiki](http://wiki.wxwidgets.org/WxTaskBarIcon)

```
 textCtrl->Connect(wxEVT_LEFT_DOWN,
              wxMouseEventHandler(MyClass::OnClick), NULL, this ); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-19T17:48:04.473

您是否尝试为您的文本控件处理*wxEVT_LEFT_DOWN*和*wxEVT_LEFT_UP事件？*通过将它们添加到静态消息映射，或者通过调用处理程序方法的*Connect()*。

**编辑：**

并非所有事件都列在类的文档中。您还需要在层次结构中向上，从*wxTextCtrl*到*wxControl*到*wxWindow*。不幸的是，我在这两个类中都找不到鼠标事件的文档。即使没有明确记录，仍然应该可以处理它们。

# php - 多语言php脚本问题

> ID：884097
> 
> 赞同：0
> 
> 时间：2009-05-19T17:38:24.457
> 
> 标签：php, cookies, multilingual

我有这个 PHP 脚本。这是唯一对我有用的：

```
<?php
/*Check_if_user_has_changed_language: */
if(isset($lang)){/*If_so:*/
    setcookie("ling",$lang,time()-60*60*24*365,"/",".sayip.info",0);/*Wipe_previous_cookie*/
    setcookie("ling",$lang,time()+60*60*24*365,"/",".sayip.info",0);/*Whatever_the_means_lang_has_been_stored,_store_latest_lang_in_new_cookie:*/
    //echo "<script language=\"JavaScript\">alert('Selected language=$lang')</script>";/*UnComment_to_check*/
}else{/*If_user_has_NOT_changed_language:*/
    if(isset($_COOKIE['ling'])){/*Check_if_user-language_cookie_is_set._If_so:*/
        $lang=$_COOKIE['ling'];
        setcookie("ling",$lang,time()-60*60*24*365,"/",".sayip.info",0);/*Wipe_previous_cookie*/
        setcookie("ling",$lang,time()+60*60*24*365,"/",".sayip.info",0);
        //echo "<script language=\"JavaScript\">alert('Cookie language=$lang')</script>";/*UnComment_to_check*/
    }else{/*If_user-language_neither_selected_nor_in_cookie,_choose_browser_language:*/
        $lang = substr($_SERVER['HTTP_ACCEPT_LANGUAGE'],0,2);
        setcookie("ling",$lang,time()+60*60*24*365,"/",".sayip.info",0);
        //echo "<script language=\"JavaScript\">alert('Your browser language=$lang')</script>";/*UnComment_to_check*/
    }
}
?> 
```

首先，代码检测用户浏览器的语言。没关系。

然后将信息存储在 cookie 中。没关系。

好吧，在这段代码中一切正常。我真正需要的是为访问者创建一个更改语言的选项。我在想像链接的标志图像这样的东西，所以当有人点击标志时，它会改变语言。

有人可以通过一个例子甚至一个干净、完整的解决方案向我解释吗？我的PHP技能很差。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-19T17:42:47.117

我会将所选语言放在 URL 中，例如. 这使得所选语言透明且易于更改。`http://example.com/`**`en`**`/foo/bar`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-19T18:05:30.687

如果我知道如何大声笑，我会提出来......因为我在测试或多或少 10 个不同的脚本后让这个脚本工作，我不喜欢退缩，只需要一个如何放置标志以及当有人点击标志时的示例它改变了cookie的价值......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-19T20:45:28.450

我不确定你的问题是否正确

如果您要在页面中为每种语言放置一个链接，请将链接设置为 [http://www.example.com/?lang=jp](http://www.example.com/?lang=jp)

然后在您发布的脚本之前的 php 代码中添加

```
if (isset($_GET['lang'])) $lang = $_GET['lang']; 
```

这是你说的吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-20T05:07:05.033

一个更优雅的解决方案可能是检查用户的标题。 *大多数*浏览器将允许用户在首选项中设置他们的首选语言。这又会随请求发送一个 HTTP 标头。标题看起来像这样。

接受语言：en-us,en;q=0.8,ar-ly;q=0.5,id;q=0.3

该值是接受语言的逗号分隔列表，按首选项排序（ q=x 部分是首选项）。通过这种方式，您可以自动检测用户选择查看网络的语言，并在您拥有它时显示它。

# xml - 在 Actionscript 2 中递归解析 XML

> ID：884100
> 
> 赞同：1
> 
> 时间：2009-05-19T17:38:51.757
> 
> 标签：xml, recursion, actionscript-2, code-reuse

我正在寻找一种有效且可重用的方法来将 xml 解析为 actionscript2 中的对象。xml 结构本身可能会发生变化，因此重要的是我能够在没有“硬编码”特定节点等的情况下解析 xml。

我通常使用 As3 并且不需要这样的东西，因为 XML 类很容易深入研究。下面是我想要完成的 AS3 伪代码。

```
 public function XmlObject(myXmlObject:XML,_node:String):Object
    {
        var xmlObj:Object=new Object();

        for(var node:uint=0;node<myXmlObject[_node].children().length();node++)
        {
            var attributesList:XMLList=myXmlObject[_node].children()[node].attributes();
            var nodeName:String=myXmlObject[_node].children()[node].name(); 

            switch(attributesList.length()>1)
            {
                //////////////////////
                case false:
                //////////////////////
                {
                  for each(var attribute:XML in attributesList)
                  { 
                    xmlObj[nodeName]=attribute;
                  } 
                break;

                //////////////////////
                case true:
                //////////////////////
                var values:Array=[];
                for each(attribute in attributesList)
                {
                    values.push(attribute);
                    xmlObj[nodeName][String(attribute.name())]=attribute;
                }   
                break;
            }
        }
    return xmlObj;
    } 
```

提前感谢您对此的任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T16:46:56.467

我没有完全理解你的伪代码......数组会发生什么`values`？似乎被简单地丢弃了......而且，它似乎不是递归的......

问题是，XML 和 ECMA 对象的语义不同......

你会把它映射到什么？

```
<cart><item /><item /></cart> 
```

然后，这会是什么？

```
<cart><item /><cart> 
```

这是什么？

```
<cart /> 
```

问题是，在第一种情况下，你有一个数组，在第二种情况下，有一个属性，在第三种情况下什么都没有......所以你不知道，`cart.item`会是什么......即使你说，那个单个子节点将被包装到一个数组中，你仍然可以没有条目，因此`cart.item`是`null`......如果你访问属性，as2 不会抱怨，`null`但是，这很丑陋......

e4x 似乎是从 ECMA 世界中遍历 XML 对象的最佳方式……经过一番思考，我整理了一个小（相当 hacky）库：[http](http://code.google.com/p/as24x/) ://code.google.com/p/as24x/ 不过，您可以在 google 上找到其他支持更多功能的库……它与语法有关……

希望这可以帮助 ;）

问候

back2dos

# java - Java中的范围滑块

> ID：884112
> 
> 赞同：4
> 
> 时间：2009-05-19T17:41:42.690
> 
> 标签：java

嗨，我想知道是否有人听说过提供范围滑块的 Java 组件。一个滑块，即具有两个旋钮，用于定义最小最大值的范围，而不仅仅是一个。

我在网上找到了 perfuse 库中的 JRangeSlider，但我有两个问题。

首先（但不是那么重要）是它有自己的视觉风格，不会改变和融入使用的外观和感觉。

第二个（对我的应用程序来说非常重要）是当你在它上面设置启用（假）时，什么也没有发生！您仍然可以使用滑块。我想禁用它的原因是我有一个新线程在我的程序中的某个时刻运行，它改变了范围滑块也会影响的值。我想在我的线程运行时简单地禁用滑块，然后再启用它。

有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-11-04T15:50:45.827

我相信您使用的是旧版本的 RangeSlider。如果您仍然需要它，请确保查看最新版本。这是它在不同外观下的屏幕截图。关于外观不太好，我们现在使用的外观和您正在使用的 L&F 的 JSlider 相同。下面的屏幕截图分别来自 Windows 7、Mac OS X Aqua、Windows XP 和 Metal。

[JIDE Common Layer 的 RangeSlider 截图](http://www.jidesoft.com/images/rangeslider.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-19T17:56:23.090

`RangeSlider`JIDE在其[Common Layer](http://www.jidesoft.com/products/oss.htm)中有一个开源项目。您可以通过下载 JIDE 的[webstart demo](http://www.jidesoft.com/products/download.htm)来试用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-04T23:15:50.387

除了提到的内容之外，我不知道任何其他内容，但对您的第二个问题的建议是在禁用它的同时将模型更改为静态模型（具有合适的值）。这样就可以保证不会更新。启用它时，请记住将其切换回原始模型。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-19T17:46:01.233

我不确定你的应用程序的外观和感觉是什么......但你总是可以给 BiSlider 一个机会：

[bislider：BiSlider 主页](https://bislider.dev.java.net/)

# apache-flex - Flex Charting：仅显示特定系列的数据提示？

> ID：884123
> 
> 赞同：6
> 
> 时间：2009-05-19T17:42:53.077
> 
> 标签：apache-flex

我有一个`LineChart`包含多个系列的`LineSeries`和`PlotSeries`，并且我有一个`dataTipFunction`图表的自定义集。但是，我只希望为线系列显示数据提示，而不是情节系列。我尝试`null`从我的格式函数返回，但它只显示一个空框。我还尝试在情节系列上禁用鼠标事件（通过同时设置`mouseEnabled`和） `mouseFocusEnabled`，`false`但无济于事。这甚至可能吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-19T20:08:37.417

您可以将`interactive`*Series 的属性设置为`false`

```
<mx:series>
    <mx:LineSeries yField="Profit" form="curve" displayName="Profit"/>
    <mx:LineSeries yField="Expenses" form="curve" displayName="Expenses"/>
    <mx:LineSeries yField="Amount" form="curve" displayName="Amount"/>
    <mx:PlotSeries yField="Amount" interactive="false"/>
</mx:series> 
```

# windows - 如何使 iCacls 在文件夹级别授予访问权限以便可以继承它？

> ID：884132
> 
> 赞同：5
> 
> 时间：2009-05-19T17:44:35.430
> 
> 标签：windows, authentication

使用命令：

```
iCACLS.exe \\server\serverroot\siteroot /grant:r domain\id:RX /T /C 
```

我可以授予对站点根文件夹中每个文件的访问权限，但该文件夹本身不接收访问权限。问题是添加的任何新文件都缺乏读取访问权限，直到再次运行该命令。我不明白什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-30T05:59:25.300

文件夹本身没有获得访问权的原因是因为我没有告诉 iCacls 我希望它使访问权可继承。命令应该是：

```
iCACLS.exe \\server\serverroot\siteroot /grant:r domain\id:(OI)(CI)(RX) /T /C 
```

完全满足我的需要（并且出于可预见的原因。我喜欢这样。）

# silverlight - 应用主题时，Silverlight 边框对象不可见？

> ID：884133
> 
> 赞同：0
> 
> 时间：2009-05-19T17:44:51.763
> 
> 标签：silverlight, xaml, themes, border

我已将 Silverlight Toolkit 主题之一应用到我的 XAML 页面，现在由于某种原因我的 Border 对象没有显示。这是设计使然吗？我已确保明确声明与主题背景形成对比的 BorderBrush 颜色，但这并不能解决问题。

如果有帮助，我使用的主题是 Silverlight Toolkit 中的 BureauBlack 主题。这是我的一个边框的代码片段。

```
 <Border VerticalAlignment="Top" Grid.Column="0" Grid.Row="2" Grid.RowSpan="2" BorderBrush="Orange"  CornerRadius="10" Margin="0" Height="300">
        <StackPanel>
            <TextBlock Text="Status Panel" FontSize="20" TextAlignment="Center" />
            ...
        </StackPanel>
 </Border> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-19T20:38:17.530

看起来当加载主题时，它会为大多数对象属性加载自己的默认值集。在这种情况下，边框对象的 BorderThickness 属性默认为 0。因此您看不到它。

通过显式地给 BorderThickness 属性一个值（当然非零），我的边框就出现了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-19T20:56:25.840

另外，我可以推荐[Silverlight Spy](http://silverlightspy.com/silverlightspy/download-silverlight-spy/)工具。Silverlight Spy 的功能之一是提供所有控件的树，显示它们的所有属性并提供动态更改它们的能力。它大大减少了解决此类问题的时间。在像你这样的情况下，我已经多次使用它。

# sql-server - 如何让这个查询返回 0 而不是 null？

> ID：884135
> 
> 赞同：5
> 
> 时间：2009-05-19T17:45:05.790
> 
> 标签：sql-server, tsql

我有这个查询：

```
SELECT (SUM(tblTransaction.AmountPaid) - SUM(tblTransaction.AmountCharged)) AS TenantBalance, tblTransaction.TenantID
    FROM tblTransaction
    GROUP BY tblTransaction.TenantID 
```

但它有一个问题；还有其他没有交易的 TenantID，我也想获得这些。

例如，事务表中 bob 有 3 行，john 有 2 行，jane 没有。我希望它返回 bob 和 john 的总和，并为 jane 返回 0。（或者如果没有其他方法，可能为 null）

我怎样才能做到这一点？

表格是这样的：

```
租户  
  ID  
  其他数据  
交易  
  ID  
  TenantID（转至租户）
  其他数据  

```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-19T17:48:01.543

（您没有说明您的 sql 引擎，所以我将链接到 MySQL 文档）。

这几乎正​​是该[`COALESCE()`](http://dev.mysql.com/doc/refman/5.1/en/comparison-operators.html#function_coalesce)功能的用途。你可以给它一个列表，它会返回列表中的第一个非空值。您将在查询中使用它，如下所示：

```
SELECT COALESCE((SUM(tr.AmountPaid) - SUM(tr.AmountCharged)), 0) AS TenantBalance, te.ID
FROM tblTenant AS te
    LEFT JOIN tblTransaction AS tr ON (tr.TenantID = te.ID)
GROUP BY te.ID; 
```

这样，如果`SUM()`结果为 NULL，则将其替换为零。

**已编辑**：我使用 LEFT JOIN 和 重写了查询`COALESCE()`，我认为这是您最初缺少的关键。如果仅从 Transactions 表中进行选择，则无法获取有关表中**未**包含的事物的信息。但是，通过使用租户表中的左连接，您应该为每个现有租户获得一行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-19T18:25:58.207

以下是该问题的完整演练。还包含函数 isnull 以确保为没有交易的租户返回零余额（而不是 null）。

```
create table tblTenant
(
    ID int identity(1,1) primary key not null,
    Name varchar(100)
);

create table tblTransaction
(
    ID  int identity(1,1) primary key not null,
    tblTenantID int,
    AmountPaid  money,
    AmountCharged money
);

insert into tblTenant(Name)
select 'bob' union all select 'Jane' union all select 'john';

insert into tblTransaction(tblTenantID,AmountPaid, AmountCharged)
select 1,5.00,10.00
union all
select 1,10.00,10.00
union all
select 1,10.00,10.00
union all
select 2,10.00,15.00
union all 
select 2,15.00,15.00

select * from tblTenant
select * from tblTransaction

SELECT 
    tenant.ID, 
    tenant.Name,
    isnull(SUM(Trans.AmountPaid) - SUM(Trans.AmountCharged),0) AS Balance 
FROM tblTenant tenant
    LEFT JOIN tblTransaction Trans ON 
        tenant.ID = Trans.tblTenantID
GROUP BY tenant.ID, tenant.Name;

drop table tblTenant;
drop table tblTransaction; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-19T17:50:12.460

```
Select Tenants.ID, ISNULL((SUM(tblTransaction.AmountPaid) - SUM(tblTransaction.AmountCharged)), 0) AS TenantBalance
From Tenants 
Left Outer Join Transactions Tenants.ID = Transactions.TenantID
Group By Tenents.ID 
```

我没有对其进行语法检查，但它已经足够接近了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-19T17:53:37.523

```
SELECT (SUM(ISNULL(tblTransaction.AmountPaid, 0)) 
        - SUM(ISNULL(tblTransaction.AmountCharged, 0))) AS TenantBalance
       , tblTransaction.TenantID
        FROM tblTransaction
        GROUP BY tblTransaction.TenantID 
```

我只添加了这个，因为如果您打算考虑其中一个为 null 的部分，您需要单独执行 ISNULL

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-19T17:52:52.470

其实我找到了答案：

```
SELECT tenant.ID, ISNULL(SUM(trans.AmountPaid) - SUM(trans.AmountCharged),0) AS Balance FROM tblTenant tenant
LEFT JOIN tblTransaction trans
ON tenant.ID = trans.TenantID
GROUP BY tenant.ID 
```

# facebook - 确定 Facebook 应用程序是否已从 Facebook REST API 加入书签

> ID：884137
> 
> 赞同：0
> 
> 时间：2009-05-19T17:45:23.777
> 
> 标签：facebook

我正在将 Facebook 应用程序作为 iframe 运行，并且需要发现它是否已被添加书签。我知道判断您的 Facebook 应用程序的用户是否已经安装它是微不足道的，但我如何确定他们是否已经为它添加了书签？

需要明确的是，我指的不是浏览器书签，而是 Facebook 中的书签栏。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-19T18:04:58.567

我不相信这是可能的。我在论坛上看到的理由是为了防止应用程序奖励已将应用程序添加为书签的用户，或唠叨没有添加书签的用户。

最接近的方法是在 Developer 应用程序中转到应用程序的设置，并且在 Canvas -> Bookmark URL 下有一个选项，您可以在其中指定用户单击书签时应用程序的入口点。如果未填写 URL，则默认为您的 Canvas URL。

理论上，您可以添加参数或更改书签 URL 的位置，以识别单击书签的用户。显然这并不理想，因为您无法判断用户何时删除了书签，并且用户仍然可以在不单击书签的情况下进入应用程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-12-01T16:21:43.237

问题解答：

*从 uid = facebook_id*的权限中选择书签

 *# javascript - 用于在内容周围添加 HTML 标记的 JavaScript

> ID：884140
> 
> 赞同：2
> 
> 时间：2009-05-19T17:46:12.073
> 
> 标签：javascript, html

我想知道是否可以使用 JavaScript 在 HTML 页面中的单词周围添加 <div> 标记。

我有一个 JS 搜索，它搜索一组 HTML 文件并返回包含关键字的文件列表。我希望能够在关键字周围动态添加一个 <div class="highlight"> 以使其脱颖而出。

如果执行替代搜索，则需要删除原始 <div> 并添加新的。有谁知道这是否可能？

任何提示或建议将不胜感激。

干杯，

劳里。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-19T18:53:35.943

In general you will need to parse the html code in order to ensure that you are only highlighting keywords and not invisible text or code (such as alt text attributes for images or actual markup). [If you do as Jesse Hallett suggested](https://stackoverflow.com/questions/884140/javascript-to-add-html-tags-around-content/884282#884282):

```
$('body').html($('body').html().replace(/(pretzel)/gi, '<b>$1</b>')); 
```

You will run into problems with certain keywords and documents. For example:

```
<html>
<head><title>A history of tables and tableware</title></head>
<body>
<p>The table has a fantastic history.  Consider the following:</p>
<table><tr><td>Year</td><td>Number of tables made</td></tr>
<tr><td>1999</td><td>12</td></tr>
<tr><td>2009</td><td>14</td></tr>
</table>
<img src="/images/a_grand_table.jpg" alt="A grand table from designer John Tableius">
</body>
</html> 
```

This relatively simple document might be found by searching for the word "table", but if you just replace text with wrapped text you could end up with this:

```
<<span class="highlight">table</span>><tr><td>Year</td><td>Number of <span class="highlight">table</span>s made</td></tr> 
```

and this:

```
<img src="/images/a_grand_<span class="highlight">table</span>.jpg" alt="A grand <span class="highlight">table</span> from designer John <span class="highlight">Table</span>ius"> 
```

This means you need parsed HTML. And parsing HTML is tricky. But if you can assume a certain quality control over the html documents (i.e. no open-angle-brackets without closing angle brackets, etc) then you should be able to scan the text looking for non-tag, non-attribute data that can be further-marked-up.

Here is some Javascript which can do that:

```
function highlight(word, text) {
  var result = '';

  //char currentChar;
  var csc; // current search char
  var wordPos = 0;
  var textPos = 0;
  var partialMatch = ''; // container for partial match

  var inTag = false;

  // iterate over the characters in the array
  // if we find an HTML element, ignore the element and its attributes.
  // otherwise try to match the characters to the characters in the word
  // if we find a match append the highlight text, then the word, then the close-highlight
  // otherwise, just append whatever we find.

  for (textPos = 0; textPos < text.length; textPos++) {
    csc = text.charAt(textPos);
    if (csc == '<') {
      inTag = true;
      result += partialMatch;
      partialMatch = '';
      wordPos = 0;
    }
    if (inTag) {
      result += csc ;
    } else {
      var currentChar = word.charAt(wordPos);
      if (csc == currentChar && textPos + (word.length - wordPos) <= text.length) {
        // we are matching the current word
        partialMatch += csc;
        wordPos++;
        if (wordPos == word.length) {
          // we've matched the whole word
          result += '<span class="highlight">';
          result += partialMatch;
          result += '</span>';
          wordPos = 0;
          partialMatch = '';
        }
      } else if (wordPos > 0) {
        // we thought we had a match, but we don't, so append the partial match and move on
        result += partialMatch;
        result += csc;
        partialMatch = '';
        wordPos = 0;
      } else {
        result += csc;
      }
    }

    if (inTag && csc == '>') {
      inTag = false;
    }
  }
  return result;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-19T17:51:20.320

[使用jQuery](http://www.jquery.com/)包装非常简单：

```
$('span').wrap('<div class="highlight"></div>'); // wraps spans in a b tag 
```

然后，要删除，像这样：

```
$('div.highlight').each(function(){ $(this).after( $(this).text() ); }).remove(); 
```

但是，听起来您将不得不进行一些字符串拆分，因此除非您想用某个标签（即跨度）预先包装所有单词，否则 wrap 可能不起作用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-19T18:17:49.047

DOM API 没有提供一种超级简单的方法来做到这一点。据我所知，最好的解决方案是将文本读入 JavaScript，用于`replace`进行所需的更改，然后将整个内容写回。您可以一次执行一个 HTML 节点，也可以一次修改整个节点`<body>`。

以下是它在 jQuery 中的工作方式：

```
$('body').html($('body').html().replace(/(pretzel)/gi, '<b>$1</b>')); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-19T18:23:43.450

你不能只写一个选择器来包装它吗？

```
$("* :contains('foo')").wrap("<div class='bar'></div>"); 
```

亚当编写了上面的代码来进行删除：

```
$('div.bar').each(function(){ $(this).after( $(this).text() ); }).remove(); 
```

编辑：再三考虑，第一个语句返回一个元素，该元素将用 div 标签而不是唯一的单词包装元素。也许正则表达式替换将是一个更好的解决方案。

# installshield - Installshield - 如何让 installshield 构建整个 cd？

> ID：884141
> 
> 赞同：0
> 
> 时间：2009-05-19T17:46:15.460
> 
> 标签：installshield

现在发布版本只是制作安装所需的文件。但是我想用 InstallShield 自动创建 CD 结构，这样当我转到工具时，打开发布文件夹

它有

```
\Install
\Tools
\Help
autorun.inf 
```

我查看了发布的执行批处理文件或复制到文件夹选项，我希望在 InstallShield 中有更友好的东西。

使用版本 12。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-19T20:18:10.287

我创建了一个名为 CDOnly 的功能/组件，它不可见、未选择且不复制，但确实将文件放在 Disk Images / Disk1 文件夹中。

因此，通过更改功能的默认目录并将特殊内容放入 CDOnly，我能够创建我想要的结构。

# java - 使用 javax.sql.DataSource 的实例休眠

> ID：884154
> 
> 赞同：0
> 
> 时间：2009-05-19T17:48:34.897
> 
> 标签：java, sql, hibernate

是否可以将 Hibernate 配置为使用 javax.sql.DataSource 实例？

我的应用程序已经有一个 javax.sql.DataSource 实例，我宁愿不为休眠重新配置数据库 url、用户、密码、驱动程序等。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-19T17:54:58.163

在您的 hibernate.cfg.xml 中：

```
<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE hibernate-configuration PUBLIC
          "-//Hibernate/Hibernate Configuration DTD 3.0//EN"
          "http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd">

<hibernate-configuration>
    <session-factory>
        <property name="dialect">
            org.hibernate.dialect.MySQLDialect
        </property>    
        <property name="connection.datasource">SampleDS</property>        
    </session-factory>

</hibernate-configuration> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-19T18:03:54.043

如果数据源可通过 JNDI 获得，您只需设置配置的 hibernate.connection.datasource 属性 - mtpettyp 的回答证明了这一点。

如果您不在数据源来自 JNDI 的环境中，请提供您自己的 ConnectionProvider 实现，并在构建会话工厂之前将其传递给 Settings 对象，或者在 hibernate.connection.provider_class 属性中指定其类名。如果您为 Settings 提供一个实例，您可能可以实例化标准 DatasourceConnectionProvider 并将您的 DataSource 提供给它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-19T18:03:22.487

如果您正在使用弹簧初始化和弹簧会话工厂 bean，您可以像这样简单地传递数据源

```
<bean id="sessionFactory" class="org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean">
    <property name="dataSource" ref="dataSource" />
    ...
</bean> 
```

其中 dataSource 引用在别处定义。

# sql - SQL：计算系统负载统计

> ID：884159
> 
> 赞同：1
> 
> 时间：2009-05-19T17:50:03.410
> 
> 标签：sql, statistics, load

我有一个这样的表来存储来自系统的消息：

```
Message
-------
ID (bigint)
CreateDate (datetime)
Data (varchar(255)) 
```

我被要求计算峰值负载下每秒保存的消息。我真正必须使用的唯一数据是 CreateDate。系统上的负载不是恒定的，有时我们会获得大量流量，而有时我们会获得很少的流量。我认为这个问题有两个部分：1.确定被认为是峰值负载的时间范围，2.计算这些时间段内每秒的平均消息。

这是正确的方法吗？SQL中是否有可以帮助解决这个问题的东西？任何提示将非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-19T17:56:36.757

我同意，您必须先弄清楚峰值负载是什么，然后才能开始创建报告。

我要做的第一件事是弄清楚我将如何定义峰值负载。前任。我要逐小时查看细分吗？

接下来，我将对 CreateDate 进行分组，以秒（无毫秒）为单位。作为小组的一部分，我会根据记录数进行平均。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-19T19:10:12.513

警告，这些会运行缓慢！

这会将您的数据分组到“第二个”存储桶中，并将它们从活动最多到最少列出：

```
SELECT
    CONVERT(char(19),CreateDate,120) AS CreateDateBucket,COUNT(*) AS CountOf
    FROM Message
    GROUP BY CONVERT(Char(19),CreateDate,120)
    ORDER BY 2 Desc 
```

这会将您的数据分组到“分钟”存储桶中，并将它们从活动最多到最少列出：

```
SELECT
    LEFT(CONVERT(char(19),CreateDate,120),16) AS CreateDateBucket,COUNT(*) AS CountOf
    FROM Message
    GROUP BY LEFT(CONVERT(char(19),CreateDate,120),16)
    ORDER BY 2 Desc 
```

我会采用这些值并计算他们想要的

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-19T21:24:33.817

我认为您不需要知道高峰时段。您可以使用 SQL 生成它们，包装完整的查询并选择前 20 个条目，例如：

```
select top 20 *
from (
     [...load query here...]
) qry
order by LoadPerSecond desc 
```

[这个答案](https://stackoverflow.com/questions/876842/how-to-find-the-average-time-difference-between-rows-in-a-table/877051#877051)对平均值有很好的启示。您可以通过查看每小时负载并除以 3600 来计算每秒负载。

要初步了解上周的负载，您可以尝试（Sql Server 语法）：

```
select datepart(dy,createdate) as DayOfYear,
       hour(createdate) as Hour, 
       count(*)/3600.0 as LoadPerSecond
from message
where CreateDate > dateadd(week,-7,getdate())
group by datepart(dy,createdate), hour(createdate) 
```

要找到每分钟的峰值负载：

```
select max(MessagesPerMinute)
from (
  select count(*) as MessagesPerMinute
  from message
  where CreateDate > dateadd(days,-7,getdate())
  group by datepart(dy,createdate),hour(createdate),minute(createdate)
) 
```

按 datepart(dy,...) 分组是区分日期而不用担心月份边界的简单方法。它一直有效，直到您在一年前选择更多，但这对于性能查询来说是不寻常的。

# mysql - Navicat 中的 MySQL 视图 - 如何定义“主键”？

> ID：884167
> 
> 赞同：6
> 
> 时间：2009-05-19T17:51:23.097
> 
> 标签：mysql, views, primary-key, unique-index, navicat

通常当我在 Navicat 中定义视图时，我会收到以下消息：

> xxx 没有主键。将使用以下伪语句更新此表： UPDATE xxx SET ModifiedFieldsAndValues WHERE AllFieldsAndOldValues LIMIT 1

显然我只使用我的视图来**查看**数据，而不是**更新**. 但这确实让我很好奇：

**有没有办法在视图上定义“主键”或“唯一索引”？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-19T18:00:02.397

它暗示视图使用其基表的索引和主键。您可以通过使用 CASCADING CHECK 选项来更改通过视图使用插入和更新时如何发生的语义

[查看可更新和可插入视图](http://dev.mysql.com/doc/refman/5.0/en/view-updatability.html)

# c# - 在 Windows 上显示隐藏进程？

> ID：884170
> 
> 赞同：0
> 
> 时间：2009-05-19T17:51:53.160
> 
> 标签：c#, process, window, hidden, show

我有点问题。

与我之前关于[Slipstreamed SP3 vs. patched SP3](https://serverfault.com/questions/9943/sp3-installed-vs-sp3-slipstreamed-difference-in-default-security-settings)的问题相关，我们得出的结论是，有一个 Internet Explorer 进程正在启动，指示从本地磁盘加载一个简单的 .html 文件，其中包含打开的 javascript更大的聊天/会议系统的其余部分。Internet Explorer 从 Lotus Notes 客户端启动。

不幸的是，我们只能看到 IExplore.exe 进程在任务管理器中弹出，几秒钟后又消失了。

如果我们尝试打开在磁盘上找到的本地 .html 文件，它会在顶部显示信息栏，告诉我们它已禁用活动内容。然而，这并不是真正的问题。我们有另一台具有相同设置但一切正常的机器，手动加载 .html 文件也会给我们同样的错误。

但是，从notes启动IExplore时，可能还有另一个错误信息，但是由于这个过程应该只是kickstart系统的其余部分，而这个窗口是隐藏的，我们看不到它，即错误消息/问题。

所以，我想，也许我应该尝试创建一个小程序，等待 IExplore.exe 启动，然后立即显示窗口，以便我们可以看到错误消息，或者任何问题。至少，希望我们能够看到这一点。

到目前为止一切都很好，除了如果我从我自己的程序启动一个带有隐藏窗口的进程，主窗口句柄为 0，因此我根本无法显示该窗口。我希望这个从 Lotus Notes 启动的 IExplore.exe 进程也有同样的问题。

我的监控程序是用 C# 编写的，基本上运行这个循环：

```
foreach (var process in Process.GetProcesses())
{
    if (process.ProcessName.ToLower() == "iexplore")
        result.Add(process);
} 
```

这会拾取所有 IExplore.exe 进程，无论是否有窗口，并且使用 IE8，我得到第一个窗口的 2 个进程，正如预期的那样。我一遍又一遍地运行它，并处理与以前运行的差异。

但是，该过程在开始时短暂地有一个窗口句柄 0，所以我将其更改为：

```
foreach (var process in Process.GetProcesses())
{
    if (process.ProcessName.ToLower() == "iexplore" &&
        process.MainWindowHandle != IntPtr.Zero)
    {
        result.Add(process);
    }
} 
```

但现在它根本没有拾取任何东西，即使在窗口获得句柄之后（是的，在窗口显示后 process.MainWindowHandle 确实有一个非零句柄值，但是在窗口的情况下从未显示，它保持为 0。）

所以，问题是：当它还没有窗口句柄时，我有什么办法可以利用这个隐藏的 IExplore.exe 进程并指示它显示自己？我对此表示怀疑，但也许有人可以证明我错了。

如果没有，我的备份计划是创建一个 shim IExplore.exe 程序，它将所有命令行参数转发给原始的，除了它指定要显示的窗口。这会是一个解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-19T17:59:27.843

我不相信有任何方法可以强制没有窗口句柄的 IE 窗口为自己分配窗口句柄（或使用先前分配的窗口句柄）并显示自己。

至于你的备份方法：我*认为*这会起作用，但你在那里工作在危险的领域。实际上，我建议您编写 shim 以记录 iexplore.exe 的每次调用以及其中的所有内容，并使用它来描述您的问题；只有在用完全良性的日志记录彻底描述您的问题之后，我才会建议可能修改参数以强制 iexplore.exe 显示一个窗口。

# css - 如何确定浏览器实际使用什么字体来呈现某些文本？

> ID：884177
> 
> 赞同：203
> 
> 时间：2009-05-19T17:53:05.530
> 
> 标签：css, browser, fonts

我的 CSS`font-family: Helvetica, Arial, sans-serif;`为整个页面指定“”。看起来某些部分正在使用 Verdana。我希望能够验证这一点。

我尝试从浏览器复制并粘贴到 Word 中，但它没有保留字体。

有什么方法可以确定一段文本实际使用的是哪种字体？

Firebug 会给我上面的字体列表[1]，但我看不到确定正在使用哪种字体的方法。

1.  结果发现使用了错误的列表，这解决了我最初的 Verdana 问题。但我仍然很好奇是否有办法识别实际的渲染字体。

* * *

## 回答 #1

> 赞同：175
> 
> 时间：2013-12-29T21:34:16.393

多年来，Firefox 和 Chrome 都有用于显示所有细节的内置工具，但 2021 年 10 月的 Safari 15.x 仍然需要您复制一些文本并进行调查。

## 火狐

在 Firefox 中，右键单击某些文本并选择 Inspect Element 后显示的 Page Inspector 具有[Fonts 视图](https://developer.mozilla.org/en-US/docs/Tools/Page_Inspector/How_to/Edit_fonts)：

[![Firefox 字体视图](https://i.stack.imgur.com/qA1uG.jpg)](https://i.stack.imgur.com/qA1uG.jpg)

这还将告诉您使用哪种样式，例如 Regular、ExtraLight、Italic、BoldItalic 等等。

就像上面的截图一样：

> **.SF NS**
> System 字体
> **Apple SD Gothic Neo**
> Apple SD Gothic Neo Regular

因此，您会看到您正在查看的*元素中使用的**所有*字体，即使只选择一个字形也是如此。只需将单个字体名称悬停在检查器中即可突出显示使用该特定字体的字形。悬停“Apple SD Gothic Neo Regular”很好地突出了“웃”：

 *[![Apple SD Gothic Neo Regular](https://i.stack.imgur.com/7uVJC.png)](https://i.stack.imgur.com/7uVJC.png)

悬停“系统字体”让我：

[![系统字体](https://i.stack.imgur.com/Xa4n2.png)](https://i.stack.imgur.com/Xa4n2.png)

对于网络字体，Firefox 似乎会显示 CSS 中的名称以及下载字体中的详细信息。在其“页面上的所有字体”部分中，它还说明了从哪里下载字体。

对我来说，在 2021 年 10 月，Firefox 拥有确定字体的最佳选择。但是：**并非所有浏览器都可以使用相同的字体**，所以请继续阅读！

## 铬合金

对于 Chrome，进入 DevTools 的“元素”，进入其“计算”选项卡，然后**一直向下滚动**到名为“渲染字体”的部分。与 Firefox 不同，这仅显示基本字体名称，而不是它可能使用的任何特定样式：

[![Chrome 网络检查器](https://i.stack.imgur.com/XrF8M.jpg)](https://i.stack.imgur.com/XrF8M.jpg)

对于网络字体，Chrome 仅显示“网络资源”（Firefox 显示更多详细信息）。

与 Firefox 一样，您会看到您正在查看的*元素中使用的**所有*字体，即使只选择一个字形也是如此。Chrome 确实为您提供了在所选元素中使用特定字体的字形计数，但不支持悬停以突出显示使用特定字体的字形：

 *> **.SF NS** — 本地文件（192 个字形）
> **.Apple SD Gothic NeoI** — 本地文件（1 个字形）

## 苹果浏览器

2021 年 10 月的 Safari 15 终于引入了“字体”选项卡，但它的输出非常有限。对于“身份”，它通常显示次要信息，例如“仅限 TN 网络使用”（Firefox 将其显示为评论，如“州际浓缩，仅限 TN 网络使用”）。或者什么都不显示。但是，最后，这是一个开始：

[![Safari 字体选项卡](https://i.stack.imgur.com/h8OAx.jpg)](https://i.stack.imgur.com/h8OAx.jpg)

这仅适用于元素。对于文本节点（如单个字符），不显示字体选项卡。

对于上面使用的相同示例，Safari 甚至没有表示使用了多种字体：

> **身份**
> 名称 .AppleSystemUIFont

所以，请继续阅读。

## 其他浏览器（和 Safari）

对于没有完整字体视图的 Safari 和其他浏览器，只需将文本片段复制并粘贴到某些文字处理器或富文本编辑器中，选择某些特定文本，然后查看某些字体下拉列表中显示的名称。在我的 Mac 上，这在从 Firefox 粘贴时不起作用（对于“웃”，Firefox 的“Apple SD Gothic Neo”在粘贴时转换为“AppleMyungjo”），但适用于 Safari 和 Chrome：

[![从浏览器粘贴到富文本编辑器中的文本](https://i.stack.imgur.com/zBplz.png)](https://i.stack.imgur.com/zBplz.png)

## 单个 HTML 元素中的多种字体

对于上面的截图，实际的 CSS 定义：

```
font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Liberation Sans", sans-serif; 
```

但这些字体通常不包含许多特殊字符。由于字体信息适用于每个 HTML 元素，其中元素中的 Unicode 文本实际上可以在其子文本节点中使用多种字体，因此开发人员工具也会显示多种字体。如有疑问，请将字体悬停在 Firefox 或其他浏览器中，只需双击 HTML 窗格中的文本并删除您不感兴趣的文本。然后，当再次选择周围元素时，您只需看到一个选项。

## 不同浏览器使用不同字体

不幸的是，由于浏览器支持/首选的字体类型，同一台机器上的不同浏览器（甚至单个浏览器的不同版本）可能使用不同的字体。例如，在 Mac 上，Safari 可能更喜欢 Apple Advanced Technology，而 Firefox 支持 Microsoft OpenType（在 Mac 上安装 Microsoft Office 后可能会[出现阿拉伯语问题）。](https://superuser.com/questions/66295/arabic-in-powerpoint-on-mac/66305#66305)或者对于上面屏幕截图中的“웃”字符，我 Mac 上的 Firefox 和 Chrome 现在更喜欢“Apple SD Gothic Neo”和“.Apple SD Gothic NeoI”（它们是 OpenType PostScript），但旧版本的 Firefox 使用“AppleGothic Regular” " 代替（这是一种 TrueType 字体）。

```
file /System/Library/Fonts/AppleSDGothicNeo.ttc 
/System/Library/Fonts/AppleSDGothicNeo.ttc: OpenType font collection data, 2.0, 18 fonts, at 0x60 OpenType Font data, 18 tables, 1st "BASE"

file /System/Library/Fonts/Supplemental/AppleGothic.ttf 
/System/Library/Fonts/Supplemental/AppleGothic.ttf: TrueType Font data, 18 tables, 1st "cmap", 33 names, Macintosh, Copyright ? 1994-2006 Apple Computer, Inc. All rights reserved.AppleGothicRegularAppleGothic Reg 
```

请注意，Chrome（在 Mac 上）在“NeoI”中显示前导点和尾随大写“i”，这在同一示例的 Firefox 中是缺少的。在那台 Mac 上，Font Book 显示：

[![字体书](https://i.stack.imgur.com/lpe0d.png)](https://i.stack.imgur.com/lpe0d.png)

我没有调查这意味着什么。

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2010-07-15T19:02:35.650

根据[Wilfred Hughes 的回答](https://stackoverflow.com/a/16794295/82124)，Firefox 现在本机支持此功能。[这篇文章有更多细节](https://hacks.mozilla.org/2013/04/developer-tools-update-firefox-22/)。

这个答案最初引用了“Font Finder”插件，但只是因为它是 4 年前的。旧答案像这样徘徊并且社区无法更新它们的事实是 Stack Overflow 剩下的少数失败之一。

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2013-05-28T14:11:25.763

[Firefox 22+ 将显示当前正在使用的字体](https://hacks.mozilla.org/2013/04/developer-tools-update-firefox-22/)，无需任何扩展。

* * *

## 回答 #4

> 赞同：30
> 
> 时间：2011-12-15T21:02:12.307

[**WhatFont**](https://chrome.google.com/webstore/detail/jabopobgcpjmedljpbcaablpmlmfcogm)是一个 Chrome 扩展程序，它会具体告诉您正在加载字体堆栈中的哪种字体。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2012-02-25T18:42:56.850

对于当前版本的 Firefox（自 v7 起），有一个名为“fontinfo”的附加组件将报告正在使用的实际字体（而不是 CSS font-family 属性所说的），考虑到浏览器回退到的情况不同的字体，因为请求的字体系列不可用或不支持文本中使用的字符。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-19T17:55:54.307

您可以尝试使用 Firebug for Firefox 检查该特定部分。它应该为您提供所有确切的属性。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-03-14T13:20:29.773

jeremy 提到的“FontFinder”插件似乎在这里不起作用，无论实际呈现的字体如何（Linux 上的 Firefox 4.0rc1），都给出了 CSS 列表的第一个字体。但是，以下插件似乎为您提供了“正确”的字体。

[上下文字体](https://addons.mozilla.org/en-US/firefox/addon/context-font/)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-03-30T00:58:10.317

基于来自 Lalit Patel 的文本测量方法和脚本，我创建了可以猜测当前所选文本（或，如果未选择任何文本）使用的字体的小[书签。](https://alanhogan.com/bookmarklets#font-stack-full)`body`对我来说，确定使用堆栈中的哪种字体似乎非常有效！（但它不能告诉你`sans-serif`实际映射到什么。）

在这里抓住它们： [https ://alanhogan.com/bookmarklets#font-stack-full](https://alanhogan.com/bookmarklets#font-stack-full)

源代码[在 GitHub 上](https://github.com/alanhogan/bookmarklets/blob/master/font-stack-guess.js)。

另请参阅：[此 CodePen](https://codepen.io/alanhogan/full/YZOOWv)，它使用大部分相同的代码。通过选择不同的段落并观看表格/猜测更新来尝试一下！

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-03-16T12:10:05.460

无需为此使用任何外部浏览器插件。为了检查 Google Chrome 网站上真正使用的字体，您需要：

*   打开开发人员工具（右键单击网站并选择检查）
*   在“元素”选项卡中选择所需的对象
*   选择“计算”选项卡，在底部窗格中您会看到“渲染字体”：

[![在此处输入图像描述](https://i.stack.imgur.com/Y4msv.png)](https://i.stack.imgur.com/Y4msv.png)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-05-07T04:52:12.813

您可以尝试使用[Find Website Used Fonts](https://chrome.google.com/webstore/detail/find-website-used-fonts/lnebjgioddkafaldaaeooeghlcholnnp)来识别网站或网页上使用的不同字体。它是一个免费的 chrome 扩展，还可以让您预览从网页识别的不同字体样式的您自己输入的文本。超级方便且易于使用，它也是免费的，所以这是一个主要优点。希望这可以帮助

# php - Ruby、PHP 或 Perl 可以为 Python 等代码创建预编译文件吗？

> ID：884186
> 
> 赞同：21
> 
> 时间：2009-05-19T17:54:10.190
> 
> 标签：php, ruby, perl, pre-compilation

对于 Python，它可以创建一个预编译版本 file.pyc 以便程序可以运行而无需再次解释。Ruby、PHP 和 Perl 可以在命令行上做同样的事情吗？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-05-19T21:40:57.513

Ruby 没有可移植的字节码规范，因此也没有加载预编译字节码档案的标准方法。然而，几乎所有的 Ruby 实现都使用某种字节码或 intcode 格式，其中一些可以转储和重新加载字节码档案。

[YARV](http://Ruby-Lang.Org/)总是在执行代码之前编译为字节码，但这通常只在内存中完成。有一些方法可以将字节码转储到磁盘。但是[，目前无法将其读回*。*](https://GitHub.Com/RubySpec/MatzRuby/blob/trunk/iseq.c#L1427-1429)这将在未来发生变化：YARV 字节码验证器的工作正在进行中，一旦完成，字节码可以安全地加载到 VM 中，而不必担心损坏。此外，JRuby 开发人员表示，一旦 YARV 字节码格式和验证器稳定，他们愿意[在 JRuby 中实现 YARV VM 模拟器](https://GitHub.Com/JRuby/JRuby/blob/da23e51968ffc17d750fca340f4b9538e5e2b425/src/org/jruby/ast/executable/YARVMachine.java)，以便您可以将 YARV 字节码加载到 JRuby 中。（请注意，此版本已[过时](https://GitHub.Com/JRuby/JRuby/commit/2257c8f811fab8d675a942c86ab712922dc46c6f/)。）

[Rubinius](http://Rubini.us/)也总是编译成字节码，它有一种[编译文件的格式](https://GitHub.Com/EvanPhx/Rubinius/blob/master/kernel/compiler/compiled_file.rb)（`.rbc`文件，类似于 JVM`.class`文件），还有一种字节码存档格式（`.rba`文件，类似于 JVM`.jar`文件）。如果将应用程序部署为 YARV 字节码变得流行，Rubinius 有可能实现 YARV 模拟器。此外，JRuby 开发人员表示，如果 Rubinius 字节码成为部署 Ruby 应用程序的流行方式，他们愿意[在 JRuby 中实现 Rubinius 字节码模拟器。](https://GitHub.Com/JRuby/JRuby/blob/da23e51968ffc17d750fca340f4b9538e5e2b425/src/org/jruby/ast/executable/RubiniusMachine.java)（请注意，此版本已[过时](https://GitHub.Com/JRuby/JRuby/commit/2257c8f811fab8d675a942c86ab712922dc46c6f/)。）

[XRuby](http://XRuby.GoogleCode.Com/)是一个纯编译器，它将 Ruby 源代码直接编译为 JVM 字节码（`.class`文件）。`.class`您可以像部署任何其他 Java 应用程序一样部署这些文件。

[JRuby](http://JRuby.Org/)最初是一个解释器，但它同时有一个 JIT 编译器和一个[AOT 编译器](https://GitHub.Com/JRuby/JRuby/tree/master/src/org/jruby/compiler/)（`jrubyc`），可以将 Ruby 源代码编译为 JVM 字节码（`.class`文件）。此外，正在努力创建一个[*新*的编译器，该编译器可以将 Ruby 代码编译（类型注释）为](https://GitHub.Com/JRuby/JRuby/blob/master/tool/compiler2.rb)实际上看起来像 Java 类的 JVM 字节码，并且可以无障碍地从 Java 代码中使用。

[Ruby.NET](http://RubyDotNETCompiler.GoogleCode.Com/)是一个纯编译器，可将 Ruby 源代码编译为 CIL 字节码（PE`.dll`或`.exe`文件）。您可以像部署任何其他 CLI 应用程序一样部署它们。

[IronRuby](http://IronRuby.Net/)也编译为 CIL 字节码，但通常在内存中进行。但是，您可以将[命令行开关传递给它](https://GitHub.Com/IronRuby/IronRuby/blob/master/Merlin/Main/Languages/Ruby/Ruby/Hosting/RubyOptionsParser.cs#L275-276)，因此它将`.dll`和`.exe`文件转储到磁盘。一旦你有了这些，它们就可以正常部署了。

[BlueRuby](https://SDN.SAP.Com/irj/scn/wiki?path=/display/Research/BlueRuby)自动将 Ruby 源代码预解析为 BRIL（BlueRuby 中间语言），它基本上是一个序列化的分析树。（有关详细信息，请参阅[*Blue Ruby - SAP ABAP 中的 Ruby VM*](https://SDN.SAP.Com/irj/scn/go/portal/prtroot/docs/library/uuid/408a9a3b-03f9-2b10-b29c-f0a3374b19d8) (PDF)。）

我*认为*（但我绝对不确定）有一种方法可以让[Cardinal](https://GitHub.Com/Cardinal/Cardinal/)转储[Parrot](http://ParrotCode.Org/)字节码档案。（实际上，Cardinal 只编译为 PAST，然后 Parrot 接管，因此转储和加载字节码档案将是 Parrot 的工作。）

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-05-19T18:03:28.117

Perl 5 可以将字节码转储到磁盘，但它有问题且令人讨厌。 [Perl 6](http://perlcabal.org/syn/)有一种非常简洁的方法来创建[Parrot](http://www.parrot.org/)可以运行的字节码可执行文件。

Perl 的即时编译足够快，在大多数情况下这无关紧要。一个重要的地方是在 CGI 环境中，这就是[mod_perl](http://perl.apache.org/)的用途。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-05-19T19:01:31.453

对于歇斯底里的葡萄干，Perl 5在搜索模块时`.pmc`会先于文件查找文件。`.pm`这些文件可能包含字节码，尽管 Perl 默认不写出字节码（与 Python 不同）。

[**Module::Compile（或：这个 PMC 是什么东西？）**](http://www.perlmonks.org/?node_id=536132)更深入地介绍了这个晦涩的功能。它们不经常使用，但是...

[编写Module::Compile](http://search.cpan.org/dist/Module-Compile/)的聪明人利用这一点，将 Perl 代码预编译成……好吧，它仍然是 Perl，但它是经过预处理的。

除了其他好处之外，这加快了加载时间，并且在使用源过滤器（Perl 代码在被解释器加载之前修改 Perl 源代码）时使调试更容易。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-05-19T18:00:43.893

不适用于 PHP，尽管大多数 PHP 设置都包含一个[字节码缓存](http://en.wikipedia.org/wiki/PHP_accelerator)，它将缓存已编译的字节码，以便下次脚本运行时运行已编译的版本。这大大加快了执行速度。

我不知道通过命令行实际获取字节码。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-05-19T18:03:40.223

对于 Perl，您可以尝试使用[B::Bytecode](http://perldoc.perl.org/B/Bytecode.html)和[perlcc](http://search.cpan.org/dist/B-C/script/perlcc.PL)。然而，这两者都是高度实验性的。Perl 6 即将推出（理论上）并将在 Parrot 上使用不同的字节码，因此所有这一切都将在当时没有实际意义。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-20T08:17:04.603

这是命令行的一些示例魔术词

```
perl -MO=Bytecode,-H,-o"Module.pm"c "Module.pm" 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-19T18:04:58.473

[根据Programming Perl](http://oreilly.com/catalog/pperl3/chapter/ch18.html#AUTOID-22694)的第三版，可以通过一些实验性的方式来近似这一点。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-19T18:27:13.977

如果您在 PHP 脚本上使用[Zend Guard](http://www.zend.com/en/products/guard/)，它实质上会将脚本预编译为字节码，如果加载了 Zend Optimizer 扩展，则可由 PHP 引擎运行。

所以，是的，Zend Guard/Optimizer 允许使用预编译的 PHP 脚本。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-19T18:42:44.293

对于 PHP，[Phalanger 项目](http://www.php-compiler.net/doku.php?id=core:features)编译为 .Net 程序集。我不确定这是否是你要找的。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-06-04T08:02:15.023

有没有人考虑过使用 LLVM 的字节码，而不是另一个自定义字节码？

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-19T18:05:21.500

Ruby 1.8 实际上根本不使用字节码（甚至在内部），因此没有预编译步骤。

# sql - 合并到广告订单

> ID：884187
> 
> 赞同：7
> 
> 时间：2009-05-19T17:54:33.013
> 
> 标签：sql, sql-server, tsql, sql-server-2008, merge

我有一个看起来像这样的声明：

```
MERGE INTO someTable st
USING
(
    SELECT id,field1,field2,etc FROM otherTable
) ot on st.field1=ot.field1
WHEN NOT MATCHED THEN
    INSERT (field1,field2,etc)
    VALUES (ot.field1,ot.field2,ot.etc) 
```

其中**otherTable**有一个自动递增的**id**字段。

我希望插入**someTable的顺序与****otherTable**的**id**字段的顺序相同，以便在插入不匹配的字段时保留 id 的**顺序***。*

 *****快速浏览一下[文档](http://technet.microsoft.com/en-us/library/bb510625.aspx)似乎表明没有支持这一点的功能。

这是可能的，还是有另一种方法可以满足我的要求？

编辑：一种方法是向**someTable**添加一个额外的字段来捕获排序。如果可能的话，我宁愿不这样做。

...经过反思，上述方法似乎是要走的路。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2014-04-14T11:09:32.493

I cannot speak to what the Questioner is asking for here because it doesn't make ***any*** sense.

## So let's assume a different problem:

Let's say, instead, that I have a Heap-Table with no Identity-Field, but it does have a "*Visited*" Date field.
The Heap-Table logs Person WebPage Visits and I'm loading it into my Data Warehouse.
In this Data Warehouse I'd like to use the Surrogate-Key "*WebHitID*" to reference these relationships.
Let's use Merge to do the initial load of the table, then continue calling it to keep the tables in sync.

I know that if I'm inserting records into an table, then I'd prefer the ID's (that are being generated by an Identify-Field) to be sequential based on whatever Order-By I choose (let's say the "*Visited*" Date).
It is not uncommon to expect an Integer-ID to correlate to when it was created relative to the rest of the records in the table.
I know this is not always 100% the case, but humor me for a moment.

## This is possible with Merge.

Using (what feels like a ***hack***) TOP will allow for Sorting in our Insert:

```
MERGE DW.dbo.WebHit AS Target --This table as an Identity Field called WebHitID.
USING
(
    SELECT TOP 9223372036854775807 --Biggest BigInt (to be safe).
           PWV.PersonID, PWV.WebPageID, PWV.Visited
      FROM ProdDB.dbo.Person_WebPage_Visit AS PWV
     ORDER BY PWV.Visited --Works only with TOP when inside a MERGE statement.
) AS Source
  ON Source.PersonID  = Target.PersonID
 AND Source.WebPageID = Target.WebPageID
 AND Source.Visited   = Target.Visited
WHEN NOT MATCHED BY Target THEN --Not in Target-Table, but in Source-Table.
    INSERT (PersonID, WebPageID, Visited) --This Insert populates our WebHitID.
    VALUES (Source.PersonID, Source.WebPageID, Source.Visited)
WHEN NOT MATCHED BY Source THEN --In Target-Table, but not in Source-Table.
    DELETE --In case our WebHit log in Prod is archived/trimmed to save space.
; 
```

You can see I opted to use TOP 9223372036854775807 (the biggest Integer there is) to pull everything.
If you have the resources to merge more than that, then you should be chunking it out.
While this screams "***hacky workaround***" to me, it should get you where you need to go.

I have tested this on a small sample set and verified it works. I have not studied the performance impact of it on larger complex sets of data though, so YMMV with and without the TOP.

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2015-01-13T12:17:23.467

跟进 MikeTeeVee 的回答。

使用 TOP 将允许您在子查询中进行排序，但是`TOP 9223372036854775807`我会使用

```
SELECT TOP 100 PERCENT 
```

不太可能达到这个数字，但这种方式更有意义，看起来更干净。

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2009-05-19T18:09:10.447

为什么要关心 ids 匹配的顺序？这对您查询数据的方式有什么影响？相关表应该通过主键和外键连接，而不是插入订单记录。表在数据库中并不是以特定的方式排序的。订单应该来自 order by 子句。

关于您为什么要这样做的更多解释可能会帮助我们引导您找到合适的解决方案。

# windows-vista - Vista中的.net远程处理

> ID：884204
> 
> 赞同：2
> 
> 时间：2009-05-19T17:57:05.710
> 
> 标签：windows-vista, remoting

我有一个通过.net 远程处理与 wndows 服务通信的应用程序。

在 XP 下这一切都很好，但是当我在 Vista 上运行相同的代码时，我得到了异常

```
System.Net.Sockets.SocketException: No connection could be made because the target machine actively refused it 127.0.0.1:8969

Server stack trace: 
   at System.Net.Sockets.Socket.Connect(IPAddress[] addresses, Int32 port)
   at System.Runtime.Remoting.Channels.RemoteConnection.CreateNewSocket(AddressFamily family)
   at System.Runtime.Remoting.Channels.RemoteConnection.CreateNewSocket()
   at System.Runtime.Remoting.Channels.RemoteConnection.GetSocket()
   at System.Runtime.Remoting.Channels.SocketCache.GetSocket(String machinePortAndSid, Boolean openNew)
   at System.Runtime.Remoting.Channels.Tcp.TcpClientTransportSink.SendRequestWithRetry(IMessage msg, ITransportHeaders requestHeaders, Stream requestStream)
   at System.Runtime.Remoting.Channels.Tcp.TcpClientTransportSink.ProcessMessage(IMessage msg, ITransportHeaders requestHeaders, Stream requestStream, ITransportHeaders& responseHeaders, Stream& responseStream)
   at System.Runtime.Remoting.Channels.BinaryClientFormatterSink.SyncProcessMessage(IMessage msg)

Exception rethrown at [0]: 
   at System.Runtime.Remoting.Proxies.RealProxy.HandleReturnMessage(IMessage reqMsg, IMessage retMsg)
   at System.Runtime.Remoting.Proxies.RealProxy.PrivateInvoke(MessageData& msgData, Int32 type) 
```

我尝试关闭防火墙，在与登录用户相同的用户上下文中运行服务，但无济于事。

Vista 是否存在不允许通过.net 远程处理服务和用户应用程序之间的通信的问题？

有没有其他人看过这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-20T18:05:37.537

我从来没有为此想出一个解决方案。但是我没有使用 tcp 进行远程处理，而是使用了 .net 2.0 附带的 ipc 协议（这是从 1.1 转换而来的项目）。

指定授权组解决了这个问题：

```
 <system.runtime.remoting>
      <application name="MyService">
        <service>
          <wellknown type="MyAssembly.MyServiceProxy, MyService" objectUri="FrontdeskSyncService.rem"  mode="Singleton" /> 
        </service>
        <channels>
          <channel ref="ipc" portName="server" authorizedGroup="Everyone">
            <serverProviders>
              <formatter ref="binary" typeFilterLevel="Full" />
            </serverProviders>
          </channel>
        </channels>
      </application>
  </system.runtime.remoting> 
```

# python - 如何从 RSA 模数创建 PEM 格式的 RSA 公钥？

> ID：884207
> 
> 赞同：2
> 
> 时间：2009-05-19T17:58:14.677
> 
> 标签：python, cryptography, rsa, m2crypto

我有一个 RSA 公钥的模数。我想将此公钥与[Python 库“M2Crypto”一起使用，](http://wiki.osafoundation.org/bin/view/Projects/MeTooCrypto)但它需要 PEM 格式的公钥。

因此，我必须将 RSA 模数转换为 PEM 文件。

模数可以在[这里找到。](http://paste.pocoo.org/show/118040/)

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-19T19:21:54.407

M2Crypto 库有[一种重建公钥的方法。](http://www.heikkitoivonen.net/m2crypto/api/M2Crypto.RSA-module.html#new_pub_key)您需要知道公共指数`e`（对于 RSA 密钥，通常为 65337，但已使用其他数字，例如 3 或 17）和模数`n`（即问题中提供的 512 位数字）。请注意，文档描述了用于`e`和的长度编码格式`n`。

一旦公钥被重建，它可以[保存到一个文件](http://www.heikkitoivonen.net/m2crypto/api/M2Crypto.RSA.RSA_pub-class.html#save_key)中，以后可以再次使用，而无需转换。

# javascript - 是否有可用于过滤 XSS 攻击字符串的 javascript 库？

> ID：884209
> 
> 赞同：3
> 
> 时间：2009-05-19T17:58:41.073
> 
> 标签：javascript, xss

是否有类似于 HTMLPurifier 之类的库的 Javascript 等价物，可以从字符串中删除 XSS 代码？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-19T18:01:19.697

一般来说，当 Javascript 代码运行时，保护自己免受 XSS 攻击为时已晚。您需要在服务器而不是客户端进行防范。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-19T18:21:20.677

[Google-caja](http://code.google.com/p/google-caja/)项目应该可以帮助您。

# php - PHP中的正则表达式：匹配非转义引号之外的模式

> ID：884216
> 
> 赞同：0
> 
> 时间：2009-05-19T17:59:54.737
> 
> 标签：php, regex

我正在编写一种方法来从 SQL 查询字符串中提取某些数据，并且只有当它出现在单引号*之外*时，我才需要正则表达式匹配大括号内的任何单词。我还需要它来考虑转义（反斜杠前面）引号以及转义反斜杠的可能性。

在以下示例中，我需要正则表达式来匹配 {FOO} 而不是 {BAR}：

```
blah blah {FOO} blah 'I\'m typing {BAR} here with an escaped backslash \\'
blah blah {FOO} 'Three backslashes {BAR} and an escaped quote \\\\\\\' here {BAR}' 
```

我在 PHP 中使用 preg_match 来获取大括号中的单词（在本例中为“FOO”）。这是我到目前为止的正则表达式字符串：

```
$regex = '/' .
    // Match the word in braces
    '\{(\w+)\}' .
    // Only if it is followed by an even number of single-quotes
    '(?=(?:[^\']*\'[^\']*\')*[^\']*$)' .
    // The end
    '/'; 
```

我的逻辑是，因为我唯一要解析的是合法的 SQL 字符串（除了我添加的大括号），如果一组大括号后面跟着*偶数*个非转义引号，那么它必须在外面的报价。

我提供的正则表达式是 100% 成功的，除了考虑转义引号。我只需要确保在引用匹配之前没有奇数个反斜杠，但对于我来说，我似乎无法在 RegEx 中传达这一点。有接盘侠吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-19T19:51:49.200

处理转义引号和反斜杠的方法是成对使用它们。

```
(?=(?:(?:(?:[^\'\\]++|\\.)*+\'){2})*+(?:[^\'\\]++|\\.)*+$) 
```

换句话说，当您扫描下一个引号时，您会跳过任何以反斜杠开头的字符对。这会处理转义的引号和转义的反斜杠。这种前瞻将允许在引用部分之外的转义字符，这可能不是必需的，但它也可能不会受到伤害。

`*+`ps，注意所有格量词（和）的自由使用`++`；如果没有这些，您可能会遇到性能问题，尤其是在目标字符串很大的情况下。此外，如果字符串可以包含换行符，您可能需要在 DOTALL 模式（又名“singleline”或“/s”模式）下进行匹配。

但是，我同意 mmyers：如果您尝试解析 SQL，您*将*遇到正则表达式根本无法处理的问题。在所有正则表达式不擅长的事情中，SQL 是最糟糕的事情之一。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-19T20:01:50.567

简单地，也许是天真地，str_replace 去掉你所有的双反斜杠。然后 str_replace 出转义的单引号。此时，查找不在单引号之间的匹配项相对简单（例如，使用您现有的正则表达式）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-19T20:24:25.453

如果您真的想为此使用正则表达式，我将分两步完成：

1.  用将*字符串*与*非字符串*分开`preg_split`：

    ```
    $re = "('(?:[^\\\\']+|\\\\(\\\\\\\\)*.)*')";
    $parts = preg_split('/'.$re.'/', $str, -1, PREG_SPLIT_NO_EMPTY | PREG_SPLIT_DELIM_CAPTURE); 
    ```

2.  替换*字符串*中的任何内容：

    ```
    foreach ($parts as $key => $val) {
        if (preg_match('/^'.$re.'$/', $val)) {
            $parts[$key] = preg_replace('/\{([^}]*)}/', '$1', $val);
        }
    } 
    ```

但是真正的解析器可能会更好，因为这种方法效率不高。

# asp.net - 从 SharePoint URL 中取出 /Pages？

> ID：884217
> 
> 赞同：4
> 
> 时间：2009-05-19T17:59:56.703
> 
> 标签：asp.net, sharepoint, sharepoint-2007, seo, httpmodule

一位客户询问我们是否可以采取任何措施从他面向 Internet 的 MOSS 发布站点中删除“/Pages”。一些谷歌搜索显示，对 HTTPModules 的一些巧妙使用可能能够隐藏 Pages 的存在，但我还没有看到端到端的工作解决方案。你们中是否有人遇到过这个特殊要求，如果有，你们是如何解决的？

客户对 /Pages 的主要关注是它对 SEO 的影响 - 如果有人有任何方法可以缓解这些问题或可以解释为什么在您的 URL 中有这个额外的级别不会是一个问题，那也将不胜感激（并且可能更好， 从长远来看！）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-19T23:13:35.343

看看这个帖子。 [http://blog.mastykarz.nl/semantic-urls-in-moss-2007-imtech-sharepoint-semantic-urls-free-feature/](http://blog.mastykarz.nl/semantic-urls-in-moss-2007-imtech-sharepoint-semantic-urls-free-feature/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T19:18:39.347

您将遇到的主要问题是 Microsoft 不会为“隐藏”页面库的 SharePoint 实例提供支持。

是的，您可以使用 URL 重写器来排除路径的 /pages 部分，并且您还需要对响应流执行搜索和替换以将其从所有生成的 URLS 中删除 - 这显然会有性能命中服务器 - 但仔细使用缓存，它可能不会那么明显。

PSS 将要求您在他们调查您的站点的任何问题之前删除设置，因此您（或您的客户）需要权衡感知的好处与性能和支持问题。

我相信我们过去曾为我们的一位客户做过这件事，但大多数人都乐于坚持使用 /pages 元素——它真的没有那么大的效果。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-19T18:56:24.847

我知道 ASP.NET 3.5 SP1 具有内置的 ASP.NET MVC 使用的 URL 路由引擎。如果您想针对该版本的 .NET 框架运行，您可以使用路由来消除 URL 的 /Pages 部分。但我不赞成在那个版本的.NET 上运行 MOSS。不过，这是我要检查的第一个地方。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-19T21:28:19.737

[您可以在此处](http://www.wssdemo.com/Pages/websites.aspx)获取使用 MOSS 的面向公众的网站列表。您可以看到他们使用“页面”库，您可以根据内容检查您最喜欢的搜索引擎。希望这足以证明“页面”库不会成为太大的问题，并且您可以为它们节省大量现金。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-22T14:20:24.933

您可以更改 /Pages 库的名称（和 url）。

# .net - 标签的生成成员：我应该有什么理由吗？

> ID：884228
> 
> 赞同：6
> 
> 时间：2009-05-19T18:03:16.980
> 
> 标签：.net, visual-studio, winforms

我在这里的另一篇文章中读到了 SO，如果可能的话，你不应该为标签生成成员。我想知道这会有什么潜在**的缺点**？

我说的好处是提高性能是正确的吗？还要别的吗？

我有一个带有 100 个标签的 winform 应用程序。不生成成员有什么好处，还是仅在 Web 应用程序中您看到了收益？

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-19T18:16:32.837

可读性。如果您为所有标签生成成员，但您没有使用它们，那么它会使您的代码更难阅读。我知道大多数人在想什么，它被放入设计器文件中，所以没关系。任何从事过 WinForms 开发的人都知道，您最终将不得不去那里寻找错误（修复好的 ol' 白屏死机）。

此外，当您为所有内容生成成员时，它会使您的智能感知列表非常长，这是另一个负面因素。

这不仅适用于标签，也适用于您投放到表单上的任何控件。面板、网格等。如果您从未在代码库中使用它们，请考虑将 Generate Member 更改为 false，因为您无论如何都不使用它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-19T18:21:06.950

标签具有必须保存在内存中的属性和其他状态。如果你的标签永远不会改变，你可以通过不生成成员来节省一点内存。请注意，这*不会*成为您的应用程序如何执行的决定因素，但这并不意味着您不应该在您知道可以的地方时不时地节省一点内存。

它还可以防止标签无用地弄乱表单的智能感知列表。

*你应该*为你的标签生成成员的一个重要原因是它可以更容易地进行本地化。

# .net - WCF - 如何增加消息大小配额

> ID：884235
> 
> 赞同：485
> 
> 时间：2009-05-19T18:04:02.187
> 
> 标签：.net, asp.net, wcf, .net-3.5

我有一个 WCF 服务，它从数据库向客户端返回 1000 条记录。我有一个 ASP.NET WCF 客户端（我在 asp.net Web 应用程序项目中添加了服务引用以使用 WCF）。

运行客户端应用程序时收到以下消息：

> 已超出传入邮件 (65536) 的最大邮件大小配额。要增加配额，请在适当的绑定元素上使用 MaxReceivedMessageSize 属性。

有什么帮助吗？如何增加邮件大小配额？

* * *

## 回答 #1

> 赞同：641
> 
> 时间：2009-05-19T18:06:51.793

*在App.config*或*Web.config*文件中，您需要这样的东西来增加消息大小配额：

```
<bindings>
    <basicHttpBinding>
        <binding name="basicHttp" allowCookies="true"
                 maxReceivedMessageSize="20000000" 
                 maxBufferSize="20000000"
                 maxBufferPoolSize="20000000">
            <readerQuotas maxDepth="32" 
                 maxArrayLength="200000000"
                 maxStringContentLength="200000000"/>
        </binding>
    </basicHttpBinding>
</bindings> 
```

并在您的端点配置中使用绑定名称，例如

```
...
bindingConfiguration="basicHttp"
... 
```

这些值的理由很简单，它们足够大以容纳大多数消息。您可以调整该数字以满足您的需求。低默认值基本上是为了防止 DOS 类型的攻击。将其设置为 20000000 将允许分布式 DOS 攻击有效，默认大小 64k 将需要大量客户端来压倒大多数服务器。

* * *

## 回答 #2

> 赞同：161
> 
> 时间：2010-08-05T06:11:11.450

如果您在使用 WCF 测试客户端时仍然收到此错误消息，那是因为客户端具有单独的**MaxBufferSize**设置。

**要更正此问题：**

1.  右键单击树底部的**配置文件节点**
2.  选择使用 SvcConfigEditor 编辑

*将出现一个可编辑设置列表，包括 MaxBufferSize。*

**注意：** *默认情况下，自动生成的代理客户端还将 MaxBufferSize 设置为 65536。*

* * *

## 回答 #3

> 赞同：113
> 
> 时间：2011-02-02T10:07:12.953

如果您要动态创建 WCF 绑定，请使用以下代码：

```
BasicHttpBinding httpBinding = new BasicHttpBinding();
httpBinding.MaxReceivedMessageSize = Int32.MaxValue;
httpBinding.MaxBufferSize = Int32.MaxValue;
// Commented next statement since it is not required
// httpBinding.MaxBufferPoolSize = Int32.MaxValue; 
```

* * *

## 回答 #4

> 赞同：47
> 
> 时间：2012-06-27T20:58:33.220

**WCF 测试客户端**有它自己的客户端配置。

运行测试客户端并滚动到底部。如果双击配置文件节点，您将看到 XML 表示。正如你所看到的`maxReceivedMessageSize`那样`65536`。

要编辑它，右键单击配置文件树节点并选择 Edit With `SvcConfigEditor`。当编辑器打开时，展开绑定并双击自动生成的绑定。

您可以在此处编辑所有属性，包括`maxReceivedMessageSize`. 完成后单击*文件 - 保存*。

最后，当您返回 WCF 测试客户端窗口时，单击*Tools - Options*。

**注意**：*取消选中启动服务时始终重新生成配置*。

* * *

## 回答 #5

> 赞同：25
> 
> 时间：2015-03-30T06:39:22.903

我找到了简单的方法

> --- 右键单击​​ webconfig 或应用程序配置文件，然后单击 EDIT WCF CONFIGURATION 并进入 bingdigs 并选择 yore 服务，右侧显示 maxReciveMessageSize 给出一个大数字 ---

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2011-03-22T05:36:14.540

我解决了问题...如下

```
 <bindings>
  <netTcpBinding>
    <binding name="ECMSBindingConfig" closeTimeout="00:10:00" openTimeout="00:10:00"
      sendTimeout="00:10:00" maxBufferPoolSize="2147483647" maxBufferSize="2147483647"
      maxReceivedMessageSize="2147483647" portSharingEnabled="true">
      <readerQuotas maxArrayLength="2147483647" maxNameTableCharCount="2147483647"
          maxStringContentLength="2147483647" maxDepth="2147483647"
          maxBytesPerRead="2147483647" />
      <security mode="None" />
    </binding>
  </netTcpBinding>
</bindings>
<behaviors>
  <serviceBehaviors>
    <behavior name="ECMSServiceBehavior">
      <dataContractSerializer ignoreExtensionDataObject="true" maxItemsInObjectGraph="2147483647" />
      <serviceDebug includeExceptionDetailInFaults="true" />
      <serviceTimeouts transactionTimeout="00:10:00" />
      <serviceThrottling maxConcurrentCalls="200" maxConcurrentSessions="100"
        maxConcurrentInstances="100" />
    </behavior>
  </serviceBehaviors>
</behaviors> 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2013-05-11T00:07:27.120

我在我的项目中使用 CalculateRoute () 解决了我在 Bing Maps WPF 上的问题。我的解决方案是在“customBinding”部分的属性“httpTransport”上设置 maxReceivedMessageSize 和 maxReceivedMessageSize。

我在 applications.config 文件（es.myApp.config）中设置了这个配置：

```
<system.serviceModel>
    <bindings>
        <basicHttpBinding>
            <binding name="BasicHttpBinding_IGeocodeService" />
            <binding name="BasicHttpBinding_IRouteService" />
        </basicHttpBinding>
        <customBinding>
            <binding name="CustomBinding_IGeocodeService">
                <binaryMessageEncoding />
              <httpTransport manualAddressing="false" maxBufferPoolSize="524288"
                                maxReceivedMessageSize="2147483647" allowCookies="false" authenticationScheme="Anonymous"
                                bypassProxyOnLocal="false" decompressionEnabled="true" hostNameComparisonMode="StrongWildcard"
                                keepAliveEnabled="true" maxBufferSize="2147483647" proxyAuthenticationScheme="Anonymous"
                                realm="" transferMode="Buffered" unsafeConnectionNtlmAuthentication="false"
                                useDefaultWebProxy="true" />
            </binding>
            <binding name="CustomBinding_IRouteService">
                <binaryMessageEncoding />
              <httpTransport manualAddressing="false" maxBufferPoolSize="524288"
                                maxReceivedMessageSize="2147483647" allowCookies="false" authenticationScheme="Anonymous"
                                bypassProxyOnLocal="false" decompressionEnabled="true" hostNameComparisonMode="StrongWildcard"
                                keepAliveEnabled="true" maxBufferSize="2147483647" proxyAuthenticationScheme="Anonymous"
                                realm="" transferMode="Buffered" unsafeConnectionNtlmAuthentication="false"
                                useDefaultWebProxy="true" />
            </binding>
        </customBinding>
    </bindings>
    <client>
        <endpoint address="http://dev.virtualearth.net/webservices/v1/geocodeservice/GeocodeService.svc"
            binding="basicHttpBinding" bindingConfiguration="BasicHttpBinding_IGeocodeService"
            contract="BingServices.IGeocodeService" name="BasicHttpBinding_IGeocodeService" />
        <endpoint address="http://dev.virtualearth.net/webservices/v1/geocodeservice/GeocodeService.svc/binaryHttp"
            binding="customBinding" bindingConfiguration="CustomBinding_IGeocodeService"
            contract="BingServices.IGeocodeService" name="CustomBinding_IGeocodeService" />
        <endpoint address="http://dev.virtualearth.net/webservices/v1/routeservice/routeservice.svc"
            binding="basicHttpBinding" bindingConfiguration="BasicHttpBinding_IRouteService"
            contract="BingServices.IRouteService" name="BasicHttpBinding_IRouteService" />
        <endpoint address="http://dev.virtualearth.net/webservices/v1/routeservice/routeservice.svc/binaryHttp"
            binding="customBinding" bindingConfiguration="CustomBinding_IRouteService"
            contract="BingServices.IRouteService" name="CustomBinding_IRouteService" />
    </client>
</system.serviceModel> 
```

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2016-10-24T05:27:51.047

**根据我的经验，另一个需要考虑的重要事情..**

我强烈建议不要最大化 maxBufferPoolSize，因为在应用程序域（即应用程序池）回收之前，池中的缓冲区永远不会被释放。

一段时间的高流量可能会导致大量内存被使用并且永远不会被释放。

更多细节在这里：

*   [https://stackoverflow.com/a/19953113/496676](https://stackoverflow.com/a/19953113/496676)
*   [http://andriybuday.com/2011/08/wcf-configuration-caused-memory-leaks.html](http://andriybuday.com/2011/08/wcf-configuration-caused-memory-leaks.html)

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2017-07-25T09:58:05.353

对于**HTTP：**

```
<bindings>
  <basicHttpBinding>
    <binding name="basicHttp" allowCookies="true"
             maxReceivedMessageSize="20000000" 
             maxBufferSize="20000000"
             maxBufferPoolSize="20000000">
        <readerQuotas maxDepth="200" 
             maxArrayLength="200000000"
             maxBytesPerRead="4096"
             maxStringContentLength="200000000"
             maxNameTableCharCount="16384"/>
    </binding>
  </basicHttpBinding>
</bindings> 
```

对于**TCP：**

```
<bindings>
  <netTcpBinding>
    <binding name="tcpBinding"
             maxReceivedMessageSize="20000000"
             maxBufferSize="20000000"
             maxBufferPoolSize="20000000">
      <readerQuotas maxDepth="200"
           maxArrayLength="200000000"
           maxStringContentLength="200000000"
           maxBytesPerRead="4096"
           maxNameTableCharCount="16384"/>
    </binding>
  </netTcpBinding>
</bindings> 
```

**重要的：**

如果您尝试传递具有许多连接对象的复杂对象（例如：树数据结构，具有许多对象的列表......），无论您如何增加配额，通信都将失败。在这种情况下，您必须增加包含对象的数量：

```
<behaviors>
  <serviceBehaviors>
    <behavior name="NewBehavior">
      ...
      <dataContractSerializer maxItemsInObjectGraph="2147483646"/>
    </behavior>
  </serviceBehaviors>
</behaviors> 
```

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2012-01-26T12:38:19.837

```
<bindings>
  <wsHttpBinding>
    <binding name="wsHttpBinding_Username" maxReceivedMessageSize="20000000"          maxBufferPoolSize="20000000">
      <security mode="TransportWithMessageCredential">
        <message clientCredentialType="UserName" establishSecurityContext="false"/>
      </security>
    </binding>
  </wsHttpBinding>
</bindings>

<client>
  <endpoint
            binding="wsHttpBinding"
            bindingConfiguration="wsHttpBinding_Username"
            contract="Exchange.Exweb.ExchangeServices.ExchangeServicesGenericProxy.ExchangeServicesType"
            name="ServicesFacadeEndpoint" />
</client> 
```

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2018-07-24T14:50:15.003

对我来说，我所要做的就是添加`maxReceivedMessageSize="2147483647"`到客户端 app.config。服务器保持不变。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2013-07-26T07:54:36.477

不要忘记将考虑执行入口点的app.config，而不是类库项目中管理Web-Service调用的那个，如果有的话。

例如，如果您在运行单元测试时遇到错误，则需要在测试项目中设置适当的配置。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-01-22T09:53:41.303

在 web.config 上使用此设置时出现此错误

```
System.ServiceModel.ServiceActivationException 
```

我设置这样的设置：

```
 <service name="idst.Controllers.wcf.Service_Talks">
    <endpoint address="" behaviorConfiguration="idst.Controllers.wcf.Service_TalksAspNetAjaxBehavior"
      binding="webHttpBinding" contract="idst.Controllers.wcf.Service_Talks" />
  </service>
  <service name="idst.Controllers.wcf.Service_Project">
    <endpoint address="" behaviorConfiguration="idst.Controllers.wcf.Service_ProjectAspNetAjaxBehavior"
      binding="basicHttpBinding" bindingConfiguration="" bindingName="largBasicHttp"
      contract="idst.Controllers.wcf.Service_Project" />
  </service>
</services>

<bindings>
<basicHttpBinding>
    <binding name="largBasicHttp" allowCookies="true"
             maxReceivedMessageSize="20000000"
             maxBufferSize="20000000"
             maxBufferPoolSize="20000000">
        <readerQuotas maxDepth="32"
             maxArrayLength="200000000"
             maxStringContentLength="200000000"/>
    </binding>
</basicHttpBinding> 
```

# mercurial - 我如何自己为多个用户托管 Mercurial 存储库？

> ID：884247
> 
> 赞同：21
> 
> 时间：2009-05-19T18:06:22.357
> 
> 标签：mercurial, hosting, dvcs, collaboration

有许多 git、Mercurial 等托管服务。我需要自己托管，因为我们要保留的一些数据具有敏感性质，我们不能将其移到异地。

我需要在服务器上托管一个 Mercurial 存储库，以便许多人可以访问它来拉取更改并推送他们自己的工作。需要某种密码保护，它也可以使用 ssh。不过，如果可能的话，我更喜欢 HTTP(S) 作为传输协议（类似于 Google 代码）。

有人可以指出我如何做到这一点的描述吗？到目前为止，我只找到了托管单用户存储库和托管服务的描述，但没有找到关于自己进行多用户托管的描述。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-05-19T18:19:45.750

查看 mercurial 网站上的[PublishingRepositories](http://www.selenic.com/mercurial/wiki/index.cgi/PublishingRepositories)页面。它将告诉您如何设置`hgwebdir.cgi`脚本以通过 https 提供多个存储库。

配置完成后，我建议将其添加到您的 hgrc 中：

```
[web]
style = gitweb 
```

我发现它比默认主题更好。

# c# - 确定代码循环复杂度的最佳工具

> ID：884251
> 
> 赞同：23
> 
> 时间：2009-05-19T18:08:13.070
> 
> 标签：c#, cyclomatic-complexity

人们能否建议在 C# winforms 代码库中确定循环复杂性的最佳工具。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-05-19T18:14:15.137

在 Visual Studio 中，我只是去分析/计算代码度量，我得到圈复杂度。

### 第三方编辑

*   Visual Studio 2015 社区版也有

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-19T18:58:52.830

[NDepend](http://www.ndepend.com/)有大量的代码分析和查询工具，包括每种类型的圈复杂度和方法估计[。](http://www.ndepend.com/docs/code-metrics#CC)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-19T19:07:33.733

我们正在使用[SourceMonitor](http://www.campwoodsw.com/sourcemonitor.html)。它是免费的，非常易于使用并且易于与 CI 服务器集成。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-19T18:11:38.633

DevExpress 的[Refactor Pro](http://devexpress.com/Products/Visual_Studio_Add-in/Refactoring/)就是这样做的。它有免费试用版，因此您可能想试一试。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-13T15:49:41.487

Red Gate 的 .NET Reflector 有一个名为[CodeMetrics](http://reflectoraddins.codeplex.com/Wiki/View.aspx?title=CodeMetrics)的免费插件可以做到这一点。

# visual-studio - Visual Studio 复制项目

> ID：884255
> 
> 赞同：188
> 
> 时间：2009-05-19T18:10:12.803
> 
> 标签：visual-studio, visual-studio-2008

我想复制我的项目。我宁愿不通过添加文件和引用等从头开始做。请注意，我不是指复制以进行部署。只是普通的副本。

VS中有一个工具可以做到这一点吗？我正在使用 VS 2008

* * *

## 回答 #1

> 赞同：217
> 
> 时间：2017-03-06T03:53:22.563

只需[创建一个模板](https://docs.microsoft.com/en-us/visualstudio/ide/how-to-create-project-templates?f1url=https%3A%2F%2Fmsdn.microsoft.com%2Fquery%2Fdev15.query%3FappId%3DDev15IDEF1%26l%3DEN-US%26k%3Dk(VS.ExportTemplateWizard)%26rd%3Dtrue&view=vs-2017)；

从您的项目中选择：项目 - 导出模板

该向导将让您定义

*   模板名称
*   模板说明
*   图标
*   预览图像

然后它将您的项目压缩到“我的导出模板”目录中。您还可以选择在创建新项目时使您的模板可用。

当您使用模板创建一个新项目时，命名空间对于每个文件中的“your_new_project_name”都是正确的，所有引用都正确，一切都完美:)

您可以将 .zip 文件发送给任何人，他们必须将 .zip 文件复制（而不是解压缩）到 Templates\ProjectTemplates 目录中以供他们使用。

我制作了一个 ASP.NET MVC 模板，其中包含我喜欢的文件夹、布局页面、视图模型等。

注意：
如果您的项目中有一个空文件夹，它不会被添加到模板中，所以我只是添加了一个适合每个文件夹的空类，以及图像文件夹的示例图片。

* * *

## 回答 #2

> 赞同：160
> 
> 时间：2009-05-19T18:13:27.790

如果你想要一个副本，最快的方法是保存项目。然后在文件系统上复制整个内容。返回 Visual Studio 并打开副本（通过右键单击解决方案 => 添加现有项目 => 打开复制的项目）。从那里，我很可能会建议重新命名项目/解决方案（[安全重命名项目的步骤在以下链接中](https://www.bing.com/search?q=ms%20visual%20studio%20safely%20rename%20project&cvid=8fc91641af9d427190b84fbd919b00e4&aqs=edge..69i57.13452j0j1&pglt=515&FORM=ANNTA1&PC=U531)），这样您就没有两个相同的名称，但这是制作副本的最快方法.

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2017-01-11T05:24:36.047

完全不建议复制项目，因为内部形成的一些配置文件（如*.csproj、.vspscc***等**）可能（并且很可能会）指向属于先前解决方案位置和系统中其他路径/位置的引用，或者TFS。除非您是阅读这些文件和修复参考的专家，否则不要尝试复制项目。

 *您可以创建一个与您要复制的相同类型的骨架项目，这将创建一个适当的*.csproj、.vspscc*文件。现在您可以自由地复制以前项目中的类文件、脚本和其他内容，因为它们不会受到影响。这将确保顺利构建和版本控制（如果您选择对此感兴趣）

说了这么多，让我给你一个逐步复制项目的方法：

1.  在解决方案资源管理器中转到要复制的项目，然后*右键单击*。
2.  现在选择*“**在文件资源管理器中打开文件夹**”*（假设您已将解决方案映射到磁盘上的本地路径）。
3.  选择要作为整个文件夹复制的项目（以及所有依赖项、bin .vspscc 文件、.csproj 文件）
4.  将它们粘贴到您想要的位置（它可能是您的同一个解决方案文件夹，甚至是另一个解决方案文件夹。如果它在同一个解决方案文件夹中，那么您将需要将其重命名，还将 .csproj 和其他内部文件重命名为新名称）。
5.  不返回 Visual Studio，***右键单击解决方案 > 添加 > 现有项目...***
6.  现在从您放置的位置浏览并选择项目文件（.csproj 文件），然后选择“***打开***”
7.  此文件现在出现在解决方案资源管理器中供您使用。

您现在可能必须解决一些构建错误，可能是重复/丢失的引用和内容，但除此之外，它在逻辑和结构上与您预期的一样原始。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-01-15T19:17:23.470

我想如果这是你经常做的事情，有一个小（非免费）实用程序可以为你做这件事：我没有使用它，所以不确定它有多好：

[http://www.kinook.com/CopyWiz/](http://www.kinook.com/CopyWiz/)

CodePlex 上也有这个项目：

[http://clone.codeplex.com/](http://clone.codeplex.com/)

我可能会尝试一下 codeplex 项目，如果它不起作用，我将手动重命名所有内容并编辑 sln 文件。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2014-09-24T11:17:13.020

我按照这些步骤操作，并使用名为[Resharper](http://www.jetbrains.com/resharper/)的开发工具，顺便说一句，它很棒：

所以，

1.  **将**现有项目文件夹复制到您想要的目的地
2.  转到源代码管理并右键单击您想要的根文件夹并选择**“将项目添加到文件夹...”**。然后，将出现一个向导来选择要复制的文件（不需要某些文件和默认情况下，向导会因此而引导您）。
3.  **更改**解决方案文件的名称 (*.sln)
4.  **更改**子项目的名称（如果存在）。
5.  使用**Resharper**更改绑定**命名空间**名称（我将自动安全地完成这项肮脏的工作）。另一种方法是使用新名称手动更改所有命名空间。
6.  与方法名称相同的操作。
7.  如果要更改，请检查**解决方案的属性。**

就是这样。你准备好了！！！

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2020-02-25T05:33:13.107

按照上面 Shane 的回答（顺便说一句效果很好）……<br>

您可能会在参考列表中遇到大量黄色三角形。其中大部分可以通过 a`Build->Clean Solution`和消除`Build->Rebuild Solution`。

我确实碰巧有一些更顽固的 Google API 引用......以及 NewtonSoft JSon。

> 尝试重新安装相同版本的 NuGet 包不起作用。
> Visual Studio 认为您已经安装了它。

要解决这个问题：
1：写下原始版本。
2：安装下一个更高/更低版本...然后卸载它。
3：从步骤 #1 安装原始版本。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-09-30T23:29:48.907

最好的方法实际上是从头开始创建一个新项目，然后进入包含要复制的项目文件的文件夹（项目、form1、除文件夹之外的所有内容）。重命名文件（除了 form1 文件）例如：我将 Ch4Ex1 文件复制到我的 Ch4Ex2 项目中，但首先将文件重命名为 Ch4Ex2。将这些文件复制并粘贴到 Visual Studio 中新项目的解决方案资源管理器中。然后只需覆盖文件，您就可以开始了！

旧线程，但我希望它可以帮助任何寻找这个答案的人！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-10-26T11:50:33.490

我有一个项目，其中源文件位于项目文件夹下方的文件夹中。当我复制没有源文件夹的项目文件夹并打开复制的项目时，源文件并没有丢失，而是在旧位置找到。我关闭了项目，也复制了源文件夹，然后重新打开了项目。现在，该项目神奇地引用了复制的源文件（新路径都显示在“另存为”中，并且文件中的更改已保存在复制的版本中）。

有一个警告：如果不是旧项目文件夹和新项目文件夹都位于使用的库文件夹下方，则上述魔术也会丢弃对库的绝对引用，并期望它位于相同的相对路径下。

我在 VS Express 2012 上试过这个。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-05-24T21:25:27.383

我的解决方案有点不同 - 软件包所在的计算机死了，所以我被迫在另一台计算机上重新创建它。

我所做的（在 VS 2008 中）是在我的目录中打开以下文件：

```
 - <package name>.djproj
                  - <package name>.dtproj.user
                  - <package name>.dtxs
                  - <package name>.sln
                  - Package.dtsx 
```

当我这样做时，一个弹出窗口询问我 sln 文件是否将是一个新的解决方案，当我单击“是”时，一切正常。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-10-25T19:29:05.340

**在尝试了上述解决方案并为 MVC 项目创建副本之后**

对于 MVC 项目，请更新 .csproj 文件中的端口号，您可以借助 iis applicationhost.config 来检查端口号。相同的端口号将导致 IIS 中的程序集加载问题。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-05-06T17:03:57.780

我使用 Visual Studio 2013，其中 Project > Export Template 不是一个选项。 [这](https://www.codeproject.com/Tips/873941/How-to-Create-a-Project-Template-for-Visual-Studio)是我用来克隆项目的方法。

从您的解决方案中：文件>导出模板>选择要从中制作模板的项目，注意保存路径

[在此处](https://visualstudio.microsoft.com/license-terms/distributable-code-microsoft-visual-studio-2013-microsoft-visual-studio-2013-sdk-includes-u/)下载并安装 VS 2013 SDK

在可扩展性下创建新的 VSIX 项目

从 VSIXManifest 对话框中选择 Assets 选项卡

填写作者文本框

为类型和浏览选择“项目模板”以添加导出的模板（保存在您在步骤 1 中记下的路径）

保存并生成 VSIX 项目。转到 VSIX 项目的 .../bin/Debug 文件夹并双击运行 .vsix 文件

启动 Visual Studio 的新实例，您应该在模板所在的任何项目类型下看到您的模板。从您的模板创建一个新项目

您将不得不重新添加任何 dll 引用

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-06-26T07:45:13.627

最简单的方法是将项目导出为模板并将其保存到默认模板位置。然后，将模板复制到要移动到的位置上的完全相同的目录中。之后，在新位置打开visual studio，新建一个项目，会提示搜索模板。搜索你命名的模板，选择它，你就完成了！

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-12-09T04:09:41.267

从存储库工具中欺骗克隆

1.  在文件资源管理器中打开项目位置。
2.  将路径复制到任何浏览器（也就是在浏览器中打开项目位置）。
3.  使用浏览器中的地址作为克隆的源存储库。
4.  放松并享受无错误克隆。

# windows - 如何确定一个进程是否是当前活动/前台应用程序

> ID：884256
> 
> 赞同：8
> 
> 时间：2009-05-19T18:10:41.927
> 
> 标签：windows, process

我希望能够查询一些函数并给它一个 processID 或 processName - 然后它应该返回`true`或者`false`该进程是否在前台。

因此，即 Firefox 的查询将返回`true`（因为现在我在 FireFox 中，输入此内容），其他所有内容都应返回`false`。

对于每种类型的应用程序（.net、java/swing、纯 c++/win32-ui），这是否可能？

*   此问题仅适用于 Windows。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-19T18:16:41.497

[GetForegroundWindow](http://msdn.microsoft.com/en-us/library/ms633505.aspx)和[GetWindowThreadProcessId](http://msdn.microsoft.com/en-us/library/ms633522(VS.85).aspx)应该让您获得此信息。

即，如果您知道 pid，只需对照如下函数检查它：

```
bool IsForegroundProcess(DWORD pid)
{
   HWND hwnd = GetForegroundWindow();
   if (hwnd == NULL) return false;

   DWORD foregroundPid;
   if (GetWindowThreadProcessId(hwnd, &foregroundPid) == 0) return false;

   return (foregroundPid == pid);
} 
```

这将适用于在某种程度上使用核心 Win32 库的任何应用程序 - 这将包括 Windows 窗体、WPF、本机 Win32 应用程序等。请注意，这仅适用于在调用桌面和会话上运行的应用程序 - 你可以例如，t 使用它来确定另一个用户的应用程序是否在前台。

# c# - 如何查看 user.config 文件并在更改时重新加载设置？

> ID：884260
> 
> 赞同：3
> 
> 时间：2009-05-19T18:11:34.330
> 
> 标签：c#, wpf, settings, user-config

我有一种情况，我正在运行我的 WPF 应用程序的多个实例。我希望实例共享相同的 user.config 文件。目前，最后写入 user.config 文件的实例获胜。我希望所有实例都观看 user.config 文件并在另一个实例更改它时重新加载设置。user.config 文件当前位于此处：

C:\Documents and Settings\*用户名*\Local Settings\Application Data\公司*名*\ *ExeName.exe_StrongName_hash* \ *1.0.0.0*

例如，C:\Documents and Settings\usename\Local Settings\Application Data\Company\5kAdCon.exe_StrongName_gxh0g12uyafipnfrslaggvy4vvk01fko\1.0.0.0

**有没有办法让我获得这个完整路径（包括哈希），以便我可以将文件观察器添加到 user.config 文件？**

如果是这样，我想在文件更改时重新加载设置。像调用这个方法一样简单吗？

```
Properties.Settings.Default.Reload(); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-21T19:59:46.617

我找到了。以下代码将返回 user.config 文件的路径。您需要添加对 System.Configuration.dll 的引用

```
Configuration config = ConfigurationManager.OpenExeConfiguration(ConfigurationUserLevel.PerUserRoamingAndLocal);
string path = config.FilePath; 
```

现在我可以使用[FileSystemWatcher](http://msdn.microsoft.com/en-us/library/system.io.filesystemwatcher.aspx)在文件更改时获得通知。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-20T04:52:51.060

您应该缓存文件并实现 CacheDependency，以便如果对文件进行任何更改，文件就会重新加载到缓存中。我在我的应用程序中使用了一个权限 xml 文件，该文件存储在缓存中，并在文件被更改时重新加载。这是代码：

```
protected void Page_Load(object sender, EventArgs e)
{
        XmlDocument permissionsDoc = null;

        if (Cache["Permissions"] == null)
        {
            string path = Server.MapPath("~/XML/Permissions.xml");
            permissionsDoc = new XmlDocument();
            permissionsDoc.Load(Server.MapPath("~/XML/Permissions.xml"));
            Cache.Add("Permissions", permissionsDoc,
                            new CacheDependency(Server.MapPath("~/XML/Permissions.xml")),
                           Cache.NoAbsoluteExpiration, Cache.NoSlidingExpiration,
                    CacheItemPriority.Default, new CacheItemRemovedCallback(ReloadPermissionsCallBack));
        }
        else
        {
            permissionsDoc = (XmlDocument)Cache["Permissions"];
        }
}

private void ReloadPermissionsCallBack(string key, object value, CacheItemRemovedReason reason)
    {
        XmlDocument doc = new XmlDocument();
        doc.Load(Server.MapPath("~/XML/Permissions.xml"));
        Cache.Insert("Permissions", doc ,
                            new CacheDependency(Server.MapPath("~/XML/Permissions.xml")),
                           Cache.NoAbsoluteExpiration, Cache.NoSlidingExpiration,
                    CacheItemPriority.Default, new CacheItemRemovedCallback(ReloadPermissionsCallBack));
    } 
```

缓存还将提高您的应用程序性能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-19T20:38:13.257

你可以使用 fileSystemWatcher 控件吗？

它有一个可以触发的修改事件

# c++ - 混合来自不同 C++ 编译器的库

> ID：884266
> 
> 赞同：6
> 
> 时间：2009-05-19T18:13:56.540
> 
> 标签：c++, linux, compiler-construction, compatibility

我正在开发一个跨越多个不同组织的项目的 redhat 5.2。每个组织都提供已使用各种版本的 g++ 编译的库。目前，这些版本包括 4.1.1、4.1.2 和 4.3.1。我正在尝试使用 4.1.2 将所有库链接到一个可执行文件中。这样做可能会出现什么问题（如果有的话）？顺便说一句，有没有办法判断每个编译器版本构建到哪个 ABI？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-19T18:25:24.977

本[ABI](http://gcc.gnu.org/onlinedocs/libstdc++/manual/abi.html)政策文档详细说明了不同 ABI 版本之间的兼容性。据此，该`libstdc++.so`库应该是兼容的，而 gcc 上一次破坏二进制兼容性是在 3.4。你应该没事。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-19T18:36:30.263

GCC（GNU Compiler Collection）定义了版本号和兼容性。

4.1.1 和 4.1.2 之间的 G++ 库应该是兼容的；与最新的链接。

4.1.x 和 4.2.x 之间的 G++ 库不兼容；你需要重新编译一些东西。

3.xy 和 4.pq 之间的 G++ 库不兼容；你需要重新编译一些东西。

在您的场景中，使用 4.3.1 构建的代码与其余代码不兼容。

要么您必须重新编译当前使用 4.3.x 编译的代码，因此它使用 4.1.x，或者您需要重新编译当前使用 4.1.x 编译的代码，因此它使用 4.3.x。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-19T18:17:21.963

也许静态链接可执行文件更容易......制作一个大二进制文件，但可以在所有平台上运行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-19T18:26:24.147

链接从不同版本的 g++ 构建的库应该没有问题，除非它们已在 g++ 网站上列出。但重要的是这些库构建在同一平台上，在您的情况下是 redhat 5.2。为 linux/redhat（比如 solaris）以外的平台构建的库不会与您的 exe 链接。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-19T18:29:38.403

IIRC，有一个 C++ 兼容性库可以做到这一点。我认为它被称为**libstdc++-compat**。

# wpf - WPF：按钮 ControlTemplate + 空格键 = 异常？

> ID：884287
> 
> 赞同：1
> 
> 时间：2009-05-19T18:18:16.300
> 
> 标签：wpf, exception, button, controltemplate

我已经在 Expression Blend 中为一个按钮拼凑了一个模板，它工作正常 - 直到我切换到它并按下空格键。我收到以下错误：

InvalidOperationException '[Unknown]' 属性未指向路径 '(0).(1).[0].(2)' 中的 DependencyObject。

代码如下：

```
 <ControlTemplate x:Key="EmailButton" TargetType="{x:Type Button}">
        <ControlTemplate.Resources>
            <Storyboard x:Key="MouseOverStoryboard">
                <ColorAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="border" Storyboard.TargetProperty="(Panel.Background).(GradientBrush.GradientStops)[0].(GradientStop.Color)">
                    <SplineColorKeyFrame KeyTime="00:00:00.4000000" Value="#FF55679E"/>
                </ColorAnimationUsingKeyFrames>
            </Storyboard>
            <Storyboard x:Key="UnMouseOverStoryboard">
                <ColorAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="border" Storyboard.TargetProperty="(Panel.Background).(GradientBrush.GradientStops)[0].(GradientStop.Color)">
                    <SplineColorKeyFrame KeyTime="00:00:00.4000000" Value="#FF92A2D3"/>
                </ColorAnimationUsingKeyFrames>
            </Storyboard>
        </ControlTemplate.Resources>
        <Border x:Name="border" BorderBrush="#FF000000" BorderThickness="2,2,2,2" CornerRadius="4,4,4,4">
            <Border.Background>
                <LinearGradientBrush EndPoint="0.47,-0.01" StartPoint="0.47,0.808">
                    <GradientStop Color="#FF92A2D3" Offset="0"/>
                    <GradientStop Color="#FFFFFFFF" Offset="1"/>
                </LinearGradientBrush>
            </Border.Background>
            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" Margin="{TemplateBinding Padding}"/>
        </Border>
        <ControlTemplate.Triggers>
            <Trigger Property="IsPressed" Value="True">
                <Setter Property="Background" TargetName="border" Value="#FF92A2D3"/>
            </Trigger>
            <Trigger Property="IsMouseOver" Value="True">
                <Trigger.EnterActions>
                    <BeginStoryboard x:Name="MouseOverStoryboard_BeginStoryboard" Storyboard="{StaticResource MouseOverStoryboard}"/>
                </Trigger.EnterActions>
                <Trigger.ExitActions>
                    <BeginStoryboard x:Name="UnMouseOverStoryboard_BeginStoryboard" Storyboard="{StaticResource UnMouseOverStoryboard}"/>
                </Trigger.ExitActions>
            </Trigger>
        </ControlTemplate.Triggers>
    </ControlTemplate> 
```

似乎 MouseOverStoryboard 或 UnMouseOverStoryboard 被触发（错误中提到的路径似乎与 TargetProperty 匹配）。我不确定为什么在按下空格键时会触发...有什么建议吗？

编辑：感谢 Ryan Versaw，我尝试了以下方法，现在可以防止空格键单击引发异常：

```
 <Trigger Property="IsPressed" Value="True">
                <Setter Property="Background" TargetName="border">
                    <Setter.Value>
                        <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                            <GradientStop Color="#FF92A2D3" Offset="0"/>
                            <GradientStop Color="#FF92A2D3" Offset="1"/>
                        </LinearGradientBrush>
                    </Setter.Value>
                </Setter>
            </Trigger> 
```

现在画笔类型保持一致（LinearGradientBrush），并且始终有第 0 个 GradientStop 可用。

我仍然对另一件事感到好奇 -考虑到这种感觉就像一个 hack（例如：添加/动画第三个渐变停止，然后在 IsPressed 时需要添加第三个 GradientStop，那么*最好*的方法是什么？ ==真）。

感谢您的建议！希望这对其他人也有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-19T18:22:52.627

如果按空格键就像单击按钮。
你应该看看`IsPressed`触发器

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-19T18:23:44.870

看起来您的 IsPressed Trigger 的 Setter 正在尝试将颜色值 (#FF92A2D3) 分配给边框的 Background 属性。但是，边框的背景属性包含线性渐变画笔，而不是纯色画笔。不过，这只是乍一看的意见。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-19T19:00:14.203

我不确定最佳解决方案是什么，但我找到了一个可行的解决方案。

`LinearGradientBrush`在您的资源中创建一个：

```
<LinearGradientBrush x:Key="solidBrush">
    <GradientStop Color="#FF92A2D3"/>
</LinearGradientBrush> 
```

`IsPressed`将触发器更改为以下内容（仅`Value`更改）：

```
<Trigger Property="IsPressed" Value="True">
    <Setter Property="Background" TargetName="border" Value="{StaticResource solidBrush}"/>
</Trigger> 
```

这应该将您的整个背景换成新的（也是 a `LinearGradientBrush`）。

# iphone - iPhone应用程序可以阻止电话吗？

> ID：884289
> 
> 赞同：22
> 
> 时间：2009-05-19T18:19:04.923
> 
> 标签：iphone, objective-c, xcode

是否可以编写一个阻止来电和去电的应用程序？还是 iPhone 锁定太多？谢谢！

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-05-19T18:20:58.650

编辑：请参阅下面的 Rajan Maheshwari 的回答。CallKit 现在提供了这个。即使看起来永远不会改变的事情，最终也会改变。

* * *

任何改变用户拨打或接听电话能力的事情都将与 Apple 对第三方应用程序的基本方法相冲突。有很多事情是有问题的，你可能会侥幸逃脱。显然禁止阻止呼叫。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2016-11-08T09:10:18.950

现在可以检测和阻止来自**iOS 10**及更高版本的不需要的电话。

查看[CallKit](https://developer.apple.com/reference/callkit)框架

> CallKit 框架 (CallKit.framework) 让 VoIP 应用程序与 iPhone UI 集成并为用户提供出色的体验。使用此框架可让用户在锁定屏幕上查看和接听传入的 VoIP 呼叫，并在电话应用程序的收藏夹和最近视图中管理来自 VoIP 呼叫的联系人。
> 
> CallKit 还引入了支持呼叫阻止和呼叫者识别的应用程序扩展。您可以创建一个应用扩展程序，将电话号码与姓名相关联，或者告诉系统何时应该阻止某个号码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-19T18:39:11.803

许多事件可能会中断应用程序 - 来电、SMS 消息或日历警报。如果用户忽略中断，您的应用程序将继续运行。如果没有，它将终止。

有关更多详细信息，请参阅[Apple 文档](http://developer.apple.com/iPhone/library/documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/ApplicationEnvironment/ApplicationEnvironment.html#//apple_ref/doc/uid/TP40007072-CH7-SW14)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-03-06T08:04:19.937

在 iOS 10 中是可能的。

这是怎么做的->

**1.创建呼叫目录扩展** [![在此处输入图像描述](https://i.stack.imgur.com/UOiXd.png)](https://i.stack.imgur.com/UOiXd.png)

**2.屏蔽来电 ->**

```
class CustomCallDirectoryProvider: CXCallDirectoryProvider {
    override func beginRequest(with context: CXCallDirectoryExtensionContext) {
        let blockedPhoneNumbers: [CXCallDirectoryPhoneNumber] = [ phone Numbers here with country code! ]
        for phoneNumber in blockedPhoneNumbers.sorted(by: <) {
            context.addBlockingEntry(withNextSequentialPhoneNumber: phoneNumber)
        }

        context.completeRequest()
    }
} 
```

注意：如果您使用 callKit 接听来电，则无需手动阻止其他呼叫。

链接-> [https://developer.apple.com/reference/callkit](https://developer.apple.com/reference/callkit)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-10-10T14:52:15.130

应用程序无法访问电话功能，也无法阻止呼叫。
另一种选择是等待苹果将来提供该功能。

同时，您可以

*   询问您的提供商 - 一些提供商会这样做
*   创建与某个号码关联的自定义铃声（静音）（无铃声）。

# java - Java中是否存在用于满足接口的空方法的习语？

> ID：884292
> 
> 赞同：27
> 
> 时间：2009-05-19T18:19:47.247
> 
> 标签：java, interface, annotations, oop, idioms

假设我有一个`Foo`实现接口的类，例如`MouseListener`. 该`MouseListener`接口由五种方法组成，但我只想覆盖其中一种（`mouseClicked()`）。是否有一种标准的、惯用的方式来格式化其他方法？

我的倾向是写以下内容：

```
@Override
public void mouseClicked(MouseEvent e) {
    // (...) <-- actual code here
}

@Override
public void mouseEntered(MouseEvent e) {
    // Do nothing.  Exists to satisfy MouseListener interface.
}

@Override
public void mouseExited(MouseEvent e) {
    // Do nothing.  Exists to satisfy MouseListener interface.
}

@Override
public void mousePressed(MouseEvent e) {
    // Do nothing.  Exists to satisfy MouseListener interface.
}

@Override
public void mouseReleased(MouseEvent e) {
    // Do nothing.  Exists to satisfy MouseListener interface.
} 
```

我很喜欢明确表示方法是有意留白而不是意外留白，但我并不热衷于放弃几乎没有任何东西的所有垂直空间。我还看到了以下格式：

```
public void mouseClicked(MouseEvent e) {
    // (...) <-- actual code here
}

public void mouseEntered(MouseEvent e) {}
public void mouseExited(MouseEvent e) {}
public void mousePressed(MouseEvent e) {}
public void mouseReleased(MouseEvent e) {} 
```

我对此一般没问题，并且我理解作者的意图，但是当添加（[推荐](https://stackoverflow.com/questions/212614/should-a-method-that-implements-an-interface-method-be-annotated-with-override)的）`@Override`注释时，它变得非常难看。

我不是一个特别有经验的 Java 编码器，所以我想我会问是否有约定。想法？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-19T18:29:37.153

在这种特殊情况下，您应该遵循 wilums2 的建议并扩展 MouseAdapter 而不是实现 MouseListener。这些适配器类的目的是让您在只实现接口的某些方法时不必提供空实现。

更一般地说，简短的回答是“不”，没有关于如何记录空方法的标准约定，尽管我通常使用类似的东西

```
@Override
void foo() {
  // No implementation necessary
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-19T18:23:37.850

我的做法和你一样，如果一条线上什么都没有。也许在一大堆“实施单线”之上发表评论。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-20T14:00:22.540

一般来说，您所说的是空对象模式的扩展。您正在定义一个 Null 对象并仅通过覆盖您关心的方法来扩展它。

作为自动化方法的示例，在我的 JavaDude Bean Annotations ( [http://code.google.com/p/javadude/wiki/Annotations](http://code.google.com/p/javadude/wiki/Annotations) ) 中，您可以执行以下操作。[注意：我不建议对 MouseListener 执行此操作，因为 MouseAdapter 已经存在并且您可以将其子类化...以下对于您只想实现一些选择方法的其他大型接口很有用]

```
@Bean(nullObjectImplementations = @NullObject(type=MouseListener.class))
public class MyMouseHandler extends MyMouseHandlerGen {
    public void mouseClicked(MouseEvent e) {
        // your handling of a MouseClick
    }
} 
```

然后您可以使用 MyMouseHandler 来处理点击。=

注意：对于 JRE/JDK 中的类名称，MouseAdapter 是一个*非常*糟糕的选择。它不是 GoF 适配器模式的一个实例；它实际上是 MouseListener 的 Null Object 实现。

顺便说一句：您可以将 @Override 与方法声明放在同一行 - 对于您的示例，您可以拥有

```
@Override public void mousePressed(MouseEvent e) { /* not needed */ }
// et al 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-19T18:21:47.090

使用鼠标适配器

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-01-10T11:59:37.710

有几种方法可以做到这一点。[Oracle java 约定](http://www.oracle.com/technetwork/java/codeconventions-150003.pdf)p6.4（第11 页）说空方法应该看起来像

```
public void empty() {} 
```

还有一份史蒂夫·约哈南 ( [Steve Yohanan](http://yohanan.org/steve/projects/java-code-conventions/) ) 写于 2003 年 ant 的文件，上面写着

```
public void empty()
{
} 
```

虽然我还没有找到“作为接口存根的空方法”的任何约定。因此，作为结论，没有标准化的方法来做到这一点。有些人喜欢留下评论，有些人喜欢让它成为单行，有些人喜欢用空白正文写成任何其他方法。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-19T18:26:33.617

MouseAdapter 非常适合这种特定情况，而 Adapter 习惯用法通常也很棒。适配器具有接口的所有方法的空实现，允许您子类化并仅实现与您的类相关的那些方法。正如 Andrew Hare 建议的那样，适配器也可以抛出 NotImplementedException。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-19T18:31:53.547

侦听器的目的是通知某些事件。如果侦听器接口包含的方法回调比您需要的多，那么只需忽略您不关心的那些。在您的情况下`MouseAdapter`，正是为此目的而设计的。不要抛出，**因为**`UnsupportedOperationException`调用者很可能不会期待异常。它也很可能违反了侦听器接口的约定，因为每个方法都需要实现。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-08-25T14:06:26.160

我在搜索这个确切的问题时发现了这一点。我在需要 onScrollStateChanged 而不是 onScroll 的地方使用滚动。我倾向于：

```
@Override
public void onScroll(AbsListView view, int firstVisibleItem, int visibleItemCount,
            int totalItemCount) {
    return;         
} 
```

但是，我喜欢您给出的第二个示例（在同一行带有大括号）。它紧凑而干净，可以始终如一地表达故意留白的想法。

编辑：这就是我决定的：

```
@Override
public void onScroll(AbsListView view, int firstVisibleItem, int visibleItemCount,
            int totalItemCount) {return;} 
```

这个有很多参数，所以它看起来不像在一条线上那么好，但你明白了。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-19T18:32:19.740

我想我会将其描述为“无操作实现”，或者使用“适配器”一词。正如其他人所指出的，Java 提供了一个`MouseAdapter`可以满足您需求的类。严格来说，它并不完全属于适配器模式的定义，它将一种 API 转换为另一种，但坦率地说，我倾向于务实地命名这些东西。

可能最重要的事情是明确您打算让该方法没有实现。在 的特定情况下`MouseAdapter`，您可能不想到处乱扔`UnsupportedOperationException`，但总的来说，这可能是一个很好的信号，表明您不打算提供实现。在源代码（或者更好的是方法文档）中的注释来解释为什么你没有完全实现接口通常是必要的。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-19T18:36:07.050

我不认为这特别重要。就我个人的喜好而言，我不喜欢在开口旁边看到右大括号，它给出了：

```
public void mouseEntered(MouseEvent e) {
} 
```

有点空，但还好。在返回值的情况下，我们可以使它看起来一致，这是您无法使用的`[]`样式。

但是当谈到循环中的罕见情况时，我喜欢其中的分号：

```
// Made up example.
while (++i < len && str.charAt(i) != '\0') {
    ;
} 
```

这会给：

```
public void mouseEntered(MouseEvent e) {
    ;
} 
```

对于`catch`子句，您最好在评论中有一个很好的借口（也许放弃中断）。

# apache - 关闭 Firefox、Apache、PHP 插件等上的所有缓存

> ID：884304
> 
> 赞同：0
> 
> 时间：2009-05-19T18:22:38.803
> 
> 标签：apache, caching

我想关闭在 Linux 下运行的 Apache 上的所有缓存，以及 Firefox 上的所有缓存……还有其他地方可以缓存吗？我希望我的 PHP 和 .css 文件在开发过程中始终从磁盘中更新。

**免责声明：**我问的是 Apache 作为**开发工具**，而不是作为部署平台。如果我询问 IIS 以及它为什么要缓存 .DLL，这被认为是 DEV 问题。这也是一个开发问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-19T18:28:57.467

Apache 默认不缓存。

在 firefox 上导航到**about:config**并将**browser.cache.disk.enabled** 和**browser.cache.memory.enable**更改为**false**。

如果您正在使用缓存页面的 PHP 框架，您需要禁用它，或者准备好需要手动清除它。

您可能要查找的唯一另一件事是，如果您使用的是调试代理，它也没有缓存任何内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-19T18:29:35.983

Firefox 缓存禁用，在 about:config:

*   设置`browser.cache.disk.enable`为`false`
*   设置`browser.cache.memory.enable`为`false`
*   设置`browser.cache.offline.enable`为`false`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-19T18:38:02.383

既然您使用的是 Firefox，我可以简单地推荐一下Chris Pederick相当出色的[Web Developer Toolbar吗？](https://addons.mozilla.org/en-US/firefox/addon/60)它有许多用于禁用缓存、JavaScript、操作会话和 cookie 等的选项。

显然，我向您推荐它的缓存选项，但它的其余部分通常是非常方便的东西。它可能比手动切换选项更方便`about:config`。

# javascript - 减少 sifr 渲染时间

> ID：884307
> 
> 赞同：0
> 
> 时间：2009-05-19T18:22:58.087
> 
> 标签：javascript, flash, sifr, render, lag

我在此页面上的一些项目中使用了 sifr：http: [//blueprint.staging.dante-studios.com/public/templates/home.php](http://blueprint.staging.dante-studios.com/public/templates/home.php)

不幸的是，渲染似乎很慢，有没有人知道如何：

a) 加快渲染过程 b) 隐藏所有“待筛选”项目，直到所有项目都准备好？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-20T05:19:54.160

是的。。我用过sIFR很多次了，帮了我很多。。游客说渲染也很慢。我有一种解决方案可以更改为**[Cufon](http://cufon.shoqolate.com/generate/)**。

Cufon 更令人兴奋，因为它不使用任何浏览器插件。另一方面，Cufon 只需要启用 JavaScript。只是一个建议；）

[Cufon 演示](http://www.cameronmoll.com/articles/cufon/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-20T21:37:25.940

这里有一些建议：

*   Flash 影片嵌入了粗体和斜体以及粗体 + 斜体字形。如果你不需要这些，它们就会给电影增加不必要的重量。其他角色也一样。
*   您可以删除`sifr-config`文件中的所有 JavaScript 注释。
*   不建议使用 Flash 透明度，因为它的渲染有点重。
*   要改善初始显示，请查看[比率](http://wiki.novemberborn.net/sifr3/Ratio+Calculation)
*   尝试在 jQuery 之前加载 sIFR 代码

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-19T20:03:06.867

存在与 SIFR 相关的性能损失。不幸的是，速度部分取决于客户端计算机的速度。缩短时间的唯一方法是减少 SIFR 的使用，或者完全删除它并使用图像来确保字体以您想要的方式呈现。

此外，请确保您的字体文件仅包含您正在使用的字母，以减少下载时间。

# javascript - 使用 innerHTML.replace 替换文本以创建链接

> ID：884313
> 
> 赞同：1
> 
> 时间：2009-05-19T18:24:04.667
> 
> 标签：javascript, sharepoint, wss, innerhtml

我正在使用 Sharepoint (WSS 3.0)，不幸的是，它在格式化调查问题的能力方面非常有限（即，它会删除您输入的任何 HTML）。我在其他地方看到了一个解决方案，建议我们在母版页文件中添加一些 JS 以允许换行。这很好用，但我想看看我们是否也可以允许链接。

在我们的 WSS 调查中，我现在可以在任何需要换行符的地方使用 {{br}}（这很有效）。我尝试扩展代码以允许使用链接标签（例如，{{link1}}url{{link2}}URL Title{{link3}}；但是，这不起作用，大概是因为更新不是作为一个整体发生，然后浏览器尝试逐个渲染它，使其混淆。（FF和IE显示不同的结果，但都失败了。如果我混淆了下面JS的顺序 - 即，做link3, 2然后 1 - 输出也发生变化，但仍然失败。）有没有更好的方法来做到这一点？

* * *

```
<script language="JavaScript">
var className;
className = 'ms-formlabel';
var elements = new Array();
var elements = document.getElementsByTagName('td');
for (var e = 0; e < elements.length; e++)
{
if (elements[e].className == className){
elements[e].innerHTML = elements[e].innerHTML.replace(/{{br}}/g,'<br/>');
elements[e].innerHTML = elements[e].innerHTML.replace(/{{link1}}/g,'<a href="');
elements[e].innerHTML = elements[e].innerHTML.replace(/{{link2}}/g,'">');
elements[e].innerHTML = elements[e].innerHTML.replace(/{{link3}}/g,'</a>');}
}
</script> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-19T18:28:23.130

不要以块的形式修改 innerHTML 属性（每次更改 innerHTML 时，浏览器都会尝试更新 DOM，如果您提供不完整/损坏的标记，显然会搞砸），而是针对您自己的字符串变量进行所有修改，然后用您完成的字符串覆盖整个 innerHTML：

```
<script language="JavaScript">
var className;
className = 'ms-formlabel';
var elements = new Array();
var elements = document.getElementsByTagName('td');
for (var e = 0; e < elements.length; e++)
{
if (elements[e].className == className) {
    var newHTML = elements[e].innerHTML;

    newHTML = newHTML.replace(/{{br}}/g,'<br/>');
    newHTML = newHTML.replace(/{{link1}}/g,'<a href="');
    newHTML = newHTML.replace(/{{link2}}/g,'">');
    newHTML = newHTML.replace(/{{link3}}/g,'</a>');}

    elements[e].innerHTML = newHTML;
}
</script> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-19T18:29:02.023

简单的答案是构建 innerHTML 并立即将其全部替换：

```
for (var e = 0; e < elements.length; e++)
{
    if (elements[e].className == className) {
        var newHTML = elements[e].innerHTML;
        newHTML = newHTML.replace(/{{br}}/g,'<br/>');
        newHTML = newHTML.replace(/{{link1}}/g,'<a href="');
        newHTML = newHTML.replace(/{{link2}}/g,'">');
        newHTML = newHTML.replace(/{{link3}}/g,'</a>');
        elements[e].innerHTML = newHTML;
    }
} 
```

更复杂的答案是在你的正则表达式中使用捕获组并将一个函数作为第二个参数传递给replace()，以便对HTML 使用一个replace() 调用。例如，

```
elements[e].innerHTML = elements[e].innerHTML.replace(/({{link1}})|({{link2}})|({{link3}})/g, 
    function (match) {
        var map = { 
            '{{link1}}' : '<a href="',
            '{{link2}}' : '>',
            '{{link3}}' : '</a>', }
        return map[match];
    }); 
```

第二种解决方案更复杂，会导致一些丑陋的正则表达式，但比一遍又一遍地调用 replace() 更有效。

# c# - 如何向上转换为通用对象？

> ID：884315
> 
> 赞同：2
> 
> 时间：2009-05-19T18:24:45.117
> 
> 标签：c#, generics, casting

我有一组 IRegistration[] 类型的 Castle Windsor 注册组件

在这种情况下`ComponentRegistration<T> : IRegistration`

对于我的数组中的每个元素，如果它可以向上转换为 ComponentRegistration<> 我想将它向上转换回`ComponentRegistration<T>`并处理它。我该怎么做呢？

我做到了

```
foreach (var r in registrations) {
  if(typeof(ComponentRegistration<>).IsAssignableFrom(r.GetType())) {
    var cr = CAST r SOMEHOW
    DoStuff(cr);
  } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-19T18:30:22.020

当然，如果你有一个`IRegistration[]`then 你正在*向下转换*而不是向上转换。

但是，要解决您的问题，它是什么`DoStuff()`样的？它需要知道类型参数`ComponentRegistration<T>`吗？如果没有，您最好创建一个非泛型基类：

```
public abstract class ComponentRegistration : IRegistration
{
    // Anything in the original API which didn't use T
}

public class ComponentRegistration<T> : ComponentRegistration
{
    // The bits which need T
} 
```

然后你可以写：

```
foreach (var r in registrations)
{
    ComponentRegistration cr = r as ComponentRegistration;
    if (cr != null)
    {
        DoStuff(cr);
    }
} 
```

如果您确实需要`DoStuff`使用通用信息，则必须使用反射来获取适当的类型并调用它。尽可能避免:)

编辑：好的，这是反射讨厌的一个例子。它不会尝试考虑通用接口，因为这会变得更加棘手。

```
using System;
using System.Reflection;

class Test
{   
    static void Main()
    {
        Delegate[] delegates = new Delegate[]
        {
            (Action<int>) (x => Console.WriteLine("int={0}", x)),
            (Action<string>) (x => Console.WriteLine("string={0}", x)),
            (Func<int, int>) (x => x + 1)
        };

        MethodInfo genericPerformAction = typeof(Test).GetMethod
                                                       ("PerformAction");

        foreach (Delegate del in delegates)
        {
            Type t = DiscoverTypeArgument(del, typeof(Action<>));
            if (t == null)
            {
                // Wrong type (e.g. the Func in the array)
                continue;
            }
            MethodInfo concreteMethod = genericPerformAction.MakeGenericMethod
                (new[] { t } );
            concreteMethod.Invoke(null, new object[] { del });
        }
    }

    public static void PerformAction<T>(Action<T> action)
    {
        Console.WriteLine("Performing action with type {0}", typeof(T).Name);
        action(default(T));
    }

    /// <summary>
    /// Discovers the type argument for an object based on a generic
    /// class which may be somewhere in its class hierarchy. The generic
    /// type must have exactly one type parameter.
    /// </summary>
    /// <returns>
    /// The type argument, or null if the object wasn't in
    /// the right hierarchy.
    /// </returns>
    static Type DiscoverTypeArgument(object o, Type genericType)
    {
        if (o == null || genericType == null)
        {
            throw new ArgumentNullException();
        }
        if (genericType.IsInterface ||
            !genericType.IsGenericTypeDefinition || 
            genericType.GetGenericArguments().Length != 1)
        {
            throw new ArgumentException("Bad type");
        }

        Type objectType = o.GetType();
        while (objectType != null)
        {
            if (objectType.IsGenericType &&
                objectType.GetGenericTypeDefinition() == genericType)
            {
                return objectType.GetGenericArguments()[0];
            }
            objectType = objectType.BaseType;
        }
        return null;
    }
} 
```

编辑：请注意，*如果*您处于*所有*成员都派生自相关类的情况，并且*如果*您使用的是 C# 4，则可以使用动态绑定：

```
using System;
using System.Reflection;

class Test
{   
    static void Main()
    {
        Delegate[] delegates = new Delegate[]
        {
            (Action<int>) (x => Console.WriteLine("int={0}", x)),
            (Action<string>) (x => Console.WriteLine("string={0}", x)),
            (Action<long>) (x => Console.WriteLine("long={0}", x)),
        };

        foreach (dynamic del in delegates)
        {
            // Yay for dynamic binding
            PerformAction(del);
        }
    }

    public static void PerformAction<T>(Action<T> action)
    {
        Console.WriteLine("Performing action with type {0}", typeof(T).Name);
        action(default(T));
    }
} 
```

不幸的是，我不知道有任何方法可以测试它是否能够成功绑定到该方法，而不仅仅是尝试它并捕获相关异常（这将是严峻的）。也许埃里克能告诉我们:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-19T18:30:20.163

不幸的是，没有任何一个你都无法做到这一点

1.  具有非通用形式的 ComponentRegistration
2.  知道T
3.  使用反射黑客

**编辑**反射黑客

本质上，您需要使用反射来获取运行时类型。检查类型以获取 ComponentRegistration 中的泛型 T。然后使用该 T 实例化方法 DoStuff 的实例并将对象作为参数传入。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-08-17T17:41:14.283

如果您尝试向上转换的类是从泛型派生的非泛型，则可以通过**Object**进行转换来解决此问题：

```
abstract class A<T> where T : A<T>
{
    T derived;
    void foo()
    {
        B b1 = (B)derived;      // Error CS0030: 'Cannot convert type 'T' to 'B'
        B b2 = (B)(Object)derived;  // Ok
    }
};

class B : A<B> { }; 
```

# wordpress - 查找 WordPress 帖子中使用的图像的简单方法？

> ID：884316
> 
> 赞同：0
> 
> 时间：2009-05-19T18:25:04.027
> 
> 标签：wordpress

wordpress API 中是否有任何内容可以显示帖子中使用的图像列表？还是我需要查看帖子的内容才能找到它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-19T18:30:02.490

好吧，在彻底寻找答案之前，我再次问了一个问题。一个快速的谷歌搜索出现了以下代码片段：

```
$arrImages =& get_children('post_type=attachment&post_mime_type=image&post_parent=' . $iPostID ); 
```

我在[http://wphackr.com/](http://wphackr.com/)找到了这个。

# asp.net - ASP.NET 成员资格提供程序 - 验证散列安全问题/答案

> ID：884317
> 
> 赞同：2
> 
> 时间：2009-05-19T18:25:22.170
> 
> 标签：asp.net, membership-provider

在我添加的页面上检索忘记的用户名

步骤 1) 输入电子邮件地址（通过电子邮件获取帐户）

第 2 步）验证安全问题（他们提供答案并由我验证）

步骤 3) 向他们发送一封包含用户名的电子邮件

第2步是我卡住的地方。如何使用数据库中存储的内容验证答案？

所有值都经过哈希处理。

我看到发布了与此类似的其他问题，但他们没有回答这个问题，至少不是很清楚。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-19T18:35:35.037

就像你说的，数据库中的值是散列的，所以为了验证用户输入的内容与数据库中的内容相匹配，对用户输入的值进行散列并比较两个散列值。如果它们相等，则验证。

在将答案文本与数据库中的值进行比较之前，您基本上需要对答案文本进行哈希处理。

另外，请注意，有时答案文本会在散列之前用一个值加盐，因此在验证时需要采取相同的步骤。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-19T18:39:18.697

查看提供程序，它没有公开任何方法供您执行所需的第二步。

您将需要执行以下操作。

1.  创建一个存储过程，该过程将根据电子邮件和答案检索结果。
2.  正如您所提到的，因为答案是散列的，您需要对用户提供的值进行 MD5 散列。（`FormsAuthentication.HashPasswordForStoringInConfigFile`会为此工作）
3.  使用所需的参数调用您的存储过程，以验证用户信息是否匹配。

# wpf - wpf 文本框文本换行

> ID：884324
> 
> 赞同：10
> 
> 时间：2009-05-19T18:26:29.513
> 
> 标签：wpf, textbox, grid, word-wrap

我需要帮助。不知道这是否可能。我想要以下内容：

```
 <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>
        <TextBox TextWrapping="Wrap" MinLines ="5"/>
    </Grid> 
```

这是一个包含在宽度 * 的网格列内的文本框。我希望文本框采用所有可用宽度（因此 *），但是当用户添加文本时，我希望它在到达行尾时换行（有可用空间）。

目前，上面将给出一个具有整个宽度的文本框，但是当输入文本时，文本框的宽度只会随着文本而增长。

我知道我可以设置 MaxWidth=?，但列是 * 的点是我不知道列的大小是多少。

我想对文本框说“不要增长，无论 wpf 给你什么，不要再增加一个像素”。

我认为我想要的是不可能的，因为 wpf 询问控件它想要多大，并且当用户添加更多超出边界的文本时，它会请求更多空间并将其宽度扩展到无穷大。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-19T18:36:56.033

`MaxWidth`尝试将您的属性绑定到已加星标的列`TextBox`的`ActualWidth`属性（您必须为列命名才能执行此操作）。我很确定我过去做过类似的事情。

就像是：

```
MaxWidth={Binding ElementName=MyColumn, Path=ActualWidth} 
```

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-19T18:43:02.780

`Grid.Column="1"`当我在 TextBox 上设置时，似乎对我来说可以正常工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-20T18:37:58.767

除了 RandomEngy 所说的之外`Grid.Column="1"`，您可能还必须在其`Grid`自身上设置一些对齐属性，特别是如果它设置在另一个具有不同子行为的容器中`Stretch`（例如 a `StackPanel`）。

# wpf - 程序集中的 WPF 资源

> ID：884330
> 
> 赞同：0
> 
> 时间：2009-05-19T18:27:35.240
> 
> 标签：wpf, resources

是否可以使用 Lutz 的反射器在 .NET 中的 WPF 程序集中浏览 WPF 资源？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-19T18:45:35.803

There is a BAML addin for Reflector. [http://reflectoraddins.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=1805#DownloadId=9088](http://reflectoraddins.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=1805#DownloadId=9088)

# sql-server - TSQL：触发器中的 Try-Catch 事务

> ID：884334
> 
> 赞同：16
> 
> 时间：2009-05-19T18:28:25.657
> 
> 标签：sql-server, tsql, triggers

我正在尝试使用 Microsoft Server 2005 将 try-catch 语句放入触发器中。

```
BEGIN TRANSACTION
BEGIN TRY
    --Some More SQL
    COMMIT TRANSACTION
END TRY
BEGIN CATCH
    IF (XACT_STATE()) = -1
    BEGIN
        ROLLBACK TRANSACTION;
    END;
END CATCH 
```

问题是，如果 try-catch 块捕获了某些内容，我不希望触发器失败。目前，我收到错误“事务在触发器中结束。批处理已中止。” 如果交易失败。如何让触发器优雅地失败？

* * *

此外，如果我删除事务，我会收到错误“事务在触发器中注定失败。批处理已中止。”。

```
BEGIN TRY
    --Some More SQL
END TRY
BEGIN CATCH
    return
END CATCH 
```

有没有办法解决？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-19T19:01:59.987

In my experience any error caught in a try catch in a trigger will rollback the entire transaction; you may be able to use a save transaction. I think you need to look at whats happening in "Some more sql" and determine if you can write case / if statements around it to stop the error.

What you may be able todo depending on what you are doing is use a [save transaction](http://msdn.microsoft.com/en-us/library/ms188378.aspx) and capture that in the catch

In your code something like this

```
SAVE TRANSACTION BeforeUpdate;
BEGIN TRY
        --Some More SQL
END TRY
BEGIN CATCH
ROLLBACK TRANSACTION BeforeUpdate;
        return
END CATCH 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-19T18:32:16.493

不要在触发器中回滚，也不需要启动事务。

这`ROLLBACK TRANSACTION`也将回滚原始 DML 触发器*和*额外的触发器事务。所以批次将被中止

编辑：

我建议不要在你的 catch 块中使用“RETURN”，而只是让代码完成我从来没有忽略触发器中的捕获错误（但我确实在触发器中使用 TRY/CATCH 并使用 rollback 和 raiserror 重新抛出）所以这是一个猜测，但返回可能是触发器中的异常退出条件

另外，首先要尽量避免错误情况。更改`--some more sql`以避免错误。示例，添加`if exists(...`以首先测试重复项或类似项

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2017-04-20T17:25:56.650

使用 SET XACT_ABORT OFF 。当 Transact-SQL 语句遇到错误时，它只是引发错误消息并且事务继续处理。以下代码是创建触发器：

```
Create TRIGGER [dbo].tr_Ins_Table_Master ON [dbo].Table_Master
 AFTER INSERT
AS
BEGIN
set xact_abort off
BEGIN TRY
        --your SQL          
        INSERT INTO Table_Detail
        SELECT MasterID,Name FROM INSERTED

END TRY

BEGIN CATCH     
    select ERROR_MESSAGE()
END CATCH

END 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-12-02T13:53:57.750

为避免在触发操作之前丢失事务数据，您需要调用 COMMIT TRAN。在 TRY/CATCH 块之前执行此操作，您将获得所需的结果。

例子：

```
COMMIT TRAN
BEGIN TRY
    -- possible error occurs here...
END TRY
BEGIN CATCH
    PRINT 'Error on line ' + CAST(ERROR_LINE() AS VARCHAR(10))
    PRINT ERROR_MESSAGE()
END CATCH 
```

它仍然会引发以下错误 - 不知道如何避免：

```
The transaction ended in the trigger. The batch has been aborted. 
```

但是原始事务和触发事务都应该成功提交。

更新：为避免异常最后一个错误，请在 TRY 语句中调用 BEGIN TRAN。请注意，Microsoft 建议不要在触发器中调用 COMMIT TRAN，但如果不可避免，这应该适合您。

例子：

```
COMMIT TRAN
BEGIN TRY
    BEGIN TRAN 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-10-12T12:51:50.257

这个演示实现了上面提到的许多事情。错误消息成为可选的。使其工作的技巧在于嵌套的动态执行。

```
 if object_id('toto')  is not  null drop table toto
    go
    create table toto (i int);
    go
    if object_id('toto2')  is not  null drop table toto2
    go
    create table toto2 (i int);
    go
    create Trigger trtoto
    ON toto
    Instead Of Insert
    as
    Begin
      BEGIN TRY
        set nocount  on
        insert into  toto  values(2)

        declare @sql nvarchar(max) =  'insert into toto2 values(3); select * from ThisTableDoesntexist'

        Exec sp_executeSql N'set xact_abort off; exec (@sql) ', N'@sql nvarchar(max)', @sql

      END TRY

      BEGIN CATCH
        PRINT  'Error on line ' + CAST(ERROR_LINE() AS VARCHAR(10))
        PRINT ERROR_MESSAGE()
      END CATCH
    End

GO
-- tests
set nocount on
insert into toto values (1)  -- is not inserted on purpose by  the trigger
select * from toto   -- other value inserted despite the error
select * from toto2  -- other value inserted in other table despite the error 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-19T19:57:36.643

u07ch,

不幸的是，您不能同时使用 save transaction 和 try.. catch - 它们根本无法一起工作：

[http://sqlblog.com/blogs/alexander_kuznetsov/archive/2008/11/15/avoid-mixing-old-and-new-styles-of-error-handling.aspx](http://sqlblog.com/blogs/alexander_kuznetsov/archive/2008/11/15/avoid-mixing-old-and-new-styles-of-error-handling.aspx)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-19T20:48:57.853

了解您在触发器中尝试执行的操作可能会有所帮助。

触发器是将数据发送到插入或删除表的事务的一部分。如果失败，它将回滚整个事务。如果您希望触发器偶尔会失败，但不会回滚导致触发器触发的语句，那么您可能需要重新考虑触发器是否适合使用。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-12-07T11:36:27.333

不是最好的方法，但它有效。开始一个新事务并进行正常的提交回滚，最后开始另一个事务以进行隐式事务提交

[http://msdn.microsoft.com/en-us/library/ms187844(v=SQL.90).aspx](http://msdn.microsoft.com/en-us/library/ms187844(v=SQL.90).aspx)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-07-22T07:02:06.090

您可以在触发器开始时将 XACT_Abort 设置为 OFF。

# .net - .NET 应用程序的嵌入式 Web 服务器和 gui 框架

> ID：884343
> 
> 赞同：4
> 
> 时间：2009-05-19T18:29:54.050
> 
> 标签：.net, frameworks, webserver, embeddedwebserver

我正在寻找一个框架，它允许我通过基于 Web 的 GUI（使用嵌入式 Web 服务器）而不是 winforms 来管理我的应用程序。

像这样的东西：[http](http://www.webtoolkit.eu/wt) ://www.webtoolkit.eu/wt 但是对于.NET

在我的代码中，我应该能够实例化类（如按钮、表单等），并且当用户浏览到给定端口时，应用程序应该将其呈现为 javascript/ajax 等。最好在按下按钮时，通知我的代码应该被调用。

与我发布的关于 extjs 的另一个问题相比，这是一个不太具体的问题。我希望这会吸引更多的观众，因为它更通用

谢谢。

* * *

更新：

类似卡西尼的解决方案不符合要求。由于网络浏览器嵌入在我的应用程序中，因此不需要 ASP.NET 服务器端脚本。我宁愿拥有框架，当页面上发生事情时，在我的应用程序中调用函数。例如 onButtonClicked()。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T08:16:23.077

您可以将[System.Net.HttpListener 类](http://msdn.microsoft.com/en-us/library/system.net.httplistener.aspx)用作嵌入式网络服务器。HttpListener 将为您完成低级别的工作，但您必须自己编写返回 Html/javascript/images 的代码。

我自己尝试一下只是为了好玩，使用[GeckoFx](http://code.google.com/p/geckofx/)将 firefox嵌入到应用程序本身中嵌入的 Web 服务器上。它似乎运作良好，但我的测试非常简单且有限。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T07:35:46.310

嵌入[Cassinni](http://www.asp.net/downloads/archived/cassini/)并使用 ASP.NET 怎么样？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-29T05:44:55.703

您可以在自己的应用程序中托管 ASP.NET 运行时，并使用任何 Web UI 框架，如 LiveUI 或类似的东西。[在此处](http://www.microsoft.com/belux/msdn/nl/community/columns/desmet/hostaspnet1.mspx)查看如何执行此操作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-29T05:18:55.037

如果您可以使用 ASP.NET（使用开发服务器或 cassini），那么您的任务会更简单。我强烈推荐这种方法。在这种情况下，您可以使用 liveui、componentart 或 teleric。liveui 提供了基于 Extjs 的框架来实现 3-tiered web 应用程序。componentart 和 teleric 提供了不错的 ASP.net 控件。

而 webui 可能可以在没有 ASP.net 基础设施的情况下作为 httpHandler 工作。但我不建议使用 webui，因为 1 潜在的性能问题 2 复杂且不灵活的编程模型。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-30T20:14:51.890

您是否受限于您的应用程序可以支持的框架？如果您可以使用 .NET 3.0+，则可以使用[Windows Presentation Foundation](http://msdn.microsoft.com/en-us/netframework/aa663326.aspx)来定位 Web（通过 xbapp 或 silverlight）和传统的 Windows 窗体应用程序。

就应用程序之间的通信而言，这就是[Windows Communication Foundation](http://msdn.microsoft.com/en-us/netframework/aa663324.aspx) (WCF) 真正发挥作用的地方。

澄清一下，您可以使用 Casini 托管您的 Web 应用程序并使用 WCF 在它与您的应用程序之间进行通信，或者使用 xaml 标记您的应用程序并将其公开为具有相同 UI 的 Web 应用程序和普通 Windows 应用程序。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-25T12:55:07.347

如果您想将运行中的 WinForms 代码自动转换为 HTML，那么您已经陷入了困境。我用[Visual WebGui](http://www.visualwebgui.com/)做过类似的事情，但它确实需要修改你的代码，并且基本上会为你生成一个 ASP.NET 应用程序——需要一个实际的 Web 服务器来运行它。

我看到您不喜欢 Cassini 选项——如果您还希望它在*没有*Web 服务器的情况下也能工作，那么我认为快速回答是“没办法”。

如果您有一个相对简单的界面，我认为您最好的选择可能是从您现有的表单或从头开始动态生成 HTML 代码，并使用 System.Net.HttpListener。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-25T17:59:57.253

我很久以前做过一个 .NET 2.0 项目，它基本上有一个[Webbrowser](http://msdn.microsoft.com/en-us/library/system.windows.forms.webbrowser.aspx)控件。
我将通过它的 Document 属性为 WebBrowser 控件提供 html，并监听导航事件，以便从我的资源中获取 Html（或立即构建它）并将其再次提供给 WebBrowser 控件。

现在乐趣从[ObjectForScripting](http://msdn.microsoft.com/en-us/library/system.windows.forms.webbrowser.objectforscripting.aspx)属性开始。这允许您的 html 页面通过 Javascript 与 .NET 对象对话，例如：`window.external.SomeNetFunction(bla)`.
不要忘记将`ComVisible`属性添加到`ObjectForScripting`.

我希望这就是你要找的。在这个解决方案中，您有一个可以导航的网页，也可以通过 javascript 与您的应用程序对话。（像这样你可以接近 .NET 版本的 AIR...）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-01T07:05:07.667

DevExpress 有一个产品可以满足您的需求。不过，您将不得不为此付出代价...

[http://www.devexpress.com/Products/NET/Application_Framework/](http://www.devexpress.com/Products/NET/Application_Framework/)

* * *

## 回答 #9

> 赞同：-4
> 
> 时间：2009-05-22T07:11:55.833

我建议改用 Linux 路线，并依靠嵌入式 httpd、boa 或类似的东西来缩小尺寸。不建议在嵌入式系统上运行 Windows，过多的臃肿和过多的安全漏洞。最好使用 Linux 或 RTOS。

# javascript - 如何在 javascript 中找到“原型”值？

> ID：884348
> 
> 赞同：0
> 
> 时间：2009-05-19T18:30:39.850
> 
> 标签：javascript, inheritance

我使用以下函数来检测属于对象*构造函数*而不是对象本身的值。

```
function isAPrototypeValue(object, key ) {
  return !(object.constructor && object.constructor.prototype[key]);
} 
```

这将按如下方式工作：

```
Array.prototype.base_value = 'base'
var array = new Array;
array.custom_value = 'custom'
alert( isAPrototypeValue( array, 'base_value' ) ) // true
alert( isAPrototypeValue( array, 'custom_value' ) ) // false 
```

***但是***当我开始使用继承时：

```
function Base() {
  return this
};
Base.prototype.base_value = 'base';

function FirstSub() {
  return this
};
FirstSub.prototype = new Base();
FirstSub.prototype.first_value = 'first';

function SubB () {
  return this
};
SecondSub.prototype = new FirstSub();
SecondSub.prototype.second_value = 'second';

result = new SecondSub(); 
```

我打电话给

```
alert( result.constructor ) 
```

我会得到**Base**而不是预期的**SecondSub**，这本身不是一个大问题，但是......

如果我像这样扩展**结果**：

```
result.custom_value = 'custom'
result.another_value = 'another' 
```

我本来希望能够区分属于**result**的值或属于**SecondSub、FirstSub 和 Base**的值；

例如。

```
alert( isAPrototypeValue( result, 'custom_value' ) ) // false ( as expected )
alert( isAPrototypeValue( result, 'base_value' ) ) // true ( as expected )
alert( isAPrototypeValue( result, 'first_value' ) ) // true extend, but it is false
alert( isAPrototypeValue( result, 'second_value' ) ) // true extend, but it is false 
```

如何更改**isAPrototypeValue**以生成预期结果？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-19T18:49:53.797

我想你可能想回顾一下 Douglas Crockford 关于 JavaScript 继承的文章。他在他的书[JavaScript: The Good Parts](http://oreilly.com/catalog/9780596517748/)中有一些，还有一些在他关于 YUI 剧院的讲座 < [http://developer.yahoo.com/yui/theater/](http://developer.yahoo.com/yui/theater/) > 中。要区分对象属性与派生对象的属性，请参见[`hasOwnProperty()`方法](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/Object/hasOwnProperty)。Crockford 似乎认为在 JavaScript 中使用经典继承是可能的，但不是利用语言功能的最佳方式。也许这会给你关于如何解决你想要完成的事情的想法。祝你好运！

克罗克福德关于继承：

*   [JavaScript 中的经典继承](http://javascript.crockford.com/inheritance.html)
*   [JavaScript 中的原型继承](http://javascript.crockford.com/prototypal.html)

# oop - Smalltalk 中的消息转发

> ID：884350
> 
> 赞同：4
> 
> 时间：2009-05-19T18:31:17.340
> 
> 标签：oop, smalltalk, abstraction, squeak

所以我正在编写一个应用程序，其中一个对象有一堆将消息转发到的委托对象。这个想法是我可以说

```
someObject sendMessage:aMessage 
```

并且 aMessage 将被发送给 someObject 的所有代表（对于 aMessage 的任何值）。我能够做到这一点的唯一方法是：

```
sendMessage:aMessage

| sel chunks kwords arglist msg |
chunks := aMessage findTokens:' '.
kwords := Array new:(chunks size).
arglist := Array new:(chunks size).
1 to: (chunks size) do: [:i | 
    kwords at:i put:((chunks at:i) findTokens:':') at:1.
    arglist at:i put:((chunks at:i) findTokens:':') at:2].
sel := ''.
kwords do:[:word | sel := sel,word,':'].

msg := Message selector:sel arguments:arglist.
delegates do:[:del | del perform:msg selector with:msg arguments]. 
```

它有效，但必须有更好的方法。该解决方案将参数限制为字符串，并且非常难看。有谁知道转发消息的更清洁、更好的方法？

顺便说一句，我正在使用 squeak，但最好使用独立于实现的解决方案；）

**编辑**：我应该补充一点，代表与对象属于同一类，所以我不能只覆盖 DoesNotUnderstand:。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-20T01:03:28.697

由于您想将对象作为参数传递，因此您必须将它们作为使用消息模式的单独列表传递，如下所示：

> someObject sendMessage: aSelector withArguments: argumentList

然后你会实现 #sendMessage:withArguments: 为：

> sendMessage：aSelector withArguments：argumentList
> 
> 代表做:[:del | del 执行：aSelector withArguments: :argumentList]。

并且您可以使用真实对象作为参数转发任意复杂的消息：

> | 论据 |
> 
> arguments := Array with: Object new with: 1234.5 with: ('key'->'value')。
> 
> someObject sendMessage：#foo：bar：baz：withArguments：参数

我认为这也适用于大多数方言......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-20T16:33:05.243

在 Squeak 中，请参见 ObjectTracer 类。您可以使用它来拦截所有发送到对象的消息。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-19T18:42:35.993

尝试实现这一点（它只会转发*具有*委托的对象不理解的消息）：

```
doesNotUnderstand: aMessage 
    delegates
        do: [:delegate | aMessage sendTo: delegate] 
```

您可以像这样显式构造 Message 对象：

```
msg := Message selector: #foo arguments: #(bar baz)
"then use them like:"
anObject perform: msg selector with: msg arguments 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-19T20:18:32.420

好吧，在不知道 aMessage 是什么的情况下，并且由于您提到所有委托对象都属于同一类，因此我会执行以下操作：

```
MyobjectClass>>SendMessage: aMessage

   self doSomethingUsefulOnThisInstanceIfApplicable: aMessage.
   self dependents do: [:ea | ea SendMessage: aMessage ] . 
```

您可能还想看看使用以下任何消息是否对您有用：（这些来自 Cincom VisualWORKS）

```
update: 
update:with:
update:with:from: 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-19T19:26:39.873

为什么不简单地使用多态性，即在您调用的每个对象的类中实现此方法？然后你在你的对象方法中实现同名，它只是将调用委托给所有子对象。就像是：

```
MyObjectClass>>someMethod
subobjects do: [:each | each someMethod] 
```

# sharepoint - 从 Excel 电子表格创建 SharePoint 调查

> ID：884352
> 
> 赞同：0
> 
> 时间：2009-05-19T18:31:36.527
> 
> 标签：sharepoint

我是管理员，不是程序员。有人在 serverfault 上认为我应该在这里尝试这个问题。

有没有办法将信息从外部数据源导入调查？我有一个用户，他有一个完整的电子表格（其中超过 300 个），他想在 SharePoint 中创建一些调查，以便他可以要求我们的用户根据这些措施对一些软件进行评分。

将所有 300 多项措施的手动数据直接输入到调查中将花费大量时间。有没有一种简单的方法可以将这些措施纳入调查？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-21T06:18:26.270

该调查只是一个 SharePoint 列表，其中每个问题都有一个列 - 在数据表视图中打开列表可能会得到您需要的内容。

您还可以从电子表格创建列表 - 这不是调查，但您应该能够将其导出为模板，并将列的 xml 复制到另一个作为调查的模板中。

# c# - 以编程方式将 Excel 转换为 XPS

> ID：884356
> 
> 赞同：-1
> 
> 时间：2009-05-19T18:32:11.317
> 
> 标签：c#, .net, excel, xps

我正在寻找一种以编程方式将 Excel 报告转换为 XPS 格式的方法。这在 Microsoft 框架中的任何地方都支持吗，还是我们应该寻找第三方工具？

是的，目前我们正在使用 ExcelWriter 以编程方式创建 Excel 报告，并且需要为客户生成 XPS 报告。因此，我们要么直接使用 XPS，这似乎是一个更大的学习曲线，要么将 Excel 报告转换为 XPS。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-19T18:42:06.477

Office 2007有一个[插件](http://www.microsoft.com/downloads/details.aspx?FamilyID=4d951911-3e7e-4ae6-b059-a2e79ed87041)，可让您导出为 XPS 或 PDF。通过 Microsoft.Office.interop.Excel 调用 Excel 并导出到 XPS。

从我自己的代码（工作簿是一个实例，但提供完整的命名空间）：

```
Microsoft.Office.Interop.Excel.Workbook.ExportAsFixedFormat(
    Excel.XlFixedFormatType.xlTypeXPS,
    pdfpath, Excel.XlFixedFormatQuality.xlQualityStandard,
    true, true,
    fpage, tpage,
    false,
    oMissing
); 
```

有一篇关于如何执行此操作的[MSDN 文章。](http://msdn.microsoft.com/en-us/library/bb407651.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-19T19:31:56.027

我更喜欢 Colin 建议的方法，但您也可以`SaveAs`在工作簿上使用`FileFormat`常量`18`for XPS，如相关问题中所述：

> [通过 API 将文件另存为 PDF 所需的 Excel 2007 中 PDF 的 FileType 编号是多少？](https://stackoverflow.com/questions/738829/what-is-the-filetype-number-for-pdf-in-excel-2007-that-is-needed-to-save-a-file-a)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-10-20T10:24:53.193

您还可以从 Excel 打印到 XPS。不是技术上的转换，但可能正是您所需要的。

```
Dim ws As Worksheet
Set ws = ActiveSheet
Call ws.PrintOut(ActivePrinter:="Microsoft XPS Document Writer", _
                PrintToFile:=True, PrToFileName:="S:\Temp\Test3.xps") 
```

# java - 使用 Freemarker 输出 XML

> ID：884365
> 
> 赞同：1
> 
> 时间：2009-05-19T18:35:03.340
> 
> 标签：java, spring, freemarker

我们在我们的 Web 应用程序中使用 freemarker 作为模板。为此，我们正在使用 spring 的 FreeMarkerViewResolver。

有没有办法在 freemarker 中更改响应的内容类型

文本/xml

有没有办法在模板中做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-19T20:00:08.637

您不能从模板本身执行此操作，不，但您可以使用 contentType 属性注入 FreeMarkerViewResolver，并将其设置为 text/xml （或其他）。

如果您需要为不同的视图提供不同的内容类型，则需要配置多个视图解析器。

# svn - Subversion 标记和安全性

> ID：884369
> 
> 赞同：3
> 
> 时间：2009-05-19T18:35:41.200
> 
> 标签：svn, version-control, batch-processing, pre-commit-hook

我已经从头开始建立了一个 SVN 存储库，并且我已经使用 SVN 复制命令成功地标记了我的一些版本。

我为 apache 使用了 SSPI auth 插件，所以我们的开发人员只需使用他们的网络凭据访问服务器，一切正常。

我创建了一个 AuthZ 授权文件，将我们的开发人员添加到文件中的组，并授予他们对 root 的写入权限。我还授予匿名用户对 root 的只读访问权限。

然后我使用以下命令锁定 /svn/ 目录： Require-group "CORP\CKAN0BlahBlah"

这有效地将安全组中的新开发人员限制为只读访问权限，直到他们通过 aAuthZ 配置文件获得访问权限。

现在，我有几个问题：

1.  防止用户对任何“标签”目录提交更改的正确方法是什么（除了荣誉系统）？

2.  是否可以使用 SSPI 将组的成员传递给 AuthZ，而不是在配置文件中单独列出成员？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-19T18:41:55.043

1 - 您可以使用 pre-commit hook 来防止提交，请参阅[SVN pre-commit hook for Avoid changes to tags subdirectories](https://stackoverflow.com/questions/464384/svn-pre-commit-hook-for-avoiding-changes-to-tags-subdirectories)。

**编辑：**要在 Windows 上执行此操作，请尝试以下操作：

将其保存为 repo 的 hooks 文件夹中名为 pre-commit.bat 的文件：

```
@echo off
set REPOSITORY=%1
echo %REPOSITORY% | find /I "tags"
if errorlevel 1 goto done
echo You tried to commit to %REPOSITORY% >&2
echo Committing to tags is not allowed >&2
exit 1
:done 
```

请注意，这将阻止提交到包含子字符串*tags*的任何存储库路径。根据您的需要进行修改。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-19T20:07:26.907

对于**问题#1**，我为此开发了：

```
@echo off
SET SVNLOOK=C:\Program Files\CollabNet Subversion Server\svnlook.exe
SET GREP=D:\SVN\Repo\hooks\grep.exe
SET LOG=D:\SVN\Repo Logs.txt

>>"%LOG%" echo ==== commit %1 %2 ====
>>"%LOG%" "%svnlook%" changed -t %2 %1

("%svnlook%" changed -t %2 %1 | "%grep%" "^U.*/tags/") && (echo Cannot commit to tags.>&2 && exit 1)
("%svnlook%" log -t %2 %1 | "%grep%" "[a-zA-Z0-9]") || (echo You must specify a comment.>&2 && exit 1)

exit 0 
```

[从http://sourceforge.net/projects/unxutils](http://sourceforge.net/projects/unxutils)获取 grep 工具

* * *

对于**问题 #2**，答案是否定的，您无法检查 AuthZ 配置文件中的 AD 安全组。

谢谢大家的帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-19T18:43:24.510

没有“正确”的方式。标签是一种约定，开发人员应该学习并遵循它。除此之外，可以使用 Subversion 钩子实现故障安全。请参阅[此](http://wordaligned.org/articles/a-subversion-pre-commit-hook)页面以获取不错的教程。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-19T18:49:37.573

在我看来，这是一个教育和过程的问题。如果您的开发人员了解您的 SVN 标签的用途，那么您似乎不太可能让人们（故意）对标签进行提交。我发现有效传达这些流程必不可少的是最新的书面文档。我的团队使用 wiki 来存储有关我们流程的文档（具体来说，我们使用[MediaWiki](http://www.mediawiki.org/wiki/MediaWiki)）。与将版本化的 MS Office 文档存储在 sharepoint 中相比，wiki 方法似乎使事情更易于访问和更新。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-01-14T08:33:19.710

如何使用 svn-auth 文件来定义它？这看起来像这样：

```
[groups]
ADMINS=<your ID>
<rest of groups>=<all other IDs>

[/]
* = r
<rest of groups> = rw
@ADMINS = rw

[/tags]
<rest of groups> = r 
```

这将允许管理员对标签目录进行读写访问，但不允许其他人访问。我不知道 SSPI auth 插件，所以我提供的示例可能不适用于您的上下文。

# regex - mod_rewrite 可以转换任意数量的任意名称的参数吗？

> ID：884377
> 
> 赞同：0
> 
> 时间：2009-05-19T18:37:41.180
> 
> 标签：regex, apache, mod-rewrite

我是 mod_rewrite 的总 n00b，我想做的事情听起来很简单：

而不是 domain.com/script.php?a=1&b=2&c=3 我想拥有：

domain.com/script|a:1;b:2;c:3

问题是我的脚本在各种组合中采用大量参数，顺序并不重要，因此在表达式中对每个参数进行编码并期望一定的顺序是不可行的。那么是否可以设置一个规则，简单地将所有参数传递给脚本，而不考虑顺序或多少参数？这样如果有人输入

domain.com/script|a:1;b:2;j:7 它将像使用 domain.com/script|b:2;a:1; 一样传递所有这些参数和值 ?

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-19T18:44:43.900

我会使用 PHP 来解析请求的 URL 路径：

```
$_SERVER['REQUEST_URI_PATH'] = parse_url($_SERVER['REQUEST_URI'], PHP_URL_PATH);
$params = array();
foreach (explode(',', substr($_SERVER['REQUEST_URI_PATH'], 6)) as $param) {
    if (preg_match('/^([^:]+):?(.*)$/', $param, $match)) {
        $param[rawurldecode($match[1])] = rawurldecode($match[2]);
    }
}
var_dump($params); 
```

以及将此类请求重写到您的`/script.php`文件的 mod_rewrite 规则：

```
RewriteRule ^script\|.+ script.php [L] 
```

# c# - Java/C#类型系统有哪些不足？

> ID：884391
> 
> 赞同：6
> 
> 时间：2009-05-19T18:42:16.370
> 
> 标签：c#, java, haskell, type-systems

经常听到 Haskell（我不知道）有一个非常有趣的类型系统。我对 Java 非常熟悉，对 C# 有一点了解，有时碰巧我正在与类型系统作斗争，所以一些设计*可以适应*或以某种方式更好地工作。

这让我想知道...

由于 Java/C# 类型系统的缺陷，会出现哪些问题？你怎么对付他们？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-19T18:50:22.190

Arrays are broken.

```
 Object[] foo = new String[1];
  foo[0] = new Integer(4); 
```

Gives you java.lang.ArrayStoreException

You deal with them with caution.

Nullability is another big issue. NullPointerExceptions jump at your face everywhere. You really can't do anything about them except switch language, or use conventions of avoiding them as much as possible (initialize fields properly, etc).

More generally, the Java's/C#'s type systems are not very expressive. The most important thing Haskell can give you is that with its types you can enforce that functions don't have side effects. Having a compile time proof that parts of programs are just expressions that are evaluated makes programs much more reliable, composable, and easier to reason about. (Ignore the fact, that implementations of Haskell give you ways to bypass that).

Compare that to Java, where calling a method can do almost anything!

Also Haskell has pattern matching, which gives you different way of creating programs; you have data on which functions operate, often recursively. In pattern matching you destruct data to see of what kind it is, and behave according to it. e.g. You have a list, which is either empty, or head and tail. If you want to calculate the length, you define a function that says: if list is empty, length = 0, otherwise length = 1 + length(tail).

If you really like to learn more, there's two excellent online sources:

[Learn you a Haskell](http://learnyouahaskell.com/) and [Real World Haskell](http://www.realworldhaskell.org/blog/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-19T19:06:50.117

I dislike the fact that there is a differentiation between primitive (native) types (`int`, `boolean`, `double`) and their corresponding class-wrappers (`Integer`, `Boolean`, `Double`) in Java.

This is often quite annoying especially when writing generic code. Native types can't be genericized, you must instantiate a wrapper instead. Generics should make your code more abstract and easier reusable, but in Java they bring restrictions with obviously no reasons.

```
private static <T> T First(T arg[]) {
    return arg[0];
}

public static void main(String[] args) {        
    int x[] = {1, 2, 3};
    Integer y[] = {3, 4, 5};

    First(x); // Wrong
    First(y); // Fine
} 
```

In .NET there are no such problems even though there are separate value and reference types, because they strictly realized "everything is an object".

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-20T12:54:55.573

这个关于泛型的问题显示了Java类型系统表达能力的不足Java中的
[高级泛型](https://stackoverflow.com/questions/876948/higher-kinded-generics-in-java)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-19T18:43:42.497

我不喜欢类不是一流对象的事实，而且你不能做一些花哨的事情，比如让静态方法成为接口的一部分。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-17T19:22:19.247

Java/.net 类型系统的一个基本弱点是它没有声明性的方法来指定对象的状态如何与其引用类型字段的内容相关，也没有指定允许哪些方法保留引用类型参数。尽管从某种意义上说，运行时能够使用`Foo`一种类型的字段`ICollection<integer>`来表示许多不同的事物是一件好事，但类型系统不可能为诸如不变性、等效性测试、克隆或任何其他此类事物提供真正的支持不知道是否`Foo`代表的特征：

1.  对集合的只读引用，不会发生任何变化；该类可以与外部代码自由共享此类引用，而不会影响其语义。引用仅封装不可变状态，并且可能不封装身份。
2.  对类型可变但实际上不会发生任何变化的集合的可写引用；该类只能与可以信任不会改变它的代码共享此类引用。如上所述，引用仅封装了不可变状态，并且可能不封装身份。
3.  宇宙中任何地方对它变异的集合的唯一引用。引用将封装可变状态，但不会封装身份（将集合替换为另一个持有相同项目的集合不会改变封闭对象的状态）。
4.  一个对它发生变异的集合的引用，它认为它的内容是它自己的，但是外部代码保存了它期望附加到 Foo 的当前状态的引用。该引用将封装身份和可变状态。
5.  对某个其他对象拥有的可变集合的引用，它希望将其附加到该其他对象的状态（例如，如果持有 `Foo` 的对象应该显示某个其他集合的内容）。该引用将封装身份，但不会封装可变状态。

假设一个人想要将包含的对象的状态复制`Foo`到一个新的、分离的对象中。如果`Foo`表示#1 或#2，则可以在新对象中存储引用的副本`Foo`，或者对包含相同数据的新对象的引用；复制引用会更快，但两个操作都是正确的。如果`Foo`表示#3，则正确的分离副本必须包含对新分离对象的引用，该对象的状态是从原始对象复制的。如果`Foo`表示#5，则正确的分离副本必须保存原始引用的副本——它*不能*保存对新分离对象的引用。而如果`Foo`表示#4，包含它的对象的状态不能单独复制；可能可以复制一堆相互连接的对象以产生一个状态与原始对象等效的新对象，但不可能单独复制对象的状态。

虽然类型系统不可能以声明方式指定对象之间可能存在的所有可能关系以及应该如何处理它们，但类型系统和框架应该可以正确生成代码以产生语义 -在大多数情况下，如果它知道哪些字段封装了身份、可变状态，两者都封装了，或者两者都不封装，则可以正确地进行等价测试、克隆方法、平滑互操作的可变、不可变和“可读”类型等。此外，在可以确保传递的引用不会被提供给任何会改变它们的东西的情况下，框架应该可以最大限度地减少防御性复制和包装。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-19T18:51:56.243

(Re: C# specifically.)

I would love [tagged unions](http://en.wikipedia.org/wiki/Tagged_union).

Ditto on [first-class objects](http://en.wikipedia.org/wiki/First-class_object) for classes, methods, properties, etc.

Although I've never used them, Python has [type classes](http://pyref.infogami.com/type-class) that basically are the types that represent classes and how they behave.

Non-nullable reference types so null-checks are not needed. It was originally considered for C# but was discarded. (There is a [stack overflow](https://stackoverflow.com/questions/693325/non-nullable-reference-types) question on this.)

[Covariance](https://stackoverflow.com/questions/6557/in-c-why-cant-a-liststring-object-be-stored-in-a-listobject-variable) so I can cast a `List<string>` to a `List<object>`.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-19T18:59:47.103

This is minor, but for the current versions of Java and C# declaring objects breaks the [DRY principle](http://www.artima.com/intv/dry.html):

```
Object foo = new Object; 
Int x = new Int; 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-05-19T19:08:03.280

None of them have meta-programming facilities like say that old darn C++ dog has.

Using "using" duplication and lack of typedef is one example that violates DRY and can even cause user-induced 'aliasing' errors and more. Java 'templates' isn't even worth mentioning..

# sql - 如何在 MS Access 查询中使用内部联接在每个“人”、每个日期仅选择一条记录？

> ID：884393
> 
> 赞同：0
> 
> 时间：2009-05-19T18:42:43.607
> 
> 标签：sql, ms-access, select, subquery, inner-join

我需要从两个表中提取数据：`Neptune_FN_Analysis`并且`Neptune_prem` 将有 3 个字段称为`readings_miu_id`（与人名或项目 # 相当）`ReadDate`，，`ReadTime`（所有这些都在 中`Neptune_FN_Analysis`）。有些`readings_miu_id`s 有多个`ReadTime`s 多天，但我只想提取`readings_miu_id`每天输入的“最后一次”。
我需要所有`readings_miu_id`具有所选范围的输入日期的 s，但只有`ReadTime`我要提取的每条记录的最后输入日期。

到目前为止，我基于一张表的解决方案是：

```
SELECT readings_miu_id, Reading, ReadDate, ReadTime, MIUwindow, SN, Noise, RSSI, OriginCol, ColID, Ownage
FROM analyzed AS A
WHERE ReadDate Between #4/21/2009# and #4/29/2009# 
AND ReadTime=
    (SELECT TOP 1 analyzed.ReadTime FROM analyzed 
    where analyzed.readings_miu_id = A.readings_miu_id 
    AND analyzed.ReadDate = A.ReadDate
    ORDER BY analyzed.ReadTime DESC); 
```

当我尝试调整此解决方案时，我不能这样做，`FROM [tableName] as A, INNER JOIN`因为它给了我一个错误。我的前任制作的原始代码（这是我正在尝试修改/修复的）如下：

```
SELECT readings_miu_id, Reading, ReadDate,Format([MIUtime],'hh:mm:ss') AS 
ReadTime, MIUwindow, SN, Noise, RSSI, ColRSSI, MIURSSI, Firmware, CFGDate, FreqCorr, 
Active, MeterType, OriginCol, ColID, Ownage, SiteID, PremID, Neptune_prem.prem_group1, 
Neptune_prem.prem_group2, ReadID 
INTO analyzed  
FROM Neptune_FN_Analysis INNER JOIN 
Neptune_prem ON Neptune_FN_Analysis.PremID = Neptune_prem.premice_id 
WHERE  SiteID = 36801 and ReadDate BETWEEN #04/21/09# AND #04/27/09#  
and OriginCol = 'US 29'    and ColID = 1 and ColID <> 0 and Active = 'Y' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-19T18:55:33.257

我不太明白你想要做的所有事情，但是如果你在一个获得日期最大值的子查询上进行内部连接，它可以消除日期不是最大值的所有记录

```
SELECT readings_miu_id, Reading, ReadDate, ReadTime, MIUwindow, SN, 
Noise, RSSI, OriginCol, ColID, Ownage 
FROM analyzed 
INNER JOIN 
(SELECT [whatever the id common to all like records is] as likeID, MAX(analyzed.ReadTime) as latestDate
 FROM analyzed 
 GROUP BY likeID) AS maxDate ON analyzed.likeID=maxDate.likeID AND analyzed.latestDate = maxDate.latestDate
WHERE ReadDate Between #4/21/2009# and #4/29/2009# 
```

根据需要修改

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-19T19:13:31.150

我会尝试这样的事情：

```
SELECT a.readings_miu_id, a.Reading, a.ReadDate, a.ReadTime, a.MIUwindow, a.SN, a.Noise, a.RSSI, a.OriginCol, a.ColID, a.Ownage
FROM analyzed AS A INNER JOIN
          (SELECT max(ReadTime) as MaxReadTime,readings_miu_id FROM analyzed 
             WHERE ReadDate Between #4/21/2009# and #4/29/2009#
              GROUP BY readings_miu_id) as B 
             on a.readings_miu_id = b.readings_miu_id  and a.MaxReadTime = b.ReadTime 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-19T20:29:00.730

```
SELECT
     <your columns>
FROM
     Neptune_FN_Analysis A1
INNER JOIN Neptune_prem ON
     P.premice_id = A1.PremID
LEFT OUTER JOIN Neptune_FN_Analysis A2 ON
     A2.readings_miu_id = A1.readings_miu_id AND
     A2.ReadDate = A1.ReadDate AND
     A2.ReadTime > A1.ReadTime
WHERE
     A2.readings_miu_id IS NULL AND
     <add any additional criteria here> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-20T08:28:34.380

我不确定`INNER JOIN`这次指定“”意味着什么。其他答案使用子查询，所以这是一个使用两个`INNER JOIN`s 且没有子查询的示例。而不是让我的头脑围绕您的架构:) 我使用 Northwind 来返回客户和他们最近订单的日期：

```
SELECT C1.CustomerID, C1.CompanyName, 
       O1.OrderID, O1.OrderDate
  FROM (Customers AS C1
       INNER JOIN Orders AS O1
          ON C1.CustomerID = O1.CustomerID)
       INNER JOIN Orders AS O2
          ON C1.CustomerID = O2.CustomerID
 GROUP 
    BY C1.CustomerID, C1.CompanyName, 
       O1.OrderID, O1.OrderDate
HAVING O1.OrderDate = MAX(O2.OrderDate); 
```

# iphone - pushViewController 调试

> ID：884404
> 
> 赞同：1
> 
> 时间：2009-05-19T18:44:25.867
> 
> 标签：iphone, cocoa-touch, uikit, sdk, uinavigationcontroller

我正在尝试（从我在 heirachy 中的第三个孩子）使用以下内容加载根视图。这不起作用，运行以​​下代码时出现以下错误。

```
-[DetailViewController clickButton:]: unrecognized selector sent to instance 0x1161e00' 
```

代码：

```
 MapViewController *dvController = [[MapViewController alloc] initWithNibName:@"MapView" bundle:[NSBundle mainBundle]];
        [self.navigationController pushViewController:dvController animated:YES];
        [dvController release];
        dvController = nil; 
```

这个完全相同的代码适用于其他视图，知道如何调试它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-20T04:58:21.067

您为创建 MapViewController 并将其推送到视图控制器堆栈而编写的代码是正确的。

无法识别的选择器错误告诉您，您正在发送正在尝试调用不存在的方法（名为 clickButton:)。

我怀疑是拼写错误。我认为您很可能定义了一个按钮，该按钮调用代码来创建新视图。该方法应如下所示：

```
-(void) clickButton: (id) sender {
    MapViewController *dvController = [[MapViewController alloc] initWithNibName:@"MapView"  bundle:[NSBundle mainBundle]];
    [self.navigationController pushViewController:dvController animated:YES];
    [dvController release];
    dvController = nil;
} 
```

我会检查您是否有“：（id）发件人”部分。我在实现 -(void) clickButton {} 方法之前犯了错误，但消息实际上也发送了一个参数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-20T13:30:43.847

1.  如果您以编程方式创建按钮并将目标设置为 clickButton，请确保存在 clickButton 方法

2.  clickButton 方法（根据错误）应该接受一个参数。所以方法的定义是

    *   (IBAction)clickButton:(id)sender;
3.  如果您已将 IBAction 映射到 IB 中的事件，则可以省略 :(id)sender 部分

4.  要从基于导航的应用程序中的任何视图加载根视图控制器，请使用

    [[self navigationController:popToRootViewControllerAnimated:YES];

# python - 如何使用装饰器和线程返回函数值

> ID：884410
> 
> 赞同：2
> 
> 时间：2009-05-19T18:46:54.693
> 
> 标签：python, multithreading, decorator

有这个代码

```
import threading
def Thread(f):
    def decorator(*args,**kargs):
        print(args) 
        thread = threading.Thread(target=f, args=args)
        thread.start()
        thread.join()
    decorator.__name__ = f.__name__
    return decorator      

@Thread
def add_item(a, b):
    return a+b

print(add_item(2,2)) 
```

但函数从不返回值，退出获取返回的方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-19T18:53:41.623

返回的原因`None`是因为没有什么可以返回（除了`decorator`没有返回语句的事实）。根据[文档](http://docs.python.org/3.0/library/threading.html#threading.Thread.join)`join()`，总是返回。`None`

有关如何与线程通信的示例，请参阅[此电子邮件](http://mail.python.org/pipermail/python-list/2005-September/339892.html)。

如果我可能会问：既然`join()`阻塞了调用线程，那么这里有什么好处呢？

* * *

**编辑：**我玩了一下，以下是一个不需要队列的解决方案（并不是说这是一个更好的解决方案。只是不同）：

```
import threading

# Callable that stores the result of calling the given callable f.
class ResultCatcher:
    def __init__(self, f):
        self.f = f
        self.val = None

    def __call__(self, *args, **kwargs):
        self.val = self.f(*args, **kwargs)

def threaded(f):
    def decorator(*args,**kargs):
        # Encapsulate f so that the return value can be extracted.
        retVal = ResultCatcher(f)

        th = threading.Thread(target=retVal, args=args)
        th.start()
        th.join()

        # Extract and return the result of executing f.
        return retVal.val

    decorator.__name__ = f.__name__
    return decorator

@threaded
def add_item(a, b):
    return a + b

print(add_item(2, 2)) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-19T18:49:31.850

那是因为你永远不会在你的“装饰器”函数中返回一个值。

您必须在线程中包含一个共享变量，并将线程函数的返回值移回“装饰器”函数。

# java - 如何手动打开休眠会话？

> ID：884423
> 
> 赞同：4
> 
> 时间：2009-05-19T18:53:34.493
> 
> 标签：java, hibernate, spring, lazy-loading

我有一个涉及spring和hibernate的相当大的项目。现在，我正在将某些对象从休眠状态恢复到内存中，并且遇到了一些障碍。我有以下设置。

A 类包含许多原语和一个 B 类。B 包含原语和一个 C 类，它以前是**延迟加载的**。

现在我有这个

服务调用 1：
1.）创建 A 类的
对象 2.）获取 B 类的对象
3.）在 A 中设置 B
4.）将 A 添加到内存

服务调用 2：
1.) 从内存中获取 A
2.) 从 A 中获取 B
3.) 从 B 中获取 C
4.) 对 C 进行操作

因为 C 是延迟加载的，所以它依靠现有的休眠会话从 B 延迟加载自身，至少我相信是这样的。但是，现在我需要延迟加载**而不**修改 DAO 以返回 ID，并且不存在**当前的**休眠会话可以使用 OpenSessionInView 劫持。考虑到限制，解决这个问题的最佳方法是什么？我发现的唯一解决方案依赖于不合适的代码更改或现有会话，因此我认为我也许可以手动打开休眠会话。我该怎么做呢？或者，是否有更好的解决方案来解决这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-19T19:19:40.747

作为最佳实践，您需要使用会话工厂。这是 Netbeans 生成的。

```
public class HibernateUtil {

    private static final SessionFactory sessionFactory;
    private static final Configuration configuration = new Configuration().configure();

    static {
        try {
            // Create the SessionFactory from standard (hibernate.cfg.xml) 
            // config file.
            sessionFactory = new AnnotationConfiguration().configure().buildSessionFactory();
        } catch (Throwable ex) {
            // Log the exception. 
            System.err.println("Initial SessionFactory creation failed." + ex);
            throw new ExceptionInInitializerError(ex);
        }
    }

    public static SessionFactory getSessionFactory() {
        return sessionFactory;
    }
} 
```

一旦你有了这个，你可以使用这个代码进行交易

```
Session session = HibernateUtil.getSessionFactory().getCurrentSession();
session.beginTransaction();
//Do something
session.getTransaction().commit(); 
```

请注意，打开事务将打开会话。我相信在纯 Hibernate（与 JPA 不同）下，你需要一个事务来做任何事情，甚至读取。

在程序结束时，您要确保执行此操作

```
HibernateUtil.getSessionFactory().close(); 
```

对于更复杂的解决方案，您可能希望使用 Spring 或 EJB 研究自动会话/事务管理。一旦配置正确，它将在幕后处理会话。

**编辑：**
只需重新阅读您的问题和关于 ID 的观点。我相信 sessionfactory 方法将适用于您的目的，除非您正在执行多线程应用程序。这是因为默认情况下，Hibernate 会话和链接到该会话的 ORM 对象仅与一个线程相关联。让我知道我是否错了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-19T19:08:51.127

如果您可以获得对您配置的 SessionFactory 的引用，您应该能够在其上调用 openSession()。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-19T19:45:10.163

您是否正在使用`HibernateTemplate`并`HibernateDaoSupport`实施您的 DAO？如果是这样，这就是您的对象断开连接的原因。但是，你应该能够[`OpenSessionInViewInterceptor`](http://static.springframework.org/spring/docs/2.0.x/api/org/springframework/orm/hibernate3/support/OpenSessionInViewInterceptor.html)在这种情况下使用。你有没有做任何事情来验证你将无法使用拦截器？

此外，如果您选择打开一个新`Session`的，内存中的对象将不会与新的关联`Session`。您需要将对象重新附加到会话才能使延迟加载起作用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-20T17:31:24.423

如果您知道您的 B 对象可能引用了它们的 C，那么您应该以预取 C 的方式检索 B。例如 HQL

```
from B as b where b.id = :ID 
```

变成

```
from B as b left join fetch b.c where b.id = :ID 
```

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2018-01-10T17:51:12.887

只需使用 Session session = new Configuration().configure().buildSessionFactory().getCurrentSession(); 或者 Session session = new Configuration().configure().buildSessionFactory().getOpenSession();

# wordpress - Wordpress 博客 + 谷歌 AdSense

> ID：884426
> 
> 赞同：0
> 
> 时间：2009-05-19T18:54:04.913
> 
> 标签：wordpress, google-ads-api

这些天我在我的博客上写一些东西。所以昨天我把它提交给了 GoogleAdSense。他们批准了我的帐户。到这个非常好。

但是，如果我将 html/javascript 代码粘贴到我的帖子内容中，wordpress 将删除它。有没有办法在我的 wordpress 博客中展示广告..:((

我的博客是[http://nareshbojja.wordpress.com](http://nareshbojja.wordpress.com)

谢谢纳雷什
_

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-19T18:56:22.743

WordPress.org 删除 JavaScript 和其他潜在的恶意代码。有[很多适用于 WordPress 的 AdSense 插件](http://www.quickonlinetips.com/archives/2006/11/10-best-wordpress-plugins-for-google-adsense/)会自动为您插入 Google AdSense 广告位置。

**编辑：**您[**不能**将 AdSense 放在 WordPress 上。*com*托管博客](http://support.wordpress.com/advertising/)。

# c# - 没有可见形式的 WndProc？

> ID：884428
> 
> 赞同：3
> 
> 时间：2009-05-19T18:54:21.950
> 
> 标签：c#, .net, winforms, wndproc

我想在第二个线程上创建一个表单，它将在它的 WndProc 方法中接收消息。创建这样的不可见表单的推荐方法是什么？设置“ShowInTaskbar=false”和“Visible=false”是否足够，或者是否有“更清洁”的方式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T15:04:47.863

我不确定您所说的“更清洁”是什么意思。创建对用户不可见的表单的标准方法是将 Visible 和 ShowInTaskbar 设置为 false。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-19T20:27:19.580

据我所知，您正在做的事情违反了规则（尽管这些事情有时确实有效）......所有 UI 的东西都应该在主线程中。

至于您的问题，您应该可以将 Visible 设置为 false。我相信，设置 ShowInTaskbar 仅对主应用程序表单很重要，如果您这样做，用户将无法从任务栏返回您的应用程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-02-05T02:11:32.647

采用：

```
Public Declare Function CreateWindowExA Lib "user32" (ByVal dwExStyle As Long, 
    ByVal lpClassName As String, ByVal lpWindowName As String, ByVal dwStyle As Long, 
    ByVal x As Long, ByVal y As Long, ByVal nWidth As Long, ByVal nHeight As Long, 
    ByVal hWndParent As Long, ByVal hMenu As Long, ByVal hInstance As Long, lpParam As Any) 
    As Long 
```

或者

```
Public Declare Function CreateWindowExW Lib "user32" (ByVal dwExStyle As Long, 
    ByVal lpClassName As Long, ByVal lpWindowName As Long, ByVal dwStyle As Long, 
    ByVal x As Long, ByVal y As Long, ByVal nWidth As Long, ByVal nHeight As Long, 
    ByVal hWndParent As Long, ByVal hMenu As Long, ByVal hInstance As Long, lpParam As Long) 
    As Long 
```

注意：您可以在声明中将 or 更改为or确保`lpClassName`使用“Static”作为成员 - 这是您想要的不可见窗口样式，通常用于接收 wndproc 窗口。`lpWindowName``string``long``lpClassName`

此 api 的返回值是 hwnd(handle)，您可以对它进行子类化以获取它将接收所有标准 Windows 消息的消息，或者您可以向它发送自定义消息，因此当标准消息时它不会意外触发您的代码已收到。

示例： `hwnd_main`是其父窗口的 hwnd

```
dim hwnd_recieve as long
hwnd_recieve = CreateWindowEx(num_zero, "Static", "",0,0,0,0,0, hwnd_main,0,0,0) 
```

继承这个并玩得开心！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-11-10T15:18:37.613

这个项目中的代码有一个巧妙的方法来处理这个问题： http: [//www.codeproject.com/KB/dotnet/XDMessaging.aspx](http://www.codeproject.com/KB/dotnet/XDMessaging.aspx)

我这里没有复制代码，因为它是受版权保护的，但是您可以通过自己下载它来参考它。

XDListener 类扩展了 NativeWindow，因此它能够接收消息。在构造函数中，在窗口上设置了一些属性，使其不可见。WndProc 方法在该类中被重写以处理到达的消息。我测试了这段代码可以在 Win 7 上使用 C# 应用程序运行，而我的所有表单都被隐藏并且没有显示在任务栏中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-06-14T14:59:43.040

如果将 ShowInTaskbar 设置为 false，您将无法接收 Windows 消息。唯一的方法是隐藏您的表单（它仍然隐藏任务栏图标）。

# java - 更好的 Java 方法语法？早退还是晚退？

> ID：884429
> 
> 赞同：7
> 
> 时间：2009-05-19T18:54:27.143
> 
> 标签：java, coding-style, return-path

> **重复：** [一个函数应该只有一个返回语句吗？](https://stackoverflow.com/questions/36707)

很多时候，您可能有一个方法可以检查多个条件并返回一个状态（现在让我们说布尔值）。定义一个标志，在方法期间设置它，并在最后返回它是否更好：

```
boolean validate(DomainObject o) {
  boolean valid = false;
  if (o.property == x) {
     valid = true;
  } else if (o.property2 == y) {
     valid = true;
  } ...
  return valid; 
} 
```

还是在您知道方法的结果后简单地返回更好/更正确？

```
boolean validate(DomainObject o) {

  if (o.property == x) {
     return true;
  } else if (o.property2 == y) {
     return true;
  } ...
  return false; 
} 
```

现在显然可能有 try/catch 块和所有其他类型的条件，但我认为这个概念很清楚。意见？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-19T18:59:38.820

如果这是一种您将调用数千次的方法，那么尽早返回更好地实现[略微]提高的性能。

如果没有，那么我更喜欢延迟返回，因为它提高了可读性。

请记住，程序员通常花在阅读上的时间多于编写代码的时间，因此您可以做任何提高可读性的事情肯定会受到欢迎。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-19T19:00:59.893

我更喜欢早点返回并避免深度嵌套。在方法开始时*尤其*如此：测试任何简单的东西，如果可以尽早退出（或抛出异常）。

如果它正好在一个方法的中间，它更像是一个判断调用。

请注意，我会立即重构您的示例以使用单个`if`：

```
boolean validate(DomainObject o) {    
  if (o.property == x || o.property2 == y) {
     return true;
  } ...
  return false; 
} 
```

我意识到这只是一个玩具示例，但我的观点是，寻找更多简化代码的方法总是值得的 :)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-19T18:58:42.723

与大多数编码风格一样，这实际上是一个偏好问题，但许多人认为[保护子句](http://c2.com/cgi/wiki?GuardClause)是最佳实践。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-19T19:07:45.857

我唯一会说你绝对不应该提前返回的情况是，如果你不能轻易地在一个屏幕上看到每个返回（无论标准对于使用相同代码库的人来说可能是什么），你至少应该是添加注释表明如果有提前返回，该函数可以提前返回。

唯一一次我会说你绝对应该早点回来是如果你的代码看起来像......

```
boolean valid = true;
if( condition1 ) {
   valid = false;
}
if( valid ) {
   ...
   if( condition2 ) {
      valid = false;
   }
}
if( valid ) {
   ...
   if( condition3 ) {
      valid = false;
   }
}
... (etc) 
```

但是，如果您发现自己处于上述任何一种情况……您可能应该重构该函数。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-19T18:58:36.000

对我来说，这是一种没有正确答案的宗教战争话题。反对提前返回的论点基本上归结为这样一个事实，即只有一个函数可以退出的点减少了通过代码的可能路径的数量，因此，至少在理论上，减少了错误的机会。我的个人风格是，在提前返回有意义的情况下这样做，并且在限制为一个返回声明有意义的情况下我这样做。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-19T19:06:35.373

有两个因素相互拉扯。

第一个因素是易于调试。如果您立即返回（如您的第二个代码片段所示），有时很难调试一个大函数，因为很难找到这些返回语句，特别是如果它们被错误地放在那里。

第二个因素是易于实施。如果您在函数开头检查参数的基本正确性，并且在函数完成之前有一段很长的代码，您可能必须将整个代码放入条件循环中。如果你不这样做，在某些时候，这个论点可能会被用于一些长时间的计算，浪费时间，因为它最终还是会被拒绝。

所以，答案可能是这样的：

```
If the function is small, 
        save the return status in a variable and return at the end. 
else 
        return immediately. 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-19T18:59:44.763

如果异常不是图片的一部分，我宁愿在可能的情况下立即返回。

标志变量管理不善很容易，我通常反对标志变量。不返回也可能使维护者认为可能会做进一步的工作（如果方法很长）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-19T18:58:38.277

就个人而言，我更喜欢第二种方法。这对我来说很简单明了，但我确实知道有些人在函数中必须只有一个返回值。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-19T19:00:41.237

老实说，我认为这取决于情况。就我个人而言，我同时使用这两种方法，并根据哪一种来使代码更清晰易读。

如果您有大量嵌套的 if 语句（或任何其他控制结构）并且它可能会让人感到困惑，那么我会在语句中返回

在这种情况下，不要太担心什么是“最佳实践”，因为更重要的是代码清晰易懂。使用适合情况的方法。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-19T19:04:38.967

对于这种情况，我更喜欢：

```
boolean validate (DomainObject o) {
    if (o.property == x ||
        o.property2 == y ||
        ...) {
          return true;
    } else {
          return false;
} 
```

一般来说，我喜欢使用提前返回来处理错误情况，并在结束时返回来返回计算结果。

# c++ - 通过 Swig 在 C++ 和 Lua 之间传递变量

> ID：884435
> 
> 赞同：3
> 
> 时间：2009-05-19T18:55:47.237
> 
> 标签：c++, scripting, lua, embed, swig

我正在开发一个包含大量类（150 多个）的 C++ 项目，每个类都有 10 到 300 个左右的字段。我真的很想能够提供一个脚本接口用于测试目的，这样我就可以编写不需要任何重新编译的回调。我想在 Lua 中执行此操作，因为我对它的 C API 比对 Python 的更熟悉，但如果它可以避免头痛，我很乐意在 Python 中执行此操作。

我已经掌握了如何从我的 C++ 调用 Lua 函数，反之亦然，并且我知道如何来回传递基本数据类型。我的问题是如何使用 SWIG 在两者之间共享用户指定的数据类型。

例如，在我的 C++ 中的某个时刻，我可能想要评估具有 250 个字段的对象中的几条成员数据。我希望能够将该对象交给 Lua，然后（希望？）使用生成的 SWIG 包装器来操作该对象，显示某些字段，然后将（可能更改的）对象传递回 C++ 以继续使用.

我还希望能够使用包装器在 Lua 中实例化对象的实例，并将其传递给 C++ 以用作对象的普通 C++ 版本。

这可能吗？有人可以指出我的教程或明确的例子吗？

谢谢你的尽心帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-19T19:03:22.323

只要您使用 Swig 接口包装用户定义的类型（有关 Swig-Lua API 的文档，请参见[此处](http://www.swig.org/Doc1.3/Lua.html)），交互应该是无缝的。提供的 Swig 包装器将允许您实例化新对象，将它们传递给 C++，反之亦然。

我不相信 Swig-Lua 包装支持导向器类，这意味着扩展现有类、实例化它们并将它们传递回 C++ 是不可能的。不过，Director 支持 Python、Java、C# 等语言。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-19T23:00:32.437

如果 swig 给你带来麻烦，我已经用最新版本的 tolua++ 祝你好运，它的唯一目的是绑定 C++ 和 Lua。它需要一个修改过的 .h 文件作为输入，这有点乏味，但不比 Swig 的模块多。我没有理由偏爱其中一个，但了解两者都很好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-03-07T22:12:47.507

您还应该查看 Luabind。这个实现了 Lua 的 OOP，并且可以将 Lua 中的类和数据类型映射回 C++。

# email - Apple Mail 的 .emlx 数据结构的文档（用于转换目的）？

> ID：884440
> 
> 赞同：8
> 
> 时间：2009-05-19T18:56:44.753
> 
> 标签：email, data-structures, apple-mail

这似乎是一个罕见的宝石：在哪里可以找到有关 Apple Mail 的 .emlx 文件结构（及其部分变体，以及目录结构的含义）的文档。苹果网站上似乎不存在这些文档，我也无法通过谷歌找到任何合理的提及。

重点是创建一个 bash/ruby/python/insert-script-langauge-here 脚本来将这些文件的混乱转换为可用/可弯曲的东西，例如 Maildir 或 Mbox。最终目标是将用户 /Library/Mail 存储的快照迁移到使用 Maildir 形式的现有 Dovecot 设置中。

是[的，我知道这个程序](http://www.cosmicsoft.net/emlxconvert.html)，但它没有解决我所追求的解决方案。手动转换 20 个邮箱并手动将它们插入到现有安装中将需要更多的时间，而不仅仅是编写一个脚本，将消息消化成其他东西，然后自动将它们存储在应有的位置。没关系，可能还有六个用户需要此过程。所以值得我花时间编写它。

*请在此问题待删除时投票关闭该问题的副本，而不是投票关闭该问题。出于某种原因，在使用 Chrome 作为浏览器时偶尔会出现发布故障。*

跟进：似乎该格式确实没有记录，并且大多数来源都对其进行了逆向工程。如果我有时间，我会自己尝试这样做；如果我成功了，我将发布第二次跟进我的发现的详细信息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-19T19:12:14.193

这是 ruby​​ 中的 emlx2mbox 转换器：[邮箱转换器](http://vengefulcow.com/emlx2mbox/)。

我不认为它是从规范的任何文档中编写的，但它经历了多次更新，因此希望能够至少处理一些格式的怪癖。源代码长约 250 行，看起来可读且注释良好。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-29T23:19:26.767

记录 emlx 格式的更多信息。

消息[组成](https://the.taoofmac.com/space/blog/2008/03/03/2211)：

*   第一行消息的字节数
*   消息的 MIME 转储
*   一个 XML 列表

XML plist 包含某些代码，例如

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
        <key>date-sent</key>
        <real>1362211252</real>
        <key>flags</key>
        <integer>8590195713</integer>
        <key>original-mailbox</key>
        <string>imap://****@127.0.0.1:143/mail/2013/03</string>
        <key>remote-id</key>
        <string>252</string>
        <key>subject</key>
        <string>Re: Foobar</string>
</dict> 
```

这些[标志已由](http://www.jwz.org/blog/2005/07/emlx-flags/)jwz 描述并表示一个 30 位整数：

```
0      read                      1 << 0
1      deleted                   1 << 1
2      answered                  1 << 2
3      encrypted                 1 << 3
4      flagged                   1 << 4
5      recent                    1 << 5
6      draft                     1 << 6
7      initial (no longer used)  1 << 7
8      forwarded                 1 << 8
9      redirected                1 << 9
10-15  attachment count          3F << 10 (6 bits)
16-22  priority level            7F << 16 (7 bits)
23     signed                    1 << 23
24     is junk                   1 << 24
25     is not junk               1 << 25
26-28  font size delta           7 << 26 (3 bits)
29     junk mail level recorded  1 << 29
30     highlight text in toc     1 << 30
31     (unused) 
```

给自己发一条简单的消息并删除一些细节，这样你就可以看到`emlx`文件的完整数据结构。

```
875       
X-Spam-Checker-Version: SpamAssassin 3.3.2 (2011-06-06) on ******.*********.***
X-Spam-Level: 
X-Spam-Status: No, score=-3.2 required=4.2 tests=BAYES_00,RP_MATCHES_RCVD,
        SPF_PASS,TVD_SPACE_RATIO autolearn=ham version=3.3.2
Received: from [127.0.0.1] (******.*********.*** [***.**.**.**])
        by ******.*********.*** (8.14.5/8.14.5) with ESMTP id r2TN8m4U099571
        for <****@*********.***>; Fri, 29 Mar 2013 19:08:48 -0400 (EDT)
        (envelope-from ****@*********.***)
Subject: very simple
From: Karl Dubost <****@*********.***>
Content-Type: text/plain; charset=us-ascii
Message-Id: <4E83618E-BB56-404F-8595-87352648ADC7@*********.***>
Date: Fri, 29 Mar 2013 19:09:06 -0400
To: Karl Dubost <****@*********.***>
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v1283)
X-Mailer: Apple Mail (2.1283)

message Foo
-- 
Karl Dubost
http://www.la-grange.net/karl/
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
        <key>date-sent</key>
        <real>1364598546</real>
        <key>flags</key>
        <integer>8590195713</integer>
        <key>original-mailbox</key>
        <string>imap://********@127.0.0.1:11143/mail/2013/03</string>
        <key>remote-id</key>
        <string>41147</string>
        <key>subject</key>
        <string>very simple</string>
</dict>
</plist> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-07-27T12:16:25.473

我正在使用 mailcore2 解析 .eml 消息。要使用 .emlx 进行这项工作，我只需要删除第一行（包含一个数字）。消息本身配备了消息的长度，所以末尾的 XML 块不需要删除。

以下是我在 Objective-c/cocoa 中的做法（MCOMessageParser 来自 mailcore2 框架）：

```
-(Documents *)ParseEmlMessageforPath: (NSString*)fullpath filename:(NSString*)filename{
NSLog(@"fullpath = %@", fullpath);
NSError * error;
error = nil;
NSData *fileContents = [NSData dataWithContentsOfFile:fullpath options:NSDataReadingMappedIfSafe error:&error];
if (error) { 
     [[NSApplication sharedApplication] presentError:error];
}
MCOMessageParser * parser;
if (fileContents) {
    if ([[fullpath pathExtension] isEqualToString:@"emlx"]) {
        NSData * linefeed = [(NSString*)@"\n" dataUsingEncoding:NSUTF8StringEncoding ];
        NSInteger filelength = [fileContents length];
        NSRange  xx = NSMakeRange(0, 20); 
        NSRange pos = [fileContents rangeOfData:linefeed options:0 range:xx] ;
        if (pos.location != NSNotFound) {
            NSData *subcontent = [fileContents subdataWithRange:(NSRange){pos.location+1, filelength-(pos.location)-1}];
            parser = [MCOMessageParser messageParserWithData:subcontent];
        } else {
            return nil;
        }

    } else {
        parser = [MCOMessageParser messageParserWithData:fileContents];

    } 
```

你去吧....

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-02-24T10:31:42.787

截至 2020 年，Python 有一个轻量级的[emlx 库](http://github.com/mikez/emlx)。

```
pip install emlx 
```

进而

```
>>> import emlx
>>> m = emlx.read("12345.emlx")

>>> m.headers
{'Subject': 'Re: Emlx library ✉️',
 'From': 'Michael <michael@example.com>',
 'Date': 'Thu, 30 Jan 2020 20:25:43 +0100',
 'Content-Type': 'text/plain; charset=utf-8',
 ...}
>>> m.headers['Subject']
'Re: Emlx library ✉️'

>>> m.plist
{'color': '000000',
 'conversation-id': 12345,
 'date-last-viewed': 1580423184,
 'flags': {...},
 ...}

>>> m.flags
{'read': True, 'answered': True, 'attachment_count': 2} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-12-02T11:48:22.143

最初的 emlx2mbox ruby​​ 脚本是很久以前写的。我已经更新它以在现代 ruby​​ 环境下运行。[请在https://github.com/imdatsolak/elmx2mbox](https://github.com/imdatsolak/elmx2mbox)上查看

# c# - 这个异步 Lambda Cryptica 代码是否符合我的想法？

> ID：884442
> 
> 赞同：0
> 
> 时间：2009-05-19T18:57:59.370
> 
> 标签：c#, .net, asynchronous, lambda

```
 Action<SPItemEventProperties> deleteAction = DeleteWorkspace;
    AsyncCallback deleteDone = deleteAction.EndInvoke;
    SPSecurity.RunWithElevatedPrivileges(() => deleteAction.BeginInvoke(properties, deleteDone, null)); 
```

所以这是假设异步调用 DeleteWorkspace，然后在完成后调用 EndInvoke，我写了它，但我不肯定它会正常工作。我通过了，它似乎可以工作，但语法让我第二次猜测自己，因为我从来没有在网上看到过这样的操作......

评论？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-19T19:23:39.223

它应该可以工作，但要真正理解它，让我们假设它是这样写的：

```
void RunAsync<T>(Action<T> action)
{
    AsyncCallback Done = action.EndInvoke;
    SPSecurity.RunWithElevatedPrivileges(() => action.BeginInvoke(properties, Done, null));
}

RunAsync(DeleteWorkspace); 
```

请注意，在上面的代码中，看起来“完成”回调将立即超出范围。但是，编译器将使用闭包捕获（关闭）它，以便在需要时可用。

# vb.net - Multi targeting in vs2008 with crystal reports

> ID：884445
> 
> 赞同：0
> 
> 时间：2009-05-19T18:58:32.740
> 
> 标签：vb.net, visual-studio-2008, crystal-reports, multitargeting

Is there a way to make VS2008 work with the old (vs2005 crystal reports) assemblies and not require any updates to be installed in the client machines?

We have upgraded a Visual Studio 2005 .net 2.0 solution to Visual Studio 2008\. The purpose is to take advantage of the IDE improvements and because it supports multi targeting. The solution still has to be built against .net 2.0.

It all works as advertised, we rebuild and run it in a machine with only .net 2.0 installed. But during testing we get an exception when we try to show a Crystal Report that is included with the application.

Then upon review we find out that without telling us, Visual Studio changed the references to the crystal assemblies and pointed our solution to the updated versions that come with vs2008, which requires crystal runtime be updated on client machines.

We did try removing the references and adding the old ones but it won't compile.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T14:03:56.357

1.  不要使用水晶报表

2.  您可以尝试将所有报告放在一个单独的项目中。然后在使用相同项目的 VS2005 中创建第二个 Visual Studio 解决方案（添加现有项目）。然后使用 VS2005 编辑您的报告。为您在 vs2008 中的引用创建一个库目录并引用 vs2005 dll。

不确定它是否有效，但值得一试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T14:58:30.817

不要使用水晶报表

您可以尝试将所有报告放在一个单独的项目中。然后在使用相同项目的 VS2005 中创建第二个 Visual Studio 解决方案（添加现有项目）。然后使用 VS2005 编辑您的报告。为您在 vs2008 中的引用创建一个库目录并引用 vs2005 dll。

不确定它是否有效，但值得一试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T18:05:53.920

我只会硬着头皮升级。我在 Crystal Reports 2008 中发现了一些数据密集型报表的性能改进。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T17:58:34.277

我们尝试了这个，最终只是在内部将我们所有的机器升级到最新的和（不是那么）最好的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-28T12:58:28.453

我们遇到了同样的问题。您可以让项目引用旧的 DLLS，它可以工作但可能导致 DLL 地狱。以前打过这种战斗，我不能推荐它。

在对 Crystal Reports 站点进行了长时间的探索之后，我得出的结论是，除了升级到 Crystal Reports 2008 或切换到不同的报表引擎之外，没有什么好的方法可以解决这个问题。

在我们的案例中，我们还没有开发出大量的 Crytal Reports，我们的报告需求并不大。我们切换到捆绑到 Visual Studio 中的 Microsoft 报告技术。花了一些功夫才弄清楚，但到目前为止，它看起来可以做任何我们需要的事情。不升级 Crystal Reports 为我们节省了一笔不小的费用。

希望这可以帮助。

# ruby-on-rails - rake db:schema:dump 不提供数据迁移信息 - 是否有自动获取此信息的方法？

> ID：884448
> 
> 赞同：3
> 
> 时间：2009-05-19T18:58:40.367
> 
> 标签：ruby-on-rails, activerecord, migration

```
rake db:schema:dump 
```

此命令为您提供旧数据库的架构，您可以从生成的架构为该数据库构建迁移。

但是，如果该数据库中有数据，那么如果有一个 rake 命令来检索 Rails 生成的迁移文件中的数据，那就太好了。

也许我在做梦——认为 Rails 可以查看遗留数据库中的数据并从现有数据为您构建迁移可能要求太多了——像这样：

```
class LoadDefaultData < ActiveRecord::Migration
  def self.up
    bopeep = User.find_by_username 'bopeep'
    BlogPost.create(:title => 'test', :content => 'test', :author_id => bopeep.id, :status => 'ok')
  end

  def self.down
  end
end 
```

**或者有什么办法吗？**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-19T19:07:56.620

Tobias Lütke 需要将数据库从一种架构迁移到另一种架构，但需要完整地复制数据。为了确保格式与架构无关，他创建了一个插件，将数据转储到 YAML，然后将其重新加载到另一端的数据库中。这是一项简单的 rake 任务，Tobi 提供快速简单的指示。

[http://blog.leetsoft.com/2006/5/29/easy-migration-between-databases](http://blog.leetsoft.com/2006/5/29/easy-migration-between-databases)

这可能会有所帮助。

您可能还想查看 YamlDB 插件[http://opensource.heroku.com/](http://opensource.heroku.com/)，它可以从一种数据库类型备份并恢复到另一种数据库类型。这里有一些[说明](http://accidentaltechnologist.com/ruby/change-databases-in-rails-with-yamldb/)

# iphone - 如何播放 iPhone 的敲击声？

> ID：884452
> 
> 赞同：5
> 
> 时间：2009-05-19T18:59:01.193
> 
> 标签：iphone, cocoa-touch

我的 iPhone 应用程序中有一个按钮，我希望在点击它时播放默认的“键盘敲击”声音。我已经能够很容易地播放我自己的自定义声音，但是有没有办法在我的应用程序中播放这样的默认系统声音？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-07-07T19:56:52.163

我相信您想要的点击声音在名为 SysSound 的示例应用程序中。

[http://developer.apple.com/iphone/library/samplecode/SysSound/](http://developer.apple.com/iphone/library/samplecode/SysSound/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-04T13:02:19.467

[usingsystemsounds](http://iphonedevwiki.net/index.php/AudioServices)
您必须为此使用系统声音。以下内容可能很有用。请参阅多媒体编程指南以了解更多信息。

```
CFBundleRef mainbundle = CFBundleGetMainBundle();
CFURLRef soundFileURLRef = CFBundleCopyResourceURL
                                     (mainbundle, CFSTR("tap"), CFSTR("aif"), NULL);
AudioServicesCreateSystemSoundID(soundFileURLRef, &soundFileObject); 
```

您也可以通过以下方式使用内置系统声音

```
AudioServicesPlaySystemSound(1100); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-26T07:59:03.733

我找到[了这个](http://www.freesound.org/samplesViewSingle.php?id=406)，这听起来像你要找的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-19T19:04:53.757

没有什么公开的。如果您愿意深入研究私有 API，可能会有答案，但强烈建议不要这样做（因为您可能会破坏未来的兼容性，并且可能会被应用商店拒绝）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-19T19:29:17.683

iPhone Dev Center 网站上有一个播放短时声音（5 秒或更短）的示例，您可以使用该代码播放您想要的任何声音。在谷歌搜索中找到一个点击声音并使用它。这就是你所需要的。

[http://developer.apple.com/iphone/library/codinghowtos/AudioAndVideo/index.html#PLAY_SHORT_SOUNDS_AND_ALERTS_2](http://developer.apple.com/iphone/library/codinghowtos/AudioAndVideo/index.html#PLAY_SHORT_SOUNDS_AND_ALERTS_2)

```
AudioServicesCreateSystemSoundID (fileURL, soundID); 
```

# asp.net - 使用 JQuery BlockUI 访问 GridView 内的 TextArea

> ID：884462
> 
> 赞同：0
> 
> 时间：2009-05-19T19:00:16.603
> 
> 标签：asp.net

这让我发疯！

我正在尝试访问 GridView 控件内的 TextArea。单击网格视图上的按钮时会弹出 TextArea。出于某种原因，textarea.value 总是包含“”。

```
<asp:GridView ID="gvCategories" runat="server" AutoGenerateColumns="false" 
            onrowcommand="gvCategories_RowCommand">

    <Columns>
    <asp:TemplateField>
    <ItemTemplate>
        <input type="button" value="add comment" onclick="showCommentBox()" />
    </ItemTemplate>
    </asp:TemplateField>

     <asp:TemplateField>
    <ItemTemplate>
       <div id="commentBox" style="display:none">

     <input type="button" value="move comment input box" onclick="moveComment()" /> 

    <textarea id="txtComment" rows="10" cols="30">
    </textarea>

    </div>   
    </ItemTemplate>
    </asp:TemplateField>

    </Columns>

    </asp:GridView>

function moveComment() {

        alert(document.getElementById("txtComment").value);  

    } 
```

我在服务器端添加了这段代码，但 TextBox 总是返回“”

```
 protected void gvCategories_RowCommand(object sender, GridViewCommandEventArgs e)
        {

            var row = (GridViewRow) (e.CommandSource as LinkButton).NamingContainer;
            var description = (row.FindControl("txtDescription") as TextBox).Text;
            lblComment.Text = description; 
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T20:30:40.270

**@Azam -**这与我回答的您的其他[帖子有关。](https://stackoverflow.com/questions/912804/jquery-blockui-not-unblocking-the-page)gridview 使用同一组 ID 多次生成 commentBox DIV 及其所有子元素。

我对此进行了测试，发现每次调用都`document.getElementById("txtComment")`返回 DOM 中具有该 Id 的下一个匹配元素，直到它循环遍历整个匹配元素集合，然后返回到第一个，然后重新开始。

这就是为什么在尝试访问 textarea 或 textbox 的值时出现空白的原因。

您需要修改您的调用，`showComment()`以便它存储对给定行中元素的引用，然后当您调用时`moveComment()`，它将在同一个元素上工作，而不仅仅是在 DOM 中具有相同 ID 的下一个元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-19T19:05:29.697

试试 textarea.innerHTML

查看您的代码：

```
alert(document.getElementById("txtComment").innerHTML); 
```

# iphone - UIScrollView not scrolling when set to a tableView's tableHeaderView

> ID：884468
> 
> 赞同：0
> 
> 时间：2009-05-19T19:01:21.843
> 
> 标签：iphone, objective-c, cocoa-touch

I'm having difficulty scrolling a UIScrollView instance in my UITableView when I set it as a tableHeaderView.

It still responds to touch events it appears, but doesn't wish to scroll horizontally. I've tried explicitly setting to setUserInteractionEnabled:YES without much luck.

Is there something in particular I need to do to get scrolling working when this is set as a tableHeaderView?

Thanks.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-26T07:09:02.803

您可能需要检查您的`scrollView.contentSize`, ensure `scrollView.contentSize.width`> 绑定宽度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-19T20:28:37.767

这将 UIScrollView 嵌入到 UIScrollView 中（因为 UITableView 是 UIScrollView）。您可能希望将 tableview 的 canCancelContentTouches 设置为 NO，这样它就不会取消您的 UIScrollView 的触摸。如果您的 UITableView 需要垂直滚动，这可能会产生一些问题。

如果这是您的问题，请将 UITableView 子类化以重载 touchesShouldCancelInContentView: 以便对于水平拖动（或者对于标题中的触摸）不会返回 YES。

# coldfusion - cfgrid boolean column as Yes/No

> ID：884474
> 
> 赞同：3
> 
> 时间：2009-05-19T19:04:34.957
> 
> 标签：coldfusion, boolean, cfgrid, cfgridcolumn

I have a boolean type column in an html cfgrid. The data is stored in the database as 1/0 and is returned from CF as such. I want the user to see Yes/No instead of 1/0\. I tried QuerySetCell, and couldn't get it to work.

The form is editable, when you double click the cell, the checkboxes show and it updates as it should. The only issue is the display.

```
<cfform>
   <cfgrid name="blah" format="html" bind="mycfccall" selectmode="edit">
      <cfgridcolumn name="bitCol" header="Is it" width="75" type="boolean">
   </cfgrid>
</cfform> 
```

Thanks in advance...

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-19T19:47:39.490

您需要应用自定义字段渲染器。您需要向页面添加一个 init() js 函数以及一个渲染器方法。我有在我的博客上应用自定义渲染器的基本过程：

[CF8 Ajax Grid：渲染器和事件](http://blog.cutterscrossing.com/index.cfm/2007/11/30/CF8-Ajax-Grid-Renderers-and-Events)

基本上，您将在网格初始渲染后调用您的 init() 方法，方法是使用 ajaxOnLoad() 方法：

```
<cfset ajaxOnLoad("init") /> 
```

在您的 init() 方法中，您将获得对网格的引用，它是 ColumnModel：

```
init = function() {
    var myGrid = ColdFusion.Grid.getGridObject('myGridID');
    var gridCM = myGrid.getColumnModel();
    // The rest goes here
} 
```

您还需要您的渲染器方法，您可以将其应用于任何列：

```
yesNoRenderer = function(value,meta,record,row,column,store) {
    if (value === 1){
        return "Yes";
    } else {
        return "No";
    }
} 
```

之后，您需要将渲染器应用于您选择的列：

```
gridCM.setRenderer(cm.getIndexById('myColumnName'), yesNoRenderer); 
```

setRenderer 方法采用列索引（从 0 开始）和作为渲染器应用的函数。getIndexById() 方法在这里应该可以工作，但您应该先对其进行测试以确保，并记住大小写在 JavaScript 中很重要。

大多数 CF Ajax 组件在底层使用 Ext 1.1。仔细阅读有关[ColdFusion JavaScript 函数](http://livedocs.adobe.com/coldfusion/8/htmldocs/JavaScriptFcns_01.html)的 Adob​​e 文档，并记住您可以利用底层的[Ext 1.1 API](http://extjs.com/deploy/ext-1.1.1/docs/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-04-21T11:17:07.313

我认为在数据库查询中使用 Decode 会更容易：

```
Decode(bitCol,1,'Yes','No') bitCol 
```

# .net - 带有多个参数的VB9新线程

> ID：884476
> 
> 赞同：1
> 
> 时间：2009-05-19T19:04:45.690
> 
> 标签：.net, vb.net, multithreading, lambda

我正在尝试创建一个新线程并发送多个参数以及一个委托来报告。

在 VB8 中，我总是讨厌这样做，因为它需要引入新的类/结构或委托。

在 VB9 中有没有更好的方法来做到这一点？

我正在寻找这样的解决方案：

```
 Dim Th As New Thread(AddressOf DoStuff)
   Th.Start(param1, param2, AddressOf ReportStatus) 
```

我不擅长 LINQ 和 Lambda，所以我希望有人会告诉我一些很酷的技巧来做到这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-19T19:14:04.237

您*可以*将匿名函数传递给线程构造函数。

```
Dim Th = New Thread(Sub() DoStuff(param1, param2, AddressOf ReportStatus)) 
```

但不幸的是，VB9 中没有匿名订阅者（它们将在 VB10 中 - 在 C# 中这应该已经可以工作了）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-19T19:10:01.453

没有。VB9 中没有什么新东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-19T19:13:18.480

也许您已经对此很熟悉了，但是根据您的应用程序，使用 ThreadPool 可能有用且容易。我不太了解使用 ThreadPool.QueueUserWorkItem 发送参数，但是[这个](http://thevalerios.net/matt/2008/05/use-threadpoolqueueuserworkitem-with-anonymous-types/)页面似乎提供了一个很好的教程，涉及 lambda 表达式和匿名类型。它在 C# 中，但我确信它会转换为 VB。

# google-api - 如何在不使用的情况下在网页中发布 Google 日历 ?

> ID：884480
> 
> 赞同：7
> 
> 时间：2009-05-19T19:05:39.993
> 
> 标签：google-api, google-calendar-api

Google Calendar provides a way to insert your Google Calendar into a web page using an <iframe>. Is there a way to insert this data into a web page without having to use the <iframe>?

I know that there are ways to do this using the Google API, but is there any way that I can put that code directly into my page without the need to use the <iframe> or rewrite the entire source code and call the Google API?

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-19T20:39:31.757

Actually you can just make it an object and it will validate. For the Google calendar in particular, all you have to do is change "iframe" to "object" (don't for get to change the iframe break too), change "src" to "data", and remove the frameborder and scrolling tags and all is good. The only drawback is that objects are not supported in IE....

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-11-10T16:39:34.270

I'd say you'd get what you want with [restylegc](http://www.restylegc.com/). You can check the strategy the developer used and insert into your page. It basically uses curl to get the entire webapp and rewrites links dynamically so that it's in the middle of some request. This also allows you to restyle the calendar and add custom javascript.

# wpf - How can I speed up the rendering of my WPF ListBox?

> ID：884488
> 
> 赞同：2
> 
> 时间：2009-05-19T19:06:50.523
> 
> 标签：wpf, performance, user-interface, listbox

I have a WPF ListBox control [(view code)](http://github.com/jcbozonier/alloy/blob/2e82343b4b0739eb32ff3fd63354decbe08fc452/IronTwit/Alloy/Alloy.UI/Views/MainView.xaml) and I am keeping maybe like 100-200 items in it. Every time the ObservableCollection it is bound to changes though it takes it a split second to update and it freezes the whole UI. Is there a way to add elements incrementally or something I can do to improve the performance of this control?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-02-26T15:00:24.780

尝试在哪里（PanelList 是 ListBox 或其他东西）；

```
new Task(delegate {
   foreach (var info in new DirectoryInfo("C:\\windows\\system32").EnumerateFiles()) {
       PanelList.Dispatcher.Invoke(DispatcherPriority.Background, (Action)delegate {
          PanelList.Items.Add(info);
       });
       Thread.Sleep(0);
   }
}).Start(); 
```

您想通过 Dispatcher.Invoke 运行后台任务并逐步更新 UI 控件，请确保将您的优先级设置得相对较低，我总是为了好玩而进入睡眠状态（自愿上下文交换），您还应该检查您的当前任务已取消...

哦，是的，这与其说是性能改进，不如说是性能和 UI 响应能力。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T02:53:48.673

Try setting VirtualizingStackPanel.IsVirtualizing="True" on your ListBox - [MSDN Documentation](http://msdn.microsoft.com/en-us/library/system.windows.controls.virtualizingstackpanel.aspx). Also see this [blog post](http://blogs.vertigo.com/personal/ralph/Blog/archive/2007/07/09/wpf-filtering-a-listview.aspx) I came across. I haven't tried it personally, but it seems like a good place to start. Good luck!

# java - 另一个表的条目的数据库表？

> ID：884497
> 
> 赞同：0
> 
> 时间：2009-05-19T19:07:56.933
> 
> 标签：java, database, h2

我正在设计我的 Java 应用程序的新版本（使用嵌入式 H2 数据库），重新设计我将处理我的数据的方式。这是我的计划：

*   参赛表——
    *   条目编号
    *   条目名称
*   属性表-
    *   物业编号
    *   属性名称
*   （个人财产）价值表-
    *   值 ID
    *   条目编号
    *   （值列...）
*   （个人条目）值表-
    *   属性名称
    *   （个人财产）价值ID

每个条目可以有多个属性（包括相同类型的多个属性）。每个属性都有自己的存储值的方式。我需要查找为给定条目定义的所有属性，可能还有每个给定属性的所有条目。

这是一个好方法吗？

**编辑：**我不确定我解释得很好......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-19T19:19:04.290

在我看来，这是一种非常糟糕的数据建模方式，但这是一种非常象牙塔式的看待情况的方式，因为我不必在实践中使用这种模型。顺便说一句，它被称为“实体-属性-值”方法。我不喜欢它的原因是因为它非常不像模式，因为大多数 SQL 功能必须以某种方式复制。

肯定有它的时间和地点（例如，如果您打算对具有不同模型的许多对象进行建模）或具有经常更改的模式。但我个人认为这很可怕。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-19T19:16:11.597

如果我对您的理解正确，我会使用交叉表或[联结](http://en.wikipedia.org/wiki/Intersection_table)表而不是您所描述的。

因此，您可以创建一个查询来获取每个 Entery 的所有属性，或每个属性的所有 Enteries。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-19T20:11:55.867

我同意未知的谷歌。这也称为[内部平台效应](http://en.wikipedia.org/wiki/Inner-platform_effect)。

# emacs - 如何在 Emacs 中拦截 Ctrl-G

> ID：884498
> 
> 赞同：10
> 
> 时间：2009-05-19T19:08:03.033
> 
> 标签：emacs, elisp

`Ctrl`我有一个 Emacs 的 elisp 脚本，如果用户点击+ ，我想对其进行一些清理`G`。我使用 'read-event' 来捕获所有事件，但这不会捕获`Ctrl`+ `G`。当`Ctrl`+`G`被击中时，它只是停止执行。

在 XEmacs 中，当您调用 next-command-event 时，它将为您提供所有事件，包括用户点击`Ctrl`+的时间`G`。在 Emacs 中必须有一些等价物。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-19T19:17:27.397

您可以使用`with-local-quit`来确定是否`C-g`被按下：

*[按照efunneko](https://stackoverflow.com/users/98862/efunneko)的建议，编辑了吞咽退出的解决方案。*

```
(defun my-c-g-test ()
  "test catching control-g"
  (interactive)
  (let ((inhibit-quit t))
    (unless (with-local-quit
              (y-or-n-p "arg you gonna type C-g?")
              t)
      (progn
        (message "you hit C-g")
        (setq quit-flag nil))))) 
```

*注意：* with-local-quit 返回最后一个表达式的值，或者`nil`if`C-g`被按下，所以当 no 被按下时一定要返回非 nil`C-g`的值。[我发现关于戒烟](https://www.gnu.org/software/emacs/manual/html_node/emacs/Quitting.html)的 elisp 文档很有用。一个相关的领域是非[本地出口](https://www.gnu.org/software/emacs/manual/html_node/elisp/Nonlocal-Exits.html)，特别是[`unwind-protect`](https://www.gnu.org/software/emacs/manual/html_node/elisp/Cleanups.html)，它不仅仅适用于退出。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-07-09T08:44:20.520

`condition-case`并且`unwind-protect`在这里很有帮助。 `condition-case`让您“捕捉”“异常”，其中退出是其中之一：

```
(condition-case
    (while t) ; never terminates
  (quit (message "C-g was pressed"))) 
```

您还可以捕获其他错误，例如“错误”。

`unwind-protect`就像最后一样；它将执行“body forms”，然后执行“unwind forms”。但是，无论“主体表单”是否成功运行，都会执行“展开表单”：

```
(unwind-protect
    (while t)
  (message "Done with infinite loop")) 
```

你想要`unwind-protect`在你的情况下。

# ruby-on-rails - 如何在红宝石中对数字进行上限和舍入

> ID：884512
> 
> 赞同：41
> 
> 时间：2009-05-19T19:10:11.717
> 
> 标签：ruby-on-rails, ruby

我想在 Ruby（在 Rails 上）中“限制”一个数字。

例如，作为函数的结果，我有一个浮点数，但我需要一个整数。

我有非常具体的说明，这里有一些例子：

如果我得到`1.5`我想要`2`但如果我得到`2.0`我想要`2`（而不是`3`）

做是`number.round(0) + 1`不行的。

我可以编写一个函数来做到这一点，但我确信一个已经存在。

但是，如果它不存在，我应该在哪里创建我的 cap 函数？

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2009-05-19T19:18:16.583

试试[ceil](http://ruby-doc.com/docs/ProgrammingRuby/html/ref_c_float.html#Float.ceil)：

```
 1.5.ceil => 2
 2.0.ceil => 2 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-19T19:16:26.587

怎么样`number.ceil`？

这将返回大于或等于 number 的最小 Integer。

如果您将其与负数一起使用，请小心，确保它符合您的预期：

```
1.5.ceil      #=> 2
2.0.ceil      #=> 2
(-1.5).ceil   #=> -1
(-2.0).ceil   #=> -2 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-05-09T15:03:25.553

.ceil 很好，但请记住，即使 float 中的最小值也会导致：

```
a = 17.00000000000002
17.0
a.ceil
18 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-05-19T19:17:25.773

使用[数字#ceil](http://ruby-doc.org/core-1.8.7/classes/Numeric.html#M000577)：

```
irb(main):001:0> 1.5.ceil
=> 2
irb(main):002:0> 2.0.ceil
=> 2
irb(main):003:0> 1.ceil
=> 1 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-19T19:21:25.547

[float.ceil](http://www.ruby-doc.org/docs/ProgrammingRuby/html/ref%5Fc%5Ffloat.html)是您想要的正数。请务必考虑负数的行为。也就是说，您希望 -1.5 将“上限”设置为 -1 还是 -2？

# asp.net - 如何防止 web.config 中的 applicationSettings 被继承？

> ID：884515
> 
> 赞同：2
> 
> 时间：2009-05-19T19:11:08.110
> 
> 标签：asp.net, iis, iis-6, asp.net-2.0

我的 ASP.NET 2.0 Web 应用程序的 web.config 中有一个 applicationSettings 部分。这非常适合存储值并能够作为强类型值访问它们。

这是我的 web.config 的片段：

```
<configuration>
 ... 
 <applicationSettings>
     <MyWebsite.Properties.Settings>
        <setting name="ExcludedItemNumbers" serializeAs="Xml">
           <value>
              <ArrayOfString xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                 xmlns:xsd="http://www.w3.org/2001/XMLSchema">
                 <string>123</string>
                 <string>124</string>
              </ArrayOfString>
           </value>
        </setting>
     </MyWebsite.Properties.Settings>
  </applicationSettings>
</configuration> 
```

但是，我在 IIS 服务器上在此下方有另一个虚拟目录（默认情况下继承此 web.config）。将 applicationSettings 添加到此 web.config 后，子虚拟目录会引发运行时错误，抱怨 web.config 错误（我假设因为 MyWebsite.Properties.Settings 不是子站点中的有效类型）。

如何保持对我在此站点中设置的强类型访问，而不破坏继承此 web.config 的站点？我尝试在 applicationSettings 标记周围做[location 标记](https://stackoverflow.com/questions/37759/how-do-you-prevent-the-iis-default-site-web-config-file-being-inherited-by-virtua)，但这会在此站点上产生运行时错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-24T08:34:26.493

您可以将[clear 元素](http://msdn.microsoft.com/en-us/library/ms228133.aspx)添加到您的子 web.config 文件中。

```
<appSettings file="">
      <settings>
         <clear />
      </settings>
   </appSettings> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T01:36:32.743

您还可以使用 remove 元素：

```
<appSettings>
      <settings>
         <remove key="someKey" />
         <add key="someKey" value="a new value" />
      </settings>
</appSettings> 
```

# c# - 用 linq 清理一个简单的 foreach

> ID：884519
> 
> 赞同：0
> 
> 时间：2009-05-19T19:12:37.080
> 
> 标签：c#, linq

以下方法非常简单，我试图通过将订单项的另一个属性与来自父对象的查找进行匹配来确定订单项费率。有一些我不喜欢它的地方，我正在寻找优雅的解决方案来使方法更小，更高效，或两者兼而有之。它在当前状态下工作，并且不像它明显低效或任何东西。这不是关键任务或其他任何东西，更多的是一种好奇心。

```
 private decimal CalculateLaborTotal()
    {
        decimal result = 0;

        foreach (ExtraWorkOrderLaborItem laborItem in Labor)
        {
            var rates = (from x in Project.ContractRates where x.ProjectRole.Name == laborItem.ProjectRole.Name select x).ToList();
            if (rates != null && rates.Count() > 0)
            {
                result += laborItem.Hours * rates[0].Rate;
            }
        }
        return result;
    } 
```

我喜欢使用`List<T>.ForEach()`. 有什么想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-19T19:18:35.257

像这样的东西应该这样做（未经测试！）：

```
var result = 
    (from laborItem in Labor
     let rate = (from x in Project.ContractRates 
                 where x.ProjectRole.Name == laborItem.ProjectRole.Name 
                 select x).FirstOrDefault()
     where rate != null
     select laborItem.Hours * rate.Rate).Sum(); 
```

或者（假设只有一个速率可以匹配）连接会更整洁：

```
var result = 
    (from laborItem in Labor
     join rate in Project.ContractRates
         on laborItem.ProjectRole.Name equals rate.ProjectRole.Name
     select laborItem.Hours * rate.Rate).Sum(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-19T19:23:29.740

好的，这个怎么样：

```
// Lookup from name to IEnumerable<decimal>, assuming Rate is a decimal
var ratesLookup = Project.ContractRates.ToLookup(x => x.ProjectRole.Name,
                                                 x => x.Rate);

var query = (from laborItem in Labor
             let rate = ratesGroup[laborItem].FirstOrDefault()
             select laborItem.Hours * rate).Sum(); 
```

这里的优点是您不需要每次都查看可能很大的合同费率列表 - 您只需构建一次查找。当然，这可能不是问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-19T19:23:21.207

省略`rates != null`检查 - linq 查询可能为空但不是`null`。如果您只需要列表的第一个元素，请使用`List.First`or `List.FirstOrDefault`。

使用没有任何优势`List<T>.ForEach`。

# flash - ExternalInterface Woes

> ID：884523
> 
> 赞同：0
> 
> 时间：2009-05-19T19:14:17.747
> 
> 标签：flash, actionscript-2, externalinterface

I know there are an abundance of articles and forum post (many of them from myself) regarding ExternalInterface, I guess I'll add one more...

I have a small flash app (a button) which is set up to test the availability of ExternalInterface and it works great. I also have a larger, more complex, flash mp3 player, which I am trying to use ExternalInterface with; it does not work so great. The question is, where does the problem lie? My working externalInterface code looks like this:

```
import flash.external.ExternalInterface  
myBtn.onRelease = function(){  
chkAvail();  
}  

function chkAvail() {  
var myText:TextField = this.createTextField('myText', this.getNextHighestDepth(), 100, 100, 300, 21);  
ExternalInterface.call("alert",'EI works!!");  
myText.text = String(ExternalInterface.available);  
} 
```

And all of that works great. My mp3 player code looks like this (excerpt, full code posted [here](http://pastebin.com/f727ea599)): At the top-

```
import flash.external.ExternalInterface; 
```

and where I want to call the javascript-

```
function loadPlaylist(){

//attempting to make external js call

ExternalInterface.call("alert", "Hello World!1");

//

track_display_mc.display_txt.text = LOADING_PLAYLIST_MSG;

if(track_display_mc.display_txt._width>track_display_mc.mask_mc._width){

    track_display_mc.onEnterFrame = scrollTitle;

}else{... 
```

So why does the first one work and not the second one? I feel like I'm calling them correctly from the html. Could it be a problem with importing the flash.external.ExternalInterface? Should I include that in the .flv where the .as is imported/included, instead of in the actual actionscript? All help/ideas are greatly appreciated...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-28T16:56:14.417

mp3 播放器 swf 和 html 在同一个域上吗？

您是否在对象 + 嵌入标签中设置了 allowscriptaccess=always？

# linux - 如何调查一个进程在做什么？

> ID：884525
> 
> 赞同：20
> 
> 时间：2009-05-19T19:14:26.247
> 
> 标签：linux, filesystems

我知道这可以从 /proc/PID 目录中检查，

但不知道怎么做

谁能给我指路？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-11-20T08:55:10.537

通常 strace 是这个问题的答案。最简单的方法是直接使用 strace 运行命令，例如：

```
wichert@fog:~$ strace ls
execve("/bin/ls", ["ls"], [/* 16 vars */]) = 0
brk(0)                                  = 0x9fa8000
access("/etc/ld.so.nohwcap", F_OK)      = -1 ENOENT (No such file or directory)
mmap2(NULL, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0xb7f0a000
access("/etc/ld.so.preload", R_OK)      = -1 ENOENT (No such file or directory) 
```

这不适用于已经运行的进程，例如 PHP。*幸运的是，您还可以使用-p*参数将 strace 附加到现有进程。例如：

```
wichert@fog:~$ strace -p 3761
Process 3761 attached - interrupt to quit
select(16, [5 7 8], NULL, [5 7 8], {0, 580000}) = 0 (Timeout)
alarm(0)                                = 62
rt_sigprocmask(SIG_BLOCK, [ALRM], [], 8) = 0
rt_sigaction(SIGALRM, {SIG_DFL}, {0x809a270, [], 0}, 8) = 0
rt_sigprocmask(SIG_SETMASK, [], NULL, 8) = 0 
```

对于产生其他进程的守护进程，您可能还需要使用*-f*参数。

除了总是有用的 strace 你可能还想看看*ltrace*。ltrace 类似于 strace，但它显示库调用而不是系统调用。一个例子：

```
[one;~]-6> ltrace ls
__libc_start_main(0x804e5f0, 1, 0xbfdb7254, 0x8059a10, 0x8059a00 <unfinished ...>
setlocale(6, "")                                                                                 = "LC_CTYPE=en_GB.UTF-8;LC_NUMERIC="...
bindtextdomain("coreutils", "/usr/share/locale")                                                 = "/usr/share/locale"
textdomain("coreutils")                                                                          = "coreutils"
__cxa_atexit(0x8051860, 0, 0, 0xb7f65ff4, 0xbfdb71b8)                                            = 0
isatty(1)                                                                                        = 1
getenv("QUOTING_STYLE")                                                                          = NULL 
```

请注意，您还将看到大量的内部 libc 调用，因此输出可能比您预期的更详细。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-19T19:16:45.527

如果您正在寻找监视进程正在进行的系统调用，请考虑使用[strace](http://www.google.com/url?sa=t&source=web&ct=res&cd=2&url=http%3A%2F%2Fen.wikipedia.org%2Fwiki%2FStrace&ei=dAUTSq78OZiwtAPXhbH2DQ&usg=AFQjCNFP2X7tTJp8k8MqQDTc-17BAfIbaA&sig2=d1x_fuKGEYS6s2fd_aF_lA)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2019-03-26T09:00:53.950

一个很好的工具是 ps 和 lsof。您可以使用 ps 查找该进程的 PID 或进程 ID，或使用 ps -u {process-username} 获取它的 PID。然后使用 lsof 查看该 PID 打开了哪些文件，如下所示`lsof -p pid`。

您也可以使用 netstat 显示所有连接和相应的端口。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-19T19:17:53.557

我依靠`strace`命令。但它只告诉进程正在进行的系统调用。不过可能就够了……

可以在运行时将正在运行的进程绑定到`strace`。

显然，`gdb`也可以使用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-19T19:25:35.540

您在寻找什么类型的信息？/proc/pid 下的伪目录应该是不言自明的。这真的取决于你在寻找什么。对于一般 mem 和 cpu 使用，像 top 这样的工具可能更好，因为它会更新配置间隔的统计信息

# visual-studio-2008 - VS 2008 中的 Wrapper Assembly Key File 设置在哪里？

> ID：884528
> 
> 赞同：3
> 
> 时间：2009-05-19T19:16:00.893
> 
> 标签：visual-studio-2008, com-interop, strongname, typelib, tlbimp

我正在尝试构建一个强命名的应用程序。它引用了我通过“添加引用”对话框添加的 COM 互操作库。已经有一段时间了，但我似乎记得在旧版本的 Visual Studio 中，有一个*Wrapper Assembly Key File*的项目设置。我似乎在 Visual Studio 2008 中找不到它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-07T19:44:36.307

我遇到了您的帖子，正在寻找同样的东西，但我自己找到了一条不同的路线来解决强命名 COM 互操作引用程序集的问题。

`/keyfile:<key.snk>`您可以使用以下参数在 Visual Studio 中引用之前使用密钥文件对导入的类型库程序集进行签名：

```
tlbimp MyCOMService.tlb /out:Interop.MyCOMService.dll /keyfile:MyKeyFile.snk 
```

# c# - 将大量数据复制到 SQL CE 数据库中

> ID：884534
> 
> 赞同：2
> 
> 时间：2009-05-19T19:16:38.350
> 
> 标签：c#, .net, ado.net, sql-server-ce, bcp

如果我在内存中有大量数据，将其复制到 SQL CE 表中的最佳方法是什么？当前的技术堆栈是 C#、ADO.net 和 SQL CE。

我最初的想法是为每一行数据做一个 INSERT 语句，但这很耗时。有没有更简单的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-20T04:24:36.883

Steve Lasker 有一个很棒的[代码示例](http://steve.lasker.members.winisp.net/Demos/SQLce35/SQLcePerformance.zip)，用不同的方法对此进行了演示，但最好的方法（到目前为止）是[SqlCeResultSet](http://msdn.microsoft.com/en-us/library/system.data.sqlserverce.sqlceresultset(VS.80).aspx)。

这是[史蒂夫的一篇博客文章，](http://blogs.msdn.com/stevelasker/archive/2008/11/25/demos-presentations-links-screencasts-and-videos-for-sql-server-compact.aspx)其中包含有关此主题的一些很好的演示文稿。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-19T23:25:02.560

我想到的第一件事是与桌面或服务器数据库进行同步/合并，尽管这听起来并不适合您的需求。所以这是我的第二个想法：

从数据文件中批量插入表名

我不确定您的 SQL CE 版本是否支持它（尽管根据我在 MSDN 页面上的信息，它似乎在 3.5 SP1 中受支持）。[http://msdn.microsoft.com/en-us/library/ms188365.aspx](http://msdn.microsoft.com/en-us/library/ms188365.aspx)

您还可以在插入数据时禁用表上的任何索引以加快速度，然后在完成插入后启用/重建索引。

# asp.net - IIS 崩溃经常发生.. IIS 6 Win 2003 上的 ASP.net 应用程序

> ID：884536
> 
> 赞同：1
> 
> 时间：2009-05-19T19:16:41.470
> 
> 标签：asp.net, iis-6

我在 win 2003 上在 IIS 6 上运行了这个 ASP.net 应用程序。我每隔几分钟就会经常遇到这个 iis 崩溃问题。

应用程序经常重新启动并丢失所有会话信息。

事件查看器显示以下信息：

EventType clr20r3、P1 w3wp.exe、P2 6.0.3790.3959、P3 45d6968e、P4 app_code.soku_afh、P5 0.0.0.0、P6 4a12f739、P7 2f6、P8 30、P9 异常、P10 NIL。

关于如何解决它的任何指示..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-19T19:22:49.303

可能有帮助的类似问题：

*   [w3wp.exe 经常崩溃](https://stackoverflow.com/questions/603239/w3wp-exe-is-crashing-frequently)
*   [IIS 6.0 应用程序池崩溃](https://stackoverflow.com/questions/476473/iis-6-0-application-pool-crash)
*   [IIS 手动故障排除](https://stackoverflow.com/questions/643734/iis-hang-troubleshooting)
*   [获取 IIS 工作进程故障转储](https://stackoverflow.com/questions/53435/getting-iis-worker-process-crash-dumps)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-19T19:19:39.793

尝试在 web.config 上使用你自己的机器密钥，它可以解决问题

# c# - 在 c# 中打印 0.1 的增量

> ID：884538
> 
> 赞同：7
> 
> 时间：2009-05-19T19:17:21.920
> 
> 标签：c#, floating-point

我目前正在阅读 Steve McConnell 的 Code Complete，特别是关于浮点数的第 295 页。

当我运行以下代码时：

```
 double nominal = 1.0;
        double sum = 0.0;

        for (int i = 0; i < 10; i++)
        {
            sum += 0.1;
            Console.WriteLine("sum: " + sum.ToString());
        }

        if (equals(nominal,sum))
        {
            Console.WriteLine("Numbers are the same");
        }
        else
        {
            Console.WriteLine("Numbers are different");
        } 
```

我打印了 *0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1.0 数字不同*

为什么我没有得到假设发生的输出？即： *0.1 0.2 0.30000000000000004 0.4 0.5 0.6 0.7 0.79999999999999999 0.899999999999999999 0.99999999999999999 数字不同*

当我进行从双精度到字符串的隐式转换时，C# 是否舍入数字？我是这么认为的，因为当我调试应用程序并逐步执行 for 循环时，我可以看到非终止的重复十进制数。你怎么看？我是对还是错？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-19T19:22:36.933

double.ToString() 使用一般格式，如果未指定精度，则默认为 15 位小数。所以它确实做了一点四舍五入，这就是为什么你看到你所看到的。例如，您在问题中指定的 0.89999999999999999 是小数点后 17 位。实际上，您可以通过执行来查看整个数字`sum.ToString("g17")`。

您可以在此处找到 .net 的标准数字格式字符串及其默认精度：http: [//msdn.microsoft.com/en-us/library/dwhawy9k (VS.80).aspx](http://msdn.microsoft.com/en-us/library/dwhawy9k(VS.80).aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-19T19:27:26.113

它在 ToString 默认行为中。如果你在调试器中查看 sum，你会得到这个，它显示了没有通过 ToString 路由的值：

```
0.0
0.1
0.2
0.30000000000000004
0.4
0.5
0.6
0.7
0.79999999999999993
0.89999999999999991 
```

表明潜在行为与您预期的一样。

hth

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-19T19:44:29.200

简短的回答是：它是浮点数，所以不要指望它是正确的（对于“正确”的合适值）！长答案是了解浮点如何工作以及人们如何使用浮点。IIRC GNU printf（以及我认为的其他人）特殊情况“真的非常接近一个不错的以 10 为基数的数字”。

# .net - WinForms：XP Luna 上进度条的前景色总是绿色

> ID：884541
> 
> 赞同：0
> 
> 时间：2009-05-19T19:17:36.100
> 
> 标签：.net, winforms, windows-xp

WinForms ProgressBar 控件允许设置其前景色。虽然这通常可以正常工作，但在 XP 上使用令人讨厌的 Luna 样式时，前景色设置似乎被忽略了：它始终是绿色的。

同样，XP Luna 似乎忽略了“样式”：虽然我已将其设置为“连续”，但进度条始终是用块绘制的。

这应该是正确的行为吗？有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-19T19:28:13.630

要禁用 Luna 视觉样式，您可以在自动生成的 Program 类中删除对 Application.EnableVisualStyles() 的调用。

这将使之后创建的表单上的所有控件看起来像 Windows 2000。

您可以根据操作系统有条件地调用它，因为 Vista 的视觉样式尊重 Style 属性 IIRC（现在无法测试 - 我的笔记本电脑坏了）。

* * *

您可以通过 Paint 事件或从控件派生并覆盖 OnPaint*() 手动处理控件的呈现。

您也可以从头开始自己滚动，因为进度条相当简单。

# mercurial - mercurial 中是否有提交时忽略选项？

> ID：884545
> 
> 赞同：40
> 
> 时间：2009-05-19T19:18:27.020
> 
> 标签：mercurial, hgignore

有没有办法在使用 mercurial 提交时忽略对某些文件的更改？

我有一个特定的情况，我们有一个默认的 oracle tnsnames.ora 文件指向 127.0.0.1，但是一些开发人员会修改它以指向其他系统，但我们不想更改默认文件。

在颠覆中，我简单地将其添加到了提交时忽略更改列表中。有没有办法在 mercurial 中做到这一点？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2009-05-22T01:16:36.990

如果你想从“hg commit”命令中省略的文件已经被“跟踪”了，你应该使用 -X 选项。传递给 -X 的模式非常灵活，例如可以运行：

```
% hg stat
A etc/foo.conf
M src/bar.c
M lib/libbar/loader.c
% hg commit -X '**.conf' 
```

避免提交任何带有“.conf”扩展名的文件，无论它在源代码树中有多深。在上面显示的工作区中，这将提交“src/bar.c”和“lib/libbar/loader.c”，但不会提交“etc/foo.conf”。

要排除多种文件名模式，请使用多个 -X 选项，即：

```
% hg commit -X '**.conf' -X '**.sh' 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-05-21T03:18:03.943

传统上，解决这个问题的方法不是对文件本身进行版本控制，而是将其副本作为模板供其他人使用。

所以你会`hg mv tnsnames.ora tnsnames.ora-template`，然后提交，然后将 tnsnames.ora-template 的直接文件系统副本复制到 tnsnames.ora，并将 tnsnames.ora 添加到 .hgignore 文件。

对模板的后续更改仍将被推出，但它们实际上不会改变工作环境，除非有人将模板复制到实际文件中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-19T19:29:25.033

您可以将 commit 别名为“hg commit -X exclude_file.ext”之类的东西，我从未使用过 mercurial，所以我只是在此处查看手册页。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-05-19T19:21:24.877

在 Mercurial 的文档中查找 .hgignore 文件。

这是一个示例忽略文件。

```
 # use glob syntax.
       syntax: glob

       *.elc
       *.pyc
       *~

       # switch to regexp syntax.
       syntax: regexp
       ^\.pc/ 
```

# sharepoint - SharePoint 中真的有 50 个变体标签限制吗？

> ID：884552
> 
> 赞同：2
> 
> 时间：2009-05-19T19:19:51.307
> 
> 标签：sharepoint

我们正在开发一个面向公众的网站，该网站必须进行本地化以支持 70~100 种语言。

有人说您真的不想在 SharePoint 中拥有超过 50 个变体标签。我在网络上的任何地方都找不到任何关于此的支持材料。

2个问题：

1.  有没有人有过部署大量变体标签的经验？
2.  有没有人在他们可以指出我的地方读到这个限制？

问候，

彼得

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-19T22:55:10.937

根据 TechNet 文章[计划变化](http://technet.microsoft.com/en-us/library/cc262404.aspx)有 50 个变化的限制。然而，使用 SharePoint 2007 SP2，我创建了 58 个变体标签并设法创建了层次结构。

查看 Andrew Connell 的书 Professional SharePoint 2007 Web Content Management Development：Building Publishing Sites with Office SharePoint Server 2007

是的，我有使用大量变体标签的经验。这不好玩。最终我们放弃了使用 Variations 来管理我们的多语言网站。我们基本上构建了一个与 Varitions 类似但按我们希望的方式工作的定制解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-19T20:03:42.780

回答第一，不，到目前为止我的经验还没有。

不直接回答第 2 条但可能仍然有用的信息，[这是 Sharepoint 服务各个方面的“软限制”列表](http://technet.microsoft.com/en-us/library/cc287790.aspx)我没有看到对变体标签的引用，但那里有大量信息与在*您*看到性能下降之前它可以处理多少有关

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-20T13:24:28.010

发现一篇[technet文章](http://technet.microsoft.com/en-us/library/cc262404.aspx)解释了这一点：

A variation label is an identifier that is used to name and configure a new variation site. You select one variation label as the source, which represents the site where most of the new content enters the system. The corresponding variation labels are the target labels, representing the sites to which content is copied. **(Office SharePoint Server 2007 supports up to 50 labels.)** You create variation sites from variation labels by using the Create Hierarchy command on the Variation Labels page of the Office SharePoint Server 2007 site administration pages.

# ruby-on-rails - rails script/generate 默认跳过不必要的文件

> ID：884553
> 
> 赞同：4
> 
> 时间：2009-05-19T19:19:55.130
> 
> 标签：ruby-on-rails, ruby, rspec, rails-generate

自从我开始使用 rspec 等以来，脚本/生成变得非常烦人。我不再需要单元测试文件和固定装置，但是脚本/生成无论如何都会生成它们。

是否可以设置`--skip-fixtures`并`--skip-test`默认为系统范围（或至少项目范围）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-19T19:45:35.983

您可以编辑您的应用程序脚本/生成文件以自动附加选项

```
#!/usr/bin/env ruby

ARGV << "--skip-fixture" if ["model"].include?(ARGV[0])

require File.dirname(__FILE__) + '/../config/boot'
require 'commands/generate' 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-19T19:52:07.967

那么，对于初学者来说，

```
ruby script/generate rspec_model
ruby script/generate rspec_controller 
```

至少这不会生成单元测试，它会为我提供规范:)

但是 --skip-fixtures 仍然必须通过。我刚刚在 .bash_profile 中创建了自己的别名

```
alias model='ruby script/generate rspec_model $1 --skip-fixture' 
```

然后我可以做

```
model bar name:string active:boolean 
```

这一切都有效:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-01-19T02:33:57.853

我使用 minitest_rails 作为我的测试框架，您可以通过 config/application.rb 文件设置一些默认值。

```
config.generators do |g|
  g.test_framework :mini_test, :spec => true, :fixture => false
end 
```

当您生成模型（和控制器）时，它现在将自动跳过夹具。此示例还将使用 minitest_spec 格式创建单元测试。

# tsql - T-SQL 分组问题

> ID：884554
> 
> 赞同：0
> 
> 时间：2009-05-19T19:20:17.547
> 
> 标签：tsql

每隔一段时间我就会遇到这样的情况，并且永远无法提出最有效的查询来获取信息：

假设我们有一个包含三列（A int、B int、C int）的表。我的查询需要回答这样的问题：“告诉我，对于 A = 5 的 B 列的最大值，C 列的值是多少。” 像这样的真实世界场景是“A”是您的用户，“B”是发生某事的日期，“C”是值，您希望在其中获得特定用户的最新条目。

我总是以这样的查询结束：

```
SELECT
    C
FROM
    MyTable
WHERE
    A = 5
    AND B = (SELECT MAX(B) FROM MyTable WHERE A = 5) 
```

我在单个查询中缺少什么（反对嵌套它们）？某种“有”子句？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-19T19:36:01.370

当您只关心 A=5 的 1 结果时，BoSchatzberg 的答案有效。但我怀疑这个问题是一个更一般的案例的结果。如果您想列出 A 的每个不同值的最高记录怎么办？

```
SELECT t1.*
FROM MyTable t1
   INNER JOIN 
     (
       SELECT A, MAX(B)
       FROM MyTable
       GROUP BY A
     )  t2 ON t1.A = t2.A AND t1.B = t2.B 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-19T19:34:12.840

你可以这样做：

```
SELECT TOP 1 C
FROM    MyTable
WHERE    A = 5
ORDER BY b DESC 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-19T19:38:06.777

```
--
SELECT C
FROM MyTable
INNER JOIN (SELECT A, MAX(B) AS MAX_B FROM MyTable GROUP BY A) AS X
    ON MyTable.A = X.A
    AND MyTable.B = MAX_B
--
WHERE MyTable.A = 5 
```

在这种情况下，第一部分（在评论之间）也可以很容易地移动到视图中以实现模块化或重用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-19T19:25:10.220

我认为你很接近（你所拥有的会起作用）。您可以使用以下内容：

```
select C
     , max(B)
  from MyTable
 where A = 5
group by C 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-19T19:31:49.443

经过一些测试，我认为如果不按照您已经这样做的方式（即子查询）就可以做到这一点。由于您需要 B 的最大值，并且如果不将其包含在 GROUP BY 或 HAVING 子句中就无法获得 C 的值，因此子查询似乎是最好的方法。

```
 create table #tempints (
    a int,
    b int,
    c int
    )

    insert into #tempints values (1, 8, 10)
    insert into #tempints values (1, 8, 10)
    insert into #tempints values (2, 4, 10)
    insert into #tempints values (5, 8, 10)
    insert into #tempints values (5, 3, 10)
    insert into #tempints values (5, 7, 10)
    insert into #tempints values (5, 8, 15)

    /* this errors out with "Column '#tempints.c' is invalid in the select list because it is not contained in either an 
    aggregate function or the GROUP BY clause." */
    select t1.c, max(t1.b)
    from #tempints t1
    where t1.a=5 

    /* this errors with "An aggregate may not appear in the WHERE clause unless it is in a subquery contained in a HAVING 
    clause or a select list, and the column being aggregated is an outer reference." */
    select t1.c, max(t1.b)
    from #tempints t1, #tempints t2
    where t1.a=5 and t2.b=max(t1.b)

    /* errors with "Column '#tempints.a' is invalid in the HAVING clause because it is not contained in either an aggregate 
function or the GROUP BY clause." */
    select c
    from #tempints
    group by b, c
    having a=5 and b=max(b)

    drop table #tempints 
```

# c# - C# 3.0 中 var 关键字的优势

> ID：884555
> 
> 赞同：3
> 
> 时间：2009-05-19T19:20:25.690
> 
> 标签：c#, variables

复制：

> [使用什么 var 或对象名称类型](https://stackoverflow.com/questions/236878/what-to-use-var-or-object-name-type)

我无法理解 var 关键字在 C# 3.0 中的需要使用它有什么好处。我看到了[这个](https://stackoverflow.com/questions/41479/use-of-var-keyword-in-c)问题，但不明白使用它的真正目的

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-05-19T19:25:08.380

当您可以使用匿名类型作为投影时，它主要存在于 LINQ 中：

```
var query = from person in employees
            where person.Salary > 10000m
            select new { FullName=person.Name, person.Department }; 
```

这里的类型`query`不能显式声明，因为匿名类型没有名字。（在现实世界的情况下，匿名类型通常包含来自多个对象的值，因此没有一个包含所有属性的命名类。）

当您使用潜在的长类型名称（通常由于泛型）初始化变量并仅调用构造函数时，它实际上*也很有用 - 它增加了信息密度（减少了冗余）。*这两行中的信息量相同：

```
List<Func<string, int>> functions = new List<Func<string, int>>();
var functions = new List<Function<string, int>>(); 
```

但第二个以更紧凑的方式表达它。

当然这*可以*被滥用，例如

```
var nonObviousType = 999999999; 
```

但是当类型的变量是什么很明显时，我相信它可以显着提高可读性。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-19T19:25:01.547

它存在的主要原因是在 C# 中引入了匿名类型。您可以动态构建没有名称的类型。你会如何指定他们的名字？答案：你不能。您只需告诉编译器为您推断它们：

```
var user = users.Where(u=> u.Name == "Mehrdad")
                .Select(u => new { u.Name, u.Password }); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-19T19:25:24.480

这是声明 var 的一种简写方式。虽然 "int i = new int()" 的类型并不多，但当你开始输入更长的类型时，你最终会得到很多如下所示的行：

```
SomeReallyLong.TypeName.WithNameSpaces.AndEverything myVar = new SomeReallyLong.TypeName.WithNameSpaces.AndEverything(); 
```

最终有人想到，由于您用于初始化 var 的信息，编译器已经知道您要声明的类型，因此要求编译器在这里做正确的事情并不过分。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-19T19:24:56.163

*   Linq 表达式不返回预定义类型，因此您需要一个“通用”变量声明关键字来捕获该类型以及使用匿名类型的其他地方。
*   小心使用，通过将方法的返回类型与捕获它的变量解耦，它可以使重构更容易。
*   对于同一个语句，必须将相同的名称放在同一行两次确实有点愚蠢。输入这样的内容很痛苦：

.

```
ReallyLongTypeName<SomeOtherLongTypeName> MyVariable = new ReallyLongTypeName<SomeOtherLongTypeName>(); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-19T19:26:21.903

这里有几个优点

1.  打字少，功能不丢失
2.  增加代码的类型安全性。使用类型为 var 的迭代变量的 foreach 循环将静默捕获以显式类型引入的强制转换
3.  使您不必在变量声明中两次编写相同的名称。
4.  一些特性，比如声明一个强类型的匿名类型局部变量，需要使用 var

无耻的自我推销。不久前我写了一篇关于这个主题的博客文章，当我认为 var 的使用是合适的并且包含与这个主题相关的信息时，它深入探讨了。

*   [http://beta.blogs.msdn.com/jaredpar/archive/2008/09/09/when-to-use-type-in​​ference.aspx](http://beta.blogs.msdn.com/jaredpar/archive/2008/09/09/when-to-use-type-inference.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-19T19:26:31.497

简而言之：

1.  最小化两次键入变量类型的需要
2.  在支持匿名类型时必不可少，例如由 LINQ 查询返回的类型

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-19T19:38:18.057

var 关键字的真正需要是支持 C# 3.0 中的匿名类型——反过来又需要正确支持 LiNQ（语言集成查询）。

如果不使用 var 你永远不能做这样的事情：

```
 var person = new { Name = "Peter", Age=4}; 
```

这意味着您无法执行以下 linq 查询，因为您不知道如何将其分配给变量：

```
[var/sometype] dogsFixedQuery = from myDog in kennel select new {dogName = myDog.FirstName + " " + myDog.OwnerLastName, myDog.IsNeutered, dogLocation = kennel.Address}; 
```

如果您开始创建具有多个返回和连接级别的更复杂的 linq 查询，则匿名类型的实用性将更加明显。

如果您是懒惰的打字员，您可以以其他方式使用 var 来避免输入类似内容的事实`IEnumerable<Dictionary<List<string>,IOrderedCollection<DateTime>> myBadDesign = getBadDesignController().BadDesignResults("shoppingCart");` 只是副作用/奖励=）

如果您开始在不同的位置调用 var，那么可读性会有所下降，但是如果您将 var 用于强类型并且编译器可以确定变量的类型，那么任何读者都应该能够确定它。

# .net - 如何将 System::String 转换为 unsigned char *？

> ID：884564
> 
> 赞同：-1
> 
> 时间：2009-05-19T19:22:17.200
> 
> 标签：.net, c++-cli, clr

我看到[另一个帖子](https://stackoverflow.com/questions/56561/what-is-the-best-way-to-convert-between-char-and-systemstring-in-c-cli)，建议如下：

```
String^ clistr = gcnew String("sample");
IntPtr p = Marshal::StringToHGlobalAnsi(clistr);
char *pNewCharStr = static_cast<char*>(p.ToPointer());
Marshal::FreeHGlobal(p); 
```

我只是想检查一下是否还有其他首选方式，或者上述方法是否有问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-19T21:16:23.287

谷歌上“System::String char*”的第一个结果似乎提供了相当全面的指导。 [http://support.microsoft.com/kb/311259](http://support.microsoft.com/kb/311259)

# .net - .NET 3.0 和 3.5 之间的区别？

> ID：884568
> 
> 赞同：4
> 
> 时间：2009-05-19T19:22:57.777
> 
> 标签：.net, .net-3.5, .net-3.0

.NET 3.0 和 3.5 框架之间的主要区别是什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-19T19:31:36.043

ASP.NET AJAX 是为 3.5 内置的

**.Net 3.0**

> .net 2.0 功能 + WF+WPF+WCF+ Cardspace

**.Net 3.5**

> .Net 3.0 功能 + LINQ、ASP.NET AJAX、新控件、更丰富的 WCF 支持（包括 REST、AtomPub）以及其他一些功能

有关更多详细信息，请参阅：[.Net Frameworks](http://dufoli.wordpress.com/2007/09/11/net-framework-11-20-30-35-21/)，它显示了与 .net frameworks 1.0 及更高版本的区别和新增功能

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-19T19:26:23.337

最大的是[LINQ](http://msdn.microsoft.com/en-us/netframework/aa904594.aspx)

# algorithm - 作为流操作的数基转换

> ID：884572
> 
> 赞同：8
> 
> 时间：2009-05-19T19:23:32.127
> 
> 标签：algorithm, math, complexity-theory

有没有办法*在恒定工作空间*中进行任意大小和任意基本转换。也就是说，要使用 1 对 1 映射（*最好*但不一定）保留字典顺序并给出顺序结果，将范围内的`n`数字序列转换为范围内`[1,m]`的`ceiling(n*log(m)/log(p))`数字序列？`[1,p]`

 *我对作为管道功能可行的解决方案特别感兴趣，ei 能够处理比存储在 RAM 中更大的数据集。

我发现了许多需要与输入大小成比例的“工作空间”的解决方案，但还没有一个解决方案可以摆脱恒定的“工作空间”。

* * *

放弃顺序约束有什么不同吗？即：允许按字典顺序输入导致非按字典顺序输出：

```
F(1,2,6,4,3,7,8) -> (5,6,3,2,1,3,5,2,4,3)
F(1,2,6,4,3,7,9) -> (5,6,3,2,1,3,5,2,4,5) 
```

* * *

一些想法：

这可能有用吗？

> streamBase [n] -> convert( `n`, `lcm(n,p)`) -> convert( `lcm(n,p)`, `p`) -> streamBase [p]

（`lcm`最小公倍数在哪里）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-19T19:42:10.093

我认为在一般情况下这是不可能的。如果`m`是`p`（或反之亦然）的幂，或者如果它们都是共同基的幂，则可以这样做，因为每组 log [`m`]( `p`) 都是独立的。但是，在一般情况下，假设您要转换 number 。基数中的等价数是`a`[`1`] `a`[`2`] `a`[`3`] `...` `a`[`n`]`p`

`sum(a`[`i`] `*` `m`^(`i-1`)对于`i`在`1..n)`

如果我们已经处理了第一个`i`数字，那么我们就有了`i`第 th 个部分和。要计算`i+1`'th 部分和，我们需要添加。在一般情况下，这个数字在大多数地方都是非零数字，所以我们需要修改到目前为止我们已经处理的所有数字。换句话说，我们必须先处理*所有*输入数字，然后才能知道最终输出数字是什么。`a`[`i+1`] `* m`^(`i`)

 *`m`在一个公共底数的幂的特殊情况下，或者等效地如果 log [`m`]( `p`) 是一个有理数，那么在靠近前面`m`^(`i`)的底数中只会有几个非零数字`p`，所以我们可以安全地输出我们的大部分数字到目前为止已经计算过了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-20T04:19:32.487

我认为有一种方法可以按字典顺序以面向流的方式进行基数转换。然而，我想出的还不足以真正做到这一点，它有几个假设：

1.  位置编号的长度是已知的。
2.  所描述的数字是整数。我没有考虑过 maths 和 -ive 索引会发生什么。

我们有一系列长度为*p的值**a*，其中每个值都在 [0, *m* -1] 范围内。我们想要一个长度为*q*在 [0, *n* -1]范围内的值*b序列。*我们可以从*a中计算出输出序列**b的第**k*个数字，如下所示：

 ***b [k] = floor[ sum(a [i] * m ^i for i in 0 to p-1) / n ^k ] mod n

让我们将总和重新排列为两部分，将其拆分为任意点*z*

b [k] = floor[ ( sum(a [i] * m ^i for i in z to p-1) + sum(a [i] * m ^i for i in 0 to z-1) ) / n ^k ] mod n

假设我们还不知道 [0,z-1] 之间的 a 的值并且无法计算第二个和项。我们不得不处理范围。但这仍然为我们提供了有关*b [k]*的信息。

*b [k]*的最小值可以是：

b [k] >= floor[ sum(a [i] * m ^i for i in z to p-1) / n ^k ] mod n

*b [k]*的最大值可以是：

b [k] <= floor[ ( sum(a [i] * m ^i for i in z to p-1) + m ^z - 1 ) / n ^k ] mod n

我们应该能够做这样的过程：

1.  *将z*初始化为*p*。当我们收到*a 的每个字符时，我们将从**p*开始倒计时。
**   *将k*初始化为*b*中最重要值的索引。如果我的大脑还在工作，ceil[log [n] (m ^p ) ]。*   *读取a*的值。递减*z*。*   *计算b [k]*的最小值和最大值。*   如果最小值和最大值相同，则输出*b [k]*并递减 k。转到 4。（可能我们已经为*b [k]*的几个连续值提供了足够的值）*   如果*z !=0 那么我们期望**a 有*更多的值。转到 3。*   希望，在这一点上我们已经完成了。*

 *我还没有考虑如何有效地计算范围值，但我有理由相信从 a 的传入字符计算总和比存储所有*a*更*合理*。虽然不做数学，但我不会对此提出任何硬性要求！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-05-24T02:57:07.753

对的，这是可能的

对于您读入的每个 I 个字符，您将根据 Ceiling(Length * log(In) / log(Out)) 写出 O 个字符。

分配足够的空间

```
Set x to 1
Loop over digits from end to beginning # Horner's method
    Set a to x * digit
    Set t to O - 1
    Loop while a > 0 and t >= 0
        Set a to a + out digit
        Set out digit at position t to a mod to base
    Set a to a / to base
Set x to x * from base
Return converted digit(s) 
```

因此，对于基数 16 到 2（这很容易），使用“192FE”我们读取 '1' 并将其转换，然后重复 '9'，然后是 '2'，依此类推，得到 '0001'，'1001'， “0010”、“1111”和“1110”。请注意，对于不是普通幂的碱基，例如从 17 到 2 的底数意味着读取 1 个字符并写入 5 个字符。

# asp.net-mvc - 我的动作控制器代码看起来很业余

> ID：884574
> 
> 赞同：0
> 
> 时间：2009-05-19T19:23:59.583
> 
> 标签：asp.net-mvc, actioncontroller

第一次发帖时间，

我一直在玩 MVC... 我有一个有多个输入字段的视图，其中一些字段在发布时可能是空白的。

帖子控制器内部的操作方法看起来像这样

```
public ActionResult Filter(int? id, string firstName, string lastName, bool? isMember) 
```

我一直在使用一直在使用的 DynamicQuery 扩展，以便在我的数据库上执行动态 Linq 查询，我已经将它封装在一个 Search 对象中，该对象传递给数据访问层以供执行。

但是，我还有一个自定义的 ViewData 对象，它被传递回视图以显示输入值和查询结果。

这一切在代码中看起来有点讨厌，因为我必须同时设置搜索对象属性和 ViewDatas。

```
public ActionResult Filter(int? id, string firstName, string lastName, bool? isMember)  { 
var search = new Search { 
Id = id, 
FirstName = firstName, 
LastName = lastName, 
Member =  isMember 
}; 

var memberViewData = new MemberViewData { 
Id = id, 
FirstName = firstName, 
LastName = lastName, 
Member =  isMember
}; 

memberViewData.Results = _dataRepository.GetMember(search); 

return View("Search", memberViewData); 

} 
```

我是不是想太多了，真的应该将值传递给数据访问层并在控制器中填充 ViewData，还是我可以使用更优雅的模式或实践？

抱歉，如果这看起来很垃圾，没有分配人来反弹想法并有时间深入研究框架。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-19T19:33:03.747

使用modelbinder绑定数据

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-19T19:41:28.613

根据您的代码片段 MemberViewData 类除了 Search 类的属性之外还具有 Results 属性。所以第一步是让 MemberViewData 从 Search 派生并定义一个接受 Search 实例作为参数的构造函数并从中分配它的基本属性。接下来，我将像这样更改操作方法：

```
public ActionResult Filter(Search search)  
{ 
    return View("Search", new MemberViewData(search) 
    {
        Results = _dataRepository.GetMember(search)
    }); 
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-19T19:38:01.990

就像 Tadeusz 提到的那样，ModelBinder 可以帮助您构建 MemberViewData，这将只留下要获取的结果。

您还可以决定创建一个表示服务，该服务了解如何构建此视图数据对象并简单地委托给它。不过，我更喜欢这里的模型绑定方法。

# pdf - Ghostscript 多页 PDF 转 PNG

> ID：884586
> 
> 赞同：18
> 
> 时间：2009-05-19T19:25:48.177
> 
> 标签：pdf, png, ghostscript

我一直在使用 ghostscript 来做 pdf 以从 pdf 生成单个页面的图像。现在我需要能够从 pdf 中提取多个页面并生成一个长的垂直图像。

有没有我遗漏的论点允许这样做？

到目前为止，当我调用 ghostscript 时，我使用了以下参数：

```
string[] args ={
                "-q",                     
                "-dQUIET",                   
                "-dPARANOIDSAFER", // Run this command in safe mode
                "-dBATCH", // Keep gs from going into interactive mode
                "-dNOPAUSE", // Do not prompt and pause for each page
                "-dNOPROMPT", // Disable prompts for user interaction                           
                "-dFirstPage="+start,
                "-dLastPage="+stop,   
                "-sDEVICE=png16m",
                "-dTextAlphaBits=4",
                "-dGraphicsAlphaBits=4",
                "-r300x300",                

                // Set the input and output files
                String.Format("-sOutputFile={0}", tempFile),
                originalPdfFile
            }; 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-19T20:47:57.200

我最终将“%d”添加到“OutputFile”参数中，以便每页生成一个文件。然后我只需阅读所有文件并将它们拼接到我的 c# 代码中，如下所示：

```
var images =pdf.GetPreview(1,8); //All of the individual images read in one per file

using (Bitmap b = new Bitmap(images[0].Width, images.Sum(img=>img.Height))) {
    using (var g = Graphics.FromImage(b)) {
        for (int i = 0; i < images.Count; i++) {
            g.DrawImageUnscaled(images[i], 0, images.Take(i).Sum(img=>img.Height));
        }
    }
    //Do Stuff
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2014-06-19T12:19:47.897

如果你可以使用 ImageMagick，你可以使用它的一个很好的命令：

```
montage -mode Concatenate -tile 1x -density 144 -type Grayscale input.pdf output.png 
```

在哪里

*   `-density 144`决定 dpi 的分辨率，如果需要增加它，默认为 72
*   `-type Grayscale`如果您的 PDF 没有颜色，请使用它，您将在生成的图像中保存一些 KB

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-19T19:59:11.040

首先检查输出设备选项；但我认为没有选择。

很可能你需要自己做一些拼版，或者让 GhostScript 去做（你必须编写一个 PostScript 程序），或者用 ImageMagick 或类似的东西缝合生成的渲染页面。

如果您想尝试 PostScript 路线（可能是最有效的），请查看 GhostScript 包中包含的 N-up 示例。

# linux - Grep 递归和计数

> ID：884591
> 
> 赞同：12
> 
> 时间：2009-05-19T19:26:36.473
> 
> 标签：linux, bash, shell, scripting

需要在包含大量子目录的目录中搜索文件中的字符串：

我正在使用：

```
grep -c -r "string here" * 
```

我如何计算发现的总数？

如何仅将具有至少一个实例的文件输出到文件？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-19T19:36:46.093

使用 Bash 的进程替换，这给出了我认为你想要的输出？（如果不是，请澄清问题。）

```
grep -r "string here" * | tee >(wc -l) 
```

这`grep -r`会正常运行，输出会同时发送到标准输出和`wc -l`进程。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-19T19:40:27.490

它对我有用（它获取在每个文件中找到的“字符串此处”的总数）。但是，它不显示搜索的所有文件的总数。以下是如何获得它：

```
grep -c -r 'string' file > out && \
    awk -F : '{total += $2} END { print "Total:", total }' out 
```

列表将输出，总数将发送到 STDOUT。

这是 Python2.5.4 目录树上的输出：

```
grep -c -r 'import' Python-2.5.4/ > out && \
    awk -F : '{total += $2} END { print "Total:", total }' out
Total: 11500

$ head out
Python-2.5.4/Python/import.c:155
Python-2.5.4/Python/thread.o:0
Python-2.5.4/Python/pyarena.c:0
Python-2.5.4/Python/getargs.c:0
Python-2.5.4/Python/thread_solaris.h:0
Python-2.5.4/Python/dup2.c:0
Python-2.5.4/Python/getplatform.c:0
Python-2.5.4/Python/frozenmain.c:0
Python-2.5.4/Python/pyfpe.c:0
Python-2.5.4/Python/getmtime.c:0 
```

如果您只想获取出现“字符串”的行，请更改为：

```
grep -c -r 'import' Python-2.5.4/ | \
    awk -F : '{total += $2; print $1, $2} END { print "Total:", total }' 
```

这将输出：

```
[... snipped]
Python-2.5.4/Lib/dis.py 4
Python-2.5.4/Lib/mhlib.py 10
Python-2.5.4/Lib/decimal.py 8
Python-2.5.4/Lib/new.py 6
Python-2.5.4/Lib/stringold.py 3
Total: 11500 
```

您可以更改文件 ($1) 和每个文件的计数 ($2) 的打印方式。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-19T19:53:29.383

AWK的一些解决方案：

```
grep -r "string here" * | awk 'END { print NR } 1' 
```

下一个是总计数、文件数和每个匹配项的数量，显示每个匹配项的第一个匹配项（要显示所有匹配项，请将条件更改为`++f[$1]`）：

```
grep -r "string here" * | 
    awk -F: 'END { print "\nmatches: ", NR, "files: ", length(f); 
                   for (i in f) print i, f[i] } !f[$1]++' 
```

第一个解决方案的输出（在目录中搜索“ `boost::`”。我手动剪切了一些太长的行，以便它们水平放置）：

```
list_inserter.hpp:            return range( boost::begin(r), boost::end(r) );
list_of.hpp:            ::boost::is_array<T>,
list_of.hpp:            ::boost::decay<const T>,
list_of.hpp:            ::boost::decay<T> >::type type;
list_of.hpp:        return ::boost::iterator_range_detail::equal( l, r );
list_of.hpp:        return ::boost::iterator_range_detail::less_than( l, r );
list_of.hpp:        return ::boost::iterator_range_detail::less_than( l, r );
list_of.hpp:        return Os << ::boost::make_iterator_range( r.begin(), r.end() );
list_of.hpp:            return range( boost::begin(r), boost::end(r) );
list_of.hpp:            return range( boost::begin(r), boost::end(r) );
list_of.hpp:            return range( boost::begin(r), boost::end(r) );
ptr_list_of.hpp:                          BOOST_DEDUCED_TYPENAME boost::ptr_...
ptr_list_of.hpp:        typedef boost::ptr_vector<T>       impl_type;
13 
```

第二个输出

```
list_inserter.hpp:            return range( boost::begin(r), boost::end(r) );
list_of.hpp:            ::boost::is_array<T>,
ptr_list_of.hpp:                          BOOST_DEDUCED_TYPENAME boost::ptr_...

matches:  13 files:  3
ptr_list_of.hpp 2
list_of.hpp 10
list_inserter.hpp 1 
```

结果中的颜色很好（`--color=always`对于 grep），但是在此处通过 awk 管道时它们会中断。所以最好不要启用它们，除非你想让你的所有终端都上色:) 干杯！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-19T19:36:27.187

我会尝试 find 和 grep 的组合。

```
find . | xargs grep -c "string here" 
```

无论如何，`grep -c -r "string here" *`对我有用（Mac OS X）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-08-01T22:53:54.483

```
grep -rc "my string" ./ | grep :[1-9] >> file_name_by_count.txt 
```

奇迹般有效。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-19T19:49:47.143

要仅输出匹配的文件名，请使用：

```
grep -r -l "your string here" . 
```

它将为每个与搜索的表达式匹配的文件输出一行文件名。

# python - 包装 Python 对象

> ID：884594
> 
> 赞同：1
> 
> 时间：2009-05-19T19:27:00.123
> 
> 标签：python

我想将 Python 对象序列化为 plist 格式（这可以使用 plistlib 完成）。我的想法是编写一个包装其他对象的类 PlistObject：

```
def __init__(self, anObject):
     self.theObject = anObject 
```

并提供了一个“写”方法：

```
def write(self, pathOrFile):
    plistlib.writeToPlist(self.theObject.__dict__, pathOrFile) 
```

现在，如果 PlistObject 的行为就像被包装的对象本身一样，那就太好了，这意味着所有属性和方法都以某种方式“转发”到被包装的对象。我意识到这些方法可以用于复杂的属性操作`__getattr__`：`__setattr__`

```
 def __getattr__(self, name):
         return self.theObject.__getattr__(name) 
```

但是当然我遇到了构造函数现在产生无限递归的问题，因为它也`self.theObject = anObject`尝试访问包装的对象。

我怎样才能避免这种情况？如果整个想法看起来很糟糕，也请告诉我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-19T19:41:07.817

除非我遗漏了什么，否则这会很好用：

```
def __getattr__(self, name):
    return getattr(self.theObject, name) 
```

* * *

**编辑：**对于那些认为查找`self.theObject`会导致无限递归调用 的人`__getattr__`，让我向您展示：

```
>>> class Test:
...     a = "a"
...     def __init__(self):
...         self.b = "b"
...     def __getattr__(self, name):
...         return 'Custom: %s' % name
... 
>>> Test.a
'a'
>>> Test().a
'a'
>>> Test().b
'b'
>>> Test().c
'Custom: c' 
```

`__getattr__`只是作为[不得已而](http://docs.python.org/reference/datamodel.html#object.__getattr__) [为之](http://docs.python.org/3.0/reference/datamodel.html?highlight=__getattr__#object.__getattr__)。由于`theObject`可以在 中找到`__dict__`，因此不会出现任何问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-19T19:36:15.067

> 但是当然我遇到了构造函数现在产生无限递归的问题，因为 self.theObject = anObject 也尝试访问包装的对象。

这就是手册建议您对所有“真实”属性访问执行此操作的原因。

```
theobj = object.__getattribute__(self, "theObject") 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-19T22:30:14.293

我很高兴看到其他人能够帮助您递归调用`__getattr__`. 既然您已经要求对序列化到 plist 的一般方法发表评论，我只是想表达一些想法。

Python 的 plist 实现只处理基本类型，并没有提供扩展机制来指导它对复杂类型进行序列化/反序列化。例如，如果您定义一个自定义类，writePlist 将无法提供帮助，正如您在传递实例`__dict__`进行序列化时所发现的那样。

这有几个含义：

1.  您将无法使用它来序列化包含其他非基本类型对象的任何对象，而无需将它们`__dict__`递归地转换为 a ，等等，以用于整个网络图。

2.  如果您使用自己的网络图遍历器来序列化所有可以到达的非基本对象，您将不得不担心图中的圆圈，其中一个对象在属性中具有另一个对象，而该属性又会保留对第一个对象的引用等等等等。

鉴于那时，您可能希望查看 pickle，因为它可以处理所有这些以及更多。如果您出于其他原因需要 plist 格式，并且您确定可以坚持使用“简单”对象字典，那么您可能希望只使用一个简单的函数......尝试让 PlistObject 模拟包含的每个可能的函数object 是一个可能有很多层的洋葱，因为您需要处理包装实例的所有可能性。

像这样简单的东西可能更 Pythonic，并且通过首先不包装它来保持包装对象的可用性更简单：

```
def to_plist(obj, f_handle):
    writePlist(obj.__dict__, f_handle) 
```

我知道这看起来不是很性感，但在我看来，鉴于 plist 格式的严格限制，它比包装器更易于维护，而且肯定比人为地强制应用程序中的所有对象从一个公共基类继承要好得多当您的业务领域中没有任何东西实际上表明这些不同的对象是相关的时。

# php - 重写 URL 是否有助于搜索引擎找到该页面？

> ID：884597
> 
> 赞同：2
> 
> 时间：2009-05-19T19:28:12.757
> 
> 标签：php, url, seo, search-engine, rewrite

我的 URL 看起来像“/pages.php?page=pageName”，因为我使用数据库来提供页面的内容。将 URL 重写为“/pageName”之类的内容是否有助于搜索引擎找到页面？如果是这样，我该如何重写它们？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-19T19:34:28.860

它可能不会帮助爬虫找到页面，但它可能会对如何对它们进行排名产生积极影响，因为更好的 URI 通常会获得更好的排名（当然，其他条件相同）。让它们永久保存也很好。

请参阅[Cool URIs don't change](http://www.w3.org/Provider/Style/URI)

关于您如何在 Apache 世界中拥有[mod_rewrite](http://httpd.apache.org/docs/2.0/misc/rewriteguide.html)以及在 IIS 世界中的一些[其他](http://www.micronovae.com/ModRewrite/ModRewrite.html) [选项。](http://www.isapirewrite.com/)

示例（Apache 的语法）：

```
RewriteEngine On
RewriteRule ^(.*)$ pages.php?page=$1 
```

这会将 URI 中域名之后的所有内容（关于尾部斜杠有一个警告）作为页面参数传递给 pages.php。

这是

```
http://yourdomain.com/bears 
```

将返回由提供的内容

```
http://yourdomain.com/pages.php?page=bears 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-19T19:33:27.397

也许更好的问题是“重写 URL 是否有助于**用户**在搜索引擎中找到页面？”。答案是“是”。例如，假设您的页面内容讨论了海豚。谷歌将更多的权重放在搜索词“海豚”上：

```
/Dolphins.php 
```

比

```
/pages.php?page=1323 
```

您会发现这是大多数现代网站正在做的事情（包括 stackoverflow）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-19T19:32:21.250

Google 的[SEO 指南](http://www.google.com/support/webmasters/bin/answer.py?hl=en&answer=35291)在“改进 URL 的结构”部分下提到了一些有关 URL 的提示。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-19T19:38:02.097

您可以在站点的根目录中创建 .htaccess 文件并将其添加到文件中：

```
Options +FollowSymlinks
RewriteEngine On
RewriteRule ^/pages/(.*) pages.php?page=$1 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-19T20:55:50.270

看看[这个来自谷歌的博客条目](http://googlewebmastercentral.blogspot.com/2008/09/dynamic-urls-vs-static-urls.html)。

特别是这句话。

> 一项建议是避免重新格式化动态 URL 使其看起来是静态的

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-20T07:39:47.677

想强调页面扩展的必要性，例如 .html 以及 url 内的斜线被解释为站点“树形图”内的虚拟目录路径的事实。

正如 Keltex 在 category.html 这样的路径中所说的，比 /category/subcategory.html 有更多的“权重”

无论如何，必须实施友好的网址以及站点地图。所有这些与基本的 SEO 标题相结合，正确的标题会给你一个很好的结果。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-19T19:30:50.693

它无助于搜索引擎更容易找到页面（事实上，如果实施不当，可能会使搜索引擎更难抓取您的网站），但如果处理得当，它将使您的页面在相关关键字中排名更好

对于 PHP，请查看 mod_rewrite for Apache

我不是正则表达式专家，但它使用模式匹配规则来执行重写，网上会有很多关于 mod_rewrite 的文档和教程

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-19T19:34:32.807

它不会帮助搜索引擎更容易地找到它们。为确保搜索引擎找到您的网页，您可以做的最重要的两件事是：

1.  创建一个[站点地图](http://www.sitemaps.org/)，在您的 robots.txt 中引用它，并使用[Google WebMaster 工具注册它](https://www.google.com/accounts/ServiceLogin?service=sitemaps&passive=true&nui=1&continue=https%3A%2F%2Fwww.google.com%2Fwebmasters%2Ftools%2Fdashboard&followup=https%3A%2F%2Fwww.google.com%2Fwebmasters%2Ftools%2Fdashboard&hl=en#utm_campaign=en&utm_source=en-ha-na-us-sk&utm_medium=ha&utm_term=google%20webmaster%20tools)

2.  确保您确实有指向您网站上所有页面的可抓取的非 JavaScript 链接（最好是文本链接）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-19T20:45:25.877

搜索引擎会更*喜欢*您的网页。如果有一个动态文件结尾和一个查询字符串，大多数搜索引擎认为它是一个动态页面，它很快就会改变，因此不会像静态页面那样排名它。

然后你已经完成了重写，你可以很容易地在你的 PHP 中解析它并用 php.ini 决定你的 url 结构。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2017-05-10T14:12:32.513

出于 SEO 目的，最好在 URL 中包含您的关键字。但是，如果它已经是已发布的页面，请确保在进行更改之前设置从现有 URL 到新 URL 的重定向。没有人喜欢[断开的链接](https://productforums.google.com/forum/#!topic/websearch/GivzHoakDP0)。

# sifr - Sifr 浏览器问题

> ID：884600
> 
> 赞同：0
> 
> 时间：2009-05-19T19:29:14.097
> 
> 标签：sifr

www.johncowle.co.uk/

我在我的网站索引中使用了 Sifr。它在 Safari 中运行良好，但在 Firefox 中没有出现。

为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-19T19:35:31.587

如果您想要基于跨浏览器且不需要用户使用 Flash 的字体替换，我建议您查看 cufon (google it)

# ldap - LDAP 解决了什么问题？

> ID：884604
> 
> 赞同：64
> 
> 时间：2009-05-19T19:30:26.653
> 
> 标签：ldap

我在参与的许多项目中都接触过 LDAP，但说实话，我并不真正了解它。我以为它只是一个人目录，但在我发现它可以包含分层结构中的任何对象之后。

我在我的盒子里安装了 openldap，我发现了很多关于安装的教程。

什么是 LDAP？在哪些情况下 LDAP 是正确的选择？使用它时我应该了解哪些 LDAP 概念？LDAP 的优点是什么？是否只是因为旧应用程序使用它而使用它？互联网上的任何地方都有解释所有这些问题的好文档吗？

**更新：补充我发现**[这个链接](http://www.go4expert.com/forums/showthread.php?t=4814)的答案，其中包含像我这样的 LDAP 新手的快速入门指南。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-05-19T19:43:07.343

> 什么是 LDAP？在哪些情况下 LDAP 是正确的选择？

LDAP 的核心是一种用于访问适合存储在目录中的对象的协议。某物是否“合适”完全是由实施者决定的主观判断，但通常这意味着*许多对象的集合，每个对象都很少（或从不）更新数据*，其中每个对象都有明显或规范的查找方式：

*   电话簿（按姓名或电话号码查找）
*   图书馆中的标题（按标题、作者等查找）
*   建筑物中的租户（按楼层、套房、姓名等查找）

等等。

请注意，LDAP 本身只是一个协议，并没有提供任何实际的存储——在很大程度上，HTTP 并不暗示您是否使用 Apache、Jetty、Tomcat、Mongrel 等。作为网络服务器。（一般而言，LDAP 的一个问题是混淆重用名称来表示不同的事物。维基百科对此**[有很好的部分](http://en.wikipedia.org/wiki/LDAP#Terminology)**。）

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-05-31T12:22:42.823

DIT 是一种分层描述方案，非常适合 B-Tree 算法，在大多数情况下会产生巨大的搜索性能。像 OpenDS 这样的目录服务器在微秒内返回索引搜索，而 RDBMS 系统要慢得多。目录服务器（通常称为 LDAP 服务器）交换资源（RAM、CPU）以实现快速读取响应。RDBMS 系统在管理相关数据方面提供了更强大的功能。需要很少或零更新、简单性和小型网络协议的速度？使用目录服务器。需要数据管理和挖掘功能，和/或在数据之间定义关系方面的数据库的高变化率？使用 RDBMS（MySQL 是你最好的选择）。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-05-19T19:39:33.950

LDAP 具有 O(1) 的读取性能，以换取 O（更糟）的写入性能。它非常适合经常访问但很少更改的数据——人员目录、机器名称和地址等。（因此缩写为：轻量级目录访问协议。）

LDAP 是正确的选择，其中使用非关系型数据库的痛苦（就开发人员的熟悉度降低和奇怪的性能特征而言）小于令人眼花缭乱的快速读取访问的收益。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-05-19T19:39:00.130

此链接将解释 LDAP [http://blogs.oracle.com/raghuvir/entry/ldap](http://blogs.oracle.com/raghuvir/entry/ldap)

我们在办公室使用 LDAP 进行公司范围内的电子邮件地址查找。我们也将其用作内部应用程序的单一来源登录服务。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2010-05-12T16:36:24.140

我喜欢强调的一个观点是 LDAP 是持久存储之上的应用程序，而数据库是持久存储。两者都可以用来存储用户信息。

LDAP 为您提供了在数据库中更难实现的层次结构。您可以在数据库中创建层次结构，但更难执行委托（这些行仅属于您）或行上的 ACL 之类的事情。因此，如果您使用 LDAP 来存储用户身份，那么将安全问题排除在数据库之外会更容易。试图在数据库中解决它很奇怪。

同时，LDAP 对于报告来说很糟糕（将 LDAP 转换为数据库进行报告）。将需要快速搜索的属性存储在树的深处可能会影响性能（不要这样做，在旁边​​放一个数据库或尝试通过重新设计 DIT 来扁平化查询）。在一个非常深的 DIT 中到处存储属性只是糟糕的 LDAP 或系统设计，但如果您与供应商产品或遗留应用程序绑定，有时这是不可避免的。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2014-03-29T14:13:22.180

请参阅此链接：

[http://www.umich.edu/~dirsvcs/ldap/doc/guides/slapd/1.html#RTFToC1](http://www.umich.edu/~dirsvcs/ldap/doc/guides/slapd/1.html#RTFToC1)

这深入解释了 LDAP：

例如，您可以在该文档中看到此图像，

[![](https://i.stack.imgur.com/ToT5J.gif)](https://i.stack.imgur.com/ToT5J.gif)
[（来源：[www.umich.edu 上的 dirsvcs](http://www.umich.edu/~dirsvcs/ldap/doc/guides/slapd/guide-51.gif)）]

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-05-19T20:38:19.870

我是兼职和全日制学生。我的课程鼓励（阅读要求）许多小组项目。

我使用 openLdap 和 phpLdapAdmin 来控制对我的 Subversion 和 Mercurial 存储库、Trac 项目、Hudson 等的访问。安装起来并不容易，但是在管理中节省的时间是天赐良机。

如果您的项目中有许多需要能够使用不同资源的人，那么它是一个很好的工具。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-05-19T19:38:22.783

LDAP 只是一个协议，维基百科文章充分解释了它[http://en.wikipedia.org/wiki/Lightweight_Directory_Access_Protocol](http://en.wikipedia.org/wiki/Lightweight_Directory_Access_Protocol)

它是一种查询底层组织结构（如 Microsoft 的 Active Directory）的方法。您可以使用 LDAP 查询来获取有关用户的各种信息，将其用于设置应用程序权限等。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-05-19T19:39:57.337

LDAP 是一种访问协议；它只为您尝试为其查找应用程序的底层技术提供 API -[目录服务](http://en.wikipedia.org/wiki/Directory_service)。OpenLDAP 是开源目录服务之一；Sun 有另一个实现，称为 OpenDS。Active Directory 和 Novell NDS 是该领域中另外两个常见的。

该目录可用于存储有关任何类型资源的信息以及资源之间的关系——例如，用户对目录、打印机或网络访问设备的权限。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-19T19:43:35.347

在我的一个旧工作场所，我们使用[LDAP](http://en.wikipedia.org/wiki/Lightweight_Directory_Access_Protocol)作为我们的主要用户身份验证系统。

这反过来又为我们的各种系统提供了部门的信息。他们属于，他们应该安装他们的主目录，联系信息，员工管理。

不一定由 LDAP 控制，但我们通过 LDAP 混合工作的其他因素是 SQL 用户、K4、samba 和电子邮件帐户生成的存在。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2013-05-20T09:49:17.273

> 互联网上的任何地方都有解释所有这些问题的好文档吗？

IBM 出版了一本关于 LDAP 的优秀红皮书。标题是： [**了解 LDAP - 设计和实现**](http://publib-b.boulder.ibm.com/Redbooks.nsf/RedbookAbstracts/sg244986.html?Open)。

可以从上一个链接下载。

# opengl - GLSL：启用/禁用纹理+着色器

> ID：884607
> 
> 赞同：4
> 
> 时间：2009-05-19T19:31:17.353
> 
> 标签：opengl, shader, glsl, texturing

我正在寻找一种从着色器访问 OpenGL 状态的方法。[GLSL 快速参考指南](http://www.opengl.org/sdk/libs/OpenSceneGraph/glsl_quickref.pdf)，一个很棒的资源，在这方面帮不上我的忙。

在我正在处理的示例中，我有以下两个着色器：

顶点：

```
void    main()
{
    gl_FrontColor = gl_Color;
    gl_TexCoord[0] = gl_MultiTexCoord0;
    gl_Position = ftransform();
} 
```

分段：

```
uniform sampler2D   tex;
uniform float   flattening;

void main( void ) 
{
    vec4    texel;
    texel = texture2D(tex, gl_TexCoord[0].st);
    texel.r *= gl_Color.r;
    texel.g *= gl_Color.g;
    texel.b *= gl_Color.b;
    texel.a *= gl_Color.a;
    gl_FragColor = texel;
} 
```

当我渲染没有纹理的多边形时，它们的 alpha 值是正确的，但它们被分配了黑色。

1，我可以设置什么条件检查，以便在禁用`vec4(1.0, 1.0, 1.0, 1.0)`时设置变量“texel”而不是从纹理中采样？`GL_TEXTURE_2D`

2，如果我为不同的纹理模式编写不同的着色器并在我将使用`glEnable`/ `glDisable`( `GL_TEXTURE_2D`) 的位置在它们之间切换，处理会更快吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-19T19:59:05.673

抱歉，您不能从 GLSL 访问那种状态，期间。

事实上，在未来的 GLSL 中，你必须自己发送所有的 unforms/attributes，即没有自动的 gl_ModelViewMatrix、gl_LightPosition、gl_Normal 等。只有 gl_Position 和 gl_FragColor 等基本内容可用。

这种方式使您的第二个问题无效，但是如果您发现这比为不同的纹理模式编写单独的着色器更方便，您总是可以使用#ifdef 来启用/禁用着色器中的部分。

相关的，请注意分支通常相当慢，因此如果您需要速度，请尽可能避免它。（这尤其重要，因为片段在 SIMD 块中处理，并且块中的所有片段必须计算相同的指令，即使它们只适用于一个或几个片段。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-02-03T18:38:10.637

One method I've seen is to bind a 1x1 texture with a single texel of (1.0, 1.0, 1.0, 1.0) when rendering polygons that are not textured. A texture switch should be less expensive than a shader switch and a 1x1 texture will fit entirely inside the texture cache.

# svn - 分享常用/有用的 SVN 预提交钩子

> ID：884608
> 
> 赞同：40
> 
> 时间：2009-05-19T19:31:24.403
> 
> 标签：svn, version-control, hook, svn-hooks, pre-commit

SVN 有哪些常见和/或有用的预提交钩子？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-05-19T19:33:24.947

用户实际上已经在提交消息上输入了评论，并且它包含要跟踪的特定问题编号。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-05-19T19:52:18.043

检查各种文本文件（即 VRML、XML 等）中的绝对路径。大多数签入代码不应该有绝对路径，但有些人和工具坚持生成硬编码的东西。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-05-19T19:34:19.110

我对提交消息进行字数统计。他们需要5个字或更多。这导致了一些对我的喜剧侮辱......

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-05-19T19:34:21.030

*   检查标签并拒绝签入。
*   检查不一致的行尾并拒绝签入。
*   检查是否出现“CR：[用户名]”，如果没有代码审查，则拒绝签入。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2010-08-05T10:40:55.563

您可能想看看： http: [//svn.apache.org/repos/asf/subversion/branches/1.6.x/www/tools_contrib.html#hook_scripts](http://svn.apache.org/repos/asf/subversion/branches/1.6.x/www/tools_contrib.html#hook_scripts)（此页面可能已过时，显然不再维护对于颠覆 1.7)

或直接在： [https ://svn.apache.org/repos/asf/subversion/trunk/contrib/](https://svn.apache.org/repos/asf/subversion/trunk/contrib/)

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-05-19T19:35:16.080

我喜欢使用`svn`钩子：

*   执行更严格的代码风格点
*   检查明显的语法错误
*   确保像“Fixes”或“Addresses”这样的特殊 Trac 关键字实际上位于相应的问题编号之前

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2009-11-24T21:35:40.963

我们有一个 post commit hook 可以将消息发布到 Twitter 帐户。使用[twitsvn](http://code.google.com/p/twitvn/)（免责声明：我是该项目的提交者）。

愚蠢的？也许......但事实证明，它是我们将存储库的进展情况传达给我们的一些版本控制挑战的团队成员的好方法。一旦 SVN 开始通过他们的 twitter 客户端与他们交谈，它就不再像一个黑匣子了。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2009-05-20T12:58:21.743

我检查文件类型并确保某些被禁止的类型不是偶然提交的（例如.obj、.pdb）。好吧，自从有人第一次签入 2 gig 的编译器生成的临时文件以来就没有了 :(

对于窗户：

* * *

```
@echo off

svnlook log -t "%2" "%1" | c:\tools\grep -c "[a-zA-z0-9]" > nul
if %ERRORLEVEL% NEQ 1 goto DISALLOWED

echo Please enter a check-in comment 1>&2
exit 1

:DISALLOWED
svnlook changed -t %2 %1 > c:\temp\pre-commit.txt

findstr /G:"%1\hooks\ignore-matches.txt"  c:\temp\pre-commit.txt > c:\temp\precommit-bad.txt
if %ERRORLEVEL% NEQ 0 exit /b 0

echo disallowed file extension >> c:\temp\precommit-bad.txt
type c:\temp\precommit-bad.txt 1>&2
exit 1 
```

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2009-08-27T14:43:53.517

我使用提交后挂钩将作者属性重写为来自 ldap 树的友好名称。（身份验证使用员工ID）

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2009-08-27T14:49:44.880

我们存档中的一个很棒的提交钩子是检查所有 .VCPROJ（或 .CSPROJ）Visual Studio 项目，以确保输出目录没有更改为本地的任何内容（通常用于调试）。

这些问题将正确编译，但仍会因为缺少可执行文件而中断构建。

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2009-11-22T07:46:54.643

在我目前工作的公司中，对此进行了检查：

*   如果二进制文件设置了需要锁属性；
*   Java 文件是否有标准版权声明并且是否包含当前年份；
*   如果代码格式正确（我们使用 Jalopy 进行代码格式化）——这可能听起来很傻，但它实际上使不同版本之间的文本比较更容易；
*   如果代码有提交信息；
*   如果目录结构符合定义（所有项目都应该在一个定义好的SVN文件夹下，并且每个项目应该有一个tags、branch和trunk文件夹）；

我想就是这样。

我喜欢检查提交是否与票证相关联的想法；这对我来说真的很有意义。

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2009-11-20T23:49:11.977

有些人更喜欢为给定的语言运行类似 lint 的工具，以发现代码中的常见问题和/或强制编码风格。然而，在一个小型且技术娴熟的团队中，我更愿意让每个提交都通过并处理持续集成和/或代码审查期间可能出现的问题。由于这种提交速度更快，这鼓励了更频繁的提交，从而更容易集成。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2009-11-22T22:23:33.390

I use the [check-mime-type.pl pre-commit hook](http://svn.collab.net/repos/svn/trunk/contrib/hook-scripts/check-mime-type.pl) to check that MIME Type and End of line options are set on committed files. I use subversion to publish files to be visible on a website using DAV, and all files without the MIME Type set get served as text files (e.g. HTML source gets displayed in a browser instead of the rendered markup).

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-11-24T20:17:20.717

我们使用 pre-commit 和 post-commit 钩子组合来自动更新 bugzilla 与来自 svn 提交的相关条目。

我们使用第二个（预提交）挂钩来确保在将文件添加到存储库之前在文件上设置适当的 svn:eol-style 和 svn:keywords 属性。

我们有第三个（提交后）钩子来启动构建并在构建损坏时邮寄结果，并在构建再次修复时通知所有人。

我们有第四个（提交后）挂钩来启动 svn 复制，以确保异地复制尽可能是最新的。

不幸的是，我无法发布这些源代码，但是，除了 Bugzilla 集成之外，它们很容易实现，[Hudson](http://hudson-ci.org/)可能是持续集成的更好选择。

对于 bugzilla 集成，我建议查看[scmbug](http://files.mkgnu.net/files/scmbug/SCMBUG_RELEASE_0-26-15/manual/html-single/manual.html#GLUE-SVN)。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2009-05-19T20:07:14.503

根据通过 RegEx 具有“问题 #”等的提交消息，在 Mantis 错误跟踪器中插入一条带有更改列表详细信息的注释。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2009-11-22T22:06:04.870

它有一个提交消息，它是 != 而不是“错误修复”。该死，我讨厌那些无用的信息吗！

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2011-04-20T14:49:18.697

我使用下面的钩子脚本来确保源代码的行尾和 shell 脚本的权限是正确的（当有人在 Windows 上签入而一切似乎都正常并破坏了 unix 构建时，这是令人沮丧的）。

```
#!/bin/bash

REPOS="$1"
TXN="$2"

# Exit on all errors.
set -e
SVNLOOK=svnlook
echo "`$SVNLOOK changed -t "$TXN" "$REPOS"`" | while read REPOS_PATH
do
  if [[ $REPOS_PATH =~ A[[:blank:]]{3}(.*)\.(sh|c|h|cpp) ]]
  then
    if [ ${#BASH_REMATCH[*]} -ge 2 ]
        then
    FILENAME=${BASH_REMATCH[1]}.${BASH_REMATCH[2]};

    # Make sure shell scripts are executable
    if [[ sh == ${BASH_REMATCH[2]} ]]
    then
        EX_VALUE="true"
            if [ -z "`$SVNLOOK propget -t \"$TXN\" \"$REPOS\" svn:executable \"$FILENAME\" 2> /dev/null`" ]
            then
            ERROR=1;
                echo "svn ps svn:executable $EX_VALUE \"$FILENAME\"" >&2
        fi
        EOL_STYLE="LF"
    else
        EOL_STYLE="native"
    fi

    # Make sure every file has the right svn:eol-style property set
        if [ $EOL_STYLE != "`$SVNLOOK propget -t \"$TXN\" \"$REPOS\" svn:eol-style \"$FILENAME\" 2> /dev/null`" ]
        then
        ERROR=1;
            echo "svn ps svn:eol-style $EOL_STYLE \"$FILENAME\"" >&2
    fi
    fi
  fi
  test -z $ERROR || (echo "Please execute above commands to correct svn property settings." >& 2; exit 1)
done 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2009-11-20T09:16:56.963

一个钩子来编译项目怎么样？例如运行make all。这样可以确保没有人检查无法编译的代码！:)

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2010-11-20T03:49:00.790

我检查大小写冲突（愚蠢的窗口）并且还需要-mergeinfo.pl 以确保客户端至少为 1.5 - 这样 svn:mergeinfo 将始终设置

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-11-21T19:39:16.570

使用 PostUpdate 和 PreCommit 解决 SVN 1.5 中缺少文件外部的问题

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2010-07-16T14:26:17.457

我正在考虑写一个来检查 doctype's on aspx / html 文件，只是为了确保每个人都使用正确的。

此外，您可以使用前（或后）提交挂钩将通知推送到您的 CI 服务器[**，如 Hudson 博客中所述**](http://www.hudson-labs.org/content/subversion-repository-change-notification-push-vs-pull)

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2010-06-22T18:11:52.660

我喜欢检查提交消息中的 [Reviewer: xyz] 注释并拒绝提交的钩子。

# wpf - WPF 数据触发器 根据事件设置对象属性

> ID：884614
> 
> 赞同：4
> 
> 时间：2009-05-19T19:32:00.097
> 
> 标签：wpf, data-binding

使用 WPF 中的 DataTriggers，可以根据您绑定的对象设置控件的属性。例如，您可以根据对象的 IsAlive 属性设置 TextBlock 的背景。

```
<DataTrigger Binding="{Binding Path=IsAlive}" Value="true">
    <Setter Property="Background" Value="Yellow"/>
</DataTrigger> 
```

我想知道它是否可以反过来。是否可以根据绑定到的控件的状态在数据绑定项上设置属性？

假设我想在绑定到的控件接收到鼠标悬停事件时将 IsAlive 属性设置为 true。

这可以在 WPF 和数据触发器中完成吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-19T20:53:38.107

我不知道您要问的是否直接可能，但我怀疑不是。另一方面，我认为您可以通过将对象的“IsAlive”属性直接绑定到控件的“IsMouseOver”依赖属性（Mode=OneWayToSource）来使您的示例场景工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-01-14T03:22:41.510

您可能希望使用[EventSetter ，然后使用发送方的](http://msdn.microsoft.com/en-us/library/system.windows.eventsetter.aspx)[DataContext](http://msdn.microsoft.com/en-us/library/system.windows.frameworkelement.datacontext.aspx)属性或[GetBindingExpression](http://msdn.microsoft.com/en-us/library/system.windows.frameworkelement.getbindingexpression.aspx)通过代码处理设置。
这为您提供了在样式级别设置处理程序的选项。

# .net - 如何轻松判断两个 .NET EntityObjects 集合是否包含任何相同的对象？

> ID：884628
> 
> 赞同：0
> 
> 时间：2009-05-19T19:35:01.980
> 
> 标签：.net, vb.net, entity-framework, generics

页面具有角色。用户有角色。一个用户只能查看一个页面，如果他和它共享一个或多个角色。

这有效：

```
Dim Allow As Boolean = False
CurrentPage.Roles.Load()
For Each r As Role In CurrentPage.Roles
    r.Users.Load()
    For Each u As User In r.Users
        If u.Id = CurrentUser.Id Then
            Allow = True
            Exit For
        End If
    Next
    If Allow Then
        Exit For
    End If
Next 
```

如果我可以使用 LINQ 或 lambda 表达式用更少的代码行来代替，我不想使用嵌套循环。

这总是返回 False：

```
Dim Allow As Boolean = (CurrentPage.Roles.ToList.Intersect(CurrentUser.Roles.ToList).Count > 0) 
```

我认为它失败了，因为角色是实体对象。

我怎样才能让它只比较 Role Id 值来确定相等性？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T05:21:03.523

您要么必须使用 Intersect 方法的第二个参数来提供您自己的自定义 IEqualityComparer，要么您可以试试这个。它看起来有点有趣，但一旦你掌握了它，它就会变得有意义。

```
If CurrentPage.Roles.Any(Function(Role) Role.Users.Any(Function(User) User.Id = CurrentUser.Id)) Then
    'User has role
End If 
```

尽管如果您实际上必须在每次迭代中加载用户，这可能不起作用。如果您从 EntityFramework 加载，我建议您像这样急切地加载它们：

CurrentPage.Roles.Include("用户").Any(...

或者我还创建了自己的 EnsureLoaded() 扩展，它返回如下对象：

```
If CurrentPage.Roles.Any(Function(a) a.Users.EnsureLoaded().Any(Function(b) b.Id = CurrentUser.Id)) Then 
```

但是，如果您在每个页面请求中都访问数据库，那么请确保您检查分析器并确保您只执行一个查询而不是每个角色的一个查询。

# vb.net - 无法在 Visual Studio 2008 中调试 Web 服务项目

> ID：884631
> 
> 赞同：1
> 
> 时间：2009-05-19T19:35:36.220
> 
> 标签：vb.net, visual-studio, web-services, debugging

我被分配了一个使用 VStudio.net 2003 用 VB 编写的 Web 应用程序。我正在尝试在我的 localhost (VStudio 2008) 上配置源代码，以便我可以探索和了解当前的应用程序（在我开始任何真正的更改之前）和我无法为 Web 服务项目进行调试。

症状 1：

```
 "Unable to automatically step into the server. The remote procedure could not be debugged. 
  This usually indicates that debugging has not been enabled on the server.
  See help for more information". 
```

当我尝试 F11 (stepInto) 调用我的实际 Web 方法的代理类时，就会发生这种情况。

症状 2：在我的 .asmx 文件代码中对将被调用的语句预先设置断点不起作用（即调试器根本不会停止）。

描述了这种情况，下面是我的 VStudio 解决方案的配置方式：

**Service1** - 从 VB - WEB - ASP.NET Web 服务应用程序模板创建的项目；此 Service1 项目包含我要调试的主要 .asmx 源代码。此项目的 Web.config 包含编译 defaultLanguage="vb" debug="true"

**ProxyService1** - 从 Windows 创建的单独项目 - [VB] 类库模板；这里 form1.vb 文件被删除；我访问了“添加服务参考”-> 发现（解决方案中的服务），然后在“兼容性”部分中单击“添加 Web 参考”。然后选择上面的Service1，我给它分配一个WSservice1的“web引用名”。这会生成一个 Reference.VB 文件，当我在项目 bin\Debug 文件夹中构建 ProxyService1 类时，会生成一个同名的 .DLL；这个项目有一个 App.Config 文件，编译 defaultLanguage="vb" debug="true"

**Project1** - 带有调用 Web 服务的 .aspx 和 .vb 文件的主 UI 项目；project1 引用了 ProxyService1.DLL；此项目的 Web.config 包含编译 defaultLanguage="vb" debug="true"。我在这个项目中的一个名为 message.vb 的文件中遇到了一个断点，它看起来大致如下：

```
Public Class Message
Dim wsZipeee As New ProxyService1.WSservice1.myService
Dim dsMessage As DataSet
Public Function GetMessageByType(ByVal iMsgType As Integer) As DataSet
    dsMessage = wsZipeee.GetMessageByType(iMsgType) 
```

如果我在上面的 stmt 上右键/转到定义，这是我的 ProxyService1 项目中 Reference.vb 中的代码：

```
 <System.Web.Services.Protocols.SoapDocumentMethodAttribute("http://tempuri.org/ZipeeeWebService/Zipeee/Get Message By Type", RequestElementName:="Get Message By Type", RequestNamespace:="http://tempuri.org/ZipeeeWebService/Zipeee", ResponseElementName:="Get Message By TypeResponse", ResponseNamespace:="http://tempuri.org/ZipeeeWebService/Zipeee", Use:=System.Web.Services.Description.SoapBindingUse.Literal, ParameterStyle:=System.Web.Services.Protocols.SoapParameterStyle.Wrapped)>  _
    Public Function GetMessageByType(ByVal iMsgType As Integer) As <System.Xml.Serialization.XmlElementAttribute("Get Message By TypeResult")> System.Data.DataSet
        Dim results() As Object = Me.Invoke("GetMessageByType", New Object() {iMsgType})
        Return CType(results(0),System.Data.DataSet)
    End Function 
```

为了完整起见，这里是Service1项目的.asmx文件中对应的webmethod：

```
<WebMethod(MessageName:="Get Message By Type")> _
 Public Function GetMessageByType(ByVal iMsgType As Integer) As DataSet
    con = New SqlConnection(sConnZipeee)
    con.Open() 
```

我知道要检查 IIS 中的每个地方，并且在项目属性中我检查了要检查或设置的正确调试设置。我已经调试了像这样设置的其他东西，但我真的坚持我在这个“解决方案”上错过的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-01-11T11:12:54.087

有关信息 - 如果您在这里寻找如何从 VS2008/.NET3.5 应用程序调试 .NET4 Web 服务，您需要在 VS2010 中启动该服务，在服务中设置一个断点，然后从 VS2008 运行您的应用程序为普通的。断点将被击中。

如果不在 VS2010 中运行该服务，您将收到上面 John 描述的错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-19T19:40:36.883

当我调试 web 服务时，我通常在我的项目属性的 Web 部分中选择“不要打开页面。等待来自外部应用程序的请求”选项（[更多信息在这里](https://zaagmans.wordpress.com/2011/01/14/dont-open-a-page-wait-for-a-request-from-an-external-application/)）。我也通常在 2 个 VS 实例中运行该项目，一个用于 Web 服务，一个用于客户端。我可以在 web 服务中设置断点，然后一切都会发生，我可以看到发生了什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-19T19:41:41.793

尝试在运行 aspnet_wp.exe 进程上附加调试器

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-19T19:45:00.493

我通常将要调试的逻辑放在类库中，我可以从控制台应用程序开始进行调试。如果您必须作为服务进行调试，[此链接也将很有用。](http://msdn.microsoft.com/en-us/library/7a50syb3(VS.80).aspx)

# python - 如何在多处理器系统上生成并行子进程？

> ID：884650
> 
> 赞同：46
> 
> 时间：2009-05-19T19:39:42.110
> 
> 标签：python, exec, subprocess, multiprocessing

我有一个 Python 脚本，我想将它用作另一个 Python 脚本的控制器。我有一个有 64 个处理器的服务器，所以想为第二个 Python 脚本生成多达 64 个子进程。子脚本被称为：

```
$ python create_graphs.py --name=NAME 
```

其中 NAME 类似于 XYZ、ABC、NYU 等。

在我的父控制器脚本中，我从列表中检索名称变量：

```
my_list = [ 'XYZ', 'ABC', 'NYU' ] 
```

所以我的问题是，作为孩子产生这些过程的最佳方式是什么？我想一次将子进程的数量限制为 64，因此需要跟踪状态（如果子进程已完成或未完成），以便我可以有效地保持整代运行。

我考虑使用 subprocess 包，但拒绝了它，因为它一次只产生一个孩子。我终于找到了多处理器包，但我承认被整个线程与子进程文档所淹没。

现在，我的脚本`subprocess.call`一次只生成一个孩子，如下所示：

```
#!/path/to/python
import subprocess, multiprocessing, Queue
from multiprocessing import Process

my_list = [ 'XYZ', 'ABC', 'NYU' ]

if __name__ == '__main__':
    processors = multiprocessing.cpu_count()

    for i in range(len(my_list)):
        if( i < processors ):
             cmd = ["python", "/path/to/create_graphs.py", "--name="+ my_list[i]]
             child = subprocess.call( cmd, shell=False ) 
```

我真的希望它一次产生 64 个孩子。在其他 stackoverflow 问题中，我看到人们使用队列，但这似乎会影响性能？

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2009-05-19T20:26:13.217

您正在寻找的是多处理中的[进程池](http://docs.python.org/library/multiprocessing.html#module-multiprocessing.pool)类。

```
import multiprocessing
import subprocess

def work(cmd):
    return subprocess.call(cmd, shell=False)

if __name__ == '__main__':
    count = multiprocessing.cpu_count()
    pool = multiprocessing.Pool(processes=count)
    print pool.map(work, ['ls'] * count) 
```

为了便于理解，这里有一个计算示例。以下将在 N 个进程上划分 10000 个任务，其中 N 是 cpu 计数。请注意，我将 None 作为进程数传递。这将导致 Pool 类使用 cpu_count 作为进程数（[参考](http://docs.python.org/library/multiprocessing.html#multiprocessing.pool.multiprocessing.Pool)）

```
import multiprocessing
import subprocess

def calculate(value):
    return value * 10

if __name__ == '__main__':
    pool = multiprocessing.Pool(None)
    tasks = range(10000)
    results = []
    r = pool.map_async(calculate, tasks, callback=results.append)
    r.wait() # Wait on the results
    print results 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-17T16:16:38.957

这是我根据 Nadia 和 Jim 的评论提出的解决方案。我不确定这是否是最好的方法，但它确实有效。被调用的原始子脚本需要是一个 shell 脚本，因为我需要使用一些 3rd 方应用程序，包括 Matlab。所以我不得不把它从 Python 中取出并用 bash 编码。

```
import sys
import os
import multiprocessing
import subprocess

def work(staname):
    print 'Processing station:',staname
    print 'Parent process:', os.getppid()
    print 'Process id:', os.getpid()
    cmd = [ "/bin/bash" "/path/to/executable/create_graphs.sh","--name=%s" % (staname) ]
    return subprocess.call(cmd, shell=False)

if __name__ == '__main__':

    my_list = [ 'XYZ', 'ABC', 'NYU' ]

    my_list.sort()

    print my_list

    # Get the number of processors available
    num_processes = multiprocessing.cpu_count()

    threads = []

    len_stas = len(my_list)

    print "+++ Number of stations to process: %s" % (len_stas)

    # run until all the threads are done, and there is no data left

    for list_item in my_list:

        # if we aren't using all the processors AND there is still data left to
        # compute, then spawn another thread

        if( len(threads) < num_processes ):

            p = multiprocessing.Process(target=work,args=[list_item])

            p.start()

            print p, p.is_alive()

            threads.append(p)

        else:

            for thread in threads:

                if not thread.is_alive():

                    threads.remove(thread) 
```

这似乎是一个合理的解决方案？我尝试使用 Jim 的 while 循环格式，但我的脚本什么也没返回。我不确定为什么会这样。这是我用 Jim 的“while”循环替换“for”循环运行脚本时的输出：

```
hostname{me}2% controller.py 
['ABC', 'NYU', 'XYZ']
Number of processes: 64
+++ Number of stations to process: 3
hostname{me}3% 
```

当我用“for”循环运行它时，我得到了一些更有意义的东西：

```
hostname{me}6% controller.py 
['ABC', 'NYU', 'XYZ']
Number of processes: 64
+++ Number of stations to process: 3
Processing station: ABC
Parent process: 1056
Process id: 1068
Processing station: NYU
Parent process: 1056
Process id: 1069
Processing station: XYZ
Parent process: 1056
Process id: 1071
hostname{me}7% 
```

所以这行得通，我很高兴。但是，我仍然不明白为什么我不能使用 Jim 的 'while' 样式循环而不是我正在使用的 'for' 循环。感谢所有的帮助 - 我对 @stackoverflow 的知识广度印象深刻。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-19T20:04:01.373

我肯定会使用[多处理](http://docs.python.org/library/multiprocessing.html)而不是使用子进程滚动我自己的解决方案。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-19T20:04:26.350

我认为您不需要队列，除非您打算从应用程序中获取数据（如果您确实需要数据，我认为将其添加到数据库可能更容易）

但试试这个尺寸：

将您的 create_graphs.py 脚本的内容全部放入一个名为“create_graphs”的函数中

```
import threading
from create_graphs import create_graphs

num_processes = 64
my_list = [ 'XYZ', 'ABC', 'NYU' ]

threads = []

# run until all the threads are done, and there is no data left
while threads or my_list:

    # if we aren't using all the processors AND there is still data left to
    # compute, then spawn another thread
    if (len(threads) < num_processes) and my_list:
        t = threading.Thread(target=create_graphs, args=[ my_list.pop() ])
        t.setDaemon(True)
        t.start()
        threads.append(t)

    # in the case that we have the maximum number of threads check if any of them
    # are done. (also do this when we run out of data, until all the threads are done)
    else:
        for thread in threads:
            if not thread.isAlive():
                threads.remove(thread) 
```

我知道这将导致比处理器少 1 个线程，这可能很好，它让处理器来管理线程、磁盘 i/o 以及计算机上发生的其他事情。如果您决定要使用最后一个核心，只需添加一个即可

**编辑**：我想我可能误解了 my_list 的目的。您根本不需要`my_list`跟踪线程（因为它们都被`threads`列表中的项目引用）。但这是提供进程输入的好方法——甚至更好：使用生成器函数；）

## 的目的`my_list`和`threads`

`my_list`保存您需要在函数中处理的数据
`threads`只是当前正在运行的线程的列表

while 循环做了两件事，启动新线程来处理数据，并检查是否有任何线程完成运行。

因此，只要您有（a）更多数据要处理，或者（b）未完成运行的线程......您想要编程以继续运行。**一旦两个列表都为空，它们将评估为`False`并且 while 循环将退出**

# java - rxtx 通讯端口

> ID：884657
> 
> 赞同：1
> 
> 时间：2009-05-19T19:41:37.863
> 
> 标签：java, serial-port, rxtx

我正在使用 rxtx api 通过 com 端口从 GPS 设备读取数据。现在我通过读取配置文件并查找列出的端口来找到正确的 com 端口。我遇到的问题是，如果拔下设备，com 端口可能会改变，那么用户必须知道更改配置文件。我在 c# 中编写了一个与此类似的应用程序，并且能够列出 windows 设备名称而不是 com 端口，并且我循环浏览了 com 端口，直到设备名称与配置文件中的名称匹配。使用该方法，即使正在使用的 com 端口发生更改，配置文件中的任何内容也不必更改。有没有办法用 rxtx api 做到这一点？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T11:52:42.687

如果有人有兴趣...

我在 C# 中创建了一个监视套接字的 Windows 服务。如果客户端连接到该套接字，则服务会收集端口名称和该端口上的设备 ID，并通过 com 端口以字符串形式发送数据，然后客户端可以解析字符串以获取所需的数据。

在我的情况正在传递的字符串是： “ACPI \ PNP0501 * PNP0501，COM1，PCI \ VEN_8086＆DEV_29B7＆SUBSYS_02111028＆REV_02 PCI \ VEN_8086＆DEV_29B7＆SUBSYS_02111028 PCI \ VEN_8086＆DEV_29B7＆CC_070002 PCI \ VEN_8086＆DEV_29B7＆CC_0700，COM3，USB \ Vid_067b＆Pid_2303＆Rev_0400 USB \ Vid_067b＆Pid_2303，COM5”

当我解析它时，我可以看到 ACPI\PNP0501 *PNP0501 是 COM 1 的设备 ID，COM​​3 有三个设备 ID，COM​​5 上有两个设备 ID。

这可能不是处理这个问题的最佳方法，但它足以满足我的需求，并且它使我免于 JNI。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-20T06:31:51.780

[CommPortIdentifier.getPortIdentifiers](http://java.sun.com/products/javacomm/reference/api/javax/comm/CommPortIdentifier.html#getPortIdentifiers())列出了系统中可供 Javacomm API 使用的所有端口。遍历它们以找到您的设备连接到的端口。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-20T15:43:42.143

如果您想在 COM 端口上获取与设备关联的名称（特别是如果安装了驱动程序来提供它），您将不得不使用一些可怕的 Java->Native 接口来与 Windows 对话收集此信息的 API。C# 很好，因为这些信息被收集并提供给您，但在 Java 中，您必须执行此额外步骤。

[Windows 函数发现](http://msdn.microsoft.com/en-us/library/aa363892(VS.85).aspx)可能会证明是有用的。我不确定究竟是什么 API 提供了这个功能。

# asp.net - 如何为 mvc 站点创建谷歌站点地图？

> ID：884660
> 
> 赞同：27
> 
> 时间：2009-05-19T19:42:40.153
> 
> 标签：asp.net, asp.net-mvc, sitemap

我想知道是否有人已经这样做了，或者有任何关于如何为 MVC 网站创建 Google 站点地图的示例。

任何帮助或示例将不胜感激。

我在谈论这个： [https ://www.google.com/webmasters/tools/docs/en/protocol.html](https://www.google.com/webmasters/tools/docs/en/protocol.html)

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-12-15T03:50:21.830

我使用了[Mike Brind 的站点地图代码](http://www.mikesdotnetting.com/Article/111/RSS-Feeds-and-Google-Sitemaps-for-ASP.NET-MVC-with-LINQ-To-XML)，稍作改动。

您需要将 XNamespace 添加到每个 XElement，否则 Google 会吐出假人。

这是我的版本：

```
public ContentResult Index()
        {
            XNamespace ns = "http://www.sitemaps.org/schemas/sitemap/0.9";
            const string url = "http://www.website.com/controller/action/{0}";
            var items = _db.DataAccessHere();
            var sitemap = new XDocument(
                new XDeclaration("1.0", "utf-8", "yes"),
                new XElement(ns + "urlset",
                    from i in items
                    select
                    //Add ns to every element.
                    new XElement(ns + "url", 
                      new XElement(ns + "loc", string.Format(url, i.ItemID)),
                          new XElement(ns + "lastmod", String.Format("{0:yyyy-MM-dd}", i.DateAddedUTC)),
                      new XElement(ns + "changefreq", "monthly"),
                      new XElement(ns + "priority", "0.5")
                      )
                    )
                  );
            return Content(sitemap.ToString(), "text/xml");
        } 
```

感谢 Mike 发布原始文章和代码。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-12-13T21:53:56.793

[无耻的自我插件：在生产中的MvcSiteMapProvider](https://github.com/maartenba/MvcSiteMapProvider)出现奇怪问题后，我创建了一个名为[SimpleMvcSitemap](https://github.com/uhaciogullari/SimpleMvcSitemap)的库。您可以从任何操作方法提供站点地图文件，而无需任何配置：

```
public class SitemapController : Controller
{
    public ActionResult Index()
    {
        List<SitemapNode> nodes = new List<SitemapNode>
        {
            new SitemapNode(Url.Action("Index","Home")),
            new SitemapNode(Url.Action("About","Home")),
            //other nodes
        };

        return new SitemapProvider().CreateSitemap(nodes);
    }
} 
```

它还支持所有可用的[Google Sitemap 扩展](https://support.google.com/webmasters/answer/183668?hl=en&ref_topic=6080646)。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-19T19:49:22.433

最简单的方法是使用许多免费的站点地图构建器中的任何一个——它们会抓取您的站点、跟踪链接并为您生成站点地图 XML 文件。

[这是一个例子](http://www.xml-sitemaps.com/index.php)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-19T19:49:36.677

这是一个[帖子](http://robtennyson.us/post/2008/10/16/Dynamic-sitemaps-with-ASPNET-MVC.aspx)，可能会给你一些想法。基本上，它会根据路线值生成站点地图。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-10-25T05:07:34.863

所以事情就是这样，使用生成器将为您的站点中的“所有内容”创建一个链接。因此，如果您有，比如说一个卡片网站，并且您有大约十万个卡片项目，每个卡片都有自己的链接，那么您可能会看到相同数量的链接。如果你想要这样，那么 xml 站点地图生成器就是你要走的路。

但如果你想让它有点个性化，你可以这样做：

列出您网站的所有主要部分。考虑到大多数 MVC 都使用“干净的 URL”之类的东西，这很容易做到。有点像“site.com/items/phones”

根据您使用的语言创建 XML 文档。

至少，您应该有这样的文档：

```
<?xml version="1.0" encoding="utf-8"?> 
    <urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9"> 
      <url> 
        <loc>http://dragonflysco.com/catalog/finishings/19</loc> 
      </url> 
      <!-- more here -->
    </urlset> 
```

有关更高级的结构，请查看： [http ://www.google.com/support/webmasters/bin/answer.py?answer=183668](http://www.google.com/support/webmasters/bin/answer.py?answer=183668)

# mysql - 使用 ORDER BY 时查询慢

> ID：884661
> 
> 赞同：24
> 
> 时间：2009-05-19T19:43:07.097
> 
> 标签：mysql, sql-order-by

这是查询（最大的表有大约 40,000 行）

```
SELECT
  Course.CourseID,
  Course.Description,
  UserCourse.UserID,
  UserCourse.TimeAllowed,
  UserCourse.CreatedOn,
  UserCourse.PassedOn,
  UserCourse.IssuedOn,
  C.LessonCnt
FROM
  UserCourse
INNER JOIN
  Course
USING(CourseID)
INNER JOIN
(
  SELECT CourseID, COUNT(*) AS LessonCnt FROM CourseSection GROUP BY CourseID
) C
USING(CourseID)
WHERE 
  UserCourse.UserID = 8810 
```

如果我运行它，它会执行得非常快（大约 0.05 秒）。它返回 13 行。

**当我`ORDER BY`在查询末尾添加一个子句（按任何列排序）时，查询大约需要 10 秒。**

我现在在生产中使用这个数据库，一切正常。我所有的其他查询都很快。

关于它可能是什么的任何想法？我在 MySQL 的查询浏览器和命令行中运行了查询。这两个地方都非常缓慢`ORDER BY`。

**编辑：** Tolgahan ALBAYRAK 解决方案有效，但谁能解释它为什么有效？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-19T19:45:50.880

也许这有帮助：

```
SELECT * FROM (    
     SELECT
      Course.CourseID,
      Course.Description,
      UserCourse.UserID,
      UserCourse.TimeAllowed,
      UserCourse.CreatedOn,
      UserCourse.PassedOn,
      UserCourse.IssuedOn,
      C.LessonCnt
    FROM
      UserCourse
    INNER JOIN
      Course
    USING(CourseID)
    INNER JOIN
    (
      SELECT CourseID, COUNT(*) AS LessonCnt FROM CourseSection GROUP BY CourseID
    ) C
    USING(CourseID)
    WHERE 
      UserCourse.UserID = 8810
) ORDER BY CourseID 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-19T19:45:05.377

您按索引排序的列是否已编入索引？

索引大大加快了排序和过滤。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-02-22T10:46:20.160

您正在从“ **UserCourse** ”中进行选择，我假设它是课程和用户之间的连接表（多对多）。您应该在“UserCourse”表中索引您需要排序的列。

假设您要“**按 CourseID 排序**”，那么您需要在*UserCourse*表中对其进行索引。

按连接表中不存在的任何其他列（即 UserCourse）进行排序可能需要*对连接表*进行进一步的非规范化和索引以优化速度；换句话说，您需要在连接表中拥有该列的副本并将其编入索引。

**PS** Tolgahan Albayrak 给出的答案虽然对这个问题是正确的，但在执行“LIMIT x”查询的情况下不会产生预期的结果。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-19T19:47:24.137

您是否更新了数据库中的统计信息？我遇到了类似的问题，我有 2 个相同的查询，唯一的区别是一个大写字母，一个以 1/2 秒的速度返回，另一个花了将近 5 分钟。更新统计信息解决了问题

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-17T12:03:14.293

意识到答案为时已晚，但是我刚刚遇到了类似的问题，通过将查询时间从几秒增加到 5 分钟来添加订单并尝试了大多数其他加快速度的建议，注意到 /tmp 文件的大小为 12G这个查询。更改了查询，使得返回的 varchar(20000) 字段是“trim(”ed 并且性能显着提高（回到秒）。所以我想值得检查一下您是否在查询中返回大型 varchars，如果是，处理它们（也许是 substring(x, 1, length(x))?? 如果你不想修剪它们。查询返回 500k 行，/tmp 文件表明每行使用大约 20k 数据。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-19T19:57:16.363

之前在这里问过一个类似的问题[。](https://stackoverflow.com/questions/714950/mysql-performance-optimization-order-by-datetime-field)

它也可能对您有所帮助。基本上它描述了使用复合索引以及 order by 的工作原理。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-09-29T14:29:01.113

今天我遇到了同样的问题。当我按连接表中的字段对结果集进行排序时，整个查询速度非常慢，耗时超过 100 秒。

该服务器运行的是 MySQL 5.0.51a，我偶然注意到，相同的查询运行速度与它在使用 MySQL 5.1 的服务器上的运行速度一样快。在比较该查询的解释时，我发现索引的使用和处理显然发生了很大变化（至少从 5.0 -> 5.1）。

所以如果你遇到这样的问题，也许你的解决办法就是简单地升级你的 MySQL

# sql-server - 单个脚本如何截断每个数据库中的特定表？

> ID：884663
> 
> 赞同：0
> 
> 时间：2009-05-19T19:43:16.003
> 
> 标签：sql-server, tsql, sql-server-2008

我有一个带有许多数据库的 Microsoft SQL Server 2008，其中大多数都有一个 Logs 表。我希望能够安排一个脚本来运行和截断这些数据库中的每一个（动态）中的日志表。我想我必须获取每个用户数据库的名称，然后在包含 Logs 表的数据库中截断表 Logs。

我最终使用的语句是：

```
EXEC sp_MSForEachDB 'Use [?]; IF  EXISTS (SELECT * FROM sys.tables WHERE name = "Logs" and type="U")TRUNCATE TABLE Logs' 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-19T19:47:30.957

这有点hack，因为存储过程没有记录，但试试这个：

```
EXEC sp_MSForEachDB 'Use ?; TRUNCATE TABLE Logs' 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-05-19T20:01:56.980

在 2008 年，如果它当时没有投入生产使用，那么最容易做的事情就是这样

编写一个在动态 sql 中执行此操作的脚本

```
Alter Database <mydb> set recovery simple
go

Checkpoint
go

Alter Database <mydb> set recovery full
go 
```

# perl - 如何在不硬编码持续时间的情况下暂停 Perl 处理？

> ID：884668
> 
> 赞同：1
> 
> 时间：2009-05-19T19:44:21.150
> 
> 标签：perl, dynamic, duration

我有一个包含此代码片段的 Perl 脚本，它调用系统 shell 通过 SFTP 获取一些文件并使用 WinZip 解压缩它们：

```
#  Run script to get files from remote server
system "exec_SFTP.vbs";

#  Unzip any files that were retrieved
foreach $zipFile (<*.zip>) {
    system "wzunzip $zipFile";
} 
```

即使检索到某些文件，它们也永远不会解压缩，因为在检索文件并关闭 SFTP 连接时，Perl 脚本已经完成了解压缩步骤，结果它找不到任何要解压缩的内容。

我的短期解决办法是插入

```
sleep(60); 
```

在解压缩步骤之前，但假设 SFTP 连接将在 60 秒内完成，这有时可能会被严重高估，有时可能被低估。

在继续解压缩步骤之前，是否有更合理的方法可以让 Perl 暂停，直到 SFTP 连接关闭？

编辑：响应者质疑（并且合理地如此）使用 VB 脚本而不是让 Perl 进行文件传输。它与安全有关——VB 脚本由其他人维护，并被授权执行 SFTP。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-19T19:54:27.230

检查 *.vbs 文件中的代码。该`system`函数在继续执行之前等待子进程完成。看来您的 *.vbs 文件正在分叉一个后台任务来执行 FTP 并立即返回。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-19T20:16:51.677

在一个完美的世界中，您的脚本将被重写以使用[Net::SFTP::Foreign](http://search.cpan.org/perldoc?Net::SFTP::Foreign)和[Archive::Extract](http://search.cpan.org/perldoc?Archive::Extract) ..

一种丑陋的快速破解方法可能是在您的第一次系统调用之前创建一个触摸文件，更改您的 sftp-fetching 脚本以在完成后删除文件并有一段时间像这样

```
while(-e 'touch.file') {
    sleep 5;
}

# foreach [...] 
```

当然，如果您的 .vbs 失败并留下未删除的 touchfile 以及许多其他不良副作用，您需要小心。这将是一个快速解决方案（如果其他建议都不起作用），直到您有时间在没有 system() 调用的情况下进行重写。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-19T19:54:34.733

您需要一种方法让 Perl 等到 SFTP 传输完成，但由于您的脚本当前正在编写，Perl 无法知道这一点。（看起来您至少结合了两种脚本语言和一个（GUI？）SFTP 客户端；这可以工作，但它并不完全可靠或健壮。为什么使用 VBscript 来启动 SFTP 传输？）

我可以想到四个选项：

1.  您的 Perl 脚本可以自己进行 SFTP 传输，使用 CPAN 的[Net::SFTP](http://search.cpan.org/~dbrobins/Net-SFTP-0.10/)模块之类的东西，而不是生成无法跟踪其状态的外部作业。
2.  您的 Perl 脚本可能会生成一个命令行 SFTP 实用程序（如[PSFTP](http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html)），该实用程序在传输完成之前不会返回。
3.  或者将 exec_SFTP.vbs 脚本更改为在传输完成之前不返回。
4.  如果您当前使用的是图形 SFTP 客户端并且由于某种原因无法切换，我建议您使用[AutoIt](http://www.autoitscript.com/autoit3/)之类的脚本语言而不是 Perl。AutoIt 具有等待窗口更改状态等功能，因此它可以更轻松地监控活动的完成情况。

选项 1 或 2 将是最稳健和最可靠的。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-19T19:56:29.143

我可以建议的最好的方法是修改 exec_SFTP.vbs 以仅在文件传输完成后退出。 `system` 等待它调用的程序完成，这样应该可以解决您的问题：

```
       系统列表
       系统程序列表
               与“exec LIST”完全相同，除了
               先做一个分叉，然后是父进程
               等待子进程完成。

```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-19T21:27:55.933

如果您无法修改 vbs 脚本以使其在终止之前保持活动状态，则您可以跟踪子进程的创建。如果您获得子进程 ID，则可以监视它们，从而知道 vbs 的各种后代何时终止。

[Win32::Process::Info](http://search.cpan.org/dist/Win32-Process-Info/lib/Win32/Process/Info.pm)允许您从正在运行的进程中获取子进程 ID。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-19T20:03:12.937

也许这是一个愚蠢的问题，但为什么不直接使用[Net::SFTP](http://search.cpan.org/~drolsky/Net-SFTP-0.08/lib/Net/SFTP.pm)和[Archive::Extract](http://perldoc.perl.org/Archive/Extract.html) Perl 模块来下载和解压缩文件呢？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-19T19:52:05.080

看看[IPC::Open3](http://search.cpan.org/~rjbs/perl-5.16.1/ext/IPC-Open3/lib/IPC/Open3.pm)

> IPC::Open3 - 使用 open3() 打开一个用于读取、写入和错误处理的进程

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-19T20:00:10.273

[`system`](http://perldoc.perl.org/functions/system.html)在运行命令的 shell 返回之前不会返回；这对于启动图形程序和文件关联可能是错误的。

看看有没有以下帮助？

```
system('cscript exec_SFTP.vbs');

use Win32::Process;
use Win32;
Win32::Process::Create(my $proc, 'wscript.exe',
        'wscript exec_SFTP.vbs', 0, NORMAL_PRIORITY_CLASS, '.');
$proc->Wait(INFINITE); 
```

# sql-server - Sql Server 2005 错误中的索引视图

> ID：884680
> 
> 赞同：3
> 
> 时间：2009-05-19T19:46:17.807
> 
> 标签：sql-server, sql-server-2005, indexed-view

我尝试在 Sql Server 2005 中的视图上添加索引，但出现此错误：“无法在视图 'AllAssignmentNotes' 上创建索引，因为视图未绑定架构。”

我不想在这里放太多信息，因为它可能会超载。只是想知道是否有人可以给我一些帮助。

我去了错误给我的网址，却一无所获。完整的错误如下。

我知道你不能给出一个真正的答案，因为我没有给你所有的信息，我很抱歉。

```
标题：Microsoft SQL Server 管理工作室
------------------------------

索引“IX_AssignmentId”的创建失败。(Microsoft.SqlServer.Smo)

如需帮助，请单击：http://go.microsoft.com/fwlink?ProdName=Microsoft+SQL+Server&ProdVer=9.00.4035.00&EvtSrc=Microsoft.SqlServer.Management.Smo.ExceptionTemplates.FailedOperationExceptionText&EvtID=Create+Index&LinkId=20476

------------------------------
附加信息：

执行 Transact-SQL 语句或批处理时发生异常。(Microsoft.SqlServer.ConnectionInfo)

------------------------------

无法在视图“AllAssignmentNotes”上创建索引，因为该视图未绑定架构。（Microsoft SQL Server，错误：1939）

如需帮助，请单击：http://go.microsoft.com/fwlink?ProdName=Microsoft+SQL+Server&ProdVer=09.00.4035&EvtSrc=MSSQLServer&EvtID=1939&LinkId=20476

------------------------------
纽扣：

好的
------------------------------

```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-19T19:48:49.003

正如错误所说，您不能在未绑定架构的视图上拥有索引。要架构绑定视图，请使用

```
create view with schemabinding. 
```

在视图中引用的所有表都必须完全符合模式名，即 dbo.table，而不仅仅是表

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-19T19:50:51.837

假设您使用 SCHEMABINDING 创建了视图，那么在执行 CREATE INDEX 语句时，这些 SET 选项必须设置为 ON 的连接设置：

```
ANSI_NULLS 
ANSI_PADDING 
ANSI_WARNINGS 
ARITHABORT 
CONCAT_NULL_YIELDS_NULL 
QUOTED_IDENTIFIERS 
```

NUMERIC_ROUNDABORT 选项必须设置为 OFF。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-19T21:40:12.833

自从引入索引视图以来，处理索引视图是主要的痛苦。实际制作支持索引的视图的规则非常严格，并且错误消息是无用的。

您应该检查 BOL [http://msdn.microsoft.com/en-us/library/ms191432(sql.90).aspx](http://msdn.microsoft.com/en-us/library/ms191432(sql.90).aspx)

# c# - 要返回双精度，即使在 c# 中类型是双精度，我是否必须强制转换为双精度？

> ID：884686
> 
> 赞同：7
> 
> 时间：2009-05-19T19:48:18.740
> 
> 标签：c#, casting

要返回双精度，即使类型是双精度，我是否必须强制转换为双精度？

例如

```
double a = 32.34;
double b = 234.24;

double result = a - b + 1/12 + 3/12; 
```

我必须施放 (double) 吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-19T19:51:31.197

不，你没有。但是，您的表情几乎肯定不会按照您的意愿行事。

表达式 1/12 和 3/12 将使用*整数*算术执行。

你可能想要：

```
double result = a - b + 1/12d + 3/12d; 
```

或者

```
double result = a - b + 1/(double) 12 + 3/(double) 12; 
```

这两者都将强制使用浮点运算执行除法。

这里的问题是，如果算术运算符的两个操作数都是整数，则使用整数算术执行操作，*即使它是类型为 的更大表达式的一部分`double`*。在这里，您的表达实际上是：

```
double result = a - b + (1 / 12) + (3 / 12); 
```

加法和减法是可以的，因为`a`和`b`强制它们的类型使用浮点运算来执行 - 但是因为除法比加法和减法“绑定更紧密”（即就像使用上面的括号一样）只考虑直接操作数。

那有意义吗？

编辑：由于它如此受欢迎，因此在此处也包含 devinb 的评论是有意义的：

```
double result = a - b + 1.0/12.0 + 3.0/12.0; 
```

就编译器而言，这都是一样的——你只需要决定哪个对你来说更清楚：

```
(double) 1
1.0
1d 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-19T19:49:41.467

不，不需要铸造。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-19T19:56:17.927

嗯 - 我为整数除法问题所做的方法是执行以下操作：

```
double result = a - b + 1/12.0 + 3/12.0 
```

但除此之外，不需要铸造。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-19T19:56:33.387

当然，有一种不用强制转换的干净方法：

```
double result = a - b + 1.0/12 + 3.0/12; 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-19T20:00:26.967

这实际上取决于您对铸造的要求。这里有两种不同的情况：

```
double a = 32.34;
double b = 234.24;
double result1 = a - b + 1/12 + 3/12;
double result2 = a - b + (double)1/12 + (double)3/12;
Console.WriteLine(result1);  // Result: -201.9
Console.WriteLine(result2);  // Result: -201.566666666667 
```

无论哪种方式，您都不会抱怨将值分配给结果，但在第一种情况下，最后的除法是使用解析为 0 的整数完成的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-19T19:51:39.590

你不应该需要，尽管很难从你的问题中看出演员在哪里。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-19T19:51:44.457

在进行数学运算时，C# 将返回结果作为具有较大类型的任何参数的类型。

我记得，顺序是这样的（从大到小）：

1.  十进制
2.  双倍的
3.  漂浮
4.  长/int64
5.  整数/整数32
6.  短/int16
7.  字节

当然，这是跳过其中每个的未签名版本。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-19T19:51:47.297

通常不需要强制转换，但在您的示例中，`1/12`and`3/12`是整数除法，每个表达式都为 0。您需要将分子或分母之一转换为`double`.

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-19T19:54:50.893

转换用于指示何时要将一种数据类型更改为另一种类型。这是因为更改`type`通常会导致数据丢失。

例如

```
double a = 8.49374;

//casting is needed because the datatypes are different.
// a_int will end up with the value is 8, because the precision is lost.
int a_int = (int) a; 

double b = (double) a_int; 
```

在该示例中，'b' 最终的值将是“8.00000...”，这是因为 a_int 不包含任何十进制信息，因此 b 只有与整数相关的信息可供使用。

# javascript - 使用 Ordnance Survey/Openlayers api 拖动标记

> ID：884692
> 
> 赞同：2
> 
> 时间：2009-05-19T19:49:36.473
> 
> 标签：javascript, mapping, openlayers

我使用基于 OpenLayers 的 Ordnance Survey（我认为这称为 OpenSpace）生成的 api创建了一个站点[链接文本。](http://www.chrisgrimble.com/OSMapApi/index.php?easting=560500&northing=193500)我已经有了它，因此您可以单击地图以添加标记，然后我希望能够单击标记并将其拖到地图上。是否有使用 OpenSpace 或 OpenLayers api 的简单方法来执行此操作。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-07-23T15:49:58.053

OpenLayers api 允许您向地图添加标记和特征。如果您添加功能而不是标记，则可以通过添加以下代码使它们可拖动。

```
var vectorLayer = new OpenLayers.Layer.Vector("Vector Layer");
var osMap = new OpenSpace.Map('map');
osMap.addLayer(vectorLayer);

var modifyFeaturesControl = new OpenLayers.Control.ModifyFeature(vectorLayer);
modifyFeaturesControl.mode = OpenLayers.Control.ModifyFeature.RESHAPE;
osMap.addControl(modifyFeaturesControl);
modifyFeaturesControl.activate(); 
```

这将允许您在地图周围拖动要素。如果您想在拖动功能时添加自定义行为，您可以在 vectorLayer 上注册侦听器。例如，要在修改功能（即拖动和释放）时注册监听器，您需要使用以下代码。

```
vectorLayer.events.register('featuremodified', vectorLayer, function(feature) {
   //custom behavior
}); 
```

有关可以收听的事件的完整列表，请参阅 OpenLayers api doc [OpenLayers api doc](http://dev.openlayers.org/releases/OpenLayers-2.8/doc/apidocs/files/OpenLayers/Layer/Vector-js.html#OpenLayers.Layer.Vector.OpenLayers.Layer.Vector)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-08-26T17:35:33.330

更简单的方法是使用 openlayer 拖动控件，它将矢量图层作为目标。

假设一个包含图标的矢量图层（这比标记更可取，OL 的开发人员不鼓励使用），称为矢量，您可以简单地执行以下操作：

```
var drag=new OpenLayers.Control.DragFeature(vectors);

map.addControl(drag);
drag.activate(); 
```

使用拖动控件的另一个优点是您可以挂钩各种回调，这些回调返回特征和像素位置，例如 onStart 和 onDrag。例如，

```
var drag=new OpenLayers.Control.DragFeature(vectors,{    
     'onDrag':function(feature, pixel){
           console.log(pixel.x);//this can be used to do something else, such as move another feature
     }
}); 
```

有关详细信息，请参阅[http://trac.osgeo.org/openlayers/browser/trunk/openlayers/lib/OpenLayers/Control/DragFeature.js 。](http://trac.osgeo.org/openlayers/browser/trunk/openlayers/lib/OpenLayers/Control/DragFeature.js)

# iphone - UIImageView 子类复制图像

> ID：884714
> 
> 赞同：1
> 
> 时间：2009-05-19T19:54:04.937
> 
> 标签：iphone, cocoa-touch, uikit, uiimageview

我正在研究 UIImageView 的一个子类，我需要的一件事是当使用 initWithImage: 消息初始化对象时，会创建一个“副本”。

我一定是在混淆某些东西，因为我看不到这里有什么不工作..

```
- (id)initWithImage:(UIImage *)image {
[image retain];
if (self = [super initWithImage:image]) {

    if (!maskImage) {
        maskImage = [UIImage imageWithCGImage:[image CGImage]];
        if (maskImage != nil) {
            NSLog(@"Made mask image");
        } else {
            NSLog(@"Failed");
        }
        //maskImage = [UIImage imageNamed:@"image.png"];
    }
}

[image release];
return self;
} 
```

当我构建它时没有错误，并且似乎确实创建了 maskimage（我没有收到失败消息）。但是，如果我取消注释从 png 分配的行，它就可以工作。

我错过了什么？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-13T09:31:11.960

您应该保留创建的图像，例如：

```
- (id)initWithImage:(UIImage *)image {
    if (self = [super initWithImage:image]) {
        if (!maskImage) {
                maskImage = [[UIImage imageWithCGImage:[image CGImage]] retain];
                if (maskImage != nil) {                
                        NSLog(@"Made mask image");
                } else {
                        NSLog(@"Failed");
                }
        }
    }
    return self;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-19T22:53:49.347

首先，您应该将 maskImage 设置为 nil，以确保它不是垃圾：

```
self.maskImage=nil; 
```

这可能会搞砸你的线路（如果不是现在，那么以后）：

```
if(!imaskImage) 
```

然后，要进行复制，只需在 UIImage 子类中实现 NSCopying。这很容易做到。然后你可以输入：

```
maskImage = [image copy]; 
```

或者，您可以将图像转换为数据，存档，然后取消存档，然后再转换回 UIImage。这为您提供了图像的完整副本。它有点复杂，但它与用于制作对象图的深层副本的方法相同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-19T21:26:19.883

尝试这个。应该管用。

```
- (id)initWithImage:(NSString *)image {
if (self = [super initWithImage:image]) {

        if (!maskImage) {
                img = [UIImage imageNamed:image];
                maskImage = CGImageRetain(img.CGImage);
                if (maskImage != nil) {
                        NSLog(@"Made mask image");
                } else {
                        NSLog(@"Failed");
                }
        }
}

return self;
} 
```

1.  变化
    *   传递 NSString 而不是图像
    *   无需保留/释放图像
    *   需要在.h中定义img、maskImage
    *   .h 中的 maskImage 应该在 @property 中设置保留属性（例如 @property (nonatomic, retain)）

# asp.net - 404 重定向到 Sitecore 页面允许无扩展 URL

> ID：884718
> 
> 赞同：1
> 
> 时间：2009-05-19T19:54:59.287
> 
> 标签：asp.net, iis, redirect, http-status-code-404, sitecore

我使用 Sitecore 作为 CMS 解决方案。最近，我们决定为我们的网站添加重定向功能以解决错误。在 Sitecore 中，我创建了两个内容页面，一个用于处理服务器错误，另一个用于处理 404 错误。我用基本的子布局实现了服务器错误，没有任何代码。另一方面，404 页面有一个子布局，允许显示导致 404 错误的键入链接。然后我继续将这些页面添加到 web.config 文件中（我编辑了 customErrors 设置以重定向到服务器错误页面和 404 错误以重定向到 404 错误页面。我还替换了 NoItems 设置以指向我的 404 错误页。

此外，我更改了 HTTP 错误 404 以指向我在 IIS (5.1) 中的新 404 错误页面。瞧，我的改变奏效了；我能够将许多错误重定向到这些新页面。但是，我发现，通过强制 IIS 重定向到我的 aspx 页面来解决 404 错误，我的网站现在具有无扩展 URL 重定向功能。（以前如果我输入[http://mywebsite/foo](http://mywebsite/foo)，我会得到一个 404 错误。现在完成所有这些之后，它会让我进入 foo.aspx 页面）

1.  谁能解释这种行为？任何合理的解释都会让我晚上睡觉。

2.  我应该继续使用它作为无扩展 URL 重定向的临时解决方案吗？这个解决方案可能有什么问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-20T20:10:50.873

在 linkManager 部分的 web.config 中查找此内容：

```
addAspxExtension 
```

设置为真的吗？如果是这样，那么这是您必须更改的站点核心设置。

# php - 使用 OpenID 证明 Stackoverflow 成员资格

> ID：884721
> 
> 赞同：7
> 
> 时间：2009-05-19T19:55:59.533
> 
> 标签：php, facebook, openid, stackexchange-api

这是交易：
- [Flair](https://stackoverflow.com/users/flair)非常需要 Facebook 应用程序
- 我正在努力学习 Facebook 平台

因此，我编写了一个小巧的 Facebook 应用程序，将您的 Flair 嵌入到您个人资料侧面的一个框中。 [如果您有兴趣并在 Facebook 上](http://apps.facebook.com/stackoverflow_badge/)；请注意，这是一项正在进行中的工作，容易发生变化并且有很多粗糙的边缘。

但是，我没有一种优雅的方式可以从这个极简的应用程序中说“这是我的 Stackoverflow 配置文件”。我目前的解决方案最好地展示了[这个形象](http://www.sidrichardson.net/fb_so/img/example_8.PNG)。坦率地说，这是愚蠢的。并且没有什么可以防止冒充。

没有使用 OpenID 的经验，我想知道是否有某种方式（请提供一些这种方式的示例）让用户将他们的 Stackoverflow 身份提供给第三方？

* * *

行为改变为诺多林的回答所建议的。
在 UserVoice 上请求以更明智的方式执行此操作被[拒绝](http://stackoverflow.uservoice.com/pages/1722-general/suggestions/195233-provide-a-way-to-prove-membership-to-a-3rd-party)。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-19T20:19:58.863

没有办法从 OpenID 获取 StackOverflow ID，相反的做法是可能的，但不必要地复杂（与您建议的方法相比）。在我看来，复制和粘贴用户 ID/个人资料 URL 并不是很不方便。

但是，我可以建议某种解决模拟问题的方法。这可能看起来有点愚蠢，但这是我认为确保*只有用户自己*可以显示徽章的最简单方法。再说一次，我不认为这太不方便了。（鉴于电子邮件不公开，因此无法使用更传统的电子邮件确认方法。）

1.  让您的 Facebook 应用程序生成一个随机（字母数字？）代码。表格中的某些内容`A8IO45QW6T`应该做。
2.  将此代码在 Facebook 应用程序的服务器端保存一小段时间（例如 5 分钟）。
3.  通过将给定的代码添加到最后一行，指示用户编辑他们的*About Me*信息，然后返回 Facebook 并确认。对指定用户的个人资料页面的 HTML 的简单检查将验证所有权。然后，用户可以从他们的*About Me*文本中删除验证码。

顺便说一句，创建这个 Facebook 应用程序是个好主意。我可以试试看！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-20T18:43:08.880

另一个允许即时验证的解决方案是散列电子邮件地址并检查它是否与用户的 Gravatar 匹配。当然，并非每个用户都提供了电子邮件地址，但您始终可以先执行此检查，如果失败，您可以退回到“关于我”部分编辑（或仅要求用户有电子邮件地址）。这个想法不是我的，所以我让[null 解释一下](https://stackoverflow.com/questions/61553/track-your-reputation/424410#424410)：

> 你还有可用的源吗？因为我已经找到了一个解决方案来防止其他用户弄乱你的结果。您只需对查看者使用的电子邮件地址进行哈希处理，并检查页面上的 gravatar 图像链接，如[gravatar 网站上所述](http://en.gravatar.com/site/implement/url)。如果用户 id 和图像哈希匹配，则将更改记录到数据库中，否则...仅显示结果。我可以做出改变，但来源似乎丢失了...... :(

# ms-access - 在 Access 2007 中使用 VBA 更新表单记录集

> ID：884723
> 
> 赞同：2
> 
> 时间：2009-05-19T19:56:28.003
> 
> 标签：ms-access, vba, ms-access-2007

我正在做一些访问开发，我遇到了一个问题，我需要确保在按钮 OnClick 处理程序中更新表单。

我在想它可能会像这样工作：

```
if me.dirty then
    me.update     'This is a nonexistent form method'
end if
<rest of handler> 
```

如果存在这样的事情，我是否必须手动调用 OnUpdate 事件处理程序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-19T20:31:43.767

怎么样：

```
if me.dirty then
    me.dirty=false 
end if 
```

MVP Allen Browne 的代码：

[http://allenbrowne.com/bug-01.html](http://allenbrowne.com/bug-01.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-20T02:11:20.400

我会避免使用 .RunCommand 版本，因为在某些情况下 Me.Dirty = False 会起作用并且会阻止访问菜单命令。

另一方面，我一直觉得 Me.Dirty 是一个应该是只读的属性，但事实并非如此。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-19T20:37:55.783

我总是在我的 Save_Click 处理程序中使用此代码

```
If Me.Dirty Then    
  DoCmd.RunCommand acCmdSaveRecord   
End If 
```

# c# - 在 C# 中枚举集合的子集？

> ID：884732
> 
> 赞同：13
> 
> 时间：2009-05-19T20:00:00.837
> 
> 标签：c#, collections, .net-2.0, enumeration, subset

有没有一种好方法可以仅枚举 C# 中 Collection 的一个子集？也就是说，我有一个包含大量对象（例如 1000 个）的集合，但我只想枚举 250 - 340 个元素。有没有一种好方法可以为集合的子集获取枚举器，而无需使用另一个集合？

编辑：应该提到这是使用 .NET Framework 2.0。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-05-19T20:01:36.543

尝试以下

```
var col = GetTheCollection();
var subset = col.Skip(250).Take(90); 
```

或更一般地说

```
public static IEnumerable<T> GetRange(this IEnumerable<T> source, int start, int end) {
  // Error checking removed
  return source.Skip(start).Take(end - start);
} 
```

**编辑**2.0 解决方案

```
public static IEnumerable<T> GetRange<T>(IEnumerable<T> source, int start, int end ) {
  using ( var e = source.GetEnumerator() ){ 
    var i = 0;
    while ( i < start && e.MoveNext() ) { i++; }
    while ( i < end && e.MoveNext() ) { 
      yield return e.Current;
      i++;
    }
  }      
}

IEnumerable<Foo> col = GetTheCollection();
IEnumerable<Foo> range = GetRange(col, 250, 340); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-19T20:08:10.180

我喜欢保持简单（如果您不一定需要枚举器）：

```
for (int i = 249; i < Math.Min(340, list.Count); i++)
{
    // do something with list[i]
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-19T20:11:21.703

为 .Net 2.0 改编 Jared 的原始代码：

```
IEnumerable<T> GetRange(IEnumerable<T> source, int start, int end)
{
    int i = 0;
    foreach (T item in source)
    {
        i++;
        if (i>end) yield break;
        if (i>start) yield return item;
    }
} 
```

并使用它：

```
 foreach (T item in GetRange(MyCollection, 250, 340))
 {
     // do something
 } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-07-15T11:41:48.900

再次调整 Jarad 的代码，这种扩展方法将为您提供一个由*item*定义的子集，而不是 index。

```
 //! Get subset of collection between \a start and \a end, inclusive
    //! Usage
    //! \code
    //! using ExtensionMethods;
    //! ...
    //! var subset = MyList.GetRange(firstItem, secondItem);
    //! \endcode
class ExtensionMethods
{
    public static IEnumerable<T> GetRange<T>(this IEnumerable<T> source, T start, T end)
    {
#if DEBUG
        if (source.ToList().IndexOf(start) > source.ToList().IndexOf(end))
            throw new ArgumentException("Start must be earlier in the enumerable than end, or both must be the same");
#endif
        yield return start;

        if (start.Equals(end))
            yield break;                                                    //start == end, so we are finished here

        using (var e = source.GetEnumerator())
        { 
            while (e.MoveNext() && !e.Current.Equals(start));               //skip until start                
            while (!e.Current.Equals(end) && e.MoveNext())                  //return items between start and end
                yield return e.Current;
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-19T20:02:49.257

你也许可以用 Linq 做点什么。我这样做的方法是将对象放入一个数组中，然后我可以根据数组 id 选择要处理的项目。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-19T20:05:17.317

如果您发现您需要对列表和集合进行大量切片和切块，则可能值得将学习曲线爬上[C5 通用集合库](http://www.itu.dk/research/c5/)。

# parsing - 为地理编码目的解释文本输入的最佳方法是什么？

> ID：884736
> 
> 赞同：3
> 
> 时间：2009-05-19T20:00:26.577
> 
> 标签：parsing, full-text-search

考虑以下站点：

[http://maps.google.com](http://maps.google.com)

它有一个主要的文本输入，用户可以在其中输入企业、国家、省、城市、地址和邮政编码。我想知道哪种是实现这样的搜索的最佳方式。我意识到谷歌地图可能在同一个表中使用了各种数据的全文搜索，并且它有可能拥有一个对输入进行分类的解析器（即在数字之间，如邮政编码和坐标，以及文本，如业务和地址）。

随着数据分布在许多表和系统中，解析器是必不可少的。解析器可以使用正则表达式构建，也可以使用人工神经网络和遗传算法等 IA 工具构建。

您会推荐哪种方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-23T23:09:16.730

最好将所有表中的数据聚合到搜索索引中。Lucene 是一个免费的搜索引擎，类似于 Google 的搜索引擎的工作方式（倒排索引），它应该允许您通过这些值中的任何一个或它们的任何组合相对轻松地进行搜索。

[http://lucene.apache.org/java/docs/](http://lucene.apache.org/java/docs/)

Lucene 带有自己的查询语言（同样，非常类似于 Google 或任何其他 Internet 搜索站点的语法）。使用像 Lucene 这样的东西的唯一缺点是你需要建立它的索引。您不会直接查询数据库（这可能会变得非常复杂......倒排索引几乎是为您尝试做的事情而设计的），因此您需要定期从数据库中收集新信息并将其添加到您的索引中. 可能还需要重建索引以删除不需要的数据。

使用 Lucene，您可以获得大多数人都熟悉的非常灵活的查询语法（因为几乎每个人都在搜索互联网），它的性能非常好，而且不是很复杂。通过使用 Lucene，您可以避免使用正则表达式（这不是最高效的文本搜索机制），并且您不必编写自己的解析器。应该是双赢的，除了一点点学习曲线来构建一个 Lucene 索引生成器并弄清楚如何查询该索引。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-20T12:56:36.273

我会将数据保存在一个数据库中。如果数据变大或者我知道它会很大，我会为每个企业、地址等分配一个 ID，然后让其他表引用这些数据。

只有当用户可以定义他们想要搜索的内容时，才需要正则表达式：

> 业务：阿尔戈斯

但是如果他们想要曼彻斯特的 Argos 会发生什么（对不起，我是英国人），然后可能会根据他们的 IP 获取用户的位置，**但是**如果他们说：

> 业务：苏格兰阿尔戈斯

现在不知道公司有没有两个字，或者旁边有没有位置。所有这些都必须考虑在内。

Ps 对不起，如果这没有意义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-25T13:02:30.297

在对其进行全文搜索之前，您需要对查询进行预处理。如果您使用的是 GIS 数据库，那么您将已经有了城市、区号、国家等列。将您的查询转换为以空格或逗号分隔的标记，或两者兼而有之。然后点击各个列以查看匹配。这样您就可以知道查询的哪一部分是城市、区号等。

您也可以尝试一些简单的近似方法，例如 - 6 个连续数字可能是一个区号。寻找常见的词，如 "road" 、 "restaurant" 、 "street" 等，这些词将成为许多查询的一部分，然后使用一些近似值来找出他们在寻找什么。希望这可以帮助。

# ruby - xslt 2.0 和 OS X 上的 Ruby

> ID：884754
> 
> 赞同：3
> 
> 时间：2009-05-19T20:04:41.107
> 
> 标签：ruby, macos, xslt-2.0, xslt

我正在尝试针对 XSLT 2.0 工作表解析 XML 文档。但是，有人告诉我 OSX 10.5.x 上的库仅支持 XSLT 1.0 操作。当我查看 xsltproc 时，我得到了这个：

hmasing$ xsltproc --version 使用 libxml 20616、libxslt 10112 和 libexslt 810 xsltproc 针对 libxml 20616、libxslt 10112 和 libexslt 810 编译 libxslt 10112 针对 libxml 20616 编译 libexslt 810 针对 libxml 20616 编译

有没有人有关于安装 XSLT 2.0 的简明指南、用于处理这些库的 ruby​​ xslt gems，以及一些可以通过我的方式的好方法？请假设我在任何说明中都是个白痴。任何帮助是极大的赞赏！

*   汉斯

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-07-17T15:54:09.207

遗憾的是，Saxon 是镇上唯一一款免费实现 XSLT 2.0 的游戏。Saxon 本身很出色，但它只是 Java 或 .NET，这意味着。

从命令行或通过系统调用调用它每次都会产生 JVM 启动成本，因此您可能不想这样做。

你可以尝试一些事情：

1) 你确定你需要 XSLT 2.0 吗？除非您使用的功能不在 1.0 中，否则您的 XSLT 可能与 1.0 兼容。然后你可以使用 xsltproc。如果您需要的是 EXSLT，xsltproc 对此有一些支持。

2）如果你肯定需要 2.0，那么你会想要为撒克逊创建某种包装器。很大程度上取决于你想在什么环境中使用它，所以这可能是一个 Web 服务或类似的东西。对于我从事的一个项目，我们使用了一个封装了 saxon 的小型 TCP 侦听器程序。你可以在这里看到它：http: [//idp.atlantides.org/svn/idp/idp.contenttool/trunk/epiduke_saxon/](http://idp.atlantides.org/svn/idp/idp.contenttool/trunk/epiduke_saxon/) 它适用于命令行批量转换，而且速度非常快。

# c# - 如何替换 C# 中的特定单词？

> ID：884759
> 
> 赞同：6
> 
> 时间：2009-05-19T20:06:34.317
> 
> 标签：c#, regex, string, replace

考虑以下示例。

```
string s = "The man is old. Them is not bad."; 
```

如果我使用

```
s = s.Replace("The", "@@"); 
```

然后它返回`"@@ man is old. @@m is not bad."`
但我希望输出为`"@@ man is old. Them is not bad."`

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-05-19T20:16:04.690

这是您如何使用正则表达式，它可以处理任何单词边界：

```
Regex r = new Regex(@"\bThe\b");
s = r.Replace(s, "@@"); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-19T21:42:17.247

我在上面发表了评论，询问为什么将标题更改为假设要使用正则表达式。

我个人尽量不使用正则表达式，因为它很慢。正则表达式非常适合复杂的字符串模式，但如果字符串替换很简单并且您需要一些性能，我会尝试找到一种不使用正则表达式的方法。

拼凑了一个测试。使用正则表达式和字符串方法运行一百万次替换。

正则表达式需要**26.5 秒**才能完成，字符串方法需要**8 秒**才能完成。

```
 //Using Regex. 
        Regex r = new Regex(@"\b[Tt]he\b");

        System.Diagnostics.Stopwatch stp = System.Diagnostics.Stopwatch.StartNew();

        for (int i = 0; i < 1000000; i++)
        {
            string str = "The man is old. The is the Good. Them is the bad.";
            str = r.Replace(str, "@@");
        }

        stp.Stop();
        Console.WriteLine(stp.Elapsed);

        //Using String Methods.
        stp = System.Diagnostics.Stopwatch.StartNew();

        for (int i = 0; i < 1000000; i++)
        {
            string str = "The man is old. The is the Good. Them is the bad.";

            //Remove the The if the stirng starts with The.
            if (str.StartsWith("The "))
            {
                str = str.Remove(0, "The ".Length);
                str = str.Insert(0, "@@ ");
            }

            //Remove references The and the.  We can probably 
            //assume a sentence will not end in the.
            str = str.Replace(" The ", " @@ ");
            str = str.Replace(" the ", " @@ ");
        }

        stp.Stop();
        Console.WriteLine(stp.Elapsed); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-19T20:08:37.853

s = s.Replace("","@@");

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-06-03T12:16:35.840

C# 控制台应用程序

```
static void Main(string[] args)

        {
            Console.Write("Please input your comment: ");
            string str = Console.ReadLine();
            string[] str2 = str.Split(' ');
            replaceStringWithString(str2);
            Console.ReadLine();
        }
        public static void replaceStringWithString(string[] word)
        {
            string[] strArry1 = new string[] { "good", "bad", "hate" };
            string[] strArry2 = new string[] { "g**d", "b*d", "h**e" };
            for (int j = 0; j < strArry1.Count(); j++)
            {
                for (int i = 0; i < word.Count(); i++)
                {
                    if (word[i] == strArry1[j])
                    {
                        word[i] = strArry2[j];
                    }
                    Console.Write(word[i] + " ");
                }
            }
        } 
```

# java - 设置 ehcache 复制 - 我需要哪些多播设置？

> ID：884760
> 
> 赞同：10
> 
> 时间：2009-05-19T20:06:35.503
> 
> 标签：java, ehcache, multicast

我正在尝试设置 ehcache 复制，如此处所述：http: [//ehcache.sourceforge.net/EhcacheUserGuide.html#id.s22.2](http://ehcache.sourceforge.net/EhcacheUserGuide.html#id.s22.2)
这是在 Windows 机器上，但最终将在生产中的 Solaris 上运行。

说明说要设置提供程序如下：

```
 <cacheManagerPeerProviderFactory
     class="net.sf.ehcache.distribution.RMICacheManagerPeerProviderFactory"
     properties="peerDiscovery=automatic, multicastGroupAddress=230.0.0.1,
     multicastGroupPort=4446, timeToLive=32"/> 
```

像这样的听众：

```
<cacheManagerPeerListenerFactory
    class="net.sf.ehcache.distribution.RMICacheManagerPeerListenerFactory"
    properties="hostName=localhost, port=40001,
    socketTimeoutMillis=2000"/> 
```

我的问题是：
多播 IP 地址和端口是任意的（我知道地址必须在特定范围内，但它们必须是特定数字）吗？
它们是否需要由我们的系统管理员以某种方式设置（我在办公网络上）？

我想在本地测试它，所以我使用上述配置运行两个单独的 tomcat 实例。我需要在每一项中更改什么？我知道两个侦听器都不能在同一个端口上侦听 - 但是提供者呢？
另外，侦听器端口也是任意的吗？

我已经尝试按上述方式进行设置，但在我的测试中，缓存似乎没有被复制——在一个 tomcat 的缓存中添加的值在另一个缓存中不存在。
我可以做些什么来调试这种情况（数据包嗅探除外）？

在此先感谢您的帮助，一直在为这个而烦恼！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-08-24T16:09:43.863

> 我想在本地测试它，所以我使用上述配置运行两个单独的 tomcat 实例。

因为我刚刚提交了有关 cherouvims[相关问题](https://stackoverflow.com/questions/1313410/ehcache-auto-discovery-via-multicast-between-2-instances-on-the-same-host)的答案，所以我也想在这里强调一下，它们实际上提供了一个至少做类似事情的示例（每个主机有多个节点，尽管只有一个实例）：请参阅*完整示例*中的部分[RMI 分布式缓存](http://www.ehcache.org/documentation/2.7/replication/rmi-replicated-caching.html)文档。

更改每个 TCP 端口确实很重要，`cacheManagerPeerListenerFactory`但多播设置可以（我认为它们必须）保持不变：您可以在上面提到的*完整示例的*[ehcache.xml](http://ehcache.svn.sourceforge.net/viewvc/ehcache/trunk/core/src/test/resources/distribution/)中看到这一点：端口号增加每个节点从 40001 到 40006 一个接一个，而多播设置保持不变。

 *如果您遵守了这一点，您的问题可能只是与在 Windows 上运行的 Tomcat 有关 - 请参阅[RMI 分布式缓存中的](http://www.ehcache.org/documentation/2.7/replication/rmi-replicated-caching.html)*常见问题*部分中的相关段落：

> Tomcat 和/或 JDK 中存在一个错误，如果安装路径中有空格，则任何 RMI 侦听器都将无法在 Tomcat 上启动。
> [...]
> 由于 Windows 上的默认设置是在“程序文件”中安装 Tomcat，因此默认情况下会出现此问题。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-04-22T08:39:39.550

我在 EHCache 对等复制过程中遇到的一个错误。这可能很有用，因此有人尝试在单个本地机器上进行对等复制。

我想使用 peerDiscovery=automatic 在单个 Windows Vista 机器上运行 3 个对等复制的 EhCache 实例（最终目标环境是 Linux）。

对等复制不起作用。奇怪的是，所有 EhCache 实例都在启动，日志中没有任何错误或投诉。

我花了一段时间才弄清楚我的错误；在日志中没有任何内容我不得不四处摸索：我在每个 EhCache 实例的对等侦听器配置中使用相同的 listenerPort (40001)。使用不同的 listenerPorts (40001, 40002...) 就可以了。

```
<cacheManagerPeerListenerFactory 
class="net.sf.ehcache.distribution.RMICacheManagerPeerListenerFactory" 
properties="port=40001, socketTimeoutMillis=3000"/>

<cacheManagerPeerListenerFactory 
class="net.sf.ehcache.distribution.RMICacheManagerPeerListenerFactory" 
properties="port=40002, socketTimeoutMillis=3000"/> 
```

请注意，这是需要不同端口号的“对等侦听器”配置。多播“对等发现”仍然为每个 ehcache 实例使用相同的多播地址和端口号。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-19T20:34:41.563

确保您的服务器为初学者启用了多播。不确定您在哪个平台上运行。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-08-27T10:32:35.087

就像快速跟进一样。

我们确实使用两台独立的机器来解决这个问题，这完全解决了让它工作的原始问题。据我记得多播应该“开箱即用”，但值得与您当地的系统管理员核实（我们建议对多播组地址进行调整）。

我们最终在 Solaris 上遇到了各种各样的问题，最终放弃了多播，转而[使用手动对等发现。](http://ehcache.org/documentation/distributed_caching_with_rmi.html#Manual_Peer_Discovery)

最后，在调试方面，使用 jconsole 监控缓存值被证明是最好的方法。不必求助于数据包嗅探。:-)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-05-27T18:45:27.547

```
 <cacheManagerPeerListenerFactory class="net.sf.ehcache.distribution.RMICacheManagerPeerListenerFactory"/> 
```

只需执行上述操作，ehcache 将使用下一个可用的！因此，您不必担心要在集群中部署的新节点上的配置。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-08-15T15:21:07.453

可以帮助某人实现多播。我已经通过在我的本地 tomcat 中从 eclipse 中运行我的应用程序并在我同事的 eclipse 中的本地 tomcat 中运行相同的应用程序来验证。

在你的 Windows 机器上运行下面会显示一些 ips 并确保多播应该工作。

```
netsh interface ip show joins 
```

属性 multicastGroupAddress=230.0.0.1 表示您的应用程序要使用此 IP，可以更改但确保仅使用 D 类 IP 范围。运行您的应用程序后，您可以看到这个 IP 230.0.0.1 也如下所示 [![在此处输入图像描述](https://i.stack.imgur.com/fW12g.jpg)](https://i.stack.imgur.com/fW12g.jpg)

要查看所有魔法，请确保正确启用日志。

```
 <logger name="net.sf.ehcache">  <level value="debug"/></logger>
   <logger name="net.sf.ehcache.distribution.RMICachePeer" level="debug" /> 
```

确保在默认缓存或所需缓存配置中有以下 lisner

```
 <cacheManagerPeerProviderFactory
       class="net.sf.ehcache.distribution.RMICacheManagerPeerProviderFactory"
       properties="port=40003, peerDiscovery=automatic,
                   multicastGroupAddress=230.0.0.1,
                   multicastGroupPort=4446,
                   timeToLive=32"/>
    <cacheManagerPeerListenerFactory 
        class="net.sf.ehcache.distribution.RMICacheManagerPeerListenerFactory"
        properties="port=40001, socketTimeoutMillis=3000" />
    <cacheManagerPeerListenerFactory 
        class="net.sf.ehcache.distribution.RMICacheManagerPeerListenerFactory" 
        properties="port=40002, socketTimeoutMillis=3000"/>
 <defaultCache
     eternal="false"
     timeToIdleSeconds="300"
     timeToLiveSeconds="300"
     diskExpiryThreadIntervalSeconds="305"
     memoryStoreEvictionPolicy="LRU"
     statistics="true">
     <persistence strategy="localTempSwap"/>
     <cacheEventListenerFactory class="net.sf.ehcache.distribution.RMICacheReplicatorFactory"/>
     <bootstrapCacheLoaderFactory class="net.sf.ehcache.distribution.RMIBootstrapCacheLoaderFactory" properties="bootstrapAsynchronously=true, maximumChunkSizeBytes=5000000"/>
        </defaultCache> 
```

部署应用程序后，您可以在日志中看到以下内容

```
13:31:27.073  DEBUG n.s.e.d.PayloadUtil assembleUrlList - Cache peers for this CacheManager to be advertised:......
15:15:14.110  DEBUG net.sf.ehcache.distribution.MulticastKeepaliveHeartbeatReceiver processPayload rmiUrls received....(YOur configured caches with Ips) 
```

如果您需要配置手动对等点发现过程，这将很有帮助。

# javascript - Javascript：RegExp.compile() 的意义何在？

> ID：884762
> 
> 赞同：56
> 
> 时间：2009-05-19T20:07:15.940
> 
> 标签：javascript, regex, compilation

我有一种情况，我想从用户那里得到一个正则表达式，并针对几千个输入字符串运行它。在手册中，我发现该`RegExp`对象具有一种`.compile()`用于在这种情况下加快速度的方法。但是，如果我已经在构造函数中传递了正则表达式字符串，为什么还要再次将它们传递给它呢？也许构造函数`compile()`本身？

* * *

## 回答 #1

> 赞同：94
> 
> 时间：2009-05-19T20:12:09.050

该[`RegExp().compile()`方法已弃用](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp/compile)。它与构造函数基本相同，我认为这就是它被弃用的原因。您现在应该只需要使用构造函数。

换句话说，你曾经能够做到这一点：

```
var regexp = new RegExp("pattern");
regexp.compile("new pattern"); 
```

但是现在它与简单地调用没有什么不同：

```
var regexp = new RegExp("pattern");
regexp = new RegExp("new pattern"); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2011-03-08T18:32:50.237

而对于 Opera 11，运行`RegExp.compile()`实际上会导致错误。

显然，当 Opera “编译”一个正则表达式时，它会将`re.source`字符串包裹在正斜杠中（例如`re.source == "^(.)"`变成`"/^(.)/"`）。如果您手动编译正则表达式，Opera 不会识别这个事实并继续并再次编译它（`re.source`变成`"//^(.)//"`）。每次编译都会产生一组额外的正斜杠，这会改变正则表达式的含义并导致错误。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2016-11-03T14:21:01.120

如果你正在使用，你必须先编译你的正则表达式才能使用它`/`，试试这个：

```
var regex=new RegExp('/[a-zA-Z]/')

console.log("not compiled with escape /", regex.test("ciao") )

regex.compile()

console.log("compiled", regex.test("ciao") )

var regex=new RegExp('[a-zA-Z]')

console.log("not compiled, but no escape /", regex.test("ciao") )
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-19T20:13:25.193

据我所知，RegExp.compile 所做的就是替换 RegExp 对象的底层正则表达式。我认为 compile 在过去可能有价值，但所有现代 JS 引擎在第一次调用时“编译”正则表达式并缓存该“编译”版本。

# visual-studio-2010 - 如何更改 VS 2010 中的蓝色边框？

> ID：884771
> 
> 赞同：7
> 
> 时间：2009-05-19T20:09:23.143
> 
> 标签：visual-studio-2010

我在环境下导入了我的旧字体和颜色设置，我的代码看起来像我喜欢的那样，但我看不到在哪里更改它周围的蓝色边框的外观。

如果有人知道这是哪里，请帮我完成我通常的安装后 pimp 我的 IDE 例程...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-11-16T02:25:21.287

安装 Visual Studio 颜色主题编辑器：http: [//visualstudiogallery.msdn.microsoft.com/en-us/20cd93a2-c435-4d00-a797-499f16402378](http://visualstudiogallery.msdn.microsoft.com/en-us/20cd93a2-c435-4d00-a797-499f16402378)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-13T23:51:10.797

你不能 - 根本没有任何支持。正如 MicTech 所说，这可能会出现在下一个版本中，甚至可能出现在 VS2010 的下一个 SP 中。为什么？因为这并不难，现在他们已经用 WPF 重写了它（不是 WPF 让它变得更容易，而是重写的架构）。

# svn - svn-merge 是倒退吗？

> ID：884772
> 
> 赞同：3
> 
> 时间：2009-05-19T20:09:52.017
> 
> 标签：svn, version-control, merge

我刚刚进行了合并，它似乎与我预期的方式相反。我想知道我做错了还是这是一个已知的“问题”？

我有 2 个分支 Experiment/Trunk

我在实验中做了我想做的任何事情，并将其合并回主干。使用 Tortoise，我右键单击 Experiment->Merge。我选择了合并两棵不同的树，就是这样（将其他所有内容保留为默认值）。我检查以确保它说 Merge [Experiment] Revision Head *TO* [Trunk] Revision Head

问题是，它没有将差异应用到树干上......它把它们应用到实验......所以现在实验是我的“树干”，这绝对与我想要的相反。

现在，我不得不 svn-delete 主干并将实验的内容复制回主干以修复它（据我所知），但在未来，这不是它应该工作的方式吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-19T20:21:35.147

如果您的工作副本在“实验”中，那么这就是合并的结果。

您提到的从到到是如何构建将应用的差异，即它计算“从”x“到”y 的差异并将其应用于工作副本。

TortoiseSVN 帮助很好地解释了这一点。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-19T20:25:34.763

1.  如果要合并到*Trunk ，则需要在**Trunk*的工作副本上执行合并。合并会产生本地编辑，然后需要签入。因此，合并的目标必须是工作副本。

2.  您误解了“TO”和“FROM”。

    在两个 URL 合并中，您所做的是要求 Subversion 计算将“FROM”转换为“TO”所需的更改，然后将这些更改应用于工作副本。

在您的情况下，您要求 subversion 计算获得“FROM”实验“TO”主干所需的更改并将它们应用于 Experiment 的工作副本。这将使您的 Experiment 分支的本地工作副本的内容与 Trunk 相同，因为那是您要求 Subversion 执行的操作。

我建议你阅读手册。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-19T20:22:12.413

我认为您的根本误解是您不合并**到**某个地方，而是**从**某个地方合并。

所以你需要在你的主干工作文件夹中，并**从**实验中*合并*你想要的修订范围。

 *** * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-19T20:11:46.290

我建议阅读免费的 SVN 手册，[*使用 Subversion 进行版本控制*](http://svnbook.red-bean.com/nightly/en/svn-book.html)。相关章节在[这里](http://svnbook.red-bean.com/nightly/en/svn.branchmerge.html)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-19T20:16:07.637

我*想*你想选择“重新整合一个分支”而不是“合并两个不同的树”

有[一个问题](https://stackoverflow.com/questions/299142/using-tortoisesvn-how-do-i-merge-changes-from-the-trunk-to-a-branch-and-vice-vers)涵盖了您想要的内容。

# expert-system - 专家系统引擎

> ID：884775
> 
> 赞同：1
> 
> 时间：2009-05-19T20:10:22.687
> 
> 标签：expert-system

明年将是我成为一名信息学工程人员的研究生年，我正在努力寻找有关初级项目的想法。实际上，我有一个制作专家系统引擎的想法。我使用剪辑和序言，我非常喜欢剪辑，但它似乎是一个旧引擎。任何人都可以就这个想法给我建议或给我论文或任何可能对我有帮助的主题的来源吗？我正在考虑使用 C 语言来获得高性能，并构建一个健壮的数据结构。另外，我正在考虑编写事实和规则（如剪辑）的想法（我不知道是否可以完成），然后从这些规则中生成 C++ 最佳代码，这样我就可以获得机器的速度并使用 exe文件。

我需要帮助以使这个想法更清晰以及如何实现。特别是因为我读过模糊逻辑，神经网络，听说过新一代的专家系统，所以我不知道这和这个话题有什么关系。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-19T20:21:49.840

对于您的初级项目，我建议您不要用 C 语言编写它。您的问题听起来需要正确性而不是速度。用 C 语言编写它需要更长的时间，因为您需要实现许多未包含在语言或任何标准库中的原语。此外，由于 C 语言相对低级，因此有很多机会犯低级错误。用更接近问题域的高级语言编写它。您将有更多时间专注于您的实际问题，因为您将花费更少的时间来设置框架。如果您已经了解 Prolog，那么坚持下去会很好。也许你可以考虑[Mercury](http://en.wikipedia.org/wiki/Mercury_programming_language)。它类似于 Prolog，但也是[为速度而设计的](http://www.cs.mu.oz.au/research/mercury/information/motivation.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-11-18T11:39:18.453

JBoss Rules（也称为 Drools）提供了规则处理的最佳方法。它是用 Java 编写的。它允许您将程序组件集成到规则中，并将规则库集成到您的程序组件中。您甚至可以即时构建或修改规则库。

我听说 Java 在数学运算能力方面正在迎头赶上，但除此之外，您无需担心性能。

# actionscript-3 - ActionScript 3 动态调用按钮

> ID：884776
> 
> 赞同：0
> 
> 时间：2009-05-19T20:10:26.323
> 
> 标签：actionscript-3, actionscript

我试图访问菜单中的按钮。我只想将侦听器添加到正在加载的 XML 文件中的项目。

问题是，当我有一个字符串“Var1”时，我不知道如何调用我命名为“Var1_btn”的按钮。

有谁知道如何从 for 循环中调用按钮？

```
for each(var chapter in presentation_xml.*)
{
    chapter + "_btn".addEventListener(MouseEvent.MOUSE_DOWN, traceit);
} 
```

是我想出的...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-19T20:15:17.403

假设您将 xml 加载到一个名为 presentationXML 的变量中，它是这样的：

```
for each(var chapter in presentationXML.*)
{
    this[chapter + "_btn"].addEventListener(MouseEvent.MOUSE_DOWN, traceit);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-19T21:29:00.377

您可以使用：

```
for each(var chapter in presentation_xml.*)
{
    this[chapter + "_btn"].addEventListener(MouseEvent.MOUSE_DOWN, traceit);
} 
```

但您也可以使用[getChildByName](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/display/DisplayObjectContainer.html#getChildByName())，如下所示：

```
for each(var chapter in presentation_xml.*)
{
    var myBtn:MovieClip = getChildByName(chapter + "_btn");
    myBtn.addEventListener(MouseEvent.MOUSE_DOWN, traceit);
} 
```

这是一篇关于[何时使用 getChildByName](http://simpleas3.com/documentation/display-list-children-properties/)的好帖子。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-19T20:13:04.773

DisplayObjectContainer::getChildByName()

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-20T17:14:02.167

更好地使用 chapter.toString()。

效果相同，但其他编码人员会阅读并理解，当与字符串文字连接时，该章节正在从 XML 转换为其字符串表示形式。

# javascript - 如何强制每个页面加载某个 javascript 文件？

> ID：884778
> 
> 赞同：3
> 
> 时间：2009-05-19T20:10:57.990
> 
> 标签：javascript, iis, analytics, enterprise

我在工作中创建了一个非常基本的系统，它可以完成 Google 分析所做的工作（相比之下非常简单）并且运行良好，但与 Google Analytics 一样，它要求每个页面都引用一个 JavaScript 文件。有没有办法让我们所有从 IIS 提供的页面都引用这个 Javascript 文件？我想为每一页捕获这些统计信息。

有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-19T20:19:23.807

嗯，[看起来你正在寻找这个](http://learn.iis.net/page.aspx/480/sample-web-analytics-tracking-module/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-19T20:18:32.703

如果您正在处理静态 HTML 文件，那么最好的选择似乎是[this previous question](https://stackoverflow.com/questions/638866/can-i-make-iis-add-inject-html-to-every-page-it-serves)。

如果您有一个 ASP 站点，并且您已经有一个标题或布局文件，我建议将它放在那里。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-19T20:17:04.810

这取决于您如何构建您的网站，但大多数人通过添加对其模板、布局、母版页或您的开发平台中使用的任何术语的引用来做到这一点。

您不希望跟踪**每个**页面，例如，返回 JSON 或 XML 等数据的页面不应受到干预。这就是为什么最好明确控制哪些页面将分析 javascript 添加到其中。

# security - 网址过滤

> ID：884781
> 
> 赞同：3
> 
> 时间：2009-05-19T20:11:46.850
> 
> 标签：security, url, malware, malware-detection

我正在寻找方法来验证网站是否在任何 url 过滤数据库中进行分类。有人知道带有免费 API 的此类数据库吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-19T20:15:08.700

查看[Google 安全浏览 API](http://code.google.com/apis/safebrowsing/)。它允许您根据 Google 的可疑网络钓鱼和恶意软件页面黑名单检查 URL。这是[开发人员指南](http://code.google.com/apis/safebrowsing/developers_guide.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-09-28T22:14:58.207

BrightCloud 刚刚发布了一个[用于 URL 分类的 API，](http://bcws.brightcloud.com)它比 Google 安全浏览 API 更全面——它确实要花钱但很便宜。除了“成人”和“赌博”等类别外，它还具有网络钓鱼、恶意软件和垃圾邮件等安全导向类别。

完整的类别列表在这里：[http ://brightcloud.com/masterdburllist.asp](http://brightcloud.com/masterdburllist.asp)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-16T14:39:11.627

查看 SimilarWeb API。API 将执行域级别的分类，并基于 SimilarSite 的内容分析和机器学习。

API 链接：[https ://developer.similarweb.com/](https://developer.similarweb.com/)

披露，我隶属于 SimilarWeb 的创建者 SimilarGroup。

# c# - 从托管或衍生进程调用非托管代码

> ID：884787
> 
> 赞同：0
> 
> 时间：2009-05-19T20:12:55.693
> 
> 标签：c#, .net, c++, unmanaged

我有一个非托管的 C++ exe，我可以直接从我的 C# 代码内部调用（具有我可以创建一个库的 C++ 代码）或通过生成一个进程并从 OutputStream 中获取数据。选项的优点/缺点是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-24T14:45:00.317

由于您有 C++ 库的源代码，您可以使用 C++/CLI 将其编译为混合模式 dll，以便 C# 应用程序使用。

这样做的好处是在数据流（该 C++ 模块的输入或输出）上最为灵活。

在进程外运行 C++ 代码有一个好处。如果您的 C++ 代码不是很健壮，这可以使您的主要 C# 进程稳定，以免被 C++ 代码崩溃。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-09T13:43:57.537

正在进行的主要缺点是确保您正确处理托管/本机交互。

1)

c++ 代码可能取决于清理/资源释放等的确定性破坏。我说这可能是因为这在 c++ 中是常见且良好的做法。

在托管代码中，这意味着您必须小心正确地处理您的 c++ cli 包装器代码。如果您的代码使用过一次，c# 中的 using 子句将为您执行此操作。如果对象需要作为成员存在一段时间，您会发现 dispose 需要在整个应用程序中链接起来。

2)

另一个问题取决于您的应用程序的内存消耗程度。托管垃圾收集器可以是惰性的。如果托管分配需要比可用空间更多的空间，则可以保证启动。然而，非托管分配器无论如何都没有连接。因此，您需要手动通知托管分配器您将进行非托管分配，并且它应该保持该空间可用。这是使用 AddMemoryPressure 方法完成的。

流程外的主要缺点是：

1) 速度。

2) 管理通信的代码开销。

3) 监视一个或其他进程在不期望时死亡的代码开销。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-19T20:20:19.500

抓取 OutputStream 的最大缺点是缺少数据类型。我宁愿做导出一些函数和重用现有库的工作；但是，这实际上只是一种偏好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-19T20:24:26.683

生成进程的另一个缺点是在 Windows 上生成进程是一项非常昂贵（缓慢）的操作。如果您打算经常调用 c++ 代码，这值得考虑。一个优点可能是您自动更加孤立于 c++ 程序中的崩溃。替换 c++ 可执行文件也可能是一个优势。此外，在 c# 中编写互操作代码可能会很麻烦。如果它是一个复杂的交互并且您决定进行互操作，请查看互操作层的 c++/cli。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-19T20:24:58.493

最好将 C++ 可执行文件的函数子集构建到库中。您将保持类型安全，并且您将能够更好地利用异常处理（更不用说对如何管理对库中函数的调用的更精细控制）。

如果您从可执行文件的 OutputStream 中获取数据，您将看不到可执行文件的进程，没有真正的异常处理，并且您将丢失您可能拥有的任何类型信息。

# wcf - 具有多个端点访问 WSDL 的 WCF？

> ID：884807
> 
> 赞同：-1
> 
> 时间：2009-05-19T20:17:42.877
> 
> 标签：wcf, .net-3.5

WSDl 是否只能通过 ".svc?wsdl" 访问？我有一个具有多个端点的服务。例如（在 web.config 中）：

```
<services>
  <service behaviorConfiguration="MyServiceTypeBehavior" name="WcfService1.Service">
    <endpoint binding="wsHttpBinding" bindingConfiguration="ws1"
     name="ws1" contract="WcfService1.IMyService" />
    <endpoint address="http://www.blah.com/Service.svc/Basic" binding="basicHttpBinding"
     bindingConfiguration="Basic" name="Basic" contract="WcfService1.IMyService" />
    <endpoint address="http://localhost:5606/Service.svc/Secured"
     binding="wsHttpBinding" bindingConfiguration="WsSecured" name="WsSecured"
     contract="WcfService1.IMyService" />
  </service>
</services> 
```

如果我去：`http://www.blah.com/Service.svc/Basic`我收到 404 页面错误。当我转到`http://www.blah.com/Service.svc?wsdl`页面底部时，我会看到我的 wsdl 和我的 3 个端点。我应该能够通过他们的地址到达其他端点吗？我有一个使用 Axis2 访问我们的服务的客户端，我想为不同的客户端使用多个端点。我知道我可以将其添加到服务行为中：

```
<behavior name="MyServiceTypeBehavior">
  <serviceMetadata httpGetEnabled="true" httpGetUrl="Basic" />
  <serviceDebug includeExceptionDetailInFaults="true" />
  <dataContractSerializer maxItemsInObjectGraph="2147483646"/>
</behavior> 
```

但是我必须为每个端点创建一个服务条目，对吗？我是否应该担心能够通过 URL 访问端点？

谢谢

丹尼尔

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-19T20:46:23.113

我想你可能想多了。WSDL 将指定所有端点及其策略。客户端可以指定使用哪个端点进行通信。

您无需导航到端点的 URL。

# java - 用于从没有 mvn/poms 的 maven repo 下载工件的实用程序

> ID：884808
> 
> 赞同：4
> 
> 时间：2009-05-19T20:17:44.077
> 
> 标签：java, maven-2, repository, aether

是否有一个不是 mvn 的 maven 客户端（maven 发行版中包含的二进制文件）我可以用来在不使用 pom 的情况下从 maven 存储库中提取工件？我想使用 maven 存储库作为我们的操作团队的存储库来获取构建（包括构建的快照），但我不希望他们不得不在编写 pom 和在其中声明依赖项时搞乱。理想情况下，我正在寻找一个 cli 客户端，我可以只传递一个 repo url 和坐标并下载给定的工件。这样的事情是否存在，或者我最好为此编写一个一次性脚本？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-12-10T12:53:46.857

我看到 3 个简单的选项：

1.  只需向他们发送指向您存储库中工件的链接，并让他们使用他们的浏览器。
2.  安装和使用`wget`( `wget http://path/to/artifact.extension`)。
3.  安装和使用[`mvn dependency:get`](http://maven.apache.org/plugins/maven-dependency-plugin/get-mojo.html)（需要`mvn`但**不需要**a ，有关详细信息`pom.xml`，请参阅[此答案）。](https://stackoverflow.com/questions/1776496/a-simple-command-line-to-download-a-remote-maven2-artifact-to-the-local-repositor/1776808#1776808)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-19T22:52:28.617

使用连结。它提供了一个 Web 界面，其他团队可以使用它来下载工件。[http://nexus.sonatype.org/](http://nexus.sonatype.org/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-19T20:25:02.517

使用 [maven 嵌入器](http://maven.apache.org/embedder.html)。更重要的是，使用 maven 嵌入器中的功能来解析和下载 jar。尽管如果您只是尝试编写一个简单的 CLI，存储库结构并不复杂，您可以轻松编写一个脚本，该脚本采用 maven repo url、工件 ID、组 ID 和版本来生成 jar 的完整 URL。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-28T12:35:00.343

这就是我们在[jcabi-aether](http://www.jcabi.com/jcabi-aether/)中的做法：

```
final File repo = this.session.getLocalRepository().getBasedir();
final Collection<Artifact> deps = new Aether(this.getProject(), repo).resolve(
  new DefaultArtifact("junit", "junit-dep", "", "jar", "4.10"),
  JavaScopes.RUNTIME
); 
```

您需要向这个库提供的只是 1) 远程存储库列表，2) 本地存储库的位置，以及 3) 工件的 Maven 坐标。该库使用Sonatype 的[Apache Aether](http://www.sonatype.org/aether)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-20T03:38:14.773

从技术上讲，存储库是通过 HTTP 访问的，因此考虑到存储库的位置、工件和坐标，应该可以为您的运维团队提供一个他们可以在任何浏览器中访问的工件的 URL。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-12-10T11:28:38.763

考虑一下**Pax URL**，它允许您使用纯 URL 来引用 maven 工件，如下所示：

```
mvn:groupId/artifactId/version

```

有关详细信息，请参阅[PAX URL 网站](http://paxurl.ops4j.org)（MVN 协议处理程序）。

托尼

# php - 当我无法访问 PHP 的本机 FTP 句柄时，如何使用 PHP CLI 自动执行 FTP？

> ID：884812
> 
> 赞同：0
> 
> 时间：2009-05-19T20:18:27.010
> 
> 标签：php, shell, ftp

我正在生产服务器上编写一个自动化脚本，除其他外，它需要通过 FTP 获取远程文件列表（FTP 是与远程文件系统交互的唯一选项）并有选择地下载它们。

**为什么我不能使用 PHP 的本地 FTP 包装器**

这是一个非常脆弱的环境中的生产服务器。我正在使用 PHP CLI 编写它，因为大多数现有的自动化脚本都是这样编写的。然而，虽然我有一个非常新的 PHP 5.1.2 安装，但我无法使用 --with-ftp 重新编译它，并且该选项未启用。

**其余选项**

因此，我的选择是使用 FTP 流和 PHP 本机文件系统函数使用 shell_exec() 或 php_filesystem 函数进行连接、获取我的文件列表并选择性地下载。

不幸的是，我找不到好的代码示例。当我尝试使用 FTP 命令执行 shell_exec 时，程序挂起，大概是因为一旦我打开 FTP 提示，控制权就停留在 shell 上。

```
$ftp_connect_command = "ftp -v -n $bl_ftp_host";
$ftp_login_command = "user $bl_ftp_user $bl_ftp_password";
$ftp_bye_command = "bye";

$ftp_connect_response = shell_exec("$ftp_connect_command");
// this never executes, because it hangs here waiting for a return to shell
$ftp_login_response = shell_exec($ftp_login_command); 
```

或者，我想基于流的方法是：

```
$ftp_path = "ftp://$bl_ftp_user:$bl_ftp_user@$bl_ftp_host/";
$stream_options = array('ftp' => array('overwrite' => false));
$context = stream_context_create();
if ($dh = opendir($ftp_path, $context))
{
    while (filename = readdir($dh))
    {
        print($filename);
    }
} 
```

但我不确定这是否被认为是一种可靠的方法。

谁能提供代码示例来展示如何通过这些方法中的任何一种捕获目录列表和下载文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-19T21:57:15.233

显然，wordpress 将[pemftp](http://www.phpclasses.org/browse/package/1743.html)用于纯 PHP FTP（在不支持 FTP 编译的系统上）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-19T20:24:19.680

你看过原生的 PHP FTP 库吗？ [http://us2.php.net/ftp](http://us2.php.net/ftp)

# c# - C#最终执行时间

> ID：884822
> 
> 赞同：21
> 
> 时间：2009-05-19T20:20:04.663
> 
> 标签：c#, exception, finally

拿这个代码：

```
using System;

namespace OddThrow
{
    class Program
    {
        static void Main(string[] args)
        {
            try
            {
                throw new Exception("Exception!");
            }
            finally
            {
                System.Threading.Thread.Sleep(2500);
                Console.Error.WriteLine("I'm dying!");
                System.Threading.Thread.Sleep(2500);
            }
        }
    }
} 
```

这给了我这个输出：

```
Unhandled Exception: System.Exception: Exception!
   at OddThrow.Program.Main(String[] args) in C:\Documents and Settings\username
\My Documents\Visual Studio 2008\Projects\OddThrow\OddThrow\Program.cs:line 14
I'm dying! 
```

我的问题是：为什么未处理的异常文本出现在 finally 之前？在我看来，finally 应该在堆栈展开时被执行，甚至在我们**知道**这个异常未处理之前。注意对 Sleep() 的调用 - 这些发生*在*打印未处理的异常之后，就好像它正在执行以下操作一样：

1.  未处理的异常文本/消息
2.  最后阻塞。
3.  终止申请

根据 C# 标准，§8.9.5，这种行为是错误的：

*   在当前函数成员中，检查包含抛出点的每个 try 语句。对于每个语句 S，从最里面的 try 语句开始，到最外面的 try 语句结束，评估以下步骤：
*   *   如果 S 的 try 块包含了抛出点，并且如果 S 有一个或多个 catch 子句，则按出现的顺序检查 catch 子句以找到合适的异常处理程序。指定异常类型或异常类型的基类型的第一个 catch 子句被视为匹配项。一般的 catch 子句（第 8.10 节）被认为是任何异常类型的匹配项。如果找到匹配的 catch 子句，则通过将控制转移到该 catch 子句的块来完成异常传播。
*   *   否则，如果 S 的 try 块或 catch 块包围了抛出点，并且如果 S 有 finally 块，则控制转移到 finally 块。如果 finally 块抛出另一个异常，则终止当前异常的处理。否则，当控制到达 finally 块的终点时，继续处理当前异常。
*   如果异常处理程序不在当前函数成员调用中，则终止函数成员调用。然后对函数成员的调用者重复上述步骤，并使用与调用函数成员的语句相对应的抛出点。
*   如果异常处理终止了当前线程中的所有函数成员调用，表明该线程没有异常处理程序，则该线程本身终止。这种终止的影响是实现定义的。

我哪里错了？（我有一些自定义控制台错误消息，这是在路上。轻微的，只是烦人，让我质疑语言......）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-19T20:53:11.727

该标准关于执行顺序的陈述是正确的，并且与您所观察的内容不一致。“未处理的异常”消息被允许出现在进程中的*任何*点，因为它只是来自 CLR 的消息，而不是真正的异常处理程序本身。关于执行顺序的规则仅适用于在 CLR 内部执行的代码，而不适用于 CLR 本身所做的事情。

您实际上所做的是公开一个实现细节，即通过查看我们在其中的 try{} 块的堆栈来识别未处理的异常，而不是通过实际探索到根。通过查看此堆栈可能会或可能不会*处理*异常，但是以这种方式识别未处理的异常。

您可能知道，如果您在主函数中放置一个顶级 try{}catch{}，那么您将看到您所期望的行为：每个函数的 finally 将在检查下一帧是否匹配 catch{之前执行}。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-19T20:35:36.350

我阅读内容的方式可能会偏离基础……但是您可以尝试 finally 块而不会遇到问题。

从您发布的描述来看，由于 Exception 从未被捕获，它会冒泡到调用者，通过堆栈向上工作，最终未处理，调用终止，然后调用 finally 块。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-19T20:36:18.017

输出实际上来自默认的 CLR 异常处理程序。异常处理程序发生在 finally 块之前。在 finally 块之后，CLR 由于未处理的异常而终止（它之前不能终止，因为 c# 保证 [1] 调用 finally 子句）。

所以我想说这只是标准行为，异常处理发生在 finally 之前。

[1] 在正常运行期间保证至少在没有内部运行时错误或断电的情况下

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-19T20:49:40.563

要添加更多内容，请考虑以下内容：

```
using System;
namespace OddThrow
{
    class Program
    {
        static void Main()
        {
            AppDomain.CurrentDomain.UnhandledException +=
                delegate(object sender, UnhandledExceptionEventArgs e)
            {
                Console.Out.WriteLine("In AppDomain.UnhandledException");
            };
            try
            {
                throw new Exception("Exception!");
            }
            catch
            {
                Console.Error.WriteLine("In catch");
                throw;
            }
            finally
            {
                Console.Error.WriteLine("In finally");
            }
        }
    }
} 
```

在我的系统（挪威语）上显示了这一点：

```
[C:\..] ConsoleApplication5.exe
In catch
In AppDomain.UnhandledException

Ubehandlet unntak: System.Exception: Exception!
   ved OddThrow.Program.Main() i ..\Program.cs:linje 24
In finally 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-19T20:37:33.617

尽管没有完全预期，但该程序确实按应有的方式运行。finally 块不希望首先运行，它只希望始终运行。

我调整了你的样本：

```
public static void Main()
{
    try
    {
        Console.WriteLine("Before throwing");
        throw new Exception("Exception!");
    }
    finally
    {
        Console.WriteLine("In finally");
        Console.ReadLine();
    }
} 
```

在这种情况下，您将看到令人讨厌的未处理异常对话框，但随后控制台将输出并等待输入，从而执行 finally，而不是在 windows 本身捕获未处理异常之前。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-19T20:29:46.797

如果 try-catch-finally 块*在某个时间点被捕获，它们的*工作方式与您预期的完全一样。当我为此编写一个测试程序并使用各种嵌套级别时，它的行为方式与您所描述的匹配的唯一情况是异常完全未被代码处理，并且它冒泡到操作系统。

每次我运行它时，操作系统都是创建错误消息的原因。所以问题不在于 C#，而是因为用户代码未处理的错误*不再受应用程序的控制，*因此运行时（我相信）不能强制执行模式。

如果您创建了一个 Windows 窗体应用程序，并将所有消息写入文本框（然后立即刷新它们）而不是直接写入控制台，那么您根本不会看到该错误消息，因为它已插入错误控制台由调用应用程序而不是您自己的代码。

**编辑**

我将尝试强调其中的关键部分。*未处理的异常不在您的控制范围内，您无法确定何时执行它们的异常处理程序。*如果您在应用程序*中的某个时刻*`finally`捕获到异常，则这些块将在堆栈中较低的块之前执行`catch`。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-19T20:37:01.247

没有 catch 的 try/finally 将使用默认处理程序，该处理程序与您看到的完全相同。我一直都在使用它，例如，在处理异常会覆盖错误但您仍然想做一些清理工作的情况下。

还要记住，标准错误的输出和标准输出是缓冲的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-19T21:02:43.860

将几个答案放在一起，发生的情况是，一旦您有一个未处理的异常，就会在 AppDomain 上引发一个 UnhandledExceptionEvent，然后代码继续执行（即 finally）。这是[有关该事件的 MSDN 文章](http://msdn.microsoft.com/en-us/library/system.appdomain.unhandledexception(VS.71).aspx)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-19T21:09:34.457

下次尝试：

1.  我相信 c# 标准中没有提到这种情况，我同意它似乎几乎与它相矛盾。

2.  我相信发生这种情况的内部原因有点像这样：当您的代码中有更多捕获时，CLR 将其默认异常处理程序作为 SEH 处理程序注册到 FS:[0] 中，这些处理程序被添加到 SEH 链中。或者，在 SEH 处理期间只调用 CLR 处理程序并在内部处理 CLR 异常链，我不知道是哪个。

在引发异常时的代码中，只有默认处理程序位于 SEH 链中。在任何堆栈展开开始之前调用此处理程序。

默认异常处理程序知道堆栈上没有注册异常处理程序。因此，它首先调用所有已注册的 UnhandledException 处理程序，然后打印其错误消息并将 AppDomain 标记为卸载。

只有在该堆栈展开甚至开始并且根据 c# 标准调用 finally 块之后。

如我所见，c# 标准中没有考虑 CLR 处理未处理异常的方式，只考虑堆栈展开期间调用 finally 的顺序。保留此顺序。之后，“这种终止的影响是实现定义的”。条款生效。

# nhibernate - 如何在 NHibernate 中进行“空表”选择？

> ID：884826
> 
> 赞同：0
> 
> 时间：2009-05-19T20:21:28.860
> 
> 标签：nhibernate

换句话说，你如何做这样简单的事情：

```
select 1 
```

或者更具体地说，在我正在处理的特定问题中，如下所示：

```
SELECT (case when exists (<subquery>) then 1 else 0 end) AS result 
```

所以简而言之，NHibernate 有没有办法在不生成“FROM table”子句的情况下进行选择？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-19T20:25:56.010

您正在错误地处理这个问题。

在使用计数投影后执行您的子查询，然后在代码中执行 if else 逻辑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T19:55:54.643

我会把它`<subquery>`变成一个`select top 1 id from table`样式查询。然后检查非空结果。任何 NH 查询将始终启动`from table`。

# wpf - 如何在 Model-View-Viewmodel 架构中从模型方法的中间干净地获取用户输入？

> ID：884831
> 
> 赞同：7
> 
> 时间：2009-05-19T20:22:27.017
> 
> 标签：wpf, mvvm, model, dialog, synchronous

我正在编写一个侦听网络连接的应用程序，当一些数据到达时，它会回复，并且根据传入的数据，它可能需要在回复之前询问用户（显示对话框）。

我不知道如何在 MV-VM 架构中干净地做到这一点：如果我只需要根据传入的数据更新 GUI，那么事件和绑定到可观察集合很好，但是如果我在回复之前确实需要用户的回答怎么办?

更糟糕的是，我想同步进行，因为我希望我的回复算法在一个地方，而不是划分为多个回调，并不清楚“谁打电话给谁”的责任。

简单地说，像

```
HandleMessage(Message msg){
    string reply;
    if (msg.type == 1) {
        reply = ...
    } else {
        string question = msg...
        reply = ShowModalDialog(question); // MVVM violation!
    }
    sender.Send(reply);
} 
```

但我不想从模型中调用视图或视图模型，因为模型需要可重用和可测试 - 我不想在每次测试运行时弹出对话框，这将违反 MVVM！没有事件（据我所知，它们只是单向的，并且没有反向通道来获取对事件来源的回复）或数据绑定，因为它是异步的。

这是可行的吗？这是我问了几个测试驱动开发传播者的问题，到目前为止，我还没有得到实际可用的答案。然而，在处理过程中需要一些额外的输入是相当普遍的。

谢谢！

编辑：这是应用程序逻辑，所以它显然属于模型，即使在这种情况下它不属于，我想知道在模型中的业务逻辑例程中间确实需要用户输入的情况下的解决方案.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-19T23:48:46.443

这是 MVVM 无法自行解决的问题之一。一种解决方案是使用服务来查询用户，然后让 ViewModel 使用该服务。

在我的项目中，我们使用[PRISM](http://codeplex.com/CompositeWPF)，它除了提供服务框架外，还提供了其他工具来简化 GUI 开发。

[这](http://msdn.microsoft.com/en-us/library/dd458913.aspx)是关于服务如何在 PRISM 中工作的文章。

因此，特别是在您的情况下，我将创建某种 IOC，向其注册查询服务，然后在 ViewModel 中传入 IOC，然后使用 IOC 获取查询服务，并使用它来查询用户。更多的工作？当然。但这意味着您可以通过在 IOC 中简单地替换查询服务来使用另一个实现进行测试。

MVVM + 服务 = 终极力量！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-19T22:34:33.583

我不知道这个想法是否严格遵守 MVVM 的原则，但是......我会将对话功能封装为服务（通过接口引用）。服务的实现将在 UI 层中，但出于测试目的，您只需“模拟”界面即可。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-19T20:51:00.483

实际上，它并不都属于应用程序逻辑。

似乎您有两种不同的“观点”。有第一个（通过网络传入的数据）和第二个（确认对话框）。

模型需要确定需要显示一个新视图，向视图发出信号以显示它，然后响应来自该视图的输入。

不要试图一步完成。

# c# - 关于角色和成员资格表如何建立关系的一些真正令人困惑的事情

> ID：884834
> 
> 赞同：1
> 
> 时间：2009-05-19T20:24:22.877
> 
> 标签：c#, asp.net, sql, asp.net-membership, roles

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-19T23:24:30.237

您是否查看过 aspnet_UsersInRoles 表。这是将用户链接到角色的表。RoleProvider 被设计为与 MembershipProvider 分开，因此您可以将它们放在单独的数据库中。此外，它允许您为一个应用程序名称设置角色，并在两个单独的应用程序中重复使用这些角色，每个应用程序对于成员资格提供程序都有不同的应用程序名称。不要陷入这样一种心态，即您必须为两个提供程序使用相同的应用程序名称，或者您的应用程序名称需要与正在运行的应用程序匹配。如果你不想，你根本不需要有任何名字。我希望这个对你有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-19T20:32:36.870

我很难听懂你说的...

无论如何......你似乎在看数据库太多了。您是否为会员提供者配置了 web.config，并且您是否能够使用 C# 而不是 SQL 查询来查询“会员资格”？

# asp.net - OnClientClick 和调用自定义 JavaScript 函数

> ID：884840
> 
> 赞同：0
> 
> 时间：2009-05-19T20:25:30.207
> 
> 标签：asp.net

我正在使用以下代码调用 javascript 函数，但从未评估 OnClientClick 表达式。

```
<asp:Button ID="btn1" UseSubmitBehavior="false" 
OnClientClick='moveComment(txtComment_<%# Eval("Container.DataItemIndex") %>)'
runat="server" Text="add comment"/> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-19T20:30:51.243

这是答案：

```
<asp:Button ID="btn1" UseSubmitBehavior="false" OnClientClick='<%#    
GetId(Container.DataItemIndex.ToString()) %>' runat="server" Text="add comment"/> 
```

以及服务器端的 GetId 方法：

protected string GetId(string index) { return "moveComment('txtComment_"+ index +"')"; }

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-19T12:28:52.887

```
OnClientClick='<%# "GetId(" +Container.DataItemIndex.ToString()+  "); " %>' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-19T20:53:08.547

我相信添加“return false;” 到您的 OnClientClick 表达式将解决您的问题。这将阻止按钮进行回发，但仍会执行您的客户端 javascript 函数。

```
<asp:Button ID="btn1" UseSubmitBehavior="false" OnClientClick='moveComment(txtComment_<%# Eval("Container.DataItemIndex") %>); return false;' runat="server" Text="add comment"/> 
```

# java - Java注解可以做到这一点吗？

> ID：884843
> 
> 赞同：3
> 
> 时间：2009-05-19T20:25:49.943
> 
> 标签：java, gwt, annotations

我正在寻找一种在我的应用程序中显示颠覆修订号和最后修改日期的解决方案（用 GWT 编写，因此反射不可用）。在 subversion 关键字中对修订进行编码不起作用，因为它仅适用于当前文件。使用注释有更好的解决方案吗？（例如，在编译期间执行的单独类，获取整个项目的最新修订号并将修订和最后修改日期注入源代码）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-29T22:26:36.217

注释并不是真的为此而设计的。作为构建的一部分，最容易做到这一点。

使用 Ant，您可以生成包含版本信息的文件，将其包含在应用程序的 JAR 中，将其作为资源加载到服务器上，并通过 RPC 将其提供给浏览器端代码。Ant 还可以在复制文件时在文件中进行字符串替换，您可以使用它在应用程序的 HTML 文件中包含版本号（那时不需要 RPC）。

不知道 Maven，但如果它不能做同样的事情，我会感到非常惊讶。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-19T20:43:01.983

我知道

```
@SvnRevision("$Id$")
public class Foo {
} 
```

然后你的类都用他们的版本注释。您需要确保注释被定义为具有运行时保留，以便可以在运行时对其进行查询。

**编辑**

好的，由于 SVN 没有该功能，我会编写一个 Maven 插件来模拟它。Maven 可以访问每个文件的 SCM 信息，因此在构建阶段您可以让它执行相同的关键字扩展。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-26T21:03:33.590

Subversion 仍然具有 $Id$ 功能，但需要使用文件上的 svn:keywords 属性显式启用它（将其设置为 'Id'）。

另见：[http ://svnbook.red-bean.com/en/1.5/svn.advanced.props.special.keywords.html](http://svnbook.red-bean.com/en/1.5/svn.advanced.props.special.keywords.html)

所以上面 Jherico 和@SvnRevision 的想法是可行的。

# wordpress - Nginx（作为 Apache 的前端）为 WP Super Cache 静态文件提供服务

> ID：884845
> 
> 赞同：1
> 
> 时间：2009-05-19T20:26:12.843
> 
> 标签：wordpress, nginx

我目前正在编写我的 Wordpress 博客，该博客托管在 VPS.NET VPS 上，使用 Nginx 作为 Apache 的前端来提供静态文件，而 Apache 负责 FastCGI 中的 PHP。这似乎工作得很好，但是我还没有设法让 Nginx 也提供 WP-SuperCache 文件，我希望获得最大性能（我现在不打算用 Nginx 完全替换 Apache，因为我有Virtualmin 许可证，它不支持 Nginx）。我已经尝试了很多在这里和那里找到的规则，但最后没有一个对我有用，或者我错过了一些东西。如果 Apache 停止了，其实我仍然可以直接通过 Nginx 获取图片、样式表和 javascript 到浏览器。但是，如果我尝试在 Apache 停止的情况下浏览博客（肯定由 WP-SuperCache 缓存的页面），我从 Nginx 得到的只是“

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-19T21:00:59.107

通过 Apache 运行 Nginx 似乎很愚蠢。

设置 Nginx 来提供 php 和动态页面本身，您将获得更快的服务，并且不会遇到 apache 死掉并让您的网络服务器（Nginx）挂起的问题。

如果您的管理面板不支持这一点，那么您可能首先应该只使用 apache。要么做一个，要么做另一个，两者都只是在问问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-27T13:52:26.027

Nginx 可以处理你的 fastCGI。通常，与 Nginx 捆绑在一起，Apache 所做的一切都是消耗资源。

关于 WP Super Cache，如果你创建一个新文件并粘贴它，它会同时给你，而且，当我们谈到它时，FURLs ......

```
# if the requested file exists, return it immediately
if (-f $request_filename) {
break;
}

set $supercache_file '';
set $supercache_uri $request_uri;

if ($request_method = POST) {
set $supercache_uri '';
}

# Using pretty permalinks, so bypass the cache for any query string
if ($query_string) {
set $supercache_uri '';
}

if ($http_cookie ~* "comment_author_|wordpress|wp-postpass_" ) {
set $supercache_uri '';
}

# if we haven't bypassed the cache, specify our supercache file
if ($supercache_uri ~ ^(.+)$) {
set $supercache_file /wp-content/cache/supercache/$http_host/$1index.html;
}

# only rewrite to the supercache file if it actually exists
if (-f $document_root$supercache_file) {
rewrite ^(.*)$ $supercache_file break;
}

# all other requests go to Wordpress
if (!-e $request_filename) {
rewrite . /index.php last;
} 
```

现在，转到您的虚拟主机文件，或者如果您捆绑您的站点，则转到 nginx.conf，并添加一行如 ..

```
# Wordpress WP Super Cache plugin and permalinks.
include /usr/local/nginx/conf/wordpress_params.super_cache; 
```

.. 其中 wordpress_params.super_cache 是您所说的我们创建的文件，并给出了相对于我所展示的路径。

然后重新启动 Nginx 并打开 WP Super Cache 插件，对于漂亮的链接，添加一个永久链接结构。

* * *

事实上，要正确安装 Nginx，尤其是使用 WordPress 和配置 fastCGI，需要了解很多。如果你愿意，这对你来说将是一个好的开始......

..[在 NGINX（FURL 和缓存）上设置 WordPress - VPS Bible Pt 13](http://www.guvnr.com/web/web-dev/configure-nginx-wordpress/)

关于。Virtualmin .. 我知道您想要一个 CP，但事实是，资源成本大于软件成本.. 加上用 CP 做事需要更长的时间。

我目前正在发布一个包含 21 部分的 VPS 管理系列，它解决了 Nginx CP 的缺失问题。坦率地说，这就是你所需要的。

给定一两个星期，我挑战你告诉我使用 CP 更快或更好:)

# javascript - javascript onclick 处理程序中的性能问题

> ID：884847
> 
> 赞同：1
> 
> 时间：2009-05-19T20:26:15.043
> 
> 标签：javascript, performance, browser, user-interface, cross-browser

我用java脚本编写了一个游戏，虽然它可以工作，但对多次点击的响应很慢。下面是我用来处理点击的代码的一个非常简化的版本，如果您等待的时间不够长，它仍然无法响应第二次点击 2。这是我需要接受的事情，还是有更快的方法为下一次点击做好准备？

顺便说一句，我使用 quirksmode recoding 竞赛中的 AddEvent 附加此功能。

```
var selected = false;
var z = null;
function handleClicks(evt) {
    evt = (evt)?evt:((window.event)?window.event:null);
    if (selected) {
        z.innerHTML = '<div class="rowbox a">a</div>';
        selected = false;
    } else {
        z.innerHTML = '<div class="rowbox selecteda">a</div>';
        selected = true;
    }
} 
```

可以在[http://www.omega-link.com/index.php?content=testgame看到实时代码](http://www.omega-link.com/index.php?content=testgame)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-19T20:40:06.030

您可以尝试仅更改类名而不是删除/添加 div 到 DOM（这就是 innerHTML 属性所做的）。

就像是：

```
var selected = false;
var z = null;

function handleClicks(evt) 
{
    var tmp;

    if(z == null)
       return;

    evt = (evt)?evt:((window.event)?window.event:null);
    tmp = z.firstChild;
    while((tmp != null) && (tmp.tagName != 'DIV'))
        tmp = tmp.firstChild;
    if(tmp != null)
    {
      if (selected) 
      {
        tmp.className = "rowbox a";
        selected = false;
      } else 
      {
        tmp.className = "rowbox selecteda";
        selected = true;
      }
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-19T20:40:46.340

我认为您的问题是第二次单击注册为 dblclick 事件，而不是单击事件。更改发生得很快，但除非您等待，否则第二次单击将被忽略。我建议更改为 mousedown 或 mouseup 事件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-19T20:33:53.577

我相信你的问题是改变`innerHTML`了 DOM，这是一个巨大的性能问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-19T20:41:43.700

是的，您可能想将 innerHTML 的性能与 document.createElement() 甚至：

```
el.style.display = 'block' // turn off display: none. 
```

当您进行 A/B 各种重构时，分析您的代码可能会有所帮助：

*   [http://www.mozilla.org/performance/jsprofiler.html](http://www.mozilla.org/performance/jsprofiler.html)
*   [http://developer.yahoo.com/yui/profiler/](http://developer.yahoo.com/yui/profiler/)
*   [http://weblogs.asp.net/stevewellens/archive/2009/03/26/ie-8-can-profile-javascript.aspx](http://weblogs.asp.net/stevewellens/archive/2009/03/26/ie-8-can-profile-javascript.aspx)

# c# - 验证有效时间的正则表达式

> ID：884848
> 
> 赞同：17
> 
> 时间：2009-05-19T20:26:23.827
> 
> 标签：c#, .net, regex

我需要一个正则表达式来验证时间。

有效值为 from`0:00`到`23:59`。

当时间小于时`10:00`它也应该支持一个字符的数字。

这些是有效值：

*   `9:00`
*   `09:00`

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-05-19T20:28:35.007

试试这个正则表达式：

```
^(?:[01]?[0-9]|2[0-3]):[0-5][0-9]$ 
```

或者更明显：

```
^(?:0?[0-9]|1[0-9]|2[0-3]):[0-5][0-9]$ 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-19T20:29:57.827

我不想窃取任何人的辛勤工作，但这[显然](http://alperguc.blogspot.com/2008/11/c-regex-time-validation-with-regular.html)正是您要寻找的。

```
using System.Text.RegularExpressions;

public bool IsValidTime(string thetime)
{
    Regex checktime =
        new Regex(@"^(20|21|22|23|[01]d|d)(([:][0-5]d){1,2})$");

    return checktime.IsMatch(thetime);
} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-19T20:48:04.373

我只是使用 DateTime.TryParse()。

```
DateTime time;
string timeStr = "23:00"

if(DateTime.TryParse(timeStr, out time))
{
  /* use time or timeStr for your bidding */
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2021-07-28T06:34:31.697

聚会很晚，但我创建了这个正则表达式，我发现它最适合 24H 格式（HH:mm:ss OR HH:mm OR H:mm:ss OR H:mm）：

```
private bool TimePatternValidation(string time)
    => new Regex(@"^(([0-1]?[0-9])|([2][0-3]))(:([0-5][0-9])){1,2}$").IsMatch(time); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-19T20:40:31.643

正则表达式`^(2[0-3]|[01]d)([:][0-5]d)$`应匹配 00:00 到 23:59。不懂 C#，因此不能给你相关的代码。

/RS

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-07-05T20:19:19.040

如果您想允许**军事**和**标准**使用**AM 和 PM**（可选且不敏感），那么您可能想尝试一下。

```
^(?:(?:0?[1-9]|1[0-2]):[0-5][0-9]\s?(?:[AP][Mm]?|[ap][m]?)?|(?:00?|1[3-9]|2[0-3]):[0-5][0-9])$ 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-07-27T10:39:42.417

```
[RegularExpression(@"^(0[1-9]|1[0-2]):[0-5][0-9]:[0-5][0-9] (am|pm|AM|PM)$", 
                   ErrorMessage = "Invalid Time.")] 
```

试试这个

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-02-13T14:50:19.120

更好的！！！

```
 public bool esvalida_la_hora(string thetime)
    {
        Regex checktime = new Regex("^(?:0?[0-9]|1[0-9]|2[0-3]):[0-5][0-9]$");
        if (!checktime.IsMatch(thetime))
            return false;

        if (thetime.Trim().Length < 5)
            thetime = thetime = "0" + thetime;

        string hh = thetime.Substring(0, 2);
        string mm = thetime.Substring(3, 2);

        int hh_i, mm_i;
        if ((int.TryParse(hh, out hh_i)) && (int.TryParse(mm, out mm_i)))
        {
            if ((hh_i >= 0 && hh_i <= 23) && (mm_i >= 0 && mm_i <= 59))
            {
                return true;
            }
        }
        return false;
    } 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-03-10T23:12:44.493

```
public bool IsTimeString(string ts)
{
    if (ts.Length == 5 && ts.Contains(':'))
    {
        int h;
        int m;
        return int.TryParse(ts.Substring(0, 2), out h) 
                            && int.TryParse(ts.Substring(3, 2), out m) 
                            && h >= 0 && h < 24 
                            && m >= 0 && m < 60;
     }
     else
         return false;
} 
```

# visual-studio - Visual Studio 加载项 QueryStatus() 调用

> ID：884850
> 
> 赞同：2
> 
> 时间：2009-05-19T20:27:18.457
> 
> 标签：visual-studio, add-in

我想知道是否有人能告诉我为什么`QueryStatus()`在评估命令执行时方法会被调用这么多次？在我的情况下，它被调用了多次（至少 9 次），至少有一个`vsCommandStatusTextWantedName`和更多`vsCommandStatusTextWantedNone`，但**从来**没有`vsCommandStatusTextWantedStatus`？

所以很多`QueryStatus()`电话只需要一个`Exec()`。为什么？

**示例详细信息**
我只有一个命令和一个与之相关的 CommandBarButton，它们位于“代码窗口”上下文菜单中。每当我在代码窗口中左键单击`QueryStatus()`时，最多应该调用（据我所知）三次。每`vsCommandStatusTextWanted`一次。为什么在这种情况下不是这种情况？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-19T20:59:36.503

一个 Exec() 部分很简单：只有在实际调用命令时才会调用它。QueryStatus() 将在不同时间调用以更新 UI 元素，如菜单项、工具栏按钮。由于状态可能因状态而异，例如：是否选择了文本、是否打开了项目、是否打开了文件等，因此需要经常查询它。

**编辑**：如果您有多个命令，则需要查询每个命令的状态，即使用户最终没有调用它们中的任何一个。如果您有可见的命令（在菜单上或工具栏中），则 UI 需要查询它们对当前环境的适用性（这不是静态的）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T00:28:41.680

VSPackages 实现 IOleCommandTarget 来处理来自环境的 QueryStatus 调用。插件实现了一个类似的接口 - IDTCommandTarget。但是 IOleCommandTarget 不使用 IDTCommandTarget 中的 vsCommandStatusTextWanted 枚举。

对于顶部菜单中的 VSPackage 命令，对于静态命令，每个命令都会调用一次 QueryStatus：查看是否启用了命令。
对于动态命令，每个命令都会调用 QueryStatus 两次：一次是查看命令是否应该可见，第二次是查看它是否已启用。

这是第一次调用 VSPackage IOleCommandTarget:QueryStatus 的本机调用堆栈：

```
msenv.dll!CVSCommandTarget::QueryStatusCmd()  + 0x9f9 bytes 
msenv.dll!CVSShellMenu::IsCommandVisible()  + 0x5f bytes    
msenv.dll!CVSShellMenu::IsCommandVisible()  + 0x10f bytes   
msenv.dll!CMsoButtonUser::FAutoVisible()  + 0x16 bytes  
msenv.dll!CVSShellMenu::IsMenuVisible()  + 0x21bf bytes 
msenv.dll!CMsoMenuUser::FAutoVisible()  + 0x3f bytes    
msenv.dll!TBC::FAutoVisible()  + 0x31 bytes 
msenv.dll!TB::CalcRectOrReflowToolbar()  + 0x351 bytes  
msenv.dll!TB::FSetBestRectEx()  - 0x5958d bytes 
msenv.dll!TB::FShowTbInternal()  + 0x13835a bytes   
msenv.dll!TB::FPlacePopup()  + 0x114 bytes  
msenv.dll!TBComponentPopup::ModalPopup()  + 0x93 bytes  
msenv.dll!TB::FPopup()  + 0x133 bytes   
msenv.dll!CVSShellMenu::ShowContextMenu()  + 0x172 bytes
 .... 
```

第二次调用的调用堆栈：

```
msenv.dll!CVSCommandTarget::QueryStatusCmd()  + 0x9f9 bytes 
msenv.dll!CVSShellMenu::IsCommandVisible()  + 0x5f bytes    
msenv.dll!CVSShellMenu::IsCommandVisible()  + 0x10f bytes   
msenv.dll!CMsoButtonUser::FAutoVisible()  + 0x16 bytes  
msenv.dll!CVSShellMenu::IsMenuVisible()  + 0x21bf bytes 
msenv.dll!CMsoMenuUser::FEnabled()  + 0xc5 bytes    
msenv.dll!TBC::FEnabled()  + 0x54 bytes 
msenv.dll!TBCM::FEnabled()  + 0x1b bytes    
msenv.dll!TBCM::FUpdate()  + 0x2e bytes 
msenv.dll!TB::CalcRectOrReflowToolbar()  + 0x689 bytes  
msenv.dll!TB::FSetBestRectEx()  - 0x5958d bytes 
msenv.dll!TB::FShowTbInternal()  + 0x13835a bytes   
msenv.dll!TB::FPlacePopup()  + 0x114 bytes  
msenv.dll!TBComponentPopup::ModalPopup()  + 0x93 bytes  
msenv.dll!TB::FPopup()  + 0x133 bytes   
msenv.dll!CVSShellMenu::ShowContextMenu()  + 0x172 bytes    
 .... 
```

我怀疑您的命令（或一般的 Addin 命令？）被视为动态的（带有动态文本），但无法猜测为什么单个命令会连续 9 次调用 QueryStatus 如果它没有出现在工具栏或顶级菜单（仅在上下文菜单中）。所以我可以看到 3 个 QueryStatus 调用：可见、已启用、获取文本。9 是 3 的倍数很有趣……

如果您没有为调试器设置符号服务器，我会对其进行设置，以便您可以检查 msenv.dll 调用以获取任何指示，就像我在上面对 VSPackage QueryStatus 调用所做的那样。

# asp.net-mvc - 如何在 ASP.NET MVC 中禁用会话状态？

> ID：884852
> 
> 赞同：77
> 
> 时间：2009-05-19T20:28:05.290
> 
> 标签：asp.net-mvc, session-state, tempdata

我想要一个非常轻量级的 ASP.NET MVC 站点，其中包括尽可能多地删除常用的 HttpModules 并禁用会话状态。但是，当我尝试执行此操作时，出现以下错误：

`The SessionStateTempDataProvider requires SessionState to be enabled.`

我在 web.config 中禁用了会话状态：

```
<sessionState mode="Off" /> 
```

我了解 ASP.NET MVC 对 TempData 使用会话状态，但我不需要/想要 TempData - 我只想禁用会话状态。帮助！

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-05-19T20:40:46.730

您可以制作自己的 ControllerFactory 和 DummyTempDataProvider。像这样的东西：

```
public class NoSessionControllerFactory : DefaultControllerFactory
{
  protected override IController GetControllerInstance(Type controllerType)
  {
    var controller = base.GetControllerInstance(controllerType);
    ((Controller) controller).TempDataProvider = new DummyTempDataProvider();
    return controller;
  }
}

public class DummyTempDataProvider : ITempDataProvider
{
  public IDictionary<string, object> LoadTempData(ControllerContext controllerContext)
  {
    return new Dictionary<string, object>();
  }

  public void SaveTempData(ControllerContext controllerContext, IDictionary<string, object> values)
  {
  }
} 
```

然后您只需要在应用程序启动时注册控制器工厂 - 例如您可以在 global.asax 中执行此操作：

```
ControllerBuilder.Current.SetControllerFactory(new NoSessionControllerFactory()); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-19T20:37:53.350

我找到了一种我不特别关心的方法：

**创建 NoTempDataProvider**

```
using System;
using System.Collections.Generic;
using System.Web.Mvc;

namespace Facebook.Sites.Desktop.Auth.Models
{
    public class NoTempDataProvider : ITempDataProvider
    {
        #region [ ITempDataProvider Members ]

        public IDictionary<String, Object> LoadTempData(ControllerContext controllerContext)
        {
            return new Dictionary<String, Object>();
        }

        public void SaveTempData(ControllerContext controllerContext, IDictionary<String, Object> values) { }

        #endregion
    }
} 
```

**手动覆盖控制器中的提供程序**

```
public class AuthController : Controller
{
    public AuthController()
    {
        this.TempDataProvider = new NoTempDataProvider();
    }
} 
```

我非常喜欢通过配置完全做到这一点的方法，但这目前有效。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-08-28T15:40:35.603

如果需要对简单字符串使用 TempData，可以使用 MvcFutures [http://aspnet.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=24471](http://aspnet.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=24471)中的 CookieTempDataProvider 。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-08-28T23:44:29.753

根据 Brad Wilson 的说法，这已在 MVC 2 Preview 1 中得到修复。请参见[此处](http://crinket.com/session-state-for-aspnet-mvc)和[此处](http://twitter.com/bradwilson/status/3614026482)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-05-02T22:35:45.857

现代解决方案：

> 在 ASP.NET 中，如果您不使用 Session 对象来存储任何数据，或者如果处理了任何 Session 事件（Session_OnStart 或 Session_OnEnd），则禁用会话状态。

因此，不使用 Session（或 TempData）会禁用 Session State。

[资源](https://support.microsoft.com/en-gb/help/306996/how-to-disable-asp-session-state-in-asp-net)

# c# - ServiceController.Stop() 后服务未完全停止

> ID：884853
> 
> 赞同：8
> 
> 时间：2009-05-19T20:28:31.030
> 
> 标签：c#, .net, sql-server, service

```
ServiceController serviceController = new ServiceController(someService);
serviceController.Stop();
serviceController.WaitForStopped();
DoSomething(); 
```

SomeService 在 sqlserver 文件上工作。DoSomething() 想要复制那个 SQL 文件。如果 SomeService 没有完全关闭它会抛出一个错误，因为数据库文件仍然被锁定。在上述代码中，我通过了 WaitForStopped() 方法，但服务直到 DoSomething() 之后才释放数据库文件，因此出现错误。

进行更多调查后，我发现在调用 DoSomething 方法之前，我看到服务控制器状态显示为已停止，但查看一些 ProcMon 日志，在我从 DoSomething 引发错误后，服务会释放数据库文件。

另外，如果我在 WaitForStopped 和 DoSomething 方法之间放置一个 Thread.Sleep ，比如说... 5 秒，数据库文件就会被释放，一切都很好。然而，这不是我正在寻找的担保解决方案。

有任何想法吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-10-20T20:55:24.200

Windows 服务是进程之上的一层；为了成为服务，应用程序必须连接到服务控制管理器并宣布哪些服务可用。此连接在 ADVAPI32.DLL 库中处理。一旦建立了这个连接，库就会维护一个线程等待来自服务控制管理器的命令，然后可以任意启动和停止服务。我不相信当最后一个服务终止时该进程需要退出。虽然这是通常发生的情况，但与服务控制管理器的链接结束（在最后一个服务进入“已停止”状态之后发生）可能在进程实际终止之前显着发生，释放它尚未明确释放的任何资源.

Windows 服务 API 包含可让您获取托管服务的进程的进程 ID 的功能。单个进程可以托管许多服务，因此当您感兴趣的服务终止时，该进程可能不会真正退出，但您应该安全使用 SQL Server。不幸的是，.NET Framework 没有公开此功能。但是，它确实将句柄暴露给它在内部用于 API 调用的服务，您可以使用它来进行自己的 API 调用。通过一点 P/Invoke，您可以获得 Windows Service 进程的进程 ID，并且从那里，如果您有必要的权限，您可以打开进程的句柄，可以用来等待它出口。

像这样的东西：

```
[DllImport("advapi32")]
static extern bool QueryServiceStatusEx(IntPtr hService, int InfoLevel, ref SERVICE_STATUS_PROCESS lpBuffer, int cbBufSize, out int pcbBytesNeeded);

const int SC_STATUS_PROCESS_INFO = 0;

[StructLayout(LayoutKind.Sequential)]
struct SERVICE_STATUS_PROCESS
{
  public int dwServiceType;
  public int dwCurrentState;
  public int dwControlsAccepted;
  public int dwWin32ExitCode;
  public int dwServiceSpecificExitCode;
  public int dwCheckPoint;
  public int dwWaitHint;
  public int dwProcessId;
  public int dwServiceFlags;
}

const int SERVICE_WIN32_OWN_PROCESS = 0x00000010;
const int SERVICE_INTERACTIVE_PROCESS = 0x00000100;

const int SERVICE_RUNS_IN_SYSTEM_PROCESS = 0x00000001;

public static void StopServiceAndWaitForExit(string serviceName)
{
  using (ServiceController controller = new ServiceController(serviceName))
  {
    SERVICE_STATUS_PROCESS ssp = new SERVICE_STATUS_PROCESS();
    int ignored;

    // Obtain information about the service, and specifically its hosting process,
    // from the Service Control Manager.
    if (!QueryServiceStatusEx(controller.ServiceHandle.DangerousGetHandle(), SC_STATUS_PROCESS_INFO, ref ssp, Marshal.SizeOf(ssp), out ignored))
      throw new Exception("Couldn't obtain service process information.");

    // A few quick sanity checks that what the caller wants is *possible*.
    if ((ssp.dwServiceType & ~SERVICE_INTERACTIVE_PROCESS) != SERVICE_WIN32_OWN_PROCESS)
      throw new Exception("Can't wait for the service's hosting process to exit because there may be multiple services in the process (dwServiceType is not SERVICE_WIN32_OWN_PROCESS");

    if ((ssp.dwServiceFlags & SERVICE_RUNS_IN_SYSTEM_PROCESS) != 0)
      throw new Exception("Can't wait for the service's hosting process to exit because the hosting process is a critical system process that will not exit (SERVICE_RUNS_IN_SYSTEM_PROCESS flag set)");

    if (ssp.dwProcessId == 0)
      throw new Exception("Can't wait for the service's hosting process to exit because the process ID is not known.");

    // Note: It is possible for the next line to throw an ArgumentException if the
    // Service Control Manager's information is out-of-date (e.g. due to the process
    // having *just* been terminated in Task Manager) and the process does not really
    // exist. This is a race condition. The exception is the desirable result in this
    // case.
    using (Process process = Process.GetProcessById(ssp.dwProcessId))
    {
      // EDIT: There is no need for waiting in a separate thread, because MSDN says "The handles are valid until closed, even after the process or thread they represent has been terminated." ( http://msdn.microsoft.com/en-us/library/windows/desktop/ms684868%28v=vs.85%29.aspx ), so to keep things in the same thread, the process HANDLE should be opened from the process id before the service is stopped, and the Wait should be done after that.

      // Response to EDIT: What you report is true, but the problem is that the handle isn't actually opened by Process.GetProcessById. It's only opened within the .WaitForExit method, which won't return until the wait is complete. Thus, if we try the wait on the current therad, we can't actually do anything until it's done, and if we defer the check until after the process has completed, it won't be possible to obtain a handle to it any more.

      // The actual wait, using process.WaitForExit, opens a handle with the SYNCHRONIZE
      // permission only and closes the handle before returning. As long as that handle
      // is open, the process can be monitored for termination, but if the process exits
      // before the handle is opened, it is no longer possible to open a handle to the
      // original process and, worse, though it exists only as a technicality, there is
      // a race condition in that another process could pop up with the same process ID.
      // As such, we definitely want the handle to be opened before we ask the service
      // to close, but since the handle's lifetime is only that of the call to WaitForExit
      // and while WaitForExit is blocking the thread we can't make calls into the SCM,
      // it would appear to be necessary to perform the wait on a separate thread.
      ProcessWaitForExitData threadData = new ProcessWaitForExitData();

      threadData.Process = process;

      Thread processWaitForExitThread = new Thread(ProcessWaitForExitThreadProc);

      processWaitForExitThread.IsBackground = Thread.CurrentThread.IsBackground;
      processWaitForExitThread.Start(threadData);

      // Now we ask the service to exit.
      controller.Stop();

      // Instead of waiting until the *service* is in the "stopped" state, here we
      // wait for its hosting process to go away. Of course, it's really that other
      // thread waiting for the process to go away, and then we wait for the thread
      // to go away.
      lock (threadData.Sync)
        while (!threadData.HasExited)
          Monitor.Wait(threadData.Sync);
    }
  }
}

class ProcessWaitForExitData
{
  public Process Process;
  public volatile bool HasExited;
  public object Sync = new object();
}

static void ProcessWaitForExitThreadProc(object state)
{
  ProcessWaitForExitData threadData = (ProcessWaitForExitData)state;

  try
  {
    threadData.Process.WaitForExit();
  }
  catch {}
  finally
  {
    lock (threadData.Sync)
    {
      threadData.HasExited = true;
      Monitor.PulseAll(threadData.Sync);
    }
  }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-19T21:00:01.277

一旦服务实现声称它已停止，ServiceController.WaitForStopped()/WaitForStatus() 将返回。这并不一定意味着该进程已释放其所有资源并已退出。我见过 SQL Server 以外的数据库也这样做。

如果您真的想确保数据库完全真正停止，您将不得不与数据库本身进行交互，获取进程 ID 并等待它退出，等待文件上的锁被释放，.. .

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-02-13T12:37:37.633

就我而言，我使用了互操作：

```
[StructLayout(LayoutKind.Sequential)]
public struct SC_HANDLE__
{
    public int unused;
}

[Flags]
public enum SERVICE_CONTROL : uint
{
    STOP = 0x00000001,
    PAUSE = 0x00000002,
    CONTINUE = 0x00000003,
    INTERROGATE = 0x00000004,
    SHUTDOWN = 0x00000005,
    PARAMCHANGE = 0x00000006,
    NETBINDADD = 0x00000007,
    NETBINDREMOVE = 0x00000008,
    NETBINDENABLE = 0x00000009,
    NETBINDDISABLE = 0x0000000A,
    DEVICEEVENT = 0x0000000B,
    HARDWAREPROFILECHANGE = 0x0000000C,
    POWEREVENT = 0x0000000D,
    SESSIONCHANGE = 0x0000000E
}

[StructLayout(LayoutKind.Sequential)]
public struct SERVICE_STATUS
{

    /// DWORD->unsigned int
    public uint dwServiceType;
    /// DWORD->unsigned int
    public uint dwCurrentState;
    /// DWORD->unsigned int
    public uint dwControlsAccepted;
    /// DWORD->unsigned int
    public uint dwWin32ExitCode;
    /// DWORD->unsigned int
    public uint dwServiceSpecificExitCode;
    /// DWORD->unsigned int
    public uint dwCheckPoint;
    /// DWORD->unsigned int
    public uint dwWaitHint;
}

public class NativeMethods
{
    public const int SC_MANAGER_ALL_ACCESS = (STANDARD_RIGHTS_REQUIRED
                | (SC_MANAGER_CONNECT
                | (SC_MANAGER_CREATE_SERVICE
                | (SC_MANAGER_ENUMERATE_SERVICE
                | (SC_MANAGER_LOCK
                | (SC_MANAGER_QUERY_LOCK_STATUS | SC_MANAGER_MODIFY_BOOT_CONFIG))))));

    /// STANDARD_RIGHTS_REQUIRED -> (0x000F0000L)
    public const int STANDARD_RIGHTS_REQUIRED = 983040;
    /// SC_MANAGER_CONNECT -> 0x0001
    public const int SC_MANAGER_CONNECT = 1;
    /// SC_MANAGER_CREATE_SERVICE -> 0x0002
    public const int SC_MANAGER_CREATE_SERVICE = 2;
    /// SC_MANAGER_ENUMERATE_SERVICE -> 0x0004
    public const int SC_MANAGER_ENUMERATE_SERVICE = 4;
    /// SC_MANAGER_LOCK -> 0x0008
    public const int SC_MANAGER_LOCK = 8;
    /// SC_MANAGER_QUERY_LOCK_STATUS -> 0x0010
    public const int SC_MANAGER_QUERY_LOCK_STATUS = 16;
    /// SC_MANAGER_MODIFY_BOOT_CONFIG -> 0x0020
    public const int SC_MANAGER_MODIFY_BOOT_CONFIG = 32;
    /// SERVICE_CONTROL_STOP -> 0x00000001
    public const int SERVICE_CONTROL_STOP = 1;
    /// SERVICE_QUERY_STATUS -> 0x0004
    public const int SERVICE_QUERY_STATUS = 4;
    public const int GENERIC_EXECUTE = 536870912;
    /// SERVICE_RUNNING -> 0x00000004
    public const int SERVICE_RUNNING = 4;

    [DllImport("advapi32.dll", SetLastError = true, CharSet = CharSet.Auto)]
    static extern IntPtr OpenService(IntPtr hSCManager, string lpServiceName, uint dwDesiredAccess);

    [DllImport("advapi32.dll", EntryPoint = "OpenSCManagerW")]
    public static extern IntPtr OpenSCManagerW(
        [In()] [MarshalAs(UnmanagedType.LPWStr)] string lpMachineName,
        [In()] [MarshalAs(UnmanagedType.LPWStr)] string lpDatabaseName,
        uint dwDesiredAccess);

    [DllImport("advapi32.dll", SetLastError = true)]
    [return: MarshalAs(UnmanagedType.Bool)]
    public static extern bool ControlService(IntPtr hService, SERVICE_CONTROL dwControl, ref SERVICE_STATUS lpServiceStatus);

    [DllImport("advapi32.dll", SetLastError = true)]
    [return: MarshalAs(UnmanagedType.Bool)]
    public static extern bool CloseServiceHandle(IntPtr hSCObject);

    [DllImport("advapi32.dll", EntryPoint = "QueryServiceStatus", CharSet = CharSet.Auto)]
    public static extern bool QueryServiceStatus(IntPtr hService, ref SERVICE_STATUS dwServiceStatus);

    [SecurityCritical]
    [HandleProcessCorruptedStateExceptions]
    public static void ServiceStop()
    {
        IntPtr manager = IntPtr.Zero;
        IntPtr service = IntPtr.Zero;
        SERVICE_STATUS status = new SERVICE_STATUS();

        if ((manager = OpenSCManagerW(null, null, SC_MANAGER_ALL_ACCESS)) != IntPtr.Zero)
        {
            if ((service = OpenService(manager, Resources.ServiceName, SC_MANAGER_ALL_ACCESS)) != IntPtr.Zero)
            {
                QueryServiceStatus(service, ref status);
            }

            if (status.dwCurrentState == SERVICE_RUNNING)
            {
                int i = 0;
                //not the best way, but WaitStatus didnt work correctly. 
                while (i++ < 10 && status.dwCurrentState != SERVICE_CONTROL_STOP)
                {
                    ControlService(service, SERVICE_CONTROL.STOP, ref status);
                    QueryServiceStatus(service, ref status);
                    Thread.Sleep(200);
                }

            }
        }

        if (manager != IntPtr.Zero)
        {
            var b = CloseServiceHandle(manager);
        }

        if (service != IntPtr.Zero)
        {
            var b = CloseServiceHandle(service);
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-19T20:41:01.363

当我停止一个依赖于另一个服务的服务时，我已经看到过这种情况，而第二个服务正在持有我什至不知道它正在使用的资源。你认为可能是这种情况吗？我知道 SQL 有很多不同的组件，但我还没有研究过是否有多个服务与之关联。

祝你好运！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-09-24T04:12:36.377

即使使用@Jonathan Gilbert 出色的答案，我仍然遇到服务进程停止后无法删除服务可执行文件的情况。我发现我还必须`process.Kill()`在这一切结束时调用以完全释放资源。

这是 Jonathan Gilbert 答案的一个版本，它添加了`Kill`、超时和更好的线程同步：

```
namespace System.ServiceProcess {
  public static class ExtensionMethods {
    [DllImport("advapi32")]
    static extern bool QueryServiceStatusEx(IntPtr hService, int InfoLevel, ref SERVICE_STATUS_PROCESS lpBuffer, int cbBufSize, out int pcbBytesNeeded);
    [StructLayout(LayoutKind.Sequential)] struct SERVICE_STATUS_PROCESS { public int dwServiceType; public int dwCurrentState; public int dwControlsAccepted; public int dwWin32ExitCode; public int dwServiceSpecificExitCode; public int dwCheckPoint; public int dwWaitHint; public int dwProcessId; public int dwServiceFlags; }
    const int SC_STATUS_PROCESS_INFO = 0, SERVICE_WIN32_OWN_PROCESS = 0x00000010, SERVICE_INTERACTIVE_PROCESS = 0x00000100, SERVICE_RUNS_IN_SYSTEM_PROCESS = 0x00000001;

    record ProcessWaitForExitData(int ProcessId, AutoResetEvent MWaitForThread, int TimeoutMilliseconds);

    // wait for the actual process that runs the service to stop
    public static void StopAndWaitForProcessToExit(this ServiceController controller, int timeoutMilliseconds=-1) {
      var processId = -1;

      try {
        var ssp = new SERVICE_STATUS_PROCESS();
        // check can't obtain service process informatio
        if (QueryServiceStatusEx(controller.ServiceHandle.DangerousGetHandle(), SC_STATUS_PROCESS_INFO, ref ssp, Marshal.SizeOf(ssp), out int ignored)
        // check can't wait for the service's hosting process to exit because there may be multiple services in the process (dwServiceType is not SERVICE_WIN32_OWN_PROCESS)
        && (ssp.dwServiceType & ~SERVICE_INTERACTIVE_PROCESS) == SERVICE_WIN32_OWN_PROCESS
        // check can't wait for the service's hosting process to exit because the hosting process is a critical system process that will not exit (SERVICE_RUNS_IN_SYSTEM_PROCESS flag set)");
        && (ssp.dwServiceFlags & SERVICE_RUNS_IN_SYSTEM_PROCESS) == 0
        // chec can't wait for the service's hosting process to exit because the process ID is not known.");
        && ssp.dwProcessId != 0) processId = ssp.dwProcessId;
      } catch (Exception) {
      }

      if (processId==-1) {
        controller.Stop(); // stop the service
        return; // we did all we can
      }

      // we need to call WaitForExit before stopping the service so we do it in a separate thread 
      var mWaitForThread = new AutoResetEvent(false);
      var processWaitForExitThread = new Thread(ProcessWaitForExitThreadProc) { IsBackground = Thread.CurrentThread.IsBackground };
      processWaitForExitThread.Start(new ProcessWaitForExitData(processId, mWaitForThread, timeoutMilliseconds));
      Task.Delay(5).Wait(); // let thread reach WaitForExit, is there a better way ?

      controller.Stop(); // stop the service
      mWaitForThread.WaitOne(); // wait for process to exit
    }

    static void ProcessWaitForExitThreadProc(object? state) {
      ProcessWaitForExitData threadData = (ProcessWaitForExitData)state!;
      try {
        using Process process = Process.GetProcessById(threadData.ProcessId);
        var stopwatch = Stopwatch.StartNew();
        process.WaitForExit(threadData.TimeoutMilliseconds);
        process.Kill(true); // free all process resources
        var killTimeout = threadData.TimeoutMilliseconds==-1 ? -1 : (int)Math.Max(threadData.TimeoutMilliseconds - stopwatch.ElapsedMilliseconds, 10);
        if (!process.WaitForExit(killTimeout)) throw new TimeoutException();
      }
      catch { }
      finally {
        threadData.MWaitForThread.Set();
      }
    }
  }
} 
```

要使用：

```
using ServiceController controller = new(serviceName);
controller.StopAndWaitForProcessToExit(timeoutMilliseconds); 
```

* * *

## 回答 #6

> 赞同：-5
> 
> 时间：2009-05-19T20:40:45.030

尝试使用 Environment.Exit(1);

# c# - 需要一个 .NET WinForms IP 地址控件

> ID：884857
> 
> 赞同：7
> 
> 时间：2009-05-19T20:28:38.610
> 
> 标签：c#, .net, .net-3.5, controls, ip-address

我需要一个功能强大、用户友好、外观专业的 .NET WinForms IP 地址控件，以便在我正在处理的项目中使用。这种控制至少应该支持 IPv4 寻址，理想情况下也应该支持 IPv6 寻址。我更喜欢使用 C# 源代码的免费控件，但不介意付费。

我正在使用 .NET 3.5 SP1，所以任何 .NET 2.0 及更高版本都应该足够了。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-19T20:30:17.750

多田。

[http://www.codeproject.com/KB/miscctrl/IpAddrCtrlLib.aspx](http://www.codeproject.com/KB/miscctrl/IpAddrCtrlLib.aspx)

此控件的最新版本可在此处找到（感谢 Pat）：

[http://code.google.com/p/ipaddresscontrollib/](http://code.google.com/p/ipaddresscontrollib/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-07-06T06:05:28.077

我发现了以下 ip 地址控制。真的很棒。 [http://sanity-free.org/127/an_ipaddress_control_the_win32_sysipaddress32_control_in_csharp.html](http://sanity-free.org/127/an_ipaddress_control_the_win32_sysipaddress32_control_in_csharp.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-11-03T16:41:39.237

[在http://code.google.com/p/ipaddresscontrollib/](http://code.google.com/p/ipaddresscontrollib/)获取最新代码

# c# - 如何读取多个文本文件并将它们保存到一个文本文件中？

> ID：884884
> 
> 赞同：1
> 
> 时间：2009-05-19T20:36:36.863
> 
> 标签：c#, text, file

就我而言，我有五个巨大的文本文件，我必须将它们嵌入到一个文本文件中。

我尝试使用 StreamReader()，但我不知道如何让它再读取一个文件，我是否必须分配另一个变量？

展示一个例子将不胜感激。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-19T20:42:51.217

**新答案**

（请参阅下面的垃圾原始答案的解释。）

```
static void CopyFiles(string dest, params string[] sources)
{
    using (TextWriter writer = File.CreateText(dest))
    {
        // Somewhat arbitrary limit, but it won't go on the large object heap
        char[] buffer = new char[16 * 1024]; 
        foreach (string source in sources)
        {
            using (TextReader reader = File.OpenText(source))
            {
                int charsRead;
                while ((charsRead = reader.Read(buffer, 0, buffer.Length)) > 0)
                {
                    writer.Write(buffer, 0, charsRead);
                }
            }
        }
    }
} 
```

这个新答案很像马丁的方法，除了：

*   它读入一个较小的缓冲区；16K 在几乎所有情况下都是可以接受的，并且不会出现在大对象堆上（不会被压缩）
*   它读取*文本*数据而不是*二进制*数据，原因有两个：
    *   可以轻松修改代码以从一种编码转换为另一种编码
    *   如果每个输入文件都包含一个字节顺序标记，则阅读器将跳过该标记，而不是在输入文件边界处散布在输出文件中的字节顺序标记结束

**原始答案**

Martin Stettner 在下面的答案中指出了一个问题 - 如果第一个文件没有换行符结束，它仍然会在输出文件中创建一个换行符。此外，它会将换行符转换为“\r\n”，即使它们以前只是“\r”或“\n”。最后，它毫无意义地冒着使用大量数据来排长队的风险。

就像是：

```
static void CopyFiles(string dest, params string[] sources)
{
    using (TextWriter writer = File.CreateText(dest))
    {
        foreach (string source in sources)
        {
            using (TextReader reader = File.OpenText(source))
            {
                string line;
                while ((line = reader.ReadLine()) != null)
                {
                    writer.WriteLine(line);
                }
            }
        }
    }
} 
```

请注意，这是逐行读取的，以避免一次读取过多的内存。如果您乐于将每个文件完全读入内存（一次仍然是一个），则可以使其更简单：

```
static void CopyFiles(string dest, params string[] sources)
{
    using (TextWriter writer = File.CreateText(dest))
    {
        foreach (string source in sources)
        {
            string text = File.ReadAllText(source);
            writer.Write(text);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-19T22:18:05.660

**编辑**：

正如 Jon Skeet 所指出的，文本文件的处理方式通常与二进制文件不同。

我只是留下这个答案，因为如果您有非常大的文件并且不关心编码问题（例如不同的输入文件具有不同的编码或输出文件中有多个[字节顺序标记](http://en.wikipedia.org/wiki/Byte-order_mark)），它可能会更高性能：

```
public void CopyFiles(string destPath, string[] sourcePaths) {
  byte[] buffer = new byte[10 * 1024 * 1024]; // Just allocate a buffer as big as you can afford
  using (var destStream= = new FileStream(destPath, FileMode.Create) {
    foreach (var sourcePath in sourcePaths) {
      int read;
      using (var sourceStream = FileStream.Create(sourcePath, FileMode.Open) {
        while ((read = sourceStream.Read(buffer, 0, 10*1024*1024)) != 0)
          destStream.Write(buffer, 0, read);
      }
    }
  }
} 
```

# networking - 与 WIndows 2008 和 UAC 的网络共享

> ID：884894
> 
> 赞同：1
> 
> 时间：2009-05-19T20:38:20.900
> 
> 标签：networking, uac

我正在尝试在 Window Server 2008 上安装期间创建网络共享，但我遇到了 UAC 问题。似乎即使我在安装过程中以管理员身份运行，安装程序运行的批处理文件也无法创建共享。有没有办法做到这一点？

# c# - 媒体文件元数据的 C# 包装器

> ID：884897
> 
> 赞同：2
> 
> 时间：2009-05-19T20:39:53.720
> 
> 标签：c#, file, metadata, media

我正在寻找一个很好的包装器来提取依赖于文件类型的媒体文件属性。我正在创建一个可以处理视频、音频、图像等的通用媒体库。它们不仅仅是 .wmv 或 .mp3，我希望能够支持各种格式并且不想将自己放入 sdk像 WMP SDK 似乎只支持 MS 编解码器。我在开发中但还不太成熟的 VLC wrpper 上看到了一些小文章。

所以，基本上我希望能够指向一个文件并提取它是什么。音乐、图像、视频，然后在分辨率、fps、比特率、编解码器（如果可能）等基础上获取元数据，等等是艺术家、专辑歌曲，我意识到这并不总是可能的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-19T23:40:45.400

试试[MediaInfo](http://mediainfo.sourceforge.net/en)，应该做你想做的事。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-19T21:01:28.763

您可以使用为 Windows 桌面搜索设计的[IFilter](http://msdn.microsoft.com/en-us/library/ms691105(VS.85,loband).aspx)接口，已经有 MP3、WMV、JPEG 接口的实现。
您将需要充当 IFilter 主机加载 IFilter 实现并向它们提供文件，这不简单但也不太复杂。

# c# - Linq 在自动同步的主键字段上插入

> ID：884898
> 
> 赞同：4
> 
> 时间：2009-05-19T20:39:56.857
> 
> 标签：c#, sql-server, linq, guid

我或多或少想做这个问题所暗示的事情。 [如何在 LINQ-To-SQL (IDENTITY INSERT) 中手动设置身份字段](https://stackoverflow.com/questions/507515/how-do-i-manually-set-an-identity-field-in-linq-to-sql-identity-insert)

不过，我想解释一下。我有一个客户数据库。我从这里加载 Linq 对象并通过 WCF 发送它们。另一方面，我将它们附加到数据上下文并将它们发布到表中。问题是，他们将设置他们的 Guid 列。此列在 DBML 中标记为 AutoSync。所以在插入的情况下，Linq 强制我使用新值。我希望它在我需要的时候保持我的价值。

**更新 1**

基本上我想以编程方式动态翻转 AutoSync 和 IsDbGenerated 设置。

```
[Column(Storage="_cName", 
        AutoSync=AutoSync.OnInsert, 
        DbType="UniqueIdentifier NOT NULL", 
        IsPrimaryKey=true, IsDbGenerated=true)] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T18:23:04.347

让我重新表述一下这个问题：您想在两侧使用相同的对象定义，但一方面您希望生成标识符，而另一方面您希望插入它？我知道的唯一方法是使用基于 XML 的元数据而不是基于属性的元数据。不幸的是，据我所知，可视 DBML 设计器不支持 XML 元数据。但是，您可以使用 SqlMetal 工具生成 XML，然后修改文件以供 Web 服务的另一端使用。

您可以在此处开始使用 SqlMetal：http: [//msdn.microsoft.com/en-us/library/bb386987.aspx](http://msdn.microsoft.com/en-us/library/bb386987.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T19:10:04.423

这绝对是您需要查看的 IsDbGenerated 属性，而不是 AutoSync。

我看到您描述了一种要在应用程序中设置 ID 的场景。实际上是否存在另一种情况，您需要它由数据库自动生成？如果没有，您可以设置 IsDbGenerated = false，如果/当您还没有来自客户端的 ID 时，您可以在 WCF 服务中使用 Guid.NewGuid() 填充。

使用 rowguid 而不是标识列的优点之一是您可以将特定值插入 rowguid 列，但您不必这样做。您可以使用 DEFAULT NEWID() 将该列保留为 rowguid，但在您的服务中设置 IsDbGenerated = false，只要您记得实际填充 ID，它仍然可以工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T15:23:50.603

如果不使用反射，您将无法动态更改属性。您可以通过手动编码您的 linq 以另一种方式执行此操作。我不建议即时更改属性，它们是设计属性，并且可能会出现无法预料的后果来改变它。

# linux - 这些输出是什么意思？

> ID：884908
> 
> 赞同：1
> 
> 时间：2009-05-19T20:42:15.370
> 
> 标签：linux, bash

特别是最后两个分别带有'-'和'+'，这到底是什么意思？

```
[1]   Done                    php start.php bots/admin32.bot.php

[2]   Done                    php start.php bots/admin36.bot.php

[3]   Done                    php start.php bots/admin10.bot.php

[4]   Done                    php start.php bots/admin11.bot.php

[5]   Done                    php start.php bots/admin13.bot.php

[6]   Done                    php start.php bots/admin3.bot.php

[7]-  Done                    php start.php bots/admin4.bot.php

[8]+  Done                    php start.php bots/admin7.bot.php

[root@www2 robot]# 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-19T20:52:30.090

来自[Bash 参考手册](http://www.gnu.org/software/bash/manual/bashref.html#Job-Control-Basics)，

> 作业号`n`可以称为“<code>%n”。符号 '<code>%%' 和 '<code>%+' 指的是 shell 对当前作业的概念，它是最后一个在前台停止或在后台启动的作业。单个“<code>%”（没有随附的作业规范）也指当前作业。可以使用“<code>%-”引用之前的作业。如果只有一个作业，'<code>%+' 和 '<code>%-' 都可以用来指代那个作业。在与作业有关的输出中（例如，jobs 命令的输出），当前作业总是用“<code>+”标记，而前一个作业用“<code>-”标记。

在启动和停止作业时的 Bash 输出中，

> `[n]+` *地位*

意思是“工作`%n`（又名工作`%+`）现在是*状态*”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-19T20:46:24.253

我认为您的命令包含字符`&`，这导致命令在后台运行。当命令完成时，它会打印此输出。

例子：

```
$ echo 1 &
[1] 16021
$
[1]+  Done                    echo 1 
```

为防止这种情况发生，请引用该`&`字符。在您的情况下，它可能是 URL 的一部分，因此您可以使用：

```
$ wget "http://www.example.com/index.php?a=1&b=2" 
```

至于`+`和`-`标志，它们分别指的是当前和以前的工作。有关更多信息，请参阅[bash 中的作业控制页面。](http://tiswww.case.edu/php/chet/bash/bashref.html#SEC91)

# vb.net - 为什么 MemoryStream 数据没有从内存中释放

> ID：884910
> 
> 赞同：0
> 
> 时间：2009-05-19T20:42:37.037
> 
> 标签：vb.net, memory-management, memorystream

下面的代码是否需要做一些事情来释放它使用的内存？

```
 Dim objImage As MemoryStream
  Dim objwebClient As WebClient
  Dim sURL As String = Trim(m_StationInterface.PicLocation)

  objwebClient = New WebClient
  objImage = New MemoryStream(objwebClient.DownloadData(sURL))
  m_imgLiftingEye.Image = Image.FromStream(objImage) 
```

该代码位于一个不应被丢弃的弹出表单上。每次弹出时都会将新图像加载到表单上。但是，每次通过该代码块时，应用程序的进程大小都会继续增长。

我试过 objImage.Close() 和 .Flush()，objWebClient.Dispose()。每次调用后，进程大小仍会增长 4mb。就像旧图像被保存在记忆中一样。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-19T20:55:27.603

[Image](http://msdn.microsoft.com/en-us/library/system.drawing.image_methods.aspx)实现了 IDisposable，因此您应该在将旧图像替换为新图像之前将其处理掉。

类似的东西（请耐心等待，我有一段时间没有使用 VB）：

```
Dim objImage As MemoryStream
Dim objwebClient As WebClient
Dim sURL As String = Trim(m_StationInterface.PicLocation)

objwebClient = New WebClient
objImage = New MemoryStream(objwebClient.DownloadData(sURL))

If m_imgLiftingEye.Image Is Not Nothing Then
    m_imgLiftingEye.Image.Dispose()
End If
m_imgLiftingEye.Image = Image.FromStream(objImage) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-19T20:50:02.763

MemoryStream 实现了 IDisposable 接口，因此您应该在使用完毕后对该对象调用 Dispose：

```
objImage = New MemoryStream(objwebClient.DownloadData(sURL))
m_imgLiftingEye.Image = Image.FromStream(objImage)
objImage.Dispose() 
```

我猜你的结论是对的；图像（在内存流中）确实保留在内存中。

更新：正如 Marc 指出的那样，Image.FromStream 要求流在图像的生命周期内保持打开状态。为了解决这个问题，应该在与图像相同的范围内声明 MemoryStream 变量（作为表单中的字段）。加载图像时，首先应该检查 MemoryStream 是否已经打开，如果是，则在将变量用于新流之前关闭并释放它（假设我们将其称为 m_imageStream）。由于图像还实现了 IDisposable，因此该图像也是如此：

```
If Not m_imageStream Is Nothing Then
    m_imageStream.Dispose()
End If

If m_imgLiftingEye.Image Is Not Nothing Then
    m_imgLiftingEye.Image.Dispose()
End If

m_imageStream = New MemoryStream(objwebClient.DownloadData(sURL))
m_imgLiftingEye.Image = Image.FromStream(m_imageStream) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-19T20:54:41.617

试试这个：

```
Function GetImage() As Image
    Using wc As New WebClient(), _
          ms As New MemoryStream(wc.DownloadData(m_StationInterface.PicLocation.Trim())

        GetImage = Image.FromStream(ms).Clone()
    End Using
End Function 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-19T21:12:33.873

我知道我已经给出了一个答案，但从那以后我一直在想......

你说这个表格永远不应该被处理掉。在那种情况下，这个图像加载到底是什么时候发生的？我之前的回答假设它是在表单显示事件期间。但是，如果它在表单[加载](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.load.aspx)事件期间，它应该只发生一次。

也就是说，除非创建了多个表单实例。如果是这种情况，并且以前的表单没有被重用，那么您最终会在内存中加载相同表单的多个副本，每个副本都有自己的图像副本。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-19T20:46:29.200

你可以试试

```
set objImage = nothing
set objwebClient = nothing 
```

通常，与 ADO 一样，如果您没有将其显式设置为空，则它不会被正确释放。

# windows-mobile - 有没有办法以 1024 * 600 的分辨率运行 Windows CE 6.0 模拟器？

> ID：884916
> 
> 赞同：0
> 
> 时间：2009-05-19T20:44:11.917
> 
> 标签：windows-mobile, windows-ce, emulation

我们正在为尚无硬件的 Windows CE 6.0 创建一个嵌入式应用程序。我们希望能够以 1024 * 600 的分辨率在仿真模式下运行，因为这是我们将使用的硬件的屏幕分辨率。

Windows CE 6.0 模拟器支持的最高分辨率似乎是 800 * 600。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-19T21:29:47.020

不幸的是，没有——或者至少不容易。模拟器的视频驱动程序没有足够的内存以 1024x600 运行。

*可能*会改变这一点（我说可能是因为我从未尝试过）。您有模拟器显示驱动程序的显示驱动程序 (%WINCEROOT%\PLATFORM\DEVICEEMULATOR\src\drivers\display\lcd)，它看起来像 s3c2410x_lcd.cpp 在第 260 行左右设置了显示大小。

这里的问题是模拟器外壳应用程序是否限制了您可以在此处传递的大小，或者它是否有一些硬编码的限制？我不知道答案，但你确实有所有的工具来解决这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T23:13:04.743

我将 OAL 中的引导参数修改为 1024x600，以便 LCD 驱动程序在 Chris 建议修改的行中读取这些值，但是当它运行时我会遇到大量异常。我尝试增加 LCD 和 OAL 代码中的一些缓冲区，但没有骰子。设备模拟器外壳似乎对视频内存有 1 MB 的限制。如果您尝试将其配置为 800x600x32，您会看到这一点。

那么这个 1 MB 的限制真的是在设备模拟器中还是在其中运行的操作系统中？有人对我如何确定这一点有任何建议吗？

如果您不太关心颜色深度，另一种解决方案可能是尝试实现 8bpp。s3c2410x_lcd.h 中有一些定义表明支持 8bpp，但如果未指定 16、24 或 32，OAL 默认为 16bpp。也许我明天会试一试。

# mysql - mysqlimport 和双引号

> ID：884920
> 
> 赞同：1
> 
> 时间：2009-05-19T20:45:39.357
> 
> 标签：mysql, mysqlimport

我们有一个大的制表符分隔的文本文件（大约 120,000 条记录，50MB），我们正在尝试使用 mysqlimport 将其推入 MySQL。有些字段用双引号括起来，有些则没有。我们正在使用`fields-optionally-enclosed-by='\"'`开关，但问题是某些字段值本身包含双引号（表示英寸），因此分隔的字段值可能是“ABCDEF19”。有意义吗？

我们无法控制文件的来源，因此我们无法更改那里的格式。我尝试删除`fields-optionally-enclosed-by`开关，但随后导入了围绕值的双引号。

他在值中带有引号的记录变得严重混乱。有没有办法告诉 mysqlimport 某些字段可选用引号括起来，但仍可能包含引号？我们认为也许是全局搜索和替换来逃避字段值中的双引号？或者有什么其他建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-19T21:08:56.407

您可以使用引号导入它（fields-optional-enclosed-by 开关已删除），然后运行检查值是否在开头和结尾有双引号（假设所有值的开头都没有英寸）然后截断开头和结尾的 1 个字符以删除您从导入中获得的额外引号。

编辑：阅读kekoav的回复后，我必须同意，如果您能够在导入之前操作文件，那将是一个更明智的选择，但如果您之后被迫删除引号，您可以使用这样的东西：

```
UPDATE table 
SET column = 
IF(
STRCMP(LEFT(table.column,1),'"'),
MID(table.column,2,(LENGTH(table.column)-2)),
table.column
) 
```

对于“表”中的每个“列”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-19T21:09:56.890

如果您的数据在字段引用正文中包含引号而没有以某种方式分隔，那么您就有问题了。您不能保证 mysqlimport 会正确执行此操作。

在尝试以这种方式插入数据之前先对数据进行按摩。

幸运的是，它是制表符分隔的，因此您可以运行正则表达式以用分隔版本替换引号，然后告诉 mysqlimport 分隔符。

# javascript - Mozilla Prism：禁用弹出窗口拦截器

> ID：884926
> 
> 赞同：0
> 
> 时间：2009-05-19T20:46:34.393
> 
> 标签：javascript, prism, mozilla-prism

我正在使用 Mozilla Prism 开发一个应用程序。不幸的是，Prism 已激活其弹出窗口阻止程序。

我试图通过插入一行来禁用它

> user_pref("privacy.popups.policy", "1");

或者

> `user_pref("dom.disable_open_during_load", false);`

进入位于 Prism 应用程序目录中的 webapp.js。但是，这不起作用，弹出窗口仍然不起作用。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-03-04T22:21:07.427

有一个关于这个的错误你可以在这里投票/评论。

[https://bugzilla.mozilla.org/show_bug.cgi?id=503841](https://bugzilla.mozilla.org/show_bug.cgi?id=503841)

亚当

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-03-24T18:05:47.903

我在**prefs.js**中添加了以下几行

*对于 Win XP：* /Documents and Settings/[username]/Application Data/Prism/[app name]/Profiles/[prism profile name]/

*对于 Vista：* /Users/[用户名]/AppData/Roaming/Prism/[应用程序名称]/Profiles/[prism 配置文件名称]/

```
user_pref("dom.disable_open_during_load", false);
user_pref("capability.policy.default.Window.open", "allAccess"); 
```

**确保在进行这些更改之前关闭您的 Prism 应用程序，**因为它会在关闭时覆盖 prefs.js，从而清除您的更改。

最后 - 我可以使用 Gmail 创建事件按钮从我的 Gmail Prism 应用程序创建事件。

# security - 网站登录：如何将用户凭据发送到服务器进行验证？

> ID：884927
> 
> 赞同：3
> 
> 时间：2009-05-19T20:46:36.157
> 
> 标签：security, encryption, login, passwords

我正在开发一个远程客户端需要登录到网络服务器的项目。我不是在寻找任何特定语言的示例。只是所涉及的安全问题的一般概念。

基本问题是：
**如何将用户凭据传递给网络服务器进行验证？**

我正在描绘您的典型网站登录。一个字段用于用户名，另一个字段用于密码。您输入两者并单击“登录”。接下来发生什么？

我可以想象几个场景：

1.  凭证以纯文本形式发送到服务器。服务器端脚本创建密码的散列并将其与存储的用户散列进行比较。
2.  凭证在本地加密，结果发送到服务器。服务器解密凭据并继续 #1
3.  我还没有想到什么？我是新手。对我轻点！

选项 #1 让我觉得很弱，因为凭据是通过 Internet 以纯文本形式发送的。

我认为选项#2 并不比选项#1 好多少。如果有人截获了加密的凭据，他们能否再次将这些凭据发送到服务器，并且仍然设法登录？

任何见解都值得赞赏。

**编辑：** “相关”侧边栏提出[了这个问题](https://stackoverflow.com/questions/610229/login-protocol)，其中提到了在密码中添加了盐的客户端/服务器握手。这是正确的方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-19T20:52:02.697

选项 1 是迄今为止的默认值。明文的弱点通常可以通过在登录期间强制执行 SSL 来克服，这样密码在传输过程中至少会被加密。

**编辑：**我建议您遵循该问题的公认答案。

不要忘记为您的请求提供[随机数。](http://en.wikipedia.org/wiki/Cryptographic_nonce)这将有助于保护您免受重放攻击。

**编辑第二个：**韦恩深思熟虑地提到你应该在散列之前对你的密码[加盐。](https://stackoverflow.com/questions/674904/salting-your-password-best-practices)以下是一些基本提示：

1.  你的盐是前缀、后缀还是中缀都没关系
2.  你的盐应该是大的、随机的和复杂的。
3.  您的盐值应该是唯一的。盐本身不需要加密。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-19T20:53:02.540

为什么不使用 SSL 通信？能够观察对话让我深入了解您的应用程序。加密整个通信，而不仅仅是凭据。

编辑：始终使用盐作为本地存储的哈希。Windows 在暴力破解本地哈希密码方面继续失败，因为默认情况下它们不加盐。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-19T20:57:21.453

最简单的答案是为您的服务器获取 SSL 证书。真的没有理由在这个特定的应用程序中创建自己的加密技术。正如您所指出的，如果连接未加密，则无论客户端或服务器是否正在执行密码加密，您都会让自己受到中间人攻击。加密连接，您不必担心。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-19T20:54:56.560

在客户端，您只有一个可以呈现 HTML 和提交表单的浏览器。谁来加密东西？

以纯文本形式发送登录名和密码（如果您有疑虑，请使用 SSL）。在服务器端，你可以用它做任何你想做的事情（最好是哈希和盐密码，然后再将它们存储到数据库中）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-21T19:16:01.197

您可能还想考虑使用哈希算法的多次迭代，1000 次迭代会很好地减慢速度并使彩虹表更难创建

# web-services - 两足 OAuth - 寻找信息

> ID：884928
> 
> 赞同：26
> 
> 时间：2009-05-19T20:46:56.513
> 
> 标签：web-services, rest, oauth

我想在我们的基础架构上实现一个新的基于 REST 的[API ，而](http://en.wikipedia.org/wiki/Application_programming_interface)[OAuth](http://en.wikipedia.org/wiki/OAuth)似乎是要走的路。

对于我们的实现，首先只有服务器到服务器的访问，这将是完全不受限制的。我相信这被称为两条腿授权。

稍后，我们希望允许浏览器使用 API，这将使我们的授权变成三足。

是否有一个很好的起点来实施这一点？我们如何才能完全授权服务器并为每个用户添加受限授权？

OAuth 规范在这些场景中并没有真正的帮助，但我相信这意味着我们需要为服务器到服务器的访问创建一个永不过期的会话，然后为仅限用户的 API 添加具有有限访问权限的正常会话。

我希望找到更多信息的起点，让我知道！

OAuth 适合我吗？我只是在寻找一个经过身份验证的请求系统，并且这种场景中只存在消费者和服务提供者。终端用户不进来玩！

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-06-06T07:02:21.787

是的，OAuth 可能适合你。

实际上有两种 OAuth 规范，三足版和两足版。三足版是最受关注的，*不是*你想用的。

好消息是 2-legged 版本完全符合您的要求，它允许应用程序通过共享密钥授予对另一个应用程序的访问权限（非常类似于 Amazon 的 Web 服务模型，您将使用 HMAC-SHA1 签名方法）或通过公钥/私钥系统（使用签名方法：RSA-SHA1）。坏消息是，它的支持还不如 3-legged 版本，所以你现在可能需要做更多的工作。

基本上，2-legged OAuth 只是指定了一种“签名”（计算散列）几个字段的方法，这些字段包括当前日期、一个称为“nonce”的随机数以及您的请求参数。这使得模拟对您的 Web 服务的请求变得*非常困难。*

OAuth 正在缓慢但肯定地成为这类事情的公认标准——如果你接受它，从长远来看，你会得到最好的结果，因为人们可以利用各种可用的库来做到这一点。

它比您最初想要的要复杂得多 - 但好消息是很多人在它上面花了很多时间，所以您知道您没有忘记任何东西。一个很好的例子是，最近 Twitter 发现社区目前正在努力弥补的 OAuth 安全漏洞。如果您发明了自己的系统，那么您必须自己解决所有这些问题。

祝你好运！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-19T21:02:21.240

请记住区分身份验证和授权。在某些地方，我相信 OP 将两者混合在一起。

例如，一旦服务器对某人进行身份验证，它通常会显式或隐式（使用 cookie）提供身份验证令牌，以便后续请求已经获得授权。

凭据的持续时间取决于服务器。*计划*凭据将在某个时候超时是明智的。只需让客户端服务器准备好在收到“授权过期”错误响应时重新验证自己。

您不想尝试提供“永不过期”的会话，因为：

1.  一切都会在某个时候到期。例如，如果客户端服务器断电或重新启动，它如何能够再次开始访问应用程序？

2.  你正在创建一个不灵活的系统。他们往往更频繁地打破。

3.  由于您知道将来要添加其他类型的登录，而不是两种类型的登录（服务器客户端和浏览器客户端），因此现在只进行一种登录。客户端服务器的额外工作将是实现“必要时重新登录”功能。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-10T20:49:34.433

OAuth 最终将难以满足我们的需求。我决定采用 Amazon S3 的身份验证方案，仅仅是因为它更适合我们的模型。

感谢您帮助找到答案..

# c - 从 TCP 套接字进行拼接时，Linux 的 splice(2) 是否有效？

> ID：884934
> 
> 赞同：11
> 
> 时间：2009-05-19T20:48:51.253
> 
> 标签：c, linux, pipe

我一直在编写一个有趣的小程序，在 Linux 上用 C 语言通过 TCP 传输文件。程序从套接字读取文件并将其写入文件（反之亦然）。我最初使用读/写并且程序运行正常，但后来我了解了[拼接](http://manpages.courier-mta.org/htmlman2/splice.2.html)并想尝试一下。

我用 splice 编写的代码在从 stdin（重定向文件）读取并写入 TCP 套接字时工作得很好，但在从套接字读取和写入 stdout 时，由于 splice 将 errno 设置为 EINVAL 会立即失败。手册页指出，当两个描述符都不是管道（不是这种情况）时设置了 EINVAL，为无法查找的流传递了偏移量（没有传递偏移量），或者文件系统不支持拼接，这导致我我的问题：这是否意味着 TCP 可以*从*管道拼接，但不能*拼接*？

我包括下面的代码（减去错误处理代码），希望我做错了什么。它很大程度上基于[Wikipedia 的 splice 示例](http://en.wikipedia.org/wiki/Splice_(system_call)#Example)。

```
static void splice_all(int from, int to, long long bytes)
{
    long long bytes_remaining;
    long result;

    bytes_remaining = bytes;
    while (bytes_remaining > 0) {
        result = splice(
            from, NULL,
            to, NULL,
            bytes_remaining,
            SPLICE_F_MOVE | SPLICE_F_MORE
        );

        if (result == -1)
            die("splice_all: splice");

        bytes_remaining -= result;
    }
}

static void transfer(int from, int to, long long bytes)
{
    int result;
    int pipes[2];

    result = pipe(pipes);

    if (result == -1)
        die("transfer: pipe");

    splice_all(from, pipes[1], bytes);
    splice_all(pipes[0], to, bytes);

    close(from);
    close(pipes[1]);
    close(pipes[0]);
    close(to);
} 
```

附带说明一下，我认为`splice_all`当文件足够大时，由于管道已填满（？），上面的内容会首先阻塞，所以我还有一个可以`fork`从管道读取和写入的代码版本同一时间，但它与此版本有相同的错误并且更难阅读。

编辑：我的内核版本是 2.6.22.18-co-0.7.3（在 XP 上运行 coLinux。）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-19T20:58:52.310

这是什么内核版本？[自 2.6.25（提交9c55e01c0](http://git.kernel.org/?p=linux/kernel/git/torvalds/linux-2.6.git;a=commit;h=9c55e01c0cc835818475a6ce8c4d684df9949ac8) ）以来，Linux 已经支持从 TCP 套接字进行拼接，所以如果您使用的是早期版本，那么您就不走运了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-12-28T00:24:11.050

每次`splice_all`从`pipes[0]`to进行*单个*拼接时都需要from to （这是最后一个拼接刚刚读取的字节数）。原因：管道代表有限的内核内存缓冲区。因此，如果字节数不止于此，您将在.`to`*`from``pipes[1]``splice_all``splice_all(from, pipes[1], bytes)`*

 *# ruby-on-rails - ActiveMerchant/Spree - 创建者是否有按交易/按账户收取佣金？

> ID：884940
> 
> 赞同：0
> 
> 时间：2009-05-19T20:49:40.610
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-plugins, activemerchant, spree

这可能是一个愚蠢的问题，但如果您使用 ActiveMerchant（或 spree），ActiveMerchant（或 spree）的创建者会收取佣金吗？由于它是开源的，我不希望他们这样做。但同时，因为创建处理网关是一项艰巨的任务，如果他们想要对他们的努力进行一些补偿，我也不会感到惊讶。或者仅仅是您收到的任何付款都向信用卡公司支付佣金？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-19T20:52:53.133

他们不收取佣金。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T01:06:00.497

Shopify 收取佣金，但 Shopify 是一项付费服务​​。他们在 ActiveMerchant 项目下捐赠了网关代码。Spree 是一个完整的开源项目（新 BSD 许可证），因此使用该软件是免费的。Spree 是一个软件项目，但不是一项服务。

正常网关费用显然仍然适用。

# c# - 局部变量和从方法调用的变量之间的区别？C＃

> ID：884942
> 
> 赞同：1
> 
> 时间：2009-05-19T20:50:12.030
> 
> 标签：c#, oop, testing, methods

我想知道什么更快。帮帮我。

我在方法中声明了一个变量，如下所示：

```
 public static Regex FindNumber()
{ return new Regex(@"\d+", RegexOptions.IgnoreCase | RegexOptions.Compiled); } 
```

如您所见，它返回一个正则表达式。

我还有另一种看起来像这样的方法：

```
 private static string TestOne(string RawData)
{
    Regex rgxFindNumber = FindNumber();
    Regex rgxFindDays = FindDays();
    for (int i = 0; i < mc.Count; i++)
    {
        int days = Convert.ToInt32(rgxFindNumber.Match(rgxFindDays.Match(mc[i].Value).Value).Value);
    }
    return RawData;
} 
```

现在是 TestOne 方法会更快还是 TestTwo？

```
 private static string TestTwo(string RawData)
{
    for (int i = 0; i < mc.Count; i++)
    {
        int days = Convert.ToInt32(FindNumber().Match( FindDays().Match(mc[i].Value).Value).Value);
    }
    return RawData;
} 
```

现在我很好奇，因为 TestOne 在我的代码中可以被称为很多，所以我想知道什么会更好地实现。

多谢你们。

**编辑：**我使用的代码有一个非常大的类。它是基于文本的策略游戏的文本解析器。我正在尝试对其进行一些重构，这就是我想知道的。如果我确实为 Regex 创建了一个私有变量，那么每次访问该类时不会运行它吗？那是我对你的问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-19T20:57:12.813

`TestOne`将比 快`TestTwo`，因为您没有为每个循环迭代创建一个新的正则表达式。

这有两个好处：

*   用于解析和构造正则表达式对象的时间只完成一次，而不是`mc.Count`多次
*   由于构造的对象更少，垃圾收集的压力更小。

但是，我会更进一步。如果您总是要返回相同的正则表达式，并且您担心速度，我会将该正则表达式对象缓存在静态字段中。

例如，您可能会考虑这个：

```
private static Regex _FindNumber;
public static Regex FindNumber()
{
    if (_FindNumber == null)
        _FindNumber = new Regex(@"\d+", RegexOptions.IgnoreCase | RegexOptions.Compiled);
    return _FindNumber;
} 
```

这将只创建一个对象，总计，并保留它。

但是，这是我真正的答案。

要真正知道哪个将是最快的，您将不得不测量您的代码，可选地使用我的变体进行良好测量，然后再决定。永远不要在没有硬数据的情况下决定优化，您最终可能会花时间重写代码，这可能会引入新的错误，需要修复，您将花费更多的时间，只是为了获得另外 1% 的性能。

大的优化是在算法上完成的，比如改变排序算法的类型，然后只有在必要时，你才会继续进行局部优化，比如循环调整。

话虽如此，我至少会避免在循环中构造对象，这只是常识。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-19T20:52:58.500

我相信`TestOne`会更快，因为每次循环时都会`TestTwo`创建一个新对象。`Regex`如果`FindDays`实现相同，`FindNumber`那么它会更糟糕，因为您将创建两个对象。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-19T20:56:01.643

从技术上讲，TestOne 会更快，因为 TestTwo 通过调用 FindNumber() 添加堆栈帧。

我不知道它会产生多大的不同，我怀疑它有那么多。您的方法是静态的，所以实际上它只是创建对象，应该非常快。

我的问题是你为什么要使用函数调用一遍又一遍地返回相同的字符串？为什么不直接声明一个实变量？

像，

```
private static Regex _findNumber = new Regex(@"\d+", RegexOptions.IgnoreCase | RegexOptions.Compiled); 
```

# java - 如何在 Java 中发送电子邮件？

> ID：884943
> 
> 赞同：32
> 
> 时间：2009-05-19T20:50:20.283
> 
> 标签：java, email, tomcat, servlets

我需要从运行在 Tomcat 中的 servlet 发送电子邮件。我将始终以相同的主题发送给同一收件人，但内容不同。

用 Java 发送电子邮件的简单方法是什么？

### 有关的：

> [如何使用 GMail 从 Java 应用程序发送电子邮件？](https://stackoverflow.com/questions/46663/how-do-you-send-email-from-a-java-app-using-gmail)

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-05-19T20:58:48.160

这是我的代码：

```
import javax.mail.*;
import javax.mail.internet.*;

// Set up the SMTP server.
java.util.Properties props = new java.util.Properties();
props.put("mail.smtp.host", "smtp.myisp.com");
Session session = Session.getDefaultInstance(props, null);

// Construct the message
String to = "you@you.com";
String from = "me@me.com";
String subject = "Hello";
Message msg = new MimeMessage(session);
try {
    msg.setFrom(new InternetAddress(from));
    msg.setRecipient(Message.RecipientType.TO, new InternetAddress(to));
    msg.setSubject(subject);
    msg.setText("Hi,\n\nHow are you?");

    // Send the message.
    Transport.send(msg);
} catch (MessagingException e) {
    // Error.
} 
```

您可以从 Sun 获取 JavaMail 库：http: [//java.sun.com/products/javamail/](http://java.sun.com/products/javamail/)

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-05-19T21:02:43.613

JavaMail 使用起来可能有点麻烦。如果您想要一个更简单、更清洁的解决方案，请查看 JavaMail 的 Spring 包装器。参考文档在这里：

[http://static.springframework.org/spring/docs/2.5.x/reference/mail.html](http://static.springframework.org/spring/docs/2.5.x/reference/mail.html)

但是，这确实意味着您的应用程序中需要 Spring，如果这不是一个选项，那么您可以查看另一个开源包装器，例如 simple-java-mail：

[简单的javamail.org](http://www.simplejavamail.org)

或者，您可以直接使用 JavaMail，但上述两种解决方案是用 Java 发送电子邮件的更简单、更简洁的方法。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2009-05-19T21:05:51.267

包装 Java Mail API 的另一个选项是[Apache 的 commons-email](http://commons.apache.org/email/index.html)。

从他们的[用户指南。](http://commons.apache.org/email/userguide.html)

```
SimpleEmail email = new SimpleEmail();
email.setHostName("mail.myserver.com");
email.addTo("jdoe@somewhere.org", "John Doe");
email.setFrom("me@apache.org", "Me");
email.setSubject("Test message");
email.setMsg("This is a simple test of commons-email");
email.send(); 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-05-20T07:45:52.530

[为了跟进 jon 的回复，这里有一个使用simple-java-mail](http://www.simplejavamail.org)发送邮件的示例。

这个想法是您不需要了解构成电子邮件的所有技术（嵌套）部分。从这个意义上说，它很像 Apache 的 commons-email，除了 Simple Java Mail 在处理附件和嵌入图像时比 Apache 的邮件 API 更简单一些。Spring 的邮件功能也可以工作，但使用起来有点尴尬（例如，它需要一个匿名内部类），当然你需要依赖于 Spring，它不仅仅是一个简单的邮件库，因为它是设计的基础成为国际奥委会的解决方案。

Simple Java Mail btw 是 JavaMail API 的包装器。

```
final Email email = new Email();

email.setFromAddress("lollypop", "lolly.pop@somemail.com"); 
email.setSubject("hey");
email.addRecipient("C. Cane", "candycane@candyshop.org", RecipientType.TO);
email.addRecipient("C. Bo", "chocobo@candyshop.org", RecipientType.BCC); 
email.setText("We should meet up! ;)"); 
email.setTextHTML("<img src='cid:wink1'><b>We should meet up!</b><img src='cid:wink2'>");

// embed images and include downloadable attachments 
email.addEmbeddedImage("wink1", imageByteArray, "image/png");
email.addEmbeddedImage("wink2", imageDatesource); 
email.addAttachment("invitation", pdfByteArray, "application/pdf");
email.addAttachment("dresscode", odfDatasource);

new Mailer("smtp.host.com", 25, "username", "password").sendMail(email);
// or alternatively, pass in your own traditional MailSession object.
new Mailer(preconfiguredMailSession).sendMail(email); 
```

*   [简单的java邮件](http://www.simplejavamail.org)
*   [Apache Commons 邮件](http://commons.apache.org/proper/commons-email/index.html)
*   [春季邮件](http://docs.spring.io/spring/docs/2.0.x/reference/mail.html)
*   [邮件](https://java.net/projects/javamail/pages/Home)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-05-19T21:13:54.043

我通常在 tomcat 的 server.xml 文件的 GlobalNamingResources 部分中定义我的 javamail 会话，以便我的代码不依赖于配置参数：

```
<GlobalNamingResources>
    <Resource name="mail/Mail" auth="Container" type="javax.mail.Session"
              mail.smtp.host="localhost"/>
    ...
</GlobalNamingResources> 
```

我通过 JNDI 获得会话：

```
 Context context = new InitialContext();
    Session sess = (Session) context.lookup("java:comp/env/mail/Mail");

    MimeMessage message = new MimeMessage(sess);
    message.setFrom(new InternetAddress(from));
    message.addRecipient(Message.RecipientType.TO, new InternetAddress(to));
    message.setSubject(subject, "UTF-8");
    message.setText(content, "UTF-8");
    Transport.send(message); 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-19T21:09:08.933

如果您可以依赖外部 SMTP 服务器，JavaMail 就很棒。但是，如果您必须是自己的 SMTP 服务器，请查看[Asprin](https://github.com/masukomi/aspirin)。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-19T20:57:40.877

使用 Java 邮件库

```
import javax.mail.*

...

Session mSession = Session.getDefaultInstance(new Properties());
Transport mTransport = null;
mTransport = mSession.getTransport("smtp");
mTransport.connect(cServer, cUser, cPass);
MimeMessage mMessage = new MimeMessage(mSession);
mTransport.sendMessage(mMessage,  mMessage.getAllRecipients());
mTransport.close(); 
```

这是我用来让应用程序发送电子邮件的代码的截断版本。显然，在发送之前将正文和收件人放入消息中可能会更适合您。

maven 存储库位置是 artifactId：javax.mail，groupId：mail。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-10-11T07:30:54.743

如果它是非 Maven 项目，则将 java.mail jar 添加到您的类路径中将以下依赖项添加到您的 pom.xml 中执行代码

```
 <dependency>
        <groupId>javax.mail</groupId>
        <artifactId>mail</artifactId>
        <version>1.4</version>
    </dependency> 
```

**下面是经过测试的代码**

```
import java.util.Date;
    import java.util.Properties;

    import javax.mail.Authenticator;
    import javax.mail.Message;
    import javax.mail.PasswordAuthentication;
    import javax.mail.Session;
    import javax.mail.Transport;
    import javax.mail.internet.InternetAddress;
    import javax.mail.internet.MimeMessage;

    public class MailSendingDemo {
        static Properties properties = new Properties();
        static {
            properties.put("mail.smtp.host", "smtp.gmail.com");
            properties.put("mail.smtp.port", "587");
            properties.put("mail.smtp.auth", "true");
            properties.put("mail.smtp.starttls.enable", "true");
        }
        public static void main(String[] args) {
            String returnStatement = null;
            try {
                Authenticator auth = new Authenticator() {
                    public PasswordAuthentication getPasswordAuthentication() {
                        return new PasswordAuthentication("yourEmailId", "password");
                    }
                };
                Session session = Session.getInstance(properties, auth);
                Message message = new MimeMessage(session);
                message.setFrom(new InternetAddress("yourEmailId"));            
                message.setRecipient(Message.RecipientType.TO, new InternetAddress("recepeientMailId"));
                message.setSentDate(new Date());
                message.setSubject("Test Mail");
                message.setText("Hi");
                returnStatement = "The e-mail was sent successfully";
                System.out.println(returnStatement);    
                Transport.send(message);
            } catch (Exception e) {
                returnStatement = "error in sending mail";
                e.printStackTrace();
            }
        }
    } 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-02-14T12:39:05.207

**测试代码发送带有附件的邮件：**

```
 public class SendMailNotificationWithAttachment {

            public static void mailToSendWithAttachment(String messageTosend, String snapShotFile) {

                String to = Constants.MailTo;
                String from = Constants.MailFrom;
                String host = Constants.smtpHost;// or IP address
                String subject = Constants.subject;
                // Get the session object
                Properties properties = System.getProperties();
                properties.setProperty("mail.smtp.host", host);
                Session session = Session.getDefaultInstance(properties);
                try {
                    MimeMessage message = new MimeMessage(session);
                    message.setFrom(new InternetAddress(from));
                    message.addRecipients(Message.RecipientType.TO, InternetAddress.parse(to));
                    message.setSubject(subject);
                    // message.setText(messageTosend);
                    BodyPart messageBodyPart = new MimeBodyPart();
                    messageBodyPart.setText(messageTosend);
                    Multipart multipart = new MimeMultipart();
                    multipart.addBodyPart(messageBodyPart);

                    messageBodyPart = new MimeBodyPart();
                    String filepath = snapShotFile;

                    DataSource source = new FileDataSource(filepath);
                    messageBodyPart.setDataHandler(new DataHandler(source));

                    Path p = Paths.get(filepath);
                    String NameOffile = p.getFileName().toString();

                    messageBodyPart.setFileName(NameOffile);
                    multipart.addBodyPart(messageBodyPart);

                    // Send the complete message parts
                    message.setContent(multipart);

                    // Send message
                    Transport.send(message);

        //          Log.info("Message is sent Successfully");
        //          System.out.println("Message is sent Successfully");
                    System.out.println("Message is sent Successfully");
    } catch (MessagingException e) {
    //          Log.error("Mail sending is Failed " + "due to" + e);
                SendMailNotificationWithAttachment smnwa = new SendMailNotificationWithAttachment();
                smnwa.mailSendFailed(e);
                throw new RuntimeException(e);
            }
        }
public void mailSendFailed(MessagingException e) {
        System.out.println("Mail sending is Failed " + "due to" + e);
        Log log = new Log();
        log.writeIntoLog("Mail sending is Failed " + "due to" + e.toString(), false);
    }

} 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2014-03-12T05:56:30.693

这是简单的解决方案

下载这些罐子： 1\. Javamail 2\. smtp 3\. Java.mail

复制并粘贴以下代码`[http://javapapers.com/core-java/java-email/][1]`

编辑收件人邮箱、用户名和密码（Gmail 用户 ID 和密码）

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2020-11-11T03:38:47.377

```
import java.util.Properties;

import javax.mail.Authenticator;
import javax.mail.Message;
import javax.mail.PasswordAuthentication;
import javax.mail.Session;
import javax.mail.Transport;
import javax.mail.internet.InternetAddress;
import javax.mail.internet.MimeMessage;

public class sendMail {

    static  String  alertByEmail(String emailMessage){
        try{

            final String fromEmail = "abc@gmail.com";
            final String password = "********"; //fromEmail password 
            final String toEmail = "xyz@gmail.com";
            System.out.println("Email configuration code start");
            Properties props = new Properties();
            props.put("mail.smtp.host", "smtp.gmail.com"); //SMTP Host set by default this
            props.put("mail.smtp.port", "587"); //TLS Port you can use 465 insted of 587
            props.put("mail.smtp.auth", "true"); //enable authentication
            props.put("mail.smtp.starttls.enable", "true"); //enable STARTTLS
            //create Authenticator object to pass in Session.getInstance argument
            Authenticator auth = new Authenticator() 
            {

                protected PasswordAuthentication getPasswordAuthentication() 
                {
                        return new PasswordAuthentication(fromEmail, password);
                }
            };
                        Session session = Session.getInstance(props, auth);

                        MimeMessage message = new MimeMessage(session);
                        message.setFrom(new InternetAddress(fromEmail));
                        message.addRecipient(Message.RecipientType.TO, new 
                                                              InternetAddress(toEmail));
                        message.setSubject("ALERT");
                        message.setText(emailMessage);//here you can write a msg what you want to send... just remove String parameter in alertByEmail method oherwise call parameter
                        System.out.println("text:"+emailMessage);
                        Transport.send(message);//here mail sending process start.
                        System.out.println("Mail Sent Successfully");
        }
        catch(Exception ex)
        {
                        System.out.println("Mail fail");
                        System.out.println(ex);
        }
        return emailMessage;

        }
public static void main(String[] args) {
    String emailMessage = "This mail is send using java code.Report as a spam";
    alertByEmail(emailMessage);
    }
}

https://github.com/sumitfadale/java-important-codes/blob/main/Send%20a%20mail%20through%20java 

enter code here 
```

# .net - 如何设置propertygrid griditem标签

> ID：884948
> 
> 赞同：1
> 
> 时间：2009-05-19T20:51:04.697
> 
> 标签：.net, winforms, propertygrid

我有一个 PropertyGrid，它反映了我的班级的属性。

我正在观看 PropertyValueChanged 事件并注意到 PropertyValueChangedEventArgs 提供了已更改的 GridItem。

那个 GridItem 有一个我可以获得的 Tag 属性。我看不到如何将 GridItem 的 Tag 属性设置为一个值。

如何设置 GridItem 的 Tag 属性？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-19T21:32:34.067

*...我最初的答案离我很远，所以我在这次更新中修改了整个事情...*

如果我需要满足这个要求，我会这样做。

创建一个属性，用于预定义 GridItem 的*Tag*值；我们称之为*TagAttribute*。它可以像这样简单：

```
public class TagAttribute : Attribute
{
    public string TagValue { get; set; }

    public TagAttribute ( string tagValue )
    {
        TagValue = tagValue;
    }
} 
```

要预定义*Tag*值，您只需要使用此属性装饰所需的属性。

```
public class MyAwesomeClass
{
    ...
    [TagAttribute( "This is my tag value." )]
    [CategoryAttribute( "Data" )]
    public string MyAwesomeProperty { get; set; }
    ...
} 
```

然后，我将继承*PropertyGrid*并覆盖*OnPropertyValueChanged*事件，以便将*GridItem的**Tag*属性设置为与预定义的*TagAttribute 一致*。

 **```
public partial class InheritedPropertyGrid : PropertyGrid
{
    ...    
    protected override void OnPropertyValueChanged ( PropertyValueChangedEventArgs e )
    {
        var propertyInfo = SelectedObject.GetType().GetProperty( e.ChangedItem.PropertyDescriptor.Name );
        var tagAttribute = propertyInfo.GetCustomAttributes( typeof( TagAttribute ) , false );

        if ( tagAttribute != null )
            e.ChangedItem.Tag = ( (TagAttribute)tagAttribute[0] ).TagValue;

        base.OnPropertyValueChanged( e );
    }    
    ...
} 
```

现在，当您连接到此“InheritedPropertyGrid”的*OnPropertyValueChanged时，* *Tag*属性将设置为您在该属性上定义的内容。

# c# - 您如何对此类设计进行分类？

> ID：884959
> 
> 赞同：5
> 
> 时间：2009-05-19T20:53:14.940
> 
> 标签：c#, design-patterns

我见过的以下类型的设计基本上具有“瘦”类，不包括任何类型的行为。二级类用于插入/更新/删除/获取。

这是错的吗？它是反 OOP 的吗？

```
User.cs

public class User
{

    public string Username { get; set; }
    public string Password { get; set; }
}

Users.cs

public class Users
{
    public static User LoadUser(int userID)
    {
            DBProvider db = new DBProvider();
            return dp.LoadUser(userID);

        }

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-19T21:07:08.690

当您的 user.cs 类用于[域传输对象](http://msdn.microsoft.com/en-us/library/ms978717.aspx)时，Users.cs 类本质上是您可以在[数据访问对象](http://en.wikipedia.org/wiki/Data_Access_Object)中应用业务规则的地方。

您可能需要考虑类的命名约定以及命名空间。当我查看 users.cs 时，我假设它本质上是一个用于处理用户列表的类。

另一种选择是查看[Active Record Pattern](http://en.wikipedia.org/wiki/Active_record_pattern)，它将结合您创建的两个类。

```
User.cs

public class User
{
    public string Username { get; set; }
    public string Password { get; set; }

    public User(int userID)
    {
        //data connection
        //get records
        this.Username = datarecord["username"];
        this.Password = datarecord["password"];
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-19T20:56:36.620

我会将其归类为领域对象或业务对象。这种设计的一个好处是它使模型与任何业务逻辑无关，并且可以在不同类型的环境中重用。

第二类可以归类为 DAO（数据访问对象）。

这种模式根本不是anti-oop，被广泛使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-19T21:00:27.720

我认为您正在实现[域模型](http://en.wikipedia.org/wiki/Domain_model)和[数据访问对象](http://en.wikipedia.org/wiki/Data_access_object)。这是个好主意。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-19T21:32:48.060

第一类是反OOP，因为它包含没有行为的数据，是[贫血领域模型](http://en.wikipedia.org/wiki/Anemic_Domain_Model)的典型例子。对于使用 OO 语言进行过程编程的人来说，这是典型的。

但是，对于是否将数据库访问逻辑放入域模型本身（活动记录模式）或在您的代码中放入单独的类（数据访问对象模式）是否有意义，存在意见分歧，因为数据库访问是一种单独的技术关注点不一定与领域模型紧密耦合。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-19T21:09:39.743

看起来它可能是[存储库模式](http://www.martinfowler.com/eaaCatalog/repository.html)，这似乎是一种越来越普遍的模式，并且在[Rob Conery 的店面](http://blog.wekeroad.com/mvc-storefront/asp-net-mvc-mvc-storefront-part-2/)示例 Asp.Net MVC 应用程序中产生了很大的影响。

您基本上是从模型中抽象出您的数据访问代码，这通常是一件好事。虽然我希望对模型课有一点勇气。同样从以前的经验来看，称它为用户是令人困惑的，用户存储库可能会更好。也可能要考虑删除静态（这是一个热门辩论），但使嘲笑更容易。另外，存储库应该实现一个接口，这样你就可以模拟它，然后用假的替换它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-19T21:29:18.707

它在任何意义上都不是真正的面向对象，因为对象只不过是一堆粘在一起的数据。并不是说那是一件可怕的事情。

# .net - Windows 服务在哪个目录中运行？

> ID：884963
> 
> 赞同：93
> 
> 时间：2009-05-19T20:53:50.930
> 
> 标签：.net, windows-services

我创建了一个非常简单的 .NET Windows 服务并使用 InstallUtil.exe 实用程序安装它。

在服务中，我有一段代码如下：

```
if (File.Exists("test_file.txt"))
{
   // Do something clever
} 
```

我在与服务相同的目录中创建了一个名为 test_file.txt 的文件，但代码的注释部分从未被执行......？

* * *

## 回答 #1

> 赞同：106
> 
> 时间：2009-05-19T21:19:47.697

```
System.Diagnostics.Trace.WriteLine(Directory.GetCurrentDirectory()); 
```

将输出当前目录。将该代码放在服务的启动方法中，并使用[DebugView](http://technet.microsoft.com/en-us/sysinternals/bb896647.aspx)之类的工具检查输出。然后你就会知道你的服务的启动文件夹。

这种简单的技术将有助于解决服务开发中的许多问题，尤其是调试服务启动。

您可能希望服务的工作文件夹是服务可执行文件所在的文件夹（我也是如此）。您可以使用以下代码行更改到该文件夹​​：

```
System.IO.Directory.SetCurrentDirectory(System.AppDomain.CurrentDomain.BaseDirectory); 
```

* * *

## 回答 #2

> 赞同：85
> 
> 时间：2009-05-19T20:59:10.653

服务从称为服务控制管理器的应用程序启动。此应用程序位于系统目录**%WinDir%\System32**

在 Windows 7 Ultimate - 64 位上，此路径实际上是：**%WinDir%\SysWOW64**

有关详细信息，请参阅[MSDN 上的服务控制管理器](http://msdn.microsoft.com/en-us/library/ms685150(VS.85).aspx)。

感谢 Harper Shelby 指出原始帖子的问题。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2013-01-15T23:41:14.833

你可以让它像这样工作：

```
string cwd = Path.GetDirectoryName(Environment.GetCommandLineArgs()[0]);
Directory.SetCurrentDirectory(cwd ?? "."); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-11-30T12:54:51.303

还想知道 Windows 服务在哪个文件夹中运行，但源代码不是我的，所以无法修改它。在命令提示符中键入`sc qc <service name>`会显示 BINARY_PATH_NAME 中的文件夹。

```
C:\>sc qc
DESCRIPTION:
        Queries the configuration information for a service.
USAGE:
        sc <server> qc [service name] <bufferSize> 
```

当查询 MyService 得到：

C:>sc qc 我的服务

```
[SC] QueryServiceConfig SUCCESS

SERVICE_NAME: MyService
        TYPE               : 10  WIN32_OWN_PROCESS
        START_TYPE         : 3   DEMAND_START
        ERROR_CONTROL      : 1   NORMAL
        BINARY_PATH_NAME   : "D:\Routines\MyService\MyService.exe"
        LOAD_ORDER_GROUP   :
        TAG                : 0
        DISPLAY_NAME       : MyService
        DEPENDENCIES       :
        SERVICE_START_NAME : LocalSystem 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-11-23T15:42:30.217

From [SC start service in folder /Start in:/](https://stackoverflow.com/questions/29914673/sc-start-service-in-folder-start-in): One simple alternative is to use nssm.cc - this gives you the option of specifying a directory to start in.

# php - 使用 php 中的 opendir() 按字母顺序排序和显示目录列表

> ID：884974
> 
> 赞同：16
> 
> 时间：2009-05-19T20:55:28.680
> 
> 标签：php, sorting, directory

php noob here - 我已经拼凑了这个脚本以显示来自带有 opendir 的文件夹中的图像列表，但我无法确定如何（或在哪里）按字母顺序对数组进行排序

```
<?php

// opens images folder
if ($handle = opendir('Images')) {
while (false !== ($file = readdir($handle))) {

// strips files extensions  
$crap   = array(".jpg", ".jpeg", ".JPG", ".JPEG", ".png", ".PNG", ".gif", ".GIF", ".bmp", ".BMP", "_", "-");    

$newstring = str_replace($crap, " ", $file );   

//asort($file, SORT_NUMERIC); - doesnt work :(

// hides folders, writes out ul of images and thumbnails from two folders

    if ($file != "." && $file != ".." && $file != "index.php" && $file != "Thumbnails") {
    echo "<li><a href=\"Images/$file\" class=\"thickbox\" rel=\"gallery\" title=\"$newstring\"><img src=\"Images/Thumbnails/$file\" alt=\"$newstring\" width=\"300\"  </a></li>\n";}
}
closedir($handle);
}

?> 
```

任何建议或指示将不胜感激！

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-05-19T21:14:12.467

您需要先将文件读入数组，然后才能对它们进行排序。这个怎么样？

```
<?php
$dirFiles = array();
// opens images folder
if ($handle = opendir('Images')) {
    while (false !== ($file = readdir($handle))) {

        // strips files extensions      
        $crap   = array(".jpg", ".jpeg", ".JPG", ".JPEG", ".png", ".PNG", ".gif", ".GIF", ".bmp", ".BMP", "_", "-");    

        $newstring = str_replace($crap, " ", $file );   

        //asort($file, SORT_NUMERIC); - doesnt work :(

        // hides folders, writes out ul of images and thumbnails from two folders

        if ($file != "." && $file != ".." && $file != "index.php" && $file != "Thumbnails") {
            $dirFiles[] = $file;
        }
    }
    closedir($handle);
}

sort($dirFiles);
foreach($dirFiles as $file)
{
    echo "<li><a href=\"Images/$file\" class=\"thickbox\" rel=\"gallery\" title=\"$newstring\"><img src=\"Images/Thumbnails/$file\" alt=\"$newstring\" width=\"300\"  </a></li>\n";
}

?> 
```

编辑：这与您要问的内容无关，但是您也可以使用[pathinfo()](http://php.net/pathinfo)函数对文件扩展名进行更通用的处理。你不需要硬编码的扩展数组，你可以删除任何扩展。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2014-04-18T00:03:03.400

## 使用[`opendir()`](http://php.net/opendir)

`opendir()`不允许对列表进行排序。您必须手动执行排序。为此，首先将所有文件名添加到数组中，然后使用以下命令对其进行排序[`sort()`](http://php.net/sort)：

```
$path = "/path/to/file";

if ($handle = opendir($path)) {
    $files = array();
    while ($files[] = readdir($dir));
    sort($files);
    closedir($handle);
} 
```

然后*使用*列出它们`foreach`：

```
$blacklist = array('.','..','somedir','somefile.php');

foreach ($files as $file) {
    if (!in_array($file, $blacklist)) {
        echo "<li>$file</a>\n <ul class=\"sub\">";
    }
} 
```

## 使用[`scandir()`](http://php.net/scandir)

使用`scandir()`. 默认情况下，它会为您执行排序。使用以下代码可以实现相同的功能：

```
$path = "/path/to/file";
$blacklist = array('somedir','somefile.php');

// get everything except hidden files
$files = preg_grep('/^([^.])/', scandir($path)); 

foreach ($files as $file) {
    if (!in_array($file, $blacklist)) {
        echo "<li>$file</a>\n <ul class=\"sub\">";
    }
} 
```

## 使用[`DirectoryIterator`](http://www.php.net/manual/en/class.directoryiterator.php)（首选）

```
$path = "/path/to/file";
$blacklist = array('somedir','somefile.php');

foreach (new DirectoryIterator($path) as $fileInfo) {
    if($fileInfo->isDot()) continue;
    $file =  $path.$fileInfo->getFilename();
    echo "<li>$file</a>\n <ul class=\"sub\">";
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-10-09T22:20:29.247

这是我会做的方式

```
if(!($dp = opendir($def_dir))) die ("Cannot open Directory.");
while($file = readdir($dp))
{
    if($file != '.')
    {
        $uts=filemtime($file).md5($file);  
        $fole_array[$uts] .= $file;
    }
}
closedir($dp);
krsort($fole_array);

foreach ($fole_array as $key => $dir_name) {
  #echo "Key: $key; Value: $dir_name<br />\n";
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-03-17T02:04:03.690

注意：将它移到 foreach 循环中，以便正确重命名 newstring 变量。

```
// strips files extensions      
$crap   = array(".jpg", ".jpeg", ".JPG", ".JPEG", ".png", ".PNG", ".gif", ".GIF", ".bmp", ".BMP", "_", "-");    

$newstring = str_replace($crap, " ", $file ); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-26T08:57:35.367

```
$directory = scandir('Images'); 
```

# tsql - 表示网格中单元格表示格式的最佳方法？

> ID：884986
> 
> 赞同：0
> 
> 时间：2009-05-19T20:57:50.300
> 
> 标签：tsql, formatting, reporting

我正在为客户构建动态报告功能。他们想要创建新的存储过程，并让它们对应于新的报告。我们使用的是 T-SQL，网格/报告中的每个单元格都可以有自己的格式和/或功能。

我正在寻找一种格式规范来识别数据的表示、颜色和条件......例如，我正在考虑这样的事情：

{数据}|{格式}
123.56|$#,##0.00

结果... $123.56

我正在寻找表示格式字段的标准方法，以及颜色和条件的潜力。那里已经有一些标准了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-20T06:31:15.853

这一切都取决于你在寻找什么。您必须问自己希望应用什么类型的格式。以下是您可能需要考虑的一些情况：

*   **行内格式化**

    您想要一个包含混合格式的单元格（例如“ **1234** . *567* ”在单个单元格中显示粗体、常规和斜体）？

*   **基于多列**的输出

    您想在一个基于多个单元格的单元格中输出一个值吗？

    ```
    Cell1="1234"
    Cell2="56"
    Cell3={Cell1}.{Cell2} 
    ---> which would output "1234.56" 
    ```

如果不需要这些东西，那么您要做的就是为整个单元格提供单一格式。让我们将其分为两个格式化元素：**转换**和**视觉效果**：

*   将“1234.5678”格式化为“1234.56”是一种转换。它必须由知道如何将值解释为数字以及如何将该数字转换为数字字符的文本字符串的代码来完成。

*   使单元格变为蓝色、文本变为红色或粗体——这些都是视觉转换，它们只是关于单元格中数据显示的一组属性。我们不关心单元格中的数据类型，因为我们只需将像素放在屏幕上。

所以，归根结底：一切都是关于你想要发生的事情。如果您正在生成 HTML 报告，那么 HTML 和 CSS 是描述单元格视觉效果格式的非常方便的方法，因为您不必转换两次。

据我所知，视觉效果显示的编码标准只有几个，它们类似于SGML——TeX、HTML、PostScript等；它们都有“标签”（有时带有“属性”）来修改标签内内容的显示。

这给我们留下了转换格式。对此有两种常见的方法。首先是程序性的。您列出了一组您希望对数据进行的转换以将其转换为文本。如今，我们经常使用替换掩码，例如在您的示例中`$#,##0.00`，或在`sprintf`'s`%.2f`等中。

同样，只需选择在您的环境中使用最简单的格式说明符。如果您使用接受某种格式的语言进行编码，请使用它！

# c# - 使用 C# 进行邮件合并（Excel 到 Word）

> ID：884988
> 
> 赞同：1
> 
> 时间：2009-05-19T20:58:26.023
> 
> 标签：c#, email, interop, ms-word, mailmerge

我想知道是否有人知道如何使用 Excel 文件作为数据源进行邮件合并，以填写 Word 模板上的字段？如果可以的话，我希望使用 Word 的互操作...但是在查找代码时遇到了一些困难。有人对此有任何语法吗？先感谢您。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-19T21:28:06.103

学习如何在 MS Word 中自动执行特定操作的一个非常有用的方法是在启用“记录宏”的情况下手动执行操作。

一旦有了 VBA 宏，就很容易将其转换为使用互操作的 VB.NET 或 C#。我倾向于首先在 Word 中手动调整 VBA，以便在使用互操作层转换为 .NET 语言之前先对其进行测试。

我对mailmerge不太了解，但这是我录制宏时生成的一些VBA：

```
ActiveDocument.MailMerge.MainDocumentType = wdFormLetters
ActiveDocument.MailMerge.OpenDataSource Name:= _
    "c:\Arrays.xlsx", ConfirmConversions:=False, _
     ReadOnly:=False, LinkToSource:=True, AddToRecentFiles:=False, _
    PasswordDocument:="", PasswordTemplate:="", WritePasswordDocument:="", _
    WritePasswordTemplate:="", Revert:=False, Format:=wdOpenFormatAuto, _
    Connection:= _
    "Provider=Microsoft.ACE.OLEDB.12.0;User ID=Admin;Data Source=c:\Arrays.xlsx;Mode=Read;Extended Properties=""HDR=YES;IMEX=1;"";Jet OLEDB:System database="""";Jet OLEDB:Registry Path="""";Jet OLEDB:Engine Type=37;Jet OLEDB:Database Loc" _
    , SQLStatement:="SELECT * FROM `Sheet1$`", SQLStatement1:="", SubType:= _
    wdMergeSubTypeAccess 
```

我没有在这里包含完整的代码，但希望这能给你一些想法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-19T21:21:56.147

Word（至少在 2007 版本中，这就是我所看到的）可以开箱即用地做到这一点。只需选择 Excel 文件作为数据源。你想在你的代码中做什么？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-19T21:27:27.430

我使用[这个](http://www.aspose.com/categories/file-format-components/aspose.words-for-.net-and-java/default.aspx)第 3 方控件。您可以将 xls 文件读入数据表，然后告诉控件合并它。

# rsh - 我如何知道 RSH 从 SUA 发送了什么用户名？

> ID：884996
> 
> 赞同：0
> 
> 时间：2009-05-19T20:59:48.360
> 
> 标签：rsh, sua, rshd

我在 Windows Vista 64 位企业计算机上安装了 Unix 应用程序子系统并下载了应用程序。我正在尝试使用 RSH 连接到 FreeBSD 服务器。我要执行的命令是：

```
rsh host.suffix1.company.com command 
```

我在 host.suffix1.company.com 上的主目录中的 .rhosts 文件如下所示：

```
+ 我的用户名
+ 我的域\我的用户名
+ 我的域名/我的用户名
+ 我的用户名@我的域名
+ +
mycomputer.suffix2 myusername
mycomputer.suffix2 +
mycomputer.suffix2.company.com 我的用户名
mycomputer.suffix2.company.com +

```

我知道 ++ 不好，但现在让我们忽略它。当我运行这个：

```
rsh host.suffix1.company.com 命令

```

我收到以下错误：

```
rshd：登录错误。

```

但是，当我跑步时

```
rsh -l myusername host.suffix1.company.com 命令

```

这完美无瑕。我想知道的是：

1.  当我没有通过 -l 指定时，SUA 会发送什么作为用户名？
2.  如何更改 SUA 发送的内容？

我假设这里 SUA 正在发送某种形式的 mydomain\myusername，但我想知道我可能需要在 rhosts 文件中添加哪些其他条目以允许此操作以及为什么 ++ 不允许此操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-19T22:54:04.230

我猜想检查 freebsd 机器上的 syslog（或其他适当的日志？）可能会从失败的登录中为您提供登录名。在我的 linux 机器上，我从频繁的 ssh 攻击中得到如下代码：

```
May 19 19:57:40 anton sshd[29795]: Failed password for invalid user mercedes from 124.217.246.181 port 49198 ssh2
May 19 19:57:40 anton sshd[29796]: Received disconnect from 124.217.246.181: 11: Bye Bye
May 19 19:57:45 anton unix_chkpwd[29802]: password check failed for user (games)
May 19 19:57:45 anton sshd[29799]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=ns1.1oasis.net  user=games
May 19 19:57:48 anton sshd[29799]: Failed password for games from 124.217.246.181 port 49956 ssh2 
```

这是来自 sshd，但如果不是 rshd 无法记录类似的东西，我会感到惊讶（尽管它可能默认关闭并且需要启用）。

对于 microsoft 制作的 rsh 客户端的名称的猜测，我几乎没有什么想法。传统的 unix rsh 当然会从 /etc/passwd 中获取名称，使用 getpwent() 间接读取它（如果它可能回退到环境变量`LOGNAME`或`USER`？）。c:\windows\system\etc\passwd（或任何 SUA 映射为 /etc/passwd）中是否存在“myusername”？

# sql-server - SQL Server 中 UNION 选择的结果

> ID：884998
> 
> 赞同：1
> 
> 时间：2009-05-19T21:00:00.683
> 
> 标签：sql-server, select, union

是否可以从没有任何共同结果的表或视图中进行 UNION 查询？我正在尝试做的是将来自不同视图的数据组合成一个结果。我有

```
select a,b,null,c from VIEW1, VIEW2 where VIEW1.a = VIEW2.a
UNION
select null,null,z,null from VIEW3 
```

我希望结果是 a,b,z,c。这是我会使用 select from 的地方吗？那看起来像什么？

```
select ? from (
select a,b,null,c from VIEW1, VIEW2 where VIEW1.a = VIEW2.a
UNION
select null,null,z,null from VIEW3) 
```

我正在使用 MS SQL Server，并且视图没有主键。非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-19T21:08:01.917

如果我理解你的问题，你可能会得到这样的结果：

```
a1, b1, null, c1
a2, b2, null, c2
a3, b2, null, c3
null, null, z1, null
null, null, z2, null
null, null, z3, nul 
```

l

..但你想要得到的是这样的结果：

```
a1, b1, z1, c1
a2, b2, z2, c2
a3, b2, z3, c3 
```

我是否正确理解了问题？

如果这是正确的，您将需要有一种方法将这些子查询连接在一起，以便您可以告诉 SQL 1 一起运行，2 一起运行，等等。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-19T21:08:17.423

联合连接结果集，它不组合它们。

因此，您将从第一个查询中得到的是：

```
 a      b    (null)  c
(null) (null)   z    (null) 
```

如果你想组合它们，你必须加入它们，然后你需要有一些共同点，或者你必须在程序中组合数据。

每个人只有 1 行吗？

如果是这样，那么如果上面的模式总是这样，这将起作用：

```
SELECT SQ1.a, SQ1.b, SQ2.z, SQ1.c
FROM (
    SELECT 1 k, View1.a, b, NULL z, c
    FROM View1 INNER JOIN View2 ON View1.a = View2.a) SQ1
INNER JOIN (
    SELECT 1 k, NULL a, NULL b, z, NULL c
    FROM View3) SQ2 ON SQ1.k = SQ2.k 
```

但是，如果您不知道 View3.a 是否有值或 View1.a 是否有值，并且如果有值 3，您想要第一个查询中的值，那么这将起作用：

```
SELECT COALESCE(SQ1.a, SQ2.a) a, COALESCE(SQ1.b, SQ2.b) b,
    COALESCE(SQ1.z, SQ2.z) z, COALESCE(SQ1.c, SQ2.c) c
FROM (
    SELECT 1 k, View1.a, b, NULL z, c
    FROM View1 INNER JOIN View2 ON View1.a = View2.a) SQ1
INNER JOIN (
    SELECT 1 k, NULL a, NULL b, z, NULL c
    FROM View3) SQ2 ON SQ1.k = SQ2.k 
```

但是，这里有一个很大的 BUT。如果您在任一视图中都有不止一行，那么您最终将得到不属于一起的数据。在这种情况下，你们*一定*有共同点。

这是我尝试的完整代码以及结果：

```
USE master
GO

DROP DATABASE TestDB
GO

CREATE DATABASE TestDB
GO

USE TestDB
GO

CREATE TABLE View1
(
    a INT,
    b INT,
    c INT
)
GO

CREATE TABLE View2
(
    a INT,
    z INT
)
GO

CREATE TABLE View3
(
    z INT
)
GO

INSERT INTO View1 (a, b, c) VALUES (10, 20, 30)
GO

INSERT INTO View2 (a, z) VALUES (10, 40)
GO

INSERT INTO View3 (z) VALUES (50)
GO

SELECT View1.a, b, NULL z, c
FROM View1 INNER JOIN View2 ON View1.a = View2.a
UNION
SELECT NULL a, NULL b, z, NULL c
FROM View3

SELECT SQ1.a, SQ1.b, SQ2.z, SQ1.c
FROM (
    SELECT 1 k, View1.a, b, NULL z, c
    FROM View1 INNER JOIN View2 ON View1.a = View2.a) SQ1
INNER JOIN (
    SELECT 1 k, NULL a, NULL b, z, NULL c
    FROM View3) SQ2 ON SQ1.k = SQ2.k

SELECT COALESCE(SQ1.a, SQ2.a) a, COALESCE(SQ1.b, SQ2.b) b,
    COALESCE(SQ1.z, SQ2.z) z, COALESCE(SQ1.c, SQ2.c) c
FROM (
    SELECT 1 k, View1.a, b, NULL z, c
    FROM View1 INNER JOIN View2 ON View1.a = View2.a) SQ1
INNER JOIN (
    SELECT 1 k, NULL a, NULL b, z, NULL c
    FROM View3) SQ2 ON SQ1.k = SQ2.k 
```

结果：

```
a           b           z           c
----------- ----------- ----------- -----------
NULL        NULL        50          NULL
10          20          NULL        30

(2 row(s) affected)

a           b           z           c
----------- ----------- ----------- -----------
10          20          50          30

(1 row(s) affected)

a           b           z           c
----------- ----------- ----------- -----------
10          20          50          30

(1 row(s) affected) 
```

如果向 View3 添加一行，如下所示：

```
INSERT INTO View3 (z) VALUES (51) 
```

然后你会得到这些结果，注意加倍的行：

```
a           b           z           c
----------- ----------- ----------- -----------
NULL        NULL        50          NULL
NULL        NULL        51          NULL
10          20          NULL        30

(3 row(s) affected)

a           b           z           c
----------- ----------- ----------- -----------
10          20          50          30
10          20          51          30

(2 row(s) affected)

a           b           z           c
----------- ----------- ----------- -----------
10          20          50          30
10          20          51          30

(2 row(s) affected) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-19T21:05:40.283

如果我理解这一点：您是否试图“折叠”您的结果并摆脱所有 NULL？如果是这样，view3 的结果是否会对应于 view1/view2 的结果？如果有，是什么关系？如果不是，结果的数量是否至少匹配？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-10-08T18:38:43.377

对于多条记录，ROW_NUMBER() 方法对我有用。Select 1 k 方法返回笛卡尔积。

```
SELECT SQ1.a, SQ1.b, SQ2.z, SQ1.c
FROM (
    SELECT ROW_NUMBER() OVER (ORDER BY a) k, View1.a, b, NULL z, c
    FROM View1 INNER JOIN View2 ON View1.a = View2.a) SQ1
INNER JOIN (
    SELECT ROW_NUMBER() OVER (ORDER BY b) k, NULL a, NULL b, z, NULL c
    FROM View3) SQ2 ON SQ1.k = SQ2.k 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-19T21:07:04.430

难道你正在寻找这样的东西吗？（只是一个疯狂的猜测）

```
SELECT 
  VIEW1.a,
  VIEW1.b,
  (SELECT TOP 1 z FROM VIEW3) AS z,
  VIEW2.c
FROM
  VIEW1, VIEW2 
WHERE
  VIEW1.a = VIEW2.a 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-19T21:11:17.057

任何 sql 选择（包括联合）的结果都是一组静态列。（没有多态性。）

但是您不必使用每一行中的所有列，您可以在该列没有值的行中使用空值。我还建议您包含一个“类型”行，以便客户端可以告诉给定行的类型（和有趣的列）。

例子：

```
 (Select
   'room' as view_type
 , rooms.room as room
 , NULL as color
 From rooms 
 )
UNION ALL
(Select
  'color' as view_type
 , NULL as room
 , colors.color as color
 From colors 
) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-19T21:22:06.973

你实际上想要一个交叉连接：

选择 v1.a,v1.b,VIEW3.z,v1.c from (SELECT a,b,c, FROM VIEW1, VIEW2 where VIEW1.a = VIEW2.a) as v1 CROSS JOIN VIEW3***************************