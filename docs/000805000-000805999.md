# StackOverflow 问答 000805000-000805999

# sharepoint - 如何在 Sharepoint 中重命名列表

> ID：805005
> 
> 赞同：10
> 
> 时间：2009-04-30T01:21:30.020
> 
> 标签：sharepoint, sharepoint-2007

是否可以使用 Web 界面重命名 Sharepoint 2007 中的列表？我也想改变导航网址。

我尝试使用列表中的设置选项更改名称。这将更改标题，但不会更改导航 url。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2010-08-10T01:22:21.567

我遇到了同样的问题，我在 SharePoint Designer 中轻松解决了。您必须转到所有文件列表，找到列表，右键单击并重命名。这将更改 URL。如果您转到“列表和库”选项，您将没有此选项，您必须转到“所有文件”选项。

您不能在 Web UI 中执行此操作。

另外，另一个提示。如果需要，您需要用空格命名一个列表，但不希望 URL 中有丑陋的 %20 转义字符。假设您需要命名您的列表信息中心。首先创建没有空格的列表：InfoCenter。然后返回并将 Title only 重命名为 Info Center。现在您将拥有一个易读的列表名称，并且您的 URL 中没有 %20。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-30T01:48:42.637

我不确定是否可以通过 Web UI 更改 url。

但是，您可以将列表保存为模板，将内容作为该模板的一部分包含在内，然后删除该列表。最后，应用模板来获取一个新命名（带有新 url）的列表。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-30T14:38:07.593

您绝对可以使用[SharePoint Designer](http://office.microsoft.com/en-gb/sharepointdesigner/FX100487631033.aspx)更改 URL 。我很确定您也可以以编程方式执行此操作。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-30T17:42:18.133

该列表将获得您创建它的名称，因此请创建该列表，然后设置本地化名称

```
if (site.Lists.Exists(Constants.MyListName, out myList))
{
    myList.Description = Resources.My_Lists.My_List_Description;
    logger.Write("List {0} already exists on site {1}", Constants.ListNames.MYLIST,site.Url);
}
else
{
    Guid listGuid = site.Lists.Add(Constants.ListNames.MYLIST,   
                    Resources.My_Lists.MyList_List_Description,
                    SPListTemplateType.DocumentLibrary);
    myList = site.Lists.GetList(listGuid, false);
    logger.Write("Created list {0} on site {1}", Constants.ListNames.MYLIST, site.Url);
}
myList.NoCrawl = true;
myList.Title = Resources.My_Lists.My_Inbox_List_DisplayName;
myList.EnableVersioning = true;
myList.EnableMinorVersions = false;
myList.Update(); 
```

然后，当您需要该列表时，您可以使用内部名称获取它，该名称与 Constants.ListNames.MYLIST 中的名称相同

```
list = (from SPList l in web.Lists
                        where l.RootFolder.Name.Equals(listInternalName, StringComparison.InvariantCulture)
                        select l).FirstOrDefault(); 
```

我认为远离显示名称是一个很好的做法，请参阅这篇关于 Sharepoint 中字段问题的文章

[http://www.buro9.com/blog/2007/02/26/sharepoint-splistitem-quirks/](http://www.buro9.com/blog/2007/02/26/sharepoint-splistitem-quirks/)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-20T08:05:24.317

看起来您可以在 Windows 资源管理器中更改 url。库/列表仍然存在并且可以编辑。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-06-30T16:54:13.853

有时，您开始使用将其命名为 Beta 列表、测试、站点版本 1 等的列表，然后您意识到您需要更改列表的名称。以下是更改名称的分步过程：

1.  单击“站点操作”并选择“站点设置”
2.  在“站点管理”下选择“站点库和列表”
3.  选择您要自定义的列表
4.  在常规设置下选择“标题、描述和导航”
5.  编辑名称，您就完成了。

这不应修改列表的超连接和各种视图。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-01-15T15:40:16.363

我是 Sharepoint 的新手，但我已成功重命名列表。这就是我所做的：

*   创建了一个“网上邻居”，它实际上是该站点的 WebDAV 位置
*   重命名 Windows 资源管理器中的列表
*   在快速启动中删除/添加了“新”列表。

URL 已更改，因为旧名称不再有效。

希望能帮助到你。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-04T17:00:50.350

列表的内部名称非常混乱，在代码中杀死它或通过操作文件可能会破坏某些自定义 Web 部件、工作流或导致孤立。出于这些原因，我会不理会内部名称，而不是冒险以虚荣的名义破坏某些东西。但是，如果客户要求更改，我会按照 Martin 的说法保存模板并使用它来重命名您的列表。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-11T13:45:04.140

创建列表或文档库后，无法使用 Web 界面更改 url - 除非您使用 Powershell 或 SharePoint Designer 等工具对其进行修改，否则您将无法使用它。

我强烈建议养成使用缩短/干净的 url 创建列表/库的习惯，然后立即将列表/库重命名为“好”的名称，以便每个人都能清楚地阅读。

# ibm-midrange - String replace method in RPG IV

> ID：805007
> 
> 赞同：1
> 
> 时间：2009-04-30T01:22:25.570
> 
> 标签：ibm-midrange, rpgle

In RPG IV how can I take a string and eliminate all instances of a character in specific or replace them with another one ?. This is kind of like string replace built in methods in other programmnig languages. Ex: take 021-123450-23-4 and covert to 021123450234

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-12T19:41:12.457

%xlate 的正确语法是：

%XLATE(从:to:string{:startpos})

用 & 号替换所有连字符：

new_string = %xlate('-':'&':string);

要删除所有连字符：

您不能使用 &xlate 删除字符。7.1 为我们提供了 %scanrpl，但在此之前，请使用如下内容：

```
for i = 1 to %len(string);
    char = %subst(string:i:1);
    if char <> '-';
        new_string += char;
    endif;
endfor; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-30T16:32:28.533

看看以下文章：

*   [http://www.itjungle.com/fhg/fhg030409-story01.html](http://www.itjungle.com/fhg/fhg030409-story01.html)
*   [http://www.itjungle.com/fhg/fhg022509-story01.html](http://www.itjungle.com/fhg/fhg022509-story01.html)

这些应该会有所帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-03-27T15:54:07.590

我有同样的问题。所以我编写了自己的 RPG 程序来为我做这件事：

```
 **
     **
     D************************************************************************
     D*                                                                      *
     D*  Procedure 'skReplace' -- Replaces text in 'text' string,            *
     D*                           searching for 'find' string,               *
     D*                           replacing with 'new' string.               *
     D*                           All occurances are replaced, not just one. *
     D*  Parameters: @txt = 'text' string                                    *
     D*              @fnd = 'find' string                                    *
     D*              @new = 'new' string (that replaces 'find' in 'source')  *
     D*                                                                      *
     D*  Update history:                                                     *
     D*  2013-04    Created by Shawn Kovac.                                  *
     D*                                                                      *
     D************************************************************************
     D*
     P skReplace       B
     D skReplace       PI           999A   Varying
     D    @txt                      999A   VALUE Varying
     D    @fnd                      999A   VALUE Varying
     D    @new                      999A   VALUE Varying
     D    @pos         S              3  0
     D*
      /free
       if (%Len(@fnd) = 0); // text to find cannot be empty.
          return @txt;
       endif;
       @pos = 1;
       dou (@pos = 0);
           @pos = %scan(@fnd: @txt: @pos);
           if (@pos > 0);
               @txt = %replace( @new : @txt : @pos : %Len(@fnd) );
               @pos = @pos + %Len(@new);
               if (@pos > %Len(@txt));
                   @pos = 0;
               endif;
           endif;
       enddo;

       return @txt;

      /end-free
     P skReplace       E
     **
     ** 
```

由于 RPG 对内容在哪一列非常挑剔，因此在复制和重用此代码时，您可能需要调整粘贴的文本，因此在 'D*'、'**' 和 'P skReplace 之前有 5 个空格。 ...'。'/free' 前有六个空格。'/free' 行之间的所有代码都有 7 个或更多空格。

我欢迎任何有关改进此代码的建议。如果有人想要的话，我也有 Left、Right 和 Mid 的程序。如果你这样做，就给我发信息。我很乐意分享它们。我知道 RPG 有一个 '%subst' 函数，但许多编程语言都很挑剔，如果参数无效，它们会出错。我的反而提供了更多的灵活性，例如，Left('aoeu', -1) 返回 'aoe' （完整字符串短 1 个字符），而 Right('aoeu', -1) 返回 'oeu' （右侧部分删除 1 个字符后的字符串）。我的 Mid 过程还允许负开始位置，也从字符串的末尾开始索引，我发现这对我很有用。但对于任何想花时间向我要的人来说，它们都是免费的。

快乐编码！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-06-02T22:08:01.523

要删除一个字符，您可以使用它

```
strRes = %scanrpl('-':'':strSrc); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2022-01-28T13:17:16.467

如果您的字符串始终具有该格式（3个字母）-（6个字母）-（2个字母）-（1个字母），您可以使用数据结构：DS 15 Mystuc 1 3 part1 5 10 part2 12 13 part3 15 15 part4

然后将 mystruct 的每个部分移动到另一个结构以获取完整的数字或不带 -movel Michar mystruc 的字符串

此示例适用于 as400 中的 rpg（不是 rpgile）

# css - 我将如何设置 :checked 单选按钮后的文本样式？

> ID：805009
> 
> 赞同：1
> 
> 时间：2009-04-30T01:23:08.847
> 
> 标签：css, css-selectors, dynamic-css

我尝试了以下方法：

```
:checked + *  
{  
font-weight: bold;  
} 
```

使用以下html：

```
<p><input type = "radio" name = "blah" />some text</p> 
```

我将如何设计此类文本的样式？

**解决方案：**

在文本周围添加标签标签，并使用
:selected + *进行选择

它适用于歌剧和ff3，所以我很好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-30T01:35:19.080

您使用 label 元素将文本和其他内联内容与表单输入相关联：

```
<input id="foo" ...> <label for="foo" ...>foo text</label> 
```

然后使用 [for="foo"] 或 #foo + label 或其他选择。

# wpf - WPF 中的数据绑定单选按钮列表

> ID：805015
> 
> 赞同：20
> 
> 时间：2009-04-30T01:27:14.717
> 
> 标签：wpf, radio-button, databound

我在数据对象中有一个选项列表，我想制作一个等效的单选按钮列表，以允许用户选择其中一个，并且只选择一个。功能类似于数据绑定组合框，但采用单选按钮格式。

愚蠢的我，我以为这是内置的，但没有。你怎么做呢？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-04-30T01:33:25.700

基本上，在查看了谷歌结果之后，我从[MSDN 讨论线程中的信息开始，WPF 博士提供了一个答案](http://social.msdn.microsoft.com/forums/en-US/wpf/thread/5137aabc-bb3a-478a-9438-bc93dd9cc0ac/)，其中谈到了将 ListBox 设置为看起来正确的样式。但是，当列表框被禁用时，背景是一种烦人的颜色，我一生都无法摆脱，直到我阅读[了 ListBox ControlTemplate 的 MSDN 示例](http://msdn.microsoft.com/en-us/library/ms754242.aspx)，它显示了正在踢我的背景的秘密 Border 元素屁股。

所以，这里的最终答案是这种风格：

```
<Style x:Key="RadioButtonList" TargetType="{x:Type ListBox}">
    <!-- ControlTemplate taken from MSDN http://msdn.microsoft.com/en-us/library/ms754242.aspx -->
    <Setter Property="SnapsToDevicePixels" Value="true"/>
    <Setter Property="OverridesDefaultStyle" Value="true"/>
    <Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Auto"/>
    <Setter Property="ScrollViewer.VerticalScrollBarVisibility" Value="Auto"/>
    <Setter Property="ScrollViewer.CanContentScroll" Value="true"/>
    <Setter Property="MinWidth" Value="120"/>
    <Setter Property="MinHeight" Value="95"/>
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="ListBox">
                <Border Name="Border" Background="Transparent"
                        BorderBrush="Transparent"
                        BorderThickness="0"
                        CornerRadius="2">
                    <ScrollViewer Margin="0" Focusable="false">
                        <StackPanel Margin="2" IsItemsHost="True" />
                    </ScrollViewer>
                </Border>
                <ControlTemplate.Triggers>
                    <Trigger Property="IsEnabled" Value="false">
                        <Setter TargetName="Border" Property="Background"
                                Value="Transparent" />
                        <Setter TargetName="Border" Property="BorderBrush"
                                Value="Transparent" />
                    </Trigger>
                    <Trigger Property="IsGrouping" Value="true">
                        <Setter Property="ScrollViewer.CanContentScroll" Value="false"/>
                    </Trigger>
                </ControlTemplate.Triggers>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
    <Setter Property="ItemContainerStyle">
        <Setter.Value>
            <Style TargetType="{x:Type ListBoxItem}" >
                <Setter Property="Margin" Value="2" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type ListBoxItem}">
                            <Border Name="theBorder" Background="Transparent">
                                <RadioButton Focusable="False" IsHitTestVisible="False"
                                             IsChecked="{TemplateBinding IsSelected}">
                                    <ContentPresenter />
                                </RadioButton>
                            </Border>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
        </Setter.Value>
    </Setter>
</Style> 
```

它为 ListBox 和 Items 提供了 ControlTemplate 和样式。它被这样使用：

```
<ListBox Grid.Column="1" Grid.Row="0" x:Name="TurnChargeBasedOnSelector" Background="Transparent"
    IsEnabled="{Binding Path=IsEditing}"
    Style="{StaticResource RadioButtonList}"
    ItemsSource="{Binding RelativeSource={RelativeSource AncestorType={x:Type local:MainForm}}, Path=DataContext.RampTurnsBasedOnList}"
    DisplayMemberPath="Description" SelectedValuePath="RampTurnsBasedOnID"
    SelectedValue="{Binding Path=RampTurnsBasedOnID, NotifyOnValidationError=True, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True, ValidatesOnExceptions=True}"/> 
```

我花在 WPF 上的时间越多，我就越觉得它让琐碎的事情变得异常困难，变得异常困难。享受。-斯科特

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-07-28T03:20:13.693

使用具有属性 Name 的对象列表将列表框绑定到 ListBox 的 ItemsSource（这可以更改）

```
<ListBox Name="RadioButtonList">
   <ListBox.ItemTemplate >
        <DataTemplate >
             <RadioButton GroupName="radioList" Tag="{Binding}" Content="{Binding Name}"/>
         </DataTemplate>
                                                    </ListBox.ItemTemplate>
                                                </ListBox> 
```

重要的**GroupName="radioList"**

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2013-04-10T06:44:50.103

超级简单，MVVM 友好，利用 DataTemplates 类型。XAML：

```
<Window x:Class="WpfApplication1.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:WpfApplication1"
    Title="MainWindow" Height="350" Width="525">

<Window.Resources>
    <DataTemplate DataType="{x:Type local:Option}">
        <RadioButton Focusable="False"
                IsHitTestVisible="False"
                Content="{Binding Display}"
                IsChecked="{Binding IsSelected, RelativeSource={RelativeSource AncestorType=ListBoxItem}}">
        </RadioButton>
    </DataTemplate>
</Window.Resources>

<Grid>
    <ListBox ItemsSource="{Binding Options}" SelectedItem="{Binding SelectedOption}"/>
</Grid> 
```

查看模型等：

```
public partial class MainWindow : Window
{
    public MainWindow()
    {
        InitializeComponent();
        this.DataContext = new Vm();
    }
}

public class Vm
{
    public Option[] Options { get { return new Option[] { 
        new Option() { Display = "A" }, 
        new Option() { Display = "B" }, 
        new Option() { Display = "C" } }; } }
    public Option SelectedOption { get; set; }
}

public class Option
{
    public string Display { get; set; }
} 
```

如果您将选项包装成特定类型（或者可能已经是）。您可以为该类型设置一个 DataTemplate，WPF 将自动使用它。（在 ListBox 资源中定义 DataTemplate 以限制 DataTemplate 的应用范围）。

如果需要，还可以使用 DataTemplate 中的组名来设置组。

这比更改控件模板要简单得多，但它确实意味着您在选定的项目上得到一条蓝线。（同样，没有什么是无法解决的）。

当您知道如何操作时，WPF 很简单。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-04-30T13:58:56.487

我已经通过将 a`ValueConverter`转换`enum`为 a 来完成此操作`bool`。通过传递您的单选按钮表示为的枚举值，`ConverterParameter`转换器返回是否应检查此单选按钮。

```
<Window.Resources>
    <Converters:EnumConverter x:Key="EnumConverter" />
</Window.Resources>

<RadioButton IsChecked="{Binding Path=MyEnum, Mode=TwoWay, 
                                 Converter={StaticResource EnumConverter}, 
                                 ConverterParameter=Enum1}"}
             Content="Enum 1" />
<RadioButton IsChecked="{Binding Path=MyEnum, Mode=TwoWay, 
                                 Converter={StaticResource EnumConverter}, 
                                 ConverterParameter=Enum2}"}
             Content="Enum 2" /> 
```

`EnumConverter`定义如下：

```
public class EnumConverter : IValueConverter
    {
        public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
        {
            if (targetType.IsAssignableFrom(typeof(Boolean)) && targetType.IsAssignableFrom(typeof(String)))
                throw new ArgumentException("EnumConverter can only convert to boolean or string.");
            if (targetType == typeof(String))
                return value.ToString();

            return String.Compare(value.ToString(), (String)parameter, StringComparison.InvariantCultureIgnoreCase) == 0;
        }

        public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
        {
            if (targetType.IsAssignableFrom(typeof(Boolean)) && targetType.IsAssignableFrom(typeof(String)))
                throw new ArgumentException("EnumConverter can only convert back value from a string or a boolean.");
            if (!targetType.IsEnum)
                throw new ArgumentException("EnumConverter can only convert value to an Enum Type.");

            if (value.GetType() == typeof(String))
            {
                return Enum.Parse(targetType, (String)value, true);
            }

            //We have a boolean, as for binding to a checkbox. we use parameter
            if ((Boolean)value)
                return Enum.Parse(targetType, (String)parameter, true);

            return null;
        }
    } 
```

请注意，我不会将数据绑定到枚举列表以生成单选按钮，我是手动完成的。如果您想通过绑定填充单选按钮列表，我认为您需要将绑定更改为`IsChecked`绑定到`MultiBinding`当前值和单选框枚举值的绑定，因为您不能在`ConverterParameter`.

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-12-21T03:09:55.877

抱歉，我想将此回复作为对 Scott O 帖子的评论，但我还没有这样做的声誉。我真的很喜欢他的回答，因为它是一种仅限样式的解决方案，因此不需要任何添加的代码隐藏或创建自定义控件等。

但是，当我尝试在 ListBoxItems 中使用控件时，我确实遇到了一个问题。当我使用这种风格时，由于这条线，我无法集中任何包含的控件：

`<RadioButton Focusable="False" IsHitTestVisible="False" IsChecked="{TemplateBinding IsSelected}">`

单选按钮需要关闭 Focusable 和 IsHitTestVisible 才能使 IsChecked 绑定正常工作。为了解决这个问题，我将 IsChecked 从 TemplateBinding 更改为常规绑定，这允许我将其设为双向绑定。删除有问题的设置给了我这一行：

`<RadioButton IsChecked="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=IsSelected, Mode=TwoWay}">`

现在，我可以按预期关注 ListBoxItems 中包含的任何控件。

希望这可以帮助。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-09-27T05:28:25.483

我从[Jon Benson 的博客条目](http://jonsblogat.blogspot.com.au/2010/06/wpf-creating-and-binding-radiobuttons.html)中获得灵感，但修改了他的解决方案以使用具有描述属性的枚举。所以解决方案的关键部分变成了：

**带描述的枚举器**

```
public enum AgeRange {
  [Description("0 - 18 years")]
  Youth,
  [Description("18 - 65 years")]
  Adult,
  [Description("65+ years")]
  Senior,
} 
```

**用于读取描述和返回键/值对以进行绑定的代码。**

```
public static class EnumHelper
{
    public static string ToDescriptionString(this Enum val)
    {
        var attribute =
            (DescriptionAttribute)
            val.GetType().GetField(val.ToString()).GetCustomAttributes(typeof(DescriptionAttribute), false).
                SingleOrDefault();
        return attribute == default(DescriptionAttribute) ? val.ToString() : attribute.Description;
    }

    public static List<KeyValuePair<string,string>> GetEnumValueDescriptionPairs(Type enumType)
    {
        return Enum.GetValues(enumType)
            .Cast<Enum>()
            .Select(e => new KeyValuePair<string, string>(e.ToString(), e.ToDescriptionString()))
            .ToList();
    }
} 
```

**XAML 中的对象数据提供程序**

```
<ObjectDataProvider
    ObjectType="{x:Type local:EnumHelper}"
    MethodName="GetEnumValueDescriptionPairs"
    x:Key="AgeRanges">
    <ObjectDataProvider.MethodParameters>
        <x:Type TypeName="local:AgeRange" />
    </ObjectDataProvider.MethodParameters>
</ObjectDataProvider> 
```

**XAML 中的列表框**

```
<ListBox 
    ItemsSource="{Binding Source={StaticResource AgeRanges}}"
    SelectedValue="{Binding SelectedAgeRange}"
    SelectedValuePath="Key">
    <ListBox.ItemTemplate>
        <DataTemplate>
            <RadioButton 
                IsChecked="{Binding IsSelected, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type ListBoxItem}}}"
                Content="{Binding Value}" />
        </DataTemplate>
    </ListBox.ItemTemplate>
</ListBox> 
```

**您绑定到的属性（例如在您的视图模型中）**

```
public class YourViewModel : INotifyPropertyChanged
{
  private AgeRange _selectedAgeRange;
  public AgeRange SelectedAgeRange
  {
    get { return _selectedAgeRange; }
    set 
    {
      if (value != _selectedAgeRange)
      {
        _selectedAgeRange = value;
        OnPropertyChanged("SelectedAgeRange");
      }
    }
  }
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-08-06T23:26:08.857

我作弊了：

我的解决方案是以编程方式绑定列表框，因为这似乎对我有用：

```
 if (mUdData.Telephony.PhoneLst != null)
            {
                lbPhone.ItemsSource = mUdData.Telephony.PhoneLst;
                lbPhone.SelectedValuePath = "ID";
                lbPhone.SelectedValue = mUdData.Telephony.PrimaryFaxID;
            } 
```

XAML 如下所示：

```
 <ListBox.ItemTemplate >

                        <DataTemplate >
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition></RowDefinition>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"></ColumnDefinition>
                                    <ColumnDefinition Width="Auto"></ColumnDefinition>
                                </Grid.ColumnDefinitions>

                                <RadioButton 
                                    IsChecked="{Binding Path=PrimaryPhoneID}" 
                                    GroupName="Phone" 
                                    x:Name="rbPhone"
                                    Content="{Binding Path=PrimaryPhoneID}"
                                    Checked="rbPhone_Checked"/>

                                <CheckBox Grid.Column="2" IsEnabled="False" IsChecked="{Binding Path=Active}" Content="{Binding Path=Number}" ></CheckBox>

                            </Grid>
                        </DataTemplate>
                    </ListBox.ItemTemplate> 
```

在我的事件中，在选择单选按钮时读取它的值如下所示：

```
 private void rbPhone_Checked(object sender, RoutedEventArgs e)
    {
        DataRowView dvFromControl = null;
        dvFromControl = (DataRowView)((RadioButton)sender).DataContext;

        BindData.Telephony.PrimaryPhoneID = (int)dvFromControl["ID"];

    } 
```

希望对某人有所帮助。

# reporting-services - SSRS Dundas 自定义代码未执行

> ID：805022
> 
> 赞同：1
> 
> 时间：2009-04-30T01:31:23.770
> 
> 标签：reporting-services, dundas

我在 SSRS 报告中使用了一个 Dundas 图表，在 PostInitilize 事件中有一些自定义代码，如下所示：

```
foreach(CustomLabel curLabel in chartObj.ChartAreas[0].AxisY.CustomLabels)
{
    curLabel.GridTick = GridTick.None;
    curLabel.Text = Convert.ToString(Convert.ToInt32(curLabel.Text) - 10);
} 
```

它采用每个轴标签并将值减少 10。

这在我的机器上运行良好，甚至在报表查看器的生产服务器上运行良好。但是，当此报告作为订阅运行时，代码无法运行。报告生成得很好，但轴标签没有改变。

这怎么可能发生？作为订阅运行报表有什么不同？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-30T11:40:01.623

经过大量搜索，我找到了解决方案。

问题是我的开发机器上的 Dundas 版本比生产中的版本稍新（2.2 v 2.1）。我猜这会导致代码程序集不受信任。（但仅在无人看管的情况下运行？）

显而易见的解决方案是升级服务器，或者降级我的开发机器，以便版本号匹配。我无法触摸服务器上的安装，降级我自己的机器需要很长时间并且很烦人。但还有另一种解决方案。

找一台安装了正确版本的dundas的机器，在Visual Studio中打开报告，打开代码，做个表面处理（比如加个空行，或者注释）然后编译代码。此报告现在将包含“正确”程序集。将其部署到服务器，一切都应该正常工作。

# svn - 在 R pdf 输出中抑制或设置 CreationDate/ModDate

> ID：805027
> 
> 赞同：5
> 
> 时间：2009-04-30T01:32:43.767
> 
> 标签：svn, r

当 R 使用 pdf() 创建 PDF 时，它在 PDF 中包含 CreationDate 和 ModDate。我在 svn 存储库中有许多这样生成的 PDF，其效果是，当 R 重新制作图形时，即使使用相同的数据，它们也会显示为 svn 的修改（正确地）。让两个人好好相处的最好方法是什么？

我可以简单地从 R 之外的 PDF 中删除这些行，但是这个额外的步骤是不可取的。
作为运行脚本的一部分，我可以将系统时间设置为某个固定值，但这更不可取。
我什至可以说服 svn 使用一个专门的差异来忽略这些行的变化，但这听起来比它的价值更麻烦。

一个非常令人愉快的解决方案是，如果有一种方法可以防止 R 首先将这些行放在 PDF 文件中。我有一个文件系统可以告诉我何时创建和修改文件，非常感谢，我也不需要存储在文件中的信息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-15T02:36:48.843

我同意 Tal，生成的文件不应该在版本控制中。

关于您最初的问题，我认为答案是否定的，您不能阻止 R 这样做。我发现在 R pdf 帮助文件中没有提到这些选项，[http://www.r-cookbook.com/rhelp/pdf.html](http://www.r-cookbook.com/rhelp/pdf.html)

如果您查看 R 内部的 pdf 函数（只需执行“pdf”而不带任何括号以打印代码），它实际上会创建 pdf 文件并调用：

```
.External(PDF, file, old$paper, old$family, old$encoding, old$bg, old$fg, 
      old$width, old$height, old$pointsize, onefile, old$pagecentre, old$title, 
      old$fonts, version[1L], version[2L], old$colormodel, old$useDingbats,
      old$useKerning) 
```

没有提及您正在寻找的选项，因此您可能不走运。除非您想追踪 R 用来生成 PDF 并更改它的代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-30T01:40:37.400

虽然这实际上并不能回答您的问题，但通常最好从源代码管理中排除自动生成的文件，正是出于这个原因。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-10-14T12:17:24.227

这既不优雅，也不可取。很多事情都可能出错或被利用。但它对我有用。

我只是使用`pdf_on`而不是`pdf`，而`pdf_off`不是`dev.off`。

```
pdf_on <- function(...) {
    field <- "(\\s*/(Creation|Mod)Date)"
    value <- "\\(D:[0-9]{14}(.[0-9]{2}.[0-9]{2}.?)?\\)"
    from <- paste0("^", field, " ", value, "$")
    to <- "\\1 (D:19700101000000)"
    file <- list(...)[[1]]
    pdf_cmd <<- paste0("sed -E 's_", from, "_", to, "_' -i ", file)
    return(pdf(...))
}
pdf_off <- function(...) {
    ret <- dev.off(...)
    Sys.sleep(0.1)
    system(pdf_cmd)
    return(ret)
} 
```

# asp.net-mvc - 如何在 ASP.NET MVC 中对 IgnoreRoute 进行单元测试

> ID：805028
> 
> 赞同：12
> 
> 时间：2009-04-30T01:32:43.767
> 
> 标签：asp.net-mvc, unit-testing, routes

在 ASP.NET MVC 中，我可以获得有关路由和自定义路由的单元测试的信息，但我不知道如何对 IgnoreRoute 进行单元测试。

routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

非常感谢实用代码。

[ASP.NET MVC 框架（第 2 部分）：URL 路由](http://weblogs.asp.net/scottgu/archive/2007/12/03/asp-net-mvc-framework-part-2-url-routing.aspx)

[ASP.NET MVC 技巧 #13 – 对您的自定义路由进行单元测试](http://stephenwalther.com/blog/archive/2008/07/02/asp-net-mvc-tip-13-unit-test-your-custom-routes.aspx)

[ASP.NET MVC 技巧 #30 – 创建自定义路由约束](http://stephenwalther.com/blog/archive/2008/08/07/asp-net-mvc-tip-30-create-custom-route-constraints.aspx)

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-30T03:23:01.570

我会检查 RouteData 上的 RouteHandler 是否与被忽略的路径匹配的路由是 StopRoutingHandler 类型的；

```
 [TestMethod]
    public void TestIgnoredRoute()
    {
        // Arrange
        var routes = new RouteCollection();
        GlobalApplication.RegisterRoutes(routes);

        // Act
        var context = new FakeHttpContext("~/some.axd/path");
        var routeData = routes.GetRouteData(context);

        // Assert
        Assert.IsInstanceOfType( routeData.RouteHandler, typeof(StopRoutingHandler) );
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T11:13:45.350

如果您使用 MvcContrib testhelper 类 (http://nuget.org/packages/MvcContrib.Mvc3.TestHelper-ci)，您可以进一步简化它：

```
[TestMethod]
public void TestIgnoredRoute()
{
    // Arrange
    RouteTable.Routes.Clear();

    // Act
    GlobalApplication.RegisterRoutes(RouteTable.Routes);

    // Assert
    "~/some.axd/path".ShouldBeIgnored();
} 
```

# c# - 为什么这段代码会锁定我的文件？

> ID：805041
> 
> 赞同：5
> 
> 时间：2009-04-30T01:38:52.177
> 
> 标签：c#, .net, file, locking, wallpaper

我已经缩小到这种方法，但我不明白为什么它会锁定文件。我相信你可以使用类似的东西

```
using( something)
{

//do stuff here
} 
```

但我不确定 A) 是否会解决问题或 B) 是否是正确的方法。

有任何想法吗？

```
[DllImport("user32.dll", CharSet = CharSet.Auto)]private static extern Int32 SystemParametersInfo(UInt32 action, UInt32 uParam, String vParam, UInt32 winIni);  
    private static readonly UInt32 SPI_SETDESKWALLPAPER  = 0x14;  
    private static readonly UInt32 SPIF_UPDATEINIFILE    = 0x01;  
    private static readonly UInt32 SPIF_SENDWININICHANGE = 0x02;  

    private void SetWallpaper(string path)
    {
        try
        {
            Image imgInFile = Image.FromFile(path);
            imgInFile.Save(SaveFile, ImageFormat.Bmp);
            SystemParametersInfo(SPI_SETDESKWALLPAPER, 3, SaveFile, SPIF_UPDATEINIFILE | SPIF_SENDWININICHANGE);
        }
        catch
        {
            MessageBox.Show("error in setting the wallpaper");
        }
    } 
```

#

更新代码

```
 private void SetWallpaper(string path)
    {
        if (File.Exists(path))
        {
            Image imgInFile = Image.FromFile(path);
            try
            {
                imgInFile.Save(SaveFile, ImageFormat.Bmp);
                SystemParametersInfo(SPI_SETDESKWALLPAPER, 3, SaveFile, SPIF_UPDATEINIFILE | SPIF_SENDWININICHANGE);
            }
            catch
            {
                MessageBox.Show("error in setting the wallpaper");
            }
            finally
            {
                imgInFile.Dispose();
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-30T01:48:31.077

来自[MSDN](http://msdn.microsoft.com/en-us/library/stf701f5.aspx)：“在处理图像之前，文件保持锁定状态。” - 所以是的，这应该通过以下方式解决：

```
using (Image imgInFile ...) { ... } 
```

（作为旁注，我会将 try catch 收紧到 .Save() 和/或 SystemParametersInfo() 调用）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-30T01:52:14.110

一旦你离开**using**块，所有在其中初始化的对象都会被释放。在您的情况下，将处理对象，这将删除文件上的锁定。

您必须手动处理（通过**using**语句或通过在对象上调用*.Dispose()）*对 COM 或 Windows API 函数的任何非托管调用（即，当您使用互操作时）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-30T04:54:25.577

这是我所拥有的，如果你看到任何我可以修饰的东西，请告诉我。但它像冠军一样工作，所以我很高兴。

```
 private void SetWallpaper(string path)
                {
                    if (File.Exists(path))
                    {
                        Image imgInFile = Image.FromFile(path);
                        try
                        {
                            imgInFile.Save(SaveFile, ImageFormat.Bmp);
                            SystemParametersInfo(SPI_SETDESKWALLPAPER, 3, SaveFile, SPIF_UPDATEINIFILE | SPIF_SENDWININICHANGE);
                        }
                        catch
                        {
                            MessageBox.Show("error in setting the wallpaper");
                        }
                        finally
                        {
                            imgInFile.Dispose();
                        }
                    }

                    Else
                    {
                          messagebox.show("Error with path: "+path+" Not found or in use");
                    }
                } 
```

# windows - 如何从 Windows 应用程序生成 Linux 进程？

> ID：805045
> 
> 赞同：5
> 
> 时间：2009-04-30T01:42:45.397
> 
> 标签：windows, linux, delphi, spawning

我的交互式 32 位 Windows 应用程序（现在从 Delphi [Ent] 2007 移动到 2009 年）使用命令行交互来生成执行计算密集型任务的子进程，这些子进程反过来编写 GUI 父应用程序解析和分析的文本文件 -导致结果的交互式图形显示。

我可以访问多处理器（多用户）Linux 集群（通过 ssh），并希望将繁重的工作转移到该集群。我的问题是如何从我的 Windows 应用程序中生成 Linux 中的进程。我可以设想使用安全 FTP 来放置和获取文件，但不确定如何在 Linux 中生成子进程。

一些进一步阅读的线索会很好 - 但代码/伪代码将是理想的。我可以想象这可能更多是关于 Windows-Linux 交互而不是 Delphi。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-30T02:19:34.530

如果您有权访问 ssh，则一种选择是通过它发出命令。例如：

```
ssh user@host ls -l ~ 
```

将在 ssh 终端中显示用户主目录中的文件。我不确定这是否是你真正想要的。但它可能会奏效。

如果你这样做，你几乎肯定想要设置[SSH 密码少的登录](http://www.debian-administration.org/articles/152)

然而，更理想的解决方案可能是在 linux 机器上设置一个守护程序，其唯一工作是在后台运行特定的长时间运行的任务，并让您稍后获取结果。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-30T02:20:33.513

你将不得不在 Linux 机器上安装一些东西来运行这个过程。您可能会发现可以从 Windows 安装和访问的某种集群或批处理作业提交 API。您可能需要编写自定义服务器。如果您可以从 Windows 驱动 ssh 进程并且在 Linux 端安装了 sshd，则您可能能够通过 ssh 运行所有内容。但我的偏好是在 Linux 端编写一个 web 服务或简单的 CGI 脚本，旨在获取您的参数和数据，并通过普通的旧 http（或 https，视情况而定）返回结果。

不管怎样，这将不仅仅包含在 Windows 端的编码。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-30T02:26:35.103

我会下载完整的“腻子”包。

除了出色的安全 shell 终端外，它还包括用于安全传输文件的 PSCP 和通过 SSH 远程执行命令的 PLINK。

提示：您需要设置完整的公钥/私钥配置，PLINK 才能在没有烦人的密码提示的情况下工作。有一个有用的指南 http://unixwiz.net/techtips/putty-openssh.html>here。

# django - Django 模型验证是否仅通过表单 API 处理？

> ID：805047
> 
> 赞同：8
> 
> 时间：2009-04-30T01:44:12.350
> 
> 标签：django, django-models

这是创建自定义模型验证的唯一方法吗？使用表格来做到这一点？如果我想通过表单以外的方式向数据库发送数据怎么办？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-30T11:02:05.460

目前 Django 不提供任何模型级别的验证（除了基本的“NOT NULL”、“UNIQUE”和长度验证）。这在 TODO 列表中，但很可能不适合即将发布的 1.1 版本。

您可以在模型的方法中执行与验证相关的任务`save()`或使用`before_save`信号（在信号处理程序中引发异常将导致事务回滚）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-01-20T06:30:33.663

模型验证将很快在 Django 1.2 版中可用。如果您使用当前的 Django svn checkout 主干，它**现在**可用。

现在有各种`clean`方法可用。有关详细信息，请参阅[http://docs.djangoproject.com/en/dev/ref/models/instances/#id1](http://docs.djangoproject.com/en/dev/ref/models/instances/#id1)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-30T02:17:48.637

一般来说，您应该能够通过内置[字段类型](http://docs.djangoproject.com/en/dev/ref/models/fields/)及其选项或[模型的元选项](http://docs.djangoproject.com/en/dev/topics/db/models/#id3)来处理您想要的内容。您还可以[覆盖 save 方法](http://docs.djangoproject.com/en/dev/topics/db/models/#overriding-predefined-model-methods)来执行验证/清理。如果这还不够，您可以创建自己的[字段类型](http://docs.djangoproject.com/en/dev/howto/custom-model-fields/#howto-custom-model-fields)。

问题是没有良好的预期行为。应该发生什么？是否应该提出异常？这些字段实际上只是数据库级别的抽象，因此其中的信息不应超过数据库需要知道的信息。

# c - K&R Exercise 2-3 "Hex to int converter" Problem

> ID：805049
> 
> 赞同：3
> 
> 时间：2009-04-30T01:44:32.443
> 
> 标签：c, kernighan-and-ritchie, kr-c

The program I wrote works in demographics consisting of only single Hexadecimal values. (Probably not the most elegant solution, but I'm a new programmer) My question is, how would I go about handling of multiple hexadecimal digits, such as 0xAF, or 0xFF, etc? I'm not exactly sure, and I've seemed confuse myself greatly, in the attempt. I'm not asking for someone to hold my hand, but to give me a tip where I've gone wrong in this code and thoughts on how to fix it.

Thanks :)

```
/* Exercise 2-3\.  Write the function htoi(s), which converts a string of
 * hexadecimal digits (including an optional 0x or 0X) into it's equivalent
 * integer value. The allowable digits are 0...9 - A...F and a...f.
 * 
 */

#include <stdio.h>
#include <string.h>

#define NL '\n'
#define MAX 24

int htoi(char *hexd);

int
main(void)
{
    char str[MAX] = {0};
    char hex[] = "0123456789ABCDEFabcdef\0";
    int c;
    int i;
    int x = 0;

    while((c = getchar()) != EOF) {
        for(i = 0; hex[i] != '\0'; i++) {
            if(c == hex[i])
                str[x++] = c;
        }
        if(c == NL) {
            printf("%d\n", htoi(str));
            x = 0, i = x;
        }
    }
    return 0;
}

int
htoi(char *hexd) 
{
    int i;
    int n = 0;

    for(i = 0; isdigit(hexd[i]); i++)
        n = (16 * i) + (hexd[i] - '0');
    for(i = 0; isupper(hexd[i]); i++) /* Let's just deal with lowercase characters */
        hexd[i] = hexd[i] + 'a' - 'A';
    for(i = 0; islower(hexd[i]); i++) {
        hexd[i] = hexd[i] - 'a';
        n = (16 + i) + hexd[i] + 10;
        n = hexd[i] + 10;
    }
    return n;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-30T06:25:08.043

我将选择一个循环，并让您重新考虑您的实现。具体来说：

```
for(i = 0; isdigit(hexd[i]); i++)
    n = (16 * i) + (hexd[i] - '0'); 
```

没有做你可能认为它会做的事情......

*   它只处理第一个`isdigit()`为 TRUE 的字符范围。
*   它在第一个`isdigit()`为 FALSE 的字符处停止。
*   它不会超过结尾，因为`isdigit('\0')`已知为 FALSE。不过，我担心这可能会意外正确。
*   它确实正确转换了只​​能用数字 0-9 表示的十六进制数。

整个程序要考虑的事情：

*   一般来说，最好不要修改输入字符串，除非修改是有价值的副作用。在您的示例代码中，您正在强制字符串就地小写。就地修改输入字符串意味着用户`htoi("1234")`正在调用*未定义的行为*。你真的*不想那样*做。
*   只有一个数字循环将处理非零位数。
*   如果我发送`0123456789ABCDEF0123456789ABCDEF`到会发生什么`stdin`？
*   你期望得到`80000000`什么？你得到了什么？你惊喜吗？
*   就个人而言，我不会使用`NL`for `'\n'`。C 的用法几乎希望`\n`在很多不方便使用宏的上下文中看到，所以最好现在就习惯它......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-30T01:48:29.313

Someone has alredy asked this (hex to int, k&r 2.3). Take a look, there are many good answers, but you have to fill in the blanks.

[Hex to Decimal conversion [K&R exercise]](https://stackoverflow.com/questions/788026/hex-to-decimal-conversion-kr-exercise/788205#788205)

Edit:

in

```
char hex[] = "0123456789ABCDEFabcdef\0"; 
```

The \0 is not necesary. hex is alredy nul terminated. Is len (0...f) + 1 = 17 bytes long.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-17T03:34:26.227

我认为字符串的 MAX 大小应该是 10 或 18 而不是 24。（如果你已经`int`在你的机器上检查过并遵循下面的推理，将它作为注释包含在你的代码中会很有好处。）

10：因为`htoi()`返回一个`int`，int通常是4个字节（检查你的系统也是），所以十六进制数的长度最多可以是8位（4位到1个十六进制位，8位到一个字节），我们希望允许可选`0x`或`0X`。

`htoi()`18 ：如果返回 a和它的 8 个字节会更好`long`（再次检查你的系统），所以十六进制数的长度最多可以是 16 位，我们希望允许可选的`0x`or `0X`。

请注意`int`和`long`的大小取决于机器，请查看 K&R 书中的练习 2.1 以找到它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-07-27T20:38:32.770

这是我的经典 htoi() 函数版本，用于将多个十六进制值转换为十进制整数。这是一个完整的工作程序，编译并运行。

```
#include <stdio.h>
#include <ctype.h>
#include <string.h>
#include <stdlib.h>

int htoi(const char*);
int getRawInt(char);

int main(int argc, char **argv) {
    char hex[] = "       ";
    printf("Enter a hexadecimal number (i.e 33A)\n");
    scanf("%s", hex);

    printf("Hexedecimal %s in decimal is %d\n", hex, htoi(hex)); // result will be 826
    return 0;
}

int htoi(const char *hex) {
    const int LEN = strlen(hex) -1;
    int power = 1;
    int dec = 0;

    for(int i = LEN; i >= 0; --i) {
        dec += getRawInt(hex[i]) * power;
        power *= 16;
    }

    return dec;
}

int getRawInt(char c) {
    if(isalpha(c)) {
        return toupper(c) - 'A' + 10;
    } return c-'0';
} 
```

# java - Emacs 上的 Eclipse 缩进

> ID：805050
> 
> 赞同：7
> 
> 时间：2009-04-30T01:45:43.143
> 
> 标签：java, eclipse, emacs

我是一名 emacs 用户，刚开始为一家以 eclipse 为标准的新公司工作。我尝试过 eclipse，但我也想尝试 JDEE（我在长时间的中断后回到 Java）。到目前为止，主要的绊脚石是让缩进匹配。有没有一种简单的方法可以做到这一点，还是我需要深入研究 emacs 缩进的具体细节？

编辑：很抱歉这个问题的混淆：我不想让 Eclipse 模仿 emacs，我想让 emacs 模仿 Eclipse。我希望能够使用 emacs 来修改代码，而不会破坏 Eclipse 用户期望的缩进。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2011-01-05T04:27:06.943

我发现 Eclipse（和 IntelliJ）和 Emacs 默认 java 格式之间的主要区别是 Emacs 将函数参数与之前的参数一起排入新行，例如 emacs 会：

```
BigLongJavaStuff.doFoobarToQuux("argument 1",
                                "argument 2"); 
```

Eclipse 会：

```
BigLongJavaStuff.doFoobarToQuux("argument 1",
        "argument 2"); 
```

添加到您的 ~/.emacs 文件中的以下内容将使 Emacs java-mode 执行相同的操作：

```
;; eclipse-java-style is the same as the "java" style (copied from
;; cc-styles.el) with the addition of (arglist-cont-nonempty . ++) to
;; c-offsets-alist to make it more like default Eclipse formatting -- function
;; arguments starting on a new line are indented by 8 characters
;; (++ = 2 x normal offset) rather than lined up with the arguments on the
;; previous line
(defconst eclipse-java-style
  '((c-basic-offset . 4)
    (c-comment-only-line-offset . (0 . 0))
    ;; the following preserves Javadoc starter lines
    (c-offsets-alist . ((inline-open . 0)
                        (topmost-intro-cont    . +)
                        (statement-block-intro . +)
                        (knr-argdecl-intro     . 5)
                        (substatement-open     . +)
                        (substatement-label    . +)
                        (label                 . +)
                        (statement-case-open   . +)
                        (statement-cont        . +)
                        (arglist-intro  . c-lineup-arglist-intro-after-paren)
                        (arglist-close  . c-lineup-arglist)
                        (access-label   . 0)
                        (inher-cont     . c-lineup-java-inher)
                        (func-decl-cont . c-lineup-java-throws)
                        (arglist-cont-nonempty . ++)
                        )))
  "Eclipse Java Programming Style")
(c-add-style "ECLIPSE" eclipse-java-style)
(customize-set-variable 'c-default-style (quote ((java-mode . "eclipse") (awk-mode . "awk") (other . "gnu")))) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-30T03:44:28.490

您需要在 java 模式下自定义缩进。看看[这里](http://cc-mode.sourceforge.net/html-manual/Indentation-Engine-Basics.html#Indentation-Engine-Basics)，[这里](http://cc-mode.sourceforge.net/html-manual/Customizing-Indentation.html#Customizing-Indentation)和[这里](http://cc-mode.sourceforge.net/html-manual/Adding-Styles.html#Adding-Styles)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-30T03:08:31.260

老实说：我不确定您所说的使 Eclipse 的缩进匹配 Emacs 的确切含义。但是你可以在这里修改缩进： `Windows->Preferences-General->Editors`

单击“文本编辑器”选项，您将看到选项卡宽度属性。

还有一点需要注意的是，Eclipse 内置了 Emacs 样式的键绑定： `Windows->Preferences->General->Keys`

在“方案”下，有一个 Emacs 选项。

注意：您还可以在此处修改 Java 代码的格式： `Windows->Preferences->Java->Code Style->Formatter`

# stl - how to make a map ?

> ID：805053
> 
> 赞同：1
> 
> 时间：2009-04-30T01:47:08.773
> 
> 标签：stl, map

I want to create a container which can associate a CLSID structure to something else (for example, a string); for example, std::map.

(the CLSID means standard Windows CLSID structure)

However when I want to use its find() and insert (object[clsid] = string), the STL just failed and gives errors.

Does anyone know how to solve this?

For example:

```
typedef std::map<CLSID, std::string> MyCLSIDMap;
MyCLSIDMap mymap;
CLSID sample = CLSID_NULL;

mymap[sample] = string("test");   // compilation failed here 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-30T01:59:01.567

As Alex has answered, std::map needs to compare it's keys with op<.

```
bool operator<(CLSID const& l, CLSID const& r)
{
    return memcmp(&l, &r, sizeof(CLSID)) < 0;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-30T01:56:58.310

Does your CLSID structure support a usable operator<()? That's crucial for std::map (you can build it as a separate bool functor taking two const CLSID& arguments, it doesn't have to be a method operator<() in CLSID -- but then you'll have to say std::map and not just map ...!).

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-30T02:02:06.707

要使用键是结构的 STL 映射，您需要提供自己的严格弱排序函数对象：

```
struct CompareCLSID
{
  bool operator()(const CLSID &s1, const CLSID &s2) const
  {
    // returns true if s1 is less than s2
  }
}; 
```

然后您的地图类型将是 map<CLSID, string, CompareCLSID>。

但是，如果您不需要对容器进行排序（这是我的猜测），您应该使用 hash<> 或 hash_map<>。在这种情况下，您必须提供自己的哈希函数。

# vb.net - How can I delete an entry from an array?

> ID：805056
> 
> 赞同：0
> 
> 时间：2009-04-30T01:47:46.383
> 
> 标签：vb.net, visual-studio-2008

I am using Visual Basic 2008, and I am making a simple meeting planner program. The data stored for each day is stored into an array with three fields:

calendars.Days
calendars.ToD
calendars.Appointment

Days stores the selected day corresponding to the MonthCalendar object of the entry.
ToD is the time of day selected by a combobox of times for the appointment.
Appointment is whatever description in a textbox the appointment is given.

Whenever a day is selected on the MonthCalendar object, it loads all of the data from that day that is in the array and displays it in a listbox called lstResult. What I am trying to do is, when I press the delete key on a selected entry in the listbox, it deletes that entry in the array and the listbox. The listbox part is easy, I just need help on deleting the selection from the array.

Anyone got any ideas on how to go about this? Note that I am not much of an expert on Visual Basic so some things might need a little explanation to them.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-30T02:03:53.427

如果你想使用一个数组，你可以改变你的设计，包括一个标志来标记那些被“删除”的项目；您可以将它们视为“逻辑删除”（一个好处是您可以恢复以前删除的内容）并在视图中过滤那些未标记的内容。明白了吗？只是我的 0.02 美元。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-30T02:36:06.597

作为一个建议，我建议创建一个 CalenderAppointment 类并使用 CalenderAppointment 类的通用列表。通过这样做，您将获得 Linq 和泛型的所有优点。

```
dim myAppointments as new List(of CalenderAppointment)

public sub AddAppointment(appointment as CalenderAppointment)
    myAppointments.Add(appointment);
end sub

public sub RemoveAppointment(appointment as CalenderAppointment)
    myAppointments.Remove(appointment);
end sub

public class CalenderAppointment

    public Appointment as string
    public Days as integer
    public TimeOfDay as DateTime

end class 
```

Appointment、Days 和 TimeOfDay 确实应该成为属性，但为简单起见，您可以使用公共变量

看一眼[http://msdn.microsoft.com/en-us/library/w256ka79(VS.80).aspx](http://msdn.microsoft.com/en-us/library/w256ka79(VS.80).aspx)了解更多关于泛型的信息

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-30T01:54:29.083

In general, the Array interface does not support deleting specific objects. To do that, you should use some sort of list ([ArrayList](http://msdn.microsoft.com/en-us/library/system.collections.arraylist_members(VS.71).aspx), for example).

# wpf - How to change BK color of DatePicker's Calendar

> ID：805057
> 
> 赞同：0
> 
> 时间：2009-04-30T01:48:07.960
> 
> 标签：wpf, colors, background, datepicker

How to change the background color for a DatePicker's Calendar? Thanks!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-30T15:24:42.863

如果您说的是 Microsoft 的 WPF Toolkit DatePicker，一种可能性是获取 Toolkit 的[源代码](http://wpf.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=25047)，然后修改 DatePicker 的 Generic.xaml 主题文件。在 DatePicker 样式的 DatePickerTextBox 部分中添加 Background 属性，例如：

```
<primitives:DatePickerTextBox x:Name="PART_TextBox" 
    Grid.Row="0" Grid.Column="0" 
    Foreground="{TemplateBinding Foreground}" 
    Background="{TemplateBinding Background}"
    HorizontalContentAlignment="Stretch"
    VerticalContentAlignment="Stretch" /> 
```

# ruby-on-rails - 同时使用 MacPorts 和 RubyGems 有什么缺点吗？

> ID：805063
> 
> 赞同：2
> 
> 时间：2009-04-30T01:51:06.547
> 
> 标签：ruby-on-rails, ruby, macos, rubygems, macports

我是 Ruby on Rails 的新手，我正在我的 OS X 系统上设置它。大多数指南似乎建议使用 MacPorts 安装 Ruby 和 RubyGems，然后从那里使用 RubyGems 安装 gem。我注意到 MacPorts 还提供了许多 gem（尽管它们缺少一些，而另一些似乎落后了几个版本），我担心它会与我使用 RubyGems 安装的东西发生冲突。

有没有人有使用这种设置的经验？有什么建议吗？我想在第一次就做到这一点，这样我就不会在以后出现问题。

谢谢，

授予

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-30T03:52:13.947

我建议使用 Macports 安装 Ruby，然后按照[http://rubyonrails.org/down](http://rubyonrails.org/down)上的说明下载并安装最新版本的 Rubygems 。当你想安装一个新的 gem 时，使用 Rubygems，而不是 MacPorts。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-08T05:57:28.120

我使用 MacPorts 安装 Ruby 和 RubyGems，然后我使用`gem`命令（不是`port`）安装 gems。我发现 MacPorts 中的 Ruby gems 没有得到很好的维护，最新的 MacPorts 版本通常大大落后于“真实”版本（因为没有更好的术语）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-20T16:28:46.493

MacPorts 非常适合做很多事情。但是，[RVM](http://rvm.io)通常是一种更灵活的 Ruby 安装方式，因为它可以轻松地为*每个项目*安装合适的 Ruby 解释器。

# wpf - Getting started in WPF

> ID：805065
> 
> 赞同：7
> 
> 时间：2009-04-30T01:52:18.370
> 
> 标签：wpf, evaluation

We are evaluating the use of WPF for an upcoming project. We plan to "commercialize" some of our internal tools and could really use some of the effects WPF offers. We also like the idea of the design layer and code layers being independent to allow concurrent work.

1.  Where can I find a simple UI built with WPF (XAML) that I can pull apart?

2.  What is the workflow if the designer is creating the UI and the developers are coding. What does the design staff give the developers (.XAML files? an assembly?)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-30T02:04:56.857

[来自微软。](http://windowsclient.net/wpf/starter-kits/sce.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-30T02:33:45.463

一个界面相对简单且设计良好的开源应用程序是crack.net。我用它终于理解了mvvm。

至于设计工作流程，这对您来说是一个更难回答的问题。你需要弄清楚什么对你和你的设计师有用。他们*可以*与您的开发人员在同一个 .proj 文件中工作，这非常方便。但是您可能希望将这些程序集分开以进行管理。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-30T03:24:59.847

就工作流程而言。
我曾在一个有专门的 UI 设计师的团队工作。尽管他拥有 CS 学位，但他表示使用 Blend 会过多地分散 UI 设计的注意力。所以他仍然在做模型，一个开发人员在 Blend+VS+manual XAML 调整中翻译它。
此外，尽管有人声称，Blend 作为示例片段编辑器最有用，可以更好地理解 XAML。
在我当前的 WPF 项目中，我主要使用 Kaxaml，因为我安装 VS 时的 WPF 编辑器非常缓慢且不稳定。
这个想法是您的设计人员将为您生成 XAML，而开发人员只需向其中添加代码 - 对我们不起作用。老实说，我根本看不出它是如何工作的。由于 UI 中仍有许多内容需要针对表示层进行调整。
此外，任何 UI 技术都可以隔离在设计良好的系统中。而且我真的没有看到 WPF 的任何优势。尤其是 MS 如此热切地推动数据绑定。

# python - 如何从 Python 中的子类调用父类的方法？

> ID：805066
> 
> 赞同：720
> 
> 时间：2009-04-30T01:52:31.707
> 
> 标签：python, class, oop, object, inheritance

在 Python 中创建简单的对象层次结构时，我希望能够从派生类调用父类的方法。在 Perl 和 Java 中，这个 ( [`super`](https://docs.oracle.com/javase/tutorial/java/IandI/super.html)) 有一个关键字。在 Perl 中，我可能会这样做：

```
package Foo;

sub frotz {
    return "Bamf";
}

package Bar;
@ISA = qw(Foo);

sub frotz {
   my $str = SUPER::frotz();
   return uc($str);
} 
```

在 Python 中，似乎我必须从子类中显式命名父类。在上面的示例中，我必须执行类似`Foo::frotz()`.

这似乎不正确，因为这种行为使得很难建立深层层次结构。如果孩子需要知道什么类定义了一个继承的方法，那么就会产生各种信息的痛苦。

这是python的实际限制，我理解的差距还是两者兼而有之？

* * *

## 回答 #1

> 赞同：901
> 
> 时间：2009-04-30T01:58:28.557

使用[`super()`](http://docs.python.org/library/functions.html#super)功能：

```
class Foo(Bar):
    def baz(self, **kwargs):
        return super().baz(**kwargs) 
```

对于 Python < 3，您必须明确选择使用[新型类](http://docs.python.org/glossary.html#term-new-style-class)并使用：

```
class Foo(Bar):
    def baz(self, arg):
        return super(Foo, self).baz(arg) 
```

* * *

## 回答 #2

> 赞同：152
> 
> 时间：2009-04-30T01:58:31.350

Python 也有[super](http://docs.python.org/library/functions.html)：

`**super**(type[, object-or-type])`

> 返回一个代理对象，它将方法调用委托给类型的父类或同级类。这对于访问已在类中重写的继承方法很有用。搜索顺序与 getattr() 使用的相同，只是跳过了类型本身。

例子：

```
class A(object):     # deriving from 'object' declares A as a 'new-style-class'
    def foo(self):
        print "foo"

class B(A):
    def foo(self):
        super(B, self).foo()   # calls 'A.foo()'

myB = B()
myB.foo() 
```

* * *

## 回答 #3

> 赞同：88
> 
> 时间：2009-04-30T02:02:38.017

```
ImmediateParentClass.frotz(self) 
```

会很好，无论是直接父类定义`frotz`自己还是继承它。 *仅在正确支持多重*`super`继承时才需要（然后只有在每个类都正确使用它时才有效）。一般来说，如果没有定义/覆盖它，就会在's 的祖先中查找，这对于“子类调用父类的方法”和任何其他事件都是如此！*`AnyClass.whatever``whatever``AnyClass``AnyClass`*

 ** * *

## 回答 #4

> 赞同：81
> 
> 时间：2016-07-26T10:12:08.290

**Python 3**具有不同且更简单的调用父方法的语法。

如果`Foo`类继承自`Bar`，则`Bar.__init__`可以从`Foo`via调用 from `super().__init__()`：

```
class Foo(Bar):

    def __init__(self, *args, **kwargs):
        # invoke Bar.__init__
        super().__init__(*args, **kwargs) 
```

* * *

## 回答 #5

> 赞同：63
> 
> 时间：2017-07-11T14:32:30.577

许多答案已经解释了如何从父级调用已在子级中覆盖的方法。

然而

> “你如何从子类中调用父类的方法？”

也可能意味着：

> “你怎么称呼继承的方法？”

您可以调用从父类继承的方法，就像它们是子类的方法一样，只要它们没有被覆盖。

例如在 python 3 中：

```
class A():
  def bar(self, string):
    print("Hi, I'm bar, inherited from A"+string)

class B(A):
  def baz(self):
    self.bar(" - called by baz in B")

B().baz() # prints out "Hi, I'm bar, inherited from A - called by baz in B" 
```

是的，这可能是相当明显的，但我觉得如果不指出这一点，人们可能会给这个帖子留下这样的印象，你必须跳过荒谬的圈子才能访问 python 中的继承方法。尤其是当这个问题在搜索“如何在 Python 中访问父类的方法”时得到很高的评价，并且 OP 是从 Python 新手的角度编写的。

我发现： [https](https://docs.python.org/3/tutorial/classes.html#inheritance) ://docs.python.org/3/tutorial/classes.html#inheritance 有助于理解如何访问继承的方法。

* * *

## 回答 #6

> 赞同：28
> 
> 时间：2013-04-17T10:44:59.577

这是使用**super()**的示例：

```
#New-style classes inherit from object, or from another new-style class
class Dog(object):

    name = ''
    moves = []

    def __init__(self, name):
        self.name = name

    def moves_setup(self):
        self.moves.append('walk')
        self.moves.append('run')

    def get_moves(self):
        return self.moves

class Superdog(Dog):

    #Let's try to append new fly ability to our Superdog
    def moves_setup(self):
        #Set default moves by calling method of parent class
        super(Superdog, self).moves_setup()
        self.moves.append('fly')

dog = Superdog('Freddy')
print dog.name # Freddy
dog.moves_setup()
print dog.get_moves() # ['walk', 'run', 'fly']. 
#As you can see our Superdog has all moves defined in the base Dog class 
```

* * *

## 回答 #7

> 赞同：14
> 
> 时间：2009-04-30T01:58:46.327

Python 中也有一个 super()。由于 Python 的旧式和新式类，这有点奇怪，但在构造函数中非常常用：

```
class Foo(Bar):
    def __init__(self):
        super(Foo, self).__init__()
        self.baz = 5 
```

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2011-12-31T17:39:11.217

我建议使用`CLASS.__bases__` 这样的东西

```
class A:
   def __init__(self):
        print "I am Class %s"%self.__class__.__name__
        for parentClass in self.__class__.__bases__:
              print "   I am inherited from:",parentClass.__name__
              #parentClass.foo(self) <- call parents function with self as first param
class B(A):pass
class C(B):pass
a,b,c = A(),B(),C() 
```

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2015-12-09T16:13:51.383

如果您不知道可能会得到多少参数，并且还想将它们全部传递给孩子：

```
class Foo(bar)
    def baz(self, arg, *args, **kwargs):
        # ... Do your thing
        return super(Foo, self).baz(arg, *args, **kwargs) 
```

（来自：[Python - 覆盖 __init__ 的最干净的方法，在 super() 调用之后必须使用可选的 kwarg？](https://stackoverflow.com/questions/5031711/python-cleanest-way-to-override-init-where-an-optional-kwarg-must-be-used)）

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2014-12-10T13:21:18.007

python中也有一个super()。

如何从子类方法调用超类方法的示例

```
class Dog(object):
    name = ''
    moves = []

    def __init__(self, name):
        self.name = name

    def moves_setup(self,x):
        self.moves.append('walk')
        self.moves.append('run')
        self.moves.append(x)
    def get_moves(self):
        return self.moves

class Superdog(Dog):

    #Let's try to append new fly ability to our Superdog
    def moves_setup(self):
        #Set default moves by calling method of parent class
        super().moves_setup("hello world")
        self.moves.append('fly')
dog = Superdog('Freddy')
print (dog.name)
dog.moves_setup()
print (dog.get_moves()) 
```

这个例子与上面解释的类似。但是有一个区别是 super 没有任何参数传递给它。上面的代码在 python 3.4 版本中是可执行的。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2018-10-30T14:53:36.503

在这个例子`cafec_param`中是一个基类（父类）并且`abc`是一个子类。`abc`调用`AWC`基类中的方法。

```
class cafec_param:

    def __init__(self,precip,pe,awc,nmonths):

        self.precip = precip
        self.pe = pe
        self.awc = awc
        self.nmonths = nmonths

    def AWC(self):

        if self.awc<254:
            Ss = self.awc
            Su = 0
            self.Ss=Ss
        else:
            Ss = 254; Su = self.awc-254
            self.Ss=Ss + Su   
        AWC = Ss + Su
        return self.Ss

    def test(self):
        return self.Ss
        #return self.Ss*4

class abc(cafec_param):
    def rr(self):
        return self.AWC()

ee=cafec_param('re',34,56,2)
dd=abc('re',34,56,2)
print(dd.rr())
print(ee.AWC())
print(ee.test()) 
```

**输出**

```
56

56

56 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2017-01-21T19:12:38.600

在 Python 2 中，我对 super() 的运气并不好。我在这个 SO 线程上使用了 jimifiki 的答案[如何在 python 中引用父方法？](https://stackoverflow.com/questions/9347406/how-to-refer-to-a-parent-method-in-python). 然后，我添加了我自己的小改动，我认为这是对可用性的改进（特别是如果你有很长的类名）。

在一个模块中定义基类：

```
 # myA.py

class A():     
    def foo( self ):
        print "foo" 
```

然后将该类导入另一个模块`as parent`：

```
# myB.py

from myA import A as parent

class B( parent ):
    def foo( self ):
        parent.foo( self )   # calls 'A.foo()' 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-03-28T06:39:56.383

```
class department:
    campus_name="attock"
    def printer(self):
        print(self.campus_name)

class CS_dept(department):
    def overr_CS(self):
        department.printer(self)
        print("i am child class1")

c=CS_dept()
c.overr_CS() 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2022-01-14T17:05:44.497

如果要调用任何类的方法，只需调用`Class.method`该类的任何实例即可。如果您的继承相对干净，这也适用于子类的实例：

```
class Foo:
    def __init__(self, var):
        self.var = var

    def baz(self):
        return self.var

class Bar(Foo):
    pass

bar = Bar(1)
assert Foo.baz(bar) == 1 
```

* * *

## 回答 #15

> 赞同：-4
> 
> 时间：2018-08-31T13:39:59.050

```
class a(object):
    def my_hello(self):
        print "hello ravi"

class b(a):
    def my_hello(self):
    super(b,self).my_hello()
    print "hi"

obj = b()
obj.my_hello() 
```

* * *

## 回答 #16

> 赞同：-26
> 
> 时间：2011-06-20T05:32:22.070

这是一个更抽象的方法：

```
super(self.__class__,self).baz(arg) 
```

# python - Server Side Google Markers Clustering - Python/Django

> ID：805072
> 
> 赞同：7
> 
> 时间：2009-04-30T01:55:16.130
> 
> 标签：python, django, json, google-maps, markerclusterer

After experimenting with client side approach to clustering large numbers of Google markers I decided that it won't be possible for my project (social network with 28,000+ users).

Are there any examples of clustering the coordinates on the server side - preferably in Python/Django?

The way I would like this to work is to gradually index the markers based on their proximity (radius) and zoom level.

In another words when a new user registers he/she is automatically assigned to a certain 'group' of markers that are close to each other thus increasing the 'group's' counter. What's being send to the server is just a small number of 'groups'. Only when the zoom level/scale of map is 1:1 - actual users are shown on the map.

That way the client side will have to deal only with 10-50 markers per request/zoom level.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-30T14:57:03.023

[This](http://www.maptimize.com/) is a paid service that uses server-side clustering, but I'm not sure how it works. I'm guessing that they just use your data to generate the markers to be shown at each zoom level.

**Update:** [This tutorial](http://www.appelsiini.net/2008/11/introduction-to-marker-clustering-with-google-maps) demonstrates a basic server-side clustering function. It's written in PHP for the Static Maps API, but you could use it as a starting point.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-08-15T09:02:07.763

您可能想查看维基百科上的[DBSCAN](http://en.wikipedia.org/wiki/DBSCAN)和[OPTICS](http://en.wikipedia.org/wiki/OPTICS_algorithm)页面，这些页面看起来非常适合在地图上对地点进行聚类。还有一个关于[聚类分析](http://en.wikipedia.org/wiki/Cluster_analysis)的页面，显示了您可以使用的所有可能的算法，使用您选择的语言来实现大多数算法都是微不足道的。

有了 28k+ 点，您可能想跳过 django 直接跳到 C/C++ 中，当然不会期望这会实时计算以响应 Web 请求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-30T12:40:04.803

一种方法是根据缩放级别定义具有单位大小的网格。因此，您将网格中的所有项目按纬度、经度收集到小数点后一位。一个例子是 42.2x73.4。所以 42.2003x73.4021 的点落在该网格单元中。该单元格以 42.2x73.3 和 42.2x73.5 为界。

如果网格单元中有一个或多个点，则在该网格的中心放置一个标记。

然后，您连接 zoomend 事件并相应地更改网格大小，然后重绘标记。

[http://code.google.com/apis/maps/documentation/reference.html#GMap2.zoomend](http://code.google.com/apis/maps/documentation/reference.html#GMap2.zoomend)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-20T19:50:51.253

你可以试试我的服务器端集群 django 应用：

[https://github.com/biodiv/anycluster](https://github.com/biodiv/anycluster)

它提供了一个 kmeans 和一个网格集群。

# php - PHPDoc 冗长是否比它的价值更麻烦？

> ID：805084
> 
> 赞同：4
> 
> 时间：2009-04-30T01:58:38.340
> 
> 标签：php, documentation, phpdoc

我今天第一次尝试使用 PHPDoc，很快就遇到了问题。

对于每 1 行变量声明，我至少有 5 行注释。例子：

```
/**
 * Holds path the remote server
 * @name ...
 * @global ...
 */
 $myvar = ... 
```

当然，回报是不错的——但这会将一个 10 行的配置文件变成一个 60 行的文件。需要我永远填写，而且我还不相信它比简单的单行增加了那么多。

它也给我的工作流程带来了麻烦。一切都很好，直到我需要进行彻底的改变。有了我记录良好的文档块，突然之间我不再需要重构我的代码，但我需要重新编写所有这些繁琐的细节。等到你说的最后？哈哈！那么文档将永远不会发生。

最重要的是 - 它迫使我在我的代码中间使用 C 风格的 /**/ 注释。这让我在开发过程中发疯，因为它剥夺了按需注释掉大块的能力。现在要注释掉一大块代码，我需要提取类似 :range,s/^/#/ 的内容；然后稍后撤消它。恼人的！

长话短说 - 我喜欢 PHPDoc，我喜欢有据可查的代码 - 但是每行代码 5 行注释实在是*太多了！*. 有我缺少的功能吗？这是个常见的问题吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-30T02:37:39.853

它是否过度杀伤在很大程度上取决于您的应用程序的预期用途。如果您正在编写一个仅供单个公司或团体使用的应用程序，您可能不需要每个变量的详尽文档。

例如，现在我正在开发一个具有相当广泛的代码库但开发人员很少（目前只有我）的项目。我正在为两件事添加 PHPDoc 块：类和方法。对于其他一切，我经常评论，但不是冗长的 PHPDoc 格式。大部分代码只会被三四个人看到，他们需要的信息是黑盒信息：我向这个方法发送什么，我希望从中得到什么。他们想知道如何从模型中获取数据，而不是私有类变量的用途。

如果我正在编写一个打算分发给其他开发人员或公司的应用程序，并且我希望他们将我的应用程序与其他系统集成或扩展其功能，我会更加重视更广泛的 PHPDoc 使用。在长期维护期间，这种细节肯定会派上用场。

举个例子，我当前的项目在某些时候需要创建一个可以从其他站点访问的 API。你可以打赌，API 会比代码行有更多的评论和书面文档。

# c - 帮我创建一个 Makefile

> ID：805087
> 
> 赞同：1
> 
> 时间：2009-04-30T01:59:57.290
> 
> 标签：c, makefile

支持你有一个C程序被一些文件包含，一些文件由一些其他文件组成，如下：

```
----------------------------------------
File            | Included files           
----------------------------------------
main.c          | stdio.h, table.h
----------------------------------------
list.c          | list.h
----------------------------------------
symbol.c        | symbol.h
----------------------------------------
table.c         | table.h
----------------------------------------
table.h         | symbol.h, list.h
---------------------------------------- 
```

请帮我创建一个makefile，非常感谢！这是我的Makefile，但是有问题吗？谁能调试这些问题，谢谢！

```
hello:  main.o table.o 
    gcc main.o table.o -o hello

main.o: main.c table.h
    gcc -c main.c

table.o:    table.c table.h
    gcc -c table.c

symbol.o:   symbol.c symbol.h
    gcc -c symbol.c

list.o: list.c list.h
    gcc -c list.c

clean:
    rm hello *.o 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-30T02:21:09.313

这是一个开始，不完全是专业人士的做法，但对初学者来说很好：

```
hello: main.o list.o symbol.o table.o
    gcc -o hello main.o list.o symbol.o table.o

main.o: main.c table.h symbol.h list.h
    gcc -c -o main.o main.c

list.o: list.c list.h
    gcc -c -o list.o list.c

symbol.o: symbol.c symbol.h
    gcc -c -o symbol.o symbol.c

table.o: table.c table.h symbol.h list.h
    gcc -c -o table.o table.c

clean:
    rm hello *.o 
```

您给定的生成文件的具体问题是您没有链接所有目标文件。因为`main.c`包括`table.h`和`table.h`包括`symbol.h`和`list.h`，你的程序几乎肯定需要链接`symbol.o`和`list.o`。

遵循头文件依赖项也是一个很好的做法（例如，`main.o`取决于`table.h` *和* `symbol.h/list.h`因为`table.h`取决于这两个） - 这是因为没有“简洁”的方式来获取头文件依赖项的中间文件。

而且您很少将标准头文件放入 make 文件中，因为它们预计不会改变 - 如果他们这样做（新编译器），只需清理并重新制作。

# javascript - 将 4 行 Jquery 转换为 Mootools

> ID：805089
> 
> 赞同：1
> 
> 时间：2009-04-30T02:01:47.490
> 
> 标签：javascript, jquery, mootools

以下代码行做了两件事。前两行在具有给定 id 的元素之前和之后将类添加到兄弟姐妹（在本例中为 id 为“nav”的 UL）

最后两行将类 first 和 last 添加到其父级具有 id 为“nav”的第一个和最后一个兄弟元素。

这是jQuery。我将如何使用 Mootools 1.11 实现相同的目标。任何帮助表示赞赏。

```
$('#nav .active').prev().addClass('prevtab');
$('#nav .active').next().addClass('nexttab');
$('#nav').children(":first").addClass('first');
$('#nav').children(":last").addClass('last'); 
```

* * *

格式在评论中不起作用，因此对 zombat 重复：

使用 mootools 1.1 我没有可用的编辑按钮，我无法发表评论，因为我没有足够的代表。

您的解决方案正在做某事，但没有针对正确的元素。

这是我想要并使用 jquery 得到的结果：

```
<ul id="nav">
<li class="first"></li>
<li></li>
<li class="prevtab"></li>
<li class="active"></li>
<li class="nexttab"></li>
<li class="last"></li>
</ul> 
```

这是你的js的结果：

```
<div class="prevtab"></div>
<ul id="nav">
<li></li>
<li></li>
<li></li>
<li class="active"></li>
<li></li>
<li></li>
</ul>
<div class="nexttab"><div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-30T02:09:32.477

试一试。

```
$('nav').getNext().addClass('nexttab');
$('nav').getPrevious().addClass('prevtab');
var c = $('nav').getChildren();
c[0].addClass('first');
c[c.length-1].addClass('last'); 
```

编辑：现在工作。

第二次/第三次编辑：

好的，我误解了您使用 .active 类的方式。尝试这个：

```
var n = $('nav').getElement('.active').getNext();
if (n) n.addClass('nexttab');
var p = $('nav').getElement('.active').getPrevious();
if (p) p.addClass('prevtab');
var c = $('nav').getChildren();
c[0].addClass('first');
c[c.length-1].addClass('last'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-30T02:26:08.133

```
$each($$('#nav .active'),function(item){
                            item.getPrevious().classname='prevtab';
                         }
      ); 
```

这是第一行。

第二你可以使用 getNext
第三你可以使用 $('#nav').getFirst //确保它有孩子....
第四你可以使用 getLast

# javascript - 在 JavaScript 中创建多行字符串

> ID：805107
> 
> 赞同：3117
> 
> 时间：2009-04-30T02:11:55.560
> 
> 标签：javascript, string, multiline, heredoc

我在 Ruby 中有以下代码。我想将此代码转换为 JavaScript。JS中的等效代码是什么？

```
text = <<"HERE"
This
Is
A
Multiline
String
HERE 
```

* * *

## 回答 #1

> 赞同：4071
> 
> 时间：2009-04-30T02:15:20.593

### 更新：

ECMAScript 6 (ES6) 引入了一种新的文字类型，即[**模板文字**](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/template_strings)。它们有很多特性，变量插值等等，但对于这个问题最重要的是，它们可以是多行的。

模板文字由*反引号*分隔：

```
var html = `
  <div>
    <span>Some HTML here</span>
  </div>
`; 
```

（注意：我不提倡在字符串中使用 HTML）

[浏览器支持还可以](https://kangax.github.io/compat-table/es6/#test-template_literals)，但您可以使用[转译](https://babeljs.io/)器来提高兼容性。

* * *

### 原始 ES5 答案：

Javascript 没有 here-document 语法。但是，您可以转义文字换行符，这很接近：

```
"foo \
bar" 
```

* * *

## 回答 #2

> 赞同：1469
> 
> 时间：2011-06-06T02:30:45.620

## ES6 更新：

正如第一个答案所提到的，使用 ES6/Babel，您现在可以简单地使用反引号创建多行字符串：

```
const htmlString = `Say hello to 
multi-line
strings!`; 
```

插值变量是一个流行的新功能，它带有反引号分隔的字符串：

```
const htmlString = `${user.name} liked your post about strings`; 
```

这只是转译为串联：

```
user.name + ' liked your post about strings' 
```

## 原始 ES5 答案：

> [Google 的 JavaScript 样式指南](https://google.github.io/styleguide/javascriptguide.xml?showone=Multiline_string_literals#Multiline_string_literals)建议使用字符串连接而不是转义换行符：
> 
> **不要这样做：**
> 
> ```
> var myString = 'A rather long string of English text, an error message \
>                 actually that just keeps going and going -- an error \
>                 message to make the Energizer bunny blush (right through \
>                 those Schwarzenegger shades)! Where was I? Oh yes, \
>                 you\'ve got an error and all the extraneous whitespace is \
>                 just gravy.  Have a nice day.'; 
> ```
> 
> 每行开头的空格不能在编译时安全地去除；斜杠后的空格会导致棘手的错误；虽然大多数脚本引擎都支持这一点，但它不是 ECMAScript 的一部分。
> 
> **改为使用字符串连接：**
> 
> ```
> var myString = 'A rather long string of English text, an error message ' +
>                'actually that just keeps going and going -- an error ' +
>                'message to make the Energizer bunny blush (right through ' +
>                'those Schwarzenegger shades)! Where was I? Oh yes, ' +
>                'you\'ve got an error and all the extraneous whitespace is ' +
>                'just gravy.  Have a nice day.'; 
> ```

* * *

## 回答 #3

> 赞同：718
> 
> 时间：2009-04-30T07:22:29.950

该模式`text = <<"HERE" This Is A Multiline String HERE`在 js 中不可用（我记得在我美好的 Perl 时代经常使用它）。

为了监督复杂或长的多行字符串，我有时会使用数组模式：

```
var myString = 
   ['<div id="someId">',
    'some content<br />',
    '<a href="#someRef">someRefTxt</a>',
    '</div>'
   ].join('\n'); 
```

或者匿名模式已经显示（转义换行符），这可能是您代码中的一个丑陋块：

```
 var myString = 
       '<div id="someId"> \
some content<br /> \
<a href="#someRef">someRefTxt</a> \
</div>'; 
```

这是另一个奇怪但有效的“技巧” ^(**1**)：

```
var myString = (function () {/*
   <div id="someId">
     some content<br />
     <a href="#someRef">someRefTxt</a>
    </div>        
*/}).toString().match(/[^]*\/\*([^]*)\*\/\}$/)[1]; 
```

*外部编辑：[jsfiddle](http://jsfiddle.net/orwellophile/hna15vLw/2/)*

**ES20xx支持使用**[模板字符串](http://www.2ality.com/2011/09/quasi-literals.html)跨越多行字符串：

```
let str = `This is a text
    with multiple lines.
    Escapes are interpreted,
    \n is a newline.`;
let str = String.raw`This is a text
    with multiple lines.
    Escapes are not interpreted,
    \n is not a newline.`; 
```

^(**1**)注意：缩小/混淆您的代码后，这将丢失

* * *

## 回答 #4

> 赞同：368
> 
> 时间：2011-04-06T18:16:35.810

您*可以*在纯 JavaScript 中使用多行字符串。

该方法基于函数的序列化，[定义为依赖于实现](http://es5.github.io/#x15.3.4.2)。它在大多数浏览器中都可以工作（见下文），但不能保证它在将来仍然可以工作，所以不要依赖它。

使用以下功能：

```
function hereDoc(f) {
  return f.toString().
      replace(/^[^\/]+\/\*!?/, '').
      replace(/\*\/[^\/]+$/, '');
} 
```

你可以有这样的文件：

```
var tennysonQuote = hereDoc(function() {/*!
  Theirs not to make reply,
  Theirs not to reason why,
  Theirs but to do and die
*/}); 
```

该方法已在以下浏览器中成功测试（未提及=未测试）：

*   即 4 - 10
*   Opera 9.50 - 12（不在 9- 中）
*   Safari 4 - 6（不在 3- 中）
*   铬 1 - 45
*   Firefox 17 - 21（[不在 16- 中](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/toString#Notes)）
*   Rekonq 0.7.0 - 0.8.0
*   *Konqueror 4.7.4 不支持*

不过要小心你的缩小器。它倾向于删除评论。对于[YUI 压缩器](http://www.julienlecomte.net/yuicompressor/README)，以（如我使用的那个）开头的注释`/*!`将被保留。

我认为*真正的*解决方案是使用[CoffeeScript](http://coffeescript.org/#strings)。

ES6 更新：您可以使用反引号而不是创建带有注释的函数并在注释上运行 toString。正则表达式需要更新为仅去除空格。您还可以使用字符串原型方法来执行此操作：

```
let foo = `
  bar loves cake
  baz loves beer
  beer loves people
`.removeIndentation() 
```

有人应该写这个 .removeIndentation 字符串方法... ;)

* * *

## 回答 #5

> 赞同：216
> 
> 时间：2009-04-30T02:13:49.317

你可以这样做...

```
var string = 'This is\n' +
'a multiline\n' + 
'string'; 
```

* * *

## 回答 #6

> 赞同：180
> 
> 时间：2013-03-21T21:05:15.407

我想出了这种非常简单的多线绳索装配方法。由于将函数转换为字符串还会返回函数内的任何注释，因此您可以使用多行注释 /**/ 将注释用作字符串。你只需要剪掉末端，你就有了你的绳子。

```
var myString = function(){/*
    This is some
    awesome multi-lined
    string using a comment 
    inside a function 
    returned as a string.
    Enjoy the jimmy rigged code.
*/}.toString().slice(14,-3)

alert(myString) 
```

* * *

## 回答 #7

> 赞同：93
> 
> 时间：2012-01-03T19:51:51.277

我很惊讶我没有看到这个，因为它在我测试过的任何地方都可以工作，并且对于例如模板非常有用：

```
<script type="bogus" id="multi">
    My
    multiline
    string
</script>
<script>
    alert($('#multi').html());
</script> 
```

有人知道有 HTML 但它不起作用的环境吗？

* * *

## 回答 #8

> 赞同：58
> 
> 时间：2012-08-17T14:25:53.730

我通过输出一个 div，将其隐藏，并在需要时通过 jQuery 调用 div id 来解决这个问题。

例如

```
<div id="UniqueID" style="display:none;">
     Strings
     On
     Multiple
     Lines
     Here
</div> 
```

然后当我需要获取字符串时，我只需使用以下 jQuery：

```
$('#UniqueID').html(); 
```

它在多行上返回我的文本。如果我打电话

```
alert($('#UniqueID').html()); 
```

我得到：

![在此处输入图像描述](https://i.stack.imgur.com/vIVFc.png)

* * *

## 回答 #9

> 赞同：33
> 
> 时间：2014-05-26T09:34:41.043

有多种方法可以实现这一目标

**1.斜线连接**

```
 var MultiLine=  '1\
    2\
    3\
    4\
    5\
    6\
    7\
    8\
    9'; 
```

**2\. 正则连接**

```
var MultiLine = '1'
+'2'
+'3'
+'4'
+'5'; 
```

**3\. Array Join 串联**

```
var MultiLine = [
'1',
'2',
'3',
'4',
'5'
].join(''); 
```

性能方面，**斜线连接**（第一个）是最快的。

**有关性能的更多详细信息，**请参阅**[此测试用例](http://jsperf.com/zp-string-concatenation/6)**

 ****更新：**

使用**ES2015**，我们可以利用其模板字符串功能。有了它，我们只需要使用反引号来创建多行字符串

例子：

```
 `<h1>{{title}}</h1>
  <h2>{{hero.name}} details!</h2>
  <div><label>id: </label>{{hero.id}}</div>
  <div><label>name: </label>{{hero.name}}</div>
  ` 
```

* * *

## 回答 #10

> 赞同：31
> 
> 时间：2012-08-23T18:30:45.393

使用脚本标签：

*   将`<script>...</script>`包含多行文本的块添加到`head`标签中；
*   按原样获取多行文本...（注意文本编码：UTF-8、ASCII）

    ```
    <script>

        // pure javascript
        var text = document.getElementById("mySoapMessage").innerHTML ;

        // using JQuery's document ready for safety
        $(document).ready(function() {

            var text = $("#mySoapMessage").html(); 

        });

    </script>

    <script id="mySoapMessage" type="text/plain">

        <soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="...">
           <soapenv:Header/>
           <soapenv:Body>
              <typ:getConvocadosElement>
                 ...
              </typ:getConvocadosElement>
           </soapenv:Body>
        </soapenv:Envelope>

        <!-- this comment will be present on your string -->
        //uh-oh, javascript comments...  SOAP request will fail 

    </script> 
    ```

* * *

## 回答 #11

> 赞同：25
> 
> 时间：2011-12-13T20:09:10.637

我喜欢这种语法和缩进：

```
string = 'my long string...\n'
       + 'continue here\n'
       + 'and here.'; 
```

（但实际上不能被视为多行字符串）

* * *

## 回答 #12

> 赞同：19
> 
> 时间：2013-02-17T09:56:46.330

**Downvoters**：此代码仅供参考。

这已经在 Mac 上的 Fx 19 和 Chrome 24 中进行了测试

[演示](http://jsfiddle.net/mplungjan/pMSc8/)

```
var new_comment; /*<<<EOF 
    <li class="photobooth-comment">
       <span class="username">
          <a href="#">You</a>:
       </span>
       <span class="comment-text">
          $text
       </span> 
       @<span class="comment-time">
          2d
       </span> ago
    </li>
EOF*/
// note the script tag here is hardcoded as the FIRST tag 
new_comment=document.currentScript.innerHTML.split("EOF")[1]; 
document.querySelector("ul").innerHTML=new_comment.replace('$text','This is a dynamically created text');
```

```
<ul></ul>
```

* * *

## 回答 #13

> 赞同：18
> 
> 时间：2014-04-25T11:34:57.497

有这个库使它很漂亮：

[https://github.com/sindresorhus/multiline](https://github.com/sindresorhus/multiline)

### 前

```
var str = '' +
'<!doctype html>' +
'<html>' +
'   <body>' +
'       <h1>❤ unicorns</h1>' +
'   </body>' +
'</html>' +
''; 
```

### 后

```
var str = multiline(function(){/*
<!doctype html>
<html>
    <body>
        <h1>❤ unicorns</h1>
    </body>
</html>
*/}); 
```

* * *

## 回答 #14

> 赞同：12
> 
> 时间：2015-11-04T13:59:33.790

javascript中的等价物是：

```
var text = `
This
Is
A
Multiline
String
`; 
```

这是[规范](http://www.ecma-international.org/ecma-262/6.0/#sec-template-literal-lexical-components)。[请参阅本页](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/template_strings)底部的浏览器支持。这里也有一些[例子](https://developers.google.com/web/updates/2015/01/ES6-Template-Strings?hl=en#multiline-strings)。

* * *

## 回答 #15

> 赞同：12
> 
> 时间：2021-11-05T17:46:33.937

在这里找到了很多过度设计的答案。我认为最好的两个答案是：

1：

```
 let str = `Multiline string.
            foo.
            bar.` 
```

最终记录：

```
Multiline string.
           foo.
           bar. 
```

2：

```
let str = `Multiline string.
foo.
bar.` 
```

这会正确记录它，但如果 str 嵌套在函数/对象等内部，它在脚本文件中会很丑陋......：

```
Multiline string.
foo.
bar. 
```

我对正确记录 str 的正则表达式的非常简单的回答：

```
let str = `Multiline string.
           foo.
           bar.`.replace(/\n +/g, '\n'); 
```

请注意，这不是完美的解决方案，但如果您确定在新行 (\n) 之后至少会出现一个空格（+ 表示至少出现一次），它就会起作用。它也适用于 *（零个或多个）。

您可以更明确地使用 {n,} ，这意味着至少出现 n 次。

* * *

## 回答 #16

> 赞同：11
> 
> 时间：2010-11-23T16:46:29.397

这适用于 IE、Safari、Chrome 和 Firefox：

```
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js"></script>
<div class="crazy_idea" thorn_in_my_side='<table  border="0">
                        <tr>
                            <td ><span class="mlayouttablecellsdynamic">PACKAGE price $65.00</span></td>
                        </tr>
                    </table>'></div>
<script type="text/javascript">
    alert($(".crazy_idea").attr("thorn_in_my_side"));
</script> 
```

* * *

## 回答 #17

> 赞同：11
> 
> 时间：2011-05-20T13:10:33.553

总而言之，我尝试了用户 javascript 编程（Opera 11.01）中列出的 2 种方法：

*   这个没用：[在 JavaScript 中创建多行字符串](https://stackoverflow.com/questions/805107/multiline-strings-in-javascript/805111#805111)
*   这工作得很好，我还想出了如何使它在 Notepad++ 源视图中看起来不错：[在 JavaScript 中创建多行字符串](https://stackoverflow.com/questions/805107/multiline-strings-in-javascript/5571069#5571069)

所以我推荐Opera用户JS用户的工作方法。与作者所说的不同：

> 它不适用于 Firefox 或 Opera；仅在 IE、chrome 和 safari 上。

它确实在 Opera 11 中工作。至少在用户 JS 脚本中。太糟糕了，我不能评论个别答案或支持答案，我会立即这样做。如果可能，请有更高权限的人为我做。

* * *

## 回答 #18

> 赞同：10
> 
> 时间：2013-12-11T17:30:58.503

[我对https://stackoverflow.com/a/15558082/80404](https://stackoverflow.com/a/15558082/80404)的扩展。它期望以`/*! any multiline comment */`符号 ! 用于防止通过缩小删除（至少对于 YUI 压缩器）

```
Function.prototype.extractComment = function() {
    var startComment = "/*!";
    var endComment = "*/";
    var str = this.toString();

    var start = str.indexOf(startComment);
    var end = str.lastIndexOf(endComment);

    return str.slice(start + startComment.length, -(str.length - end));
}; 
```

例子：

```
var tmpl = function() { /*!
 <div class="navbar-collapse collapse">
    <ul class="nav navbar-nav">
    </ul>
 </div>
*/}.extractComment(); 
```

* * *

## 回答 #19

> 赞同：9
> 
> 时间：2014-02-10T11:13:38.740

**2015**年更新：现在已经六年了：大多数人使用模块加载器，主要模块系统都有加载模板的方法。它不是内联的，但最常见的多行字符串类型是模板，而且**模板通常应该远离 JS**。

## require.js: '需要文本'。

使用[require.js 'text' 插件](https://github.com/requirejs/text)，在 template.html 中有一个多行**模板**

```
var template = require('text!template.html') 
```

## NPM/browserify：“brfs”模块

Browserify[使用 'brfs' 模块](https://www.npmjs.com/package/brfs)来加载文本文件。这实际上会将您的模板构建到捆绑的 HTML 中。

```
var fs = require("fs");
var template = fs.readFileSync(template.html', 'utf8'); 
```

简单的。

* * *

## 回答 #20

> 赞同：9
> 
> 时间：2015-04-28T18:31:00.240

如果您愿意使用转义的换行符，它们可以*很好地*使用。 **它看起来像一个带有页面边框的文档**。

![在此处输入图像描述](https://i.stack.imgur.com/e51kg.png)

* * *

## 回答 #21

> 赞同：9
> 
> 时间：2020-06-10T20:45:55.820

# 精确的

Ruby[生成](https://onlinegdb.com/SkmXI6R38)：`"This\nIs\nA\nMultiline\nString\n"`- 下面的 JS 生成完全相同的字符串

```
text = `This
Is
A
Multiline
String
`

// TEST
console.log(JSON.stringify(text));
console.log(text);
```

这是对[Lonnie 最佳答案](https://stackoverflow.com/a/33523770/860099)的改进，因为他的答案中的换行符与 ruby​​ 输出中的位置不完全相同

* * *

## 回答 #22

> 赞同：8
> 
> 时间：2018-07-13T17:25:51.037

ES6 的做法是使用模板文字：

```
const str = `This 

is 

a

multiline text`; 

console.log(str); 
```

更多参考[这里](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Template_literals)

* * *

## 回答 #23

> 赞同：7
> 
> 时间：2015-09-21T15:23:33.330

您可以使用[TypeScript](http://www.typescriptlang.org/Playground)（JavaScript SuperSet），它支持多行字符串，并且可以在没有开销的情况下转译回纯 JavaScript：

```
var templates = {
    myString: `this is
a multiline
string` 
}

alert(templates.myString); 
```

如果您想使用纯 JavaScript 完成相同的操作：

```
var templates = 
{
 myString: function(){/*
    This is some
    awesome multi-lined
    string using a comment 
    inside a function 
    returned as a string.
    Enjoy the jimmy rigged code.
*/}.toString().slice(14,-3)

}
alert(templates.myString) 
```

注意 iPad/Safari 不支持`'functionName.toString()'`

如果您有很多遗留代码，您还可以在 TypeScript 中使用纯 JavaScript 变体（用于清理目的）：

```
interface externTemplates
{
    myString:string;
}

declare var templates:externTemplates;

alert(templates.myString) 
```

并且您可以使用纯 JavaScript 变体中的多行字符串对象，将模板放入另一个文件中（您可以将其合并到包中）。

[您可以在http://www.typescriptlang.org/Playground](http://www.typescriptlang.org/Playground)尝试 TypeScript

* * *

## 回答 #24

> 赞同：7
> 
> 时间：2018-09-09T11:00:17.760

在 Javascrips 中创建多行字符串的最简单方法是使用反引号 ( `` )。这允许您创建多行字符串，您可以在其中插入带有`${variableName}`.

## 例子：

```
let name = 'Willem'; 
let age = 26;

let multilineString = `
my name is: ${name}

my age is: ${age}
`;

console.log(multilineString);
```

## 兼容性：

*   它是在`ES6`//中介绍的`es2015`
*   它现在得到所有主要浏览器供应商的原生支持（除了 Internet Explorer）

[在此处检查 Mozilla 文档中的确切兼容性](https://developer.mozilla.org/nl/docs/Web/JavaScript/Reference/Template_literals)

* * *

## 回答 #25

> 赞同：6
> 
> 时间：2016-03-28T18:43:26.367

ES6 允许您使用反引号在多行上指定一个字符串。它被称为模板文字。像这样：

```
var multilineString = `One line of text
    second line of text
    third line of text
    fourth line of text`; 
```

在 NodeJS 中可以使用反引号，Chrome、Firefox、Edge、Safari 和 Opera 都支持它。

[https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Template_literals](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Template_literals)

* * *

## 回答 #26

> 赞同：4
> 
> 时间：2016-07-13T19:25:31.550

另请注意，当在每行末尾使用正反斜杠将字符串扩展到多行时，正反斜杠之后的任何额外字符（主要是空格、制表符和错误添加的注释）都会导致意外的字符错误，我花了一个小时才找到出去

```
var string = "line1\  // comment, space or tabs here raise error
line2"; 
```

* * *

## 回答 #27

> 赞同：4
> 
> 时间：2017-10-11T23:28:47.363

出于对互联网的热爱，请使用字符串连接并选择不使用 ES6 解决方案。ES6 并非全面支持，就像 CSS3 和某些浏览器在适应 CSS3 运动方面很慢。使用普通的 JavaScript，您的最终用户会感谢您。

例子：

`var str = "This world is neither flat nor round. "+ "Once was lost will be found";`

* * *

## 回答 #28

> 赞同：3
> 
> 时间：2013-10-14T00:58:19.003

我的字符串连接的基于数组的连接版本：

```
var c = []; //c stands for content
c.push("<div id='thisDiv' style='left:10px'></div>");
c.push("<div onclick='showDo(\'something\');'></div>");
$(body).append(c.join('\n')); 
```

这对我来说效果很好，尤其是当我经常将值插入以这种方式构造的 html 时。但它有很多限制。缩进会很好。不必处理嵌套引号会非常好，只是它的笨重困扰着我。

添加到数组中的 .push() 是否会占用大量时间？请参阅此相关答案：

（[JavaScript 开发人员不使用 Array.push() 是否有原因？](https://stackoverflow.com/questions/15649899/is-there-a-reason-javascript-developers-dont-use-array-push)）

在查看了这些（相反的）测试运行之后，看起来 .push() 对于不太可能增长超过 100 个项目的字符串数组来说很好 - 我会避免它，而支持更大数组的索引添加。

* * *

## 回答 #29

> 赞同：3
> 
> 时间：2014-01-18T13:18:54.217

你可以`+=`用来连接你的字符串，似乎没有人回答这个问题，这将是可读的，也很整洁......像这样的东西

```
var hello = 'hello' +
            'world' +
            'blah'; 
```

也可以写成

```
var hello = 'hello';
    hello += ' world';
    hello += ' blah';

console.log(hello); 
```

* * *

## 回答 #30

> 赞同：3
> 
> 时间：2022-01-20T12:19:16.720

**带变量的多行字符串**

```
var x = 1
string = string + `<label class="container">
                       <p>${x}</p>
                   </label>`; 
```

* * *

## 回答 #31

> 赞同：2
> 
> 时间：2017-08-13T22:57:20.987

您必须使用连接运算符“+”。

```
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Document</title>
</head>
<body>
    <p id="demo"></p>
    <script>
        var str = "This "
                + "\n<br>is "
                + "\n<br>multiline "
                + "\n<br>string.";
        document.getElementById("demo").innerHTML = str;
     </script>
</body>
</html> 
```

通过使用`\n`您的源代码将如下所示 -

```
这
 <br>是
 <br>多行
 <br>字符串。

```

通过使用`<br>`您的浏览器输出将如下所示 -

```
这
是
多行
细绳。

```

* * *

## 回答 #32

> 赞同：2
> 
> 时间：2020-07-08T21:17:01.527

您可以使用标记模板来确保获得所需的输出。

例如：

```
// Merging multiple whitespaces and trimming the output

const t = (strings) => { return strings.map((s) => s.replace(/\s+/g, ' ')).join("").trim() }
console.log(t`
  This
  Is
  A
  Multiline
  String
`);
// Output: 'This Is A Multiline String'

// Similar but keeping whitespaces:

const tW = (strings) => { return strings.map((s) => s.replace(/\s+/g, '\n')).join("").trim() }
console.log(tW`
  This
  Is
  A
  Multiline
  String
`);
// Output: 'This\nIs\nA\nMultiline\nString' 
```

* * *

## 回答 #33

> 赞同：1
> 
> 时间：2013-01-28T12:20:46.427

我认为这种解决方法应该适用于 IE、Chrome、Firefox、Safari、Opera -

**使用 jQuery**：

```
<xmp id="unique_id" style="display:none;">
  Some plain text
  Both type of quotes :  " ' " And  ' " '
  JS Code : alert("Hello World");
  HTML Code : <div class="some_class"></div>
</xmp>
<script>
   alert($('#unique_id').html());
</script> 
```

**使用纯 Javascript：**

```
<xmp id="unique_id" style="display:none;">
  Some plain text
  Both type of quotes :  " ' " And  ' " '
  JS Code : alert("Hello World");
  HTML Code : <div class="some_class"></div>
</xmp>
<script>
   alert(document.getElementById('unique_id').innerHTML);
</script> 
```

干杯！！

* * *

## 回答 #34

> 赞同：1
> 
> 时间：2022-03-02T17:26:01.720

在 JavaScript 中打印多行字符串的一种简单方法是使用由反引号 (` `) 表示的模板文字（模板字符串）。您还可以在模板字符串中使用变量（` `name is ${value}``）

你也可以

```
const value = `multiline`
const text = `This is a
${value}
string in js`;
console.log(text);
```

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2012-11-23T13:10:00.497

刚刚尝试了匿名回答，发现这里有一个小技巧，如果反斜杠后面有空格，它就不起作用`\`
所以下面的解决方案不起作用 -

```
var x = { test:'<?xml version="1.0"?>\ <-- One space here
            <?mso-application progid="Excel.Sheet"?>' 
}; 
```

但是当空间被删除时，它会起作用 -

```
var x = { test:'<?xml version="1.0"?>\<-- No space here now
          <?mso-application progid="Excel.Sheet"?>' 
};

alert(x.test);​ 
```

希望能帮助到你 ！！

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2013-03-07T09:37:06.913

这是一种相当经济的方法，至少就源代码而言：

```
function s() {
    var args = [],index;
    for (index = 0; index< arguments.length; index++) {
        args.push (arguments [index]);
    }
    return args.join ("\n");
}
console.log (s (
    "This is the first line",
    "and this is the second",
    "finally a third"
));

function s() {return arguments.join ("\n")} 
```

如果“arguments”属性是一个合适的数组，当然会更好。

当您想要控制很长字符串中的换行符时，第二个版本可能会使用 "" 来进行连接。

* * *

## 回答 #37

> 赞同：0
> 
> 时间：2013-08-02T16:04:50.710

我这样编程：

```
sys = {
    layout: null,
    makeLayout: function (obCLS) {
        this.layout = $('<div />').addClass('editor').appendTo($(obCLS)).append(

            /* Cargador */
            /* @this.layout.find('> div:nth-of-child(1)'); */
            '<div>' +
            '   <p>Seleccione la imagen que desea procesar.</p>' +
            '   <input type="button" value="Seleccionar" class="btn btn-xlarge btn-success" />' +
            '   <span></span>' +
            '</div>' +

            /* Cargador - Progreso */
            /* @this.layout.find('> div:nth-of-child(2)'); */
            '<div>' +
            '   <div>' +
            '       <div></div>' +
            '       <div>' +
            '           <div></div>' +
            '       </div>' +
            '   </div>' +
            '</div>' +

            /* Editor */
            /* @this.layout.find('> div:nth-of-child(3)');
             * @sidebar = this.layout.find('> div:nth-of-child(3) > div > div > div:nth-of-type(1)');
             * @body    = this.layout.find('> div:nth-of-child(3) > div > div > div:nth-of-type(2) > div'); */
            '<div>' +
            '   <div>' +
            '       <div>' +
            '           <div></div>' +
            '           <div>' +
            '               <div></div>' +
            '           </div>' +
            '       </div>' +
            '   </div>' +
            '</div>'
        );
    }
}

sys.makeLayout('#div'); 
```

* * *

## 回答 #38

> 赞同：0
> 
> 时间：2013-08-27T17:05:18.160

我想我发现了另一种在每一行都没有任何侵入性语法的内联方式。使用 Javascript 将函数转换为字符串并使用语法创建多行注释的能力，`/**/`然后删除“function() {/*\n”和“\n*/}”。

```
var multiline = function(string) { return string.toString().replace(/(^[^\n]*\n)|(\n\*\/\})/g, ""); };

console.log(multiline(function() {/*
Hello world!
I'm a multiline string!

Tada!
*/})); 
```

我能看到的唯一缺陷是语法高亮。

编辑：如果我向下滚动一点，我会看到这个答案做同样的事情：[https ://stackoverflow.com/a/5571069/916553](https://stackoverflow.com/a/5571069/916553)

* * *

## 回答 #39

> 赞同：0
> 
> 时间：2014-09-09T00:02:29.070

如果您碰巧只在 Node 中运行，则可以使用 fs 模块从文件中读取多行字符串：

```
var diagram;
var fs = require('fs');
fs.readFile( __dirname + '/diagram.txt', function (err, data) {
  if (err) {
    throw err; 
  }
  diagram = data.toString();
}); 
```

* * *

## 回答 #40

> 赞同：0
> 
> 时间：2019-07-24T22:01:45.103

规则是：当在字符串中时，在需要换行的地方使用 \n；您不必在 \n 之前或之后放置空格，JavaScript 的解释器足够聪明，可以知道不可打印字符表示的长度。

* * *

## 回答 #41

> 赞同：0
> 
> 时间：2021-10-23T11:28:45.757

JavaScript 从来没有真正好的方法来处理多行字符串，直到 2015 年引入 ES6 以及模板文字。

模板文字是由反引号 (``) 分隔的字符串，而不是普通的单 ('')/双引号 ("")e 引号分隔符。

* * *

## 回答 #42

> 赞同：-3
> 
> 时间：2013-11-14T05:46:32.417

我找到了一个更优雅的解决方案，可能有点与主题无关，因为它使用 PHP，但我相信它对你的一些人来说会很有用和可爱*...

此**javascript 代码**应保留在脚本标签内

```
var html=<?php echo json_encode("

        <div class=container>
            <div class=area1>
                xxx
            </div>
            <div class=area2>
                ".$someVar."
            </div>
        </div>

"); ?> 
```

在您的**输出 html**中，您会看到类似

```
var html="\r\n\r\n\t\t\t<div class=container>\r\n\t\t\t\t<div class=area1>\r\n\t\t\t\t\txxx\r\n\t\t\t\t<\/div>\r\n\t\t\t\t<div class=area2>\r\n\t\t\t\t\t44\r\n\t\t\t\t<\/div>\r\n\t\t\t<\/div>\r\n\r\n\t\t"; 
```

* * *

等等*！*，它为您提供文件中的代码可读性。

pD：此示例使用 json_encode() PHP 函数，但肯定有 ASP、Ruby 和 JSP 语言的等效函数。

pD：然而，这个解决方案也有他的局限性，其中之一是你不能在封装的代码中使用 javascript 变量。

* * *

## 回答 #43

> 赞同：-13
> 
> 时间：2013-02-19T01:46:50.773

它不是非常优雅，但对我来说足够干净：

```
var myString = "First line" + "\n";
var myString = myString + "Second line" + "\n";
var myString = myString + "Third line" + "\n"; 
```

# delphi - 在 delphi 7 中，是 `try ... except raise; 结束;`有意义吗？

> ID：805109
> 
> 赞同：8
> 
> 时间：2009-04-30T02:12:51.690
> 
> 标签：delphi, exception, try-catch, delphi-7

在我维护的一些 Delphi 7 代码中，我注意到以下很多实例：

```
with ADOQuery1 do begin
  // .. fill out sql.text, etc
  try
    execSQL;
  except
    raise;
  end;
end; 
```

在我看来，这些 try 块可以被删除，因为它们什么都不做。但是，我对可能的微妙副作用持谨慎态度。

谁能想到这些块实际上可以做任何没有它们就不会发生的事情？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-30T02:27:12.733

在这种情况下， raise 操作没有任何效果，应该被删除，因为它只是重新引发异常块刚刚捕获的异常。raise 通常用于在没有适当的错误处理可用时将控制转移到块的末尾。下面我们处理自定义异常，但任何其他异常都应在其他地方处理。

```
try
  someOperation;
except
  on e: ECustomException do
    SomeCustomHandelr;
  else
     begin
       // the raise is only useful to rethrow the exception to an encompasing 
       // handler.  In this case after I have called my logger code. as Rob
       // mentioned this can be omitted if you arent handling anything because
       // the compiler will simply jump you to the next block if there is no
       // else.
       LogUnexpectedException('some operation failed',e);
       raise;
     end;
end; 
```

请注意，没有“加注”的类似外观形式确实具有吃/隐藏任何异常的副作用。非常肆无忌惮的开发商的做法，他们希望能在竞争中占据一席之地。

```
with ADOQuery1 do begin  
  // .. fill out sql.text, etc  
  try    
    execSQL; 
  except
    // no handler so this just eats any "errors"    
  end; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-30T02:17:12.350

删除上面代码片段中的 except 代码没有任何区别。您可以（而且我相信您*应该*这样做，因为它会降低可读性）删除它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-30T02:30:41.257

好的，这里真的有两个问题。

首先，它*是*有意义的：如果 execSQL 抛出异常，它会被 try 块捕获并转发给 except。然后它被加注转发到下一个更高的块。

第二，*有用*吗？可能不是。这几乎可以肯定是以下三件事之一的结果：

1.  一个头发尖的人写了一个编码标准，上面写着“所有可以抛出异常的操作都必须在 try 块中”。
2.  有人打算回来并将`execSQL`声明中的异常转换为其他更有意义的异常。
3.  新人不知道他们写的内容与让外部环境担心异常是同构的，因此认为他们**必须**转发它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-30T03:37:57.180

可能我回答的有点快，看最后……
**就是这样，对应用没用**。
时期！

现在在“为什么”方面。如果 /was/will be/is 在其他地方/在 raise 之前插入了某种日志记录代码，则可能是标准化异常处理：

```
 try
    execSQL;
  except
    // Log Exception..
    on E: Exception do
    begin
      LogTrace(Format('%s: Exception Message[%s]',[methodname, E.Message]));
      raise;
    end;
  end; 
```

或清理代码：

```
 try
    execSQL;
  except
    //some FreeAndNil..
    raise;
  end; 
```

**更新**：在 1 种情况下，我会看到一些用途，就像它一样............
能够`raise`在线上放置一个断点，以便有机会查看该块的上下文中发生了什么代码。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-30T06:40:10.377

除了允许原始程序员在“引发”上放置断点并在源中更接近其可能原因之外，此代码什么也不做。从这个意义上说，它是一种完全合理的调试技术。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-30T04:38:05.600

实际上，我应该将此作为对弗朗索瓦答案的评论发布，但我不知道是否可以在其中插入格式化代码:(所以我将其发布为答案。

2mghie：

> > > 第二个是完全不习惯的，一个会使用 finally 代替。

不，“finally”总是会清理对象。“例外” - 仅在例外情况下。考虑函数的情况，它创建、填充和返回一个对象：

```
function CreateObj: TSomeObj;
begin
  Result := TSomeObj.Create;
  try
    ... // do something with Result: load data, fill props, etc.
  except
    FreeAndNil(Result); // oops: bad things happened. Free object to avoid leak.
    raise;
  end;
end; 
```

如果你把“finally”放在那里 - 函数将始终返回 nil。如果您完全省略“try”块 - 如果“...”中出现异常，则会出现资源泄漏。

PS 当然，你可以使用“finally”并检查ExceptObj，但是......不是很丑吗？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-30T14:57:14.927

标题包含一个相当广泛的问题，而它的解释给出了一个更具体的例子。因此，我对这个问题的回答是如何从示例中进行的，无疑可以为这里已经说过的内容添加任何有用的东西。

但是，也许*Blorgbeard*确实想知道它是否有意义**。**`try ... except raise; end`在 Delphi 7 中，如果我没记错的话，`Exit`会触发块的`finally`一部分`try-finally`（就好像它是某种异常一样）。有人可能会认为这种行为不适合他们的任务，使用有问题的结构是一种很好的解决方法。

只是在那里使用单曲仍然会很奇怪`raise;`，但是我们应该谈论*有用性*而不是*意义*，正如查理巧妙地观察到的那样。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-30T18:25:08.157

这段代码除了重新引发一个在没有这个 try except 块的情况下已经被引发的异常之外什么都不做。您可以安全地删除它。

# c# - 线程间通信（和库？）

> ID：805110
> 
> 赞同：0
> 
> 时间：2009-04-30T02:13:13.297
> 
> 标签：c#, c++

如果我有一个具有多个线程的游戏引擎，所有线程都与一个场景图一起工作，那么当场景图发生变化时，有什么技术可以确保一切都同步？

什么样的图书馆可以帮助解决这个问题？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-30T02:26:20.893

有关可用同步原语的列表，请参阅此[问题](https://stackoverflow.com/questions/800383/what-is-the-difference-between-mutex-and-critical-section)。你需要使用什么取决于你的线程做什么。有多少线程读取图表？有多少修改图形？它们是在图形的同一部分还是在不同的部分上运行？如果您提供更多详细信息，我可以提供进一步的建议。

# python - Python“任务服务器”

> ID：805120
> 
> 赞同：4
> 
> 时间：2009-04-30T02:19:43.263
> 
> 标签：python

我的问题是：我应该使用哪个 python 框架来构建我的服务器？

笔记：

*   此服务器与其客户端进行 HTTP 通信：GET 和 POST（通过 pyAMF）
*   客户端“提交”“任务”进行处理，然后，稍后检索相关的“task_result”
*   提交和检索可能以天分隔 - 不同的 HTTP 连接
*   “任务”是描述要解决的问题的XML块，“task_result”是描述答案的XML块。
*   当服务器获得“任务”时，它会将其排队等待处理
*   服务器管理这个队列，当任务到达顶部时，组织它们被处理。
*   该处理由一个长时间运行（15 分钟？）的外部程序（通过子进程）执行，该程序提供任务 XML，并产生一个“task_result”的 XML 块，服务器拾取并存储（用于以后的客户端检索）。
*   它提供几个基本的 HTML 页面，显示队列和处理状态（仅用于管理目的）

我已经尝试过 twisted.web，使用 SQLite 作为数据库和线程来处理长时间运行的进程。

但我不禁觉得我错过了一个更简单的解决方案。我是吗？如果您面临这种情况，您会使用哪种技术组合？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-30T02:46:10.237

我建议使用现有的消息队列。有很多可供选择（见下文），它们的复杂性和稳健性各不相同。

另外，避免线程：让您的处理任务在不同的进程中运行（为什么它们必须在网络服务器中运行？）

通过使用现有的消息队列，您只需要担心产生消息（在您的网络服务器中）和使用它们（在您的长时间运行的任务中）。随着系统的增长，您只需添加网络服务器和消费者就可以扩大规模，而不必担心您的排队基础设施。

消息队列的一些流行的python实现：

*   [http://code.google.com/p/stomper/](http://code.google.com/p/stomper/)
*   [http://code.google.com/p/pyactivemq/](http://code.google.com/p/pyactivemq/)
*   [http://xph.us/software/beanstalkd/](http://xph.us/software/beanstalkd/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-12T20:03:54.107

你可以看看芹菜

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-30T02:35:54.910

我建议以下。（因为这是我们正在做的事情。）

一个简单的 WSGI 服务器（[wsgiref](http://docs.python.org/library/wsgiref.html)或[werkzeug](http://werkzeug.pocoo.org/)）。进来的 HTTP 请求自然会形成一个队列。无需进一步排队。您收到一个请求，将子进程作为子进程生成并等待它完成。一个简单的孩子名单就是你所需要的。

我使用了主“永远服务”循环的修改`wsgiref`来定期轮询所有孩子，看看他们的表现如何。

一个简单的 SQLite 数据库可以跟踪请求状态。即使这样也可能是矫枉过正，因为您的 XML 输入和结果可能只是放在文件系统中。

而已。队列和线程并没有真正进入它。单个长期运行的外部进程过于复杂而无法协调。如果每个请求都是一个单独的、独立的子进程，这是最简单的。

如果您收到大量请求，您可能需要一个简单的调控器来防止创建数千个孩子。调控器可以是一个简单的队列，使用带有 append() 和 pop() 的列表构建。每个请求都会进入，但只有符合“最大子节点数”限制的请求才会被取出。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-30T03:20:11.577

我的反应是建议 Twisted，但你已经看过这个了。不过，我坚持我的答案。在不了解您的个人痛点的情况下，我至少可以分享一些帮助我减少几乎所有当您需要为客户执行多个依赖、阻止操作时出现的延迟疯狂的事情。

内联回调（此处略作记录：http: [//twistedmatrix.com/documents/8.2.0/api/twisted.internet.defer.html](http://twistedmatrix.com/documents/8.2.0/api/twisted.internet.defer.html)）提供了一种使长链延迟更具可读性的方法（看起来像直线代码）。这里有一个很好的例子来降低复杂性：http: [//blog.mekk.waw.pl/archives/14-Twisted-inlineCallbacks-and-deferredGenerator.html](http://blog.mekk.waw.pl/archives/14-Twisted-inlineCallbacks-and-deferredGenerator.html)

您不必总是让批量处理与 Twisted 很好地集成。有时，将大部分程序拆分成一个独立的、易于测试/调整/实现的命令行工具并让 Twisted 在另一个进程中调用该工具会更容易。Twisted`ProcessProtocol`提供了一种相当灵活的方式来启动和与外部帮助程序交互。此外，如果您突然决定要对您的应用程序进行*云化*，假设您已经设置了密钥，那么使用 a`ProcessProtocol`在远程服务器（可能是随机 EC2 实例）上简单地运行批量处理并不是什么大问题`ssh`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-30T02:24:56.887

似乎任何 python web 框架都可以满足您的需求。我每天都使用类似的系统，我可以告诉你，你的线程和 SQLite 用于队列存储的解决方案与你将得到的一样简单。

假设您的队列中的顺序无关紧要，那么线程应该是可以接受的。确保您不会在队列中创建竞争条件，或者例如同时运行两个相同的作业类型，这一点很重要。如果是这种情况，我建议使用单线程应用程序来逐个处理队列中的项目。

# ruby - 在 Ruby 问题中包含文件

> ID：805127
> 
> 赞同：3
> 
> 时间：2009-04-30T02:26:06.900
> 
> 标签：ruby, include, load, require

*   我对 Ruby 很陌生，所以您能否建议分离文件并包含它们的最佳实践。
*   文件布局的首选设计结构是什么。您什么时候决定将算法分离到一个新文件中？
*   什么时候使用**load**来包含其他文件，什么时候使用**require**？
*   包含文件时是否会影响性能？

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-30T02:35:11.403

*   我为每个类创建一个文件，除了那些是小型帮助类的类，其他文件不需要。我也在子目录中分离了我的不同模块。

*   `load`和`require`is之间的区别`require`只会加载文件一次，即使它被多次调用，while`load`会再次加载它，无论之前是否加载过。您几乎总是想使用`require`，除非`irb`您想手动重新加载文件。

*   我不确定性能是否受到影响。当你`load`还是`require`一个文件时，解释器必须解释这个文件。大多数 Ruby 会在需要后将其编译为虚拟机代码。显然，`require`当文件可能已经被包含一次时，它的性能更高，因为它可能不必再次加载它。

# arrays - 如何创建命名空间数组？

> ID：805128
> 
> 赞同：0
> 
> 时间：2009-04-30T02:26:07.180
> 
> 标签：arrays, namespaces

如何创建命名空间数组？并且因为这似乎是一个长镜头，如果这是不可能的，有没有类似于命名空间的东西可以做成一个数组？

命名空间（如果有帮助）包含以下变量：

```
const int maxx=// depends on the particular namespace
               // I need an array to go through each namespace and
               // pick out the variable
const int maxy=// depends on particular namespace
//prgm is a class I made
prgm sector[maxx][maxy];
// another array of prgms.  int is my shorthand of saying "depends on
// particular namespace", so is char.
prgm programs[int]={prgm1(int,int,char),prgm2(int,int,char)... 
```

因此，欢迎任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-30T02:28:19.470

你可以使用反射，但我认为你应该重新考虑你的设计。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-30T02:36:00.730

我不确定您在说什么语言，但是在许多（大多数？）语言中，对常量的引用在编译时被常量值替换。因此它们在运行时不再存在，甚至反射也无济于事。

您可以在每个命名空间中创建一个类，将常量公开为（静态）属性。然后您可以使用反射在每个命名空间中搜索类并从属性中获取常量值。

但是，正如其他人所提到的，你真的应该重新考虑你的设计。最后，命名空间通常不能通过反射访问，因为它们只是扩展了包含的类（和其他东西）的类名。或者是否有一种（非深奥的）语言通过反射将命名空间公开为实体？

对于 .NET，[System.Type.Namespace 属性](http://msdn.microsoft.com/en-us/library/system.type.namespace.aspx)的参考说明如下。

> *命名空间是一种逻辑设计时命名便利*，主要用于定义应用程序中的范围，并在单个层次结构中组织类和其他类型。*从运行时的角度来看，没有命名空间。*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-30T02:49:44.830

这应该是C++吗？听起来您需要定义一个类，而不是命名空间，然后创建该类的实例（对象）并将**它们**放入一个数组中。

所以这个`sector`变量变得很棘手，因为它的大小是基于将传递给类的构造函数的值`maxx`和参数。`maxy`您可以通过使用[容器类](http://www.parashift.com/c++-faq-lite/containers.html#faq-34.1)或[动态分配的多维数组](http://www.parashift.com/c++-faq-lite/freestore-mgmt.html#faq-16.16)来解决这个问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-30T03:42:49.697

如果你谈论 C++，在那里你不能将命名空间作为实体传递。但是您可以使用类型来执行此操作，作为模板的类型参数。在这种情况下，[MPL 序列可以与](http://www.boost.org/doc/libs/1_38_0/libs/mpl/doc/refmanual/sequences.html)[MPL 算法](http://www.boost.org/doc/libs/1_38_0/libs/mpl/doc/refmanual/algorithms.html)一起提供帮助：

```
struct c1 { typedef int_<2> value_x; }; 
struct c2 { typedef int_<3> value_x; };
struct c3 { typedef int_<1> value_x; };
template<typename C> struct get_x : C::value_x { };

typedef vector<c1, c2, c3> scope_vec;

typedef max_element<
    transform_view< scope_vec , get_x<_1> >
    >::type iter; 
```

然后你可以创建你的数组

```
prgm programs[deref< iter >::type::value]; 
```

请注意，在该类型向量中的搜索发生在编译时。所以数组的值也是在编译时确定的。

# javascript - 如何在 jQuery 中取消绑定“悬停”？

> ID：805133
> 
> 赞同：111
> 
> 时间：2009-04-30T02:28:14.897
> 
> 标签：javascript, jquery

如何在 jQuery 中取消绑定“悬停”？

这不起作用：

```
$(this).unbind('hover'); 
```

* * *

## 回答 #1

> 赞同：217
> 
> 时间：2009-04-30T03:25:26.337

`$(this).unbind('mouseenter').unbind('mouseleave')`

或更简洁（感谢*@Chad Grant*）：

`$(this).unbind('mouseenter mouseleave')`

* * *

## 回答 #2

> 赞同：71
> 
> 时间：2009-08-29T01:44:43.377

实际上，[jQuery 文档](http://docs.jquery.com/Events/hover#overout)有一个比上面显示的链接示例更简单的方法（尽管它们可以正常工作）：

```
$("#myElement").unbind('mouseenter mouseleave'); 
```

从 jQuery 1.7 开始，您还可以使用[`$.on()`](http://api.jquery.com/on/)and[`$.off()`](http://api.jquery.com/off/)进行事件绑定，因此要取消绑定悬停事件，您可以使用更简单和更整洁的方法：

```
$('#myElement').off('hover'); 
```

伪事件名称“hover”[用作](http://api.jquery.com/on/#additional-notes)“mouseenter mouseleave”的简写，但在早期的 jQuery 版本中处理方式不同；要求您明确删除每个文字事件名称。使用`$.off()`now 允许您使用相同的速记删除两个鼠标事件。

**2016年编辑：**

仍然是一个流行的问题，因此值得关注[@Dennis98](https://stackoverflow.com/users/3439786/dennis98)在下面的评论中的观点，即在 jQuery 1.9+ 中，“悬停”事件已被[弃用](https://bugs.jquery.com/ticket/12736)，有利于标准的“mouseenter mouseleave”调用。所以你的事件绑定声明现在应该是这样的：

`$('#myElement').off('mouseenter mouseleave');`

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-04-30T03:33:48.000

单独取消绑定`mouseenter`和`mouseleave`事件或取消绑定元素上的所有事件。

```
$(this).unbind('mouseenter').unbind('mouseleave'); 
```

或者

```
$(this).unbind();  // assuming you have no other handlers you want to keep 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-11-23T16:21:16.990

unbind() 不适用于硬编码的内联事件。

因此，例如，如果您想从 取消绑定 mouseover 事件 `<div id="some_div" onmouseover="do_something();">`，我发现这`$('#some_div').attr('onmouseover','')`是实现它的一种快速而肮脏的方法。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2011-02-17T11:02:16.887

另一个解决方案是**.die()**用于附加**.live()**的事件。

前任。：

```
// attach click event for <a> tags
$('a').live('click', function(){});

// deattach click event from <a> tags
$('a').die('click'); 
```

你可以在这里找到一个很好的参考：[Exploring jQuery .live() and .die()](http://www.alfajango.com/blog/exploring-jquery-live-and-die/)

*（对不起我的英语：>）*

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-30T02:36:00.637

所有悬停在幕后所做的都是绑定到 mouseover 和 mouseout 属性。我会单独绑定和取消绑定这些事件的函数。

例如，假设您有以下 html：

```
<a href="#" class="myLink">Link</a> 
```

那么你的 jQuery 将是：

```
$(document).ready(function() {

  function mouseOver()
  {
    $(this).css('color', 'red');
  }
  function mouseOut()
  {
    $(this).css('color', 'blue');
  }

  // either of these might work
  $('.myLink').hover(mouseOver, mouseOut); 
  $('.myLink').mouseover(mouseOver).mouseout(mouseOut); 
  // otherwise use this
  $('.myLink').bind('mouseover', mouseOver).bind('mouseout', mouseOut);

  // then to unbind
  $('.myLink').click(function(e) {
    e.preventDefault();
    $('.myLink').unbind('mouseover', mouseOver).unbind('mouseout', mouseOut);
  });

}); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2015-12-09T12:50:29.923

您可以删除由 附加的特定事件处理程序`on`，使用`off`

```
$("#ID").on ("eventName", additionalCss, handlerFunction);

// to remove the specific handler
$("#ID").off ("eventName", additionalCss, handlerFunction); 
```

使用这个，你将只删除**handlerFunction**
另一个好的做法是为多个附加事件设置一个命名空间

```
$("#ID").on ("eventName1.nameSpace", additionalCss, handlerFunction1);
$("#ID").on ("eventName2.nameSpace", additionalCss, handlerFunction2);
// ...
$("#ID").on ("eventNameN.nameSpace", additionalCss, handlerFunctionN);

// and to remove handlerFunction from 1 to N, just use this
$("#ID").off(".nameSpace"); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-11-26T03:47:33.623

我发现这可以作为 .hover() 的第二个参数（函数）

```
$('#yourId').hover(
    function(){
        // Your code goes here
    },
    function(){
        $(this).unbind()
    }
}); 
```

第一个函数（.hover() 的参数）是 mouseover 并将执行您的代码。第二个参数是mouseout，它将解除悬停事件与#yourId 的绑定。您的代码将只执行一次。

# php - 在跨域 iframe 中设置 PHP SESSION 变量的问题

> ID：805136
> 
> 赞同：6
> 
> 时间：2009-04-30T02:30:34.737
> 
> 标签：php, iframe, cross-domain, session-variables

科尔斯笔记版本：

`index.php?map_id=foo`加载到 www.not-my-domain.com 上的 iframe。索引集`SESSION['map_id']`= foo。Flash 文件试图`SESSION['map_id']`通过 Authenticate.php，但 Authenticate.php 没有为*任何* `SESSION`变量设置值。

-- 只有首次加载，跨域问题。

详细：

我在设置时有一个索引：`SESSION['map_id'] = foo`

然后索引文件加载一个闪存文件。初始化时，flash 访问一个 'Authenticate.php' 文件，该文件回显`SESSION['map_id']`并通过 加载到 flash 中`LoadVars`。Flash 然后显示适当的数据。 *此步骤不能以其他方式完成*

这一切都在我们的主站点上运行良好。当我们尝试通过提供 iframe 嵌入代码来移植到其他站点时，就会出现问题：

```
<iframe src="http://www.mydomain.com/?map_id=foo&code=bar" ... ></iframe> 
```

在从另一个站点 (www.anotherdomain.com) 重新加载嵌入代码时，`SESSION`变量似乎已被破坏，因为 flash 只是说它们是空的。（`$map_id`输出一个空白）

索引文件仍将正确地回`$map_id`显为“foo”，似乎“Authenticate.php”文件无法访问`SESSION`变量。

我已确保`session_start()`存在于所有适当的文件中。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-30T02:50:59.570

默认情况下，PHP 会话 ID 通过 cookie 传递，但您不能跨域传输 cookie。尝试通过 url 传递会话 ID。

[这是 php 文档中的相应页面](http://us.php.net/manual/en/session.idpassing.php)。

如果不是自动完成，有几种方法可以让 php 在 url 中传递会话 ID。

1.  您可以在 url 中手动传递会话 id（必须在其他 get 变量之前）：

    <iframe src="http://www.mydomain.com/?&map_id=foo&code=bar">

2.  您可以禁用 cookie，强制每个请求将会话 ID 自动添加到 url：

    ini_set("session.use_cookies","0");

3.  您可以编辑 url_rewriter.tags 设置，它告诉 PHP 哪些 html 标记用会话 ID 重写。在这里， iframe=src 已添加到默认集：

    ini_set("url_rewriter.tags", "a=href,area=href,frame=src,iframe=src,input=src,form=fakeentry");

# security - 集中授权服务？

> ID：805141
> 
> 赞同：7
> 
> 时间：2009-04-30T02:33:35.057
> 
> 标签：security, authorization, soa, xacml, josso

有没有可用的开源集中**授权**服务？认证信息集中的解决方案有很多（例如：[CAS](http://www.jasig.org/cas)和[JOSSO](http://www.josso.org/confluence/display/JOSSO1/JOSSO+-+Java+Open+Single+Sign-On+Project+Home)），但是授权信息呢？

有一些非常好的授权框架（例如：[Spring Security](http://static.springsource.org/spring-security/site/reference/html/springsecurity.html)（以前称为 Acegi）和[Seam Security](http://docs.jboss.com/seam/latest-2.1/reference/en-US/html/security.html)），但似乎我必须将它们组合成单独的层或服务。换句话说，我不能很容易地独立运行它们。对于 SOA，不仅集中身份验证而且集中授权信息（即：角色、权限、规则等）似乎是非常有价值的。

有什么建议么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-02T12:23:01.970

您是否正在寻找支持 XACML 的东西？如果是这样，您可以获得的最接近开源的是 OpenSSO 项目，其中包含您所寻求的部分内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-30T03:46:48.827

公开可用的[Kerberos](http://en.wikipedia.org/wiki/Kerberos_(protocol))实现提供[客户端服务授权](http://en.wikipedia.org/wiki/Kerberos_(protocol)#Client_Service_Authorization)以及[客户端身份验证](http://en.wikipedia.org/wiki/Kerberos_(protocol)#Client_Authentication)。

阅读有关[在 Red Hat Linux 上使用 Kerberos 5 的信息](http://www.redhat.com/docs/manuals/linux/RHL-7.2-Manual/ref-guide/ch-kerberos.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-30T02:40:01.610

嗯，也许您可​​以使用 SSO 解决方案并创建一个返回所有授权信息（角色、权限、规则等）的服务，并让每个应用程序使用该服务来获取每个经过身份验证的用户授权信息。

# javascript - 是否所有浏览器引擎都将“\<”视为“<”而将“\>”视为“>”？

> ID：805143
> 
> 赞同：1
> 
> 时间：2009-04-30T02:34:32.463
> 
> 标签：javascript, html, browser, escaping

使“<”到“\<”和“>”到“>”的要点是避免下面的内联脚本：

```
<script>
   var foo = "</script><script>alert('bug');</script><script>"; // the value of foo is generated from server
</script> 
```

foo 的字符串值是从服务器端生成的。因此，我们计划将“<”更改为“\<”，将“>”更改为“>”。（我知道有观点认为“>”应该转义为“>”，但在这种情况下不考虑。）

所以，预期的结果是：

```
<script>
   var foo = "\</script\>\<script\>alert('bug');\</script\>\<script\>"; // the value of foo is generated from server
</script> 
```

对于 IE7/8 和 Firefox，HTML 渲染引擎不会将javascript 字符串中的**\<script\>视为****<script>**标签，JavaScript 引擎仍将其视为字符串“<script>”。但是，我不确定是否所有浏览器都以这种方式处理“>”和“\<”。这种标准适用于所有浏览器吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-30T02:38:35.810

不，你最好的选择是使用 > 和 < 分别为大于号和小于号。

所以你想要这样的东西：

```
var foo = "&lt;/script&gt;&lt;script&gt;alert('bug');&lt;/script&gt;&lt;script&gt;"; 
```

# java - SSL 系统属性 - 安全风险？

> ID：805153
> 
> 赞同：3
> 
> 时间：2009-04-30T02:36:06.953
> 
> 标签：java, security, ssl, jvm

这可能是一个愚蠢的问题，但是通过 System.setProperty 设置我的 Web 服务器 ssl 配置（例如密钥库密码）有多大的安全风险......

如果我做了类似的事情：

```
System.setProperty("javax.net.keyStorePassword", "password"); 
```

1.  这可能会导致安全问题吗？
2.  有没有办法在设置财产的同时防范这种风险？
3.  有人会如何妥协呢？

注意：只是为了添加更多细节，这是一个在 Red Hat 的 Tomcat 6 上运行的 Web 应用程序。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-30T03:03:06.500

这有多大的风险取决于您的代码运行的环境以及您要保护的对象。如果攻击者可以访问平台本身或以某种方式将代码注入您的平台，那么以这种方式设置属性是您的麻烦最少。

只要您的平台能够防止攻击者在您的环境中运行任意代码，您就应该非常安全。

# c# - 定义多个不运行的 TraceSource

> ID：805154
> 
> 赞同：0
> 
> 时间：2009-04-30T02:36:43.550
> 
> 标签：c#, .net, trace

我是 TraceSource 的新手，所以我正在调查它如何/不能使用（基本上是利弊）。

我喜欢的事情是我可以从 .NET 框架本身中获取转储，所以我制作了一个小应用程序来测试它并一起使用我自己的自定义源（因为这就是我希望它被使用的方式），像这样：

```
class Program
{
    static void Main(string[] args)
    {
        SmtpClient smtp = new SmtpClient();
        var mm = new MailMessage();
        mm.To.Add("me@my-site.com");
        mm.Subject = "Trace Testing";
        smtp.Send(mm);

        var ts = new TraceSource("MyCustomTracer");

        ts.TraceEvent(TraceEventType.Error, 0, "This is an error");
        ts.TraceEvent(TraceEventType.Information, 0, "Just debugging now");
    }
} 
```

然后我添加了一些听众到`App.config`这样的：

```
<system.diagnostics>
<trace autoflush="true" />
<sources>
  <source name="MyCustomTracer"
          switchValue="Information, ActivityTracing">
    <listeners>
      <add name="sdt"
          type="System.Diagnostics.XmlWriterTraceListener"
          initializeData= "traceOutput.log" />
    </listeners>
  </source>
  <source name="System.Net"
          switchValue="Information, ActivityTracing, Critical">
    <listeners>
      <add name="sdt"
          type="System.Diagnostics.XmlWriterTraceListener"
          initializeData= "traceOutput.log" />
    </listeners>
  </source>
</sources>
</system.diagnostics> 
```

但是由于某种原因，当我运行应用程序时，我记录的 2 个事件`MyCustomTracer`不会进入日志文件，除非我注释掉这些`SmtpClient`东西（即 - 只使用了我的自定义跟踪器）。

我本来希望可以以我尝试使用它们的方式使用多个 TraceSource，我只是不确定出了什么问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-30T05:06:02.680

发现了问题，一个完全的菜鸟错误，我的两个 TraceSource 项目都有一个正在写入同一个文件的监听器。虽然我不确定确切的错误，但在写作时会发生某种冲突。

如果你想使用同一个监听器有多个源，你需要使用`<sharedListeners />`这样的：

```
<system.diagnostics>
<trace autoflush="true" />
<sources>
  <source name="MyCustomTracer"
          switchValue="Information, ActivityTracing">
    <listeners>
       <add name="sdt" />
    </listeners>
  </source>
  <source name="System.Net"
          switchValue="Information, ActivityTracing, Critical">
    <listeners>
      <add name="sdt" />
    </listeners>
  </source>
</sources>
<sharedListeners>
    <add name="sdt"
        type="System.Diagnostics.XmlWriterTraceListener"
        initializeData= "traceOutput.log" />
</sharedListeners>
</system.diagnostics> 
```

# jquery - 使用 jQuery 构建 HTML (~= DOM)

> ID：805159
> 
> 赞同：18
> 
> 时间：2009-04-30T02:39:28.413
> 
> 标签：jquery, html, dom

我可能做错了什么，但我一直无法找到动态构建基本 HTML/DOM 结构（如列表）的好方法。简单的示例是在给定输入（如 json（对象））的情况下构建表格（表格元素、行、单元格，以及正确转义的文本内容）。

我遇到的问题是大多数调用（如“.append()”、“.html()”、“.text()”）似乎并没有以直观的方式链接（无论如何对我来说）。例如，您**不能**执行以下操作：

```
$("#divId").append("<table>").append("<tr>").append("<td>").text("some text"); 
```

text() 调用似乎清除了主要级别的内容；并附加同样在同一范围内添加内容。我希望 append() 返回正在添加的内容，但它似乎返回了自己的上下文。

我知道有一个简单的“appendText()”扩展对最后一部分有帮助。但是其他人呢？

对于它的价值，现在我通过类似的方式恢复到 DOM

```
$("#divId")[0].appendChild(document.createElement("table")).... 
```

但这很冗长。

所以我希望我错过了一些非常明显的东西......但是什么？除了 append() 之外的调用？

我尝试浏览 jQuery 参考文档，谷歌搜索，但大多数文档只是使用“将所有内容嵌入字符串”；这有问题，包括没有正确引用文本内容。

（另外：不，这不是[“JQuery：在‘内存’而不是 DOM 中构建 HTML”的副本](https://stackoverflow.com/questions/337352/jquery-build-html-in-memory-rather-than-dom)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-30T02:45:42.627

你可以这样做：

```
$("#divId").append("<table>").append("<tr>").append("<b>").text("some text"); 
```

作为：

```
$("#divId").append("<table><tr><td><b>some test</b></td></tr></table>"); 
```

或者

```
$("<b></b>").text("some text").appendTo("<td></td>").appendTo("<tr></tr>").appendTo("<table></table>").appendTo("#divId"); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2011-12-06T01:32:07.693

您可以使用`append`：

```
$("#divId").append(
  $("<table/>").append(
    $("<tr/>").append(
      $("<td/>").append(
        $("<b/>").text("some text")
)))); 
```

如果你真的坚持，你可以使用`appendTo`，但它不太直观，会更慢并且需要更多的击键：

```
$("<b/>").text("some text").appendTo(
  $("<td/>").appendTo(
    $("<tr/>").appendTo(
      $("<table/>").appendTo(
        "#divId"
)))); 
```

在任何情况下，使用`.text("...")`转义特殊字符（并避免 XSS 攻击）都很重要。

**更好**的是，当你对编写这些内容感到厌烦时，你真的很想研究[`jsrender`](https://github.com/BorisMoore/jsrender)、[mustache](http://mustache.github.com/)、[handlebars](http://handlebarsjs.com/)、[doT](https://github.com/olado/doT)或任何其他许多 javascript 模板解决方案。它允许您将代码与 HTML 分开（想想 MVC），并使您正在构建的内容更加清晰。修改起来也容易得多。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-30T05:27:00.897

快速说明：另外，[AppendDOM](http://plugins.jquery.com/project/appendDom)插件看起来也可以简化任务。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-11T02:03:58.137

您还可以使用 jQuery [createHtml](https://github.com/efunneko/jquery.createHtml)插件，它允许您执行以下操作：

```
$("#divId").$table().$tr().$td().$b("some text"); 
```

.append() 链更方便一点，您可以将 html 内容和属性放在元素中，同时将它们串起来：

```
$("#divId").$table({class: "clean"}).$tr().$td({id: "textId"}).$b("some text"); 
```

# python - 如何在 Python 脚本中获取 Perl 脚本的结果？

> ID：805160
> 
> 赞同：1
> 
> 时间：2009-04-30T02:39:31.347
> 
> 标签：python, perl

我在 Perl 中有一个脚本，另一个在 Python 中。我需要在 Python 中获取 Perl 的结果，然后给出最终报告。Perl 的结果可以是标量变量、散列变量或数组。

请尽快让我知道这件事。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-30T03:15:36.563

使用[subprocess](http://docs.python.org/library/subprocess.html)模块运行您的 Perl 脚本以捕获其输出：

您可以在任一脚本中选择任何格式的输出，并使用 Python 打印最终报告。例如：您的 Perl 脚本可以输出 XML，该 XML 可以由 Python 脚本解析，然后使用不同的格式打印。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-30T03:12:25.633

看看Python中的[PyYAML和 Perl 中的](http://pyyaml.org/)[YAML](http://search.cpan.org/dist/YAML/lib/YAML.pm)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-30T02:51:05.793

您可以将结果序列化为某种字符串格式，将其打印到 Perl 脚本中的标准输出。然后，从 python 调用 perl 脚本并将 stdout 的结果重定向到 python 中的变量。

# .net - 使用修补程序对分布式应用程序的程序集进行版本控制

> ID：805161
> 
> 赞同：4
> 
> 时间：2009-04-30T02:39:31.953
> 
> 标签：.net, versioning, change-management

我们正在开发一个包含多个物理层上的组件的应用程序，共享许多程序集以及每个层独有的一些程序集。

我想知道发布热修复程序的典型版本控制策略是什么，或者只是应用程序的几个组件。

我们的问题跟踪软件包含整个产品的版本号。如果当前版本是 1.4.5 并且需要修补程序，则修补程序的问题将针对 1.4.6 发布。受 1.4.6 修复影响的所有程序集的版本均为 1.4.6。如果我们只分发这些文件，我们最终会得到一些 1.4.5 版本的文件和一些 1.4.6 版本的文件。

一个解决方案可能是将整个应用程序重新构建并发布为 1.4.6，但这需要重新部署多台机器上的多个组件，并导致实际上没有更改的组件不必要的停机时间。

人们针对这个问题采取了哪些策略？接受某些文件将具有不同的版本号只是一个问题吗？在过去，我发现这会导致与客户（1 级）支持团队的混淆。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-30T19:24:36.733

你提出了一个有趣的问题。

这实际上是您需要做出的一个政策决定，以决定您的部署和版本控制策略，并考虑各种因素的权衡（您已经注意到其中一些因素，例如客户的困惑）。

您可以做的其中一件事是将各个层的发布和版本控制分离，这将允许您在一个层内具有一致的版本控制，同时减少修补程序部署开销。您还需要将通用程序集分解为单独的包和版本，也可以独立进行。

这可能是矫枉过正，因此另一种方法是使您的版本控制更容易掌握。例如，您可以保留部分版本号以指示修补程序。例如，如果 1.4.5.0 是正式版本，则修补程序将是 1.4.5.1，这很容易理解为 1.4.5 正式版本的一部分。

您还可以使用其他程序集版本，例如`AssemblyInformationalVersion`为您的用户存储版本信息。（查看[我的博客文章](http://www.danielfortunov.com/software/%24daniel_fortunovs_adventures_in_software_development/2009/03/03/assembly_versioning_in_net)，了解有关`AssemblyInformationalVersion`.NET 中的程序集版本控制的更多详细信息。）

# asp.net - ASP.Net：动态创建的下拉列表和数据源

> ID：805162
> 
> 赞同：4
> 
> 时间：2009-04-30T02:39:39.207
> 
> 标签：asp.net, drop-down-menu, sqldatasource, dynamic-controls

我有大约 10 个填充的下拉列表控件。我不想复制/粘贴和修改每个字段，而是以编程方式创建它们。这可以做到吗？

这是其中一个的样子。我想以编程方式添加 10 个下拉列表控件及其各自的 SqlDataSource 控件。

```
 <asp:SqlDataSource ID = "ddlDAGender" runat=server
    ConnectionString="<%$ ConnectionStrings:test1ConnectionString %>" 
    SelectCommand = "select GenderID,Gender from mylookupGender"
    >
    </asp:SqlDataSource>

 <asp:Label ID="Label3" runat="server" Text="Gender"></asp:Label>

        <asp:DropDownList ID="ddlGender" runat="server" 
                DataSourceid="ddlDAGender"
                DataTextField="Gender" DataValueField="GenderID"

    >

 </asp:DropDownList> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-30T03:04:29.523

您始终可以动态创建控件。但是在这种情况下，如果您的所有下拉列表都不同，我不确定它是否会为您节省任何东西，因为您仍然必须为它们分配单独的 ID 和数据源。

代码可能如下所示：

```
protected void Page_Load(object sender, EventArgs e)
{
    if (!IsPostBack)
    {
        BindDropDownLists();
    }
}

protected void Page_Init(object sender, EventArgs e)
{ 

        SqlDataSource sqlDS = new SqlDataSource();
        sqlDS.ConnectionString = ConfigurationManager.ConnectionStrings[0].ToString();
        sqlDS.SelectCommand = "select GenderID,Gender from mylookupGender";
        form1.Controls.Add(sqlDS);

        DropDownList ddl = new DropDownList();
        ddl.ID = "dddlGender";
        ddl.DataSource = sqlDS;
        ddl.DataTextField = "Gender";
        ddl.DataValueField = "GenderID";
        form1.Controls.Add(ddl);

        // ... Repeat above code 9 times or put in a for loop if they're all the same...
}

private void BindDropDownLists()
{
    foreach (Control ctl in form1.Controls)
    {
        if (ctl is DropDownList)
        {
            (ctl as DropDownList).DataBind();
        }
    }
} 
```

# c# - 使用拖放重新排序winforms列表框？

> ID：805165
> 
> 赞同：49
> 
> 时间：2009-04-30T02:42:04.023
> 
> 标签：c#, winforms, listbox

这是一个简单的过程吗？

我只是为内部工具编写一个快速的 hacky UI。

我不想在这上面浪费时间。

* * *

## 回答 #1

> 赞同：94
> 
> 时间：2009-04-30T03:44:54.730

这是一个快速而肮脏的应用程序。基本上我创建了一个带有按钮和列表框的表单。单击按钮时，ListBox 将填充接下来 20 天的日期（必须使用某些东西来进行测试）。然后，它允许在 ListBox 中拖放以重新排序：

```
 public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
            this.listBox1.AllowDrop = true;
        }

        private void button1_Click(object sender, EventArgs e)
        {
            for (int i = 0; i <= 20; i++)
            {
                this.listBox1.Items.Add(DateTime.Now.AddDays(i));
            }
        }

        private void listBox1_MouseDown(object sender, MouseEventArgs e)
        {
            if (this.listBox1.SelectedItem == null) return;
            this.listBox1.DoDragDrop(this.listBox1.SelectedItem, DragDropEffects.Move);
        }

        private void listBox1_DragOver(object sender, DragEventArgs e)
        {
            e.Effect = DragDropEffects.Move;
        }

        private void listBox1_DragDrop(object sender, DragEventArgs e)
        {
            Point point = listBox1.PointToClient(new Point(e.X, e.Y));
            int index = this.listBox1.IndexFromPoint(point);
            if (index < 0) index = this.listBox1.Items.Count-1;
            object data = e.Data.GetData(typeof(DateTime));
            this.listBox1.Items.Remove(data);
            this.listBox1.Items.Insert(index, data);
        } 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2016-11-12T03:09:28.573

晚了 7 年。但对于任何新人，这里是代码。

```
private void listBox1_MouseDown(object sender, MouseEventArgs e)
    {
        if (this.listBox1.SelectedItem == null) return;
        this.listBox1.DoDragDrop(this.listBox1.SelectedItem, DragDropEffects.Move);
    }

    private void listBox1_DragOver(object sender, DragEventArgs e)
    {
        e.Effect = DragDropEffects.Move;
    }

    private void listBox1_DragDrop(object sender, DragEventArgs e)
    {
        Point point = listBox1.PointToClient(new Point(e.X, e.Y));
        int index = this.listBox1.IndexFromPoint(point);
        if (index < 0) index = this.listBox1.Items.Count - 1;
        object data = listBox1.SelectedItem;
        this.listBox1.Items.Remove(data);
        this.listBox1.Items.Insert(index, data);
    }

    private void itemcreator_Load(object sender, EventArgs e)
    {
        this.listBox1.AllowDrop = true;
    } 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-30T03:07:59.077

如果您从未实现拖放，第一次需要几个小时，想要正确完成它并且必须通读文档。尤其是用户取消操作后的即时反馈和恢复列表需要一些思考。将行为封装到可重用的用户控件中也需要一些时间。

如果您从未做过拖放，请查看 MSDN 中的这个[拖放示例](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.dodragdrop.aspx)。这将是一个很好的起点，您可能需要半天时间才能使事情正常进行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-30T03:39:25.680

另一种方法是使用[列表视图](http://msdn.microsoft.com/en-us/library/system.windows.forms.listview.aspx)控件，它是资源管理器用来显示文件夹内容的控件。它更复杂，但为您实现了项目拖动。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-12-07T16:43:42.657

这依赖于上面@BFree 的回答 - 感谢它提供了很多帮助。
我在尝试使用该解决方案时遇到了一个错误，因为我正在为我的列表框使用 DataSource。为了完整起见，如果您尝试直接将项目删除或添加到列表框，则会收到此错误：

```
// Causes error
this.listBox1.Items.Remove(data); 
```

错误：System.ArgumentException：“设置 DataSource 属性时无法修改项目集合。”

解决方案：更新数据源本身，然后重新绑定到您的列表框。Program.SelectedReports 是一个 BindingList。

代码：

```
 private void listboxSelectedReports_DragDrop(object sender, DragEventArgs e)
    {
        // Get the point where item was dropped.
        Point point = listboxSelectedReports.PointToClient(new Point(e.X, e.Y));
        // Get the index of the item where the point was dropped
        int index = this.listboxSelectedReports.IndexFromPoint(point);
        // if index is invalid, put item at the end of the list.
        if (index < 0) index = this.listboxSelectedReports.Items.Count - 1;
        // Get the item's data.
        ReportModel data = (ReportModel)e.Data.GetData(typeof(ReportModel));

        // Update the property we use to control sorting within the original datasource
        int newSortOrder = 0;
        foreach (ReportModel report in Program.SelectedReports) {
            // match sorted item on unique property
            if (data.Id == report.Id)
            {
                report.SortOrder = index;
                if (index == 0) {
                    // only increment our new sort order if index is 0
                    newSortOrder += 1;
                }
            } else {
                // skip our dropped item's index
                if (newSortOrder == index) {
                    newSortOrder += 1;
                }
                report.SortOrder = newSortOrder;
                newSortOrder += 1;
            }
        }

        // Sort original list and reset the list box datasource.
        // Note:  Tried other things, Reset(), Invalidate().  Updating DataSource was only way I found that worked??
        Program.SelectedReports = new BindingList<ReportModel>(Program.SelectedReports.OrderBy(x => x.SortOrder).ToList());
        listboxSelectedReports.DataSource = Program.SelectedReports;
        listboxSelectedReports.DisplayMember = "Name";
        listboxSelectedReports.ValueMember = "ID";
    } 
```

其他说明： BindingList 在此命名空间下：

```
using System.ComponentModel; 
```

在将项目动态添加到列表时，请确保填充排序属性。我使用了一个整数字段“SortOrder”。

当您删除一个项目时，我不必担心更新排序属性，因为它只会创建一个数字间隙，这在我的情况下是可以的，YMMV。

老实说，除了 foreach 循环之外，可能还有更好的排序算法，但在我的情况下，我处理的项目数量非常有限。

# programming-languages - 什么是严格类型语言？

> ID：805168
> 
> 赞同：12
> 
> 时间：2009-04-30T02:43:41.007
> 
> 标签：programming-languages

什么是严格类型语言？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-04-30T03:01:49.747

严格类型的语言强制对所有与之交互的数据进行类型化。

例如

```
int i = 3
string s = "4" 
```

从这里开始，每当你使用 i 时，你只能将它作为一个整数类型与之交互。这意味着您只能使用处理整数的方法。

至于 string ，你只能作为 string 类型与之交互。您可以将它与其他字符串连接，打印出来等。但是，即使它包含该字符“4”，如果不使用某些函数将字符串转换为整数类型，您也无法添加到整数。

在动态类型语言中，您拥有更多的灵活性：

```
i = 3
s = "4" 
```

类型被推断；这意味着它们是根据设置的数据确定的。i 是一个数字类型，s 是一个字符串类型，这取决于它们是如何设置的。但是当你有 i + s; 使用类型推断，根据您的环境，您可能会得到结果 i + s = 7; 因为 s 被编程环境隐式转换为 int。但是，如果环境推断 int + string 应该等于串联操作而不是加法操作，则此操作也可能导致字符串“34”。

这种灵活性使得松散类型的语言非常流行。但是，因为这些类型推断有时会产生意想不到的结果；如果您不小心，它们还会导致代码中出现更多错误。在类型化语言中，如果我执行 i + s，编译器会强制我先将 s 更改为 int，所以我知道通过将 i 添加到 s，我会得到 7，因为我被迫将 s 转换为显式 int第一的。在动态语言中，它会尝试隐式地为您执行此操作，但结果可能不是您所期望的，因为任何东西都可以在 i 或 s 中；一个字符串，一个数字，甚至一个对象。直到你运行你的代码，看看会发生什么，你才会知道。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-30T03:03:34.300

我试图查找“严格键入”，但无法找到该术语的明确定义。也许它指的是一种强类型语言？

[强类型](http://en.wikipedia.org/wiki/Strongly_typed_programming_language)是指一种[类型系统](http://en.wikipedia.org/wiki/Type_system)，其中对可以执行不同类型的两个变量的操作有限制。例如，在一个非常强类型的语言中，尝试添加一个`string`and`number`可能会导致错误。

```
string s;
number n;
s + n;          <-- Type error. 
```

该错误可能发生在[静态类型语言的编译时或](http://en.wikipedia.org/wiki/Type_system#Static_typing)[动态类型语言](http://en.wikipedia.org/wiki/Type_system#Dynamic_typing)的运行时。需要注意的是，静态/动态和强/弱听起来可能是相似的概念，但它们是完全不同的。

弱类型语言可能允许对变量进行强制转换，以允许在源自不同类型的变量之间进行操作：

```
s + (string)n;  <-- Allowed, as (number) has been explicitly
                    casted to (string), so variable types match. 
```

在弱类型语言中，不同类型的变量可能会自动转换为兼容类型。

```
s + n;          <-- Allowed, where the language will cast
                    the (number) to (string) 
```

也许，“严格类型的语言”是指一种非常强类型的语言，其中对如何对不同类型的变量执行操作有更*严格的限制。*

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-30T03:02:29.887

*关于*各种类型系统的强弱程度存在不同意见，但我通常听说“严格类型的编程语言”是指一种**非常** [强类型的编程语言](http://en.wikipedia.org/wiki/Strongly_typed_programming_language)。这通常描述了几种功能语言中的静态类型系统。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-30T02:59:14.950

必须声明变量以包含特定类型数据的语言。

如果您的变量声明如下所示：

```
String myString = "Fred"; 
```

那么您的语言是严格类型的，变量“myString”被明确声明为仅包含字符串数据。

如果以下工作：

```
x = 10;
x = "Fred"; 
```

然后它是松散类型的（同一变量和范围内的两种不同类型的数据）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-30T02:45:34.873

非法的语言`'1' + 3`，因为它将字符串添加到整数。

# sql-server - 使用 LINQ 从 SQL Server DB 随机行

> ID：805169
> 
> 赞同：1
> 
> 时间：2009-04-30T02:44:02.740
> 
> 标签：sql-server, linq-to-sql

我需要从 SQL Server 数据库中检索随机行。我正在寻找一种使用 LINQ 查询来实现此目的的方法。是否可以？

SQL 查询：SELECT [Id] FROM [MyTable] ORDER BY NEWID()

上述 SQL 的等效 LINQ 查询是什么？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-30T02:56:30.493

为您的数据上下文类制作一个部分并放入以下方法：

```
partial class MyDataContext {
    [Function(Name = "NEWID", IsComposable = true)]
    public Guid Random()
    {
        return Guid.NewGuid();
    }
} 
```

现在您可以将其组合到您的查询中，它会被转换为对 sql newid() 函数的调用，如下所示：

```
from x in dc.MyEntities orderby dc.Random() select x.Id 
```

# ruby - 从 Web 浏览器编程 ruby

> ID：805172
> 
> 赞同：3
> 
> 时间：2009-04-30T02:44:45.607
> 
> 标签：ruby

[_why](http://tryruby.hobix.com/)使您能够从 Web 浏览器运行 ruby​​（尤其是 irb），而[github](http://github.com)允许您从 Web 浏览器编辑受版本控制的代码。

有什么东西可以让您从网络浏览器中同时执行这两项操作，即编辑代码并运行它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-30T02:52:27.570

也许[herokugarden](http://herokugarden.com/)？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-30T04:22:32.360

在本地编辑、提交和拥有一个将最新版本推送到正确位置的 git 钩子有什么问题？

[http://git-scm.com/docs/githooks](http://git-scm.com/docs/githooks)

# iphone - 2 部 iphone 可以多快交换有关倾斜/位置的信息？

> ID：805177
> 
> 赞同：5
> 
> 时间：2009-04-30T02:47:47.393
> 
> 标签：iphone, bluetooth, information-retrieval

我想知道将有关某部特定 iPhone 的倾斜和位置（不是 gps）的信息传达给另一部需要多长时间。2 部 iphone 可以同时发送和接收这些信息吗？3个iphone怎么样？我对能够同时发送和接收并根据在半秒内收到的这些信息做出有条件的决定的应用程序感兴趣。

有什么可以拍的吗？如果是这样，是蓝牙还是wifi更好？

非常感谢，杰克

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-30T02:51:26.357

目前，如果没有中间服务器，这是不可能的。（如果没有越狱，这将成为可能，但非常困难）

我假设您的目的是游戏，在这种情况下，与访问服务器并通过蜂窝数据网络返回相关的延迟可能需要很长时间才能获得任何令人满意的游戏体验。我不相信它会在半秒钟之内。

这将在即将推出的 3.0 iPhone 软件中通过蓝牙实现，但这仍处于保密协议之下，因此在发布之前您不太可能获得任何可靠的性能数据。如果我猜的话，我肯定会猜到与直接蓝牙连接相关的延迟将远低于半秒。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-30T03:24:38.600

您现在可以选择的只有 Wi-Fi 或蜂窝网络。如果您通过 Wi-Fi 使用 Bonjour，您将在几毫秒内有延迟，但所有手机都必须连接到同一个接入点。看一下 WiTap 示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-01-15T08:59:12.133

绝对有可能，您希望通过 WiFi 连接您的对等方以获得最佳性能和可靠性，但只要您的数据包被限制为小尺寸（< 1k），蓝牙就可以了。查看此文档和示例代码以了解如何访问 UIAccelerometer：

[http://developer.apple.com/iphone/library/documentation/UIKit/Reference/UIAccelerometer_Class/Reference/UIAccelerometer.html](http://developer.apple.com/iphone/library/documentation/UIKit/Reference/UIAccelerometer_Class/Reference/UIAccelerometer.html)

[http://developer.apple.com/iphone/library/samplecode/AccelerometerGraph/index.html#//apple_ref/doc/uid/DTS40007410](http://developer.apple.com/iphone/library/samplecode/AccelerometerGraph/index.html#//apple_ref/doc/uid/DTS40007410)

诀窍是更新频率部分由系统需要控制，因此可能存在一个窗口（当系统尝试更新设备方向时），您的应用程序没有收到任何更新。

# wcf - 为什么 WCF 格式化程序会引发异常？

> ID：805192
> 
> 赞同：1
> 
> 时间：2009-04-30T02:56:39.777
> 
> 标签：wcf, web-services

在调用 WCF 服务时收到以下错误消息：

> “格式化程序在尝试反序列化消息时抛出异常：尝试反序列化参数[http://tempuri.org/:fieldText](http://tempuri.org/:fieldText)时出错。InnerException 消息是“反序列化 System.String 类型的对象时出错[]。读取 XML 数据时超出了最大字符串内容长度配额 (8192)。可以通过更改创建 XML 读取器时使用的 XmlDictionaryReaderQuotas 对象的 MaxStringContentLength 属性来增加此配额。第 1 行，位置 10889。'。请有关更多详细信息，请参阅 InnerException。”

我的 web.config 中的 WCF 部分如下所示：

```
<basicHttpBinding>
        <binding name="BasicHttpBinding_IMySvc" maxReceivedMessageSize="2147483647" sendTimeout="00:05:00"
                 messageEncoding="Text" textEncoding="utf-8" >
          <readerQuotas maxStringContentLength="2147483647" maxArrayLength="163840000"/>
        </binding>
</basicHttpBinding> 
```

另外，我输入消息的大小是：15869 个字符。

我在这里想念什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-30T03:00:07.927

确保您的端点实际上正在使用绑定。

```
<endpoint address="" binding="basicHttpBinding" contract="IMySvc" bindingConfiguration="BasicHttpBinding_IMySvc"> 
```

# iphone - 音频包络差异... ADTS、CAF、

> ID：805199
> 
> 赞同：1
> 
> 时间：2009-04-30T03:01:25.973
> 
> 标签：iphone, audio

我想知道这些不同的音频包络之间的区别。以及何时使用一种代替另一种。

对不起，如果我的问题看起来很愚蠢......

谢谢你的帮助。

蒂埃里

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-30T04:45:30.497

根本不是一个愚蠢的问题。ADTS 是 AAC（数据格式）编码音频的容器（文件格式）。另一方面，CAF 是苹果为多种不同音频数据格式开发的容器。[您可以在此处](http://developer.apple.com/iphone/library/documentation/MusicAudio/Conceptual/CoreAudioOverview/SupportedAudioFormatsMacOSX/SupportedAudioFormatsMacOSX.html)找到此容器支持的格式列表。

至于用哪一个，什么时候用。。

我不确定您对音频格式有多熟悉，但如上所述，有两个概念需要考虑：

1.  我将如何编码音频？
2.  我将使用什么文件格式打包它？

第一个问题的答案主要取决于您所寻求的最终音频质量，以及您希望最终数据的大小。

第二个问题的答案还取决于第一个问题的答案和其他考虑因素，例如我希望在音频中包含哪些其他数据（视频、文本、GPS 坐标等）。

对于这两个问题，您还需要考虑与要用于播放音频的硬件和软件的兼容性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-30T08:54:37.607

我同意卡帕尔并投票支持他，但是我想指出这个问题中的词汇问题......（术语是一个非常重要的因素）。音频包络与音频文件格式非常不同（无论该格式是否是包装器）。

引用 Barry Truax 的[声学生态手册](http://www.sfu.ca/sonic-studio/handbook/index.html)：

> 声音的包络是它在时间上的宏观幅度行为，而它的声压变化的微观层次模式是它的波形。

[信封](http://www.sfu.ca/sonic-studio/handbook/Envelope.html)

|K<

# c# - 非托管到托管选项：性能注意事项

> ID：805216
> 
> 赞同：0
> 
> 时间：2009-04-30T03:10:51.613
> 
> 标签：c#, c++-cli

初步：调用者是一个原生的EXE，它暴露了一种“插件”架构。它旨在加载 DLL（按名称，指定为命令行 arg）。该 DLL 必须是本机的，并导出特定的函数签名。EXE 是 C++，这不是太重要，因为 EXE 是一个黑盒（不能修改/重新编译）。原生DLL可以通过在所述DLL中完全实现原生解决方案来满足应用程序的需求。然而，一个要求是允许在 C# 中编码真正的工作（从而将本机 DLL 变成一个瘦包装器/网关）。这导致我有 3 个选项（如果有更多，请分享）：

1.  本机 DLL 加载内部使用 C# 类库的 C++/Cli DLL
2.  本机 DLL 通过 CCW 与 C# COM 对象交互
3.  本机 DLL 托管 CLR 并调用 C# 程序集

另一个要求是，不仅本机 DLL 需要一种在 C# 上发送消息（调用函数）的方法，而且 C# 需要能够在某些异常事件发生时向本机 DLL 触发事件/回调（而不是关闭并返回）。现在这最后一件事我不确定如何在第三个选项中处理，但这完全是另一个问题。

所以重点是：性能。有关这些方法的任何信息（假设它们都满足要求）？根据我的调查，我的理解是 2 会比 1 有更多的开销，但我不是 100% 有信心，这就是我在这里的原因。至于3，我只是还没有任何信息。

因此，如果有人处理过这些（或知道另一个优雅的选择），请加入。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-30T15:23:22.710

我之前已经完成了选项 1，并取得了相当大的成功。我不记得有任何显着的性能影响，尽管我的应用程序的性能并不十分密集。在我看来，如果出现性能问题，可能的罪魁祸首可能是频繁的、小的本地到托管的转换。是否可以在 C++/CLI 层对它们进行批处理？

# php - MySQL+Php 服务器可以同时占用多少个连接？

> ID：805218
> 
> 赞同：0
> 
> 时间：2009-04-30T03:11:02.487
> 
> 标签：php, mysql

它可以支持小型企业吗？人们是否推荐 MySql + Php 设置或 Java 服务器来支持具有 2000 个编辑器同时访问数据的业务？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-30T03:41:56.843

如果这是您所要求的，MySQL 和 PHP 是非常可扩展的。但是一台服务器能否支持2000个并发用户，很大程度上取决于硬件。此外，任何语言编写的糟糕的应用程序都会显着增加服务器的负载。

使用 MySQL 的站点/公司：

*   百度
*   维基百科
*   可口的
*   掘客
*   Facebook
*   进料燃烧器
*   弗里克
*   鲜肉网
*   朋友圈
*   领英
*   生活杂志
*   照片桶
*   斜线点
*   偶然发现
*   推特
*   YouTube
*   你发送它
*   热不热
*   37 个信号

使用 PHP 的网站：

*   Facebook
*   照片桶
*   维基百科
*   雅虎！
*   掘客
*   朋友圈
*   源锻造
*   弗里克
*   图片黑客
*   WordPress.org

编辑：
选择开发平台的标准比它可以支持的最大连接数要好得多（更重要）。除非您有严格的硬件限制并且绝对需要从服务器中榨取每一盎司的性能，否则出于这个原因选择一个而不是另一个是没有意义的。所有主要的 RDBMS 和脚本语言都具有合理的性能和良好的可扩展性。您会发现它们都被用于各种规模的组织和应用程序中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-30T03:14:53.460

它可以像任何其他常用的设置一样容易地完成。您是打算从头开始构建自己的，还是（希望）确定了一个现有的解决方案？

例如，流行的 phpBB 论坛应用程序多年来一直支持类似的大量使用，甚至在提高摩尔定律可扩展性的好处之前。几个 CMS 包也将是强有力的参考。

我担心，如果你问这样一个基本的问题，你可能会有一段相当长的路要走。例如，使用这些工具的通用设计将不需要接近 2000 个与服务器或数据库的“同时连接”来支持 2000 个 PHP 驱动的网页用户同时登录。

# git - 如何将本地 Git 分支复制到远程仓库

> ID：805222
> 
> 赞同：128
> 
> 时间：2009-04-30T03:13:21.343
> 
> 标签：git, version-control, distributed

到目前为止，我已经采取了以下步骤：

1.  克隆了一个远程 Git 存储库
2.  将主分支分支到实验
3.  在实验分支中编辑/测试/提交的代码

现在，我还没准备好将实验性合并到大师级。但是，我确实想将它推回远程仓库，因为那是我与几个同事共享的仓库。我想让他们看看我在实验分支中做了什么。我通常只是通过 SSH 访问远程仓库。

如何在远程 repo 上共享我的本地分支，而不影响远程 repo 的 master 分支？

* * *

## 回答 #1

> 赞同：157
> 
> 时间：2009-04-30T04:13:03.320

根据[git push 手册页](http://www.kernel.org/pub/software/scm/git/docs/git-push.html)：

```
 git push origin experimental 
```

在源存储库中找到匹配的 ref `experimental`（很可能会找到`refs/heads/experimental`），并用它更新原始存储库中的相同 ref（例如`refs/heads/experimental`）。
**如果`experimental`远程不存在，它将被创建**。

这与以下内容相同：

```
git push origin experimental:refs/heads/experimental 
```

`experimental`通过复制当前分支在源存储库中创建`experimental`分支。
只有在本地名称和远程名称不同时**，才需要在远程存储库中创建新的分支或标签**；否则，引用名称本身将起作用。

[或者，就像在git tip](http://reinh.com/blog/2008/04/18/git-push-just-the-tip.html)中提到的那样，您可以设置一个“分支的默认远程”：

> 您可以使用 git config 将默认远程分配给给定分支。除非另有说明，否则此默认远程将用于推送该分支。
> 
> 这在您使用 git clone 时已经为您完成，允许您使用 git push 不带任何参数来推送本地主分支以更新源存储库的主分支。
> 
> ```
> git config branch.<name>.remote <remote> 
> ```
> 
> 可用于手动指定。

* * *

[Jan](https://stackoverflow.com/users/458170/jan)建议（对于[git >= 1.7.0](http://kernel.org/pub/software/scm/git/docs/RelNotes-1.7.0.txt)）`push -u`(or `push --set-upstream`) 选项：

> 对于每个最新或成功推送的分支，添加上游（跟踪）引用，由无参数 git-pull(1) 和其他命令使用。

这样，您不必执行任何 git config。

```
git push -u origin experimental 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-04-30T03:21:41.773

如果您的分支的名称是`experimental`，而远程的名称是`origin`，那么它是

```
git push origin experimental 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-02-24T22:12:23.167

`git push -u <remote-name> <branch-name>`如果新创建的分支不是从同一个 repo 生成的，则不起作用，即如果您没有使用 创建新分支`git checkout -b new_branch`，那么这将不起作用。

例如，我在本地克隆了两个不同的存储库，我必须将 repo2/branch1 复制到 repo1/，然后再推送它。

[此](http://cmdlinelinux.blogspot.com/2014/02/git-push-new-local-branch-cloned-from.html)链接帮助我将本地分支（从另一个仓库克隆）推送到远程仓库：

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-30T03:20:28.470

这里是github远程管理的权威github页面[http://github.com/guides/push-a-branch-to-github](http://github.com/guides/push-a-branch-to-github)。它将帮助您回答所有问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-06-19T09:08:15.187

## tl;博士

```
$ git push --set-upstream origin your_new_branch 
```

## 更多信息

在您对以下内容进行了一些提交之后：

```
$ git checkout -b your_new_branch
$ git add file
$ git commit -m "changed file" 
```

您将指定上游的分支推送到远程存储库之一，如下所示：

```
$ git push --set-upstream REMOTE YOUR_BRANCH 
```

遥控器可以看到

```
$ git remote -v 
```

通常，您将拥有单个默认遥控器`origin`。所以你的命令看起来像：

```
$ git push --set-upstream origin your_new_branch 
```

并且所有后续推送都可以使用`git push`.

# php - 对象属性

> ID：805227
> 
> 赞同：1
> 
> 时间：2009-04-30T03:17:27.947
> 
> 标签：php, oop, class

****为内置函数****赋值的唯一方法是通过方法吗？**`$systime`**

 ****```
class Test{
    private  $systime;
    public function get_systime(){
       $this->systime = time();
    }
} 
```

**马上我会认为这样的事情对吗？：**

```
class Test{
    private  $systime = time();
    public function get_systime(){
      echo $this->systime;
    }
} 
```

**谢谢**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-30T03:47:01.370

您应该能够使用构造函数来分配值，例如：

```
class Test {
  private $systime;
  function __construct() {
    $this->systime = time();
  }

  public function get_systime(){
    echo $this->systime;
  }
}

$t = new Test();
$t->get_systime(); 
```

有关 __construct() 的更多信息，请参阅[面向对象 php 的 php 手册部分。](http://www.php.net/manual/en/language.oop5.decon.php)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-30T03:48:42.490

来自[http://www.php.net/manual/en/language.oop5.basic.php](http://www.php.net/manual/en/language.oop5.basic.php)（就在示例 3 之前）

> 默认值必须是常量表达式，而不是（例如）变量、类成员或函数调用。

但是，您也可以从构造函数中赋值：

```
class Test{
    private  $systime;
    public function __construct(){
        $this->systime = time();
    }
    public function get_systime(){
      echo $this->systime;
    }
} 
```

# asp.net - 我是否必须为 iis7.5 重写任何主要代码？

> ID：805233
> 
> 赞同：0
> 
> 时间：2009-04-30T03:22:05.113
> 
> 标签：asp.net, iis, url-rewriting, iis-7.5

有谁知道 Windows 7 附带的 IIS7.5 是否有任何重大变化，需要重写主要网站 (CMS) 的全部或部分内容。显然不知道我的代码，很难判断这一点，但我还没有找到任何关于 IIS7.5 中预期内容的公告，并且想了解一下。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-30T06:01:07.490

不要指望任何重大变化。[本文档显示了更改。](http://blogs.iis.net/mailant/archive/2009/01/11/iis7-in-windows-server-2008-r2.aspx)

IIS7 引入了很多新特性，并且是一个有些戏剧性的变化。IIS 7.5 就是在此基础上构建的。现在可以通过[Web 平台安装程序](http://www.microsoft.com/Web/downloads/platform.aspx)下载的一些功能 （如 FTP 7.5）将从一开始就包含在 IIS 7.5 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-02T13:25:47.017

我已经将我的一些项目导入到 Win7 的 IIS 中，如果您来自[IIS7](http://msdn.microsoft.com/en-gb/library/ms689429.aspx)环境，那么一切都会嗡嗡作响（到目前为止）。如果您来自较低版本的 IIS，则需要考虑一些事项（例如 web.config 中的 system.webServer 节点）。

但是，您是对的，除了 CMS，我不知道您的代码是什么。从个人经验来看，我没有遇到任何问题。

# vim - 无法在 Vim 的可视模式下将文本附加到另一个文件

> ID：805249
> 
> 赞同：4
> 
> 时间：2009-04-30T03:30:33.093
> 
> 标签：vim, append

我已经通过视觉模式选择了文本并按下了:。

我运行以下命令失败

```
w >> ~/Documents/Test/test.java 
```

结果是一个空文件。

**如何在 Vim 的可视模式下将文本附加到另一个文件？**

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-30T04:01:46.733

在可视模式下选择文本并输入“:”后，您应该会看到“:'<,'>”已经为您输入了。这意味着在视觉选择的开始和结束之间。您可以在“:'<,'>”**之后**添加“w >> ~/Documents/Test/test.java ”。在按 Enter 之前您会看到：

```
:'<,'>w >> ~/Documents/Test/test.java 
```

如果文件不存在或您没有适当的权限，您将收到错误消息，否则应显示“附加”并正常工作。我对此进行了测试，它适用于 Vim 7.2。

# sql-server - 在 SQL Server 中存储 UTF-16/Unicode 数据

> ID：805259
> 
> 赞同：7
> 
> 时间：2009-04-30T03:39:39.093
> 
> 标签：sql-server, unicode, utf-16, ucs2

据此，SQL Server 2K5 在内部使用 UCS-2 [。](http://msdn.microsoft.com/en-us/library/bb330962.aspx#intlftrql2005_topic4)它可以在 UCS-2 中存储 UTF-16 数据（具有适当的数据类型，nchar 等），但是如果有补充字符，则将其存储为 2 个 UCS-2 字符。

这给字符串函数带来了明显的问题，即 SQL Server 将一个字符视为 2。

令我有些惊讶的是，SQL Server 基本上只能处理 UCS-2，甚至更多，以至于这在 SQL 2K8 中没有得到修复。我很欣赏其中一些角色可能并不那么常见。

除了文章中建议的函数之外，还有关于在 SQL Server 2K5 中处理（损坏的）字符串函数和 UTF-16 数据的最佳方法的任何建议。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-11T02:57:05.910

SQL Server 2012 现在支持 UTF-16，包括代理对。请参阅[http://msdn.microsoft.com/en-us/library/ms143726(v=sql.110).aspx](http://msdn.microsoft.com/en-us/library/ms143726(v=sql.110).aspx)，尤其是“补充字符”部分。

因此，解决原始问题的一种方法是采用 SQL Server 2012。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-30T03:50:50.720

字符串函数适用于 unicode 字符串；关心字符数的人将两个字节的字符视为单个字符，而不是两个字符。唯一需要注意的是 len() 和 datalength()，它们在使用 unicode 时返回不同的值。它们当然返回正确的值 - len() 返回字符长度，datalength() 返回字节长度。由于两个字节的字符，它们恰好不同。

因此，只要您在代码中使用正确的函数，一切都应该透明地工作。

**编辑**：只是仔细检查了[联机丛书](http://msdn.microsoft.com/en-us/library/aa223981.aspx)，自 SQL Server 2000 以来，unicode 数据与字符串函数无缝协作。

**编辑 2**：正如评论中所指出的，SQL Server 的字符串函数不支持完整的 Unicode 字符集，因为不支持解析平面 0 之外的代理项（或者，换句话说，SQL Server 的字符串函数最多只能识别 2每个字符的字节数。）SQL Server 将正确存储和返回数据，但是任何依赖于字符计数的字符串函数都不会返回预期值。绕过此问题的最常见方法似乎是在 SQL Server 外部处理字符串，或者使用 CLR 集成添加可识别 Unicode 的字符串处理函数。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2010-02-06T00:44:59.983

要补充的东西，我刚刚学会了艰难的方式：

如果您在 oracle 中使用“n”字段（我正在运行 9i），并通过 .net oracleclient 访问它，似乎只有参数化的 sql 可以工作......如果 N'string' unicode 前缀似乎不起作用你有一些内联sql。

我所说的“工作”是指：它将丢失基本字符集不支持的任何字符。所以在我的例子中，英文字符工作正常，西里尔字母变成问号/垃圾。

这是关于这个主题的更全面的讨论： http: [//forums.oracle.com/forums/thread.jspa?threadID=376847](http://forums.oracle.com/forums/thread.jspa?threadID=376847)

想知道 ORA_NCHAR_LITERAL_REPLACE 变量是否可以在连接字符串或其他东西中设置。

# c# - 如何定义基本类型的泛型类型限制？

> ID：805264
> 
> 赞同：90
> 
> 时间：2009-04-30T03:42:55.500
> 
> 标签：c#, .net, generics, type-constraints

我有以下泛型类型的方法：

```
T GetValue<T>(); 
```

我想将 T 限制为原始类型，例如 int、string、float 但不是类类型。我知道我可以为这样的类类型定义泛型：

```
C GetObject<C>() where C: class; 
```

我不确定原始类型是否可能以及如何。

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2009-04-30T03:47:19.327

您可以使用它来将其限制为值类型：

```
where C: struct 
```

您还提到了字符串。不幸的是，不允许使用字符串，因为它们不是值类型。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2013-12-03T12:37:29.480

实际上，这在一定程度上起到了作用：

```
public T Object<T>() where T :
   struct, IComparable, IFormattable, IConvertible, IComparable<T>, IEquatable<T> 
```

要限制为数字类型，您可以获得为[ValueType](http://msdn.microsoft.com/en-us/library/system.valuetype.aspx?cs-save-lang=1&cs-lang=csharp#code-snippet-3)类定义的以下示例的一些有用提示

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2009-04-30T03:48:02.337

这是您要查找的内容：

```
T GetObject<T>() where T : struct; 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-04-30T04:26:43.193

没有通用的约束可以完全匹配这组事物。你真正想做的是什么？例如，您可以通过运行时检查来破解它，例如静态 ctor（对于泛型类型 - 对于泛型方法来说并不那么容易）......

然而; 大多数时候我看到这个，这是因为人们想要以下之一：

*   能够检查项目是否相等：在这种情况下使用`EqualityComparer<T>.Default`
*   能够比较/排序项目：在这种情况下使用`Comparer<T>.Default`
*   能够执行算术：在这种情况下，请使用[MiscUtil](http://www.yoda.arachsys.com/csharp/miscutil/)对[通用运算符的支持](http://www.yoda.arachsys.com/csharp/miscutil/usage/genericoperators.html)

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-04-30T03:58:12.013

您实际上要在该方法中做什么？可能您实际上需要 C 来实现 IComparable 或其他接口。在这种情况下，您想要类似的东西

```
T GetObject<T> where T: IComparable 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-12-28T13:28:39.077

如果您需要可以使用为托管类型（例如 sizeof 运算符）保留的语言功能的类型，请使用“非托管”。

```
where C: unmanaged 
```

# iphone - 我不能在 UIView 类之外初始化 CALayer 有什么原因吗？

> ID：805265
> 
> 赞同：3
> 
> 时间：2009-04-30T03:43:34.903
> 
> 标签：iphone, uiview, calayer

我一直在尝试将我们的 CALayers 作为我正在开发的 iPhone 应用程序中的“精灵”。从我一直在阅读的内容来看，这似乎是正确的做法。

当我在 UIView 类中设置图层时，我可以让图层显示在屏幕上： NSLog(@"GameView initWithCoder");

```
NSString* imagePath = [[NSBundle mainBundle] pathForResource:@"earth" ofType:@"png"];
earthImage = [[UIImage alloc] initWithContentsOfFile:imagePath];

earthLayer = [CALayer layer];
[earthLayer setContents:(id)[earthImage CGImage]];
[earthLayer setBounds:CGRectMake(0, 0, 32, 32)];
[earthLayer setPosition:CGPointMake(50, 50)];
[earthLayer setName:@"earth"];

[[self layer] addSublayer:earthLayer]; 
```

但是，当我尝试在 UIView 之外初始化 CALayer 时，我的应用程序崩溃了：

```
- (void)loadImage:(NSString*)fileName
{
  NSLog(@"GamePiece loadImage");
  NSArray* fileNameParts = [fileName componentsSeparatedByString:@"."];
  imageName = [[fileNameParts objectAtIndex:0] retain];
  NSString* ext = [fileNameParts objectAtIndex:1];

  NSString* imagePath = [[NSBundle mainBundle] pathForResource:imageName ofType:ext];
  image = [[UIImage alloc] initWithContentsOfFile:imagePath];

  layer = [CALayer layer];
  [layer setContents:(id)[image CGImage]];

  [layer setBounds:CGRectMake(0.0f, 0.0f, 32.0f, 32.0f)];
  [layer setPosition:CGPointMake(50.0f, 50.0f)];
  [layer setName:imageName];

  [fileNameParts release], fileNameParts = nil;
  [ext release], ext = nil;
} 
```

* * *

```
NSLog(@"GameView initWithCoder");
earth = [[GamePiece alloc] init];
[earth loadImage:@"earth.png"];

[[self layer] addSublayer:[earth layer]]; 
```

显然我在这里做错了什么，但我只是不知道那会是什么。我已经阅读了核心动画编程指南和 iPhone 应用程序编程指南，但他们似乎真的没有谈论如何初始化 CALayer，而不是顺便说一句。

我只需要在正确的方向轻轻推动。在 iPhone 编程方面，我对所学的所有其他知识都有了很好的理解。我只是在图形、图层和动画方面遇到了一些问题。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-30T03:50:33.123

您不拥有从该`layer`方法获得的层，因此您必须拥有所有权。在您的方法返回后的某个时间，该层正在被释放，这导致了您的崩溃。要解决这个问题：

```
layer = [[CALayer layer] retain]; // now we explicitly take ownership of this layer 
```

另外，不要忘记释放该层，因为您现在拥有它：

```
// in your dealloc method
[layer release]; 
```

您应该查看[Cocoa 的内存管理编程指南，](http://developer.apple.com/documentation/Cocoa/Conceptual/MemoryMgmt/MemoryMgmt.html)了解有关您何时拥有对象以及您在内存管理方面的职责的更多详细信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-30T12:55:35.110

杰森，非常感谢您的回复！但是，您的回答似乎对我的问题的结果没有任何影响。

实际上，答案“是”与内存管理有关的东西。不是Layer，而是我在调用componentsSeparatedByString:后从NSArray得到的名字。如果我不释放 NSArray，则代码可以正常工作。所以我需要在数组中复制 NSString 而不是使用数组中的对象。

我不得不说我没有按照你的建议阅读 Cocoa 的内存管理编程指南。但是，我读过其他几本书，其中讨论了 Cocoa 中用于创建对象及其保留计数的标准。我有一个公平的理解，但显然，还没有需要的那么好。

我真的怀疑我应该将字符串从数组中复制出来，但是当它在 UIView 中工作时，我只是假设它是正确的。问题是，我没有像在我的 GamePiece 对象中那样保持它。

感谢您至少让我朝着正确的方向前进！我真的对这段代码束手无策。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-10-08T02:18:13.170

做你想做的事，这里是你如何改变你的代码。在`loadImage:`使用此行将`UIImage`您加载到`earth`图层中添加：

> self.contents = image.CGImage;

`CALayers`有一个`contents`属性，您可以将其设置为 a`CGImage`而不是通过使用 Core Graphics 调用将图像绘制到图层的上下文中的麻烦。

然后在父子`UIView`类中，您可以`earth`像这样添加到视图层次结构中：

> [self.layer addSublayer:earth];

请注意，`earth`它本身就是`CALayer`以图像为内容的，因此我将其直接添加为子图层。我总是忘记做的另一件事是设置图层的`frame`属性。否则它的宽度和高度将为零，因此不会显示。

在您的代码中，您创建了一个层，但从未将您的层添加到视图层次结构中。如果视图（UIView 类）及其子视图存在树。树的根是 [UIWindow mainwindow] （注意 UIWindow 是 的子类`UIView`。每个`UIView`都有一个`layer`type 的属性，`CALayer`它实际上包含其可见内容。`UIView`只是一个包装器，`CALayer`用于添加诸如触摸处理能力之类的东西。

您在这里缺少的重要想法是，对于任何要在屏幕上可见的内容，它必须是该视图树的一部分，并以 UIWindow 作为其根，并且所有视图都必须可见（即，将它们的`hidden`属性设置为`NO`）顶层窗口和有问题的图层。只有这样，一个图层才会在屏幕上可见。因此，在您的代码中的某处，您需要将您的层添加为通过调用`addSublayer:`.

在您的情况下，我假设`earth`是 a 的一个实例，`CALayer`并且您在该`loadImage:`方法中所做的是在层内创建一个新的`CALayer`（通过调用`[CALayer layer]`），`earth`但是您从未将该新层添加到任何东西中，因此它永远不会变得可见。相反，您所做的是尝试将`earth`仍然没有任何内容的图层添加到我认为是 a`UIView`的图层

> [[self layer] addSublayer:[earth layer]];

`layer`这条线的一个问题是你似乎在想`earth`. 实际上`layer`是一个类方法，`CALayer`它是一个创建新实例的工厂方法`CALayer`。这很令人困惑，因为`[self layer]`实际上是在访问`UIView`实例的 layer 属性。（我假设`self`指的是`UIView`子类的一个实例。）

# java - 加载 web.xml 以使用 jetty 进行集成测试

> ID：805280
> 
> 赞同：8
> 
> 时间：2009-04-30T03:51:27.333
> 
> 标签：java, jvm, jetty

好的，这与以下内容有关：[Using jetty to install and run servlet tests programmatically](https://stackoverflow.com/questions/728805/using-jetty-to-install-and-run-servlet-tests-programmatically)

在那里得到了很好的答案，并且能够以编程方式加载 servlet，而且一切都非常棒。

然而，我想做的是在测试中加载一个 web.xml（全部在类路径中）并让它运行一个服务器（使用当前的类路径）——我在文档中看到了如何将它指向一个目录这样做，但我想处理类路径（更适合就地测试）。基本上验证了我的 web.xml。

（它不相关，但这个应用程序在 scala 中，但我对此没有任何问题，一切都像宣传的那样工作）。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-08-07T13:34:06.230

听起来您想要做的是以编程方式加载适当的 Web 应用程序，而不是加载单个 servlet（我认为您希望在没有完整的 WAR 文件可工作的情况下这样做）。

```
Server server = new Server( port );
WebAppContext root = new WebAppContext();

root.setWar("/path/to/somewhere");
root.setContextPath("/");

server.addHandler( root );
server.start(); 
```

诀窍是`/path/to/somewhere`应该包含一个`WEB-INF`目录，并且您的`web.xml`文件应该存在于其中。没有其他东西需要存在于该目录结构中，因为其他所有内容都可以从您的类路径中自动加载（尽管如果您愿意，您可以将其设为实际 WAR 文件的路径或完整的分解 WAR 树）。

# search - 不打开 Zsh 就无法快速搜索手册

> ID：805283
> 
> 赞同：0
> 
> 时间：2009-04-30T03:52:26.693
> 
> 标签：search, zsh, manual

下面的命令给出了许多 Zsh 的手册

```
man zsh<tab> 
```

[替代文字 http://dl.getdropbox.com/u/175564/zsh.png](http://dl.getdropbox.com/u/175564/zsh.png)

我想快速浏览它们以搜索单词 compinit。

**如何在 Zsh 的手册中快速搜索 compinit 这个词？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-30T04:10:33.733

使用互联网可能是最好的方法。另一种方法是使用 zshall 联机帮助页，其中包含所有联机帮助页。然后，您可以在您使用的任何查看器中搜索 compinit。

编辑：我只记得这样做的更好方法：使用 zsh 的`run-help`功能。

```
$> run-help compinit 
```

这将带您到 zsh 认为最适合该主题的联机帮助页。它也适用于非 zsh 相关的主题，如 ps、grep 等，但也适用于 zsh 主题。

如果由于某种原因`run-help`未加载，您可以使用

```
$> autoload run-help 
```

这样做。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-30T04:12:40.560

通常对于这种事情 man -k compinit 起作用，因为作者足够明智地将大量标识符放入手册页的“简短描述”中。

这似乎不是这里的情况......所以你将不得不通过源代码。哪个被压缩了...

```
zgrep -c compinit /usr/share/man/man1/zsh* 
```

或者如果你没有 zgrep：

```
cd tmp
cp /usr/share/man/man1/zsh* .
gunzip zsh*.gz
grep -c compinit zsh* 
```

有更优雅的方法可以做到这一点，但这会给你一个 compinit 在每个文件中出现的频率列表：

```
zsh.1:0
zsh4.1:0
zshall.1:0
zshbuiltins.1:0
zshcalsys.1:0
zshcompctl.1:0
zshcompsys.1:29
zshcompwid.1:0
zshcontrib.1:0
zshexpn.1:0
zshmisc.1:0
zshmodules.1:1
zshoptions.1:0
zshparam.1:0
zshroadmap.1:0
zshtcpsys.1:0
zshzftpsys.1:0
zshzle.1:0 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-30T04:03:18.960

你可以使用互联网......所有的手册页都在上面......只需在搜索前加上

```
zsh man 
```

（如果你知道它们在硬盘驱动器上的位置......你也许可以找到它们......我不知道，因为我自己不需要）

# asp.net-mvc - Default.aspx 未在带有 MVC 部分的 ASP.NET 项目中执行

> ID：805285
> 
> 赞同：7
> 
> 时间：2009-04-30T03:54:15.317
> 
> 标签：asp.net-mvc

我的应用程序主要是一个 ASP.NET 应用程序，我正在向它添加一个 MVC 部分。

我的 Default.aspx（无代码隐藏）页面有一个简单的 Response.Redirect 到 StartPage.aspx 页面，但由于某种原因 MVC 正在接管，我没有进入 StartPage.aspx 页面。相反，我被路由到我的第一个也是唯一一个 MVC 部分，这是我在 global.asax.cs 页面（专辑）中注册的注册路由。

有没有办法告诉 MVC 将我的请求留给根“/”作为我的 IIS 7 默认文档......在这种情况下为 Default.aspx？

这就是我的 RegisterRoutes 中的内容：

```
routes.IgnoreRoute("{resource}.axd/{*pathInfo}");
routes.MapRoute("Albums","{controller}/{action}/{id}",
    new { controller = "Albums", action = "Index", id = "" }); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-30T06:07:40.393

如果您从那里的第二条路由中删除默认控制器，它将不再与“/”匹配，并且路由将忽略对“/”的请求，将它们留给通常的 ASP.Net 管道处理

因此，将您的路线更改为：

```
routes.IgnoreRoute("{resource}.axd/{*pathInfo}"); 
routes.MapRoute("Albums","{controller}/{action}/{id}",
     new { action = "Index", id = "" }); 
```

那应该可以解决您的问题！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-02-18T20:52:48.150

default.aspx 页面由 IIS 提供服务，因为它是默认文档。如果 MVC 意识到请求是针对 default.aspx 的（例如“http://foo.com/default.aspx”），则 MVC 会让 default.aspx 页面处理请求。尽管在这种情况下（“http://foo.com”）并没有意识到这一点，因此您可以在默认路由之前添加它以实现您所追求的

```
// ignore "/"    
routes.IgnoreRoute("");

// default route
routes.MapRoute(
                "Default", // Route name
                "{controller}/{action}/{id}", // URL with parameters
                new { controller = "Home", action = "Index", 
                      id = UrlParameter.Optional } // Parameter defaults
            ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-30T06:12:42.800

您可以告诉 MVC 忽略 Default.aspx，如下所示：

```
routes.IgnoreRoute("Default.aspx"); 
```

# emacs - 在正在运行的 Emacs Lisp 程序上设置断点

> ID：805292
> 
> 赞同：2
> 
> 时间：2009-04-30T03:58:17.240
> 
> 标签：emacs, elisp

我从 ubuntu 发行版中提取的 Emacs lisp 包有问题。该软件包是 JDEE，每当我打开文件时，它都会`Args out of range: "63", 0, 4`在迷你缓冲区和缓冲区中抱怨。`*Messages*`此错误似乎已于去年 9 月报告，但尚未采取任何措施。我不是 emacs 新手，我自己编写了一些 Elisp 代码，但我从未尝试过调试这样的东西。当此错误发生时，我想在调试器中停止文件加载，至少可以了解问题的来源。`debug-on-error`我已阅读 Elisp 手册的第 18.1.1 节“在出错时输入调试器”，但在使用、`debug-ignored-errors`和的各种值组合后尝试加载文件`debug-on-signal`似乎没有效果。有人对我的下一步有什么建议吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-30T05:48:42.543

如果错误时调试不起作用，我将从源代码本身开始。找到导致问题的键绑定/事件，并找到函数。

```
C-h k <keystrokes>
M-x find-function <function-name-from-above> 
```

现在，一旦你在源头

```
M-x edebug-defun 
```

并且下次您按下该键时，您应该能够单步执行该程序。此时，您可以查看导致错误的部分 - 并以此方式深入研究。

您也可以尝试设置变量`'stack-trace-on-error`以查看是否可以找到罪魁祸首（虽然`'debug-on-error`通常对我有用，但不知道为什么它不适合您）。

作为最后的手段（如果`edebug-defun`不起作用），您可以通过调用来重新定义例程`(debug)`，有点类似。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-30T06:10:28.733

我想 JDEE 以某种方式抑制了错误调试。也许 grep 通过其文件查找错误消息“Args out of range”。调试时，请确保加载未编译的`.el`文件，而不是字节编译的`.elc`文件（如果您正在运行字节编译的代码，您会在调试器中注意到它），方法是输入类似的命令`(load "foo.el")`而不是`(load "foo")`.

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2011-01-05T10:43:29.840

在我自己的一个脚本中`find-grep`意外重新定义后使用时，我遇到了同样的错误。`(current-time-string)`

使用`M-x edebug-defun`上面发布的提示，当我单步执行代码给出错误看到调用时，我设法找到了问题`(current-time-string)`。

不确定这对您的情况有多大帮助。

# asp.net - 使用 ASP.NET Web 表单通过 querstring 传递值而不在 URL 中显示目标页面

> ID：805297
> 
> 赞同：0
> 
> 时间：2009-04-30T04:02:16.340
> 
> 标签：asp.net, vb.net, url

我有一个用 ASP.NET、VB.NET、.NET 3.5 编写的小型 Web 应用程序

我使用查询字符串将值从 default.aspx 传递给 demo.aspx。单击 Go 按钮时，URL 将如下所示：**localhost/demo.aspx?id=4**

但是我希望当点击 Go 按钮时 URL 是这样的：**localhost/?id=4**并且 id 值被传递给 demo.aspx 以便可以显示预期的结果。如果可能的话，如何在不使用路由技术的情况下完成这项工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-30T04:09:37.040

仅当 Web 服务器将 demo.aspx 视为默认文档时，这才有效。当你加载一个页面时没有说明页面名称（例如你的 localhost/?id=4 示例），Web 服务器将找到一个具有预定义名称的文件并将其用作默认文档。此文件通常称为 default.aspx（或 .asp、.htm、.html、.php 或类似名称）。因此，如果您想加载任何其他页面，您将需要说明名称，或使用 URL 重写技术。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-30T04:17:35.027

1.  将您的 go 按钮修改为链接按钮并设置 herf = "?id=[id]"
2.  使用以下代码修改 Default.aspx 的 Page_Load 事件。

公共Page_Load（对象发送者，EventArg e）{

```
if(!string.IsNullOrEmpty(Request["id"]))
{
   // Using Server.Transfer() function to call Demo.aspx page.
   // Client still see "localhost/?id=[id]" at address bar.
   Server.Transfer("Demo.aspx?id=" + Request["id"]);
} 
```

}

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-30T04:08:36.343

像这样的东西？

```
protected void btnGo_Click (Object sender, EventArgs e)
{
    Response.Redirect("localhost/?" + Request.QueryString);
} 
```

不确定何时更改网址？也不确定路由技术是什么。对不起。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-30T04:16:50.067

如果您希望它与回发一起使用，您仍然需要确保使用默认文档（如 default.aspx）配置 Web 服务器。

在 3.5 sp1 MS 中终于允许我们设置表单的 action 属性。

所以在页面初始化你现在可以显式设置它

```
Form1.Action = "/mydirectory/" 
```

警告：某些版本的 IIS 不允许发布到目录。（例如 XP IIS）

# silverlight - 深度放大动态生成的 3D 图像立方体

> ID：805310
> 
> 赞同：0
> 
> 时间：2009-04-30T04:11:47.643
> 
> 标签：silverlight, deepzoom

我正在使用 kit3D 制作一个 3D 立方体。这个立方体是在运行时生成的。我想知道我是否能够在这个动态生成的 3D 立方体上添加深度缩放。整个立方体最终是一个图像，并且全部加载在一个时间。或者有没有其他方法可以让我获得深度缩放效果？？？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-02T03:50:31.970

在 Silverlight 2 中无法做到这一点，因为我们没有像在 Silverlight 3 中那样考虑大量透视 3D 变换。

在 Silverlight 3 中，您应该能够执行此操作，但请记住，Deep Zoom 在某种程度上是对最终用户 UX 的调整，因此如果处理不当，在 3D 面部中放大和缩小图像集可能会被认为很麻烦。

**Scott Barnes / Rich Platforms 产品经理 / Microsoft。**

# iphone - 用于流式传输 aac 音频的 AudioQueue 缓冲区大小

> ID：805315
> 
> 赞同：2
> 
> 时间：2009-04-30T04:15:38.087
> 
> 标签：iphone, core-audio

我正在从网络流中播放 MP3 音频，使用 WIFI 连接时有时会出现间隙。

我减小了缓冲区大小，但我想知道计算缓冲区大小的最佳方法是什么。

我的 MP3 流是 64 Kbits。

我正在使用 3 个缓冲区，每个缓冲区为 64 *1024。数据包描述是 512

非常感谢

蒂埃里

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-12-14T20:58:54.787

我找到了答案！

对我来说最好的价值观是：

缓冲区数量 3 缓冲区大小 32 * 768 最大数据包描述 4096

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-12-20T11:14:07.377

我想知道你为什么只选择 24576 字节。缓冲区不是那么小吗？

# iphone - 有哪些选项可以通过 iPhone 接受信用卡付款？

> ID：805324
> 
> 赞同：7
> 
> 时间：2009-04-30T04:18:15.460
> 
> 标签：iphone, security, authorization, payment-gateway, credit-card

从 iPhone 应用程序接受信用卡付款的选项有哪些？这将是一个独立的应用程序，而不是 iPhone 特定的网站。我可以与[Authorize.net](http://www.authorize.net/)之类的支付网关集成吗？贝宝或谷歌结账呢？我知道在某些网站上，它会将您带到贝宝网站以获得付款授权 - 这可以通过 http 请求完成，而不是强迫用户访问另一个网站（该应用程序无法使用该网站）？由于您无法安装 SSL 证书，因此来自 iPhone 的这些付款是否存在任何安全问题？

我不想使用 3.0 版本中将提供的 Apple 小额支付，因为会有很多小额费用，我不想每次都给 Apple 30%。

这是否可能，或者我是否需要客户事先在我的网站上创建一个帐户，用他们的信用卡付款，然后让 iPhone 与我的数据库交互以获得他们的可用余额（他们通过网络收取的金额）？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-25T06:22:21.380

我认为30％的报酬很高...

*   无需考虑信用卡欺诈
*   无需考虑安全证书
*   无需考虑停机等服务器问题
*   无需创建漂亮的 UI 和描述如何使用
*   无需信用卡购买，用户只需填写iTunes密码，即可随时随地购买
*   无需花费大量时间进行调试和测试，SDK 非常棒，只要您按照[文档操作就可以了](http://developer.apple.com/iphone/library/documentation/NetworkingInternet/Conceptual/StoreKitGuide/Introduction/Introduction.html)

    而且你总是可以多加 5 美元来支付你想卖的东西的 30%。

    **请记住**，如果您的价格较低，您将拥有更多的买家，并且您可以获得比少数价格较高的买家更多的利润。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-30T05:18:30.230

使用 PayPal 收款真的很容易。这取决于您希望从 PayPal 获得什么样的反馈。有关详细信息，请参阅[PayPal 的开发者网站](https://www.paypal.com/developer)。

**编辑**：我真的应该解释我所说的“反馈”是什么意思。

当用户被发送到 PayPal 站点进行支付时，您​​可以使用一个相当[简单的网络表单](https://cms.paypal.com/us/cgi-bin/?cmd=_render-content&content_ID=developer/howto_html_landing)（是的，一个普通的`<form>...</form>`.）将他发送到那里。如果您只有 1 个产品，那么这个表单甚至可以是静态 HTML。

棘手的部分出现在用户付费之后。

选项 1：手动检查您的 PayPal 帐户以进行付款。如果用户付款，那么你给他发电子邮件，然后发送你想卖给他的任何东西。最简单的方法，最少的代码。缺点是您必须进行大量手动检查，基本上这只是在消耗您的注意力。

选项 2：在您的应用程序中[从 PayPal 获取自动确认。](https://cms.paypal.com/us/cgi-bin/?cmd=_render-content&content_ID=developer/howto_api_paymentspro)要么通过 PayPal 将回传发送到 HTTP 服务器，要么在等待足够的时间让交易完成后主动查询 PayPal 服务器以进行确认。这意味着一旦交易完成，用户就会立即获得反馈。您甚至可以自动将产品发送给他！缺点是这样的解决方案需要**更多**的代码。

哦，每次我说“贝宝”？我刚才提到的所有服务都是由我见过的每个信用卡授权网关提供的。

# curl - 无法在终端快速从我的服务器下载数据

> ID：805329
> 
> 赞同：0
> 
> 时间：2009-04-30T04:22:15.950
> 
> 标签：curl, ssh, download

我跑不成功

```
curl $Masi@host:~/folder
curl: (6) Couldn't resolve host 'host:~' 
```

我有主机的 SSH 密钥。我正在尝试将 curl 与 scp 类似地使用。

**如何使用 curl 快速下载私有数据？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-30T05:02:35.540

我建议阅读 cURL 的[手册页](http://curl.haxx.se/docs/manpage.html)以获取有关如何执行此操作的一些信息。我认为 cURL 不能以`scp`您想要的方式替换。

如果您有一个安全的 FTP (SFTP) 服务器或安全的 HTTP SSL (HTTPS) 服务器，那么 cURL 可以接受 SSH 密钥（尽管使用 SSL 密钥在 Internet 上更普遍接受。）它可以使用这些密钥进行身份验证并建立一个通过服务器向您的用户**公开**的目录的安全连接。

要了解如何传递 SSH 密钥，请参阅[手册页](http://curl.haxx.se/docs/manpage.html)中的`--pubkey`、`--key`和。`--pass`

重要的是要了解您的主目录不必通过这样的服务器可用。即使您使用用户和密码进行身份验证。**`scp`**通过不同的服务器工作，并且（默认情况下）将解释路径，就像您已登录一样。因此，相对路径是相对于您的**home folder**，就像您期望的那样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-30T05:03:11.983

curl 是一个 HTTP 客户端 - 您不能将其用作 SSH 客户端。SCP有什么问题？

# xml - 通过 WCF 与 WebClient 下载图像

> ID：805337
> 
> 赞同：3
> 
> 时间：2009-04-30T04:29:02.703
> 
> 标签：xml, wcf, silverlight, web-services

我正在从 WCF 服务向 Silverlight 客户端获取数据（图像，200-400kb），并注意到每次此类消息到达时 Silverlight 都会停止几分之一秒。这不是很严重，但动画会停止一段时间，整个用户体验都被破坏了。

提问时间：

1）您认为改用 WebClient 是否有益？

2) Silverlight 中的“普通”WCF 客户端（“普通”是指事件驱动的场景）是否在主（调用）线程或后台反序列化数据协定？

3）您认为从 XML 数据合约反序列化二进制对象所需的开销（由于 Base64 XML 编码带来更大的数据大小）比到服务器的额外往返行程更大/更小（在这种情况下，数据合约将只包含指向图像，而不是我可以使用 WebClient 来获取它——因此又是一次旅行）？

4) 是否可以在后台线程（不是 UI 线程）中从 byte[] 数组创建图像？

非常感谢任何帮助、想法和建议。

谢谢，

卡罗尔

PS：我无法使用 DeepZoom，因为业务需求与 DeepZoom 场景并不真正匹配。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-30T16:39:06.537

WCF 的主要目的是提供一种从一个地方到另一个地方获取结构化数据的方法。我不认为图像是它的意思。我认为使用 WebClient 可能会更好更快地工作。此外，您可能还想进一步了解是否有其他解决方案专门用于使用 Silverlight 从服务器下载资源文件。

* * *

更新：实际上，如果您只是使用常规图像控件，您可以将 Source 属性设置（或更改）为新的位图 - 这将自动触发从服务器位置下载图像：

```
img.Source = new BitmapImage(new Uri("http://the.image.url/image.jpg")); 
```

然后，您可以以编程方式将 Image 控件添加到您的 Silverlight 文档中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T17:02:05.287

您也可以只在返回图像的服务器端使用 HTTP 处理程序类。我假设您选择使用 WCF 服务，因为服务器端有一些逻辑可以确定应该返回哪个图像。使用 HTTP 处理程序，您可以选择在服务器端执行该逻辑并在一次往返中返回图像。

让处理程序调用您的 WCF 服务以获取 URL、检索图像并将其返回到 HTTP 响应流中。如果您正确设置 MIME 类型，客户端（在本例中为 Silverlight）将不会知道其中的区别。

# javascript - 如何使用 JavaScript 进行数字格式化？

> ID：805340
> 
> 赞同：1
> 
> 时间：2009-04-30T04:29:23.030
> 
> 标签：javascript, regex, formatting, numbers, isnumeric

我想使用 JavaScript 将文本框上的输入限制为货币数字格式。例如：

```
<input type="text" value="2,500.00" name="rate" /> 
```

如上所述，文本框应该只接受数字、逗号和句点。

但是，在句号之后，它应该接受数字后的两位数。

我该如何做到这一点？请澄清。

*   格纳尼亚尔祖拜尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-30T04:43:21.313

[parseFloat](https://developer.mozilla.org/En/Core_JavaScript_1.5_Reference/Global_Functions/ParseFloat)可以将字符串转换为浮点数，[toFixed](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/Number/toFixed)可以设置保留多少小数位。

```
function numToCurrency(num){
    return parseFloat(num).toFixed(2);
}

numToCurrency("4.2334546") // returns 4.23 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-30T04:30:41.453

如果要对文本框进行验证，可以使用[正则表达式](http://www.evolt.org/article/Regular_Expressions_in_JavaScript/17/36435/)。如果您想限制用户的输入，您可以捕获击键并使用文本框的[onKeyDown](http://www.w3schools.com/jsref/jsref_onkeydown.asp)事件过滤掉您希望他们输入的击键。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-30T04:37:11.733

这些 jQuery 插件可以帮助..

[http://www.texotela.co.uk/code/jquery/numeric/](http://www.texotela.co.uk/code/jquery/numeric/)

[http://plugins.jquery.com/project/aphanumeric](http://plugins.jquery.com/project/aphanumeric)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-30T04:52:26.160

你可以使用一个名为[Alphanumeric的](http://itgroup.com.ph/alphanumeric/)[jQuery插件](http://jqueryui.com/home)

> jQuery AlphaNumeric 是一个 javascript 控件插件，允许您限制用户可以在文本框或文本区域上输入的字符。玩得开心。

# c - 在 linux 上使用 ncurses 时未定义的引用

> ID：805343
> 
> 赞同：11
> 
> 时间：2009-04-30T04:32:04.740
> 
> 标签：c, linux, ncurses

我正在尝试开始在 Linux 上使用 ncurses 开发程序。我什至无法编译 Hello World 示例。这是代码：

```
#include <curses.h>

int main()
{         
        initscr();
        printw("Hello, world.");
        refresh();
        getch();
        endwin();
        return 0;
} 
```

当我尝试编译时，我得到：

```
hello.c:(.text+0x12): undefined reference to `initscr' 
```

对于每一个被调用的函数。

我通过 apt-get 安装了 ncurses，也通过下载源代码和编译、安装等方式安装了 ncurses。

我都试过`#include`了`curses.h`和`ncurses.h`。

到底是怎么回事？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-30T04:36:07.947

您`-lcurses`在链接时是否使用了该选项？

包含头文件可以让代码编译（因为编译器从文件中知道函数调用的样子`.h`），但链接器需要库文件来找到实际代码以链接到您的程序中。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-04-30T04:40:41.880

正如 Greg Hewgill 所说，您需要传入`-lcurses`或`-lncurses`链接到 curses 库。

```
gcc -o hello hello.c -lncurses 
```

您也可能意味着使用`initscr()`and `getch()`。一旦我进行了这些替换，上面的内容就会为我编译。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-03-28T01:11:08.117

我遇到了类似的问题，并找到了一个对我有帮助的解决方案，但与此处发布的其他答案略有不同。我试图将面板库与 curses 一起使用，我的编译命令是：

```
$ gcc -o hello hello.c -lncurses -lpanel 
```

当我阅读其他答案时，我感到很困惑，因为我*包含*了 -lncurses 标志，但它仍然没有编译，并且与您得到的错误类似：

```
$ gcc -o hello hello.c -lncurses -lpanel
/usr/lib/gcc/i686-linux-gnu/4.7/../../../../lib/libpanel.a(p_new.o): In function `new_panel':
p_new.c:(.text+0x18): undefined reference to `_nc_panelhook' 
```

我终于在[tldp](http://www.tldp.org/HOWTO/NCURSES-Programming-HOWTO/panels.html)中找到了答案：

> “要使用面板库函数，您必须包含 panel.h 并将程序与面板库链接，标志 -lpanel 应与 -lncurses 一起按该顺序添加。”

因此，使用编译标志时，顺序似乎很重要！我尝试切换顺序：

```
gcc -o hello hello.c -lpanel -lncurses 
```

这使它能够成功编译。我知道你已经有了答案，所以我希望这对某人有所帮助。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-06-19T07:09:19.843

对于任何有类似问题的人： -lx 参数，其中 x 是您的库，应始终遵循源文件和目标文件。

# ipc - RE：Posix 和 System V IPC

> ID：805345
> 
> 赞同：2
> 
> 时间：2009-04-30T04:34:04.377
> 
> 标签：ipc, posix, message-queue, shared-memory, semaphore

1.  消息队列、共享内存和信号量中哪个 IPC 最容易转换为网络 IPC，哪个最难。

2.  将 System V 共享内存转换为网络 IPC 或将 Posix 共享内存转换为网络 IPC 会更容易吗

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T20:04:17.047

1.  到目前为止，我会说消息队列是基于您在消息队列上执行的操作与套接字操作的映射几乎相同。
2.  可能同样困难，我建议您在 shm 之上实现一些对网络更友好的抽象......例如消息队列。即使有一些支持网络的实现，共享内存也不太适合网络，但我遇到的确实是泄漏的抽象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T20:15:32.747

正如亨利克·古斯塔夫森所说：

1.  消息队列是迄今为止最容易转换为网络的 IPC 机制。信号量不是为传送数据而设计的，共享内存通常需要信号量控制的访问（或等效机制）才能在单台机器上提供适当的控制，更不用说跨网络了。也就是说，System V 消息队列可能是最不广泛使用的 IPC 机制。

2.  任何共享内存机制的转换几乎同样困难。需要注意的关键点是，实际上您很少使用“仅共享内存”；还有其他正在使用的同步工具。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T20:17:42.600

(1)。最简单的是消息队列，最难的是共享内存。

我认为这是因为消息队列只需要一个指向消息队列数据结构的指针，因为共享内存需要将共享内存附加到两个进程的进程地址空间，并且当两个进程位于不同的机器上时分配共享内存很困难。

(2)。将 Posix 共享内存转换为网络 IPC 比 System V 共享内存更容易。

我认为这是因为 Posix 支持基于内存和命名信号量，并且不需要内核干预，而 System V 需要操作系统干预。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T20:21:05.197

1.  信号量并不是真正的通信机制，它们用于同步。共享内存可以通过网络使用（[分布式共享内存](http://en.wikipedia.org/wiki/Distributed_shared_memory)），但这很难实现。消息队列很容易，因为它们直接映射到网络套接字。

2.  这可能是非常相似的困难；这两个 API 是相似的，它们只是有不同的接口。

# design-patterns - 将一个对象暂时隐藏在另一个不透明对象中的设计模式是否有标准名称？

> ID：805349
> 
> 赞同：0
> 
> 时间：2009-04-30T04:37:11.280
> 
> 标签：design-patterns

我有一种特殊的集合（在面向对象的编程语言中），它提供了大量的持久性服务，但也被其他组件查询。有时我有需要存储在存储库中的对象，但我希望在其他服务准备好之前将其类型从其他服务中屏蔽掉（例如，批准、完成或你有什么）。我通过将目标对象封装在不透明的“容器”类中来解决这个问题。

作为一个具体的类比，您可能会考虑文件系统中的目录之类的东西。假设文件系统包含用于相册查看器的各种照片。可能有一些照片尚未准备好发布，但您希望由文件系统管理。可以通过更改扩展名（即，.jpg.temp 而不是 .jpg）或将它们隐藏在不透明的容器对象中（即，将其存储在 zip 中或压缩它）从相册中隐藏它们，同时仍然拍摄容器的优势和其他工具查询所有 .jpg.temp 文件的能力。

我只是在寻找可能描述这种情况的标准术语。Facade 和 Proxy 似乎与一般实现相匹配，但与意图不符。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-30T13:51:58.717

伊戈尔是对的——绝对是一个代理人。

它介于“保护代理”和“虚拟代理”之间。

您正在为尚未完全就绪的对象创建一个替身，控制对它的访问。

当请求任何操作时，真正的虚拟代理将创建底层资源。

保护代理控制可以访问底层对象的内容。

我想说您正在做的事情更接近保护代理，但保护代理通常意味着授权/身份验证。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-30T05:06:54.393

我认为这是一个代理。它不是外观，外观旨在为现有接口提供不同的接口（通常是简化的）。在您的情况下，界面保持不变，至少我是这样理解您的描述的（也许某种伪代码示例有助于使其更清晰）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-30T04:52:39.637

我认为[状态模式](http://en.wikipedia.org/wiki/State_pattern)可能是我所知道的最接近的。

# iphone - 有多少开发者可以使用一个 iPhone 开发者密钥？

> ID：805353
> 
> 赞同：8
> 
> 时间：2009-04-30T04:39:18.063
> 
> 标签：iphone, iphone-developer-program

我正在寻找创建一个 iPhone 应用程序并将注册[iPhone Developer Program](http://developer.apple.com/iphone/program/apply.html)。但是，我不清楚如果我参加标准计划可以拥有多少开发人员。它说企业计划适用于拥有超过 500 名开发人员的公司，所以如果我与 2-3 名其他开发人员一起工作，标准计划可以工作吗？这是否意味着我们创建并放入应用商店的所有应用程序都将具有相同的公司信息？让每个开发人员能够在自己的 iPhone 上进行测试需要什么？它只是必须输入的许可证密钥吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-30T06:14:16.150

1.  两个或三个开发人员可以轻松共享一个开发人员证书，只需将其复制到每台开发机器上。标准程序应该适合您的目的。
2.  您在 iTunes 上销售的所有应用程序都将列在一个公司或个人名称下。如果您不希望这样做，则需要开设多个计划帐户。
3.  要在硬件上进行测试，必须使用开发人员证书和将应用程序与设备关联的配置文件（通过它的 UDID 编号）对代码进行签名。

代码签名的重点是它标识了应用程序的来源，因此如果您愿意为他们生产的任何东西承担责任，您可以自由地让员工/合作伙伴共享证书。

此外，Apple 对开发（工作时进行测试）和分发（提交到商店）使用单独的证书，因此共享开发证书不会使您的“店面”面临风险。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-11-29T16:21:15.883

如果您注册为公司，您可以拥有多个开发人员。你有三个选择：

1.  只需向您的州办事员申请“经商身份”

2.  将您的公司注册为 LLC，流程因州而异，请联系您的职员

3.  合并您的公司，这是最昂贵的选择，并且会产生税收影响

    接下来以该公司名称申请标准计划。请记住，这是您的应用程序发布时使用的名称。

您需要将公司证明邮寄给 Apple。您的公司需要一些时间才能获得批准，Apple 付费进行背景调查以确保公司实际上是有效的。

一旦您获得批准，您需要您的其他开发人员申请证书，这里是来自苹果的链接与该过程：（需要登录） [https://developer.apple.com/ios/manage/certificates/team/howto.action](https://developer.apple.com/ios/manage/certificates/team/howto.action)

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-04-30T04:44:57.097

比这要复杂得多，您需要为每个开发人员和设备从 Apple 获得唯一的证书（购买许可证后即可完成）。无论如何，底线是 1 个许可证 = 1 个开发人员 + X 设备。因此，您可以注册多个设备，购买不超过一个开发人员，因此标准许可证将非常适合您的需求。因此，您的选择是每个开发人员一个许可证，或者进入企业版（可能比几个单一许可证便宜），或者您可能有一个复杂的构建设置，其中单个机器/帐户在设备上执行所有构建和更新二进制文件。

# php - 运行 2 个 ajax 进程的 AJAX (prototype/php) 挂起，直到第一个完成

> ID：805354
> 
> 赞同：0
> 
> 时间：2009-04-30T04:39:24.473
> 
> 标签：php, javascript, ajax, prototypejs

这个问题是我上一个问题的后续问题：[Previous Questions](https://stackoverflow.com/questions/800997/ajax-prototype-php-getting-partial-status-updates-during-script-execution)。

所以我设置我的页面来启动一个 ajax 调用来启动处理一些记录。在每条记录之后，它会更新另一个表中的一行以跟踪此过程的状态。在进行第一次 ajax 调用之后，我又启动了一次。它是一个 Ajax.PeriodicalUpdater，它被设置为访问一个文件，该文件只查询数据库中的该行并返回原始进程的状态。

所以这工作得很好......只要提供状态更新的文件在我当前的应用程序之外。如果我将文件放在我的应用程序中，那么它就不能正常工作。如果我看萤火虫，PeriodicUpdater 调用在原始 ajax 调用完成之前不会得到任何返回，它只是挂起，所以就好像文件被挂起并且没有返回任何东西。

整个应用程序仅在我们正在使用的基本框架中运行。没什么疯狂的，只是处理路由和基本模板方面等......所以所有这些函数/文件都在这个应用程序中，所有这些 ajax 调用都通过这个路由。

什么可能导致这样的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-30T04:44:59.250

这可能是由于浏览器支持到特定域的[并发连接的限制吗？](http://www.openajax.org/runtime/wiki/The_Two_HTTP_Connection_Limit_Issue)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-01T03:00:26.413

这是由 PHP 会话序列化引起的。会话数据被锁定，直到每个请求的 PHP 进程完成写入，因此同一会话中的其他请求将排队，直到锁被释放。

如果您的 AJAX 请求需要访问会话状态，请读出您需要的信息，然后`session_write_close()`在代码中尽早使用以释放这些锁。

# c++ - 学习图形布局算法

> ID：805356
> 
> 赞同：7
> 
> 时间：2009-04-30T04:39:47.140
> 
> 标签：c++, python, layout, graphics, visualization

在我的日常工作中，我倾向于遇到想要以自定义方式可视化的数据。例如，自动创建类似于 UML 序列图的调用图、显示有向图或可视化数据库中的数据（散点图​​、3D 轮廓等）。

对于图表，我倾向于使用 GraphViz。对于类似 UML 的绘图和 3D 绘图，我想编写自己的软件以在 Linux 下运行。

我通常用 C++ 编程，用 Python 做原型。

人们用什么书来学习这些基本的图形算法？我已经看到了一些关于强制导向布局和基于切割和打包问题的各种块式布局算法的不错的帖子——这些都是很好的开始，但在我开始之前，我想要更多的初学者指南和概述。

*   [有向图布局](https://stackoverflow.com/questions/552854/how-to-use-a-bgl-directed-graph-as-an-undirected-one-for-use-in-layout-algorithm)
*   [强制定向布局](https://stackoverflow.com/questions/713701/force-directed-layout-in-c)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-30T05:22:13.093

这里有一些来源，

*   [图形布局和设计（平装本）](https://rads.stackoverflow.com/amzn/click/com/0827313748)。
*   [主动布局引擎：可变数据打印中的算法和应用](http://www.hpl.hp.com/techreports/2005/HPL-2005-6R1.pdf)

# shell - 为什么在 zsh 中使用 {1..9} 会出现此错误？

> ID：805361
> 
> 赞同：9
> 
> 时间：2009-04-30T04:42:02.003
> 
> 标签：shell, zsh, expansion

我运行以下代码

```
zgrep -c compinit /usr/share/man/man{1..9}/zsh* 
```

我明白了

```
zsh: no matches found: /usr/share/man/man2/zsh* 
```

这很奇怪，因为以下工作

```
echo Masi{1..9}/masi 
```

这表明我的问题可能是 Zsh 中的错误。

**以上是 {1..9} 的 Zsh 中的错误吗？**

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-30T04:49:46.040

这不是一个错误，它在文字内部运行良好。您在这里遇到的麻烦`{1..9}`是不是像`*`is 这样的通配符表达式；正如您的 echo 示例所示，这是一个迭代扩展。因此，您的 zgrep 示例与您在命令行中键入每个备用版本完全相同，然后由于 man2 中没有以 zsh 开头的手册页，因此会出错。（它在找不到匹配项时出错，而不是与您的大括号序列扩展本质上相关的任何内容。）

另一方面，如果你这样做了：

```
zgrep -c compinit /usr/share/man/man[1-9]/zsh* 
```

你会得到你期望的结果，因为`[1-9]`它是一个普通的通配符表达式。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2014-08-09T22:54:50.110

在 zsh 中，如果你想在文件名中使用范围，zle 提供`<1-n>`了它可以扩展的任何真实名称。也就是说：

```
$ touch a0b a1b a5b a7b
$ print a<0-100>b 
```

`<Tab>`然后在决赛后立即击球`b`会让你`print a0b a1b a5b a7b`扩大就行。

对于所有其他意图和目的——也许是全方位的要求、非文件和脚本使用——我会使用相当简洁的惯用 zsh 循环来表达这一点：

```
for n ({1..50}); do print $n; done 
```

将允许您处理数字 1 到 50 的整个序列范围 :) 之后您可以做各种有用的事情，例如尚不存在的文件集合：

```
arr=($(for n ({1..50}); do print /my/path/file$n.txt; done)) && print $arr[33] 
```

# sqlite - 如何重命名 SQLite 数据库表中的列？

> ID：805363
> 
> 赞同：315
> 
> 时间：2009-04-30T04:43:45.010
> 
> 标签：sqlite, alter-table

我需要重命名 SQLite 数据库中某些表中的一些列。我知道之前在stackoverflow上也有人问过[类似的问题](https://stackoverflow.com/questions/174582/how-do-i-rename-a-column-in-a-database-table-using-sql)，但一般是针对SQL的，没有提到SQLite的情况。

从[ALTER TABLE](http://www.sqlite.org/lang_altertable.html)的 SQLite 文档中，我了解到不可能“轻松”地做这样的事情（即单个 ALTER TABLE 语句）。

我想知道有人知道用 SQLite 做这种事情的通用 SQL 方式。

* * *

## 回答 #1

> 赞同：464
> 
> 时间：2009-04-30T05:57:11.667

假设您有一个表，需要将“colb”重命名为“col_b”：

首先你重命名旧表：

```
ALTER TABLE orig_table_name RENAME TO tmp_table_name; 
```

然后基于旧表创建新表，但使用更新的列名：

```
CREATE TABLE orig_table_name (
  col_a INT
, col_b INT
); 
```

然后从原始表中复制内容。

```
INSERT INTO orig_table_name(col_a, col_b)
SELECT col_a, colb
FROM tmp_table_name; 
```

最后，删除旧表。

```
DROP TABLE tmp_table_name; 
```

将所有这些包装在一个`BEGIN TRANSACTION;`and`COMMIT;`中也可能是一个好主意。

* * *

## 回答 #2

> 赞同：93
> 
> 时间：2018-09-15T15:36:57.613

这刚刚在[2018-09-15 (3.25.0)中修复](https://www.sqlite.org/changes.html)

> 增强`ALTER TABLE`命令：
> 
> *   添加对使用`ALTER TABLE`table重命名表中的列的支持`RENAME COLUMN oldname TO newname`。
> *   修复表重命名功能，以便它还更新触发器和视图中对重命名表的引用。

您可以在下面找到记录的新语法[`ALTER TABLE`](https://www.sqlite.org/lang_altertable.html)

> 该`RENAME COLUMN TO`语法将表 table-name 的 column-name 更改为 new-column-name。列名在表定义本身以及引用该列的所有索引、触发器和视图中都发生了更改。如果列名更改会导致触发器或视图中的语义模糊，则`RENAME COLUMN`失败并出现错误并且不会应用任何更改。

[![在此处输入图像描述](https://i.stack.imgur.com/0P4ZG.gif)](https://i.stack.imgur.com/0P4ZG.gif) ^(图片来源：[https ://www.sqlite.org/images/syntax/alter-table-stmt.gif](https://www.sqlite.org/images/syntax/alter-table-stmt.gif))

例子：

```
CREATE TABLE tab AS SELECT 1 AS c;

SELECT * FROM tab;

ALTER TABLE tab RENAME COLUMN c to c_new;

SELECT * FROM tab; 
```

**[db-fiddle.com 演示](https://www.db-fiddle.com/f/9ib5bLvYykAUsktNA2LsEn/0)**

* * *

### 安卓支持

在撰写本文时，**[Android 的 API 27 使用 SQLite 包版本 3.19](https://developer.android.com/reference/android/database/sqlite/package-summary)。**

基于 Android 正在使用的当前版本以及此更新将在 SQLite 版本 3.25.0 中提供，我会说您需要等待（大约 API 33）才能将对此的支持添加到 Android。

而且，即便如此，如果您需要支持任何早于 API 33 的版本，您将无法使用它。

* * *

## 回答 #3

> 赞同：60
> 
> 时间：2009-04-30T05:17:40.000

[挖掘了一下，我发现了这个名为DB Browser for SQLite](http://sqlitebrowser.org/)的多平台（Linux | Mac | Windows）图形工具，它实际上允许以一种非常用户友好的方式重命名列！

编辑 | 修改表 | 选择表 | 编辑字段。点击点击！瞧！

但是，如果有人想分享一种编程方式，我很高兴知道！

* * *

## 回答 #4

> 赞同：55
> 
> 时间：2011-07-13T18:52:47.490

虽然确实没有 ALTER COLUMN，但如果您只想重命名列、删除 NOT NULL 约束或更改数据类型，则可以使用以下命令集：

*注意：这些命令可能会损坏您的数据库，因此请确保您有备份*

```
PRAGMA writable_schema = 1;
UPDATE SQLITE_MASTER SET SQL = 'CREATE TABLE BOOKS ( title TEXT NOT NULL, publication_date TEXT)' WHERE NAME = 'BOOKS';
PRAGMA writable_schema = 0; 
```

您将需要关闭并重新打开连接或清理数据库以将更改重新加载到架构中。

例如：

```
Y:\> sqlite3 booktest  
SQLite version 3.7.4  
Enter ".help" for instructions  
Enter SQL statements terminated with a ";"  
sqlite> create table BOOKS ( title TEXT NOT NULL, publication_date TEXT NOT NULL);  
sqlite> insert into BOOKS VALUES ("NULLTEST",null);  
Error: BOOKS.publication_date may not be NULL  
sqlite> PRAGMA writable_schema = 1; 
sqlite> UPDATE SQLITE_MASTER SET SQL = 'CREATE TABLE BOOKS ( title TEXT NOT NULL, publication_date TEXT)' WHERE NAME = 'BOOKS';  
sqlite> PRAGMA writable_schema = 0;  
sqlite> .q  

Y:\> sqlite3 booktest  
SQLite version 3.7.4  
Enter ".help" for instructions  
Enter SQL statements terminated with a ";"  
sqlite> insert into BOOKS VALUES ("NULLTEST",null);  
sqlite> .q 
```

**参考文献如下：**

* * *

[pragma writable_schema](http://www.sqlite.org/pragma.html#pragma_writable_schema)
当这个 pragma 开启时，可以使用普通的 UPDATE、INSERT 和 DELETE 语句更改数据库所在的 SQLITE_MASTER 表。警告：滥用此编译指示很容易导致数据库文件损坏。

[alter table](http://www.sqlite.org/lang_altertable.html)
SQLite 支持有限的 ALTER TABLE 子集。SQLite 中的 ALTER TABLE 命令允许用户重命名表或向现有表添加新列。无法重命名列、删除列或在表中添加或删除约束。

![更改表语法](https://i.stack.imgur.com/y3xIP.png)

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2011-10-17T02:13:01.420

最近我不得不在 SQLite3 中使用一个名为**points**的表来执行此操作，该表的列**id, lon, lat**。错误地，当导入表时，纬度值存储在**lon**列中，反之亦然，因此一个明显的解决方法是重命名这些列。所以诀窍是：

```
create table points_tmp as select id, lon as lat, lat as lon from points;
drop table points;
alter table points_tmp rename to points; 
```

我希望这对你有用！

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2019-05-22T15:54:56.673

**案例 1：SQLite 3.25.0+**

只有 SQLite 3.25.0 版支持重命名列。如果你的设备满足这个要求，事情就很简单了。以下查询将解决您的问题：

```
ALTER TABLE "MyTable" RENAME COLUMN "OldColumn" TO "NewColumn"; 
```

**案例 2：SQLite 旧版本**

您必须遵循不同的方法才能获得可能有点棘手的结果

例如，如果您有这样的表：

```
CREATE TABLE student(Name TEXT, Department TEXT, Location TEXT) 
```

如果您想更改列的名称`Location`

**步骤 1：**重命名原始表：

```
ALTER TABLE student RENAME TO student_temp; 
```

**第 2 步：**现在创建一个`student`具有正确列名的新表：

```
CREATE TABLE student(Name TEXT, Department TEXT, Address TEXT) 
```

**第三步：**将原表中的数据复制到新表中：

```
INSERT INTO student(Name, Department, Address) SELECT Name, Department, Location FROM student_temp; 
```

注意：上面的命令应该是一行。

**第 4 步：**删除原始表：

```
DROP TABLE student_temp; 
```

通过这四个步骤，您可以手动更改任何 SQLite 表。请记住，您还需要在新表上重新创建任何索引、查看器或触发器。

* * *

## 回答 #7

> 赞同：14
> 
> 时间：2009-04-30T04:54:39.210

引用[sqlite 文档](http://www.sqlite.org/lang_altertable.html)：

> SQLite 支持有限的 ALTER TABLE 子集。SQLite 中的 ALTER TABLE 命令允许用户重命名表或向现有表添加新列。**无法重命名列、删除列或在表中添加或删除约束。**

当然，您可以做的是，使用新布局创建一个新表`SELECT * FROM old_table`，并用您将收到的值填充新表。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2014-05-02T21:31:32.103

*首先，这是让我大吃一惊的事情之一：重命名列需要创建一个全新的表并将数据从旧表复制到新表......*

我用来执行 SQLite 操作的 GUI 是[Base](http://menial.co.uk/base/)。它有一个漂亮的日志窗口，显示所有已执行的命令。通过 Base 重命名列会使用必要的命令填充日志窗口：

![基本日志窗口](https://i.stack.imgur.com/fVVWs.png)

然后可以轻松地将这些复制并粘贴到您可能需要它们的地方。对我来说，这是一个[ActiveAndroid](https://github.com/pardom/ActiveAndroid)迁移文件。一个很好的感觉是，复制的数据只包括 SQLite 命令，而不包括时间戳等。

希望这可以节省一些人的时间。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2015-06-24T07:50:48.677

### 将表列 <id> 更改为 <_id>

```
 String LastId = "id";

    database.execSQL("ALTER TABLE " + PhraseContract.TABLE_NAME + " RENAME TO " + PhraseContract.TABLE_NAME + "old");
    database.execSQL("CREATE TABLE " + PhraseContract.TABLE_NAME
    +"("
            + PhraseContract.COLUMN_ID + " INTEGER PRIMARY KEY,"
            + PhraseContract.COLUMN_PHRASE + " text ,"
            + PhraseContract.COLUMN_ORDER  + " text ,"
            + PhraseContract.COLUMN_FROM_A_LANG + " text"
    +")"
    );
    database.execSQL("INSERT INTO " +
            PhraseContract.TABLE_NAME + "("+ PhraseContract.COLUMN_ID +" , "+ PhraseContract.COLUMN_PHRASE + " , "+ PhraseContract.COLUMN_ORDER +" , "+ PhraseContract.COLUMN_FROM_A_LANG +")" +
            " SELECT " + LastId +" , "+ PhraseContract.COLUMN_PHRASE + " , "+ PhraseContract.COLUMN_ORDER +" , "+ PhraseContract.COLUMN_FROM_A_LANG +
            " FROM " + PhraseContract.TABLE_NAME + "old");
    database.execSQL("DROP TABLE " + PhraseContract.TABLE_NAME + "old"); 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2016-08-02T07:16:29.937

使用所需的列名称创建一个新列：COLNew。

```
ALTER TABLE {tableName} ADD COLUMN COLNew {type}; 
```

将旧列 COLOld 的内容复制到新列 COLNew。

```
INSERT INTO {tableName} (COLNew) SELECT {COLOld} FROM {tableName} 
```

注意：上面一行需要括号。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2013-04-06T21:20:53.323

如前所述，有一个工具 SQLite Database Browser 可以执行此操作。Lyckily，这个工具会记录用户或应用程序执行的所有操作。这样做一次并查看应用程序日志，您将看到所涉及的代码。根据需要复制查询并粘贴。为我工作。希望这可以帮助

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2018-01-14T16:26:10.447

[来自官方文档](https://www.sqlite.org/lang_altertable.html)

**对于不以任何方式影响磁盘内容的某些更改，可以选择使用**更简单和更快的过程。**以下更简单的过程适用于删除 CHECK 或 FOREIGN KEY 或 NOT NULL 约束、**重命名列**或添加、删除或更改列的默认值。**

 **1.  开始交易。

2.  运行 PRAGMA schema_version 以确定当前模式版本号。下面的第 6 步将需要此编号。

3.  使用 PRAGMA writable_schema=ON 激活模式编辑。

4.  运行 UPDATE 语句更改 sqlite_master 表中表 X 的定义： UPDATE sqlite_master SET sql=... WHERE type='table' AND name='X';

    注意：如果更改包含语法错误，则像这样对 sqlite_master 表进行更改将导致数据库损坏且不可读。建议在将 UPDATE 语句用于包含重要数据的数据库之前，对单独的空白数据库进行仔细测试。

5.  如果对表 X 的更改也影响其他表或索引或触发器是模式中的视图，则运行 UPDATE 语句来修改那些其他表的索引和视图。例如，如果列的名称发生更改，则必须修改引用该列的所有 FOREIGN KEY 约束、触发器、索引和视图。

    警告：再一次，如果更改包含错误，则像这样对 sqlite_master 表进行更改将导致数据库损坏且不可读。在将整个过程用于包含重要数据的数据库和/或在运行此过程之前制作重要数据库的备份副本之前，请在单独的测试数据库上仔细测试整个过程。

6.  使用 PRAGMA schema_version=X 增加模式版本号，其中 X 比上面步骤 2 中找到的旧模式版本号大一。

7.  使用 PRAGMA writable_schema=OFF 禁用模式编辑。

8.  （可选）运行 PRAGMA integrity_check 以验证架构更改没有损坏数据库。

9.  提交在上述第 1 步开始的事务。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2016-10-20T23:03:08.443

一个选择，如果您需要在紧要关头完成它，并且如果您的初始列是使用默认值创建的，则创建您想要的新列，将内容复制到它，然后基本上“放弃”旧列（它保留存在，但您只是不使用/更新它等）

前任：

```
alter table TABLE_NAME ADD COLUMN new_column_name TYPE NOT NULL DEFAULT '';
update TABLE_NAME set new_column_name = old_column_name;
update TABLE_NAME set old_column_name = ''; -- abandon old column, basically 
```

这会留下一列（如果它是用 NOT NULL 创建但没有默认值，那么将来忽略它的插入可能会失败），但如果它只是一个一次性表，则权衡可能是可以接受的。否则，请使用此处提到的其他答案之一，或使用允许重命名列的其他数据库。

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2019-04-05T10:28:43.257

由于版本 2018-09-15 (3.25.0) sqlite 支持重命名列

[https://sqlite.org/changes.html](https://sqlite.org/changes.html)

* * *

## 回答 #15

> 赞同：-3
> 
> 时间：2015-03-04T17:34:43.967

sqlite3 yourdb .dump > /tmp/db.txt
edit /tmp/db.txt 在 Create line
sqlite2 yourdb2 < /tmp/db.txt
mv/move yourdb2 yourdb中更改列名

# zsh - 无法为手册获取系统变量工作

> ID：805370
> 
> 赞同：0
> 
> 时间：2009-04-30T04:52:08.810
> 
> 标签：zsh, manuals, system-variable

我在 .zshrc 中有以下系统变量

```
manuals='/usr/share/man/man<1-9>' 
```

我跑不成功

```
zgrep -c compinit $manuals/zsh* 
```

我明白了

```
zsh: no matches found: /usr/share/man/man<1-9>/zsh* 
```

该命令应与以下有效的命令相同

```
zgrep -c compinit /usr/share/man/man<1-9>/zsh* 
```

**如何在 Zsh 中使用系统变量运行上述命令？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-30T05:26:13.347

尝试：

```
$> manuals=/usr/share/man/man<0-9>
$> zgrep -c compinit ${~manuals}/zsh* 
```

'~' 告诉 zsh`<0-9>`在使用变量时执行扩展。zsh 参考卡告诉您如何执行此操作以及更多内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-30T05:25:42.677

根据我的调查，看起来 zsh 在`<>`替换*之前* `$`执行了替换。这意味着当您使用`$`变体时，它首先尝试`<>`替换（那里什么都没有），然后`$`替换（有效），剩下的就是包含`<>`字符的字符串。

当你不使用`$manuals`时，它首先尝试`<>`替换并且它有效。这是一个顺序问题。下面的最终版本显示了如何推迟扩展，以便它们同时发生：

这些可以在这里看到：

```
> manuals='/usr/share/man/man<1-9>'

> echo $manuals
  /usr/share/man/man<1-9>

> echo /usr/share/man/man<1-9>
  /usr/share/man/man1 /usr/share/man/man2 /usr/share/man/man3
  /usr/share/man/man4 /usr/share/man/man5 /usr/share/man/man6
  /usr/share/man/man7 /usr/share/man/man8

> echo $~manuals
  /usr/share/man/man1 /usr/share/man/man2 /usr/share/man/man3
  /usr/share/man/man4 /usr/share/man/man5 /usr/share/man/man6
  /usr/share/man/man7 /usr/share/man/man8 
```

# c# - 变量的值未保留在类的方法中

> ID：805373
> 
> 赞同：1
> 
> 时间：2009-04-30T04:53:18.747
> 
> 标签：c#, asp.net

在使用 C# 的 ASP>Net 中，我将一个变量声明为该类的成员，如下所示：

```
public class sales: System.Web.UI.Page
{
string type=null;
} 
```

我的 UI 中有一个图像按钮，我为它定义了一个名为的事件

```
protected void ImageButton2_Click(object sender, ImageClickEventArgs e) 
```

在这种方法中，分配给变量'type'的任何值（通过类的任何其他方法）都不会保留，并且尽管我已经在类内的某处为'type'分配了一些值，但只检索了null值......

我无法访问分配的值可能是什么问题？？？？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-30T04:57:53.150

您必须在回发之间保留数据。

我建议你阅读这些文章：

*   [ASP.NET 页面生命周期概述](http://msdn.microsoft.com/en-us/library/ms178472.aspx)
*   [了解 ASP.NET 视图状态](http://msdn.microsoft.com/en-us/library/ms972976.aspx)
*   [在 ASP.NET 应用程序中管理持久用户状态的九个选项](http://msdn.microsoft.com/en-us/magazine/cc300437.aspx)
*   [ASP.NET 状态管理建议](http://msdn.microsoft.com/en-us/library/z1hkazw7.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-30T04:59:57.793

这可能是渲染管道的结果。请记住，即使您的事件被触发，页面和所有变量也会使用其默认值重新创建。将其创建为至少具有支持视图状态存储的属性。

```
public String Type 
{
    get { return ViewState["Type"].ToString(); } 
    set { ViewState["Type"] = value; } 
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-30T05:01:47.277

每次向页面发出请求时，变量都会重新初始化，无论它是否是回发。

尝试将变量放在属性而不是字段中（就像您正在做的那样）并在第一次加载页面时初始化属性，前提是不是回发。

您应该执行以下操作：

```
 //on the On_Load page's event
  if (!IsPostback)
    Type = null;    

  private string Type { get; set; } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-30T05:02:32.657

如果您在对象中分配值，然后使用按钮进行回发，则除非您将该对象的实例存储在会话、视图状态或其他内容中，否则该值将消失。

```
string sType = "something";
Session["YourSessionTagHere"] = sType; 
```

一旦回发发生，您就可以取出对象并从您的 onclick 事件中访问该值。

```
string sType = (string)(Session["YourSessionTagHere"]); 
```

听起来您没有访问同一个对象并且您的对象正在丢失，因为在每次回发后您的字符串都是新的。

您还可以通过设置一个在 get 和 set 中为您执行会话内容的属性来使其更清晰。

# iphone - 使用静态库打包 Bundle

> ID：805378
> 
> 赞同：8
> 
> 时间：2009-04-30T04:55:59.630
> 
> 标签：iphone, cocoa-touch, xcode, xib, xcodebuild

我有一个包含一些 xib 的静态库。这些在项目中基本上是相同的。我想将 xibs 作为库的一部分。我可以包含他们的 veiwcontrollers，在调用项目中引用这些控制器，但是没有要加载的 xib。当我右键单击库项目中的 xib 时，它不能成为目标的一部分。

我想过创建一个 CFPluginBundle ，但这会创建一个新项目。我会放弃我所有的 IBOutlet 和 IBAction 引用。重用对特定控制器也有出口和操作的 xib 的最佳方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2011-01-31T20:50:53.977

这里有更多关于它的讨论：[你能从 iPhone 上的静态库中引用 Xib 文件吗？](https://stackoverflow.com/questions/707429/can-you-reference-xib-files-from-static-libraries-on-the-iphone)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-12-22T13:43:19.657

当我想将我的项目导出为库供其他开发人员使用时，我遇到了同样的问题。我找到了我观点的完美解决方案，它似乎也会回答你的观点。

有一个 xcode 插件可让您将项目构建为包含资源的库。

[https://github.com/kstenerud/iOS-Universal-Framework](https://github.com/kstenerud/iOS-Universal-Framework)

我不知道构建这个插件的人，但它就像一个魅力

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-30T05:53:52.517

我不确定您所说的“将 xibs 作为库的一部分”是什么意思，因为静态库没有资源——但它们也不是独立发布的，所以它们不需要。如果您只想将代码重用于自己的项目，则可以将 xibs 保留在您保留静态库的任何位置，并且只需将 xibs 包含在使用该库的任何项目中。

如果你走 CFPluginBundle 路线，你可以在现有项目中创建新的捆绑目标；模板没有什么神奇之处，它们只是负责制作虚拟文件并打开正确的构建设置。您可以将它们复制到现有项目中的新目标中，它会正常工作。也就是说，我不确定丢失 IBOutlet 和 IBAction 引用是什么意思，因为该信息是 xib 的一部分（以及您在 xib 中使用的类），而不是项目。

# tsql - TSQL 获取下一行数据？

> ID：805383
> 
> 赞同：0
> 
> 时间：2009-04-30T04:57:53.510
> 
> 标签：tsql

通常我们使用 TSQL TOP 来获取第一行数据，如下所示：

```
SELECT TOP 10 * FROM myTable; 
```

我不确定是否有任何方法可以获得下一个 10 和下一个 10，......直到最后，只是一些分页。我想不通。可能是 CTE 语句？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-30T05:00:04.363

这是在 SQL Server 2005 中使用 row_number() 的解决方案：

[使用 SQL Server 2005 数据库分页记录 - ROW_NUMBER 函数](http://www.davidhayden.com/blog/dave/archive/2005/12/30/2652.aspx)

...这是我用来找到它的谷歌搜索：

[row_number() 超过分页](http://www.google.com/search?q=row_number%28%29+over+paging)

# jquery - 如何应用 jQuery 动态加载的内联和/或外部 CSS

> ID：805384
> 
> 赞同：43
> 
> 时间：2009-04-30T04:59:07.173
> 
> 标签：jquery, css, ajax

我有一个使用 jQuery 加载到 Yahoo 弹出窗口中的 Ajax 控件。

我只是使用一个简单的 .get 请求来加载 HTML。

```
 $.get(contentUrl, null, function(response) {
         $('#dialog').find('.bd').assertOne().html(response);
     }, "waitDlg"); 
```

现在的问题是加载的内容需要它自己的 CSS，它实际上是动态创建的。我可以选择内联或使用外部 CSS 样式表。

在 Chrome 中的测试表明，通过 AJAX 加载的 CSS 在使用上述代码添加到 DOM 时没有被评估/应用。

Internet Explorer*会*在内联 CSS 卡在 DOM 中时评估它，但 Chrome 不会。由于完全不相关的问题，我目前无法在 FireFox 中进行测试。

jQuery 中是否有任何方法可以评估动态添加到 DOM 的样式表作为内联或？

我想这样做的原因有很多：

*   弹出窗口中的 CSS 属于弹出窗口，可能完全来自不同的环境
*   它是动态的，我不想把它放在父页面中，除非我绝对必须
*   我计划让它像这样工作，但它没有！:-(

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2009-04-30T05:07:48.477

给定样式表的路径（或*一些*会生成有效 CSS 的 URL）：

```
var myStylesLocation = "myStyles.css"; 
```

...其中任何一个都应该起作用：

### 使用 AJAX 加载

```
$.get(myStylesLocation, function(css)
{
   $('<style type="text/css"></style>')
      .html(css)
      .appendTo("head");
}); 
```

### 使用动态创建的 <link> 加载

```
$('<link rel="stylesheet" type="text/css" href="'+myStylesLocation+'" >')
   .appendTo("head"); 
```

### 使用动态创建的 <style> 加载

```
$('<style type="text/css"></style>')
    .html('@import url("' + myStylesLocation + '")')
    .appendTo("head"); 
```

或者

```
$('<style type="text/css">@import url("' + myStylesLocation + '")</style>')
    .appendTo("head"); 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2011-01-21T03:05:09.673

接受的答案在 IE 7 中不起作用（在 IE 8 中也有问题）。以下将在 IE 以及 FF 和 chrome/safari 中工作：

```
var url = 'urlOfStyleSheet.css'
if(document.createStyleSheet) {
    try { document.createStyleSheet(url); } catch (e) { }
}
else {
    var css;
    css         = document.createElement('link');
    css.rel     = 'stylesheet';
    css.type    = 'text/css';
    css.media   = "all";
    css.href    = url;
    document.getElementsByTagName("head")[0].appendChild(css);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-08-31T01:30:30.053

```
var cssPath = "/path/to/css/";

var linkStr = document.createElement("&lt;link rel='stylesheet' type='text/css' href='"+cssPath+"' media='screen' /&gt;");

document.getElementsByTagName("head")[0].appendChild(linkStr); 
```

# wordpress - 我应该将博客添加到网站还是使用博客服务？

> ID：805388
> 
> 赞同：2
> 
> 时间：2009-04-30T05:00:26.670
> 
> 标签：wordpress, blogs

我一直在向网站添加很多博客，我想知道是在网站上添加博客软件还是使用外部博客服务更好。我能想到将博客添加到站点的主要原因是，如果您想稍后对其进行自定义（除了外观），例如与站点进行更多集成。如果我把它放在网站上，我可能会使用我熟悉的 WordPress。

一种方法或另一种方法有什么主要优势吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-30T05:05:47.470

我会把博客放在你的网站上。这将有助于解决许多问题：

1.  透明度：您的用户会感觉好像他们在同一个网站上，因为他们实际上是。您的博客将成为您网站的简单扩展。另一方面，博客服务很可能看起来好像您要去一个完全不同的网站。

2.  集成：您可以将您网站上的所有内容与您的博客集成。这包括任何现有的用户群或未来的用户群。此外，您博客的外观可以与您的网站完美匹配，这比使用博客服务要好得多。

3.  自定义：您可以 100% 控制博客的每一项功能。如果您想要一些新的疯狂功能，您可以对其进行编程。博客服务通常比这更封闭。

缺点是您必须维护它，并且您想要的任何功能都必须自己添加。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-30T05:38:52.413

在您的网站上拥有博客的优点之一是所有内容都将属于您的网站，这对搜索引擎有好处，因为它将通过 SERP 提高您的网站知名度。但是您需要付出代价：安装和维护。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-30T05:23:43.603

它没有被切割和干燥：

（假设这是针对客户的）您是否与客户保持持续关系并安排升级时间？大多数博客软件至少需要不时进行一些升级或安全补丁。

您是否依赖这些博客的某种社交媒体网络效应？如果是这样，您可能会从托管产品中获得更好的收益，因为它们经常在其网络中推广相关网站（例如，Wordpress 具有“可能相关的帖子”功能）。

正如布赖恩所说，如果您网站的其他区域依赖登录，那么集成可能会成为问题。在这种情况下，最好自己托管。

# python - 在 Django 的 ORM 中访问存储过程的最佳方法是什么

> ID：805393
> 
> 赞同：34
> 
> 时间：2009-04-30T05:03:05.993
> 
> 标签：python, sql, django, stored-procedures, django-models

我正在设计一个相当复杂的数据库，并且知道我的一些查询将远远超出 Django 的 ORM 的范围。有没有人成功地将 SP 与 Django 的 ORM 集成？如果是这样，什么 RDBMS 以及您是如何做到的？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-05-04T13:36:05.337

我们（musicpictures.com / eviscape.com）写了那个 django 片段，但它不是整个故事（实际上那个代码当时只在 Oracle 上测试过）。

当您想要重用经过验证的 SP 代码或一个 SP 调用将比对数据库的多次调用更快 - 或安全性要求对数据库进行适度访问 - 或查询非常复杂/多步骤时，存储过程是有意义的。我们对 Oracle 和 Postgres 数据库使用混合模型/SP 方法。

诀窍是让它易于使用并保持“django”之类的。我们使用 make_instance 函数获取游标的结果并创建从游标填充的模型的实例。这很好，因为游标可能会返回其他字段。然后你可以在你的代码/模板中使用这些实例，就像普通的 django 模型对象一样。

```
def make_instance(instance, values):
    '''
    Copied from eviscape.com

    generates an instance for dict data coming from an sp

    expects:
        instance - empty instance of the model to generate
        values -   dictionary from a stored procedure with keys that are named like the
                   model's attributes
    use like:
        evis = InstanceGenerator(Evis(), evis_dict_from_SP)

    >>> make_instance(Evis(), {'evi_id': '007', 'evi_subject': 'J. Bond, Architect'})
    <Evis: J. Bond, Architect>

    '''
    attributes = filter(lambda x: not x.startswith('_'), instance.__dict__.keys())

    for a in attributes:
        try:
            # field names from oracle sp are UPPER CASE
            # we want to put PIC_ID in pic_id etc.
            setattr(instance, a, values[a.upper()])
            del values[a.upper()]
        except:
            pass

    #add any values that are not in the model as well
    for v in values.keys():
        setattr(instance, v, values[v])
        #print 'setting %s to %s' % (v, values[v])

    return instance 
```

# 像这样使用它：

```
pictures = [make_instance(Pictures(), item) for item in picture_dict] 
```

# 这里有一些辅助函数：

```
def call_an_sp(self, var):
    cursor = connection.cursor()
    cursor.callproc("fn_sp_name", (var,))
    return self.fn_generic(cursor)

def fn_generic(self, cursor):
    msg = cursor.fetchone()[0]
    cursor.execute('FETCH ALL IN "%s"' % msg)
    thing = create_dict_from_cursor(cursor)
    cursor.close()
    return thing

def create_dict_from_cursor(cursor):
    rows = cursor.fetchall()
    # DEBUG settings (used to) affect what gets returned. 
    if DEBUG:
        desc = [item[0] for item in cursor.cursor.description]
    else:
        desc = [item[0] for item in cursor.description]
    return [dict(zip(desc, item)) for item in rows] 
```

干杯，西蒙。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-04-30T05:16:28.333

您必须在 Django 中使用连接实用程序：

```
from django.db import connection

with connection.cursor() as cursor:
    cursor.execute("SQL STATEMENT CAN BE ANYTHING")
    data = cursor.fetchone() 
```

如果您期望不止一行，请使用`cursor.fetchall()`获取它们的列表。

更多信息在这里：[http ://docs.djangoproject.com/en/dev/topics/db/sql/](http://docs.djangoproject.com/en/dev/topics/db/sql/)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-30T10:25:37.653

不。

严重地。

将存储过程逻辑移动到它所属的模型中。

将一些代码放在 Django 中，将一些代码放在数据库中是维护的噩梦。我在 IT 行业 30 多年的时间里花了太多时间试图清理这种烂摊子。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2015-06-25T08:27:15.387

有一个很好的例子： [https ://djangosnippets.org/snippets/118/](https://djangosnippets.org/snippets/118/)

```
from django.db import connection

cursor = connection.cursor()
ret = cursor.callproc("MY_UTIL.LOG_MESSAGE", (control_in, message_in))# calls PROCEDURE named LOG_MESSAGE which resides in MY_UTIL Package
cursor.close() 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-30T05:25:06.953

如果您想查看使用 SP 的实际运行项目，请查看[minibooks](https://secure.caktusgroup.com/projects/minibooks/wiki)。大量自定义 SQL 并使用 Postgres pl/pgsql for SP。我认为他们最终会删除 SP（[trac ticket 92](https://secure.caktusgroup.com/projects/minibooks/ticket/92)中的理由）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-09-09T10:44:45.060

我想 Django 1.2 中改进的原始 sql 查询集支持可以使这更容易，因为您不必滚动自己的 make_instance 类型代码。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-11-13T12:45:49.320

可以使用 Cx_Oracle。此外，当我们无法访问生产部署的代码并且需要对数据库进行重大更改时，它也很有帮助。

```
import cx_Oracle
try:
    db = dev_plng_con
    con = cx_Oracle.connect(db)
    cur = con.cursor()
    P_ERROR = str(error)
    cur.callproc('NAME_OF_PACKAGE.PROCEDURENAME', [P_ERROR])

except Exception as error:
    error_logger.error(message) 
```

# visual-studio - 调试有时很慢

> ID：805397
> 
> 赞同：12
> 
> 时间：2009-04-30T05:04:58.280
> 
> 标签：visual-studio, debugging

我在普通的中型解决方案中使用 VS2008。

有时，调试步骤变得非常缓慢。每个“步骤”（F10/F11）的每个文件选项卡上都会呈现一个挂锁，并且每个步骤最多可能需要两秒钟。这使得调试非常烦人和缓慢。有没有人看到这个问题？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2010-02-11T00:54:09.243

我在 VS 2008 中注意到，如果您在调试工具栏中选择了“显示源中的线程”按钮，则步进可能至少慢 10 倍。

我还注意到，如果您的应用程序需要很长时间才能在调试模式下启动，则只需在“调试”菜单下“删除所有断点”即可解决此问题。即使当时我只设置了几个断点，这也为我解决了一个烦人的问题。

赛拉斯

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-04-30T05:10:22.933

尝试关闭调试器选项中的“启用属性评估...”设置，它应该会使调试更快（阅读更多：[修复：使用 Visual Studio 更快地调试](https://blogs.msdn.microsoft.com/visualstudioalm/2015/03/03/make-debugging-faster-with-visual-studio/)）：

[![替代文字](https://i.stack.imgur.com/ekl5Z.jpg)](https://i.stack.imgur.com/ekl5Z.jpg)
[（来源：[flickr.com](https://static.flickr.com/3631/3331142536_8404dc3fe6.jpg)）]

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2011-08-24T08:18:01.637

在 Visual Studio 的源代码中禁用显示线程。并关闭调用堆栈跟踪窗口。

![禁用在源代码中显示线程。 按下调试按钮后](https://i.stack.imgur.com/FMkU3.png)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-01-06T12:52:29.693

除了上面提到的所有问题。

“反汇编”选项卡（在后台打开）会使调试速度减慢 1-2 秒。（不确定它是否总是这样发生）。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-04-03T10:08:22.777

我遇到了同样的问题，尤其是在调试具有多线程的应用程序时。

这是由“在源代码中显示线程”功能引起的。

有关详细信息，请参阅以下链接：

[代码项目：在源代码中显示线程](http://www.codeproject.com/Tips/430134/Show-Threads-in-Source)

[Visual Studio 单步性能修复](http://randomascii.wordpress.com/2013/03/03/visual-studio-single-step-performance-fixes/)

禁用此功能后，问题已得到修复。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-12-14T05:34:32.510

有很多事情会导致 Visual Studio 变慢。过多的断点和在源代码中显示线程可能是最常见的两个，但您不关心最常见的是什么，您关心的是什么让 Visual Studio*对**您*慢。

因此，如果删除断点并关闭 Show Threads in Source 不起作用，那么您需要分析 Visual Studio。这使您可以发现您的情况所特有的性能问题。可以在此处找到有关如何执行此操作的说明（解决了两个单独的 Visual Studio 性能问题）：

[http://randomascii.wordpress.com/2013/03/03/visual-studio-single-step-performance-fixes/](http://randomascii.wordpress.com/2013/03/03/visual-studio-single-step-performance-fixes/)

对其他人代码中性能问题的更多调查在此处详述：

[http://randomascii.wordpress.com/category/investigative-reporting/](http://randomascii.wordpress.com/category/investigative-reporting/)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-03-16T01:43:02.010

接受的答案几乎没有相关性或帮助！

以下是一些可能导致调试非常缓慢的问题：

*   “在源代码中显示线程”（参见屏幕截图）。如果您有一个多线程应用程序，您将无法在启用此选项的情况下进行调试。这个选项的作用是，如果它们也执行相同的代码，它会尝试显示在其他线程的相同文件执行位置。因此，如果您有许多线程，调试器需要检查它们所在的所有线程。如果你有很多线程，这可能会使调试器的每一步都非常慢。 [![在此处输入图像描述](https://i.stack.imgur.com/wg5pc.png)](https://i.stack.imgur.com/wg5pc.png)
*   许多条件断点甚至常规断点。特别是如果这些在某些头文件的某些内联函数中。
*   在调用堆栈中启用“显示外部代码”也会使其变慢。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-04-05T21:39:18.867

如果启用，则禁用“显示源中的线程”，如果并行堆栈线程、任务和 GPU 线程窗口打开，则关闭它们。这些导致调试器遍历进程中每个线程的调用堆栈。

[![在此处输入图像描述](https://i.stack.imgur.com/ZwwH8.jpg)](https://i.stack.imgur.com/ZwwH8.jpg)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-30T05:13:30.070

是的，Visual Studio 有时调试速度非常慢。您可以采取许多额外的步骤（除了关闭“启用属性评估”设置）来加快进程。本质上，它需要大量的 RAM，因此执行一些操作来释放它会有所帮助。

1.  进入 Visual Studio 的首选项。查找与动画菜单等相关的所有选项。这些有时会变得很密集，虽然不是专门针对调试的，因为您通常不会打开菜单，但它似乎确实有帮助。

2.  在计算机本身上，如果您右键单击我的计算机。转到高级选项卡并在性能下。如果您调整计算机以获得最佳性能，它将加快速度。它摆脱了您计算机上的任何漂亮样式，但它会释放您想要的一些内存。

3.  关闭所有不必要的程序。您可以为 Visual Studio 提供的内存越多，它的表现就越好。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-28T19:29:27.947

这是 Mike Stahl 的 MSDN 博客上关于解决调试器减速[的一些指导的链接](http://blogs.msdn.com/jmstall/archive/2006/10/23/debugger_5F00_slowdown.aspx)

我遇到了这个问题，因为我的应用程序热点中的条件断点杀死了我的调试性能。个人 BKM：在你晚上离开之前解决潜在的性能问题，因为你可能在早上不记得它们。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-04-16T02:01:32.163

单步缓慢的另一个原因是使用了 Intellitrace（仅在 Ultimate 中可用）。要关闭它，工具 | 选项 | 智能跟踪。取消选中启用 IntelliTrace。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-05-22T13:01:46.403

“在源代码中显示线程”建议没有帮助。

但我通过启用工具：选项：调试：常规 - >“要求源文件与原始版本完全匹配”来修复它。

我的最初是未选中的，但在更改它之后，在 VS2008 中逐步执行代码现在恢复正常速度。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-05-05T17:12:26.420

帮助我的是禁用诊断工具。

工具/选项/调试/常规/启用诊断工具

Visual Studio 2015（版本 14）

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2016-10-12T00:33:56.360

我在启用“.NET Framework 源单步执行”后遇到了这个问题。关闭此功能后，步进速度更快。特别是，重新启用“仅启用我的代码”（选项 > 调试 > 常规）消除了我遇到的大约一半的延迟。

另一半是由于加载了比我需要的更多的符号（选项>调试>符号）。有一次我需要定义符号位置，但我不再需要了，所以我可以取消选中它们并单击“空符号缓存”。如果您列出了 _NT_SYMBOL_PATH，则表示您已定义此环境设置，并且 Visual Studio 不会让您取消选中它。您需要删除该设置。有关符号设置的更多信息 ( [https://blogs.msdn.microsoft.com/visualstudioalm/2015/01/05/understanding-symbol-files-and-visual-studios-symbol-settings/](https://blogs.msdn.microsoft.com/visualstudioalm/2015/01/05/understanding-symbol-files-and-visual-studios-symbol-settings/) )

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2016-12-20T20:15:14.170

我有同样的问题，我删除了我所有的变量手表，它有很大帮助！因为调试过程中的每一步，它都会重新加载所有的手表，并且需要时间......

解决方案：从 Debug 菜单中选择 Windows，然后选择 Watch，然后单击 Watch1、Watch2、Watch3 或 Watch4。将出现菜单并右键单击它们以清除它们。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2017-02-22T09:21:12.733

如果您有病毒扫描程序（启用了实时扫描），请检查`C:\Program Files (x86)\Microsoft Visual Studio 14.0\Common7\IDE\Remote Debugger\x64\msvsmon.exe`* 是否从扫描中*排除。*

就我而言，在全公司范围内推出新的病毒扫描程序后，调试变得非常缓慢。过了一会儿，我们发现msvsmon.exe的实时扫描是罪魁祸首。

*根据您的安装文件夹修改路径

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2016-04-02T00:55:09.123

清除监视窗口中的所有条目。

# c++ - C++中std::cin对象的规则是什么？

> ID：805403
> 
> 赞同：1
> 
> 时间：2009-04-30T05:07:24.343
> 
> 标签：c++, iostream, cin, getline

我正在编写一个供我个人使用的小程序来练习学习 C++ 及其功能，它是一个 MLA 引文生成器（我正在写一篇有数十次引文的大型论文）。

由于缺乏更好的方法（我不了解类或在您的 main 中使用其他 .cpp 文件，所以不要费心告诉我，当我有更多时间时，我会继续努力），我正在写每种引用类型的函数。如果我有更多时间，我可能会将其分解为每个重用代码的函数。

我的问题是：std::cin 对象是如何工作的？我目前正在使用 std::cin >> 读取我希望是单个单词的字符串，并使用 getline(std::cin, string) 读取带有空格的字符串。不过，我没有得到正确的输出。我只想知道 std::cin 是如何工作的，以及为什么我总是意外地跳过一些输入（例如，它跳过了 webPage 而不是让我有机会输入它）。

```
void webCit() {
    std::cout << "Leave any unknowns blank.\n";

    std::cout << "Author last name: ";
    std::string lastName;
    std::cin >> lastName;

    if (lastName.size() != 0) {
        lastName = lastName + ", ";
    }

    std::cout << "Author first name: ";
    std::string firstName;
    std::cin >> firstName;

    if (firstName.size() != 0) {
        firstName = firstName + ". ";
    }

    std::cout << "Article title: ";
    std::string articleTitle;
    getline(std::cin, articleTitle);

    if (articleTitle.size() != 0) {
        articleTitle = "\"" + articleTitle + ".\" ";
    }

    std::cout << "Title of web page: ";
    std::string pageTitle;
    std::cin >> pageTitle;

    if (pageTitle.size() != 0) {
        pageTitle = pageTitle + ". ";
    }

    std::cout << "Publication date: ";
    std::string publicationDate;
    getline(std::cin, publicationDate);

    if (publicationDate.size() != 0) {
        publicationDate = publicationDate + ". ";

    }

    std::cout << "Web address: ";
    std::string webAddress;
    getline(std::cin, webAddress);

    webAddress = "<" + webAddress + ">. ";

    std::cout << "Date accessed: ";
    std::string dateAccessed;
    getline(std::cin, dateAccessed);

    if (dateAccessed.size() != 0) {
        dateAccessed = dateAccessed + ". ";
    }

    std::string citation =
        lastName + firstName + articleTitle + pageTitle + publicationDate + webAddress + dateAccessed;

    std::cout << citation; //TEST; remove after
} 
```

编辑：I/O

```
Leave any unknowns blank.
Author last name: Hooked
Author first name: Jerbear
Article title: Title of web page: title
Publication date: Web address: www.win.com
Date accessed: 4/29/09
Hooked, Jerbear. Title. <www.win.com>. 4/29/09\. 
```

如您所见，出了点问题，因为我的输入被跳过了。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-30T05:48:27.303

这里发生的是`std::cin >> firstName;`只读取*但不包括*第一个空格字符，`'\n'`当你按下回车时，它包括换行符（或），所以当它到达时`getline(std::cin, articleTitle);`，`'\n'`仍然是 中的下一个字符`std::cin`，并`getline()`立即返回。

```
// cin = "Bloggs\nJoe\nMan of Steel, Woman of Kleenex\n"
std::cin >> lastName;
std::cin >> firstName;
// firstName = "Joe", lastName = "Bloggs", cin = "\nMan of Steel, Woman of Kleenex\n"
getline(std::cin, articleTitle);
// articleTitle = "", cin = "Man of Steel, Woman of Kleenex\n" 
```

在调用 getline() 之前添加 ' `std::cin >> std::ws`' （`ws`意味着`w`速度快）可以解决问题：`s`

```
std::cin >> firstName >> std::ws;
getline(std::cin, articleTitle); 
```

但是如果你在论证中这样做，更容易看出你错过了哪里：

```
std::cin >> firstName;
getline(std::cin >> std::ws, articleTitle); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-30T05:41:23.390

当您使用`>>`运算符时，`cin`会向上读取直到下一个空格字符，但它不会处理空格。所以当你有

```
std::cin >> str1;
std::getline(std::cin, str2); 
```

第二个调用将只处理换行符，您将没有机会输入任何输入。

相反，如果您打算在`getline`之后使用`operator >>`，您可以在调用`std::cin.ignore()`之前调用吃换行符`getline`。

编辑：当你这样做时，它会像你预期的那样工作

```
std::cin >> str1;
std::cin >> str2; 
```

因为第二次调用将忽略所有前导空格。

# php - PHP 构造函数在可以提供嵌套变量的参数之前执行

> ID：805404
> 
> 赞同：-1
> 
> 时间：2009-04-30T05:07:26.887
> 
> 标签：php, oop, class, constructor

首先，这里有一个小片段代码来帮助解释我的问题：

```
<?php
class foo {

    public $title;

    __construct{

        echo "<html>\n";
        echo "<head>\n";
        echo "<title>".$this->title."</title>\n";
        echo "</head>\n";
        echo "<body>\n";

    }

    /**
    *
    * I get $title from index.php
    *
    */
    public function setTitle( $title )
    {

        $this->title = $title;

    }

    __destruct{

        echo "</body>\n";
        echo "</html>\n";

    }

}
?> 
```

您可能已经注意到，这段代码将产生一个 well, 的标题。是的，那里有一块空地。**:-)**

对我来说，这实际上很有意义（即使我没有预料到），因为类构造函数是在创建 foo 对象时执行的，这意味着它不会等待 index.php 提供`setTitle()`in的参数turn 返回填充的字符串`$this->title`。

因此，如果我真正了解这里发生了什么，我能做些什么来解决这个问题？我是否应该使用内置缓冲区函数缓冲输出，然后使用提供的标题字符串修改存储的输出？有任何想法吗？

我真的，真的，真的，想保留这个结构，其中构造函数和析构函数包含这个重复的代码。不必在任何地方调用这些函数，这很好。我知道一些开发人员可能会考虑这种不好的做法，但无论如何我都会这样做，因为我想这样做，因为我认为它很酷。所以我并不是真的在寻找这方面的建议，除非你非常有动力告诉我我的愚蠢。

因此，如果您有任何建议/想法/知识与我分享，那就太好了。

谢谢，请慢慢来，因为我想我将被迫留在里面躲避已经来到我城市的邪恶猪流感，所以不要着急！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-30T07:23:50.460

新手。听我说。我在这里打的这些词。假装我在说他们，听听从我嘴里说出来的话。不*，不，不，不，**不**！* 不，我不认为你认为它有多“酷”。

这是那些不幸的情况之一，其中列出关于这种方法的“正确”事情比“错误”事情要短。也就是说，你的问题*很多。* 话虽如此，我将*只*讨论这个想法的一些不好的地方。

首先，让我们笼统地讨论 OOP。你在这里所做的是我最不喜欢看到的事情：我称之为“类编程”。也就是说，由于使用了类关键字，因此以 OOP 为幌子进行结构化编程。如果您要这样做，请不要打扰。只需使用函数。这是简单明了的阶级滥用。

类是对象蓝图。对象适合于封装和*实例化*。除非你真的是[单例模式](http://en.wikipedia.org/wiki/Singleton_pattern)的粉丝，否则为什么要创建一个明确设计为只实例化一次的类呢？在你说“但是彼得，单例模式可以帮助我们！！！1one”之前，请尝试理解它实际上[并不是那么好](http://misko.hevery.com/2008/08/17/singletons-are-pathological-liars/)。此外，你在这里所做的甚至不是人们首先转向单例模式的原因。

其次是子类的话题。也许在将来的某个时候，您会希望您的网站有一些弹出页面。或者您会想要不仅仅是 CSS 驱动的仅打印版本。也许您甚至会想要一些根本不是 HTML 的东西，比如 RSS 提要。现在怎么办？为了使这些新的页面类型正常工作，您需要在此构造函数中进行多少*其他工作？*但是，如果您已经开始依赖子类来创建单独的页面怎么办？现在你完蛋了。当然，您可以返回并连接[装饰器模式](http://en.wikipedia.org/wiki/Decorator_pattern)，但是当这个问题可以通过非愚蠢的类设计一开始就避免时，为什么还要进行所有这些工作呢？

第三，首先是呼应HTML的想法。我可以在这里使用一两个词的回声，那里的一三个标签。但是对于大的 HTML 块，这只是白痴。有礼貌地转义到输出模式并使用未锁定在字符串中的 HTML。不仅更易于编辑和阅读，如果您愿意，您还可以在 WYSIWYG 中实际使用它。

第四，这严重、*严重*地破坏了[SRP](http://en.wikipedia.org/wiki/Single_responsibility_principle)。

第五——这种荒谬的设计会导致你在这里试图解决的那种问题。只有您不想知道解决方案是从构造函数中删除 echo 语句。有办法解决吗？当然。事实上，还有不止一个。我推荐他们中的任何一个吗？不，不是。

最后，让我们讨论一下标题。也许你还没有了解它们。也许你有并且不在乎。但是，从现在起 6 个月后，如果您正在处理一个问题，并且您正在处理一个在堆栈深处有 10 次调用的方法，并且您意识到一个简单的`header()`函数将解决您的问题，将会发生什么。也许您需要调整缓存控制或者您需要手动设置响应代码 - 无论如何。但你猜怎么着，你不能。为什么？因为你愚蠢的构造函数会在它创建的毫秒数内向浏览器输出。

所以，回顾一下：***不！***[除非您的实际最终目标是在The Daily WTF](http://www.thedailywtf.com/) 上看到您的一些手工艺品。

除了告诫我还能提供什么？也许是新方向的一部分？好吧，在构建良好的系统中调试输出已经够难的了，所以不要一开始就在暗中自责。系统的所有输出都应该是*明确*的。如果你想创建一个“页面”类型的类，那很好。只是不要那样做*。*

```
class foo
{
    protected $title;
    protected $headers;

    public function setTitle( $title )
    {
        $this->title = $title;
    }

    public function addHeader( $header )
    {
        $this->headers[] = $header;
    }

    public function sendHeaders()
    {
        foreach ( $this->headers as $header )
        {
            header( $header );
        }
    }

    public function printPageHeader()
    {
        $this->sendHeaders();
        ?>
            <html>
                <head>
                    <title><?php echo $this->title; ?></title>
                </head>
                <body>
        <?php
    }

    public function printPageFooter()
    {
        ?>
                </body>
            </html>
        <?php
    }

    public function printPage()
    {
        $this->printPageHeader();
        $this->printPageFooter();
    }
}

$p = new foo;
$p->setTitle( 'Just Testing' );
$p->addHeader( 'Cache-control: no-cache' );
$p->printPage(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-30T05:11:34.130

您可以在析构函数中进行所有打印。那里所有的变量都是已知的。但是（就像你自己说的那样）我认为这真的是非常糟糕的做法。我建议使用某种视图/模板文件（无论如何你有足够的时间:)）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-30T05:13:14.220

您可以在构造函数中将标题作为参数传递吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-30T05:54:19.630

> `schnalle:`这是不好的做法。这太疯狂了。
> `the_noob:`疯狂……？
> `the_noob:` *（*大喊）这……是……小框架建筑！
> `the_noob:` *（很好地分离了代码和表示）*

我并没有真正得到你想要做什么，而只是将标题作为参数传递给构造函数......

```
<?php

class Title {
    public function __construct($title) {

        echo '<html><head><title>' . htmlspecialchars($title) . '</title></head><body>';
    }

    public function __destruct() {
        echo '</body></html>';
    }
}

?> 
```

如果你真的想让你的对象打印一些东西，我建议使用神奇的 __tostring() 方法，这样你就可以简单地使用`echo`你的对象。但对于 html 标签......仍然没有用。

我希望你的框架好运，但你要么是天才*（不太可能）*，要么是每个初学者都会犯的同样错误（几乎）的人（在 MVC 到来之前）。

> **编辑：**我帮不了你。您希望在创建对象时直接输出，但需要在创建对象之前将数据获取到对象中。所以你试图解决一些丑陋的事情，让它变得更丑陋。它只是不那样工作！
> 你试图通过将轮子安装到活驴上来制造一种新的、更好的汽车，然后抱怨因为它没有按你预期的那样工作（轮子上的驴！哇哦！），现在你问社区如何以使驴/汽车跑得更快的方式安装尾灯。

# iphone - 如何在此线程中间更新 UI？

> ID：805410
> 
> 赞同：3
> 
> 时间：2009-04-30T05:11:07.487
> 
> 标签：iphone, objective-c, cocoa-touch

下面是在与我的应用程序主线程不同的线程中运行的代码块。如何在每个按钮获取缩略图后更新 UI？现在它不会更新，直到整个方法完成。按钮已添加到 UIScrollView。

（LotsGridButton 只是一个带有一些额外属性的 UIButton。）

```
- (void)fetchThumbnails {
    CCServer* server = [[CCServer alloc] init];
    for (int i=0; i<[buttons count]; i++) {
        LotsGridButton* button = [buttons objectAtIndex:i];     
        if (button.lot.thumbnail) continue;
        // load the thumbnail image from the server
        button.lot.thumbnail = [server imageWithPath:button.lot.thumbnailURL];
        [button setImage:button.lot.thumbnail forState:UIControlStateNormal];
    }
    [server release];
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-30T05:58:07.373

代替`setImage:forState:`，看一下`performSelectorOnMainThread:`方法，例如：

```
[myButton performSelectorOnMainThread:@selector(setThumbnail:) withObject:[server imageWithPath:myButton.lot.thumbnailURL] waitUntilDone:NO]; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-30T05:56:57.393

我没有使用 iPhone 的经验，但在 Cocoa 中，你应该只从主线程更新 UI。

在不同的线程中，您可以使用 NSObject 在主线程中执行代码：

```
performSelectorOnMainThread:withObject:waitUntilDone: 
```

# c# - ReaderWriterLockSlim 扩展方法性能

> ID：805412
> 
> 赞同：10
> 
> 时间：2009-04-30T05:12:07.297
> 
> 标签：c#, performance, multithreading, extension-methods, locking

我一直在玩集合和线程，并遇到了人们创建的漂亮扩展方法，这些方法通过允许 IDisposable 模式来简化 ReaderWriterLockSlim 的使用。

但是，我相信我已经意识到实现中的某些东西是性能杀手。我意识到扩展方法不应该真正影响性能，所以我假设实现中的某些东西是原因......创建/收集的 Disposable 结构的数量？

下面是一些测试代码：

```
using System;
using System.Collections.Generic;
using System.Threading;
using System.Diagnostics;

namespace LockPlay {

    static class RWLSExtension {
        struct Disposable : IDisposable {
            readonly Action _action;
            public Disposable(Action action) {
                _action = action;
            }
            public void Dispose() {
                _action();
            }
        } // end struct
        public static IDisposable ReadLock(this ReaderWriterLockSlim rwls) {
            rwls.EnterReadLock();
            return new Disposable(rwls.ExitReadLock);
        }
        public static IDisposable UpgradableReadLock(this ReaderWriterLockSlim rwls) {
            rwls.EnterUpgradeableReadLock();
            return new Disposable(rwls.ExitUpgradeableReadLock);
        }
        public static IDisposable WriteLock(this ReaderWriterLockSlim rwls) {
            rwls.EnterWriteLock();
            return new Disposable(rwls.ExitWriteLock);
        }
    } // end class

    class Program {

        class MonitorList<T> : List<T>, IList<T> {
            object _syncLock = new object();
            public MonitorList(IEnumerable<T> collection) : base(collection) { }
            T IList<T>.this[int index] {
                get {
                    lock(_syncLock)
                        return base[index];
                }
                set {
                    lock(_syncLock)
                        base[index] = value;
                }
            }
        } // end class

        class RWLSList<T> : List<T>, IList<T> {
            ReaderWriterLockSlim _rwls = new ReaderWriterLockSlim();
            public RWLSList(IEnumerable<T> collection) : base(collection) { }
            T IList<T>.this[int index] {
                get {
                    try {
                        _rwls.EnterReadLock();
                        return base[index];
                    } finally {
                        _rwls.ExitReadLock();
                    }
                }
                set {
                    try {
                        _rwls.EnterWriteLock();
                        base[index] = value;
                    } finally {
                        _rwls.ExitWriteLock();
                    }
                }
            }
        } // end class

        class RWLSExtList<T> : List<T>, IList<T> {
            ReaderWriterLockSlim _rwls = new ReaderWriterLockSlim();
            public RWLSExtList(IEnumerable<T> collection) : base(collection) { }
            T IList<T>.this[int index] {
                get {
                    using(_rwls.ReadLock())
                        return base[index];
                }
                set {
                    using(_rwls.WriteLock())
                        base[index] = value;
                }
            }
        } // end class

        static void Main(string[] args) {
            const int ITERATIONS = 100;
            const int WORK = 10000;
            const int WRITE_THREADS = 4;
            const int READ_THREADS = WRITE_THREADS * 3;

            // create data - first List is for comparison only... not thread safe
            int[] copy = new int[WORK];
            IList<int>[] l = { new List<int>(copy), new MonitorList<int>(copy), new RWLSList<int>(copy), new RWLSExtList<int>(copy) };

            // test each list
            Thread[] writeThreads = new Thread[WRITE_THREADS];
            Thread[] readThreads = new Thread[READ_THREADS];
            foreach(var list in l) {
                Stopwatch sw = Stopwatch.StartNew();
                for(int k=0; k < ITERATIONS; k++) {
                    for(int i = 0; i < writeThreads.Length; i++) {
                        writeThreads[i] = new Thread(p => {
                            IList<int> il = p as IList<int>;
                            int c = il.Count;
                            for(int j = 0; j < c; j++) {
                                il[j] = j;
                            }
                        });
                        writeThreads[i].Start(list);
                    }
                    for(int i = 0; i < readThreads.Length; i++) {
                        readThreads[i] = new Thread(p => {
                            IList<int> il = p as IList<int>;
                            int c = il.Count;
                            for(int j = 0; j < c; j++) {
                                int temp = il[j];
                            }
                        });
                        readThreads[i].Start(list);
                    }
                    for(int i = 0; i < readThreads.Length; i++)
                        readThreads[i].Join();
                    for(int i = 0; i < writeThreads.Length; i++)
                        writeThreads[i].Join();
                };
                sw.Stop();
                Console.WriteLine("time: {0} class: {1}", sw.Elapsed, list.GetType());
            }
            Console.WriteLine("DONE");
            Console.ReadLine();
        }
    } // end class
} // end namespace 
```

这是一个典型的结果：

```
时间：00:00:03.0965242 类：System.Collections.Generic.List`1[System.Int32]
时间：00:00:11.9194573 类：LockPlay.Program+MonitorList`1[System.Int32]
时间：00:00:08.9510258 类：LockPlay.Program+RWLSList`1[System.Int32]
时间：00:00:16.9888435 类：LockPlay.Program+RWLSExtList`1[System.Int32]
完毕
```

如您所见，使用扩展实际上使性能比仅使用(monitor)*更差。*`lock`

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-30T05:43:40.873

看起来它是实例化数百万个结构和额外调用的代价。

我什至会说 ReaderWriterLockSlim 在这个示例中被滥用了，在这种情况下，锁就足够了，与向初级开发人员解释这些概念的价格相比，使用 ReaderWriterLockSlim 获得的性能优势可以忽略不计。

当执行读取和写入花费不可忽略的时间时，您将获得读写器样式锁的**巨大优势。**当您拥有一个主要基于读取的系统时，提升将是最大的。

尝试在获取锁时插入 Thread.Sleep(1) 以查看它产生的巨大差异。

请参阅此基准：

```
Test.SynchronizedList`1[System.Int32] 的时间经过的时间 12310 毫秒
Test.ReaderWriterLockedList`1[System.Int32] 的时间经过 547 毫秒
Test.ManualReaderWriterLockedList`1[System.Int32] 时间已用 566 毫秒

```

在我的基准测试中，我并没有真正注意到这两种风格之间有太大的区别，我会觉得使用它很舒服，只要它有一些终结器保护，以防人们忘记处理......

```
using System.Threading;
using System.Diagnostics;
using System.Collections.Generic;
using System;
using System.Linq;

namespace Test {

    static class RWLSExtension {
        struct Disposable : IDisposable {
            readonly Action _action;
            public Disposable(Action action) {
                _action = action;
            }
            public void Dispose() {
                _action();
            }
        }

        public static IDisposable ReadLock(this ReaderWriterLockSlim rwls) {
            rwls.EnterReadLock();
            return new Disposable(rwls.ExitReadLock);
        }
        public static IDisposable UpgradableReadLock(this ReaderWriterLockSlim rwls) {
            rwls.EnterUpgradeableReadLock();
            return new Disposable(rwls.ExitUpgradeableReadLock);
        }
        public static IDisposable WriteLock(this ReaderWriterLockSlim rwls) {
            rwls.EnterWriteLock();
            return new Disposable(rwls.ExitWriteLock);
        }
    }

    class SlowList<T> {

        List<T> baseList = new List<T>();

        public void AddRange(IEnumerable<T> items) {
            baseList.AddRange(items);
        }

        public virtual T this[int index] {
            get {
                Thread.Sleep(1);
                return baseList[index];
            }
            set {
                baseList[index] = value;
                Thread.Sleep(1);
            }
        }
    }

    class SynchronizedList<T> : SlowList<T> {

        object sync = new object();

        public override T this[int index] {
            get {
                lock (sync) {
                    return base[index];
                }

            }
            set {
                lock (sync) {
                    base[index] = value;
                }
            }
        }
    }

    class ManualReaderWriterLockedList<T> : SlowList<T> {

        ReaderWriterLockSlim slimLock = new ReaderWriterLockSlim();

        public override T this[int index] {
            get {
                T item;
                try {
                    slimLock.EnterReadLock();
                    item = base[index];
                } finally {
                    slimLock.ExitReadLock();
                }
                return item;

            }
            set {
                try {
                    slimLock.EnterWriteLock();
                    base[index] = value;
                } finally {
                    slimLock.ExitWriteLock();
                }
            }
        }
    }

    class ReaderWriterLockedList<T> : SlowList<T> {

        ReaderWriterLockSlim slimLock = new ReaderWriterLockSlim();

        public override T this[int index] {
            get {
                using (slimLock.ReadLock()) {
                    return base[index];
                }
            }
            set {
                using (slimLock.WriteLock()) {
                    base[index] = value;
                }
            }
        }
    }

    class Program {

        private static void Repeat(int times, int asyncThreads, Action action) {
            if (asyncThreads > 0) {

                var threads = new List<Thread>();

                for (int i = 0; i < asyncThreads; i++) {

                    int iterations = times / asyncThreads;
                    if (i == 0) {
                        iterations += times % asyncThreads;
                    }

                    Thread thread = new Thread(new ThreadStart(() => Repeat(iterations, 0, action)));
                    thread.Start();
                    threads.Add(thread);
                }

                foreach (var thread in threads) {
                    thread.Join();
                }

            } else {
                for (int i = 0; i < times; i++) {
                    action();
                }
            }
        }

        static void TimeAction(string description, Action func) {
            var watch = new Stopwatch();
            watch.Start();
            func();
            watch.Stop();
            Console.Write(description);
            Console.WriteLine(" Time Elapsed {0} ms", watch.ElapsedMilliseconds);
        }

        static void Main(string[] args) {

            int threadCount = 40;
            int iterations = 200;
            int readToWriteRatio = 60;

            var baseList = Enumerable.Range(0, 10000).ToList();

            List<SlowList<int>> lists = new List<SlowList<int>>() {
                new SynchronizedList<int>() ,
                new ReaderWriterLockedList<int>(),
                new ManualReaderWriterLockedList<int>()
            };

            foreach (var list in lists) {
                list.AddRange(baseList);
            }

            foreach (var list in lists) {
                TimeAction("Time for " + list.GetType().ToString(), () =>
                {
                    Repeat(iterations, threadCount, () =>
                    {
                        list[100] = 99;
                        for (int i = 0; i < readToWriteRatio; i++) {
                            int ignore = list[i];
                        }
                    });
                });
            }

            Console.WriteLine("DONE");
            Console.ReadLine();
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-07-19T16:43:47.183

该代码似乎使用结构来避免对象创建开销，但没有采取其他必要步骤来保持这种轻量级。我相信它将返回值装箱`ReadLock`，如果是这样，就会否定结构的全部优势。这应该可以解决所有问题，并且性能与不通过`IDisposable`界面一样好。

编辑：要求基准。这些结果被规范化，因此*手动*方法（调用`Enter`/`ExitReadLock`和`Enter`/`ExitWriteLock`与受保护的代码内联）的时间值为 1.00。**原始方法很慢，因为它在堆上分配手动方法没有的对象。我解决了这个问题，在发布模式下，即使扩展方法调用开销也消失了，它的速度与手动方法一样快。**

调试构建：

```
Manual:              1.00
Original Extensions: 1.62
My Extensions:       1.24 
```

发布版本：

```
Manual:              1.00
Original Extensions: 1.51
My Extensions:       1.00 
```

我的代码：

```
internal static class RWLSExtension
{
    public static ReadLockHelper ReadLock(this ReaderWriterLockSlim readerWriterLock)
    {
        return new ReadLockHelper(readerWriterLock);
    }

    public static UpgradeableReadLockHelper UpgradableReadLock(this ReaderWriterLockSlim readerWriterLock)
    {
        return new UpgradeableReadLockHelper(readerWriterLock);
    }

    public static WriteLockHelper WriteLock(this ReaderWriterLockSlim readerWriterLock)
    {
        return new WriteLockHelper(readerWriterLock);
    }

    public struct ReadLockHelper : IDisposable
    {
        private readonly ReaderWriterLockSlim readerWriterLock;

        public ReadLockHelper(ReaderWriterLockSlim readerWriterLock)
        {
            readerWriterLock.EnterReadLock();
            this.readerWriterLock = readerWriterLock;
        }

        public void Dispose()
        {
            this.readerWriterLock.ExitReadLock();
        }
    }

    public struct UpgradeableReadLockHelper : IDisposable
    {
        private readonly ReaderWriterLockSlim readerWriterLock;

        public UpgradeableReadLockHelper(ReaderWriterLockSlim readerWriterLock)
        {
            readerWriterLock.EnterUpgradeableReadLock();
            this.readerWriterLock = readerWriterLock;
        }

        public void Dispose()
        {
            this.readerWriterLock.ExitUpgradeableReadLock();
        }
    }

    public struct WriteLockHelper : IDisposable
    {
        private readonly ReaderWriterLockSlim readerWriterLock;

        public WriteLockHelper(ReaderWriterLockSlim readerWriterLock)
        {
            readerWriterLock.EnterWriteLock();
            this.readerWriterLock = readerWriterLock;
        }

        public void Dispose()
        {
            this.readerWriterLock.ExitWriteLock();
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-07-19T16:20:25.780

我的猜测（您需要进行分析以验证）是性能下降不是来自创建 Disposable 实例（它们应该相当便宜，是结构）。相反，我希望它来自创建动作代表。您可以尝试更改 Disposable 结构的实现以存储 ReaderWriterLockSlim 的实例，而不是创建 Action 委托。

**编辑：** @280Z28 的帖子确认是导致减速的 Action 代表的堆分配。

# c++ - 在编译时将继承限制为所需数量的类

> ID：805413
> 
> 赞同：3
> 
> 时间：2009-04-30T05:12:08.653
> 
> 标签：c++, inheritance, friend

我们有一个限制，一个类不能作为超过 7 个类的基类。有没有办法在编译时强制执行上述规则？

我知道 Andrew Koenig 的 Usable_Lock 技术可以防止类被继承，但只有当我们尝试实例化该类时它才会失败。自己推导时不能这样做吗？

允许基类知道谁是它的孩子。所以我想我们可以声明一个朋友类的组合并封装它们来执行这个规则。假设我们尝试这样的事情

```
class AA {
   friend class BB;
   private:
      AA() {}
      ~AA() {}
};

class BB : public AA {

};

class CC : public AA 
{}; 
```

类 CC 的派生将生成编译器警告 abt inaccessible dtor。然后，我们可以使用编译器调整将此类警告标记为错误（例如将所有警告标记为错误），但我不想依赖此类技术。

另一种方式，但在我看来相当笨拙的是： -

```
class B;

class InheritanceRule{
    class A {
    public:
        A() {}
        ~A() {}
    };
    friend class B;
};

class B {
public:
    class C : public InheritanceRule::A
    {};
};

class D : public InheritanceRule::A{}; 
```

类 D 的派生将被标记为编译器错误，这意味着要派生的所有类都应在类 B 中派生。这将允许至少检查从类 A 派生的类的数量，但不会阻止任何人添加更多.

这里有人有办法吗？如果基类不需要知道谁是它的孩子，那就更好了。

注意：作为基类的类本身可以被实例化（它不是抽象的）。

提前致谢，

EDIT-1：根据 jon.h 的评论，稍作修改

```
// create a template class without a body, so all uses of it fail
template < typename D> 
class AllowedInheritance;

class Derived; // forward declaration
// but allow Derived by explicit specialization 
template<> 
class AllowedInheritance< Derived> {};

template<class T>
class Base : private AllowedInheritance<T> {};

// privately inherit Derived from that explicit specialization    
class Derived : public Base<Derived> {};

// Do the same with class Fail Error
// it has no explicit specialization, so it causes a compiler error
class Fail : public Base<Fail> {}; // this is error

int main()
{   
   Derived d;

   return 0;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-30T08:06:36.270

抱歉，我不知道如何使用编译器强制执行任何此类限制。

就我个人而言，我不会费心试图将规则强加到代码本身中——你正在用与代码所做的事情无关的东西弄乱代码——这不是干净的代码。

与其跳过篮球，我会尝试放松该规则。相反，它应该是一个可以在必要时打破并与团队中其他人达成一致的指导方针。

当然，我不知道你在做什么，所以这条规则*可能*是合适的，但总的来说可能不是。

任何说你不能做 x 或者你必须总是做 y 的编程“规则”几乎总是错误的！注意里面的“几乎”这个词。

有时你可能**需要**超过 7 个派生类——那你会怎么做？跳过更多的箍。另外，为什么是7？为什么不是 6 或 8？这太武断了——这是一个糟糕的规则的另一个迹象。

如果你必须这样做，正如 JP 所说，静态分析可能是更好的方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-30T05:31:49.043

许多各种静态代码分析工具都提供了有关继承层次结构的信息。我不会尝试在您的代码中处理它，而是研究一种工具，该工具可以为继承层次结构设置一些规则，如果不遵循这些规则，则构建失败。可能要花一点钱，并且您可能必须编写自定义规则（我已经看到了继承深度，但没有看到您想要的继承“宽度”）。但是，从长远来看，我认为这是你最好的选择。

每条评论：我使用[Coverity](http://www.coverity.com/)取得了一些成功。有点花钱。有[几个不错的 SO 线程](https://stackoverflow.com/questions/739594/static-code-analyzer-unmanged-c-visual-studio-2008)可能有更好的选择。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-30T06:20:30.673

我累得要命，几乎睁不开眼睛，所以可能有一种更优雅的方法来做到这一点，而且我当然不赞同 Base 最多应该有七个子类的奇怪想法。

```
// create a template class without a body, so all uses of it fail
template < typename D, typename B> class AllowedInheritance;

class Base {};
class Derived; // forward declaration

// but allow Derived, Base by explicit specialization 

template<> class AllowedInheritance< Derived, Base> {};

// privately inherit Derived from that explicit specialization    
class Derived : public Base, private AllowedInheritance<Derived, Base> {};

// Do the same with class Compiler Error
// it has no explicit specialization, so it causes a compiler error
class CompileError: public Base, 
     private AllowedInheritance<CompileError, Base> { };

//error: invalid use of incomplete type 
//‘struct AllowedInheritance<CompileError, Base>’

int main() {

   Base b;
   Derived d;
   return 0;
} 
```

来自 jon.h 的评论：

> 例如，这是如何停止的：class Fail : public Base { }; ? \

它没有。但是OP的原始示例也没有。

[致 OP：您对我的回答的修订几乎是 Coplien 的“Curiously recurring template pattern”的直接应用](http://en.wikipedia.org/wiki/Curiously_Recurring_Template_Pattern)]

我也考虑过这一点，但问题是 a`derived1 : pubic base<derived1>`和 a之间没有继承关系`derived2 : pubic base<derived2>`，因为`base<derived1>`and`base<derived2>`是两个完全不相关的类。

如果您唯一关心的是实现的继承，那没问题，但是如果您想要接口的继承，您的解决方案就会打破这一点。

我认为有一种方法可以同时获得继承和更简洁的语法；正如我所提到的，当我编写解决方案时我很累。如果不出意外，通过在您的示例中将 RealBase 作为 Base 的基类是一个快速修复。

可能有很多方法可以清理它。但我想强调的是，我同意 markh44：尽管我的解决方案更简洁，但我们仍然将代码弄得杂乱无章，以支持一个毫无意义的规则。仅仅因为可以做到这一点，并不意味着就应该这样做。

如果所讨论的基类已经使用了十年并且太脆弱而无法继承，那么真正的答案是修复它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-30T11:28:23.913

您可以使用[GCC-XML 之](http://www.gccxml.org/HTML/Index.html)类的东西，而不是用断言使代码混乱，它使用 g++ 编译器前端解析 C++ 源代码并生成 XML 输出。我希望开发一个解析此输出并检查是否违反规则的工具会相当简单；然后可以将其与源代码签入集成。

顺便说一句，让基类知道它们的后代违反了[开闭原则](http://en.wikipedia.org/wiki/Open/closed_principle)，这意味着它实际上削弱了一般 OO 编程的有用性。将代码分成基类和子类的*主要原因*是基类*不必知道*它的子类——这使得安装后交付插件包之类的事情成为可能。

# file - 如何通过 Linux 上的脚本找到文件的编码？

> ID：805418
> 
> 赞同：371
> 
> 时间：2009-04-30T05:13:48.480
> 
> 标签：file, shell, unix, encoding

我需要找到放置在目录中的所有文件的编码。有没有办法找到使用的编码？

该[`file`](https://linux.die.net/man/1/file)命令无法执行此操作。

我感兴趣的编码是[ISO 8859-1](https://en.wikipedia.org/wiki/ISO/IEC_8859-1)。如果编码是别的，我想将文件移动到另一个目录。

* * *

## 回答 #1

> 赞同：514
> 
> 时间：2009-04-30T05:41:58.723

听起来您正在寻找`enca`. 它可以猜测甚至在编码之间进行转换。只需查看[手册页](http://linux.die.net/man/1/enconv)。

或者，如果做不到这一点，请使用`file -i`(Linux) 或`file -I`(OS X)。这将输出文件的 MIME 类型信息，其中还包括字符集编码。我也找到了它的[手册页](http://linux.die.net/man/1/file):)

* * *

## 回答 #2

> 赞同：101
> 
> 时间：2012-07-27T05:39:06.833

```
file -bi <file name> 
```

如果你喜欢对一堆文件执行此操作

```
for f in `find | egrep -v Eliminate`; do echo "$f" ' -- ' `file -bi "$f"` ; done 
```

* * *

## 回答 #3

> 赞同：53
> 
> 时间：2015-12-29T00:38:15.237

[uchardet](https://www.freedesktop.org/wiki/Software/uchardet) - 从 Mozilla 移植的编码检测器库。

用法：

```
~> uchardet file.java
UTF-8 
```

各种 Linux 发行版（[Debian](https://en.wikipedia.org/wiki/Debian)、[Ubuntu](https://en.wikipedia.org/wiki/Ubuntu_%28operating_system%29)、[openSUSE](https://en.wikipedia.org/wiki/OpenSUSE)、[Pacman](https://en.wikipedia.org/wiki/Arch_Linux#Pacman)等）都提供二进制文件。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2018-02-21T18:49:12.197

在 Debian 中，您还可以使用`encguess`：：

```
$ encguess test.txt
test.txt  US-ASCII 
```

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2016-02-08T16:53:37.653

这是一个在 Mac OS X 上使用`file -I`和[iconv](https://en.wikipedia.org/wiki/Iconv)的示例脚本。

对于您的问题，您需要使用`mv`而不是`iconv`：

```
#!/bin/bash
# 2016-02-08
# check encoding and convert files
for f in *.java
do
  encoding=`file -I $f | cut -f 2 -d";" | cut -f 2 -d=`
  case $encoding in
    iso-8859-1)
    iconv -f iso8859-1 -t utf-8 $f > $f.utf8
    mv $f.utf8 $f
    ;;
  esac
done 
```

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2019-02-18T12:29:54.907

要将编码从 ISO 8859-1 转换为 ASCII：

```
iconv -f ISO_8859-1 -t ASCII filename.txt 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2009-04-30T07:13:47.847

很难确定它是否是 ISO 8859-1。如果您有一个只有 7 位字符的文本，也可能是 ISO 8859-1，但您不知道。如果您有 8 位字符，则上部区域字符也按顺序编码存在。因此，您必须使用字典来更好地猜测它是哪个单词，并从那里确定它必须是哪个字母。最后，如果您检测到它可能是 UTF-8，那么您确定它不是 ISO 8859-1。

编码是最难做的事情之一，因为你永远不知道是否没有什么在告诉你。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2011-07-18T14:55:14.723

使用 Python，您可以使用[chardet](https://github.com/chardet/chardet)模块。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2019-07-12T16:08:51.120

在 PHP 中，您可以像下面这样检查它：

明确指定编码列表：

```
php -r "echo 'probably : ' . mb_detect_encoding(file_get_contents('myfile.txt'), 'UTF-8, ASCII, JIS, EUC-JP, SJIS, iso-8859-1') . PHP_EOL;" 
```

更准确的“mb_list_encodings”：

```
php -r "echo 'probably : ' . mb_detect_encoding(file_get_contents('myfile.txt'), mb_list_encodings()) . PHP_EOL;" 
```

在第一个示例中，您可以看到我使用了可能匹配的编码列表（检测列表顺序）。要获得更准确的结果，您可以通过以下方式使用所有可能的编码：***mb_list_encodings()***

注意 mb_* 函数需要 php-mbstring：

```
apt-get install php-mbstring 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2019-08-28T22:02:25.067

使用此命令：

```
for f in `find .`; do echo `file -i "$f"`; done 
```

您可以列出一个目录和子目录中的所有文件以及相应的编码。

如果文件名称中有空格，请使用：

```
IFS=$'\n'
for f in `find .`; do echo `file -i "$f"`; done 
```

请记住，它会将您当前的 Bash 会话解释器更改为“空格”。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-04-30T05:45:24.720

这不是你可以以万无一失的方式做的事情。一种可能性是检查文件中的每个字符以确保它不包含范围内的任何字符，`0x00 - 0x1f`或者`0x7f -0x9f`正如我所说，这可能适用于任何数量的文件，包括至少一个 ISO 8859 的其他变体.

另一种可能性是在文件中查找所有支持的语言的特定单词，看看是否能找到它们。

因此，例如，在 ISO 8859-1 的所有支持的语言中找到英语“and”、“but”、“to”、“of”等的等价词，看看它们是否在文件。

我不是在谈论直译，例如：

```
English   French
-------   ------
of        de, du
and       et
the       le, la, les 
```

虽然这是可能的。我说的是目标语言中的常用词（据我所知，冰岛语没有“和”这个词 - 你可能不得不用他们的词来表示“鱼”[抱歉，这有点刻板。我没有表示任何冒犯，只是说明一点]）。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2012-01-27T14:31:38.110

如果您谈论的是 XML 文件 (ISO-8859-1)，其中的 XML 声明指定了编码：`<?xml version="1.0" encoding="ISO-8859-1" ?>` 因此，您可以使用正则表达式（例如，使用 Perl）来检查每个文件的此类规范。

更多信息可以在这里找到：*[如何确定文本文件编码](http://codesnipers.com/?q=how-to-determine-text-file-encoding "如何确定文本文件编码")*。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2012-05-30T18:18:04.630

我知道您对更一般的答案感兴趣，但是 ASCII 的优点通常在其他编码中也很好。这是确定标准输入是否为 ASCII 的 Python 单行代码。（我很确定这在 Python 2 中有效，但我只在 Python 3 上测试过。）

```
python -c 'from sys import exit,stdin;exit()if 128>max(c for l in open(stdin.fileno(),"b") for c in l) else exit("Not ASCII")' < myfile.txt 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2018-09-05T16:14:37.873

我正在使用以下脚本

1.  查找与 FILTER 与 SRC_ENCODING 匹配的所有文件
2.  创建它们的备份
3.  将它们转换为 DST_ENCODING
4.  （可选）删除备份

```
#!/bin/bash -xe

SRC_ENCODING="iso-8859-1"
DST_ENCODING="utf-8"
FILTER="*.java"

echo "Find all files that match the encoding $SRC_ENCODING and filter $FILTER"
FOUND_FILES=$(find . -iname "$FILTER" -exec file -i {} \; | grep "$SRC_ENCODING" | grep -Eo '^.*\.java')

for FILE in $FOUND_FILES ; do
    ORIGINAL_FILE="$FILE.$SRC_ENCODING.bkp"
    echo "Backup original file to $ORIGINAL_FILE"
    mv "$FILE" "$ORIGINAL_FILE"

    echo "converting $FILE from $SRC_ENCODING to $DST_ENCODING"
    iconv -f "$SRC_ENCODING" -t "$DST_ENCODING" "$ORIGINAL_FILE" -o "$FILE"
done

echo "Deleting backups"
find . -iname "*.$SRC_ENCODING.bkp" -exec rm {} \; 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2017-05-27T17:56:56.267

在[Cygwin](https://en.wikipedia.org/wiki/Cygwin)中，这看起来对我有用：

```
find -type f -name "<FILENAME_GLOB>" | while read <VAR>; do (file -i "$<VAR>"); done 
```

例子：

```
find -type f -name "*.txt" | while read file; do (file -i "$file"); done 
```

您可以将它通过管道传输到 AWK 并创建一个[iconv](https://en.wikipedia.org/wiki/Iconv)命令以将所有内容转换为 UTF-8，从 iconv 支持的任何源编码。

例子：

```
find -type f -name "*.txt" | while read file; do (file -i "$file"); done | awk -F[:=] '{print "iconv -f "$3" -t utf8 \""$1"\" > \""$1"_utf8\""}' | bash 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2018-04-05T17:08:21.680

您可以使用 file 命令提取单个文件的编码。我有一个 sample.html 文件：

```
$ file sample.html 
```

sample.html：HTML 文档，UTF-8 Unicode 文本，行很长

```
$ file -b sample.html 
```

HTML 文档，UTF-8 Unicode 文本，行很长

```
$ file -bi sample.html 
```

文本/html；字符集=utf-8

```
$ file -bi sample.html  | awk -F'=' '{print $2 }' 
```

UTF-8

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2021-11-03T08:34:05.317

我在一个需要跨平台支持的项目中工作，我遇到了许多与文件编码相关的问题。

我制作了这个脚本以将所有内容转换为 utf-8：

```
#!/bin/bash
## Retrieve the encoding of files and convert them
for f  `find "$1" -regextype posix-egrep -regex ".*\.(cpp|h)$"`; do
  echo "file: $f"
  ## Reads the entire file and get the enconding
  bytes_to_scan=$(wc -c < $f)
  encoding=`file -b --mime-encoding -P bytes=$bytes_to_scan $f`
  case $encoding in
    iso-8859-1 | euc-kr)
    iconv -f euc-kr -t utf-8 $f > $f.utf8
    mv $f.utf8 $f
    ;;
  esac
done 
```

我使用 hack 读取整个文件并使用估计文件编码`file -b --mime-encoding -P bytes=$bytes_to_scan $f`

* * *

## 回答 #18

> 赞同：-3
> 
> 时间：2012-01-23T10:14:02.587

对于 Perl，使用 Encode::Detect。

# user-interface - 在 OpenGL 中创建按钮和图标

> ID：805421
> 
> 赞同：15
> 
> 时间：2009-04-30T05:15:49.130
> 
> 标签：user-interface, opengl

我正在尝试使用类似于 MS Paint 的 OpenGL 制作一个带有面板和所有内容的编辑器。我在哪里可以找到有关如何创建按钮和图标的资料？

PS - 我确实发现了提供此类实体的 GLUI，但我不允许使用除 GLUT 之外的任何东西。

源代码，如果提供，将非常有帮助..

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-04-30T05:23:19.063

在*[OpenGL 编程](http://nccastaff.bournemouth.ac.uk/jmacey/RobTheBloke/www/opengl_programming.html)*上有一个名为“Creating Simple Buttons using function pointers (+ source)”的例子

> 这是一个分步教程，展示了如何使用链表和函数指针在 OpenGL 和 C 中创建基本按钮。

可能对你有帮助。

# c# - Windows 工作流上的 UI

> ID：805422
> 
> 赞同：1
> 
> 时间：2009-04-30T05:16:22.887
> 
> 标签：c#, workflow-foundation

使用 Windows 工作流时是否有任何内置 UI 功能。

假设我有一个需要一个小时才能运行的工作流程，其中不同的活动一直在发生。在运行时，我想查看当前处于活动状态的活动、已经运行的活动等。

我是否必须自己编写此 UI 或 WF 是否具有以图形方式显示工作流状态等的内置功能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-30T05:28:51.250

为了找出工作流所处的状态，我订阅了 WorkflowIdled 事件并执行以下操作：

```
 private delegate void UpdateDelegate();
   void workflowRuntime_WorkflowIdled(object sender, WorkflowEventArgs e)
        {
            StateMachineWorkflowInstance stateMachineInstance = new StateMachineWorkflowInstance(MyManager.WorkflowRuntime, MyInstance.Id);
            UpdateDelegate LclUpdateDelgate = delegate()
            {
                // Update the workflow state on the form thread
                if (stateMachineInstance.CurrentState != null)
                    LabelWorkflowState.Text = stateMachineInstance.CurrentStateName;
                else
                    LabelWorkflowState.Text = "";

            };
            this.Invoke(LclUpdateDelgate);
        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-30T13:34:23.113

在 MSDN 上查看此代码示例：

[http://msdn.microsoft.com/en-us/library/ms741706.aspx](http://msdn.microsoft.com/en-us/library/ms741706.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-30T11:16:08.450

没有内置的用户界面。

但是您可以通过订阅 WorflowInstance 上的事件（请参阅其他答案）或使用[Tracking Service](http://msdn.microsoft.com/library/ms735887.aspx)来创建一个。

前者很容易设置为快速解决方案，但后者将与多个主机进程和长时间运行（卸载）的工作流实例一起使用。

# ssis - 使用 dtexec 实用程序执行 SSIS 包

> ID：805424
> 
> 赞同：1
> 
> 时间：2009-04-30T05:16:44.570
> 
> 标签：ssis

我制作了一个 SSIS 包来创建一个 XML 文件，该文件在 Visual Studio 中运行良好，但是当我尝试在 cmd 提示符下使用`dtexec /f "C:\OakeyCreek.dtsx"`它运行时会引发错误

> SSIS 包“TestOakey”失败，退出代码：1

在包中，sqltask 以 XML 形式提供结果集，脚本任务创建 xml 文件。

我做了一些研究，没有脚本任务的相同包在工作室和 cmd 提示符下运行良好。我怀疑脚本任务有问题，因为我在同一台机器上同时拥有 VS2005 和 VS2008。

知道如何解决这个问题吗？

确切的错误 ms 弹出窗口是...

> 此应用程序的注册信息需要更新。要更新，请以管理员身份登录并运行此命令。
> 
> "C:\Program Files\Microsoft Visual Studio 9.0\Common7\IDE\VSTA.exe" /HostID SSIS_ScriptTask /setup

我的操作系统是 Vista

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-30T05:24:22.667

注意：已编辑以提供答案！

因此，您已经设置了 SQL Server 代理作业，但现在您无法写入文件系统。这是预期行为，因为 SQL Server 代理使用*SQL Server 凭据*来启动作业，**而不是**Windows 凭据。所以，你需要做的是：

1.  在 SQL Server Management Studio 中数据库服务器的安全文件夹下，找到凭据文件夹。
2.  右键单击凭据并点击新凭据。
3.  像你一样设置凭证。
4.  展开 SQL Server 代理，然后右键单击代理，然后点击新建代理。
5.  使用您刚刚创建的凭据设置代理。
6.  启用代理以拥有 SSIS 子系统（如果它是管理员，请检查所有子系统）。
7.  去编辑你的工作中调用 SSIS 包的步骤。
8.  将“运行方式”字段从 SQL Server 代理更改为您刚刚设置的代理（如果操作正确，它将是下拉列表中唯一的其他选择）。
9.  你应该很高兴去！

干杯，
埃里克

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-30T06:35:51.573

您正在使用 SSIS 2005 创建包，但使用 SSIS 2008 中的 DTEXEC 运行它 - 您可能同时安装了 SSIS 2005 和 2008，并且 DTEXEC 2008 首先出现在路径中。

要使用 DTEXEC 2005，请指定完整路径，例如 "c:\program files\Microsoft Sql Server\90\dts\binn\dtexec.exe" /f Package.dtsx

理论上，DTEXEC 2008 也应该能够运行该软件包（它应该将其即时升级到 SSIS 2008 格式），但版本之间可能存在错误和不兼容。此外，SSIS 2008 中的脚本任务设置似乎有问题。为什么不按照错误消息中的说明进行操作：以管理员身份登录并（使用提升的命令提示符）运行 -

"C:\Program Files\Microsoft Visual Studio 9.0\Common7\IDE\VSTA.exe" /HostID SSIS_ScriptTask /setup

# django - 我应该为服务器上的 Django 文件夹使用哪些权限？

> ID：805427
> 
> 赞同：1
> 
> 时间：2009-04-30T05:19:17.030
> 
> 标签：django, permissions

当我使用他们的一键式 Django 安装程序时，我的主机 Djangohosting 默认为我的 Django 文件夹放置 777。

我不确定这是否安全，因为每个人都可以明显地看到我的源代码。

**我应该为服务器上的 Django 文件夹使用哪些权限？**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-30T05:28:05.137

任何有权访问机器上文件的人实际上都可以使用这些权限更改您的文件。很多时候，Web 服务器将在与您的用户的 uid 不同的用户 ID (uid) 下运行，因此您可能希望让其他用户读取文件。鉴于此，您可能希望目录权限为 755，文件权限为 644。

有关 unix 权限的详细说明，请参见[此处](http://en.wikipedia.org/wiki/File_system_permissions#Traditional_Unix_permissions)。

# c# - 我可以为 .NET Windows 窗体窗口中的工具提示设置无限 AutoPopDelay 吗？

> ID：805430
> 
> 赞同：8
> 
> 时间：2009-04-30T05:20:39.553
> 
> 标签：c#, .net, winforms, tooltip

我要求不自动隐藏标准的 .NET [Windows 窗体](http://en.wikipedia.org/wiki/Windows_Forms)工具提示 - 也就是说，我需要它们保持可见，直到鼠标移出具有工具提示的控件。我想避免为所有带有工具提示的控件使用特定的 MouseEnter 和 MouseLeave 事件。如果他们能解决问题，我很高兴听到有关第三方解决方案的信息。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-13T14:59:07.243

由于它已经发布了无数次并且从 .NET Framework 早期就知道，因此您不能将 AutoPopDelay 时间设置为高于 Int16.MaxValue（即 32767）并使其正常工作。使用工具提示 Show() 方法会导致相同的结果。任何高于 32767 的值都会导致计时器重置为 5000 毫秒。

即使尝试将 AutomaticDelay 设置为导致 AutoPopDelay 值高于 32767 的值也会导致工具提示不起作用。此外，使用 StopTimer() 方法不会产生任何积极的结果。

我成功显示具有无限超时的工具提示的唯一方法是使用传递显示位置的工具提示 Show() 方法。`tooltip.Show(text, control, position)`. 总之，工具提示控件具有我在控件中遇到的最奇怪的行为，有关设置延迟时间的文档非常具有误导性。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2010-06-24T08:02:48.663

我正在寻找解决问题的方法

> 1.  弹出气球消失得太快，让我无法阅读其内容
> 2.  悬停在该区域时，弹出气球不会再次出现。

我在论坛中找到了以下答案，它不能解决问题 2，但是当我将其值设置为**32766**时，我阅读文本的时间超过了我需要的时间，因此 - 在我看来 - 一种“解决方法” ：

> *实际上，我发现我的问题是我分配了一个高于 32767 的值（32768 和更高的值会产生 5 秒的效果）真的很奇怪，因为 AutoPopDelay 应该以整数（32 位）作为参数，而 32767 真的有符号的 16 位 ...*

但我不得不承认，它仍然很糟糕......

但将其设置为**32000**（32 秒）似乎效果更好。不知道为什么会这样，但也许它可以帮助某人。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-02-29T09:49:01.760

在我的应用程序中，工具提示文本必须每 10 秒更新一次。对我有用的是每次更新此文本时停用和激活工具提示。当我将 AutoPopDelay 设置为超过 10 秒时，工具提示将有效地永久保留。因此，您可以使用计时器来重复激活和停用工具提示：

```
private void timer1_Tick(object sender, EventArgs e)
{
    toolTip1.Active = false;
    toolTip1.Active = true;
} 
```

要最小化重新激活工具提示时发生的闪烁，请将 InitialDelay 设置为 1。当您将 AutoPopDelay 设置为 30000 并将计时器间隔也设置为 30000 时，您将看到每 30 秒仅一次的非常短的闪烁。对于我的应用程序，这种短暂的闪烁是可以接受的。顺便说一句，别忘了打开定时器！（起初我以为它不起作用，直到我发现我忘了打开定时器;-)）

当然，这是治疗症状的方法，而不是解决问题的优雅方法。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-12-21T10:47:30.560

试试`myToolTip.ReshowDelay = 0`。

您只需在延迟到期后立即重新显示工具提示。它对我有用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-10-04T16:07:01.033

我认为您正在尝试治愈症状，而不是解决问题的原因。

您正试图强制工具提示与工具提示不同。根据定义，工具提示是“一个小的“悬停框”，其中包含有关被悬停的项目的信息”。

如果用户无法在 30 秒内阅读工具提示试图建议的内容，那么它并不是真正的“提示”，而是帮助文件中的一整章。将冗长的说明放入手册中，不要试图将其强制放入永远保持打开状态的工具提示中。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-30T10:32:55.450

这不会是你想听到的答案......自己动手吧。我曾经有一个场景，我想模拟新 Office 的功能区工具提示行为以用于快捷键命令，我发现标准工具提示 API 太有限了。

为您需要工具提示的每个控件创建一个小而简单且无边框的表单实例。然后在执行 mouse-enter 或 -leave 事件时以非模态方式显示和隐藏它们。让此窗口的构造函数接收 UI 控件实例并让它查询控件的事件，以便它可以将自己附加到鼠标进入和离开事件，这样您就不必手动连接它们。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-05T05:36:53.980

所以，我最终停用了工具提示，但我仍然使用它来保存工具提示的文本，因为它巧妙地将自身添加到所有控件中。我为工具提示制作了自己的面板和标签，并在所有控件的鼠标输入和鼠标离开事件上动态定位、显示和填充文本。

我还编写了一个递归函数来将鼠标事件添加到每个标签控件（我唯一有工具提示的），所以我不必手动添加它，也不必记住添加新的标签。该项目的新开发人员可能从未意识到工具提示控件实际上并未呈现提示。

为什么要在面板中添加标签？- 非常大的工具提示可以滚动 - 尽管这仍然不能很好地工作。

这不是真的很漂亮，如果你继续的话，我仍然在寻找一个好的答案（或对我所采用的方法的批评）。

我遇到了[http://www.binarymission.co.uk/](http://www.binarymission.co.uk/)，但他们的工具提示似乎没有在我的 .NET 3.5 应用程序中正确呈现。我还在和他们说话。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-12-01T15:17:39.633

在我有限的经验中，我发现将 showAlways 属性设置为 true 具有使提示“无限”显示的副作用（直到光标退出控件）。这不是文档所说的那样，但这就是我所经历的。（但是，我使用的是 Janus Supertip 组件，这可能会影响行为）。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-04-30T07:04:02.177

Set the ToolTipService.ShowDuration attached property to int.MaxValue:

```
<Button 
  Height="23" Width="75"
  Content="Click Me" 
  ToolTip="My ToolTip" ToolTipService.ShowDuration="2147483647" 
/> 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-04-30T08:12:44.367

该`ToolTip.StopTimer`方法可能会有所帮助。来自 MSDN：

> ToolTip 类有一个内部计时器，用于设置 ToolTips 的显示持续时间。与此计时器关联的持续时间通过 AutoPopDelay 属性设置。**StopTimer 方法将停止此内部计时器，导致任何显示的 ToolTip 以模态方式显示，直到调用 Hide 方法**，或者父窗体被最小化、隐藏或关闭。

# svn - 如何在debian中通过apache指定svn存储库中项目的访问权限

> ID：805432
> 
> 赞同：0
> 
> 时间：2009-04-30T05:21:40.270
> 
> 标签：svn, apache2, debian

谁能告诉我以下方法是否正确？

[团体]

team1=user1 team2=user2.user3

[/] @team1=rw

[颠覆：/myproject1] @team=rw

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-01T19:35:57.710

this is the config I use (in svn_access_file, your file name could be diff)

```
[groups]
my_group_name = my_user_id, his_user_id
my_group_name2 = my_user_id2, his_user_id2

[myreponame:/]
@my_group_name = rw

[myreponame:/mybranch/]
@my_group_name2 = rw 
```

my repository root is in /usr/svnrepo/ my repository is /usr/svnrepo/myreponame

My Apache configuration is:

```
<Location /svn>
DAV svn
SVNParentPath /usr/svnrepo/
AuthzSVNAccessFile /etc/svn/svn_access_file
Satisfy Any
Require valid-user
AuthType Basic
AuthName "Subversion repository"
AuthUserFile /etc/svn/svn_auth_file
SVNAutoversioning on
</Location> 
```

So, you approach is correct

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T18:38:08.840

nope, try to limit access and see your repos are still rw accessed

# java - 隐藏打印对话框

> ID：805433
> 
> 赞同：1
> 
> 时间：2009-04-30T05:21:54.090
> 
> 标签：java, swing, printing

我正在打印一个 Jpanel 并且它工作正常，但现在我需要打印对话框，它总是在单击打印按钮时出现。假设是这样，当用户按下打印按钮时，默认打印机应该开始打印作业，而不会出现打印对话框。这是我正在使用的代码，

```
Paper paper = new Paper();
paper.setImageableArea(0, 0, 153, 243);
paper.setSize(243, 154);

PageFormat format = new PageFormat();
format.setPaper(paper);
format.setOrientation(PageFormat.LANDSCAPE);

printjob.setPrintable(printable, format);

if (printjob.printDialog() == false)
        return;

try {
        printjob.print();
} catch (PrinterException ex) {
        System.out.println("NO PAGE FOUND." + ex);
} 
```

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-30T05:40:58.180

你在 printjob 上调用[setPrintService()](http://java.sun.com/j2se/1.4.2/docs/api/java/awt/print/PrinterJob.html#setPrintService(javax.print.PrintService))了吗？

或者尝试使用[printjob.getPrinterJob()](http://java.sun.com/j2se/1.4.2/docs/api/java/awt/print/PrinterJob.html#getPrinterJob())来获取与默认打印机关联的实例。

# c# - 在 C# 中创建视频文件

> ID：805436
> 
> 赞同：0
> 
> 时间：2009-04-30T05:22:54.183
> 
> 标签：c#, screen-capture

我将如何创建一个应用程序来记录用户在 C# 中与桌面的交互，然后将其转换为 avi 等视频格式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2019-12-04T15:31:25.087

要捕获屏幕截图，您可以使用[CopyFromScreen](https://docs.microsoft.com/en-us/dotnet/api/system.drawing.graphics.copyfromscreen)。

简单的 C# 示例：

```
Rectangle bounds = Screen.GetBounds(Point.Empty);
using(Bitmap bitmap = new Bitmap(bounds.Width, bounds.Height))
{
    using(Graphics g = Graphics.FromImage(bitmap))
    {
         g.CopyFromScreen(Point.Empty, Point.Empty, bounds.Size);
    }

    // TODO: Save or use in any other way.
} 
```

但是，如果您想捕获视频，最好使用类似[Stack Overflow question](https://stackoverflow.com/questions/4068414/how-to-capture-screen-to-be-video-using-c-sharp-net)的内容。

# winforms - 当 MDI 父窗体最大化时，如何使子窗体调整大小？

> ID：805443
> 
> 赞同：1
> 
> 时间：2009-04-30T05:24:45.597
> 
> 标签：winforms, mdi

我有一个带有子表单的 MDI 表单。
我默认保持 MDI 表单正常。
当我最大化 MDI 时，子窗体不会在其中最大化。
我需要做什么才能使其与其父级一起调整大小？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-30T06:15:36.927

使用自定义事件 - 当父级将窗口状态更改为最大化时，它会引发事件；子窗体附加到事件并最大化自己

当然，这引出了“你为什么要这样做？”的问题。因为只有最后一个最大化自身的孩子才会可见......

# cocoa - 在 Cocoa 中为 OpenAL 加载 .wav 文件

> ID：805454
> 
> 赞同：3
> 
> 时间：2009-04-30T05:28:25.417
> 
> 标签：cocoa, file, audio, loading, wav

我需要将声音文件加载到基于 Cocoa 的 OpenAL 应用程序中。

进步：

*   OpenAL 实用程序函数 alutLoadWAVFile 已被弃用；alut 标头不再包含在 Mac OS X SDK 中。根据技术说明，实际代码仍然存在以实现二进制兼容性。但是，如果我尝试为函数添加声明，代码将编译但链接器将中止，并抱怨找不到 alutLoadWAVFile 的符号。（我链接到 OpenAL.framework）。

*   然而，Apple OpenAL 示例代码仍然使用这个符号。当我清理示例代码项目时，它可以很好地编译和链接。然而，没有声明要找到的函数。（附带问题：那么它如何构建和链接？）

所以，我在 Apple 找到了 George Warner 的一些代码，其中包含 alutCreateBufferFromFile 和 alutLoadMemoryFromFile 的替换函数。虽然能够直接从大多数任何类型的音频文件创建 OpenAL 缓冲区，但该代码似乎只支持 8 位单声道声音文件。16 位立体声或单声道 44khz 文件会产生令人讨厌的嘶嘶声和削波。（文件没问题；Quicktime 可以正常播放。）

因此，我的问题是：有人可以指点我一些适用于 OpenAL 缓冲区的 .wav 加载代码/帮助 Cocoa/Carbon 吗？谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2011-01-01T02:22:47.167

我相信你已经解决了这个问题，但是对于通过谷歌找到这个的人来说，这里有一些几乎没有经过测试的 WAV 加载代码。它可以工作，但你最好在使用真正的东西之前仔细检查内存泄漏等等。

```
static bool LoadWAVFile(const char* filename, ALenum* format, ALvoid** data, ALsizei* size, ALsizei* freq, Float64* estimatedDurationOut)
{
    CFStringRef filenameStr = CFStringCreateWithCString( NULL, filename, kCFStringEncodingUTF8 );
    CFURLRef url = CFURLCreateWithFileSystemPath( NULL, filenameStr, kCFURLPOSIXPathStyle, false );
    CFRelease( filenameStr );

    AudioFileID audioFile;
    OSStatus error = AudioFileOpenURL( url, kAudioFileReadPermission, kAudioFileWAVEType, &audioFile );
    CFRelease( url );

    if ( error != noErr )
    {
        fprintf( stderr, "Error opening audio file. %d\n", error );
        return false;
    }

    AudioStreamBasicDescription basicDescription;
    UInt32 propertySize = sizeof(basicDescription);
    error = AudioFileGetProperty( audioFile, kAudioFilePropertyDataFormat, &propertySize, &basicDescription );

    if ( error != noErr )
    {
        fprintf( stderr, "Error reading audio file basic description. %d\n", error );
        AudioFileClose( audioFile );
        return false;
    }

    if ( basicDescription.mFormatID != kAudioFormatLinearPCM )
    {
        // Need PCM for Open AL. WAVs are (I believe) by definition PCM, so this check isn't necessary. It's just here
        // in case I ever use this with another audio format.
        fprintf( stderr, "Audio file is not linear-PCM. %d\n", basicDescription.mFormatID );
        AudioFileClose( audioFile );
        return false;
    }

    UInt64 audioDataByteCount = 0;
    propertySize = sizeof(audioDataByteCount);
    error = AudioFileGetProperty( audioFile, kAudioFilePropertyAudioDataByteCount, &propertySize, &audioDataByteCount );
    if ( error != noErr )
    {
        fprintf( stderr, "Error reading audio file byte count. %d\n", error );
        AudioFileClose( audioFile );
        return false;
    }

    Float64 estimatedDuration = 0;
    propertySize = sizeof(estimatedDuration);
    error = AudioFileGetProperty( audioFile, kAudioFilePropertyEstimatedDuration, &propertySize, &estimatedDuration );
    if ( error != noErr )
    {
        fprintf( stderr, "Error reading estimated duration of audio file. %d\n", error );
        AudioFileClose( audioFile );
        return false;
    }

    ALenum alFormat = 0;

    if ( basicDescription.mChannelsPerFrame == 1 )
    {
        if ( basicDescription.mBitsPerChannel == 8 )
            alFormat = AL_FORMAT_MONO8;
        else if ( basicDescription.mBitsPerChannel == 16 )
            alFormat = AL_FORMAT_MONO16;
        else
        {
            fprintf( stderr, "Expected 8 or 16 bits for the mono channel but got %d\n", basicDescription.mBitsPerChannel );
            AudioFileClose( audioFile );
            return false;
        }

    }
    else if ( basicDescription.mChannelsPerFrame == 2 )
    {
        if ( basicDescription.mBitsPerChannel == 8 )
            alFormat = AL_FORMAT_STEREO8;
        else if ( basicDescription.mBitsPerChannel == 16 )
            alFormat = AL_FORMAT_STEREO16;
        else
        {
            fprintf( stderr, "Expected 8 or 16 bits per channel but got %d\n", basicDescription.mBitsPerChannel );
            AudioFileClose( audioFile );
            return false;
        }
    }
    else
    {
        fprintf( stderr, "Expected 1 or 2 channels in audio file but got %d\n", basicDescription.mChannelsPerFrame );
        AudioFileClose( audioFile );
        return false;
    }

    UInt32 numBytesToRead = audioDataByteCount;
    void* buffer = malloc( numBytesToRead );

    if ( buffer == NULL )
    {
        fprintf( stderr, "Error allocating buffer for audio data of size %u\n", numBytesToRead );
        return false;
    }

    error = AudioFileReadBytes( audioFile, false, 0, &numBytesToRead, buffer );
    AudioFileClose( audioFile );

    if ( error != noErr )
    {
        fprintf( stderr, "Error reading audio bytes. %d\n", error );
        free(buffer);
        return false;
    }

    if ( numBytesToRead != audioDataByteCount )
    {
        fprintf( stderr, "Tried to read %lld bytes from the audio file but only got %d bytes\n", audioDataByteCount, numBytesToRead );
        free(buffer);
        return false;
    }

    *freq = basicDescription.mSampleRate;
    *size = audioDataByteCount;
    *format = alFormat;
    *data = buffer;
    *estimatedDurationOut = estimatedDuration;

    return true;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-08T18:50:12.393

使用[Audio Services](https://developer.apple.com/documentation/audiotoolbox/audio_file_services?language=objc)`AudioFileReadBytes`中的功能。示例可以在[Finch 声音引擎](https://github.com/zoul/Finch/)中找到，参见[Sound+IO](https://github.com/zoul/Finch/blob/e77282ed7eb80e442ea7e811abe327b619e685b1/Source/Sound+IO.m)类别。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-30T14:00:47.807

这可能是一个明显的建议，但由于您没有提及它：您是否按照[Apple 的技术](http://developer.apple.com/qa/qa2006/qa1504.html)说明中的建议尝试了[http://www.openal.org/](http://www.openal.org/)上的库？

至于示例代码如何链接和构建，它不是找到原型（如果你打开 -Wall，你会得到一个隐式函数声明警告），而是 OpenAL.framework——至少在他们使用的 SDK 中示例项目——实际上导出 _alutLoadWAVFile，您可以使用 nm 检查。您得到的确切链接错误是什么，您使用的是什么 SDK？

# c# - 从 DataTable 填充 WinForms TreeView

> ID：805457
> 
> 赞同：14
> 
> 时间：2009-04-30T05:31:34.037
> 
> 标签：c#, .net, winforms, recursion, treeview

我有一个 WinForm TreeView 控件，它显示 CaseNotes 的父子关系（我知道这对你们大多数人来说毫无意义，但它可以帮助我将答案可视化）。

我有一个需要显示的 CaseNotes 的数据表。Parent/Child 定义为：如果行有 ParentNoteID，则它是该注释的 childNode，否则它是 rootNode。如果另一行的 ID 与 ParentNoteID 相同，它也可能是父注释（但不是根节点）。

为了使事情复杂化（也许简化），我有下面的工作（主要）代码交替着色节点。我为树视图手动创建了一个静态集合，它为它们着色相当正确。现在我需要从我的 DataTable 中动态填充节点。

由于我已经逐个节点地通过树视图节点，我不应该能够以某种方式将数据附加到这个过程中吗？也许我需要先构建节点，然后将颜色作为一个单独的例程，但递归方法仍然适用，对吗？

假设我想为每个节点显示 CaseNoteID。它在 DataTable 中返回并且是唯一的。

```
foreach (TreeNode rootNode in tvwCaseNotes.Nodes)
        {
            ColorNodes(rootNode, Color.MediumVioletRed, Color.DodgerBlue);

        }
protected void ColorNodes(TreeNode root, Color firstColor, Color secondColor)
    {
        root.ForeColor = root.Index % 2 == 0 ? firstColor : secondColor;

        foreach (TreeNode childNode in root.Nodes)
        {
            Color nextColor = childNode.ForeColor = childNode.Index % 2 == 0 ? firstColor : secondColor;

            if (childNode.Nodes.Count > 0)
            {
                // alternate colors for the next node
                if (nextColor == firstColor)
                    ColorNodes(childNode, secondColor, firstColor);
                else
                    ColorNodes(childNode, firstColor, secondColor);
            }
        }
    } 
```

## 编辑

到目前为止我的想法/尝试：

```
 public void BuildSummaryView()
    {
        tvwCaseNotes.Nodes.Clear();

        DataTable cNotesForTree = CurrentCaseNote.GetAllCNotes(Program._CurrentPerson.PersonID);
        foreach (var cNote in cNotesForTree.Rows)
        {

            tvwCaseNotes.Nodes.Add(new TreeNode("ContactDate"));
        }
        FormPaint();
    } 
```

显然这是有缺陷的。它只是一遍又一遍地显示的 ContactDate。当然，它显示正确的次数，但我想要 ContactDate 的值（它是数据库中的一个列，并在 DataTable 中返回。其次，我需要添加 ChildNode 逻辑。A`if (node.parentNode = node.CaseNoteID) blah...`

## 编辑 2

所以我在[这里](http://msdn.microsoft.com/en-us/library/system.windows.forms.treeview.beginupdate(VS.85).aspx)找到了这个链接，这让我觉得我需要将我的 DataTable 放入一个 ArrayList 中。那是对的吗？

## 编辑 3

好的，感谢 Cerebus，这主要是有效的。我还有一个问题。这个怎么办-->

```
DataTable cNotesForTree = CurrentCaseNote.GetAllCNotes(Program._CurrentPerson.PersonID); 
```

并在此使用我返回的 DataTable？我只是替换这个-->

```
 dt = new DataTable("CaseNotes");
dt.Columns.Add("NoteID", typeof(string));
dt.Columns.Add("NoteName", typeof(string));
DataColumn dc = new DataColumn("ParentNoteID", typeof(string));
dc.AllowDBNull = true;
dt.Columns.Add(dc);

// Add sample data.
dt.Rows.Add(new string[] { "1", "One", null });
dt.Rows.Add(new string[] { "2", "Two", "1" });
dt.Rows.Add(new string[] { "3", "Three", "2" });
dt.Rows.Add(new string[] { "4", "Four", null });
dt.Rows.Add(new string[] { "5", "Five", "4" });
dt.Rows.Add(new string[] { "6", "Six", null });
dt.Rows.Add(new string[] { "7", "Seven", null });
dt.Rows.Add(new string[] { "8", "Eight", "7" });
dt.Rows.Add(new string[] { "9", "Nine", "8" }); 
```

我想我的困惑是我还需要做 Column.Add 和 Row.Adds 吗？另外 DataColumn 将如何转换为我的真实数据结构？对于非常无知的问题，我很抱歉，好消息是我永远不必问两次。

## 编辑 4

以下提供了运行时错误。

```
if (nodeList.Find(FindNode) == null)
  {
    DataRow[] childRows = dt.Select("ParentNoteID = " + dr["NoteID"]);
    if (childRows.Length > 0)
    {
      // Recursively call this function for all childRowsl
      TreeNode[] childNodes = RecurseRows(childRows);

      // Add all childnodes to this node.
      node.Nodes.AddRange(childNodes);
    }

    // Mark this noteID as dirty (already added).
    //doneNotes.Add(noteID);
    nodeList.Add(node);
  } 
```

错误如下 -->***找不到列 [ea8428e4]***这是正确 NoteID 的前 8 位数字（我必须使用 Guid）。它应该寻找该名称的列吗？因为我使用的是 Guid，我还需要做些什么吗？我将我的所有引用和您的代码更改为 Guid ...

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-01T09:39:36.910

为了尝试解决这个问题，我创建了一个示例 windows 窗体并编写了以下代码。我设想的数据表设计如下：

```
 NoteID  NoteName  ParentNoteID
   "1"    "One"        null
   "2"    "Two"        "1"
   "3"    "Three"      "2"
   "4"    "Four"       null
... 
```

这应该创建一棵树（*对不起，我不太擅长 ASCII 艺术！*）：

```
One
 |
 ——Two
 |
 ————Three
 |
Four 
```

伪代码是这样的：

1.  遍历数据表中的所有行。
2.  对于每一行，创建一个 TreeNode 并设置它的属性。递归地对所有具有与该行的 ID 匹配的 ParentNodeID 的行重复该过程。
3.  每次完整的迭代都返回一个节点，该节点将包含所有匹配的无限嵌套子节点。
4.  将完成的节点列表添加到 TreeView。

您的方案中的问题源于“外键”指的是同一个表中的列。这意味着当我们遍历行时，我们必须跟踪哪些行已经被解析。例如，在上表中，匹配第二行和第三行的节点已经在第一次完整迭代中添加。因此，我们不能再次添加它们。有两种方法可以跟踪此情况：

1.  维护已完成的 ID 列表 ( `doneNotes`)。在添加每个新节点之前，请检查该列表中是否存在 noteID。这是更快的方法，通常应该是首选。（*这个方法在下面的代码中被注释掉了*）
2.  对于每次迭代，使用谓词泛型委托 ( `FindNode`) 搜索已添加节点的列表（考虑嵌套节点）以查看该列表中是否存在要添加的节点。这是较慢的解决方案，但我有点喜欢复杂的代码！:P

**好的，这是经过验证的代码（C# 2.0）：**

* * *

```
public partial class TreeViewColor : Form
{
  private DataTable dt;
  // Alternate way of maintaining a list of nodes that have already been added.
  //private List<int> doneNotes;
  private static int noteID;

  public TreeViewColor()
  {
    InitializeComponent();
  }

  private void TreeViewColor_Load(object sender, EventArgs e)
  {
    CreateData();
    CreateNodes();

    foreach (TreeNode rootNode in treeView1.Nodes)
    {
      ColorNodes(rootNode, Color.MediumVioletRed, Color.DodgerBlue);
    }
  }

  private void CreateData()
  {
    dt = new DataTable("CaseNotes");
    dt.Columns.Add("NoteID", typeof(string));
    dt.Columns.Add("NoteName", typeof(string));
    DataColumn dc = new DataColumn("ParentNoteID", typeof(string));
    dc.AllowDBNull = true;
    dt.Columns.Add(dc);

    // Add sample data.
    dt.Rows.Add(new string[] { "1", "One", null });
    dt.Rows.Add(new string[] { "2", "Two", "1" });
    dt.Rows.Add(new string[] { "3", "Three", "2" });
    dt.Rows.Add(new string[] { "4", "Four", null });
    dt.Rows.Add(new string[] { "5", "Five", "4" });
    dt.Rows.Add(new string[] { "6", "Six", null });
    dt.Rows.Add(new string[] { "7", "Seven", null });
    dt.Rows.Add(new string[] { "8", "Eight", "7" });
    dt.Rows.Add(new string[] { "9", "Nine", "8" });
  }

  private void CreateNodes()
  {
    DataRow[] rows = new DataRow[dt.Rows.Count];
    dt.Rows.CopyTo(rows, 0);
    //doneNotes = new List<int>(9);

    // Get the TreeView ready for node creation.
    // This isn't really needed since we're using AddRange (but it's good practice).
    treeView1.BeginUpdate();
    treeView1.Nodes.Clear();

    TreeNode[] nodes = RecurseRows(rows);
    treeView1.Nodes.AddRange(nodes);

    // Notify the TreeView to resume painting.
    treeView1.EndUpdate();
  }

  private TreeNode[] RecurseRows(DataRow[] rows)
  {
    List<TreeNode> nodeList = new List<TreeNode>();
    TreeNode node = null;

    foreach (DataRow dr in rows)
    {
      node = new TreeNode(dr["NoteName"].ToString());
      noteID = Convert.ToInt32(dr["NoteID"]);

      node.Name = noteID.ToString();
      node.ToolTipText = noteID.ToString();

      // This method searches the "dirty node list" for already completed nodes.
      //if (!doneNotes.Contains(doneNoteID))

      // This alternate method using the Find method uses a Predicate generic delegate.
      if (nodeList.Find(FindNode) == null)
      {
        DataRow[] childRows = dt.Select("ParentNoteID = " + dr["NoteID"]);
        if (childRows.Length > 0)
        {
          // Recursively call this function for all childRowsl
          TreeNode[] childNodes = RecurseRows(childRows);

          // Add all childnodes to this node.
          node.Nodes.AddRange(childNodes);
        }

        // Mark this noteID as dirty (already added).
        //doneNotes.Add(noteID);
        nodeList.Add(node);
      }
    }

    // Convert this List<TreeNode> to an array so it can be added to the parent node/TreeView.
    TreeNode[] nodeArr = nodeList.ToArray();
    return nodeArr;
  }

  private static bool FindNode(TreeNode n)
  {
    if (n.Nodes.Count == 0)
      return n.Name == noteID.ToString();
    else
    {
      while (n.Nodes.Count > 0)
      {
        foreach (TreeNode tn in n.Nodes)
        {
          if (tn.Name == noteID.ToString())
            return true;
          else
            n = tn;
        }
      }
      return false;
    }
  }

  protected void ColorNodes(TreeNode root, Color firstColor, Color secondColor)
  {
    root.ForeColor = root.Index % 2 == 0 ? firstColor : secondColor;

    foreach (TreeNode childNode in root.Nodes)
    {
      Color nextColor = childNode.ForeColor = childNode.Index % 2 == 0 ? firstColor : secondColor;

      if (childNode.Nodes.Count > 0)
      {
        // alternate colors for the next node
        if (nextColor == firstColor)
          ColorNodes(childNode, secondColor, firstColor);
        else
          ColorNodes(childNode, firstColor, secondColor);
      }
    }
  }
} 
```

* * *

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-06-21T12:15:35.100

我为 TreeView 创建了更简单的扩展方法，包括使用新的简单扩展类，该类向 TreeNode 添加了两个有用的属性。

```
 internal class IdNode : TreeNode
    {
        public object Id { get; set; }
        public object ParentId { get; set; }
    }

    public static void PopulateNodes(this TreeView treeView1, DataTable dataTable, string name, string id, string parentId)
    {
        treeView1.BeginUpdate();
        foreach (DataRow row in dataTable.Rows)
        {
            treeView1.Nodes.Add(new IdNode() { Name = row[name].ToString(), Text = row[name].ToString(), Id = row[id], ParentId = row[parentId], Tag = row });
        }
        foreach (IdNode idnode in GetAllNodes(treeView1).OfType<IdNode>())
        {
            foreach (IdNode newparent in GetAllNodes(treeView1).OfType<IdNode>())
            {
                if (newparent.Id.Equals(idnode.ParentId))
                {
                    treeView1.Nodes.Remove(idnode);
                    newparent.Nodes.Add(idnode);
                    break;
                }
            }
        }
        treeView1.EndUpdate();
    }

    public static List<TreeNode> GetAllNodes(this TreeView tv)
    {
        List<TreeNode> result = new List<TreeNode>();
        foreach (TreeNode child in tv.Nodes)
        {
            result.AddRange(GetAllNodes(child));
        }
        return result;
    }
    public static List<TreeNode> GetAllNodes(this TreeNode tn)
    {
        List<TreeNode> result = new List<TreeNode>();
        result.Add(tn);
        foreach (TreeNode child in tn.Nodes)
        {
            result.AddRange(GetAllNodes(child));
        }
        return result;
    } 
```

感谢[modiX](https://stackoverflow.com/users/1540350/modix)提供的获取所有（嵌套）节点的[方法。](https://stackoverflow.com/a/24856090/2572796)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2011-10-04T06:18:27.777

检查这个：

```
Public Sub BuildTree(ByVal dt As DataTable, ByVal trv As TreeView, ByVal expandAll As [Boolean])
    ' Clear the TreeView if there are another datas in this TreeView
    trv.Nodes.Clear()
    Dim node As TreeNode
    Dim subNode As TreeNode
    For Each row As DataRow In dt.Rows
        'search in the treeview if any country is already present
        node = Searchnode(row.Item(0).ToString(), trv)
        If node IsNot Nothing Then
           'Country is already present
            subNode = New TreeNode(row.Item(1).ToString())
            'Add cities to country
            node.Nodes.Add(subNode)
        Else
            node = New TreeNode(row.Item(0).ToString())
            subNode = New TreeNode(row.Item(1).ToString())
            'Add cities to country
            node.Nodes.Add(subNode)
            trv.Nodes.Add(node)
        End If
    Next
    If expandAll Then
        ' Expand the TreeView
        trv.ExpandAll()
    End If
End Sub 
```

有关更多和完整的源代码：[如何从 vb.net 中的数据表填充树视图](http://www.authorcode.com/create-treeview-from-datatable-using-vb-net/)

# c# - 如何保护dll？

> ID：805461
> 
> 赞同：15
> 
> 时间：2009-04-30T05:32:41.087
> 
> 标签：c#, dll

如何保护我的项目的 dll，使其无法被其他人引用和使用？

谢谢

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-04-30T05:43:38.547

简短的回答是，除了显而易见的事情之外，您无能为力。

您可能需要考虑的显而易见的事情（大致按照难度增加和合理性降低的顺序）包括：

*   静态链接，因此没有 DLL 可以攻击。
*   剥离所有符号。
*   使用一个 .DEF 文件和一个导入库，只允许匿名导出，只知道它们的导出 ID。
*   将 DLL 保存在资源中并仅在运行时将其公开在文件系统中（以适当的晦涩名称，甚至可能在运行时生成）。
*   将所有真实函数隐藏在一个工厂方法后面，该工厂方法用一个指向真实方法的函数指针表交换秘密（更好的是，秘密知识的证明）。
*   使用从恶意软件世界借来的反调试技术来防止逆向工程。（请注意，这可能会让您从 AV 工具中得到误报。）

无论如何，一个足够坚定的用户仍然可以找到使用它的方法。一个体面的反汇编程序将迅速提供所需的所有信息。

请注意，如果您的 DLL 确实是一个 COM 对象，或者更糟糕的是 CLR 程序集，那么在不破坏其预期用途的情况下，您无法剥离大量运行时类型信息。

**编辑：**由于您已经重新标记以暗示 C# 和 .NET 是环境而不是用 C 编写的纯 Win32 DLL，那么我真的应该将上面的内容修改为“你不能，但是......”

长期以来，混淆工具一直存在市场，以处理强制交付可编译源但您不想交付有用源的环境。有 C# 产品在那个市场上发挥作用，而且看起来至少有一种产品已经加入进来。

因为加载一个程序集需要框架付出如此多的努力，所以很可能有一些权限位对程序集的诚实提供者和消费者施加一些控制。我没有看到任何关于这些方法提供的真正安全性的讨论，并且根本不知道它们对确定的攻击有多有效。

很多将取决于您的用例。如果您只是想防止随意使用，您可能会找到适合您的解决方案。如果您想保护有价值的商业机密免遭逆向工程和重用，您可能不会那么高兴。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-04-30T05:45:15.860

您面临与 DRM 支持者相同的问题。

如果*您的*程序（您希望能够运行 DLL）可以由某个用户帐户运行，那么**没有什么可以阻止可以以该用户身份登录的足够确定的程序员隔离执行解密的代码并使用用于解密您的 DLL 并运行它。**

当然，您可以不方便地执行此逆向工程，这可能就足够了。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-30T05:43:17.113

看看[StrongNameIdentityPermissionAttribute](http://msdn.microsoft.com/en-us/library/system.security.permissions.strongnameidentitypermissionattribute.aspx)。它将允许您声明对程序集的访问权限。结合一个好的代码保护工具（比如[CodeVeil](http://www.codeveil.com)（免责声明我卖 CodeVeil））你会很高兴的。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-30T05:38:12.897

您可以将其嵌入到您的可执行文件中，并在运行时提取和加载库并调用它。或者您可以使用某种共享密钥来加密/解密随附的文件并执行上述相同操作。

我假设您已经考虑过像编译它这样的解决方案，如果您真的不想共享它。如果有人真的想达到它，有很多方法可以做到。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-08-25T08:19:29.333

你试过.Net反应堆吗？我最近遇到了它。有人说它很棒，但我仍在测试它。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-30T07:52:04.603

好吧，您可以将所有“公共”类标记为“内部”或“受保护的内部”，然后使用 [assembly:InternalsVisibleTo("")] 属性标记您的程序集，除了标记的程序集之外没有人可以看到内容。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-30T05:49:17.287

您可能对以下有关 Friend 程序集的信息感兴趣：http: [//msdn.microsoft.com/en-us/library/0tke9fxk (VS.80).aspx](http://msdn.microsoft.com/en-us/library/0tke9fxk(VS.80).aspx)

# xml - 导入的空白 xmlns="" 属性

> ID：805462
> 
> 赞同：4
> 
> 时间：2009-04-30T05:34:37.167
> 
> 标签：xml, xslt, xml-namespaces

我正在尝试对 XML 文档进行转换。根据某个元素的值，我的 XML 转换可能会产生两种不同类型的基本元素：

```
<xsl:template match="/">
  <xsl:choose>
    <xsl:when test="/databean/data[@id='pkhfeed']/value/text()='200'">
      <xsl:call-template name="StructureA">
        <xsl:with-param name="structure" select="//databean" />
      </xsl:call-template>
    </xsl:when>
    <xsl:otherwise>
      <xsl:call-template name="StructureB">
        <xsl:with-param name="structure" select="//databean" />
      </xsl:call-template>
    </xsl:otherwise>
  </xsl:choose>
</xsl:template> 
```

然后使用自己的命名空间和 schemaLocations 创建 StructureA 或 StructureB：

```
<StructureA xmlns="http://..."> 
```

StructureA 和 B 共享一些公共元素，因此这些元素在一个名为“xmlcommon.xslt”的单独文件中定义，这两个结构都包含来自其中的模板。这个 xmlcommon 文件没有定义默认命名空间，因为我希望它可以从 StructureA 或 StructureB 中定义的命名空间中使用。但是当我运行我的转换时，从公共文件中提取的任何模板都会导致空白 xmlns 属性：

```
<StructureA xmlns="http://...">
  <SharedElement xmlns="">Something</SharedElement>
</StructureA> 
```

验证时，然后使用空白命名空间而不是正确的父命名空间。 **有谁知道如何阻止我的通用文件中的模板添加那些空白的 xmlns 属性？**

这是来自公共文件的片段：

```
<xsl:stylesheet version="1.0" xmlns:fn="http://www.w3.org/2005/02/xpath-functions" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

  <xsl:template name="ControlledListStructure">
    <xsl:param name="xmlElem" />
    <xsl:param name="structure" />

    <xsl:element name="{$xmlElem}">
      <!-- Blah blah blah -->
    </xsl:element>
  </xsl:template>
</xsl:stylesheet> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-30T07:23:03.583

要意识到的关键是您的样式表规定了您添加到结果树中的每个元素的名称。元素的名称有两部分：本地名称和命名空间 URI。在上面的代码中，您提供了本地名称（ 的值`$xmlElem`），但您没有指定命名空间 URI，这意味着它将默认为空字符串。（实际上，它采用该样式表模块的默认命名空间；因为没有，所以它是空字符串。）换句话说，该元素将*不在命名空间*中。序列化文档时，XSLT 处理器必须包含`xmlns=""`取消声明以取消声明出现在顶部的默认命名空间。否则，该元素将采用该名称空间，这不是您的样式表所规定的。解决此问题的最少侵入性方法是添加另一个参数（例如`$namespaceURI`），就像您使用`$xmlElem`. 然后你会写：

```
<xsl:element name="{$xmlElem}" namespace="{$namespaceURI}"> 
```

现在，生成的元素将采用您告诉它采用的任何命名空间（这将具有删除那些默认命名空间取消声明的效果）。

那应该回答你的问题。我提供以下免费奖励材料。;-)

您应该在值比较中删除`text()`节点测试。您很少需要直接比较文本节点的值。相反，您可以只比较元素本身的字符串值（定义为其所有后代文本节点的字符串值的串联）。看起来像这样：

```
<xsl:when test="/databean/data[@id='pkhfeed']/value = '200'"> 
```

这样做的好处是，如果其中隐藏了注释，您的代码不会中断：

```
<value>2<!--test-->00</value> 
```

在这种情况下，有两个文本节点（“2”和“00”）。您的原始测试将失败，因为它会检查其中是否有任何一个等于“200”。在这种情况下不太可能发生，但无论如何测试元素的字符串值（而不是其文本节点子节点）是一种很好的做法，如果这是您的意图。

最后，我鼓励您了解模板规则和 XPath 上下文。我倾向于避免`<xsl:choose>`, `<xsl:call-template>`, 和`<xsl:with-param>`尽可能。一方面，模板规则可以帮助您避免 XSLT 中许多丑陋、冗长的部分。

```
<xsl:template match="/databean[data[@id='pkhfeed']/value = '200']" priority="1">
  <StructureA xmlns="http://...">
    ...
  </StructureA>
</xsl:template>

<xsl:template match="/databean">
  <StructureB xmlns="http://...">
    ...
  </StructureB>
</xsl:template> 
```

即使您继续使用`<xsl:call-template>`，也不必传递该`$structure`参数，因为当前节点在被调用模板中将保持不变。您可以从您的或模板中轻松访问`//databean`（或`/databean`，我怀疑这是您的意思），因为当前节点仍将是“/”（文档节点）。`StructureA``StructureB`

如果您有兴趣进一步了解 XSLT 的核心处理模型及其最强大的特性（模板规则），那么我鼓励您查看[“XSLT 工作原理” ，这是我的](http://lenzconsulting.com/how-xslt-works)*XSLT 1.0 袖珍参考*中的免费示例章节。

我希望这对您有所帮助，即使它超出了您的预期！

# javascript - javascript 检查浏览器窗口何时关闭

> ID：805463
> 
> 赞同：19
> 
> 时间：2009-04-30T05:35:06.570
> 
> 标签：javascript

有谁知道我可以使用javascript检查浏览器窗口何时关闭并弹出一个确认对话框询问用户是否确认退出浏览器或改变主意留下？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-04-30T05:39:41.270

```
window.onbeforeunload = function (e) {
  var e = e || window.event;

  //IE & Firefox
  if (e) {
    e.returnValue = 'Are you sure?';
  }

  // For Safari
  return 'Are you sure?';
}; 
```

[https://developer.mozilla.org/en/DOM/window.onbeforeunload](https://developer.mozilla.org/en/DOM/window.onbeforeunload)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-05-14T01:32:13.533

[此处](https://developer.mozilla.org/en/DOM/window.onbeforeunload)的文档鼓励监听`onbeforeunload` *事件*和/或在`window`.

```
window.addEventListener('beforeunload', function(e) {}, false); 
```

您也可以只使用*函数*或*函数引用*`.onunload`填充或的`.onbeforeunload`属性。`window`

 **尽管跨浏览器的行为没有标准化，但该*函数*可能会返回一个值，浏览器在确认是否离开页面时将显示该值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-30T05:39:54.733

如果页面关闭后浏览器仍在运行，并且浏览器处理 body 元素的“ ***onbeforeunload*** ”事件（有时它被禁用），并且浏览器允许弹出窗口或消息框以及从该事件返回 false 的能力为了防止页面更改，那么它是可能的。

例如，开始在任何启用了 Javascript 的 stackoverflow 页面上输入评论，然后离开该页面。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-03-20T10:57:18.820

这对我有用：

```
function closeWin(){
 var exit = confirm("Do you want to leave this window?");  
     if(exit==true){
        //do something before closing;
     }
}    

body onbeforeunload="closeWin()" 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-08T20:14:05.063

这也有效，除非 IE8

```
$(window).bind('beforeunload', function (e) {
        // code to execute when browser is closed
        e.$.post("func.php", { action: 'action', id_userMsg: '<?php echo $id_user; ?>' });      

    }); 
```

# jmx - 谁能告诉我如何使用 jconsole 值生成邮件

> ID：805476
> 
> 赞同：0
> 
> 时间：2009-04-30T05:43:14.290
> 
> 标签：jmx

我已将 jconsole 配置为查看 jvm 运行状况。我想用 jvm 静态数据（由 jconsole 显示）向订阅者发送电子邮件，谁能告诉我如何执行此操作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-30T22:17:24.993

您可以尝试[JRockit](http://www.oracle.com/technology/products/jrockit/missioncontrol/index.html)附带的管理控制台。它的工作原理与 JConsole 类似，但它允许您创建触发器，当 JMX 属性在特定时间段内超过阈值时可以发送电子邮件。有关详细信息，请参阅此[文档](http://download.oracle.com/docs/cd/E13150_01/jrockit_jvm/jrockit/tools/jmcpdfs/mc3/consnotify3.pdf)。

# web-services - 模拟 Web 服务的策略

> ID：805480
> 
> 赞同：1
> 
> 时间：2009-04-30T05:44:13.943
> 
> 标签：web-services, unit-testing, junit, mocking, mockito

我正在实现一个使用 Web 服务的客户端。我想减少依赖并决定模拟网络服务。
我使用[mockito](http://code.google.com/p/mockito/)，它与 EasyMock 相比具有能够模拟类的优势，而不仅仅是接口。但这不是重点。

在我的测试中，我有这个代码：

```
// Mock the required objects
Document mDocument = mock(Document.class);
Element mRootElement = mock(Element.class);
Element mGeonameElement = mock(Element.class);
Element mLatElement = mock(Element.class);
Element mLonElement = mock(Element.class);

// record their behavior
when(mDocument.getRootElement()).thenReturn(mRootElement);
when(mRootElement.getChild("geoname")).thenReturn(mGeonameElement);
when(mGeonameElement.getChild("lat")).thenReturn(mLatElement);
when(mGeonameElement.getChild("lon")).thenReturn(mLonElement);
// A_LOCATION_BEAN is a simple pojo for lat & lon, don't care about it!
when(mLatElement.getText()).thenReturn(
    Float.toString(A_LOCATION_BEAN.getLat()));
when(mLonElement.getText()).thenReturn(
    Float.toString(A_LOCATION_BEAN.getLon()));

// let it work!
GeoLocationFetcher geoLocationFetcher = GeoLocationFetcher
    .getInstance();
LocationBean locationBean = geoLocationFetcher
    .extractGeoLocationFromXml(mDocument);

// verify their behavior
verify(mDocument).getRootElement();
verify(mRootElement).getChild("geoname");
verify(mGeonameElement).getChild("lat");
verify(mGeonameElement).getChild("lon");
verify(mLatElement).getText();
verify(mLonElement).getText();

assertEquals(A_LOCATION_BEAN, locationBean); 
```

我的代码显示的是我“微测试”消费对象。就像我会在我的测试中实现我的生产代码一样。结果 xml 的一个示例是[London on GeoNames](http://ws.geonames.org/search?q=london&maxRows=1)。在我看来，它太细了。

但是我怎样才能在不给出每一步的情况下模拟一个 web 服务呢？我应该让模拟对象只返回一个 XML 文件吗？

这不是关于代码，而是关于*方法*。

我正在使用 JUnit 4.x 和 Mockito 1.7

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T16:48:45.997

我认为这里真正的问题是您有一个调用和创建 Web 服务的单例，因此很难插入一个模拟的。

您可能必须添加（可能是包级别）对单例类的访问权限。例如，如果构造函数看起来像

```
private GeoLocationFactory(WebService service) {
   ...
} 
```

您可以制作构造函数包级别，只需使用模拟的 Web 服务创建一个。

或者，您可以通过添加一个 setter 方法来设置 web 服务，尽管我不喜欢可变单例。同样在这种情况下，您必须记住之后取消设置网络服务。

如果 web 服务是在一个方法中创建的，您可能必须使 GeoLocationFactory 可扩展以替代模拟服务。

您也可以考虑删除单例本身。网上有文章，可能这里有关于如何做到这一点的文章。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-30T05:53:44.233

你真的想模拟从 web 服务返回的结果到将使用结果的代码。在上面的示例代码中，您似乎在模拟 mDocument，但您确实想传入从 web 服务的模拟实例返回的 mDocument 实例，并断言从 geoLocationFetcher 返回的 locationBean 与 A_LOCATION_BEAN 的值匹配。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-01-27T15:13:27.667

最简单的选择是模拟 WebService 客户端，

```
when(geoLocationFetcher.extractGeoLocationFromXml(anyString()))
    .thenReturn("<location/>"); 
```

您可以修改代码以从文件系统中读取响应 xml。

示例代码可以在这里找到：[Mocking .NET WebServices with Mockito](http://www.texient.com/2012/01/mock-webservice-mockito-example-client.html)

# macos - 无法在 Zsh 中完成 MacPorts 的选项卡

> ID：805484
> 
> 赞同：6
> 
> 时间：2009-04-30T05:45:32.710
> 
> 标签：macos, zsh, macports, tab-completion

[在将MacPorts 的 Bash 选项卡完成](https://stackoverflow.com/questions/764476/unable-to-make-a-tab-completion-file-for-macports-in-bash)包含到 Zsh中时，我得到以下信息

```
/opt/local/etc/bash_completion:[:48: unrecognized condition: `2'
[ -- cut -- ]
/opt/local/etc/bash_completion:[:62: unrecognized condition: `2'
/opt/local/etc/bash_completion:69: command not found: shopt
[ -- cut -- ]
/opt/local/etc/bash_completion:3015: command not found: complete
/opt/local/etc/bash_completion:3062: parse error near `&&' 
```

**如何在 Zsh 中完成 MacPorts 的选项卡？**

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-30T06:07:24.200

您可能想尝试[zsh](http://zsh.sourceforge.net/Doc/Release/zsh_19.html)的 zsh 补全。`bash_completion`是为 Bash 设计的，令人惊讶的是。

**编辑**听起来您可能正在专门寻找对`port`命令的完成支持。看起来 MacPorts`zsh`包有一个变体，可以为命令`+mp_completion`安装补全：`port`

```
sudo port install zsh +mp_completion 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-04-17T17:24:25.053

唤醒那个老问题，我刚刚发现做了一些研究，提到了用于 OSX 的美妙的[oh-my-zsh](https://github.com/robbyrussell/oh-my-zsh)实用程序，它可以轻松地为移植带来标签完成以及许多其他好东西。必须有恕我直言:)

# c++ - 从哪里开始使用 FastCGI 和 C++

> ID：805487
> 
> 赞同：6
> 
> 时间：2009-04-30T05:46:29.773
> 
> 标签：c++, apache, fastcgi

任何人都有关于编写正确的 C++ FastCGI 应用程序的链接或资源吗？（在 Apache 之上使用 mod_fastcgi 或 mod_fcgid）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2011-06-15T22:52:12.673

我建议你[fastcgi++](http://www.nongnu.org/fastcgipp/)，它是 FDK 的替代品。

它更易于使用并且采用 C++ 方式。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-30T07:39:49.283

显而易见的是[FastCGI 开发工具包](http://www.fastcgi.com/drupal/node/5)（用于 C/C++）。

# c# - 列表框中的语法高亮

> ID：805493
> 
> 赞同：0
> 
> 时间：2009-04-30T05:48:48.643
> 
> 标签：c#, .net, winforms, user-interface

我在网上搜索过，似乎找不到任何对我有用的东西。对于提供行号和语法突出显示的代码编辑器，我已经看到了大量的讨论，甚至还有一些相当可扩展的开源工具。

这是我的困境...

我正在使用 C#.NET 开发一个“数字代码审查”项目，该项目允许用户指定源文件，将它们添加到特定会话，其他用户可以对正在审查的文件进行评论和行引用。

基本要求：

*   必须用 C#.NET 编写
*   我不需要能够编辑文本框中的文本
*   用户需要能够选择一条线（或多条线），以进行线参考。

在我看来，我需要一些花哨的 ListBox 控件（不是下拉列表）实现，它具有一些 OwnerDraw 功能来添加行号和语法突出显示。不幸的是，我自己没有任何运气将它放在一起，而且我似乎找不到已经编写好的控件或关于我如何能够完成此操作的参考。

有什么建议么？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-30T05:59:33.843

我建议尝试[ScintillaNet](http://scintillanet.codeplex.com/)。它有语法高亮和行号（等等）。但是，您一次不能只选择一个选项来选择更多行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-30T06:53:28.973

我会为此使用文本框控件，只需将其设为只读并在加载时输入行号。只是一个简单的问题，当你说：

用户需要能够选择一条线（或多条线），以进行线参考。

这是在网络应用程序中吗？用户如何表明他们想要创建参考（某处的某个按钮？）。使用上下文菜单在 Windows 上更容易操作。用户对代码的引用去了哪里，其他查看代码的用户如何看待它？

# joomla - 确定正在查看的部分

> ID：805495
> 
> 赞同：0
> 
> 时间：2009-04-30T05:49:39.047
> 
> 标签：joomla

伙计们，我正在尝试在 Joomla 中实现一个基本功能，但我没有运气。

我的客户已经为 Joomla 设置了几个部分；每个部分都有自己的类别和最终内容。

我需要每个部分都有一个稍微不同的颜色分量（例如，A 部分及其所有后续子页面红色，B 部分 - 蓝色等）；根据每个部分，某些边框和背景需要是唯一的。

我有一个所有部分都使用的主题。在主题文件的某处，我需要检测我所在的部分，并根据该部分相应地设置一个 css 变量：

```
<html>
    <body class="cars-section">

    </body>
</html> 
```

我所需要的只是将我的身体类别设置到正确的部分，并且我的所有颜色都已设置为可以神奇地工作。

任何想法如何在 Joomla 世界中做到这一点？有没有另一种方法来做这样的事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T15:13:42.357

您需要从请求中选择部分 ID。

使用它来获取相关的请求变量：

```
<?php
$option = JRequest::getWord('option', null);
$view = JRequest::getWord('view', null);
$idalias = JRequest::getVar('id', null);
if (strpos($idalias, ":") != false) {
    $idandalias = explode(":", $idalias);
    $id = $idandalias[0];
} else {
    $id = JRequest::getInt ('id' , 0);
} 
```

然后使用类似这样的东西来查看你所在的部分，如果你在一个部分页面上：

```
if ( $option=="com_content" && $view=="section" ) {
  $sectid = $id;
} 
```

在部分页面中，您可以只使用请求，但在其他页面中，您也需要执行数据库查询：

```
else {
  $database =& JFactory::getDBO();
  if ( $option=="com_content" && $view=="category" ) {
    $query = "SELECT section FROM jos_categories WHERE id=$id";
  }
  if ( $option=="com_content" && $view=="article" } {
    $query = "SELECT sectionid FROM jos_content WHERE id=$id";
  }
  $database->setQuery($query);
  $sectid = $database->loadResult();
} 
```

当您拥有部分 ID 时，您可以使用它来设置和插入正确的类。

```
if ( $sectid == '3' ) {
  $my_cars_section_class = 'three';
}
?>
<body class="<?php echo $my_cars_section_class; ?>"> 
```

应该这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-30T06:06:39.320

有几种方法可以实现 body css-classing：

1.  利用 Joomla 的菜单页面类后缀系统。
2.  根据模板中选定的菜单链接输出类。当然，如果您打算这样做，则需要稍微修改您的模板。

    $menu = &JSite::getMenu();
    $active = $menu->getActive();
    <body <?php if($active->alias) echo 'class="' .$active->alias .'"' ?>>

# design-patterns - 寻找特定的设计模式

> ID：805496
> 
> 赞同：1
> 
> 时间：2009-04-30T05:51:45.550
> 
> 标签：design-patterns

我正在寻找描述某种情况的模式。也许有人知道一些事情，可以给我一个提示

**Situation**类型 A 的对象，1 : n 与类型 B 的对象的关联。示例：A 人和他的所有宠物。宠物对象有一个年龄数据成员。现在每个人都应该有一个关于他的宠物平均年龄的数据成员。我不希望保存和加载这些信息，而是在加载过程中计算（所有必要的信息都已经存在，所以有点多余，但我想要 person 对象中的信息）。

**问题**那么我怎样才能以面向对象的方式做到这一点呢？是否有描述这种情况的模式？我的第一个想法是创建一个类 ComputedFieldsUpdater，它接受一个宠物对象，然后计算所有尚未加载的字段。但我想知道这是否是正确的方法，或者是否有更优雅的解决方案？

谢谢你的想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-30T05:57:12.057

如果您为关联创建一个类以键入 B，这相当简单：无论如何您都需要某种列表。所以只需创建一个“PetList”或类似的东西，它有一个方法“ `averageAge()`”，它从它的所有宠物中计算这个值。

现在您可以通过调用来访问平均值`person.getPets().averageAge()`。

从面向对象的角度来看，关于平均值的信息不应该直接存在于 Person-object 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-30T05:59:58.790

它不是四人组设计模式，但是当*绝对需要*存储计算冗余的数据时，普遍接受的解决方案是延迟加载它，然后保留一个布尔值来描述它是否仍然有效。

换句话说：

```
class Person
{
List<Pet> myPets;
float averageAge;
boolean isAgeValid = false;

float getAverageAge()
{
    if(isAgeValid)
        return averageAge;
    else
        ...calculate age, save it in averageAge, set bool to true, and return derived float...
}

//all list operations should mark the bool false
void Add(Pet p)
{
    myPets.Add(p);
    isAgeValid=false;
}
} 
```

# iphone - CATransaction 没有动画

> ID：805502
> 
> 赞同：2
> 
> 时间：2009-04-30T05:54:39.177
> 
> 标签：iphone, objective-c, cocoa-touch, core-animation

我在 XCode 中创建了一个新的基于视图的应用程序。

在 ViewController 中，我修改的唯一代码如下所示：

```
- (void)viewDidLoad {
[super viewDidLoad];

UIView *newView = [[UIView alloc] initWithFrame:CGRectMake(0, 0, 200, 200)];
newView.backgroundColor = [UIColor redColor];
[self.view addSubview:newView];

[CATransaction begin];
[CATransaction setValue:[NSNumber numberWithFloat:0.5f] forKey:kCATransactionAnimationDuration];

newView.layer.frame = CGRectMake(20,20,220,220);

[CATransaction commit];
} 
```

它应该创建一个红色方块，在应用程序加载后立即动画半秒。问题是它没有动画。我不知道为什么。我创建了这个简单的项目来隔离所有变量，但它仍然不起作用。

任何人都可以帮助或指出一些核心动画阅读材料的正确方向。我已经浏览了苹果的所有东西。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-30T13:09:11.083

如果您在 CALayer 上设置属性（默认情况下它们是动画），您的代码将按预期动画。要使 UIView 动画化，您必须在块中更改它们的属性，如下所示：

```
[UIView beginAnimations:nil context:NULL];
[UIView setAnimationDuration:1.0f];

// Change properties here

[UIView commitAnimations]; 
```

CATransactions 用于对动画进行分组，以便协调它们，或者手动禁用一组对象的动画。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-30T06:00:40.143

*任何人都可以帮助或指出一些核心动画阅读材料的正确方向。我已经浏览了苹果的所有东西。*

请参阅：[Mac OS X 和 iPhone 的核心动画：创建引人注目的动态用户界面](http://www.pragprog.com/titles/bdcora/core-animation-for-mac-os-x-and-the-iphone)，以获得关于视图和图层的核心动画的出色演练。

# c# - c# 将类属性标记为脏

> ID：805505
> 
> 赞同：28
> 
> 时间：2009-04-30T05:56:20.030
> 
> 标签：c#, class, properties, dirty-checking, dirty-tracking

下面是一个简单的枚举示例，它定义了一个对象的状态和一个显示该枚举实现的类。

```
public enum StatusEnum
{
    Clean = 0,
    Dirty = 1,
    New = 2,
    Deleted = 3,
    Purged = 4
}

public class Example_Class
{
    private StatusEnum _Status = StatusEnum.New;

    private long _ID;
    private string _Name;

    public StatusEnum Status
    {
        get { return _Status; }
        set { _Status = value; }
    }

    public long ID
    {
        get { return _ID; }
        set { _ID = value; }
    }

    public string Name
    {
        get { return _Name; }
        set { _Name = value; }
    }
} 
```

当用数据库中的数据填充类对象时，我们将枚举值设置为“clean”。为了将大部分逻辑排除在表示层之外，我们如何在属性更改时将枚举值设置为“脏”。

我在想一些类似的事情；

```
public string Name
{
    get { return _Name; }
    set 
    {
        if (value != _Name)
        {
               _Name = value; 
           _Status = StatusEnum.Dirty;
        }
    }   
} 
```

在类的每个属性的设置器中。

这听起来像一个好主意吗，是否有人对如何分配脏标志有更好的想法，而无需在表示层中这样做。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-04-30T07:00:11.687

When you really do want a dirty flag at the class level (or, for that matter, notifications) - you can use tricks like below to minimise the clutter in your properties (here showing both `IsDirty` and `PropertyChanged`, just for fun).

Obviously it is a trivial matter to use the enum approach (the only reason I didn't was to keep the example simple):

```
class SomeType : INotifyPropertyChanged {
    private int foo;
    public int Foo {
        get { return foo; }
        set { SetField(ref foo, value, "Foo"); }
    }

    private string bar;
    public string Bar {
        get { return bar; }
        set { SetField(ref bar, value, "Bar"); }
    }

    public bool IsDirty { get; private set; }
    public event PropertyChangedEventHandler PropertyChanged;
    protected void SetField<T>(ref T field, T value, string propertyName) {
        if (!EqualityComparer<T>.Default.Equals(field, value)) {
            field = value;
            IsDirty = true;
            OnPropertyChanged(propertyName);
        }
    }
    protected virtual void OnPropertyChanged(string propertyName) {
        var handler = PropertyChanged;
        if (handler != null) {
            handler(this, new PropertyChangedEventArgs(propertyName));
        }
    }
} 
```

You might also choose to push some of that into an abstract base class, but that is a separate discussion

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-04-30T06:03:20.793

一种选择是在写入时更改它；另一种是保留所有原始值的副本，并在有人要求时计算脏值。这有一个额外的好处，您可以准确地知道*哪些*字段已更改（以及以何种方式），这意味着您可以发出最少的更新语句并使合并冲突解决稍微容易一些。

您还可以将所有脏污检查放在一个地方，因此它不会污染您的其余代码。

我并不是说它是完美的，但它是一个值得考虑的选择。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-04-30T07:15:37.813

If you want to implement it in this way, and you want to reduce the amount of code, you might consider applying Aspect Oriented Programming.

You can for instance use a compile-time weaver like [PostSharp](http://www.postsharp.org/) , and create an 'aspect' that can be applied to properties. This aspect then makes sure that your dirty flag is set when appropriate.

The aspect can look like this:

```
[Serializable]
[AttributeUsage(AttributeTargets.Property)]
public class ChangeTrackingAttribute : OnMethodInvocationAspect
{
    public override void OnInvocation( MethodInvocationEventArgs e )
    {
        if( e.Delegate.Method.ReturnParameter.ParameterType == typeof(void) )
        {
              // we're in the setter
              IChangeTrackable target = e.Delegate.Target as IChangeTrackable;

              // Implement some logic to retrieve the current value of 
              // the property
              if( currentValue != e.GetArgumentArray()[0] )
              {
                  target.Status = Status.Dirty;
              }
              base.OnInvocation (e);
        } 
    }  
} 
```

Offcourse, this means that the classes for which you want to implement ChangeTracking, should implement the `IChangeTrackable` interface (custom interface), which has at least the 'Status' property.

You can also create a custom attribute `ChangeTrackingProperty`, and make sure that the aspect that has been created above, is only applied to properties that are decorated with this `ChangeTrackingProperty` attribute.

For instance:

```
public class Customer : IChangeTrackable
{
    public DirtyState Status
    {
        get; set;
    }

    [ChangeTrackingProperty]
    public string Name
    { get; set; }
} 
```

This is a little bit how I see it. You can even make sure that PostSharp checks at compile-time whether classes that have properties that are decorated with the ChangeTrackingProperty attribute, implement the IChangeTrackable interface.

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-05-22T18:56:11.787

此方法基于此线程中提供的一组不同概念。我想我会把它放在那里给任何正在寻找一种干净有效的方法的人，就像我自己一样。

这种混合概念的关键在于：

1.  您不想复制数据以避免膨胀和资源占用；
2.  您想知道对象的属性何时从给定的原始/干净状态更改；
3.  您希望 IsDirty 标志既准确又需要很少的处理时间/功率来返回值；和
4.  您希望能够告诉对象何时再次认为自己是干净的。这在 UI 中构建/工作时特别有用。

鉴于这些要求，这就是我想出的，它似乎对我来说非常有效，并且在处理 UI 和准确捕获用户更改时变得非常有用。我还在下面发布了“如何使用”，向您展示我如何在 UI 中使用它。

**物体**

```
public class MySmartObject
{
    public string Name { get; set; }
    public int Number { get; set; }
    private int clean_hashcode { get; set; }
    public bool IsDirty { get { return !(this.clean_hashcode == this.GetHashCode()); } }

    public MySmartObject()
    {
        this.Name = "";
        this.Number = -1;
        MakeMeClean();

    }

    public MySmartObject(string name, int number)
    {
        this.Name = name;
        this.Number = number;
        MakeMeClean();
    }

    public void MakeMeClean()
    {
        this.clean_hashcode = this.Name.GetHashCode() ^ this.Number.GetHashCode();
    }

    public override int GetHashCode()
    {
        return this.Name.GetHashCode() ^ this.Number.GetHashCode();
    }
} 
```

它很简单，可以满足我们所有的要求：

1.  脏检查的数据不会重复...
2.  这考虑了所有属性更改方案（请参阅下面的方案）...
3.  当您调用 IsDirty 属性时，会执行一个非常简单且小型的 Equals 操作，并且可以通过 GetHashCode 覆盖完全自定义...
4.  通过调用 MakeMeClean 方法，您现在又拥有了一个干净的对象！

当然，您可以对其进行调整以包含一堆不同的状态……这完全取决于您。此示例仅显示如何进行正确的 IsDirty 标志操作。

**场景**
让我们回顾一下这个场景，看看会发生什么：

*   场景 1
    使用空构造函数创建新对象，
    属性名称从 "" 更改为 "James"，
    调用 IsDirty 返回 True！准确的。

*   场景 2
    使用“John”和 12345 的参数创建新对象，
    属性名称从“John”更改为“James”，
    属性名称从“James”更改回“John”，
    调用 IsDirty 返回 False。准确，我们也不必复制数据来做到这一点！

**如何使用，一个 WinForms UI 示例**
[这只是一个示例，您可以通过 UI 以多种不同的方式使用它。]

假设您有两种形式（[A] 和 [B]）。

第一个([A]) 是您的主表单，第二个([B]) 是一个允许用户更改 MySmartObject 中的值的表单。

[A] 和 [B] 表单都声明了以下属性：

```
public MySmartObject UserKey { get; set; } 
```

当用户单击 [A] 表单上的按钮时，会创建 [B] 表单的实例，设置其属性并显示为对话框。

表单 [B] 返回后，[A] 表单根据 [B] 表单的 IsDirty 检查更新其属性。像这样：

```
private void btn_Expand_Click(object sender, EventArgs e)
{
    SmartForm form = new SmartForm();
    form.UserKey = this.UserKey;
    if(form.ShowDialog() == DialogResult.OK && form.UserKey.IsDirty)
    {
        this.UserKey = form.UserKey;
        //now that we have saved the "new" version, mark it as clean!
        this.UserKey.MakeMeClean();
    }
} 
```

此外，在 [B] 中，当它正在关闭时，您可以检查并提示用户是否正在关闭其中未保存更改的表单，如下所示：

```
 private void BForm_FormClosing(object sender, FormClosingEventArgs e)
    {
        //If the user is closing the form via another means than the OK button, or the Cancel button (e.g.: Top-Right-X, Alt+F4, etc).
        if (this.DialogResult != DialogResult.OK && this.DialogResult != DialogResult.Ignore)
        {
            //check if dirty first... 
            if (this.UserKey.IsDirty)
            {
                if (MessageBox.Show("You have unsaved changes. Close and lose changes?", "Unsaved Changes", MessageBoxButtons.YesNo, MessageBoxIcon.Warning) == DialogResult.No)
                    e.Cancel = true;
            }

        }

    } 
```

正如您从上面的示例中看到的那样，这可能是一件非常有用的事情，因为它确实简化了 UI。

**注意事项**

*   每次实现此功能时，您都必须将其自定义为您正在使用的对象。例如：不使用反射就没有“简单”的通用方法......如果使用反射，您会失去效率，尤其是在大型和复杂的对象中。

希望这可以帮助某人。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-30T07:57:43.453

看看 PostSharp ( [http://www.postsharp.org/](http://www.postsharp.org/) )。您可以轻松地创建一个将其标记为脏的属性，您可以将属性添加到需要它的每个属性，并将所有代码保存在一个地方。

粗略地说，创建一个具有您的状态的接口，使该类实现它。创建一个属性，该属性可以应用于属性并强制转换到您的界面，以便在某些内容更改标记的属性之一时设置值。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-30T06:06:36.807

你的方法基本上就是我会怎么做。我只会删除 Status 属性的设置器：

```
public StatusEnum Status
{
    get { return _Status; }
    // set { _Status = value; }
} 
```

而是添加一个功能

```
public SetStatusClean()
{
    _Status = StatusEnum.Clean;
} 
```

以及`SetStatusDeleted()`and `SetStatusPurged()`，因为我发现它更好地表明了意图。

**编辑**

阅读了 [Jon Skeet 的答案后](https://stackoverflow.com/questions/805505/c-marking-class-property-as-dirty/805522#805522)，我需要重新考虑我的方法；-) 对于简单的对象，我会坚持我的方式，但如果它变得更复杂，他的提议将导致更好的组织代码。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-30T06:19:21.737

如果您的 Example_Class 是轻量级的，请考虑存储原始状态，然后将当前状态与原始状态进行比较以确定更改。如果不是，您的方法是最好的，因为在这种情况下查找原始状态会消耗大量系统资源。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-30T15:36:04.397

除了“考虑让你的类型不可变”的建议之外，这是我写的（让 Jon 和 Marc 一路教我一些东西）

```
public class Example_Class
{    // snip
     // all properties are public get and private set

     private Dictionary<string, Delegate> m_PropertySetterMap;

     public Example_Class()
     {
        m_PropertySetterMap = new Dictionary<string, Delegate>();
        InitializeSettableProperties();
     }
     public Example_Class(long id, string name):this()
     {   this.ID = id;    this.Name = name;   }

     private void InitializeSettableProperties()
     {
        AddToPropertyMap<long>("ID",  value => { this.ID = value; });
        AddToPropertyMap<string>("Name", value => { this.Name = value; }); 
     }
     // jump thru a hoop because it won't let me cast an anonymous method to an Action<T>/Delegate
     private void AddToPropertyMap<T>(string sPropertyName, Action<T> setterAction)
     {   m_PropertySetterMap.Add(sPropertyName, setterAction);            }

     public void SetProperty<T>(string propertyName, T value)
     {
        (m_PropertySetterMap[propertyName] as Action<T>).Invoke(value);
        this.Status = StatusEnum.Dirty;
     }
  } 
```

你明白了.. 可能的改进：对 PropertyNames 使用常量并检查属性是否真的发生了变化。这里的一个缺点是

```
obj.SetProperty("ID", 700);         // will blow up int instead of long
obj.SetProperty<long>("ID", 700);   // be explicit or use 700L 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2017-07-27T21:30:18.580

这是我的做法。

在我不需要测试特定字段是否脏的情况下，我有一个抽象类：

```
public abstract class SmartWrap : ISmartWrap
{
    private int orig_hashcode { get; set; }
    private bool _isInterimDirty;

    public bool IsDirty
    {
        get { return !(this.orig_hashcode == this.GetClassHashCode()); }
        set
        {
            if (value)
                this.orig_hashcode = this.orig_hashcode ^ 108.GetHashCode();
            else
                MakeClean();
        }
    }

    public void MakeClean()
    {
        this.orig_hashcode = GetClassHashCode();
        this._isInterimDirty = false;
    }

    // must be overridden to return combined hashcodes of fields testing for
    // example Field1.GetHashCode() ^ Field2.GetHashCode() 
    protected abstract int GetClassHashCode();

    public bool IsInterimDirty
    {
        get { return _isInterimDirty; }
    }

    public void SetIterimDirtyState()
    {
        _isInterimDirty = this.IsDirty;
    }

    public void MakeCleanIfInterimClean()
    {
        if (!IsInterimDirty)
            MakeClean();
    }

    /// <summary>
    /// Must be overridden with whatever valid tests are needed to make sure required field values are present.
    /// </summary>
    public abstract bool IsValid { get; }
} 
```

}

还有一个界面

```
public interface ISmartWrap
{
    bool IsDirty { get; set; }
    void MakeClean();
    bool IsInterimDirty { get;  }
    void SetIterimDirtyState();
    void MakeCleanIfInterimClean();
} 
```

这允许我进行部分保存，并在有其他详细信息要保存时保留 IsDirty 状态。不完美，但涵盖了很多领域。

使用临时 IsDirty 状态的示例（为清楚起见，删除了错误包装和验证）：

```
 area.SetIterimDirtyState();

            if (!UpdateClaimAndStatus(area))
                return false;

            area.MakeCleanIfInterimClean();

            return true; 
```

这对大多数情况都有好处，但是对于某些类，我想使用原始数据的支持字段测试每个字段，并返回更改列表或至少更改字段的枚举。随着字段枚举的更改，我可以通过消息链将其向上推送，以选择性地更新远程缓存中的字段。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2020-04-29T09:56:33.143

您还可以考虑将变量装箱，这会以性能为代价，但也有其优点。它非常简洁，您不会在不设置脏状态的情况下意外更改值。

```
public class Variable<T>
{
    private T _value;
    private readonly Action<T> _onValueChangedCallback;

    public Variable(Action<T> onValueChangedCallback, T value = default)
    {
        _value = value;
        _onValueChangedCallback = onValueChangedCallback;
    }

    public void SetValue(T value)
    {
        if (!EqualityComparer<T>.Default.Equals(_value, value))
        {
            _value = value;
            _onValueChangedCallback?.Invoke(value);
        }
    }

    public T GetValue()
    {
        return _value;
    }

    public static implicit operator T(Variable<T> variable)
    {
        return variable.GetValue();
    }
} 
```

然后挂钩一个回调，将你的类标记为脏。

```
public class Example_Class
{
    private StatusEnum _Status = StatusEnum.New;

    private Variable<long> _ID;
    private Variable<string> _Name;

    public StatusEnum Status
    {
        get { return _Status; }
        set { _Status = value; }
    }

    public long ID => _ID;
    public string Name => _Name;

    public Example_Class()
    {
         _ID = new Variable<long>(l => Status = StatusEnum.Dirty);
         _Name = new Variable<string>(s => Status = StatusEnum.Dirty);
    }
} 
```

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2009-04-30T07:06:46.150

Another method is to override the GetHashCode() method to somthing like this:

```
public override int GetHashCode() // or call it GetChangeHash or somthing if you dont want to override the GetHashCode function...
{
    var sb = new System.Text.StringBuilder();

    sb.Append(_dateOfBirth);
    sb.Append(_marital);
    sb.Append(_gender);
    sb.Append(_notes);
    sb.Append(_firstName);
    sb.Append(_lastName);  

    return sb.ToString.GetHashCode();
} 
```

Once loaded from the database, get the hash code of the object. Then just before you save check if the current hash code is equal to the previous hash code. if they are the same, don't save.

**Edit:**

As people have pointed out this causes the hash code to change - as i use Guids to identify my objects, i don't mind if the hashcode changes.

**Edit2:**

Since people are adverse to changing the hash code, instead of overriding the GetHashCode method, just call the method something else. The point is detecting a change not whether i use guids or hashcodes for object identification.

# excel - 在jsp中将表格导出到excel表

> ID：805513
> 
> 赞同：0
> 
> 时间：2009-04-30T05:59:05.157
> 
> 标签：excel, jsp

我怎样才能将我的表格导出到jsp中的excel表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-30T06:19:28.430

最简单的方法是创建一个 HTML 表并使用以下响应标头发送此 HTML：

```
Content-type = application/vnd.ms-excel
Content-disposition = attachment;filename=whateverIsAppropriate.xls 
```

另一种选择是使用[Apache POI](http://poi.apache.org)创建 Excel ，然后将其作为响应发送。

# decomposition - 矩阵代数设计分解

> ID：805527
> 
> 赞同：1
> 
> 时间：2009-04-30T06:04:29.917
> 
> 标签：decomposition

我正在考虑重构一些非常复杂的代码，这是我正在工作的项目的子系统。我对这段代码的部分检查是它非常复杂，并且包含大量输入、中间值和输出，具体取决于某些核心业务逻辑。

我想重新设计这段代码，使其更易于维护，并且执行得更快，所以一开始我一直在尝试查看每个参数及其相互依赖关系。这导致了一个相当大而复杂的图，我想要一种简化这个图的机制。

不久前，我在一本名为“矩阵设计分解”的关于 SOA 设计的书中遇到了一种技术，它使用输出矩阵以及它们对输入的依赖关系，应用某种形式的矩阵代数，并且可以为这些依赖关系生成业务流程图.

[我知道http://www.designdecomposition.com/](http://www.designdecomposition.com/)上有一个可用的网络工具，但是它在您可以拥有的输入/输出依赖项的数量方面受到限制。我曾尝试四处寻找该工具的算法来源（因此我可以尝试自己实现它而不受大小限制），但是我没有运气。

有人知道我可以使用的类似技术吗？目前我什至正在考虑采用依赖矩阵并应用一些遗传算法来看看进化是否可以提出一个更简单的工作流程......

干杯，

艾多斯

编辑：

我将解释动机：

原始代码是为每次用户执行操作（添加、删除或修改项目的某些属性）时计算所有值（大约 60）的系统编写的。这段代码是十多年前写的，而且肯定显示出老化的迹象——其他人在系统中添加了更复杂的计算，现在我们得到了完全不合理的性能（在控制权返回给用户之前最多 2 分钟）。已决定将计算从用户操作中分离出来，并提供一个按钮来“重新计算”这些值。

我的问题出现了，因为有太多的计算正在进行，并且它们基于这样一个假设，即所有必需的数据都可用于计算 - 现在当我尝试重新实现计算时，我一直遇到问题，因为我没有'没有得到这个计算所依赖的不同计算的结果。

这是我想使用矩阵分解方法的地方。MD 方法允许我指定所有输入和输出，并为我提供可用于生成所有输出的“最简单”工作流程。

然后我可以使用这个“工作流程”来了解我需要执行的计算的优先级以获得相同的结果而不会产生任何异常。它还向我展示了我可以并行化计算系统的哪些部分以及分叉点和连接点的位置（我暂时不会担心那部分）。目前我所拥有的只是一个非常大的矩阵，其中显示了许多依赖项，不知道从哪里开始。

我将从我的评论中详细说明：

我不想在实际程序中使用 EA 流程中的解决方案。我想获取依赖矩阵并将其分解为模块，然后我将手动编码——这纯粹是一种设计辅助——我只是对这些模块的输入/输出感兴趣。基本上是这些计算之间复杂的相互依赖关系的表示，以及一些优先级的概念。

假设我有 A 需要 B 和 C。D 需要 A 和 E。F 需要 B、A 和 E，我想有效地将​​问题空间从一组复杂的依赖项划分为一个“工作流程”，我可以检查它以获得更好的理解。一旦我有了这种理解，我就可以提出一个更好的设计/实现，它仍然是人类可读的，所以对于这个例子，我知道我需要计算 A，然后是 C，然后是 D，​​然后是 F。

--

我知道这看起来有点奇怪，如果你看一下我在基于矩阵的分解之前链接到的网站，应该会让你对我的想法有所了解......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-30T08:14:38.357

kquinn，如果这是我认为他所指的那段代码（我曾经在那里工作过），它已经是一个没有人能理解的黑盒解决方案。他不想让它变得更复杂，事实上更少。他试图实现的是一大堆相互关联的计算。

目前发生的情况是，无论何时发生任何变化，都会引发大量事件，导致大量计算启动，进而导致更多事件继续发生，直到最终达到平衡状态。

我假设他想要做的是找到那些外围计算的依赖关系并从那里开始工作，这样它们就可以被重写并找到一种方法让计算发生，而不是因为他们需要。

关于简化图表，我无法提供太多建议，因为不幸的是，这不是我有太多经验的事情。也就是说，我会开始寻找那些没有依赖关系的离群计算，然后从那里遍历图表。开始构建一个新的框架，以最简单的方式包含每个计算的核心业务逻辑，并在此过程中重构其中的废话。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-30T06:20:08.430

如果正如您所说，这是“核心业务逻辑”，那么您真的不想搞乱花哨的分解和进化算法，这些算法会产生世界上没有人理解或无法理解的“黑匣子”解决方案修改。如果这些技术中的任何一种实际上产生了任何有用的结果，我会感到非常惊讶。在解开复杂的关系方面，人脑的能力仍然比任何机器都要强大得多。

你要做的是传统的重构：清理各个过程，简化它们并在可能的情况下合并它们。你的目标是让代码清晰，这样你的继任者就不必经历同样的过程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-30T08:17:06.073

您使用什么语言？您的问题应该很容易使用 Java Executors 和 Future<> 任务建模，但是您选择的平台上可能也有类似的框架可用？

另外，如果我理解正确，您想为大量相互依赖的计算生成一条关键路径——这是动态完成的，还是您“只是”需要静态分析？

关于算法解决方案；拿起最接近您的数值分析教科书的副本，并刷新您对奇异值分解和 LU 分解的记忆；我从头顶猜测，这就是您链接到的工具背后的原因。

编辑：由于您使用的是 Java，我将简要概述一个建议：

-> 使用线程池执行器轻松并行化所有计算

-> 使用 Future<> 或 FutureTask<>:s 的对象映射解决相互依赖关系，即如果变量是 A、B 和 C，其中 A = B + C，请执行以下操作：

```
static final Map<String, FutureTask<Integer>> mapping = ...
static final ThreadPoolExecutor threadpool = ...
FutureTask<Integer> a = new FutureTask<Integer>(new Callable<Integer>() {
            public Integer call() {
               Integer b = mapping.get("B").get();
               Integer c = mapping.get("C").get();
               return b + c;
            }
        }
    );
FutureTask<Integer> b = new FutureTask<Integer>(...);
FutureTask<Integer> c = new FutureTask<Integer>(...);
map.put("A", a);
map.put("B", a);
map.put("C", a);
for ( FutureTask<Integer> task : map.values() )
      threadpool.execute(task); 
```

现在，如果我还没有完全离开（我很可能已经离开了，因为我在 Java 中工作已经有一段时间了），你应该能够通过调整线程池大小来解决明显的死锁问题，或者使用增长的线程水池。（您仍然必须确保没有相互依赖的任务，例如如果 A = B + C 和 B = A + 1...）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-02-21T19:51:44.483

如果黑盒是线性的，您可以通过简单地连接许多输入向量和许多输出向量来发现所有系数。

你有输入 x[i] 和输出 y[i]，然后你创建一个矩阵 Y，其列是 y[0]、y[1]、... y[n]，以及一个矩阵 X，其列是 x[ 0]，x[1]，...，x[n]。会有一个变换 Y = T * X，然后你可以确定 T = Y * inverse(X)。

但既然你说它很复杂，我敢打赌它不是线性的。然后，如果您仍然想要一个通用框架，您可以使用这个因子图

[https://ieeexplore.ieee.org/document/910572](https://ieeexplore.ieee.org/document/910572)

如果你能做到这一点，我会很好奇。

我认为更容易理解代码并使用最佳实践重写它。

# sql - sql query for string contains in C#

> ID：805531
> 
> 赞同：-1
> 
> 时间：2009-04-30T06:05:07.933
> 
> 标签：sql

how to write sql query to do String contains operation.?

Consider,

```
string strTest = "Hash.System.Data.DataSet has.ds";
string str1 = "Hash.System.Data.DataSet has(System.Collections.Hashtable, Int32).ds";
string str2 = "Hash.System.Data.DataSet has(System.Collections.Hashtable, System.Collections.Hashtable).ds"; 
```

Here 1)if i compare strTest with str1 it should return true. 2)if i compare strTest with str2 it should return true.

i.e i can ignore the part of string which is enclosed within '(' and ')'.

edit: i'm trying to access MS access table using C# and need to check such conditions.

i need to check everything in 'strTest' excluding the part of string contained in brackets with str1 and str2.

str1 and str2 are entries in MS access table.

```
myCommand1.CommandText = "SELECT TableName FROM HashTableConfig WHERE ItemIdentity LIKE '" + strTest + "'"; 
```

This is the query where i should do changes so that it satisfies condition 1 and 2\. ItemIdentity can have values like str1 and str2.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-30T06:56:08.047

```
field LIKE 'Hash.System.Data.DataSet has(%).ds' 
```

# php - 如何memcache这些数据？

> ID：805535
> 
> 赞同：0
> 
> 时间：2009-04-30T06:07:05.933
> 
> 标签：php, mysql, memcached

```
SELECT a.* b.* c.*
FROM TOPIC a, BOARD b, MSGS c
WHERE c.MessageID = 1 AND a.TopicID = c.MessageID AND b.BoardID = c.BoardID 
```

如何memcache这些数据？

```
set_cache("MY_WACKY_QUERY_1", data) note: 1 is the message id 
```

现在代码中有很多地方会更新这 3 个表（彼此独立），所以`del_cache("XXX_1");`每当这些更新和插入中的任何一个影响到带有 id 的消息的 MSGS、TOPIC 或 BOARD 数据或与之相关时，我们都需要1

有简单的解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-30T07:44:44.933

在不知道用于存储数据的确切缓存键的情况下，您无法从 memcached 中删除数据。没有可以从中搜索存储数据的“索引”或“键列表”。

一种解决方案可能是使您的缓存生命周期足够短，这样陈旧的数据几乎就不用担心了。

或者也许......我想我很困惑。对我来说，看起来你*可以*做到这一点。

```
<?php

$memcache = new Memcache;
$memcache->connect( 'memcache_host', 11211 );

// do select query here, store into $result

$memcache->set( 'MY_QUERY_1', $result, false, 600 );

// do another select query here, store into $result

$memcache->set( 'MY_QUERY_2', $result, false, 600 );

// Query here updates record with id of 1

$memcache->delete( 'MY_QUERY_1' ); 
```

# mysql - 在 MySQL 中计算时区的偏移量

> ID：805538
> 
> 赞同：19
> 
> 时间：2009-04-30T06:08:19.580
> 
> 标签：mysql, timezone, offset

MySQL中有没有办法计算任何时区的偏移量？例如，获取 timezone 中的本地时间`Asia/calcutta`。我想要做的是计算这个时区的偏移量并将该偏移量添加到 GMT 以获得本地时间。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-03-14T17:11:41.967

如果要计算时区（例如美国/温哥华）与 UTC 的偏移量，可以按如下方式进行：

```
SELECT (unix_timestamp() -  unix_timestamp(convert_tz(now(), 'Etc/UTC', 'America/Vancouver'))) / 3600   as offset; 
```

为此，您首先需要将时区信息加载到 mysql 中，如下所述：http: [//dev.mysql.com/doc/refman/5.0/en/mysql-tzinfo-to-sql.html](http://dev.mysql.com/doc/refman/5.0/en/mysql-tzinfo-to-sql.html)

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-01-03T00:39:05.987

`SELECT TIMESTAMPDIFF(HOUR, UTC_TIMESTAMP(), NOW());`

如果服务器的时区是 PST，这将返回`-8`.

`SELECT TIMESTAMPDIFF(SECOND, NOW(), UTC_TIMESTAMP());`

如果要将上述结果与 MySQL DateTimes 进行比较，请将其添加到任何 unix 时间戳。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2017-03-09T11:23:09.627

```
SELECT TIME_FORMAT(TIMEDIFF(NOW(), CONVERT_TZ(NOW(), 'Asia/Calcutta', 'UTC')), '%H:%i') AS offset; 
```

给予

```
+--------+
| offset |
+--------+
|  05:30 |
+--------+ 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-30T06:12:36.717

偏移量将取决于您感兴趣的时间 - 例如，我目前与 UTC 有一个小时的偏移量，但在冬季我的偏移量将为零。

从[MySQL time zone support 的文档页面](http://mysql.openmirrors.org/doc/refman/5.1/en/time-zone-support.html)来看，您想要使用该[`convert_tz`](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_convert-tz)功能。如果您尝试将 UTC 转换为本地时间，请将“Etc/GMT+0”作为“从”时区传入，将“Asia/Calcutta”作为“至”传入。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-07-11T17:59:47.297

我混淆了@ColinM 和@Kenneth Spencer 的答案，因为我想要以小时为单位的任意时区的偏移量：

```
TIMESTAMPDIFF(HOUR, UTC_TIMESTAMP(), CONVERT_TZ(UTC_TIMESTAMP(), "UTC", "America/Denver")) 
```

-

```
SELECT ROUND(TIMESTAMPDIFF(MINUTE, UTC_TIMESTAMP(), CONVERT_TZ(UTC_TIMESTAMP(), "Etc/UTC", "Asia/Kolkata"))/60,1) 
```

正如 Kenneth 指出的，您需要加载时区信息：[http ://dev.mysql.com/doc/refman/5.0/en/mysql-tzinfo-to-sql.html](http://dev.mysql.com/doc/refman/5.0/en/mysql-tzinfo-to-sql.html)

但是你可以做一些有趣的事情，比如一次找到多个时区的偏移量：

```
SELECT Name,
TIMESTAMPDIFF(HOUR, UTC_TIMESTAMP(), CONVERT_TZ(UTC_TIMESTAMP(), "Etc/UTC", Name)) as Offset
FROM mysql.time_zone_name 
WHERE (Name IN ('America/Vancouver', 'Etc/UTC', 'America/Denver')) 
```

给予：

```
+-------------------+--------+
| Name              | Offset |
+-------------------+--------+
| America/Denver    |     -6 |
| America/Vancouver |     -7 |
| Etc/UTC           |      0 |
+-------------------+--------+ 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-12-29T15:24:50.330

我想知道@ColinM 上面的回答是否安全。它会读一次或两次时钟吗？UTC_TIMESTAMP() 和 NOW() 是否有可能相隔一秒？我不知道，但这会避免这种情况。

```
SET @now = now();
SET @utc = CONVERT_TZ(@now, 'SYSTEM', '+00:00');
SELECT TIMESTAMPDIFF(MINUTE, @utc, @now); 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-04-30T06:12:02.083

```
DATEDIFF(NOW(), UTC_TIMESTAMP()) 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-10-27T19:08:36.973

```
SET time_zone = '-07:00'; 
```

你可以传入一个偏移量

[http://dev.mysql.com/doc/refman/5.1/en/time-zone-support.html](http://dev.mysql.com/doc/refman/5.1/en/time-zone-support.html)

# visual-c++ - 创建视频文件

> ID：805540
> 
> 赞同：1
> 
> 时间：2009-04-30T06:08:47.690
> 
> 标签：visual-c++, wmv, screen-capture

我将如何创建一个记录用户与桌面交互的类。它应该将其转换为视频格式，如 wmv 文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-30T06:11:57.263

Cam Studio 是开源的，用 VC++ 编写。来源也不错。

[http://camstudio.org/](http://camstudio.org/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-30T14:35:15.603

[Windows Media Encoder 有这个能力](http://www.codeproject.com/KB/audio-video/CaptureScreenAsVideo.aspx)（CodeProject 文章 4.66 评级）

# ios - 如何对包含自定义对象的 NSMutableArray 进行排序？

> ID：805547
> 
> 赞同：1309
> 
> 时间：2009-04-30T06:10:56.923
> 
> 标签：ios, objective-c, sorting, cocoa-touch, nsmutablearray

我想做的事情似乎很简单，但我在网上找不到任何答案。我有一个`NSMutableArray`对象，假设它们是“人”对象。我想`NSMutableArray`按 Person.birthDate 排序，这是一个`NSDate`.

我认为这与这种方法有关：

```
NSArray *sortedArray = [drinkDetails sortedArrayUsingSelector:@selector(???)]; 
```

在 Java 中，我会让我的对象实现 Comparable，或者将 Collections.sort 与内联自定义比较器一起使用……你到底是如何在 Objective-C 中做到这一点的？

* * *

## 回答 #1

> 赞同：2333
> 
> 时间：2009-04-30T06:25:03.067

## 比较方法

要么为你的对象实现一个比较方法：

```
- (NSComparisonResult)compare:(Person *)otherObject {
    return [self.birthDate compare:otherObject.birthDate];
}

NSArray *sortedArray = [drinkDetails sortedArrayUsingSelector:@selector(compare:)]; 
```

## NSSortDescriptor（更好）

或者通常更好：

```
NSSortDescriptor *sortDescriptor;
sortDescriptor = [[NSSortDescriptor alloc] initWithKey:@"birthDate"
                                           ascending:YES];
NSArray *sortedArray = [drinkDetails sortedArrayUsingDescriptors:@[sortDescriptor]]; 
```

您可以通过向数组添加多个键轻松地按多个键排序。也可以使用自定义比较器方法。看看[文档](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSSortDescriptor_Class/Reference/Reference.html)。

## 块（闪亮！）

自 Mac OS X 10.6 和 iOS 4 起，也可以使用块进行排序：

```
NSArray *sortedArray;
sortedArray = [drinkDetails sortedArrayUsingComparator:^NSComparisonResult(Person *a, Person *b) {
    return [a.birthDate compare:b.birthDate];
}]; 
```

# 表现

一般来说，基于`-compare:`块的方法比使用`NSSortDescriptor`后者依赖于 KVC 的方法要快得多。该`NSSortDescriptor`方法的主要优点是它提供了一种使用数据而不是代码来定义排序顺序的方法，这使得设置变得容易，例如，用户可以`NSTableView`通过单击标题行来排序。

* * *

## 回答 #2

> 赞同：112
> 
> 时间：2009-04-30T06:24:09.310

看`NSMutableArray`方法[`sortUsingFunction:context:`](http://developer.apple.com/DOCUMENTATION/Cocoa/Reference/Foundation/Classes/NSMutableArray_Class/Reference/Reference.html#//apple_ref/doc/uid/20000138-BABCEEJD)

您将需要设置一个*比较*函数，该函数接受两个对象（类型为`Person`，因为您正在比较两个`Person`对象）和一个*上下文*参数。

这两个对象只是`Person`. 第三个对象是一个字符串，例如@"birthDate"。

这个函数返回一个`NSComparisonResult`: 它返回`NSOrderedAscending`if `PersonA.birthDate`< `PersonB.birthDate`。`NSOrderedDescending`如果`PersonA.birthDate`>它将返回`PersonB.birthDate`。`NSOrderedSame`最后，如果`PersonA.birthDate`==它将返回`PersonB.birthDate`。

这是粗略的伪代码；您将需要充实一个日期“更少”、“更多”或“等于”另一个日期的含义（例如比较 seconds-since-epoch 等）：

```
NSComparisonResult compare(Person *firstPerson, Person *secondPerson, void *context) {
  if ([firstPerson birthDate] < [secondPerson birthDate])
    return NSOrderedAscending;
  else if ([firstPerson birthDate] > [secondPerson birthDate])
    return NSOrderedDescending;
  else 
    return NSOrderedSame;
} 
```

如果你想要更紧凑的东西，你可以使用三元运算符：

```
NSComparisonResult compare(Person *firstPerson, Person *secondPerson, void *context) {
  return ([firstPerson birthDate] < [secondPerson birthDate]) ? NSOrderedAscending : ([firstPerson birthDate] > [secondPerson birthDate]) ? NSOrderedDescending : NSOrderedSame;
} 
```

如果您经常这样做，内联可能会加快一点速度。

* * *

## 回答 #3

> 赞同：65
> 
> 时间：2011-03-24T22:15:46.667

我在 iOS 4 中使用了一个块。必须将我的数组元素从 id 转换为我的类类型。在这种情况下，它是一个名为 Score 的类，具有一个名为 points 的属性。

此外，如果数组的元素不是正确的类型，您还需要决定该怎么做，对于这个示例，我刚刚返回`NSOrderedSame`，但是在我的代码中，我发现了一个异常。

```
NSArray *sorted = [_scores sortedArrayUsingComparator:^(id obj1, id obj2){
    if ([obj1 isKindOfClass:[Score class]] && [obj2 isKindOfClass:[Score class]]) {
        Score *s1 = obj1;
        Score *s2 = obj2;

        if (s1.points > s2.points) {
            return (NSComparisonResult)NSOrderedAscending;
        } else if (s1.points < s2.points) {
            return (NSComparisonResult)NSOrderedDescending;
        }
    }

    // TODO: default is the same?
    return (NSComparisonResult)NSOrderedSame;
}];

return sorted; 
```

PS：这里是降序排序。

* * *

## 回答 #4

> 赞同：30
> 
> 时间：2010-11-22T10:51:34.753

我尝试了所有，但这对我有用。在一个类中，我有另一个名为“ `crimeScene`”的类，并希望按“ `crimeScene`”的属性进行排序。

这就像一个魅力：

```
NSSortDescriptor *sorter = [[NSSortDescriptor alloc] initWithKey:@"crimeScene.distance" ascending:YES];
[self.arrAnnotations sortUsingDescriptors:[NSArray arrayWithObject:sorter]]; 
```

* * *

## 回答 #5

> 赞同：30
> 
> 时间：2011-03-16T18:46:26.247

从 iOS 4 开始，您还可以使用块进行排序。

对于这个特定的例子，我假设你的数组中的对象有一个 'position' 方法，它返回一个`NSInteger`.

```
NSArray *arrayToSort = where ever you get the array from... ;
NSComparisonResult (^sortBlock)(id, id) = ^(id obj1, id obj2) 
{
    if ([obj1 position] > [obj2 position]) 
    { 
        return (NSComparisonResult)NSOrderedDescending;
    }
    if ([obj1 position] < [obj2 position]) 
    {
        return (NSComparisonResult)NSOrderedAscending;
    }
    return (NSComparisonResult)NSOrderedSame;
};
NSArray *sorted = [arrayToSort sortedArrayUsingComparator:sortBlock]; 
```

注意：“排序”数组将被自动释放。

* * *

## 回答 #6

> 赞同：27
> 
> 时间：2009-05-06T16:25:51.213

[Georg Schölly 的第二个答案](https://stackoverflow.com/questions/805547/how-to-sort-an-nsmutablearray-with-custom-objects-in-it/805589#805589)中缺少一个步骤，但它工作正常。

```
NSSortDescriptor *sortDescriptor;
sortDescriptor = [[[NSSortDescriptor alloc] initWithKey:@"birthDate"
                                              ascending:YES] autorelease];
NSArray *sortDescriptors = [NSArray arrayWithObject:sortDescriptor];
NSArray *sortedArray;
sortedArray = [drinkDetails sortedArrayUsingDescriptors:sortDescriptors]; 
```

// 添加 's' 因为复制和粘贴时浪费了时间，并且在 sortedArrayUsingDescriptors 中没有 's' 失败

* * *

## 回答 #7

> 赞同：20
> 
> 时间：2011-03-30T05:54:36.710

```
NSSortDescriptor *sortDescriptor;
sortDescriptor = [[[NSSortDescriptor alloc] initWithKey:@"birthDate" ascending:YES] autorelease];
NSArray *sortDescriptors = [NSArray arrayWithObject:sortDescriptor];
NSArray *sortedArray;
sortedArray = [drinkDetails sortedArrayUsingDescriptors:sortDescriptors]; 
```

谢谢，它工作正常...

* * *

## 回答 #8

> 赞同：18
> 
> 时间：2009-04-30T06:20:00.393

你的`Person`对象需要实现一个方法，说`compare:`哪个接受另一个`Person`对象，然后`NSComparisonResult`根据两个对象之间的关系返回。

然后你会打电话给`sortedArrayUsingSelector:`它`@selector(compare:)`，它应该完成。

还有其他方法，但据我所知，没有可可等效的`Comparable`界面。使用`sortedArrayUsingSelector:`可能是最轻松的方法。

* * *

## 回答 #9

> 赞同：11
> 
> 时间：2011-04-14T09:03:10.037

iOS 4 块将拯救你 :)

```
featuresArray = [[unsortedFeaturesArray sortedArrayUsingComparator: ^(id a, id b)  
{
    DMSeatFeature *first = ( DMSeatFeature* ) a;
    DMSeatFeature *second = ( DMSeatFeature* ) b;

    if ( first.quality == second.quality )
        return NSOrderedSame;
    else
    {
        if ( eSeatQualityGreen  == m_seatQuality || eSeatQualityYellowGreen == m_seatQuality || eSeatQualityDefault  == m_seatQuality )
        {
            if ( first.quality < second.quality )
                return NSOrderedAscending;
            else
                return NSOrderedDescending;
        }
        else // eSeatQualityRed || eSeatQualityYellow
        {
            if ( first.quality > second.quality )
                return NSOrderedAscending;
            else
                return NSOrderedDescending;
        } 
    }
}] retain]; 
```

[http://sokol8.blogspot.com/2011/04/sorting-nsarray-with-blocks.html](http://sokol8.blogspot.com/2011/04/sorting-nsarray-with-blocks.html)一点说明

* * *

## 回答 #10

> 赞同：9
> 
> 时间：2010-11-09T13:47:20.733

对于`NSMutableArray`，使用`sortUsingSelector`方法。它对它进行排序，而不创建新实例。

* * *

## 回答 #11

> 赞同：8
> 
> 时间：2015-04-16T09:17:48.890

您可以根据您的目的使用以下通用方法。它应该可以解决您的问题。

```
//Called method
-(NSMutableArray*)sortArrayList:(NSMutableArray*)arrDeviceList filterKeyName:(NSString*)sortKeyName ascending:(BOOL)isAscending{
    NSSortDescriptor *sorter = [[NSSortDescriptor alloc] initWithKey:sortKeyName ascending:isAscending];
    [arrDeviceList sortUsingDescriptors:[NSArray arrayWithObject:sorter]];
    return arrDeviceList;
}

//Calling method
[self sortArrayList:arrSomeList filterKeyName:@"anything like date,name etc" ascending:YES]; 
```

* * *

## 回答 #12

> 赞同：7
> 
> 时间：2012-12-06T07:51:07.733

如果您只是对数组进行`NSNumbers`排序，则可以通过 1 次调用对它们进行排序：

```
[arrayToSort sortUsingSelector: @selector(compare:)]; 
```

这是因为数组中的对象（`NSNumber`对象）实现了比较方法。您可以对对象执行相同的操作`NSString`，甚至可以对实现比较方法的自定义数据对象数组执行此操作。

这是一些使用比较器块的示例代码。它对字典数组进行排序，其中每个字典在键“sort_key”中包含一个数字。

```
#define SORT_KEY @\"sort_key\"

[anArray sortUsingComparator: 
 ^(id obj1, id obj2) 
  {
  NSInteger value1 = [[obj1 objectForKey: SORT_KEY] intValue];
  NSInteger value2 = [[obj2 objectForKey: SORT_KEY] intValue];
  if (value1 > value2) 
{
  return (NSComparisonResult)NSOrderedDescending;
  }

  if (value1 < value2) 
{
  return (NSComparisonResult)NSOrderedAscending;
  }
    return (NSComparisonResult)NSOrderedSame;
 }]; 
```

上面的代码完成了为每个排序键获取一个整数值并比较它们的工作，作为如何做到这一点的说明。由于`NSNumber`对象实现了 compare 方法，因此可以更简单地重写它：

```
 #define SORT_KEY @\"sort_key\"

[anArray sortUsingComparator: 
^(id obj1, id obj2) 
 {
  NSNumber* key1 = [obj1 objectForKey: SORT_KEY];
  NSNumber* key2 = [obj2 objectForKey: SORT_KEY];
  return [key1 compare: key2];
 }]; 
```

或者比较器的主体甚至可以精简为 1 行：

```
 return [[obj1 objectForKey: SORT_KEY] compare: [obj2 objectForKey: SORT_KEY]]; 
```

我倾向于更喜欢简单的语句和大量的临时变量，因为代码更容易阅读，也更容易调试。无论如何，编译器都会优化掉临时变量，因此一体化版本没有任何优势。

* * *

## 回答 #13

> 赞同：7
> 
> 时间：2018-06-14T09:21:27.343

您使用 NSSortDescriptor 对带有自定义对象的 NSMutableArray 进行排序

```
 NSSortDescriptor *sortingDescriptor;
 sortingDescriptor = [[NSSortDescriptor alloc] initWithKey:@"birthDate"
                                       ascending:YES];
 NSArray *sortArray = [drinkDetails sortedArrayUsingDescriptors:@[sortDescriptor]]; 
```

* * *

## 回答 #14

> 赞同：6
> 
> 时间：2011-05-08T23:27:45.850

我在一些项目中使用**了 sortUsingFunction::：**

```
int SortPlays(id a, id b, void* context)
{
    Play* p1 = a;
    Play* p2 = b;
    if (p1.score<p2.score) 
        return NSOrderedDescending;
    else if (p1.score>p2.score) 
        return NSOrderedAscending;
    return NSOrderedSame;
}

...
[validPlays sortUsingFunction:SortPlays context:nil]; 
```

* * *

## 回答 #15

> 赞同：6
> 
> 时间：2013-01-10T15:37:39.493

```
-(NSMutableArray*) sortArray:(NSMutableArray *)toBeSorted 
{
  NSArray *sortedArray;
  sortedArray = [toBeSorted sortedArrayUsingComparator:^NSComparisonResult(id a, id b) 
  {
    return [a compare:b];
 }];
 return [sortedArray mutableCopy];
} 
```

* * *

## 回答 #16

> 赞同：6
> 
> 时间：2013-03-06T08:29:13.000

我创建了一个小的类别方法库，称为[Linq to ObjectiveC](https://github.com/ColinEberhardt/LinqToObjectiveC)，它使这类事情变得更容易。使用带有键选择器的[sort](https://github.com/ColinEberhardt/LinqToObjectiveC#sort)`birthDate`方法，您可以按如下方式进行排序：

```
NSArray* sortedByBirthDate = [input sort:^id(id person) {
    return [person birthDate];
}] 
```

* * *

## 回答 #17

> 赞同：6
> 
> 时间：2013-06-04T10:09:00.023

我刚刚根据自定义要求进行了多级排序。

//对值进行排序

```
 [arrItem sortUsingComparator:^NSComparisonResult (id a, id b){

    ItemDetail * itemA = (ItemDetail*)a;
    ItemDetail* itemB =(ItemDetail*)b;

    //item price are same
    if (itemA.m_price.m_selling== itemB.m_price.m_selling) {

        NSComparisonResult result=  [itemA.m_itemName compare:itemB.m_itemName];

        //if item names are same, then monogramminginfo has to come before the non monograme item
        if (result==NSOrderedSame) {

            if (itemA.m_monogrammingInfo) {
                return NSOrderedAscending;
            }else{
                return NSOrderedDescending;
            }
        }
        return result;
    }

    //asscending order
    return itemA.m_price.m_selling > itemB.m_price.m_selling;
}]; 
```

[https://sites.google.com/site/greateindiaclub/mobil-apps/ios/multilevelsortinginiosobjectivec](https://sites.google.com/site/greateindiaclub/mobil-apps/ios/multilevelsortinginiosobjectivec)

* * *

## 回答 #18

> 赞同：4
> 
> 时间：2011-09-06T09:44:57.473

排序`NSMutableArray`非常简单：

```
NSMutableArray *arrayToFilter =
     [[NSMutableArray arrayWithObjects:@"Photoshop",
                                       @"Flex",
                                       @"AIR",
                                       @"Flash",
                                       @"Acrobat", nil] autorelease];

NSMutableArray *productsToRemove = [[NSMutableArray array] autorelease];

for (NSString *products in arrayToFilter) {
    if (fliterText &&
        [products rangeOfString:fliterText
                        options:NSLiteralSearch|NSCaseInsensitiveSearch].length == 0)

        [productsToRemove addObject:products];
}
[arrayToFilter removeObjectsInArray:productsToRemove]; 
```

* * *

## 回答 #19

> 赞同：4
> 
> 时间：2016-06-16T09:32:26.570

**使用 NSComparator 排序**

如果我们要对自定义对象进行排序，我们需要提供`NSComparator`，用于比较自定义对象。该块返回一个`NSComparisonResult`值来表示两个对象的顺序。因此，为了对整个数组进行排序，请`NSComparator`按以下方式使用。

```
NSArray *sortedArray = [employeesArray sortedArrayUsingComparator:^NSComparisonResult(Employee *e1, Employee *e2){
    return [e1.firstname compare:e2.firstname];    
}]; 
```

**使用 NSSortDescriptor 进行排序**
假设我们有一个包含自定义类实例的数组，Employee 具有属性 firstname、lastname 和 age。下面的示例说明了如何创建一个 NSSortDescriptor，该 NSSortDescriptor 可用于按年龄键对数组内容进行升序排序。

```
NSSortDescriptor *ageDescriptor = [[NSSortDescriptor alloc] initWithKey:@"age" ascending:YES];
NSArray *sortDescriptors = @[ageDescriptor];
NSArray *sortedArray = [employeesArray sortedArrayUsingDescriptors:sortDescriptors]; 
```

**使用自定义比较进行排序**
名称是字符串，当您对字符串进行排序以呈现给用户时，您应该始终使用本地化比较。通常您还希望执行不区分大小写的比较。这里有一个使用 (localizedStandardCompare:) 的示例，按姓氏和名字对数组进行排序。

```
NSSortDescriptor *lastNameDescriptor = [[NSSortDescriptor alloc]
              initWithKey:@"lastName" ascending:YES selector:@selector(localizedStandardCompare:)];
NSSortDescriptor * firstNameDescriptor = [[NSSortDescriptor alloc]
              initWithKey:@"firstName" ascending:YES selector:@selector(localizedStandardCompare:)];
NSArray *sortDescriptors = @[lastNameDescriptor, firstNameDescriptor];
NSArray *sortedArray = [employeesArray sortedArrayUsingDescriptors:sortDescriptors]; 
```

参考和详细讨论请参考： [https ://developer.apple.com/library/ios/documentation/Cocoa/Conceptual/SortDescriptors/Articles/Creating.html](https://developer.apple.com/library/ios/documentation/Cocoa/Conceptual/SortDescriptors/Articles/Creating.html)
[http://www.ios-blog.co.uk/tutorials /objective-c/how-to-sort-nsarray-with-custom-objects/](http://www.ios-blog.co.uk/tutorials/objective-c/how-to-sort-nsarray-with-custom-objects/)

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2017-03-27T22:14:35.977

Swift 的协议和函数式编程让这变得非常容易，您只需让您的类符合 Comparable 协议，实现协议所需的方法，然后使用 sorted(by: ) 高阶函数创建排序数组，无需使用顺便说一句，可变数组。

```
class Person: Comparable {
    var birthDate: NSDate?
    let name: String

    init(name: String) {
        self.name = name
    }

    static func ==(lhs: Person, rhs: Person) -> Bool {
        return lhs.birthDate === rhs.birthDate || lhs.birthDate?.compare(rhs.birthDate as! Date) == .orderedSame
    }

    static func <(lhs: Person, rhs: Person) -> Bool {
        return lhs.birthDate?.compare(rhs.birthDate as! Date) == .orderedAscending
    }

    static func >(lhs: Person, rhs: Person) -> Bool {
        return lhs.birthDate?.compare(rhs.birthDate as! Date) == .orderedDescending
    }

}

let p1 = Person(name: "Sasha")
p1.birthDate = NSDate() 

let p2 = Person(name: "James")
p2.birthDate = NSDate()//he is older by miliseconds

if p1 == p2 {
    print("they are the same") //they are not
}

let persons = [p1, p2]

//sort the array based on who is older
let sortedPersons = persons.sorted(by: {$0 > $1})

//print sasha which is p1
print(persons.first?.name)
//print James which is the "older"
print(sortedPersons.first?.name) 
```

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2016-12-13T12:22:14.897

就我而言，我使用“sortedArrayUsingComparator”对数组进行排序。看看下面的代码。

```
contactArray = [[NSArray arrayWithArray:[contactSet allObjects]] sortedArrayUsingComparator:^NSComparisonResult(ContactListData *obj1, ContactListData *obj2) {
    NSString *obj1Str = [NSString stringWithFormat:@"%@ %@",obj1.contactName,obj1.contactSurname];
    NSString *obj2Str = [NSString stringWithFormat:@"%@ %@",obj2.contactName,obj2.contactSurname];
    return [obj1Str compare:obj2Str];
}]; 
```

我的目标也是，

```
@interface ContactListData : JsonData
@property(nonatomic,strong) NSString * contactName;
@property(nonatomic,strong) NSString * contactSurname;
@property(nonatomic,strong) NSString * contactPhoneNumber;
@property(nonatomic) BOOL isSelected;
@end 
```

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2018-04-12T10:32:49.360

您必须创建 sortDescriptor，然后您可以使用 sortDescriptor 对 nsmutablearray 进行排序，如下所示。

```
 let sortDescriptor = NSSortDescriptor(key: "birthDate", ascending: true, selector: #selector(NSString.compare(_:)))
 let array = NSMutableArray(array: self.aryExist.sortedArray(using: [sortDescriptor]))
 print(array) 
```

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2018-03-24T21:20:34.763

## 在 Swift 中排序数组

* * *

For `Swifty`Person below 是一种非常干净的技术，可以在全球范围内实现上述目标。让我们有一个示例自定义类，`User`其中包含一些属性。

```
class User: NSObject {
    var id: String?
    var name: String?
    var email: String?
    var createdDate: Date?
} 
```

现在我们有一个数组，我们需要根据`createdDate`升序和/或降序对其进行排序。因此，让我们添加一个日期比较功能。

```
class User: NSObject {
    var id: String?
    var name: String?
    var email: String?
    var createdDate: Date?
    func checkForOrder(_ otherUser: User, _ order: ComparisonResult) -> Bool {
        if let myCreatedDate = self.createdDate, let othersCreatedDate = otherUser.createdDate {
            //This line will compare both date with the order that has been passed.
            return myCreatedDate.compare(othersCreatedDate) == order
        }
        return false
    }
} 
```

现在让我们有`extension`一个`Array`for `User`。简而言之，让我们只为那些只有`User`对象的数组添加一些方法。

```
extension Array where Element: User {
    //This method only takes an order type. i.e ComparisonResult.orderedAscending
    func sortUserByDate(_ order: ComparisonResult) -> [User] {
        let sortedArray = self.sorted { (user1, user2) -> Bool in
            return user1.checkForOrder(user2, order)
        }
        return sortedArray
    }
} 
```

**升序的用法**

```
let sortedArray = someArray.sortUserByDate(.orderedAscending) 
```

* * *

**降序的用法**

```
let sortedArray = someArray.sortUserByDate(.orderedAscending) 
```

* * *

**相同订单的用法**

```
let sortedArray = someArray.sortUserByDate(.orderedSame) 
```

* * *

> 上面的方法`extension`只有在`Array`类型为 `[User]`||时才能访问。`Array<User>`

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2019-04-24T13:19:50.337

像这样用于嵌套对象，

```
NSSortDescriptor * sortDescriptor = [[NSSortDescriptor alloc] initWithKey:@"lastRoute.to.lastname" ascending:YES selector:@selector(caseInsensitiveCompare:)];
NSMutableArray *sortedPackages = [[NSMutableArray alloc]initWithArray:[packages sortedArrayUsingDescriptors:@[sortDescriptor]]]; 
```

lastRoute 是一个对象，该对象保存 to 对象，该对象保存 lastname 字符串值。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2020-02-20T13:23:44.967

**斯威夫特版本：5.1**

如果您有一个自定义结构或类并希望对它们进行任意排序，则应使用对您指定的字段进行排序的尾随闭包调用 sort()。这是一个使用对特定属性进行排序的自定义结构数组的示例：

```
 struct User {
        var firstName: String
    }

    var users = [
        User(firstName: "Jemima"),
        User(firstName: "Peter"),
        User(firstName: "David"),
        User(firstName: "Kelly"),
        User(firstName: "Isabella")
    ]

    users.sort {
        $0.firstName < $1.firstName
    } 
```

**如果你想返回一个排序数组而不是就地排序，使用 sorted() 像这样：**

```
 let sortedUsers = users.sorted {
        $0.firstName < $1.firstName
    } 
```

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2020-03-16T13:31:05.877

```
 let sortedUsers = users.sorted {
    $0.firstName < $1.firstName
 } 
```

* * *

## 回答 #27

> 赞同：-2
> 
> 时间：2013-10-29T01:28:27.653

```
NSMutableArray *stockHoldingCompanies = [NSMutableArray arrayWithObjects:fortune1stock,fortune2stock,fortune3stock,fortune4stock,fortune5stock,fortune6stock , nil];

NSSortDescriptor *sortOrder = [NSSortDescriptor sortDescriptorWithKey:@"companyName" ascending:NO];

[stockHoldingCompanies sortUsingDescriptors:[NSArray arrayWithObject:sortOrder]];

NSEnumerator *enumerator = [stockHoldingCompanies objectEnumerator];

ForeignStockHolding *stockHoldingCompany;

NSLog(@"Fortune 6 companies sorted by Company Name");

    while (stockHoldingCompany = [enumerator nextObject]) {
        NSLog(@"===============================");
        NSLog(@"CompanyName:%@",stockHoldingCompany.companyName);
        NSLog(@"Purchase Share Price:%.2f",stockHoldingCompany.purchaseSharePrice);
        NSLog(@"Current Share Price: %.2f",stockHoldingCompany.currentSharePrice);
        NSLog(@"Number of Shares: %i",stockHoldingCompany.numberOfShares);
        NSLog(@"Cost in Dollars: %.2f",[stockHoldingCompany costInDollars]);
        NSLog(@"Value in Dollars : %.2f",[stockHoldingCompany valueInDollars]);
    }
    NSLog(@"==============================="); 
```

# silverlight - 将 XAML 文件保存在数据库中

> ID：805552
> 
> 赞同：0
> 
> 时间：2009-04-30T06:12:02.397
> 
> 标签：silverlight, xaml, file, save

我有一个 Silverlight 应用程序，我可以创建演示幻灯片（如在 PowerPoint 中），我想将此幻灯片（XAML 和 .cs 文件）保存在数据库或其他地方，我可以在其中加载和使用它们。

请注意，安德烈。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-30T06:37:10.540

1.  您应该将 XAML 和 .CS 文件编译为 Silverlight 类库 (DLL)
2.  将 DLL 存储在数据库中
3.  根据需要动态下载 DLL

阅读MSDN 杂志中 Dino Esposito 的[这篇文章](http://msdn.microsoft.com/en-us/magazine/2009.01.cuttingedge.aspx)和[这篇文章](http://msdn.microsoft.com/en-us/magazine/dd434650.aspx)。

# build-process - ld 链接器问题： --whole-archive 选项

> ID：805555
> 
> 赞同：63
> 
> 时间：2009-04-30T06:13:21.487
> 
> 标签：build-process, linker, static-libraries

`--whole-archive`我见过的链接器选项的唯一真正用途是从静态库创建共享库。最近我遇到了 Makefile(s)，它在与内部静态库链接时总是使用这个选项。这当然会导致可执行文件不必要地拉入未引用的目标代码。我对此的反应是，这是完全错误的，我在这里遗漏了什么吗？

第二个问题与我读到的有关整个存档选项但无法完全解析的内容有关。`--whole-archive`如果可执行文件还与共享库链接，则在与静态库链接时应使用该 选项，而共享库又（部分）具有与静态库相同的目标代码。那就是共享库和静态库在目标代码方面有重叠。使用此选项将强制在可执行文件中解析所有符号（无论是否使用）。这应该避免目标代码重复。这很令人困惑，如果在程序中引用了一个符号，它必须在链接时唯一地解析，这个关于复制的业务是什么？（如果这一段不是很清楚的缩影，请原谅我）

谢谢

* * *

## 回答 #1

> 赞同：94
> 
> 时间：2009-05-09T05:30:32.410

`--whole-archive`将可执行文件与静态库链接时有合法用途。一个示例是构建 C++ 代码，其中全局实例在其构造函数中“注册”自己（警告：未经测试的代码）：

处理程序.h

```
typedef void (*handler)(const char *data);
void register_handler(const char *protocol, handler h);
handler get_handler(const char *protocol); 
```

handlers.cc（libhandlers.a 的一部分）

```
typedef map<const char*, handler> HandlerMap;
HandlerMap m;
void register_handler(const char *protocol, handler h) {
   m[protocol] = h;
}
handler get_handler(const char *protocol) {
   HandlerMap::iterator it = m.find(protocol);
   if (it == m.end()) return nullptr;
   return it->second;
} 
```

http.cc（libhttp.a 的一部分）

```
#include <handlers.h>
class HttpHandler {
    HttpHandler() { register_handler("http", &handle_http); }
    static void handle_http(const char *) { /* whatever */ }
};
HttpHandler h; // registers itself with main! 
```

主文件

```
#include <handlers.h>
int main(int argc, char *argv[])
{
    for (int i = 1; i < argc-1; i+= 2) {
        handler h = get_handler(argv[i]);
        if (h != nullptr) h(argv[i+1]);
    }
} 
```

`http.cc`请注意，该`main.cc`需求中没有符号。如果您将其链接为

```
g++ main.cc -lhttp -lhandlers 
```

您将*不会*获得链接到主可执行文件的 http 处理程序，并且将无法调用`handle_http()`. 将此与链接为时发生的情况进行对比：

```
g++ main.cc -Wl,--whole-archive -lhttp -Wl,--no-whole-archive -lhandlers 
```

同样的“自我注册”风格也可以在纯 C 中使用，例如使用`__attribute__((constructor))`GNU 扩展。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2011-02-07T13:58:55.077

另一个合法用途`--whole-archive`是工具包开发人员在单个静态库中分发包含多个功能的库。在这种情况下，提供者不知道消费者将使用库的哪些部分，因此必须包含所有内容。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2017-01-10T20:46:26.980

另一个很好`--whole-archive`用的场景是处理静态库*和*增量链接时。

让我们假设：

1.  `libA`实现`a()`和`b()`功能。
2.  程序的某些部分必须`libA`仅链接，例如由于某些函数包装使用`--wrap`（一个经典示例是`malloc`）
3.  `libC`实现`c()`功能和用途`a()`
4.  最终程序使用`a()`和`c()`

增量链接步骤可能是：

```
ld -r -o step1.o module1.o --wrap malloc --whole-archive -lA
ld -r -o step2.o step1.o module2.o --whole-archive -lC
cc step3.o module3.o -o program 
```

未能插入 --whole-archive 将剥离`c()`无论如何使用的函数`program`，从而阻止正确的编译过程。

当然，这是一个特殊的极端情况，其中必须进行增量链接以避免将所有调用包装到`malloc`所有模块中，但是`--whole-archive`.

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-04T18:24:03.693

我同意使用*—whole-archive*来构建可执行文件可能不是您想要的（由于链接到不需要的代码并创建了臃肿的软件）。如果他们有充分的理由这样做，他们应该在构建系统中记录它，因为现在你只能猜测了。

至于你问题的第二部分。如果可执行文件链接静态库和动态库*（部分）与静态库具有相同的目标代码，*那么*-whole-archive*将确保在链接时首选来自静态库的代码。这通常是您在进行静态链接时想要的。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-10-27T16:32:42.680

旧查询，但在您的第一个问题（“为什么”）上，我已经看到 --whole-archive 也用于内部库，主要是为了回避这些库之间的循环引用。它往往会隐藏库的不良架构，所以我不推荐它。然而，这是一种快速试用的快速方法。

对于您的第二个查询，如果共享对象和静态库中存在相同的符号，则链接器将满足它首先遇到的任何库的引用。
如果共享库和静态库具有精确的代码共享，那么这一切都可以正常工作。但是，如果共享库和静态库对相同符号有不同的实现，您的程序仍然可以编译，但会根据库的顺序表现出不同的行为。

强制从静态库中加载所有符号是消除对从何处加载的混淆的一种方法。但总的来说，这听起来像是解决了错误的问题；您通常不希望在不同的库中使用相同的符号。

# visual-c++ - IExplorer：当我们尝试从网络加载文件时，弹出我自己的对话框而不是默认的 IExplorer 对话框

> ID：805557
> 
> 赞同：0
> 
> 时间：2009-04-30T06:14:08.757
> 
> 标签：visual-c++

我正在开发一个需要自定义 IEXplorer 的默认功能的项目。当我们尝试从网络加载文件时，我需要弹出我自己的对话框而不是默认的 IExplorer 对话框（IExplorer 运行或保存对话框窗口）。有什么办法可以做到这一点？请回复。

这是一个本地应用程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-30T06:33:45.400

你在谈论一个网站吗？还是本地应用？如果是网站，则无法覆盖此对话框，除非您在网页上运行 Java 或 Flash 小程序。然后，您可以随心所欲地打开对话框（或“假”对话框）。但就覆盖内置对话框的本机能力而言；不。那将是一个巨大的安全风险。

# jquery - JQuery、MVC 和母版页

> ID：805565
> 
> 赞同：2
> 
> 时间：2009-04-30T06:17:31.900
> 
> 标签：jquery, asp.net-mvc, master-pages

通过母版页包含 JQuery 库的正确方法是什么？似乎有一套用于开发和一套用于生产。我在我的母版页中尝试了“#if DEBUG”，它左右触发了错误。我也在使用 <% %> 样式代码，发现我也不允许这样做。而且我的 google-fu 最近不太好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-30T06:39:56.260

```
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.1/jquery.min.js"></script> 
```

将包括 jQuery 关闭 Google 的服务器。生产版本是缩小版（较小的文件大小）。

包括这个会让你受益——很有可能（有更多的开发人员采用这种技术）这个人已经访问过这个链接的站点，因此缓存了 jQuery）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-30T07:34:36.487

[Scott Gu 的博客不久前](http://weblogs.asp.net/scottgu/archive/2008/11/21/jquery-intellisense-in-vs-2008.aspx)有一篇关于此的帖子。

但基本上你在母版页上需要的只是一个链接（正如 Alex 之前发布的那样）

您可以通过执行以下操作使用代码块来包含 Intellisense 版本：

```
<% if ( false ){ %>
     <script type="text/javascript" src="jquery-vsdoc.js"></script>
<% } %> 
```

在您需要智能感知的任何单个页面上。

# sql - SQL order by Issue - 续

> ID：805568
> 
> 赞同：1
> 
> 时间：2009-04-30T06:18:43.690
> 
> 标签：sql, plsql

这个问题是我[之前查询](https://stackoverflow.com/questions/804110/plsql-order-by-issue)的延续。它仍然无法正常工作。这是关于 ORDER BY 子句的。我正在尝试使用名为“sortby”的变量进行排序。

在这里，现在使用 DECODE() 函数将 ORDER BY 子句选择为单独的列（*如@devio 在此问题的原始版本中的回答中所建议的那样*）。

假设在这种情况下 sortby = 'memberCount'，我将它作为第一个参数传递给 decode(); **memberCount**是 grptest 表中的一个 COLUMN。

```
select distinct gl.group_id,
       decode('memberCount', 'name',        gl.group_name_key,
                             'description', gl.group_description_key,
                             'memberCount', gl.member_count)
             as p_sortby,
       gl.group_name,
       gl.group_description,
       gl.status_code,
       gl.member_count,
       (select grpp.group_name
           from grptest_relationship grel join grptest grpp
                   on grel.parent_group_id = grpp.group_id
           where grel.child_group_id = gl.group_id) as parent_group_name,
       gl.group_name_key,
       gl.group_description_key
   from grptest gl
   where gl.group_org_id = '3909'
     and (gl.group_name_key like '%' || 'GROUP' || '%')
order by 2; 
```

它不起作用。

但是，如果我在上面的解码中将“名称”作为第一个参数传递，它就可以工作。这是我关于为什么它不适用于 memberCount 的原始问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-30T14:52:55.590

我评论说：

> 你得到什么错误？或者你得到的错误行为是什么？在我将您的问题改编为我的数据库时，我必须确保在 DECODE() 可接受之前将数字列转换为字符类型 - 另外两列是字符列。完成后，以及按字母顺序排序数字的小问题将“8”放在“79”之后和“80”之前，我得到了一个合适的结果。

罗希特问道：

> 感谢您的投入。我想我对您提到的小问题感到困惑，即“按字母顺序将数字排序在 '79' 之后和 '80' 之前放置 '8'”。我不明白这里是什么东西？另外，您能否帮助我查询如何“确保在 DECODE() 可接受之前将数字列转换为字符类型”。你能在这方面修改我上面的查询吗？

* * *

我使用的表格用于“元素表”：

```
-- Tables for storing information about chemical elements and chemical compounds
-- See: http://www.webelements.com/ for elements.
-- See: http://ie.lbl.gov/education/isotopes.htm for isotopes.

CREATE TABLE elements
(
    atomic_number   INTEGER NOT NULL UNIQUE
                    CHECK (atomic_number > 0 AND atomic_number < 120),
    symbol          CHAR(3) NOT NULL UNIQUE,
    name            CHAR(20) NOT NULL UNIQUE,
    atomic_weight   DECIMAL(8,4) NOT NULL,
    stable          CHAR(1) DEFAULT 'Y' NOT NULL
                    CHECK (stable IN ('Y', 'N'))
); 
```

这是一个有趣的表，因为它具有三个真正的候选键（原子序数、名称和符号都是唯一的），并且根据上下文（同位素与化学物质），您最好使用原子序数或符号作为连接键。

我使用的查询是：

```
select decode('atomic_number',
                    'name',          name,
                    'symbol',        symbol,
                    'atomic_number', atomic_number||''),
        name, symbol, atomic_number
    from elements
    order by 1;

select decode('name',
                    'name',          name,
                    'symbol',        symbol,
                    'atomic_number', atomic_number||''),
        name, symbol, atomic_number
    from elements
    order by 1;

select decode('symbol',
                    'name',          name,
                    'symbol',        symbol,
                    'atomic_number', atomic_number||''),
        name, symbol, atomic_number
    from elements
    order by 1; 
```

这些展示了三种排序——按符号、按名称和按原子序数。

原子序数排序的部分结果集是：

```
77      Iridium         Ir      77
78      Platinum        Pt      78
79      Gold            Au      79
8       Oxygen          O       8
80      Mercury         Hg      80
81      Thallium        Tl      81 
```

因为原子序数被强制成字符串，所以排序是按字符串顺序排列的，当作为字符串时，'8'出现在'79'之后，'80'之前，如图所示。避免该问题的一种方法是：

```
select decode('atomic_number',
                    'name',          name,
                    'symbol',        symbol,
                    'atomic_number', lpad(atomic_number, 3)),
        name, symbol, atomic_number
    from elements
    order by 1; 
```

生成以下内容（虽然不明显，但在第一列的开头有一个额外的空白）：

```
 77     Iridium         Ir      77
 78     Platinum        Pt      78
 79     Gold            Au      79
 80     Mercury         Hg      80
 81     Thallium        Tl      81
 82     Lead            Pb      82 
```

这使用了空格在（ASCII、Latin-1、Unicode）排序序列中的任何数字之前的知识，并且原子序数不超过 3 位。或者，我可以使用 ' `LPAD(atomic_number, 3, '0')`' 对数据进行零填充。我在 Solaris 10 上使用 IBM Informix Dynamic Server (IDS) 11.50.FC3W2 进行了测试。IDS 非常容忍类型不匹配，并自动将 atomic_number 参数转换为 LPAD 为字符串。其他 DBMS 可能不那么宽容；您必须显式地转换该值。

回到问题...

假设 memberCount 是一个数字列，并且值不超过 4 位（如果它们更长，请适当调整），查询可以写成：

```
select distinct gl.group_id,
       decode('memberCount', 'name',        gl.group_name_key,
                             'description', gl.group_description_key,
                             'memberCount', LPAD(gl.member_count, 4))
             as p_sortby,
       gl.group_name,
       gl.group_description,
       gl.status_code,
       gl.member_count,
       (select grpp.group_name
           from grptest_relationship grel join grptest grpp
                   on grel.parent_group_id = grpp.group_id
           where grel.child_group_id = gl.group_id) as parent_group_name,
       gl.group_name_key,
       gl.group_description_key
   from grptest gl
   where gl.group_org_id = '3909'
     and (gl.group_name_key like '%' || 'GROUP' || '%')
order by 2; 
```

或者您可能需要：

```
LPAD(CAST(memberCount AS CHAR(4)), 4) 
```

或其他一些稍微特定于 DBMS 的咒语，可以达到相同的一般效果。

由于您没有为查询提供架构（更少的示例数据），我的数据库中没有您的表，所以我无法演示您的查询工作

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-30T06:38:08.400

我知道

```
order by p_sortby 
```

不会工作，但你能试试

```
order by decode('memberCount', 
  'name', gl.group_name_key,
  'description', gl.group_description_key, 
  'memberCount', gl.member_count) 
```

编辑：

我想起了另一种方式：

```
select * from (
  select column1, decode(....) as column2, .... from table1
) t1
order by 2 
```

这种方式甚至可能更快

# c# - T4 模板可以使用同一个库吗

> ID：805581
> 
> 赞同：1
> 
> 时间：2009-04-30T06:21:47.193
> 
> 标签：c#, visual-studio, t4, texttemplate

我有一个定义类的库

```
namespace ClassLibrary1
{
    public class Class1
    {
        public static readonly int Rate = 5;
    }
} 
```

在同一个库中，我添加了一个 tt 文件

```
<#@ template debug="false" hostspecific="false" language="C#" #>
<#@ output extension=".cs" #>
<#@ import namespace="ClassLibrary1" #>
<#@ assembly name="ClassLibrary.dll" #>

enum  MilkRate{ Walmart=<#= Class1.Rate #>} 
```

我收到错误“编译转换：找不到元数据文件 'ClassLibrary.dll' d:\documents\visual studio 10\Projects\ConsoleApplication2\ClassLibrary1\TextTemplate1.tt”

如何解决这个问题？

[发生在 VS 2010、VS2008 上]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-10-29T10:37:55.367

我不确定这是否可能。

我认为我可能遇到的问题是：您的模板正在生成将更改它所引用的 dll 的代码！

您可以做的一件事是让一个模板引用另一个模板，使用：

```
<#@ include file="Helper.tt" #> 
```

通过这种方式，您可以`Rate = 5`在一个中央模板中定义并让其他所有内容都引用该模板。您甚至可以构建一个模板来生成您的`Class1`类，以便将所有内容都保存在一个中心位置。

我知道这并不能直接回答您的问题，但我希望它对您有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-04-27T01:21:41.407

您可以这样做，但这种“递归”的工作方式存在一些需要小心的问题。

在 VS2010 中，您可以在 <#@ assembly #> 指令中使用 VS 宏变量、$(SolutionDir)、$(ProjectDir) 和朋友，例如

<#@ 程序集名称="$(ProjectDir)$(OutDir)ClassLibrary.dll" #>

如果您随后让开发人员从源代码​​控制中进行干净的获取，则他们必须先进行构建，然后才能进行有效的转换。

如果他们先转换，转换将失败，然后他们的构建将失败，他们将被卡住并不得不恢复文件。这没什么大不了的，但它可能会绊倒人们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-02-18T22:16:49.730

您是否尝试过在[http://social.msdn.microsoft.com/Forums/en-US/vsx/threads](http://social.msdn.microsoft.com/Forums/en-US/vsx/threads)的 VS 可扩展性论坛上发帖？

# sql-server - 如何在 SSIS 中创建日志文件

> ID：805585
> 
> 赞同：2
> 
> 时间：2009-04-30T06:23:46.250
> 
> 标签：sql-server, windows, logging, cmd, ssis

我想在 SSIS 中创建一个日志文件。我知道如何通过管理工作室创建，但我想通过命令提示符运行我的 SSIS 包。你能帮我找到 Windows 命令吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-30T06:28:16.817

您可以使用 /L 选项，如此[处](http://msdn.microsoft.com/en-us/library/ms162810.aspx)所述；但是，您也可以通过 Visual Studio 中的 SSIS>Logging 菜单以更简单、更精细的方式设置 Logging。

干杯，
埃里克

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-30T17:13:50.183

在您的 SSIS 中，您需要先创建和配置一个 SSIS 日志提供程序，然后才能使用它。查看[链接文本](http://msdn.microsoft.com/en-us/library/ms140246.aspx)以获取更多信息。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-08T07:24:49.750

您需要在 Business Intelligence Development Studio (BIDS) 中设置新的连接字符串。您必须在其中指定日志文件的路径...我的意思是这里的路径将是 D:\Sample_Examples\Log.log... 并且连接管理器的名称将是 Log.log 所以现在命令提示符将更改为

```
dtexec /f "C:\\Package.dtsx" /l "DTS.LogProviderTextFile";"Log.log" 
```

代替

```
dtexec /f "C:\\Package.dtsx" /l "DTS.LogProviderTextFile;D:\Sample_Examples\Log.log" 
```

我们无法在 DTS.LogProviderTextFile 之后指定直接路径...因为只有我得到了错误...

非常感谢您的建议...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-12-08T17:31:32.120

您可以通过另一种方式执行此操作，而无需进入您的 SSIS 包。

创建一个批处理文件并在新的 CMD 实例中运行 DTEXEC，即：

CMD /C DTEXEC*你的包和参数*>*日志文件*

执行此操作时，您可以运行此批处理文件并获取您的日志文件。

有关详细信息，请参阅[http://richarddingwall.name/2009/01/26/capture-the-output-from-a-scheduled-task/](http://richarddingwall.name/2009/01/26/capture-the-output-from-a-scheduled-task/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-01-21T21:42:12.823

是的，您必须为日志提供程序创建一个连接管理器；然而; 如果您使用自定义日志提供程序，则没有关于如何执行此操作的文档。

# linq-to-sql - 如何告诉 datacontext 我已经通过存储过程更新了记录

> ID：805591
> 
> 赞同：2
> 
> 时间：2009-04-30T06:25:06.670
> 
> 标签：linq-to-sql, datacontext

我有一个更新记录的存储过程，运行它后我使用 LinqToSql 删除记录。我知道这很奇怪，但我只想测试它的数据上下文有多智能并了解它是如何工作的。

由于 datacontext 缓存了结果，因此可以记录通过它进行的任何更改，但现在我使用存储过程来更新某些内容，它不会知道。因此，当我尝试删除它时，会出现“未找到或更改行”的异常。

我如何告诉数据上下文我更新了什么？如果我能这样做，问题就会解决。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T06:03:53.817

您可以使用传入 System.Data.Linq.RefreshMode 枚举的 DataContext Refresh() 方法；这是一个例子：

```
NorthWindDataContext context = new NorthwindDataContext();
context.Refresh(RefreshMode.KeepChanges); 
```

**澄清：**
http: //msdn.microsoft.com/en-us/library/system.data.linq.refreshmode.aspx">RefreshMode 枚举有 3 个值：

1.  保持更改
2.  保持当前值
3.  覆盖当前值

此处使用的版本 (KeepChanges) 强制 Refresh 方法保留修改后的值，并通过数据库中的值更新其他未修改的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-30T06:30:43.677

我想我遗漏了一些东西，但是如果您知道您的存储过程只是删除了记录，那么为什么还要在事后打扰 Linq2Sql 呢？DataContext 不会神奇地知道删除。

# c# - 将字典作为数据源的 C# DropDownList

> ID：805595
> 
> 赞同：113
> 
> 时间：2009-04-30T06:26:35.730
> 
> 标签：c#, dictionary, drop-down-menu

我想使用 (en-gb) 的字典 (list)作为键和语言名称 (english) 作为要显示的文本来设置`DataTextField`和`DataValueField`( languageList)。`Dropdownlist``languageCod`

相关代码：

```
string[] languageCodsList= service.LanguagesAvailable();
Dictionary<string, string> list = 
                   new Dictionary<string, string>(languageCodsList.Length);

foreach (string cod in languageCodsList)
{
    CultureInfo cul = new CultureInfo(cod);
    list.Add(cod, cul.DisplayName);
}
languageList.DataSource = list;
languageList.DataBind(); 
```

我该如何设置`DataTextField`和`DataValueField`？

* * *

## 回答 #1

> 赞同：211
> 
> 时间：2009-04-30T06:33:35.480

像这样，您可以使用“Key”和“Value”文本设置 DropDownList 的 DataTextField 和 DataValueField：

```
 Dictionary<string, string> list = new Dictionary<string, string>();
    list.Add("item 1", "Item 1");
    list.Add("item 2", "Item 2");
    list.Add("item 3", "Item 3");
    list.Add("item 4", "Item 4");

    ddl.DataSource = list;
    ddl.DataTextField = "Value";
    ddl.DataValueField = "Key";
    ddl.DataBind(); 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-04-30T06:31:42.100

枚举字典时，它将产生[`KeyValuePair<TKey,TValue>`](http://msdn.microsoft.com/en-us/library/5tbh8a42.aspx)对象......因此您只需分别为`DataTextField`和指定“值”和“键” `DataValueField`，以选择[值](http://msdn.microsoft.com/en-us/library/ms224761.aspx)/[键](http://msdn.microsoft.com/en-us/library/ms224760.aspx)属性。

感谢乔的评论，我重新阅读了这个问题以正确解决这些问题。通常我希望字典中的“键”是显示的文本，而“值”是获取的值。您的示例代码以相反的方式使用它们。除非您真的需要它们，否则您可能需要考虑将代码编写为：

```
list.Add(cul.DisplayName, cod); 
```

（当然，然后将绑定更改为使用“Key”`DataTextField`和“Value” `DataValueField`。）

实际上，我建议您似乎确实想要一个*列表*而不是字典，因此您可能首先要重新考虑使用字典。你可以只使用一个`List<KeyValuePair<string, string>>`：

```
string[] languageCodsList = service.LanguagesAvailable();
var list = new List<KeyValuePair<string, string>>();

foreach (string cod in languageCodsList)
{
    CultureInfo cul = new CultureInfo(cod);
    list.Add(new KeyValuePair<string, string>(cul.DisplayName, cod));
} 
```

或者，使用普通`CultureInfo`值列表。LINQ 让这变得非常简单：

```
var cultures = service.LanguagesAvailable()
                      .Select(language => new CultureInfo(language));
languageList.DataTextField = "DisplayName";
languageList.DataValueField = "Name";
languageList.DataSource = cultures;
languageList.DataBind(); 
```

如果您不使用 LINQ，您仍然可以使用普通的 foreach 循环：

```
List<CultureInfo> cultures = new List<CultureInfo>();
foreach (string cod in service.LanguagesAvailable())
{
    cultures.Add(new CultureInfo(cod));
}
languageList.DataTextField = "DisplayName";
languageList.DataValueField = "Name";
languageList.DataSource = cultures;
languageList.DataBind(); 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-28T02:24:33.350

如果 DropDownList 在您的 aspx 页面中而不是在代码隐藏中声明，您可以这样做。

.aspx：

```
<asp:DropDownList ID="ddlStatus" runat="server" DataSource="<%# Statuses %>"
     DataValueField="Key" DataTextField="Value"></asp:DropDownList> 
```

.aspx.cs：

```
protected void Page_Load(object sender, EventArgs e)
{
    ddlStatus.DataBind();
    // or use Page.DataBind() to bind everything
}

public Dictionary<int, string> Statuses
{
    get 
    {
        // do database/webservice lookup here to populate Dictionary
    }
}; 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-30T06:59:53.623

只需使用“键”和“值”

# ruby-on-rails - DRY Rails 主模板？

> ID：805601
> 
> 赞同：1
> 
> 时间：2009-04-30T06:31:17.950
> 
> 标签：ruby-on-rails, templates, dry

有没有一种简单的方法可以为我的整个 Rails 应用程序定义主模板？如果不是，那么重用模板的最佳方法是什么，这样我就不会将相同的模板复制并粘贴到一堆布局文件中？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-30T08:00:16.020

您可以将其命名为**application.html.erb**，Rails 将在整个应用程序中使用它。更多信息在[rails guides](http://guides.rubyonrails.org/layouts_and_rendering.html#finding-layouts)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-30T20:25:50.970

在视图的布局文件夹中创建一个 application.html.erb 文件。如果控制器没有模板，它将被调用，因此您可能需要删除它们。

您还可以为特定控制器定义模板

```
class FaqentriesController < ApplicationController
    layout "admin"
[..] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-30T09:16:10.160

/app/views/layouts/whatever.rhtml（或您喜欢使用的任何扩展）：

```
<html>
 ...
   <%= yield %>
 ...
</html> 
```

/app/controllers/ApplicationController.rb：

```
layout "whatever" 
```

（编辑：我不记得调用布局 application.rhtml （或其他）是否会自动使其成为任何缺乏规范的控制器的默认布局，或者当你使用上述语法生成脚手架。）

# silverlight - Silverlight 中的反序列化属性

> ID：805609
> 
> 赞同：0
> 
> 时间：2009-04-30T06:33:30.613
> 
> 标签：silverlight

我在 silverlight 和 WCF 服务之间移动的数据相当有限。所以我建立了一些数据合同。我希望能够使用相同的类在客户端进行一些有限的数据验证，而不需要 DTO 和其他东西的开销。

我有这样的合同：

```
[DataContract]
class MyObject
{
   private String _id;
   [DataMember]
   public String ID
        {
            get
            {
                return _id;
            }
            set
            {
                _id = value;
                DoStuff();
            }
} 
```

现在，当我反序列化对象时，setter 将运行。这将设置私有变量 _id，这很好。但我不希望 DoStuff() 在反序列化时运行。

我曾希望使用 [OnDeserializing] 和 [OnDeserialized] 属性。我可以定义一个 bool 标志，我可以用它来控制在 setter 中运行的内容。这实际上适用于服务器端，但 Silverlight 没有这些属性。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-30T06:49:32.290

我建议不要重载这些类的使用来执行逻辑。这是您的服务数据合同。您不应该接触生成的 Silverlight 代理类。我建议您将验证逻辑放入您在反序列化完成后调用的其他类中。否则，当您的错误实际上在您的数据中时，您可能会开始在序列化代码中出现错误。

# wpf - 在 WPF 中控制“窗外/镶边”

> ID：805620
> 
> 赞同：0
> 
> 时间：2009-04-30T06:36:30.260
> 
> 标签：wpf, google-chrome

有没有办法让 WPF 中的 Window/Chrome（即 Aero 的玻璃）“脱离”控件/图像/等？

我的意思的一个例子是不久前发布（然后停止）的[WPF Yahoo Messenger 。](http://www.ymessengerblog.com/blog/2007/12/05/yahoo-messenger-for-vista-preview-release-available/)WindowStyle 看起来设置为 None，但 AllowTransparencies/CanResize 分别设置为 false/true - 并且头像略微“超出窗口/镶边”。

我知道我*可以*创建自己的玻璃边框，但这可能需要付出一些努力才能让它看起来一致。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-30T06:59:16.213

是的，我相信你将不得不用你自己的替换窗口的界面。您可以从透明窗口和网格开始，在网格周围留下一些边距。然后在网格上放置拇指、标题栏等来模拟窗口行为。网格周围的边距将允许您在“窗口”之外绘制控件。

```
<Window
x:Class="TransparentFormDemo.Window2"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
Title="Window2" Height="300" Width="300"
AllowsTransparency="True"
WindowStyle="None" Background="Transparent">
<Grid Margin="20" Background="AliceBlue">
    <Thumb Name="topThumb" Height="5" HorizontalAlignment="Stretch" VerticalAlignment="Top"
           DragDelta="topThumb_DragDelta" Cursor="SizeNS"/>
    <!--Thumbs continued-->
    <Polygon Points="10,110 60,10 110,110" Fill="Blue" Margin="0,-30"/>
</Grid>
</Window> 
```

# php - PHP 中的 preg_replace() 帮助

> ID：805625
> 
> 赞同：1
> 
> 时间：2009-04-30T06:37:30.650
> 
> 标签：php, regex

考虑这个字符串

```
hello awesome <a href="" rel="external" title="so awesome is cool"> stuff stuff 
```

我可以使用什么正则表达式来匹配`awesome`没有出现在锚的标题属性中的任何出现？

到目前为止，这就是我想出的（可悲的是它不起作用）

```
/[^."]*(awesome)[^."]*/i 
```

## **编辑**

我接受了[Alan M 的建议](https://stackoverflow.com/questions/805625/pregreplace-help-in-php/805785#805785)并使用正则表达式来捕获每个单词并将其发送到回调。感谢艾伦 M 的建议。这是我的最终代码。

```
 $plantDetails = end($this->_model->getPlantById($plantId));

        $botany = new Botany_Model();
        $this->_botanyWords = $botany->getArray();
        foreach($plantDetails as $key=>$detail) {
            $detail = preg_replace_callback('/\b[a-z]+\b/iU', array($this, '_processBotanyWords'), $detail); 
            $plantDetails[$key] = $detail;  
        } 
```

而 _processBotanyWords()...

```
 private function _processBotanyWords($match) {
        $botanyWords = $this->_botanyWords;  
        $word = $match[0];
        if (array_key_exists($word, $botanyWords)) {    
            return '<a href="' . PATH_BASE . 'articles/botany-words/#botany-word-' . str_replace(' ', '-', strtolower($word)) . '" title="' . trim($botanyWords[$word]) . '">' . $word . '</a>';
        } else {
            return $word;
        }
    } 
```

希望有一天这很好地帮助别人！再次感谢您的所有回答。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-30T06:41:22.870

这个主题几乎每天都会出现在这里，基本上问题是这样的：您不应该使用正则表达式来解析或更改 HTML（或 XML）。这就是 HTML/XML 解析器的用途。上述问题只是您将面临的问题之一。你可能会得到一些最有效的东西，但仍然会有一些不可行的极端情况。

只需使用 HTML 解析器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-30T07:32:38.443

假设这与您不久前发布和删除的问题有关（那是您，不是吗？），这是您的基本方法是错误的。您说您通过替换关键字列表中的单词来自己生成这些 HTML 链接。问题是列表中更靠后的关键字有时会出现在生成的标题属性中并被错误替换——现在您正试图修复错误。

潜在的问题是您正在使用单独的调用来替换每个关键字`preg_replace`，从而一次又一次地有效地处理整个文本。您应该做的是处理文本*一次*，匹配每个单词并在您的关键字列表中查找它；如果它在列表中，请更换它。我没有准备好编写/测试 PHP 代码，但您可能想使用`preg_replace_callback`：

```
$text = preg_replace_callback('/\b[A-Za-z]+\b/', "the_callback", $text); 
```

“the_callback”是查找单词的函数的名称，如果它在列表中，则生成适当的链接；否则返回匹配的单词。像这样处理每个单词可能听起来效率低下，但实际上它*比*您原来的方法高效得多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-30T06:48:29.000

当然，使用解析库是工业级的解决方案，但我们都有时间只想在 10 秒内编写一些东西并完成。下次你想处理页面的大量文本时，忽略标签，试着先通过[strip_tags](http://us.php.net/strip-tags)运行你的输入。这样，您将只获得简单、可见的文本，并且您的正则表达式功能将再次占据主导地位。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-30T09:12:15.457

这太可怕了，我犹豫要不要发布它，但是如果您想要快速破解，请扭转问题 - 而不是找到不是 X 的东西，找到*IS*的东西，改变它，做这件事然后把它改回来.

这是假设您正在尝试将 awesome（更改为“wonderful”）。如果您正在做其他事情，请相应地进行调整。

```
$string = 'Awesome is the man who <b>awesome</b> does and <a href="awesome.php" title="awesome">awesome</a> is.';

$string = preg_replace('#(title\s*=\s*\"[^"]*?)awesome#is', "$1PIGDOG", $string);

$string = preg_replace('#awesome#is', 'wonderful', $string);

$string = preg_replace('#pigdog#is', 'awesome', $string); 
```

不要投票给我。我知道这是黑客。

# algorithm - 差异算法？

> ID：805626
> 
> 赞同：176
> 
> 时间：2009-04-30T06:37:33.753
> 
> 标签：algorithm, diff, vcdiff

我一直在寻找一种有效且有效的差异算法的解释。

我得到的最接近的是[这个到 RFC 3284 的链接](http://www.faqs.org/rfcs/rfc3284.html)（来自几个 Eric Sink 博客文章），它以完全可以理解的术语描述了存储差异结果的*数据格式。*但是，它没有提及程序如何在进行差异时达到这些结果。

出于个人的好奇心，我正在尝试对此进行研究，因为我确信在实现差异算法时必须进行权衡，有时当您查看差异并想知道“为什么差异程序选择这个作为更改时，这很清楚而不是那个？”...

我在哪里可以找到最终输出 VCDIFF 的有效算法的描述？
顺便说一句，如果您碰巧找到 SourceGear 的 DiffMerge 使用的实际算法的描述，那就更好了。

注意：最长公共子序列似乎不是 VCDIFF 使用的算法，考虑到他们使用的数据格式，看起来他们正在做一些更聪明的事情。

* * *

## 回答 #1

> 赞同：189
> 
> 时间：2009-08-21T17:23:00.227

[O(ND) Difference Algorithm and its Variations](http://www.xmailserver.org/diff2.pdf)是一篇很棒的论文，您可能想从那里开始。它包括伪代码和执行 diff 所涉及的图形遍历的良好可视化。

**论文的第 4 节**介绍了算法的一些改进，使其非常有效。

成功实现这一点将为您的工具箱中留下一个非常有用的工具（并且可能还有一些出色的经验）。

生成您需要的输出格式有时可能会很棘手，但如果您了解算法内部结构，那么您应该能够输出您需要的任何内容。您还可以引入启发式方法来影响输出并做出某些权衡。

[这是一个页面](http://www.mathertel.de/Diff/)，其中包括一些文档、[完整的源代码](http://www.mathertel.de/Diff/ViewSrc.aspx)以及使用上述算法中的技术的 diff 算法示例。

[源代码](http://www.mathertel.de/Diff/ViewSrc.aspx)似乎紧密地遵循基本算法并且易于阅读。

还有一些关于准备输入的内容，您可能会觉得这很有用。当您按字符或标记（单词）进行区分时，输出存在巨大差异。

祝你好运！

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2009-04-30T06:41:07.723

我将首先查看 GNU[提供](http://ftp.gnu.org/gnu/diffutils/)的 diff的实际*源代码*。

为了*了解*该源代码的实际工作原理，该包中的文档参考了启发它的论文：

> 基本算法在“An O(ND) Difference Algorithm and its Variations”，Eugene W. Myers，'Algorithmica' Vol。1 1986 年第 2 期，第 251-266 页；在“文件比较程序”中，Webb Miller 和 Eugene W. Myers，“软件——实践和经验”卷。15 第 11 期，1985 年，第 1025-1040 页。该算法是独立发现的，如“近似字符串匹配算法”，E. Ukkonen，“信息和控制”卷。64，1985，第 100-118 页。

阅读论文然后查看实现的源代码应该足以理解它是如何工作的。

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2009-08-27T04:07:13.837

见[https://github.com/google/diff-match-patch](https://github.com/google/diff-match-patch)

> “Diff Match 和 Patch 库提供了强大的算法来执行同步纯文本所需的操作。......目前在 Java、JavaScript、C++、C# 和 Python 中可用”

另请参阅[wikipedia.org 差异页面](http://en.wikipedia.org/wiki/Diff)和 - “ [Bram Cohen：差异问题已解决](http://bramcohen.livejournal.com/37690.html)”

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2013-03-28T21:23:59.930

我来这里是为了寻找差异算法，然后我自己实现了。抱歉，我不知道 vcdiff。

[Wikipedia](http://en.wikipedia.org/wiki/Diff#Algorithm)：从最长的公共子序列中，获得类似差异的输出只是一小步：如果子序列中不存在项目但原始项目中存在，则它必须已被删除。（下面的“-”标记。）如果它在子序列中不存在但出现在第二个序列中，则它必须已添加。（“+”标记。）

[LCS 算法](http://wordaligned.org/articles/longest-common-subsequence)的漂亮动画在这里。

在此处链接到快速[LCS ruby​​ 实现](http://rosettacode.org/wiki/Longest_common_subsequence#Dynamic_programming.2C_walker_class)。

我的缓慢而简单的红宝石改编如下。

```
def lcs(xs, ys)
  if xs.count > 0 and ys.count > 0
    xe, *xb = xs
    ye, *yb = ys
    if xe == ye
      return [xe] + lcs(xb, yb)
    end
    a = lcs(xs, yb)
    b = lcs(xb, ys)
    return (a.length > b.length) ? a : b
  end
  return []
end

def find_diffs(original, modified, subsequence)
  result = []
  while subsequence.length > 0
    sfirst, *subsequence = subsequence
    while modified.length > 0
      mfirst, *modified = modified
      break if mfirst == sfirst
      result << "+#{mfirst}"
    end
    while original.length > 0
      ofirst, *original = original
      break if ofirst == sfirst
      result << "-#{ofirst}"
    end
    result << "#{sfirst}"
  end
  while modified.length > 0
    mfirst, *modified = modified
    result << "+#{mfirst}"
  end
  while original.length > 0
    ofirst, *original = original
    result << "-#{ofirst}"
  end
  return result
end

def pretty_diff(original, modified)
  subsequence = lcs(modified, original)
  diffs = find_diffs(original, modified, subsequence)

  puts 'ORIG      [' + original.join(', ') + ']'
  puts 'MODIFIED  [' + modified.join(', ') + ']'
  puts 'LCS       [' + subsequence.join(', ') + ']'
  puts 'DIFFS     [' + diffs.join(', ') + ']'
end

pretty_diff("human".scan(/./), "chimpanzee".scan(/./))
# ORIG      [h, u, m, a, n]
# MODIFIED  [c, h, i, m, p, a, n, z, e, e]
# LCS       [h, m, a, n]
# DIFFS     [+c, h, +i, -u, m, +p, a, n, +z, +e, +e] 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2009-10-08T08:55:15.910

根据 Emmelaich 给出的链接，在[Neil Fraser 的网站（图书馆的作者之一）](http://neil.fraser.name/writing/diff/)上也有大量的 Diff Strategies 。

他介绍了基本策略，并在文章结尾处介绍了 Myer 算法和一些图论。

# infragistics - 是否有任何与 .NET 的 MonthCalendar 控件等效的 iNFRAGISTICS 控件

> ID：805628
> 
> 赞同：1
> 
> 时间：2009-04-30T06:37:45.920
> 
> 标签：infragistics, calendar-control

我正在寻找与.Net 的月历控件类似的基础设施控件。有吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-30T12:53:07.877

我不确定您正在寻找什么平台，但这里有指向可用日历/日程安排控件的链接：

*   [网络时间表](http://www.infragistics.com/dotnet/netadvantage/aspnet/webschedule.aspx#Overview)
*   [WebDatePicker 和 WebMonthCalendar](http://blogs.infragistics.com/blogs/taz_abdeali/archive/2009/04/27/asp-net-april-2009-ctp-released.aspx)（基于 ASP.NET AJAX 框架 - 2009 年 4 月 CTP）
*   [WinSchedule](http://www.infragistics.com/dotnet/netadvantage/winforms/winschedule.aspx#Overview)
*   [xamMonthCalendar](http://www.infragistics.com/dotnet/netadvantage/wpf/xamMonthCalendar.aspx#Overview)

# c - 如何在内核和用户空间之间创建“netlink”？

> ID：805634
> 
> 赞同：4
> 
> 时间：2009-04-30T06:40:55.103
> 
> 标签：c, linux, linux-kernel, device-driver, netlink

我想使用 netlink 在应用程序和内核空间之间进行通信。我的Linux内核版本是2.6.28，下面是我的错误代码：

```
nf_sock=netlink_kernel_create(NL_PROTO,0,nl_user_skb,THIS_MODULE); 
```

简短的错误消息是：

```
error: too few arguments to function 'netlink_kernel_create' 
```

在文件`<linux/netlink.h>`中，函数`netlink_kernel_create()`定义为

```
extern struct sock *netlink_kernel_create(struct net *net,int unit,unsigned int groups,void (*input)(struct sk_buff *skb),struct mutex *cb_mutex,struct module *module) 
```

我不明白第一个参数使用什么，`net`. 有人可以解释我应该在这里使用什么吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-30T22:12:05.333

A`struct net`包含有关网络名称空间的信息，这是一组可供进程使用的网络资源。请注意，可能有多个网络命名空间（即网络堆栈的多个实例），但大多数驱动程序使用 init_net 命名空间。

您的电话应该类似于以下内容

```
nf_sock = netlink_kernel_create(&init_net,
                                NETLINK_USERSOCK,
                                0,
                                nl_rcv_func,
                                NULL,
                                THIS_MODULE); 
```

where`nl_rcv_func`是一个以`struct sk_buff *skb`唯一参数为参数并处理接收到的 netlink 消息的函数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-30T06:48:32.183

您似乎一直在遵循诸如[this one](http://www.linuxjournal.com/node/7356/print)之类的指南，该指南（从 2005 年开始）很可能已被内核的开发所超越。从内核端创建网络链接的内部 API 似乎已经改变。

检查本地内核树中的 Documentation/ 文件夹以获取一些（希望是更新的）文档，或者阅读代码本身。您还可以搜索 Linux [Kernel](http://lkml.indiana.edu/hypermail/linux/kernel/)邮件列表档案，以了解似乎已经发生的任何更改。

[这里](http://lxr.linux.no/linux+v2.6.29/net/netlink/af_netlink.c)是 2.6.29 的实际实现，如果你想把它倒过来（当然，还没有在你自己的树中检查过）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-13T05:30:38.003

是的，struct net 确实适用于 net 命名空间，但总是使用 init_net 是不合适的，您应该注册自己的 pernet_operations，如下所示：

```
static struct pernet_operations fib_net_ops = {
        .init = fib_net_init,
        .exit = fib_net_exit,
};

static int __net_init fib_net_init(struct net *net)
{
        int error;

#ifdef CONFIG_IP_ROUTE_CLASSID
        net->ipv4.fib_num_tclassid_users = 0;
#endif
        error = ip_fib_net_init(net);
        if (error < 0)
                goto out;
        error = nl_fib_lookup_init(net);
        if (error < 0)
                goto out_nlfl;
        error = fib_proc_init(net);
        if (error < 0)
                goto out_proc;
out:
        return error;

out_proc:
        nl_fib_lookup_exit(net);
out_nlfl:
        ip_fib_net_exit(net);
        goto out;
}

static int __net_init nl_fib_lookup_init(struct net *net)
{
        struct sock *sk;
        struct netlink_kernel_cfg cfg = {
                .input  = nl_fib_input,
        };

        sk = netlink_kernel_create(net, NETLINK_FIB_LOOKUP, &cfg);
        if (sk == NULL)
                return -EAFNOSUPPORT;
        net->ipv4.fibnl = sk;
        return 0;
} 
```

最后：

```
register_pernet_subsys(&fib_net_ops); 
```

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2009-04-30T09:44:44.897

我建议使用[ioctl](http://linux.die.net/man/2/ioctl)进行内核/用户通信。ioctl 接口是标准的，内核之间更新的机会很小。

# c# - 使组合框可编辑

> ID：805638
> 
> 赞同：3
> 
> 时间：2009-04-30T06:41:49.983
> 
> 标签：c#, combobox

我想让组合框在 c# 中可编辑，它应该接受来自键盘和下拉列表的输入，并且我想将输入的文本附加到下拉列表中。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-30T06:46:21.610

你需要：

1) 将 AutoCompleteMode 属性设置为 AutoCompleteMode.SuggestAppend

2) 将 AutoCompleteSource 属性设置为 AutoCompleteSource.CustomSource

3) 将 AutoCompleteCustomSource 属性设置为您可能匹配的 AutoCompleteStringCollection。

# javascript - javascript 所见即所得的 HTML 编辑器？

> ID：805639
> 
> 赞同：2
> 
> 时间：2009-04-30T06:42:37.500
> 
> 标签：javascript, html, cross-browser, dhtml

有哪些选项可以让用户在文本区域中书写并在所有浏览器中工作时使文本变为粗体/斜体/下划线/等？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-30T06:44:56.403

看看[FKCEditor](http://www.fckeditor.net/)，我总是推荐它......

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-30T06:54:08.177

我一直很喜欢 TinyMCE [http://tinymce.moxiecode.com/](http://tinymce.moxiecode.com/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-30T06:53:55.617

我喜欢 YUI 中的富文本编辑器

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-30T06:51:04.143

我用过[InnovaStudio WYSIWYG](http://www.innovastudio.com/editor.asp "InnovaStudio 所见即所得")。相当可扩展且便宜。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-30T07:33:27.473

FCKEditor 是一个受欢迎的选择，尽管它非常臃肿。[jQuery jQuery Plugins](http://plugins.jquery.com/project/Plugins/category/20)中有一个很好的简单示例

我最后写了自己的，因为我非常想自定义编辑器。这并不难，通常涉及在页面上弹出一个 iframe，将 contenteditable 设置为 true，然后使用简单的 javascript 命令更新 iframe 的 html。

# video-streaming - 视频流网站技术

> ID：805641
> 
> 赞同：6
> 
> 时间：2009-04-30T06:44:08.840
> 
> 标签：video-streaming

我们正在评估视频流媒体网站的技术。

从过去 6 年开始，我一直是微软的人。

这里的任何人都可以推荐视频流媒体网站的必要技术，并引用它们的特点，例如：

*   可扩展性，
*   表现，
*   发展努力

此外，一些书籍或其他指针将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-13T15:12:37.423

几年以来，许多技术已用于直播：

*   RTP/RTSP
*   RTMP（Adobe 协议）
*   平滑流式传输（微软动态流式传输）
*   HLS（苹果动态流）
*   HDS（adobe 动态流）

对于专业用途，**Wowza 流媒体服务器**是必须的，因为它可以自动为每个协议调整您的 H264 流。

**Flash 媒体服务器**也很好用，具有相同的功能，但价格稍贵一些。

**统一流**直接作为您的网络服务器 (apache/nginx) 的模块工作。这种工作方式降低了部署成本，并允许您使用一些通用的 HTTP 缓存/代理。但这仅适用于基于 http 的协议（hls、hds、smooth）。

**Red5**非常适合 RTMP/RTP，但仍然不支持任何 http 协议。

# sql - 如何在 sql 2005 或 2008 中使列区分大小写

> ID：805642
> 
> 赞同：16
> 
> 时间：2009-04-30T06:44:25.813
> 
> 标签：sql, sql-server, sql-server-2005, sql-server-2008

是否可以根据列更改默认排序规则？我想让 1 列区分大小写，但其他所有列不区分

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-04-30T06:48:13.870

`ALTER TABLE ALTER COLUMN`允许更改单个列的排序规则：

```
alter table Foo alter column Bar ntext collate Latin1_General_CS_AS 
```

（排序可能不正确）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-30T06:50:18.247

我不特别了解 SQL Server，但普遍接受的 DBMS 做法（为了兼容性）将是：

*   将插入和更新触发器放在表上，以便它们存储在您想要的情况下。
*   在您需要的情况下，使用生成的列来存储该列的另一个副本。

在 SQL Server 中可能有更快的方法来执行此操作，但您应该小心将工作负载推入 SELECT 语句的解决方案 - 它们永远不会很好地扩展。作为插入和更新的一部分，这样做几乎总是更好，因为这是唯一一次数据更改 - 这样做可以最大限度地减少额外的工作量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-15T03:41:29.473

您的问题的答案是肯定的，[Anton Gogolev](https://stackoverflow.com/users/60188/anton-gogolev)已经在上面说明过。

附加信息：

以下是如何根据其版本找到 SQL Server 支持的排序规则列表。

```
select name, 
       COLLATIONPROPERTY(name, 'CodePage') as Code_Page, 
       description
from   sys.fn_HelpCollations() 
```

[Kanatype Sensitive KS和宽度敏感是什么意思](https://stackoverflow.com/questions/7489257/what-is-the-meaning-of-kanatype-sensitive-ks-and-width-sensitive)

# security - 在 JBossWS 中使用用户名令牌时，如何从内存中删除密码？

> ID：805658
> 
> 赞同：0
> 
> 时间：2009-04-30T06:48:46.580
> 
> 标签：security, soap, garbage-collection, jbossws

我将 JBoss Web 服务用于支付服务应用程序。在某些时候，我需要对支付服务提供商进行远程 SOAP 调用，并且需要使用用户名令牌进行身份验证。

我知道如何使用 JBossWS 执行此操作的唯一方法是这样的：

```
Map<String, Object> requestContext = ((BindingProvider)port).getRequestContext();
requestContext.put(BindingProvider.USERNAME_PROPERTY, "foobar");
requestContext.put(BindingProvider.PASSWORD_PROPERTY, "changeme"); 
```

但这里的问题是“changeme”密码现在作为字符串对象在内存中，我无法控制何时（如果有的话）它会被垃圾收集。如果攻击者此时转储内存，他可以找到凭据。

是否有另一种使用 JBossWS 进行安全 SOAP 调用的方法，我可以在其中控制密码在内存中的保留时间？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-30T06:57:06.657

我很确定没有办法。字符串在 Java 中是不可变的，因此您将无法重写字符串。您可以使用字节数组来存储密码，并且可以重写该字节数组。但是无论如何，您可能不得不在某个时候将其转换为字符串...

另一方面，如果攻击者有足够的权限访问您的机器以获取内存转储，那么您无论如何都会被搞砸。如果攻击者已经拥有这么多的访问权限，他几乎可以为所欲为……

# python - 在 django 中运行纯 sql 查询时如何获取字段名称

> ID：805660
> 
> 赞同：16
> 
> 时间：2009-04-30T06:49:33.850
> 
> 标签：python, django

在我的一个 django 视图中，我使用普通 sql（不是 orm）查询数据库并返回结果。

```
sql = "select * from foo_bar"
cursor = connection.cursor()
cursor.execute(sql)
rows = cursor.fetchall() 
```

我得到的数据很好，但不是列名。如何获取返回的结果集的字段名称？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2014-08-15T16:15:44.767

在[Django docs](https://docs.djangoproject.com/en/dev/topics/db/sql/#executing-custom-sql-directly)上，提供了一个非常简单的方法（确实使用`cursor.description`，正如 Ignacio 回答的那样）。

```
def dictfetchall(cursor):
    "Return all rows from a cursor as a dict"
    columns = [col[0] for col in cursor.description]
    return [
        dict(zip(columns, row))
        for row in cursor.fetchall()
    ] 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-04-30T07:30:21.567

根据[PEP 249](http://www.python.org/dev/peps/pep-0249/)，您可以尝试使用`cursor.description`，但这并不完全可靠。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-01-08T12:58:21.083

我在 Doug Hellmann 的博客中找到了一个不错的解决方案：

[http://doughellmann.com/2007/12/30/using-raw-sql-in-django.html](http://doughellmann.com/2007/12/30/using-raw-sql-in-django.html)

```
from itertools import *
from django.db import connection

def query_to_dicts(query_string, *query_args):
    """Run a simple query and produce a generator
    that returns the results as a bunch of dictionaries
    with keys for the column values selected.
    """
    cursor = connection.cursor()
    cursor.execute(query_string, query_args)
    col_names = [desc[0] for desc in cursor.description]
    while True:
        row = cursor.fetchone()
        if row is None:
            break
        row_dict = dict(izip(col_names, row))
        yield row_dict
    return 
```

示例用法：

```
 row_dicts = query_to_dicts("""select * from table""") 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2019-10-17T09:25:18.613

尝试以下代码：

```
def read_data(db_name,tbl_name): 
    details = sfconfig_1.dbdetails
    connect_string = 'DRIVER=ODBC Driver 17 for SQL Server;SERVER={server}; DATABASE={database};UID={username}\
        ;PWD={password};Encrypt=YES;TrustServerCertificate=YES'.format(**details)

    connection = pyodbc.connect(connect_string)#connecting to the server
    print("connencted to db")
    # query syntax 

    query = 'select top 100 * from '+'[{}].[dbo].[{}]'.format(db_name,tbl_name) + ' t where t.chargeid ='+ "'622102*3'"+';'
    #print(query,"\n")
    df    = pd.read_sql_query(query,con=connection)
    print(df.iloc[0])

    return "connected to db...................." 
```

# c# - asp.net：如何在表格单元格背景上将类似于 LinkBut ton 的链接功能与代表连接起来？

> ID：805661
> 
> 赞同：1
> 
> 时间：2009-04-30T06:49:52.820
> 
> 标签：c#, asp.net, javascript, user-controls, delegates

我正在使用 ASP.NET 用户控件。我通过链接按钮通过命令参数将值传递给另一个用户控件，如下所示：

ASP：

```
LinkButton ID="ZoomPhotoLinkButton" CommandArgument='<%#(Eval("conid"))%>' CommandName="PassItemId" runat="server">Zoom It</asp:LinkButton> 
```

我真正想要的是使我的表格的整个背景单元格可单击，以便单击表格单元格上的任何位置都会传递适当的 CommandName 和 CommandArgument 并适当地链接。

在我使用委托进行设置之前，我使用简单的 JavaScript 和将 URL 传递给内联 JavaScript 的内联代码隐藏函数使上述行为如下工作：

（我使用方括号而不是尖括号，因为 StackOverFlow 试图解析我的“表格代码”）：

```
[td] onclick="window.location='<%# FormatDetailPageUrl((object)Eval("conid"))%>'" style='cursor:pointer;text-align: center; border:0px;'[/td] 
```

我正在尝试在单击表格单元格方面做一些功能上等效的事情，除了调用适当的 CommandName 和 CommandArgument 与简单的 Javascript。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-30T06:53:34.433

ASP.Net uses the __doPostBack() function to do this magic. You can call it yourself; the first parameter is the eventTarget, second param is eventArgument.

So in your case, you can do the following:

```
<td onclick="__doPostBack('PassItemId', '<%#(Eval("conid"))%>')"></td> 
```

You might also want to take a look at [Page.GetPostBackEventReference](http://msdn.microsoft.com/en-us/library/aa720099(VS.71).aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-30T06:54:03.107

You can probably achieve this client-side, e.g. using jQuery.

Have a look at this article, which does the same (with DIVs instead of TDs): [http://newism.com.au/blog/post/58/bigtarget-js-increasing-the-size-of-clickable-targets/](http://newism.com.au/blog/post/58/bigtarget-js-increasing-the-size-of-clickable-targets/)

# javascript - 通过unix（firefox）中的javascript读取变量中的html文件

> ID：805667
> 
> 赞同：0
> 
> 时间：2009-04-30T06:52:53.747
> 
> 标签：javascript, html

操作系统：Linux 浏览器：火狐

我需要通过 JavaScript 将 html 文件内容读入字符串变量吗？

可以在 javascript 中使用吗？如果是，请帮助我使用语法/方法来做到这一点

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-30T06:54:51.543

The easiest solution is probably to use the JQuery library.

[http://docs.jquery.com/Ajax/jQuery.get](http://docs.jquery.com/Ajax/jQuery.get)

```
$.get("mypage.html", function(data){
  alert("Data Loaded: " + data);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-30T07:01:45.380

I think that this should do the trick. It's untested but give it a try.

```
document.documentElement.innerHTML 
```

Another approach could be to query the URL through XmlHttpRequest and read the `response.responseText`

# c# - 用值作为 Action 实例创建字典的语法是什么 ?

> ID：805674
> 
> 赞同：2
> 
> 时间：2009-04-30T06:53:56.630
> 
> 标签：c#, generics

我需要创建一个 Dictionary 对象作为成员字段
key = string
value =`Action<T>`每个条目的 T 可能不同的实例，例如 long、int、string（ValueType 或 RefType）

但是在这里无法让编译器同意我的看法。要创建一个成员字段，它似乎需要一个固定的 T 规范。在意识到“不应该这么难”之前，我已经过了挣扎时间的极限

可能是泛型菜鸟错误。请赐教。。

用法是这样的

```
m_Map.Add("Key1", 
   new delegate(long l) {Console.Writeline("Woohoo !{0}", l.ToString();)); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-30T06:56:41.320

你不能，基本上。编译器如何知道您对任何特定条目感兴趣的类型？

您甚至无法解释`Dictionary<Type, Action<T>>`每个字典条目在哪里都有一个类型的键和使用该类型的操作的关系。泛型只是不支持这种关系。

如果您在尝试使用它时*会*`Dictionary<string, Delegate>`知道类型，则可以将其设为 a并在获取时强制转换值。或者，您可以使用`Action<object>`并接受您最终会得到的拳击和演员阵容。

请注意，要使用匿名方法或 lambda 表达式`Delegate`，您需要强制转换 - 或编写一个方便的转换方法：

```
public static Delegate ConvertAction<T>(Action<T> action)
{
    return action;
} 
```

这样你就可以写：

```
Delegate dlg = ConvertAction((long x) => Console.WriteLine("Got {0}", x)); 
```

或在字典上下文中：

```
var dict = new Dictionary<string, Delegate>();
dict["Key1"] = ConvertAction((long x) => Console.WriteLine("Got {0}", x)); 
```

当您再次从字典中取出值时，您仍然需要转换为正确的类型......

**不一样的套路...**

您可以将字典封装在您自己的类型中，并使用通用`Add`方法，而不是直接公开字典：

```
public void Add<T>(string key, Action<T> action) 
```

所以它仍然是`Dictionary<string, Delegate>`幕后的，但你的类型会确保它只包含代表接受单个参数的值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-30T07:06:01.157

每个条目不同`T`，也许标准化`Action<object>`，并在实际操作中进行投射？

```
 static void Main() {
        var m_Map = new Dictionary<string, Action<object>>();
        m_Map.Add("Key1", obj => Console.WriteLine("Woohoo !{0}", obj));
        m_Map.Add("Key2", obj => SomeMethod((int)obj));

        m_Map["Key1"](123);
        m_Map["Key2"](123);
    }
    static void SomeMethod(int i) {
        Console.WriteLine("SomeMethod: {0}", i);
    } 
```

# wpf - 为什么 WPF 中的一切都是模糊的？

> ID：805677
> 
> 赞同：17
> 
> 时间：2009-04-30T06:54:44.773
> 
> 标签：wpf, clarity

有人可以解释为什么 WPF 中的一切都是模糊的吗？这是可以修复的吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-04-30T06:55:21.370

原因是抗锯齿系统会在线条与物理设备像素不对齐时将线条分散到多个像素上。

WPF 与解决方案无关。这意味着您以英寸而不是像素为单位指定用户界面元素的大小。WPF 中的逻辑单位是 1/96 英寸。之所以选择此比例，是因为大多数屏幕的分辨率为 96dpi。所以在大多数情况下，1 个逻辑单元匹配 1 个物理像素。但是如果屏幕分辨率发生变化，这个规则就不再有效。

所有 WPF 控件都提供一个属性`SnapsToDevicePixels`。如果设置为 true，则控件确保所有边缘都精确地绘制在物理设备像素上。但不幸的是，此功能仅在控制级别可用。

来源：[在物理设备像素上精确地画线](http://www.wpftutorial.net/DrawOnPhysicalDevicePixels.html)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-07-22T14:46:07.580

快速解决：

在从根目录到模糊控件的**每个容器**上使用这些选项

```
 UseLayoutRounding="True"
        RenderOptions.BitmapScalingMode="NearestNeighbor"
        SnapsToDevicePixels="True"
        RenderOptions.ClearTypeHint="Enabled" 
```

解释：

*UseLayoutRounding=true*修复子像素布局问题。它们经常发生，因为例如效果将控件的大小调整为像素之间的东西。

*RenderOptions.BitmapScalingMode=NearestNeighbor*修复了位图的模糊采样。使用效果或其他技术时使用位图。当它们被重新应用到容器或控件时，它们可能最终位于像素之间，因此会插入位图的像素。

*SnapsToDevicePixels="True"*修复了在像素之间渲染的垂直和水平多边形、线条和矩形

*RenderOptions.ClearTypeHint="Enabled"*在文本上重新启用 cleartype。它很容易被效果或渲染器不知道文本的确切背景禁用。

您应该在每个容器上使用它，因为有时，例如通过数据模板，这些选项再次默认用于子控件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-07-12T16:08:52.040

我花了几个小时试图找出自定义面板模糊的原因。在这些自定义面板上，我们使用了阴影边框效果。阴影是罪魁祸首。如果面板并排放置，它实际上会导致文本模糊。我没有足够高的声誉来发表评论，所以我正在回答这个问题。

```
UseLayoutRounding="True" 
```

是 ecreif 回答的我的问题的解决方法。虽然我不需要他回答中的其他代码行，但我还是添加了它们。

# java - GZIP compression did not work good for a data of 64K

> ID：805679
> 
> 赞同：1
> 
> 时间：2009-04-30T06:55:05.850
> 
> 标签：java, compression

Hi I have created compressin and decompression technique using gZipinputstream in both c#.NET and java If I compress upto 15000 bytes in c#.NET then i can decompress it in java but if i compress 64000 bytes in c#.NET then i am not able to decompress it in java. But I can decompress it using C#.NET. So how to come out of this problem

Thanks Bapi

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-30T08:15:34.487

猜测您可能在 .net 代码中使用了 DEFLATE_64。这将压缩最多 64K 块，DEFLATE，这是 Java 支持的，最多只能压缩 32K 块。在 .net 方面，尝试将您的压缩器设置为仅使用 DEFLATE 而不是允许它使用 DEFLATE_64，您可能会有更多的运气。

# css - 浮动时奇怪的div边框问题

> ID：805682
> 
> 赞同：3
> 
> 时间：2009-04-30T06:55:28.437
> 
> 标签：css, html, border

我能否解释一下为什么这段代码会产生它的结果？如果可能的话，还有一种修复它/解决它的方法。

我不希望 div 'z' 和 'q' 越过右侧的“蓝色 div 边框”。

或者

我希望 div 'x' 与 'z' 和 'q' 一致，并且也可以越过蓝色的右边框。

```
<div style='margin: 5px;width: 653px;border: blue 1px solid;float: left;'>
    <div style='margin: 0px; margin-bottom: 5px;width: 100%;border: red 1px solid;/*float: left;*/'>z</div>
    <div style='overflow: hidden;margin: 0px; margin-bottom: 5px;width: 100%;border: red 0px solid;/*float: left;*/'>
            <div style='margin: 0px; margin-bottom: 0px;width: 300px;border: red 1px solid;float: left;'>y</div>
            <div style='margin: 0px; margin-bottom: 0px;width: 300px;border: red 1px solid;float: right;'>x</div>
    </div>
     <div style='margin: 0px; margin-bottom: 5px;width: 100%;border: red 1px solid;/*float: left;*/'>q</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-30T07:08:23.790

您是通过什么浏览器生成屏幕截图的？如果是IE，框模型有问题导致计算100%宽度时忽略边框宽度。

您可以创建一个不可见的容器来调整内部 div 的大小，或者将内部 div 的大小调整为 container.width -2。

另外，尝试删除*width: 100%;* 从 div 的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-30T07:06:01.033

红色边框实际上位于图像中的蓝色边框内 - 但我假设您想增加 z 和 q 容器的边距......

我冒昧地将属性用双引号括起来并更正了重新声明的样式规则（边距和边距底部）-但为行格式道歉-我似乎无法理解所有留在这个论坛的代码块中，直到我取出换行符：

```
<div style="margin: 5px;width: 653px;border: blue 1px solid;float: left;"><div style="margin: 5px;width: 100%;border: red 1px solid;">z</div><div style="overflow: hidden;margin: 5px;width: 100%;border: red 0px solid;"><div style="margin: 0px;width: 300px;border: red 1px solid;float: left;">y</div><div style="margin: 0px;width: 300px;border: red 1px solid;float: right;">x</div></div><div style="margin: 5px;width: 100%;border: red 1px solid;">q</div> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-03T14:23:37.640

对于这种情况，您的设计可能正在运行，但由于您没有清除和处理浮动元素，因此很容易中断。

您可以参考我创建的示例。我为此类问题创建了一个工作小提琴。

[http://jsfiddle.net/mayankipsa/e7snvdag/](http://jsfiddle.net/mayankipsa/e7snvdag/)

```
.floatLeft { float: left;}
.floatRight { float: right;}
.clearBOTH { clear: both; }

.redBorder{border:1px solid red;}
.blueBorder{border:1px solid blue;}

.x,.y{width:49%;margin:1px; }
.z{margin:1px;}
.q{margin:1px;}
```

```
<div style='margin: 5px;width: 653px;border: blue 1px solid;float: left;'>
    <div style='margin: 0px; margin-bottom: 5px;width: 100%;border: red 1px solid;/*float: left;*/'>z</div>
    <div style='overflow: hidden;margin: 0px; margin-bottom: 5px;width: 100%;border: red 0px solid;/*float: left;*/'>
            <div style='margin: 0px; margin-bottom: 0px;width: 300px;border: red 1px solid;float: left;'>y</div>
            <div style='margin: 0px; margin-bottom: 0px;width: 300px;border: red 1px solid;float: right;'>x</div>
    </div>
     <div style='margin: 0px; margin-bottom: 5px;width: 100%;border: red 1px solid;/*float: left;*/'>q</div>
</div>

<div class="clearBOTH"></div>
<div class="blueBorder" style="margin-top:50px;">
    <div class="z redBorder">z</div>
    <div class="redBorder">
        <div class="y floatLeft redBorder">y</div>
        <div class="x floatRight redBorder">x</div>
        <div class="clearBOTH"></div>
    </div>
    <div  class="q redBorder">q</div>
</div>
```

# php - Php file encryption methods. Does something simple exist?

> ID：805686
> 
> 赞同：7
> 
> 时间：2009-04-30T06:56:55.783
> 
> 标签：php, file, encryption

It's seems that there isn't any pleasant way to encrypt a file in php.

The built in methods of php, mcrypt, aren't very portable as most servers don't support them.

Command line encryption tools are like ugly hacks.

There's encryption for strings which is nice, but if we want to encrypt a file it doesn't help very much especially for someone else to unencrypt it.

Other encryption tools require public keys, key rings, private keys, blood sample... These seem much too complicated for just encrypting a file.

It seems that we should just have a simple function for PHP that could work like so:

```
$crypt = new Crypt();
$crypt->encryptFile("Password1245!", 'secret_file.txt', 'encrypted_file.txt');
$crypt->decryptFile("Password1245!", 'encrypted_file.txt', 'original_file.txt'); 
```

Any one have any ideas? I'm pulling out hair!

EDIT: Another thing I should add, for the end user to be able to decrypt the file with ease.

**Basically I'm trying to find something that can replace a password protected zip file**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-30T07:02:40.230

Take a look at the [PEAR encryption packages](http://pear.php.net/packages.php?catpid=6&catname=Encryption). They don't all rely on mcrypt - for example [Crypt_Blowfish](http://pear.php.net/package/Crypt_Blowfish/docs/latest/Crypt_Blowfish/Crypt_Blowfish.html).

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-30T07:16:29.837

如果您不介意安装 mcrypt 扩展，则应使用以下代码：

```
function Encrypt($string, $key)
{
    if (extension_loaded('mcrypt') === true)
    {
        return base64_encode(mcrypt_encrypt(MCRYPT_BLOWFISH, substr($key, 0, mcrypt_get_key_size(MCRYPT_BLOWFISH, MCRYPT_MODE_ECB)), trim($string), MCRYPT_MODE_ECB, mcrypt_create_iv(mcrypt_get_iv_size(MCRYPT_BLOWFISH, MCRYPT_MODE_ECB), MCRYPT_RAND)));
    }

    return false;
}

function Decrypt($string, $key)
{
    if (extension_loaded('mcrypt') === true)
    {
        return trim(mcrypt_decrypt(MCRYPT_BLOWFISH, substr($key, 0, mcrypt_get_key_size(MCRYPT_BLOWFISH, MCRYPT_MODE_ECB)), base64_decode($string), MCRYPT_MODE_ECB, mcrypt_create_iv(mcrypt_get_iv_size(MCRYPT_BLOWFISH, MCRYPT_MODE_ECB), MCRYPT_RAND)));
    }

    return false;
}

function Encrypt_File($source, $destination, $key)
{
    if (extension_loaded('mcrypt') === true)
    {
        if (is_file($source) === true)
        {
            $source = file_get_contents($source);

            if (file_put_contents($destination, Encrypt($source, $key), LOCK_EX) !== false)
            {
                return true;
            }
        }
    }

    return false;
}

function Decrypt_File($source, $destination, $key)
{
    if (extension_loaded('mcrypt') === true)
    {
        if (is_file($source) === true)
        {
            $source = file_get_contents($source);

            if (file_put_contents($destination, Decrypt($source, $key), LOCK_EX) !== false)
            {
                return true;
            }
        }
    }

    return false;
} 
```

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2009-04-30T07:21:04.617

简单的异或呢？

```
function Crypt($source, $key)
{
 $rv='';
 for($i=0;$i<strlen($source);$i++)
 {
  $rv.=chr(ord($source[$i]) ^ ord($key[$i%strlen($key)]));
 }
 return $rv;
} 
```

=> Crypt(Crypt('aaa','key'),'key') 返回 'aaa'。

编辑：当然，你应该使用

```
file_put_contents(Crypt(file_get_contents('file'), 'key')); 
```

对于文件读+写：]

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2009-04-30T07:46:24.540

Yossarian 的 Crypt() 函数已修复：

```
function _Crypt($source, $key)
{
    $result = '';

    for($i = 0; $i < strlen($source); $i++)
    {
        $result .= chr(ord($source[$i]) ^ ord($key[$i % strlen($key)]));
    }

    return $result;
}

_Crypt('aaa', 'key'); // 
_Crypt(_Crypt('aaa', 'key'), 'key'); // aaa 
```

# app-config - Add multiple sections to App.Config

> ID：805688
> 
> 赞同：0
> 
> 时间：2009-04-30T06:57:15.313
> 
> 标签：app-config

I need to add a section to my app.config programmatically. currently i use the Configuration editor where in there is seperate project which contains a class file with al configsection attributes set .I then use the configuration editor access this dll created and add a section .Now i want to access this same ConfigurationClass fill in values programmatically and add multiple sections to the app.config?

Need for this is i have a winForm which contains the server,dbname,usernameand password ,user can connect to multiple databases ovr a server so i need to save this information somewhere .

Thanks ,

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-30T07:19:50.780

配置文件是此信息的最佳位置吗？当然，以编程方式更新它可能会导致运行时错误，这是不可取的。

您能否提供有关不同数据库是什么的更多信息，例如 Live / Test 等，或者仅针对同一环境中的不同方面？

# c++ - Windows Function

> ID：805690
> 
> 赞同：0
> 
> 时间：2009-04-30T06:58:14.920
> 
> 标签：c++, visual-studio, visual-c++

In my project i have 2 radio button "File" and "not File" and i also hav a textbox called "width"..

I need to disable the text box when i click on "not file" radio button and once i click "file" radio button it should enable the textbox..

Can u tell me the function in Windows programming in visual c++

**EDIT** : "Add variable" is disabled when i right click on the textbox

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-30T07:07:33.807

Attach a CTextBox member variable to your text box. Say m_tbWidth. You can do this by right clicking on the textbox in the dialog designer and selecting "Add variable..."

In the handler for File, enter the line m_tbWidth.EnableWindow( TRUE );

And in the handler for NotFile, enter the line m_tbWidth.EnableWindow( FALSE );

# c++ - C++ FastCGI 将 POST 请求解析为各种表单字段

> ID：805691
> 
> 赞同：2
> 
> 时间：2009-04-30T06:59:12.970
> 
> 标签：c++, field, fastcgi

我正在使用 libfcgi++ 在 FastCGI 上编写 C++ 应用程序。当我执行 POST 或 GET 请求时，是否有一个库可以解析不同的字段？

例如，对于 GET /fastcgi.fcgi?var1=data1&var2=data2 会返回更容易访问 var1 和 var2 的内容吗？

对于多部分 POST 请求也是如此。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T05:11:17.973

看起来[fastcgi++](http://www.nongnu.org/fastcgipp/)可能会成功。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-16T17:08:54.007

FastCGI 与 CGICC 库一起工作。CGICC 非常适合您的需求。

# java - 加载 java.util.logging.config.file 进行默认初始化

> ID：805701
> 
> 赞同：27
> 
> 时间：2009-04-30T07:03:22.037
> 
> 标签：java, properties, java.util.logging

我正在尝试`log.properties`在我的应用程序启动时加载自定义文件。

我的属性文件与我的主类在同一个包中，所以我假设`-Djava.util.logging.config.file=log.properties`命令行参数应该加载属性文件。

但是只有当我指定属性文件的完整绝对路径时才会加载属性。任何建议如何使用相对路径？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2011-05-05T20:07:29.523

`java.util.logging`您可以非常轻松地从相对路径动态加载属性文件。这就是我在课堂上放在一个`static {}`街区里的东西。`Main`将您的`logging.properties`文件放入其中`default package`，您可以使用以下代码非常轻松地访问它。

```
final InputStream inputStream = Main.class.getResourceAsStream("/logging.properties");
try
{
    LogManager.getLogManager().readConfiguration(inputStream);
}
catch (final IOException e)
{
    Logger.getAnonymousLogger().severe("Could not load default logging.properties file");
    Logger.getAnonymousLogger().severe(e.getMessage());
} 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-04-30T08:01:03.007

Java 日志不会在整个硬盘中搜索文件。如何查找文件有非常简单的规则。您希望 Java 看到这两个文件属于彼此，但您没有在任何地方这么说。由于 Java 认为属性文件和您的类之间没有任何联系，只是它们位于磁盘上的同一文件夹中，因此它找不到该文件。

`-Djava.util.logging.config.file=log.properties`仅当文件`log.properties`位于 Java 进程的当前目录中时才有效（这可能是非常随机的）。所以你应该在这里使用绝对路径。

另一种解决方案是将文件`logging.properties`移入`$JAVA_HOME/lib/`（或编辑应该存在的文件）。在这种情况下，您不需要设置系统属性。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2010-02-24T04:07:27.723

util logging 不从类路径加载，它需要一个绝对路径，这就是为什么像 log4j 这样的其他日志记录包更容易配置，并且对于获取 abs 路径很痛苦的 Web 应用程序来说更好。

这在 java.util.logging.LogManager 文档中根本没有解释。

# web - 哪些个人数据不应该在网络上发布？

> ID：805702
> 
> 赞同：3
> 
> 时间：2009-04-30T07:03:36.203
> 
> 标签：web, privacy, social, genealogy

我被要求创建一种家庭网站，亲戚可以在其中发布各种家庭成员（主要是祖先）的文章和照片。

面对大量的个人信息，如出生日期、出生地点、结婚日期等，这让我想知道有多少这些信息应该在网络上随时可用。我将在网站上设置密码保护，这样它就不会对*所有人*完全开放。

您对此有何看法？

*   为活着的人隐藏个人信息并为死者展示一切就足够了吗？
*   你如何驯服你内心的极客，他们想在技术上做所有可能的事情，而不是做“正确”的事情？
*   是否有此类问题的清单？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-30T09:13:35.313

您首先要看的是您所在国家/地区的法律。在西班牙，我们有 LPD（数据保护法），允许存储敏感数据，但允许用户修改或删除它，并且未经用户许可不得传播它。此外，您还必须在安全方面进行良好的投资。在我个人看来，我认为您不必显示任何明智的数据，国民身份证，确切的家庭位置，银行数据……如果人们还活着或已经死去，我不会显示它，因为它可能会暴露死者家属的敏感数据。无论如何，我认为最好的办法是与客户达成协议，并通知用户将应用于数据的策略。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-30T07:55:04.643

您需要回答的最重要的问题是：一个真正敬业的人如何滥用信息？我不是指偶然发现您的网站的人，我指的是想要毁掉您的某个用户的人：跟踪者、前配偶或前妻。这些人会不遗余力地想出创造性的方法来使用您的数据，例如从祖先的生活方式中扣除遗传疾病，尝试根据某人必须继承的金额来确定某人的财务背景等。

显然，这个问题无法回答。每当你认为你已经做了一些更简单的事情时，宇宙就会出现一个更好的傻瓜。因此，我会将这个站点创建为一个安全存储，只有用户可以看到他们放在那里的内容。不应支持或允许共享数据。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-30T07:18:26.120

与您的用户交谈并获得有关此问题的反馈。他们的想法是什么？毕竟，如果有反弹，你需要让这些人保持快乐。

我最初的想法是，可获得的信息量可能取决于家庭成员的意愿。

但是，要实现像 Facebook 使用的那样精细的系统将很难构建，并且可能会减慢您的开发时间。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-30T07:36:57.713

在法国，即使是一个人的名字也可能不会公布。[实际上，如果没有向名为CNIL](http://www.cnil.fr/index.php?id=4)的专用机构明确声明，它可能不会存储在计算机中。

从网站：

> CNIL 根据 1978 年 1 月 6 日的法律成立，是一个保护隐私和个人数据的独立行政机构。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-30T07:52:59.360

我建议您设置**隐私政策**。有很多网站可以帮助您解决此问题，或者您可以去看看可以帮助您设置的律师。然后，您可以在您的网站上托管本隐私政策，可以随时通过链接访问。

例如，隐私政策将确保：

*   您已获准使用此个人信息
*   其他访问您网站的人不得将这些信息带走并在其他地方使用。

然后，您可以确保任何访问您网站并输入个人信息、照片等的人都必须勾选一个框以同意隐私政策。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-30T09:51:04.023

死人：发布所有/任何信息，除非它可能影响到一个活着的人。例如，下一代生活的私生子可能不知道。小心由非亲生父母抚养长大的孩子。小心刑事定罪。小心同父异母的兄弟姐妹。

活着的人：除非该人以及受信息影响的任何其他人明确同意，否则不得发布任何信息。即便如此，不发布可能更安全。

如果您在欧盟/欧洲经济区境内，您必须确保无法从欧盟/欧洲经济区以外访问有关在世人员的任何个人信息。（欧盟数据保护法）。如果您在欧盟，请参阅我在[http://easterbrook.org.uk/home_faq.html](http://easterbrook.org.uk/home_faq.html)问题 2 中的示例。

根据瑞典判例法，在互联网上发布家谱或家谱信息似乎是非法的。

在美国，法律相当宽松（披露内容除外），但民事责任可能是一个大问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-30T07:17:49.617

我认为至于祖先，您几乎可以提供任何信息而不必担心。至于活着的人，除了电话号码、电子邮件、SSN（笑）之外，大多数信息可能都可以。它还取决于谁可以创建一个帐户，如果它只是我认为可以显示提供的所有信息的家庭。如果随机的人可以访问它隐藏更多的私人信息。

我还想，因为您为家庭或您自己的网站构建此网站，您可以询问客户他们对隐私的看法。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-30T08:29:47.400

1.  请咨询律师以了解适用于您所在国家/州的确切法律要求。

2.  设身处地为某个人的信息将在系统中可用，并考虑一下您可能担心的是什么（如果您担心自己太极客而无法了解其他“正常”人的担忧，请接近从“我需要能够利用数据的最少信息量”的角度来看，那么您应该至少能够识别出最脆弱的数据）。

3.  询问其信息正在进入系统的人，他们对您现在获得的减少的数据集有何感受。

在考虑到他们可能考虑的任何问题之后，您应该清楚，但如果律师给您的指导非常模糊，那么您可能应该再次与他核实。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-28T12:46:24.490

令人惊讶的是，公共记录实际上*在*美国公开了很长一段时间——其中当然包括结婚地点和孩子的姓名。还有这些数据库。很有可能，这同样适用于您所在的国家/地区。

无论如何，我认为你最好的选择是

1.  找出哪些数据已经是公开信息
2.  告知用户可能存在的风险。**用户不应该做出任何合理的安全决定，**（我不能强调这一点 - 您可以将典型用户建模为始终`Yes`按键的脚本）但他们至少应该理解不要依赖该信息作为密钥。
3.  在最新的隐私政策中完成所有这些
4.  如果用户同意，请检查法律，但它可能更接近最低限度，所以我希望您的隐私政策会更好。
5.  最重要的是对用户诚实。如果您的数据库损坏，请通知用户。

如果您按照这些步骤操作，我认为处理个人数据没有什么可怕的。

# svn - 在 Windows 命令提示符下管道数据

> ID：805706
> 
> 赞同：11
> 
> 时间：2009-04-30T07:04:19.447
> 
> 标签：svn, command-line, backup, svnadmin

我需要获得一个大型（~8gb）svn 存储库的备份转储。我目前的方法涉及使用`svnadmin dump`文件，然后使用 7-Zip 压缩和拆分文件。

```
> svnadmin dump c:\path\to\myrepo > c:\svndump.svn
> 7z svndump.svn svndump.7z      // or whatever the correct syntax is 
```

我想知道是否有一种方法可以跳过这里的中间人，并通过使用管道或其他方式一次性压缩 svn 转储数据？这可能吗？语法是什么？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-04-30T07:15:45.813

[`svnadmin dump`默认情况下转储到标准输出，](http://svnbook.red-bean.com/en/1.1/re31.html)命令行可以使用[switch](http://pwet.fr/man/linux/commandes/7z)[`7z`从标准输入读取`-si`](http://pwet.fr/man/linux/commandes/7z)。

```
svnadmin dump c:\path\to\myrepo | 7z a -si svndump.7z 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-11T17:03:08.637

因为您的示例正是我正在寻找的，所以这就是我作为“转储”我所有存储库的完整解决方案所做的。该解决方案将所有 svn 存储库转储到 7-zip 文件，而无需未压缩的中间文件。

将该批处理文件放在您的“存储库根目录”中，例如 m:\repositories\dump-all.bat

```
pushd %~dp0
SET SEVENZIP="c:\Program Files\7-Zip\7z.exe" a -mx1 -si 
FOR /f "tokens=*" %%i in ('DIR /a:d /b') DO svnadmin dump %%i | %SEVENZIP% ..\_svndump\%%i.dump.7z 
```

而且，如果您需要以低优先级运行它，像这样启动该批处理，这两个进程（7z + svnadmin）都将占用大量 cpu

```
start /low m:\repositories\dump-all.bat 
```

注意：“pushd %~dp0”将“当前目录”设置为批处理文件所在的位置，而不是在“c:\windows\system32”中启动它，如果您从资源管理器中以“以管理员身份运行”启动它。如果工作文件夹在另一个驱动器上，它也可以工作。
无需键入“m:”和“cd \repositories”。如果你从“c:”驱动器启动它。

# flags - 建议在代码中经常使用标志吗？

> ID：805709
> 
> 赞同：7
> 
> 时间：2009-04-30T07:04:58.120
> 
> 标签：flags

我在阅读其他人的代码时遇到了很多标志，

```
if (condition1) 
    var1 = true
else
    var1 = false 
```

然后后来，

```
if (var1 == true)
    // do something. 
```

有很多这样的旗帜。我很想知道，在代码中经常使用标志是否可取？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-30T07:18:22.970

这：

```
if (condition1)
   var1= true;
else
   var1 = false; 
```

是经典的写得不好的代码。
相反，你应该写：

```
var1 = condition1; 
```

是的，标志对于使代码更具可读性并且可能更快非常有用。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-30T07:10:06.593

建议如果`condition1`是相当复杂的东西——比如`if (A && (B || C) && !D)`或包含大量开销（`if (somethingTimeConsumingThatWontChange())`），那么存储该结果而不是复制粘贴代码是有意义的。

如果`condition1`只是一个简单的比较，那么不，我不会使用标志。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-30T07:09:26.190

这是相当主观的，并且取决于代码的其余部分。你所说的“旗帜”有它们的位置。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-30T07:17:45.873

首先，这段代码应该是这样的：

```
var1 = condition1;

if( var1 )

// No need to compare *true* to *true* when you're looking for *true* 
```

至于标志的数量，有更优雅的代码分支方式。例如，在使用 javascript 时，您可以执行以下操作：

```
var methodName = someFunctionThatReturnsAString();

// assuming you name the method according to what's returned
myObject[ methodName ](); 
```

代替

```
if( someFunctionThatReturnsAString === 'myPreferedMethod' ){
    myObject.myPreferedMethod();
}else{
    myObject.theOtherMethod();
} 
```

如果您使用的是强类型语言，多态是您的朋友。我认为该技术被称为*多态调度*

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-30T07:22:32.133

我记得重构书中的这个[Replace Temp var with Query 方法](http://sourcemaking.com/refactoring/replace-temp-with-query)。我认为这种重构将使代码更具可读性，但是，我同意它可能会在查询方法昂贵时影响性能......（但是，也许可以将查询方法放在自己的类中，并且可以缓存结果进入那个班级）。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-30T07:24:26.450

这个问题有点笼统。答案取决于您想做什么以及您希望它使用哪种语言。假设一个 OO 上下文比可能有更好的方法。

如果条件是某个对象状态的结果，那么“标志”应该是对象本身的属性。如果这是正在运行的应用程序的一个条件，并且您有很多这些东西，那么您可能应该考虑使用状态模式/状态机。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-30T17:26:51.087

标志非常有用 - 但要给它们起合理的名称，例如在它们的名称中使用“Is”或类似的名称。

例如，比较：

```
if(Direction)    {/* do something */}
if(PowerSetting) {/* do something else */} 
```

和：

```
if(DirectionIsUp) {/* do something */}
if(PowerIsOn)     {/* do something else */} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-30T07:48:12.273

如果它是可读的并且可以完成工作，那么它没有任何问题。只需使用“has”和“is”前缀使其更具可读性：

```
var $isNewRecord;
var $hasUpdated;

if ($isNewRecord)
{
}

if ($hasUpdated)
{
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-30T07:50:57.197

这取决于条件和使用次数。无论如何，重构为函数（如果条件计算缓慢，最好缓存结果）可能会给你更多可读的代码。

例如考虑一下：

```
def checkCondition():
  import __builtin__ as cached
  try:
      return cached.conditionValue
  except NameError:
      cached.conditionValue = someSlowFunction()
      return cached.conditionValue 
```

* * *

至于编码风格：

> ```
> if (condition1)
>    var1= true
> else
>    var1 = false 
> ```

我讨厌那种代码。它应该是简单的：

```
var1 = condition1 
```

或者如果你想确保结果是布尔值：

```
var1 = bool(condition1) 
```

* * *

> 如果（var1 == 真）

再次。糟糕的编码风格。它的：

```
if (var1) 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-30T07:59:26.427

请记住，该代码可以更易读地编写为

```
var1 = condition1 
```

，如果使用得当，这个赋值有一些有用的属性。一个用例是命名一个复杂的计算而不将其分解为一个函数：

```
user_is_on_fire = condition_that_holds_when_user_is_on_fire 
```

这允许人们解释使用条件来表示什么，这通常从裸条件中并不明显。

如果评估条件代价高昂（或有副作用），则可能还需要在本地存储结果而不是重新评估条件。

一些警告：命名错误的标志会降低代码的可读性。远离使用它们的地方设置的标志也是如此。此外，人们想要使用标志这一事实是一种代码味道，表明人们应该考虑将条件分解成一个函数。

D'A

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-30T08:00:24.647

当您使用预 OO 语言工作时，将其称为标志。它们对于参数化一段代码的行为很有用。

但是，您很快就会发现代码难以遵循。当您通过例如提供对可变功能的引用来抽象出差异时，阅读/更改/维护会更容易。

在函数是一等公民的语言中（例如 Javascript、Haskell、Lisp，...），这是轻而易举的事。

在 OO 语言中，您可以实现一些设计模式，如抽象工厂、策略/策略、...

我个人认为太多开关是代码异味。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-04-30T17:36:21.267

我不喜欢标志的地方是当它们被称为标志时，没有任何评论。

例如

```
void foo(...){

     bool flag;

    //begin some weird looking code

    if (something)
       [...]
      flag = true; 
 } 
```

他们试图反对代码可重复性。在最初的程序员离开后数月/数年必须阅读它的可怜人将很难理解它最初的目的是什么。

但是，如果标志变量有一个代表名称，那么我认为它们是可以的，只要明智地使用（参见其他回复）。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-04-30T17:46:33.990

是的，这只是愚蠢的无意义代码。

您可以将所有这些简化为：

```
if (condition1)
{
  // do something
} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2016-04-18T18:25:33.223

这是我的看法。使用标志的代码：

```
...
if (dogIsBarking && smellsBad) {
  cleanupNeeded = true;
}
doOtherStuff();
... many lines later
if (cleanupNeeded) {
  startCleanup();
}
... 
```

很不干净。程序员只是碰巧按照他的大脑告诉他的顺序编写代码。他只是在一个随机的地方添加了代码，以提醒自己稍后需要清理......他为什么不这样做：

```
...
doOtherStuff();
... many lines later
if (dogIsBarking && smellsBad) {
  startCleanup();
}
... 
```

并且，根据 Robert Martin（清洁代码）的建议，可以将逻辑重构为更有意义的方法：

```
...
doSomeStuff();
... many lines later
if (dogTookADump()) {
  startCleanup();
}
...
boolean dogTookADump() {
  return (dogIsBarking && smellsBad);
} 
```

所以，我已经看到很多代码可以遵循上面的简单规则，但人们却无缘无故地添加复杂性和标志！现在，有些情况下可能需要标志，但在大多数情况下，它们是程序员从过去继承下来的一种风格。

# python - 新手自学python，我还应该学什么？

> ID：805720
> 
> 赞同：10
> 
> 时间：2009-04-30T07:08:06.503
> 
> 标签：python, theory

我是编程新手。我有 1 个学期的计算机科学（我们使用 Java）。我在课程中获得了 A 并且能够完成分配的所有事情，但是我不确定我是否真的理解它。我忽略了文本并通过查看示例程序然后反复试验来学习。除了两个知道 java 或其他 OOP 语言的人外，我领先于全班。

我想学习Python。我还将用我拥有的额外部件构建第二台 PC 并使用 linux。基本上，我想提高我对计算机的了解。这就是我的动力。

现在学习python有什么好的编程理论书籍有用吗？或者我应该阅读更多关于计算机如何在最低级别运行的信息？我认为我知道的不够多，无法提出我想要的问题。

我想为了简单起见，我在问我应该知道什么才能充分利用学习 python。这不是为了职业。这是出于一种想知道的愿望。我不再是计算机科学专业的学生（它也不会直接应用于我预期的职业。）

我不希望在“30 天”或“1 周”内学习。所以，从一个非常基础的水平开始对我来说很好。

提前致谢。我进行了搜索，并没有完全找到我要找的东西。

更新：感谢所有伟大的建议。我在工作中发现了这个网站，但在我的家用电脑上找不到它，所以我现在才开始阅读。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-30T07:29:04.753

我的建议总是从高级抽象开始。您不需要知道逻辑门是如何工作的以及如何使用它们来构建 CPU —— 这是很酷的东西，但是一旦你在更高级别上搞砸了，它就会变得更有意义*。*因此，Python 是作为学习辅助工具的绝佳选择。

[如何像计算机科学家一样思考：使用 Python 学习](http://www.greenteapress.com/thinkpython/thinkCSpy/)可在 Internet 上找到，它是对使计算机运行的高级概念的极好介绍。它甚至是特定于 Python 的。

如果你想让你的大脑由内而外，[SICP](http://mitpress.mit.edu/sicp/full-text/book/book.html)会做得很好。不过，我不推荐它作为第一篇文章；它很重。

这两本书都是高水平的。他们不会教您任何有关内存结构或 CPU 实际功能等低级细节的内容，但无论如何我都会保留这些内容。

D'A

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-30T07:41:33.227

特别是对于您问题的 Python 部分，我强烈推荐Mark Pilgrim 的[http://www.diveintopython3.net/](http://www.diveintopython3.net/)。这是免费的，而且结构很好。

Python是一个不错的选择，你会玩得开心！

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-30T07:24:49.757

[http://www.pythonchallenge.com/](http://www.pythonchallenge.com/)

我认为这个挑战非常适合接触主要的 Python 优势，并且有一个很好的论坛，每个级别都有很多有趣的 Python 线程。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-30T15:34:13.887

这在很大程度上取决于您学习 Python 的总体目标。您是否将其视为学习第二语言或更好地了解计算机以及如何有效地使用编程语言？

从听起来你想更好地了解计算机并成为一名更好的程序员的情况来看。在这方面，学习一门新语言（如 Python）可能对您没有帮助。如果您有兴趣，我仍然建议您学习 Python，但是一旦您学习了一种编程语言，学习一门新语言的大部分时间就是熟悉语法和数据类型（通常）。

你曾提到你不确定是否理解你所学的课程中的材料。如果您觉得自己不了解基本概念（例如循环、类等），那么学习 Python 将有助于您理解编程，因为大多数书籍/指南都会重新审视这些概念（*Learning Python，第 3 版*应该对此有所帮助）。如果您了解这些概念，但不确定如何应用这些概念，那么我的建议是学习数据结构和常用算法（例如排序、搜索等）。

从个人经验来说，我不知道如何将我在入门编程课上学到的知识应用到个人编程项目中。从课程中学习数据结构有助于巩固我之前通过提供基于这些先前知识的算法/数据结构所学的概念。这门课也让我对使用这些数据结构的问题有了不同的思考。

要了解不同类型的数据结构，请参阅：[http://en.wikipedia.org/wiki/List_of_data_structures](http://en.wikipedia.org/wiki/List_of_data_structures)。通常，每个数据结构都用于特定目的（例如，二叉搜索树适用于搜索已排序的信息）。不幸的是，我没有任何书籍推荐（我们班没有使用书籍）。谷歌搜索“数据结构”应该是一个很好的起点。

数据结构也让我思考实现的效率如何。算法的“复杂性”决定了一段给定的代码运行多长时间。这使得比较其他实现并确定哪个更好。

我还想评论一下，在学习计算机概念时，最好的学习方式就是边做边学。一本书/一门课只能解释这么多，其余的你必须自己学习。每个人的学习方式都不同，而编程是一种获取您阅读的材料并以您最能理解的方式思考它的方式。

我希望我回答了你的问题。在这一点上，你真的不需要担心底层硬件。这有助于了解您是否打算将其作为职业（您不是），或者想要针对您正在运行的硬件进行优化（在这种情况下，您不想使用 Python） . Python 是学习数据结构的好选择，因为它为您实现了很多数据结构，但了解它们的用途很重要。

如果您还在上学，请参加数据结构课程，看看您是怎么想的。如果你喜欢它，我建议重新考虑编程/CS 在你的职业生涯中的作用。你不必主修它，但考虑一个辅修或至少一个利用你正在学习的这些技能的职位。我这样说是因为尽管这不是你的专业，但你有兴趣了解计算机的工作原理并采取主动行动，例如学习 Python、构建自己的计算机和安装 Linux。

如果您还有其他问题，请随时提问。祝你好运！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-30T07:18:38.820

Python 是一种高级语言，因此学习计算机如何在最低级别运行不会给您带来太多直接好处。

不要误解我的意思——我坚信计算机的低级操作，例如汇编语言和硬件，是每个优秀程序员都应该熟悉的，因为它确实可以帮助您更有效地使用任何语言进行编程正在使用，高级或低级。但在您获得相当多的经验之前，它不会对您的 Python 编码产生太大影响。如果您刚开始使用 Python，我建议您暂时远离计算机的低级操作并专注于 Python 的基础知识。一旦您对此感到满意，您就可以继续使用 C 之类的东西，然后开始研究一些较低级别的东西可能是合适的。

至于你应该知道的……我猜应该不多。Python 是一门很棒的编程语言。它使简单的事情变得简单，但它足够丰富，可以让你按照自己的方式工作，直至达到高度的复杂性。我建议可能看一个教程；我碰巧知道的是[Python 网站](http://docs.python.org/tutorial/)，但我并不是说它一定是最适合你的。谷歌搜索应该会给你很多入门的机会。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-30T16:41:57.047

几个月前，我开始使用 Python（作为我的第一门编程语言）。我会推荐[Mark Lutz](http://oreilly.com/catalog/9780596513986/)的《Learning Python》。但请记住，要学好，关键是要思想开放、有耐心、愿意工作，并寻找你不理解的东西。

玩得开心！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-30T18:19:01.400

我建议查看[http://www.diveintopython.org/](http://www.diveintopython.org/)上的在线书籍来学习 python。

至于 python 项目，我会尝试学习 Django 框架。它是用于构建 Web 应用程序的框架。他们有一个很好的入门[教程。](http://docs.djangoproject.com/en/dev/intro/tutorial01/#intro-tutorial01)这也将让您体验在 Linux 机器上构建网络服务器。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-30T07:40:45.070

> 提高我的计算机知识

好吧，你到底是什么意思？Python 或任何其他高级语言旨在隐藏所有令人讨厌的细节。这就是为什么它适合非专业人士（例如科学家）的原因之一。

如果你想知道事情的实际工作原理，你应该学习纯 C。但话说回来，如果你不打算从事任何与 SC 相关的职业，那么它没有多大意义。学习一些更高级的算法和数据结构。这会让你变得更有趣、更有用，并且与平台和语言无关。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-30T07:49:00.743

简短**的回答：所有这些**

长答案：

学习你的第一语言总是一个挑战，在你的 Java 经验之后，许多其他语言看起来会简单得多。也就是说，学习编程语言的真正挑战是学习何时使用特定语言——你可以在时机成熟时为你选择的任何东西找到合适的文档。

作为一个具体的开始，跳到维基百科并浏览他们[的编程语言分类列表](http://en.wikipedia.org/wiki/Categorical_list_of_programming_languages)，点击所有你听过的名字（以及任何其他吸引你眼球的名字），如果文章有代码示例，给它一个一两分钟沉浸其中（当然，本文的其余部分会有所帮助）。这里的重点不是要掌握每一种语言（这（1）毫无意义，（2）不可能），而是要掌握现有的语言。对于任何一种语言，都有少数其他类似的语言，如果你至少可以*阅读*大多数这些类别中的一种语言，您将掌握相当大的编程领域。当一个新项目出现时，它让你想起了你发现的某种语言，你可以学习那种语言作为项目的一部分。这听起来可能需要做很多工作，但是在你的第五大语言之后，你就完全数不清了，只是在不知不觉中一直不小心学习了新的语言。

当您停止将一种语言作为您的母语时，您将能够从其他语言的示例中学习，即使您从未使用它们进行过编程。就个人而言，我只写了几个 Haskell 程序，但是能够*阅读*Haskell 让我接触到了很多我可以在更实用的 Scala 和 Python 程序中回收的想法（哦，是的，在你学习了 Python 之后，给 Scala 一个浏览你可能再也不会使用Java了）

即使找到最适合工作的语言也不是全部。在你的工具箱里有很多工具，你可以用你能用的最简单的语言编写项目的每一部分，从而在很短的时间内拼凑出令人惊叹的东西。这可能不适用于所有项目，但是，男孩，你能做一些令人印象深刻的演示吗？

需要很多年才能达到没有编程语言完全陌生的地步（或者至少在一天以上的黑客攻击中是陌生的），但我认为尝试征服一个代表是一个非常健康和现实的长期计划每个粗略类别的样本。祝你好运！

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-30T16:19:01.080

由于 Python 不是我的第一语言，我发现[Python Cookbook](http://oreilly.com/catalog/9780596007973/ "Python 食谱")对学习很有帮助

1.  Python 的能力
2.  “pythonic”的惯用方式来做某事。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-12T06:35:50.320

编程语言教学一直与学习时的陈词滥调联系在一起。“编写程序来学习编程”。我也会提出同样的建议。

如果你打算从基础开始。这当然是最推荐的起点。它很长，但值得所有时间。[http://www.diveintopython.org/](http://www.diveintopython.org/)

因为您喜欢 Java，所以这对您来说可能会更好。[http://www.swaroopch.com/notes/Python](http://www.swaroopch.com/notes/Python)。启动 python 2.x 或 3.0。我个人是 python 3 的粉丝。但对于初学者来说，可能很难获得示例和在线程序的参考。所以对你来说 2.x 可能会更好。但我把它留给你。

就像我开始“编写程序..”一样。你可以从这里开始。

1.  [http://www.spoj.pl/](http://www.spoj.pl/) - 一个编程挑战网站，您可以在其中选择各种主题，主要是算法，并拥有庞大的问题数据库。当然，编程语言的选择取决于您。
2.  [http://projecteuler.net/](http://projecteuler.net/) - 一个数学问题网站，在这里你只需要提交一个答案，这里允许作弊，所以可以随意借用别人的逻辑，但尝试自己编写程序。

在你认为你已经足够熟练掌握python之后，你可以尝试这本书python食谱[http://www.amazon.com/Python-Cookbook-Alex-Martelli/dp/0596007973](https://rads.stackoverflow.com/amzn/click/com/0596007973)中的食谱。

对于应用程序开发，在您认为可以处理之后，从[wxPython](http://www.wxpython.org/download.php)或[PyQt](http://www.riverbankcomputing.co.uk/software/pyqt/download)开始。我个人会建议 PyQt。它反应灵敏，速度快，开发周期不错，我很久没有使用 WxPython，但是我写的几个程序，很久以前，感觉不是很好。再一次，这取决于你。

# c# - 在 C# 中计算大文件的 MD5SUM

> ID：805730
> 
> 赞同：11
> 
> 时间：2009-04-30T07:11:25.263
> 
> 标签：c#, md5, hash, large-files

我正在使用以下代码来计算文件的 MD5SUM -

```
byte[] b = System.IO.File.ReadAllBytes(file);
string sum = BitConverter.ToString(new MD5CryptoServiceProvider().ComputeHash(b)); 
```

这正常工作，但如果我遇到一个大文件 (~1GB) - 例如 iso 映像或 DVD VOB 文件 - 我会收到内存不足异常。

不过，我可以在大约 10 秒内计算 cygwin 中相同文件的 MD5SUM。

请建议我怎样才能让它适用于我的程序中的大文件。

谢谢

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-04-30T07:14:02.760

我建议使用替代方法：

```
MD5CryptoServiceProvider.ComputeHash(Stream) 
```

并只需传入在您的文件上打开的输入流。这种方法几乎肯定*不会*一口气读入内存中的整个文件。

我还要注意，在 MD5 的大多数实现中，可以`byte[]`一次将一个数据块添加到摘要函数中，然后在最后询问哈希值。

# winforms - How can I make some functionality of my WinForm application accessible even if running a Modal Dialog?

> ID：805731
> 
> 赞同：0
> 
> 时间：2009-04-30T07:11:34.343
> 
> 标签：winforms, user-interface, usability

I've got a "Main Window" containing quite a few things, including, in the status bar (at the very bottom of the window), a "Support" button, which the user can use at any time to open a window containing our support phone number, along with a little chat functionality if the user prefers to chat with us.

The problem is that if the program is displaying a modal dialog, the "support" button is not clickable anymore.

Stopping using modal dialogs is not an option ; I use them because I sometimes want to force the user into performing a specific task before I can do something else in the software.

What's the best way to let the user contact the support without having to close the current modal dialog?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-30T07:42:54.533

模态对话框应该表现为模态对话框，即使有可能，用户也不希望能够单击主窗口中的按钮。

您最好的选择是在对话框上也放置一个支持按钮。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-30T07:12:03.560

Using a shortcut key instead of a button may be an option. The functionality could be factorized into a base form class like this :

```
public class BaseForm : Form
{

  protected override bool ProcessDialogKey(Keys keyData)
        {
            if (keyData == Keys.F1)
            {
                SupportForm f = new SupportForm ();
                f.Show();

            }
            return base.ProcessDialogKey(keyData);
        }
  } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T15:28:07.293

不使用模式对话框是一种选择。您可以在所需交互期间禁用界面的其他部分，以从用户那里获取您需要的任何内容。

解决方案是避免用户“必须”做某事的情况。例如，如果用户想在那个时候立即退出应用程序，或者在背景窗口中看到某些内容，或者引用应用程序的另一部分，那么模态对话框通常会妨碍您。不要使用它们，而是设计您的交互，以便如果有所需的操作/信息，它将被折叠到应用程序逻辑中。

想想网站设计——模式对话框在网络上很少见，而且有充分的理由——它们不必要地扰乱了用户的工作流程。然而，许多网站都有“必需的”信息。

不要使用模态对话框；它们是避免更好设计的捷径。

# svn - How do I use MSBuild with SVN?

> ID：805733
> 
> 赞同：4
> 
> 时间：2009-04-30T07:13:30.500
> 
> 标签：svn, msbuild

How does MSBuild called SVN task?

Are there any examples or tutorials?

Thanks for your help.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-30T07:15:35.143

[MSBuild Community Tasks](http://msbuildtasks.tigris.org/) has tasks to do this.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-30T07:22:47.700

我经常只是在[Exec](http://msdn.microsoft.com/en-us/library/x8zx72cd.aspx)任务中调用 svn。到目前为止它运行良好，但也许有理由不这样做。

示例（用于恢复在自动构建期间编辑的 AssemblyInfo 文件）：

```
 <Exec Command="svn revert %(AssemblyVersionFile.RelativeDir)%(AssemblyVersionFile.Filename)%(AssemblyVersionFile.Extension)" /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-30T07:23:37.043

更进一步，我们使用带有 SVN 任务的 Cruisecontrol.net 的 MSBUILD。我们已经使用 CC.net 实现了持续集成 [每天晚上自动构建]，并在构建完成后收到结果的电子邮件通知。这是[cc.net](http://confluence.public.thoughtworks.org/display/CCNET/Welcome+to+CruiseControl.NET)网站

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-02-26T11:48:47.557

MSBuild 扩展包现在也知道了

# java - 如何防止多个对话框同时出现？

> ID：805738
> 
> 赞同：2
> 
> 时间：2009-04-30T07:14:11.920
> 
> 标签：java, multithreading, swing, modal-dialog

当屏幕上已经有一个对话框时，如何避免显示一个对话框？

详细信息：在我的应用程序中，许多计时器正在运行。如果发生致命错误，所有受影响的线程都将显示一个 JDialog（通过 swingx.JXErrorPane.showDialog()），这是不需要的。即使我取消所有正在运行的计时器，仍然会同时出现一些对话框。我怎样才能做到只会出现一个对话框？

我试图使调用 showDialog() 的方法同步，这导致我的整个 GUI 被阻塞。使用标志也不起作用。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-30T07:24:23.720

将对话框变成观察者并将错误事件发布到这个新的观察者（参见[观察者设计模式](http://en.wikipedia.org/wiki/Observer_pattern)）。当事件发生时，对话框应该显示自己（以主框架作为父框架）。在对话框的表格中显示最近的错误。将新错误添加到该表的底部。

另一种选择是在主框架的表格中显示错误。将表格放入 JSplitPane 中，以便用户可以将其最小化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-30T11:00:27.273

另一种选择是将对话框变成单例：

*   给对话框一个私有构造函数。
*   创建一个“私有静态 MyDialog 实例；” - 对话框类中的属性。
*   创建一个“public static MyDialog getInstance() { ... }; - 返回实例的方法，如果它为空，则首先实例化它。

其中 MyDialog 应该是对话窗口类的名称。

然后每次您需要显示对话框时，您只需引用单例：

MyDialog.getInstance().showDialog();

showDialog 只是使对话框窗口可见。

# python - 如何避免在 webapp 模板中硬编码 url

> ID：805751
> 
> 赞同：3
> 
> 时间：2009-04-30T07:20:16.367
> 
> 标签：python, google-app-engine, url, templates, web-applications

我正在谷歌应用引擎上开发软件。我正在使用 webapp 框架。有什么方法可以避免在 html 模板中硬编码 url？django 提供了一个解决方案，但我找不到 webapp 的解决方案。提前致谢..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-30T11:12:41.533

WebApp 真的很基础。

Django`url`模板标签与其通过匹配正则表达式模式解析 URL 的想法密切相关。由于 WebApp 没有任何严肃的 URL 解析器，我想在这一行中实现某些东西将是一项非常艰巨的任务。

但你并非完全不走运。[Werkzeug](http://werkzeug.pocoo.org/)具有非常易于理解但功能强大的 URL 路由机制，允许反转 url。您可以尝试将您的实现基于此（或丢弃 WebApp 并使用 Werkzeug ；），这真的值得一试）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-04-17T05:08:25.173

Webapp 使用 Django 模板，因此：在此处查看[Django 模板](http://docs.djangoproject.com/en/1.3/ref/templates/builtin/#ref-templates-builtin-tags)

Django 解决方案*是*Web 应用程序解决方案。

# flash - 是否可以调用外部影片剪辑的函数或传递数据

> ID：805762
> 
> 赞同：1
> 
> 时间：2009-04-30T07:24:05.233
> 
> 标签：flash, actionscript-3

假设我有 2 个瑞士法郎。

第一个我在第一帧上有一个方法

函数方法A（）：无效{}

第二个将使用加载器类来加载第一个并使用它来调用方法A。

我想知道是否有可能这样做......传递数据怎么样......

我在 AS 3.0 中有点太差了，我可以从外部 swf 传递变量和调用函数，但是如何将值或方法从外部子级传递给父级....因为我想点击外部 swf 并添加到父瑞士法郎

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-30T07:46:09.160

正如 Dr.Dredel 所说，加载外部 swf 后，您可以获得对加载的 swf 的引用并调用方法、添加侦听器、传递数据，就像处理代码中的任何其他对象一样。

例如：

```
var myLoader:Loader = new Loader(); 
var url:URLRequest = new URLRequest("myExternalMovie.swf"); 
myLoader.load(url);
myLoader.contentLoaderInfo.addEventListener(Event.COMPLETE, function(event : Event)
{
    var contenet : MovieClip = event.target.content;
    content.addEventListener(yourEvent.SOMETHING_COMPLETE, yourEventHandler);
    content.property = "someString";
    content.someMethod();

}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-30T07:27:45.537

是的，一旦一个影片剪辑加载了另一个影片剪辑，它们就可以像任何父/子影片剪辑一样相互交谈。您还需要注意如何在子影片剪辑中使用 _root，因为 _root 现在将指向父影片。有一种方法可以将其锁定，以便 _root 指向单个 swf 的根，即使它被加载到更广泛的上下文中，但我不记得确切是如何完成的......类似于 lockroot = true 或一些这样，但你需要查一下。

编辑：抱歉，没有看到问题的 AS3 特定方面。从来没有看过AS3（几年没接触过Flash），所以不知道他们在这个版本中做了什么。

# .net - 通过整数类型枚举的简单迭代？

> ID：805766
> 
> 赞同：5
> 
> 时间：2009-04-30T07:25:01.067
> 
> 标签：.net, vb.net, enums

我有以下枚举：

```
Public Enum myEnum As Integer  
    first = &H1
    second = &H2
    third = &H4
    fourth = &H8
    fifth = &H10
    sixth = &H20
End Enum 
```

不幸的是，枚举元素必须具有这些值，或者至少具有可以进行二进制比较的值。

我有一个可以在构造过程中设置为两种类型之一的类，一种类型的值与第一个到第四个有关，第二种类型的值与第一个到第六个有关。

我想使用 For 循环遍历枚举的 1-4 或 1-6 个元素，但我发现这段代码：

```
For enumType as myEnum = myEnum.first to myEnum.fourth
Next 
```

遍历 {1,2,3,4,5,6,7,8} 而不是 {1,2,4,8}。
这并不理想。

显然我可以围绕这个问题编写代码，但我可以看到在维护编程中很容易错过该解决方法的情况，我希望有人可以推荐一个不会破坏的简单解决方案，例如，枚举必须在以后更改。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-30T07:34:38.453

对不起C#：

```
static IEnumerable<T> EnumRange<T>(T begin, T end)
{
    T[] values = (T[])Enum.GetValues(typeof(T));
    int beginIndex = Array.IndexOf(values, begin);
    int endIndex = Array.IndexOf(values, end);

    for(int i = beginIndex; i <= endIndex; ++i)
        yield return values[i];
}

foreach(MyEnum e in EnumRange(MyEnum.First, MyEnum.Fourth)
    // Code goes here 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-30T07:49:00.353

Marc 基本上是正确的，只是您不需要显式排序（Enum.GetValues 已经返回排序），并且您需要转换输出：

```
enum myEnum
{
    first = 0x1,
    second = 0x2,
    third = 0x4,
    fourth = 0x8,
    fifth = 0x10,
    sixth = 0x20,
}

public static void Main(string[] a)
{
    var qry = from myEnum value in Enum.GetValues(typeof(myEnum))
        where value >= myEnum.first && value <= myEnum.fourth
        select value;
    foreach(var value in qry)
    {
        Console.WriteLine((int)value);
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-30T07:31:10.520

看着`Enum.GetValues(Type)`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-30T07:35:20.493

我希望您需要使用`Enum.GetValues()`，并将结果过滤为您想要的。例如，使用 LINQ ）（并使用 C#，因为我不太了解 VB）：

（注意：这里重要的是`GetValues`- 在 VB 和 C# 之间应该是相同的）

```
static void Main() {
    var qry = from MyEnum value in Enum.GetValues(typeof(MyEnum))
              where value >= MyEnum.First && value <= MyEnum.Fourth
              orderby value // to sort by value; remove otherwise
              select value;

    foreach (var value in qry) {
        Console.WriteLine(value);
    }
}
enum MyEnum { 
    First = 0x01,
    Second = 0x02,
    Third = 0x04,
    Fourth = 0x08,
    Fifth = 0x10,
    Sixth = 0x20
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-11-12T17:34:47.417

我知道这已经得到了回答，但在我看来，这已经被过度思考了。为什么不这样做？

```
 Private Shared Sub Main()

        Dim aryEnums As Array = [Enum].GetValues(GetType(myEnum))

        For i As Integer = 0 To aryEnums.GetLength(0) - 1

            Console.WriteLine(aryEnums(i))

        Next

    End Sub 
```

# .net - 在 C++/CLI 场景中调用 GC::KeepAlive 的便捷方式？

> ID：805769
> 
> 赞同：3
> 
> 时间：2009-04-30T07:26:22.903
> 
> 标签：.net, c++, garbage-collection, finalizer

我正在使用 C++/CLI 编写一些托管包装器。问题是 GC 有时会在我使用它的非托管成员时处理该对象。（我认为这种行为很疯狂，但这是另一个话题）。有关更多详细信息，请参阅：

[终结器在其对象仍在使用时启动](https://stackoverflow.com/questions/134653/finalizer-launched-while-its-object-was-still-being-used) [http://blogs.msdn.com/cbrumme/archive/2003/04/19/51365.aspx](http://blogs.msdn.com/cbrumme/archive/2003/04/19/51365.aspx)

我正在寻找的是一种方便的调用方式：

```
GC::KeepAlive(this); 
```

在每个方法的最后。对于普通的旧 void 方法，它很容易，但对于返回值的方法，它有点棘手。

```
int ComputeInt() {
   return m_unmanagedMember->LongRunningComputation();
} 
```

必须变成：

```
int ComputeInt() {
   int tmp = m_unmanagedMember->LongRunningComputation();
   GC::KeepAlive(this);
   return tmp;
} 
```

这对我来说有点难看。

我考虑了一个在 dtor 中调用 GC::KeepAlive 的保护类，但这会在每个方法中引发 ctor 和 dtor 调用，这似乎有点过分。

是否有任何可用的 C++ 魔法可以让我避免使用临时变量？

### 编辑

我意识到 try + finally 会为我解决问题，即：

```
int ComputeInt() {
   try {
      return m_unmanagedMember->LongRunningComputation();
   } finally {
      GC::KeepAlive(this);
   }
} 
```

最后，我实现了一个宏来处理这个问题：

```
#define KEEPALIVE_RETURN(x) try {\
    return x;\
} finally { System::GC::KeepAlive(this); } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-06T13:51:40.210

怎么样（不是真正检查语法）

```
template<class RType>
const RType& KeepAliveRet(Object^ o, const RType& ret)
{
    GC::KeepAlive(o);
    return ret;
} 

int ComputeInt() {
   return KeepAliveRet(this, m_unmanagedMember->LongRunningComputation());
} 
```

# .net - SqlDateTime.MinValue != DateTime.MinValue，为什么？

> ID：805770
> 
> 赞同：70
> 
> 时间：2009-04-30T07:27:07.097
> 
> 标签：.net, sql-server, datetime, types

我想知道，为什么 SqlDateTime.MinValue 与 DateTime.MinValue 不一样？

* * *

## 回答 #1

> 赞同：132
> 
> 时间：2009-04-30T09:34:15.343

*我认为 SQL 和 .NET 的Date*数据类型之间的差异源于 SQL Server 的*datetime*数据类型，它的最小值和最大值，以及它的精度比 .NET 的 DateTime 数据类型老得多。

随着 .NET 的出现，团队决定 Datetime 数据类型应该有一个更*自然的* 最小值，而 01/01/0001 似乎是一个相当合乎逻辑的选择，当然从*编程语言*而不是*数据库*的角度来看，这个值是更自然。

顺便说一句，在 SQL Server 2008 中，有许多新的基于日期的数据类型（[Date](http://msdn.microsoft.com/en-us/library/bb630352.aspx)、[Time](http://msdn.microsoft.com/en-us/library/bb677243.aspx)、[DateTime2](http://msdn.microsoft.com/en-us/library/bb677335.aspx)、[DateTimeOffset](http://msdn.microsoft.com/en-us/library/bb630289.aspx)）实际上确实提供了更大的范围和精度，并且与 .NET 中的 DateTime 数据类型紧密映射。例如，DateTime2 数据类型的日期范围为 0001-01-01 到 9999-12-31。

SQL Server 的标准“日期时间”数据类型的最小值始终为 1753 年 1 月 1 日（实际上仍然如此！）。我必须承认，我也很好奇这个值的意义，所以做了一些挖掘。我发现如下：

> 从公元 1 年到今天，西方世界实际上使用了两种主要的历法：凯撒大帝的儒略历和教皇格列高利十三世的公历。两种历法的不同之处仅在于一条规则：决定闰年的规则。在儒略历中，所有能被四整除的年份都是闰年。在公历中，所有能被 4 整除的年份都是闰年，除了能被 100 整除（但不能被 400 整除）的年份不是闰年。因此，1700 年、1800 年和 1900 年在儒略历中是闰年，但在公历中不是闰年，而 1600 年和 2000 年在两个历法中都是闰年。
> 
> 教皇格里高利十三世在 1582 年介绍他的日历时，还指示应该跳过 1582 年 10 月 4 日和 1582 年 10 月 15 日之间的日子——也就是说，他说 10 月 4 日之后的日子应该是 10 月 15 日。许多国家不过，延迟转换。英格兰和她的殖民地直到 1752 年才从儒略推算转换为格里高利推算，因此对他们来说，跳过的日期在 1752 年 9 月 4 日至 9 月 14 日之间。其他国家在其他时间转换，但 1582 年和 1752 年是相关日期我们正在讨论的 DBMS。
> 
> 因此，当一个回溯多年时，日期算术会出现两个问题。第一个是，转换前的闰年应该按照儒略规则还是公历规则计算？第二个问题是，应该何时以及如何处理跳过的天数？
> 
> 这就是八大 DBMS 处理这些问题的方式：
> 
> *   假装没有开关。这似乎是 SQL 标准所要求的，尽管标准文档不清楚：它只是说日期“受使用公历日期的自然规则的约束”——无论“自然规则”是什么。这是 DB2 选择的选项。如果假装单一日历的规则始终适用于没有人听说过该日历的时间，则技术术语是“预测”日历有效。因此，例如，我们可以说 DB2 遵循一个预测的公历。
>     
>     
> *   完全避免这个问题。 **Microsoft 和 Sybase 将它们的最小日期值设置为 1753 年 1 月 1 日，安全地超过了美国切换日历的时间。这是可以辩护的，但有时会出现抱怨，这两个 DBMS 缺乏其他 DBMS 所具有的有用功能，而 SQL 标准要求这些功能。**
>     
>     
> *   选择 1582。这就是 Oracle 所做的。Oracle 用户会发现日期算术表达式 1582 年 10 月 15 日减去 1582 年 10 月 4 日得出的值为 1 天（因为 10 月 5 日至 14 日不存在）并且日期 1300 年 2 月 29 日是有效的（因为儒略闰-年规则适用）。当 SQL 标准似乎没有要求时，为什么 Oracle 还要额外麻烦？答案是用户可能需要它。历史学家和天文学家使用这种混合系统而不是预测的公历。（这也是 Sun 在为 Java 实现 GregorianCalendar 类时选择的默认选项——尽管名称如此，但 GregorianCalendar 是一个混合日历。）

以上引文摘自以下链接：

[SQL 性能调优：SQL 中的日期](http://www.informit.com/articles/article.aspx?p=30939)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-04-30T07:29:32.897

因为，在 SQL Server 中，可以存储在日期时间字段 (1753/1/1) 中的最小日期不等于 DateTime .NET 数据类型 (0001/1/1) 的 MinValue。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2010-01-12T13:09:50.370

1753 年是第一个采用公历的日期（英格兰）。至于为什么选择它而不是 01/01/0001 - 这无疑是 1990 年代 SQL Server 还是 Sybase 时的遗留问题。他们一定很早就做出了设计决定，而 Microsoft SQL 团队还没有看到改变它的理由。

由于 .NET 的爆炸式增长并将其集成到 Sql Server 中，现在有了**[DateTime2](http://msdn.microsoft.com/en-us/library/bb677335.aspx)**对象以实现兼容性。如果您是 NHibernate 用户，[您可以在类型映射中提供此类型](http://nhforge.org/blogs/nhibernate/archive/2009/03/11/nhibernate-and-ms-sql-server-2008-date-time-datetime2-and-datetimeoffset.aspx)以避免`DateTime.Min`出现问题

.NET Dates 可以满足除公历之外的其他日历：

*   [日历](http://msdn.microsoft.com/en-us/library/system.globalization.calendar(loband).aspx)
    *   中国阴阳历
    *   东亚LunisolarCalendar
    *   阳历日历
    *   希伯来日历
    *   回历日历
    *   日本日历
    *   日语LunisolarCalendar
    *   朱利安日历
    *   韩国日历
    *   韩语LunisolarCalendar
    *   波斯日历
    *   台湾日历
    *   台湾LunisolarCalendar
    *   泰国佛教日历
    *   UmAlQura日历

JulianCalendar 事实上早于日期`DateTime.MinValue`

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-04-30T07:28:25.473

两个不同的小组决定了关于日期/时间的“最小值”对他们意味着什么。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-04-30T07:29:17.763

SQL 对 DateTime 使用不同的内部表示。

# eclipse - 在 Eclipse 中将导出的类标记为不修改

> ID：805779
> 
> 赞同：0
> 
> 时间：2009-04-30T07:30:52.487
> 
> 标签：eclipse, class, export, readonly

在我的工作中，我确实有 SVN 结帐类和 SVN 导出类。我将这些类分成两个工作集。导出的类是另一个基于功能的项目的成员，我不允许在我的工作区中更改这些类。

当我想修复错误或实现新功能时，我想确定导出的类不会被触及。

我可以用一个标志标记导出的类，我不能在我的工作区中修改这些类。像只读这样的东西会有所帮助。有人知道现有解决方案存在类似问题吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-30T13:46:16.500

我能想到的有两件事在这里可能会有所帮助。

1.  在文件系统中将所有内容标记为只读。如果你在eclipse中编辑，它会提示你是否尝试编辑它，询问你是否要让它读/写。
2.  将所有内容标记为派生。将出现相同类型的提示，警告您它是派生文件。这里的问题是，除非您有一个可以将事物标记为派生的插件，否则您需要标记每个文件。（不过，编写这样一个插件非常容易——如果你想采用这种方法，请给我发电子邮件：scott@javadude.com）

这些都不会完全阻止你，但提示可能会有所帮助（如果你同时做，你会得到两个提示......）

希望这可以帮助！

# google-maps - 捕捉到最近的街道

> ID：805792
> 
> 赞同：5
> 
> 时间：2009-04-30T07:36:03.113
> 
> 标签：google-maps, driving-directions

你们最近一直在用谷歌地图帮助解决我的一些问题，谢谢你们。

我几乎完成了这个 - 只剩下一个问题。当我在地图上放置第一个标记时，它会捕捉到最近的街道（这很好！）但是当我将第一个标记拖到另一个地方时，方向突然混乱了。并且标记得到混合。

[您可以在http://dev.korebogen.dk/gmap/](http://dev.korebogen.dk/gmap/)上查看示例

我需要使移动第一个标记（仍在捕捉）成为可能，当我放置第二个标记时，方向首先加载。但为了使第一个标记再次捕捉，我必须加载方向。

我希望你们中的一些人有一个解决方案。提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-30T07:48:57.263

Blackpool Community Church Javascript Team 有一个[很好的例子](http://econym.org.uk/gmap/snap.htm)（[直接链接到第四个例子](http://econym.org.uk/gmap/example_snappathdrag.htm)）。也可以查看他们的其他示例。

（免责声明：我不隶属于他们，但从他们的例子中学到了很多关于 GMaps 的知识）

编辑：我怀疑地图事件有点像这样触发（伪代码，对于真实事件名称等，请查看 GMaps 文档）：

*   地图点击：mousedown，mouseup，点击：{设置红色标记}
*   拖动红色标记：mousedown, dragstart{red marker}, mouseup, **click:{set marker b}** (mousedown+mouseup), dragend
*   两个标记都设置了吗？是的，获取路线

我的建议是：在 red-marker 和 marker-A dragstart 函数中，设置一些标志“拖动标记”，在 dragend 函数中重置它；在设置标记 B 函数中，仅当我们当前没有拖动某些东西时才设置标记（未设置标志）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-30T17:32:51.697

我之前给你的代码监听了前两次点击，并为每次点击添加了一个标记。问题是，当您拖动第一个标记时，它会再次调用“单击”事件 - 从而在同一位置添加另一个标记。

幸运的是，[click 事件](http://code.google.com/apis/maps/documentation/reference.html#GMap2.click)让您知道是否单击了叠加层。因此，如果覆盖为空，则仅执行添加新标记的代码。*请注意，叠加不是布尔值。*

```
var listener = GEvent.addListener(map, "click", function(overlay, latlng) {
  if (overlay == null) {
    // code to add new marker
  }
}); 
```

# c# - 未加载 shim 插件

> ID：805797
> 
> 赞同：0
> 
> 时间：2009-04-30T07:38:13.560
> 
> 标签：c#, .net

我对整个 shim add-in 有点陌生，所以请放轻松。

这是我所做的：

1）创建共享加载项（new_addin）并将消息框放在on connect proc上

2) 添加 shim 插件项目并选择 word 和 excel

3）然后添加设置项目为三个项目添加主要输出，将 shim vsdrpCOM 和加载项和 ManagedAggregator 的寄存器属性设置为 vsdrpDoNotRegister，它在我的计算机上工作正常。

但是当我在其他计算机上安装它时，它没有加载 .net framwork 2。发生运行时错误，加载行为从 3 更改为 2，我将`try` `catch`加载项启动完成，但它没有出现任何错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-30T08:13:10.683

是否安装了 KB908002？请看我对这个问题的回答：

> [**使 Excel 2002 使用 .NET v2.0.50727 运行时**](https://stackoverflow.com/questions/666592/making-excel-2002-use-net-v2-0-50727-runtime)

# caching - CSS/Jscript 缓存问题

> ID：805800
> 
> 赞同：0
> 
> 时间：2009-04-30T07:39:56.427
> 
> 标签：caching, stylesheet

我对网页设计很陌生，最近一直在做一个[业余摄影](http://www.lesleywilliamson.com)网站。我在周日晚上更新了它，清除了我家用电脑上的缓存等，一切看起来都很好。

问题是当我从工作中检查它时，在公司防火墙后面等，有些页面已经改变，有些没有。例如主页仍然显示被替换的旧图像，而一些画廊页面上有新图像但没有新功能或样式（来自 css/js 文件）。我已经重命名了 js 和 css 文件并删除了旧文件以尝试强制浏览器获取新版本，但它看起来仍然使用旧版本。

我担心访问该站点的人会有一个奇怪/混合版本的站点，这可能是因为它被缓存在某处的公司服务器上而不是单个工作站上吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-30T07:49:03.770

您的公司服务器基础架构（尤其是代理服务器）可能会缓存该站点的某些部分。您可以在来自您网站的标题中检查这一点。FireBug 或 Fiddler2 之类的工具应该能够识别是否涉及代理。抱歉，我不知道要查找的确切标题，因为我目前没有在后面操作以尝试查看。

尽管为什么只有您网站的一部分以这种方式运行，但我无法理解。值得检查。

# macos - Mac os X：平均负载

> ID：805802
> 
> 赞同：7
> 
> 时间：2009-04-30T07:40:55.007
> 
> 标签：macos

我想知道我现在总是在我的计算机上看到我的平均负载，1.76、1.31、1.08。这是什么意思 ？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-04-30T08:00:26.643

如果您的 CPU 是一个热狗摊，负载平均值将告诉您排队等候服务的平均人数。负载小于 1.0 意味着热狗供应商在客户之间有一些空闲时间 - 1.0 意味着，虽然线路永远不会堆积，但某些客户总是在与供应商交谈（谁知道所有热狗都去哪里了。 ..)。具有“低”平均负载并不意味着您的计算机没有做任何事情，但可能会有客户在再次排队之前需要很长时间才能吃掉他们的热狗（也就是说，某些过程可能是在磁盘或网络上等待数据到达时用一些数据唤醒它们），拥有更快的磁盘或网络连接可以提高您的狗总销量。

享受。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-30T07:43:09.760

平均负载尝试随时测量活动进程的数量。作为 CPU 利用率的衡量标准，平均负载很简单，定义不明确，但远非无用。高负载平均值通常意味着系统被大量使用并且响应时间相应地很慢。什么高？... 理想情况下，您希望平均负载低于 3，... 最终，“高”意味着足够高，因此您不需要正常运行时间来告诉您系统过载。

查看负载平均值的结果时，它们是过去 1、5 和 15 分钟的结果

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-30T07:49:09.993

负载指示人工进程如何在队列中等待执行。如果您有这么多进程，至少有一个进程在执行之前总是要排队（不立即执行），那么您的负载将为 1。

正常运行时间的数字是一段时间内的平均值。

# .net - 动态表行未通过 jquery ajax 调用更新

> ID：805803
> 
> 赞同：2
> 
> 时间：2009-04-30T07:41:04.053
> 
> 标签：.net, jquery, asp.net-mvc, ajax, model-binding

通过 jquery ajax 调用提交数据时遇到了一个棘手的问题。基本上，使用 jquery*动态添加*到屏幕中的表单字段的表单值不会在批量保存命令上更新。

基本上我有一个网格列表，它显示保存到数据库的所有当前行，每列包含表单字段。然后我在页面顶部有一个表单，这是您典型的*添加另一个*详细信息表单。您键入您的值，按“添加”，这将通过 jquery json ajax 调用保存到数据库中，并且您的表单数据被添加并反映在列表表的新行中。*（这部分有效）*

我的问题在于当您希望更改*新添加的 jquery 表行中*的表单值时。按下保存按钮时，只会重新保存任何已构建的表格行。您的动态行表单数据不会**保存**。更新调用使用 jquery ajax 和 ASP.NET MVC 模型绑定。在“添加”上，我将一个 asp.net mvc“部分视图”返回到我的 jquery ajax 响应中，并且它被添加到使用`$("#tablename tr:last").after(result)`.

如前所述，我已经推断出新的动态添加的行不会更新。我`IList<Item>`在我的 MVC 模型绑定列表中返回了一个集合到我的控制器操作方法，其中包含整个项目列表，减去新创建的 jquery 动态添加的表单字段行。这就是问题所在，也是为什么当您执行页面刷新时，行会回到初始添加时输入的*原始*表单值。

有什么想法为什么我`IList<Item>`的 's 不会包含这些动态添加的行？在 Firebug 中检查，他们在 name 属性中使用相同的命名约定，一切都应该没问题。

格雷厄姆。

***5 月 1 日 11:00 GMT+10 更新：将模型绑定从 IList 更改为 FormCollection 时，我确实收到了这些值。我不想使用 FormCollection 而不是模型绑定，但是如果我可以通过 FormCol 正确获取它，为什么不使用 IList 模型绑定？我已经将数组条目与工作项进行了比较，它们都符合相同的标准和值。***

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-05T00:02:34.070

我不是 ASP 程序员，但我做了很多 jquery 工作。如果我正确理解您的问题，则您的动态生成的行不会绑定到将执行更新操作的回调函数。

您可以使用 jQuery 'live' 函数（正如 Wikidkaka 试图告诉您的那样）将动态生成的元素绑定到回调，也可以在 ajax 调用返回时触发的回调函数中手动绑定新创建的元素。

我建议使用（我相信）最新版本的 jQuery 中添加的本机实时功能。它将使您不必编写额外的行来手动绑定回调，并使代码维护更容易。

所以改变：

```
$('div.your-save-buttons').click(updateFunction); 
```

到

```
$('div.your-save-buttons').live(updateFunction); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-03T10:29:23.790

使用插件 livequery 来做你想做的事情。你可以在这里找到它 - [http://docs.jquery.com/Plugins/livequery](http://docs.jquery.com/Plugins/livequery)

这不适用于大多数动态添加的元素：

`$("select something").onSomeEvent("do something");`

但是使用 livequery 插件，您可以通过将 JS 代码更改为如下内容来使其工作：

`$("select something").livequery('event name','do something');`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-08T22:51:21.647

如果您的模型上的属性是一个整数列表，您可以使用它`IEnumerable<int>`来获取自动模型绑定。这既适用于参数为 an`IEnumerable<int>`的 Action 方法，也适用于参数为 Model 且属性为 的 Action 方法`IEnumerable<int>`。例如，像这样：

```
<%= Html.Hidden("myField", 1) %>
<%= Html.Hidden("myField", 1) %> 
```

和

```
public ActionResult Update(IEnumerable<int> myField) { } 
```

或者

```
public ActionResult Update(MyModel myModel) { }
public class MyModel {
    public IEnumerable<int> myField { get; set; }
} 
```

# php - 使用 Javascript/PHP/mySQL 的日历

> ID：805806
> 
> 赞同：1
> 
> 时间：2009-04-30T07:41:55.160
> 
> 标签：php, javascript, sql, zend-framework, calendar

对于当前的网络应用程序，我需要一个“类似外观”的日历......以下是日历的一些要求：

*   约会的周视图
*   不同的约会类型
*   直接显示日期的长度和时间（如在 googleCalendar 中）
*   多个约会同时进行
*   仅使用 javascript、php 和任何数据库

我们需要 Zend 框架的日历，所以如果日历不支持 ZF，源代码需要是可编辑的！

你知道有什么适合我需要的日历吗？或者你有什么自己开发的tipps吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-30T07:57:00.897

开发自己的日历的重要提示：不要。日历是*这样*一个时间槽，写起来并不简单。如果您需要提示您最好使用现有的库组件，例如您可以在 jQuery、dojo 等中找到的。

这个问题在这里被问过很多次，其他问题的链接比比皆是。

*   [最佳 JavaScript 日历控件](https://stackoverflow.com/questions/114068/best-javascript-calendar-control)

*   [填充 Web 表单的最佳日历弹出窗口是什么？](https://stackoverflow.com/questions/25367/what-is-the-best-calendar-pop-up-for-populating-a-web-form)

*   [创建 Javascript 日历（完整，不弹出）](https://stackoverflow.com/questions/536999/creating-a-javascript-calendar-full-not-pop-up)

等等等等……

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-30T07:44:59.630

没什么好说的，因为我还没有使用它，但前几天在 Twitter 上看到了这个，我认为它至少可以符合 Javascript 部分的要求。

[http://arshaw.com/fullcalendar/](http://arshaw.com/fullcalendar/)

它是一个 jQuery 日历，来自 john resig（编写 jquery）的 Twitter。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-22T14:14:12.090

dhtmlxScheduler 是您未来项目可能考虑的另一种类似 Outlook 的 Javascript 日历。它支持您提到的功能，并带有服务器端 PHP 连接器，这是一个管理客户端-服务器数据连接的特殊层。dhtmlxScheduler 是双重许可的：GNU GPL 和商业。

[http://www.dhtmlx.com/docs/products/dhtmlxScheduler/index.shtml](http://www.dhtmlx.com/docs/products/dhtmlxScheduler/index.shtml)

（免责声明：我为 DHTMLX 工作）

# .net - 自定义字段不显示

> ID：805807
> 
> 赞同：0
> 
> 时间：2009-04-30T07:42:12.180
> 
> 标签：.net, web-services, sharepoint

我已经制作了一个自定义文本字段并输入了一个默认值。这很好用，但我希望在文本字段中拥有的值是使用 Web 服务。当我尝试启动网络服务时，自定义字段不再显示。我像这个 public CusterNameService.ServiceSoapClient demo = new CusterNameService.ServiceSoapClient(); 我仅此而已，它不再呈现我的文本字段。有人吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-30T08:23:55.450

如果没有看到您用于呈现自定义字段的代码，我们就无能为力了。

此外，您是否查看过 SharePoint 日志以了解呈现的自定义字段是否记录了任何错误。

# mysql - 在 MySQL 中模拟事务安全的 SEQUENCE

> ID：805808
> 
> 赞同：10
> 
> 时间：2009-04-30T07:42:40.743
> 
> 标签：mysql, transactions

我们经常使用带有 InnoDB 存储引擎和事务的 MySQL，但我们遇到了一个问题：我们需要一种很好的方法来在 MySQL 中模拟 Oracle 的 SEQUENCE。要求是： - 并发支持 - 事务安全 - 最大性能（意味着最小化锁和死锁）

我们不在乎某些值是否不会被使用，即序列中的间隙是可以的。有一种简单的方法可以通过创建一个带有计数器的单独 InnoDB 表来实现这一点，但这意味着它将参与事务并引入锁和等待。我正在考虑尝试使用手动锁定的 MyISAM 表，还有其他想法或最佳实践吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2010-02-18T20:38:45.257

如果自动增量不足以满足您的需求，您可以创建一个具有*n 个*命名序列的原子序列机制，如下所示：

创建一个表来存储您的序列：

```
CREATE TABLE sequence (
  seq_name varchar(20) unique not null,
  seq_current unsigned int not null
); 
```

假设您在表中有一行“foo”，您可以像这样原子地获取下一个序列 id：

```
UPDATE sequence SET seq_current = (@next := seq_current + 1) WHERE seq_name = 'foo';
SELECT @next; 
```

不需要锁。两条语句都需要在同一个会话中执行，以便在选择发生时实际定义局部变量@next。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-09-15T05:00:07.383

[MySQL手册](http://dev.mysql.com/doc/refman/5.0/en/innodb-locking-reads.html)中给出了正确的方法：

```
UPDATE child_codes SET counter_field = LAST_INSERT_ID(counter_field + 1);
SELECT LAST_INSERT_ID(); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-05-06T07:14:34.047

我们是一家高交易游戏公司，需要此类解决方案来满足我们的需求。Oracle 序列的特点之一也是可以设置的增量值。

该解决方案使用`DUPLICATE KEY`.

```
CREATE TABLE sequences (
  id BIGINT DEFAULT 1,
  name CHAR(20),
  increment TINYINT,
  UNIQUE KEY(name)
); 
```

要获取下一个索引：

使用存储过程或函数抽象以下内容`sp_seq_next_val(VARCHAR)`：

```
INSERT INTO sequences (name) VALUES ("user_id") ON DUPLICATE KEY UPDATE id = id + increment;<br/>
SELECT id FROM sequences WHERE name = "user_id"; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-30T07:52:30.720

表上的 MySQL Identity 列不会处理这个吗？

CREATE TABLE table_name (id INTEGER AUTO_INCREMENT PRIMARY KEY)

或者您是否希望将其用于其他用途，而不仅仅是插入另一个表格？

如果您也在使用过程语言（而不仅仅是 SQL）编写，那么另一个选项是创建一个包含单个整数（或长整数）值的表和一个存储过程，该过程将其锁定、从中选择、递增它并在返回值之前将其解锁。

（注意 - 在返回值之前始终递增 - 如果出现错误，它可以最大限度地增加不重复的机会 - 或者将整个事物包装在事务中。）

然后，您将独立于您的主要插入/更新调用它（因此它不会被调用机制自动创建的任何事务中捕获），然后将其作为参数传递到您想要使用它的任何地方。

因为它独立于你正在做的其他事情，所以它应该很快并且避免锁定问题。即使您确实看到了由锁定引起的错误（除非您使数据库过载），您也可以第二次/第三次调用它。

# windows - 如何计算 GetModuleFileName 的完整缓冲区大小？

> ID：805814
> 
> 赞同：14
> 
> 时间：2009-04-30T07:45:12.890
> 
> 标签：windows, winapi, getmodulefilename

将[`GetModuleFileName()`](https://msdn.microsoft.com/en-us/library/windows/desktop/ms683197)缓冲区和缓冲区大小作为输入；但是它的返回值只能告诉我们复制了多少个字符，以及大小是否不够（`ERROR_INSUFFICIENT_BUFFER`）。

如何确定保存整个文件名所需的实际缓冲区大小`GetModuleFileName()`？

大多数人使用`MAX_PATH`，但我记得路径可以超过（默认定义为 260）...

（使用零作为缓冲区大小的技巧不适用于此 API - 我之前已经尝试过）

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-30T07:51:42.453

通常的方法是将其大小设置为零，并保证失败并提供分配足够缓冲区所需的大小。分配一个缓冲区（不要忘记空终止的空间）并再次调用它。

在很多情况下`MAX_PATH`就足够了，因为许多文件系统限制了路径名的总长度。但是，可以构造超过 的合法且有用的文件名`MAX_PATH`，因此查询所需的缓冲区可能是个好建议。

不要忘记最终从提供它的分配器返回缓冲区。

**编辑：**弗朗西斯在评论中指出，通常的食谱**不适用于`GetModuleFileName()`**. 不幸的是，弗朗西斯在这一点上是绝对正确的，我唯一的借口是在提供“通常”的解决方案之前我没有去查证。

我不知道那个 API 的作者在想什么，除了它可能在引入时`MAX_PATH`确实是最大的可能路径，使正确的配方变得容易。只需在长度不少于`MAX_PATH`字符的缓冲区中进行所有文件名操作。

哦，是的，不要忘记自 1995 年左右以来的路径名称允许使用 Unicode 字符。因为 Unicode 占用更多空间，所以任何路径名都可以在前面`\\?\`明确请求`MAX_PATH`删除对该名称的字节长度限制。这使问题复杂化。

**[MSDN 在标题为File Names, Paths, and Namespaces](http://msdn.microsoft.com/en-us/library/aa365247.aspx)**的文章中对路径长度有这样的说法：

> ### 最大路径长度
> 
> 在 Windows API（以下段落中讨论的一些例外情况）中，路径的最大长度为`MAX_PATH`，定义为 260 个字符。本地路径按以下顺序构建：驱动器号、冒号、反斜杠、由反斜杠分隔的组件和终止空字符。例如，驱动器 D 上的最大路径是“ `D:\<some 256 character path string><NUL>`”，其中“ `<NUL>`”表示当前系统代码页的不可见终止空字符。（此处使用的字符`<` `>`是为了清晰起见，不能作为有效路径字符串的一部分。）
> 
> 注意 Windows API 中的文件 I/O 函数将“ `/`”转换为“ `\`”，作为将名称转换为 NT 样式名称的一部分，除非使用`\\?\`以下部分中详细说明的“ ”前缀。
> 
> Windows API 有许多函数也有 Unicode 版本，以允许最大总路径长度为 32,767 个字符的扩展长度路径。这种类型的路径由由反斜杠分隔的组件组成，每个组件都达到 函数`lpMaximumComponentLength`参数中返回的值`GetVolumeInformation`。要指定扩展长度的路径，请使用“ `\\?\`”前缀。例如，“ `\\?\D:\<very long path>`”。（此处使用的字符`<` `>`是为了清晰起见，不能作为有效路径字符串的一部分。）
> 
> 注意 32,767 个字符的最大路径是近似的，因为`\\?\`系统在运行时可能会将“”前缀扩展为更长的字符串，并且此扩展适用于总长度。
> 
> " `\\?\`" 前缀也可以用于根据通用命名约定 (UNC) 构建的路径。要使用 UNC 指定此类路径，请使用“ `\\?\UNC\`”前缀。例如，“ `\\?\UNC\server\share`”，其中“server”是机器的名称，“share”是共享文件夹的名称。这些前缀不用作路径本身的一部分。它们表明应该以最少的修改将路径传递给系统，这意味着您不能使用正斜杠来表示路径分隔符，也不能使用句点来表示当前目录。此外，您不能将“ `\\?\`”前缀与相对路径一起使用，因此相对路径仅限于`MAX_PATH` 之前针对不使用“”的路径所述的字符`\\?\`
> 
> 使用API​​创建目录时，指定路径不能太长，不能附加8.3文件名（即目录名不能超过`MAX_PATH`-12）。
> 
> shell 和文件系统有不同的要求。可以使用 shell 用户界面可能无法处理的 Windows API 创建路径。

所以一个简单的答案是分配一个大小的缓冲区`MAX_PATH`，检索名称并检查错误。如果合适，你就完成了。否则，如果它以“ `\\?\`”开头，则获取大小为 64KB 左右的缓冲区（上面的短语“32,767 个字符的最大路径是近似的”在这里有点麻烦，所以我留下一些细节以供进一步研究）然后再试一次。

溢出`MAX_PATH`但不以“”开头`\\?\`似乎是“不可能发生”的情况。同样，接下来要做什么是您必须处理的细节。

对于以“”开头的网络名称的路径长度限制也可能存在一些混淆`\\Server\Share\`，更不用说内核对象名称空间中以“ `\\.\`”开头的名称了。上面的文章没有说，我不确定这个API是否可以返回这样的路径。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-30T09:48:55.587

实施一些合理的策略来增加缓冲区，例如从 MAX_PATH 开始，然后使每个连续的大小比前一个大 1.5 倍（或减少迭代的 2 倍）。迭代直到函数成功。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-01-20T22:05:21.460

虽然 API 证明了糟糕的设计，但解决方案实际上非常简单。很简单，但很遗憾，它必须是这样，因为它可能需要多次内存分配，这有点消耗性能。以下是解决方案的一些关键点：

*   您不能真正依赖不同 Windows 版本之间的返回值，因为它在不同 Windows 版本（例如 XP）上可能具有不同的语义。

*   如果提供的缓冲区太小而无法容纳字符串，则返回值是包括 0 终止符在内的字符数。

*   如果提供的缓冲区足够大以容纳字符串，则返回值是不包括 0 终止符的字符数。

这意味着如果返回值正好等于缓冲区大小，你仍然不知道它是否成功。可能还有更多数据。或不。最后，只有当缓冲区长度实际上大于要求时，您才能确定成功。可悲...

因此，解决方案是从一个小缓冲区开始。然后我们调用 GetModuleFileName 传递确切的缓冲区长度（以 TCHAR 为单位）并将返回结果与它进行比较。如果返回结果小于我们的缓冲区长度，则表示成功。如果返回结果大于或等于我们的缓冲区长度，我们必须用更大的缓冲区再试一次。冲洗并重复直到完成。完成后，我们制作缓冲区的字符串副本 (strdup/wcsdup/tcsdup)，清理并返回字符串副本。该字符串将具有正确的分配大小，而不是我们临时缓冲区的可能开销。请注意，调用者负责释放返回的字符串（strdup/wcsdup/tcsdup mallocs 内存）。

请参阅下面的实现和使用代码示例。我已经使用这个代码十多年了，包括在企业文档管理软件中可能有很多很长的路径。代码当然可以通过各种方式进行优化，例如首先将返回的字符串加载到本地缓冲区（TCHAR buf[256]）。如果该缓冲区太小，您可以启动动态分配循环。其他优化是可能的，但这超出了这里的范围。

**实现和使用示例：**

```
/* Ensure Win32 API Unicode setting is in sync with CRT Unicode setting */
#if defined(_UNICODE) && !defined(UNICODE)
#   define UNICODE
#elif defined(UNICODE) && !defined(_UNICODE)
#   define _UNICODE
#endif

#include <stdio.h> /* not needed for our function, just for printf */
#include <tchar.h>
#include <windows.h>

LPCTSTR GetMainModulePath(void)
{
    TCHAR* buf    = NULL;
    DWORD  bufLen = 256;
    DWORD  retLen;

    while (32768 >= bufLen)
    {
        if (!(buf = (TCHAR*)malloc(sizeof(TCHAR) * (size_t)bufLen))
        {
            /* Insufficient memory */
            return NULL;
        }

        if (!(retLen = GetModuleFileName(NULL, buf, bufLen)))
        {
            /* GetModuleFileName failed */
            free(buf);
            return NULL;
        }
        else if (bufLen > retLen)
        {
            /* Success */
            LPCTSTR result = _tcsdup(buf); /* Caller should free returned pointer */
            free(buf);
            return result;
        }

        free(buf);
        bufLen <<= 1;
    }

    /* Path too long */
    return NULL;
}

int main(int argc, char* argv[])
{
    LPCTSTR path;

    if (!(path = GetMainModulePath()))
    {
        /* Insufficient memory or path too long */
        return 0;
    }

    _tprintf("%s\n", path);

    free(path); /* GetMainModulePath malloced memory using _tcsdup */ 

    return 0;
} 
```

说了这么多，我想指出您需要非常了解 GetModuleFileName(Ex) 的各种其他警告。32/64 位/WOW64 之间存在不同的问题。此外，输出不一定是完整的长路径，但很可能是短文件名或受路径别名的影响。我希望当你使用这样一个函数时，目标是为调用者提供一个可用的、可靠的完整的、长的路径，因此我建议确实确保返回一个可用的、可靠的、完整的、长的绝对路径，以这样的方式它可以在各种 Windows 版本和体系结构之间移植（同样是 32/64 位/WOW64）。如何有效地做到这一点超出了这里的范围。

虽然这是现有的最糟糕的 Win32 API 之一，但我还是希望您能享受编码乐趣。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-07-27T14:59:17.870

使用

```
extern char* _pgmptr 
```

可能会奏效。

从 GetModuleFileName 的文档中：

> 全局变量 _pgmptr 自动初始化为可执行文件的全路径，可用于检索可执行文件的全路径名。

但如果我读到 _pgmptr：

> 当程序不是从命令行运行时，_pgmptr 可能会被初始化为程序名（文件的基本名称，不带文件扩展名）或文件名、相对路径或完整路径。

谁知道 _pgmptr 是如何初始化的？如果 SO 支持后续问题，我会将这个问题作为后续问题发布。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-10-20T21:45:11.787

我的示例是“如果一开始没有成功，则将缓冲区的长度加倍”方法的具体实现。它使用字符串（实际上是 a `wstring`，因为我希望能够处理 Unicode）作为缓冲区来检索正在运行的可执行文件的路径。为了确定它何时成功检索到完整路径，它检查从返回`GetModuleFileNameW`的值与返回的值`wstring::length()`，然后使用该值调整最终字符串的大小以去除多余的空字符。如果失败，则返回一个空字符串。

```
inline std::wstring getPathToExecutableW() 
{
    static const size_t INITIAL_BUFFER_SIZE = MAX_PATH;
    static const size_t MAX_ITERATIONS = 7;
    std::wstring ret;
    DWORD bufferSize = INITIAL_BUFFER_SIZE;
    for (size_t iterations = 0; iterations < MAX_ITERATIONS; ++iterations)
    {
        ret.resize(bufferSize);
        DWORD charsReturned = GetModuleFileNameW(NULL, &ret[0], bufferSize);
        if (charsReturned < ret.length())
        {
            ret.resize(charsReturned);
            return ret;
        }
        else
        {
            bufferSize *= 2;
        }
    }
    return L"";
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-07-19T14:04:00.243

这是 std::wstring 的另一个解决方案：

```
DWORD getCurrentProcessBinaryFile(std::wstring& outPath)
{
    // @see https://msdn.microsoft.com/en-us/magazine/mt238407.aspx
    DWORD dwError  = 0;
    DWORD dwResult = 0;
    DWORD dwSize   = MAX_PATH;

    SetLastError(0);
    while (dwSize <= 32768) {
        outPath.resize(dwSize);

        dwResult = GetModuleFileName(0, &outPath[0], dwSize);
        dwError  = GetLastError();

        /* if function has failed there is nothing we can do */
        if (0 == dwResult) {
            return dwError;
        }

        /* check if buffer was too small and string was truncated */
        if (ERROR_INSUFFICIENT_BUFFER == dwError) {
            dwSize *= 2;
            dwError = 0;

            continue;
        }

        /* finally we received the result string */
        outPath.resize(dwResult);

        return 0;
    }

    return ERROR_BUFFER_OVERFLOW;
} 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2015-04-08T06:16:16.453

Windows 无法正确处理超过 260 个字符的路径，因此只需使用 MAX_PATH。您不能运行路径长于 MAX_PATH 的程序。

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2015-01-13T00:05:25.587

我的方法是使用 argv，假设您只想获取正在运行的程序的文件名。当您尝试从不同的模块获取文件名时，已经描述了没有任何其他技巧的唯一安全方法，可以在此处找到实现。

```
// assume argv is there and a char** array

int        nAllocCharCount = 1024;
int        nBufSize = argv[0][0] ? strlen((char *) argv[0]) : nAllocCharCount;
TCHAR *    pszCompleteFilePath = new TCHAR[nBufSize+1];

nBufSize = GetModuleFileName(NULL, (TCHAR*)pszCompleteFilePath, nBufSize);
if (!argv[0][0])
{
    // resize memory until enough is available
    while (GetLastError() == ERROR_INSUFFICIENT_BUFFER)
    {
        delete[] pszCompleteFilePath;
        nBufSize += nAllocCharCount;
        pszCompleteFilePath = new TCHAR[nBufSize+1];
        nBufSize = GetModuleFileName(NULL, (TCHAR*)pszCompleteFilePath, nBufSize);
    }

    TCHAR * pTmp = pszCompleteFilePath;
    pszCompleteFilePath = new TCHAR[nBufSize+1];
    memcpy_s((void*)pszCompleteFilePath, nBufSize*sizeof(TCHAR), pTmp, nBufSize*sizeof(TCHAR));

    delete[] pTmp;
    pTmp = NULL;
}
pszCompleteFilePath[nBufSize] = '\0';

// do work here
// variable 'pszCompleteFilePath' contains always the complete path now

// cleanup
delete[] pszCompleteFilePath;
pszCompleteFilePath = NULL; 
```

我还没有遇到 argv 不包含文件路径（Win32 和 Win32-console 应用程序）的情况。但以防万一出现上述解决方案的回退。对我来说似乎有点难看，但仍然可以完成工作。

# visual-studio - SVN：同事将文件夹签入存储库，但我无法更新我的版本

> ID：805816
> 
> 赞同：9
> 
> 时间：2009-04-30T07:46:21.153
> 
> 标签：visual-studio, svn, tortoisesvn, visualsvn

昨天在向同事展示如何使用 SVN 时，我们在现有的 Visual Studio 解决方案中创建了一个测试文件夹和文件。我们将其称为“Test”文件夹，其中包含“Test.ascx”和“Test.ascx.cs”两个文件。我们添加了它（或者 Visual SVN 添加了它，因为它很棒），并提交了它。我们还在项目的其他地方添加并提交了其他文件。

我们可以在存储库（和其他文件）中看到它。

在我自己的机器上进行更新以拉下这些新文件导致其他文件被正确拉下，但没有出现测试文件夹。无论我尝试从 VS 和 TortoiseSVN (urgh) Repo 浏览器中的各个点更新多少次，它都看不到有任何要下拉的更改。

我哪里错了？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-30T10:34:21.563

这是一个[已知问题。](http://subversion.tigris.org/ds/viewMessage.do?dsMessageId=1881609&dsForumId=462)

您可以使用

$ svn 更新 --depth=infinity

强制更新。使用 TortoiseSVN，使用子菜单中的“更新到修订版”命令，然后将深度组合框更改为“完全递归”。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-30T07:51:41.627

我以前遇到过这样的幽灵错误，发现最简单的解决方法是删除父文件夹并更新它的父文件夹：

```
Project Root
    Project
        NewFolder 
```

删除*项目*，然后更新*项目根*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-30T07:50:17.447

> > 我们可以在存储库（和其他文件）中看到它。
> > 
> > ...
> > 
> > 无论我尝试从 VS 和 TortoiseSVN (urgh) Repo 浏览器中的各个点更新多少次，它都看不到有任何要下拉的更改。

所以你**可以**或**不能**在存储库浏览器中看到它？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-30T07:52:30.843

您是否提交并更新了 Test 文件夹的父文件夹？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-30T07:54:24.613

我不知道，svn总是告诉我要清理，你试过吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-30T09:50:31.340

这不是一个答案，我知道，但我已经尝试了你们提出的所有解决方案，但我只是以冲突告终，使 TortoiseSVN 崩溃并建立了 Karma。因此，.svn/entries 文件中的可靠编辑对其进行了排序。

到目前为止，我一直是使用 SVN 来管理我的源代码的单一开发人员。其他人没有问题，我只是检查东西。我使用 Visual SVN 作为 .NET 的 SVN 层（它不是很好），我似乎经常遇到问题。我正在执行非常简单的操作，甚至没有分支/标记。简单简单简单。然而我有问题吗？

# php - 将 Mysqli bind_param 与日期和时间列一起使用？

> ID：805828
> 
> 赞同：60
> 
> 时间：2009-04-30T07:51:23.640
> 
> 标签：php, mysql, mysqli

如何使用 PHP mysqli 和 bind_param 将数据插入 MySQL 日期或时间列？

* * *

## 回答 #1

> 赞同：98
> 
> 时间：2009-04-30T08:10:26.683

像任何其他字符串一样

```
$stmt = $mysqli->prepare('insert into foo (dt) values (?)');
$dt = '2009-04-30 10:09:00';
$stmt->bind_param('s', $dt);
$stmt->execute(); 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-07-28T01:17:00.677

PHP 中的时间戳是整数（从 UNIX 纪元开始的秒数）。上述方法的替代方法是使用整数类型的日期/时间参数，以及 MySQL 函数`FROM_UNIXTIME`和`UNIX_TIMESTAMP`

```
$stmt = $mysqli->prepare("INSERT INTO FOO (dateColumn) VALUES (FROM_UNIXTIME(?))");
$stmt->bind_param("i", $your_date_parameter);
$stmt->execute(); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-04-19T17:54:39.340

对于当前日期/时间，您可以使用 MySQL 标准例程。您不必为此做好准备。

```
$query  = "INSERT INTO tablename ";
$query .= "VALUES(?,?,?,NOW()) ";
$preparedquery = $dbaselink->prepare($query);
$preparedquery->bind_param("iii",$val1,$val2,$val3); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-10-06T17:50:37.350

我使用了 date() 函数，这解决了我的问题。

```
$stmt = $mysqli->prepare("INSERT INTO FOO (dateColumn) VALUES ?");
// 6/10/2015 10:30:00
$datetime = date("Y-m-d H:i:s", mktime(10, 30, 0, 6, 10, 2015));
$stmt->bind_param("s", $datetime);
$stmt->execute(); 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2018-01-19T08:57:25.553

首先使用 date() 函数设置日期和时间-

```
$date=date("d/m/y");
$time=date("h:i:sa"); 
```

然后将它传递给准备好的语句，就像任何其他字符串变量一样 -

```
$stmt = $mysqli->prepare("INSERT INTO FOO (dateColumn, timeColumn) VALUES (?,?)");
$stmt->bind_param("ss", $date , $time);
$stmt->execute(); 
```

# c# - 如何取消订阅使用 lambda 表达式的事件？

> ID：805829
> 
> 赞同：27
> 
> 时间：2009-04-30T07:51:31.783
> 
> 标签：c#, .net, c#-3.0, event-handling, lambda

我有以下代码让 GUI 响应集合中的更改。

```
myObservableCollection.CollectionChanged += ((sender, e) => UpdateMyUI()); 
```

首先，这是一个好方法吗？

第二：取消订阅此事件的代码是什么？是否相同但使用 -= （然后再次使用完整的匿名方法）？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-04-30T08:12:00.110

首先...是的，它是一种很好的方法，它干净、小巧且易于阅读和理解...当然需要注意的是“除非您以后想退订”。

我相信[Jon Skeet](https://stackoverflow.com/questions/183367/unsubscribe-anonymous-method-in-c/183380#183380)之前指出，“规范明确地不保证使用匿名方法创建的委托的等效性时的行为。”

因此，如果您稍后需要取消订阅该事件，您最好实际创建一个委托实例，以便您稍后可以挂起该引用。

```
var myDelegate = delegate(sender, e){UpdateMyUI()};

myObservableCollection.CollectionChanged += myDelegate;

myObservableCollection.CollectionChanged -= myDelegate; 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-04-30T08:05:51.840

如果您需要取消订阅某个事件，则需要一个实例化引用。不幸的是，这意味着您不能使用该特定语法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-11-17T08:02:09.220

这是一个不错的方法，除非 myObservableCollection 的寿命比“this”长，在这种情况下，您最终可能会出现内存泄漏，因为在幕后创建的委托将保留对您的“this”的引用，这将使它保持活力。如果您反复创建和“销毁”正在侦听事件的任何内容，您会发现垃圾收集器没有收集它们。

如果这是一个问题，您可以走答案中建议的路线，保留对您必须首先创建的处理程序的引用。

另一种解决方案是使用弱引用来创建一个事件处理程序，如果没有其他引用，它将允许收集订阅者。我在[这个问题和答案](https://stackoverflow.com/questions/1747235/weak-event-handler-model-for-use-with-lambdas/1747236#1747236)中探索了这个解决方案。

# wcf - RhinoMock 帮助：模拟 WCF 服务

> ID：805832
> 
> 赞同：4
> 
> 时间：2009-04-30T07:51:48.800
> 
> 标签：wcf, silverlight, rhino-mocks

我正在尝试使用 RhinoMock 来模拟 wcf 服务。

假设我有以下服务：

```
 [OperationContract]
    List<User> SearchUsers(UserSearchFilter filter); 
```

使用 Visual Studio 添加此服务将生成一个代理，该代理具有如下接口：

```
 public interface ResourceService {

    System.IAsyncResult BeginSearchUsers(UserSearchFilter filter, System.AsyncCallback callback, object asyncState);

    ObservableCollection<User> EndSearchUsers(System.IAsyncResult result);
} 
```

然后我创建一个使用此服务的 ViewModel，如下所示：

```
 private ResourceService service;
    public ViewModelBase(ResourceService serv)
    {
        service = serv;
        var filter = new UserSearchFilter();
        service.BeginSearchUsers(filter, a =>
        {
            this.Users = service.EndSearchUsers(a); 
        }, null);
    } 
```

那么问题来了。如何使用 RhinoMock 模拟此服务？

```
 [TestMethod]
    public void UserGetsPopulatedOnCreationOfViewModel()
    {
        // Is stub the right thing to use?
        ResourceService serv = MockRepository.GenerateStub<ResourceService>();

        // Do some setup... Don't know how?
        var vm = new ViewModel(serv);

        Assert.IsTrue(vm.Users.Count > 0);
    } 
```

如果有人可以帮助我正确使用 RhinoMock，我真的很高兴

（注意：我使用的是 Silverlight，但我认为这不会改变 RhinoMock 的使用方式）

非常感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-30T15:58:48.350

我写了一篇由[4 部分组成的文章](http://houseofbilz.com/HouseOfBilz/archive/2008/11/18/testing-wcf-service-apps-part-0-of-4.aspx)，全部关于测试使用 WCF 服务的应用程序。

[第 2 部分](http://houseofbilz.com/archive/2008/11/29/testing-wcf-service-apps-part-2-of-4.aspx)讨论使用 RhinoMocks 模拟服务

[第 3 部分](http://www.houseofbilz.com/archive/2008/12/19/testing-wcf-service-apps-part-3-of-4.aspx)讨论使用 Moq 模拟异步服务

请注意，第 3 部分可以很容易地转换为 RhinoMocks。我只是想展示不同的模拟框架，并且该技术不依赖于模拟框架。

希望能帮助到你！

**编辑** 因此，在 Rhino Mocks 中，您可以在设置中执行此操作：

```
mockService.YourEvent += null;
IEventRaiser loadRaiser = LastCall.IgnoreArguments().GetEventRaiser(); 
```

然后在播放中，你这样做：

```
loadRaiser.Raise(mockService, CreateEventArgs()); 
```

[您可以在Phil Haack 的博客文章](http://haacked.com/archive/2006/06/23/UsingRhinoMocksToUnitTestEventsOnInterfaces.aspx)中找到更多关于在 Rhino 中模拟事件的信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-30T15:54:03.743

我将创建服务将实现的接口（IResourceService）。然后在 Silverlight 端创建调用 WCF 服务本身的 IResourceService 的自定义实现。

RihnoMock 将为 IResourceService 接口而不是为 WCF 服务创建存根。

使用 Prism 2 非常容易，您可以在此处阅读更多内容：

[http://mokosh.co.uk/post/2009/04/19/prism-2-wpf-and-silverlight-services/](http://mokosh.co.uk/post/2009/04/19/prism-2-wpf-and-silverlight-services/)

# wpf - 如何将我的 RoutedCommand 处理程序从 View-codebehind 移动到 ViewModel？

> ID：805838
> 
> 赞同：8
> 
> 时间：2009-04-30T07:53:29.453
> 
> 标签：wpf, mvvm, conceptual, routed-commands

以下 RoutedCommand 示例有效。

但是，执行命令的按钮的处理**是在 view 的代码隐藏中**。我理解 MVVM 的方式，它**应该在 ViewModel 中**。

但是，当我将该方法移动到 ViewModel（并将其更改为 public）时，我收到错误“ **ManagedCustomersView 不包含 OnSave 的定义**”。即使我将 RoutedCommand 第二个参数更改为 typeof(ManageCustomersViewModel)，我也会收到相同的错误。

*如何将命令处理程序从 View-codebehind 移动到 ViewModel？*

**ManageCustomersView.xaml：**

```
<UserControl.CommandBindings>
   <CommandBinding Command="local:Commands.SaveCustomer" Executed="OnSave"/>
</UserControl.CommandBindings>
...
<Button Style="{StaticResource formButton}" 
   Content="Save" 
   Command="local:Commands.SaveCustomer"
   CommandParameter="{Binding Id}"/> 
```

**ManageCustomersView.xaml.cs：**

```
private void OnSave(object sender
                    , System.Windows.Input.ExecutedRoutedEventArgs e)
{
    int customerId = ((int)e.Parameter);
    MessageBox.Show(String.Format
        ("You clicked the save button for customer with id {0}.", customerId));
} 
```

**命令.cs：**

```
using System.Windows.Input;
using TestDynamicForm123.View;

namespace TestDynamicForm123
{
    public class Commands
    {
        public static RoutedCommand SaveCustomer = 
             new RoutedCommand("SaveCustomer", typeof(ManageCustomersView));
    }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-30T07:56:43.080

您将在 ViewModel 中公开一个引用该命令的属性。

```
class MyViewModel
{
    public RoutedCommand SaveCmd{ get{ return Commands.SaveCustomer; } }
} 
```

然后在 XAML

```
<Button Command="{Binding SaveCmd}" /> 
```

[但是，您可能会发现使用RelayCommand](http://msdn.microsoft.com/en-us/magazine/dd419663.aspx)更容易，因此您也可以在模型中定义实际的命令逻辑。

# voting - 客户投票系统/引擎？

> ID：805844
> 
> 赞同：5
> 
> 时间：2009-04-30T07:55:58.637
> 
> 标签：voting, feedback

我在谈论一些像[http://uservoice.com/](http://uservoice.com/)这样的网络东西 你能推荐任何其他类似的服务、网站，或者可能是（甚至更好）一个现成的引擎，可以在自己的服务器上部署吗？

实际上，更多关于系统的问题，可以安装在您自己的服务器上。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-11-21T10:32:32.937

[UseResponse ，商业版（完整的源代码可在购买时获得），于 2011 年 12 月推出，在](http://www.useresponse.com)[USWebStyle](http://support.uswebstyle.com)网站上提供现场演示。完全可定制（设计、功能）。

反馈类型（想法、问题、问题、感谢）、投票类型（正面和/或负面）是可调整的。

可安装在任何 PHP 5.2/5.3 托管环境中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-30T08:07:36.813

[TenderApp](http://tenderapp.com/)似乎有很多相同的功能，但它也是 SaaS。

[KBPublisher](http://www.kbpublisher.com/)可以安装在您的服务器上。

顺便说一句，像 UserVoice 这样的 SaaS 系统中的大多数都可以让您将自己的域/子域转发到他们的服务并应用自定义品牌，因此最终用户的体验与您在实际站点上的体验非常相似。

# msbuild - 每晚构建和虚拟机

> ID：805863
> 
> 赞同：1
> 
> 时间：2009-04-30T08:04:44.700
> 
> 标签：msbuild, virtual-machine, build-server, nightly-build

在我这里，我们正在编写服务器端应用程序（WCF 服务），我们期待自动安装并在我们的夜间构建过程中运行它......此外，我们期待在不同的服务器上一次又一次地安装它......

我们正在寻找：

1.  什么是夜间构建的最佳工具？（我们目前正在使用 TeamCity，但它只适用于 CI，不适用于 Nighty Build 要求）
2.  有没有人构建它的解决方案\项目并将它们安装在虚拟机上？（您可以附加\链接一些用于此安装的自动代码吗？）

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-30T08:26:14.570

TeamCity 是一个很棒的工具。它支持为夜间构建安排像 CC.NET 这样的构建。你有什么样的问题？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-30T08:29:33.343

看看[FinalBuilder](http://www.finalbuilder.com/finalbuilder.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-30T08:24:37.677

尝试 NAnt 进行构建： http: [//nant.sourceforge.net/](http://nant.sourceforge.net/)

和 CruiseControl.NET 用于持续集成： [http ://confluence.public.thoughtworks.org/display/CCNET/Welcome+to+CruiseControl.NET](http://confluence.public.thoughtworks.org/display/CCNET/Welcome+to+CruiseControl.NET)

两者都是开源的:-D

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-01T07:45:54.407

TeamCity 将与 CC.Net 等一样处理夜间构建。

你的评论

> 据我所知，这个 TC 对于 CI 而不是 NihgtlyBuild 来说已经足够好了。因为我们无法配置安装windows-services，安装在远程机器上，当然我们可以使用Msbuild，但是这一切都很难写。

[使用Microsoft.SDC.Tasks](http://blogs.msdn.com/csell/archive/2006/07/12/microsoft-sdc-tasks-new-version-released.aspx)做这些（当然是 IMO）并不是特别困难

# html - IE6和IE7上的链接问题

> ID：805865
> 
> 赞同：4
> 
> 时间：2009-04-30T08:05:36.553
> 
> 标签：html, css, internet-explorer-6

我最近在一个特定的问题上遇到了 IE6 的困难，这是我正在处理的 html 位：

```
<a href="http://www.mylink.com" style="display:block;width:200px;height:200px;">
   <span style="display:block;width:100px;height:100px;">
      <img src="img.jpg" alt="My image" />
   </span>
</a> 
```

Firefox 等一切都很好，但是通过直接单击 IE6 上的图像，链接将无法使用（但可以在链接上的其他任何地方使用）。

这是一个链接： [http ://www.daniel-rico.com/demos/ie/](http://www.daniel-rico.com/demos/ie/)

有人有想法吗？

谢谢！

*   编辑：这在 IE7 上也不起作用：/

* * *

感谢您的回答！
我确实需要 span 标签。我应该多解释一下我想做什么；在这里：
我需要一个可点击的框。在里面我需要：

*   另一个固定大小的盒子，其中包含动态图像（随机比例）
*   一些文字

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-30T17:18:01.607

我刚试了一下：

```
<span style="display:block;width:100px;height:100px;">   
<a href="http://www.mylink.com" style="display:block;width:200px;height:200px;">
      <img src="img.jpg" alt="Click your image now" />   
</a>
</span> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-30T08:14:32.927

删除 span 标签，我认为你不需要它

```
<div style="width: 200px; height: 200px;">
    <a href="http://www.mylink.com" style="display: block; width: 100px; height: 100px;">
        <img src="img.jpg" alt="My image"/>
    </a>
</div> 
```

如果您可以控制标记，则提取内联样式并使用

```
<div id="link">
    <a href="http://www.mylink.com">
        <img src="img.jpg" alt="My image"/>
    </a>
</div> 
```

在文档的头部添加对外部样式表的引用

```
<head>
    <link rel="stylesheet" type"text/css" href="/Css/Style.css"/>
</head> 
```

创建 style.css 并添加

```
div#link
{
    width: 200px;
    height: 200px;
}

div#link a
{
    display: block;
    width: 100px;
    height: 100px;
} 
```

如果您在多个地方使用这种样式的链接，请删除 div 上的 id 并替换为

```
<div class="link">
    ...
</div> 
```

并将css中的选择器从 # 更改为 .

```
div.link
... 
```

如果您仅在 IE6 中遇到问题，您还可以使用条件注释来包含修复 IE6 特定问题的样式表

```
<head>
<!--[if IE 6]>
    <link rel="stylesheet" type="text/css" href="/Css/IE6.css"/>
<![endif]-->
</head> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-30T09:53:34.423

奇怪的是，从跨度中删除宽度和高度属性允许您单击图像。

```
<a href="http://www.mylink.com" style="display:block;width:200px;height:200px;">
   <span style="display:block;">
      <img src="img.jpg" alt="My image" />
   </span>
</a> 
```

当然，这完全改变了布局，但它可能有助于解决 IE 错误。

另一种方法是使用带有背景图像的 div 而不是 img 元素：

```
<a href="http://www.mylink.com" style="display:block;width:200px;height:200px;">
   <span style="display:block;width:100px;height:100px;">
      <div style="background-image:url(img.jpg);width:100px;height:100px;" title="My Image"><div>
   </span>
</a> 
```

**编辑：**

background-image 解决方案不适用于您在评论中提到的随机比例图像。如果你只是想在模型中实现布局：

```
<a href="http://www.mylink.com" style="display:block;width:200px;height:200px;padding-left:10px;">
      <img src="img.jpg" alt="My image" />
      <span style="padding-left:10px;">some text</span>
</a> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-10-11T04:45:58.750

我在内容管理的站点中构建导航时遇到了几乎相同的问题，但由于某些导航项需要在新窗口中打开这一事实而更加复杂 - 这意味着使用 javascript 的解决方案变得有问题。

最终，我最终丢失了 <img... /> 标签并替换为 <span... /> 并将背景图像设置在 span 内（我本可以使用 div，但根据 W3C，这是一种不好的形式）。

所以回到你原来的例子，我会去：

```
<a href="http://www.mylink.com" style="display:block;width:200px;height:200px;">
  <span style="display:block;width:100px;height:100px;">
    <span style="background-image=url(/img.jpg); width: 50px; height: 50px; display: block;">
      <span class="Hidden">My image</span>
    </span>
  </span>
</a> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-30T08:55:54.717

使该区域可点击的最简单方法是添加*position: relative* to your link style; 要在 IE6 下保留光标样式，可以将*cursor:hand*添加到 span 元素。

```
a{ position: relative; display: block; width: 200px; height: 200px; }
span{ display: block; width: 100px; height: 100px; cursor: hand } 
```

正如其他人所建议的，最好将 IE6 特定样式与条件注释块分开。

希望它有所帮助，祝你好运；）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-30T11:13:15.027

我无法仅使用 CSS 解决此问题，我使用 Javascript 强制该区域可点击。令人失望，但很好，它的工作...

感谢大家的帮助！我很感激 ：）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-11-09T15:37:15.877

尝试申请 span css 属性“zoom:0;”。它适用于我的情况。

# firefox - 严格的文档类型阻止访问 FireFox 中的 DOM 变量

> ID：805868
> 
> 赞同：1
> 
> 时间：2009-04-30T08:06:17.910
> 
> 标签：firefox, dom, doctype

我不知道这是否是众所周知的“东西”或任何版本的 Firefox 中的新东西，它也刚刚更新了自己 - 但无论哪种情况，我都不知道如何用谷歌搜索这个问题，所以我不得不问它这里。

我的 DOM 中有一个 DIV，我试图通过 id 直接访问它，最简单的形式如下：

```
 alert(btnTest.id); 
```

这在所有浏览器中都可以正常工作，但在 Firefox 中导致问题实际上导致浏览器处于奇怪的“损坏”状态。

我得到的错误是'btnTest 没有定义'。我在 Safari、Internet Explorer 或 Chrome 中没有收到此错误。

我假设我的 HTML 标签不匹配，或者 JavaScript 花括号或其他东西丢失了。最终，在剥离所有内容后，我尝试删除 DOCTYPE。突然在 Firefox (v 3.0.10) 中，它开始按预期返回正确的 ID。

到底是怎么回事！！！?? 当然，“严格”模式应该允许我访问命名元素，如果没有，那么为什么所有其他浏览器都允许我访问。

**注意：**我可以使用 $('#btnTest')[0].id 轻松解决它，这是我现在必须要做的，直到我能找到更好的解决方案。

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
 <html xmlns="http://www.w3.org/1999/xhtml" class="blueCircles">

 <head>

    <script type="text/javascript"
            src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>

    <script>
        $(function() {
            alert("ID retrieved through jQuery: " + $('#btnTest')[0].id);
            alert("ID retrieved by accessing global variable: " + btnTest.id);
        });

    </script>

</head>
<body>
    <div id="btnTest">
    </div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-08T13:13:49.590

在任何 W3C 规范中都没有说对象引用应该在具有`id`属性的元素的全局脚本范围内建立。这被认为会不必要地污染全局命名空间，并可能导致[令人困惑的错误](http://webbugtrack.blogspot.com/2007/09/bug-162-global-namespace-pollution-in.html)。

出于 IE 兼容性的目的，Firefox 在以怪异模式运行时会建立引用。Johnny Stenback 在[关于添加此支持的错误](https://bugzilla.mozilla.org/show_bug.cgi?id=256932)的第三条评论中解释了为什么在标准模式下不支持此功能：

> 此功能确实会影响标准兼容代码，例如检查全局变量的存在 [*原文如此*] 以仅设置一次。通过这一更改，“变量”[*原文如此*]现在可能是对文档中元素的引用，并且代码可能无法按照开发人员的预期工作。
> 
> 这就是我们决定只做这个怪癖的原因。

# iphone - 如何在 UIView 下绘制阴影？

> ID：805872
> 
> 赞同：357
> 
> 时间：2009-04-30T08:07:04.053
> 
> 标签：iphone, objective-c, ios, cocoa-touch, core-graphics

`UIView`我正在尝试在 Cocoa Touch的底部边缘下绘制阴影。我知道我应该用它`CGContextSetShadow()`来绘制阴影，但是 Quartz 2D 编程指南有点含糊：

1.  保存图形状态。
2.  调用函数`CGContextSetShadow`，传递适当的值。
3.  执行所有要应用阴影的绘图。
4.  恢复图形状态

我在`UIView`子类中尝试了以下内容：

```
- (void)drawRect:(CGRect)rect {
    CGContextRef currentContext = UIGraphicsGetCurrentContext();
    CGContextSaveGState(currentContext);
    CGContextSetShadow(currentContext, CGSizeMake(-15, 20), 5);
    CGContextRestoreGState(currentContext);
    [super drawRect: rect];
} 
```

..但这对我不起作用，我对（a）下一步去哪里和（b）我是否需要做任何事情来完成`UIView`这项工作？

* * *

## 回答 #1

> 赞同：790
> 
> 时间：2011-02-23T23:15:27.377

一种更简单的方法是在初始化时设置视图的一些层属性：

```
self.layer.masksToBounds = NO;
self.layer.shadowOffset = CGSizeMake(-15, 20);
self.layer.shadowRadius = 5;
self.layer.shadowOpacity = 0.5; 
```

您需要导入 QuartzCore。

```
#import <QuartzCore/QuartzCore.h> 
```

* * *

## 回答 #2

> 赞同：234
> 
> 时间：2011-03-25T03:03:38.420

```
self.layer.masksToBounds = NO;
self.layer.cornerRadius = 8; // if you like rounded corners
self.layer.shadowOffset = CGSizeMake(-15, 20);
self.layer.shadowRadius = 5;
self.layer.shadowOpacity = 0.5; 
```

这会减慢应用程序的速度。只要您的视图是明显的矩形，添加以下行可以提高性能：

```
self.layer.shadowPath = [UIBezierPath bezierPathWithRect:self.bounds].CGPath; 
```

* * *

## 回答 #3

> 赞同：161
> 
> 时间：2014-03-14T05:26:19.060

相同的解决方案，但只是提醒您：您可以直接在情节提要中定义阴影。

前任：

![在此处输入图像描述](https://i.stack.imgur.com/BPrQV.png)

* * *

## 回答 #4

> 赞同：99
> 
> 时间：2009-04-30T12:48:11.727

在您当前的代码中，您保存`GState`当前上下文，将其配置为绘制阴影 .. 并将其恢复到配置为绘制阴影之前的状态。然后，最后，您调用超类的`drawRect`: 实现。

任何应该受阴影设置影响的绘图都需要在*之后发生*

```
CGContextSetShadow(currentContext, CGSizeMake(-15, 20), 5); 
```

但*之前*

```
CGContextRestoreGState(currentContext); 
```

因此，如果您希望超类`drawRect:`被“包裹”在阴影中，那么如果您像这样重新排列您的代码呢？

```
- (void)drawRect:(CGRect)rect {
    CGContextRef currentContext = UIGraphicsGetCurrentContext();
    CGContextSaveGState(currentContext);
    CGContextSetShadow(currentContext, CGSizeMake(-15, 20), 5);
    [super drawRect: rect];
    CGContextRestoreGState(currentContext);
} 
```

* * *

## 回答 #5

> 赞同：45
> 
> 时间：2016-10-20T08:24:59.893

你可以试试这个....你可以玩这些价值观。`shadowRadius`指示模糊量。`shadowOffset`指示影子去哪里。

> 斯威夫特 2.0

```
let radius: CGFloat = demoView.frame.width / 2.0 //change it to .height if you need spread for height
let shadowPath = UIBezierPath(rect: CGRect(x: 0, y: 0, width: 2.1 * radius, height: demoView.frame.height))
//Change 2.1 to amount of spread you need and for height replace the code for height

demoView.layer.cornerRadius = 2
demoView.layer.shadowColor = UIColor.blackColor().CGColor
demoView.layer.shadowOffset = CGSize(width: 0.5, height: 0.4)  //Here you control x and y
demoView.layer.shadowOpacity = 0.5
demoView.layer.shadowRadius = 5.0 //Here your control your blur
demoView.layer.masksToBounds =  false
demoView.layer.shadowPath = shadowPath.CGPath 
```

> 斯威夫特 3.0

```
let radius: CGFloat = demoView.frame.width / 2.0 //change it to .height if you need spread for height 
let shadowPath = UIBezierPath(rect: CGRect(x: 0, y: 0, width: 2.1 * radius, height: demoView.frame.height)) 
//Change 2.1 to amount of spread you need and for height replace the code for height

demoView.layer.cornerRadius = 2
demoView.layer.shadowColor = UIColor.black.cgColor
demoView.layer.shadowOffset = CGSize(width: 0.5, height: 0.4)  //Here you control x and y
demoView.layer.shadowOpacity = 0.5
demoView.layer.shadowRadius = 5.0 //Here your control your blur
demoView.layer.masksToBounds =  false
demoView.layer.shadowPath = shadowPath.cgPath 
```

> 传播示例

[![传播示例](https://i.stack.imgur.com/z4pwm.png)](https://i.stack.imgur.com/z4pwm.png)

> 创建基本阴影

```
 demoView.layer.cornerRadius = 2
    demoView.layer.shadowColor = UIColor.blackColor().CGColor
    demoView.layer.shadowOffset = CGSizeMake(0.5, 4.0); //Here your control your spread
    demoView.layer.shadowOpacity = 0.5 
    demoView.layer.shadowRadius = 5.0 //Here your control your blur 
```

> Swift 2.0 中的基本阴影示例

[![输出](https://i.stack.imgur.com/OjGBu.png)](https://i.stack.imgur.com/OjGBu.png)

* * *

## 回答 #6

> 赞同：19
> 
> 时间：2016-02-12T21:53:38.270

*使用 Interface Builder 的简单而干净的解决方案*

在您的项目中添加一个名为 UIView.swift 的文件（或将其粘贴到任何文件中）：

```
import UIKit

@IBDesignable extension UIView {

    /* The color of the shadow. Defaults to opaque black. Colors created
    * from patterns are currently NOT supported. Animatable. */
    @IBInspectable var shadowColor: UIColor? {
        set {
            layer.shadowColor = newValue!.CGColor
        }
        get {
            if let color = layer.shadowColor {
                return UIColor(CGColor:color)
            }
            else {
                return nil
            }
        }
    }

    /* The opacity of the shadow. Defaults to 0\. Specifying a value outside the
    * [0,1] range will give undefined results. Animatable. */
    @IBInspectable var shadowOpacity: Float {
        set {
            layer.shadowOpacity = newValue
        }
        get {
            return layer.shadowOpacity
        }
    }

    /* The shadow offset. Defaults to (0, -3). Animatable. */
    @IBInspectable var shadowOffset: CGPoint {
        set {
            layer.shadowOffset = CGSize(width: newValue.x, height: newValue.y)
        }
        get {
            return CGPoint(x: layer.shadowOffset.width, y:layer.shadowOffset.height)
        }
    }

    /* The blur radius used to create the shadow. Defaults to 3\. Animatable. */
    @IBInspectable var shadowRadius: CGFloat {
        set {
            layer.shadowRadius = newValue
        }
        get {
            return layer.shadowRadius
        }
    }
} 
```

然后，这将在 Interface Builder 中为 Utilities Panel > Attributes Inspector 中的每个视图提供：

[![实用程序面板](https://i.stack.imgur.com/N5Uox.png)](https://i.stack.imgur.com/N5Uox.png)

您现在可以轻松设置阴影。

注意：
- 阴影不会出现在 IB 中，仅在运行时出现。
- 正如 Mazen Kasser 所说

> 对于那些未能使其正常工作的人 [...] 确保 Clip Subviews ( `clipsToBounds`) 未启用

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2011-10-24T06:00:24.473

我将其用作我的实用程序的一部分。有了这个，我们不仅可以设置阴影，还可以为任何`UIView`. 你也可以设置你喜欢的颜色阴影。通常黑色是首选，但有时，当背景不是白色时，您可能需要其他东西。这是我使用的 -

```
in utils.m
+ (void)roundedLayer:(CALayer *)viewLayer 
              radius:(float)r 
              shadow:(BOOL)s
{
    [viewLayer setMasksToBounds:YES];
    [viewLayer setCornerRadius:r];        
    [viewLayer setBorderColor:[RGB(180, 180, 180) CGColor]];
    [viewLayer setBorderWidth:1.0f];
    if(s)
    {
        [viewLayer setShadowColor:[RGB(0, 0, 0) CGColor]];
        [viewLayer setShadowOffset:CGSizeMake(0, 0)];
        [viewLayer setShadowOpacity:1];
        [viewLayer setShadowRadius:2.0];
    }
    return;
} 
```

要使用它，我们需要调用它 -`[utils roundedLayer:yourview.layer radius:5.0f shadow:YES];`

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2016-12-14T23:15:14.767

# 斯威夫特 3

```
extension UIView {
    func installShadow() {
        layer.cornerRadius = 2
        layer.masksToBounds = false
        layer.shadowColor = UIColor.black.cgColor
        layer.shadowOffset = CGSize(width: 0, height: 1)
        layer.shadowOpacity = 0.45
        layer.shadowPath = UIBezierPath(rect: bounds).cgPath
        layer.shadowRadius = 1.0
    }
} 
```

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2018-08-22T08:17:15.513

如果您想使用 StoryBoard 并且不想继续输入运行时属性，您可以轻松地创建视图扩展并使其在 Storyboard 中可用。

步骤 1\. 创建扩展

```
extension UIView {

@IBInspectable var shadowRadius: CGFloat {
    get {
        return layer.shadowRadius
    }
    set {
        layer.shadowRadius = newValue
    }
}

@IBInspectable var shadowOpacity: Float {
    get {
        return layer.shadowOpacity
    }
    set {
        layer.shadowOpacity = newValue
    }
}

@IBInspectable var shadowOffset: CGSize {
    get {
        return layer.shadowOffset
    }
    set {
        layer.shadowOffset = newValue
    }
}

@IBInspectable var maskToBound: Bool {
    get {
        return layer.masksToBounds
    }
    set {
        layer.masksToBounds = newValue
    }
}
} 
```

第 2 步。您现在可以在情节提要中使用这些属性[![故事板图像](https://i.stack.imgur.com/UlFpR.png)](https://i.stack.imgur.com/UlFpR.png)

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2015-07-08T04:55:29.630

对于在此处尝试所有答案后未能使其正常工作的人（作为我自己！），只需确保在属性检查器中未启用**剪辑子视图...**

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2019-11-11T15:58:21.637

**在 Swift 4 中使用 IBDesignable 和 IBInspectable 绘制阴影**

> **如何使用它**

[![演示](https://i.stack.imgur.com/YOobC.gif)](https://i.stack.imgur.com/YOobC.gif)

> **并排草图和 XCODE**

[![影子示例](https://i.stack.imgur.com/gtTgz.png)](https://i.stack.imgur.com/gtTgz.png)

> **代码**

```
@IBDesignable class ShadowView: UIView {

    @IBInspectable var shadowColor: UIColor? {
        get {
            if let color = layer.shadowColor {
                return UIColor(cgColor: color)
            }
            return nil
        }
        set {
            if let color = newValue {
                layer.shadowColor = color.cgColor
            } else {
                layer.shadowColor = nil
            }
        }
    }

    @IBInspectable var shadowOpacity: Float {
        get {
            return layer.shadowOpacity
        }
        set {
            layer.shadowOpacity = newValue
        }
    }

    @IBInspectable var shadowOffset: CGPoint {
        get {
            return CGPoint(x: layer.shadowOffset.width, y:layer.shadowOffset.height)
        }
        set {
            layer.shadowOffset = CGSize(width: newValue.x, height: newValue.y)
        }

     }

    @IBInspectable var shadowBlur: CGFloat {
        get {
            return layer.shadowRadius
        }
        set {
            layer.shadowRadius = newValue / 2.0
        }
    }

    @IBInspectable var shadowSpread: CGFloat = 0 {
        didSet {
            if shadowSpread == 0 {
                layer.shadowPath = nil
            } else {
                let dx = -shadowSpread
                let rect = bounds.insetBy(dx: dx, dy: dx)
                layer.shadowPath = UIBezierPath(rect: rect).cgPath
            }
        }
    }
} 
```

> **输出**

[![演示输出](https://i.stack.imgur.com/haMSV.png)](https://i.stack.imgur.com/haMSV.png)

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2017-09-13T11:09:53.673

您可以使用我为阴影和角半径创建的实用函数，如下所示：

```
- (void)addShadowWithRadius:(CGFloat)shadowRadius withShadowOpacity:(CGFloat)shadowOpacity withShadowOffset:(CGSize)shadowOffset withShadowColor:(UIColor *)shadowColor withCornerRadius:(CGFloat)cornerRadius withBorderColor:(UIColor *)borderColor withBorderWidth:(CGFloat)borderWidth forView:(UIView *)view{

    // drop shadow
    [view.layer setShadowRadius:shadowRadius];
    [view.layer setShadowOpacity:shadowOpacity];
    [view.layer setShadowOffset:shadowOffset];
    [view.layer setShadowColor:shadowColor.CGColor];

    // border radius
    [view.layer setCornerRadius:cornerRadius];

    // border
    [view.layer setBorderColor:borderColor.CGColor];
    [view.layer setBorderWidth:borderWidth];
} 
```

希望对你有帮助！！！

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2017-08-11T17:38:28.693

斯威夫特 3

```
self.paddingView.layer.masksToBounds = false
self.paddingView.layer.shadowOffset = CGSize(width: -15, height: 10)
self.paddingView.layer.shadowRadius = 5
self.paddingView.layer.shadowOpacity = 0.5 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2017-09-13T12:52:26.703

全部回答都很好，但我想再补充一点

如果您在有表格单元格时遇到问题，Deque 一个新单元格，阴影不匹配，因此在这种情况下，您需要将阴影代码放在 layoutSubviews 方法中，以便它在所有条件下都能正常运行。

```
-(void)layoutSubviews{
    [super layoutSubviews];

    [self.contentView setNeedsLayout];
    [self.contentView layoutIfNeeded];
    [VPShadow applyShadowView:self];
} 
```

或在特定视图的 ViewControllers 中将阴影代码放在以下方法中，以便它正常工作

```
-(void)viewDidLayoutSubviews{
    [super viewDidLayoutSubviews];

    [self.viewShadow layoutIfNeeded];
    [VPShadow applyShadowView:self.viewShadow];
} 
```

我已经为新开发者修改了我的影子实现，以获得更通用的形式，例如：

```
/*!
 @brief Add shadow to a view.

 @param layer CALayer of the view.

 */
+(void)applyShadowOnView:(CALayer *)layer OffsetX:(CGFloat)x OffsetY:(CGFloat)y blur:(CGFloat)radius opacity:(CGFloat)alpha RoundingCorners:(CGFloat)cornerRadius{
    UIBezierPath *shadowPath = [UIBezierPath bezierPathWithRoundedRect:layer.bounds cornerRadius:cornerRadius];
    layer.masksToBounds = NO;
    layer.shadowColor = [UIColor blackColor].CGColor;
    layer.shadowOffset = CGSizeMake(x,y);// shadow x and y
    layer.shadowOpacity = alpha;
    layer.shadowRadius = radius;// blur effect
    layer.shadowPath = shadowPath.CGPath;
} 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2018-10-03T09:12:20.680

对于 Xamarian 同胞，答案的 Xamarin.iOS/C# 版本如下所示：

```
public override void DrawRect(CGRect area, UIViewPrintFormatter formatter)
{
    CGContext currentContext = UIGraphics.GetCurrentContext();
    currentContext.SaveState();
    currentContext.SetShadow(new CGSize(-15, 20), 5);
    base.DrawRect(area, formatter);
    currentContext.RestoreState();                
} 
```

主要区别在于您获得了一个实例，`CGContext`您可以在该实例上直接调用适当的方法。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2019-10-13T10:45:44.020

您可以使用它`Extension`来添加阴影

```
extension UIView {

    func addShadow(offset: CGSize, color: UIColor, radius: CGFloat, opacity: Float)
    {
        layer.masksToBounds = false
        layer.shadowOffset = offset
        layer.shadowColor = color.cgColor
        layer.shadowRadius = radius
        layer.shadowOpacity = opacity

        let backgroundCGColor = backgroundColor?.cgColor
        backgroundColor = nil
        layer.backgroundColor =  backgroundCGColor
    }
} 
```

你可以这样称呼它

```
your_Custom_View.addShadow(offset: CGSize(width: 0, height: 1), color: UIColor.black, radius: 2.0, opacity: 1.0) 
```

# wpf - WPF 组合框清除

> ID：805876
> 
> 赞同：3
> 
> 时间：2009-04-30T08:08:14.720
> 
> 标签：wpf

我有两个单选按钮。如果我检查第一个单选按钮以下数据将填充在组合框中。之后我将检查另一个单选按钮，我想清除组合框的值。

```
<RadioButton Height="29"
             HorizontalAlignment="Left"
             Margin="143,193,0,0" Name="rdoEmployee" VerticalAlignment="Top" Width="61"
             FontSize="20"  Checked="rdoEmployee_Checked" GroupName="rdoEmployee/>

<RadioButton FontSize="20" Height="20" Margin="228,193,0,0" Name="rdoPA" 
             VerticalAlignment="Top" HorizontalAlignment="Left" Width="49"  
             Checked="rdoPA_Checked" GroupName="rdoEmployee />

<ComboBox HorizontalAlignment="Left" Margin="142,235,0,240" 
          Name="cmbEmpType" Width="200" FontSize="16" /> 
```

```
EmployeeTypes _ET = new EmployeeTypes();
DataRowCollection drc = _ET.EmpTypeTable.Rows;
foreach (DataRow r in drc)
{
    ComboBoxItem item = new ComboBoxItem();
    item.Tag = r["EmpTypeID"];
    item.Content = r["EmpTypeName"];

    cmbEmpType.Items.Add(item);

    if (cmbEmpType.Items.Count > 0)
    {
        cmbEmpType.SelectedIndex = 0;
    }

} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-30T10:01:55.620

你是否要求

```
cmbEmpType.Items.Clear(); 
```

这应该清空你的组合。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-30T08:22:47.637

是绑定的吗？如果是这样，请将绑定属性设置为`null`. 如果没有，请设置`SelectedItem`为`null`.

# javascript - 跨域拆分请求——阻止过度安全

> ID：805887
> 
> 赞同：4
> 
> 时间：2009-04-30T08:13:14.990
> 
> 标签：javascript, css, security, optimization, web

继 Steve (YSlow) Souder 的布道之后，我的网站 (LibraryThing.com) 将请求拆分为跨域以促进并行加载。我们做 CSS、JS 和图像；你也可以做Flash等。我们也用谷歌的Prototype版本，它是跨域的，而不仅仅是跨子域。

这一切都对速度很有好处，但对于一小部分用户来说，它会出错。我认为问题出在过度安全设置，可能在 IE 中，但也可能在其他浏览器和/或上游系统中。我很惊讶 Souders 和其他人不讨论这个，因为我们得到了很多。

问题是：处理这个问题的最佳方法是什么？

现在，当它到达页面底部时，我们正在检查是否设置了在应该加载的脚本中声明的某个 JS 变量。如果没有设置，它会从主域获取它并设置一个 cookie，以便下次它不会从子域加载它。但是我们只是在底部重新加载了 JS，所以如果 CSS 也失败了，你就是在看垃圾。

有没有人有更好或更通用的解决方案？我在想可能有一个通用的“onload”或“onerror”脚本来设置cookie并加载内容？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T01:38:08.940

如果此行为至少总是影响 JS 文件，则一种选择是保留一个 cookie，指示用户的浏览器是否已经针对此行为进行了测试。如果它们尚未经过测试，请插入（作为标记中的第一个脚本元素）对跨域脚本的引用，该脚本只是将此 cookie 设置为“成功”。然后立即有一些内联 JS 将检查此 cookie，如果未设置，则设置为“失败”并重新加载页面。

然后在服务器端检查相同的 cookie，并确保跨站点请求不会发送给任何“失败”结果的人。

这种方法应该确保使用支持跨站点请求的浏览器的用户不会看到任何奇怪的行为，但应该立即为其他用户解决问题，代价是在他们第一次访问时自动刷新。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-30T09:45:22.990

您是否有呈现此行为的特定用户代理列表？也许Apache conf可以解决这个问题？（或为您创建一个新问题来解决:-)）。

当心 cookie 狂热 - 您添加的 cookie 越多（此外，在主域上），您的客户将不得不在他们的请求中发送更多的 cookie。

Souders 也谈到了它，但是检查您的客户端浏览器发送/接收请求的比率总是很好的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-30T10:14:24.200

我将对您的问题进行一些疯狂的猜测。

缓存。您是否在脚本文件中进行了这些更改，这些问题用户可能拥有旧版本。IE 6 的缓存非常糟糕。

我注意到您的脚本在 url 中没有构建 #，XYZ.js?version=3 将强制浏览器不使用旧的缓存脚本，如 XYZ.ks?version=2。（也适用于图像/CSS）

您还可以将内联 javascript 与您的 HTML 混合，这些也会被缓存。

除非您的网站上有大量内容（巨大的页面），否则 3 个域可能会过大

DNS 查找可能很昂贵并且具有很长的超时值。

由于可能存在安全冲突，我不愿意将我的网站 javascript 放在单独的域中。您必须使您的 javascript/ajax 调用与域保持同步。似乎比它的价值更麻烦。

我已经使用 i.domain.com 和 domain.com 5 年多了，没有任何问题。

我敢打赌把 JS 放回主域会解决你的问题。它肯定会使它变得不那么复杂，更容易处理。

但如果做得好，你的 3 个域应该可以工作。不幸的是，我在这个问题中没有足够的信息来找到问题。

# iphone - iPhone 3.0 的 Safari 缓存大小

> ID：805891
> 
> 赞同：3
> 
> 时间：2009-04-30T08:15:17.387
> 
> 标签：iphone, caching, safari

互联网上的各种网站声称 iPhone 2.2 上的 Safari 缓存是 25k 和 19 个对象。有谁知道 iPhone 3.0 上 Safari/webview 的缓存大小是多少。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-08-18T03:27:46.267

> 特别是如果您使用客户端存储或缓存清单，您可以存储更多数据

客户端应用程序存储不同于原始海报所指的 Safari 自己的缓存。我们知道，在 2.2 中，Safari 可以存储 19 个对象，每个对象最大为 25K。3.0+ 的新数字是什么？发布的链接/pdf 似乎没有答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-30T09:02:01.143

嗯...据我所知，自 2.2 版以来的缓存大小要大得多。特别是如果您使用客户端存储或缓存清单，则可以存储更多数据。

可以在此处阅读如何在客户端存储值

[苹果开发者连接](https://developer.apple.com/safari/library/documentation/iPhone/Conceptual/SafariJSDatabaseGuide/Introduction/chapter_1_section_1.html#//apple_ref/doc/uid/TP40007256-CH1)

[PDF版](https://developer.apple.com/safari/library/documentation/iPhone/Conceptual/SafariJSDatabaseGuide/SafariJSDatabaseGuide.pdf)

# iphone - 为什么不需要发布设置了“assign”的 Outlet？

> ID：805892
> 
> 赞同：0
> 
> 时间：2009-04-30T08:15:17.967
> 
> 标签：iphone, objective-c, cocoa-touch, uikit

如果我有这样的东西，我一直在阅读：

```
@property (nonatomic, assign) UIView *anView; 
```

那我就不用关心内存管理了。我不必在 -dealloc 方法中执行 [anView release]。

为什么？

“assign”只是告诉编译器：“嘿伙计，这个属性不会保留任何人分配给它的任何东西”。然后你可以做

```
@synchronize anView; 
```

并且编译器神奇地创建了一个getter和setter，其中setter可能看起来像这样：

```
- (UIView*) anView {
    return anView;
} 
```

Setter 可能看起来像：

```
- (void) setAnView:(UIView*)newAnView {
    anView = newAnView;
} 
```

正确错误？如果这是正确的，setter 不会声明 newAnView 变量的所有权，因为它不是“保留”属性。它只是接受它并将其分配给实例变量。所以在考虑所有权策略时，不需要释放-dealloc中的anView实例变量。该对象不拥有它。那是正确的吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-30T08:21:51.413

是的，你基本上是对的。让我们假设垃圾收集器已关闭（否则无论如何都无关紧要）。

使用“分配”属性时，您不必释放对象，因为您从未保留它（这是其他人的责任）。

本质上，这会创建一个弱引用—— anView 可能在属性仍然指向它时被释放。通常，您将“分配”用于原始数据类型，而不是对象。

# c - 在 LynxOS 上用 C 格式化磁盘并创建分区

> ID：805894
> 
> 赞同：-1
> 
> 时间：2009-04-30T08:16:20.630
> 
> 标签：c

你能解释一下我如何做一个用 C 语言进行系统调用以格式化磁盘并创建新分区的小程序吗？

* * *

操作系统是 LynxOS。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-30T09:40:52.207

你会在 shell 中执行哪些命令？

从表面上看，您可以对此使用一些变体：

```
#include <stdlib.h>

static const char *cmds[] =
{
    "command 1 with options",
    "command 2 with different options",
    0,
};

int main(void)
{
    int i;

    for (i = 0; cmds[i] != 0; i++)
        if (system(cmds[i]) != 0)
            exit(EXIT_FAILURE);
    return(EXIT_SUCCESS);
} 
```

我假设这些命令将为任何问题提供适当的诊断。如果您需要控制参数，那么您还有更多工作要做。

主要的警告是“这是运行 o/s 的磁盘”，因为如果是这样，那么该磁盘的格式化可能会阻止程序成功运行。

# session - 为什么关闭选项卡不会删除会话 Cookie？

> ID：805895
> 
> 赞同：28
> 
> 时间：2009-04-30T08:16:53.373
> 
> 标签：session, cookies, tabs

我在我的网站上使用基于会话的 cookie。令我完全惊讶的是，我注意到如果我设置了一个会话 cookie（不是持久性 cookie），关闭一个选项卡，然后重新连接到该站点，会话 cookie 仍然存在。实际上，这不是我所期望的。我本来希望会话 cookie 被删除。

如果关闭浏览器，会话 cookie 将被删除，那么为什么不关闭选项卡以获得相同的结果呢？

因此，我使用 PHP5 和 jQuery。我有什么办法可以在关闭选项卡时解决此会话问题？不幸的是，BODY 标记上的 onbeforeunload 事件在这里没有用，因为当您点击离开页面时，它会触发该事件，而不仅仅是关闭选项卡。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-04-30T08:20:10.933

会话 cookie 是每个进程而不是每个窗口。因此，即使您选择了新窗口，您仍然会得到相同的会话 ID。这种行为是有道理的。您不希望用户在浏览您的网站时每次打开新窗口时都重新登录。

我不知道有什么真正的方法可以解决这个问题。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-30T08:19:27.533

这是设计使然，试图改变它是一个非常糟糕的主意。如果用户在新选项卡中打开一个链接并关闭它怎么办？是否应该销毁原始选项卡中的会话？当然不是！这说明了为什么你甚至不应该考虑这一点。

当最后一个浏览器窗口关闭时，会话结束。如果你想要别的东西，你：

1.  不想要会话；
2.  需要制作自己的“迷你会话”基础设施；
3.  可能是在一个受伤和错误的世界。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2017-03-30T15:23:51.967

如果您需要依赖选项卡关闭，可以使用会话 Web 存储来代替 cookie。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-03-06T11:29:04.410

您还可以编写一个 javascript 来检测选项卡何时关闭并删除 javascript 中的 cookie

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-06-25T09:41:14.720

我找到了解决办法。

我在`ASP.NET` `C#`. `Master Page`除了页面之外，我对网站的所有页面都有一个`Login`。在`Master Page`服务器中`Page Load event`，我得到了`Url`引用页面并检查它是否包含站点的根目录，如果不是，我重定向到该`Login`页面，因为它没有`Master Page`显示。

如果我尝试从另一个站点访问页面，或者如果我输入`Url`浏览器的地址框，这将起作用。因此，如果您关闭选项卡并尝试从另一个选项卡重新进入或重新打开选项卡，即使 cookie 没有被杀死，您也无法在不通过 thru 的情况下重新进入该站点`Login`。即使您没有关闭选项卡并在同一选项卡中的不同站点之间导航，这也有效。

这是代码

```
 if (Request.UrlReferrer == null || !Request.UrlReferrer.AbsoluteUri.ToString().Contains("root"))
        {
            Response.Redirect("~/Account/Login.aspx");
        } 
```

从站点内导航时，即使您打开指向站点中另一个页面的链接到它打开的另一个选项卡，也没有问题。

如果您还想确保可以在重定向到页面`if`之前终止该子句中的会话和身份验证 cookie。`Login`

当用户导航到同一选项卡中的另一个站点并按下浏览器`back to`按钮时，这将不起作用，因为这适用于缓存并且不会自动向服务器发送请求。

因此，这不会在关闭选项卡时终止会话或身份验证 cookie，但它可以帮助防止在关闭选项卡后重新进入站点而不登录。

# c# - 在 IFRAME 内的 ASP.NET 页面上使用 ASP.Net AJAX 进行完整回发

> ID：805901
> 
> 赞同：0
> 
> 时间：2009-04-30T08:20:25.830
> 
> 标签：c#, asp.net, ajax, asp.net-2.0

我有一个包含在 iframe 中的 ASP.Net 页面，该页面有一个更新面板，它单独工作，但是当页面在 iframe 中时，更新面板总是会产生完整的回发。我想问题出在 iframe 本身，但我想知道

a）为什么它不起作用 b）如果有一个解决方案超出了滚动我自己的控件和编写整个 js 负载

编辑

好的，它的 ASP.Net 2.0 和 1.0 工具包页面大致看起来像这样（注意我没有关闭标签，这只是为了显示基本结构）

```
Main Page
Form
     table 
         td 
             iFrame 
                ! -- contained page --
                 Form 
                     asp:ScriptManager  
                         asp:UpdatePanel 
                               asp:Repeater 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-05-20T16:11:36.527

今天我遇到了同样的问题（尝试异步加载gridviews）：iframe 内的回发将重新加载整个页面，并忽略回发事件处理程序。

我的解决方案是使用[UFRAME](http://uframe.codeplex.com/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-30T08:26:39.840

我一直在使用 UpdatePanel 在 IFrame 中使用我的一些页面，它们不会产生任何整页回发。

你能更详细地描述整个设置吗？

编辑：嗯。设置看起来不错。您是否检查过触发回发的控件是否放置在面板内？另外，您是否检查了在 ajax 请求触发之前发生的 JS 错误？

# php - 从 php 获取 apache linux 用户

> ID：805907
> 
> 赞同：29
> 
> 时间：2009-04-30T08:22:44.763
> 
> 标签：php, apache

我在一个外国的linux系统上，需要确定运行apache的用户（php也是如此）。

目的：我需要获取脚本的所有者（这没问题，因为我可以使用 SplFileInfo）并将其与 apache 进程的所有者进行比较。

我对任何替代建议持开放态度。

问候，马里奥

编辑：附加信息：

该脚本是一个缩略图生成器，它使用 XML 文件从较大的图像生成缩略图。该脚本需要创建文件夹和写入文件。由于我无法影响 php 配置并且我没有任何 shell 访问权限，因此必须非常安静地完成此操作。创建过程通过异常停止并在失败时发送邮件。由于大多数 php 函数在失败时不能抛出异常，我需要一些手动检查来确定我所处的环境。因此我需要 apache 用户将其与某个目录或文件所有者进行比较。

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2009-04-30T08:39:48.873

您可以调用 php [exec](http://php.net/exec)函数来执行*whoami*：

```
<?php echo exec('whoami'); ?> 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-30T08:41:09.870

参见 posix_getuid() 和 posix_getpwuid()

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-07-01T23:10:46.943

这里有一些复杂的答案。

这对我有用：

```
$user = getenv('APACHE_RUN_USER'); 
```

不确定这是否只是自提出此问题以来添加到 apache 的新事物，但现在肯定存在。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-30T08:30:30.957

[phpinfo](http://www.php.net/phpinfo)会转储很多系统信息。对于 apache2 安装，有一个部分显示 apache 用户和组 ID。尝试创建一个只有一行的 php 脚本，调用 phpinfo()，然后在 Web 浏览器中打开它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-11-14T08:37:33.963

某些 php 脚本**必须**在 apache 用户 (cli) 上运行，在这种情况下 whoami 不合适。这是我的解决方案：

```
$output = exec('apachectl -S 2>/dev/null | grep User');
$apacheUser = preg_match('/name="([^"]+)"/', $output, $match) ? $match[1] : 'www-data'; 
```

# java - 如何删除 Hudson 的构建工件？

> ID：805909
> 
> 赞同：4
> 
> 时间：2009-04-30T08:22:57.713
> 
> 标签：java, continuous-integration, hudson, operations

我们正在使用 Hudson 作为我们的持续集成服务器，它很棒。我们有 2 个相关的问题。

1.  [https://hudson.dev.java.net/issues/show_bug.cgi?id=2736](https://hudson.dev.java.net/issues/show_bug.cgi?id=2736) Hudson 中的构建顺序意味着下游依赖项的构建远远超出了它们的需要。希望这个问题将很快得到解决。
2.  由于这些东西的构建如此频繁，因此构建历史非常庞大。对于某些工作，我们真的不需要历史上 1000 个构建项目。

我的问题是关于第 2 点的。我想要一个工作或插件之类的东西来删除旧工件。一直说周围所有东西的最后 20 个版本都可以。目前它似乎是无限的，从运营的角度来看这并不是很好。

更新：根据诺伯特的回答，它在工作配置中。在 1.300 UI 中，有一个“Discard Old Builds”复选框，允许对其进行配置。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-30T08:26:00.327

在我们的 hudson 构建服务器中有这样的配置。在项目配置中，我可以在构建数量或保留时间之间进行选择。我不认为我为此安装了插件

# user-interface - 什么是最好的自动化网站 UI 测试框架

> ID：805910
> 
> 赞同：33
> 
> 时间：2009-04-30T08:23:18.303
> 
> 标签：user-interface, testing, automation, automated-tests

有哪些好的自动化 Web UI 测试工具？

我希望能够在.Net 世界中使用它——但它不必用.net 编写。

诸如记录模式，集成到构建过程\持续集成之类的功能会很好。

我要看看：

*   [瓦提尔](http://wtr.rubyforge.org/)
*   [硒](http://seleniumrecorder.mozdev.org/)

还有其他我应该看的吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-04-30T08:33:08.860

我绝对推荐 Selenium，你可以从 .NET 使用它，支持不同的浏览器，在自动构建和 CI 流程中工作（我们从 CCNet 使用它）。代码很稳定。它有一些怪癖，但毕竟它们都有。

无论您选择哪种工具，我都建议您围绕它创建自己的测试外观类。外观的设计应满足您的具体测试需求，而不会暴露太多测试工具 API 的细节。这将使测试代码更容易编写和维护。

更新：如果您在应用程序中使用 ASP.NET 视图状态，则使用纯 HTTP 测试工具可能会遇到问题。这就是浏览器控制器（如 Selenium）要好得多的地方。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-30T08:44:50.140

等待

自动化 FF 和 IE

```
[Test] 
public void SearchForWatiNOnGoogle()
{
 using (IE ie = new IE("http://www.google.com"))
 {
  ie.TextField(Find.ByName("q")).TypeText("WatiN");
  ie.Button(Find.ByName("btnG")).Click();

  Assert.IsTrue(ie.ContainsText("WatiN"));
 }
} 
```

[http://watin.sourceforge.net/](http://watin.sourceforge.net/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-12-10T22:08:54.930

Watin 在严肃的项目中使用它非常不稳定。它通常会因“EI 忙”或“COM 对象错误”等意外原因而失败。Selenium 更加稳定，并且已经有很多支持工具。例如 Selenium GRID 是一种可以显着减少测试运行时间的解决方案。（我们对 Watin 的烟雾测试需要 6 个小时才能运行）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-30T08:48:31.973

您可能还想看看 ASP.NET 团队自己设计的东西：[轻量级测试自动化框架](http://www.codeplex.com/aspnet/Wiki/View.aspx?title=Lightweight%20Test%20Automation%20Framework%20Road%20Map "测试自动化框架")。

还有一个专门的[论坛](http://forums.asp.net/1193.aspx)。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-13T21:23:43.543

目前在我的工作中，我使用[QTP](https://h10078.www1.hp.com/cda/hpms/display/main/hpms_content.jsp?zn=bto&cp=1-11-127-24%5E1352_4000_100__)，到目前为止，它至少可以处理我们在 UI 上扔给它的几乎所有东西，并且它具有测试非 gui 服务的特殊模式，允许我们检查两者并帮助我们缩小出现问题的范围当我们改变系统时。在我看来，它是非常可配置的，并且包含 vbscript 作为它的语言允许与 Windows 上的很多东西集成，让你可以做任何你想做的事情！例如，我们使用它来控制 excel com 对象以制作成功和失败的自定义 excel 报告，因此结果的格式与手动运行测试以及在另一个项目上使用 adodb 对象检查页面时的格式相同向数据库提交信息，表明数据库包含该记录的正确数据！

至于集成到构建过程中，我自己没有尝试过，但是可以从 vbs 文件启动 qtp 和测试，所以我认为这应该是相当简单的，因为 ms 工具往往允许你很容易地运行 vbs 文件大多数工具。

如果您可以让某人购买许可证，我会将其推荐给任何人！

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-05-28T19:55:46.227

您也可以尝试 VSTT - [http://blogs.msdn.com/b/slumley/archive/2009/05/28/vsts-2010-feature-enhancements-for-web-test-playback-ui.aspx](http://blogs.msdn.com/b/slumley/archive/2009/05/28/vsts-2010-feature-enhancements-for-web-test-playback-ui.aspx)

Telerik 测试工具 - [http://www.telerik.com/automated-testing-tools.aspx](http://www.telerik.com/automated-testing-tools.aspx)

Visual Studio UI 测试可扩展性——场景和指导原则 - [http://blogs.msdn.com/b/mathew_aniyan/archive/2011/03/28/visual-studio-ui-test-extensibility-scenarios-amp-guiding-principles .aspx](http://blogs.msdn.com/b/mathew_aniyan/archive/2011/03/28/visual-studio-ui-test-extensibility-scenarios-amp-guiding-principles.aspx)

VSTS Web 测试分步入门 - [http://blogs.msdn.com/b/jimmymay/archive/2009/02/23/vsts-web-test-step-by-step-primer-7-minute- video-by-microsoft-ace-performance-engineer-chris-lundquist-with-copious-notes-screen-shots-from-your-humble-correspondent.aspx](http://blogs.msdn.com/b/jimmymay/archive/2009/02/23/vsts-web-test-step-by-step-primer-7-minute-video-by-microsoft-a-c-e-performance-engineer-chris-lundquist-with-copious-notes-screen-shots-from-your-humble-correspondent.aspx)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-04-05T22:17:33.380

在使用了几种不同的自动化测试解决方案（TestComplete、QTP 等）之后，我必须投票支持 Telerik + Visual Studio。Telerik 有很好的支持论坛，并且与您提出的任何测试框架都非常兼容。我们的开发人员将唯一的 ID 放入他们的 HTML 代码中，这样我们的脚本就不需要重写，即使进行了相当激烈的 UI 重构。这绝对比录制和回放更具挑战性，但是一旦你有了唯一的 ID，自动化代码几乎不需要维护。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-30T08:32:19.670

试试[httpunit](http://httpunit.sourceforge.net/)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-30T08:41:55.857

取决于你想达到什么。

您可以使用 Visual Studio Tester Edition 中内置的 Web 测试。它非常好并且易​​于自动化。您可以使用外部数据作为测试数据源，它与 VS 很好地集成。

还有一个自动化 QA（忘记名字）的测试工具，看起来不错但价格昂贵。

还有硒。这就是我们在赛门铁克中使用的那个。最大的优点是它实际上使用了您要测试的浏览器。VS 仅通过更改 http 请求参数来模拟浏览器，因此您可能无法测试您的站点的跨浏览器兼容性。另一方面，Selenium 使用浏览器并将其自动化，因此您可以在 IE、Firefox 等中实际测试您的网站。它还可以与 VS 单元测试集成，因此您可以在 VS 中查看测试结果。

所以我会推荐 Selenium 或 VS。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-30T09:10:56.740

我用过硒。功能很好，可以使用，但有问题。

IDE 经常会错误地记录事件（因此需要手动更改测试），并且测试文件有时会因为没有明显原因而变得完全不可用，这意味着它们必须重新创建。Selenium IDE 的开发似乎也停止了；有一段时间没有任何错误修复和补丁，错误报告似乎被忽视了。

钼是一种基于硒的替代品，值得研究。

[http://www.molyb.org/](http://www.molyb.org/)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-05-02T13:30:44.617

只是抛出另一个选项（我没有尝试过，但我喜欢 Telerik）是 Telerik 的新[WebUI 测试工作室](http://www.telerik.com/products/web-ui-test-studio.aspx)。我也会回应 Selenium 的赞成票。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-04-30T08:37:46.540

我忘记了一个不错的工具，可以在上面找到链接，但找到了这个... [http://weblogs.asp.net/bsimser/archive/2008/02/21/automated-ui-testing-with-project-white.aspx](http://weblogs.asp.net/bsimser/archive/2008/02/21/automated-ui-testing-with-project-white.aspx)也许可以提供帮助。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-05-31T02:41:06.227

如果您正在寻找简单的、具有记录和回放功能的跨浏览器工具、多线程回放、与构建过程的集成、强大的脚本、良好的报告和出色的支持，请选择[Sahi](http://sahi.co.in)。您的测试人员/开发人员将更容易学习和维护。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-06-16T23:44:32.513

您可能要考虑在 Selenium 附近还有 Rational Functional Tester ！无论您是否熟悉 .Net 或 Java 中的编码，并且只想玩记录和回放，或者想要创建更复杂的编程测试，我都会推荐它。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-07-13T07:15:37.660

WebDriver 是另一种可能性：[http ://code.google.com/p/webdriver](http://code.google.com/p/webdriver)

他们正在开发一个您可能会感兴趣的 .NET 包装器。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-07-20T10:35:53.617

试试[QEngine](http://www.manageengine.com/products/qengine/)。它具有 QTP 的所有功能。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2012-09-12T07:06:38.890

您可能希望查看[RIATest](http://www.cogitek.com/riatest/features/technologies/htmljavscript.html)以对 Web 应用程序进行跨平台跨浏览器测试。

它适用于 Windows 和 Mac，支持的浏览器是 Firefox、IE 和 Chrome。在一个平台/浏览器上编写的自动化测试脚本可以针对所有其他支持的平台/浏览器运行。

它具有您想要的功能：用户交互记录模式和与 CI 服务器的集成（以 JUnit 格式输出结果，可供 Hudson 等 CI 服务器使用）。

（免责声明：我是 RIATest 团队成员）。

# iphone - iPhone 模拟器上的 PVRTC 纹理

> ID：805911
> 
> 赞同：1
> 
> 时间：2009-04-30T08:23:26.807
> 
> 标签：iphone, opengl-es

有什么方法可以让[PVRTC 纹理](http://en.wikipedia.org/wiki/PVRTC)在 iPhone 模拟器上工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-30T08:50:22.140

根据[这个论坛帖子](http://www.idevgames.com/forum/showthread.php?t=17185)：是的，模拟器支持 PVRTC 格式的压缩纹理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T20:18:50.203

我发现了一个问题，为什么 PVR 纹理在模拟器和 iphone 上都不起作用。在绘制之前需要设置参数 GL_TEXTURE_MIN_FILTER。例如， `glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_NEAREST);`

# iphone - 为什么要写[anView release], anView = nil; 而不是 [anView 发布]；？

> ID：805915
> 
> 赞同：7
> 
> 时间：2009-04-30T08:25:11.593
> 
> 标签：iphone, cocoa-touch, memory-management, uikit

我在某处读到-关于内存不足警告并放弃所有子视图的不可见视图（我认为=整个笔尖），您应该这样做：

```
-(void)dealloc {
    [anView release], anView = nil;
    [someImageView release], someImageView = nil;

    [super dealloc];
} 
```

而不是

```
-(void)dealloc {
    [anView release];
    [someImageView release];

    [super dealloc];
} 
```

在我调用 release 之后，将这些指针指向 nil（=“无对象”）的原因是什么？让我猜猜：由于某种原因，其他一些方法可能会保留视图（任何人都可以举例说明何时会发生这种情况？），然后发生 didReceiveMemoryWarning 事情，并且您释放了当前不可见的整个 nib+view（即在多视图应用程序中）。一旦用户想再次查看该视图，您将再次快速加载 nib，然后：它加载所有视图，连接插座，然后 BANG！您的其他保留视图现在挂起，没有任何指针在内存砖的某个地方孤独，导致大量内存泄漏，直到您的应用程序崩溃。

正确错误？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-30T08:37:08.460

原理比UIView更通用。确实它比 Objective-C/Cocoa`-release`方法更通用。它也适用于 C `malloc()`/`free()`内存函数。

当您不再需要某个对象或任何内存区域时，首先释放/释放它。然后，为了确保您不会再次使用它，您可以通过将 a 分配给`nil`对象或分配`NULL`给内存指针来清除访问此对象或内存区域的方法。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-04-30T09:55:25.820

> 出于某种原因，其他一些方法可能会保留视图

除非您`dealloc`自己调用，否则只有在保留计数变为零时才会调用它。

请注意，在 Objective-C 中，向“对象”发送消息`nil`（通常）非常好。这样做*不会*使您的程序停止，但该消息会被忽略。但是，您不能向已释放的对象发送消息，这会导致崩溃。

因此，以下内容会给您一个错误：

```
[anView release];
[anView doSomething]; 
```

但是，这实际上没问题：

```
[anView release];
anView = nil;
[anView doSomething]; 
```

这是一个口味问题，但对于上述情况，您实际上可能更喜欢使程序崩溃，而不是想知道为什么 doSomething 没有执行......

另请参阅Apple 的[Objective-C 2.0 编程语言简介中的](http://developer.apple.com/documentation/Cocoa/Conceptual/ObjectiveC/)[向 nil 发送消息](http://developer.apple.com/documentation/Cocoa/Conceptual/ObjectiveC/Articles/ocObjectsClasses.html#//apple_ref/doc/uid/TP30001163-CH11-SW7)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-30T21:03:07.993

-dealloc 方法在对象被释放时调用，之后不会执行对象上的其他方法。因此，将任何实例变量设置为 nil 在该对象之外都没有影响。

如果您在类中的其他地方释放对象（不使用 setter），则将实例变量设置为 nil 以防止其他地方的代码向该地址发送消息非常重要。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-30T17:07:07.687

我经常使用这种模式：

```
- (void) showHelp: (id) sender
{
    if (helpController == nil)
    {
        helpController = [[HelpController alloc] initWithNibName: @"Help" bundle: [NSBundle mainBundle]];
    }
    [self presentModalViewController: helpController animated: YES];    
}
- (void)didReceiveMemoryWarning {
    [super didReceiveMemoryWarning]; // Releases the view if it doesn't have a superview
    // Release anything that's not essential, such as cached data
    [helpController release];
    helpController = nil;
} 
```

几乎在我分配模态或“临时”视图控制器的所有地方。这样，如果我再次需要它，它就会挂起，但如果内存不足，它就会消失。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-12T22:31:26.393

如果您的访问器具有与它们关联的属性 yoc 并作为更简洁的方法执行以下操作，而不是执行显式释放并设置为 nil：

```
- (void) dealloc
{
    self.retainedProperty1 = nil;
    self.retainedProperty2 = nil;
    self.copiedProperty = nil;
    self.assignedProperty = nil;
} 
```

通过这种方式，您可以拥有更少重复的代码，因为合成代码会为您处理您的发布。

编辑：我应该指出你的属性不能是只读的，否则你会因为明显的原因得到编译器错误:)

# iphone - iPhone + 共享点

> ID：805920
> 
> 赞同：2
> 
> 时间：2009-04-30T08:26:38.953
> 
> 标签：iphone, cocoa-touch, sharepoint, http, protocols

有没有办法将 iPhone 与 Sharepoint 连接起来？我想知道，是否可以在 Cocoa/Objective-C 中实现 Sharepoint 的 HTTP 或 WEBDAV 协议。

问候

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-30T10:55:56.970

iPhone 的通用 WebDAV 客户端应该可以正常工作（除非 Sharepoint 遇到了我不知道的 WebDAV 问题）。您可能想尝试[DAV-E](http://greenbytes.de/dav-e.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-30T08:59:33.710

作为一名 iPhone 开发人员，我不能说它必须使用什么工具进行开发，但我假设您不想只使用浏览器连接到网页。Safari 是否不能与 iPhone 上的 Sharepoint 一起使用，或者您是否在谈论连接到 Web 服务以创建应用程序以查看列表？

Sharepoint 基于 Windows Sharepoint 服务构建，除其他外，它提供 Web 服务来为您提供列表。iPhone 是否有从 Web 服务获取数据的工具？

有一些关于如何在 .NET 中执行此操作的教程，您可以对其进行解释。这是一个示例，[http://www.codeproject.com/KB/sharepoint/SharePointListWebService.aspx?display=Print](http://www.codeproject.com/KB/sharepoint/SharePointListWebService.aspx?display=Print)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-30T09:04:56.083

你到底想达到什么目的？

HTTP 就是 HTTP，不管它是不是 Sharepoint。您可以通过访问[http://yoursite/m/](http://yoursite/m/)使用 Mobile Safari 访问您的 Sharepoint 网站的移动版本。它并不漂亮，但它可以让你完成最基本的任务。如果需要，您可以访问完整版本，但我怀疑所有使用中的 javascript 是否能正常工作。

最终，您将受到设备功能的限制。我确信支持 WEBDAV 的 Sharepoint 客户端是完全可能的（事实上，我知道有几个应用程序使用 WEBDAV 来允许将 iPhone 用作便携式存储），但您*真的*想在 iPhone 上下载/编辑/上传文档吗？

您可能会做一些涉及 Sharepoint Web 服务的事情，并围绕它们构建一个自定义界面（这只是普通的 HTTP），但我看不到提供的 Web 界面的好处。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-06T03:09:07.573

假设您对 SharePoint 环境有足够的控制权，我建议您在 SharePoint 服务器上开发一个自定义界面 - 如果您来自 .net 背景，使 SharePoint 以 iphone 预期的格式提供数据将比计算容易得多在完全陌生的开发模型中输出低级 Web 服务调用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-10-13T10:39:14.643

我遇到了同样的问题，问题是使用 ASIHttpRequest 发出 Soap 请求：

```
 ASIHTTPRequest *asiRequest = [ASIHTTPRequest requestWithURL:self.listsURL];

[asiRequest setUsername:@"name"];
[asiRequest setPassword:@"password"];

[asiRequest setDelegate:self];

NSString *soapGetList = @"<?xml version=\"1.0\" encoding=\"utf-8\"?>\n"
"<soap12:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap12=\"http://www.w3.org/2003/05/soap-envelope\">\n"
"<soap12:Body>\n"
"<GetList xmlns=\"http://schemas.microsoft.com/sharepoint/soap/\">\n"
"<listName>Tasks</listName>\n"
"</GetList>\n"
"</soap12:Body>\n"
"</soap12:Envelope>\n" ; 
```

列表网址在哪里：http: [//yoursite.com/_vti_bin/Lists.asmx](http://yoursite.com/_vti_bin/Lists.asmx)

如果您只需单击该 url，您将看到您可以使用您的共享点执行哪些类型的请求。如果您进行 GetListCollection，您将收到一个 XML 请求，其中包含有关列表的信息。希望能帮助到你

# .net - resx 文件是否适合国际化？

> ID：805922
> 
> 赞同：19
> 
> 时间：2009-04-30T08:28:17.247
> 
> 标签：.net, localization, internationalization, resx

我被赋予了国际化大型客户端-服务器应用程序的任务。职责是我让应用程序“世界就绪”，然后将编译的应用程序和资源传递给另一个国家的同事进行翻译并发布给他们的客户。会有几个国家，因此会有几个单独的翻译。

这里的关键是我想要一个简单的两步发布过程：

**第 1 步：**我编译并向不同国家的同事发布一个“World Ready”应用程序

**第 2 步：**他们进行资源本地化，然后发布给客户

我**不想添加****Make App World Ready** -> **Send files off for translation** ->**等待数周等待翻译返回**-> **Compile into App** -> **Release App**的额外步骤。

我一直在研究 .NET 全球化和 resx 文件的使用。从我所看到的 resx 文件被编译到应用程序中，因此一旦编译就无法更改。甚至卫星组件似乎也无法编辑。即使我在这一点上错了，对卫星程序集的更改如何反映回我项目中的 resx 文件？

所以现在的问题。**鉴于我只想先编译应用程序，然后再处理翻译，resx 文件是正确的方法还是我应该放弃它们并编写一个定制的数据库驱动解决方案，在应用程序编译后可以轻松编辑？**

希望一切都说得通。期待你的想法。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-30T08:34:29.167

是的，resx 文件是最好的解决方案。

对于资源的翻译，您应该查看本地化工具，例如[Passolo](http://www.sdl.com/software-and-services/translation-software/software-localization/sdl-passolo/)。它要么

*   将原始 resx 作为输入并生成翻译后的 resx 文件，您需要将其签入代码库
*   将编译的程序集作为输入并生成附属程序集。

我们正在翻译程序集，因为这也允许本地化 gui 布局。要允许外部工具打开 gui 编辑器，它需要代码，并且它在程序集中。

如果只关注测试翻译，resx 的翻译可能更容易处理。

这种外部工具提供了以下重要功能：

*   将所有字符串聚集在一起，您不必处理数百个 resx 文件
*   管理多种语言的翻译文本，主要使用 gui 设计器。
*   识别源文本是否已更改或已添加，因此您现在需要翻译哪些文本。
*   重复文本只翻译一次。
*   通常很好的用户界面来编辑翻译。
*   导出/导入到 csv 和类似格式，以供其他工具甚至其他公司处理。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-30T08:31:06.400

是的，.NET 中的整个全球化框架都是基于 RESX 文件和它们创建的卫星程序集。编译主应用程序后，可以将 RESX 文件独立编译到它们的卫星程序集中。

我知道有一些工具可以帮助翻译过程，但我不熟悉任何手头的工具。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-23T17:24:15.373

检查 Rick Strahl 的[资源提供者](http://www.west-wind.com/presentations/wwDbResourceProvider/)

# web-services - 如何在猫鼬网络服务器上保持链接活动

> ID：805925
> 
> 赞同：1
> 
> 时间：2009-04-30T08:29:45.777
> 
> 标签：web-services, http, keep-alive, mongoose-web-server

我尝试使用keep-alive连接猫鼬，但似乎猫鼬首先关闭了连接。

我更改了 embed.c 以发回连接：keep-alive。响应后连接仍然关闭。

```
border@ubuntu:~$ nc 127.0.0.1 9999
GET /test_get_request_info HTTP/1.1
Connection: keep-alive

HTTP/1.1 200 OK
Content-Type: text/plain
Connection: keep-alive

Method: [GET]
URI: [/test_get_request_info]
HTTP version: [1/1]
HTTP header [Connection]: [keep-alive]
Query string: []
POST data: []
Remote IP: [2130706433]
Remote port: [56719]
Remote user: []          <-----------------connection closed, nc returns
border@ubuntu:~$ 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-11T14:05:47.417

目前，不更改 Mongoose 代码是不可能的。您可以尝试制作一个技巧，在 analyze_request() 函数中设置 keep-alive 标志：

```
} else if ((cb = find_callback(conn->ctx, FALSE, uri, -1)) != NULL) {
        if ((strcmp(ri->request_method, "POST") != 0 &&
            strcmp(ri->request_method, "PUT") != 0) ||
            handle_request_body(conn, -1)) {
                cb->func(conn, &conn->request_info, cb->user_data);
                conn->keep_alive = TRUE;  // ADD THIS LINE
            } 
```

但是，必须有更好的机制从回调中执行此操作。

# delphi - 基于泛型类的具体类型的条件行为

> ID：805931
> 
> 赞同：16
> 
> 时间：2009-04-30T08:32:03.387
> 
> 标签：delphi, generics, types, delphi-2009

由于我[昨天](https://stackoverflow.com/questions/802011/size-of-generic-type)的问题可能并不完全清楚，并且我没有得到想要的答案，因此我将尝试以更一般的方式来表述它：

有没有办法根据实例化泛型类型的实际类型使用显式条件语句或使用某种专业化来实现特殊行为？伪代码：

```
TGenericType <T> = class
  function Func : Integer;
end;
...
function TGenericType <T>.Func : Integer;
begin
  if (T = String) then Exit (0);
  if (T is class) then Exit (1);
end;
...
function TGenericType <T : class>.Func : Integer;
begin
Result := 1;
end;
function TGenericType <String>.Func : Integer;
begin
Result := 0;
end; 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-04-30T09:00:22.490

您可以使用`TypeInfo(T) = TypeInfo(string)`. 要测试某个东西是否是一个类，你可以使用类似`PTypeInfo(TypeInfo(T))^.Kind = tkClass`.

`PTypeInfo`类型和`tkClass`枚举成员在单元中定义`TypInfo`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-30T10:29:40.123

如果有人对我如何实现“对字符串进行特殊处理的最坏情况大小”感兴趣

```
class function RTTIUtils.GetDeepSize <T> (Variable : T) : Integer;
var
  StringLength          : Integer;
  Ptr                   : PInteger;
begin
if (TypeInfo (T) = TypeInfo (String)) then
  begin
  Ptr := @Variable;
  Ptr := PInteger (Ptr^);
  Dec (Ptr);
  StringLength := Ptr^;
  Result := StringLength * SizeOf (Char) + 12;
  end
else
  Result := 0;
end; 
```

对我来说，这可以完成手头的工作。感谢所有贡献者！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-30T12:26:43.820

TypeInfo(T) 是正确的方法。此外，您可以使用 TypInfo 单元中的所有内容（例如 TTypeData 记录）来确定您使用的类型的某些特定属性，而不是泛型。当您确定当前使用的类型而不是 T 时，您可以使用指针技巧来获取变量的值。

这是一个接受任何枚举类型作为泛型的示例代码。请注意，它仅适用于通常的枚举（没有固定值，例如

TEnumWontWork = (first = 1, second, third)

) 并且不能在过程中将枚举声明为本地类型。在这些情况下，编译器不会为枚举生成 TypeInfo。

```
type
  // Sample generic class that accepts any enumeration type as T
  TEnumArr<T> = class
  strict private
    fArr: array of Byte;
    fIdxType: TOrdType;
    function IdxToInt(idx: T): Int64;
    procedure Put(idx: T; Val: Byte);
    function Get(idx: T): Byte;
  public
    constructor Create;
    property Items[Index: T]: Byte read Get write Put; default;
  end;

constructor TEnumArr<T>.Create;
var
  pti: PTypeInfo;
  ptd: PTypeData;
begin
  pti := TypeInfo(T);
  if pti = nil then
    Error('no type info');
  // Perform run-time type check
  if pti^.Kind <> tkEnumeration then
    Error('not an enum');
  // Reach for TTypeData record that goes right after TTypeInfo record
  // Note that SizeOf(pti.Name) won't work here
  ptd := PTypeData(PByte(pti) + SizeOf(pti.Kind) + (Length(pti.Name)+1)*SizeOf(AnsiChar));
  // Init internal array with the max value of enumeration
  SetLength(fArr, ptd.MaxValue);
  // Save ordinal type of the enum
  fIdxType := ptd.OrdType;
end;

// Converts index given as enumeration item to integer.
// We can't just typecast here like Int64(idx) because of compiler restrictions so
//  use pointer tricks. We also check for the ordinal type of idx as it may vary
//  depending on compiler options and number of items in enumeration.
function TEnumArr<T>.IdxToInt(idx: T): Int64;
var
  p: Pointer;
begin
  p := @idx;

  case fIdxType of
    otSByte: Result := PShortInt(p)^;
    otUByte: Result := PByte(p)^;
    otSWord: Result := PSmallInt(p)^;
    otUWord: Result := PWord(p)^;
    otSLong: Result := PLongInt(p)^;
    otULong: Result := PLongWord(p)^;
  end;
end;

function TEnumArr<T>.Get(idx: T): Byte;
begin
  Result := fArr[IdxToInt(idx)];
end;

procedure TEnumArr<T>.Put(idx: T; Val: Byte);
begin
  fArr[IdxToInt(idx)] := Val;
end; 
```

使用示例：

```
type
  TEnum  = (enOne, enTwo, enThree);
var
  tst: TEnumArr<TEnum>;
begin
  tst := TEnumArr<TEnum>.Create;
  tst[enTwo] := $FF;
  Log(tst[enTwo]); 
```

作为简历，我在这里使用了三个技巧：

1) 使用 T 的一般道具获取 T 的 TypeInfo

2) 使用 T 的详细道具获取 T 的 TypeData

3) 使用指针魔术来获取类型为 T 的参数的值。

希望这有帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-30T08:52:04.820

在 C# 中，你可以做一个`typeof(T)`允许你做类似的事情

```
(T = String) 
```

或者

```
(T is class) 
```

我还没有看到你的其他问题（你没有链接到它），但你*真正*在寻找什么？一般来说，像你正在做的那样通过 ifs 或 switch 做一些以类型或类型代码为条件的事情通常最好转换成在某个地方拥有一个由上下文定制的接口或抽象函数。

# java - JSP中浮点数的计算和显示

> ID：805937
> 
> 赞同：1
> 
> 时间：2009-04-30T08:34:24.830
> 
> 标签：java, jsp, floating-point

我正在尝试采用两个 7 位数字（源和目标记录计数）并计算目标计数中缺失记录的百分比。

例如，我的记录计数可能是源的 4084094 和目标的 4081313。我还使用以下公式来计算百分比：((1 - (目标/源)) * 100)

对于我的例子，我应该得到大约 0.0681% 的值

我是 Java 和 JSP 的新手，我无法正确显示百分比。我似乎只得到一个向下舍入到 0 的值。

我也尝试过 BigDecimal，但无济于事。

即使是下面的简单代码也显示了 1-1 的值，所以我显然做错了：

```
<%
BigDecimal percentMiss;
long tmp = 600/500;
percentMiss = BigDecimal.valueOf(tmp);
%>
<%=percentMiss.toString()%>-<%=tmp%> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-30T08:57:41.763

问题显然是你正在划分两个长数字。

我建议使用[DecimalFormat](http://java.sun.com/j2se/1.5.0/docs/api/java/text/DecimalFormat.html)来显示数字。如果您使用的是 JSTL，那么更好的解决方案是使用[格式标签](http://java.sun.com/products/jsp/jstl/1.1/docs/tlddocs/fmt/formatNumber.html)：

```
<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt" %>

<fmt:formatNumber value="${value}" minFractionDigits="2" maxFractionDigits="2"/> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-30T08:38:30.920

问题出在以下行

```
long tmp = 600/500; 
```

您不能长时间存储浮点数，而是应该考虑使用以下代码：

```
double tmp = (double)600 / (double)500; 
```

然后显示 tmp，其值应介于 0 和 1 之间（在您的情况下为 1.2，因为您必须将计算更改为 500 / 600）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-30T09:00:23.787

您的问题是 600 和 500 是整数值，它们之间的除法将产生一个整数结果，您将其分配给一个长整数。在此之后，结果的小数部分消失（两次）并且您无法取回它。

为了获得小数结果，除法的至少一个输入值需要是非整数。`double`您可以通过将它们强制转换为or来实现这一点`float`，或者通过使文字显式地加倍或浮动，如下所示：

```
500.0 // implicitly double
500f // float literal
500d // double literal 
```

[但是，由于这些数字存储为二进制分数的方式](http://en.wikipedia.org/wiki/Floating_point#Accuracy_problems)，打印双精度/浮点除法的结果通常会有比您想要的更多的小数位，即使它们不应该出现在结果中（例如`1/10`可能导致`0.100000001490116119384765625`）。

您可以使用 , 来消除这些不需要的数字`java.lang.DecimalFormat`，但这`BigDecimal`是一个更好的选择，因为它在内部使用小数，因此将提供实际正确的结果，同时提供对舍入模式的精确控制。当然，这需要您使用`BigDecimal`计算本身，而不是作为“巫毒成分”来修复已经损坏的结果。

```
new BigDecimal(600).divide(new BigDecimal(500)) 
```

阅读[API 文档以`BigDecimal`](http://java.sun.com/javase/6/docs/api/java/math/BigDecimal.html)获取更多信息。

# c# - DataGridView：FullRowSelect 和焦点

> ID：805939
> 
> 赞同：0
> 
> 时间：2009-04-30T08:35:30.990
> 
> 标签：c#, visual-studio, winforms, datagridview, focus

我在模式窗口中有一个 DataGridView，其中包含我的程序的选项列表。网格有两个列。第一个包含用于选择该选项的复选框，第二个是该选项的名称/描述。winform 还包含确定和取消按钮，但这不是重点。下面的代码做了我想要的。由于 FullRowSelect 属性，复选框被选中/取消选中，您单击该行内的任意位置。但是，它不再在当前行周围显示蓝色背景或虚线。我如何能够在不丢失任何当前功能的情况下添加它？

***编辑：***详细说明；我想要的是再次启用所选行/单元格上的虚线和/或蓝色背景。看起来我目前的代码以某种方式禁用了这个......

*相关当前代码：*

```
public OptionsForm()
{
    InitializeComponent();
    OptionsRoot = Options.GetReadOnlyRoot(OptionsBannersNameValueList.GetNameValueList(Settings.Default.OptionsBanners));
    optionsBannersDataGridView.SelectionMode = DataGridViewSelectionMode.FullRowSelect;
    optionsBannersDataGridView.MultiSelect = false;
    optionsBannersDataGridView.RowPrePaint += new DataGridViewRowPrePaintEventHandler(optionsBannersDataGridView_RowPrePaint);
    InitUI();
    Closing += MyFormClosing;
    BindingSourceTree = BindingSourceHelper.InitializeBindingSourceTree(components, rootBindingSource);
}

private void optionsBannersDataGridView_RowPrePaint(object sender, DataGridViewRowPrePaintEventArgs e)
{
    e.PaintParts &= ~DataGridViewPaintParts.Focus;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-30T08:54:42.083

我会尝试使用该[`.OnCellClick`](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.oncellclick.aspx)方法并将行颜色设置为蓝色。我认为您也应该能够添加虚线边框。

我相信你可以这样称呼它：

```
optionsBannersDataGridView.OnCellClick += new DataGridViewCellEventArgs(optionsBannersDataGridView_OnCellClick); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T11:42:03.073

我最终做的是删除上面提到的大部分代码，因为它实际上并没有做太多。出于某种原因，当我在 Visual Studio 中设置属性时它不起作用，但现在它起作用了。我不知道那里发生了什么，但这无关紧要。

构造函数现在看起来像这样：

```
public OptionsForm()
    {
        InitializeComponent();
        AlternativerRoot = Alternativer.GetReadOnlyRoot(AlternativerFanerNameValueList.GetNameValueList(Settings.Default.AlternativerFaner));
        InitUI();
        Closing += MyFormClosing;
        _bindingSourceTree = BindingSourceHelper.InitializeBindingSourceTree(components, rootBindingSource);
    } 
```

而是在 Visual Studio GUI 中设置属性。SelectionMode 设置为 FullRowSelect，MultiSelect 设置为 false。

我仍然没有得到我想要的焦点，所以我在 Visual Studio 中将所选行的背景色设置为蓝色，将前景色设置为白色。这现在就像我想要的那样工作。

我仍然不知道为什么之前没有正确设置属性，但至少它现在可以工作了：P

# vbscript - vbs结合consts

> ID：805942
> 
> 赞同：3
> 
> 时间：2009-04-30T08:37:38.880
> 
> 标签：vbscript

这是一个快速（而且可能很愚蠢）的问题，但是如果我有两个 consts 字符串，我如何从前一个 const 构建下一个 const 即

```
Const PATH_SRC = "some path\"
Const PATH_SRC_FILES = PATH_SRC & "files\" 
```

我知道您可能会说 const 是 const 但正在寻找快速解决方案。这是在 vbs 脚本中执行的。

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-30T08:49:17.243

如果我没记错我的 VBS 时代；你不能在 VBS 中做到这一点。常量只能设置为文字。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-02-24T03:24:59.727

有可能的！

```
Const PATH_SRC = "some path\"
execute "Const PATH_SRC_FILES =""" & PATH_SRC & "files\" & """"
msgbox PATH_SRC_FILES 
```

# python - 狮身人面像自动图像编号/标题？

> ID：805943
> 
> 赞同：3
> 
> 时间：2009-04-30T08:37:39.737
> 
> 标签：python, templates, python-sphinx

有没有办法使用 sphinx 自动生成图像/图形标题？

我目前有使用 sphinx 转换为 html 和 (latex)pdf 的 rest-sphinx 文件。

我想要一种简单的方法让用户在生成的 html/pdf 文件中引用特定图像。例如，如果用户在电子邮件中引用文档，“在 'Image 65' 中显示 XXX，但这对我不起作用”。

我尝试使用[figure](http://docutils.sourceforge.net/docs/ref/rst/directives.html#id15)，它似乎允许您将标题应用于图像，但这必须手动添加。（而且由于某种原因，我无法让它与替换一起工作）。

是否有一种我忽略的rest-sphinx方法可以实现这一目标？或者，有没有办法修改/编辑 sphinx 的现有模板以添加此功能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-30T09:23:29.283

[Sphinx 使用由Jinja](https://jinja.palletsprojects.com)模板化的 reStructuredText 。不过，根据 Sphinx 文档，您[还有其他模板选项](https://www.sphinx-doc.org/en/master/templating.html)。

您应该能够在自定义模板中使用 Jinja 的[控制结构](https://jinja.palletsprojects.com/en/2.11.x/templates/#list-of-control-structures)来实现您所追求的效果。

# php - 如何获取 url 以发回操作表单？

> ID：805949
> 
> 赞同：0
> 
> 时间：2009-04-30T08:40:01.370
> 
> 标签：php, html

我在另一个目录中有表单动作文件，但是一些文件发送到这个动作文件以及如何获取 url 来发送动作

[http://www.test.com](http://www.test.com)

```
-> action to http://www.123456.com/ac.php

how to get http://www.test.com in http://www.123456.com/ac.php to goback http://www.test.com 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-30T08:42:40.020

您可以将其存储`$_SEVER["HTTP_REFERER"]`在会话或其他变量中，然后在适用时使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-30T08:46:35.330

您可以考虑使用预定义的 php 变量来查找请求 URL，如下所示：

```
$_SERVER['HTTP_HOST']
$_SERVER['REQUEST_URI'] 
```

但是，如果您只想重定向到主机的根目录，那么您可以简单地将 HTTP 重定向发送到“/”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-30T08:52:06.287

我认为，如果您真的希望能够导航回上一页，最好将当前页面的 URL 与表单数据的其余部分一起发布。这样您就可以访问下一页上的该字段，并可以呈现一个链接，将用户发送回上一页......

您可以使用隐藏字段来存储表单中当前页面的 URL。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-30T09:24:07.160

`'http://' . $_SERVER['SERVER_NAME']`

我不建议使用 $_SERVER['HTTP_REFERER'] 因为它可能会被访问​​者浏览器、防火墙或防病毒软件阻止。更不用说值可能是错误的。

# php - FastCGI C++ 与脚本语言 (PHP/Python/Perl)

> ID：805957
> 
> 赞同：24
> 
> 时间：2009-04-30T08:43:03.233
> 
> 标签：php, c++, python, perl, fastcgi

使用 FastCGI C++ 与 PHP/Python/Perl 做同样的工作有哪些优缺点。

任何性能或设计缺陷或使用其中一个？甚至欢迎您的意见。（告诉我为什么一种或另一种岩石，或一种或另一种很烂）。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-04-30T09:54:56.493

脚本语言可能比 C 慢，但这是个问题吗？几乎从不。如果性能出现问题，您开始只翻译关键部分。

twitter/ruby 就是一个很好的例子；红宝石很慢。一些语言特性（首先使 ruby​​ 很好）只是阻止了不同类型的优化（jruby guy 有一篇很棒的文章关于这个......是 ola bini 吗？不记得了）。

尽管如此，twitter 还是由 ruby​​ 驱动的，因为 ruby*​​ 足够快*。不久前，“博客”报道 twitter 出于性能原因迁移到 scala ......事实是，只有消息传递队列（和后端的其他部分）迁移到 scala。雅虎运行多种语言；php 用于前端，其他更快的语言用于性能至关重要的地方。

那么，为什么性能不那么重要呢？有几个原因：

*   数据库瓶颈：不是脚本慢，是数据库慢
*   客户端瓶颈：在浏览器中呈现比请求花费的时间更长。优化服务器端，没人会注意到
*   水平扩展：添加另一台服务器通常比优化应用程序更便宜，因此每秒请求数增加三倍
*   开发人员的时间和维护是项目中最昂贵的部分。您将在更短的时间内获得比支持 Web 的 c-coders 更便宜的 python 开发人员来维护您的应用程序
*   无需编译，开发周期短

另一个支持脚本的观点：许多脚本语言支持内联或包含快速（C）代码：

*   蟒蛇，内联c
*   php：c 中的扩展
*   通过 rhino 的服务器端 javascript：直接访问 java/jvm *（orf.at 就是一个很好的例子，它是奥地利最大的网站之一，由[helma](http://dev.helma.org/)提供支持- 服务器端 jvm-interpreted javascript！）*

我认为，尤其是在 Web 开发中，高级脚本的优点远远超过缺点。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-04-30T09:00:35.203

几年前，我或多或少地在工作中学习了 Web 应用程序编程。C 是我所知道的主要语言，所以我用 C 编写了（相当大规模的）网络应用程序。严重错误。C 的字符串处理和内存管理很繁琐，再加上我缺乏 web 应用程序的经验，它很快就变成了一个难以维护的项目。

C++ 会好很多，主要是因为`std::string`它比`char*`.

但是，现在我每次都使用 Python（尽管 PHP 并不是一个糟糕的选择，而且可能更容易上手）。Python 的字符串处理非常棒，它可以无缝地处理 Unicode。Python 拥有比 C++ 更好的 Web 工具和框架，并且它的正则表达式处理和标准库（urllib、电子邮件等）运行良好。而且您不必担心内存管理。

如果我受到严重的 RAM 限制（例如在嵌入式微型计算机上），或者如果我在 Google 工作并且正在编写一个必须响应数千个查询的搜索引擎，我可能只会将 C 或 C++ 用于 Web 应用程序每秒。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-04-30T09:08:44.357

使用 C++ 可能会导致应用程序比 PHP、Perl 或 Python 快得多，并且比 C# 或 Java 快一些——除非它花费大部分时间等待 DB，在这种情况下不会有任何区别。这实际上是最常见的情况。

另一方面，由于 benhoyt 提到的原因，用 C++ 开发 Web 应用程序需要更长的时间并且更难维护。此外，它更有可能包含严重的安全漏洞（现在每个人都最担心 SQL 注入和 XSS - 但如果他们用 C++ 编写他们的 web 应用程序，那将是缓冲区溢出，这将是他们的整个网络被 p0wned 而不仅仅是数据）。

这就是为什么现在几乎没有人用 C++ 编写 Web 应用程序的原因。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-04-30T09:39:25.953

我认为应该有人成为 Webapp/C++ 主题的先驱，来测试地面并提供概念验证解决方案。

随着 STL 的到来和 Boost 的开发，使用 C++ 解析文本变得非常容易。两年前，如果我必须解析 CSV 数据，我会使用 Python 或 PHP。现在我将 C++ 与 STL/Boost 一起使用。将CSV文件读入向量？没问题，简单的 getline + boost::split + lexical_cast。计算成对向量中的数据总和？没问题：

```
pair<int, double> sum_int_double(pair<int,double> & total, pair<struct in_addr, pair<int,double> > & a) {
    total.first += a.second.first;
    total.second += a.second.second;
    return total;
}
pair<int,double> mixedSum = accumulate(mixedVec.begin(), mixedVec.end(), emptyPair, sum_int_double); 
```

将数据从地图传输到成对向量？没问题：

```
mixedVec.assign(amap.begin(), amap.end()); 
```

一切都定义明确且清晰。字符串操作、正则表达式、算法、OOP 等一切都在 C++ 中定义良好且成熟。如果您的应用程序将是真正的应用程序，而不是基于解析的文本，那么 C++ 的 OOP 特性也是不错的选择。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-04-30T10:21:35.120

问题是“创造的价值在哪里？”

如果您认为价值是在内存管理、仔细的类设计和让夜间构建工作中创造出来的，那么请使用 C++。您将花费大量时间编写大量代码来完成重要的事情，例如删除不再引用的对象。

如果您认为价值在于部署人们可以使用的应用程序，那么将 Python 与 Django 框架一起使用。Django 教程向您展示了在大约 20 分钟内您可以启动并运行一个应用程序。它已准备好生产，您可以专注于重要的事情：

*   该模型。只需用 Python 编写模型，ORM 层就会为您处理所有数据库交互。没有 SQL。没有手动映射。

*   演示文稿。只需在 HTML 中设计您的页面，并使用一些`{{}}`“在此处填写值”和一些`{% for thing in object_list %}`构造，您的页面就可以使用了。没有字符串操作。

*   视图函数。编写简单的 Python 函数来封装站点的处理部分。不是验证（那些在表单中），不是表示（在模板中），不是底层模型（在模型类中），而是一点授权检查、查询处理和响应制定。由于 Python 有一组丰富的集合类，所以这段代码最终会变得非常简短且切中要害。

*   其他的东西。URL 映射是 Python 正则表达式。表格与您的模型相匹配；您可以对默认值进行子类化以添加自定义输入验证和处理。

*   用于低级模型功能以及端到端操作的精彩单元测试框架。

没有内存管理，没有带有抽象和接口的严谨的类设计。不用担心如何优化字符串操作。没有夜间构建。只创造真正有价值的东西。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-04-30T10:10:36.283

如果您希望能够在现有的运行进程（例如守护程序）中实现 Web 服务，该进程是用 C/C++ 编写的。使该进程为该接口实现 FastCGI 协议是有意义的。让 Apache 处理与外界的 HTTP（2 路 SSL 等）并通过套接字通过 FastCGI 处理请求。如果您在 PHP 中执行此操作，则必须让 PHP 与您的进程对话，这意味着维护 PHP 代码以及您的进程。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-04-30T09:50:21.683

拥有一个 FastCGI Web 应用程序（无论是 C++、PHP、Perl、Python、Ruby 等）都可以比 CGI 应用程序提供更好的初始启动时间。*初始启动时间*是指从Web 服务器收到请求到运行您编写的第一行代码之间的时间，因此初始启动时间是您的 Web 应用程序的访问者必须等待的最短时间对于每个请求。初始启动时间为 1 秒并不罕见，尤其是当您的应用程序很大或使用大型框架（例如 Ruby on Rails）时。FastCGI 在响应第一个请求后保持您的应用程序运行，因此 FastCGI 减少了所有后续请求（第一个请求除外）的初始启动时间，通常降至几毫秒。

如果您使用 PHP，通常其默认配置会提供足够好的初始响应时间（即使没有 FastCGI），但请确保您在生产服务器上使用 PHP 加速器（请参阅[http://en.wikipedia.org/wiki/PHP_accelerator](http://en.wikipedia.org/wiki/PHP_accelerator) ) 以获得更好的性能。

大多数编程语言和框架允许您通过更改应用程序的配置，而无需更改代码，以不同的服务器模式（例如 CGI、FastCGI、内置 Web 服务器、Apache 模块）运行相同的应用程序。在编写应用程序时，FastCGI 通常不是最佳选择，因为在更改代码后，您可能必须重新启动应用程序以便它接收您的更改，但重新启动 FastCGI 应用程序通常很麻烦。重新启动 CGI 或内置网络服务器要容易得多。您应该只在生产配置中设置 FastCGI。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-04-30T11:07:42.247

之前有人问过这个问题：[http ://cppcms.sourceforge.net/wikipp/en/page/main](http://cppcms.sourceforge.net/wikipp/en/page/main)

CppCMS 项目提供了一个使用 C++ 进行 Web 开发的框架。

您可以查看以下基准以了解有什么区别：[http](http://cppcms.sourceforge.net/wikipp/en/page/benchmarks) ://cppcms.sourceforge.net/wikipp/en/page/benchmarks - 大约两个数量级。

PHP/Python 的问题，他们非常慢，在 PHP 的 FastCGI 过程中缓存数据有很多问题。

C++ 最大的问题是 C++ 中的 Web 开发资源少。但是，采用像 CppCMS 这样的框架会使生活变得更加简单。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-04-30T13:45:47.470

这里有一个中间立场。Python（我相信 Perl 和 Ruby）允许您从 C 调用函数。100 次中有 99 次，您不需要这样做。但是很高兴知道如果您需要，该选项就在那里。

通常对于 webapps，编程语言的速度根本不是问题。在执行单个数据库查询所需的时间内，处理器可以执行数十亿条指令。发送和接收http数据大致相同。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-04-30T09:09:41.360

您可以将 FastCGI 与 PHP/Python/Ruby/Perl 一起使用，以获得足够的运行时性能，直到您的网站变得非常大。即使这样，您也可以在不放弃脚本语言的情况下进行架构改进（数据库调整、缓存等）以实现更大的扩展性。一些相当大的网站是用 PHP/Python/Ruby/Perl 完成的。

使用高级语言获得的最大好处是程序员的性能。这是你首先应该担心的。快速响应用户的功能需求比将页面响应时间缩短几毫秒更为重要。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-09-24T07:20:51.877

嗯...您将使用 C/C++ 与 Python/Perl/Ruby/Java/.NET 节省内存和 CPU 功率。如果使用 C/C++ 节省的资源占可用资源总量的很大一部分（在机器人的嵌入式板上运行的 FastCGI），那么是的，C/C++。否则，何苦呢？

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-12-30T10:00:47.673

可能你们中的某些人可能会对 Wt [1] 感兴趣，这是一个完全用 C++ 编写的 Web 工具包。它可能是 cppCMS 的替代品。在这些圣诞节假期我都在尝试..

[1] [http://www.webtoolkit.eu/wt](http://www.webtoolkit.eu/wt)

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-08-24T10:47:50.023

太糟糕了，没有 C/C++ 与 Perl CGI 的基准。
如果没有 FastCGI，我认为 C/C++ 会快很多，使用 FastCGI 可能会更快（但可能会少一点——所有初始化部分都执行一次）。
同样，这非常依赖于*应用程序*，因此应该为不同的动态网页提供某种基准。

我个人认为，如果您的公司拥有资源，它应该/可以投资于 C/C++（鉴于他们必须找到合适的资源......），否则最好坚持使用脚本语言。
当然，如果您想部署*快速*应用程序，您应该使用 C/C++。

归根结底，编译语言更快。但是现在可能很难找到好的 C/C++ 开发人员？

干杯，

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2012-02-10T16:48:03.970

C++ 是一种强类型语言……也就是说，您可以声明整数、浮点数等……通常，您可以比使用弱类型语言更高效地进行编程。Facebook 报告说，从 PHP 切换到 C++ 时改进了 50%。我认为脚本语言是原型语言……当您希望生产级效率使用编译语言时。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2012-02-11T18:04:15.833

我通过 Google 进行的每次搜索都表明 C/C++ 为需要功能的网络应用程序提供了最佳性能，例如在网页中搜索信息或从数据库中获取信息。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2012-02-11T18:44:30.430

对此有一些新的答案。

1.  如果你需要一个编译的应用程序，你可能会发现[Google 的 Go 语言](http://golang.org)是一种很好的编译语言，具有现代特性。
2.  使用脚本语言（我使用 Perl）编写应用程序可以通过类似[`Mojolicious`](http://mojolicio.us)or的框架完成[`Dancer`](http://perldancer.org)，然后通过使用[PSGI/Plack](http://plackperl.org)控制器，它可以在 CGI、FastCGI、mod_perl、本机服务器（如 Mojolicious 的 Hypnotoad）或云部署上运行, 都没有修改。其他脚本语言也存在类似的概念。

# objective-c - 避免启动图像闪烁

> ID：805959
> 
> 赞同：0
> 
> 时间：2009-04-30T08:43:08.240
> 
> 标签：objective-c, cocoa-touch

我设法设计了一个相当不错的启动图像/default.png。但我注意到它只是闪烁一秒钟然后进入用户界面。是否可以对启动图像进行编码并使其动态化？留在屏幕上，直到用户触摸它或按钮。或者这是绝对不想做的事情？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T20:15:04.123

引用[Apple 的 HIG](http://developer.apple.com/iphone/library/documentation/UserExperience/Conceptual/MobileHIG/IconsImages/IconsImages.html#//apple_ref/doc/uid/TP40006556-CH14-SW5)：

“如果您认为遵循这些准则会导致发布图像非常平淡乏味，那您是对的。请记住，发布图像并不是为了提供艺术表达的机会；它只是为了增强用户对您的应用程序可以快速启动并立即投入使用。”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T20:18:56.203

如果您的应用程序可以立即使用，那就这样吧。将图像放在关于框或其他东西中。不要以任何理由延迟用户访问您的应用程序。这就是让我想追捕开发人员并对他们大喊“你在想什么”的事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-30T08:54:04.563

就个人而言，我会做任何事情来使我的应用程序看起来更具响应性，因为这是用户判断“应用程序性能”的主要因素。

因此，一个推论就是做任何事情来延迟用户访问 UI。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-03-14T19:05:14.367

您可以通过立即重新显示您的启动屏幕人为地延长启动图像的持续时间（以显示您的徽标至少 x 秒，执行初始网络请求等）。

我们在 AppDelegate.swift 中：

```
func application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplicationLaunchOptionsKey: Any]?) -> Bool {
{
    // ...

    // re-initializing LaunchScreen
    let launchScreenView = UIStoryboard(name: "LaunchScreen", bundle: nil).instantiateInitialViewController()!.view!
    launchScreenView.autoresizingMask = [.flexibleWidth, .flexibleHeight]
    launchScreenView.frame = window!.rootViewController!.view.bounds
    window?.rootViewController?.view.addSubview(launchScreenView)
    window?.makeKeyAndVisible()
} 
```

部分取自： [在应用启动时以模态方式呈现视图控制器](https://stackoverflow.com/a/42801231/1033581)。
（请注意，改进可能是使用[单独的 UIWindow](https://stackoverflow.com/a/48239491/1033581)而不是`addSubview`）

不要在其上添加手势识别器，因为用户不希望与它进行交互。相反，您可以使用计时器来隐藏它。

```
DispatchQueue.global().asyncAfter(deadline: .now() + 5.0) {
    // remove your launch screen
    launchScreenView.removeFromSuperview()
} 
```

# excel - 选择所有包含数据的单元格

> ID：805960
> 
> 赞同：9
> 
> 时间：2009-04-30T08:43:45.213
> 
> 标签：excel, vba

我在 Excel 工作表中有一些数据。我想选择所有包含数据的单元格。

例如，对于在单元格 A1、A2、A3、B1、B2、B3、C1、C2 和 C3 中包含数据的工作表，如何只选择这个 3x3 网格，而不是整个工作表？

我正在寻找类似的东西`ActiveSheet.SelectUsedCells`。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-30T09:00:37.513

干得好：

```
Range("A1").Select
Range(Selection, Selection.End(xlToRight)).Select
Range(Selection, Selection.End(xlDown)).Select 
```

或者，如果您不一定从 A1 开始：

```
Range("C6").Select  ' Select a cell that you know you populated'
Selection.End(xlUp).Select
Selection.End(xlToLeft).Select
Range(Selection, Selection.End(xlToRight)).Select
Range(Selection, Selection.End(xlDown)).Select 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-04-30T09:52:23.583

您可能还想查看该`CurrentRegion`属性。这将选择一个以空单元格为界的连续范围，因此可能是一种更优雅的方式，具体取决于工作表的格式。

例如：

```
Range("A1").CurrentRegion.Select 
```

# jquery - 如何使用 JQuery 绑定 TextBox 的 onchange 事件？

> ID：805963
> 
> 赞同：27
> 
> 时间：2009-04-30T08:47:47.060
> 
> 标签：jquery, html

如何将 TextBox 的 OnChange 事件绑定到使用 jQuery 的功能？

我正在尝试这个及其失败：

```
$(document).ready(function() {
    $("input#tags").bind("change",autoFill);
});

function autoFill() {
    $("#tags").autocomplete("/taglookup/", {
        width: 320,
        max: 4,
        highlight: false,
        multiple: true,
        multipleSeparator:",",
        scroll: true,
        scrollHeight: 300,
        delay: 10
    });
} 
```

注意：我想实现一个标签文本框，就像 stackoverflow 中的那样，它检测 OnChange 事件并在用户输入时调用 AJAX 函数。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-04-30T08:52:11.183

您正在寻找 keydown/press/up

```
$("#inputID").keydown(function(event) {
    alert(event.keyCode);
}); 
```

或使用绑定 $("#inputID").bind('onkeydown', ...

[http://docs.jquery.com/Events](http://docs.jquery.com/Events)

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2010-01-22T19:40:57.710

您必须将事件名称从“change”更改为“onchange”：

```
$(document).ready(function(){
        $("input#tags").bind("onchange", autoFill);
          }); 
```

或使用快捷活页夹方法更改：

```
$(document).ready(function(){
        $("input#tags").change(autoFill);
          }); 
```

请注意，onchange 事件通常在用户离开输入时触发，因此对于自动完成，您最好使用 keydown 事件。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2010-11-27T17:12:23.483

`keyup`和的组合`change`不一定足够（浏览器的自动完成和使用鼠标粘贴也会更改文本框的内容，但不会触发这些事件中的任何一个）：

[jquery 更改在动态值更改的情况下不起作用](https://stackoverflow.com/questions/3035633/jquery-change-not-working-incase-of-dynamic-value-change/4280932#4280932)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-02-11T22:07:32.267

这是为什么 onchange() 调用可能不会触发您的绑定函数的线索：

[http://jehiah.cz/archive/firing-javascript-events-properly](http://jehiah.cz/archive/firing-javascript-events-properly)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-07T08:57:04.007

我第二次乍得格兰特的回答并提交这篇博客文章 [删除死链接] 供您观赏。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-08-20T19:35:40.203

乍得所说的，除了在这种情况下使用 .keyup 更好，因为使用 .keydown 和 .keypress 输入的值仍然是旧值，即如果调用 .val() 则不会反映最新按下的键。

这可能应该是对乍得的回答的评论，但我还没有评论的特权。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-01-22T20:53:03.063

如果您尝试使用 jQuery 自动完成插件，那么我认为您不需要绑定到 onChange 事件，它会

# c# - System.Data.Linq.ChangeConflictException：未找到或更改行

> ID：805968
> 
> 赞同：64
> 
> 时间：2009-04-30T08:49:46.680
> 
> 标签：c#, .net, linq

我正在尝试使用 LINQ（无 LINQDataSource）删除选定的 gridview 行。

When the selection is changed, the detailsview binding is changed also. 我可以向数据库添加一个新条目，但是当我将此代码添加到 updatePanel 内的删除按钮时，我遇到了一个异常：

```
try
{           
    var query = from i in db.QuestionModules 
                where i.QuestionModuleID == QuestionModuleID 
                select i;

    QuestionModule o = query.First();
    db.QuestionModules.DeleteOnSubmit(o);
    db.SubmitChanges();
} 
```

这是我得到的例外：

```
System.Data.Linq.ChangeConflictException: Row not found or changed. at
System.Data.Linq.ChangeProcessor.SubmitChanges(ConflictMode
failureMode) at
System.Data.Linq.DataContext.SubmitChanges(ConflictMode failureMode)
at System.Data.Linq.DataContext.SubmitChanges() 
```

我遇到这个问题大约一个星期了，无论我做什么，它仍然存在，并且记录没有被删除。

关于做什么的任何想法？

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2009-07-06T13:39:30.677

好的 - 看起来（至少在我的情况下）答案是在 DBML 文件中将*所有*非主键列的 UpdateCheck 属性设置为*从不*。这样做立即解决了“未找到或更改行”的问题。

鉴于有传言称微软正在封存 Linq-To-Sql 以支持实体框架，有人想知道这些错误是否会得到修复？

* * *

## 回答 #2

> 赞同：59
> 
> 时间：2011-05-29T00:45:23.370

您收到此错误很可能是因为您的某个字段在 Linq To SQL 设计器和实际数据库中有所不同。

在我的情况下，这是因为其中一个字段在数据库中可以为空，而在设计器中不能为空，使其在设计器中可以为空，也立即解决了问题。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2013-03-04T18:49:58.257

我解决了这个问题，确保在更新对象之前立即刷新它。我使用 KeepChanges 选项执行此操作。

```
 db.Refresh(System.Data.Linq.RefreshMode.KeepChanges, employee); 
```

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2009-07-06T13:04:48.087

我遇到了同样的问题，并且遇到了[这个博客](http://forums.asp.net/t/1016914.aspx)，它基本上指出 Linq-To-Sql 在其乐观并发方面存在问题：

1.  使用高精度日期时间字段。解决方案是将 UpdateCheck 设置为从不用于 DBML 文件的该列
2.  设置为不可见的 GridView 列正在访问数据对象上的属性（第二个原因没有意义，但它似乎在该博客上风靡一时）。

我还没有尝试过这些解决方案，但一旦我尝试过就会发回这里。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2010-11-02T12:33:33.817

问题也可能只是表的 DBML 定义与数据库定义的状态不一致。我刚刚删除了 DBML 模型并再次从数据库中插入它，它工作正常。

希望这可以帮助某人。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2010-09-09T13:52:25.217

似乎也适合我的情况。我在内存中构建了一个从未提交过的行，该行与其他表中的行有几个外键关系。InsertOnSubmit 似乎有效，但随后的 DeleteOnSubmit 给了我该行未找到错误。我没有填充我提交的行中的每个字段，所以我不知道这是否与它有关，但标记所有主表的非主键列消除了错误消息。

进一步的想法：我认为将列的 UpdateCheck 策略标记为“从不”意味着它不用作乐观并发检查的基础。这意味着两个用户可以在任何此类列中使用不同数据覆盖给定行，并且不会检测到冲突……这意味着最后一个提交该行的用户将覆盖先前用户提交的值。我从各种在线阅读中收集到，一个部分解决方案是在提交之前立即使用 Refresh 方法来同步任何更改。当然，如果没有对行进行悲观锁定，则无法保证在刷新和提交之间该行仍不会更改，但在大多数涉及大型数据库的场景中，这种情况很少见。

更新：在进一步审查中，我认为我发现了一个可能会影响其他人的场景，所以我想我会分享它以防万一。事实证明，我在使用 SQL LINQ 时遇到的至少部分问题与触发器有关。看来，如果您使用 SQL LINQ 提交一行，并且您的 DBA 具有旨在将信息写入该行中某些列的触发器，那么 SQL LINQ 模型将默认“始终”确定该行自您上次写入以来已更改. 我提交了部分填充的行，并且我们的 DBA 触发器正在填充某些列，因此当我尝试进一步修改代码中的行时，它会根据触发器填充的列检测到更改冲突。我现在正在研究处理此问题的最佳方法，但将这些触发器填充字段更改为使用“更改时”或“从不”的 UpdateCheck 策略对我有用。希望能帮助到你。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2015-05-01T12:51:18.280

这只是列定义不匹配的情况。只需从中删除表`.dbml`并重新添加。确保更改`auto generate value property = true`具有自动生成数据的列，例如主键或日期时间列。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2010-11-02T11:44:00.917

更新行时，我遇到了类似的 changeconflictexception/“未找到或更改行”。通过在 dbml 中重新添加表来解决它。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2014-06-26T16:00:07.677

我遇到的问题是我在 .net 框架中有一个 DateTime 类型，但我们的数据库字段是 DateTime2 类型，它是更高精度的数据类型。因此，当我们提交更改时，对象与数据库的日期字段仅相差几纳秒，这将导致并发错误。当我们迁移到更新的 MSSQL 版本并将我们的 DateTime 字段转换为 DateTime2 时，就会发生这种情况。

所以在我们的代码中：

```
 Obj.DateUpdated = DateTime.Now() 
```

我们将其更改为：

```
 Obj.DateUpdated = DateTime.Parse(DateTime.Now.ToString()) 
```

因此，如果您在升级和/或迁移后收到此错误，请检查您的数据类型，尤其是日期字段。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-02-17T16:24:58.630

确保没有列包含`null`相关表（即要更新的表）中的值。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-07-09T08:41:54.280

对我来说，这是一个导致问题的枚举列（映射到一个 varchar），所以我必须通过更新检查以从不。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-04-29T01:16:30.827

我有一个类似的问题，虽然删除和重新添加 DBML 表/类对一些用户有帮助，但对我来说有点不同，因为我在客户端上使用带有分离实体和 ListView 的 WCF。

如果我使用 .Attach(entity) 它失败了 - “行未找到或更改”但是当使用 .Attach(entity, original) 它每次都有效

```
public void DeleteTask(Task task)
    {
        TwoDooDataContext db = new TwoDooDataContext();
        db.Tasks.Attach(task,GetTaskByID(task.ID));
        db.Tasks.DeleteOnSubmit(task);
        db.SubmitChanges();
    } 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-11-11T07:41:02.397

在下面：

```
QuestionModule o = query.First(); 
```

您必须添加以下命令：

```
db.QuestionModule.Attach(o); 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2010-02-21T21:26:48.207

在 updatepanel 回发期间，我能够通过在 gridview 和数据源上执行 databind() 来解决此问题。

```
 protected void UpdatePanel1_Load(object sender, EventArgs e)
    {
        GridView1.DataBind();
        LinqDataSource1.DataBind();
    } 
```

每次我的选择索引更改时我都会刷新更新面板，它能够解决冲突。

希望这可以帮助。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2011-10-04T12:52:22.850

我修复它的方法是：首先我更新数据库，然后我将网格的新值设置为

```
e.Keys["ColumnOne"] ="new value"
e.Keys["ColumnTwo"] ="new value" 
```

这一切都是在`GridView_RowUpdating`活动下完成的。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2012-03-07T19:06:29.873

我只是想为可能遇到此问题的任何人添加我的方案。

我们针对我们的 Linq to SQL dbml 使用自定义 T4。我们基本上只是修改了字符串属性的原始 get/set 以自动修剪和设置 null。

```
 get { return _OfficiantNameMiddle.GetValueOrNull(); }
        set 
        {
            value = value.GetValueOrNull();
            if (_OfficiantNameMiddle != value) 
            {
                _IsDirty = true;
                OnOfficiantNameMiddleChanging(value);
                SendPropertyChanging("OfficiantNameMiddle");
                _OfficiantNameMiddle = value;
                SendPropertyChanged("OfficiantNameMiddle");
                OnOfficiantNameMiddleChanged();
            }
        } 
```

我们数据库中的旧数据有一些前导/尾随空格，因此对这些列的任何并发检查都无法导致匹配（它将修剪的值与未修剪的数据库值进行比较）。分析 SQL 非常容易，获取 SQL 并开始注释掉 WHERE 子句中的项目，直到它在并发检查期间开始返回一行。

幸运的是，我们的表中有一个 LastUpdatedOn 字段，该字段是通过 OnValidate(System.Data.Linq.ChangeAction) 自动设置的。

```
 partial void OnValidate(System.Data.Linq.ChangeAction action)
    {
        if (action == System.Data.Linq.ChangeAction.Insert)
        {
            CreatedBy = CurrentUserID;
            CreatedOn = DateTime.Now;
            LastUpdatedBy = CreatedBy;
            LastUpdatedOn = CreatedOn;
        }
        else if (action == System.Data.Linq.ChangeAction.Update)
        {
            LastUpdatedBy = CurrentUserID;
            LastUpdatedOn = DateTime.Now;
        }
    } 
```

为了绕过这个问题，我们只是将除主键列和 LastUpdatedOn 列之外的所有列上的并发检查设置为从不。这对我们有用。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2011-08-11T00:28:41.867

另外 - 如果您正在调用 linqdatasource 的选择方法并手动设置 e.result，请确保您也包含任何外键值。

除了这个，没有其他东西对我有用。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2018-10-08T12:54:35.307

对我们来说，当我们切换到 SQL Server 端的 DateTime2 时，问题就开始了。只是用 Column(DbType = "DateTime2") 标记字段并没有帮助。所以，发生的事情是，最初在数据库端，我们将列声明为 DateTime2(3) 以与旧的 DateTime 类型“向后兼容”，并且一切似乎都工作正常，直到我们注意到当我们使用 SQL-2-Linq 时，我们在这些日期字段的更新中获取“未找到或更改行”异常。长话短说，解决方案是做两件事：

1.  用 [Column(DbType = "DateTime2(3)", CanBeNull = false)] 标记列以匹配数据库声明。和
2.  从设置器中的属性中修剪额外的精度数字，如下所示：

`[Column(DbType = "DateTime2(3)", CanBeNull = false)] public DateTime ModifiedAt { get => _modifiedAt; set => _modifiedAt = value.AddTicks(-(value.Ticks % TimeSpan.TicksPerMillisecond)); }`

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2017-02-13T21:32:44.550

正如@dherrin79 所指出的，这可能是由于数据库和代码之间的精度差异造成的。对我来说，问题是数据库列应该是小数（10,2），但它被创建为小数（18,0）。这是一个货币字段，所以也许我应该使用货币列类型。

所以，我存了一笔钱，比如 3.14 美元，但小数点被去掉了。这导致数据库值被更改并且与 C# 中的值不匹配。

希望这可以帮助。

# asp.net - ASP.NET GRids 和 DeveloperExpress ASPx Grid - 连接到 Web 服务

> ID：805971
> 
> 赞同：0
> 
> 时间：2009-04-30T08:51:10.080
> 
> 标签：asp.net, devexpress

是否可以将 asp.net 服务器控件（例如网格、中继器等）与 Web 服务结合使用？我想从 web 服务数据源填充网格，然后使用 web 服务保存更改。

是否可以将 DeveloperExpress Grid 与 Web 服务结合使用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-30T08:56:28.227

是的。你可以。

您可以创建一个 webmethod，它为例如包含可序列化类的对象的通用列表返回数据源，然后可以将其绑定到网格/DevExpress 网格。

# iphone - “分配”是@property 编译器指令的默认设置吗？

> ID：805972
> 
> 赞同：1
> 
> 时间：2009-04-30T08:51:20.483
> 
> 标签：iphone, cocoa-touch, uikit, properties

如果我定义一个属性并执行以下操作：

```
@property(nonatomic) UIButton* button; 
```

那么我认为这是一个“分配”属性。那是对的吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-30T10:33:20.130

属性参数的默认值是

分配、读写和“原子”（没有关键字“原子”。只有非原子）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-30T09:05:47.220

是的。

# visual-studio - T4 模板和 Visual Studio 项模板

> ID：805979
> 
> 赞同：3
> 
> 时间：2009-04-30T08:54:00.337
> 
> 标签：visual-studio, t4, vsx

是否可以创建从 T4 模板生成的 Visual Studio 项目模板？

我的 google-fu 似乎不够强大，无法给出答案！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-30T10:34:25.307

是的，您需要为此使用[GAX](http://msdn.microsoft.com/en-us/teamsystem/aa718948.aspx)。它有一个（相当有限的）自定义 T4 主机，允许您使用 T4 作为模板语言。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-04-29T08:48:34.577

是的，你可以，实际上 ASP.NET MVC 在从控制器项创建视图项时使用这种方法

所有最好的缪斯 VSExtensions

# asp.net - 从 ASP.Net 向 Word 文档添加页眉和页脚

> ID：805988
> 
> 赞同：0
> 
> 时间：2009-04-30T08:56:33.997
> 
> 标签：asp.net, ms-word

有什么方法可以将页眉和页脚信息添加到 Word。我目前正在使用 ASP.Net 将 HTML 内容写入 word 文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-12-21T15:06:11.010

下面的代码可以在不使用 HTML 格式的情况下生成 MS Word 文档 -

```
object oTrue = true;
object oFalse = false;
object oMissing = System.Reflection.Missing.Value;
object novalue = System.Reflection.Missing.Value;
object missing = System.Reflection.Missing.Value;
object fileName = "normal.dot";
object newTemplate = false;
object docType = 0;
object isVisible = true;

Microsoft.Office.Interop.Word.ApplicationClass questionClient = new Microsoft.Office.Interop.Word.ApplicationClass();

Microsoft.Office.Interop.Word.Document questionDoc = questionClient.Documents.Add(ref fileName, ref newTemplate, ref docType, ref isVisible);
questionDoc.Activate();

//adding header
string logoPath = Server.MapPath("~//photos//logica_logo_black.JPG");
Microsoft.Office.Interop.Word.Shape logoCustom = null;
questionClient.ActiveWindow.ActivePane.View.SeekView = Microsoft.Office.Interop.Word.WdSeekView.wdSeekCurrentPageHeader;
logoCustom = questionClient.Selection.HeaderFooter.Shapes.AddPicture(logoPath, ref oFalse, ref oTrue, ref oMissing, ref oMissing, ref oMissing, ref oMissing, ref oMissing);
logoCustom.Select(ref oMissing);
logoCustom.Name = "CustomLogo";
logoCustom.Left = -47;
logoCustom.Top = -19;

//adding footer
questionClient.ActiveWindow.ActivePane.View.SeekView = Microsoft.Office.Interop.Word.WdSeekView.wdSeekCurrentPageFooter;
questionClient.ActiveWindow.Selection.Font.Name = "Verdana";
questionClient.ActiveWindow.Selection.Font.Size = 8;
Object CurrentPage = Microsoft.Office.Interop.Word.WdFieldType.wdFieldPage;
questionClient.ActiveWindow.Selection.TypeText("For Logica Internal Use Only");
questionClient.ActiveWindow.Selection.TypeText("                                             ");
questionClient.ActiveWindow.Selection.TypeText("Page ");
questionClient.ActiveWindow.Selection.Fields.Add(questionClient.Selection.Range, ref CurrentPage, ref oMissing, ref oMissing);
questionClient.ActiveWindow.Selection.TypeText("                                                     ");
questionClient.ActiveWindow.Selection.TypeText(DateTime.Today.ToString("MM/dd/yyyy"));

//saving and closing the document
questionClient.Documents.Save(ref oMissing, ref oMissing);
questionClient.Quit(ref oMissing, ref oMissing, ref oMissing); 
```

# java - Can one validate marshalled XML with JAXB 2.0?

> ID：805989
> 
> 赞同：18
> 
> 时间：2009-04-30T08:57:13.810
> 
> 标签：java, validation, jaxb

Apparently in version 2 of JAXB - the validator class has been deprecated - does this mean the marshaller is automatically validating your XML? If so it doesn't seem to be complaining about some of the incorrect XML I am forming! Can anyone give me some advice on how I can validate marshalled XML to make sure it conforms to the XSD schema.

Many thanks.

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-04-30T09:17:24.150

Validation capabilities have been expanded in JAXB 2.0 through the use of the JAXP 1.3 Schema Validation Framework.

Where before you did:

```
unmarshaller.setValidating(true); 
```

now you need to do:

```
SchemaFactory sf = SchemaFactory.newInstance(
    javax.xml.XMLConstants.W3C_XML_SCHEMA_NS_URI);
Schema schema = sf.newSchema(new File("myschema.xsd"));
unmarshaller.setSchema(schema); 
```

If you pass null into `setSchema`, it disables validation.

Please check [this reference](http://download.oracle.com/javaee/5/api/javax/xml/bind/Unmarshaller.html).

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-08-04T20:43:05.317

If you are looking to verify the Java objects generate valid XML according to a schema, look at the JAXB-Verification project:

[https://jaxb-verification.dev.java.net/](https://jaxb-verification.dev.java.net/)

It is a JAXB RI plugin to xjc that will generate an ObjectVerifier implementation for the XML schema. This avoids having to marshal the Java objects in order to validate the XML.

# vb.net - 命令行自动化问题——VS2005团队版

> ID：805992
> 
> 赞同：0
> 
> 时间：2009-04-30T08:58:09.110
> 
> 标签：vb.net, visual-studio-2005, build-automation

我正在尝试通过使用 VB.NEt 编写的插件来自动化 VC++ 构建，以便我们可以使用简单的批处理文件来安排它。此插件在开始构建之前执行一些自定义先决条件。构建被调用为...

```
devenv.com /useenv %NEWSOLFILE% /CLEAN %BUILDCONFIG% /OUT %OUTLOGFILE% > nul 
```

适当的文件名替换。我在以下入口点遇到问题：-

```
Public Sub OnConnection(ByVal application As Object, ByVal connectMode As ext_ConnectMode, ByVal addInInst As Object, ByRef custom As Array) Implements IDTExtensibility2.OnConnection
        If connectMode = ext_ConnectMode.ext_cm_CommandLine Then
        ' this is always false why??
       End If
End Sub 
```

尽管我们从命令行调用构建，但这里的“connectMode”从未被标记为“ext_ConnectMode.ext_cm_CommandLine”。这是另一个令人讨厌的 MS 错误吗？

有人遇到过这个吗？我需要对 VS 2005 应用什么补丁来解决这个问题吗？或者有什么简单的解决方法吗？

提前致谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-30T10:29:17.003

好吧，我在 Internet 上找到了这个[VS 命令行框架的挫折](http://msmvps.com/blogs/carlosq/archive/2007/10/11/frustrations-with-command-line-add-ins-for-visual-studio.aspx)

它是一个 MS Visual Studio 错误。此外，还为那些不愿意升级/修补的人概述了一种解决方法。

# listbox - 从 Listbox 的 groupstyle 访问扩展器

> ID：805998
> 
> 赞同：0
> 
> 时间：2009-04-30T08:59:41.213
> 
> 标签：listbox, expander

我正在使用数据绑定到 ICollectionView 的 WPF 列表框来显示可以过滤的项目列表。我正在使用 ListBox 上的上下文菜单对 Listbox 中的项目进行分组。为此，我在 Listbox 上定义了一个 groupstyle，它里面有一个扩展器。相同的代码如下。所有 xaml 代码都在 Generic.xaml 文件中，具有此 ListBox 的控件是在 CustomControls 库中定义的自定义控件。

```
 <ListBox.GroupStyle>
                            <GroupStyle HidesIfEmpty="True">
                                <GroupStyle.ContainerStyle>
                                    <Style TargetType="{x:Type GroupItem}">
                                        <Setter Property="Margin" Value="0,0,0,5"/>
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="{x:Type GroupItem}">
                                                    <Expander Style="{StaticResource GroupBoxExpander}" IsExpanded="True" 
                                                              BorderBrush="Black" BorderThickness="0,0,0,1" x:Name="expander">
                                                        <Expander.Header>
                                                            <DockPanel>
                                                                <TextBlock FontWeight="Bold" Text="{Binding Path=Name}" 
                                                                           Margin="5,0,0,0" Width="100"/>
                                                            </DockPanel>
                                                        </Expander.Header>
                                                        <Expander.Content>
                                                            <ItemsPresenter/>
                                                        </Expander.Content>
                                                    </Expander>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </Style>
                                </GroupStyle.ContainerStyle>
                            </GroupStyle>
                        </ListBox.GroupStyle> 
```

使用 ICollectionView 的过滤器方法，我根据在与 ListBox 关联的文本框中输入的字符串过滤 Listbox 中的项目。因此，即使该组已折叠，如果已完成搜索的项目位于折叠的扩展器内，扩展器也会展开并且该项目在列表框中可见。但是，问题是当从文本框中删除搜索字符串时，扩展器应该回到它之前的状态，就像在这个状态下回到它的折叠状态一样。为此，我试图获取 exapnder 的 IsExpanded 属性，并根据其值，在搜索完成后将扩展器的状态设置为之前的状态。

我试图通过以下方式获取扩展器，但这里的问题是它只能在列表框的选择更改事件触发时发生：

FrameworkElement item = listbox.ItemContainerGenerator.ContainerFromItem(listbox.SelectedItem) as FrameworkElement; if (item != null) { GroupItem groupItem = item.GetVisualParent(); if (groupItem != null) { Expander expander = groupItem.Template.FindName("expander", groupItem) as Expander; if (expander != null) { expander.Collapsed += new RoutedEventHandler(expander_Collapsed); } } }

谁能告诉我这是否是正确的方法以及如何在文件旁边的代码中访问扩展器的 IsExpanded 属性，或者我可以尝试以不同的方式尝试吗？

索米。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-11-30T11:25:10.480

```
 private void eve_PreviewMouseLeftButtonDown_Expander(object sender, MouseButtonEventArgs e)
        {
            GroupItem gi = sender as GroupItem;
            if (gi != null)
            {
                ControlTemplate ct = gi.Template;
                if (ct != null)
                {
                    DependencyObject content = ct.LoadContent();
                    Expander expander = content as Expander;
                    if (expander != null)
                    {
                        //Expand or collapse
                        expander.IsExpanded = !expander.IsExpanded;
                    } 
                }
            }
        } 
```***********