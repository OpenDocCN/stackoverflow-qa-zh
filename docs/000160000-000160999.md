# StackOverflow 问答 000160000-000160999

# testing - iMacros is good but unreliable. Is there any alternative?

> ID：160001
> 
> 赞同：5
> 
> 时间：2008-10-01T22:11:55.370
> 
> 标签：testing, macros

iMacros is a very nice tool which allows to authomatically fill HTML forms and extract content, includes cycles and many other features. The problem is that it is quite tricky to make it extracting content properly. For example, I have failed to extract all London-to-Tokio flight prices for all the dates between 1/10/08 to 1/12/08 to find a cheapest one from expedia. Sometimes it just crashes. Does anyone know any good alternative?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-01T23:42:11.720

[呸，我安装了它，但从未真正使用过它：我对Greasemonkey](https://addons.mozilla.org/firefox/addon/748 "Greasemonkey :: Firefox 附加组件")很满意。
[鸡脚](http://groups.csail.mit.edu/uid/chickenfoot/install.html "鸡足")可以让它更可食用...

在搜索 URL 时，我还发现[了 DéjàClick](http://www.dejaclick.com/ "DéjàClick")和[Selenium IDE](http://selenium-ide.openqa.org/ "硒 IDE")，但我并不真正了解它们。
还有很多其他用于 Web 自动化的工具，其中大多数是专业的（阅读“付费软件”...）。

或者，对于数据提取，我会使用 cURL 或 wget 和一个好的 HTML 解析器......

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-02T02:01:16.830

我也听说过[Selenium IDE](http://selenium-ide.openqa.org/)的好消息，我有限的测试表明它非常有能力，并且可以在 Firefox 和 IE 中运行。

对于大多数基于宏的测试工具，如果您需要支持多个可重复的测试用例，您将需要进行一些编程。

也就是说，在您的示例中，您提到运行 Expedia 宏......大概是为了收集结果。您将需要确保您不会敲击 Expedia 的服务器，和/或一旦他们发现您（实际上）是机器人，就会被启动。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-08T08:06:38.200

我同意 imacros 非常不可靠。如果您使用复杂的算法或连续运行它，它们很容易崩溃。诀窍是关闭它并在循环后再次打开它。它会减少您会发现的崩溃次数，但不会完全减少。

# python - 模型 limit_choices_to={'user': user}

> ID：160009
> 
> 赞同：14
> 
> 时间：2008-10-01T22:14:36.453
> 
> 标签：python, django, model

我查看了所有文档，还访问了 IRC 频道（顺便说一句，一个很棒的社区），他们告诉我不可能在“当前用户”位于 ForeignKey 的字段中创建模型并限制选择。我将尝试用一个例子来解释这一点：

```
class Project(models.Model):
  name = models.CharField(max_length=100)
  employees = models.ManyToManyField(Profile, limit_choices_to={'active': '1'})

class TimeWorked(models.Model):
  project = models.ForeignKey(Project, limit_choices_to={'user': user})
  hours = models.PositiveIntegerField() 
```

当然，该代码不起作用，因为没有“用户”对象，但这是我的想法，我试图将对象“用户”发送到模型以限制当前用户拥有项目的选择，我不不想看到我不在的项目。

非常感谢你能帮助我或给我任何建议，我不想你写所有的应用程序，只是一个提示如何处理。我脑子里有 2 天的时间，但我想不通:(

**更新**：解决方案在这里：[http](http://collingrady.wordpress.com/2008/07/24/useful-form-tricks-in-django/) ://collingrady.wordpress.com/2008/07/24/useful-form-tricks-in-django/发送`request.user`到模型。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2011-01-11T09:52:59.617

这种对当前用户的选择限制是一种需要在请求周期中动态发生的验证，而不是在静态模型定义中。

换句话说：在您创建此模型的*实例*时，您将处于视图中，此时您将可以访问当前用户并可以限制选择。

然后你只需要一个自定义的 ModelForm 来传递 request.user 到，看这里的例子：http: [//collingrady.wordpress.com/2008/07/24/useful-form-tricks-in-django/](http://collingrady.wordpress.com/2008/07/24/useful-form-tricks-in-django/)

```
from datetime import datetime, timedelta
from django import forms
from mysite.models import Project, TimeWorked

class TimeWorkedForm(forms.ModelForm):
    def __init__(self, user, *args, **kwargs):
        super(ProjectForm, self).__init__(*args, **kwargs)
        self.fields['project'].queryset = Project.objects.filter(user=user)

    class Meta:
        model = TimeWorked 
```

那么在你看来：

```
def time_worked(request):
    form = TimeWorkedForm(request.user, request.POST or None)
    if form.is_valid():
        obj = form.save()
        # redirect somewhere
    return render_to_response('time_worked.html', {'form': form}) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-02T00:47:35.650

模型本身对当前用户一无所知，但您可以在视图中为该用户提供操作模型对象的表单（并在`choices`必要字段的表单重置中）。

如果您在管理站点上需要这个 - 您可以尝试`raw_id_admin`（`django-granular-permissions`http://code.google.com/p/django-granular-permissions/[但](http://code.google.com/p/django-granular-permissions/)我无法快速让它在我的 django 上运行，但它似乎是新鲜的足够 1.0 所以......）。

最后，如果您非常需要管理员中的选择框 - 那么您需要`django.contrib.admin`自行破解。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-03-28T01:50:37.230

在 Django 1.8.x / Python 2.7.x 中使用基于类的通用视图，这是我和我的同事提出的：

在模型.py 中：

```
# ...

class Proposal(models.Model):
    # ...

    # Soft foreign key reference to customer
    customer_id = models.PositiveIntegerField()

    # ... 
```

在 forms.py 中：

```
# -*- coding: utf-8 -*-
from __future__ import unicode_literals

from django.forms import ModelForm, ChoiceField, Select
from django import forms
from django.forms.utils import ErrorList
from django.core.exceptions import ValidationError
from django.utils.translation import ugettext as _
from .models import Proposal
from account.models import User
from customers.models import customer

def get_customers_by_user(curUser=None):
    customerSet = None

    # Users with userType '1' or '2' are superusers; they should be able to see
    # all the customers regardless. Users with userType '3' or '4' are limited
    # users; they should only be able to see the customers associated with them
    # in the customized user admin.
    # 
    # (I know, that's probably a terrible system, but it's one that I
    # inherited, and am keeping for now.)
    if curUser and (curUser.userType in ['1', '2']):
        customerSet = customer.objects.all().order_by('company_name')
    elif curUser:
        customerSet = curUser.customers.all().order_by('company_name')
    else:
        customerSet = customer.objects.all().order_by('company_name')

    return customerSet

def get_customer_choices(customerSet):
    retVal = []

    for customer in customerSet:
        retVal.append((customer.customer_number, '%d: %s' % (customer.customer_number, customer.company_name)))

    return tuple(retVal)

class CustomerFilterTestForm(ModelForm):

    class Meta:
        model = Proposal
        fields = ['customer_id']

    def __init__(self, user=None, *args, **kwargs):
        super(CustomerFilterTestForm, self).__init__(*args, **kwargs)
        self.fields['customer_id'].widget = Select(choices=get_customer_choices(get_customers_by_user(user)))

# ... 
```

在views.py中：

```
# ...

class CustomerFilterTestView(generic.UpdateView):
    model = Proposal
    form_class = CustomerFilterTestForm
    template_name = 'proposals/customer_filter_test.html'
    context_object_name = 'my_context'
    success_url = "/proposals/"

    def get_form_kwargs(self):
        kwargs = super(CustomerFilterTestView, self).get_form_kwargs()
        kwargs.update({
            'user': self.request.user,
        })
        return kwargs 
```

在模板/提案/customer_filter_test.html 中：

```
{% extends "base/base.html" %}

{% block title_block %}
<title>Customer Filter Test</title>
{% endblock title_block %}

{% block header_add %}
<style>
    label {
        min-width: 300px;
    }
</style>
{% endblock header_add %}

{% block content_body %}
<form action="" method="POST">
    {% csrf_token %}
    <table>
        {{ form.as_table }}
    </table>
    <input type="submit" value="Save" class="btn btn-default" />
</form>
{% endblock content_body %} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-02T00:58:35.873

我不确定我是否完全理解您想要做什么，但我认为您很有可能使用[自定义 Manager](https://docs.djangoproject.com/en/dev/topics/db/managers/#custom-managers-and-model-inheritance)至少部分实现。特别是，不要尝试定义对当前用户有限制的模型，而是创建一个只返回与当前用户匹配的对象的管理器。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-10-01T22:24:08.960

嗯，我不完全理解你的问题。但是如果你在声明模型时不能这样做，也许你可以通过覆盖你“发送”用户对象的对象类的方法来实现同样的事情，也许从构造函数开始。

* * *

## 回答 #6

> 赞同：-5
> 
> 时间：2008-10-02T10:09:01.213

如果要获取编辑此模型的**当前用户，请使用 threadlocals。**Threadlocals 中间件将当前用户放入进程范围的变量中。拿这个中间件

```
from threading import local

_thread_locals = local()
def get_current_user():
    return getattr(getattr(_thread_locals, 'user', None),'id',None)

class ThreadLocals(object):
    """Middleware that gets various objects from the
    request object and saves them in thread local storage."""
    def process_request(self, request):
        _thread_locals.user = getattr(request, 'user', None) 
```

查看有关如何使用中间件类的文档。然后在代码中的任何地方都可以调用

```
user = threadlocals.get_current_user 
```

# ruby - What options do exist now to implement UTF8 in Ruby and RoR?

> ID：160016
> 
> 赞同：5
> 
> 时间：2008-10-01T22:16:27.887
> 
> 标签：ruby, utf-8, internationalization

Following the development of Ruby very closely I learned that detailed character encoding is implemented in Ruby 1.9\. My question for now is: How may Ruby be used at the moment to talk to a database that stores all data in UTF8?

Background: I am involved in a new project where Ruby/RoR is at least an option. But the project needs to rely on an internationalized character set (it's spread over many countries), preferably UTF8.

So how do you deal with that? Thanks in advance.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-10T02:49:37.543

Ruby 1.8 可以很好地处理 UTF-8 字符串，以便对字符串进行基本操作。根据您的应用程序的需要，某些操作将无法正常工作或无法按预期工作。

例如：

1）字符串的大小会给你字节，而不是字符，因为还没有多字节支持。但是您需要知道字符串的字符大小吗？

2) 不在字符边界处拆分字符串。但是你需要这个吗？等等。

3) 如果在 Ruby 中排序，排序顺序会很时髦。使用 db 进行排序的建议是个好主意。

等等

重新发布从 db 读取数据后对数据进行排序的评论：如前所述，结果可能与用户的期望不符。所以解决方案是对数据库进行排序。无论如何，它通常会更快——数据库旨在对数据进行排序。

简介：我的 Ruby 1.8.6 RoR 应用程序可以在现代浏览器上处理和存储为 UTF-8 的国际 Unicode 字符正常工作。从右到左的语言也可以正常工作。主要问题：确保您的数据库和所有网页都设置为使用 UTF-8。如果您的数据库中已经有一些数据，那么您需要通过转换过程将其更改为 UTF-8。

问候，

拉里

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-10T03:09:54.563

“Unicode 哎呀！虽然 Rails 一直能够存储和显示 unicode，但截断、反转或获取 UTF-8 字符串的确切长度有点复杂。你需要自己玩弄 KCODE虽然很多人让它工作，但它并不像你希望的那样容易（甚至可能是预期的）。

因此，由于 Ruby 直到明年这个时候才会支持多字节，Rails 1.2 引入了 ActiveSupport::Multibyte 来处理 Unicode 字符串。调用字符串上的 chars 方法以开始使用字符而不是字节。”[单击此处了解更多信息](http://weblog.rubyonrails.org/2007/1/19/rails-1-2-rest-admiration-http-lovefest-and-utf-8-celebrations)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-02T00:28:54.917

虽然我还没有测试过，但是字符编码库（目前是 alpha 版本）向 String 类添加了处理 UTF-8 和其他字符的方法。它在 RubyForge 上的页面在[这里](http://rubyforge.org/projects/char-encodings/)。它是为 Ruby 1.8 设计的。

然而，根据我的经验，使用 Ruby 1.8，如果您将数据以 UTF-8 格式存储在数据库中，只要 HTTP 标头中的字符编码是 UTF-8，Ruby 就不会妨碍您。它可能无法对琴弦进行操作，但它不会破坏任何东西。例子：

```
file.txt:
¡Hola! ¿Como estás? Leí el artículo. ¡Fue muy excellente! 
```

原谅我可怜的西班牙语；这是我能想到的最好的 Unicode 例子。

```
in irb:
str = File.read("file.txt")
   => "\302\241Hola! \302\277Como est\303\241s? Le\303\255 el art\303\255culo. \302\241Fue muy excellente!\n"
str += "Foo is equal to bar."
   => "\302\241Hola! \302\277Como est\303\241s? Le\303\255 el art\303\255culo. \302\241Fue muy excellente!\nFoo is equal to bar."
str = "    " + str + "    "
   => "    \302\241Hola! \302\277Como est\303\241s? Le\303\255 el art\303\255culo. \302\241Fue muy excellente!\nFoo is equal to bar.    "
str.strip
   => "\302\241Hola! \302\277Como est\303\241s? Le\303\255 el art\303\255culo. \302\241Fue muy excellente!\nFoo is equal to bar." 
```

基本上，它只会将 UTF-8 视为带有奇数字符的 ASCII。如果代码点乱序，它不会按字典顺序排序；但是，它将按代码点排序。例子：

```
"\302" <=> "\301"
   => -1 
```

无论如何，您打算对 Rails 应用程序中的数据进行多少操作？大多数排序等通常由您的数据库引擎完成。

# c# - 判断资源是否存在于 ResourceManager

> ID：160022
> 
> 赞同：19
> 
> 时间：2008-10-01T22:18:49.330
> 
> 标签：c#, resources

无论如何确定 ResourceManager 是否包含命名资源？目前我正在捕捉 MissingManifestResourceException 但我讨厌必须在非异常情况下使用异常。必须有某种方法通过反射来枚举 ResourceManager 的名称值对，还是什么？

**编辑**：更详细一点。资源不在执行程序集中，但是 ResourceManager 工作得很好。如果我尝试`_resourceMan.GetResourceSet(_defaultCuture, false, true)`，我会得到 null，而如果我尝试，`_resourceMan.GetString("StringExists")`我会得到一个字符串。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-10-02T12:28:01.427

您可以使用 ResourceSet 来执行此操作，如果您枚举它，它只会将所有数据加载到内存中。来吧：

```
 // At startup.
    ResourceManager mgr = Resources.ResourceManager;
    List<string> keys = new List<string>();

    ResourceSet set = mgr.GetResourceSet(CultureInfo.CurrentCulture, true, true);
    foreach (DictionaryEntry o in set)
    {
        keys.Add((string)o.Key);
    }
    mgr.ReleaseAllResources();

    Console.WriteLine(Resources.A); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-01T22:30:05.823

[我认为您可以使用Assembly.GetManifestResourceNames](http://msdn.microsoft.com/en-us/library/system.reflection.assembly.getmanifestresourcenames(VS.80).aspx)之类的东西来枚举程序集清单中可用的资源列表。它并不漂亮，也不能解决所有极端情况，但如果需要，它可以工作。

# apache-flex - Why does Flex Builder fail to connect the app so often?

> ID：160026
> 
> 赞同：1
> 
> 时间：2008-10-01T22:19:56.877
> 
> 标签：apache-flex, flexbuilder

Flex Builder often fails to connect to the app that it's supposed to debug. After a minute or so it times-out and says that it couldn't connect. The only way I can get it to stop doing this is by restarting Eclipse.

Very annoying. Anyone know why this is?

I'm using FB 3.1 and Firefox on Win XP.

Many thanks!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-02T01:55:09.777

这成为 Firefox 3 的一个问题，一般的解决方法是开始禁用 Firefox 扩展，直到它正常工作。我发现 AdBlock 和 IETab 扩展干扰了 Flex 调试；一旦在 Firefox 的附加管理器中禁用了这些功能，情况就会好转。

有关更多信息，请参阅Adob​​e 网站上的[此错误报告。](http://bugs.adobe.com/jira/browse/FB-13064)

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2008-10-01T22:26:38.517

I think it may be because it's full of bugs. I haven't worked with it on windows but on os x it reeks. You have to restart the whole os to get it back to normal sometimes.

# debugging - How to put breakpoint in every function of .cpp file?

> ID：160030
> 
> 赞同：14
> 
> 时间：2008-10-01T22:20:37.750
> 
> 标签：debugging, visual-c++, visual-studio-2005, macros, envdte

Is there a macro that does it? Which DTE objects to use?

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2010-07-30T10:29:21.787

（这不是你所要求的，但几乎是:)

您可以在 Visual Studio**中的类的每个成员函数**上放置一个断点，方法是打开*New Breakpoint*对话框并输入：

```
CMyClass::* 
```

请参阅[http://blogs.msdn.com/b/habibh/archive/2009/09/10/class-breakpoint-how-to-set-a-breakpoint-on-ac-class-in-the-visual-studio -debugger.aspx](http://blogs.msdn.com/b/habibh/archive/2009/09/10/class-breakpoint-how-to-set-a-breakpoint-on-a-c-class-in-the-visual-studio-debugger.aspx)了解更多详细信息。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-10T22:17:48.130

下面是 1800 INFORMATION 想法的快速实现：

```
Sub TemporaryMacro()
    DTE.ActiveDocument.Selection.StartOfDocument()
    Dim returnValue As vsIncrementalSearchResult
    While True
        DTE.ActiveDocument.ActiveWindow.Object.ActivePane.IncrementalSearch.StartForward()
        returnValue = DTE.ActiveDocument.ActiveWindow.Object.ActivePane.IncrementalSearch.AppendCharAndSearch(AscW("{"))
        DTE.ActiveDocument.ActiveWindow.Object.ActivePane.IncrementalSearch.Exit()
        If Not (returnValue = vsIncrementalSearchResult.vsIncrementalSearchResultFound) Then
            Return
        End If
        DTE.ExecuteCommand("Debug.ToggleBreakpoint")
        DTE.ExecuteCommand("Edit.GotoBrace")
        DTE.ActiveDocument.Selection.CharRight()
    End While
End Sub 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-01T22:25:19.457

I don't know what DTE functions to use, but you could very simply record a macro that could pretty much do it:

1.  Go to the top of the file
2.  ctrl - shift - R (start recording)
3.  ctrl - I (incremental search)
4.  { (search for the first { character).
5.  F9 (set breakpoint)
6.  ctrl - ] (go to matching } character)
7.  ctrl - shift - R (stop recording)

Now just run this over and over (ctrl - shift P repeatedly) until you reach the end of the file.

If you have namespaces, then change 4\. to:

4.  ( (search for "(" at the start of the function definition)
5.  esc (stop incremental search)
6.  ctrl - I (incremental search again)
7.  { (start of function body)

This kind of thing can be infinitely modified to suit your codebase

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-12T23:05:32.263

就像康斯坦丁的方法......这似乎是windbg的领域。

既然你有cpp，（即使你没有编写脚本来解决问题），使用windows调试工具的[记录器](http://msdn.microsoft.com/en-us/library/cc266308.aspx)部分应该没问题......这是一个非常方便的工具，可惜人很少用它。

记录器调试的 C/COM/C++ 轻松，具有丰富的符号信息，钩子/分析/灵活的仪器；

[*激活 Logger 的一种方法是启动 CDB 或 WinDbg 并像往常一样附加到用户模式目标应用程序。然后，使用 !logexts.logi 或 !logexts.loge 扩展命令。这将在当前断点处插入代码，该代码将跳转到在目标应用程序进程中加载​​和初始化 Logexts.dll 的例程。这称为“将 Logger 注入目标应用程序”。*](http://msdn.microsoft.com/en-us/library/cc266315.aspx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-09T19:30:43.623

以下是在 WinDbg 中如何实现类似的功能：

```
bm mymodule!CSpam::* 
```

`CSpam`这会在 module中类（或命名空间）的每个方法中放置断点`mymodule`。

我仍在 Visual Studio 中寻找与此功能相近的任何东西。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-11-26T08:01:34.910

有一个宏，但我只用 c# 测试过。

```
Sub BreakAtEveryFunction()
For Each project In DTE.Solution.Projects
    SetBreakpointOnEveryFunction(project)
Next project
End Sub

Sub SetBreakpointOnEveryFunction(ByVal project As Project)
Dim cm = project.CodeModel

' Look for all the namespaces and classes in the 
' project.
Dim list As List(Of CodeFunction)
list = New List(Of CodeFunction)
Dim ce As CodeElement
For Each ce In cm.CodeElements
    If (TypeOf ce Is CodeNamespace) Or (TypeOf ce Is CodeClass) Then
        ' Determine whether that namespace or class 
        ' contains other classes.
        GetClass(ce, list)
    End If
Next

For Each cf As CodeFunction In list

    DTE.Debugger.Breakpoints.Add(cf.FullName)
Next

End Sub

Sub GetClass(ByVal ct As CodeElement, ByRef list As List(Of CodeFunction))

' Determine whether there are nested namespaces or classes that 
' might contain other classes.
Dim aspace As CodeNamespace
Dim ce As CodeElement
Dim cn As CodeNamespace
Dim cc As CodeClass
Dim elements As CodeElements
If (TypeOf ct Is CodeNamespace) Then
    cn = CType(ct, CodeNamespace)
    elements = cn.Members
Else
    cc = CType(ct, CodeClass)
    elements = cc.Members
End If
Try
    For Each ce In elements
        If (TypeOf ce Is CodeNamespace) Or (TypeOf ce Is CodeClass) Then
            GetClass(ce, list)
        End If
        If (TypeOf ce Is CodeFunction) Then
            list.Add(ce)
        End If
    Next
Catch
End Try
End Sub 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-05-15T20:47:40.847

这是一种方法（我警告你这是hacky）：

```
EnvDTE.TextSelection textSelection = (EnvDTE.TextSelection)dte.ActiveWindow.Selection;
// I'm sure there's a better way to get the line count than this...
var lines = File.ReadAllLines(dte.ActiveDocument.FullName).Length;
var methods = new List<CodeElement>();
var oldLine = textSelection.AnchorPoint.Line;
var oldLineOffset = textSelection.AnchorPoint.LineCharOffset;
EnvDTE.CodeElement codeElement = null;
for (var i = 0; i < lines; i++)
{
    try
    {
        textSelection.MoveToLineAndOffset(i, 1);
        // I'm sure there's a better way to get a code element by point than this...
        codeElement =  textSelection.ActivePoint.CodeElement[vsCMElement.vsCMElementFunction];
        if (codeElement != null)
        {
            if (!methods.Contains(codeElement))
            {
                methods.Add(codeElement);
            }
        }
    }
    catch
    {
        //MessageBox.Show("Add error handling here.");
    }
}

// Restore cursor position
textSelection.MoveToLineAndOffset(oldLine, oldLineOffset);

// This could be in the for-loop above, but it's here instead just for
// clarity of the two separate jobs; find all methods, then add the
// breakpoints
foreach (var method in methods)
{
    dte.Debugger.Breakpoints.Add(
        Line: method.StartPoint.Line,
        File: dte.ActiveDocument.FullName);
} 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-10-02T03:59:37.593

把它放在文件的顶部：

```
#define WANT_BREAK_IN_EVERY_FUNCTION

#ifdef WANT_BREAK_IN_EVERY_FUNCTION
#define DEBUG_BREAK DebugBreak();
#else
#define DEBUG_BREAK 
#endif 
```

然后在每个函数的开头插入 DEBUG_BREAK，如下所示：

```
void function1()
{
    DEBUG_BREAK
    // the rest of the function
}

void function2()
{
    DEBUG_BREAK
    // the rest of the function
} 
```

当您不再需要调试中断时，请注释该行

```
// #define WANT_BREAK_IN_EVERY_FUNCTION 
```

在文件的顶部。

# oop - 依赖注入是否违反了得墨忒耳定律

> ID：160032
> 
> 赞同：16
> 
> 时间：2008-10-01T22:22:10.197
> 
> 标签：oop

我一直在向我的代码中添加依赖注入，因为它使代码更容易通过模拟进行单元测试。

但是，我需要调用链上层的对象来了解调用链下层的对象。

这是否违反了得墨忒耳法则？如果是这样有关系吗？

例如：一个类 A 依赖于一个接口 B，要使用的这个接口的实现被注入到类 A 的构造函数中。任何想要使用类 A 的人现在还必须有一个对 B 实现的引用。并且可以直接调用其方法的含义并了解其子组件（接口 B）

维基百科谈到得墨忒耳定律：“基本概念是给定对象应尽可能少地假设其他任何事物（包括其子组件）的结构或属性。”

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-01T22:34:26.500

依赖注入可以打破得墨忒耳定律。如果您强制消费者进行依赖项的注入。这可以通过静态工厂方法和 DI 框架来避免。

您可以通过以需要传入依赖项的方式设计您的对象，同时拥有一种无需显式执行注入（工厂函数和 DI 框架）即可使用它们的机制。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-01T22:28:27.403

它是如何破坏它的？DI 完全符合最少知识的概念。DI 为您提供低耦合 - 对象彼此之间的被告较少。

引用维基百科：

> ...对象 A 可以请求对象实例 B 的服务（调用方法），但对象 A 不能“通过”对象 B 访问另一个对象...

通常 DI 的工作方式完全相同，即您使用注入组件提供的服务。如果您的对象尝试访问 B 的一些依赖项，即它对 B 了解很多 - 这会导致高耦合并打破 DI 的想法

> 但是，我需要调用链上层的对象来了解调用链下层的对象

举个例子？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-01T22:31:45.243

如果我理解正确，这不是由使用依赖注入引起的，而是由使用模拟策略引起的，这些策略让您指定您期望方法进行的函数调用。这在许多情况下是完全可以接受的，但显然这意味着你必须了​​解你正在调用的方法，如果你已经指定了你认为它应该做什么。

编写好的软件需要权衡取舍。随着实现变得更加完整，它变得更加不一致。你必须决定这些不一致会带来什么风险，以及它们是否值得他们的存在所创造的价值。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-01T22:27:54.440

**是否触犯法律？**
严格来说，我认为确实如此。
**有关系吗？**
违反法律的主要危险是你让你的代码更脆弱。
如果你真的只做测试，那危险似乎还不算太严重。
**缓解**
我对得[墨忒耳法则的](http://en.wikipedia.org/wiki/Law_of_Demeter)理解是，它可以遵循“包装器方法”，防止直接调用对象。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-01T22:47:10.900

得墨忒耳法则规定对象 O 的方法 M 可以调用在 M 内部创建/实例化的对象的方法。但是，没有任何内容指定这些对象是如何创建的。我认为使用中间对象来创建这些对象是完全可以的，只要该对象在生活中的目的仅仅是——代表您创建其他对象。从这个意义上说，DI 并没有违反得墨忒耳法则。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-05-20T10:32:07.477

这也让我困惑了一段时间。在[维基](https://en.wikipedia.org/wiki/Law_of_Demeter)上它还说......

> 对象 A 可以请求对象实例 B 的服务（调用方法），但对象 A 不应“通过”对象 B 访问另一个对象 C 来请求其服务。这样做意味着对象 A 隐含地需要对对象 B 的内部结构有更多的了解。

而这正是问题的症结所在。当您与 A 类交互时，您不应该与接口 B 的状态或方法进行交互。您根本不应该访问它的内部工作。

至于创建类A和创建对象时知道接口B；那是完全不同的情况，这不是得墨忒耳法则在软件设计中试图解决的问题。

我同意该工厂中的其他答案，并且最好使用依赖注入框架来处理这个问题。希望能为其他对此感到困惑的人清除它:)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-26T01:37:15.257

依靠 ：-）

我认为最佳答案是不正确的，即使使用框架很多代码也使用依赖注入并注入高级对象。然后，您将获得具有大量依赖项的意大利面条式代码。

依赖注入最适用于所有会污染您的对象模型的东西，例如 ILogger。如果您确实注入了业务对象，请确保其处于尽可能低的级别，并尽可能将其传递给传统方法。只有在变得混乱时才使用依赖注入。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-06-20T14:34:27.583

在我添加我的答案之前，我必须对其进行限定。面向服务的编程建立在 OOP 原则之上并使用 OO 语言。此外，SOA 严格遵循控制反转和 SOLID 原则。所以很多面向服务的程序员肯定会来到这里。所以，这个答案是为解决这个问题的面向服务的程序员准备的，因为 SOA 是建立在 OOP 之上的。这并没有直接回答 OP 的示例，而是从 SOA 的角度回答了这个问题。

一般来说，得墨忒耳定律不适用于面向服务的架构。对于面向对象，得墨忒耳定律是指面向对象编程中的“富对象”，它具有属性和方法，其属性也可能具有方法。使用 OOP Rich Models，可以通过一系列对象和访问方法、属性、属性的方法、属性的方法等来达到。但是在面向服务的编程中，数据（属性）与过程（方法）是分开的。 ）。您的模型（主要）只有属性（当然从不依赖），而您的服务只有方法和对其他服务的依赖。

在 SOP 中，您可以随意查看模型的属性及其属性。您将永远无法访问不应访问的方法，只能访问数据树。但是服务呢？得墨忒耳法则在那里适用吗？

是的，德米特法则*可以*应用于 SOP 服务。但同样，该法则最初是为 OOP 中的 Rich Models 设计的。尽管该法则*可以*应用于服务，但适当的依赖注入自动地满足了得墨忒耳法则。从这个意义上说，DI不可能违法。

在有限的反对 Mark Roddy 的情况下，我找不到任何可以合法地在同一句话中谈论依赖注入和“消费者”的情况。如果“消费者”是指一个正在消费另一个类的类，那是没有意义的。使用 DI，您将拥有一个组合根来组成您的对象图，并且一个类永远不应该知道另一个类甚至存在。如果“消费者”是指程序员，那么他们如何**不**被迫“进行注入”。程序员是必须创建组合根的人，因此他们必须进行注入。程序员永远不应该“进行注入”作为一个类中的实例来使用另一个类。

请查看以下示例，该示例显示了实际的单独解决方案、它们的参考和实现代码：

[![在 SOA 中，DI 不允许破坏 LoD](https://i.stack.imgur.com/OhZAL.png)](https://i.stack.imgur.com/OhZAL.png)

在右上角，我们有“核心”。NuGet 和 NPM 上的许多包都有一个“核心”项目，其中包含模型、接口，甚至可能是默认实现。核心永远不应该依赖任何外部的东西。

在左上角，我们有一个核心的外部实现。实现依赖于核心，因此对它有了解。

在左下角，我们有一个独立的域。域对核心的某些实现有依赖关系，但**不需要了解实现**。

这就是我指出域和实现都不知道彼此存在的地方。有一个 0% 的机会可以到达（或超越）另一个，因为他们甚至不知道他们的存在。域只知道有一个合约，它可以通过注入的任何东西以某种方式使用这些方法。

左下角是合成根或入口点。这也称为应用程序的“前边界”。应用程序的根知道它的所有组件，并且除了接受输入、确定调用谁、组合对象和返回输出外，只做很少的事情。换句话说，它只能告诉Domain“这里，用这个来履行你对ICalculateThings的合同，然后给我CalculateTwoThings的结果。

确实有一种方法可以将所有东西都打到同一个项目中，对服务进行具体实例化，使您的依赖项成为公共属性而不是私有字段，仍然进行依赖注入（可怕），然后让服务调用依赖项的依赖项。但这会很糟糕，好吧。你必须努力做坏事才能做到这一点。

旁注，我故意把它复杂化了。这些项目可以存在于一个解决方案中（只要架构师控制参考架构），并且可以进行更多的简化。但是图像中的分离确实表明系统对其部件的了解是多么少。只有合成根（入口点，前边界）需要了解这些部分。

结论 (TL;DR;)：在 Oldskewl OOP 中，模型是丰富的，通过查看模型模型来访问它们的方法，可以很容易地打破得墨忒耳法则。但是在 Newskewl SOP（建立在 OOP 原则和语言之上）中，数据与流程是分开的。因此，您可以随意查看模型的属性。然后，对于服务而言，依赖关系始终是私有的，除了抽象、契约、接口告诉它们的内容之外，没有人知道存在其他任何东西。

# c# - 查找使用 WCF net.tcp 发送消息所花费的时间

> ID：160040
> 
> 赞同：2
> 
> 时间：2008-10-01T22:25:53.963
> 
> 标签：c#, .net, wcf, distributed-apps

我正在编写一个支持 WCF 的分布式应用程序原型，以尝试找出在升级我现有的“通过 tcp 发送 xml 以进行通信”应用程序时遇到的任何问题。我正在使用回调合同向服务器注册客户端（ServiceHost 中的单例），到目前为止，客户端和服务器之间的所有通信都正常工作。我可以将多个客户端连接到服务器并从服务器发送所有客户端都接收到的广播。我可以阻止一个特定的客户，而其他客户仍然会接到电话。这很好。

为了继续学习和评估性能，我希望客户端记录服务器发送每条消息的时间，以及客户端接收相同消息的时间。我应该如何最好地解决这个问题？

是否有类似于 SOAP 扩展的东西，我可以在其中添加从服务器传出和传入客户端的内容？或者我是否需要为服务器在客户端调用的每个方法添加一个“timeSent”参数并记录客户端接收到的时间（糟糕！）？有没有更好的方法来实现这一点？

我使用的是 net.tcp 而不是 wsDualHttpBinding （它也可以工作，但性能较差）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-02T00:26:58.523

嗯……这很难。这里的问题是您甚至无法确保客户端和服务器计时器同步。

如果你想做的是发送一些带外数据，这样你就不需要修改你的方法，你可以使用[这里](http://microsoft.apress.com/asptodayarchive/73677/using-aspnet-soap-headers-in-web-services-for-orthogonal-interception-services-part-1)建议的方法。我觉得应该够了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-02T12:50:27.643

David 对时钟同步问题的看法是正确的。但是，在服务/客户端实现之外添加时间戳信息在 WCF 上一点也不难。

没错，它不支持 SoapExtensions，但事实上，它具有更丰富的扩展点集。在您的特定情况下，我认为添加 MessageInspector 的自定义行为可能会起作用。

实际上有两个消息检查器接口：一个用于客户端（[IClientMessageInspector](http://msdn.microsoft.com/en-us/library/system.servicemodel.dispatcher.iclientmessageinspector.aspx)），一个用于服务器（[IDispatchMessageInspector](http://msdn.microsoft.com/en-us/library/system.servicemodel.dispatcher.idispatchmessageinspector.aspx)）。

在服务端连接调度检查器的最简单方法是通过服务行为（IServiceBehavior），因为您可以将其作为自定义属性连接到您的服务实现。这是一个如何做到这一点的[简单示例。](http://winterdom.com/weblog/2006/10/19/IServiceBehaviorIDispatchMessageInspectorAndEndpoints.aspx)您也可以通过 IEndpointBehavior 将其连接起来，但您需要在设置服务主机时通过代码或通过配置来实现，这需要编写更多代码。

在客户端，您仍然使用端点行为，但通过代码引入这些行为要容易得多，因为您可以从代理客户端直接访问 ClientRuntime。

无论如何，我认为最好将时间戳之类的东西作为自定义标头添加到消息中，这样它就不会直接成为消息有效负载的一部分。

# visual-studio - 使用 Visual Studio 调试器在值更改时中断

> ID：160045
> 
> 赞同：218
> 
> 时间：2008-10-01T22:26:50.963
> 
> 标签：visual-studio, debugging, breakpoints, conditional-breakpoint

有没有办法对变量进行监视，并且只有在该值更改时才让 Visual Studio 中断？

这将使查找棘手的状态问题变得更加容易。

这可以做到吗？

断点条件仍然需要设置断点，我宁愿设置一个手表，让 Visual Studio 在状态更改时设置断点。

* * *

## 回答 #1

> 赞同：142
> 
> 时间：2008-10-01T22:36:30.443

在 Visual Studio 2005 菜单中：

*调试*->*新断点*->*新数据断点*

进入：

```
&myVariable 
```

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2008-10-01T22:45:30.017

您还可以选择在代码中显式中断：

```
// Assuming C#
if (condition)
{
    System.Diagnostics.Debugger.Break();
} 
```

来自 MSDN：

> Debugger.Break：如果没有附加调试器，则询问用户是否要附加调试器。如果是，则启动调试器。如果附加了调试器，调试器会收到用户断点事件的信号，并且调试器会暂停进程的执行，就像遇到了调试器断点一样。

不过，这只是一个后备方案。如其他评论中所述，在 Visual Studio 中设置条件断点是更好的选择。

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2016-06-16T21:31:47.253

在**Visual Studio 2015**`set`中，您可以在自动实现的属性的访问器上放置断点，当属性更新时调试器将中断

```
public bool IsUpdated
{
    get;
    set;    //set breakpoint on this line
} 
```

**更新**

或者; @AbdulRaufMujahid 在评论中指出，如果自动实现的属性在单行上，您可以将光标定位在`get;`or`set;`并点击`F9`，相应地会放置一个断点。好的！

```
public bool IsUpdated { get; set; } 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2011-03-05T20:50:44.400

想象一下，您有一个名为 A 的类，其声明如下。

```
class A  
{  
    public:  
        A();

    private:
        int m_value;
}; 
```

您希望程序在有人修改“m_value”的值时停止。

转到类定义并在 A 的构造函数中放置一个断点。

```
A::A()
{
    ... // set breakpoint here
} 
```

一旦我们停止程序：

调试 -> 新断点 -> 新数据断点 ...

地址：&(this->m_value)
字节数：4（因为 int 有 4 个字节）

现在，我们可以恢复程序了。当值更改时，调试器将停止。

您可以对继承的类或复合类执行相同的操作。

```
class B
{
   private:
       A m_a;
}; 
```

地址：&(this->m_a.m_value)

如果您不知道要检查的变量的字节数，可以使用 sizeof 运算符。

例如：

```
// to know the size of the word processor,  
// if you want to inspect a pointer.
int wordTam = sizeof (void* ); 
```

如果您查看“调用堆栈”，您可以看到更改变量值的函数。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2013-09-04T14:35:40.367

将变量更改为属性，并在 set 方法中添加断点。例子：

```
private bool m_Var = false;
protected bool var
{
    get { 
        return m_var;
    }

    set { 
        m_var = value;
    }
} 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2011-11-17T17:14:53.720

如果您使用 WPF，有一个很棒的工具：[WPF Inspector](http://wpfinspector.codeplex.com/)。
它将自身附加到 WPF 应用程序并显示具有所有属性的完整控件树，它允许您（除其他外）在任何属性更改时中断。

但遗憾的是，我没有找到任何工具可以让你对任何属性或变量做同样的事情。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2019-02-12T19:21:07.060

**2019年更新：**

现在，适用于 .Net Core 3.0 或更高版本的 Visual Studio 2019 Preview 2 正式支持此功能。当然，您可能需要考虑使用预览版 IDE 的潜在风险。我想在不久的将来这将包含在官方的 Visual Studio 中。

[https://blogs.msdn.microsoft.com/visualstudio/2019/02/12/break-when-value-changes-data-breakpoints-for-net-core-in-visual-studio-2019/](https://blogs.msdn.microsoft.com/visualstudio/2019/02/12/break-when-value-changes-data-breakpoints-for-net-core-in-visual-studio-2019/)

> 幸运的是，数据断点不再是 C++ 独有的，因为它们现在可用于 Visual Studio 2019 Preview 2 中的 .NET Core（3.0 或更高版本）！

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-10-01T22:28:18.077

我记得您使用[Visual Basic 6.0](http://en.wikipedia.org/wiki/Visual_Basic#Timeline)描述它的方式。在 Visual Studio 中，到目前为止我发现的唯一方法是指定[断点条件](http://msdn.microsoft.com/en-us/library/7sye83ce.aspx)。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-10-01T22:28:15.313

右键单击断点对我来说效果很好（尽管大多数情况下我将它用于特定变量值的条件断点。即使在涉及线程名称的表达式上中断也可以，如果您试图发现线程问题，这非常有用）。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2019-01-14T11:06:16.757

正如彼得莫滕森所写：

> 在 Visual Studio 2005 菜单中：
> 
> 调试 -> 新断点 -> 新数据断点
> 
> 输入：&myVariable

附加信息：

显然，系统必须知道要监视内存中的哪个地址。`myVariable`所以 - 为（或）的初始化设置一个正常的断点`myClass.m_Variable`- 运行系统并等待它在该断点处停止。- 现在菜单项已启用，您可以通过输入来观察变量`&myVariable`，或者通过输入来观察实例`&myClass.m_Variable`。现在地址已经很好地定义了。

抱歉，当我通过解释已经给出的解决方案做错事时。但我无法添加评论，并且对此有一些评论。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-10-01T22:38:20.640

您可以在非托管代码中使用内存观察点。不确定这些是否在托管代码中可用。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2011-05-18T06:52:40.657

您可能可以巧妙地使用[DebugBreak()](http://msdn.microsoft.com/en-us/library/ms679297%28v=vs.85%29.aspx)函数。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2015-12-01T12:39:58.220

您可以选择为变量重载 = 运算符，并可以在特定条件下将断点放在重载函数中。

# visual-studio - 有没有办法阻止 Visual Studio 在每次测试运行后修改解决方案文件？

> ID：160046
> 
> 赞同：6
> 
> 时间：2008-10-01T22:27:41.587
> 
> 标签：visual-studio

有时，当我运行单元测试时，Visual Studio 似乎~~每次都在修改我的 .sln 中的 .vsmdi 文件列表。~~这很烦人，因为我的源代码控制客户端认为即使我不想签入 .sln 文件也需要签入。有什么方法可以防止 Visual Studio 在测试运行后修改 .sln 文件？

**编辑：**发现一个讨论这个的 Microsoft Connect[问题](https://connect.microsoft.com/VisualStudio/feedback/Validation.aspx?FeedbackID=353784)，这很糟糕，因为一段时间后事情就会从那里消失，而且它是一个可怕的错误跟踪器

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-02T14:23:41.693

我不相信存在解决方案。一个很好的 Connect 案例，可以更好地记录问题和重现案例，就是[这个](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=350583)。在页面的最底部，评论者提出了一种解决方法，我在此处复制了该解决方法。我还没有真正为自己测试过这个解决方法，我想我已经麻木地放弃了这个错误引起的变化:(

从连接案例：

> 通过让开发人员 A 使用 vsdmi 文件运行测试，而开发人员 B 检查它并将单元测试添加到 vsdmi，我已经能够重现此问题。这通常会导致生成一个新的。
> 
> 对我有用的解决方法是为每个开发人员创建未签入 SCC 的单元测试活动的 vsdmi 文件，并为构建测试和自动回归创建特殊的 vsdmi。
> 
> 糟糕，但它有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-01T22:47:00.730

编辑：糟糕，对“vsmdi 文件列表”的事情感到困惑。建议不会奏效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-02T13:54:17.677

这是一个由来已久的问题......在我提交更改之前，我总是检查解决方案是否因任何原因被签出。

# sql-server - 多对多与“主要”

> ID：160051
> 
> 赞同：6
> 
> 时间：2008-10-01T22:28:49.727
> 
> 标签：sql-server, database-design

我正在开发一个需要代表计算机及其用户的数据库。每台计算机可以有多个用户，每个用户可以与多台计算机关联，所以这是一个经典的多对多关系。但是，还需要有“主要”用户的概念。我必须能够加入反对主要用户以列出所有计算机及其主要用户。我不确定在数据库中构造它的最佳方法是什么：

1）正如我目前正在做的那样：将表与布尔 IsPrimary 列链接。加入需要类似 ON (c.computer_id = l.computer_id AND l.is_primary = 1)。它有效，但感觉不对，因为将数据限制为每台计算机只有一个主要用户并不容易。

2）计算机表上直接指向用户行的字段，用户表中的所有行都代表非主用户。这更好地表示了每台计算机一个主的约束，但使获取计算机用户列表变得更加困难。

3) 计算机表上的一个字段链接到链接表中的一行。感觉很奇怪...

4) 别的？

描述这种关系的“关系”方式是什么？

编辑：@Mark Brackett：第三个选项对我来说似乎不那么奇怪了，因为你已经展示了它看起来有多好。出于某种原因，我什至没有想过使用复合外键，所以我想我必须在链接表上添加一个标识列才能使其工作。看起来很棒，谢谢！

@j04t：很酷，我很高兴我们现在就 #3 达成一致。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-01T22:51:09.657

选项 3，虽然感觉很奇怪，但最接近您想要建模的内容。你会做这样的事情：

```
User { 
   UserId 
   PRIMARY KEY (UserId) 
}

Computer { 
   ComputerId, PrimaryUserId
   PRIMARY KEY (UserId) 
   FOREIGN KEY (ComputerId, PrimaryUserId) 
      REFERENCES Computer_User (ComputerId, UserId) 
}

Computer_User { 
   ComputerId, UserId 
   PRIMARY KEY (ComputerId, UserId)
   FOREIGN KEY (ComputerId) 
      REFERENCES Computer (ComputerId)
   FOREIGN KEY (UserId) 
      REFERENCES User (UserId)
} 
```

这为您提供了 0 或 1 个主要用户（如果需要，PrimaryUserId 可以为空），必须在 Computer_User 中。编辑：如果用户只能是 1 台计算机的主要用户，则 Computer.PrimaryUserId 上的 UNIQUE CONSTRAINT 将强制执行该操作。请注意，并不要求所有用户都是某台计算机上的主要用户（这将是 1:1 关系，并要求他们在同一个表中）。

编辑：一些查询向您展示此设计的简单性

```
--All users of a computer
SELECT User.* 
FROM User 
JOIN Computer_User ON 
   User.UserId = Computer_User.UserId 
WHERE 
   Computer_User.ComputerId = @computerId

--Primary user of a computer
SELECT User.* 
FROM User 
JOIN Computer ON 
   User.UserId = Computer.PrimaryUserId
WHERE 
   Computer.ComputerId = @computerId

--All computers a user has access to
SELECT Computer.*
FROM Computer
JOIN Computer_User ON
   Computer.ComputerId = Computer_User.ComputerId
WHERE
   Computer_User.UserId = @userId

--Primary computer for a user
SELECT Computer.*
FROM Computer
WHERE
    PrimaryUserId = @userId 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-01T22:45:41.700

编辑——前 3 次我没有正确考虑它……我投票支持——（第 3 号解决方案）

用户

```
user id (pk) 
```

电脑

```
computer id (pk)
primary user id (fk -> computer users id) 
```

计算机用户

```
user id (pk) (fk -> user id)
computer id (pk) (fk -> user id) 
```

这是我能想到的最好的解决方案。

为什么我喜欢这个设计。

1）由于这是涉及计算机和用户的关系，我喜欢能够将用户作为主要用户关联到多台计算机的想法。但是，在使用此数据库的地方可能永远不会发生这种情况。

2）我不喜欢在链接表上有primary_user的原因

```
 (computer_users.primary_user_id fk-> users.user_id) 
```

是为了防止计算机拥有多个主要用户。

鉴于这些原因，3 号解决方案看起来更好，因为您永远不会遇到我在其他方法中看到的一些可能的问题。

解决方案 1 问题 - 每台计算机可能有多个主要用户。

解决方案 2 问题 - 当计算机和用户未相互链接时，计算机链接到主要用户。

```
computer.primaryUser = user.user_id
computer_users.user_id != user.user_id 
```

解决方案 3 问题 - 看起来确实有点奇怪，不是吗？除此之外我什么都想不出来。

解决方案 4 问题 - 我想不出任何其他方法。

* * *

这是第四次编辑，所以我希望它仍然有意义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-01T22:34:26.563

由于主要用户是计算机和用户的功能，因此我倾向于采用您的方法，即让 primaryUser 成为链接表上的一列。

我能想到的另一种选择是直接在计算机表本身上有一个 primaryUser 列。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-01T22:36:17.090

我会创建另一个表 PRIMARY_USERS，它具有唯一性，`computer_id`并同时创建了 USERS`computer_id`和`user_id`外键。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-01T22:39:30.153

解决方案 1 或 2 都可以。在这一点上，我会问自己哪个更容易使用。我在不同的情况下使用了这两种方法，尽管我通常会在链接表上使用一个标志，然后对 computer_id 和 isPrimaryUser 强制一个唯一约束，这样可以确保每台计算机只有一个主要用户。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-01T22:42:10.287

2 对我来说是正确的，但我会测试 1、2 和 3 在您通常执行的各种查询和您拥有的各种数据量上的性能。

作为一般经验法则，我倾向于认为，在可以选择实现的地方，您应该查看查询需求并设计架构，以便在最常见的情况下获得最佳性能和资源利用率。

在极少数情况下，你有同样常见的情况，建议相反的实现，然后使用奥卡姆剃刀。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-01T22:49:53.157

我们在我处理的应用程序中遇到了类似的情况，我们的帐户可以附加许多客户，但只有一个应该是主要客户。

我们使用链接表（如您所用），但在链接表上有一个序列值。主用户是 Sequence = 1 的用户。然后，**我们在该 Link 表上为 AccountID 和 Sequence 设置一个索引，以确保 AccountID 和 Sequence 的组合**是唯一的（从而确保没有两个客户可以成为主用户）帐户）。所以你会有：

```
LEFT JOIN c.computer_id = l.computer_id AND l.sequence = 1 
```

# documentation - 您如何决定阅读哪些 API 函数文档以及阅读的认真程度？

> ID：160077
> 
> 赞同：1
> 
> 时间：2008-10-01T22:37:11.750
> 
> 标签：documentation

假设您正在编写或维护一段代码，该代码使用了一些您不是 100% 熟悉的 API。

你如何决定是否阅读某个调用目标的文档，以及花费多少时间阅读它？你怎么决定不读它？

（假设您可以通过打开 HTML 文档、检查源代码或使用 IDE 中的悬停机制来阅读它）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-02T00:21:14.793

理想情况下，您应该阅读*所有*内容，但我们知道这很痛苦……您知道。我通常在这些情况下所做的（在我作为自由职业者工作时我做了很多）是权衡一些因素，根据结果，我阅读了文档。

告诉我不应该阅读文档的因素：

*   该函数的作用很容易从名称中猜到。
*   它与我正在维护的代码无关：例如，您正在检查某些代码如何删除文件，并且您有一些显然会更新 UI 的功能。你暂时不关心这个。
*   如果调试：该函数没有以对手头任务有意义的方式更改程序状态。和以前一样，如果您正在调试删除代码，您不想了解 SetOverlayIcon 的作用，因为它会因文件系统错误而死。
*   API 只是你已经知道的 API 的一个特例，你可以猜出这个特例是什么，以及特殊参数（如果有的话）做什么。例如，假设您有 WriteToFile(string filename) 和 WriteToFile(string filename, boolean overwrite)。

当然，一切都取决于上下文，因此即使这些规则也有例外。

# c++ - What is the big deal with BUILDING 64-bit versions of binaries?

> ID：160082
> 
> 赞同：9
> 
> 时间：2008-10-01T22:38:06.413
> 
> 标签：c++, 64-bit, vista64

There are a ton of drivers & famous applications that are not available in 64-bit. Adobe for instance does not provider a 64-bit Flash player plugin for Internet Explorer. And because of that, even though I am running 64-bit Vista, I have to run 32-bit IE. Microsoft Office, Visual Studio also don't ship in 64-bit AFAIK.

Now personally, I haven't had much problems building my applications in 64-bit. I just have to remember a few rules of thumb, e.g. always use SIZE_T instead of UINT32 for string lengths etc.

So my question is, what is preventing people from building for 64-bit?

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-01T22:54:47.467

If you are starting from scratch, 64-bit programming is not that hard. However, all the programs you mention are not new.

It's a whole lot easier to build a 64-bit application from scratch, rather than port it from an existing code base. There are many gotchas when porting, especially when you get into applications where some level of optimization has been done. Programmers use lots of little assumptions to gain speed, and these are not always easy to quickly port to 64-bit. A few examples I've had to deal with:

*   Proper alignment of elements within a struct. As data sizes change, assumptions that certain fields in a struct will be aligned on an optimal memory boundary may fail
*   Length of `long` integers change, so if you pass values over a socket to another program that may not be 64-bit, you need to refactor your code
*   Pointer lengths change, as so hard to decipher code written be a guru that has left the company become a little trickier to debug
*   Underlying libraries will also need to have 64-bit support to properly link. This is a large part of the problem of porting code if you rely on any libraries that are not open source

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-01T23:14:33.597

除了[@jvasak 的帖子](https://stackoverflow.com/questions/160082/what-is-the-big-deal-with-building-64-bit-versions-of-binaries#160139)中的内容之外，可能导致错误的主要内容：

*   指针大于整数 - 大量代码假设大小相同。

请记住，Windows 甚至不允许应用程序（无论是 32 位还是 64 位）处理地址高于 0x7FFFFFFF（2GB 或以上）的指针，除非它们被特别标记为，`"LARGE_ADDRESS_AWARE"`因为许多应用程序会将指针视为在某些时候出现负值并跌倒。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-02T00:28:53.293

我在将 C/C++ 代码移植到 64 位时遇到的最大问题是来自 3rd 方库的支持。例如，目前只有 32 位版本的 Lotus Notes API 和 MAPI，因此您甚至无法链接它们。

此外，由于您无法将 32 位 DLL 加载到 64 位进程中，因此您会再次尝试动态加载内容。我们在尝试支持 64 位下的 Microsoft Access 时再次遇到了这个问题。来自维基百科：

> 在可预见的未来，Jet 数据库引擎将保持 32 位。微软没有计划在 64 位版本的 Windows 下原生支持 Jet

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-01T22:43:38.740

Just a guess, but I would think a large part of it would be support - If Adobe compiles the 64 bit version, they have to support it. Even though it may be a simple compile switch, they'd still have to run through a lot of testing, etc, followed by training their support staff to respond correctly, when they do run into issues fixing them either results in a new version of the 32 bit binary or a branch in the code, etc. So while it seems simple, for a large application it can still end up costing a lot.

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-02T00:18:45.220

许多公司没有努力创建 64 位版本的另一个原因是他们根本不需要。

Windows 有 WoW64（Windows 上的 Windows 64 位），Linux 可以提供 32 位库和 64 位库。这两者都允许我们在 64 位环境中运行 32 位应用程序。

只要软件能够以这种方式运行，转换为 64 位的主要动力就没有了。

例外情况是设备驱动程序之类的东西，因为它们与操作系统更紧密地联系在一起，并且不能在基于 x86-64/AMD64 的 64 位操作系统提供的 32 位层中运行（IA64 无法做到这一点）我明白）。

我同意你对 Flash 播放器的看法，但我对 Adob​​e 没有更新这个产品感到非常失望。正如您所指出的，它在 64 位中无法正常工作，需要您运行 32 位版本的 Internet Explorer。

我认为这是 Adob​​e 的战略错误。必须为 flash player 运行 32 位浏览器对用户来说是一种不便，许多人不会理解这种解决方案。这可能会导致开发人员对使用闪存感到担忧。对于一个网站来说，最重要的事情是确保每个人都可以查看它，疏远用户的解决方案通常不受欢迎。Flash 的受欢迎程度是由它自己的受欢迎程度提供的，使用它的网站越多，系统上拥有它的用户就越多，系统上拥有它的用户越多，愿意使用它的网站就越多。

零售市场推动这些事情向前发展，当普通消费者购买新电脑时，他们不会知道他们不需要 64 位操作系统，他们也会购买它，因为他们听说它是最新的并且最伟大的事情，计算的未来，或者只是因为他们不知道其中的区别。

Vista 已经发布了大约 2 年，而 Windows XP 64 位在此之前就已经发布了。在我看来，如果他们想保住自己的市场，Flash 等主要技术不升级就太久了。这可能与 Adob​​e 接管 Macromedia 有关，这表明 Adob​​e 并不认为 Flash 是他们未来的一部分，我很难相信，因为我认为 Flash 和 Dreamweaver 是他们从 Macromedia 中获得的最重要的部分，但是为什么他们还没有更新呢？

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-01T22:56:51.953

It is not as simple as just flipping a switch on your compiler. At least, not if you want to do it right. The most obvious example is that you need to declare all your pointers using 64-bit datatypes. If you have any code which makes assumptions about the size of these pointers (e.g. a datatype which allocates 4 bytes of memory per pointer), you'll need to change it. All this needs to have been done in any libraries you use, too. Further, if you miss just a few then you'll end up with pointers being down-casted and at the wrong location. Pointers are not the only sticky point but are certainly the most obvious.

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-01T22:54:42.223

Primarily a support and QA issue. The engineering work to build for 64-bit is fairly trivial for most code, but the testing effort, and the support cost, don't scale down the same way.

On the testing side, you'll still have to run all the same tests, even though you "know" they should pass.

For a lot of applications, converting to a 64-bit memory model doesn't actually give any benefit (since they never need more than a few GB of RAM), and can actually make things slower, due to the larger pointer size (makes every object field twice as large).

Add to that the lack of demand (due to the chicken/egg problem), and you can see why it wouldn't be worth it for most developers.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-01T22:53:21.400

Their [Linux/Flash blog](http://blogs.adobe.com/penguin.swf/2006/10/whats_so_difficult_64bit_editi.html) goes some way to explain why there isn't a 64bit Flash Player as yet. Some is Linux-specific, some is not.

# .net - <%# %> 和 <%= %> 有什么区别？

> ID：160097
> 
> 赞同：11
> 
> 时间：2008-10-01T22:41:32.957
> 
> 标签：.net, asp.net

请原谅我对 ASP 的无知，但有什么区别？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-10-01T22:48:09.087

这些在某种程度上被非正式地称为“蜜蜂蜇伤”。有4种类型：

`<%# %>`在 DataBinding 阶段调用。

`<%= %>`用于从代码获取值到 UI 层。旨在向后兼容 ASP 应用程序。不应该在 .NET 中使用。

`<%@ %>`表示[指令](http://msdn.microsoft.com/en-us/library/t8syafc7.aspx "指令")并允许在不借助代码的情况下设置行为。

`<%: %>`（在 ASP.NET 4 中引入）与 相同`%=`，但添加了 HtmlEncoding 输出功能。目的是将此作为默认用法（over `%=`）以帮助屏蔽脚本注入攻击。

> 指令指定页面和用户控件编译器在编译器处理 ASP.NET Web 窗体页面（.aspx 文件）和用户控件 (.ascx) 文件时使用的设置。
> 
> ASP.NET 将任何不包含显式指令名称的指令块 (<%@ %>) 视为@Page 指令（用于页面）或@Control 指令（用于用户控件）。

@Esteban - 添加了一个指向指令的 msdn 链接。如果您需要...更多解释，请告诉我。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-01T22:47:03.193

请参阅[http://weblogs.asp.net/leftslipper/archive/2007/06/29/how-asp-net-databinding-deals-with-eval-and-bind-statements.aspx](http://weblogs.asp.net/leftslipper/archive/2007/06/29/how-asp-net-databinding-deals-with-eval-and-bind-statements.aspx)

正如 Albert 所说，这一切都与解析数据绑定语句有关。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-01T22:46:21.557

# 版本在数据绑定时使用。<%= 只是一个简单的 Response.Write

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-01T23:21:06.093

与问题不完全相关，asp.net 中有另一个相关的符号，称为 Expression Builder：

```
<asp:SqlDataSource ... Runat="server"
 ConnectionString="<%$ ConnectionStrings:Northwind %>"
/>

<asp:Literal Runat="server"
  Text="<%$ Resources:MyResources, MyText %>"
/> 
```

它是可扩展的，请参阅[http://msdn.microsoft.com/en-us/magazine/cc163849.aspx#S4](http://msdn.microsoft.com/en-us/magazine/cc163849.aspx#S4)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-04T16:13:32.347

.aspx 中使用母版页的 javascript。

```
var e = document.getElementById('<%= lblDescription.ClientID %>');
e.innerHTML = 'getElementById(\'lblDescription\') will be null'; 
```

# svn - How do you add all untracked files in svn? Something like git add -i?

> ID：160104
> 
> 赞同：12
> 
> 时间：2008-10-01T22:44:55.367
> 
> 标签：svn, version-control

I've been using this long command:

```
svn st | awk '/\?/ {print $2}' | xargs svn add 
```

Similarly, to svn rm files I accidentally deleted with normal rm with :

```
svn st | awk '/\!/ {print $2}' | xargs svn rm --force 
```

I guess I can write a bash function to do these two, but I'd prefer an interactive add/rm like the one git has.

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-09-09T20:11:39.567

这会在当前目录中添加所有 svn-untracked 和 -unversioned 文件，递归遍历所有子目录：

```
svn add --force ./* 
```

在 MacOS 10.6+ 和 Ubuntu 10+ 中为我工作，带有 svn 1.6+。这不提供任何每个文件的用户交互性；我不知道该怎么做。

这也将添加 svn-ignored 文件，无论好坏。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-10-04T02:04:49.383

有一条更简单的线...

```
svn add `svn status | grep ?` 
```

然后您可以将其设置为 ~/.bashrc 中的别名，例如

```
alias svn-addi='svn add `svn status | grep ?`' 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-01T23:08:12.817

我使用您运行的命令行的概括，称为`svnapply.sh`. 我没有写它，但我不记得我在哪里找到它。希望原作者能原谅我在这里转贴：

```
#!/bin/bash
#
# Applies arbitrary commands to any svn status. e.g.
#
# Delete all non-svn files (escape the ? from the shell):
# svnapply \? rm
#
# List all conflicted files:
# svnapply C ls -l

APPLY=$1
shift

svn st | egrep "^\\${APPLY}[ ]+" | \
sed -e "s|^\\${APPLY}[ ]*||" | \
sed -e "s|\\\\|/|g" | \
xargs -i "$@" '{}' 
```

根据评论，该脚本允许您对具有相同状态的所有文件运行任意命令。

更新：

编写一个将文件路径作为参数并提示用户添加/删除然后为该文件执行适当操作的脚本并不难。将它与上面的脚本链接起来可以得到你想要的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-01-05T14:15:59.737

有一个[类似的问题](https://stackoverflow.com/questions/1068506/svn-add-interactive)，其中包含一个[不错的 Ruby 脚本](https://stackoverflow.com/questions/1068506/svn-add-interactive/1321101#1321101)，可以让您选择添加、忽略或跳过新文件。我已经尝试过了，它对我有用。不需要 GUI，只需要 Ruby。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-02T14:08:09.190

TortoiseSVN 可以选择在 Commit 和 Show Changes 对话框中显示未版本控制的文件。您可以右键单击文件以“添加”它或将其标记为已忽略。

如果您使用的是 Visual Studio：AnkhSVN 的最新稳定版本有一个类似的命令，但在大多数情况下它只显示您应该添加的文件。（该项目向 SCC 提供程序提供要版本的文件列表；其他文件将被自动忽略）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-01T23:14:30.833

使用可以显示所有未跟踪文件的 GUI，然后全选并添加。任何体面的 SVN gui 都应该提供这个功能。

也就是说，要小心你真的想要所有这些文件。

# visual-studio - 如何在 mfc 中将控件置于最前面

> ID：160105
> 
> 赞同：17
> 
> 时间：2008-10-01T22:45:17.380
> 
> 标签：visual-studio, visual-c++, mfc

如何**在设计时**在 MFC 中更改控件的 Z 顺序- 即我不能使用 SetWindowPos 或在运行时执行此操作 - 我想在设计器中查看更改后的 z 顺序（即使我不得不求助于直接 -编辑 .rc 代码）。

我有一个要向其中添加控件的 MFC 对话框。如果控件的边缘之间有重叠，我想将一个放在另一个的前面。在 Windows 窗体或 WPF 等中。我可以放在前面、放在后面、放在前面、放在后面。我在 MFC 中找不到这些选项，也无法确定它如何确定前面的内容，因为刚刚添加的控件通常位于之前存在的控件后面。如何在 MFC 中操作 Z 顺序？即使我必须直接操作 .rc 文件代码（即最终围绕设计器运行）。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-10-01T23:08:04.767

我认为前面的控件将是 rc 文件中出现的最后一个控件。换句话说，对话框编辑器将在 rc 文件中从上到下绘制每个控件，并在必要时将它们重叠。

您可以编辑 rc 文件以重新排序它们，或者您可以在编辑器中更改 Tab 键顺序，这样做的效果相同，因为 Tab 键顺序也是根据控件在文件中出现的顺序设置的。据我所知，MFC 在设计时没有提供任何其他方式来分层重叠控件。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-04-22T05:39:20.697

**在 Visual Studio 6.0 中执行以下操作。**

打开对话框屏幕（在设计器视图中）

按 Ctrl + D

将为每个控件显示选项卡顺序

以您希望在运行时看到的 Tab 键顺序开始单击控件（即，您首先单击的控件将 Tab 键顺序设置为 1，依此类推...）

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-10-01T22:49:02.503

```
GetDlgItem(IDC_MYCONTROL)->SetWindowPos(HWND_TOP,
                                        0, 0, 0, 0,
                                        SWP_NOMOVE | SWP_NOSIZE); 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-10-01T22:54:47.777

实际上，如果您想在资源编辑器中执行此操作，您可以剪切该项目，然后将其粘贴回去，这是一种快速而肮脏的解决方案。只需 Ctrl-X 然后 Ctrl-V。

编辑 RC 文件也可以。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-01T22:49:08.773

您可以使用[CWnd::SetWindowPos()](http://msdn.microsoft.com/en-us/library/a1yzfz6d(VS.80).aspx)来控制控件的 Z 顺序，而无需更改它们在父窗口中的位置。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-02T04:25:14.783

在**MSVC 2005**对话框资源编辑器中，有一个设置选项卡顺序的选项。在**MSVC 2005**中，它位于“**格式”、“标签顺序”**菜单中。

此菜单选项显示的选项卡顺序与将控件写入资源文件的顺序相同。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-03-05T01:07:39.503

```
GetDlgItem(IDC_CONTROL1)->SetWindowPos(&wndTop, 0, 0, 0, 0, SWP_NOMOVE | SWP_NOSIZE) 
```

# delphi - How to implement find as you type on a TComboBox descendant

> ID：160106
> 
> 赞同：7
> 
> 时间：2008-10-01T22:45:22.340
> 
> 标签：delphi, user-interface, vcl, custom-component

What is the correct way to implement the "find as you type" behavior on a TComboBox descendant component whose style is csOwnerDrawFixed?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-02T06:11:04.873

1.  使用 TTimer（我们称之为 timIncSearch）。设置（在设计时）以下属性： Enabled:=False;
    间隔：=400；//凭经验发现-这是Windows资源管理器中使用的延迟

...在 OnTimer 中，您将编写您的搜索引擎。确保这里的第一行是 timIncSearch.Enabled:=False; 也因为您使用 csOwnerDrawFixed 可能最好强制重绘您的控件。

顺便说一句，只是猜测，因为你没有给我们很多细节——也许你必须挂钩 OnEnter 和 OnExit 事件来自定义打开和关闭 DropDown 列表。（通常，这是通过相应地设置 AutoDropDown 属性来实现的）

2.  在你的 ComboBox.KeyPress 你会写

`with timIncSearch do
begin
Enabled:=False;
Enabled:=True;
end;`

...在这里也要小心，也许您必须有一个“case Key of”构造来单独处理＃13（或其他）。

其他提示：

*   根据您的情况，也许您必须挂钩（也是？） OnKeyDown （如果您想处理特殊键，例如 BackSpace、Del、Arrows 等 -*考虑*到事件在按下键时会重复）和/ 或 OnKeyUp（如果您想进行与上述类似的处理，但*不*考虑键盘的按键自动重复功能）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-01-26T15:30:59.203

首先，您需要决定是否需要“*my_string*”或“my_string*”功能，这意味着决定是在字符串内搜索还是从头开始搜索。当您弄清楚这一点后，您将不得不构建组合框中输入的所有单词的索引，并在每次击键后进行搜索。我不认为处理 OnTimer 是正确的方法。我宁愿使用“OnChange”或类似的。您可以使用 sorted (dupignore) TStringList 来完成，或者可以使用哈希表构建索引（实现取决于您）。架构取决于您的组合可以包含的最大字符串数。如果它是一个比你可以使用哈希表的重要数字（一个哈希基数指向多个索引：数组，TList ...）

# c# - 同名的静态和实例方法？

> ID：160118
> 
> 赞同：64
> 
> 时间：2008-10-01T22:48:45.250
> 
> 标签：c#, .net, oop

我在 C# 中有一个具有静态和非静态接口的类。是否可以在具有相同名称和签名的类中具有静态和非静态方法？

当我尝试执行此操作时出现编译器错误，但出于某种原因，我认为有一种方法可以执行此操作。我错了还是没有办法在同一个类中同时拥有静态和非静态方法？

如果这是不可能的，有没有一种很好的方法来实现这样的东西，可以通用地应用于任何情况？

**编辑**
从我收到的回复来看，很明显没有办法做到这一点。我将使用不同的命名系统来解决这个问题。

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2008-10-01T22:55:52.813

不，你不能。限制的原因是静态方法也可以从非静态上下文中调用，而无需预先添加类名（因此使用 MyStaticMethod() 而不是 MyClass.MyStaticMethod()）。如果两者都有，编译器无法判断您要查找的内容。

您可以拥有具有相同名称的静态和非静态方法，但不同的参数遵循与方法重载相同的规则，它们只是不能具有完全相同的签名。

* * *

## 回答 #2

> 赞同：60
> 
> 时间：2012-02-20T17:50:21.760

实际上，有一种方法可以通过显式实现接口来实现这一点。这不是一个完美的解决方案，但它可以在某些情况下工作。

```
interface IFoo
{
    void Bar();
}

class Foo : IFoo
{
    static void Bar()
    {
    }

    void IFoo.Bar()
    {
        Bar();
    }
} 
```

当我为 P/Invoke 调用创建包装类时，有时会遇到这种情况。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-10-01T22:52:27.597

您可以从实例方法调用静态方法，而无需指定类型名称：

```
class Foo
{
    static void Bar()
    {
    }

    void Fizz()
    {
        Bar();
    }
} 
```

...因此，不允许您拥有具有相同签名的静态方法和实例方法是有道理的。

你想达到什么目的？在不了解具体情况的情况下很难提出解决方法。我只是重命名其中一种方法。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2017-04-29T15:26:40.943

C# 在这方面设计得不好......

虽然您确实可能想要全局或非全局，但它应该默认选择一个，如果您想要另一个，那么您只需对其进行更多限定。

```
class Logger {
   public static Logger instance;

   public static void Log(string message) {
       instance.Log(message); // currently the compiler thinks this is ambiguous, but really its not at all.  Clearly we want the non-static method
   }

   public void Log(string message) {

   }

   public void DoStuff() {
      Log("doing instance stuff"); // this could be ambiguous, but in my opinion it should default to a call to this.Log()
      Logger.Log("doing global stuff"); // if you want the global qualify it explicitly
   }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-06-05T23:47:41.700

好的。这个问题的根源在于，C# 不应该让您在不指定类型名称的情况下从实例方法调用静态方法。

其他完整的 OO 语言（如 Smalltalk）不允许这样做，而且它只会让理解对象的人感到困惑。实例端和类（或静态）端之间的分离非常重要，并且使用一种会在这些细节上引起混淆的语言......不是一个好主意......但是我们期望的典型类型来自女士。

阿德里安

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-01T22:52:29.170

你可以拥有同名的静态方法和实例方法，只要它们的声明在参数的数量或类型上不同。关于如何在一个类中拥有两个具有相同名称的实例方法的规则相同。

尽管从技术上讲，在静态方法与实例方法的情况下，它们已经因实例方法中隐式 this 参数的存在而有所不同，但这种差异不足以让编译器确定您要调用两者中的哪一个。

**更新**：我犯了一个错误。返回值不足以具有不同的签名。

# sql-server - 表分区的 SQL 拆分/合并：实现的最佳方法是什么？

> ID：160128
> 
> 赞同：0
> 
> 时间：2008-10-01T22:51:00.640
> 
> 标签：sql-server, partitioning

Microsoft 在其关于更改 SQL 2005 分区的 MSDN[条目](http://msdn.microsoft.com/en-us/library/ms186307(SQL.90).aspx)中列出了一些可能的方法：

*   使用所需的分区函数创建一个新的分区表，然后使用 INSERT INTO...SELECT FROM 语句将旧表中的数据插入到新表中。
*   在堆上创建分区聚集索引
*   使用带有 DROP EXISTING = ON 子句的 Transact-SQL CREATE INDEX 语句删除并重建现有分区索引。
*   执行一系列 ALTER PARTITION FUNCTION 语句。

任何想法对于具有基于记录日期的分区（例如每月分区）的大型数据库（数百万条记录）来说，最有效的方法是什么，其中数据分布在 1-2 年内？

另外，如果我主要访问（用于阅读）最近的信息，那么在最后 X 天保留一个分区是否有意义，而所有其余数据将是另一个分区？还是对其余数据也进行分区更好（对于基于日期范围的任何随机访问）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-19T17:12:12.733

我推荐第一种方法——创建一个新的分区表并插入其中——因为它让你可以比较新旧表。您可以针对这两种样式的表测试查询计划，并在切换到新表设计之前查看您的查询是否确实更快。您可能会发现没有任何改进，或者您可能想在确定最终结果之前尝试几种不同的分区功能/方案。您可能希望对日期范围以外的内容进行分区 - 日期并不总是有效的。

我已经对 300-500m 行表进行了分区，这些表的数据分布在 6-7 年之间，而表插入方法是我发现最有用的方法。

您询问了如何分区 - 最好的答案是尝试设计您的分区，以便您的查询将命中单个分区。如果您倾向于将查询集中在最近的数据上，并且如果您在 where 子句中过滤该日期字段，那么是的，对于最近 X 天有一个单独的分区。

请注意，您必须在 where 子句中指定分区字段。如果您没有指定该字段，则查询可能会访问每个分区以获取数据，此时您将不会获得任何性能提升。

希望有帮助！我已经做了很多分区，如果您想发布一些表结构和查询的示例，这将帮助您为您的环境获得更好的答案。

# c# - Divide by zero error, how do I fix this?

> ID：160141
> 
> 赞同：11
> 
> 时间：2008-10-01T22:55:02.753
> 
> 标签：c#, divide-by-zero

C# novice here, when the int 'max' below is 0 I get a divide by zero error, I can see why this happens but how should I handle this when max is 0? position is also an int.

```
 private void SetProgressBar(string text, int position, int max)
    {
        try
        {
            int percent = (100 * position) / max; //when max is 0 bug hits
            string txt = text + String.Format(". {0}%", percent);
            SetStatus(txt);
        }
        catch
        {
        }
    } 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-01T22:57:08.363

```
int percent = 0
if (max != 0) percent = (100*position) / max 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-01T22:57:30.393

Well, that entirely depends on the behaviour you want. If the maximum value of your program bar is zero, is it full? Is it empty? This is a design choice, and when you've chosen, just test for max == 0 and deploy your answer.

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-10-01T22:57:53.060

*   You can throw an exception.
*   You can do `int percent = ( max > 0 ) ? (100 * position) / max : 0;`
*   You can choose to do nothing instead of assigning a value to percent.
*   many, many other things...

Depends on what you want.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-01T22:57:25.837

Check for zero.

```
if ( max == 0 ) {
    txt = "0%";
} else {
    // Do the other stuff.... 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-01T22:58:29.047

This is not a C# problem, it's a math problem. Division by zero is undefined. Have an if statement that checks whether max > 0 and only execute your division then.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-01T23:00:53.270

Convert your

```
int percent = (100 * position) / max; 
```

into

```
int percent;
if (max != 0)
    percent = (100 * position) / max;
else
    percent = 100; // or whatever fits your needs 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-01T22:59:15.893

Well, if max is zero, then there is no progress to be made. Try catching the exception where this is called. That is probably the place to decide whether there is a problem or if the progress bar should be set at zero or at 100%.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-01T22:59:35.363

I guess the root question is: Does it make sense to even call this function where max is '0'? If yes, then I'd add special handling to it i.e.:

```
if (max == 0) 
{
    //do special handling here
}
else
{
    //do normal code here
} 
```

If 0 doesn't make sense, I'd investigate where it's coming from.

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-01T22:59:43.163

You would need a guard clause which checks for max == 0\.

```
private void SetProgressBar(string text, int position, int max)
{
    if(max == 0)
        return;
    int percent = (100 * position) / max; //when max is 0 bug hits
    string txt = text + String.Format(". {0}%", percent);
    SetStatus(txt);
} 
```

You could also handle the Divide by Zero exception, as your sample showed, but it is generally more costly to handle exceptions then to set up checks for known bad values.

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-01T23:00:25.407

If you are using this for a download, you'll probably want to show 0% as I assume max would == 0 in this case when you don't KNOW the file size yet.

```
int percent = 0;
if (max != 0)
    ...; 
```

If you are using this for some other long task, I'd want to assume 100%

But also, since position can never be between 0 and -1, so you'll probably want to drop the 100 *

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-03-10T01:37:25.773

您可以使用三元运算符。

```
int percent = max != 0 ? (100 * position) / max : 0; 
```

这意味着当 max 不等于 0 时，要执行计算。如果它等于 0，那么它将百分比设置为 0。

# javascript - Find X/Y of an HTML element with JavaScript

> ID：160144
> 
> 赞同：40
> 
> 时间：2008-10-01T22:55:54.453
> 
> 标签：javascript, html

How can I find the XY coordinates of an HTML element (DIV) from JavaScript if they were not explicitly set?

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2008-10-02T00:51:47.810

这是我的做法：

```
// Based on: http://www.quirksmode.org/js/findpos.html
var getCumulativeOffset = function (obj) {
    var left, top;
    left = top = 0;
    if (obj.offsetParent) {
        do {
            left += obj.offsetLeft;
            top  += obj.offsetTop;
        } while (obj = obj.offsetParent);
    }
    return {
        x : left,
        y : top
    };
}; 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-01T22:58:44.757

That can be tricky depending on browser and version. I would suggest using [jQuery](http://jquery.com) and the positions plugin.

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-01T23:14:16.467

您可以使用 Prototype 或 jQuery 等库，也可以使用[这个方便的函数](http://www.quirksmode.org/js/findpos.html)：

它返回一个数组。

```
myPos = findPos(document.getElementById('something'))
x = myPos[0]
y = myPos[1]

function findPos(obj) {
  var curleft = curtop = 0;
  if (obj.offsetParent) {
    curleft = obj.offsetLeft
    curtop = obj.offsetTop
    while (obj = obj.offsetParent) {
      curleft += obj.offsetLeft
      curtop += obj.offsetTop
    }
  }
  return [curleft,curtop];
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-02-15T13:38:31.620

对于它的价值，这是一个递归版本：

```
function findPos(element) {
  if (element) {
    var parentPos = findPos(element.offsetParent);
    return [
      parentPos.X + element.offsetLeft,
      parentPos.Y + element.offsetTop
    ];
  } else {
    return [0,0];
  }
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-01-14T08:56:17.473

您可以向 中添加两个属性以`Element.prototype`获取任何元素的顶部/左侧。

```
window.Object.defineProperty( Element.prototype, 'documentOffsetTop', {
    get: function () { return this.offsetTop + ( this.offsetParent ? this.offsetParent.documentOffsetTop : 0 ); }
} );

window.Object.defineProperty( Element.prototype, 'documentOffsetLeft', {
    get: function () { return this.offsetLeft + ( this.offsetParent ? this.offsetParent.documentOffsetLeft : 0 ); }
} ); 
```

`offset().top`这是一个将结果与 jQuery进行比较的演示：http `.left`: [//jsfiddle.net/ThinkingStiff/3G7EZ/](http://jsfiddle.net/ThinkingStiff/3G7EZ/)

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-10-01T23:08:57.713

我不确定你需要它做什么，而且这些东西总是相对的（屏幕、窗口、文档）。但是当我需要弄清楚这一点时，我发现这个网站很有帮助： http: [//www.mattkruse.com/javascript/anchorposition/source.html](http://www.mattkruse.com/javascript/anchorposition/source.html)

而且我还发现有人为 jQuery 制作的工具提示插件对 x,y 定位技巧有各种有趣的见解（查看它的视口类和 jQuery 为其提供的底层支持）。 [http://bassistance.de/jquery-plugins/jquery-plugin-tooltip/](http://bassistance.de/jquery-plugins/jquery-plugin-tooltip/)

# c++ - 从构造函数的初始化列表中捕获异常

> ID：160147
> 
> 赞同：61
> 
> 时间：2008-10-01T22:57:13.373
> 
> 标签：c++, exception

这是一个好奇的。我有一个 A 类。它有一个 B 类项，我想在 A 的构造函数中使用初始化列表对其进行初始化，如下所示：

```
class A {
    public:
    A(const B& b): mB(b) { };

    private:
    B mB;
}; 
```

有没有办法在仍然使用初始化列表方法的同时捕获 mB 的复制构造函数可能抛出的异常？或者我是否必须在构造函数的大括号中初始化 mB 才能进行 try/catch？

* * *

## 回答 #1

> 赞同：107
> 
> 时间：2008-10-01T23:03:23.577

阅读[http://weseetips.wordpress.com/tag/exception-from-constructor-initializer-list/](http://weseetips.wordpress.com/tag/exception-from-constructor-initializer-list/)）

编辑：经过更多挖掘，这些被称为“功能尝试块”。

我承认在我去寻找之前我也不知道这一点。你每天都能学到一些东西！我不知道这是否是对我这些天很少使用 C++、我缺乏 C++ 知识或经常在语言中乱扔垃圾的拜占庭特性的控诉。嗯，我还是喜欢它:)

为了确保人们不必跳转到另一个站点，构造函数的函数 try 块的语法原来是：

```
C::C()
try : init1(), ..., initn()
{
  // Constructor
}
catch(...)
{
  // Handle exception
} 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-10-01T23:05:04.117

它不是特别漂亮：

```
A::A(const B& b) try : mB(b) 
{ 
    // constructor stuff
}
catch (/* exception type */) 
{
    // handle the exception
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-07-13T08:46:50.290

我知道自从这个讨论开始以来已经有一段时间了。但是 Adam 提到的 try-and-catch 结构是 C++ 标准的一部分，并且受到 Microsoft VC++ 和 GNU C++ 的支持。这是有效的程序。顺便说一句，catch 会自动生成另一个异常来表示构造函数失败。

```
#include <iostream>
#include <exception>
#include <string>

using namespace std;

class my_exception: public exception
{
  string message;
public:
  my_exception(const char* message1)
  {
    message = message1;
  }

  virtual const char* what() const throw()
  {
     cout << message << endl;
     return message.c_str();
  }

  virtual ~my_exception() throw() {};
};

class E
{
public:
    E(const char* message) { throw my_exception(message);}
};

class A
{
    E p;
public:
    A()
  try :p("E failure")
    {
            cout << "A constructor" << endl;
    }
  catch (const exception& ex)
    {
        cout << "Inside A. Constructor failure: " << ex.what() << endl;
    }
};

int main()
{
    try
    {
        A z;
    }
    catch (const exception& ex)
    {
        cout << "In main. Constructor failure: " << ex.what() << endl;
    }
    return 0;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-02-08T08:51:00.277

但是，您可以使用延迟初始化，即在 MyClass 中为 Reader 保存一个 unique_ptr 并使用 new 创建它。这样，您甚至不需要标志 has_reader 但您可以查看您的 unique_ptr 是否为初始值。

```
#include <iostream>
#include <memory>
using namespace std;

class MyOtherClass
{
public:
    MyOtherClass()
    {
        throw std::runtime_error("not working");
    }
};

class MyClass
{
public:
    typedef std::unique_ptr<MyOtherClass> MyOtherClassPtr;

    MyClass()
    {
        try
        {
            other = std::make_unique<MyOtherClass>();
        }
        catch(...)
        {
            cout << "initialization failed." << endl;
        }

        cout << "other is initialized: " << (other ? "yes" : "no");
    }

private:
    std::unique_ptr<MyOtherClass> other;
};

int main()
{
    MyClass c;

    return 0;
} 
```

当然，也有完全不使用异常的解决方案，但我认为这是您设置的先决条件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-01T23:02:49.677

我不知道你会如何使用初始化列表语法来做到这一点，但我也有点怀疑你是否能够通过在构造函数中捕获异常来做任何有用的事情。显然，这取决于类的设计，但是在什么情况下您将无法创建“mB”，并且仍然有一个有用的“A”对象？

您不妨让异常渗透，并在调用 A 的构造函数的任何地方处理它。

# svn - 在 OS X (PowerPC G4) 上使用 SVN 1.5.2 “授权失败”

> ID：160162
> 
> 赞同：2
> 
> 时间：2008-10-01T23:02:23.483
> 
> 标签：svn, macos, collabnet

我正在尝试使用托管在我学校网络上的 SVN 服务器。我已经安装了 SVN 1.5.2 以及从 CollabNet [here](http://www.collab.net/downloads/community/)下载的二进制文件。报告的错误是：

```
svn: Commit failed (details follow):
svn: MKACTIVITY of '/opensvn/cs598r/!svn/act/defe271c-f33b-4851-a706-b2906301fed0': authorization failed (http://dna.cs.byu.edu) 
```

这是完整的错误信息——它没有说 403 Forbidden。我尝试删除我的工作副本并再次检查它无济于事。我已经检查并再次检查了我的密码和权限在服务器上是否正确。我已检查 URL 是否正确。我可以从远程机器成功提交，但不能从我的机器上提交。我团队的其他成员可以从他们的计算机上提交，但是当他们从我的计算机上尝试时，他们得到了同样的错误。我团队的其他成员之一正在使用 1.5.1 CollabNet 二进制文件，没有任何问题。我的客户坏了怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-02T16:26:06.410

由于您可以从其他机器提交，并且您的团队成员可以提交但不能从您的机器提交，我会说这可能是您的颠覆客户端的问题。我建议您卸载您拥有的客户端，然后安装正在服务器上运行的版本以确保安全。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-11-15T08:51:14.063

我认为您需要**授权**才能提交本地副本...

或者

也许您可以提交，但服务器不会自动更新？**...通过SSH**和**SVN 更新**提交您的工作后尝试更新服务器

 *** * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-02T00:26:46.917

并非所有访问存储库的形式都允许所有形式的访问。如果您通过只读方法签出代码，您将无法提交。例如，WebDav 存储库仅允许在 http://... 上匿名签出并仅在 https://... 上允许身份验证和提交并不少见。

检查您要从中签出的存储库是否与您团队的其他成员正在从中签出的存储库逐个字母相同。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-02T02:31:09.503

确保您[对整个 svn url 使用正确的 CAPS](http://www.alagad.com/go/blog-entry/subversion-mkactivity-and-403-forbidden-headaches)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-05-21T22:31:50.590

我认为问题在括号内（[http://dna.cs.byu.edu](http://dna.cs.byu.edu)）。您通常可以使用 http 路径结帐，但提交通常需要 https。

# sharepoint - Required Fields in Share Point data collection not throwing errors

> ID：160165
> 
> 赞同：0
> 
> 时间：2008-10-01T23:03:25.510
> 
> 标签：sharepoint, moss, sharepoint-designer

I have created a workflow in Share Point Designer on our MOSS2007 dev server. (No one is allowed to have access to write .NET code yet as company policy)

In this workflow I am collecting data from the user, and both of my custom content types I created are marked as required, but the page isn't tossing errors when I don't supply values; not client side nor server side.

I checked the ..xoml.wfconfig.xml file and set the properties for required to true, I set the content type to required, and I used Share Point design to mark them as required. Nothing.

This is a out of the box installation except for the master page and style sheets. To make sure it wasn't that, I reverted to an out of the box style sheet.

Any ideas on what else to check / set?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-01T23:12:57.127

Sharepoint 可能有点古怪。我成功地按照[本指南](http://davidmcnamee.com/blog/Lists/Posts/Post.aspx?List=fb0f1146-befc-43b7-971b-9c4507a55031&ID=18)获取了必填字段。我不确定它是否与您尝试做的完全一样，但也许它会让您走上正确的道路。基本上，它使用页面布局和内容类型来强制执行必填字段。

我很想知道这种方法是否与您的方法有很大不同

# perl - 在 Perl 中遍历多维散列

> ID：160175
> 
> 赞同：5
> 
> 时间：2008-10-01T23:07:33.113
> 
> 标签：perl, scripting, multidimensional-array

如果您在 perl 中有一个具有多个维度的散列（或对散列的引用）并且您想要遍历所有值，那么最好的方法是什么。换句话说，如果我们有 $f->{$x}{$y}，我想要类似的东西

```
foreach ($x, $y) (deep_keys %{$f})
{
} 
```

代替

```
foreach $x (keys %f) 
    {
    foreach $y (keys %{$f->{$x}) 
    {
    }
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-02T08:36:49.907

第一阶段：不要重新发明轮子:)

[在 CPAN 上](http://search.cpan.org/search?query=walk&mode=all)快速搜索会发现非常有用的[Data::Walk](http://search.cpan.org/dist/Data-Walk/)。定义一个子程序来处理每个节点，然后你就被排序了

```
use Data::Walk;

my $data = { # some complex hash/array mess };

sub process {
   print "current node $_\n";
}

walk \&process, $data; 
```

鲍勃是你的叔叔。请注意，如果您想将哈希传递给它，则需要传递对它的引用（参见[perldoc perlref](http://perldoc.perl.org/perlref.html)），如下所示（否则它也会尝试处理您的哈希键！）：

```
walk \&process, \%hash; 
```

要获得更全面的解决方案（但在 CPAN 中乍一看更难找到），请使用[Data::Visitor::Callback](http://search.cpan.org/dist/Data-Visitor/lib/Data/Visitor/Callback.pm)或其父模块 - 这具有让您更好地控制您所做的事情的优势，并且（仅用于额外的街道cred) 是使用 Moose 编写的。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-10-02T00:07:11.783

这是一个选项。这适用于任意深度的哈希：

```
sub deep_keys_foreach
{
    my ($hashref, $code, $args) = @_;

    while (my ($k, $v) = each(%$hashref)) {
        my @newargs = defined($args) ? @$args : ();
        push(@newargs, $k);
        if (ref($v) eq 'HASH') {
            deep_keys_foreach($v, $code, \@newargs);
        }
        else {
            $code->(@newargs);
        }
    }
}

deep_keys_foreach($f, sub {
    my ($k1, $k2) = @_;
    print "inside deep_keys, k1=$k1, k2=$k2\n";
}); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-02T08:43:08.470

在我看来，这听起来好像[Data::Diver](http://search.cpan.org/perldoc?Data::Diver)或[Data::Visitor](http://search.cpan.org/perldoc?Data::Visitor)是适合您的好方法。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-01T23:44:35.333

请记住，Perl 列表和散列没有**维度**，因此不能是多维的。您**可以**拥有的是设置为引用另一个散列或列表的散列项。这可用于创建虚假的多维结构。

一旦你意识到这一点，事情就变得容易了。例如：

```
sub f($) {
  my $x = shift;
  if( ref $x eq 'HASH' ) {
    foreach( values %$x ) {
      f($_);
    }
  } elsif( ref $x eq 'ARRAY' ) {
    foreach( @$x ) {
      f($_);
    }
  }
} 
```

当然，除了遍历结构之外，还要添加任何其他需要做的事情。

做你需要的一个很好的方法是传递一个代码引用以从 f 内部调用。通过使用子原型，您甚至可以使调用看起来像 Perl 的 grep 和 map 函数。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-02T04:31:11.433

如果您始终拥有所有键值，或者您只是不需要将各个级别作为单独的数组访问，您也可以捏造多维数组：

```
$arr{"foo",1} = "one";
$arr{"bar",2} = "two";

while(($key, $value) = each(%arr))
{
    @keyValues = split($;, $key);
    print "key = [", join(",", @keyValues), "] : value = [", $value, "]\n";
} 
```

这使用下标分隔符“$;” 作为键中多个值的分隔符。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-01T23:24:05.227

如果您只想对值进行操作，这很容易，但如果您想对键进行操作，则需要指定如何恢复级别。

一种。例如，您可以将键指定为`"$level1_key.$level2_key.$level3_key"`-- 或任何分隔符，表示级别。

湾。或者你可以有一个键列表。

我推荐后者。

*   级别可以理解为`@$key_stack`

*   最本地的键是`$key_stack->[-1]`.

*   路径可以通过以下方式重构：`join( '.', @$key\_stack )`

代码：

```
use constant EMPTY_ARRAY => [];
use strict;    
use Scalar::Util qw<reftype>;

sub deep_keys (\%) { 
    sub deeper_keys { 
        my ( $key_ref, $hash_ref ) = @_;
        return [ $key_ref, $hash_ref ] if reftype( $hash_ref ) ne 'HASH';
        my @results;

        while ( my ( $key, $value ) = each %$hash_ref ) { 
            my $k = [ @{ $key_ref || EMPTY_ARRAY }, $key ];
            push @results, deeper_keys( $k, $value );
        }
        return @results;
    }

    return deeper_keys( undef, shift );
}

foreach my $kv_pair ( deep_keys %$f ) { 
    my ( $key_stack, $value ) = @_;
    ...
} 
```

这已经在 Perl 5.10 中进行了测试。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-02T00:08:24.467

如果您正在处理超过两层深度的树数据，并且您发现自己想要走那棵树，那么您应该首先考虑如果您计划重新实现所需的一切，您将为自己做很多额外的工作当有很多好的替代方案可用时（在[CPAN 中搜索“Tree”](http://search.cpan.org/search?query=tree&mode=all)），手动对散列的散列进行散列处理。

不知道您的数据需求实际上是什么，我将盲目地向您[介绍 Tree::DAG_Node 的教程](http://www.perlmonks.org/?node_id=153259)以帮助您入门。

也就是说，Axeman 是正确的，hashwalk 最容易通过递归完成。如果您觉得绝对必须使用散列的散列来解决您的问题，这里有一个示例可以帮助您入门：

```
#!/usr/bin/perl
使用严格；
使用警告；

我的 %hash = (
    “顶层 1” =>
    {
        "sublevel1a" => "value-1a",
        "sublevel1b" => "value-1b"
    },
    “顶层 2” =>
    {
        "sublevel1c" =>
        {
            “价值-1c.1”=>“替换-1c.1”，
            “价值-1c.2”=>“替换-1c.2”
        },
        "sublevel1d" => "value-1d"
    }
);

散列行走（\%hash）；

子哈希步道
{
    我的 ($element) = @_;
    如果（参考（$元素）=〜/哈希/）
    {
        foreach 我的 $key (keys %$element)
        {
            打印 $key," => \n";
            hashwalk($$element{$key});
        }
    }
    别的
    {
        打印$元素,"\n";
    }
}

```

它将输出：

```
顶层 2 =>
sublevel1d =>
价值1d
sublevel1c =>
价值 1c.2 =>
替换-1c.2
价值 1c.1 =>
替换-1c.1
顶层 1 =>
子层1a =>
价值 1a
底层1b =>
价值-1b

```

请注意，除非您通过 Tie::IxHash 或类似方法绑定哈希，否则您无法预测哈希元素的遍历顺序——同样，如果您要完成那么多工作，我推荐使用树模块。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-02T01:43:25.250

无法获得您描述的语义，因为`foreach`一次迭代一个列表元素。您必须改为`deep_keys`返回一个 LoL（列表列表）。即使这在任意数据结构的一般情况下也不起作用。可能有不同级别的子哈希，其中一些级别可能是 ARRAY refs 等。

Perlish 的做法是编写一个可以遍历任意数据结构并在每个“叶子”（即非引用值）处应用回调的函数。[bmdhacks 的回答](https://stackoverflow.com/questions/160175/traversing-a-multi-dimensional-hash-in-perl#160321)是一个起点。确切的功能会有所不同，具体取决于您想要在每个级别执行的操作。如果您只关心叶子值，那将非常简单。如果您关心使您进入叶子的键、索引等，事情会变得更加复杂。

# .net - Visual Studio 2005，如何获取解决方案中使用的项目？

> ID：160179
> 
> 赞同：3
> 
> 时间：2008-10-01T23:08:49.727
> 
> 标签：.net, visual-studio-2005, project-reference

我有一个包含其他 70 个项目的解决方案。我的问题是：我怎么知道项目在哪里使用？我不想打开所有这 70 个项目来一一验证参考。如何查看哪个项目特别使用了一个项目？

**编辑** 我不想在 XML 或 VS 中的参考中进行 1 对 1 的搜索。我想要一个快速的方法来做到这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-01T23:52:07.967

有一个非常酷的 codeplex 项目，它创建了我以前使用过的依赖可视化。尽管有 70 个项目，除非每个项目只有几个依赖项，否则您可能无法很好地阅读它。

无论如何，它仍然值得一试——您甚至可以重新调整一些源代码的用途，将依赖项输出到列表中。

它在[Dependecy Visualizer Codeplex 项目中](http://www.codeplex.com/dependencyvisualizer)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-01T23:38:03.290

您可以求助于使用 Windows 本身的搜索功能。

每个项目都有一个名为*library_name* .csproj.FileListAbsolute.txt 的文件。

使用 *FileListAbsolute.txt 快速搜索我正在寻找的 DLL，因为过滤器产生了我想要的结果。

FileListAbsolute.txt 文件列出了特定项目的 DLL 等。我为 VS 2008 做了这个，但我想它也可能适用于 VS 2005。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-01T23:14:59.133

项目文件是 XML 格式的，所以编写一些东西来解析它们应该没什么大不了的。如果您只想查找哪些项目引用了特定的其他项目，“grep”可能会足够好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-01T23:21:35.857

如果您正在寻找特定项目，您甚至可以使用 Studio 本身的搜索功能。仅搜索该特定项目的 xml 项目文件。如果您尝试绘制所有内容，则效果不佳。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-27T18:27:43.583

[Visual Ndepend](http://www.ndepend.com)是我目前正在尝试的一个工具，并且在我最初的问题上看起来很有希望。

# macos - 如何在 OS X 上使用同上，在 Linux 上像 cp -a 一样工作

> ID：160204
> 
> 赞同：7
> 
> 时间：2008-10-01T23:20:33.287
> 
> 标签：macos

我是一个 Linux 人，我习惯于使用`cp -a`. OS X 没有`-a`关于 ... 的选项，`cp`但它确实有`ditto`命令。我现在正在阅读这个人`ditto`，但有什么我应该特别注意的吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-01T23:43:47.800

根据**cp**手册页**cp -a与****cp -dpR**相同，即

```
-p = preserve mode,ownership,timestamps
-R = recursive
-d = no dereference and preserve links 
```

OS X 等价物是

**cp -pPR**

```
-p = preserve
-R = recursive
-P = no symbolic links are followed -- can be added but this is the default behavior 
```

唯一缺少的是**-d**我认为这是默认行为，但我并不积极。

我从来没有搞砸过**同上**

编辑——@SoloBold

**-L**遵循符号链接。 **-p**不遵循符号链接。OS X（至少 10.4）没有**-d**选项。

这是一个巨大的差异。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-01T23:41:56.620

我个人使用`rsync -a`（或任何`rsync`需要的参数）。我的两个原因是：我已经知道如何做到这一点，并且我需要我的脚本可以跨 Linux/BSD/Solaris 移植。还有一些文件系统`rsync`比`cp`.

抱歉，这不是一个直接的答案，我`ditto`在 BSD 上使用过，但没有任何不在手册页中的问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-08-21T22:25:46.080

如果您使用的是同上，您应该知道它移动内容的方式与移动`cp -a`文件夹时有所不同：

```
ditto foo bar 
```

将 foo 的内容移动到 bar 中（导致 bar/file1, bar/file2 .. ）

```
cp -a foo bar 
```

将 foo/ 移动到 bar/ 中（导致 bar/foo/file1, bar/foo/file2, .. ）

另外：OSX cp 现在支持`cp -a`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-01T23:39:48.027

从 Linux cp(1)：

> -a, --archive 与 -dpR 相同

这令人困惑，因为 -d 似乎等同于 -p。无论如何，OSX 有 -p 和 -R 所以你可以使用它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-01T23:36:14.357

正如 j04t 指出的那样，应该是`cp -pR`

~~在 OS X 上，你会做~~

 ~~```
cp -dRL src target 
```~~ 

~~cp 在较新版本的 OS X 中保留资源（发生这种情况时是 10.3 吗？）~~

 ~~嘿 d 有点像倒置的 p，对吧 ;)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-10-04T01:51:28.633

ditto 和 cp 之间的区别在于，当 source 是一个目录时， cp 在目标上创建一个具有该名称的目录，但 ditto 只是复制内容。谨防！

# visual-studio - VisualSVN 和类库不在工作副本根目录中

> ID：160212
> 
> 赞同：7
> 
> 时间：2008-10-01T23:24:46.333
> 
> 标签：visual-studio, svn, version-control, tortoisesvn, visualsvn

我们正在使用 VisualSVN 进行 Visual Studio 集成从 SourceGear Vault 切换到 TortoiseSVN - 非常喜欢它。但是，我们在多个不同的应用程序中引用了多个类库，这些类库不属于任何应用程序的工作副本根目录。处理这个问题的最佳方法是什么，以便我们可以继续利用 Visual Studio 集成，但仍将各种类库保留在每个项目/应用程序的根目录之外？SourceGear 对此没有任何问题。

可以仅在资源管理器中使用 TortoiseSVN 单独添加类库，但无法从 Visual Studio 中提交对工作副本之外的任何内容的更改；在工作副本类库之外也没有指示这些状态的 VisualSVN“交通灯”。

顺便说一句，我们也将采用“一个存储库和多个项目”的路线，而不是多个存储库，尤其是我们多年来一直这样做的方式。

更新：

我重新阅读了一些我之前看过的东西，发现 svn:externals 不仅仅指在不同的存储库中使用代码，还可以用于在 VisualSVN 中使用多个工作副本。

请参阅[http://www.visualsvn.com/support/topic/00007/](http://www.visualsvn.com/support/topic/00007/)和[http://svnbook.red-bean.com/en/1.2/svn.advanced.externals.html](http://svnbook.red-bean.com/en/1.2/svn.advanced.externals.html)

然而，这是处理这个问题的最好方法吗？有一个[很好的线索](http://groups.google.com/group/visualsvn/browse_thread/thread/aaffcc71721a9a27)可以贯穿事情，但不能完全解决事情。

因此，是否使用 svn:externals？是否使用多个存储库？同样，多年来，我们在多个解决方案/应用程序中引用了共享类库中的代码，这对我们有用。现在如何最好地使用 VisualSVN 进行这项工作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-02T19:15:00.217

[在这里](http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-dug-import.html)找到最佳答案：

参考项目

有时构建一个由许多不同的结帐组成的工作副本很有用。例如，您可能希望不同的子目录来自存储库中的不同位置，或者可能完全来自不同的存储库。如果您希望每个用户都有相同的布局，您可以定义 svn:externals 属性。

[在](http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-howto-common-projects.html)这里：

包括一个共同的子项目

有时你会想在你的工作副本中包含另一个项目，也许是一些库代码。您不想在存储库中复制此代码，因为那样您将失去与原始（和维护）代码的连接。或者，也许您有几个共享核心代码的项目。至少有3种方法可以解决这个问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-06-18T15:18:49.803

我知道你问这个问题已经十多年了，但我很高兴地告诉你，在 VisualSVN 插件中实现对多个工作副本的支持方面取得了进展。

VisualSVN 7.1 和 6.5**在一个解决方案中支持多个工作副本**。**Visual Studio 2019**和**2017**用户可以使用新功能。

从主[下载页面](https://www.visualsvn.com/visualsvn/download/)下载最新的 VisualSVN 版本。另请参阅文章[KB7：在 VisualSVN 中使用多个工作副本](https://www.visualsvn.com/support/topic/00007/)。

# .net - ListViewSubtemCollection 将什么用于其键？

> ID：160214
> 
> 赞同：1
> 
> 时间：2008-10-01T23:25:26.940
> 
> 标签：.net, listview

我正在尝试获取一些 ListViewSubItems 的值，但我不知道它的键使用什么值。我有一些简单的代码：

```
 protected override void OnItemDrag(ItemDragEventArgs e)
    {
        base.OnItemDrag(e);            
        ListViewItem item = e.Item as ListViewItem;
        string val = item.SubItems[???].ToString(); 
    } 
```

这 ？？？部分是我遇到问题的地方。我无法弄清楚钥匙是什么。我尝试了 ListView 的列名，但没有成功。我想使用这种方法而不是使用数字索引。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-01T23:36:52.980

您只能使用列索引来添加子项，但您可以通过创建包含每个列的索引的枚举来使其更易于阅读。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-02T00:15:52.030

的关键是[这里](http://msdn.microsoft.com/en-us/library/1x4396ba.aspx)描述`ListViewSubItem`的属性。`Name`

将 Name 设置为等于列名，将允许您按列名对 SubItems 进行索引。

并以一些代码为例

`ListViewItem myListViewItem = new ListViewItem();
ListViewItem.ListViewSubItem myListViewSubItem = new ListViewItem.ListViewSubItem();
myListViewSubItem.Text = "This will be displayed";
myListViewSubItem.Name = "my key";
myListViewItem.SubItems.Add(myListViewSubItem);
ListViewItem.ListViewSubItem subItem = myListViewItem.SubItems["my key"];` 

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-01T23:33:37.030

不幸的是，子项仅按列索引排序。所以你必须像这样访问它们：

```
protected override void OnItemDrag(ItemDragEventArgs e)
{
    base.OnItemDrag(e);            
    ListViewItem item = e.Item as ListViewItem;
    string val = item.SubItems[0].ToString(); 
} 
```

# c# - C#如何更换系统托盘时钟

> ID：160215
> 
> 赞同：5
> 
> 时间：2008-10-01T23:25:33.990
> 
> 标签：c#, windows, windows-xp

如何更换任务栏中的标准系统托盘时钟？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-02T00:01:49.177

我在 C++ 中找到了一个示例：[C++ Open Source Project](http://wincalendartime.sourceforge.net/index.html)

我希望你也能在 C# 中找到一些东西。

# loops - Mathematica 中的 ForEach 循环

> ID：160216
> 
> 赞同：22
> 
> 时间：2008-10-01T23:25:43.460
> 
> 标签：loops, language-features, wolfram-mathematica

我想要这样的东西：

```
each[i_, {1,2,3},
  Print[i]
] 
```

或者，更一般地，解构您正在循环的列表中的任意内容，例如：

```
each[{i_, j_}, {{1,10}, {2,20}, {3,30}},
  Print[i*j]
] 
```

通常，您希望使用`Map`或其他纯函数式构造，并避免使用副作用的非函数式编程风格。但这里有一个例子，我认为 for-each 结构非常有用：

假设我有一个将符号与表达式配对的选项（规则）列表，例如

```
attrVals = {a -> 7, b -> 8, c -> 9} 
```

现在我想制作一个哈希表，在其中将这些符号明显映射到这些数字。我认为没有比这更清洁的方法了

```
each[a_ -> v_, attrVals, h[a] = v] 
```

## 额外的测试用例

在这个例子中，我们转换了一个变量列表：

```
a = 1;
b = 2;
c = 3;
each[i_, {a,b,c}, i = f[i]] 
```

在上述之后，`{a,b,c}`应评估为`{f[1],f[2],f[3]}`。请注意，这意味着`each`如果它是一个列表，则它的第二个参数应该不被评估。

如果未计算的形式不是列表，它应该计算第二个参数。例如：

```
each[i_, Rest[{a,b,c}], Print[i]] 
```

那应该打印 和 的`b`值`c`。

**附录**：为了正确地做for-each，它应该支持`Break[]`和`Continue[]`。我不确定如何实现。也许它需要以某种方式用 For、While 或 Do 来实现，因为这些是唯一支持`Break[]`and的循环结构`Continue[]`。

到目前为止，答案的另一个问题是：他们吃`Return[]`s。也就是说，如果您在函数中使用 ForEach 循环并希望从循环内从函数返回，则不能。在 ForEach 循环内发出 Return 似乎像`Continue[]`. 这只是（等待它）让我陷入了循环。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2010-03-05T23:40:30.633

我在这里聚会迟到了几年，这可能更像是对“元问题”的回答，但是当使用 Mathematica（或其他函数式语言）编程时，许多人最初遇到的困难来自功能而非结构的观点。Mathematica 语言具有结构构造，但其核心是功能性的。

考虑你的第一个例子：

```
ForEach[i_, {1,2,3},
  Print[i]
] 
```

正如一些人指出的那样，这可以在功能上表示为`Scan[Print, {1,2,3}]`or `Print /@ {1,2,3}`（尽管如前所述，您应该尽可能倾向于`Scan`使用`Map`，但有时这可能很烦人，因为 没有中缀运算符`Scan`）。

在 Mathematica 中，通常有十几种方法可以做任何事情，有时很漂亮，有时却令人沮丧。考虑到这一点，请考虑您的第二个示例：

```
ForEach[{i_, j_}, {{1,10}, {2,20}, {3,30}},
  Print[i*j]
] 
```

...从功能的角度来看，这更有趣。

一种可能的功能解决方案是使用列表替换，例如：

```
In[1]:= {{1,10},{2,20},{3,30}}/.{i_,j_}:>i*j
Out[1]= {10,40,90} 
```

...但是如果列表非常大，这将不必要地缓慢，因为我们正在不必要地进行所谓的“模式匹配”（例如，在列表中查找 {a, b} 的实例并将它们分配给`i`and `j`）。

给定一个包含 100,000 对的大数组`array = RandomInteger[{1, 100}, {10^6, 2}]`，我们可以查看一些时序：

规则替换非常快：

```
In[3]:= First[Timing[array /. {i_, j_} :> i*j;]]
Out[3]= 1.13844 
```

...但是如果我们利用每对真正的表达式结构`List[i,j]`并将其应用`Times`为每对的头部，我们可以做得更好，将每个`{i,j}`变成`Times[i,j]`：

```
In[4]:= (* f@@@list is the infix operator form of Apply[f, list, 1] *)
    First[Timing[Times @@@ array;]]
Out[4]= 0.861267 
```

正如在`ForEach[...]`上面的实现中使用的那样，`Cases`显然是次优的：

```
In[5]:= First[Timing[Cases[array, {i_, j_} :> i*j];]]
Out[5]= 2.40212 
```

...因为`Cases`不仅仅是规则替换，还需要一个接一个地构建匹配元素的输出。事实证明，我们可以*通过*不同的方式分解问题，并利用, 并支持向量化操作这一`Times`事实，做得更好。`Listable`

该`Listable`属性意味着函数`f`将自动遍历任何列表参数：

```
In[16]:= SetAttributes[f,Listable]
In[17]:= f[{1,2,3},{4,5,6}]
Out[17]= {f[1,4],f[2,5],f[3,6]} 
```

所以，因为`Times`is `Listable`，如果我们将数字对作为两个单独的数组：

```
In[6]:= a1 = RandomInteger[{1, 100}, 10^6];
        a2 = RandomInteger[{1, 100}, 10^6];

In[7]:= First[Timing[a1*a2;]]
Out[7]= 0.012661 
```

*哇*，快了不少！即使输入没有作为两个单独的数组提供（或者每对中有两个以上的元素），我们仍然可以做一些最优的事情：

```
In[8]:= First[Timing[Times@@Transpose[array];]]
Out[8]= 0.020391 
```

这部史诗的寓意并不是说它`ForEach`不是一个有价值的构造，甚至在 Mathematica 中也是如此，而是当您以功能性思维方式而不是结构性思维方式工作时，您通常可以更有效、更优雅地获得相同的结果。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-08-11T14:39:20.677

较新版本的 Mathematica (6.0+) 具有 Do[] 和 Table[] 的通用版本，通过采用迭代器参数的另一种形式，它们几乎可以精确地完成您想要的操作。例如，

```
Do[
  Print[i],
  {i, {1, 2, 3}}] 
```

和你的一模一样

```
ForEach[i_, {1, 2, 3,},
  Print[i]] 
```

或者，如果您真的喜欢特定的 ForEach 语法，您可以创建一个实现它的 HoldAll 函数，如下所示：

```
Attributes[ForEach] = {HoldAll};

ForEach[var_Symbol, list_, expr_] :=
  ReleaseHold[
    Hold[
      Scan[
        Block[{var = #},
         expr] &,
      list]]];

ForEach[vars : {__Symbol}, list_, expr_] :=
  ReleaseHold[
    Hold[
      Scan[
        Block[vars,
          vars = #;
          expr] &,
      list]]]; 
```

这使用符号作为变量名，而不是模式，但这就是 Do[] 和 For[] 等各种内置控制结构的工作方式。

HoldAll[] 函数允许您将各种各样的自定义控制结构组合在一起。ReleaseHold[Hold[...]] 通常是组装一堆 Mathematica 代码以供稍后评估的最简单方法，而 Block[{x = #}, ...]& 允许将表达式主体中的变量绑定到你想要的任何值。

针对下面 dreeves 的问题，您可以修改此方法以允许使用唯一符号的 DownValues 进行更任意的解构。

```
ForEach[patt_, list_, expr_] := 
  ReleaseHold[Hold[
     Module[{f}, 
       f[patt] := expr; 
       Scan[f, list]]]] 
```

不过，在这一点上，我认为您最好在 Cases 之上构建一些东西。

```
ForEach[patt_, list_, expr_] :=
  With[{bound = list},
    ReleaseHold[Hold[
       Cases[bound,
         patt :> expr]; 
       Null]]] 
```

当我抑制函数的返回值时，我喜欢使 Null 显式。**编辑**：我修复了下面指出的错误；我总是喜欢使用`With`将求值表达式插入到`Hold*`表单中。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-10-01T23:28:17.603

内置的`Scan`基本上是这样做的，虽然它更难看：

```
    扫描[打印[#]&, {1,2,3}]

```

当您想要解构元素时，它尤其难看：

```
    扫描[打印[#[[1]] * #[[2]]]&, {{1,10}, {2,20}, {3,30}}]

```

以下函数通过转换`pattern`为`body`的每个元素来避免丑陋`list`。

```
SetAttributes[ForEach, HoldAll];
ForEach[pat_, lst_, bod_] := 扫描[替换[#, pat:>bod]&, Evaluate@lst]

```

可以像问题中的示例一样使用它。

PS：接受的答案促使我切换到这个，这是我从那时起一直在使用的，它似乎工作得很好（除了我附加到问题的警告）：

```
SetAttributes[ForEach, HoldAll];             (* ForEach[pattern, list, body]   *)
ForEach[pat_, lst_, bod_] := ReleaseHold[    (*  converts pattern to body for  *)
  Hold[Cases[Evaluate@lst, pat:>bod];]];     (*   each element of list.        *) 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-23T00:00:46.497

内置的地图功能正是您想要的。它可以以长形式使用：

地图[打印，{1,2,3}]

或速记

打印 /@ {1,2,3}

在第二种情况下，您将使用 "Print[Times@@#]&/@{{1,10}, {2,20}, {3,30}}"

我建议阅读有关 Map、MapThread、Apply 和 Function 的 Mathematica 帮助。他们可能需要一点时间来适应，但一旦你习惯了，你就再也不想回去了！

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-08-31T15:57:11.213

这是基于 dreeves 的最后一个答案的轻微改进，它允许指定不带空白的模式（使语法类似于 Table 或 Do 等其他函数）并使用 Cases 的 level 参数

```
SetAttributes[ForEach,HoldAll];
ForEach[patt_/; FreeQ[patt, Pattern],list_,expr_,level_:1] :=
   Module[{pattWithBlanks,pattern},
      pattWithBlanks = patt/.(x_Symbol/;!MemberQ[{"System`"},Context[x]] :> pattern[x,Blank[]]);
      pattWithBlanks = pattWithBlanks/.pattern->Pattern;

      Cases[Unevaluated@list, pattWithBlanks :> expr, {level}];
      Null
   ]; 
```

测试：

```
ForEach[{i, j}, {{1, 10}, {2, 20}, {3, 30}}, Print[i*j]]
ForEach[i, {{1, 10}, {2, 20}, {3, 30}}, Print[i], 2] 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-08-24T16:48:44.363

Mathematica 有 map 函数，所以假设你有一个函数`Func`接受一个参数。然后就写

```
Func /@ list

Print /@ {1, 2, 3, 4, 5} 
```

返回值是应用于列表中每个元素的函数列表。

```
PrimeQ /@ {10, 2, 123, 555} 
```

将返回`{False,True,False,False}`

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-01-15T16:30:38.153

感谢[Pillsy](https://stackoverflow.com/users/85467/pillsy)和[Leonid Shifrin](https://stackoverflow.com/users/565518/leonid-shifrin)，这就是我现在使用的：

```
SetAttributes[each, HoldAll];               (* each[pattern, list, body]      *)
each[pat_, lst_List, bod_] :=               (*  converts pattern to body for  *)
  (Cases[Unevaluated@lst, pat:>bod]; Null); (*   each element of list.        *)
each[p_, l_, b_] := (Cases[l, p:>b]; Null); (* (Break/Continue not supported) *) 
```

# conditional-operator - 三元还是不三元？

> ID：160218
> 
> 赞同：194
> 
> 时间：2008-10-01T23:27:46.433
> 
> 标签：conditional-operator

我个人是三元运算符的拥护者： () ？: ; 我确实意识到它有它的位置，但我遇到过许多完全反对使用它的程序员，有些程序员使用它过于频繁。

你对此有何感想？你见过什么有趣的代码使用它？

* * *

## 回答 #1

> 赞同：256
> 
> 时间：2008-10-01T23:58:49.823

仅用于**简单表达式**：

```
int a = (b > 10) ? c : d; 
```

**不要链接或嵌套**三元运算符，因为它难以阅读和混淆：

```
int a = b > 10 ? c < 20 ? 50 : 80 : e == 2 ? 4 : 8; 
```

此外，在使用三元运算符时，请考虑以提高可读性的方式格式化代码：

```
int a = (b > 10) ? some_value                 
                 : another_value; 
```

* * *

## 回答 #2

> 赞同：152
> 
> 时间：2008-10-01T23:34:49.740

由于不能在每个子表达式上放置断点，因此调试会稍微困难一些。我很少使用它。

* * *

## 回答 #3

> 赞同：83
> 
> 时间：2009-02-11T01:37:55.620

我喜欢它们，尤其是在类型安全的语言中。

我不明白这是怎么回事：

```
int count = (condition) ? 1 : 0; 
```

比这更难：

```
int count;

if (condition)
{
  count = 1;
}
else
{
  count = 0;
} 
```

我认为三元运算符使一切都比其他运算符更简单，更简洁。

* * *

## 回答 #4

> 赞同：47
> 
> 时间：2008-10-02T04:32:38.637

链接我很好 - 嵌套，不是那么多。

我倾向于在 C 中更多地使用它们，因为它们是一个有价值的*if*语句，因此它减少了不必要的重复或变量：

```
x = (y < 100) ? "dog" :
    (y < 150) ? "cat" :
    (y < 300) ? "bar" : "baz"; 
```

而不是

```
 if (y < 100) { x = "dog"; }
else if (y < 150) { x = "cat"; }
else if (y < 300) { x = "bar"; }
else              { x = "baz"; } 
```

在这样的作业中，我发现重构更少，更清晰。

另一方面，当我在 ruby​​ 中工作时，我更有可能使用它，`if...else...end`因为它也是一个表达式。

```
x =   if (y < 100) then "dog"
    elif (y < 150) then "cat"
    elif (y < 300) then "bar"
    else                "baz"
    end 
```

（虽然，诚然，对于这么简单的事情，我可能只是使用三元运算符。）

* * *

## 回答 #5

> 赞同：40
> 
> 时间：2008-10-02T01:13:45.383

*三元* `?:`运算符只是过程`if`构造的功能等价物。因此，只要您不使用嵌套`?:`表达式，支持/反对任何操作的功能表示的参数都适用于此处。但是嵌套三元操作可能会导致代码完全混乱（读者练习：尝试编写一个解析器来处理嵌套三元条件，您将体会到它们的复杂性）。

但是在很多情况下，保守地使用`?:`运算符会导致代码实际上比其他方式*更容易*阅读。例如：

```
int compareTo(Object object) {
    if((isLessThan(object) && reverseOrder) || (isGreaterThan(object) && !reverseOrder)) {
       return 1;
    if((isLessThan(object) && !reverseOrder) || (isGreaterThan(object) && reverseOrder)) {
       return -1;
    else
      return 0;
} 
```

现在将其与此进行比较：

```
int compareTo(Object object) {
    if(isLessThan(object))
        return reverseOrder ? 1 : -1;
    else(isGreaterThan(object))
        return reverseOrder ? -1 : 1;
    else
       return 0;
} 
```

由于代码更紧凑，语法噪音更少，并且通过明智地使用三元运算符（仅与*reverseOrder*属性有关），最终结果并不是特别简洁。

* * *

## 回答 #6

> 赞同：24
> 
> 时间：2008-10-01T23:47:25.187

这是一个风格问题，真的；我倾向于遵循的潜意识规则是：

*   只评估 1 个表达式 - 所以`foo = (bar > baz) ? true : false`，但不是`foo = (bar > baz && lotto && someArray.Contains(someValue)) ? true : false`
*   如果我将它用于显示逻辑，例如`<%= (foo) ? "Yes" : "No" %>`
*   ~~仅真正用于分配；从不流动逻辑（所以从不`(foo) ? FooIsTrue(foo) : FooIsALie(foo)`）~~三进制中的流逻辑本身就是一个谎言，忽略最后一点。

我喜欢它，因为它对于简单的赋值操作来说简洁而优雅。

* * *

## 回答 #7

> 赞同：18
> 
> 时间：2009-02-11T01:42:01.693

像许多意见问题一样，答案不可避免地是：*这取决于*

对于类似的东西：

```
return x ? "Yes" : "No"; 
```

我认为这**比**：

```
if (x) {
    return "Yes";
} else {
    return "No";
} 
```

现在如果你的条件表达式很复杂，那么三元运算不是一个好的选择。就像是：

```
x && y && z >= 10 && s.Length == 0 || !foo 
```

不是三元运算符的好候选。

顺便说一句，如果您是 C 程序员，GCC 实际上有[一个扩展](http://gcc.gnu.org/onlinedocs/gcc-4.3.3/gcc/Conditionals.html#Conditionals)，允许您排除三元的 if-true 部分，如下所示：

```
/* 'y' is a char * */
const char *x = y ? : "Not set"; 
```

将设置`x`为`y`假设`y`不是`NULL`。好东西。

* * *

## 回答 #8

> 赞同：13
> 
> 时间：2008-10-01T23:29:23.000

在我看来，只有在需要表达式的情况下使用三元运算符才有意义。

在其他情况下，三元运算符似乎降低了清晰度。

* * *

## 回答 #9

> 赞同：11
> 
> 时间：2008-10-01T23:37:57.363

我尽可能使用三元运算符，除非它使代码非常难以阅读，但这通常只是表明我的代码可以使用一些重构。

总是让我感到困惑，有些人如何认为三元运算符是一个“隐藏”功能或有些神秘。这是我开始用 C 编程时学到的第一件事，我认为它根本不会降低可读性。这是语言的自然组成部分。

* * *

## 回答 #10

> 赞同：11
> 
> 时间：2009-02-11T01:57:38.690

通过[圈复杂度](http://en.wikipedia.org/wiki/Cyclomatic_complexity)的度量，`if`语句或三元运算符的使用是等价的。因此，按照这种衡量标准，答案是**否定**的，复杂性将与以前完全相同。

通过其他措施，例如可读性、可维护性和[DRY](https://en.wikipedia.org/wiki/Don%27t_repeat_yourself)（不要重复自己），任何一个选择都可能比另一个更好。

* * *

## 回答 #11

> 赞同：10
> 
> 时间：2008-10-01T23:32:35.627

我经常在我被限制在构造函数中工作的地方使用它——例如，新的 .NET 3.5 LINQ to XML 构造——当可选参数为空时定义默认值。

人为的例子：

```
var e = new XElement("Something",
    param == null ? new XElement("Value", "Default")
                  : new XElement("Value", param.ToString())
); 
```

或（感谢asterite）

```
var e = new XElement("Something",
    new XElement("Value",
        param == null ? "Default"
                      : param.ToString()
    )
); 
```

不管你是否使用三元运算符，确保你的代码可读是重要的。任何构造都可能变得不可读。

* * *

## 回答 #12

> 赞同：7
> 
> 时间：2008-10-01T23:35:38.553

我同意 jmulder 的观点：它不应该用来代替 a `if`，但它在 return 表达式或表达式中占有一席之地：

```
echo "Result: " + n + " meter" + (n != 1 ? "s" : "");
return a == null ? "null" : a; 
```

前者只是一个例子，应该使用对复数更好的[国际化和本地化支持！](https://en.wikipedia.org/wiki/Internationalization_and_localization)

* * *

## 回答 #13

> 赞同：6
> 
> 时间：2009-02-11T02:32:38.200

如果您使用三元运算符进行简单的条件赋值，我认为这很好。我已经看到它（ab）用于控制程序流程而无需进行分配，我认为应该避免这种情况。在这些情况下使用 if 语句。

* * *

## 回答 #14

> 赞同：6
> 
> 时间：2010-10-15T23:28:27.980

（当天的黑客攻击）

```
#define IF(x) x ?
#define ELSE : 
```

然后你可以做 if-then-else 作为表达式：

```
int b = IF(condition1)    res1
        ELSE IF(condition2)  res2
        ELSE IF(conditions3) res3
        ELSE res4; 
```

* * *

## 回答 #15

> 赞同：5
> 
> 时间：2008-10-01T23:39:30.087

我认为应该在需要时使用三元运算符。这显然是一个非常主观的选择，但我发现一个简单的表达式（特别是作为返回表达式）比一个完整的测试要清晰得多。C/C++ 中的示例：

```
return (a>0)?a:0; 
```

相比：

```
if(a>0) return a;
else return 0; 
```

您还遇到解决方案介于三元运算符和创建函数之间的情况。例如在 Python 中：

```
l = [ i if i > 0 else 0 for i in lst ] 
```

替代方案是：

```
def cap(value):
    if value > 0:
        return value
    return 0
l = [ cap(i) for i in lst ] 
```

在 Python 中（例如）经常会看到这样的习语，这是非常必要的：

```
l = [ ((i>0 and [i]) or [0])[0] for i in lst ] 
```

此行使用 Python 中逻辑运算符的属性：它们是惰性的，如果等于最终状态，则返回最后计算的值。

* * *

## 回答 #16

> 赞同：5
> 
> 时间：2009-02-11T01:48:22.753

我见过这样的野兽（实际上更糟糕，因为它是 isValidDate 并且还检查了月份和日期，但我不会费心去记住整个事情）：

```
isLeapYear =
    ((yyyy % 400) == 0)
    ? 1
    : ((yyyy % 100) == 0)
        ? 0
        : ((yyyy % 4) == 0)
            ? 1
            : 0; 
```

显然，一系列 if 语句会更好（尽管这个仍然比我曾经看到的宏版本更好）。

我不介意这样的小事：

```
reportedAge = (isFemale && (Age >= 21)) ? 21 + (Age - 21) / 3 : Age; 
```

甚至有点棘手的事情，例如：

```
printf ("Deleted %d file%s\n", n, (n == 1) ? "" : "s"); 
```

* * *

## 回答 #17

> 赞同：4
> 
> 时间：2008-10-01T23:51:39.340

我几乎从不使用三元运算符，因为每当我*使用*它时，它总是让我想得比以后尝试维护它时要多得多。

我喜欢避免冗长，但是当它使代码更容易理解时，我会选择冗长。

考虑：

```
String name = firstName;

if (middleName != null) {
    name += " " + middleName;
}

name += " " + lastName; 
```

现在，这有点冗长，但我发现它比以下内容更具可读性：

```
String name = firstName + (middleName == null ? "" : " " + middleName)
    + " " + lastName; 
```

或者：

```
String name = firstName;
name += (middleName == null ? "" : " " + middleName);
name += " " + lastName; 
```

它似乎只是将太多的信息压缩到太小的空间中，而没有弄清楚发生了什么。每次我看到使用三元运算符时，我总能找到一个似乎更容易阅读的替代方案……再说一次，这是一个非常主观的意见，所以如果你和你的同事发现三元运算符非常可读，那就去吧。

* * *

## 回答 #18

> 赞同：4
> 
> 时间：2008-10-01T23:56:53.370

我喜欢在调试代码中使用运算符来打印错误值，这样我就不必一直查找它们。通常我这样做是为了调试打印，一旦我完成开发就不会保留。

```
int result = do_something();
if( result != 0 )
{
  debug_printf("Error while doing something, code %x (%s)\n", result,
                result == 7 ? "ERROR_YES" :
                result == 8 ? "ERROR_NO" :
                result == 9 ? "ERROR_FILE_NOT_FOUND" :
                "Unknown");
} 
```

* * *

## 回答 #19

> 赞同：4
> 
> 时间：2009-02-11T01:48:09.807

我喜欢他们。不知道为什么，但是我用三元表达式的时候感觉很爽。

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2008-10-01T23:31:55.847

好吧，它的语法是可怕的。我发现函数*式 if*非常有用，它们通常使代码更具可读性。

我建议制作一个宏以使其更具可读性，但我相信有人会想出一个可怕的边缘情况（就像 C++ 一样）。

* * *

## 回答 #21

> 赞同：3
> 
> 时间：2008-10-01T23:33:54.703

我对待三元运算符很像 GOTO。它们有自己的位置，但通常应该避免使用它们以使代码更易于理解。

* * *

## 回答 #22

> 赞同：3
> 
> 时间：2008-10-02T03:12:41.730

我通常在这样的事情中使用它：

```
before:

if(isheader)
    drawtext(x, y, WHITE, string);
else
    drawtext(x, y, BLUE, string);

after:

    drawtext(x, y, isheader == true ? WHITE : BLUE, string); 
```

* * *

## 回答 #23

> 赞同：3
> 
> 时间：2009-02-11T02:33:52.567

正如其他人指出的那样，它们适用于简短的简单条件。我特别喜欢它们的默认值（有点像**||**和**或**JavaScript 和 Python 中的用法），例如

```
int repCount = pRepCountIn ? *pRepCountIn : defaultRepCount; 
```

另一个常见用途是在 C++ 中初始化引用。由于必须在同一语句中声明和初始化引用，因此不能使用*if*语句。

```
SomeType& ref = pInput ? *pInput : somethingElse; 
```

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2008-10-02T00:12:42.770

我最近看到了三元运算符的变体（嗯，有点），它使标准的“（）？：”变体似乎是清晰的典范：

```
var Result = [CaseIfFalse, CaseIfTrue][(boolean expression)] 
```

或者，举一个更具体的例子：

```
var Name = ['Jane', 'John'][Gender == 'm']; 
```

请注意，这是 JavaScript，因此在其他语言中可能无法实现这样的事情（谢天谢地）。

* * *

## 回答 #25

> 赞同：2
> 
> 时间：2008-10-02T00:43:58.530

只有当：

```
$var = (simple > test ? simple_result_1 : simple_result_2); 
```

[亲吻](https://en.wikipedia.org/wiki/KISS_principle#In_software_development)。

* * *

## 回答 #26

> 赞同：2
> 
> 时间：2008-10-02T01:21:13.167

对于简单的 if 情况，我喜欢使用它。实际上，读取/编码例如作为函数或类似事物的参数要容易得多。另外，为了避免新行，我喜欢保留我所有的 if/else。

在我的书中嵌套它是一个很大*的禁忌。*

因此，继续，对于单个 if/else，我将使用三元运算符。对于其他情况，常规 if/else if/else（或 switch）。

* * *

## 回答 #27

> 赞同：2
> 
> 时间：2008-10-02T14:18:03.237

我喜欢 Groovy 的三元运算符的特殊情况，称为 Elvis 运算符：？：

```
expr ?: default 
```

如果不为空，则此代码评估为 expr，如果为空，则为默认值。从技术上讲，它并不是真正的三元运算符，但它肯定与它相关并且节省了大量时间/打字。

* * *

## 回答 #28

> 赞同：2
> 
> 时间：2009-02-11T01:39:44.413

对于简单的任务，例如根据条件分配不同的值，它们很棒。不过，当有更长的表达式取决于条件时，我不会使用它们。

* * *

## 回答 #29

> 赞同：2
> 
> 时间：2009-02-11T01:40:11.633

如果您和您的同事了解他们的工作并且他们不是在大量群体中创建的，我认为他们使代码不那么复杂并且更易于阅读，因为代码更少。

我认为三元运算符使代码更难理解的唯一一次是当你在一行中有超过三个或大厅时。大多数人不记得它们是基于正确的优先级，当你有一堆它们时，阅读代码就会变成一场噩梦。

* * *

## 回答 #30

> 赞同：2
> 
> 时间：2009-02-11T02:50:07.443

正如许多答案所说，*这取决于*. 我发现如果在快速扫描代码中看不到三元比较，那么就不应该使用它。

作为一个附带问题，我可能还会注意到它的存在实际上有点反常，因为在 C 中，比较测试是一种陈述。在[Icon](https://en.wikipedia.org/wiki/Icon_(programming_language))中，`if`构造（像大多数 Icon）实际上是一个表达式。因此，您可以执行以下操作：

```
x[if y > 5 then 5 else y] := "Y" 
```

...我发现它比三元比较运算符更具可读性。:-)

最近有一个关于将`?:`操作符添加到Icon的可能性的讨论，但有几个人正确地指出，由于工作方式，绝对没有必要`if`。

这意味着如果您可以在 C（或任何其他具有三元运算符的语言）中做到这一点，那么实际上您根本不需要三元运算符。

* * *

## 回答 #31

> 赞同：1
> 
> 时间：2009-02-11T02:48:46.493

不，它们很难阅读。If/Else 更容易阅读。

这是我的意见。[您的里程可能会有所不同](https://en.wiktionary.org/wiki/your_mileage_may_vary#Phrase)。

* * *

## 回答 #32

> 赞同：1
> 
> 时间：2009-10-02T02:12:06.200

我最近制定的确定是否应该使用三元运算符的经验法则是：

*   如果您的代码在两个不同的值之间进行选择，请继续使用三元运算符。
*   如果您的代码在两个不同的代码路径之间进行选择，请坚持使用 if 语句。

并善待您的代码的读者。如果要嵌套三元运算符，请格式化代码以使嵌套明显。

* * *

## 回答 #33

> 赞同：1
> 
> 时间：2010-03-18T20:07:26.307

三元运算符放下。如果格式正确，它们并不复杂。[以paxdiablo](https://stackoverflow.com/questions/160218/to-ternary-or-not-to-ternary/535124#535124)中的闰年为例：

```
$isLeapYear =
   (($year % 400) == 0)
   ? 1
   : ((($year % 100) == 0)
      ? 0
      : ((($year % 4) == 0)
         ? 1
         : 0)); 
```

这可以写得更简洁，并且使用这种格式更具可读性：

```
//--------------Test expression-----Result
$isLeapYear = (($year % 400) == 0) ? 1 :
              ((($year % 100) == 0)? 0 :
              ((($year % 4) == 0)  ? 1 :
                                     0)); // Default result 
```

* * *

## 回答 #34

> 赞同：1
> 
> 时间：2011-03-11T16:03:57.383

我会说逻辑表达式中的*条件*数量使其更难阅读。这适用于 if 语句，也适用于三元*运算符*。在一个完美的世界里，应该有*一个*可以概括的理由来选择一个分支而不是其他分支。如果您的解释是“仅当这组状态发生时”，那么它实际上更像是一个“业务规则”。

然而，在*现实*世界中，我们不会仅仅为了遵循理想情况而添加中间步骤来将状态折叠成一个可表达的状态。我们已经对多个状态进行了推断，并且必须就如何处理它们做出决定。

我*喜欢*三元组，因为它可以用 if 语句做*任何事情。*

```
if( object.testSomeCondition()) {
    System.exec( "format c:" );
}
else {
    a++;
} 
```

另一方面：

```
a += ( object.testSomeCondition() ? 0 : 1 ); 
```

清楚*地*表明目标是为`a`. 当然，与此一致，可能*不*应该超过合理的副作用。

*   `if`在我决定是否有时间在上游返工条件以便回答一个更简单的问题后，我会使用长或复杂的条件。但是当我使用 if 时，我*仍然*尝试进行*并行*处理，只是在不同的条件下。

    ```
     if (  user.hasRepeatedlyPressedOKWithoutAnswer()
         && me.gettingTowardMyLunchtime( time )
         ) {
          ...
      } 
    ```

*   我的目标也是*近乎*单流处理。所以我经常尽量*不做*一个`else`和一个`if`只是偏离共同道路的一步。当您进行大量单流处理时，很难将错误隐藏在代码中，等待一个会跳出并破坏事情的条件。

*   正如我上面所说，如果你使用三元来设置*一个*东西，或者你想要测试少量的案例以便将它设置为一个值，那么我只是*喜欢*三元的*可读性*。

*   有一个警告-->*没有复杂的真实从句*

    ```
     a = b == c ? ( c == d ? ( c == e ? f : g ) : h ) : i; 
    ```

当然可以分解为：

```
a = b != c ? i
  : c != d ? h
  : c == e ? f
  :          g
  ; 
```

它看起来像一个（*压缩*的）真值表。

请记住，还有*更重要*的可读性因素。其中一个是块长度，另一个是缩进级别。在三元组中做简单的事情并不会推动越来越多的缩进级别。

* * *

## 回答 #35

> 赞同：1
> 
> 时间：2011-05-11T20:31:07.723

用它来：

*   访问对象（数组）属性：

    ```
    var status = statuses[error == null ? 'working' : 'stopped']; 
    ```

*   返回语句：

    ```
    function getFullName(){
        return this.isMale() ? "Mr. " : "Ms. " + this.name;
    } 
    ```

*   初始化变量：

    ```
    var formMethod = DEBUG_FLAG == true ? "GET" : "POST"; 
    ```

*   验证参数：

    ```
    function(object){
        var prop1 = typeof object.property == 'undefined'
                  ? "default prop"
                  : object.property;
        //...
    } 
    ```

代码示例在[JavaScript](https://en.wikipedia.org/wiki/JavaScript)中。

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2008-10-02T01:31:58.883

有趣的轶事：我已经看到优化器对三元运算符的权重比等效的*if*更不“重” 。我在 Microsoft 编译器中注意到了这一点，但它可能会更普遍。

特别是像这样的函数会内联：

```
int getSomething()
{
    return m_t ? m_t->v : 0;
} 
```

但这不会：

```
int getSomething()
{
    if( m_t )
        return m_t->v;
    return 0;
} 
```

* * *

## 回答 #37

> 赞同：0
> 
> 时间：2008-10-02T03:31:14.353

我很喜欢。当我使用它时，我把它写成*if-then-else*：条件、真动作和假动作各一行。这样，我可以轻松地嵌套它们。

例子：

```
x = (a == b
     ? (sqrt(a) - 2)
     : (a*a + b*b)
     );

x = (a == b
     ? (sqrt(a) - 2)
     : (a*a + b*b)
     );
x = (a == b
     ? (c > d
        ? (sqrt(a) - 2)
        : (c + cos(d))
       )
     : (a*a + b*b)
     );

```

对我来说，这相当容易阅读。它还可以轻松添加子案例或更改现有案例。

* * *

## 回答 #38

> 赞同：0
> 
> 时间：2008-10-02T07:11:39.690

我使用并推荐三元组以避免在逻辑微不足道的情况下出现代码行。

```
int i;
if( piVal ) {
    i = *piVal;
} else {
    i = *piDefVal;
} 
```

在上述情况下，我会选择三元，因为它的噪音较小：

```
int i = ( piVal ) ? *piVal : *piDefVal; 
```

同样，条件返回值是很好的候选者：

```
return ( piVal ) ? *piVal : *piDefVal; 
```

我认为紧凑性可以提高可读性，从而有助于提高代码质量。

但*可读性*始终取决于代码的受众。

读者必须能够在`a ? b : c`不费任何脑力的情况下理解该模式。如果您无法确定这一点，请选择长版本。

* * *

## 回答 #39

> 赞同：0
> 
> 时间：2008-10-03T19:10:51.890

如果您的三元运算符最终占据整个屏幕宽度，那么我不会使用它。我只检查一个简单的条件并返回单个值：

```
int x = something == somethingElse ? 0 : -1; 
```

我们实际上在生产中有一些像这样令人讨厌的代码......不好：

```
int x = something == (someValue == someOtherVal ? string.Empty : "Blah blah") ? (a == b ? 1 : 2 ): (c == d ? 3 : 4); 
```

* * *

## 回答 #40

> 赞同：0
> 
> 时间：2009-01-07T22:35:27.520

三元运算符对于简洁地生成逗号分隔列表非常有用。这是一个 Java 示例：

```
 int[] iArr = {1, 2, 3};
    StringBuilder sb = new StringBuilder();
    for (int i = 0; i < iArr.length; i++) {
        sb.append(i == 0 ? iArr[i] : ", " + iArr[i]);
    }
    System.out.println(sb.toString()); 
```

它产生：“1、2、3”

否则，最后一个逗号的特殊大小写会变得烦人。

* * *

## 回答 #41

> 赞同：0
> 
> 时间：2009-01-07T22:41:12.517

如果您正在尝试减少代码中的行数或正在重构代码，那么就去做吧。

如果您关心下一个程序员必须多花 0.1 毫秒才能理解表达式，那么无论如何都要去做。

* * *

## 回答 #42

> 赞同：0
> 
> 时间：2009-02-11T01:41:42.490

不，三元运算符*不会*增加复杂性。不幸的是，一些开发人员过于倾向于命令式编程风格，以至于他们拒绝（或不会学习）其他任何东西。我不相信，例如：

```
int c = a < b ? a : b; 
```

比等价物“更复杂”（但更冗长）：

```
int c;
if (a < b) {
    c = a;
} else {
    c = b;
} 
```

或者更尴尬（我见过）：

```
int c = a;
if (!a < b) {
    c = b;
} 
```

也就是说，请根据具体情况仔细查看您的替代方案。假设一个受过适当教育的开发人员，询问哪个最简洁地表达了您的代码的意图并使用那个。

* * *

## 回答 #43

> 赞同：0
> 
> 时间：2009-02-11T01:42:20.193

我曾经在“三元运算符使一行不可读”阵营中，但在过去几年中，我逐渐喜欢适度使用它们。如果团队中的每个人都了解正在发生的事情，单行三元运算符可以提高可读性。这是一种简洁的方法，无需为了花括号而使用大量花括号。

我不喜欢它们的两种情况：如果它们超出 120 列标记太远，或者它们是否嵌入到其他三元运算符中。如果您不能在三元运算符中快速、轻松且可读地表达您正在做的事情。然后使用 if/else 等效项。

* * *

## 回答 #44

> 赞同：0
> 
> 时间：2009-02-11T01:44:19.567

这取决于 ：）

它们在处理可能为空的引用时很有用（顺便说一句：Java 确实需要一种方法来轻松比较两个可能为空的字符串）。

当您在一个表达式中嵌套许多三元运算符时，问题就开始了。

* * *

## 回答 #45

> 赞同：0
> 
> 时间：2009-02-11T01:44:31.047

不（除非它们被滥用）。当表达式是更大表达式的一部分时，三元运算符的使用通常更清晰。

* * *

## 回答 #46

> 赞同：0
> 
> 时间：2009-02-11T02:31:07.690

我认为这实际上取决于它们所使用的上下文。

这样的事情将是一种非常令人困惑的，尽管有效的使用它们的方式：

```
 __CRT_INLINE int __cdecl getchar (void)
{
   return (--stdin->_cnt >= 0)
          ?  (int) (unsigned char) *stdin->_ptr++
          : _filbuf (stdin);
} 
```

然而，这：

```
c = a > b ? a : b; 
```

完全合理。

我个人认为应该在减少过于冗长的 IF 语句时使用它们。问题是人们要么对它们感到害怕，要么非常喜欢它们，以至于几乎完全使用它们而不是 IF 语句。

* * *

## 回答 #47

> 赞同：0
> 
> 时间：2009-02-11T04:16:51.850

字符串 someSay = bCanReadThis ？“否”：“是”；

* * *

## 回答 #48

> 赞同：0
> 
> 时间：2009-02-11T05:00:29.733

在小剂量下，它们可以减少行数并使代码更具可读性；特别是如果结果类似于根据计算结果将 char 字符串设置为“是”或“否”。

例子：

```
char* c = NULL;
if(x) {
  c = "true";
}else {
  c = "false";
} 
```

和....相比：

```
char* c = x ? "Yes" : "No"; 
```

像这样的简单测试中唯一可能出现的错误是分配了不正确的值，但由于条件通常很简单，因此程序员不太可能出错。让你的程序打印出错误的输出并不是世界末日，在所有代码审查、基准测试和生产测试阶段都应该抓住这一点。

我将反驳我自己的论点，现在使用代码覆盖率指标来帮助了解您的测试用例有多好变得更加困难。在第一个示例中，您可以测试两条分配线的覆盖率；如果没有涵盖，那么您的测试不会执行所有可能的代码流。

在第二个示例中，无论 X 的值如何，该行都将显示为正在执行，因此您不能确定您已经测试了备用路径（[YMMV](https://en.wiktionary.org/wiki/YMMV)取决于您的覆盖工具的能力）。

随着测试复杂性的增加，这更重要。

* * *

## 回答 #49

> 赞同：0
> 
> 时间：2009-11-08T16:43:02.747

似乎没有人提到使用三元运算符的原因之一是，至少在像[D](https://en.wikipedia.org/wiki/D_(programming_language))这样支持类型推断的语言中，它允许类型推断适用于非常复杂的模板类型。

```
auto myVariable = fun();
// typeof(myVariable) == Foo!(Bar, Baz, Waldo!(Stuff, OtherStuff)).

// Now I want to declare a variable and assign a value depending on some
// conditional to it.
auto myOtherVariable = (someCondition) ? fun() : gun();

// If I didn't use the ternary I'd have to do:
Foo!(Bar, Baz, Waldo!(Stuff, OtherStuff)) myLastVariable;  // Ugly.
if(someCondition) {
    myLastVariable = fun();
} else {
    myLastVariable = gun():
} 
```

* * *

## 回答 #50

> 赞同：0
> 
> 时间：2010-03-05T20:25:54.453

在某些情况下我喜欢操作符，但我认为有些人倾向于过度使用它并且它会使代码更难阅读。

我最近在我正在修改的一些开源代码中偶然发现了这一行。

在哪里

```
 (active == null ? true :
    ((bool)active ? p.active : !p.active)) &&... 
```

代替

```
where ( active == null || p.active == active) &&... 
```

我想知道在这种情况下，三元使用是否会增加[LINQ](https://en.wikipedia.org/wiki/Language_Integrated_Query)语句的额外开销。

* * *

## 回答 #51

> 赞同：0
> 
> 时间：2010-03-05T21:10:10.223

我同意这里许多海报的观点。三元运算符是完全有效的，只要它使用正确并且不会引入歧义（公平地说，您可以说任何运算符/构造）。

我经常在嵌入式代码中使用三元运算符来阐明我的代码在做什么。采取以下（为清楚起见，过度简化）代码示例：

片段1：

```
int direction = read_or_write(io_command);

// Send an I/O
io_command.size = (direction==WRITE) ? (32 * 1024) : (128 * 1024);
io_command.data = &buffer;
dispatch_request(io_command); 
```

片段 2：

```
int direction = read_or_write(io_command);

// Send an I/O
if (direction == WRITE) {
    io_command.size = (32 * 1024);
    io_command.data = &buffer;
    dispatch_request(io_command);
} else {
    io_command.size = (128 * 1024);
    io_command.data = &buffer;
    dispatch_request(io_command);
} 
```

在这里，我正在发送一个输入或输出请求。无论请求是读还是写，过程都是一样的，只是默认的 I/O 大小发生了变化。在第一个示例中，我使用三元运算符来表明过程是相同的，并且`size`字段根据 I/O 方向获得不同的值。在第二个示例中，这两种情况的算法是否相同并不清楚（尤其是当代码长于三行时）。第二个例子更难保持公共代码同步。在这里，三元运算符在表达代码的大部分并行性质方面做得更好。

三元运算符还有另一个优势（尽管这通常只是嵌入式软件的问题）。一些编译器只有在代码没有“嵌套”超过一定深度时才能执行某些优化（意味着在函数内部，每次输入 if、循环或 switch 语句时嵌套深度增加 1，当你离开它）。有时，使用三元运算符可以最大限度地减少需要在条件中的代码量（有时到编译器可以优化掉条件的程度）并且可以减少代码的嵌套深度。在某些情况下，我能够使用三元运算符（如上面的示例）重新构造一些逻辑，并减少函数的嵌套深度，使编译器可以对其执行额外的优化步骤。

* * *

## 回答 #52

> 赞同：0
> 
> 时间：2011-04-01T06:45:18.763

使代码更小并不总是意味着更容易解析。它因语言而异。

例如，在[PHP](https://en.wikipedia.org/wiki/PHP)中，鼓励使用空格和换行符，因为 PHP 的词法分析器首先将代码分解为以换行符开头的位，然后是空格。所以我没有看到性能问题，除非使用较少的空格。

坏的：

```
($var)?1:0; 
```

好的：

```
($var) ? 1 : 0; 
```

这似乎不是一个大问题，但是在 PHP 中对代码进行词法分析时，空格是必不可少的。另外，这样读起来也更好一些。

* * *

## 回答 #53

> 赞同：-1
> 
> 时间：2008-10-02T00:49:04.023

如果没有三元运算符，谁会赢得混淆代码竞赛？！

我个人喜欢在适当的时候使用它，但我认为我永远不会嵌套它。它非常有用，但它有一些缺点，因为它使代码更难阅读，并且在其他一些语言的其他操作中使用（例如[Groovy](https://en.wikipedia.org/wiki/Groovy_%28programming_language%29)的 null-check）。

* * *

## 回答 #54

> 赞同：-2
> 
> 时间：2008-10-01T23:57:42.183

我是它的忠实粉丝......在适当的时候。

像这样的东西很棒，而且，就个人而言，我觉得阅读/理解并不难：

```
$y = ($x == "a" ? "apple"
   : ($x == "b" ? "banana"
   : ($x == "c" ? "carrot"
   : "default"))); 
```

不过，我知道这可能会让很多人感到畏缩。

在 PHP 中使用它时要记住的一件事是它如何与返回引用的函数一起工作。

```
class Foo {
    var $bar;

    function Foo() {
        $this->bar = "original value";
    }

    function &tern() {
        return true ? $this->bar : false;
    }

    function &notTern() {
        if (true) return $this->bar;
        else      return false;
    }
}

$f = new Foo();
$b =& $f->notTern();
$b = "changed";
echo $f->bar;  // "changed"

$f2 = new Foo();
$b2 =& $f->tern();
$b2 = "changed";
echo $f2->bar;  // "original value" 
```

# c# - ASP.net Web App 撤消支持

> ID：160222
> 
> 赞同：4
> 
> 时间：2008-10-01T23:29:39.520
> 
> 标签：c#, asp.net, web-applications, undo

我有一个简单的 web 表单，上面有几个字段和一个 gridview。我还有一个保存和取消按钮。

我想要一种方法来撤消用户按下取消时对表单上的数据所做的操作。这对于字段来说很简单，但是由于对 gridview 的更改是针对数据库实时发生的，所以我不知道如何获得撤消功能。

我曾考虑在视图状态中存储对 gridview 的更改，但我宁愿不这样做，因为需要额外的空间。

我还想到了一个临时表来存储更改然后根据需要回滚它们。

有谁知道如何从表单中获取撤消功能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-01T23:36:05.027

将所有数据保存在会话对象中，并在准备好时将其写入数据库。如果您抽象数据层，您可以使用与会话对象交互的 ObjectDataSource。

我目前在电子商务网站的结帐系统上使用此方法。我将数据存储在模仿数据库模式的自定义对象中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-01T23:38:37.110

最简单的解决方案是在用户单击“保存”按钮之前，不要将 gridview 中的更改提交到数据库。

如果您确实决定使用视图状态或类似的方式来记录稍后将撤消的更改，请不要忘记采取与进行初始更改时相同的预防措施：更新冲突。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-01T23:33:30.960

一种方法是将对表的更改与时间戳和该应用程序实例的标识符一起存储在另一个表中。如果您想撤消自特定时间以来的更改，您只需向后遍历列表直到该标识符的该日期。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-01T23:53:46.200

嗯...将数据对象加载到会话中并从`(MyObject)Session["MyObject"]`对象绑定控件。我相信您可以连接到 ObjectDataSource 以使用会话......然后您可以覆盖更新事件，以便将更改写入会话。

当用户单击保存时，获取会话对象并保存它们：`MyObject obj = (MyObject)Session["MyObject"]; MyObject.Save()`

它不会给你多个级别的撤消......虽然我猜你可以保存多个会话对象，如果你真的需要的话。

# mysql - mysql error 1025 (HY000): Error on rename of './foo' (errorno: 150) 是什么意思？

> ID：160233
> 
> 赞同：163
> 
> 时间：2008-10-01T23:33:21.787
> 
> 标签：mysql, mysql-error-1025

我在mysql中试过这个：

```
mysql> alter table region drop column country_id; 
```

得到了这个：

```
ERROR 1025 (HY000): Error on rename of './product/#sql-14ae_81' to
'./product/region' (errno: 150) 
```

有任何想法吗？外键的东西？

* * *

## 回答 #1

> 赞同：242
> 
> 时间：2011-04-11T00:45:46.720

如果您的表使用 InnoDB 引擎，您通常会收到此错误。在这种情况下，您必须删除外键，然后执行更改表并删除列。

但棘手的部分是您不能使用列名删除外键，而是必须找到用于索引它的名称。要找到它，请发出以下选择：

> 显示创建表区域；

这应该会显示索引的名称，如下所示：

> 约束`region_ibfk_1`外键 ( `country_id`) 引用 `country`( `id`) ON DELETE NO ACTION ON UPDATE NO ACTION

现在只需发出一个：

> 更改表区域删除外键 `region_ibfk_1`；

最后一个：

> 更改表区域删除列 country_id；

你很高兴去！

* * *

## 回答 #2

> 赞同：173
> 
> 时间：2008-10-07T17:24:10.183

确实是外键错误，可以用perror查出来：

```
shell$ perror 150
MySQL error code 150: Foreign key constraint is incorrectly formed 
```

要了解有关失败的更多详细信息，您可以使用`SHOW ENGINE INNODB STATUS`并查找 LATEST FOREIGN KEY ERROR 部分，其中包含有关错误的详细信息。

在您的情况下，很可能是因为某些内容正在引用 country_id 列。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-10-22T08:40:08.207

尝试删除不存在的外键时也会出现此错误。因此，在删除外键时，请始终确保它们确实存在。

如果外键确实存在，并且您仍然收到此错误，请尝试以下操作：

```
SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL'; 
```

// 把外键放在这里！

```
SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS; 
```

这总是对我有用:)

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2013-02-21T08:05:32.503

只需在 drop 语句中使用 'KEY' 而不是 'FOREIGN KEY' 运行 alter table 查询。我希望它有助于解决问题，并且会删除外键约束，您可以更改表列并删除表。

```
ALTER TABLE slide_image_sub DROP  KEY  FK_slide_image_sub; 
```

在这里`DROP KEY`而不是`DROP FOREIGN KEY`,

希望它会有所帮助。

谢谢

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2017-01-09T08:25:49.983

我知道，这是一篇旧帖子，但如果您正在寻找错误 1025，它是每个人最喜欢的搜索引擎上的第一次点击。

但是，有一个简单的“hack”可以解决这个问题：

在执行命令之前，您首先必须使用以下命令禁用外键约束检查：

```
SET FOREIGN_KEY_CHECKS = 0; 
```

然后你就可以执行你的命令了。

完成后，不要忘记再次启用外键约束检查，使用以下命令：

```
SET FOREIGN_KEY_CHECKS = 1; 
```

祝你工作顺利。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-01-12T05:40:40.143

我曾经有过类似的问题。我从表 A 中删除了主键，但是当我试图从表 BI 中删除外键列时，显示了上述相同的错误。

您不能使用列名删除外键，并且要在 PHPMyAdmin 或 MySQL 中绕过它，请先删除外键约束，然后再重命名或删除属性。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-03-16T16:39:32.613

查看 mysql 数据库的错误文件。根据[Bug #26305](http://bugs.mysql.com/bug.php?id=26305)我的 sql 没有给你原因。这个错误自 MySQL 4.1 起就存在 ;-)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-01-08T20:25:24.310

如果您使用的是 MySQL Workbench 之类的客户端，请右键单击要从中删除外键的所需表，然后选择外键选项卡并删除索引。

然后你可以像这样运行查询：

```
alter table table_name drop foreign_key_col_name; 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-01-11T13:24:13.153

可能还有另一个表，其中的外键引用了您尝试更改的主键。

要找出导致错误的表，您可以运行`SHOW ENGINE INNODB` `STATUS`，然后查看该`LATEST FOREIGN KEY ERROR`部分

使用 SHOW CREATE TABLE 类别来显示约束的名称。

很可能是 categories_ibfk_1

使用名称先删除外键，然后使用列：

```
ALTER TABLE categories DROP FOREIGN KEY categories_ibfk_1;
ALTER TABLE categories DROP COLUMN assets_id; 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2019-01-04T21:27:27.007

我在 MySQL 5.6 中遇到了这个错误，但它与外键无关。这是在 Windows 7 Professional 机器上充当小型 LAN 上的服务器。

客户端应用程序正在执行一个批处理操作，该操作创建一个表，用一些外部数据填充它，然后运行一个与永久表连接的查询，然后删除“临时”表。这批执行此操作大约 300 次，并且这个特定的例程已经连续运行了好几年，突然我们在批次中的随机点收到错误 1025 无法重命名问题。

在我的例子中，应用程序使用 4 个 DDL 语句，一个 CREATE TABLE，后跟 3 个 CREATE INDEX，没有外键。然而，实际上只有 2 个索引被创建，并且实际的表 .frm 文件在发生故障时被重命名。

我的解决方案是摆脱单独的 CREATE INDEX 语句并使用 CREATE TABLE 语句创建它们。在撰写本文时，这已经为我解决了这个问题，我帮助其他人在找到这个线程时挠头。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-01T23:42:07.400

我猜是外键约束问题。country_id 是否在另一个表中用作外键？

我不是数据库专家，但我认为我通过删除 fk、执行更改表的内容然后重做 fk 的内容来解决了这样的问题（存在 fk 约束）。

我很想知道结果是什么——有时 mysql 非常神秘。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-02-25T07:51:34.100

就我而言，我使用的是 MySQL 工作台，并且在将我的一列放入表中时遇到了同样的问题。我找不到外键的名称。我按照以下步骤解决了这个问题：

1.  室温。单击您的架构并选择“架构检查器”。这为您提供了各种表、列、索引等。

2.  转到名为“索引”的选项卡并在名为“列”的列下搜索列的名称。找到后，在列名“表”下检查该记录的表名。如果它与您想要的表的名称匹配，则从名为“名称”的列中记下外键的名称。

3.  现在执行查询： ALTER table tableNamexx DROP KEY foreignKeyName;

4.  现在您可以执行将成功执行的 drop 语句。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-01-14T16:25:35.633

正在做

```
SET FOREIGN_KEY_CHECKS=0; 
```

在操作之前也可以做到这一点。

* * *

## 回答 #14

> 赞同：-2
> 
> 时间：2020-04-01T12:00:32.033

averageRatings= FOREACH groupedRatings **GENERATE group AS** movieID, AVG(ratings.rating) AS avgRating, COUNT(ratings.rating) AS numRatings;

如果您使用上述任何命令，则必须使用小写字母组。这可能会解决你的问题，它解决了我的问题。至少在 PIG 脚本中。

# python - 使用 python 获取 unix 中正在运行的进程列表的最佳方法是什么？

> ID：160245
> 
> 赞同：2
> 
> 时间：2008-10-01T23:37:06.257
> 
> 标签：python

我正在努力：

```
import commands
print commands.getoutput("ps -u 0") 
```

但它不适用于 os x。os 而不是 commands 给出相同的输出： USER PID %CPU %MEM VSZ RSS TT STAT STARTED TIME COMMAND

而已

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-02T00:29:39.483

这适用于 Mac OS X 10.5.5。注意大写**-U**选项。也许那是你的问题。

```
import subprocess
ps = subprocess.Popen("ps -U 0", shell=True, stdout=subprocess.PIPE)
print ps.stdout.read()
ps.stdout.close()
ps.wait() 
```

这是 Python 版本

```
Python 2.5.2 (r252:60911, Feb 22 2008, 07:57:53) 
[GCC 4.0.1 (Apple Computer, Inc. build 5363)] on darwin 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2011-06-07T12:51:23.573

如果操作系统支持 /proc fs 你可以这样做：

```
>>> import os
>>> pids = [int(x) for x in os.listdir('/proc') if x.isdigit()]
>>> pids
[1, 2, 3, 6, 7, 9, 11, 12, 13, 15, ... 9406, 9414, 9428, 9444]
>>> 
```

跨平台解决方案（linux、freebsd、osx、windows）是使用[psutil](http://code.google.com/p/psutil/)：

```
>>> import psutil
>>> psutil.pids()
[1, 2, 3, 6, 7, 9, 11, 12, 13, 15, ... 9406, 9414, 9428, 9444]    
>>> 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-01T23:52:13.567

的跨平台替换`commands`是`subprocess`. 请参阅[子流程模块文档](http://docs.python.org/lib/module-subprocess.html)。“替换旧模块”部分包括[如何从命令获取输出](http://docs.python.org/lib/node534.html)。

当然，您仍然需要将正确的参数传递给您所在平台的“ps”。Python 帮不了你，虽然我偶尔看到有人提到尝试这样做的第三方库，但它们通常只在少数系统上工作（比如严格的 SysV 风格，严格的 BSD 风格，或者只是系统/过程。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-02T00:06:46.187

我在 OS X (10.5.5) 上试过，似乎工作得很好：

```
print commands.getoutput("ps -u 0")

UID   PID TTY           TIME CMD
0     1 ??         0:01.62 /sbin/launchd
0    10 ??         0:00.57 /usr/libexec/kextd 
```

等等

Python 2.5.1

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-09-14T16:31:31.083

上述任何 python 调用 - 但尝试 'pgrep

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-01T23:45:01.137

如果您使用 os 而不是命令，它会起作用：

```
import os
print os.system("ps -u 0") 
```

# apache-flex - Flex：修改嵌入式图标并在按钮中使用它？

> ID：160250
> 
> 赞同：1
> 
> 时间：2008-10-01T23:38:17.300
> 
> 标签：apache-flex, flash, image, icons

就是这样，如果你嵌入一个图标：

```
[Embed(source='icons/checkmark.png')]
private static var CheckMark:Class; 
```

你最终得到一个动态类。您可以通过调用 setStyle 方法在运行时轻松地将图标分配给按钮：

```
var btn:Button = new Button();
btn.setStyle("icon", CheckMark); 
```

但是，如果您想在运行时更改图标，例如更改它的 alpha 值甚至重绘像素，然后再将其分配给按钮，该怎么办？

到目前为止，我找不到满意的答案...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-02T05:05:50.163

这是我能找到的唯一似乎很接近的答案：[动态图标](http://blog.xsive.co.nz/archives/234) [（带有查看源代码的示例）](http://blog.xsive.co.nz/flex_source/button_icon_drawing/ButtonTest.html)

他的解决方案包括在按钮的图标设置中使用的自定义“DynamicIcon”类，以及向 Button 类添加一种方法来绘制动态图标的自定义 Button 类。

最终结果是您能够将 BitmapData 发送到 DynamicIcon 类，该类将显示在按钮中。因此，嵌入您的图像，实例化您的资产类，获取 bitmapasset 并根据需要修改它并将 bitmapData 发送到图标。

这是一个有趣的问题，似乎应该有一个更简单的解决方案，但这并不麻烦。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-02T17:35:31.203

我解决这个问题的方法是实现一个手动绘制图标本身的编程皮肤类。您可能需要做更多的工作来确保按钮计算正确的大小，就好像它有一个图标一样，即使它没有。您可能需要翻阅 Button 源代码才能查看对图标的引用是如何存储的。

我喜欢创建完全符合我要求的程序化皮肤，然后使用有趣的 CSS 声明来修改状态——例如：

```
button.setStyle("customIconAlpha", .4); 
```

然后当然皮肤或自定义按钮类将具有：

```
var alpha:Number = getStyle("customIconAlpha") as Number; 
```

（不确定您是否必须对那个进行类型转换）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T16:10:20.377

我发现程序化皮肤的一个大问题是按钮拒绝测量宽度/高度。我通过覆盖每个 get 方法轻松地解决了这个问题：

覆盖公共函数 get width():Number { return WIDTH; } 覆盖公共函数 get height():Number { return HEIGHT; }

在我的情况下，我需要修改 TabNavigator 中的按钮，因此没有简单的方法来子类化按钮。幸运的是，每个皮肤的父级都是按钮，因此在皮肤中使用静态方法，您可以识别图标皮肤所属的按钮实例。

如果您使用覆盖所有的“图标”样式，将为每个状态创建一个新的皮肤对象。因此，在更改图标状态时需要牢记这一点。

# vb.net - 我无法摆脱的 VS.NET 2008 (VB.NET) 中的编译错误！

> ID：160267
> 
> 赞同：7
> 
> 时间：2008-10-01T23:43:34.027
> 
> 标签：vb.net, visual-studio-2008, debugging, compiler-construction, windows-vista

在编译我的 Visual Studio.NET 2008 解决方案时，我无法摆脱这个错误。产生错误的项目是 12 个项目解决方案（混合类型和语言）中的 VB.NET Web 应用程序。

我已经尝试了在谷歌上可以找到的所有技巧，以及手动删除目录和文件夹的明显方法。

我正在使用 VS.NET 2008 SP1 运行 Vista Business 32。这只是今天突然发生的事情，我重新启动了一堆，甚至为 VS.NET 重新应用了 SP1。

有什么想法或有人看过吗？

vbc：**错误 BC31019**：**无法写入输出文件**“G:\Projects\TCA.NET\TcaNet\WebUI\obj\Debug\TcaNet.WebUI.pdb”：**未指定的错误**

**更新：**

在考虑了这一点并且没有从答案或通过互联网找到任何解决方案之后，我继续将我的整个解决方案移动到我的 C:\ 驱动器与我的 G:\ 驱动器（两者都是本地的）。由于某种原因，这样做解决了我的编译问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-02T00:48:40.233

几周前，当我从笔记本电脑在服务器上编译时，我遇到了同样的错误。事实证明，如果 G: 是网络驱动器，这可能会失败。微软已经表示解决这个问题不是优先事项，并且有更好的做事方式（例如源代码控制）。不过，对于一个人的项目来说，这是一种痛苦。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-02T00:23:36.083

在本地重新启动 IIS。

如果这不是问题，那么安装[Unlocker](http://www.emptyloop.com/unlocker/)并在出现错误时尝试删除该 pdb 文件，Unlocker 会告诉您哪个进程正在持有该文件的打开句柄。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-01T23:50:51.760

我找到了一个清单来尝试解决您的问题：

[Zen-turkey 修复列表](http://zen-turkey.com/blog/default.aspx?id=34&t=Visual-Studio-2005-VBC-Error-BC31019-Un)

希望这有帮助！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-01T23:59:14.253

也许这是一个依赖问题。检查所有项目的构建顺序..

sysinternals 工具在这里应该有所帮助。使用进程资源管理器，您是否能够找出是否有任何进程正在锁定此文件？另一个有用的工具是进程监视器。为 pdb 文件应用过滤器后，捕获所有文件访问活动的跟踪。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-05-26T15:17:06.627

这可能是 VB.NET 编译器中的错误。错误消息不正确，真正的问题是缺少从项目文件中引用的文件。例如 .vb 文件。就我而言，我找到了丢失的文件并添加了它，然后 devenv 再次编译得很好。

[有人在这里](http://connect.microsoft.com/VisualStudio/feedback/details/218639/wrong-error-description#details)向 MS 报告

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-12-20T12:22:36.530

虽然它是很老的线程，但我今天收到了这个错误，下面的链接解决了它。希望它对阅读本文的人有所帮助。

[VB.NET .pdb 修复](https://stackoverflow.com/questions/627523/unable-to-create-pdb-file)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-02T13:14:43.203

在考虑了这一点并且没有从答案或通过互联网找到任何解决方案之后，我继续将我的整个解决方案移动到我的 C:\ 驱动器与我的 G:\ 驱动器（两者都是本地的）。由于某种原因，这样做解决了我的编译问题。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-07-04T12:07:07.557

我在 Visual Studio 2005 中有这个，除了错误 1。我重新启动了我的机器，它解决了这个问题。

# c# - 开源 C++ 到 C# 编译器/转换器

> ID：160281
> 
> 赞同：5
> 
> 时间：2008-10-01T23:51:54.317
> 
> 标签：c#, c++, open-source, compiler-construction, converter

即使它需要手动输入。有没有足够好的选择？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-01T23:53:57.213

我对这个网站一无所知，但是通过谷歌搜索发现[了这个](http://code2code.net/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-02T04:09:26.633

如果它在托管 C++ 或 C++/CLI 中，您可以编译它，然后使用 Reflector 之类的工具将程序集反汇编成 C#。当然，这不是开源的，但也许你可以找到一个开源的 Reflector 风格的工具？

如果是原生 C++，那就更难了。

# .net - 如何更新没有数据上下文的对象

> ID：160288
> 
> 赞同：9
> 
> 时间：2008-10-01T23:55:27.290
> 
> 标签：.net, vb.net, entity-framework

实体框架提供了极大的灵活性来更新同一数据上下文中的数据

```
Dim personA = (from p in datacontext.Person where p.PersonID = 1 select p)
personA.name = txtName.value
datacontext.savechanges() 
```

如果我必须将此更新功能移动到仅在请求中使用“Person”的服务层，那么将我的“Person”请求对象分配到数据上下文而不再次进行深度复制的最佳方法是什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-02T20:39:46.813

您需要将实体对象附加到数据上下文。

您还需要使用 AttachUpdeted 方法扩展您的数据上下文部分类。当您将对象附加到数据上下文时，它不知道已经进行了更新。下面的代码将告诉数据上下文每个属性已更新并需要写入数据库。

```
public static void Save(EntityObject entity)
{
   using(MyContext ctx = new MyContext)
   {
     ctx.AttachUpdated(entity);
     ctx.SaveChanges();
   }  
} 

public static void AttachUpdated(this ObjectContext obj, EntityObject objectDetached)
{
   if (objectDetached.EntityState == EntityState.Detached)
   {
      object original = null;
      if (obj.TryGetObjectByKey(objectDetached.EntityKey, out original))
         obj.ApplyPropertyChanges(objectDetached.EntityKey.EntitySetName, objectDetached);
      else
       throw new ObjectNotFoundException();
    }
} 
```

[第 1](http://geeks.ms/blogs/quintas/archive/2008/02/21/ado-net-entity-framework-attaching-detached-objects-in-short-lived-contexts.aspx)
[条 第 2 条](http://msdn.microsoft.com/en-us/magazine/cc700340.aspx)

# c - 我应该释放 Linux 中 getpwuid() 返回的指针吗？

> ID：160290
> 
> 赞同：7
> 
> 时间：2008-10-01T23:56:41.450
> 
> 标签：c, linux, getpwuid

在我调用之后`getpwuid(uid)`，我有一个指针的引用。当我不再使用它时，我应该释放它吗？阅读手册页，它说它引用了一些静态区域，可能会被后续调用相同的函数覆盖，所以我不确定我是否应该触摸那个内存区域。

谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-02T00:04:07.627

不，您不需要释放结果。您只能在使用 malloc(3)、calloc(3) 或 realloc(3) 分配在堆上的指针上调用 free(3)。

静态数据是程序数据或 bss 段的一部分，并且将持续存在直到进程退出（或被 exec(2) 覆盖）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-02T13:22:28.253

将`*_r`函数 ( `getpwuid_r()`) 用于线程安全（可重入）函数，允许您提供缓冲区空间来放置返回的信息。请务必检查 errno 以了解成功或失败。如果您不使用可重入函数，您可以安全地假设该函数返回的数据不需要释放，但也会被对同一函数的连续调用覆盖。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-02T00:03:33.417

实际上它返回一个指向已经存在的结构的指针，所以你不应该**释放**它。

# c++ - 如何从库函数中访问 c ++ 中的 argc 和 argv

> ID：160292
> 
> 赞同：9
> 
> 时间：2008-10-01T23:56:56.223
> 
> 标签：c++, visual-c++, gcc

我正在编写一个要在 C++ 中动态加载的库。

我想从我的代码中读取 argc 和 argv（出于调试原因），但是我无权访问 main 函数。有什么方法可以检索命令行（Windows 和 Linux 解决方案都很好）。

谢谢，丹

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-02T00:05:01.353

在 Linux 上，伪文件 /proc/self/cmdline 包含进程的命令行。每个参数都以 0 字节结束，最后一个参数后跟一个额外的 0 字节。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-10-01T23:58:27.390

Win32 API 中有 GetCommandLine() 函数。在其他平台上，您必须将 argc/argv 保存在某个地方（外部变量？）。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-02T02:07:47.860

在 Windows 上，您可以通过 __argc 和 __argv 访问 argc/argv。__wargv 如果你想要宽字符版本。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-02T00:14:00.550

该线程显示了如何在 Linux 上执行此操作。

[http://linux.derkeiler.com/Newsgroups/comp.os.linux.development.system/2005-07/0147.html](http://linux.derkeiler.com/Newsgroups/comp.os.linux.development.system/2005-07/0147.html)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-02T00:16:32.590

我可以建议这听起来像一个奇怪的情况。你是在写插件还是什么？也许您不应该访问 argv/argc？

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-10-02T00:47:09.567

在 Windows 中，您可以使用[GetCommandLine()](http://msdn.microsoft.com/en-us/library/ms683156(VS.85).aspx)获取指向命令行的指针，然后使用[CommandLineToArgvW()](http://msdn.microsoft.com/en-us/library/bb776391(VS.85).aspx)将该指针转换为 argv[] 格式。不过，只有一个广泛的 (Unicode) 版本可用。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-02T02:32:11.453

在 Windows 上，我使用这种类型的东西来获取参数：

```
 #include <windows.h>
#include <string>
#include <vector>
#include <cwchar>
#include <cstdio>
#include <clocale>
using namespace std;

vector<wstring> getArgs() {
    int argc;
    wchar_t** argv = CommandLineToArgvW(GetCommandLineW(), &argc);
    vector<wstring> args;
    if (argv) {
        args.assign(argv, argv + argc);
        LocalFree(argv);
    }
    return args;
}

int main() {
    const vector<wstring> argv = getArgs();
    setlocale(LC_CTYPE, ".OCP");
    for (vector<wstring>::const_iterator i = argv.begin(); i != argv.end(); ++i) {
        wprintf(L"%s\n", i->c_str());
    }
} 
```

编辑：像这样的 getArgs 函数对 mingw 也很有用，因为 mingw 不支持 wmain()。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-12-20T22:47:41.263

这应该在linux下工作：

```
#include <stdio.h>
#include <unistd.h>

void findargs(int *argc, char ***argv) {
    size_t i;
    char **p = &__environ[-2];
    for (i = 1; i != *(size_t*)(p-1); i++) {
        p--;
    }
    *argc = (int)i;
    *argv = p;
}

int main(int argc, char **argv) {
    printf("got argc=%d, argv=%p\n", argc, argv);
    findargs(&argc, &argv);
    printf("found argc=%d, argv=%p\n", argc, argv);
    return 0;
} 
```

*注意：如果 setenv() 已被调用，则失败。*

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-02T01:11:54.360

使用 getpid() 和 ps 命令。

国际PID；

诠释 fd;

字符 cmd[80];

pid = getpid();

sprintf(cmd, "ps %d", pid);

fd = popen(cmd, "r");

....线条应该像

.... 1358 ./a.out abc def

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-02T02:42:06.390

您是否考虑过使用环境变量而不是命令行？根据库将用于哪种应用程序，用户可能会更容易，您可以使用标准的 getenv() 函数。

我认为，无论如何，如果您的库要使用 argc 和 argv，则程序应该是传递它们的程序。

# javascript - OpenSocial 小工具应用程序中的本地化

> ID：160296
> 
> 赞同：2
> 
> 时间：2008-10-01T23:58:55.813
> 
> 标签：javascript, localization, internationalization, opensocial

我正在尝试向 OpenSocial 应用程序添加多语言支持。我看到我可以在小工具 XML 标记中链接到我自己的消息包：

```
<Module>
  <ModulePrefs title="Hello" description="Message bundle demo">
     <Require feature="opensocial-0.7"/>
     <Locale lang="en" messages="http://example.com/hello/en_ALL.xml"/>
  </ModulePrefs>
  . . .
</Module> 
```

但是我如何真正从它们中提取值呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-06T16:34:45.370

要提取值，您应该使用[getMsg](http://code.google.com/apis/opensocial/docs/0.7/reference/gadgets.Prefs.html#getMsg)方法

```
var prefs = new gadgets.Prefs();
var msg = prefs.getMsg('hello_world'); 
```

# python - Django/Python - 通过多对多关系中的公共集合对对象进行分组

> ID：160298
> 
> 赞同：8
> 
> 时间：2008-10-01T23:59:52.723
> 
> 标签：python, django, algorithm, puzzle

这是部分算法逻辑问题（如何做），部分实施问题（如何做到最好！）。我正在与 Django 一起工作，所以我想我会与它分享。

在 Python 中，值得一提的是，该问题与[how-do-i-use-pythons-itertoolsgroupby](https://stackoverflow.com/questions/773/how-do-i-use-pythons-itertoolsgroupby)有点相关。

假设你有两个 Django 模型派生类：

```
from django.db import models

class Car(models.Model):
    mods = models.ManyToManyField(Representative) 
```

和

```
from django.db import models

class Mods(models.Model):
   ... 
```

一个人如何获得一个汽车列表，按汽车和一组通用的 Mod 分组？

即我想像这样上课：

```
Cars_by_common_mods = [ 
  { mods: { 'a' }, cars: { 'W1', 'W2' } },
  { mods: { 'a', 'b' }, cars: { 'X1', 'X2', 'X3' }, },
  { mods: { 'b' }, cars: { 'Y1', 'Y2' } },
  { mods: { 'a', 'b', 'c' }, cars: { 'Z1' } },
] 
```

我一直在想类似的东西：

```
def cars_by_common_mods():
  cars = Cars.objects.all()

  mod_list = []      

  for car in cars:
    mod_list.append( { 'car': car, 'mods': list(car.mods.all()) } 

  ret = []

  for key, mods_group in groupby(list(mods), lambda x: set(x.mods)):
    ret.append(mods_group)

  return ret 
```

但是，这不起作用，因为（可能还有其他原因） groupby 似乎没有按 mods 集分组。我猜必须对 mod_list 进行排序才能与 groupby 一起使用。总而言之，我相信那里有一些简单而优雅的东西，既具有启发性又具有启发性。

*干杯&谢谢！*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-02T06:20:53.227

您是否尝试过先对列表进行排序？您提出的算法应该可以工作，尽管有很多数据库命中。

```
import itertools

cars = [
    {'car': 'X2', 'mods': [1,2]},
    {'car': 'Y2', 'mods': [2]},
    {'car': 'W2', 'mods': [1]},
    {'car': 'X1', 'mods': [1,2]},
    {'car': 'W1', 'mods': [1]},
    {'car': 'Y1', 'mods': [2]},
    {'car': 'Z1', 'mods': [1,2,3]},
    {'car': 'X3', 'mods': [1,2]},
]

cars.sort(key=lambda car: car['mods'])

cars_by_common_mods = {}
for k, g in itertools.groupby(cars, lambda car: car['mods']):
    cars_by_common_mods[frozenset(k)] = [car['car'] for car in g]

print cars_by_common_mods 
```

现在，关于这些查询：

```
import collections
import itertools
from operator import itemgetter

from django.db import connection

cursor = connection.cursor()
cursor.execute('SELECT car_id, mod_id FROM someapp_car_mod ORDER BY 1, 2')
cars = collections.defaultdict(list)
for row in cursor.fetchall():
    cars[row[0]].append(row[1])

# Here's one I prepared earlier, which emulates the sample data we've been working
# with so far, but using the car id instead of the previous string.
cars = {
    1: [1,2],
    2: [2],
    3: [1],
    4: [1,2],
    5: [1],
    6: [2],
    7: [1,2,3],
    8: [1,2],
}

sorted_cars = sorted(cars.iteritems(), key=itemgetter(1))
cars_by_common_mods = []
for k, g in itertools.groupby(sorted_cars, key=itemgetter(1)):
    cars_by_common_mods.append({'mods': k, 'cars': map(itemgetter(0), g)})

print cars_by_common_mods

# Which, for the sample data gives me (reformatted by hand for clarity)
[{'cars': [3, 5],    'mods': [1]},
 {'cars': [1, 4, 8], 'mods': [1, 2]},
 {'cars': [7],       'mods': [1, 2, 3]},
 {'cars': [2, 6],    'mods': [2]}] 
```

现在您已经获得了汽车 id 和 mod id 的列表，如果您需要使用完整的对象，您可以为每个对象执行一个查询以获得每个模型的完整列表并`dict`为这些对象创建一个查找，由他们的身份证——那么，我相信，鲍勃是你众所周知的父亲的兄弟。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-02T01:58:49.957

检查[重组](http://docs.djangoproject.com/en/dev//ref/templates/builtins/#regroup)。它仅适用于模板，但我想这种分类无论如何都属于表示层。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-02T07:38:59.593

你在这里有几个问题。

在调用 groupby 之前您没有对列表进行排序，这是必需的。从[itertools 文档](http://www.python.org/doc/2.5/lib/itertools-functions.html)：

> 通常，iterable 需要已经在相同的 key 函数上排序。

然后，您不会复制 groupby 返回的列表。同样，文档指出：

> 返回的组本身就是一个迭代器，它与 groupby() 共享底层迭代。因为源是共享的，所以当 groupby 对象前进时，之前的组不再可见。因此，如果以后需要该数据，则应将其存储为列表：
> 
> ```
> groups = []
> uniquekeys = []
> for k, g in groupby(data, keyfunc):
>     groups.append(list(g))      # Store group iterator as a list
>     uniquekeys.append(k) 
> ```

最后一个错误是使用集合作为键。他们不在这里工作。一个快速的解决方法是将它们转换为排序的元组（可能有更好的解决方案，但我现在想不出）。

因此，在您的示例中，最后一部分应如下所示：

```
sortMethod = lambda x: tuple(sorted(set(x.mods)))
sortedMods = sorted(list(mods), key=sortMethod)
for key, mods_group in groupby(sortedMods, sortMethod):
    ret.append(list(mods_group)) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-06T08:41:56.680

如果性能是一个问题（即一个页面上有很多汽车，或者一个高流量的站点），[非规范化](http://groups.google.com/group/django-developers/browse_thread/thread/9a672d5bbbe67562)是有意义的，并将您的问题简化为副作用。

请注意，非规范化多对多关系可能有点棘手。我还没有遇到任何这样的代码示例。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-07T14:17:42.883

谢谢大家的有用回复。我一直在解决这个问题。一个“最好的”解决方案仍然让我望而却步，但我有一些想法。

我应该提到我正在使用的数据集的统计数据。在 75% 的情况下，会有一个 Mod。在 24% 的情况下，两个。在 1% 的情况下，将有 0 个或三个或更多。对于每个 Mod，至少有一辆独特的汽车，尽管一个 Mod 可以应用于许多汽车。

话虽如此，我已经考虑过（但未实施）类似的事情：

```
class ModSet(models.Model):
  mods = models.ManyToManyField(Mod) 
```

并将汽车换成

```
class Car(models.Model):
  modset = models.ForeignKey(ModSet) 
```

按 Car.modset 分组很简单：例如，我可以按照 Javier 的建议使用重新分组。这似乎是一个更简单且相当优雅的解决方案；想法将不胜感激。

# sql - sql查询中是否有诸如SELECT LAST之类的东西？

> ID：160304
> 
> 赞同：6
> 
> 时间：2008-10-02T00:04:04.163
> 
> 标签：sql, sybase

我正在使用sybase 数据库来查询每日交易报告。我的脚本中有子查询。

在这里：

```
SELECT orders.accountid ,items.x,etc
(SELECT charges.mistotal FROM charges where items.id = charges.id)
FROM items,orders
WHERE date = '2008-10-02' 
```

在这里，我收到错误消息：

> *子查询不能返回多个值*

我的价值观是 7.50、25.00

我想退回 25.00，但是当我使用

```
(SELECT TOP 1 charges.mistotal FROM charges where items.id = charges.id) 
```

我的结果是 7.50 但我想返回 25.00

有没有人有更好的建议？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-02T00:13:04.827

```
SELECT TOP 1 * 
FROM dbo.YourTable 
ORDER BY Col DESC 
```

在你的情况下，我想那将是

```
SELECT TOP 1 charges.mistotal 
FROM charges where items.id = charges.id 
ORDER BY charges.mistotal DESC 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-02T00:08:15.480

您根据什么标准选择 25.00 而不是 7.5？

如果它与最大值有关，您可以尝试在该字段上使用**MAX()**函数。

如果它与按时间顺序添加的最后一行有关，请尝试在 datetime 字段上使用**MAX()**，如果您有关于添加的小时和分钟的详细信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-02T00:09:10.080

你可以试试这个：

```
SELECT MAX(charges.mistotal) FROM charges WHERE items.id = charges.id 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-02T00:19:12.147

那么，你可以使用逆序吗：

```
(SELECT TOP 1 charges.mistotal
    FROM charges
    WHERE items.id = charges.id
    ORDER BY charges.mistotal DESC
) 
```

实际上，由于您没有给出明确的顺序，因此返回结果的顺序是不确定的，您很幸运它给了您不想要的答案；它本可以给你你想要的答案，然后你可能没有注意到它并不总是正确的，直到它投入生产。

或者，您可以使用：

```
(SELECT MAX(charges.mistotal)
    FROM charges
    WHERE charges.id = items.id
) 
```

或者你真的想要一个 SUM？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-02T01:00:47.163

首先，您使用 select top 1 | 第一个 * 从表***顺序升序***到最后，只需颠倒您的顺序。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-02T00:13:36.183

SELECT TOP 1 charge.mistotal FROM charge where items.id = charge.id ORDER BY charge.id DESC

order by 子句将确保它按 id 的顺序返回，而 DESC 表示降序，因此它将首先为您提供最大（最新）的值。TOP 1 当然可以确保你得到那个。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-02T00:14:48.897

对子查询进行排序。如果您想要“最后一个”值，则需要定义如何确定最后一个项目（请记住，默认情况下 SQL 结果集是无序的）。

例如：

```
(SELECT TOP 1 charges.mistotal FROM charges where items.id = charges.id 
 ORDER BY charges.mistotal DESC) 
```

这将返回 25.00 而不是 7.50（来自您上面的数据示例），但我假设您希望这个值是“最后一个”，因为它更大。可能还有一些其他领域对您来说更有意义；例如，也许您有一个时间戳列，您可以对其进行排序以获得最新值而不是最大值。关键是定义你所说的“最后”是什么意思。

# c# - 枚举类型作为跨 Web 服务的常量？

> ID：160313
> 
> 赞同：3
> 
> 时间：2008-10-02T00:06:19.790
> 
> 标签：c#, .net, web-services

我正在开发一个项目，我试图避免在.NET 面向服务的项目中对 DB ID 进行硬编码。在某些情况下，我**需要**通过代码设置 ID 值，但我不想只对 ID 进行硬编码，因为我之前已经这样做过，当 DB 更改自动递增 ID 时，它会导致 DB 对齐噩梦被转储到一个新系统。

我想要做的是创建一个枚举常量来存储 ID，以便在最坏的情况下，如果数据库发生更改，则只需更新 1 个文件，而不是尝试通过成千上万行代码来替换任何系统中的标识。

这将在单个系统上工作，但在我公司的面向服务的环境中，枚举不使用它们的值序列化，只是它们的名称。

在 Web 服务中共享 ID 的最佳方式是什么？我想以某种方式使用枚举（理想情况）或常量，但我似乎无法让它工作。我可以创建一个返回 ID 的 Web 方法，但是为每个 ID 发送一个 Web 请求，然后在客户端机器上序列化响应和反序列化听起来是个坏主意。

**编辑**
我并不完全清楚我在问什么，所以我会详细说明。

我想要一组常量。仅使用枚举是因为它将常量适当地组合在一起。我主要感兴趣的是看看是否有一种方法可以在 Web 服务中共享常量。我需要枚举代表的值，而不是枚举本身。枚举永远不会在服务和客户端之间发送，除非是整数。在内部，所有内容都存储为 ID，而不是枚举。

拥有一个单独的共享库听起来不像是理想的解决方案，因为我几乎已经完成了这个项目，而且我只会在库中存储 1 个枚举/类。只上一节课似乎有点浪费。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-02T12:40:06.937

枚举本质上是可序列化的本机数据类型，因此跨服务共享它们应该不是问题。但是**您必须使用共享数据合同**。我们将枚举用于将令牌与数据库中的 ID 相关联的小型查找列表，但随后我们也在服务之间共享数据协定（我们使用 WCF）。这允许我们使用枚举标记来引用任何服务代码中的相关整数值。如果数据库中的值发生变化，我们将不得不手动更新枚举，但只能在一个地方 - 数据合约。

* * *

另一种可能的解决方案是在每个需要 ID 的服务中创建一个缓存。在每个服务启动期间，让它从中央数据服务中获取值并以适当的方式存储它。这可能是一个自定义缓存对象，也可能是一个静态字典。当您遇到重新编号问题时，只需重新启动服务。

我在一个项目中为某些用户实体完成此操作，我们需要实际的 ID，并希望避免不断调用数据服务来获取不会发生太大变化的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-02T01:18:23.003

我总是创建一个单独的程序集，其中包含枚举和客户端/服务器需要共享的任何接口。然后，您可以从客户端和服务器引用它，而不会泄漏任何功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-02T20:10:25.073

webservice c# 另一端的代码也是如此，还是您实际上需要通过 web 传递整数？

如果您可以控制双方的代码，则只需传递枚举并在越过电线后将其转换回 int 。

```
(Int32)objectThatWasPassed.EnumerationValue; 
```

如果您无法访问另一端的代码并且需要将其作为 int 传递，您可以在传递的任何内容上创建一个整数属性并调用；

```
objectbeingPassed.ConstantProperty = (Int32)Whatever.Constant1; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-03T02:27:20.097

您想要做的事情有几个选项。您可以定义一组在表示 ID 的单个类中定义的常量，并且可以帮助您在 ID 和对您更有用的东西之间进行转换。这是适度灵活的，如果你想变得非常花哨，你甚至可以从数据库中查找一些你的魔法 ID（根据 hurst 的建议）。选择要发送值的类型，然后包装/忽略它是只读常量的事实。

如前所述，您可以使用 WCF 跨 WCF 发送枚举，但它们非常脆弱。每当您更改枚举值时，您都将被迫重新编译服务并更新您的客户端引用。要在 WCF 中公开枚举，请将 [DataContract] 属性添加到类，并将 [EnumMember] 属性添加到每个成员。你被警告了。

前面提到的一些使用共享值集的建议。强烈建议您这样做，这样您只需管理一次更新即可。在这种情况下，确保每个人都使用共享的一组值而不是直接使用这些值是非常非常非常重要的（我说的是非常吗？）。

祝你好运。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-02T01:02:47.597

您可以在公共库中定义枚举并在客户端和服务器端使用它。当您通过 Web 服务传递枚举时 - 它会转换为字符串。编写一个简单的转换扩展方法，将其转换为适当的枚举。例子：

```
DayOfWeek ConvertToDayOfWeek(this String str)
{
   return (DayOfWeek)Enum.Parse(typeof(DayOfWeek), str, true);
} 
```

（注意：我假设您有富客户端/桌面应用程序。使用 Web 服务）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-02T02:16:41.660

只需在您的 Web 服务项目中创建一个公共枚举，并创建至少一个使用该枚举作为其返回类型的公共 WebMethod。在您的客户端项目中更新 Web 引用后，您也可以在客户端代码中使用该枚举。

这基本上可以让您在服务器上定义一个枚举并在服务器和客户端上使用它，而无需使用共享库。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-02T01:21:55.553

您可以在共享程序集上编写枚举并在您的应用程序中使用它。

但我认为在 web 服务上提供枚举应该可以工作。我有一些带有枚举的 c# webservices，在客户端（php）我们传递枚举值名称，我通常在 c# 中获取值。

# java - 如何检查在Java中启动时按住的键

> ID：160315
> 
> 赞同：8
> 
> 时间：2008-10-02T00:06:38.667
> 
> 标签：java, swing, keyboard, key, awt

我正在尝试编写一个在程序首次启动时弹出的分辨率选择对话框。为了防止用户感到无聊，我想实现一个相当标准的功能，您可以使用复选框关闭该对话框，但通过在启动时按住 alt 键将其恢复。

不幸的是，没有明显的方法可以询问 java 当前是否**正在按下**给定的键。您只能通过 KeyListener 注册以获悉新的按键，但如果按键在应用程序启动之前启动，这将无济于事。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-02T03:41:51.347

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.JFrame;

public class LockingKeyDemo {
    static Toolkit kit = Toolkit.getDefaultToolkit();

    public static void main(String[] args) {
        JFrame frame = new JFrame();

        frame.addWindowListener(new WindowAdapter() {
            public void windowActivated(WindowEvent e) {
                System.out.println("caps lock1 = "
                        + kit.getLockingKeyState(KeyEvent.VK_CAPS_LOCK));

                try {
                    Robot robot = new Robot();
                    robot.keyPress(KeyEvent.VK_CONTROL);
                    robot.keyRelease(KeyEvent.VK_CONTROL);
                } catch (Exception e2) {
                    System.out.println(e2);
                }

                System.out.println("caps lock2 = "
                        + kit.getLockingKeyState(KeyEvent.VK_CAPS_LOCK));
            }
        });

        frame.addKeyListener(new KeyAdapter() {
            public void keyReleased(KeyEvent e) {
                System.out.println("caps lock3 = "
                        + kit.getLockingKeyState(KeyEvent.VK_CAPS_LOCK));
            }
        });

        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setSize(200, 200);
        frame.setLocationRelativeTo(null);
        frame.setVisible(true);
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-02T04:07:50.613

那么有两种类型的按键检测：基于事件和轮询。如果您`KEY_PRESSED`在启动时轮询键盘（通过`sleep.thread(timeInMs)`不断检查您的键是否按下的循环），那么您可以检测它是否在启动时已被按下。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-29T23:47:47.097

最初的问题似乎没有得到回答。建议的方法确定锁定键状态，如 CapsLock、ScrollLock 等。因此它不适用于**Alt**按下状态。

考虑以下代码：

`com.sun.jna.platform.KeyboardUtils.isPressed(java.awt.event.KeyEvent.VK_ALT);`

唯一的问题是这个类是 Sun 的内部 JDK 类，不可能在任何其他 JVM 中可用。取决于您的项目，它可能会或可能不会被接受。

它在内部调用 Windows 上的 User32.DLL：

`User32.INSTANCE.GetAsyncKeyState(...)`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-02T04:14:56.167

```
public class LockingKeyDemo {
    static Toolkit kit = Toolkit.getDefaultToolkit();

    public static void main(String[] args) {
        System.out.println("caps lock2 = "
                + kit.getLockingKeyState(KeyEvent.VK_CAPS_LOCK));
}
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-02T00:16:26.083

我对 Java 不太了解（主要是 C# 中的代码），但是如果有一个用 C 编写的小型加载程序或一些然后用一些参数启动你的 Java 应用程序的东西（比如某个键是否关闭）呢？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-03T09:59:08.877

因此，您似乎可以这样做，但仅限于 caps lock 等。因此，我已为此目的转而使用大写锁定。不完美，但还可以。

# simulation - 关于模拟游戏的注意事项

> ID：160318
> 
> 赞同：4
> 
> 时间：2008-10-02T00:06:50.087
> 
> 标签：simulation

我想到的那种模拟游戏是那种你可以在不同的地点建造东西，以及连接这些地点的工人/运输者。

更像是定居者系列。

假设我现在不想要任何我认为我可以管理的**图形**。

所以我的疑惑如下：

1.  每个实体都应该是一个类并且每个实体都有一个线程吗？
2.  实体是否应该在类内的列表中分组并且每个都有一个线程？

如果采用实施 1，那么在低规格机器上运行将非常困难，并且不能很好地扩展到大量数据。

如果采用实施 2，它在资源方面会更好，但是......

我应该如何对实体进行分组？

1.  一般有一个房屋类并有一个接口列表来管理它？
2.  有针对特定房屋组的课程并有一个对象列表来管理它吗？

那么线程呢？

1.  我应该有简单的主游戏循环吗？
2.  我应该为每个班级组一个线程吗？
3.  工人/运输者如何适应这幅画？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-02T00:19:45.327

通常的方法根本不使用线程，而是将实体实现为状态机。然后你的主循环看起来像这样：

```
 while( 1 )
{
    foreach( entity in entlist )
    {
        entity->update();
    }

    render();
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-02T00:36:14.133

MMORPG Eve Online 使用 stackless python 和 actor 模型来模拟一个每个实体的线程系统，而不会影响资源。

查看此链接以获取更多信息： [http ://harkal.sylphis3d.com/2005/08/10/multithreaded-game-scripting-with-stackless-python/](http://harkal.sylphis3d.com/2005/08/10/multithreaded-game-scripting-with-stackless-python/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-02T00:17:40.060

我相当肯定你只想让一个线程执行游戏逻辑。拥有多个线程不会加速任何事情，只会使代码混乱。有一个主游戏循环是非常好的，但如果游戏有多人游戏，事情会变得有些棘手。

我对您与课程有关的问题部分感到有些困惑。如果我正确理解您的问题，我的建议是为每种类型的房屋（养猪场、风车等）从一个通用抽象基类派生一个类`House`。然后，您将游戏世界中的所有房屋存储在房屋列表中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-03T02:15:17.770

考虑使用 Erlang。使用 Erlang，您可以生成比普通系统线程更多的进程（= 轻量级线程）。进一步它是分布式的，这意味着如果您的系统不够好，请添加另一个节点。

另一种选择是无堆栈 python（或当前的 python 替代），因为它还支持某种轻量级线程，这对于游戏引擎来说非常酷。Eve Online 将其用于其服务器。但它不是分布式的，但可以很容易地手动实现。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-08T12:08:00.930

虽然@Mike F 的答案大部分是正确的，但您必须记住，在一个`foreach`循环中对实体进行迭代会使评估顺序具有显着的确定性，这会产生不良的副作用。另一方面，引入线程会带来潜在的*heisenbugs*和并发问题，所以我见过和使用的最好的方法是结合两个周期：第一个周期根据之前的状态从代理/工作者收集动作，第二个周期组成动作的结果并更新模拟的状态。为了避免可能的偏差，在每个循环中，评估的顺序都是随机的。此 BTW 可扩展到大规模并行评估，但需要在每个周期结束时进行同步。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-02T00:32:55.950

我会避免为每个实体创建一个单独的类，因为这样您就会遇到为共享功能重复代码的情况，或者您将拥有一个时髦的继承树。

我认为你想要的是一个单一的类和具有功能的对象。我在博客上看到一篇文章在 RTS 中讨论了这个概念......等等，我认为这是一个[有人正在编写的设计模式](http://blog.cumps.be/design-patterns-decorator-pattern/)之旅。

使用访问者模式在每个对象的 DoEvents 方法上产生一个线程（因为没有更好的词）来告诉每个对象在这个给定的循环中执行它要执行的操作。在循环结束时同步线程，因为您不希望某些具有复杂逻辑的对象仍然从十个循环开始执行其操作，而实际上它在五个循环前被销毁。

# c# - 如何本地化数据库驱动的网站

> ID：160335
> 
> 赞同：18
> 
> 时间：2008-10-02T00:11:56.187
> 
> 标签：c#, .net, asp.net, localization

我一直在使用 .NET 内置的本地化功能，它们似乎都依赖于将数据放入 resx 文件中。

但是大多数系统不能依赖这个，因为它们是数据库驱动的。那么你如何解决这个问题呢？是否有内置的 .NET 方式，或者您是否在 SQL 中创建翻译表并手动完成所有操作？如果您必须在大多数网站上执行此操作，是否有任何理由甚至使用 resx 本地化方式？

这方面的一个例子是我的网站上有一个常见问题解答列表，我将此列表保存在数据库中，以便我可以轻松添加/删除更多内容，但是通过将其放入数据库中，我没有将这些信息翻译成多种语言的好方法.

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-02T01:09:54.660

在我看来，本地化动态内容（例如，您的常见问题解答）应该由您在数据库中完成。根据您的问题的存储方式，我可能会创建一个“区域设置”列并在从数据库中选择常见问题解答问题时使用它。我不确定当您开始本地化大量表时这是否会很好地扩展。

对于静态内容（例如，表单字段标签、静态文本、图标等），您应该可以使用基于文件的资源。但是，如果您真的想这样做，那么创建一个可以处理此问题的自定义资源提供程序实现似乎并不难。

以下是一些相关链接：

*   [http://channel9.msdn.com/forums/Coffeehouse/250892-Localizing-with-a-database-or-resx-files/](http://channel9.msdn.com/forums/Coffeehouse/250892-Localizing-with-a-database-or-resx-files/)
*   [http://weblogs.asp.net/scottgu/archive/2006/05/30/ASP.NET-2.0-Localization-_2800_Video_2C00_-Whitepaper_2C00_-and-Database-Provider-Support_2900_.aspx](http://weblogs.asp.net/scottgu/archive/2006/05/30/ASP.NET-2.0-Localization-_2800_Video_2C00_-Whitepaper_2C00_-and-Database-Provider-Support_2900_.aspx)
*   [http://www.arcencus.nl/Blogs/tabid/105/EntryID/20/Default.aspx](http://www.arcencus.nl/Blogs/tabid/105/EntryID/20/Default.aspx)
*   [http://msdn.microsoft.com/en-us/library/aa905797.aspx](http://msdn.microsoft.com/en-us/library/aa905797.aspx)
*   [http://www.codeproject.com/KB/aspnet/customsqlserverprovider.aspx](http://www.codeproject.com/KB/aspnet/customsqlserverprovider.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-02T19:40:52.260

对于数据模型中的给定项目，将描述部分拆分为具有区域设置 ID 列 (LCID) 的本地化表。

因此，Product 表实际上不会包含产品描述或名称，而仅包含其硬性和快速值（ProductId、EAN、NumberInStock、NextStockData、IsActive、IsPublished）等。

ProductDescription 然后包含 ProductId、名称、描述、LCID

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-02T19:53:16.863

我住在加拿大，所以多语种很重要。我见过两种方法。第一个选项是将特定记录的所有本地化数据存储在不同的表中，通过主键和区域设置链接到原始表。第二个选项与第一个选项类似，只是对于每个区域设置，都有一个不同的表，区域设置作为表名的后缀。

选项 A

```
Item (ItemID, ...)
ItemLocal (ItemID,LocaleID,....) 
```

选项 B

```
Item (ItemID, ...)
Item_ENUS (ItemID,....)
Item_ENGB (ItemID,....)
Item_FR (ItemID,....) 
```

我最近想到的第三个选项，如果数据库本身支持它，那将是非常好的将所有本地人的值存储在同一字段中。如果该字段设置为 varchar-multilocal，那么您必须通过传递参数来指定语言来访问它。据我所知，没有这样的东西存在，但我认为这真的会让事情变得更容易，更流畅。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-02T12:01:16.560

目前，翻译不是可以自动完成的。最好的方法是让一个人翻译并使用尼克的方法来显示正确的语言。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-04T20:01:10.697

我们混合使用了 RESX 文件和 Kibbee 响应的选项 A。我们创建了一个简单的工具来在线管理 RESX 文件：http: [//blog.lavablast.com/post/2008/02/RESX-file-Web-Editor.aspx](http://blog.lavablast.com/post/2008/02/RESX-file-Web-Editor.aspx)

# svn - 什么 svn 命令会列出分支上修改的所有文件？

> ID：160370
> 
> 赞同：85
> 
> 时间：2008-10-02T00:28:44.777
> 
> 标签：svn

在 svn 中，我创建了一个分支，例如在修订版 22334 中。然后在分支上进行了提交。

与主干上的内容相比，如何获取分支上更改的所有文件的列表？我不想看到在创建分支和“现在”之间在主干上更改的文件。

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2008-10-02T00:37:32.040

我认为这会做到：

```
svn diff -r 22334:HEAD --summarize <url of the branch> 
```

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2011-03-05T21:52:37.280

如果这就是您要查找的全部内容，您还可以使用带有 -u 选项的 status 命令获取更改文件的快速列表

```
svn status -u 
```

这将向您显示文件在当前代码库中的修订版本与存储库中的最新修订版本。当我真正想查看文件本身的差异时，我只使用 diff 。

这里有一个很好的关于 svn 命令的教程，解释了很多这些常见的场景：[SVN 命令参考](http://web.archive.org/web/20110316170621/http://www.duchnik.com/tutorials/vc/svn-command-reference)

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2017-10-24T21:43:00.690

您可以使用以下命令：

```
svn status -q 
```

根据[svnbook](http://svnbook.red-bean.com/en/1.7/svn.ref.svn.c.status.html)：

`With --quiet (-q), it prints only summary information about locally modified items.`

警告：此命令的输出仅显示您的修改。所以我建议做一个`svn up`来获取文件的最新版本，然后`svn status -q`用来获取你修改过的文件。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2012-06-21T06:12:45.573

这将仅列出修改后的文件：

```
svn status -u | grep M 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-08-09T14:19:50.323

```
echo You must invoke st from within branch directory
SvnUrl=`svn info | grep URL | sed 's/URL: //'`
SvnVer=`svn info | grep Revision | sed 's/Revision: //'`
svn diff -r $SvnVer --summarize $SvnUrl 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-03-28T06:06:07.480

-u 选项将显示包括目标文件，如果它们是在编译期间添加的。

所以，为了克服这个问题，你可以像这样使用。

```
svn status -u | grep -v '\?' 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-08-27T07:34:36.183

`svn log -q -v`显示路径并隐藏注释。所有路径都是缩进的，因此您可以搜索以空格开头的行。然后通过管道进行`cut`整理`sort`：

`svn log --stop-on-copy -q -v | grep '^[[:space:]]'| cut -c6- | sort -u`

这将获取自其分支点以来在分支上提到的所有路径。请注意，它将列出已删除和添加的文件，以及修改过的文件。我只是用它来获取我应该担心在新开发人员的一个稍微凌乱的分支上审查的东西。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2021-07-08T14:28:59.130

我这样做是一个两步的过程。首先，我找到了作为分支起源的版本。从分行的结账处：

`svn log --stop-on-copy |tail -4`

`--stop-on-copy`告诉 SVN 只对分支后的条目进行操作。 `tail`获取最后一个日志条目，即包含分支信息的日志条目。以“r”开头的数字是您分支的版本。然后，用于`svn diff`查找自该版本以来的更改：

`svn diff -r <revision at which you branched>:head --summarize`

--summarize 选项仅显示文件列表，没有实际的差异内容，类似于 'svn status' 输出。如果您想查看实际差异，只需删除该`--summarize`选项即可。

# vb.net - SQL阅读器的字符串问题？

> ID：160373
> 
> 赞同：0
> 
> 时间：2008-10-02T00:29:14.540
> 
> 标签：vb.net

```
Function FillAdminAccount() As Boolean

    FillAdminAccount = True

           Try

        SQLconn.ConnectionString = "connect timeout=9999999;" & _
                                   "data source=" & DefaultIserver & ";" & _
                                   "initial catalog=" & DefaultIdBase & "; " & _
                                   "user id=userid;" & _
                                   "password=userpass;" & _
                                   "persist security info=True; " & _
                                   "packet size=4096"
        SQLconn.Open()

        SQLcmd.CommandType = CommandType.Text

        SQLcmd.CommandText = "Select distinct username, cast(convert(varchar,userpassword) as varchar) as 'userpassword' from " & tblUsersList & " where usertype='MainAdmin'"
        SQLcmd.Connection = SQLconn

        SQLreader = SQLcmd.ExecuteReader

        While SQLreader.Read = True
            CurrentAdminUser = SQLreader("username").ToString
            CurrentAdminPass = SQLreader("userpassword").ToString   'PROBLEM'
        End While

    Catch ex As Exception
        ErrorMessage(ex)
    Finally
        If SQLconn.State = ConnectionState.Open Then SQLconn.Close()
        If SQLreader.IsClosed = False Then SQLreader.Close()
    End Try

End Function    'FillAdminAccount 
```

请查看带有注释问题的行。在这段代码中，输出等于*"userpassword*。如您所见，右边没有引号，**我想知道为什么**。顺便说一下，数据库中 userpassword 的数据类型是 BINARY。希望你能帮忙我在这个。谢谢你..x_x

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-02T01:01:47.863

永远不要在数据库中存储实际密码。现在看来，由于转换/转换操作，您的密码*可能*不是纯文本，但您仍然遇到问题。至少使用的任何加密都很容易逆转，如果您的 sql 服务器最终位于与应用程序不同的机器上，那么密码将以纯文本形式通过网络传输。

如果您必须这样做（可能是由于遗留系统或上面的授权），那么*至少**在服务器上*进行匹配，以便密码永远不会返回到应用程序。

您*应该*做的是使用类似 SQL Server 2005 的 HashBytes() 函数来仅存储实际密码的哈希值。当有人尝试登录时，对他们尝试的密码进行哈希处理并匹配哈希值。

至于您的具体问题，我的猜测是转换或转换操作失败导致 NULL 值返回到应用程序。您是否*同时*拥有相同类型的 CAST()*和*CONVERT() ？这是多余的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-02T00:37:37.640

会不会

```
as varchar) as 'userpassword' 
```

应该

```
...as varchar) as [userpassword] .. 
```

或者

```
...as varchar) as userpassword .. 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-02T01:11:23.067

@Oglester 是对的，它是“用户密码”周围的单引号。

这不是一个错误，但它只是愚蠢的：

```
 cast(convert(varchar,userpassword) as varchar 
```

您可以使用 cast 或 convert ，但两者都使用没有意义。

# sql-server - TSQL：如何在 XML 中进行自联接以获取嵌套文档？

> ID：160374
> 
> 赞同：3
> 
> 时间：2008-10-02T00:29:28.423
> 
> 标签：sql-server, tsql, sqlxml, for-xml

我有一个这样的 SQL Server 2005 表：

```
create table Taxonomy(
CategoryId integer primary key,
ParentCategoryId integer references Taxonomy(CategoryId),
CategoryDescription varchar(50) 
) 
```

数据看起来像 `CategoryIdParentCategoryIdCategoryDescription 123nullfoo345123bar` 

 `I'd like to query it into an xml document like this:` 

```
<taxonomy>
<category categoryid="123" categorydescription="foo">
      <category id="455" categorydescription="bar"/>
</category>
</taxonomy> 
```

FOR XML AUTO, ELEMENTS 可以做到这一点吗？还是我需要使用 FOR XML EXPLICIT？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-02T03:38:30.840

这是可能的，但主要限制是层次结构的级别必须是硬编码的。SQL Server 联机丛书在[此链接](http://msdn.microsoft.com/en-us/library/ms345137(SQL.90).aspx#forxml2k5_topic5)中描述了如何用 XML 表示层次结构。以下是生成您请求的 XML 的示例查询：

```
SELECT [CategoryId] as "@CategoryID"
      ,[CategoryDescription] as "@CategoryDescription"
      ,(SELECT [CategoryId]
       ,[CategoryDescription]
       FROM [dbo].[Taxonomy] "Category"
       WHERE ParentCategoryId = rootQuery.CategoryId
       FOR XML AUTO, TYPE)
FROM [dbo].[Taxonomy] as rootQuery
where [ParentCategoryId] is null
FOR XML PATH('Category'), ROOT('Taxonomy') 
```

# javascript - 为什么将您的 Javascript 文件移动到您也拥有的不同主域？

> ID：160376
> 
> 赞同：28
> 
> 时间：2008-10-02T00:30:38.513
> 
> 标签：javascript, webserver, cdn, provisioning, whitelist

我注意到，就在去年左右，许多主要网站都对其页面结构进行了相同的更改。每个人都将他们的 Javascript 文件从托管在与页面本身（或其子域）相同的域上移至托管在不同名称的域上。

## 这不仅仅是并行化

现在，有一种众所周知的技术可以将页面组件分布到多个域以并行下载。 [雅虎](http://developer.yahoo.com/performance/rules.html#split)和许多其他人一样推荐它。例如，**www.example.com**是托管 HTML 的地方，然后您将图像放在**images.example.com**上，将 javascripts 放在**scripts.example.com**上。这绕过了这样一个事实，即大多数浏览器都会限制每台服务器的同时连接数，以便成为优秀的网民。

以上*不是*我要说的。

## 它不仅仅是重定向到内容交付网络（或者可能是——见问题的底部）

我所说的是专门在一个完全不同的域上托管 Javascript。让我具体一点。就在去年左右，我注意到：

**youtube.com**已将其 .JS 文件移至**ytimg.com**

**cnn.com**已将其 .JS 文件移至**cdn.turner.com**

**weather.com**已将其 .JS 文件移至**j.imwx.com**

现在，我知道像[Akamai](http://www.akamai.com)这样专门为大型网站外包的内容交付网络。（特纳的特殊领域中的名称“cdn”让我们了解这个概念在这里的重要性）。

但请注意这些示例，每个站点都有自己为此目的专门注册的域，而不是内容交付网络或其他基础设施提供商的域。事实上，如果您尝试从这些脚本域中的大多数加载主页，它们通常会重定向回公司的主域。如果您反向查找所涉及的 IP，它们*有时*似乎指向 CDN 公司的服务器，有时则不是。

## 我为什么在乎？

以前在两家不同的安全公司工作过，我对恶意 Javascript 感到偏执。

因此，我遵循将允许 Javascript（和其他活动内容，如 Java）在其上运行的站点列入白名单的做法。因此，要使**cnn.com**这样的网站正常运行，我必须手动将**cnn.com**放入列表中。这是背后的痛苦，但我更喜欢它而不是替代方案。

当人们使用像**scripts.cnn.com**这样的东西来并行化时，使用适当的通配符可以很好地工作。当人们使用 CDN 公司域之外的子域时，我可以只允许 CDN 公司的主域在前面加上一个通配符，然后用一块石头杀死许多鸟（例如 *.edgesuite.net 和 *.akamai.com）。

现在我发现（截至 2008 年）这还不够。现在我必须在我想列入白名单的页面的源代码中四处寻找，并找出该站点用于存储其 Javascript 的“秘密”域（或域）。在某些情况下，我发现我必须允许三个不同的域才能使站点正常工作。

## 为什么所有这些主要网站都开始这样做？

编辑：好的[，正如“onebyone”所指出的](https://stackoverflow.com/questions/160376/why-move-your-javascript-files-to-a-different-main-domain-that-you-also-own#160451)，它似乎与内容的 CDN 交付有关。所以让我根据他的研究稍微修改一下这个问题......

为什么**weather.com**使用**j.imwx.com**而不是**twc.vo.llnwd.net**？

为什么**youtube.com**使用**s.ytimg.com**而不是**static.cache.l.google.com**？

这背后一定有道理。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2008-10-02T01:53:33.447

您的后续问题本质上是：假设一个流行的网站使用 CDN，为什么他们会使用自己的 TLD，例如 imwx.com，而不是子域 (static.weather.com) 或 CDN 的域？

好吧，使用他们控制的域而不是 CDN 的域的原因是他们保留了控制权——他们甚至可以完全更改 CDN，只需要更改 DNS 记录，而不是必须更新数千个页面/应用程序中的链接。

那么，为什么要使用无意义的域名呢？嗯，像 .js 和 .css 这样的帮助文件的一个重要问题是，您希望它们尽可能多地被代理和人们的浏览器缓存到下游。如果一个人点击 gmail.com 并且所有的 .js 文件都从他们的浏览器缓存中加载出来，那么该网站对他们来说显得更加快捷，而且它还节省了服务器端的带宽（每个人都赢了）。问题是，一旦您发送 HTTP 标头进行真正激进的缓存（即缓存我一周或一年或永远），这些文件就不再可靠地从服务器加载，您无法更改/修复他们因为事情会在人们的浏览器中中断。

因此，公司要做的就是进行这些更改并实际更改所有这些文件的 URL，以迫使人们的浏览器重新加载它们。循环访问“a.imwx.com”、“b.imwx.com”等域是如何完成的。

通过使用无意义的域名，Javascript 开发人员和他们的 Javascript 系统管理员/CDN 联络人可以拥有他们自己的域名/DNS，他们正在推动这些更改，他们负责/自主。

然后，如果 TLD 上开始发生任何类型的 cookie 阻止或脚本阻止，它们只会从一个无意义的 TLD 更改为 kyxmlek.com 或其他。他们不必担心会意外做出对所有 *.google.com 产生反制副作用的邪恶行为。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-02T00:37:13.833

限制 cookie 流量？

在特定域上设置 cookie 后，对该域的每个请求都会将 cookie 发送回服务器。每一个要求！

这可以很快加起来。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-02T01:41:05.117

很多原因：

CDN - 不同的 dns 名称可以更轻松地将静态资产转移到内容分发网络

并行性 - 图像、样式表和静态 javascript 正在使用另外两个不会阻塞其他请求的连接，例如 ajax 回调或动态图像

Cookie 流量 - 完全正确 - 特别是对于那些习惯在 cookie 中存储远不止简单会话 ID 的网站

负载整形 - 即使没有 CDN，仍然有充分的理由将静态资产托管在较少的 Web 服务器上，这些服务器经过优化以极快地响应大量文件 url 请求，而站点的其余部分托管在大量响应的服务器上更多处理器密集型动态请求

* * *

更新 - 您不使用 CDN 的 dns 名称的两个原因。客户端 dns 名称充当 CDN 正在缓存的资产的正确“蜂巢”的关键。此外，由于您的 CDN 是一种商品服务，您可以通过更改 dns 记录来更改提供程序 - 这样您就可以避免在您的站点上进行任何页面更改、重新配置或重新部署。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-02T01:07:21.703

我认为CDN理论中有一些东西：

例如：

```
$ host j.imwx.com
j.imwx.com              CNAME   twc.vo.llnwd.net
twc.vo.llnwd.net        A       87.248.211.218
twc.vo.llnwd.net        A       87.248.211.219
$ whois llnwd.net
<snip ...>
Registrant:
  Limelight Networks Inc.
  2220 W. 14th Street
  Tempe, Arizona 85281-6945
  United States 
```

Limelight 是一个 CDN。

同时：

```
$ host s.ytimg.com
s.ytimg.com             CNAME   static.cache.l.google.com
static.cache.l.google.com       A       74.125.100.97 
```

我猜这是 Google 内部运行的静态内容的 CDN。

```
$ host cdn.turner.com
cdn.turner.com A record currently not present 
```

啊，好吧，赢不了所有人。

顺便说一句，如果您使用带有 NoScript 附加组件的 Firefox，那么它将自动执行搜索源代码的过程，并通过 GUI 处理白名单的过程。基本上，单击状态栏中的 NoScript 图标，您将获得一个域列表，其中包含临时或永久白名单选项，包括“所有在此页面上”。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-08-11T15:56:07.040

大约两到三年前，我在以前的雇主那里实施了这个解决方案，当时网站由于遗留的 Web 服务器实施而开始过载。通过将 CSS 和布局图像移至 Apache 服务器，我们减少了主服务器上的负载并不断提高速度。

但是，我一直认为 Javascript 函数只能从与页面本身相同的域中访问。较新的网站似乎没有此限制：正如您所提到的，许多网站在单独的子域甚至完全独立的域上都有 Javascript 文件。

谁能给我一个关于为什么现在可能的指针，而不是几年前？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-02T00:38:30.680

您可以移动到不同域的不仅仅是 javascript，而且尽可能多的资产会产生性能改进。

大多数浏览器对您可以与单个域建立的同时连接的数量有限制（我认为它大约是 4 个），因此当您有很多图像、js、css 等时，通常会在下载每个文件时遇到问题。

您可以使用 YSlow 和 FireBug 之类的工具来查看从服务器下载每个文件的时间。

通过在不同的域中拥有资产，您可以减轻主域的负载，并且可以在任何给定时间拥有更多的同时连接并下载更多文件。

我们最近推出了一个房地产网站，其中有很多图片（房屋的，duh :P），它使用这个原理来制作图片，所以列出数据要快得多。

我们还在许多其他具有高资产量的网站上使用了它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-02T00:55:11.217

我想你回答了你自己的问题。

我相信您的问题与安全有关，而不是为什么。

也许一个新的 META 标记是为了描述相关页面的有效 CDN，那么我们只需要一个浏览器插件来读取它们并做出相应的行为。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-02T01:19:31.893

会不会是因为垃圾邮件和内容过滤器的拦截？如果他们使用奇怪的域，那么就很难弄清楚和/或你最终会阻止你想要的东西。

不知道，只是一个想法。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-02T01:27:23.307

如果我是一家知名的多品牌公司，我认为这种方法会很有意义，因为您希望将 javascript 代码作为库提供。我想让尽可能多的页面在处理地址、州名、邮政编码等内容时尽可能保持一致。AJAX 可能使这种担忧变得突出。

在当前的互联网商业模式中，域名是品牌，而不是网络名称。如果您被收购或分拆品牌，您最终会进行大量域名更改。即使是最突出的网站，这也是一个问题。

在 *.netscape.com 和 *.mcom.com 中仍有指向有用文档的链接早已不复存在。

[网景](http://en.wikipedia.org/wiki/Netscape_Communications_Corporation)的维基百科说：

> “2004 年 10 月 12 日，流行的开发者网站 Netscape DevEdge 被 AOL 关闭。DevEdge 是 Internet 相关技术的重要资源，维护着 Netscape 浏览器的权威文档、HTML 和 JavaScript 等相关技术的文档以及热门文章由 Danny Goodman 等行业和技术领导者撰写。来自 DevEdge 的一些内容已在 Mozilla 网站上重新发布。

因此，在不到 10 年的时间内：

*   马赛克通讯公司
*   网景通信公司
*   美国在线
*   美国在线时代华纳
*   时代华纳

如果您将代码放在不是品牌名称的域中，您将保留很大的灵活性，并且在重新命名网站时不必重构所有入口点、访问控制和代码引用。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-02T02:04:38.977

我曾与一家这样做的公司合作过。他们位于具有相当好的对等互连的数据中心中，因此 CDN 推理对他们来说并不那么重要（也许这会有所帮助，但他们不会因此而这样做）。他们的原因是他们并行运行多个网络服务器，共同处理他们的动态页面（PHP 脚本），并且他们在一个单独的域中提供图像和一些 javascript，在该域上他们使用快速、轻量级的网络服务器（例如 lighttpd 或 thttpd）来提供服务图片和静态javascript。

PHP 需要 PHP。静态 Javascript 和图像没有。当您需要做的只是绝对最低限度时，可以从功能齐全的网络服务器中剥离很多东西。

当然，他们可能会使用代理将请求重定向到特定子目录到不同的服务器，但使用不同的服务器处理所有静态内容更容易。

# c++ - 提高代码质量？

> ID：160379
> 
> 赞同：10
> 
> 时间：2008-10-02T00:32:21.427
> 
> 标签：c++

所以，在阅读这个网站时，我工作的商店似乎做错了很多事情，也做对了一些事情。如何改进与同事一起工作的代码？我唯一能想到的就是以身作则 - 开始使用 Boost 等。还有其他想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-02T00:38:19.260

您可能必须更仔细地查看您的商店做错了什么以及他们做对了什么。您实际上可以在那里改变什么？ *你可以改变你自己的做法来提高你或你的团队的技能吗？* 在根深蒂固的商店中实现变革可能很困难。尝试提出代码审查（首先针对您的代码），这可能会引发讨论。

对于有形的项目，我会看看[Scott Meyers](http://www.aristeia.com/)的 Effective C++ 等。发展你的技能，你将帮助改善你周围的人，或者去一家可以这样做的商店。另外，请查看 Gang of Four 的[设计模式](https://rads.stackoverflow.com/amzn/click/com/0201633612)书。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-02T00:49:39.030

代码审查是我发现提高整体代码质量的最佳方式。审查来自不同个人的代码，互相帮助提高了对不同技术的普遍认识，并有助于传播最佳实践。聘请比您更有经验的人也是一个很好的工具，但实施起来有点乏味。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-02T05:43:04.973

*   阅读好的编程书籍
*   从别人的代码中学习——开源项目是最好的起点
*   定期阅读优秀的博客和论坛 - Sutter mill、Coding Horror、Martin fowler 等
*   代码审查
*   单元测试
*   使用良好的库，如 Boost、STL。也了解它们的实现

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-02T00:35:43.603

以身作则总是一件好事，尽管让别人相信你的榜样比他们目前正在做的更好并不是那么容易。通过代码审查提出建设性的批评可能是您温和地建议同事工作方式的替代方法的最佳选择。关键是要让其他人相信你的提议确实更好，以一种他们可以欣赏的有形方式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-02T00:39:24.500

有时人们必须看到你的方式比他们的方式更好。让人们改变往往很困难。

如果您还没有这样做，您是否考虑过编写单元测试？我发现它确实改善了我的生产代码，让我更有信心，我正在写的就是我应该写的。

我喜欢 Jason 关于代码审查的想法。它们*可能*会有所帮助，也可能是争论的地方——这真的取决于你如何定下基调。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-02T00:39:49.927

很好地架构和设计项目，这样任何开发人员都无法采取不同的方式来违反质量。如果你设定了一个伟大的设计，人们就会跟着路线走，他们会自动学习

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-02T00:42:11.467

其他要尝试的事情是添加[单元](http://code.google.com/p/googletest/) [测试](http://www.boost.org/doc/libs/1_36_0/libs/test/index.html)和[文档](http://www.doxygen.org/)。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-02T00:44:23.613

尽管这可能不是直接的答案，但我建议您阅读[Code Complete](http://www.cc2e.com/)书。我发现它是学习如何成为更好的程序员的最佳资源。如果您通读整本书并理解其中的内容，您将真正学会如何让自己和您的代码变得更好。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-02T05:26:23.797

我发现编写单元测试对代码质量有很大帮助——这意味着你必须考虑你的代码将如何与测试和代码的其他部分交互。

同行代码审查：检查代码质量也会让程序员思考他们是如何编写代码的。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-02T05:40:40.343

很高兴您认识到还有改进的余地并渴望尝试做出一些改变。我建议阅读 James Shore 的[19 周日记](http://jamesshore.com/Change-Diary/)，其中记录了他在公司实施敏捷开发所经历的步骤。这是一场艰苦的战斗，但他的经验表明，你可以有所作为。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-02T13:07:32.690

只问问题是一个好的开始。

具体来说，您可以：

*   承认你的代码很烂
*   开始要求其他人，最好是有更多经验的人，审查你的代码
*   实现一个持续构建服务器——你必须是第一个使用它的人
*   要有勇气，因为这可能很困难
*   要谦虚
*   阅读代码完成
*   使用鼓励团队合作的软件开发方法。一些敏捷方法非常擅长这一点
*   阅读开发博客
*   加入用户组

改变很难，你必须成为第一个改变的人。

如果你在一个其他人都很高兴的环境中工作，那么你将会遇到困难。坚持想要提高代码质量。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-03T12:53:10.593

我有偏见（由于我的工作），但根据您的预算（如果存在），静态分析是一种可能的选择。有许多不同类型的工具，其中一些还包括编码标准执行检查。

如果您使用 g++，您可能能够从 -Weffc++ 选项中获得基本的帮助。

# java - 从java项目中提取所有字符串

> ID：160382
> 
> 赞同：12
> 
> 时间：2008-10-02T00:33:52.267
> 
> 标签：java, eclipse, string, gwt, plugins

我有相当多的源文件，我需要解析并提取所有字符串文字并将它们作为播放旧 java 常量放在一个文件中。
举个例子：

```
Label l = new Label("Cat"); 
```

会成为：

```
Label l = new Label(Constants.CAT); 
```

在`Constants.java`我会有：

```
public final static String CAT = "Cat"; 
```

**我不希望将字符串外部化到属性文本文件中。**
原因之一是一致性和代码可读性。
另一个是我们的客户端代码使用了`GWT`，不支持Java属性文本文件机制。

我可以编写某种解析器（也许使用 ant replace 任务）？
但我想知道是否`IDE`已经自动执行此类操作。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-10-02T00:42:05.757

Eclipse 会自动执行此操作。右键单击文件，选择“源”，然后选择“外部化字符串”

这并不完全符合您的要求（将 Constants.java 文件中的字符串作为字符串），但使用的方法确实非常强大。它将它们移动到一个属性文件中，该文件可以根据您的语言环境动态加载。按照您的建议将它们放在单独的 Java 源文件中意味着您将在应用程序中同时拥有所有语言，或者您将根据区域设置发布不同的应用程序。

我们将它用于我们的应用程序，即使是基本的东西也必须以英语和日语发布——我们更复杂的应用程序支持 12 种语言——我们绝不是一家小型软件开发公司 :-)。

如果您*确实*希望它们在 Java 文件中，尽管已经提到了缺点，但编写一个程序将属性文件变形为 Java 源文件比尝试从自由格式的 Java 源中提取字符串要容易得多。

然后，您需要做的就是修改 Accessor 类以使用内置字符串（在单独的类中），而不是在运行时加载它们。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-02T06:50:55.153

要完成 Peter Kelley 的回答，您可以考虑 eclipse IDE 的**AST**解决方案。

然后，您可能会编写一个 AST 程序来解析您的源代码并执行您想要的操作。

此[Eclipse 角文章](http://www.eclipse.org/articles/article.php?file=Article-JavaCodeManipulation_AST/index.html)中提供了完整示例，更多详细信息请参见[Eclipse 帮助](http://help.eclipse.org/help33/index.jsp?topic=/org.eclipse.jdt.doc.isv/reference/api/org/eclipse/jdt/core/dom/ASTParser.html)。[**您可以在 Eclipse JDT 中自动嵌入领域特定语言的**](http://www.eclipse.org/articles/Article-AutomatingDSLEmbeddings/#implementation_in_place)[“就地翻译的实现”部分](http://www.eclipse.org/articles/Article-AutomatingDSLEmbeddings/#implementation_in_place)
的清单 5 中找到一些示例，以及[GitHub 项目中的多个示例](https://github.com/search?q=%22org.eclipse.jdt.core.dom.ASTVisitor%22&ref=cmdform&type=Code)。[](http://www.eclipse.org/articles/Article-AutomatingDSLEmbeddings/#implementation_in_place)

 *** * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-02T02:27:13.150

有一些很好的理由说明您不想这样做。除了任何此类生成的文件（我不知道 eclipse 函数）不会区分您正在设置的字符串之外，例如，作为测试类中的构造函数参数和您实际想要的东西常量，更大的问题是你所有的公共静态决赛都将被编译到你的类中，如果你想改变类的行为，你不仅需要改变持有常量的类，还需要改变所有引用它的东西。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-02T05:13:01.223

我完全承认 Pax Diablo 所说的话。我们也在使用该功能。

当应用于类文件时，“Externalize strings”函数将创建两个文件，一个类 Messages.class 和一个属性文件 messages.properties。然后它会将字符串文字的所有直接用法重定向到对 Messages.get(String key) 的调用，并使用您在“Ext. String”向导中为字符串输入的键。

顺便说一句：属性文件有什么不好？正如他所说，如果您需要更改文本，您可以只更改属性文件而不必更改类。

另一个优点是：将字符串文字提取到属性文件中的方式使您可以自由地将源语言翻译成您想要的任何语言，**而无需修改任何代码**。属性文件加载器通过使用具有语言 iso 代码的相应文件自动加载目标语言文件。因此，您不必担心代码运行的平台，它会（几乎）自动选择适当的语言。有关详细信息，请参阅类[ResourceBundle](http://java.sun.com/j2se/1.5.0/docs/api/java/util/ResourceBundle.html)的文档。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-02T05:28:03.573

您可能想查看 NetBeans 中的[Jackpot 源转换引擎](http://jackpot.netbeans.org/)，它允许您编写源转换脚本。

# apache - Apache mod_rewrite 捕获 XML 请求

> ID：160384
> 
> 赞同：1
> 
> 时间：2008-10-02T00:34:44.980
> 
> 标签：apache, mod-rewrite

如何创建一个 apache RewriteRule 来捕获以 .xml 结尾的任何请求 URL，剥离 .xml 并将其传递给特定脚本？

```
http://www.example.com/document.xml, becomes http://www.example.com/document passed to script.php 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-02T00:36:03.713

我相信这应该可以解决问题。

```
RewriteRule ^(.+)\.xml$ script.php?path=$1 
```

# .net - 将 Grid 用作 ItemsPanelTemplate 的 ListBox 会产生奇怪的绑定错误

> ID：160391
> 
> 赞同：36
> 
> 时间：2008-10-02T00:36:57.563
> 
> 标签：.net, wpf, data-binding, listbox, itemspaneltemplate

我有一个 ListBox 控件，并且在网格布局中呈现固定数量的 ListBoxItem 对象。所以我将我的 ItemsPanelTemplate 设置为网格。

我正在从后面的代码访问 Grid 以配置 RowDefinitions 和 ColumnDefinitions。

到目前为止，一切都按我的预期工作。我有一些自定义的 IValueConverter 实现，用于返回每个 ListBoxItem 应该出现的 Grid.Row 和 Grid.Column。

但是有时我会遇到奇怪的绑定错误，我无法弄清楚它们发生的确切原因，或者即使它们在我的代码中。

这是我得到的错误：

> `System.Windows.Data Error: 4 : Cannot find source for binding with reference 'RelativeSource FindAncestor, AncestorType='System.Windows.Controls.ItemsControl', AncestorLevel='1''. BindingExpression:Path=HorizontalContentAlignment; DataItem=null; target element is 'ListBoxItem' (Name=''); target property is 'HorizontalContentAlignment' (type 'HorizontalAlignment')`

任何人都可以解释发生了什么吗？

哦，这是我的 XAML：

```
<UserControl.Resources>
    <!-- Value Converters -->
    <v:GridRowConverter x:Key="GridRowConverter" />
    <v:GridColumnConverter x:Key="GridColumnConverter" />
    <v:DevicePositionConverter x:Key="DevicePositionConverter" />
    <v:DeviceBackgroundConverter x:Key="DeviceBackgroundConverter" />

    <Style x:Key="DeviceContainerStyle" TargetType="{x:Type ListBoxItem}">
        <Setter Property="FocusVisualStyle" Value="{x:Null}" />
        <Setter Property="Background" Value="Transparent" />

        <Setter Property="Grid.Row" Value="{Binding Path=DeviceId, Converter={StaticResource GridRowConverter}}" />
        <Setter Property="Grid.Column" Value="{Binding Path=DeviceId, Converter={StaticResource GridColumnConverter}}" />

        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type ListBoxItem}">
                    <Border CornerRadius="2" BorderThickness="1" BorderBrush="White" Margin="2" Name="Bd"
                            Background="{Binding Converter={StaticResource DeviceBackgroundConverter}}">
                        <TextBlock FontSize="12" HorizontalAlignment="Center" VerticalAlignment="Center" 
                                Text="{Binding Path=DeviceId, Converter={StaticResource DevicePositionConverter}}" >
                            <TextBlock.LayoutTransform>
                                <RotateTransform Angle="270" />
                            </TextBlock.LayoutTransform>
                        </TextBlock>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsSelected" Value="true">
                            <Setter TargetName="Bd" Property="BorderThickness" Value="2" />
                            <Setter TargetName="Bd" Property="Margin" Value="1" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>            
    </Style>        
</UserControl.Resources>

<Border CornerRadius="3" BorderThickness="3" Background="#FF333333" BorderBrush="#FF333333" >
    <Grid ShowGridLines="False">
        <Grid.RowDefinitions>
            <RowDefinition Height="15" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <StackPanel Grid.Row="0" Orientation="Horizontal">
            <Image Margin="20,3,3,3" Source="Barcode.GIF" Width="60" Stretch="Fill" />
        </StackPanel>

        <ListBox ItemsSource="{Binding}" x:Name="lstDevices" Grid.Row="1" 
                 ItemContainerStyle="{StaticResource DeviceContainerStyle}"
                 Background="#FF333333"
                 SelectedItem="{Binding SelectedDeviceResult, ElementName=root, Mode=TwoWay}" >
            <ListBox.ItemsPanel>
                <ItemsPanelTemplate>
                    <Grid>
                        <Grid.LayoutTransform>
                            <RotateTransform Angle="90" />
                        </Grid.LayoutTransform>                            
                    </Grid>
                </ItemsPanelTemplate>
            </ListBox.ItemsPanel>
        </ListBox>
    </Grid>
</Border> 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-10-06T22:10:40.527

绑定问题来自 ListBoxItem 的默认样式。默认情况下，当将样式应用于元素时，WPF 会查找默认样式并应用默认样式中未在自定义样式中专门设置的每个属性。有关此行为的更多详细信息，请参阅Ian Griffiths 撰写的[这篇精彩的博客文章。](http://www.interact-sw.co.uk/iangblog/2007/02/14/wpfdefaulttemplate)

回到我们的问题。这是 ListBoxItem 的默认样式：

```
<Style
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:s="clr-namespace:System;assembly=mscorlib"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    TargetType="{x:Type ListBoxItem}">
    <Style.Resources>
       <ResourceDictionary/>
    </Style.Resources>
    <Setter Property="Panel.Background">
       <Setter.Value>
          <SolidColorBrush>
        #00FFFFFF
          </SolidColorBrush>
       </Setter.Value>
    </Setter>
    <Setter Property="Control.HorizontalContentAlignment">
       <Setter.Value>
          <Binding Path="HorizontalContentAlignment" RelativeSource="{RelativeSource Mode=FindAncestor, AncestorType=ItemsControl, AncestorLevel=1}"/>
       </Setter.Value>
    </Setter>
    <Setter Property="Control.VerticalContentAlignment">
       <Setter.Value>
          <Binding Path="VerticalContentAlignment" RelativeSource="{RelativeSource Mode=FindAncestor, AncestorType=ItemsControl, AncestorLevel=1}"/>
       </Setter.Value>
    </Setter>
    <Setter Property="Control.Padding">
       <Setter.Value>
          <Thickness>
        2,0,0,0
          </Thickness>
       </Setter.Value>
    </Setter>
    <Setter Property="Control.Template">
       <Setter.Value>
          <ControlTemplate TargetType="{x:Type ListBoxItem}">
             ...
          </ControlTemplate>
       </Setter.Value>
    </Setter>
 </Style> 
```

请注意，我已删除 ControlTemplate 以使其紧凑（我已使用[StyleSnooper](https://github.com/drewnoakes/style-snooper) - 检索样式）。您可以看到有一个绑定，其相对源设置为带有 ItemsControl 类型的祖先。因此，在您的情况下，绑定时创建的 ListBoxItems 没有找到它们的 ItemsControl。您能否提供更多有关 ListBox 的 ItemsSource 的信息？

PS：消除错误的一种方法是在您的自定义样式中为 Horizo​​ntalContentAlignment 和 VerticalContentAlignment 创建新的设置器。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-03-12T00:07:44.740

在您的设置`OverridesDefaultStyle`中也将解决这些问题。`True``ItemContainerStyle`

```
<Style TargetType="ListBoxItem">
    <Setter Property="OverridesDefaultStyle" Value="True"/>
    <!-- set the rest of your setters, including Template, here -->
</Style> 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2014-05-04T11:39:11.023

这是此处其他答案的混合体，但对我来说，我必须`Setter`在两个地方应用来解决错误，尽管这是在使用自定义时`VirtualizingWrapPanel`

如果我删除以下任一`Setter`声明，我的错误就会再次出现。

```
 <ListView>
            <ListView.Resources>
                <Style TargetType="ListViewItem">
                    <Setter Property="HorizontalContentAlignment" Value="Left" />
                    <Setter Property="VerticalContentAlignment" Value="Top" />
                </Style>
            </ListView.Resources>
            <ListView.ItemContainerStyle>
                <Style TargetType="ListViewItem">
                    <Setter Property="HorizontalContentAlignment" Value="Left" />
                    <Setter Property="VerticalContentAlignment" Value="Top" />
                </Style>
            </ListView.ItemContainerStyle>
            <ListView.ItemsPanel>
                <ItemsPanelTemplate>
                    <controls:VirtualizingWrapPanel />
                </ItemsPanelTemplate>
            </ListView.ItemsPanel>
        </ListView> 
```

目前我真的没有时间进一步调查，但我怀疑这与 JTango 在他的回答中提到的默认样式有关——我并没有真正在很大程度上自定义我的模板。

我认为其他答案还有更多的里程，但我想我会发布这个机会，它可以帮助同一条船上的人。

大卫施密特的回答看起来可能描述了根本原因。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-10-20T13:23:05.033

这是s 和其他临时容器的[常见问题。](https://stackoverflow.com/questions/165424/how-does-itemcontainergeneratorcontainerfromitem-work-with-a-grouped-list)它们是在加载/渲染时异步/动态创建的。在尝试访问它们之前，您必须附加到's事件并等待状态变为。`ListBoxItem``*Item``ItemsControl`[`ListBox.ItemContainerGenerator`](http://msdn.microsoft.com/en-us/library/system.windows.controls.itemscontrol.itemcontainergenerator.aspx)[`StatusChanged`](http://msdn.microsoft.com/en-us/library/system.windows.controls.itemcontainergenerator.statuschanged.aspx)`ItemsGenerated`

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2014-07-26T11:23:01.110

我和你有同样的问题，我只想分享我的解决方案。我已经尝试了这篇文章中的所有选项，但最后一个对我来说是最好的——谢谢克里斯。

所以我的代码：

```
<ListBox.Resources>
    <Style x:Key="listBoxItemStyle" TargetType="ListBoxItem">
        <Setter Property="HorizontalContentAlignment" Value="Center" />
        <Setter Property="VerticalContentAlignment" Value="Center" />
        <Setter Property="MinWidth" Value="24"/>
        <Setter Property="IsEnabled" Value="{Binding IsEnabled}"/>
    </Style>

    <Style TargetType="ListBoxItem" BasedOn="{StaticResource listBoxItemStyle}"/>
</ListBox.Resources>

<ListBox.ItemContainerStyle>
    <Binding Source="{StaticResource listBoxItemStyle}"/>
</ListBox.ItemContainerStyle>

<ListBox.ItemsPanel>
    <ItemsPanelTemplate>
        <WrapPanel Orientation="Horizontal" IsItemsHost="True" MaxWidth="170"/>
    </ItemsPanelTemplate>
</ListBox.ItemsPanel> 
```

我还发现，当自定义`ItemsPanelTemplate`不存在时，不会出现此错误。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-02-15T00:01:13.093

这对我有用。把它放在你的 Application.xaml 文件中。

```
<Application.Resources>
    <Style TargetType="ListBoxItem">
        <Setter Property="HorizontalContentAlignment" Value="Left" />
        <Setter Property="VerticalContentAlignment" Value="Center" />
    </Style>
</Application.Resources> 
```

从...

[http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/42cd1554-de7a](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/42cd1554-de7a)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-08-16T13:08:26.577

我刚刚遇到了相同类型的错误：

> System.Windows.Data 错误：4：找不到与引用“RelativeSource FindAncestor，AncestorType='System.Windows.Controls.ItemsControl'，AncestorLevel='1''的绑定源。BindingExpression:Path=Horizo​​ntalContentAlignment; 数据项=空；目标元素是'ListBoxItem'（名称=''）；目标属性是“Horizo​​ntalContentAlignment”（类型“Horizo​​ntalAlignment”）

这发生在执行这样的绑定时：

```
<ListBox ItemsSource="{Binding Path=MyListProperty}"  /> 
```

到我的数据上下文对象上的这个属性：

```
public IList<ListBoxItem> MyListProperty{ get; set;} 
```

经过一些实验，我发现只有当项目数超过我的 ListBox 的可见高度时才会触发错误（例如，当垂直滚动条出现时）。所以我立即想到了虚拟化并尝试了这个：

```
<ListBox ItemsSource="{Binding Path=MyListProperty}" VirtualizingStackPanel.IsVirtualizing="False" /> 
```

这为我解决了这个问题。尽管我更愿意保持开启虚拟化，但我没有再花时间深入研究它。我的应用程序有点复杂，有多个级别的网格、停靠面板等以及一些异步方法调用。我无法在更简单的应用程序中重现该问题。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-10-16T16:06:38.540

如果您想完全替换`ListBoxItem`模板以使选择不可见（也许您希望`ItemsControl`具有 的分组/等行为的外观`ListBox`），那么您可以使用以下样式：

```
<Style TargetType="ListBoxItem">
  <Setter Property="Margin" Value="2" />
  <Setter Property="FocusVisualStyle" Value="{x:Null}" />
  <Setter Property="OverridesDefaultStyle" Value="True" />
  <Setter Property="Template">
    <Setter.Value>
      <ControlTemplate TargetType="{x:Type ListBoxItem}">
        <ContentPresenter Content="{TemplateBinding ContentControl.Content}" 
                          HorizontalAlignment="Stretch" 
                          VerticalAlignment="{TemplateBinding Control.VerticalContentAlignment}" 
                          SnapsToDevicePixels="{TemplateBinding UIElement.SnapsToDevicePixels}" />
      </ControlTemplate>
    </Setter.Value>
  </Setter>
</Style> 
```

此模板还排除了标准`Border`包装器。如果你需要，你可以用这个替换模板：

```
<Border BorderThickness="{TemplateBinding Border.BorderThickness}" 
        Padding="{TemplateBinding Control.Padding}" 
        BorderBrush="{TemplateBinding Border.BorderBrush}" 
        Background="{TemplateBinding Panel.Background}" 
        SnapsToDevicePixels="True">
  <ContentPresenter Content="{TemplateBinding ContentControl.Content}" 
                    ContentTemplate="{TemplateBinding ContentControl.ContentTemplate}" 
                    HorizontalAlignment="{TemplateBinding Control.HorizontalContentAlignment}" 
                    VerticalAlignment="{TemplateBinding Control.VerticalContentAlignment}" 
                    SnapsToDevicePixels="{TemplateBinding UIElement.SnapsToDevicePixels}" />
</Border> 
```

如果您不需要所有这些`TemplateBinding`值，则可以删除一些以提高性能。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-02T18:04:04.863

根据MSDN 上的[数据模板概述](http://msdn.microsoft.com/en-us/library/ms742521.aspx)`DataTemplates`，应该用作`ItemTemplate`定义数据的呈现方式，而 a`Style`将用作`ItemContainerStyle`仅对生成的容器进行样式设置，例如`ListBoxItem`.

但是，您似乎正在尝试使用后者来完成前者的工作。如果没有更多代码，我无法重新创建您的情况，但我怀疑以容器样式进行数据绑定可能会在假定的视觉/逻辑树中抛出扳手。

我也忍不住认为，基于项目信息的项目自定义布局需要创建自定义`Panel`. 自定义`Panel`布局项目可能比使用 Rube Goldberg 分类的项目更好地布置项目`IValueConverters`。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-11-30T12:34:43.950

另一个对我有用的解决方法/解决方案是通过在类的构造函数或顶级窗口中将数据绑定源开关级别设置为关键来抑制这些错误（实际上，将它们称为警告似乎更合适） -

```
#if DEBUG     
    System.Diagnostics.PresentationTraceSources.DataBindingSource.Switch.Level =
        System.Diagnostics.SourceLevels.Critical;
#endif 
```

参考：[如何抑制 System.Windows.Data 错误警告消息](http://www.codeproject.com/Tips/124556/How-to-suppress-the-System-Windows-Data-Error-warn)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-02-21T16:41:03.173

简单地为“ComboBoxItem”类型创建一个默认样式是行不通的，因为它被 ComboBox 的默认“ItemContainerStyle”覆盖。要真正摆脱这种情况，您需要更改 ComboBoxes 的默认“ItemContainerStyle”，如下所示：

```
<Style TargetType="ComboBox">
    <Setter Property="ItemContainerStyle">
        <Setter.Value>                
            <Style TargetType="ComboBoxItem">
                <Setter Property="HorizontalContentAlignment" Value="Left" />
                <Setter Property="VerticalContentAlignment" Value="Center" />
            </Style>
        </Setter.Value>
    </Setter>
</Style> 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-07-03T18:52:26.497

我开始遇到这个问题，即使我的 ListBox 同时设置了 Style 和 ItemContainerStyle - 这些命名的样式已经定义了 Horizo​​ntalContentAlignment。我正在使用 CheckBox 控件来打开/关闭我的 ListBox 上的实时过滤，这似乎导致项目从默认样式而不是我分配的样式中拉出。大多数错误会在第一次启动实时过滤时发生，但此后它会继续在每次更改时抛出 2 个错误。我发现有趣的是，我的收藏中恰好有 2 条记录是空的，因此项目中没有任何内容可显示。所以这似乎有所贡献。我计划创建在记录为空时显示的默认数据。

卡特的建议对我有用。添加一个没有键的单独“默认”样式和定义 Horizo​​ntalContentAlignment 属性的 TargetType="ListBoxItem" 解决了这个问题。我什至不需要为它设置 OverridesDefaultStyle 属性。

# c# - 以编程方式排序开始菜单

> ID：160418
> 
> 赞同：2
> 
> 时间：2008-10-02T00:46:25.810
> 
> 标签：c#, windows, sorting

我正在寻找使用 C# 按字母顺序对开始菜单进行排序。我已阅读有关删除注册表项的信息

`HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\MenuOrder`

但是当我在我的机器上尝试它时，它似乎并没有做任何事情。有没有人对必须做什么才能对“开始”菜单进行排序有任何其他想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-02T00:57:54.720

显然，你不能，这是故意的。

来自 Raymond Chen 的博客（Windows 开发人员的好读物）：

> 因为力量被用于邪恶的程度远远超过它被用于善良的程度。

完整条目[在这里](http://blogs.msdn.com/oldnewthing/archive/2006/06/19/636823.aspx)。

# collaboration - 当你的团队领导不称职时，你具体怎么做？

> ID：160433
> 
> 赞同：33
> 
> 时间：2008-10-02T00:57:26.330
> 
> 标签：collaboration

您的一名团队成员已被任命为“技术负责人”或“团队负责人”，但他在技术上不称职，缺乏主要的领导技能。

技术上不称职，我的意思是这个人不知道抽象类和接口之间的区别，不明白为什么应该避免耦合，不理解内聚的概念，提供解决方案而不花时间思考，不明白为什么我们应该支持组合而不是继承并且没有设计模式（除了单例模式）。

再加上那个人有超过 10 年的“经验”（是的，我确实把这个词放在引号里，因为他给出了一个完全不同的维度来了解真正的经验）。

我在工作中和这样的人打交道。它带走了我对这个职业的热情。

你有什么反应？你做什么工作？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2008-10-02T01:01:16.523

布莱恩，

这是你的团队负责人。别再胡闹了，回去工作吧！

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2008-10-02T01:15:09.953

展示自己的能力，永远不要因为团队中的分歧而让项目受到影响。向您的老板表明您或其他人可能是该职位的更好选择。坚持下去，尽量不要失去你的激情。坚持你的道德，做好你的工作。但是，如果完全没有变化，您可能需要寻找其他东西。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2008-10-02T01:00:40.127

只是和你的老板谈谈。保持客观，在技术领导错误\不称职时展示具体的例子。您可以做的更糟糕的事情是与技术领先者抗争。只是升级问题。如果你的老板是个通情达理的人，他会想办法帮助你，否则你就不走运了:)

如果技术主管的决定影响了你的工作，你不应该保持沉默。否则，您将对问题负责。

我对领导和下属有这样的问题。试图与人自己谈判很少会得到预期的结果。让它成为你的老板/员工经理的问题。成功的关键是客观和有说服力。

**编辑：**

托比亚斯的回答+1。证明你不是一个抱怨的失败者，也许你会成为新的团队负责人。**无论您的技术负责人多么愚蠢，您都应该始终做好自己的工作。**相信我，管理者欣赏负责任的员工。不要破坏项目，采取积极的应对措施（不要忘记查看当地的工作清单）。

当然，在极少数情况下，你的老板是你的技术主管的密友，或者很多经理会支持他。在这种情况下没什么好说的，要么坚强，要么离开。

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2008-10-02T02:00:05.227

如果我同时管理你们两个，你们的**一些抱怨会让我认为问题不是 100% 是他的错**。

他是否真的“不花时间思考”就提供了解决方案，还是他向您提供了从他的经验中得出的解决方案，但您认为这些解决方案是个坏主意？

你应该更喜欢组合而不是继承吗？我个人同意，但我绝不会在一百万年后指责支持继承的人“技术上无能”。

他是否没有“获得”设计模式，或者他只是不使用相同的术语？

指责同事技术无能是一项相当严重的指控。您需要提出一个不依赖于软件中合法辩论的案例。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2008-10-02T01:01:09.610

坐下来，让他上吊。你没有理由做任何事情。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2008-10-02T09:04:27.733

他无能吗？还是你只是被青春的傲慢所淹没？

他可能不称职，但也许他在技术上没有你那么强。在考虑谁成为团队领导者时，技术能力只是一个因素。

也许他质疑你的技术能力和专业判断力？也许您应该与他接触并与他讨论您的不同方法。你可能真的从他那里学到了一些新东西，或者你可以向他展示你的优势，他可以成长为依赖你的建议和意见——甚至可能对你说好话到更高的梯队。

我有一些糟糕的团队领导者和一些伟大的领导者。在每种情况下，我都认为我在专业和技术上都优于他们。有时我是，但通常我只是不欣赏他们的优势——这大概就是他们在排名中领先于我的原因。

最终，如果这家伙是一只真正的火鸡，你必须咧嘴一笑，忍受它或离开。把他晾干不太可能对你有任何好处——优秀的团队领导者必须展示出良好的政治、个人和商业技能，并且必须能够与各种可能尴尬的人一起工作。

[记录在案，我离开的一位直线经理很糟糕；知道自己被打的时候也是一技之长！】

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2009-02-27T09:00:52.303

团队领导领导团队，而不是项目。

*   它可以保护团队免受干扰。
*   它解决了团队的问题。

您作为专业人士，您应该了解技术知识，团队负责人会信任您。

也许其中一位开发人员应该领导该项目并领导技术方面的工作。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2008-10-02T01:19:41.610

根据我的经验，通过参与开发项目的所有领域来展示自己的价值，并且经常帮助他人完成具有挑战性的任务，更重要的是愿意采取主动并做完成项目需要做的事情的成员会得到奖励他们的努力。

无论奖励是以标题的形式出现，还是以良好的评论后的促销形式出现，都会发生。如果你是那个人，你的团队领导已经知道了，并且可能会被吓倒；很可能他/她的老板也知道。

如果您在审核时获得好评并获得奖励，那么不时让您的团队领导看起来不错只会帮助您的职业生涯。

你会发现，通过帮助项目取得成功，并利用战略机会向你的团队领导展示做事的“正确方式”，你将培养一个盟友，而不是一个对手。

如果他/她真的不知道如何领导或激励，那就是你想做的。然后去做。领导你的队友，但要让他们尊重你的知识广度。其他经理会看到这一点，你可能会感到惊喜。

如果你想成为领导者，你应该接近你的团队负责人，并询问你是否可以在下一个项目中采取行动。他/她可能很乐意让你减轻他们的一些负担。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2008-10-02T01:24:04.860

你别无选择，只能继续尽你所能做好工作，并为团队提供你能做的最好的想法。为什么？

团队未能成功也会被管理类型视为您的失败（除非他们非常精明）。这是一个糟糕的情况，但几乎每个人都曾经经历过。

如果团队负责人在他/她明显错误的情况下继续无视您的建议，请撰写一个很好的深入解释，说明您认为应该以不同方式处理任务的原因，并将其提交给您的所有团队成员。尝试使团队朝着建立共识的方向发展，并远离团队领导的专横。只有在反复失败之后，您才应该考虑将问题升级。

我不建议升级问题，除非：

*   你已经准备好让事情变得丑陋了。即人们被解雇或重新分配，包括*你*。据我们所知，您是团队负责人是对的，也是错的；）
*   你**知道***大多数*其他受人尊敬的团队成员都同意你的观点。
*   您已告诉团队负责人您愿意将问题升级。每个人都应该有机会采取纠正措施，即使是你的老板。如果您没有直接对团队负责人说太多，那么您不应该将问题升级。

完成此操作后，继续清晰简洁地撰写您对团队负责人技术决策的反对意见，并附上理由和示例，说明您为什么要写作并且他们是错误的，然后开始将它们抄送给您的老板和团队负责人的老板。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2008-10-02T01:45:46.807

1.  尽自己最大的努力做好自己的工作。

2.  不要向那些给出不好建议的人寻求建议。

3.  阅读“如何赢得朋友和影响他人”并尝试帮助他“得到它”。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2008-10-02T02:16:58.697

在软件开发中，首要条件是承受压力的能力。头痛总是会以这样或那样的方式出现。只为你寻找好东西。午餐时间步行二十分钟是目前我最喜欢的工作部分。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2009-02-27T04:37:17.070

音乐创世纪和杰森史蒂文森是正确的。

让我在他们所说的之后再补充一步：

*让你的老板成功。*

可能是您的老板在技术上不称职（我们不知道，他不是在这里为自己辩护），但他可能具有与公司其他人一起解决问题的技能，或者他可能具有一些技能，例如营销开发人员没有，或者与关键利益相关者的稳固关系使*您的*生活更轻松[不一定您会知道，因为大多数开发人员基本上看不到这些事情]。**关键**是要明白他的责任和你的不同*，*他的负担更大。他可以使用援助之手和盟友。

试试看。尊重他，记住人即使在事情上错了也值得尊重。这一切都归结为人类和有限。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2008-10-02T02:05:09.350

我对这些情况的建议始终是“如果你不喜欢你所处的情况，请等待 6 个月”，事情通常会变化得很快。我在一家公司工作了不到 5 年，有 5 位不同的经理。没有人喜欢在他们的工作上糟透了，如果他糟透了，他可能会后悔自己的决定、改变自己或继续前进。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2008-10-02T03:18:53.040

啊，回忆……我曾经和一个人一起工作，他的每一句话都用“嗯，在我十年的经验中……”

他不是真的有十年的经验*积累*，他有十年的经验！

如果领导不称职，尊重制服（如果不是那个人），并完全按照他的决定去做 - 并记录他告诉你做的所有事情、时间和原因，以及你委婉地提出的反对意见，以便当他跌倒他不会跌倒在你身上。这应该平衡您对公司的责任和自我保护的责任。

同时，寻找更好的工作！很可能，如果提拔这个人的人没有意识到他/她是无能的，那么事情在很长一段时间内都不会改变……

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2008-10-02T01:30:44.813

我已经通过艰难的方式学会了这一点——本质上是他的促进者，因为我认识他很长时间了。再也不！

你有三个选择（嗯，真的是无限的，但三个对我来说似乎是可能的积极途径）：

记录他做错的所有事情，他表现出无能的事件以及他如何成为团队的支柱。用这些信息面对他，并向他解释他可以优雅地要求重新分配，或者你要去他的老板那里。你不会在他那里获得任何积分，但你在乎吗？如果他的老板为他打球，请**准备好走路**。我喜欢这个，因为它可以让他挽回面子。这些天我们不倾向于做很多这样的事情。

要求被转移到组织内的另一个小组。你可以完全诚实地解释为什么。 **准备好走路**。如果你真的是公司的资产，你可以利用它来获得这个莳萝控制之外的新职位。

**走**。这就是我最终最终会做的事情，一旦我的 PM 明确表示不会做任何事情来解决问题。他基本上和我的直属上司一样无能。最后，我很高兴他们无能，因为他们强迫我动手，结果我找到了很棒的工作。

在我看来，你有三个选择：摆脱那个人，离开他的团队，离开公司。没有理由一个有才华的开发人员不能找到比他/她更好的工作。他们中有太多人只是在为有才华的程序员而哭泣。

一切顺利！

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2008-10-02T01:31:38.463

我去过那里，伙计。首先尽力做到最好并保持原状，这家伙可能会失败并很快离开。但是，如果你觉得你的理智处于危险之中，那就换个位置吧。

干杯，阿里

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2008-10-02T01:31:44.217

有时你需要超越他无能的直接问题，看看导致他首先被录用的过程。

如果贵公司的招聘实践允许“经验丰富”但不称职的团队领导，您应该考虑以下几点：

1.  贵公司的面试和选拔流程不达标。
2.  也许，只是也许，你确实有一个很好的选择过程，但你只是选择了最便宜的。我认为这不太可能，因为任何认真对待其选拔过程的公司可能不会仅仅为了多花几美元就让一个好员工离开。
3.  你只是不走运，不知何故他设法从裂缝中溜走了。如果他是内部雇员并且没有经历与外部雇员相同的选择过程，就会发生这种情况。

您需要问问自己是否可以采取任何措施来改善公司的招聘做法。如果你认为你可以试一试。但是，如果你公司的文化是这样的，这显然是不可能的，那么我建议你把你的简历掸掉。

我确实遇到了你的问题。在我的情况下，从第一天开始，这个人就很明显无法应对挑战（我 99.999% 确定他没有阅读 StackOverflow！）。我向我们的 CEO 解释了情况，他最初给了我一些希望，希望事情会有所改变。然而，我发现他只是对我的抱怨说空话，结果什么也没发生。两年后，我们的组长终于被“降级”，迫使他辞职。基本上他被解雇了，但我们的 CEO 花了两年时间来解决一个本不应该长期恶化的问题。

祝你好运！

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2009-02-27T06:25:35.970

Gishu - 你在我的团队中吗？jk。

我认为“缺乏主要的领导技能”对于团队领导来说是比“技术上无能”更严重的罪行。如果团队领导依赖团队成员提供一些技术指导，那么他可能会非常有效。但是，如果团队领导不倾听/学习，不促进沟通，并试图将结构塞进每个人的喉咙（不理解他们），那么就有问题了。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2008-10-02T01:05:21.973

你可以辞职吗？

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2008-10-02T02:08:18.827

假设你有称职的管理层（考虑到他们选择的领导，这可能是不可能的），事实总是会变得很明显，他们的选择是错误的。如前所述，他最终会自掘坟墓，但请确保不要让项目因此而受苦。

如果管理层开始担心这些问题，请主动介入并帮助解决问题。这不仅表明你有能力完成他的工作，而且做得更好。

作为开发人员，您也有责任客观地告诉您的管理层存在技术问题（无论是与开发人员有关还是其他问题）。如果你觉得他让你从事的项目处于危险之中，你必须介入并发表意见。

此外，最常见的错误之一是在这种情况下陷入激烈的争论。不要让你的情绪占上风。请记住，无论他是一个多么贫穷的开发人员，他仍然有可能在*某些事情*上是正确的。

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2009-02-27T06:19:18.620

上次我们有一个人非常了解所有最新的 oo 行话，并想尝试所有最新的时尚设计模式。

他做到了——该应用程序花费的时间大约是应有的时间的两倍。这家公司只需要一个一次性的应用程序，并且需要快速完成。所以，虽然代码漂亮优雅，但项目还是失败了。

无知确实很糟糕，尤其是在领先时。但是，在判断某人对最新流行技术术语的了解之前，我会小心谨慎。有时，完成工作的简单能力或其他人为因素也很重要。

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2009-12-30T17:57:53.307

如果情况不会很快改变，请考虑离开或搬到不同的部门。在公司或在将这样的人提拔为团队领导的老板手下很难取得成功。

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2009-02-27T04:11:58.973

我有一个团队负责人（他和我在一个 2 人团队中）声称拥有 7 年的 .NET/C# 经验（和我一样），并且在此之前还有几年的其他语言经验（我没有）。

我不知道这家伙睡在什么石头下，但是当你看到这样的代码时：

```
public byte[] ReadBytes(string filename)
{
  FileStream fs = new FileStream(filename, FileMode.Open, FileAccess.Read);
  BinaryReader br = new BinaryReader(fs);
  FileInfo fi = new FileInfo(filename);
  byte[] buffer = new byte[fi.Length];

  for (int i = 0; i < buffer.Length; i++)
  {
    // optimize this
    buffer[i] = br.ReadByte();
  }

  return buffer;
} 
```

然后他仍然浪费时间在这些琐碎的东西上编写单元测试（我们已经有一个不可能的截止日期迫在眉睫），任何有 1-2 年经验的人都应该知道。

除了不知道如何正确使用 FileStream（BinaryReader 怎么了？;p），他没有意识到有`File.ReadAllBytes`.

无论如何，当我看到他“贡献”的这段代码时，我告诉他上面提到的功能。我什至通过电子邮件向他发送了 MSDN 链接，但由于 Outlook 已关闭，他没有收到该链接。然后我出去抽了十多分钟的烟，从地板上捡起我的下巴。当我回来时，他仍然找不到方法。他尝试了类似“new File().Rea...”的方法，说该方法不存在。

我可能应该闭上嘴，等他检查他的代码，但这可能是几周后......

我还向经理提出了有关他的各种问题，我们还进行了小组讨论以解决其他问题。

无论如何，我仍然尽我所能努力工作。知道你是 2 人团队中唯一的人，贡献任何代码（我认为我没有见过他手工编写超过 200 行代码），每周投入 60 多个小时，这确实令人沮丧。

我现在的情况。:|

注意：代码与我记得看到的不完全一样，它更长，并且可能需要更多检查现有文件和/或关闭流。

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2008-10-02T01:01:56.660

我会让他自毁。让你的想法被知道，但如果你没有必要，不要无理地推动它们。这个想法是让他不听从你的建议，结果证明是真的，让他上吊。如果你机智、尊重他人，并且没有不服从，他的老板应该注意到了。如果这不起作用，您总是可以找到另一份工作。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2008-10-02T09:30:24.973

我也发生了同样的事...

这家伙有超过10年的“经验”。几个月后，我的面纱从我的眼睛上脱落了：他的“经历”或多或少类似于：

*   招很多实习生
*   分配困难（或不可能）的任务，对它们一无所知
*   检查正在进展的几个月
*   向管理层报告成功的人，获得荣誉并拥有“伟大的技术领导者品质”
*   重复

我的解决方案？我忍受了，然后第一次继续前进！

编辑：

毕竟，比起“领袖”，他更像是一个“收割者”

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2009-02-27T05:30:54.320

**如果您的团队领导不称职，则不应使您/您的工作受挫，除非它直接影响到您。就如此容易。**

你知道你比他好。所以，做好你的工作并取得优异成绩。展示您在使您的项目取得成功方面的才华。为什么要花时间担心团队领导。如果他/她有 10 年的经验并且不知道他应该知道的事情，那对他不利，而不是你。

是的，如果他做出某些错误的技术决定，例如提出设计或其他建议，您可以随时提出建议，并优雅地说服所有人您的建议更好。但要以一种好的方式去做。以粗鲁的方式对 10 年的经验说话。一个人对你没有任何好处，因为自我因素进来了。

让他意识到你在你的交易中很出色（以一种好的方式）并且它会为你创造奇迹，他可能会确保你在最高老板面前得到很好的展示。

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2009-02-27T05:47:22.940

通过[管理你的经理](http://www.google.ca/search?q=managing+your+manager&ie=utf-8&oe=utf-8&aq=t&rls=org.mozilla:en-US:official&client=firefox-a)，尤其是微观经理来管理你的经理。

# sql - 通过 PostgreSQL 中的视图更新多对一关系中的两个表

> ID：160453
> 
> 赞同：1
> 
> 时间：2008-10-02T01:08:40.793
> 
> 标签：sql, database, postgresql

我有两个表：`foos`and `bars`，并且它们之间存在多对一的关系：每个表`foo`可以有很多`bars`. 我还有一个 view `foobars`，它连接了这两个表（它的查询就像`select foo.*, bar.id from foos, bars where bar.foo_id=foo.id`）。

`foo`编辑：如果您说s 和s之间存在多对多关系，那您就不会错`bar`。然而， A`bar`只是一个标签（实际上，它是一个大小），并且只包含它的名称。该表`bars`具有与链接表相同的作用。

我有一个关于插入的规则，`foobars`即“foo”部分`foos`作为新行插入，“bar”部分由几个用逗号分隔的 bar-id 组成，每个这样的部分都有一个链接在它和适当的之间`foo`创建（我使用一个过程来做到这一点）。

这对插入非常有用。但是，在更新整个事物时，我遇到了问题。规则的`foo`部分很简单。但是，我不知道如何处理多个`bar`s 部分。当我尝试`DELETE FROM bars WHERE foo_id=new.foo_id`在规则中执行类似操作时，我会从 table 中删除所有内容`bars`。

我究竟做错了什么？有没有办法实现我所需要的？最后，我对整个事情的处理方式是否明智？

（我对视图做了这个过于复杂的事情，因为我得到的数据是“<code>foo and all its `bar`s”的形式，但用户必须只看到`foobars`。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-02T02:25:48.817

Rysiek，如果我理解正确，您在`foos`表中有文本列，该列被解析以提取指向`bars`表的外键。在某些情况下，这种建立关系的方法可能是合理的，但是几乎所有数据库编程指南/教程都不鼓励这样做。为什么不使用`bars`指向 foo in 的标准外键`foos`呢？除非需要将 bar 分配给多个 foo。如果是这样，这将您的关系标识为多对多而不是一对多。在这两种情况下，使用基于标准外键的解决方案对于数据库来说似乎更自然。

一对多关系的示例数据库模式：

```
CREATE TABLE foos (
    id SERIAL PRIMARY KEY,
    ....
);
CREATE TABLE bars (
    id SERIAL PRIMARY KEY,
    foo_id INT REFERENCES bars (id) ON DELETE CASCADE,
    ...
); 
```

对于多对多关系也是如此：

```
CREATE TABLE foos (
    id SERIAL PRIMARY KEY,
    ....
);
CREATE TABLE bars (
    id SERIAL PRIMARY KEY,
    ...
);
CREATE TABLE foostobars (
    foo_id INT REFERENCES foos (id) ON DELETE CASCADE,
    bar_id INT REFERENCES bars (id) ON DELETE CASCADE
); 
```

我还建议使用 INNER JOIN 而不是表乘法（SELECT FROM foos，bars）。

```
CREATE VIEW foobars AS
SELECT
    foos.id AS foo_id, foos.something,
    bars.id AS bar_id, bars.somethingelse
FROM foos
INNER JOIN bars ON bars.foo_id = foo.id; 
```

多对多 INNER JOINS 相同

```
CREATE VIEW foobars AS
SELECT
    foos.id AS foo_id, foos.something,
    bars.id AS bar_id, bars.somethingelse
FROM foos
INNER JOIN foostobars AS ftb ON ftb.foo_id = foo.id
INNER JOIN bars ON bars.id = ftb.bar_id; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-02T19:57:12.860

这就是我实际处理它的方式：当我遇到唯一约束违规时，我没有更新，而是简单地删除`foo`并让级联处理`bars`. 然后我只是尝试再次插入。我必须使用多个 SQL 语句才能做到这一点，但它似乎有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-02T02:17:17.010

我认为 new.foo_id 在删除的上下文中是不正确的。

不应该是从酒吧中删除 foo_id=old.foo_id 吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-03T22:53:37.993

删除问题是您正在删除的谓词不是基于您要从中删除的表。您需要根据连接谓词进行删除。这看起来有点像：

```
delete b
  from foo f
  join foobar fb
    on f.FooID = fb.FooID
  join bar b
    on b.BarId = fb.BarID
 where f.FooID = 123 
```

这让您可以创建一个 Foo 表、一个 Bar 表和一个记录 Foo 所具有的 Bar 的连接表。您无需编写列表并将它们分开。这是一件坏事，因为查询优化器不能使用索引来识别相关记录——实际上这违反了 1NF 的“无重复组”规则。正确的架构看起来像：

```
Create table Foo (
     FooID int
    ,[Other Foo attributes]
)

Create table Bar (
     BarID int
    ,[Other Bar attributes]
)

Create table FooBar (
     FooID int
    ,BarID int
) 
```

通过适当的索引，M:M 关系可以存储在 FooBar 中，并且 DBMS 可以在其本机数据结构中有效地存储和操作它。

# sql-server - 如何创建指向字段名称中带有句点的 SQL Server 视图的 Jet ODBC 链接？

> ID：160467
> 
> 赞同：2
> 
> 时间：2008-10-02T01:20:29.503
> 
> 标签：sql-server, ms-access, odbc, jet

我需要创建一个从 Access 2003 (Jet) 数据库到 SQL Server 托管视图的 ODBC 链接，其中包含包含句点的别名字段名称，例如：

```
Seq.Group 
```

在视图后面的 SQL 源代码中，字段名称用方括号括起来......

```
SELECT Table._Group AS [Seq.Group] 
```

...所以 SQL Server 不会抱怨创建视图，但是当我尝试从 Jet DB（以编程方式或通过 Access 2003 UI）创建指向它的 ODBC 链接时，我收到错误消息：

> 'Seq.Group' 不是有效名称。确保它不包含无效字符或标点符号，并且不要太长。

不幸的是，我无法修改视图的结构，因为它是另一个产品的一部分，所以我坚持使用字段名称的方式。我*可以*使用无标点符号的字段名称添加自己的视图，但我真的宁愿根本不修改 SQL Server，因为那样每次升级、修补程序等时，这都会成为另一个维护点。有谁知道更好的解决方法?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-02T03:33:41.837

尽管从技术上讲，我并没有最终逃脱该点，但您的建议实际上*确实*使我意识到了另一种选择。在想知道如何将转义码“传递”到“SQL”服务器时，我突然想到：为什么不使用“SQL 传递查询”而不是 ODBC 链接表？因为我只需要对 SQL Server 数据的读取权限，所以它工作正常！谢谢！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-02T01:30:59.727

只是在这里猜测：您是否尝试转义点？像“[Seq\.Group]”这样的东西？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-02T05:35:04.587

另一个建议是在您的 sql 服务器上添加一个新视图，而不是修改现有视图。即使您的初始视图是“解决方案”的一部分，也没有什么能阻止您添加新视图：

```
SELECT Table._Group AS [Seq_Group] 
```

# c# - 如何使用 C# 检查特定硬盘驱动器是否有任何读/写活动？

> ID：160473
> 
> 赞同：1
> 
> 时间：2008-10-02T01:24:08.357
> 
> 标签：c#, .net, file-io

我很好奇如何使用 .NET / C# 评估特定硬盘在给定时刻是否有任何读取或写入活动。其次，评估实际访问速度会很有趣。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-02T01:27:52.747

[通过System.Management 和 System.Management.Instrumentation](http://msdn.microsoft.com/en-us/library/aa720682(VS.71).aspx)命名空间查看.NET Framework 中支持的[Windows Management Instrumentation (WMI)](http://msdn.microsoft.com/en-us/library/aa310909(VS.71).aspx) API 。

# asp.net - ASP.NET 部署

> ID：160475
> 
> 赞同：4
> 
> 时间：2008-10-02T01:24:49.023
> 
> 标签：asp.net, iis

在过去的几个月里，我一直在为我的大学写一个内部网站，里面有很多关于学生的员工报告。一切顺利，但每周一次（ish）我不得不去 IT 让他们登录 IIS 停止应用程序池，清除网站文件夹，清除临时 asp.NET 缓存并将网站替换为新的一个。不是一项大工作，但我更愿意在我想要的时候自己做。

我对 ASP.NET 部署不太了解，IIS 是否有办法让我自己更新网站（如果可能，保持系统运行）？上次我看这个时，我想我发现文件被锁定在网站目录中。

不同的发布选项可以实现什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-02T01:30:40.617

实际上，我使用两种形式：

1) 将表单 VS 发布到本地目录，然后上传（通过 ftp）到服务器。我这样做是为了使用 filezilla ftp 客户端并且不传输 web.config 文件。

2）预编译网站（来自ccnet），压缩它，传输到服务器，连接服务器（远程桌面）并执行一个.bat文件，将应用程序置于离线模式（[App_Offline.htm](http://weblogs.asp.net/scottgu/archive/2006/04/09/442332.aspx)），备份它，解压缩新版本。我们计划为管理员创建第二个网站，以避免手动连接和执行 .bat。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-02T03:05:27.037

为什么要停止应用程序池并清除临时文件？它可以很好地覆盖网站本身的文件。

我唯一要做的就是进入 bin 目录并清除所有随机命名的 .dll 文件。

Visual Studio 也有它自己的部署选项，您可以只提供一个 UNC 路径，它会删除旧文件并复制新版本的站点。它甚至会为您抛出一个 app_offline.html。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-02T01:29:33.910

您可以在 IIS 中激活此网站的 Frontpage-Extensions。他们处理整个部署和更新。我们为每个网站都激活了它们，以便于维护。

Visual Studio 可以直接连接和部署到启用 Frontpage-Extension 的网站，所以应该没有问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-02T02:47:37.763

如果您要走那条路线，您可以覆盖现有的文件。就我个人而言，我有[Cruise Control.NET](http://confluence.public.thoughtworks.org/display/CCNET/Welcome+to+CruiseControl.NET)用于我的部署，我喜欢它。我有颠覆设置，所以我们的开发和登台系统会在每次提交到 svn 时自动更新。然后对于现场我标记我需要的任何内容并更改配置以从现场站点的新标记中提取并强制在其上构建。它工作得很好，你应该检查一下。它还会编译您的 .cs 文件，如果您的代码未构建，则不会部署。我相信 Jeff 将它与 stackoverflow 一起使用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-02T01:40:06.680

您可以使用 Beyond Compare 之类的程序连接到服务器的 FTP（您可以指向网站文件夹）并上传新文件。您可以比较您的文件，逐行查看比较，并仅上传更改的文件。对我来说效果很好。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-02T02:59:55.537

要在我们的 IIS 服务器上安装 ASP.net 应用程序（不需要 Visual Studio），我们从版本控制中签出项目代码，然后在项目文件上运行 msbuild.exe。您可以在 .Net 框架文件夹中找到 msbuild.exe，例如：

C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\

我们唯一要做的就是从其中一台开发机器复制目标定义，这些机器通常存储在：

C:\程序文件\MSBuild\

将 .csproj/.vbproj 文件保留在 web 文件夹中是安全的，因为 IIS 不会为它们提供服务，因为在该机器上没有为它们定义 MIME 类型，但您可以根据需要删除它们。

这个设置也很容易编写脚本，这是一个好处。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-10-02T01:27:40.703

我总是在定期维护期间更新我的网站，通常是在工作时间之外。因此，晚上或周末是关闭服务并更新网站的最佳时间。安排维护，以便每个人都知道他们将停机。

# java - Perl 商店中的 Java 开发：如何选择合适的工具？

> ID：160482
> 
> 赞同：5
> 
> 时间：2008-10-02T01:28:18.593
> 
> 标签：java, perl

我的团队是一个非常异构的组织中的 Perl 商店。尽管我们支持奇怪的 Java、PHP 或 Python 安装，但我们几乎所有的 Web 应用程序和系统/数据编组任务都使用 Perl。我们所有的机器都是 Linux，尽管我们也与 IIS 系统交互。

我们面临着来自管理层的一些压力，要求我们至少在部分工作中迁移到 Java。我想为正确的任务使用正确的工具，但是对于我们的工作，并且由于我们的集体经验，Perl 似乎是适合所有事情的正确工具。

我最初的想法是将 Java 用于对整个组织开放的应用程序，因为 Java 的思想份额比 Perl 多 *。*

有没有人有类似的经历？如果让我选择，我们应该从应用 Java 开始什么样的任务？什么样的任务我们应该坚持坚持使用 Perl？它有什么不同吗？为什么或者为什么不？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-02T01:37:53.673

切换到 Java 是否有特定的技术原因？有什么可以在 Java 中做而不是 Perl 的事情吗？有性能差异吗？其他一些团体/个人是否都在使用 Java，并且不想学习 Perl？

我的经验是，你应该坚持你所知道的。你的团队非常了解 Perl。你已经咬牙切齿了，你们中的一些人可能已经获得了超级 Perl 大师的地位。

所以我会说坚持你所知道的，除非你能想到一些好的理由。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-02T01:37:09.727

如果您的团队将支持这些应用程序，那么请坚持您所知道的。

如果另一个团队正在支持您的应用程序，那么您可能需要考虑 Java，因为它在当今的企业界中具有更大的渗透率。

管理层被告知 Java 是唯一的方法，或者“真正的企业使用 Java”，因此他们认为他们必须使用 Java。我知道我在哪里工作，他们认为 Java 是唯一的语言，而 C# 之类的东西只是用于“战术”项目而不是“战略”——不管这意味着什么。

你应该使用最好的工具来完成这项工作。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-02T02:29:14.393

我建议如果你被 Perl 拉出来的原因是因为性能问题，那么我会推动用 C 重写为 Perl XS 模块的应用程序中最受益的部分，而不是大规模迁移到新的发展环境。我在一个主要是 Perl 的环境中工作，但是我们系统的关键部分是用 C 和 C++ 重写的，以满足性能要求。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-02T02:44:40.737

我在工作的地方经历过这种情况，这可能是一个非常痛苦的过程。

如果你有一个优秀的 Perl 团队，那么我建议你抵制。像样的 java 能做的却是像样的 Perl 做不到的。我可以看到切换的唯一正当理由是，如果您难以雇用体面的 Perl 编码员。

归根结底，如果管理层正在推动它，那么您无能为力，只能尝试找出他们推动它的原因。您的团队接受/拒绝的程度应取决于原因。

如果您确实迁移到 java，我建议您确保雇用知道他们在 java 中做什么的人（不仅知道语言，还知道框架和应用程序服务器）。它不是魔法，而且在 java 中制作垃圾应用程序和任何其他语言一样容易，只是需要更长的时间。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-02T03:48:59.897

管理 ：-（

给他们一个切换到 Java 的成本/收益分析。说明整个开发团队都有这种感觉。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-02T04:19:30.430

Java 的好处不在于语言本身，而在于它周围的支持基础设施。类库是一回事，但你看看应用服务器、消息传递基础设施、开源库和框架，不胜枚举。

因此，选择一个区域并进行一些研究。看看 source forge、apache、codehaus、java.net 和 Google。找到适合该问题的库和框架，看看它们是否会降低您的开发成本。看看 Spring、Hibernate 和 Struts2。看看 IDE 选项，看看它们是否会让您更有效率（Eclipse、NetBeans 和 IntelliJ IDEA 是领先者）。收听 Java Posse 等播客以获取想法并阅读 Java World、InfoQ 和 The Server Side 等网站。

迟早你会想出一些你可以看到的东西会节省你的时间和金钱，当这种情况发生时，你会尝试一下。如果没有按计划进行，请找出原因并在下次做得更好。

如果您有候选人并且对大量的库、产品和框架选择感到困惑，那么有很多经验丰富的堆栈溢出 Java 开发人员愿意提供指导。

我希望这个对你有用。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-02T01:57:28.523

我在以前的公司遇到了同样的情况。有点不同的是，我们想要使用 Java 并远离 Perl。我们的 Perl 遇到了性能问题，并且不能很好地扩展。我们的用户管理也是一团糟。我们迁移到 Java 并使用了一些单点登录功能，我们对结果非常满意。这可能更像是摆脱很久以前编写的遗留代码的情况。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-02T02:14:18.967

如果您被允许迁移到与 Java 兼容的东西，但其语法至少比 Java**更接近**Perl，请查看 Groovy。 [Groovy](http://groovy.codehaus.org/)是一种编译成 Java 字节码的动态语言。

您可以在 Java 类和函数中编写代码，也可以在 Perl/Ruby 的动态“脚本”中编写代码……或者两者兼而有之。

# asp.net - ASP.NET WSAT（网站管理工具）和自定义成员资格提供程序

> ID：160488
> 
> 赞同：7
> 
> 时间：2008-10-02T01:31:31.753
> 
> 标签：asp.net, asp.net-membership, wsat

我正在构建一个 ASP.NET MVC 应用程序，它将具有自定义角色和成员资格提供程序。我一直在寻找管理工具来节省我们一些时间，[WSAT](http://www.codeplex.com/AspNetWSAT)已经跨越了我的道路。乍一看还不错，都是开源的，很简单，如果不行我可以自己修。

第一个问题是你们中的任何人过去是否将 WSAT 用于产品系统。是否值得，我应该考虑它，不使用它的原因是什么？

第二个问题，有谁知道 WSAT 与定制提供商的合作情况如何？

感谢您的反馈意见。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-09-27T11:16:02.323

[MVC WSAT](http://wsat.codeplex.com/)似乎是为 ASP.NET MVC 网站提供网站管理功能的首选工具。

此外，虽然 ASPNetWSAT 工具在 Codeplex 上不再可用，但在某些地方仍然可用。请参阅此线程：[ASP.Net WSAT（网站管理）入门工具包。发生了什么？](http://forums.asp.net/p/1390061/3415574.aspx)并检查最后一个帖子！

为了解决您的具体问题，MyWSAT 工具编写得非常好且功能强大，并且已经在他们自己的网站中被相当多的人使用（当它从 Codeplex 中删除时，很多人都非常沮丧！）。除了编写自己的网站管理工具或购买商业组件之外，它几乎是最好的。

MVC WSAT 工具是对原始 MyWSAT 工具的重写，专门为 ASP.NET MVC 开发的网站制作，对于 MVC 网站，应该使用 MVC WSAT 代替 MyWSAT。

**编辑：**
大约从 2010 年 4 月开始，MyWSAT 项目已由 Codeplex 的原作者再次提供！

在这里获取：http: [//mywsat.codeplex.com/](http://mywsat.codeplex.com/)

# c# - 通用方法调用

> ID：160494
> 
> 赞同：1
> 
> 时间：2008-10-02T01:34:45.663
> 
> 标签：c#, generics

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace GenericCount
{
    class Program
    {
        static int Count1<T>(T a) where T : IEnumerable<T>
        {
            return a.Count();
        }

        static void Main(string[] args)
        {
            List<string> mystring = new List<string>()
            {
                "rob","tx"
            };

            int count = Count1<List<string>>(mystring);******
            Console.WriteLine(count.ToString());

        }
    }
} 
```

我必须在上面指示的代码行中进行哪些更改才能使其正常工作。我只是想通过列表或数组来获取计数。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-02T02:04:54.950

你要这个

```
static int Count1<T>(IEnumerable<T> a)
{
    return a.Count();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-02T01:44:32.003

您的通用约束是错误的。你不能强制它来实现 IEnumerabl<T>

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-02T01:44:39.727

你有“where T : IEnumerable<T>”，这不是你想要的。将其更改为例如“IEnumerable<string>”，它将编译。在这种情况下，“T”是 List<string>，它是一个 IEnumerable<string>。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-02T02:11:15.357

您的 count 方法需要一种 IEnumerable 类型，然后您已将 T 设置为 List 这意味着该方法将需要 IEnumerable> 这不是您传入的内容。

相反，您应该将参数类型限制为 IEnumerable，并且可以使 T 不受约束。

```
namespace GenericCount
{
    class Program
    {
        static int Count1<T>(IEnumerable<T> a)
        {
            return a.Count();
        }

        static void Main(string[] args)
        {
            List<string> mystring = new List<string>()
        {
            "rob","tx"
        };

            int count = Count1(mystring);
             Console.WriteLine(count.ToString());

        }
    }
} 
```

# visual-studio-2008 - 如何从命令行删除解决方案的 TFS 源代码控制绑定

> ID：160495
> 
> 赞同：11
> 
> 时间：2008-10-02T01:34:58.797
> 
> 标签：visual-studio-2008, version-control, tfs

是否有让 VS 2008 从解决方案文件和组成项目文件中删除 TFS 源代码控制绑定的命令行方法？我需要一些可以从批处理文件运行的东西，这样我就不必打开解决方案并单击 2 个提示来永久删​​除绑定。

编辑：删除 *.vspscc 和 *.vssscc 文件后，项目和解决方案文件仍然引用 TFS 源代码控制。因此，当打开解决方案时，系统会提示您从源代码管理中删除解决方案。这会更新解决方案和项目文件以删除绑定，这就是我想要自动化的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-07T00:19:44.463

一位同事写了这个 NAnt 任务来完成它

[http://www.atalasoft.com/cs/blogs/jake/archive/2008/05/21/2custom-nant-task-for-removing-tfs-bindings.aspx](http://www.atalasoft.com/cs/blogs/jake/archive/2008/05/21/2custom-nant-task-for-removing-tfs-bindings.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-06T23:37:05.440

我会编写一个简单的 C# 控制台应用程序，它会遍历一个目录，加载任何 sln 或 proj 文件，并去除源代码控制配置。对于 TFS，您应该只需要编辑 sln 文件，因为我认为我没有看到存储在实际项目中的任何源代码控制信息。

sln文件的结构很简单易懂，相信你只需要找到合适的GlobalSection即可。在记事本中打开 sln 文件以找到它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-02T02:38:52.373

尝试删除 *.vspscc 文件。

# svn - 从项目中删除 .svn 文件夹以进行部署

> ID：160497
> 
> 赞同：15
> 
> 时间：2008-10-02T01:36:51.147
> 
> 标签：svn, deployment, tortoisesvn

我正在使用 subversion (TortoiseSVN) 并且我想从我的项目中删除 .svn 文件夹以进行部署，是否有使用 subversion 自动执行此操作的方法，或者我是否必须为此创建自定义脚本？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-10-02T01:39:17.397

采用

```
svn export <url-to-repo> <dest-path> 
```

它只得到源，没有别的。查看*[svn export](http://svnbook.red-bean.com/en/1.8/svn.ref.svn.c.export.html)*（在*带有 Subversion 的版本控制中*）以获取更多信息。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2008-10-02T01:39:36.307

TortoiseSVN 具有导出功能。`.svn`这将在没有文件夹的其他地方创建整个 SVN 树。

此外，许多 FTP 客户端都有过滤功能，您可以添加`.svn`它以防万一您忘记了。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-10-02T01:40:54.757

不需要脚本。按照建议，使用导出命令：

*   右键单击工作副本的顶层。
*   打开 TortoiseSVN 子菜单
*   选择导出
*   按照屏幕对话框进行操作。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-10-02T02:40:11.747

但是如果你不想使用 svn export （无论出于何种原因）......

```
find /path/to/project/root -name '.svn' -type d -exec rm -rf '{}' \; 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-02T03:20:56.623

在计算机上：

```
rsync -avz --exclude=".svn" /yourprojectwithsvninside/ /yourprojectwithoutsvninside/ 
```

从存储库：

```
svn export http://yourserver/svn/yourproject/ ./yourproject/ 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-06T17:51:53.093

public static: 是 FileZilla 有文件名过滤。查看视图 -> 文件名过滤器。我签入了 v3.1.1

我认为大多数 FTP 客户端现在都有它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-11-09T14:24:38.533

Windows Vista / 7：打开查看隐藏文件夹和文件。在搜索框（Windows 资源管理器窗口的右上角）中，输入`.svn`. 所有`.svn`文件夹将显示在顶部，将它们全部删除并重新打开隐藏文件。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-10-02T01:39:19.287

`svn export <url>`导出没有 .svn 文件夹的干净副本。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-10-02T01:39:30.253

使用导出功能。

# c# - 如何在 ASP.NET 中使用 Google Analytics？

> ID：160509
> 
> 赞同：2
> 
> 时间：2008-10-02T01:42:04.473
> 
> 标签：c#, asp.net, google-analytics

我有一个网页，人们可以在其中注册我的网站。我使用服务器端验证来验证它们。我需要调用一些 Javascript 来告诉 GA 用户是否已注册。后来我需要注册成功的统计数据。

如何在我的服务器端 C# 代码上调用 GA 函数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-07-12T03:29:06.073

我在开源下发布的一个项目允许从 .net 本地代码与 Google Analytics 轻松集成，以通过代码触发页面视图、事件等。

它被称为 GaDotNet，可以在这里找到： [http ://www.diaryofaninja.com/projects/details/ga-dot-net](http://www.diaryofaninja.com/projects/details/ga-dot-net)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-02T03:08:07.233

Rich B 是正确的，谷歌分析是由客户端 javascript 触发的。我看到了有关 Flash 演示的评论，但请记住 Flash 在客户端上执行。

见[闪存示例](http://www.google.com/support/googleanalytics/bin/answer.py?hl=en&answer=55520)

您需要在成功注册时向客户端发出一些 javascript 来模拟目标页面（如在 flash 示例中）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-02T01:43:11.150

我不认为谷歌分析是为了做你想做的事情。您应该只是将代码粘贴到您的母版页中。从那里，您应该能够根据注册后访问登录页面的人数来了解有多少人注册。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-02T01:45:42.780

将 Google 为您提供的代码粘贴到您的页脚或模板中，如果您没有页脚，则该代码会显示在每个页面或每个单独的模板上。

然后，您可以在用户成功或不成功时最终到达的页面上设置“转化目标”。

如果您只想跟踪有多少，将其存储在您自己的数据库中可能会更容易。

顺便说一句，谷歌分析不像你想象的那样工作。这一切都基于对页面的点击和/或获取/发布参数

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-02T02:03:19.073

我不了解 Google Analytics，但我使用过“信标”

这个 URL 上的信息看起来很有希望 [http://code.google.com/apis/analytics/docs/gaJSApiEcommerce.html](http://code.google.com/apis/analytics/docs/gaJSApiEcommerce.html)

# c# - C# 中的部分类

> ID：160514
> 
> 赞同：14
> 
> 时间：2008-10-02T01:44:13.610
> 
> 标签：c#, partial-classes

在 webforms/winforms 生成的代码场景之外，Partial Classes 有很好的用途吗？或者这个功能基本上是为了支持它？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-02T01:49:05.423

它部分支持将生成的代码与程序员代码混合的场景（WebForms、WinForms、LINQ-to-SQL 等）。

还有更多使用它的理由。例如，如果您在大而笨重的文件中有大类，但这些类具有逻辑相关的方法组，则部分类可能是使您的文件大小更易于管理的选项。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-02T02:33:41.947

代码生成是部分类背后的驱动力。需求来自于拥有一个不断变化的代码生成类，但允许开发人员提供自定义代码作为类的一部分，每次进行强制重新生成的更改时都不会覆盖这些代码。

以 WinForms 或 Typed-DataSets 为例（或任何设计者）。每次您对设计器进行更改时，它都会将相应的代码序列化到文件中。假设您需要提供一些生成器不知道的附加方法。如果您将其添加到生成的文件中，您的更改将在下次生成时丢失。

我目前正在处理的一个项目使用所有 DAL、BLL 和业务实体的代码生成。然而，生成器只能得到我们 75% 的信息。其余部分必须手动编码（例如自定义业务逻辑）。我可以假设每个 BLL 类都有一个 SelectAll 方法，因此很容易生成。但是我的客户 BLL 还需要有一个 SelectAllByLocation 方法。我不能把它放在我的生成器中，因为它不是所有 BLL 类的通用。因此，我将所有类生成为部分类，然后在一个单独的文件中定义我的自定义方法。现在，当我的结构发生变化或出于某种原因需要重新生成 BLL 时，我的自定义代码不会被清除。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-02T01:51:36.760

我使用分部类来分离我编写的自定义控件的不同子元素。此外，当与实体创建软件一起使用时，它允许像 LLBLGen 这样的产品创建类的生成版本，以及自定义的用户编辑版本，如果需要重新生成实体，则不会被替换。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-02T02:18:30.440

我经常使用部分类来为每个嵌套类提供自己的文件。我曾研究过一些架构，其中大部分实现只需要一个类，因此我们将这些类嵌套在一个类中。通过使用部分类功能并将每个文件拆分到自己的文件中，使文件更易于维护是有意义的。

我们还使用它们对库存覆盖进行分组或隐藏一组库存属性。像这样的东西。这是一种混合库存更改的便捷方式（只需复制文件并将部分类名称更改为目标类 - 当然，只要目标类也被设为部分）。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-23T03:31:57.287

部分类的另一个可能用途是利用部分方法通过条件编译使方法有选择地消失 - 这对于调试模式诊断代码或专门的单元测试场景非常有用。

您可以声明一种类似于抽象方法的分部方法，然后在另一个分部类中，当您键入关键字“partial”时，您可以利用 Intellisense 来创建该方法的实现。

如果您用条件构建语句包围一个部分，那么您可以轻松地切断仅调试或测试代码。在下面的示例中，在 DEBUG 模式下，调用了 LogSomethingDebugOnly 方法，但在发布版本中，就好像该方法根本不存在 - 一种使诊断代码远离生产代码的好方法，无需一堆分支或多个条件编译块。

```
// Main Part
public partial class Class1
{
    private partial void LogSomethingDebugOnly();

    public void SomeMethod()
    {
        LogSomethingDebugOnly();
        // do the real work
    }
}

// Debug Part - probably in a different file
public partial class Class1
{

    #if DEBUG

    private partial void LogSomethingDebugOnly()
    {
        // Do the logging or diagnostic work
    }

    #endif
} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-02T01:46:37.583

LINQ to SQL 充分利用部分类来扩展设计器生成的代码。我认为您通常会发现设计人员创建的代码正在使用这种分部类模式。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-10-02T01:55:26.063

我发现部分课程非常有帮助。通常它们用于能够扩展自动生成的类。我在一个带有大量单元测试的项目中使用了它们。我的 UT 类具有复杂的依赖关系，在多个类之间分离代码并不是很实用。当然最好使用继承\组合，但在某些情况下，部分类可能会有所帮助。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-02T10:59:44.743

如前所述，我也认为这是代码异味。

如果一个类太大了，需要拆分成更多的文件，意味着它打破了单一职责原则，做了太多的事情。可以将大类分解为一起合作的小类。

如果您必须使用部分类或区域来组织代码，请考虑它们是否应该在自己的类中。它增加了可读性，您将获得更多的代码重用。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2011-07-15T21:52:36.837

也许为时已晚，但请让我也加上我的 2 美分：

*.在处理大型项目时，将一个类分布在单独的文件中允许多个程序员同时处理它。

*.You can easily write your code (for extended functionality) for a VS.NET generated class. This will allow you to write the code of your own need without messing with the system generated code

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-02T01:48:47.017

在我所在的地方，我们有一个程序可以处理来自客户端的传入文件。它的设置使得每个客户端的代码都在它自己的类库项目中，它知道如何处理客户端选择使用的任何格式。

主要代码通过定义库中的类必须实现的相当广泛的接口来使用库（可能应该是几个不同的接口，但现在改变它为时已晚）。有时，在同一个类中涉及的代码比我们通常认为的谨慎得多。部分类允许我们在一定程度上分解它们。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-10-02T01:56:10.743

在相对复杂的 UserControls 上，我将事件处理的东西放在一个文件中，将绘画和属性放在另一个文件中。部分类对此非常有用，通常类的这些部分是相对独立的，能够并排编辑绘画和事件处理非常好。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-10-02T03:45:04.117

几年前，我参与了一个项目，我们有一个类型化的 DataSet 类，其中包含大量代码：DataTables 中的方法、TableAdapter 中的方法、TableAdapter 实例的声明等等。这是项目的一个巨大的中心点，每个人都必须经常工作，并且对部分类代码文件存在很多源代码控制争用。

所以我将代码文件分成修复或六个部分类文件，按功能分组，这样我们就可以处理较小的部分，而不必每次更改一些小东西时都锁定整个文件。

（当然，我们也可以通过不使用独占锁定源代码控制系统来解决问题，但这是另一个问题。）

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-10-02T04:10:15.413

一般来说，我认为这是一种代码味道。

如果您的类如此复杂，那么它可能可以分解为更小的可重用组件。

或者这意味着没有继承层次结构应该有一个。

对于代码生成场景，这很好，但我认为代码生成是另一种代码味道。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2011-03-02T07:01:53.827

我在游戏中迟到了……但只有我的 2 美分……

一种用途可能是将现有遗留代码库中的现有神类重构为多个部分类。它可以提高代码的可发现性 - 如果包含部分类的文件名遵循正确的命名约定。这也可以减少源代码存储库 - 在一定程度上解析和合并。

理想情况下，一个上帝类应该被分解成多个小类——每个小类都有单一的职责。有时执行大中型重构会造成破坏。在这种情况下，部分课程可以提供暂时的救济。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-10-02T02:00:51.217

更正，正如马特指出的那样，局部的两侧都需要在同一个组件中。我的错。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-10-02T02:01:22.807

我在数据访问层中使用它。生成的类如映射器和查询部分。如果我需要添加一个映射器方法，例如执行未生成的精美加载，我将其添加到自定义类中。

最后，在业务层中使用数据层的程序员只能看到一个类具有他或她需要的所有功能。如果数据源发生变化，可以轻松生成通用部分，而无需覆盖自定义内容。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-10-02T02:07:12.963

我刚刚发现部分类的用途。我有一个 [DataContract] 类，用于将数据传递给客户端。我希望客户端能够以特定方式（文本输出）显示类。所以我创建了一个部分类并覆盖了 ToString 方法。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-10-02T02:45:47.753

有时您可能会发现非常旧的代码在工作，这可能使得在不破坏现有代码的情况下重构为不同的元素几乎是不可能的。

当您没有选择或时间来创建更真实的架构时，部分类可以非常容易地在需要的地方分离逻辑。这允许现有代码继续使用相同的架构，同时您更接近更具体的架构。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-10-02T03:51:10.437

您之前使用过节的任何地方都`#region`可能更适合作为部分类中的单独文件。

我个人将部分类用于大型类，其中静态成员放在一个文件中，而实例成员放在另一个文件中。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2008-10-02T10:42:59.777

编辑：Visual Studio 的 DSL 工具使用部分类。

因此，它是许多自动生成的代码使用的功能。自动生成的代码不使用#region，而是转到一个文件，而用户代码（也称为自定义代码）转到另一个文件，甚至在不同的目录中，这样开发人员就不会对这么多无意义的文件感到困惑。

有这个选项很好，你可以结合 - 但不强制使用 - 与继承

此外，将某些类的逻辑分离到几个目录中也很方便。当然，对于机器来说，也是如此，但它增强了用户的可读性体验。

# linq - linqtosql，时间跨度，聚合......可以做到吗？

> ID：160519
> 
> 赞同：1
> 
> 时间：2008-10-02T01:45:27.273
> 
> 标签：linq

这可以用 linqtosql 完成吗？

```
SELECT City, SUM(DATEDIFF(minute,StartDate,Completed)) AS Downtime
FROM Incidents
GROUP BY City 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-02T02:10:54.157

```
using System.Data.Linq.SqlClient; 
```

* * *

```
db.Incidents
  .GroupBy(i => i.City)
  .Select(g => new
  {
    City = g.Key,
    DownTime = g.Sum(i => SqlMethods.DateDiffMinute(i.StartDate, i.Completed))
  }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-02T02:13:35.427

是的。您必须使用 SqlMethods 类。

[http://msdn.microsoft.com/en-us/library/bb882657.aspx](http://msdn.microsoft.com/en-us/library/bb882657.aspx)

# ms-access - 使用波浪号分隔符将 MSAccess 表导出为 Unicode

> ID：160532
> 
> 赞同：2
> 
> 时间：2008-10-02T01:50:21.520
> 
> 标签：ms-access, unicode, utf-8, csv, export

我想从 MSAccess2003 中导出几个表的内容。这些表包含 unicode 日文字符。我想将它们存储为波浪号分隔的文本文件。

我可以使用文件/导出手动执行此操作，并在“高级”对话框中选择波浪号作为字段分隔符和 Unicode 作为代码页。

我可以将其存储为导出规范，但这似乎是特定于表的。

我想使用 VBA 代码导出许多表。

到目前为止，我已经尝试过：

子导出表（）

```
Dim lTbl As Long
Dim dBase As Database
Dim TableName As String

Set dBase = CurrentDb

For lTbl = 0 To dBase.TableDefs.Count
     'If the table name is a temporary or system table then ignore it
    If Left(dBase.TableDefs(lTbl).Name, 1) = "~" Or _
    Left(dBase.TableDefs(lTbl).Name, 4) = "MSYS" Then
         '~ indicates a temporary table
         'MSYS indicates a system level table
    Else
      TableName = dBase.TableDefs(lTbl).Name
      DoCmd.TransferText acExportDelim, "UnicodeTilde", TableName, "c:\" + TableName + ".txt", True
    End If
Next lTbl
Set dBase = Nothing 
```

结束子

当我运行它时，我得到一个异常：

运行时错误“3011”：Microsoft Jet 数据库引擎找不到对象“Allowance1#txt”。确保该对象存在并且正确拼写其名称和路径名。

如果我此时调试，TableName 是“Allowance1”，正如预期的那样。

我想我的 UnicodeTilde 导出规范是特定于表的，所以我不能将它用于多个表。

解决办法是什么？我应该使用 TransferText 以外的其他东西，还是以编程方式创建导出规范？

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-06T00:07:35.813

我最终解决了这个问题。（我现在使用的是 Access 2007，但遇到了与 Access 2003 相同的问题。）

首先，什么不起作用：

即使使用格式正确的 schema.ini，TransferText 也只会使标题行 unicode 和波浪号分隔。（不，我没有把它全部放在一行上，这只是 stackoverflow 上 html 的格式问题。）

```
[MyTable.txt]
CharacterSet = Unicode
Format = Delimited(~)
ColNameHeader = True
NumberDigits = 10
Col1= "Col1" Char Width 10
Col2= "Col2" Integer
Col3= "Col3" Char Width 2 
```

只需使用 select 语句：

```
SELECT * INTO [Text;DATABASE=c:\export\;FMT=Delimited(~)].[MyTable.txt] FROM [MyTable] 
```

完全忽略了 FMT。我发现很难找到有关参数格式的文档。无论我在 FMT 参数中输入什么，我唯一能开始工作的就是 Fixed。其他所有内容都被视为 CSVDelimited。我可以检查这一点，因为 select 语句创建了一个 schema.ini 文件，如下所示：

```
[MyTable.txt]
ColNameHeader=True
CharacterSet=1252
Format=CSVDelimited
Col1=Col1 Char Width 10
Col2=Col2 Integer
Col3=Col3 Char Width 2 
```

我最终的解决方案是创建自己的 schema.ini，然后使用 select 语句。我的模块代码如下所示：

```
Option Compare Database
Option Explicit

    Public Function CreateSchemaFile(bIncFldNames As Boolean, _
                                       sPath As String, _
                                       sSectionName As String, _
                                       sTblQryName As String) As Boolean

         Dim Msg As String
         On Local Error GoTo CreateSchemaFile_Err
         Dim ws As Workspace, db As Database
         Dim tblDef As TableDef, fldDef As Field
         Dim i As Integer, Handle As Integer
         Dim fldName As String, fldDataInfo As String
         ' -----------------------------------------------
         ' Set DAO objects.
         ' -----------------------------------------------
         Set db = CurrentDb()
         ' -----------------------------------------------
         ' Open schema file for append.
         ' -----------------------------------------------
         Handle = FreeFile
         Open sPath & "schema.ini" For Output Access Write As #Handle
         ' -----------------------------------------------
         ' Write schema header.
         ' -----------------------------------------------
         Print #Handle, "[" & sSectionName & "]"
         Print #Handle, "CharacterSet = Unicode"
         Print #Handle, "Format = Delimited(~)"
         Print #Handle, "ColNameHeader = " & _
                         IIf(bIncFldNames, "True", "False")
         Print #Handle, "NumberDigits = 10"
         ' -----------------------------------------------
         ' Get data concerning schema file.
         ' -----------------------------------------------
         Set tblDef = db.TableDefs(sTblQryName)
         With tblDef
            For i = 0 To .Fields.Count - 1
               Set fldDef = .Fields(i)
               With fldDef
                  fldName = .Name
                  Select Case .Type
                     Case dbBoolean
                        fldDataInfo = "Bit"
                     Case dbByte
                        fldDataInfo = "Byte"
                     Case dbInteger
                        fldDataInfo = "Short"
                     Case dbLong
                        fldDataInfo = "Integer"
                     Case dbCurrency
                        fldDataInfo = "Currency"
                     Case dbSingle
                        fldDataInfo = "Single"
                     Case dbDouble
                        fldDataInfo = "Double"
                     Case dbDate
                        fldDataInfo = "Date"
                     Case dbText
                        fldDataInfo = "Char Width " & Format$(.Size)
                     Case dbLongBinary
                        fldDataInfo = "OLE"
                     Case dbMemo
                        fldDataInfo = "LongChar"
                     Case dbGUID
                        fldDataInfo = "Char Width 16"
                  End Select
                  Print #Handle, "Col" & Format$(i + 1) _
                                  & "= """ & fldName & """" & Space$(1); "" _
                                  & fldDataInfo
               End With
            Next i
         End With
         CreateSchemaFile = True
CreateSchemaFile_End:
         Close Handle
         Exit Function
CreateSchemaFile_Err:
         Msg = "Error #: " & Format$(Err.Number) & vbCrLf
         Msg = Msg & Err.Description
         MsgBox Msg
         Resume CreateSchemaFile_End
      End Function

Public Function ExportATable(TableName As String)
Dim ThePath As String
Dim FileName As String
Dim TheQuery As String
Dim Exporter As QueryDef
ThePath = "c:\export\"
FileName = TableName + ".txt"
CreateSchemaFile True, ThePath, FileName, TableName
On Error GoTo IgnoreDeleteFileErrors
FileSystem.Kill ThePath + FileName
IgnoreDeleteFileErrors:
TheQuery = "SELECT * INTO [Text;DATABASE=" + ThePath + "].[" + FileName + "] FROM [" + TableName + "]"
Set Exporter = CurrentDb.CreateQueryDef("", TheQuery)
Exporter.Execute
End Function

Sub ExportTables()

    Dim lTbl As Long
    Dim dBase As Database
    Dim TableName As String

    Set dBase = CurrentDb

    For lTbl = 0 To dBase.TableDefs.Count - 1
         'If the table name is a temporary or system table then ignore it
        If Left(dBase.TableDefs(lTbl).Name, 1) = "~" Or _
        Left(dBase.TableDefs(lTbl).Name, 4) = "MSYS" Then
             '~ indicates a temporary table
             'MSYS indicates a system level table
        Else
          TableName = dBase.TableDefs(lTbl).Name
          ExportATable (TableName)
        End If
    Next lTbl
    Set dBase = Nothing
End Sub 
```

我没有声称这很优雅，但它确实有效。另请注意，stackoverflow 代码格式化程序不喜欢我的 \"，因此它不能很好地打印我的代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-05-24T14:24:32.290

关于这个线程，我偶然发现了一个非常简单的解决方案，它能够在所有表导出中使用一个规范，而通常您必须为每个表创建一个单独的规范；或使用 Richard A 提供的子程序。

过程如下：

创建一个规范，例如`|`用任何表分隔的管道，然后使用 SQL 在访问中打开一个动态集查询，`SELECT * FROM MSysIMEXColumns`然后简单地删除所有结果行。现在，当您尝试使用与创建原始规范不同的表时，此规范不会给出错误 3011，并且本质上是您希望的任何表/查询的通用管道导出规范。

这已在 access 2003 中发现/测试，因此我认为也适用于更高版本。

亲切的问候，

马特·唐南

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-02T05:37:47.717

我得到了部分答案：

我正在用 VBA 编写一个 schema.ini 文件，然后执行我的 TransferText。这是动态创建导出格式。唯一的问题是，虽然我的 schema.ini 包含：

```
ColNameHeader = True
CharacterSet = Unicode
Format = Delimited(~) 
```

只有标题行以带有波浪号分隔符的 unicode 形式出现。其余行是带逗号的 ANSI。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-04T03:56:21.283

我有两个建议给你：

1.  确保将 [schema.ini] 文件中的每个设置放在新行上。（你已经在这里全部列出了一行，所以我想我会确定。）

2.  调用 TransferText 时不要忘记提供 CodePage 参数（最后一个）。如果需要，这是支持的值列表：

[http://msdn.microsoft.com/en-us/library/aa288104.aspx](http://msdn.microsoft.com/en-us/library/aa288104.aspx)

除此之外，看起来您的方法应该有效。

# jquery - 如何使用 jquery 在表格元素中获取“td”？

> ID：160534
> 
> 赞同：11
> 
> 时间：2008-10-02T01:51:55.887
> 
> 标签：jquery

我需要获取表格的“td”元素。我无法将鼠标悬停或 onclick 事件添加到“td”元素，因此我需要使用 JQUERY 添加它们。

我需要 JQUERY 将鼠标悬停和 onclick 事件添加到表中的所有“td”元素。

这就是我需要的，也许有人可以帮助我？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-10-02T01:57:09.243

```
$(function() {
    $("table#mytable td").mouseover(function() {
        //The onmouseover code
    }).click(function() {
        //The onclick code
    });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-02T01:59:32.390

处理以下代码以帮助您入门。它应该做你需要的。

```
$("td").hover(function(){
   $(this).css("background","#0000ff");
},
function(){
  $(this).css("background","#ffffff");
}); 
```

您可以[将此作为参考，这是我提取该代码的地方](http://www.ibm.com/developerworks/web/library/wa-jquery2/)。

# javascript - 邮政编码（美国邮政编码）验证

> ID：160550
> 
> 赞同：39
> 
> 时间：2008-10-02T01:57:52.207
> 
> 标签：javascript, validation

我以为人们会一起做一些小的代码项目，但我没有看到他们，所以这里有一个简单的：

验证有效美国邮政编码的代码。我知道那里有邮政编码数据库，但仍有一些用途，例如网页、快速验证，以及邮政编码不断发布的事实，因此您可能想要使用弱验证。

我在我的 wiki/blog 的一个附带项目中写了一些关于邮政编码的内容：

[https://benc.fogbugz.com/default.asp?W24](https://benc.fogbugz.com/default.asp?W24)

还有一种新的、奇怪的邮政编码。

[https://benc.fogbugz.com/default.asp?W42](https://benc.fogbugz.com/default.asp?W42)

我可以编写 javascript 代码，但是看看我们可以在这里获得多少种语言会很有趣。

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2008-10-02T02:11:07.027

**Javascript 正则表达式文字**：

美国邮政编码： `/(^\d{5}$)|(^\d{5}-\d{4}$)/`

```
var isValidZip = /(^\d{5}$)|(^\d{5}-\d{4}$)/.test("90210"); 
```

一些国家/地区使用[Postal Codes](http://en.wikipedia.org/wiki/Postal_code)，这会导致这种模式失败。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-02-13T15:11:06.567

```
function isValidUSZip(sZip) {
   return /^\d{5}(-\d{4})?$/.test(sZip);
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-02T04:29:31.030

这是一个基于国家/地区代码验证邮政编码的 JavaScript 函数。它允许某种自由格式。您也可以为其他国家/地区添加案例。请注意，默认情况下允许使用空邮政编码，因为并非所有国家/地区都使用它们。

```
function isValidPostalCode(postalCode, countryCode) {
    switch (countryCode) {
        case "US":
            postalCodeRegex = /^([0-9]{5})(?:[-\s]*([0-9]{4}))?$/;
            break;
        case "CA":
            postalCodeRegex = /^([A-Z][0-9][A-Z])\s*([0-9][A-Z][0-9])$/;
            break;
        default:
            postalCodeRegex = /^(?:[A-Z0-9]+([- ]?[A-Z0-9]+)*)?$/;
    }
    return postalCodeRegex.test(postalCode);
} 
```

仅供参考第二个链接是指虚荣的邮政编码似乎是愚人节的玩笑。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2011-09-16T14:37:24.463

如果您要为加拿大做事，请记住并非所有字母都有效

这些字母无效：D、F、I、O、Q 或 U 字母 W 和 Z 不用作第一个字母。还有一些人在第三个字符之后使用可选空格。

这是加拿大邮政编码的正则表达式：

`new RegExp(/^[abceghjklmnprstvxy][0-9][abceghjklmnprstvwxyz]\s?[0-9][abceghjklmnprstvwxyz][0-9]$/i)`

最后一个*i*使它不区分大小写。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-02-20T19:05:43.907

这是 jQuery Validate 插件`additional-methods.js`文件中的一个...

```
jQuery.validator.addMethod("zipUS", function(value, element) {
    return /(^\d{5}$)|(^\d{5}-\d{4}$)/.test(value);
}, "Please specify a valid US zip code."); 
```

* * *

**编辑**：由于上面的代码是 jQuery Validate 插件的一部分，它取决于`.addMethod()`方法。

删除对插件的依赖并使其更通用....

```
function checkZip(value) {
    return (/(^\d{5}$)|(^\d{5}-\d{4}$)/).test(value);
}; 
```

**示例用法：http: [//jsfiddle.net/5PNcJ/](http://jsfiddle.net/5PNcJ/)**

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-10-31T00:34:24.320

对于您遇到的验证问题，这是一个很好的 JavaScript 解决方案：

```
/\b\d{5}-\d{4}\b/ 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-10-20T19:47:59.790

当我在邮件行业工作了 17 年时，我在这个领域看到了各种各样的数据输入，我发现有趣的是，有多少人不知道他们的地址，因为它是由 USPS 定义的。我仍然看到这样的地址：

XYZ 学院
IT 部门
City, St ZIP

最糟糕的部分是邮件 99% 的时间都已送达，而另外 1% 的时间是由于地址不完整而退回的。

在之前的一篇文章中，有人提到 USPS CASS，该软件不是免费的。

正则表达式邮政编码测试器很好，我使用表达式来确定美国、加利福尼亚、英国或澳大利亚的邮政编码。我见过日本和其他国家的表达方式，它们只会在选择拉链所属的正确国家时增加挑战。

到目前为止，最好的答案是对州和国家使用下拉列表。然后根据需要使用表格进一步验证。只是为了给您一个想法，仅前 5 位数字就有 84052 个可接受的美国城市街邮编组合。根据 ISO，有 249 个有效国家，美国有 65 个州/领地。

还有军事、仅邮政信箱和唯一邮政编码类。KISS 在这里适用。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-08-22T21:10:48.637

建议您查看 USPS 地址信息 API。您可以验证 zip 并获取标准格式的地址。[https://www.usps.com/business/web-tools-apis/address-information.htm](https://www.usps.com/business/web-tools-apis/address-information.htm)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-02-19T11:16:01.797

检查有效加拿大邮政编码的一种方法是 -

```
function isValidCAPostal(pcVal) {
   return ^[A-Za-z][0-9][A-Za-z]\s{0,1}[0-9][A-Za-z][0-9]$/.test(pcVal);
} 
```

希望这会对某人有所帮助。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-10-20T20:01:54.653

为了进一步回答我，如果不使用 USPS 作为最终处理程序，UPS 和 FedEx 就无法将其运送到 PO BOX。那里的大多数运输软件都不允许其标准服务使用 PO Box zip。邮政信箱拉链的示例是 00604 - RAMEY, PR 和 06141 - HARTFORD, CT。

验证邮政编码的整个需求实际上可能是您走多远、预算是多少、时间线是多少的问题。

就像任何带有表达式的东西一样测试，测试，测试，再测试。我有一个用于状态验证的表达式，发现 YORK 在它应该失败的时候通过了。成千上万的人进入纽约，纽约 10279，呃。

另请记住，USPS 不喜欢 N. Market St. 等标点符号，并且对 Lane、Place、North、Corporation 等具有非常具体的可接受缩写。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-05-27T14:51:00.073

Drupal 7 在这里也有一个简单的解决方案，这将允许您针对多个国家/地区进行验证。

[https://drupal.org/project/postal_code_validation](https://drupal.org/project/postal_code_validation)

你也需要这个模块
[https://drupal.org/project/postal_code](https://drupal.org/project/postal_code)

[在http://simplytest.me/](http://simplytest.me/)中测试它

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2008-10-02T02:30:22.050

你指的是地址验证吗？就像迈克之前的回答一样，你需要迎合其他 95% 的人。

您可以做的是当用户选择他们的国家时，然后启用验证。地址验证和邮政编码验证是两个不同的东西。验证 ZIP 只是确保它的整数。地址验证是验证实际地址的准确性，最好用于邮寄。

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2009-02-13T15:05:04.723

要允许用户也输入带有小写字母的加拿大邮政编码，正则表达式需要如下所示：

/^([a-zA-Z][0-9][a-zA-Z])\s*([0-9][a-zA-Z][0-9])$/

# c# - 我的表单从另一个线程启动时无法正确显示

> ID：160555
> 
> 赞同：4
> 
> 时间：2008-10-02T01:59:14.870
> 
> 标签：c#, winforms, multithreading

情况如下：我正在开发一个具有以下结构的简单应用程序：

*   FormMain（启动点）
*   表单通知
*   复合函数

对？

好吧，在**FormMain**我有以下功能：

```
private void DoItInNewThread(ParameterizedThreadStart pParameterizedThreadStart, object pParameters, ThreadPriority pThreadPriority)
{
    Thread oThread = new Thread(pParameterizedThreadStart);
    oThread.CurrentUICulture = Settings.Instance.Language;
    oThread.IsBackground = true;
    oThread.Priority = pThreadPriority;
    oThread.Name = "μRemote: Background operation";
    oThread.Start(pParameters);
} 
```

**因此，每次我需要调用位于ComplexFunctions**上的耗时方法时，我都会执行以下操作：

```
// This is FormMain.cs
string strSomeParameter = "lala";
DoItInNewThread(new ParameterizedThreadStart(ComplexFunctions.DoSomething), strSomeParameter, ThreadPriority.Normal); 
```

另一个类，FormNotification，它是一个向用户显示进程的一些信息的表单。这个 FormNotification 可以从 FormMain 或 ComplexFunctions 中调用。例子：

```
// This is ComplexFunctions.cs
public void DoSomething(string pSomeParameter)
{
    // Imagine some time consuming task
    FormNotification formNotif = new FormNotification();
    formNotif.Notify();
} 
```

FormNotify 有一个计时器，因此，10 秒后关闭表单。我没有使用 formNotif.ShowDialog 因为我不想把焦点放在这个表单上。您可以查看[此链接](https://stackoverflow.com/questions/156046/show-a-form-without-stealing-focus-in-c)以查看我在 Notify 中所做的事情。

好的，这就是问题所在：当我从 ComplexFunction 调用FormNotify 时，它是从**FormMain****中**的另一个线程**调用**的......这个**FormNotify**在几毫秒后消失。当你做这样的事情时，效果是一样的：

```
using(FormSomething formSomething = new FormSomething)
{
   formSomething.Show();
} 
```

**如何避免这种情况？**

这些是我不想使用的可能解决方案：

*   在 FormNotify 中使用 Thread.Sleep(10000)
*   使用 FormNotif.ShowDialog()

这是一个简化的场景（FormNotify 做了一些其他花哨的东西，只停留 10 秒，但它们与问题无关）。

谢谢你的时间！！！请，对不起我的英语。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-02T02:03:07.513

不允许您从其他线程进行 WinForms 调用。查看表单中的 BeginInvoke——您可以调用委托以从 UI 线程显示表单。

编辑：来自评论（不要将 CheckForIllegalCrossThreadCalls 设置为 false）。

**更多信息** 几乎每个 GUI 库都设计为只允许在为该目的指定的单个线程（称为 UI 线程）中进行更改 GUI 的调用。如果您在另一个线程中，则需要安排调用以更改要在 UI 线程中进行的 GUI。在 .NET 中，执行此操作的方法是调用 Invoke（同步）或 BeginInvoke（异步）。等效的 Java Swing 调用是 invokeLater() —— 几乎每个 GUI 库中都有类似的函数。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-02T17:42:31.420

几乎每个 GUI 库都设计为只允许在为该目的指定的单个线程（称为 UI 线程）中进行更改 GUI 的调用。如果您在另一个线程中，则需要安排调用以更改要在 UI 线程中进行的 GUI。在 .NET 中，执行此操作的方法是调用 Invoke（同步）或 BeginInvoke（异步）。等效的 Java Swing 调用是 invokeLater() —— 几乎每个 GUI 库中都有类似的函数。

有一种叫做线程亲和性的东西。WinForm 应用程序中有两个线程，一个用于渲染，一个用于管理用户界面。您只处理用户界面线程。渲染线程保持隐藏 - 在后台运行。在 UI 线程上创建的唯一对象可以操作 UI - 即对象与 UI 线程具有线程关联性。

因为，您正在尝试从与 UI 线程不同的线程更新 UI（显示通知）。所以在你的工作线程中定义一个委托并让 FormMain 监听这个事件。在事件处理程序（在 FormMain 中定义）编写代码以显示 FormNotify。

当您想要显示通知时，从工作线程触发事件。

当控件的创建线程以外的线程尝试访问该控件的方法或属性之一时，通常会导致不可预知的结果。常见的无效线程活动是对访问控件的 Handle 属性的错误线程的调用。将 CheckForIllegalCrossThreadCalls 设置为 true，以便在调试时更轻松地查找和诊断此线程活动。请注意，当应用程序在调试器之外启动时，非法的跨线程调用总是会引发异常。

注意：仅应在调试情况下将 CheckForIllegalCrossThreadCalls 设置为 ture。将出现不可预测的结果，你最终会试图去寻找那些你很难找到的错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-02T02:44:16.197

有一种叫做线程亲和性的东西。WinForm 应用程序中有两个线程，一个用于渲染，一个用于管理用户界面。您只处理用户界面线程。渲染线程保持隐藏 - 在后台运行。在 UI 线程上创建的唯一对象可以操作 UI - 即对象与 UI 线程具有线程关联性。

因为，您正在尝试从与 UI 线程不同的线程更新 UI（显示通知）。所以在你的工作线程中定义一个委托并让 FormMain 监听这个事件。在事件处理程序（在 FormMain 中定义）编写代码以显示 FormNotify。

当您想要显示通知时，从工作线程触发事件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-02T02:31:08.193

使用**SetWindowPos** API 调用来确保您的通知表单是最顶层的窗口。这篇文章解释了如何：

[http://www.pinvoke.net/default.aspx/user32/SetWindowPos.html](http://www.pinvoke.net/default.aspx/user32/SetWindowPos.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-09-14T20:50:47.713

假设您在表单中有按钮，并且希望`Form1`在用户单击该按钮时打开另一个表单

```
private void button1_Click(object sender, EventArgs e)
{
    Thread t = new Thread(new ThreadStart(this.ShowForm1));
    t.Start();
} 
```

您需要做的就是检查`InvokeRequired`属性，如果是，则调用表单传递`ShowForm1`委托的 Invoke 方法，这将最终以递归调用方式结束，其中`InvokeRequired`将为 false

```
delegate void Func();
private void ShowForm1()
{            
    if (this.InvokeRequired)
    {
        Func f = new Func(ShowForm1);
        this.Invoke(f);
    }
    else
    {
        Form1 form1 = new Form1();
        form1.Show();
    }            
} 
```

# unit-testing - 在 Selenium 中定义自定义操作

> ID：160557
> 
> 赞同：3
> 
> 时间：2008-10-02T02:00:00.233
> 
> 标签：unit-testing, selenium

我有一个 Selenium 测试用例，它将日期输入到由三个下拉列表（年、月和日）组成的日期选择器中。

```
select validity_Y label=2008
select validity_M label=08
select validity_D label=08 
```

这部分在整个测试用例中重复了很多次。我想通过定义我的自定义操作“selectValidity”来减少它，这样我就可以减少冗余，比如

```
selectValidity 2008,08,08 
```

将宏或子例程添加到测试用例的最佳（最简单、最干净）的方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-02T02:40:24.520

我认为您正在用[Selenese](http://selenium-rc.openqa.org/selenese.html)编写测试代码。如果是这样，您是否考虑过使用多种语言中的任何一种的客户端驱动程序之一？他们有[java](http://selenium-rc.openqa.org/java.html)、[.net](http://selenium-rc.openqa.org/dotnet.html)、[perl](http://selenium-rc.openqa.org/perl.html)、[ruby](http://selenium-rc.openqa.org/ruby.html)​​ 、[javascript](http://selenium-rc.openqa.org/js.html)、[php](http://selenium-rc.openqa.org/php.html)和[python](http://selenium-rc.openqa.org/python.html)。它们中的每一个都有子程序。据说，[IDE](http://selenium-rc.openqa.org/selenium-ide/)可以将您现有的 Selenese 测试转换为其中的大部分。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-02T02:55:45.203

您可以在 JS 文件中定义您的辅助 JS 函数，并将其作为核心扩展或 user-extensions.js 的一部分（就像[UI-Elements](http://ttwhy.org/code/ui-doc.html)所做的那样）。然后一个名为 selectValidity 的 JS 函数可以使用 DOM 来选择值。

# netflix - 编程比赛（有奖）

> ID：160567
> 
> 赞同：12
> 
> 时间：2008-10-02T02:04:06.713
> 
> 标签：netflix

过去，我曾尝试解决[永恒之谜](http://en.wikipedia.org/wiki/Eternity_puzzle)（1,000,000 英镑奖金）和[Netflix 奖金](http://www.netflixprize.com/)（1,000,000 美元）。我也没有赢，但他们激励我去探索一个新的领域。

您还知道/参加过哪些其他有奖竞赛？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-02T02:05:13.513

[http://www.topcoder.com/](http://www.topcoder.com/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-02T02:12:18.613

[千年](http://www.claymath.org/millennium/)问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-02T02:24:24.403

有一个永恒的 2 项目，虽然它已经出来了一段时间，第一个解决方案正在 12 月 31 日检查。

[http://www.eternityii.com/](http://www.eternityii.com/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-02T02:05:50.750

[Netflix 奖](http://www.netflixprize.com/)（用于投票）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-04T02:40:08.500

我参加了 STM32-Primer [2009 编程竞赛](http://www.stm32circle.com/projects/list.php?contest_2009=1)，我的[Solitaire 程序](http://www.stm32circle.com/projects/project.php?id=74)获得了第 5 名。

[替代文字 http://www.stm32circle.com/projects/contestAnnouncement.gif](http://www.stm32circle.com/projects/contestAnnouncement.gif)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-08-26T14:54:34.217

我创建了一个网站，其中包含每月运行的名为[Code Competition](http://codecompetition.com)的规模小得多的编程竞赛 。

# c# - WPF 应用程序没有输出到控制台？

> ID：160587
> 
> 赞同：131
> 
> 时间：2008-10-02T02:12:03.980
> 
> 标签：c#, .net, wpf, console

我正在使用`Console.WriteLine()`一个非常简单的 WPF 测试应用程序，但是当我从命令行执行应用程序时，我没有看到任何内容被写入控制台。有谁知道这里可能会发生什么？

我可以通过在 VS 2008 中创建 WPF 应用程序来重现它，并简单地添加`Console.WriteLine("text")`它执行的任何位置。有任何想法吗？

我现在需要的只是简单的`Console.WriteLine()`. 我意识到我可以使用 log4net 或其他一些日志记录解决方案，但我真的不需要这个应用程序的那么多功能。

**编辑：**我应该记得那`Console.WriteLine()`是针对控制台应用程序的。哦，好吧，没有愚蠢的问题，对吧？:-) 我`System.Diagnostics.Trace.WriteLine()`现在只使用和 DebugView。

* * *

## 回答 #1

> 赞同：181
> 
> 时间：2008-10-02T02:20:35.100

您可以使用

```
Trace.WriteLine("text"); 
```

这将输出到 Visual Studio 中的“输出”窗口（调试时）。

确保包含诊断程序集：

```
using System.Diagnostics; 
```

* * *

## 回答 #2

> 赞同：141
> 
> 时间：2008-10-02T02:17:12.097

右键单击项目，“属性”，“应用程序”选项卡，将“输出类型”更改为“控制台应用程序”，然后它也会有一个控制台。

* * *

## 回答 #3

> 赞同：96
> 
> 时间：2009-04-05T07:14:31.997

在实际调用任何 Console.Write 方法之前，您必须手动创建一个控制台窗口。这将使控制台在不更改项目类型的情况下正常工作（对于 WPF 应用程序将不起作用）。

这是一个完整的源代码示例，说明了 ConsoleManager 类的外观，以及如何使用它来启用/禁用控制台，与项目类型无关。

使用以下课程，您只需要`ConsoleManager.Show()`在任何调用之前写某处`Console.Write`...

```
[SuppressUnmanagedCodeSecurity]
public static class ConsoleManager
{
    private const string Kernel32_DllName = "kernel32.dll";

    [DllImport(Kernel32_DllName)]
    private static extern bool AllocConsole();

    [DllImport(Kernel32_DllName)]
    private static extern bool FreeConsole();

    [DllImport(Kernel32_DllName)]
    private static extern IntPtr GetConsoleWindow();

    [DllImport(Kernel32_DllName)]
    private static extern int GetConsoleOutputCP();

    public static bool HasConsole
    {
        get { return GetConsoleWindow() != IntPtr.Zero; }
    }

    /// <summary>
    /// Creates a new console instance if the process is not attached to a console already.
    /// </summary>
    public static void Show()
    {
        //#if DEBUG
        if (!HasConsole)
        {
            AllocConsole();
            InvalidateOutAndError();
        }
        //#endif
    }

    /// <summary>
    /// If the process has a console attached to it, it will be detached and no longer visible. Writing to the System.Console is still possible, but no output will be shown.
    /// </summary>
    public static void Hide()
    {
        //#if DEBUG
        if (HasConsole)
        {
            SetOutAndErrorNull();
            FreeConsole();
        }
        //#endif
    }

    public static void Toggle()
    {
        if (HasConsole)
        {
            Hide();
        }
        else
        {
            Show();
        }
    }

    static void InvalidateOutAndError()
    {
        Type type = typeof(System.Console);

        System.Reflection.FieldInfo _out = type.GetField("_out",
            System.Reflection.BindingFlags.Static | System.Reflection.BindingFlags.NonPublic);

        System.Reflection.FieldInfo _error = type.GetField("_error",
            System.Reflection.BindingFlags.Static | System.Reflection.BindingFlags.NonPublic);

        System.Reflection.MethodInfo _InitializeStdOutError = type.GetMethod("InitializeStdOutError",
            System.Reflection.BindingFlags.Static | System.Reflection.BindingFlags.NonPublic);

        Debug.Assert(_out != null);
        Debug.Assert(_error != null);

        Debug.Assert(_InitializeStdOutError != null);

        _out.SetValue(null, null);
        _error.SetValue(null, null);

        _InitializeStdOutError.Invoke(null, new object[] { true });
    }

    static void SetOutAndErrorNull()
    {
        Console.SetOut(TextWriter.Null);
        Console.SetError(TextWriter.Null);
    }
} 
```

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2017-01-19T02:07:11.710

旧帖子，但我遇到了这个，所以如果你想在 Visual Studio 的 WPF 项目中输出一些东西到输出，现代方法是：

包括这个：

```
using System.Diagnostics; 
```

进而：

```
Debug.WriteLine("something"); 
```

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2009-04-27T11:52:01.743

尽管 John Leidegren 不断否定这个想法，但 Brian 是正确的。我刚刚让它在 Visual Studio 中工作。

需要明确的是，WPF 应用程序默认情况下不会创建控制台窗口。

您必须创建一个 WPF 应用程序，然后将 OutputType 更改为“控制台应用程序”。当您运行该项目时，您将看到一个控制台窗口，前面是您的 WPF 窗口。

它看起来不太漂亮，但我发现它很有帮助，因为我希望我的应用程序可以从命令行运行并在其中提供反馈，然后对于某些命令选项，我会显示 WPF 窗口。

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2014-05-30T15:10:06.950

[使用命令行重定向](http://technet.microsoft.com/en-us/library/bb490982.aspx)可以看到用于控制台的输出。

例如：

```
C:\src\bin\Debug\Example.exe > output.txt 
```

将所有内容写入`output.txt`文件。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-10-02T05:50:56.793

我使用 Console.WriteLine() 在输出窗口中使用...

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-08-06T06:42:03.037

我创建了一个解决方案，混合了各种帖子的信息。

它是一个表单，包含一个标签和一个文本框。控制台输出被重定向到文本框。

还有一个名为 ConsoleView 的类实现了三个公共方法：Show()、Close() 和 Release()。最后一个是保持打开控制台并激活关闭按钮以查看结果。

这些表单称为 FrmConsole。这是 XAML 和 c# 代码。

使用非常简单：

```
ConsoleView.Show("Title of the Console"); 
```

打开控制台。采用：

```
System.Console.WriteLine("The debug message"); 
```

用于向控制台输出文本。

采用：

```
ConsoleView.Close(); 
```

对于关闭控制台。

```
ConsoleView.Release(); 
```

离开控制台并启用关闭按钮

XAML

```
<Window x:Class="CustomControls.FrmConsole"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:local="clr-namespace:CustomControls"
    mc:Ignorable="d"
    Height="500" Width="600" WindowStyle="None" ResizeMode="NoResize" WindowStartupLocation="CenterScreen" Topmost="True" Icon="Images/icoConsole.png">
<Grid>
    <Grid.RowDefinitions>
        <RowDefinition Height="40"/>
        <RowDefinition Height="*"/>
        <RowDefinition Height="40"/>
    </Grid.RowDefinitions>
    <Label Grid.Row="0" Name="lblTitulo" HorizontalAlignment="Center" HorizontalContentAlignment="Center" VerticalAlignment="Center" VerticalContentAlignment="Center" FontFamily="Arial" FontSize="14" FontWeight="Bold" Content="Titulo"/>
    <Grid Grid.Row="1">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="10"/>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="10"/>
        </Grid.ColumnDefinitions>
        <TextBox Grid.Column="1" Name="txtInner" FontFamily="Arial" FontSize="10" ScrollViewer.CanContentScroll="True" VerticalScrollBarVisibility="Visible" HorizontalScrollBarVisibility="Visible" TextWrapping="Wrap"/>
    </Grid>
    <Button Name="btnCerrar" Grid.Row="2" Content="Cerrar" Width="100" Height="30" HorizontalAlignment="Center" HorizontalContentAlignment="Center" VerticalAlignment="Center" VerticalContentAlignment="Center"/>
</Grid> 
```

窗口代码：

```
partial class FrmConsole : Window
{
    private class ControlWriter : TextWriter
    {
        private TextBox textbox;
        public ControlWriter(TextBox textbox)
        {
            this.textbox = textbox;
        }

        public override void WriteLine(char value)
        {
            textbox.Dispatcher.Invoke(new Action(() =>
            {
                textbox.AppendText(value.ToString());
                textbox.AppendText(Environment.NewLine);
                textbox.ScrollToEnd();
            }));
        }

        public override void WriteLine(string value)
        {
            textbox.Dispatcher.Invoke(new Action(() =>
            {
                textbox.AppendText(value);
                textbox.AppendText(Environment.NewLine);
                textbox.ScrollToEnd();
            }));
        }

        public override void Write(char value)
        {
            textbox.Dispatcher.Invoke(new Action(() =>
            {
                textbox.AppendText(value.ToString());
                textbox.ScrollToEnd();
            }));
        }

        public override void Write(string value)
        {
            textbox.Dispatcher.Invoke(new Action(() =>
            {
                textbox.AppendText(value);
                textbox.ScrollToEnd();
            }));
        }

        public override Encoding Encoding
        {
            get { return Encoding.UTF8; }

        }
    }

    //DEFINICIONES DE LA CLASE
    #region DEFINICIONES DE LA CLASE

    #endregion

    //CONSTRUCTORES DE LA CLASE
    #region CONSTRUCTORES DE LA CLASE

    public FrmConsole(string titulo)
    {
        InitializeComponent();
        lblTitulo.Content = titulo;
        Clear();
        btnCerrar.Click += new RoutedEventHandler(BtnCerrar_Click);
        Console.SetOut(new ControlWriter(txtInner));
        DesactivarCerrar();
    }

    #endregion

    //PROPIEDADES
    #region PROPIEDADES

    #endregion

    //DELEGADOS
    #region DELEGADOS

    private void BtnCerrar_Click(object sender, RoutedEventArgs e)
    {
        Close();
    }

    #endregion

    //METODOS Y FUNCIONES
    #region METODOS Y FUNCIONES

    public void ActivarCerrar()
    {
        btnCerrar.IsEnabled = true;
    }

    public void Clear()
    {
        txtInner.Clear();
    }

    public void DesactivarCerrar()
    {
        btnCerrar.IsEnabled = false;
    }

    #endregion  
} 
```

ConsoleView 类的代码

```
static public class ConsoleView
{
    //DEFINICIONES DE LA CLASE
    #region DEFINICIONES DE LA CLASE
    static FrmConsole console;
    static Thread StatusThread;
    static bool isActive = false;
    #endregion

    //CONSTRUCTORES DE LA CLASE
    #region CONSTRUCTORES DE LA CLASE

    #endregion

    //PROPIEDADES
    #region PROPIEDADES

    #endregion

    //DELEGADOS
    #region DELEGADOS

    #endregion

    //METODOS Y FUNCIONES
    #region METODOS Y FUNCIONES

    public static void Show(string label)
    {
        if (isActive)
        {
            return;
        }

        isActive = true;
        //create the thread with its ThreadStart method
        StatusThread = new Thread(() =>
        {
            try
            {
                console = new FrmConsole(label);
                console.ShowDialog();
                //this call is needed so the thread remains open until the dispatcher is closed
                Dispatcher.Run();
            }
            catch (Exception)
            {
            }
        });

        //run the thread in STA mode to make it work correctly
        StatusThread.SetApartmentState(ApartmentState.STA);
        StatusThread.Priority = ThreadPriority.Normal;
        StatusThread.Start();

    }

    public static void Close()
    {
        isActive = false;
        if (console != null)
        {
            //need to use the dispatcher to call the Close method, because the window is created in another thread, and this method is called by the main thread
            console.Dispatcher.InvokeShutdown();
            console = null;
            StatusThread = null;
        }

        console = null;
    }

    public static void Release()
    {
        isActive = false;
        if (console != null)
        {
            console.Dispatcher.Invoke(console.ActivarCerrar);
        }

    }
    #endregion
} 
```

我希望这个结果有用。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-08-12T03:08:27.217

看看这个帖子，对自己很有帮助。下载代码示例：

[http://www.codeproject.com/Articles/335909/Embedding-a-Console-in-aC-Application](http://www.codeproject.com/Articles/335909/Embedding-a-Console-in-a-C-Application)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-10-26T12:51:02.597

我最近也遇到了这个问题。

如果 Brians 解决方案（在项目设置中更改为控制台应用程序）没有解决问题：尝试将目标框架从 .NET 5.0 更改为 .NET Core 3.1。

# wpf - 在 WPF/WCF 应用程序中使用 CSLA 的经验

> ID：160589
> 
> 赞同：1
> 
> 时间：2008-10-02T02:13:00.267
> 
> 标签：wpf, wcf, csla

有没有人在具有 WPF 前端和实体的 WCF 线的应用程序中使用 CSLA？

如果是这样，您使用了哪个“实体框架”？（nHibernate、Linq 等...）有什么问题？它对你有什么帮助？

我关心为应用程序实现这一点，不知道数据绑定、UI/实体验证或延迟加载将如何反应。

我们还担心来自 WCF 的消息大小，尤其是实体的深度。

有压力测试吗？我试图弄清楚这实际上是为什么大小的应用程序/实体设计的。

如果您能帮助回答这些问题中的任何一个，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-02T02:50:06.650

我对 CSLA 了解不多，但我已经使用 WPF + LINQ + WCF 构建了应用程序，这种组合适用于与 WPF 的单向数据绑定，但我们需要一个中间对象类（WPF 的 ViewModel）来获得 TwoWay在职的。这些类可能是 WCF 类的精确副本（在大多数情况下），但它会实现 INotiftPropertyChanged。

# c# - 组合数组中的多个 LINQ 表达式

> ID：160604
> 
> 赞同：2
> 
> 时间：2008-10-02T02:19:22.717
> 
> 标签：c#, .net, linq, expression

我正在尝试组合这样的功能列表。

我有这个：

```
Func<int, bool>[] criteria = new Func<int, bool>[3];
criteria[0] = i => i % 2 == 0;
criteria[1] = i => i % 3 == 0;
criteria[2] = i => i % 5 == 0; 
```

我想要这个：

```
Func<int, bool>[] predicates = new Func<int, bool>[3];
predicates[0] = i => i % 2 == 0;
predicates[1] = i => i % 2 == 0 && i % 3 == 0;
predicates[2] = i => i % 2 == 0 && i % 3 == 0 && i % 5 == 0; 
```

到目前为止，我有以下代码：

```
Expression<Func<int, bool>>[] results = new Expression<Func<int, bool>>[criteria.Length];

for (int i = 0; i < criteria.Length; i++)
{
    results[i] = f => true;
    for (int j = 0; j <= i; j++)
    {
        Expression<Func<int, bool>> expr = b => criteria[j](b);
        var invokedExpr = Expression.Invoke(
            expr, 
            results[i].Parameters.Cast<Expression>());
        results[i] = Expression.Lambda<Func<int, bool>>(
            Expression.And(results[i].Body, invokedExpr), 
            results[i].Parameters);
    }
}
var predicates = results.Select(e => e.Compile()).ToArray();

Console.WriteLine(predicates[0](6)); // Returns true
Console.WriteLine(predicates[1](6)); // Returns false
Console.WriteLine(predicates[2](6)); // Throws an IndexOutOfRangeException 
```

有谁知道我做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-02T12:05:54.380

无需拉入表达式...

```
 Func<int, bool>[] criteria = new Func<int, bool>[3];
    criteria[0] = i => i % 2 == 0;
    criteria[1] = i => i % 3 == 0;
    criteria[2] = i => i % 5 == 0;

    Func<int, bool>[] predicates = new Func<int, bool>[3];

    predicates[0] = criteria[0];
    for (int i = 1; i < criteria.Length; i++)
    {
        //need j to be an unchanging int, one for each loop execution.
        int j = i;

        predicates[j] = x => predicates[j - 1](x) && criteria[j](x);
    }

    Console.WriteLine(predicates[0](6)); //True
    Console.WriteLine(predicates[1](6)); //True
    Console.WriteLine(predicates[2](6)); //False 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-02T02:42:45.390

这是一个猜测，因为我对这些东西知之甚少，但这似乎可以解决它：

```
Func<int, bool>[] criteria = new Func<int, bool>[3]; 
criteria[0] = i => i % 2 == 0; 
criteria[1] = i => i % 3 == 0; 
criteria[2] = i => i % 5 == 0;
Expression<Func<int, bool>>[] results = new Expression<Func<int, bool>>[criteria.Length];
for (int i = 0; i < criteria.Length; i++)
{
    results[i] = f => true; 
    for (int j = 0; j <= i; j++)
    {
        int ii = i;
        int jj = j;
        Expression<Func<int, bool>> expr = b => criteria[jj](b); 
        var invokedExpr = Expression.Invoke(expr, results[ii].Parameters.Cast<Expression>()); 
        results[ii] = Expression.Lambda<Func<int, bool>>(Expression.And(results[ii].Body, invokedExpr), results[ii].Parameters);
    }
} 
var predicates = results.Select(e => e.Compile()).ToArray(); 
```

关键是'ii'和'jj'的引入（可能只有一个重要，我没试过）。我认为您在 lambda 中捕获了一个可变变量，因此当您最终引用它时，您看到的是后来变异的值而不是原始值。

# git - 做一个“git export”（比如“svn export”）？

> ID：160608
> 
> 赞同：2464
> 
> 时间：2008-10-02T02:21:33.897
> 
> 标签：git, export, git-archive, svn-export

我一直想知道是否有一个好的“git export”解决方案可以创建一个没有`.git`存储库目录的树的副本。我知道的方法至少有以下三种：

1.  `git clone`然后删除`.git`存储库目录。
2.  [`git checkout-index`](http://www.kernel.org/pub/software/scm/git/docs/git-checkout-index.html)暗指此功能，但以“只需将所需的树读入索引...”开头，我不完全确定该怎么做。
3.  [`git-export`](http://code.google.com/p/git-export/)是一个第三方脚本，本质上是先`git clone`进入一个临时位置，然后`rsync --exclude='.git'`进入最终目的地。

这些解决方案中没有一个真正让我感到满意。最接近的`svn export`可能是选项 1，因为两者都要求目标目录首先为空。但是选项 2 似乎更好，假设我可以弄清楚将树读入索引意味着什么。

* * *

## 回答 #1

> 赞同：2504
> 
> 时间：2008-10-02T18:13:14.263

实现这一点的最简单方法可能是使用[`git archive`](https://git-scm.com/docs/git-archive). 如果你真的只需要扩展的树，你可以做这样的事情。

```
git archive master | tar -x -C /somewhere/else 
```

大多数时候，我需要从 git 中“导出”某些东西，无论如何我都想要一个压缩存档，所以我做这样的事情。

```
git archive master | bzip2 >source-tree.tar.bz2 
```

压缩包：

```
git archive --format zip --output /full/path/to/zipfile.zip master 
```

[`git help archive`](https://git-scm.com/docs/git-archive)有关更多详细信息，它非常灵活。

* * *

请注意，即使存档不包含 .git 目录，它也会包含其他隐藏的特定于 git 的文件，如 .gitignore、.gitattributes 等。如果您不希望它们在存档中，请确保您在 .gitattributes 文件中使用 export-ignore 属性并在归档之前提交它。[阅读更多...](http://feeding.cloud.geek.nz/2010/02/excluding-files-from-git-archive.html)

* * *

注意：如果你有兴趣导出索引，命令是

```
git checkout-index -a -f --prefix=/destination/path/ 
```

（有关更多详细信息，请参阅[Greg 的答案](https://stackoverflow.com/a/160719/413020 "格雷格的回答")）

* * *

## 回答 #2

> 赞同：333
> 
> 时间：2008-10-02T03:03:35.993

我发现了选项 2 的含义。从存储库中，您可以执行以下操作：

```
git checkout-index -a -f --prefix=/destination/path/ 
```

路径末尾的斜杠很重要，否则将导致文件位于 /destination 中，前缀为“路径”。

由于在正常情况下索引包含存储库的内容，因此“将所需的树读入索引”没有什么特别的事情要做。它已经在那里了。

检查索引中的所有文件都需要该`-a`标志（我不确定在这种情况下省略此标志意味着什么，因为它不符合我的要求）。该`-f`标志强制覆盖输出中的任何现有文件，此命令通常不会这样做。

这似乎是我正在寻找的那种“git export”。

* * *

## 回答 #3

> 赞同：265
> 
> 时间：2008-12-09T18:59:01.560

`git archive`也适用于远程存储库。

```
git archive --format=tar \
--remote=ssh://remote_server/remote_repository master | tar -xf - 
```

要在 repo 中导出特定路径，请添加任意数量的路径作为 git 的最后一个参数，例如：

```
git archive --format=tar \
--remote=ssh://remote_server/remote_repository master path1/ path2/ | tar -xv 
```

* * *

## 回答 #4

> 赞同：73
> 
> 时间：2013-10-30T17:03:24.200

![在此处输入图像描述](https://i.stack.imgur.com/p73W2.png)

### 如果存储库托管在 GitHub 上，则为特殊情况的答案。

只需使用`svn export`.

据我所知 Github 不允许`archive --remote`。尽管 GitHub 与[svn 兼容](https://github.com/blog/626-announcing-svn-support)，并且它们确实可以`svn`访问所有 git repos，因此您可以`svn export`像往常一样使用，只需对您的 GitHub url 进行一些调整。

例如，要导出整个存储库，请注意`trunk`URL 中的替换方式`master`（或[项目的 HEAD 分支设置为的](https://help.github.com/articles/setting-the-default-branch/)任何内容）：

```
svn export https://github.com/username/repo-name/trunk/ 
```

您可以导出单个文件甚至某个路径或文件夹：

```
svn export https://github.com/username/repo-name/trunk/src/lib/folder 
```

### [使用jQuery JavaScript 库](https://github.com/jquery/jquery)的示例

`HEAD`分支或主**分支**将可用`trunk`：

```
svn ls https://github.com/jquery/jquery/trunk 
```

非`HEAD` **分支机构**将可在以下位置访问`/branches/`：

```
svn ls https://github.com/jquery/jquery/branches/2.1-stable 
```

所有**标签**都以`/tags/`相同的方式：

```
svn ls https://github.com/jquery/jquery/tags/2.1.3 
```

* * *

## 回答 #5

> 赞同：42
> 
> 时间：2008-10-02T02:27:07.253

来自[Git 手册](http://www.kernel.org/pub/software/scm/git/docs/git-checkout-index.html "Git 手册")：

使用 git-checkout-index “导出整棵树”

前缀功能基本上使得使用 git-checkout-index 作为“导出为树”功能变得微不足道。只需将所需的树读入索引，然后执行以下操作：

`$ git checkout-index --prefix=git-export-dir/ -a`

* * *

## 回答 #6

> 赞同：39
> 
> 时间：2008-10-16T17:17:00.260

我编写了一个简单的包装器`git-checkout-index`，您可以像这样使用它：

```
git export ~/the/destination/dir 
```

如果目标目录已经存在，则需要添加`-f`或`--force`。

安装简单；只需将脚本放在你的某个地方`PATH`，并确保它是可执行的。

[github存储库`git-export`](http://github.com/dasch/git-export/tree/master)

* * *

## 回答 #7

> 赞同：36
> 
> 时间：2009-05-12T04:20:24.927

与 SVN 相比，这似乎对 Git 来说不是问题。Git 只在存储库根目录中放置一个 .git 文件夹，而 SVN 在每个子目录中放置一个 .svn 文件夹。所以“svn export”避免了递归命令行魔法，而使用 Git 递归是不必要的。

* * *

## 回答 #8

> 赞同：29
> 
> 时间：2012-02-23T15:41:55.123

相当于

```
svn export . otherpath 
```

在现有的回购中是

```
git archive branchname | (cd otherpath; tar x) 
```

相当于

```
svn export url otherpath 
```

是

```
git archive --remote=url branchname | (cd otherpath; tar x) 
```

* * *

## 回答 #9

> 赞同：24
> 
> 时间：2014-03-28T01:39:03.890

如果您不排除文件，请`.gitattributes` `export-ignore`尝试`git checkout`

```
mkdir /path/to/checkout/
git --git-dir=/path/to/repo/.git --work-tree=/path/to/checkout/ checkout -f -q 
```

> -f
> 从索引中检出路径时，不要在未合并的条目上失败；相反，未合并的条目将被忽略。

和

> -q
> 避免冗长

此外，您可以获取任何分支或标签或从特定的提交修订版，如在 SVN 中只需添加 SHA1（Git 中的 SHA1 等同于 SVN 中的修订号）

```
mkdir /path/to/checkout/
git --git-dir=/path/to/repo/.git --work-tree=/path/to/checkout/ checkout 2ef2e1f2de5f3d4f5e87df7d8 -f -q -- ./ 
```

必须为空`/path/to/checkout/`，Git 不会删除任何文件，但会覆盖同名文件而不发出任何警告

更新：为避免斩首问题或在使用带有标签、分支或 SHA1 的签出导出时保持工作存储库完整，您需要`-- ./`在末尾添加

双破折号`--`告诉 git，破折号后面的所有内容都是路径或文件，在这种情况下也告诉`git checkout`不要更改`HEAD`

例子：

此命令将仅获取 libs 目录以及`readme.txt`来自该确切提交的文件

```
git --git-dir=/path/to/repo/.git --work-tree=/path/to/checkout/ checkout fef2e1f2de5f3d4f5e87df7d8 -f -q -- ./libs ./docs/readme.txt 
```

`my_file_2_behind_HEAD.txt`这将在头部后面创建（覆盖）两个提交`HEAD^2`

```
git --git-dir=/path/to/repo/.git --work-tree=/path/to/checkout/ checkout HEAD^2 -f -q -- ./my_file_2_behind_HEAD.txt 
```

获得另一个分支的出口

```
git --git-dir=/path/to/repo/.git --work-tree=/path/to/checkout/ checkout myotherbranch -f -q -- ./ 
```

请注意，这`./`是相对于存储库的根目录

* * *

## 回答 #10

> 赞同：21
> 
> 时间：2011-09-13T06:26:03.070

我广泛使用 git-submodules。这个对我有用：

```
rsync -a ./FROM/ ./TO --exclude='.*' 
```

* * *

## 回答 #11

> 赞同：20
> 
> 时间：2012-01-22T17:31:47.387

在寻找导出 git 存储库的方法时，我经常点击此页面。我对这个问题的回答考虑了 svn export 与 git 相比在设计上具有的三个属性，因为 svn 遵循集中存储库方法：

*   它通过不导出所有修订来最小化到远程存储库位置的流量
*   它不包含导出目录中的元信息
*   使用svn导出某个分支是通过指定合适的路径来完成的

    ```
    git clone --depth 1 --branch master git://git.somewhere destination_path
    rm -rf destination_path/.git 
    ```

在构建某个版本时，克隆一个稳定的分支很有用，例如`--branch stable`或`--branch release/0.9`.

* * *

## 回答 #12

> 赞同：16
> 
> 时间：2010-12-10T17:17:49.350

这将复制所有内容，减去 .dot 文件。我使用它来将 git 克隆的项目导出到我的 web 应用程序的 git repo 中，而不需要 .git 的东西。

> cp -R ./path-to-git-repo /path/to/destination/

普通的旧 bash 效果很好:)

* * *

## 回答 #13

> 赞同：13
> 
> 时间：2013-09-27T19:35:10.220

就像克隆一样简单，然后删除 .git 文件夹：

`git clone url_of_your_repo path_to_export && rm -rf path_to_export/.git`

* * *

## 回答 #14

> 赞同：11
> 
> 时间：2014-07-31T13:58:49.017

对于 GitHub 用户，该`git archive --remote`方法无法直接使用，因为[导出 URL 是 ephemeral](https://developer.github.com/v3/repos/contents/#get-archive-link)。您必须向 GitHub 询问 URL，然后下载该 URL。 `curl`让这很容易：

```
curl -L https://api.github.com/repos/VENDOR/PROJECT/tarball | tar xzf - 
```

这将为您提供本地目录中的导出代码。例子：

```
$ curl -L https://api.github.com/repos/jpic/bashworks/tarball | tar xzf -
$ ls jpic-bashworks-34f4441/
break  conf  docs  hack  LICENSE  mlog  module  mpd  mtests  os  README.rst  remote  todo  vcs  vps  wepcrack 
```

* * *

**编辑**
如果您希望将代码放入特定的*现有*目录（而不是来自 github 的随机目录）：

```
curl -L https://api.github.com/repos/VENDOR/PROJECT/tarball | \
tar xzC /path/you/want --strip 1 
```

* * *

## 回答 #15

> 赞同：11
> 
> 时间：2015-01-05T21:42:44.683

是的，[这](https://stackoverflow.com/a/163769/4221299)是一个干净整洁的命令，用于归档您的代码，而归档中不包含任何 git，并且可以很好地传递而不用担心任何 git 提交历史记录。

```
git archive --format zip --output /full/path/to/zipfile.zip master 
```

* * *

## 回答 #16

> 赞同：10
> 
> 时间：2010-10-29T13:51:08.920

我只想指出，如果你是

1.  导出存储库的子文件夹（这就是我过去使用 SVN 导出功能的方式）
2.  可以将该文件夹中的所有内容复制到部署目标
3.  并且因为您已经拥有整个存储库的副本。

然后你可以只使用`cp foo [destination]`而不是提到的`git-archive master foo | -x -C [destination]`.

* * *

## 回答 #17

> 赞同：9
> 
> 时间：2012-10-09T13:49:55.980

您可以在任何提交时将远程存储库归档为 zip 文件。

```
git archive --format=zip --output=archive.zip --remote=USERNAME@HOSTNAME:PROJECTNAME.git HASHOFGITCOMMIT 
```

* * *

## 回答 #18

> 赞同：8
> 
> 时间：2012-02-28T01:42:28.653

如果您想要与子模块一起使用的东西，这可能值得一试。

笔记：

*   MASTER_DIR = 结帐，同时签出您的子模块
*   DEST_DIR = 此导出将结束的位置
*   如果你有 rsync，我认为你可以做同样的事情，而且球痛更少。

假设：

*   您需要从 MASTER_DIR 的父目录运行它（即从 MASTER_DIR cd ..）
*   假定已创建 DEST_DIR。如果您愿意，这很容易修改以包括创建 DEST_DIR

> cd MASTER_DIR && tar -zcvf ../DEST_DIR/export.tar.gz --exclude='.git*' 。&& cd ../DEST_DIR/ && tar xvfz export.tar.gz && rm export.tar.gz

* * *

## 回答 #19

> 赞同：7
> 
> 时间：2008-10-02T15:13:20.217

我的偏好实际上是在您的 Makefile（或其他构建系统）中有一个**dist**目标，该目标导出您的代码的可分发存档（.tar.bz2、.zip、.jar 或任何合适的）。如果您碰巧使用 GNU 自动工具或 Perl 的 MakeMaker 系统，我认为这会自动为您提供。如果没有，我强烈建议添加它。

ETA (2012-09-06)：哇，严厉的反对票。我仍然认为使用构建工具而不是源代码控制工具来构建发行版会更好。我相信使用构建工具构建工件。在我目前的工作中，我们的主要产品是使用 ant 目标构建的。我们正在切换源代码控制系统，而这个 ant 目标的存在意味着迁移的麻烦减少了。

* * *

## 回答 #20

> 赞同：7
> 
> 时间：2011-11-01T18:27:58.020

git-export 的 Bash 实现。

我已经根据自己的功能对 .empty 文件的创建和删除过程进行了分段，目的是在“git-archive”实现中重新使用它们（稍后将发布）。

我还在进程中添加了“.gitattributes”文件，以便从目标导出文件夹中删除不需要的文件。在使“git-export”功能更高效的同时，包括对流程的详细说明。

EMPTY_FILE=".empty";

```
function create_empty () {
## Processing path (target-dir):
    TRG_PATH="${1}";
## Component(s):
    EXCLUDE_DIR=".git";
echo -en "\nAdding '${EMPTY_FILE}' files to empty folder(s): ...";
    find ${TRG_PATH} -not -path "*/${EXCLUDE_DIR}/*" -type d -empty -exec touch {}/${EMPTY_FILE} \;
#echo "done.";
## Purging SRC/TRG_DIRs variable(s):
    unset TRG_PATH EMPTY_FILE EXCLUDE_DIR;
    return 0;
  }

declare -a GIT_EXCLUDE;
function load_exclude () {
    SRC_PATH="${1}";
    ITEMS=0; while read LINE; do
#      echo -e "Line [${ITEMS}]: '${LINE%%\ *}'";
      GIT_EXCLUDE[((ITEMS++))]=${LINE%%\ *};
    done < ${SRC_PATH}/.gitattributes;
    GIT_EXCLUDE[${ITEMS}]="${EMPTY_FILE}";
## Purging variable(s):
    unset SRC_PATH ITEMS;
    return 0;
  }

function purge_empty () {
## Processing path (Source/Target-dir):
    SRC_PATH="${1}";
    TRG_PATH="${2}";
echo -e "\nPurging Git-Specific component(s): ... ";
    find ${SRC_PATH} -type f -name ${EMPTY_FILE} -exec /bin/rm '{}' \;
    for xRULE in ${GIT_EXCLUDE[@]}; do
echo -en "    '${TRG_PATH}/{${xRULE}}' files ... ";
      find ${TRG_PATH} -type f -name "${xRULE}" -exec /bin/rm -rf '{}' \;
echo "done.'";
    done;
echo -e "done.\n"
## Purging SRC/TRG_PATHs variable(s):
    unset SRC_PATH; unset TRG_PATH;
    return 0;
  }

function git-export () {
    TRG_DIR="${1}"; SRC_DIR="${2}";
    if [ -z "${SRC_DIR}" ]; then SRC_DIR="${PWD}"; fi
    load_exclude "${SRC_DIR}";
## Dynamically added '.empty' files to the Git-Structure:
    create_empty "${SRC_DIR}";
    GIT_COMMIT="Including '${EMPTY_FILE}' files into Git-Index container."; #echo -e "\n${GIT_COMMIT}";
    git add .; git commit --quiet --all --verbose --message "${GIT_COMMIT}";
    if [ "${?}" -eq 0 ]; then echo " done."; fi
    /bin/rm -rf ${TRG_DIR} && mkdir -p "${TRG_DIR}";
echo -en "\nChecking-Out Index component(s): ... ";
    git checkout-index --prefix=${TRG_DIR}/ -q -f -a
## Reset: --mixed = reset HEAD and index:
    if [ "${?}" -eq 0 ]; then
echo "done."; echo -en "Resetting HEAD and Index: ... ";
        git reset --soft HEAD^;
        if [ "${?}" -eq 0 ]; then
echo "done.";
## Purging Git-specific components and '.empty' files from Target-Dir:
            purge_empty "${SRC_DIR}" "${TRG_DIR}"
          else echo "failed.";
        fi
## Archiving exported-content:
echo -en "Archiving Checked-Out component(s): ... ";
        if [ -f "${TRG_DIR}.tgz" ]; then /bin/rm ${TRG_DIR}.tgz; fi
        cd ${TRG_DIR} && tar -czf ${TRG_DIR}.tgz ./; cd ${SRC_DIR}
echo "done.";
## Listing *.tgz file attributes:
## Warning: Un-TAR this file to a specific directory:
        ls -al ${TRG_DIR}.tgz
      else echo "failed.";
    fi
## Purgin all references to Un-Staged File(s):
   git reset HEAD;
## Purging SRC/TRG_DIRs variable(s):
    unset SRC_DIR; unset TRG_DIR;
    echo "";
    return 0;
  } 
```

> 输出：
> 
> $ git-export /tmp/rel-1.0.0
> 
> 将“.empty”文件添加到空文件夹：...完成。
> 
> 签出索引组件：...完成。
> 
> 重置 HEAD 和索引：...完成。
> 
> 清除特定于 Git 的组件：...
> 
> '/tmp/rel-1.0.0/{.buildpath}' 文件...完成。'
> 
> '/tmp/rel-1.0.0/{.project}' 文件...完成。'
> 
> '/tmp/rel-1.0.0/{.gitignore}' 文件...完成。'
> 
> '/tmp/rel-1.0.0/{.git}' 文件...完成。'
> 
> '/tmp/rel-1.0.0/{.gitattributes}' 文件...完成。'
> 
> '/tmp/rel-1.0.0/{*.mno}' 文件...完成。'
> 
> '/tmp/rel-1.0.0/{*~}' 文件...完成。'
> 
> '/tmp/rel-1.0.0/{.*~}' 文件...完成。'
> 
> '/tmp/rel-1.0.0/{*.swp}' 文件...完成。'
> 
> '/tmp/rel-1.0.0/{*.swo}' 文件...完成。'
> 
> '/tmp/rel-1.0.0/{.DS_Store}' 文件...完成。'
> 
> '/tmp/rel-1.0.0/{.settings}' 文件...完成。'
> 
> '/tmp/rel-1.0.0/{.empty}' 文件...完成。'
> 
> 完毕。
> 
> 归档签出组件：...完成。
> 
> -rw-r--r-- 1 管理轮 25445901 11 月 3 日 12:57 /tmp/rel-1.0.0.tgz
> 
> 我现在已将“git 存档”功能合并到一个使用“create_empty”功能和其他功能的进程中。

```
function git-archive () {
    PREFIX="${1}"; ## sudo mkdir -p ${PREFIX}
    REPO_PATH="`echo "${2}"|awk -F: '{print $1}'`";
    RELEASE="`echo "${2}"|awk -F: '{print $2}'`";
    USER_PATH="${PWD}";
echo "$PREFIX $REPO_PATH $RELEASE $USER_PATH";
## Dynamically added '.empty' files to the Git-Structure:
    cd "${REPO_PATH}"; populate_empty .; echo -en "\n";
#    git archive --prefix=git-1.4.0/ -o git-1.4.0.tar.gz v1.4.0
# e.g.: git-archive /var/www/htdocs /repos/domain.name/website:rel-1.0.0 --explode
    OUTPUT_FILE="${USER_PATH}/${RELEASE}.tar.gz";
    git archive --verbose --prefix=${PREFIX}/ -o ${OUTPUT_FILE} ${RELEASE}
    cd "${USER_PATH}";
    if [[ "${3}" =~ [--explode] ]]; then
      if [ -d "./${RELEASE}" ]; then /bin/rm -rf "./${RELEASE}"; fi
      mkdir -p ./${RELEASE}; tar -xzf "${OUTPUT_FILE}" -C ./${RELEASE}
    fi
## Purging SRC/TRG_DIRs variable(s):
    unset PREFIX REPO_PATH RELEASE USER_PATH OUTPUT_FILE;
    return 0;
  } 
```

* * *

## 回答 #21

> 赞同：7
> 
> 时间：2018-03-12T14:53:19.333

据我了解这个问题，它更多的是从服务器下载某些状态，没有历史记录，也没有其他分支的数据，而不是从本地存储库中提取状态（就像这里的许多回答者所做的那样）。

可以这样做：

```
git clone -b someBranch --depth 1 --single-branch git://somewhere.com/repo.git \
&& rm -rf repo/.git/ 
```

*   `--single-branch`从 Git 1.7.10（2012 年 4 月）开始可用。
*   `--depth`是否（曾经？）[据报道](https://stackoverflow.com/questions/23708231/git-shallow-clone-clone-depth-misses-remote-branches)有缺陷，但对于出口而言，上述问题应该无关紧要。

* * *

## 回答 #22

> 赞同：6
> 
> 时间：2014-04-25T17:47:12.190

这会将一系列提交（C 到 G）中的文件复制到 tar 文件中。注意：这只会提交文件。不是整个存储库。[从这里](https://stackoverflow.com/questions/4541300/export-only-modified-and-added-files-with-folder-structure-in-git)稍微修改

示例提交历史

A --> B --> **C --> D --> E --> F --> G** --> H --> I

```
git diff-tree -r --no-commit-id --name-only --diff-filter=ACMRT C~..G | xargs tar -rf myTarFile.tar 
```

[git-diff-tree 手册页](https://stackoverflow.com/questions/4541300/export-only-modified-and-added-files-with-folder-structure-in-git)

-r --> 递归到子树

--no-commit-id --> git diff-tree 在适用时输出带有提交 ID 的行。此标志抑制了提交 ID 输出。

--name-only --> 仅显示更改文件的名称。

--diff-filter=ACMRT --> 只选择这些文件。[有关文件的完整列表，请参见此处](http://git-scm.com/docs/git-diff-tree)

C..G --> 此提交范围内的文件

C~ --> 包括来自 Commit C 的文件。不仅仅是 Commit C 之后的文件。

| xargs tar -rf myTarFile --> 输出到 tar

* * *

## 回答 #23

> 赞同：5
> 
> 时间：2015-04-05T21:47:57.720

到目前为止，我见过的最简单的方法（也适用于 Windows）是`git bundle`：

`git bundle create /some/bundle/path.bundle --all`

有关更多详细信息，请参阅此答案：[如何通过 USB 驱动器将我的 git 存储库从我的 windows 机器复制到 linux 机器？](https://stackoverflow.com/questions/28522089/how-can-i-copy-my-git-repository-from-my-windows-machine-to-a-linux-machine-via/28522093#28522093)

* * *

## 回答 #24

> 赞同：5
> 
> 时间：2018-11-05T08:04:13.663

在添加前缀（例如目录名称）的同时将 git 导出到 zip 存档：

```
git archive master --prefix=directoryWithinZip/  --format=zip -o out.zip 
```

* * *

## 回答 #25

> 赞同：4
> 
> 时间：2009-07-17T10:07:43.853

我需要将其用于部署脚本，但我无法使用上述任何方法。相反，我想出了一个不同的解决方案：

```
#!/bin/sh
[ $# -eq 2 ] || echo "USAGE $0 REPOSITORY DESTINATION" && exit 1
REPOSITORY=$1
DESTINATION=$2
TMPNAME="/tmp/$(basename $REPOSITORY).$$"
git clone $REPOSITORY $TMPNAME
rm -rf $TMPNAME/.git
mkdir -p $DESTINATION
cp -r $TMPNAME/* $DESTINATION
rm -rf $TMPNAME 
```

* * *

## 回答 #26

> 赞同：4
> 
> 时间：2010-03-19T16:12:52.750

这样做很简单，这是 .bash_profile 的一个功能，它直接将存档解压缩到当前位置，首先配置您通常的 [url:path]。注意：使用此功能可以避免克隆操作，它直接从远程仓库获取。

```
gitss() {
    URL=[url:path]

    TMPFILE="`/bin/tempfile`"
    if [ "$1" = "" ]; then
        echo -e "Use: gitss repo [tree/commit]\n"
        return
    fi
    if [ "$2" = "" ]; then
        TREEISH="HEAD"
    else
        TREEISH="$2"
    fi
    echo "Getting $1/$TREEISH..."
    git archive --format=zip --remote=$URL/$1 $TREEISH > $TMPFILE && unzip $TMPFILE && echo -e "\nDone\n"
    rm $TMPFILE
} 
```

.gitconfig 的别名，需要相同的配置（注意在 .git 项目中执行命令，它总是会跳转到前面[所说](http://www.kerneltrap.com/mailarchive/git/2008/12/3/4301934/thread)的基本目录，直到这个问题得到修复我个人更喜欢这个功能

```
ss = !env GIT_TMPFILE="`/bin/tempfile`" sh -c 'git archive --format=zip --remote=[url:path]/$1 $2 \ > $GIT_TMPFILE && unzip $GIT_TMPFILE && rm $GIT_TMPFILE' - 
```

* * *

## 回答 #27

> 赞同：4
> 
> 时间：2018-02-23T10:30:17.747

如果您在要创建导出的机器上有存储库的本地副本，我还有另一个解决方案可以正常工作。在这种情况下，移动到此存储库目录，并输入以下命令：

`GIT_WORK_TREE=outputdirectory git checkout -f`

如果您管理具有 git 存储库的网站并希望在`/var/www/`. `.git/hooks/post-receive`在这种情况下，在脚本中添加这个命令（`hooks/post-receive`在裸存储库上，这更适合这种情况）

* * *

## 回答 #28

> 赞同：3
> 
> 时间：2014-07-15T14:16:48.943

我认为[@Aredridel](https://stackoverflow.com/a/9416271/277826)的帖子最接近，但还有更多内容 - 所以我将在此处添加此内容；问题是，`svn`如果你在一个 repo 的子文件夹中，你这样做：

```
/media/disk/repo_svn/subdir$ svn export . /media/disk2/repo_svn_B/subdir 
```

然后`svn`将导出所有受修订控制的文件（它们也可能是新添加的；或修改状态） - 如果您在该目录中有其他“垃圾”（我`.svn`这里不计算子文件夹，而是可见的东西，如`.o`文件） ，它*不会*被导出；只有那些由 SVN repo 注册的文件才会被导出。对我来说，一件好事是这个导出还包括尚未提交的本地更改的*文件*；另一个好处是导出文件的时间戳与原始文件相同。或者，正如`svn help export`它所说：

> 2.  从 PATH1 指定的工作副本中导出一个干净的目录树，如果给出，则在修订版本 REV，否则在 WORKING，到 PATH2。... 如果未指定 REV，则将保留所有本地更改。不受版本控制的文件将不会被复制。

要意识到这`git`不会保留时间戳，请比较这些命令的输出（在`git`您选择的 repo 的子文件夹中）：

```
/media/disk/git_svn/subdir$ ls -la . 
```

... 和：

```
/media/disk/git_svn/subdir$ git archive --format=tar --prefix=junk/ HEAD | (tar -t -v --full-time -f -) 
```

...而且我无论如何都注意到这`git archive`会导致存档文件的所有时间戳都相同！`git help archive`说：

> git archive 在给定树 ID 与给定提交 ID 或标签 ID 时的行为不同。在第一种情况下，当前时间用作存档中每个文件的修改时间。在后一种情况下，将使用引用的提交对象中记录的提交时间。

*...但显然这两种情况都设置了“每个*文件的修改时间”；从而*不*保留这些文件的实际时间戳！

所以，为了也保留时间戳，这里有一个`bash`脚本，它实际上是一个“单行”，虽然有点复杂 - 所以下面分多行发布：

```
/media/disk/git_svn/subdir$ git archive --format=tar master | (tar tf -) | (\
  DEST="/media/diskC/tmp/subdirB"; \
  CWD="$PWD"; \
  while read line; do \
    DN=$(dirname "$line"); BN=$(basename "$line"); \
    SRD="$CWD"; TGD="$DEST"; \
    if [ "$DN" != "." ]; then \
      SRD="$SRD/$DN" ; TGD="$TGD/$DN" ; \
      if [ ! -d "$TGD" ] ; then \
        CMD="mkdir \"$TGD\"; touch -r \"$SRD\" \"$TGD\""; \
        echo "$CMD"; \
        eval "$CMD"; \
      fi; \
    fi; \
    CMD="cp -a \"$SRD/$BN\" \"$TGD/\""; \
    echo "$CMD"; \
    eval "$CMD"; \
    done \
) 
```

请注意，假设您正在导出“当前”目录（上图`/media/disk/git_svn/subdir`）中的内容 - 并且您要导出到的目标位置有些不便，但它位于`DEST`环境变量中。请注意，使用此脚本；`DEST`在运行上述脚本之前，您必须自己手动创建目录。

脚本运行后，您应该能够比较：

```
ls -la /media/disk/git_svn/subdir
ls -la /media/diskC/tmp/subdirB   # DEST 
```

...并希望看到相同的时间戳（对于那些受版本控制的文件）。

希望这对某人有帮助，
干杯！

* * *

## 回答 #29

> 赞同：2
> 
> 时间：2012-08-23T15:05:20.980

如果您还需要子模块，这应该可以解决问题：[https ://github.com/meitar/git-archive-all.sh/wiki](https://github.com/meitar/git-archive-all.sh/wiki)

* * *

## 回答 #30

> 赞同：1
> 
> 时间：2014-05-22T07:38:31.753

我的 .bashrc 文件中有以下实用程序函数：它在 git 存储库中创建当前分支的存档。

```
function garchive()
{
  if [[ "x$1" == "x-h" || "x$1" == "x" ]]; then
    cat <<EOF
Usage: garchive <archive-name>
create zip archive of the current branch into <archive-name>
EOF
  else
    local oname=$1
    set -x
    local bname=$(git branch | grep -F "*" | sed -e 's#^*##')
    git archive --format zip --output ${oname} ${bname}
    set +x
  fi
} 
```

* * *

## 回答 #31

> 赞同：1
> 
> 时间：2015-06-12T19:09:04.777

选项 1 听起来不太有效。如果客户端没有空间进行克隆*然后*删除`.git`文件夹怎么办？

今天我发现自己正在尝试这样做，其中客户端是一个 Raspberry Pi，几乎没有剩余空间。此外，我还想从存储库中排除一些繁重的文件夹。

选项 2 和此处的其他答案在这种情况下没有帮助。两者都不`git archive`是（因为需要提交`.gitattributes`文件，并且我不想将此排除保存在存储库中）。

在这里我分享我的解决方案，类似于选项 3，但不需要`git clone`：

```
tmp=`mktemp`
git ls-tree --name-only -r HEAD > $tmp
rsync -avz --files-from=$tmp --exclude='fonts/*' . raspberry: 
```

将行更改`rsync`为 compress 的等效行也可以作为 a 使用，`git archive`但带有一种排除选项（如此处所问[）](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=466912)。

# java - 找不到合适的驱动程序的原因

> ID：160611
> 
> 赞同：20
> 
> 时间：2008-10-02T02:23:16.187
> 
> 标签：java, eclipse, spring, junit, hsqldb

我正在尝试对我创建的 DAO 进行单元测试（JUnit）。我使用 Spring 作为我的框架，我的 DAO (JdbcPackageDAO) 扩展了 SimpleJdbcDaoSupport。测试类 (JdbcPackageDAOTest) 扩展了 AbstractTransactionalDataSourceSpringContextTests。我已经按如下方式覆盖了 configLocations：

```
protected String[] getConfigLocations(){
    return new String[] {"classpath:company/dc/test-context.xml"};
} 
```

我的 test-context.xml 文件定义如下：

```
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.springframework.org/schema/beans 
        http://www.springframework.org/schema/beans/spring-beans-2.5.xsd">

    <bean id="dataPackageDao" class="company.data.dao.JdbcPackageDAO">
        <property name="dataSource" ref="dataSource" />
    </bean>

    <bean id="dataSource" class="org.springframework.jdbc.datasource.DriverManagerDataSource">
        <property name="driverClassName" value="org.hsqldb.jdbcDriver"/>
        <property name="url" value="jdbc:hsqldb:hsql://localhost"/>
        <property name="username" value="sa" />
        <property name="password" value="" />
    </bean>

    <bean id="propertyConfigurer" 
          class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
        <property name="locations">
            <list>
                <value>company/data/dao/jdbc.properties</value>
            </list>
        </property>
    </bean>

    <bean id="transactionManager" 
          class="org.springframework.jdbc.datasource.DataSourceTransactionManager">
        <property name="dataSource" ref="dataSource" />
    </bean>
</beans> 
```

我使用 HSQL 作为我的后端，它以独立模式运行。我选择的 IDE 是 eclipse。当我将课程作为 JUnit 测试运行时，这是我的错误（如下）。我不知道为什么会这样。根据 Eclipse，hsql.jar 在我的构建路径上。

```
org.springframework.transaction.CannotCreateTransactionException：无法为事务打开 JDBC 连接；嵌套异常是 java.sql.SQLException：没有为 jdbc:hsqldb:hsql://localhost 找到合适的驱动程序
    在 org.springframework.jdbc.datasource.DataSourceTransactionManager.doBegin(DataSourceTransactionManager.java:219)
    在 org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:377)
    在 org.springframework.test.AbstractTransactionalSpringContextTests.startNewTransaction(AbstractTransactionalSpringContextTests.java:387)
    在 org.springframework.test.AbstractTransactionalSpringContextTests.onSetUp(AbstractTransactionalSpringContextTests.java:217)
    在 org.springframework.test.AbstractSingleSpringContextTests.setUp(AbstractSingleSpringContextTests.java:101)
    在 junit.framework.TestCase.runBare(TestCase.java:128)
    在 org.springframework.test.ConditionalTestCase.runBare(ConditionalTestCase.java:76)
    在 junit.framework.TestResult$1.protect(TestResult.java:106)
    在 junit.framework.TestResult.runProtected(TestResult.java:124)
    在 junit.framework.TestResult.run(TestResult.java:109)
    在 junit.framework.TestCase.run(TestCase.java:120)
    在 junit.framework.TestSuite.runTest(TestSuite.java:230)
    在 junit.framework.TestSuite.run(TestSuite.java:225)
    在 org.eclipse.jdt.internal.junit.runner.junit3.JUnit3TestReference.run(JUnit3TestReference.java:130)
    在 org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)
    在 org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:460)
    在 org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:673)
    在 org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:386)
    在 org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:196)
原因：java.sql.SQLException：没有为 jdbc:hsqldb:hsql://localhost 找到合适的驱动程序
    在 java.sql.DriverManager.getConnection（未知来源）
    在 java.sql.DriverManager.getConnection（未知来源）
    在 org.springframework.jdbc.datasource.DriverManagerDataSource.getConnectionFromDriverManager(DriverManagerDataSource.java:291)
    在 org.springframework.jdbc.datasource.DriverManagerDataSource.getConnectionFromDriverManager(DriverManagerDataSource.java:277)
    在 org.springframework.jdbc.datasource.DriverManagerDataSource.getConnectionFromDriverManager(DriverManagerDataSource.java:259)
    在 org.springframework.jdbc.datasource.DriverManagerDataSource.getConnection(DriverManagerDataSource.java:241)
    在 org.springframework.jdbc.datasource.DataSourceTransactionManager.doBegin(DataSourceTransactionManager.java:182)
    ... 18 更多

```

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2010-02-14T18:03:40.623

为了让 HSQLDB 自己注册，您需要访问它的 jdbcDriver 类。您可以按照本[示例](http://hsqldb.org/doc/guide/running-chapt.html#rgc_connecting_db)中的相同方式执行此操作。

```
Class.forName("org.hsqldb.jdbcDriver"); 
```

它触发 jdbcDriver 类的静态初始化，即：

```
static {
    try {
        DriverManager.registerDriver(new jdbcDriver());
    } catch (Exception e) {}
} 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-12-24T16:48:20.940

“没有合适的驱动程序”通常意味着连接 URL 的语法不正确。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-03T02:48:28.643

好的，这就是解决方案。大多数人都提出了很好的观点，但没有人解决问题（感谢您的帮助）。这是我发现可行的解决方案。

1.  将 jar 从 .../web-inf/lib 移动到 PROJECT_ROOT/lib
2.  更改 Eclipse 中的构建路径以反映此更改。
3.  清理并重建了我的项目。
4.  运行了 junit 测试并且 BOOM 成功了！

我的猜测是它与 Ganymede 如何读取 /web-inf/lib 文件夹中的 jars 有关。但谁知道......它现在有效。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-24T16:53:53.657

如果您查看原始连接字符串：

```
<property name="url" value="jdbc:hsqldb:hsql://localhost"/> 
```

Hypersonic 文档建议您在 localhost 之后缺少别名：

[http://hsqldb.org/doc/guide/ch04.html](http://hsqldb.org/doc/guide/ch04.html)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-02T02:30:20.833

看起来您没有指定要连接的数据库名称，应该类似于

```
jdbc:hsqldb:hsql://serverName:port/DBname 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-12-22T16:26:38.187

太好了，我遇到了类似的问题。对所有人的建议是检查 jdbc url sintax

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-09T12:59:11.670

我对 spring、commons-dbcp 和 oracle 10g 有同样的问题。使用此 URL 我得到了“没有合适的驱动程序”错误：**jdbc:oracle:thin@192.168.170.117:1521:kinangop**

上面的 URL 在 @ 之前缺少一个完整的冒号。更正后，错误消失了。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-01-16T00:26:02.663

当尝试使用静态 main 方法运行数据源连接时，首先我们需要运行数据库连接。这我们可以在eclipse中实现如下。

1）打开工作区后打开任何IDE（Eclipse或RAD）默认IDE将在JAVA预期中打开。尝试从 java 切换到数据库预期，以创建数据源以及虚拟数据库连接。

2）在数据库中输入所有详细信息，如特定模式的用户名、密码和 URL。

3）然后尝试运行主要方法来访问数据库。

这将解决“serverName undefined”。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-02T02:47:53.100

您可以将驱动程序 (org.hsqldb.jdbcDriver) 导入您的源文件之一吗？（测试该类实际上是否在您的类路径上）。

如果您无法导入它，那么您可以尝试在构建路径中[包含 hsqldb.jar](http://sourceforge.net/project/showfiles.php?group_id=23316&package_id=16653&release_id=339171)。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-06-24T05:23:22.027

正如一些人之前回答的那样，这行代码解决了这个问题

```
Class.forName("org.hsqldb.jdbcDriver"); 
```

但是我的应用程序在一些 tomcats 中运行，但只有在一个安装中我必须添加此代码。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-02T07:35:26.137

我认为您的 HSQL URL 是错误的。它还应该包括数据库名称，

所以像

```
jdbc:hsqldb:hsql://localhost/mydatabase 
```

如果 mydatabase 是您的数据库（文件）的名称。不包括这个会（我不确定是不是这里的情况）混淆了URL的解析，这可能会导致DriverManagerDS认为你的驱动不合适（找到了，但是觉得不好一）

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-06-10T10:06:46.050

我遇到了类似的问题，令我惊讶的是问题出在 Java 版本中。java.sql.DriverManager 来自 rt.jar 无法加载我的驱动程序“COM.ibm.db2.jdbc.app.DB2Driver”。

我从 jdk 5 和 jdk 6 升级，它工作。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-02T03:25:04.570

可能是这样

> hsql://localhost

无法解析为文件。看看这里的示例程序：

[示例 HSQLDB 程序](http://hsqldb.org/doc/guide/apb.html)

看看你是否可以先让它工作，然后看看你是否可以获取该配置信息并在 Spring bean 配置中使用它。

祝你好运！

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-12-24T08:22:35.733

不确定它是否值得，但我遇到了类似的问题，我收到“java.sql.SQLException：找不到合适的驱动程序”错误。我在研究解决方案时发现了这个线程。

我最终解决问题的方法是放弃使用 java.sql.DriverManager 来获得连接，而是建立一个 org.hsqldb.jdbc.jdbcDataSource 的实例并使用它。

我的问题的根本原因（我相信）与类加载器层次结构和 JRE 运行 Java 5 的事实有关。即使我可以成功加载 jdbcDriver 类，java.sql.DriverManager 后面的类加载器更高，以至于它看不到我需要的 hsqldb.jar。

无论如何，只要把这个笔记放在这里，以防其他人偶然遇到类似的问题。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2015-06-25T09:16:35.873

在某些情况下，检查权限（所有权）。

# .net - 在 Windows XP IIS 上使用 ASP.NET 动态数据站点？

> ID：160614
> 
> 赞同：0
> 
> 时间：2008-10-02T02:24:42.313
> 
> 标签：.net, asp.net, asp.net-mvc, windows-xp, dynamic-data

我有一个使用 .NET 3.5 SP1 在 Visual Studio 2008 中构建的动态数据网站。该站点在我的 Vista 机器上运行良好，但在 Windows XP 机器上运行时出现以下错误：

> “/FlixManagerWeb”应用程序中的服务器错误。-------------------------------------------------- - - - - - - - - - - - - - - - 没有找到您要查的资源。说明：HTTP 404。您要查找的资源（或其依赖项之一）可能已被删除、名称已更改或暂时不可用。请查看以下 URL 并确保其拼写正确。
> 
> 请求的 URL：/FlixManagerWeb --------------------------------------------- ---------------------------------- 版本信息：Microsoft .NET Framework 版本：2.0.50727.3053；ASP.NET 版本：2.0.50727.3053

我在站点配置中添加了 .* -> aspnet_isapi.dll 映射，确保它是一个“应用程序”，但这并没有帮助。任何人有幸在 Windows XP 上运行动态数据网站吗？让它工作需要什么（如果有的话）特别之处？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-02T09:55:56.597

我一直在 Windows XP 上运行动态数据网站，没有任何问题。让它工作不需要什么特别的东西。

对不起，我不能更有帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T01:58:21.903

IIS 7 处理请求的方式与 IIS 5/6 不同，并且 MVC 在经典模式下不处理“默认”路由。[虽然 IIS 5/6 将在您指定特定页面时工作，但对于典型的 MVC URL ( http://somesite/controller/action/parm](http://somesite/controller/action/parm) ) ，它不会开箱即用。***仅***当 a) 在每个请求中包含扩展名（.aspx 或 .mvc），或在 IIS 中实现通配符映射以通过 .NET 处理器传递每个请求时，它才会起作用 。[史蒂夫·桑德森（Steve Sanderson）](http://blog.codeville.net/2008/07/04/options-for-deploying-aspnet-mvc-to-iis-6/)对可用选项有很好的描述。仅供参考，我们选择了通配符选项

# flat-file - 为什么我们仍然使用平面文件进行编程？

> ID：160633
> 
> 赞同：49
> 
> 时间：2008-10-02T02:32:37.457
> 
> 标签：flat-file

为什么平面文本文件是表示源代码的最先进技术？

当然——预处理器和编译器需要查看文件的平面文件表示，但这很容易创建。

在我看来，某种形式的 XML 或二进制数据可能代表了很多很难跟踪的想法，否则。

例如，您可以将 UML 图直接嵌入到您的代码中。它们可以半自动生成，并由开发人员注释以突出设计的重要方面。特别是交互图。哎呀，嵌入任何用户绘图可能会使事情更清楚。

另一个想法是将来自代码审查的评论直接嵌入到代码中。

可能有各种帮助可以更轻松地合并多个分支。

我感兴趣的不仅仅是跟踪代码覆盖率，还包括查看自动化测试覆盖的代码部分。困难的部分是跟踪该代码，即使源被修改。例如，将一个函数从一个文件移动到另一个文件，等等。这可以通过 GUID 来完成，但是将它们直接嵌入到文本文件中会比较麻烦。在丰富的文件格式中，它们可以是自动且不引人注目的。

那么为什么没有 IDE（据我所知，无论如何）允许您以这种方式处理代码？

**编辑：** 2009 年 10 月 7 日。

你们中的大多数人都非常关注我的问题中的“二进制”这个词。我收回它。图片 XML，非常少地标记您的代码。在你将它交给你的普通预处理器或编译器之前的那一刻，你去掉了所有的 XML 标记，只传递了源代码。在这种形式下，您仍然可以对文件执行所有常规操作：差异、合并、编辑、在简单且最小的编辑器中使用，将它们提供给数千个工具。是的，直接使用最少的 XML 标记进行差异、合并和编辑确实有点复杂。但我认为价值可能是巨大的。

如果存在尊重所有 XML 的 IDE，那么您可以添加比我们今天所能做的更多的东西。

例如，您的 DOxygen 评论实际上可能*看起来*像最终的 DOxygen 输出。

当有人想要进行代码审查时，比如 Code Collaborator，他们可以在适当的位置标记源代码。

XML 甚至可以隐藏在注释后面。

```
// <comment author="mcruikshank" date="2009-10-07">
// Please refactor to Delegate.
// </comment> 
```

然后如果你想使用 vi 或 emacs，你可以跳过评论。

如果我想使用最先进的编辑器，我可以通过十几种不同的有用方式看到这一点。

所以，这是我的粗略想法。这不是你在屏幕上拖动图片的“积木”......我没那么疯狂。:)

* * *

## 回答 #1

> 赞同：140
> 
> 时间：2008-10-02T02:36:26.403

*   你可以区分它们
*   你可以合并它们
*   任何人都可以编辑它们
*   它们简单易处理
*   成千上万的工具可以普遍使用它们

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2008-10-02T02:40:49.293

在我看来，任何可能的好处都超过了与特定工具相关联的好处。

使用纯文本源（这似乎是您正在讨论的内容，而不是*平面文件*本身），我可以将块粘贴到电子邮件中，使用简单的版本控制系统（非常重要！），将代码写入 Stack Overflow 上的评论，在任意数量的平台上使用一千个文本编辑器中的一个，等等。

对于代码的一些二进制表示，我需要使用专门的编辑器来查看或编辑它。即使可以生成基于文本的表示，也不能轻易地将更改回滚到规范版本。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-10-02T02:42:12.630

Smalltalk 是一个基于图像的环境。您不再使用磁盘文件中的代码。您正在运行时处理和修改真实对象。它仍然是文本，但类不存储在人类可读的文件中。相反，整个对象内存（图像）以二进制格式存储在文件中。

但是试用 smalltalk 的人最大的抱怨是因为它不使用文件。我们拥有的大多数基于文件的工具（vim、emacs、eclipse、vs.net、unix 工具）将不得不放弃，转而使用 smalltalk 自己的工具。并不是说smalltalk中提供的工具逊色。只是不同而已。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2008-10-02T02:36:49.913

为什么论文是用文字写的？为什么法律文件是用文字写成的？为什么奇幻小说是用文字写成的？因为对于人们来说，文字是坚持思想的唯一最佳形式。

文本是人们思考、表示、理解和坚持*概念*的方式——以及它们的复杂性、层次结构和相互关系。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2008-10-02T03:03:26.620

Lisp 程序不是平面文件。它们是数据结构的序列化。这种代码即数据是一个古老的想法，实际上是计算机科学中最伟大的想法之一。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2008-10-02T04:52:57.277

<?xml version="1.0" encoding="UTF-8"?><code>平面文件更容易阅读。</code></xml>

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2008-10-02T02:50:42.610

这是个好问题。FWIW，我很想看到一个 Wiki 风格的代码管理工具。每个功能单元都有自己的 wiki 页面。构建工具将源代码从 wiki 中提取出来。会有一个链接到该页面的“讨论”页面，人们可以在其中讨论算法、API 等。

哎呀，从预先存在的 Wiki 实现中破解一个并不难。有没有接盘侠...？

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2008-10-02T03:16:02.797

原因如下：

*   人类可读。这使得在文件和解析方法中发现错误变得更加容易。也可以大声朗读。这是您无法通过 XML 获得的，并且可能会有所作为，特别是在客户支持方面。

*   过时保险。只要存在正则表达式，就可以用几行代码编写一个非常好的解析器。

*   杠杆作用。几乎所有的东西，从版本控制系统到编辑器再到过滤器，都可以检查、合并和操作平面文件。合并 XML 可能是一团糟。

*   能够将它们与 UNIX 工具（例如 grep、cut 或 sed）轻松集成。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2008-10-02T02:42:33.317

具有讽刺意味的是，有些编程结构精确地使用了您所描述的内容。

例如，SQL Server 集成服务涉及通过将组件拖入可视化设计表面来编码逻辑流程，它被保存为精确描述该后端的 XML 文件。

另一方面，SSIS 很难进行源代码控制。在其中设计任何类型的复杂逻辑也相当困难：如果您需要更多“控制”，则需要将 VB.NET 代码编写到组件中，这使我们*回到*了开始的地方。

我想，作为编码人员，您应该考虑这样一个事实，即对于问题的每个解决方案都会产生后果。并不是所有的东西都可以（有些人认为应该）用 UML 来表示。并不是所有的东西都可以直观地表现出来。并非所有内容都可以简化到足以具有一致的二进制文件表示。

话虽如此，我认为将代码降级为二进制格式（其中大部分也往往是专有的）的缺点远远超过了将它们放在纯文本中的优点。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2008-10-02T03:19:14.367

人们长期以来一直在尝试创建一个超越平面文件的编辑环境，但每个人都在某种程度上失败了。我见过的最接近的是 Charles Simonyi 的 Intentional Programming 的原型，但后来被降级为可视化 DSL 创建工具。

无论代码如何在内存中存储或表示，最终它都必须能够以文本的形式呈现和修改（**您无需更改格式**），因为这是我们所知道的表达大多数抽象概念所需的最简单方法通过编程解决问题。

使用平面文件，您可以免费获得它，并且任何普通的旧文本编辑器（具有正确的字符编码支持）都可以使用。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2008-10-02T02:45:16.507

恕我直言，XML 和二进制格式将一团糟，不会带来任何显着的好处。

OTOH，一个相关的想法是写入数据库，可能每条记录一个函数，或者可能是分层结构。围绕这个概念创建的 IDE 可以使导航源更加自然，并且更容易隐藏与您在特定时刻正在阅读的代码无关的任何内容。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2008-10-02T05:29:19.623

史蒂夫·麦康奈尔（Steve McConnell）一如既往地正确——您为其他程序员（包括您自己）编写程序，而不是为计算机编写程序。

也就是说，Microsoft Visual Studio 必须在内部以非常结构化的格式管理您编写的代码，否则您将无法如此轻松地执行“查找所有引用”或重命名或重构变量和方法之类的事情。如果有人链接到它是如何工作的，我会很感兴趣。

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2008-10-02T06:52:30.670

实际上，大约 10 年前，Charles Simonyi 的意图编程早期原型试图超越平面文件，进入可以以不同方式可视化的代码树表示。从理论上讲，领域专家、PM 和软件工程师都可以以对他们有用的方式查看（并拼凑）应用程序代码，并且产品可以构建在声明性“意图”的层次结构上，深入挖掘仅根据需要进行级别代码。

ETA（根据问题中的要求）在 Microsoft 研究网站上有一份[他的早期论文的副本。](http://research.microsoft.com/research/pubs/view.aspx?tr_id=4)不幸的是，由于 Simonyi 几年前离开 MS 成立了一家独立的公司，我认为原型仍然无法下载。我在微软的时候看过一些演示，但我不确定他的早期原型的分布范围有多广。

他的公司[IntentSoft](http://www.intentsoft.com/)仍然对他们计划向市场提供的产品（如果有的话）保持沉默，但 MSR 的一些早期产品非常有趣。

存储模型是某种二进制格式，但我不确定在 MSR 项目期间披露了多少这些细节，而且我确信自早期实施以来有些事情发生了变化。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2008-10-02T04:01:51.860

我猜旧习惯很难改掉。

直到最近，用于结构化数据的一般存储的高质量、高性能、广泛可用的库并不多。即使在今天，我也坚决*不会*将 XML 归入该类别——太冗长、太密集而无法处理、太挑剔。

如今，我最喜欢用于不需要人类可读的数据的是[SQLite](http://sqlite.org)并创建数据库。将功能齐全的 SQL 数据库嵌入到任何应用程序中都非常容易……有 C、Perl、Python、PHP 等的绑定……而且它是开源的，非常快速、可靠和轻量级。

我 <3 SQLite。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2008-10-02T11:45:59.030

为什么文本文件规则？因为麦克罗伊的测试。让一个程序的输出可以作为另一个程序的源代码被接受是至关重要的，而文本文件是最简单的工作。

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2008-10-02T23:45:54.447

[Labview](http://www.ni.com/labview/)和[Simulink](http://www.mathworks.com/products/simulink/)是两个图形化编程环境。它们在各自的领域都很受欢迎（分别从 PC 和建模控制系统连接到硬件），但在这些领域之外没有太多使用。我和那些都是他们的忠实粉丝的人一起工作过，但我自己从来没有接触过他们。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2008-10-02T14:52:53.620

有人试过[**Mathematica**](http://documents.wolfram.com/v5/TheMathematicaBook/APracticalIntroductionToMathematica/UsingTheMathematicaSystem/NBMLImages/1.3.1/1.3.1_13.gif)吗？

上面的图片来自旧版本，但它是谷歌能给我的最好的。

无论如何...将那里的第一个等式与**Math.Integrate(1/(Math.Pow("x",3)-1), "x")**进行比较，就像您在大多数情况下使用纯文本编码时必须编写的那样共同语言。Imo 数学表示更容易阅读，这仍然是一个非常小的方程式。

是的，如果需要，您可以将代码作为纯文本输入和复制粘贴。

将其视为下一代**语法高亮**。我敢打赌，除了数学之外，还有很多其他的东西可以从这种表示中受益。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2008-10-02T02:54:11.557

您提到我们应该使用“某种形式的 XML”？您认为 XHTML 和 XAML 是什么？

此外，XML 仍然只是一个平面文件。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2008-10-02T05:41:50.200

我们看到的关于 DSL 的趋势是阅读您的问题时首先想到的。问题是模型（如 UML）和实现之间不存在一对一的关系。微软和其他公司正在努力实现这一目标，以便您可以将您的应用程序创建为类似 UML 的东西，然后可以生成代码。重要的是 - 当您选择更改代码时，模型将再次反映这一点。

Windows Workflow Foundation 就是一个很好的例子。当然，后台有平面文件和/或 XML，但您通常最终会在编排工具中定义业务逻辑。这很酷！

我们需要更多的“软件工厂”思维，未来会看到更丰富的 IDE 体验，但只要计算机运行在 0 和 1 上，纯文本文件可以并且（可能）永远是一个中间阶段。正如已经有几个人所说的那样，简单的文本文件非常灵活。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2008-10-02T07:19:55.613

很明显为什么纯文本为王。但同样明显的是，为什么结构化格式会更好。

举个例子：如果你重命名一个方法，你的 diff/merge/source control 工具将能够告诉你只有一件事发生了变化。我们今天使用的工具会显示一长串更改，每个位置和文件调用或声明该方法。

（顺便说一下，这篇文章没有回答你可能已经注意到的问题）

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2008-10-02T08:01:52.313

我很想知道同样的事情，如答案中所述： [您希望存在什么工具/应用程序/任何东西？](https://stackoverflow.com/questions/112996/what-toolapplicationwhatever-do-you-wish-existed#113226)

虽然很容易想象很多好处，但我认为必须解决的最大障碍是没有人提出可行的替代方案。

当人们想到将源存储为文本的替代方案时，他们似乎经常会立即考虑图形表示（我在这里指的是已经可用的商业产品 - 例如 HP-vee）。如果我们看看像 FPGA 设计者这样的人的经验，我们会发现（仅）以图形方式编程是行不通的——因此像 Verilog 和 VHDL 这样的语言。

但是我不认为 source 的存储必须首先与编写它的方法绑定。来源的输入很大程度上可以作为文本完成 - 这意味着仍然可以实现复制/粘贴的问题。但我也看到，通过允许在标记化元源的基础上进行合并和回滚，我们可以实现更准确、更强大的操作工具。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2008-10-02T09:14:38.647

有关摒弃传统文本编程的语言示例，请参阅[Lava 语言](http://en.wikipedia.org/wiki/Lava_(programming_language))。

我最近发现的另一个好东西是[subtext2](http://subtextual.org/)（[视频演示](http://subtextual.org/subtext2.html)）。

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2008-10-03T22:33:05.150

Visual FoxPro 使用 dbf 表结构来存储表单、报表、类库等的代码和元数据。这些是二进制文件。它还将代码存储在实际文本文件的prg文件中......

我看到的唯一优势是能够使用内置的 VFP 数据语言对这些文件进行代码搜索……除了它是一种责任 imo。至少每隔几个月，这些文件之一就会无缘无故地损坏。与源代码控制和差异的集成也非常痛苦。有解决方法，但涉及暂时将文件转换为文本！

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2008-10-07T15:36:36.767

谁使用平面文件？

Eclipse 为您提供了对源代码的视图，以便我可以看到所有已排序和分组的内部类、方法和数据。如果我想编辑内部类，我点击它。虽然从技术上讲，有一个平面文件，但我几乎从不那样导航它。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2008-10-02T02:50:02.890

您的程序代码定义了将使用 xml 或二进制格式创建的结构。您的编程语言比 XML 或二进制表示更直接地表示您的程序结构。你有没有注意到当你给你的文档提供结构时，Word 对你的行为是如何的。WordPerfect 至少会“显示代码”以允许您查看文档下方的内容。平面文件为您的程序做同样的事情。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2008-10-02T03:01:49.867

好主意。我自己想知道规模更小……小得多，为什么 IDE X 不能生成这个或那个。

我不知道我作为一名程序员是否有能力开发出像你所说的或我在想的那样酷而复杂的东西，但我有兴趣尝试一下。

也许从 .NET、Eclipse、Netbeans 等的一些插件开始？炫耀可以做什么，并开始编码的新趋势。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2008-10-02T03:37:54.103

我认为另一方面是代码才是最重要的。这就是将要执行的内容。例如，在您的 UML 示例中，我认为在您的“源 blob”中包含 UML（可能是在某些编辑器中创建，与“代码”没有直接关系）几乎是没有用的。直接从您的代码生成 UML 会更好，因此它将代码的确切状态描述为理解代码的工具，而不是作为代码应该是什么的提醒。

关于自动化文档工具，我们多年来一直在这样做。虽然实际程序员在代码中生成的注释可能与代码不同步，但 JavaDoc 等工具忠实地表示对象上的方法、返回类型、参数等。它们以实际存在的方式表示它们，而不是某些无休止的设计会议产生的人工制品。

在我看来，如果您可以任意将随机工件添加到某些“源 blob”中，那么这些可能会过时并且不会立即有用。如果您可以直接从代码中生成这样的工件，那么让您的构建过程执行此操作的小努力要比前面提到的远离纯文本源文件的陷阱要好得多。

与此相关，[解释为什么要使用纯文本 UML 工具](http://www.spinellis.gr/pubs/jrnl/2003-IEEESW-umlgraph/html/article.html)( [UMLGraph](http://www.umlgraph.org/) ) 似乎几乎同样适用于为什么需要纯文本源文件。

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2008-10-02T07:46:18.997

这可能无法完全回答您的问题，但这里有一个编辑器可以让您拥有更高的代码视图： [http ://webpages.charter.net/edreamleo/front.html](http://webpages.charter.net/edreamleo/front.html)

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2008-10-02T10:12:03.250

我认为在开发中使用文本文件的原因是它们对各种开发工具都是通用的。您可以使用简单的文本编辑器查看内部甚至修复一些错误（您不能在二进制文件中执行此操作，因为您永远不知道任何修复会如何破坏其他数据）。然而，这并不意味着文本文件最适合所有这些目的。

当然，您可以区分和合并它们。但这并不意味着 diff/merge 工具了解此文本文件编码的数据的独特结构。您可以进行差异/合并，但是（特别是在 XML 文件中看到）差异工具不会正确地显示差异，也就是说，它会显示文件不同的地方以及工具“认为”的数据部分是相同的。但它不会向您显示 XML 文件结构的差异 - 它只会匹配看起来相同的行。

无论我们使用的是二进制文件还是文本文件，diff/merge 工具总是更好地处理这个文件表示的数据结构，而不是行和字符。例如，对于 C++ 或 Java 文件，报告某些标识符更改了其名称，报告某些部分被附加的 if(){} 包围，但另一方面，忽略缩进或 EOL 字符的更改。最好的方法是将文件读入内部结构并使用特定格式规则转储。这样，将通过内部结构进行差异化，并从合并的内部结构中生成合并结果。

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2008-10-02T20:23:18.350

现代程序是由扁平的部分组成的，但它们是扁平的吗？有使用、包含和对象库等。普通的函数调用是窥探不同的地方。由于有多个线程等，逻辑并不平坦。

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2008-10-03T00:08:42.723

我也有同样的看法！我真的希望这会存在。

您可能想看看 Sun 的研究语言 Fortress。它对源代码中的公式有特殊的支持。以下引用来自维基百科

> Fortress 从一开始就被设计为具有多个句法样式表。源代码可以呈现为 ASCII 文本、Unicode 或美化图像。这将允许在渲染输出中支持数学符号和其他符号，以便于阅读。

文本作为源的持久性的主要原因是缺乏用于非文本日期的动力工具，例如版本控制。这是基于我使用 Smalltalk 的经验，其中纯字节码一直保存在核心转储中。在非文本系统中，使用当今的工具，团队开发是一场噩梦。

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2009-01-16T15:58:55.823

没有涉及的一件事是，某些语言在变量范围等方面具有内置源文件的概念。更改为其他内容（例如将函数存储在数据库中）将需要您更改语言本身。

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2009-01-16T16:35:36.527

今晚和我的朋友（也是程序员）喝一杯时，其中一位告诉我他们使用 UML 来生成代码。但他表示，他们仍然需要手动编辑生成的代码，有些问题域不能用 UML 轻松描述。

有了 LINQ 的优点、lambda 等等，一些问题域不能用 UML 表示，我们仍然需要绕过生成的代码让计算机来做我们的投标。

我们如何在 UML 中表示以下问题，更不用说 XML 了？[使用 GROUP BY 和 COUNT(DISTINCT) 的 LINQ to SQL](https://stackoverflow.com/questions/448203/linq-to-sql-using-group-by-and-countdistinct)

这个简单问题的答案数量非常说明 UML、SQL（最重要的汇编语言，不管那些 ORM 人告诉你什么）、XML 不是 XOR 命题。我们仍将使用这些技术的组合，而不是只使用其中一种而排斥其他技术。

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2009-10-08T03:19:57.640

它仍然是平面文件，因为也许这就是他们销售软件工具的方式：D

源代码本身应该是封装为成员的面向对象的。我知道只有一种产品可以做到这一点，它存在很长时间（Windows 3.0）并且由 Paul Allen 自己设计。它最初的灵感来自 Mac 上的 Hypercard，但正如比尔盖茨所说： http: [//community.seattletimes.nwsource.com/archive/ ?date=19900522&slug=1073140](http://community.seattletimes.nwsource.com/archive/?date=19900522&slug=1073140)

> “它超越了 HyperCard，”盖茨说。

不幸的是，他们没有针对合适的人：

> `In pursuing (interests of) software developers,'' says Alsop, Asymetrix` 可能让 ToolBook 对这个小家伙来说太复杂了。''

他们应该针对专业程序员而不是业余爱好者。

直到今天，在概念层面上，它仍然超越了除 Rebol 之外的其他语言；）

# fitnesse - FitNesse Wiki 每个项目或公司？

> ID：160635
> 
> 赞同：3
> 
> 时间：2008-10-02T02:33:14.540
> 
> 标签：fitnesse

对于拥有许多开发项目的公司，您应该创建多个 FitNesse wiki（每个项目/产品一个）还是将它们全部包含在一个大型 wiki 中以涵盖所有内容？

一个大型 wiki 的优点是能够轻松链接到公司的其他产品，并且它是所有 FitNesse 测试的一站式位置。

或者，多个 wiki 的优点是更容易将测试自动化划分到多个服务器，更容易将 wiki 与项目分支/标签一起分支。

我对这两种可能性的优缺点或深思熟虑的替代方案感兴趣（例如，不是“只是以某种方式将 wiki 根结合在一起”）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-02T04:17:30.153

似乎这一切都归结为一个管理问题：
有多少服务器可用，谁来管理它们？
一个中央服务器意味着一个服务器能够承受负载，无论是在请求方面（所有项目的所有开发人员都可以在相当定期的基础上进行许多查询），还是在“服务器上”与 FitNesse 相关的计算方面。

另一个标准是可见性。您的开发项目*是否需要*互相查看 FitNesse 指标？出于“政治”原因，可能并不总是欢迎其他项目随时看到其中一些指标！一些项目经理可能想让他们靠近背心并控制他们的官方沟通。

实际上，正是出于后一个原因，我们的 FitNesses wiki 由每个团队管理，更像是一种内部工具。我们有另一个全球 wiki（基于[Confluance](http://www.atlassian.com/software/confluence/)），用于管理每个项目的全球文档。那些常见的 wiki 可能会提取一些内部 FitNesse wiki 数据。

# asp.net - 每当触发客户端 ASP.NET 验证器时运行自定义 Javascript？

> ID：160650
> 
> 赞同：3
> 
> 时间：2008-10-02T02:38:06.570
> 
> 标签：asp.net, javascript

`RequiredFieldValidator`每当触发客户端 ASP.NET 验证器（ 、`RangeValidator`等）时，是否有办法运行一些自定义 Javascript ？

基本上，我有一个复杂的布局，需要在显示或隐藏 DOM 元素时运行自定义脚本。我正在寻找一种在显示验证器时自动运行此脚本的方法。（我正在使用验证器`Display="dynamic"`）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-02T04:14:50.817

See [this comment](https://stackoverflow.com/questions/124682/can-you-have-custom-client-side-javascript-validation-for-standard-aspnet-web-f#125158) for how I managed to extend the ASP.Net client side validation. [Others](http://www.ajaxprojects.com/ajax/tutorialdetails.php?itemid=362) have managed to extend it using server side techniques.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-02T03:19:05.630

我为我的具体情况确定的最佳解决方案是：

1.  创建一个全局 JS 数据结构，将控件 ID 映射到可见性状态。
2.  在此数据结构中注册验证器（或其他任何东西）的客户端 ID。
3.  每 250 毫秒，循环遍历全局数据结构并将缓存的可见性状态与元素的当前状态进行比较。如果状态不同，请更新缓存并运行自定义调整大小脚本。

这在很多方面都很丑陋，它只是我特定场景的解决方案，而不是我们想要将任意代码搭载到验证器的显示/隐藏上的抽象案例。我想要一个更好的建议！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-02T04:05:11.323

我不确定你的问题是否正确，但这里是......你可以添加一个自定义验证器（或者可能处理 onblur 事件），在你的 javascript 自定义验证中，你可以调用 Page_ClientValidate() 并检查 Page_IsValid 是否有错误。类似于下面的代码：

> ```
> function customValidation()
> {
>     Page_ClientValidate();
>     if(!Page_IsValid)
>     { //run your resize script }
> } 
> ```

高温下，

# asp.net - HTTPHandler 从另一台服务器检索下载文件？

> ID：160651
> 
> 赞同：1
> 
> 时间：2008-10-02T02:38:10.970
> 
> 标签：asp.net, download, httphandler

我想向网站用户提供可下载的文件，但想对用户隐藏文件的 URL ...我认为 HTTPHandler 可以解决问题，但是否可以从外部服务器检索文件和将其流式传输给用户？

也许有人可以给我一个提示，告诉我如何做到这一点，或者给我指出一个以前做过的资源？

* * *

只是为了详细说明我想要实现的目标......我正在构建一个 ASP.NET 网站，其中包含一个音乐下载链接。我想保护文件的实际 URL，我还想将它们存储在外部（PHP）服务器上（便宜得多）......

所以我需要做的是设置一个流，它可以从 URL 中获取文件（指向另一台服务器），并将其流式传输到 Response 对象，而用户不会意识到它来自另一台服务器。

TransmitFile 方法是否允许从完全独立的服务器流式传输文件？我不希望文件“通过”我的服务器流式传输，因为这违背了目的（节省带宽）......我希望客户端（浏览器）直接从另一台服务器下载文件。

我可能需要文件托管服务器上的处理程序吗？也许另一端的PHP脚本是要走的路......？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-02T02:40:57.780

我建议您查看 TransmitFile 方法：http: [//msdn.microsoft.com/en-us/library/12s31dhy.aspx](http://msdn.microsoft.com/en-us/library/12s31dhy.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-02T14:08:13.057

随着您澄清希望带宽来自外部服务器而不是您的服务器，它在很大程度上改变了这个问题。

为了实现这一点，外部服务器必须有一个网站，您可以将用户发送到该网站。您不能通过您的站点流式传输文件但不会受到带宽的影响，或者无法从您的站点控制它但通过其他服务器流式传输，因此必须通过其他站点完全处理它。问题在于，基于 URL 的普通方法会向用户显示 URL，您所说的第二个要求是它不显示 URL。

但是，您难道不能只有一个通用页面来提供外部站点上的文件，而流式传输的文件的细节将通过原始站点页面上的帖子传递吗？这将删除指向特定文件的 URL。它会显示域，但用户将无法在不知道帖子字段的情况下提取文件。

这不需要是一个 HTTPHandler，只是一个普通的页面。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-06T02:11:15.243

是的，您可以从远程流（从另一台服务器下载）流式传输到输出流。假设**serviceUrl**是要流式传输的文件的位置：

```
HttpWebRequest webrequest = (HttpWebRequest)WebRequest.Create(serviceUrl);
            webrequest.AllowAutoRedirect = false;
            webrequest.Timeout = 30 * 1000;
            webrequest.ReadWriteTimeout = 30 * 1000;
            webrequest.KeepAlive = false;

            Stream remoteStream = null;
            byte[] buffer = new byte[4 * 1024];
            int bytesRead;

            try {
                WebResponse responce = webrequest.GetResponse();
                remoteStream = responce.GetResponseStream();
                bytesRead = remoteStream.Read(buffer, 0, buffer.Length);

                Server.ScriptTimeout = 30 * 60;
                Response.Buffer = false;
                Response.BufferOutput = false;
                Response.Clear();
                Response.ContentType = "application/octet-stream";
                Response.AppendHeader("Content-Disposition", "attachment; filename=" + Uid + ".EML");
                if (responce.ContentLength != -1)
                    Response.AppendHeader("Content-Length", responce.ContentLength.ToString());

                while (bytesRead > 0 && Response.IsClientConnected) {
                    Response.OutputStream.Write(buffer, 0, bytesRead);
                    bytesRead = remoteStream.Read(buffer, 0, buffer.Length);
                }

            } catch (Exception E) {
                Logger.LogErrorFormat(LogModules.DomainUsers, "Error transfering message from remote host: {0}", E.Message);
                Response.End();
                return;
            } finally {
                if (remoteStream != null) remoteStream.Close();
            }

            Response.End(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-02T02:55:49.960

我以前做过。首先，很明显，文件必须在网站用户进程可以访问的外部服务器上的共享中。

就 HTTPHandler 而言，我通过为用户提供包含他们想要下载的文件的 zip 文件来处理这个问题；这样，我的处理程序可以拦截对 .zip 文件的任何调用，并将它们流式传输到我创建的 zip 文件中。

这是代码（相当大块；我使用 MVP，所以它分为 Handler 和 Presenter）： Handler：

```
public class ZipDownloadModule: IHttpHandler, ICompressFilesView, IErrorView 
{
    CompressFilesPresenter _presenter;

    public ZipDownloadModule()
    {
        _presenter = new CompressFilesPresenter(this, this);
    }
    #region IHttpHandler Members

    public bool IsReusable
    {
        get { return true; }
    }

    public void ProcessRequest(HttpContext context)
    {
        OnDownloadFiles();
    }

    private void OnDownloadFiles()
    {
        if(Compress != null)
            Compress(this, EventArgs.Empty);
    }

    #endregion

    #region IFileListDownloadView Members

    public IEnumerable<string> FileNames
    {
        get 
        {
            string files = HttpContext.Current.Request["files"] ?? string.Empty;

            return files.Split(new Char[] { ',' });
        }
    }

    public System.IO.Stream Stream
    {
        get
        {
            HttpContext.Current.Response.ContentType = "application/x-zip-compressed";
            HttpContext.Current.Response.AppendHeader("Content-Disposition", "attachment; filename=ads.zip");
            return HttpContext.Current.Response.OutputStream;
        }
    }

    public event EventHandler Compress;

    #endregion

    #region IErrorView Members

    public string errorMessage
    {
        set {  }
    }

    #endregion
} 
```

主持人：

```
public class CompressFilesPresenter: PresenterBase<ICompressFilesView>
{
    IErrorView _errorView;

    public CompressFilesPresenter(ICompressFilesView view, IErrorView errorView)
        : base(view)
    {
        _errorView = errorView;
        this.View.Compress += new EventHandler(View_Compress);
    }

    void View_Compress(object sender, EventArgs e)
    {
        CreateZipFile();
    }

    private void CreateZipFile()
    {
        MemoryStream stream = new MemoryStream();

        try
        {
            CreateZip(stream, this.View.FileNames);

            WriteZip(stream);
        }
        catch(Exception ex)
        {
            HandleException(ex);
        }
    }

    private void WriteZip(MemoryStream stream)
    {
        byte[] data = stream.ToArray();

        this.View.Stream.Write(data, 0, data.Length);
    }

    private void CreateZip(MemoryStream stream, IEnumerable<string> filePaths)
    {
        using(ZipOutputStream s = new ZipOutputStream(stream)) // this.View.Stream))
        {
            s.SetLevel(9); // 0 = store only to 9 = best compression

            foreach(string fullPath in filePaths)
                AddFileToZip(fullPath, s);

            s.Finish();
        }
    }

    private static void AddFileToZip(string fullPath, ZipOutputStream s)
    {
        byte[] buffer = new byte[4096];

        ZipEntry entry;

        // Using GetFileName makes the result compatible with XP
        entry = new ZipEntry(Path.GetFileName(fullPath));

        entry.DateTime = DateTime.Now;
        s.PutNextEntry(entry);

        using(FileStream fs = File.OpenRead(fullPath))
        {
            int sourceBytes;
            do
            {
                sourceBytes = fs.Read(buffer, 0, buffer.Length);
                s.Write(buffer, 0, sourceBytes);
            } while(sourceBytes > 0);
        }
    }

    private void HandleException(Exception ex)
    {
        switch(ex.GetType().ToString())
        {
            case "DirectoryNotFoundException":
                _errorView.errorMessage = "The expected directory does not exist.";
                break;
            case "FileNotFoundException":
                _errorView.errorMessage = "The expected file does not exist.";
                break;
            default:
                _errorView.errorMessage = "There has been an error. If this continues please contact AMG IT Support.";
                break;
        }
    }

    private void ClearError()
    {
        _errorView.errorMessage = "";
    }
} 
```

希望这可以帮助！！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-02T23:38:13.437

好吧，似乎我避免编写/部署一些 php 代码的努力是徒劳的......这是我将在文件（php）服务器上运行的内容：

[http://www.zubrag.com/scripts/download.php](http://www.zubrag.com/scripts/download.php)

然后来自我的 asp.net 网络服务器的链接将指向该脚本，然后该脚本将下载相关文件（因此避免直接下载，并允许通过谷歌分析跟踪下载）......我认为这样就可以了

谢谢大家格雷格

# html - HTML - 在保持纵横比的同时尽可能大地显示图像

> ID：160666
> 
> 赞同：21
> 
> 时间：2008-10-02T02:44:59.253
> 
> 标签：html

我想要一个显示单个 PNG 或 JPEG 图像的 HTML 页面。我希望图像占据整个屏幕，但是当我这样做时：

```
<img src="whatever.jpeg" width="100%" height="100%" /> 
```

它只是拉伸图像并弄乱纵横比。我该如何解决这个问题，以便图像在缩放到可能的最大尺寸时具有正确的纵横比？

* * *

Wayne 发布的解决方案**几乎**可以正常工作，除非您有一个高图像和一个宽窗口。这段代码是对他的代码的轻微修改，可以满足我的要求：

```
<html>
  <head>
    <script>
      function resizeToMax(id){
          myImage = new Image() 
          var img = document.getElementById(id);
          myImage.src = img.src; 
          if(myImage.width / document.body.clientWidth > myImage.height / document.body.clientHeight){
              img.style.width = "100%";
          } else {
              img.style.height = "100%";
          }
      }
    </script>
  </head>
  <body>
    <img id="image" src="test.gif" onload="resizeToMax(this.id)">
  </body>
</html> 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-02T03:03:19.473

这是一个快速功能，可以将高度或宽度调整为 100%，具体取决于哪个更大。在 FF3、IE7 和 Chrome 中测试

```
<html>
<head>
<script>
function resizeToMax(id){
    myImage = new Image() 
    var img = document.getElementById(id);
    myImage.src = img.src; 
    if(myImage.width > myImage.height){
        img.style.width = "100%";
    } else {
        img.style.height = "100%";
    }
}
</script>
</head>
<body>
<img id="image" src="test.gif" onload="resizeToMax(this.id)">
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-02T03:24:44.900

您不一定要根据哪个更大的方向向某个方向伸展。例如，我有一个宽屏显示器，所以即使它的图像比它的高宽，从左到右拉伸它仍然可能会剪掉顶部和底部边缘。

您需要计算窗口宽度和高度与图像宽度和高度之间的比率。较小的一个是您的控制轴 - 另一个是依赖的。即使两个轴都大于各自的窗口长度也是如此。

```
<script type="text/javascript">
// <![CDATA[
function resizeToMax (id) {
    var img = document.getElementById(id);
    myImage = new Image();
    myImage.src = img.src;
    if (window.innerWidth / myImage.width < window.innerHeight / myImage.height) {
        img.style.width = "100%";
    } else {
        img.style.height = "100%";
    }
}
// ]]>
</script> 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-10-19T18:00:31.523

也可以使用纯 CSS 使用背景图像和`background-size:contain`属性来做到这一点：

```
<head>
<style>
#bigPicture
{
    width:100%;
    height:100%;
    background:url(http://upload.wikimedia.org/wikipedia/commons/4/44/CatLolCatExample.jpg);
    background-size:contain;
    background-repeat:no-repeat;
    background-position:center;
}
</style>
</head>

<body style="margin:0px">
    <div id="bigPicture">
    </div>
</body> 
```

如果容器更改纵横比，这具有自动更新的好处，而无需响应调整大小事件（此处编码的 Javascript 方法可能导致在用户调整浏览器大小时截断图像）。该`<embed>`方法具有相同的好处，但 CSS 更流畅，并且没有安全警告问题。

注意事项：

*   没有`<img>`元素意味着没有上下文菜单和替代文本。
*   IE 仅支持`background-size:contain`9+，我什至无法在 IE9 中使用它（原因不明）。
*   似乎所有`background-*`属性都必须在与背景图像相同的 CSS 块中指定，因此同一页面上的多个图像每个都需要自己的`contain`,`no-repeat`和`center`.

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-02T02:48:36.717

试试这个：

```
<img src="whatever.jpeg" width="100%" height="auto" /> 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-02T02:51:27.130

要搭载 Franci Penov，是的，您只想设置其中一个。如果您有一张宽幅图片，您希望将宽度设置为 100% 并保留高度。如果你有一张长图，你想将高度设置为 100% 并留下宽度。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2018-01-15T19:47:56.983

最简单的方法（如果您不需要支持 IE）是将`object-fit`CSS 属性设置为`contain`：

```
img { object-fit: contain; } 
```

也可以看看：

*   [https://developer.mozilla.org/en-US/docs/Web/CSS/object-fit](https://developer.mozilla.org/en-US/docs/Web/CSS/object-fit)
*   [https://caniuse.com/#search=object-fit](https://caniuse.com/#search=object-fit)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-02T03:07:46.797

为此，JavaScript 是您的朋友。您想要做的是在页面加载时，遍历 dom，并为每个图像（或者，如果它只是单个图像，则传递一个图像 id 的函数）检查图像的哪个属性更大，它是高度还是宽度。

这是 IMAGE 本身，而不是标签。

一旦你得到了，然后将标签上相应的高度/宽度设置为 100%，另一个设置为自动

一些有用的代码——全部来自我的脑海，所以你的里程可能会因语法而异..

```
var imgTag = $('myImage'); 
var imgPath = imgTag.src; 
var img = new Image(); 
img.src = imgPath; 
var mywidth = img.width; 
var myheight = img.height; 
```

顺便说一句，这在服务器端将是一项更容易的任务。在服务器上，您可以从字面上更改流向浏览器的图像的大小。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-08-17T21:22:04.350

在 IE 和 Firefox 上测试，加上第一行将居中图像：

```
<div align="center">
<embed src="image.gif" height="100%"> 
```

...也可以很好地保留任何其他尺寸值的纵横比，因此不再需要烦人的计算 =)

# http - 您如何知道 HTTP 压缩是否有效？

> ID：160691
> 
> 赞同：21
> 
> 时间：2008-10-02T02:55:54.717
> 
> 标签：http, iis-7, compression

您如何知道 HTTP 压缩设置是否有效？在浏览器解压缩之前，我可以使用任何工具查看压缩页面吗？是否有任何工具可以测量压缩量和响应速度？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-08-09T17:52:52.277

这不是 IIS 特定的，但您可以使用 cURL：

```
curl -H 'Accept-Encoding: gzip,deflate' -D - http://example.com 
```

然后`Content-Encoding: gzip`在输出中查找标题。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-10-02T02:57:44.340

对于 Windows，我强烈推荐[Fiddler](http://fiddler2.com/fiddler2/)，它是一个客户端工具，可以代理您的网络流量并让您检查它。它会告诉你压缩是否打开并正常工作。它对于许多其他客户端 HTTP 相关的调试和诊断任务也很有用。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-10-03T01:11:15.927

除了像[Fiddler](http://www.fiddlertool.com/fiddler/)这样查看 HTTP 级别的流量外，您还可以将 Firefox 与[Firebug](http://getfirebug.com/)和[YSlow](http://developer.yahoo.com/yslow/)附加组件一起使用。YSlow 为您提供了很多有用的分析，说明您的页面为何会变慢 - 其中，它为您提供了您的请求下载的各种资产（HTML、CSS、JavaScript、图像和其他媒体等）的大小。您可以比较压缩和不压缩的页面大小 - 如果打开压缩后 HTML 较小，您就知道它正在工作。它还将为您提供空缓存和已准备好的缓存的值，让您查看为新访问者和回访者节省了多少。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2014-11-08T00:05:19.700

如果您有 chrome，请按 F12，然后导航到该站点。网站加载后，转到“网络”选项卡。单击您正在查找的文件，然后单击标题下的查找部分响应标题。寻找内容编码部分

看下图的例子

![在此处输入图像描述](https://i.stack.imgur.com/lA9B6.jpg)

要查看传输了多少数据，请在网络选项卡中，将鼠标悬停在大小列上。它显示了完整的文件大小以及通过网络传输的数据的大小。下面是一个例子。请参阅显示此信息的工具提示

[![数据传输大小](https://i.stack.imgur.com/yFwoK.png)](https://i.stack.imgur.com/yFwoK.png)

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-10-02T02:57:24.607

你可以使用这个网站： [http ://whatsmyip.org/mod_gzip_test/](http://whatsmyip.org/mod_gzip_test/)

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2008-10-02T03:11:39.080

[Wireshark，前 Etherial](http://www.wireshark.org/)已被证明是对我来说最有价值的工具。
只需选择一个网络适配器（如果有很多），在过滤器字段中输入“tcp 端口 80”，然后按 Capture - 一切就绪。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2016-10-12T22:56:23.630

最简单、最快捷的方法是查看 Developer Tools *Network*选项卡，看看每个请求的*Content*和*Size*值是否不同。如果值不同，则压缩正在工作。将*大小*除以*内容*以获得压缩比。我不确定这些值可见多长时间，但它们存在于 Chrome 53 中。不确定在 Firefox 上。

[![Chrome 开发者工具，网络标签](https://i.stack.imgur.com/08NrD.png)](https://i.stack.imgur.com/08NrD.png)

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-10-03T00:59:05.943

对于 Firefox，请查看这些附加组件：

1.  萤火虫
2.  HttpFox

两者都可以用来监控您进出浏览器的流量（您可以看到每个响应的大小）。我特别喜欢 Httpfox，一个我每天都在使用的非常好的插件。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-10-02T03:02:03.940

使用[Fiddler](http://www.fiddler2.com)监视您的 HTTP 传输。

“构建请求”（创建 HTTP GET）并检查未压缩页面的 HTTP 响应的“内容编码”标头，并检查其“内容长度”。将这些值与压缩页面的相同值进行比较。

对于压缩响应，“Content-Encoding”应该类似于“gzip”，并且您的“Content-Length”应该更短。您可以使用两者中的“Content-Length”字段来确定压缩比。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-02T03:35:15.717

如果您想使用非常低的技术，您可以远程登录到目标服务器上的 HTTP 端口（80？）并手动输入请求。如果你得到纯文本，那么它不会被压缩，但如果你得到乱码，那么你就会做一些事情。如果您需要查看标头的结构，可以使用[Live HTTP Headers](https://addons.mozilla.org/en-US/firefox/addon/live-http-headers/)扩展等从 Firefox 复制它们。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2012-08-20T13:18:37.057

最简单的方法是使用这个：

[http://www.whatsmyip.org/http-compression-test/](http://www.whatsmyip.org/http-compression-test/)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-06-16T18:01:05.877

在 Chrome 开发人员工具中，您可以在选项卡的列中添加您选择的响应标头（在您的情况下为 <code>content-encoding）`Network`。

只需右键单击一个请求，然后单击`Header Options`、`Response Headers`，然后选择`Content-Encoding`。

完成此操作后，您将能够`content-encoding`在`Network`选项卡中看到 ，而无需单击任何单独的请求：

![例子](https://i.stack.imgur.com/5LXIZ.png)

* * *

## 回答 #13

> 赞同：-2
> 
> 时间：2008-10-03T06:53:09.680

我们四处搜寻了一下。显然，有很多网站可以验证我们的页面是否被压缩。

# javascript - 使用 Javascript 的语法高亮代码

> ID：160694
> 
> 赞同：110
> 
> 时间：2008-10-02T02:57:33.093
> 
> 标签：javascript, html, syntax, syntax-highlighting

您可以推荐哪些 Javascript 库来突出显示 HTML 中的 <code> 块的语法？

（请每个答案提出一个建议）。

* * *

## 回答 #1

> 赞同：104
> 
> 时间：2008-10-02T03:08:59.540

StackOverflow 使用[Prettify](https://github.com/google/code-prettify)库。

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2012-03-30T13:04:49.590

我最近开发了一种叫做彩虹。

主要的设计目标是使核心库变得非常小，并使开发人员能够非常容易地扩展。

请参阅[http://rainbowco.de](http://rainbowco.de)。

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2008-10-02T02:58:53.433

[SyntaxHighlighter](http://alexgorbatchev.com/SyntaxHighlighter/)作为[GitHub 项目](https://github.com/alexgorbatchev/SyntaxHighlighter)提供。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2010-07-29T03:59:40.010

[jQuery Syntax Highlighter](https://github.com/balupton/jquery-syntaxhighlighter)是基于[Google 的 Prettify](http://code.google.com/p/google-code-prettify/)的新产品- 一个非常非常流行的纯 JavaScript 语法高亮器。

它支持`code`和`pre`块之类的东西，能够使用类名`language-javascript`来表示我们希望它突出显示，以及自动换行。您可以通过正常选择来复制和粘贴代码，而不必像许多其他人一样打开原始视图。它可以通过使用 HTML5 数据属性`data-sh`或通过在初始化时指定选项来进一步定制。定期更新的绝佳稳定选择。

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2012-11-21T07:44:31.110

Lea Verou的[棱镜](http://prismjs.com/)怎么样。

从她在 2012 年 6 月发布的[博文](http://lea.verou.me/2012/07/introducing-prism-an-awesome-new-syntax-highlighter/)中：

> *   它很小。内核压缩和压缩后只有 1.5KB。
> *   它具有令人难以置信的可扩展性。不仅很容易添加新语言（现在每个语法高亮器都提供这一点），而且扩展现有语言也很容易。
> *   它通过 Web Workers 支持并行性，以便在某些情况下获得更好的性能。
> *   它不会强迫您使用任何特定于 Prism 的标记，甚至不是特定于 Prism 的类名，而只是您应该使用的标准标记。所以，你可以试一试，不喜欢就去掉，不留痕迹。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-10-02T02:59:57.563

怎么样：

[语法高亮](http://code.google.com/p/syntaxhighlighter/)

[突出显示.js](http://softwaremaniacs.org/soft/highlight/en/)

[JS荧光笔](http://www.devpro.it/jshighlighter/)

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-10-02T03:23:44.497

如果您使用的是 jQuery，则有 Chilli：

[http://code.google.com/p/jquery-chili-js/](http://code.google.com/p/jquery-chili-js/)

您所要做的就是包含 jquery-chili.js 和 recipes.js，并使用

```
$("code").chili(); 
```

它应该自己弄清楚语言。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2008-10-02T03:52:21.493

我对**[SHJS](http://shjs.sourceforge.net/)**很满意。它支持多种语言，并且看起来非常快速和准确。

**[这是我在博客](http://andrew.hedges.name/blog/2008/05/13/widget-javascript-the-un-series-part-0)**上使用它的示例。我正在使用我自己的自定义 CSS 文件来模拟**[Coda 的](http://panic.com/coda/)**语法突出显示。如果您想使用它，请给我发电子邮件。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2010-03-15T08:48:58.263

[jQuery.Syntax](http://www.oriontransfer.co.nz/software/jquery-syntax)是一个非常快速和轻量级的语法荧光笔。它具有语法源文件的动态加载，并使用 CSS 或模式线干净地集成。

它是专门为填补空白而开发的——即：一个快速、干净的客户端语法解析器。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-10-02T08:39:51.007

我不是在争论，只是认为值得一提的是，如果您使用的是 CMS 或博客平台，那么出于显而易见的原因，使用后端荧光笔会更好 — 看看[Geshi](http://qbnz.com/highlighter/) ( [http://qbnz.com/highlighter/](http://qbnz.com/highlighter/) ) 如果你有兴趣。实际上，您可以设置您的服务器以通过后端技术解析 HTML 内容——因此根本不需要 JS 荧光笔。（他们添加的唯一功能是打印/复制[使用 swf] 的能力。）

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2011-12-24T22:48:21.483

如果您正在浏览器内的编辑器中寻找语法高亮，请尝试[CodeMirror](http://codemirror.net)。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-10-02T02:59:43.087

[语法高亮](http://code.google.com/p/syntaxhighlighter/)

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-05-05T03:50:42.630

[Web Resources Depot 上的这篇文章](http://www.webresourcesdepot.com/11-syntax-highlighters-to-beautify-code-presentation/)列出了一系列用于突出显示代码的选项，其中一些使用了 Javascript。它于 2009 年 5 月 4 日发布。

# java - 使用 xor 运算符进行布尔检查是一种好习惯吗？

> ID：160697
> 
> 赞同：157
> 
> 时间：2008-10-02T02:58:12.670
> 
> 标签：java, conditional, bitwise-operators, logical-operators, xor

我个人喜欢*排他性 or* , `^`, 运算符，因为它的简洁性在布尔检查的上下文中是有意义的。我更喜欢写作

```
if (boolean1 ^ boolean2)
{
  //do it
} 
```

比

```
if((boolean1 && !boolean2) || (boolean2 && !boolean1))
{
  //do it
} 
```

但我经常从其他有经验的 Java 开发人员（不仅仅是新手）那里得到困惑，有时会评论它应该如何只用于按位运算。

我很好奇关于`^`操作员使用的最佳实践。

* * *

## 回答 #1

> 赞同：310
> 
> 时间：2008-10-02T02:59:29.920

您可以简单地使用`!=`。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2008-10-02T03:34:54.033

我想你已经回答了你自己的问题——如果你从别人那里得到奇怪的表情，那么选择更明确的选项可能更安全。

如果您需要对其发表评论，那么您最好用更详细的版本替换它，而不是让人们首先提出问题。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2008-10-02T05:00:48.287

我发现我有很多类似的对话。一方面，你有一个紧凑、有效的方法来实现你的目标。另一方面，你有一些团队其他成员可能不理解的东西，这使得将来很难维护。

我的一般规则是询问所使用的技术是否是期望程序员普遍知道的合理的东西。在这种情况下，我认为期望程序员知道如何使用布尔运算符是合理的，因此在 if 语句中使用 xor 是可以的。

举个不太好的例子，使用 xor 来交换两个变量而不使用临时变量。这是一个我不希望每个人都熟悉的技巧，所以它不会通过代码审查。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2008-10-02T02:59:38.953

我想如果你评论它就可以了，例如`// ^ == XOR`。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2013-02-22T18:28:52.193

你总是可以把它包装在一个函数中，给它一个详细的名字：

```
public static boolean XOR(boolean A, boolean B) {
    return A ^ B;
} 
```

但是，在我看来，对于任何不知道 ^ 运算符的用途的人来说，谷歌搜索它并不难。在第一次之后记住它并不难。由于您要求其他用途，因此通常使用 XOR 进行位掩码。

您还可以[使用 XOR 来交换两个变量中的值，而无需使用第三个临时变量](https://en.wikipedia.org/wiki/XOR_swap_algorithm)。

```
// Swap the values in A and B
A ^= B;
B ^= A;
A ^= B; 
```

这是一个[与 XOR 交换相关的 Stackoverflow 问题](http://stackoverflow.com/questions/249423/how-does-xor-variable-swapping-work)。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2010-04-10T08:33:35.980

```
if((boolean1 && !boolean2) || (boolean2 && !boolean1)) 
{ 
  //do it 
} 
```

恕我直言，此代码可以简化：

```
if(boolean1 != boolean2) 
{ 
  //do it 
} 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2012-10-21T05:11:36.453

考虑到代码的清晰性，我认为在布尔检查中使用 XOR 并不是 XOR 位运算符的典型用法。根据我的经验，Java 中的按位异或*通常*用于实现掩码`flag toggle`行为：

```
flags = flags ^ MASK; 
```

Vipan Singla 的[这篇文章更详细地解释了使用案例。](http://vipan.com/htdocs/bitwisehelp.html)

如果您需要在示例中使用按位 XOR，请评论您使用它的原因，因为它可能需要即使是按位识字的观众也需要停下来了解您使用它的原因。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2017-08-12T04:39:17.303

由于简洁，我个人更喜欢“boolean1 ^ boolean2”表达式。

如果我处于您的情况（在团队中工作），我会通过将“boolean1 ^ boolean2”逻辑封装在具有描述性名称（例如“isDifferent(boolean1, boolean2)”的函数中）来达成妥协。

例如，不要使用“boolean1 ^ boolean2”，而是调用“isDifferent(boolean1, boolean2)”，如下所示：

```
if (isDifferent(boolean1, boolean2))
{
  //do it
} 
```

您的“isDifferent(boolean1, boolean2)”函数如下所示：

```
private boolean isDifferent(boolean1, boolean2)
{
    return boolean1 ^ boolean2;
} 
```

当然，这个解决方案需要使用一个表面上无关的函数调用，它本身受到最佳实践审查，但它避免了冗长（和丑陋）的表达式“(boolean1 && !boolean2) || (boolean2 && !boolean1) “！

* * *

## 回答 #9

> 赞同：-3
> 
> 时间：2008-10-02T03:03:02.110

如果使用模式证明它是合理的，为什么不呢？虽然您的团队不会立即识别操作员，但随着时间的推移他们可以。人类一直在学习新单词。为什么不在编程中？

我可能要说的唯一警告是“^”没有第二个布尔检查的短路语义。如果你真的需要短路语义，那么静态 util 方法也可以。

```
public static boolean xor(boolean a, boolean b) {
    return (a && !b) || (b && !a);
} 
```

* * *

## 回答 #10

> 赞同：-3
> 
> 时间：2009-02-05T10:13:25.503

!= 可以比较两个变量。但是，通过多重比较，它不起作用。

* * *

## 回答 #11

> 赞同：-3
> 
> 时间：2011-03-24T16:44:09.557

作为按位运算符，xor 比任何其他替换它的方法都要快得多。因此，对于性能关键和可扩展的计算，xor 是必不可少的。

我的主观个人意见：绝对禁止出于任何目的使用相等（== 或！=）作为布尔值。使用它表明缺乏基本的编程道德和基础。任何让你困惑的人都应该把 ^ 送回布尔代数的基础（我很想在这里写“信仰之河”:)）。

* * *

## 回答 #12

> 赞同：-4
> 
> 时间：2010-11-17T14:54:47.453

```
str.contains("!=") ^ str.startsWith("not(") 
```

对我来说看起来比

```
str.contains("!=") != str.startsWith("not(") 
```

# crystal-reports - 如何在 web.Config 文件中建立 ODBC 连接

> ID：160714
> 
> 赞同：0
> 
> 时间：2008-10-02T03:02:57.510
> 
> 标签：crystal-reports, odbc

我是用sybase数据库做水晶报表的。我将使用reportviewer 来查看这些报告。我被困在如何在 web.config 文件中建立 ODBC 连接。

我已经完成了winforms，但我仍在学习。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-02T00:38:52.347

看看[connectionstrings.com：http://www.connectionstrings.com/sybase-advantage](http://www.connectionstrings.com/sybase-adaptive)和[http://www.connectionstrings.com/sybase-adaptive](http://www.connectionstrings.com/sybase-advantage)

# google-app-engine - 与 Google App Engine 一起上传图片

> ID：160724
> 
> 赞同：7
> 
> 时间：2008-10-02T03:05:29.827
> 
> 标签：google-app-engine, yaml, image-uploading

我正在开发一个 Google App Engine 项目。

我的应用程序在本地工作并且看起来正确，但是当我尝试在图像目录中上传图像时，它们没有显示在 apppot 中。

作为一个小故障排除，我在“/images/page2.html”中放置了一个 HTML 页面，我可以在 apppot 中加载该页面，但我的页面不显示我的图像。所以，这不是我的路径的问题。

作为另一个健全性检查，我还上传了一个包含 .css 代码的样式表目录，并且正在正确读取。

我怀疑问题出在我的 app.yaml 文件中。

有任何想法吗？

我不想在这里粘贴所有代码，但这里有一些关键行。前两个工作正常。第三个不起作用：

```
<link type="text/css" rel="stylesheet" href="/stylesheets/style.css" />
<a href="/images/Page2.html">Page 2</a>
<img src="/images/img.gif"> 
```

这是我的 app.yaml 文件

```
application: myApp
version: 1
runtime: python
api_version: 1

handlers:
- url: /stylesheets
  static_dir: stylesheets

- url: /images
  static_dir: images

- url: /.*
  script: helloworld.py 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-09T07:22:01.890

您必须为图像和 css 文件等静态内容配置 app.yaml

例子：

```
 url: /(.*\.(gif|png|jpg))
  static_files: static/\1
  upload: static/(.*\.(gif|png|jpg)) 
```

有关更多信息，请查看： [http ://code.google.com/appengine/docs/configuringanapp.html](http://code.google.com/appengine/docs/configuringanapp.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-03T02:53:45.137

我敢打赌，您的问题是您使用的是 Windows。

如果是这种情况，我相信您的 static_dir 值需要前面的斜杠。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-20T09:29:51.727

我正在使用 Java 版本的 App 引擎，我遇到了服务器无法提供静态图像的类似问题。

最终起作用的是在我的情况下更改 AppEngine 配置文件“appengine-web.xml”以包含

```
<static-files>
<include path="**.*"/>
    <include path="/images/**.*" />
</static-files> 
```

我的图像位于 /images 目录中，而 HTML 和 CSS 位于 . WEB-INF 级别的目录

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-17T04:24:13.687

```
<img src="/images/img.gif"> 
```

此行无法向您显示图像。试试这个：

1-创建一个类来处理“图像请求”

```
class GetImage(webapp.RequestHandler):
      def get(self):
       self.response.headers['Content-Type'] = 'image/jpg'
       self.response.out.write(image_object) 
```

2-在您的 page.html 中：

```
<img src="/image" 
```

3-在您的 code.py 中的主要功能：

```
application = webapp.WSGIApplication(('/image', GetImage), debug=True) 
```

玩得开心

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-08T14:59:43.143

@jamtoday 前面的斜线没有什么不同，但它确实让我开始弄清楚每个应用程序需要被告知我的目录结构。

所以，我没有什么非常确定的补充，但我想跟进，因为我让它工作了，但我没有在它工作后探索所有问题。

一项有帮助的更改是停止从 HwlloWorld/src/ 目录工作并开始在 HelloWorld/ 目录中工作。似乎 dev_appserver 获取了所有依赖项，但远程服务器没有。本质上，我的本地链接的相对路径与上传后链接的相对路径不匹配。

我还意识到 dev-appserver 依赖于 .yaml 文件以及 appcfg 脚本。那是。. .如果您将目录添加到项目中，然后尝试链接到该目录中的文件，则需要将该目录添加到 .yaml 文件中，然后重新启动 dev-appserver 以进行此操作。

因此，如果您为 .yaml 文件提供正确的信息，则可能有一些方法可以处理我最初尝试做的事情，但更改为本地不同的目录结构会为我处理它。

# c# - 为您的单元测试赋予个性

> ID：160726
> 
> 赞同：-2
> 
> 时间：2008-10-02T03:06:40.090
> 
> 标签：c#, .net, unit-testing

我一直在思考单元测试以及如何提高单元测试的可读性。我想为什么不在单元测试中给类一个字符来阐明它们的作用。

这是我写的一个简单的单元测试：

```
[TestFixture]
    public class when_dave_transfers_money_from_wamu_account_to_the_woodforest_account 
    {
        [Test]
        public void should_increase_the_amount_in_woodforest_account_when_transaction_successfull()
        {
            Dave dave = new Dave();

            Wamu wamu = new Wamu();
            wamu.Balance = 150; 

            wamu.AddUser(dave);

            Woodforest woodforest = new Woodforest();
            woodforest.AddUser(dave);

            FundTransferService.Transfer(100, wamu, woodforest);

            Assert.AreEqual(wamu.Balance, 50); 
            Assert.AreEqual(woodforest.Balance, 100); 
        }
} 
```

这是戴夫课程：

```
/// <summary>
    /// This is Dave!
    /// </summary>
    public class Dave : User
    {      
        public Dave()
        {
            FirstName = "Dave";
            LastName = "Allen";            
        }

    } 
```

单元测试名称清楚地服务于目的。但是，也许我想更深入地挖掘并在创建 Dave 时将 Wamu 和 Woodforest 帐户分配给 Dave。问题是它将远离可读性，因为我将不得不使用索引值来引用帐户。

你对使它更具可读性有什么想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-02T03:10:43.717

测试夹具中的私有辅助方法怎么样

```
private Dave GetDave_With_Wamu_And_Woodforest_AccountsHookedUp() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-02T03:34:01.133

这是运行测试的另一种方法：

```
 [Test]
        public void should_increase_the_amount_in_woodforest_account_when_transaction_successfull()
        {
            Dave dave = new Dave();

            // we know that dave has wamu and wooforest accounts 

            dave.WamuAccount("Wamu").Balance = 150;

            FundTransferService.Transfer(100, dave.WamuAccount("Wamu"), dave.WoodforestAccount(
                "Woodforest"));

            Assert.AreEqual(50, dave.WamuAccount("Wamu").Balance);
            Assert.AreEqual(100, dave.WoodforestAccount("Woodforest").Balance);             
        } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-02T03:12:26.050

当像这样创建 Dave 时，我可以将 Dave 添加到 Wamu 和 Woodforest 帐户：

```
 public Dave()
        {
            FirstName = "Dave";
            LastName = "Allen"; 

            // add accounts for Dave 

            Wamu wamu = new Wamu();
            wamu.AddUser(this);

            Woodforest woodforest = new Woodforest();
            woodforest.AddUser(this); 
        } 
```

这些帐户被添加到 Dave 继承的 User 对象中的 List 集合中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-02T03:21:02.600

当您尝试实例化 Wamu 实例时，它不应该抛出 WamuNotFoundException 吗？

# visual-studio-2008 - 我的解决方案中不同项目中的 Crystal Reports 数据源？

> ID：160737
> 
> 赞同：5
> 
> 时间：2008-10-02T03:09:57.883
> 
> 标签：visual-studio-2008, crystal-reports

我想使用预先存在的 LINQ 类创建一个 Crystal Reports 报表，这些类与报表所在的项目不同。我找不到办法做到这一点。我正在使用VS2008。

每当我展开“项目数据”树时，我只会看到当前项目中的类。“历史”树向我展示了 OTHER 项目中的最后 5 个类，但我需要的不仅仅是这 5 个。我在“ADO.NET”下找到了“建立新连接”选项，但它看起来像是在寻找 XML 源和DLL。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-03T02:26:06.140

您可能能够破解您在报告中获取所需的所有表格的方法。历史信息是从磁盘上的 xml 文件中读取的。这些通常位于“C:\Documents and Settings{UserName}\My Documents\History”中。在这里，您将找到五个最近使用的连接。我还没有尝试过，但也许您可以设置前五个类，添加必要的表格并保存报告并关闭 VStudio。接下来，编辑 xml 文件以指向正确的类，然后重新打开解决方案。转到Databse Expert，您应该可以使用新的五个历史连接。然后，您可以将必要的表格添加到现有报告中。
仅供参考，注册表设置“HKCU\Business Objects\Suite 11.5\Crystal Reports\Crystal Data Source History”给出了历史文件的位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-03T02:44:01.447

我不知道这是否相关，但我对 Visual Studio ReportBuilder（.rdlc 报告）有类似的问题。发生的情况是，当我构建报告时，来自其他项目的数据源不会显示在数据源窗口中。我最终要做的是在解决方案资源管理器中突出显示数据源所在的项目。只有在这样做之后，我才能从另一个项目中选择数据源。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-05-20T01:25:12.597

我正在使用 Crystal Reports 13.0 和 Visual Studio 2010。我能够通过创建新的 ADO.NET (XML) 连接来手动设置我的数据源。当对话框出现时，有一个地方可以输入类名，我只需要输入完整的命名空间和类名。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-10-10T18:31:24.000

步骤 - 将 CR 报告添加到包含现有 Linq 类的项目中 - 在数据库专家 -> 项目数据 -> .NET 对象：右键单击 -> 刷新 - 返回您正在处理的报告 - 打开数据库专家：类应该在那里。

注意：在我的情况下，这两个项目在同一个解决方案中。

# c# - 您如何将 { 和 } 放入格式字符串中

> ID：160742
> 
> 赞同：22
> 
> 时间：2008-10-02T03:12:04.290
> 
> 标签：c#, .net, string, formatting

我试图在运行时生成一些代码，在其中放入一些样板文件，并允许用户输入实际的工作代码。我的样板代码如下所示：

```
using System;

public class ClassName
{
    public double TheFunction(double input)
    {
        // user entered code here
    }
} 
```

理想情况下，我想我想使用 string.Format 来插入用户代码并创建一个唯一的类名，但是除非它看起来像这样，否则格式字符串会出现异常：

```
string formatString = @"
using System;

public class ClassName
{0}
    public double TheFunction(double input)
    {0}
        {2}
    {1}
{1}"; 
```

然后我这样调用 string.Format ：

```
string entireClass = string.Format(formatString, "{", "}", userInput); 
```

这很好，我可以处理在格式字符串中使用 {0} 和 {1} 代替大括号的丑陋之处，只是现在我的用户输入也不能使用大括号。有没有办法在我的格式字符串中转义大括号，或者将用户代码中的大括号转换为 {0} 和 {1} 的好方法？

顺便说一句，我知道这种事情是一个等待发生的安全问题，但这是一个 Windows 窗体应用程序，供未连接到网络的系统内部使用，因此在这种情况下风险是可以接受的。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2008-10-02T03:14:14.237

通过将它们加倍来逃避它们：

```
string s = String.Format("{{ hello to all }}");
Console.WriteLine(s); //prints '{ hello to all }' 
```

来自[http://msdn.microsoft.com/en-us/netframework/aa569608.aspx#Question1](http://msdn.microsoft.com/en-us/netframework/aa569608.aspx#Question1)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-02T03:14:02.677

“{{“ 和 ”}}”

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-02T03:16:12.250

我想你想要的是这个...

```
string formatString = @"
using System;

public class ClassName
{{
    public double TheFunction(double input)
    {{
        {0}
    }}
}}";

string entireClass = string.Format(formatString, userInput); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-02T03:14:43.910

双括号：`string.Format("{{ {0} }}", "Hello, World");`会产生`{ Hello, World }`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-02T08:24:27.627

在谁有权访问该应用程序时要格外小心。更好的解决方案可能是创建一个只需要几个有限命令的简单解析器。

# ip-address - 你会如何比较IP地址？

> ID：160776
> 
> 赞同：13
> 
> 时间：2008-10-02T03:28:37.230
> 
> 标签：ip-address

对于我的服务器应用程序，我需要检查一个 IP 地址是否在我们的黑名单中。

比较IP地址的最有效方法是什么？将 IP 地址转换为整数并进行比较是否有效？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-10-02T03:31:44.663

取决于您使用的语言，但 IP 地址通常存储为 32 位无符号整数，至少在网络层是这样，因此比较速度非常快。即使不是，除非您正在设计高性能分组交换应用程序，否则它不太可能成为性能瓶颈。避免过早的优化——为可测试性和可扩展性设计你的程序，如果你有性能问题，那么你可以使用分析器来查看瓶颈在哪里。

编辑：澄清一下，IPv4 地址存储为 32 位整数，外加网络掩码（IP 地址比较不需要）。如果您使用较新且目前更稀有的 IPv6，则地址将是 128 位长。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-02T03:33:20.963

32 位整数是要走的路——直到您开始处理 128 位 IPv6 地址。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-02T03:35:56.977

您的意思是您应该将其作为文本字符串进行比较还是将 int 转换为 int 并作为 int 进行比较？

这通常不是这种查找的瓶颈。您可以尝试实现这两种方法，看看哪一种运行得更快。

IP 地址查找的真正问题通常是进行有效的查询，利用您处理 IP 地址而不仅仅是随机数这一事实。为此，您可以查找[LC trie](https://www.drdobbs.com/cpp/fast-ip-routing-with-lc-tries/184410638)。

显然，只有当您的黑名单包含数万或数百万个条目时，您才会对此感兴趣。如果它只有 10-20 个条目，则应该首选线性搜索，实际上更有趣的问题是文本比较与整数比较。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-10-28T14:33:57.210

```
static public bool IsEqual(string ToCompare,
                                      string CompareAgainst)
  {

     return IPAddressToLongBackwards(ToCompare)==IPAddressToLongBackwards(CompareAgainst);
  }

static private uint IPAddressToLongBackwards(string IPAddr)
  {
     System.Net.IPAddress oIP=System.Net.IPAddress.Parse(IPAddr);
     byte[] byteIP=oIP.GetAddressBytes();

     uint ip=(uint)byteIP[0]<<24;
     ip+=(uint)byteIP[1]<<16;
     ip+=(uint)byteIP[2]<<8;
     ip+=(uint)byteIP[3];

     return ip;
  } 
```

如果我理解正确，这是比较两个 IP 地址的代码。你想要这个吗？您可以进一步执行以下操作：

```
static public bool IsGreater(string ToCompare,
                               string CompareAgainst)
  {

     return IPAddressToLongBackwards(ToCompare)>
        IPAddressToLongBackwards(CompareAgainst);
  } 
```

因为你得到了地址字节。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-02T03:32:26.270

是的，我发现要高效，它会很长，当然你必须以整数形式索引列入黑名单的 IP。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-02T03:34:24.330

使用 PeerGuardian 之类的工具，它在驱动程序级别禁止传入 TCP/IP 连接到黑名单上的 IP。高度安全，不需要代码（可以说：高度安全，*因为*不需要代码）。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-10-02T04:28:02.953

我已经完成了这项工作并且我已经对其进行了测试，使用无符号整数（32 位）是最快的 - 我假设您正在将它与字符串表示进行比较。

另一件可能对您有所帮助的事情是在创建表格时，过去我有 2 个列：LowIP 和 HighIP；这样，我就能够通过 1 个记录条目将整个 IP 范围列入黑名单，并且通过检查范围内的 IP 仍然可以获得良好的性能。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-10-02T05:08:43.447

我曾经继承过代码，有人*认为*将 IP 地址存储为 4 个 int 是一件非常好的事情，除了他们把所有时间都花在了与 int 之间的转换上。

将它们作为字符串保存在数据库中要容易得多，而且只需要一个索引。您会惊讶于 sql server 可以索引字符串而不是 4 列整数。但是这个 IP 列表不是用于黑名单的。数据库往返是相当昂贵的。

如果数据库太过分了，请将它们存储在内存中的字典中，但这只是一个猜测，因为我们不知道您需要比较多少。由于大多数哈希码是 32 位整数，而 IPv4 地址是 32 位，因此 IP 地址本身可能只是一个很好的哈希码。

但正如其他人指出的那样，最好的选择可能是减少服务器上的负载并购买专用硬件。也许您将最近列入黑名单的 IP 保存在内存中，并定期将新 IP 发布到路由器。

如果您是试图在路由器中制作一些软件的人，那么您需要找出您的数据结构书并创建类似 b-tree 的东西。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-04-25T10:29:33.130

Radix 或 PATRICIA Trie 是为此的最佳结构。

查看流工具的 C 源代码： [http ://www.splintered.net/sw/flow-tools/](http://www.splintered.net/sw/flow-tools/)

几年前我在这个工作。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-10-02T03:35:51.127

您是否存在效率方面的问题？

如果是这样，那么一定要发布代码（或伪代码），我们可以挑选尸体。

如果不是，那么我建议尝试一些简单的方法，例如将条目存储在排序列表中并使用您环境中现有的`Sort()`和`Find()`.

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-10-02T03:44:48.470

整数比较比字符串比较快得多。

如果将整数存储在排序列表中，则可以比未排序列表更快地找到它们。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-10-02T03:34:44.907

如果您将 IP 地址作为字符串接收，则将其与字符串进行比较可能比将其转换为整数表示更有效

但是我会确定这两种解决方案，如果几毫秒（纳秒！）对这个操作很重要;-)

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2020-04-09T07:20:37.410

以下是我在 JavaScript 中使用过的

```
function isValidIPv4Range(iPv4Range = '') {
  if (IP_V4_RANGE_REGEX.test(iPv4Range)) {
    const [fromIp, toIp] = iPv4Range.split('-');

    if (!isValidOctets(fromIp) || !isValidOctets(toIp)) {
      return false;
    }

    const convertToNumericWeight = ip => {
      const [octet1, octet2, octet3, octet4] = ip.split('.').map(parseInt);

      return octet4 + (octet3 * 256) + (octet2 * 256 * 256) + (octet1 * 256 * 256 * 256);
    };

    return convertToNumericWeight(fromIp) < convertToNumericWeight(toIp);
  }
  return false;
}
```

# visual-studio-2005 - VS2005中拖动控件时鼠标粘滞

> ID：160791
> 
> 赞同：0
> 
> 时间：2008-10-02T03:35:18.650
> 
> 标签：visual-studio-2005

也许这是一个愚蠢的问题，但我在 Visual Studio 2005 中设计表单时有以下行为：

1 - 将一个控件放到表单上（假设它是一个标签，仅供讨论）

2 - 将该标签拖到特定位置（与其他控件对齐，无论如何）

3 - 释放鼠标按钮

4 - 控件仍然卡在鼠标上！！！

为了让它不被鼠标卡住，我必须按 ESC，它将标签恢复到原来的位置。

这让我发疯了。我实际上必须使用箭头键将每个控件逐个像素地移动到位。我在 VS2005 的其他任何地方都没有观察到这种行为，我也没有在一般的操作系统中观察到它。

我在 Parallels 虚拟机内的 Windows XP 上运行，托管在 OS X 上。我不认为存在驱动程序问题，正如我已经说过的 b/c，没有其他应用程序可以展示这样的东西。

请告诉我在某处埋有一些小复选框可以关闭此行为。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-10-02T04:29:11.640

听起来您可能启用了 ClickLock（或类似功能）。试试这个：

转到 Windows 中的控制面板 打开鼠标控制面板 转到“活动”选项卡 取消选择 ClickLock

如果这不起作用，也许您在 OS X 中有类似的功能？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-11T13:32:09.217

这个问题蔓延到我的虚拟机中的其他应用程序，所以我重新安装了 Parallels 工具，它就消失了。

# c++ - 是否有针对不同操作系统检查开源应用程序的构建农场？

> ID：160793
> 
> 赞同：19
> 
> 时间：2008-10-02T03:35:32.453
> 
> 标签：c++, build, operating-system

我有一个开源应用程序，它可以在 Windows、Linux 和 Macintosh 上运行（它使用 C++ 并使用 gcc 构建）。我只在几种不同风格的 Linux 上测试过它，所以我不知道它是否可以在所有不同的 Linux 版本上编译和运行。有没有一个地方可以让我上传我的代码并在一堆不同的系统上进行测试，比如其他 Linux 风格以及 Solaris、FreeBSD 和其他操作系统？

如果我可以让它直接连接到我的 svn 存储库并获取最新的代码，然后通过电子邮件将生成的任何编译错误以及它有问题的操作系统发回给我，那就太好了。

我很高兴知道它可以编译，因为它是一个基于 GUI 的应用程序，所以我不希望它实际运行和测试。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-02T06:42:06.827

有一些选择，但似乎没有很多（任何？）这样的免费服务，考虑到它需要的工作量和资源，这并不奇怪。Sourceforge 曾经像您描述的那样经营一个编译农场，但它在一年左右前关闭了。您可能会查看以下内容。如果您倾向于为服务付费或自己推出服务，那么其中一些链接可能会有用。如果您只是在寻找一个涵盖多个平台的免费开源编译/构建农场，那么您似乎很不走运。

### [OpenSuse 构建服务](http://en.opensuse.org/Build_Service)

[Ted](https://stackoverflow.com/users/954/ted-percival)首先提到，值得重复 - 目前仅适用于 Linux，但确实支持许多发行版。

### [GCC 编译农场](http://gcc.gnu.org/wiki/CompileFarm)

主要专注于测试 GCC 的构建，但也托管了一些其他项目，例如 coLinux、BTG B​​itTorrent 客户端、ClamAV 等。可能是您可以利用的东西，尽管我没有看到编译场中的操作系统（根据页面注释至少包含 Linux 和 Solaris）。

### [构建锁](http://www.projectlocker.com/site/build_locker)

*BuildLocker 是用于 Java 和 .NET 项目的基于 Web 的持续集成解决方案。BuildLocker 是一款虚拟专用构建机器，可帮助团队在开发周期的早期发现错误，从而节省时间和金钱。BuildLocker 管理 ProjectLocker 源代码控制存储库中源代码的计划自动构建。只需签入源代码，计划的构建就会验证代码的完整性。BuildLocker 甚至可以运行自动化测试，并且可以在测试失败时提醒您。*

### [巡航控制](http://cruisecontrol.sourceforge.net/)

*CruiseControl 是一个用于持续构建过程的框架。它包括但不限于电子邮件通知插件、Ant 和各种源代码控制工具。提供了一个 Web 界面来查看当前和以前的构建的详细信息。*

有趣的是，根据播客的说法，CruiseControl 实际上也被 StackOverflow 的开发团队用于自动化构建测试。

### [哈德逊](http://hudson.gotdns.com/wiki/display/HUDSON/Meet+Hudson)

*Hudson 监控重复作业的执行，例如构建软件项目或由 cron 运行的作业。*

### [运行代码运行](http://runcoderun.com/)

在另一个链接问题中提到，仅支持 Ruby 项目并且目前处于私有测试阶段。但是，如果您的项目使用 Ruby，则可能值得关注 RunCodeRun。

### [CI 特征矩阵](http://confluence.public.thoughtworks.org/display/CC/CI+Feature+Matrix)

*有许多可用的持续集成系统。此页面试图对尽可能多的它们进行公正的比较。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-02T05:54:39.390

看看[OpenSuSE 构建服务](http://en.opensuse.org/Build_Service)，它包括相当广泛的 Linux 发行版（不仅仅是 SuSE/OpenSuSE）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-14T13:45:18.733

从软件的角度来看，还有[buildbot](http://buildbot.net/trac)（[sourceforge 项目站点](http://sourceforge.net/projects/buildbot)），可用于设置您自己的构建/持续集成服务器。建议并考虑将其用于 gcc 开发（如上面发布的 gcc compile farm wiki 页面所述）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-03-06T23:33:19.437

如果您打算将您的开源产品商业化，您可以考虑使用我们的 Parabuild。它允许您**[在多个平台和机器上并行运行一组构建](http://www.viewtier.com/products/parabuild/feature_details.htm#parallel_builds)**。仅当所有特定于平台的构建都成功时，构建才会成功。

# assembly - 在没有 Sparc 硬件的情况下运行 Sparc 二进制文件

> ID：160800
> 
> 赞同：11
> 
> 时间：2008-10-02T03:38:05.757
> 
> 标签：assembly, emulation, sparc

在过去的几个月里，我一直很好奇尝试为 SPARC 处理器（V8 或 V9）做一些组装。我的问题是，我无法访问 SPARC 机器，有没有办法可以在我的 x86 机器上运行 SPARC 二进制文件？我看过 QEMU，但我不太确定如何设置它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-02T04:07:57.103

[SimICS](https://www.simics.net/)模拟 Sparc 平台。学术和个人许可证是免费的。

**编辑：**在我最初的回应中，我没有公正地对待 SimICS，它对于基于 Sparc 的开发来说是一个非常有用的工具。您可以在用户空间和内核空间中检测、分析和探索行为或代码。大约 10 年前，当它由瑞典计算机科学研究所 (SICS) 发布时，我第一次意识到它。他们后来将其作为商业产品推出。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-02T03:51:59.887

好的，这里是：

*   qemu 正在模拟用户代码，而不是系统
*   tkisem 以图形方式显示 cpu 内部结构
*   此外，还有一种叫做“ISEM”（Instructional Sparc Emulator）的东西

也许谷歌搜索会帮助您获得详细信息。我的意见 - qemu 已经足够了。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-23T21:16:41.550

顺便说一句，您可以从[Ebay](http://completed.shop.ebay.com/items/?MA2ShowItems&_oexkw=&LH_Complete=1&_nkw=sun+ultra+%285%2C+10%2C+20%2C+30%2C+60%2C+80%2C+1%2C+2%29&_sacat=See-All-Categories&_fpos=&_in_kw=1&_okw=sun+ultra+%285%2C+10%2C+20%2C+30%2C+60%2C+80%2C+1%2C+2%29&LH_SALE_CURRENCY=0&_samilow=&_samihi=&_ex_kw=&_udhi=&_sadis=200&_udlo=&guest=1)以大约 3/4 的价格从 Ebay 购买旧的二手 Sun 工作站。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-02T04:35:36.040

除了完整的系统仿真之外，QEMU 还可以在用户空间级别仿真 SPARC，这样您就可以在 SPARC 汇编中编写程序并使用标准的 Linux 系统调用，它会调用标准的 x86 内核版本……工作得很好！！

如果您不确定是否要专门学习 SPARC 汇编，则可以改用 MIPS。大多数无线路由器都基于 MIPS 处理器并且可以运行 Linux。它类似于 SPARC，具有相似的年份，并且与 SPARC 一起，它是两个原始 RISC 架构之一……在我看来，MIPS 实际上比 SPARC*更*简洁优雅的架构，但它们都是伟大的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-02T03:43:49.923

看起来 QEMU 做了足够的仿真让您在以下位置安装 SPARC Linux：[http ://www.bellard.org/qemu/status.html](http://www.bellard.org/qemu/status.html)

在这种情况下，只需获取一个 SPARC 发行版（例如[Debian](http://www.debian.org/ports/sparc/)），一切就绪！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-02T04:17:48.873

[polarhome](http://www.polarhome.com/)提供了对 Solaris 系统（看起来是 Sun Sparc 系统，而不是 x86）的 shell 访问。它的价格为 10 个当地货币单位（美元、欧元等）或 2 美元，以较大者为准。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-02-11T17:28:05.597

这模拟了 SparcStation 2（sun4c 32 位 SPARCv7）和 Ultra-1（sun4u 64 位 SPARCv9），据我了解，它的联邦性非常高，因为它甚至使用帧缓冲区中的库存转储 rom。

[http://people.csail.mit.edu/fredette/tme/](http://people.csail.mit.edu/fredette/tme/)

至于 v7 v8 和 v9 的区别 Sparc v7 和 v8 是 32bit v9 是 64bit。请注意，QEMU 并不是完全忠实于仿真，它会动态重新编译，因此它可能会更快一些（实际上它很慢），但代价是兼容性可能会降低。用于 v7-v8 的 QEMU 可以引导 Linux 和大多数 BSD 以及实验性的 Solaris。SPARCv9 的 QEMU 是实验性的。

我已经在 Linux 上构建了 TME，但是如果您只安装 NetBSD 并在其中构建它，那么它可能会更好，这样您就可以使用它所具有的网络支持，并且旧的编译器不会对代码有太多抱怨。

我在这里有一个稍微修补过的版本[https://github.com/cb88/tme](https://github.com/cb88/tme)我会很感激帮助处理它大多数补丁来自 NetBSD pkgsrc 但我想我清理了其他一些东西。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-08-14T08:27:52.993

Aeroflex Gaisler 为其 LEON2、LEON3 和 LEON4 处理器提供商业模拟器，这些处理器实际上是 SPARC。LEON3 还有一个有限的评估版本。

见[http://www.gaisler.com/index.php/downloads/simulators](http://www.gaisler.com/index.php/downloads/simulators)

他们为 Windows (MinGW) 和 Linux 提供免费的 GCC 交叉编译器：

[http://www.gaisler.com/index.php/downloads/compilers](http://www.gaisler.com/index.php/downloads/compilers)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-08-23T08:37:01.423

请查看[http://www.stromasys.com](http://www.stromasys.com)，CHARON-SPK 符合您的要求。[http://www.stromasys.ch/virtualization-solutions/virtual-sparcstation/](http://www.stromasys.ch/virtualization-solutions/virtual-sparcstation/)也可以提供帮助。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-04-09T13:50:58.150

请注意，如果您打算在 2.5.1/5.5 之后运行 Solaris，那么 qemu-sparc 将无济于事。不过 NetBSD 和 Linux 应该可以正常运行。

这是因为 qemu-sparc 只支持非常旧的 SPARC 处理器。它会导致 Solaris 安装程序在意识到架构太旧时抛出错误，或者如果您尝试安装 Solaris 8-11，它会在启动之前出现故障/崩溃。

*前面提到了一些成本细节*：如果您想走这条路，可以从 EBay 以大约 400 美元的价格购买能够运行 Solaris 11 的功能齐全的 64 核 SPARC 2U。T5220 将运行 Solaris 11。

我没有使用这里提到的其他模拟器的经验，但也听说过关于 Simics 的好消息，虽然它很贵。

# .net - 定义具有解决方案范围的 .NET 扩展方法

> ID：160813
> 
> 赞同：6
> 
> 时间：2008-10-02T03:44:53.947
> 
> 标签：.net, extension-methods

我有一些我现在经常使用的“帮助”风格的扩展方法*（它们大多非常简单、直观，并且为善而不是邪恶工作，所以请不要让这陷入关于我是否应该使用它们的讨论）。*它们在很大程度上扩展了核心 .NET CLR 类。

目前，我必须将包含我的扩展方法的“ExtensionMethods.cs”文件复制到解决方案中的每个新项目，以便能够在多个项目中使用它们。

是否可以定义一个扩展来处理解决方案中的多个项目，或者将它们包装在一个“扩展”dll中，或者它们是否仅限于项目范围？

**编辑**虽然“专用项目”的答案是完全有效的，但我选择了 marxidad，因为我更喜欢他给出的方法。感谢到目前为止的所有答案，我已经全部升级了，因为它们都是很好的答案

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-02T03:54:15.780

如果您不想仅为扩展方法创建整个项目，则可以将同一文件链接到单独的项目中，而无需复制文件：

1.  在解决方案资源管理器中，选择目标项目。
2.  选择项目菜单。
3.  选择添加现有项目。
4.  在“添加现有项目”对话框中，选择要链接的项目。
5.  从打开按钮下拉列表中，选择添加为链接。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-02T03:47:05.627

最好的方法是将它们全部放在一个项目中并创建一个 DLL。然后，您可以将该项目作为项目引用包含在内，或者将 DLL 作为二进制引用包含在内（可能是更好的选择）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-02T03:47:06.343

您可以将扩展放在一个单独的项目中，并将该项目包含在您正在制作的每个新解决方案中。

请注意版本控制，例如，当其他应用程序尝试对您的扩展项目进行更改时，则应重新测试使用该方法的所有项目。

[Scott Dorman 在他的帖子中也是正确的](https://stackoverflow.com/questions/160813/define-a-net-extension-method-with-solution-scope#160816)：如果您不想更改它们，您可以将它们编译为一个 DLL 库，您可以将其包含在您的新项目中（而不是包含未编译的项目）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-02T03:50:42.730

为 .NET 平台的扩展创建一个项目，并在每个应用程序项目中引用该项目。不言而喻：任何和所有平台的东西，而且只有平台的东西，都在那个项目中；应用程序的东西进入你的应用程序项目。

您还可以查看各种平台库，例如[Umbrella](http://www.codeplex.com/umbrella)，它提供了基础平台的扩展套件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-05T21:38:41.947

几个答案表明有人会将扩展功能放入一个通用程序集中。这是正确的答案。但是对于初学者来说有一件奇怪的事情：IntelliSense 无法提供足够好的帮助。假设我`ObservableCollection`用`ReplaceRange`函数/方法扩展了 。在移动扩展函数的类之后，首先编译器会说 `error CS1061: 'System.Collections.ObjectModel.ObservableCollection<WhateverDto>' does not contain a definition for 'ReplaceRange' and no extension method 'ReplaceRange' accepting a first argument of type 'System.Collections.ObjectModel.ObservableCollection<WhateverDto>' could be found (are you missing a using directive or an assembly reference?)` 如果您将鼠标悬停在有问题的`ReplaceRange`调用上，您将不会自动获得包含正确 using 语句的提议。那时有人可能会认为他/她做错了什么。然而，什么都不是，您只需要知道您的扩展方法在哪里，并且您必须手动键入方法名称空间的 using 语句。在你做对之后，你的源代码将被编译。

# .net - 如何在 Windows 工作流中的活动之间传递数据？

> ID：160824
> 
> 赞同：2
> 
> 时间：2008-10-02T03:51:02.667
> 
> 标签：.net, data-binding, workflow, workflow-foundation, workflow-activity

我不完全确定我理解做事的工作流程方式，但如果它是一个管道 n 过滤器样式模型，我应该能够将数据（甚至字符串）从一个活动传递到另一个活动。

有谁知道如何做到这一点？视频加分！

我希望这是可能的。如果WF与我的想法相同，那将非常有用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-02T10:18:19.880

### 方法 1（设计和运行时）：活动数据绑定

您可以将一个活动的依赖属性绑定到另一个活动的属性。看

*   [Windows Workflow Foundation 中的活动绑定](http://www.developer.com/net/net/article.php/3656966)。
*   [启用活动数据绑定](http://www.devx.com/codemag/Article/36317/0/page/6)

### 方法 2（运行时）：从活动树中查找活动

看

*   [Workflows 中文章ActivityExecutionContext 的](http://msdn.microsoft.com/en-us/magazine/cc163414.aspx)“工作流开发”段落。
*   [绑定到代码活动中的活动依赖属性](http://forums.microsoft.com/msdn/ShowPost.aspx?PostID=3880975&SiteID=1)

# python - zc.buildout 和/或 virtualenv 是否有其他好的替代方法来安装非 python 依赖项？

> ID：160834
> 
> 赞同：7
> 
> 时间：2008-10-02T03:55:22.173
> 
> 标签：python, deployment, build-process

我是一个团队的成员，该团队即将推出一个基于 python（特别是 Django）的网站和配套的后端工具套件的 beta 版。在过去的几周里，团队本身的规模从 2 倍增加到 4 倍，我们预计至少在接下来的几个月里会继续增长。开始困扰我们的一个问题是让每个人都加快速度，以配置他们的开发环境并安装所有正确的鸡蛋等。

我正在寻找简化此过程并使其不易出错的方法。zc.buildout 和 virtualenv 看起来都是解决这个问题的好工具，但似乎都主要集中在 python 特定的问题上。我们有几个其他语言的小子项目（特别是 Java 和 Ruby）以及许多必须本地编译的 python 扩展（lxml、MySQL 驱动程序等）。事实上，我们这边最大的难题之一就是让其中一些扩展针对共享库的适当版本进行编译，以避免段错误、malloc 错误和各种类似问题。在 4 个人中，我们有 4 个不同的开发环境——1 leopard on ppc，1 leopard on intel，1 ubuntu 和 1 windows，这并没有帮助。

最终，从 dos/unix 提示符下，理想的工作方式大致如下：

$ git clone [repository url] ... $ python setup-env.py ...

然后做 zc.buildout/virtualenv 所做的事情（复制/符号链接 python 解释器，提供一个干净的空间来安装鸡蛋）然后安装所有必需的鸡蛋，包括安装任何本机共享库依赖项，安装 ruby​​ 项目、java 项目等.

显然，这对于建立开发环境以及在登台/生产服务器上部署都是有用的。

理想情况下，我希望完成此任务的工具可以通过 python 编写/扩展，因为那是（并且永远是）我们团队的通用语言，但我对其他语言的解决方案持开放态度。

因此，我的问题是：是否有人对更好的替代方案有任何建议，或者他们可以使用其中一种解决方案来分享更大/更广泛的安装基础的经验？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-09T00:41:06.493

Setuptools 可能比您意识到的更能满足您的需求——例如，如果您需要一个自定义版本的 lxml 才能在 MacOS X 上正常工作，您可以在 setup.py 中放置一个指向适当 egg 的 URL并根据需要让 setuptools 下载并安装在开发人员的环境中；它还可以被告知从版本控制下载和安装特定版本的依赖项。

也就是说，我倾向于使用脚本生成的虚拟环境。构建一个 kickstart 文件非常简单，该文件安装您依赖的任何软件包，然后针对它启动虚拟机（或生产硬件！），使用 puppet 或类似软件进行其他管理（添加用户，设置服务 [你的数据库来自哪里？]， ETC）。当您的生产环境包含多台机器时，这特别方便——只需在其方便的小沙盒子网中编写多个 VM 的生成脚本（我为此使用 libvirt+kvm；而 kvm 并非在您拥有开发人员工作的所有平台上都可用上，qemu 肯定是，或者你可以像我一样做，并拥有由多个开发人员共享的少量强大的 VM 主机）。

这让您摆脱了支持 N 个平台的麻烦——您只需要支持一个虚拟平台——并且意味着您的部署过程（由 kickstart 文件和用于设置的 puppet 代码定义）是源代码控制和运行的就像其他所有事情一样，通过您的 QA 和审查流程。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-10-30T22:31:38.570

`develop.py`我总是在项目的顶层创建一个文件，并且还有一个`packages`目录，其中`.tar.gz`包含我要安装的 PyPI 中的所有文件，还包括一个`virtualenv`可以直接从该文件运行的解压缩副本。所有这些都进入版本控制。每个开发人员都可以简单地检查主干，运行`develop.py`，并且片刻之后将有一个可以使用的虚拟环境，其中包括我们所有的依赖项，与其他开发人员正在使用的版本完全相同。即使 PyPI 出现故障，它也可以工作，这在该服务的历史上非常有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-07T20:06:39.810

Puppet 也不（容易）支持 Win32 世界。如果您正在寻找一种部署机制而不仅仅是“开发设置”工具，您可以考虑查看具有开源跨平台解决方案的ControlTier ( [http://open.controltier.com/ )。](http://open.controltier.com/)

除此之外，您正在查看诸如 BladeLogic 或 OpsWare 之类的“企业”软件，并且通常为所提供的功能定价高得离谱（我认为，显然）。

很多人一直在积极地使用 Puppet 和 Capistrano 的组合（甚至是非 Rails 开发人员）来部署自动化工具，效果非常好。不利的一面是，它期待一个有点同质的环境。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-07T03:13:09.497

您可能会考虑使用您正在运行的任何生产操作系统以及预先构建的所有软件依赖项来创建虚拟机设备。代码可以远程编辑，也可以使用共享文件夹进行编辑。在过去的开发环境相当复杂的生活中，它对我来说非常有效。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-02T04:21:44.090

基本上，您正在寻找一个**跨平台的软件/软件包安装程序**（在 apt-get/yum/etc 的行中）。我不确定是否存在这样的东西？

另一种方法可能是指定需要通过特定于操作系统的包管理系统（例如 Mac OS X 的 Fink 或 DarwinPorts）安装的包列表，并拥有一个为内部代码设置构建环境的脚本？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-02T05:12:05.313

自从我发布问题以来，我一直在研究这个问题。看起来有一些尝试来解决我概述的一些需求，例如[Minitage](http://www.minitage.org/doc/rst/about.html)和[Puppet](http://reductivelabs.com/projects/puppet/)，它们采用不同的方法，但两者都可以实现我想要的——尽管 Minitage 没有明确声明它支持 Windows。由于缺乏更好的选择，我会尝试使用其中之一，或者只是广泛定制使用 zc.buildout 来满足我们的需求，但我仍然觉得肯定有更好的选择。

# c# - .NET 乘法优化

> ID：160848
> 
> 赞同：7
> 
> 时间：2008-10-02T04:06:23.783
> 
> 标签：c#, .net, optimization, compiler-construction, multiplication

编译器是否优化了任何乘以 1 的乘法？也就是说，考虑：

```
int a = 1;
int b = 5 * a; 
```

表达式 5 * a 会被优化成 5 吗？如果不是，如果a被定义为：

```
const int a = 1; 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-02T04:07:41.113

它会在编译时预先计算任何常量表达式，包括字符串连接。没有**`const`**它，它将被单独留下。

您的第一个示例编译为此 IL：

```
.maxstack 2
.locals init ([0] int32, [1] int32)

ldc.i4.1   //load 1
stloc.0    //store in 1st local variable
ldc.i4.5   //load 5
ldloc.0    //load 1st variable
mul        // 1 * 5
stloc.1    // store in 2nd local variable 
```

第二个示例编译为：

```
.maxstack 1
.locals init ( [0] int32 )

ldc.i4.5 //load 5 
stloc.0  //store in local variable 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-02T04:09:08.677

恒定传播是最常见和最简单的优化之一。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-02T04:35:30.720

查看单声道编译器生成的代码，带有非常量 a 的版本在运行时执行乘法运算。也就是说，乘法没有被优化。如果你做一个 const，那么乘法就会被优化。

Microsoft 编译器可能有更激进的编译器，最好的解决方案是查看编译器生成的代码，看看它在做什么。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-02T04:17:48.687

编译器在这里优化的不是乘以 1 本身，而是在编译时使用已知值的算术运算。所以是的，编译器会优化您示例中的所有数学运算，无论是否使用`const`.

**编辑：**我应该说，一个*称职的编译器。*

# python - 什么是 Python 中的“lambda 绑定”？

> ID：160859
> 
> 赞同：11
> 
> 时间：2008-10-02T04:14:01.100
> 
> 标签：python, binding, lambda

我了解 Python 中的 lambda 函数是什么，但我无法通过搜索 Python 文档找到“lambda 绑定”的含义。一个阅读它的链接会很棒。一个简单的解释示例会更好。谢谢你。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-02T04:38:59.680

首先，一般定义：

> 当执行程序或函数语句时，形式参数的当前值被保存（在堆栈上），并且在语句的范围内，它们被绑定到调用中实际参数的值。当语句退出时，这些形式参数的原始值被恢复。该协议是完全递归的。如果在语句的主体中，做了一些导致形式参数再次绑定到新值的操作，则 lambda 绑定方案保证这一切都会以有序的方式发生。

现在，这里[的讨论中有一个出色的 python 示例](http://markmail.org/message/fypalne4rp5curta "关于 Lambda 的理论问题")：

“......只有一个绑定`x`：做`x = 7`只是改变预先存在的绑定中的值。这就是为什么

```
def foo(x): 
   a = lambda: x 
   x = 7 
   b = lambda: x 
   return a,b 
```

返回两个都返回 7 的函数；如果在 之后有新的绑定`x = 7`，则函数将返回不同的值[当然，假设您不调用 foo(7)。还假设nested_scopes]...."

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-02T04:52:54.717

我从未听说过这个术语，但一种解释可能是用于直接为 lambda 参数分配值的“默认参数”hack。使用斯瓦蒂的例子：

```
def foo(x): 
    a = lambda x=x: x 
    x = 7 
    b = lambda: x 
    return a,b

aa, bb = foo(4)
aa() # Prints 4
bb() # Prints 7 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-02T04:30:36.800

你在哪里看到使用的短语？

Python中的“绑定”通常是指变量名最终指向特定对象的过程，无论是通过赋值还是参数传递或其他方式，例如：

```
a = dict(foo="bar", zip="zap", zig="zag") # binds a to a newly-created dict object
b = a # binds b to that same dictionary

def crunch(param):
  print param

crunch(a) # binds the parameter "param" in the function crunch to that same dict again 
```

所以我猜想“lambda 绑定”是指将 lambda 函数绑定到变量名的过程，或者可能将其命名参数绑定到特定对象？[在http://docs.python.org/ref/naming.html](http://docs.python.org/ref/naming.html)的语言参考中有一个很好的绑定解释

# image-processing - 用于创建 PNG 8 位透明图像的软件

> ID：160874
> 
> 赞同：6
> 
> 时间：2008-10-02T04:24:44.740
> 
> 标签：image-processing, compression, png, transparency

我正在寻找根据[本文](http://www.sitepoint.com/blogs/2007/09/18/png8-the-clear-winner/)创建 PNG8 格式透明图像的软件。

**注意：**我自己需要一个 Linux 解决方案，但请提交其他操作系统的答案。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-02T04:34:02.563

[pngquant](http://pngquant.org)在转换为 PNG8 方面做得很好，同时保持了完全透明。

如果您在意大小，您可能还对[pngcrush](http://pmt.sourceforge.net/pngcrush/)感兴趣，它通常可以（无损）压缩很多 PNG 文件。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-07-17T15:14:56.417

我还需要一个 Linux 解决方案，发现[pngnq](http://pngnq.sourceforge.net/)做得很好。它似乎是专门为创建带有 alpha 通道的 8 位 PNG 图像而设计的。

```
apt-get install pngnq # If on Ubuntu/Debian 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-23T11:50:37.013

啊，如果我没记错的话，几个月前我读到这篇文章时，pngquant 还没有 Windows 版本。我看到它现在有一个。所以我试过了，pngnq也试过了。

后者似乎在 IceAlpha.png 测试图像（来自 libpng.org）上做得更好，但代价是图像稍大（无论如何都可以使用 pngcrush 或 pngout 对其进行后处理）。

抖动算法（pngquant 的两个，pngnq 的唯一一个）是不同的，可能值得同时使用这两种工具，用所有算法转换图像，看看哪个看起来最好。

作为记录，在 Windows 端，IrfanView (4.10) 很好地显示了这些图像（使用每个调色板条目上的透明度级别），而 XnView (1.85.1) 和 GIMP (2.4) 仅应用完全透明/不透明显示，à la GIF：链接文章中作为示例给出的灯泡周围有透明背景，但橙色部分完全不透明。

优秀的实用程序 TweakPNG 显示我们有一个 PLTE（调色板，222 个条目）块和一个 tRNS（调色板颜色的 alpha 值，222 个条目）块。更重要的是，它允许编辑每个调色板条目、颜色和 alpha 级别。对于这种格式，它可能是一个有趣的补充工具。

关于 IrfanView 支持的注意事项：如果它正确处理 PNG8 以获得透明度，它不会处理 PNG 文件中的伽马信息：在巨嘴鸟图像或乒乓球图像上，我必须应用 2.4 的伽马以获得相似（更浅）的颜色.

另请注意，IrfanView 在将 32 位 PNG 图像转换为 256 时做得很糟糕，只允许一种透明颜色，如果全色抖动，这看起来很糟糕！

我看到[GIMP 手册](http://docs.gimp.org/en/gimp-images-out.html "第 6 章 从 GIMP 中获取图像")指出：“*他的“PNG8”格式，如 GIF，只使用一位来表示透明度；只有两种透明度级别是可能的，透明或不透明。* ”而[ISO/W3C 标准](http://www.mirrorservice.org/sites/www.libpng.org/pub/png/spec/iso/index-object.html#11tRNS "11.3.2.1 tRNS 透明度")规定：“ *tRNS 块指定与调色板条目相关联的 alpha 值（用于索引彩色图像）或单一透明颜色（用于灰度和真彩色图像）。* "。[PNG 规范 1.2](http://www.libpng.org/pub/png/spec/1.2/PNG-Chunks.html "PNG 规范：块规范")补充说：“虽然简单的*透明度不如完整的 alpha 通道优雅，但它需要的存储空间更少，对于许多常见情况来说已经足够了。*" 看起来，独特的透明颜色比全透明调色板更实用，唉。至少浏览器做对了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-02T04:30:32.073

您提供的链接引用了 ImageMagick，它是用于在 Linux 上处理图像的出色工具包。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-04T22:28:27.567

这取决于您的原始图像到底是什么样的。

如果您的图像*已经*包含 256 种或更少的颜色（RGBA 值），您只需要查看 pngout [(Windows)](http://advsys.net/ken/utils.htm) [(Linux/BSD/Mac OS X 端口)](http://www.jonof.id.au/index.php?p=pngout)，无论如何您都应该使用它来优化您的 PNG 图像。它不能量化图像，但可以将它们保存为 8 位，包括 alpha 透明度。只需传入[`/c3`](http://advsys.net/ken/util/pngout.htm)（或`-c3`在 Linux 等上）颜色选项以强制它将图像保存为 PNG8。

如果您的图像确实包含超过 256 种颜色，那么您还有更多，但都不是完美的选择：

*   [就最终图像质量而言， Adobe Fireworks](http://www.adobe.com/products/fireworks/)可能是最佳选择。如果您只需要转换几张图像，或者您不介意依靠 Fireworks 进行批处理，它就可以完成这项工作。我确实发现它有时会以某种方式限制调色板中的颜色数量，从而创建比所需质量更差的图像。我不知道这是否可能是 CS4 中修复的 CS3 中的错误。

    如果您不在 Windows 或 OS X 上，这显然不是一个选择，并且为此购买 Fireworks 可能也不值得。

*   我知道的唯一选择是已经提到的[pngquant](http://www.libpng.org/pub/png/apps/pngquant.html)和[pngnq](http://pngnq.sourceforge.net/)。我对 pngnq 的运气更好，但这可能只是取决于哪种量化策略最适合您正在使用的文件。

    不幸的是，我注意到它们都不适用于少量透明度（例如，具有透明圆角的不透明图像）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-11-06T15:57:23.400

对于 Mac：ImageOptim 和 ImageAlpha 是运行 pngcrush、pngquant 和各种其他通常命令行压缩实用程序的 GUI。 [http://pngmini.com/](http://pngmini.com/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-02T04:30:08.063

我推荐“The GIMP”，因为它[可以在 PNG8 中输出](http://docs.gimp.org/en/gimp-images-out.html)并支持 Linux/Windows。如果您想要一个快速的仅限 Windows 的解决方案，我还推荐[IrfanView](http://www.irfanview.com/)。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-20T01:28:18.540

Microsoft Windows：Ultimate Paint（提供免费软件和共享软件版本）。

两个版本都可以保存为 8 位透明 PNG 图像。

它还可以保存为 4 位 PNG（16 色）。与 8 位相比，这将文件大小减少了一半。

输入格式包括 BMP、GIF、ICO、JPG/JPEG 和 PNG。

Ultimate Paint Standard 2.88 LE 的免费软件版本可以直接从 [http://www.ultimatepaint.com/up.zip](http://www.ultimatepaint.com/up.zip) (1.7 MB) 下载。

# linux - Perl 套接字如何在 Linux 下解析主机名？

> ID：160876
> 
> 赞同：3
> 
> 时间：2008-10-02T04:25:29.650
> 
> 标签：linux, perl, sockets, dns

我有一个（据我所知）完美运行的 Linux 设置（Ubuntu 8.04），其中所有工具（nslookup、curl、wget、firefox 等）都能够解析地址。然而，以下代码失败：

```
$s = new IO::Socket::INET(
    PeerAddr => 'stackoverflow.com',
    PeerPort => 80,
    Proto => 'tcp',
);

die "Error: $!\n" unless $s; 
```

我验证了以下几点：

*   Perl 能够使用 gethostbyname 解析地址（即下面的代码有效）：

    `my $ret = gethostbyname('stackoverflow.com'); print inet_ntoa($ret);`

*   原始源代码在Windows下工作

*   这就是它应该如何工作（即它应该解析主机名），因为 LWP 试图使用这种行为（事实上，我通过尝试调试为什么 LWP 不为我工作而偶然发现了这个问题）
*   运行脚本不会发出 DNS 请求（因此它甚至不会尝试解析名称）。通过 Wireshark 验证

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-02T05:11:35.577

快速浏览一下，来自 IO::Socket::INET 的以下代码

```
sub _get_addr {
    my($sock,$addr_str, $multi) = @_;
    my @addr;
    if ($multi && $addr_str !~ /^\d+(?:\.\d+){3}$/) {
        (undef, undef, undef, undef, @addr) = gethostbyname($addr_str);
    } else {
        my $h = inet_aton($addr_str);
        push(@addr, $h) if defined $h;
    }
    @addr;
} 
```

建议（如果您查看此代码的调用者）添加`MultiHomed => 1,`到您的代码的解决方法。

如果没有这种解决方法，上面的代码似乎会尝试`inet_aton("hostname.com")`使用来自 Socket.pm 的 inet_aton() 进行调用。这在 Win32 和 Unix 中都适用于我，所以我想这就是你的问题所在。

[inet_aton](http://search.cpan.org/src/TOMC/Socket-1.5/Socket.xs)的源代码见Socket.xs：

```
void
inet_aton(host)
    char *  host
    CODE:
    {
        struct in_addr ip_address;
        struct hostent * phe;

        if (phe = gethostbyname(host)) {
            Copy( phe->h_addr, &ip_address, phe->h_length, char );
        } else {
            ip_address.s_addr = inet_addr(host);
        }

        ST(0) = sv_newmortal();
        if(ip_address.s_addr != INADDR_NONE) {
            sv_setpvn( ST(0), (char *)&ip_address, sizeof ip_address );
        }
    } 
```

看来 Perl gethostbyname() 比 C gethostbyname() 更适合您。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-06T16:36:59.297

您能否准确地告诉我们您的代码是**如何**失败的？您那里有错误检查代码，但您还没有报告错误是什么！

我刚刚尝试了原始代码（在我的 Mac OS X 机器上添加了“使用 IO::Socket::INET”，它工作正常。

我怀疑 Multihomed 选项是不必要的黑客攻击，而其他一些问题是您问题的根本原因。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-10-02T04:44:17.530

确保你有声明

```
use IO::Socket::INET; 
```

在源代码的开头。如果您忽略它，您可能会收到错误消息：

> 无法通过包“IO::Socket::INET”定位对象方法“new”

除此之外，您还可以使用 Net::DNS::Resoler 验证 DNS 是否正常工作，请[在此处](http://search.cpan.org/~olaf/Net-DNS-0.63/lib/Net/DNS/Resolver.pm)查看更多信息。

```
use Net::DNS;

my $res = Net::DNS::Resolver->new;

# Perform a lookup, using the searchlist if appropriate.
my $answer = $res->search('example.com'); 
```

# vb6 - VB6 与 MSBuild 的集成

> ID：160881
> 
> 赞同：6
> 
> 时间：2008-10-02T04:29:59.907
> 
> 标签：vb6, tfs, msbuild, build-automation

因此，对于必须在 Team Build/MSBuild 环境（特别是 Visual Basic 6 应用程序/项目）中集成遗留项目/代码的构建/编译的任何人来说，这是一个问题。

*除了*编写自定义构建任务（我不反对）之外，是否有人对如何最好地将遗留 VB6 项目的编译和版本控制集成到 MSBuild 构建中有任何建议？

我知道[CodePlex](http://www.codeplex.com/freetodevtasks)的 FreeToDev msbuild 任务，但它们目前已被撤回。

理想情况下，我正在寻找版本和编译代码以及捕获 msbuild 日志的编译输出（尤其是错误）。

我已经看到有关将此功能封装在自定义任务中的建议，但真的想知道是否有人尝试过另一种解决方案（除了执行 shell 命令）-本质上，是否有人有“更清洁”的解决方案？

理想情况下，使用执行命令将是最后的手段。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-02T06:32:54.667

我每天都在使用[Nant](http://nant.sourceforge.net/)构建 VB6 项目。这确实使用 Nant 执行命令进行构建（我们构建 4 个项目作为一个“解决方案”的一部分）。

它还允许您在源代码控制存储库中标记版本，获取最新代码，签入，签出，所有正常要求，编译更新/设置程序，将文件复制到所需位置并发送结果电子邮件。

记录的结果相当少，因为您只能获得 VB6 命令行编译提供的输出。

对于版本控制，我必须编写一个小应用程序来提取我编译的可执行文件的版本号并将其写入 Nant 然后可以读取和使用的文本文件（用于标签、文件名等。（有点痛苦，但 VB 生成版本号无论如何都不符合）。

有关其他非核心任务的帮助，请参阅上面的 NAnt 链接中的 NAntContrib。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-03T23:07:05.313

VB6 任务将于周一返回。关于版本控制，包中没有明确的 vb 版本控制任务，但是您可以使用 TfsVersion (TaskAction="GetVersion") 和 File (TaskAction="Replace") 任务。如果您认为创建一个新任务来封装/提供其他功能是有价值的，那么请告诉我，我会将它添加到包中，以造福整个社区。

为退出道歉，但到了星期一，我相信所有人都会理解的。

# python - 在 Perl 或 Python 中模拟类似 lex 的功能

> ID：160889
> 
> 赞同：4
> 
> 时间：2008-10-02T04:34:06.213
> 
> 标签：python, perl, parsing, lex

这是交易。有没有办法根据多个正则表达式在一行中对字符串进行标记？

一个例子：

我必须根据不同的正则表达式获取所有 href 标记、它们对应的文本和其他一些文本。所以我有 3 个表达式，并且想对行进行标记并提取与每个表达式匹配的文本标记。

我实际上是使用 flex 完成的（不要与 Adob​​e 混淆），它是旧 lex 的一个实现。lex 通过基于表达式执行“动作”提供了一种优雅的方式来做到这一点。也可以控制 lex 读取文件的方式（基于块/行的读取）。

问题是 flex 实际上生成了实际执行标记化工作的 C/C++ 代码。我有一个包含所有这些东西的 make 文件。我想知道 perl /python 是否可以以某种方式做同样的事情。只是我想用一种编程语言本身做我喜欢的一切。

标记化只是我想要在我的应用程序中做的事情之一。

除了 perl 或 python 之外，任何语言（也可以是函数式）都可以做到这一点吗？

我确实在这里阅读了 PLY 和 ANTLR（[解析，我在哪里可以了解它](https://stackoverflow.com/questions/34081/parsing-where-can-i-learn-about-it#34085)）。

但是有没有办法在 python 本身中自然地做到这一点？请原谅我的无知，但这些工具是否用于任何流行的产品/服务？

谢谢你。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-02T04:53:03.830

[在CPAN](http://www.cpan.org/)上查看以下模块的文档

[HTML::TreeBuilder](http://search.cpan.org/search?query=HTML%3A%3ATreeBuilder&mode=all)

[HTML::表格提取](http://search.cpan.org/author/MSISK/HTML-TableExtract-2.10/lib/HTML/TableExtract.pm)

和

[Parse::RecDescent](http://search.cpan.org/search?query=parse+recdescent&mode=all)

我已经使用这些模块来处理相当大和复杂的网页。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-02T06:52:06.337

如果您专门从网页中解析链接，那么 Perl 的[WWW::Mechanize](http://search.cpan.org/perldoc?WWW::Mechanize)模块将以一种非常优雅的方式为您解决问题。这是一个示例程序，它抓取 Stack Overflow 的第一页并解析所有链接，打印它们的文本和相应的 URL：

```
#!/usr/bin/perl
use strict;
use warnings;
use WWW::Mechanize;

my $mech = WWW::Mechanize->new;

$mech->get("http://stackoverflow.com/");

$mech->success or die "Oh no! Couldn't fetch stackoverflow.com";

foreach my $link ($mech->links) {
    print "* [",$link->text, "] points to ", $link->url, "\n";
} 
```

在主循环中，每个`$link`都是[WWW::Mechanize::Link](http://search.cpan.org/perldoc?WWW::Mechanize::Link)对象，因此您不仅限于获取文本和 URL。

祝一切顺利，

保罗

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-02T04:38:26.860

听起来您真的只是想解析 HTML，我建议您查看任何出色的软件包：

*   [美丽汤](http://crummy.com/software/BeautifulSoup)
*   [lxml.html](http://codespeak.net/lxml/lxmlhtml.html)
*   [html5lib](http://code.google.com/p/html5lib/)

或者！您可以使用类似以下之一的解析器：

*   [PyParsing](http://pyparsing.wikispaces.com)
*   [DParser](http://dparser.sourceforge.net/) - 具有良好 python 绑定的 GLR 解析器。
*   [ANTLR](http://www.antlr.org) - 可以生成 python 代码的递归体面解析器生成器。

此示例来自 BeautifulSoup[文档](http://www.crummy.com/software/BeautifulSoup/documentation.html)：

```
from BeautifulSoup import BeautifulSoup, SoupStrainer
import re

links = SoupStrainer('a')
[tag for tag in BeautifulSoup(doc, parseOnlyThese=links)]
# [<a href="http://www.bob.com/">success</a>, 
#  <a href="http://www.bob.com/plasma">experiments</a>, 
#  <a href="http://www.boogabooga.net/">BoogaBooga</a>]

linksToBob = SoupStrainer('a', href=re.compile('bob.com/'))
[tag for tag in BeautifulSoup(doc, parseOnlyThese=linksToBob)]
# [<a href="http://www.bob.com/">success</a>, 
#  <a href="http://www.bob.com/plasma">experiments</a>] 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-02T04:37:53.037

你看过[PyParsing](http://pyparsing.wikispaces.com/)吗？

从他们的主页：

这是一个解析“Hello, World!”的程序。（或任何形式的问候“，！”）：

```
from pyparsing import Word, alphas
greet = Word( alphas ) + "," + Word( alphas ) + "!" # <-- grammar defined here
hello = "Hello, World!"
print hello, "->", greet.parseString( hello ) 
```

该程序输出以下内容：

```
Hello, World! -> ['Hello', ',', 'World', '!'] 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-02T08:37:58.593

如果您的问题与网络抓取有任何关系，我建议您查看[Web::Scraper](http://search.cpan.org/perldoc?Web::Scraper)，它通过 XPath 和 CSS 选择器提供了简单的元素选择。我[在 Web::Scraper 上有一个（德语）演讲](http://datenzoo.de/pub/gpw2008/web-scraper/web-scraper-talk.html)，但是如果你通过 babelfish 运行它或者只是查看代码示例，这可以帮助你快速了解语法。

手动解析 HTML 是繁重的，并且不会让您过度使用预制的 HTML 解析器之一。如果你的 HTML 的变化非常有限，你可以通过使用聪明的正则表达式来解决，但如果你已经在使用核心解析器工具，听起来你的 HTML 比正常解析的要规则得多常用表达。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-02T12:19:37.373

还可以查看[pQuery](http://search.cpan.org/dist/pQuery/)它是一种非常好的 Perlish 方式来做这种事情......

```
use pQuery;

pQuery( 'http://www.perl.com' )->find( 'a' )->each( 
    sub {
        my $pQ = pQuery( $_ ); 
        say $pQ->text, ' -> ', $pQ->toHtml;
    }
);

# prints all HTML anchors on www.perl.com
# =>  link text -> anchor HTML 
```

但是，如果您的要求超出了 HTML/Web，那么这里是较早的“Hello World！” [Parse::RecDescent](http://search.cpan.org/dist/Parse-RecDescent/lib/Parse/RecDescent.pm)中的示例...

```
use strict;
use warnings;
use Parse::RecDescent;

my $grammar = q{
    alpha : /\w+/
    sep   : /,|\s/
    end   : '!'
    greet : alpha sep alpha end { shift @item; return \@item }
};

my $parse = Parse::RecDescent->new( $grammar );
my $hello = "Hello, World!";
print "$hello -> @{ $parse->greet( $hello ) }";

# => Hello, World! -> Hello , World ! 
```

可能用大锤子敲碎这个坚果太多了；-)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-02T13:36:36.533

从 [perlop](http://perldoc.perl.org/perlop.html#Regexp-Quote-Like-Operators)：

> 类似 lex 的扫描仪的一个有用的习惯用法是`/\G.../gc`. 您可以像这样组合几个正则表达式来逐部分处理字符串，根据匹配的正则表达式执行不同的操作。每个正则表达式都尝试匹配前一个正则表达式离开的位置。
> 
> ```
>  LOOP:
>     {
>       print(" digits"),       redo LOOP if /\G\d+\b[,.;]?\s*/gc;
>       print(" lowercase"),    redo LOOP if /\G[a-z]+\b[,.;]?\s*/gc;
>       print(" UPPERCASE"),    redo LOOP if /\G[A-Z]+\b[,.;]?\s*/gc;
>       print(" Capitalized"),  redo LOOP if /\G[A-Z][a-z]+\b[,.;]?\s*/gc;
>       print(" MiXeD"),        redo LOOP if /\G[A-Za-z]+\b[,.;]?\s*/gc;
>       print(" alphanumeric"), redo LOOP if /\G[A-Za-z0-9]+\b[,.;]?\s*/gc;
>       print(" line-noise"),   redo LOOP if /\G[^A-Za-z0-9]+/gc;
>       print ". That's all!\n";
>     } 
> ```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-05T18:07:23.407

修改 Bruno 的示例以包括错误检查：

```
my $input = "...";
while (1) {
    if ($input =~ /\G(\w+)/gc) { print "word: '$1'\n"; next }
    if ($input =~ /\G(\s+)/gc) { print "whitespace: '$1'\n"; next }

    if ($input !~ /\G\z/gc)  { print "tokenizing error at character " . pos($input) . "\n" }
    print "done!\n"; last;
} 
```

（请注意，不幸的是，使用标量 //g 是您确实无法避免使用 $1 等变量的地方。）

# objective-c - 在 Objective-C 中生成随机数

> ID：160890
> 
> 赞同：752
> 
> 时间：2008-10-02T04:35:21.967
> 
> 标签：objective-c, random

我主要是Java头，我想要一种方法来生成0到74之间的伪随机数。在Java中我会使用该方法：

```
Random.nextInt(74) 
```

我对关于种子或真正随机性的讨论不感兴趣，只是你如何在 Objective-C 中完成相同的任务。我搜索了谷歌，似乎有很多不同且相互矛盾的信息。

* * *

## 回答 #1

> 赞同：1036
> 
> 时间：2008-10-02T16:00:17.797

您应该使用该`arc4random_uniform()`功能。它使用高级算法来`rand`. 你甚至不需要设置种子。

```
#include <stdlib.h>
// ...
// ...
int r = arc4random_uniform(74); 
```

`arc4random`手册页：

> ```
> NAME
>      arc4random, arc4random_stir, arc4random_addrandom -- arc4 random number generator
> 
> LIBRARY
>      Standard C Library (libc, -lc)
> 
> SYNOPSIS
>      #include <stdlib.h>
> 
>      u_int32_t
>      arc4random(void);
> 
>      void
>      arc4random_stir(void);
> 
>      void
>      arc4random_addrandom(unsigned char *dat, int datlen);
> 
> DESCRIPTION
>      The arc4random() function uses the key stream generator employed by the arc4 cipher, which uses 8*8 8
>      bit S-Boxes.  The S-Boxes can be in about (2**1700) states.  The arc4random() function returns pseudo-
>      random numbers in the range of 0 to (2**32)-1, and therefore has twice the range of rand(3) and
>      random(3).
> 
>      The arc4random_stir() function reads data from /dev/urandom and uses it to permute the S-Boxes via
>      arc4random_addrandom().
> 
>      There is no need to call arc4random_stir() before using arc4random(), since arc4random() automatically
>      initializes itself.
> 
> EXAMPLES
>      The following produces a drop-in replacement for the traditional rand() and random() functions using
>      arc4random():
> 
>            #define foo4random() (arc4random() % ((unsigned)RAND_MAX + 1)) 
> ```

* * *

## 回答 #2

> 赞同：429
> 
> 时间：2011-08-16T17:47:17.357

使用该`arc4random_uniform(upper_bound)`函数生成一个范围内的随机数。下面将生成一个介于 0 和 73 之间的数字。

```
arc4random_uniform(74) 
```

`arc4random_uniform(upper_bound)`避免了手册页中描述的[模偏差：](https://stackoverflow.com/a/10984975/85950)

> arc4random_uniform() 将返回一个小于upper_bound 的均匀分布的随机数。建议使用 arc4random_uniform() 而非 ``arc4random() % upper_bound'' 之类的结构，因为当上限不是 2 的幂时，它可以避免“[模偏差”。](https://stackoverflow.com/a/10984975/85950)

* * *

## 回答 #3

> 赞同：64
> 
> 时间：2008-10-02T04:45:44.657

和C一样，你会做

```
#include <time.h>
#include <stdlib.h>
...
srand(time(NULL));
int r = rand() % 74; 
```

（假设您的意思是包括 0 但不包括 74，这就是您的 Java 示例所做的）

**编辑：**随意替换`random()`或`arc4random()`代替`rand()`（正如其他人指出的那样，这很糟糕）。

* * *

## 回答 #4

> 赞同：51
> 
> 时间：2013-06-19T14:08:26.803

我想我可以添加一种我在许多项目中使用的方法。

```
- (NSInteger)randomValueBetween:(NSInteger)min and:(NSInteger)max {
    return (NSInteger)(min + arc4random_uniform(max - min + 1));
} 
```

如果我最终在许多文件中使用它，我通常将宏声明为

```
#define RAND_FROM_TO(min, max) (min + arc4random_uniform(max - min + 1)) 
```

例如

```
NSInteger myInteger = RAND_FROM_TO(0, 74) // 0, 1, 2,..., 73, 74 
```

**注意：仅适用于 iOS 4.3/OS X v10.7 (Lion) 及更高版本**

* * *

## 回答 #5

> 赞同：44
> 
> 时间：2012-02-16T11:47:53.110

这将为您提供0 到 47 之间的**浮点数**

```
float low_bound = 0;      
float high_bound = 47;
float rndValue = (((float)arc4random()/0x100000000)*(high_bound-low_bound)+low_bound); 
```

或者只是简单地

```
float rndValue = (((float)arc4random()/0x100000000)*47); 
```

下限和上限也可以是**负数**。下面的示例代码为您提供了一个介于 -35.76 和 +12.09 之间的随机数

```
float low_bound = -35.76;      
float high_bound = 12.09;
float rndValue = (((float)arc4random()/0x100000000)*(high_bound-low_bound)+low_bound); 
```

将结果转换为更舍入的**整**数值：

```
int intRndValue = (int)(rndValue + 0.5); 
```

* * *

## 回答 #6

> 赞同：37
> 
> 时间：2008-10-02T06:49:40.147

根据 rand(3) 的手册页，rand 系列函数已被 random(3) 淘汰。这是因为 rand() 的低 12 位经过循环模式。要获得一个随机数，只需通过使用无符号种子调用 srandom() 为生成器播种，然后调用 random()。所以，相当于上面的代码是

```
#import <stdlib.h>
#import <time.h>

srandom(time(NULL));
random() % 74; 
```

除非您想更改种子，否则您只需在程序中调用 srandom() 一次。尽管您说您不想讨论真正的随机值，但 rand() 是一个非常糟糕的随机数生成器，并且 random() 仍然存在模偏差，因为它会生成一个介于 0 和 RAND_MAX 之间的数字。因此，例如，如果 RAND_MAX 为 3，并且您想要一个介于 0 和 2 之间的随机数，那么您获得 0 的可能性是 1 或 2 的两倍。

* * *

## 回答 #7

> 赞同：31
> 
> 时间：2012-06-19T12:38:07.720

更好用`arc4random_uniform`。但是，这在 iOS 4.3 以下不可用。幸运的是 iOS 会在运行时绑定这个符号，而不是在编译时（所以不要使用 #if 预处理器指令来检查它是否可用）。

确定是否`arc4random_uniform`可用的最佳方法是执行以下操作：

```
#include <stdlib.h>

int r = 0;
if (arc4random_uniform != NULL)
    r = arc4random_uniform (74);
else
    r = (arc4random() % 74); 
```

* * *

## 回答 #8

> 赞同：14
> 
> 时间：2010-01-28T00:02:39.130

我编写了自己的随机数实用程序类，这样我就有了一些功能更像 Java 中的 Math.random() 的东西。它只有两个功能，而且都是用 C 语言编写的。

头文件：

```
//Random.h
void initRandomSeed(long firstSeed);
float nextRandomFloat(); 
```

实现文件：

```
//Random.m
static unsigned long seed;

void initRandomSeed(long firstSeed)
{ 
    seed = firstSeed;
}

float nextRandomFloat()
{
    return (((seed= 1664525*seed + 1013904223)>>16) / (float)0x10000);
} 
```

这是一种非常经典的生成伪随机数的方法。在我的应用程序委托中，我调用：

```
#import "Random.h"

- (void)applicationDidFinishLaunching:(UIApplication *)application
{
    initRandomSeed( (long) [[NSDate date] timeIntervalSince1970] );
    //Do other initialization junk.
} 
```

然后我只是说：

```
float myRandomNumber = nextRandomFloat() * 74; 
```

请注意，此方法返回一个介于 0.0f（含）和 1.0f（不含）之间的随机数。

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2015-05-11T15:20:01.097

已经有一些很好的、清晰的答案，但问题要求一个介于 0 和 74 之间的随机数。使用：

`arc4random_uniform(75)`

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2015-02-24T10:29:44.970

生成 0 到 99 之间的随机数：

```
int x = arc4random()%100; 
```

生成 500 到 1000 之间的随机数：

```
int x = (arc4random()%501) + 500; 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2015-12-19T13:23:48.687

从 iOS 9 和 OS X 10.11 开始，您可以使用新的 GameplayKit 类以多种方式生成随机数。

您有四种源类型可供选择：一般随机源（未命名，由系统选择它的功能）、线性同余、ARC4 和 Mersenne Twister。这些可以生成随机整数、浮点数和布尔值。

在最简单的层面上，您可以从系统的内置随机源生成一个随机数，如下所示：

```
NSInteger rand = [[GKRandomSource sharedRandom] nextInt]; 
```

这会生成一个介于 -2,147,483,648 和 2,147,483,647 之间的数字。如果你想要一个介于 0 和上限（不包括）之间的数字，你可以使用：

```
NSInteger rand6 = [[GKRandomSource sharedRandom] nextIntWithUpperBound:6]; 
```

GameplayKit 内置了一些方便的构造函数来处理骰子。例如，您可以像这样滚动一个六面骰子：

```
GKRandomDistribution *d6 = [GKRandomDistribution d6];
[d6 nextInt]; 
```

另外，您可以使用诸如`GKShuffledDistribution`.

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2015-09-29T09:51:44.613

//以下示例将生成一个介于 0 和 73 之间的数字。

```
int value;
value = (arc4random() % 74);
NSLog(@"random number: %i ", value);

//In order to generate 1 to 73, do the following:
int value1;
value1 = (arc4random() % 73) + 1;
NSLog(@"random number step 2: %i ", value1); 
```

**输出：**

*   随机数：**72**

*   随机数步骤**2：52**

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2016-07-15T04:55:28.397

对于游戏开发，使用 random() 生成随机数。可能比使用 arc4random() 快至少 5 倍。当使用全范围 random() 生成随机数时，模偏差不是问题，尤其是对于游戏。一定要先播种。在 AppDelegate 中调用 srandomdev()。下面是一些辅助函数：

```
static inline int random_range(int low, int high){ return (random()%(high-low+1))+low;}
static inline CGFloat frandom(){ return (CGFloat)random()/UINT32_C(0x7FFFFFFF);}
static inline CGFloat frandom_range(CGFloat low, CGFloat high){ return (high-low)*frandom()+low;} 
```

# ruby-on-rails - Rails 请求初始化

> ID：160894
> 
> 赞同：0
> 
> 时间：2008-10-02T04:36:32.260
> 
> 标签：ruby-on-rails, ruby, scalability

我们都听说过很多关于 Rails 中的扩展问题。

我只是好奇在 Rails 框架中处理 HTTP 请求的实际成本是多少。意思是，对于每个进来的请求，必须发生什么？有类解析吗？配置？建立数据库连接？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-02T07:07:22.400

这实际上很大程度上取决于您使用的 Web 服务器以及您使用的配置，更不用说应用程序设计本身了。涉及的配置和设计问题包括：

*   无论您使用的是 fastcgi、老式 cgi 还是其他一些请求处理机制（影响您是否必须重新运行每个请求的所有应用程序初始化代码）
*   无论您是否使用 memcache（或替代缓存策略）（影响数据库请求的成本）
*   无论您是否使用其他负载平衡技术
*   您正在使用哪种会话持久性策略（如果需要）
*   无论您是否使用“开发”模式，这都会导致代码文件在更改时重新加载（我记得；也许只是每个请求）

与大多数 Web 应用程序框架一样，存在用于连接池、缓存和进程管理的解决方案。有很多方法可以管理数据库访问；通常，默认的不一定是最高性能，但调整该策略并不是火箭科学。

深入了解内部结构的人可能会说得更详细一些，但大多数应用程序要么使用 Apache 上的 FastCGI，要么使用对 Rails 更友好的备用 Web 服务器，这意味着每个进程只需要设置一次应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T22:51:07.720

这是 Rails request 生命周期的一个很好的高级[概述](http://brainspl.at/articles/2007/02/15/exploring-the-request-lifecycle-through-the-mongrel-and-rails-source-code)。完成此操作后，您可以选择特定部分进行分析和优化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-03T04:35:45.483

在 Phusion Passenger（又名 mod_rails）发布之前，部署的“标准”不是 FastCGI，而是使用以 Apache 和 mod_proxy（或 Nginx 等）为前端的 Mongrel 服务器集群。

“Rails 无法扩展”背后的主要问题是存在一些相当复杂的线程问题，这意味着在当前版本的 Ruby 和可用的服务机制中，Rails 不是线程安全的。这意味着运行 Rails 应用程序需要多个容器来支持高级别的并发请求。passenger 做了一些讨论，因为它在内部处理所有这些，并且也可以在改变内存处理方式的 Ruby（Ruby 企业版）的自定义构建上运行。

最重要的是，即将到来的 Ruby 和 Rails 版本都直接解决了线程问题，应该一劳永逸地结束这个论点。

就我而言，整个说法都是非常虚假的。“规模”是一个架构问题。

# ruby-on-rails - 在 ActiveRecord 上遍历 HABTM 关系

> ID：160902
> 
> 赞同：0
> 
> 时间：2008-10-02T04:41:56.303
> 
> 标签：ruby-on-rails, activerecord

我正在为我的学校在 Rails 上做一个项目（不要担心这不是在代码上评分），我正在寻找一种干净的方式来遍历 ActiveRecord 中的关系。

我有 ActiveRecord 类，称为用户、组和分配。用户和组具有 HABTM 关系以及组和分配。现在我需要的是一个用户函数 get_group(aid)，其中“给定一个用户，找到给定分配的组”。

简单的路线是：

```
 def get_group(aid)
    group = nil
    groups.each { |g| group = g if g.assignment.find(aid).id == aid }
    return group
  end 
```

是否有更简洁的实现利用组和分配之间的 HABTM 关系而不仅仅是迭代？我还尝试过的一件事是 find() 的 :include 选项，如下所示：

```
 def get_group(aid)
   user.groups.find(:first, 
     :include => :assignments, 
     :conditions => ["assignments.id = ?", aid])
  end 
```

但这似乎不起作用。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-02T07:29:53.857

首先，要小心。由于您同时使用这两种关系，因此给定的and`has_and_belongs_to_many`可能有多个。所以我要实现一个返回s数组的方法。`Group``User``Assignment``Group`

其次，`User#get_group`采用分配 id 的方法的名称非常具有误导性，并且不像 Ruby。

[`Array#&`](http://ruby-doc.org/core/classes/Array.html#M002235)这是使用 Ruby 的交集运算符获取所有公共组的简洁方法。我给该方法取了一个更具启发性的名称并把它放在上面，`Group`因为它正在返回`Group`实例。但是请注意，它会加载`Group`与一个相关但与另一个无关的 s：

```
class Group < ActiveRecord::Base
  has_and_belongs_to_many :assignments
  has_and_belongs_to_many :users

  # Use the array intersection operator to find all groups associated with both the User and Assignment 
  # instances that were passed in
  def self.find_all_by_user_and_assignment(user, assignment)
    user.groups & assignment.groups
  end
end 
```

然后如果你真的需要一个`User#get_groups`方法，你可以这样定义它：

```
class User < ActiveRecord::Base
  has_and_belongs_to_many :groups

  def get_groups(assignment_id)
    Group.find_all_by_user_and_assignment(self, Assignment.find(assignment_id))
  end
end 
```

虽然我可能会命名它`User#groups_by_assignment_id`。

我的`Assignment`模型很简单：

```
class Assignment < ActiveRecord::Base
  has_and_belongs_to_many :groups
end 
```

# sql-server - Oracle 认为空字符串为 NULL，而 SQL Server 不认为 - 如何最好地处理？

> ID：160904
> 
> 赞同：20
> 
> 时间：2008-10-02T04:43:19.717
> 
> 标签：sql-server, oracle

我必须编写一个在 Oracle 数据库中重新创建 SQL Server 表（结构和数据）的组件。该组件还必须获取输入到 Oracle 数据库中的新数据并将其复制回 SQL Server。

将数据类型从 SQL Server 转换为 Oracle 不是问题。但是，Oracle 和 SQL Server 之间的一个关键区别是令人头疼的问题。SQL Server 认为空白字符串 ("") 与`NULL`值不同，因此`char`可以将列定义为`NOT NULL`但仍然在数据中包含空白字符串。

Oracle 认为空字符串与`NULL`值相同，因此如果`char`列定义为`NOT NULL`，则不能插入空字符串。`NOT NULL`每当char 列在原始 SQL Server 数据中包含空白字符串时，这都会导致我的组件中断。

到目前为止，我的解决方案是不在`NOT NULL`我的任何镜像 Oracle 表定义中使用，但我需要一个更强大的解决方案。这必须是代码解决方案，所以答案不能是“使用某某的 SQL2Oracle 产品”。

你将如何解决这个问题？

编辑：这是迄今为止我提出的唯一解决方案，它可能有助于说明问题。因为 Oracle 不允许在 NOT NULL 列中使用“”，所以我的组件可以拦截来自 SQL Server 的任何此类值并将其替换为“@”（仅作为示例）。

当我向我的 Oracle 表添加新记录时，如果我真的要插入“”，我的代码必须写“@”，而当我的代码将新行复制回 SQL Server 时，它必须截取“@”而是写“”。

我希望有一个更优雅的方式。

编辑 2：是否有可能有一个更简单的解决方案，比如 Oracle 中的一些设置让它像对待所有其他主要数据库一样对待空白字符串？Oracle Lite 中是否也提供此设置？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-02T05:00:48.473

我没有看到一个简单的解决方案。

也许您可以将您的值存储为一个或多个空白`-> ' '`，这在 Oracle 中不是 NULLS，或者通过额外的字段/表和适配器层来跟踪这种特殊情况。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-02T05:28:01.093

我的典型解决方案是在 SQL Server 中添加一个约束，强制受影响列中的所有字符串值的长度大于 0：

```
CREATE TABLE Example (StringColumn VARCHAR(10) NOT NULL)

ALTER TABLE Example
ADD CONSTRAINT CK_Example_StringColumn CHECK (LEN(StringColumn) > 0) 
```

但是，正如您所说，您无法控制 SQL 数据库。因此，您确实有四个选择（如我所见）：

1.  将空字符串值视为无效，跳过这些记录，提醒操作员并以某种易于手动更正/重新输入的方式记录记录。
2.  将空字符串值转换为空格。
3.  将空字符串值转换为代码（即“LEGACY”或“EMPTY”）。
4.  在这些列中遇到空字符串值的回滚传输，然后对 SQL Server 数据库所有者施加压力以更正其数据。

第四是我的偏好，但并不总是可能的。您采取的行动实际上取决于预言机用户的需求。最终，如果对 SQL 数据库无能为力，我会向 oracle 业务系统所有者解释问题，解释选项和后果并让他们做出决定:)

**注意：**我相信在这种情况下 SQL Server 实际上表现出“正确”的行为。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-02T04:58:16.920

您必须在 SQL Server 系统中允许空字符串吗？如果您可以向 SQL Server 系统添加一个不允许空字符串的约束，那可能是最简单的解决方案。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-02T08:40:45.700

它令人讨厌并且可能会产生意想不到的副作用..但是您可以只插入“chr(0)”而不是“”。

```
drop table x

drop table x succeeded.
create table x ( id number, my_varchar varchar2(10))

create table succeeded.
insert into x values (1, chr(0))

1 rows inserted
insert into x values (2, null)

1 rows inserted
select id,length(my_varchar) from x

ID                     LENGTH(MY_VARCHAR)     
---------------------- ---------------------- 
1                      1                      
2                                             

2 rows selected

select * from x where my_varchar is not null

ID                     MY_VARCHAR 
---------------------- ---------- 
1 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-10-25T06:27:25.270

NOT NULL 是用于停止将无效数据放入数据库的数据库约束。这在您的 Oracle 数据库中没有任何用途，所以我不会拥有它。

我认为您应该继续在镜像已知包含空字符串的 SqlServer 列的任何 Oracle 列中允许 NULLS。

如果 SqlServer 数据库中 NULL 和空字符串之间存在逻辑差异，那么您将需要一些额外的东西来模拟 Oracle 中的这种差异。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-01-27T16:02:41.940

对于那些认为 Null 和空字符串应该被视为相同的人。null 与空字符串的含义不同。它捕获了“未定义”和“已知为空白”之间的区别。例如，一条记录可能已自动创建，但从未通过用户输入进行验证，因此收到一个“null”，期望用户验证它时，它将被设置为空。实际上，我们可能不想在 null 上触发逻辑，但可能希望在空字符串上触发。这类似于是/否/未定义的 3 状态复选框的情况。

SQL 和 Oracle 都没有完全正确。空白不应满足“非空”约束，并且需要以不同于对待空字符串的方式对待空字符串。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2015-01-29T21:36:57.837

我会在甲骨文方面增加一个专栏。让您的列允许空值，并有第二列来标识 SQL-Server 端是否应该为该行获取空值或空字符串。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-02T05:02:24.710

如果您正在迁移数据，您可能必须用空格替换空字符串。不是很优雅，但可行。这是 Oracle 的一个讨厌的“特性”。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-01-28T13:08:32.053

不久前，我在我的博客上写了一篇关于 Oracle 如何处理空值的解释。在此处查看：[http](http://www.psinke.nl/blog/hello-world/) ://www.psinke.nl/blog/hello-world/如果您还有其他问题，请告诉我。如果您有来自具有空值的源的数据，并且您必须转换为列不为 NULL 的 Oracle 数据库，您可以做 2 件事：

*   从 Oracle 列中删除非空约束
*   检查每个单独的列是否可以在列中放置“”或 0 或虚拟日期以便能够保存您的数据。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-01-29T18:30:30.240

好吧，我要考虑的要点是当某些字段可以为空时缺少任务，相同的字段可以是空字符串并且业务逻辑需要区分这些值。所以我会做这个逻辑：

*   如果列具有 NOT NULL 约束，则检查 MSSQL
*   如果列具有 CHECK(column <> '') 或类似约束，请检查 MSSQL

如果两者都为真，则使 Oracle 列 NOT NULL。如果任何一项为真，则将 Oracle 列设为 NULL。如果没有一个为真，则引发 INVALID DESIGN 异常（或者可能忽略它，如果此应用程序可以接受）。

当从 MSSQL 向 Oracle 发送数据时，只需不做任何特殊处理，所有数据都会正确传输。将数据检索到 MSSQL 时，应按原样发送任何非空数据。对于空字符串，您应该决定是否应将其插入为空字符串或空字符串。为此，您应该再次检查表设计（或记住以前的结果）并查看它是否具有 NOT NULL 约束。如果有 - 使用空字符串，如果没有 - 使用 NULL。简单而聪明。

有时，如果您使用未知且不可预测的应用程序，您无法检查是否存在 {not empty string} 约束，因为它有多种形式。如果是这样，您可以使用简化的逻辑（使 Oracle 列始终可以为空）或检查是否可以将空字符串插入 MSSQL 表而不会出错。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-02-03T14:19:24.070

虽然，在大多数情况下，我同意大多数其他回应（不会就我不同意的任何回应进行争论 - 不是那个地方:)）

我确实注意到OP提到了以下内容：

“Oracle 认为空白字符串与 NULL 值相同，因此如果将 char 列定义为 NOT NULL，则不能插入空白字符串。”

专门调用 CHAR，而不是 VARCHAR2。因此，谈论长度为 0 的“空字符串”（即 '' ）是没有实际意义的。如果他将 CHAR 声明为例如 CHAR(5)，那么只需在传入的空字符串中添加一个空格，Oracle 无论如何都会填充它。你最终会得到一个 5 个空格的字符串。

现在，如果 OP 的意思是 VARCHAR2，那么是的，那完全是另外一头野兽，是的，空字符串和 NULL 之间的区别变得相关。

```
 SQL> drop table junk;

  Table dropped.

  SQL>
  SQL> create table junk ( c1     char(5) not null );

  Table created.

  SQL>
  SQL> insert into junk values ( 'hi' );

  1 row created.

  SQL>
  SQL> insert into junk values ( ' ' );

  1 row created.

  SQL>
  SQL> insert into junk values ( '' );
  insert into junk values ( '' )
                            *
  ERROR at line 1:
  ORA-01400: cannot insert NULL into ("GREGS"."JUNK"."C1")

  SQL>
  SQL> insert into junk values ( rpad('', 5, ' ') );
  insert into junk values ( rpad('', 5, ' ') )
                            *
  ERROR at line 1:
  ORA-01400: cannot insert NULL into ("GREGS"."JUNK"."C1")

  SQL>
  SQL> declare
    2    lv_in   varchar2(5) := '';
    3  begin
    4     insert into junk values ( rpad(lv_in||' ', 5) );
    5  end;
    6  /

  PL/SQL procedure successfully completed.

  SQL> 
```

# python - Django 管理站点不显示 ManyToManyField 关系

> ID：160905
> 
> 赞同：4
> 
> 时间：2008-10-02T04:43:28.923
> 
> 标签：python, django

我正在开发一个我认为非常标准的 django 站点，但是我无法让我的管理部分显示正确的字段。

这是我的models.py：

```
class Tech(models.Model):
    name = models.CharField(max_length = 30)

class Project(models.Model):
    title = models.CharField(max_length = 50)
    techs = models.ManyToManyField(Tech) 
```

换句话说，一个项目可以有不同的技术对象，不同的技术对象可以属于不同的项目（项目 X 是用 Python 和 Django 创建的，项目 Y 是 C# 和 SQL Server）

但是，管理站点不显示 Tech 对象的任何 UI。这是我的 admin.py：

```
class TechInline(admin.TabularInline):
    model = Tech
    extra = 5

class ProjectAdmin(admin.ModelAdmin):
    fields = ['title']
    inlines = []
    list_display = ('title')

admin.site.register(Project, ProjectAdmin) 
```

我尝试将`TechInline`类添加到`inlines`列表中，但这会导致

```
<class 'home.projects.models.Tech'> has no ForeignKey to <class 'home.projects.models.Project'> 
```

错误。还尝试添加`techs`到`fields`列表中，但这给出了

> 没有这样的表：projects_project_techs

错误。我验证了，没有`projects_project_techs`桌子，但有`projects_tech`一张。是不是我的同步数据库搞砸了？

如果有帮助，我将使用 Sqlite 作为我的数据库。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-02T04:48:29.987

> 我尝试将 TechInline 类添加到内联列表中，但这会导致
> 
> 'TechInLine' 未定义

是直接复制粘贴吗？看起来您只是打错字了 - 尝试`TechInline`而不是`TechInLine`.

如果您的 syncdb 没有创建正确的表，您可以手动创建。执行这个命令：

```
python manage.py sqlreset <myapp> 
```

并查找`projects_project_techs`表的定义。将其复制并粘贴到数据库的客户端中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-02T09:27:51.517

假设您的应用名为“projects”，那么您的 techs 表的默认名称将是 projects_tech，projects 表将是 projects_project。

多对多表应该类似于 projects_project_techs

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-02T15:17:50.707

@John Millikin - 感谢 sqlreset 提示，这让我走上了正确的道路。sqlreset 生成的代码向我展示了`projects_project_techs`从未实际创建过的代码。我最终只是删除了我的 deb.db 数据库并重新生成它。`techs`然后出现了它应该。

顺便说一句，我必须做一个`admin.site.register(Tech)`才能从项目页面创建类的新实例。

我可能会发布另一个问题，看看是否有更好的方法来实现模型更改（因为我很确定这是导致我的问题的原因）而不擦除数据库。

# java - OpenJDK7：OpenJDK7 中没有实现哪些基本的 ADT？

> ID：160908
> 
> 赞同：0
> 
> 时间：2008-10-02T04:45:15.687
> 
> 标签：java, specifications, adts

OpenJDK7 应该添加哪些抽象数据类型？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-30T06:57:50.360

如果您查看这两个链接，您会发现有些人觉得缺少什么：

*   [http://commons.apache.org/collections/](http://commons.apache.org/collections/)
*   [http://code.google.com/p/google-collections/](http://code.google.com/p/google-collections/)

我最喜欢缺少的一个是 Bag ......它很容易实现，但必须实现它很烦人。

Mulimap 也很高兴包含在标准包中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T04:11:21.220

我认为他们应该停止向 JDK 添加新库。您可以轻松地从第三方开源库中获取所需内容。希望在版本 7 中，JVM 及其标准库将变得更加模块化。

# c++ - 如何在 qt 4.3 中更改 Q3Table 的垂直标题列的宽度？

> ID：160913
> 
> 赞同：1
> 
> 时间：2008-10-02T04:46:06.170
> 
> 标签：c++, qt, qt4

我正在使用一个`Q3Table`对象并想更改垂直标题列的宽度。有谁知道如何做到这一点？看来我只能调整标题单元格的高度，但不能调整宽度。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-02T05:24:30.570

您想使用 Q3Table::setLeftMargin。这将设置垂直标题的宽度。

> void Q3Table::setLeftMargin ( int m )
> 将左边距设置为 m 像素宽。显示行标签的verticalHeader() 占据了这个边距。

# delphi - 如何在代码中模拟 Delphi 断点？

> ID：160923
> 
> 赞同：27
> 
> 时间：2008-10-02T04:54:24.653
> 
> 标签：delphi, debugging, ide, breakpoints

我很确定我以前见过这个，但我还没有发现/记得怎么做。我想要一行代码，当从 Delphi 调试器执行时，我希望调试器弹出，就像该行上有一个断点一样。

就像是：

```
FooBar := Foo(Bar);
SimulateBreakPoint; // Cause break point to occur in Delphi IDE if attached
WriteLn('Value: ' + FooBar); 
```

希望这是有道理的。我知道我可以使用异常，但这会比我想要的要多得多。这是一些演示代码。

提前致谢！

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2008-10-02T05:25:13.503

从代码中触发调试器（据说我没有delphi的副本可以尝试）：

```
asm int 3 end; 
```

请参阅此页面：

[http://17slon.com/blogs/gabr/2008/03/debugging-with-lazy-breakpoints.html](http://17slon.com/blogs/gabr/2008/03/debugging-with-lazy-breakpoints.html)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-10-02T05:59:44.013

正如 Andreas Hausladen 在对该文章的评论中所说的那样，Win32 API DebugBreak() 函数不像 DOS 那样运行良好，并且同样有效。

# linux - 如何在 Linux 上按名称而不是 PID 杀死进程？

> ID：160924
> 
> 赞同：444
> 
> 时间：2008-10-02T04:57:20.387
> 
> 标签：linux, bash, shell, kill

有时当我尝试启动 Firefox 时，它会显示“Firefox 进程已在运行”。所以我必须这样做：

```
jeremy@jeremy-desktop:~$ ps aux | grep firefox
jeremy    7451 25.0 27.4 170536 65680 ?        Sl   22:39   1:18 /usr/lib/firefox-3.0.1/firefox
jeremy    7578  0.0  0.3   3004   768 pts/0    S+   22:44   0:00 grep firefox
jeremy@jeremy-desktop:~$ kill 7451 
```

我想要的是一个可以为我做所有这些的命令。它会在进程列表中接受一个输入字符串和`grep`它（或其他），并会杀死输出中的所有进程：

```
jeremy@jeremy-desktop:~$ killbyname firefox 
```

我尝试在 PHP 中执行此操作，但`exec('ps aux')`似乎只显示`exec()`在 PHP 脚本本身中执行的进程（因此它显示的唯一进程就是它本身。）

* * *

## 回答 #1

> 赞同：639
> 
> 时间：2008-10-02T04:58:24.173

```
pkill firefox 
```

更多信息： http: [//linux.about.com/library/cmd/blcmdl1_pkill.htm](http://linux.about.com/library/cmd/blcmdl1_pkill.htm)

* * *

## 回答 #2

> 赞同：182
> 
> 时间：2015-01-07T13:49:08.170

也可以使用：

```
pkill -f "Process name" 
```

对我来说，它完美无缺。这是我一直在寻找的。pkill 不适用于没有标志的名称。

设置时`-f`，完整的命令行用于模式匹配。

* * *

## 回答 #3

> 赞同：69
> 
> 时间：2008-10-02T05:05:29.320

您可以按*名称*杀死进程[`killall <name>`](http://linux.die.net/man/1/killall)

> **killall**向运行任何指定命令的所有进程发送信号。如果未指定信号名称，则发送 SIGTERM。
> 
> 信号可以通过名称（例如**-HUP**或**-SIGHUP**）或数字（例如 **-1**）或选项**-s**来指定。
> 
> 如果命令名称不是正则表达式（选项**-r**）并且包含斜杠 (/)，则执行该特定文件的进程将被选择用于终止，与它们的名称无关。

但是，如果您没有看到带有 的进程`ps aux`，则您可能无权杀死它...

* * *

## 回答 #4

> 赞同：53
> 
> 时间：2008-10-02T16:32:57.703

更长的选择：

```
kill `pidof firefox` 
```

* * *

## 回答 #5

> 赞同：38
> 
> 时间：2016-07-12T19:53:06.047

最简单的方法是首先检查您是否获得了正确的进程 ID：

```
pgrep -f [part_of_a_command] 
```

如果结果符合预期。一起去：

```
pkill -f [part_of_a_command] 
```

* * *

## 回答 #6

> 赞同：26
> 
> 时间：2016-10-02T20:17:44.867

奇怪，但我还没有看到这样的解决方案：

```
kill -9 `pidof firefox` 
```

它还可以杀死多个进程（多个 pid），例如：

```
kill -9 `pgrep firefox` 
```

我更喜欢`pidof`它，因为它有单行输出：

```
> pgrep firefox
6316
6565
> pidof firefox
6565 6316 
```

* * *

## 回答 #7

> 赞同：25
> 
> 时间：2017-04-05T13:03:46.023

**杀死所有`snippet`在启动路径中的进程。**您可以通过将 /directory/ 作为片段来终止从某个目录启动的所有应用程序。当您从同一个应用程序目录为同一个应用程序启动多个组件时，这非常有用。

```
ps ax | grep <snippet> | grep -v grep | awk '{print $1}' | xargs kill 
```

* 如果有的话，我会更喜欢 pgrep

* * *

## 回答 #8

> 赞同：14
> 
> 时间：2013-05-18T07:27:34.687

使用`killall`命令：

```
killall processname 
```

使用`-9`or`-KILL`强制终止程序（选项与`kill`命令类似）。

* * *

## 回答 #9

> 赞同：12
> 
> 时间：2013-02-21T23:32:58.070

在 Mac 上，我找不到 pgrep 和 pkill，killall 也没有工作，所以写了一个简单的衬里脚本：-

```
export pid=`ps | grep process_name | awk 'NR==1{print $1}' | cut -d' ' -f1`;kill $pid 
```

如果有更简单的方法，请分享。

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2014-11-14T20:14:41.647

用 grep 杀死：

```
kill -9 `pgrep myprocess` 
```

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2008-10-02T04:58:57.713

我通常使用`killall`命令。

[检查此链接](http://linux.die.net/man/1/killall)以获取此命令的详细信息。

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2014-05-23T07:47:45.507

更正确的是：

```
export pid=`ps aux | grep process_name | awk 'NR==1{print $2}' | cut -d' ' -f1`;kill -9 $pid 
```

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2016-02-22T13:38:48.497

我问自己同样的问题，但当前答案的问题是他们**不安全地检查要被杀死的进程，**所以......它可能导致可怕的错误:)......特别是如果**有几个进程与模式匹配**。

作为免责声明，我不是 sh 专业人士，当然还有改进的余地。

所以我写了一个小 sh 脚本：

```
#!/bin/sh

killables=$(ps aux | grep $1 | grep -v mykill | grep -v grep)
if [ ! "${killables}" = "" ]
then
  echo "You are going to kill some process:"
  echo "${killables}"
else
  echo "No process with the pattern $1 found."
  return
fi
echo -n "Is it ok?(Y/N)"
read input
if [ "$input" = "Y" ]
then
  for pid in $(echo "${killables}" | awk '{print $2}')
  do
    echo killing $pid "..."
    kill $pid 
    echo $pid killed
  done
fi 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2008-10-02T05:42:31.323

如果您运行 GNOME，您可以使用系统监视器（系统->管理->系统监视器）来杀死进程，就像在 Windows 下一样。KDE 也会有类似的东西。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2015-12-15T13:29:26.963

默认`kill`命令接受命令名称作为 PID 的替代。参见[杀死 (1)](http://man7.org/linux/man-pages/man1/kill.1.html#ARGUMENTS)。一个经常出现的问题是它`bash`提供了自己的`kill`接受作业编号，如`kill %1`，但不接受命令名称。这阻碍了默认命令。如果前一个功能比后者对您更有用，您可以`bash`通过调用禁用该版本

`enable -n kill`

有关更多信息，请参阅[bash (1)](http://man7.org/linux/man-pages/man1/bash.1.html#SHELL_BUILTIN%20COMMANDS)`kill`中的`enable`条目。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2016-06-21T07:17:33.130

kill -9 $(ps aux | grep -e myprocessname| awk '{ print $2 }')

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2016-05-11T15:52:11.357

```
ps aux | grep processname | cut -d' ' -f7 | xargs kill -9 $ 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2019-06-27T12:48:53.217

awk oneliner，它解析`ps`输出的标题，所以你不需要关心列号（但列名）。支持正则表达式。例如，要杀死所有进程，其中可执行名称（不带路径）包含单词“firefox”尝试

```
ps -fe | awk 'NR==1{for (i=1; i<=NF; i++) {if ($i=="COMMAND") Ncmd=i; else if ($i=="PID") Npid=i} if (!Ncmd || !Npid) {print "wrong or no header" > "/dev/stderr"; exit} }$Ncmd~"/"name"$"{print "killing "$Ncmd" with PID " $Npid; system("kill "$Npid)}' name=.*firefox.* 
```

# c - 如何检查整数是偶数还是奇数？

> ID：160930
> 
> 赞同：193
> 
> 时间：2008-10-02T05:00:08.617
> 
> 标签：c, integer

如何检查给定数字在C中是偶数还是奇数？

* * *

## 回答 #1

> 赞同：448
> 
> 时间：2008-10-02T05:01:03.887

使用模 (%) 运算符检查除以 2 时是否有余数：

```
if (x % 2) { /* x is odd */ } 
```

一些人批评了我上面的回答，说使用 x & 1 是“更快”或“更有效”。我不相信是这样的。

出于好奇，我创建了两个简单的测试用例程序：

```
/* modulo.c */
#include <stdio.h>

int main(void)
{
    int x;
    for (x = 0; x < 10; x++)
        if (x % 2)
            printf("%d is odd\n", x);
    return 0;
}

/* and.c */
#include <stdio.h>

int main(void)
{
    int x;
    for (x = 0; x < 10; x++)
        if (x & 1)
            printf("%d is odd\n", x);
    return 0;
} 
```

然后我在我的一台机器上用 gcc 4.1.3 编译了 5 次：

*   没有优化标志。
*   带-O
*   带 -Os
*   与 -O2
*   与-O3

我检查了每次编译的汇编输出（使用 gcc -S），发现在每种情况下，and.c 和 modulo.c 的输出都是相同的（它们都使用了 andl $1, %eax 指令）。我怀疑这是一个“新”功能，我怀疑它可以追溯到古代版本。我也怀疑任何现代（过去 20 年制造的）非神秘编译器，无论是商业的还是开源的，都缺乏这种优化。我会在其他编译器上进行测试，但目前我没有任何可用的。

如果其他人愿意测试其他编译器和/或平台目标，并得到不同的结果，我很想知道。

**最后，标准保证**模版本无论整数是正数、负数还是零都可以工作，而不管实现对有符号整数的表示。按位与版本不是。是的，我意识到二进制补码无处不在，所以这不是一个真正的问题。

* * *

## 回答 #2

> 赞同：206
> 
> 时间：2008-10-02T06:00:02.093

你们太有效率了。你真正想要的是：

```
public boolean isOdd(int num) {
  int i = 0;
  boolean odd = false;

  while (i != num) {
    odd = !odd;
    i = i + 1;
  }

  return odd;
} 
```

重复`isEven`。

当然，这不适用于负数。但伴随着辉煌而来的是牺牲……

* * *

## 回答 #3

> 赞同：97
> 
> 时间：2008-10-02T05:01:36.320

使用位算术：

```
if((x & 1) == 0)
    printf("EVEN!\n");
else
    printf("ODD!\n"); 
```

这比使用除法或模数要快。

* * *

## 回答 #4

> 赞同：36
> 
> 时间：2008-10-02T11:39:34.693

[笑话模式=“开”]

```
public enum Evenness
{
  Unknown = 0,
  Even = 1,
  Odd = 2
}

public static Evenness AnalyzeEvenness(object o)
{

  if (o == null)
    return Evenness.Unknown;

  string foo = o.ToString();

  if (String.IsNullOrEmpty(foo))
    return Evenness.Unknown;

  char bar = foo[foo.Length - 1];

  switch (bar)
  {
     case '0':
     case '2':
     case '4':
     case '6':
     case '8':
       return Evenness.Even;
     case '1':
     case '3':
     case '5':
     case '7':
     case '9':
       return Evenness.Odd;
     default:
       return Evenness.Unknown;
  }
} 
```

[笑话模式=“关闭”]

编辑：向枚举添加了令人困惑的值。

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2008-10-02T08:21:23.250

作为对[ffpf](https://stackoverflow.com/questions/160930/how-do-i-check-if-an-integer-is-even-or-odd#160947)的回应- 几年前我和一位同事有完全相同的论点，答案是**否定**的，它不适用于负数。

C标准规定负数可以用3种方式表示：

*   2 的补码
*   1 的补码
*   符号和大小

像这样检查：

```
isEven = (x & 1); 
```

将适用于 2 的补码以及符号和幅度表示，但不适用于 1 的补码。

但是，我相信以下内容适用于所有情况：

```
isEven = (x & 1) ^ ((-1 & 1) | ((x < 0) ? 0 : 1))); 
```

^(感谢 ffpf 指出文本框在我的小于字符之后吃掉了所有东西！)

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2008-10-02T09:52:24.607

一个不错的是：

```
/*forward declaration, C compiles in one pass*/
bool isOdd(unsigned int n);

bool isEven(unsigned int n)
{
  if (n == 0) 
    return true ;  // I know 0 is even
  else
    return isOdd(n-1) ; // n is even if n-1 is odd
}

bool isOdd(unsigned int n)
{
  if (n == 0)
    return false ;
  else
    return isEven(n-1) ; // n is odd if n-1 is even
} 
```

请注意，此方法使用涉及两个函数的尾递归。如果你的编译器像 Scheme 编译器一样支持尾递归，它可以有效地实现（变成一个 while/until 循环）。在这种情况下，堆栈不应该溢出！

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2008-10-02T05:07:42.017

一个数是偶数，如果除以二，余数是 0。一个数是奇数，如果，除以 2，余数是 1。

```
// Java
public static boolean isOdd(int num){
    return num % 2 != 0;
}

/* C */
int isOdd(int num){
    return num % 2;
} 
```

方法很棒！

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2008-10-02T05:01:11.297

```
i % 2 == 0 
```

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2008-10-02T05:01:01.313

我会说只需将其除以 2，如果余数为 0，则为偶数，否则为奇数。

使用模数 (%) 使这很容易。

例如。4 % 2 = 0 因此 4 是偶数 5 % 2 = 1 因此 5 是奇数

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2008-10-02T06:11:49.520

解决问题的另一种方法
*（欢迎孩子们投票）*

```
bool isEven(unsigned int x)
{
  unsigned int half1 = 0, half2 = 0;
  while (x)
  {
     if (x) { half1++; x--; }
     if (x) { half2++; x--; }

  }
  return half1 == half2;
} 
```

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2010-02-26T22:21:46.930

我会建立一个整数的奇偶校验表（如果是奇偶校验则为 0）（因此可以进行查找：D），但 gcc 不会让我制作这种大小的数组：

```
typedef unsigned int uint;

char parity_uint [UINT_MAX];
char parity_sint_shifted [((uint) INT_MAX) + ((uint) abs (INT_MIN))];
char* parity_sint = parity_sint_shifted - INT_MIN;

void build_parity_tables () {
    char parity = 0;
    unsigned int ui;
    for (ui = 1; ui <= UINT_MAX; ++ui) {
        parity_uint [ui - 1] = parity;
        parity = !parity;
    }
    parity = 0;
    int si;
    for (si = 1; si <= INT_MAX; ++si) {
        parity_sint [si - 1] = parity;
        parity = !parity;
    }
    parity = 1;
    for (si = -1; si >= INT_MIN; --si) {
        parity_sint [si] = parity;
        parity = !parity;
    }
}

char uparity (unsigned int n) {
    if (n == 0) {
        return 0;
    }
    return parity_uint [n - 1];
}

char sparity (int n) {
    if (n == 0) {
        return 0;
    }
    if (n < 0) {
        ++n;
    }
    return parity_sint [n - 1];
} 
```

因此，让我们改用偶数和奇数的数学定义。

一个整数 n 是即使存在一个整数 k 使得 n = 2k。

如果存在整数 k 使得 n = 2k + 1，则整数 n 是奇数。

这是它的代码：

```
char even (int n) {
    int k;
    for (k = INT_MIN; k <= INT_MAX; ++k) {
        if (n == 2 * k) {
            return 1;
        }
    }
    return 0;
}

char odd (int n) {
    int k;
    for (k = INT_MIN; k <= INT_MAX; ++k) {
        if (n == 2 * k + 1) {
            return 1;
        }
    }
    return 0;
} 
```

`int`让 C 整数表示给定 C 编译中的可能值。（请注意，C 整数是整数的子集。）

现在有人可能会担心，对于给定的 C 整数中的 n，对应的整数 k 可能不存在于 C 整数中。但是通过一点证明，可以证明对于所有整数 n，|n| <= |2n| (*)，其中 |n| 是“如果 n 为正，则为 n，否则为 -n”。换句话说，对于整数中的所有 n，至少有以下一项成立（实际上是情况（1 和 2）或情况（3 和 4），但我不会在这里证明）：

情况 1：n <= 2n。

情况 2：-n <= -2n。

情况 3：-n <= 2n。

情况 4：n <= -2n。

现在取 2k = n。（如果 n 是偶数，这样的 ak 确实存在，但我不会在这里证明它。如果 n 不是偶数，那么循环`even`无论如何都无法提前返回，所以没关系。）但这意味着 k < n if n不是 0 (*) 和事实（这里再次没有证明）对于所有 m，整数 2m = z 中的 z 意味着 z 不等于 m，给定 m 不是 0。在 n 为 0 的情况下，2*0 = 0所以 0 即使我们完成了（如果 n = 0 则 0 在 C 整数中，因为 n 在函数中的 C 整数中`even`，因此 k = 0 在 C 整数中）。因此，如果 n 是偶数，则对于 C 整数中的 n 存在这种 C 整数中的 ak。

一个类似的论点表明，如果 n 是奇数，则在 C 整数中存在 ak，使得 n = 2k + 1。

因此，这里介绍的函数`even`将`odd`适用于所有 C 整数。

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2008-10-02T05:02:06.367

```
// C#
bool isEven = ((i % 2) == 0); 
```

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2012-04-27T20:06:41.380

这是Java中的答案：

```
public static boolean isEven (Integer Number) {
    Pattern number = Pattern.compile("^.*?(?:[02]|8|(?:6|4))$");
    String num = Number.toString(Number);
    Boolean numbr = new Boolean(number.matcher(num).matches());
    return numbr.booleanValue();
} 
```

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2013-05-04T01:33:21.463

阅读这个相当有趣的讨论，我记得我有一个真实世界的时间敏感函数，可以在主循环中测试奇数和偶数。这是一个整数幂函数，发布在 StackOverflow 的其他地方，如下所示。基准非常令人惊讶。至少在这个现实世界的函数中，**模数更慢**，而且明显如此。**优胜者，需要 67% 的模时间，是一个 or (|) 方法**，并且在此页面的其他地方找不到。

```
static dbl  IntPow(dbl st0, int x)  {
    UINT OrMask = UINT_MAX -1;
    dbl  st1=1.0;
    if(0==x) return (dbl)1.0;

    while(1 != x)   {
        if (UINT_MAX == (x|OrMask)) {     //  if LSB is 1...    
        //if(x & 1) {
        //if(x % 2) {
            st1 *= st0;
        }    
        x = x >> 1;  // shift x right 1 bit...  
        st0 *= st0;
    }
    return st1 * st0;
} 
```

对于 3 亿次循环，基准时间如下。

3.962 | 和掩码方法

4.851 & 方法

5.850% 方法

对于那些认为理论或汇编语言列表来解决此类论点的人来说，这应该是一个警示故事。霍拉旭，天地间的事情比你的哲学梦想的还要多。

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2014-02-14T11:20:22.297

试试这个：`return (((a>>1)<<1) == a)`

例子：

```
a     =  10101011
-----------------
a>>1 --> 01010101
a<<1 --> 10101010

b     =  10011100
-----------------
b>>1 --> 01001110
b<<1 --> 10011100 
```

* * *

## 回答 #16

> 赞同：4
> 
> 时间：2016-10-14T10:18:01.123

[这是与@RocketRoy 就他的回答](https://stackoverflow.com/a/16369720/1488067)进行讨论的后续行动，但它可能对任何想要比较这些结果的人有用。

**tl;dr**从我所见，Roy 的方法 ( `(0xFFFFFFFF == (x | 0xFFFFFFFE)`) 并未完全优化`x & 1`为该`mod`方法，但实际上运行时间在所有情况下都应该相等。

[因此，首先我使用Compiler Explorer](https://godbolt.org/g/rkm3Se)比较了编译后的输出：

**测试的功能：**

```
int isOdd_mod(unsigned x) {
    return (x % 2);
}

int isOdd_and(unsigned x) {
    return (x & 1);
}

int isOdd_or(unsigned x) {
    return (0xFFFFFFFF == (x | 0xFFFFFFFE));
} 
```

**带有 -O3 的 CLang 3.9.0：**

```
isOdd_mod(unsigned int):                          # @isOdd_mod(unsigned int)
        and     edi, 1
        mov     eax, edi
        ret

isOdd_and(unsigned int):                          # @isOdd_and(unsigned int)
        and     edi, 1
        mov     eax, edi
        ret

isOdd_or(unsigned int):                           # @isOdd_or(unsigned int)
        and     edi, 1
        mov     eax, edi
        ret 
```

**带有 -O3 的 GCC 6.2：**

```
isOdd_mod(unsigned int):
        mov     eax, edi
        and     eax, 1
        ret

isOdd_and(unsigned int):
        mov     eax, edi
        and     eax, 1
        ret

isOdd_or(unsigned int):
        or      edi, -2
        xor     eax, eax
        cmp     edi, -1
        sete    al
        ret 
```

向 CLang 致敬，它意识到这三种情况在功能上是相同的。但是，Roy 的方法没有在 GCC 中进行优化，所以 YMMV。

与 Visual Studio 类似；检查这三个函数的反汇编版本 x64 (VS2015)，我可以看到比较部分对于“mod”和“and”情况是相等的，而对于 Roy 的“or”情况则稍大一些：

```
// x % 2
test bl,1  
je (some address) 

// x & 1
test bl,1  
je (some address) 

// Roy's bitwise or
mov eax,ebx  
or eax,0FFFFFFFEh  
cmp eax,0FFFFFFFFh  
jne (some address) 
```

但是，在运行实际基准测试以比较这三个选项（普通 mod、按位或、按位与）后，结果完全相等（同样，Visual Studio 2005 x86/x64，发布版本，未附加调试器）。

发布汇编使用and case 的`test`指令，而 Roy 的 case 使用了这种方法，但它被大量展开和优化，因此在实践中没有区别。`and``mod``cmp eax,0FFFFFFFFh`

我运行 20 次后的结果（i7 3610QM，Windows 10 电源计划设置为高性能）：

```
[测试：普通模式 2] 平均时间：689.29 毫秒（相对差异：+0.000%）
[测试：按位或]平均时间：689.63 毫秒（相对差异：+0.048%）
[测试：按位和]平均时间：687.80 毫秒（相对差异：-0.217%）

```

这些选项之间的差异小于 0.3%，因此很明显组装在所有情况下都是相等的。

如果有人想尝试，这里是代码，但需要注意的是我只在 Windows 上测试过它（检查定义的`#if LINUX`条件`get_time`并在需要时实现它，取自[这个答案](https://stackoverflow.com/a/2349941/1488067)）。

```
#include <stdio.h>

#if LINUX
#include <sys/time.h>
#include <sys/resource.h>
double get_time()
{
    struct timeval t;
    struct timezone tzp;
    gettimeofday(&t, &tzp);
    return t.tv_sec + t.tv_usec*1e-6;
}
#else
#include <windows.h>
double get_time()
{
    LARGE_INTEGER t, f;
    QueryPerformanceCounter(&t);
    QueryPerformanceFrequency(&f);
    return (double)t.QuadPart / (double)f.QuadPart * 1000.0;
}
#endif

#define NUM_ITERATIONS (1000 * 1000 * 1000)

// using a macro to avoid function call overhead
#define Benchmark(accumulator, name, operation) { \
    double startTime = get_time(); \
    double dummySum = 0.0, elapsed; \
    int x; \
    for (x = 0; x < NUM_ITERATIONS; x++) { \
        if (operation) dummySum += x; \
    } \
    elapsed = get_time() - startTime; \
    accumulator += elapsed; \
    if (dummySum > 2000) \
        printf("[Test: %-12s] %0.2f ms\r\n", name, elapsed); \
}

void DumpAverage(char *test, double totalTime, double reference)
{
    printf("[Test: %-12s] AVERAGE TIME: %0.2f ms (Relative diff.: %+6.3f%%)\r\n",
        test, totalTime, (totalTime - reference) / reference * 100.0);
}

int main(void)
{
    int repeats = 20;
    double runningTimes[3] = { 0 };
    int k;

    for (k = 0; k < repeats; k++) {
        printf("Run %d of %d...\r\n", k + 1, repeats);
        Benchmark(runningTimes[0], "Plain mod 2", (x % 2));
        Benchmark(runningTimes[1], "Bitwise or", (0xFFFFFFFF == (x | 0xFFFFFFFE)));
        Benchmark(runningTimes[2], "Bitwise and", (x & 1));
    }

    {
        double reference = runningTimes[0] / repeats;
        printf("\r\n");
        DumpAverage("Plain mod 2", runningTimes[0] / repeats, reference);
        DumpAverage("Bitwise or", runningTimes[1] / repeats, reference);
        DumpAverage("Bitwise and", runningTimes[2] / repeats, reference);
    }

    getchar();

    return 0;
} 
```

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2008-10-02T10:54:52.600

我知道这只是语法糖，**仅适用于.net**，但是扩展方法呢...

```
public static class RudiGroblerExtensions
{
    public static bool IsOdd(this int i)
    {
        return ((i % 2) != 0);
    }
} 
```

现在您可以执行以下操作

```
int i = 5;
if (i.IsOdd())
{
    // Do something...
} 
```

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2008-10-03T20:48:01.990

在“创意但令人困惑的类别”中，我提供：

```
int isOdd(int n) { return n ^ n * n ? isOdd(n * n) : n; } 
```

此主题的变体，特定于 Microsoft C++：

```
__declspec(naked) bool __fastcall isOdd(const int x)
{
    __asm
    {
        mov eax,ecx
        mul eax
        mul eax
        mul eax
        mul eax
        mul eax
        mul eax
        ret
    }
} 
```

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2008-10-02T05:53:51.063

按位方法取决于整数的内部表示。模数将在任何有模数运算符的地方工作。例如，某些系统实际上使用低级位进行标记（如动态语言），因此原始 x & 1 在这种情况下实际上不起作用。

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2008-10-02T15:03:11.757

IsOdd(int x) { 返回真；}

正确性证明 - 考虑所有正整数的集合，并假设有一组非奇数的非空整数。因为正整数是有序的，所以会有一个最小的非奇数，它本身就很奇数，所以很明显这个数字不可能在集合中。因此这个集合不能是非空的。重复负整数，除了寻找最大的非奇数。

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2008-10-02T15:08:27.453

便携的：

```
i % 2 ? odd : even; 
```

不可携带：

```
i & 1 ? odd : even;

i << (BITS_PER_INT - 1) ? odd : even; 
```

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2014-07-09T08:41:43.540

正如一些人所发布的，有很多方法可以做到这一点。根据[这个网站](http://cc.davelozinski.com/c-sharp/fastest-way-to-check-if-a-number-is-odd-or-even)，最快的方法是模数运算符：

```
if (x % 2 == 0)
               total += 1; //even number
        else
               total -= 1; //odd number 
```

然而，这里有一些[其他的代码是作者标记](http://cc.davelozinski.com/c-sharp/fastest-way-to-check-if-a-number-is-odd-or-even)的，它比上面的普通模运算运行得慢：

```
if ((x & 1) == 0)
               total += 1; //even number
        else
               total -= 1; //odd number

System.Math.DivRem((long)x, (long)2, out outvalue);
        if ( outvalue == 0)
               total += 1; //even number
        else
               total -= 1; //odd number

if (((x / 2) * 2) == x)
               total += 1; //even number
        else
               total -= 1; //odd number

if (((x >> 1) << 1) == x)
               total += 1; //even number
        else
               total -= 1; //odd number

        while (index > 1)
               index -= 2;
        if (index == 0)
               total += 1; //even number
        else
               total -= 1; //odd number

tempstr = x.ToString();
        index = tempstr.Length - 1;
        //this assumes base 10
        if (tempstr[index] == '0' || tempstr[index] == '2' || tempstr[index] == '4' || tempstr[index] == '6' || tempstr[index] == '8')
               total += 1; //even number
        else
               total -= 1; //odd number 
```

有多少人甚至知道[Math.System.DivRem](http://msdn.microsoft.com/en-us/library/system.math.divrem%28v=vs.110%29.aspx)方法，或者他们为什么要使用它？

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2008-10-13T15:50:31.747

```
int isOdd(int i){
  return(i % 2);
} 
```

完毕。

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2013-09-11T14:41:01.657

为了给我们这些在学习期间没有做太多布尔代数的人详细说明按位运算符方法，这里有一个解释。可能对 OP 没有多大用处，但我想弄清楚为什么 NUMBER & 1 有效。

请注意，就像上面有人回答的那样，表示负数的方式可能会阻止此方法的工作。事实上，它甚至可以破坏模运算符方法，因为每种语言在处理负操作数的方式上可能不同。

但是，如果您知道 NUMBER 将始终为正，则此方法效果很好。

正如上面的 Tooony 所指出的，只有二进制（和十进制）中的最后一个数字很重要。

布尔逻辑与门规定两个输入都必须为 1（或高电压）才能返回 1。

1 & 0 = 0。

0 & 1 = 0。

0 & 0 = 0。

1 & 1 = 1。

如果您将任何数字表示为二进制（我在这里使用了 8 位表示），奇数的末尾为 1，偶数的末尾为 0。

例如：

1 = 00000001

2 = 00000010

3 = 00000011

4 = 00000100

如果您取任何数字并使用按位与（Java 中的 &）它乘以 1，它将返回 00000001，= 1 表示该数字是奇数。或者 00000000 = 0，表示这个数是偶数。

例如

奇怪吗？

1 & 1 =

00000001 &

00000001 =

00000001 <— 奇数

2 & 1 =

00000010 &

00000001 =

00000000 <— 偶数

54 & 1 =

00000001 &

00110110 =

00000000 <— 偶数

这就是为什么它有效：

```
if(number & 1){

   //Number is odd

} else {

   //Number is even
} 
```

对不起，如果这是多余的。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2015-09-21T11:17:27.503

数字零奇偶校验 | 零[http://tinyurl.com/oexhr3k](http://tinyurl.com/oexhr3k)

Python 代码序列。

```
# defining function for number parity check
def parity(number):
    """Parity check function"""
    # if number is 0 (zero) return 'Zero neither ODD nor EVEN',
    # otherwise number&1, checking last bit, if 0, then EVEN, 
    # if 1, then ODD.
    return (number == 0 and 'Zero neither ODD nor EVEN') \
            or (number&1 and 'ODD' or 'EVEN')

# cycle trough numbers from 0 to 13 
for number in range(0, 14):
    print "{0:>4} : {0:08b} : {1:}".format(number, parity(number)) 
```

> **输出：**

```
 0 : 00000000 : Zero neither ODD nor EVEN
   1 : 00000001 : ODD
   2 : 00000010 : EVEN
   3 : 00000011 : ODD
   4 : 00000100 : EVEN
   5 : 00000101 : ODD
   6 : 00000110 : EVEN
   7 : 00000111 : ODD
   8 : 00001000 : EVEN
   9 : 00001001 : ODD
  10 : 00001010 : EVEN
  11 : 00001011 : ODD
  12 : 00001100 : EVEN
  13 : 00001101 : ODD 
```

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2017-08-01T08:33:28.490

```
I execute this code for ODD & EVEN:

#include <stdio.h>
int main()
{
    int number;
    printf("Enter an integer: ");
    scanf("%d", &number);

    if(number % 2 == 0)
        printf("%d is even.", number);
    else
        printf("%d is odd.", number);
} 
```

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2008-10-02T16:02:04.843

为了讨论...

您只需要查看任何给定数字中的最后一位数字，看看它是偶数还是奇数。有符号的、无符号的、正的、负的——在这方面它们都是一样的。所以这应该全面工作： -

```
void tellMeIfItIsAnOddNumberPlease(int iToTest){
  int iLastDigit;
  iLastDigit = iToTest - (iToTest / 10 * 10);
  if (iLastDigit % 2 == 0){
    printf("The number %d is even!\n", iToTest);
  } else {
    printf("The number %d is odd!\n", iToTest);
  }
} 
```

这里的关键在第三行代码中，除法运算符执行整数除法，因此结果缺少结果的小数部分。因此，例如 222 / 10 将给出 22 作为结果。然后再乘以 10，得到 220。从原来的 222 中减去它，最后得到 2，这与原始数字中的最后一位数字相同。;-) 括号是为了提醒我们计算的顺序。首先进行除法和乘法运算，然后从原始数字中减去结果。我们可以将它们排除在外，因为除法和乘法的优先级高于减法，但这给了我们“更具可读性”的代码。

如果我们愿意，我们可以让它完全不可读。对于现代编译器来说，这没有任何区别：-

```
printf("%d%s\n",iToTest,0==(iToTest-iToTest/10*10)%2?" is even":" is odd"); 
```

但这会使代码在未来更难维护。想象一下，您想将奇数的文本更改为“不是偶数”。然后其他人稍后想要找出您所做的更改并执行 svn diff 或类似...

如果您不担心可移植性，而更关心速度，您可以看看最不重要的位。如果该位设置为 1，则为奇数，如果为 0，则为偶数。在小端系统上，比如英特尔的 x86 架构，它会是这样的：-

```
if (iToTest & 1) {
  // Even
} else {
  // Odd
} 
```

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2008-10-03T11:12:14.673

如果您想提高效率，请使用按位运算符 ( `x & 1`)，但如果您想可读，请使用模 2 ( `x % 2`)

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2015-06-08T04:05:06.110

检查偶数或奇数是一项简单的任务。

> 我们知道任何能被 2 整除的数都是偶数，否则是奇数。

我们只需要检查任何数字的可分性，并且我们使用`%`运算符来检查可分性

**使用 if else 检查奇数**

```
if(num%2 ==0)  
{
    printf("Even");
}
else
{
    printf("Odd");
} 
```

[使用 if else 检查偶数或奇数的 C 程序](http://codeforwin.org/2015/05/c-program-to-check-even-odd.html)

**使用条件/三元运算符**

```
(num%2 ==0) printf("Even") : printf("Odd"); 
```

[使用条件运算符检查偶数或奇数的 C 程序](http://codeforwin.org/2015/06/c-program-to-check-even-or-odd-using-conditional-operator.html)。

**使用按位运算符**

```
if(num & 1)  
{
    printf("Odd");
}
else 
{
    printf("Even");
} 
```

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2018-04-28T03:55:58.467

## **+66%**更快 >`!(i%2) / i%2 == 0`

```
int isOdd(int n)
{
    return n & 1;
} 
```

代码检查整数的最后一位是否为二进制中的**1**

## 解释

```
Binary  :   Decimal
-------------------
0000    =   0
0001    =   1
0010    =   2
0011    =   3
0100    =   4
0101    =   5
0110    =   6
0111    =   7
1000    =   8
1001    =   9
and so on... 
```

> **请注意，对于****奇数**，最右边的**位**始终为 1 。

 ****&**按位与运算符检查**返回**行中最右边的位是否为 1

## 认为它是真假

当我们将**n**与**1**进行比较时，这意味着`0001`二进制（零的数量无关紧要）。
那么让我们想象一下，我们有一个大小为 1 字节的整数**n 。**

它将由 8 位 / 8 二进制数字表示。

如果 int **n**是**7**并且我们将它与**1**进行比较，就像

```
7 (1-byte int)|    0  0  0  0    0  1  1  1
       &
1 (1-byte int)|    0  0  0  0    0  0  0  1
********************************************
Result        |    F  F  F  F    F  F  F  T 
```

其中**F**代表假，**T**代表真。

> 如果它们都是真的，它只**比较最右边的位。**因此，自动`7 & 1`为**真**。

## 如果我想检查最右边的位怎么办？

只需将其更改`n & 1`为`n & 2`2`0010`在二进制中表示，依此类推。

如果您是按位运算的初学者，我建议使用十六进制表示法
`return n & 1;`>> `return n & 0x01;`。

* * *

## 回答 #31

> 赞同：-1
> 
> 时间：2016-05-16T07:06:20.607

模运算符 '%' 可用于检查一个数是奇数还是偶数。即当一个数除以 2 时，如果余数为 0，则其为偶数，否则为奇数。

```
#include <stdio.h>
int main()
{
    int n;//using modulus operator
    scanf("%d",&n);//take input n from STDIN 
    printf("%s",n%2==0?"Even":"Odd");//prints Even/Odd depending on n to STDOUT
    return 0;
} 
```

但是使用位操作比上面的方法快得多，所以如果你取一个数字并在逻辑上应用“&”，如果答案是 1 那么它的偶数是奇数。基本上我们必须检查最后一位二进制中的数字 n。如果最后一位为 0，则 n 为偶数，否则为奇数。

例如：假设 N = 15 ，二进制 N = 1111 ，现在我们将其与 1

```
 1111
    0001
   &-----
    0001 
```

由于结果为 1，因此数字 N=15 为奇数。

同样，假设 N = 8 ，二进制 N = 1000 ，现在我们将其与 1

```
 1000
    0001
   &-----
    0000 
```

由于结果为 0，因此数字 N=8 为偶数。

```
#include <stdio.h>

int main()
{
    int n;//using AND operator
    scanf("%d",&n);//take input n from STDIN 
    printf("%s",n&1?"Odd":"Even");//prints Even/Odd depending on n to STDOUT
    return 0;
} 
```

# visual-c++ - 致命错误 C1083：无法打开包含文件：'tiffio.h'：没有此类文件或目录 VC++ 2008

> ID：160938
> 
> 赞同：1
> 
> 时间：2008-10-02T05:01:16.103
> 
> 标签：visual-c++

当我尝试编译包含`tiffio.h`标头的应用程序时出现此错误。

作为记录，`tiffio.h`位于：

`C:\Program Files\GnuWin32\include`

我*已*将该目录设置为包含在“项目”和“解决方案”Visual C++ 目录中，如图所示。

我错过了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-02T05:07:23.077

在图像中的“选项”对话框中 - 将“显示目录”从“可执行文件”更改为“包含文件”，然后在此处添加包含路径。

# visual-studio-2008 - 如何判断 VS2008 上是否安装了 SP1？

> ID：160948
> 
> 赞同：22
> 
> 时间：2008-10-02T05:02:50.980
> 
> 标签：visual-studio-2008, installation

如何判断 VS2008 上是否安装了 SP1？例如，如果我在同事的机器上工作 - 我如何判断他/她是否安装了 VS2008 的 SP1？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-10-02T05:05:54.093

在 Help->About 中，您可以查看已安装的产品。你应该看到类似的东西

> Microsoft Visual Studio Team System 2008 Team Suite - ENU Service Pack 1 (KB945140) KB945140

在条目列表中。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2010-05-30T17:23:29.113

打开 Visual Studio 2008 并单击帮助>关于。如果您确实安装了 MS VS SP1，左上角应如下所示：

Microsoft Visual Studio 2008 版本 9.0.30729.1 SP

右上角说明了您拥有的 Microsoft .NET Framework 版本，并可能显示它已安装 SP 1，但这并不意味着您已安装 Visual Studio SP 1。

这是图片的链接：http: [//quick-page.net/46ad2310](http://quick-page.net/46ad2310)

希望这可以帮助！偶像破坏者

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-01-12T11:29:53.500

您也可以通过在此处查看注册表来判断

HKEY_LOCAL_MACHINE\Software\Microsoft\DevDiv[ProductFamily]\Servicing\9.0\

然后找到一个名为“SP”或“SPIndex”的属性。值 1 表示已安装，0 表示未安装。

[在这里找到了提示](http://younsi.blogspot.com/2008/12/how-to-detect-if-visual-studio-2008-sp1.html)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-02T05:34:36.130

它还在程序图标上的白框中放置了一个小“9”。（当然，可能不可靠）

# ruby-on-rails - Rails 控制台不会自动为第二个数据库加载模型

> ID：160954
> 
> 赞同：1
> 
> 时间：2008-10-02T05:06:06.730
> 
> 标签：ruby-on-rails, ruby, console, require

我有一个 Rails 项目，它有一个用于实际应用程序的 Postgres 数据库，但需要从 Oracle 数据库中提取大量数据。

database.yml 看起来像

```
development:
  adapter: postgresql
  database: blah blah
  ...

oracle_db:
  adapter: oracle
  database: blah blah 
```

我的模型源自 Oracle DB 上的数据，看起来像

```
class LegacyDataClass < ActiveRecord::Base

  establish_connection "oracle_db"

  set_primary_key :legacy_data_class_id

  has_one :other_legacy_class, :foreign key => :other_legacy_class_id_with_funny_column_name

 ...
end 
```

现在，根据习惯，我经常通过编写一些代码然后在 Rails 控制台中玩来进行很多早期开发（这是早期开发）。例如，在定义了 LegacyDataClass 的所有关联之后，我将开始尝试类似`a = LegacyDataClass.find(:first); puts a.some_association.name`. 出乎意料的是，这会因 LegacyDataClass 尚未加载而死。

然后我可以`require 'LegacyDataClass'`解决问题，直到我需要`reload!`，它实际上不会重新加载它，或者直到我打开控制台的新实例。

因此问题：

*   **为什么**会这样？显然，我不理解 Rails 的一些魔力。
*   什么是方便的 Rails**解决方法**？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-02T05:24:56.700

我相信这可能与您的型号名称有关，而不是您的连接。Rails 的约定是模型类名是 CamelCase，而它们所在的文件是小写+下划线。

因此，“LegacyModel”类应该在`models/legacy_model.rb`. 您的 about 声明`"require 'LegacyDataClass'"`表明情况并非如此，因此 Rails 不知道如何自动加载该模型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-04T03:22:50.770

我为工作中的应用程序编写了一些东西，该应用程序在运行时处理与其他数据库的连接，它可能会有所帮助。

[http://github.com/cherring/connection_ninja](http://github.com/cherring/connection_ninja)

# c - 错误：初始化元素在加载时不可计算

> ID：160960
> 
> 赞同：14
> 
> 时间：2008-10-02T05:08:39.063
> 
> 标签：c, gcc, ansi-c, gcc-pedantic

我有一个采用结构的函数，我试图将其变量存储在数组中：

```
int detect_prm(Param prm) {
  int prm_arr[] = {prm.field1, prm.field2, prm.field3};

  return 0;
} 
```

但是`gcc -Wall -ansi -pedantic-errors -Werror`我收到以下错误：

> 初始化元素在加载时不可计算

在我看来很好，有什么问题？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-02T05:39:16.743

迈克的回答是绝对正确的。

但是，如果您能够使用 GNU C 扩展，或者改用更新更好的 C99 标准（使用`--std=c99`选项），那么像这样的初始化程序是完全合法的。C99 标准已经推出了 9 年，大多数 C 编译器都很好地支持它……尤其是这个特性。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-10-02T05:13:50.690

这在 C 中是非法的。初始化列表必须是常量编译时表达式。请改为执行以下操作：

```
int prm_arr[3];

prm_arr[0] = prm.field1;
prm_arr[1] = prm.field2;
prm_arr[2] = prm.field3; 
```

# backwards-compatibility - 您如何平衡向后兼容和创新的冲突需求？

> ID：160968
> 
> 赞同：11
> 
> 时间：2008-10-02T05:13:13.360
> 
> 标签：backwards-compatibility, innovation

我在一个同时具有 GUI（图形）和 API（脚本）界面的应用程序上工作。我们的产品拥有非常庞大的安装基础。许多客户投入了大量时间和精力来编写使用我们产品的脚本。

在我们所有的设计和实现中，我们（可以理解）对保持 100%**向后兼容性**有非常严格的要求。当我们引入新的软件版本时，之前运行的脚本必须继续以完全相同的方式运行，无需任何修改。

不幸的是，这个要求有时会束缚我们的双手，因为它确实限制了我们**创新**和想出新的更好的做事方式的能力。

例如，我们可能会想出一种更好（并且更有用）的方法来完成已经可能完成的任务。最好将这种更好的方式设为默认方式，但我们不能这样做，因为它可能具有向后兼容性的含义。所以我们坚持将新的（更好的）方式作为一种模式，用户必须“打开”才能使用它。除非他们阅读文档或在线帮助（许多客户不这样做），否则此新功能将永远隐藏。

我知道 Windows Vista 刚问世时惹恼了很多人，因为所有的软件和外围设备都无法在它上面运行，即使它们在 XP 上运行也是如此。因此，它收到了非常糟糕的接待。但你可以看到，微软也成功地在 Vista 中进行了一些伟大的创新，但代价是为许多用户提供了向后兼容性。他们冒险了。它得到回报了吗？他们做出了正确的决定吗？我想只有时间会证明一切。

您是否发现自己在创新和向后兼容性的冲突需求之间取得平衡？你如何处理杂耍表演？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-02T05:37:21.337

就我的编程经验而言，如果我要从根本上改变一些会阻止过去传入数据被正确使用的东西，我需要为旧数据创建一个抽象层，可以将其转换为在新数据中使用格式。

基本上我将“改进”方式设置为默认值，并确保通过转换器它可以读取旧格式的数据，但将数据保存或存储为新格式。

我认为这里最重要的是测试，测试，测试。向后兼容性不应阻碍向前发展。

那只是我的2c

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-02T06:01:19.670

将开发分为两个分支，一个维护向后兼容性，一个用于新的主要版本，您可以清楚地表明向后兼容性正在被破坏。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-02T09:45:28.697

您需要问的关键问题是客户是否想要/需要这种“改进”，即使您认为它是您的客户可能不想要的。一旦建立了某种做事方式，改变工作流程是一项非常“昂贵”的操作。根据用户的计算机熟练程度，可能需要很长时间才能适应 UI 的变化。

如果您正在与客户打交道，为了创新而创新并不总是一件好事，因为您开发这些改进可能会很有趣。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-05T22:09:42.877

你可以寻找创新的方法来保持向后兼容性。

# java - 将方法名称作为字符串给出时，如何调用 Java 方法？

> ID：160970
> 
> 赞同：736
> 
> 时间：2008-10-02T05:15:43.430
> 
> 标签：java, reflection, invoke

如果我有两个变量：

```
Object obj;
String methodName = "getName"; 
```

在不知道 的类的情况下`obj`，如何调用 on 标识的方法`methodName`？

被调用的方法没有参数和`String`返回值。它*是 Java bean 的吸气剂*。

* * *

## 回答 #1

> 赞同：1043
> 
> 时间：2008-10-02T05:30:02.057

从臀部编码，它会是这样的：

```
java.lang.reflect.Method method;
try {
  method = obj.getClass().getMethod(methodName, param1.class, param2.class, ..);
} catch (SecurityException e) { ... }
  catch (NoSuchMethodException e) { ... } 
```

参数标识了您需要的非常具体的方法（如果有几个重载可用，如果方法没有参数，则只给`methodName`）。

然后你通过调用调用该方法

```
try {
  method.invoke(obj, arg1, arg2,...);
} catch (IllegalArgumentException e) { ... }
  catch (IllegalAccessException e) { ... }
  catch (InvocationTargetException e) { ... } 
```

同样，`.invoke`如果您没有任何参数，请忽略 中的参数。但是，是的。阅读[Java 反射](http://java.sun.com/docs/books/tutorial/reflect/index.html)

* * *

## 回答 #2

> 赞同：217
> 
> 时间：2008-10-02T05:21:20.093

使用反射中的[方法调用](http://java.sun.com/docs/books/tutorial/reflect/member/methodInvocation.html)：

```
Class<?> c = Class.forName("class name");
Method method = c.getDeclaredMethod("method name", parameterTypes);
method.invoke(objectToInvokeOn, params); 
```

在哪里：

*   `"class name"`是类的名称
*   `objectToInvokeOn`是 Object 类型，并且是您要在其上调用方法的对象
*   `"method name"`是您要调用的方法的名称
*   `parameterTypes`是类型`Class[]`并声明方法采用的参数
*   `params`是类型`Object[]`并声明要传递给方法的参数

* * *

## 回答 #3

> 赞同：120
> 
> 时间：2015-06-05T16:31:14.750

对于那些想要 Java 7 中直接代码示例的人：

**`Dog`班级：**

```
package com.mypackage.bean;

public class Dog {
    private String name;
    private int age;

    public Dog() {
        // empty constructor
    }

    public Dog(String name, int age) {
        this.name = name;
        this.age = age;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public int getAge() {
        return age;
    }

    public void setAge(int age) {
        this.age = age;
    }

    public void printDog(String name, int age) {
        System.out.println(name + " is " + age + " year(s) old.");
    }
} 
```

**`ReflectionDemo`班级：**

```
package com.mypackage.demo;

import java.lang.reflect.*;

public class ReflectionDemo {

    public static void main(String[] args) throws Exception {
        String dogClassName = "com.mypackage.bean.Dog";
        Class<?> dogClass = Class.forName(dogClassName); // convert string classname to class
        Object dog = dogClass.newInstance(); // invoke empty constructor

        String methodName = "";

        // with single parameter, return void
        methodName = "setName";
        Method setNameMethod = dog.getClass().getMethod(methodName, String.class);
        setNameMethod.invoke(dog, "Mishka"); // pass arg

        // without parameters, return string
        methodName = "getName";
        Method getNameMethod = dog.getClass().getMethod(methodName);
        String name = (String) getNameMethod.invoke(dog); // explicit cast

        // with multiple parameters
        methodName = "printDog";
        Class<?>[] paramTypes = {String.class, int.class};
        Method printDogMethod = dog.getClass().getMethod(methodName, paramTypes);
        printDogMethod.invoke(dog, name, 3); // pass args
    }
} 
```

**输出：** `Mishka is 3 year(s) old.`

* * *

您可以通过以下方式调用带有参数的构造函数：

```
Constructor<?> dogConstructor = dogClass.getConstructor(String.class, int.class);
Object dog = dogConstructor.newInstance("Hachiko", 10); 
```

或者，您可以删除

```
String dogClassName = "com.mypackage.bean.Dog";
Class<?> dogClass = Class.forName(dogClassName);
Object dog = dogClass.newInstance(); 
```

做

```
Dog dog = new Dog();

Method method = Dog.class.getMethod(methodName, ...);
method.invoke(dog, ...); 
```

**推荐阅读：** [创建新的类实例](https://docs.oracle.com/javase/tutorial/reflect/member/ctorInstance.html)

* * *

## 回答 #4

> 赞同：56
> 
> 时间：2008-10-02T05:33:31.657

可以像这样调用该方法。还有更多的可能性（检查反射api），但这是最简单的一种：

```
import java.lang.reflect.InvocationTargetException;
import java.lang.reflect.Method;

import org.junit.Assert;
import org.junit.Test;

public class ReflectionTest {

    private String methodName = "length";
    private String valueObject = "Some object";

    @Test
    public void testGetMethod() throws SecurityException, NoSuchMethodException, IllegalArgumentException,
            IllegalAccessException, InvocationTargetException {
        Method m = valueObject.getClass().getMethod(methodName, new Class[] {});
        Object ret = m.invoke(valueObject, new Object[] {});
        Assert.assertEquals(11, ret);
    }

} 
```

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2008-10-02T14:08:40.903

首先，不要。避免这种代码。它往往是非常糟糕的代码并且也不安全（参见[Java 编程语言的安全编码指南，版本 2.0 的](http://java.sun.com/security/seccodeguide.html)第 6 节）。

~~如果你必须这样做，最好使用 java.beans 而不是反射。Beans 包裹反射允许相对安全和常规的访问。~~

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2008-10-02T05:51:12.597

为了完成我同事的回答，您可能需要密切关注：

*   静态或实例调用（在一种情况下，您不需要类的实例，在另一种情况下，您可能需要依赖可能存在或不存在的**现有默认构造函数）**
*   公共或非公共方法调用（对于后者，**您需要在 doPrivileged 块内的方法上调用 setAccessible**，其他[findbug 不会高兴](http://findbugs.sourceforge.net/bugDescriptions.html#DP_DO_INSIDE_DO_PRIVILEGED)）
*   如果你想抛出许多 java 系统异常，封装成一个更易于管理的应用异常（因此下面代码中的 CCException）

这是一个旧的 java1.4 代码，它考虑了这些要点：

```
/**
 * Allow for instance call, avoiding certain class circular dependencies. <br />
 * Calls even private method if java Security allows it.
 * @param aninstance instance on which method is invoked (if null, static call)
 * @param classname name of the class containing the method 
 * (can be null - ignored, actually - if instance if provided, must be provided if static call)
 * @param amethodname name of the method to invoke
 * @param parameterTypes array of Classes
 * @param parameters array of Object
 * @return resulting Object
 * @throws CCException if any problem
 */
public static Object reflectionCall(final Object aninstance, final String classname, final String amethodname, final Class[] parameterTypes, final Object[] parameters) throws CCException
{
    Object res;// = null;
    try {
        Class aclass;// = null;
        if(aninstance == null)
        {
            aclass = Class.forName(classname);
        }
        else
        {
            aclass = aninstance.getClass();
        }
        //Class[] parameterTypes = new Class[]{String[].class};
    final Method amethod = aclass.getDeclaredMethod(amethodname, parameterTypes);
        AccessController.doPrivileged(new PrivilegedAction() {
    public Object run() {
                amethod.setAccessible(true);
                return null; // nothing to return
            }
        });
        res = amethod.invoke(aninstance, parameters);
    } catch (final ClassNotFoundException e) {
        throw new CCException.Error(PROBLEM_TO_ACCESS+classname+CLASS, e);
    } catch (final SecurityException e) {
        throw new CCException.Error(PROBLEM_TO_ACCESS+classname+GenericConstants.HASH_DIESE+ amethodname + METHOD_SECURITY_ISSUE, e);
    } catch (final NoSuchMethodException e) {
        throw new CCException.Error(PROBLEM_TO_ACCESS+classname+GenericConstants.HASH_DIESE+ amethodname + METHOD_NOT_FOUND, e);
    } catch (final IllegalArgumentException e) {
        throw new CCException.Error(PROBLEM_TO_ACCESS+classname+GenericConstants.HASH_DIESE+ amethodname + METHOD_ILLEGAL_ARGUMENTS+String.valueOf(parameters)+GenericConstants.CLOSING_ROUND_BRACKET, e);
    } catch (final IllegalAccessException e) {
        throw new CCException.Error(PROBLEM_TO_ACCESS+classname+GenericConstants.HASH_DIESE+ amethodname + METHOD_ACCESS_RESTRICTION, e);
    } catch (final InvocationTargetException e) {
    throw new CCException.Error(PROBLEM_TO_ACCESS+classname+GenericConstants.HASH_DIESE+ amethodname + METHOD_INVOCATION_ISSUE, e);
    } 
    return res;
} 
```

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2008-10-02T05:22:24.803

```
Object obj;

Method method = obj.getClass().getMethod("methodName", null);

method.invoke(obj, null); 
```

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2013-04-30T05:46:18.477

```
//Step1 - Using string funClass to convert to class
String funClass = "package.myclass";
Class c = Class.forName(funClass);

//Step2 - instantiate an object of the class abov
Object o = c.newInstance();
//Prepare array of the arguments that your function accepts, lets say only one string here
Class[] paramTypes = new Class[1];
paramTypes[0]=String.class;
String methodName = "mymethod";
//Instantiate an object of type method that returns you method name
 Method m = c.getDeclaredMethod(methodName, paramTypes);
//invoke method with actual params
m.invoke(o, "testparam"); 
```

* * *

## 回答 #9

> 赞同：11
> 
> 时间：2020-01-29T14:44:23.950

## 索引（更快）

您可以使用`FunctionalInterface`将方法保存在容器中以对其进行索引。您可以使用数组容器通过数字调用它们或使用哈希图通过字符串调用它们。**通过这个技巧，您可以索引您的方法以更快**地动态调用它们。

```
@FunctionalInterface
public interface Method {
    double execute(int number);
}

public class ShapeArea {
    private final static double PI = 3.14;

    private Method[] methods = {
        this::square,
        this::circle
    };

    private double square(int number) {
        return number * number;
    }

    private double circle(int number) {
        return PI * number * number;
    }

    public double run(int methodIndex, int number) {
        return methods[methodIndex].execute(number);
    }
} 
```

## Lambda 语法

您还可以使用 lambda 语法：

```
public class ShapeArea {
    private final static double PI = 3.14;

    private Method[] methods = {
        number -> {
            return number * number;
        },
        number -> {
            return PI * number * number;
        },
    };

    public double run(int methodIndex, int number) {
        return methods[methodIndex].execute(number);
    }
} 
```

* * *

## 回答 #10

> 赞同：10
> 
> 时间：2017-02-28T22:02:59.303

如果您多次调用，您可以使用 Java 7 中引入的新方法句柄。这里我们为您的方法返回一个字符串：

```
Object obj = new Point( 100, 200 );
String methodName = "toString";  
Class<String> resultType = String.class;

MethodType mt = MethodType.methodType( resultType );
MethodHandle methodHandle = MethodHandles.lookup().findVirtual( obj.getClass(), methodName, mt );
String result = resultType.cast( methodHandle.invoke( obj ) );

System.out.println( result );  // java.awt.Point[x=100,y=200] 
```

* * *

## 回答 #11

> 赞同：8
> 
> 时间：2008-10-02T05:22:24.023

这听起来像是可以使用 Java Reflection 包实现的。

[http://java.sun.com/developer/technicalArticles/ALT/Reflection/index.html](http://java.sun.com/developer/technicalArticles/ALT/Reflection/index.html)

特别是在**按名称调用方法下：**

导入 java.lang.reflect.*；

```
public class method2 {
  public int add(int a, int b)
  {
     return a + b;
  }

  public static void main(String args[])
  {
     try {
       Class cls = Class.forName("method2");
       Class partypes[] = new Class[2];
        partypes[0] = Integer.TYPE;
        partypes[1] = Integer.TYPE;
        Method meth = cls.getMethod(
          "add", partypes);
        method2 methobj = new method2();
        Object arglist[] = new Object[2];
        arglist[0] = new Integer(37);
        arglist[1] = new Integer(47);
        Object retobj 
          = meth.invoke(methobj, arglist);
        Integer retval = (Integer)retobj;
        System.out.println(retval.intValue());
     }
     catch (Throwable e) {
        System.err.println(e);
     }
  }
} 
```

* * *

## 回答 #12

> 赞同：8
> 
> 时间：2016-09-20T19:02:19.810

```
try {
    YourClass yourClass = new YourClass();
    Method method = YourClass.class.getMethod("yourMethodName", ParameterOfThisMethod.class);
    method.invoke(yourClass, parameter);
} catch (Exception e) {
    e.printStackTrace();
} 
```

* * *

## 回答 #13

> 赞同：8
> 
> 时间：2019-02-26T10:32:47.847

以下是即用型方法：

**要调用不带参数的方法：**

```
public static void callMethodByName(Object object, String methodName) throws IllegalAccessException, InvocationTargetException, NoSuchMethodException {
    object.getClass().getDeclaredMethod(methodName).invoke(object);
} 
```

**使用参数调用方法：**

```
 public static void callMethodByName(Object object, String methodName, int i, String s) throws IllegalAccessException, InvocationTargetException, NoSuchMethodException {
        object.getClass().getDeclaredMethod(methodName, int.class, String.class).invoke(object, i, s);
    } 
```

使用上述方法如下：

```
package practice;

import java.io.IOException;
import java.lang.reflect.InvocationTargetException;

public class MethodInvoke {

    public static void main(String[] args) throws ClassNotFoundException, NoSuchMethodException, SecurityException, IllegalAccessException, IllegalArgumentException, InvocationTargetException, IOException {
        String methodName1 = "methodA";
        String methodName2 = "methodB";
        MethodInvoke object = new MethodInvoke();
        callMethodByName(object, methodName1);
        callMethodByName(object, methodName2, 1, "Test");
    }

    public static void callMethodByName(Object object, String methodName) throws IllegalAccessException, InvocationTargetException, NoSuchMethodException {
        object.getClass().getDeclaredMethod(methodName).invoke(object);
    }

    public static void callMethodByName(Object object, String methodName, int i, String s) throws IllegalAccessException, InvocationTargetException, NoSuchMethodException {
        object.getClass().getDeclaredMethod(methodName, int.class, String.class).invoke(object, i, s);
    }

    void methodA() {
        System.out.println("Method A");
    }

    void methodB(int i, String s) {
        System.out.println("Method B: "+"\n\tParam1 - "+i+"\n\tParam 2 - "+s);
    }
} 
```

**输出：**

```
方法A  
方法B：  
	参数 1 - 1  
	参数 2 - 测试
```

* * *

## 回答 #14

> 赞同：6
> 
> 时间：2016-05-20T06:31:23.417

请参考以下代码可能对您有所帮助。

```
public static Method method[];
public static MethodClass obj;
public static String testMethod="A";

public static void main(String args[]) 
{
    obj=new MethodClass();
    method=obj.getClass().getMethods();
    try
    {
        for(int i=0;i<method.length;i++)
        {
            String name=method[i].getName();
            if(name==testMethod)
            {   
                method[i].invoke(name,"Test Parameters of A");
            }
        }
    }
    catch(Exception ex)
    {
        System.out.println(ex.getMessage());
    }
} 
```

谢谢....

* * *

## 回答 #15

> 赞同：6
> 
> 时间：2016-12-27T05:10:10.227

```
Method method = someVariable.class.getMethod(SomeClass);
String status = (String) method.invoke(method); 
```

`SomeClass`是类并且`someVariable`是一个变量。

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2017-07-30T02:20:08.277

### 学生.java

```
class Student{
    int rollno;
    String name;

    void m1(int x,int y){
        System.out.println("add is" +(x+y));
    }

    private void m3(String name){
        this.name=name;
        System.out.println("danger yappa:"+name);
    }
    void m4(){
        System.out.println("This is m4");
    }
} 
```

### StudentTest.java

```
import java.lang.reflect.Method;
public class StudentTest{

     public static void main(String[] args){

        try{

            Class cls=Student.class;

            Student s=(Student)cls.newInstance();

            String x="kichha";
            Method mm3=cls.getDeclaredMethod("m3",String.class);
            mm3.setAccessible(true);
            mm3.invoke(s,x);

            Method mm1=cls.getDeclaredMethod("m1",int.class,int.class);
            mm1.invoke(s,10,20);

        }
        catch(Exception e){
            e.printStackTrace();
        }
     }
} 
```

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2015-07-09T14:51:37.237

你应该使用反射——初始化一个类对象，然后是这个类中的一个方法，然后在一个带有*可选*参数的对象上调用这个方法。请记住将以下代码段包装在*try-catch*块中

希望能帮助到你！

```
Class<?> aClass = Class.forName(FULLY_QUALIFIED_CLASS_NAME);
Method method = aClass.getMethod(methodName, YOUR_PARAM_1.class, YOUR_PARAM_2.class);
method.invoke(OBJECT_TO_RUN_METHOD_ON, YOUR_PARAM_1, YOUR_PARAM_2); 
```

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2016-11-23T07:32:23.247

使用`import java.lang.reflect.*;`

```
public static Object launchProcess(String className, String methodName, Class<?>[] argsTypes, Object[] methodArgs)
        throws Exception {

    Class<?> processClass = Class.forName(className); // convert string classname to class
    Object process = processClass.newInstance(); // invoke empty constructor

    Method aMethod = process.getClass().getMethod(methodName,argsTypes);
    Object res = aMethod.invoke(process, methodArgs); // pass arg
    return(res);
} 
```

下面是你如何使用它：

```
String className = "com.example.helloworld";
String methodName = "print";
Class<?>[] argsTypes = {String.class,  String.class};
Object[] methArgs = { "hello", "world" };   
launchProcess(className, methodName, argsTypes, methArgs); 
```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2015-10-09T18:29:01.543

这对我来说很好：

```
public class MethodInvokerClass {
    public static void main(String[] args) throws NoSuchMethodException, SecurityException, IllegalAccessException, IllegalArgumentException, ClassNotFoundException, InvocationTargetException, InstantiationException {
        Class c = Class.forName(MethodInvokerClass.class.getName());
        Object o = c.newInstance();
        Class[] paramTypes = new Class[1];
        paramTypes[0]=String.class;
        String methodName = "countWord";
         Method m = c.getDeclaredMethod(methodName, paramTypes);
         m.invoke(o, "testparam");
}
public void countWord(String input){
    System.out.println("My input "+input);
} 
```

}

输出：

`My input testparam`

我可以通过将其名称传递给另一个方法（如 main）来调用该方法。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2021-01-25T02:08:36.110

对于那些从非静态方法调用同一类中的方法的人，请参见以下代码：

```
class Person {
    public void method1() {
        try {
            Method m2 = this.getClass().getDeclaredMethod("method2");
            m1.invoke(this);
        } catch (NoSuchMethodException e) {
            e.printStackTrace();
        } catch (IllegalAccessException e) {
            e.printStackTrace();
        } catch (InvocationTargetException e) {
            e.printStackTrace();
        }
    }

    public void method2() {
        // Do something
    }

} 
```

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2021-08-10T01:58:46.367

假设您从同一个类中的静态方法调用静态方法。为此，您可以对以下代码进行采样。

```
class MainClass
{
  public static int foo()
  {
    return 123;
  }

  public static void main(String[] args)
  {
    Method method = MainClass.class.getMethod("foo");
    int result = (int) method.invoke(null); // answer evaluates to 123
  }
} 
```

解释一下，由于我们不希望在这里执行真正的面向对象编程，因此避免创建不必要的对象，我们将改为利用`class`属性来调用`getMethod()`.

然后我们将传入`null`该`invoke()`方法，因为我们没有对象可以执行此操作。

最后，因为我们程序员知道我们需要一个整数，所以我们显式地将`invoke()`调用的返回值转换为一个整数。

现在您可能想知道：“用 Java 进行所有这些非面向对象的编程有什么意义？”

我的用例是用 Java 解决 Project Euler 问题。我有一个包含所有解决方案的 Java 源文件，我想传入命令行参数以确定要运行哪个 Project Euler 问题。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2020-02-02T13:17:12.630

使用[jooR](https://github.com/jOOQ/jOOR)仅仅是：

```
on(obj).call(methodName /*params*/).get() 
```

这是一个更详细的示例：

```
public class TestClass {

    public int add(int a, int b) { return a + b; }
    private int mul(int a, int b) { return a * b; }
    static int sub(int a, int b) { return a - b; }

}

import static org.joor.Reflect.*;

public class JoorTest {

    public static void main(String[] args) {
        int add = on(new TestClass()).call("add", 1, 2).get(); // public
        int mul = on(new TestClass()).call("mul", 3, 4).get(); // private
        int sub = on(TestClass.class).call("sub", 6, 5).get(); // static
        System.out.println(add + ", " + mul + ", " + sub);
    }
} 
```

这打印：

> 3、12、1

* * *

## 回答 #23

> 赞同：-9
> 
> 时间：2010-06-16T20:21:32.963

对我来说，一个非常简单且万无一失的方法是简单地制作一个方法调用者方法，如下所示：

```
public static object methodCaller(String methodName)
{
    if(methodName.equals("getName"))
        return className.getName();
} 
```

然后当您需要调用该方法时，只需放置类似这样的内容

```
//calling a toString method is unnessary here, but i use it to have my programs to both rigid and self-explanitory 
System.out.println(methodCaller(methodName).toString()); 
```

# syntax - 你的语言“挂断”是什么？

> ID：160971
> 
> 赞同：16
> 
> 时间：2008-10-02T05:16:28.967
> 
> 标签：syntax, language-features, language-design

我感兴趣地阅读了一些最近的语言与语言问题... [Perl 与 Python](https://stackoverflow.com/questions/150043/python-v-perl#150103)，[Python 与 Java](https://stackoverflow.com/questions/136977/after-c-python-or-java#137343)，[一种语言可以比另一种更好吗？](https://stackoverflow.com/questions/157207/can-one-language-be-better-than-another)

我注意到的一件事是，我们中的很多人不喜欢语言都有*非常肤浅*的原因。我们第一眼就注意到了这些事情，它们让我们感到厌烦。我们回避那些可能非常好的语言，因为如果我们打扰的话，我们可能会在 2 秒内学会喜欢或忽略这些功能。

好吧，我和下一个人一样有罪，如果不是更多的话。开始：

*   Ruby：我看到的所有 Ruby 示例代码都使用该`puts`命令，这是一种幼稚的意第绪语解剖术语。因此，即使我应该认真对待 Ruby 代码，我也不能认真对待。
*   Python：我第一次看到它时，我对整个重要的空白都傻笑了。在接下来的几年里，我避免了它。现在我几乎不使用其他任何东西。
*   Java：我不喜欢 identifiersThatLookLikeThis。我不确定为什么。
*   Lisp：所有括号都有问题。不同重要性和目的的事物（函数声明、变量赋值等）在语法上没有区别，我懒得去学习什么是什么。
*   Fortran：大写的一切都伤害了我的眼睛。我知道现代代码不必这样写，但大多数示例代码是......
*   Visual Basic：`Dim`用于声明变量让我很烦恼，因为我记得 GW-BASIC 的美好时光，当时它*仅*用于维度数组。

哪些语言乍一看对我来说是正确的*？*Perl、C、QBasic、JavaScript、汇编语言、BASH shell、FORTH。

好的，现在我已经晾干了我的脏衣服……我想听听你的。 **你的语言障碍是什么？哪些肤浅的特征困扰着你？你是如何克服它们的？**

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-10-02T05:56:34.130

我讨厌讨厌 VB 的“结束函数”、“结束 IF”和“如果……那么”部分。我宁愿看到一个大括号。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2008-10-02T07:20:39.777

PHP 的函数名不一致。

```
// common parameters back-to-front
in_array(needle, haystack);
strpos(haystack, needle);

// _ to separate words, or not?
filesize();
file_exists;

// super globals prefix?
$GLOBALS;
$_POST; 
```

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2008-10-02T07:57:22.870

我从来没有真正喜欢在某些脚本 shell 中反向拼写的关键字

if-then- **fi**已经够糟糕了，但是 case-in- **esac**越来越傻了

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2008-10-02T16:56:39.643

我只是想到了另一个......我讨厌在 XML 中用于定义命名空间的大多数毫无意义的 URL，例如`xmlns="http://purl.org/rss/1.0/"`

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2008-10-02T06:23:56.310

帕斯卡`Begin`和`End`. 太冗长，不受括号匹配的影响，更糟糕的是，没有`Begin`for each `End`，例如。

```
Type foo = Record
    // ...
end; 
```

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2008-10-02T06:27:12.010

虽然我主要是一名 PHP 开发人员，但我不喜欢那些不允许我在内联做足够多事情的语言。例如：

```
$x = returnsArray();
$x[1]; 
```

代替

```
returnsArray()[1]; 
```

或者

```
function sort($a, $b) {
    return $a < $b;
}
usort($array, 'sort'); 
```

代替

```
usort($array, function($a, $b) { return $a < $b; }); 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2009-02-22T21:37:56.083

我喜欢面向对象的风格。因此，我在 Python 中看到 len(str) 来获取字符串的长度，或者在另一种语言中拆分字符串（如 split(str, "|") ）让我很烦恼。这在 C 中很好；它没有对象。但是 Python、D 等确实有对象并在其他地方使用 obj.method()。（我仍然认为 Python 是一门很棒的语言。）

不一致对我来说是另一个大问题。我不喜欢同一个库中不一致的命名：length()、size()、getLength()、getlength()、toUTFindex()（为什么不使用 toUtfIndex？）、Constant、CONSTANT 等。

.NET 中的长名称有时会困扰我。他们不能以某种方式缩短 DataGridViewCellContextMenuStripNeededEventArgs 吗？ListViewVirtualItemsSelectionRangeChangedEventArgs 怎么样？

而且我讨厌深层目录树。如果一个库/项目有一个 5 级深的目录树，我会遇到麻烦。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2008-10-02T06:59:00.000

C 和 C++ 的语法有点古怪。他们将运算符重用于不同的事情。您可能已经习惯了它，以至于您没有考虑它（我也没有），但考虑一下括号有多少含义：

```
int main()        // function declaration / definition
printf("hello")   // function call
(int)x            // type cast
2*(7+8)           // override precedence
int (*)(int)      // function pointer
int x(3)          // initializer
if (condition)    // special part of syntax of if, while, for, switch 
```

如果你在 C++ 中看到

```
foo<bar>(baz(),baaz) 
```

`foo`如果没有and的定义，您将无法知道其含义`bar`。

*   < 和 > 可能是模板实例化，或者可能小于和大于（不寻常但合法）
*   () 可能是一个函数调用，或者可能只是围绕逗号运算符（即执行 baz() 以获得大小效果，然后返回 baaz）。

愚蠢的是，其他语言复制了其中一些特征！

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2008-10-02T07:38:23.387

世界上没有什么比 php 更让我讨厌的了。

1.  带有 $ 的变量，这是每个变量的一个额外的奇怪字符。
2.  成员使用 -> 访问，没有明显的原因，每个成员访问一个额外的字符。
3.  真是语言的奇葩。
4.  没有命名空间。
5.  字符串与 .. 连接
6.  语言的怪诞表演。

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2008-10-02T05:25:56.200

Java 及其检查的异常。我离开 Java 有一段时间，住在 .NET 世界，然后最近回来了。

感觉有时候，我的`throws`子句比我的方法内容更冗长。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2009-02-28T05:31:19.757

Objective C 中的所有 [] 和 @s。它们的使用与底层 C 的本机语法如此不同，以至于我第一次看到它们时给人的印象是，所有面向对象都是在事后才笨拙地用螺栓固定的。

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2009-12-01T23:43:11.583

我讨厌**Java 的样板冗长**。

*   为属性编写 getter 和 setter
*   检查异常处理和所有暗示
*   长长的进口清单

那些与 Java 约定 using 相关的那些`veryLongVariableNames`，有时让我觉得我回到了 80 年代，写`IDENTIFICATION DIVISION.`在我的程序的顶部。

提示：如果您可以在 IDE 中自动生成部分代码，则很好地提示您正在生成样板代码。使用自动化工具，编写不是问题，但每次有人必须阅读该代码时都会遇到障碍 - 这种情况更常见。

虽然我认为类型官僚主义有点过火，但 Scala 已经成功解决了其中一些问题。

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2008-10-02T13:55:36.787

团队项目中的编码风格不一致。

我正在从事一个大型团队项目，其中一些贡献者使用了 4 个空格而不是制表符。使用他们的代码可能会很烦人——我喜欢保持我的代码干净并且风格一致。

当你对不同的语言使用不同的标准时，这已经够糟糕了，但在一个包含 HTML、CSS、Javascript、PHP 和 MySQL 的 Web 项目中，那就是 5 种语言、5 种不同的样式，并乘以项目工作人员的数量。

当我需要修复某些东西时，我很想重新格式化我的同事代码，但是存储库会认为我更改了他们代码的每一行。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2009-12-02T00:21:23.770

没有特别的顺序...

**OCaml**

*   元组定义用于`*`分隔项目，而不是`,`. 所以，`("Juliet", 23, true)`有类型`(string * int * bool)`。

*   [由于是一门很棒的语言，文档对线程](http://caml.inria.fr/pub/docs/manual-ocaml/manual038.html)有这样令人难以忘怀的评论：“*线程库是通过在单个处理器上分时实现的。它不会利用多处理器机器。因此，使用这个库永远不会制作程序跑得更快。* ” JoCaml[没有解决这个问题](http://jocaml.inria.fr/manual/manual015.html)。

*   ^^^ 我听说 Jane Street 的人正在努力将并发 GC 和多核线程添加到 OCaml，但我不知道他们有多成功。我无法想象没有多核线程和 GC 的语言能够存活很长时间。

*   在顶层探索模块并不容易。当然，您可以编写`module q = List;;`并且顶层会很高兴地打印出模块定义，但这看起来很老套。

**C＃**

*   糟糕的类型推断。除了最琐碎的表达式之外，我还必须为泛型函数赋予类型。

*   我读过的所有 LINQ 代码都使用方法语法，`x.Where(item => ...).OrderBy(item => ...)`. 没有人使用过表达式语法，`from item in x where ... orderby ... select`. 在你我之间，我认为表达式语法很愚蠢，如果没有其他原因，它在所有其他 C# 和 VB.NET 代码的背景下看起来很“陌生”。

**LINQ**

使用行业标准名称的所有其他语言是 Map、Fold/Reduce/Inject 和 Filter。LINQ 必须不同，并使用 Select、Aggregate 和 Where。

**函数式编程**

单子很*神秘*。看过 Parser monad、Maybe monad、State 和 List monad，我可以完全理解代码是如何工作的；然而，作为一种通用的设计模式，我似乎无法看到问题并说“嘿，我敢打赌 monad 在这里很适合”。

**红宝石**

[呜呜呜！！！！！！](http://mislav.uniqpath.com/poignant-guide/book/chapter-7.html)我的意思是……说真的。

**VB**

```
Module Hangups
    Dim _juliet as String = "Too Wordy!"

    Public Property Juliet() as String
        Get
            Return _juliet
        End Get
        Set (ByVal value as String)
            _juliet = value
        End Set
    End Property
End Module 
```

而二传手声明是我存在的祸根。好的，所以我更改了我的属性的数据类型——现在我也需要更改我的 setter 中的数据类型吗？为什么 VB 不从 C# 中借用并简单地合并一个名为 value 的隐式变量？

**.NET 框架**

我个人喜欢 Java 大小写约定：类是 PascalCase，方法和属性是 camelCase。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2009-02-22T20:45:12.917

我讨厌分号。我发现它们增加了很多噪音，您很少需要将两个语句放在一行中。我更喜欢 Python 和其他语言的风格……行尾就是语句的结尾。

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2008-10-02T07:30:01.860

如果微软不得不在 C# 中发明另一种类似 C++ 的语言，为什么他们不纠正 Java 的错误并实现对 RAII 的支持？

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2009-02-28T17:12:20.930

任何无法完全确定数组/循环/字符串字符索引是基于零还是基于一的语言。

我个人更喜欢从零开始，但是任何混合这两者的语言，或者让你“配置”使用的语言都会让你发疯。（[Apache Velocity](http://velocity.apache.org/) - 我正在寻找你的方向！）

从[VTL 参考](http://velocity.apache.org/engine/devel/vtl-reference-guide.html)中截取（默认为 1，但您可以将其设置为 0）：

```
# Default starting value of the loop
# counter variable reference.
directive.foreach.counter.initial.value = 1 
```

（尝试合并 2 个使用不同计数器方案的项目 - 啊！）

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2008-10-02T07:42:50.707

区分大小写。

您认为仅通过大小写来区分两个标识符是一个好主意，您需要什么样的宿醉？

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2008-10-02T05:33:32.467

有时让我感到恼火的是，人们期望所有工作都使用一种语言。根据您正在执行的任务，每种语言都有其优点和缺点。我喜欢基于 C 的语法语言，因为这是我最习惯的语言，而且我喜欢它们倾向于赋予开发人员的灵活性。当然，权力越大责任越大，拥有编写 150 行 LINQ 语句的权力并不意味着你应该这样做。

我喜欢最新版本的 VB.NET 中的内联 XML，虽然我不喜欢使用 VB，主要是因为我发现 IDE 不如 C# 的 IDE 有用。

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2009-12-01T23:26:25.287

In Ruby, I very strongly dislike how methods do not require `self.` to be called on current instance, but properties do (otherwise they will clash with locals); i.e.:

```
def foo()
   123
end

def foo=(x)
end

def bar()
    x = foo() # okay, same as self.foo()
    x = foo   # not okay, reads unassigned local variable foo
    foo = 123 # not okay, assigns local variable foo
end 
```

To my mind, it's very inconsistent. I'd rather prefer to either always require `self.` in all cases, or to have a sigil for locals.

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2008-10-02T06:32:13.043

我发现 Perl 对“已定义”和“未定义”值的使用非常有用，以至于如果没有它，我在使用脚本语言时会遇到麻烦。

珀尔：

```
($lastname, $firstname, $rest) = split(' ', $fullname); 
```

无论 $fullname 中有多少个单词，此语句都能很好地执行。在 Python 中尝试一下，如果 $fullname 不包含恰好三个单词，它就会爆炸。

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2008-10-02T07:32:54.147

SQL，他们说你不应该使用游标，当你这样做时，你真的明白为什么......
它是如此沉重！

```
 DECLARE mycurse CURSOR LOCAL FAST_FORWARD READ_ONLY
        FOR
        SELECT field1, field2, fieldN FROM atable

    OPEN mycurse
    FETCH NEXT FROM mycurse INTO @Var1, @Var2, @VarN

    WHILE @@fetch_status = 0
    BEGIN
        -- do something really clever...

        FETCH NEXT FROM mycurse INTO @Var1, @Var2, @VarN
    END
    CLOSE mycurse
    DEALLOCATE mycurse 

```

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2009-02-22T20:28:04.410

虽然我主要使用 python 编程，但 lambda 主体必须是表达式，这让我无休止地恼火。

我仍然在围绕 JavaScript 绞尽脑汁，总的来说，它大多是可以接受的。为什么创建命名空间这么难。在 TCL 中它们只是丑陋的，但在 JavaScript 中，它实际上是一个复杂的问题并且完全不可读。

在 SQL 中，为什么一切都只是一个巨大的 freekin SELECT 语句。

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2008-10-02T05:26:20.317

在 C/C++ 中，如何有不同的方式来编写相同的代码让我很恼火。

例如

```
if (condition)
{
   callSomeConditionalMethod();
}
callSomeOtherMethod(); 
```

对比

```
if (condition)
   callSomeConditionalMethod();
callSomeOtherMethod(); 
```

等同于同一件事，但不同的人有不同的风格。我希望原始标准对此*做出更严格的决定*，这样我们就不会产生这种歧义。它会导致代码审查中的争论和分歧！

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2008-10-02T06:38:59.503

Java 的包。我发现它们很复杂，更因为我不是一家公司。我非常喜欢命名空间。当然，我会克服它 - 我正在使用 Android SDK，而 Eclipse 消除了很多痛苦。我以前从来没有一台可以交互运行它的机器，现在我做到了，我印象非常深刻。

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2008-10-06T01:34:38.493

Prolog 的`if-then-else`语法。

```
x -> y ; z 
```

问题是“ `;`”是“ `or`”运算符，所以上面看起来像“`x`暗示`y`或`z`”。

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2011-04-15T23:52:25.170

**爪哇**

*   泛型（Java 版本的模板）是有限的。我不能调用类的方法，也不能创建类的实例。泛型由容器使用，但我可以使用 Object 实例的容器。
*   没有多重继承。如果多重继承的使用不会导致菱形问题，则应该允许。它应该允许编写接口方法的默认实现，问题示例：接口 MouseListener 有 5 个方法，每个事件一个。如果我只想处理其中一个，我必须将其他 4 个方法实现为空方法。
*   它不允许选择手动管理某些对象的内存。
*   Java API 使用复杂的类组合来完成简单的任务。例如，如果我想从文件中读取，我必须使用许多类（FileReader、FileInputStream）。

**Python**

*   缩进是语法的一部分，我更喜欢使用“end”这个词来表示块的结束，并且不需要“pass”这个词。
*   在类中，不应需要“self”一词作为函数的参数。

**C++**

*   标题是最严重的问题。我必须在头文件中列出函数并在 cpp 文件中实现它们。它不能隐藏类的依赖关系。如果A类私下使用B类作为字段，如果我包含A的头，B的头也会被包含。
*   字符串和数组来自 C，它们不提供长度字段。很难控制 std::string 和 std::vector 将使用堆栈还是堆。如果我想使用赋值、作为参数传递给函数或返回它，我必须使用带有 std::string 和 std::vector 的指针，因为它的“=”运算符将复制整个结构。
*   我无法控制构造函数和析构函数。在没有默认构造函数的情况下创建对象数组或选择与 if 和 switch 语句一起使用的构造函数是很困难的。

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2009-02-28T05:55:37.797

在大多数语言中，文件访问。到目前为止，VB.NET 是唯一一种对我来说文件访问有意义的语言。我不明白为什么如果要检查文件是否存在，我应该使用 File.exists("") 或类似的东西，而不是创建文件对象（实际上是 VB.NET 中的 FileInfo）并询问它是否存在。然后，如果我想打开它，我会要求它打开：（假设一个名为 fi 的 FileInfo 对象）例如 fi.OpenRead。返回一个流。好的。正是我想要的。如果我想移动文件，fi.MoveTo。我也可以做fi.CopyTo。在大多数语言中不使文件成为成熟的对象是什么废话？此外，如果我想遍历目录中的文件，我可以创建目录对象并调用 .GetFiles。或者，我可以使用 .GetDirectories，并获得一组全新的 DirectoryInfo 对象。

诚然，Java 有一些这种文件的东西，但是这种必须有一个完整的对象来告诉它如何列出文件的胡说八道是愚蠢的。

另外，我讨厌 ::、->、=> 和所有其他多字符运算符，除了 <= 和 >=（可能还有 -- 和 ++）。

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2009-02-22T20:17:16.090

我讨厌 Lisp 和 Scheme 中的括号，因为在 C、C# 和类似的语言之后，它看起来非常模糊，并且不清楚它们之间的关系。然而，既然我对 Scheme 有所了解，而且它是通常的格式指南，我不会说我喜欢它的工作方式，但至少我理解并克服了阅读用 CLisp/Scheme 编写的代码时的恐惧。

我想如果你学了一些东西并使用它一段时间（也许几个小时就足够了，至少对我来说是这样），你实际上可以克服你对语法的厌恶，并且能够专注于你应该做的事情真正使用作为语言的工具。

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2009-02-28T05:42:24.597

tsql 开始和结束...这很烦人...

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2009-09-18T19:27:51.343

我最大的问题是 MATLAB 的语法。我使用它，我喜欢它，但它有很多烦人的怪癖。让我们来看看。

*   矩阵用括号索引。所以如果你看到像 Image(350,260) 这样的东西，你不知道我们是从 Image 矩阵中获取一个元素，还是我们正在调用一个名为 Image 的函数并向它传递参数。
*   范围很疯狂。我似乎记得 for 循环索引变量在循环结束后保持在范围内。
*   如果您忘记在赋值后添加分号，该值将被转储到标准输出。
*   每个文件可能有一个函数。事实证明，这对于组织工作非常烦人。

如果我考虑一下，我相信我可以想出更多。

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2009-12-01T23:42:51.723

我得到了一个。

我对所有过于严格的静态类型语言都怀恨在心。

在我开始*被迫*编写这样的代码之前，我认为 C# 很棒：

```
void event...(object sender,EventArgs e){
  int t=(int)(decimal)(MyControl.Value); //Value is an object which is actually a decimal to be converted into an int
} 
```

哦，属性是丑陋的。微软真的想不出比`[MyAttribute(Argument)] void function...`认真的更丑陋的东西吗？什么？甚至不要让我开始使用 XAML 标记..

由于空格问题，我不能认真对待 Python。

有时我很难认真对待 Ruby，因为

a）我从Why's Poignant Guide自学

b) 在某些情况下，标识符类型由大小写决定。我已经超越了这一点，因为它比`const`关键字更明智且更干净。现在在每种语言中，当我制作一个常量时，它都是大写的。

哦，我也讨厌

```
if(a)
  b(); 
```

句法。你不知道我刚刚做了多少次

```
if(a)
  b();
  c(); 
```

意外地写了这样的代码..实际上可能会更糟

```
if(a)
  b(); c(); 
```

它应该能够使用的唯一地方是

```
if(a){ ....
}else if(b){ ... 
```

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2009-12-02T18:53:28.550

我讨厌在 Python 中，我永远不知道某物是对象上的方法，还是浮动的随机函数（请参阅[内置函数](http://docs.python.org/library/functions.html)）。感觉就像他们开始使语言面向对象但后来懈怠了。让这样的函数成为某个基类（如 Object）上的方法对我来说更有意义。

我也讨厌`__methodName__`- 风格的方法，如果我*真的*想要，我仍然可以从类外访问类中的私有内容。

空格要求让我很烦恼；我不希望语​​言设计师让我以某种方式编写代码。

我不喜欢 Python 所坚持的“一种正确的做某事”的理想方式。我想要选择。

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2009-12-01T23:06:38.507

[免责声明：我对 VB 只略知一二，所以对我的评论持保留态度]

我讨厌VB中的每个关键字都是这样大写的。前一周（一个月？）我看到一篇博客文章，关于有人尝试编写不带任何大写字母的 VB 代码（他们对编译器做了一些事情，可以让他们像这样编译 VB 代码），而且语言看起来好多了！

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2011-06-22T21:40:46.780

我的 C# 挂断非常简单：

1.  范围块

我希望我能写

```
with SomeObject
{
    .Property = "Some value";
    .Event();
} 
```

代替：

```
SomeObject.Property = "Some value";
SomeObject.Event(); 
```

尤其是在 StringBuilder 上使用 Append、AppendFormat，这将使代码阅读起来不那么繁琐。

1.  空值

我希望我能说：

```
var result = SomeObject.SomeCollection.First().SomeProperty ??? "Default value"; 
```

代替：

```
string result = string.Empty;

if ( SomeObject != null && SomeObject.SomeCollection.Count() > 0 )
{
    result = SomeObject.SomeCollection.FirsT().SomeProperty;
}
else
{
     result = "Default value";
} 
```

我讨厌 NullExceptions，并希望有一个平滑的 null 合并，它可以在多个层次上工作。

* * *

## 回答 #36

> 赞同：-1
> 
> 时间：2009-02-22T21:05:20.047

适用于多种语言：

1.  区分大小写——这是谁的主意？！（并且应该枪杀那些使用 ManyWordsThatMeanSomething 以及几个wordsthatmeansomething 来表达不同含义的人：）

2.  数组索引从 0 开始。我来自 fortran 背景，这是另一个原因，但在数学中数组索引总是从 1 开始，因此在实现更大的模型时往往会造成很多麻烦（尤其是在调试时）。

3.  分号 - 只是代码中的垃圾。如果您仔细编写代码（fortran、python、...），则不需要它们。如果你不是，他们不会救你的。

4.  大括号 - 见 3。

ps 你们都在外面。不要生气。如果你不喜欢这个答案，你就不应该问。

* * *

## 回答 #37

> 赞同：-5
> 
> 时间：2008-10-02T07:53:35.393

我有一个多年代码审查和调试其他人代码的实用程序。我将（从所有语言中）删除在条件语句中对逻辑操作进行分组的能力。这来自对 AND 运算符的特定抱怨，例如..

```
if (a and b)
{
  do something
} 
```

有4起案件，其中3起尚未处理。程序员很可能已经考虑了所有 4 种情况并故意选择以这种方式编写代码，但除非他们对代码进行了注释，否则我们没有任何迹象表明是这种情况——通常他们不会。

它可能有点冗长，但以下是明确的......

```
if (a)
{
    if (b)
    {
        do something
    }
    else
    {
        what about this case?
    }
}
else
{
    if (b)
    {
        what about this case?
    }
    else
    {
        do something else
    }
} 
```

作为一年后跟进的穷人，至少我会确切地知道应该发生什么。

# c++ - 附加到进程时，Visual Studio 2005 锁定

> ID：160973
> 
> 赞同：1
> 
> 时间：2008-10-02T05:20:01.610
> 
> 标签：c++, visual-studio, dll, custom-action, visual-c++-2005

我有一个简单的 C++ DLL，它为 WiX 安装程序实现了一些自定义操作。

调试自定义动作通常很简单：在动作开始时放置一个临时对话框，并在对话框出现时附加到进程。

但是今天，每当我附加到该进程时，屏幕底部都会出现“Microsoft Visual Studio is Busy”气泡。我无法弄清楚这是从哪里来的。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-02T05:22:21.683

经过数小时试图弄清楚这一点，我意识到问题在于我在工具->选项->调试->符号中启用了调试符号。查找符号的延迟导致了明显的锁定。

清除“仅在手动加载符号时搜索上述位置”似乎已经缓解了这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-02T05:23:07.377

您是否从不可用的网络位置引用调试符号（例如 ClearCase 动态视图或类似的东西）。当您附加到进程时，这可能会导致 Visual Studio 挂起。

检查 Tools->Options->Debugging->Symbols 并尝试暂时禁用符号文件 (.pdb) 的位置，直到您确定是哪个减慢了它（或导致它挂起）。通过消除，您应该能够弄清楚这一点。

# c++ - 如何键入一个指向方法的指针，该方法返回该方法的指针？

> ID：160974
> 
> 赞同：9
> 
> 时间：2008-10-02T05:20:05.823
> 
> 标签：c++, member-function-pointers

基本上我有以下课程：

```
class StateMachine {
...
StateMethod stateA();
StateMethod stateB();
...
}; 
```

stateA() 和 stateB() 方法应该能够返回指向 stateA() 和 stateB() 的指针。如何键入定义StateMethod？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-02T05:55:36.253

[GotW #57](http://www.gotw.ca/gotw/057.htm)说为此目的使用具有隐式转换的代理类。

```
struct StateMethod;
typedef StateMethod (StateMachine:: *FuncPtr)(); 
struct StateMethod
{
  StateMethod( FuncPtr pp ) : p( pp ) { }
  operator FuncPtr() { return p; }
  FuncPtr p;
};

class StateMachine {
  StateMethod stateA();
  StateMethod stateB();
};

int main()
{
  StateMachine *fsm = new StateMachine();
  FuncPtr a = fsm->stateA();  // natural usage syntax
  return 0;
}    

StateMethod StateMachine::stateA
{
  return stateA; // natural return syntax
}

StateMethod StateMachine::stateB
{
  return stateB;
} 
```

> 该解决方案具有三个主要优势：
> 
> 1.  它可以根据需要解决问题。更好的是，它是类型安全且可移植的。
>     
>     
> 2.  它的机制是透明的：您可以获得调用者/用户的自然语法，以及函数自己的“return stateA;”的自然语法；陈述。
>     
>     
> 3.  它的开销可能为零：在现代编译器上，代理类及其存储和函数应该内联并优化到零。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-02T05:56:21.057

仅使用 typedef：

```
class StateMachine {  

 public:  

  class StateMethod;     
  typedef StateMethod (StateMachine::*statemethod)();   

  class StateMethod {  

    statemethod   method; 
    StateMachine& obj; 

   public:  

    StateMethod(statemethod method_, StateMachine *obj_)  
      : method(method_), obj(*obj_) {} 

    StateMethod operator()() { return (obj.*(method))(); }  
  };  

  StateMethod stateA()  { return StateMethod(&StateMachine::stateA, this); }  

  StateMethod stateB()  { return StateMethod(&StateMachine::stateB, this); }  

}; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-02T05:46:10.440

编辑：njsf 在这里证明我错了。但是，您可能会发现静态转换更易于维护，因此我将把其余部分留在这里。

~~由于完整类型是递归的，~~因此没有“正确”的静态类型：~~~~

 ~~```
typedef StateMethod (StateMachine::*StateMethod)(); 
```

你最好的选择是使用`typedef void (StateMachine::*StateMethod)();`然后做丑陋的`state = (StateMethod)(this->*state)();`

PS：`boost::function`需要一个明确的返回类型，至少从我对[文档](http://synopsis.fresco.org/boost/Scopes/boost/function0.html)的阅读来看：`boost::function0<ReturnType>`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-02T05:27:46.677

我的理念是不要使用原始成员函数指针。我什至不知道如何使用原始指针 typedef 来做你想做的事，语法太可怕了。我喜欢使用 boost::function。

这~~几乎~~肯定是错误的：

```
class X
{
  public:
    typedef const boost::function0<Method> Method;

    // some kind of mutually recursive state machine
    Method stateA()
    { return boost::bind(&X::stateB, this); }
    Method stateB()
    { return boost::bind(&X::stateA, this); }
}; 
```

这个问题肯定比第一次见到要困难得多

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-02T17:52:09.027

我永远记不起可怕的 C++ 函数 declspec，所以每当我必须找出描述成员函数的语法时，我只会引发一个故意的编译器错误，它通常会为我显示正确的语法。

所以给出：

```
class StateMachine { 
    bool stateA(int someArg); 
}; 
```

stateA 的 typedef 的语法是什么？不知道..所以让我们试着给它分配一些不相关的东西，看看编译器是怎么说的：

```
char c = StateMachine::stateA 
```

编译器说：

```
error: a value of type "bool (StateMachine::*)(int)" cannot be used to initialize 
       an entity of type "char" 
```

它是：“bool (StateMachine::*)(int)”是我们的 typedef。

# c# - WPF：滑块不会引发 MouseLeftButtonDown 或 MouseLeftButtonUp

> ID：160995
> 
> 赞同：17
> 
> 时间：2008-10-02T05:25:39.430
> 
> 标签：c#, wpf, slider, mouseevent

我试过这个 XAML：

```
<Slider Width="250" Height="25" Minimum="0" Maximum="1" MouseLeftButtonDown="slider_MouseLeftButtonDown" MouseLeftButtonUp="slider_MouseLeftButtonUp" /> 
```

而这个 C#：

```
private void slider_MouseLeftButtonDown(object sender, MouseButtonEventArgs e)
{
sliderMouseDown = true;
}

private void slider_MouseLeftButtonUp(object sender, MouseButtonEventArgs e)
{
sliderMouseDown = false;
} 
```

sliderMouseDown 变量永远不会改变，因为永远不会引发 MouseLeftButtonDown 和 MouseLeftButtonUp 事件。当用户在滑块上按下鼠标左键以将 bool 值设置为 true 并且当鼠标向上时 bool 设置为 false 时，如何让此代码工作？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-10-03T21:09:30.310

另一种方法（根据您的情况可能更好）是在过程代码中注册一个事件处理程序，如下所示：

```
this.AddHandler
(
    Slider.MouseLeftButtonDownEvent,
    new MouseButtonEventHandler(slider_MouseLeftButtonDown),
    true
); 
```

请注意真正的论点。**它基本上表示您希望接收该事件，即使它已被标记为已处理。**不幸的是，像这样连接事件处理程序只能通过过程代码完成，而不能通过 xaml 完成。

换句话说，使用此方法，您可以为普通事件（冒泡）注册一个事件处理程序，而不是为隧道（因此在不同时间发生）的预览事件注册一个事件处理程序。

*有关详细信息，请参阅WPF Unleashed*第 70 页上的 Digging Deeper 侧边栏。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-10-02T05:43:40.417

滑块吞下 MouseDown 事件（类似于按钮）。

您可以注册在滑块有机会处理它们之前触发的 PreviewMouseDown 和 PreviewMouseUp 事件。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-01-15T00:24:52.583

尝试使用 LostMouseCapture 和 GotMouseCapture。

```
 private void sliderr_LostMouseCapture(object sender, MouseEventArgs e)

    private void slider_GotMouseCapture(object sender, MouseEventArgs e) 
```

GotMouseCapture 在用户开始拖动滑块时触发，而在他释放滑块时触发 LostMouseCapture。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-09T04:31:23.717

我想提一下 Slider 并没有完全吞下整个 MouseDown 事件。通过单击刻度线，您*可以获得*事件通知。Slider 不会处理 MouseDown 事件，除非它们来自滑块的...滑块。

基本上，如果您决定使用

```
AddHandler(Slider.MouseLeftButtonDownEvent, ..., true) 
```

打开刻度的版本，请确保之前已处理过该事件。如果你不这样做，你最终会遇到一个边缘情况，你认为滑块被点击了，但它真的是一个勾号。注册预览事件更糟糕 - 您将在任何地方获取事件，甚至在刻度之间的空白处。~~****~~**